# StackOverflow 问答 11043000-11043999

# emacs - emacs编译缓冲区自动关闭？

> ID：11043004
> 
> 赞同：14
> 
> 时间：2012-06-15T00:02:41.860
> 
> 标签：emacs, buffer, compile-mode

我想在没有错误和警告时自动关闭编译缓冲区，但我想在有警告时显示它。任何人都可以帮助我吗？来自[emacswiki](http://emacswiki.org/emacs/ModeCompile#toc2)的这段代码只满足第一个要求。如何改变它？

```
 ;; Helper for compilation. Close the compilation window if
  ;; there was no error at all.
  (defun compilation-exit-autoclose (status code msg)
    ;; If M-x compile exists with a 0
    (when (and (eq status 'exit) (zerop code))
      ;; then bury the *compilation* buffer, so that C-x b doesn't go there
      (bury-buffer)
      ;; and delete the *compilation* window
      (delete-window (get-buffer-window (get-buffer "*compilation*"))))
    ;; Always return the anticipated result of compilation-exit-message-function
    (cons msg code))
  ;; Specify my function (maybe I should have done a lambda function)
  (setq compilation-exit-message-function 'compilation-exit-autoclose) 
```

* * *

## 回答 #1

> 赞同：19
> 
> 时间：2012-06-15T22:37:55.693

我使用以下内容进行编译。如果有警告或错误，它将保留编译缓冲区，否则将其掩埋（1 秒后）。

```
(defun bury-compile-buffer-if-successful (buffer string)
 "Bury a compilation buffer if succeeded without warnings "
 (when (and
         (buffer-live-p buffer)
         (string-match "compilation" (buffer-name buffer))
         (string-match "finished" string)
         (not
          (with-current-buffer buffer
            (goto-char (point-min))
            (search-forward "warning" nil t))))
    (run-with-timer 1 nil
                    (lambda (buf)
                      (bury-buffer buf)
                      (switch-to-prev-buffer (get-buffer-window buf) 'kill))
                    buffer)))
(add-hook 'compilation-finish-functions 'bury-compile-buffer-if-successful) 
```

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2013-02-12T06:28:07.433

jpkotta，它在大多数情况下都有效。有时，即使有警告，它也不会切换到编译缓冲区。因此，我对您的表格进行了更改，现在可以使用：

```
(defun bury-compile-buffer-if-successful (buffer string)
  "Bury a compilation buffer if succeeded without warnings "
  (if (and
       (string-match "compilation" (buffer-name buffer))
       (string-match "finished" string)
       (not
        (with-current-buffer buffer
          **(goto-char 1)**
          (search-forward "warning" nil t))))
      (run-with-timer 1 nil
                      (lambda (buf)
                        (bury-buffer buf)
                        (switch-to-prev-buffer (get-buffer-window buf) 'kill))
                      buffer)))
(add-hook 'compilation-finish-functions 'bury-compile-buffer-if-successful) 
```

# c# - 当数据消费者激增时，我如何才能保持干爽和凝聚力？

> ID：11043005
> 
> 赞同：1
> 
> 时间：2012-06-15T00:02:42.927
> 
> 标签：c#, winforms, oracle, static, dry

我有一个静态类，用作我的项目的“数据实用程序”。

这个项目有几个表单和类，其中多个调用这个 Data Utils 类/数据库。

我不想违反 DRY 原则，所以我不想有多个 OracleConnection 组件，一个扑通一声放到每个表单上。

我也不想通过让我的 Data Utils 类获得我的主要表单的“肉体”知识并为 OracleConnection 访问它来破坏凝聚力。

我*可以*在每个 Data Utils 方法中创建一个动态 OracleConnection，但这也会违反 DRY。

将我的静态类转换为非静态类，给它一个 OracleConnection 成员，并在构造函数中实例化它是我最好的解决方案吗？

## 更新

对于后代，这就是我所做的，基于 LukLed 的建议：

```
internal class GreatAmericanNovelistsData
{
    private static OracleConnection oc;
    static GreatAmericanNovelistsData()
    {
        oc = new OracleConnection();
        oc.ConnectionString = "User Id=SCLEMENS;Password=HucKfiNn;Server=HANNIBAL;Pooling=True;Min Pool Size=0;Max Pool Size=10;Connection Lifetime=0;Direct=True;Sid=HANNIBAL;Service Name=HANNIBAL;";
        oc.Direct = true;
    } 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-06-15T00:07:26.540

您只能定义一次静态构造函数并初始化连接。`OracleConnection`对象也可以是静态的。详情[在这里](http://msdn.microsoft.com/en-us/library/k9x6w0hc%28v=vs.80%29.aspx)。

```
class SimpleClass
{
    // Static constructor
    static SimpleClass()
    {
        //...
    }
} 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-06-15T00:15:30.987

> 将我的静态类转换为非静态类，给它一个 OracleConnection 成员，并在构造函数中实例化它是我最好的解决方案吗？

但这会违反依赖倒置原则；）

这听起来有点类似于我在最近的一个应用程序中所做的，我最终做的是有一个返回我的 OracleConnection 实例的工厂（我有一个工厂，因为我需要确保每个线程有 1 个实例，所以我在一个工厂）。工厂实现了一个接口，并且各种构造函数接受了一个作为该接口的参数。依赖注入框架（如 Unity 或 Ninject）用于注入适当的工厂。这也使它更易于测试，因为我可以模拟工厂。

所以在代码中，我最终做了类似的事情（如果语法有点不对，这让我很抱歉）：

```
public interface IDbConnectionFactory
{
  public IDbConnection GetConnection();
}

public class OracleConnectionFactory : IDbConnectionFactory
{
  public IDbConnection GetConnection()
  {
    return new OracleConnection();
  }
}

public class MyAwesomeDataAccess
{
  private IDbConnectionFactory dbConnectionFactory;

  public void MyAwesomeDataAccess(IDbConnectionFactory() dbConnectionFactory)
  {
    this.dbConnectionFactory = dbConnectionFactory;
  }

  public SomeData SomeMethod()
  {
    var connection = dbConnectionFactory.GetConnection();
    // do stuff with connection...
  }
} 
```

然后在我的 Unity 配置中我映射了`IDbConnectionFactory -> OracleConnectionFactory`

当然，这可能不是在所有情况下对每个人都是最好的，但我只是想就一种可能性给出一个想法。希望你能找到适合你的好方法！

# actionscript-3 - AS3 - 实例功能问题

> ID：11043007
> 
> 赞同：1
> 
> 时间：2012-06-15T00:02:47.523
> 
> 标签：actionscript-3, instance

我正在使用三个类，并且为了便于阅读而缩短了三个类，省略了包和导入。`MainClass`是我的文档类，`Player`是链接到影片剪辑`KeyHandler`的类，是我用来包含按键功能的类。首先，代码..

```
public class  TestMain extends Sprite
{
    public var keyHandler:KeyHandler = new KeyHandler();
    public var timer:Timer = new Timer(30);
    public var player:Player = new Player();

    public function TestMain()
    {
        stage.addEventListener(KeyboardEvent.KEY_DOWN, keyHandler.KeyPress);
        stage.addEventListener(KeyboardEvent.KEY_UP, keyHandler.KeyRelease);
        timer.addEventListener(TimerEvent.TIMER, onTick);
        timer.start();

        stage.addChild(player);
    }

    public function onTick(timerEvent:TimerEvent)
    {
        player.Move();
    }
} 
```

玩家等级..

```
public class Player extends Sprite
{
    public var keyHandler:KeyHandler = new KeyHandler();

    public function Player()
    {
    }

    public function Move():void
    {
        trace("this works");
        if (keyHandler.upKeyIsPressed)
        {
            trace("this doesnt work")
        }
    }

} 
```

KeyHandler 类..

```
public class KeyHandler extends Sprite
{
    public var upKeyIsPressed:Boolean = false;

    public function KeyHandler() 
    {
    }

    public function KeyPress(keyboardEvent:KeyboardEvent)
    {
        if (keyboardEvent.keyCode == Keyboard.UP)
        {
            upKeyIsPressed = true;
        }
    }

    public function KeyRelease(keyboardEvent:KeyboardEvent)
    {
        if (keyboardEvent.keyCode == Keyboard.UP)
        {
            upKeyIsPressed = false;
        }
    }

} 
```

按住向上键不会跟踪任何内容，但`Move`函数会跟踪。我应该做`KeyHandler`静态，还是有一个简单的修复？这是不好的做法吗？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-06-15T00:23:15.093

这是我评论中的选项 1

测试主程序

```
public class  TestMain extends Sprite
{
    public var keyHandler:KeyHandler = new KeyHandler();
    public var timer:Timer = new Timer(30);
    public var player:Player = new Player();

    public function TestMain()
    {
        stage.addEventListener(KeyboardEvent.KEY_DOWN, keyHandler.KeyPress);
        stage.addEventListener(KeyboardEvent.KEY_UP, keyHandler.KeyRelease);
        timer.addEventListener(TimerEvent.TIMER, onTick);
        timer.start();
        player.keyHandler = keyHandler;
        stage.addChild(player);
    }

    public function onTick(timerEvent:TimerEvent)
    {
        player.Move();
    }
} 
```

播放器

```
public class Player extends Sprite
{
    public var keyHandler:KeyHandler;

    public function Player()
    {
    }

    public function Move():void
    {
        trace("this works");
        if (keyHandler.upKeyIsPressed)
        {
            trace("this should be working now")
        }
    }

} 
```

密钥处理程序

```
public class KeyHandler extends Sprite
{
    public var upKeyIsPressed:Boolean = false;

    public function KeyHandler() 
    {
    }

    public function KeyPress(keyboardEvent:KeyboardEvent)
    {
        if (keyboardEvent.keyCode == Keyboard.UP)
        {
            upKeyIsPressed = true;
        }
    }

    public function KeyRelease(keyboardEvent:KeyboardEvent)
    {
        if (keyboardEvent.keyCode == Keyboard.UP)
        {
            upKeyIsPressed = false;
        }
    }

} 
```

选项 2 是进行“单例”类型的设置，您可以在其中通过静态方法获取类的实例。在这种情况下，只使用了该类的一个实例，并且不需要将实例传递给实际上不需要处理它本身的对象。在我对 OP 的评论中的链接中，我讨论了执行模式的选项，因此不会意外创建新实例，我只是在这里使用导致运行时错误的简单选项：

```
public class KeyHandler extends Sprite
{
    public var upKeyIsPressed:Boolean = false;
    public static var SINGLETON:KeyHandler = new KeyHandler();
    public static function getInstance():KeyHandler
    {
        return SINGLETON;
    }

    public function KeyHandler() 
    {
        if(SINGLETON)
            throw new Error("There can be only one!!!");
    }

    public function KeyPress(keyboardEvent:KeyboardEvent)
    {
        if (keyboardEvent.keyCode == Keyboard.UP)
        {
            upKeyIsPressed = true;
        }
    }

    public function KeyRelease(keyboardEvent:KeyboardEvent)
    {
        if (keyboardEvent.keyCode == Keyboard.UP)
        {
            upKeyIsPressed = false;
        }
    }

} 
```

播放器

```
public class Player extends Sprite
{
    public var keyHandler:KeyHandler = KeyHandler.getInstance();

    public function Player()
    {
    }

    public function Move():void
    {
        trace("this works");
        if (keyHandler.upKeyIsPressed)
        {
            trace("this should be working now")
        }
    }

} 
```

测试主程序

```
public class  TestMain extends Sprite
{
    public var keyHandler:KeyHandler = KeyHandler.getInstance();
    public var timer:Timer = new Timer(30);
    public var player:Player = new Player();

    public function TestMain()
    {
        stage.addEventListener(KeyboardEvent.KEY_DOWN, keyHandler.KeyPress);
        stage.addEventListener(KeyboardEvent.KEY_UP, keyHandler.KeyRelease);
        timer.addEventListener(TimerEvent.TIMER, onTick);
        timer.start();
        player.keyHandler = keyHandler;
        stage.addChild(player);
    }

    public function onTick(timerEvent:TimerEvent)
    {
        player.Move();
    }
} 
```

这是另一种强制执行单例的方法，这会导致编译时错误，因此您可以在前面看到问题：

[http://blog.pixelbreaker.com/actionscript-3-0/as30-better-singletons](http://blog.pixelbreaker.com/actionscript-3-0/as30-better-singletons)

# asp.net - 如何在 asp:GridView 中获得删除确认

> ID：11043010
> 
> 赞同：3
> 
> 时间：2012-06-15T00:03:18.127
> 
> 标签：asp.net

如何在 asp:GridView 中弹出删除按钮的删除确认？

* * *

## 回答 #1

> 赞同：8
> 
> 时间：2012-06-15T00:03:18.563

如果您在 GridView 中的每一行都有一个删除按钮，那么我认为这是最好的（而且绝对是最简单的）方法，可以让它发出一个要求确认的警报。这是完整的 aspx 代码（不需要隐藏代码）：

```
<asp:TemplateField ShowHeader="False">
  <ItemTemplate>
  <asp:LinkButton ID="DeleteButton" runat="server"
      CausesValidation="False"
      CommandName="Delete"
      OnClientClick='<%# Eval("Title", "return confirm(\"Delete the datasource {0}?\");") %>'
      Text="delete" />
  </ItemTemplate>
</asp:TemplateField> 
```

几点注意事项：

1.  CommandName 必须是 Delete - 这就是将其映射到 GridView 删除功能的原因。
2.  标题是该行标题的数据列名称。您在此处使用的内容取决于数据的列/属性名称。
3.  数据源这个词也是如此——这就是我们所拥有的行。您需要替换为您的数据所调用的内容。
4.  我认为 <%$ resource_name %> 应该适用于文本 - 但还没有这样做。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-06-15T02:06:28.227

如果您使用的是 GridView，那么您就走错了路。专业人士不使用它。他们几乎只使用 ListView。所以不要打扰它。大多数书籍不教授工业最佳实践。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-09-25T11:39:59.450

您还可以在网格视图的 RowDataBound 上动态地将 onlick 属性添加到删除链接。

在下面的代码中，我们有一个 3 列的表，所以 columnIndex = 2。此外，只有一个自动生成按钮（删除），所以 autoButtonIndex = 0。如果我们有一个编辑按钮，保存按钮，这个索引会改变.

```
Private Sub GridView1_RowDataBound(ByVal sender As Object, ByVal e As System.Web.UI.WebControls.GridViewRowEventArgs) Handles GridView1.RowDataBound

Dim columnIndex As Integer = 2
Dim autoButtonIndex as Integer = 0  

    Try
        If (e.Row.RowType = DataControlRowType.DataRow) Then

            If (e.Row.RowState = DataControlRowState.Normal Or e.Row.RowState = DataControlRowState.Alternate) Then

                Dim lnkBtn As LinkButton = CType(e.Row.Cells(columnIndex).Controls(autoButtonIndex), LinkButton)
                lnkBtn.Attributes.Add("onclick", "if(!confirm('Are you sure to delete this row?'))return false;")

            End If

        End If

    Catch ex As Exception

    End Try

End Sub 
```

不要忘记适当地处理您的异常。

# xcode - 核心数据模型中属性的用户信息消失

> ID：11043021
> 
> 赞同：1
> 
> 时间：2012-06-15T00:04:18.367
> 
> 标签：xcode, core-data

每当我关闭 XCode 时，我为 Core Data 模型中的属性设置的用户信息条目就会消失。我怎样才能阻止这种情况发生？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-06-15T00:06:00.987

我希望这仍然适用：只需在 CoreData 编辑器上选择您正在处理的数据模型，然后在文件检查器上将工具版本更改为最新版本。问题解决了！

我实际上在我的博客上发布了这个问题。这是[链接](http://twoshotsofcocoa.com/?p=51)。

# asp.net-mvc - EF5 Code First 多对多迁移

> ID：11043023
> 
> 赞同：5
> 
> 时间：2012-06-15T00:04:32.173
> 
> 标签：asp.net-mvc, entity-framework, ef-code-first, entity-framework-migrations

我以前做过这个，但由于某种原因不能让它在 EF5 中工作。

通常，当我有很多像这样的关系时，它会自动恢复...

```
public class Beer
{
    public int Id { get; set; }
    public virtual ICollection<Restaurant> Restaurants { get; set; }
}

public class Restaurant
{
    public int Id { get; set; }
    public virtual ICollection<Beer> Beers { get; set; }
} 
```

我想要一张 RestaurantsBeers 表或任何只有 RestaurantId 和 BeerId 的东西。

当我使用正常的 Code First 方式创建它时，只需运行它就可以工作的应用程序。

![英孚工作](../Images/b76a79f9e18925c1017690f8308ed039.png)

但是，使用迁移，它不会创建该表。

![EF 不工作](../Images/01ad36a0b21c664efa805020a4b3f01c.png)

`Enable-Migrations`然后我跑了`Add-Migration FirstDb`，最后`Update-Database`……没有骰子……

这个也试过...

```
protected override void OnModelCreating(DbModelBuilder modelBuilder)
    {
        modelBuilder.Entity<Beer>()
            .HasMany(b => b.Restaurants)
            .WithMany(a => a.Beers)
            .Map(m => m.MapLeftKey("BeerId")
                          .MapRightKey("RestaurantId")
                          .ToTable("BeersRestaurants"));
    } 
```

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-08-13T01:35:57.367

根据我试图追踪相同问题的经验，EF5.0RC 尚不支持迁移以创建新的 M2M 关系。因此，为什么它适用于标准数据库创建但不适用于迁移功能。您现在可以从标准代码优先数据库初始化中导出创建 SQL，并在迁移时手动运行它。

这应该在 EF5.0 进入 RTM 时解决，但现在我们必须等待它。

# javascript - 变量作为 JavaScript 对象文字中的属性名称？

> ID：11043026
> 
> 赞同：60
> 
> 时间：2012-06-15T00:05:01.317
> 
> 标签：javascript

> **可能重复：**
> [如何使用变量作为名称将属性添加到 Javascript 对象？](https://stackoverflow.com/questions/695050/how-do-i-add-a-property-to-a-javascript-object-using-a-variable-as-the-name)
> [在 JavaScript 文字中使用变量作为属性名称？](https://stackoverflow.com/questions/7638659/use-variable-for-property-name-in-javascript-literal)

是否可以在 JavaScript 中添加变量作为对象的属性名称，如下所示：

```
var myVar = "name";
var myObject = {
    {myVar}: "value"
}; 
```

* * *

## 回答 #1

> 赞同：199
> 
> 时间：2012-06-15T00:06:20.300

您可以使用`[]`语法将*表达式*用作属性名称（与始终将其视为字符串的`.prop`and语法相比）：`prop: value`

```
var myObject = {};
var myVar = "name";
myObject[myVar] = "value"; 
```

但是，没有办法在对象文字中使用它。您必须先创建对象，然后分别分配每个属性。

* * *

## 编辑

使用 ES6，现在可以使用[ComputedPropertyName](http://www.ecma-international.org/ecma-262/6.0/#sec-object-initializer)来实现，它以以下语法的形式显示：

```
var myVar = "name";
var myObject = {
    [myVar]: "value"
}; 
```

* * *

## 回答 #2

> 赞同：11
> 
> 时间：2012-06-15T00:06:38.073

像这样？

```
var myVar = "name";
var myObject = {};

myObject[myVar] = "value"; 
```

* * *

## 回答 #3

> 赞同：10
> 
> 时间：2012-06-15T00:06:12.103

是的，但不是直接的。

```
var myVar = "name";
var object = {};
object[myVar] = "value"; 
```

# jquery - 不能让这两个动作在 jquery 中一起工作

> ID：11043028
> 
> 赞同：0
> 
> 时间：2012-06-15T00:05:33.827
> 
> 标签：jquery

所以，这就是问题所在。我编写了一个代码，它根据选定的下拉菜单打开一个 div。这很好用。然后我想预先选择一个特定的选项（$_POST['value']）。这很好用。当我也想打开相关的 div 时，问题就来了。我可以做一个或另一个，但永远不能同时做。请注意，我包含了工作选项并将其注释掉。请告诉我我应该做什么：

```
 $(document).ready(function(){
   $('.box').hide();
     $('#sow').change(function() {
        $('.box').hide();
        $('#div' + $(this).val()).show();
     });
   });
  var theText = "Printer Setup";
  //$("#sow option:contains(" + theText + ")").attr('selected', 'selected');
  //$("#sow option:contains(" + theText + ")")$('#divoption5').show();
  $("#sow option:contains(" + theText + ")").attr('selected', 'selected')$('#divoption5').show(); 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-06-15T00:11:57.493

尝试使用`end()`- [http://jsfiddle.net/YRJLY/](http://jsfiddle.net/YRJLY/)

```
var theText = "Printer Setup";

$("#sow option:contains(" + theText + ")")
    .attr('selected', 'selected')
    .end()
    .find('#divoption5')
    .show(); 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-06-15T00:21:01.647

也许这就是你想做的？（http://jsfiddle.net/ft2PD/13/ 显示所选项目何时需要显示 div，[http://jsfiddle.net/ft2PD/14/](http://jsfiddle.net/ft2PD/14/)显示所选项目何时应隐藏 div。

这是代码：

```
<select id='myselect'>
    <option  selected='selected' value='-1'>Please Select </option>
    <option  value='0'>value 0</option>
    <option value='1'>value 1</option>
</select>
<div id='content' style="display:none;">
    content will come here.
</div> 
```

和javascript：

```
 $(document).ready(function(){
    ShowDiv($('#myselect option:selected'));
    $('#myselect').change(function(){

        ShowDiv(this);
    });

});
function ShowDiv(item)
{
    switch($(item).val())
        {
            case "0":
                $('#content').show();
                break;
            default:
                $('#content').hide();
                break;
        }
}​ 
```

# objective-c - 我应该继承数组还是将其声明为成员？

> ID：11043029
> 
> 赞同：0
> 
> 时间：2012-06-15T00:05:35.637
> 
> 标签：objective-c, arrays, oop, subclass

（我认为这是关于 OOP 的一个非常基本的问题，但不幸的是我找不到它——所以，如果它是重复的，请关闭这个问题。）

我想创建一个类，其主要目的是成为另一个类的对象数组的容器。用户应该能够非常容易地访问这些对象，就像一个常规数组一样——但是，在数组逻辑之上应该有自定义逻辑。

我应该从头开始创建自定义类并使用标准数组类作为成员，还是应该对标准数组类进行子类化并将我的自定义逻辑包含到现有方法和新方法的重载中？

（我想到了Objective C，但我不认为它与语言有很多关系，所以我不包括在标签中）。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-06-15T00:21:55.403

如果你的类尊重整个数组接口，无论它在你的上下文中，是的，你可以子类化它。如果您的“数组逻辑之上的自定义逻辑”更改了数组接口的合同，则不应将其子类化。

如果您将 Array 子类化，则您的类可以被视为一个数组。一些不知道你的类的方法可以将它的实例视为一个数组。这在多态性中起作用。尽管您的类可以具有“自定义逻辑”，但不能破坏 Array 的接口。

注意：在通用上下文中回答，不特定于任何语言，甚至特定于 Array 类。这对任何允许扩展的类都有效。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-06-15T00:32:28.280

...但在 Objective-C中`NSArray`并`NSMutableArray`使用类集群实现。它们不是具体的类，虽然您*可以对*它们进行子类化，但您必须实现自己的存储并为 and 提供您自己的`-count`实现`-objectAtIndex:`。

因此，处理您所描述的情况的首选方法是通过*组合*- 实例变量或属性 - 而不是子类化。

如果您需要您的类响应所有数组方法，您可以使用`-forwardInvocation:`，如此[处](https://developer.apple.com/library/mac/#documentation/Cocoa/Conceptual/ObjCRuntimeGuide/Articles/ocrtForwarding.html)所述，将消息传递给数组实例。

# android - 在android中动态改变屏幕键盘布局

> ID：11043038
> 
> 赞同：0
> 
> 时间：2012-06-15T00:07:03.153
> 
> 标签：android

我想为我正在处理的在应用程序中本地化的信使应用程序构建自定义键盘布局。我目前注意到可以从设置中选择键盘设置以显示首选布局选项，例如英语、中文、法语。我的目标是 (1) 从应用程序中动态分配键盘布局，指定您希望将消息发送为的语言 (2) 构建 3 种不同的键盘布局，这些键盘布局不包含在设备的默认语言环境中，并且能够按照上面 1 中的说明进行操作。

Ps，如何动态更改屏幕键盘以显示不同的语言格式，以及如何构建自定义键盘布局以允许用户插入文本。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-06-15T02:26:06.917

您不能在自己的应用程序中真正包含真正的自定义“键盘”。请参见此处：[Android：带有自定义键盘的 EditText](https://stackoverflow.com/questions/2797958/android-edittext-with-custom-keyboard)。

除了让用户在设置中设置键盘之外，您唯一能做的就是将自定义键盘构建为视图并从您的活动中自己处理其所有事件（按键、打开/关闭等）。您还必须手动连接它以将文本放入您的编辑文本中。您必须投入大量工作才能真正让用户感觉它像键盘一样。

# wpf - 如何更改 WPF DataGridColumn 上的第一个排序方向

> ID：11043040
> 
> 赞同：5
> 
> 时间：2012-06-15T00:07:11.370
> 
> 标签：wpf, datagrid

现在（默认），当您单击用户可排序的标题时，`DataGridColumn`它会在第一次单击时按升序排序，在第二次单击时按降序排序。

如何让它在第一次点击时降序排列，在第二次点击时升序排列？

* * *

## 回答 #1

> 赞同：8
> 
> 时间：2012-06-15T00:52:13.410

我想出了一个方法来做到这一点，不知道这是否是最好的方法。但基本上，当排序事件触发并且当前 SortDirection 为空时，我将其设置为升序，以便默认排序器将排序方向反转为降序，并且这只发生在第一次排序时，因为这是唯一一次 SortDirection 为空。

```
myGrid.Sorting += (s, e) => e.Column.SortDirection = e.Column.SortDirection ?? ListSortDirection.Ascending; 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2014-02-10T21:13:46.690

这是已接受答案的扩展版本（我不喜欢这种紧凑的符号）：

```
private void _myGrid_Sorting(object sender, DataGridSortingEventArgs e)
{
    if (e.Column.SortDirection == null)
        e.Column.SortDirection = ListSortDirection.Ascending;
} 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-06-15T00:31:38.827

我在 Winforms 中做过类似的事情。处理 DataGrid.Sorting 事件，然后以编程方式反转排序顺序（如果它不是“无”）。

检查此链接以了解 WinForms 中的内容： [DataGridViewColumn 初始排序方向](https://stackoverflow.com/questions/1193929/datagridviewcolumn-initial-sort-direction)

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2012-06-15T05:46:25.360

我想这就是你正在寻找的方式......

[https://docs.microsoft.com/en-us/archive/blogs/vinsibal/wpf-datagrid-tri-state-sorting-sample](https://docs.microsoft.com/en-us/archive/blogs/vinsibal/wpf-datagrid-tri-state-sorting-sample)

在上面的博客中，他们在 DataGrid 中使用了另一种排序状态。

# combobox - 如何将 TreeView 放入 DevExpress ComboBox？

> ID：11043042
> 
> 赞同：0
> 
> 时间：2012-06-15T00:07:36.003
> 
> 标签：combobox, treeview, devexpress

如何将 TreeView 放置在 ComboBox 的下拉列表中？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-07-07T10:09:52.490

您应该使用 DevExpress XtraEditors 库中的 PopupContainerEdit 控件。

[请参阅此处](http://documentation.devexpress.com/#WindowsForms/clsDevExpressXtraEditorsPopupContainerEdittopic)的文档。只需 5 行代码即可完成。最终结果非常好，而且是免费的。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-05-01T14:12:58.343

如果您不想添加任何额外的库，可以使用[`DropDownEdit`](http://demos.devexpress.com/ASPxEditorsDemos/ASPxDropDownEdit/CheckComboBox.aspx)控件来模拟 ComboBox。只需将您的 TreeView 添加到`DropDownWindowTemplate`并设置`AllowSelectNode=true`。

# java - 在 java 中执行服务器套接字时总是“读取失败”

> ID：11043047
> 
> 赞同：0
> 
> 时间：2012-06-15T00:08:35.543
> 
> 标签：java, sockets

我一直被这个问题困扰，不知道如何解决。

我尝试使用 java 套接字编程在服务器和客户端之间创建通信。我使用此链接中的源代码[用于服务器](http://java.sun.com/developer/onlineTraining/Programming/BasicJava2/Code/SocketThrdServer.java)和[此链接用于客户端](http://java.sun.com/developer/onlineTraining/Programming/BasicJava2/Code/SocketClient.java)来创建我的应用程序并将其分为 2 个项目包（客户端和服务器）。但是对于客户端，我将这个源代码修改为几个类，因为我想在这一端添加一个库。

当我尝试使用此修改后的源代码将数据从客户端发送到服务器时，就会出现问题。来自服务器的套接字总是发送一条消息“读取失败”，但是当我使用原始源代码时它可以正常工作（可以读取）。

这是服务器端的源代码（服务器包）

```
 package server;

/**
 *
 * @author IRVAN AHADI
 */
import java.awt.Color;
import java.awt.BorderLayout;
import java.awt.event.*;
import javax.swing.*;

import java.io.*;
import java.net.*;

class ClientWorker implements Runnable {
  private Socket client;
  private JTextArea textArea;

  ClientWorker(Socket client, JTextArea textArea) {
   this.client = client;
   this.textArea = textArea;   
  }

  public void run(){
    String line;
    BufferedReader in = null;
    PrintWriter out = null;
    try{
      in = new BufferedReader(new InputStreamReader(client.getInputStream()));
      out = new PrintWriter(client.getOutputStream(), true);
    } catch (IOException e) {
      System.out.println("in or out failed");
      System.exit(-1);
    }

    while(true){
      try{
        line = in.readLine();
//Send data back to client
         out.println(line);
         textArea.append(line);
       } catch (IOException e) {
         System.out.println("Read failed");
         System.exit(-1);
       }
    }
  }
}

class SocketThrdServer extends JFrame{

   JLabel label = new JLabel("Text received over socket:");
   JPanel panel;
   JTextArea textArea = new JTextArea();
   ServerSocket server = null;

   SocketThrdServer(){ //Begin Constructor
     panel = new JPanel();
     panel.setLayout(new BorderLayout());
     panel.setBackground(Color.white);
     getContentPane().add(panel);
     panel.add("North", label);
     panel.add("Center", textArea);
   } //End Constructor

  public void listenSocket(){
    try{
      server = new ServerSocket(4444);
      System.out.println("succes crate socket");
    } catch (IOException e) {
      System.out.println("Could not listen on port 4444");
      System.exit(-1);
    }
    while(true){
      ClientWorker w;
      try{
        w = new ClientWorker(server.accept(), textArea);
        Thread t = new Thread(w);
        t.start();
        System.out.println("succes accept socket");
      } catch (IOException e) {
        System.out.println("Accept failed: 4444");
        System.exit(-1);
      }
    }
  }

  protected void finalize(){
//Objects created in run method are finalized when 
//program terminates and thread exits
     try{
        server.close();
    } catch (IOException e) {
        System.out.println("Could not close socket");
        System.exit(-1);
    }
  }

  public static void main(String[] args){
        SocketThrdServer frame = new SocketThrdServer();
    frame.setTitle("Server Program");
        WindowListener l = new WindowAdapter() {
                public void windowClosing(WindowEvent e) {
                        System.exit(0);
                }
        };
        frame.addWindowListener(l);
        frame.pack();
        frame.setVisible(true);
        frame.listenSocket();
  }
} 
```

这是客户端的源代码（客户端包）

1.  客户端.java

包客户端；

```
import java.io.*; 
import java.net.*;
public class Client{
Socket socket;
PrintWriter out = null;
BufferedReader in =  null;
String message = null;

        Client(){
                try{    
                    socket = new Socket("IRVANA-PC",4444);
                    out = new PrintWriter(socket.getOutputStream(),true);
                    in = new BufferedReader(new InputStreamReader(socket.getInputStream()));
                    System.out.println("Socket created and now connected to "+socket.getPort());
                }catch(UnknownHostException e){
                    System.out.println("Unknown host!");
                    System.exit(1);
                }catch(IOException e){
                    System.out.println("No I/O");
                    System.exit(1);
                }
        }

        Client(String host, int port){
                try{
                    socket = new Socket(host, port);
                    out = new PrintWriter(socket.getOutputStream());
                    in = new BufferedReader(new InputStreamReader(socket.getInputStream()));
                    System.out.println("Socket created and now connected to "+socket.getPort());
                }catch(UnknownHostException e){
                    System.out.println("Unknown host!");
                    System.exit(1);
                }catch(IOException e){
                    System.out.println("No I/O");
                    System.exit(1);
                }
        }

        public void sendData(String a){
                out.println(a);
        }

        public void getData(){
                try{
                    String line = in.readLine();
                    System.out.println("Text received :" + line);
                } catch (IOException e){
                    System.out.println("Read failed");
                    System.exit(1);
                }
        }

        public void disconnect(){
                try{
                    this.socket.close();
                }catch(IOException ioException){
                    ioException.printStackTrace();
                }
        }
    } 
```

2.Clientside.java（客户端包的主类）

```
package client;

import org.hyperic.sigar.CpuPerc;
import org.hyperic.sigar.cmd.SigarCommandBase;
import org.hyperic.sigar.Sigar;

public class ClientSide {

public ClientSide(){

}

public static void main(String[] args) throws Exception{
    ClientSide client = new ClientSide();
    if ((args.length > 0) &&(args.length == 2))
    {

            int port = Integer.parseInt(args[1]);
            Client clientNetwork = new Client(args[0],port);
            System.out.println(clientNetwork.socket.getPort());
            String data = client.persentaseCPU();
            System.out.println(data);
            clientNetwork.sendData(data);                                

    }
    else{
        Client clientNetwork = new Client();
        String data = client.persentaseCPU();
        clientNetwork.sendData(data);
        }
    }

public String persentaseCPU() throws Exception{
    CpuNfo cpunfo = new CpuNfo();
    Sigar a = new Sigar();
    CpuPerc cpus = a.getCpuPerc();
    String percentage="idle "+CpuPerc.format(cpus.getIdle());
    return percentage;
}
} 
```

我只是想知道为什么当我`clientNetwork.sendData(data);`从 Clientside.java 调用它不起作用时，我错过了什么吗？我是否`sendData(String a)`在 Client.java 中正确创建了通过客户端套接字发送数据的方法？

非常感谢！

# parsing - 当 fscanf 没有找到格式字符串中定义的所有值时会发生什么？

> ID：11043048
> 
> 赞同：0
> 
> 时间：2012-06-15T00:08:38.047
> 
> 标签：parsing, input, scanf, configuration-files

在上下文中 - 我正在为一个将进入更大程序的类编写一个简单的独立配置文件解析器。我知道有非常有效的库（例如 BOOST）可以为我做到这一点，但该类必须是严格独立的（没有外部库）。

所以，我有一个可能看起来像这样的配置文件：

```
output_file : some_output_file.root
input_file : input_file.txt
potential_file : 
```

请注意，**potential_file**条目是空白的，应该这样读取。

我打算使用带有格式说明符的 fscanf

```
fscanf(cfg_file,"%s : %s\n",flag,value); 
```

**但是，在potential_file**标志的情况下会发生什么？字符串**值**会为空吗？或者 fscanf 会尝试读取文件中的下一个可用字符串吗？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-06-15T00:22:59.973

您应该检查 fscanf 的返回值。它返回成功解析的参数数量。如果您按照模式在第 3 行的冒号后没有空格，它不会为您创建一个空字符串。在这种情况下它将停止解析。如果您想在没有额外检查的情况下安全地进行操作，请在 fscanf 之前初始化 value。

`%s`意味着读取后续字符，直到找到空格。后者定义为空白、换行或制表符。所以它不会跳到下一行。

还要考虑一些用于配置的库，因为您已经以这种方式标记了您的问题。[YAML](http://www.yaml.org/)易于阅读，并且具有 C 绑定。

# c++ - C++11 std::condition_variable：我们可以将锁直接传递给通知线程吗？

> ID：11043049
> 
> 赞同：15
> 
> 时间：2012-06-15T00:08:48.103
> 
> 标签：c++, multithreading, concurrency, c++11, condition-variable

我正在学习 C++11 并发，我之前唯一的并发原语经验是在六年前的操作系统课上，所以如果可以的话，请保持温和。

在 C++11 中，我们可以写

```
std::mutex m;
std::condition_variable cv;
std::queue<int> q;

void producer_thread() {
    std::unique_lock<std::mutex> lock(m);
    q.push(42);
    cv.notify_one();
}

void consumer_thread() {
    std::unique_lock<std::mutex> lock(m);
    while (q.empty()) {
        cv.wait(lock);
    }
    q.pop();
} 
```

这很好用，但是我对需要`cv.wait`循环包装感到生气。我们需要循环的原因对我来说很清楚：

```
Consumer (inside wait())       Producer            Vulture

release the lock
sleep until notified
                               acquire the lock
                               I MADE YOU A COOKIE
                               notify Consumer
                               release the lock
                                                   acquire the lock
                                                   NOM NOM NOM
                                                   release the lock
acquire the lock
return from wait()
HEY WHERE'S MY COOKIE                              I EATED IT 
```

现在，我相信其中一件很酷的事情`unique_lock`是我们可以传递它，对吧？因此，如果我们可以这样做，那将是非常优雅的：

```
Consumer (inside wait())       Producer

release the lock
sleep until notified
                               acquire the lock
                               I MADE YOU A COOKIE
                               notify and yield(passing the lock)
wake(receiving the lock)
return from wait()
YUM
release the lock 
```

现在 Vulture 线程无法突袭，因为互斥锁从`I MADE YOU A COOKIE`到一直保持锁定状态`YUM`。另外，如果`notify()`需要您传递锁，这是确保人们在调用之前实际锁定互斥锁的好方法`notify()`（请参阅[Signaling a condition variable (pthreads)](https://stackoverflow.com/questions/5175435/signalling-a-condition-variable-pthreads)）。

我很确定 C++11 没有这个习语的任何标准实现。其历史原因是什么（仅仅是 pthreads 没有这样做吗？那么为什么会*这样*）？是否有技术原因导致冒险的 C++ 编码人员无法在标准 C++11 中实现这个习语，也许称之为`my_better_condition_variable`？

我也有一种模糊的感觉，也许我正在重新发明信号量，但我对学校的记忆不够，不知道这是否准确。

* * *

## 回答 #1

> 赞同：10
> 
> 时间：2012-06-15T00:35:40.513

最终的答案是因为 pthreads 没有这样做。C++ 是一种封装操作系统功能的语言。C++ 不是操作系统或平台。因此它封装了linux、unix和windows等操作系统的现有功能。

然而 pthreads 也有很好的理由来解释这种行为。来自开放组基本规范：

> 结果是，不止一个线程可以通过调用 pthread_cond_wait() 或 pthread_cond_timedwait() 作为一次调用 pthread_cond_signal() 的结果返回。这种效应称为“虚假唤醒”。请注意，这种情况是自我纠正的，因为如此唤醒的线程数是有限的；例如，在上述块的事件序列之后调用 pthread_cond_wait() 的下一个线程。
> 
> 虽然这个问题可以解决，但对于很少发生的边缘条件的效率损失是不可接受的，特别是考虑到无论如何都必须检查与条件变量相关联的谓词。纠正这个问题会不必要地降低这个基本构建块中所有更高级别同步操作的并发程度。
> 
> 允许虚假唤醒的另一个好处是应用程序被迫围绕条件等待编写谓词测试循环。这也使得应用程序可以容忍多余的条件广播或相同条件变量上的信号，这些条件变量可能被编码在应用程序的其他部分中。由此产生的应用程序更加健壮。因此，IEEE Std 1003.1-2001 明确记录了可能发生的虚假唤醒。

所以基本上声称你可以相当容易地`my_better_condition_variable`在 pthreads 条件变量（或 ）之上构建，`std::condition_variable`而不会降低性能。但是，如果我们放在`my_better_condition_variable`基础级别，那么那些不需要的功能的客户`my_better_condition_variable`无论如何都必须为此付费。

这种将最快、最原始的设计放在堆栈底部的理念，目的是在它们之上构建更好/更慢的东西，贯穿整个 C++ 库。在 C++ 库未能遵循这一理念的地方，客户经常（并且正确地）被激怒。

* * *

## 回答 #2

> 赞同：6
> 
> 时间：2012-06-15T00:31:27.150

如果您不想编写循环，则可以使用采用谓词的[重载](http://en.cppreference.com/w/cpp/thread/condition_variable/wait)：

```
cv.wait(lock, [&q]{ return !q.is_empty(); }); 
```

它被定义为等效于循环，因此它就像原始代码一样工作。

* * *

## 回答 #3

> 赞同：4
> 
> 时间：2012-06-15T00:30:33.390

即使您可以这样做，C++11 规范也允许`cv.wait()`虚假解除阻塞（以考虑具有该行为的平台）。因此，即使没有 vulture 线程（抛开它们是否应该存在的争论），消费者线程也不能指望有一个 cookie 等待，并且仍然需要检查。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2015-05-12T12:25:11.240

我认为这是不安全的：

```
void producer_thread() {
    std::unique_lock<std::mutex> lock(m);
    q.push(42);
    cv.notify_one();
} 
```

当您通知另一个等待锁的线程时，您仍然持有锁。所以可能是另一个线程立即唤醒并尝试在释放锁*之后*调用的析构函数*之前获取锁。*这意味着另一个线程最终会返回以永远等待。 *`cv.notify_one()`*

 *所以我认为这应该编码为：

```
void producer_thread() {
    std::unique_lock<std::mutex> lock(m);
    q.push(42);
    lock.unlock();
    cv.notify_one();
} 
```

或者如果您不喜欢手动解锁

```
void producer_thread() {
    {
        std::unique_lock<std::mutex> lock(m);
        q.push(42);
    }
    cv.notify_one();
} 
```*

# javascript - jQuery Mobile：单选选择菜单值干扰多选菜单的处理程序

> ID：11043050
> 
> 赞同：0
> 
> 时间：2012-06-15T00:09:21.600
> 
> 标签：javascript, jquery-mobile, handler, select-menu, multiple-choice

我正在创建一个 jQuery Mobile 页面，它有两个选择菜单，一个是多选，另一个是单选。多选菜单设置为触发处理函数，该函数循环通过菜单中的选定值。问题是每次触发处理程序时，单选菜单中的第一个值如何包含在循环中（如果您实现下面的代码，可以看到这一点）。

如果有人可以提出解决此问题的方法，将不胜感激。

```
<head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width,initial-scale=1" />
    <link rel="stylesheet" href="http://code.jquery.com/mobile/latest/jquery.mobile.min.css"
    />
    <script type="text/javascript" src="http://code.jquery.com/jquery-latest.min.js"></script>
    <script type="text/javascript" charset="utf-8" src="http://code.jquery.com/mobile/latest/jquery.mobile.min.js"></script>
    <script type="text/javascript">
        $(function () {

            $("#multipleChoiceMenu").on("change", {
                testdata: "test"
            }, multipleChoiceSelectHandler);

            function multipleChoiceSelectHandler(e) {
                navigationFilterGate = 0;
                $("select option:selected").each(function (i) {
                    var optionValue = $(this).val();
                    alert("loop " + i + " val " + optionValue);
                });
            };
        });
    </script>
</head>

<body>
    <div data-role="page">
        <div data-role="header"></div>
        <div data-role="content">
            <label for="select-choice-custom">Single Choice Menu</label>
            <select select name="singleChoiceMenu" id="singleChoiceMenu"
            data-native-menu="false">
                <option value="Menu1 Value1">Menu1 Value1</option>
                <option value="Menu1 Value2">Menu1 Value2</option>
                <option value="Menu1 Value3">Menu1 Value3</option>
            </select>
            <label for="select-choice-0" class="select">Multiple Choice Menu</label>
            <select name="multipleChoiceMenu" id="multipleChoiceMenu"
            multiple="multiple" data-native-menu="false">
                <option value="Menu2 Value1">Menu2 Value1</option>
                <option value="Menu2 Value2">Menu2 Value2</option>
                <option value="Menu2 Value3">Menu2 Value3</option>
            </select>
        </div>
    </div>
</body> 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-06-15T00:15:34.393

这是因为您使用的选择器过于笼统。

在您使用的地方`$("select option:selected").each(function (i)...`，您是在告诉 jQuery 选择“选择元素中的每个选定选项”，这当然包括单选菜单中的选定选项。

尝试将其更改为以下之一（应该可以正常工作，我不确定哪个更快）：

```
$("select[name=multipleChoiceMenu] option:selected").each(function (i)...
$("#multipleChoiceMenu option:selected").each(function (i)... 
```

第一个版本只选择名为 multipleChoiceMenu 的菜单，第二个版本按 id 选择。两个版本都应该忽略另一个菜单，这是您想要的。

# python - Python - 查找数组中最大的数字

> ID：11043055
> 
> 赞同：1
> 
> 时间：2012-06-15T00:10:35.237
> 
> 标签：python, math, sorting

好的 - 我有一个难题。到目前为止，我的脚本将页面标题转换为类别。这是基于关键字的，当有匹配时，会添加一定的分数，即有些单词的值是 10，有些只有 1。这会累积到每个类别的总分中。

```
[{15: [32, 'massages']}, {45: [12, 'hair-salon']}, {23,:[3, 'automotive service']}] 
```

索引是类别 id，第一个值是分数，第二个值是类别。

在某些情况下，这跨越了 10 多个类别匹配。

如何将其过滤到仅前 60-75%

即显然按摩和美发沙龙是最多的，因为它们远远高于汽车服务。但是我们使用的这种智能如何被编程呢？

我在想 stddev 可以提供帮助吗？

**编辑**

我正在尝试过滤掉低分项目，例如

```
data = [{15: [32, 'massages']}, {45: [1, 'hair-salon']}, {23:[1, 'automotive service']}]] 
```

按摩是本例中唯一的高分项目

```
data = [{15: [4, 'massages']}, {45: [2, 'hair-salon']}, {23:[1, 'automotive service']}]] 
```

斯蒂尔按摩

```
data = [{15: [10, 'massages']}, {45: [50, 'hair-salon']}, {23:[5, 'automotive service']}]] 
```

现在美发沙龙（因为它远高于其他）

所以我不需要将第一个（N）个对象，更何况，第一个比其他数字高 x 的对象作为标准偏差的百分比或形式。

所以 50 远高于 10 和 5

10 远高于 3 或 2

但是 9、8 和 6 大体相同

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2012-06-15T00:57:25.777

这是使用的解决方案[`heapq.nlargest()`](http://docs.python.org/library/heapq.html#heapq.nlargest)

```
import heapq

data = [{15: [32, 'massages']}, {45: [12, 'hair-salon']}, {23:[3, 'automotive service']}]

N = int(len(data) * 0.6 + 1)
print heapq.nlargest(N, data, key = lambda x: next(x.itervalues())[0]) 
```

这打印：

```
[{15: [32, 'massages']}, {45: [12, 'hair-salon']}] 
```

**编辑：**如果您想消除“*低分项目*”，那么您需要准确定义“*低分*”的含义。

下面是一些代码，它对“低分”有一个完全任意的定义：如果分数比最大值低一个以上的标准差，那么分数就是低的：

```
import math

data = [{15: [32, 'massages']}, {45: [1, 'hair-salon']}, {23:[3, 'automotive service']}]

scores = [score for d in data for cat,(score,name) in d.iteritems()]
score_mean = sum(scores) / float(len(scores))
score_stdev = math.sqrt(sum(abs(s - score_mean)**2 for s in scores) / float(len(scores)))

print [d for d in data if next(d.itervalues())[0] > (max(scores) - score_stdev)] 
```

这打印：

```
[{15: [32, 'massages']}] 
```

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-06-15T00:34:26.573

```
yourdata = [{15: [32, 'massages']}, {45: [12, 'hair-salon']}, {23:[3, 'automotive service']}]

# transfer your data into a more usable format
data = [(score,cat,name) for dat in yourdata for cat,(score,name) in dat.iteritems()]

# sort on descending score
data.sort(reverse=True)

# throw away the low-scoring items
data = data[:int(len(data)*0.6 + 1)] 
```

返回

```
[(32, 15, 'massages'), (12, 45, 'hair-salon')] 
```

（得分最高的两项）

# javascript - 使用原型模拟静态变量

> ID：11043061
> 
> 赞同：0
> 
> 时间：2012-06-15T00:11:44.287
> 
> 标签：javascript

```
function Person() {}
Person.prototype.population = 0;
Person.prototype.constructor = function(name) {
    this.name = name;
    console.log("Name: " + this.name);
    console.log("Population: " + (++this.population) );
}

var p = new Person("Wex"); 
```

以下代码似乎不起作用，尽管从逻辑上讲我觉得它看起来很合理。这怎么不显示名字和人口？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-06-15T00:14:46.433

[http://jsfiddle.net/zerkms/gvjEF/](http://jsfiddle.net/zerkms/gvjEF/)

```
var Person = function(name) {
    this.name = name;
    console.log("Name: " + this.name);
    console.log("Population: " + (++Person.population) );
};
Person.population = 0;

var p = new Person("Wex");
var p = new Person("Wex"); 
```

只要您想要静态类变量，您就需要：

1.  将其定义为`classname.varname`
2.  使用类名，而不是`this` ​</li>

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-06-15T00:15:02.193

试试这个：

```
function Person() {}
Person.staticProperty = "foo";
var obj = new Person(); 
```

staticProperty 是在 Person 对象中定义的，也就是函数。

# java - 在 JPA 中检索实体性能

> ID：11043063
> 
> 赞同：0
> 
> 时间：2012-06-15T00:11:58.793
> 
> 标签：java, google-app-engine, jpa

下面是我用来检索 Profile 实体的代码：

```
 EntityManager em = EMF.get().createEntityManager();
    return em.find(Profile.class, email); 
```

如果 Profile 有很多属性，其中一些是 List 或 Set 并且我只需要 3 个 String 属性（例如，姓氏、名字、生日），是否可以使用上面的代码进行检索，或者我必须编写一个查询检索只有那3个属性？

顺便说一句，该应用程序是在 Google App Engine 下运行的。

谢谢

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-06-15T04:53:52.683

我认为 AppEngine 不允许您从实体中仅选择 3 个属性。存储在 AppEngine 中的所有实体都将被视为您无法吐出的单位。

但是，如果 Profile 实体有一些子实体，那么最好不要获取它们。

# asp-classic - 在 ASP VB 中生成 HTML 电子邮件正文

> ID：11043064
> 
> 赞同：1
> 
> 时间：2012-06-15T00:12:08.187
> 
> 标签：asp-classic, vbscript, html-email

我想发送一封 HTML 电子邮件，其中电子邮件的正文基本上是另一个 HTML 页面。有可能这样做吗？要发送的 HTML 页面包含数据库记录。

我尝试使用`Msxml2.ServerXMLHTTP.3.0`生成 HTTP 请求并将其存储`response.Text`到电子邮件 HTML 正文变量中，但遇到与此类似的超时[问题](https://stackoverflow.com/questions/5559722/msxml3-dll-error-80072ee2-in-asp-page)。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-06-15T07:34:24.077

满足此要求的方法是创建一个 ASP 包含文件，该文件封装了原始页面的 HTML 生成，将其与 ASP Response 对象隔离开来。

然后原始页面将包含这个新文件，使用它来生成 HTML，然后将其发送到响应。您的电子邮件页面也可以包含这个新文件，并使用它来生成 HTML 以分配给`HTMLBody`CDO 消息的属性。

实际上，当原始页面可能在`<% %>`. 在这种情况下，我将生成一个中间 XML DOM，然后使用 XSL 将 XML 转换为所需的 HTML。

# iphone - 启用僵尸对象不足以帮助调试我的问题 - 我还能做什么？

> ID：11043067
> 
> 赞同：0
> 
> 时间：2012-06-15T00:12:31.727
> 
> 标签：iphone, objective-c, pushviewcontroller, presentmodalviewcontroller, memory-management

我收到以下运行时错误，我无法确定我的一生 WHYYYY。每当我从任何 VC执行或方法`Thread 1: EXC_BREAKPOINT (code=EXC_1386_BPT, subcode=0x0)`时，似乎都会发生错误。`dismissModalViewController:animated``pushViewController:animated`

我启用了僵尸对象，并在调试器中显示以下消息，`2012-06-14 16:34:58.769 MyApp[5952:17903] *** -[MyDetailsVC respondsToSelector:]: message sent to deallocated instance 0x8c3d400`.

这只发生在我访问 MyDetailsVC ViewController 之后**。**场景如下。

*   启动应用程序，一切正常，我可以从视图控制器中推送和弹出，并呈现和关闭模态 VC，没有任何问题。
*   我推到 MyDetailsVC，什么都不做，然后点击返回按钮。
*   我现在回到了推送到 MyDetailsVC 之前的位置，该应用程序继续完美运行，直到我必须推送到 VC 或呈现模态 VC。然后我得到运行时错误。

当我遇到错误时，MyDetailsVC 甚至不在图片中，也与其他 VC 没有任何关系。

我怎样才能更详细地使用调试器来确定这个问题是什么？

此外，错误消息说“消息已发送”，所以我已经在我的 VC 中评论了我所有的 NSNotifications，以排除我的一个 VC 试图向不再是的 VC 发送消息的可能性活着……没有运气！

PS - 我正在使用 Xcode 4.3.1、5.1 w/ARC

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-06-15T00:19:36.810

问题不在于 NSNotifications。Objective-c 中的消息只是函数/方法调用。看起来 respondsToSelector: 导致了这个问题。

检查 MyDetailsVC 是否有 [self respondsToSelector:@"some method here"]。也可能是在 MyDetailsVC 被解除和释放后，另一个对象在 MyDetailsVC 上调用了 respondsToSelector。确保在 ViewDidUnload 下的 MyDetailsVC 中将 @synthesized 属性设置为 nil 并停止所有挂起的 performSelector 调用。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-06-15T00:25:45.820

调试器中的回调堆栈中没有任何内容可以向您显示代码的哪一行正在发生？

respondsToSelector 在委托上被大量调用（以查看是否实现了协议中的可选方法）。您的 MyDetailsVC 是否将自己指定为任何事情的代表？如果是这样，请确保在您的 dealloc 例程中分配 xyz.delegate = nil 。

所以你可能有“self.navigationController.delegate = self”。因此，您需要在您的 dealloc 例程中匹配“self.navigationController.delegate = nil”。

# javascript - 从 json 文件中检索数据

> ID：11043072
> 
> 赞同：0
> 
> 时间：2012-06-15T00:14:02.637
> 
> 标签：javascript, jquery, json

我正在尝试从 .json 文件中检索数据，但它不检索任何数据，使用 jquery ！

json文件数据：

```
[
{"optiontext" : "One", "optionvalue" : "One"},
{"optiontext" : "Two", "optionvalue" : "Two"},
{"optiontext" : "Three", "optionvalue" : "Three"}
] 
```

我试图访问这些数据的代码是：

```
<!doctype html>
<html>
    <head> 
      <script type="text/javascript" src="jquery.min.js"></script>
    <script type="text/javascript"> 

    $(document).ready(function() {
            $('#submit').click(function () {
        $.ajax({

    //alert("I'm doing it now");
    //define the attributes for the connection
    type:"GET",
    url:"sample1.json",
    dataType:"json",
    //extrat the data

    success: function (data) {      
    var SampleFileMessage="<ul>";
    $.each(data, function(i,n){
    SampleFileMessage+="<li>"+n["optiontext"]+"</li>";
            });
    SampleFileMessage+="</ul>";
    $('#message').append(SampleFileMessage);
    document.writeln(SampleFileMessage);
}
});
return false;
});
});

    </script>
    </head>
    <body>
        <input type="button" onclick="getjson()" value="pressme"         style="align:center" />    
        <div id="messege"   > <input type="button" id="submit" value=" get the     data from json" ></div>
    </body>
    </html> 
```

我应该怎么做才能处理这种 json 格式！

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-06-15T01:33:39.270

尝试这个：

```
$.each(data, function(i, n) {
    SampleFileMessage += "<li>" + n.optiontext + "</li>";
}); 
```

# mongodb - Howto MongoDB更新/$设置整个子文档

> ID：11043073
> 
> 赞同：3
> 
> 时间：2012-06-15T00:14:02.533
> 
> 标签：mongodb, database, nosql

在我的 MongoDB 中，我有 Document1，如下所示。我想进入“main.accounts”（以及后来的“main.entries”）文档，并更新（$set）“content”数组中的整个子文档。Wrt 子文档，到目前为止，我'已经能够在“内容”子数组中添加和删除文档。但在这种情况下，我想更新整个文档；不仅仅是更新（$set）匹配文档中的一个属性。

下面，我尝试只使用一个 $set，一个带有 $elemMatch 的 $set。而且我也尝试过 findAndModify，但无济于事。当然，我已经 i) RTFM，环顾 ii) 互联网和 iii) SO，以找到解决方案。有没有人能够以这种方式更新整个文档？

谢谢蒂姆

**更新尝试 1** - 这是唯一有效的更新，但将整个“内容”数组设置为哈希 ... { "fu" : "bar" }

```
    db.bookkeeping.update(
      {
        所有者：“twashing@gmail.com”，
        “content.content.tag”：“帐户”，
        “content.content.id”：“一个”
      },
      { $set : { "content.$.content" : { "fu" : "bar" } } }
    )

```

**更新尝试 2** - 这不会失败，但不会更新有问题的文档

```
    db.bookkeeping.update(
      {
        所有者：“fu”，
        事情：{$elemMatch：{“content.content.tag”：“帐户”，“content.content.id”：“一个”}}
      },
      { $set : { "thing" : { "fu" : "bar" } } }
    )

```

**更新尝试 3** - 这不会失败，但不会更新有问题的文档

```
    db.bookkeeping.update(
      {东西：{$elemMatch：{所有者：“fu”，“content.content.tag”：“帐户”，“content.content.id”：“one”}}}，
      { $set : { "thing.content.content.$" : { "fu" : "bar" } } }
    )

```

**文件1**

```
    {
            “_id”：“fid”，
            “内容” ： [
                    {
                            “内容” ： [
                                    {
                                            “id”：“一个”，
                                            “标签”：“帐户”
                                    },
                                    {
                                            “id”：“两个”，
                                            “标签”：“帐户”
                                    },
                                    {
                                            “id”：“三个”，
                                            “标签”：“帐户”
                                    },
                                    {
                                            “id”：“四个”，
                                            “标签”：“帐户”
                                    },
                                    {
                                            “id”：“五”，
                                            “标签”：“帐户”
                                    }

                            ],
                            “id”：“main.accounts”，
                            “标签”：“帐户”
                    },
                    {
                            “标签”：“期刊”，
                            “id”：“main.journals”，
                            “内容” ： [
                                    {
                                            “标签”：“期刊”，
                                            “id”：“总账”，
                                            “名称”：“总账”，
                                            “类型” ： ””，
                                            “平衡” ： ””，
                                            “内容” ： [
                                                    {
                                                            “标签”：“条目”，
                                                            “id”：“main.entries”，
                                                            “内容” ： [ ]
                                                    }
                                            ]
                                    }
                            ]
                    }
            ],
            “所有者”：“福”，
            “标签”：“富巴”
    }

```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-06-15T06:57:18.503

您将无法使用位置运算符`$`更新第二级数组。（数组内的数组）

[此链接](https://stackoverflow.com/questions/10341151/mongodb-update-deep-array)可能对您有所帮助

* * *

## 回答 #2

> 赞同：-1
> 
> 时间：2012-06-16T12:51:18.423

我相信如果没有一些编程逻辑，您无法在 mongoDB 控制台中执行此操作，因为您在结构中使用了多个数组，并且您正在搜索子文档 (content[documents]) (main.accounts 和 main.entries)数组，它将返回相同的根文档，但在该返回值中，您无法知道内容数组中的哪个位置是您的标准。因此，您无法在正确的位置注入新值。

如果可能的话，我建议重组文档以避免太多嵌套数组（内容->内容->内容->内容），特别是如果您打算对它们的子集进行一些更新。毕竟这是 NoSQL，所以在你的设计中包含一些冗余数据很好，只要这让你的生活更轻松，你的代码更干净。

# css - 边框不透明度渐变

> ID：11043075
> 
> 赞同：0
> 
> 时间：2012-06-15T00:14:22.973
> 
> 标签：css, opacity

有没有办法让 div 的边框融入页面？所以我的意思是从不透明度 1 开始，然后通过 css 混合到不透明度 0？

谢谢

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-06-15T00:18:13.657

尝试使用`box-shadow` [https://developer.mozilla.org/en/CSS/box-shadow](https://developer.mozilla.org/en/CSS/box-shadow)

# visual-studio-2010 - 如何在 Visual Studio 2010 中添加除默认值之外的其他监视窗口？

> ID：11043078
> 
> 赞同：5
> 
> 时间：2012-06-15T00:15:00.973
> 
> 标签：visual-studio-2010

我只想显示多个 Watch 窗口。

在那里，他们说这是可能的：

[http://www.codeproject.com/Articles/121623/10-Tips-you-should-know-about-Watch-Window-While-d](http://www.codeproject.com/Articles/121623/10-Tips-you-should-know-about-Watch-Window-While-d)

但是我用不同的方式尝试了很多次丑陋的`ctrl+d,w`组合（`ctrl+d,w`, `ctrl+d,w,1`, `ctrl+d,w,2`, `ctrl+d,w,3`, `ctrl+d,w,4`）。我只能看到 Watch 1 窗口。

帮助！！！

* * *

## 回答 #1

> 赞同：17
> 
> 时间：2012-06-15T02:26:03.317

查看`Options --> Environment --> Keyboard`并查找调试快捷方式会提供以下默认快捷方式。一起按`Ctrl`+ `Alt`+ `W`，松开，然后按相应窗口的键盘数字键，而不是数字键盘数字键。或者，当您的程序正在运行时，只需转到`Debug --> Windows --> Watch`并选择您要添加的 Watch 窗口。

> Debug.Watch1 = `Ctrl`+ `Alt`+ `W`, `1`
> Debug.Watch2 = `Ctrl`+ `Alt`+ `W`, `2`
> Debug.Watch3 = `Ctrl`+ `Alt`+ `W`, `3`
> Debug.Watch4 = `Ctrl`+ `Alt`+ `W`,`4`

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2020-02-01T18:21:41.460

您也可以转到 Debug > Windows > Watch >，然后选择要查看的监视窗口。

这是它的外观图片：

[http://prntscr.com/qw4r80](http://prntscr.com/qw4r80)

这样做的好处是，一旦您激活了四个可用的监视窗口之一，它就会像这样保持可用：

[http://prntscr.com/qw4snf](http://prntscr.com/qw4snf)

# html - 即使使用快速显卡，3d css 动画 -webkit-transform 的性能也出乎意料地缓慢

> ID：11043080
> 
> 赞同：2
> 
> 时间：2012-06-15T00:15:02.880
> 
> 标签：html, css, 3d, webkit, transform

我有一个非常复杂的网络应用程序，它使用 -webkit-transform 和 -webkit-transition 完成了复杂的 60fps 动画。通常有几十个项目同时动画。当它“加速”时，动画看起来很棒，但是当用户输入时，动画中有时会出现非常明显的“减速”。大部分动画都非常高效，但是当许多项目从静态过渡到移动时，我无法在 javascript 中找到明显的延迟。

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-06-15T00:15:03.660

这很难追踪，但我已经完全修复了它：

问题似乎是，当一个没有 3d 变换的对象突然得到一个时，当该元素的位图被发送到视频卡时，就会出现“停顿”。当你有很多项目这样做时，它可能会非常引人注目，并将你的 60fps 体验变成......更少的东西。

答案很简单：在您的项目上保留“空”3d 变换，即使它们目前不是 3D。这样，图像将尽早传输到视频卡，当您需要为它们设置动画时，您不会遇到很大的延迟。

这将起作用：-webkit-transform: translateZ(1px)

这*可能*有效，但我可以想象它在未来的版本中被优化（因为它没有可见的效果）-webkit-transform: translateZ(0px)

# sql-server - 当调用用户没有 ALTER TABLE 时从存储过程调用 UPDATE STATISTICS

> ID：11043082
> 
> 赞同：1
> 
> 时间：2012-06-15T00:15:09.557
> 
> 标签：sql-server, stored-procedures, sql-server-2008-r2

我有一个应用程序，允许用户上传大型数据文件，然后解析数据并将其存储在 SQL Server 2008 R2 数据库中。

我想在导入数据的表上自动运行 UPDATE STATISTICS，因为用户可以对数据运行报告并且数据量非常大。

数据访问是通过存储过程完成的，用户对表没有权限，只能对存储过程执行。

我编写了一个存储过程来获取表名并使用 sp_Executesql 对传入的表名运行 UPDATE STATISTICS。存储过程和表都归 dbo 所有。我收到一条错误消息，提示“找不到对象“表”，因为它不存在或您没有权限。” 如果我将表上的更改授予用户，那么它可以正常工作，但我想避免这样做。我认为如果表和存储过程由同一所有者拥有，那么用户的权限将被忽略。

是否可以在没有更改表权限的情况下以某种方式运行 UPDATE STATISTICS？

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2012-06-15T02:34:43.770

如果您使用`sp_executesql`. 除非您使该过程在其他人的上下文中执行。而不是选择另一个用户，我宁愿创建一个没有登录的用户。因此，假设您有一个名为 的表`dbo.farb`，该用户`foobarblat`不能`ALTER`（`DENY`不是必需的，但它确实证明了这一点）：

```
USE master;
GO
CREATE LOGIN foobarblat WITH PASSWORD = 'foobarblat', CHECK_POLICY = OFF;
GO
USE YourDatabase;
GO
CREATE USER foobarblat FROM LOGIN foobarblat;
GO
CREATE TABLE dbo.farb(id INT);
GO
DENY ALTER ON dbo.farb to foobarblat;
GO 
```

现在让我们创建一个隐藏用户——我们可以给这个用户世界上所有的权限，因为实际上没有人可以作为这个用户登录，但是对于这个例子，我们可以`ALTER`在我们的表上授予）：

```
CREATE USER SuperSecret WITHOUT LOGIN;
GO
GRANT ALTER ON dbo.farb TO SuperSecret;
GO 
```

现在我们可以编写一个在`SuperSecret`用户上下文中执行的存储过程，但可以通过以下方式执行`foobarblat`：

```
CREATE PROCEDURE dbo.UpdateStats
    @tablename NVARCHAR(511)
WITH EXECUTE AS 'SuperSecret'
AS
BEGIN
    DECLARE @sql NVARCHAR(MAX);
    SET @sql = N'UPDATE STATISTICS ' + @tablename;
    EXEC sp_executesql @sql;
END
GO
GRANT EXEC ON dbo.UpdateStats TO foobarblat; 
```

现在在一个新窗口中使用`foobarblat`- 你应该能够执行这个没问题：

```
EXEC dbo.UpdateStats 'dbo.farb'; 
```

* * *

## 回答 #2

> 赞同：5
> 
> 时间：2012-06-15T17:31:16.913

除了 Aaron Bertrand 所说的之外，我将添加另一个解决方案：模块签名。所需步骤（简而言之）：

*   创建证书
*   将其导入 SQL Server
*   从证书创建登录
*   从登录创建用户
*   向用户授予权限（在本例中为 alter table）
*   用证书签署存储过程
*   将存储过程的 exec 权限授予需要运行它的任何人

我看到的优点是，当程序运行时，您会看到谁在实际运行它。缺点是对存储过程的任何更改都需要您重新签名（即签名不会在更改后持续存在）和一些初始设置。Aaron 的方法有相反的缺点/优点。

# data-structures - 循环链表检测算法

> ID：11043084
> 
> 赞同：0
> 
> 时间：2012-06-15T00:15:22.757
> 
> 标签：data-structures, linked-list, circular-list

所以我的问题是，在检测循环链表的乌龟和兔子/继承人算法中，为什么只需要将第二个更快的指针增加 2 ？我无法弄清楚我在这里也没有找到任何答案。

将第一个慢指针递增 1 是有意义的，这样我们就可以遍历所有将与第二个指针进行比较的元素，但为什么更快的指针只需要递增 2。为什么我们可以将它递增 3 或 4 或更多？？？

有没有办法计算应该是什么。相对于列表中元素数量的更快指针的跳数（如果不是 2）？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-06-15T11:12:42.147

您可以使用 3、4 或任何您想要的方式，但使用 2 是最快的方式，因为假设您第一次处于 2 步的循环中:( D 是要走 2 步的指针，S 是普通指针。
情况1）

```
step 1 :x - D - x - S - x - x ...
step 2 :x - x - x - D - S - x ...
step 3 :x - x - x - x - x - SD ( match) 
```

案例2）

```
step 1: x - D - S - x this is the step 2 from case 1 and we can see that this is step 2 and we also have a match 
```

但是如果你有一个 3 步（D 应该是一次走 3 步的指针。）

情况1）

```
 step 1 : x - D - x - x - S ...
   step 2 : x - x - x - x - D - S ...
   step 3 : x - x - x - x - x - x - S - D ... ( D is passing S and it needs at least another loop to meet S) 
```

案例2）

```
step 1 : x - D - x - S -..
step 2 : x - x - x - x - SD ( match) 
```

案例 3)

```
step 1: x - D - S - ..
step 2: x - x - x - S - D ... ( D is passing S and it needs at least another loop to meet S) 
```

因为 2 比 3、4 或任何你想要的更好，因为所有大于 2 的数字都有 1/(N-1) 的机会第一次相遇。
**另一种解释方式是：对于 D 和 S 以及 N 的步长，如果 S 和 D 之间的距离为 N - 1 我们有一个匹配项（D 走 N 步和 S 1 步而不是 D = S），其他方式 D正在通过 S，所以我们有 1/(N-1) 机会第一次遇到 S 和 D，因此如果 N = 2 我们有 1 / 1 = 100% ，如果 N = 3 我们有 1/2 = 50%。
希望它有所帮助。**

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-06-18T07:20:07.427

如果您使用 3 或 4 作为步长，则需要为所有特殊情况添加检查，当前进 3 可能导致第一个或第二个节点为空时。

此外，在循环的情况下，您有可能从较慢的位置与较快的位置重合的 3 个位置中的任何一个。

它只是更多的代码，更多的条件要处理，容易出错，并且使用超过 2 个似乎不太优雅，而在 Big O 方面没有任何性能提升

# c - 使用指针时 C 中的分段错误

> ID：11043085
> 
> 赞同：2
> 
> 时间：2012-06-15T00:15:24.063
> 
> 标签：c, pointers

我不知道这里发生了什么：

```
#include<stdio.h>
int main() 
{
    int i, j, *k, x,array[]={5,3,4,1,8,9,2,7,6,0};
    int *ptr=array;

    for(j=1;j<10;j++) {
        printf("---------iteration %d--------------\n",j);
        *k=*(ptr+j);   // the segmentation error is occurring here at this line
        printf("key=%d\n",*k);
        i=j-1;

        while( i>=0 && *k < *(ptr+i)) {
            *(ptr+i+1)=*(ptr+i);
            i--;
        }

        *(ptr+i+1) = *k;
        printf("%d\n",*(ptr+i+1));

        for( x=0;x<10;x++)
            printf("%d,",*(ptr+x));

        printf("\n");
    }

    for( i=0;i<10;i++)
        printf("%d,",*ptr++);

    printf("\n");
} 
```

错误发生`printf`在循环中的语句之后`for`，当我`*`从两侧删除它时它可以工作，但答案是错误的。

这是在 C 中使用指针的插入排序。

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-06-15T00:16:24.597

正如您所说，问题是，紧随其后`printf()`：

```
*k=*(ptr+j) 
```

我没有看右边。左边肯定有问题：指针没有初始化，所以写到那个地址几乎肯定会出问题。

右侧也有内存访问，但是，经过检查，它看起来可能没问题。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-06-15T00:24:00.363

您已经声明`k`为指针，但没有给它任何指向的内存，因此不知道当您写入它时会发生什么。给它一些内存来写入`k = malloc(sizeof array)`。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-06-15T10:36:09.283

正如其他人所说，您的部分问题是您正在使用一个未初始化的指针来存储一个值。阅读您的代码后，您似乎只是在使用 *k 来存储一个整数值，而不是其他任何东西；因此，您不需要指针，使用普通的 int 值就足够了：

```
int i, j, k, x,array[]={5,3,4,1,8,9,2,7,6,0}; 
int *ptr=array; 

for(j=1;j<10;j++) { 
    printf("---------iteration %d--------------\n",j); 
    k=*(ptr+j);   // the segmentation error is occurring here at this line 
    printf("key=%d\n",k); 
    i=j-1; 

    while( i>=0 && k < *(ptr+i)) { 
        *(ptr+i+1)=*(ptr+i); 
        i--; 
    } 

    *(ptr+i+1) = k;
} 
```

此外，虽然 *(ptr+i) 表示与 ptr[i] 相同的东西，但通常的 C/C++ 约定将使用后一种形式。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2012-06-15T12:15:23.230

下面的代码接近您的原始代码，修复了错误，并进行了一些调整以达到良好的效果。主要修复是替换`*k`为`key`（这几乎是@pst 和@SylvainL 已经说过的。）

从算法的角度来看，原因是您需要在外部的某个地方`array`保存正在移动的值，而其他`array`元素则被移动。否则你最终会覆盖`array`元素，我怀疑这是你从“ *......当我`*`从双方移除它的工作但答案是错误的”判断时发现的。* ”评论。

[插入排序的维基百科条目](http://en.wikipedia.org/wiki/Insertion_sort)有一个很好的动画，很好地说明了这一点：（
![在此处输入图像描述](../Images/378f7127593ce5532e5b8859ebc33f8b.png) 图片来自 Swfung8 [CC BY-SA 许可页面](http://en.wikipedia.org/wiki/File:Insertion-sort-example-300px.gif)）

请参阅其他调整的代码注释，因为它们与问题无关，只是您可以接受或离开的有用指针；-)

```
#include<stdio.h>

int main() 
{
    int array[]={5,3,4,1,8,9,2,7,6,0};

    int elm, key, i;
    int *ptr=array;

    // Calculate the number of array elements so the code will still 
    // work if the data set changes.  A good habit, rather than a necessity 
    // in this code, but it is used in two places... ;-) .

    int array_len = sizeof(array) / sizeof(int);

    for(elm=1; elm < array_len; elm++) {
        printf("---------iteration %d--------------\n",elm);
        key=(ptr+elm);
        printf("key=%d\n", key);

        // The while loop here was a for loop in disgise.

        for ( i=elm-1; i >= 0 && key < *(ptr+i); i-- ) {
            *(ptr+i+1) = *(ptr+i);
        }

        *(ptr+i+1) = key;
        printf("%d\n",*(ptr+i+1));

        // x declaration moved to here as it is only used as a loop counter

        for(int x=0; x < array_len; x++)
            printf("%d,",*(ptr+x));

        printf("\n");
    }

    for( i=0; i < 10; i++)
        printf("%d,",*ptr++);

    printf("\n");
} 
```

# ios - iOS - 展开本地 XML 文件

> ID：11043088
> 
> 赞同：0
> 
> 时间：2012-06-15T00:15:36.350
> 
> 标签：ios, xml, nsxmlparser, local-files

我正在从服务器上的 PHP API 加载 XML 文件。此 XML 被写入 Documents 文件夹。

我现在想从 API 获取新的 XML 数据并且不想再次下载整个文件，因为它非常大。所以我想把 XML 条目的 ID 发送到服务器，这样它就可以发回我 iPad 上没有的东西。

那不会是问题。但是我怎样才能访问文件并将行写到最后呢？XML 看起来像这样（例如）：

```
<items>
    <item id="0" name="Item one" photo="/images/products/one.png" />
    <item id="1" name="Item two" photo="/images/products/two.png" />
</items> 
```

`<item id="2" name="Item three" photo="/images/products/three.png" />`所以我需要在“items”节点中写入新的数据字符串（ ）？

谢谢，致以诚挚的问候，朱利安

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-06-15T01:36:43.420

您的问题似乎需要更好的解决方案。您可以使用 CoreData 为您的所有项目创建一个本地数据库（从 XML 文件中解析它们）。

每次获取“新”xml 时，都会更新 CoreData 数据库以反映新项目。如果项目已更改（如果需要），您甚至可以使用它来更新数据库。

Apple 有一个[有趣的文档，开始于 CoreData 编程](http://developer.apple.com/library/mac/#documentation/cocoa/conceptual/coredata/cdprogrammingguide.html)。

如果您打算成为苹果相关技术（iOS 和 OSX）的长期开发人员，CoreData 是您投资组合中的一个很好的工具。

# sql-server-2008 - T-SQL查询语句批量返回记录

> ID：11043094
> 
> 赞同：0
> 
> 时间：2012-06-15T00:16:24.693
> 
> 标签：sql-server-2008, tsql

存储过程返回 1000000 条记录。如何通过传递参数来修改它并返回 1-100,101-200,201-300（即引入分页）。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-06-15T00:44:14.077

请尝试并测试以下内容

只需在传递 pageindex 和 pagessize 时

```
PageIndex = 1 and PageSize=100 => 1-100
PageIndex = 2 and PageSize=100 => 101-200 and so on

CREATE PROCEDURE [dbo].[MyProc]
(
@PageSize int,
@PageIndex int
)
AS
/* SET NOCOUNT ON */
declare 
    @error int,
    @StartRow int,
    @EndRow int

if(@PageIndex < 1)
    Set @PageIndex = 1

Set @StartRow = (@PageSize * (@PageIndex - 1)) + 1
Set @EndRow = @PageSize * @PageIndex

    SELECT * FROM(  
        SELECT
            col1,
            col2,
            col3
        FROM 
    SomeTable s
) s
WHERE ((s.RowNumber Between @StartRow AND @EndRow)) 
```

# ruby-on-rails - 消毒输入

> ID：11043095
> 
> 赞同：2
> 
> 时间：2012-06-15T00:16:29.353
> 
> 标签：ruby-on-rails, params, sanitize

这可能是一个非常n00b的问题，但是如果您的参数列表包含一堆不可访问的属性，即

```
params = {"controller"=>"api1/users", "action"=>"create"} 
```

什么是“清理”你的参数的最佳方法，以便它们只包含可访问的属性。我目前想到的当前方法是：

```
User._accessible_attributes[:default].entries 
```

这给了我一个可访问属性的列表，然后只传递这些参数：

```
["", "email", "password", "fb_token", "fb_id", "fb_name", "first_name", "last_name", "gender" 
```

另一种可能的方法是：

```
 def clean_params #ANTIPATTERN
    params.delete(:controller)
    params.delete(:action)
  end 
```

但这也感觉像是一种反模式......

我知道您应该执行类似 params[:user] 的操作来仅获取可访问的参数，但因为这是一个 API，所以能够仅在 url 中传递东西会很好。

谢谢！

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-06-15T04:06:41.770

你可以这样做......这只会在你想要在控制器中的参数中感知。信用：[dhh的要点](https://gist.github.com/1975644)

```
class UserController < ApplicationController
  respond_to :html

  def create
    respond_with User.create(user_params)
  end

  private
  def user_params
    params[:user].slice(:email, :first_name, :last_name)
  end

end 
```

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-06-15T04:13:51.940

Rails 参数包装器会自动为您执行此操作。也就是说，它将在顶层接受参数并将它们分组，例如，`:user`为了您的方便，过滤掉用户模型无法访问的任何参数。它在内部使用`accessible_attributes`，类似于您所做的。使用您的 API 的人不需要对属性进行分组——rails 会在将参数交给您的控制器操作之前完成。

默认情况下，它为 JSON 请求打开，但您可以通过编辑`initializers/wrap_parameters.rb`. [`wrap_parameters`或者，您可以使用控制器中的方法](http://api.rubyonrails.org/classes/ActionController/ParamsWrapper/ClassMethods.html#method-i-wrap_parameters)在每个控制器的基础上调整行为。

The rails scheme of parameter sanitizing is likely to change in 4.0, trending away from the model and toward the controller. You may want to watch development of the [strong_parameters gem](https://github.com/rails/strong_parameters) which could be a preview of things to come.

# ruby-on-rails-3 - Rails 推入数组保存对象

> ID：11043096
> 
> 赞同：11
> 
> 时间：2012-06-15T00:16:42.777
> 
> 标签：ruby-on-rails-3, activerecord

我有一个有趣的问题。我正在使用 Ruby 1.9.2 和 Rails 3.1.3。

我有 2 个模型，为简化起见，假设客户和商店。商店有很多顾客，一个顾客属于一个商店。我正在尝试为一家商店收集所有客户，并为更多的客户创建一个地方，以便以后可以填充值。相反，当我不期望它时，会调用 customer.save。

```
store = Store.find(1)
customers_array = store.customers
random_array = Array.new
customers_count = customers_array.count + 1 

(customers_count..2).each do |i|
  customer = Customer.new
  c.id = "#{i}000000000000"
  random_array << customer # this line doesn't call customer.save
  customers_array << customer # this line calls customer.save when store has customers
end 
```

出于某种原因，当客户被推入数组时，会调用 customer.save。如果您推送的数组是普通数组而不是关系，则不会发生这种情况。

我找到了解决方法，但我仍然想知道为什么会发生这种情况。解决方法：

```
store = Store.find(1)
initial_customers_array = store.customers
additional_customers_array = Array.new
customers_count = initial_customers_array.count + 1 

(customers_count..2).each do |i|
  customer = Customer.new
  c.id = "#{i}000000000000"
  additional_customers_array << customer 
end
customers_array = initial_customers_array + additional_customers_array 
```

* * *

## 回答 #1

> 赞同：22
> 
> 时间：2012-06-15T00:59:56.650

`<<`是一个别名`push`

*   [http://apidock.com/rails/ActiveRecord/Associations/CollectionProxy/%3C%3C](http://apidock.com/rails/ActiveRecord/Associations/CollectionProxy/%3C%3C)
*   [http://apidock.com/rails/ActiveRecord/Associations/CollectionProxy/push](http://apidock.com/rails/ActiveRecord/Associations/CollectionProxy/push)

在`ActiveRecord::Associations::CollectionProxy`电话中`concat`

*   [http://apidock.com/rails/ActiveRecord/Associations/CollectionAssociation/concat](http://apidock.com/rails/ActiveRecord/Associations/CollectionAssociation/concat) *（查看方法源码）*
*   [https://github.com/rails/rails/blob/master/activerecord/lib/active_record/associations/collection_proxy.rb#L283](https://github.com/rails/rails/blob/master/activerecord/lib/active_record/associations/collection_proxy.rb#L283)

调用`concat_records`

*   [http://apidock.com/rails/v3.2.3/ActiveRecord/Associations/CollectionAssociation/concat_records](http://apidock.com/rails/v3.2.3/ActiveRecord/Associations/CollectionAssociation/concat_records)

在那里你可以看到插入发生。

因此，使用现有记录*（持久化到数据库中）*，运行`<<`或`.push`将记录插入到集合中，必要时将它们持久化到数据库中。调用`<<`一个数组，而不是记录集合，就像你在做的那样

```
random_array << customer 
```

调用 Ruby 的`<<`Array 方法，而不是 AR 等效方法*（如您所见，在这种情况下不进行保存）*。

**编辑：**需要明确的是，您找到的解决方法或多或少是我通常如何处理您正在处理的情况；我的回答更侧重于*为什么* `<<`会有这种行为。

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2013-09-15T19:46:32.557

解决此问题的另一种方法是将第二行（原始代码）更改为：

```
customers_array = store.customers.to_a 
```

这会将活动记录关联转换为真正的数组对象，因此该`<<`方法将是普通的 Array#push 方法。

# twitter-bootstrap - Twitter Bootstrap - 轮播过渡并不顺畅

> ID：11043098
> 
> 赞同：4
> 
> 时间：2012-06-15T00:17:38.153
> 
> 标签：twitter-bootstrap

堆栈溢出，

我让推特轮播开始工作，但到下一张幻灯片的过渡非常艰难。

它平稳地移动，在最后一秒向下移动并卡入到位。

[这](http://screencast.com/t/zxei1pdrprIz)是一个供参考的屏幕截图：

提前致谢！

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2012-11-21T17:11:44.433

我发现旋转木马不适合填充。如果您无法避免使用填充（因为我不能），请尝试使用 'top'、'left'、'right' 分别将轮播的 .next 和 .prev 元素定位到您正在调整的一侧以抵消这种转变。

您可能不得不通过重新加载反复修改它，以查看需要调整多少。

例如，为了偏移 carousel-inner 元素中的 40px 内边距以及左右对齐的元素中的其他内边距，我使用了：

```
.carousel .next {
  top: 40px;
  padding-left: 160px;
}

.carousel .prev {
  top: 40px;  
  padding-left: 160px;  
} 
```

我希望这会有所帮助。

# c++ - 虚拟继承会增加派生类的大小吗？

> ID：11043099
> 
> 赞同：3
> 
> 时间：2012-06-15T00:17:41.620
> 
> 标签：c++, size, virtual-inheritance

> **可能重复：**
> [对象大小与虚拟](https://stackoverflow.com/questions/2038717/object-size-with-virtual)

虚拟继承会改变派生类的大小吗？我执行了以下代码，其中我有两个派生类，一个是虚拟继承的，另一个是非虚​​拟继承的：

```
class A {
 public:
int a;
  virtual void a1();
};

class non_vir_der: public A{
 public:
int c;
  virtual void aa();
};

class vir_der: public virtual A{
public:
int d;
virtual void bb();
};

int main()
{
cout<<sizeof(non_vir_der)<<"\n";
cout<<sizeof(vir_der)<<"\n";
return 0;
} 
```

* * *

输出：

12（imo：4（int a）+ 4（int c）+ 4（vir ptr））

## 16（额外 4 个？）

为了再次检查我是否遗漏了什么，我尝试了所需的最少代码，方法是删除类中的所有整数，输出为：

4

## 4

第二个输出表明两个派生类的大小相同。为什么第一次运行时vir_der的大小是16，为什么不是12？

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2012-06-15T00:22:59.410

这种行为完全是特定于实现的，并且不能保证会发生什么。也就是说，大多数编译器通过放置基类的单个副本来实现虚拟继承，然后让派生类的每个实例在其类体内存储一个指向该唯一实例的指针。这样，如果您将对象转换为它的虚拟基，编译器可以发出代码来找出该对象的位置。正如您所观察到的，在 32 位系统上，这意味着虚拟继承可能会将对象的大小增加四个字节。

那么，如果没有数据成员，为什么没有区别呢？我不确定，但我猜这是因为编译器足够聪明，可以意识到如果您有一个没有数据成员的虚拟基类，您实际上不需要访问其中包含的任何内容。因此，可以通过消除指向虚拟基的额外指针来优化对象，因为永远无法访问它。不过，我可能错了。

希望这可以帮助！

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-06-15T04:16:03.093

基本上，当你声明一个函数或类 virtual 时，编译器会实例化一个 virtual

UPCAST​​ING 时需要的指针。实际上，创建了一个虚拟指针表

所有虚拟实例都与它们的实际地址一起存储。因此，当你继承

第二种情况下的虚拟类，创建了一个额外的 *vptr。

现在是第二种情况，为什么在这两种情况下都是 4 ......这完全是编译器特定的。

根据简单的逻辑，第一种情况下应该是 1，第二种情况下应该是 4。

谢谢

# ruby - 服务帐户身份验证如何与 Ruby Google API 一起使用？

> ID：11043101
> 
> 赞同：0
> 
> 时间：2012-06-15T00:17:42.733
> 
> 标签：ruby, google-api, google-api-client

我在 API 中看到了服务帐户源代码，但我不知道如何使用它来对 Google 服务进行身份验证。我看到的所有示例都是针对其他身份验证方案，而不是*service account*。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-06-15T01:34:35.960

几天前刚刚添加，文档尚未更新。刚刚在 wiki 上创建了一个页面，希望可以帮助您入门。

[http://code.google.com/p/google-api-ruby-client/wiki/ServiceAccounts](http://code.google.com/p/google-api-ruby-client/wiki/ServiceAccounts)

# .net - 如何使用 ClickOnce 部署非 .net 应用程序？

> ID：11043102
> 
> 赞同：2
> 
> 时间：2012-06-15T00:17:43.237
> 
> 标签：.net, deployment, clickonce

是否可以使用 ClickOnce 部署非 .net 应用程序？我真的很喜欢 ClickOnce 的自动更新功能，因此我希望能够使用它部署我的所有应用程序，但并不是我所有的应用程序都是用 .net 制作的。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-06-15T13:41:24.020

不，您不能像使用 C# 一样使用 ClickOnce。ClickOnce 的一项要求是应用程序的入口点必须是托管代码。

但是，您可以将任何文件与托管代码应用程序一起部署。标准的解决方法是创建一个 stub .NET exe 来简单地启动您的非托管应用程序。然后使用 ClickOnce 部署所有这些文件（托管 exe、非托管 exe 和依赖项）。

您可能需要使用[Mage](http://msdn.microsoft.com/en-us/library/xhctdw55.aspx)来创建 ClickOnce 部署，因为 Visual Studio 只是创建千篇一律的部署，并且不允许您配置所有可用选项。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-06-15T03:20:06.950

是的，这显然是可能的——至少对于 Visual c++ 应用程序来说是这样。它还在 VC++ 的 ClickOnce 页面上说，如果您的 dll 是 C# 项目的一部分，那么您也可以使用 C# 项目的 ClickOnce 部分来部署这些依赖项。这表明您也可以使用一个小型模拟应用程序来托管部署。

# regex - 返回完整文件名和路径的正则表达式

> ID：11043104
> 
> 赞同：1
> 
> 时间：2012-06-15T00:17:46.120
> 
> 标签：regex, excel, vbscript

我对正则表达式有点生疏，所以我真的可以使用一些专家的语法帮助。我正在寻找一个正则表达式，它将从字符串中**返回完整的文件名和路径。**我正在为 Excel 2010 VBA 使用参考“Microsoft VBScript 正则表达式 5.5”。我只需要正则表达式字符串。

这是我正在做的一个例子。如果字符串是

> =VLOOKUP($X18, 'E:\BUDGET 2012-13\Round 2 - final\program worksheets[AD allocations Support 2012 R2.xlsx]2013'!costcenter, Y$5+2, FALSE)

那么返回的值将是

> 'E:\BUDGET 2012-13\Round 2 - final\program worksheets[AD allocations Support 2012 R2.xlsx]2013'

或者

> 'E:\BUDGET 2012-13\Round 2 - final\program worksheets[AD allocations Support 2012 R2.xlsx]

（我可以围绕任一返回值进行编码）。谢谢！

**——DOH！--**

几分钟前我想通了。作为一个新手，我无法回答自己的问题，所以我在这里做 - 这里的一些规则很奇怪......无论如何......语法是

> '.+?'

并将返回

> 'E:\BUDGET 2012-13\Round 2 - final\program worksheets[AD allocations Support 2012 R2.xlsx]2013'

*如果您知道更好的方法，请随时发布。*

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-08-06T08:38:39.787

从我的正则表达式工具箱中复制：我已经使用[http://regexr.com?31oaq](http://regexr.com?31oaq)
`'([a-zA-Z]:\\(?:[^\\/:*?"<>|#]++\\)*+)([^\\/:*?"<>|#]+)'`
测试了您的数据，您将从第 1 组获得路径，从第 2 组获得文件名。我希望这可以帮助您:)

# arrays - 使用 Fortran 的数组问题中的二进制搜索

> ID：11043105
> 
> 赞同：5
> 
> 时间：2012-06-15T00:17:56.187
> 
> 标签：arrays, search, fortran

我正在使用 Schaum 的 Fortran 77 编程大纲，并且有一个关于使用括号组值方法进行二分搜索的示例。首先是代码：

```
 INTEGER X(100)
    INTEGER RANGE
    INTEGER START , FINISH

    PRINT *, 'Number of values ?'
    READ *, N
    DO 10 I = 1, N
        READ *, X(I)
    END DO 

    PRINT *, 'Enter Value'
    READ *, VAL

    START =  1 
    FINISH = N
    RANGE = FINISH - START 
    MID = (START + FINISH) /2

    DO WHILE( X(MID) .NE. VAL .AND. RANGE .NE. 0)
      IF (VAL .GT. X(MID))THEN
        START = MID 
      ELSE 
        FINISH = MID
      END IF
      RANGE = FINISH - START
      MID = (START + FINISH)/2
    END DO 

    IF( X(MID) .NE. VAL) THEN
      PRINT *, VAL, 'NOT FOUND'
    ELSE
      PRINT *, 'VALUE AT' , MID
    END IF
    END 
```

问题是，当我输入 7 个值数组时

> 2 | 9 | 11 | 23 | 49 | 55 | 66

并搜索 66 例如，当

> 中 = 5

，下一个循环的新 MID 变为 6 。但是当它是 6 时，它不能为下一个循环增加，因为

> 中间 = (开始 + 完成)/2 = (6+7)/2 = 6

当然应该是7。

它仍然在 6。当然，我的程序从不给我输出。我该怎么办？

* * *

## 回答 #1

> 赞同：11
> 
> 时间：2012-06-15T00:33:55.200

这只是一个错字，或者当他们从 C 版本翻译它并不得不更改索引时可能有人感到困惑。

循环中的关键不变量是，如果值在列表中，则该值必须落在数组中从索引开始到结束的某个位置，包括索引。但是一旦你排除了中间，它应该被从列表中取出。但它不在这里，所以列表总是太长，你会遇到你看到的问题。

正确的版本设置从 mid+1 开始，或从 mid-1 结束，以排除 mid。以 Fortran 90 风格编写的更正代码：

```
program binarysearch

    implicit none
    integer, allocatable, dimension(:) ::  x
    integer :: range, start, finish, mid
    integer :: i, n, val

    print *, 'Number of values ?'
    read *, N
    allocate( x(N) )

    do i = 1, n
        READ *, x(i)
    end do

    print *, 'Enter Value'
    read *, VAL

    start =  1
    finish = N
    range = finish - start
    mid = (start + finish) /2

    do while( x(mid) /= val .and. range >  0)
      if (val > x(mid)) then
        start = mid + 1
      else
        finish = mid - 1
      end if
      range = finish - start
      mid = (start + finish)/2
    end do

    if( x(mid) /= val) then
      print *, val, 'NOT FOUND'
    else
      print *, 'VALUE AT' , mid
    end if

    deallocate( x )

end program binarysearch 
```

# objective-c - 刷新 UIWebView

> ID：11043106
> 
> 赞同：1
> 
> 时间：2012-06-15T00:18:02.843
> 
> 标签：objective-c, ios, ios5, uiwebview, refresh

我正在寻找一种向我的 UIWebView 添加刷新机制的简单方法。我看过有关 EGO 拉动刷新的帖子，但老实说，我不明白它是如何工作的，特别是因为我不知道如何将它与 UIWebView 而非表格视图一起使用。在我看来，只是一次简单的刷新就需要很多开销。

我考虑过添加一个导航栏，但不是后退按钮，而是添加一个自定义的“刷新”按钮。但根据我目前的发现，它似乎和其他解决方案一样复杂。

所以，基本上，我想知道你会做什么。请记住，唯一的要求是用户有一些简单的方法来刷新视图。有什么建议吗？

*我是Objective-C的初学者，所以即使在下载并运行代码之后，我也不明白如何用UIWebView插入EGO框架。

* * *

## 回答 #1

> 赞同：12
> 
> 时间：2012-06-15T00:22:35.003

好，

创建一个按钮并在按钮的 IBAction 内部，

```
- (IBAction) performReload:(id) sender {
    [self.uiwebview reload];
} 
```

检查文档，它将在您的开始阶段为您提供很多帮助。

## 视觉建议：

![在此处输入图像描述](../Images/531f773deb1d55b43fe77daa0b3a83d0.png) [http://developer.apple.com/library/ios/#documentation/uikit/reference/UIWebView_Class/Reference/Reference.html](http://developer.apple.com/library/ios/#documentation/uikit/reference/UIWebView_Class/Reference/Reference.html)

# php - JS Lexer 检测函数调用

> ID：11043109
> 
> 赞同：0
> 
> 时间：2012-06-15T00:18:24.750
> 
> 标签：php, javascript, localization, lexer, codesniffer

为了本地化我的 javascript 中使用的字符串，我想扫描我的所有 js 文件以查找此类字符串。

我正在使用一个`t()`函数来请求字符串翻译，如下所示：

```
t("Hello world"); 
```

或动态部分：

```
t("Hello @user", {"@user": "d_inevitable"}); 
```

我想检测对`t()`函数的所有调用，从而收集 php“build”脚本中第一个参数中包含的字符串，但跳过以下内容：

```
function foo(t) {
   t("This is not the real t, do not localize this!");
}

function bar() {
    var t = function(){}; //not the real t either...
}

function zoo() {
    function t() {
       //This also isn't the real t() function.
    }
}

t("Translate this string, because this is the real t() in its global scope"); 
```

所以这里的简单规则是被调用的 t 函数必须在全局范围内，以便第一个参数有资格作为翻译字符串。

通常，不允许将动态运行时数据作为第一个参数。的第一个参数`t()`必须始终是“常量”文字字符串。

我认为[php codesniffer](http://pear.php.net/manual/en/package.php.php-codesniffer.php)会帮助我做到这一点，但是我能找到的所有文档都是关于执行代码标准（或检测违反它的）。我需要对其 js 词法分析器的较低级别的访问。

我的问题是：

1.  php 代码嗅探器的 js 词法分析器能帮我解决我的问题吗？
2.  如果是这样，我如何访问该词法分析器？
3.  是否有任何其他 php 库可以帮助我找到对的调用`t()`？

请不要建议独立的正则表达式，因为它们不可能完全解决我的问题。

先感谢您。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-06-15T03:27:16.750

您所描述的基本上是一个编码标准。当然，确保字符串正确本地化是许多项目标准的一部分。所以我认为 PHPCS 是适合您的工具，但您需要为它编写自定义嗅探，因为没有什么可以完全满足您的需求。

最好的办法可能是从 Github 克隆 PHPCS Git 存储库，然后在 CodeSniffer/Standards 下创建一个新目录以包含您的自定义嗅探。假设您将其称为 MyStandard。确保在其下创建一个 Sniffs 目录，然后创建一个子目录来存放新的嗅探器。看看那里的其他标准，看看它们是如何工作的。您还会发现从另一个标准复制现有的 ruleset.xml 文件并更改内容以适合您更容易。如果您不想在任何地方包含任何其他嗅探（您只想对代码运行此检查），那么您只需指定名称和描述并将其余部分留空。

有一个[基本教程](http://pear.php.net/manual/en/package.php.php-codesniffer.coding-standard-tutorial.php)涵盖了这一点。

在您的嗅探中，您显然希望它仅检查 JS 文件，因此请确保在 supportedTokenizers 成员 var（也在文档中）中指定它。这将确保始终忽略 PHP 和 CSS 文件。

当您开始进行实际检查时，您将对文件的已解析和标记化内容具有完全的低级访问权限。有很多辅助函数可以检查代码是否在其他范围内，或者帮助您在堆栈中来回移动以查找所需的代码位。

提示：使用 -v 选项运行 PHPCS 以查看文件中的令牌输出。它应该可以帮助您更轻松地查看结构。

如果你真的想正确地做事，你甚至可以为你的嗅探创建一个很好的单元测试，以确保它随着时间的推移保持运行。

毕竟，你会像这样检查你的代码： `phpcs --standard=MyStandard /path/to/code`

您可以在代码编辑器中使用许多 PHPCS 的集成。

您可能决定向标准添加新的更多嗅探以检查其他内容，然后您可以使用您的 ruleset.xml 文件或编写更多自定义嗅探类轻松完成。

我希望这会有所帮助。如果您决定编写自己的嗅探器并需要帮助，请告诉我。

# android - 如何使应用程序成为特定任务的默认设置？

> ID：11043110
> 
> 赞同：0
> 
> 时间：2012-06-15T00:18:43.673
> 
> 标签：android

我现在正在上移动编程课，我们必须制作一个简单的媒体播放器。现在我正在努力做到这一点，以便当用户打开 mp3 时，我的应用程序可能会作为默认设置出现？我该如何编码？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-06-15T00:22:59.917

> 如何使应用程序成为特定任务的默认设置？

*您*不能“将应用设为默认应用”。*用户*将其设为默认值。

> 现在我正在努力做到这一点，以便当用户打开 mp3 时，我的应用程序可能会作为默认设置出现？我该如何编码？

`<intent-filter>`在设置媒体播放的活动上尝试以下操作：

```
 <intent-filter>
            <action android:name="android.intent.action.VIEW" />
            <category android:name="android.intent.category.DEFAULT" />
            <data android:mimeType="audio/mpeg"/>
        </intent-filter> 
```

然后，如果某个应用程序触发了`ACTION_VIEW` `Intent`MP3 文件，您的活动应该与来自其他应用程序的其他活动一起出现在选择器对话框中。

# java - Android 键盘的附件视图（类似于 iOS 的 inputAccessoryView）

> ID：11043111
> 
> 赞同：8
> 
> 时间：2012-06-15T00:19:22.193
> 
> 标签：java, android, android-softkeyboard

有人可以指导我如何为 Android添加类似于**inputAccessoryView的内容吗？**

我想添加一排额外的自定义按钮，如键盘上方的栏中所示：

![在此处输入图像描述](../Images/7d23ef16f7435b6ff049efec18fc9d6e.png)

谢谢！

PS我使用的是标准的默认键盘。

* * *

## 回答 #1

> 赞同：8
> 
> 时间：2012-06-15T09:36:22.627

这是不可能的，除非您创建自己的输入法编辑器。您不能从您的应用程序中修改其他人的输入法编辑器。

在屏幕截图中，您认为“额外的一排自定义按钮”并不是输入法编辑器的一部分。这是活动的一部分。如果我不得不猜测，该活动的布局文件大致如下所示（仅限伪代码 - 这不会直接编译）：

```
<LinearLayout android:orientation="vertical">
  <ScrollView android:layout_height="0dp" android:layout_weight="1">
    <LinearLayout android:orientation="vertical">
      <!-- the form goes in here -->
    </LinearLayout>
  </ScrollView>
  <LinearLayout android:orientation="horizontal" android:layout_height="wrap_content">
    <!-- the button bar goes here -->
  </LinearLayout>
</LinearLayout> 
```

这与清单`android:windowSoftInputMode="adjustResize"`中的`<activity>`元素一起，应该为您提供所需的 UI——按钮栏将直接位于输入法编辑器的上方。

# asynchronous - f# 中使用 Async.FromContinuations 的自定义异步原语函数

> ID：11043112
> 
> 赞同：0
> 
> 时间：2012-06-15T00:19:24.297
> 
> 标签：asynchronous, f#

我对异步工作流程有点新手，我认为它有一些我不太了解的东西......我正在关注《真实世界函数式编程》一书，并以这种方式编写异步原语

```
let Sleep(time) =
  Async.FromContinuations(fun (cont, econt, ccont) ->
     let tmr = new System.Timers.Timer(time, AutoReset = false)
     tmr.Elapsed.Add(fun _ -> cont())
    tmr.Start()
  );; 
```

我尝试使用非常慢的阶乘实现编写自己的异步原语，代码是：

```
let rec factorial(n : int) (mem : bigint) =
   match n with
   | 0 | 1 -> printfn "%A" mem
   | _ ->  factorial (n - 1) (mem * bigint(n))

let BigFactorial(numero,mesaje)=
    Async.FromContinuations(fun (cont,error,cancelation) ->
                                printfn "begin number: %s" mesaje
                                factorial numero 1I |>ignore
                                printfn "End number: %s ." mesaje
                                cont()) 
```

现在我写了这个

```
 Async.RunSynchronously(async{
     printfn "Start!!..."
     do! BigFactorial(30000,"30M")
     do! BigFactorial(10000, "10M")
     printfn "End!!..."
 }) 
```

但它并没有精确地以异步方式运行....

```
Start!!...
begin number: 30M
2759537246219...(A nice long number!)
end number: 30M .
begin number: 10M .
2846259680917054518906...(other nice number)
End!!... 
```

如果我并行执行它，那么效果很好......

```
let task1 = async{
   printfn "begin"
   do! BigFactorial(30000,"30")
   printfn "end..." 
}

let task2 = async{
   printfn "begin"
   do! BigFactorial(10000,"10")
   printfn "end!!..." 
}

Async.RunSynchronously(Async.Parallel[task1;task2])

begin
begin: 30 
begin
begin: 10M

//long numbers here

end....
end..... 
```

* * *

但我希望知道第一个代码不起作用的原因（或几个原因！）......非常感谢我感谢任何帮助......

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-06-15T01:28:11.683

与**所有** `async`绑定一样，`do!`在当前线程上运行，因此您的两个连续`do!`s 顺序运行。

如果您希望它们并行运行，则必须明确说明：

```
async {
   printfn "Start!!..."
   let! tokenA = BigFactorial (30000, "30M") |> Async.StartChild // on new thread
   let! tokenB = BigFactorial (10000, "10M") |> Async.StartChild // on new thread
   do! tokenA // block until `BigFactorial (30000, "30M")` finishes
   do! tokenB // block until `BigFactorial (10000, "10M")` finishes
   printfn "End!!..." }
|> Async.RunSynchronously 
```

# crystal-reports - 主覆盖所有 OLAP 网格的 OLAP 多维数据集连接设置？

> ID：11043115
> 
> 赞同：1
> 
> 时间：2012-06-15T00:20:01.563
> 
> 标签：crystal-reports, olap-cube

我正在使用 Crystal Reports 12.3，并且在我文件中的每个报表中，我都有 OLAP 网格，我必须在其中单独设置它们的连接。目前我正在为每个单独的网格更改它：

> 突出显示 OLAP 网格 >（菜单）数据库 > 设置 OLAP 多维数据集位置...

有没有一种方法可以设置默认情况下所有 OLAP 网格都引用的主连接，而不必每次都更改它？

# perl - RequestTracker 和 Mason 一次又一次地摧毁我的班级

> ID：11043123
> 
> 赞同：2
> 
> 时间：2012-06-15T00:20:59.850
> 
> 标签：perl, mason, rt

我正在研究 Request Tracker，它是用 perl 编写的，并使用 Mason 作为 Web 界面。我正在尝试制作一个自定义页面，其中涉及一个自动处理程序、一个 html 页面，并在其他组合中引入了一些方法。我有一个简单的类，我想用它来跟踪我的部分界面所需的一些东西。现在它跟踪的只是一个数据库句柄。

```
package RTx::FooBar::Web;

use strict;
use warnings;

use RTx::FooBar::Handle;

sub new
{
        my $proto = shift;

        $RT::Logger->debug("creating new");

        my $class = ref($proto) || $proto;
        my $self = {};
        bless( $self, $class);

        my $handle = RTx::FooBar::Handle->new();
        $handle->Connect();
        $self->{cfHandle} = $handle;
        return $self;
}

sub DESTROY {
        my $self = shift;
        $RT::Logger->debug("destroy");

        delete $self->{cfHandle};
}

sub CFHandle
{
        my $self = shift;

        return $self->{cfHandle};
}

1; 
```

我尝试将其粘贴到会话中，以便可以在 Web 界面中任何需要的地方使用它。所以我尝试在一个网页中使用它——自动处理程序会：

```
% $m->call_next; 

<%INIT>
$RT::Logger->debug("my autohandler");
use RTx::FooBar::Web;
$session{cfWeb} ||= RTx::FooBar::Web->new();
</%INIT> 
```

现在困扰我的事情（除了它不工作的事实）是“新”方法中的日志记录打印了一次，但 DESTROY 方法中的日志记录打印了 56 次。每次，RTx::FooBar::Handle->DESTROY 中的调试也会打印出来，表明 $self->{cfHandle} 没有被删除。任何人都可以提出为什么会发生这种情况吗？是因为会话是绑定哈希吗？

****更新**** 我不再使用 $session，它在创建一次后仍然破坏了我的句柄 56 次。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-06-15T00:54:12.530

这里只是一个猜测 -`$session`从外部化版本（可能通过 Storable 等）重新创建您的对象。所以它在没有调用的情况下取回对象，`new`所以没有日志记录。不知道为什么它每次都会被摧毁。

它看起来`$session`实际上是一个绑定的哈希，一个`Apache::Session`或实现相同接口的东西（文档谈论数据库支持会话）。

如果您想拥有一个全局持久对象（即，不绑定到单个请求），那么给它一个完全限定的名称，例如，`$RTx::FooBar::Web::TheObject ||= RTx::FooBar::Web->new();`或使用类似`Cache::MemoryCache`. 或者，在设置中设置您自己的全局变量`MasonAllowGlobals`，尽管您可能需要进入 RT 的配置文件来更改它。

# android - OpenGLRenderer 内存不足

> ID：11043125
> 
> 赞同：0
> 
> 时间：2012-06-15T00:21:12.023
> 
> 标签：android, user-interface, tablelayout

我正在尝试创建一个包含大量数据的表格布局，表格布局位于滚动视图内。

我用这个来填充它

```
TableLayout tl;

.....

tl = (TableLayout) findViewById(R.id.layout);

..... 
```

当我设置它时，我会创建一个新的文本视图来像这样放入它

```
TextView tv;

....

tr = new TableRow(Context);

.....
tv = new TextView(Context);
tv.setText(progress[1]);
tr.addView(tv);
...
tl.addView(tr); 
```

当我在其中放入 12 个文本视图时会创建一个新的文本行，并且当其中有 12 个视图时将 tr 添加到 tl 中。

文本视图的字体大小是默认的，我对你在这里看到的文本视图所做的一切

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-06-15T00:24:06.127

考虑更改为可以回收/重用其子视图的视图组，例如列表视图或网格视图。这样，您就不需要将所有内容都保存在内存中。

# php - Javascript / PHP更新多个项目的innerHTML

> ID：11043126
> 
> 赞同：2
> 
> 时间：2012-06-15T00:21:13.330
> 
> 标签：php, javascript, ajax

我正在尝试在 onclick 事件后使用 Javascript 更新网页的 innerHTML。我的 Javascript (java.js) 使用[此代码](http://www.crackajax.net/ahahLib.js)访问 PHP 页面，该页面回显了 innerHTML 中的文本。问题是，我想更新两个项目（一个“颜色”表和一个“项目”表）的 innerHTML，它们不相邻并且具有不同的元素 ID。来自 java.js 的每个调用都可以单独正常工作（例如，如果一个被注释掉），但是当它们都运行时，无论第一个调用都会卡在“正在加载”消息上，而第二个调用会起作用。在 Web 浏览器中加载“content.php?item='5'&color='5'”会显示两个表。

我怀疑这与 $_GET[] 的机制有关（我不完全理解；这是我第一次使用 PHP）。但是调用应该顺序发生并且键（'item'和'color'）不会冲突，所以我不知道出了什么问题。

## java.js：

```
function makeActive(active_tab) {
    //item table
    callAHAH('content.php?item='+active_tab, 'item', 'getting items for tab '+active_tab+'. Wait...', 'Error');

    //color table
    callAHAH('content.php?color='+active_tab, 'color', 'getting colors for tab '+active_tab+'. Wait...', 'Error');
} 
```

## 内容.php：

```
if (isset($_GET['color'])) {
    require 'color.php';

    $index = 1*$_GET['color'];
    $arr = $ITEM_TYPES[$index];
    echoColorTable($arr); //makes table in color.php
} else {
    echo "color not set "; //debug
}

if (isset($_GET['item'])) {
    require 'item.php';

    $index = 1*$_GET['item'];
    echoItemTable($index); //makes table in item.php
} else {
    echo "item not set "; //debug
} 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-06-15T00:49:51.287

问题在于您链接到的[callAHAH函数。](http://www.crackajax.net/ahahLib.js)声明时没有`var`关键字`req`。所以它是一个全局变量，一次只能有一个请求。它还在 responseAHAH 函数中重用该全局变量。一般来说，由于这样的原因，全局变量是一个坏主意。我建议完全放弃 callAHAH 函数并使用类似这样的东西，它可以在不使用全局变量的情况下完成完全相同的事情：

```
function loadInto(url, id, loading, error) {
    var ajax;
    var el = document.getElementById(id);
    el.innerHTML = loading;

    if (typeof XMLHttpRequest !== 'undefined')
        ajax = new XMLHttpRequest();
    else // Some people still support IE 6
        ajax = new ActiveXObject("Microsoft.XMLHTTP");

    ajax.onreadystatechange = function(){
        if(ajax.readyState === 4){
            if(ajax.status == 200){
                el.innerHTML = ajax.responseText;
            }else{
                el.innerHTML = error;
            }
        }
    };

    ajax.open('GET', url);
    ajax.send();
} 
```

它也没有命名`callAHAH`，这总是一个加号。

# visual-studio-2010 - 如何使 TFS 不从 Visual Studio 自动检查源代码控制？

> ID：11043127
> 
> 赞同：1
> 
> 时间：2012-06-15T00:21:46.080
> 
> 标签：visual-studio-2010, tfs

每次我在 Visual Studio 中打开我的解决方案时，它都会尝试通信并验证每个文件在源代码控制中是否更新为最新。我正在做一个非常大的项目，想知道如何为这个解决方案禁用它？此外，我也很好奇如何启用它？

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-06-15T19:41:55.060

在 Visual Studio 2010 中：

1) 转到工具 -> 选项 -> 源代码管理 -> 环境。

2) 在“源代码管理环境设置”中，从下拉列表中选择“自定义”。

3）取消选中“打开解决方案或项目时获取所有内容”。

（这是一个全局设置。它不是特定于解决方案的。）

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-06-15T10:42:42.820

您可以安装 TFS 电动工具，假设您使用 TFS 2010，那么您可以[在此处](http://visualstudiogallery.msdn.microsoft.com/c255a1e4-04ba-4f68-8f4e-cd473d6b971f)下载它们打开 Visual Studio 命令提示符并运行命令，`tfpt connections`这将打开一个对话框，其中将显示您所有可用的 TFS 服务器和集合。

您可以尝试 2 个选项，首先取消选中“启动时自动连接到服务器”，这应该会在您打开解决方案时阻止 VS 尝试连接到 TFS。如果这不起作用，请单击 TFS 服务器旁边的“+”并选择您用于源代码控制的集合。点击“编辑”按钮，您应该会看到一个名为“服务器脱机”的复选框，选中此复选框，您将不再连接到 TFS。

要反转行为，请使用相同的工具将值切换回默认值

# java - Java 流应该在后备套接字关闭之前关闭吗？

> ID：11043128
> 
> 赞同：1
> 
> 时间：2012-06-15T00:21:48.633
> 
> 标签：java, sockets, networking, optimization, io

我有以下代码：

```
public void disconnect()
{
    running = false;
    if(thread != null)
        thread.interrupt();
    thread = null;

    try
    {
        socket.close();
    }catch(Exception e){e.printStackTrace();}
} 
```

我有一个从流中收集输入的 BufferedReader 和一个通过输出流发送消息的 PrintWriter。在我关闭套接字之前是否应该关闭 BufferedReader 和 PrintWriter？让 i/o 流保持打开状态是不是很糟糕？

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-06-15T01:23:25.223

您*必须*关闭*输出*流，以便它被刷新。这将关闭套接字和输入流。关闭其中任何一个都会关闭另外两个。您根本不需要关闭输入流。严格来说，为了安全起见，您可能还应该在 finally 块中关闭套接字本身。

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2012-06-15T00:32:46.007

根据[Java网络教程](http://docs.oracle.com/javase/tutorial/networking/sockets/readingWriting.html)

> “在关闭套接字本身之前，您应该关闭任何连接到套接字的流。”

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-06-15T00:29:50.583

如果您不关闭`BufferedWriter`，您可能会丢失一些缓冲但未刷新的数据。

还有一种观点认为你不应该使用`PrintWriter`，或者如果你这样做要小心，因为它会吞下`IOException`s。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2012-06-15T00:30:37.507

您打开的每个流都使用操作系统资源。当您在流上调用 close 时，它​​被标记为垃圾收集，并且内存在 GC 后被释放。如果您不关闭流，它将被 GC 关闭（[http://docs.oracle.com/javase/7/docs/api/java/io/FileInputStream.html#close%28%29](http://docs.oracle.com/javase/7/docs/api/java/io/FileInputStream.html#close%28%29)）但它是完全不清楚，GC什么时候会命中那个对象。

因此，最好关闭流以立即释放内存。

# xcode - iOS 游戏套件、纸牌游戏玩家和 GKVoiceChatService

> ID：11043130
> 
> 赞同：1
> 
> 时间：2012-06-15T00:22:00.853
> 
> 标签：xcode, gamekit, gksession, audiosession

我正在为 iOS 开发一款纸牌游戏。我认为游戏中心集成是我想要的东西，但就纸牌游戏而言，我不确定这对个人玩家来说意味着什么。从 Apple 类的参考资料来看，这似乎`GKPlayer`是我想要使用的，但我也有自己的玩家类，我认为我需要它来处理牌手。我想知道我的 Player 类中是否应该有一个`GKPlayer`对象，或者这是否是错误的处理方式。

我也想知道游戏中心的语音聊天（我知道这听起来与纸牌游戏完全无关，但请耐心等待）。我还没有看到它实现，所以我不完全确定它是如何工作的。基本上我需要的是它能够连接 4-10 名玩家，并且只是一种语音聊天之类的东西。这似乎是需要在屏幕上显示一些我想避免的东西。那将如何运作？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-06-15T00:41:15.680

### 第一个问题的答案：

Q：Player类应该有一个GKPlayer？

A：嗯，这将被认为是一个很好的设计。因为，GKPlayer 对象会让您知道当前正在参与游戏的已连接玩家的详细信息。但是，如果您可以使用名为 GKLocalPlayer 的 GKPlayer 子类会更好。因此，通过这种方式，您可以保持真实性，一个玩家使用一个设备。

有关多人游戏的更多信息：[单击此处！](http://developer.apple.com/library/ios/#DOCUMENTATION/NetworkingInternet/Conceptual/GameKit_Guide/Users/Users.html#//apple_ref/doc/uid/TP40008304-CH8-SW6)

似乎我们只能进行点对点语音聊天。（但请等待专家与他们自己的黑客分享更多细节！）

# jquery - 使用箭头键移动元素

> ID：11043144
> 
> 赞同：0
> 
> 时间：2012-06-15T00:24:31.220
> 
> 标签：jquery

我希望用户能够使用箭头键移动的页面上有 2 个 div。我尝试通过使用焦点来区分它们，但是太多的项目（如输入）可以获得焦点。目前，当我单击 div 时，我正在应用带有虚线的“聚焦”css 样式以使其突出并从其他 div 中删除样式。

```
.focused{
  border: 1px dashed #cccccc;   
}

$('#tagCommon').click(function(){
  $(this).focus().addClass("focus2");
  $('#tagLatin').removeClass("focus2");
}); 
```

我认为[这](https://stackoverflow.com/questions/7782266/jquery-move-div-with-arrow-keys)将有助于拦截关键事件。

那么我怎样才能只移动具有 focus2 类的对象呢？就像是：

```
$(document).keydown(function(e) {
    switch (e.which) {
    case 37:
        $('only the div that has class focus2').stop().animate({
            left: '-= 10'
        }); //left arrow key
        break;
    }
}); 
```

非常感谢你再次拯救我，托德

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-06-15T00:48:55.673

我不确定你是否还需要解决方案，但你可以看看这个：http: [//jsfiddle.net/ft2PD/41/](http://jsfiddle.net/ft2PD/41/)

这是html

```
<div id='div1'>
    <input type='text' value='hello' />
</div>

<div id='div2'>
    <label> World</label>
</div> 
```

​</p>

这是javascript：

```
$(document).ready(function(){
    $('#div1,#div2').click(function(){
        $('div.selected').removeClass('selected');
        $(this).addClass('selected');

    })}).keyup(function(e){
        var div = $('div.selected');
        console.log(div);
        console.log(e.which);            
        switch (e.which) {
    case 37:
        $(div).stop().animate({
            left: '-=10'
        }); //left arrow key
        break;
    case 38:
        $(div).stop().animate({
            top: '-=10'
        }); //up arrow key
        break;
    case 39:
        $(div).stop().animate({
            left: '+=10'
        }); //right arrow key
        break;
    case 40:
        $(div).stop().animate({
            top: '+=10'
        }); //bottom arrow key
        break;
    }
    });​ 
```

最后的CSS

```
#div1
{
    position: absolute;
    width:100px;
    height:100px;
    margin:15px;
    padding:15px;
    border: thin solid #D2D2D2;
}
#div2
{
    position: absolute;
    width:50%;
    margin:15px;
    padding:15px;
    border: thin solid #D2D2D2;
}
.selected
{
    border: 1px dashed #cccccc !important;
}​ 
```

# c++ - 如何在 StringStream 中插入新字符并在 C++ 的循环中提取到字符串？

> ID：11043149
> 
> 赞同：0
> 
> 时间：2012-06-15T00:24:58.647
> 
> 标签：c++, string, char, cstring, stringstream

我不确定我的代码有什么问题。我希望在 for 循环的每次迭代中更新字符并将其插入到字符串流中，并提取到一个字符串，我以后可以使用该字符串附加到一个 char[] 变量。我希望收到的变量内容的输出是：CPU 代表什么？A. 中央处理单元 B. 控制编程单元 C. 中央编程单元 D. 控制处理单元 相反，我得到了所有的 A。如何更新流中的值，以便 temp 采用值“A.”、“B.”、“C.”和“D.”。我对 C++ 并不陌生，但我对使用 stringstream 很陌生。谁能解释正在发生的事情以及我如何能够解决它？我在 Unix 环境中使用 g++ 编译器。

```
 char content[1096];
    int numOfChoices;
    char letterChoice = 'A';
    string choice, temp;
    stringstream ss;

    strcpy ( content, "What does CPU stand for?");
    cout << "How many multiple choice options are there? ";
    cin >> numOfChoices;
    cin.ignore(8, '\n'); 
    for (int i = numOfChoices; i > 0; i--)
    {
       strcat (content, "\n");
       ss << letterChoice << ".";
       ss >> temp;
       strcat(content, temp.c_str());
       ss.str("");
       cout << "Enter answer for multiple choice option " 
            << letterChoice++ <<":\n--> ";
       getline (cin, choice);
       strcat(content, " ");
       strcat(content, choice.c_str());
     }
       cout << content << endl; 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-06-15T03:26:58.810

执行插入和提取时，应始终检查是否成功：

**例子**

```
if (!(ss << letterChoice << "."))
{
    cout << "Insertion failed!" << endl;
} 
```

这样，您可以立即知道出了什么问题。在第一个循环中，当你这样做时，`ss >> temp;`它会提取流中的所有字符并将它们放入`temp`. 但是，已到达文件末尾，因此设置了 eofbit。因此，在您执行下一个循环时`ss << letterChoice << ".";`，操作将失败，因为设置了 eofbit。如果您在代码`ss.clear();`之后添加一个，`ss >> temp;`则代码将起作用，因为您在设置 eofbit 后重置了流状态。

但是，您的代码中不需要`stringstream`或所有那些旧的 C 函数。你可以这样`std::string`做：

```
string content = "";
int numOfChoices;
char letterChoice = 'A';
string choice;

content += "What does CPU stand for?";
cout << "How many multiple choice options are there? ";
cin >> numOfChoices;
cin.ignore(8, '\n'); 
for (int i = numOfChoices; i > 0; i--)
{
   content += "\n";
   content += letterChoice;
   content += ".";
   cout << "Enter answer for multiple choice option " 
        << letterChoice++ <<":\n--> ";
   getline (cin, choice);
   content += " ";
   content += choice;
 }
 cout << content << endl; 
```

# javascript - Chrome 中的锯齿状画布渲染

> ID：11043152
> 
> 赞同：4
> 
> 时间：2012-06-15T00:25:17.560
> 
> 标签：javascript, html, canvas

我正在使用 HTML 画布编写绘图应用程序。为了平滑绘制的线条，我在每个`mousemove`事件之后填充了一系列二次曲线：

```
 ctx.beginPath()
    ctx.moveTo(mx1-halfLastWidth*sin(angle), my1-halfLastWidth*cos(angle))
    ctx.quadraticCurveTo(mx1-lastWidth*cos(angle), my1+lastWidth*sin(angle),
      mx1+halfLastWidth*sin(angle), my1+halfLastWidth*cos(angle))
    ctx.quadraticCurveTo(xl+halfMidWidth*sin(angle), yl+halfMidWidth*cos(angle),
      mx2+halfCurrentWidth*sin(angle), my2+halfCurrentWidth*cos(angle))
    ctx.quadraticCurveTo(mx2+currentWidth*cos(angle), my2-currentWidth*sin(angle),
      mx2-halfCurrentWidth*sin(angle), my2-halfCurrentWidth*cos(angle))
    ctx.quadraticCurveTo(xl-halfMidWidth*sin(angle), yl-halfMidWidth*cos(angle),
      mx1-halfLastWidth*sin(angle), my1-halfLastWidth*cos(angle))
    ctx.fill() 
```

完整演示： http: [//jsfiddle.net/PfzM2/2/](http://jsfiddle.net/PfzM2/2/)（有很多不相关的代码，因为这是从一个更大的项目中提取的）

这些线条在 Firefox 中渲染得非常流畅，但在 Chrome 中看起来有些“锯齿状”：

![在此处输入图像描述](../Images/9237d4e0e34905af0806319bc44ad63c.png)

向浏览器发出的一系列命令和参数是相同的。

如何让 Chrome 像 Firefox 一样渲染线条？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-06-15T02:06:34.190

关于字体渲染，各地都提出了类似的问题。~~几乎可以肯定~~，这可能是同一个根本问题：渲染引擎​​产生的抗锯齿差异。如您所知，Chrome 使用 Webkit；FF，壁虎。Gecko 似乎比 Webkit 更喜欢抗锯齿。

将其归结为浏览器问题（我认为您通常会使用 IE 的方式）。

编辑：似乎反过来也是如此。Nick Heer 在[他的博客](http://nickheer.com/blog/layout/)中讨论了这一点：“由于 Gecko 更精确（和更块状）的抗锯齿，大多数衬线字体看起来并不好。” 可能是平台问题。

# objective-c - Xcode 中的 Facebook FQL 和 Graph API 返回单个视频

> ID：11043154
> 
> 赞同：1
> 
> 时间：2012-06-15T00:25:18.957
> 
> 标签：objective-c, xcode, facebook, facebook-graph-api, facebook-fql

我正在尝试做一个简单的查询来获取我的 Facebook 帐户中所有视频的列表。Facebook 上 FQL 控制台（或 Graph API 控制台）中的 FQL 查询返回正确数量的视频。但是，当从 Objective C 执行查询（GraphAPI 或 FQL）时，只返回一条记录（视频）。

在 Facebook FQL 控制台上：

```
SELECT vid, owner, title, description, updated_time, created_time  FROM video WHERE owner=me() 
```

在 Objective C 中（使用 Facebook 的 Wishlist 示例代码）：

```
NSMutableDictionary *params = [NSMutableDictionary dictionaryWithObjectsAndKeys: @"SELECT vid, owner, title, description, updated_time, created_time  FROM video WHERE owner=me()", @"query", nil];

NSLog(@"FQL: %@", params);

[facebook requestWithMethodName:@"fql.query" andParams:params andHttpMethod:@"POST" andDelegate:self]; 
```

当我在 request:didLoad 中打印“结果”时，它只包含一个视频。我不确定是什么导致了问题。任何帮助将不胜感激。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-06-15T01:03:05.943

此代码将为您提供 Facebook 帐户上的所有视频，包括您被标记的视频：

```
NSString *requestPath = @"/me/videos?fields=name,from,description,updated_time,created_time";   
[facebook requestWithGraphPath:requestPath andDelegate:self]; 
```

我个人只在必须在单个请求中执行多个查询时才使用 fql。在这种情况下没有必要。

要获取只有您自己上传的视频，您必须改为向 /me/videos/uploaded 发出请求。

上面请求的字段取自视频对象文档： [https ://developers.facebook.com/docs/reference/api/video/](https://developers.facebook.com/docs/reference/api/video/)

我希望这有帮助！

# ruby-on-rails - 提高 Rails 视图渲染的性能

> ID：11043159
> 
> 赞同：3
> 
> 时间：2012-06-15T00:25:55.853
> 
> 标签：ruby-on-rails, ruby, views, redis, scalability

我有一个电子商务 Rails 应用程序，出于报告原因，我们需要在其中输出客户在过去一年内在页面上下达的订单。现在，数据集非常大，在单个页面上显示这些订单需要相当多的 SQL 处理。这项任务最初非常缓慢，因此我将所有必需的订单详细信息移至 Redis 服务器，现在数据获取变得非常快，但我们还没有完全做到。

这是我们所拥有的：

```
Rendered **path**/sales_orders.html.haml within layouts/admin (39421.1ms)
Completed 200 OK in 44925ms (Views: 39406.8ms | ActiveRecord: 417.2ms) 
```

该应用程序托管在 Heroku 上，如果一个请求超过 30 秒，它就会被杀死。正如你所看到的，我们远远超过了这个限制。大部分时间都浪费在渲染视图上。

该页面包含一个日期过滤器，用户可以在其中选择从中选择订单的日期范围。因此，缓存不是理想的解决方案，因为日期范围可能每次都发生变化。

任何想法如何做到这一点？

Redis 键的格式为（以下是 Redis 哈希）：

```
orders:2012-01-01:123
orders:yyyy-mm-dd:$order-id 
```

用户只需提供一个日期范围，我就可以在订单命名空间下获得该日期范围内的所有键。

例如，我将如何从 Redis 订单键中获取客户名称：

```
= REDIS.hget(order_key, "customer_name") 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-06-15T07:24:36.503

几乎所有的时间都花在了渲染视图上。这可能意味着您有很多部分或其他复杂的视图逻辑。您的一些选择是：

1.  对输出进行分页，但为未分页的输出提供 PDF 或 CSV。
2.  简化您的视图逻辑......很多。
3.  尝试像循环这样的帮助程序，而不是渲染复杂的表格或嵌套的部分。
4.  使用 JSON 和 JavaScript 将您的渲染移至客户端。

就是这样，真的。如果其中一项或多项无法将您带到您需要去的地方，那么可能是时候重新审视您的要求了。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-06-15T07:59:49.323

我建议你使用片段缓存。读取片段非常快（约 0.5 毫秒），根据我的经验，通过不一次又一次地重新渲染部分片段，您会看到巨大的加速增益。这也是一个相当便宜的解决方案，因为 Rails 负责使片段无效（如果您将模型用作缓存键的一部分）并且它需要对模板进行最少的更改。即解决方案可以很简单：

```
<% @orders.each do |order| %>
  <% cache ["v1", order] do %>
    <%= render order %>
  <% end %>
<% end %> 
```

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2012-06-15T08:46:13.580

[考虑使用Heroku Scheduler](https://devcenter.heroku.com/articles/scheduler)插件通过定期任务构建报告。只要最后一分钟的订单不需要包含在报告中，您就可以每晚构建您的报告并立即下载以与您的早晨咖啡一起阅读，甚至将它们邮寄给您（或任何需要阅读的人）他们。）

如果您需要交互式选择报告期间，则需要将请求排队并使用[后台作业](https://devcenter.heroku.com/articles/background-jobs-queueing)构建报告。

# asp.net - ModalPopupExtender 点击 Droid Bionic

> ID：11043163
> 
> 赞同：1
> 
> 时间：2012-06-15T00:26:26.587
> 
> 标签：asp.net, ajaxcontroltoolkit, modalpopupextender

我在整个应用程序中使用 modalpopupextender 将记录添加到网格视图。最近我开始在我的 Droid Bionic 上对其进行测试，例如，如果我在模式窗口中有一个文本框，并且在所述文本框下方有链接，它将“单击”该链接，而不是将焦点设置在文本框上。单击链接时不会触发任何事件，但它确实阻止了我选择控件。

在与 CSS 斗争了一段时间后，我决定从应用程序中删除所有模式窗口并将它们放在自己的页面中，但在我遇到麻烦之前，我希望其他人遇到了这个问题，并修复了它.

# javascript - 按从最早到最晚的升序按小时分钟对对象数组进行排序

> ID：11043164
> 
> 赞同：0
> 
> 时间：2012-06-15T00:27:01.897
> 
> 标签：javascript, sorting

我有这段代码来对一组对象进行排序。对象中的数据是频道和时间（小时、分钟）。我希望根据从最早到最晚的时间按频道进行排序。

通过这种方式访问​​通道数据：

```
channel_array[icount].data[0].hour
channel_array[icount].data[0].minutes 
```

该`data`对象数组是这样的，并且已经排序：

```
[{hour:1, minutes:10},{hour:4, minutes:01}...] 
```

现在我只需要在数据数组的第一个元素上对通道从最早到最新进行排序`{hour:1, minutes: 10}`。我用三个嵌套循环来做到这一点。但这并不理想。有没有更好的方法来进行排序？

```
 var current_time = new Date();
        var current_hour = current_time.getHours();
        var comp_hour = current_hour - 1;
        for (var ih = 0; ih < 24; ih++) {
            comp_hour += 1;
            if (comp_hour == 24) { comp_hour = 0; }
            for (var minutes = 0; minutes < 60; minutes++) {
                for (var icount = 0; icount < channel_array.length; icount++) {
                    if (channel_array[icount].data.length > 0) {
                        var channel_hour = channel_array[icount].data[0].hour;
                        var channel_minutes = channel_array[icount].data[0].minutes;
                        var channel_phase = channel_array[icount].data[0].phase;
                        var next_day = channel_array[icount].data[0].next_day;
                        if (channel_phase.toLowerCase() == "pm" && channel_hour != 12) { channel_hour += 12; }
                        if ( parseInt(channel_hour) == parseInt(comp_hour) && parseInt(channel_minutes) == parseInt(minutes) && next_day != 1 ) {
                            channel_array_sort.push(channel_array[icount]); 
                        }
                    }           
                }
            }
        } 
```

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2012-06-15T00:33:07.537

天哪，这太复杂了！[将自定义比较器传递给`Array.sort`](https://developer.mozilla.org/en/JavaScript/Reference/Global_Objects/Array/sort)如何？
老实说，我很难弄清楚您要对哪个数组进行排序，但总的来说，它看起来像这样：

```
var input = [{hour:1, minutes:10},{hour:4, minutes: 1}, ...];
input.sort(function (a, b)
{
    // compare hours first
    if (a.hour < b.hour) return -1;
    if (a.hour > b.hour) return 1;

    // else a.hour === b.hour, so compare minutes to break the tie
    if (a.minute < b.minute) return -1;
    if (a.minute > b.minute) return 1;

    // couldn't break the tie
    return 0;
}); 
```

* * *

**注意**这执行就地排序，这意味着原始数组已被修改。如果这是不可接受的，只需在排序之前[复制数组即可。](https://developer.mozilla.org/en/JavaScript/Reference/Global_Objects/Array/concat)

```
var input = /* same as before */;
var output = input.concat();
output.sort(function ()
{
    // same as before
}); 
```

* * *

解决方案的起点，来自 OP：

```
channel_array_sort = channel_array.concat();

channel_array_sort.sort(function (a, b)
{
    if (a.data == undefined || b.data == undefined) return 0;
    if (a.data.length <= 0 || b.data.length <= 0) return 0;

    // compare hours first
    var a_hour = a.data[0].hour;
    if (a.data[0].phase == "pm") a_hour += 12;
    var b_hour = b.data[0].hour;
    if (b.data[0].phase == "pm") b_hour += 12;

    if (a_hour < b_hour) return -1;
    if (a_hour > b_hour) return 1;

    // else a.hour === b.hour, so compare minutes to break the tie
    if (a.data[0].minutes < b.data[0].minutes) return -1;
    if (a.data[0].minutes > b.data[0].minutes) return 1;

    // couldn't break the tie
    return 0;
});

var print_sort = JSON.stringify(channel_array_sort);                      
alert('print_sort b '+print_sort); 
```

# erlang - 无法分配 298930300 字节的内存（“old_heap”类型）

> ID：11043167
> 
> 赞同：7
> 
> 时间：2012-06-15T00:27:20.067
> 
> 标签：erlang

在对我的 erlang 服务器进行负载测试时，使用 +P（最大并发进程数）增加进程数（100、200、3000，...），并让 10 个进程向其余创建的进程发送 1 条消息进程，我在 erlang 控制台上收到一条消息：

> “故障转储已写入：erl_crash.dump。eheap_alloc：无法分配 298930300 字节的内存（类型为“old_heap”）。异常终止”。

我正在使用 Windows XP。当我创建进程（它正在工作）时没有问题。崩溃发生在进程开始通信（发送 hi 和接收 hello）之后，这是我唯一遇到的问题（顺便说一下，+hms 设置了进程的默认堆大小）。

我该如何解决这个问题？

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2014-09-29T14:11:57.847

如果有人会发现它作为此类问题的可能原因之一有用（因为我在任何地方都没有找到任何具体的答案），我们在rabbitmq服务器上遇到过类似的问题（linux，64位，持久队列，默认配置的水印）

eheap_alloc：无法分配 yyy 字节的内存（“堆”类型）

eheap_alloc：无法分配 xxx 字节的内存（“old_heap”类型）

问题在于一次重新排队太多消息。我们的“监控”代码使用带有重新排队选项的“获取”消息，而不限制要获取和重新排队的消息数量（在我们的例子中 - 队列中的所有消息都是 4K）所以有一次它试图添加所有这些消息返回队列服务器因上述消息而失败。

希望它能为某人节省几个小时。

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2012-06-15T09:40:46.137

`erl_crash.dump`使用[Crashdump Viewer 查看](http://www.erlang.org/doc/apps/observer/crashdump_ug.html)该文件：

```
/usr/local/lib/erlang/lib/observer-1.0/priv/bin/cdv erl_crash.dump 
```

（对于 Unix 路径表示歉意；您应该能够`cdv.bat`在 Windows 上的安装中找到一个。）

查看进程列表；以我的经验，通常会有一个非常长的消息队列的过程，你没想到它。

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2012-06-15T06:39:51.573

你内存不足。尝试减小默认堆大小或限制您启动的进程数。

更高级的解决方案包括分析您的应用程序以查看您是否可以在那里节省一些内存，例如更好地共享二进制文件或减少使用列表和大型消息（这会将数据复制到发送到的每个进程）。

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2012-06-15T09:10:16.163

您的一个进程尝试分配近 300MB 内存。您的服务器中可能存在内存泄漏。在适当的设计中，如果不是有意的，您不应该在一个进程中拥有这么大的堆。

# asp.net - 403 forbidden after publishing asp.net MVC

> ID：11043168
> 
> 赞同：28
> 
> 时间：2012-06-15T00:27:47.883
> 
> 标签：asp.net, .net, asp.net-mvc-3, iis

I know this has been answered a few times but none of the solutions worked for me. I published my ASP.NET MVC 3 application (It was just the internet template without any changes to it) to see if I could get it to work publically. However, when I visit the site it shows up with a 403 error. Coming from a php/linux background, I'm confused and have no clue where to look. I've only been learning .NET for about 8-9 months and everything I've been testing on before was on the local development server through VS2010\. It almost appears like the server doesnt know it should be an MVC application or I have to change my routing.

Anyway, I checked to make sure that the server setting is .NET 4\. Any help would be greatly appreciated.

ALSO, It's a shared hosting environment using arvixe.

* * *

## 回答 #1

> 赞同：55
> 
> 时间：2012-07-19T06:40:27.477

For me this did the trick (Original Answer by [Mmerrell](https://stackoverflow.com/users/125332/mmerrell) at [Getting 404.0 error for ASP.NET MVC 3 app on IIS 7.0 / Windows Server 2008](https://stackoverflow.com/questions/5111091/getting-404-0-error-for-asp-net-mvc-3-app-on-iis-7-0-windows-server-2008?answertab=votes#tab-top) )

> You actually just reminded me that I needed to fix this issue in an enviroment here. If your situation is the same as mine then it's a simple fix.
> 
> Just add the following to your web config:

```
<system.webServer> 
    <modules runAllManagedModulesForAllRequests="true" /> 
```

Make sure your have choosen the "ASP.Net 4.0" App-Pool and not the App-Pool created for your application. Make sure your App Pool uses the "ApplicationPoolIdentity" and NOT NetworkService. Remove the NetworkService permission from your root folder. You dont need it. IIS has an built-in identity (IIS_IUSRS).

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2012-06-15T00:30:42.763

403 is a forbidden error. Try checking the NTFS permissions of the folder where you deployed, ensure the `Network Service` user has read permission

![enter image description here](../Images/7849aa04ab1a006577815468d0a49755.png)

Additionally, check the Authentication and Authorization mechanism in the IIS application:

![enter image description here](../Images/e6eff1e06d213c84221c06e2f3858d96.png)

**Edited:**

.Net Authorization rules

![enter image description here](../Images/fb9aa647821d3ccc16bcfb3cbd7c18ba.png)

* * *

## 回答 #3

> 赞同：4
> 
> 时间：2012-10-03T00:49:42.483

I had this same issue after publishing an MVC 4 WebSite to a remote server using FTP Publishing. What ended up working for me was after publishing through Visual Studio, log onto IIS on the remote server, locate the published directory -> right click -> Convert to Application.

Not sure if there is a way to specify this in the web.config/properties, if you don't have access to the server?

* * *

## 回答 #4

> 赞同：3
> 
> 时间：2012-06-15T00:32:49.537

1- verify that your application is running under .NET 4.0 (you did so)

2- check with the hosting company that it supports the MVC 3 framework on their hosting plan.

3- (works) Bin-Deploy your MVC run-time libraries so you may overcome any requirements on the server.

More bout bin-deploy your ASP.NET MVC can be found here: [http://haacked.com/archive/2011/05/25/bin-deploying-asp-net-mvc-3.aspx](http://haacked.com/archive/2011/05/25/bin-deploying-asp-net-mvc-3.aspx)

4- check that "Network Service" has proper access rights to your folder. it basically should have "Read" permission.

* * *

## 回答 #5

> 赞同：2
> 
> 时间：2015-04-27T14:15:18.447

Don't forget about `aspnet_regiis.exe -ir`.

* * *

## 回答 #6

> 赞同：1
> 
> 时间：2014-10-10T16:37:53.990

```
<handlers>
  <add name="rewrite" path="*" verb="*" modules="IsapiModule" scriptProcessor="C:\Windows\Microsoft.NET\Framework\v4.0.30319\aspnet_isapi.dll" resourceType="Unspecified" requireAccess="None" preCondition="classicMode,runtimeVersionv4.0,bitness32" />
</handlers> 
```

Ask your hosting provider to add this handlers into webconfig

* * *

## 回答 #7

> 赞同：0
> 
> 时间：2013-09-09T12:54:01.820

Try changing the Managed Pipeline Mode of the Application Pool to 'Classic' instead of 'Integrated'. Whilst it may not be the final result that you're after (there can be real advantages in using Integrated mode), at least it will point you in the right direction... if it works.

# php - javascript 如果否定条件不起作用

> ID：11043169
> 
> 赞同：1
> 
> 时间：2012-06-15T00:27:55.120
> 
> 标签：php, javascript, jquery, html

我正在尝试计算两次之间的经过时间。当计算 PM 到 AM 时，它会给我一个否定的结果，所以我需要在负数上加上 12 小时才能得到正确的经过时间。为此，我必须添加条件`if ($some_result < 0)`。它适用于php但不适用于js，我不知道为什么

演示：http: [//jsfiddle.net/wH7sC/1/](http://jsfiddle.net/wH7sC/1/)

```
function calculateTime() { //gets time elapsed between 2 time marks

            var valuestart = $("select[name='timestart']").val();
            var valuestop = $("select[name='timestop']").val();

             //create date format          
             var timeStart = new Date("01/01/2007 " + valuestart).getHours();
             var timeEnd = new Date("01/01/2007 " + valuestop).getHours();

             var hourDiff = timeEnd - timeStart;      

              if ( hourDiff < 0 ) { //this is not working
                 hourDiff += 12;
             }

             return hourDiff;

}

//prepare function on load
$(document).ready(function() {
    $("select").change(calculateTime);
    calculateTime();
});

//execute function when changing select options
$(function() {
    $("select").change(function() {
        $( "#result" ).val( calculateTime() );
    });
}); 
```

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-06-15T00:31:34.120

这不是`if`声明失败。您需要添加 24，而不是 12：

[http://jsfiddle.net/sparebyte/wH7sC/2/](http://jsfiddle.net/sparebyte/wH7sC/2/)

我建议安装 Chrome、Firefox 或 IE9，打开 javascript 开发者控制台并使用该`console.log(...)`功能。我不推荐使用 IE9，它的输出让我想要。

# ruby-on-rails - 在 Ruby on Rails 中建模未知的部门/节数

> ID：11043171
> 
> 赞同：1
> 
> 时间：2012-06-15T00:28:09.207
> 
> 标签：ruby-on-rails, activerecord, acl9

在 Ruby on Rails 中，如何建模一个`Employee`可能属于 a`Section`并且可能属于`Section` **或不**属于另一个`Section`一直到`Organization`. 我正在寻找一组可以处理未知数量级别的模型。然后找出最直接的级别`Employee`，每个级别`Section`都有自己的管理员。

我希望使用acl9进行授权，但是如果级别数未知，我仍然无法弄清楚如何做到这一点。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-06-15T01:57:54.727

[祖先宝石](https://github.com/stefankroes/ancestry)听起来可能会满足您的需求。上面还有一个 railscast：[http ://railscasts.com/episodes/262-trees-with-ancestry](http://railscasts.com/episodes/262-trees-with-ancestry)

# android - 尝试将 SQLite DB 从数据复制到 SD 卡

> ID：11043175
> 
> 赞同：4
> 
> 时间：2012-06-15T00:29:09.830
> 
> 标签：android, sqlite, copy, android-sdcard

我正在使用以下代码，该代码发布在 Stack Overflow 上某处并为我的目的进行了修改：

```
try {
        File sd = Environment.getExternalStorageDirectory();
        File data = Environment.getDataDirectory();

        if (sd.canWrite()) {
            String currentDBPath = "//data//"+ "com.exercise.AndroidSQLite" +"//databases//"+"MY_DATABASE";
            String backupDBPath = "/temp/MY_DATABASE";
            File currentDB = new File(data, currentDBPath);
            File backupDB = new File(sd, backupDBPath);

                FileChannel src = new FileInputStream(currentDB).getChannel();
                FileChannel dst = new FileOutputStream(backupDB).getChannel();
                dst.transferFrom(src, 0, src.size());
                src.close();
                dst.close();
                Toast.makeText(getBaseContext(), backupDB.toString(), Toast.LENGTH_LONG).show();

        }
    } catch (Exception e) {

        Toast.makeText(getBaseContext(), e.toString(), Toast.LENGTH_LONG).show();

    }
} 
```

因此，当我尝试访问它时出现的错误是：

```
java.io.FileNotFoundException: /data/data/com.exercise.AndroidSQLite/databases/MY_DATABASE: open failed: EACCES (Permission Denied) 
```

我正在尝试在不植根平板电脑的情况下复制此文件。写外存目录权限在应用中设置；我只是无法解决这个错误。希望能帮助解决这个问题，这让我发疯

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-06-15T00:42:10.370

我正在我的 android 应用程序中备份我的数据库，它工作正常。如果您是它的所有者，您只能访问数据库文件，这意味着您的应用程序创建了它。

我认为你的路径是错误的，我的应用程序中有这个：

```
private static final String DATABASE_NAME = "my.db.name";

public File getBackupDatabaseFile() {
    File dir = new File(getStorageBaseDirectory().getAbsolutePath() + "/backup");
    if (!dir.exists()) {
        dir.mkdirs();
    }
    return new File(dir, DATABASE_NAME);
}
public final boolean backupDatabase() {
    File from = mContext.getDatabasePath(DATABASE_NAME);
    File to = this.getBackupDatabaseFile();
    try {
        FileUtils.copyFile(from, to);
        return true;
    } catch (IOException e) {
        // TODO Auto-generated catch block
       Log.e(TAG, "Error backuping up database: " + e.getMessage(), e);
    }
    return false;
} 
```

FileUtils.copyFIle 是这样的：

```
public static void copyFile(File src, File dst) throws IOException {
    FileInputStream in = new FileInputStream(src);
    FileOutputStream out = new FileOutputStream(dst);
    FileChannel fromChannel = null, toChannel = null;
    try {
        fromChannel = in.getChannel();
        toChannel = out.getChannel();
        fromChannel.transferTo(0, fromChannel.size(), toChannel); 
    } finally {
        if (fromChannel != null) 
            fromChannel.close();
        if (toChannel != null) 
            toChannel.close();
    }
} 
```

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-06-15T00:40:54.997

当您可能实际上想将其用作变量时，您实际上是在使用“MY_DATABASE”...

从它周围删除引号，看看这是否不能解决您的问题。

# jquery - 可以用 jQuery 完成这样的事情吗？

> ID：11043177
> 
> 赞同：2
> 
> 时间：2012-06-15T00:29:46.773
> 
> 标签：jquery

我想知道，像这样的小型 Flash 交互式演示文稿可以用 jQuery 完成吗（具有所有这些效果，如缓动、弹出、幻灯片等）？此处的示例：http: [//www.manh.com/platforms/manhattan-scope](http://www.manh.com/platforms/manhattan-scope) （单击右侧的“Manhattan SCOPE”）我想在 jQuery 中重新做一个类似的 Flash 演示文稿（或其他适合移动设备的东西） ）。我知道 jQuery，但不确定我到底需要什么才能将这样的东西组合在一起。谁能指出我解释如何构建类似 Flash 的演示文稿的资源？我需要什么 jQuery 插件？谢谢！

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-06-15T00:42:58.770

有问题的 Flash 具有以下效果：

1.  动画调整大小。
2.  动画淡入/淡出。
3.  动画字体大小。
4.  动画图形（右侧徽标周围的旋转圆圈）。

1、2 和 3 都是可以使用jQuery中[内置的 Effects 方法](http://api.jquery.com/category/effects/)`.slideUp`（分别是/ `.slideDown`/ `.slideToggle`、`.fadeIn`/ `.fadeOut`/`.fadeToggle`和`.animate`）来完成的。

您的第一步是彻底阅读 Effects 的文档并了解它们的工作原理。

4，另一方面，会很棘手。您最好的选择可能是使用静态 GIF 和动画 GIF，用鼠标悬停时的动画替换静态，反之亦然。

然而，总而言之，是的，我认为这个例子完全在 jQuery 的能力范围内。

# sql-server - 需要来自 SQL EXISTS 语句的 BOOLEAN 结果而不使用 WHERE 子句

> ID：11043181
> 
> 赞同：21
> 
> 时间：2012-06-15T00:30:01.830
> 
> 标签：sql-server, tsql, exists

在简单查询中是否有任何方法可以使用 SQL EXISTS 语句返回布尔值而不使用 WHERE 子句？

所有 2008 R2 SQL Server 联机丛书示例都显示了另一个 WHERE 子句和两个表。网站示例显示过程中的 WHERE 或 IF-THEN-ELSE。

我希望在一张桌子上做以下事情：

```
EXISTS
(SELECT  cx.id
 FROM fdd.admissions_view as cx  
 WHERE cx.id=1111 and cx.campus='MEXI') 
```

SELECT 语句工作正常并返回 ID。我只想添加 EXISTS 以返回 BOOLEAN，但上面的语法无效。

我可以做这样的事情吗？如果是这样，我在语法方面缺少什么？如果不是，还有什么其他技术可以工作？

请指教。谢谢。

* * *

## 回答 #1

> 赞同：18
> 
> 时间：2016-11-15T17:44:28.403

这是一个使用`EXISTS`with 的`CASE WHEN ... THEN .. ELSE ... END`，用 MySQL 和 Oracle 测试的：

```
SELECT 
  CASE WHEN EXISTS 
    (SELECT  cx.id
     FROM fdd.admissions_view as cx  
     WHERE cx.id=1111 and cx.campus='MEXI')
  THEN 1 
  ELSE 0 
  END 
FROM DUAL 
```

### 更新：

找到了一些相关的 Q/A：

*   [将 SELECT COUNT 优化为 EXISTS](https://stackoverflow.com/questions/5031471/optimizing-select-count-to-exists)
*   [可以直接选择 EXISTS 吗？](https://stackoverflow.com/questions/2759756/is-it-possible-to-select-exists-directly-as-a-bit)

* * *

## 回答 #2

> 赞同：16
> 
> 时间：2012-06-15T00:48:34.677

像这样的东西怎么样

```
select case when count(cx.id) > 0 then 1 else 0 end 
 FROM fdd.admissions_view as cx  
 WHERE cx.id=1111 and cx.campus='MEXI' 
```

?

* * *

## 回答 #3

> 赞同：12
> 
> 时间：2012-06-15T00:33:37.303

不完全确定您所说的“返回”是什么意思，但这里有一些想法。

```
DECLARE @return BIT = 0;
IF EXISTS( SELECT  cx.id
    FROM fdd.admissions_view as cx  
    WHERE cx.id=1111 and cx.campus='MEXI' ) SET @return = 1; 
```

或者：

```
IF EXISTS( SELECT  cx.id
    FROM fdd.admissions_view as cx  
    WHERE cx.id=1111 and cx.campus='MEXI' ) SELECT 1 AS returnValue 
```

* * *

## 回答 #4

> 赞同：6
> 
> 时间：2012-06-15T01:33:30.557

问题是这`EXISTS`只是某些语法结构中的有效语法。我不知道正式的规则（这意味着我应该去 RTFM :-？），但`EXISTS`可以包含在其中*用作表达式时*`case`会起作用：

 *```
set @r = case when exists (...) then 1 else 0 end

return case when exists (...) then 1 else 0 end 
```

例如

```
return case when exists (SELECT 1 -- because it's as good as anything else
    FROM fdd.admissions_view as cx  
    WHERE cx.id=1111 and cx.campus='MEXI')
  then 1 else 0 end 
```

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2021-06-27T02:28:32.843

根据 ryenus 的回答，一个在 MS SQL Server 上返回位结果的解决方案：

```
select 
    cast(
        case when exists
            (select id from fdd.admissions_view where id=1111 and campus = 'MEXI') 
        then 1 
        else 0 
        end 
    as bit) as Result 
```

如果没有强制转换，这将返回一个 int 结果。*

# php - 了解代码的工作原理；购物车总计

> ID：11043182
> 
> 赞同：-1
> 
> 时间：2012-06-15T00:30:02.900
> 
> 标签：php

我刚刚开始学习如何创建购物车。

遇到了这个例子：

```
<?php

   echo "Shopping cart:\n";

      $items = count($_SESSION['cart']);    
     {
         $total = 0;
    echo "<table width=\"100%\" cellpadding=\"1\" border=\"1\">\n";
            echo "<tr><td>Item Name</td><td>Quantity</td><td>Total</td></tr>\n";
            foreach($_SESSION['cart'] as $itemid => $quantity)
            {
                $query = "SELECT description, price FROM items WHERE itemid = $itemid";
                $result = mysql_query($query);
                $row = mysql_fetch_array($result, MYSQL_ASSOC);
                $name = $row['name'];
                $price = $row['price'];

                $subtotal = $price * $quantity;
                $total += $subtotal;

    printf("<tr><td>%s</td><td>%s</td><td>$%.2f</td></tr>\n", $name, $quantity, $subtotal);
            }
            printf("<tr><td colspan=\"2\">Total</td><td>$%.2f</td></tr>\n", $total);
            echo "</table>\n";
       }

?> 
```

该代码有效，我理解其中的大部分内容，除了“TOTAL 或 $total”部分：

*$小计=$价格*$数量；$总计 += $小计；*

正如我所说，它确实有效；如果我在购物车中放置两件物品，例如：5 块（数量）每块 5 美元的岩石和 2 块每块 10 美元的鹅卵石，我会在相应的表格行中获得 25 美元的小部件和 20 美元的小计为小工具。我假设

*$SUBTOTAL = $price * $quantity* ----- 对此负责，对吗？

我不明白 TOTAL 是如何得出的（这是正确的——45 美元）。

代码的哪一部分将各个小计（即 25 美元和 20 美元）相加？

**$total += $subtotal**是如何工作的？

我想了解代码是如何工作/处理的，而不仅仅是因为它有效而接受它。

提前致谢。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-06-15T00:32:59.683

```
$total += $subtotal 
```

只是以下的简写：

```
$total = $total + $subtotal; 
```

因此，要将其应用于代码：

```
// Start the total at 0
$total = 0;

// For every item in the cart
foreach($_SESSION['cart'] as $itemid => $quantity)
{
    // Get the item's price from the database
    $price = $row['price'];

    // The subtotal is the cost of each item multiplied by how many you're ordering
    $subtotal = $price * $quantity;

    // Add this subtotal to the running total
    $total += $subtotal;
} 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-06-15T00:35:36.950

运算符取表达式左侧的`+=`值，并将右侧的值相加。可以这样想：

```
$total = $total + $subtotal; 
```

`foreach()`循环遍历所有项目，并在每次迭代中通过将产品的单价乘以其数量来计算该产品的 total.price，该数量临时存储在`$subtotal`.

# php - foreach 和 facebook sdk

> ID：11043185
> 
> 赞同：-2
> 
> 时间：2012-06-15T00:30:24.907
> 
> 标签：php, facebook-graph-api

有人能告诉我这似乎是什么问题吗

```
 <?php 
      $increment =0;
      foreach($status['comments']['data'] as $user_status_comments_value){?> 
```

我得到一个

警告：在第 179 行的 /var/www/social/facebook/social/examples/dev.php 中为 foreach() 提供的参数无效

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-06-15T01:23:04.563

你需要重新排列你的代码

```
foreach($status['data'] as $statusupdate) {
    $user_status_comments_value = $statusupdate["comments"]
    //Dont forget you would still need to loop through each set of comments
    foreach($user_status_comments_value as $comment) {
        ///$comment["data"] contains a comment
        ...
    }
} 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-06-15T00:33:40.517

这意味着`$status['comments']['data']`不是数组。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-06-16T00:40:18.000

我让它工作每个人..谢谢

这是工作代码

[http://pastebin.com/taFgSL7J](http://pastebin.com/taFgSL7J)

# python - 从 Google 地图的边界框中获取匹配的 Lon / Lat 记录

> ID：11043190
> 
> 赞同：0
> 
> 时间：2012-06-15T00:30:49.880
> 
> 标签：python, django, google-maps

我正在使用一些谷歌地图边界框 lon/lat 点，需要在 MySql 数据库中找到所有记录，其中 lon/lat 位于该框中。

任何帮助都会很棒！

这是我正在玩的数据：

```
((-30.14348404555906,132.20886239843753),(-27.740202928232875,135.99914560156253)) 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-06-15T00:34:33.173

没有任何其他地理索引，您需要浏览数据库中的所有记录以查看它是否属于该框

```
-30.14348404555906 < lat < -27.740202928232875 
```

和

```
132.20886239843753 < lng < 135.99914560156253 
```

如果您需要进行大量此类操作并且您的数据库很大，我建议您使用一些地理空间结构，例如[rtree](http://en.wikipedia.org/wiki/R-tree)和[kd tree](http://en.wikipedia.org/wiki/K-d_tree)，或者考虑使用 lucene/solr

# c++ - c++ 到 vb.net，耦合转换问题

> ID：11043191
> 
> 赞同：0
> 
> 时间：2012-06-15T00:31:00.460
> 
> 标签：c++, vb.net, bitwise-operators

好的，这是我有点迷惑的函数（小生锈的位运算符）

```
void two_one(unsigned char *in,int in_len,unsigned char *out)
{
unsigned char tmpc;
int i;

for(i=0;i<in_len;i+=2){
    tmpc=in[i];
    tmpc=toupper(tmpc);
    if((tmpc<'0'||tmpc>'9') && (tmpc<'A'||tmpc>'F'))tmpc='F';
    if(tmpc>'9')
        tmpc=toupper(tmpc)-'A'+0x0A;
    else
        tmpc-='0';
    tmpc<<=4; //Confused here
    out[i/2]=tmpc;

    tmpc=in[i+1];
    tmpc=toupper(tmpc);
    if((tmpc<'0'||tmpc>'9') && (tmpc<'A'||tmpc>'F'))tmpc='F';
    if(tmpc>'9')
         tmpc=toupper(tmpc)-'A'+0x0A;
    else
         tmpc-='0';

    out[i/2]|=tmpc; //Confused Here
}
} 
```

我标记了两个我不太明白的地方。如果有人可以帮助我将这些部分转换为 Vb.Net，或者至少帮助我了解那里发生了什么，那就太棒了。

谢谢。

更新

所以这就是我想出的，但它并没有给我正确的数据......这里看起来有什么问题吗？

```
Public Function TwoOne(ByVal inp As String) As String
    Dim temp As New StringBuilder()
    Dim tempc As Char
    Dim tempi As Byte
    Dim i As Integer
    Dim len = inp.Length
    inp = inp + Chr(0)
    For i = 0 To len Step 2
        If (i = len) Then Exit For
        tempc = Char.ToUpper(inp(i))
        If ((tempc < "0"c Or tempc > "9"c) AndAlso (tempc < "A"c Or tempc > "F"c)) Then
            tempc = "F"c
        End If
        If (tempc > "9"c) Then
            tempc = Char.ToUpper(tempc)
            tempc = Chr(Asc(tempc) - Asc("A"c) + &HA)
        Else
            tempc = Chr(Asc(tempc) - Asc("0"c))
        End If
        tempc = Chr(CByte(Val(tempc)) << 4)
        Dim tempcA = tempc

        tempc = Char.ToUpper(inp(i + 1))
        If ((tempc < "0"c Or tempc > "9"c) AndAlso (tempc < "A"c Or tempc > "F"c)) Then
            tempc = "F"c
        End If
        If (tempc > "9"c) Then
            tempc = Char.ToUpper(tempc)
            tempc = Chr(Asc(tempc) - Asc("A"c) + &HA)
        Else
            tempc = Chr(Asc(tempc) - Asc("0"c))
        End If
        temp.Append(Chr(Asc(tempcA) Or Asc(tempc)))
    Next
    TwoOne = temp.ToString()
End Function 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-06-15T00:50:01.367

`tmpc <<= 4`将位向左移动`tmpc`4 位，然后将值分配回 tmpc。因此，如果`tmpc`是`00001101`，它变成`11010000`

`out[i/2]|=tmpc`用 对数组值进行按位或运算`tmpc`。因此如果`out[i/2]`is`01001001`和`tmpc`is `10011010`，则`out[i/2]`变为`11011011`

编辑（更新的问题）：`tmpc-='0';`原始代码中的行与您的新代码不完全相同`tempc = "0"c`。`-=`从变量中减去值，因此您需要`tempc = tempc - "0"c`或类似

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-06-15T00:46:52.473

`tmpc<<=4;`（或`tmpc = tmpc << 4;`）`tmpc`左移 4 位。

`out[i/2]|=tmpc;`（或`out[i/2] = out[i/2] | tmpc;`）`out[i/2]`与`tmpc`.

# linq - LINQ to Sql 使用匿名类型？

> ID：11043198
> 
> 赞同：0
> 
> 时间：2012-06-15T00:32:32.737
> 
> 标签：linq, linq-to-sql

多年来，我一直认为随着[C# 中匿名类型](http://msdn.microsoft.com/en-us/library/bb384061.aspx)的出现，例如：

```
// anon is compiled as an anonymous type
var anon = new { Name = "Terry", Age = 34 }; 
```

Linq to Sql 能够从结果集中构造匿名类型对象，例如：

***示例（假设语法）***：

```
var activeUsers = 
        from u in ConnectionStrings:Northwind.Users
        where u.IsActive = 1
        select UserName, FullName, Email, Description 
```

现在我可以对这个*集合*进行操作，例如：

```
foreach (var u in activeUsers)
{
    AddToListView(u.UserName, u.FullName, u.Email);
} 
```

这个简单、强大、易于使用的示例是幻想吗？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-06-15T13:44:57.917

Linq to Sql`DataContext`在查询数据库之前需要一个和关联的数据库元数据。

它也无法“使用”`web.config`连接字符串条目（因为没有静态设计时元数据，它无法编译查询。

# objective-c - 模拟 Skitch 的文字效果

> ID：11043199
> 
> 赞同：1
> 
> 时间：2012-06-15T00:32:45.673
> 
> 标签：objective-c, cocoa, core-graphics, core-text, skitch

[Skitch](http://skitch.com)有一个很好的效果，它将在白色背景上绘制文本。我想模仿这种效果。我在 Cocoabuilder 上找到[了这篇文章](http://www.cocoabuilder.com/archive/cocoa/184192-text-to-bezier-path.html)，其中给出了一个示例方法。它有点工作，但在轮廓上有一些非常尖锐的角落，而 Skitch 有很好的柔软角落。请注意，与我使用“两次绘制”算法的尝试相比，Skitch 的“S”点有多平滑（左侧是 Skitch，右侧是我的尝试）。

![斯基克的文字](../Images/77c3add8d8e7050fcd38e69170375c50.png) ![我的尝试](../Images/f2b54f3987c9ac9c860e073beba28d17.png)

关于采取什么样的方法来获得那些漂亮的软角有什么想法吗？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-06-15T15:57:19.433

我在这里的第一个想法是将字形转换为路径，然后在后面描边这些路径。请参阅[`CTFontCreatePathForGlyph`](https://developer.apple.com/library/mac/documentation/Carbon/reference/CTFontRef/Reference/reference.html#//apple_ref/c/func/CTFontCreatePathForGlyph)和类似的技术，了解这可能如何工作。

# jquery - jQuery将上一页h3添加到当前页面输入值

> ID：11043201
> 
> 赞同：1
> 
> 时间：2012-06-15T00:32:48.200
> 
> 标签：jquery, input

是否可以将上一页的 h3 添加到当前页面的输入值？我正在创建一个表单，并希望第一个输入值由前几页 h3 填充。

我有一个无序列表，每个列表项都有一个 h3，我想用它来填充输入值，每个列表项都有一个到表单的链接。因此，当单击该表单的链接时，列表项中的 h3 用于填充输入值。

这可能吗？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-06-15T00:40:55.770

如果您希望访问信息，则需要将其存储在某个地方。您可以在客户端存储数据或使用查询字符串或主题标签通过链接传递数据。

**在原始页面上**

```
<a href="nextpage.php?h3=test">link</a> 
```

**在接收页面上，假设 PHP**

```
<?
$heading = $_GET['h3'];
php echo '<input type="text">'.$heading.'</input>';
?> 
```

编辑评论：对于愚蠢的 aspers 使用谷歌 ;) [http://www.w3schools.com/asp/coll_querystring.asp](http://www.w3schools.com/asp/coll_querystring.asp)

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-06-15T02:02:49.600

您需要在页面之间保持元素的值，有几种方法可以做到这一点：

在**源**页面中：

*   请求参数

    ```
    myLink.NavigateUrl = "~/MyTargetPage.aspx?d=" + GetCurrentH3Value(); 
    ```

*   会议

    ```
    Session["d"] = GetCurrentH3Value(); 
    ```

*   饼干

    ```
    Response.Cookies["d"].Value = GetCurrentH3Value(); 
    ```

在**目标**页面中：

*   请求参数

    ```
    var lastH3 = Server.HtmlEncode(Request.QueryString["d"]); 
    ```

*   会议

    ```
    var lastH3 = Session["d"].ToString(); 
    ```

*   饼干

    ```
    var lastH3 = Request.Cookies["d"].Value; 
    ```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-06-15T02:15:20.843

仅使用 javascript (jQuery)：

首先创建一个读取查询字符串的函数，[这个问题](https://stackoverflow.com/questions/901115/get-query-string-values-in-javascript)有很多例子。

然后：

**来源**页面：

```
<ul id="listOfH3s">
   <li><h3>1</h3></li>
   <li><h3>2</h3></li>
   <li><h3>3</h3></li>
</ul>

$('#listOfH3s li').click(function() {
    window.location = 'mypage.aspx?h3=' + $(this).find('h3').text();
}); 
```

**目标**页面：

```
<input type="text" id="h3" />

$('#h3').val(getUrlParam('h3')); 
```

# ruby-on-rails - 如何在 Mongoid 中搜索带有 OR 语句的嵌入文档？

> ID：11043204
> 
> 赞同：1
> 
> 时间：2012-06-15T00:33:02.077
> 
> 标签：ruby-on-rails, mongoid

我尝试了几种方法来尝试做到这一点，但它们都不起作用：

```
User.where(name:"Jon Sparks").first.purchased_items.where
          ('(month = 5 AND year = 2012) OR (month = 6 AND year = 2012)')

User.where(name:"Jon Sparks").first.purchased_items.any_of
          ({:month => 5, :year => 2012}, {:month => 6, :year => 2012}) 
```

我想做的是`purchased_items`在 5/2012 或 6/2012 中提取所有嵌入的文档。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-06-15T03:30:41.970

这是您的查询

```
User.where(:name => "JohnSparks").first.purchased_items.where(:year => 2012, :month.in => [5,6]) 
```

# mysql - 在 MySQL 中选择两个查询与单个映射表的交集

> ID：11043210
> 
> 赞同：1
> 
> 时间：2012-06-15T00:33:41.937
> 
> 标签：mysql, join, inner-join, intersection, intersect

我确定这很容易，但是请帮助我，我无法弄清楚为什么我不能返回正确的结果。

相当标准的设置，我有一个 ref_product 表，一个 ref_tagmap 表和一个 ref_tag 表......

```
CREATE TABLE `ref_product` (
`id` DOUBLE ,
`name` VARCHAR (765),
`familyid` DOUBLE ); 

INSERT INTO `ref_product` (`id`, `name`, `familyid`) VALUES('264','Old Red Fixture 1','4');
INSERT INTO `ref_product` (`id`, `name`, `familyid`) VALUES('30206','Modern Red Fixture 2','405');

CREATE TABLE `ref_tag` (
`TagID` DOUBLE ,
`TagName` VARCHAR (150)); 

INSERT INTO `ref_tag` (`TagID`, `TagName`) VALUES('103','Modern Contemporary');
INSERT INTO `ref_tag` (`TagID`, `TagName`) VALUES('131','Red');

CREATE TABLE `ref_tagmap` (
`MapID` DOUBLE ,
`tagid` DOUBLE ,
`containertype` VARCHAR (45),
`containerid` DOUBLE ); 

INSERT INTO `ref_tagmap` (`MapID`, `tagid`, `containertype`, `containerid`) VALUES('17035','131','PROD','264');
INSERT INTO `ref_tagmap` (`MapID`, `tagid`, `containertype`, `containerid`) VALUES('17747','131','PROD','30206');
INSERT INTO `ref_tagmap` (`MapID`, `tagid`, `containertype`, `containerid`) VALUES('31959','103','PROD','30206'); 
```

使用以下方法查询这些表：

```
SELECT DISTINCT ref_product.familyid,ref_tag.tagid
FROM (ref_tag,ref_product)
JOIN ref_tagmap AS mt2 ON  mt2.containerid=ref_product.id
AND  mt2.containertype='PROD'
AND  mt2.tagid=ref_tag.tagid 
AND ref_tag.tagname='red' 
```

正确返回所有映射到标签“红色”的产品家族。相似地：

```
SELECT DISTINCT ref_product.familyid,ref_tag.tagid
FROM (ref_tag,ref_product)
JOIN ref_tagmap AS mt1 ON mt1.containerid=ref_product.id
AND mt1.containertype='PROD'
AND mt1.tagid=ref_tag.tagid 
AND LCASE(ref_tag.tagname)='modern contemporary' 
```

正确返回映射到标签“现代当代”的产品家族。问题是，我如何返回仅包含两个标签映射到它们的产品系列的列表？

我正在尝试这个，它返回空：

```
SELECT DISTINCT ref_product.familyid,ref_tag.tagid
FROM (ref_tag,ref_product)
JOIN ref_tagmap AS mt2 ON  mt2.containerid=ref_product.id
AND  mt2.containertype='PROD'
AND  mt2.tagid=ref_tag.tagid 
AND ref_tag.tagname='red'
JOIN ref_tagmap AS mt1 ON mt1.containerid=ref_product.id
AND mt1.containertype='PROD'
AND mt1.tagid=ref_tag.tagid 
AND LCASE(ref_tag.tagname)='modern contemporary' 
```

我不得不假设我在这里遗漏了一些基本的东西……感觉很密集。请帮忙。

谢谢！

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-06-15T01:08:23.287

执行此操作的典型方法是确保`tag`表中不同项目的数量等于您希望隔离的标签数量。
例子：

```
SELECT p.familyid
FROM   ref_product p
       JOIN ref_tagmap tm ON tm.containerid=p.id
       AND tm.containertype='PROD'
       JOIN ref_tag t ON t.tagid = tm.tagid
       AND t.tagname IN ('red',
                         'modern contemporary')
GROUP BY p.familyid 
HAVING count(DISTINCT t.tagid) = 2; 
```

在行动：[http ://sqlfiddle.com/#!2/f377e/7](http://sqlfiddle.com/#!2/f377e/7)

# tcl - Expect 中的并行处理

> ID：11043219
> 
> 赞同：3
> 
> 时间：2012-06-15T00:35:41.373
> 
> 标签：tcl, expect

下面的代码现在运行良好；但是，它是串行执行的。我希望能够滚动 source_list 文件，直到我获得最大数量的会话并让它们全部完成并将结果反馈给这个父脚本。这是可能的还是需要我更改我正在调用的脚本以反馈结果？我已经查看了 fork 命令，但它有点让我难以理解。

```
set source_list [lindex $argv 0]

set device_list [open $source_list r]
while {[gets $device_list ipaddress] != -1} {
spawn "./ios-upgrade.exp" 0 $ipaddress username password image-file MD5hash ftp-server
expect eof
}
close $device_list 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-06-15T02:12:09.413

您真正需要的是：

```
exec ./ios-upgrade.exp 0 $ipaddress username password image-file MD5hash ftp-server &
## No need for an expect statement here since you didn't spawn... 
```

`&`结尾处的字符`exec`将脚本置于 shell 中，因此您的循环不会因返回代码而被阻塞。

`ps auxw`但是，您将用户名和密码作为 CLI 参数发送，因此当有人这样做或类似情况时，它们也会显示在进程表中。我会将用户名/密码与您的 IP 地址存储在同一个文件中，并使用：

```
exec ./ios-upgrade.exp 0 $ipaddress image-file MD5hash ftp-server &
## No need for an expect statement here since you didn't spawn... 
```

完成后`ios-upgrade.exp`，让它编写一个名为类似的文件`ip_4_1_12_18.out`并遍历目录，直到您收到所有 IP 地址的状态。

* * *

OP的附加信息：

事实证明，上述答案中缺少的信息是评估变量，以便正确传递它。

```
exec ./ios-upgrade.exp 0 {*}$ipaddress image-file MD5hash ftp-server & 
```

*请注意，`{*}`仅适用于 TCL 8.5 及更高版本。

在以下找到答案：[如何在 tcl 中向 exec 添加可变数量的参数？](https://stackoverflow.com/questions/8535719/how-to-add-a-variable-amount-of-arguments-to-exec-in-tcl)

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-06-20T04:20:53.340

事实证明，上述答案中缺少的信息是评估变量，以便正确传递它。

```
exec ./ios-upgrade.exp 0 {*}$ipaddress image-file MD5hash ftp-server & 
```

*请注意，`{*}`仅适用于 TCL 8.5 及更高版本。

在以下找到答案：[如何在 tcl 中向 exec 添加可变数量的参数？](https://stackoverflow.com/questions/8535719/how-to-add-a-variable-amount-of-arguments-to-exec-in-tcl)

# javascript - 使用 jquery 选择的列从 html 表创建 json 对象

> ID：11043221
> 
> 赞同：2
> 
> 时间：2012-06-15T00:36:30.973
> 
> 标签：javascript, json, jquery

我想知道如何解析 html 表以获取我可以通过 $.post 和 jquery 发送的 json 对象。

我有一张桌子

```
<table id="Report">
 <thead>
  <tr>
   <th>Kod</th>
   <th>Nazwa</th>
   <th>Ilość</th>
   <th>Netto / 1szt.</th>
   <th>Suma brutto</th>
  </tr>
 </thead>
<tbody>
 <tr>
  <td>00171 </td>
  <td>SŁUP 50/1800 POŚREDNI(P) </td>
  <td>5</td><td>97.00 PLN </td>
  <td>394.31 PLN </td>
 </tr>
 <tr>
  <td>00172</td>
  <td>SŁUP 50/1800 NAROŻNY(P)</td>
  <td>1</td><td>97.00 PLN</td>
  <td>78.86 PLN</td>
 </tr>
 <tr>
  <td>00173 </td>
  <td>SŁUP 50/1800 KOŃCOWY(P) </td>
  <td>1</td><td>97.00 PLN </td>
  <td>78.86 PLN</td>
 </tr>
</tbody>
<tfoot style="font-weight: bold;">    
 <tr>
  <th colspan="3" style="text-align: right;">Razem netto: 1955.85 PLN</th>
  <th colspan="2" style="text-align: right;">Razem brutto: 2405.69 PLN</th>
 </tr>
 </tfoot>
</table> 
```

我需要的是这种格式的json对象（第一个`<td>`和第三个`<td>`）：

```
[{"00171":5},
 {"00172":1},
 {"00173":1}
] 
```

我可以通过

```
$.post(  
 "print.php",  
 {json: myjsonvar},  
 "json"  
); 
```

知道怎么做吗？

谢谢

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2012-06-15T00:41:11.733

```
var json = [];
$('#Report').find('tbody tr').each(function(){
    var obj = {},
        $td = $(this).find('td'),
        key = $td.eq(0).text(),
        val = parseInt( $td.eq(2).text(), 10 );
    obj[key] = val;
    json.push(obj);
}); 
```

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2012-06-15T00:41:46.737

怎么样：

```
var myjsonvar=[];

$('#Report tbody tr').each(function(){
   var data={};
   var tr=$(this);
   data[tr.find('td:first-child').text()]=tr.find('td:nth-child(3)').text();
   myjsonvar.push(data);
}); 
```

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2012-06-15T00:41:31.683

为什么是 json，如果你已经在 js 中了？只需创建一个简单的对象：

```
var data = {};

$("#Report tbody tr").each(function() {
   data[$(this).children("td:eq(0)").text()] = $(this).children("td:eq(2)").text();
});

$.post("print.php", data); 
```

将 type 设置为 json in`$.post`将服务器响应定义为`json`，而不是发送数据！

[http://jsfiddle.net/zyCPN/](http://jsfiddle.net/zyCPN/)

* * *

## 回答 #4

> 赞同：2
> 
> 时间：2012-06-15T00:46:25.180

```
var sendData = [];

$('#Report tbody tr').each(function(i, el){
    var key = $.trim($(this).find('td:eq(0)').text()),
        val = $.trim($(this).find('td:eq(2)').text()),
        obj = {};
    obj[key] = val;
    sendData.push(obj);
}); 
```

## [看演示](http://jsfiddle.net/csG5T/2/)

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2012-06-15T01:01:11.813

```
var objArray=[];
$('table#Report tbody tr').each(function(i){
    var row=$(this);
    obj={};
    obj[$('td', row).eq(0).text()]=$('td', row).eq(2).text();
    objArray.push(obj);
}); 
```

# maven - 将内部工件存储多长时间？

> ID：11043223
> 
> 赞同：1
> 
> 时间：2012-06-15T00:36:41.753
> 
> 标签：maven, artifactory

我有兴趣了解其他团队在限制内部工件存储方面正在做什么。那么内部工件在 Artifactory 中存储多长时间？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-06-16T09:54:17.910

Sonatype（Maven 和 Nexus 背后的人）发表了一篇关于这个问题的博客文章：

*   [http://www.sonatype.com/people/2012/01/releases-are-forever/](http://www.sonatype.com/people/2012/01/releases-are-forever/)

发布到我们的 Maven 存储库中的绝大多数文件都是快照版本。Nexus 和 Artifactory 都具有定期清除旧快照的功能（有助于控制磁盘）

发布版本的管理成为问题。在我看来，这分为几类

## 并非每个版本都被使用

在 QA 期间，某些版本被拒绝，这意味着在完全发布之前将它们发布到临时“登台”存储库中是有意义的。

我称这些为“候选发布版本”，而 Nexus Professional 拥有为我管理这些的[功能。](http://www.sonatype.com/books/nexus-book/reference/staging.html)（我假设工件也支持分期）

## 不是每个版本都需要

Sonatype 的博客解决了这一点。生产中的应用程序很少需要回滚到 6 个月以前的版本。Maven 存储库中的应用程序不太可能用作 3rd 方构建中的依赖项，因此它对持续存储的需求提出了质疑。

删除此类工件仍然是一个判断电话。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-06-15T06:52:53.543

我们存储每个已发布的工件，我很确定您也应该这样做，除非您有充分*的*理由不这样做。我们将快照限制为工件的最后一个，并且仅在没有此类发布版本的情况下，但是我们确保每个快照至少存在 3 天。在 Nexus 和 AFAIR 中设置它很容易，它或多或少是它关于快照的默认策略。

# java - 堆栈跟踪上的“coldfusion.runtime.RWLock”中的引用是什么

> ID：11043225
> 
> 赞同：1
> 
> 时间：2012-06-15T00:37:19.920
> 
> 标签：java, coldfusion

在以下声明中：

```
java.lang.Object.wait(Object.java:???)[Native Method]
- waiting on <0x6ab0eb48> (a coldfusion.runtime.RWLock)
coldfusion.runtime.RWLock.waitForLock(RWLock.java:154) 
```

“0x6ab0eb48”指的是什么？它是堆上的内存地址吗？它是对堆栈的某种引用吗？是否可以将该引用转换为有用的东西，例如导致阻塞的代码行？

在不同时间发生的相同问题的完整堆栈跟踪。

在 java.lang.Object.wait(Native Method) - 在 coldfusion.runtime.RWLock.waitForLock(RWLock.java:154) 在 Coldfusion.runtime.RWLock.requestWriteLock( RWLock.java:124) - 在coldfusion.runtime.RWLock.requestLock(RWLock.java:46)处的coldfusion.runtime.LockManager.requestNamedLock(LockManager.java:73)处锁定[0x00000000e0eac670]（coldfusion.runtime.RWLock） coldfusion.tagext.lang.LockTag.doStartTag(LockTag.java:186) at cfmodules2eJOModule$CD35DE93ADBE111EADECF17DDC3D9E362etransfer173107414$funcSETMODULECONFIGSMEMENTO.runFunction(D:\JO3\jobOffice\config\transfer\definitions\modules.JOModule$CD35DE93ADBE111EADECF17DDC3D9E36.transfer:193) at coldfusion .runtime.UDFMethod.invoke(UDFMethod.java:418) 在coldfusion.filter.SilentFilter.invoke(SilentFilter.java:47) 在coldfusion.runtime。Coldfusion.runtime.UDFMethod$ArgumentCollectionFilter.invoke(UDFMethod.java:324) 中的 UDFMethod$ReturnTypeFilter.invoke(UDFMethod.java:360) Coldfusion.filter.FunctionAccessFilter.invoke(FunctionAccessFilter.java:59) .runFilterChain(UDFMethod.java:277) 在coldfusion.runtime.UDFMethod.invoke(UDFMethod.java:463) 在coldfusion.runtime.TemplateProxy.invoke(TemplateProxy.java:453) 在coldfusion.runtime.TemplateProxy.invoke(TemplateProxy. java:320) 在coldfusion.runtime.CfJspPage._invoke(CfJspPage.java:2222) 在coldfusion.tagext.lang.InvokeTag.doEndTag(InvokeTag.java:362) 在coldfusion.runtime.CfJspPage._emptyTcfTag(CfJspPage.java:2662) ) 在coldfusion.runtime.UDFMethod.invoke(UDFMethod.java:418) 在coldfusion.filter.SilentFilter.invoke(SilentFilter.java:47) 在coldfusion.runtime.UDFMethod$ReturnTypeFilter.invoke(UDFMethod.java:360) 在coldfusion.runtime.UDFMethod$ArgumentCollectionFilter.invoke(UDFMethod.java:324) ) 在coldfusion.filter.FunctionAccessFilter.invoke(FunctionAccessFilter.java:59) 在coldfusion.runtime.UDFMethod.runFilterChain(UDFMethod.java:277) 在coldfusion.runtime.UDFMethod.invoke(UDFMethod.java:192) 在coldfusion.runtime .TemplateProxy.invoke(TemplateProxy.java:448) 在coldfusion.runtime.TemplateProxy.invoke(TemplateProxy.java:308) 在coldfusion.runtime.CfJspPage._invoke(CfJspPage.java:2272) 在cfTransferPopulator2ecfc918825853$funcPOPULATEONETOMANY.runFunction(D: \JO3\jobOffice\transfer\com\dynamic\TransferPopulator.cfc:113) 在coldfusion.runtime.UDFMethod.invoke(UDFMethod.java:418) 在coldfusion.filter.SilentFilter。在coldfusion.runtime.UDFMethod$ArgumentCollectionFilter.invoke(UDFMethod.java:324) 在coldfusion.runtime.UDFMethod$ReturnTypeFilter.invoke(UDFMethod.java:360) 在coldfusion.filter.FunctionAccessFilter.invoke 调用(SilentFilter.java:47) (FunctionAccessFilter.java:59) 在coldfusion.runtime.UDFMethod.runFilterChain(UDFMethod.java:277) 在coldfusion.runtime.UDFMethod.invoke(UDFMethod.java:192) 在coldfusion.runtime.TemplateProxy.invoke(TemplateProxy.java: 448) 在coldfusion.runtime.TemplateProxy.invoke(TemplateProxy.java:308) 在coldfusion.runtime.CfJspPage._invoke(CfJspPage.java:2272) 在cfDynamicManager2ecfc127705980$funcPOPULATEONETOMANY.runFunction(D:\JO3\jobOffice\transfer\com\ dynamic\DynamicManager.cfc:93) 在coldfusion.runtime.UDFMethod.invoke(UDFMethod.java:418) 在coldfusion.filter.SilentFilter.invoke(SilentFilter.java:47) 在coldfusion。runtime.UDFMethod$ReturnTypeFilter.invoke(UDFMethod.java:360) 在 coldfusion.runtime.UDFMethod$ArgumentCollectionFilter.invoke(UDFMethod.java:324) 在 coldfusion.filter.FunctionAccessFilter.invoke(FunctionAccessFilter.java:59) 在 Coldfusion.runtime .UDFMethod.runFilterChain(UDFMethod.java:277) 在coldfusion.runtime.UDFMethod.invoke(UDFMethod.java:192) 在coldfusion.runtime.TemplateProxy.invoke(TemplateProxy.java:448) 在coldfusion.runtime.TemplateProxy.invoke( TemplateProxy.java:308) 在coldfusion.runtime.CfJspPage._invoke(CfJspPage.java:2272) 在coldfusion.runtime 的cfTransfer2ecfc1432092572$funcLOADONETOMANY.runFunction(D:\JO3\jobOffice\transfer\com\Transfer.cfc:770)。 UDFMethod.invoke(UDFMethod.java:418) 在coldfusion.filter.SilentFilter.invoke(SilentFilter.java:47) 在coldfusion.runtime.UDFMethod$ReturnTypeFilter.invoke(UDFMethod.java:360) 在coldfusion.runtime.UDFMethod$ArgumentCollectionFilter.invoke(UDFMethod.java:324) 在coldfusion.filter.FunctionAccessFilter.invoke(FunctionAccessFilter.java:59) 在coldfusion.runtime.UDFMethod.runFilterChain(UDFMethod.java:277) 在coldfusion.runtime.UDFMethod.invoke(UDFMethod.java:192) 在 coldfusion.runtime.TemplateProxy.invoke(TemplateProxy.java:448) 在 coldfusion.runtime.TemplateProxy.invoke(TemplateProxy.java:308) 在 coldfusion.runtime.CfJspPage ._invoke(CfJspPage.java:2272) at cfmodules2eJOModule$CD35DE93ADBE111EADECF17DDC3D9E362etransfer173107414$funcLOADMODULECONFIGS.runFunction(D:\JO3\jobOffice\config\transfer\definitions\modules.JOModule$CD35DE93ADBE111EADECF17DDC3D9E36.transfer:140) at coldfusion.runtime.UDFMethod.invoke( UDFMethod.java:418) 在coldfusion.filter.SilentFilter.invoke(SilentFilter.java:47) 在coldfusion.runtime。Coldfusion.runtime.UDFMethod$ArgumentCollectionFilter.invoke(UDFMethod.java:324) 中的 UDFMethod$ReturnTypeFilter.invoke(UDFMethod.java:360) Coldfusion.filter.FunctionAccessFilter.invoke(FunctionAccessFilter.java:59) .runFilterChain(UDFMethod.java:277) 在coldfusion.runtime.UDFMethod.invoke(UDFMethod.java:192) 在coldfusion.runtime.CfJspPage._invokeUDF(CfJspPage.java:2471) 在cfmodules2eJOModule$CD35DE93ADBE111EADECF17DDC3D9E362etransfer173107414$runFfuncSTR \JO3\jobOffice\config\transfer\definitions\modules.JOModule$CD35DE93ADBE111EADECF17DDC3D9E36.transfer:303) 在coldfusion.runtime.UDFMethod.invoke(UDFMethod.java:418) 在coldfusion.filter.SilentFilter.invoke(SilentFilter.java:47 ) 在coldfusion.runtime.UDFMethod$ReturnTypeFilter.invoke(UDFMethod.java:360) 在coldfusion.runtime。UDFMethod$ArgumentCollectionFilter.invoke(UDFMethod.java:324) 在coldfusion.filter.FunctionAccessFilter.invoke(FunctionAccessFilter.java:59) 在coldfusion.runtime.UDFMethod.runFilterChain(UDFMethod.java:277) 在coldfusion.runtime.UDFMethod.invoke (UDFMethod.java:192) 在coldfusion.runtime.TemplateProxy.invoke(TemplateProxy.java:448) 在coldfusion.runtime.TemplateProxy.invoke(TemplateProxy.java:308) 在coldfusion.runtime.CfJspPage._invoke(CfJspPage.java: 2272）在 cfCPSecurity2ecfc397466374$funcPREPROCESS.runFunction(D:\JO3\jobOffice\sys\jo\core\m2plugin\CPSecurity.cfc:18) 在coldfusion.runtime.UDFMethod.invoke(UDFMethod.java:418) 在coldfusion.filter。 SilentFilter.invoke(SilentFilter.java:47) 在 Coldfusion.runtime.UDFMethod$ReturnTypeFilter.invoke(UDFMethod.java:360) 在 Coldfusion.runtime.UDFMethod$ArgumentCollectionFilter.invoke(UDFMethod.java:324) 在coldfusion.filter.FunctionAccessFilter.invoke(FunctionAccessFilter.java:59) 在coldfusion.runtime.UDFMethod.runFilterChain(UDFMethod.java:277) 在coldfusion.runtime.UDFMethod.invoke(UDFMethod.java:192) 在coldfusion。 cfPluginManager2ecfc1495337580$funcPREPROCESS.runFunction(D :\JO3\jobOffice\MachII\framework\PluginManager.cfc:405) 在coldfusion.runtime.UDFMethod.invoke(UDFMethod.java:418) 在coldfusion.runtime.UDFMethod$ReturnTypeFilter.invoke(UDFMethod.java:360) 在coldfusion .runtime.UDFMethod$ArgumentCollectionFilter.invoke(UDFMethod.java:324) 在coldfusion.filter.FunctionAccessFilter.invoke(FunctionAccessFilter.java:59) 在coldfusion.runtime.UDFMethod。runFilterChain(UDFMethod.java:277) 在 coldfusion.runtime.UDFMethod.invoke(UDFMethod.java:192) 在 coldfusion.runtime.TemplateProxy.invoke(TemplateProxy.java:448) 在 coldfusion.runtime.TemplateProxy.invoke(TemplateProxy.java :308) 在coldfusion.runtime.CfJspPage._invoke(CfJspPage.java:2272) 在cfRequestHandler2ecfc1676430457$funcPROCESSEVENTS.runFunction(D:\JO3\jobOffice\MachII\framework\RequestHandler.cfc:275) 在coldfusion.runtime.UDFMethod.invoke (UDFMethod.java:418) 在coldfusion.runtime.UDFMethod$ReturnTypeFilter.invoke(UDFMethod.java:360) 在coldfusion.runtime.UDFMethod$ArgumentCollectionFilter.invoke(UDFMethod.java:324) 在coldfusion.filter.FunctionAccessFilter.invoke( FunctionAccessFilter.java:59) 在coldfusion.runtime.UDFMethod.runFilterChain(UDFMethod.java:277) 在coldfusion.runtime.UDFMethod.invoke(UDFMethod.java:192) 在coldfusion.runtime。CfJspPage._invokeUDF(CfJspPage.java:2471) 在 cfRequestHandler2ecfc1676430457$funcHANDLEREQUEST.runFunction(D:\JO3\jobOffice\MachII\framework\RequestHandler.cfc:208) 在 Coldfusion.runtime.UDFMethod.invoke(UDFMethod.java:418) 在Coldfusion.runtime.UDFMethod$ReturnTypeFilter.invoke(UDFMethod.java:360) 在coldfusion.runtime.UDFMethod$ArgumentCollectionFilter.invoke(UDFMethod.java:324) 在coldfusion.filter.FunctionAccessFilter.invoke(FunctionAccessFilter.java:59) 在coldfusion .runtime.UDFMethod.runFilterChain(UDFMethod.java:277) 在coldfusion.runtime.UDFMethod.invoke(UDFMethod.java:192) 在coldfusion.runtime.TemplateProxy.invoke(TemplateProxy.java:448) 在coldfusion.runtime.TemplateProxy。在 cfmach2dii2ecfc1440816939$funcHANDLEREQUEST.runFunction(D:\JO3\jobOffice\MachII\mach-ii.cfc:210) 在coldfusion.runtime.UDFMethod.invoke(UDFMethod.java:418) 在coldfusion.runtime.UDFMethod$ReturnTypeFilter.invoke(UDFMethod.java:360) 在coldfusion。 runtime.UDFMethod$ArgumentCollectionFilter.invoke(UDFMethod.java:324) 在coldfusion.filter.FunctionAccessFilter.invoke(FunctionAccessFilter.java:59) 在coldfusion.runtime.UDFMethod.runFilterChain(UDFMethod.java:277) 在coldfusion.runtime.UDFMethod .invoke(UDFMethod.java:192) 在coldfusion.runtime.CfJspPage._invokeUDF(CfJspPage.java:2471) 在cfmach2dii2ecfc1440816939$funcONREQUESTSTART.runFunction(D:\JO3\jobOffice\MachII\mach-ii.cfc:121) 在coldfusion .runtime.UDFMethod.invoke(UDFMethod.java:418) 在coldfusion.runtime.UDFMethod$ReturnTypeFilter.invoke(UDFMethod.java:360) 在coldfusion.runtime.UDFMethod$ArgumentCollectionFilter.invoke(UDFMethod.java:324) 在coldfusion.filter.FunctionAccessFilter.invoke(FunctionAccessFilter.java:59) 在coldfusion.runtime.UDFMethod.runFilterChain(UDFMethod.java:277) 在coldfusion.runtime.UDFMethod.invoke(UDFMethod.java:192) 在coldfusion。 runtime.CfJspPage._invokeUDF(CfJspPage.java:2471) 在 Coldfusion.runtime.CfJspPage._invoke(CfJspPage.java:2290) 在 cfApplication2ecfc1530162842$funcONREQUESTSTART.runFunction(D:\JO3\wwwroot\Application.cfc:48) 在 Coldfusion。 runtime.UDFMethod.invoke(UDFMethod.java:418) 在 coldfusion.runtime.UDFMethod$ReturnTypeFilter.invoke(UDFMethod.java:360) 在 coldfusion.runtime.UDFMethod$ArgumentCollectionFilter.invoke(UDFMethod.java:324) 在 Coldfusion.filter .FunctionAccessFilter.invoke(FunctionAccessFilter.java:59) 在coldfusion.runtime.UDFMethod.runFilterChain(UDFMethod.java:277) 在coldfusion.runtime.UDFMethod.invoke(UDFMethod.java:192) 在coldfusion.runtime.TemplateProxy.invoke(TemplateProxy.java:448) 在coldfusion.runtime.TemplateProxy.invoke(TemplateProxy.java:308) 在coldfusion.runtime.AppEventInvoker.invoke(AppEventInvoker.java:74) 在coldfusion。 runtime.AppEventInvoker.onRequestStart(AppEventInvoker.java:221) 在coldfusion.filter.ApplicationFilter.invoke(ApplicationFilter.java:273) 在coldfusion.filter.MonitoringFilter.invoke(MonitoringFilter.java:40) 在coldfusion.filter.PathFilter.invoke (PathFilter.java:86) 在coldfusion.filter.ExceptionFilter.invoke(ExceptionFilter.java:70) 在coldfusion.filter.ClientScopePersistenceFilter.invoke(ClientScopePersistenceFilter.java:28) 在coldfusion.filter.BrowserFilter.invoke(BrowserFilter.java: 38) 在coldfusion.filter.NoCacheFilter.invoke(NoCacheFilter.java:46) 在coldfusion.filter.GlobalsFilter.invoke(GlobalsFilter.java:38) 在coldfusion.filter.DatasourceFilter.invoke(DatasourceFilter.java:22) 在coldfusion.filter.RequestThrottleFilter.invoke(RequestThrottleFilter.java:126) 在coldfusion.CfmServlet.service(CfmServlet.java:175) 在coldfusion.bootstrap。 BootstrapServlet.service(BootstrapServlet.java:89) 在 jrun.servlet.FilterChain.doFilter(FilterChain.java:86) 在 com.intergral.fusionreactor.filter.FusionReactorFilter.b(FusionReactorFilter.java:386) 在 com.intergral.fusionreactor .filter.FusionReactorFilter.c(FusionReactorFilter.java:264) 在 com.intergral.fusionreactor.filter.FusionReactorFilter.doFilter(FusionReactorFilter.java:174) 在 jrun.servlet.FilterChain.doFilter(FilterChain.java:94) 在coldfusion。 monitor.event.MonitoringServletFilter.doFilter(MonitoringServletFilter.java:42) 在冷融合.bootstrap.BootstrapFilter.doFilter(BootstrapFilter.java:46) 在 jrun。servlet.FilterChain.doFilter(FilterChain.java:94) 在 jrun.servlet.FilterChain.service(FilterChain.java:101) 在 jrun.servlet.ServletInvoker.invoke(ServletInvoker.java:106) 在 jrun.servlet.JRunInvokerChain.invokeNext (JRunInvokerChain.java:42) 在 jrun.servlet.JRunRequestDispatcher.invoke(JRunRequestDispatcher.java:286) 在 jrun.servlet.ServletEngineService.dispatch(ServletEngineService.java:543) 在 jrun.servlet.jrpp.JRunProxyService.invokeRunnable(JRunProxyService. java:203) 在 jrunx.scheduler.ThreadPool$DownstreamMetrics.invokeRunnable(ThreadPool.java:320) 在 jrunx.scheduler.ThreadPool$ThreadThrottle.invokeRunnable(ThreadPool.java:428) 在 jrunx.scheduler.ThreadPool$UpstreamMetrics.invokeRunnable(ThreadPool .java:266) 在 jrunx.scheduler.WorkerThread.run(WorkerThread.java:66)服务（FilterChain.java:101）在 jrun.servlet.ServletInvoker.invoke(ServletInvoker.java:106) 在 jrun.servlet.JRunInvokerChain.invokeNext(JRunInvokerChain.java:42) 在 jrun.servlet.JRunRequestDispatcher.invoke(JRunRequestDispatcher.java :286) 在 jrun.servlet.ServletEngineService.dispatch(ServletEngineService.java:543) 在 jrun.servlet.jrpp.JRunProxyService.invokeRunnable(JRunProxyService.java:203) 在 jrunx.scheduler.ThreadPool$DownstreamMetrics.invokeRunnable(ThreadPool.java: 320) 在 jrunx.scheduler.ThreadPool$ThreadThrottle.invokeRunnable(ThreadPool.java:428) 在 jrunx.scheduler.ThreadPool$UpstreamMetrics.invokeRunnable(ThreadPool.java:266) 在 jrunx.scheduler.WorkerThread.run(WorkerThread.java:66 )服务（FilterChain.java:101）在 jrun.servlet.ServletInvoker.invoke(ServletInvoker.java:106) 在 jrun.servlet.JRunInvokerChain.invokeNext(JRunInvokerChain.java:42) 在 jrun.servlet.JRunRequestDispatcher.invoke(JRunRequestDispatcher.java :286) 在 jrun.servlet.ServletEngineService.dispatch(ServletEngineService.java:543) 在 jrun.servlet.jrpp.JRunProxyService.invokeRunnable(JRunProxyService.java:203) 在 jrunx.scheduler.ThreadPool$DownstreamMetrics.invokeRunnable(ThreadPool.java: 320) 在 jrunx.scheduler.ThreadPool$ThreadThrottle.invokeRunnable(ThreadPool.java:428) 在 jrunx.scheduler.ThreadPool$UpstreamMetrics.invokeRunnable(ThreadPool.java:266) 在 jrunx.scheduler.WorkerThread.run(WorkerThread.java:66 )42) 在 jrun.servlet.JRunRequestDispatcher.invoke(JRunRequestDispatcher.java:286) 在 jrun.servlet.ServletEngineService.dispatch(ServletEngineService.java:543) 在 jrun.servlet.jrpp.JRunProxyService.invokeRunnable(JRunProxyService.java:203) 在jrunx.scheduler.ThreadPool$DownstreamMetrics.invokeRunnable(ThreadPool.java:320) 在 jrunx.scheduler.ThreadPool$ThreadThrottle.invokeRunnable(ThreadPool.java:428) 在 jrunx.scheduler.ThreadPool$UpstreamMetrics.invokeRunnable(ThreadPool.java:266)在 jrunx.scheduler.WorkerThread.run(WorkerThread.java:66)42) 在 jrun.servlet.JRunRequestDispatcher.invoke(JRunRequestDispatcher.java:286) 在 jrun.servlet.ServletEngineService.dispatch(ServletEngineService.java:543) 在 jrun.servlet.jrpp.JRunProxyService.invokeRunnable(JRunProxyService.java:203) 在jrunx.scheduler.ThreadPool$DownstreamMetrics.invokeRunnable(ThreadPool.java:320) 在 jrunx.scheduler.ThreadPool$ThreadThrottle.invokeRunnable(ThreadPool.java:428) 在 jrunx.scheduler.ThreadPool$UpstreamMetrics.invokeRunnable(ThreadPool.java:266)在 jrunx.scheduler.WorkerThread.run(WorkerThread.java:66)320) 在 jrunx.scheduler.ThreadPool$ThreadThrottle.invokeRunnable(ThreadPool.java:428) 在 jrunx.scheduler.ThreadPool$UpstreamMetrics.invokeRunnable(ThreadPool.java:266) 在 jrunx.scheduler.WorkerThread.run(WorkerThread.java:66 )320) 在 jrunx.scheduler.ThreadPool$ThreadThrottle.invokeRunnable(ThreadPool.java:428) 在 jrunx.scheduler.ThreadPool$UpstreamMetrics.invokeRunnable(ThreadPool.java:266) 在 jrunx.scheduler.WorkerThread.run(WorkerThread.java:66 )

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-06-15T08:35:23.050

十六进制引用确实引用了堆上的对象。如前所述，RWLock 类可能与`<cflock>`. 理想情况下，您需要的是完整的堆栈跟踪。如果您从上面的锁定行向下阅读，您将获得对代码的引用，其中包括冷融合行号，这意味着您可以弄清楚发生了什么。如果您遇到死锁，该引用可能会出现在完整堆栈转储中的其他位置。要生成和分析其中一个，请参阅这篇文章了解什么对我有用：[当 ColdFusion 使 CPU 最大化时，我如何找出它正在咀嚼/窒息的东西？](https://stackoverflow.com/questions/10902098/when-coldfusion-is-maxing-out-the-cpu-how-do-i-find-out-what-its-chewing-choki/10909946#10909946)

# algorithm - 为什么分而治之的算法通常比蛮力运行得更快？

> ID：11043226
> 
> 赞同：19
> 
> 时间：2012-06-15T00:37:22.033
> 
> 标签：algorithm, complexity-theory, brute-force, divide-and-conquer

为什么分而治之的算法通常比蛮力运行得更快？例如，查找最近的一对点。我知道你可以给我看数学证明。但直觉上，为什么会发生这种情况？魔法？

从理论上讲，“分而治之总是胜于蛮力”是真的吗？如果不是，有反例吗？

* * *

## 回答 #1

> 赞同：26
> 
> 时间：2012-06-15T00:50:14.660

对于您的第一个问题，分而治之背后的直觉是，在许多问题中，必须完成的工作量是基于输入的某些组合属性，而这些属性不是线性扩展的。

例如，在最近的点对问题中，蛮力答案的运行时间取决于您必须查看所有 O(n ² ) 可能的点对的事实。

如果你把一个二次增长的东西切成两块，每块都是以前的一半大小，那么每一半解决问题需要初始时间的四分之一，所以解决两半问题大约需要时间蛮力解决方案所需时间的一半。把它切成四块需要四分之一的时间，把它切成八块需要八分之一的时间，以此类推。

在这种情况下，递归版本最终会更快，因为在每一步，我们通过确保没有太多我们实际需要检查的元素对来避免处理元素对的大量工作。由于类似的原因，大多数具有分而治之解决方案的算法最终会更快。

对于您的第二个问题，不，分而治之算法不一定比蛮力算法快。考虑在数组中找到最大值的问题。蛮力算法需要 O(n) 时间并使用 O(1) 空间，因为它对数据进行线性扫描。这里给出了分而治之的算法：

*   如果数组只有一个元素，那就是最大值。
*   否则：
    *   将阵列切成两半。
    *   找出每一半的最大值。
    *   计算这两个值的最大值。

这也需要 O(n) 时间，但堆栈空间使用 O(log n) 内存。它实际上比简单的线性算法更糟糕。

再举一个例子，[最大单笔销售利润问题](https://stackoverflow.com/questions/7086464/interview-question-maximum-single-sell-profit)有一个分而治之的解决方案，但优化的动态规划解决方案在时间和内存上都更快。

希望这可以帮助！

* * *

## 回答 #2

> 赞同：5
> 
> 时间：2012-06-15T00:58:54.423

我建议你通读*算法设计*的第 5 章，它很好地解释了分治法。

直观地说，对于一个问题，如果你能把它分成两个与源问题相同模式的子问题，并且将两个子问题的结果合并成最终结果的时间复杂度有点小，那就更快了而不是通过蛮力解决原始的完整问题。

正如*Algorithm Design*中所说，实际上你不能从分治法中获得太多时间，一般来说，你只能将时间复杂度从较高的多项式降低到较低的多项式（例如从 O(n^3) 到 O(n^ 2))，但几乎没有从指数到多项式（例如从 O(2^n) 到 O(n^3)）。

我认为你能从分而治之中获得的最大收获是解决问题的心态。将最初的大问题分解为更小、更容易的子问题总是一个很好的尝试。即使你没有得到更好的运行时间，它仍然可以帮助你思考问题。

# rest - 带有休息插件的 Grails (2.0.3) 有效！但是单元测试失败了。为什么？

> ID：11043230
> 
> 赞同：1
> 
> 时间：2012-06-15T00:37:47.273
> 
> 标签：rest, grails

请原谅，如果这是一个 n00b 问题，我是 grails 的 n00b ......

我已经使用`grails install-plugin rest`.

我的服务类有这个代码（编辑）：

```
def index() {
  def data

  withRest(uri:'http://localhost:8090/some/valid/url/running/here/') {
    auth.basic 'admin', 'admin'
    def response = get(path: 'something', query: [format: 'json'])
    data = response.data
  }
  return data
} 
```

如果我运行`grails console`，实例化我的服务类并调用`service.index()`，我会得到预期的 JSON 结果。此代码按预期工作。它通过控制器工作。它甚至可以通过集成测试通过控制器工作。

这是我的单元测试：

```
void testIndex() {
    def response = service.index()
    assertEquals(response.total, 2)
    assertEquals(response.receipts.size, 2)
    assertEquals(response.receipts.collectEntries{ [it.id, [id: it.id]] }, [1: [id:1], 2:[id:2]])
} 
```

这失败并出现错误：

```
groovy.lang.MissingMethodException: No signature of method: torch.ReceiptService.withRest() is applicable for argument types: (java.util.LinkedHashMap, torch.ReceiptService$_index_closure1) values: [[uri:http://localhost:8090/some/valid/url/running/here/], ...] 
```

因此，似乎在测试运行时，插件未处于活动状态。我没有对插件进行任何额外的配置。我真的不明白为什么测试环境应该以不同的方式编译这个类。

我的意图是一旦开始就模拟网络接口，因为它具有外部依赖项。但我是一步一步来的。

我是否需要注入一个模拟`withRest()`来运行测试？还是有其他问题？

谢谢！

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-06-15T02:16:08.983

这就是单元测试的工作方式。没有插件处于活动状态，没有 Spring、Hibernate 等。您只是在运行一个类，因此必须模拟所有内容。似乎 REST 不是模拟的糟糕候选者，从那时起你就只是在测试模拟。

我可能会用功能测试来测试它。不幸的是，这不如单元测试方便，但糟糕的测试不是很有用:) 您可以对其进行配置，以便在配置中查找 url 以允许使用不同的 URL 进行测试，这样您就不需要访问外部服务，然后设置一个真正的 REST 服务用于返回已知值的测试。

# javascript - 在黑暗环境中使用屏幕的方法

> ID：11043235
> 
> 赞同：2
> 
> 时间：2012-06-15T00:38:54.180
> 
> 标签：javascript, html, screen, brightness

我正在寻找一种技术的名称，以便我可以在较暗的环境中使用我的网络浏览器。我想创建一个 Web 应用程序，它可以让屏幕可见但又不会太亮，所以我在黑暗中看不到其他东西

我知道这种技术被用作`Stellarium`“*夜间模式*” ，它使屏幕呈现微红色并降低亮度，但它可以让我看着我的电脑并观察天空而不会太亮，所以我的眼睛仍然可以让我看到里面的东西黑暗？

关于这种技术称为什么的任何提示？/在 html/js 中执行此操作的方法

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-07-05T14:50:45.590

[使用Geolocation API](http://dev.w3.org/geo/api/spec-source.html)或[getTimezoneOffset](http://www.w3schools.com/jsref/jsref_gettimezoneoffset.asp)根据 IP 地址确定用户的行踪和/或时间，然后根据一天中的时间提供不同的样式。

# c# - Yield 看不懂功能

> ID：11043237
> 
> 赞同：2
> 
> 时间：2012-06-15T00:39:23.030
> 
> 标签：c#, .net, visual-studio-2010

首先，我已经对此进行了搜索，但我仍然无法理解何时使用 yield。

例如，我有以下代码：

```
string[] days = { "Sun", "Mon", "Tue", "Wed", "Thr", "Fri", "Sat" };

public System.Collections.IEnumerator GetEnumerator()
{
    for (int i = 0; i < days.Length; i++)
    {
        yield return days[i];
    }
} 
```

上面的代码和下面的代码有什么区别？

```
string[] days = { "Sun", "Mon", "Tue", "Wed", "Thr", "Fri", "Sat" };

public System.Collections.IEnumerator GetEnumerator()
{
    for (int i = 0; i < days.Length; i++)
    {
        return days[i];
    }
} 
```

你能告诉我什么时候使用yield吗？

* * *

## 回答 #1

> 赞同：10
> 
> 时间：2012-06-15T00:40:25.480

该`return`方法不记得您在数组中的位置。每次使用它时它都会返回星期日，这仅仅是因为它每次都从零开始循环。

使用`yield`更多（至少在概念上）“我会返回这个值，但是下次你打电话给我时，我会从我离开的地方继续（在循环内）”。

类似的事情可以在 C 中使用静态变量来记住你在哪里：

```
char *nextDay () {
    static char *days[] = { "Sun", "Mon", "Tue", "Wed", "Thr", "Fri", "Sat" };
    static int nextDay = -1;
    nextDay = (nextDay + 1) % (sizeof (days) / sizeof (*days));
    return days[nextDay];
} 
```

变量在函数的调用中被维护的事实`nextDay`意味着它可以用来循环遍历数组。

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2012-06-15T00:59:55.517

C# 中的某些结构会导致编译器将代码转换成非常不同的东西。该`yield return`声明导致了这种转变。看起来像执行 a 的函数`yield return`实际上被编译成一个类；函数中的许多局部变量都被转换为类字段。类本身通常会实现`IEnumerable<T>`和`IEnumerator<T>`。第一次`MoveNext`调用时，类代码将运行函数的部分直到第一次`yield return`，并跟踪`yield return`它命中的部分。下次调用它时，它将在那里开始执行并运行直到下一次`yield return`被调用。如果有任何`Try/Finally`块，块中的代码部分`Finally`将响应`IDisposable.Dispose`.

最终效果是 C# 编译器为迭代器生成的代码看起来几乎与程序员编写的代码完全不同。看起来`yield return`不可能的原因是它的行为对于任何类似于方法调用的东西都是不可能的，但是编译器将任何包含 a 的函数`yield return`转换为一个其行为甚至与方法调用都不相似的类。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-06-15T00:42:10.610

Yield 与 foreach 循环和 for 循环交互。它允许仅在需要时生成 foreach 循环或 for 循环中的每次迭代。这样可以提高性能。

可以在此处找到有关产量及其好处的完整说明：

[http://www.ytechie.com/2009/02/using-c-yield-for-readability-and-performance.html](http://www.ytechie.com/2009/02/using-c-yield-for-readability-and-performance.html)

# android - Activity 重启后 setResult() 不起作用

> ID：11043239
> 
> 赞同：0
> 
> 时间：2012-06-15T00:40:07.040
> 
> 标签：android, android-activity, restart

我有三个活动A，B和C。

A 以 B`startActivityForResult(getIntent(), ACTIVITY_B);`开头，B 以 开头`startActivityForResult(getIntent(), ACTIVITY_C);`C。`ACTIVITY_B`并且`ACTIVITY_C`是跨活动具有相同值的常数。

当 C 以 RESULT_OK 返回时，B 将使用以下代码重新启动：

```
if (resultCode == Activity.RESULT_OK){
    finish();
    startActivityForResult(getIntent(), ACTIVITY_B);
} 
```

这工作正常。

当 B 必须返回时（单击菜单项），它会设置活动结果。

```
public boolean onMenuItemSelected(int featureId, MenuItem item) {
    switch(item.getItemId()) {
        case MENU_CONFIRM:
            System.out.println("Setting Result to RESULT_OK");
            setResult(Activity.RESULT_OK);
            finish();
            return true;
    }
    return super.onMenuItemSelected(featureId, item);
} 
```

但是我可以看到它`setResult(Activity.RESULT_OK);`被忽略了，因为它总是像`RESULT_CANCEL`在活动 A（`onActivityResult`）中一样被接收。我正在使用 2.3。

有什么线索吗？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-06-15T05:36:28.437

不要完成B并开始一个新的，A不会收到通知，因为它不是它打开的B。相反，如果 C 在结束时需要向 B 返回某些内容，请创建一个 Intent，将结果值放在其上，然后在 B 中检查此结果：

C：

```
Intent data = new Intent();
// Store values you want to return on the intent
setResult(RESULT_OK, data);
finish(); 
```

B：在 onActivityResult

```
if (resultCode == Activity.RESULT_OK) {
  // get values from the intent and change B accordingly
} 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-06-15T03:47:33.140

我很好奇你是如何处理你的意图和活动生命周期的。

根据我在您的两篇文章中所读到的内容：

*   A 使用 startActivityForResult() 启动 B。
*   B 用 startActivityForResult() 启动 C。
*   C 完成它的任务，调用 setResult() 和 finish()。

现在，除非我遗漏了什么，否则活动 B 使用以下代码：

```
if (resultCode == Activity.RESULT_OK){
    finish();
    startActivityForResult(getIntent(), ACTIVITY_B);
} 
```

开始自己？你能澄清一下吗？

**添加**

我相信您是从 B 开始的，因此当您在 B 的第二个实例中调用 setResult() 和 finish() 时，您将返回到第一个 B 活动。

如果您没有使用任何特殊的 Intent 标志，则生命周期将是：

*   A 开始 B
    *   B 开始 C
        *   C完成
    *   B自动恢复，B结束
*   A 自动恢复。

据我了解，您已将该周期更改为：

*   A 开始 B

    *   B 开始 C
        *   C完成
    *   B 自动恢复，onActivityResult() 开始第二个 B
        *   第二个 B 完成，（但是您希望接下来会看到 A...）
    *   B 自动恢复（如果您再次调用 finish()，此时您应该会看到 A）。

    ...

*   A 在堆栈中等待恢复。

# nhibernate - 使用 NHiberbnate、Oracle 和 Fluent NHibernate 进行批量插入

> ID：11043241
> 
> 赞同：0
> 
> 时间：2012-06-15T00:40:25.027
> 
> 标签：nhibernate, fluent-nhibernate, bulkinsert

编辑：

我正在使用 Fluent NHibernate、NHibernate 和 Oracle DB 所以我正在进行的测试如下：

```
 [Test]
    public void CanIInsertLargeVolumesOfDataToOracleInUnder5Mins()
    {
        var stopwatch = new Stopwatch();
        stopwatch.Start();
        var entities = GetEntities();

        using (var session = UnitOfStatelessWork.GetUnderlyingSession())
        {
            using (var transaction = session.BeginTransaction(IsolationLevel.ReadCommitted))
            {
                foreach (var entity in entities.Select(entity => new EntityObject(entity) {SomeProperty = 19675464.25M}))
                {
                    session.Insert(entity);
                }

                transaction.Commit();
            }
        }

        stopwatch.Stop();
        var time = stopwatch.Elapsed;
        Assert.IsTrue(time < TimeSpan.FromMinutes(5.0));
    } 
```

我的连接字符串如下所示：

```
<connectionStrings>
  <add connectionString="Data Source=(DESCRIPTION=(ADDRESS_LIST=(ADDRESS=(PROTOCOL=TCP)(HOST=myhost)(PORT=1521)))(CONNECT_DATA=(SERVER=DEDICATED)(SERVICE_NAME=some.service.com)));User ID=user;Password=user" name="OracleConnection" providerName="Oracle.DataAccess.Client" />
</connectionStrings> 
```

对于 SQL Server，我有以下流畅的配置：

```
var fluentConfiguration = Fluently
            .Configure()
            .Database(MsSqlConfiguration.MsSql2005.ConnectionString(c => c.Is(connStr)))
            .Mappings(m => m.FluentMappings.AddFromAssembly(mappingAssembly));
        fluentConfiguration.ExposeConfiguration(f =>
                                                    {
                                                        f.SetProperty("generate_statistics", "false");
                                                        f.SetProperty("command_timeout", "60");
                                                        f.SetListener(ListenerType.PreInsert, new AuditEventListener());
                                                        f.SetListener(ListenerType.PreUpdate, new AuditEventListener());
                                                        f.SetProperty("adonet.batch_size", "1");
                                                        f.SetProperty("hibernate.order_inserts", "true");
                                                        f.SetProperty("hibernate.order_updates", "true");
                                                    }); 
```

然后对于甲骨文：

```
var fluentConfiguration = Fluently
            .Configure()
            .Database(OracleClientConfiguration.Oracle10.AdoNetBatchSize(1000).ConnectionString(c => c.Is(connStr)))
            .Mappings(m => m.FluentMappings.AddFromAssembly(mappingAssembly));
        fluentConfiguration.ExposeConfiguration(f =>
                                                    {
                                                        f.SetProperty("generate_statistics", "false");
                                                        f.SetProperty("command_timeout", "60");
                                                        f.SetProperty("hibernate.connection.driver_class", "NHibernate.Driver.OracleDataClientDriver");
                                                        f.SetListener(ListenerType.PreInsert, new AuditEventListener());
                                                        f.SetListener(ListenerType.PreUpdate, new AuditEventListener());
                                                        f.SetProperty("hibernate.order_inserts", "true");
                                                        f.SetProperty("hibernate.order_updates", "true");
                                                    }); 
```

然后我对两个数据库使用无状态会话和批处理，大约可以在 SQL DB 中插入 750000 条记录。100 秒。

在 Oracle 中，相同的测试大约需要 12 分钟。

有人看到我没有看到的任何重大错误吗？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-06-15T02:03:18.013

*   无状态会话不使用批处理
*   当您覆盖批量大小时`SetProperty("adonet.batch_size", "1")`

所以批处理与它无关。我们没有足够的信息来说明您的代码如何进行插入以进一步帮助您。

我的建议是您使用 .net 分析器来确定时间花在哪里。

# postgresql - 在heroku上部署露营应用程序？

> ID：11043255
> 
> 赞同：1
> 
> 时间：2012-06-15T00:42:41.670
> 
> 标签：postgresql, activerecord, heroku, camping

您好，我想知道如何使用 activerecord 和 postgresql 将露营应用程序部署到 herokus cedar 堆栈上。

我的数据库.yml：

```
production:
    adapter: postgresql
    host: localhost
    database: mydb 
```

现在我在连接到数据库时遇到问题我在同一个文件中有一个开发数据库配置。

**更新：** 作为对 Johns 的回答，这里是 heroku 给我的错误日志，

```
2012-06-15T20:00:24+00:00 app[web.1]:   from /app/vendor/bundle/ruby/1.9.1/gems/activerecord-3.2.6/lib/active_record/connection_adapters/postgresql_adapter.rb:329:in `initialize'
2012-06-15T20:00:24+00:00 app[web.1]:   from /app/vendor/bundle/ruby/1.9.1/gems/activerecord-3.2.6/lib/active_record/connection_adapters/abstract/connection_pool.rb:319:in `checkout_new_connection'
2012-06-15T20:00:24+00:00 app[web.1]:   from /app/vendor/bundle/ruby/1.9.1/gems/activerecord-3.2.6/lib/active_record/connection_adapters/postgresql_adapter.rb:1206:in `connect'
2012-06-15T20:00:24+00:00 app[web.1]:   from /app/vendor/bundle/ruby/1.9.1/gems/activerecord-3.2.6/lib/active_record/connection_adapters/abstract/connection_pool.rb:233:in `checkout'
2012-06-15T20:00:24+00:00 app[web.1]: /app/vendor/bundle/ruby/1.9.1/gems/activerecord-3.2.6/lib/active_record/connection_adapters/postgresql_adapter.rb:1206:in `initialize': could not connect to server: Connection refused (PG::Error)
2012-06-15T20:00:24+00:00 app[web.1]:   from /app/vendor/bundle/ruby/1.9.1/gems/activerecord-3.2.6/lib/active_record/connection_adapters/abstract/connection_pool.rb:95:in `connection'
2012-06-15T20:00:24+00:00 app[web.1]:   from /app/vendor/bundle/ruby/1.9.1/gems/activerecord-3.2.6/lib/active_record/connection_adapters/abstract/connection_specification.rb:142:in `connection'
2012-06-15T20:00:24+00:00 app[web.1]:   from /app/vendor/bundle/ruby/1.9.1/gems/activerecord-3.2.6/lib/active_record/connection_adapters/postgresql_adapter.rb:28:in `postgresql_connection'
2012-06-15T20:00:24+00:00 app[web.1]:   from /usr/local/lib/ruby/1.9.1/monitor.rb:201:in `mon_synchronize'
2012-06-15T20:00:24+00:00 app[web.1]:   from /app/vendor/bundle/ruby/1.9.1/gems/rack-1.4.1/lib/rack/builder.rb:51:in `initialize'
2012-06-15T20:00:24+00:00 app[web.1]:   from /app/vendor/bundle/ruby/1.9.1/gems/activerecord-3.2.6/lib/active_record/connection_adapters/postgresql_adapter.rb:28:in `new'
2012-06-15T20:00:24+00:00 app[web.1]:   from /app/vendor/bundle/ruby/1.9.1/gems/activerecord-3.2.6/lib/active_record/connection_adapters/abstract/connection_pool.rb:236:in `loop'
2012-06-15T20:00:24+00:00 app[web.1]:   from /app/vendor/bundle/ruby/1.9.1/gems/activerecord-3.2.6/lib/active_record/connection_adapters/abstract/connection_pool.rb:236:in `block in checkout'
2012-06-15T20:00:24+00:00 app[web.1]:   from /app/vendor/bundle/ruby/1.9.1/gems/rack-1.4.1/lib/rack/builder.rb:40:in `parse_file'
2012-06-15T20:00:24+00:00 app[web.1]:   from /app/config.ru:12:in `block in <main>'
2012-06-15T20:00:24+00:00 app[web.1]:   from /app/config.ru:1:in `<main>'
2012-06-15T20:00:24+00:00 app[web.1]:   from /app/src/nuts.rb:8:in `create'
2012-06-15T20:00:24+00:00 app[web.1]:   from /app/vendor/bundle/ruby/1.9.1/gems/rack-1.4.1/lib/rack/server.rb:137:in `start'
2012-06-15T20:00:24+00:00 app[web.1]:   from /app/vendor/bundle/ruby/1.9.1/gems/rack-1.4.1/lib/rack/server.rb:301:in `wrapped_app'
2012-06-15T20:00:24+00:00 app[web.1]:   Is the server running on host "localhost" and accepting
2012-06-15T20:00:24+00:00 app[web.1]:   from /app/vendor/bundle/ruby/1.9.1/gems/activerecord-3.2.6/lib/active_record/connection_adapters/postgresql_adapter.rb:1206:in `new'
2012-06-15T20:00:24+00:00 app[web.1]:   from /app/vendor/bundle/ruby/1.9.1/gems/activerecord-3.2.6/lib/active_record/connection_adapters/abstract/connection_pool.rb:309:in `new_connection'
2012-06-15T20:00:24+00:00 app[web.1]:   from /app/vendor/bundle/ruby/1.9.1/gems/rack-1.4.1/lib/rack/builder.rb:51:in `instance_eval'
2012-06-15T20:00:24+00:00 app[web.1]:   from /app/config.ru:1:in `new'
2012-06-15T20:00:24+00:00 app[web.1]:   from /app/vendor/bundle/ruby/1.9.1/gems/activerecord-3.2.6/lib/active_record/connection_adapters/abstract/connection_pool.rb:241:in `block (2 levels) in checkout'
2012-06-15T20:00:24+00:00 app[web.1]:   from /app/vendor/bundle/ruby/1.9.1/gems/activerecord-3.2.6/lib/active_record/connection_adapters/abstract/connection_specification.rb:168:in `retrieve_connection'
2012-06-15T20:00:24+00:00 app[web.1]:   from /app/vendor/bundle/ruby/1.9.1/gems/rack-1.4.1/lib/rack/builder.rb:40:in `eval'
2012-06-15T20:00:24+00:00 app[web.1]:   from /app/vendor/bundle/ruby/1.9.1/gems/rack-1.4.1/lib/rack/server.rb:200:in `app'
2012-06-15T20:00:24+00:00 app[web.1]:   from /app/vendor/bundle/ruby/1.9.1/gems/activerecord-3.2.6/lib/active_record/model_schema.rb:223:in `table_exists?'
2012-06-15T20:00:24+00:00 app[web.1]:   from (eval):20:in `create_schema'
2012-06-15T20:00:24+00:00 app[web.1]:   from /app/vendor/bundle/ruby/1.9.1/bin/rackup:19:in `<main>'
2012-06-15T20:00:24+00:00 app[web.1]:   TCP/IP connections on port 5432?
2012-06-15T20:00:24+00:00 app[web.1]:   from /app/vendor/bundle/ruby/1.9.1/gems/activerecord-3.2.6/lib/active_record/connection_adapters/abstract/connection_pool.rb:404:in `retrieve_connection'
2012-06-15T20:00:24+00:00 app[web.1]:   from /app/vendor/bundle/ruby/1.9.1/gems/activerecord-3.2.6/lib/active_record/connection_adapters/abstract/connection_pool.rb:96:in `block in connection'
2012-06-15T20:00:24+00:00 app[web.1]:   from /usr/local/lib/ruby/1.9.1/monitor.rb:201:in `mon_synchronize'
2012-06-15T20:00:24+00:00 app[web.1]:   from /app/vendor/bundle/ruby/1.9.1/gems/rack-1.4.1/lib/rack/server.rb:252:in `start'
2012-06-15T20:00:24+00:00 app[web.1]:   from /app/vendor/bundle/ruby/1.9.1/bin/rackup:19:in `load'
2012-06-15T20:00:24+00:00 app[web.1]:   from /app/vendor/bundle/ruby/1.9.1/gems/rack-1.4.1/bin/rackup:4:in `<top (required)>' 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-06-15T06:33:22.363

当您将应用程序部署到Heroku 时，Heroku 会将您的 database.yml 替换为它们自己连接到`DATABASE_URL`环境变量（通常是在您设置应用程序时配置的 postgres 数据库）。

你看到的问题是什么？

# c++ - 如何在 C++ 中创建从映射到映射的倒排索引？

> ID：11043256
> 
> 赞同：0
> 
> 时间：2012-06-15T00:42:51.120
> 
> 标签：c++, map, indexing

我正在尝试从 map 在 map 中创建倒排索引。此刻我有以下代码：

```
int main()
{

    char lineBuffer[200];
    typedef std::map<std::string, int> MapType;
    std::ifstream archiveInputStream("./hola");

    // map words to their text-frequency
    std::map<std::string, int> wordcounts;

    // read the whole archive...
    while (!archiveInputStream.eof())
    {
        //... line by line
        archiveInputStream.getline(lineBuffer, sizeof(lineBuffer));

        char* currentToken = strtok(lineBuffer, " ");

        // if there's a token...
        while (currentToken != NULL)
        {
            // ... check if there's already an element in wordcounts to be updated ...
            MapType::iterator iter = wordcounts.find(currentToken);
            if (iter != wordcounts.end())
            {
                // ... then update wordcount
                ++wordcounts[currentToken];
            }
            else
            {
                // ... or begin with a new wordcount
                wordcounts.insert(
                        std::pair<std::string, int>(currentToken, 1));
            }
            currentToken = strtok(NULL, " "); // continue with next token
        }

        // display the content
        for (MapType::const_iterator it = wordcounts.begin(); it != wordcounts.end();
                ++it)
        {
            std::cout << "Who(key = first): " << it->first;
            std::cout << " Score(value = second): " << it->second << '\n';
        }
    }
} 
```

关于这个麻烦我不知道，因为我是使用地图结构的初学者。

我非常感谢你的帮助。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-06-18T08:14:25.227

我认为可能有帮助的是创建第二个地图，`string`按此索引索引具有相同 wordcount-index 的列表，如下所示（类似于[histogram](http://en.wikipedia.org/wiki/Histogram)）：

`std::map<int, std::list<std::string> > inverted;`

因此，当您完成创建`wordcounts`-map 后，您必须`string`像这样手动将 every 插入倒排索引（请注意，此代码未经测试！）：

```
// wordcounts to inverted index
for (std::map<std::string, int>::iterator it = wordcounts.begin();
        it != wordcounts.end(); ++it)
{
    int wordcountOfString = it->second;
    std::string currentString = it->first;

    std::map<int, std::list<std::string> >::iterator invertedIt =
            inverted.find(wordcountOfString);
    if (invertedIt == inverted.end())
    {
        // insert new list
        std::list<std::string> newList;
        newList.push_back(currentString);
        inverted.insert(
                std::make_pair<int, std::list<std::string>>(
                        wordcountOfString, newList));
    }
    else
    {
        // update existing list
        std::list<std::string>& existingList = invertedIt->second;
        existingList.push_back(currentString);
    }

} 
```

# python - 更改python shell中文本的颜色？

> ID：11043260
> 
> 赞同：5
> 
> 时间：2012-06-15T00:44:01.597
> 
> 标签：python, shell, terminal

我知道这可以通过 os 模块的 os.system("color") 函数实现，但这会改变整个终端，我正在寻找的东西仅限于单个字符串或变量输出。标准库中的某些内容将是最佳选择，因为我想在多台计算机上使用它而不必使用 py2exe 或冻结。

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2012-06-15T13:29:09.890

请看一下问题的答案：

*   [使用 Python 在终端中使用颜色打印？](https://stackoverflow.com/questions/287871/print-in-terminal-with-colors-using-python)

如果无法安装附加模块，可以尝试直接使用 ANSI-sequences。请注意，该方法不可移植，最好使用一些特殊的模块。

```
print " "+ "\033[01;41m" + " " +"\033[01;46m" + " " + "\033[01;42m" 
```

当你需要更强大的东西时，我建议你使用`colorama`（pypi.python.org/pypi/colorama）：

```
from colorama import Fore, Back, Style
print(Fore.RED + 'some red text')
print(Back.GREEN + 'and with a green background')
print(Style.DIM + 'and in dim text')
print(Style.RESET_ALL)
print('back to normal now') 
```

另一种选择，使用`termcolor`：

```
from termcolor import colored
print colored('hello', 'red'), colored('world', 'green') 
```

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-06-15T00:45:51.293

[http://pypi.python.org/pypi/colorama](http://pypi.python.org/pypi/colorama)

可能是最好的事情

# caching - 库中的 Google Apps 脚本缓存

> ID：11043263
> 
> 赞同：0
> 
> 时间：2012-06-15T00:44:29.067
> 
> 标签：caching, google-apps-script

我想编写一个脚本，该脚本将托管在可缓存数据的 Google Apps 资源库中。显然，然后我想使用该库中的其他脚本访问该缓存。

这是否可能，任何人都可以通过一些示例代码指出正确的方向吗？

谢谢，

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-06-18T18:19:34.200

这应该是可能的，因为库有它自己的缓存。[您可以在图书馆用户指南的资源范围](https://developers.google.com/apps-script/guide_libraries#scoping)部分中查看哪些资源属于图书馆以及哪些资源是共享的。

# php - 先搜索用户，先回友（顺序）

> ID：11043264
> 
> 赞同：4
> 
> 时间：2012-06-15T00:44:30.500
> 
> 标签：php, sql

我正在使用以下查询从我的“用户”表中选择用户，其中登录用户的会话 ID 为 $uid：

```
SELECT first_name, last_name, uid, hometown from users  where concat(first_name,' ',last_name) like '%$q%' and uid <> $uid LIMIT 6 
```

我还使用以下查询从“朋友”表中选择用户的所有朋友：

```
SELECT a.first_name, a.uid, a.last_name FROM users a, friends b WHERE a.uid = b.friend_two AND b.friend_one = $uid 
```

我的问题是如何在顶部与朋友的用户订购这样的查询？例如，如果我的用户搜索“Dave”并且我返回了 5 个名字为 Dave 的人，我如何将他的朋友 Dave 排在所有其他 Dave 之上并以这种方式对查询进行排序？

谢谢你的帮助。

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-06-15T01:00:51.063

试试这个：

```
SELECT
    a.first_name,
    a.last_name,
    a.uid,
    a.hometown,
    IF(b.friend_two IS NULL, 0, 1) AS isFriend
FROM
    users a
LEFT JOIN
    friends b ON a.uid = b.friend_two AND b.friend_one = $uid
WHERE
    CONCAT(a.first_name, ' ', a.last_name) LIKE '%q%'
    AND a.uid <> $uid
ORDER BY
    isFriend DESC 
```

* * *

## 回答 #2

> 赞同：-2
> 
> 时间：2012-06-15T00:49:18.747

我最好的想法是在您的数据库中设置一个“排名”，并为您希望首先订购的人赋予它们 1 的值。

```
SELECT `fields` FROM `table` ORDER BY `rank` DESC 
```

# android - Listview 在动画完成时未完全呈现

> ID：11043266
> 
> 赞同：1
> 
> 时间：2012-06-15T00:44:38.413
> 
> 标签：android, android-listview, android-animation

当在相对布局中放置在 VideoView 顶部的 ListView 上播放动画时（当 ListView 也放置在其他一些视图类型之上时会发生这种情况，但不是例如 ImageView），我会得到一个糟糕的结果。ListView 未完全呈现。如果我按下主页按钮并重新进入应用程序，ListView 将正确呈现。在此处查看之前和之后的两个屏幕截图：

[http://imgur.com/a/b8TVa](http://imgur.com/a/b8TVa)

我已经尽可能简单地创建了一个测试应用程序，在这里找到项目/源代码：

[http://www.whatsbeef.net/wabz/AnimationTest.tar.gz](http://www.whatsbeef.net/wabz/AnimationTest.tar.gz)

或者在这里查看代码粘贴：http: [//gist.github.com/2934018](http://gist.github.com/2934018)

注意：去掉rotationY objectAnimation后，ListView正确显示。我不知道我在这里做错了什么，或者这是一个 Android 错误，还是什么。我在设备和 x86 模拟器 (4.0.3) 上得到相同的行为。有任何想法吗？

# c++ - 条件运算和花括号会影响代码吗？

> ID：11043269
> 
> 赞同：0
> 
> 时间：2012-06-15T00:46:09.360
> 
> 标签：c++, debugging

我想知道条件运算符是否真的可以阻止其他不相关的代码工作。例如下面：

```
typedef char WCHAR_T;
#define STRLEN(x) strlen(x)
if (argc > 2)
{
    WCHAR *pFileName = argv[1];
    basic_string <WCHAR> strFileName(pFileName, STRLEN(pFileName));
} 
```

在上面的代码中，pFileName、argv[1] 和 strFileName 与比较无关`argc > 2`。假设命令行参数非常好。但是，此代码不适用于该比较。另外，即使我将代码更改为以下格式：

```
typedef char WCHAR_T;
#define STRLEN(x) strlen(x)

{
    WCHAR *pFileName = argv[1];
    basic_string <WCHAR> strFileName(pFileName, STRLEN(pFileName));
} 
```

还是不行。编辑：“不起作用”，我的意思是编译器给出错误消息，例如“strFileName”没有声明，这意味着这个声明根本没有运行。

我不知道为什么花括号会对代码产生如此大的影响。当我摆脱花括号时，代码就像魔术一样工作......有人可以解释一下吗？谢谢。

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2012-06-15T00:55:50.753

因为`strFileName`只存在于大括号内。大括号定义范围，局部变量仅在它们定义的范围内是已知的。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-06-15T01:00:41.627

我想您正在尝试使用`strFileName`大括号外某处的变量，这是不可能的。

`{`和大括号定义了一个块，里面声明的`}`变量只存在于这个块中。一种解决方法是`strFileName`在块外部声明并从内部分配它的值

```
typedef char WCHAR_T;
#define STRLEN(x) strlen(x)

basic_string <WCHAR> strFileName;

if (argc > 2)
{
    WCHAR *pFileName = argv[1];
    strFileName.assign(pFileName, STRLEN(pFileName));
}

std::cout << strFileName << std::endl; // should work now 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-06-15T00:59:30.860

我看到了 WCHAR_T 的定义，但代码中使用的是 WCHAR。WCHAR 是否在任何地方定义？

# javascript - 何时检查表单输入数据 - 使用模糊或更改事件？

> ID：11043271
> 
> 赞同：1
> 
> 时间：2012-06-15T00:46:31.047
> 
> 标签：javascript, jquery, forms, onblur

假设我有这样的表格：

```
Name:<input type="text" name="xxx"  id="name"/>
Type:<select>
          <option>xx</option>
          <option>xx</option>
      </select>
<input type="submit" disabled="disabled" id="sub" /> 
```

现在，我想检查以确保用户名是唯一的。并且只有在名称唯一的情况下才能使用提交按钮。所以我使用jQuery AJAX 来查询数据库。

但现在我想知道什么时候检查它？

首先我使用这个：

```
$("#name").blur(function () {
    $.get(........);
} 
```

但是现在，在现代浏览器中，它们提供了表单数据保存和`auto-filled`功能。所以当用户dbclick输入时，浏览器会提供一个数据列表（历史数据）供用户选择（见下图）。

![在此处输入图像描述](../Images/fc4d576d71d8f183dedfbc0f795e62d7.png)

当用户选择其中之一时，`blur`事件不能被触发。我也尝试使用该`change`事件，但是当用户使用键盘输入时，它会导致对服务器的请求过多。

如何解决这个问题？

**更新：** 以下答案都不是完美的。现在我只是在我的页面中使用一个计时器来检查“名称”是否每 0.5 秒更改一次。看来符合我的要求。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-06-15T00:54:57.650

简单的解决方案：在密码字段的焦点上触发 ajax 调用。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-06-18T03:07:57.793

您也可以简单地为“检查可用性”添加按钮，并在“检查可用性”按钮的单击事件上触发用户名唯一性检查功能。

```
Name:<input type="text" name="xxx"  id="name"/> <input type="button" name="checkUsername"  id="checkUsername" value="Check availability"/>
Type:<select>
          <option>xx</option>
          <option>xx</option>
      </select>
<input type="submit" disabled="disabled" id="sub" />

$("#checkUsername").click(function (e) {
    $.get(........);
    e.preventDefault();
    return false;
} 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-06-15T01:06:21.447

我将使用的方法是将用户名集合加载到 中`on page load`，并根据`change event`. 这样，您的数据库将只需要处理每个页面加载的单个请求，虽然前端有更多工作要做，但它不应该对您的用户体验产生负面影响。

有可能出现并发问题，两个新用户同时加载页面，选择相同的用户名并尝试提交，最后提交的人将有一个活动的提交按钮但用户名无效，你需要一些服务器端来处理。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2012-06-15T00:54:04.610

您应该做的是当用户双击文本框时，下载选项并将它们存储在后面代码中的数组中。当用户在文本框中键入时，删除不需要的项目。

此外，如果您想触发像 blur 之类的事件（在输入元素上），您甚至可能希望对下拉列表使用更改。

# javascript - Javascript无限循环不循环

> ID：11043274
> 
> 赞同：0
> 
> 时间：2012-06-15T00:47:31.040
> 
> 标签：javascript

我正在尝试制作一个无限循环的Javascript。

```
function scroll(num) {
    $("." + num + "").fadeOut('slow');
    var choose = num + 1;
    $("." + choose + "").fadeIn('slow');
    setTimeout(function() {
        scroll(choose);
    }, 1000);
}

setTimeout(function() {
    scroll('1');
}, 1000);​ 
```

它第一次执行该功能但不继续。

请帮忙！

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-06-15T00:53:19.540

您将 one 用作字符串和整数：调用`scroll('1')`意味着`num + 1`将返回`"11"`，而不是`2`您期望的那样。试试这个：

```
function scroll(num) {
    $("." + num.toString()).fadeOut('slow');
    var choose = num + 1;
    $("." + choose.toString()).fadeIn('slow');
    setTimeout(function() {
        scroll(choose);
    }, 1000);
}

setTimeout(function() {
    scroll(1);
}, 1000);​ 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-06-15T00:53:29.057

您将 1 添加到字符串“1”中，结果为“11”。这是你的意思吗？

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2015-05-11T10:46:54.910

这里的问题在于您的连接，在您的代码中使用 + 连接是不明确的。在您的代码中 var select = num + 1; 根据您的期望，将返回 11 作为字符串而不是 2。

# wpf - 无法从控制模板中获取文本值

> ID：11043278
> 
> 赞同：1
> 
> 时间：2012-06-15T00:47:38.720
> 
> 标签：wpf, controltemplate

我使用控件模板重新设置了文本框的样式。样式效果很好，但在文本框中更改后，我现在无法以编程方式从文本框中获取文本值。

以下是我使用该样式的方式：

```
 <TextBox
        x:Name="KernTextBox"
        Style="{StaticResource MediumTextBoxStyle}"
        TextWrapping="Wrap"
        MinLines="1"
        MaxLines="5"
        VerticalScrollBarVisibility="Auto"
        TextChanged="TextChanged"
        /> 
```

这是行不通的。

```
 get { return KernTextBox.Text; } 
```

这是样式：

```
<Style x:Key="MediumTextBoxStyle" TargetType="TextBox">
    <Setter Property="FontSize" Value="18" />
    <Setter Property="Template">
        <Setter.Value>
            <ControlTemplate TargetType="TextBox">
                <Grid>

                    <VisualStateManager.VisualStateGroups>
                        <VisualStateGroup x:Name="CommonStates">
                            <VisualState x:Name="Normal"/>
                            <VisualState x:Name="MouseOver" />
                            <VisualState x:Name="ReadOnly">
                                <Storyboard>
                                    <ObjectAnimationUsingKeyFrames
                                        Storyboard.TargetName="ButtonRectangle"
                                        Storyboard.TargetProperty="Fill">
                                        <DiscreteObjectKeyFrame
                                            KeyTime="0"
                                            Value="{StaticResource ForegroundBrush}" />
                                    </ObjectAnimationUsingKeyFrames>
                                    <ObjectAnimationUsingKeyFrames
                                        Storyboard.TargetName="ButtonText"
                                        Storyboard.TargetProperty="Foreground">
                                        <DiscreteObjectKeyFrame
                                            KeyTime="0"
                                            Value="{StaticResource BackgroundBrush}" />
                                    </ObjectAnimationUsingKeyFrames>
                                    <ObjectAnimationUsingKeyFrames
                                        Storyboard.TargetName="ButtonText"
                                        Storyboard.TargetProperty="Background">
                                        <DiscreteObjectKeyFrame
                                            KeyTime="0"
                                            Value="{StaticResource ForegroundBrush}" />
                                    </ObjectAnimationUsingKeyFrames>
                                    <ObjectAnimationUsingKeyFrames
                                        Storyboard.TargetName="ButtonText"
                                        Storyboard.TargetProperty="BorderBrush">
                                        <DiscreteObjectKeyFrame
                                            KeyTime="0"
                                            Value="{StaticResource ForegroundBrush}" />
                                    </ObjectAnimationUsingKeyFrames>
                                </Storyboard>
                            </VisualState>
                            <VisualState x:Name="Disabled">
                                <Storyboard>
                                    <ObjectAnimationUsingKeyFrames
                                        Storyboard.TargetName="ButtonRectangle"
                                        Storyboard.TargetProperty="Fill">
                                        <DiscreteObjectKeyFrame
                                            KeyTime="0"
                                            Value="{StaticResource ForegroundBrush}" />
                                    </ObjectAnimationUsingKeyFrames>
                                    <ObjectAnimationUsingKeyFrames
                                        Storyboard.TargetName="ButtonText"
                                        Storyboard.TargetProperty="Foreground">
                                        <DiscreteObjectKeyFrame
                                            KeyTime="0"
                                            Value="{StaticResource BackgroundBrush}" />
                                    </ObjectAnimationUsingKeyFrames>
                                    <ObjectAnimationUsingKeyFrames
                                        Storyboard.TargetName="ButtonText"
                                        Storyboard.TargetProperty="Background">
                                        <DiscreteObjectKeyFrame
                                            KeyTime="0"
                                            Value="{StaticResource ForegroundBrush}" />
                                    </ObjectAnimationUsingKeyFrames>
                                    <ObjectAnimationUsingKeyFrames
                                        Storyboard.TargetName="ButtonText"
                                        Storyboard.TargetProperty="BorderBrush">
                                        <DiscreteObjectKeyFrame
                                            KeyTime="0"
                                            Value="{StaticResource ForegroundBrush}" />
                                    </ObjectAnimationUsingKeyFrames>
                                </Storyboard>
                            </VisualState>

                        </VisualStateGroup>

                        <VisualStateGroup x:Name="CheckStates">
                            <VisualState x:Name="Checked" />
                            <VisualState x:Name="Unchecked"/>
                        </VisualStateGroup>

                        <VisualStateGroup x:Name="FocusStates">
                            <VisualState x:Name="Focused" />
                            <VisualState x:Name="Unfocused"/>
                        </VisualStateGroup>

                    </VisualStateManager.VisualStateGroups>

                    <Rectangle 
                        x:Name="ButtonRectangle" 
                        Stroke="Transparent" 
                        UseLayoutRounding="False" 
                        Fill="{StaticResource BackgroundBrush}">
                    </Rectangle>

                    <TextBox 
                        x:Name="ButtonText" 
                        Text="{Binding Path=Text, RelativeSource={RelativeSource TemplatedParent}, Mode=TwoWay}"
                        FontSize="{TemplateBinding FontSize}"
                        HorizontalAlignment="Stretch" 
                        VerticalAlignment="Center" 
                        Margin="2 0"
                        TextWrapping="{TemplateBinding TextWrapping}"
                        MinLines="{TemplateBinding MinLines}"
                        MaxLines="{TemplateBinding MaxLines}"
                        VerticalScrollBarVisibility="{TemplateBinding VerticalScrollBarVisibility}"
                        Padding="{TemplateBinding Padding}"
                        Foreground="{StaticResource ForegroundBrush}"
                        Background="{StaticResource BackgroundBrush}"
                        >
                    </TextBox>
                </Grid>
            </ControlTemplate>
        </Setter.Value>
    </Setter>
</Style> 
```

**编辑：**

最终工作方式：

```
<Style 
    x:Key="TextBoxStyle" 
    TargetType="{x:Type TextBox}">
    <Setter
        Property="Foreground"
        Value="{StaticResource ForegroundBrush}" />
    <Setter
        Property="FontSize"
        Value="18" />
    <Setter 
        Property="CaretBrush"
        Value="{StaticResource ForegroundBrush}" />
    <Setter Property="Template">
        <Setter.Value>
            <ControlTemplate TargetType="{x:Type TextBox}">
                <Border 
                    Name="Border"
                    Background="{StaticResource BackgroundBrush}"
                    BorderBrush="{StaticResource ForegroundBrush}"
                    BorderThickness="1" >
                    <ScrollViewer Margin="0" x:Name="PART_ContentHost"/>
                </Border>
                <ControlTemplate.Triggers>
                    <Trigger Property="IsEnabled" Value="False">
                        <Setter TargetName="Border" Property="Background" Value="{StaticResource ForegroundBrush}"/>
                        <Setter TargetName="Border" Property="BorderBrush" Value="{StaticResource BackgroundBrush}"/>
                        <Setter Property="Foreground" Value="{StaticResource BackgroundBrush}"/>
                    </Trigger>
                    <Trigger Property="IsReadOnly" Value="True">
                        <Setter TargetName="Border" Property="Background" Value="{StaticResource ForegroundBrush}"/>
                        <Setter TargetName="Border" Property="BorderBrush" Value="{StaticResource BackgroundBrush}"/>
                        <Setter Property="Foreground" Value="{StaticResource BackgroundBrush}"/>
                    </Trigger>
                </ControlTemplate.Triggers>
            </ControlTemplate>
        </Setter.Value>
    </Setter>
</Style> 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-06-15T01:07:11.403

将文本框放在文本框内是否有原因？签出文本框的原始样式和[模板](http://msdn.microsoft.com/en-us/library/cc645061%28v=vs.95%29.aspx)并从那里进行修改。我的猜测是，文本框在内部使用 TextBoxView（隐藏在 Scrollviewer 中），并且 Text 属性不是通过 TemplateBinding 绑定的，而是在这些内部类之间计算的。因此，也许这就是您无法将文本属性绑定到控件模板中的文本框文本的原因。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-06-15T09:19:13.710

在您的样式中，当您将内部 Text 属性绑定到 Template Text 属性时，添加更新源触发器`PropertyChanged`，然后即使您没有失去焦点，您也会获得文本更新。

```
Text="{Binding Path=Text, RelativeSource={RelativeSource TemplatedParent}, Mode=TwoWay, UpdateSourceTrigger=PropertyChanged}" 
```

设置文本框样式的方法不太有效的原因是，默认情况下，文本属性在从控件中移除焦点之前不会更新其绑定属性。我猜您正在尝试在 TextChanged 事件中使用 Text 属性，此时尚未从 TextBox 中移除焦点。

我向您的 Text 绑定建议的添加将强制属性在每次文本更改时更新，并且会在引发 TextChanged 事件之前执行此操作。

# jquery - D3 等价于 jQuery 属性选择器

> ID：11043279
> 
> 赞同：25
> 
> 时间：2012-06-15T00:47:43.713
> 
> 标签：jquery, select, d3.js

有谁知道 d3 相当于 jQuery 属性选择器：

```
$('[attribute="name"]') 
```

我希望能够使用 .transition() 等 d3 方法。谢谢！

* * *

## 回答 #1

> 赞同：30
> 
> 时间：2012-06-15T04:02:58.763

在 D3 和 jQuery 中都是一样的；底层功能由[W3C Selectors API](http://www.w3.org/TR/CSS2/selector.html#attribute-selectors)提供，因此请参阅有关属性选择器的文档。例如，`d3.select("[id=body]")`等价于`d3.select("#body")`。

# android - 如何在 TextView 中使 html 图像可点击

> ID：11043280
> 
> 赞同：3
> 
> 时间：2012-06-15T00:47:50.357
> 
> 标签：android, html, textview

我在资源文件的字符串中有以下文本：

```
 <a href="mailto:mymail@mail.com">&lt;img src="mail_big" /&gt;</a> 
```

它显示图像很好（我实现了 ImageGetter），但它不可点击。我已经尝试添加 Linkify thingy，但我认为它不适用于这种情况，因此它不起作用。setMovementMethod 也不起作用。

我尝试了上述的不同组合：

```
 <a href="mailto:mymail@mail.com">&lt;img src="mail_big" /&gt;hello</a> 
```

在这里，即使是“你好”部分也是不可点击的（既不是蓝色也不是下划线）。

```
 <a href="mailto:mymail@mail.com"><img src="mail_big" /></a> 
```

这甚至不显示图像。

```
 &lt;a href="mailto:mymail@mail.com"&gt;&lt;img src="mail_big" /&gt;&lt;/a&gt; 
```

如果我只是写电子邮件，没有 <a> 标签它可以完美地工作，但我想使用用户可以点击的信封图像。无法使用图像按钮，因为此文本位于字符串中间，因此我无法拆分它。

有任何想法吗？

谢谢！

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-06-24T15:48:25.320

我会回答我自己的问题。

我找到了一个解决方案，或者更确切地说找到了如何正确地做到这一点。

我所要做的就是在 TextView 中调用 setText 之前添加 setMovementMethod 调用，并且**完全必要**，从布局中删除属性“android:autoLink="all"。显然，解析字符串中的邮件和 url 是解释字符串中的 <a> 链接标签是互斥的。所以一个或另一个但不是两者兼而有之。

最后，我的布局只是一个 TextView，没有什么特别的，只有宽度和高度。活动如下所示：

```
 TextView tv = (TextView)findViewById(R.id.about_text);
    tv.setMovementMethod(LinkMovementMethod.getInstance());
    tv.setText(Html.fromHtml(getString(R.string.about_content), new ImageGetter(), null)); 
```

字符串是这样的：

```
 <string name="about_content"><a href="mailto:nomail@mail.com"><img src="mail" /></a></string> 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-06-15T01:01:28.393

不确定，但您可以尝试`android:clickable="true"`在`view`.

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-06-15T01:12:15.857

你有

```
android:autoLink="all" 
```

在 TextView 的 xml 中？

此外，如果您也尝试显示图像，您很可能最好使用 WebView你想要）

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2012-06-15T01:48:58.580

```
TextView tv = new TextView(this);
tv.setText(Html.fromHtml("<a href=\"mailto:mymail@mail.com\">This is a test link</a>"));
tv.setClickable(true);
tv.setMovementMethod(LinkMovementMethod.getInstance()); 
```

# linux - 如何实现 HTTP API 守护进程

> ID：11043281
> 
> 赞同：0
> 
> 时间：2012-06-15T00:47:50.750
> 
> 标签：linux, api, http

我在一家医疗行业的小公司工作。我们有一个自制的管理软件，经过重新编写后，我们将出售给其他类似的公司。该软件基于用 PHP 编写的 HTTP API。由于我们不想泄露我们的代码，我们目前正在检查我们应该用哪种技术重写它。

我的问题是：您将如何实现一个 HTTP API 守护程序，它可以相对简单地安装在 Linux 机器上，而不会泄露您的代码？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-06-15T01:21:47.050

**框架和语言**

有很多优秀的语言和框架可用于构建 Web 应用程序。如果您正在寻找一种（某种）编译语言，您可能会考虑在 Java 中做一些事情，可能使用[Spring](http://www.springsource.org/)或[Play 框架](http://www.playframework.org/)（免责声明：play 框架仍然相对较新，尽管它很受欢迎，但可能并不理想适合所有人，因为它在野外仍然相对未经测试）。我还听说过 C# 和[ASP.NET](http://www.mono-project.com/ASP.NET)的 Mono 项目实现已经取得了长足的进步，尽管我没有使用它，也不能保证它。

在编写 Web 服务时，我倾向于更喜欢 Python 和 Ruby 等解释型语言。尽管这些可能不适合您的用例。[Go](http://golang.org/)是个例外，它最近已成为我的最爱之一。它非常容易学习、高效且非常快速（并且可以编译）。

**帮助我们帮助您**

不幸的是，你的问题几乎是无可救药的模糊，所以我很难给出一个好的建议。也许您会考虑改写它，列出您的一些要求、目标和目的，以便我们可以更多地了解从长远来看什么对您最有利？

**无关的肥皂盒警告！**

稍微偏离主题，我总是鼓励我签约的公司（尤其是在技术上往往落后的医疗行业等领域）考虑更开放的商业模式。许多小公司试图通过创建一个封闭的生态系统来保护他们的知识产权，从长远来看，这会扼杀增长和创新，并可能使他们面临重大的安全漏洞；开源并没有成为蓬勃发展的计算机科学行业的新趋势，因为它允许人们窃取彼此的产品。它之所以流行，是因为它比传统的封闭源代码实践更便宜、更可持续。我主张通过适当的许可和法律手段保护您的源代码，而不是坚持传统的分发方法。不像很多人，我认为专有软件仍然占有一席之地。由您决定您的产品是否适合该模型。但是，至少要考虑替代方案的利弊，即使您最终认为它不适合您的业务模式。*非肥皂盒*

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-06-15T01:19:34.913

您可以将代码保存在 php 中并以几种不同的方式保护它：

*   编写一个小的 C 程序，将您的（可能是模糊的或加密的）源代码编译到其中，只调用 php 可执行文件
*   通过代码混淆器运行它。它应该运行相同，但对于想要进行修改的人来说不是很有用
*   去掉代码中的所有注释。大多数规模可观的程序如果没有任何评论就会令人困惑，以至于人们会被劝阻不要修改它们
*   不用担心，让您的客户合法地同意不将软件提供给他人。像您的客户这样的信誉良好的企业通常会遵守此类协议。
*   别担心；放弃软件并出售支持（合同或事件）。又名 F/OSS 商业模式。

当然，最后两个对管理层来说很难卖。但这取决于您的业务和技术目标。

如果您打算重写代码，那么防止他人窃取您的源代码的最佳保护（法律限制除外）可能是二进制编译的语言，如 C 或 C++。Java 可以很容易地被反编译，尽管有一些混淆器可以让它变得毫无意义。还有各种其他语言的打包机制（例如 perl PAR 存档、python py2exe 或 tcl tclkits），这使得查看源代码稍微困难一些，但这些主要是为了简化分发，而不是为了保护代码免受恶意攻击眼睛。

# python - 获取最后一次更改集合的日期时间

> ID：11043282
> 
> 赞同：0
> 
> 时间：2012-06-15T00:47:54.930
> 
> 标签：python, mongodb, datetime, pymongo

有没有一种简单的方法来获取对集合的最后一次更改的日期时间（包括对其任何文档或子项的更改，无论该更改是更新、插入、删除等），而无需手动记录日期时间？如果没有自动执行此操作的方法，那么手动记录这些更改以便应用程序可以访问它们的好方法是什么？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-06-15T01:05:04.187

Jira 中有一个功能请求。看看并投票：

[https://jira.mongodb.org/browse/SERVER-1891](https://jira.mongodb.org/browse/SERVER-1891)

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-06-15T00:58:32.017

可能在堆栈中更高，例如在应用程序服务器级别。

如果您可以通过所有集合的最后修改时间，也许您可​​以使用 oplog。

如果您必须将其存储在数据库中，您可以执行单独的、类似日志的插入到单独的、有[上限的集合](http://www.mongodb.org/display/DOCS/Capped+Collections)中，并让服务器根据需要生成对象 ID。然后您可以获取最新的对象 ID 并从中得出时间。（如果您需要优于一秒的精度，则需要在客户端生成时间戳或使用不同的方法在服务器上生成它。）

# php - 使用大型数组 PHP 时出现 No data received 错误

> ID：11043283
> 
> 赞同：0
> 
> 时间：2012-06-15T00:48:15.003
> 
> 标签：php, arrays

我正在使用常规循环，但是当我在循环中放入大数据时它不起作用，他们有什么办法可以将大数据放入数组中吗？

```
$arr = array('Joe', 'Jack');
$arr2 = array();
foreach($arr as $val){
    $arr2[] = $val;
}
print_r($arr2); 
```

因此，当`$arr`太大时，我在浏览器中收到未收到数据错误，

任何帮助表示赞赏。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-06-15T01:12:42.830

您可能想查看更轻量级的[SplFixedArray](http://php.net/manual/en/class.splfixedarray.php)。它使用常规的连续内存块来存储数据，而不是传统的哈希结构。

第二种方法是使用**memory_limit**参数，但这不是一个好主意

```
ini_set('memory_limit', '256M'); 
```

第三种方法是把你的数组分成几块

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-06-15T01:19:06.523

- 如果您使用 GET，则在处理大数据时将其更改为 POST。

- 将表单类型更改为 enctype="multipart/form-data"

-更改`post_max_size`php.ini

- 如果仍然不起作用，请使用`ini_set("memory_limit","-1")`

# java - 如何专门实现这个子类来绕过附加目标文件？

> ID：11043285
> 
> 赞同：1
> 
> 时间：2012-06-15T00:48:50.960
> 
> 标签：java, objectoutputstream, object-files

我在我的程序中附加目标文件时遇到了问题。我找到[了这个](https://stackoverflow.com/questions/1194656/appending-to-an-objectoutputstream/1195078#1195078)答案。

但是，我不知道如何继承一个`AppendableObjectOutputStream`. 谁能更详细地教我怎么做？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-06-15T00:59:22.797

```
class YourClass extends AppendableObjectOutputStream {
// any constructors required, if no default for Appendable
    public AppendableObjectOutputStream(<your args here>) {
        super(<other args here>);
    }
// any methods you want to @Override here
} 
```

# php - 非 facebook connect 用户可以查看 facebook connect 图像吗？

> ID：11043287
> 
> 赞同：1
> 
> 时间：2012-06-15T00:49:03.877
> 
> 标签：php, facebook

我正在将 fb connect 合并到我建立的社交网站中，因此我有混合用户（一些非 fb 和一些是）。如果我只将 fb 用户的个人资料图片存储为 img url，当非 fb 用户看到 fb 用户的个人资料时，图像是否会加载，并且在用户注销时仍然可见？还是我真的必须拉出用户的 fb 图片并将它们存储在我目前拥有的 img 存储库中？我相信如果可能的话，只存储 img url 会更容易。

1.  当用户不在我的网站上时，我可以访问用户的 Facebook 个人资料图片吗？（通过数据库存储 img url）
2.  没有登录脸书的用户可以看到吗？
3.  如果没有，是否有其他方法可以让我同步他们的个人资料照片？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-06-15T01:00:34.870

不知道这是否适用于 API 或任何东西，但即使在注销时我也能够直接查看我自己的 Facebook 个人资料图片。

编辑

这也适用于 Graph API，例如[`https://graph.facebook.com/btaylor/picture`](https://graph.facebook.com/btaylor/picture).

# css - “网络错误：404 未找到”/style.ccs

> ID：11043290
> 
> 赞同：2
> 
> 时间：2012-06-15T00:49:50.257
> 
> 标签：css, wordpress, wordpress-theming

我在萤火虫中遇到错误：

“NetworkError: 404 Not Found - (已移除)/style.css”

这是什么意思，我需要做什么？

谢谢！

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-06-15T00:53:00.303

HTTP 404 正是它所说的——未找到文件。

在您的文档中的某处，您链接到（已删除）/style.css，并且该文件在服务器上不存在（名称错误，位置错误）。您的代码中有一行可能是这样的：

```
<link rel="stylesheet" type="text/css" href="(removed)/style.css"> 
```

指向它，并且需要将其更改为指向该文件实际所在的位置。

* * *

更新：

将该行更改为`<link href="(removed)/wp-content/themes/imbalance2/style.css" rel="stylesheet" type="text/css" />`

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-06-15T00:52:08.183

如果表示您尝试使用的 css 文件在该位置不存在。

404 Not Found 就是这个意思，找不到文件。如果您单击您的链接，您将得到一个错误页面，说明正是如此。

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2012-06-15T00:53:10.447

“404”只是告诉您您要查找的文件不在您认为的位置。您必须使用某些将“404”错误重定向到该页面的内容管理系统/框架，否则您会看到该错误的标准浏览器页面。

该怎么办？更正路径，在正确的位置添加文件

* * *

## 回答 #4

> 赞同：2
> 
> 时间：2012-06-15T00:54:28.270

Wordpress CSS 文件通常不在根目录中——它们在主题的文件夹中

这是你的 - （已删除）/wp-content/themes/imbalance2/style.css

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2014-07-07T20:59:56.337

正如其他人所说，404错误意味着找不到文件。

有时这可能很棘手。例如，我刚刚将文件从旧服务器 (CF7) 移动到新服务器 (CF11)，而我的 .css 文件无法加载：我收到 404 错误。这怎么可能？我转移了整个目录，并显示了所有其他文件。

答案是我需要绝对路径而不是相对路径。有时你看到一个错误并去 WTF，但追溯你的步骤和你的假设通常会解决问题。

# html - 如何使多个内联下拉列表跨平台兼容？

> ID：11043292
> 
> 赞同：1
> 
> 时间：2012-06-15T00:49:55.530
> 
> 标签：html, css

所以我试图放置两个内联下拉列表。我测试过，它在 Chrome 和 Firefox 中运行良好，但 IE9（当然）不喜欢它。它将第二个下拉列表放在第一个下拉列表的正下方。这是我的 html 和 css 的样子：

**HTML：**

```
<div id="region-path">
    <div id="region-dropdown">
            <!-- <form name="regionform" action=""> -->
            <form action="">
                    <!-- <select id="regionselection" > -->
                    <select id="regionDropDown">
                        <option value="0" selected="selected">All Regions</option>
                        @foreach (var region in Model.RegionData)
                        {
                            <option value="@region.regionID"> @region.regionName</option>
                        }
                    </select>
                    <!-- <input type="button" id="submitButton" value="Submit" /> -->
            </form>
     </div>

    <div id="path-dropdown">
        <form action="">
            <select>
                <option value="0" selected="selected">All Paths</option>
            </select>
        </form>
    </div>
</div> 
```

**CSS：**

```
#region-path 
{
    margin: 20px 35px;
}

#region-dropdown, #path-dropdown
{
    display: inline-block;    
    width: 160px;
}

#path-dropdown
{
    margin-left: 20px;
} 
```

我怎样才能解决这个问题？我对 Web 开发非常陌生，因此请指出我是否也做错了其他事情。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-06-15T16:08:49.717

我不得不玩了一下，最后修复了它：

```
#region-path 
{
    position: relative;
    margin: 20px 35px;
    width: 320px;
    height: 20px;
}

#region-dropdown, #path-dropdown
{
    position: absolute;
    display: inline;   
    width: 90px;
    height: 19px;
}

#path-dropdown
{
    left: 100px;
} 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-06-15T01:17:29.627

只要 IE 不在 IE9 兼容模式下，它就可以在 IE9 中正确显示。

问题在于 IE7（就本问题而言，与 IE9 兼容模式相同）不理解`inline-block`. `display`您可以使用`display:inline`with layout 技巧来解决此问题。

```
display:inline-block; /* for browsers that don't suck */
*display:inline; /* ignored by most browsers except IE7 */
zoom:1; /* you can't set dimensions on an inline element in IE<7, which is to be expected, UNLESS it has layout. zoom will do this */ 
```

结果是兼容的浏览器将`inline-block`正确地看到和显示，其中 IE7 将看到一个内联元素，但由于它有布局，你可以给它一个高度或宽度。

这是一个功能示例。使用开发人员工具栏切换不同的模式，您应该会看到它可以正常工作。[http://jsfiddle.net/7uSbR/1/](http://jsfiddle.net/7uSbR/1/)

# php - 查找文本将占用多少行

> ID：11043295
> 
> 赞同：2
> 
> 时间：2012-06-15T00:50:31.630
> 
> 标签：php, javascript, css

我有一个产品列表，其中写有产品的标题。我想要做的是检查产品标题是否超过 2 行，在这种情况下，打印刚好足以容纳 2 行并在最后加上“...”。

有任何想法吗？

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-06-15T01:09:54.730

可能发生的一个问题是，即使在不同的版本和不同的操作系统上，字体渲染也会因浏览器而异。因此，当涉及到某种预先计算文本长度/高度时，这并不容易。你可以这样做：

*   创建一个具有最大高度的字段
*   将此字段的溢出设置为隐藏
*   编写一个执行以下操作的 javascript：

__

*   1 获取文本
*   2 切断最后一个词（使用正则表达式或类似的东西）
*   3 检查容器是否还有溢出
*   4 执行第 2 步和第 3 步，直到不再溢出为止
*   5 再删掉一个词（你仍然可以有这样的情况，你没有空间用于“…”）
*   6 附加“……”

这个只有在你有纯文本时才有效。如果标题中有标签，这样的事情可能会完全弄乱您的 HTML 结构。想象一下，这会导致打开的“<span>”标签永远不会关闭……:)

您的正则表达式/单词查找器也应该非常聪明，可以删除诸如“单词分隔”之类的内容。

我不知道这是否是一个很好的方法，但也许有一点帮助，因为使用 jQuery 这只会是 4-5 行。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-06-15T18:55:15.660

我最终做了这样的事情：

```
<p id="titleContainer">blabla bla bla blablabla bla blabla bla bla blablabla bla blabla bla bla blablabla bla</p>

<script type="text/javascript">
  function checkOverflow(el){
    var curOverflow = el.style.overflow;
    if ( !curOverflow || curOverflow === "visible" ){
      el.style.overflow = "hidden";
    }

    // 26 pixels was the height of 2 lines
    var isOverflowing = el.scrollHeight > 26;
    el.style.overflow = curOverflow;
    return isOverflowing;
  }

  var titleContainer = document.getElementById("titleContainer");
  var titleTxt = titleContainer.innerHTML + "...";

  while(checkOverflow(titleContainer)){
    titleTxt = titleTxt.replace(/ [^ ]+\.\.\.$/, "...");
    titleContainer.innerHTML = titleTxt;
  }
</script> 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-06-15T01:00:29.533

您需要尝试一下您的设计，以查看大约有多少个字符将等于两行。如果您不使用固定字体，则必须查看一堆案例。

我使用此功能在我的一个网站上执行此操作。这会修剪到某个最大字符数，然后在字符串结尾之前的第一个空格处断开字符串。

```
function str_tr($string,$max)
{
 if(strlen($string)>$max)
 {
    $string = substr($string,0,$max);
    $i = strrpos($string," ");
    $string = substr($string,0,$i);
    $string .= "...";
 }
 return $string;
} 
```

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2012-06-15T01:14:19.673

正如@cpilko 所说......如果它不是固定大小的字体......它肯定不会工作......</p>

30 i（小字符）与 w（大字符）的非固定字体

iiiiiiiiiiiiiiiiiiiiiiiiiiiiii

wwwwwwwwwwwwwwwwwwwwwwwwwwwwww

但是，在固定大小的字体中……事情更容易预测：

```
iiiiiiiiiiiiiiiiiiiiiiiiiiiiii
wwwwwwwwwwwwwwwwwwwwwwwwwwwwww 
```

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2012-06-15T02:33:29.697

您需要的是 text-overflow CSS 属性。它使用 CSS 来截断固定宽度容器中多余的文本，并用省略号字符替换溢出部分。阅读更多：

[http://www.quirksmode.org/css/textoverflow.html](http://www.quirksmode.org/css/textoverflow.html)

# php - Symfony sfDoctrineGuard 密码加密

> ID：11043296
> 
> 赞同：1
> 
> 时间：2012-06-15T00:50:42.467
> 
> 标签：php, symfony1, passwords, sfguard, sfdoctrineguard

我有一个为用户使用 sfDoctrineGuardPlugin 的 Symfony 1.4 应用程序。

我需要将这些用户转移到新系统。在浏览了文档和代码之后，我无法理解 Symfony 如何存储/检查密码。

我希望我的新系统 (CakePHP) 以与旧系统相同的方式存储和检查密码，这样任何人都不必更改密码。

我该怎么办？有人可以发布一个简单的例子吗？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-06-15T07:39:04.353

我认为您只需要[深入研究](http://trac.symfony-project.org/browser/plugins/sfDoctrineGuardPlugin/trunk/lib/model/doctrine/PluginsfGuardUser.class.php#L37)代码 e，当 sfGuard 生成密码 ( `setPassword`) 和 sfGuard 检查密码 ( `checkPasswordByGuard`) 时。

他们使用一种算法（默认情况下`sha1`）来存储加盐的密码。

# asp.net-mvc - 在复选框选择上启用/禁用“DropDownListFor”

> ID：11043297
> 
> 赞同：3
> 
> 时间：2012-06-15T00:50:48.177
> 
> 标签：asp.net-mvc, asp.net-mvc-3, drop-down-menu, html.dropdownlistfor

我正在工作显示选择复选框的下拉值。但是使用下面的代码，下拉菜单中的所有不同项目都会直接出现。

不知何故，@Html.DropDownListFor 在选择标签内不起作用，有人可以帮我修复它吗？

注意：复选框切换完美。

谢谢，

## .cshtml

```
<input type="checkbox" /> 
<p>check this box to escalate</p>          
<select disabled="disabled">    
@Html.DropDownListFor(
    model => model.EscalationQueue,
        new SelectList(Extensions.EscalationQueue, Model.EscalationQueue),
          new { @class = "escalation-queue", name = Model.EscalationQueue }
)  
</select> 
```

## .js 文件

```
var dropdownToggle = function () {
    $("input:checkbox").change(function () {
        if ($("input:checkbox").is(":checked")) {
            $("select").removeAttr("disabled");
        }
        else {
            $("select").attr("disabled", "disabled");
        }
    });
}

$(document).ready(function () {
    dropdownToggle();
}); 
```

输出：

![电流输出1](../Images/d095a72fc30c720c8a921aae2a5d1ecd.png)

![电流输出2](../Images/7b0d3f7135cbcb623dd3bc493f6ac997.png)

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-06-15T00:53:00.363

您不需要`<select>`标签，它`HtmlHelper` `DropDownListFor`会为您呈现。如果要将下拉菜单初始化为禁用，请像声明 cssclass 一样设置 html 属性...

```
<input type="checkbox" /> 
<p>check this box to escalate</p>  
@Html.DropDownListFor(
        model => model.EscalationQueue,
        new SelectList(Extensions.EscalationQueue, Model.EscalationQueue),
        new { @class = "escalation-queue", 
                name = Model.EscalationQueue, 
                disabled= "disabled" 
         }
) 
```

# sql - 具有两个条件的 pl/sql 排除连接

> ID：11043298
> 
> 赞同：0
> 
> 时间：2012-06-15T00:51:19.077
> 
> 标签：sql, join, oracle11g

当我运行以下代码时，如果行具有（相同的工具和相同的配方），我想排除加入

```
select a.tool, a.recipe
from dual a
where a.tool NOT IN (select b.tool from daul2 b)
and a.recipe NOT IN (select b.recipe from dual2 b) 
```

它首先过滤工具然后是配方，但我希望程序同时检查它。

有没有办法同时检查两列？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-06-15T01:01:36.413

我不完全确定我明白你在问什么。我的猜测是你想要

```
SELECT a.tool, a.recipe
  FROM table1 a
 WHERE (a.tool, a.recipe) NOT IN (SELECT b.tool, b.recipe
                                    FROM table2 b) 
```

或者

```
SELECT a.tool, a.recipe
  FROM table1 a
 WHERE NOT EXISTS( SELECT 1
                     FROM table2 b
                    WHERE a.tool = b.tool 
                      AND a.recipe = b.recipe ) 
```

如果这不是您想要的，您能否发布一些示例数据并解释您要排除和包含的内容？

# android - mvn android:deploy -> 不幸的是应用程序已停止

> ID：11043300
> 
> 赞同：2
> 
> 时间：2012-06-15T00:51:40.803
> 
> 标签：android, eclipse, maven

我做了一个基本的Android项目。我用 AVD 在 Eclipse 中运行它，一切都很好。它运行的应用程序。但是当我尝试时：`mvn android:deploy`一切似乎都很好，但是 AVD 说：`Unfortunately App has stopped`

**mvn 干净安装**

```
[INFO] Scanning for projects...
[INFO]                                                                         
[INFO] ------------------------------------------------------------------------
[INFO] Building SakebuApp 1.0.0-SNAPSHOT
[INFO] ------------------------------------------------------------------------
[INFO] 
[INFO] --- maven-clean-plugin:2.4.1:clean (default-clean) @ SakebuApp ---
[INFO] Deleting C:\Workspace\SakebuApp\target
[INFO] 
[INFO] --- android-maven-plugin:3.2.0:generate-sources (default-generate-sources) @ SakebuApp ---
[INFO] ANDROID-904-002: Found aidl files: Count = 0
[INFO] ANDROID-904-002: Found aidl files: Count = 0
[INFO] C:\Program Files (x86)\Android\android-sdk\platform-tools\aapt.exe [package, -m, -J, C:\Workspace\SakebuApp\target\generated-sources\r, -M, C:\Workspace\SakebuApp\AndroidManifest.xml, -S, C:\Workspace\SakebuApp\res, --auto-add-overlay, -A, C:\Workspace\SakebuApp\assets, -I, C:\Program Files (x86)\Android\android-sdk\platforms\android-15\android.jar]
[INFO] 
[INFO] --- maven-resources-plugin:2.5:resources (default-resources) @ SakebuApp ---
[debug] execute contextualize
[WARNING] Using platform encoding (Cp1252 actually) to copy filtered resources, i.e. build is platform dependent!
[INFO] skip non existing resourceDirectory C:\Workspace\SakebuApp\src\main\resources
[INFO] skip non existing resourceDirectory C:\Workspace\SakebuApp\target\generated-sources\extracted-dependencies\src\main\resources
[INFO] 
[INFO] --- maven-compiler-plugin:2.5.1:compile (default-compile) @ SakebuApp ---
[WARNING] File encoding has not been set, using platform encoding Cp1252, i.e. build is platform dependent!
[INFO] Compiling 1 source file to C:\Workspace\SakebuApp\target\classes
[INFO] 
[INFO] --- android-maven-plugin:3.2.0:proguard (default-proguard) @ SakebuApp ---
[INFO] 
[INFO] --- maven-resources-plugin:2.5:testResources (default-testResources) @ SakebuApp ---
[debug] execute contextualize
[WARNING] Using platform encoding (Cp1252 actually) to copy filtered resources, i.e. build is platform dependent!
[INFO] skip non existing resourceDirectory C:\Workspace\SakebuApp\src\test\resources
[INFO] 
[INFO] --- maven-compiler-plugin:2.5.1:testCompile (default-testCompile) @ SakebuApp ---
[INFO] No sources to compile
[INFO] 
[INFO] --- maven-surefire-plugin:2.12:test (default-test) @ SakebuApp ---
[INFO] No tests to run.
[INFO] Surefire report directory: C:\Workspace\SakebuApp\target\surefire-reports

-------------------------------------------------------
 T E S T S
-------------------------------------------------------

Results :

Tests run: 0, Failures: 0, Errors: 0, Skipped: 0

[INFO] 
[INFO] --- android-maven-plugin:3.2.0:emma (default-emma) @ SakebuApp ---
[INFO] 
[INFO] --- android-maven-plugin:3.2.0:dex (default-dex) @ SakebuApp ---
[INFO] C:\Program Files\Java\jdk1.6.0_22\jre\bin\java [-Xmx1024M, -jar, C:\Program Files (x86)\Android\android-sdk\platform-tools\lib\dx.jar, --dex, --output=C:\Workspace\SakebuApp\target\classes.dex, C:\Workspace\SakebuApp\target\classes]
[INFO] 
[INFO] --- maven-jar-plugin:2.4:jar (default-jar) @ SakebuApp ---
[INFO] Building jar: C:\Workspace\SakebuApp\target\SakebuApp.jar
[INFO] 
[INFO] --- android-maven-plugin:3.2.0:apk (default-apk) @ SakebuApp ---
[INFO] Copying local assets files to combined assets directory.
[INFO] C:\Program Files (x86)\Android\android-sdk\platform-tools\aapt.exe [package, -f, -M, C:\Workspace\SakebuApp\AndroidManifest.xml, -S, C:\Workspace\SakebuApp\res, --auto-add-overlay, -A, C:\Workspace\SakebuApp\target\generated-sources\combined-assets\assets, -I, C:\Program Files (x86)\Android\android-sdk\platforms\android-15\android.jar, -F, C:\Workspace\SakebuApp\target\SakebuApp.ap_]
[INFO] 
[INFO] --- android-maven-plugin:3.2.0:internal-pre-integration-test (default-internal-pre-integration-test) @ SakebuApp ---
[INFO] No InstrumentationRunner found - skipping tests
[INFO] 
[INFO] --- android-maven-plugin:3.2.0:internal-integration-test (default-internal-integration-test) @ SakebuApp ---
[INFO] No InstrumentationRunner found - skipping tests
[INFO] 
[INFO] --- maven-source-plugin:2.1.2:jar-no-fork (attach-sources) @ SakebuApp ---
[INFO] Building jar: C:\Workspace\SakebuApp\target\SakebuApp-sources.jar
[INFO] 
[INFO] --- maven-install-plugin:2.3.1:install (default-install) @ SakebuApp ---
[INFO] Installing C:\Workspace\SakebuApp\target\SakebuApp.apk to C:\Users\HP\.m2\repository\com\sakebu\android\SakebuApp\1.0.0-SNAPSHOT\SakebuApp-1.0.0-SNAPSHOT.apk
[INFO] Installing C:\Workspace\SakebuApp\pom.xml to C:\Users\HP\.m2\repository\com\sakebu\android\SakebuApp\1.0.0-SNAPSHOT\SakebuApp-1.0.0-SNAPSHOT.pom
[INFO] Installing C:\Workspace\SakebuApp\target\SakebuApp.jar to C:\Users\HP\.m2\repository\com\sakebu\android\SakebuApp\1.0.0-SNAPSHOT\SakebuApp-1.0.0-SNAPSHOT.jar
[INFO] Installing C:\Workspace\SakebuApp\target\SakebuApp-sources.jar to C:\Users\HP\.m2\repository\com\sakebu\android\SakebuApp\1.0.0-SNAPSHOT\SakebuApp-1.0.0-SNAPSHOT-sources.jar
[INFO] ------------------------------------------------------------------------
[INFO] BUILD SUCCESS
[INFO] ------------------------------------------------------------------------
[INFO] Total time: 6.910s
[INFO] Finished at: Fri Jun 15 02:39:34 CEST 2012
[INFO] Final Memory: 20M/152M
[INFO] ------------------------------------------------------------------------ 
```

**mvn 安卓：部署**

```
[INFO] Scanning for projects...
[INFO]                                                                         
[INFO] ------------------------------------------------------------------------
[INFO] Building SakebuApp 1.0.0-SNAPSHOT
[INFO] ------------------------------------------------------------------------
[INFO] 
[INFO] --- android-maven-plugin:3.2.0:deploy (default-cli) @ SakebuApp ---
[INFO] C:\Program Files (x86)\Android\android-sdk\platform-tools\aapt.exe [dump, xmltree, C:\Workspace\SakebuApp\target\SakebuApp.apk, AndroidManifest.xml]
N: android=http://schemas.android.com/apk/res/android
  E: manifest (line=2)
    A: android:versionCode(0x0101021b)=(type 0x10)0x1
    A: android:versionName(0x0101021c)="1.0" (Raw: "1.0")
    A: package="com.sakebu.android" (Raw: "com.sakebu.android")
    E: uses-sdk (line=7)
      A: android:minSdkVersion(0x0101020c)=(type 0x10)0xf
    E: application (line=9)
      A: android:label(0x01010001)=@0x7f040001
      A: android:icon(0x01010002)=@0x7f020000
      E: activity (line=12)
        A: android:label(0x01010001)=@0x7f040001
        A: android:name(0x01010003)=".SakebuAppActivity" (Raw: ".SakebuAppActivity")
        E: intent-filter (line=15)
          E: action (line=16)
            A: android:name(0x01010003)="android.intent.action.MAIN" (Raw: "android.intent.action.MAIN")
          E: category (line=18)
            A: android:name(0x01010003)="android.intent.category.LAUNCHER" (Raw: "android.intent.category.LAUNCHER")
[INFO] Waiting for initial device list from the Android Debug Bridge
[INFO] Found 1 devices connected with the Android Debug Bridge
[INFO] android.device parameter not set, using all attached devices
[INFO] Successfully uninstalled com.sakebu.android from emulator-5554_sakebuEM_unknown_sdk
[INFO] Found 1 devices connected with the Android Debug Bridge
[INFO] android.device parameter not set, using all attached devices
[INFO] Successfully installed C:\Workspace\SakebuApp\target\SakebuApp.apk to emulator-5554_sakebuEM_unknown_sdk
[INFO] ------------------------------------------------------------------------
[INFO] BUILD SUCCESS
[INFO] ------------------------------------------------------------------------
[INFO] Total time: 22.919s
[INFO] Finished at: Fri Jun 15 02:42:38 CEST 2012
[INFO] Final Memory: 11M/111M
[INFO] ------------------------------------------------------------------------ 
```

**pom.xml**

```
<project xmlns="http://maven.apache.org/POM/4.0.0" xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance"
    xsi:schemaLocation="http://maven.apache.org/POM/4.0.0 http://maven.apache.org/xsd/maven-4.0.0.xsd">
    <modelVersion>4.0.0</modelVersion>
    <groupId>com.sakebu.android</groupId>
    <artifactId>SakebuApp</artifactId>
    <version>1.0.0-SNAPSHOT</version>
    <packaging>apk</packaging>
    <name>SakebuApp</name>

    <dependencies>

        <dependency>
            <groupId>com.google.android</groupId>
            <artifactId>android</artifactId>
            <version>4.0.1.2</version>
            <scope>provided</scope>
        </dependency>

    </dependencies>

    <build>
        <finalName>${project.artifactId}</finalName>
        <plugins>
            <plugin>
                <groupId>org.apache.maven.plugins</groupId>
                <artifactId>maven-source-plugin</artifactId>
                <version>2.1.2</version>
                <executions>
                    <execution>
                        <id>attach-sources</id>
                        <phase>verify</phase>
                        <goals>
                            <goal>jar-no-fork</goal>
                        </goals>
                    </execution>
                </executions>
            </plugin>
            <plugin>
                <artifactId>maven-compiler-plugin</artifactId>
                <version>2.5.1</version>
                <configuration>
                    <source>1.6</source>
                    <target>1.6</target>
                </configuration>
            </plugin>
            <plugin>
                <groupId>com.jayway.maven.plugins.android.generation2</groupId>
                <artifactId>android-maven-plugin</artifactId>
                <version>3.2.0</version>
                <configuration>
                    <sdk>
                        <platform>15</platform>
                    </sdk>
                    <emulator>
                        <avd>sakebuEM</avd>
                    </emulator>
                    <deleteConflictingFiles>true</deleteConflictingFiles>
                    <undeployBeforeDeploy>true</undeployBeforeDeploy>
                </configuration>
                <extensions>true</extensions>
            </plugin>
        </plugins>
    </build>
</project> 
```

**单击图标应用程序时的输出：** `Unfortunately App has stopped`

**当我运行 mvn android:deploy 时输出 Dalvik**

```
06-15 08:53:39.025: D/AndroidRuntime(2173): Shutting down VM
06-15 08:53:39.025: W/dalvikvm(2173): threadid=1: thread exiting with uncaught exception (group=0x409c01f8)
06-15 08:53:39.055: E/AndroidRuntime(2173): FATAL EXCEPTION: main
06-15 08:53:39.055: E/AndroidRuntime(2173): java.lang.RuntimeException: Unable to instantiate activity ComponentInfo{com.sakebu.android/com.sakebu.android.SakebuAppActivity}: java.lang.ClassNotFoundException: com.sakebu.android.SakebuAppActivity
06-15 08:53:39.055: E/AndroidRuntime(2173):     at android.app.ActivityThread.performLaunchActivity(ActivityThread.java:1880)
06-15 08:53:39.055: E/AndroidRuntime(2173):     at android.app.ActivityThread.handleLaunchActivity(ActivityThread.java:1981)
06-15 08:53:39.055: E/AndroidRuntime(2173):     at android.app.ActivityThread.access$600(ActivityThread.java:123)
06-15 08:53:39.055: E/AndroidRuntime(2173):     at android.app.ActivityThread$H.handleMessage(ActivityThread.java:1147)
06-15 08:53:39.055: E/AndroidRuntime(2173):     at android.os.Handler.dispatchMessage(Handler.java:99)
06-15 08:53:39.055: E/AndroidRuntime(2173):     at android.os.Looper.loop(Looper.java:137)
06-15 08:53:39.055: E/AndroidRuntime(2173):     at android.app.ActivityThread.main(ActivityThread.java:4424)
06-15 08:53:39.055: E/AndroidRuntime(2173):     at java.lang.reflect.Method.invokeNative(Native Method)
06-15 08:53:39.055: E/AndroidRuntime(2173):     at java.lang.reflect.Method.invoke(Method.java:511)
06-15 08:53:39.055: E/AndroidRuntime(2173):     at com.android.internal.os.ZygoteInit$MethodAndArgsCaller.run(ZygoteInit.java:784)
06-15 08:53:39.055: E/AndroidRuntime(2173):     at com.android.internal.os.ZygoteInit.main(ZygoteInit.java:551)
06-15 08:53:39.055: E/AndroidRuntime(2173):     at dalvik.system.NativeStart.main(Native Method)
06-15 08:53:39.055: E/AndroidRuntime(2173): Caused by: java.lang.ClassNotFoundException: com.sakebu.android.SakebuAppActivity
06-15 08:53:39.055: E/AndroidRuntime(2173):     at dalvik.system.BaseDexClassLoader.findClass(BaseDexClassLoader.java:61)
06-15 08:53:39.055: E/AndroidRuntime(2173):     at java.lang.ClassLoader.loadClass(ClassLoader.java:501)
06-15 08:53:39.055: E/AndroidRuntime(2173):     at java.lang.ClassLoader.loadClass(ClassLoader.java:461)
06-15 08:53:39.055: E/AndroidRuntime(2173):     at android.app.Instrumentation.newActivity(Instrumentation.java:1023)
06-15 08:53:39.055: E/AndroidRuntime(2173):     at android.app.ActivityThread.performLaunchActivity(ActivityThread.java:1871)
06-15 08:53:39.055: E/AndroidRuntime(2173):     ... 11 more
06-15 08:53:39.265: I/dalvikvm(2173): threadid=3: reacting to signal 3
06-15 08:53:39.285: I/dalvikvm(2173): Wrote stack traces to '/data/anr/traces.txt'
06-15 08:53:39.705: I/dalvikvm(2173): threadid=3: reacting to signal 3
06-15 08:53:39.775: I/dalvikvm(2173): Wrote stack traces to '/data/anr/traces.txt' 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-06-16T10:51:12.610

我创建了一个新的 maven android 项目。我认为问题是不正确的原型。我在新项目中遵循了以下步骤：[m2Eclipse 集成](https://code.google.com/a/eclipselabs.org/p/m2eclipse-android-integration/wiki/GettingStarted)，但您必须将 android-maven-plugin 更新到 3.2.0 版，否则无法正常工作。

# python - 如何在没有新字典变量的情况下打印字典？

> ID：11043303
> 
> 赞同：1
> 
> 时间：2012-06-15T00:51:53.950
> 
> 标签：python

如何同时创建和追加字典？

```
def buildList(theDict):
    array=[]
    for a,b in theDict.iteritems():
        array.append([a,b])

    return array
print buildList({"a": 1,"b": 2,"c": 3}) 
```

这将打印出列表列表。我想在不创建任何新变量的情况下打印出字典列表。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-06-15T00:57:33.730

如果我正确理解你想要什么，这段代码应该可以工作。

```
def list_of_dicts(d):
    return [{key:value} for key, value in d.iteritems()]

print list_of_dicts({"a": 1,"b": 2,"c": 3}) 
```

`list_of_dicts()`使用列表推导，它`dict`为传入字典中的每个键/值对创建一个新条目。

您知道如何使用列表推导来重写您的示例并返回列表列表吗？它只需要更改上面的三个字符。

PS 我使用 PEP 8 名称（小写而不是 camelCase）。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-06-15T01:50:50.547

`array.append({a:b})`代替`array.append([a,b])`

或使用[列表理解](http://www.python.org/dev/peps/pep-0202/)

```
array = [{a:b} for a,b in theDict.iteritems()] 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-06-15T01:20:38.503

您的答案已经几乎是您所需要的。当您附加到列表时，您正在使用以下代码创建一个新列表：`[a, b]`

所以，用另一段代码替换那段代码，一个创建字典的代码。你知道如何创建字典！

如果您需要提示，请查看我的另一个答案中的列表推导，看看您是否可以弄清楚列表推导如何创建新的字典值。

我知道你可以解决这个问题！

# c - C 在不同的目录中打开一个文件进行读取

> ID：11043305
> 
> 赞同：1
> 
> 时间：2012-06-15T00:52:00.387
> 
> 标签：c, file, directory

对文件系统操作有疑问：在我们执行程序的不同目录中打开文件。

假设我们在以下目录中执行我们的程序：/home/example，我们希望程序转到另一个目录，例如：home/example/Inside/Test，并打开最后一个目录中的所有 txt 文件。

好的，这是一个小代码：

```
 /*variables*/
  struct dirent *strdir;
  DIR *diro; 
  struct stat statbuffer;
  char *path = /home/example/Inside/test

  diro = opendir( path )
  /*cheked it opened properly*/
  while ( (strdir = readdir(diro)) != NULL ){
     stat(strdir->d_name, &statbuffer);         /*Gets information of file*/
     if (S_ISREG(statbuffer.st_mode)){
       /*its regular type*/
       /*check its of type txt*/
       ??? 
```

我放`???`是因为我使用了fopen，它不起作用。当然不是，因为 /home/example 中不存在该文件。打开也一样。

所以我认为，也许我可以将目录和文件名连接成一个字符以获得完整路径，但这听起来有点难看......

另一个想法是使用 stat 提供给我的信息，但我似乎无法弄清楚如何使其工作。硬链接？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-06-15T00:53:45.997

似乎您为此函数指定的任何参数都必须是字符串。

```
 opendir( /home/example/Inside/Test ) 
```

请参阅此 SO 问题[Open directory using C](https://stackoverflow.com/a/3554147/1209279)

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-06-15T00:55:13.593

如果您不想将目录名称放在路径上（这可能是正确的做法），请致电`chdir("/home/example/Inside/Test");`

# exception - 执行大量查询时事务回滚（JBoss 5.1）

> ID：11043306
> 
> 赞同：2
> 
> 时间：2012-06-15T00:52:01.257
> 
> 标签：exception, transactions, jboss5.x, max

我在执行大量查询时遇到问题。

我需要在单个事务中执行超过 10,000 个本机 sql 查询。这些查询是动态生成的并缓存在系统中。查询生成完成后，这些查询将在单个事务中一一发送并执行。该应用程序使用 EJB 3 开发并在 JBoss 5.1 上运行。

如果查询数少于 7200（近似值），则应用程序可以正常工作。但是，如果查询数量超过此数量，则该方法会抛出 EJB 异常，并且事务会回滚。没有数据被持久化。

这是发生回滚的地方。[仅当查询数超过 7200 时]

```
 @TransactionAttribute(TransactionAttributeType.REQUIRED)
 public void confirmOrder(String[] queries) {
    for (int i = 0; i < queries.length; i++) {
        em.createNativeQuery(queries[i]).executeUpdate();        //line # 108
    }
    BigInteger bigInt = (BigInteger)em.createNativeQuery("select max(id) from order_item").getSingleResult();
    return bigInt!=null ? Long.valueOf(bigInt.longValue()) : null;
} 
```

有没有办法增加可以在事务中执行的查询数量？请就此提出您的建议。

/维拉吉

```
The following is the error trace.

17:36:33,233 WARN  [arjLoggerI18N] [com.arjuna.ats.arjuna.coordinator.TransactionReaper_18] - TransactionReaper::check timeout for TX -3f57767b:bc55:4fd9d129:e3a3 in state  RUN
17:36:33,238 WARN  [arjLoggerI18N] [com.arjuna.ats.arjuna.coordinator.TransactionReaper_7] - TransactionReaper::doCancellations worker Thread[Thread-10,5,jboss] successfully canceled TX -3f57767b:bc55:4fd9d129:e3a3
17:36:33,635 WARN  [arjLoggerI18N] [com.arjuna.ats.arjuna.coordinator.TransactionReaper_18] - TransactionReaper::check timeout for TX -3f57767b:bc55:4fd9d129:e3bf in state  RUN
17:36:33,636 WARN  [arjLoggerI18N] [com.arjuna.ats.arjuna.coordinator.BasicAction_58] - Abort of action id -3f57767b:bc55:4fd9d129:e3bf invoked while multiple threads active within it.
17:36:33,636 WARN  [arjLoggerI18N] [com.arjuna.ats.arjuna.coordinator.CheckedAction_2] - CheckedAction::check - atomic action -3f57767b:bc55:4fd9d129:e3bf aborting with 1 threads active!
17:36:34,135 WARN  [arjLoggerI18N] [com.arjuna.ats.arjuna.coordinator.TransactionReaper_18] - TransactionReaper::check timeout for TX -3f57767b:bc55:4fd9d129:e3bf in state  CANCEL
17:36:34,635 WARN  [arjLoggerI18N] [com.arjuna.ats.arjuna.coordinator.TransactionReaper_18] - TransactionReaper::check timeout for TX -3f57767b:bc55:4fd9d129:e3bf in state  CANCEL_INTERRUPTED
17:36:34,636 WARN  [arjLoggerI18N] [com.arjuna.ats.arjuna.coordinator.TransactionReaper_6] - TransactionReaper::check worker Thread[Thread-10,5,jboss] not responding to interrupt when cancelling TX -3f57767b:bc55:4fd9d129:e3bf -- worker marked as zombie and TX scheduled for mark-as-rollback
17:36:34,636 WARN  [arjLoggerI18N] [com.arjuna.ats.arjuna.coordinator.TransactionReaper_11] - TransactionReaper::check failed to mark TX -3f57767b:bc55:4fd9d129:e3bf  as rollback only
17:36:34,904 WARN  [arjLoggerI18N] [com.arjuna.ats.arjuna.coordinator.TwoPhaseCoordinator_4] TwoPhaseCoordinator.afterCompletion - returned failure for com.arjuna.ats.internal.jta.resources.arjunacore.SynchronizationImple@5a720719
17:36:34,926 WARN  [arjLoggerI18N] [com.arjuna.ats.arjuna.coordinator.TransactionReaper_13] - TransactionReaper::doCancellations worker Thread[Thread-10,5,jboss] missed interrupt when cancelling TX -3f57767b:bc55:4fd9d129:e3bf -- exiting as zombie (zombie count decremented to 0)   ........   
  ......

17:36:34,935 ERROR [CardOrderCreateFacadeBean] Confirming order is failed.   
javax.ejb.EJBTransactionRolledbackException: Executing an update/delete query
    at org.jboss.ejb3.tx.Ejb3TxPolicy.handleInCallerTx(Ejb3TxPolicy.java:115)
    at org.jboss.aspects.tx.TxPolicy.invokeInCallerTx(TxPolicy.java:130)
    at org.jboss.aspects.tx.TxInterceptor$Required.invoke(TxInterceptor.java:194)
    at org.jboss.aop.joinpoint.MethodInvocation.invokeNext(MethodInvocation.java:102)
    at org.jboss.aspects.tx.TxPropagationInterceptor.invoke(TxPropagationInterceptor.java:76)
    at org.jboss.aop.joinpoint.MethodInvocation.invokeNext(MethodInvocation.java:102)
    at org.jboss.ejb3.security.RunAsSecurityInterceptorv2.invoke(RunAsSecurityInterceptorv2.java:94)
    at org.jboss.aop.joinpoint.MethodInvocation.invokeNext(MethodInvocation.java:102)
    at org.jboss.ejb3.security.RoleBasedAuthorizationInterceptorv2.invoke(RoleBasedAuthorizationInterceptorv2.java:201)
    at org.jboss.aop.joinpoint.MethodInvocation.invokeNext(MethodInvocation.java:102)
    at org.jboss.ejb3.security.Ejb3AuthenticationInterceptorv2.invoke(Ejb3AuthenticationInterceptorv2.java:186)
    at org.jboss.aop.joinpoint.MethodInvocation.invokeNext(MethodInvocation.java:102)
    ........................
    ...............

Caused by: javax.persistence.TransactionRequiredException: Executing an update/delete query
    at org.hibernate.ejb.QueryImpl.executeUpdate(QueryImpl.java:48)
    at rk.ejb.eao.OrderEAOImpl.confirmOrder(OrderEAOImpl.java:108)
    at sun.reflect.NativeMethodAccessorImpl.invoke0(Native Method)
    at sun.reflect.NativeMethodAccessorImpl.invoke(NativeMethodAccessorImpl.java:39)
    at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:25)
    at java.lang.reflect.Method.invoke(Method.java:597)
    at org.jboss.aop.joinpoint.MethodInvocation.invokeTarget(MethodInvocation.java:122)
    at org.jboss.aop.joinpoint.MethodInvocation.invokeNext(MethodInvocation.java:111)
    at org.jboss.ejb3.EJBContainerInvocationWrapper.invokeNext(EJBContainerInvocationWrapper.java:69)
    at org.jboss.ejb3.interceptors.aop.InterceptorSequencer.invoke(InterceptorSequencer.java:76)
    at org.jboss.ejb3.interceptors.aop.InterceptorSequencer.aroundInvoke(InterceptorSequencer.java:62)
    at sun.reflect.GeneratedMethodAccessor358.invoke(Unknown Source)
    ........
    ....... 
```

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2012-12-13T07:07:05.740

您可以根据需要在全局或方法级别增加事务超时。

*   如果您想在方法级别执行此操作，可以使用以下注释。（超时设置为 1500 秒）@TransactionTimeout(1500)
*   如果要全局执行此操作，则必须编辑位于 [server-instance]/deploy 目录中的 transaction-jboss-beans.xml 并更改超时参数值。例如：超时值为 1200 秒

    > <property name="transactionTimeout">1200</property>

欲了解更多信息：[https ://community.jboss.org/wiki/TransactionTimeout](https://community.jboss.org/wiki/TransactionTimeout)

* * *

## 回答 #2

> 赞同：5
> 
> 时间：2012-06-20T12:35:28.357

我能够解决这个问题。尽管它显示了这样的异常，但这是由于事务回滚而发生的。回滚事务的确切原因是事务超时。当有大量查询要执行时，事务超时，最终结果就是上述异常。在 JBoss 事务配置中进行更改，消除了错误。

# php - Php Header 根据页面链接到不同的链接

> ID：11043310
> 
> 赞同：1
> 
> 时间：2012-06-15T00:52:48.983
> 
> 标签：php, header

我最近将我的 23 个 html 页面的双语网站更改为 23 个 php 页面（该站点是：www.creativemindspcs.org。）通过此更改，我包括了 php 页眉、页脚和导航。

我不知道如何根据我所在的页面更改标题链接。

例子。关于我们的英文页面。在标题中，我有一个链接，上面写着“Espanol”。当您单击该链接时，它应该将您带到关于我们的西班牙语页面，但现在由于 php 标头包含在所有页面中，它只链接到一个页面而不是正确的页面。

如何根据需要访问的页面更改这些链接？谁有好的教程？

**HTML 代码：**

```
<header><insert php code here> include('includes/header.php'); 
```

**包括标题代码：**

```
<!--==============================header=================================-->

<div id="header" class="editable">

    <div class="inner" >

        <div class="meta-info">

        <div class="extra-wrap">

        <ul class="social-links">

        <li><a href="index.html">English</a></li>

        <li><a href="esp-index.html">Espa&#xF1;ol</a></li>

        <li><a href="contactus.html">Contact Us</a></li>
        </ul>

        <form id="main-search" action="search.php"  >

        <input type="text" name="search"  style="background-color:#CCCCCC" >

        <a class="search-submit" onClick="document.getElementById('main-search').submit()" ></a>
        </form>
        </div>

        <br><br><br><a href="supportus.html" class="button3">Donate</a>  <a href="apply.html" class="button4">Apply</a>     </div>

        <img src="site/images/CMLOGO.GIF" align="top" alt="Guitar Logo"><a href="index.html"></a>     

</div>

<div class="clear"></div>

        </div> 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-06-15T01:04:58.863

您可以使用 PHP **$_SERVER['variable_name']**

在此处检查数组变量：http: [//br2.php.net/manual/en/reserved.variables.server.php](http://br2.php.net/manual/en/reserved.variables.server.php)

我可能会使用**$_SERVER['SCRIPT_FILENAME']**、**$_SERVER['PHP_SELF']**或**$_SERVER['REQUEST_URI']**。

您可以看到可能的结果，将其添加到包含的标题中以检查变量：

```
echo "<pre>";
print_r($_SERVER);
echo "</pre>"; 
```

因此，您的链接可能类似​​于：

```
<a href="<?php $_SERVER['REQUEST_URI']; ?>spanish.html"> 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-06-15T01:01:39.050

因此，双语页面的方法通常是存储不同语言的网站不同部分的哈希值，然后提供相同的模板页面。但是在您的情况下，您使用链接似乎朝着不同但相似的方向发展。我想说看看这里的初学者[https://stackoverflow.com/questions/1228018/php-multilingual-site](https://stackoverflow.com/questions/1228018/php-multilingual-site)

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-06-15T01:33:21.613

假设您使用的是 Apache，我建议您使用`mod_rewrite`它来重写您的 URL。因此，例如，当用户访问该页面时`esp-content.html`，URL 将被重写为`content.html?lang=esp`. 然后只需在所有链接中包含语言代码：

```
$lang = (isset($_GET['lang'])) ? urlencode($_GET['lang']) . '-' : null;
echo '<a href="'.$lang.'content.html">'; 
```

# c - 我得到“无效的初始化程序”，我做错了什么？

> ID：11043313
> 
> 赞同：26
> 
> 时间：2012-06-15T00:53:00.553
> 
> 标签：c, arrays

```
int main(void) {
    char testStr[50] = "Hello, world!";
    char revS[50] = testStr;
} 
```

我收到错误：与`revS`. 我究竟做错了什么？

* * *

## 回答 #1

> 赞同：34
> 
> 时间：2012-06-15T00:55:21.000

您不能`revS`以这种方式进行初始化，您需要在`=`. 来自`C11 6.7.9 Initialization /14, /16`：

> 14/ 字符类型的数组可以由字符串文字或 UTF-8 字符串文字初始化，可选用大括号括起来。
> 
> 字符串文字的连续字节（如果有空间或数组大小未知，则包括终止的空字符）初始化数组的元素。
> 
> `: : :`
> 
> 16/否则，具有聚合或联合类型的对象的初始化程序应是元素或命名成员的初始化程序的大括号括起来的列表。

* * *

要获得相同的结果，您可以将代码替换为：

```
int main (void) {
    char testStr[50] = "Hello, world!";
    char revS[50]; strcpy (revS, testStr);
    // more code here
} 
```

这不是技术上的*初始化*，而是实现了相同的功能结果。如果你真的*想要*初始化，你可以使用类似的东西：

```
#define HWSTR "Hello, world!"
int main (void) {
    char testStr[50] = HWSTR;
    char revS[50] = HWSTR;
    // more code here
} 
```

* * *

## 回答 #2

> 赞同：9
> 
> 时间：2012-06-15T00:55:40.397

数组不可分配。

您应该使用 memcpy 将内容从复制`testStr`到`revS`

```
memcpy(revS,testStr,50); 
```

* * *

## 回答 #3

> 赞同：4
> 
> 时间：2012-06-15T00:55:46.677

只能使用常量表达式来初始化数组，就像在`testStr`.

您正在尝试`revS`使用另一个数组变量进行初始化，该变量**不是**常量表达式。如果要将第一个字符串的内容复制到第二个字符串中，则需要使用`strcpy`.

* * *

## 回答 #4

> 赞同：3
> 
> 时间：2012-06-15T00:55:03.030

a 的初始化程序`char[]`需要是文字字符串或类似`{1,2,3,4}`. 不允许是另一个变量的名称。

* * *

## 回答 #5

> 赞同：2
> 
> 时间：2013-12-31T03:17:46.717

除非您打算操作第二个数组，否则您也可以使用指针：

```
int main(void){
    char textStr[50] = "hello worlds!";
    char *revS = textStr;
    printf("%s\n", revS); 
```

}

如果您想变得非常疯狂，可以使用引用运算符指向数组中的特定位置：

```
int main(void){
    char textStr[50] = "hello worlds!";
    char *revS = textStr+5; // or &textStr[5]
    printf("%s\n", revS);
} 
```

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2012-06-15T05:51:56.400

你在做

```
char revS[50] = testStr; 
```

这是错误的，因为您不能分配`char *`给`char`.

试试`revS = testStr;`应该可以。

# clojure - clojure 有原始字符串吗？

> ID：11043318
> 
> 赞同：16
> 
> 时间：2012-06-15T00:53:20.803
> 
> 标签：clojure, escaping, rawstring

在 Python 中，我可以为字符串文字（原始字符串）添加前缀，`r`以告诉解释器不要翻译字符串中的特殊字符：

```
>>> r"abc\nsdf#$%\^"
r"abc\nsdf#$%\^" 
```

有没有办法在 Clojure 中做同样的事情？

* * *

## 回答 #1

> 赞同：15
> 
> 时间：2012-06-15T01:09:19.190

Clojure 字符串是 Java 字符串，读者不会对其解释添加任何重要内容。[阅读器页面](http://clojure.org/reader)只是说“支持标准 Java 转义字符”。

你可以逃避`\`：

```
user> (print "abc\\nsdf#$%\\^")
abc\nsdf#$%\^ 
```

这只会影响阅读器读取的字符串文字，因此如果您从文件中读取字符串，阅读器永远不会看到它们：

```
user> (spit "/tmp/foo" "abc\\nsdf#$%\\^")
nil
user> (slurp "/tmp/foo")
"abc\\nsdf#$%\\^"
user> (print (slurp "/tmp/foo"))
abc\nsdf#$%\^nil
user> 
```

所以，我认为基本答案是否定的。

* * *

## 回答 #2

> 赞同：5
> 
> 时间：2012-06-15T11:58:38.300

另请注意，如果您使用逆时针（Clojure 的 Eclipse 插件），则有一种称为“智能粘贴”（默认禁用）的模式，当您粘贴到现有文字字符串中时，它会正确转义特殊字符。

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2012-06-15T09:34:12.487

可能对用于此类目的的文字正则表达式有用。

```
user=> #"abc\nsdf#$%\^"
#"abc\nsdf#$%\^"
user=> (type #"abc\nsdf#$%\^")
java.util.regex.Pattern
user=> (println (str #"abc\nsdf#$%\^"))
abc\nsdf#$%\^
nil 
```

# android - 迭代 HashMap 对象的 ArrayList

> ID：11043321
> 
> 赞同：0
> 
> 时间：2012-06-15T00:53:31.580
> 
> 标签：android, hashmap, iteration

作为解析 XML 文件的结果，我有一个 HashMap 对象的 ArrayList。我想为某个键创建一个值的 ArrayList，以便在 ListView 中显示。这是我到目前为止所拥有的：

```
 // Initialize the guideList ArrayList
    ArrayList<String> guideList = new ArrayList<String>();
    HashMap<String,Object> dict = null;

    // Get the data - returns an ArrayList
    Object obj = plist.getConfigurationObject("array");

    // make sure an ArrayList was returned
    if (obj instanceof ArrayList) {

        // initialize Iterator
        Iterator itr = ((ArrayList) obj).iterator();
        int i = 0;

        // Loop through and create guideList ArrayList
        while (itr.hasNext()) {
            itr.next();
            dict = ((ArrayList<HashMap>) obj).get(i++);
            Object guideNo = dict.get("GUIDE_NO");
            guideList.add( "Guide "+guideNo.toString() );
        }
    } 
```

这段代码确实有效，但它是最有效的吗？

# javascript - 在 iframe 中刷新页面

> ID：11043323
> 
> 赞同：2
> 
> 时间：2012-06-15T00:53:46.850
> 
> 标签：javascript, html, facebook, internet-explorer, refresh

我有一个应用程序（facebook 画布应用程序，facebook 在 iframe 中显示该应用程序）

当用户单击链接时，我希望能够刷新页面。

我用来刷新页面的代码如下：

```
window.location.reload(true); 
```

使用 Firefox 可以正常工作，它只刷新 iframe 中的当前页面。所以我很高兴。

使用 IE，整个页面都会被刷新，这会导致用户进入应用程序的开头。

我怎样才能避免这种情况？

我只想刷新当前页面而不是当前 url。

```
apps.facebook.com/foo/ 
```

是应用程序 URL 并且在 URL 内用户单击链接转到页面，然后在该页面中我需要刷新该页面以更新一些计数器。但是当我刷新整个请求时`apps.facebook.com/foo/`

有任何想法吗？

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2013-06-04T07:23:30.677

```
var oiframe = document.getElementById('myiframe');

oiframe.contentWindow.location.reload(true); 
```

* * *

## 回答 #2

> 赞同：5
> 
> 时间：2012-06-15T03:51:01.143

您可以使用`window.location.href = window.location.href`

* * *

## 回答 #3

> 赞同：3
> 
> 时间：2012-06-15T01:07:43.633

如[http://www.hyperorg.com/blogger/2007/03/24/refresh-an-iframe-in-ie-anyone/中所述](http://www.hyperorg.com/blogger/2007/03/24/refresh-an-iframe-in-ie-anyone/)

HTML

```
<div id="wrapper"></div> 
```

Javascript

```
function reload () {
    var fr=document.getElementById('tehframe');
    if(fr!=null) document.getElementById("wrapper").removeChild(fr);
    var iframehtml="<iframe id='tehframe' src=…&gt;</iframe>";
    document.getElementById("wrapper").innerHTML=iframehtml;
} 
```

然后只需`reload()`在开始时调用，无论何时要加载它。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2012-06-15T01:01:44.387

您可以更改 iframe 的 url 并通过向 url 添加无意义的参数来导致刷新，例如 foo 变为 foo?bar

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2019-11-20T10:54:32.993

你可以使用这个技巧：

```
 <button onclick="window.parent.location = document.referrer">
    Reload
  </button> 
```

# c# - HtmlAgilityPack 用换行符替换段落标签

> ID：11043334
> 
> 赞同：1
> 
> 时间：2012-06-15T00:55:15.233
> 
> 标签：c#, html-parsing, html-agility-pack

我们使用的第三部分导出应用程序不会正确呈现段落标记（不包括段落之间的额外行），因此我尝试使用 HtmlAgilityPack 将所有段落标记替换为两个换行标记。

这是我到目前为止...

```
// Shortened for this example
string rawHtml = "<p><strong><span>1.0 Purpose</span></strong></p><p><span>The role</span></p><p><span>NOTE: Defined...</span></p>";

HtmlDocument doc = new HtmlDocument();
HtmlNode.ElementsFlags["br"] = HtmlElementFlag.Empty;
doc.LoadHtml(rawHtml);
doc.OptionWriteEmptyNodes = true;

// Updated using suggestion from Petr
HtmlNode linebreak = doc.CreateElement("br"); 
var paragraphTags = doc.DocumentNode.SelectNodes("p");
for (int i = 0; i < paragraphTags.Count; i++)
{
    HtmlNode childNode = HtmlNode.CreateNode(paragraphTags[i].InnerHtml);
    HtmlNode nextNode = paragraphTags[i];

    if (i > 0)
    {
        nextNode = doc.DocumentNode.InsertAfter(linebreak, nextNode);
        nextNode = doc.DocumentNode.InsertAfter(linebreak, nextNode);
    }
    doc.DocumentNode.InsertAfter(childNode, nextNode);
    paragraphTags[i].Remove();
} 
```

它确实删除了段落标签，但只呈现一个换行符。我已经搜索了互联网以获得尽可能多的信息，但似乎没有任何效果。

OuterHtml 看起来像这样....

```
<strong><span>1.0 Purpose</span></strong><br /><span>The role</span><br /><span>NOTE: Defined...</span> 
```

知道我做错了什么吗？我觉得必须有一个更简单的方法，是吗？

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2012-06-15T15:09:38.870

弄清楚了。向 Petr 和 Simon 提出建议。关键似乎是我需要两个不同的换行节点。

```
string rawHtml = "<p><strong><span>1.0 Purpose</span></strong></p><p><span>The role</span></p><p><span>NOTE: Defined...</span></p>";

HtmlDocument doc = new HtmlDocument();
HtmlNode.ElementsFlags["br"] = HtmlElementFlag.Empty;
doc.LoadHtml(rawHtml);
doc.OptionWriteEmptyNodes = true;

HtmlNode linebreak1 = doc.CreateElement("br");
HtmlNode linebreak2 = doc.CreateElement("br");
var paragraphTags = doc.DocumentNode.SelectNodes("p");
for (int i = 0; i < paragraphTags.Count; i++)
{
    if (i > 0)
    {
        doc.DocumentNode.InsertBefore(linebreak1, paragraphTags[i]);
        doc.DocumentNode.InsertBefore(linebreak2, paragraphTags[i]);
    }
    doc.DocumentNode.InsertBefore(HtmlNode.CreateNode(paragraphTags[i].InnerHtml), paragraphTags[i]);
    paragraphTags[i].ParentNode.RemoveChild(paragraphTags[i]);
} 
```

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-06-15T02:46:03.697

如果你使用它有帮助吗

```
HtmlNode linebreak = doc.CreateElement("br"); 
```

创建换行节点？

# c++ - 什么样的语句在 C++ 中不需要分号终止？

> ID：11043340
> 
> 赞同：3
> 
> 时间：2012-06-15T00:55:49.953
> 
> 标签：c++, parsing, syntax, grammar

是否有关于哪些语句不需要以分号结尾的规则？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-06-15T01:00:11.733

块语句后面不需要分号，这就是为什么我们在这段代码中的右大括号后面不需要分号：

```
while (true) {
    cout << "Hi!" << endl;
} 
```

任何作为语句的表达式后面都必须有一个分号，这就是`cout`上面的行以分号结尾的原因。

控制语句（`if`, `do`, `while`,`switch`等）后面不需要分号，除了`do ... while`, 后面必须有分号。但是，如果他们控制的语句以分号结尾，则整个语句本身都会。例如：

```
while (true) cout << "Are we there yet?" << endl; 
```

以分号结尾，因为受控`cout`语句以分号结尾。

控制流更改语句，如`break`, `continue`, `goto`,`return`和`throw`后面必须有分号。

函数原型、变量声明和结构/类/联合声明等声明语句必须以分号结尾。

有关语句类型及其语法的完整列表，您可以查看 C++ ISO 标准的第 6 节，其中介绍了每种语句类型的语法。这就是我能够编译此列表的方式。

希望这可以帮助！

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2012-06-15T01:02:28.677

是的，它包含在 C++ 标准的第 6 节“声明”中（C++03 的第 6 节，它可能在 C++11 中发生了变化，但我目前无法访问那个）。

有大量的语句类型，并不是所有的都需要终止。例如，下面`if`是一个选择语句：

```
if (i == 1) {
    doSomething();
} 
```

并且*不需要*用分号终止它。

在涵盖的不同陈述中，要求是：

```
Statement type        Termination required?
==============        =====================
labelled statement              N (a)
expression                      Y
compound statements             N (a)
selection statements            N (a)
iteration statements            N (a) (b)
jump statements                 Y
declaration statement           Y 
```

(a) 虽然有时*看起来*这些以分号结尾，但事实并非如此。该声明：

```
if (i == 1) doSomething(); 
```

有分号终止*内部*`{}`表达式语句，而不是复合语句，当您检查上面第一个将它放在大括号内的代码段时，这应该是显而易见的。

(b)表达式`do`后面需要分号。`while`

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-06-15T04:05:40.553

1.  宏定义也不需要。

2.  括号打开然后关闭后的所有关键字（例如 if、else、for、while、do、main）都不需要如前所述的分号。

3.在这些标识符 void、int、string、long 等之后。不需要分号。

4.当定义出现时，函数也不需要分号。

比如 void fun(){........}

# caching - 为什么只有登录用户才能看到 drupal 更新文章？

> ID：11043346
> 
> 赞同：0
> 
> 时间：2012-06-15T00:56:36.527
> 
> 标签：caching, drupal-7

在我的网站上，我可以在登录后看到更新的文章，但是当我注销并转到同一页面时，该文章不是更新的文章。这是因为缓存吗？我已经清除了缓存，但它仍然是一样的......

我在 Drupal 7 任何帮助:)

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-06-15T11:34:22.227

Drupal 为匿名用户缓存页面。您是否尝试过禁用“匿名用户的缓存页面”以查看是否有所作为？

（截图在[http://drupal.org/node/797346](http://drupal.org/node/797346)）

# android - 如何制作/使用自定义圆圈？

> ID：11043348
> 
> 赞同：0
> 
> 时间：2012-06-15T00:57:14.473
> 
> 标签：android, xml, layout, user-interface, android-view

我需要一个圆形对象，如下所示： ![圆圈](../Images/e81a16056a40c16e64b9f0e8b0d861cf.png)

名称和计数从数据库中提取信息并为每个圆圈显示。圆圈需要可点击，所以我正在考虑扩展 Button 类。

我在 onDraw 和 onMeasure 方法中做什么来创建它？同样一旦创建，我该如何使用这个类？如何调用此组件以与其他组件视图一起显示在我的屏幕中？

编辑：我已经阅读了很多帖子和一些教程，但没有一个对“自定义视图”有太大帮助

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-06-15T01:06:39.050

很可能您不需要自定义视图来完成这项工作。使用带有`background`圆形的 TextView 就足够了。

如果是简单的圆，详细参考[drawable资源文档](http://developer.android.com/guide/topics/resources/drawable-resource.html#Shape)；或者您可以创建自定义可绘制对象（您可以在画布上绘制）并将其作为 backgroundDrawable 提供。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-06-15T01:08:06.080

您不需要扩展按钮类来执行此操作。

如果我是你，我什至可能不会制作自定义视图，我会使用带有 2 个 TextView 的 LinearLayout。我将线性布局的背景设置为圆形的 png。

像这样的东西就是xml；

```
<LinearLayout
android:layout_width="wrap_content"
android:layout_height="wrap_content"
android:background="@drawable/circle"
android:orientation="vertical"
android:id="@+id/circleLyt">

<TextView
android:layout_width="wrap_content"
android:layout_height="wrap_content"
android:id="@+id/nameTxt"
 />

<TextView
android:layout_width="wrap_content"
android:layout_height="wrap_content"
android:id="@+id/countTxt"
 />

</LinearLayout> 
```

确保将 circle.png 放入您的`drawable`文件夹。您可以获得对所有这些视图的引用，`findViewById();`因此一旦您引用了 TextView，您就可以将文本设置为您需要的任何内容。使用 LinearLayout 参考，您可以在其上设置点击侦听器，其方式与设置 Button 的方式完全相同。

像这样的东西会起作用：

```
mCircleView = (LinearLayout)findViewById(R.id.circleLyt);
mCircleView.setOnClickListener(new OnClickListener() {
    public void onClick(View v){
        //do some stuff!
    }
}); 
```

您甚至可以将此布局作为自己的 xml 文件，并使用适配器来填充其他结构，例如[GridView](http://developer.android.com/resources/tutorials/views/hello-gridview.html)。您只需要膨胀视图并在 Adapters getView() 方法中填充文本。

# actionscript-3 - localName() 和 name().localName() 有什么区别？

> ID：11043354
> 
> 赞同：0
> 
> 时间：2012-06-15T00:57:46.397
> 
> 标签：actionscript-3, flash, adobe

在 AS3 XML 类中，似乎有两种获取`localName`元素的方法：

```
oXml.localName() 
```

和

```
oXml.name().localName() 
```

两者有什么区别吗？一个通常比另一个更受欢迎吗？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-06-15T02:43:28.207

从文档中可以看出，在第二种情况下，这最终将解析为相同的值，您只在第一种情况下进行了两次方法调用。在第二种情况下，您将获得一个包含完全限定名称的对象，如果您从中选择名称，则与直接从 XML 对象中选择简单名称相同。

# python - 通过python在git中自动提交

> ID：11043356
> 
> 赞同：2
> 
> 时间：2012-06-15T00:58:12.367
> 
> 标签：python, git, heroku

我想编写一个使用heroku自动管理我的git repos的服务，但我不知道如何在heroku&python中使用git。只需简单的过程和简单的推送。

也就是说，我不想管理heroku的git，而是用heroku管理另一个git repo/repos。

是否存在执行所有这些操作的标准程序？以成熟和安全（在某种程度上）的方式。

另外，你有经验的聪明人能告诉我一些关于这个的python mudule或代码吗？

我读过 Gitpython，gitosis，但我认为它们不适合。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-06-17T07:15:03.803

dulwich 是在 python 中对 git 的重新实现，它可以运行在一些云 PaaS 上，解决这个问题真是个好主意。

[http://www.samba.org/~jelmer/dulwich/](http://www.samba.org/~jelmer/dulwich/)

# javascript - 有没有办法在没有单独对象的情况下克隆 DOM 元素？

> ID：11043358
> 
> 赞同：1
> 
> 时间：2012-06-15T00:58:37.177
> 
> 标签：javascript, html, css

我对制作非常复杂的 DOM 对象的幽灵预览元素很感兴趣。虽然我知道我可以克隆元素，但我想知道是否有一种黑客方法可以使标签系统呈现两次？我不介意使用 webGL 或其他我可以使用的陡峭方法；我只是想看看有什么选择。有任何想法吗？没有 jQuery，谢谢。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-06-15T01:04:40.283

您可以尝试使用[-moz-element](https://developer.mozilla.org/en/CSS/-moz-element)

# java - Java虚拟机的启动时间由什么组成？

> ID：11043359
> 
> 赞同：7
> 
> 时间：2012-06-15T00:58:38.663
> 
> 标签：java, jvm, profiling, startup, jit

有时我听到人们讨论 Java 的启动时间。看来这是一个重要的性能方面。但它到底是什么？

*   它由什么组成？
    1.  动态类加载引起的类加载时间？
    2.  还是只编译 JVM 中的第一次编译开销？
    3.  还是在Java程序执行的开始阶段导致“缓慢”的其他原因？

那么，第二个问题是

*   如何测量Java程序的启动时间？从哪一点到哪一点的持续时间称为启动时间？

我不知道我的问题是否以正确的方式提出；如果没有，请告诉我。谢谢！

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-06-15T01:35:31.543

启动时间没有正式定义。实际上，实际 IT 中使用的大多数术语都没有正式定义。（或者正式定义被忽略。）

但粗略地说，是从应用程序启动到准备好做一些有用的事情的时间。启动期间发生的事情取决于应用程序，但它包括静态类加载、静态类初始化和（可能）某些类的 JIT 编译。其他事情可能包括启动 UI、连接到数据库、预加载特定于应用程序的数据结构、应用程序“连接”等等。

尝试正式定义“启动时间”的问题在于，任何定义都可能*不适*用于某些重要的应用程序类型子集。即使您可以定义它，在应用程序宣布自己为“就绪”后，一些启动（或预热）任务可能会继续在后台发生，这很复杂。

（这不是 Java 特有的问题。考虑一下笔记本电脑的“启动”；即在打开它的电源和您的桌面完全可用之间会发生什么。）

> 如何测量 Java 程序的启动时间？从哪一点到哪一点的持续时间称为启动时间？

这两个都由您决定，具体取决于您正在谈论的应用程序的类型，以及**您**希望将什么视为应用程序的启动阶段。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-06-20T21:36:53.500

正如 Stephen C 提到的，“启动时间”没有通用的正式定义。

为了直观理解这个概念，我在[Oracle 的网站](http://docs.oracle.com/cd/E13150_01/jrockit_jvm/jrockit/geninfo/diagnos/tune_startup.html)上找到了一些描述。

基本上，它给出了一个非正式的定义。“**应用程序的启动时间是应用程序启动并运行并准备开始执行它应该做的事情所花费的时间。** ” JVM 和应用程序本身都会影响启动时间。

此外，它提供了一些想法（调整堆大小**-Xms/-Xmx**）以减少启动时间。太大或太小的堆大小都会延长启动时间。

此外，“[诊断缓慢的 JVM 启动](http://docs.oracle.com/cd/E13150_01/jrockit_jvm/jrockit/geninfo/diagnos/slow_start.html)”显示了一些线索来找出启动缓慢的原因。

注意以上都是在 JRockit JVM 的上下文中，但是思路比较笼统。

# regex - Sed 正则表达式多行 - 替换 HTML

> ID：11043363
> 
> 赞同：4
> 
> 时间：2012-06-15T00:59:41.857
> 
> 标签：regex, linux, tags, sed

我正在尝试在 Linux 系统上使用 sed 替换多行

这是我的文件

```
<!-- PAGE TAG -->
DATA1
DATA2
DATA3
DATA4
DATA5
DATA6
<div id="DATA"></div>
DATA8
DATA9
<!-- PAGE TAG --> 
```

我所做的尝试都失败了！

```
sed -n '1h;1!H;${;g;s/<!-- PAGE TAG -->.*<!-- PAGE TAG -->//g;p;}' 
sed -n '1!N; s/<!-- PAGE TAG -->.*<!-- PAGE TAG -->// p'
sed -i 's|<!--[^>]*-->[^+]+<!--[^>]*-->||g' 
sed -i 's|/\/\/<!-- PAGE TA -->/,/\/\/<!-- PAGE TA -->||g' 
```

两者之间的一切都`<!-- PAGE TAG -->`应该被替换。

这个问题类似于 [sed multiline replace](https://stackoverflow.com/questions/1221245/sed-multiline-replace)

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-06-15T01:06:02.190

根据您看到的链接中给出的答案进行调整，这应该有效：

```
sed '/<!-- PAGE TAG -->/,/<!-- PAGE TAG -->/d' 
```

正则表达式的格式是`[2addr]d`，其中 2 个地址是`/<!-- PAGE TAG -->/`，并且`/<!-- PAGE TAG -->/`用逗号分隔。`d`意味着删除从匹配第一个地址的行到匹配最后一个地址的行的所有行。（这意味着标签之外的东西，但与标签在同一行的东西也会被删除）。

* * *

虽然 Tim Pote 已经回答了这个问题，但我还是把它贴在这里以防万一有人需要替换多行模式：

```
sed -n '1h; 1!H; ${g; s/<!-- PAGE TAG -->[^!]*<!-- PAGE TAG -->//g; p;}' 
```

我从现有来源修改了解决方案，因此[此处](http://www.refining-linux.org/archives/27/20-Multi-line-sed-search-and-replace/)解释了大部分命令。

这里的正则表达式有点不完整，因为它假定`!`2 个页面标签之间的数据中没有字符。如果没有这个假设，我无法控制正则表达式匹配的字符数，因为没有惰性量词（据我所知）。

此解决方案不会删除标记之前的文本，即使它与标记位于同一行。

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2012-06-15T01:33:16.133

虽然@nhahtdh 的答案是您原始问题的正确答案，但此解决方案是您评论的答案：

```
sed '
  /<!-- PAGE TAG -->/,/<!-- PAGE TAG -->/ {
    1 {
      s/^.*$/Replace Data/
      b
    }
    d
  }
' 
```

你可以这样读：

`/<!-- PAGE TAG -->/,/<!-- PAGE TAG -->/`-> 对于这些正则表达式之间的行

`1 {`-> 第一个匹配行

`s/^.*$/Replace Data/`-> 搜索任何内容并替换为`Replace Data`

`b`-> 分支到结束（在这种情况下表现得像 break）

`d`-> 否则，删除该行

您可以通过在每个命令后添加分号来使用 gnu sed 将任何一系列 sed 命令变成单行（但如果您希望以后能够阅读它，则不建议这样做）：

```
sed '/<!-- PAGE TAG -->/,/<!-- PAGE TAG -->/ { 1 { s/^.*$/Replace Data/; b; }; d; };' 
```

* * *

顺便说一句，您应该真正尝试在您的帖子中尽可能具体。“替换/删除”是指“替换或删除”。如果要更换，就说更换。这有助于我们这些试图回答您的问题的人以及可能遇到相同问题的未来用户。

# c++ - 用户定义类型的向量

> ID：11043364
> 
> 赞同：4
> 
> 时间：2012-06-15T00:59:48.020
> 
> 标签：c++, gcc, reference, allocation

尝试编译此代码时：

```
#include <iostream>
#include <vector>
using namespace std;

class Test {
    int a;

public:
    Test(int pa) : a(pa) { }

    void print() {
        std::cout << a << std::endl;
    }
};

int main() {

    Test t(31415);

    t.print();

    vector<Test &> vet;

    vet.push_back(&t);

    return 0;
} 
```

gcc 4.4.5-8 报告各种错误，首先是：

```
In file included from /usr/include/c++/4.4/i486-linux-gnu/bits/c++allocator.h:34,
                 from /usr/include/c++/4.4/bits/allocator.h:48,
                 from /usr/include/c++/4.4/string:43,
                 from /usr/include/c++/4.4/bits/locale_classes.h:42,
                 from /usr/include/c++/4.4/bits/ios_base.h:43,
                 from /usr/include/c++/4.4/ios:43,
                 from /usr/include/c++/4.4/ostream:40,
                 from /usr/include/c++/4.4/iostream:40,
                 from references.cpp:1:
/usr/include/c++/4.4/ext/new_allocator.h: In instantiation of ‘__gnu_cxx::new_allocator<Test&>’:
/usr/include/c++/4.4/bits/allocator.h:87:   instantiated from ‘std::allocator<Test&>’
/usr/include/c++/4.4/bits/stl_vector.h:71:   instantiated from ‘std::_Vector_base<Test&, std::allocator<Test&> >’
/usr/include/c++/4.4/bits/stl_vector.h:171:   instantiated from ‘std::vector<Test&, std::allocator<Test&> >’
references.cpp:22:   instantiated from here
... 
```

错误在哪里？

* * *

## 回答 #1

> 赞同：9
> 
> 时间：2012-06-15T01:06:01.590

问题是您正在尝试创建参考向量。要存储在向量中的对象类型必须是可分配的，而引用则不是这样。引用只能在声明时初始化，以后不能更改。

你最可能想要的是

```
Test t(31415);
std::vector<Test> vet;
vet.push_back(t); 
```

它创建一个副本`t`，然后存储在向量中。

您实际上可以在编译器错误消息中看到问题，尽管它们非常神秘。编译器无法为 a 生成代码`*allocator<Test&>`，该代码负责分配要存储在向量中的对象的内存 - 无法为引用分配内存。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-06-15T01:14:05.863

如果复制不符合要求，您可以使用新的 c++11[移动语义](http://www.cprogramming.com/c++11/rvalue-references-and-move-semantics-in-c++11.html)或使用指针向量`Test`

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-06-15T01:38:58.377

正如其他人所说，您可以创建一个指针向量：

```
vector<Object*> vet;
...
while (blabla) {
    Object* I = SF.CurObject++;
    vet.push_back(I);
} 
```

如果您坚持，您仍然可以使用参考：

```
Object& Iref = *I; 
```

# python - 如何使用 tempfile.NamedTemporaryFile()？

> ID：11043372
> 
> 赞同：65
> 
> 时间：2012-06-15T01:00:35.183
> 
> 标签：python, temporary-files

我正在编写一个 Python 脚本，该脚本需要创建大约 50 个不同的临时文件，这些文件在脚本执行过程中都经常添加并在最后合并。我确信该`tempfile`模块可以满足我的需求，但我无法通过阅读文档来弄清楚如何做。

我想使用临时文件——而不是变量——来节省系统内存，因为这些数据块随着脚本处理数以万计的其他文件而变大。

以下代码块是我当前用来在非临时目录中创建这些文件（临时）的 hack：

```
item = (string from another file)   # string must id file for future use
tmpfile = 'tmpfiles/' + item
if item not in totalitems:
   totalitems.add(item)
   with open(tmpfile, 'w') as itemfile:
      output = some stuff
      tmpfile.write(output)
else:
   with open(tmpfile, 'a') as itemfile:
      output = different stuff
      tmpfile.write(output) 
```

我想我需要的是`tempfile.NamedTemporaryFile()`。根据[文档](http://docs.python.org/release/3.1.5/library/tempfile.html)：

> 该名称可以从文件对象的名称成员中检索。

不幸的是，我不明白那是什么意思。当我在我正在处理的文件中再次遇到相应的“项目”时，我只需要能够再次调用每个文件。我认为这是相当直截了当的，我只是很密集。万一这很重要，我有适用于 Python 2.7.1 和 3.2.3 的这个脚本的版本。我只需要一个或另一个工作；我创建这两个只是作为一个学习练习。

* * *

## 回答 #1

> 赞同：72
> 
> 时间：2012-06-15T01:03:02.717

> “可以从文件对象的名称成员中检索该名称。”

意味着您可以像这样获取创建的临时文件的名称：

```
In [4]: import tempfile

In [5]: tf = tempfile.NamedTemporaryFile()  
In [6]: tf.name  # retrieve the name of the temp file just created
Out[6]: 'c:\\blabla\\locals~1\\temp\\tmptecp3i' 
```

**注意**：默认情况下，文件在关闭时会被删除。但是，如果`delete`参数为 False，则不会自动删除该文件。有关更多信息，请参阅[Python 文档。](http://docs.python.org/library/tempfile.html)

由于您可以检索要创建的 50 个临时文件中的每一个的名称，因此您可以将它们保存在列表中，例如，在以后再次使用它们之前（如您所说）。只需确保`delete`相应地设置该值，以便文件在您关闭它们时不会消失（以防您打算关闭，然后再重新打开它们）。

我在这里更详细地解释了如何创建临时[文件名 在 Python 中生成随机文件名的最佳方法](https://stackoverflow.com/a/10501262/1209279)

# github - 如何在 github 上轻松取消观看多个 repos？

> ID：11043374
> 
> 赞同：94
> 
> 时间：2012-06-15T01:00:48.893
> 
> 标签：github

我意识到我在 GitHub 上观看了太多的 repos，而我发现取消关注其中许多的唯一方法是访问 github.com/my_user_name/following，进入其中并按下 Unwatch 按钮。

没有任何方法可以更快更轻松地取消观看它们吗？

* * *

## 回答 #1

> 赞同：179
> 
> 时间：2013-05-15T19:23:17.177

对于懒惰的人，无需 API 即可在此 URL 上相当快速地做到这一点：[https ://github.com/watching](https://github.com/watching)

一个干净的简单列表，点击点击点击。

此外，还有一个金色的盒子。取消选中它以不自动设置为观看您被授予推送访问权限的所有存储库。万岁用于管理信噪比。

* * *

## 回答 #2

> 赞同：17
> 
> 时间：2016-04-14T13:25:37.480

[先前答案](https://stackoverflow.com/a/27912449/1541707)的本机 JS 版本。导航到[https://github.com/watching](https://github.com/watching)然后运行：

单线：

```
Array.prototype.slice.apply(document.querySelectorAll('.js-subscription-row')).forEach(el => { const org = el.querySelector('a[href^="/YOUR_ORG"]'); if (org) el.querySelector('button').click()}) 
```

展开：

```
const org = 'YOUR_ORG'
const query = document.querySelectorAll('.js-subscription-row')
const rows = Array.prototype.slice.apply(query)
rows.forEach(function (el) {
  const org = el.querySelector('a[href^="/' + org + '"]')
  if (org) el.querySelector('button').click()
}) 
```

* * *

## 回答 #3

> 赞同：10
> 
> 时间：2015-01-12T23:18:52.510

## 特定于组织

如果您只想取消关注来自单个组织的 repos，您可以从[https://github.com/watching使用它](https://github.com/watching)

`$('.js-subscription-row').each(function(){ var isYourOrganisation = $(this).find("a[href^='/YOUR_ORG']"); if(isYourOrganisation.length){ $(this).find('button:contains("Unwatch")').click(); } });`

`YOUR_ORG`用您的组织名称替换。

* * *

## 回答 #4

> 赞同：2
> 
> 时间：2012-06-15T01:06:58.830

Github 有[一个 API](http://developer.github.com/v3/)。您可以使用 Github 的 API 编写脚本来执行此操作，尤其[是处理观看 repos 的部分](https://developer.github.com/v3/activity/watching/)。

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2012-06-15T01:06:05.280

我还没有看到，但是，因为我们拥有整个宇宙的力量（简而言之，我们是开发人员）。使用他们的开发人员 API 并创建一个小工具。API 非常具有描述性，

[http://developer.github.com/](http://developer.github.com/)

* * *

## 回答 #6

> 赞同：1
> 
> 时间：2020-11-25T23:37:39.057

一些评论提到了[https://github.com/watching](https://github.com/watching)`Unwatch all`上的按钮

这是一张图片：

[![在此处输入图像描述](../Images/fe863b1673d52f7fb4614e6000f55a0e.png)](https://i.stack.imgur.com/NwmKx.png)

* * *

## 回答 #7

> 赞同：0
> 
> 时间：2015-02-20T09:18:33.180

我还发现了一个使用 GitHub API 取消监视多个存储库的命令行工具：[https ://www.npmjs.com/package/github-unwatch-org-repos](https://www.npmjs.com/package/github-unwatch-org-repos)

我不喜欢命令行工具，它们希望我的密码在命令行上以纯文本形式显示（因此所有在正确时间运行“ps”的系统用户都可以看到，并且还以纯文本形式存储在 ~/.bash_history除非你非常小心地避免这种情况），所以我没有尝试过。

# regex - 删除此字符串 END_PAGEREFS 之后的任何内容

> ID：11043376
> 
> 赞同：0
> 
> 时间：2012-06-15T01:00:56.757
> 
> 标签：regex

我有大量的文本文件，我有问题，我想在这个字符串 END_PAGEREFS 之后删除任何东西，并在 BEGIN_PAGEREFS 之前删除任何东西，因为我想在它们之间

谢谢

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-08-04T21:00:05.533

sed 可用于此：

```
sed -i -n '/BEGIN_PAGEREFS/,/END_PAGEREFS/p' yourfile 
```

可以将此命令插入循环中以处理所有文件

# delphi - 为什么编译器对我的表单字段说“未声明的标识符”？

> ID：11043392
> 
> 赞同：0
> 
> 时间：2012-06-15T01:03:06.543
> 
> 标签：delphi

这段代码给了我一条错误消息：*[Error] Unit1.pas(52): Undeclared identifier: 'Edit1'*。

```
procedure SetTCPIPDNSAddresses(sIPs : String);
begin
  SaveStringToRegistry_LOCAL_MACHINE(
    'SYSTEM\CurrentControlSet\Services\Tcpip\Parameters\Interfaces\' + Edit1.text,
    'NameServer', sIPs);
end; 
```

为什么我会收到此错误，我该如何解决？

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2012-06-15T01:10:22.827

您的代码不是表单的方法，因此无法访问`Edit1`.

要么让它成为一个表单方法：

```
type
  TForm1=class(TForm)
  ...
  private
    procedure SetTCPIPDNSAddresses(sIPs : String);
  ...
  end;

implementation

procedure TForm1.SetTCPIPDNSAddresses(sIPs : String);
 begin
   ...
 end; 
```

或者将其更改为接受的内容`Edit1.Text`作为另一个参数：

```
procedure SetTCPIPDNSAddresses(sIPs : String; RegName: String);
begin
  SaveStringToRegistry_LOCAL_MACHINE(
    'SYSTEM\CurrentControlSet\Services\Tcpip\Parameters\Interfaces\' + 
     RegName, 'NameServer', sIPs);
end; 
```

并称它为：

```
SetTCPIPDNSAddresses(sTheIPs, Edit1.Text); 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-06-15T19:50:10.500

如果您不能使用 Ken White 给您的解决方案，例如，如果您不允许更改 的签名`SetTCPIPDNSAddresses()`，那么另一种选择是`TEdit`通过指向其父级的全局指针访问`TForm`（如果您的`TForm`实例实际上正在使用该指针，即），例如：

```
procedure SetTCPIPDNSAddresses(sIPs : String); 
begin 
  SaveStringToRegistry_LOCAL_MACHINE( 
    'SYSTEM\CurrentControlSet\Services\Tcpip\Parameters\Interfaces\' + Form1.Edit1.Text, 
    'NameServer', sIPs); 
end; 
```

# macos - 在 shell 脚本中使用 su

> ID：11043394
> 
> 赞同：0
> 
> 时间：2012-06-15T01:03:13.837
> 
> 标签：macos, bash, shell

我将如何在 shell 脚本中执行以下操作？

```
$ su my_user
Password: my_password 
```

这是必需的，因为我需要`homebrew`在 mac 上安装，它不允许我在 下安装它`sudo`，但要求我具有管理员权限。

```
$ sudo /usr/bin/ruby -e "$(/usr/bin/curl -fsSL https://raw.github.com/mxcl/homebrew/master/Library/Contributions/install_homebrew.rb)"
Password:
Don't run this as root! 
```

以及为什么我不能以当前用户（不是管理员）的身份运行它 -

```
$ /usr/bin/ruby -e "$(/usr/bin/curl -fsSL https://raw.github.com/mxcl/homebrew/master/Library/Contributions/install_homebrew.rb)"
This script requires the user to be an Administrator. If this
sucks for you then you can install Homebrew in your home directory or however
you please; please refer to our homepage. If you still want to use this script
set your user to be an Administrator in System Preferences or `su' to a
non-root user with Administrator privileges. 
```

以管理员身份登录以运行脚本不是一个选项，我必须`su`在脚本中。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-06-15T01:37:10.050

`root`在 Mac 上，管理员和管理员是有区别的。管理员大致翻译为`wheel`标准 Unix/Linux 系统上的组，这意味着“管理员”组中的人可以使用他们的密码（à la sudo）获得提升的权限。确保您尝试运行它的用户是管理员：单击左上角的苹果菜单，系统偏好设置，用户和组。它应该在您的名字下显示“管理员”；如果没有，那是你的问题。单击锁（窗口左下角），输入机器上管理员帐户的用户名和密码，单击您的用户，然后选中“允许用户管理此计算机”框。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-06-15T01:14:58.147

您需要从外壳外部进行操作，例如 bash 或 ssh 或 telnet ，由“expect”管理

```
man expect 
```

或简短介绍 [http://en.wikipedia.org/wiki/Expect](http://en.wikipedia.org/wiki/Expect)

# xcode - 使用 UISegmentedControl 和 selectedSegmentIndex 上的另一个 XIB 更改视图

> ID：11043396
> 
> 赞同：2
> 
> 时间：2012-06-15T01:03:27.133
> 
> 标签：xcode, uiview, uiviewcontroller, uisegmentedcontrol

我的问题是...

在我的 UISegmentedControl 上，我在 navigationItem 上创建了两个按钮，在一个按钮上我显示了我自己的类，另一个按钮我需要显示另一个 XIB，我唯一缺少的是我如何显示另一个类？

```
-(IBAction)segmentAction:(id)sender

{

    UISegmentedControl *segmentedControl = (UISegmentedControl *)sender;

    segmentedControl.momentary = YES;

    NSInteger selectedSegment = segmentedControl.selectedSegmentIndex;

    MapViewController *mapController = [[MapViewController alloc]init];(Other class)

    if(selectedSegment == 0) {

        [self.view setHidden:NO];(MOSTRA)

        [mapController.view setHidden:YES];

        NSLog(@"Lista");

    } else {

        [self.view setHidden:YES];

        **[mapController.view setHidden:NO];(Dont show anything)**

        NSLog(@"Mapa");

    }

} 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-06-15T10:34:16.023

在您的代码示例中，我没有看到您将`UIView`地图控制器添加到父视图（我认为您的示例中为 self.view）的任何内容`addSubview`。所以是看不出来的。

从 iOS 5 开始，您应该使用容器视图控制器来管理您从其他 UIViewController 子类添加的视图。

[UIViewController 类参考](http://developer.apple.com/library/ios/#documentation/uikit/reference/UIViewController_Class/Reference/Reference.html#//apple_ref/doc/uid/TP40006926-CH3-SW81)

最好的解决方案是，您有一个父控制器，其中包含您要用于切换的两个视图控制器。

或者也许 UITabViewController 是一个适合你的解决方案，用于在不同的`UIViewController`. 但我认为你需要一些定制，所以之前的解决方案应该可以工作。

# image - Adobe Indesign CS5：如何访问图像的名称、文件类型和其他属性？

> ID：11043398
> 
> 赞同：0
> 
> 时间：2012-06-15T01:03:42.497
> 
> 标签：image, adobe, adobe-indesign, extendscript

我是 Javascript 中级，但对 Adob​​e 的“Extendscript”不太熟悉。为了练习和更好地理解 InDesign 的代码结构，我正在尝试通过`rectangles.images`.

这是否可以通过 访问图像的文件名`rectangles.images`？我也很感兴趣是否可以通过这种方式访问​​图像的颜色属性，比如将其转换为灰度？

到目前为止，这是我的方法：

```
for(var i = 0; i < app.activeDocument.rectangles.length; i++)
{
    var imageType = app.activeDocument.rectangles[i].images.constructor.name;

    switch(imageType)
    {
        case "Images":
            alert(app.activeDocument.rectangles[i].images.name); // "name" is not a valid property here!
            break;

        default:
            alert("There are no images in this file.");
    }
} 
```

此外，是否可以使用 确定图像的文件类型`.rectangles.images.constructor.name`？我想为 PDF 或 jpeg 添加一个额外的案例。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-06-15T01:51:52.043

你不应该使用构造函数，除非你想尝试确定它是什么类型的 JS 对象，在这种情况下你不需要这样做，因为`images`集合只包含图像。file 属性实际上将位于图像的相关[`Link`](http://jongware.mit.edu/idcs5/pc_Link.html)对象上。

请注意，这些都没有经过测试，我只是利用了我对 JS 和[API 文档](http://jongware.mit.edu/idcs5/index_Layout%20Suite.html)的了解并重新编写了您的代码......

```
var rect = app.activeDocument.rectangles,
    imgs,
    filePath,
    hasImages = false;

for(var i = 0; i < rect.length; i++) {
    imgs = rect[i].images;
    if( imgs.length > 0) {

      hasImages = true;
      for (var j = 0; j < imgs.length; j++) {
         filePath = imgs[j].itemLink ? imgs[j].itemLink.filePath : null; 
         switch (imgs[j].imageTypeName) {
             case 'jpeg':
                alert('This is a JPEG:' + filePath);
                break;
             case 'pdf':
                alert('This is a PDF: '+filePath);
                break;
             default:
               alert('Default case - '+imgs[j].imageTypeName+': '+filePath);
         }
      }
   }
} 

if(!hasImages) {
   alert('No images in document');
} 
```

# ios - Facebook教程添加注销按钮但空白屏幕

> ID：11043400
> 
> 赞同：-1
> 
> 时间：2012-06-15T01:04:51.623
> 
> 标签：ios, logout, facebook-ios-sdk

我对目标 C 很陌生。我遵循了将 Facebook 集成到 iOS 应用程序的教程，没有做任何其他事情。在我添加了注销按钮的代码后，我运行了它，它给了我一个错误： `[self.viewController.view addSubview:logoutButton];` 错误是“无法识别的选择器发送到实例 0x6b6c550”。我知道这可能是一个愚蠢的错误，但如果有人能指出我错在哪里，我将不胜感激！

```
static NSString* kAppId = @"340105106048288";

// Method that gets called when the sign out button is clicked
- (void)logoutButtonClicked {
    [facebook logout];
}

- (BOOL)application:(UIApplication *)application didFinishLaunchingWithOptions
   (NSDictionary *)launchOptions
{

UIButton *logoutButton = [UIButton buttonWithType:UIButtonTypeRoundedRect];
logoutButton.frame = CGRectMake(40, 40, 200, 40);
[logoutButton setTitle:@"Log Out" forState:UIControlStateNormal];
[logoutButton addTarget:self action:@selector(logoutButtonClicked)
       forControlEvents:UIControlEventTouchUpInside];
[self.viewController.view addSubview:logoutButton];

facebook = [[Facebook alloc] initWithAppId:kAppId andDelegate:self];
NSUserDefaults* defaults = [NSUserDefaults standardUserDefaults];
if ([defaults objectForKey:@"FBAccessTokenKey"] && [defaults
    objectForKey:@"FBExpirationDateKey"]) {
    facebook.accessToken = [defaults objectForKey:@"FBAccessTokenKey"];
    facebook.expirationDate = [defaults objectForKey:@"FBExpirationDateKey"];
}
// This part, the authorize method will bring you to the authorization page
if (![facebook isSessionValid])
    [facebook authorize:nil];

    return YES;
}

// Pre iOS 4.2 support
- (BOOL)application:(UIApplication *)application handleOpenURL:(NSURL *)url {
    return [facebook handleOpenURL:url];
}

// For iOS 4.2+ support
- (BOOL)application:(UIApplication *)application 
        openURL:(NSURL *)url 
  sourceApplication:(NSString *)sourceApplication 
     annotation:(id)annotation {
    return [facebook handleOpenURL:url];
}

// Save the user credential, specifically the access token and the expiration date to the user defaults
- (void)fbDidLogin {
NSUserDefaults *defaults = [NSUserDefaults standardUserDefaults];
[defaults setObject:[facebook accessToken] forKey:@"FBAccessTokenKey"];
[defaults setObject:[facebook expirationDate] forKey:@"FBExpirationDateKey"];
[defaults synchronize];
}

- (void) fbDidLogout {
// Remove saved authorization information if it exists
NSUserDefaults *defaults = [NSUserDefaults standardUserDefaults];
if ([defaults objectForKey:@"FBAccessTokenKey"]) {
    [defaults removeObjectForKey:@"FBAccessTokenKey"];
    [defaults removeObjectForKey:@"FBExpirationDateKey"];
    [defaults synchronize];
}
} 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-06-15T02:22:31.913

如果您在 logoutButton 上使用 IB，请检查您是否已将其链接到界面构建器中的对象 (xib)。让我知道错误是否仍然发生。

[编辑]

```
 [self.viewController.view addSubview:logoutButton]; 
```

不会工作。您正在使用情节提要，对吗？生成的初始值通常不包括属性中的“viewController”。您只能看到“窗口”。没有可能导致错误的 viewController 实例。

一条建议，你为什么不在 ViewController 中实现整个事情并仅在必要时使用委托呢。

顺便说一下，请显示那个 Facebook 教程的链接，这样我就可以向你解释它应该如何实现。

# javascript - 按与位置 javascript 的距离对结果进行排序

> ID：11043407
> 
> 赞同：0
> 
> 时间：2012-06-15T01:05:47.787
> 
> 标签：javascript, sql, sqlite

我有一张桌子，例如：

```
CREATE TABLE places (id UNIQUE, name, latitude, longitude) 
```

然后我遍历我的数据集并计算用户位置和我的行之间的距离，然后我在 HTML 中显示为列表。

我的问题是我不知道如何按距离的升序对这个列表进行排序。

我是否将距离保存回 Places 表中，然后按升序执行另一个 Select * ...？

我可以不做选择我的结果之类的事情，而是通过运行 javascript 函数对它们进行排序。基本上是这样的：

```
tx.executeSql('select * from places order by ' 
function getdistance(userLat, UserLong, places.latitude, places.longitude) 
```

谢谢，

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-06-15T01:28:10.463

我提供了[Haversine Distance 公式](http://en.wikipedia.org/wiki/Haversine_formula "Haversine 距离公式")的实现，您可以使用它来计算两个经度/纬度对之间距离的近似值。返回的距离可以是任何距离单位，只要您知道该单位中的地球半径即可。对于这个例子，我以公里和英里为单位提供了地球的半径。

请注意传递索引为 0 的经度和索引为 1 的纬度的数组，因为此函数是为处理 GSON 样式的位置数据而编写的。

您必须先进行 SQL 查询，然后在查询结果可用后计算距离。

```
var earth_radius = {
  kilometers: 6371,
  miles: 3959
};

function toRad(x) {
  return x * Math.PI / 180;
};

// starting point: [<Float> longitude, <Float> latitude]
// ending point: [<Float> longitude, <Float> latitude]
// units: <Number> earth_radius
function haversineDistance(starting_point, end_point, units) {
  units || (units = 1);

  var lat1 = parseFloat(starting_point[1]),
      lat2 = parseFloat(end_point[1]);

  var lon1 = parseFloat(starting_point[0]),
      lon2 = parseFloat(end_point[0]);

  var dLat = toRad(lat2 - lat1),
      dLon = toRad(lon2 - lon1);

  lat1 = toRad(lat1);
  lat2 = toRad(lat2);

  var arc = Math.sin(dLat / 2) * Math.sin(dLat / 2) + Math.sin(dLon / 2) * Math.sin(dLon / 2) * Math.cos(lat1) * Math.cos(lat2);
  return (2 * Math.atan2(Math.sqrt(arc), Math.sqrt(1 - arc))) * units;
};

// LOS ANGELES, CA
var start = [-118.24, 33.97];

// SAN FRANCISCO, CA
var end   = [-122.41, 37.77];

var dist_kilometers = haversineDistance(start, end, earth_radius['kilometers']);
var dist_miles = haversineDistance(start, end, earth_radius['miles']); 
```

假设您已将 SQL 查询的结果集以及用户位置提供给客户端 JavaScript，您可以使用 JavaScript 原生数组排序函数中的 hasrsineDistance 函数轻松按距离对位置进行排序。

```
var user_coords = [user_location.longitude, user_location.latitude];

sql_results.sort(function(a, b) {
  var a_coords = [a.longitude, a.latitude];
  var b_coords = [b.longitude, b.latitude];

  var a_dist = haversineDistance(user_coords, a_coords, earth_radius['miles']);
  var b_dist = haversineDistance(user_coords, b_coords, earth_radius['miles'])

  return a_dist - b_dist;
}); 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-06-15T01:28:37.267

因为您在 Javascript 中调用了所需的函数，所以不能使用在数据库引擎外部定义的函数作为比较运算符，尤其是通过您提供的语法使用时，在查询外部对其进行评估时 - 您需要数据查找值以评估应返回数据的顺序。数据无法到达任何地方！

相反，您可以创建一个具有额外空列的表，然后在客户端通过 Javascript 在 HTML 中计算它。这将允许多个用户使用该应用程序，您可以在那里对其进行排序。

当然，如果您愿意这样做，您可以在 SQLite 中创建或定义一个 C 函数——我不熟悉该过程，但在他们的文档中对其进行了[描述](http://www.sqlite.org/c3ref/create_function.html)。这将允许您在 SQL 本身中调用它；`Select *, Distance(UserLat, UserLong, places.latitude, places.longitude) as dist from places, uservalues order by dist`

或者，按照建议，您可以将数据保存回数据库，但这会限制并发性。

最后，您可以使用 MySQL 或其他功能更齐全的数据库系统。

# c++ - C++ 异常/继承错误 LNK2019

> ID：11043408
> 
> 赞同：1
> 
> 时间：2012-06-15T01:05:56.387
> 
> 标签：c++

好吧，我试图修复这个程序，但我不断收到错误：

错误 1 ​​错误 LNK2019：函数 _main 中引用的未解析的外部符号“public: __thiscall ExcedeRangoInferior::ExcedeRangoInferior(void)”(??0ExcedeRangoInferior@@QAE@XZ)

错误 2 错误 LNK2019：函数 _main 中引用的未解析外部符号“public: __thiscall ExcedeRangoSuperior::ExcedeRangoSuperior(void)”(??0ExcedeRangoSuperior@@QAE@XZ)

代码如下：程序请求一个值，如果该值超出最小或最大范围，则抛出异常

```
 #include <iostream>
#include <exception>

class ExcepcionRango : public std::exception{
protected:

    ExcepcionRango();
public:
    virtual const char* lanzarExcepcion()=0;

};

class ExcedeRangoInferior : public ExcepcionRango{
public:
    ExcedeRangoInferior();
    const char* lanzarExcepcion() throw(){ //throw exception
        return "Value out of minimal range";
    }
};

class ExcedeRangoSuperior : public ExcepcionRango{
public:
    ExcedeRangoSuperior();
    const char* lanzarExcepcion() throw(){ //throw exception
        return "value out of maximal range";
    }
};

int obtainValue(int minimo, int maximo){ //obtain value

    int valor; //value
    std::cout<<"Introduce a value between "<<minimo<<" and "<<maximo<<" : "<<std::endl;
    std::cin>>valor;
    return valor;

};

int main(){
    ExcedeRangoSuperior* exS = new ExcedeRangoSuperior();
    ExcedeRangoInferior* exI= new ExcedeRangoInferior();
    int min=3; 
    int max=10;
    int valor=0; //value
    try{
        valor=obtainValue(min,max);
    }catch(int){
        if(valor<min){

            exS->lanzarExcepcion();
        }
        if(valor>max){

            exI->lanzarExcepcion();
        }
    }

    delete exS;
    delete exI;
    std::cin.get();
} 
```

PD：这是一个家庭作业，它的目标是修复它的错误，让它正常运行，正如我在这里问的最后一件事所看到的那样，这段代码似乎可以显示更多错误，比如语法错误，也许是设计以及结构性错误。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-06-15T01:08:40.633

看起来您已经为所有异常类型声明了构造函数，但您还没有在任何地方定义这些构造函数。您收到链接器错误，指出未找到构造函数实现。尝试声明这些函数。例如：

```
ExcedeRangoInferior::ExcedeRangoInferior() {
     // Implement me!
}
ExcedeRangoSuperior::ExcedeRangoSuperior() {
     // Implement me!
} 
```

希望这可以帮助！

# gcc - gcc 编译时间和内存使用量随着源代码中数组大小的变化而变化

> ID：11043421
> 
> 赞同：5
> 
> 时间：2012-06-15T01:07:06.557
> 
> 标签：gcc

这是 Linux 上的 gcc 4.4.6。

这是行为

**奇异的.c**

```
double a[500000000];

main() {
} 
```

如果我使用以下方法编译它：

```
gcc bizarre.c 
```

然后编译器用了4G的内存，而且耗时比较长。

如果我将数组大小设为 50000000，则编译所需的内存和时间会大大减少。

就像编译器正在执行它正在编译的代码一样。

我意识到以这种方式创建一个巨大的数组可能不是最佳实践，但有什么解释吗？

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2012-06-15T04:41:12.060

这是一个与 --build-id 相关的已知链接器错误，现已在主线修复。请参阅 [http://sourceware.org/bugzilla/show_bug.cgi?id=12451](http://sourceware.org/bugzilla/show_bug.cgi?id=12451) 一些发行版采用了 Nick 的早期补丁，该补丁不必要地计算了 .bss 上的校验和，需要分配 .bss 部分并将其归零。向您的发行版投诉。

# c - 对项目中的所有文件使用相同的结构

> ID：11043423
> 
> 赞同：-3
> 
> 时间：2012-06-15T01:07:31.593
> 
> 标签：c, visual-studio-2010, struct

我通过在每个头文件中声明它来在我的项目的所有文件中使用结构的实例。

我的问题是：有没有更简单/自动的方法呢？

这是一个例子：

好吧，我有一个名为：my_project 的项目，其中包含：main.c func1.c func2.c func3.c。在主文件上，我读取 txt 文件并将数据保存在 struct vector 上：

```
for(i=0;i<MAX;i++){ 
  fscanf(f,"%s",&s[i].nome); 
  fscanf(f,"%d",&s[i].id); 
  fscanf(f,"%d",&s[i].quantidade); 
  fscanf(f,"%d",&s[i].lim_min); 
  fscanf(f,"%f",&s[i].consumo_med); 
} 
```

我想要的是在 func2.c 和 func3.c 中使用结构向量

ehst是最好的方法吗？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-06-15T03:24:13.663

您可以在标头中定义 struct vector，可能称为 vector.h，然后在每个源文件中包含 vector.h（或在每个源文件中已包含的标头中）。这是一种常见的方法。这样做的好处是定义结构向量的文本只出现在一个地方，vector.h（这避免了在一个源文件而不是另一个源文件中编辑定义时发生的错误）。它本质上是唯一的方法，因为 C 不提供任何方法来导入除 #include 之外的定义。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-06-15T01:35:06.977

我假设您的`funcXYZ.c`文件中有函数声明，您包含在`main.c`? 您可能只是对函数进行编码以将适当的结构作为参数，然后将这些函数与您在`main`.

如果出于某种原因，您有相反的情况，即您包含`main.c`在 中`funcXYZ.c`，那么您可以使用[`extern`](http://www.geeksforgeeks.org/archives/840).

# objective-c - 使用表格视图单击基于选项卡栏的应用程序中的某个部分时出现错误

> ID：11043424
> 
> 赞同：1
> 
> 时间：2012-06-15T01:07:40.943
> 
> 标签：objective-c, xcode, cocoa

当我单击我在 iOS 模拟器中使用的 Tab-Bar 应用程序部分时收到此错误：

让我提一下，我的 DebateNavigationViewController 是 UIViewControllerSubclass

> Terminating app due to uncaught exception 'NSInvalidArgumentException', reason: '-[DebateNavigationViewController tableView:numberOfRowsInSection:]: unrecognized selector sent to instance 0x6b479a0' *** First throw call stack: (0x1874d72 0x106be51 0x190111d 0x107f7f8 0x1864b12 0x186476e 0x1ed7f6 0x1f03c4 0xbc792 0xbc138 0xbf986 0xc4461 0x641bc 0x107f6be 0x1e683b6 0x1e5c748 0x1e5c55c 0x1dda7c4 0x1ddb92f 0x1e7dda2 0x2cb5f 0x183daae 0x183d9ed 0x181b752 0x181aed4 0x181adab 0x17d0923 0x17d07a8 0x17e71 0x262d 0x2555) libc++abi.dylib: terminate called throwing an exception

这是我的一些相关代码：

```
- (NSInteger)numberOfSectionsInTableView:(UITableView *)tableView
{
return 1;
}

- (NSInteger)tableview:(UITableView *)tableview numberOfRowsInSection:(NSInteger)section
{
     return _list.count;
} 
```

有谁知道发生了什么？

编辑：连接图片： [连接](http://i567.photobucket.com/albums/ss115/mets4466/ScreenShot2012-06-14at95025PM.png)

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-06-15T01:16:40.970

可能是您的 DebateNavigationViewController 没有从 UITableViewController 继承，或者没有实现 Table View Datasource 和 Delegate 协议。

在你的头文件中：

```
@interface DebateNavigationViewController : UITableViewController 
```

或者

```
@interface DebateNavigationViewController : UIViewController <UITableViewDelegate, UITableViewDataSource> 
```

此外，如果您使用的是界面生成器，请确保您的连接和身份都是正确的。（表视图委托和数据源的连接应该是 DebateViewController。）

# oauth - 内部的 Facebook/Twitter OAuth 令牌是什么？

> ID：11043427
> 
> 赞同：1
> 
> 时间：2012-06-15T01:08:01.103
> 
> 标签：oauth, token, twitter-oauth

好吧，我真的知道它是什么。我很久以前就使用 Facebook/Twitter API。它有效，没有错误，抱歉:)。然而，下面的事情困扰着我。

什么是 OAuth 提供者端的令牌？我只从客户端看到令牌。但是有一件有趣的事情。这很容易理解。

默认情况下，我收到的令牌是有时间限制的。但是，当我请求具有**离线访问权限**的 API 时，我收到的令牌将永远有效，没有时间限制。令牌是否应该以这种方式存储在 OAuth 提供者数据库中？如果是这样，是什么阻止了用户生成数以百万计的代币？如果有很多令牌并且所有令牌都存储在没有时间限制的数据库中怎么办？数据库然后变成垃圾堆。这是真的方法吗？

我对令牌的存储方式有两个假设：

1.  令牌是分配给它的一组访问权限的简单**ID ，每个令牌都存储在 OAuth 提供者端。**

2.  代币是一个独立的概念。访问权限被加密并打包到令牌中，然后在提供者端被解密。令牌生命周期也包含在其中

第二个问题。如果我想开发自己的 OAuth 提供程序，存储令牌的最佳方式是什么？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-06-15T20:03:41.983

OAuth 令牌只是一个 ID，不包含任何信息。事实上，如果令牌包含真实信息，那就不好了，因为这样会更容易被黑客入侵。提供者将该令牌与您的应用程序帐户相关联，并将他们需要的任何信息存储在他们自己的数据库中。我不了解 Facebook，但 Twitter OAuth 令牌不会过期，除非所有者重新生成它们。

当您进行 OAuth 时，您将知道正在使用您的程序的用户是谁，并拥有自己的数据库表来保存用户数据。在用户的第一次 OAuth 身份验证中，获取他们的凭据并将其保存在您的数据库中。然后，在您对服务（即 Twitter）进行的每个后续查询中，重新加载这些凭据，以便用户不必重新进行身份验证。如果使用当前凭据的查询失败，您可能需要重新验证并保存新凭据 - 以防旧凭据因某种原因过期。这样，您系统中的每个用户都只有 OAuth 令牌，并且您可以管理该用户的生命周期。

# excel - SUMPRODUCTIF - 库存电子表格

> ID：11043433
> 
> 赞同：1
> 
> 时间：2012-06-15T01:08:41.500
> 
> 标签：excel, google-docs

在 Google Docs（与 Excel 和其他电子表格程序共享许多命令）中有以下功能：

*   SUMIF：接受一个谓词和一个范围，并将谓词中满足该谓词的所有项目相加。
*   SUMPRODUCT：取 2 个列范围，在每一行将元素乘以另一个范围内的相邻元素，然后将所有这些相加。

```
+-----+------------------+------+------------------ +
| 数量 | 产品 | 项目 | 每个产品的项目 |
+-----+------------------+------+------------------ +
| 4 | foo 盒 | 富 | 10 |
| 8 | 富 | 富 | 1 |
| 2 | 酒吧盒| 高分辨率照片| CLIPARTO 酒吧 | 10 |
| 1 | 吧台包| 设置 | 1 |
+-----+------------------+------+------------------ +

```

所以我有一个产品的订单清单（基本上是库存）。每个产品包含一个或多个项目。大多数时候只是一种类型的项目。除了包含 1 个 foo 和 1 个 bar 的 foobar 包。

我想生成一个表格来总结我们订购的每个项目的数量。想要：

```
+--------+----------------+
| 项目 | 净数量 |
+--------+----------------+
| 富 | 49 (=4*10+8+1) |
| 酒吧 | 29(=2*10+1) |
+--------+----------------+

```

括号中的内容不是输出表的一部分，只是为了明确每个数字的来源。

如何生成这样的表？似乎可以通过使用 If、Sum 和 Product 来完成。使用 Ifs 使其将名称与我正在反击的关键字“set”的项目中的任何一个不匹配的事物计数为零，然后对结果进行 SUMPRODUCTING。但是我[我不确定如何在一行中完成此操作

我不太了解 If，或者一般在电子表格中做复杂的事情

这是一件一次性的事情，所以我不想去努力创建一个数据库，然后导出一个电子表格。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-06-15T01:38:57.160

[受此博客](http://googledocsforlife.blogspot.sk/2012/05/using-sumproduct-in-google-spreadsheets.html)的启发，这适用于您的数据：

```
=arrayformula(sumproduct(
 (($C$2:$C$5="foo")+($C$2:$C$5="set")), $A$2:$A$5, $D$2:$D$5)) 
```

# python - 检查错误

> ID：11043434
> 
> 赞同：2
> 
> 时间：2012-06-15T01:08:45.167
> 
> 标签：python

如何设置一个值以**仅接受 Python 中的某些数据**？就像我正在为颜色标识符制作代码一样。我希望我的变量最多只能接受`FFFFFF`任何大于此的值。base-16 字符几乎... **hex code**。

我试图这样做的原因是因为如果用户输入一个类似的值`GGGGGG`会给他们一个**Script Error**，这实际上让我看起来无能（我可能是，但我不想看起来像我）。而且，如果他们输入像 F1F2G% 这样的特殊字符，它也会搞砸。此外，如果他们将该框留空，也会给出脚本错误。

我想避免这些错误。有谁知道一个好方法吗？

* * *

## 回答 #1

> 赞同：11
> 
> 时间：2012-06-15T01:15:20.687

```
try:
    val = int(hex_val, 16)
except ValueError:
    # Not a valid hex value

if val > int("FFFFFF", 16):
    # Value is too large 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-06-15T01:17:30.900

这是假设输入是字符串的一种方法：

```
import string

def check_HEX(input):
    for l in input:
        if l not in string.hexdigits:
            return False
    return True 
```

给出：

```
print check_HEX('FFFFFF') # True
print check_HEX('FFFZFF') # False
print check_HEX(' ')      # False
print check_HEX('F1F2G%') # False 
```

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-06-15T01:27:31.227

您还可以使用 re.reg 中的正则表达式工具。

```
val = val.upper()
seeker = re.compile("^[0-9A-F]{1,6}$")

if seeker.search(val):
    hexCode = int(val, 16)
    # process a good value
else:
    #bail 
```

# android - 将列与数据库中的字符串进行比较？

> ID：11043435
> 
> 赞同：0
> 
> 时间：2012-06-15T01:09:18.737
> 
> 标签：android, string, sqlite

我需要帮助将列与字符串进行比较。android 数据库中有一个列，它以字符串的形式存储和关闭。我需要将该列与“On”字符串进行比较，如果该列中有任何 On，我需要它返回 true，如果数据库中没有 on，则返回 false，我该怎么做？

我的代码

> 公共布尔 QuickTime(){
> 
> ```
>  String myQuery = "SELECT * FROM DATABASE_TABLE_QUICK WHERE ALARM_ID_QUICK LIKE 'On' ";
>       Cursor mCursor = databaseConnect.rawQuery(myQuery, null);
>       if(mCursor.getCount()>0)  //if at least one record contains 'on'
>           return true;
>       else
>           return false; //no record was found with the word 'on'
>   } 
> ```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-06-15T01:29:59.267

一个简单（不是最好）的方法是使用[Rawquery](http://developer.android.com/reference/android/database/sqlite/SQLiteDatabase.html#rawQuery%28java.lang.String,%20java.lang.String%5B%5D%29)。所以你所要做的就是：

```
private boolean containsOn(SQLiteDatabase mSQLiteDatabase){
    String myQuery = "SELECT * FROM MYTABLE WHERE status LIKE 'on' ";
    Cursor mCursor = mSQLiteDatabase.rawQuery(myQuery, null);
    mCursor.
    if(mCursor.getCount()>0)  //if at least one record contains 'on'
        return true;
    else
        return false; //no record was found with the word 'on'
} 
```

您所要做的就是传递您的 sqlLite 数据库，更改表名和列名的状态列。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-06-15T01:32:23.300

```
sqlite> create table on_c(id int,onoff varchar(3));
sqlite> insert into on_c (id,onoff)values(1,'ON');
sqlite> insert into on_c (id,onoff)values(2,'OFF');
sqlite> select * from on_c;
1|ON
2|OF
select case count(*) when 0 then 'true' else 'false' end from on_c where onoff like '%N';
false 
```

# javascript - 设置间隔是否正确以确保 Ajax 调用完成？

> ID：11043437
> 
> 赞同：0
> 
> 时间：2012-06-15T01:09:41.403
> 
> 标签：javascript, jquery, ajax, javascript-events, event-handling

我有两个输入文本字段和一个“保存”按钮。

```
<input type="text" id="myInput" />
<input type="text" id="searchResult"/>
<button id="myButton>save</button> 
```

`myInput`文本字段有**onchange 事件**，然后发送 Ajax 请求以获取一些数据并将结果显示到`searchResult`文本字段。

保存按钮具有**单击事件**，可验证`searchResult`文本字段的输入是否为空字符串等。如果确定，则继续保存。

```
$("myInput").change(function() {
    var userInput = $("myInput").val(); //get value from the text field
    var responseText = callAjaxToGetData(userInput):  //XHR request to get some data

    $("searchResult").val( responseText ); //show the XHR result here

});

$("myButton").click(function() {
    var searchResultField = $("searchResult").val(); //get value from the searchResult field
    var isOK = validate(searchResultField);  //check empty string and such

    if(isOK) { saveDataViaAjax(userInput); }
}); 
```

**问题**

当用户在文本字段中输入一些文本然后单击“`save"`按钮时，

1.  `onchange event`被触发，`callAjaxToGetData()`被调用。(XHR)

2.  before`callAjaxToGetData()`完成并填写 searchResult 文本字段，myButton`onclick event`被触发。

3.  在 onclick 事件处理程序方面，验证失败，因为 searchResult 字段仍然为空。

4.  `callAjaxToGetData()`最后完成并填写 searchResult 文本字段。

理想情况下，首先完成 callAjaxToGetData() 然后在 onclick 事件中继续该过程，这样验证就不会失败。

我猜这似乎是人们会面临的很常见的情况，所以我想知道你们是如何解决这个问题的？

我正在考虑将间隔放入 onclick 事件中，如下所示（这需要 responseText 是一个全局变量）

```
$("myButton").click(function() {

   var interval = setInterval(function() { //call every 500ms

       //if responseText is not null that means i know the ajax inside of onchange event is completed for sure.
       if( responseText != null ) {

           clearInterval(interval);

           var searchResultField = $("searchResult").val(); //get value from the searchResult field
           var isOK = validate(searchResultField);  //check empty string and such

           if(isOK) { saveDataViaAjax(userInput); }
       }
   }, 500);  
}); 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-06-15T01:27:21.900

下面的代码可能不准确，但我会在 ajax 之前禁用按钮并在回调返回后启用。

```
$("myInput").change(function() {
     $("myButton").attr("disabled", "disabled");
     var userInput = $("myInput").val(); //get value from the text field
     var responseText = callAjaxToGetData(userInput, function(data) {

        $("searchResult").val( data); //show the XHR result here
        $("myButton").removeAttr("disabled"); 
     }):
 }); 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-06-15T09:04:51.003

我认为为了避免`onClick event`进程比 ajax 进程更快`onChange event`，设置计时器解决了这个问题。

首先，我创建了辅助函数来检查活动的 ajax 连接并调用将在 onClick 事件中调用的函数。

**帮手**

```
function check_pending_process(callback) {
    var interval = setInterval(function() {
        if($.active > 0) {
            //do nothing here
        }
        else {
            //no ajax is running, call the function after 500 ms
            clearInterval(interval);
            setTimeout(function() { window[callback].call() }, 500);
        }    
    }, 100);
} 
```

**呼叫者**

```
function processButtonClick() {
    var searchResultField = $("searchResult").val(); //get value from the searchResult field
    var isOK = validate(searchResultField);  //check empty string and such

    if(isOK) { saveDataViaAjax(userInput); }

}

$("#myButton").click(function() {

    check_pending_process("processButtonClick");

}); 
```

500ms的判断是根据onchange事件中post-ajax的过程需要多长时间。就我而言，onchange 事件中的后 ajax 过程只是将响应文本放入文本字​​段，因此 500 毫秒就足够了。

# java - 松开按键后停止动画

> ID：11043438
> 
> 赞同：0
> 
> 时间：2012-06-15T01:09:53.337
> 
> 标签：java, animation, java-2d, slick2d

我现在拥有的是一个动画，当我按下空格时开始：

```
if(input.isKeyDown(Input.KEY_SPACE)) player = movingRightSwingingSword; 
```

但是，当我停止单击空间时，我的动画会继续。在我移动我的播放器之前，我该如何让它在你放开空间时立即停止动画？

## 几行

```
Animation player, movingUp, movingDown, movingLeft, movingRight, movingRightSwingingSword;
int[] duration = {200,200};

public void init(GameContainer gc, StateBasedGame sbg) throws SlickException
    {
    Image[] attackRight = {new Image("res/buckysRightSword1.png"), new Image("res/buckysRightSword2.png")};

    movingRightSwingingSword = new Animation(attackRight, duration, true);
    }

public void update(GameContainer gc, StateBasedGame sbg, int delta) throws SlickException
    {
     if(input.isKeyDown(Input.KEY_SPACE)) player = movingRightSwingingSword;
     } 
```

## 完整代码

```
package javagame;

import org.newdawn.slick.*;
import org.newdawn.slick.state.*;

public class Play extends BasicGameState
{
    Animation player, movingUp, movingDown, movingLeft, movingRight, movingRightSwingingSword;
    Image worldMap;
    boolean quit = false;
    int[] duration = {200,200};
    float playerPositionX = 0;
    float playerPositionY = 0;
    float shiftX = playerPositionX + 320;
    float shiftY = playerPositionY + 160;

    public Play(int state)
    {

    }

    public void init(GameContainer gc, StateBasedGame sbg) throws SlickException
    {
        worldMap = new Image("res/world.png");
        Image[] walkUp = {new Image("res/buckysBack.png"), new Image("res/buckysBack.png")};
        Image[] walkDown = {new Image("res/buckysFront.png"), new Image("res/buckysFront.png")};
        Image[] walkLeft = {new Image("res/buckysLeft.png"), new Image("res/buckysLeft.png")};
        Image[] walkRight = {new Image("res/buckysRight.png"), new Image("res/buckysRight.png")};
        Image[] attackRight = {new Image("res/buckysRightSword1.png"), new Image("res/buckysRightSword2.png")};

        movingUp = new Animation(walkUp, duration, false);
        movingDown = new Animation(walkDown, duration, false);
        movingLeft = new Animation(walkLeft, duration, false);
        movingRight = new Animation(walkRight, duration, false);
        //doesnt work! vvv
        movingRightSwingingSword = new Animation(attackRight, duration, true);
        player = movingDown;

    }

    public void render(GameContainer gc, StateBasedGame sbg, Graphics g) throws SlickException
    {
        worldMap.draw(playerPositionX, playerPositionY);
        player.draw(shiftX, shiftY);
        g.drawString("Player X: " + playerPositionX + "\nPlayer Y: " + playerPositionY, 400, 20);

        if (quit == true)
        {
            g.drawString("Resume (R)", 250, 100);
            g.drawString("MainMenu (M)", 250, 150);
            g.drawString("Quit Game (Q)", 250, 200);
            if (quit==false)
            {
                g.clear();
            }
        }
    }

    public void update(GameContainer gc, StateBasedGame sbg, int delta) throws SlickException
    {
        Input input = gc.getInput();

        if(input.isKeyDown(Input.KEY_UP)) 
        {
            player = movingUp;
            playerPositionY += delta * .1f;
            if(playerPositionY>162) playerPositionY -= delta * .1f; 
        }

        if(input.isKeyDown(Input.KEY_DOWN)) 
        {
            player = movingDown;
            playerPositionY -= delta * .1f;
            if(playerPositionY<-600) playerPositionY += delta * .1f; 
        }

        if(input.isKeyDown(Input.KEY_RIGHT)) 
        {
            player = movingRight;
            playerPositionX -= delta * .1f;
            if(playerPositionX<-840) playerPositionX += delta * .1f; 
        }

        if(input.isKeyDown(Input.KEY_LEFT)) 
        {
            player = movingLeft;
            playerPositionX += delta * .1f;
            if(playerPositionX>318) playerPositionX -= delta * .1f; 
        }

        if(input.isKeyDown(Input.KEY_SPACE)) player = movingRightSwingingSword;

        if(input.isKeyDown(Input.KEY_ESCAPE)) quit = true;
        if(input.isKeyDown(Input.KEY_R)) if (quit == true) quit = false;
        if(input.isKeyDown(Input.KEY_M)) if (quit == true) {sbg.enterState(0); quit = false;}
        if(input.isKeyDown(Input.KEY_Q)) if (quit == true) System.exit(0);
    }

    public int getID()
    {
        return 1;
    }
} 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-06-15T01:43:58.663

在更新中，检查当前动画是否为movingRightSwingingSword，如果是，则检查它是否已结束（猜测可以使用持续时间）。

我认为它可能是这样的：

```
public void update(GameContainer gc, StateBasedGame sbg, int delta) throws SlickException {
   if(input.isKeyDown(Input.KEY_SPACE)) player = movingRightSwingingSword;
   //This is the new code, I don´t know what are the real functions to be used, but the concept is this
   if (player == movingRightSwingingSword && player.ended()) player = defaultAnimation;
} 
```

**编辑：**如果你想在空格键被释放时改变它，只需在条件的 else 部分改变动画：

```
public void update(GameContainer gc, StateBasedGame sbg, int delta) throws SlickException {
       if(input.isKeyDown(Input.KEY_SPACE)) player = movingRightSwingingSword;
       else if (player == movingRightSwingingSword) player = defaultAnimation;
    } 
```

# javascript - 从 JAVA6 中的 javascript 引擎库调用斯坦福 javascript 库加密函数的问题

> ID：11043441
> 
> 赞同：2
> 
> 时间：2012-06-15T01:10:13.700
> 
> 标签：javascript, encryption, sjcl

我正在尝试从 JAVA6 中的 javascript 引擎库调用 stanford javascript 库加密函数。使用 JAVA6 中的 javascript 引擎库的以下代码，我收到以下错误：

```
javax.script.ScriptException: sun.org.mozilla.javascript.internal.JavaScriptException: [object Object] (<Unknown source>#19) in <Unknown source> at line number 19
at com.sun.script.javascript.RhinoScriptEngine.invoke(Unknown Source)
at com.sun.script.javascript.RhinoScriptEngine.invokeFunction(Unknown Source)
at Test.main(Test.java:149) 
```

任何帮助将非常感激。

```
public static void main(String[] args){
try {
    ScriptEngineManager mgr = new ScriptEngineManager();
    List<ScriptEngineFactory> factories = mgr.getEngineFactories();
    System.out.println("Available script engines:");
    for (int i = 0; i < factories.size(); i++) {
        ScriptEngineFactory factory = factories.get(i);
        String engine = factory.getEngineName();
        String language = factory.getLanguageName();
        System.out.println("-------------------------------------------");
        System.out.println("Language: " + language);
        System.out.println("Engine: " + engine);
        System.out.println("-------------------------------------------");
    }
    ScriptEngineManager manager = new ScriptEngineManager();
    ScriptEngine engine = manager.getEngineByName("ECMAScript");
    File script_file = new File("web/js/sjcl.js");
    Reader reader = new FileReader(script_file);
    engine.eval(reader);
    String script = "function decode(encoded_value){"
            + "var decoded_value = sjcl.decrypt('asdf',encoded_value);"
            + "return decoded_value;}"
            + "function encode(plain_text){"
            + "var encoded_value = sjcl.encrypt('asdf', plain_text);"
            + "return encoded_value;}";
    engine.eval(script);
    Invocable invocableEngine = (Invocable) engine;
    String plain_text = "admin";
    String cypher_text = (String) invocableEngine.invokeFunction("encode", plain_text);
    String plain_text_return = (String)invocableEngine.invokeFunction("decode", cypher_text);
    System.out.print("plain_text="+plain_text+"\ncypher_text=" +cypher_text + "\nplain_text_return=" + plain_text_return+"\n");
} catch (Exception e) {
    e.printStackTrace();
} 
```

}

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-06-19T02:56:57.777

To solve this problem, I had to change the sjcl.js to change the "throw new" statements.

An example:

```
throw new sjcl.exception.invalid("required parameter overridden"); 
```

became:

```
sjcl.exception.invalid.message = ("required parameter overridden");
throw ("required parameter overridden"); 
```

I have not done enough tests, ok. I don't know if this change can cause problems in the future.

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2016-01-27T11:12:37.570

我们也遇到了这个问题，我们设法将其追踪到 JRE 版本，`RhinoScriptEngine`似乎不喜欢在 JRE 6、JRE 7 及更高版本中运行斯坦福脚本，它工作正常。

# django - 在 Heroku 上使用自定义 shell 脚本

> ID：11043443
> 
> 赞同：0
> 
> 时间：2012-06-15T01:10:23.180
> 
> 标签：django, git, shell, heroku, mdbtools

我正在使用 Heroku 和 git 为 django 应用程序提供动力。该站点的部分功能允许用户上传 .mdbs（Microsoft Access 数据库），然后我们使用调用 mdbtools (http://mdbtools.sourceforge.net/) 的 shell 脚本对其进行解析。shell 脚本在本地运行良好，但在 heroku 站点上运行良好。我认为问题在于 mdbtools 不包括在内。我尝试在 requirements.txt 中包含 mdbtools，但没有任何运气。有没有人有任何想法？

我在 requirements.txt 中将 mdbtools 和 mdbtools-dev 分别包含在自己的行中，如下所示：

```
mdbtools
mdbtools-dev 
```

这是我在 requirements.txt 中包含 mdbtools 和 mdbtools-dev 时遇到的错误

```
....
Requirement already satisfied (use --upgrade to upgrade): stripe in ./lib/python2.7/site-packages (from -r requirements.txt (line 7))
Downloading/unpacking mdbtools-dev (from -r requirements.txt (line 8))
Could not find any downloads that satisfy the requirement mdbtools-dev (from -r requirements.txt (line 8))
No distributions at all found for mdbtools-dev (from -r requirements.txt (line 8))
Storing complete log in /app/.pip/pip.log
! Heroku push rejected, failed to compile Python app 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-06-15T01:13:30.500

[http://pypi.python.org/pypi/mdbtools](http://pypi.python.org/pypi/mdbtools)给出：

```
Not Found () 
```

为了`pip`能够安装需求，它必须能够在 PyPI 上找到它们。看起来您正在使用 PyPI 上不可用的包，因此`pip`无法找到它来安装它。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-08-30T17:39:56.417

**解决方案**

经过一番摆弄，我找到的解决方案有点复杂。答案是下载 debian 包，然后复制库文件 (.so) 并将它们加载到您的服务器（或 heroku）。从那里，确保在脚本开始时将这些库的路径添加到 LD 库路径，它应该可以工作

# css - WordPress 子菜单从下拉到水平

> ID：11043444
> 
> 赞同：0
> 
> 时间：2012-06-15T01:10:26.707
> 
> 标签：css, wordpress, drop-down-menu, alignment

> 我正在编辑 WordPress 默认主题 TwentyTwelve，但我一直在将子菜单 > 从下拉菜单对齐到水平线。这里是网站[http://nickart.hostei.com/](http://nickart.hostei.com/) 这里是它的样子![在此处输入图像描述](../Images/62a520cca123c361d0bfb84832cef606.png) 这里是我想要的样子![在此处输入图像描述](../Images/ce878d7a56cb6f923521052a4fe5f8f3.png) 这里是我的样式表[http://pastebin.com/4nLRNR6d](http://pastebin.com/4nLRNR6d) 在此先感谢。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-06-15T02:51:12.903

删除所有与菜单相关的项目，请改为插入：

```
/*=Menu*/
#access UL
{
    list-style: none;
}
#access LI
{
    float: left;
}
.menu-item-type-taxonomy A
{
    float: left;
}
.menu-item-type-taxonomy
{
    height: auto;
}
.menu-item-type-taxonomy .sub-menu
{
}
#access A
{
    color: #6A6A6A;
    padding: 0 13px;
    font-size: 24px;
    font-family: "Ropa Sans", sans-serif;
    text-transform: uppercase;
    letter-spacing: -0.2px;
}
UL .sub-menu
{
    margin: 0px;
    display: inline-block;
} 
```

之后，您可以继续进行格式设置（颜色、悬停等）

# jquery - 如何使用 jquery 更新 MVC 视图上的属性

> ID：11043445
> 
> 赞同：3
> 
> 时间：2012-06-15T01:10:53.123
> 
> 标签：jquery, asp.net-mvc

我有一个 MVC 视图，它上面有一个 Bird 的属性 BirdSize。

当鸟的体重或身高选择列表发生变化时，此 BirdSize 属性的值可能会发生变化。

我想要的是在没有完全刷新屏幕的情况下进行此更新，所以我猜是 jquery。

我不是特别想复制 BirdSize 属性代码，只是想按原样使用它。

所以类：

```
public class Bird
{
   public int WeightId { get; set; }
   public Weight Weight { get; set; }
   public int HeightId { get; set; }
   public Height Height { get; set; }

public string BirdSize
{
   if(Height == "Tall" && Weight == "Heavy") {
      return "Big";
   }
   else {
      return "Small";
   }
}
} 
```

然后我有一个视图：

```
@model Ahb.Insite.HerdRegistration.WebUI.ViewModels.BirdModel

<script src="../../Scripts/jquery-1.7.2.min.js" type="text/javascript"></script>
<script src="../../Scripts/Views/HerdRegistrationWizard/index.js" type="text/javascript"></script>

<h3>Bird Weight/h3>
<div>
    @Html.DropDownListFor(model => model.Bird.WeightId, Model.BirdWeightSelectListItems, new { @id = "weightddl" })
</div>
<h3>Bird Height/h3>
<div>
    @Html.DropDownListFor(model => model.Bird.HeightId, Model.BirdHeightSelectListItems, new { @id = "heightddl" })
</div>
<h3> Bird Size</h3>
<div>
    @Html.DisplayFor(model => model.Bird.BirdSize)
</div> 
```

所以选择看起来像：

```
<select id="weightddl">
   <option value="1">Light</option>
   <option value="2">Medium</option>
   <option value="3">Heavy</option>
</select>

<select id="heightddl">
   <option value="1">Short</option>
   <option value="2">Medium</option>
   <option value="3">Tall</option>
</select> 
```

所以我想我会在这些脚本代码中做一些事情：

```
$('#weightddl').change(function() {
   //Do something to update birdsize
});

$('#heightddl').change(function() {
   //Do something to update birdsize
}); 
```

我不确定最好的方法。我能想到的唯一方法是使用新值发送到服务器方法，该方法将创建一只新鸟并发回该鸟的大小。任何人都知道使此功能正常工作的更好方法吗？

也许你可以使用局部视图？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-06-15T06:02:07.490

如果逻辑真的很简单，那么就像@Jonas 所做的那样，在 JavaScript 中复制代码是没有问题的。有时我们必须打破规则（DRY）来实现为用户提供更好体验的东西。如果您不复制代码，那么您正在向服务器发出额外的请求，并且鸟会在知道它的大小之前飞走:)

但如果你想这样做的话..

**楷模**

```
public class BirdViewModel
  {
    public Bird Bird { get; set; }
    public IEnumerable<SelectListItem> Heights { get; set; }
    public IEnumerable<SelectListItem> Weights { get; set; }
  }

  public class Bird
  {
    public int WeightId { get; set; }
    public int HeightId { get; set; }
    public string Weight { get; set; }
    public string Height { get; set; }

    public string BirdSize
    {
      get
      {
        if (HeightId == 3 && WeightId == 3)
        {
          return "Big";
        }
        else
        {
          return "Small";
        }
      }
    }
  } 
```

**控制器**

```
public class BirdController : Controller
  {
    public ActionResult Index()
    {
      var model = new BirdViewModel();

      model.Weights = new[]
         {
           new SelectListItem{ Text = "Light", Value = "1" },
           new SelectListItem{ Text = "Medium", Value = "2" },
           new SelectListItem{ Text = "Heavy", Value = "3" }
         };

      model.Heights = new[]
         {
           new SelectListItem{ Text = "Short", Value = "1" },
           new SelectListItem{ Text = "Medium", Value = "2" },
           new SelectListItem{ Text = "Tall", Value = "3" }
         };

      return View(model);
    }

    [HttpPost]
    public PartialViewResult DisplaySize(Bird bird)
    {
      return PartialView(bird);
    }
  } 
```

**索引.cshtml**

```
@model Birds.Models.BirdViewModel

@{
    ViewBag.Title = "Index";
    var ajaxOptions = new AjaxOptions 
    {
       UpdateTargetId = "birdSize",
       Url = "Bird/DisplaySize"
    };
}

<h2>Index</h2>

@using (Ajax.BeginForm(ajaxOptions))
{
  <h3>Bird Weight</h3>
  <div>
    @Html.DropDownListFor(model => model.Bird.WeightId, Model.Weights, new { @id = "weightddl" })
  </div>
  <h3>Bird Height</h3>
  <div>
      @Html.DropDownListFor(model => model.Bird.HeightId, Model.Heights, new { @id = "heightddl" })
  </div>
  <h3> Bird Size</h3>
  <div id="birdSize">
      @Html.Partial("DisplaySize", Model.Bird ?? new Birds.Models.Bird())
  </div>
}

<script type="text/javascript">
  $("select").change(function () {
    $("form").submit();
  });
</script> 
```

**显示尺寸.cshtml**

```
@model Birds.Models.Bird

@Html.DisplayFor(model => model.BirdSize) 
```

我用过`Ajax.BeginForm`，所以你必须包括`jquery.unobtrusive-ajax.min.js`图书馆。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-06-15T01:20:33.900

最简单的方法是在 Javascript 中复制代码，但这样你就不会干了。最简单的 DRY 解决方案是一个 Ajax 调用，它将身高和体重发送到服务器，并以 JSON 格式接收回大小字符串。然后您可以更新birdsize div。

底线是，无需在 javascript 中复制 BirdSize 代码，访问它的唯一方法就是调用服务器。不过，它不必是整页的回发。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-06-15T01:30:45.687

如果你给birdsize div一个id

```
<div id="birdsize">
    @Html.DisplayFor(model => model.Bird.BirdSize)
</div> 
```

然后你可以抓住它并像这样改变它的内容

```
$('#weightddl, #heightddl').change(function() {
  //Do something to update birdsize
  if($('#weightddl').val() == "3" && $('#heightddl').val() == "3")
      $('#birdsize').text('Big');
  else
      $('#birdsize').text('Small'); 
```

});

# php - MySQL：在具有多个 ID 的表单中传递单行 ID

> ID：11043449
> 
> 赞同：0
> 
> 时间：2012-06-15T01:11:32.480
> 
> 标签：php, mysql, forms

表单由打印出所有等待批准的行的函数组成；

```
function all_reviews(){
$query1= mysql_query("SELECT * FROM {$table} WHERE first != '' && disp_state= '0' && rejected != '1'");
if (!$query1) {
    die("Query to show fields from table failed");
}
$fields_num = mysql_num_fields($query1);

// printing table rows
while($row = mysql_fetch_array($query1))
{
//review action buttons
        echo "<div class=\"rev_action\">";
        echo "<input type=\"hidden\" name=\"".$row['id']."\">";
        echo "<input type=\"submit\" name=\"accept\" value=\"Approve\" class=\"success rev_button\" onclick=\"document.getElementById('review_action').submit()\">";
        echo "<input type=\"submit\" name=\"reject\" value=\"Reject\" class=\"error rev_button\" onclick=\"document.getElementById('review_action').submit()\">";
        echo "</div>";
} 
```

我猜正确的方法是在隐藏的输入中打印行 ID。问题是，一次可能有超过 1 行打印出来。

**如何选择与批准或拒绝按钮相关的确切行？**

html:

```
<form name="form" action="include/review_submit.php" id="review_action" method="post">

    <?php all_reviews(); ?>

</form> 
```

php (review_submit.php):

```
//database server connection 
mysql_connect ("$servername","$dbusername","$dbpassword") or die(mysql_error());
//database connection 
mysql_select_db("esd_db") or die(mysql_error()); 

//data feilds from review form
if($_POST['button'] == "Approve") {
   //code to update given row with an approval status
}

//data feilds from review form
if($_POST['button'] == "Reject") {
   //code to update given row with an rejection status
}
//insert values into table
 mysql_query("UPDATE `reviews` ") or die(mysql_error());

 Print "Success"; 

?> 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-06-15T01:19:36.577

您总是可以使每一行成为不同的形式，并将其传递给动态 URL，GetDATA 将告诉您选择了哪一个。

或者，您不能使用表单，而是让每个表单都链接到一个页面。（假设操作页面是 action.php，你有 100 行。你可以有 action.php?row=1&ac=y、action.php?row=1&ac=n 等）

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-06-15T01:27:31.273

如果您想使用基本的非 AJAX 表单，您应该为每一行添加一个复选框并将按钮从每一行移动到表单的底部：

```
<div class="rev_action">
  <input type="checkbox" name="select_row[]" value="1">
</div>
<div class="rev_action">
  <input type="checkbox" name="select_row[]" value="2">
</div>
<!-- ... -->
<input type="submit" name="accept" value="Approve" class="success rev_button">
<input type="submit" name="reject" value="Reject" class="error rev_button"> 
```

如果你想使用 ajax，你不需要在上面做任何改变，并且需要为每个按钮添加一个点击事件：

```
echo "<div class=\"rev_action\">";
echo "<input class="id_input" type=\"hidden\" name=\"".$row['id']."\">";
echo "<input type=\"submit\" name=\"accept\" value=\"Approve\" class=\"success rev_button\" onclick=\"document.getElementById('review_action').submit()\">";
echo "<input type=\"submit\" name=\"reject\" value=\"Reject\" class=\"error rev_button\" onclick=\"document.getElementById('review_action').submit()\">";
echo "</div>";
...

</form>
<script>
$('input.success.rev_button').click(function(){
  var review_id = $(this).siblings('input.id_input').attr('name')
  $.ajax({
    url: '/reviews/success',
    type:'POST',
    data: {id: review_id}
  })
})
</script> 
```

# ruby - . vs ::（点与双冒号）用于调用方法

> ID：11043450
> 
> 赞同：54
> 
> 时间：2012-06-15T01:11:55.287
> 
> 标签：ruby

我正在从[Poignant Guide to Ruby](http://www.rubyinside.com/media/poignant-guide.pdf)中学习 Ruby ，在一些代码示例中，我遇到了似乎用于相同目的的双冒号和点的用法：

```
File::open( 'idea-' + idea_name + '.txt', 'w' ) do |f|
   f << idea
end 
```

在上面的代码中，双冒号用于访问类的`open`方法`File`。但是，我后来遇到了出于相同目的使用点的代码：

```
require 'wordlist'
# Print each idea out with the words fixed
Dir['idea-*.txt'].each do |file_name|
   idea = File.read( file_name )
   code_words.each do |real, code| 
     idea.gsub!( code, real )
   end
puts idea
end 
```

这一次，使用点来访问类的`read`方法`File`。有什么区别：

```
File.read() 
```

和

```
File::open() 
```

* * *

## 回答 #1

> 赞同：32
> 
> 时间：2012-06-15T01:19:47.250

它是[*范围解析运算符*](http://en.wikipedia.org/wiki/Scope_resolution_operator#Ruby)。

来自维基百科的一个例子：

```
module Example
  Version = 1.0

  class << self # We are accessing the module's singleton class
    def hello(who = "world")
       "Hello #{who}"
    end
  end
end #/Example

Example::hello # => "Hello world"
Example.hello "hacker" # => "Hello hacker"

Example::Version # => 1.0
Example.Version # NoMethodError

# This illustrates the difference between the message (.) operator and the scope
# operator in Ruby (::).
# We can use both ::hello and .hello, because hello is a part of Example's scope
# and because Example responds to the message hello.
#
# We can't do the same with ::Version and .Version, because Version is within the
# scope of Example, but Example can't respond to the message Version, since there
# is no method to respond with. 
```

# yii - 在 EGMap Google Maps Extension for yii 上设置兴趣点 (POI)

> ID：11043453
> 
> 赞同：0
> 
> 时间：2012-06-15T01:12:11.777
> 
> 标签：yii

我正在使用带有 yii 框架的 EGMap 扩展来处理谷歌地图。我想禁用地图上的 POI。

我知道这可以以通常的方式完成：

```
styles:[{
        featureType:"poi",
        elementType:"labels",
        stylers:[{
            visibility:"off"
        }]
    }] 
```

但是我如何在 yii 上做到这一点？

感谢你的帮助。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-06-15T12:54:23.880

刚刚查看了扩展代码，尝试调用`setOptions`地图对象，因为此功能是设置谷歌地图选项。

来自 EGMAP 扩展源 (EGMap.php)

```
/**
 * 
 * Sets Google Map Options
 * @param array $options
 * 
 */
public function setOptions($options)
{
    $this->options = CMap::mergeArray($this->options, $options);
} 
```

# php - 基于 MySQL 和 PHP 的复选框选中状态

> ID：11043463
> 
> 赞同：0
> 
> 时间：2012-06-15T01:13:20.127
> 
> 标签：php, mysql

我在 PHP 中有一个基本的 PHP 表单（几个字段和 2 个复选框，我想稍后添加更多复选框，但现在我只使用 2 个进行测试）。字段和复选框保存到 MySQL 数据库，效果很好。

我还有一个“编辑”表单，它反映了原始输入表单，除了字段的值是根据行 ID 从 MySQL 数据库加载的，这是非常标准的。

问题是，目前，编辑表单的最后一个字段只是另一个文本输入字段。我想做的是更改复选框，这些复选框将根据原始表单的输入被选中或取消选中。

我认为有必要使用`ischecked`，但我不确定是否需要更改原始表单的逻辑，或者是否需要更改数据库本身（我希望不会！）。

数据库的布局是这样的：

```
-------------------------------------------------------------------------------------------
| ID (int) | ARTICLEAUTHOR (varchar) | ARTICLEORGANIZATION (varchar) | ARTICLETAGS (varchar)|
 ------------------------------------------------------------------------------------------- 
```

两种形式的代码如下。

一、新的报名表：

```
 // addnew.php

            <?php
             function renderForm($articletitle, $articleorganization, $articledate, $articleurl, $articletags )
            . . .
            </head>

            <body>
            . . .
                  <form id="form" name="form" action="" method="post">
                    <h1>Create a new entry in the database</h1>
                    <table width="100%" border="0" cellpadding="6">
                      <tr>
                        <td colspan="2"><legend>Article details</legend></td>
                      </tr>
                      <tr>
                        <td width="20%" align="right"><span class="field">Article Title:</span></td>
                        <td width="80%" align="left"><span class="field">
                          <input name="articletitle" type="text" value="<?php echo $articletitle; ?>" size="50"/>
                        </span></td>
                      </tr>
                      <tr>
                        <td align="right"><span class="field">Article Author:</span></td>
                        <td align="left"><span class="field">
                          <input name="articleorganization" type="text" value="<?php echo $articleorganization; ?>" size="50"/>
                        </span></td>
                      </tr>
                      <tr>
                        <td align="right"><span class="field">Article Date:</span></td>
                        <td align="left"><span class="field">
                          <input name="articledate" type="text" value="<?php echo $articledate; ?>" size="50"/>
                        </span></td>
                      </tr>
                      <tr>
                        <td align="right"><span class="field">Article URL:</span></td>
                        <td align="left"><span class="field">
                        <input name="articleurl" type="text" value="<?php echo $articleurl; ?>" size="50"/>
                        </span></td>
                      </tr>
                    </table>
            . . .
                      <input type="checkbox" name="articletags[]" value="checkbox" id="articletags_0" />
                      <input type="checkbox" name="articletags[]" value="checkbox 2" id="articletags_1" />

                      </div>
                    </fieldset>
                    <footer><input type="submit" name="submit" value="Add this Article"></footer>
            . . .
                    </form>
                </div>
              </div>
            . . .
            </body>
            </html>
            <?php 
             }

             // connect to the database
             include('settings.php');

             if(count($articletags) > 0)
            {
             $articletags_string = implode(",", $articletags);
            }
             // check if the form has been submitted. If it has, start to process the form and save it to the database
             if($_SERVER['REQUEST_METHOD'] == 'POST')
             { 
             // get form data, making sure it is valid
             $articletitle = mysql_real_escape_string(htmlspecialchars($_POST['articletitle']));
             $articleorganization = mysql_real_escape_string(htmlspecialchars($_POST['articleorganization']));
             $articledate = mysql_real_escape_string(htmlspecialchars($_POST['articledate']));
             $articleurl = mysql_real_escape_string(htmlspecialchars($_POST['articleurl']));
             $articletags = implode(',', $_POST['articletags']);

            . . .

             mysql_query("INSERT articles SET articletitle='$articletitle', articleorganization='$articleorganization', articledate='$articledate', articleurl='$articleurl', articletags='$articletags' ")
             or die(mysql_error()); 

             // once saved, redirect to success page
             header("Location:addsuccess.php"); 
             }
             }
             else
             // if the form hasn't been submitted, display the form
             {
             renderForm('','','','');
             }
            ?> 
```

现在是编辑表格：

```
 <?php
             . . .
             function renderForm($id, $articletitle, $articleorganization, $articledate, $articleurl, $articletags)
             {
             ?>
            . . .
              <div class="content">
                <div id="stylized" class="myform">
                  <form id="form" name="form" action="" method="post">
                  <input type="hidden" name="id" value="<?php echo $id; ?>"/>
                    <h1>Edit Details for &nbsp; &nbsp;<?php echo $articletitle; ?></h1>
                    <table width="100%" border="0" cellpadding="6">
                      <tr align="center" valign="middle">
                        <td colspan="2"><legend>Article details</legend></td>
                      </tr>
                      <tr>
                        <td width="26%" align="right"><span class="field">Article Title</span></td>
                        <td width="74%" align="left"><span class="field">
                          <input name="articletitle" type="text" value="<?php echo $articletitle; ?>" size="50"/>
                        </span></td>
                      </tr>
                      <tr>
                        <td align="right"><span class="field">Article Author</span></td>
                        <td align="left"><span class="field">
                          <input name="articleorganization" type="text" value="<?php echo $articleorganization; ?>" size="50"/>
                        </span></td>
                      </tr>
                      <tr>
                        <td align="right"><span class="field">Article Date</span></td>
                        <td align="left"><span class="field">
                          <input name="articledate" type="text" value="<?php echo $articledate; ?>" size="50"/>
                        </span></td>
                      </tr>
                      <tr>
                        <td align="right"><span class="field">Article Url:</span></td>
                        <td align="left"><span class="field">
                          <input name="articleurl" type="text" value="<?php echo $articleurl; ?>" size="50"/>
                        </span></td>
                      </tr>
                      <tr>
                        <td align="right"><span class="field">Article Tags:</span></td>
                        <td align="left"><span class="field">
                          <input name="articletags" type="text" value="<?php echo $articletags; ?>" size="50"/>
                        </span></td>
                      </tr>
                      <tr align="center" valign="middle">
                        <td colspan="2"><input type="submit" name="submit" value="Submit" /></td>
                      </tr>
                    </table>
             . . .
                    </fieldset>
                    <footer></footer></form>
                </div>
              </div>
              <div class="footer">
            . . .
                <!-- end .footer --></div>
            </body>
            </html>
            <?php
             }

             // connect to the database
             include('settings.php');

             // check if the form has been submitted. If it has, process the form and save it to the database
             if (isset($_POST['submit']))
             { 
             // confirm that the 'id' value is a valid integer before getting the form data
             if (is_numeric($_POST['id']))
             {
             // get form data, making sure it is valid
             $id = $_POST['id'];
             $articletitle = mysql_real_escape_string(htmlspecialchars($_POST['articletitle']));
             $articleorganization = mysql_real_escape_string(htmlspecialchars($_POST['articleorganization']));
             $articledate = mysql_real_escape_string(htmlspecialchars($_POST['articledate']));
             $articleurl = mysql_real_escape_string(htmlspecialchars($_POST['articleurl']));
             $articletags = mysql_real_escape_string(htmlspecialchars($_POST['articletags']));

             . . .

             mysql_query("UPDATE articles SET articletitle='$articletitle', articleorganization='$articleorganization', articledate='$articledate', articleurl='$articleurl', articletags='$articletags' WHERE id=$id")
             or die(mysql_error()); 

            . . .
             {

             // get the 'id' value from the URL (if it exists), making sure that it is valid (checing that it is numeric/larger than 0)
             if (isset($_GET['id']) && is_numeric($_GET['id']) && $_GET['id'] > 0)
             {
             // query db
             $id = $_GET['id'];
             $result = mysql_query("SELECT * FROM articles WHERE id=$id")
             or die(mysql_error()); 
             $row = mysql_fetch_array($result);

             // check that the 'id' matches up with a row in the databse
             if($row)
             {

             // get data from db
             $articletitle = $row['articletitle'];
             $articleorganization = $row['articleorganization'];
             $articledate = $row['articledate'];
             $articleurl = $row['articleurl'];
             $articletags = $row['articletags'];

             // show form
             renderForm($id, $articletitle, $articleorganization, $articledate, $articleurl, $articletags, '');
             }
            . . .
            ?> 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-06-15T01:47:23.790

最好有两个新表来跟踪标签。

您的文章表将丢失标签字段

具有以下结构的标签表：

```
Tags Table
-----
id (int)
tagname varchar(64) 
```

具有以下结构的 ArticleHasTags 交叉映射表

```
ArticleHasTags
----
article_id (int)
tag_id (int) 
```

然后根据标签表条目构建复选框。存储文章时，您还将根据条目表单中的复选框将条目添加到 ArticleHasTags 表中。

显示编辑表单时，您从 Article 表和 ArticleHasTags 表中提取数据，或者使用多个连接，或者进行第二次选择可能更容易：

```
select * from ArticleHasTags where article_id = $id 
```

（其中 $id 是您正在编辑的文章的 ID）

然后，您再次从标签数据库中提取所有行以显示您的复选框。当您显示每个复选框时，您可以通过使用 in_array() 针对检索到的 ArticleHasTag 结果检查标签 ID 来检查文章何时具有该标签。

我可以更深入，但是我认为从长远来看，使用这些指针并自己弄清楚细节对你来说会更有价值；）

这一切都是非常程序化的，但没有光顾，这看起来就像您对现有代码的水平。受到鼓励并继续学习！你来对地方了。

# java - 如何静态检测缺少的 @Override 注释？

> ID：11043469
> 
> 赞同：10
> 
> 时间：2012-06-15T01:14:47.817
> 
> 标签：java, eclipse, oop, static-analysis, overriding

在 Java 5 和 Java 6 之间，关于源自接口（而不是超类）的方法的注释规则`@Override`发生了变化——在它们被禁止之前，但在它们被允许之后。*但是，javac不需要*它们。

某些 IDE，如 eclipse，可能会为此类丢失的覆盖生成错误或警告。我正在寻找可以检测丢失覆盖的任何类型的静态分析工具，因此我可以以编程方式报告/阻止它们。

它似乎不像我所知道的任何大的，比如 findbugs，等人可以做到 - 可能是因为`@Override`只有源保留级别，所以在这些工具运行的 .class 文件中不存在，源级别checkstyle 等工具无法理解完整的类层次结构。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-06-15T16:48:57.530

您可以在 Eclipse 中启用保存操作以自动添加缺少的 @Override 注释 - 请参阅 Window > Preferences > Java > Editor > Save Actions > Missing Code > Add missing annotations。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-03-12T03:43:34.740

您显然需要处理 Java 源代码并允许您访问代码结构和属性的东西。

我了解 Eclipse 在 JDT 中有一些解析机制，您也许可以使用它。

我们的 DMS Software Reengineering Toolkit 具有完整的 Java 源代码解析器（包括属性捕获）、全名和类型解析，以及一次读取多个源文件的能力。DMS 旨在让您构建自己的自定义分析工具，因此您可以定义您坚持属性存在或不存在的条件。

因为 DMS 还提供程序转换功能，您甚至可以定义自定义规则，以便在明确应该存在哪些属性的地方修改源代码。

DMS 和 Java 语言规则不是易学的；这需要一些努力来配置。但如果你真的有成千上万的开发人员，这笔成本就会被无法控制他们正在做什么所淹没，所以投资是有意义的。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-03-14T15:58:34.510

[JArchitect](http://www.jarchitect.com)可以通过使用 CQLinq 解决您的问题并执行这样的请求

> 从 t in Types where !t.HasAnnotation("Override") select t

当然，您可以根据需要自定义查询以添加其他条件。

# facebook - Facebook/Bit.ly 无法读取元标签

> ID：11043474
> 
> 赞同：1
> 
> 时间：2012-06-15T01:15:11.423
> 
> 标签：facebook, wordpress

突然之间，Facebook 分享在我的网站上停止工作。过去六个月一直运行顺利，FB 可以正确显示页面标题、图像和描述，但突然无法访问元标记。

此外，bit.ly 也无法读取页面标题。我看不出发生这种情况的任何原因，而且我相当确定我没有做出任何会导致这种情况发生的更改。

这是一个例子：

[http://www.newsatden.co.uk/3853-millwall-target-montgomery-can-leave-sheffield-united-for-free.html](http://www.newsatden.co.uk/3853-millwall-target-montgomery-can-leave-sheffield-united-for-free.html)

任何想法可能导致此问题？

FB 调试器说，当它尝试爬取页面时，将返回以下内容：

```
<!DOCTYPE html PUBLIC "-//W3C//DTD HTML 4.01//EN" "http://www.w3.org/TR/1999/REC-html401-19991224/strict.dtd">
<!-- <!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01//EN"
"http://www.w3.org/TR/html4/strict.dtd"> --><html>
<head>
<meta http-equiv="content-type" content="text/html; charset=utf-8">
<meta http-equiv="Refresh" content="0.1">
<meta http-equiv="Pragma" content="no-cache">
<meta http-equiv="Expires" content="-1">
<title></title>
</head>
<body><p></p></body>
</html> 
```

这些代码都没有在我的标题中，所以我真的很难过。

非常感谢任何帮助！

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-06-15T01:28:47.893

当我通过调试器运行您的 URL 时，Facebook 告诉我有一个 206 响应代码。206 代码的定义是“部分内容”。

这通常意味着您的 HTML 中有错误，而 Facebook 的解析器正在放弃。

我的猜测是它来自您的`<head>`. 把它放到一个单独的 css 文件中，看看它是否工作得更好。

您也没有任何打开的图形元标记。

# java - Java中如何处理文件到不同操作系统的路径？

> ID：11043483
> 
> 赞同：0
> 
> 时间：2012-06-15T01:16:47.633
> 
> 标签：java

我需要实现可移植代码，但我不知道如何处理不同操作系统上的不同路径约定。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-06-15T01:18:15.143

行。使用 File 类，如果你像这样传递给定的路径：

`new File("myPathInUnixOrWindows");`

您将获得一个独立于系统的文件路径。确保您导入：

`import java.io.File;`

如果您只想要路径的抽象基础，请传递一个空字符串：

`new File("");`

[http://docs.oracle.com/javase/6/docs/api/java/io/File.html](http://docs.oracle.com/javase/6/docs/api/java/io/File.html)

[http://docs.oracle.com/javase/6/docs/api/java/io/File.html#File%28java.lang.String%29](http://docs.oracle.com/javase/6/docs/api/java/io/File.html#File%28java.lang.String%29)

* * *

## 回答 #2

> 赞同：-1
> 
> 时间：2012-06-15T01:42:05.053

```
new StringBuilder(dir)
    .append(File.pathSeparatorChar)
    .append(filename)
    .toString() 
```

# jquery - 如何在 jquery 中添加弹出消息？

> ID：11043484
> 
> 赞同：0
> 
> 时间：2012-06-15T01:17:08.517
> 
> 标签：jquery

我有1个问题..我必须拖放一个图像..然后在拖放后获取图像的位置...然后，当我拖动它并获取位置时，我需要使用jquery显示一条弹出消息。 。谁能帮我？请给我看演示和清晰的解决方案，因为我是 jquery 的新手..谢谢你们！

这是我的 dra,drop n get coordinate..now 代码，我想在获取位置后添加弹出消息..在弹出消息中，我想添加 --> 命名您的位置并可以保存在数据库。

这是我的代码：

```
 $('#dragThis').draggable({
    cursor: 'move',        // sets the cursor apperance
    containment: '#dragThis2',
    drag: function() {
    var offset = $(this).offset();
    var xPos = Math.abs(offset.left);
    var yPos = Math.abs(offset.top);
    $('#posX').text('x: ' + xPos);
    $('#posY').text('y: ' + yPos);
    },
   stop: function(event, ui) {
    $(document).ready(function() { 
    $('#dragThis').click(function() { 
    $.blockUI({ message: $('#loginForm') }); 
    setTimeout($.unblockUI, 2000); 

   }); 
    }); 

    // Show dropped position.

    var Startpos = $("#dragThis").position();
    var Stoppos = $(this).position();
    $("#dragThis").val((Stoppos.left - Startpos.left));
    var left = Math.abs(Stoppos.left);
    var top = Math.abs(Stoppos.top);

    $('#posX').text('left: ' + left);
    $('#posY').text('top: ' + top);

}

}); 
```

这是带有 xy 坐标的图像的图片，我希望当图像以任何方式拖动然后放下时，会出现一个弹出消息...怎么办？？请帮忙....

![在此处输入图像描述](../Images/2286b098af119cab75eab9c93df416bd.png)

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-06-15T01:47:29.800

如果您使用 jQuery UI 和它们的[Dialog](http://jqueryui.com/demos/dialog/)行为，您可能会更喜欢结果，但如果这不是一个选项，或者是矫枉过正，那么创建和绝对定位一个元素是非常简单的。

这是一个示例，当您单击页面中心的链接时，会在视口中大致居中显示带有消息的 DIV：http: [//jsfiddle.net/HackedByChinese/ZxCUb/5/](http://jsfiddle.net/HackedByChinese/ZxCUb/5/)

# c++ - C++ 编译器对齐 - 只是字符没有填充

> ID：11043486
> 
> 赞同：1
> 
> 时间：2012-06-15T01:17:29.283
> 
> 标签：c++, visual-c++, compiler-construction, padding, memory-alignment

在 VC++ 上，为什么编译器只在使用非 char 数据类型时填充结构？

IE

```
struct TEST
{
   char a[7];
};

struct TEST2
{
   __int32 a;
   char b[7];
};

sizeof(TEST); // Returns 7
sizeof(TEST2); // Returns 12 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-06-15T01:36:45.837

归根结底是`sizeof(char) == 1`——总是。

数组必须是连续的，因此在 char 数组中（如果它足够大），您最终会得到每个可能对齐的元素。由于编译器/硬件*必须*使其工作，因此*不需要*插入填充来处理`char`类似的事情`struct`。

现在，这并不是说编译器*不能*插入填充。例如，即使使用 char 数组，它也可以通过这样做来提高性能。例如，根据您的`struct`定义，编译器完全可以接受 7 个字符的数组再填充一个以使 struct 的大小为 8 - 2 的漂亮、简洁的幂。

在某些硬件上，您可能会看到这一点。碰巧的是，VC++ 支持的英特尔硬件并没有真正从这样的事情中受益，所以你不太可能在那里看到它。

# html - 当某些元素存在时向下推元素

> ID：11043489
> 
> 赞同：2
> 
> 时间：2012-06-15T01:17:56.630
> 
> 标签：html, css, css-float, positioning

我对表单中的一组字段进行了一些标记：

```
<ul>
  <li>
    <label>Field label</label>
    <ul>
        <li>
            <span>
                <label>some label</label>
                <input type="text" value="a" size="35" maxlength="35">
            </span>
        </li>    
        <li>
            <span>
                <label>some label</label>
                <input type="text" value="b" size="35" maxlength="35">
            </span>
        </li>
        <li>
            <span>
                <label>some label</label>
                <input type="text" value="c" size="35" maxlength="35">
            </span>
        </li>
    </ul>
  </li>
</ul> 
```

还有一些 CSS 来定位它们：

```
*{
    position: relative;
}

span{
    position: relative;
    display: inline-block;

}

input{
    float:left;
}

label{
    float:left;
    margin-top: 15px;
    left: 70px;
}

li > ul{
    margin-left: -100px;
    max-width: 400px;
    display: inline-block;
}

li > label{
    float: left;
    vertical-align: top;
    margin: 0;
    left: 0;
    width: 120px;
    display: inline-block;
} 
```

这导致了这种布局，非常适合我的需要： ![在此处输入图像描述](../Images/f5dbc71315547389c39e1ee7a33fa817.png)

问题：当某些字段填写不正确时，系统会生成错误消息，导致标记如下：

```
<ul>
  <li>
    <label>Field label</label>
    <ul>
        <li>
            <span>
                <label>some label</label>
                <div class="error">some error message.</div>
                <input type="text" value="a" size="35" maxlength="35">
            </span>
        </li>    
        <li>
            <span>
                <label>some label</label>
                <div class="error">some error message.</div>
                <input type="text" value="b" size="35" maxlength="35">
            </span>
        </li>
        <li>
            <span>
                <label>some label</label>
                <div class="error">some error message.</div>
                <input type="text" value="c" size="35" maxlength="35">
            </span>
        </li>
    </ul>
  </li>
</ul> 
```

这会导致这样的结果：

![在此处输入图像描述](../Images/c4ef5ba51599e2478e0288938c217303.png)

相反，我希望错误消息显示如下：

![在此处输入图像描述](../Images/e6f383df4293620a8b434f2286384ffe.png)

我已经尝试使跨度内的标签绝对定位，然后与跨度的底部对齐。但是，由于某种原因，即使我给标签 a ，它也总是被文本输入重叠`margin-top`。

插入错误消息后，如何使表单看起来像所需的布局？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-06-15T02:56:50.977

为了使标签始终显示在文本输入下方，无论是否存在错误消息，我都建议采用以下方法：

1.  将标签放置在跨度的底部。
2.  在输入的底部添加边距，以将跨度增大到足以包含标签。

这是一个简化的示例来说明该技术：

HTML：

```
 <span>
      <label>some label</label>
      <div class="error">some error message.</div>
      <input type="text" value="a" size="35" maxlength="35">
  </span> 
```

CSS：

```
span{
  display: block;
  position: relative;
}

label {
  position: absolute;
  bottom: 0px;
}

input {
  margin-bottom: 20px;
} 
```

[http://jsfiddle.net/fuEqB/](http://jsfiddle.net/fuEqB/)

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-06-15T01:36:33.123

只需使用 float left 并重新排列 html 中的元素：

```
ul {
    padding: 0;
}

li {
    display: block;
}

.form-label {
    float: left;
    padding-right: 20px;
}

label {
    display: block;
}

ul ul {
    float: left;
}

.error {
    color: red;
} 
```

[http://jsfiddle.net/ysv8E/embedded/result/](http://jsfiddle.net/ysv8E/embedded/result/)

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-06-15T02:42:52.647

不确定我是否正确阅读了这篇文章，但是...

margin-top 不适用于具有 position:absolute 的孤立元素，因为绝对定位的元素不是常规流布局的一部分。上边距没有什么可反对的。

具有 position:absolute 的元素也不会导致在常规流布局中使用额外的垂直空间，这就是为什么它们出现在输入上方而不是下方的原因。

如果您必须使用 position:absolute，则必须安排另一种方式以将额外的垂直空间添加到布局中。使用 CSS，您可以隐藏和显示没有 position:absolute 的不可见元素（除了隐藏和显示错误消息），或者您可以在显示错误消息时增加每个表单元素之间的边距或填充。但可能有一种更简单的方法（使用较少的绝对位置）。

# php - 使用 Open Graph 检测用户是否“阅读”了一篇文章

> ID：11043491
> 
> 赞同：1
> 
> 时间：2012-06-15T01:18:13.803
> 
> 标签：php, facebook-php-sdk, facebook-opengraph, facebook-javascript-sdk

好的，所以我读了这篇文章“http://facebook.stackoverflow.com/questions/10373897/deleting-a-previosly-posted-article-with-opengraph-or-check-if-said-article-has”但我m 使用 news.reads 动作类型。

因此，在网站上，当用户使用 Facebook 登录并授予发布权限时，他们阅读的每篇文章都会被推送到他们的时间线。`facebook.php`一切都很好，直到他们刷新/重新访问发出a的同一篇文章`Fatal error: Uncaught OAuthException: (#3501) User is already associated to the article object on a unique action type Read. Original Action ID: XXXXXXXXXXXXXXXX`

我很好，内置的 news.reads OG 存在一个错误，它是独一无二的，但我想知道是否有办法检测用户是否已经阅读/查看过它。

* * *

就像是：

```
if (user is logged in [$user]) {
    if (user hasn't read article) {
        $facebook->api(/me......);
    } else if (user has read the article) {
        // Do Nothing
    }
} else { // If not logged in
    echo "login";
} 
```

`<html>`希望这是可能的，否则如果没有 facebook.php 停止正在处理的页面的其余部分（在标签之前），我/用户无法再次查看页面，这将是一个彻底的遗憾。

**注意：**我更喜欢 PHP SDK，但更愿意使用 JS。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-06-15T11:35:00.293

无论如何，您*应该*已经将用户*foo*已阅读文章*栏*的信息存储在您的数据库中——因为阅读操作的批准要求要求您为用户提供一种简单的方法来再次取消发布此操作。

# android - H264基本流格式混淆

> ID：11043505
> 
> 赞同：3
> 
> 时间：2012-06-15T01:20:52.130
> 
> 标签：android, video-streaming, h.264, mp4

我对 H264 视频流的格式感到困惑。简而言之，我从 ISO 规范和其他来源中读到 H264 NAL 单元由起始代码分隔并且不包含长度信息**，**并且它们**没有**起始代码并且由 4 个字节引导（我知道这可能会有所不同) 给出 NAL 单元的长度。为了让事情更加混乱，我一直在查看[Spydroid](http://code.google.com/p/spydroid-ipcamera/)中的代码，它似乎可以解决这两种情况。是否有两种不同的格式我混淆了，如果有的话，任何人都可以指导我了解解释这两种格式的信息。

## 背景

为了提供一些背景信息，以防它有助于我从 Android 相机进行实时流式传输。流将在 RTP 设备上拆分或作为原始 MP4 数据发送以在服务器上拆分。无论哪种方式，流都将是实时的，因此将没有 MOOV 信息来查找音频和视频帧。我相信我已经弄清楚了该项目的大部分内容，但我基本上对我应该在 H264 流中看到的内容感到困惑。如果长度确实包含在 NAL 单元中，那肯定会对我有所帮助。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-06-15T18:57:32.343

就 H.264 比特流而言。它被分成 NAL 单元，由 startcode 前缀分隔。IE

```
startcode_prefix  NALUnit    startcode_prefix  NALUnit ..... 
```

其中没有长度信息，因为它是比特流。您必须在比特流中寻找下一个 NAL 单元的起始码模式（0x000001 或 0x00000001）。

此处的更多信息：[H264 解析 - 切片标头检测](https://stackoverflow.com/questions/10612893/h264-parsing-slice-header-detection)

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-06-16T04:24:39.867

根据以下链接，有 H.264 子类型。有些在流中有起始码，有些则有 1、2 或 4 字节长度字段。

[http://msdn.microsoft.com/en-us/library/windows/desktop/dd757808(v=vs.85).aspx](http://msdn.microsoft.com/en-us/library/windows/desktop/dd757808(v=vs.85).aspx)

所以看起来我需要检查子类型以确定如何解析流。

# android - 启动任何已安装的活动

> ID：11043506
> 
> 赞同：0
> 
> 时间：2012-06-15T01:20:54.393
> 
> 标签：android, android-activity, android-intent, launcher

这是我搜索任何启动活动问题的第一个问题，但没有一个对我有用（android 4.0.4），但对其他人有用。

我已经有手机中每个已安装活动的列表，但我无法启动它们

```
ComponentName cm= new ComponentName("com.sonyericsson.extras.liveview","com.sonyericsson.extras.liveview.LAUNCH");
intent.setComponent(cm);
startActivity(intent); 
```

该代码对我来说失败“无法找到明确的活动......”，常量字符串可能会因选择而异，无论如何这不起作用，这里也没有其他解决方案。Logcat 说也许我没有在 manifest.xml 中声明该活动，但我当然没有，我想像 ADW 启动器一样启动任何活动，也尝试使用来自 ADW 源的代码但没有工作。提前致谢

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-06-15T01:25:35.270

尝试改用这个

```
String app = "com.sonyericsson.extras/liveview";
Intent intent = new Intent(Intent.ACTION_MAIN);             
intent.setComponent(ComponentName.unflattenFromString(app));             
intent.addCategory(Intent.CATEGORY_LAUNCHER);             
startActivity(intent); 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-06-15T05:38:45.993

尝试

```
Intent intent = new Intent(Intent.ACTION_VIEW);
intent.setClassName("com.sonyericsson.extras.liveview", "com.sonyericsson.extras.liveview.LAUNCH");
startActivity(intent); 
```

我相信包的名称是可以的，但活动名称都是大写的伤害了我：|，但试着让我知道它是否适合你。

# python - Django登录不起作用

> ID：11043508
> 
> 赞同：3
> 
> 时间：2012-06-15T01:21:11.383
> 
> 标签：python, django, django-admin, django-authentication

我在这里有一个非常奇怪的问题。我现在正在使用我的本地开发服务器，并且正在处理我网站的用户帐户方面。

我以为我已经解决了，但是当我尝试访问`@login_required`视图时，我填写了登录信息，并且每次都被重定向回登录页面。当我尝试登录管理站点（以验证后端的一切正常）时，同样的事情发生了：我输入了正确的用户名和密码，然后被重定向回登录页面。

我通过 shell 验证了我用于管理站点的用户名是超级用户，是员工，并且是活动的。在我的设置中，我启用了中间件，以及在`Authentication`我安装的应用程序中。有任何想法吗？提前致谢！`Session``django.contrib.auth``django.contrib.sessions`

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-06-15T07:14:22.077

我明白了——我已经在我的 settings.py 中设置`SESSION_COOKIE_SECURE`了`True`，但是由于我使用的是开发服务器 SSL 未启用，它只会重定向到同一页面。感谢您让我四处寻找的帮助。

# php - php缩放图像裁剪

> ID：11043509
> 
> 赞同：0
> 
> 时间：2012-06-15T01:21:12.883
> 
> 标签：php, jquery, gd

我的文件系统上有一个图像。我使用裁剪工具将其显示在页面上，但我将其缩小以适合裁剪工具区域（如果图像小于该区域，则将其拉伸以占据整个区域）。在此页面上，用户将选择要保留的照片区域（使用 jcrop）并提交。

在后端，我将等待上一页的坐标。我将得到 x1、x2、y1、y2、w 和 h。

问题是调整大小的图像（显示给用户的图像）上的坐标在全尺寸图像上并不容易使用，因为它们要么占小于图像的区域（它被缩小以适合屏幕）或者它会比图像大（它被拉伸以适应屏幕）。

我可以获得原始照片的高度和宽度以及它被强制进入的静态宽度和高度。

给定已知尺寸，您将如何找到图像的正确区域？

我当前的代码在这里

```
$target_width = 150;
$target_height = 150;
$jpeg_quality= 90;
$tmp =explode('/',$_POST['filename']); 

$src = '../uploads/'.$tmp[count($tmp)-1];

$x1 = $_POST['x1'];
$x2 = $_POST['x2'];
$y1 = $_POST['y1'];
$y2 = $_POST['y2'];
$w = $_POST['w'];
$h = $_POST['h'];

$image = imagecreatefromjpeg($src);
$final = imagecreatetruecolor($target_width, $target_height);

imagecopyresampled($final, $image, 0, 0, $x1, $y1, $target_width, $target_height, $w, $h);
imagejpeg($final, $src, $jpeg_quality); 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-06-15T04:54:54.937

也许我的问题不是很清楚（我也很难向某人解释 IRL），但我的回答应该很清楚。

我的文件系统上有一个图像（路径可在 $_POST['image_path'] 获得）和一个看起来像“”的图像标签。我使用一些 jquery 魔法从图像标签中获取了数据。

“比例”就是答案。
h_limit是img标签的高度约束 w_limit是img标签的宽度约束

```
$h_limit = $_POST['h_limit'];
$w_limit = $_POST['w_limit'];

list($width, $height) = getimagesize($_POST['image_path']);
$w_mult = $width/$w_limit;
$h_mult = $height/$h_limit; 
```

然后我可以做

```
imagecopyresampled($final, $image, 0, 0, $x1*$w_mult, $y1*$h_mult, $target_width, $target_height, $w*$w_mult, $h*$h_mult); 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-06-15T02:13:34.047

我不确定为什么显示大小不同，但你不能只跟踪浏览器中的显示大小（我不知道这是否在你的代码中得到修复，所以一些 javascript 和额外的表单字段可能是必要）然后，在 PHP 中，首先调整到该大小，然后裁剪

原始图像--->调整到用户在浏览器中看到的大小--->根据用户提供的坐标裁剪

# cocoa - 激活时，菜单栏应用程序中的关于面板不在最前面

> ID：11043512
> 
> 赞同：2
> 
> 时间：2012-06-15T01:22:39.157
> 
> 标签：cocoa, nsapplication, nspanel

我有一个位于菜单栏中的应用程序，没有主菜单或停靠图标。我有一个触发按钮`[NSApp orderFrontStandardAboutPanel:sender];`。单击该按钮时，有时“关于”面板会位于最前面。然而，其他时候，关于面板打开，但在其他正在运行的应用程序窗口后面（要清楚，在其他应用程序的窗口后面，而不是在我的菜单栏弹出窗口后面）。我什至不确定从哪里开始调试这个 - 有什么建议吗？

谢谢。

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-06-15T01:33:32.677

```
NSApplication *app = [NSApplication sharedApplication];
[app activateIgnoringOtherApps:YES];
[NSApp orderFrontStandardAboutPanel:sender]; 
```

请尝试上面的代码。

# c++ - 使用 Dev-C++ 5.2.0.2 进行调试 - 调试时找不到程序文件 gdb.exe

> ID：11043516
> 
> 赞同：0
> 
> 时间：2012-06-15T01:22:55.530
> 
> 标签：c++, debugging, gdb, dev-c++

我在 32 位 Windows XP 上使用 Orwell Dev-C++ 5.2.0.2。编译器是 TDM-GCC 4.6.1 32 位。每当我按 F8 进行调试时，都会出现一个错误框，上面写着：

```
Error with debugging process : could not find program file gdb.exe. 
```

按 Enter 键，会出现另一个错误框，其中显示：

```
Error with debugging process : CloseHandle - gdb process 
```

然后调试过程停止。我无法调试。我检查了 C:\Dev-Cpp\bin 中是否存在 gdb.exe。为什么找不到？任何人都可以帮忙吗？谢谢！

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-06-15T01:25:27.640

您应该将 C:\Dev-Cpp\bin 添加到 PATH 环境变量中。

方法如下：http: [//java.com/en/download/help/path.xml](http://java.com/en/download/help/path.xml)

* * *

## 回答 #2

> 赞同：-1
> 
> 时间：2012-06-15T01:25:37.637

您需要在 PATH 中包含 C:\Dev-Cpp\bin 才能使其正常工作。

# plone - 如何使用 plone.indexer 添加自定义 Zope2 目录索引？

> ID：11043521
> 
> 赞同：1
> 
> 时间：2012-06-15T01:23:25.173
> 
> 标签：plone, zope, catalog

我正在尝试根据此处的建议添加自定义目录索引：

*   [http://collective-docs.readthedocs.org/en/latest/searching_and_indexing/indexing.html#custom-index-methods](http://collective-docs.readthedocs.org/en/latest/searching_and_indexing/indexing.html#custom-index-methods)

[我的代码](https://github.com/aclark4life/event_days_indexer)如下所示（h/t: supton）：

```
from plone.indexer.decorator import indexer
from Products.ATContentTypes.interfaces.event import IATEvent
from Products.ATContentTypes.utils import DT2dt

@indexer(IATEvent)
def event_days(context, **kw):
    start = DT2dt(context.getStartDate())
    end = DT2dt(context.getEndDate())
    delta = end - start
    return delta.days 
```

在以下 ZCML 注册：

```
<configure
    xmlns="http://namespaces.zope.org/zope"
    xmlns:five="http://namespaces.zope.org/five"
    xmlns:genericsetup="http://namespaces.zope.org/genericsetup">

    <five:registerPackage package="." initialize=".initialize" />

    <genericsetup:registerProfile
        description="event_days_indexer"
        directory="profiles/default"
        name="default"
        provides="Products.GenericSetup.interfaces.EXTENSION"
        title="event_days_indexer"
    />

    <adapter name="event_days" factory=".indexers.event_days" />

</configure> 
```

一切似乎都加载得很好，但是当我创建一个测试事件并重新索引目录时，索引仍然是空的。我错过了什么？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-06-15T05:32:46.490

如果索引器遇到 AttributeError，则不会考虑将对象作为索引。

在这种情况下发生这种情况是因为 ATContentTypes 为 startDate 和 endDate 字段指定了自定义访问器。使用 context.start() 和 context.end() 代替 context.getStartDate() 和 context.getEndDate()

# objective-c - Xcode - 如何使用项目模板创建简单的 Objective-C 应用程序？

> ID：11043523
> 
> 赞同：0
> 
> 时间：2012-06-15T01:23:53.003
> 
> 标签：objective-c, xcode, cocoa

我想在 Xcode (4.2) 中创建一个新项目，但我不需要任何花哨的窗口或 iOs 模板，只需要一个简单的独立项目（可能带有自动生成的 main()），我可以在其中构建一些类和运行简单的测试。

是不是最适合这个`Cocoa Application`下的模板？`Mac OS X`

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-06-15T01:27:59.350

如果您只想要一个简单的、无 ui 的控制台应用程序来测试类，只需使用`Console Application`. 它有`main.m`，而且很少。但是，如果您想要完全空的东西，在`Other`模板类别下，有一个名为`Empty`.

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-06-15T01:34:11.450

Cocoa Application 将仅使用 Application 菜单创建一个项目……也许这正是您所需要的。

# php - 如何获得 Facebook 帖子的所有评论和点赞？

> ID：11043527
> 
> 赞同：1
> 
> 时间：2012-06-15T01:25:05.780
> 
> 标签：php, facebook, facebook-like, facebook-comments

如果您有`read_stream`权限并且您获得了 facebook 用户的帖子，那么对于每个帖子，您只会获得前 X 条评论和前 X 条喜欢。有没有办法对喜欢/评论进行分页并全部获取？

如果有任何 FQL 查询可以返回帖子的所有喜欢或评论，或者让我一次翻阅 20 次左右，那也可以。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-06-15T01:47:39.817

编辑：

您必须获得每个状态才能获得对该状态的所有评论/喜欢。如果您有想要评论的特定帖子：

```
$post     = '100003978045030_105596009583000';
$comments = array();
$done     = false;
$options  = array();
$path     = '/' . $post . '/comments';

while(!$done){
    try{
        $data = $facebook->api($path, 'GET', $options);
    } catch(FacebookApiException $e) {
        echo $e->getMessage();
        $data = null;
        $done = true;
    }
    if(!is_null($data)){
        $comments = array_merge($comments, $data['data']);
        if(isset($data['paging']['next']) && !empty($data['paging']['next'])){
            $parts = parse_url($data['paging']['next']);
            $path  = $parts['path'];
            parse_str($parts['query'], $options);
        } else {
            $done = true;
        }
    }
}

print_r($comments); 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-06-15T02:01:10.660

在 FQL 中，您只需查询[评论](https://developers.facebook.com/docs/reference/fql/comment/)或点[赞](https://developers.facebook.com/docs/reference/fql/like/)表：

```
SELECT post_id, text, fromid FROM comment 
   WHERE post_id IN 
      (SELECT post_id FROM stream WHERE source_id = USER_OR_PAGE_ID
       AND comments.count > 0 )
   LIMIT 0, 100 
```

这将为您提供前 100 个结果（但可能会返回少于 100 个，因为您不可见的将被过滤掉）。

请注意，对于页面流，like 表是蹒跚的。

# vim - 在 vim 中就地编辑文件

> ID：11043534
> 
> 赞同：6
> 
> 时间：2012-06-15T01:26:20.367
> 
> 标签：vim

通常，您实际上不会在 vim 中编辑文件。如果您运行`vim foo`、编辑、写入和退出，vim会取消链接`foo`并创建一个新文件和一个名为`foo`. 但是，如果文件有多个链接，则`vim`实际修改文件。例如：

```
$ ls -i foo
19428852 foo
$ vi foo
$ ls -i foo
19428857 foo
$ ln foo bar
$ vi bar
$ ls -i bar
19428857 bar 
```

我一直在寻找一种实际编辑文件的方法，似乎有两种选择。使用`ed`，或使用`vim`但确保在我编辑之前至少有两个指向该文件的链接。我想这个问题是学术性的，因为如果只有一个链接，vim 创建一个新文件并不重要，如果在编辑过程中创建链接，vim 似乎做了正确的事情，但我很好奇：

是否可以让 vim 始终编辑文件，而不是创建新文件？

* * *

## 回答 #1

> 赞同：11
> 
> 时间：2012-06-15T01:40:49.437

查看该`backupcopy`选项的帮助，尤其是有关的注释`crontab`。简短的回答是

```
:set backupcopy=yes 
```

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-06-15T01:44:01.357

快速谷歌显示此链接 -[编辑文件的硬链接](http://vim.wikia.com/wiki/Editing_a_hard_link_to_a_file)。控制它的命令是

```
set backupcopy=auto,breakhardlink 
```

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2012-11-09T12:18:44.277

诀窍是告诉 Vim 使用备份文件以允许安全地覆盖原始文件，否则 Vim 将写入一个新文件然后重命名它以替换原始文件。

然后告诉 Vim 将备份文件写入任何地方。这样，常规的写入命令将失败，并且必须强制写入。

```
:set noswapfile
:set backupcopy=yes
:set backupdir=''
:e big
(hit Crtl-C to stopo line count and syntax highlight)
(edit the file)
:w! 
```

为了真正了解文件系统级别的情况，我使用了 inotify 工具：

```
inotifywait -m -r /path/to/my_test_dir/ 
```

但要小心，这对于非常大的文件效果不佳，例如，我试图用这种方法编辑一个 10G 的文件，最终得到一个 1.5GB 的截断文件，其余数据丢失。Vim 最终使用了将近 2GB 的 RAM ......

其他选择是使用 MMap 函数，例如。在 Python 命令行中。

# java - 确认 Java LinkedList "foreach" 循环

> ID：11043536
> 
> 赞同：6
> 
> 时间：2012-06-15T01:26:42.597
> 
> 标签：java, for-loop, foreach, containers

再会，

有人可以确认这篇文章底部所说的[java - 迭代链接列表](https://stackoverflow.com/questions/4767615/java-iterating-a-linked-list) 该文章提到您可以使用**for(char c:linkedlistofchars)**语法，它仍然是 O(n)。我会认为访问一个看起来像这样的列表......

```
a b c d e f 
```

实际上会在 for 循环的每次迭代期间从链表的开头开始运行，就像这样......

```
a ab abc abcde abcdef 
```

导致访问时间不是 O(n)。

这究竟是如何工作的？*数组和数组运算符是有意义的，但是 java 语法如何知道如何使用 java 中的foreach*循环遍历链表？

我认为 LinkedList 数据结构只是一个附加库，而不是核心语言语法的一部分。（我确实意识到 LinkedList 类在 java 中是标准的）

我希望我足够清楚地解释了我的担忧....谢谢

* * *

## 回答 #1

> 赞同：11
> 
> 时间：2012-06-15T01:52:04.987

首先，任何实现类的实例`Iterable`都可以在 foreach 循环中使用。原因是编译后，`for (Suit suit : suits)`实际上变成了`for (Iterator i = suits.iterator(); i.hasNext(); )`. 有关更多详细信息，请参阅[此说明](http://docs.oracle.com/javase/1.5.0/docs/guide/language/foreach.html)。

集合实现优化的迭代器，特定于数据结构。具体来说`LinkedList`，迭代器保留一个指向最后返回对象的指针，以允许恒定的时间`next()`和`previous()`操作。因此，使用 foreach 循环遍历链表将产生 O(n) 时间复杂度。您可以查看源代码以获取更多详细信息。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-06-15T01:37:51.463

此链接上的代码示例[演示了差异](http://javahowto.blogspot.com/2006/06/3-ways-to-traverse-list.html)。该链接上的 OP 是错误的：`list.get(i)`每次调用都会从列表的开头开始，然后计数直到`i`到达，而 a`iterator.next()`会保存你在列表中的位置，所以每次调用它只需要读取下一个值，而不是 0 和 n 之间的所有值。

# javascript - 创建一个“下拉”div

> ID：11043548
> 
> 赞同：2
> 
> 时间：2012-06-15T01:28:22.330
> 
> 标签：javascript, css

我正在寻找一种使用 Javascript/CSS 制作“下拉”div 的方法。基本上，我希望我的用户拖动一个 HTML 元素并让另一个 Div 使用类似 jQuery 的“slideDown”效果的东西，但它与他们拉另一个 Div 的位置直接相关。这有任何意义吗？

因此，如果他们将“拉我”Div 仅拉到屏幕的一半，则第二个 Div 仅可见一半。从本质上讲，拉下窗户上的窗帘……我想要那种效果，但我似乎在任何地方都找不到。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-06-18T01:51:57.003

我认为这篇文章有你正在寻找的东西。

[有人知道javascript中的下拉菜单插件吗？](https://stackoverflow.com/questions/8749921/does-anyone-know-of-a-pulldown-menu-plugin-in-javascript)

[http://jsfiddle.net/JXeWA/46/](http://jsfiddle.net/JXeWA/46/)

# node.js - 在活动页面上更改 html 状态类的最佳方法

> ID：11043553
> 
> 赞同：0
> 
> 时间：2012-06-15T01:28:54.053
> 
> 标签：node.js, towerjs

我正在测试 2 个示例项目，一个仅使用 express，另一个使用 tower.js

我只想在页面渲染开始时将正确的 css 类放在活动页面的 li 上。

前任：

我在页面/信息中，我想在第一个 li 上添加活动的类

*   信息*   其他

我使用的模板引擎是Coffekup / Jade

我试图获取url路径并与href进行比较，通过locals传递......但我认为通过locals传递不是一个好的解决方案..

有更好的解决方案吗？

谢谢。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-06-15T19:50:04.853

这个答案适用于 towerjs 和 coffeekup。我没有足够的快递和玉石经验来谈论它。

在 coffeekup 中，将属性（如 css 类）放在 html 标签上的正确方法是使用哈希，即`attributeName: atrributeValue`. 一个例子，来自处理主要布局的 tower.js 模板，它是`app/views/layouts/application.coffee`：

```
 nav id: "navigation", class: "navbar", role: "navigation", ->
      div class: "navbar-inner", ->
        div class: "container", ->
          partial "shared/navigation" 
```

看，这里我们有三层标签，一个带有 div 嵌套在其中的 nav，另一个 div 嵌套在其中，然后是要在其中呈现的内容的部分。而不是部分，它可以很容易地是文本。

所以，在你的情况下，你会进入`app/views/info`并找到正确的模板，其中包含你想要放置类的 li，那么它就是

```
li class: "active", -> 
```

现在，如果您正在谈论更改 li 上的 css 类，一旦它已经被动态呈现，您需要从客户端代码执行此操作，并且您可以使用 coffeescript 来执行此操作，就像您使用 javascript在普通的 html 页面中。

如果你正在尝试学习 tower 和 coffeekup（现在实际上是 coffeecup），我真的推荐[https://github.com/mark-hahn/coffeekup-intro](https://github.com/mark-hahn/coffeekup-intro)。你可以在不到半小时的时间内完成它，并且对coffeecup有一个很好的了解。如果您想查看带有说明的 Towerjs 应用程序示例，可以在此处查看我的 demoApp：[https](https://github.com/edubkendo/demoApp) ://github.com/edubkendo/demoApp 。

编辑：现在我明白了回答这个问题：

首先，`config/assets.coffee`在第一个块中，`"/app/client/controllers/applicationController"`像这样添加：

```
module.exports =
  javascripts:
    application: [
      "/app/client/config/application"
      "/config/routes"
      "/app/views/templates"
      "/app/models/user"
      "/app/client/controllers/usersController"
      "/app/models/post"
      "/app/client/controllers/postsController"
      "/app/client/controllers/applicationController"
] 
```

然后，在您的客户端控制器中，`app/client/controllers/applicationController.coffee`：

```
class App.ApplicationController extends Tower.Controller

  pathname = window.location.pathname

  pathRegExp = new RegExp(pathname.replace(/\/$/,'') + "$")

  $('.navbar a').each(->
    if (pathRegExp.test @href.replace(/\/$/,''))
      $(@).addClass('active')
    ) 
```

现在，这会将活动类添加到当前活动的链接中。

# mysql - mysql计算5天指数移动平均线

> ID：11043555
> 
> 赞同：0
> 
> 时间：2012-06-15T01:30:04.867
> 
> 标签：mysql, exponential

我有以下查询计算 5 天简单移动平均线。我想将查询更改为 5 天指数移动平均线

```
DROP TABLE IF EXISTS t; 
CREATE TABLE t (id int,item int, dt DATE, qty INT); 
INSERT INTO t VALUES 
(1,1,'2007-1-1',5), 
(2,1,'2007-1-2',6), 
(3,1,'2007-1-3',7), 
(4,1,'2007-1-4',8), 
(5,1,'2007-1-5',9), 
(6,1,'2007-1-6',10), 
(7,1,'2007-1-7',11), 
(8,1,'2007-1-8',12), 
(9,1,'2007-1-9',13), 
(10,2,'2007-1-1',6), 
(11,2,'2007-1-2',7), 
(12,2,'2007-1-3',8), 
(13,2,'2007-1-4',9), 
(14,2,'2007-1-5',10), 
(15,2,'2007-1-6',11), 
(16,2,'2007-1-7',12), 
(17,2,'2007-1-8',13), 
(18,2,'2007-1-9',14); 

SELECT  
t1.id,t1.item,t1.dt,t1.qty,
( SELECT SUM(t2.qty) / COUNT(t2.qty) 
  FROM t AS t2 
  WHERE t1.id - t2.id =4 
) AS '5daySMA' 
FROM t AS t1 
GROUP BY t1.item,t1.dt; 
```

查询应该是什么？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-03-04T21:56:39.903

我对此的抨击：

```
select dt,
  @a := ( @a*.667 + qty*.333)  AS moving_avg
from t
Join (select @a := 0) as X
order by dt desc 
```

.333 是 k = 2/(N+1) 其中 N 是 5 天周期

.667 是 (1-k)，如 EMA 公式所示

EMA = 价格(t) * k + EMA(y) * (1 – k)

@a := 0 部分应该改为合理的 # 否则开头会有偏差

源自此讨论，因此您可以在此处查找更多详细信息 [http://grokbase.com/t/mysql/mysql/127gbqzkyj/trouble-with-average](http://grokbase.com/t/mysql/mysql/127gbqzkyj/trouble-with-average)

# asp.net - 在 web.config 中管理配置

> ID：11043556
> 
> 赞同：3
> 
> 时间：2012-06-15T01:30:15.410
> 
> 标签：asp.net, deployment, configuration, web-config

我有一个 asp.net 网络应用程序。我想单独分离出一个特定的部分，例如 appsettings 并将它放在一个单独的配置文件中。如何管理 asp.net 应用程序的 2 个配置文件？根据示例，仅 appsettings 在部署期间出现。我可以将此部分添加到 web.config 并拥有 1 个配置文件，或者将 appsettings 部分作为单独的文件。有什么干净的方法吗？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-06-15T01:49:49.090

是的，您可以从 web.config 中提取部分。例如，对于连接字符串，假设您有

```
<?xml version="1.0"?>
<configuration>
  <connectionStrings>
    <add name="MyEntities" connectionString="my connection string" providerName="System.Data.EntityClient" />
  </connectionStrings>
</configuration> 
```

您可以将连接字符串部分分成单独的文件。所以你的 web.config 变成

```
<?xml version="1.0"?>
<configuration>
  <connectionStrings configSource="ConnectionString.Config" />
</configuration> 
```

ConnectionString.Config 文件将有

```
<connectionStrings>
  <add name="MyEntities" connectionString="my connection string" providerName="System.Data.EntityClient" />
</connectionStrings> 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-06-15T03:36:35.483

在您的 web.config 文件中，将您的 appsettings 部分替换为以下内容：

```
<appSettings file="settings.config">
 </appSettings> 
```

并创建一个包含所有应用设置的新配置文件“settings.config”，请参见下面的示例：

```
<appSettings>
 <add key="Setting1" value="This is Setting 1" />
 <add key="Setting2" value="This is Setting 2" />
 <add key="ConnectionString" value="This is a ConnectString" />
</appSettings> 
```

# php - 如何实现 MySQLi 嵌套准备语句？

> ID：11043558
> 
> 赞同：0
> 
> 时间：2012-06-15T01:30:18.740
> 
> 标签：php, mysql, mysqli

我正在尝试将 MySQL 转换为 MySQLi。我不知道为什么它会刹车

```
$stmt2->execute(); 
```

并返回错误：

> `Call to a member function execute() on a non-object`

有任何问题或有效实施它！？

```
// SQL condition "WHERE group=''" where `group` is empty (NULL)
$result = "SELECT id, name FROM table WHERE group='' ORDER BY array ASC";

if ($stmt = $mysqli->prepare($result)) {
    $stmt->execute();
    $stmt->bind_result($id, $name);

    while ($stmt->fetch()) {
        // SQL condition "WHERE group='$id'" where $id defined in $stmt->bind_result($id, $name);
        $result2 = "SELECT name FROM table WHERE group='$id' ORDER BY array ASC";

        $stmt2 = $mysqli->prepare($result2);
        //$valid_stmt2 = $stmt2 === FALSE ? false : true;

        echo $name . "\n";

        //if ($valid_stmt2) {
            // Error cased on $stmt2->execute();
            $stmt2->execute();
            $stmt2->bind_result($name2);

            while ($stmt2->fetch()) {
                echo 'related to: ' . $name2 . "\n";
            }

            $stmt2->close();
        //}
    }

    $stmt->free_result();
    $stmt->close();
} 
```

这个问题可能与[可能使用多个/嵌套的 MySQLi 语句有关？](https://stackoverflow.com/questions/112775/possible-to-use-multiple-nested-mysqli-statements)不幸的是，我没有发现它有帮助，因为它没有提供有效的示例或问题资源。

**更新：带有注释的简化代码示例。**

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-06-15T01:49:58.653

你先做了

```
"SELECT id, url, name FROM links WHERE group='' ORDER BY array ASC" 
```

然后你想用`$id`to do

```
"SELECT url, name FROM links WHERE group='$id' ORDER BY array ASC" 
```

如何获得结果？如果 group 等于空字符串，那么它将不等于`$id`（仅当`$id`也是空字符串但这是没有意义的。）

# bash - 如何提取文件的某些列并将它们保存在新文件中

> ID：11043560
> 
> 赞同：2
> 
> 时间：2012-06-15T01:30:43.173
> 
> 标签：bash, sed, awk, csh

我有一个文件，其中包含以下格式的数据行：

```
a11 a12 a13 a14 a15
a21 a22 a23 a24 a25 
a31 a32 a33 a34 a35 
a41 a42 a43 a44 a45 
.
.
. 
```

我需要的是在对其执行一些算术运算后将这些数据保存在具有以下格式的新文件中：

```
a11 
a12*x1 a13/y1 z1*a15+d1
a21 
a22*x2 a23/y2 z2*a25+d2
a31 
a32*x3 a33/y3 z3*a35+d3
.
.
.
. 
```

所有的 xi, yi, zi 和 di 都是浮点数。这些数字存储在具有以下格式的第二个文件中：

```
x1 y1 z1 d1
x2 y2 z2 d2
x3 y3 z3 d3
.
.
. 
```

如果您能提供有关如何完成此操作的 csh 或 bash 片段的指导，我将不胜感激。

干杯

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-06-15T02:29:51.173

脚本（我称之为`matmath`）：

```
#!/usr/bin/awk -f
BEGIN {
    factors = ARGV[1]
    ARGC--
}
{
    print $1
    getline line < factors
    split(line, f)
    print $2 * f[1], $3 / f[2], f[3] * $5 + f[4]
} 
```

数据文件：

矩阵：

```
11 12 13 14 15
21 22 23 24 25
31 32 33 34 35
41 42 43 44 45 
```

因素：

```
1.1 1.2 1.3 1.4 1.5
2.1 2.2 2.3 2.4 2.5
3.1 3.2 3.3 3.4 3.5
4.1 4.2 4.3 4.4 4.5 
```

示例运行：

```
$ chmod u+x matmath    # run once to set the script to be executable
$ ./matmath factors matrix
1.1
1.32 1.08333 3.35
2.1
4.62 1.04545 8.15
3.1
9.92 1.03125 14.95
4.1
17.22 1.02381 23.75 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-06-15T01:39:37.350

您可以为此使用[awk](http://en.wikipedia.org/wiki/AWK)。

```
awk '{print $1; print $2 * x, $3 / y1, z1 * $5, ...}' 
```

本质上`$(a+b)`会导致`a+b`第 th 列中的值。

# extjs - Sencha Touch 2 默认路由

> ID：11043564
> 
> 赞同：2
> 
> 时间：2012-06-15T01:31:12.730
> 
> 标签：extjs, sencha-touch-2, url-routing

我正在使用路由构建一个 sencha touch 2 应用程序。如果我直接理解，这需要在您的控制器中指定路由，并将您的 app.launch 函数留空（或者至少，不在那里加载视图/调用控制器）。

我的一个控制器指定了 "" 路由，当 url 哈希部分为空 ( `http://localhost/`) 时会加载该路由：

```
Ext.define('SOP.controller.PartyController', {
   extend: 'Ext.app.Controller',

    config: {
        routes: {
           "": "showChooseParty" 
```

到目前为止，一切都很好....

但是在这种情况下，如果哈希部分包含一些垃圾（例如`http://localhost/#tralala`，当任何控制器中没有指定 tralala 路由时），应用程序只会挂在加载屏幕上：没有调用任何操作，并且启动函数为空。我想要的是当哈希部分与未知路由匹配时加载的路由（哈希部分垃圾可能是应用程序早期版本中的路由，或者 facebook 试图让我高兴地在哈希中提供 accesstoken在重定向中）。

我有一个解决方法，在启动功能中：

```
launch: function () {
    if (!this.getRouter().recognize(window.location.hash.substr(1))) {
        window.location.hash = "";
    }
}, 
```

但是我不喜欢直接指向哈希的代码，它的工作取决于在第一次匹配路由之前调用 launch() ，并且 this.getRouter() 对象是[“私有的”并且不应该被使用](http://docs.sencha.com/touch/2-0/#!/api/Ext.app.Router)。

所以我的问题是，提供默认路由的“正确”方式是什么？还是我完全错过了使用路线的意义？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-08-23T10:32:42.033

在启动函数中检查哈希值后，您可以执行以下操作...

```
this.getApplication().getHistory().add(Ext.create('Ext.app.Action', {
        url : 'home'
    })); 
```

现在您可以使用 'home' 作为默认路由，而不是空哈希。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-02-03T18:24:53.030

我知道已经有一段时间了，我很想听听您可能还发现了什么，但我刚刚实现了以下内容： 由于 Sencha Touch 2 路由是短路的 - 也就是说，一旦找到匹配的路由，Ext停止查找 - 您可以将`Error`控制器添加到`controllers`列表末尾并添加匹配任何内容的路由：

在我的 app.js 中，我有：

```
...
controllers: ['Whatever', 'AnotherOne', 'Error'],
... 
```

我在前两个控制器中定义`routes`了我需要的任何东西，然后在`app/controller/Error.js`我有这个：

```
...
config: {
  routes: {
    ':foobar': {
      action: 'showNotFound',
      conditions: {
        ':foobar': ".+"
      }
    }
  }
}
...
showNotFound: function(hash) {
  // do whatever you need to
} 
```

因此，任何访问 domain.com#whatever/456 的人都会得到任何控制器，它可能会显示项目 #456 的视图，但如果 Ext 一直到达控制器的`:foobar`路由，`Error`那么他们将点击我的“404”页面.

**注意：您的`:foobar`（404、未找到等）路线必须是最后的。这意味着列表中的最后一个控制器，以及配置中的最后一个路由。否则它会在它之后的任何东西之前被击中。**

# javascript - 如何修改我的 jQuery 以更新以不同方式激活的切换按钮上的 html？

> ID：11043566
> 
> 赞同：0
> 
> 时间：2012-06-15T01:31:24.317
> 
> 标签：javascript, jquery, hash, toggle

我在页面上有 jQuery 滑动 div，这些 div 使用每个滑块上的按钮进行切换。单击按钮时，内容向下滑动，按钮上的文字由“查看更多”变为“关闭”。再次单击按钮时，内容会向上滑动，并且按钮上的文本会变回“查看更多”。我在下面发布的 jQuery 适用于此功能。

我现在想让其中一个滑块在 url 中有哈希标签时自动向下滑动。我用下面的代码得到了这个。在此自动滑动期间，触发按钮上的文本更改为“关闭”，这是我想要的，但是当我单击按钮向上滑动时，文本不会更改回“查看更多”。然后，当我单击切换按钮时，它再次开始更改按钮上的文本，但这次是从“关闭”而不是“查看更多”开始，因此与之前的更改相反。这有什么意义吗？哈哈。

有什么想法可以设置我的jQuery，所以当我在哈希自动打开后单击“关闭”按钮时，它会将文本更改为“查看更多”？谢谢你的帮助

```
 <script language="javascript">
 $(document).ready(function() {

        $('#toggleButton1').click(function() {$('#toggleSection{row_count}').slideToggle('slow', function() {
         // Animation complete.
            });
        });
            $('#toggleButton1').toggle(
                function() {$('#toggleButton1').html('Close');
            },
                function() {$('#toggleButton1').html('View More');
           });

        {/facility_sections}
        {/exp:channel:entries}

        if (window.location.hash) {
            $('#toggleSection1').slideToggle('slow');
            $('#toggleButton1').html('Close');}
});
</script> 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-06-15T01:58:38.993

你为什么不改变点击按钮上的文字？您可以将此代码添加到单击功能

```
 $(document).ready(function() {
           $('#toggleButton1').click(function() {

           var buttonValue = $(this).val();
           switch(buttonValue)
           {
             case 'Close':
              buttonValue = 'View More';
              $('#toggleSection1').hide('slow');
              $('#toggleSection2').show('slow');
              break;
             case 'View More':
              $('#toggleSection1').show('slow');
              $('#toggleSection2').hide('slow');
              buttonValue = 'Close';
              break;
          }
          $(this).val(buttonValue);
   });
}); 
```

这是html：

```
<div id='toggleSection1' style='display:none'>toggle section 1</div>
<div id='toggleSection2' style='display:none'>toggle section 2</div>

<input type='button' id='toggleButton1' value='View More' />​ 
```

另一种选择是有一个布尔值来指示它是否关闭，因此只需声明您可以访问的变量

```
var isClose = false; 
```

这是一个简单的代码，你可以看看 [http://jsfiddle.net/2R9yE/11/](http://jsfiddle.net/2R9yE/11/)

# c# - Mono for Android 是否支持“动态”关键字和 ExpandoObject？

> ID：11043567
> 
> 赞同：1
> 
> 时间：2012-06-15T01:31:49.707
> 
> 标签：c#, dynamic, xamarin.android, expandoobject

我想将动态 ExpandoObjects 用于我正在处理的项目，但它没有按照我认为正确的配置进行编译。

从我所见，Mono 支持动态关键字和 ExpandoObject，所以我假设它要么是配置问题，要么在 Android 的 Mono 中是不可能的。

但是，当我尝试使用它时，我在 Visual Studio 2010 中收到以下错误消息：

> 错误 3 找不到编译动态表达式所需的一种或多种类型。您是否缺少对 Microsoft.CSharp.dll 和 System.Core.dll 的引用？D:\HMI\ExpandoTest\ExpandoTest\Activity1.cs 34 17 ExpandoTest
> 
> 错误 1 ​​未定义或导入预定义类型“Microsoft.CSharp.RuntimeBinder.Binder” ExpandoTest

下面是简单的测试代码：

```
using System;
using System.Dynamic;
using System.Collections.Generic;
using System.Runtime;

using Android.App;
using Android.Content;
using Android.Runtime;
using Android.Views;
using Android.Widget;
using Android.OS;

namespace ExpandoTest
{
    [Activity (Label = "ExpandoTest", MainLauncher = true, Icon = "@drawable/icon")]
    public class Activity1 : Activity
    {
        protected override void OnCreate (Bundle bundle)
        {
            base.OnCreate (bundle);

            // Set our view from the "main" layout resource
            SetContentView (Resource.Layout.Main);

            // Test the expando stuff
            TestExpando();
        }

        private void TestExpando()
        {
            dynamic obj = new ExpandoObject();
            int x = 10;
            obj.x = x;    // This line and the next one generate compiler errors
            obj["X"] = x;
        }
    }
} 
```

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-06-15T02:56:24.130

正如编译器错误消息所述，您需要添加对 Microsoft.CSharp 程序集的引用才能使用 dynamic 关键字：

![添加对 Microsoft.CSharp 的引用](../Images/0cf17204a570710c75c86526d5b1779a.png)

# javascript - 使用 Mutation Observers 将 DOM 元素列入黑名单

> ID：11043568
> 
> 赞同：5
> 
> 时间：2012-06-15T01:31:53.040
> 
> 标签：javascript, dom, google-chrome, mutation-observers

我想在 Chrome 中使用 Mutation Observers 来监控整个文档中的 DOM 变化。但是，我想用某些`id`'s 将特定元素列入黑名单。有没有办法做到这一点？

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-06-19T17:20:58.040

使用此处找到的突变摘要库：[http](http://code.google.com/p/mutation-summary/) ://code.google.com/p/mutation-summary/ 。元素查询总结了与给定选择器字符串匹配的元素的存在和位置的变化。在这里找到：[http ://code.google.com/p/mutation-summary/wiki/APIReference#The_element_Query](http://code.google.com/p/mutation-summary/wiki/APIReference#The_element_Query)

# javascript - Chosen.js - 改变 jQuery

> ID：11043569
> 
> 赞同：4
> 
> 时间：2012-06-15T01:31:56.900
> 
> 标签：javascript, jquery, jquery-chosen

我正在使用 selected.js ( [http://harvesthq.github.com/chosen/](http://harvesthq.github.com/chosen/) )，并且我有一个选择框，我想根据所选选项操作页面。我在他们的文档中看到他们有一个如何做到这一点的例子。唯一的问题是当我运行这个脚本时。

```
$("#form_field").chosen().change(function() {
    console.log('hit');
}); 
```

它在第一次更改时运行。然后它死了，它再也不会运行了。

我也尝试添加一个 '.bind()' 但这也不起作用。

```
$("#form_field").bind('change',function() {}); 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-06-15T04:10:22.627

好的，问题是我的选项每个都有相同的名称。所以它没有注册更改。我需要睡一觉，失去理智...

感谢您的帮助卢库马！

# javascript - 如何从第三个“/”之后获取字符串

> ID：11043572
> 
> 赞同：2
> 
> 时间：2012-06-15T01:32:31.787
> 
> 标签：javascript

对编程完全陌生，所以请原谅这个愚蠢的问题。我有这个网址[http://www.blahblah.com/some/thing/blah](http://www.blahblah.com/some/thing/blah) ..

现在我需要出现在第三个“/”之后的字符串，即只是“/some/thing”。我不想从反向开始，因为每个页面的 URL 都不同，但协议和主机名是相同的..有没有办法我可以使用Javascript提取“/some/thing”..感谢任何帮助..谢谢！

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-06-15T01:34:19.613

```
var part = string.split('/')[2] 
```

或者更复杂：

```
var string = "/a/b/c/d/e/d"
var arr1 = string.split('/')
var arr2 = []
for (i in  arr1)
{
  if (arr1[i].length > 0)
     arr2.push(arr1[i])
}
var part = arr2[2] 
```

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-06-15T01:34:40.173

使用 string.split 方法： [http ://www.w3schools.com/jsref/jsref_split.asp](http://www.w3schools.com/jsref/jsref_split.asp)

```
var str = "www.blah.com/blah/blah/thing/blah.php";
var arrayOfString = str.split("/");
alert(arrayOfString[2]); //coming back to do regex/substring for you 
```

玩得开心！:)

顺便说一句...如果您是网络开发新手，www.w3schools.com 对我来说非常好 :)

因此，要响应您的编辑，您需要执行以下操作：

假设上面已经：

```
alert(arrayOfString.slice(3).join("/")); 
```

好的修复它根据实际需要在这里.. 但就像我说的，检查[http://www.w3schools.com](http://www.w3schools.com)它真的教会了我一些很好的基础知识。

要修复注释中的失败案例，请在拆分/切片/加入之前执行此操作：

`if (str.substring(0,1) == "/"){ str = str.substring(1);}`

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-06-15T01:47:18.270

我会在这里使用一个简单的正则表达式。

在第三个“/”*之后*获得东西的一种方法就是*把它和它之前的所有东西一起扔掉*。

基本思路：

```
"/a/b/c/d/e/f".replace(/.*?\/.*?\/s.*?\//, "")
// -> "c/d/e/f" 
```

替代＃1，以减少重复：

```
"/a/b/c/d/e/f".replace(/(?:.*?\/){3}/, "") 
```

替代#2，如果输入可以包含换行符：

```
"/a/b/c/d/e/f".replace(/(?:[^\/]*\/){3}/, "") 
```

限定符的`*?`意思是“不要贪婪”，所以`.`不会跳过`/`'s. 在负字符类案例中不需要它，因为`[^\/]`永远不会匹配`/`。

这当然可以写成“不太通用”的形式，因为*真正的*意图只是摆脱 URI 的协议/域部分（`/`' 的数量只是观察到的关系）：

```
"http://foo/a/b/c/d/e/f".replace(/https?:\/\/[^\/]*\/?/i, "")
// -> "a/b/c/d/e/f" 
```

请注意，最后`\/`一个`?`后面有一个，因此它将为“http://foo”返回“”，并且如果出于某种奇怪的原因使用`i`它，它将匹配（当然，完全可选）。`HTTP://`

```
"HTTPS://foo".replace(/https?:\/\/[^\/]*\/?/i, "")
// -> "" 
```

快乐编码！

* * *

注意：上述所有正则表达式都将提取3rd*之后*`/`的内容，如问题中所述。它们需要稍作修改以在结果中*包含*第 3 个`/`。此外，不问 XY 问题也很有帮助。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2012-06-15T02:06:06.187

如果您知道 url 以“http://www.blahblah.com/”开头，为什么不使用 url.substring(24)？

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2012-06-15T01:48:07.953

```
var str = 'http://www.blahblah.com/some/thing/blah'
var afterThirdSlash = str.split('/').slice(3).join('/') 
```

`split`返回一个数组，它是在每个字符上拆分的字符串`/`。选择`slice`从第四个元素开始的数组部分（因为数组是从零开始的），因为这对应于第三个斜杠之后的部分。通过`join`重新插入`/`. 这是你想要的吗？

# c# - 无法在 C# 中取消引用 IntPtr

> ID：11043574
> 
> 赞同：0
> 
> 时间：2012-06-15T01:33:17.220
> 
> 标签：c#, .net, pointers, intptr

我编写了一个在 COM 中实现 IGroupPolicyObject 接口的类。现在，其中一种方法在 C# 中返回 IntPtr 对象：

```
IntPtr ghKey = objectGPolicy.GetRegistryKey(GpoSectionMachine); 
```

我想在使用属于 Microsot.Win32 命名空间的 RegistryKey 对象时取消引用该指针。

这不起作用：

```
(RegistryKey)ghKey = rootKey.CreateSubKey(policyPath); 
```

我找不到如何取消引用 IntPtr。有人可以帮忙吗？

谢谢

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2012-06-15T01:47:31.870

[`IGroupPolicyObject.GetRegistryKey`](http://msdn.microsoft.com/en-us/library/windows/desktop/aa374266%28v=vs.85%29.aspx)不返回 .NET`RegistryKey`对象，它返回 Win32 注册表项句柄 (an `HKEY`)。`IntPtr`使用包含本机 HKEY的值可以做两件有用的事情。首先，您可以将其传递给其他 Win32[注册表访问函数](http://msdn.microsoft.com/en-us/library/windows/desktop/ms724875%28v=vs.85%29.aspx)。如果这样使用，还需要`RegCloseKey`在完成后通过调用手动关闭它，否则会泄露句柄。

正如@HansPassant 在他的评论中有用地指出的那样，您的第二个（可能更好）的选择是将它变成 a`SafeRegistryHandle`并使用它来获取一个`RegistryKey`对象：

```
var hkey = gpo.GetRegistryKey(GpoSectionMachine);
var safeHandle = new SafeRegistryHandle(hkey, true);
var reg = RegistryKey.FromHandle(safeHandle); 
```

如果您编写了 的托管实现*并*从该函数`IGroupPolicyObject`返回一个实际对象，则：`RegistryKey`

1.  你做错了，你的实现不能移植到任何其他消费者`IGroupPolicyObject`，并且
2.  您必须在实现中手动将`RegistryKey`对象编组*为*an `IntPtr`，因此只需执行相反的操作即可将其取出。（但实际上——不要那样做，你会通​​过返回错误的类型来破坏 COM 合同。）

相反，应该编写此方法的实现以返回 a `SafeRegistryHandle`（我相信封送拆收器会自动在`SafeHandle`和非托管句柄之间进行转换）。`RegistryKey.Handle`是其中之一，因此您可以一直使用 C# 类，直到您需要从实现中返回某些内容。

# c++ - C++ 异常：没有任何异常

> ID：11043578
> 
> 赞同：0
> 
> 时间：2012-06-15T01:33:37.217
> 
> 标签：c++, exception

好吧，我刚开始在大学学习异常，这是一个代码，如果引入的值超出了我设定的范围，则应该抛出异常......思考和分析，我认为可能会出现错误与投掷，有些人在其他问题中告诉我，确实我没有宣布任何投掷......我可能有愚蠢的错误，很抱歉给你带来麻烦这是我的代码：

```
 #include <iostream>
#include <exception>

class ExcepcionRango : public std::exception{
protected:

    ExcepcionRango::ExcepcionRango(){
    }
public:
    virtual const char* lanzarExcepcion()=0;

};

class ExcedeRangoInferior : public ExcepcionRango{
public:
    ExcedeRangoInferior::ExcedeRangoInferior(){
    }
    const char* lanzarExcepcion() throw(){ //throw exception
        return "Value out of minimal range";
    }
};

class ExcedeRangoSuperior : public ExcepcionRango{
public:
    ExcedeRangoSuperior::ExcedeRangoSuperior(){
    }
    const char* lanzarExcepcion() throw(){ //throw exception
        return "value out of maximal range";
    }
};

int obtainValue(int minimo, int maximo){ //obtain value

    int valor; //value
    std::cout<<"Introduce a value between "<<minimo<<" and "<<maximo<<" : "<<std::endl;
    std::cin>>valor;
    return valor;

};

int main(){
    ExcedeRangoSuperior* exS = new ExcedeRangoSuperior();
    ExcedeRangoInferior* exI= new ExcedeRangoInferior();
    int min=3; 
    int max=10;
    int valor=0; //value
    try{
        valor=obtainValue(min,max);
        if(valor<min){

            throw exS->lanzarExcepcion();
        }
        if(valor>max){

            throw exI->lanzarExcepcion();
        }
    }catch(...){
        std::cout<<"Exception: ";
    }

    delete exS;
    delete exI;
    std::cin.get();
} 
```

PD：如果插入的值超出范围，函数 lanzarExcepcion() 应该抛出消息

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-06-15T06:09:38.580

由于您以错误的方式使用异常，我决定“重构”您的代码以显示它通常是如何完成的：

```
#include <iostream>
#include <exception>

class ExcepcionRango : public std::exception
{
protected:
    ExcepcionRango::ExcepcionRango()
        { }
};

class ExcedeRangoInferior : public ExcepcionRango
{
public:
    ExcedeRangoInferior::ExcedeRangoInferior()
        { }

    const char *what() const
    {
        return "Valor fuera de rango inferior";
    }
};

class ExcedeRangoSuperior : public ExcepcionRango
{
public:
    ExcedeRangoSuperior::ExcedeRangoSuperior()
        { }

    const char *what()
    {
        return "valor fuera de rango superior";
    }
};

int obtainValue(const int minimo, const int maximo)
{
    int valor; 
    std::cout << "Introduzca un valor entre " << minimo << " y " << maximo << " : " << std::endl;
    std::cin >> valor;

    if (valor < min)
        throw ExcedeRangoInferior();
    else if (valor > max)
        throw ExcedeRangoSuperior();

    return valor;
};

int main()
{
    const int min = 3; 
    const int max = 10;

    int valor;

    try
    {
        valor = obtainValue(min, max);
    }
    catch (ExcepcionRango &exc)
    {
        std::cerr << "Exception: " << exc.what() << std::endl;
    }

    std::cin.get();
} 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-06-15T07:10:06.287

您的代码没有按照您的想法执行。

```
void fn() throw(); 
```

不会说“函数 fn 引发异常”。它说：函数 fn**永远不会**抛出异常（如果会，你的程序将立即调用`terminate()`并结束。你不太可能想要那个。）

相反，您可以使用`throw`带有值的关键字作为函数中语句的一部分：

```
void fn()
{
    ExceptionRango e;
    throw e; // or just "throw ExceptionRango();"
}

int main()
{
    try
    {
        fn();
    }
    catch(ExceptionRangoInferior &e)
    {
        // Caught an exception of type ExceptionRangoInferior
    }
    catch(ExceptionRango &e) 
    {
        // Caught an exception of type ExceptionRango (or a subclass thereof
        // which isn't ExceptionRangoInferior because that was already caught
        // above
    }
    catch(...)
    {
        // Caught an exception of an unknown type
    }
} 
```

* * *

## 回答 #3

> 赞同：-2
> 
> 时间：2012-06-15T02:21:30.173

好吧，我已经修复了它，现在它可以工作了！

```
 #include <iostream>
#include <exception>

class ExcepcionRango : public std::exception{
protected:

    ExcepcionRango::ExcepcionRango(){
    }
public:
    virtual const char* lanzarExcepcion()=0;

};

class ExcedeRangoInferior : public ExcepcionRango{
public:
    ExcedeRangoInferior::ExcedeRangoInferior(){
    }
    const char* lanzarExcepcion() throw(){ 
        return "Valor fuera de rango inferior";
    }
};

class ExcedeRangoSuperior : public ExcepcionRango{
public:
    ExcedeRangoSuperior::ExcedeRangoSuperior(){
    }
    const char* lanzarExcepcion() throw(){
        return "valor fuera de rango superior";
    }
};

int obtainValue(int minimo, int maximo){

    int valor; 
    std::cout<<"Introduzca un valor entre "<<minimo<<" y "<<maximo<<" : "<<std::endl;
    std::cin>>valor;
    return valor;

};

int main(){
    ExcedeRangoSuperior* exS = new ExcedeRangoSuperior();
    ExcedeRangoInferior* exI= new ExcedeRangoInferior();
    int min=3; 
    int max=10;
    int valor=0; 
    try{
        valor=obtainValue(min,max);
        throw valor;

    }catch(int){
        if(valor<min){

            std::cout<<"Exception: "<<exI->lanzarExcepcion();
        }
        if(valor>max){

            std::cout<<"Exception: "<<exS->lanzarExcepcion();
        }
        if(valor>min && valor<max){
            std::cout<<"Valor correcto"<<std::endl;
        }
        std::cin.get();
    }

    delete exS;
    delete exI;
    std::cin.get();
} 
```

# javascript - jQuery JavaScript 是否有类似 parseInt 的布尔函数

> ID：11043581
> 
> 赞同：3
> 
> 时间：2012-06-15T01:33:56.307
> 
> 标签：javascript, jquery

我知道，我知道，听起来很傻，但是我让这个变量四处传递，我认为在它中间的某个地方，它作为一个布尔值失去了自己，在这种情况下，我需要在它的时候使用所说的字符串来到我的脚本的一部分，并确保将其读取为布尔值。因此，我想知道是否有类似 parseInt 函数的东西，但对于布尔值，因为我知道我的 int 何时设法通过磨机并变成字符串原因，有时我需要调用一种使其识别为的方法再次整数。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-06-15T01:40:05.460

```
String.prototype.parseBoolean = function ()
{
  return ("true" == this.toLowerCase()) ? true : false
} 
```

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-06-15T02:14:14.133

不，没有功能，有这个快捷方式：

```
var bool = !!something; 
```

或者，您可以像这样创建一个新的布尔值：

```
var bool = Boolean(something) 
```

它通过将值强制为布尔值来工作。它将使用变量的真值/[假](http://my.safaribooksonline.com/book/programming/javascript/9780596517748/awful-parts/falsy_values)值。

当我谈到这个话题时，还有：

```
var floor = ~~3.1415; //floor = 3 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-06-15T01:50:49.170

```
function stringToBoolean(string){
    if (typeof string === "undefined") {
        console.log("stringToBoolean Undefined Error");
        return false;
    }
    if (typeof string === "boolean") return string;
    switch(string.toLowerCase()) {
        case "true": case "yes": case "1": return true;
        case "false": case "no": case "0": case null: return false;
        default: return false;
    }
} 
```

# javascript - 带标签的 Google Maps API v3 标记

> ID：11043587
> 
> 赞同：18
> 
> 时间：2012-06-15T01:35:02.857
> 
> 标签：javascript, html, google-maps, google-maps-api-3

我是 JS 和 Google API 的新手，我正在尝试制作多个标记，每个标记都有一个标签。

从我一直在查看的小片段来看，没有简单的方法可以将标签附加到 Google Maps API v3 中的标记。在 Google 和 stackoverflow 搜索之间，每个人都使用了一个涉及创建或编辑标签类的迂回程序。

我只是想弄清楚如何以简单的方式将标签附加到每个标记上，因为我刚刚开始学习 JS/Google API v3。

谢谢

编辑#3：好的，我终于弄清楚了哪里出了问题，并使用 Lilina 的代码正确实现了带有标签的多个标记。显然，我们都以不同的方式定义了 var 映射，这本身就使我们的代码无法很好地同步。

现在我还有一个问题，我可以为每个标记使用标签。我希望能够根据用户所处的缩放级别隐藏标记及其标签。

[Google Maps API v3 - 不同缩放级别上的不同标记/标签](https://stackoverflow.com/questions/11045562/google-maps-api-v3-different-markers-labels-on-different-zoom-levels)

* * *

## 回答 #1

> 赞同：38
> 
> 时间：2012-06-15T02:11:38.937

我不能保证它是最简单的，但我喜欢[**MarkerWithLabel**](http://google-maps-utility-library-v3.googlecode.com/svn/tags/markerwithlabel/1.0.1/)。如[**基本示例**](http://google-maps-utility-library-v3.googlecode.com/svn/tags/markerwithlabel/1.0.1/examples/basic.html)所示，CSS 样式定义标签的外观，JavaScript 中的选项定义内容和位置。

```
 .labels {
   color: red;
   background-color: white;
   font-family: "Lucida Grande", "Arial", sans-serif;
   font-size: 10px;
   font-weight: bold;
   text-align: center;
   width: 60px;     
   border: 2px solid black;
   white-space: nowrap;
 } 
```

JavaScript：

```
 var marker = new MarkerWithLabel({
   position: homeLatLng,
   draggable: true,
   map: map,
   labelContent: "$425K",
   labelAnchor: new google.maps.Point(22, 0),
   labelClass: "labels", // the CSS class for the label
   labelStyle: {opacity: 0.75}
 }); 
```

唯一可能令人困惑的部分是 labelAnchor。默认情况下，标签的左上角将与标记图钉的端点对齐。将 labelAnchor 的 x 值设置为 CSS 宽度属性中定义的宽度的一半将使标签居中。您可以使用锚点使标签浮动在标记图钉上方，例如`new google.maps.Point(22, 50)`.

如果访问上面的链接被阻止，我将 MarkerWithLabel 的[打包源](http://google-maps-utility-library-v3.googlecode.com/svn/tags/markerwithlabel/1.0.1/src/markerwithlabel_packed.js)复制并粘贴到这个[**JSFiddle 演示**](http://jsfiddle.net/yV6xv/36/)中。我希望JSFiddle在中国被允许：|

* * *

## 回答 #2

> 赞同：5
> 
> 时间：2012-06-15T02:07:03.520

为了向地图添加标签，您需要创建自定义叠加层。[http://blog.mridey.com/2009/09/label-overlay-example-for-google-maps.html](http://blog.mridey.com/2009/09/label-overlay-example-for-google-maps.html)上的示例使用了一个自定义类 ，该类`Layer`继承自Google Maps API `OverlayView`（继承自）。`MVCObject`他有一个修订版本（增加了对可见性、zIndex 和点击事件的支持），可以在这里找到：http: [//blog.mridey.com/2011/05/label-overlay-example-for-google-maps.html](http://blog.mridey.com/2011/05/label-overlay-example-for-google-maps.html)

***以下代码直接取自 Marc Ridey 的博客（上面修改过的链接）。***

**图层类**

```
// Define the overlay, derived from google.maps.OverlayView
function Label(opt_options) {
  // Initialization
  this.setValues(opt_options);

  // Label specific
  var span = this.span_ = document.createElement('span');
  span.style.cssText = 'position: relative; left: -50%; top: -8px; ' +
  'white-space: nowrap; border: 1px solid blue; ' +
  'padding: 2px; background-color: white';

  var div = this.div_ = document.createElement('div');
  div.appendChild(span);
  div.style.cssText = 'position: absolute; display: none';
};
Label.prototype = new google.maps.OverlayView;

// Implement onAdd
Label.prototype.onAdd = function() {
  var pane = this.getPanes().overlayImage;
  pane.appendChild(this.div_);

  // Ensures the label is redrawn if the text or position is changed.
  var me = this;
  this.listeners_ = [
    google.maps.event.addListener(this, 'position_changed', function() { me.draw(); }),
    google.maps.event.addListener(this, 'visible_changed', function() { me.draw(); }),
    google.maps.event.addListener(this, 'clickable_changed', function() { me.draw(); }),
    google.maps.event.addListener(this, 'text_changed', function() { me.draw(); }),
    google.maps.event.addListener(this, 'zindex_changed', function() { me.draw(); }),
    google.maps.event.addDomListener(this.div_, 'click', function() {
      if (me.get('clickable')) {
        google.maps.event.trigger(me, 'click');
      }
    })
  ];
};

// Implement onRemove
Label.prototype.onRemove = function() {
 this.div_.parentNode.removeChild(this.div_);

 // Label is removed from the map, stop updating its position/text.
 for (var i = 0, I = this.listeners_.length; i < I; ++i) {
   google.maps.event.removeListener(this.listeners_[i]);
 }
};

// Implement draw
Label.prototype.draw = function() {
 var projection = this.getProjection();
 var position = projection.fromLatLngToDivPixel(this.get('position'));

 var div = this.div_;
 div.style.left = position.x + 'px';
 div.style.top = position.y + 'px';
 div.style.display = 'block';

 this.span_.innerHTML = this.get('text').toString();
}; 
```

**用法**

```
<html>
  <head>
    <meta http-equiv="content-type" content="text/html; charset=utf-8">
    <title>
      Label Overlay Example
    </title>
    <script type="text/javascript" src="http://maps.google.com/maps/api/js?sensor=false"></script>
    <script type="text/javascript" src="label.js"></script>
    <script type="text/javascript">
      var marker;

      function initialize() {
        var latLng = new google.maps.LatLng(40, -100);

        var map = new google.maps.Map(document.getElementById('map_canvas'), {
          zoom: 5,
          center: latLng,
          mapTypeId: google.maps.MapTypeId.ROADMAP
        });

        marker = new google.maps.Marker({
          position: latLng,
          draggable: true,
          zIndex: 1,
          map: map,
          optimized: false
        });

        var label = new Label({
          map: map
        });
        label.bindTo('position', marker);
        label.bindTo('text', marker, 'position');
        label.bindTo('visible', marker);
        label.bindTo('clickable', marker);
        label.bindTo('zIndex', marker);

        google.maps.event.addListener(marker, 'click', function() { alert('Marker has been clicked'); })
        google.maps.event.addListener(label, 'click', function() { alert('Label has been clicked'); })
      }

      function showHideMarker() {
        marker.setVisible(!marker.getVisible());
      }

      function pinUnpinMarker() {
        var draggable = marker.getDraggable();
        marker.setDraggable(!draggable);
        marker.setClickable(!draggable);
      }
    </script>
  </head>
  <body onload="initialize()">
    <div id="map_canvas" style="height: 200px; width: 200px"></div>
    <button type="button" onclick="showHideMarker();">Show/Hide Marker</button>
    <button type="button" onclick="pinUnpinMarker();">Pin/Unpin Marker</button>
  </body>
</html> 
```

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2014-07-02T04:55:44.313

上述解决方案不适用于 ipad-2

最近，即使标记数量较少，我在绘制标记时也遇到了 Safari 浏览器崩溃问题。最初我使用带有标签的标记（markerwithlabel.js）库来绘制标记，当我使用谷歌原生标记时，即使有大量标记，它也能正常工作，但我想要自定义标记，所以我参考了乔纳森给出的上述解决方案，但是经过大量研究后，我开始了解[http://nickjohnson.com/b/google-maps-v3-how-to-quickly-add-many-markers](http://nickjohnson.com/b/google-maps-v3-how-to-quickly-add-many-markers)这个博客和现在我的地图搜索在 ipad-2 上运行顺利 :)

# c++ - 将对象传递给 C/C++ 时如何禁止 R 垃圾收集？

> ID：11043599
> 
> 赞同：11
> 
> 时间：2012-06-15T01:37:06.153
> 
> 标签：c++, r

在将对象传递给 C++ 时，R 的垃圾收集存在一些问题。

我们有以下场景：

1.  我们在 R 中创建一个匿名函数，并将其传递给 C++ 代码（通过`.Call()`）
2.  C++ 代码存储 R 函数对象以供以后使用（作为`SEXP`类型）并返回
3.  稍后，其他一些 C++ 代码使用`R_tryEval()`

在第 2 步和第 3 步之间，R 函数对象似乎被 R 垃圾收集。这会导致崩溃，因为`R_tryEval()`尝试执行不再代表有效 R 函数对象的东西。这很公平，因为我们没有做任何事情来告诉 R 函数对象仍在使用中......

考虑到这一点：

*   有没有办法从 C++ 代码中将 R 函数对象标记为正在使用（这样它就不会被 gc'd ）？
*   还是有一种安全的方法可以在 C++ 代码中复制 R 函数对象，并在我们调用后手动处理它`R_tryEval()`？

（据我所知，`PROTECT()`/`UNPROTECT()`宏在这里不是一个选项，因为它们应该在同一范围内平衡。如，我们不能`PROTECT()`在函数第一次传递给 C++ 时调用，然后`UNPROTECT()`在它之后调用被处决。）

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-06-15T23:23:28.010

我想你正在寻找

```
/* preserve objects across GCs */
void R_PreserveObject(SEXP);
void R_ReleaseObject(SEXP); 
```

在 R_internals.h 头文件中。

# qt - 在 Kiosk 模式下无法使用键盘

> ID：11043601
> 
> 赞同：0
> 
> 时间：2012-06-15T01:37:40.767
> 
> 标签：qt, ubuntu, keyboard, kiosk

我需要在登录后启动我制作的应用程序，然后再加载其他任何内容。我通过浏览找到了如何做到这一点，并且我的应用程序只是按我的意愿启动，但是当我需要使用键盘输入内容时，什么也没有发生，我该怎么办？

这是一个QT应用程序

这是启动所需应用程序 (Ensayo) 的主脚本：

#!/bin/bash xscreensaver -nosplash & /home/me/Ensayo-build-desktop-Qt_4_8_1_in_PATH_ *System* _Release/Ensayo

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-06-15T01:58:35.203

听起来窗口管理器没有启动。您参考的[教程文章专门在没有窗口管理器的情况下启动 Firefox。](http://www.instructables.com/id/Setting-Up-Ubuntu-as-a-Kiosk-Web-Appliance/?ALLSTEPS)

安装火柴盒窗口管理器，修改你的脚本如下：

```
matchbox-window-manager &
while true; do
  /home/me/Ensayo-build-desktop-Qt_4_8_1_in_PATH_System_Release/Ensayo
done 
```

请注意，Firefox 显然被设计为在没有窗口管理器的情况下运行。如果您尝试其他应用程序，例如 gnumeric、openoffice、konsole——我敢打赌它们的行为也不会正确。不是没有窗口管理器。

窗口管理器的简单测试是：尝试在您的应用程序中显示一个消息框。如果消息框没有出现，或者没有任何窗口框架/标题栏出现，那么肯定是由于缺少窗口管理器。

# iphone - 无法更改滚动视图中的文本字段

> ID：11043602
> 
> 赞同：0
> 
> 时间：2012-06-15T01:37:42.030
> 
> 标签：iphone

无法更改 scrollView 中的文本字段。

滚动视图很好：

```
[self.view addSubview:myScrollViewObj]; 
```

各种列/行字段，这些也可以：

```
(nonatomic,retain)
(init, alloc)
row02_col03.text = @”456”;
[myScrollViewObj addSubview:row02_col03]; 
```

（太喜欢使用表格视图了。）我可以更改 row02_col03 的内容

```
row02_col03.text = @”789”; 
```

但是“789”会覆盖“456”。两个值同时出现在屏幕上并且处于相同的位置。使用 textView 发生，使用 Label 发生。

嗯？好的，如果更新不起作用，则在写入新字段之前删除“旧”字段。

```
[row02_col03 removeFromSuperview];
(init, alloc again)
row02_col03.text = @”789”; 
```

现在“456”不会去任何地方（“删除”就是这么多），但 NSLog 语句显示新字段正确包含“789”。

诡异的。另一个建议使用标签的 stackoverflow 条目。做过某事：

```
(init, alloc again)
row02_col03.tag = 10;
row02_col03.text = @”456”;
[[myScrollViewObj viewWithTag:10] removeFromSuperview];
(init, alloc again)
row02_col03.tag = 10;
row02_col03.text = @”789”; 
```

是的，我在前后放置了 NSLog 语句；removeFromSuperview 行确实执行了。不，“保留”的存在/不存在没有区别

这是一个旧应用程序，我不需要更新任何东西，但现在我需要（并且不能）我想了解我缺少什么。有人有线索吗？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-06-15T05:27:44.160

尝试`row02_col03.text = nil;` 在添加新值之前，删除旧值。

# cross-domain - 跨域脚本

> ID：11043607
> 
> 赞同：0
> 
> 时间：2012-06-15T01:38:03.107
> 
> 标签：cross-domain

我目前在 Apache 端口 80 上托管我的客户端文件（.html、.js）。但是，我想调用托管服务器端文件的 Jetty 服务器端口 8080。由于我的项目（网络聊天）的性质，需要将信息传递回端口 80。完成此操作的最佳方法是什么？我研究过跨域脚本，但没有成功。

# html - CSS3 moz-kit 动画

> ID：11043614
> 
> 赞同：2
> 
> 时间：2012-06-15T01:38:57.707
> 
> 标签：html, css

我有这个在 Chrome 中工作的 CSS3 动画

```
 .circle-label-rotate {
                -webkit-animation-name: rotateThis;
                -webkit-animation-duration:.5s;
                -webkit-animation-iteration-count:infinite;
                -webkit-animation-timing-function:linear;
            } 
```

现在，这将如何在 Mozilla Firefox 上运行——我认为使用[keyframes](https://developer.mozilla.org/en/CSS/@keyframes)。但我不断出错。您将如何处理上述代码的 Firefox 等效项？

我试过这个：

```
-moz-animation-duration: 3s;
-webkit-animation-duration: 3s;
-moz-animation-name: slidein;
-webkit-animation-name: slidein; 
```

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-06-15T01:53:50.170

放`-moz-`前缀。

```
-moz-animation-name: rotateThis;
-moz-animation-duration:.5s;
-moz-animation-iteration-count:infinite;  
-moz-animation-timing-function:linear;

@-moz-keyframes rotateThis 
{ Some css. } 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-06-15T01:57:05.670

*   扩展 -webkit- 在 Chrome 和 Safari 中运行良好
*   -moz- 适用于 Mozilla Firefox
*   -o- 可以在 Opera 中使用
*   -ms- 可以在 IE 中工作（但我不确定它是否支持）

# xamarin.android - MonoDroid 每次必须多次部署到设备

> ID：11043616
> 
> 赞同：0
> 
> 时间：2012-06-15T01:39:06.287
> 
> 标签：xamarin.android

因此，我从 Visual Studio 开始调试。它完成所有步骤并显示部署成功。该应用程序会短暂显示在设备上，但随后屏幕会变黑，并且 Visual Studio 实际上从未处于调试模式。于是我又开始调试。同样的事情，除了这次设备会告诉我程序已意外停止询问我是否要强制关闭它。所以我强制关闭它，大约 50% 的时间它会自动重新打开应用程序，VS 将开始调试。剩下的 50%，我要么重新开始调试，要么直接进入应用程序管理器并手动强制关闭应用程序。奇怪的是，在我打开 VS 之后的每一天，我都会在第一次工作的地方进行大约 4-5 次调试。其他人经历过这种情况并知道如何解决吗？我'

# html - 通过 ASP 表单发送 HTML 邮件

> ID：11043625
> 
> 赞同：0
> 
> 时间：2012-06-15T01:40:18.407
> 
> 标签：html, email, asp-classic

我有一个 ASP 表格。我希望以正确的格式（表格）以 HTML 格式发送完整的表单详细信息。

我正在做的旧方法是将整个脚本写入变量，然后以这种方式发送消息。

```
message = "<html><body>"
message = message + " "&_ 'Many lines of codes!
message = message + "</body></html>" 
```

由于我的表单可能会变得很长，对于如何发送整个 HTML 页面而不将其放入变量中，你们有没有更好的建议？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-06-15T01:48:32.383

创建 template.html 并以您喜欢的方式布局页面。如果您要向多个接收者广播，您可以在模板中放置类似“Hi [varFirstName]”的文本。

然后您可以在代码中导入该模板文件，如下所示。

```
 Dim fso,templatesource,body
    Set fso = Server.CreateObject("Scripting.FileSystemObject")
    Set templatesource = fso.OpenTextFile(server.MapPath("template.html")) 
    template=templatesource.ReadAll
    template= Replace(template,"[varFirstName]",rsSource("firstname"))
    file.close
    templatesource.close
    Set templatesource = nothing
    Set fso = nothing 
```

# php - wordpress - 按字母显示类别的书签链接

> ID：11043631
> 
> 赞同：0
> 
> 时间：2012-06-15T01:40:56.160
> 
> 标签：php, mysql, sql, wordpress

我很难让 WP 通过以下方式显示类别的链接：

*   一个
*   苹果
*   艺术
*   乙
*   船
*   布美朗...等

我尝试了以下但由于某种原因查询没有显示任何内容

```
 $first_char = 'b';            
        $links = $wpdb->get_results("
        SELECT      *
        FROM        $wpdb->links
        WHERE       SUBSTR($wpdb->links.link_name,1,1) = %s
        ORDER BY    $wpdb->links.link_name
        ", $first_char); 

        if ($links) {

            foreach ( $links as $link ) 

            {   
                ?>
                <p>
                    <a href="<?php echo $link->link_url; ?>" rel="bookmark" title="Permanent Link to <?php echo $link->link_name; ?>">
                        <?php echo $link->link_name; ?>
                    </a>
                </p>
                <?php
            }

        } 
```

还有我怎样才能让它只显示一个特定的类别。非常感谢任何帮助！谢谢，

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-06-15T02:01:19.233

这不是正确使用`$wpdb->get_results()`. [根据 Wordpress Codex](http://codex.wordpress.org/Class_Reference/wpdb#SELECT_Generic_Results)， get_results 的第二个参数是四个预定义常量之一，即：

> *   OBJECT - 结果将作为行对象的数字索引数组输出。
> *   OBJECT_K - 结果将作为行对象的关联数组输出，使用第一列的值作为键（重复项将被丢弃）。
> *   ARRAY_A - 结果将作为关联数组的数字索引数组输出，使用列名作为键。
> *   ARRAY_N - 结果将作为数字索引数组的数字索引数组输出。

换句话说，“b”不是有效值。根据此文档（而且我对 Wordpress 不是很熟悉），似乎 OBJECT_K 适合您的情况。您可以更改`SELECT *`为`SELECT link_name,*`哪个，虽然从数据库优化/性能的角度来看效率低下，但将检索到的第一列设置为 link_name。如果我没看错的话，这会自动为您按字母顺序排列。但是，您也可以完全放弃第二个参数并且它会起作用。

```
 $first_char = 'b';            
    $category_id = 3; // get only category with id 3, for example
    $links = $wpdb->get_results("
    SELECT      *
    FROM        $wpdb->links
    WHERE       SUBSTR($wpdb->links.link_name,1,1) = $first_char
    AND WHERE   $wpdb->links.link_category = $category_id
    ORDER BY    $wpdb->links.link_name
    "); 

    if ($links) {

        foreach ( $links as $link ) 

        {   
            ?>
            <p>
                <a href="<?php echo $link->link_url; ?>" rel="bookmark" title="Permanent Link to <?php echo $link->link_name; ?>">
                    <?php echo $link->link_name; ?>
                </a>
            </p>
            <?php
        }

    } 
```

# c# - C# 继承索引器：另一种方式

> ID：11043640
> 
> 赞同：1
> 
> 时间：2012-06-15T01:43:12.570
> 
> 标签：c#, inheritance, indexer

我有一个抽象父类，它封装了对 MyObjects 数组的访问：

```
public abstract class MyObjectIterator
{
    public MyObjectIterator(MyObject[] MyObjects) { //constructor }

    public Vector2 [] Coords { //A Get Function }

    public Model[] Params { //A Get Function }

    //THIS ISN'T SAFE! CAN STILL CHANGE MEMBERS OF THE SET
    public MyObject[] MyObjects{ get; protected set; }
} 
```

它的一个子类已经为另一个目的实现了一个单一的索引索引器，所以我不能用它来返回一个 MyObject。
但是，由于返回数组是不安全/不好的做法，因为这意味着可以修改其中的元素，所以我正在寻找一种方法来提供一个整洁的接口来访问单个元素，例如

```
MyObject = Child.MyObjects[i]; 
```

但不提供`set`对 MyObjects 任何元素的访问。

我的一个相关问题是：如果我在父类上有一个索引器，当你有一个子类的对象时可以使用它吗？

**编辑：**
我决定采用这种方法，
`public MyObject MyObject(int index) { return MyObjects[index]; }` 因为它最能实现我想要的。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-06-15T01:47:03.570

有一个[ReadOnlyCollection](http://msdn.microsoft.com/en-us/library/ms132474.aspx)类可以完成您正在寻找的内容。这充当了数组的包装器。使用诸如`ReadOnlyCollection<MyObject> Data { get { return array.AsReadOnly(); } }`Mutating 底层数组之类的东西会影响 ReadOnlyCollection。该集合本身是相对轻量级的，因此您可以在每次访问该属性时创建一个新集合，或者如果频繁访问该属性（在调用站点或在类本身内），则使用缓存。

至于你的第二个问题，答案是肯定的。[C# 中的索引器](http://msdn.microsoft.com/en-us/library/6x16t2tx.aspx)很像属性。如果可以继承（或需要，例如由于接口）属性，则索引器也是如此。

# jquery - jQuery $.get() 方法在 IE 下不起作用

> ID：11043641
> 
> 赞同：0
> 
> 时间：2012-06-15T01:43:25.647
> 
> 标签：jquery, ajax, internet-explorer

我在 Internet Explorer 上使用 jQuery AJAX 时遇到了一些问题。这是代码片段：

```
$('#upload-button').live('click', function() {
    // Get next upload server
    $.get('http://api.site.com/?sub=next_upload_server', function(resp) {
        // Set uploadify server setting
        resp = $.parseJSON(resp);

        $('#file-select').uploadify('settings', 'uploader', 'http://' + resp.server + '.site.com/upload.php');

        console.log($('#file-select').uploadify('settings','uploader'));

        // Start uploads
        $('#file-select').uploadify('upload', '*');
    });

    // Switch out the form for upload progress
    $('#upload-form').animate({opacity: 0}, function() {
        $('#progress-container').fadeIn('fast');
    });
}); 
```

此代码适用于 Chrome、Firefox 和 Safari。但是在 Internet Explorer 下，它似乎不起作用。如果我`alert("test")`在通话前放一条线`$.get()`，它会显示出来。如果我把它放在`$.get()`调用的函数中，它不会。如果我在`$.get()`通话之后（在我切换上传进度表单之前）将其放入，它会显示警报。

这个 AJAX 调用在 Internet Explorer 中不起作用有什么原因吗？据我所知，它应该。我已经在 Internet Explorer 7 到 9 中对其进行了测试。加载页面或运行此方法时也没有 Javascript 错误。

谢谢你。

**编辑：**经过更多调试，如果我`http://api.site.com/?sub=next_upload_server`直接在 IE 中进入，它会提示我下载文件。当我在记事本中打开该文件时，我看到了预期的 AJAX 响应。这可能与它有关吗？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-06-15T01:45:34.970

我认为问题可能出在服务器脚本中，请尝试发送以下标头：

```
header("content-type:application/json;charset=utf-8"); 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-06-15T13:19:29.517

尝试使用`$.getJSON()`或`$.ajax({ dataType: 'json' ... });`

# java - 发布 Java 应用程序

> ID：11043642
> 
> 赞同：3
> 
> 时间：2012-06-15T01:43:33.977
> 
> 标签：java, android, publishing, google-play

在对 Java 应用程序进行编码和测试之后（假设使用 Eclipse，但不一定）应该采取哪些步骤来发布最终版本。例如，对于 Android 应用程序，

您必须在 XML 清单文件中对您的应用程序进行版本控制（主要用于 Google Play 商店）。然后您通常使用 Java 密钥工具对应用程序进行签名。在 Java 教科书中，我没有提到任何完成和发布应用程序的标准程序。

你能解释一下标准程序吗？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-06-15T01:50:53.833

好的，您要做的第一件事就是将您的应用程序打包到一个 jar 文件中，并在清单中包含一个主类。[Java 教程中](http://docs.oracle.com/javase/tutorial/deployment/jar/index.html)有一个部分对此进行了说明。

然后，这取决于您要支持的环境。最简单的事情就是向用户提供该 jar 文件。在大多数桌面环境中，您只需单击（或双击）文件即可从文件资源管理器运行 jar 文件。

您可以通过简单地用命令文件包装 jar 文件来制作命令行版本。在 UNIX/Linux 环境中，它很简单

```
#!/bin/bash
java -jar myapp.jar 
```

除此之外，您开始需要研究应用程序安装程序，它们本质上是依赖于平台的。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-06-15T05:10:35.750

> 此答案特定于在 Google Play 商店中发布 Android 应用程序，因为您已使用["android"](https://stackoverflow.com/questions/tagged/android)和["google-play"](https://stackoverflow.com/questions/tagged/google-play)标记了您的问题。

要使用 Eclipse ADT 插件或使用 Ant 工具通过命令行创建用于将 Android 应用程序发布到 Google Play 商店的包，您可以遵循[准备发布](http://developer.android.com/guide/publishing/preparing.html)指南。

对于在 Google Play 上发布至关重要的一件事是对应用程序进行签名的要求。[签署您的应用程序](http://developer.android.com/guide/publishing/app-signing.html)中解释了这些步骤。确保将密钥库以及密钥库的私钥存储在安全的地方。

# sage - 用SAGE计算椭圆曲线一点的y坐标？

> ID：11043648
> 
> 赞同：8
> 
> 时间：2012-06-15T01:45:19.130
> 
> 标签：sage, elliptic-curve

我用 SAGE 定义：

```
p=(10^34+1000).next_prime()
E=EllipticCurve(GF(p),[0,57]) 
```

我的问题是：

我知道椭圆曲线 P 的 x 坐标 1407284663933896236729058440000

**如何使用 SAGE 计算 y 坐标？有什么功能吗？**

```
E([1407284663933896236729058440000, ??????]) 
```

* * *

## 回答 #1

> 赞同：11
> 
> 时间：2012-06-15T13:27:08.443

```
sage: E.lift_x(1407284663933896236729058440000)

(1407284663933896236729058440000 : 4215171991512676773155222850458328 : 1) 
```

我建议您在此处提出更多此类问题之前阅读 Sage 参考手册。

# javascript - 设置元素 id = javascript 函数

> ID：11043654
> 
> 赞同：1
> 
> 时间：2012-06-15T01:45:57.050
> 
> 标签：javascript, html, playframework, playframework-2.0

所以我有一个问题，我不能 100% 确定如何解决。我遍历字符串列表并创建多个表单，我想要做的是将元素的 id 设置为字符串减去空格。我有一个 javascript 函数来删除空格

```
function trimWhiteSpaces(name) {
return name.replace(/\s+/g, '');
} 
```

以下是我当前用于生成表单的代码：

```
@(name: List[String]) 
```

...

```
@for(name <- names) {
        <td>@name
        @form(routes.Application.makeCall()) {
        <div id="hiddenForm" style="visibility:hidden">
            <input type="text" name="commandID" id="id@name" value="10" />
            <input type="text" name="source" id="sourceCall@name" value="source" />
            <input type="text" name="destination" id="dest@name" value="@name" />
        </div>
        <input type="submit" value="Call" id="call@name"/>
        }
} 
```

但我想做的是：是这样的：

```
<input type="submit" value="Call" id="call{js:timWhiteSpaces(@name)}"/> 
```

任何帮助，将不胜感激。我认为可行的另一个选项是传递具有两个选项的新自定义对象，而不是传递字符串。但由于我不是 html/javascript 方面的专家，我想知道是否有办法在 javascript 中做到这一点？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-06-15T06:24:48.727

我建议您在服务器端执行此操作，如

```
id="@(name.replace(" ", ""))" 
```

# html - Chrome：文本渲染

> ID：11043655
> 
> 赞同：2
> 
> 时间：2012-06-15T01:46:35.620
> 
> 标签：html, css, google-chrome

为什么与 Safari 或 Firefox 相比，Chrome 上的文本看起来参差不齐。我了解 Firefox，它是一个不同的渲染引擎，并且总是更好地处理字体，但 Safari 就像 Chrome 一样是 webkit。尽管如此，Chrome 对所有字体的渲染效果都很差。

```
a.post-tag:hover, .post-text a.post-tag:hover, .wmd-preview a.post-tag:hover {
    background-color: #3E6D8E;
    color: #E0EAF1;
    border-bottom: 1px solid #37607D;
    border-right: 1px solid #37607D;
    text-decoration: none;
} 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-06-17T15:10:37.840

通过@font-face 使用外部字体文件时，我遇到了类似的字体问题，字体在 Firefox 中看起来很棒，但在 Chrome 和 Safari 中看起来有点失真，有时使用不同文件类型的字体有助于使用 .woff 字体文件而不是 .ttf 一个。

# jquery - 异步和文档就绪

> ID：11043656
> 
> 赞同：37
> 
> 时间：2012-06-15T01:46:44.473
> 
> 标签：jquery, html

`async`我尝试通过在我的脚本上添加一些属性来优化我的页面。它似乎破坏了我的javascript，因为`$(document).ready`在加载所有脚本之前执行！

我看到我可以通过 put`$(window).load`而不是解决我的问题，`$(document).ready`但我想知道是否有更好的解决方案。在我的情况下，此解决方案引发了 2 个问题：

1.  我必须全部更改`$(document).ready`并告诉所有开发人员不要再使用它了
2.  加载所有图像后，将执行脚本。我的网站有很多沉重的图像，我真的需要在 dom 准备好后尽快执行一些脚本。

你有一些魔术技巧吗？也许将所有脚本放在最后？使用`defer`而不是`async`？

* * *

## 回答 #1

> 赞同：33
> 
> 时间：2012-06-15T11:20:33.303

经过一些广泛的研究，我可以肯定地说，将脚本放在页面末尾是最佳实践。

雅虎同意我的看法：http: [//developer.yahoo.com/performance/rules.html#js_bottom](http://developer.yahoo.com/performance/rules.html#js_bottom)

谷歌不谈论这种做法，似乎更喜欢异步脚本：[https ://developers.google.com/speed/docs/best-practices/rtt#PreferAsyncResources](https://developers.google.com/speed/docs/best-practices/rtt#PreferAsyncResources)

恕我直言，将脚本放在页面末尾比 async/defer 有几个好处：

*   它适用于所有浏览器（是的，甚至 IE ；））
*   您保证执行顺序
*   您不需要使用`$(document).ready`或`$(window).load`
*   您的脚本可以在加载图像之前执行
*   作为异步/延迟，您的页面将显示得更快
*   当 DOM 触发 ready 事件时，所有脚本都被加载
*   可以通过将所有js合并到一个文件中来优化（通过mod_pagespeed之类的工具）

我能看到的唯一缺点是浏览器无法并行下载。使用 async/defer 的一个很好的理由是当您有一个完全独立的脚本（不需要依赖执行顺序）并且不需要在特定时间执行时。示例：谷歌分析。

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2019-05-14T10:48:52.600

`defer`在这里肯定会有所帮助。

`defer`通常比`async`因为它更好：

*   异步加载（就像`async`）
*   保证执行顺序（不像`async`）
*   在最后执行（与`async`页面仍在加载时并行执行不同，它实际上*停止*了 dom 解析！）
*   jquery在“延迟”脚本加载*后*`ready`触发（这就是你要问的）

 *[这个 SO 答案](https://stackoverflow.com/a/39711009/56621)有一张很好的图片，说明了延迟/异步加载顺序，超级容易理解。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2018-11-12T09:14:03.480

如果您不想使用脚本加载器，您可以使用以下方法，让您将 $(document).ready 脚本留在原处 - 修改如下：

```
$(()=>{

    function checkAllDownloads() {
        // Ensure your namespace exists.
        window.mynamespace = window.mynamespace || {};

        // Have each of your scripts setup a variable in your namespace when the download has completed.
        // That way you can set async on all your scripts except jquery.
        // Use the document ready event - this code - to check if all your scripts have downloaded.
        if (window.mynamespace.script1 && window.mynamespace.script2){

          // Proceed with page initialisation now that all scripts have been downloaded.
          // [ Add your page initialisation code here ].
          return;
        } 
        // Not all downloads have completed.
        // Schedule another check to give the async downloads time to complete.
        setTimeout(checkAllDownloads, 500);
    }

    // check if it is safe to initialise the page by checking if all downloads have completed.
    checkAllDownloads();

    }) 
```*

# javascript - JavaScript 文件过多

> ID：11043659
> 
> 赞同：0
> 
> 时间：2012-06-15T01:47:15.670
> 
> 标签：javascript, jquery, asp.net-mvc

我在 Asp.net MVC 中有一个 Web 项目，其中许多页面都有下拉列表控件。当这些下拉列表的值发生变化时，必须向控制器操作请求刷新一些 div 标签。

为此，我使用了 jquery 的 $(document).ready() 函数，并创建了一个如下函数：

```
$("#ComboBox").change(function() { /* do something here */ });

$.get('@Url.Action("Action", "Controller")', function (result) { 
    // TODO: process the results of the server side call
}); 
```

问题是我不想创建一个大的 javascript 文件，其中包含当 jquery 的文档就绪事件发生时必须在所有页面中完成的所有事情的列表。

例如，在一个页面中，我有一个组合框，它创建对控制器 x 的动作 x 的请求，而在另一个页面中，另一个组合框创建对控制器 y 的动作 y 的请求。

我不确定这是否是为每个页面创建不同的 javascripf 文件的好策略。

我能做些什么？为每个特定的文档就绪函数创建一个 javascript？如果我将所有函数放在同一个javascript文件的同一个文档就绪函数中，那么用jquery控制引用的id和类中的冲突命名怎么办？如果所有功能都在同一个javascript中，那么不使用文档就绪功能中90％功能的页面怎么办。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-06-15T02:19:28.077

拥有一个大的 javascript 文件不是问题，事实上它是需要的。通过将大部分 javascript 放在一个文件中，浏览器可以缓存此文件，并且在随后的页面加载中不需要从服务器获取 javascript，从而加快页面加载速度。您可能仍想拆分您的 javascript 文件，但出于维护原因。例如，为所有与客户相关的页面等创建一个 customer.js 文件可能是有意义的。

要在文档就绪事件中设置各个事件处理程序，您可以在页面加载中包含内联 javascript，这将允许您在服务器生成时设置实际的控件 ID（例如，使用 <% Combo.ClientID %>）。此代码可能只是调用主 js 文件中的相应函数。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-06-15T06:17:30.227

当 javascript 在客户端变得越来越大时，您应该真正考虑维护。jQuery 真的很容易使用，但问题是你会突然发现很多地方的回调/处理程序变得难以管理。我建议您在客户端使用某种 MVC 库，例如*Backbone.js*，它有助于以更好的方式组织代码。

第二个这是作为开发视角，我们应该将应用程序中使用的完整 javascript 分离到单独的文件模块/控制器中。您可以使用有助于将所有 javascript 合并到单个文件中的缩小框架。

ASP.NET MVC 4 本身支持绑定/缩小，可帮助您组合和缩小一组 js 或 css 文件。

[http://ofps.oreilly.com/titles/9781449320317/ch_ClientOptimization.html#BundlingAndMinification](http://ofps.oreilly.com/titles/9781449320317/ch_ClientOptimization.html#BundlingAndMinification) http://weblogs.asp.net/scottgu/archive/2011/11/27/new-bundling-and-minification-support-asp -net-4-5-series.aspx

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-06-15T02:38:16.167

如果您的应用程序很大，按功能区域组织它可能会有意义，但如果您发现有很多小 js 文件，我建议您将它们放在一起。话虽如此，有一些很棒的工具可以最小化不同的 javascript 文件并将其组合在一起（实时或作为构建过程的一部分），甚至可以监控更改。他们甚至都可以将 .less/coffeescript 等翻译成 css。

看看 squishit 和 chirpy。我认为两者都可以在 Nuget 上找到。

Squishit： http: [//www.codethinked.com/squishit-the-friendly-aspnet-javascript-and-css-squisher](http://www.codethinked.com/squishit-the-friendly-aspnet-javascript-and-css-squisher)

[叽叽喳喳： http](http://chirpy.codeplex.com/) ://chirpy.codeplex.com/

一般的智慧是，如果您有一个在第一个页面视图上加载的 js 文件，它将被缓存以供后续页面视图使用。这通常是您可能希望为所有文件提供一个文件的原因（尽管您可以在开发时将它们分开）。

# android - Android 地图 API

> ID：11043668
> 
> 赞同：0
> 
> 时间：2012-06-15T01:47:55.343
> 
> 标签：android, google-maps, bing-maps

尝试为服务技术人员编写应用程序，该应用程序将在地图上显示距离他们 X 英里范围内的开放服务呼叫，并允许他们通过单击每个位置的图钉来执行自定义操作。位置需要属于具有不同颜色图钉的组。所以我需要提供一个来自 SQL 数据库的位置列表，并让地图只显示 X 英里内的位置。然后根据图钉所在的组，为如何在该位置开始服务提供某些选项。我一直在阅读有关 Google Map API 和 Bing API 的信息，但我是自学成才的，这些东西是真正的行话，我真的不知道我想做的事情是否可行。我确信我可以绘制 X 英里内的位置，但我不确定不同颜色的图钉和每个图钉的自定义选项。任何人都可以为外行指出正确的方向吗？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-06-15T02:40:18.537

谷歌地图有一个[距离矩阵函数](https://developers.google.com/maps/documentation/javascript/distancematrix)可以用来实现这一点。实际上，您可以将当前位置作为起点，将可能点列表（从您的数据库中获取）作为目的地，以获取与当前位置的距离。根据您的 X 值进行过滤将为您提供要显示的目的地列表。

还有一个关于在谷歌地图上使用数据库的教程 - [https://developers.google.com/maps/articles/phpsqlajax_v3](https://developers.google.com/maps/articles/phpsqlajax_v3)

# c# - EF查询，从发帖的朋友那里获取用户名

> ID：11043669
> 
> 赞同：2
> 
> 时间：2012-06-15T01:47:56.793
> 
> 标签：c#, asp.net-mvc-3, entity-framework

我正在构建类似于 facebook 的 webapp。我想查询数据库，以便从当前登录用户的朋友那里获取帖子（类似于 facebook 中的“家”） 好的，这是模型

```
public User()
    {
        this.Friends = new HashSet<Friend>();
        this.Friends1 = new HashSet<Friend>();
        this.Posts = new HashSet<Post>();
    }

    public int userID { get; set; }
    public System.Guid user_Unique_ID { get; set; }
    public string username { get; set; }
    public string profilePicUrl { get; set; }

    public virtual ICollection<Friend> Friends { get; set; }
    public virtual ICollection<Friend> Friends1 { get; set; }
    public virtual ICollection<Post> Posts { get; set; }

public partial class Friend
{
    public int friendshipID { get; set; }
    public int userfrID { get; set; }
    public int friendID { get; set; }

    public virtual User User { get; set; }
    public virtual User User1 { get; set; }
}

public partial class Post
{
    public int postID { get; set; }
    public int userpostID { get; set; }
    public System.DateTime postedOn { get; set; }
    public string text { get; set; }
    public int likes { get; set; }

    public virtual User User { get; set; }
} 
```

我尝试的是，创建一个视图模型：

```
public class HomePosts
{
    public int postID { get; set; }
    public int userID { get; set; }
    public int userpostID { get; set; }
    public string username { get; set; }
    public string text { get; set; }
    public System.DateTime postedOn { get; set; }
    public int likes { get; set; }
    public int userfrID { get; set; }
    public int friendID { get; set; }
} 
```

这是我的查询：

```
using (var context = new ASPNETDBEntities())
        {
            MembershipUser x = Membership.GetUser();
            User wad = context.Users.Where(u => u.user_Unique_ID == (System.Guid)x.ProviderUserKey).SingleOrDefault();
            int id = wad.userID;
            var allposts = (from u in db.Users
                            join f in db.Friends
                            on u.userID equals f.userfrID
                            where f.userfrID == id
                            join p in db.Posts
                            on f.friendID equals p.userpostID
                            select new HomePosts
                            {
                                friendID = f.friendID,
                                likes = p.likes,
                                postedOn = p.postedOn,
                                postID = p.postID,
                                text = p.text,
                                userfrID = f.userfrID,
                                userID = u.userID,
                                username = u.username, <-- this is the problem
                                userpostID = p.userpostID
                            }).OrderByDescending(u => u.postedOn).ToList();
            return View(allposts);
        } 
```

问题是，对于每个帖子，它都显示当前登录用户的用户名，而不是发布该帖子的朋友的用户名。我需要发帖人（朋友）的用户名。有什么建议么 ？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-06-15T02:28:46.950

好的，你可以试试这个：

```
from f in db.Friends
join u in db.Users
on f.friendID equals u.userID  
where f.userfrId = id
join p in db.Posts                             
on f.friendID equals p.userpostID                             
select new HomePosts 
{                                 
    friendID = f.friendID,                                 
    likes = p.likes,                                 
    postedOn = p.postedOn,                                 
    postID = p.postID,                                 
    text = p.text,                                 
    userfrID = f.userfrID,                                 
    userID = u.userID,                                 
    username = u.username, 
    userpostID = p.userpostID                             
} 
```

或者，如果您的 EF 设置正确，您可以执行以下操作：

```
var posts = db.Posts.Where(p => p.User.Any(u => u.Friends.Any(f => f.userfrID == id))).Select(p => new HomePosts 
    {                                 
        // your selections                          
    }

) 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-06-15T02:02:06.777

这部分不应该

```
join p in db.Posts    
on f.friendID equals p.userpostID 
```

是：

```
join p in db.Posts
on u.userID equals p.userpostID 
```

?

除非我误解了，否则听起来就像您所说的：

在帖子的用户 id --> 当前用户 --> 朋友 --> 朋友 id 上加入帖子表（循环回当前用户）

# string - 子字符串和查找方法错误处理

> ID：11043670
> 
> 赞同：0
> 
> 时间：2012-06-15T01:48:00.090
> 
> 标签：string, oop, error-handling, substring

MyString::Find 在较大的字符串中查找字符串并返回子字符串的起始位置。请注意，您的字符串位置从 0 开始，以长度 -1 结束。如果未找到该字符串，则将返回值 -1。

MyString::Substring（开始，长度）。此方法返回原始字符串的子字符串，该子字符串包含与从位置 start 开始的原始字符串相同的字符，并且与长度一样长。

我在 .cpp 文件中的功能是：

```
 MyString MyString::Substring(int start, int length)
 {
    char* sub;
    sub = new char[length+1];

    while(start != '\0')
    {
            for(int i = start; i < length+1; i++)
            {
                    sub[i] = String[i];
            }
    }
    return MyString(sub);
 }

 const int MyString::Find(const MyString& other)
 {
    int start(0);

    int counter(0);

    int end = other.Size;

    int end1 = Size;

    int nfound = -1;

   if(end > end1)
    {
            return nfound;
    }
    int i = 0, j = 0;
    for(i = 0; i < end1; i++)
    {
            for(j = 0; j < end; j++)
            {
                    if( ((i+j) >= end1) || (String[i+j] != other.String[j]) )
                    {
                            break;
                    }

            }
            if(j == end)
            {
                    return i;
            }

    }

    return nfound;

   } 
```

main.cpp文件中的函数调用如下：

```
 cout << "Please enter two strings. ";
      cout << "Each string needs to be shorter than 256 characters or terminated by /\n." << endl;
     cout << "The first string will be searched to see whether it contains exactly the second string. " << endl;

     cin >> SearchString >> TargetString; // Test of cascaded string-extraction operator

     if(SearchString.Find(TargetString) == -1) {
       cout << TargetString << " is not in " << SearchString << endl;
  } else {
       cout << TargetString << " is in " << SearchString << endl;
       cout << "Details of the hit: " << endl;
       cout << "Starting poisition of the hit: " << SearchString.Find(TargetString) << endl;
       cout << "The matching substring is: " << SearchString.Substring(SearchString.Find(TargetString), TargetString.Length());
 } 
```

编译并运行后，我得到：

请输入两个字符串。每个字符串必须少于 256 个字符或以 / 结尾。将搜索第一个字符串以查看它是否正好包含第二个字符串。

寻找

在

在找到

命中详情：

命中起始位置：1 ^C

我最终不得不使用控制 C 中止程序，但我确信我的代码有问题，我根本没有看到。请帮忙！我究竟做错了什么？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-06-15T18:57:20.427

问题在于 Substring 方法。您正在使用一个永远持续的 while 循环。您可能正在寻找类似以下代码段的内容。

```
 MyString MyString::Substring(int start, int length)
 {
    char* sub;
    sub = new char[length+1];

    for(int i = start; i < length+1; i++)
    {
        sub[i] = String[i];
    }

    return MyString(sub);
 } 
```

# symfony - Symfony 注销处理程序

> ID：11043672
> 
> 赞同：8
> 
> 时间：2012-06-15T01:48:13.040
> 
> 标签：symfony

我只是尝试了几个小时来弄清楚如何在注销操作后让 Flash 消息正常工作。

**安全.yml**

```
 login:
        pattern:  ^/login$
        security: false

    secured_area:
        pattern:    ^/
        form_login:
            check_path: /check
            login_path: /login
            failure_handler: authentication_handler
        logout:
            path:   /logout
            success_handler: authentication_handler 
```

**配置.yml**

```
services:
    authentication_handler:
        class: Project\LoginBundle\Handler\AuthenticationHandler 
```

**AuthenticationHandler.php**

```
class AuthenticationHandler implements AuthenticationFailureHandlerInterface, LogoutSuccessHandlerInterface
{
    public function onAuthenticationFailure(Request $request, AuthenticationException $exception)
    {       
        $referer = $request->headers->get('referer');       
        $request->getSession()->setFlash('error', $exception->getMessage());

        return new RedirectResponse($referer);
    }

    public function onLogoutSuccess(Request $request) 
    {
        $referer = $request->headers->get('referer');
        $request->getSession()->setFlash('success', 'Wylogowano');

        return new RedirectResponse($referer);
    }
} 
```

登录后查看你好

```
{% extends "ProjectCMSBundle:Secured:layout.html.twig" %}

{% block title "Hello " ~ name %}

{% block content %}
    <h1>Hello {{ name }}!</h1>

    <a href="{{ path('_project_secured_hello_admin', { 'name': name }) }}">Hello resource secured for <strong>admin</strong> only.</a>
{% endblock %}

{% set code = code(_self) %} 
```

查看登录表单

```
{% extends 'ProjectCMSBundle::layout.html.twig' %}

{% block title %}
    Title
{% endblock %}

{% block content %}

    <form action="{{ path("_project_security_check") }}" method="post" id="login">
        <div class="data">
          <div class="username">
              <label for="username">&nbsp;</label>
              <input type="text" id="username" name="_username" value="{{ last_username }}" />
          </div>

          <div class="password">
              <label for="password">&nbsp;</label>
              <input type="password" id="password" name="_password" />
          </div>
        </div>
    {% if error %}
        <div class="error">{{ error.message|trans({},'messages') }}</div>
    {% endif %}
    <input type="submit" class="submit" />
</form>
{% endblock %}

{% set code = code(_self) %} 
```

布局主模板

```
<!DOCTYPE html>
<html>
    <head>
    <meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
    <link rel="stylesheet" href="{{ asset('bundles/project/css/demo.css') }}" type="text/css" media="all" />
    <title>{% block title %}{% endblock %}</title>
    <link rel="shortcut icon" href="{{ asset('favicon.ico') }}" />
</head>
<body>
    <div id="symfony-wrapper">

        {% if app.session.flash('error') %}
            <div class="flash-message">
                {{ app.session.flash('error')|trans }}
            </div>
        {% endif %}

        {% if app.session.flash('success') %}
            <div class="flash-message">
                {{ app.session.flash('success')}}
            </div>
        {% endif %}

        {% if app.user %}
          {% block content_header %}
            <ul id="menu">
                {% block content_header_more %}
                {% endblock %}
            </ul>

            <div style="clear: both"></div>
          {% endblock %}
        {% endif %}

        <div class="symfony-content">
            {% block content %}
            {% endblock %}
        </div>

        {#{% if code is defined %}
            <h2>Code behind this page</h2>
            <div class="symfony-content">{{ code|raw }}</div>
        {% endif %}#}
    </div>
</body> 
```

问题是似乎在重定向期间闪存消息被丢弃。有没有办法做到这一点？

感谢您的回答。

* * *

## 回答 #1

> 赞同：20
> 
> 时间：2012-06-15T12:05:23.997

会话在注销时被销毁。`invalidate_session: false`但是您可以通过添加`security.yml`文件来更改此行为。

```
logout:
    path:   /logout
    success_handler: authentication_handler
    invalidate_session: false 
```

查看[参考文档](http://symfony.com/doc/current/reference/configuration/security.html)以获取更多信息。

如果您仍然想使会话无效，您可以直接在您的请求中设置一个标志并将其与内核侦听器一起使用。

# cocos2d-iphone - Cocos2D 2.0 - 将boundingBox坐标转换为导向器视图空间

> ID：11043675
> 
> 赞同：0
> 
> 时间：2012-06-15T01:48:34.130
> 
> 标签：cocos2d-iphone

我需要在弹出框上显示 UIActionSheet，并且此弹出框有一个指向 Cocos2D 上的元素的箭头。

我需要根据将显示 UIActionSheet 的导演视图坐标计算此元素的 boundingBox rect，因此操作表箭头将指向它。

我怎么做？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-06-15T02:02:36.643

这是我创建的一个快速示例，只需将 UIPopoverController 更改为您的 UIActionSheet。

```
CCNode* node = (CCNode *)sender;
CGPoint worldPoint = [node convertToWorldSpace:CGPointZero];
CGRect rect = [sender boundingBox];
rect.origin = worldPoint;
// Convert position based on Apple's anchor point from cocos2d's anchor point
rect.origin.y = rect.origin.y + rect.size.height;
CGPoint convertedLocation = [[CCDirector sharedDirector] convertToUI:ccp(rect.origin.x, rect.origin.y)];
rect.origin = convertedLocation;

UIViewController* viewController= [[UIViewController alloc] init];
[[viewController view] setBackgroundColor:[UIColor greenColor]];
UIPopoverController* c = [[UIPopoverController alloc] initWithContentViewController:viewController];
[c presentPopoverFromRect:rect inView:[[CCDirector sharedDirector] view] permittedArrowDirections:UIPopoverArrowDirectionAny animated:YES]; 
```

# modx - 我的一些模板（和其他元素）消失了。他们在哪里？

> ID：11043677
> 
> 赞同：1
> 
> 时间：2012-06-15T01:48:47.183
> 
> 标签：modx, modx-revolution, modx-templates

我最近清理了我的 ModX 元素，以便对它们进行分类。我添加了几个类别，然后开始将我的模板和其他元素移动到其中。他们不再出现在列表中，我无法找到他们。我怎样才能让他们回来？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-06-15T01:48:47.947

事实证明，他们还在那里。如果您检查您的网站，它们可能仍在正确加载。ModX Revolution 2.1+ 中的元素列表存在问题（目前尚未修复）。如果您有嵌套的类别并且在上面的级别中没有任何内容，那么 ModX 不会显示其他类别。如果您在上面的关卡中放置一个虚拟模板，您会看到它们为您出现。

**注意：**这也发生在其他元素上。

# java - 查找字符串是否包含除句号以外的非数字？

> ID：11043679
> 
> 赞同：2
> 
> 时间：2012-06-15T01:48:52.600
> 
> 标签：java, regex, expression

我尝试了许多排列，但它们似乎都不能很好地工作。我是否可以说 [\D^[\.]] 如果在 java matcher 中使用只会匹配那些非数字但不包括句号匹配？但是，它似乎不起作用...感谢您对我的问题的任何意见〜！

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-06-15T01:52:25.237

相反，确保字符串仅包含数字和句号并报告错误可能会更容易。（只是从另一个角度来看它......）

正则表达式非常简单：

```
/^[\d.]+$/ 
```

只需`!`在您的方法调用前添加一个匹配输入与模式的。

反转模式通常是获得所需内容的简单方法。

# php - 比这更好的方法正则表达式

> ID：11043684
> 
> 赞同：1
> 
> 时间：2012-06-15T01:50:04.370
> 
> 标签：php, javascript, regex

我将输入限制为仅接受以下字符：

*   撇号**'**
*   开括号**(**
*   右括号**）**
*   逗号**，**
*   连字符**-**
*   期间**。**
*   字母数字**AZ az 0-9**
*   空间

我想出了这个正则表达式：

```
/^['(),-.A-Za-z0-9\s]+$/ 
```

我在这里违反了任何正规化命令吗？我只想根据我在上面的项目符号中说明的顺序来获得正则表达式的顺序。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-06-15T02:27:49.573

在@Mark Linus 的问题评论中调整正则表达式：

`/^[-'(),.\w\s]+$/` *（将连字符移动到字符类的开头）*

原因：在正则表达式字符类中，`-`指定一个字符范围，除非它是第一个或最后一个字符。

`,-.``,`表示从到`.`包含的任何字符。碰巧的是，`-`是这两者之间的单个字符（基于 ASCII 值），因此在这种情况下效果相同。但是，在字符类中除了开头或结尾之外的任何位置都放置连字符可能不是一个好主意，除非您要指定一个范围。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-06-15T02:21:15.613

据我所知，没有真正意义上的值的常规顺序。只需为自己编造一些东西，并在所有表达中保持一致。只要使用任何感觉舒适的东西。

# javascript - 使用此 javascript 在 IE7 中出现“对象不支持此属性或方法”错误以及选项卡未正确锚定的问题

> ID：11043685
> 
> 赞同：0
> 
> 时间：2012-06-15T01:50:30.933
> 
> 标签：javascript

现在得到错误网页错误详细信息

用户代理：Mozilla/4.0（兼容；MSIE 8.0；Windows NT 6.1；Win64；x64；Trident/4.0；.NET CLR 2.0.50727；SLCC2；.NET CLR 3.5.30729；.NET CLR 3.0.30729；Media Center PC 6.0；.NET4.0C) 时间戳：2012 年 6 月 15 日星期五 02:20:10 UTC

消息：对象不支持此属性或方法行：210 字符：2 代码：0 URI：[http ://www.seanprovost.com/frah_dev/j/s_jsInit.js](http://www.seanprovost.com/frah_dev/j/s_jsInit.js)

并且我的标签没有锚定在 IE7 中

```
$("#map").gMap({
            markers: [{ 
                latitude: 34.816117,
                longitude: -86.491022,
                html: "Flint River Animal Hospital",
                icon: { image: "i/googlePin.png", 
                      iconsize: [26, 46],
                      iconanchor: [12, 46],
                      infowindowanchor: [12, 0] },
                }],
            zoom: 14
}); 
```

----> $('#boaSectLeft').localScroll({ target:'#sections' });

有谁知道这是怎么回事？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-06-15T01:53:04.330

去掉最后一个逗号：

```
$("#map").gMap({
    markers: [{ 
        latitude: 34.816117,
        longitude: -86.491022,
        html: "Flint River Animal Hospital",
        icon: { image: "i/googlePin.png", 
            iconsize: [26, 46],
            iconanchor: [12, 46],
            infowindowanchor: [12, 0] }//Here
    }],
    zoom: 14
}); 
```

因为`icon`是对象的最后一个属性。

但是，它应该可以工作，至少在 Chrome 中是这样。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-06-15T02:00:52.113

[这可能是问题所在](http://blog.inarow.net/post/227533978/stupid-comma)。我看到您在定义`icon`对象后有一个逗号（即行尾的逗号`infowindowanchor: [12, 0] },`会导致 IE 出现问题。

# c - C语言：这个错误是什么意思？

> ID：11043686
> 
> 赞同：0
> 
> 时间：2012-06-15T01:50:41.640
> 
> 标签：c

```
TYPE *a = calloc(nelem, sizeof(TYPE)); 
```

它说“无法解析标识符类型”。这是什么意思？

这是教授给我们的代码。我们需要实现堆排序（在 Java 中实现，我知道它是如何工作的，但我是 C 处女。）

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-06-15T02:00:04.030

使用以下代码编译时：

```
gcc -std=c99 -DRAND -DPRNT -DTYPE={float, double} -D{BUBB, HEAP, INSR, MERG} *.c 
```

您必须选择`float`或`double`：

```
gcc -std=c99 -DRAND -DPRNT -DTYPE=float -D{BUBB, HEAP, INSR, MERG} *.c
gcc -std=c99 -DRAND -DPRNT -DTYPE=double -D{BUBB, HEAP, INSR, MERG} *.c 
```

对于`BUBB`, `HEAP`, `INSR`,也是如此`MERG`。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-06-15T02:03:17.077

将以下定义添加到文件的开头：

```
#define TYPE int 
```

或者

```
#define TYPE float 
```

注意`TYPE`替换应该是数字类型

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-06-15T05:48:50.367

编译器无法解析 TYPE，它必须是 typedef ...您必须在定义它的位置包含头文件，否则在使用前定义它。例如 typedef int TYPE;

# apache - 没有root访问权限的任意内容的favicon

> ID：11043692
> 
> 赞同：2
> 
> 时间：2012-06-15T01:51:16.567
> 
> 标签：apache, .htaccess, favicon

我有一个习惯`favicon.ico`，我想在某个网站的所有页面上显示它。

对于 HTML 页面，我可以使用`<link>`. 不幸的是，对于其他任何东西（例如，PDF）

*   无处可放`<link>`，而且
*   我在共享服务器上，不能简单地将图标放在顶级目录中以默认显示。

我曾考虑过在 an 内显示媒体`<iframe>`以克服第一个困难，但如果可能的话，我想避免这种情况。如果（相当典型的）浏览器决定使用插件打开非 HTML 文件，我自己的图标仍应显示。但是我还没有让它工作——当我在 Firefox 12.0 中查看我的网站上的 PDF 时，我看到了一个 favicon，但它是默认的，而不是我的。

我的问题是： **鉴于上述限制，我是否可以自定义`favicon.ico`覆盖默认设置并在我的网站上提供任何文件时显示？**

为此，我尝试了 in 中`AddType`的`RewriteRule`指令`.htaccess`，但无济于事。尽管我的服务器不使用 Drupal，但我[在这里](https://stackoverflow.com/questions/4886423/favicon-for-pdf-files)得到了这个想法并尝试了它。也许这种方法会奏效，但我只是做错了。

（当我说“任何文件”时，我将图像排除在外；许多浏览器会为它们显示缩略图而不是`favicon.ico`，我可以接受。）

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-06-27T06:22:31.007

我不知道你计划在你的 .htaccess 中包含什么来提供一个网站图标，除非那是你要问的。请记住，favicon 是一个单独的请求，apache 只处理一个请求，它不能强制用户在原始请求旁边请求另一个页面。

所以，答案是：在大多数情况下，favicon.ico 是浏览器请求的默认文件名，但您必须遵守规则。

[在http://www.w3.org/2005/10/howto-favicon](http://www.w3.org/2005/10/howto-favicon)查看方法 2 。w3.org 是定义网络一切的人，所以按照上面所说的去做，你就赢了。

# jquery - jquery ajax 在 IE 中切断响应

> ID：11043693
> 
> 赞同：2
> 
> 时间：2012-06-15T01:51:24.613
> 
> 标签：jquery

我正在使用[jquery 表单插件](http://jquery.malsup.com)，它使用 jquery ajax 来完成大部分工作。我们有 jquery 1.7.2

我们使用它通过 ajax 向服务器发送一个表单，并返回一个表示成功的值或返回带有验证错误的表单。

当在验证中发现错误时，我让它在 firefox 和 chrome 中工作，包含旧表单的 div 的内容被替换为有错误的新表单。

$('#FormDiv').empty().html(response);

响应如下所示：

```
<form action="/MyForm/Edit" id="MyForm" method="post"><input id="Id" name="Id" type="hidden" value="" />
    <input id="PlantId" name="PlantId" type="hidden" value="1" />
    <table>
        <tr><td class="field">
                ID
            </td>
            <td>
                <input class="required" id="MyId" name="MyName" type="text" value="JP001" />

            </td>
            <td class="field">Description</td>   
            <td><input class="required" id="Description" name="Description" type="text" value="" />
        </tr>
        <tr>
            <td class="field">Created by</td>
            <td>Joe Bloggs</td>
            <td class="field">Create date</td>
            <td>15/06/2012</td>
        </tr>
    </table>
</form> 
```

在 IE 中调试，我可以看到 ajax 调用实际上在其返回正文中有这个，但是我的方法的参数是删除外部形式的开始和结束标记，所以基本上它只是一个表。

我尝试了一些不同的方法来解决这个问题，包括将 processData 设置为 false（不确定这是否真的会影响它）并将 returnType 设置为“text”和“html”，但没有一个真正有帮助。

有任何想法吗？

* * *

所以事实证明，如果我将表单包装在一个 div 中，一切似乎都可以正常工作，不太确定那里发生了什么，如果有人可以解释这一点，他们可以得到答案

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-06-19T10:31:23.957

这不是一个 jQuery 错误。

这是一个不太知名的 Javascript “功能”

显然，FF3 和 IE6+（也许还有其他）中的 innerHTML 不喜欢将表单标签作为**innerHTML**的一部分。如果你愿意，你可以测试它：

```
<div id="test">
   <form>
      <input>
   </form>
</div>

<script>
    window.onload=document.getElementById('test').innerHTML = "<form><input type="hidden" name="blah"></form>";
</script>

Result:

<div id="test">
    <input type="hidden" name="blah">
</div> 
```

不太清楚为什么，但这就是***他们***实现它的方式。

# macos - 将多个片段分配给单个键绑定

> ID：11043695
> 
> 赞同：0
> 
> 时间：2012-06-15T01:51:26.110
> 
> 标签：macos, sublimetext2

在 Textmate 中，我有几个片段分配给特定的等效键。

所以`command`+`F1`会打开一个小菜单，让我可以选择一些片段。

在 Sublime Text 2 中是否有同样的可能？

Follow-uo：在 Textmate 中，您可以将等效键分配给片段，并且可以分配相同的键等。到多个片段。When there is more than one snippet for a selected key equ. 将打开一个菜单，其中包含分配给该键 equ 的所有片段。

这真的对我有帮助...我可以在 + 上有一些 PHP 片段，在+`command`上`F1`有一堆 jQuery 片段等等......而且我不必记住一个疯狂的关键 equ，只需要一个用于 PHP 的东西， ETC...`command``F2`

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-06-16T15:21:16.187

如果添加此行：

```
{ "keys": ["shift+f1"], "command": "show_overlay", "args": {"overlay": "command_palette", "text": "snippet"} } 
```

到您的键绑定文件`/Packages/User/Default (Linux).sublime-keymap`。然后每次按`shift+f1`。将出现一个包含所有片段的弹出菜单。但你只想要一些片段。所以......在你想要出现的片段文件中添加以下行：

```
<description>php snippet, some description</description> 
```

并将顶部键绑定`"text": "snippet"`中的行从 to更改为`"text": "php snippet"`。现在，当您点击`shift+f1`所有以描述开头的片段时，`php snippet`将显示它们的完整描述。您可以对所有不同的组重复此过程。

# java - 是否需要在 Swing 的 UI 线程上更新 UI？

> ID：11043696
> 
> 赞同：2
> 
> 时间：2012-06-15T01:51:31.120
> 
> 标签：java, android, swing, user-interface, thread-safety

在 Android 中，如果您不将所有 UI 更改都放在 UI 线程上，则会导致巨大的问题。在 Swing 中是否同样重要？在为 Android 编程之前，我从未使用过召回的 UIThread。您是否想在 Swing 中的 UI 线程上进行 UI 更改？

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2012-06-15T02:11:14.833

是的，在 UI 上执行操作时需要使用 Java 中的事件线程（UI Thread）。

请参阅：[事件调度线程](http://docs.oracle.com/javase/tutorial/uiswing/concurrency/dispatch.html)

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2012-06-15T02:03:07.047

Android UI 工具包不是线程安全的，必须*始终*在 UI 线程上进行操作。

Android 提供了几种从其他线程访问 UI 线程的方法：

*   [`Activity.runOnUiThread(Runnable)`](http://developer.android.com/reference/android/app/Activity.html#runOnUiThread%28java.lang.Runnable%29)
*   [`View.post(Runnable)`](http://developer.android.com/reference/android/view/View.html#post%28java.lang.Runnable%29)
*   [`View.postDelayed(Runnable, long)`](http://tinyurl.com/bqx9ux2)
*   [`Handler`](http://developer.android.com/reference/android/os/Handler.html)

Swing 也是如此。从文档中，

> 关于线程安全的注意事项：Java 平台的如此重要部分不是线程安全的，这似乎很奇怪。事实证明，任何创建线程安全 GUI 库的尝试都面临一些基本问题。有关此问题的更多信息，请参阅 Graham Hamilton 博客中的以下条目：多[线程工具包：一个失败的梦想？](http://weblogs.java.net/blog/kgh/archive/2004/10/multithreaded_t.html)

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-06-15T01:59:57.027

通常，在大多数语言或用户界面（iPhone、Android 等）中，UI 的更新需要在主线程或至少一些控制对 UI 元素的访问的辅助线程上进行。

# scheme - 经验丰富的 Schemer 的 get-first、get-next 和 waddle 函数

> ID：11043704
> 
> 赞同：5
> 
> 时间：2012-06-15T01:52:26.000
> 
> 标签：scheme, continuations, callcc, seasoned-schemer

```
(define get-first
  (lambda (l)
    (call-with-current-continuation
      (lambda (here)
        (set! leave here)
        (waddle l)
        (leave (quote ()))))))

(define get-first
  (lambda (l)
    (call-with-current-continuation
      (lambda (here)
        (set! leave here)
        (leave (waddle l)))))) 
```

对于任何不熟悉“The Seasoned Schemer”一书的人来说`get-first`，`get-next`、 和`waddle`（最后两个未在此处定义）显然是对*协程*建模以遍历传递给仅产生叶子的*树的过程。*`waddle`就在`waddle`倒数第二次重新进入的 y​​ield 之前，它将重新进入点设置为它只会返回纯值的位置，即*is*的*实际值*而`'()`不是yield ，就好像它是一直都是纯函数。 `'()`*`waddle` *`'()`**

 **考虑到这一点，我们可以看到`get-first`设置了什么......当`waddle`返回“真实”时，它将在`call/cc`in内部`get-first`，然后`(leave (quote ()))`是`get-first`（并且，反过来，这`leave`旨在返回到`get-next`最后一次迭代，因此，它是)`get-next`的“实际”回报`'()`。

那么为什么第二个版本不等价，其中`waddle`的值`'()`将是 的参数`leave`？

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-06-19T03:42:58.740

The confusion is because "`leave`" is not the function I want it to be, but the function it evaluates to *when* it's evaluated, which appears to be left-to-right and thus before "`waddle`". That means it evaluates to what it was just set to, in the statement prior.

Moral: beware when using functions that are subject to redefining WITHIN the call to the function! If this was on a right-to-left interpreter, `waddle` would be evaluated before the symbol `leave` was looked up as the function that "leaves" to wherever, during which time it would be set to a DIFFERENT function.**

# reportviewer - 如何在 Reportviewer 2010 中添加水印？

> ID：11043705
> 
> 赞同：2
> 
> 时间：2012-06-15T01:52:28.170
> 
> 标签：reportviewer, report-viewer2010

目前我构建 vb.net 应用程序并使用报告查看器，但我想在报告的背景中添加水印（文本）。先感谢您！

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2017-06-07T12:27:54.360

您基本上可以从工具箱中添加一个文本框，将颜色设为灰色，增加字体大小并将所有其他元素粘贴到此文本框上。

# ios - iOS - 如何使用网络主机从另一部 iPhone 触发方法？

> ID：11043706
> 
> 赞同：0
> 
> 时间：2012-06-15T01:52:33.800
> 
> 标签：ios, web, connection, host

如何连接iPhone，这样当一个iPhone上调用一个函数时，它通过网络调用其他iPhone上的函数，也可以通过互联网传递参数。除了使用网络主机之外，还有其他解决方案吗？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-06-15T01:58:24.100

如果您要与之交谈的设备在物理范围内，您可以使用蓝牙（GameKit API*非常*简单）或更复杂的 Bonjour 协议在本地网络中发现设备。

如果您的设备实际上不在范围内，您很可能无法避免使用某种具有（REST？）API 来处理请求的服务器。

# qt - 如何使用 QPushButton 获得 toggled() 信号？

> ID：11043707
> 
> 赞同：8
> 
> 时间：2012-06-15T01:52:42.517
> 
> 标签：qt, signals-slots

我有以下代码在`moreButton`哪里`QPushButton`。当我切换按钮时，没有任何反应。

它不应该显示或隐藏`secondaryGroupBox`and`tertiaryGroupBox`吗？

```
QObject::connect(moreButton, SIGNAL(toggled(bool)), secondaryGroupBox, SLOT(setVisible(bool)));
QObject::connect(moreButton, SIGNAL(toggled(bool)), tertiaryGroupBox, SLOT(setVisible(bool))); 
```

* * *

## 回答 #1

> 赞同：16
> 
> 时间：2012-06-15T02:04:19.537

最有可能的是，您的按钮不是`checkable()`. 尝试

```
moreButton->setCheckable(true) 
```

不可检查的按钮永远不会发出`toggled(bool)`信号。

# android - 如何在 Android 的选项卡式布局中实现列表视图和嵌套布局

> ID：11043709
> 
> 赞同：0
> 
> 时间：2012-06-15T01:53:21.960
> 
> 标签：android, android-listview, android-fragments, android-tabs

我是 Android 新手，正在开发我的第一个应用程序，目前这仍然是一个“Hello World”的工作。在我的主要活动中，我想要一组两个选项卡。第一个选项卡是一个布局，由几个子线性布局组成，基本上是顶部的按钮/文本行和下面的列表视图（为简洁而编辑）：

```
<?xml version="1.0" encoding="utf-8"?>
<LinearLayout xmlns:android="http://schemas.android.com/apk/res/android"
    android:layout_width="match_parent"
    android:layout_height="match_parent"
    android:orientation="vertical" >
  <LinearLayout
    android:layout_width="match_parent"
    android:layout_height="match_parent"
    android:layout_weight="8"

    <ImageButton
        android:id="@+id/button1"
        android:layout_width="wrap_content"
        android:layout_height="wrap_content"/>

    <TextView
        android:id="@+id/textView1"
        android:layout_width="wrap_content"
        android:layout_height="34dp"
        android:layout_weight="0.86"/>

    <ImageButton
        android:id="@+id/button2"
        android:layout_width="wrap_content"
        android:layout_height="wrap_content" />
  </LinearLayout>

  <LinearLayout
    android:layout_width="match_parent"
    android:layout_height="match_parent"
    android:layout_weight="1">

    <ListView
        android:id="@+id/listview1"
        android:layout_width="match_parent"
        android:layout_height="wrap_content"
        android:layout_weight="1" >
    </ListView>
  </LinearLayout> 
```

第二个选项卡将是一个填充整个选项卡的列表视图。我将上述布局作为我的主要活动，并试图将其放入选项卡视图并在选项卡 2 中创建列表视图。每个按钮和列表项单击都会启动其各自的活动。

我发现了许多使用 TabActivity 类的选项卡实现示例/教程，现在似乎已弃用。据我所知， FragmentActivity 似乎是替代品。

我已经让[这个](http://thepseudocoder.wordpress.com/2011/10/04/android-tabs-the-fragment-way/)示例工作了，但是还没有成功地将列表视图放入选项卡中，更不用说我的嵌套布局了。我会继续努力的！

标签的片段方法是当前公认的最佳实践吗？从我所见，我仍然倾向于将其作为 UI 解决方案与操作栏。在看到这些选项卡式片段实现中有多么复杂之后，我可能会改变主意。:-)

任何指向可以在选项卡中实现列表视图和/或嵌套布局的好示例的指针？

提前致谢！

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-06-15T07:44:56.223

像您一样，我是 Android 新手，所以我不确定这是否适合您，但以下示例使用 ListFragment 在带有 Fragments 的选项卡内实现两个列表：

[http://android.codeandmagic.org/2011/07/android-tabs-with-fragments/](http://android.codeandmagic.org/2011/07/android-tabs-with-fragments/)

至于 Fragment 方法，我个人觉得它与使用 TabActivity 的旧风格相比非常复杂。看起来 Android 的开发团队匆忙开发了用于 ICS 的 Fragments（覆盖平板电脑？）并选择弃用 TabActivity 以推动每个人使用 Fragments，但没有先花时间进行全面测试它们的有用性和正确性。

当您用更复杂的东西替换简单的东西并弃用旧的东西而没有任何真正明显的优势时，会留下草率决定的坏印象，我不会感到惊讶将来会发生这种情况的逆转（除非我们看到ICS 反而退出了平板电脑市场）。

最终，市场会做出决定，但从过去的经验来看，它通常不会选择更复杂的做事方式作为赢家；特别是当巨大的优势似乎不存在时。

# mysql - Mysql 获得具有两个左连接的唯一条目

> ID：11043711
> 
> 赞同：2
> 
> 时间：2012-06-15T01:54:02.603
> 
> 标签：mysql, expressionengine

我有以下 mysql 查询，它按类别生成条目列表。但是，生成的某些条目是重复的（重复的 entry_id - 因为它们出现在多个类别中）。如何确保没有重复？我曾尝试使用 and 的其他变体`GROUP BY`，`DISTINCT`但没有成功。谢谢你。

```
SELECT ct.entry_id, ct.title, c.cat_name
FROM exp2_categories c
LEFT JOIN exp2_category_posts cp ON (cp.cat_id = c.cat_id)
LEFT JOIN exp2_channel_titles ct ON (ct.entry_id = cp.entry_id) 
WHERE c.group_id = '4' 
GROUP BY c.cat_id
ORDER BY ct.entry_date DESC 
```

**编辑：**

第一个答案很好，除了每个类别产生多个条目。我需要每个类别一个唯一的条目。对不起，我应该在我原来的问题中更具体。

例如，它产生的内容 - 条目是唯一的，但条目太多：

```
entry_id_1    Title 1    Category_1, Category_2
entry_id_3    Title 3    Category_2
entry_id_345  Title 345  Category_3
entry_id_123  Title 123  Category_4, Category_3, Category_1
entry_id_678  Title 678  Category_4 
```

**期望的结果**- 条目是唯一的，每个类别只有一个条目：

```
entry_id_1    Title 1    Category_1
entry_id_3    Title 3    Category_2
entry_id_345  Title 345  Category_3
entry_id_123  Title 123  Category_4 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-06-15T02:01:05.793

你得到“重复”的原因是你也在选择类别，所以如果一个条目在多个类别中，你会得到多行。

需要的是[`group_concat()`](http://dev.mysql.com/doc/refman/5.0/en/group-by-functions.html#function_group-concat)聚合函数：

```
SELECT ct.entry_id, ct.title, group_concat(c.cat_name) as cat_names
FROM exp2_categories c
LEFT JOIN exp2_category_posts cp ON (cp.cat_id = c.cat_id)
LEFT JOIN exp2_channel_titles ct ON (ct.entry_id = cp.entry_id) 
WHERE c.group_id = '4' 
GROUP BY ct.entry_id, ct.title
ORDER BY ct.entry_date DESC 
```

这将为每个条目创建一行，并带有逗号分隔的类别列表。

# database - 不可重复读和幻读有什么区别？

> ID：11043712
> 
> 赞同：208
> 
> 时间：2012-06-15T01:54:03.760
> 
> 标签：database, oracle, transactions, isolation-level, transaction-isolation

不可重复读和幻读有什么区别？

我已经阅读了[来自 Wikipedia 的 Isolation (database systems) 文章](http://en.wikipedia.org/wiki/Isolation_(database_systems))，但我有一些疑问。在下面的例子中，会发生什么：**不可重复读取**和**幻读**？

**交易A**

```
SELECT ID, USERNAME, accountno, amount FROM USERS WHERE ID=1 
```

**输出：**

```
1----MIKE------29019892---------5000 
```

**交易 B**

```
UPDATE USERS SET amount=amount+5000 where ID=1 AND accountno=29019892;
COMMIT; 
```

**交易A**

```
SELECT ID, USERNAME, accountno, amount FROM USERS WHERE ID=1 
```

另一个疑问是，在上面的例子中，应该使用哪个隔离级别？为什么？

* * *

## 回答 #1

> 赞同：214
> 
> 时间：2012-06-15T05:17:37.187

[来自维基百科](http://en.wikipedia.org/wiki/Isolation_%28database_systems%29#Non-repeatable_reads)（其中有很好的详细示例）：

> 发生不可重复读取时，在事务过程中，行被检索两次并且行内的值在读取之间不同。

和

> 当在事务过程中执行两个相同的查询，并且第二个查询返回的行集合与第一个不同时，就会发生幻读。

简单的例子：

*   用户 A 两次运行相同的查询。
*   在这两者之间，用户 B 运行事务并提交。
*   不可重复读：用户A第二次查询的A行值不同。
*   幻读：查询中的所有行之前和之后的值都相同，*但是选择的行不同*（因为B已经删除或插入了一些）。示例：`select sum(x) from table;`即使没有更新受影响的行本身，如果添加或删除了行，也会返回不同的结果。

> 在上面的例子中，要使用哪个隔离级别？

您需要什么隔离级别取决于您的应用程序。“更好”的隔离级别（例如降低并发性）的成本很高。

在您的示例中，您不会进行幻读，因为您仅从单行中选择（由主键标识）。您可以进行不可重复读取，因此如果这是一个问题，您可能需要一个隔离级别来防止这种情况发生。在 Oracle 中，事务 A 也可以发出 SELECT FOR UPDATE，然后事务 B 在 A 完成之前不能更改行。

* * *

## 回答 #2

> 赞同：173
> 
> 时间：2014-04-17T16:41:45.070

我喜欢考虑的一个简单方法是：

不可重复读取和幻读都与来自不同事务的数据修改操作有关，这些操作在事务开始后提交，然后由事务读取。

不可重复读取是指您的事务从另一个事务读取已提交的**更新。**现在，同一行的值与事务开始时的值不同。

幻读是相似的，但是当从另一个事务中读取已提交的**INSERTS**和/或**DELETES时。**自您开始交易以来，有新的行或已消失的行。

脏读*类似于*不可重复读和幻读，但与读取 UNCOMMITTED 数据有关，发生在读取另一个事务的 UPDATE、INSERT 或 DELETE，而另一个事务尚未提交数据时。它正在读取“进行中”的数据，这些数据可能不完整，并且可能永远不会真正提交。

* * *

## 回答 #3

> 赞同：66
> 
> 时间：2018-07-01T13:08:33.387

**不可重复读取**异常如下所示：

[![不可重复读取](../Images/3c622ee7ee2c7440d924337b3a60a2d3.png)](https://vladmihalcea.com/non-repeatable-read/)

1.  Alice 和 Bob 启动两个数据库事务。
2.  Bob 读取了 post 记录，并且 title 列的值为 Transactions。
3.  Alice 将给定帖子记录的标题修改为 ACID 的值。
4.  Alice 提交她的数据库事务。
5.  如果 Bob 重新读取 post 记录，他将观察到该表行的不同版本。

**幻读**异常可能发生如下：

[![幻读](../Images/dd87f1a731a3ae0e08605fed6b61bc89.png)](https://vladmihalcea.com/phantom-read)

1.  Alice 和 Bob 启动两个数据库事务。
2.  Bob's 读取与标识符值为 1 的帖子行关联的所有 post_comment 记录。
3.  Alice 添加一个新的 post_comment 记录，该记录与标识符值为 1 的帖子行相关联。
4.  Alice 提交她的数据库事务。
5.  如果 Bob 重新读取 post_id 列值等于 1 的 post_comment 记录，他将观察到此结果集的不同版本。

因此，虽然**不可重复读取**适用于单行，但**幻读**是关于满足给定查询过滤条件的一系列记录。

* * *

## 回答 #4

> 赞同：48
> 
> 时间：2017-09-11T10:56:06.583

## [阅读现象](https://en.wikipedia.org/wiki/Isolation_(database_systems)#Read_phenomena)

*   ***脏读***：从另一个事务中读取 UNCOMMITED 数据
*   ***不可重复读取***`UPDATE`：从另一个事务的查询中读取 COMMITTED 数据
*   ***幻读***`INSERT`：从另一个事务中读取或`DELETE`查询中的 COMMITTED 数据

***注意***：来自另一个事务的 DELETE 语句在某些情况下也极有可能导致不可重复读取。不幸的是，当 DELETE 语句删除了您当前事务正在查询的同一行时，就会发生这种情况。但这是一种罕见的情况，并且不太可能发生在每个表中有数百万行的数据库中。在任何生产环境中，包含事务数据的表通常具有很高的数据量。

此外，我们可能会观察到，在大多数用例中，UPDATES 可能是比实际 INSERT 或 DELETES 更频繁的工作（在这种情况下，仅存在*不可重复读取*的危险-在这些情况下不可能进行*幻读）。*这就是为什么 UPDATES 的处理方式与 INSERT-DELETE 不同，由此产生的异常也有不同的命名方式。

还有与处理 INSERT-DELETE 相关的额外处理成本，而不仅仅是处理 UPDATES。

## [*不同隔离级别*](https://en.wikipedia.org/wiki/Isolation_(database_systems)#Isolation_levels)的好处[](https://en.wikipedia.org/wiki/Isolation_(database_systems)#Isolation_levels)

 **   READ_UNCOMMITTED 不会阻止任何事情。这是零隔离级别
*   READ_COMMITTED 只防止一个，即脏读
*   REPEATABLE_READ 防止两个异常：脏读和不可重复读
*   SERIALIZABLE 可防止所有三种异常情况：脏读、不可重复读和幻读

那么为什么不一直设置事务 SERIALIZABLE 呢？好吧，上述问题的答案是：SERIALIZABLE 设置使交易变得非常*缓慢*，这也是我们不想要的。

事实上，交易时间消耗是在以下比率：

> SERIALIZABLE **>** REPEATABLE_READ **>** READ_COMMITTED **>** READ_UNCOMMITTED

所以 READ_UNCOMMITTED 设置是*最快*的。

## 概括

实际上，我们需要分析用例并确定*隔离级别*，以便我们优化事务时间并防止大多数异常。

请注意，默认情况下数据库可能具有 REPEATABLE_READ 设置。管理员和架构师可能倾向于选择此设置作为默认设置，以展示更好的平台性能。

* * *

## 回答 #5

> 赞同：9
> 
> 时间：2015-05-18T06:46:58.937

这两种隔离级别在实现上是有区别的。
对于“不可重复读取”，需要行锁定。
对于“幻读”，需要范围锁定，甚至是表锁定。
我们可以通过使用[两相锁定](http://en.wikipedia.org/wiki/Two-phase_locking)协议来实现这两个级别。

* * *

## 回答 #6

> 赞同：5
> 
> 时间：2012-06-15T04:59:47.877

在具有不可重复读取的系统中，事务 A 的第二次查询的结果将反映事务 B 中的更新——它将看到新的金额。

在允许幻读的系统中，如果事务 B*插入*ID = 1 的新行，则事务 A 将在执行第二个查询时看到新行；即幻读是不可重复读的一种特殊情况。

* * *

## 回答 #7

> 赞同：2
> 
> 时间：2017-08-02T19:45:30.713

公认的答案主要表明，两者之间的所谓区别实际上根本不重要。

如果“一行被检索两次并且行内的值在读取之间不同”，那么它们不是同一行（在正确的 RDB 中不是同一个元组），那么根据定义，实际上也是“集合第二个查询返回的行与第一个不同”。

至于“应该使用哪种隔离级别”的问题，您的数据对某人、某处越重要，Serializable 就越是您唯一合理的选择。

* * *

## 回答 #8

> 赞同：0
> 
> 时间：2018-01-22T13:48:15.123

我认为不可重复读取和幻读之间存在一些差异。

Non-repeateable 表示有两个事务 A 和 B。如果 B 可以注意到 A 的修改，那么可能会发生脏读，所以我们让 B 在 A 提交后注意到 A 的修改。

有一个新问题：我们让B在A提交后注意到A的修改，这意味着A修改了B持有的行的值，有时B会再次读取该行，所以B会得到与我们第一次不同的新值得到，我们称之为不可重复，为了处理这个问题，我们让B在B开始时记住一些东西（因为我不知道会记住什么）。

让我们考虑一下新的解决方案，我们可以注意到还有一个新问题，因为我们让 B 记住了一些东西，所以无论 A 发生什么，B 都不会受到影响，但是如果 B 想向表和 B 插入一些数据检查表以确保没有记录，但该数据已被A插入，因此可能会出现一些错误。我们称之为幻读。

* * *

## 回答 #9

> 赞同：0
> 
> 时间：2019-05-23T07:14:45.983

不可重复读是一个隔离级别，幻读（读取其他事务提交的值）是一个概念（读类型，例如脏读或快照读）。不可重复读隔离级别允许幻读，但不允许脏读或快照读。

* * *

## 回答 #10

> 赞同：0
> 
> 时间：2021-10-28T17:30:17.513

不可重复读取和幻读都来自一个事务 T1，该事务 T1 看到另一个事务 T2 在 T1 完成之前提交的更改。不同之处在于不可重复读取会为*同一逻辑行*返回不同的值。（例如，如果主键是employee_id，那么某个员工在两个结果中可能有不同的薪水。）幻像读取返回两组不同的行，但是对于出现在两组中的每一行，列值是相同的。*

# c++ - 表达式模板 - 无法专门化函数模板

> ID：11043715
> 
> 赞同：4
> 
> 时间：2012-06-15T01:54:44.167
> 
> 标签：c++, templates, c++11, expression-trees

我试图制作一些表达式模板作为[这个问题](https://stackoverflow.com/questions/11009233/freezing-an-expression/11022554#11022554)的答案，但是我遇到了编译器错误，我无法弄清楚。我现在的 SSCCE 已经很小了

```
template<class sub_expr>
class inherit2 : private sub_expr { //line 3
public:
    inherit2(sub_expr rhs) : sub_expr(rhs) {}
    template<class T>
    auto operator()(const T& v) const ->decltype(sub_expr::operator()(v)) //line 7
    {return sub_expr::operator()(v);}
};

class expression_parameter {
public:
    template<class T>
    const T& operator()(const T& v) const {return v;}
};

int main() {
    expression_parameter x;
    auto expr0 = x;
    int res0 = expr0(3); //line 20
    auto expr1 = inherit2<expression_parameter>(x); //line 21
    int res1 = expr1(3); //line 22
    return 0;
} 
```

当我用 MSVC10++ 编译时，我得到这个错误：

```
f:\code\utilities\exprtemplate\exprtemplate\sscce.cpp(22): error C2893: Failed to specialize function template ''unknown-type' inherit2<sub_expr>::operator ()(const T &) const'
with
[
    sub_expr=expression_parameter
]
With the following template arguments:
'int' 
```

当我使用 GCC 4.6.3 编译时：

```
sscce.cpp: In instantiation of 'inherit2<expression_parameter>':
sscce.cpp:21:47:   instantiated from here
sscce.cpp:3:7: warning: base class 'class expression_parameter' has a non-virtual destructor [-Weffc++]
sscce.cpp: In function 'int main()':
sscce.cpp:22:20: error: no match for call to '(inherit2<expression_parameter>) (int)'
sscce.cpp:3:7: note: candidate is:
sscce.cpp:7:10: note: template<class T> decltype (sub_expr:: operator()(v)) inherit2::operator()(const T&) const [with T = T, sub_expr = expression_parameter, decltype (sub_expr:: operator()(v)) = decltype (expression_parameter::operator()(v))]
sscce.cpp:20:6: warning: unused variable 'res0' [-Wunused-variable]
sscce.cpp:22:6: warning: unused variable 'res1' [-Wunused-variable] 
```

最后是 Clang 3.1

```
sscce.cpp(22,12) :  error: no matching function for call to object of type 'inherit2<expression_parameter>'
        int res1 = expr1(3);
                   ^~~~~
sscce.cpp(7,9) :  note: candidate template ignored: substitution failure [with T = int]
    auto operator()(const T& v) const ->decltype(sub_expr::operator()(v))
         ^ 
```

总而言之：*看来*我`decltype`错了，但我想不出正确的方法。谁能帮我找出导致这些错误的原因？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-06-15T05:11:31.977

我从 GCC 得到的一些错误向我暗示，其中涉及一个模棱两可的基础。即，`expression_multiply<expression_parameter, expression_parameter>`具有`expression_parameter`作为（直接）基础，并且`inherit_again<expression_parameter>`其本身具有`expression_parameter`作为基础。这意味着`lhs::operator()`在`expression_multiply<expression_parameter, expression_parameter>`(where `lhs`is in fact `expression_parameter`.

需要进一步修复，因为`this`在返回类型中需要`operator()`，导致以下修复：

```
// Instead of inherit_again
template<int N, class sub_expr>
class base : public sub_expr {
public:
    base(sub_expr rhs): sub_expr(std::move(rhs)) {}
};

template<class lhs_given, class rhs_given>
class expression_multiply: private base<0, lhs_given>, private base<1, rhs_given> {
    typedef base<0, lhs_given> lhs;
    typedef base<1, rhs_given> rhs;
public:
    expression_multiply(lhs_given l, rhs_given r):lhs(std::move(l)), rhs(std::move(r)) {}
    template<class T>
    auto operator()(const T& v) const
    -> decltype(this->lhs::operator()(v) * this->rhs::operator()(v))
    {
        return lhs::operator()(v) * rhs::operator()(v);
    }
}; 
```

不知道编译器是否正在纠正对这两个“修复”的需求。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-06-15T18:38:39.003

这是 Luc 修复的附录。采用：

```
decltype(std::declval<lhs>()( v ) * std::declval<rhs>()( v ) ) 
```

帮助编译器毫不费力地推断出类型。

# vim - Vim、vimux、tmux 和清除回滚缓冲区窗格

> ID：11043717
> 
> 赞同：4
> 
> 时间：2012-06-15T01:54:50.430
> 
> 标签：vim, tmux

**更新：**我一直在玩这个，似乎 tmux 的`clear-history`命令可能被破坏了。

如果我在`0.0`和处打开了两个窗格，并在then (in )`0.1`中输入 18 个命令，则运行`0.1``0.0`

```
tmux send-keys -t 0.1 q C-u "clear; tmux clear-history" C-m 
```

...然后切换到窗格`0.1`并进入复制模式并向上滚动，滚动缓冲区不会被清除。

但是，如果我`clear; tmux clear-history`直接从运行`0.1`，则滚动缓冲区将被正确清除。

我正在运行 tmux 1.6。对这种行为有什么想法吗？

* * *

我正在使用[vimux](https://github.com/benmills/vimux)将测试发送到 tmux 窗格，在我的测试命令前面加上

```
call RunVimTmuxCommand("clear; ruby -Itest /spec/some_spec.rb") 
```

...但是由于 MiniTest 在某些故障上给了我一些相当长的堆栈跟踪，我已经开始在 vimux 窗格上进入复制模式并搜索`ERROR`with `/`，这很好用。

唯一的问题是窗格保留了回滚历史记录，因此我会发现我知道我已经修复的测试失败（因为我正在搜索历史记录）。

我尝试将以上内容修改为

```
call RunVimTmuxCommand("clear; tmux clear-history; ruby -Itest /spec/some_spec.rb") 
```

但是从vimux发送时这似乎不起作用。如果我手动运行完全相同的命令（就像我切换到 vimux 窗格并自己运行它一样），它工作正常。

我假设这与 vimux 如何将命令发送到窗格有关，但我不知道如何修复它。有人有什么建议吗？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-06-16T01:48:02.823

我写信给 vimux 的作者，他已经修好了；惊人的！

[https://github.com/benmills/vimux/issues/26](https://github.com/benmills/vimux/issues/26)

# asp.net-mvc - 模型作为 ViewModel 的成员

> ID：11043718
> 
> 赞同：1
> 
> 时间：2012-06-15T01:54:53.600
> 
> 标签：asp.net-mvc, mvvm, viewmodel

我正在尝试更深入地了解 ViewModel，并且我已经阅读了许多关于 MVC 中的 ViewModel 的文章和博客。在一些文章中说不应从 ViewModel 中引用模型，但在其他一些文章中，建议使用模型作为视图模型的成员。

让我们举一个例子，我必须基于模型创建一个 ViewModel。我可以通过两种方式做到这一点：

1

```
 public class Car
{
       public int Year {get;set;}
       public string  Make {get;set;}
       //more properties......
}

public class CarViewModel
{
  public CarViewModel(Car model)
  {
    Model = model;
  }

  public Car Model { get; set; }
 //additional view model specific properties
} 
```

或 2。

```
public class Car
{
       public int Year {get;set;}
       public string  Make {get;set;}
       //more Car properties......
}

public class CarViewModel
{
       public int Year {get;set;}
       public string  Make {get;set;}
       //more Car properties......

     //additional view model specific properties
} 
```

我只是想知道哪一种是创建 ViewModel 的正确方法。或者有没有其他方法可以完全做到这一点？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-06-15T02:28:00.413

`Car`当模型是数据持久性说它是由实体框架创建的类时，我会选择第二种方法。在这种情况下，我不希望这些模型在控制器和视图中浮动。我将创建一个与您所做的等效的视图模型，并使用诸如`AutoMapper`映射属性之类的工具。

在第一种方法中，视图模型充当包装器。如果您想在与该模型相关的视图中显示附加信息，则可以使用此功能。假设您必须添加几个 UI 字段，并且绝对不应该在 Car 模型中这样做，并且您必须创建一个包含`Car`模型和其他 UI 字段的视图模型。

基本上，View Models 可以帮助您保持业务模型免受 UI 内容的影响，并有助于避免模型中的数据库内容浮动在视图和控制器中。因此，您可以根据场景使用两种方法。

希望这能回答你的问题。

# c# - 使“不安全”代码块“安全”

> ID：11043719
> 
> 赞同：3
> 
> 时间：2012-06-15T01:54:56.243
> 
> 标签：c#, pointers, unsafe

我有这个不安全的代码，我需要确保它安全才能执行。我知道这个`fixed`块，但我不知道如何实现它：

```
 private static unsafe void PrintHex(byte* data, uint len)
    {
        uint ctr;
        string sep;

        if (len > 64)
        {
            len = 64;
        }

        for (ctr = 0; ctr < len; ctr++)
        {
            if (((ctr & 7) == 0) && (ctr != 0))
            {
                sep = "\n";
            }
            else
            {
                sep = "";
            }
            Console.Error.WriteLine("{0}{1:X}", sep, data[ctr]);
        }

        Console.Error.WriteLine("\n\n");

    } 
```

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-06-15T02:02:20.257

在调用您的方法之前，调用代码有责任“修复”或“固定”指针，如 MSDN 页面中的以下示例[`fixed`](http://msdn.microsoft.com/en-US/library/f58wzh21%28v=VS.80%29.aspx)：

```
class Point
{ 
    public int x, y; 
}

class FixedTest 
{
    // Unsafe method: takes a pointer to an int.
    unsafe static void SquarePtrParam (int* p) 
    {
        *p *= *p;
    }

    unsafe static void Main() 
    {
        Point pt = new Point();
        pt.x = 5;
        pt.y = 6;

        // Pin pt in place:
        fixed (int* p = &pt.x) 
        {
            SquarePtrParam(p);
        }

        // pt now unpinned
        Console.WriteLine ("{0} {1}", pt.x, pt.y);
    }
} 
```

> 固定语句设置一个指向托管变量的指针，并在语句执行期间“固定”该变量。如果没有固定，指向可移动托管变量的指针将几乎没有用处，因为垃圾收集可能会不可预测地重新定位变量。C# 编译器仅允许您在固定语句中分配指向托管变量的指针。

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2012-06-15T02:13:24.640

> 我有这个不安全的代码，我需要确保它安全才能执行。

根据定义，任何使用 a `byte*`（或任何其他指针类型）的代码在 C# 中将始终是“不安全”代码。如果不完全更改 API，就无法将其转换为“安全”代码。

话虽如此，这可以像这样在托管字节数组上工作：

```
private static void PrintHex(byte[] data, uint len)
{
    uint ctr;
    string sep;

    if (len > 64)
    {
        len = 64;
    }

    for (ctr = 0; ctr < len && ctr < data.Length; ctr++)
    {
        if (((ctr & 7) == 0) && (ctr != 0))
        {
            sep = "\n";
        }
        else
        {
            sep = "";
        }
        Console.Error.WriteLine("{0}{1:X}", sep, data[ctr]);
    }

    Console.Error.WriteLine("\n\n");
} 
```

这与“安全”托管数组 ( `byte[]`) 的工作方式相同。

此外 - 如果“len”只是数组长度，您可以完全消除该参数，因为托管数组包括它们的长度，这与指针不同：

```
private static void PrintHex(byte[] data)
{
    for (int ctr = 0; ctr < 64 && ctr < data.Length; ctr++)
    {
        string sep;
        if (((ctr & 7) == 0) && (ctr != 0))
        {
            sep = "\n";
        }
        else
        {
            sep = "";
        }
        Console.Error.WriteLine("{0}{1:X}", sep, data[ctr]);
    }

    Console.Error.WriteLine("\n\n");
} 
```

# java - 如何同时单步调试/调试多个 JBoss 项目？

> ID：11043724
> 
> 赞同：0
> 
> 时间：2012-06-15T01:55:28.417
> 
> 标签：java, eclipse, jboss

目前我有一个调用 JBoss RESTEasy Web 服务的 TestNG 项目。我可以像任何基于 Eclipse 的项目一样使用断点和调试透视图单步执行 TestNG 项目，但我不确定如何在多个项目中单步执行断点。有谁知道如何做到这一点？

作为一名前 .NET 开发人员，我习惯于通过附加到在 Visual Studio 中运行每个项目 (w3wp.exe) 的适当进程并像这样单步执行每个项目来调试 ASP.NET 和 WCF Web 服务和依赖项目。但是，在 JBoss 中，我不确定是否有等效的方法来做到这一点？

在此先感谢您的帮助。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-06-15T02:12:32.327

我找到了一些解决问题的信息（在 Windows 中运行 JBoss）。

编辑了以下文件：

C:\Program Files\jbdevstudio4\jbdevstudio.bat

...通过在顶部添加这一行：

```
set JAVA_OPTS=-Xdebug -Xnoagent -Xrunjdwp:transport=dt_socket,address=8787,server=y,suspend=y %JAVA_OPTS% 
```

...然后通过执行相同的批处理文件（而不是从桌面或快捷方式运行 JBoss）来运行 JBoss。这允许我在调试运行 JBoss AS 服务器之后从 TestNG 项目连接到 RESTEasy 项目断点。

不知道为什么 JBoss 不允许我按原样连接到 RESTEasy Web 服务。欢迎任何意见。

# lingo - 在调试器停止时滚动鼠标时出现此消息是什么？

> ID：11043727
> 
> 赞同：1
> 
> 时间：2012-06-15T01:56:13.977
> 
> 标签：lingo, adobe-director

## 问题

使用 Director 11.5 和 Windows 7 以及[MouseWheel Xtra](http://www.mods.com.au/xtras/) (wheelmouse.zip)，当我在调试器停止时滚动鼠标时，我会在消息窗口中看到以下消息：

```
lcr_stk_PopFrame: unbalanced stk lcr_stk_PopFrame: unbalanced stk prev=1560 top=1568 
```

然后，通常不再可能继续单步执行代码或检查变量、打开列表等。有时 Director 会崩溃。

如果在调试器中停止时我不滚动，则没有问题。但是调试的时候真的很难不滚动...

## 如何重现

*   创建一部新的导演电影
*   把东西放在舞台上
*   将以下代码粘贴到电影脚本中
*   在 on mouseDown 处理程序中放置一个断点
*   点击舞台
*   滚动鼠标滚轮
*   尝试在处理程序中逐步并在变量检查器中打开列表

行话代码：

```
on startmovie
  put "sartWheelMouse"
  startWheelMouse()
end

on stopMovie
  put "closeWheelMouse"
  closeWheelMouse()
end 

on WheelMouseEvent (nVal)
  -- This is a workaround. Putting the param or an integer allows further operation.
  -- Without it, putting a string or even assigning a string to a var will 
  -- produce problem if user scrolls while stopped in debugger
  --put nVal

  -- this one doesn't harm
  aa = 45

  -- problem if the workaround is not present
  aa = "SAGFD"

  -- problem if the workaround is not present
  aa = string(34)

  -- problem if the workaround is not present
  put "wheelMouseEvnt enter"

end

on mouseDown me
  put "mousedown"

  -- Put a breakpoint here. THen step by step and open the list in the variable inspector
  -- Without the workaround in WheelMouseEvent, if you scroll while the debugger is stopped, 
  -- the debugger doesent work anymore, the list cannot be inspected and sometimes, Director crashes.
  a = 32
  b = "a234"

  lst = ["asdfk asldjasdflkj", "asdfk asldjasdflkj", "asdfk asldjasdflkj"]

  a = 32
  b = "a234"

end 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-06-15T01:56:14.677

我没有真正的解决方案，而是一种解决方法。

正如评论中所解释的，只需在 WheelMouseEvent 处理程序中添加一个带有整数的 put，问题就消失了。

```
put nVal 
```

如果有人找到另一种解决方案，比填充消息窗口更离散，我很感兴趣。

# .net - WinForm中如何清除用户控件的内存？

> ID：11043730
> 
> 赞同：2
> 
> 时间：2012-06-15T01:56:20.823
> 
> 标签：.net, winforms, memory, dispose

我有一堆用户控件，每一个都在不同的菜单选择上填充屏幕，我想 KILL 前一个（以清除内存），我不能硬编码，因为我在运行时不知道哪个是之前显示的控件。只是从表单中删除控件 `this.Controls.Remove('uc_foo')`并不能完全清除内存（我检查了 taskmgr）

使用 foreach 和应用迭代表单的控件`object_reference = null`会导致错误“无法分配，因为它是 foreach 迭代变量”。

访问`this.Controls[i]`= null 被拒绝，因为它是只读的

那么我该如何摆脱它呢？

**更新**据我所知，如果我从表单中删除控件并且没有任何其他引用它，最终它会从内存中清除，它不会像我写的那样立即出现`object_reference = null`，因此我不会看到taskmgr 中的内存立即下降，但垃圾收集会在心情好的时候完成

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-06-15T01:59:06.317

正确的。删除控件不会丢弃它。

尝试

```
if (this.Controls.ContainsKey("uc_foo"))
  this.Controls["uc_foo"].Dispose(); 
```

# jquery - 为什么在 jquery 中输入 $this = $(this)

> ID：11043733
> 
> 赞同：2
> 
> 时间：2012-06-15T01:56:49.713
> 
> 标签：jquery

我是 jQuery 新手，注意到有人去了：

```
var $this = $(this); 
```

为什么要这样做？是为了省打字吗？它对性能有帮助吗？这是相当标准的做法吗？

我也开始做一些事情，比如：

```
var minus_button = $('#minus_button'); 
```

这是否应该`var $minus_button = $('#minus_button');`表明它是一个 jquery 对象？

我阅读了[http://docs.jquery.com/JQuery_Core_Style_Guidelines](http://docs.jquery.com/JQuery_Core_Style_Guidelines)但找不到任何建议。

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2012-06-15T01:59:00.700

是的，这是一个命名约定，表明该变量是一个 jquery`object`引用。这样一来，是否可以使用jquery*或者*是否需要转换成jquery来应用就很明显`function`了。`object` *`object``object``function`*

 *例子：

```
var element = document.getElementById('myelement');
var $element = $('#myelement');

// not a jquery object
console.log($(element).val());
// jquery object
console.log($element.val()); 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-06-15T02:09:05.550

它只是[匈牙利符号](http://en.wikipedia.org/wiki/Hungarian_notation#Disadvantages)的一种形式。*

# python - windows xp pro上的lxml 2.3.4安装错误

> ID：11043737
> 
> 赞同：3
> 
> 时间：2012-06-15T01:57:20.327
> 
> 标签：python, lxml, easy-install

我在 windows xp pro sp 3 上。

OK，所以基本上`easy_install lxml`是行不通的。我有这样的错误：`Setup script exited with error: Unable to find vcvarsall.bat`. 但是在我下载并安装了 Visual Studio 2008 express 之后，出现了一个新的错误：`ValueError: [u'path']`. 找了一圈没找到解决办法，求大神帮忙？

谢谢

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-06-15T02:10:45.183

您似乎没有安装 Microsoft 的编译器。
您还有其他几个选择：

*   （**推荐**）在某个地方找到一个预编译的二进制文件，例如：[http ://www.lfd.uci.edu/~gohlke/pythonlibs/#lxml](http://www.lfd.uci.edu/~gohlke/pythonlibs/#lxml)
*   下载 MinGW 编译器并指向`easy_install`它...

* * *

如果您选择安装编译器，请遵循以下说明：

1.  安装 MinGW 编译器
2.  将 MinGW 编译器的 bin 目录添加到您的 PATH env var （详细说明在接受这个 SO 问题的答案：[如何将 MinGW bin 目录添加到我的系统路径？](https://stackoverflow.com/questions/5733220/how-to-add-mingw-bin-diretory-to-my-system-path)）
3.  做以下两件事之一
    ：在命令行参数中指定要使用的编译器：
    `python setup.py install build --compiler=mingw32`
    b．或者对于更永久的解决方案进行修改`\Lib\distutils\distutils.cfg`——如果它不存在，请继续创建它——并添加此部分：

```
[建造]
编译器=mingw

```

# html - Rails 中的嵌套 HTML 标签

> ID：11043738
> 
> 赞同：0
> 
> 时间：2012-06-15T01:57:37.050
> 
> 标签：html, ruby-on-rails-3.1

我有一个问题，re：在 Rails 中创建嵌套的 html 标签，因为我只是在学习 rails。

基本上，我正在尝试重构一些看起来像这样的代码：

```
<a id="myid" href="/mylink">MainLinkText<span>Subtext</span></a> 
```

但是，当我在 link_to 中使用 contact_tag 时，我无法让它显示 MainLinkText。我的代码如下所示：

```
link_to content_tag(:span, "Subtext"), mylink_path, :id => "myid" 
```

但我不知道如何在其中获取“MainLinkText”。有没有一种干净的方法可以做到这一点？

提前致谢

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-06-15T01:59:32.277

```
link_to "MainLinkText #{content_tag(:span, "Subtext")}".html_safe, mylink_path, :id => "myid" 
```

# windows - 使用批处理文件插入字符串

> ID：11043742
> 
> 赞同：4
> 
> 时间：2012-06-15T01:58:29.810
> 
> 标签：windows, batch-file

我想使用批处理文件插入一个字符串来替换特定列中的空格说我有一个**input.txt**如下

```
field1      field2           field3
AAAAA       BBBBB            CCCCC
DDDDD                        EEEEE
FFFFF                        
GGGGG       HHHHH 
```

我需要在每个为空的字段上插入一个字符串“NULL”，并确保字段 1 不为空，并且**字段 2,3**有时会为空。此外，field1 &field2 之间的空间与 field2 & field 3 不同

**输出.txt**

```
field1      field2           field3
AAAAA       BBBBB            CCCCC
DDDDD       NULL             EEEEE
FFFFF       NULL             NULL    
GGGGG       HHHHH            NULL 
```

因为我仍然需要批处理文件脚本.. 我尝试编写代码（字段 2 始终从左侧 12 个字符开始，字段 3 始终从左侧 29 个字符开始）

```
@echo off

set line= 
for /F in (input.txt)do
if "!line:~12" equ " " 
write "NULL"   >> (i am not sure whether this work)

if "!line:~29" equ " "
write "NULL"  

echo .>> output.txt 
```

也许，任何人都可以纠正我的错误？谢谢！！

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-06-15T03:45:25.680

正如所承诺的，这是 Python 中的解决方案。该程序适用于 Python 3.x 或 Python 2.7。如果您对编程非常陌生，我建议您使用 Python 3.x，因为我认为它更容易学习。你可以从这里免费获得 Python：http: [//python.org/download/](http://python.org/download/)

Python的最新版本是3.2.3版；我建议你得到那个。

将 Python 代码保存在一个名为的文件中`add_null.py`并使用以下命令运行它：

```
python add_null.py input_file.txt output_file.txt 
```

代码，有很多评论：

```
# import brings in "modules" which contain extra code we can use.
# The "sys" module has useful system stuff, including the way we can get
# command-line arguments.
import sys

# sys.argv is an array of command-line arguments.  We expect 3 arguments:
# the name of this program (which we don't care about), the input file
# name, and the output file name.
if len(sys.argv) != 3:
    # If we didn't get the right number of arguments, print a message and exit.
    print("Usage: python add_null.py <input_file> <output_file>")
    sys.exit(1)

# Unpack the arguments into variables.  Use '_' for any argument we don't
# care about.
_, input_file, output_file = sys.argv

# Define a function we will use later.  It takes two arguments, a string
# and a width.
def s_padded(s, width):
    if len(s) >= width:
        # if it is already wide enough, return it unchanged
        return s
    # Not wide enough!  Figure out how many spaces we need to pad it.
    len_padding = width - len(s)
    # Return string with spaces appended.  Use the Python "string repetition"
    # feature to repeat a single space, len_padding times.
    return s + ' ' * len_padding

# These are the column numbers we will use for splitting, plus a width.
# Numbers put together like this, in parentheses and separated by commas,
# are called "tuples" in Python.  These tuples are: (low, high, width)
# The low and high numbers will be used for ranges, where we do use the
# low number but we stop just before the high number.  So the first pair
# will get column 0 through column 11, but will not actually get column 12.
# We use 999 to mean "the end of the line"; if the line is too short, it will
# not be an error.  In Python "slicing", if the full slice can't be done, you
# just get however much can be done.
#
# If you want to cut off the end of lines that are too long, change 999 to
# the maximum length you want the line ever to have.  Longer than
# that will be chopped short by the "slicing".
#
# So, this tells the program where the start and end of each column is, and
# the expected width of the column.  For the last column, the width is 0,
# so if the last column is a bit short no padding will be added.  If you want
# to make sure that the lines are all exactly the same length, change the
# 0 to the width you want for the last column.
columns = [ (0, 12, 12), (12, 29, 17), (29, 999, 0) ]
num_columns = len(columns)

# Open input and output files in text mode.
# Use a "with" statement, which will close the files when we are done.
with open(input_file, "rt") as in_f, open(output_file, "wt") as out_f:
    # read the first line that has the field headings
    line = in_f.readline()
    # write that line to the output, unchanged
    out_f.write(line)

    # now handle each input line from input file, one at a time
    for line in in_f:
        # strip off only the line ending
        line = line.rstrip('\n')

        # start with an empty output line string, and append to it
        output_line = ''
        # handle each column in turn
        for i in range(num_columns):
            # unpack the tuple into convenient variables
            low, high, width = columns[i]
            # use "slicing" to get the columns we want
            field = line[low:high]
            # Strip removes spaces and tabs; check to see if anything is left.
            if not field.strip():
                # Nothing was left after spaces removed, so put "NULL".
                field = "NULL"

            # Append field to output_line.  field is either the original
            # field, unchanged, or else it is a "NULL".  Either way,
            # append it.  Make sure it is the right width.
            output_line += s_padded(field, width)

        # Add a line ending to the output line.
        output_line += "\n"
        # Write the output line to the output file.
        out_f.write(output_line) 
```

运行此程序的输出：

```
field1      field2           field3
AAAAA       BBBBB            CCCCC
DDDDD       NULL             EEEEE
FFFFF       NULL             NULL
GGGGG       HHHHH            NULL 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-06-15T02:19:00.683

我认为您想要做的事情在 Microsoft“批处理”脚本中是不可能的。但是这里记录了一整套字符串运算符：

[http://www.dostips.com/DtTipsStringManipulation.php](http://www.dostips.com/DtTipsStringManipulation.php)

但是批处理文件很糟糕，我希望你可以使用更好的东西。如果您需要 Python 解决方案或 AWK，我可以为您提供帮助。

如果我是你，并且我真的打算在“批处理”脚本中执行此操作，我会使用`~x,y`列切片将每一行分成三个子字符串（`x`第一列在哪里，第二列在哪里`y`）。然后检查每个是否只是空格，对于只是空格的，替换为“NULL”。然后将子字符串重新连接成一个字符串，然后打印出来。在循环中执行此操作，您就有了程序。

# web-config - Autofac 在 Web.Config 上丢失注册编辑

> ID：11043750
> 
> 赞同：4
> 
> 时间：2012-06-15T01:59:31.667
> 
> 标签：web-config, autofac, asp.net-web-api

我有一个使用 ASP.NET MVC 4、WebAPI 和其他一些组件构建的分层 Web 应用程序。我使用最新版本的 Autofac 2.6.2.859 作为我的 DI 容器以及 MVC 和 WebAPI 集成。我在不同的层中设置了 autofac 模块，并且正在使用新的 RegisterAssemblyModules 来扫描 AppDomain 程序集以查找各种模块。

在启动时，一切都很好。当我编辑 web.config 文件并且应用程序预热时，我的注册丢失了。我得到一个 DependencyResolutionException -

> 在“My.Class.Name”类型上使用“公共绑定标志”找到的任何构造函数都不能使用可用的服务和参数调用：

所以我的注册没有被重新加载。有谁知道如何解决这个问题？我应该将初始化代码放在 Application_Start() 以外的其他地方吗？

**更新**

这是我的代码的样子

```
 public static class IoC
{
    public static void Configure()
    {
        var builder = new ContainerBuilder();
        var assemblies = AppDomain.CurrentDomain.GetAssemblies();

        //Assembly Modules            
        builder.RegisterAssemblyModules<NSUTriviaModuleBase>(assemblies);

        // Register API controllers using assembly scanning.
        builder.RegisterControllers(assemblies);

        // Register API controllers using assembly scanning.
        builder.RegisterApiControllers(assemblies);

        var container = builder.Build();
        // Set the dependency resolver implementation.
        var resolver = new AutofacWebApiDependencyResolver(container);

        GlobalConfiguration.Configuration.DependencyResolver = resolver;
        DependencyResolver.SetResolver(new AutofacDependencyResolver(container));
    }
} 
```

* * *

## 回答 #1

> 赞同：9
> 
> 时间：2012-06-20T08:03:59.283

我认为问题在于应用程序首次启动时所有程序集都加载到 AppDomain 中，但是当 IIS 回收 AppDomain 时，程序集仅按需加载。

尝试使用`GetReferencedAssemblies`on 方法`System.Web.Compilation.BuildManager`来获取引用程序集的列表。

```
var assemblies = BuildManager.GetReferencedAssemblies().Cast<Assembly>(); 
```

这应该会强制将引用的程序集立即加载到 AppDomain 中，从而使它们可用于模块扫描。

# asp.net - ASP.NET：如何在保持会话 cookie 的同时设置 HttpCookie 过期时间？

> ID：11043752
> 
> 赞同：0
> 
> 时间：2012-06-15T01:59:36.870
> 
> 标签：asp.net

从[msdn](http://msdn.microsoft.com/en-us/library/system.web.httpcookie.expires.aspx)看来（页面底部的评论），如果您设置 HttpCookie 的 Expires 属性，它将成为存储在临时 Internet 文件夹中的持久 cookie。如果我希望它保留会话 cookie（这意味着当您关闭浏览器时，它就消失了），但仍想设置过期时间，比如 30 分钟，该怎么办？在使用 ASP.NET Membership API 时，可以在 web.config 中设置会话 cookie（身份验证 cookie）的过期时间，这意味着必须有一种方法可以设置会话 cookie 的过期时间。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-06-15T02:50:21.803

考虑到您的要求，我想说除非您有非常充分的理由使用 cookie，否则您应该使用该`Session`对象。

如果您没有在此 cookie 上存储“大量”信息和/或预计用户数量不会很大，这似乎是最佳选择。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-06-15T02:06:33.840

你有没有尝试过这样的事情：

```
this.Response.Cookies["d"].Expires = DateTime.Now.AddMinutes(30); 
```

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-06-15T05:38:24.230

您也许可以添加另一个 cookie（也是一个会话 cookie），其中包含一个 DateTime，它告诉您的应用程序第一个 cookie 的有效期。然后，每当您的应用程序读取第一个 cookie 时，它​​还会检查新 cookie 以查看它是否仍然有效。

我认为这或多或少是会员的做法。尽管在这种情况下只有一个 cookie，但该 cookie 包含多个字段（信息片段）。

# java - 在 Java Swing 中添加组件？

> ID：11043773
> 
> 赞同：2
> 
> 时间：2012-06-15T02:02:39.230
> 
> 标签：java, swing, user-interface, layout-manager

该`.add`方法将组件附加到另一个组件的末尾。我正在尝试将一个组件添加到另一个组件的开头。我将如何做到这一点？

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-06-15T02:23:22.070

我认为您可以使用[add(Component, int)](http://docs.oracle.com/javase/7/docs/api/java/awt/Container.html#add%28java.awt.Component,%20int%29)方法，其中`int`指定插入位置。零的插入位置应该可以在前面添加一个组件。

* * *

（我不知道这是否是正确的方法。也许布局管理器会更好。）

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2012-06-15T02:24:02.773

`Component`有一个[add](http://docs.oracle.com/javase/7/docs/api/java/awt/Container.html#add%28java.awt.Component,%20int%29)方法，它接受两个参数 - 要添加的对象和要插入的对象的索引。考虑到这一点，您可以尝试通过执行以下操作来添加组件：

```
 comp.add(newPanel, 0);
 comp.validate(); 
```

* * *

## 回答 #3

> 赞同：3
> 
> 时间：2012-06-15T02:10:18.623

您应该使用[*布局管理器*](http://docs.oracle.com/javase/tutorial/uiswing/layout/using.html)来完成此操作。标准布局管理器是每个容器默认启动的那个，它只是在末尾添加项目。

例如，像这样的东西可以解决问题：

```
JPanel panel = new JPanel();
panel.setLayout(new BorderLayout());
panel.add(lowComponent,BorderLayout.CENTER);
panel.add(highComponent,BorderLayout.NORTH); 
```

# delphi - 与原始图像相比，加载到图像控件后图像质量较差

> ID：11043801
> 
> 赞同：4
> 
> 时间：2012-06-15T02:06:40.190
> 
> 标签：delphi

我有一个将图像加载到 Zimage(graphcontrol) 的应用程序。我遇到的一个问题是原始图像的质量比最终显示在组件中的图像要好得多。显示的那个看起来上面有随机的黑色标记。所以我做什么：

*   将图像从文件夹加载到 TJpegimage
*   将 jpg 分配给位图
*   将位图保存到对象列表
*   重复上述操作，直到所有图像都加载到对象列表中

*   然后我创建一个位图

*   将对象列表中的第一个图像分配给它
*   在画布上绘制位图。

但它看起来比原版差很多。对此有任何帮助或想法吗？

这是加载代码。

```
 procedure TForm1.LoadImages(const Dir: string);
var
  i: Integer;
  CurFileName: string;
  JpgIn: TJPEGImage;
  BmpOut: TBitmap;
begin

//set up progress bar
 progressbar1.Min := 0;
 progressbar1.Max := GetFilesCount(dir,'*.*');
 Label3.Visible := true;
 progressbar1.Visible := true;
//sets array for length
  SetLength(hwArray,GetFilesCount(dir,'*.*'));
//sets index for object list
  CurIdx := -1;
  i := 0;
  while True do
  begin
//gets file name out of current folder
    CurFileName := Format('%s%d.jpg',
                          [IncludeTrailingPathDelimiter(Dir), i]);
    if not FileExists(CurFileName) then
      Break;
//count files in folder for progress bar.
     progressbar1.StepBy(1);
//creates jpgin
    JpgIn := TJPEGImage.Create;
    try
//loads jpgin with file
      JpgIn.LoadFromFile(CurFileName);
//creates TBitmap and sets width to same as jpgs
      BmpOut := TBitmap.Create;
      bmpout.Width := jpgin.Width;
      bmpout.Height := jpgin.Height;
     try
         BmpOut.Assign(JpgIn);
//adds 1 to index for object list. thus starting at 0
         curIdx := curIdx+1;
//add bitmap to objectlist
         CurIdx:= mylist.Add(TBitmap(bmpout));
         hwArray[CurIdx][0]:=jpgin.Width;
         hwArray[CurIdx][1]:=jpgin.height;

      finally
      end;
    finally
      JpgIn.Free;
    end;
    Inc(i);
  end;
//makes sure cout is above 0 thus files added
  if mylist.Count > 0 then
  begin
      try
      CurIdx := 0;
      getBitmapfromList(CurIdx,bmpout);
      ZImage1.Bitmap.Assign(bmpout);
       //image1.Canvas.Assign(bmpout);
    finally
       BmpOut.Free;
    end;
  end;
  Label3.Visible := false;
  progressbar1.Visible := false;
  page:= '0';
  zimage1.DblClick;
end; 
```

函数从列表中获取位图

```
procedure Tform1.getBitmapfromList(index:integer;var Bitm:TBitmap);
begin
     Bitm.Assign(TBitmap(mylist[index]));
     if (Bitm.Width<>hwArray[index][0]) OR (Bitm.Height<>hwArray[index][1]) then begin
        ShowMessage('Size differs');
        Bitm.Width:=hwArray[index][0];
        Bitm.Height:=hwArray[index][1];
     end;
end; 
```

下一个按钮查看下一个图像

```
procedure TForm1.Button3Click(Sender: TObject);
var
  BmpOut: TBitmap;
begin
bmpout := TBitmap.Create;
CurIdx:= strtoint(page);
getBitmapfromList(CurIdx,bmpout);
ZImage1.Bitmap.Assign(bmpout);
//image1.Canvas.Assign(bmpout);
page := inttostr(strtoint(page) +1);      //this should show next item in ilst?
zimage1.Repaint;
end; 
```

感谢您的任何帮助或建议。

以下是图片：

[http://s7.postimage.org/48mectvsp/image_Difference.png](http://s7.postimage.org/48mectvsp/image_Difference.png)

# 编辑

似乎一旦我放大图像，它就会变得更好。最糟糕的 quility 是当它的全屏/完全缩小时.. 原始尺寸。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-06-15T09:22:19.163

*   a）我假设所有图像都有不同的大小。如果显示的图像“ZImage1”应该始终具有相同的**高度或宽度**（两件事之一，或者它是用拉伸配合制作的==低质量）必须确定比率（orginal.height / original.width）。然后“ZImage1”（高度或宽度）必须在新关系中**计算。**
*   b) 设置 ZImage1.AutoSize:=false;
*   c) 设置 ZImage1.Stretch:=false;

*   d) bmpout.Width 和 Height 必须设置为当前`mylist[CurIdx]`大小。

> ```
> bmpout.Assign(TBitmap(mylist[CurIdx]));
> Zimage1.Bitmap.Width := bmpout.Width;
> Zimage1.Bitmap.Height := bmpout.Height;
> ZImage1.Bitmap.Assign(bmpout); 
> ```

笔记：

您没有*****将 **分配*给 mylist .. 您**将**其存储 CurIdx:= mylist.Add(TBitmap(bmpout));

我看不到您是如何创建“mylist”的。

也许这就是原因，如果你想要它回来`bmpout.Assign(TBitmap(mylist[CurIdx]));`，也许**没有自动**设置 bmpout.Width 和 bmpout.Height。

提示：

创建一个额外的数组来存储高度和宽度。

```
....
JpgIn.LoadFromFile(CurFileName);
BmpOut := TBitmap.Create;
bmpout.Width := jpgin.Width;
bmpout.Height := jpgin.Height;
....
CurIdx:= mylist.Add(TBitmap(bmpout));
hwArray[CurIdx][0]:=jpgin.Width;
hwArray[CurIdx][1]:=jpgin.height;
.... 
```

进行程序 **编辑**：对其进行测试；

```
procedure getBitmapfromList(index:integer;var Bitm:TBitmap);
begin
     Bitm.Assign(TBitmap(mylist[index]));
     if (Bitm.Width<>hwArray[index][0]) OR (Bitm.Height<>hwArray[index][1]) then begin
        ShowMessage('Size differs');
        Bitm.Width:=hwArray[index][0];
        Bitm.Height:=hwArray[index][1];
     end;
end; 
```

调用它：

```
....
getBitmapfromList(CurIdx,bmpout);
....
ZImage1.Bitmap.Assign(bmpout);
.... 
```

**编辑：**创建**hwArray**

```
type
  Tarray2size = Array[0..1] of integer;
.... 

var
  hwArray : Array of Tarray2size;
....

procedure TForm1.LoadImages(const Dir: string);
....
begin
 //set up progress bar
 progressbar1.Min := 0;
 showmessage(inttostr(GetFilesCount(dir,'*.*')));
 SetLength(hwArray,GetFilesCount(dir,'*.*'));
.... 
```

# sql - 经常性计费数据库设计

> ID：11043802
> 
> 赞同：7
> 
> 时间：2012-06-15T02:06:54.730
> 
> 标签：sql, database-design, atk4

我正在编写一个应用程序，该应用程序将涉及每月（或每周）固定金额的定期计费，并且它可以持续到订阅被取消。客户可以提前几个时期付款。他可以取消订阅，然后在某些未付费期后回来。我需要系统让我知道某个时期何时过期。

所以我正在思考如何设计数据库（也许不是数据库问题，而是编程问题），

有人来过这种应用吗？采取了什么方法？

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-06-15T03:23:02.603

我认为你可能试图在设计上变得过于聪明并过度思考它。如果您考虑业务问题，则每个付款间隔实际上都是一张发票。为什么不直接创建一个发票表，并让计划作业根据每个帐户的周期以及在该间隔内是否处于活动状态，以特定间隔插入发票。

通过拥有一个实际的发票行，您将获得一个 InvoiceID，您可以在向客户寻求付款时参考该 ID，并单独跟踪每个帐单的付款状态。

有时简单是最好的。

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2012-06-15T02:40:20.173

我认为你把它复杂化了。

创建表用户：

```
pk id_user
nm_user
fl_status (active, canceled, pendent, etc) 
```

创建一个用户对多个订阅的表订阅：

```
pk id_subscription
fk id_user
fl_type (maybe there are different subscriptions, with different prices)
dt_in
dt_out 
```

创建一个表支付一个订阅多个支付：

```
pk id_payment
fk id_subscription
fl_type (card, payment order, something else)
fl_status (generated, sent, confirmed, canceled because of subscription canceled, canceled because of something else, etc)
dt_generated
dt_sent
dt_confirmed
dt_canceled
[I think you will need another fields to follow and confirm the payment, but it depends of your payment model) 
```

现在您将需要构建一些每天在特定时间运行的机器人。

如果您获得所有活跃客户以及每个客户的最后一次付款，您将知道如果最后一次确认的付款与实际日期相比超过 x 天，是否需要生成新的付款（这取决于它是预付的、后付的， ETC）。如果是，则生成新的付款订单。

机器人将发送一封电子邮件或其他带有订单的东西（然后标记为）。

另一个机器人将使用您的付款模式确认付款。

当然，你需要很好地定义你的模型，因为每个用户状态都需要一个机器人来保持一切，直到它被取消或因为缺乏付款而被发送给法官。有很多工作要做，但没什么大不了的。

ps：如果涉及到一个更复杂的系统，数据库将持续存在，您将拥有您需要的所有信息，您有每个订单的日志，您知道每个订单发生了什么，因为它们有日期和状态。您可以估计每月有多少个到期日，一天后支付多少，两天后支付，依此类推。

# ios - NSInvocationOperation init 从类方法返回 nil 调用实例方法

> ID：11043804
> 
> 赞同：2
> 
> 时间：2012-06-15T02:07:04.063
> 
> 标签：ios, concurrency, nsoperation, nsoperationqueue

我正在尝试将 NSOperation 对象放入 NSOperationQueue。但似乎我误解了如何正确初始化 NSInvocationOperation （一个似乎为我的目的量身定制的子类，因为我想在操作队列中执行现有方法）。这是我正在尝试的：

```
OnlineServiceManager * sm = [[OnlineServiceManager alloc] initWithAsset:asset andViewController:viewController];
NSInvocationOperation * operation = [[NSInvocationOperation alloc] initWithTarget:self selector:@selector(pushAsset) object:sm];
[queue addOperation:operation]; 
```

该节在一个循环中运行，该循环提供要在操作中推送的新资产。当我调试这些行时，结果发现操作为 nil，表明找不到选择器。选择器是此类中的一个实例方法，具有以下签名：

```
- (void)pushAsset 
```

该节也在类方法中运行——我的意图是调用该类并指示它推送所有资产。

在搜索了我能找到的与这个案例相关的所有文档后，我看不出我做错了什么。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-06-15T02:26:15.623

self 是类对象，而 push 资产是一个实例方法，这可能是问题所在。如果将推送资产更改为类方法会发生什么？

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-06-15T13:34:33.973

您不能在类对象上调用实例方法。如果您希望 -pushAsset 继续作为实例方法，那么您必须给 NSOperation 一个实例来调用它（并且该实例必须在操作运行时仍然存在）。您要执行 -pushAsset 操作的对象是什么？这就是应该用作 Target 参数的内容。

# javascript - 当以前不知道href时在新选项卡中重定向

> ID：11043806
> 
> 赞同：1
> 
> 时间：2012-06-15T02:07:23.190
> 
> 标签：javascript, jquery

我有一个链接和一个函数，当该链接被点击时，它会监听并触发。

问题是链接事先是未知的。因此，在此函数中，向服务器发出 ajax 请求以检索它。有一个严格的要求，链接必须只有在用户请求的情况下才能生成，并且不能预先生成。

然后，您如何将新选项卡中的用户重定向到该链接？

**重新措辞**

所以假设我有

```
<a href="unknown" target="_blank">My Link</a> 
```

还有一个在点击时触发的事件处理程序。

我尝试了几种不同的方法。第一次

```
$('a[href="unknown"]').click(function(ev) {
 $.ajax({
      type: "GET",
      url: "/get_link", 
      context: document.body
    }).done(function(response) { 
      link = response.link

      //substitute href of a to the new link

  });
}); 
```

意识到这不起作用，因为 ajax 是异步的，因此用户将首先被重定向到 unknown。然后，当收到响应时，href 将替换为正确的链接。

所以然后我尝试制作 ajax async:false，但仍然没有用，我也不愿意锁定浏览器。

最后，我尝试抑制默认行为，然后打开一个新窗口（但我无法使用 jquery 打开一个新选项卡）。

```
$('a[href="unknown"]').click(function(ev) {
 ev.preventDefault();
 $.ajax({
      type: "GET",
      url: "/get_link", 
      context: document.body
    }).done(function(response) { 
      link = response.link

      //substitute href of a to the new link
      window.open(link)

  });
}); 
```

显然，在谷歌搜索后，您无法在 jquery 中打开新选项卡，因为它基于用户的浏览器设置。

当用户单击一个链接（预先未知）时，如何在新选项卡中重定向用户，该链接触发使用 ajax 请求检索链接的 javascript 函数？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-06-15T21:10:36.577

您可以简单地使您的 ajax 同步：

```
$('a[href="unknown"]').click(function(ev) {
 $.ajax({
      type: "GET",
      url: "/get_link", 
      context: document.body,
      async: false
    }).done(function(response) { 
      link = response.link

      //substitute href of a to the new link

  });
}); 
```

似乎该设置已被弃用，我不确定替代方案应该是什么，但现在它可以工作。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-06-15T21:16:57.387

您也可以在服务器端执行此操作 - 将用户发送到已知 URL，然后将他们（HTTP 303）重定向到正确的 URL。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-06-19T00:02:09.693

The ideal solution was making this a two step process. I added a button, when clicked would perform an ajax request, get the desired link, then using some javascript would present new links with the desired destination in a new tab.

# python - PySide QWebView 和下载不支持的内容

> ID：11043807
> 
> 赞同：2
> 
> 时间：2012-06-15T02:07:47.043
> 
> 标签：python, qt, pyside, qtwebkit

以下是使用 PySide 演示 webapps 等的最小浏览器的代码。它通常可以按我的意愿运行，但我似乎不太了解如何成功下载 unsupportedContent。

在 Finished 方法中，self.reply.readAll() 返回一个空的 QByteArray。

任何帮助将不胜感激。谢谢

```
import sys
import os
from PySide import QtCore, QtGui, QtWebKit, QtNetwork

class Browser(QtGui.QMainWindow):

    def __init__(self):
        QtGui.QMainWindow.__init__(self)

        self.web = QtWebKit.QWebView()
        self.web.page().setForwardUnsupportedContent(True)
        self.web.page().unsupportedContent.connect(self.download)

        self.manager = QtNetwork.QNetworkAccessManager()
        self.manager.finished.connect(self.finished)

    def download(self, reply):
        self.request = QtNetwork.QNetworkRequest(reply.url())
        self.reply = self.manager.get(self.request)

    def finished(self):
        path = os.path.expanduser(os.path.join('~', unicode(self.reply.url().path()).split('/')[-1]))
        destination = QtGui.QFileDialog.getSaveFileName(self, "Save", path)
        if destination:
            filename = destination[0]
            with open(filename, 'wb') as f:
                f.write(str(self.reply.readAll()))
                f.close()

if __name__ == '__main__':
    app = QtGui.QApplication(sys.argv)

    browser = Browser()
    browser.web.load(QtCore.QUrl('http://127.0.0.1:8000'))
    browser.web.show()

    sys.exit(app.exec_()) 
```

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-07-13T16:58:14.833

在相当多的帮助下找到了解决方案。感兴趣的朋友可以看看最终版本的下载和完成功能如下：

```
def download(self, reply):
    self.request = reply.request()
    self.request.setUrl(reply.url())
    self.reply = self.manager.get(self.request)

def finished(self):
    path = os.path.expanduser(
        os.path.join('~',
                     unicode(self.reply.url().path()).split('/')[-1]))
    if self.reply.hasRawHeader('Content-Disposition'):
        cnt_dis = self.reply.rawHeader('Content-Disposition').data()
        if cnt_dis.startswith('attachment'):
            path = cnt_dis.split('=')[1]

    destination = QtGui.QFileDialog.getSaveFileName(self, "Save", path)
    if destination:
        f = open(destination[0], 'wb')
        f.write(self.reply.readAll())
        f.flush()
        f.close() 
```

# java - 如何始终使用 MulticastSocket 接收最新数据包？

> ID：11043808
> 
> 赞同：0
> 
> 时间：2012-06-15T02:07:57.203
> 
> 标签：java, sockets, client, multicast

我有一个用 Java 实现的程序，`MulticastSocket`以执行网络发现。`ArrayList`问题是，服务器每 5 秒向特定端口（在我的情况下为 4446）发送几个带有活动共享序列化的数据包，然后客户端接收到该数据包。但是，如果`ArrayList`修改了，服务器会在下一次发送时将其发送出去，但客户端在收到时会收到服务器很久以前发送的旧包。

这是一个例子：

`ArrayList`有 1 个元素。

服务器 -> 发送 -> 等待 5 秒 -> 发送数据包 #2 -> 等待 5 秒 ->*在时间范围内**修改`ArrayList`*-> 发送数据包 #3

客户端 -> 寻找活动共享 -> 接收数据包 #1 -> 1 个元素！好的！...（可以无限期等待——此时服务器已发送 #2 和 #3）

客户端 -> 查找活动共享 -> 接收 #packet 2 -> 1 个元素。不。

这就是失去所有一致性的地方，因为它应该（理想情况下）接收到数据包＃3。

有什么方法可以使客户端始终收到发送的最新数据包？谢谢你。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-06-15T03:01:03.947

这是网络通信中固有的竞争条件。数据源在其先前的报告传输到接收器时更改状态 - 此时您想要反转时间并更新已经在线的数据。我还没有找到任何方便的库可以做到这一点，所以我建议你按顺序处理你的数据包:)

真正的答案是正确的[*通信协议*](http://en.wikipedia.org/wiki/Network_protocol)。不是 TCP 或 UDP 之类的传输，而是您自己的*应用程序级协议*。虽然看一下[TCP 状态转换图](http://www4.cs.fau.de/Projects/JX/Projects/TCP/tcpstate.html)以获得一个很好的示例和启发 - 它表明您可以将一个相当复杂的问题视为一个可管理的状态机。在客户端和服务器端定义状态，定义事件和转换，并相应地编码。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-06-15T02:52:52.793

与 UDP 一样，多播与 TCP 不同，它不能保证向客户端交付或交付顺序。如果您没有得到＃3，客户可能会在收到之前丢弃数据。

我会仔细检查您对客户端/服务器代码操作的假设。

您是丢失数据包#3 还是只想在#2 之前发送数据包而忽略#2？如果是第二种情况，您将需要编写代码以便尽快收集所有数据包。一个选项是在循环中接收到数据包后立即尝试接收（），超时时间非常低。这可能意味着调整你的 so_timeout，这意味着内核往返，并且对每个数据包都这样做，会很昂贵。

更好的方法是让一个线程不断地从套接字读取数据，并将每个数据包放入另一个处理线程从中读取的 BlockingQueue 中。通过这种方式，您不必太在意接收超时，并且由于它只是在消耗，您将尽可能快地获取数据包，因为 jvm 可以从套接字读取它。

# azure - 单元测试 Azure 表存储类

> ID：11043810
> 
> 赞同：0
> 
> 时间：2012-06-15T02:08:25.837
> 
> 标签：azure, mocking, azure-storage, azure-table-storage

我一直在尝试查找是否可以轻松隔离和测试 azure 表存储依赖项，但无济于事。我相信模拟/伪造 ATS 依赖项真的很难。我很惊讶 Azure 团队如何在 TDD/BDD 等时代忽略这一点。或者我错过了什么？据我了解，它具有非常少的接口/抽象类，这使得隔离它们变得困难。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-06-15T02:36:37.367

您通常应该模拟检索或保留数据的存储库。这些可以很容易地被嘲笑。您为什么要尝试模拟 ATS 依赖项本身？

此外，不需要继承 TableServiceEntity。随意实现您自己的界面 - 如果出于某种原因您需要自己模拟实体。

# objective-c - 将数据从 NSURLConnection 附加到 NSMutableData 对象失败

> ID：11043811
> 
> 赞同：1
> 
> 时间：2012-06-15T02:08:29.153
> 
> 标签：objective-c, ios, ios5, nsdata

我正在尝试从 API 中检索 JSON 文件以进行解析。我正在使用 NSURLConnection 来获取数据。它的委托接收响应并确认 MIME 类型为`application/json`. 但是，当委托调用此方法时：

```
-(void)connection:(NSURLConnection *)connection didReceiveData:(NSData *)data
{
    NSLog(@"Received route data");
    [self.receivedData appendData:data];
    NSLog(@"Data length: %d", data.length);
    NSLog(@"Data length in property: %d", self.receivedData.length);
} 
```

它将长度记录`data`为某个整数。但是，它将长度记录`receivedData`为 0。如果附加数据，这显然是错误的。

`receivedData`是我在初始化包含它的对象时`NSMutableData`使用的类型。`self.receivedData = [[NSMutableData alloc] init]`我在附加数据时犯了错误吗？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-06-15T14:18:10.190

显然，我忘记设置`self.receivedData`为`strong`. 因此，只要初始化它的方法超出范围并导致它返回`nil`其他地方，它就会被释放。

# javascript - html5 动画绘制在前一帧之上

> ID：11043812
> 
> 赞同：0
> 
> 时间：2012-06-15T02:08:47.543
> 
> 标签：javascript, html

我正在尝试学习一些关于 html5 动画的知识，并提出了以下代码。问题是矩形只是与前一帧重叠。

最终，我想改变我的矩形的点来改变对象的形状。

```
function animate(){
        setInterval(drawCanvas, 40);

    }

function drawCanvas(){

        var canvas = document.getElementById('c'), context = canvas.getContext('2d');

        context.fillStyle = "rgb(250,250,250)";

         context.shadowOffsetX = 2; // Sets the shadow offset x, positive number is right
      context.shadowOffsetY = 2; // Sets the shadow offset y, positive number is down
      context.shadowBlur = 20; // Sets the shadow blur size
      context.shadowColor = 'rgba(0, 0, 0, 0.3)'; // Sets the shadow color
    context.beginPath();
    context.moveTo(10,10);
    context.lineTo(800,10);
    context.lineTo(800,180);
    context.lineTo(10,180);
    context.lineTo(10,10);
    context.fill();
    context.closePath(); 
} 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-06-15T02:16:41.450

如果您不想重叠，则必须清除画布。

```
context.clearRect(0, 0, canvas.width, canvas.height); 
```

# c# - 在 MouseMove 之后防止 MouseClick 事件

> ID：11043814
> 
> 赞同：2
> 
> 时间：2012-06-15T02:09:18.973
> 
> 标签：c#, .net

我在可垂直拖动的标签页中有一个用户控件。控制也是可选择的。我希望用户能够单击该项目以选择它，但我不希望在他们完成拖动后触发 MouseClick 事件 - 只有 MouseUp 事件应该触发。IE。用户完成拖动后不应选择该项目。有什么建议吗？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-06-15T04:44:59.990

我假设这是 WinForms。

当你说你有一个用户控件时，你的意思是你有一个派生自的类`UserControl`吗？在这种情况下，您可以覆盖该`OnMouseClick`方法而不是 call `base.OnMouseClick(e)`，这将阻止`MouseClick`触发。

就像 SamHi 建议的那样，您可以使用`true`在拖动开始时设置为的布尔值，一旦`OnMouseClick`被调用，您可以将该布尔值设置为 false，从而允许在拖动完成后发生鼠标单击。

例子：

```
public class MyUserControl : UserControl
{
    bool dragging = false;

    // ...

    protected override void OnMouseClick(MouseEventArgs e)
    {
        if (dragging)
        {
            // We've finished dragging, don't call MouseClick
            dragging = false;
            return;
        }

        // Not dragging, fire MouseClick
        base.OnMouseClick(e);
    }
} 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-06-15T02:50:51.330

尝试在拖动时设置一个等于 true 的拖动布尔值，然后在短时间运行后将其关闭。这样，您可以在 MouseClick 事件中添加一条 if 语句，以查看它是否最近被拖动。

# c - 访问 CIE L* a*b* 颜色空间中的像素信息

> ID：11043815
> 
> 赞同：2
> 
> 时间：2012-06-15T02:09:52.680
> 
> 标签：c, image-processing, opencv, rgb

我将 OpenCV 用于我的一些图像处理相关代码。我被困在一个特定的点上。

在特定代码中，我需要根据图像的 CIE L*a*b* 值比较图像的像素值。我知道对于 BGR，我们可以做这样的事情：

```
// img is the image, suppose
uchar *data = ( uchar* )img->imageData;

for(i=0; i< img->height; i++)
    for(j=0; j<img->width; j++)
     {
         b = data[i*img->widthStep + j*img->nChannels + 0];
         g = data[i*img->widthStep + j*img->nChannels + 1];
         r = data[i*img->widthStep + j*img->nChannels + 2]; 
     } 
```

我的问题是，我们可以为 l*a*b* 颜色模型做类似的事情吗？我的意思是起初我将图像转换为

```
cvCvtColor(img, lab, CV_BGR2Lab); 
```

然后像上述情况一样访问单个通道信息（因为 L*a*b* 也由 3 个通道组成，如果没有错的话），我们可以获得像素值吗？

我问这个的原因是我试图实现它，但是我得到了一些真正奇怪的值，比如非常高的负数（我使用 int 数据类型而不是 uchar，因为我不确定范围 'a' 和 'b' 可以有），而在维基百科中，我看到“L”的值只能在 0 到 100 的范围内。那么我怎样才能得到这些像素值呢？

提前致谢 ！！

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-06-15T02:29:45.750

当然，你可以做到这一点，为什么不呢？但是请注意，输出有些特定（因为`a`并且`b`可能是负数）：

> ```
> On output 0≤L≤100, -127≤a≤127, -127≤b≤127
> The values are then converted to the destination data type:
>     8-bit images:
>         L <- L*255/100, a <- a + 128, b <- b + 128 
> ```

请注意，`L`它也缩放到 0-255 范围（而不是 0-100）。[在这里](http://www.seas.upenn.edu/~bensapp/opencvdocs/ref/opencvref_cv.htm)查看更多。

*顺便说一句，如果您的数据类型是无符号*字符，您如何获得负数？

# matlab - matlab中的randn函数问题

> ID：11043819
> 
> 赞同：2
> 
> 时间：2012-06-15T02:10:47.693
> 
> 标签：matlab, random, normal-distribution

我正在使用 matlab 的 randn 函数从标准正态分布中生成随机随机数。我可以在帮助中看到这个例子

```
r = 1 + 2.*randn(100,1); 
```

它说它从平均值为 1 和标准差为 2 的正态分布中提取数字。但是，当我计算 r 的平均值时。大约是 0.77。所以我有点困惑。谁能解释一下？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-06-15T02:15:13.327

当样本数量接近无穷大时，算术平均值（样本平均值）将收敛到分布的实际平均值。但是，对于任何有限数量的样本，您不能保证获得分布的实际均值（即 1.0。）

尝试

```
 r = 1 + 2.*randn(100,1);  mean(r)
   r = 1 + 2.*randn(1000,1);  mean(r)
   r = 1 + 2.*randn(10000,1);  mean(r)
   r = 1 + 2.*randn(100000,1);  mean(r) 
```

等等，看看会发生什么。

# algorithm - 30,000 个数据点，找出 2 周内的最大变化

> ID：11043821
> 
> 赞同：6
> 
> 时间：2012-06-15T02:11:02.590
> 
> 标签：algorithm

我有：

```
- 30,000 data points
- each data point is a measurement of type float
- each measurement is associated with a date
- each date has only one measurement
- no dates are without measurements
- the data comes in the form of a text file: 30,000 lines in this form:
    - YYYY-MM-DD I,F (e.g. 1977-02-08 20.74)
- measurement appearing in the source file are already sorted by date 
```

我需要：

```
- a time-interval T with boundaries (s,e) /* start, end */
- (s - e = 14 days) the time-interval *must* be 2 weeks
- define min as the lowest value in the interval T
- define max as the greatest value in the interval T
- the chosen T needs to have the greatest distance btwn max and min of all possible Ts
- break ties among intervals T by choosing the most recent (with the greatest s value)
- the chosen T must consider all jumps in the 14 days, not just the values @ s and e
- if the overall "variance" in the interval is great but the jump 
  |max-min| is not the greatest in absolute value, T is not the right choice,
  even if it's an "exciting" interval 
```

我在问：

```
- which algorithm to employ, considering algorithms are not my specialty
- which data structure to use to keep track of the subtotals 
```

笔记：

```
- an answer in pseudo code would be preferred, "prose" is fine if pressured for time
- an answer in Python would be... splendid :) 
```

如果需要，您可以生成“虚拟”数据并运行您提出的算法作为测试，或者我可以共享实际数据。

除了想知道最快的方法来学习如何应用正确的解决方案和正确的算法之外，我在这里不太关心性能。

我认为即使是最简单的迭代算法我也可以“证明”正确性，因为考虑到当今的计算机，数据集很小。

到目前为止，我正在“遍历并携带 14 个测量值的 14 个向量”，如果您能教我如何使用子和逐步执行此操作，那将非常感激。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-06-15T04:33:44.020

通过保留两个堆栈，滑动窗口确实在这里起作用（也许这有点误导，因为这可能最好实现为双向队列）。保留一个堆栈`minstack`和一个名为 的堆栈`maxstack`。该算法的关键是 minstack 应该严格**不减少**，而 maxstack 应该严格**不增加**幻灯片的所有点。那么，我们该怎么做呢？

首先，将前 14 个点添加到堆栈中。让我们定义`add(point)`为：

为 minstack 执行此操作：

*   当该点小于 minstack 的顶部元素时，删除 minstack 的顶部元素。
*   将点添加到 minstack。

同样，对于 maxstack：

*   当新点大于 maxstack 的顶部元素时，删除 maxstack 的顶部元素。
*   将点添加到 maxstack。

由于上面的属性，前 14 个元素的 min 和 max 应该是 minstack 和 maxstack 的底部元素。现在滑动窗口。我们只需要注意，如果左边的点在任何堆栈中仍然“活跃”，那么它现在必然是底部点。因此，这应该很容易，很简单：

```
slide():
    add(new_point)
    if (left_point == bottom(minstack)) remove_bottom(minstack)
    if (left_point == bottom(maxstack)) remove_bottom(maxstack) 
```

这样做直到你的积分用完。您要查找的区间`bottom(maxstack) - bottom(minstack)`是最大的区间。

请注意，任何点最多进入 minstack/maxstack 一次，每个点也最多离开堆栈一次，因此，无论所需间隔的大小是多少，每个点最多执行 4 次操作。

编辑：我刚刚注意到您想要在 Python 中实现。我真的不想解析数据，因此该函数将值列表作为输入，并输出该数组中的索引 (s,e)：

```
import collections

def add(x, minstack, maxstack):
    while minstack and x < minstack[-1]: minstack.pop()
    while maxstack and x > maxstack[-1]: maxstack.pop()
    minstack.append(x)
    maxstack.append(x)

def get_largest_interval(points):
    minstack = collections.deque()
    maxstack = collections.deque()

    best_diff = -1
    best_interval = None

    for index, elem in enumerate(points):
        add(elem,minstack,maxstack)
        if index >= 14:
            if minstack[0] == points[index-14]: minstack.popleft()
            if maxstack[0] == points[index-14]: maxstack.popleft()

        if index >= 13:
            this_diff = maxstack[0]-minstack[0]
            if best_diff == -1 or this_diff >= best_diff:
                best_interval = (index-13, index)
                best_diff = this_diff

    return best_interval

print get_largest_interval([0, 2, 2,2,2,2,2,2,2,2,2,2,2,2,3]) 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-06-15T03:55:59.147

如果我理解你，你有：

30,000 个不同的、有序的数据值。排序恰好是按日期，但这不相关。

在这个集合中，有 29,986 个子集，其中的内容是有序序列，从一个数据点开始，包含该初始点和 13 个后续数据点。

慢慢来：

1）将您的 30,000 个数据点读入一个大小为 30,000 的数组中。

2) 分配一个大小为 29,986 的数组。将此数组称为“潜在赢家”。

3) 通过扫描每个 14 点子集填充潜在赢家数组，暂时保存子集中遇到的最大值和最小值。当这两个值在手时，将 (Max-Min) 保存在“潜在赢家”中的索引位置（起点）。不要尝试任何滑动窗口优化；见下文。

4) 对潜在赢家进行线性扫描，保存价值和（重要的是）它所在的索引。

BTW：如果没有一个赢家，你会怎么做？如果所有数据点具有相同的值，您将获得 29,986 个候选获胜者，它们都具有相同的值。

5) 优化：不分配和填充潜在赢家；将 Current Winner 初始化为元组 (value, index) 为 (0, -1)。如上所述计算每个 14 点子集的值，但只保留 {Current Winner, "the value I get from this current subset"}

6) 滑动窗口：我没有考虑过，但我认为维护一个滑动窗口比上面描述的简单的线性传递更多的工作。

原因：好的，计算前14个点的值；得到一个最小值和最大值，并得到它们之间的间隔。但是等等，我们需要在下一个窗口中使用最小值和最大值。现在将窗口向上滑动一个位置。左端的值没了；但它是最小值、最大值还是介于两者之间？假设它是最小值，现在它已经消失了。第二最低的最小值是多少？我们没有那个信息。

为了保持滑动窗口，您需要对每个 14 个数据点的子序列进行排序并记住所有值的索引位置。然后，当您滑动时，您可以知道在左侧退出的值是旧最小值还是旧最大值，以及右侧进入的新值是新最小值还是新最大值。但这不值得努力。

（这种情况有点像 Boyer-Moore 快速子串查找算法。我不记得细节了，但它涉及预处理整个输入并保留每个值出现位置的表格。但这还很遥远-话题）

希望这可以帮助...

# port - 修改了Redmine的端口，但是邮件通知的链接还是默认的

> ID：11043823
> 
> 赞同：0
> 
> 时间：2012-06-15T02:11:07.447
> 
> 标签：port, redmine, email-notifications

我像这样开始redmine：

```
ruby /usr/share/redmine/script/server webrick -e production -b m.y.i.p -p 90 -d 
```

它运行良好。然后我创建一个问题，**电子邮件通知**会将问题的链接发送到我的电子邮件，其中包含 html 链接标记，例如： `<a href="http://m.y.i.p:3000/issues/16#change-19">16#</a>`

注意链接标签的属性**href**，端口还是默认的**3000**！这意味着当我单击它时它链接到无效地址。

**正确的链接是：**

```
<a href="http://m.y.i.p:90/issues/16#change-19">16#</a> 
```

这一定是我忘记配置的东西。我应该做些什么？我真的不知道如何解决它。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-04-24T07:22:34.253

我正在解决类似的问题，并在[项目论坛](http://www.redmine.org/boards/2/topics/2436)中找到了以下建议的步骤：

1.  单击最顶部栏中的管理。
2.  单击新页面上的设置。
3.  单击常规选项卡。
4.  页面下方大约三分之二是一个标有主机名的文本框。

# javascript - 将 .val() 转换为字符串 jQuery

> ID：11043825
> 
> 赞同：3
> 
> 时间：2012-06-15T02:11:16.193
> 
> 标签：javascript, jquery

我有一个 jQuery 函数，它从名为的表单输入文本对象中获取值，`content`用户可以在其中输入表单中的 HTML 标记。例如，用户键入带有`<b>`标签的“Sample”。一旦提交被触发，jQuery 就会从`content`.

```
var content = $('[name=content]').val(); 
```

我的问题是，如果用户有一个标签，可以说一个`<b>`标签，我想将原始 html 字符串输出给用户，而不是让它呈现。

我该怎么做？任何帮助将不胜感激，我是 jQuery 新手。

* * *

## 回答 #1

> 赞同：9
> 
> 时间：2012-06-15T02:13:41.577

`.val()`已经返回一个字符串。
您正在询问如何在不将其解析为 HTML 的情况下显示该字符串。

打电话`.text()`。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-06-15T02:23:22.727

好的，听起来您想在没有浏览器渲染的情况下显示代码。也许您想[将标签转换为 html 实体](https://stackoverflow.com/questions/2613582/convert-tags-to-html-entities)

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-06-15T02:32:43.737

如果没有 jQuery，你会这样做：

```
document.getElementsByName('content')[0].value; 
```

以获得用户输入的确切信息。

### 编辑

现在我明白了，您正在将值编写为另一个元素的 innerHTML，并且您希望显示文字文本，而不是标记。因此，继续使用 sans-jQuery 示例：

```
<script>
// Set the text content of an element
var setText = (function() {
    var d = document.createElement('div');
    if (typeof d.textContent == 'string') {
      d = null;
      return function(el, text) {
        el.textContent = text;
      };
    } else if (typeof d.innerText == 'string') {
      d = null;
      return function(el, text) {
        el.innerText = text;
      };
    }
}());
</script>

<input name="content">
<button onclick="
  setText(document.getElementById('d0'), 
          document.getElementsByName('content')[0].value);
">get value</button>
<div id="d0"></div> 
```

或者正如 SLaks 建议的那样（相当神秘）：

```
$('#d0').text($('[name=content]').val()); 
```

虽然我不知道为什么他或她的答案中没有。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2018-11-07T18:38:47.580

我也遇到了这个问题。我使用以下作弊方法修复了它：

```
var val = $("#item").val() + ""; 
```

# jquery - jqGrid cmTemplate 选项是否会干扰过滤器工具栏？

> ID：11043826
> 
> 赞同：0
> 
> 时间：2012-06-15T02:11:31.593
> 
> 标签：jquery, jqgrid

当您注释掉“sopt”选项但未注释的选项时，带有以下选项的网格与 filtertoolbar 可以正常工作，我[在这里放了一个 jsfiddle](http://jsfiddle.net/pwachira/9awcC/#base)。在我的真实网格中，我在所有网格之外指定了 cmTemplate `$.extend($.jgrid.defaults,{})`- 它仍然会导致同样的问题

```
$('#Table').jqGrid({
    cmTemplate: {
        searchoptions: {
           // sopt: ['eq', 'ne', 'cn'] //un comment this line then run again and try to use filtere to see the difference
        }
    },
    datatype: 'local',
    data: [{
        Code: 'code1'},
    {
        Code: 'code2'},
    {
        Code: 'code3'}],
    colNames: ['Code'],
    colModel: [{
        name: 'Code',
        index: 'Code'}],
    pager: '#Pager'
}).jqGrid('filterToolbar', {
    searchOnEnter: false,
    defaultSearch: 'cn'
}).trigger('reloadGrid'); 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-06-15T05:37:51.857

我在代码中看不到任何问题。如果你设置

```
cmTemplate: {
    searchoptions: { sopt: ['eq', 'ne', 'cn'] }
} 
```

您添加`searchoptions.sopt`所有没有设置的列。工具栏过滤每列只能使用一个搜索操作。jqGrid 使用`defaultSearch`参数 of`filterToolbar`进行搜索，但是为了能够对某些列进行另一个搜索操作，可以从`searchoptions.sopt`数组的第一个操作中覆盖它（例如，参见[答案）。](https://stackoverflow.com/a/5360780/315935)这是非常重要的功能，因为它确实需要。

因此，在*所有*列中包含`searchoptions: { sopt: ['eq', 'ne', 'cn'] }`选项实际上会覆盖to的选项。完全按照您发布的演示的方式工作。*`defaultSearch: 'cn'``filterToolbar``defaultSearch: 'eq'`*

# python - python和mysql命令行中的mysql插入错误

> ID：11043832
> 
> 赞同：1
> 
> 时间：2012-06-15T02:13:14.037
> 
> 标签：python, mysql, mysql-error-1062, mysql-error-1205

我想在 mysql db 中插入一些项目。

当我在我的 python 脚本中这样做时，我得到了：

> 错误 1062：密钥“product_code”的重复条目“222”。product_code 是一个唯一字段。

当我在 mysql 命令行中执行此操作时，我得到：

> 错误1205（HY000）：超过锁定等待超时；尝试重新启动事务。

mysql安装在win32上；该表的引擎是innodb。

代码：

```
conn = mdb.connect(user = 'root', passwd = '[REMOVED]', db = 'vancl')
cur = conn.cursor()

sql2 = "insert into vancl.vancl_query1(product_code) values('100000')"
print sql2
cur.execute(sql2)

cur.close() 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-06-15T02:15:53.383

这意味着该`product_code`列上放置了唯一索引约束。唯一索引约束告诉 MySQL 一个字段不能有重复值，即每个字段必须是**唯一的**。当该值已存在于列中的某处时，尝试将值 222 插入到 product_code 中时，您会遇到“重复输入”错误。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-06-15T04:03:23.090

> 现在，我重新创建一个与上一个相同的表。在脚本中，没有报错，但实际上没有插入数据。在命令行中，插入 sql 完美。

如果您使用像 InnoDB 这样的事务引擎，您的数据将不会被保存，因为 MySqlDb 默认为关闭自动提交。要将数据实际保存到数据库，您必须调用 commit

```
conn = mdb.connect(user = 'root', passwd = '[REMOVED]', db = 'vancl')
cur = conn.cursor()

sql2 = "insert into vancl.vancl_query1(product_code) values('100000')"
print sql2

cur.execute(sql2)

//Commit the data
conn.commit() 

cur.close() 
```

# ms-access-2007 - ms access 2007 级联下拉

> ID：11043837
> 
> 赞同：0
> 
> 时间：2012-06-15T02:13:31.717
> 
> 标签：ms-access-2007

我正在尝试创建几个级联下拉框（一旦我得到一个工作就可以了，我从最简单的开始）。我有一个主要类别 - 内窥镜检查，有 3 个选项，每个选项都有一个单独的表格。在我的表格上，我只有一个用于主要类别的框。我应该有第二个子类别吗？

我遵循了两年前提出的另一个问题的答案，并这样做了：

```
Private Sub Endoscopy_1_AfterUpdate()
Dim strRowsource As String
strRowsource = "SELECT Gastroscopy FROM tblEndo_Gastroscopy WHERE CategoryID = "
strRowsource = strRowsource & Me!tblEndoscopy
strRowsource = strRowsource & " ORDER BY Endo_Gastroscopy;"
Me!tblEndo_Gastroscopy.RowSource = strRowsource
End Sub 
```

当我这样做时，我得到一个运行时错误：2465 说 MS Access 找不到我表达式中提到的字段 'tblEndoscopy'。

我不是程序员，但确实有足够的理解来遵循指示。请帮忙。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-06-15T03:35:02.957

不看你的表格很难说，但我打赌你想要

`Me!Endoscopy_1`代替`Me!tblEndoscopy`

# objective-c - 在示例 gdata-objectivec-client 中出现“invalid_client”错误

> ID：11043840
> 
> 赞同：12
> 
> 时间：2012-06-15T02:13:55.507
> 
> 标签：objective-c, youtube, google-api-client

嘿，我刚刚从[http://code.google.com/p/gdata-objectivec-client/source/checkout](http://code.google.com/p/gdata-objectivec-client/source/checkout)下载并构建了 youtube 示例项目应用程序构建良好，我已经输入了客户端 ID 和密码。然后，当我使用我的 youtube 帐户登录并单击“允许”按钮时，我收到此错误

```
Error Domain=com.google.HTTPStatus Code=400 "The operation couldn’t be completed. (com.google.HTTPStatus error 400.)" UserInfo=0x6a03a350 {data=<7b0a2020 22657272 6f722220 3a202269 6e76616c 69645f63 6c69656e 74220a7d>, json=<CFBasicHash 0x6a01b6b0 [0xac0251a0]>{type = mutable dict, count = 1,
entries =>
2 : <CFString 0x6a01b720 [0xac0251a0]>{contents = "error"} = <CFString 0x6a054b90 [0xac0251a0]>{contents = "invalid_client"} 
```

或来自 xcode 日志：

```
2012-06-15 10:49:30.627 YouTubeSample[976:b03] Error Error Domain=com.google.HTTPStatus Code=400 "The operation couldn’t be completed. (com.google.HTTPStatus error 400.)" UserInfo=0x6980d2c0 {data=<7b0a2020 22657272 6f722220 3a202269 6e76616c 69645f63 6c69656e 74220a7d>}
Error data:
{
error = "invalid_client";
} 
```

我已经尝试创建和输入新的客户端 ID 以使用。看起来秘密没有被正确发送，因为如果我故意破坏它甚至将其留空，我会得到相同的结果。

有什么建议么？

* * *

## 回答 #1

> 赞同：32
> 
> 时间：2012-07-02T04:55:20.347

我有点晚了，但它可能会帮助别人..

在 Google API-Console 中创建一个新的客户端 ID 并将其设置为“Other”而不是“iOS”。它应该工作。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-06-10T10:45:58.453

我遇到了同样的问题，问题是 Google API 控制台**服务部分**中的“Google Maps SDK for iOS”被禁用。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-06-15T04:01:43.007

客户端 ID 和密码必须由[Google API 控制台](https://code.google.com/apis/console)颁发，专门用于已安装的应用程序（不适用于 Web 应用程序。）

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2016-03-03T17:24:36.737

就我而言，我没有使用正确的项目名称。我正在使用项目别名。使用正确的项目名称后，它解决了我的问题。

# python - Python 2.7.3 中无法识别 Python-tk 包

> ID：11043844
> 
> 赞同：7
> 
> 时间：2012-06-15T02:14:36.823
> 
> 标签：python, tkinter, python-2.7

当我运行以下代码时：

```
import Tkinter 
```

我收到此错误消息：

```
>>> import Tkinter
Traceback (most recent call last):
  File "<stdin>", line 1, in <module>
  File "/usr/lib/python2.7/lib-tk/Tkinter.py", line 42, in <module>
    raise ImportError, str(msg) + ', please install the python-tk package'
ImportError: /usr/lib/libtk8.5.so.0: invalid ELF header, please install the python-tk package 
```

但是，安装了 python-tk。

```
$ sudo apt-get install python-tk
Reading package lists... Done
Building dependency tree       
Reading state information... Done
python-tk is already the newest version.
0 upgraded, 0 newly installed, 0 to remove and 0 not upgraded. 
```

调查失败的原因，我查看了 Tkinter.py。这是失败的线路。

```
try:
    import _tkinter
except ImportError, msg:
    raise ImportError, str(msg) + ', please install the python-tk package' 
```

这是路径问题吗？任何帮助将非常感激。

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2012-06-15T02:23:57.780

似乎该库已损坏。尝试`sudo apt-get remove python-tk`，然后`sudo apt-get clean`重新下载包，`sudo apt-get install python-tk`然后再次尝试导入。另一种可能性是您不知何故弄乱了您的 apt/sources.list，并且您安装了一个适用于错误平台的库。

如果您尝试上述方法后仍然无法正常工作，请对此答案发表评论。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-06-15T18:25:37.923

我不确定问题是什么，但已经解决了。我的虚拟机在 VMware Player 更新期间损坏，所以我不得不重新安装。全新安装后，一切正常。谢谢您的帮助。

# php - 延长降价？

> ID：11043846
> 
> 赞同：3
> 
> 时间：2012-06-15T02:14:40.853
> 
> 标签：php, html, markdown

我有一个用户可以提交游戏报告的网站。我目前使用 markdown 和 HTMLPurifier 的组合来允许有限的标记。

我想添加内联照片支持，从用户图库中绘制图像。

我用一点 JS 构建了一个图像侧边栏，在缩略图单击时会在光标位置插入相应的降价代码片段。

这一切都很好，但不是降价处理这个标准代码并给我：

```
<img src="foo.jpg" /> 
```

我宁愿最终得到：

```
<a href="original/foo.jpg">
    <img src="foo.jpg" />
</a> 
```

即，自动链接到原始全尺寸图像。

因为代码和路径是可预测的，所以我可以在降价后的 HTML 步骤中通过字符串替换更改这些标签，但这似乎......不优雅。

我是否应该扩展或以其他方式修改`markdown.php`以给我一个定制的`'<img />`标记，或者由于某种我没有察觉的原因，这是一个坏主意？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-06-15T02:19:50.433

修改你的 markdown 解析器对我来说听起来是个好主意。您有权获得您想要的程序。请务必将您的更改也存储为补丁，以便您可以轻松地将它们重新应用到将来的 Markdown 版本。

# emacs - emacs dired-jump 键绑定不起作用

> ID：11043851
> 
> 赞同：2
> 
> 时间：2012-06-15T02:15:17.017
> 
> 标签：emacs, dired

我用 .emacs 写这个

```
(require 'dired-x)
(global-set-key (kbd "C-x C-j") 'dired-jump) 
```

但是当我启动 emacs 时，我可以使用 Mx dired-jump ，但是 Cx Cj 什么也没做。我用谷歌搜索了很多，也许是自动加载问题？任何人都可以解决它吗？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-06-15T02:28:03.253

`dired-x`默认情况下绑定`dired-jump`，因此如果您有`require`库，则不需要添加绑定（当然，除非您希望它在另一个键序列上）。

就是说，我不确定为什么这对您不起作用，但是在没有的情况下尝试一下`global-set-key`，看看是否有什么不同？

还要测试starting `emacs -Q`，`(require 'dired-x)`然后`C-j`进入`*scratch*`buffer，然后测试是否`C-x``C-j`绑定。

还要检查`dired-bind-jump`变量的值：

`M-x` `customize-group` `RET` `dired-keys` `RET`

默认情况下它是启用的，但是当禁用时，实际上似乎*取消设置*全局绑定（如果存在），因此根据实际执行顺序，这可能会撤消您设置的绑定。

# php - onblur/onfocus textarea 默认值进入 db php

> ID：11043854
> 
> 赞同：0
> 
> 时间：2012-06-15T02:16:04.403
> 
> 标签：php, jquery, html, database

我看到有人谈论过，但从未回答过。也许它有，我不知道在哪里可以找到它。

我有几个 textarea 并且 onblur/onfocus 工作得很好，但是当 textarea 为空时，“默认值”被插入到数据库中。我怎样才能防止这种情况发生？我不想要“在此处添加公共注释！！” 进入数据库。

```
 <td colspan="4"><textarea name="comments" onfocus="if(this.value==this.defaultValue)this.value='';" onblur="if(this.value=='')this.value=this.defaultValue;"> 
```

在此处添加公共注释！

任何人都可以将我推向正确的方向。谢谢！！

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-06-15T02:18:56.893

您应该检查表单提交事件的默认值并清空文本区域

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-06-15T02:21:47.170

好吧，您没有发布将其插入数据库的 PHP 代码，因此很难确切地告诉您该做什么，但基本上在上面的某个地方，您需要放置一个条件来重置 textarea 提交的值，如果它包含默认字符串。基本上像

```
<?php (isset($_POST['comments'] && $_POST['comments'] == 'Add Public Notes Here!!') {
    $comments = ''; } else { $comments = $_POST['comments']; } ?> 
```

当然，`$comments`您不需要使用包含要插入数据库的值的任何变量。除非您显示更多代码，否则我无法为您提供更多帮助。

# r - 使用 zoo 包找到最大的确定数据组

> ID：11043855
> 
> 赞同：3
> 
> 时间：2012-06-15T02:16:08.593
> 
> 标签：r, max, zoo

我只用了几个月的 R，我遇到了一个动物园系列的问题，每五分钟就有一次数据。该系列中没有缺失的时间点，但数据中有一些 NaN 值。

```
>str(SerieCompleta)
‘zoo’ series from 2011-01-01 to 2011-12-31 23:55:00
 Data: num [1:104737, 1] 0 0 0 0 0 0 0 0 0 0 ...
- attr(*, "na.action")=Class 'omit'  num [1:383] 2017 3745 5761 6786 6787 ...
 Index:  POSIXct[1:104737], format: "2011-01-01 00:00:00" "2011-01-01 00:05:00" ... 
```

我需要找到数据组的最大值，并且数据组应以 30 或更多连续分钟的零值分隔。

```
2011-01-02 05:15:00 0
2011-01-02 05:20:00 0
2011-01-02 05:25:00 0
2011-01-02 05:30:00 0
2011-01-02 05:35:00 0.1 |
2011-01-02 05:40:00 0.2 <--- maximum of group
2011-01-02 05:45:00 0.2 |
2011-01-02 05:50:00 0.1 |
2011-01-02 05:55:00 0.1 |
2011-01-02 06:00:00 0.1 |
2011-01-02 06:05:00 0.1 |
2011-01-02 06:10:00 0   |
2011-01-02 06:15:00 0   |
2011-01-02 06:20:00 0.1 |
2011-01-02 06:25:00 0
2011-01-02 06:30:00 0
2011-01-02 06:35:00 0
2011-01-02 06:40:00 0     thirty or more consecutive minutes with zero values on data
2011-01-02 06:45:00 0
2011-01-02 06:50:00 0
2011-01-02 06:55:00 0
2011-01-02 07:00:00 0.2 |
2011-01-02 07:05:00 2.5 <--- maximum of group
2011-01-02 07:10:00 0 
```

输出应如下所示：

```
2011-01-02 05:40:00 0.2
2011-01-02 07:05:00 2.5 
```

我不知道是否有办法使用 R 功能来做到这一点。提前感谢您的任何建议。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-06-15T05:17:38.077

我将调用您的数据列`x`（`x`仅包括数字数据，不包括日期和时间）。我将进一步假设您没有丢失的时间点，并且您的所有时间点相隔 5 分钟。这是一个函数，它将返回一个两列矩阵，其中每一行包含组的开始和结束索引（它忽略开始和结束的零）：

```
blocks <- function(x) {
    z <- rle(x==0)
    breaks <- which(z$lengths >= 6 & z$values == TRUE)
    breaks <- breaks[!breaks %in% c(1, length(z$lengths))]
    break.idx <- cumsum(z$lengths)
    cbind(c(1, break.idx[breaks] + 1), c(break.idx[breaks-1], length(x)))
} 
```

对于您的数据，您将获得

```
> x
 [1] 0.0 0.0 0.0 0.0 0.1 0.2 0.2 0.1 0.1 0.1 0.1 0.0 0.0 0.1 0.0 0.0 0.0 0.0 0.0
[20] 0.0 0.0 0.1 2.5 0.0
> blocks(x)
     [,1] [,2]
[1,]    1   14
[2,]   22   24 
```

现在只需将`which.max`函数应用于您的组以获取具有最大值的索引：

```
> apply(blocks(x), 1, function(i) {which.max(x[i[1]:i[2]]) + i[1] - 1})
[1]  6 23 
```

# php - PHP脚本上的jQuery.ajax POST 500内部服务器错误

> ID：11043859
> 
> 赞同：2
> 
> 时间：2012-06-15T02:16:36.393
> 
> 标签：php, jquery, ajax, internal-server-error

我在向登录脚本发送 ajax 请求的 js 函数上收到此错误。这是代码：

```
function validateLogin(){
  $(document).ready(function(){
    $("#loginform").submit(function(){
      $.ajax({
        type: "POST",
        url: "./php/autologin.php",
        data: {
          'login': $("#login").val(), 
          'password': $("#password").val()
        },
        dataType: "json",
        success:function(data){
          if(data.status === "success"){
            alert(data.message);
            window.location = "./userarea.html?user=".concat(data.user);
          } else if (data.status === "error"){
            alert(data.message);
          }
        },
        error:function(thrownError){
          console.log(thrownError);
        }
      }); 
      return false;
    });

  });
} 
```

我在上面的代码中的 url 上收到 POST 500 Internal Server Error，这是 chrome 控制台中打印的内容：

```
POST http://localhost/capstone/atomos-4.0/php/autologin.php 500 (Internal Server Error) jquery-1.7.2.min.js:4
f.support.ajax.f.ajaxTransport.send jquery-1.7.2.min.js:4
f.extend.ajax jquery-1.7.2.min.js:4
(anonymous function) validateLogin.js:4
f.event.dispatch jquery-1.7.2.min.js:3
f.event.add.h.handle.i jquery-1.7.2.min.js:3 
```

我真的不明白发布错误试图告诉我什么，任何人都可以在正确的方向上推动我解决这个问题。如果您需要更多信息，请告诉我。谢谢

编辑：这是有问题的 php 函数： `autologin.php`

```
include './login.php';

$login = $_POST['login'];
$password = $_POST['password'];
$loginattempt = json_decode(login($login, $password));

if ($loginattempt->{'status'} === "success") {
  return json_encode(array('status' => "success", 'message' => "Login Successful!"));
  die();
} else { 
  return json_encode(array('status' => "error", 'error' => "loginfailure", 'message' => ($loginattempt -> {"message"})));
  die();
}
?> 
```

和`login.php`：

```
<?php

include './connnect_to_mysql.php';

function login($log, $pass) {
  $connection = json_decode(connect_to_mysql());
  if ($connection->{'status'} === "success") {
    $sqlquery = mysql_query("SELECT * FROM userdata WHERE login='$log' AND password='$pass'") or die(mysql_error());
    if (mysql_num_rows($sqlquery) == 1) {
      setcookie("user", $log, 60 * 60 * 24);
      return json_encode(array('status' => "success", 'message' => "Login Successful.", 'user' => $log));
      die();
    } else {
      return json_encode(array('status' => "error", 'error' => "loginfailure", 'message' => mysql_error()));
      die();
    }
  } else {
    return json_encode(array('status' => "error", 'error' => "connectionerror", 'message' => $connection -> {'message'}));
    die();
  }
}

?> 
```

编辑2 `connect_to_mysql.php`：：

```
<?php

function connect_to_mysql() {
  $con = mysql_connect('localhost', 'user', 'pass') or die(mysql_error());
  if ($con) {
    $db = mysqli_select_db($con, 'db')or die(mysql_error());
    if ($db) {
      return json_encode(array('status' => "success", 'message' => "connected"));
      die();
    }
  } else {
    return json_encode(array('status' => "error", 'message' => mysql_error()));
    die();
  }
}

?> 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-06-15T02:22:59.590

修复`include './connnect_to_mysql.php';`到`include './connect_to_mysql.php';`:)

# jquery - mouseenter/mouseleave 不需要的挥动效果

> ID：11043861
> 
> 赞同：-3
> 
> 时间：2012-06-15T02:17:27.550
> 
> 标签：jquery, image, mouseenter, wave

我对 JQuery 相当陌生。话虽如此，我正在尝试使用`.mouseenter`导致图像尺寸变大并在 上恢复到正常尺寸的`.mouseleave`a ，它可以工作，但我的问题是它会启动一个随机循环次数的波浪效果。如果我将鼠标悬停在它们上面，它会变得非常疯狂。

jQuery

```
$(document).ready(function() {

    $(".site").mouseenter(function(){
        $(this).animate({
            width: "+=60px",
            height:"+=60px"
        }, 1000);

    });

    $(".site").mouseleave(function(){
        $(this).animate({
            width: "-=60px",
            height: "-=60px"
        }, 1000);

    });
}); 
```

html

```
<div id="shape">
                    <img src="../images/site1.jpg" class="site"/>
                    <img src="../images/site2.jpg" class="site"/>
                    <img src="../images/site3.jpg" class="site"/>
                    <img src="../images/site4.jpg"class="site"/>
                    <img src="../images/site5.jpg"class="site"/>
                    <img src="../images/site1.jpg"class="site"/>
                    <img src="../images/site2.jpg"class="site"/>
                    <img src="../images/site3.jpg"class="site"/>
                </div> 
```

我已经在网上找了大约 2 个小时了，我的第一个问题已经解决了这个波浪效果是我的最后一个

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-06-15T02:30:11.507

尝试这个：

```
$(".site").mouseenter(function(){
    $(this).stop().animate({
        width: "+=60px",
        height:"+=60px"
    }, 1000);

});

$(".site").mouseleave(function(){
    $(this).stop().animate({
        width: "-=60px",
        height: "-=60px"
    }, 1000);

}); 
```

# c++ - 使用 cin.ignore() 提取整数期间的 C++ 奇怪输出

> ID：11043863
> 
> 赞同：1
> 
> 时间：2012-06-15T02:18:31.777
> 
> 标签：c++

以下程序期望用户以混合分数格式“whole_numbernumerator/denominator”输入，并将值分配给各个变量。

```
#include<iostream>
using namespace std;

int main()
{
    int whole, numerator, denominator;

    cout << "Input format: i<space>n/d" << endl;

    cin >> whole;
    cin.ignore(1000, ' ');
    cin >> numerator;
    cin.ignore(1000, '/');
    cin >> denominator;

    cout << whole << endl;
    cout << numerator << endl;
    cout << denominator << endl;

    return 0;
} 
```

**Input1:**
123 345/678
**Output1:**
123
345
678

**Input2** :
1111111111 1111111111/1111111111
**Output2:**
1111111111
1111111111
1111111111

**Input3:**
2222222222 2222222222/222222222 Output3
**:**
2147483647
0
0

I haven't been able to figure out why the program doesn't work for输入 3。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-06-15T02:21:51.040

您溢出了 32 位整数 (2^31-1 ~= 2.147b) 的最大值。一旦发生这种情况，`cin`在您清除标志之前无法正常工作。您应该检查错误，但短期解决方案是使您的号码无符号，或使用 64 位号码，例如`int64_t`. 您也不需要忽略空格，`cin`默认情况下会跳过它。

您可以实现类似于[此处](http://www.parashift.com/c++-faq-lite/input-output.html#faq-15.3)找到的内容以确保有效输入，但需要对其进行定制以适合您的特定输入格式。也许用一个重载的运算符将这三个封装成一个类型，该运算符输入每个与格式相关的内容会使语法更合适，因此您可以`age`在示例中用一个`MixedNumber`对象替换。

我会看到这样的东西作为一种通用的方法：

```
template <typename T> //any type will work
void getValidInput (T &var, std::string prompt = "Input: ") {
    while ((std::cout << prompt) && !(std::cin >> var)) { //if cin fails...
        std::cin.clear();                 //clear flag and discard bad input
        std::cin.ignore (std::numeric_limits<std::streamsize>::max(), '\n');
        std::cout << "Invalid input; please re-enter.\n"; //let the user know
    } 
} 
```

然后你可以让你的程序如下：

```
struct MixedNumber { //a data structure, so it's like using plain variables
    int64_t whole; 
    int64_t numerator;
    int64_t denominator;
};

std::istream &operator>> (std::istream &in, MixedNumber &num) { //so cin works
    in >> num.whole >> num.numerator;
    in.ignore(); //yes, you could enforce the format a bit more
    in >> num.denominator;
    return in;
}

int main() {
    MixedNumber num; //easy to "make" a mixed number, a constructor works well too
    getValidInput (num, "Input format: i<space>n/d: "); 
    std::cout << num.whole << '\n' << num.numerator << '\n' << num.denominator;
} 
```

# sql - SQL Server 数据库项目部署后脚本大小限制？

> ID：11043865
> 
> 赞同：1
> 
> 时间：2012-06-15T02:18:59.233
> 
> 标签：sql, database, deployment, vsdbcmd

我们有一个在 Visual Studio 2010 中创建的 SQL Server 2008 数据库项目，我们目前已将其用于我们的生产数据库将近一年，并使用 vsdbcmd 进行部署。我们有许多默认数据脚本设置可以在部署后脚本中运行。最近我们不得不添加一些大型脚本（大约 80,000 条记录），由于某种原因，当我们在单元测试期间或通过 Visual Studio 进行部署时，整个部署后脚本根本无法运行并且没有错误。

我想知道这是否有任何尺寸限制，但在我尽可能多地在线搜索后，我无法确定是否是这种情况。

帮助！？:)

谢谢！

# ruby - 互斥块上的 if 语句

> ID：11043868
> 
> 赞同：1
> 
> 时间：2012-06-15T02:19:25.113
> 
> 标签：ruby, if-statement, mutex

我需要评估 if 条件，但我需要小心其他线程可能修改变量。

我的解决方案是

```
array.each do |anything|
    if (mutex.synchronize do shared_var <= my_var end)
        next
    end
end 
```

它似乎工作。`if`但是语句检查到底是什么？那么这个其他代码呢？

```
array.each do |anything|
    mutex.synchronize do
        if shared_var <= my_var
            next
        end
    end
end 
```

它们是等价的吗？`next`即使内部包含在互斥锁中，内部是否也能完成工作？为什么？

看看结构，我只展示了与我的问题相关的程序部分。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-06-15T02:42:20.790

> `if`但是语句检查到底是什么？

[`synchronize`](http://ruby-doc.org/core-1.9.3/Mutex.html#method-i-synchronize)返回传递给它的块返回的任何内容，因此该`if`语句最终是检查`shared_var <= my_var`.

> 那么这个其他代码呢？

我认为这里的语句检查的内容是不言自明的`if`，与上面相同。

> 它们是等价的吗？

不。

> `next`即使内部包含在互斥锁中，内部是否也能完成工作？

不，这就是为什么它们不等价的原因。当`next`在调用的块内被*调用*`synchronize`时，它`next`在该块中（不是`foreach`），这相当于`return`这里，因为没有“下一个”。当它*在*该块之外时，它会超出您期望`next`的实际外部块（ ）。`foreach`

因此，您可能需要第一个代码块。

# c# - 在输出文件中获取不需要的转义 xml 标签

> ID：11043872
> 
> 赞同：-1
> 
> 时间：2012-06-15T02:20:46.720
> 
> 标签：c#, xml, visual-studio-2010, xslt-1.0

使用 Visual Studio 2010 和 C# 进行 XSLT 转换。我需要帮助。根据我如何进行转换，我得到不同的输出。在 VS 调试器中运行转换，我得到以下输出。注意非转义标签。

```
<Service_Log>
<row>
      <EntryNumber>00</EntryNumber>
      <ErrorID>B004</ErrorID>
      <ErrorDate>2/06/2007 18:06:07</ErrorDate>
      <ErrorInfo>00000000</ErrorInfo>
      </row>
<row>
...
</Service_Log> 
```

当我使用以下代码片段在 C# 中运行转换时，我得到的输出带有转义的 xml 标签 - 我不希望它们转义。我错过了什么？

```
XslCompiledTransform trans = new XslCompiledTransform();
XmlWriterSettings settings = new XmlWriterSettings();
string fname = FixPath(WorkingFolder) + "Phase1.xml";
XmlWriter writer = XmlWriter.Create(fname, settings);
trans.Transform(xmlFile, writer);

&lt;readsym_Service_Log&gt;
&lt;row&gt;
      &lt;EntryNumber&gt;00&lt;/EntryNumber&gt;
      &lt;ErrorID&gt;B004&lt;/ErrorID&gt;
      &lt;ErrorDate&gt;2/06/2007 18:06:07&lt;/ErrorDate&gt;
      &lt;ErrorInfo&gt;00000000&lt;/ErrorInfo&gt;

      &lt;/row&gt;
&lt;row&gt;
... 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-06-15T03:00:06.240

尝试这样的事情：

```
 string inputFileName = @"XMLFile1.xml";
        string xsltFileName = @"XSLTFile1.xslt";
        string outputFileName = @"XMLFile2.xml";

        XslCompiledTransform trans = new XslCompiledTransform();
        XsltSettings settings = new XsltSettings();
        settings.EnableScript = true;
        trans.Load(xsltFileName, settings, null);

        XmlWriter writer = XmlWriter.Create(outputFileName);

        trans.Transform(inputFileName, writer); 
```

# jquery - bassistance 工具提示的实时绑定 (http://bassistance.de/jquery-plugins/jquery-plugin-tooltip/)

> ID：11043877
> 
> 赞同：0
> 
> 时间：2012-06-15T02:21:34.923
> 
> 标签：jquery, jquery-tooltip

如何使用实时绑定作为低音工具提示 (http://bassistance.de/jquery-plugins/jquery-plugin-tooltip/)

我正在使用这段代码：

```
$(document).ready(function(){
   $('.tooltip[title]').tooltip({
       track: true,
       delay: 0,
       showURL: false,
       showBody: " - "
});}); 
```

那么，如何使用实时绑定来绑定它呢？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-06-15T02:29:08.730

我可以想到两种方法来实现这一点：

1.  由于您正在使用 ajax 调用或通过其他方式更新文档，因此您可以在添加新创建元素的区域内进行相同的调用。这是一个使用不同 qtip 的演示，但策略是相同的：http: [//jsfiddle.net/lucuma/2EnFV/](http://jsfiddle.net/lucuma/2EnFV/)

2.  如果您无法通过 ajax 成功添加工具提示，则以下代码将起作用。它为具有工具提示插件的元素添加了一个新类。如果鼠标悬停时该类不存在，它将添加该类并打开插件。

[http://jsfiddle.net/lucuma/WtqYA/](http://jsfiddle.net/lucuma/WtqYA/)

```
$(document).ready(function() {
    $(document).on('mouseover', '.tooltip[title]', function() {
        if (!$(this).hasClass('applied')) {
            $(this).tooltip({
                track: true,
                delay: 0,
                showURL: false,
                showBody: " - "
            });

            $(this).mouseover();
        }
    });
}); 
```

最后，您可以考虑使用积极开发的插件，例如 qtip 或 jquery 工具。

[http://craigsworks.com/projects/qtip/](http://craigsworks.com/projects/qtip/)

[http://jquerytools.org/](http://jquerytools.org/) ​</p>

# linux - linux根据文件名模式搜索文件

> ID：11043878
> 
> 赞同：46
> 
> 时间：2012-06-15T02:21:46.830
> 
> 标签：linux, unix

我想根据文件名搜索一系列文件。

这是我的目录：

![在此处输入图像描述](../Images/d5e79bafe935f11af06949340e2e3d9a.png)

例如，我有上面的文件。

我只想搜索没有_bak的文件。

* * *

## 回答 #1

> 赞同：66
> 
> 时间：2012-06-15T02:34:31.473

如果您想将搜索限制在当前目录，请使用：

```
find . -maxdepth 1 -mindepth 1 ! -name '*_bak' 
```

如果要在所有目录中递归查找，请删除`-maxdepth 1`.

* * *

^(编辑以回应OP的评论)

要获取以 use 开头`ei`和不以`_bak`use 结尾的文件：

```
find . -type f -name 'ei*' -a ! -name '*_bak' 
```

* * *

## 回答 #2

> 赞同：6
> 
> 时间：2012-06-15T02:40:34.347

请试试这个：

```
 find . -type f ! -iname "*_bak" 
```

上述命令将查找所有不以_bak 结尾的文件。

* * *

## 回答 #3

> 赞同：-2
> 
> 时间：2012-06-15T02:29:27.230

使用 Grep 反转匹配选项。

例如，如果您想要所有文件不包含单词 _bak，请使用：

```
grep -v *_bak /path/to/file 
```

# iphone - 似乎无法在模拟器上使用 opengl es 1.1 进行渲染

> ID：11043881
> 
> 赞同：1
> 
> 时间：2012-06-15T02:21:56.330
> 
> 标签：iphone, ios, opengl-es, ios-simulator

我完全是 OpenGL 的菜鸟，我一直在尝试让这段简单的代码在 iphone 模拟器上渲染，它启动得很好，闪屏显示然后......什么都没有......只是黑暗，我可以'不能告诉我我错过了什么，有人可以帮忙吗？我还没有为旋转做任何事情，等着看我先渲染了什么，然后继续旋转等等......

如果这很重要，我正在使用 Xcode 4.2。

这是我的代码：

IRenderEngine.cpp

```
#ifndef HelloArrow_IRenderingEngine_hpp
#define HelloArrow_IRenderingEngine_hpp

#import <OpenGLES/ES1/gl.h>
#import <OpenGLES/ES1/glext.h>

//Physical Orientation of a handheld device, equivalent to UIDeviceOrientation
enum DeviceOrientation{
DeviceOrientationUnknown,
DeviceOrientationPortrait,
DeviceOrientationPortraitUpsideDown,
DeviceOrientationLandscapeLeft,
DeviceOrientationLandscapeRight,
DeviceOrientationFaceUp,
DeviceOrientationFaceDown
};

//Creates an instance of a renderer and sets up various openGL state
struct IRenderingEngine *CreateRenderer1();

//Interface to OpenGL ES renderer; consumed by GLView
struct IRenderingEngine{
virtual void Initialize(int width, int height)=0;
virtual void Render() = 0;
virtual void UpdateAnimation(float timeStep) = 0;
virtual void OnRotate(DeviceOrientation newOrientation) = 0;
virtual ~IRenderingEngine(){};
}; 
```

渲染引擎.cpp

```
#include <iostream>

#include <OpenGLES/ES1/gl.h>

#include <OpenGLES/ES1/glext.h>

#include "IRenderingEngine.hpp"

class RenderingEngine1 : public IRenderingEngine{
public:
RenderingEngine1();
void Initialize(int width, int height);
void Render();
void UpdateAnimation(float timeStep){}
void OnRotate(DeviceOrientation newOrientation){}
private:
GLuint m_framebuffer;
GLuint m_renderbuffer;
};

IRenderingEngine * CreateRenderer1(){
return new RenderingEngine1;
}

struct Vertex {
float Position[2];
float Color[4];
};

//Define the position and colors of the 2 triangles
const struct Vertex Vertices[6] = {
{{-0.5, -0.866},{1, 1, 0.5f, 1}},
{{0.5, -0.866},{1,1,0.5f,1}},
{{0,1},{1,1,0.5f,1}},
{{-0.5, -0.866},{0.5f,0.5f,0.5f}},
{{0.5, -0.866},{0.5f,0.5f,0.5f}},
{{0,-0.4f},{0.5f,0.5f,0.5f}}
};
RenderingEngine1::RenderingEngine1(){
glGenRenderbuffersOES(1, &m_renderbuffer);
glBindRenderbufferOES(GL_RENDERBUFFER_OES, m_renderbuffer);
}

void RenderingEngine1::Initialize(int width, int height){
//Create the framebuffer object and attache the renderbuffer    
glGenFramebuffersOES(1, &m_framebuffer);
glBindFramebufferOES(GL_FRAMEBUFFER_OES, m_framebuffer);

glFramebufferRenderbufferOES(GL_FRAMEBUFFER_OES, GL_COLOR_ATTACHMENT0_OES,     GL_RENDERBUFFER_OES, m_renderbuffer);

glViewport(0, 0, width, height);

glMatrixMode(GL_PROJECTION);

glLoadIdentity();

const float maxX = 2;
const float maxY = 3;

glOrthof(-maxX,+maxX,-maxY,+maxY,-1,1);

glMatrixMode(GL_MODELVIEW);

glLoadIdentity();

}

void RenderingEngine1::Render(){

glClearColor(0.5f, 0.5f, 0.5f, 1);

glClear(GL_COLOR_BUFFER_BIT);

glEnableClientState(GL_VERTEX_ARRAY);

glEnableClientState(GL_COLOR_ARRAY);
glVertexPointer(2,GL_FLOAT,4,&Vertices[0].Position);

glColorPointer(4,GL_FLOAT,2,&Vertices[0].Color);

GLsizei vertexcount = sizeof(Vertices)/sizeof(Vertex);
glDrawArrays(GL_TRIANGLES, 0, vertexcount);
glFlush();
glDisableClientState(GL_VERTEX_ARRAY);
glDisableClientState(GL_COLOR_ARRAY);
} 
```

GLView.h

```
#import "IRenderingEngine.hpp"
#import <UIKit/UIKit.h>
#import <OpenGLES/EAGL.h>
#import <QuartzCore/QuartzCore.h>

@interface GLView : UIView
{
EAGLContext *m_context;
struct IRenderingEngine *m_renderingEngine;
float m_timestamp;
}

-(void) drawView:(CADisplayLink*) displayLink;
-(void) didRotate: (NSNotification*) notification;

@end 
```

GLView.mm

```
#import <OpenGLES/EAGLDrawable.h>
#import <OpenGLES/ES1/gl.h> //<- for GL_RENDERBUFFER only
#import "GLView.h"
#import "mach/mach_time.h"
#import "IRenderingEngine.hpp"

@implementation GLView

+(Class) layerClass{
return [CAEAGLLayer class];
}

- (id)initWithFrame:(CGRect)frame
{
self = [super initWithFrame:frame];
if (self) {
    // Initialization code
    CAEAGLLayer *eaglLayer = (CAEAGLLayer*) super.layer;
    eaglLayer.opaque = YES;
    m_context = [[EAGLContext alloc] initWithAPI:kEAGLRenderingAPIOpenGLES1];

    if(!m_context || ![EAGLContext setCurrentContext:m_context]){
        return nil;
    }

    m_renderingEngine = CreateRenderer1();    

    [m_context renderbufferStorage:GL_RENDERBUFFER fromDrawable:eaglLayer];

    m_renderingEngine->Initialize(CGRectGetWidth(frame), CGRectGetHeight(frame));
    [self drawView:nil];
    m_timestamp = CACurrentMediaTime();
    CADisplayLink *displayLink;
    displayLink = [CADisplayLink displayLinkWithTarget:self selector:@selector(drawView:)];
    [displayLink addToRunLoop:[NSRunLoop currentRunLoop] forMode:NSDefaultRunLoopMode];
    [[UIDevice currentDevice] beginGeneratingDeviceOrientationNotifications];
    [[NSNotificationCenter defaultCenter] addObserver:self selector:@selector(didRotate:) name:UIDeviceOrientationDidChangeNotification object:nil];

}
return self;
}

/*
// Only override drawRect: if you perform custom drawing.
// An empty implementation adversely affects performance during animation.
- (void)drawRect:(CGRect)rect
{
// Drawing code
}
*/

-(void) drawView: (CADisplayLink *) displayLink{

if(displayLink != nil){
    float elapsedseconds = [displayLink timestamp] - m_timestamp;
    m_timestamp = [displayLink timestamp];
    m_renderingEngine->UpdateAnimation(elapsedseconds);
}
m_renderingEngine->Render();

[m_context presentRenderbuffer:GL_RENDERBUFFER_OES];

}

-(void) dealloc{
if([EAGLContext currentContext] == m_context)
    [EAGLContext setCurrentContext:nil];
m_renderingEngine = nil;
m_timestamp = nil;
}

-(void) didRotate:(NSNotification *)notification{
UIDeviceOrientation orientation = [[UIDevice currentDevice] orientation];
m_renderingEngine->OnRotate((DeviceOrientation) orientation);
[self drawView:nil];
}

@end 
```

AppDelegate.h

```
#import <UIKit/UIKit.h>
#import "GLView.h"

@class ViewController;

@interface AppDelegate : UIResponder <UIApplicationDelegate>{
UIWindow *m_window;
GLView *m_view;
}

@property (strong, nonatomic) IBOutlet UIWindow *m_window;

@end 
```

最后是 AppDelegate.mm

```
#import "AppDelegate.h"
#import "OpenGLVC.h"
#import <UIKit/UIKit.h>

@implementation AppDelegate

@synthesize m_window = _window;

- (BOOL)application:(UIApplication *)application didFinishLaunchingWithOptions:(NSDictionary *)launchOptions
{
CGRect screenBounds = [[UIScreen mainScreen] bounds];
self.m_window = [[UIWindow alloc] initWithFrame:screenBounds];
m_view = [[GLView alloc] initWithFrame:screenBounds];
[m_window addSubview:m_view];
[application setStatusBarHidden:YES withAnimation:UIStatusBarAnimationNone];
OpenGLVC *oglvc = [[OpenGLVC alloc] init];
self.m_window.rootViewController = oglvc;
// Override point for customization after application launch.
[self.m_window makeKeyAndVisible];
return YES;
}

- (void)applicationWillResignActive:(UIApplication *)application
{
/*
 Sent when the application is about to move from active to inactive state. This can occur for certain types of temporary interruptions (such as an incoming phone call or SMS message) or when the user quits the application and it begins the transition to the background state.
 Use this method to pause ongoing tasks, disable timers, and throttle down OpenGL ES frame rates. Games should use this method to pause the game.
 */
}

- (void)applicationDidEnterBackground:(UIApplication *)application
{
/*
 Use this method to release shared resources, save user data, invalidate timers, and store enough application state information to restore your application to its current state in case it is terminated later. 
 If your application supports background execution, this method is called instead of applicationWillTerminate: when the user quits.
 */
}

- (void)applicationWillEnterForeground:(UIApplication *)application
{
/*
 Called as part of the transition from the background to the inactive state; here you can undo many of the changes made on entering the background.
 */
}

- (void)applicationDidBecomeActive:(UIApplication *)application
{
/*
 Restart any tasks that were paused (or not yet started) while the application was inactive. If the application was previously in the background, optionally refresh the user interface.
 */
}

- (void)applicationWillTerminate:(UIApplication *)application
{
/*
 Called when the application is about to terminate.
 Save data if appropriate.
 See also applicationDidEnterBackground:.
 */
}

@end 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-06-15T03:21:33.187

尝试改变

```
glVertexPointer(2,GL_FLOAT,4,&Vertices[0].Position);
glColorPointer(4,GL_FLOAT,2,&Vertices[0].Color); 
```

至

```
glVertexPointer(2,GL_FLOAT,sizeof(Vertex),&Vertices[0].Position);
glColorPointer(4,GL_FLOAT,sizeof(Vertex),&Vertices[0].Color); 
```

这两个函数中的第三个参数应该是步幅，即，Vertices[0].Position 和 Vertices[1].Position 之间的字节偏移差。

换句话说，如果您站在 Vertices[i].Position 并迈出了一大步然后站在 Vertices[i+1].Position 处，那么您的步幅必须以*字节为单位（而不是浮动）*多长时间。从Vertices[i].Position 的末尾到 Vertices[i+1].Position 的开头，您**不必**跳过这个间隙。

此外，步幅始终以字节表示，而不是浮点数或整数。

看：

[http://www.opengl.org/sdk/docs/man/xhtml/glVertexPointer.xml](http://www.opengl.org/sdk/docs/man/xhtml/glVertexPointer.xml)

[http://www.opengl.org/sdk/docs/man/xhtml/glColorPointer.xml](http://www.opengl.org/sdk/docs/man/xhtml/glColorPointer.xml)

# css - 如何为 HTML5 制作 CSS 在IE中正常工作？

> ID：11043887
> 
> 赞同：0
> 
> 时间：2012-06-15T02:23:12.100
> 
> 标签：css, internet-explorer, css-float

我正在与一个网站合作，除了#nav-wrapper 的一个问题外，一切看起来都很好。在 IE 中，它一直向右。也就是说，它是向右浮动的，但在 #nav-wrapper 的右侧浮动，这是一个设置宽度，然后放置在一个设置宽度的标题中。所以我不确定为什么它一直向右。这是一个 wordpress 网站，所以我简化了菜单和横幅等。[这就是网站。](http://thestuffedpepper.ca)

```
<div id="header-wrapper">
<header>
       <div id="nav-wrapper">
       <span class="nav-swirl-top">The Stuffed Pepper, Summerland BC</span>
        <nav id="access" role="navigation">
            MENU LIST
        </nav><!-- #access -->

           <div id="nav-updates">
        <p>Updates</p>
        </div>

            <span class="nav-swirl-bottom">The Stuffed Pepper</span>            
    </div><!-- #nav-wrapper -->

    <div id="banner">
       <img src="http://www.mysite.com/img/banner1.png" alt="Banner 1">'
    </div>

</header>
</div>

<div id="main">
<div id="container">

#header-wrapper { width: 100%; height: 532px; background: url(img/header-bg.jpg) repeat-x;}
header { clear: both; height: 620px; width: 900px;}
#banner { position: absolute; top: 230px; width:700px; left: 50%; margin-left: -470px; z-index: 1; }
#nav-wrapper { position: relative; clear: both; width: 252px; height: 365px; padding: 10px; float: right; margin-top: 230px;background-color: #650908; border: 1px solid #470604;}
#container { clear: both; background: url(img/container-bg.jpg) repeat; border-bottom: 3px solid #9d1316; color: #ccc1a1; } 
```

这是它的样子。 ![在此处输入图像描述](../Images/e46f700c0236cfb1d1d0c4922f0f94f5.png)

因此，如果我现在为#header-wrapper 设置了宽度和高度，为什么我的测试也会显示在它下面？只是不确定 IE 喜欢做什么以及它如何选择忽略样式！

我很感激任何帮助。

更新

不知道为什么它显示标题没有正确关闭..

![在此处输入图像描述](../Images/d50ec510872676fd901ba72bfc589f1e.png)

这就是它的实际样子。我看到`</hgroup/>`对你来说看起来像那样，但对我来说根本不是。

即使使用 Firefox 开发者工具，它也能正确显示 ![在此处输入图像描述](../Images/f0c517e5a5a11349ce144eb265931cb6.png)

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-06-15T02:30:34.220

并非所有 HTML5 标记都有效/受 Internet Explorer 支持，尤其是旧版本。

请参阅此[参考文章](http://html5doctor.com/how-to-get-html5-working-in-ie-and-firefox-2/)。

有很多方法可以尝试让 IE 工作：

*   使用[HTML5 Shiv](http://net.tutsplus.com/tutorials/html-css-techniques/how-to-make-all-browsers-render-html5-mark-up-correctly-even-ie6/)
*   使用[Modernizr](http://www.modernizr.com)
*   请参阅[相关的 SO 问题](https://stackoverflow.com/questions/8350341/make-html5-header-work-with-ie-html5-shiv-doesnt-fix-my-layout)
*   使用[jQuery 解决方案](http://www.splashnology.com/article/html-5-in-internet-explorer/395/)

还可以使用 IE 的开发人员工具检查该站点。似乎`header`HTML 没有正确打开和关闭。看：

![在此处输入图像描述](../Images/1606c0b33dbb266da3baef2a554aa1b5.png)

# c# - 从指针中读取字符串

> ID：11043888
> 
> 赞同：0
> 
> 时间：2012-06-15T02:23:15.893
> 
> 标签：c#, .net

下面的代码是读取浮点数的示例，有人可以建议修改函数以读取字符串吗？

```
 public static float ReadPointerFloat(string EXENAME, int Pointer, int[] Offset)
 {
     float Value = 0;
     checked
     {
         try
         {
             Process[] Proc = Process.GetProcessesByName(EXENAME);
             if (Proc.Length != 0)
             {
                 int Bytes = 0;
                 int Handle = OpenProcess(PROCESS_ALL_ACCESS, 0, Proc[0].Id);
                 if (Handle != 0)
                 {
                     foreach (int i in Offset)
                     {
                         ReadProcessMemoryInteger((int)Handle, Pointer, ref Pointer, 4, ref Bytes);
                         Pointer += i;
                     }
                     ReadProcessMemoryFloat((int)Handle, Pointer, ref Value, 4, ref Bytes);
                     CloseHandle(Handle);
                 }
             }
         }
         catch
         { }
     }
     return Value;
 } 
```

也许读取一个字节数组并应用它？

```
ASCIIEncoding.ASCII.GetString(variableholdingresultoffunction); 
```

* * *

## 回答 #1

> 赞同：-1
> 
> 时间：2012-06-15T02:38:33.920

```
private void label2_Click(object sender, EventArgs e)
{
    Process[] test = Process.GetProcessesByName("myprocess"); //Get process base address
    int Base = test[0].MainModule.BaseAddress.ToInt32(); // ""

    int Readpointer = ReadPointerInteger("myprocess", Base, new int[3] { 0xC, 0x5, 0x6 });

    string asciiString;
    unsafe
    {
        asciiString = new string((sbyte*)Readpointer);
    }
    // use asciiString
} 
```

正如其他人所提到的，您应该使用`IntPtr`而不是`int`指针，以便它在 32 位和 64 位系统之间交叉兼容，但这应该可以帮助您入门。

# c# - 如何检测 WCF 服务关闭或与客户端断开连接？

> ID：11043909
> 
> 赞同：3
> 
> 时间：2012-06-15T02:28:23.757
> 
> 标签：c#, wcf

我正在构建 WCF 服务，在客户端连接到该服务后，当服务断开连接时，客户端不会注意到这一点，并且它不会触发任何操作，我想在连接丢失时关闭客户端表单，那么我将如何检测 WCF 服务从客户端断开或关闭。

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2012-06-15T03:08:28.303

一个简单的方法是客户端将在服务中调用一个名为 IsAlive() 的简单方法，只返回 true ，如该[线程](https://stackoverflow.com/questions/1085220/pinging-wcf-services)中所述。

还有另一种方法可以使用 WCF 4 附带的新**发现/公告**功能来实现此目的。虽然我没有尝试过，但此功能可以帮助您使服务在脱机/关闭时通知客户端。

这是一个示例[帖子](http://www.freddes.se/2010/05/16/announcement-and-discovery-in-wcf-4/)。

你可以google“WCF公告服务”，你会得到一些很好的参考资料。

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2012-06-15T02:33:44.567

您可能应该只设置一个计时器，该计时器将持续 ping 服务器，如果失败，则触发服务不再可用的事件。

这个答案也有一些很好的建议。

[WCF - 让客户端检查服务可用性](https://stackoverflow.com/questions/1234427/wcf-have-client-check-for-service-availability)

# java - 在谷歌地图上添加一个带有纬度和经度值的标记

> ID：11043910
> 
> 赞同：1
> 
> 时间：2012-06-15T02:28:23.880
> 
> 标签：java, android, eclipse

我目前正在开发一个包含 Google Map 的 Android 应用程序。应用程序现在可以检索用户当前位置的经度和纬度值。但问题是，它应该使用这些值在地图上添加一个标记。

# emacs - 哪个文件包含加载已安装包的 Elisp 代码？

> ID：11043913
> 
> 赞同：2
> 
> 时间：2012-06-15T02:29:16.687
> 
> 标签：emacs

我已经安装了一些 Emacs 包，例如使用`M-x package-install`. 我的 ~/.emacs 和 ~/.emacs.d/init.el 文件都是空的，但安装的包仍然被加载。

我想知道 Emacs 是如何加载它已安装的包的？加载安装包的代码在哪里？

我使用的是预编译的 Emacs24.BZR.106722.Win32 版本。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-06-15T03:00:32.753

应该有一个`~/.emacs.d/elpa`目录，这是 package.el（又名 Emacs Lisp Package Archive 的 ELPA）存储其数据的地方。

做不到这一点，
`C-h``v` `package-user-dir` `RET`

**编辑**：

来自新闻文件 ( `C-h``N`)：

> ** 现在包括一个 Emacs Lisp 包管理器。这是从[http://elpa.gnu.org](http://elpa.gnu.org)的包存储库下载和安装附加包的便捷方式。
> 
> *** `M-x list-packages`显示软件包列表，可以选择安装。
> 
> ***新命令 ` `describe-package`'，绑定到 ` `C-h P`'。
> 
> ***默认情况下，所有安装的包都会在 Emacs 启动时自动加载。要禁用此功能，请将 ` `package-enable-at-startup`' 设置为 `nil`。要指定要加载的包，请自定义 ` `package-load-list`'。

# css - Chrome 不显示多个 uls 内联

> ID：11043914
> 
> 赞同：0
> 
> 时间：2012-06-15T02:29:23.257
> 
> 标签：css

[http://img571.imageshack.us/img571/2118/screenshotfrom201206151.png](http://img571.imageshack.us/img571/2118/screenshotfrom201206151.png)

我在这里有一个基本的 ul li ul li 嵌套下拉菜单布局，但我遇到了一个奇怪的错误。

在css中，我设置了

```
nav ul {
    list-style-type:none;
    display:inline-block;
} 
```

这应该使：

```
 <ul>
      <li>
         <a>(home)
      </li>    
   </ul>    
   <ul>    
      (other <li>s)
   </ul> 
```

像他们在 Firefox 中一样显示，对吧？使用 chrome 时，绝大多数情况下它都如图所示，但每 20 次左右的刷新中就有 1 次会使菜单保持内联。它在 Opera 中就像在 Firefox 中一样工作，所以这让我认为这是一个 webkit 问题。

我如何准确地修改代码，使其表现得像在 opera/firefox 中一样？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-06-16T04:00:21.650

我确实可以在 Arch Linux 上的 chromium 19.0.1084.56-1 中确认奇怪的行为（它们出现在导航下方），这在例如 Opera 12 中不会出现。此外，检查导航和 li 上的元素并取消它们的 CSS 属性一个一个都没有修复过，所以这可能是一个奇怪的铬错误，应该向他们报告。[或许你可以在邮件列表](https://groups.google.com/group/chromium-dev)上开始一个关于这个的礼貌话题？

# ios - iOS：UIButton setSelected

> ID：11043917
> 
> 赞同：0
> 
> 时间：2012-06-15T02:29:32.147
> 
> 标签：ios, xcode, uibutton

现在，我正在使用这段代码：

```
[btn setTitle:@"disabled" forState:UIControlStateDisabled]; 
[btn setTitle:@"selected" forState:UIControlStateSelected]; 
```

如何让它显示“选定”的文本？我发现它在我使用时并不总是有效

`[btn setSelected:YES];`.

谁能帮我？提前致谢！！

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-08-08T18:25:43.777

该代码应该适用于您选择按钮（未突出显示或禁用）或禁用按钮（未突出显示或选择）的简单情况。

请记住，某些控制状态可能会重叠。如果您没有为重叠状态指定图像，则 UIControl 必须选择一个。我不确定确切的算法，但我猜是优先级列表，并且 UIControlStateSelected 的优先级低于 UIControlStateDisabled

# ios - MPMoviePlayerController 在全屏问题（显示空白黑屏）

> ID：11043922
> 
> 赞同：1
> 
> 时间：2012-06-15T02:30:11.820
> 
> 标签：ios, window, mpmovieplayercontroller, fullscreen

我有包含几页的 tabBarViewController 和一个 loginViewController。我使用 [window addSubView:] 添加视图。

当我需要播放全屏视频时，我必须删除窗口中的所有视图才能显示视频，否则它只是一个黑屏。当视频停止/完成/退出全屏时，我必须手动将子视图再次添加回窗口。

我知道这是一种错误的做法。如果我不这样做，当视频切换到全屏时，它将显示在根窗口视图中，在其他视图的后面。

请给一些建议。谢谢你。

下面是我的代码：

```
-(void)playMovie:(NSString *)urlStr{
NSURL *fileURL = [NSURL URLWithString:urlStr];
player = [[MPMoviePlayerController alloc] initWithContentURL:fileURL];
player.scalingMode = MPMovieScalingModeAspectFit;
[[NSNotificationCenter defaultCenter] addObserver:self selector:@selector(willEnterFullscreen:) name:MPMoviePlayerWillEnterFullscreenNotification object:nil];
[[NSNotificationCenter defaultCenter] addObserver:self selector:@selector(willExitFullscreen:) name:MPMoviePlayerWillExitFullscreenNotification object:nil];    
[[appDelegate loginViewController].view removeFromSuperview];
[[appDelegate tabBarController].view removeFromSuperview];
[[appDelegate navController].view addSubview:player.view];
player.fullscreen = YES;
[player play]; 
```

}

```
- (void)willExitFullscreen:(NSNotification*)notification {
NSLog(@"willExitFullscreen...");
[[appDelegate window] addSubview:[appDelegate navController].view];
[[appDelegate window] addSubview:[appDelegate loginViewController].view];
[[appDelegate window] addSubview:[appDelegate tabBarController].view];
[player.view removeFromSuperview]; 
```

}

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-06-15T03:32:49.280

要展示播放器，请使用：

```
[self presentMoviePlayerViewControllerAnimated:player]; 
//Self should be a View Controller. 
```

而不是使用`addSubview`.

此外，您应该确保`movieSourceType`在您的`player`（您可以通过 访问`player.moviePlayer`）上设置 ，并作为建议设置播放器背景使用`player.view.backgroundColor = [UIColor blackColor];`以避免闪烁的白色背景。

# iphone - 目标 C 开关语句内的 OR 运算符

> ID：11043925
> 
> 赞同：1
> 
> 时间：2012-06-15T02:31:08.323
> 
> 标签：iphone, ios, switch-statement

我想知道在 ta switch 语句的情况下是否有可能有一个 (||)"or" 或 (&&)"and" 运算符。

这就是我的想法。

```
switch (orientation) {
            case UIDeviceOrientationPortrait:
            {
                case (UIDeviceOrientationLandscapeLeft || UIDeviceOrientationLandscapeRight):
             }
            break;
//... 
```

如果有人可以帮助我，我将不胜感激:)

* * *

## 回答 #1

> 赞同：11
> 
> 时间：2012-06-15T02:35:09.460

&& 是不可能的，但你可以实现类似于 || 通过不间断地处理多个案例：

```
switch (orientation)
{
   case UIDeviceOrientationPortrait:
       // ...
       break;

   case UIDeviceOrientationLandscapeLeft:
   case UIDeviceOrientationLandscapeRight:
       // ...
       break;
} 
```

您当然也可以`orientation`在您的案例块内使用（即进一步评估它）

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2012-06-15T02:35:13.360

`OR`隐含在`switch`with missing的结构中`break`：

```
switch (orientation) {
        case UIDeviceOrientationPortrait:
        case (UIDeviceOrientationLandscapeLeft:
        case UIDeviceOrientationLandscapeRight: {
        }
        break;
} 
```

`AND`没有意义，因为一个变量不能同时等于两个不同的整数。

# c# - 如何解析复杂的 JSON 键

> ID：11043927
> 
> 赞同：0
> 
> 时间：2012-06-15T02:31:22.617
> 
> 标签：c#

我如何解析这个 JSON 结果：

```
{
   "Output": [
      {
         "LGA11aAust.DistanceToBorder": "2587.4",
         "LGA11aAust.LGA_NAME": "Hume (C)",
         "SustainabilityVicZones.DistanceToBorder": "2575.6",
         "SustainabilityVicZones.REBATEZN": "Metropolitan Melbourne",
         "LGA11aAust.Status": "T",
         "SustainabilityVicZones.Status": "T",
         "Status": "T",
         "Status.Code": "",
         "Status.Description": "",
         "user_fields": []
      }
   ]
} 
```

我知道`JSON.parse`方法，但是我无法访问键的值，因为它们中有一个`.`。

**例如：**我不能使用`Output[0].Status.Code`，因为它没有将`Status.Code`其视为一个整体，它认为`Code`是`Status`在场下。

请帮忙。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-06-15T06:43:37.460

您可以使用[JSON .NET](http://json.codeplex.com/)我最喜欢的 JSON 序列化器和反序列化器。

如何使用：

```
 public class Output
{
   [JsonProperty(PropertyName="LGA11aAust.DistanceToBorder")]
   public decimal DistanceToBorder {get; set;}

   //All the other properties

} 
```

用法：

```
var deserializedObjects = 
JsonConvert.DeserializeObject<List<Output>>(someJsonResult) 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-06-20T03:24:05.543

我找到了我的问题的答案。

我们可以直接将参数的名称写在方括号中，而不是使用 (.) 点运算符。

例如：- 参数“Status.Code”的值可以按如下方式访问-

```
 Output[0]["Status.Code"] 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-06-15T02:43:07.793

这听起来是个坏主意......但我认为如果你用斜杠转义句号，你可以做到：

```
JSON.parse('{"a\.b":"c"}') 
```

给出：

```
Object
    a.b: "c" 
```

（在 Chrome 调试器中）

然后，您必须使用引号来访问您的属性，例如：

```
var x = JSON.parse('{"a\.b":"c"}');
console.log(x["a.b"]); 
```

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2012-06-15T04:56:01.253

检查这个

[动态 JSON 解析器](http://www.drowningintechnicaldebt.com/ShawnWeisfeld/archive/2010/08/22/using-c-4.0-and-dynamic-to-parse-json.aspx)

# sql - 如何构造 tsql 查询来处理多个子表

> ID：11043930
> 
> 赞同：0
> 
> 时间：2012-06-15T02:31:51.383
> 
> 标签：sql, sql-server, tsql, sql-server-2005

我需要有关如何编写 SQL Server 2005 查询来处理连接多个子表的帮助。这是我的场景：

表：

顾客

*   客户_PK

订单

*   订单_PK
*   订单类型A_FK
*   订单类型B_FK
*   订单类型C_FK
*   客户_FK

订单类型A

*   订单类型A_PK
*   托运人_FK

订单类型B

*   订单类型B_PK
*   托运人_FK

订单类型C

*   订单类型C_PK
*   托运人_FK

托运人

*   托运人_PK
*   发货人地址_FK

发货人地址

*   ShipperAddress_PK
*   托运人州

Orders 表的数据如下所示：

```
Order_PK   OrdersTypeA_FK    OrdersTypeB_FK    OrdersTypeC_FK    Customer_FK
--------   --------------    --------------    --------------    -----------
1          1                 null              null              1
2          null              1                 null              2
3          null              null              1                 3 
```

我的问题是我需要让 select join 语句通过从三个 OrdersType 表之一中查找 Shipper_FK 来检索 ShipperAddress。Orders 表每行只有一个 OrdersType FK。我需要从 OrdersType 表中检索的唯一内容是 Shipper_FK，以便我可以加入 ShipperAddress 表。

那么连接看起来如何？？？

```
select 
ShipperAddress.ShipperState 
from Customers
left join Orders on Orders.Customer_FK = Customers.Customer_PK

????????

left join Shippers on Shipper_PK = ??????.Shipper_FK
left join ShipperAddress on ShipperAddress.ShipperAddress_PK = Shippers.ShipperAddress_FK 
```

我不能为每个 OrdersType 表单独连接到 ShipperAddress。这是一个较小的问题示例，在 OrdersType 级别有更多表。Shipper_FK 在每个 OrdersType 表中都是相同的。无论它来自哪个 OrdersType 表，我都需要访问 Shipper_FK 以继续执行 join 语句。怎么可能呢？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-06-15T02:53:24.097

这将是有趣的阅读，优化和维护......

```
SELECT sa.ShipperState  --, other columns surely
FROM dbo.Customers AS c
LEFT OUTER JOIN dbo.Orders AS o 
ON o.Customer_FK = c.Customer_PK
LEFT OUTER JOIN dbo.OrdersTypeA AS oa
  ON oa.OrdersTypeA_PK = o.OrdersTypeA_FK
LEFT OUTER JOIN dbo.OrdersTypeB AS ob
  ON ob.OrdersTypeB_PK = o.OrdersTypeB_FK
LEFT OUTER JOIN dbo.OrdersTypeC AS oc
  ON oc.OrdersTypeC_PK = o.OrdersTypeC_FK
LEFT OUTER JOIN dbo.Shippers AS s
  ON s.Shipper_PK = COALESCE(oa.Shipper_FK, ob.Shipper_FK, oc.Shipper_FK)
LEFT OUTER JOIN dbo.ShipperAddress AS sa
  ON s.ShipperAddress_FK = sa.ShipperAddress_PK; 
```

# ember.js - 是否可以取消 Ember 状态转换？

> ID：11043934
> 
> 赞同：1
> 
> 时间：2012-06-15T02:32:48.357
> 
> 标签：ember.js

TL；博士？如果你想去（几乎）工作代码，我在[这里做了一个 jsFiddle 。](http://jsfiddle.net/brundage/dYEJe/)

假设我有一个如下所述的 Ember 路由器。我想让它管理当前用户身份验证的状态。是否可以取消状态转换？

```
App.Router = Ember.Router.extend({

    init: function() {
        this.set('authenticated', false);
        return this._super();
    },

    /*
     * "Authentication" method - just toggle the state
     */
    toggleAuthentication: function() {
        var auth = this.get('authenticated');
        this.set('authenticated', !auth);
        if (auth) {
            this.transitionTo('root.home');
        } else {
            this.transitionTo('loggedIn.home');
        }
    },

    /*
     * Root state
     * Logged out state tree
     */
    root: Ember.State.extend({
        home: Ember.State.extend()
    }),

    /*
     * Authenticated state tree
     */
    loggedIn: Ember.State.extend({

        /* Enter checks user is authenticated */
        enter: function(manager, transition, async, resume) {

            if (manager.get('authenticated')) {
                // proceed
            } else {
                // cancel the transition & redirect to root.home
            }
        },

        /* Exit sets authenticated to false just to be sure */
        exit: function(manager, transition, async, resume) {
            manager.set('authenticated', false);
        },

        /* Sub-states */
        home: Ember.State.extend(),

        news: Ember.State.extend({
            list: Ember.State.extend()
        })
    })
}); 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-06-15T13:48:09.733

那将是“还没有”。[https://github.com/emberjs/ember.js/issues/745](https://github.com/emberjs/ember.js/issues/745)

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-10-18T13:42:12.953

Dean提到的票已经关闭；但是有一种方法可以做到这一点。你可以重写Router.enterState，如下：

```
App.Router = Ember.Router.extend({
    enterState: function(transition) {
        if (!transition.finalState.get('isLeafRoute') || !App.User.get('authenticated')) {
            // Only transition when your user is authenticated
            this._super.apply(this, arguments);
        } else {
            // Otherwise "cancel this transition and move to the login state
            App.get('router').transitionTo('users.login');
        }
    },

    root: Ember.Route.extend({}) // Your routes
}); 
```

这在 ember 1.0 pre 中为我工作。就我个人而言，我认为这种方法是合理的，因为有很多方法可以转换到路由（URL、操作等），也有很多方法可以突然变得未经身份验证。我不确定这实际上是 Ember 团队的意图；）。

# php - 在他们允许 Facebook 应用程序后将用户重定向到动态页面？

> ID：11043938
> 
> 赞同：0
> 
> 时间：2012-06-15T02:34:14.143
> 
> 标签：php, javascript, facebook

我的网站上有图像，用户需要允许 Facebook 应用程序才能查看它们。因此，当用户单击图像（缩略图）时，它应该让他进入图像页面并检查他是否允许该应用程序。那么如何在允许 Facebook 应用程序后将用户重定向到该特定图像页面的用户。像这样的东西：

```
header('Location: image_page.php'); 
```

我试过了，它再次将他带到了 facebook 上的允许页面。我试图改变 -1 但我遇到了同样的问题：

```
header("location:javascript://history.go(-1)"); 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-06-15T02:39:14.317

`redirect_uri`最简单的方法是按照您在调用 Facebook 身份验证对话框时指定的方式填充引用页面的 URL 。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-06-15T02:41:34.207

在将用户重定向到 facebook 以允许您的应用程序时，您应该指定图像页面。

这是将用户重定向到 Facebook auth 的 url：

```
https://www.facebook.com/dialog/oauth?client_id=YOUR_APP_ID&redirect_uri=YOUR_CANVAS_PAGE 
```

你应该`YOUR_CANVAS_PAGE`用你的图片页面网址替换

# google-chrome - Radeon IGP 340m 上的 Chrome WebGL 片段着色器

> ID：11043945
> 
> 赞同：0
> 
> 时间：2012-06-15T02:35:10.073
> 
> 标签：google-chrome, glsl, shader, webgl, fragment-shader

我有一台带有 Radeon IGP 340m 显卡的旧机器。根据制造规范，它只支持 OpenGL 1.3，不支持片段着色器，但是当我在这里运行一些 WebGL 应用程序时：http: [//glsl.heroku.com/](http://glsl.heroku.com/)（需要片段着色器版本 120+）它运行成功但稍慢。我不明白谷歌浏览器如何做到这一点？它是在软件中编译和运行着色器吗？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-06-15T09:25:57.193

原因是 Chrome 中的 WebGL 和 Windows 上的 Firefox 不使用 OpenGL，而是使用 DirectX 进行渲染。

它们都使用将 OpenGL ES 2.0 API 调用转换为 DirectX 9 API 调用的 ANGLE 库（几乎是原生图形层引擎）。

在此处查看更多信息： [http ://code.google.com/p/angleproject/](http://code.google.com/p/angleproject/)

如果 DirectX 9 不可用，Windows 上的 Chrome 使用名为 SwiftShader ( [http://transgaming.com/swiftshader](http://transgaming.com/swiftshader) ) 的软件渲染器。

在此处查看更多信息：http: [//blog.chromium.org/2012/02/gpu-accelerating-2d-canvas-and-enabling.html](http://blog.chromium.org/2012/02/gpu-accelerating-2d-canvas-and-enabling.html)

# php - .htaccess 使 url 对搜索引擎友好

> ID：11043946
> 
> 赞同：2
> 
> 时间：2012-06-15T02:35:12.657
> 
> 标签：php, apache, .htaccess, url, seo

我已经为我的问题寻找一些解决方案，我找到了这个[链接](https://stackoverflow.com/questions/8053938/htaccess-to-create-search-engine-friendly-urls)。但这不符合我的问题。我目前正在使用 PHP 构建一个网站，并且我已经在 url 中使用了查询字符串。例如，我有很多这样的网址：

```
www.example.com?page=something
and also
www.example.com?page=something&action=anything 
```

我只想拥有：

```
www.example.com/something
and
www.example.com/something/anything 
```

我也是 .htacess 脚本的新手，所以即使我从 Google 得到了一些建议，我也不知道该脚本对我意味着什么。

谢谢。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-06-15T02:48:15.950

为此有不同类型的架构。

最常见的是`mod_rewrite`. 使用一组`RewriteRule`'s，您可以根据需要重定向流量。

这方面的一个例子是：

```
RewriteEngine On
RewriteBase /

RewriteRule ^([^/]+)(?:/([^/]+))? index.php?page=$1&action=$2 [L] 
```

然而，这些规则的管理可以说变得复杂。在您的情况下，您必须为 URL 创建另一个规则，例如：`/some/other/page`

另一种方法是使用[前端控制器模式](http://www.mind-it.info/2010/01/18/a-simple-front-end-controller-in-php/)。您的所有流量过滤器都通过一个地方（例如 index.php）进行*路由*。如果您正在运行 Apache 2.2.17 或更高版本（现在大多数服务器都是这样），您可以使用[`FallbackResource`](http://httpd.apache.org/docs/trunk/mod/mod_dir.html#fallbackresource).

例如：

```
FallbackResource /index.php 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-06-15T02:48:49.957

这是使用 mod_rewrite 进行的相当基本的重写。像这样的东西应该可以完成这项工作：

```
RewriteEngine On
RewriteRule ^([^/]+)(?:/([^/]+))? index.php?page=$1&action=$2 [L] 
```

该表达式`([^/])`表示将所有内容匹配到下一个`/`。包含相同的`(?:/([^/]+))?`模式，但被非捕获组包围`(?:/ )?`，这使得整个第二组是可选的。

# python - Python 2.3 仅使用 .Sort() 按值对字典进行排序

> ID：11043949
> 
> 赞同：0
> 
> 时间：2012-06-15T02:35:23.630
> 
> 标签：python, sorting, dictionary, python-2.3

当我们得到的只是`dict.sort()`不带参数时，我们如何在 Python 2.3 中按值对字典进行排序。我可以使用`sorted(dict.items(), lambda x, y: cmp(x[1], y[1]), reverse=True)`较新的 Python 进行排序。

需要的是： 示例：

```
d = {'a':2,'b':1,'c':3} 
```

排序后：

```
[('c':3),('a':2),('b':1)] 
```

请问有什么提示吗？谢谢 ！

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2012-06-15T02:40:47.373

在新版本中有很多我们认为理所当然的事情......

无论如何，[施瓦茨变换](http://en.wikipedia.org/wiki/Schwartzian_transform)：

```
>>> l = [(-x[1], x) for x in d.items()]
>>> l.sort()
>>> l2 = [x[1] for x in l]
>>> l2
[('c', 3), ('a', 2), ('b', 1)] 
```

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2012-06-15T02:43:28.993

来自文档：“sort() 方法采用一个可选参数，指定 2 个参数（列表项）的比较函数，该函数应返回 -1、0 或 1，具体取决于第一个参数是否被认为小于、等于或大于第二个参数”

所以你想要类似的东西

```
lst = d.items()
lst.sort(lambda a,b: b[1]-a[1]) 
```

返回

```
[('c', 3), ('a', 2), ('b', 1)] 
```

**编辑：** lambda 函数是一个比较器。对于普通的升序排序，如果 a<b，则返回值 <0，如果 a==b，则返回 ==0，如果 a>b，则返回 >0。获得这个的简单方法是 ab。

我们想以相反的顺序排序 - 所以我们颠倒比较器的符号，如果 a>b （等等）返回一个值 <0 ......并且获得它的简单方法是 ba。

我们对每个项目的第二个成员进行排序，因此比较器变为 b[1]-a[1]，如上。

# c# - 使用 ASP.Net WebAPI SelfHosting 接受任何主机标头

> ID：11043950
> 
> 赞同：1
> 
> 时间：2012-06-15T02:36:10.710
> 
> 标签：c#, asp.net-web-api

有没有办法接受任何带有 ASP.Net WebApi 的主机头，例如：

```
var config = new HttpSelfHostConfiguration(http://*:8080); 
```

我希望接受任何主机头

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-06-15T02:37:00.040

Webapi 似乎接受自托管服务的任何主机标头（域）。例如，如果您绑定

```
var config = new HttpSelfHostConfiguration(http://zzz:8080); 
```

webapi 将接受来自

`http://aaa:8080`（假设 dns 指向机器）

或者

```
http://localhost:8080 
```

这不是很直观

# sql - tinyint(3) 在 (SQLite) SQL 中是什么意思？

> ID：11043951
> 
> 赞同：7
> 
> 时间：2012-06-15T02:36:30.690
> 
> 标签：sql, sqlite, tinyint

我意识到这`tinyint`是一个单字节整数（顺便说一句，它是有符号的还是无符号的？）。论据有什么`(3)`意义？我已经搜索并找不到答案。

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2012-06-15T02:44:32.423

*SQLite 在columns*上“模拟实现”数据类型。基本上，它接受标准 SQL 语法，但在其他方面忽略它。（但请参阅类型亲和力和强制。）

请参阅“差异”文档中的[清单类型。](http://www.sqlite.org/different.html)

> 大多数 SQL 数据库引擎使用静态类型。数据类型与表中的每一列相关联，并且仅允许将该特定数据类型的值存储在该列中。SQLite 通过使用清单类型来放宽这个限制。**在清单类型中，数据类型是值本身的属性，而不是存储值的列的属性。**因此，SQLite 允许用户将任何数据类型的任何值存储到任何列中，而不管该列的声明类型如何。（此规则有一些例外情况：INTEGER PRIMARY KEY 列只能存储整数。并且**SQLite 会尝试将值*强制转换为列**的*****声明数据类型**。）

另请参阅[SQLite 版本 3 中的数据类型](http://www.sqlite.org/datatype3.html)和类型关联：

> 列的亲和性由列的声明类型确定，根据以下规则按所示顺序确定：
> 
> *   **如果声明的类型包含字符串“INT”，则为其分配 INTEGER 亲和性。**
>     
>     
> *   [为简洁起见省略其他规则]

* * *

对于其他数据库，请参阅相应的特定于数据库的文档 :-)

* * *

## 回答 #2

> 赞同：5
> 
> 时间：2012-06-15T02:40:13.643

请参阅有关 MySQL 列类型定义的[博客页面。](http://web.archive.org/web/20120622163800/http://www.phpmag.ru/2009/02/15/mysql-tinyint1-and-tinyint4-which-one-is-bigger/)

> 对于数字类型，长度修饰符实际上是显示宽度，与字段中可以存储的内容无关。是的，就是这样 - TINYINT(1) 和 TINYINT(4) 都可以存储 -128..127 范围内的值（或无符号值 0..255），并且是完全相同的数据类型，只有一点点变化（涉及日期检索——见下文）。以下是直接取自源代码的显示宽度含义的解释：
> 
> > 显示宽度不限制可以存储在列中的值的范围，也不限制宽度超过为列指定的值显示的位数。例如，指定为 SMALLINT(3) 的列的 SMALLINT 范围通常为 -32768 到 32767，超出三个字符允许范围的值使用三个以上的字符显示。

# hadoop - Map 运行良好，但 Reduce 失败

> ID：11043962
> 
> 赞同：0
> 
> 时间：2012-06-15T02:38:56.797
> 
> 标签：hadoop, mapreduce

我运行了一个简单的排序程序，但是，我遇到了如下错误。

```
12/06/15 01:13:17 WARN mapred.JobClient: Error reading task outputServer returned HTTP response code: 403 for URL: _http://192.168.1.106:50060/tasklog?plaintext=true&attemptid=attempt_201206150102_0002_m_000001_1&filter=stdout
12/06/15 01:13:18 WARN mapred.JobClient: Error reading task outputServer returned HTTP response code: 403 for URL: _http://192.168.1.106:50060/tasklog?plaintext=true&attemptid=attempt_201206150102_0002_m_000001_1&filter=stderr
12/06/15 01:13:20 INFO mapred.JobClient:  map 50% reduce 0%
12/06/15 01:13:23 INFO mapred.JobClient:  map 100% reduce 0%
12/06/15 01:14:19 INFO mapred.JobClient: Task Id : attempt_201206150102_0002_m_000000_2, Status : FAILED
Too many fetch-failures
12/06/15 01:14:20 WARN mapred.JobClient: Error reading task outputServer returned HTTP response code: 403 for URL: _http://192.168.1.106:50060/tasklog?plaintext=true&attemptid=attempt_201206150102_0002_m_000000_2&filter=stdout 
```

有谁知道是什么原因以及如何解决？

--------更新更多日志信息-------

2012-06-15 19:56:07,039 警告 org.apache.hadoop.util.NativeCodeLoader：无法为您的平台加载 native-hadoop 库...在适用的情况下使用内置 java 类 2012-06-15 19:56： 07,258 WARN org.apache.hadoop.metrics2.impl.MetricsSystemImpl：源名称 ugi 已经存在！2012-06-15 19:56:07,339 信息 org.apache.hadoop.mapred.Task：使用 ResourceCalculatorPlugin：空 2012-06-15 19:56:07,346 信息 org.apache.hadoop.mapred.ReduceTask：ShuffleRamManager：MemoryLimit= 144965632，MaxSingleShuffleLimit=36241408 2012-06-15 19:56:07,351 INFO org.apache.hadoop.mapred.ReduceTask：attempt_201206151954_0001_r_000000_0 线程已启动：用于合并磁盘文件的线程 2012-076-15 INFO.076-15 9:56: apache.hadoop.mapred.ReduceTask：attempt_201206151954_0001_r_000000_0 线程已启动：用于合并内存文件的线程 2012-06-15 19:56:07，

2012-06-15 19：56：32,077 info org.apache.hadoop.mapred.reducetask：任务尝试_201206151954_0001_r_000000_0：从尝试的Fetch＃1失败_201206151954_0001_M_000000_0 2012-06-15 19：56：32,077 info org.apache.hadoop.mapred.reduceTask ：即使在 MAX_FETCH_RETRIES_PER_MAP 重试之后，也无法从尝试_201206151954_0001_m_000000_0 获取地图输出......或者这是一个读取错误，报告给 JobTracker 2012-06-15 19:56:32,077 WARN org.apache.hadoop.mapred.ReduceTask0050_201020615主机 192.168.1.106 到罚球箱，12 秒后下一次联系 2012-06-15 19:56:32,077 信息 org.apache.hadoop.mapred.ReduceTask：尝试_201206151954_0001_r_000000_0：从以前的故障中获得 1 个地图输出 2012-06-15 19 :56:47,080 信息 org.apache.hadoop.mapred.ReduceTask:尝试_201206151954_0001_r_000000_0计划的1个输出（0慢一个慢主机和0 dup主机）2012-06-15 19：56：56,048 Warn org.apache.hadoop.mapred.reducetask：尝试_201206151954_0001_R_000000_0复制失败：尝试_201206151954_0001_M_000000_0来自192.168.1.106 2012-06-15 19:56 ：56,049 WARN org.apache.hadoop.mapred.ReduceTask：java.io.IOException：服务器返回的 HTTP 响应代码：403 用于 URL：_http://192.168.1.106:50060/mapOutput?job=job_201206151954_0001&map=attempt_201206151954_0001_m_000000 at sunreduce= .net.www.protocol.http.HttpURLConnection.getInputStream(HttpURLConnection.java:1436) 在 org.apache.hadoop.mapred.ReduceTask$ReduceCopier$MapOutputCopier.getInputStream(ReduceTask.java:1639) 在 org.apache.hadoop.mapred .ReduceTask$ReduceCopier$MapOutputCopier.setupSecureConnection(ReduceTask.java:1575) 在 org.apache。hadoop.mapred.ReduceTask$ReduceCopier$MapOutputCopier.getMapOutput(ReduceTask.java:1483) 在 org.apache.hadoop.mapred.ReduceTask$ReduceCopier$MapOutputCopier.copyOutput(ReduceTask.java:1394) 在 org.apache.hadoop.mapred。 ReduceTask$ReduceCopier$MapOutputCopier.run(ReduceTask.java:1326)

尝试_201206151954_0001_r_000000_0 需要另外 2 个地图输出，其中 0 已经在进行中 2012-06-15 19:57:11,053 信息 org.apache.hadoop.mapred.ReduceTask：尝试_201206151954_0001_r_000000_0 计划的 0 个输出（1 个慢速主机和 0 个慢速主机） 06-15 19:57:11,053 INFO org.apache.hadoop.mapred.ReduceTask: Penalized(slow) Hosts: 2012-06-15 19:57:11,053 INFO org.apache.hadoop.mapred.ReduceTask: 192.168.1.106 Will考虑后：1秒。2012-06-15 19:57:16,055 信息 org.apache.hadoop.mapred.ReduceTask：attempt_201206151954_0001_r_000000_0 预定的 1 个输出（0 个慢速主机和 0 个重复主机） 2012-06-15 19:57:25,984 警告 org.apache.hadoop。 mapred.ReduceTask：attempt_201206151954_0001_r_000000_0 复制失败：从 192.168.1.106 开始的尝试_201206151954_0001_m_000000_0 2012-06-15 19:57:25,984 WARN org.apache.hadoop.mapred.ReduceTask：

最好的祝福，

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-10-27T14:33:20.923

我遇到过同样的问题。深入挖掘后，我确定问题出在主机的名称解析上。请检查特定尝试的日志

```
$HADOOP_HOME/logs/userlogs/JobXXX/attemptXXX/syslog 
```

如果它有类似的东西

> 警告 org.apache.hadoop.mapred.ReduceTask：java.net.UnknownHostException：slave-1.local.lan

然后只需在 /etc/hosts 中添加适当的条目。完成此操作后，错误得到解决，并且在下一次尝试中一切正常。

# c++ - 如何在 SDL 中缩放至分辨率？

> ID：11043969
> 
> 赞同：10
> 
> 时间：2012-06-15T02:39:54.800
> 
> 标签：c++, opengl, sdl

我正在使用 SDL 和 C++ 编写 2D 平台游戏。但是，我遇到了一个涉及缩放到分辨率的巨大问题。我希望游戏在全高清下看起来不错，因此游戏的所有图像都已创建，因此游戏的自然分辨率为 1920x1080。但是，如果有人使用较小的分辨率，我希望游戏可以缩小到正确的分辨率，或者如果有人使用较大的分辨率，我希望游戏可以放大。

问题是我无法找到一种有效的方法来做到这一点。我首先使用 SDL_gfx 库来预缩放所有图像，但这不起作用，因为它会产生很多错误，一个像素丢失的地方。而且由于我的动画包含在一个图像中，当动画播放时，动画会在每一帧中略微向上或向下移动。

然后经过一番环顾后，我尝试使用 opengl 来处理缩放。目前，我的程序将所有图像绘制到 1920x1080 的 SDL_Surface。然后，它将这个表面转换为一个 opengl 纹理，将此纹理缩放到屏幕分辨率，然后绘制纹理。这在视觉上效果很好，但问题是它根本没有效率。目前我的最大 fps 为 18 :(

所以我的问题是有人知道将 SDL 显示缩放到屏幕分辨率的有效方法吗？

* * *

## 回答 #1

> 赞同：10
> 
> 时间：2012-06-17T07:42:08.273

这是低效的，因为 OpenGL 并非设计为以这种方式工作。当前设计的主要性能问题：

*   第一个问题：您正在使用 SDL 进行软件光栅化。抱歉，但无论您如何使用此配置，这都将成为瓶颈。在 1920x1080 的分辨率下，您有 2,073,600 个像素可供着色。假设着色每个 4 通道像素需要 10 个时钟周期，那么在 2GHz 处理器上，您运行的*最大*速度为 96.4 fps。这听起来不错，除了你可能*无法*快速着色像素，*而且*你还没有完成人工智能、用户输入、游戏机制、声音、物理和其他所有事情，而且你可能正在绘制一些像素至少一次。SDL_gfx 可能很快，但对于大分辨率，CPU 只是从根本上过度工作。
*   第二个问题：每一帧，您都在通过图形总线将数据复制到 GPU。这是您在图形方面可以做的最慢的事情。图像数据可能是最糟糕的*，*因为它通常太多了。基本上，您告诉 GPU 将 200 万个像素从 RAM 复制到 VRAM 的每一帧。根据[Wikipedia](http://en.wikipedia.org/wiki/PCI_Express)的说法，您可以预期，对于 2,073,600 个像素，每个 4 字节，不超过 258.9 fps，在您记住需要做的所有其他事情之前，这听起来还不错。

我的建议：将您的应用程序完全切换到 OpenGL。这消除了渲染到纹理并复制到屏幕的需要——只需直接渲染到屏幕！此外，缩放由您的视图矩阵自动处理（glOrtho/gluOrtho2D 用于 2D），因此您*根本不必关心*缩放问题 - 您的视口只会以相同的比例显示所有内容。 **这是您问题的理想解决方案。**

现在，它带来了一个主要缺点，即您必须使用 OpenGL 绘制命令重新编码所有内容（这是可行的，但不是太难，尤其是从长远来看）。除此之外，您可以尝试以下想法来提高速度：

*   公益组织。通过使纹理加载/复制异步，像素缓冲区对象可用于解决问题二。
*   多线程渲染。大多数 CPU 至少有两个内核，在较新的芯片上，可以为单个内核保存两个寄存器状态（[超线程](http://en.wikipedia.org/wiki/Hyper-threading)）。您实际上是在复制 GPU 解决渲染问题的方式（有很多线程在运行）。我不确定 SDL_gfx 的线程安全性如何，但我敢打赌可以解决一些问题，特别是如果您同时只处理图像的不同部分。
*   确保注意绘图表面在 SDL 中的位置。它可能应该是 SDL_SWSURFACE （因为你在 CPU 上绘图）。
*   删除垂直同步。即使您没有以 60Hz 运行，这也可以提高性能
*   确保您正在绘制原始纹理 - 不要将其放大或缩小到新纹理。以不同的大小绘制它，让光栅化器完成工作！
*   偶尔更新：一次只更新一半的图像。这可能会使您的“帧速率”增加一倍，并且（通常）不明显。
*   同样，只更新图像的变化部分。

希望这可以帮助。

# android - Android，如何动态更改列表视图的图像视图项？

> ID：11043974
> 
> 赞同：2
> 
> 时间：2012-06-15T02:40:31.330
> 
> 标签：android, image, listview, dynamic, listadapter

我有一个清单。每行包括左侧的图像和右侧的两个文本视图。根据服务器标志，我的应用程序打开系统媒体播放器或打开另一个活动以显示新闻详细信息。

在我的适配器中，我想在我的视频图像（不是新闻图像）上添加另一个图像。因此，在 Row 的 XML 文件中，我有另一个图像视图，它的可见性设置为“不可见”，我想为每一行视频将其设置为“可见”。

getView() 方法是这样的：

```
@Override
    public View getView(int position, View convertView, ViewGroup parent) {
        ViewHolder holder;        

            if (convertView == null) {
                convertView     = myInflater.inflate(R.layout.list_news_adapter, null);
                holder          = new ViewHolder();
                holder.ivIcon   = (ImageView)   convertView.findViewById(R.id.list_news_icon);
                holder.ivPlay   = (ImageView)   convertView.findViewById(R.id.list_news_PlayIcon);
                holder.tvTitle  = (TextView)    convertView.findViewById(R.id.list_news_title);
                holder.tvDate   = (TextView)    convertView.findViewById(R.id.list_news_date);

                convertView.setTag(holder);
            } else {
                holder = (ViewHolder) convertView.getTag();
            }

            holder.tvTitle.setText(mLatestNews.getTitle().get(position));
            holder.tvDate.setText(localTime.get(position));

            if(mLatestNews.getType().get(position).equalsIgnoreCase("VIDEO"))
                holder.ivPlay.setVisibility(View.VISIBLE);

            // Load and display image
            String imageUrl = (mLatestNews.getImageLink().get(position));
            imageUrl = imageUrl.trim().replaceAll(" ", "%20");
            imageLoader.displayImage(imageUrl, holder.ivIcon, options);

            return convertView;
    }

    static class ViewHolder {
        ImageView ivIcon;
        ImageView ivPlay;
        TextView tvTitle;
        TextView tvDate;
    } 
```

通常列表的前四项是视频，其余的是新闻。当我运行应用程序时，对于某些新闻项目，不仅会激活 4 个第一个项目，甚至第二个图像也会被激活（设置为可见）。

正确的结果是这样的图像： ![在此处输入图像描述](../Images/745c29141bde5494b376f7c7759f77b4.png)

但在列表滚动后，第二个图像（白色三角形）添加到新闻项目中。像这张图片： ![在此处输入图像描述](../Images/6e828799c345f35ae12a9b7a60764c7e.png)

我不知道为什么会这样。任何建议将不胜感激。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-06-15T02:47:19.970

我的天啊！！！！

它只需要“其他”。我改变了这样的代码：

```
if(mLatestNews.getType().get(position).equalsIgnoreCase("VIDEO"))
                holder.ivPlay.setVisibility(View.VISIBLE);
            else
                holder.ivPlay.setVisibility(View.INVISIBLE); 
```

现在，它正在工作。

# google-app-engine - GAE频道重复发送第一条消息

> ID：11043979
> 
> 赞同：1
> 
> 时间：2012-06-15T02:41:00.430
> 
> 标签：google-app-engine, gwt, channel-api

所以这是几个月前在这个项目上的工作。我正在使用 Google App Engine 的 Channel API 将消息推送到我的 GWT 应用程序。我正在使用[http://code.google.com/p/gwt-gae-channel/](http://code.google.com/p/gwt-gae-channel/)通过 GWT 进行交互。

假设我向客户端发送了 1 条消息：“第一条消息”

客户端会收到消息，“第一条消息”就好了。

然后假设我向客户端发送另一条消息“第二条消息”。

客户端将再次收到消息“第一条消息”。

这将继续发生。在某些情况下，我会收到第二条消息，这将是重复卡住的消息。

当我最终关闭页面并因此关闭频道时，我再次收到重复的消息，而没有从服务器发送任何内容。

有谁知道发生了什么？我认为几个月前我在做这个工作时不会发生这种情况，而且我看不到 GAE Channel API 没有任何变化。

* * *

这是一些代码：

```
 String json = AutoBeanHelper.toJson(proxy);
        log.fine("Item's JSON Received: " + json);

        List<ChannelEntity> channels = channelDAO.getByUserId();
        if (channels.size() > 1) {
            log.warning("Multiple channels for single user detected.");
        }

        ChannelService channelService = ChannelServiceFactory.getChannelService();
        for (ChannelEntity channel : channels) {
            channelService.sendMessage(new ChannelMessage(channel.getClientId(), json));
        } 
```

所以每当我存储一个特定类型的新项目时（这是在那个实体更新函数中）： 1\. 我把它变成 JSON。2\. 然后我记录那个 JSON。3\. 我得到了那个用户频道。4\. 我把它发送到那个用户频道。

当我查看我的日志时，我看到我正在记录的上面的变量显示正确，这意味着**我正在记录正确的 JSON 消息**，但是当我在客户端的警报中显示 JSON 时，它一得到对客户来说，这是上一条消息似乎被卡住了重复。我真的不知道我在这里做错了什么。

如果您想查看代码的另一部分，请告诉我。为了更好地衡量，这是客户端上的代码：

```
eventBus.addHandler(ReceivedChannelTokenEvent.TYPE, new ReceivedChannelTokenEventHandler() {
        @Override
        public void onEvent(ReceivedChannelTokenEvent event) {
            ChannelFactory.createChannel(event.getChannelToken(), new ChannelCreatedCallback() {
                @Override
                public void onChannelCreated(Channel channel) {
                    final Socket channelSocket = channel.open(new SocketListener() {
                        @Override
                        public void onOpen() {
                            Window.alert("Channel Opened");
                        }
                        @Override
                        public void onMessage(String json) {
                            Window.alert(json);
                            eventBus.fireEvent(new MessageReceivedEvent(json));

                        }
                        @Override
                        public void onError(SocketError error) {
                            Window.alert("Channel Error: " + error.getDescription());
                            if ( error.getDescription().equals(CHANNEL_ERROR_TOKEN_TIME_OUT) ) {
                                eventBus.fireEvent(new ChannelTimeOutEvent());
                            }
                        }
                        @Override
                        public void onClose() {
                            Window.alert("Channel Closed.");
                        }
                    });

                    Window.addWindowClosingHandler(new Window.ClosingHandler() {
                        @Override
                        public void onWindowClosing(ClosingEvent event) {
                            channelSocket.close();
                        }
                    });
                }
            });
        }
    }); 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-06-15T04:15:47.493

我看到很多关于 SO 的问题，有人在他们的代码中有错误，但认为这是框架的一部分。在没有看到任何代码的情况下，我怀疑存在一些错误，您认为您正在发送“第二条消息”，但实际上您发送的是“第一条消息”的缓存版本。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-06-24T20:50:27.467

所以我终于能够弄清楚了。似乎在我调用时应用程序内的 onMessage 函数中

```
eventBus.fireEvent(new MessageReceivedEvent(json)); 
```

似乎它永远不会从这里返回，因此永远不会退出代码中的 onMessage 函数，导致我重复收到相同的消息。

# sql-server-2008 - datetime2 是否有类似 isdate() 的函数？

> ID：11043981
> 
> 赞同：8
> 
> 时间：2012-06-15T02:41:26.997
> 
> 标签：sql-server-2008, tsql, sql-server-2012, datetime2

我知道有一个调用`ISDATE`来验证`DATETIME`列的函数，但它仅适用于`SMALLDATETIME`and`DATETIME`类型。

是否有类似的方法来验证`DATETIME2`SQL Server 2008 和 2012 中的新数据类型？

* * *

## 回答 #1

> 赞同：17
> 
> 时间：2012-06-15T02:46:17.200

在 SQL Server 2012 中，您可以使用`TRY_CONVERT`：

```
SELECT TRY_CONVERT(DATETIME2, '2012-02-02 13:42:55.2323623'),
       TRY_CONVERT(DATETIME2, '2012-02-31 13:42:55.2323623'); 
```

结果：

```
2012-02-02 13:42:55.2323623    NULL 
```

或者`TRY_PARSE`：

```
SELECT TRY_PARSE('2012-02-02 13:42:55.2323623' AS DATETIME2),
       TRY_PARSE('2012-02-31 13:42:55.2323623' AS DATETIME2); 
```

（结果相同。）

抱歉，对于< SQL Server 2012，我没有给你一个聪明的答案。我想你可以说

```
SELECT ISDATE(LEFT('2012-02-02 13:42:55.2323623', 23)); 
```

但这感觉很脏。

[`TRY_CONVERT`Microsoft Docs](https://docs.microsoft.com/en-us/sql/t-sql/functions/try-convert-transact-sql)
[`TRY_PARSE`上的文档 Microsoft Docs 上的文档](https://docs.microsoft.com/en-us/sql/t-sql/functions/try-parse-transact-sql)

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2019-08-27T08:28:48.877

`LEFT(..., 23)`在使用另一种日期格式`mdy`（和 SQL-Server 2008）的数据库系统上使用该解决方案时要小心。[`DBCC USEROPTIONS`](https://docs.microsoft.com/en-us/sql/t-sql/database-console-commands/dbcc-useroptions-transact-sql)您可以使用该命令查看当前会话的日期格式。

在使用德语 dateformat ( `dmy`) 的数据库系统上，该`LEFT(..., 23)`解决方案不起作用（*在 day > 12 的日期检测到*）。请参阅以下测试用例：

```
-- test table using a DATETIME and DATETIME2 column.
CREATE TABLE dt_vs_dt2 (
  dt DATETIME,
  dt2 DATETIME2
);

-- set a datetime values with a day > 12.
DECLARE @date_value AS DATETIME = DATEADD(DAY, 18 - DAY(GETDATE()), GETDATE());

-- insert the current date into both columns using GETDATE.
-- note: using the following on a day > 12
INSERT INTO dt_vs_dt2 VALUES (@date_value, @date_value);

-- let's have a look at the values.
-- the values look the same (the datetime2 is more precise as expected).
SELECT dt, dt2 FROM dt_vs_dt2;

-- now we expect both values are valid date values.
-- to validate the datetime2 value, the LEFT(..., 23) solution is used.
SELECT ISDATE(dt), ISDATE(LEFT(dt2, 23)) 
FROM dt_vs_dt2; 
```

**如何解决？**

您可以使用 a`CAST(column_name AS DATETIME)`而不是 the`LEFT(..., 23)`来完成这项工作：

```
-- using a CAST(... AS DATETIME) instead of `LEFT(..., 23)` seems to work.
SELECT dt, CAST(dt2 AS DATETIME) AS dt2
FROM dt_vs_dt2;

-- now both values are valid dates.
SELECT ISDATE(dt) AS dt, ISDATE(CAST(dt2 AS DATETIME)) AS dt2
FROM dt_vs_dt2; 
```

[**dbfiddle.uk 上的演示（使用`dmy`）**](https://dbfiddle.uk/?rdbms=sqlserver_2012&fiddle=1c9d1c0c43a34343cf7bd6e5e982f813) /dbfiddle.uk[**上的演示（使用`mdy`）**](https://dbfiddle.uk/?rdbms=sqlserver_2012&fiddle=1e5f7750d5cf57603dcbdfc2a3577398)

* * *

在 SQL Server 2012 及更高版本上，您应该使用[@Aaron Bertrand answer](https://stackoverflow.com/a/11044004/3840840)中描述的`TRY_PARSE`/解决方案。此答案中解释的解决方案也应该有效。`TRY_CONVERT``CAST(... AS DATETIME)`

# jquery - 如何在输入时为输入字段中的数字添加自动十进制

> ID：11043983
> 
> 赞同：0
> 
> 时间：2012-06-15T02:41:49.447
> 
> 标签：jquery

我试图在输入数字时自动更改为十进制的输入，但仅固定为 2 个十进制点。请帮助我，因为我还是 jquery 的新手

我的代码：

```
 $.fn.billFormat = function() {
        $(this).keyup( function( e ){
                if( isNaN(parseFloat(this.value )) ) return;
                this.value = parseFloat(this.value).toFixed(2);
        });
        return this; 
 }

$('#ENQUIRY_PREPAIDBILL .bill_issued').billFormat(); 
```

我希望输出是这样的

0.00 <------ 默认值
0.01 <----- 输入 1
0.10 <----- 输入 0
1.00 <----- 输入 0

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-06-15T02:52:44.850

```
 $.fn.billFormat = function() {
        this.val("0.00");
        this.keyup( function( e ){
                if( isNaN(parseFloat(this.value )) ) return;
                this.value = parseFloat(this.value * 10, 10).toFixed(2);
        });
        return this; 
 } 
```

这是[演示](http://jsfiddle.net/cHAc7/)。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-06-15T04:19:00.987

这是另一种无需担心溢出的解决方案（您可以在[此处找到演示](http://jsfiddle.net/pYHDE/93/)

```
$(document).ready(function(){
    $('#txtInput').keydown(function(e){
        var value = $('#txtInput').val().toString();
        var number = null;
        if(value == '')
            value = '0.00';
        switch(e.which)
        {
            case 48:
            case 49:
            case 50:
            case 51:
            case 52:
            case 53:
            case 54:
            case 55:
            case 56:
            case 57:
                number = e.which - 48;
            case 8:
            case 46:
            case 32:
            case 37:
            case 38:
            case 39:
            case 40:
                break;
            default:
                e.preventDefault();
                break;
        }
        var dotIndex = value.indexOf('.');
        if(number === null)
        {
            value = value.substr(0,dotIndex-1) + '.' + value.substr(dotIndex -1,1) + value.substr(dotIndex+1,1);
            if(value.indexOf('.') ==0)
            {
                value = '0' + value;
            }
        }
        else
        {

            value = value.substr(0,dotIndex) + value.substr(dotIndex+1,1) + '.' + value.substr(dotIndex+2);

            value += number.toString();  
            value = value.replace(/^0+/,'');
            if(value.indexOf('.') == 0)
            {
                value = '0' + value;
            }               

        }
        $('#txtInput').val(value);
        e.preventDefault();
    }).keyup(function(e){

        switch(e.which)
        {
            case 48:
            case 49:
            case 50:
            case 51:
            case 52:
            case 53:
            case 54:
            case 55:
            case 56:
            case 57:
                e.preventDefault();
                break;
        }
    });
});​ 
```

和这段代码的 html

```
<input type='text' id='txtInput' />​ 
```

# c++ - C++ 标准参数：多次调用 va_start

> ID：11043986
> 
> 赞同：2
> 
> 时间：2012-06-15T02:42:24.400
> 
> 标签：c++, variadic-functions

我注意到`va_start`在两个函数中连续调用时存在一些问题。一个基本示例如下：

```
std::string format(std::string fmt, ...)
{
   char buf[2000];
   va_list aq;
   va_start(aq, fmt);
   vsprintf(buf, fmt.c_str(), aq);
   va_end(aq);
   return std::string(buf);
}
void error(std::string fmt, ...)
{
   va_list ap;
   va_start(ap, fmt);
   printf("%s", format(fmt, ap).c_str());
   va_end(ap); 
   exit(1);
}

int main()
{
   int x = 10;
   printf("%s", format("Test %d\n", x).c_str());
   error("Test %d\n", x);
} 
```

生产

```
Test 10
Test -1078340156 
```

似乎，在使用该`error`函数时，参数已损坏。

将 传递`va_list`给另一个函数的正确方法是什么？

* * *

## 回答 #1

> 赞同：11
> 
> 时间：2012-06-15T02:45:13.983

您将`va_list`明确地作为参数传递。将 a传递`va_list`给采用多个参数的函数不会“解包”这些参数。相反，它只是用两个参数调用函数，第二个参数是 a `va_list`。您从函数中获取垃圾的原因是它试图将其解释`va_list`为 的参数之一`printf`，从而导致未定义的行为。

这就是为什么有类似函数的原因`vsprintf`- 这样函数喜欢`printf`或`sprintf`可以在内部调用辅助函数来进行格式化，给定`va_list`参数。

例如：

```
std::string vformat(std::string fmt, va_list args) {
   char buf[2000];
   vsprintf(buf, fmt.c_str(), args);
   return std::string(buf);
}

void error(std::string fmt, ...) {
   va_list ap;
   va_start(ap, fmt);
   printf("%s", vformat(fmt, ap).c_str());
   va_end(ap); 
   exit(1);
} 
```

尽管如此，在 C++ 中，您应该使用可变参数模板来执行此操作，因为它们可以正确转发，完全类型安全，并且（如果您正确实现它）不会冒缓冲区溢出的风险。

希望这可以帮助！

# java - Spring 和 JSR 303 验证。如何仅验证某些属性？

> ID：11043987
> 
> 赞同：0
> 
> 时间：2012-06-15T02:42:51.930
> 
> 标签：java, spring-mvc, bean-validation

假设我们有一个注册表单。当表单的某些输入发生更改时，我想通过使用对服务器的 ajax 调用来动态验证其值。是否有机会使用 JSR 303 验证仅验证 bean 的某些特定属性？

注册表单处理程序验证接收到的 bean 就好了，但我想找出在提交整个 bean 之前检查属性的方法。

直接的方法是创建一个服务器端方法来接收属性名称和值并根据名称检查值，但我希望有一种方法可以使用已经为 bean 定义的约束。

例如，用户输入电子邮件地址并前进到下一个属性。客户端进行调用，服务器方法检查提供的电子邮件是否已经存在。如果是这样，它会返回一个错误，我会在客户端显示它。我相信它可以使注册过程更加灵活和用户友好

任何评论都非常感谢。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-06-15T03:05:03.127

jsr-303[验证器](http://docs.oracle.com/javaee/6/api/javax/validation/Validator.html)确实有一个方法可以验证一个属性：

```
<T> java.util.Set<ConstraintViolation<T>> validateProperty(T object,
                                                           java.lang.String propertyName,
                                                           java.lang.Class<?>... groups) 
```

您只需要注入验证器，以便您可以直接使用它，而不是依赖 Spring 通过将 @Valid 放在方法参数上来自动调用它。

# c++ - 无法诊断 Qt 应用程序中的段错误

> ID：11043994
> 
> 赞同：5
> 
> 时间：2012-06-15T02:43:34.813
> 
> 标签：c++, qt, segmentation-fault, qtwebkit

我有一个使用 QtWebKit 的应用程序。它加载 URL 并导出渲染树上的一些统计信息。这部分代码导致问题：

```
...
if (mPage != 0) {
    disconnectSignals(mPage);
    delete mPage;
}
mPage = new Page(); //subclass of QWebPage
connectSignals(mPage);
QNetworkRequest req;
req.setUrl("http://...");
mPage->mainFrame()->load(req, QNetworkAccessManager::GetOperation); 
```

上述代码第一次运行 mPage=0 时，页面加载正常，其他一切都按预期进行。第二次，它是指向先前创建的页面的指针，因此它被断开并删除。在 load() 将控制权返回给主事件循环后，我得到一个 SIGSEGV 并带有以下堆栈跟踪。

```
#0  0x00007ffff49a1e56 in QMetaObject::activate(QObject*, QMetaObject const*, int, void**)          () from /home/ubuntu/3rdparty/qt-4.8.1/lib/libQtCore.so.4
#1  0x00007ffff6842972 in QWebFrame::loadFinished(bool) () from /home/ubuntu/3rdparty/qt-    4.8.1/lib/libQtWebKit.so.4
#2  0x00007ffff6881955 in ?? () from /home/ubuntu/3rdparty/qt-4.8.1/lib/libQtWebKit.so.4
#3  0x00007ffff6bde3ab in ?? () from /home/ubuntu/3rdparty/qt-4.8.1/lib/libQtWebKit.so.4
#4  0x00007ffff6c0ef14 in ?? () from /home/ubuntu/3rdparty/qt-4.8.1/lib/libQtWebKit.so.4
#5  0x00007ffff6e0183b in ?? () from /home/ubuntu/3rdparty/qt-4.8.1/lib/libQtWebKit.so.4
#6  0x00007ffff6e016e8 in ?? () from /home/ubuntu/3rdparty/qt-4.8.1/lib/libQtWebKit.so.4
#7  0x00007ffff6e01755 in ?? () from /home/ubuntu/3rdparty/qt-4.8.1/lib/libQtWebKit.so.4
#8  0x00007ffff6e0218c in ?? () from /home/ubuntu/3rdparty/qt-4.8.1/lib/libQtWebKit.so.4
#9  0x00007ffff49a20c1 in QMetaObject::activate(QObject*, QMetaObject const*, int, void**) () from /home/ubuntu/3rdparty/qt-4.8.1/lib/libQtCore.so.4
#10 0x00007ffff4d72b46 in ?? () from /home/ubuntu/3rdparty/qt-4.8.1/lib/libQtNetwork.so.4
#11 0x00007ffff4de91c5 in ?? () from /home/ubuntu/3rdparty/qt-4.8.1/lib/libQtNetwork.so.4
#12 0x00007ffff49a7286 in QObject::event(QEvent*) () from /home/ubuntu/3rdparty/qt-4.8.1/lib/libQtCore.so.4
#13 0x00007ffff5243fa4 in QApplicationPrivate::notify_helper(QObject*, QEvent*) () from /home/ubuntu/3rdparty/qt-4.8.1/lib/libQtGui.so.4
#14 0x00007ffff5248e23 in QApplication::notify(QObject*, QEvent*) () from /home/ubuntu/3rdparty/qt-4.8.1/lib/libQtGui.so.4
#15 0x00007ffff498e21c in QCoreApplication::notifyInternal(QObject*, QEvent*) () from /home/ubuntu/3rdparty/qt-4.8.1/lib/libQtCore.so.4
#16 0x00007ffff4991aba in QCoreApplicationPrivate::sendPostedEvents(QObject*, int,     QThreadData*) () from /home/ubuntu/3rdparty/qt-4.8.1/lib/libQtCore.so.4
#17 0x00007ffff49bce53 in ?? () from /home/ubuntu/3rdparty/qt-4.8.1/lib/libQtCore.so.4
#18 0x00007ffff235ba5d in g_main_context_dispatch () from /lib/x86_64-linux-gnu/libglib-2.0.so.0
#19 0x00007ffff235c258 in ?? () from /lib/x86_64-linux-gnu/libglib-2.0.so.0
#20 0x00007ffff235c429 in g_main_context_iteration () from /lib/x86_64-linux-gnu/libglib-2.0.so.0
#21 0x00007ffff49bd27f in QEventDispatcherGlib::processEvents(QFlags<QEventLoop::ProcessEventsFlag>) () from /home/ubuntu/3rdparty/qt-4.8.1/lib/libQtCore.so.4
#22 0x00007ffff52e78ae in ?? () from /home/ubuntu/3rdparty/qt-4.8.1/lib/libQtGui.so.4
#23 0x00007ffff498d002 in QEventLoop::processEvents(QFlags<QEventLoop::ProcessEventsFlag>) () from /home/ubuntu/3rdparty/qt-4.8.1/lib/libQtCore.so.4
#24 0x00007ffff498d257 in QEventLoop::exec(QFlags<QEventLoop::ProcessEventsFlag>) () from /   home/ubuntu/3rdparty/qt-4.8.1/lib/libQtCore.so.4
#25 0x00007ffff4991db5 in QCoreApplication::exec() () from /home/ubuntu/3rdparty/qt-4.8.1/lib/libQtCore.so.4
#26 0x0000000000408ba0 in main (argc=3, argv=<optimized out>) at RenderTreeAnalyzer.cpp:474 
```

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-06-15T14:59:06.163

您必须安排`mPage`删除`deleteLater`而不是直接删除它，因为`mPage`在事件队列中很可能有未交付的事件。

如果控制权返回到事件循环，Qt 会尝试访问已删除的对象，这会导致分段错误。

但是，从您的代码示例中，我并没有完全理解您为什么需要`newPage()`信号。

根据我的理解，`mPage->deleteLater()`应该足够了（避免段错误），并且您应该能够立即为您的本地/成员变量重新分配`mPage`一个新值（即指向 new 的指针`Page`）。

如果需要`Page`立即删除旧的，则需要返回事件循环是正确的，因为它只是在那时才被删除。

您有几个机会触发事件循环并处理您的删除请求：

1.  使用您的排队信号/插槽设置
2.  ~~调用`QApplication::processEvents();`后调用`mPage->deleteLater()`以处理事件队列中的任何事件。~~
3.  调用`QCoreApplication::sendPostedEvents(0, QEvent::DeferredDelete);`仅处理所有延迟删除。
4.  调用`QCoreApplication::sendPostedEvents(mPage, QEvent::DeferredDelete);`仅处理`mPage`.

*免责声明：我没有明确尝试过这些建议（至少我记得最近没有），但我最近检查了很多 Qt 的事件管理源代码（当然，除了文档之外），所以我非常有信心他们工作。*

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2012-06-15T03:26:53.327

问题是`delete mPage;`。我必须`mPage->deleteLater(); emit getNext();`改用。deleteLater() 计划在程序下次返回主事件循环时删除对象。 `emit getNext();`连接到在 处恢复的插槽`mPage = new Page();`。它的连接类型是Qt::QueuedConnection，所以它会在调用slot之前让步给事件循环。我不确定为什么，但是您必须安排删除并像这样返回事件循环以正确关闭旧信号并设置新信号。

所以，这行得通，但如果有人能更详细地告诉我发生了什么，我会接受你的。谢谢。

# qt - 平面 QTreeView 项目 - 不嵌套

> ID：11043996
> 
> 赞同：8
> 
> 时间：2012-06-15T02:44:08.497
> 
> 标签：qt, pyqt

有谁知道是否有可能在展平 QTreeView/QTreeWidget 的同时仍然能够展开子项。

默认是什么：

```
- A
  -> A1
  -> A2
- B
  -> B2
+ C 
```

*`-`展开和`+`折叠*

我想要什么：

```
- A
  A1
  A2
- B
  B2
+ C 
```

全部崩溃

```
+ A
+ B
+ C 
```

`A, B, C`是根项。

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2012-06-17T11:06:58.820

```
MyTree -> setIndentation (0) ; 
```

# c++ - 打开目录功能

> ID：11043999
> 
> 赞同：0
> 
> 时间：2012-06-15T02:45:12.317
> 
> 标签：c++, string, c++builder

这是一个基本的理解概念相关的问题。

使用：Embarcadero C++ Builder

有什么区别：

```
opendir("C:\\XYZ") 
```

和

```
String file = "C:\\XYZ";
opendir(file); 
```

不是两个字符串吗？第一个有效，但 sexond 给了我错误：E2034 Cannot convert Unicode String to 'const char*'

在我从用户那里获取输入的情况下，我只能传递一个字符串。我如何通过整个路径？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-06-15T03:24:24.793

第一个是 a `const char*`，第二个是 std::string。该`opendir`函数仅`const char*`在您的情况下接受，因此无法自行`std::string`转换`const char*`。您可以通过`opendir(file.c_str());`.

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-06-15T03:25:01.563

不，String 不是 char 数组。opendir 需要一个 char 数组。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2014-03-09T08:44:11.573

`opendir()`期望 8 位窄`const char*`作为输入。当您将狭窄的文字传递给 时`opendir()`，您将传递给它 a `const char[]`，它隐式降级为`const char*`，一切都很好。

`String`is `System::String`，它是 的 typedef `System::UnicodeString`，它是 Embarcadero 的 UTF-16 编码字符串类（类似于`std::wstring`，但语义不同）。当你传递一个`String`to 时`opendir()`，你会得到一个转换错误。

要将`String`值传递给`opendir()`（或任何其他期望的函数`char*`），您需要先将其转换为 a `System::AnsiString`，然后用于`AnsiString::c_str()`从中获取 a `char*`，例如：

```
String file = "C:\\XYZ";
opendir(AnsiString(file).c_str()); 
```