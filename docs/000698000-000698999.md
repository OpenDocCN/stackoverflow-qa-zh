# StackOverflow 问答 000698000-000698999

# c# - 工厂班知道的太多

> ID：698000
> 
> 赞同：2
> 
> 时间：2009-03-30T16:40:30.037
> 
> 标签：c#, design-patterns, refactoring, factory

**已更新**我已更新示例以更好地说明我的问题。我意识到它遗漏了一个特定点 - 即该`CreateLabel()`方法总是采用标签类型，因此工厂可以决定创建哪种类型的标签。问题是，它可能需要获取更多或更少的信息，具体取决于它想要返回的标签类型。

我有一个工厂类，它返回代表要发送到打印机的标签的对象。

工厂类如下所示：

```
public class LargeLabel : ILabel
{
    public string TrackingReference { get; private set; }

    public LargeLabel(string trackingReference)
    {
        TrackingReference = trackingReference;
    }
}

public class SmallLabel : ILabel
{
    public string TrackingReference { get; private set; }

    public SmallLabel(string trackingReference)
    {
        TrackingReference = trackingReference;
    }
}

public class LabelFactory
{
    public ILabel CreateLabel(LabelType labelType, string trackingReference)
    {
        switch (labelType)
        {
            case LabelType.Small:
                return new SmallLabel(trackingReference);
            case LabelType.Large:
                return new LargeLabel(trackingReference);
        }
    }
} 
```

假设我创建了一个名为 CustomLabel 的新标签类型。我想从工厂退回这个，但它需要一些额外的数据：

```
public class CustomLabel : ILabel
{
    public string TrackingReference { get; private set; }
    public string CustomText { get; private set; }

    public CustomLabel(string trackingReference, string customText)
    {
        TrackingReference = trackingReference;
        CustomText = customText;
    }
} 
```

这意味着我的工厂方法必须改变：

```
public class LabelFactory
{
    public ILabel CreateLabel(LabelType labelType, string trackingReference, string customText)
    {
        switch (labelType)
        {
            case LabelType.Small:
                return new SmallLabel(trackingReference);
            case LabelType.Large:
                return new LargeLabel(trackingReference);
            case LabelType.Custom:
                return new CustomLabel(trackingReference, customText);
        }
    }
} 
```

我不喜欢这样，因为工厂现在需要满足最小公分母，但同时 CustomLabel 类*需要*获取自定义文本值。我可以提供额外的工厂方法作为替代，但我想强制执行 CustomLabel 需要该值的事实，否则它只会被赋予空字符串。

实现此方案的正确方法是什么？

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2009-03-30T16:45:28.480

那么，你想怎么*调用*工厂方法呢？

专注于你希望如何使用你的 API，实现通常会很清楚。如果您将 API 的所需结果编写为单元测试，这将变得更加容易。

过载可能是正确的做法，但这实际上取决于您希望如何使用工厂。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2009-03-30T17:39:00.287

仅仅使用工厂方法来决定你需要什么标签怎么样？

```
public class LabelFactory {
    public ILabel CreateLabel(string trackingReference, string customText) {
        return new CustomLabel(trackingReference, customText);
    }

    public ILabel CreateLabel(String trackingReference) {
        return new BasicLabel(trackingReference);
    }
} 
```

您的工厂仍然需要了解每种类型（尽管您可以通过接口实现动态加载），但客户端需要知道的很少 - 根据提供的数据，工厂生成正确的实现。

这是您描述的简单问题的简单解决方案。我认为这个问题是对更复杂问题的过度简化，但在不知道你真正的问题是什么的情况下，我宁愿不设计一个过于复杂的解决方案。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2009-03-30T16:44:37.640

这可能表明工厂模式不是最适合您的。但是，如果您确实需要或希望坚持使用它，我建议创建可以传递给工厂的初始化类/结构，而不是字符串。无论您是想使用基本信息类的各种子类（基本上创建一个模仿标签类的初始化类层次结构）还是一个包含所有信息的类都取决于您。

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2009-03-30T16:45:49.510

您应该尝试使用配置类并将其实例传递给工厂。配置类将构建一个层次结构，其中对于您期望从工厂获得的每个结果都存在一个特殊的配置类。每个配置类都捕获工厂结果的特定属性。

对于您给出的示例，我将编写一个 BasicLabelConfiguration 和一个从它派生的 CustomLabelConfiguration。BasicLabelConfiguration 捕获跟踪引用，而 CustomLabelConfiguration 捕获自定义文本。

最后工厂根据传递的配置对象的类型做出决定。

* * *

下面是代码示例：

```
public class BasicLabelConfiguration
{
  public BasicLabelConfiguration()
  {
  }

  public string TrackingReference { get; set; }
}

public class CustomLabelConfiguration : BasicLabelConfiguration
{
  public CustomLabelConfiguration()
  {
  }

  public string CustomText { get; set; }
}

public class LabelFactory
{
  public ILabel CreateLabel(BasicLabelConfiguration configuration)
  {
    // Possibly make decision from configuration
    CustomLabelConfiguration clc = configuration as CustomLabelConfiguration;
    if (clc != null)
    {
      return new CustomLabel(clc.TrackingReference, clc.CustomText);
    }
    else
    {
      return new BasicLabel(configuration.TrackingReference);
    }
  }
} 
```

最后你会像这样使用工厂：

```
// Create basic label
ILabel label = factory.CreateLabel(new BasicLabelConfiguration 
{
  TrackingReference = "the reference"
}); 
```

或者

```
// Create basic label
ILabel label = factory.CreateLabel(new CustomLabelConfiguration 
{
  TrackingReference = "the reference",
  CustomText = "The custom text"
}); 
```

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2009-03-30T17:27:50.250

如果没有更多信息，很难给出任何建议，但假设工厂模式是您真正需要的，您可以尝试以下方法：

将所需的参数打包到某种属性映射中（例如字符串到字符串的映射），并将其作为参数传递给工厂的 create 方法。使用众所周知的标签作为映射中的键，允许专业工厂根据自己的喜好提取和解释映射值。

这至少可以让您暂时维护一个单一的工厂接口，如果（或何时）您注意到工厂模式在这里不正确，则可以推迟处理架构问题。

（哦，如果您真的想在这里使用工厂模式，我强烈建议您将其设置为可插入的，以避免必须为每种新标签类型修改工厂）。

* * *

## 回答 #6

> 赞同：1
> 
> 时间：2009-03-30T17:55:14.070

您正试图将模式强加到它不适合的场景中。我建议放弃那个特定的模式和重点，而不是让最简单的解决方案成为可能。

我认为在这种情况下，我将只有一个类，标签，它有一个用于自定义文本的文本字段，该文本字段通常为空/空，但如果需要自定义标签，可以设置哪个。它很简单，不言自明，不会给您的维护程序员带来任何噩梦。

```
public class Label
{
    public Label(string trackingReference) : this(trackingReference, string.Empty)
    {
    }

    public Label(string trackingReference, string customText)
    {
        CustomText = customText;
    }

    public string CustomText ( get; private set; }

    public bool IsCustom
    {
        get
        {
            return !string.IsNullOrEmpty(CustomText);
        }
    }
} 
```

* * *

## 回答 #7

> 赞同：1
> 
> 时间：2009-04-01T22:03:56.033

**回答问题更新后的更新 - 见下文**

我仍然认为您使用工厂模式是正确的，并且正确地重载了​​ CreateLabel 方法；但我认为在将 LabelType 传递给 CreateLabel 方法时，您错过了使用工厂模式的要点。

要点：工厂模式的全部目的是封装选择要实例化和返回的具体子类的逻辑。调用代码不应该告诉工厂要实例化哪种类型。这样做的好处是，调用工厂的代码因此不受将来对该逻辑的更改，也不受向工厂添加新的具体子类的影响。您的所有调用代码需要依赖的是工厂，以及从 CreateLabel 返回的接口类型。

您调用工厂时代码中的逻辑当前必须类似于此伪代码...

```
// Need to create a label now
ILabel label;
if(we need to create a small label)
{
   label = factory.CreateLabel(LabelType.SmallLabel, "ref1");
}
else if(we need to create a large label)
{
   label = factory.CreateLabel(LabelType.LargeLabel, "ref1");
}
else if(we need to create a custom label)
{
   label = factory.CreateLabel(LabelType.CustomLabel, "ref1", "Custom text")
} 
```

...所以你明确告诉工厂要创建什么。这很糟糕，因为每次将新标签类型添加到系统时，您都需要...

1.  更改工厂代码以处理新的 LabelType 值
2.  去工厂调用的任何地方添加一个新的 else-if

但是，如果您将选择 LabelType 值的逻辑移到您的工厂中，则可以避免这种情况。逻辑与其他所有内容一起封装在工厂中。如果将新类型的标签添加到您的系统中，您只需更改出厂设置。所有调用工厂的现有代码保持不变，没有重大更改。

您当前的调用代码使用什么数据来决定是否需要大标签或小标签？那条数据应该传递给工厂的 CreateLabel() 方法。

您的工厂和标签类别可能如下所示...

```
// Unchanged
public class BasicLabel: ILabel
{
    public LabelSize Size {get; private set}
    public string TrackingReference { get; private set; }

    public SmallLabel(LabelSize size, string trackingReference)
    {
        Size = size;
        TrackingReference = trackingReference;
    }
}

// ADDED THE NULL OR EMPTY CHECK
public class CustomLabel : ILabel
{
    public string TrackingReference { get; private set; }
    public string CustomText { get; private set; }

    public CustomLabel(string trackingReference, string customText)
    {
        TrackingReference = trackingReference;
        if(customText.IsNullOrEmpty()){
           throw new SomeException();
        }
        CustomText = customText;
    }
}

public class LabelFactory
{
    public ILabel CreateLabel(string trackingReference, LabelSize labelSize)
    {
         return new BasicLabel(labelSize, trackingReference);
    }

    public ILabel CreateLabel(string trackingReference, string customText)
    {
         return new CustomLabel(trackingReference, customText);
    }
} 
```

我希望这是有帮助的。

* * *

## 回答 #8

> 赞同：0
> 
> 时间：2009-03-30T19:10:53.780

从阅读您的问题看来，您的 UI 会收集信息，然后使用工厂创建适当的标签。我们在我开发的 CAD/CAM 应用程序中使用了不同的方法。

在启动期间，我的应用程序使用工厂方法创建标签主列表。我的一些标签具有初始化参数，因为它们是彼此的变体。例如，我们有三种类型的扁平零件标签。而其他的具有用户定义的或在设置时未知的参数。

在第一种情况下，初始化是在工厂方法中处理的。因此，我创建了三个传入所需参数的 FlatPartLabel 实例。

在第二种情况下，标签接口有一个配置选项。这由标签打印机对话框调用以填充设置面板。在您的情况下，这是传入跟踪参考和 CustomText 的地方。

我的标签接口还为每个标签类型返回一个唯一的 ID。如果我有一个特定的命令来处理该类型的标签，那么我将遍历我的应用程序中的标签列表，找到与 ID 匹配的标签，将其转换为特定类型的标签，然后对其进行配置。当用户只想为特定的平面部分打印一个标签时，我们会这样做。

这样做意味着您可以对标签所需的参数进行任意复杂化，并且不会给工厂带来不必要的参数负担。

# html - 标签标签中的“for”是什么？

> ID：698001
> 
> 赞同：74
> 
> 时间：2009-03-30T16:40:38.400
> 
> 标签：html, forms, usability

`for`刚刚在 HTML 标签标签中遇到了一个参数：

```
<label for="required-firstname"> First Name </label>
<small>*</small>
<input name="required-firstname" type="text" tabindex="2" 
       id="required-firstname" size="24" maxlength="40"> 
```

我正在将此表单转换为 PHP 处理的脚本，我可以去掉 for= 参数吗？（出于好奇，它有什么作用？）

* * *

## 回答 #1

> 赞同：105
> 
> 时间：2009-03-30T16:42:37.770

来自 w3schools.org：

> 标签定义输入元素的标签。
> 
> label 元素不会为用户呈现任何特殊的东西。但是，它为鼠标用户提供了可用性改进，因为如果用户单击标签元素内的文本，它会切换控件。
> 
> 标签的 for 属性应该等于相关元素的 id 属性才能将它们绑定在一起。

！

将我的 $.02 添加为 Accessibility SME - 以及可用性，LABEL 还将输入字段与正确的标签相关联，因此使用屏幕阅读器的人将知道该字段的用途。

* * *

## 回答 #2

> 赞同：23
> 
> 时间：2009-03-30T16:44:57.297

HTML 标签标签定义表单元素的标签。它们通常与复选框和单选按钮一起使用，当用户单击标签时，它会切换按钮。使用文本输入（您必须检查以确保）我认为它只会在用户单击标签时将焦点放在输入上。

* * *

## 回答 #3

> 赞同：9
> 
> 时间：2009-03-30T16:45:51.677

它指定标签绑定到哪个元素。在您的示例代码中，标签用于**required** *-firstname*输入字段。如果用户单击该标签，焦点将转到绑定的输入字段。这是一个可用性改进，我认为你最好保持原样。这是一个很好的做法。

* * *

## 回答 #4

> 赞同：8
> 
> 时间：2014-01-21T15:33:42.610

“for”属性是表单可访问性的必要元素。不要省略它。对于使用屏幕阅读器 (SR) 向他们宣布网页的用户，“for”属性将控件与标签相关联。通常，SR 用户将在表单中从一个控件（SR 的可聚焦元素）切换到下一个控件。如果没有“for”属性，SR 用户将不得不更改 SR 上的模式并围绕表单进行探测以尝试确定哪个控件与哪个标签匹配，这可能既耗时又令人困惑。“for”属性也可用于与运动问题相关的辅助技术。

WebAIM.org 有一个很棒的页面来解释“for”的可访问性后果：[http ://webaim.org/techniques/forms/controls](http://webaim.org/techniques/forms/controls)

* * *

## 回答 #5

> 赞同：6
> 
> 时间：2009-03-30T16:42:26.943

它将标签与表单元素 id 联系起来。某些表单元素，例如复选框，可以通过单击其标签来激活。

* * *

## 回答 #6

> 赞同：3
> 
> 时间：2009-03-30T16:43:08.707

在某些浏览器中，当您单击 for 标记中的文本时，您会选中与之关联的框（即 for = id）或将焦点放在该框上。这是 ADA 的事情

# asp.net - 回发后如何重置 asp.net 表单？

> ID：698010
> 
> 赞同：5
> 
> 时间：2009-03-30T16:41:51.033
> 
> 标签：asp.net, forms

我正在尝试在 btnCreate_OnClick 事件之后将表单重置为默认值，就像第一个 page_load 一样。问题是在 PostBack、每个文本框和其他控件重新加载 ViewState 值之后。由于 DropDownList 选择上的服务器事件，我无法停用视图状态。到目前为止，我发现的唯一方法是在单击事件后重定向到自身，但这会加载页面两次，因此是一个糟糕的解决方案。我尝试了 ViewState.Clear() 并更新了 UpdatePanel，但没有成功。

我可以为所有控件做一个循环并设置 txtXXXXXX.Text == ""，但我很确定这不是最好的主意。

Page.Reset() 之类的东西本来就很完美，但它不存在。

对我的这个问题有什么想法吗？

谢谢

* * *

## 回答 #1

> 赞同：12
> 
> 时间：2009-03-30T16:49:01.873

如果可行，我通常只使用 Response.Redirect 从头开始​​重新加载同一页面。

无论如何，对页面的初始 GET 请求通常比后续 POST 花费更少，因此没有太多理由避免它。

* * *

## 回答 #2

> 赞同：6
> 
> 时间：2009-03-31T06:04:48.123

我们只需 2 行代码就可以重置 ASP.NET 表单页面

```
protected void Button_Reset_Click(object sender, EventArgs e)
{
     Session["ViewState"] = null;
     Response.Redirect("/Roster/DRAC/Create.aspx");
} 
```

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2009-03-30T16:51:15.330

由于视图状态，自我重定向变得棘手。

按钮有一个 html 输入类型“重置”，但我不确定 msft 为此在 viewstate/asp.net 中添加了什么或任何集成。它通常适用于简单的 javascript 表单。

前任：

`<input type="button" value="Reset" onclick="document.<formId>.reset();">`

来自谷歌----^

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2009-03-30T16:46:57.043

一种不一定理想的方法是使用 Javascript 将值重置为其默认值。如果它是一个大表单，它可能会很丑，但会阻止进行自我重定向的需要。

您也可以尝试使用 Server.Transfer 而不是 Response.Redirect(/ *self* /)

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2013-06-04T22:37:42.220

我不知道这是否有帮助，但我更改了表单上每个输入的名称，我想在提交表单之前使用 javascript 获取新值，因为 .net 页面无法再将表单中的值与控件匹配它重新加载它们的页面，就好像没有回发一样。我还向表单附加了一个新值，因此我知道哪个按钮提交了表单并使用该逻辑来决定将什么加载到所有控件中以及如何处理表单数据。

```
$("#Bset").children().click(function() { //all the btns click function
    $.each($("form").find("input"), function(e,v) { //could filter this to subset of inputs
        $(v).attr("name", "_" + $(v).attr("name")); // ctrl1 becomes _cntrl1
    });
    $("form").append("<input type='hidden' id='b' name='b' value='" + $(this).text() + "' />").submit();
}); 
```

然后在后面的代码中

```
protected void Page_Init(object sender, EventArgs e)
{
    id = int.Parse(Request.QueryString["id"]);
    bk = db.dc.getDetailBK(id).Single();
    if (Request.Form.Count > 0)
        doPostBack();
    mrl = (from a in db.dc.getMetricQTD(id, null, null, loadSavedGoals) select a).ToList();
} 
```

然后，我可以在 dopostback 中处理表单数据、与数据库交互等，这可能会更改加载 mrl 的值并刷新与 mrl 相关的输入中的数据，无论它们是否在表单上进行了修改。

另一种选择是绑定一些按钮以使用 Web 服务来处理您的数据库交互，然后调用 window.location 来刷新页面。

$.ajax({
url: "webservice/dbfunction?"
data: {which btn press, some form values etc...}
success: function() {window.location("samepage.aspx?id=xxx");}
...
});

这也将避免必须在服务器端响应重定向。

* * *

## 回答 #6

> 赞同：-3
> 
> 时间：2009-03-30T18:23:52.893

在我们的例子中，最佳性能解决方案是为每个控件手动设置点击事件中的默认值，例如：

```
textbox1.Text = null;
textbox2.Text = null; 
```

这避免了双 page_load 和循环。我们不必更新 UpdatePanel，因为它在渲染之前执行。

也许在更复杂的 Web 应用程序中，我们将不得不重定向，因为大多数人似乎都接受这是一种解决方案。

为每个控件设置默认值更适合我们的情况。

谢谢

# c++ - 字符串比较在 Visual C++ 2005 中不起作用

> ID：698011
> 
> 赞同：0
> 
> 时间：2009-03-30T16:41:53.997
> 
> 标签：c++, visual-studio, visual-c++, visual-c++-2005, strcmp

如果从注册表中得到一个 gring 并且当我将它放在消息框中时它会正确显示。::MessageBoxW(0, (LPCWSTR)achValue, _T("找到"), MB_YESNO);

该值存储在 archValue 中，它是一个 DWORD。我想要做的是将它与以下字符串“2.0.7045.0”进行比较，但 strcmp 无法为我工作。

任何关于如何做到这一点的想法都将不胜感激。在 c++ 中相当垃圾，我无法像在 dll 中那样轻松调试。

非常感激

托尼

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-03-30T16:47:34.357

您需要使用 strcmp 的宽字符版本：[wcscmp](http://msdn.microsoft.com/en-us/library/e0z9k731(VS.80).aspx)。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-03-30T16:49:41.637

这个问题令人困惑；您在从注册表获取数据或执行 strcmp 时遇到问题？

你从注册表中得到一个 DWORD (???) 应该类似于 "2.0.7045.0" ？您不确定它不是字符串 (REG_SZ) 吗？

如果您可以从注册表中获取字符串，则应该可以进行字符串比较；请记住，如果字符串相等，strcmp（或其他类似的函数/方法）将返回 0（零）。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-03-30T16:49:48.690

你有地狱般的弦乐混合。

`MessageBoxW`- 适用于 unicode 字符串。
`_T("Found")`- 如果需要，添加 unicode 说明符的宏（来自项目设置中的定义）。
`LPCWSTR`- Unicode 字符串 ( `const wchar_t*`)。
`strcmp`- 比较非 unicode 字符串。

您应该使用所有功能中的一种。w 或 t 或非 unicode 字符串。

# c# - Office（尤其是 Outlook）插件

> ID：698012
> 
> 赞同：0
> 
> 时间：2009-03-30T16:42:22.967
> 
> 标签：c#, outlook, ms-office, vsto, add-in

我们想为outlook、word和excel开发插件。截至目前，我知道两种类型的解决方案。一种用于共享插件（基于 COM），另一种用于构建基于 VSTO 的插件。由于我是新手，这将是更好的选择？（或者如果有第三种方式，请告诉我）我们的目标是 Office 2003 和 2007。我更喜欢用 C# 开发这个插件。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2009-03-30T17:10:30.450

不是直接回答您的问题，但在开始加载项开发之前也值得考虑：正如 Reed 所说，使用 VB.Net 开发 Office 加载项将比使用 C# 轻松得多。

对 Office 对象模型的调用通常会遗漏几个可选参数。但是，在 C# 中——因为 C#（还）没有可选参数——你必须指定每个可选参数。还不够，对于 COM 插件，您还必须自己处理参数的装箱，即，您必须先将其转换为引用类型，而不是传递简单的 bool 或 int。所有这些都使代码变得非常不可读。

例如，在 Word 中打开文档的代码与 C# 中的代码类似：

```
object objTrue = true;
object objFalse = false;
object missing = Type.Missing;
object objInputFile = strInputFile;
Document document = WordApplication.Documents.Open(ref objInputFile, 
    ref objFalse, ref objTrue, ref objFalse, ref missing, ref missing, 
    ref missing, ref missing, ref missing, ref missing, ref missing, 
    ref objFalse, ref missing, ref missing, ref objTrue, ref missing); 
```

而在 VB.Net 中同样会更容易读写：

```
Document document = WordApplication.Documents.Open(strInputFile) 
```

[（附加信息：在 C# 4.0 中，使用dynamic](http://blogs.msdn.com/cburrows/archive/2008/10/27/c-dynamic.aspx)会变得更简单）

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2009-03-30T16:55:53.043

如果您打算使用 C# 进行开发，我强烈建议您坚持使用 VSTO。这有一个更简单的添加开发框架，并且与 C# 完美配合。

走 COM 路线，尤其是使用 C#，只是增加了额外的痛苦，这在这一点上是不必要的。

# html - 将 HTML 片段插入 WPF FlowDocument

> ID：698026
> 
> 赞同：13
> 
> 时间：2009-03-30T16:44:40.403
> 
> 标签：html, wpf, xaml, flowdocument

我正在从数据源动态构建 WPF FlowDocument。其中一个数据元素是 HTML 的片段——我需要找出一种方法来解析它并将其插入到我的 FlowDocument 中。

我找到[了 HTMLToXAMLConverter](http://blogs.msdn.com/wpfsdk/archive/2006/05/25/606317.aspx)，它将返回 HTML 的 XAML 表示，但我仍然不确定如何最好地实例化该 XAML 片段，以便我可以将它插入到我的 FlowDocument 中。

* * *

## 回答 #1

> 赞同：15
> 
> 时间：2009-03-30T16:55:21.203

回答了我自己的问题...

```
System.Windows.Markup.XamlReader.Parse() 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-04-02T15:28:26.407

有同样的问题，但也必须解决数据绑定问题

有一个从字符串创建 XAML 的对流器，反之亦然。

# c# - 使用 C# (httpwebrequest) 向外部站点调用 POST

> ID：698029
> 
> 赞同：-1
> 
> 时间：2009-03-30T16:45:23.787
> 
> 标签：c#, post, httpwebrequest

这让我发疯，我不知道我在哪里丢球。我已经按照通过 googlemonsta 找到的一些示例进行了操作，但均无济于事。任何指向我犯错的地方都会受到极大的关注。

```
 var writer = new StringWriter();
        param = "location=" + Server.UrlEncode(param);
        byte[] paramStream = Encoding.ASCII.GetBytes(param + "&param2=value");
        var URL = "http://www.somesite.com";
        HttpWebRequest request = (HttpWebRequest)WebRequest.Create(URL);
        request.Method = "POST";
        request.ContentType = "application/x-www-form-urlencoded";
        request.UserAgent = "Mozilla/5.0 (Windows; U; Windows NT 6.0; sv-SE; rv:1.9.1b2) Gecko/20081201 Firefox/3.1b2";
        request.ContentLength = paramStream.Length;
        using( var stream = request.GetRequestStream())
        {
            stream.Write(paramStream, 0, paramStream.Length);
        }

        var response = request.GetResponse();

        string result;
        using (var sr = new StreamReader(response.GetResponseStream()))
        {
            result = sr.ReadToEnd();
        } 
```

谢谢！

**编辑：**据我所知，它击中了网站（我正在返回 html），但参数并没有被推倒。如果它成功了，我基本上得到了价值出现的地方。我试过删除第一个 & 但没有得到任何地方。

**编辑：**编辑代码以反映更改。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2009-03-30T16:48:08.443

可能从第一个参数的开头摆脱 & ？除此之外，它基本上看起来还可以。（检查您的真实代码中的参数名称 - 您在示例中拥有“参数”，它几乎肯定应该是“参数” - 但我们不知道您的真实代码是什么样子或真实网站期望什么。）

请提供有关实际情况的更多信息。我们知道它不起作用，但是有很多不同的可能的故障模式:)

出现了一个额外的想法 - 您没有指定内容长度。我不确定这是否由`WebRequest`. 值得使用[WireShark](http://wireshark.org)检查它是否存在于出站请求中。

作为一般实践点，您应该处理 ，如果您已经获得了响应流的声明，则`WebResponse`无需调用：`Close``using`

```
string result;
using (WebResponse response = request.GetResponse())
{
    using (var sr = new StreamReader(response.GetResponseStream()))
    {
        result = sr.ReadToEnd();
    }
} 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-03-30T17:09:34.757

您确定您拥有该职位所需的所有价值观吗？我曾经有一个案例，表单上有一个隐藏的输入字段，类似于：

```
<input name="action" type="hidden" id="action" value="login"> 
```

我必须将其作为参数提供：

```
&action=login 
```

确保您没有遗漏表格中的任何内容，这就是我所说的...

**编辑：**还有一件事：我刚刚再次查看了我的代码，并注意到我在那里也有这一行：

```
request.ContentLength = bytes.Length; 
```

不确定您是否需要，但我注意到您没有设置长度。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-03-30T18:04:01.367

这不是参数后的回车/换行那么简单吗？查看互联网上有关 HTTP 的一些文档，之后您显然需要一个空行。

（我建议手动远程登录到 Web 服务器并粘贴您的请求。）

# windows - Windows 递归 grep 命令行

> ID：698038
> 
> 赞同：225
> 
> 时间：2009-03-30T16:46:14.970
> 
> 标签：windows, command-line, grep

我需要在 Windows 中执行递归 grep，在 Unix/Linux 中是这样的：

```
grep -i 'string' `find . -print` 
```

或更首选的方法：

```
find . -print | xargs grep -i 'string' 
```

我只使用 cmd.exe，所以我只有 Windows 内置命令。不幸的是，我无法在此服务器上安装[Cygwin或](http://en.wikipedia.org/wiki/Cygwin)[UnxUtils](http://en.wikipedia.org/wiki/UnxUtils)等任何 3rd 方工具。我什至不确定我是否可以安装 PowerShell。仅使用 cmd.exe 内置程序（Windows 2003 Server）有什么建议吗？

* * *

## 回答 #1

> 赞同：272
> 
> 时间：2009-03-30T16:50:47.813

`findstr`可以进行递归搜索 (/S) 并支持一些正则表达式语法 (/R) 的变体。

```
C:\>findstr /?
Searches for strings in files.

FINDSTR [/B] [/E] [/L] [/R] [/S] [/I] [/X] [/V] [/N] [/M] [/O] [/P] [/F:file]
        [/C:string] [/G:file] [/D:dir list] [/A:color attributes] [/OFF[LINE]]
        strings [[drive:][path]filename[ ...]]

  /B         Matches pattern if at the beginning of a line.
  /E         Matches pattern if at the end of a line.
  /L         Uses search strings literally.
  /R         Uses search strings as regular expressions.
  /S         Searches for matching files in the current directory and all
             subdirectories.
  /I         Specifies that the search is not to be case-sensitive.
  /X         Prints lines that match exactly.
  /V         Prints only lines that do not contain a match.
  /N         Prints the line number before each line that matches.
  /M         Prints only the filename if a file contains a match.
  /O         Prints character offset before each matching line.
  /P         Skip files with non-printable characters.
  /OFF[LINE] Do not skip files with offline attribute set.
  /A:attr    Specifies color attribute with two hex digits. See "color /?"
  /F:file    Reads file list from the specified file(/ stands for console).
  /C:string  Uses specified string as a literal search string.
  /G:file    Gets search strings from the specified file(/ stands for console).
  /D:dir     Search a semicolon delimited list of directories
  strings    Text to be searched for.
  [drive:][path]filename
             Specifies a file or files to search.

Use spaces to separate multiple search strings unless the argument is prefixed
with /C.  For example, 'FINDSTR "hello there" x.y' searches for "hello" or
"there" in file x.y.  'FINDSTR /C:"hello there" x.y' searches for
"hello there" in file x.y.

Regular expression quick reference:
  .        Wildcard: any character
  *        Repeat: zero or more occurrences of previous character or class
  ^        Line position: beginning of line
  $        Line position: end of line
  [class]  Character class: any one character in set
  [^class] Inverse class: any one character not in set
  [x-y]    Range: any characters within the specified range
  \x       Escape: literal use of metacharacter x
  \<xyz    Word position: beginning of word
  xyz\>    Word position: end of word

For full information on FINDSTR regular expressions refer to the online Command
Reference. 
```

* * *

## 回答 #2

> 赞同：156
> 
> 时间：2009-03-30T22:26:18.863

```
findstr /spin /c:"string" [files] 
```

参数含义如下：

*   `s`= 递归
*   `p`= 跳过不可打印的字符
*   `i`= 不区分大小写
*   `n`= 打印行号

并且要搜索的字符串是您在引号中加上的位`/c:`

* * *

## 回答 #3

> 赞同：35
> 
> 时间：2015-08-05T19:24:54.790

我刚刚使用以下命令搜索了一个文本，该命令列出了包含我指定的“搜索文本”的所有文件名。

```
C:\Users\ak47\Desktop\trunk>findstr /S /I /M /C:"search text" *.* 
```

* * *

## 回答 #4

> 赞同：21
> 
> 时间：2017-03-10T16:42:01.083

递归搜索文件夹`import`内的单词：`src`

```
> findstr /s import .\src\* 
```

* * *

## 回答 #5

> 赞同：15
> 
> 时间：2011-05-13T10:17:58.237

我推荐一个非常棒的工具：

本机 Unix 实用程序：

*   [http://unxutils.sourceforge.net/](http://unxutils.sourceforge.net/)
*   [http://en.wikipedia.org/wiki/UnxUtils](http://en.wikipedia.org/wiki/UnxUtils)

只需解压缩它们并将该文件夹放入您的 PATH 环境变量中，瞧！:)

像魅力一样工作，还有更多不仅仅是 grep ;)

* * *

## 回答 #6

> 赞同：12
> 
> 时间：2013-03-14T08:52:42.343

```
for /f %G in ('dir *.cpp *.h /s/b') do  ( find /i "what you search"  "%G") >> out_file.txt 
```

* * *

## 回答 #7

> 赞同：9
> 
> 时间：2016-03-31T03:18:24.870

`Select-String`最适合我。此处列出的所有其他选项，例如`findstr`，不适用于大文件。

这是一个例子：

```
select-string -pattern "<pattern>" -path "<path>" 
```

**注意**：这需要 Powershell

* * *

## 回答 #8

> 赞同：6
> 
> 时间：2009-05-09T03:53:00.303

如果您安装了 Perl，您可以使用**ack**，可从[http://beyondgrep.com/](http://beyondgrep.com/)获得。

# c++ - 寻找免费的 c++ 跨平台 GUI 框架

> ID：698043
> 
> 赞同：-3
> 
> 时间：2009-03-30T16:47:36.510
> 
> 标签：c++, user-interface, cross-platform

我正在为商业项目寻找免费的跨平台 GUI（这意味着我不能提供代码）没有 GPL，我猜没有 LGPL 它还留给我什么？wxWidgets ? 谢谢

* * *

## 回答 #1

> 赞同：10
> 
> 时间：2009-03-30T16:53:19.150

如果您想避免 LGPL，[wxWidgets](http://www.wxwidgets.org/)可能是功能最完整的选项。它使用 LGPL 的衍生物，在分发上更加灵活。

但是，LGPL 适用于商业作品。唯一的限制是您需要与 UI 库动态链接，这通常根本不是问题。

使用 LGPL，您有许多其他选择，包括 GTK、QT（从 4.5 开始）、FLTK 等。其中，QT 可能是我个人的最爱。

* * *

## 回答 #2

> 赞同：5
> 
> 时间：2009-03-30T16:51:56.313

您可以发布链接到 LGPL 许可库的闭源应用程序。

# sql - 选择第一个和最后一个元素的最有效方法，SQLite？

> ID：698047
> 
> 赞同：6
> 
> 时间：2009-03-30T16:48:56.040
> 
> 标签：sql, sqlite, select

从 SQLite 的列中仅选择第一个和最后一个元素的最有效方法是什么？

* * *

## 回答 #1

> 赞同：17
> 
> 时间：2009-03-30T16:52:29.680

*一行*中的第一个和最后一个元素？

```
SELECT column1, columnN
FROM mytable; 
```

我认为您必须指*列*中的第一个和最后一个元素：

```
SELECT MIN(column1) AS First,
       MAX(column1) AS Last
FROM mytable; 
```

* * *

参见[http://www.sqlite.org/lang_aggfunc.html](http://www.sqlite.org/lang_aggfunc.html)`MIN()`和`MAX()`。_

我使用`First`and`Last`作为列别名。

* * *

## 回答 #2

> 赞同：6
> 
> 时间：2009-03-30T17:09:39.343

如果它只是一列：

```
SELECT min(column) as first, max(column) as last FROM table 
```

如果要选择整行：

```
SELECT 'first',* FROM table ORDER BY column DESC LIMIT 1
UNION 
SELECT 'last',* FROM table ORDER BY column ASC LIMIT 1 
```

* * *

## 回答 #3

> 赞同：3
> 
> 时间：2009-03-30T16:54:16.790

最有效的方法是知道这些字段的名称并简单地选择它们。

```
SELECT `first_field`, `last_field` FROM `table`; 
```

* * *

## 回答 #4

> 赞同：2
> 
> 时间：2009-03-30T16:50:38.470

大概是这样的：

```
SELECT dbo.Table.FirstCol, dbo.Table.LastCol FROM Table 
```

通过指定表名和模式，您可以获得较小的效率增强。

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2013-06-26T12:09:20.763

min()/max() 方法是错误的。只有当值只是升序时，它才是正确的。对于随机上升和下降的汇率，我需要类似的东西。

这是我的解决方案：

```
select st.*
from stats_ticker st,
    (
        select min(rowid) as first, max(rowid) as last --here is magic part 1
        from stats_ticker
        -- next line is just a filter I need in my case. 
        -- if you want first/last of the whole table leave it out.
        where timeutc between datetime('now', '-1 days') and datetime('now')
        ) firstlast
WHERE 
    st.rowid = firstlast.first     --and these two rows do magic part 2
    OR st.rowid = firstlast.last
ORDER BY st.rowid; 
```

**魔术第 1 部分：**子选择产生单行，其中列在前，最后包含 rowid。

**魔术第 2 部分**易于过滤这两个 rowid。

这是迄今为止我提出的最佳解决方案。希望你喜欢。

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2016-06-24T13:29:48.407

我们可以在函数的帮助下做到这一点`Sql Aggregate`，比如`Max`和`Min`。这是两个聚合函数，可帮助您从数据表中获取最后一个元素和第一个元素。

```
Select max (column_name ), min(column name) from table name 
```

`Max` 会给你最大值意味着最后一个值，`min`会给你最小值意味着它会给你来自特定表的第一个值。

* * *

## 回答 #7

> 赞同：0
> 
> 时间：2019-07-26T11:23:25.460

首先：文本列上的 MIN() 和 MAX() 给出 AAAA 和 TTTT 结果，它们不是我的测试表中的第一个和最后一个条目。它们是前面提到的最小值和最大值。

我在有超过 9400 万条记录的表上尝试了这个（使用**.stats on ）：**

```
select * from
     (select col1 from mitable limit 1)
union 
select * from 
     (select col1 from mitable limit 1 offset
                             (select count(0) from mitable) -1); 
```

但它使用了很多虚拟机步骤（281,624,718）。

然后这更简单（如果表是在没有**WITHOUT ROWID**创建的情况下工作的）[sql关键字大写]：

```
SELECT col1 FROM mitable
WHERE ROWID = (SELECT MIN(ROWID) FROM mitable) 
   OR ROWID = (SELECT MAX(ROWID) FROM mitable); 
```

在同一张桌子上运行了 55 个虚拟机步骤并产生了相同的答案。

# agile - Best Software Engineering Practice for Student Project Team?

> ID：698053
> 
> 赞同：4
> 
> 时间：2009-03-30T16:49:57.347
> 
> 标签：agile

I've been reading about the various forms and aspects of agile development, but all focused on the corporate environment. I am on a student project team at my university, and I'd like to see if some agile concepts could work in an environment other than 'everyone works full/part time'.

We do have our own project server, with Subversion for version control, and Sharepoint for documents, wiki, and action items.

Some challenges

*   It's hard enough to arrange a weekly meeting, daily standups are infeasable
*   We're our own customers for the most part (we're part of a competition, but we can't work closely with the organizers)
*   Not just programmers, also mechanical/electrical team members
*   Sharepoint's action items don't have the best interface. Are there any extensions available? Would it make sense to switch to something else (like Trac) at the expense of a unified interface for everything non-svn?
*   Procrastination. As students, the most natural thing to do is wait to the last minute
*   We have our own space, but often, it's easier to do work elsewhere, and there's no way to predict if anyone else will be there except by making explicit arrangements
*   Other classes (still have to pass them, so total commitment to the team is limited)

Perhaps our team could benefit from more than just agile techniques, so all suggestions are welcome.

**EDIT** Thanks for all the great answers. I'm going to start asking my teammates how they feel about some of these ideas, and see what they buy into. Should I link them to this question? You can edit your answer or just leave a comment to answer this secondary question.

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2009-03-30T17:10:30.387

I wouldn't try to force a full, corporate environment style Agile programming workflow onto your team, but I do think that some level of Agile methodology could be valuable. I actually think that some of your "challenges" would be mitigated somewhat by some of the Agile ideas, but would require some level of commitment from every one on the team.

For example - the daily standups/weekly meetings issue.

This doesn't have to be a large thing (and, especially in a student project case, I'd say making it smaller is better). Having a Trac site (which I'd recommend over sharepoint if you're using SVN already) with a single place (like a wiki page) to just track the standup info in one sentence can still be valuable, without taking more than 1-2 minutes per day / person.

If somebody misses a day or two here and there, it's not a big deal, but if the team agrees to doing this, it can actually help the procrastination issue (forcing people to just say "I did nothing. I'm doing nothing" has a benefit - it keeps people at least thinking about your project, which tends to reduce the amount of procrastination), as well as having people work in different locations but still stay in communication.

This is also easy enough for non-programmers to do, and can help keep the mechanical and electrical teams working together, and everybody moving forward.

That being said, I'd make sure to keep it short and sweet - Try to keep the burden to a minimum, but I still think there's value in some of the Agile programming ideas, even in a student setting.

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2009-03-30T16:58:30.027

If you ask me you're adding too much overhead to your student project. Methodologies are generally only used in corporate environments because of the need to monitor and control human resources (control isn't the right word - but I needed one stronger than co-ordinate). In a group of students, there's absolutely no need to bother with anything like that. Adhering to a methodology will only slow you down.

You have identified your challenges. Make your peers aware of them and talk about how best to deal with them. Use methodologies as a source of ideas, but don't bend to one in your situation.

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2009-03-30T17:17:47.700

You can do a weekly or bi-weekly meeting that simulate a daily. Start your meeting with the three questions:

*   What did you accomplish since thelast time we met?
*   What do you plan to do until next time?
*   Is there anything blocking your progress?

Note that these can also be answered by your non-programmer teammate. In the company I work for, we have multidisciplinary team using scrum (programmer and artists) and it's working well.

If you don't want to do your meeting standing up, at least don't go for comfortable sofas. This should make your meeting shorter by making people more attentive.

You should use the method to your advantage and minimize procrastination by making interim milestones. Build your task list (excel, any other spreadsheet software is fine). Split them in milestone. When comes the time to review, sit with your team and look at your product like a client do, maybe involve your teacher.

Poker planning is fun, and a nice way to clarify your what you have to do, and how you plan on doing it. Breaking down objectives into tasks will involve people from all disciplines. But only people that can do the task should evaluate it.

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2009-03-30T16:54:39.240

IMO, SharePoint and agile don't really mix well. Pick something that's more "throw-it-up-there". I'd go with something like **[Trac](http://trac.edgewall.org/)**, which has great Subversion integration.

It sounds like communication and procrastination is going to be your biggest challenge. If you don't give yourself enough time to do the work and do good testing, you're not going to have a good result. This is only logical, and doesn't really have anything to do with whether you're agile or not.

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2009-03-30T17:33:10.830

In your situation, not all of the [Principles behind the Agile Manifesto](http://agilemanifesto.org/principles.html) will be easy to apply You might be able to apply some ideas that come from the principles, specifically:

1.  short iterations at the end of which you always have a "working" project, even if some desired features have not been implemented yet.
2.  maximize the amount of work *not* done - rather than designing a grand framework that you hope will cover all the needs of the project, start small and do just what is needed as you go.
3.  If you have milestones during your project, consider having a meeting (called a retrospective) after each milestone just to look back and see how your process worked / didn't work and how you might improve it.

On the software parts, you could consider [TDD](http://en.wikipedia.org/wiki/Test-driven_development) and [pair programming](http://en.wikipedia.org/wiki/Pair_programming)

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2009-03-31T03:38:15.837

I would say go with SCRUM. Skip the daily meetings and instead make a private forum and require each member to check it at least once a day. Try to make your sprint retrospective and planning meetings an "in-person" event over drinks or coffee.

The whole who is doing (and has done) aspect of SCRUM is amazing once everyone gets used to doing it. The 'sprint release' concept also helps team members from 'going dark' for too long and keeps the project based in reality ("What can we do in two weeks" vs. "I have this idea I am going to start and who knows when I can finish it").

Also, if your team has more then 8 people, skip SCRUM =)

Lastly, if you have the talent and someone on your team has the means (and desire), consider TFS workgroup (I *think* it comes free with academic MSDNs). If you don't have someone on your team who REALLY wants to take on that burden, skip it tho.

* * *

## 回答 #7

> 赞同：0
> 
> 时间：2009-04-02T17:06:56.810

When I was in college, I took several courses that encouraged the adoption and use of Agile practices. They were mostly a mess and although I learned a lot of from them they generally weren't the things the professor was expecting us to learn. I do agile development professionally now and love it, but here are the things I wish that I had known when I was doing agile in school:

*   Getting things squared with your schedule is really, really hard, which makes daily standups more important, not less. If you can't sit in the same room (very hard) then use Twitter or Yammer or just email.

*   A lot of Agile's benefit is simply in getting you into a rhythm. That doesn't just mean weekly meetings; it means set goals, commitment to points, and weekly deliverables. This is tough to pull off in an academic context but should go a way towards helping you with your procrastination problem.

*   It's tough to get used to pairing; everyone has their own computer and style of development. Try to hook a second keyboard/monitor/mouse up to your existing laptops if possible, or use screen sharing software, and standardize on an IDE. Pairing also really, really helps with procrastination but trying to do it without good tools is an awful lot of trouble.

*   Don't skimp on unit testing, even if you think of it as a silly, academic, one-off project. I've done projects before that I figured were too small to bother with testing and it's never failed to come back and bite me on the ass.

*   Sharepoint might be a bit heavyweight. Believe it or not, we still do an awful lot of things on whiteboards or with index cards. You may be your own customer but that doesn't mean you can't have stories (discrete, estimable features, basically) and goals. It's helpful to be able to visualize it: these features are planned, these are in development, these are ready for testing. If you'd like software recommendations I can give you those but I do recommend simple paper for a lot of the planning process.

# svn - 我怎样才能（真正）使用 MSBuild 运行 AfterPublish

> ID：698055
> 
> 赞同：2
> 
> 时间：2009-03-30T16:50:10.653
> 
> 标签：svn, shell, msbuild, clickonce, csproj

在 ClickOnce 发布后，我需要退出（在我的 .application 文件上调用 svn commit）。但是，我无法找到将其挂接到我的 MSBuild .csproj 文件的方法。

*   PostBuild 事件为时过早
*   并且在 PostBuild 中调用“ ***start Some.exe*** ”不会在后台运行
*   并且在部署文件***之前***使用 MSBuild 中的 AfterBuild 目标。

**当！**

我使用了非常酷的[MSBuild SideKick](http://www.attrice.info/msbuild/)来检查我的 .csproj 文件，当我从 SideKick 内部运行时，AfterBuild 目标实际上是在构建之后发生的。然而；我的外壳失败了，无论如何我更喜欢在 IDE 内部工作。

有没有人在这方面有任何智慧的珍珠？

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2009-05-22T04:46:05.700

您是否尝试过创建**AfterPublish**目标？您应该在 .csproj 文件中创建此目标之后**陈述。**

 **赛义德·易卜拉欣·哈希米

我的书：[Microsoft Build Engine 内部：使用 MSBuild 和 Team Foundation Build](https://rads.stackoverflow.com/amzn/click/com/0735626286)

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-04-01T15:51:41.373

我们已经使用该任务在构建中的不同点进行脱壳。这会为您生成一个新的 cmd.exe 实例。我用它在后台生成 PowerShell 脚本。这很好，因为您可以使用 PowerShell 做很多事情，只需确保使用标准输出，以便 PS 日志显示在您的团队构建中。

# csv - CSVDE 导出文件的列顺序错误？

> ID：698081
> 
> 赞同：3
> 
> 时间：2009-03-30T16:56:48.470
> 
> 标签：csv

我正在使用 CSVDE 将活动目录中的数据导出到 CSV 文件中，然后将其导入数据库。我正在使用 -l 开关来指定要导出的列，但它们的输出顺序不一致。是否有不涉及在 Excel 中打开文件的解决方法？这是一个夜间批处理过程，我们希望它在无人值守的情况下运行。

谢谢！

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-06-07T14:05:29.423

如果您只是想要一个可以重新排序 CSV 的命令行实用程序（并且还可以做很多其他事情），请查看我的 FOSS CSV 流编辑器[CSVfix](http://code.google.com/p/csvfix/)。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-03-30T18:01:59.593

根据文档：

> LDAP 可以按任何顺序返回属性，并且 csvde 不会尝试对列强加任何顺序。

如何编写一个 python 脚本来读取重新排序 csv 文件？您可能会发现[python csv 模块](http://docs.python.org/library/csv.html)对此很有用。

# objective-c - 使用 Objective-C 将值从一个对象传递到另一个对象

> ID：698083
> 
> 赞同：1
> 
> 时间：2009-03-30T16:57:28.750
> 
> 标签：objective-c, cocoa, cocoa-touch, cocos2d-iphone

我有一个名为 GameScene 的类，它是 cocos2d 场景的子类。

在那里我有两层。GameLayer 和 ControlsLayer。您可能已经知道我希望 ControlsLayer 在 GameLayer 中移动内容。准确地说，我试图从 ControlsLayer 控制 GameLayer 中的 cPBody。

目前，我正在尝试将来自 ControlsLayer 的指令路由到 GameScene 中，然后再返回到 GameLayer。如果这是有道理的。无论如何，我无法让它工作。我有 PHP 背景，所以我认为我错误地将我的 PHP 经验应用于 Obj-C。

我的想法是，我应该能够使用类似的东西访问类/对象中的属性

```
aThing *someThing = someInstance->aThing; 
```

从我一直在查看的示例代码看来，这应该可以工作。但事实并非如此。这是代码，尽可能精简到[http://pastebin.com/d49c9d0be](http://pastebin.com/d49c9d0be)

而不是知道如何解决这个特定问题，问题是，我不明白什么？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2009-03-30T17:07:34.170

在 Objective-C 中，您需要定义访问器方法来获取实例变量，除非您从相同的类类型调用它（例如，当您实现 NSCopying 协议并且需要设置私有变量，但现在不用担心）。

最简单的方法是在你的头文件中使用 定义一个属性`@property(retain) SomeClass *name;`，并让 Objective-C 通过放入`@synthesize name = instanceVariable;`你的实现来生成它。`object.name;`然后，您可以使用或`[object name]`；访问该类之外的变量。有关更多信息，请查看属性和面向对象编程的文档。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-03-30T17:08:00.330

您不会以任何形状公开 gameLayer.myBody 属性。你必须使用@property 声明（假设objective-c 2.0）（这里是一个[例子](http://theocacao.com/document.page/510)）。

我没有任何 PHP 背景，所以我不知道它在 PHP 中可能有何不同。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2009-03-30T17:10:20.513

访问对象中的属性的正确方法如下：

```
aThing * someThing = someInstance.aThing; // new style 
```

或者

```
aThing * someThing = [someInstance aThing]; // old style 
```

如果您使用 c 进行编码，那么`->`运算符将是有意义的。然而，在 Objective-c 中，对象总是通过指针传递。没有objective-c 变量实际上持有一个对象，它们只是持有指向对象的指针。语言设计者只是决定使用`[]`or`.`语法来访问成员，所以这就是我们必须做的！

# spring - 控制反转，Spring Framework - 全局实例系统

> ID：698087
> 
> 赞同：2
> 
> 时间：2009-03-30T16:58:44.347
> 
> 标签：spring, jakarta-ee, inversion-of-control

控制反转本质上只是检索一组已经实例化的对象吗？理论上。我猜想 Spring 等 IoC 框架实现的更细粒度的细节具有更多功能，但从理论上讲，IoC 容器似乎像一组实例化的 bean（在 Java 世界中）一样运行，然后您就可以访问这些 bean。几乎就像您使用单例对象集合一样？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-03-30T17:06:58.117

是的，它在一定程度上在实践中掌握了单例。一些 bean 将在需要时多次实例化（取决于配置），但通常您可以使用单个实例 - 特别是如果它们在配置后是无状态的。我喜欢数据在正确连接后“流经”应用程序管道的想法。

好处是“单一性”只存在于配置中，而不存在于代码中，这使得系统更具可测试性和灵活性。您如何*查看*（和公开）应用程序的依赖项方面的差异是巨大的。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-03-30T18:51:59.363

虽然答案已经被接受了，但我会再详细说明一下：

最初的春天主要是关于单身管理。随着自定义范围的引入，出现了特定于 Web 的范围以及创建自己的自定义范围的能力。依靠 AOP 特性，这也允许您尽可能长时间地“保持单例”，因为它使用了一种称为范围代理的技术。这可以让您在单例链的中间引入一个作用域对象 - 您经常使用 threadlocals 的功能。

所以我想说这是对实例创建的严格控制，以确保一切都只完成所需的次数，并且最好只为每个请求完成*必要的构造。*单身管理是过去的日子。

# java - Eclipse 3.4 和 Jboss 部署问题：

> ID：698091
> 
> 赞同：1
> 
> 时间：2009-03-30T16:59:40.723
> 
> 标签：java, eclipse, jboss

尝试在 JBoss 中部署我的项目时遇到问题。生成的 war 文件包含 servlet.jar，它们是我的依赖项的一部分，但与 JBoss 的 servlet 类冲突。

```
Error ...servlet.jar) - jar not loaded. See Servlet Spec 2.3, section 9.7.2\. Offending class: javax/servlet/Servlet.class 
```

运行 ant 构建时，我可以从 war 文件中删除 servlet.jar。它部署和工作正常。

我想做的是告诉eclipse不要在war文件中部署servlet.jar。我怎么做？

版本：Eclipse 3.4 Jboss 4.2

提前致谢。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-03-30T18:22:43.770

要回答有关如何避免将 Servlet.jar 捆绑在 WAR 文件中的主要问题，您应该取消选中对 servlet.jar 文件的 Web 库依赖关系。这可以从项目属性 -> Java EE 模块依赖项 -> Web 库中完成；在此页面中取消选中依赖项可防止它们出现在 WAR 文件的 WEB-INF\lib 目录中。

附带说明一下，我建议使用 JBoss 运行时库作为服务器运行时包含，而不是在 Java 构建和类路径中嵌入 servlet.jar 和其他 Java EE JAR。虽然我没有使用过，但[JBoss Tools](http://www.jboss.org/tools)可能会让您在这方面的体验更轻松。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-03-30T17:58:44.640

你在哪里包括servlet.jar？它应该只是对项目内部外部位置的依赖。然后它只会在构建时使用。

您还应该确保不要从构建配置中的 Order and Export 选项卡中导出此 jar。

# asp.net - ASP.NET 中的会计样式字符串格式

> ID：698092
> 
> 赞同：5
> 
> 时间：2009-03-30T17:00:00.833
> 
> 标签：asp.net, string-formatting

我想知道将字符串格式化为会计样式的最简单方法。我知道如何使用 {0:c} 将格式设置为货币，但会计风格存在一些差异，例如，所有美元符号和所有小数点都将对齐，并且负数用括号表示，而不是用 a “-”减号。如果您将单元格格式设置为带 2 个小数位的“会计”，您可以在 excel 中找到我想要的方式的一个很好的示例。

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2009-03-30T17:06:46.993

忽略您的对齐要求，您可以使用

```
number.ToString("€#,##0.00;(€#,##0.00);Zero") 
```

将负数括起来。

要对齐您的数字，您必须在没有货币符号的情况下进行格式化，并自己用空格填充格式化的数字，使用固定宽度的字体会让您更轻松地完成这项工作。

编辑：

看来 String.Format 是你的朋友：

```
String.Format("{0,15:#,##0.00 ;(#,##0.00);-   }", number) 
```

其中 15 是输出的总宽度，您需要将此文本附加到您的货币符号。（同样，这仅以固定宽度对齐）

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2009-03-30T17:04:30.930

没有用于处理会计样式格式的格式字符串快捷方式（具有默认规则的单字符快捷方式）（[这是带有可用格式字符串的备忘单](http://john-sheehan.com/blog/wp-content/uploads/msnet-formatting-strings.pdf)），因此您必须编写更具体的快捷方式（如 Patrick 的答案）或您自己的解析方法。

对齐要求将特定于您如何显示它们。我假设您使用的是表格，在这种情况下，您会受到 HTML 支持的限制，并且它不支持 Excel 等会计样式对齐方式。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2009-03-30T17:09:21.513

在[此博客](http://blogs.msdn.com/kathykam/archive/2006/03/29/564426.aspx)中，概述了一些不同的格式，这似乎与您正在寻找的内容很接近：

```
int neg = -10;
int pos = 10;
// C or c (Currency): It represent how many decimal place of zeros to show.
String.Format("{0:C4}", pos);      //"$10.0000"
String.Format("{0:C4}", neg);      //"($10.0000)" 
```

它不处理填充（您可能必须自己修复），但它确实有正确的括号。

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2009-03-30T17:26:42.843

你可以使用帕特里克方法的变体来做一些事情。假设您知道要处理的值的上限，这将处理格式化和对齐：

```
private static string OutputAsCur(decimal val)
{
    string format = "  #,##0.00 ; (#,##0.00);Zero";
    string frmt = val.ToString(format);
    return CultureInfo.CurrentCulture.NumberFormat.CurrencySymbol + frmt.PadLeft(15, ' ');
} 
```

这是一个简单的示例应用程序，可以查看它的格式：

```
 static void Main(string[] args)
    {
        decimal d = 155.55m;

        Console.WriteLine(OutputAsCur(d));
        Console.WriteLine(OutputAsCur(d * -1));
        Console.WriteLine(OutputAsCur(1002.32m));
        Console.WriteLine(OutputAsCur(1002.32m * -1));
        Console.ReadLine();
     } 
```

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2014-02-10T18:40:56.297

You can use a format string for String.Format to get what you're trying to accomplish. The only trick is that positive numbers, since they will not have a closing parenthesis mark, will have to incorporate a space at the end if they will be aligned with any negative numbers that will be in the column. The trick is to get that space into the string in a way that HTML will not ignore. I simply use the HTML entity &nbsp; which indicates a non-breaking space in HTML.

Here's sample code. First, in the aspx.

```
<table>
...
    <tr>
        <th scope="row" colspan="2">Total Revenue</th>
        <td class="numeric total"><asp:Label runat="server" ID="TotalRevenueLabel" /></td>
    </tr>
...
</table> 
```

Now, the codebehind.

```
public const string kMoneyFormat = "#,#.00'&nbsp;';(#,#.00);'-.--&nbsp;'";

public void DataBind()
{
    using (FinancialDataContext sql = new FinancialDataContext())
    {
        var periodQuery = from m in sql.Forecasts()
                          select m;
        ForecastsResult periodData = periodQuery.Single();
        decimal totalRevenue = period.Data.income_actual.Value + periodData.other_income.Value;
        TotalRevenueLabel.Text = totalRevenue.ToString(kMoneyFormat);
    }
} 
```

* * *

## 回答 #6

> 赞同：-1
> 
> 时间：2017-05-24T15:24:06.080

I followed these steps for apply the "Accounting" format.

*   In a new Book on Excel, select a cell.
*   Insert data *(i.e any number; for this example, add 80000)*.
*   Select (Accounting) NumberFormat as is shown in the screenshot #1:

*Screenshot #1:*

[![Screenshot 1](https://i.stack.imgur.com/FB6I9.png)](https://i.stack.imgur.com/FB6I9.png)

*   Select "More Number Formats".
*   Select "Custom".
*   Select any of the pre-defined formulas *(see screenshot #2)*.

*Screenshot #2:*

[![Screenshot 2](https://i.stack.imgur.com/jWjSU.png)](https://i.stack.imgur.com/jWjSU.png)

In my case, this is the desired format for this number.

* * *

The *negative* side of this is that when you select the cell with the format applied on it, you wont see selected (Accounting) "in the DropDownList" Number Format.

# windows - 通过脚本刷新 Windows XP 字体缓存

> ID：698097
> 
> 赞同：2
> 
> 时间：2009-03-30T17:02:08.597
> 
> 标签：windows, scripting

有谁知道如何强制 Windows XP 重建已安装字体列表而无需重新启动。它们似乎已正确安装，因为重新启动后一切正常，但我想避免重新启动。

# sql - 在第一个结果之后更改排序标准

> ID：698120
> 
> 赞同：1
> 
> 时间：2009-03-30T17:10:32.087
> 
> 标签：sql, mysql, sorting

我正在从新闻文章数据库中进行选择，如果可能的话，我更愿意在一个查询中完成所有操作。在结果中，我需要一个仅适用于第一个结果的排序标准。

在我的情况下，第一个结果必须有图像，但其他结果应该排序而不关心它们的图像状态。

这是我可以在 MySQL 查询中使用某种条件或用户变量来做的事情吗？

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2009-03-30T17:16:37.440

即使您设法找到一个看起来像一个查询的查询，它在逻辑上也将是两个查询。如果您真的必须使其成为一个查询（但仍将是 2 个逻辑查询），请查看[MySQL UNION 。](http://dev.mysql.com/doc/refman/5.0/en/union.html)您可以将第一个中的图像与限制为 1 合并，其余的在第二个中合并。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2009-03-30T17:17:59.963

这样的事情可以确保文章顶部有图像。

```
SELECT
  id,
  title,
  newsdate,
  article 
FROM
  news
ORDER BY
  CASE WHEN HasImage = 'Y' THEN 0 ELSE 1 END,
  newsdate DESC 
```

当然，除非您更接近地定义“第一个结果”。此查询优先选择有图片的文章，没有图片的文章将出现在最后。

另一个变体（感谢 le dorfier，由于某种原因删除了他的答案）是这样的：

```
SELECT
  id,
  title,
  newsdate,
  article 
FROM
  news
ORDER BY
  CASE WHEN id = (
    SELECT MIN(id) FROM news WHERE HasImage = 'Y'
  ) THEN 0 ELSE 1 END,
  newsdate DESC 
```

这对最早的（假设 MIN(id) 表示“最早的”）文章进行排序，顶部有图像。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2009-03-30T17:13:26.260

我认为这是不可能的，因为它实际上是 2 个查询（第一个查询必须对表进行排序，第二个查询是无序的），所以你不妨`LIMIT 1`在第一个查询中使用 2 个查询。

# java - How can I find the target Java version for a compiled class?

> ID：698129
> 
> 赞同：14
> 
> 时间：2009-03-30T17:13:48.383
> 
> 标签：java, compiler-construction

### Duplicate:

> [Tool to read and display Java .class versions](https://stackoverflow.com/questions/27065/tool-to-read-and-display-java-class-versions)

If I have a compiled Java class, is there a way to tell from just the class file what its target version compatibility is? Specifically, I have a number of class files, compiled to Java 6, which are running under Java 5 and giving the the "Unrecognized version" error. I want to be able to look at a class file and find what its target version compatibility is without running the JVM. Any ideas?

* * *

## 回答 #1

> 赞同：44
> 
> 时间：2009-03-30T17:22:05.273

You can use the **javap** utility that comes with the standard JDK.

```
javap -verbose MyClass

Compiled from “MyClass.java”
public class MyClass extends java.lang.Object
SourceFile: “MyClass.java”
minor version: 3
major version: 45 
```

* * *

## 回答 #2

> 赞同：24
> 
> 时间：2009-03-30T17:19:10.133

I've found this on the net and it works.

> Every '.class' file starts off with the following:
> 
> *   Magic Number [4 bytes]
> *   Version Information [4 bytes]
> 
> A hexdump of a '.class' file compiled with each of the following options reveals:
> 
> `javac -target 1.1` ==> `CA FE BA BE 00 03 00 2D`
> `javac -target 1.2` ==> `CA FE BA BE 00 00 00 2E`
> `javac -target 1.3` ==> `CA FE BA BE 00 00 00 2F`
> `javac -target 1.4` ==> `CA FE BA BE 00 00 00 30`
> 
> Perhaps you could use this information to write your own '.class' file version checking utility, using Java, or perhaps a scripting or shell language ;) !
> 
> I hope this helps.
> 
> Anthony Borla

From: [http://bytes.com/groups/java/16603-how-determine-java-bytecode-version](http://bytes.com/groups/java/16603-how-determine-java-bytecode-version)

* * *

## 回答 #3

> 赞同：5
> 
> 时间：2013-04-25T14:42:18.420

Linux/Unix users have a nice tool out of the standard toolbox: [`file`](http://en.wikipedia.org/wiki/File_%28command%29) utility. Modern versions can detect the Java class fersion version and even output Java version for known class file types.

Example output:

```
com/sample/Tracker.class: compiled Java class data, version 45.3
com/sample/TestListener.class: compiled Java class data, version 49.0 (Java 1.5) 
```

And it fits very nicely into the standard Unix scripting toolchain.

* * *

## 回答 #4

> 赞同：3
> 
> 时间：2009-03-30T17:22:37.550

Taken from: [http://twit88.com/blog/2008/09/22/java-check-class-version/](http://twit88.com/blog/2008/09/22/java-check-class-version/)

```
try {
    String filename = "C:\\MyClass.class";
    DataInputStream in = new DataInputStream(new FileInputStream(filename));
    int magic = in.readInt();
    if (magic != 0xcafebabe) {
        log.info(filename + " is not a valid class!");
    }
    int minor = in.readUnsignedShort();
    int major = in.readUnsignedShort();
    log.info(filename + ": " + major + " . " + minor);
    in.close();
} catch (IOException e) {
    log.info("Exception: " + e.getMessage(), e);
} 
```

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2009-03-30T17:19:26.903

You can look at the byte offset 6 and 7 in the file (in a hex dump probably), which tells you which version is used. I think the [Bytecode Visualizer](http://www.drgarbage.com/bytecode-visualizer-lt.html) (eclipse plugin) can see which version a class file is made for.

[Further reading](http://en.wikipedia.org/wiki/Class_(file_format))

# sql-server - VBA CDate 与 SQL Server 2005 中的 Convert(datetime,) 不匹配

> ID：698133
> 
> 赞同：3
> 
> 时间：2009-03-30T17:14:51.360
> 
> 标签：sql-server, ms-access, vba

在 Access 2003 VBA 中（使用的立即窗口）

```
? CDate(39870) 
```

返回：2009 年 2 月 26 日

在 SQL Server 2005 中（SQL Server Management Studio）

```
SELECT CONVERT(DATETIME, 39870) 
```

返回：2009-02-28 00:00:00.000

它们总是相差 2，还是我缺少其他日期设置？

服务器排序规则 = SQL_Latin1_General_CP1_CI_AS

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2009-03-30T18:04:03.160

不同的语言和系统使用不同的数字表示日期。

SQL 2005 从 1900 年 1 月 1 日开始计算天数：

```
SELECT CONVERT(DATETIME, 1)
1900-01-02 00:00:00.000 
```

Excel 和 Access VBA 从 1899 年 12 月 30 日开始计算天数：

```
? CDate(1) 
12/31/1899 
```

其他人则从其他看似随机的起点开始计算天数、秒数，有时甚至是毫秒数。我认为 MS DOS 使用的是 1990 年 12 月 31 日。UNIX 使用的是 1970 年 1 月 1 日。

所以不要试图直接翻译它们（数字，即）。您必须转换为实际的日期表示 (01-03-2009)，然后返回另一个环境。

编辑：VBA 有一些关于向后兼容性和闰年计算的有趣怪癖。阅读乔尔[与比尔盖茨的第一次相遇](http://www.joelonsoftware.com/items/2006/06/16.html)。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-03-30T18:09:07.967

他们使用不同的起点。

访问从 1899 年 12 月 30 日开始计算日期

SQL Server 于 1900 年 1 月 1 日开始

这就是为什么你会得到两天的差异。

通常，您不能依赖在不同系统中使用相同的内部表示。

# javascript - 将 JavaScript 操作与 DOM 集成的最佳实践

> ID：698135
> 
> 赞同：0
> 
> 时间：2009-03-30T17:15:06.693
> 
> 标签：javascript, jquery

例如，假设一个 xHTML 文档如下：

```
<html>
<head>
</head>
<body>
<div id="wrapper">
  <div id="sidebar"></div>
  <div id="content"></div>
</div>
</body>
<script type="text/javascript" src="http://code.jquery.com/jquery-latest.min.js"></script>
<script type="text/javascript" src="./application.js"></script>
</html> 
```

我们将对 PHP 脚本执行 GET AJAX 请求，该脚本将查询数据库并返回响应以填充`TABLE`将通过 JavaScript 格式化为可排序网格的元素。

此外，我们希望我们所有的 JavaScript 都在一个文件中，如上所示，该文件可以轻松包含在内。

选项：

1.  让 PHP 脚本返回`TABLE` 填充了所有数据的元素。使用 jQuery 的`live()`函数来主动监视`TABLE` DOM 中的新元素，并在发现它们时应用可排序的网格功能。该方法允许我们在 PHP 中操作从 AJAX 请求返回的内容，并将完整的语义表返回给父文档。

2.  将`TABLE`元素插入到上面列出的脚本中，但将其内容留空。一旦文档准备好，jQuery 将立即应用可排序的网格功能，尽管尚不存在任何内容。然后，GET 请求将返回一个 JSON 响应，该响应将填充数据库。

您可以为此类事情分享任何其他意见/最佳实践/用例吗？我在`TABLE`这里只讨论一个，但我们一直在讨论这个问题：灯箱、下拉菜单等。

目前，我们没有使用 jQuery 的`live()`函数，也没有 DOM 元素存在于父文档中。因此，我们不得不在每个单独的视图顶部放置一小段 Javascript。虽然马虎，但这让我们只能在需要时才加载功能，但显然很难维护。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-03-30T18:35:00.217

**[jQuery jqGrid 插件](http://www.trirand.com/blog/)**可能符合要求，通过 ajax 动态加载数据，可以与任何服务器端技术集成，允许您使用主题滚轮对其进行主题化。

要自己更新表，您可以在请求完成时使用大多数 jquery ajax 函数发出回调。例如，如果您的文档中有此内容：

```
<div id="output">
   <table>...</table>
</div> 
```

您可以使用 jquery [Ajax Load](http://docs.jquery.com/Ajax/load)函数加载结果：

```
$('#output').load('results.php',{arg:'val'},updateSort);

function updateSort(){
    $("#output > table").sort();
} 
```

我通常会更进一步：

```
$('#output')
    .html('<div class="centered_padded_msg_class">Loading data...</div>')
    .load('results.php',{arg:'val'},updateSort);

function updateSort(){
    $("#output > table").sort();
} 
```

祝你好运，-马特

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-03-30T18:37:47.650

总是最好在初始加载时尽可能多地加载。如果您的站点/应用程序要求您通过 AJAX 动态添加内容，那么我可以看到您进退两难。

据我了解，您想知道最好/首选的做法是保持 JavaScript 简洁并保存在文件中，而不是分散在整个页面中。您是说目前您的脚本分散在您的整个页面中，因为当您加载模块/视图或任何它们具有的 js 时，它们会在它们加载时运行它们的脚本（冗长，抱歉）。而且，问题是您希望在使用一个无所不能的超级全局 js 文件加载这些视图时触发特定事件（例如实例化灯箱或排序表格）。

所以，如果这听起来不错，那么这就是我要做的（对于动态加载的任何视图）......

所以，让我们假设你有你提供的代码：

```
<html>
<head>
<script type="text/javascript" src="http://code.jquery.com/jquery-latest.min.js"z></script>
<script type="text/javascript" src="./application.js"></script>
</head>
<body>
    <div id="wrapper">
          <div id="sidebar"></div>
          <div id="content"></div>
    </div>
</body>
</html> 
```

如果您在页面完全加载时将一些内容加载到“#content”div（例如表格）中，然后您想对该表格进行排序而不将脚本放入从 AJAX 返回的 HTML 中，您您的主（'./application.js'）文件中可能包含以下代码：

```
$(function() {
    load_table();
    $('#content #my_table').live('table_loaded',function() {
        $(this).sort(); // or whatever your sorting method is...
    });
});

function load_table() {
    $.get('mysite.php',{foo:bar,bar:foo},function(data) { 
        $('#content').html(data).find('#my_table').trigger('table_loaded');
    });
} 
```

这使用 jquery 自定义事件和 live() 事件。我没有对此进行测试，但它应该在理论上有效。

**更新：**我对此进行了测试，并且使用 jquery 1.3.2 可以完美运行 :)

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-03-30T17:26:58.850

恕我直言，页面在首次显示时应尽可能完整，以避免额外的请求。所以我投票支持第一种方法。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2009-03-30T17:27:24.107

我目前正在维护一个基于`live()`方法的 Web 应用程序以及父文档中不存在的 DOM 元素，这似乎很好。我尝试自己在“结果”页面中插入代码片段，但很难全部更新，有时你可以跳过我的一两个错误，然后问自己“我做错了什么？” 并寻找问题几个小时。

该`live()`方法非常好，因为您可以将所有代码保存在一个特定文件中，并且显然比上面的解决方案更容易维护。

我正在谈论的应用程序现在正在生产中，它没有失败一次，所以我对这个解决方案非常满意（但奇怪的是，我使用相同的模式来填充`TABLE`数据元素并将其显示为网格:)

# ide - 用于 Web 开发以构建尖端网站的最佳 IDE 和语言是什么？

> ID：698141
> 
> 赞同：0
> 
> 时间：2009-03-30T17:16:17.253
> 
> 标签：ide, programming-languages

我最近对来自基于内核的应用程序的 Web 开发感兴趣。我很好奇可以使用什么最好的开发环境和语言来构建一个漂亮的网站。我对 PHP、CSS 之类的东西很熟悉，但我对 HTML 很熟悉。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2009-03-30T17:20:06.353

坦率地说：这并不重要。

只要它产生有用的 HTML、CSS 和 JavaScript，你就可以拥有一个漂亮的网站（你也可以产生糟糕的网站！）。开发环境纯粹是程序员的喜好问题。

只要你有纪律，有计划地攻击项目，认识一两个优秀的设计师，并且有毅力坚持到最后，你就会成功。

# .net - .NET 集合和大对象堆 (LOH)

> ID：698147
> 
> 赞同：10
> 
> 时间：2009-03-30T17:18:26.140
> 
> 标签：.net, memory-management, collections, clr

具有大量项目的 .NET 集合是否易于存储在 LOH 中？

我特别对 List 和 Dictionary 感到好奇。在我的代码中，我将大量（40k+）相对较小的对象（比如说 1k）存储在临时列表和字典中以进行处理。这些集合中的项目数量是否会增加被放入 LOH 的可能性？

对于list，假设List实现为双向链表，那么元素的数量不应该增加实际List对象的大小，但我想确定一下。

谢谢

* * *

## 回答 #1

> 赞同：13
> 
> 时间：2009-03-30T17:27:02.797

只有超过 85,000 字节的对象才会存储在 LOH 中。一个大列表（尤其是结构）通常会在这里分配。

但是，Dictionary 不太可能，因为它们存储了一个桶数组，所以除非生成足够的桶以使数组变得 > 85000 字节，否则不太可能。40k 元素的列表将存储在 LOH 中，即使它们是类（因为每个元素中的对象引用将导致列表在 x86 上为 160k，在 x64 系统上为 320k）。但是，各个元素将在标准堆上，因此会被压缩，等等。

如果您使用双向链表而不是标准列表，则它不太可能存储在 LOH 上。列表的每个元素都会很小（只是一个引用下一个/前一个节点的节点），所以没有一个对象会大于 85k 字节。

有关 LOH 的详细信息，[这是一篇很棒的博客文章。](http://blogs.msdn.com/maoni/archive/2006/04/18/large-object-heap.aspx)

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2009-03-30T17:22:46.800

`System.Collections.Generic.List`在内部实现为数组，而不是链表。是的，如果集合的大小很大，它将被分配在大对象堆上（请注意，数组的大小很重要，如果您有一个包含大引用类型的小数组，则不会在 LOH 上分配）。

* * *

## 回答 #3

> 赞同：4
> 
> 时间：2009-03-30T17:22:49.810

List 被实现为一个数组。因此，数组将被放入 LOH，但 List 对象本身不会。

这同样适用于字典。它也在内部使用一组存储桶，它们基本上存储您添加的键/值对。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2009-03-30T17:28:14.667

字典有 O(LOG N) 向量作为键/值，所以在 40K+ 个对象中你很安全。正如之前所说的 List 被实现为数组，所以大列表确实在 LOH 上。您可以使用 SOS 检查您[的对象是否在 LOH 上](http://msdn.microsoft.com/en-us/magazine/cc534993.aspx)。

# vb.net - Visual Basic - 猜颜色程序

> ID：698148
> 
> 赞同：1
> 
> 时间：2009-03-30T17:18:43.127
> 
> 标签：vb.net, colors

我正在尝试制作一个小游戏，其中计算机给出随机的颜色代码（红色绿色黄色和蓝色），然后你必须尝试猜测它们......但我无法让颜色随机化。

颜色是 4 个按钮的背景色。代码长四种颜色。然后玩家点击下方的一些按钮并尝试猜测代码。每次单击都会改变一次颜色。如果玩家猜到正确位置的正确颜色，则显示颜色。

到目前为止，我有这个：

（问题是：重载解析失败，因为无法使用这些参数调用公共“=”：“公共共享运算符 =（左作为 System.Drawing.Color，右作为 System.Drawing.Color）作为布尔值”：参数匹配参数“ right' 不能从 'Integer' 转换为 'Color'。（见下面 REM 颜色 1 到 REM 结束）问题是由计算机产生的，用 Visual Basic 编写的程序，windows 窗体应用程序）

```
Dim turn = 0
Dim generator As New Random
Dim color1 = generator.Next(1, 4)
Dim color2 = generator.Next(1, 4)
Dim color3 = generator.Next(1, 4)
Dim color4 = generator.Next(1, 4)

Private Sub NewToolStripMenuItem_Click(ByVal sender As System.Object, ByVal e As System.EventArgs) Handles NewToolStripMenuItem.Click

    REM color 1                 
    If color1 = 1 Then              
        color1 = Color.Red
    End If
    If color1 = 2 Then
        color1 = Color.Blue
    End If
    If color1 = 3 Then
        color1 = Color.Yellow
    End If
    If color1 = 4 Then
        color1 = Color.Green
    End If
    REM color 2
    If color2 = 1 Then
        color2 = Color.Red
    End If
    If color2 = 2 Then
        color2 = Color.Blue
    End If
    If color2 = 3 Then
        color2 = Color.Yellow
    End If
    If color2 = 4 Then
        color2 = Color.Green
    End If
    REM color 3
    If color3 = 1 Then
        color3 = Color.Red
    End If
    If color3 = 2 Then
        color3 = Color.Blue
    End If
    If color3 = 3 Then
        color3 = Color.Yellow
    End If
    If color3 = 4 Then
        color3 = Color.Green
    End If
    REM color 4
    If color4 = 1 Then
        color4 = Color.Red
    End If
    If color4 = 2 Then
        color4 = Color.Blue
    End If
    If color4 = 3 Then
        color4 = Color.Yellow
    End If
    If color4 = 4 Then
        color4 = Color.Green
    End If
  REM End
    Button1.BackColor = color1
    Button2.BackColor = color2
    Button3.BackColor = color3
    Button4.BackColor = color4 
```

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2009-03-30T17:28:31.717

color1,color2,color3,color4 是整数。

当你写： Dim color1 = generator.Next(1, 4)

generator.Next 产生一个整数，所以 color1 被定义为一个整数。当你写 color1 = Color.Red

它很困惑，因为您试图将 Color 设置为一个整数变量。

一般来说，有更简洁的方法来编写代码，但你可能会做这样的事情：

```
 option explicit
Dim color_index as Integer
Dim color1 as System.Drawing.Color
color_index=generator.Next(1,4)
[choosing logic]
color1 = Color.red
[blah blah blah]
Button.backcolor = color1 
```

附加说明：正如第一个答案所说，确实有更好的方法来编写整个内容。以下伪代码是我解决问题的方法：（对不起，我不记得确切的 VB 语法了）

```
 Button_Array = [Button1,Button2,Button3,Button4]
Color_array= [Color.red,Color.blue,Color.green,Color.yellow]
for i in 1 to 4
   color_index=generator.Next(1,4)
   Button_Array[i].backcolor = Color_array[color_index]
endfor 
```

这更具可读性和可维护性。（如果要在原始列表或我的伪代码列表中添加第 5 个按钮或第 5 种颜色，请考虑必须添加多少行）

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2009-03-30T17:22:47.113

[Visual Basic 中的数组](http://msdn.microsoft.com/en-us/library/wak0wfyt(VS.80).aspx)

我不知道你的具体问题是什么，但那个巨大的开关应该只是一组颜色。如果由于某种原因不能用 = 比较颜色，请将代码设为整数数组，并以整数工作，并在需要显示颜色时在数组中查找颜色。

* * *

## 回答 #3

> 赞同：4
> 
> 时间：2009-03-30T17:24:55.330

问题在于您正在将`colorN`（整数）设置为`Color`对象。

作为已经在这里的优秀答案的附录......

```
generator.Next(1,4) 
```

**只会返回 1 到 3 之间的值**！

你真正想要的是：

```
generator.Next(1,5) 
```

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2009-03-31T19:44:15.937

感谢您的帮助，但我从另一个人“Coding4fun.com”的克林特那里得到了一些帮助。现在正常工作。我所做的是正如第一次所说的那样，通过调用 color1 例如一个整数然后要求一种颜色来混淆计算机。我现在所做的就像 BlueMonkMN 开始一个案例一样。

```
Private Function getrandomcolour() As Color
    Select Case generator.[Next](1, 6)
        Case 1
            Return Color.Red
            Exit Select
        Case 2
            Return Color.Green
            Exit Select
        Case 3
            Return Color.Yellow
            Exit Select
        Case 4
            Return Color.Blue
            Exit Select
        Case 5
            Return Color.Pink
            Exit Select
        Case 6
            Return Color.Turquoise
            Exit Select
    End Select
    If Button1.BackColor = Button2.BackColor Then
        getrandomcolour()
    End If
    If Button3.BackColor = Button4.BackColor Then
        getrandomcolour()
    End If
    If Button1.BackColor = Button3.BackColor Then
        getrandomcolour()
    End If
    If Button2.BackColor = Button3.BackColor Then
        getrandomcolour()
    End If
End Function 
```

无论如何，感谢您的可爱回答！

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2009-03-30T17:33:38.567

当你 Dim color1 = generator.Next(1, 4) 时，它隐式地将 color1 定义为一个整数，因为这是 generator.Next 返回的。我建议（为了您自己和任何阅读您代码的人的利益）您使用“As”来明确定义变量的类型。

看起来您正在尝试使用相同的 color1 变量来包含颜色的整数和枚举（“颜色”）版本。这将变得相当混乱，因为如果您明确强制枚举值也可以直接与整数相互转换，那么您将不知道特定值是代表您自己的颜色编码系统还是系统的。我建议您创建一个函数，生成 4 种随机颜色中的 1 种，如下所示：

```
Function GenerateColor() As Color
    Select Case generator.Next(1,5)
       Case 1
          Return Color.Red
       Case 2
          Return Color.Blue
       Case 3
          Return Color.Yellow
       Case 4
          Return Color.Green
    End Select
End Function 
```

并使用该函数来初始化您的随机值。

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2009-03-30T17:34:25.867

你应该建立一个这样的颜色字典：

```
private _Generator as Random
private _Colors as Dictionary(of Integer, Color)
private _Color1 as Color
private _Color2 as Color
private _Color3 as Color
private _Color4 as Color

Public Sub New()
    _Generator = new Random()
    _Colors.Add(1, Colors.Red)
    _Colors.Add(2, Colors.Blue)
    _Colors.Add(3, Colors.Yellow)
    _Colors.Add(4, Colors.Green)    
End Sub

Private Sub NewToolStripMenuItem_Click(ByVal sender As System.Object, ByVal e As System.EventArgs) Handles NewToolStripMenuItem.Click

    _Color1 = _Colors(_Generator.Next(1, 4))
    _Color2 = _Colors(_Generator.Next(1, 4))
    _Color3 = _Colors(_Generator.Next(1, 4))
    _Color4 = _Colors(_Generator.Next(1, 4))

    Button1.BackColor = _Color1
    Button2.BackColor = _Color2
    Button3.BackColor = _Color3
    Button4.BackColor = _Color

End sub 
```

# shell - 如何在VB6中关闭一个带壳的进程

> ID：698156
> 
> 赞同：1
> 
> 时间：2009-03-30T17:20:19.897
> 
> 标签：shell, process, vb6

我从我的 VB6 应用程序中取出一个应用程序。然后我想关闭它。我怎样才能做到这一点？

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2009-03-30T18:02:47.750

[这](http://vb.mvps.org/samples/TaskList)是 Karl Peterson 的 VB6 关闭应用程序的方法。根据您的要求，这很好 - 发送 WM_CLOSE 而不是使用 TerminateProcess。请注意，它将消息发送到属于该进程的所有顶级窗口，可能不止一个。

我还没有尝试过，但根据我的经验，卡尔·彼得森的代码总是在可能的五颗星中评价五颗星！

编辑：请注意这是原始答案的编辑版本，现在链接到卡尔代码的最新版本。如果有人对此有疑问，Karl 仍然活跃在[VB6 新闻组](http://groups.google.co.uk/group/microsoft.public.vb.general.discussion)上，但我认为他不会在 Stack Overflow 上闲逛。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2009-03-30T17:29:20.623

看一下这个：

[结束由 Shell 函数启动的应用程序](http://www.freevbcode.com/ShowCode.Asp?ID=670)

# c# - WebConfigurationManager 和 ConfigurationManager 有什么区别？

> ID：698157
> 
> 赞同：108
> 
> 时间：2009-03-30T17:20:45.620
> 
> 标签：c#, .net, asp.net, configurationmanager, webconfigurationmanager

`WebConfigurationManager`和 有什么区别`ConfigurationManager`？

我什么时候应该使用其中一种？

**更新**

我刚刚查看了`WebConfigurationManager`，由于某种原因，您无法像在`ConfigurationManager`（如数组）中那样访问连接字符串。谁能告诉我为什么MS会这样？使用`WebConfigurationManager`.

**再次更新警告！**

如果您没有对添加到项目中的命名空间的引用，那么当您尝试访问类似数组`System.Configuration`时，Visual Studio 将显示错误！`WebConfigurationManager.ConnectionStrings`

* * *

## 回答 #1

> 赞同：97
> 
> 时间：2009-03-30T17:50:34.737

WebConfigurationManger 知道如何处理 Web 应用程序中的配置继承。如您所知，一个应用程序中可能有多个 web.config 文件 - 一个在站点的根目录中，而在子目录中则为任意数量。您可以将路径传递给 GetSection() 方法以获取可能的覆盖配置。

如果我们用 Reflector 查看 WebConfigurationManager，那么事情就很清楚了：

```
public static object GetSection(string sectionName)
{
    ...
    return ConfigurationManager.GetSection(sectionName);
}

public static object GetSection(string sectionName, string path)
{
    ...
    return HttpConfigurationSystem.GetSection(sectionName, path);
} 
```

* * *

## 回答 #2

> 赞同：27
> 
> 时间：2009-03-30T17:22:48.330

WebConfigurationManager 专为 ASP.NET 应用程序而设计。

WebConfigurationManager 提供了额外的方法来加载适用于 Web 应用程序的配置文件。

ConfigurationManager 还提供了加载适用于“.exe”应用程序的配置文件的方法。

我建议看一下 WebConfigurationManager ，看看它是否为您提供了您无法使用 ConfigurationManager 做的任何事情并改用它，否则使用 ConfigurationManager 将使您的代码更容易在 Web 和桌面应用程序之间无缝使用。

* * *

## 回答 #3

> 赞同：4
> 
> 时间：2015-01-31T11:28:29.600

尽管 WebConfigurationManager 位于 System.Web 程序集中，但它返回的 ConnectionStringSettingsCollection 位于 System.Configuration 中。

如果您收到错误

> 无法使用 [] 将索引应用于“System.Configuration.ConnectionStringSettingsCollection”类型的表达式

在尝试访问数组索引时...

```
WebConfigurationManager.ConnectionStrings["Name"].ConnectionString 
```

确保您有对程序集 System.Configuration 的引用

* * *

## 回答 #4

> 赞同：3
> 
> 时间：2009-03-30T19:52:58.547

不确定您对连接字符串的含义。

调用[WebConfigurationManager.ConnectionStrings会返回一个 System.Configuration.ConnectionStringSettingsCollection，这与调用](http://msdn.microsoft.com/en-us/library/system.web.configuration.webconfigurationmanager.connectionstrings.aspx)[ConfigurationManager.ConnectionStrings](http://msdn.microsoft.com/en-us/library/system.configuration.configurationmanager.connectionstrings.aspx)时得到的结果相同。

否则，正如 XOR 所说，它旨在处理多个分层 web.config，当您在应用程序中移动文件夹时根据需要组合它们。

# asp.net - 在 Visual Studio 调试模式下从一个网站到另一个网站的路径

> ID：698165
> 
> 赞同：0
> 
> 时间：2009-03-30T17:23:22.180
> 
> 标签：asp.net, visual-studio

我有两个网站（基于文件夹）和两个类库的解决方案。我需要能够动态设置从一个网站到另一个网站的路径。更具体地说，我正在设置数据网格行中的图像按钮的 PostBackUrl 属性。为生产环境构建和设置 URL 很容易。但是在开发环境中——每个项目在不同的端口上运行——它有点混乱。

有没有办法做到这一点？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-03-30T17:29:46.783

另一种方法是将基本 url 存储在 web.config 文件中，并根据它们将运行的环境进行更改。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-03-30T17:28:18.877

您可以设置 VS 以使用 IIS 进行调试 - 这样它就与您的生产环境相同。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-03-30T17:31:12.910

您可以使用 IIS 来设置您的网站或通过在[网站属性](http://weblogs.asp.net/scottgu/archive/2006/12/19/tip-trick-how-to-run-a-root-site-with-the-local-web-server-using-vs-2005-sp1.aspx)下将“使用动态端口”设置为 false 来分配固定端口。

# iis - IIS 上的 iisadmpwd 实用程序

> ID：698168
> 
> 赞同：0
> 
> 时间：2009-03-30T17:24:37.810
> 
> 标签：iis

我需要确保密码过期的用户可以通过此实用程序更改密码。

有没有办法让我的密码过期并进行测试？我将虚拟目录配置为匿名访问，以便任何人都可以访问该页面。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-04-27T19:14:25.923

您可以使用[System.DirectoryServices.AccountManagement](http://msdn.microsoft.com/en-us/library/system.directoryservices.accountmanagement.aspx)命名空间以编程方式操作用户帐户以灵活地过期和刷新密码。

我已经成功地使用户的密码过期，然后使用 IISADMPWD 页面来重置它。

# database - 表示值可以是任何类型的键/值对（在关系数据库中）

> ID：698173
> 
> 赞同：2
> 
> 时间：2009-03-30T17:26:09.693
> 
> 标签：database, database-design

我正在设计的数据库的一个小而重要的角落将用于存储任意计算的结果。这些结果可以是任何类型。如何表示关系数据库中可以是任何类型的值字段？

我唯一能想到的就是根据数据类型创建单独的表，这些表都具有返回通用表的外键。这对我来说似乎不对，因为为了取回这些值，我必须加入一堆不同的表。肯定有更好的办法。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-03-30T17:28:14.773

您可以将结果序列化为某种二进制格式吗？在这种情况下，“图像”将保存您的数据，您也可以将类型本身存储为字段。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-03-30T17:28:17.893

只要您的抽象层能够序列化所有类型，将它们存储为二进制数据并序列化，反序列化。也许有一个指示数据类型的列。如果您只有 CASTable 数据类型，那么您就更加确定了。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-03-30T17:28:45.490

我之前使用的一种方法是存储序列化值，并使用单独的字符串字段标识其类型。因此，例如，如果您在 .NET 中，您可能会存储“System.Decimal”和一个序列化的十进制值。这适用于二进制或 XML 序列化，分别具有 BLOB 或长字符串字段。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2009-03-30T17:30:05.830

您可以将所有值存储为 VARCHAR。当您从数据库中获取值时，您可以尝试将其与不同的正则表达式进行匹配。每种数据类型都有一个正则表达式。无论它适用于哪一个，您都有自己的数据类型。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2009-03-30T17:32:55.403

您最好的选择可能是序列化数据并使用其他人建议的字符串或 xml。

如果您使用 MS SQL Server，另一个选择是 SQL_VARIANT 类型，它可以存储除 LOB 之外的任何内容。我不推荐这个选项而不是序列化，但是因为序列化可以在任何平台上工作，并且更容易理解和优化。

# tfs - MSBuild 故障疑难解答

> ID：698174
> 
> 赞同：4
> 
> 时间：2009-03-30T17:26:16.527
> 
> 标签：tfs, msbuild

我正在尝试将我的商店从使用 VSS 转换为 TFS。

我们当前的代码库包含大量 Visual Studio 2008 解决方案，我注意到其中一些似乎会导致 MSBuild 失败，但我不知道为什么。实际解决方案本身和他们持有的项目正确构建，但整体构建仍然失败。

ErrorsAndWarnings.txt 和 Release.txt 文件没有显示错误，只有警告（代码中的各种小东西我们需要清理）

BuildLog.txt 文件当然很大，其中包含大量难以理解的文本。不过，据我所知，当它遇到给它带来问题的这些 SLN 文件之一时，MSBuild 只会崩溃并死掉。

```
任务“MSBuild”
  全局属性：
    配置=发布
    平台=任何 CPU
    OutDir=C:\TFS\REPOSITORY\Full\Binaries\Release\
    PublishDir=C:\TFS\REPOSITORY\Full\Binaries\Release\
    SkipInvalidConfigurations=true
    运行代码分析=假
    VCBuildOverride=C:\TFS\REPOSITORY\Full\Sources\Code\Solution\Solution.sln.Release.vsprops
    VCBuildAdditionalLibPaths=
    VCBuildAdditionalOptions=
    VCBuildToolPath=
    VCBuildUseEnvironment=
    TeamBuildConstants=_TEAM_BUILD_
    TargetsNotLogged=GetTargetPath;GetNativeManifest;GetCopyToOutputDirectoryItems

C:\Program Files\MSBuild\Microsoft\VisualStudio\TeamBuild\Microsoft.TeamFoundation.Build.targets(1008,5)：
错误 MSB4018：“MSBuild”任务意外失败。
错误 MSB4018：System.NullReferenceException：对象引用未设置为对象的实例。
错误 MSB4018：在 Microsoft.Build.BuildEngine.SolutionWrapperProject.AssignDependencyLevel（ProjectInSolution 项目，SolutionParser 解决方案，Dictionary`2 projectsByDependencyLevel）
错误 MSB4018：在 Microsoft.Build.BuildEngine.SolutionWrapperProject.AssignDependencyLevel（ProjectInSolution 项目，SolutionParser 解决方案，Dictionary`2 projectsByDependencyLevel）
错误 MSB4018：在 Microsoft.Build.BuildEngine.SolutionWrapperProject.AssignDependencyLevels（SolutionParser 解决方案，Dictionary`2 projectsByDependencyLevel）
错误 MSB4018：在 Microsoft.Build.BuildEngine.SolutionWrapperProject.CreateSolutionProject（SolutionParser 解决方案，项目 msbuildProject，BuildEventContext projectBuildEventContext，字符串 wrapperProjectToolsVersion，引擎 parentEngine，字符串 solutionProjectCache）
错误 MSB4018：在 Microsoft.Build.BuildEngine.SolutionWrapperProject.Generate（SolutionParser 解决方案，项目 msbuildProject，字符串 toolsVersionOverride，BuildEventContext projectBuildEventContext）
错误 MSB4018：在 Microsoft.Build.BuildEngine.Project.Load（字符串 projectFileName，BuildEventContext buildEventContext，ProjectLoadSettings projectLoadSettings）
错误 MSB4018：在 Microsoft.Build.BuildEngine.Engine.GetMatchingProject（项目现有项目，字符串 projectFullPath，BuildPropertyGroup globalPropertiesToUse，字符串 toolsVersion，String [] targetNames，BuildEventContext buildEventContext，布尔工具VersionPeekedFromProjectFile）
错误 MSB4018：在 Microsoft.Build.BuildEngine.Engine.BuildProjectFileInternal(BuildRequest buildRequest)
错误 MSB4018：在 Microsoft.Build.BuildEngine.Engine.EngineBuildLoop（BuildRequest terminatingBuildRequest）
错误 MSB4018：在 Microsoft.Build.BuildEngine.TaskExecutionModule.BuildProjectFile(Int32 handleId, String[] projectFileNames, String[] targetNames, IDictionary[] globalPropertiesPerProject, IDictionary[] targetOutputsPerProject, EngineLoggingServices loggingServices, String[] toolsVersions, Boolean useResultsCache, Boolean unloadProjectsOnCompletion , BuildEventContext 任务上下文)
错误 MSB4018：在 Microsoft.Build.BuildEngine.EngineProxy.BuildProjectFilesInParallel(String[] projectFileNames, String[] targetNames, IDictionary[] globalProperties, IDictionary[] targetOutputsPerProject, String[] toolsVersions, Boolean useResultsCache, Boolean unloadProjectsOnCompletion)
错误 MSB4018：在 Microsoft.Build.Tasks.MSBuild.ExecuteTargets（ITaskItem[] 项目、Hashtable propertiesTable、ArrayList targetLists、Boolean stopOnFirstFailure、Boolean rebaseOutputs、IBuildEngine2 buildEngine、TaskLoggingHelper 日志、ArrayList targetOutputs、Boolean useResultsCache、Boolean unloadProjectsOnCompletion、String toolsVersion）
错误 MSB4018：在 Microsoft.Build.Tasks.MSBuild.BuildProjectsInParallel（Hashtable propertiesTable，ArrayList targetLists，布尔成功，布尔 [] skipProjects）
错误 MSB4018：在 Microsoft.Build.Tasks.MSBuild.Execute()
错误 MSB4018：在 Microsoft.Build.BuildEngine.TaskEngine.ExecuteInstantiatedTask（EngineProxy engineProxy，ItemBucket 存储桶，TaskExecutionMode howToExecuteTask，ITask 任务，Boolean & taskResult）
在项目“TFSBuild.proj”中完成构建目标“CoreCompileSolution”——失败。
完成构建项目“C:\TFS\REPOSITORY\Full\BuildType\TFSBuild.proj”（CompileSolution 目标）- 失败。
完成执行任务“MSBuild”——失败。
在项目“TFSBuild.proj”中完成构建目标“CoreCompileConfiguration”——失败。
完成构建项目“C:\TFS\REPOSITORY\Full\BuildType\TFSBuild.proj”（CompileConfiguration 目标）——失败。
完成执行任务“MSBuild”——失败。
在项目“TFSBuild.proj”中完成构建目标“CoreCompile”——失败。
完成构建项目“C:\TFS\REPOSITORY\Full\BuildType\TFSBuild.proj”（CoreCompile 目标）——失败。
完成执行任务“MSBuild”——失败。
在项目“TFSBuild.proj”中完成构建目标“CallCompile”——失败。

```

我知道在 Stack Overflow 中粘贴令人难以置信的冗长错误消息是蹩脚的，但从上面得到的核心是**MSBuild 正在崩溃**，我不知道为什么。它给出了通常的“未设置对象引用...”错误，当它不是您正在排除故障的代码或程序时，这几乎是普遍无用的。

我看到它引用了 TeamFoundation.Build.targets。我在那个文件中查找那个文件，但它并没有真正跳出我的问题可能是什么。（注释后的行是上面引用的（1008,5））

```
<!-- Build using MSBuild task -->
<MSBuild BuildInParallel="$(BuildSolutionsInParallel)"
         Projects="$(Solution)"
         Properties="Configuration=$(Configuration);Platform=$(Platform);$(OutDirOption);$(PublishDirOption);SkipInvalidConfigurations=$(SkipInvalidConfigurations);$(FxCopDirOption);$(ReferencePathOption);$(CodeAnalysisOption);
                         VCBuildOverride=$(VsPropsFile);VCBuildAdditionalLibPaths=$(VCBuildAdditionalLibPaths);VCBuildAdditionalOptions=$(VCBuildAdditionalOptions);VCBuildToolPath=$(VCBuildToolPath);VCBuildUseEnvironment=$(VCBuildUseEnvironment);
                         TeamBuildConstants=$(TeamBuildConstants);TargetsNotLogged=$(TargetsNotLogged);$(CustomPropertiesForBuild);$(CustomProperties)"
         Targets="$(Targets)"
         StopOnFirstFailure="$(StopOnFirstFailure)">
  <Output TaskParameter="TargetOutputs" ItemName="CompilationOutputs" />
</MSBuild> 
```

起初我以为这告诉我需要在节点中替换的项目之一丢失，但其他没有问题的解决方案具有相似/相同的设置。

我注意到 MSBuild 的调用堆栈中的一些项目处理目标，问题似乎源于 TeamFoundation.Build.targets 文件，但我不知道下一步该做什么来解决它。

有没有人遇到过这个？

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2009-03-31T16:24:54.527

我相信解决方案文件已损坏，并且 VS 更宽容。（如果我没记错的话，这个崩溃可能是由不匹配的花括号引起的）

如果可行，我会在 VS 中重新创建解决方案文件。丹（msbuild 团队）

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2009-03-30T18:14:46.193

当你说：

> 实际解决方案本身和他们持有的项目正确构建

您的意思是它们在 IDE 中正确构建，还是您可以在命令行上转到这些解决方案目录并运行“msbuild foo.proj”或“msbuild bar.sln”？

无论如何，我会尝试首先缩小有问题的解决方案/项目，通过告诉 TFS 不要并行构建，关闭多 CPU 支持（例如'-maxcpucount：1'），通过修剪解决方案/进行二进制搜索项目。到达有问题的集合后，使用“-v:diag”参数进行构建，以获取有关 MSBuild 引擎状态的更多详细信息。

或者，您可以编写一个小型 C# 应用程序，直接调用 MSBuild 引擎并通过捕获第一次机会异常并使用 Reflector 来调试该应用程序。[请参阅MSBuild 引擎类](http://msdn.microsoft.com/en-us/library/microsoft.build.buildengine.engine(loband).aspx)中的示例代码。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2009-04-01T23:10:12.973

嗯。您会得到一个 NullReferenceException，这意味着该任务中的一个参数在不应该为空时为空。愚蠢的问题，但是您是否使用要构建的解决方案设置了 TFSBuild.proj 文件？IE。您放入 - 项目组的东西。

如果你有，我建议将消息​​任务添加到失败任务上方的 Teambuild 目标文件中，以写出诊断信息，如下所示：

这应该会在您在下一次构建中粘贴的日志摘录上方将一些诊断信息喷射到您的构建日志中。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2009-04-03T13:04:47.333

您可能想尝试一下 MSBuild-Sidekicks。他们有一个漂亮的 MSBuild 小调试器，并提供 14 天试用版： http: [//www.attrice.info/msbuild/](http://www.attrice.info/msbuild/)

# java - 在运行时确定正确的方法签名

> ID：698176
> 
> 赞同：4
> 
> 时间：2009-03-30T17:26:43.110
> 
> 标签：java, reflection

我正在使用以下类`org.apache.poi.hssf.usermodel.HSSFCell`，并列出以下方法：

```
void setCellValue(boolean value)

void setCellValue(java.util.Calendar value)

void setCellValue(java.util.Date value)

void setCellValue(double value)

void setCellValue(HSSFRichTextString value)

void setCellValue(java.util.Calendar value)

void setCellValue(HSSFRichTextString value) 
```

请注意，没有以 Object 作为方法参数的方法。

现在，我无法在编译期间确定我的值类类型。我只能在运行时确定我的值类类型。因此，如果我在编译时不知道方法签名，如何确定要调用的正确方法？

我的代码如下：

```
final int rowCount = tableModel.getRowCount();
for (int i = 0; i < rowCount; i++) {
    final HSSFRow row = sheet.createRow(i + 1);
    for (int j = 0; j < columnCount; j++) {
        final Object object = tableModel.getValueAt(i, j);
        final Class myClass = tableModel.getColumnClass(j);
        // How to perform casting during compiled time, and invoke
        // the setCellValue with correct signature?
        if (object != null) {
            row.createCell(j).setCellValue(??); // Does not accept Object!
        }
    }
} 
```

也许丑陋的 if...else with`instanceof`会解决我的问题。但是，如果我不想要丑陋的 if...else with `instanceof`，有没有更好的方法呢？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2009-03-30T17:51:15.343

One way of handling this is to load that list of methods at runtime into a `Map` and then for each call, use the `Map`. That is, something like this (where this code is simplified and omits error checking):

```
Map<? extends Object, Method> map;

Method[] methods = Setters.class.getMethods();
for (Method method : methods) {
  if (method.getName().equals("setCellValue")) {
    map.put(method.getParameterTypes()[0], method);
  }
} 
```

then when you want to call this, look up the Method in the `map` by argument type and use that instance.

To show this off, again with simplified but this time full code. Note that to be fully general, the code gets a little more complicated, as is shown below. If you don't have to worry about primitives (which depends on your usage) or if you don't have to worry about interfaces or superclasses, then you can simplify the example below.

Also, if you can guarantee that there will be no overlap in interfaces or superclasses in the arguments that you have to worry about, you can move all of the complicated logic into initialization (which doesn't matter if it takes 1 ms longer). In this case, all of the logic in `findMethodToInvoke()` would be moved into the constructor, where you would loop over all interfaces and superclasses of each method you find and add them to your parameterTypeMap. If you do this optimization, then `findMethodToInvoke()` becomes a single line:

```
return parameterTypeMap.get(test.getClass()); 
```

but without this optimization and with full generality, here's my example of how to do this:

```
import java.lang.reflect.*;
import java.util.*;

public class Test {
  private final Map<Object, Method> parameterTypeMap = new HashMap<Object, Method>();

  private final Object[] tests = {Double.valueOf(3.1415),
                                  Boolean.TRUE,
                                  new Date(),
                                  new GregorianCalendar(),
                                  new HashMap<Object, Object>()};

  public Test() {
    Method[] methods = Setters.class.getMethods();
    for (Method method : methods) {
      if (method.getName().equals("setCellValue")) {
        Class<?>[] clazzes = method.getParameterTypes();
        if (clazzes.length != 1) {
          continue;
        }
        if (clazzes[0].isPrimitive()) {
          handlePrimitive(method, clazzes[0]);
        }
        parameterTypeMap.put(clazzes[0], method);
      }
    }
  }

  // See http://java.sun.com/javase/6/docs/api/java/lang/Class.html#isPrimitive()
  private void handlePrimitive(Method method, Class<?> clazz) {
    if (clazz == Boolean.TYPE) {
      parameterTypeMap.put(Boolean.class, method);
    } else if (clazz == Double.TYPE) {
      parameterTypeMap.put(Double.class, method);
    } // ... and so on for the other six primitive types (void doesn't matter)
  }

  public void doTests(Setters setter) {
    for (Object test : tests) {
      Method method = findMethodToInvoke(test);
      if (method == null) {
        System.out.println("Nothing found for " + test.getClass());
        continue;
      }

      try {
        method.invoke(setter, test);
      } catch (Exception e) {
        e.printStackTrace();
      }
    }
  }

  private Method findMethodToInvoke(Object test) {
    Method method = parameterTypeMap.get(test.getClass());
    if (method != null) {
      return method;
    }

    // Look for superclasses
    Class<?> x = test.getClass().getSuperclass();
    while (x != null && x != Object.class) {
      method = parameterTypeMap.get(x);
      if (method != null) {
        return method;
      }
      x = x.getSuperclass();
    }

    // Look for interfaces
    for (Class<?> i : test.getClass().getInterfaces()) {
      method = parameterTypeMap.get(i);
      if (method != null) {
        return method;
      }
    }
    return null;
  }

  public static void main(String[] args) {
    Test test = new Test();
    test.doTests(new Setters());
  }
}

class Setters {
  public void setCellValue(boolean value) {
    System.out.println("boolean " + value);
  }

  public void setCellValue(double value) {
    System.out.println("double " + value);
  }

  public void setCellValue(Calendar value) {
    System.out.println("Calendar " + value);
  }

  public void setCellValue(Date value) {
    System.out.println("Date " + value);
  }

  public void setCellValue(Map<?, ?> value) {
    System.out.println("Map " + value);
  }
} 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-03-30T17:38:40.693

我认为这`instanceof`是要走的路。如果您认为它使您的代码难看，则将`instanceof`表达式提取到辅助方法中：

```
public void setCellValue(HSSFCell cell, Object value) {
    if (null == cell)
        throw new IllegalArgumentException("cell");
    if (null == value)
        throw new IllegalArgumentException("value");
    if (value instanceof Double)
        cell.setCellValue((Double)value); // auto-boxing will handle this
    else if (value instanceof Boolean) {
        cell.setCellValue((Boolean)value); // auto-boxing will handle this
    } else if (value instanceof Calendar) {
        cell.setCellValue((Calendar)value);
    } else if ...
        .....
    } else {
        throw new UnsupportedTypeException("Object of class " + Value.class.getName() + " not supported.");
    }
} 
```

Alternately you can use reflection. Even with reflection *I think* you still have to do some customization for the primitive types because the auto-boxing doesn't work for `getMethod()` ...

```
public void invokeSetCellValue(HSSFCell cell, Object obj) {
    try {
        Class<?> clazz = obj.getClass();
        if (obj instanceof Double) {
            clazz = double.class;
        } else if (obj instanceof Boolean) {
            clazz = boolean.class;
        }
        Method m = HSSFCell.class.getMethod("setCellValue", clazz);
        m.invoke(cell, obj);
    } catch (SecurityException e) {
    } catch (NoSuchMethodException e) {
    } catch (IllegalArgumentException e) {
    } catch (IllegalAccessException e) {
    } catch (InvocationTargetException e) {
    }

} 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-03-30T17:52:25.607

If you don't have subclasses (you can still do it if you do, but it will be harder, let me know if you do) you could use reflection:

```
import java.lang.reflect.InvocationTargetException;
import java.lang.reflect.Method;

public class Main
{
    public static void main(final String[] argv)
        throws NoSuchMethodException,
               IllegalAccessException,
               IllegalArgumentException,
               InvocationTargetException
    {
        final Object o;

        if(argv.length == 0)
        {
            o = "Hello";
        }
        else
        {
            o = Integer.valueOf(42);
        }

        callFoo(o);
    }

    private static void callFoo(final Object o) 
        throws NoSuchMethodException,
               IllegalAccessException,
               IllegalArgumentException,
               InvocationTargetException
    {
        Method method;

        method = Main.class.getDeclaredMethod("foo", o.getClass());
        method.invoke(null, o);
    }

    private static void foo(final String val)
    {
        System.out.println("foo(String) -> " + val);
    }

    private static void foo(final Integer val)
    {
        System.out.println("foo(Integer) -> " + val);
    }
} 
```

The downside is that you don't have the compiler tell you if you try to call a method that does not exist.

The exception handling in the code above is utter crap, but I wanted to focus on the reflection part.

Using instance of is better from the point of view that it has compile time type safety. Reflection will not have to be updated if new methods are added.

# vbscript - 找不到电机指令

> ID：698182
> 
> 赞同：1
> 
> 时间：2009-03-30T17:28:01.170
> 
> 标签：vbscript

我有一台运行 .vbs 登录脚本的西班牙语 XPSP2 机器，该脚本收到以下错误

"No se encuentra el motor de secuencias ds commandos "VBscript" para la secuncia"

粗略的翻译是

“找不到secuncia的电机命令序列ds“VBscript””

有没有人知道这个错误可能指的是什么？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-03-30T17:41:01.547

这不是“马达”，而是脚本“引擎”： http:
[//support.microsoft.com/kb/222837/es](http://support.microsoft.com/kb/222837/es)
[http://support.microsoft.com/kb/222837/en](http://support.microsoft.com/kb/222837/en)

（链接显示翻译。我不确定它们是否与您的问题有关。）

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-03-30T17:36:25.020

如果您有权访问脚本，则可以在脚本的各个部分添加 msgbox() 以尝试查看失败的特定行。这就是我解决 vbscripts 问题的方式。有更优雅的方式来进行调试，但它又快又脏。只记得之后删除它们。=)

所以...

Msgbox("Phase1") Msgbox("Phase2") Msgbox("Phase3") Msgbox("Phase4")

因此，如果第 2 阶段出现在错误消息之前，则表示问题出现在第 2 阶段之后但在第 3 阶段之前。将代码之间的 msgbox 隔开。一旦隔离了该区域，您就可以非常具体地了解 msgbox 的位置，并找到导致问题的确切行。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-03-30T17:41:34.807

[您可能会遇到此线程](http://www.baluart.net/articulo/como-actualizar-el-windows-pirata)上讨论的问题。如果你的西班牙语很弱，pirata 就是“盗版”。

# language-agnostic - 区分音乐文件中的乐器

> ID：698191
> 
> 赞同：17
> 
> 时间：2009-03-30T17:28:48.127
> 
> 标签：language-agnostic

给定一个音乐文件，是否可以拆分正在播放的每个乐器？即假设我有一些Song.mp3，在那首歌中有人声、吉他、贝斯和鼓。我想要 4 个“轨道”——每个不同的乐器一个。

我猜想这样做几乎是不可能的，因为乐器可以重叠，而且要区分重叠的声音是出了名的困难，更不用说乐器了。

**但是**，是否有一个库、一个算法或某种方式来做到这一点，我很想知道如何做。

* * *

## 回答 #1

> 赞同：30
> 
> 时间：2009-03-30T18:14:24.477

我的本科项目涉及将音符从 WAV 文件转录为 MIDI 文件。我们只处理一种乐器的简单情况，可能一次演奏多个音符（例如钢琴）。我们在开始之前对该主题的研究表明，即使是*这种*（即只有一种仪器）也被认为是不平凡的。基本上，问题是：

*   找出在任何给定时间播放的频率。这可以通过一次一个小窗口的 DFT/FFT 来完成。
*   使用一些启发式方法来猜测哪些频率是同一个音符的和声，哪些属于不同的音符。如果您知道演奏的是什么乐器，这*可能*很容易，但在一般情况下很难，因为每个和声的幅度因乐器而异。例如，您可能有两个 C 与一个乐器相差一个八度，或者您可能有一个 C 但来自不同的乐器。
*   在您知道每次播放的音符后，您必须猜测音符何时中断。你可以有一个长音符或一系列短音符。根据您用于初始 DFT 的窗口大小，您可能会在此处得到不同的结果。

现在，如果您一次拥有一种以上的乐器，并且没有两个同时演奏相同的音符或和声，您*可能*能够使用一些关于和声幅度或序列的启发式方法来区分这些乐器他们正在演奏的音符。很可能会有两种乐器演奏同一个音符的时候。那么你真的没有办法决定是否有（a）一种乐器演奏音符，（b）两种乐器以相同的音量演奏，（c）一种演奏柔和而另一种演奏大声或（d）任何的组合。

无论如何，这是要解决的问题的简短列表。我不知道在一般情况下有什么算法可以解决这个问题。我认为这个问题还没有解决。

**编辑：** 我的项目演示可以在[http://www-sipl.technion.ac.il/new/Archive/Special_Events/sipl2004/Projects_PowerPoint/WAV-to-MIDI.pdf找到](http://www-sipl.technion.ac.il/new/Archive/Special_Events/sipl2004/Projects_PowerPoint/WAV-to-MIDI.pdf)

* * *

## 回答 #2

> 赞同：10
> 
> 时间：2009-04-16T09:03:47.887

我实际上遇到了一个非常有趣的算法，称为[ICA](http://en.wikipedia.org/wiki/Independent_component_analysis)（独立分量分析）。该算法背后的概念并非来自信号处理领域，而是来自概率论。我们用它来分离混合成单个 mp3 文件的两首歌曲。您可以在 Matlab\C++\Python 中找到一个名为 FastICA 的实现[库](http://www.cis.hut.fi/projects/ica/fastica/)。试一试，真的很不错。

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2009-03-30T17:32:31.893

每个乐器都有一个特征性的杂散振荡，因此如果您隔离单个音符（使用 DFT/FFT）并比较该时间点的其他频率，您至少可以区分不同类型的乐器。

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2009-03-30T17:32:01.897

最简单的方法是首先单独维护乐器，这就是为什么许多中间音乐处理应用程序使用 MIDI 以抽象形式将乐器消息存储在单独的轨道上的原因。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2009-03-30T17:55:11.417

长话短说：除非你的四个乐器是合成器，播放纯正弦波，否则你不能。

* * *

## 回答 #6

> 赞同：-1
> 
> 时间：2009-03-30T17:40:05.713

mp3 是一种有损格式。它的工作原理是对人的声学响应进行建模，并丢弃它认为人听不到的信息。从本质上讲，响亮的乐器会盖过柔和的乐器 - 更柔和的乐器会被抛弃。这意味着您永远无法提取最初进入 mp3 的内容，更不用说分离乐器了。

我有一个朋友是音响工程师，他总是对要求他重新设计录制为 mp3 的曲目的人说“不”。

几周前，我看到一项研究表明，年轻一代实际上更喜欢 mp3 的声音，而不是更完整的格式，因为这是他们长大的。

# vb.net - Vista + VB.NET - 写入 HKEY_LOCAL_MACHINE 时访问被拒绝

> ID：698193
> 
> 赞同：1
> 
> 时间：2009-03-30T17:29:36.800
> 
> 标签：vb.net, exception, windows-vista, registry, uac

我希望我的程序能够编辑位于“HKEY_LOCAL_MACHINE”中的注册表项中的值

```
 My.Computer.Registry.SetValue("HKEY_LOCAL_MACHINE\SOFTWARE\XYZ", "MyValue", "MyData") 
```

以上在 Windows XP 中运行良好，但在 Vista 中抛出 UnauthorizedAccessException。

* * *

## 回答 #1

> 赞同：8
> 
> 时间：2009-03-30T17:33:01.940

您遇到了 Vista 的 UAC 功能。它不会让您写入 HKLM 配置单元中的任意位置，因为您没有以管理权限运行。

有两种方法可以解决此问题

1.  以管理权限运行程序（不同于以具有管理权限的帐户运行程序）
2.  选择另一个地方，也许是 HKCU，来存储数据

第二个选项要好得多，因为它允许您的应用程序以您不能总是假设您的用户拥有的非管理员权限运行。

这是一篇关于 UAC 的相当详细的文章。它不是 100% 的编程材料，但它很好地解释了它到底是什么，您可以希望将其与您的特定程序联系起来：[http ://technet.microsoft.com/en-us/library/cc709691.aspx](http://technet.microsoft.com/en-us/library/cc709691.aspx)

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2009-03-30T17:43:05.333

由于对本地计算机配置单元的更改可能会影响整个系统，您会发现对它的更改仅限于非管理员用户。如果您尝试在 XP 机器上以非管理员帐户运行相同的代码，您将收到相同的错误。在 Vista 上，由于默认情况下该过程是非管理员的，因此您会收到此错误。有关这方面的信息在“Made for Windows 2000”、“Made for Windows XP”和“Made for Windows Vista”认证指南中。

鉴于我对您的程序正在做什么的信息很少，可能需要更多信息来为您提供具体指导，所以我将在一般情况下发言。您希望您的应用程序不理会本地计算机配置单元，除非您需要它。当您的程序在非管理员模式下运行时，您可以禁用需要访问这些管理员密钥的功能，或者您可以请求管理员权限。

* * *

## 回答 #3

> 赞同：-1
> 
> 时间：2009-03-30T17:33:09.850

Vista 对管理员帐户有更严格的限制。如果您没有以管理员帐户登录，则必须写入 HKEY_CURRENT_USER 而不是 HKEY_LOCAL_MACHINE。

IMO，这更有意义。每个用户都有自己的程序设置/等。如果*要*为程序进行全局设置，则必须使用管理员帐户进行。

# algorithm - 检测拼写错误的单词

> ID：698196
> 
> 赞同：9
> 
> 时间：2009-03-30T17:30:59.637
> 
> 标签：algorithm, language-agnostic, spell-checking, search-suggestion

我有一个机场名称列表，我的用户可以输入一个机场名称来选择它以进行进一步处理。

您将如何处理拼写错误的名称并提供建议列表？

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2009-03-30T17:34:21.983

查找[Levenshtein 距离](http://en.wikipedia.org/wiki/Levenshtein_distance)以匹配给定用户输入的正确名称。

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2009-03-30T21:28:06.540

[http://norvig.com/spell-correct.html](http://norvig.com/spell-correct.html)
做了类似 levenshtein 的事情，但是因为他没有一路走下去，所以效率更高

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2009-03-30T17:42:35.410

在您的代码中使用拼写检查。单词列表应仅包含正确的机场拼写。

这不是一个很好的方法。您应该选择提供自动完成选项的控件或其他人建议的下拉菜单。

如果您的技术支持，请使用 AJAX。

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2009-03-31T15:29:37.687

我知道这不是您所要求的，但如果这是一个需要正确机场的应用程序（例如预订机票），那么您可能需要一个确认阶段以确保您拥有正确的机场。例如，有些人买[错了悉尼](http://www.irastimes.org/thegreatmixup.htm)的票。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2009-03-30T17:35:30.967

让用户从机场名称列表中选择而不是让他们自己输入可能会更好。这样就不会犯错。

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2009-03-30T17:35:53.320

虽然它不会立即提供帮助，但您可以跟踪拼写错误，并在输入正确名称时查看他们最终输入的名称。这样您就可以跟踪最常见的拼写错误，并提供最佳选择。

* * *

## 回答 #7

> 赞同：0
> 
> 时间：2009-03-30T19:27:19.747

除了 Kevin 的建议之外，如果您使用带有 javascript 自动完成功能的输入框，这可能是两全其美的选择。比如[jquery自动完成](http://www.pengoworks.com/workshop/jquery/autocomplete.htm)

编辑：丹麦打败了我:(

* * *

## 回答 #8

> 赞同：0
> 
> 时间：2009-03-30T21:18:16.203

您可以使用现有的拼写检查库。做好这类事情的代码并不简单。如果您确实想自己编写，您可能需要查看[字典 trie's](http://en.wikipedia.org/wiki/Trie#Dictionary_representation)。

一种可能有效的方法是只生成大量可能的错误词及其更正（这里是[Python 中的实现](http://www.norvig.com/spell-correct.html)），您可以将其缓存以获得更高的性能。

# php - 导航表 - 需要来自两个不同表的信息

> ID：698198
> 
> 赞同：0
> 
> 时间：2009-03-30T17:31:16.360
> 
> 标签：php, navigation

你好 PHP 新手，有点束缚。我需要显示导航栏 PID = "nid" nid 是我所在的页面，所以说我在页面 A 上，页面 A 有 5 个子导航类别（子 ID），然后它们将显示在左侧。我的问题是 cid 及其名称在两个不同的表上..（表列在底部）谢谢

$navQuery = 'SELECT * FROM tblnavpc WHERE PID = \''.$nid.'\''; $navQueryResults = mysql_query($navQuery) 或死(mysql_error());

```
$numNavItems = mysql_num_rows($navQueryResults);    echo'<tr>
<td>align="left" valign="top" class="medium"><h1>'. $NavName .'</h1></td>
     /tr>';
// echo '<br>Nav Items'.  .'<br>';

for($i = 0; $i < $numNavItems; $i++){
    $childName = mysql_result($getResults1,$i,"NavName");
    $childNavID = mysql_result($navQueryResults,$i,"cID");
    echo ' 
```

align="left" valign="top" class="medium">
href="cat_ap~pnid~'.$nid.'~nid~'.$childnavID.'~post.htm">'.$childName.'

```
 </tr>';

} 
```

表：tblNavPC
pcid（父子id）
pid（父id）
cid（子id）
相关navpcdate

表：tblNav
NavID
NavName
NavDisplayName

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2009-03-30T17:38:55.840

听起来你只是在寻找加盟。您的查询应该是这样的：

```
SELECT n.NavDisplayName
FROM tblNavPC AS pc
    LEFT JOIN tblNav AS n ON n.NavID = pc.cid
WHERE pc.pid = $nid; 
```

（根据需要更改 SELECT 子句以获取您需要的信息）

# c# - 如何在代码中设置指向文本框的超链接。- 与其他 HTML 标签

> ID：698212
> 
> 赞同：2
> 
> 时间：2009-03-30T17:34:58.177
> 
> 标签：c#, asp.net, html, vb.net

我想在文本框中显示的代码

```
<a href="http://www.erate.co.za/CompanyProfile.aspx?ID=112">
<img   src="http://www.erate.co.za/CompanyAdd.bmp" alt="Go rate us on www.eRate.co.za" 
border="0" style="width: 136px; height: 88px" /></a> 
```

但我从这样的读者那里得到了身份证

```
reader.Item("ID").ToString 
```

现在我想将 txtCode.text 设置为此，但它不起作用

```
txtCode.Text = "<a href="http://www.erate.co.za/CompanyProfile.aspx?ID=" +  
reader.Item("ID").ToString + ">
<img  src="http://www.erate.co.za/CompanyAdd.bmp" alt="Go rate us on www.eRate.co.za"
border="0" style="width: 136px; height: 88px" /></a>" 
```

我该怎么做？

艾蒂安

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-03-30T17:59:24.247

在 VB 中，引号字符用另一个引号转义：

```
txtCode.Text = "<a href=""http://www.erate.co.za/CompanyProfile.aspx?ID=" & reader.Item("ID").ToString() & ">"
txtCode.Text &= "<img src=""http://www.erate.co.za/CompanyAdd.bmp"" alt=""Go rate us on www.eRate.co.za"" border=""0"" style=""width: 136px; height: 88px"" /></a>" 
```

我怎么知道它是 VB 而不是 C#？

因为这条线适合你：

```
reader.Item("ID").ToString 
```

在 C# 中，它必须是：

```
reader.Item["ID"].ToString() 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-03-30T17:39:30.503

```
txtCode.Text = @"<a href=""http://www.erate.co.za/CompanyProfile.aspx?ID=" +  
reader.Item("Desc_Work").ToString() + @">
<img  src=""http://www.erate.co.za/CompanyAdd.bmp"" alt=""Go rate us on www.eRate.co.za""
border=""0"" style=""width: 136px; height: 88px"" /></a>"; 
```

试试看，看看是否有效。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-03-30T17:53:21.937

我认为您的问题与引号有关，请在 VB.NET 中尝试：

```
txtCode.Text = "<a href='http://www.erate.co.za/CompanyProfile.aspx?ID=" 
& reader.Item("ID").ToString 
& "><img  src='http://www.erate.co.za/CompanyAdd.bmp' alt='Go rate us on www.eRate.co.za' border='0' style='width: 136px; height: 88px' /></a>" 
```

**使用 : \"**转义所有引号，或使用单引号代替双引号。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2009-03-30T17:54:08.317

您可以将您的图像和链接组合成一个 asp:Imagebutton 而不是一个普通的旧 HTML 锚标记，并从 onClick 处理程序后面的代码动态设置链接地址，如下所示：

.aspx：

```
<asp:ImageButton ImageUrl="http://www.erate.co.za/CompanyAdd.bmp" onClick="imgBtnClick" id="ibRateUs" runat="server" /> 
```

。CS：

```
public void imgBtnClick(Object sender, System.EventArgs e)
{
    String url = "http://www.erate.co.za/CompanyProfile.aspx?ID=" + reader.Item("Desc_Work").ToString;
    Response.Redirect(url, false);
} 
```

VB中相同的后端代码：

```
public sub imgBtnClick(sender as Object, e as System.EventArgs)
    Dim url as String = "http://www.erate.co.za/CompanyProfile.aspx?ID=" + reader.Item("Desc_Work").ToString
    Response.Redirect(url, false)
end sub 
```

如果 ImageButton 超出点击处理程序的范围，您可能需要将您的 ID 作为命令参数传递给它。

与替换文本框中的文本相比，此设置可能更具可读性和灵活性。

希望这可以帮助。

# browser - Cookie、HTTP GET 和查询字符串

> ID：698214
> 
> 赞同：-1
> 
> 时间：2009-03-30T17:35:20.030
> 
> 标签：browser, get, httpcookie

美国纽约南区地方法院在 Doubleclick Inc. 案中指出：

“GET 信息作为网站地址或“URL”的一部分提交，称为“查询字符串”。例如，假设在线唱片店选择 Bon Jovi 专辑的请求可能是：[http:// /recordstore.hypothetical.com/search?terms=bonjovi](http://recordstore.hypothetical.com/search?terms=bonjovi) . URL 查询字符串以“?”字符开头，这意味着 cookie 将记录用户请求的有关 Bon Jovi 的信息。

带有“？”的 URL 查询字符串是真的吗？cookie 会记录用户请求的信息吗？如果是这样，什么 RFC/标准包括这个？

编辑：我知道美国地方法院没有定义标准，但我想具体说明一下它们是不正确的。

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2009-03-30T17:43:35.457

如果你阅读[**整个文件**](http://cyber.law.harvard.edu/is02/readings/doubleclick.html)，你会注意到他们说

> **DoubleClick 的 cookie**仅从上述过程的一个步骤收集信息：第一步。Cookie**会捕获用户发送到 DoubleClick 附属网站的通信的某些部分。**他们通过三种方式收集这些信息：**(1)“GET”提交**，(2)“POST”提交，和(3)“GIF”提交。

**他们描述的是 DoubleClick 使用的流程，而不是互联网标准。**

您（以及任何其他人，包括 DoubleClick）可以获取您可用的信息（包括可能作为 GET 提交的一部分发送的信息）并将其存储在 cookie 中。

您应该像这样解释有问题的句子（在[**上下文中**](http://cyber.law.harvard.edu/is02/readings/doubleclick.html)）：

1.  DoubleClick 将来自查询字符串的信息存储在 cookie 中。
2.  URL 查询字符串是 URL 中以“？”开头的部分。特点。
3.  假设 URL 的查询字符串部分是“Bon Jovi”。
4.  DoubleClick 的流程将使用 cookie 来记录用户请求的有关 Bon Jovi 的信息

**支持的结论：**

DoubleClick 从 URL 查询字符串（以“?”开头的 URL 部分）获取/获取信息，并使用 cookie 记录用户请求的信息。

**不支持的结论：**

带有“？”的 URL 查询字符串 会让cookie记录用户请求的信息。存在一些描述此行为的 RFC。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2009-03-30T17:39:27.820

将查询字符串存储在 cookie 中当然是可能的，但没有技术标准强制这种情况发生。

他们可能引用了特定网站上代码的特定内容，这可能是将查询字符串存储在 cookie 中。

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2009-03-30T17:41:04.853

Cookie 与 URL 分开设置和提交，因此在 HTTP 标头中它看起来像这样：

`GET /search?terms=bonjovi
Cookie: $Version=1; UserId=JohnDoe`

将查询字符串存储在 cookie 中的唯一方法是，如果 cookie 路径与重写的 URL 结合使用，或者服务器明确设置具有某种 id 或查询字符串的 cookie。

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2009-03-30T17:38:31.100

上次我查了一下，纽约南区的美国地方法院没有定义互联网标准。

查询字符串不会影响 cookie，它们以草率的方式使用技术语言。

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2009-03-30T17:40:21.097

该文本可能只是一个示例，您不应拘泥于此。

在查询字符串中包含任何文本并不意味着使用该信息创建 cookie，尽管某些站点可能包含额外的代码来执行此操作。

# model-view-controller - MVC 与 n 层架构

> ID：698220
> 
> 赞同：147
> 
> 时间：2009-03-30T17:36:08.577
> 
> 标签：model-view-controller, n-tier-architecture

我想知道 MVC（这是一种架构模式）和应用程序的 n 层架构之间到底有什么区别。我搜索了它，但找不到简单的解释。可能是我对 MVC 概念有点天真，所以如果有人能解释其中的区别，那就太好了。

干杯

* * *

## 回答 #1

> 赞同：104
> 
> 时间：2009-03-30T17:42:14.180

N 层架构通常具有由网络分隔的每一层。IE表示层在一些Web服务器上，然后通过网络与后端应用程序服务器进行业务逻辑通信，然后再通过网络与数据库服务器通信，并且可能应用程序服务器还调用一些远程服务（说 Authorize.net 进行付款处理）。

MVC 是一种编程设计模式，其中不同部分的代码负责表示某些应用程序中的模型、视图和控制器。这两件事是相关的，因为例如模型层可能有一个内部实现，它调用数据库来存储和检索数据。控制器可以驻留在网络服务器上，并远程调用应用服务器来检索数据。MVC 抽象出应用程序架构如何实现的细节。

N 层仅指实现的物理结构。这两者有时会混淆，因为 MVC 设计通常是使用 N 层架构实现的。

* * *

## 回答 #2

> 赞同：46
> 
> 时间：2010-07-14T15:50:26.433

如果 3 层设计是这样的：

```
Client <-> Middle <-> Data 
```

MVC 模式将是：

```
 Middle
     ^    |
     |    v
Client <- Data 
```

意思是：

*   在 3 层等效中，层之间的通信是*双向的*，并且*总是通过中间层*
*   在 MVC 等效项中，通信是*单向*的；我们可以说*每个“层”都由左边的那个更新，然后又更新右边的那个*——其中“左”和“右”只是说明性的

PS*客户端*将是*视图*和*中间**控制器*

* * *

## 回答 #3

> 赞同：32
> 
> 时间：2010-01-04T15:19:27.553

这就是[![](https://t2.gstatic.com/images?q=tbn:psymCE6r9Ee7KM:http://www.veryicon.com/icon/preview/Application/Apollo/Wikipedia%2520Icon.jpg)](http://en.wikipedia.org/wiki/Main_Page)关于[n 层架构的说法](http://en.wikipedia.org/wiki/Multitier_architecture)

> 乍一看，这三层似乎类似于 MVC（模型视图控制器）的概念；但是，在拓扑上它们是不同的。三层架构中的一个基本规则是客户端层从不直接与数据层通信。在三层模型中，所有通信都必须通过中间件层。从概念上讲，三层架构是线性的。但是，MVC 架构是三角形的：View 向 Controller 发送更新，Controller 更新 Model，而 View 直接从 Model 更新。

* * *

## 回答 #4

> 赞同：18
> 
> 时间：2011-03-23T17:17:24.530

唯一的相似之处是这两种模式在它们的图表中有三个方框。从根本上说，它们的用途完全不同。事实上，使用哪种模式通常不是一个选择，但两种模式可以和谐地一起使用。这是两者的一个很好的比较：http: [//allthingscs.blogspot.com/2011/03/mvc-vs-3-tier-pattern.html](http://allthingscs.blogspot.com/2011/03/mvc-vs-3-tier-pattern.html)

* * *

## 回答 #5

> 赞同：6
> 
> 时间：2010-02-16T10:10:24.390

三层架构的一个基本规则是客户端层从不直接与数据层通信。在三层模型中，所有通信都必须通过中间件层。

它是线性架构。这解决了如何在用户和数据库之间传递信息的问题。MVC 是三角架构：View 向 Controller 发送更新，Controller 更新 Model，View 直接从 Model 更新。这解决了用户界面如何管理屏幕上的组件的问题。

* * *

## 回答 #6

> 赞同：6
> 
> 时间：2010-11-16T06:33:33.580

@Cherry Middle ware 更像是 MVC 模式中的请求处理程序或重定向器。

我想解释一下 MVC，根据我的说法，模型视图控制器是这样工作的。

1.  客户端通过请求任何服务来启动会话。
2.  此请求由控制器（请求处理程序、重定向器等）接收和处理
3.  控制器处理请求的基本信息并将其重定向到可以填充数据请求的相关模型。
4.  模型根据Controller传递的参数填充请求并将结果发送回Controller。（注意：这里我想明确一点，在真正的 MVC 架构中，数据不会直接返回给客户端，而是填满并返回给控制器。）
5.  控制器而不是将该数据发送到视图（客户端）。
6.  客户面前有请求的服务。

这就是我所知道的关于 MVC 的全部内容。

* * *

## 回答 #7

> 赞同：6
> 
> 时间：2014-12-18T09:33:03.223

让自己休息一下。在解决实际问题时，不要将自己限制在某些模式中。只要记住一些一般原则，其中之一就是关注点*分离*。

* * *

## 回答 #8

> 赞同：5
> 
> 时间：2010-12-28T16:20:04.813

N 层架构最好使用部署图来定义。

最好使用序列图来定义 MVC 架构。

两者不同且不相关，您可以将两种架构组合在一起。许多公司已采取措施创建 N 层架构，不仅用于部署和可扩展性，还用于代码重用。

例如，您的业务实体对象可能需要由桌面应用程序、为客户端公开的 Web 服务、Web 应用程序或移动应用程序使用。简单地使用 MVC 方法根本不会帮助您重用任何东西。

* * *

## 回答 #9

> 赞同：5
> 
> 时间：2011-07-18T18:47:18.677

除了线性之外，这里没有足够强调的另一个主要区别是，在 N 层模型中，N 不一定是 3 层！它通常被实现为三层（表示、应用程序、数据），中间层有两个子层（业务逻辑和数据访问）。此外，MVC 中的模型可以包含用于数据操作的数据和业务逻辑，而这些将位于 n 层中的单独层中。

* * *

## 回答 #10

> 赞同：3
> 
> 时间：2010-12-29T08:51:03.630

结论：N-tier 是一种架构，MVC 是一种设计模式。它们是应用于两个不同领域的相同隐喻。

* * *

## 回答 #11

> 赞同：2
> 
> 时间：2009-09-14T14:29:11.277

Jerry：这是一个简单的例子，说明两者之间的关系：

* * *

**第 1 层**- 由通过某种网络服务或类似的控制器与第 2 层通信的模型组成，以处理输入验证、计算和其他与视图相关的事情。当然，它还包含视图本身——它可以是桌面应用程序中的 GUI，也可以是网络应用程序中的网络界面。

* * *

**第 2 层**- 包含某种服务或从第 1 层接收消息的其他方式。不/不应该知道第 1 层，因此只能接听来自上面的电话 - 永远不要自己要求。还包含所有业务逻辑。

* * *

**第 3 层**- 包含域模型、数据库的对象表示以及用于通信和更新数据库条目的所有逻辑。

* * *

## 回答 #12

> 赞同：2
> 
> 时间：2016-05-26T10:29:29.877

在三层模型中，所有通信都必须通过中间层。从概念上讲，三层架构是线性的。然而，[model-view-controller] MVC 架构是三角形的：视图向控制器发送更新，控制器更新模型，视图直接从模型中更新。

* * *

## 回答 #13

> 赞同：0
> 
> 时间：2021-10-28T12:01:48.327

N 层架构从不直接与数据访问层通信。在 3 层架构中：

*   表示层呈现相关的 UI，
*   业务层包含相关的逻辑和
*   然后是数据访问层。

所有数据都通过中间层进行通信。演示文稿 <-> 业务 <-> 数据。

MVC（模型-视图-控制器）架构是三角形的。

*   视图向控制器发送更新，
*   控制器更新模型和
*   然后 View 直接从模型中获取更新。

模型（数据）、视图（UI）、控制器（逻辑）。

# vpc - 回收差分 VHD 中的空间

> ID：698222
> 
> 赞同：2
> 
> 时间：2009-03-30T17:36:43.240
> 
> 标签：vpc

[http://www.petri.co.il/virtual_creating_differencing_disks_with.htm](http://www.petri.co.il/virtual_creating_differencing_disks_with.htm)

我按照这些步骤从 microsoft 创建了 WSSv3 演示 VHD 的“差异磁盘”。好一段时间过去了，忘记了它是一个“差异”磁盘，并且在进行碎片整理时，VUD（虚拟撤消磁盘）扩展以消耗我硬盘驱动器上剩余的可用空间。

除了将这些更改提交回原始 VHD 文件之外，它们是我缩小 VUD 的任何其他方式吗？

谢谢

[更新]

不幸的是，更改历史似乎保留了对文件的每次更改，甚至是文件碎片（为什么）。

```
org -> verA -> verB -> verC -> verD -> verE -> current. 
```

一个工具可以很好地将历史树折叠为**org -> current**并删除/忽略其间的更改历史记录以及对更改日志进行碎片整理以进行优化。

[更新#2]

首先，对不起我的问题的扩展

其次，是否可以通过将差异磁盘与其差异父磁盘合并来缩小差异磁盘。

```
Base.VHD
 -> Child.VHD (Differential)
   -> Grandchild.VHD (Differential) 
```

在将孙子与子合并时，大小将是 [子大小] + [孙子大小] 还是类似于 [子大小] + [孙子中实际文件差异的大小]？

再次感谢。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-03-30T19:10:12.127

差异磁盘记录了碎片整理程序所做的每一次更改，这就是它失控的原因。我怀疑您是否可以缩小它，因为它包含已进行但尚未提交的更改。

我认为您将不得不将更改提交到原始 VHD，或者丢弃所有更改。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2009-04-02T10:37:41.057

谢谢格兰特，你是对的，我被臃肿的 VHD 卡住了要合并，但不知何故设法搞砸了，丢失了更改。

这是我发现的其他内容。

[http://www.invirtus.com/blog/?p=7](http://www.invirtus.com/blog/?p=7)

这是一篇很棒的文章，解释了为什么差异如此之大。显然，每个字节都写入自己的 512 字节扇区，占用大量空间。

[http://www.invirtus.com/downloads/Differencing_Disk_Discussion.ppt](http://www.invirtus.com/downloads/Differencing_Disk_Discussion.ppt)

本演示文稿解释了如何在存储差异磁盘时使用磁盘压缩以及撤消磁盘占用更少的空间。简而言之，将差异 VHD 或 VUD 放入 NTFS 压缩文件夹将为您节省大量空间。

[例子]

我为 Microsoft (5GB) 的 WSSv3 映像创建了一个差异磁盘，启动它并安装了软件。只是引导处理增加了 300mb 到 VHD，安装 TortoiseSVN (20MB) 增加了 200mb，安装 WSPBuilderExtensions (800KB) 增加了 1GB 到 VHD。

最终结果是 1.5GB 与安装 21MB 的差异。我将它与基础合并，结果只将 29MB 添加回父级。

然后，我在 NTFS 压缩文件夹中创建了另一个差异 VHD，启动它并通过 Central Admin 创建了一个新的 WSS Web 应用程序。文件大小跃升至 900MB，但仅导致文件系统上的 90MB 用于 NTFS 压缩。然后我创建了一个 VUD，重命名为 VHD 并完成了相同的操作。文件大小增加到 300MB，导致文件系统占用 12MB。

所以，是的，差分 VHD 非常无效，并且在任何时候都没有智能，但是膨胀允许一些很好的压缩。

For development you should also create a new VHD, attach it as a secondary drive and move your file here since any and every file IO is captured in the differencing or undo disk.

# python - 如何使用python解析包含毫秒的时间字符串？

> ID：698223
> 
> 赞同：237
> 
> 时间：2009-03-30T17:36:53.427
> 
> 标签：python, date, time, datetime-parsing

我能够使用**time.strptime解析包含日期/时间的字符串**

```
>>> import time
>>> time.strptime('30/03/09 16:31:32', '%d/%m/%y %H:%M:%S')
(2009, 3, 30, 16, 31, 32, 0, 89, -1) 
```

如何解析包含毫秒的时间字符串？

```
>>> time.strptime('30/03/09 16:31:32.123', '%d/%m/%y %H:%M:%S')
Traceback (most recent call last):
  File "<stdin>", line 1, in <module>
  File "/usr/lib/python2.5/_strptime.py", line 333, in strptime
    data_string[found.end():])
ValueError: unconverted data remains: .123 
```

* * *

## 回答 #1

> 赞同：373
> 
> 时间：2009-03-30T17:49:33.210

Python 2.6 添加了一个新的 strftime/strptime 宏`%f`。文档有点误导，因为它们只提到微秒，但`%f`实际上解析了*最多6 位的秒的**任何*小数部分，这意味着它也适用于毫秒甚至厘秒或分秒。

 *```
time.strptime('30/03/09 16:31:32.123', '%d/%m/%y %H:%M:%S.%f') 
```

但是，[time.struct_time](https://docs.python.org/3/library/time.html?highlight=struct_time#time.struct_time)实际上并不存储毫秒/微秒。你最好使用`datetime`，像这样：

```
>>> from datetime import datetime
>>> a = datetime.strptime('30/03/09 16:31:32.123', '%d/%m/%y %H:%M:%S.%f')
>>> a.microsecond
123000 
```

如您所见，`.123`正确解释为`123 000`微秒。

* * *

## 回答 #2

> 赞同：12
> 
> 时间：2010-10-12T15:09:19.720

我知道这是一个较老的问题，但我仍在使用 Python 2.4.3，我需要找到一种将数据字符串转换为日期时间的更好方法。

如果 datetime 不支持 %f 并且不需要 try/except 的解决方案是：

```
 (dt, mSecs) = row[5].strip().split(".") 
    dt = datetime.datetime(*time.strptime(dt, "%Y-%m-%d %H:%M:%S")[0:6])
    mSeconds = datetime.timedelta(microseconds = int(mSecs))
    fullDateTime = dt + mSeconds 
```

这适用于输入字符串“2010-10-06 09:42:52.266000”

* * *

## 回答 #3

> 赞同：4
> 
> 时间：2009-03-30T17:48:23.213

给出[nstehr 的答案](https://stackoverflow.com/questions/698223/how-can-i-parse-a-time-string-containing-milliseconds-in-it-with-python/698257#698257)所指的代码（来自[其来源](http://mail.python.org/pipermail/python-list/2006-June/562457.html)）：

```
def timeparse(t, format):
    """Parse a time string that might contain fractions of a second.

    Fractional seconds are supported using a fragile, miserable hack.
    Given a time string like '02:03:04.234234' and a format string of
    '%H:%M:%S', time.strptime() will raise a ValueError with this
    message: 'unconverted data remains: .234234'.  If %S is in the
    format string and the ValueError matches as above, a datetime
    object will be created from the part that matches and the
    microseconds in the time string.
    """
    try:
        return datetime.datetime(*time.strptime(t, format)[0:6]).time()
    except ValueError, msg:
        if "%S" in format:
            msg = str(msg)
            mat = re.match(r"unconverted data remains:"
                           " \.([0-9]{1,6})$", msg)
            if mat is not None:
                # fractional seconds are present - this is the style
                # used by datetime's isoformat() method
                frac = "." + mat.group(1)
                t = t[:-len(frac)]
                t = datetime.datetime(*time.strptime(t, format)[0:6])
                microsecond = int(float(frac)*1e6)
                return t.replace(microsecond=microsecond)
            else:
                mat = re.match(r"unconverted data remains:"
                               " \,([0-9]{3,3})$", msg)
                if mat is not None:
                    # fractional seconds are present - this is the style
                    # used by the logging module
                    frac = "." + mat.group(1)
                    t = t[:-len(frac)]
                    t = datetime.datetime(*time.strptime(t, format)[0:6])
                    microsecond = int(float(frac)*1e6)
                    return t.replace(microsecond=microsecond)

        raise 
```

* * *

## 回答 #4

> 赞同：3
> 
> 时间：2018-11-14T20:28:39.420

[上面的 DNS 答案](https://stackoverflow.com/a/698279/196697)实际上是不正确的。SO询问毫秒，但答案是微秒。不幸的是，Python 没有毫秒指令，只有微秒（参见[doc](https://docs.python.org/2/library/datetime.html#strftime-and-strptime-behavior)），但您可以通过在字符串末尾附加三个零并将字符串解析为微秒来解决它，例如：

```
datetime.strptime(time_str + '000', '%d/%m/%y %H:%M:%S.%f') 
```

where`time_str`格式化为`30/03/09 16:31:32.123`.

希望这可以帮助。

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2009-03-30T17:43:21.760

我的第一个想法是尝试传递它 '30/03/09 16:31:32.123' （在秒和毫秒之间使用句点而不是冒号。）但这不起作用。快速浏览一下文档表明在任何情况下都会忽略小数秒...

啊，版本差异。这被[报告为一个错误](http://www.nabble.com/-issue1982--Feature:-extend-strftime-to-accept-milliseconds-td15212346.html)，现在在 2.6+ 中，您可以使用 "%S.%f" 来解析它。

* * *

## 回答 #6

> 赞同：1
> 
> 时间：2009-03-30T17:43:24.427

来自 python 邮件列表：[解析毫秒线程](http://code.activestate.com/lists/python-list/521885/)。那里发布了一个似乎可以完成工作的功能，尽管正如作者的评论中提到的那样，它有点像黑客。它使用正则表达式来处理引发的异常，然后进行一些计算。

您也可以在将其传递给 strptime 之前尝试预先执行正则表达式和计算。

* * *

## 回答 #7

> 赞同：1
> 
> 时间：2014-11-01T13:36:53.393

对于 python 2，我这样做了

```
print ( time.strftime("%H:%M:%S", time.localtime(time.time())) + "." + str(time.time()).split(".",1)[1]) 
```

它打印时间 "%H:%M:%S" ，将 time.time() 拆分为两个子字符串（之前和之后。） xxxxxxx.xx 并且因为 .xx 是我的毫秒，所以我将第二个子字符串添加到我的 "% H:%M:%S"

希望这是有道理的:) 示例输出：

> 13:31:21.72 眨眼 01
> 
> * * *

13:31:21.81 闪烁结束 01

* * *

13:31:26.3 眨眼 01

* * *

13:31:26.39 闪烁结束 01

* * *

13:31:34.65 出发车道 01

* * *

# asp.net - ASP.NET 页面中的静态数据 - 线程安全？

> ID：698229
> 
> 赞同：1
> 
> 时间：2009-03-30T17:38:19.807
> 
> 标签：asp.net, web-services, session, thread-safety, asmx

这个问题的背景是我需要在（静态）WebMethod 中使用一些用户会话数据。我创建了一个引用我需要的数据的静态属性，如下所示：

```
private static UserWebSession UserWebSession
{
    get
    {
        return (UserWebSession)HttpContext.Current.Session["UserWebSession"];
    }
} 
```

然后我可以在我的页面的静态 WebMethod 中调用它。

我的问题是，这种技术线程安全吗？或者这个属性的值是否会随着每个新的页面请求而更新 - 换句话说，它将返回最近请求页面的用户的 UserWebSession？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2009-03-30T17:40:03.903

很好 -`HttpContext.Current`正是为这类事情设计的。您不会获得以前用户的会话。

虽然它取决于线程（我相信） - 所以如果你启动任何额外的后台线程，他们将无法看到当前上下文。

另请注意，尽管此调用在不获取错误上下文方面是安全的，但当涉及到您对上下文的实际*操作时，通常的并发警告适用。*

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-03-30T17:45:59.617

我不知道页面方法能够访问会话状态。如果可以，那你可能没问题。我记得对 Session 状态的访问是序列化的，因此对于给定的会话，一次只能到达一个请求。

# deployment - 关于 3 个零（0-开发 0-部署 0-管理）的概念，你了解多少？

> ID：698234
> 
> 赞同：0
> 
> 时间：2009-03-30T17:39:10.770
> 
> 标签：deployment

前段时间听说过这个 3 zero-* 的概念，非常喜欢。现在我想更加熟悉这个概念，以及找到源头。

谷歌和其他开发者都无法提供任何额外的细节。

您对 3 个零 * 概念了解多少？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-03-30T17:47:20.640

该术语是在 Ted Neward 的[《基于服务器的 Java 编程》](http://www.amazon.ca/Server-Based-Java-Programming-Ted-Neward/dp/1884777716)一书中创造的。

# vb.net - Vista + VB.NET - 尝试从应用程序中启动/停止 Windows 服务时访问被拒绝

> ID：698245
> 
> 赞同：0
> 
> 时间：2009-03-30T17:40:59.393
> 
> 标签：vb.net, windows-services, windows-vista, service, vista-security

尝试启动/停止我创建的 Windows 服务时，我在 Vista 中收到以下错误。

```
Cannot open ServiceName service on computer '.'. 
```

相同的代码适用于 XP。我应该怎么做才能解决这个问题？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-03-30T18:16:15.173

用户帐户控制（又名 UAC）。UAC 表示用户没有以管理员身份运行。您的应用程序需要告诉 Windows 它需要管理员权限。我认为[这个](http://msdn.microsoft.com/en-us/library/bb756929.aspx)页面比我能更好地解释它。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-07-16T14:28:17.990

今天偶然发现了您的问题，尽管您前一阵子问过这个问题:)
当我尝试启动我开发的基于 .net 的服务时，我在 Windows Vista 上遇到了类似的问题。
我打开了服务的属性对话框并将登录用户更改为本地系统（以前我试图使用网络服务启动服务）。在重新启动服务时，我没有收到任何错误。
如果您仍然想知道答案，这对我有用。我希望它也对你有用。
干杯!

# c# - 在 SQL 中检查行是否已更新的最佳方法

> ID：698254
> 
> 赞同：8
> 
> 时间：2009-03-30T17:43:07.437
> 
> 标签：c#, sql, asp.net, sql-server, tsql

我有一个更新表的更新语句。并且有一列记录了最后修改时间。如果特定行中的数据没有更改，我不想更改上次修改的日期时间。

检查更新语句是否会更改数据行的最佳方法是什么。

谢谢，

* * *

## 回答 #1

> 赞同：9
> 
> 时间：2009-03-30T17:46:22.797

检查代码中的旧数据和新数据，而不是在查询中进行。

如果数据根本没有变化，则无需不必要地打扰 DB 层。

简而言之，如果数据没有改变，就不要发送 UPDATE 语句。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2009-03-30T17:47:53.837

一种方法是启动事务，选择行的内容并将其与您要更新的内容进行比较。如果它们不匹配，则进行更新并结束事务。如果它们匹配，则回滚事务。

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2009-03-30T17:59:32.797

听起来您正在浏览一个表并修改一些行，然后您想再次返回该表并更新刚刚更改的行的时间戳。

不要分两次做。只需在更新您正在更改的任何其他列的同时更新日期/时间：

```
UPDATE myTable
SET retailprice = wholesaleprice * 1.10,
    lastmodified = GetDate()
WHERE ... 
```

或者您是否在所有行上发出更新语句，但对于大多数行，它只是将其设置为它已经拥有的值？不要那样做。排除那些不会在 where 子句中修改的行：

```
UPDATE myTable
SET retailprice = wholesaleprice * 1.10,
    lastmodified = GetDate()
WHERE retailprice <> wholesaleprice * 1.10 
```

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2009-03-30T17:47:48.847

如果您想抢先执行此操作，我能想到的唯一方法是修改 update 语句的 WHERE 子句以比较现有值与新值（对于每个值）。如果其中**任何**一个不相等，则应进行更新。

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2009-03-30T17:48:21.043

这时候 DAL 就派上用场了。它跟踪所有列，因此如果没有更改，那么我什至不会向数据库发送 UPDATE 语句。

* * *

## 回答 #6

> 赞同：1
> 
> 时间：2009-03-30T18:26:47.350

这取决于您是否可以控制数据。上面的 Seb 说你应该在更新之前检查旧数据和新数据是正确的。但是，如果数据不在您的控制之下怎么办？

假设您是一个被要求进行更新的网络服务。那么唯一的检查方法是查询现有数据并将其与新数据进行比较。

不知道有任何 SQL 功能可以检测更新是否实际更改了任何数据。

SQL 中有一些方法可以检测更新语句中包含了多少行。不知道有什么方法可以检测更新语句是否真的改变了任何数据，这会很有趣。

* * *

## 回答 #7

> 赞同：1
> 
> 时间：2011-05-04T05:41:25.393

如果您使用的是 sql 2005/2008，那么您可以在存储过程中执行以下操作。

```
update  newTable 
set     readKey='1'
output  inserted.id,
        inserted.readKey as readKey,
        deleted.readKey as prevReadKey
into @tempTable
where id = '1111' 
```

然后您可以从@tempTable 中选择以验证 prevReadKey 和 readKey 是否具有相似的值，如果两者具有相似的值，您可以重置您上次修改的日期时间。

这样，在值实际发生变化的情况下，您不必在表上触发多个查询。但是是的，在值不变的情况下，这将触发两个不需要的更新语句。如果这些情况很少见，这应该没问题。

PS 注意：- 给出的查询可能在语法上是错误的，因为它没有经过测试。但这是您的问题可以解决的方式。我已经在我的一个项目中使用带有 Merge 语句的 OUTPUT 子句以下列方式完成了它，它也可以用 update 语句来完成。这是[OUTPUT 子句的参考](http://msdn.microsoft.com/en-us/library/ms177523.aspx)

* * *

## 回答 #8

> 赞同：0
> 
> 时间：2009-03-30T18:21:28.390

您可以在 T-SQL 中编写一个 INSTEAD OF UPDATE 触发器，您可以在其中执行上述 DAL 层中建议的操作——比较现有记录中的值与更新语句中的值，然后应用更新或不应用更新. 您可以使用触发器中的 Columns_Updated() 函数来查看是否有任何更新，并相应地继续。

从机器的角度来看，它并不是特别有效，但是您可以编写一次，无论哪个应用程序、存储过程或其他进程尝试更新记录，它都会处理这种情况。

# c++ - 避免在 C++ 中进行空指针检查

> ID：698260
> 
> 赞同：-1
> 
> 时间：2009-03-30T17:44:48.587
> 
> 标签：c++, pointers

用例：

```
class B {

     int b;
     public:
         int getB() { 
               return b;
         }
 };

class A {
        B *b;
    public:
          int getB() {
              if (b ) {                      //How can I avoid the null check for b here
                  return b->getB();
              }
          }
  } 
```

* * *

## 回答 #1

> 赞同：8
> 
> 时间：2009-03-30T17:51:20.680

如果 B 为 null 然后在 getB() 中，您期望会发生什么？如果它不是您的程序的有效状态，只需断言（b！= NULL）。如果它是有效状态，则需要检查。

有些语言支持契约，因此您不需要手动编写检查代码，但不幸的是 C++ 不支持。

* * *

## 回答 #2

> 赞同：6
> 
> 时间：2009-03-30T17:50:16.017

解决方案 1：尽可能使用参考。

解决方案 2：只需执行空指针检查并让编译器处理它们。如今，删除多余的空指针检查是一种标准优化。除了大部分冗余之外，它们没有捕捉到所有的冗余。

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2009-03-30T17:48:55.287

你有很多选择。这里有 5 个。

**解决方案 1：**将 B 的引用传递给 A 而不是指针。

尽管可以引用 NULL 对象。这真的很难做到，你不需要检查它。

```
class A 
{
  B &b;
public:
  A (B& b_) : b(b_)
  {
  }

  int getB() 
  {
    return b.getB();
  }
}; 
```

* * *

**解决方案2：**不要用这个牺牲你的类的关系设计，但它可能是适用的。

从 B 派生类 A。然后您可以简单地调用 getB()。

* * *

**解决方案 3：**也许您根本不应该使用指针，而只是让 B 成为 A 的成员。

```
class A 
{
  B b;

public:
  int getB() 
  {
    return b.getB();
  }
}; 
```

* * *

**解决方案 4：**立即断言以避免以后的检查

```
class A 
{
  B *b;
public:
  A (B* pb) : b(pb)
  {
    assert(pb != NULL);
  }

  int getB() 
  {
    return b->getB();
  }
}; 
```

* * *

**解决方案 5：**有一个您使用的默认 B

```
class A 
{
  B *pb;
  B defaultB;
public:
  A () : pb(&defaultB)
  {
  }

  void setB(B* pb_)
  {
    if(pb != NULL)
      pb = pb_;
  }

  int getB() 
  {
    return pb->getB();
  }
}; 
```

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2009-03-30T17:53:38.613

正如 Brian Bondy 所提到的，参考是一种基于语言的方法。我知道的避免空检查的唯一其他选择是[空对象模式](http://en.wikipedia.org/wiki/Null_object_pattern)。当然，这意味着对如何获取 B 对象进行更多的工作和控制。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2009-03-30T18:01:03.230

```
// case: you expect *b can be 0
class A {
    B *b;
public:
    int getB() {
        return b ? b->getB() : getDefaultValue();
    }
}

// case: there is shouldn't be a chance *b can be 0
class AA {
    B *b;
public:
    AA( B *bValue ):
        b(bValue)
    {
        assert( b );
    }

    int getB() {
        return b->getB();
    }
}; 
```

# java - 如何使用 java.text.MessageFormat 格式化小数百分比

> ID：698261
> 
> 赞同：35
> 
> 时间：2009-03-30T17:45:03.253
> 
> 标签：java, text, localization

我的百分比被默认的 java.text.MessageFormat 函数截断，如何在不丢失精度的情况下格式化百分比？

例子：

```
String expectedResult = "12.5%";
double fraction = 0.125;

String actualResult = MessageFormat.format("{0,number,percent}", fraction);
assert expectedResult.equals(actualResult) : actualResult +" should be formatted as "+expectedResult; 
```

* * *

## 回答 #1

> 赞同：56
> 
> 时间：2009-03-30T18:39:37.193

我认为正确的方法如下：

```
NumberFormat percentFormat = NumberFormat.getPercentInstance();
percentFormat.setMaximumFractionDigits(1);
String result = percentFormat.format(0.125); 
```

它还考虑了内化。例如，在我使用匈牙利语言环境的机器上，我得到了预期的“12.5%”。当然，将 percentFormat 初始化为`NumberFormat.getPercentInstance(Locale.US)`“12.5%”。

* * *

## 回答 #2

> 赞同：53
> 
> 时间：2009-03-30T18:12:58.443

看起来像这样：

```
String actualResult = MessageFormat.format("{0,number,#.##%}", fraction); 
```

... 正在工作中。

编辑：要查看 # 和 % 的解释方式，请参阅 java.text.DecimalFormat 的 javadoc。

编辑2：而且，是的，国际化是安全的。格式字符串中的点被解释为小数分隔符，而不是硬编码的点。:-)

* * *

## 回答 #3

> 赞同：6
> 
> 时间：2009-03-30T18:01:36.067

怎么样

```
DecimalFormat f = new DecimalFormat( "###.#" );
System.out.println( f.format( 12.5 ) ); 
```

char '#' 格式不会将 0 打印为不存在。所以 12.5 ->“12.5”，12.0 ->“12”，而不是“12.0”。您当然可以使用例如“###,###.##”来设置格式化程序，只有在您需要精度时才会显示百位。

* * *

## 回答 #4

> 赞同：2
> 
> 时间：2009-03-30T18:08:45.550

你知道那`"expectedResult == actualResult"`永远是假的，对吧？

无论如何，我能找到的最佳解决方案是明确设置格式化程序。这是我测试的代码：

```
String expectedResult = "12.5%";
double fraction = 0.125;
MessageFormat fmt = new MessageFormat("{0,number,percent}");
NumberFormat nbFmt = NumberFormat.getPercentInstance();
nbFmt.setMaximumFractionDigits(1); // or 2, or however many you need
fmt.setFormatByArgumentIndex(0, nbFmt);
String actualResult = fmt.format(new Object[] {fraction});
assert expectedResult.equals(actualResult) : actualResult +" is getting rounded off"; 
```

* * *

## 回答 #5

> 赞同：2
> 
> 时间：2011-04-20T13:03:58.347

如果国际化是一个问题：

```
// get locale from somewhere. default is usually a bad idea, especially
// if running in a app server
Locale locale = Locale.getDefault();
NumberFormat fmt = NumberFormat.getPercentInstance(locale);
// the question requires 1 digit for fractional part
// therefore set both, minimum and maximum digit count
fmt.setMinimumFractionDigits(1);
fmt.setMaximumFractionDigits(1);
// set grouping, if you expect large values
// notabene: not all languages use 3 digits per group
fmt.setGroupingUsed(true);
// output the example of the original question
System.out.println(fmt.format(0.125)); 
```

百分比数字格式化程序在我知道的语言环境中的输出中附加了一个空格和百分号。我不知道百分号的位置是否在其他语言环境中的数字之前（例如从右到左的语言环境）。

* * *

## 回答 #6

> 赞同：2
> 
> 时间：2015-03-17T23:24:36.510

我的解决方案呈现与给定数字上设置的比例一样多的小数位数。使用许多原语和`Number`类型进行单元测试。

```
/**
 * Formats the given Number as percentage with necessary precision.
 * This serves as a workaround for {@link NumberFormat#getPercentInstance()} which does not renders fractional
 * digits.
 *
 * @param number
 * @param locale
 *
 * @return
 */
public static String formatPercentFraction(final Number number, final Locale locale)
{
    if (number == null)
        return null;

    // get string representation with dot
    final String strNumber = NumberFormat.getNumberInstance(Locale.US).format(number.doubleValue());
    // create exact BigDecimal and convert to get scale
    final BigDecimal dNumber = new BigDecimal(strNumber).multiply(new BigDecimal(100));

    final NumberFormat percentScaleFormat = NumberFormat.getPercentInstance(locale);
    percentScaleFormat.setMaximumFractionDigits(Math.max(0, dNumber.scale()));

    // convert back for locale percent formatter
    return percentScaleFormat.format(dNumber.multiply(new BigDecimal(0.01)));
} 
```

# latex - MathML、Latex 或类似的基于 Web 的所见即所得编辑器

> ID：698272
> 
> 赞同：6
> 
> 时间：2009-03-30T17:48:26.863
> 
> 标签：latex, wysiwyg, mathml

我正在寻找一个基于 Web 的 WYSIWYG（或 WYSIWYM）编辑器，例如 TinyMCE 或 WMD Editor（用来写这个问题），它支持用户编写数学公式。我看过一点 LaTeX，但它有一个学习曲线，我不确定对 MathML 的支持是否广泛。理想情况下，我还希望避免重写编辑器，而宁愿从现成的中挑选一个。

想知道你们中是否有人处理过类似的情况以及您采用/构建的解决方案。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2011-01-06T20:11:22.940

我正在寻找类似的东西并遇到了这个问题。然后我很高兴通过[公式编辑器的维基百科页面找到](http://en.wikipedia.org/wiki/Formula_editor)[了 Mathquill](http://en.wikipedia.org/wiki/Formula_editor)。

我使用了许多不同的公式编辑器，从 MS Equation Editor 到 Google Docs 再到 LyX，这可能是所有这些编辑器中最有用/最流畅的，用于简单地敲出公式。它是基于网络和 GPL 的。至少，这比 Google Docs 的公式编辑器要好得多。

仍然有很多不足之处，例如到目前为止我发现：加粗、输入诸如括号、\hat、撤消/重做历史、鼠标拖动选择等内容。但我对那里已经存在的东西印象深刻. 无论如何，它只是几个 Javascript 文件，并且[在 github 上](https://github.com/mathquill/mathquill)。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2009-03-30T17:54:18.440

[http://www.dessci.com/en/](http://www.dessci.com/en/)拥有完全满足您需求的软件。

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2009-03-30T17:57:24.113

我不久前在一个项目中使用了[texvc](http://en.wikipedia.org/wiki/Texvc)（维基百科使用的是什么），这是合理的，但它并不是真正的所见即所得。另一方面，我更喜欢这样，因为在许多情况下，指定你的意思比绘制它更容易。

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2011-02-25T09:51:21.807

在这里看到 DragMath

[http://www.dragmath.bham.ac.uk/index.html](http://www.dragmath.bham.ac.uk/index.html)

Moodle 和其他网站已经在使用它。

及其开源

* * *

## 回答 #5

> 赞同：-1
> 
> 时间：2018-03-29T01:54:55.863

[WIRIS](http://www.wiris.com/en)将是另一个基于 Javascript 的可视化数学编辑器（某些应用程序需要商业许可证）。

# c++ - ATL：我想创建一个可用作类中方法的参数的 coclass。为什么我不能让它工作？

> ID：698273
> 
> 赞同：0
> 
> 时间：2009-03-30T17:48:30.420
> 
> 标签：c++, parameters, atl

我已经使用 ATL 创建了一个 COM 对象。我想创建一个可以从方法返回并作为参数传入的新对象。我已经创建了 coclass，但我不知道如何添加一个接受它作为参数的方法。

我得到的错误是 MIDL2025：语法错误：期待“IgBrush”附近的类型规范。我正在使用 Visual Studio 2008。

当我添加一个枚举时，我记得我玩了很多 IDL，并最终让它接受枚举作为参数。同班同学没有这样的运气。

从 ATL 向导提供的默认生成代码中，需要哪些步骤才能使其工作？（即，我将什么移动到哪里以及为什么？）

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-03-30T18:41:46.673

如果您放置您正在使用的 IDL，这会有所帮助。

要在 MIDL 中使用类型，您必须先声明它。

```
interface IMyFactory:IDispatch
{
  ...
};

interface IMyObject:IDispatch
{
  HRESULT SetFactory([in] IMyFactory * state);
} 
```

但我建议您传递 IUnknown* 或 IDispach* 之类的参数（如果它们合适的话），那么最后一个资源将使用 VOID* 作为参数。

# c# - 使用 c# 或 3rd 方库的出站传真？

> ID：698285
> 
> 赞同：2
> 
> 时间：2009-03-30T17:51:42.817
> 
> 标签：c#, fax

我正在开发一个传真解决方案，其中应用程序发送传真。我一直在研究如何处理另一条线路由一个人接听（而不是传真握手）的情况。你是如何处理这个案子的？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-03-30T17:56:47.357

我只是使用电子传真服务。我的 C# 应用程序只是发送一封带有 pdf 文档的电子邮件，以附件形式传真，并在主题中发送传真号码。我不知道这是否适用于您的情况，但这比从头开始编写整个传真客户端要容易得多。

如果您真的想开发自己的解决方案，可能有一些现有的库可以帮助您与传真机进行通信，但甚至还有具有灵活 API 的 E-fax 解决方案，可以让您做任何您需要的事情，而无需使用调制解调器等等。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2009-03-30T22:51:03.657

我使用具有 C# API (Facsys) 的传真服务器 - 首先我使用 API 调用向它发送传真（GIF 格式）。然后，每 5 分钟轮询一次，我向 API 询问该传真的状态：成功、错误号码、无应答、无握手（例如有人应答）等。效果很好。

我们的研究为我们提供了两个主要选项，即 FacSys 和 MessageManager。我在 FacSys 上取得了相当大的成功，但我听说 MM 有更好的支持。

# apache-flex - Flex 编译器元数据“DefaultProperty”

> ID：698289
> 
> 赞同：1
> 
> 时间：2009-03-30T17:53:37.757
> 
> 标签：apache-flex, actionscript-3, mxml

鉴于以下情况：

```
<?xml version="1.0"?>
<mx:Application xmlns:mx="http://www.adobe.com/2009/mxml">
    <mx:Panel title="blah">
       <mx:Button />
    </mx:Panel>
</mx:Application> 
```

您能告诉我默认情况下 mxmlc 在**父元素**（例如 mx:Panel）中分配**子元素（例如 mx:Button）的位置吗？**您可以设置“ **DefaultProperty** ”编译器元数据标记来指定它们被分配的位置，但是当没有指定时 flex 会做什么。

 ****例如，我遍历了所有 flex 类 mx:Panel 继承自的源，但从未提及 DefaultProperty，这让我想知道 DefaultProperty 的默认值是什么。

抱歉有任何无聊，但我已经彻底阅读了文档。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2009-03-30T18:35:27.030

在编写基于 AS 的组件时，默认属性允许您指定可用作子标记的属性。例如：

```
 <MyComp:TextAreaDefaultProp>Hello</MyComp:TextAreaDefaultProp> 
```

您也可以使用：

```
 <MyComp:TextAreaDefaultProp defaultText="Hello" /> 
```

如果不指定会发生什么？您没有获得该属性的值。给定以下组件：

```
package
{
    // as/myComponents/TextAreaDefaultProp.as
    import mx.controls.TextArea;

    // Define the default property.
    [DefaultProperty("defaultText")]

    public class TextAreaDefaultProp extends TextArea {

        public function TextAreaDefaultProp() 
        {
            super();
        }       

        // Define a setter method to set the text property
        // to the value of the default property.
        public function set defaultText(value:String):void {
            if (value!=null)
            text=value;
        }

        public function get defaultText():String {
            return text;
        }
    }    

} 
```

运行此代码段：

```
 <?xml version="1.0" encoding="utf-8"?>
 <mx:Application xmlns:mx="http://www.adobe.com/2006/mxml" 
            layout="absolute" width="535" height="345"
            xmlns:local="*">
 <mx:VBox>
 <local:TextAreaDefaultProp id="a" defaultText="Hello"/>
 <local:TextAreaDefaultProp id="b" > World </local:TextAreaDefaultProp>
 <local:TextAreaDefaultProp id="c" />
 <mx:TextArea id="z"/>
 <mx:Button  click="{z.text = a.defaultText 
                                + ' ' + b.defaultText
                                + ' ' + (c.defaultText.length);}" />

</mx:VBox>
</mx:Application> 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-04-02T16:18:01.623

编译器实际上将容器的子组件视为一种特殊情况。看一下`childDescriptors`属性以`mx.core.Container`获得一些解释。当您在 MXML 中创建 Flex 组件实例时，它不会立即实例化。相反，会创建一个“描述符”，用于在未来某个时间实例化组件，具体取决于容器的`creationPolicy`属性。如果将`-keep-generated-actionscript`参数（或缩短的版本`-keep`）添加到编译器参数，您将能够看到编译器从 MXML 生成的 AS3 代码。

# c# - ASP.NET 脚本“调度”问题

> ID：698297
> 
> 赞同：3
> 
> 时间：2009-03-30T17:55:17.050
> 
> 标签：c#, asp.net, asp.net-mvc

我正在寻找一种每天早上 5 点运行脚本以删除 Temp 文件夹内容的方法。以下是我正在考虑的方法。我将不胜感激对此的任何想法或对其他方法的建议。我想将所有内容都保留在本地，以便在折扣 ASP 托管上没有来自我帐户之外的外部依赖项。

*   有一个包含下一次所需运行的日期时间的文本文件（明天上午 5:00）。
*   有一个 Datetime 缓存值在（一小时？）之后过期
*   当有人访问网站并且缓存过期时，将日期时间重新加载到缓存中
*   如果 Datetime 已过，则运行要“预定”的脚本并在文件中的 DateTime 中添加 24 小时

感谢您的意见。

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2009-03-30T18:01:45.380

你走对了。[这](http://www.codeproject.com/KB/aspnet/ASPNETService.aspx)是一篇很好的文章如何实现这一点。

另外，根据您的评论，为什么不使用会话结束事件来清除？此外，您也可以挂接到应用程序端，以防万一。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-03-30T17:58:55.590

您还可以创建一个 Web 服务来执行该任务，然后让一个计划任务定期调用该 Web 服务。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2009-03-30T18:01:03.447

这不是一个好主意，因为您依赖的输入可能永远不会执行需要定期执行的操作。

因此，您需要来自站点外部的输入（因为站点是由请求触发的）来触发您的事件，也就是调度程序。

您*应该*为此使用计划任务。如果你不是，那么你应该有一些其他的过程将事件发送到你想要的时间表上的网站（也许公开一个网络方法）。

# ruby - 如何在 Ruby 中初始化模块的实例变量？

> ID：698300
> 
> 赞同：83
> 
> 时间：2009-03-30T17:56:52.647
> 
> 标签：ruby, module, instance-variables

我有一些模块，我想在其中使用实例变量。我目前正在像这样初始化它们：

```
module MyModule
  def self.method_a(param)
    @var ||= 0
    # other logic goes here
  end
end 
```

我也可以调用一个 init 方法来初始化它们：

```
def init
  @var = 0
end 
```

但这意味着我必须记住始终调用它。

有没有更好的方法来做到这一点？

* * *

## 回答 #1

> 赞同：112
> 
> 时间：2009-03-30T19:42:45.903

在模块定义中初始化它们。

```
module MyModule
  # self here is MyModule
  @species = "frog"
  @color = "red polka-dotted"
  @log = []

  def self.log(msg)
    # self here is still MyModule, so the instance variables are still available
    @log << msg
  end
  def self.show_log
    puts @log.map { |m| "A #@color #@species says #{m.inspect}" }
  end
end

MyModule.log "I like cheese."
MyModule.log "There's no mop!"
MyModule.show_log #=> A red polka-dotted frog says "I like cheese."
                  #   A red polka-dotted frog says "There's no mop!" 
```

这将在定义模块时设置实例变量。请记住，您可以稍后重新打开模块以添加更多实例变量和方法定义，或重新定义现有的：

```
# continued from above...
module MyModule
  @verb = "shouts"
  def self.show_log
    puts @log.map { |m| "A #@color #@species #@verb #{m.inspect}" }
  end
end
MyModule.log "What's going on?"
MyModule.show_log #=> A red polka-dotted frog shouts "I like cheese."
                  #   A red polka-dotted frog shouts "There's no mop!"
                  #   A red polka-dotted frog shouts "What's going on?" 
```

* * *

## 回答 #2

> 赞同：5
> 
> 时间：2009-03-30T18:03:15.470

您可以使用：

```
def init(var=0)
 @var = var
end 
```

如果您不传递任何内容，它将默认为 0。

如果你不想每次都调用它，你可以使用这样的东西：

```
module AppConfiguration
   mattr_accessor :google_api_key
   self.google_api_key = "123456789"
...

end 
```

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2012-01-09T05:13:24.093

我回答了一个类似的[问题](https://stackoverflow.com/a/8784166/536984)，你可以设置**类实例变量**这样做

```
module MyModule
  class << self; attr_accessor :var; end
end

MyModule.var
=> nil

MyModule.var = 'this is saved at @var'
=> "this is saved at @var"

MyModule.var    
=> "this is saved at @var" 
```

* * *

## 回答 #4

> 赞同：2
> 
> 时间：2014-04-15T12:14:19.813

显然，在 Ruby 的模块中初始化实例变量是一种不好的形式。（出于我不完全理解的原因，但与实例化事物的顺序有关。）

似乎最佳实践是使用具有延迟初始化的访问器，如下所示：

```
module MyModule
  def var
    @var ||= 0 
  end
end 
```

然后`var`用作`@var`.

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2009-03-30T18:12:28.087

对于一个类，我会说以下内容，因为每当您 .new 类的新实例时都会调用初始化。

```
def initialize
   @var = 0
end 
```

来自[实用红宝石](http://practicalruby.blogspot.com/)：

> 它继续说，如果包含类的初始化调用 super，则将调用模块的初始化，但没有提到这是 super 如何在任何地方工作的结果，而不是对初始化的特殊处理。（为什么有人会假设 initialize 得到特殊处理？因为它在可见性方面得到了特殊处理。特殊情况会造成混乱。）

# jquery - 是否有本机 jQuery 函数来切换元素？

> ID：698301
> 
> 赞同：183
> 
> 时间：2009-03-30T17:57:08.230
> 
> 标签：jquery, swap, javascript

我可以用 jQuery 轻松交换两个元素吗？

如果可能的话，我希望用一条线来做到这一点。

我有一个选择元素，我有两个按钮可以向上或向下移动选项，而且我已经有了选定的和目标选择器，我用 if 来做，但我想知道是否有更简单的方法。

* * *

## 回答 #1

> 赞同：247
> 
> 时间：2011-12-26T18:19:44.743

我发现了一种仅使用 jQuery 来解决此问题的有趣方法：

```
$("#element1").before($("#element2")); 
```

或者

```
$("#element1").after($("#element2")); 
```

:)

* * *

## 回答 #2

> 赞同：79
> 
> 时间：2009-03-30T18:25:45.167

Paulo 是对的，但我不确定他为什么要克隆相关元素。这并不是真正必要的，并且会丢失与元素及其后代关联的任何引用或事件侦听器。

这是一个使用普通 DOM 方法的非克隆版本（因为 jQuery 并没有任何特殊功能可以使这个特定操作更容易）：

```
function swapNodes(a, b) {
    var aparent = a.parentNode;
    var asibling = a.nextSibling === b ? a : a.nextSibling;
    b.parentNode.insertBefore(a, b);
    aparent.insertBefore(b, asibling);
} 
```

* * *

## 回答 #3

> 赞同：73
> 
> 时间：2009-03-30T18:13:14.870

不，没有，但你可以抽出一个：

```
jQuery.fn.swapWith = function(to) {
    return this.each(function() {
        var copy_to = $(to).clone(true);
        var copy_from = $(this).clone(true);
        $(to).replaceWith(copy_from);
        $(this).replaceWith(copy_to);
    });
}; 
```

用法：

```
$(selector1).swapWith(selector2); 
```

请注意，这仅在选择器每个仅匹配 1 个元素时才有效，否则可能会产生奇怪的结果。

* * *

## 回答 #4

> 赞同：46
> 
> 时间：2013-09-26T16:39:02.350

这个问题有很多边缘情况，接受的答案或 bobince 的答案没有处理这些情况。其他涉及克隆的解决方案都在正确的轨道上，但克隆既昂贵又不必要。我们很想克隆，因为如何交换两个变量的古老问题，其中一个步骤是将变量之一分配给临时变量。在这种情况下，不需要分配（克隆）。这是一个基于 jQuery 的解决方案：

```
function swap(a, b) {
    a = $(a); b = $(b);
    var tmp = $('<span>').hide();
    a.before(tmp);
    b.before(a);
    tmp.replaceWith(b);
}; 
```

* * *

## 回答 #5

> 赞同：25
> 
> 时间：2016-07-21T21:59:05.057

jQuery`.before`方法可用于通过添加临时 3rd 元素作为书签来交换元素 - 在移动内容时将临时 DOM 元素作为占位符。.

```
$.fn.swapWith = function(that) {
  var $this = this;
  var $that = $(that);

  // create temporary placeholder
  var $temp = $("<div>");

  // 3-step swap
  $this.before($temp);
  $that.before($this);
  $temp.before($that).remove();

  return $this;
} 
```

1.  将临时 div 放在`temp`前面`this`

2.  前移`this`_`that`

3.  前移`that`_`temp`

3b) 移除`temp`

然后像这样使用它

```
$(selectorA).swapWith(selectorB); 
```

演示：[https ://jsfiddle.net/7t1hz94y/](https://jsfiddle.net/7t1hz94y/)

* * *

## 回答 #6

> 赞同：11
> 
> 时间：2010-02-04T16:44:42.497

你不应该需要两个克隆，一个就可以了。以 Paolo Bergantino 的回答我们有：

```
jQuery.fn.swapWith = function(to) {
    return this.each(function() {
        var copy_to = $(to).clone(true);
        $(to).replaceWith(this);
        $(this).replaceWith(copy_to);
    });
}; 
```

应该更快。传入两个元素中较小的一个也应该加快速度。

* * *

## 回答 #7

> 赞同：8
> 
> 时间：2012-02-26T06:00:32.847

我以前用过这样的技术。我将它用于[http://mybackupbox.com上的连接器列表](http://mybackupbox.com)

```
// clone element1 and put the clone before element2
$('element1').clone().before('element2').end();

// replace the original element1 with element2
// leaving the element1 clone in it's place
$('element1').replaceWith('element2'); 
```

* * *

## 回答 #8

> 赞同：3
> 
> 时间：2011-01-27T14:34:49.483

我制作了一个功能，允许您向上或向下移动**多个**选定的选项

```
$('#your_select_box').move_selected_options('down');
$('#your_select_boxt').move_selected_options('up'); 
```

依赖项：

```
$.fn.reverse = [].reverse;
function swapWith() (Paolo Bergantino) 
```

首先它检查第一个/最后一个选择的选项是否能够向上/向下移动。然后它遍历所有元素并调用

> swapWith(element.next() 或 element.prev())

```
jQuery.fn.move_selected_options = function(up_or_down) {
  if(up_or_down == 'up'){
      var first_can_move_up = $("#" + this.attr('id') + ' option:selected:first').prev().size();
      if(first_can_move_up){
          $.each($("#" + this.attr('id') + ' option:selected'), function(index, option){
              $(option).swapWith($(option).prev());
          });
      }
  } else {
      var last_can_move_down = $("#" + this.attr('id') + ' option:selected:last').next().size();
      if(last_can_move_down){
        $.each($("#" + this.attr('id') + ' option:selected').reverse(), function(index, option){
            $(option).swapWith($(option).next());
        });
      }
  }
  return $(this);
} 
```

* * *

## 回答 #9

> 赞同：3
> 
> 时间：2014-09-14T17:10:27.053

另一个没有克隆的：

我有一个实际元素和一个名义元素要交换：

```
 $nominal.before('<div />')
            $nb=$nominal.prev()
            $nominal.insertAfter($actual)
            $actual.insertAfter($nb)
            $nb.remove() 
```

then`insert <div> before`和`remove`later 只需要，如果你不能确保，总是有一个元素之前（在我的情况下是）

* * *

## 回答 #10

> 赞同：3
> 
> 时间：2018-03-16T15:15:49.560

这是我在父元素内上下移动多个子元素的解决方案。适用于在列表框中移动选定的选项 ( `<select multiple></select>`)

**提升：**

```
$(parent).find("childrenSelector").each((idx, child) => {
    $(child).insertBefore($(child).prev().not("childrenSelector"));
}); 
```

**下移：**

```
$($(parent).find("childrenSelector").get().reverse()).each((idx, child) => {
    $(opt).insertAfter($(child).next().not("childrenSelector"));
}); 
```

* * *

## 回答 #11

> 赞同：2
> 
> 时间：2010-07-03T21:42:55.357

看看 jQuery 插件“Swapable”

[http://code.google.com/p/jquery-swapable/](http://code.google.com/p/jquery-swapable/)

它建立在“可排序”的基础上，看起来像可排序的（拖放、占位符等），但只交换两个元素：拖放。所有其他元素不受影响并保持在当前位置。

* * *

## 回答 #12

> 赞同：2
> 
> 时间：2016-05-05T00:18:09.090

这是基于**@lotif**的答案逻辑的答案，但更笼统

如果您在元素实际***移动***
之后/之前附加/前置=> 不需要克隆
=> 保留事件

## 有两种情况可能发生

1.  一个目标有一些“ **`.prev()`**ious”=>我们可以把另一个目标放在**`.after()`**那个地方。
2.  一个目标是它的第一个孩子**`.parent()`**=> 我们可以**`.prepend()`**将另一个目标作为父母。

## 编码

这段代码可以做得更短，但为了便于阅读，我保持这种方式。请注意，预先存储父母（如果需要）和以前的元素是强制性的。

```
$(function(){
  var $one = $("#one");
  var $two = $("#two");

  var $onePrev = $one.prev(); 
  if( $onePrev.length < 1 ) var $oneParent = $one.parent();

  var $twoPrev = $two.prev();
  if( $twoPrev.length < 1 ) var $twoParent = $two.parent();

  if( $onePrev.length > 0 ) $onePrev.after( $two );
    else $oneParent.prepend( $two );

  if( $twoPrev.length > 0 ) $twoPrev.after( $one );
    else $twoParent.prepend( $one );

}); 
```

...随意将内部代码包装在一个函数中:)

示例小提琴附加了额外的点击事件以演示事件保存...
**示例小提琴：** [https ://jsfiddle.net/ewroodqa/](https://jsfiddle.net/ewroodqa/)

...适用于各种情况 - 甚至是以下情况：

```
<div>
  <div id="one">ONE</div>
</div>
<div>Something in the middle</div>
<div>
  <div></div>
  <div id="two">TWO</div>
</div> 
```

* * *

## 回答 #13

> 赞同：1
> 
> 时间：2010-09-12T09:04:13.367

如果你想交换 jQuery 对象中选择的两个项目，你可以使用这个方法

[http://www.vertstudios.com/blog/swap-jquery-plugin/](http://www.vertstudios.com/blog/swap-jquery-plugin/)

* * *

## 回答 #14

> 赞同：1
> 
> 时间：2013-09-15T09:52:13.793

我想要一个不使用 clone() 的解决方案，因为它对附加事件有副作用，这就是我最终要做的

```
jQuery.fn.swapWith = function(target) {
    if (target.prev().is(this)) {
        target.insertBefore(this);
        return;
    }
    if (target.next().is(this)) {
        target.insertAfter(this);
        return
    }

    var this_to, this_to_obj,
        target_to, target_to_obj;

    if (target.prev().length == 0) {
        this_to = 'before';
        this_to_obj = target.next();
    }
    else {
        this_to = 'after';
        this_to_obj = target.prev();
    }
    if (jQuery(this).prev().length == 0) {
        target_to = 'before';
        target_to_obj = jQuery(this).next();
    }
    else {
        target_to = 'after';
        target_to_obj = jQuery(this).prev();
    }

    if (target_to == 'after') {
        target.insertAfter(target_to_obj);
    }
    else {
        target.insertBefore(target_to_obj);
    }
    if (this_to == 'after') {
        jQuery(this).insertAfter(this_to_obj);
    }
    else {
        jQuery(this).insertBefore(this_to_obj);
    }

    return this;
}; 
```

它不能与包含多个 DOM 元素的 jQuery 对象一起使用

* * *

## 回答 #15

> 赞同：1
> 
> 时间：2015-02-16T17:19:30.667

如果每个元素都有多个副本，则自然需要循环执行某些操作。我最近有这种情况。我需要切换的两个重复元素具有类和容器 div，如下所示：

```
<div class="container">
  <span class="item1">xxx</span>
  <span class="item2">yyy</span>
</div> 
and repeat... 
```

以下代码允许我遍历所有内容并反转...

```
$( ".container " ).each(function() {
  $(this).children(".item2").after($(this).children(".item1"));
}); 
```

* * *

## 回答 #16

> 赞同：1
> 
> 时间：2015-03-14T10:03:08.307

我已经用这个片段完成了

```
// Create comments
var t1 = $('<!-- -->');
var t2 = $('<!-- -->');
// Position comments next to elements
$(ui.draggable).before(t1);
$(this).before(t2);
// Move elements
t1.after($(this));
t2.after($(ui.draggable));
// Remove comments
t1.remove();
t2.remove(); 
```

* * *

## 回答 #17

> 赞同：1
> 
> 时间：2016-11-11T03:31:43.287

我做了一个表格，用于更改数据库中使用的 .after() .before() 中的 obj 顺序，所以这是我的实验。

```
$(obj1).after($(obj2)) 
```

是在 obj2 之前插入 obj1 并且

```
$(obj1).before($(obj2)) 
```

反之亦然。

因此，如果 obj1 在 obj3 之后，而 obj2 在 obj4 之后，并且如果你想改变 obj1 和 obj2 的位置，你会这样做

```
$(obj1).before($(obj4))
$(obj2).before($(obj3)) 
```

这应该这样做顺便说一句，如果您还没有某种索引，您可以使用 .prev() 和 .next() 来查找 obj3 和 obj4 。

* * *

## 回答 #18

> 赞同：1
> 
> 时间：2020-04-14T16:49:01.460

```
$('.five').swap('.two'); 
```

像这样创建一个 jQuery 函数

```
$.fn.swap = function (elem) 
{
    elem = elem.jquery ? elem : $(elem);
    return this.each(function () 
    {
        $('<span></span>').insertBefore(this).before(elem.before(this)).remove();
    });
}; 
```

感谢[https://jsfiddle.net/ARTsinn/TVjnr/](https://jsfiddle.net/ARTsinn/TVjnr/)的**Yannick Guinness**

* * *

## 回答 #19

> 赞同：0
> 
> 时间：2017-08-26T03:36:42.853

如果 nodeA 和 nodeB 是兄弟姐妹，喜欢两个`<tr>`在同一个`<tbody>`，你可以使用`$(trA).insertAfter($(trB))`或`$(trA).insertBefore($(trB))`交换它们，它适用于我。而且你之前不需要调用`$(trA).remove()`，否则你需要重新绑定一些点击事件`$(trA)`

* * *

## 回答 #20

> 赞同：0
> 
> 时间：2020-08-29T11:50:39.403

目前无需为任何主流浏览器使用 jquery 来交换元素。原生 dom 方法，`insertAdjacentElement`无论它们位于何处，都可以解决问题：

```
var el1 = $("el1");
var el2 = $("el2");
el1[0].insertAdjacentElement("afterend", el2[0]); 
```

* * *

## 回答 #21

> 赞同：-2
> 
> 时间：2009-03-30T19:03:08.650

最好的选择是使用 clone() 方法克隆它们。

* * *

## 回答 #22

> 赞同：-2
> 
> 时间：2013-02-10T17:11:28.540

我认为你可以很简单地做到这一点。例如，假设您有下一个结构： ...

```
<div id="first">...</div>
<div id="second">...</div> 
```

结果应该是

```
<div id="second">...</div>
<div id="first">...</div> 
```

jQuery：

```
$('#second').after($('#first')); 
```

我希望它有帮助！

# wpf - 如何公开 WPF DataTemplate 的属性？

> ID：698307
> 
> 赞同：0
> 
> 时间：2009-03-30T17:59:04.233
> 
> 标签：wpf, properties, datatemplate, setter, static-resource

我有一个在许多页面中使用的数据模板，数据模板包含几个按钮，我想通过触发器隐藏其中一些按钮（我的意思是在我使用此 DataTemplate 的页面中设置这些按钮的 IsEnabled 属性）。

换句话说，我什至想在样式触发器/设置器中设置一个属性“ButtonXIsEnabled”、“ButtonYIsEnabled”作为我使用此 DataTemplate 的 ListBox 中可设置的 DataTemplate 的一部分。

我真的希望我足够清楚，请留下评论以获取更多详细信息。

任何讨论将不胜感激！提前致谢。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-03-30T18:08:34.427

基本上这取决于您用于数据模板的对象。而不是使用一些 ButtonYIsEnabled 等。尝试使用一些更适合您的领域模型的词。

例如，假设您有一个客户列表，其中一些客户有能力购买打折产品。然后向您的客户添加一个名为 CanPurchaseDiscountedProducts 的属性，并在您的 DataTemplate 中使用该属性

```
<DataTemplate TargetType="{x:Type local:Customer}">
  <!-- Other Items -->
  <Button Content="Purchase Discounted Products" x:Name="discounts" Visibility="Hidden" />
  <DataTemplate.Triggers>
    <DataTrigger Binding="{Binding CanPurchaseDiscountedProducts}" Value="True">
      <Setter TargetName="discounts" Property="Visibility" Value="Visible"/>
    </DataTrigger>
  </DataTemplate.Triggers>
</DataTemplate> 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-03-30T18:02:29.700

WPF 数据模板是某种对象类型的视图……您希望 ObjectTypeX 的实例看起来如何。数据模板可以绑定到底层实例的属性。

因此，如果您的实例上有 ButtonXIsEnabled 属性，则可以将相应的 Button 的 Visibility 属性绑定到实例属性。该按钮将根据基础对象中的值显示或隐藏。

# asp.net - 为什么 Content-Disposition 标头在 IE 8 中不起作用？

> ID：698308
> 
> 赞同：3
> 
> 时间：2009-03-30T17:59:18.693
> 
> 标签：asp.net

我正在尝试将文本文件 (CSV) 流式传输到响应，并且以下代码在 Firefox 3 中完美运行，但是当我使用 IE 时，它看起来想要下载实际的 .aspx 页面，并抱怨该文件内容与文件扩展名或类型不匹配。如果我然后选择下载文件，它会正确下载 CSV 数据并在 Excel 中打开它。我究竟做错了什么？

```
 DataTable dt = ExtensionsProvider.ListPrivateCallCostsForCsv(reportFilter.BusinessUnit, reportFilter.StartDate,
                                                             reportFilter.EndDate);
    Response.Clear();
    Response.Buffer = true;
    Response.ContentType = "text/csv";
    Response.AddHeader("Content-Disposition", "filename=" + GetExportFileName()); 
    DataTableHelper.WriteCsv(dt, Response.Output, false);
    Response.End(); 
```

* * *

## 回答 #1

> 赞同：9
> 
> 时间：2009-03-30T18:07:52.760

```
Response.AddHeader("Content-Disposition", "filename=" + GetExportFileName()); 
```

应该：

```
Response.AddHeader("Content-Disposition", "attachment;filename=" + GetExportFileName()); 
```

如果没有主`Content-Disposition`值，IE 将只使用 URL 的结尾部分 - <code>something.aspx - 作为文件名。

（以上假设`GetExportFileName()`返回一个去除了大多数标点符号的净化文件名。在 IE 中，可以在标头参数中作为标记或引用字符串的内容有些烦人；有关详细信息，请参阅[此问题](https://stackoverflow.com/questions/695356/downloading-file-with-or-in-file-name-ruins-filename/695719#695719)）

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-06-14T13:33:42.720

它也不适用于内联。当然它适用于所有其他浏览器

```
HttpServletResponse response = aCtx.getResponse();
response.setContentType("text/plain");
response.addHeader("Content-Disposition", "inline;filename=log.txt"); 
```

* * *

## 回答 #3

> 赞同：-1
> 
> 时间：2009-03-30T18:49:03.787

除了文件名参数之外，您还必须提供 Content-Disposition 标头的值。

[“内联”值](http://dotanything.wordpress.com/2008/05/30/content-disposition-attachment-vs-inline/)可能比“附件”值更幸运：

```
Response.AddHeader("Content-Disposition", "inline;filename=" + GetExportFileName()); 
```

# c++ - 字长、字符大小、整数大小和字节之间的关系

> ID：698312
> 
> 赞同：0
> 
> 时间：2009-03-30T18:00:31.110
> 
> 标签：c++, word, int, byte

C++中字长、字符大小、整数大小和字节之间的关系是什么？

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2009-03-30T18:08:59.920

该标准要求某些类型具有*最小*大小（short 至少为 16 位，int 至少为 16 位等），并且某些类型组是有序的（`sizeof(int)`>= `sizeof(short)`>= `sizeof(char)`）。

* * *

## 回答 #2

> 赞同：5
> 
> 时间：2009-03-30T18:25:45.777

在 C++ 中，char 必须足够大以容纳实现的基本字符集中的任何字符。

`int`具有“执行环境架构建议的自然大小”。请注意，这意味着 int的大小*不需要*至少为 32 位。16 位的实现`int`很常见（想想嵌入式 ot MS-DOS）。

以下内容来自 C++98 和 C99 标准的各个部分：

*   `long int`必须至少与`int`
*   `int`必须至少与`short`
*   `short`必须至少与`char`

请注意，它们可能都具有相同的大小。

另外（假设一个二进制补码实现）：

*   `long int`必须至少为 32 位
*   `int`必须至少为 16 位
*   `short`必须至少为 16 位
*   `char`必须至少为 8 位

* * *

## 回答 #3

> 赞同：4
> 
> 时间：2009-03-30T18:29:50.353

标准不知道处理器使用的这个“词”。但它说“int”类型应该具有执行环境的自然大小。但即使对于 64 位环境，int 通常也只有 32 位。所以标准术语中的“单词”几乎没有共同的含义（当然除了常见的英语“单词”）。

字符大小是字符的大小。那要看你说的是什么角色了。字符类型有 char、unsigned char 和 signed char。wchar_t 还用于存储可以具有任何大小的字符（由实现确定 - 但必须使用其中一种整数类型作为其基础类型。很像枚举），而 char/signed char 或 unsigned char 必须有一个字节。这意味着一个字节的位数与一个字符的位数一样多。如果一个实现说一个 char 类型的对象有 16 位，那么一个字节也有 16 位。

现在一个字节是一个字符占用的大小。它是一个单位，而不是某种特定类型。没有更多关于它的内容，只是它是您可以访问内存的单元。即您没有对位域的指针访问权限，但您可以访问从一个字节开始的单元。

“整数大小”现在很宽。你什么意思？所有 bool、char、short、int、long 和它们的 unsinged 对应物都是整数。它们的范围就是我所说的“整数大小”，它记录在 C 标准中 - 由 C++ 标准接管。对于有符号字符，范围是 -127 <-> 127，对于 short 和 int，它是相同的，并且是 -2^15+1 <-> 2^15-1，对于 long，它是 -2^31+1 < -> 2^31-1。它们的无符号对应值分别从 0 到 2^8-1、2^16-1 和 2^32-1。然而，这些都是最小的尺寸。也就是说，一个 int 在任何平台上都可能没有最大大小 2^14，因为它当然小于 2^15-1。对于这些值，需要最少的位。对于 char 是 8，对于 short/int 是 16，对于 long 是 32。两个'`-128`而不是`-127`例如签名字符。

* * *

## 回答 #4

> 赞同：3
> 
> 时间：2009-03-30T18:05:21.877

标准 C++ 没有称为`word`or的数据类型`byte`。其余的都很好地定义为范围。基地是一个`char`有`CHAR_BITS`位。CHAR_BITS 最常用的值为 8。

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2009-03-30T18:30:57.057

sizeof( char ) == 1 ( 一个字节 ) （在 c++ 中，在 C 中 - 未指定）
sizeof( int ) >= sizeof( char )
word - 不是 c++ 类型，通常在计算机体系结构中表示 2 个字节

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2009-03-30T18:06:49.317

有点取决于你所说的关系。数字类型的大小通常是机器字大小的倍数。一个字节就是一个字节就是一个字节——8位，不多也不少。我相信一个字符在标准中定义为单个无符号字节（请查看您的 ARM 了解详细信息）。

一般规则是，不要对数据类型的实际大小做出任何假设。该标准规定了类型之间的关系，例如“long”整数将与“int”大小相同或大于“int”。该语言的各个实现将为他们方便的类型选择特定的大小。例如，64 位处理器的编译器将选择与 32 位处理器的编译器不同的大小。

您可以使用 sizeof() 运算符来检查您正在使用的编译器的特定大小（在特定目标体系结构上）。

# svn - Subversion 中的主干、分支和标签是什么？

> ID：698313
> 
> 赞同：241
> 
> 时间：2009-03-30T18:00:53.853
> 
> 标签：svn, branch, tags, conventions, trunk

> **可能重复：**
> [“分支”、“标签”和“主干”的真正含义是什么？](https://stackoverflow.com/questions/16142/what-do-branch-tag-and-trunk-really-mean)

Subversion 中的主干、分支和标签是什么？使用它们的最佳实践是什么？

[我可以在Visual Studio 2008](http://en.wikipedia.org/wiki/Microsoft_Visual_Studio#Visual_Studio_2008)中使用哪些工具进行 Subversion ？

* * *

## 回答 #1

> 赞同：297
> 
> 时间：2009-03-30T18:22:39.653

**主干**是 SVN 存储库中开发的主线。

**分支**是开发的一个副线，用于在不惹恼主干版本用户的情况下进行更大的、实验性的或破坏性的工作。此外，分支可用于为同一产品的多个版本创建开发线，例如将错误修复反向移植到稳定版本中。

最后，**标签**是用来突出存储库历史中显着修订的标记，通常是“这是作为 1.0 发布的”。

请参阅 HTML 版本的“[使用 Subversion 进行版本控制](http://svnbook.red-bean.com/)”，尤其是[第 4 章：分支和合并](http://svnbook.red-bean.com/en/1.5/svn.branchmerge.html)，或以纸质形式购买（例如从[amazon](https://rads.stackoverflow.com/amzn/click/com/0596510330)购买），以深入讨论技术细节。

`/tags` `/branches`与其他人（例如下面的 Peter Neubauer）一样，作为和目录的底层实现`/trunk`只是[传统](http://svnbook.red-bean.com/en/1.5/svn.tour.importing.html#svn.tour.importing.layout)的，而不是以任何方式由工具强制执行的。违反这些约定会导致混乱，因为这会破坏其他人访问存储库的习惯和期望。必须特别注意避免将新更改提交到标签中，这些更改**应该**被冻结。

* * *

我使用[TortoiseSVN](http://tortoisesvn.tigris.org/)但没有 Visual Studio 集成。我一直在第二台显示器上打开“检查修改”对话框，这样我就可以跟踪我接触了哪些文件。但请参阅“[最佳 SVN 工具](https://stackoverflow.com/questions/48992/best-svn-tools)”问题以获取更多建议。

* * *

## 回答 #2

> 赞同：37
> 
> 时间：2009-03-30T18:31:32.470

“主干”、“分支”和“标签”目录是Subversion 中的*约定*。Subversion 不需要您拥有这些目录，也不需要为它们指定特殊含义。但是，这种约定非常普遍，除非您有充分的理由，否则您应该遵守约定。其他读者提供的书籍链接描述了约定以及如何使用它。

* * *

## 回答 #3

> 赞同：27
> 
> 时间：2009-03-30T18:50:33.970

David Schmitt 的回答很好地总结了一切，但我认为重要的是要注意，对于 SVN，术语“分支”、“标签”和“主干”没有任何意义。这些术语纯粹是语义性的，只会影响我们作为系统用户处理这些目录的方式。人们可以轻松地将它们命名为“主要”、“测试”和“发布”。只要使用该系统的每个人都了解如何正确使用每个部分，它们的名称并不重要。

* * *

## 回答 #4

> 赞同：18
> 
> 时间：2009-03-30T18:02:39.623

开始学习 Subversion 的好地方是[http://svnbook.red-bean.com/](http://svnbook.red-bean.com/)。

就 Visual Studio 工具而言，我喜欢[AnkhSVN](http://ankhsvn.open.collab.net/)，但我还没有尝试过[VisualSVN](http://www.visualsvn.com/)插件。

VisualSVN 确实依赖于[TortoiseSVN](http://tortoisesvn.tigris.org/)，但 TortoiseSVN 也是 Ankh 恕我直言的一个很好的补充。

* * *

## 回答 #5

> 赞同：10
> 
> 时间：2009-03-30T18:06:50.003

要在 Visual Studio 2008 中使用 Subversion，请安装[TortoiseSVN](http://tortoisesvn.tigris.org/)和[AnkhSVN](http://ankhsvn.open.collab.net/)。

> **TortoiseSVN**是一款非常易于使用的 Windows 版本控制/版本控制/源代码控制软件。由于它不是针对特定 IDE 的集成，因此您可以将它与您喜欢的任何开发工具一起使用。TortoiseSVN 可以免费使用。您无需获得贷款或支付全部年薪即可使用它。
> 
> **AnkhSVN**是 Visual Studio 的 Subversion SourceControl 提供程序。该软件允许您直接从 Microsoft Visual Studio IDE 内部执行最常见的版本控制操作。使用 AnkhSVN，您不再需要离开 IDE 来执行查看源代码状态、更新 Subversion 工作副本和提交更改等任务。您甚至可以浏览您的存储库，并且可以插入您最喜欢的差异工具。

* * *

## 回答 #6

> 赞同：8
> 
> 时间：2009-03-30T18:05:44.437

主干被认为是您的主要代码库，是主干的分支分支。就像，如果你想实现一个新特性，你创建一个分支，但又不想影响主干。

[TortoiseSVN](http://tortoisesvn.net/docs/release/TortoiseSVN_en/index.html)有很好的文档和一个很棒的差异工具。

我使用 Visual Studio，我使用[VisualSVN](https://en.wikipedia.org/wiki/VisualSVN)和 TortoiseSVN。

* * *

## 回答 #7

> 赞同：6
> 
> 时间：2009-03-30T18:13:02.217

如果您是 Subversion 的新手，您可能想查看 SmashingMagazine.com 上的这篇文章，标题为*[Ultimate Round-Up for Version Control with SubVersion](http://www.smashingmagazine.com/2009/03/10/ultimate-round-up-for-version-control-with-subversion/)*。

它涵盖了 SubVersion 的入门以及*教程、参考资料和书籍建议*的链接。

它涵盖了工具（许多是兼容的窗口），并提到**AnkhSVN**作为与 Visual Studio 兼容的插件。评论还提到**[VisualSVN](https://en.wikipedia.org/wiki/VisualSVN)**作为替代方案。

* * *

## 回答 #8

> 赞同：5
> 
> 时间：2009-03-30T18:27:59.420

如果你有一个开发团队，一个很棒的免费实用程序是[SVN Monitor](http://sourceforge.net/projects/svnmonitor/)。它可以作为你的树的心跳，告诉你什么时候有更新、可能的冲突等。不过，它对一个单独的开发者来说并不是那么有用。

* * *

## 回答 #9

> 赞同：4
> 
> 时间：2009-03-30T18:12:59.753

一本关于 Subversion 的好书是*[Pragmatic Version Control using Subversion](http://www.pragprog.com/titles/svn/pragmatic-version-control-using-subversion)*解释了您的问题，它提供了更多信息。

# c# - ASP C# 我可以使用 MVC 吗？

> ID：698324
> 
> 赞同：1
> 
> 时间：2009-03-30T18:02:41.727
> 
> 标签：c#, model-view-controller

在我的 Web 应用程序中，我有一个带有文档的树视图。树节点的 NavigateUrl 如下所示：

```
viewDocument.aspx?id=1&doctype=type 
```

在`ViewDocument.asp.cs`我检查是否设置`id`的加载事件中`doctype`。如果是这样，检查`doctype`有一个有效值并检查`id`是一个数字。之后，我创建了一个文档对象。然后我调用它的`Load(int id)`函数，它将加载对象中的所有数据。如果`id`数据库中不存在 ，则返回值为`false`，否则为`true`。

是否可以使用 MVC 模式？如果是这样，我该如何开始？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-03-30T18:06:18.630

有一个官方的 ASP.NET MVC 框架。[在这里](http://www.asp.net/mvc/)查看。您可以阅读那里的教程以帮助您入门。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2009-03-30T18:09:26.983

确实如此，但 MVC 是您必须解决的第二个问题。

如果您在此处使用 URL 重写将您的 url 重写到此模板中，那将是有意义的：

文件/类型/ID

这是一篇关于如何为托管在 IIS7 中的站点启用 URL 重写的好博文：

[http://blogs.iis.net/bills/archive/2008/05/31/urlrewrite-module-for-iis7.aspx](http://blogs.iis.net/bills/archive/2008/05/31/urlrewrite-module-for-iis7.aspx)

一旦你有了它，MVC 就是处理这个场景的优秀候选者。您只需使用此模式声明一条路线：

{控制器}/{动作}/{id}

控制器将是一个类（很可能是 DocumentsController），在这种情况下，动作将是类型。您不必使用它，您可以使用一种类型，但是您必须在设置路线时设置默认操作。最后，id 将是 action 指定的方法的参数。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2009-03-30T19:02:56.903

首先研究一下 MVC 模式是什么以及它给你带来了什么。要真正*使用*MVC 模式，而不仅仅是表面地实现某个框架，您需要掌握这个概念，而不是仅仅阅读框架的 API。

MVC 可以给你买的一些东西（虽然不是详尽的）：
- 将实际显示与流程控制和业务逻辑解耦
- 所有的：
模块化
可读性
可维护性
可测试性

虽然要获得所有这些优势，你必须了解 MVC 概念并应用它是正确的，而不仅仅是在您的项目中任意包含一个框架，然后期望一切顺利。

这是 MVC 的一个很好的起点： [http ://en.wikipedia.org/wiki/Model-view-controller](http://en.wikipedia.org/wiki/Model-view-controller)

# actionscript-3 - 在 actionscript 3 中使用 Papervision 3D 返回 md2 的动画频道？

> ID：698333
> 
> 赞同：0
> 
> 时间：2009-03-30T18:04:14.923
> 
> 标签：actionscript-3, papervision3d

我目前正在研究 FlarToolkit / Papervision3D / Quake2 模型解析，我已成功加载、纹理化和动画化。话虽如此，动画调用对我来说只是一个猜测，到目前为止我所知道的是“跳跃”和“跑步”是可用的。当我使用 MD2 类的内置 getAnimationChannels() 时，它仅返回 MorphChannel3D 对象数组，如下所示。

//md2 是一个已经加载并等待使用给定事件的模型。

```
trace(_md2.getAnimationChannels()); //returns [object MorphChannel3D],[object MorphChannel3D],[object MorphChannel3D],[object MorphChannel3D],[object MorphChannel3D],[object MorphChannel3D],[object MorphChannel3D],[object MorphChannel3D],[object MorphChannel3D],[object MorphChannel3D],[object MorphChannel3D],[object MorphChannel3D],[object MorphChannel3D],[object MorphChannel3D],[object MorphChannel3D],[object MorphChannel3D],[object MorphChannel3D],[object MorphChannel3D],[object MorphChannel3D],[object MorphChannel3D] 
```

根据我在自己的搜索中看到的情况，这应该以字符串形式返回通道名称数组。我试图从 MorphChannel3D 对象中提取属性，但没有成功使用 for each(var p:* in Object);

我哪里出错了，如何获取动画频道的名称以便我可以随意调用它们？

[这里的项目示例](http://www.hodgedev.com/plainium/dev/FLARToolkit_PV3D_Quake2_MD2_Ernie/)

谢谢。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2009-04-13T02:59:53.763

有趣的项目。

我玩了一点MD2，但我很困惑。不知道要使用哪些类以及如何使用。我问了papervision邮件列表上的人，但没有明确的答案。

这是我的测试

```
package
{
    import flash.display.*;
    import flash.events.*;
    import flash.utils.*;
    import org.papervision3d.core.animation.channel.AbstractChannel3D;
    import org.papervision3d.core.animation.channel.MorphChannel3D;

    import org.papervision3d.events.AnimationEvent;
    import org.ascollada.utils.FPS;
    import org.papervision3d.cameras.*;
    import org.papervision3d.core.geom.*;
    import org.papervision3d.core.geom.renderables.*;
    import org.papervision3d.events.*;
    import org.papervision3d.materials.*;
    import org.papervision3d.materials.special.*;
    import org.papervision3d.materials.utils.*;
    import org.papervision3d.objects.*;
    import org.papervision3d.objects.parsers.*;
    import org.papervision3d.objects.primitives.*;
    import org.papervision3d.render.*;
    import org.papervision3d.scenes.*;
    import org.papervision3d.view.*;
    import org.papervision3d.view.layer.*;

    /**
    * Basic MD2Test Class
    * @author George Profenza
    */
    public class MD2Test extends Sprite
    {

        private var viewport:BasicView;
        private var timer:Timer;
        private var fps:FPS;
        private var container:DisplayObject3D;
        private var box:MD2;
        private var isPlaying:Boolean = true;
        private var _channels:Array;
        private var _numFrames:int;
        private var _currentFrame:int;
        private var frameCount:int = 1;

        public function MD2Test() 
        {
            init();
        }

        private function init():void {

            stage.align = StageAlign.TOP_LEFT;
            stage.scaleMode = StageScaleMode.SHOW_ALL;

            viewport = new BasicView(0, 0, true, true, CameraType.FREE);
            addChild(viewport);

            container = new DisplayObject3D();
            viewport.scene.addChild(container);

            fps = new FPS();
            addChild(fps);

            var mat:WireframeMaterial = new WireframeMaterial(0x990000);
            mat.doubleSided = true;

            box = new MD2(false);
            box.rotationX = -90;
            box.load("animations/box_wrap_anim.md2", mat, 6, 10);
            box.addEventListener(FileLoadEvent.LOAD_COMPLETE, boxLoaded);
            box.addEventListener(AnimationEvent.ANIMATION_NEXT_FRAME, boxAnimationComplete);
            container.addChild(box);

            //var channel:AnimationCha = new MorphChannel3D(box);

            var btnPlay:Sprite = new Sprite();
            btnPlay.graphics.beginFill(0x990000);
            btnPlay.graphics.drawRect(0, 0, 60, 20);
            btnPlay.graphics.endFill();
            addChild(btnPlay);
            btnPlay.y = 100;
            btnPlay.addEventListener(MouseEvent.CLICK, playMD2);

            var btnNextFrame:Sprite = new Sprite();
            btnNextFrame.graphics.beginFill(0x990000);
            btnNextFrame.graphics.drawRect(0, 0, 60, 20);
            btnNextFrame.graphics.endFill();
            addChild(btnNextFrame);
            btnNextFrame.y = 200;
            btnNextFrame.addEventListener(MouseEvent.CLICK, playNextFrame);

            addEventListener(Event.ENTER_FRAME, render);
        }

        private function boxAnimationComplete(e:AnimationEvent):void 
        {
            trace('box animation complete');
        }

        private function playNextFrame(e:MouseEvent):void 
        {
            if (frameCount < _numFrames) frameCount++;
            else frameCount = frameCount;
            gotoFrame(frameCount);
        }

        private function boxLoaded(e:FileLoadEvent):void 
        {
            _channels = box.getAnimationChannels();

           trace("channel count", _channels.length);
           rewind();

           _numFrames = 0;
           _currentFrame = 1;

           for each(var channel:AbstractChannel3D in _channels)
           {
               _numFrames = Math.max(_numFrames, channel.keyFrames.length);
               channel.updateToFrame(_currentFrame);
           }
        }

        public function rewind():void
       {
           trace("channels length: " + box.getAnimationChannels().length);
           for each(var channel:AbstractChannel3D in _channels)
           {
               channel.updateToFrame(1);
           }
       }

       public function gotoFrame(frame:Number):void
       {
           for each(var channel:AbstractChannel3D in _channels)
               channel.updateToFrame(frame);
       }

        private function playMD2(e:MouseEvent):void 
        {
            isPlaying = !isPlaying;
            isPlaying ? box.stop() : box.play();
        }

        private function render(e:Event):void 
        {
            viewport.camera.orbit(mouseY * .5, mouseX * .5);
            viewport.singleRender();
        }

    }

} 
```

这是几个月前创建的，因此检查更新可能值得。在我的测试中，事情是手动完成的。[我记得在 ascollada 网站](http://ascollada.org/?page_id=3)上看到过一些不错的演示，但从来没有机会看到他们是如何实现 md2 动画的。

希望这可以帮助。

# c# - 如何在长名称 dbf 文件上使用 GetOleDbSchemaTable 方法

> ID：698334
> 
> 赞同：6
> 
> 时间：2009-03-30T18:04:43.097
> 
> 标签：c#, oledb, dbf

作为我在 C# 中工作的项目的一部分，我需要读取 .dbf 文件。我要做的第一件事是从文件中获取模式表。只要文件名（不带扩展名）不超过 8 个字符，我的代码就可以工作。

例如，假设我有一个名为 MyLongFilename.dbf 的文件。以下代码不起作用；它引发以下异常：“Microsoft Jet 数据库引擎找不到对象 'MyLongFilename'。确保对象存在，并且正确拼写其名称和路径名。”</p>

```
string cxn = "PROVIDER=Microsoft.Jet.OLEDB.4.0;Data Source=C:\MyLongFilename;Extended Properties=dBASE 5.0";
OleDbConnection connection = new OleDbConnection(cxn); 
```

为了克服这个异常，下一步是使用 OldDbConnection 喜欢的名称（'MyLongF~1' 而不是 'MyLongFilename'），这会导致：

```
string cxn = "PROVIDER=Microsoft.Jet.OLEDB.4.0;Data Source=C:\MyLongF~1;Extended Properties=dBASE 5.0";
OleDbConnection connection = new OleDbConnection(cxn); 
```

这确实成功返回了 OleDbConnection。现在要获取架构表，我尝试以下操作：

```
connection.Open();
DataTable schemaTable = connection.GetOleDbSchemaTable(OleDbSchemaGuid.Columns,
    new object[] { null, null, fileNameNoExt, null }); 
```

这将返回一个没有行的 DataTable。如果我将文件名重命名为 8 个或更少的字符，则此代码有效，并且我为数据库中的每个字段返回一行。

使用长文件名，我知道返回的连接是有效的，因为我可以使用它来填充 DataSet，如下所示：

```
string selectQuery = "SELECT * FROM [MyLongF~1#DBF];";
OleDbCommand command = new OleDbCommand(selectQuery, connection);
connection.Open();
OleDbDataAdapter dataAdapter = new OleDbDataAdapter();
dataAdapter.SelectCommand = command;
DataSet dataSet = new DataSet();
dataAdapter.Fill(dataSet); 
```

这给了我一个 DataSet，其中包含一个 DataTable，其中包含 dbf 文件中的所有数据。

所以问题是我怎样才能得到长命名的 dbf 文件的模式表？当然，我可以通过重命名/复制文件来解决这个问题，但我不想这样做。我也不想用前 1 条记录填充 DataSet 并从列中推断出架构。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-06-08T23:34:34.773

根据[MSDN](http://msdn.microsoft.com/en-us/library/aa337084.aspx)，文件夹代表数据库，文件代表表。您应该使用不包括连接字符串中的文件名的目录路径，以及作为 GetOleDbSchemaTable 限制的一部分的表名。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-04-14T21:47:17.630

嗯，我认为连接应该是

```
string cxn = "PROVIDER=Microsoft.Jet.OLEDB.4.0;Data Source=C:\;Extended Properties=dBASE 5.0";
OleDbConnection connection = new OleDbConnection(cxn); 
```

另一个是，也许您应该尝试与其他提供商一起使用，我之前使用过这样的方法时提高了很多：

```
string cxn = "PROVIDER=VFPOLEDB.1;Data Source=C:\;Extended Properties=dBASE 5.0"; 
```

但是你应该安装了 VFP 7

或[从此处安装 Microsoft OLE DB Provider for Visual FoxPro 9.0](http://file:///C:/Program%20Files%20(x86)/Microsoft%20Visual%20FoxPro%20OLE%20DB%20Provider/readme.htm)

```
 const string connectionString = @"Provider = vfpoledb; Data Source = {0}; Collating Sequence = general;";
        OleDbConnection conn = new OleDbConnection(string.Format(connectionString, dirName));
        conn.Open();
        OleDbCommand cmd = new OleDbCommand(string.Format("select * from {0}", fileName), conn); 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-06-10T16:31:20.320

我相信 DataSource 应该代表包含 .DBF 文件的目录。每个 .DBF 文件对应于该目录中的一个表。

我的猜测是 c:\MyLongF~1 是包含对应于 MyLongF~1#DBF 的文件名的目录的简称

你能验证是否是这种情况吗？

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2009-06-04T04:06:54.273

fileNameNoExt 是否保存短文件名版本？此外，*MyLongF~1*是 9 个字符，而不是 8 个。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2009-06-09T15:15:04.653

如果您有一个（并且可能很小）dbf 文件，您可以解决将 dbf 文件复制到其他地方的问题并打开副本而不是原始文件。

# c# - 如何使用 C# 在 Oracle 关系数据库中插入日期

> ID：698339
> 
> 赞同：-2
> 
> 时间：2009-03-30T18:05:56.057
> 
> 标签：c#, oracle, odac

我在 Oracle 中有 Date Var，我尝试从我的 C# 程序中插入数据

```
sql = "insert into Table(MyDate) values (" + convert.todatetime(txt) + ")"; 
```

我得到一个错误，我该怎么办？

* * *

## 回答 #1

> 赞同：12
> 
> 时间：2009-03-30T18:23:10.820

```
cmd.CommandText = "INSERT INTO Table (myDate)VALUES(:dateParam)";

cmd.Parameters.Add(new OracleParameter("dateParam", OracleDbType.Date))
    .Value = DateTime.Now;

cmd.ExecuteNonQuery(); 
```

* * *

## 回答 #2

> 赞同：8
> 
> 时间：2009-03-30T18:09:26.237

使用参数。它将解决您的问题并防止注射。

* * *

## 回答 #3

> 赞同：6
> 
> 时间：2009-03-30T18:10:14.487

Oracle 期望它是一个实际的日期值，而不仅仅是一个看起来像日期的字符串。您必须使用该`TO_DATE()`函数来解释您的字符串是如何格式化的，如下所示：

```
INSERT INTO Table (myDate)
VALUES(TO_DATE('2009-03-30 12:30:00', 'YYYY-MM-DD HH:mi:ss')); 
```

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2009-03-30T18:11:49.710

尝试使用 DateTime.TryParse(text) 或 DateTime.Parse(text)

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2019-03-06T16:46:13.047

最简单的方法：

```
DateTime inputDate = Convert.ToDateTime("01/01/2019"); //<---Input Sample Date in format

string queryParameters = String.Format("SELECT * FROM TABLE WHERE DATE = '{0}')", inputDate.ToString("dd-MMM-yyyy")); //<-- Converts System.DateTime into Oracle DateTime

//Forget looking anywhere else for an answer, copy and paste and reform this very code 
//and see the results 
```

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2009-03-30T18:29:26.453

请绑定您的变量（如 ocdecio 所说）！它不仅可以防止 sql 注入，而且速度更快。特别是在多并发的情况下。在这里阅读示例：http: [//download.oracle.com/docs/cd/B28359_01/appdev.111/b28844/building_odp.htm#CEGCGDAB](http://download.oracle.com/docs/cd/B28359_01/appdev.111/b28844/building_odp.htm#CEGCGDAB)。

“绑定变量是 SQL 语句中的占位符，当数据库收到一条 SQL 语句时，它会判断该语句是否已经执行并存储在内存中。如果该语句确实存在于内存中，Oracle 数据库可以重用它并跳过解析和优化语句。**使用绑定变量使语句可以在不同的输入值下重复使用。**使用绑定变量还可以提高数据库中的查询性能，消除对输入中文字引号的特殊处理的需要，并防止 SQL 注入攻击。 "

* * *

## 回答 #7

> 赞同：0
> 
> 时间：2016-10-05T17:15:46.927

我知道这是一个问得很糟糕的问题，但是当我遇到同样的问题并遇到这个问题时，我看到了一些糟糕的答案。这就是我解决它的方法，我将使用 OP 的上下文来回答：

将日期解析为`DateTime`变量：

```
DateTime myDate = DateTime.Parse(txt); 
```

然后参数化您的查询：

```
sql = "insert into Table(MyDate) values (:myDate)"; 
```

设置一个`OracleParameter`：

```
OracleParameter param = new OracleParameter();
param.ParameterName = "myDate";
param.OracleDbType = OracleDbType.Date;
param.Value = myDate; 
```

假设您已经有了`OracleConnection`as `connection`，设置您的命令并添加您的参数：

```
OracleCommand cmd = new OracleCommand(sql, connection);
cmd.Parameters.Add(param); 
```

执行：

```
cmd.ExecuteNonQuery(); 
```

不要*把*时间浪费在任何`TO_DATE`废话上。这适用于当您直接使用 SQL*Plus 或 Oracle SQL Developer 添加内容时，或者您可能希望以期望的精确格式发送 STRING 变量的值（不是 DateTime 变量），并且您在其中的构造中`TO_DATE`分配`TO_DATE`您的查询或存储过程（即`to_date('2013-05-13 12:13:14', 'YYYY-MM-DD HH24:MI:SS')`。使用`DateTime`变量并将其分配给`OracleParameter`带有`OracleDbType`of的变量`OracleDbType.Date`，假设您`DATE`的表中有一个字段并且可以解析`txt`为`DateTime`变量，但是，这是最好和最简单的。

# asp.net - 惠普质量中心 API + ASP.NET

> ID：698340
> 
> 赞同：2
> 
> 时间：2009-03-30T18:06:13.950
> 
> 标签：asp.net, api, asp.net-2.0

有没有人使用过 ASP 或 ASP.NET 通过 API 连接到 HPQC？我在哪里可以找到这种互动的一些例子？任何关于此事的方向将不胜感激。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-09-01T17:35:17.850

我想通过查看 QC Open Test Architecture API 文档就可以了。有很多基于 VB 的示例。在 ASP 上实现它的唯一区别是您需要安装 QC API，您的 Web 服务器将在其中执行 Active Server Pages。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2011-08-18T00:15:21.060

开放式测试架构 (OTA) API 作为 OTAClient.dll 中的 COM 库提供（安装 HP Quality Center Client Side Setup Add-in -- QCExplorer 时包含该库。）您可以将 DLL 作为 COM 对象引用.NET 包装器。

# c++ - 我需要一个具有多个值的键。你会推荐什么数据结构？

> ID：698345
> 
> 赞同：15
> 
> 时间：2009-03-30T18:06:59.830
> 
> 标签：c++, data-structures, key

我有一个字符串数组，里面装满了句子中的单词。

```
words[0] = "the"
words[1] = "dog"
words[2] = "jumped"
words[3] = "over"
words[4] = "the"
words[5] = "wall."
words[6] = "the"
words[7] = "cat"
words[8] = "fell"
words[9] = "off"
words[10] = "the"
words[10] = "house." 
```

等（愚蠢的例子，但它适用于此）

每个单词都将是一个键，其后面的单词作为它的值。所以“结束”=>“该”。一些键可以有多个值。例如，"the" => "dog" || “墙” || “猫” || “屋”。该值是从该键的值中随机选择的。

当程序运行时，它会随机选择一个单词并造句。所以它可能是这样的：“猫从狗身上掉了下来”。

我尝试实现一个地图（map myMap;），但是每个键只允许一个值（我认为）。

希望我解释得对。

* * *

## 回答 #1

> 赞同：37
> 
> 时间：2009-03-30T18:10:18.667

[`std::multimap`](http://en.cppreference.com/w/cpp/container/multimap)

该链接提供了一个很好的例子。引用如下：

```
 int main()
{
  multimap<const char*, int, ltstr> m;

  m.insert(pair<const char* const, int>("a", 1));
  m.insert(pair<const char* const, int>("c", 2));
  m.insert(pair<const char* const, int>("b", 3));
  m.insert(pair<const char* const, int>("b", 4));
  m.insert(pair<const char* const, int>("a", 5));
  m.insert(pair<const char* const, int>("b", 6));

  cout << "Number of elements with key a: " << m.count("a") << endl;
  cout << "Number of elements with key b: " << m.count("b") << endl;
  cout << "Number of elements with key c: " << m.count("c") << endl;

  cout << "Elements in m: " << endl;
  for (multimap<const char*, int, ltstr>::iterator it = m.begin();
       it != m.end();
       ++it)
   cout << "  [" << (*it).first << ", " << (*it).second << "]" << endl;
} 
```

* * *

## 回答 #2

> 赞同：7
> 
> 时间：2009-06-15T20:27:34.487

如果您使用的是 C++，那么只需创建一个类来表示您的键值对：

```
Class foo {
    key : String
    values : list of values
} 
```

然后，创建一个映射，将每个键映射到包含其值的对象。

这很简单，可扩展，并且可以用任何 OO 语言完成。

抱歉，我的 C++ 生锈了，所以语法错误，但基本思想很简单。

* * *

## 回答 #3

> 赞同：6
> 
> 时间：2009-03-30T19:02:44.937

您可以使用 STL 中的多图并使用调用

```
pair<iterator, iterator> equal_range(const key_type& k) 
```

获得一系列与您的键匹配的迭代器

我个人觉得这有点笨拙，因为必须处理迭代器范围，而不仅仅是获取代表该键所有值的对象。为了解决这个问题，您还可以将向量存储在常规地图中并将字符串添加到向量中。

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2018-02-08T21:16:40.770

我发现结构可能适用于这种情况。这种方法（基本上类似于类）允许更清晰地访问您认为合适的参数。

```
struct car_parts {

    string wheelType;
    string engine;
    int number_of_cylinders;

    car_parts(string _wheelType, string _engine, int _number_of_cylinders)
    {
        wheelType = _wheelType;
        engine = _engine;
        number_of_cylinders = _number_of_cylinders;
    }
};

int main()
{
    // Populate the dictionary
    map<char, car_parts> vehicles =
    {
        { 'I', car_parts("All terrain", "X2", 6) },
        { 'C', car_parts("Summer only", "BB", 8) },
        { 'U', car_parts("All terrain", "X3", 4) }
    };

    map<char, car_parts>::iterator it;

    it = vehicles.find('I');

    if (it != vehicles.end())
    {
        cout << "The vehicle with key of I has " << it->second.number_of_cylinders << " cylinders\n";
    }
} 
```

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2009-03-30T18:13:07.770

正如其他两个人指出的那样，`std::multimap`可以成为您的解决方案。

还要考虑[std::tr1::unordered_multimap](http://msdn.microsoft.com/en-us/library/bb982291.aspx)。`VS 2008`它似乎有它可用`GCC`，至少从 version 有它`4.3`。

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2017-09-03T21:17:44.700

您也可以使用`unordered_map<char,vector<string>>`它对地图结构有一些好处。如果你的字典像`'c': "cat"`, `'c':"car"`, , `'a':apple`,你可以做这样的插入`'a':"angus"`：

```
unordered_map<char, vector<string>> char_to_strings_map;
//loop to traverse the dictionary : key:c, value:s
  char_to_strings_map[c].emplace_back(s);
//loop ends 
```

* * *

## 回答 #7

> 赞同：0
> 
> 时间：2017-10-14T05:55:39.963

可以有另一种方法来实现每个键两个值，特别是对于大多数地图元素每个键有两个值的情况。通过配对一个键的两个值，如此[链接](https://stackoverflow.com/questions/5560573/stdmap-one-key-two-values)中所述：

```
std::map<std::string, std::pair<std::int, int> > myMap2 
```

在函数中使用它：

```
#include<iostream>
#include<map>
#include<iterator>
using namespace std;
int main(){
map<string,pair<int,int>>mp;
mp.insert(pair<string,pair<int,int>>("ab",make_pair(50,7)));
mp.insert(pair<string,pair<int,int>>("cd",make_pair(51,8)));
map<string,pair<int,int>>::iterator it;
for(it=mp.begin();it!=mp.end();it++)
    cout<<it->first<<" "<<it->second.first<<" "<<it->second.second<<" ";
return 0;
} 
```

# java - 需要一种优雅的方式在指定的时间间隔内调用任意代码

> ID：698352
> 
> 赞同：2
> 
> 时间：2009-03-30T18:08:32.930
> 
> 标签：java, design-patterns, quartz-scheduler

好的，我有一个运行在 Java/Hibernate/Spring/Quartz 中的游戏服务器。游戏时钟与 Quartz 计时器一起滴答作响，效果很好。

然而，我还有许多其他事情需要在特定的、可调整的时间间隔内发生（在游戏时间，而不是实时）。

例如，每 24 小时游戏时间（约 47 分钟实时，取决于服务器时钟倍数）就会发生一堆不同的一天一次的游戏动作，比如补给，或者你有什么。

现在，当前系统非常粗糙，但是可以工作 - 我在数据库中有一个表，它本质上是一个 cron - 一个字符串键，下一个事件的执行时间，然后是小时、分钟、秒和天，直到下一个事件. 时间记录器会检查这一点，然后将包含该代码（事件字符串键）的消息发送到队列中，将天、分钟、秒添加到当前时间并将其设置为下一个执行时间。

消息监听器是最重要的部分——它打开按键并点击它的一种方法。

现在我明白这可以很好地工作，但它真的不适合我。你的解决方案是什么，让每段代码都放在自己的小类中？什么设计模式涵盖了这个？（我确定有一个）。我有一些想法，但我想听听一些意见。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-03-30T20:59:04.423

您可以使用散列表来调度这些事件，而不是打开密钥。这样，您的计时器事件就不需要相互了解。

应该有可能有类似的东西：

```
timerQueue.registerHandler("key",new TimerHandler(){
   // do something timer related  
}); 
```

这样，您可以重新启动 java 代码处理事件，而不会丢失持久的事件队列。

http://en.wikipedia.org/wiki/Priority_queue'>如果您还没有，优先队列值得一看。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-03-30T19:22:09.523

我会使用`Command Pattern`. 我会扩展命令模式来创建一个 IIntervalCommand 类。除了 Execute 方法之外，它还有一个 interval 属性和一个只读 CanExecute 属性。

然后创建一个包含 IIntervalCommand 列表的 CommandList 类。它将有一个名为 CheckToExecute 的方法，您可以将当前游戏时间传递给它。CheckToExecute 方法将遍历为每个命令调用 CanExecute 的列表。如果经过的时间已经过去，CanExecute 将返回 true。如果 CanExecute 返回 true，则 CheckToExecute 将调用实现 IIntervalCommand 的对象的 Execute 方法。

然后添加额外的游戏事件就是创建一个实现 IIntervalClass 的新类。实例化对象并将其添加到 IntervalCommandList。

如果事件的处理很耗时，那么该命令可以将处理作为单独的线程产生。即使间隔再次过去，它也会向其 CanExecute 属性返回 false ，直到线程返回。或者，如果间隔再次过去，你让它产生另一个线程。

你避免了巨大的案例陈述。您可以在实例化对象时消除数据库并设置参数。或者保留它并将其用作创建所有 IIntervalCommands 的工厂的一部分。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2009-03-30T18:30:35.420

您可以将代码用作映射中的键，而不是打开一组代码，其中值是实现处理程序接口的对象。这使您可以更加灵活地添加新的事件类型。

该模式看起来像这样：

```
private final Map<String, Handler> handlers = new TreeMap<String, Handler>();

public void register(String event, Handler handler) { 
  handlers.put(event, handler); 
}

public void handle(String event) {
  Handler handler = handler.get(event);
  if (handler == null) {
    /* Log or throw an exception for unknown event type. */
  }
  else {
    handler.execute();
  }
} 
```

您可以使用 Java 6 之类的东西来添加新行为，而不是显式注册处理程序，`ServiceLoader`只需将 JAR 放到类路径中即可。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2009-03-30T18:37:59.147

从概念上讲，我认为您正在做两件事；

首先，您有一个缩放版本的*time*。只要这个时间和挂钟时间之间的关系保持不变，我很确定我只是将这种缩放行为委托给一个类，它会有像这样的签名

```
DateTime getFutureTime( VirtualTimeSpan timespan) 
```

我将使用它来将虚拟时间跨度映射到实时实例。此后您可以实时操作，这可能会简化一些事情，因为您可以使用标准调度功能。

第二部分关于为未来的工作进程安排工作。有许多核心技术与此相关；从概念上讲，我认为[JMS](http://en.wikipedia.org/wiki/Java_Message_Service)是其中许多的 Java 祖父，它定义的概念与您正在使用的概念和您需要的概念非常相似。我认为查看 JMS 可以很好地了解您可能会感兴趣的概念，它使用选择器将任务发送给特定的工作人员，就像您描述的工作人员一样。

唉，JMS 似乎从来不适合大多数人。很多人发现它过于重量级或实现过于错误。所以通常人们最终会使用自制的队列技术。但是概念都在那里。你不能只用石英吗？

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2009-03-30T18:13:58.253

我个人不会把它放在数据库中，而是让一个单独的服务在后台运行。然后我的 Web 服务或 Web 应用程序将通过进程间通信与该服务进行通信。不知道这如何转化为 java 世界。

# c# - 手动增加新行的 PK 时如何避免数据库竞争条件

> ID：698366
> 
> 赞同：6
> 
> 时间：2009-03-30T18:10:26.390
> 
> 标签：c#, sql-server, database, vb.net, asp.net-2.0

我在 SQL Server 2005 中有一个旧数据表，它有一个没有身份/自动增量的 PK，也没有实现它的权力。

结果，我被迫通过 ole "SELECT MAX(id) + 1 FROM table"-before-insert 技术在 ASP.NET 中手动创建新记录。

显然，在同时插入的情况下，这会在 ID 上创建一个竞争条件。

优雅地解决比赛碰撞事件的最佳方法是什么？我正在寻找 VB.NET 或 C# 代码思路，即检测碰撞，然后通过获取另一个 max(id) + 1 重新尝试失败的插入。可以这样做吗？

想法？评论？智慧？

谢谢！

注意：如果我无法以任何方式更改数据库怎么办？

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2009-03-30T18:14:23.680

创建一个带有标识列的辅助表。在事务插入到辅助表中，检索值并使用它插入到您的旧表中。此时你甚至可以删除在 aux 表中插入的行，重点只是将其用作增量值的来源。

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2009-03-30T18:36:52.050

无法更改数据库架构是很苛刻的。

如果您将现有的 PK 插入表中，您将收到 SqlException 并显示一条指示违反 PK 约束的消息。捕获此异常**并重试插入几次，**直到成功。如果你发现碰撞率太高，你可以尝试`max(id) + <small-random-int>`代替`max(id) + 1`。请注意，使用这种方法，您的 id 将有间隙，并且 id 空间将很快耗尽。

另一种可能的方法是在数据库之外**模拟自动递增 id 。**例如，创建一个静态整数，`Interlocked.Increment`每次需要下一个 id 并使用返回值。棘手的部分是将这个静态计数器初始化为良好的值。我会这样做`Interlocked.CompareExchange`：

```
class Autoincrement {
  static int id = -1;
  public static int NextId() {
    if (id == -1) {
      // not initialized - initialize
      int lastId = <select max(id) from db>
      Interlocked.CompareExchange(id, -1, lastId);
    }
    // get next id atomically
    return Interlocked.Increment(id);
  }
} 
```

显然，后者仅在通过`Autoincrement.NextId`单个进程获得所有插入的 id 时才有效。

* * *

## 回答 #3

> 赞同：3
> 
> 时间：2009-03-30T18:27:55.363

关键是在一份声明或一笔交易中完成。

你能做这个吗？

```
INSERT (PKcol, col2, col3, ...)
SELECT (SELECT MAX(id) + 1 FROM table WITH (HOLDLOCK, UPDLOCK)), @val2, @val3, ... 
```

如果不进行测试，这也可能会起作用：

```
INSERT (PKcol, col2, col3, ...)
VALUES ((SELECT MAX(id) + 1 FROM table WITH (HOLDLOCK, UPDLOCK)), @val2, @val3, ...) 
```

如果不能，另一种方法是在触发器中进行。

1.  触发器是 INSERT 事务的一部分
2.  对 MAX 使用 HOLDLOCK、UPDLOCK。这将保持行锁直到提交
3.  正在更新的行在持续时间内被锁定

第二次插入将等到第一次完成。缺点是您正在更改主键。

辅助表必须是事务的一部分。

或者按照建议更改架构...

* * *

## 回答 #4

> 赞同：3
> 
> 时间：2009-03-30T18:45:42.390

**注意：您所需要的只是不断增加的整数的来源。它不必来自同一个数据库，甚至根本不需要来自一个数据库。**

就个人而言，我会使用[SQL Express](http://www.microsoft.com/express/sql/)，因为它免费且简单。

**如果您有一个 Web 服务器：** 在 Web 服务器上创建一个 SQL Express 数据库，其中包含一个表 [ids] 和一个自动递增字段 [new_id]。在此 [ids] 表中插入一条记录，获取 [new_id]，并将其作为相关表的 PK 传递到您的数据库层。

**如果您有多个 Web 服务器：** 设置起来很麻烦，但是您可以通过设置适当的种子/增量来使用相同的技巧（即增量 = 3，三个 Web 服务器的种子 = 1/2/3）。

* * *

## 回答 #5

> 赞同：2
> 
> 时间：2009-03-30T18:32:52.093

在可序列化事务中运行整个批次（选择 id 和插入）怎么样？

这应该让您无需在数据库中进行更改。

* * *

## 回答 #6

> 赞同：1
> 
> 时间：2009-03-30T18:14:41.310

最好的解决方案是更改数据库。您可能无法将该列更改为标识列，但您应该能够确保该列存在唯一约束并添加一个以现有 PK 为种子的新标识列。然后要么使用新列，要么使用触发器使旧列镜像新列，或两者兼而有之。

* * *

## 回答 #7

> 赞同：1
> 
> 时间：2009-03-30T18:47:04.663

主要关注并发访问吗？我的意思是，您的应用程序的多个实例（或者，上帝保佑，您无法控制的其他应用程序）会同时执行插入操作吗？

如果没有，您可能可以通过应用程序中的中央同步模块管理插入，并完全避免竞争条件。

如果是这样，那么...就像乔尔说的那样，更改数据库。我知道你不能，但是这个问题已经存在很久了，而且已经很好地解决了——在数据库级别。如果你想自己修复它，你只需要一遍又一遍地循环（插入、检查冲突、删除）。根本问题是，如果您没有数据库的支持，您将无法执行事务（我的意思不是在 SQL“事务”意义上，而是在更大的数据理论意义上）。

我唯一的进一步想法是，如果您至少可以控制谁可以访问数据库（例如，只有您编写或批准的“授权”应用程序），您可以实现各种边带互斥锁，其中所有应用程序都共享一个“谈话棒”，并且需要互斥体的所有权才能进行插入。但是，那将是它自己的毛茸茸的蜡球，因为您必须弄清楚死客户的策略，托管位置，配置问题等。当然，“流氓”客户可以在没有说话棒的情况下进行插入软管整个设置。

# winforms - 如何禁用 WinForms TreeView 节点复选框？

> ID：698369
> 
> 赞同：20
> 
> 时间：2009-03-30T18:10:49.167
> 
> 标签：winforms, treeview, treenode

我需要能够禁用 WinForms 应用程序控件中的某些复选框，但标准控件`TreeView`中没有内置此类功能。`TreeView`

我已经在使用该`TreeView.BeforeCheck`事件并在节点被禁用并且工作正常时取消它。

我还将`ForeColor`禁用节点的 更改为`GrayText`.

有没有人有一个简单而强大的解决方案？

* * *

## 回答 #1

> 赞同：36
> 
> 时间：2009-04-14T16:08:14.420

由于在 C++ 中有支持，我们可以使用 p/invoke 解决它。

这是 p/invoke 部分的设置，只需将其提供给调用类即可。

```
 // constants used to hide a checkbox
    public const int TVIF_STATE = 0x8;
    public const int TVIS_STATEIMAGEMASK = 0xF000;
    public const int TV_FIRST = 0x1100;
    public const int TVM_SETITEM = TV_FIRST + 63;

    [DllImport("user32.dll")]
    static extern IntPtr SendMessage(IntPtr hWnd, uint Msg, IntPtr wParam,
    IntPtr lParam); 

    // struct used to set node properties
    public struct TVITEM
    {
        public int mask;
        public IntPtr hItem;
        public int state;
        public int stateMask;
        [MarshalAs(UnmanagedType.LPTStr)]
        public String lpszText;
        public int cchTextMax;
        public int iImage;
        public int iSelectedImage;
        public int cChildren;
        public IntPtr lParam;

    } 
```

我们要逐个节点地确定。最简单的方法是在绘制节点事件上。我们必须将我们的树设置为为该事件绘制的所有者，因此请务必将其设置为默认设置以外的其他设置。

```
this.tree.DrawMode = TreeViewDrawMode.OwnerDrawText;
this.tree.DrawNode += new DrawTreeNodeEventHandler(tree_DrawNode); 
```

在您的 tree_DrawNode 函数中确定正在绘制的节点是否应该有一个复选框，并在适​​当时将其隐藏。然后将 Default Draw 属性设置为 true，因为我们不想担心绘制所有其他细节。

```
void tree_DrawNode(object sender, DrawTreeNodeEventArgs e)
{
    if (e.Node.Level == 1)
    {
        HideCheckBox(e.Node);
        e.DrawDefault = true;
    }
    else 
    {
        e.Graphics.DrawString(e.Node.Text, e.Node.TreeView.Font,
           Brushes.Black, e.Node.Bounds.X, e.Node.Bounds.Y);
    }
} 
```

最后，对我们定义的函数的实际调用：

```
private void HideCheckBox(TreeNode node)
{
    TVITEM tvi = new TVITEM();
    tvi.hItem = node.Handle;
    tvi.mask = TVIF_STATE;
    tvi.stateMask = TVIS_STATEIMAGEMASK;
    tvi.state = 0;
    IntPtr lparam = Marshal.AllocHGlobal(Marshal.SizeOf(tvi));
    Marshal.StructureToPtr(tvi, lparam, false);
    SendMessage(node.TreeView.Handle, TVM_SETITEM, IntPtr.Zero, lparam);
} 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2020-03-30T15:19:56.920

这是 PowerShell 版本，非常感谢 @sam-trost 的救命代码！

P/调用：

```
$TypeDefinition = @'
using System;
using System.Runtime.InteropServices;
namespace Win32Functions {
    public class Win32TreeView {
        // constants used to hide a checkbox
        public const int TVIF_STATE = 0x8;
        public const int TVIS_STATEIMAGEMASK = 0xF000;
        public const int TV_FIRST = 0x1100;
        public const int TVM_SETITEM = TV_FIRST + 63;

        [DllImport("user32.dll", SetLastError = true)]
        public static extern IntPtr SendMessage(IntPtr hWnd, uint Msg, IntPtr wParam, IntPtr lParam);

        // struct used to set node properties
        public struct TVITEM
        {
            public int mask;
            public IntPtr hItem;
            public int state;
            public int stateMask;
            [MarshalAs(UnmanagedType.LPTStr)]
            public String lpszText;
            public int cchTextMax;
            public int iImage;
            public int iSelectedImage;
            public int cChildren;
            public IntPtr lParam;
        }
    }
}
'@

Add-Type -TypeDefinition $TypeDefinition -PassThru 
```

事件处理程序：

```
$TreeView1_DrawNode = [System.Windows.Forms.DrawTreeNodeEventHandler]{
    #Event Argument: $_ = [System.Windows.Forms.DrawTreeNodeEventArgs]
    if ($null -ne $_.Node) {

        # P/invoke hack to hide Node CheckBox
        if ($_.Node.Level -eq 0) {
            Hide-NodeCheckBox($_.Node)
        }

        $_.DrawDefault = $true
    }
} 
```

树视图：

```
$TreeView1.DrawMode = [TreeViewDrawMode]::OwnerDrawText
$TreeView1.add_DrawNode($TreeView1_DrawNode) 
```

功能：

```
function Hide-NodeCheckBox([TreeNode]$node) {
    # P/invoke hack to hide Node CheckBox
    if ($node.TreeView.CheckBoxes) {
        $tvi = [Win32Functions.Win32TreeView+TVITEM]::new()
        $tvi.hItem = $node.Handle
        $tvi.mask = [Win32Functions.Win32TreeView]::TVIF_STATE
        $tvi.stateMask = [Win32Functions.Win32TreeView]::TVIS_STATEIMAGEMASK
        $tvi.state = 0
        [IntPtr]$lparam = [Marshal]::AllocHGlobal([Marshal]::SizeOf($tvi))
        [Marshal]::StructureToPtr($tvi, $lparam, $false)
        [Win32Functions.Win32TreeView]::SendMessage($node.TreeView.Handle, [Win32Functions.Win32TreeView]::TVM_SETITEM, [IntPtr]::Zero, $lparam)
    }
} 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-03-30T18:15:23.647

TreeView.BeforeCheck - 注册此事件，检查节点是否是允许选中复选框的节点，如果无法选中，则可以通过设置 TreeViewCancelEventArgs 上的 Cancel 属性来取消事件。这应该有望阻止用户选中这些框，但不会带来最佳的用户体验。

要删除不可选中项的复选框，您可以使用 owner-draw 在复选框上绘制一个实心矩形以将其删除。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2009-03-30T18:17:02.503

没有内置的东西可以做到这一点。您可以使用 BeforeCheck 事件并为所需节点取消它。如果复选框的外观很重要，那么您需要在此处放置图像以显示复选框已禁用。

此[链接](http://groups.google.com/groups?as_q=treeview+checkbox&num=10&scoring=r&hl=en&as_epq&as_oq&as_eq&as_ugroup&as_usubject&as_uauthors=claes+bergefall&lr&as_drrb=q&as_qdr&as_mind=1&as_minm=1&as_miny=1981&as_maxd=12&as_maxm=6&as_maxy=2006&safe=off&pli=1)可能会引起您的兴趣。

# sql - 计数 DateDiff 超出指定值

> ID：698377
> 
> 赞同：0
> 
> 时间：2009-03-30T18:11:53.780
> 
> 标签：sql, sql-server

我正在使用 SQL 2005（我认为），SQL 查询分析器版本 SQL 8.00.760。

我想编写一个查询，仅当基于报表搜索中的结束日期的截止日期超过 14 天时，才从表中将计数返回到 Crystal Report 中。基于我对 SQL 的非常有限的理解，我想出了以下内容，但事实证明这是错误的。请帮我重做或完善此声明。

```
Select
   T.NextDueDate
From
   Task_ConditionAssessment T
  begin
     IF DATEDIFF(dd,T.NextDueDate,@enddate)>14
     Count(*)
  end 
```

同样，这是不正确的，但我不确定应该采取哪些不同的做法......返回的错误是第 5 行：'count' 附近的语法不正确。

提前致谢。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-03-30T18:15:21.977

我想你想要这样的东西：

```
SELECT COUNT(*) 
FROM Task_ConditionAssessment T 
WHERE DATEDIFF(dd,T.NextDueDate,@enddate) > 14 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-03-30T18:20:28.673

尝试一下：

```
SELECT COUNT(*) 
FROM Task_ConditionAssessment 
WHERE DATEADD(dd, 21, @enddate) > NextDueDate 
```

这为您提供了从@enddate 起 14 天后的任务数。

# linq - 用于数组元素的 LIKE 查询的 LINQ

> ID：698379
> 
> 赞同：6
> 
> 时间：2009-03-30T18:12:10.927
> 
> 标签：linq, arrays, linq-to-sql

假设我有一个数组，并且我想对 varchar 执行 LINQ 查询，该查询返回在 varchar 中任何位置具有数组元素的任何记录。

这样的事情会很甜蜜。

`string[] industries = { "airline", "railroad" }`

`var query = from c in contacts where c.industry.LikeAnyElement(industries) select c`

有任何想法吗？

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2009-03-30T19:52:36.317

这实际上是我在“[表达自己](http://www.dddsouthwest.com/Agenda/tabid/55/Default.aspx)”演示文稿中使用的一个示例，用于在常规 LINQ 中难以做到的事情；据我所知，最简单的方法是手动编写谓词。我使用下面的示例（注意它同样适用于`StartsWith`等）：

```
 using (var ctx = new NorthwindDataContext())
    {
        ctx.Log = Console.Out;
        var data = ctx.Customers.WhereTrueForAny(
            s => cust => cust.CompanyName.Contains(s),
            "a", "de", "s").ToArray();
    }
// ...
public static class QueryableExt
{
    public static IQueryable<TSource> WhereTrueForAny<TSource, TValue>(
        this IQueryable<TSource> source,
        Func<TValue, Expression<Func<TSource, bool>>> selector,
        params TValue[] values)
    {
        return source.Where(BuildTrueForAny(selector, values));
    }
    public static Expression<Func<TSource, bool>> BuildTrueForAny<TSource, TValue>(
        Func<TValue, Expression<Func<TSource, bool>>> selector,
        params TValue[] values)
    {
        if (selector == null) throw new ArgumentNullException("selector");
        if (values == null) throw new ArgumentNullException("values");
        if (values.Length == 0) return x => true;
        if (values.Length == 1) return selector(values[0]);

        var param = Expression.Parameter(typeof(TSource), "x");
        Expression body = Expression.Invoke(selector(values[0]), param);
        for (int i = 1; i < values.Length; i++)
        {
            body = Expression.OrElse(body,
                Expression.Invoke(selector(values[i]), param));
        }
        return Expression.Lambda<Func<TSource, bool>>(body, param);
    }

} 
```

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2009-03-30T18:14:15.227

```
from c in contracts 
where industries.Any(i => i == c.industry)
select c; 
```

类似的东西。对集合使用 any 方法。

* * *

## 回答 #3

> 赞同：4
> 
> 时间：2009-03-30T19:26:40.667

`IEnumerable.Contains()`转换为 SQL **IN**，如下所示：

```
WHERE 'american airlines' IN ('airline', 'railroad') -- FALSE 
```

`String.Contains()`转换为 SQL **LIKE %...%**如下：

```
WHERE 'american airlines' LIKE '%airline%' -- TRUE 
```

如果您想要联系人的行业为 LIKE（包含）任何给定行业的联系人，您希望将 Any() 和 String.Contains() 组合成如下内容：

```
string[] industries = { "airline", "railroad" };

var query = from c in contacts 
            where industries.Any(i => c.Industry.Contains(i))
            select c; 
```

但是， LINQ to SQL*不*支持像这样组合 Any() 和 String.Contains() 。如果给定行业的集合很小，您可以尝试以下操作：

```
where c.Industry.Contains("airline") ||
      c.Industry.Contains("railroad") || ... 
```

或者（尽管通常不推荐）如果联系人集足够小，您可以将它们全部从数据库中获取，并使用 contacts.AsEnumerable() 或 contacts.ToList() 作为 LINQ to Objects 的过滤器作为源上面的查询：

```
var query = from c in contacts.AsEnumerable()
            where industries.Any(i => c.Industry.Contains(i))
            select c; 
```

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2010-10-05T08:30:21.793

如果您按如下方式构建查询，它将起作用：

var query = from c in contacts.AsEnumerable() select c;

query = query.Where(c=> (c.Industry.Contains("airline")) || (c.Industry.Contains("railroad")));

如果参数航空公司和铁路是用户输入，您只需要以编程方式生成上面的字符串。这实际上比我预期的要复杂一些。见文章 - [http://www.albahari.com/nutshell/predicatebuilder.aspx](http://www.albahari.com/nutshell/predicatebuilder.aspx)

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2009-03-30T18:14:46.723

不幸的是，LINQ to SQL 不支持 LIKE，如下所示：

[http://msdn.microsoft.com/en-us/library/bb882677.aspx](http://msdn.microsoft.com/en-us/library/bb882677.aspx)

为了解决这个问题，您必须编写一个存储过程，该过程将接受您要在 like 语句中使用的参数，然后从 LINQ 到 SQL 调用它。

* * *

应该注意的是，一些答案建议使用包含。这将不起作用，因为它看起来会看到整个字符串与数组元素匹配。正在寻找的是将数组元素包含在字段本身中，例如：

```
industry LIKE '%<element>%' 
```

正如克拉克在评论中提到的，您可以在每个元素上使用对 IndexOf 的调用（这应该转换为 SQL 调用）：

```
string[] industries = { "airline", "railroad" }

var query = 
    from c in contacts 
    where
        c.industry.IndexOf(industries[0]) != -1 ||
        c.industry.IndexOf(industries[1]) != -1 
```

如果您知道数组的长度和元素的数量，那么您可以对其进行硬编码。如果您不这样做，那么您将不得不根据您正在查看的数组和字段创建 Expression 实例。

# web-services - BizTalk 2006 R2 EDI

> ID：698387
> 
> 赞同：1
> 
> 时间：2009-03-30T18:13:34.540
> 
> 标签：web-services, biztalk, edi, x12

我有一个工作编排来处理 X12 消息。现在我需要将编排公开为接受文本输入（X12 消息）并返回文本响应（X12 响应）的 Web 服务 (ASMX)。如果我尝试使用该向导，生成的 Web 服务将公开 X12 请求的内部 XML 表示，而不是其原始纯文本表示。

简而言之，我希望能够连接到 Web 服务（ASMX 而不是 WCF 服务），发送 X12 请求（纯文本）并获得适当的响应（也是纯文本）。

我已经看到使用 WCF 的示例，但没有使用简单的 web 服务。你能帮我解决这个问题吗？

谢谢！

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-03-31T02:01:20.640

一种可能的解决方案是创建一个 SOAP 处理程序来将纯文本转换为 xml 表示形式（以便 BizTalk 可以读取它）并再次返回。虽然我自己没有尝试过，但它可能会起作用。您需要为请求创建一个处理程序，并为响应创建一个处理程序以拦截字符串并将其转换为 xml 模式并再次返回。您还可以查看使用通用 XML 文档而不是字符串，这可能是最简单的。看看这篇文章：

[http://blogs.msdn.com/richardbpi/archive/2006/11/10/exposing-biztalk-web-services-that-accept-generic-content.aspx](http://blogs.msdn.com/richardbpi/archive/2006/11/10/exposing-biztalk-web-services-that-accept-generic-content.aspx)

-布莱恩

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-03-31T07:15:29.140

虽然我没有尝试过，但我有一种感觉，如果在管道中没有某种程度的自定义编码，你将无法做到这一点。

当您使用向导发布 Web 服务时，BizTalk 会采用涉及的架构并将它们用作 Web 服务的类型，这在几乎所有情况下都有意义，但在您的情况下则不然。

但是，据我所知，没有很好的方法来通过 SOAP 获取 EDI 消息；您可以创建您的 Web 服务来接受字符串消息并让客户端“知道”它需要是 X12，但是没有办法在 WSDL 中描述它。

但是，如果您这样做，您将在进入反汇编程序和编排之前将 X12 消息放入管道中，包装在一个元素中（或类似的东西，取决于您修改 Web 服务的方式）你将不得不有一些代码来删除它，但这应该相对容易编写。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-08-21T12:05:25.367

我还将我的 x12 260 文件转换为 SOAP Webservice 。最好的方法是什么……我正在转换为 XML 并发送到 SOAP……但这里的问题是我只得到 3 个 xml，其中只有该文件中的事务详细信息……我的页眉和预告片去了哪里:(

任何人都遇到过这样的问题

# javascript - jQuery 插件中的 Ajax 调用无法正常工作

> ID：698388
> 
> 赞同：1
> 
> 时间：2009-03-30T18:13:47.707
> 
> 标签：javascript, jquery-plugins, jquery

我正在尝试创建一个 jQuery 插件，在里面我需要做一个 AJAX 调用来加载一个 xml。

```
jQuery.fn.imagetags = function(options) {

  s = jQuery.extend({
     height:null,
     width:null,
     url:false,
     callback:null,
     title:null,
  }, options);

  return this.each(function(){
    obj = $(this);

    //Initialising the placeholder  
    $holder = $('<div />')
    .width(s.width).height(s.height)
    .addClass('jimageholder')
    .css({
        position: 'relative',
    });
    obj.wrap($holder);

    $.ajax({
      type: "GET",
      url: s.url,
      dataType: "xml",
      success:function(data){ initGrids(obj,data,s.callback,s.title); } ,
      error: function(data) { alert("Error loading Grid data."); },
    });

    function initGrids(obj, data,callback,gridtitle){
    if (!data) {
      alert("Error loading Grid data");
    }

    $("gridlist gridset",data).each(function(){
      var gridsetname = $(this).children("setname").text();
      var gridsetcolor = "";
      if ($(this).children("color").text() != "") {
        gridsetcolor = $(this).children("color").text();
      }
      $(this).children("grid").each(function(){     
        var gridcolor = gridsetcolor;
        //This colour will override colour set for the grid set
        if ($(this).children("color").text() != "") {
          gridcolor = $(this).children("color").text();
        }

        //addGrid(gridsetname,id,x,y,height,width)
        addGrid(
            obj,
            gridsetname,
            $(this).children("id").text(),
            $(this).children("x").text(),
            $(this).children("y").text(),
            $(this).children("height").text(),
            $(this).children("width").text(),
            gridcolor,
            gridtitle
        );

      });
    });

    }

    function addGrid(obj,gridsetname,id,x,y,height,width,color,gridtitle){
      //To compensate for the 2px border
      height-=4;
      width-=4;

      $grid = $('<div />')
        .addClass(gridsetname)
        .attr("id",id)
        .addClass('gridtag')
        .imagetagsResetHighlight()
        .css({
        "bottom":y+"px",
        "left":x+"px",
        "height":height+"px",
        "width":width+"px",
         });
       if(gridtitle != null){
         $grid.attr("title",gridtitle);
       }

      if(color != ""){
        $grid.css({
        "border-color":color,
        });
      }
      obj.after($grid);
    }
  });
} 
```

上面的插件我绑定了 2 个 DOM 对象并加载了两个单独的 XML 文件，但回调函数仅在使用两个加载的 XML 文件的最后一个 DOM 对象上运行。

我该如何解决这个问题，以便将回调应用于相应的 DOM。上面的ajax调用是否正确？

示例用法：

```
<script type="text/javascript">
        $(function(){
            $(".romeo img").imagetags({
              height:500,
              width:497,
              url: "sample-data.xml",
              title: "Testing...",
              callback:function(id){
                console.log(id);
              },
            });
        });
       </script>
       <div class="padding-10 min-item background-color-black">
         <div class="romeo"><img src="images/samplecontent/test_500x497.gif" alt="Image"> </div>
       </div>

<script type="text/javascript">
        $(function(){
            $(".romeo2 img").imagetags({
              height:500,
              width:497,
              url: "sample-data2.xml",
              title: "Testing...",
              callback:function(id){
                console.log(id);
              },
            });
        });
       </script>
       <div class="padding-10 min-item background-color-black">
         <div class="romeo2"><img src="images/samplecontent/test2_500x497.gif" alt="Image"> </div>
       </div> 
```

这是示例 XML 数据：

```
<?xml version="1.0" encoding="utf-8"?>
<gridlist>
    <gridset>
      <setname>gridset4</setname>
      <color>#00FF00</color>
      <grid>
        <color>#FF77FF</color>
        <id>grid2-324</id>
        <x>300</x>
        <y>300</y>
        <height>60</height>
        <width>60</width>
     </grid>
    </gridset>
    <gridset>
      <setname>gridset3</setname>
      <color>#00FF00</color>
      <grid>
        <color>#FF77FF</color>
        <id>grid2-212</id>
        <x>300</x>
        <y>300</y>
        <height>100</height>
        <width>100</width>
     </grid>
     <grid>
        <color>#FF77FF</color>
        <id>grid2-1212</id>
        <x>200</x>
        <y>10</y>
        <height>200</height>
        <width>10</width>
     </grid>
   </gridset>
</gridlist> 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2009-03-30T18:19:44.277

您可能会遇到问题，因为您在同一个 url 上调用 ajax 加载，因此第二次调用取消了第一次调用。

如果您为每个 div 读取相同的 url，为什么不调用一次 ajax，然后在它返回时循环元素。

```
jQuery.fn.imagetags = function(options) {

  s = jQuery.extend({
     height:null,
     width:null,
     url:false,
     callback:null,
     title:null,
  }, options);

  var elems = $(this);

  $.ajax({
      type: "GET",
      url: s.url,
      dataType: "xml",
      success:function(data){ 
        elems.each(function() {     
          obj = $(this);

          //Initialising the placeholder  
          $holder = $('&lt;div /&gt;')
          .width(s.width).height(s.height)
          .addClass('jimageholder')
          .css({
              position: 'relative',
          });
          obj.wrap($holder); 
          initGrids(obj,data,s.callback,s.title); 
        });
      },
      error: function(data) { alert("Error loading Grid data."); }
    });

  return $(this);
} 
```

基本上，您在这里所做的是调用 ajax 函数然后立即返回集合。然后，当 ajax 回调被触发时，您循环元素并附加数据。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-12-15T16:02:29.227

这可能是一个范围界定问题。在函数内声明变量时应该使用“var”语句。否则，变量将进入全局范围。

```
var s = jQuery.extend({
     height:null,
     width:null,
     url:false,
     callback:null,
     title:null,
  }, options);

elems.each(function() {     
      var obj = $(this);

      ....
} 
```

由于变量存在于全局范围内，它们会被循环中的每次迭代覆盖，并最终导致最后一个 DOM 元素。

# oracle - 如何在 .NET 中关闭 OracleConnection

> ID：698397
> 
> 赞同：9
> 
> 时间：2009-03-30T18:14:46.783
> 
> 标签：oracle, database-connection, dispose, using

假设我有这两个对象：

```
OracleConnection connection = new OracleConnection(connectionString);  
OracleCommand command = new OracleCommand(sql, connection); 
```

要关闭连接或 Oracle，我是否必须调用 command.Dispose()、connection.Dispose() 或两者都调用？

这是否足够好：

```
using(connection)  
{
    OracleDataReader reader = cmd.ExecuteReader();
    // whatever...
} 
```

* * *

## 回答 #1

> 赞同：17
> 
> 时间：2009-03-30T18:18:39.333

```
using (OracleConnection connection = new OracleConnection(connectionString))
{
    using (OracleCommand command = new OracleCommand(sql, connection))
    {
        using (OracleDataReader reader = cmd.ExecuteReader())
        {
        }
    }
} 
```

如果它实现了 IDisposable，并且如果您创建它，则将其放入 using 块中。

* * *

## 回答 #2

> 赞同：7
> 
> 时间：2009-03-30T19:09:46.340

这两个答案都非常有针对性。您总是想在任何 IDisposeable 对象上调用 .Dispose() 。通过包装在“使用”中，编译器总是为您隐含一个 try/finialy 块。

1点注意，如果你想避免嵌套，你可以这样写相同的代码：

```
 using (OracleConnection connection = new OracleConnection(connectionString))
 using (OracleCommand command = new OracleCommand(sql, connection))
 using (OracleDataReader reader = cmd.ExecuteReader())
    {
        // do something here
    } 
```

* * *

## 回答 #3

> 赞同：3
> 
> 时间：2009-03-30T19:08:19.433

`using`将确保您的连接已关闭。您还可以在调用之前传递`CommandBehavior.CloseConnection`给命令的方法以将其关闭。`ExecuteReader``Dispose`

* * *

## 回答 #4

> 赞同：3
> 
> 时间：2009-03-30T18:15:32.697

这已经足够好了。using 语句将包装 dispose 语句，因此即使抛出异常，您也很安全，这是我处置资源的首选方式。

```
using(OracleConnection connection = new OracleConnection(connectionString);    )  
{
   //Create a command object 
    using(OracleCommand command = new OracleCommand(sql, connection))
    {
      using(OracleDataReader reader = cmd.ExecuteReader())
      {
      }

    }
    // whatever...
} 
```

我认为通过使用“使用”，你是要求编译器注入一个 try ... finally 块，在 finally 块中，它会为你关闭一次性对象。

# c# - 通过套接字接收消息

> ID：698398
> 
> 赞同：0
> 
> 时间：2009-03-30T18:14:54.913
> 
> 标签：c#, sockets

在 c# 中模拟 lan-messenger 时，我使用环回地址仅用于测试当前代码并且能够接收我发送的第一条消息。但是之后没有任何消息到达套接字。有什么要清除套接字缓冲区做什么？请帮助这是建立连接时的回调函数：

```
private void accepted(IAsyncResult iar)
    {
        Socket server = (Socket)iar.AsyncState;
        Socket client = server.EndAccept(iar);
        if (client.Connected)
        {
            try
            {
                client.BeginReceive(receive, 0, receive.Length, System.Net.Sockets.SocketFlags.None, new AsyncCallback(rec), client);
            }
            catch (ArgumentException)
            {
                MessageBox.Show("arguments incorrect in begin-receive call", "Error", MessageBoxButtons.OK);
            }
            catch (SocketException)
            {
                MessageBox.Show("error in accessing socket while receiving", "Error", MessageBoxButtons.OK);
            }
            catch (ObjectDisposedException)
            {
                MessageBox.Show("socket closed while receiving", "Error", MessageBoxButtons.OK);
            }
            catch (Exception)
            {
                MessageBox.Show("error while receiving", "Error", MessageBoxButtons.OK);
            }

        } 
```

这是执行 begin-receive 方法时的回调函数：

```
void rec(IAsyncResult ar)
    {

        StringBuilder receivedData;
        //String oldvalue;
        Socket remote = (Socket)ar.AsyncState;
        int recv = remote.EndReceive(ar);
        receivedData = new StringBuilder(Encoding.ASCII.GetString(receive, 0, recv));
        //MessageBox.Show(receivedData.ToString(), "received", MessageBoxButtons.OK);
        StringBuilder sb = new StringBuilder(this.textBox1.Text);
        sb.AppendLine(receivedData.ToString());
        if (textBox1.InvokeRequired)
        {
            this.Invoke((MethodInvoker)delegate { this.textBox1.Text = sb.ToString(); });

        }
        remote.Close(5);
        return;
    } 
```

它是否与用于将接收到的数据分配给变量的字符串构建器或字符串数​​据类型有关。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-03-30T18:27:01.497

这是关于 C# 套接字编程的 2 部分教程，带有源代码...

[http://www.devarticles.com/c/a/C-Sharp/Socket-Programming-in-C-Part-I/1/](http://www.devarticles.com/c/a/C-Sharp/Socket-Programming-in-C-Part-I/1/)

[http://www.devarticles.com/c/a/C-Sharp/Socket-Programming-in-C-sharp-Part-II/](http://www.devarticles.com/c/a/C-Sharp/Socket-Programming-in-C-sharp-Part-II/)

有什么问题完全取决于您的设计。你在投票吗？或者，您在等待活动吗？

来源为本页面所附的download.zip文件：http: [//www.developerfusion.com/article/3918/socket-programming-in-c-part-1/](http://www.developerfusion.com/article/3918/socket-programming-in-c-part-1/)

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-03-30T22:31:00.727

看看这个。注意 WaitForData 是如何调用自身的。这允许接收第二个和后续消息。

您无需等待更多数据。

```
 private void OnClientConnect(IAsyncResult asyn)
    {
        m_Client = m_Listener.EndAccept(asyn);
        WaitForData();
    }
    private void WaitForData()
    {
        buffer = new byte[1024];
        m_Client.BeginReceive(buffer, 0, buffer.Length, SocketFlags.None, new AsyncCallback(OnDataReceived), null);
    }
    private void OnDataReceived(IAsyncResult asyn)
    {
        int iRx = 0;
        iRx = m_Client.EndReceive(asyn);

        if (iRx > 0)
        {
            PacketReceiver.BytesReceived(buffer);
        }

        if (m_Client.Connected == true)
            WaitForData();
    } 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-08-22T12:58:43.320

您忘记在您的 rec 方法中调用 BeginReceive ：

这是您的代码应该是什么：

```
void rec(IAsyncResult ar)
{
  StringBuilder receivedData;
  //String oldvalue;
  Socket remote = (Socket)ar.AsyncState;
  int recv = remote.EndReceive(ar);
  receivedData = new StringBuilder(Encoding.ASCII.GetString(receive, 0, recv));
  //MessageBox.Show(receivedData.ToString(), "received", MessageBoxButtons.OK);
  StringBuilder sb = new StringBuilder(this.textBox1.Text);
  sb.AppendLine(receivedData.ToString());
  if (textBox1.InvokeRequired)
  {
    this.Invoke((MethodInvoker)delegate { this.textBox1.Text = sb.ToString(); });

  }
  remote.BeginReceive(receive, 0, receive.Length, System.Net.Sockets.SocketFlags.None, new AsyncCallback(rec), remote);
  //remote.Close(5);
  return;
} 
```

当然，这段代码不会关闭套接字，而是会等待更多数据。如果在您的发送方法中为每条消息创建不同的套接字，那么您需要调用 BeginAccept 而不是 BeginReceive。

希望能帮助到你

# wpf - 在 WPF 中，如何在代码后面的控件中添加边框？

> ID：698406
> 
> 赞同：0
> 
> 时间：2009-03-30T18:16:49.480
> 
> 标签：wpf, vb.net

在我的 XAML 中，我想动态生成具有以下内容的 ListBox：

```
<ListBox Name="MainListBox">
  <Border Style="{DynamicResource ListBoxItemRoundedBorder}">
     <ListBoxItem >
        <TextBlock>
          Some Text Here
        </TextBlock>
     </ListBoxItem>
   </Border>

  <Border Style="{DynamicResource ListBoxItemRoundedBorder}">
     <ListBoxItem >
        <TextBlock>
          Some Text Here
        </TextBlock>
     </ListBoxItem>
   </Border>

  <Border Style="{DynamicResource ListBoxItemRoundedBorder}">
     <ListBoxItem >
        <TextBlock>
          Some Text Here
        </TextBlock>
     </ListBoxItem>
   </Border>
</ListBox> 
```

我想通过后面的代码将项目添加到这个列表框。如何通过后面的代码添加项目和边框。我可以很容易地添加列表框项目，但似乎无法弄清楚边界：

```
 For Each s As String in MyArray
   Dim lbi as New ListBoxItem()
   Dim tb as New TextBlock()
   tb.Text = s
   lbi.content = tb
   MainListBox.Items.Add(lbi)
 Next 
```

编辑：为了消除任何混乱，我希望每个 ListBox 项目周围都有一个边框。我已经更新了 XAML - 实际上我想通过后面的代码动态或等效地呈现 XAML。我已经定义了边框样式。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-03-30T18:21:20.217

您是否查看过模板化[ListBoxItem](http://msdn.microsoft.com/en-us/library/ms750821.aspx)

使用它来获得您正在寻找的边框效果

```
<Style x:Key="ListBoxItemRoundedBorder" TargetType="ListBoxItem">
  <Setter Property="SnapsToDevicePixels" Value="true"/>
  <Setter Property="OverridesDefaultStyle" Value="true"/>
  <Setter Property="Template">
    <Setter.Value>
      <ControlTemplate TargetType="ListBoxItem">
        <Border 
          Name="Border"
          Padding="2"
          SnapsToDevicePixels="true" Style="{DynamicResource RoundedBorder}">
          <ContentPresenter />
        </Border>
        <ControlTemplate.Triggers>
          <Trigger Property="IsSelected" Value="true">
            <Setter TargetName="Border" Property="Background"
                    Value="{StaticResource SelectedBackgroundBrush}"/>
          </Trigger>
          <Trigger Property="IsEnabled" Value="false">
            <Setter Property="Foreground"
                    Value="{StaticResource DisabledForegroundBrush}"/>
          </Trigger>
        </ControlTemplate.Triggers>
      </ControlTemplate>
    </Setter.Value>
  </Setter>
</Style> 
```

然后在您的列表框上使用

```
<ListView ItemContainerStyle="{StaticResource ListBoxItemRoundedBorder}" /> 
```

虽然，根据您的问题，我无法准确看出您在寻找什么设计。您是在寻找带有边框的列表还是在每个项目周围都有边框的列表？

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2009-03-30T18:21:58.920

我不明白。如果你想要一个`Border`，为什么不把它贴在*外面*呢`ListBox`？我假设你想要一个`Border` *per`ListBoxItem`*。在这种情况下，只需修改`ItemTemplate`：

```
<ListBox>
    <ListBox.ItemTemplate>
        <Border>
            <TextBlock Text="{Binding}"/>
        </Border>
    </ListBox.ItemTemplate>
</ListBox> 
```

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2011-03-11T21:20:27.193

> *“我想通过后面的代码向这个列表框添加项目。”*

我刚刚构建了一个页面，可以动态地将控件加载到页面（基于集合）。

因此，要回答这个问题……您必须在代码中应用设置（例如对 xaml 中的模板所做的操作）。这是 C# 中的一个示例：（在 vb 中，第一行将以 Dim listBoxStyle 作为样式开头...）

```
Style listBoxStyle = new System.Windows.Style(typeof(ListBox));
listBoxStyle.Setters.Add(new Setter(ListBox.BorderThicknessProperty, new Thickness(0,0,0,0)));
ListBox rdoList = new ListBox();
rdoList.Resources.Add(typeof(ListBox), listBoxStyle); 
```

注意厚度（）。我将我的设置为无边框，因为它默认为有边框。您可以使用文本框执行此操作，只需添加 (1,1,1,1) 之类的厚度。

不知道您是如何从代码中调用动态控件的，但您可能希望[查看这篇文章，以便轻松地通过代码中的名称值访问动态 wpf 控件](http://brettspencer.name/_brettspencer/post/2011/03/11/WPF-Dynamic-Controls.aspx)。

# excel - 以编程方式从 MS Word 转换为 Excel

> ID：698410
> 
> 赞同：0
> 
> 时间：2009-03-30T18:17:52.847
> 
> 标签：excel, automation, ms-word, ms-office

无论如何，是否有问题地获取 MS Word 文件并转换为 excel。（显然，单词会猜测将东西放在哪里）。任何语言都可以

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-03-30T23:14:48.607

这是一个相当广泛的问题。Word 文档的内容将影响其难易程度。

您可以查看的一种方法是使用 Word 自动化打开 Word 文档，然后使用逗号分隔格式写出一个新文件，并使用 .xls 扩展名命名该文件。在 Excel 中打开此文件后，它应该“正常工作”。

如果您需要在您的输出 Excel 文档中使用丰富的格式，您可以使用 Excel 自动化来构建您的输出文档。使用它，您的程序中将同时拥有 Word 自动化（读取）和 Excel 自动化（写入）。

我在服务器环境中使用的另一个选项（但它有点贵）是 Aspose 库[Aspose](http://www.aspose.com)。他们有一个相当不错的 API（至少对于我使用过的 Word 而言）并且他们消除了自动化角度。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-04-05T22:32:50.790

请参阅[http://blogs.msdn.com/brian_jones/archive/2009/04/01/importing-a-table-from-wordprocessingml-to-spreadsheetml.aspx](http://blogs.msdn.com/brian_jones/archive/2009/04/01/importing-a-table-from-wordprocessingml-to-spreadsheetml.aspx)

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-03-31T00:05:14.867

这是自动化办公应用程序的资源：[Office 对象模型](http://msdn.microsoft.com/en-us/library/y1xatbkd(VS.80).aspx)

# c++ - 设计文档具体到什么程度？

> ID：698415
> 
> 赞同：7
> 
> 时间：2009-03-30T18:20:24.400
> 
> 标签：c++

我正在为一个安全子系统创建一个设计文档，用 C++ 编写。我为主要用例创建了类图和序列图。我还为每个类指定了公共属性、关联和方法。但是，我还没有将方法定义深入到 C++ 级别。由于我是 C++ 新手，和其他开发人员一样，我想知道它是否没有意义继续指定到这个级别。想法？

编辑：哇-完全反对，一致。例如，我正在考虑关于指定 const 与非 const、传递引用、处理默认构造函数和赋值等的整个业务。到目前为止，我确实相信将这一点详细说明这一点非常有帮助。我肯定对系统的工作方式有了更清晰的了解。例如，在深入研究代码之前，也许我只是做一些方法？

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2009-03-30T18:25:20.567

我不建议达到这个水平，但话说回来，你已经超越了我在设计规范中会去的地方。我个人的感觉是，当您在开发代码时发现您对代码将如何工作的猜测是错误的时，预先在详细设计上投入大量精力将被浪费。我会坚持高级设计，并考虑使用 TDD（测试驱动开发）来指导低级设计和实现。

* * *

## 回答 #2

> 赞同：5
> 
> 时间：2009-03-30T18:24:58.397

我想说这根本没有意义，而且你已经走得太远了。如果您是 C++ 新手，则无法为 C++ 项目编写详细的设计文档。我建议你尝试实现你在 C++ 中已经拥有的东西，从不可避免的错误（如公共属性）中学习，然后回去修改它。

* * *

## 回答 #3

> 赞同：4
> 
> 时间：2009-03-30T18:25:13.607

*由于您是新手，因此不*向下钻取可能是有意义的。

原因：您仍在弄清楚语言以及事物的最佳结构方式。这意味着您最初会犯错误，并且您希望在不不断更新文档的情况下更正它们。

* * *

## 回答 #4

> 赞同：3
> 
> 时间：2009-03-30T18:46:37.130

这实际上取决于设计文档的目标对象。如果是非技术性的老板，那么你对你所拥有的一切都很好。

如果是为了你自己，那么你是在使用该工具来帮助你，所以你决定。我在创建项目时会创建方法级别设计文档，但它处于较高级别，因此我可以弄清楚各种类的功能应该是什么。我发现跨语言，类的主要功能与我们正在使用的编程语言几乎没有关系。所需的一些内部细节和功能*肯定*会因所选语言而异，但这些是我的实现细节在设计阶段*不要打扰。*

它肯定有助于我知道，例如，授权类可能具有将用户对象作为参数的身份验证函数。在设计过程中我并不关心我可能需要一个内部字符串 md5 函数包装器来完成某些特定目标。我在编码时发现了这一点。

初始设计的目标是井井有条，这样您就可以在清晰和深谋远虑的情况下取得进展，而不是因为您因未计划而忘记了某些场景而将相同的功能撕掉并重新实现 4 次。

编辑：我经常使用 PHP，实际上我使用 PhpDoc 来做一些设计文档，只需编写没有实现的方法签名，然后在方法头注释中详细说明该方法应该做什么。这有助于将来使用我的课程的任何人，因为设计就是文档。如果在编码时确实需要进行一些更改，我也可以更改文档。

我经常在 php4 中工作，所以我不会使用接口。在 php5 中，我创建了接口，然后在其他地方实现它。

* * *

## 回答 #5

> 赞同：2
> 
> 时间：2009-03-30T18:31:56.667

指定代码应该如何实际组合在一起的最佳方式是**在代码中**。设计文档用于其他不容易用代码表达的东西。您应该使用它来描述程序满足的实际需求、它如何与用户交互、硬件和操作系统方面的限制。当然，在设计文档中描述应用程序的整体架构，但是，例如，API 实际上应该在公开 API 的代码中描述。

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2009-03-30T18:40:11.357

您在文档部分已经走得够远了。由于您还是 C++ 的初学者，当您了解该语言时，您可能想要更改程序的结构。然后，您将不得不在文档中进行更改。我建议您在文档方面已经走得太远了。无需深入研究

* * *

## 回答 #7

> 赞同：0
> 
> 时间：2009-03-30T23:58:41.450

Like everyone else says, you've gone way past where you need to go with the design. Do you have a good set of requirements to the simple true/false statement level that you derived that design from? You can design all day long, but if you don't have requirements that simply say WHAT you're going to do, it doesn't matter how good your design is.

# ms-access - MS Access 中的应用程序图标路径

> ID：698418
> 
> 赞同：2
> 
> 时间：2009-03-30T18:20:59.110
> 
> 标签：ms-access, vba, icons

如何以编程方式访问 MS Access 2003 中的应用程序图标路径？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-03-30T18:37:25.763

它是数据库对象的自定义属性（“AppIcon”）。

```
Set dbs = CurrentDb
sAppIconPath = dbs.Properties("AppIcon") 
```

注意 - 如果属性不存在，您将收到错误消息。

访问帮助中的这段代码显示了如何创建属性：

例子

下面的示例演示如何更改 Microsoft Access 数据库 (.mdb) 中的 AppIcon 和 AppTitle 属性。如果尚未设置或创建属性，则必须使用 CreateProperty 方法创建它们并将它们附加到 Properties 集合中。

```
Sub cmdAddProp_Click()
    Dim intX As Integer
    Const DB_Text As Long = 10
    intX = AddAppProperty("AppTitle", DB_Text, "My Custom Application")
    intX = AddAppProperty("AppIcon", DB_Text, "C:\Windows\Cars.bmp")
    CurrentDb.Properties("UseAppIconForFrmRpt") = 1
    Application.RefreshTitleBar
End Sub

Function AddAppProperty(strName As String, _
        varType As Variant, varValue As Variant) As Integer
    Dim dbs As Object, prp As Variant
    Const conPropNotFoundError = 3270

    Set dbs = CurrentDb
    On Error GoTo AddProp_Err
    dbs.Properties(strName) = varValue
    AddAppProperty = True

AddProp_Bye:
    Exit Function

AddProp_Err:
    If Err = conPropNotFoundError Then
        Set prp = dbs.CreateProperty(strName, varType, varValue)
        dbs.Properties.Append prp
        Resume
    Else
        AddAppProperty = False
        Resume AddProp_Bye
    End If
End Function 
```

# iphone - UITableView - 实现索引

> ID：698428
> 
> 赞同：1
> 
> 时间：2009-03-30T18:23:05.190
> 
> 标签：iphone, uitableview

我想实现一个显示在表格右侧的索引。我已经找到了如何显示它。按下某个索引项后，如何滚动到表格中的某个位置？

在索引中，我没有显示所有字母表，而是以下列方式显示：

```
#define ALPHA_ARRAY= @"A●D●G●J●M●P●S●V●Z" 
```

因此，当用户在 A 和 DI 之间按下时，想要转到从 A 开始的项目，依此类推。.

我该如何实施？

我想做一些类似于 iPhone 上联系人应用程序中可用的索引的东西。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2009-03-30T18:36:40.117

您需要在表视图数据源中实现此方法：

```
- (NSInteger)tableView:(UITableView *)tableView sectionForSectionIndexTitle:(NSString *)title atIndex:(NSInteger)index 
```

表格视图为您提供用户触摸的部分的索引及其标题（在这种情况下，您指定的字母之一）。您需要返回该部分的索引。如果节的数量与索引的数量完全相同，那么您所要做的就是 return `index`。否则，您需要找出表格视图应滚动到的部分的索引并返回它。

# php - 提高zend框架性能的最佳方法是什么？

> ID：698433
> 
> 赞同：8
> 
> 时间：2009-03-30T18:24:04.110
> 
> 标签：php, performance, zend-framework

zend 框架有很多我不需要的组件/服务，它有很多包含。我认为这一切都会减慢应用程序的速度。你知道如何加速吗？可能会删除未使用的（常见的）组件，或将文件合并到一个文件中？

* * *

## 回答 #1

> 赞同：10
> 
> 时间：2009-03-30T19:30:25.433

1.  [APC](http://www.php.net/manual/en/book.apc.php)或[eAccelerator](http://eaccelerator.net/)（*APC 将默认包含在未来的版本中，所以我建议使用它，即使原始速度略低于 eAccelerator）*

2.  用于配置、整页、部分视图、查询、模型对象的[两级缓存：](http://framework.zend.com/manual/en/zend.cache.backends.html#zend.cache.backends.twolevels)

    *   一级^(缓存)（在内存 KV-store、[APC 存储](http://www.php.net/manual/en/function.apc-store.php)或[memcached](http://www.php.net/manual/en/book.memcached.php)中）
    *   二级^(缓存（)[文件](http://framework.zend.com/manual/en/zend.cache.backends.html#zend.cache.backends.file)中的持久 KV 存储、[SQLite](http://framework.zend.com/manual/en/zend.cache.backends.html#zend.cache.backends.sqlite)或[专用 KV 存储](http://memcachedb.org/)）
3.  RDBMS 连接池（如果可用）。

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2009-03-30T19:03:59.770

在您开始担心主动修改以提高性能之前，您需要查看手册中的[性能指南](http://framework.zend.com/manual/en/performance.html)。您可以做的最简单的步骤之一是在您的服务器上启用操作码缓存（例如 APC） -[单独的操作码缓存可以为您提供 3-4 倍的提升](http://blog.digitalstruct.com/2007/12/23/php-accelerators-apc-vs-zend-vs-xcache-with-zend-framework/)。

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2009-03-30T19:11:29.770

磁盘上未被调用的代码不需要任何时间。查看慢的唯一方法是测量它。也就是说，如果您没有运行诸如[APC](http://pecl.php.net/package/APC)之类的操作码缓存，那么您就是在浪费时间。

* * *

## 回答 #4

> 赞同：2
> 
> 时间：2009-03-30T19:35:40.477

我同意 Topbit 的观点，您应该从代码分析开始。找出问题所在。

我不认为问题只是因为 ZF 有这么多文件。它使用自动加载，因此只加载当前需要的文件。您绝对不应该拆分不同的文件内容。

对于许多性能问题，缓存是您的朋友。

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2009-03-30T20:14:36.137

您可以通过优化帮助主题中所述的优化需求语句来获得一些额外的速度......首先删除所有需求，我还建议使用梨命名并覆盖自动加载器，

```
 function __autoload($class) {
      require str_replace('_', '/', $class) . '.php';
  } 
```

[你可以在这里](http://www.gsdesign.ro/blog/optimizing-zend-performance/)找到更多细节

* * *

## 回答 #6

> 赞同：-2
> 
> 时间：2009-03-30T19:07:22.260

您是否被迫使用 Zend 框架？如果没有义务使用它，那么不使用它显然是加快速度的最快方法。有几个轻量级 PHP 框架并没有附带 Zend 的所有开销和体积。例如，Codeigniter、Yii、Symfony 和 Kohana 都是很好的选择，我至少知道 codeigniter 和 Kohana 都支持使用 Zend 组件（例如：[将 Zend 与 Codeigniter 一起使用](http://freakauth.4webby.com/tutorials/using-zend-framework-components-in-code-igniter/ "将 Zend 与 Codeigniter 一起使用")）。

祝你好运！

# c# - 从子控件访问父控件 - ASP.NET C#

> ID：698434
> 
> 赞同：13
> 
> 时间：2009-03-30T18:24:19.930
> 
> 标签：c#, asp.net

我有一个带有标签的父用户控件。在父级的 OnInit 上，我动态加载子控件。在子控件中，我需要将父标签设置为某些东西。

使用 Parent 属性返回直接父级，在我的例子中它实际上是 PlaceHolder。理论上，我可以递归循环来获取对父用户控件的引用。我在这里朝着正确的方向前进吗？有没有一种简单的方法可以做到这一点？

* * *

## 回答 #1

> 赞同：10
> 
> 时间：2009-03-30T18:26:46.523

尝试获取孩子的[NamingContainer](http://msdn.microsoft.com/en-us/library/system.web.ui.control.namingcontainer.aspx)。

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2009-08-28T10:58:04.240

或者您可以遍历父项，直到找到所需的控件，例如使用扩展方法。

```
public static Control GetParentOfType(this Control childControl,
                                   Type parentType)
  {
      Control parent = childControl.Parent;
      while(parent.GetType() != parentType)
      {
          parent = parent.Parent;
      }
      if(parent.GetType() == parentType)
            return parent;

     throw new Exception("No control of expected type was found");
  } 
```

有关此方法的更多详细信息：[http ://www.teebot.be/2009/08/extension-method-to-get-controls-parent.html](http://www.teebot.be/2009/08/extension-method-to-get-controls-parent.html)

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2014-08-20T16:52:52.010

@Rex M 对此有一个很好且简单的解决方案，只是对其进行扩展以显示用法：

此代码片段用于从子用户控件中访问父用户控件属性：

```
((MyParentUserControlTypeName)NamingContainer).Property1 = "Hello"; 
```

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2012-01-10T13:25:23.397

对我来说，正确的方法是在控件中公开一个 add 方法。现在，如果您需要更新其外部的标签，请公开一个事件，例如 OnCollectionChanged(...) 并订阅需要显示有关集合信息的控件。

这样每个控件都是它的一部分，并且都保持[SOLID](http://en.wikipedia.org/wiki/SOLID_%28object-oriented_design%29)

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2009-03-30T18:27:04.040

有一个 FindControl 方法，但如果我没记错的话，它不是递归的。此外，您不能保证所有控件层次结构都存在于 page_init 上，请等到 page_load 后再访问控件。Init 用于创建它们。

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2009-03-30T18:27:17.143

您可以将父级的引用传递给子级，并在父级上公开一个方法来设置标签，尽管这会非常紧密地耦合对象。否则，您可以在子级上公开一个属性，然后父级可以检查并设置它自己的标签。

* * *

## 回答 #7

> 赞同：0
> 
> 时间：2009-03-30T18:28:16.813

您可以采用几种不同的方法...一种是将 Parent 属性添加到您的 Child 类...然后执行以下操作：

```
// in the context of parent's loading of child:
child.ParentObject = self; 
```

我相信有人会回来说这违反了一些最佳实践或其他……但*耸耸肩*。如果你想保持一些分离，你也可以使用事件。

* * *

## 回答 #8

> 赞同：0
> 
> 时间：2009-03-30T18:29:35.673

如果您通过代码创建 UserControl，为什么不将强类型父级传递给构造函数。

```
public class MyUserControl1 : UserControl
{
  public void Init(...)
  {
    var uc2 = new MyUserControl2(this);
  }
}

public class MyUserControl2 : UserControl
{
  private MyUserControl1 parentUserControl;

  public MyUserControl2(MyUserControl1 parent)
  {
    this.parentUserControl = parent;
  }
} 
```

现在这是紧密耦合的，以后可能会导致您出现问题，但是对于这种情况，它可以工作。

* * *

## 回答 #9

> 赞同：0
> 
> 时间：2009-03-30T18:34:26.940

最好的办法是等到 page_load 完成，然后在 Page.Controls 上递归搜索。

这里有一些扩展方法可以帮助您实现：

```
var control = Page.GetControl(MyControlID);    

public static class ControlExtensions
    {
        public static IEnumerable<Control> Flatten(this ControlCollection controls)
        {
            List<Control> list = new List<Control>();
            controls.Traverse(c => list.Add(c));
            return list;
        }

        public static IEnumerable<Control> Flatten(this ControlCollection controls, Func<Control, bool> predicate)
        {
            List<Control> list = new List<Control>();
            controls.Traverse(c => { if (predicate(c)) list.Add(c); });
            return list;
        }

        public static void Traverse(this ControlCollection controls, Action<Control> action)
        {
            foreach (Control control in controls)
            {
                action(control);
                if (control.HasControls())
                {
                    control.Controls.Traverse(action);
                }
            }
        }

        public static Control GetControl(this Control control, string id)
        {
            return control.Controls.Flatten(c => c.ID == id).SingleOrDefault();
        }

        public static IEnumerable<Control> GetControls(this Control control)
        {
            return control.Controls.Flatten();
        }

        public static IEnumerable<Control> GetControls(this Control control, Func<Control, bool> predicate)
        {
            return control.Controls.Flatten(predicate);
        }
    } 
```

* * *

## 回答 #10

> 赞同：0
> 
> 时间：2019-05-11T07:18:50.720

类似于 teebot 的解决方案，但返回 null 而不是 NullReferenceException，更易于使用，并且在其他上下文中可重用：

```
public static class Extensions
{
    public static IEnumerable<Control> GetAncestors(this Control control)
    {
        if (control == null)
            yield break;
        while ((control = control.Parent) != null)
            yield return control;
    }
} 
```

示例用例和比较：

```
class Control { public string Name; public Control Parent; }
class Control2 : Control { public string Prop2; }

static class Program
{
    public static Control GetParentOfType(this Control childControl,
                                          Type parentType)
    {
        Control parent = childControl.Parent;
        while(parent.GetType() != parentType) // throws NullReferenceException when "No control of expected type was found" (due to "parent" being null)
        {
            parent = parent.Parent;
        }
        if(parent.GetType() == parentType)
            return parent;

        throw new Exception("No control of expected type was found"); // this line is dead code as null reference throws before this
    }
    public static IEnumerable<Control> GetAncestors(this Control control)
    {
        if (control == null)
            yield break;
        while ((control = control.Parent) != null)
            yield return control;
    }

    static void Main()
    {
        var a = new Control { Name = "A" };
        var b = new Control2 { Name = "B", Parent = a, Prop2 = "B is OK!" };
        var c = new Control { Name = "C", Parent = b };
        var d = new Control { Name = "D",  Parent = c };

        // teebot's 
        var found = d.GetParentOfType(typeof(Control2));
        ((Control2)found).Prop2.Dump(); // properly returns "B is OK!", but needs 2 lines to be clear, and casting to the same type already defined in the line above
        try { b.GetParentOfType(typeof(Control2));
        } catch (Exception e) { e.GetType().Name.Dump(); } // NullReferenceException

        // mine
        d.GetAncestors().OfType<Control2>().First().Prop2.Dump(); // properly returns "B is OK!" (while "yield" and "First()" avoids wasting time looping unneeded ancestors, e.g. "A")
        b.GetAncestors().OfType<Control2>().FirstOrDefault().Dump(); // doesn't throw, just returns null
        d.GetAncestors().Take(2).Select(x => x.Name).ToList().Dump(); // returns a filtered list (instead of a single element) without changing GetAncestors nor wasting performance
    }
} 
```

上面的代码在 LinqPad 上运行（否则将`.Dump()`调用替换为`Console.WriteLine(...)`）

# php - 按最新评论排序 Wordpress 帖子

> ID：698438
> 
> 赞同：6
> 
> 时间：2009-03-30T18:25:27.930
> 
> 标签：php, mysql, wordpress

我想按最新评论订购 Wordpress 帖子。据我所知，这不可能使用 WP_Query 对象，并且需要一个自定义的 $wpdb 查询，我可以轻松编写它。但是，我不知道如何设置循环来运行这个对象。

任何人都可以帮忙吗？

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2009-03-30T19:07:40.230

分配

```
select wp_posts.*, max(comment_date) as max_comment_date
from $wpdb->posts wp_posts
right join $wpdb->comments
on id = comment_post_id
group by ID
order by max_comment_date desc
limit 10 
```

到一些变量 $query。您可以摆弄 10 或查询本身。（我不是 SQL 优化忍者。）然后你的代码看起来像

```
<?php
     $results = $wpdb->get_results($query) or die('!');
     foreach ($results as $result):
?>
[insert template here]
<?php endforeach ?> 
```

[Codex 对](http://codex.wordpress.org/Displaying_Posts_Using_a_Custom_Select_Query)这种模式进行了更深入的介绍。

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2012-01-17T21:08:49.160

我在功能中使用了原生 WP 的一个更简单的部分。希望它有所帮助，并且有人可以继续发展。这是一个简化版本，它显示了帖子的标题和摘录，以及使用 get_comments 的最新评论帖子中的评论内容和作者。

```
 $args = array(
        'status' => 'approve',
        'number' => 6,
        'order' => 'DESC'
    );
    $comments = get_comments($args);

    foreach($comments as $comment) : $count++;

            $post_args = array(
                'post_type' => 'post',
                'p' => $comment->comment_post_ID,
                'posts_per_page' => 1
                );

            $posts = get_posts($post_args);

            foreach($posts as $post) : setup_postdata($post);

                the_title();
                the_excerpt();

            endforeach;

        echo $comment->comment_content;     
        echo $comment->comment_author;

    endforeach; 
```

* * *

## 回答 #3

> 赞同：3
> 
> 时间：2010-10-16T05:20:23.050

好，朋友们，

这里有很多很棒的答案，但显然没有人花时间来测试它们。

Hao Lian 获得了第一最佳原始答案的荣誉，但不幸的是，他的代码没有显示没有评论的帖子。

Keytar 船长走在正确的轨道上，但他的代码会将每个帖子和附件显示为单独的结果。

这是Keytar船长的修改版本，但它将结果限制为已发布的“帖子”类型..（以避免获得草稿！！）

```
 select wp_posts.*,
    coalesce(
        (
            select max(comment_date)
            from $wpdb->comments wpc
            where wpc.comment_post_id = wp_posts.id
        ),
        wp_posts.post_date
    ) as mcomment_date
    from $wpdb->posts wp_posts
    where post_type = 'post'
    and post_status = 'publish' 
    order by mcomment_date desc
    limit 10 
```

* * *

## 回答 #4

> 赞同：3
> 
> 时间：2014-10-29T04:18:34.833

这是一个老问题，但我遇到了同样的问题，并找到了一种更清洁的方法来做到这一点，所以我把它贴在这里以防它对任何人有帮助。

如果您使用[posts_clauses](http://codex.wordpress.org/Plugin_API/Filter_Reference/posts_clauses)过滤器，您可以只修改主查询并仍然使用 The Loop 和所有常规循环函数。

```
function intercept_query_clauses( $pieces ) {
    global $wpdb;

    $pieces['fields'] = "wp_posts.*,
    (
        select max(comment_date)
        from " . $wpdb->comments ." wpc
        where wpc.comment_post_id = wp_posts.id AND wpc.comment_approved = 1
    ) as mcomment_date";
    $pieces['orderby'] = "mcomment_date desc";

    return $pieces;
}

add_filter( 'posts_clauses', 'intercept_query_clauses', 20, 1 ); 
```

请注意，我出于自己的目的稍微更改了 sql，但总体概念是相同的。

* * *

## 回答 #5

> 赞同：2
> 
> 时间：2009-07-29T20:07:17.120

作为郝连回答的附录，如果您使用以下查询：

```
select wp_posts.*,
coalesce(
    (
        select max(comment_date)
        from $wpdb->comments wpc
        where wpc.comment_post_id = wp_posts.id
    ),
    wp_posts.post_date
) as mcomment_date
from $wpdb->posts wp_posts
order by mcomment_date desc
limit 10 
```

这混合了还没有评论的帖子，并按 post_date 和 max(comment_date) 对它们进行排序。

* * *

## 回答 #6

> 赞同：1
> 
> 时间：2010-07-16T18:31:07.950

Hao Lian 建议的代码运行良好，除了我们应该添加以下 WHERE 子句以避免使用 POST 拉动 POST `comment_count = 0`，这种情况是由垃圾评论引起的。

**要添加的 WHERE 子句如下：**

```
WHERE comment_approved = '1' AND comment_type = '' AND post_password = '' 
```

**添加 where 子句后的完整代码应如下所示：**

```
select wp_posts.*, max(comment_date) as comment_date
from wp_posts 
right join wp_comments on id = comment_post_id
WHERE comment_approved = '1' AND comment_type = '' AND post_password = ''
group by ID    
order by comment_date desc
limit 6 
```

* * *

## 回答 #7

> 赞同：1
> 
> 时间：2016-08-03T17:24:32.403

这可以通过将 WP_Comment_Query 与 WP_Query 组合来完成，如下所示：

```
// For performance, limit the number of queried comments, 
// but make it be something big enough to account for "duplicate" posts.

$comments_query = new WP_Comment_Query;
$comments = $comments_query->query( array(   'number' => '100'  ) );

if ( $comments ) {
    foreach ( $comments as $comment ) {

// You'll want to convert the dates from string to integer so you can sort them out later
$comment_utf = strtotime($comment->comment_date);

// Build an array of post IDs with the date of the last published comment
$latest_comments[$comment->comment_post_ID] = $comment_utf;
    }}

// Sort the array by date
arsort($latest_comments); foreach ($latest_comments as $key => $value) {    $posts_ordered[] = $key; }

// The nice thing is that WP_Query will remove duplicates by default
$args = array ( 'posts_per_page'         => '10',   'post__in'  => $posts_ordered, 'orderby' => 'post__in');
$query = new WP_Query( $args );
if ( $query->have_posts() ) {
    while ( $query->have_posts() ) {
        $query->the_post();

// Do your stuff (add the template or whatever)

// If you want to add the comment itself, use this:
$comments = get_comments(array('number' => '1', 'post_id' => $post->ID));
foreach($comments as $comment) :
    echo $comment->comment_content;
endforeach;

// That's about it
    }}
wp_reset_postdata(); 
```

* * *

## 回答 #8

> 赞同：0
> 
> 时间：2009-12-01T01:46:28.857

我在想添加 max 函数会搞砸你的结果。MySQL 不会从每一个中提取最大值。它将从全套中拉出最大值。这是将为您提供结果的查询：

```
select wp_posts.*, comment_date
from $wpdb->posts wp_posts
right join $wpdb->comments
on id = comment_post_id
group by ID
order by comment_date desc
limit 10 
```

之后，如果您想遵循 WP 约定，请使用它，然后您可以使用大多数模板正在使用的功能（基于循环）：

```
$results = $wpdb->get_results($query) or die('!');
     foreach ($results as $post):
    setup_postdata($post); 
```

* * *

## 回答 #9

> 赞同：0
> 
> 时间：2016-04-01T16:55:36.487

获得 3 条关于自定义帖子类型“问题”的最新评论，无论是否获得批准：

```
global $wpdb;

$results = $wpdb->get_results(
    "
    SELECT wp_posts.ID, MAX(comment_date) AS max_comment_date
    FROM wp_posts
    RIGHT JOIN wp_comments
    ON id = comment_post_id
    WHERE wp_posts.post_type = 'question'
    AND wp_posts.post_status = 'publish'
    GROUP BY ID
    ORDER BY max_comment_date DESC
    LIMIT 3
    "
);

foreach ($results as $result) {
    $posts_arr[] = $result->ID;
}

$args = array(
    'post_type' => 'question',
    'post__in'  => $posts_arr,
    'orderby'  => 'post__in',
);

$the_query = new WP_Query( $args ); 
```

* * *

## 回答 #10

> 赞同：0
> 
> 时间：2020-05-07T13:40:09.237

使用 Lucian 的 BEAUTIFUL 解决方案，我需要更改/过滤现有的 WP_Query 以按最新评论对帖子进行排序。这是代码，经过测试并完美运行：

```
$comments_query = new WP_Comment_Query;
$comments       = $comments_query->query( array(   'number' => '100'  ) );

if ( $comments ) {
  foreach ( $comments as $comment ) {
    $comment_utf = strtotime($comment->comment_date);
    $latest_comments[$comment->comment_post_ID] = $comment_utf;
  }

  // Sort the array by date
  arsort( $latest_comments );
  foreach( $latest_comments as $key => $value ) {
    $posts_ordered[] = $key;
  }

  $query->set( 'post__in', $posts_ordered );
  $query->set( 'orderby', 'post__in' );
} 
```

# c# - 使用 C# 是否可以测试文件是否持有锁

> ID：698442
> 
> 赞同：2
> 
> 时间：2009-03-30T18:26:02.467
> 
> 标签：c#, locking, filestream

**背景：** 我使用文件中的偏移量和 Filestream 锁定/解锁方法来控制读/写访问。我正在使用以下代码来测试文件当前是否持有锁

```
try
{
  fs.Lock( RESERVED_BYTE, 1 );
  fs.Unlock( RESERVED_BYTE, 1 );
  rc = 1;
}
catch
{ 
  rc = 0; 
} 
```

**问题：**
我的目标是消除 try/catch 块。有没有更好的方法来查看锁是否存在？

**编辑：**
注意：这个问题与文件是否存在无关。我已经知道确实如此。它是关于同步写访问的。

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2009-03-30T18:30:12.567

您可以直接通过 P/Invoke 层调用[`LockFile`Windows API 函数。](http://msdn.microsoft.com/en-us/library/aa365202%28v=vs.85%29.aspx)您将使用 FileStream 上的 SafeFileHandle 属性返回的句柄。

直接调用 API 将允许您检查错误条件的返回值，而不是诉诸于捕获异常。

* * *

[Noah](https://stackoverflow.com/users/12113/noah)询问调用 P/Invoke 层与调用 try/catch 是否有任何开销。

Lock 文件通过 P/Invoke 层进行相同的调用，如果对 LockFile 的调用返回 0，则引发异常。在您的情况下，您没有引发异常。如果文件被锁定，您将花费更少的时间，因为您没有处理堆栈展开。

The actual P/Invoke setup is around seven instructions I believe (for comparison, COM interop is about 40), but that point is moot, since your call to LockFile is doing the same thing that the managed method does (use the P/Invoke layer).

* * *

## 回答 #2

> 赞同：5
> 
> 时间：2009-03-30T18:29:41.803

就我个人而言，我会在尝试打开它时捕获一个锁定的文件。如果它现在已解锁，则在您尝试打开它时可能会被锁定（即使只是几毫秒后）。

* * *

## 回答 #3

> 赞同：4
> 
> 时间：2009-03-30T18:31:56.760

> My goal is to eliminate the try/catch block

Remember, the file system is *volatile*: just because your file is in one state for one operation doesn't mean it will be in the same state for the next operation. You have to be able to handle exceptions from the file system.

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2009-05-15T08:14:15.397

In some circumstances you can also use [WCT](http://msdn.microsoft.com/en-us/library/ms681622(VS.85).aspx), it's usually implmented by debugger's or profilers, however it can be used from any code as the usual debugger requirement of being the thread which has the debug port open is not a pre-requisit. As such WCT is a very comprehensive and precise information regarding lock contention.

A [managed example](http://msdn.microsoft.com/en-us/magazine/cc163395.aspx) (all-be-it somewhat trickey), show's utility for this specific sub-set of the native debug API's on the CLR.

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2009-03-30T18:30:04.347

我认为没有尝试是不可能的，抓住。

# sql - 获取 MySQL SET 列作为整数偏移量列表

> ID：698464
> 
> 赞同：2
> 
> 时间：2009-03-30T18:30:40.333
> 
> 标签：sql, mysql, set

我在 MySQL 数据库中有一个表，定义类似于以下内容：

```
CREATE TABLE doc_types (
    id    INT UNSIGNED PRIMARY KEY,
    types SET('foo','bar','baz','quux',...) NOT NULL
) 
```

我想将`types`列的值作为逗号分隔的基于 1 的整数偏移列表获取到该设置值列表中，例如`"1,3,4"`对于值为 的行`"foo,baz,quux"`。（我正在使用的系统中的另一个工具需要这种格式，由于各种实际原因，我无法修改它以接受不同的东西。）内置`EXPORT_SET`函数并不完全不同，但它的返回值形式为`"1,0,1,1,..."`，本质上是一个以字符串形式表示的 64 元素位集。

有没有什么好的方法可以在单个 SQL 查询中以我上面描述的偏移格式`SELECT from doc_types`获取值？`types`

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-03-30T18:42:08.700

尝试这个：

```
SELECT CONCAT_WS(',', 
  IF(types & 1 > 0, 1, NULL), 
  IF(types & 2 > 0, 2, NULL), 
  IF(types & 4 > 0, 3, NULL), 
  /* fill in rest here */
  ) as output 
FROM doc_types; 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-09-18T15:46:28.127

尝试这个：

```
SELECT MAKE_SET(types+0, '1', '2', '3') as output FROM doc_types; 
```

# c# - C#中的变量范围问题

> ID：698466
> 
> 赞同：0
> 
> 时间：2009-03-30T18:31:23.327
> 
> 标签：c#, variables, scope

这是交易。我有一个主从网格场景。加载页面时加载主 GridView。我正在使用相同 DataTable 的 DataView，它通过过滤我需要在 DetailGridView 中显示的内容来加载 Master 以加载 Detail GridView。当我查看 MasterGridView 的第一行时，一切正常。当我尝试查看第二行时，出现错误“未找到列 [编号]。我还注意到“表”变量什么都没有。

```
public partial class Gridview_Template : System.Web.UI.Page
{
    DataTable table = new DataTable();

    protected void Page_Load(object sender, EventArgs e)
    {
        SqlDataReader reader = DBSqlHelperFactory.ExecuteReader(
            myconnection,
            "crm_getcustomersummary",
            new SqlParameter("@customerid", "99999")
        );
        table.Load(reader);
        MasterGridView.DataSource = table;
        MasterGridView.DataBind();
    }

    protected void detailGrid_DataSelect(object sender, EventArgs e)
    {
        string searchValue ="number="  + values.ToString();

        DataView dv = new DataView(
            table, searchValue, "number", DataViewRowState.OriginalRows
        );
        DetailGridView.DataSource = dv;

        // ...
    }
} 
```

我是否要将“表”变量置于会话状态以便它存在于调用中？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-03-30T18:36:03.770

如果您只想在回发之间保留表，那么您可能需要查看 ViewState。会话更多地用于跨不同页面持久化信息。

# c++ - What's the difference between calling CComModule.RegisterServer, _AtlComModule.RegisterServer, and LoadTypeLibEx for TypeLib registration?

> ID：698472
> 
> 赞同：1
> 
> 时间：2009-03-30T18:32:59.003
> 
> 标签：c++, windows, com, 64-bit, atl

In my DllRegisterServer method of my COM dll, I previously had code that called LoadTypeLibEx(module, REGKIND_REGISTER, &pTypeLib) to register my COM classes and their corresponding TypeLib's. My COM DLL is a 64-bit. I've noticed that on my 64-bit Vista system, under **HKCR:\\TypeLib\{myguid}\1.0\0** I find a win32 subkey with the location to my COM DLL.

I also have some other code in a seperate COM DLL that I support that uses the older, now deprecated CComModule.RegisterServer(TRUE) call. This code creates a win64 subkey under the 0 key for a 64-bit DLL and a win32 subkey under the 0 key for a 32-bit DLL. I am using the correct bit version of regsvr32 to do the registration in all cases (matching the regsvr32 bitness to DLL bitness).

Why does LoadTypeLibEx and _AtlComModule.RegisterServer both not create the win64 key for a 64-bit dll containing my TypeLib while the older CComModule.RegisterServer creates the correct keys?

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-04-03T14:01:55.730

It appears that perhaps the behavior I'm seeing regarding win32/win64 subkeys reflects the fact that some type libraries can be used in 64-bit and 32-bit programs because there they contain no bit-constrained (read: pointer) parameters. Other type libraries, meanwhile, need different entries for win32 and win64 because they are not compatible.

Thus, it would seem that the behavior I'm seeing isn't really because of the registration methods I'm using, but because of the underlying type libraries.

# nhibernate - 我如何在 NHibernate 中映射它

> ID：698473
> 
> 赞同：0
> 
> 时间：2009-03-30T18:33:10.577
> 
> 标签：nhibernate, fluent-nhibernate, nhibernate-mapping

我有两个课程，Survey 和 Poll 课程。我也有问题和问题选择课程。我如何映射这些，以便得出特定的表格格式。以下是所涉及的课程。

```
public class Survey
{
     public IList<Question> Questions { get; private set; }   
}

public class Poll
{
    public Question Question { get; set; }
}

public class Question
{
    public string Text { get; set; }
    public IList<QuestionChocie> Choices { get; private set; }
}

public class QuestionChoice
{
    public string Text { get; set; }
} 
```

我正在拍摄的结果表包括以下内容

```
Surveys- a table of survey information.
Polls - a table of polls information.
SurveyQuestions -a table of survey questions.
PollQuestions - a table of poll questions.
SurveyChoices - a table of the question choices for the surveys.
PollChoices - a table of the question choices for the survey. 
```

最好，我真的很想知道 Fluent NHibernate，或者只是映射 xml 也可以。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2009-03-30T18:54:45.330

您还没有定义表之间的关系，所以我将假设一对多。

一般映射将是：

```
public class SurveyMap : ClassMap<Survey>
{
    public SurveyMap()
    {
        HasMany<SurveyQuestion>(x => x.Questions).Inverse();
        // Rest of mapping
    }
}

public class SurveyQuestionMap : ClassMap<Question>
{
    public QuestionMap()
    {
        References<Survey>(x => x.Survey);
        HasMany<SurveyChoice>(x => x.Choices).Inverse();
        // Rest of mapping
    }
}

public class SurveyChoiceMap : ClassMap<SurveyChoice>
{
    public SurveyChoiceMap()
    {
        References<SurveyQuestion>(x => x.Question);
        // Rest of mapping
    }
} 
```

# vb.net - 知道为什么 VS2008 在解决方案重建结束时可靠地崩溃吗？

> ID：698474
> 
> 赞同：0
> 
> 时间：2009-03-30T18:33:20.203
> 
> 标签：vb.net, winforms, visual-studio-2008, .net-2.0

VS2008 SP1，Winforms 解决方案，VB.NET，为 x86 和 .NET v2 编译

我的解决方案中有十几个项目，其中有几个 Windows 窗体项目和一些类库。

如果我重建解决方案，它会清除并重新编译所有项目，如您所料......

...然后消失而没有任何痕迹或错误消息。由于我通过 Internet 上的 HTTP 重新连接到 VSS 2005，因此需要整个月才能开始备份所有加载的内容，因此非常烦人。

编译后的应用程序本身可以正常工作，更改后的正常构建和运行也可以正常工作。

任何想法为什么会这样？我用谷歌搜索没有太大的成功。

提前致谢。

**编辑：只是为了澄清，除了**[重构](http://www.devexpress.com/Products/Visual_Studio_Add-in/Refactoring/)之外没有加载项！（我知道，我想我应该尝试卸载它，看看是不是这样，但它太有用了！- 我会看看是否有更新）。

并且没有自定义构建步骤。它只是一个普通的 Winforms 应用程序，在项目之间有引用（以及一些对 COM dll 的引用以进行互操作）。

感谢到目前为止的想法..

**问题解决后编辑**

好的，伙计们，再次感谢所有的想法。

原来是 Refactor 的版本！我正在使用。我安装了最新的，崩溃停止了……然后重构！也停止工作。所以我关闭了VS，卸载了Refactor！完全，并重新安装了最新版本......现在我不再遇到神秘的崩溃，并且重构！再次工作。

你可能会说，“呃，你为什么不早点尝试这个”，这是一个公平的问题......你知道它的方式 - 间歇性发生的事情......紧急优先事项的即时压力......以及当然当时还没有新版本，旧版本的好处也不是微不足道的。所以，第三者加入了罪魁祸首。

再次感谢..

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-03-30T18:39:17.333

是否使用了任何第三方插件，也会造成这种情况。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-03-30T18:45:28.787

我在几个 WinForms 应用程序中遇到了这个问题。我必须按照这个确切的顺序执行这些确切的步骤。

1.  从 IDE 关闭所有设计器文件。或者只是关闭所有文件，使您的工作区为空
2.  退出 Visual Studio 的所有实例
3.  打开VS，打开项目，进行完全重建。这固定了我......一段时间。

对我来说，共同点是发生这种情况的所有项目都是使用旧版本的 Visual Studio 创建的。这就是我追查到的问题。

我当时没有安装第 3 方插件。

希望这一点有帮助。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2009-03-30T19:03:39.630

1.  尝试使用 WinDBG 或 Visual Studio 调试 Visual Studio。附加到有故障的 Visual Studio（在它崩溃之前）并确保您停止所有异常。如果它是一个托管异常，那么您可能会理解发生了什么，如果它没有尝试在调用堆栈中查看谁是错误的 dll。
2.  也尝试在没有源代码控制的情况下工作，最快的方法是禁用网卡（不开玩笑）。
3.  重新安装 Visual Studio...

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2009-03-30T18:35:41.603

对于您正在构建的任何项目，您是否有任何自定义构建步骤？他们可能是导致坠机的原因。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2009-03-30T19:00:34.817

您忘记了 VSS 作为插件。我建议您将源代码控制系统更改为 SVN。这将花费你几天或几周的时间来适应它，但它值得痛苦。我知道这并不总是在您的目标范围内，但如果是这样，您将通过这种更改获得很多好处。

# visual-c++ - OnQueryHitPoint

> ID：698486
> 
> 赞同：0
> 
> 时间：2009-03-30T18:35:56.390
> 
> 标签：visual-c++

我有使用 VC++ 开发的 ActiveX 控件。当用户点击我的控件时，我不想处理它，而是想将它传递给它下面的控件。（如果我的控件位于其他控件之上，这将很有用）

为了实现它，我在我的控件上实现了 OnQueryHitPoint()。当我的控件在 VB 中使用时，这可以正常工作。但是当我的控件在 VC++ 中使用时，根本不会调用 OnQueryHitPoint()。

我很欣赏任何想法。

谢谢。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2009-03-31T17:49:32.297

我自己解决了。我需要重写 OnNcHitTest() 并返回 HTTRANSPARENT。希望它会帮助某人。

谢谢。

# sql-server - SQL Server / Oracle Linked -- Julian 日期错误

> ID：698489
> 
> 赞同：0
> 
> 时间：2009-03-30T18:36:48.120
> 
> 标签：sql-server, oracle, view, linked-server, julian-date

我有一个客户，他有一个链接到 Oracle 8i 数据库的 SQL Server 2000 数据库。他们在 SQL Server 2000 数据库中有几十个视图，这些视图引用了 Oracle 数据库，通常使用简单的语法，例如：

```
SELECT *
FROM  SERVER..DB.TABLE 
```

这些视图（以及引用它们的存储过程）已经运行了好几年，没有问题。突然，今天早上，其中一些（但不是全部）因以下错误而失败：

```
Server: Msg 7330, Level 16, State 2, Procedure SALES_ORDER_HEADERS, Line 7
Could not fetch a row from OLE DB provider 'MSDAORA'. 
[OLE/DB provider returned message: ORA-01854: julian date must be between 1 and 5373484]
OLE DB error trace [OLE/DB Provider 'MSDAORA' IRowset::GetNextRows returned 0x80040e07]. 
```

当我们使用上面的四部分语法（与视图定义的语法相同）选择数据时，查询成功且没有问题，并且 . 但是，我们无法根据该语法创建视图，我们无法编辑现有视图（在设计器中），并且我们无法弄清楚为什么直接查询链接表有效，但通过查询使用它却失败了。

我的公司没有构建系统，我们通常也不维护它 - 客户有一个内部开发团队在处理它，但他们要求我们的故障排除帮助，我们和他们一样难过，所以我想我会在这里问。

任何人都知道为什么我们会看到这种行为——更重要的是，如何纠正它？（升级不足；此时不是一个选项。）作为一种临时解决方法，我们发现 using`OPENQUERY`确实起作用，但它当然很慢。如果可能的话，我们想要一个不涉及 的解决方案`OPENQUERY`。

回应评论：意见中没有`ORDER BY`定义。存储过程中可能有，但我不确定。（我在发布问题前大约 20 分钟才第一次看到这个数据库。:)）

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-03-30T22:26:41.860

我认为数据发生了多年未发生的变化。几年前我发现了类似的东西，我正在开发一个关键的应用程序模块，测试，测试，测试很多用例，一切都很好，并且在生产的那一天引入了一种未经测试的模式！难以置信但真实！

因为对数据的更改是错误的，所以会发出某种`TO_CHAR(xx, 'J')`调用。例如，零或负数据。

因为很多电话都在下降，所以可能是所有人共有的基表/列。

行动：

*   在 Oracle 中为会话激活[跟踪](http://www.orafaq.com/wiki/Trace_events)（您可以为[活动会话](http://www.oracle-base.com/articles/8i/DBMS_System.php)和错误号执行此操作）。
*   寻找“公分母”表格/列，然后寻找奇怪的值。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-03-30T18:43:30.803

您的观点中是否有“ORDER BY”，这可能是原因。

# algorithm - 在学术论文中使用算法

> ID：698493
> 
> 赞同：18
> 
> 时间：2009-03-30T18:37:32.707
> 
> 标签：algorithm

我不清楚使用已发表学术论文中的算法的法律地位。该材料是否有隐含专利？开源应用程序怎么样？是否可以使用免费软件许可证之一在开源应用程序中实现该算法？

假设我可以访问描述算法 B 的论文 A。如何确定我是否可以在我的商业闭源应用程序 C 或开源应用程序 D 中使用算法 B？答案总是“不”吗？有保质期吗？

* * *

## 回答 #1

> 赞同：17
> 
> 时间：2009-03-30T18:41:14.227

没有“隐性专利”之类的东西。

不幸的是，我认为您需要评估每篇论文的 IP 限制。

学术论文中描述的算法最终受到 RSA 非对称加密算法的专利保护的比较著名的情况之一。一篇名为“关于数字签名和公钥密码系统”的论文于 1977 年在 ACM 期刊上发表，描述了该算法，并于 1983 年获得了一项专利（美国专利 4,405,829）。

我没有读过这篇论文，所以我不知道是否提到了专利申请——我知道该算法被广泛实施，然后当专利被授予时，MIT/RSADSI 开始执行它。例如，专利成为 PGP 的一个相当大的问题。我相信，MIT/RSADSI 最终允许将专利免费用于非商业用途。[LZW 压缩](http://en.wikipedia.org/wiki/GIF#Unisys_and_LZW_patent_enforcement)也发生了类似的情况。

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2009-03-30T19:14:53.987

这就是 GIF 所发生的情况，压缩算法是公开发布的，但没有提及它已获得专利。
即使该论文的作者声称没有为它申请专利——也不能保证另一种算法尚未获得专利，法院可能会决定它涵盖了这项工作。

还要记住，自己发明它并不能保护您免受专利的侵害——您可以发明一种您从未在印刷品中见过的算法，然后发现它被某些专利所涵盖。

* * *

## 回答 #3

> 赞同：4
> 
> 时间：2009-03-30T19:19:18.953

AFAIK，以可公开访问的方式（例如学术论文）发表某些内容实际上消除了在欧洲获得专利的可能性。在美国，从首次公开到获得专利有一年的宽限期。学生和教授通常会发现潜力，然后他们向大学的技术转移办公室提出申请，该办公室决定如何处理它。例如，验证码就是这种情况。如果论文出自商业公司（例如 IBM），则更有可能获得专利或获得额外保护，因为 Research 的员工也是根据专利申请数量进行评估的。

问题是通常没有办法知道，因为专利律师通常会写一个与原始想法没有联系的通用名称。所以联系作者以防万一可能是谨慎的。作者也可能有一个现有的实现可用，通常是开源的。

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2009-03-30T18:51:17.040

正如迈克尔所说，没有隐含专利之类的东西。

通常，当算法或任何其他研究发表时，作者希望将其发布到世界上供其他人使用。如果您可以访问描述某些算法的已发表论文，那么您*可能*可以在您可能创建的任何程序中使用它。但是，某些算法在发布之前可能已被其发明者申请了专利，在这种情况下，如果您想使用该算法，则无论您的应用程序是否开源，您都必须与专利持有人达成某种安排。基本上为了安全起见，您需要检查该算法的具体限制。（如果您的应用程序是开源的，而不是专有的，那么发表有关算法的论文的人通常更有可能让您使用他们的算法。）

# c# - 是否有“库存”空闲/等待对话框？

> ID：698498
> 
> 赞同：4
> 
> 时间：2009-03-30T18:38:08.337
> 
> 标签：c#, winforms, dialog

我的 C# 应用程序在系统启动时运行，必须等待本地 SQL Server 实例才能真正执行任何操作。现在，我只是等待服务器响应（我曾经在服务上获得一个等待句柄，但这并不可靠），然后启动应用程序的主对话框。

当然，这样做的问题是，在服务启动之前，用户无法知道正在发生的事情，并且由于我们使用的硬件可能需要一分钟。所以我正在考虑加入某种“正在加载/请等待”指示器。问题是，我们的项目接近于锁定，而像创建一个新类这样大的变化会引起很多麻烦——修改现有文件（如 Program.cs）比创建一个新文件要少得多。长话短说：在我开始连接 SQL Server 之前，是否有一个非常适合显示（我猜是异步的）的 .NET 类，然后在它开始响应时将其删除？

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2009-04-01T03:53:27.557

这是我快速破解的三线程版本，可以解决问题。这可以以可见形式放置在任何地方（或者可以针对 program.cs 进行修改），并将生成一个新的、居中的模式对话框，该对话框带有平滑滚动的进度条，它将主导用户的注意力，直到父线程中的 FinishedProcessing 被设置为真。

```
 //Update to true when finished loading or processing
        bool FinishedProcessing = false;  

        System.Threading.AutoResetEvent DialogLoadedFlag
            = new System.Threading.AutoResetEvent(false);  

        (new System.Threading.Thread(()=> {

            Form StockWaitForm = new Form()
            { Name = "StockWaitForm", Text = "Please Wait...", ControlBox = false,
                FormBorderStyle = FormBorderStyle.FixedDialog, StartPosition = FormStartPosition.CenterParent,
                Width = 240, Height = 80, Enabled = true };

            ProgressBar ScrollingBar = new ProgressBar() 
            { Style = ProgressBarStyle.Marquee, Parent = StockWaitForm,
            Dock = DockStyle.Fill, Enabled = true };  

            StockWaitForm.Load += new EventHandler((x, y) =>
            {
                DialogLoadedFlag.Set();
                (new System.Threading.Thread(()=> {
                    while (FinishedProcessing == false) Application.DoEvents();
                    StockWaitForm.Invoke((MethodInvoker)(()=> StockWaitForm.Close()));
                })).Start();

            });  

            this.Invoke((MethodInvoker)(()=>StockWaitForm.ShowDialog(this)));  

        })).Start();  

        while (DialogLoadedFlag.WaitOne(100,true) == false)  Application.DoEvents();     
        //
        //Example Usage
        //Faux Work - Have your local SQL server instance load here
        for (int x = 0; x < 1000000; x++) int y = x + 2;  

        FinishedProcessing = true; 
```

根据口味定制。此外，如果您确实在生产应用程序中使用它，请将新线程内容包装在 try...catch 块到[CYA](http://www.rvenables.com/2009/01/threading-tips-and-tricks)中。最后一件事，我将根据“Coderer Public License / SO v1.1”向您发布此代码，如下所示：

Coderer Public License / SO v1.0
我，在社区“Stack Overflow”上被称为“Coderer”的人，同意彻底考虑切换到一个健全的项目管理方法，该方法允许在执行阶段向项目添加额外的类。我知道类似纳粹的变更控制对所有相关方都是不健康的。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2009-03-30T19:15:25.547

这是标准 Windows 进度对话框的 .NET 包装器：

[http://www.codeproject.com/KB/shell/iprogressdialognet.aspx](http://www.codeproject.com/KB/shell/iprogressdialognet.aspx)

我没有弄乱它，但我确信有一个标志可以使进度条旋转。如果您想变得非常花哨，您甚至可以制作自己的 AVI 动画并将其插入。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2009-03-30T21:47:52.543

就像构建“请稍候...”对话框一样简单，我不明白为什么。

据我所知，没有。没有现货的。自己成长几乎更容易......或者只是禁用表格，然后调出沙漏光标。相同的想法，并且同样易于实施。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2009-03-31T17:31:29.970

您可以考虑在 BackgroundWorker 中（在工作线程中）执行 SQL 工作。这将使您的应用程序响应。

# c# - 跨共享实例的线程安全 (C#)

> ID：698507
> 
> 赞同：1
> 
> 时间：2009-03-30T18:39:41.873
> 
> 标签：c#, multithreading

如果可能，我使用工厂模式来创建从缓存加载的自定义对象。自定义对象上没有静态成员或函数。

假设 2 个线程调用工厂并且都从缓存返回对同一对象的引用。（即没有新的运算符，在下面的回答中，从集合返回的对象）

如果我想修改类内部的私有实例成员：

a) 我应该先锁定它吗？b) 更改会反映在两个线程中吗？

我认为这两个问题都是肯定的，但同时感觉线程有不同的类实例。

我必须在这里做一些基本的事情吗？为什么我觉得我有？

================

在前几个答案之后，我已经确认了我的想法，谢谢。

我想我真正想知道的是，如果对象几乎只是只读的，即在创建后它们只有一个可以更改的实例成员，我是否需要在读取不受影响的属性时进行任何锁定那一个可变的实例成员？

我再次假设没有，但我必须重视集体 StackOverflow 智囊团的第二意见 :)

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-03-30T21:12:23.970

大多数原始类型、字符串和对象引用的读写都是原子的（除了非易失的 long 和 double 之外的所有内容）。这意味着如果您只是单独读取或写入字段或其他变量，则不需要锁定。所以，如果你曾经看到过这样的代码（我保证你会看到的），你可以愉快地去掉不必要的和昂贵的锁定：

```
public SomeClass SomeProperty
{
    get
    {
        lock (someLock)
        {
            return someField;
        }
    }

    set
    {
        lock (someLock)
        {
            someField = value;
        }
    }
} 
```

但是，如果您想更改该值，例如将其增加一，或者如果您想读取多个相关变量，那么如果您想要合理的结果，则需要锁定。

还值得注意的是，Hashtable 和 Dictionary 支持多个并发读取器，而无需任何类型的锁定。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-03-30T18:44:21.783

您假设线程具有对象的不同实例，这是不正确的。线程指向同一个对象；因此，您必须同步对可能被多个线程访问的任何成员的访问，无论是通过属性访问、方法调用等。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2009-03-30T18:44:22.347

它应该是同一个对象，你的问题的答案是YES，YES。

您如何检查是否有 2 个实例？

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2009-03-30T19:04:36.447

是的，您应该在设置私有成员之前锁定。这将反映在两个线程中（因为它们是同一个对象）。

但是，您可能需要一些时间来考虑如何处理锁和线程。

如果您的工厂正在创建对象并将其添加到集合中，则需要在例程周围使用某种形式的锁来创建对象。否则，两个线程可能会在创建对象之前同时请求对象，并创建 2 个实例。

另外，我不建议直接设置私有成员——在返回的类实例中使用一个单独的对象仅用于锁定，并使用某种形式的访问器（方法或属性）来锁定它是一个好主意同步对象，然后设置字段。

至于不“相信”它的两个实例——你总是可以做一些事情来检查调试器。添加对引用相等性的检查，或者甚至临时将 GUID 添加到您在构造时设置的类 - 很容易验证它们是否相同。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2009-03-30T18:43:35.000

如果 new 运算符或构造函数在对象上被调用两次，那么您自己就有了同一个类的两个实例。

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2009-03-30T19:58:59.077

您是否*需要*两个线程来查看更改私有成员的结果？或者，如果两个线程都获取对象，但是当一个线程更改私有成员时，另一个线程看不到该更改，您是否完全可以？

这就是我问的原因：在您的工厂中，您可以从缓存中获取对象，然后在返回之前克隆或复制它。结果，每个线程都有自己的类副本，并且该副本将具有在他们请求缓存对象时处于缓存对象中的状态。没有 2 个线程会共享完全相同的实例，因为您正在为每个线程制作一个副本。

如果这符合您的要求，那么您可以避免锁定对象（尽管您需要在工厂方法本身上进行同步......在当前情况下您也需要）。

但是，请小心“克隆”的想法。如果你有一个对象图并且你只做一个浅层克隆，你最终会得到仍然跨线程共享的引用，迫使你再次需要同步。如果对象是一个非常简单的对象，并且没有大量对其他对象的引用，则这种每线程一个副本的想法最有意义。

# sql - 什么都没有从 SQlite 表中提取？

> ID：698509
> 
> 赞同：1
> 
> 时间：2009-03-30T18:40:19.267
> 
> 标签：sql, c, sqlite

```
void max_min(sqlite3 *db)
{
    //call back*********
    int i, ncols;
    sqlite3_stmt *stmt;
    char *sql;
    const char *tail;
    char *zErrMsg = 0;
    int rc;
    //******************

    //min/max variables
    char min[20];
    char max[20];

    //we want only the min and max value of this table
    sql = "SELECT MIN(Start),MAX(End)FROM GMTI;"; //doesn't extract but works in GUI tool?

    //sql = "SELECT * FROM GMTI WHERE Start<16;"; //works?

    rc = sqlite3_prepare(db, sql, strlen(sql), &stmt, &tail);
        if(rc != SQLITE_OK){
            fprintf(stderr, "SQL error: %s\n", sqlite3_errmsg(db));
        }

    rc = sqlite3_step(stmt);
    ncols = sqlite3_column_count(stmt);
    printf("Number of columns: %d and row status: %d", ncols, rc);
    while(rc == SQLITE_ROW){
        for(i=0; i<ncols; i++){
                  if (strncmp("Start", sqlite3_column_name(stmt,i), strlen("Start")) == 0)
                  {
                        strncpy(min, sqlite3_column_text(stmt,i), strlen(sqlite3_column_text(stmt,i)));
                        strcpy(min + strlen(sqlite3_column_text(stmt,i)), "\0");
                        printf("min is: %s\n", min);
                        printf("<br>");
                  }  
                  if (strncmp("End", sqlite3_column_name(stmt,i), strlen("End")) == 0)
                  {
                        strncpy(max, sqlite3_column_text(stmt,i), strlen(sqlite3_column_text(stmt,i)));
                        strcpy(max + strlen(sqlite3_column_text(stmt,i)), "\0");
                        printf("max: %s\n", max);
                        printf("<br>");
                  }

         }//end for 

        fprintf(stderr, "\n");
    rc = sqlite3_step(stmt);
    }//end while

    sqlite3_finalize(stmt);

} 
```

当我将上面的 sql 查询与 MIN 和 MAX 函数一起使用时，最小值和最大值没有打印出来。如果我使用其中注释的其他语句之一，它会按预期工作，打印选定的查询。
查询中的最大值和最小值有什么不同，它无法提取值？不是表格格式吗？
此外，我在同一数据库上的 SqLite 数据库浏览器中测试了问题查询字符串，它可以工作，显示两个最小值和最大值。

任何建议将不胜感激。

谢谢。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-03-30T18:43:54.577

尝试打印出返回的列名。也许它们不等于您假设的“开始”和“结束”？

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-03-30T18:44:07.167

也许您应该在 MAX(End) 和 FROM 之间添加一个空格？

# c# - c#汽车属性VS 2005？

> ID：698512
> 
> 赞同：2
> 
> 时间：2009-03-30T18:42:02.880
> 
> 标签：c#, c#-3.0

自动属性在 VS 2005 中有效吗？我似乎无法让我的 C# 类与它们一起编译（与就地初始化相同）。我安装了框架 3 sp1。这些功能是否仅在 VS 2008 中可用，还是我做错了什么？

通过就地初始化，我的意思是：

```
SomeClass c = new SomeClass()
{
  Name = "",
  Value = 12345
}; 
```

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2009-03-30T18:47:39.217

自动实现的属性和对象初始化程序（您展示的示例）都在 C# 3.0 中引入。Visual Studio 2005 只编译 C# 2.0。

有关哪个版本的更多信息（以及在面向 .NET 2.0 时可以使用哪些 C# 3.0 功能），请参阅[我关于该主题的文章](http://csharpindepth.com/Articles/Chapter1/Versions.aspx)。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-03-30T18:43:40.600

不，Autoproperties 是 3.5 编译器的产物，只有 VS2008 可以理解它们。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2009-03-30T19:03:48.383

您也可以在针对 .NET 2.0 的项目上使用 VS 2008 中的自动属性。

您还可以使用 lambda 表达式和 var 关键字。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2009-03-30T18:58:11.347

实际上，使用 VS2005 的 WPF/WCF 插件，您可以创建 3.0 应用程序。编译器虽然不能使用 3.5 编译器。

在 3.0 发布时，我使用该插件来创建 WPF 应用程序。3.5 是 2008 IDE 独有的。

编辑：我的意思是附加到 VS2005 调试器的编译器无法使用它们，因此您在编译时会收到错误。

# storage - 视频游戏如何有效地存储/检索大量数据？

> ID：698516
> 
> 赞同：15
> 
> 时间：2009-03-30T18:42:49.387
> 
> 标签：storage

例如，在辐射 3 中，保存游戏存储游戏中每个对象和 NPC 的状态和位置，并且只占用几 MB。他们是怎么做到的！？！？

然后，在玩游戏的过程中，如何在内存中/从内存中添加/检索这些数据，以便实时显示给玩家？

**更新：（**我会让你为你的答案工作：P）

根据凯文克劳威尔的回答......所以我想你会有一个适用于对象和 NPC 的渲染距离，你会在给定范围内“选择”对象和 NPC。但是，您将使用什么类型的数据存储来获取这些对象？

换句话说，你会拥有一个包含游戏中每个对象的巨大数组，并不断更新一个较小的列表来保存要渲染的可见对象吗？

另外，根据 Chaos 的回答……如果您最终触摸了游戏中的每个对象，会发生这种情况吗？你的存档游戏会越来越大吗？在辐射 3 的情况下，我很确定没有“阶段”，过去的数据可能会被丢弃。当您离开/返回某个位置时，一切都会保留。那么您认为这个具体案例是如何实现的呢？

* * *

## 回答 #1

> 赞同：12
> 
> 时间：2009-03-31T07:55:39.587

现在有了所有的大硬盘，即使是开发人员似乎也忘记了每兆字节有多少字节。所以回答标题中的问题：游戏通过创建几兆字节的存档来存储大量数据。

为了说明一兆字节有多大，它是 800 万位。这足以编码 2^8000000 = 10^2666666 个状态。相比之下，宇宙中只有 10^80 个原子。现在在（保存）游戏中，有多个具有不同状态的子系统；例如，在 RPG 中，每个 NPC 都有自己的状态。但是，真正的状态有多少？他们在城镇中的位置可能会保存为 16 位（如果他们四处走动，你还记得他们的*确切位置吗？）。*他们的情绪/性格/等是另外 8 位，这允许比某些人拥有更多的情绪。

在游戏中存储此类数据时，典型的数据结构是四叉树。这是一个数据结构，允许您在 O(log N) 中确定某个 XY 区域中的对象。在某些情况下，游戏开发人员发现将世界预先划分为区域更容易。这减少了运行时计算量。一个很好的例子是毁灭战士。它的地图具有预先计算的能见度；对于每个点，人们可以快速确定它属于哪个区域，并且对于每个区域，可见对象的数量都是预先计算的。这减少了需要运行时可见性检查的对象数量。

* * *

## 回答 #2

> 赞同：9
> 
> 时间：2009-03-30T18:47:38.767

它可以简单地将对象或 NPC 映射到 X、Y、Z 坐标平面。廉价存储的信息。

在游戏过程中，所有这些对象仍然始终映射到坐标系。他们只需要读入保存信息并从那里开始。

* * *

## 回答 #3

> 赞同：8
> 
> 时间：2009-03-30T19:07:52.553

我认为您高估了存储/检索内容的复杂性。您不需要存储对象的 3D 模型、它们的纹理或构成游戏磁盘大小的大部分内容的任何东西。

首先，正如混乱所提到的，只需要存储有关已移动事物的信息。即便如此，您可能只需要为每一个存储新的位置和方向（假设不涉及其他变量，例如“损坏”）。这是每个对象的两个向量，每个对象总共大约有 24 个字节。这意味着您可以为每兆字节存储 40,000 个对象的信息。移动的物体太多了。

恢复这些数据并不比首先放置对象更复杂。每个对象都必须为游戏定义一个默认位置/方向才能将其放置在某个位置，因此您所做的就是用保存文件中存储的值替换默认值。这并不复杂，也不需要任何重要的额外处理。

* * *

## 回答 #4

> 赞同：4
> 
> 时间：2009-03-31T08:28:42.160

特别是在辐射 3 中，地图以网格方式划分。您只能看到您当前的方格和紧随其后的方格。数据存储的类型并不重要——可以是 SQLite 数据库，可以是序列化到磁盘的树，或者完全是其他东西。

> ...您是否会拥有游戏中每个对象的巨大数组，并不断更新一个较小的列表来保存要渲染的可见对象？

通常是的，但是“巨大的数组”不需要在内存中。还有更多的列表 - 当前和相邻网格中的对象（你可以从后面受到攻击 - 不在可见列表中），可见列表，计时器列表......

> 如果你最终触摸了游戏中的每一个物体，会发生什么？你的存档游戏会越来越大吗？

可以 - 如果所有内容都有默认状态表，则保存只能包含差异。然后保存将随着您的进步而增长。

> 当您离开/返回某个位置时，一切都会保留。

没有。您丢在屋外的物品最终会消失。身体也可能。随机怪物每隔一段时间就会重生一次。这对游戏设计师来说既方便又符合现实世界。

* * *

## 回答 #5

> 赞同：3
> 
> 时间：2009-03-30T18:56:01.460

如果您考虑一下您需要保存的信息，实际上并没有那么多。

例如

*   位置
*   方向
*   存货
*   健康
*   客观状态

当然还有更多，其中许多取决于游戏类型和保存结构的组织方式。

某些游戏（例如生化危机）仅在您进入新区域时才允许保存，这意味着您不必存储两个区域中实体的所有信息。当您“加载”保存时，它们的属性来自光盘。

至于这是如何检索/修改数据的，我不太确定我是否理解。它只是控制台内存中的数据。当播放器保存时，它被写入保存设备，当他们加载时，它被恢复。

* * *

## 回答 #6

> 赞同：2
> 
> 时间：2009-03-30T18:58:08.240

一种主要技术是差异保存：仅保存不是默认值的状态。将“保存游戏世界中每个对象的状态和位置”与“保存游戏世界*中玩家移动或改变*的每个对象的状态和位置”进行比较和对比。

* * *

## 回答 #7

> 赞同：1
> 
> 时间：2009-03-31T07:15:43.710

与其他答案相呼应，最大的节省来自消除所有不必要的状态数据。

如果您查看 8 位横向卷轴游戏，它们会在画面离开后立即开始丢弃状态，并且通常什么都不保留，因为它们的资源太紧而无法保持超过最小实例数。

在宏观层面上为《辐射 3》这样的游戏做这件事只是扩大问题的范围。您开始通过网格或其他几何方法划分景观，并在玩家从一个部分移动到下一个部分时产生/消失东西。理想情况下，您可以将每个区域的大小保持在较小的范围内，以使内存中的状态不高。您计算出保留 NPC 和项目实例所需的最低限度的状态，并在布局数据中尽可能多地标记为自动重生，以便它不需要保存任何状态。

如果您想指向特定的数据结构，示例序列化格式可能是由指针树索引的线性流，其中树的组织对应于地图布局。

* * *

## 回答 #8

> 赞同：1
> 
> 时间：2009-03-31T08:14:59.807

与此相关的是，游戏引擎通常使用 Zip 压缩，以减小所有内容的大小并加快某些操作。

* * *

## 回答 #9

> 赞同：1
> 
> 时间：2009-03-31T08:21:16.127

除了其他人所说的之外，我想补充一点，状态并不一定意味着位置和运动，还包括各个状态的属性。通常一个游戏引擎有一个功能可以让你保存某个类的数据。

假设您有一个 Player 类并且您对故事很了解，当您单击保存时，可以存储的可能数据是：

*   玩家在 **关卡/地图中的位置**
*   他的属性是什么：健康，法力，力量，智力等
*   他有什么技能。
*   他什么水平。

在全球范围内，我们还可以拥有：

*   有多少对对象的**引用**（允许引擎从列表中提取对象的名称）存储在该特定级别中，换句话说，当您加载应该与它一起加载的对象时。
*   我们是否在使用物理学，如果是，谁在使用它。

还有很多。辐射 3 有一种保存类型，另一款游戏会有另一种。这真的取决于流派和使用的引擎。

# c++ - 在 C++ 中的双精度数组中搜索最接近的值？

> ID：698520
> 
> 赞同：7
> 
> 时间：2009-03-30T18:43:38.417
> 
> 标签：c++, search, stl

我在 C++ 中有一个双精度值的排序数组。是否有一个 STL 函数可以将数组中最近值的索引返回给给定的双精度**值****？**

 **例如，给定以下数组

```
double myarray[5] = { 1.0, 1.2, 1.4\. 1.5, 1.9 }; 
```

函数调用

```
search(myarray, 1.6); 
```

应该返回`3`最接近 1.6 的元素的索引，而不是`-1`（或其他一些标志值）指示未找到值 1.6。

* * *

## 回答 #1

> 赞同：12
> 
> 时间：2009-03-30T18:49:07.373

也许`std::lower_bound` `std::upper_bound`会帮助你。

* * *

## 回答 #2

> 赞同：7
> 
> 时间：2009-03-31T14:09:17.037

这是使用的通用解决方案`std::lower_bound`：

```
template <typename BidirectionalIterator, typename T>
BidirectionalIterator getClosest(BidirectionalIterator first, 
                                 BidirectionalIterator last, 
                                 const T & value)
{
    BidirectionalIterator before = std::lower_bound(first, last, value);

    if (before == first) return first;
    if (before == last)  return --last; // iterator must be bidirectional

    BidirectionalIterator after = before;
    --before;

    return (*after - value) < (value - *before) ? after : before;
} 
```

您会注意到我使用了双向迭代器，这意味着该函数只能与可以递增和递减的迭代器一起使用。更好的实现只会强加输入迭代器的概念，但对于这个问题，这应该足够好了。

由于您需要索引而不是迭代器，因此可以编写一个小辅助函数：

```
template <typename BidirectionalIterator, typename T>
std::size_t getClosestIndex(BidirectionalIterator first, 
                            BidirectionalIterator last, 
                            const T & value)
{
    return std::distance(first, getClosest(first, last, value));
} 
```

现在你最终得到了这样的代码：

```
const int ARRAY_LENGTH = 5;
double myarray[ARRAY_LENGTH] = { 1.0, 1.2, 1.4\. 1.5, 1.9 };

int getPositionOfLevel(double level)
{
    return getClosestIndex(myarray, myarray + ARRAY_LENGTH, level);
} 
```

这给出了以下结果：

```
level | index
 0.1  |  0
 1.4  |  2
 1.6  |  3
 1.8  |  4
 2.0  |  4 
```

* * *

## 回答 #3

> 赞同：3
> 
> 时间：2009-03-30T18:50:33.487

数组是否保证按升序排列？如果是这样，`std::lower_bound` 请看一下。

* * *

## 回答 #4

> 赞同：3
> 
> 时间：2009-03-30T21:10:21.747

我认为我的示例完全符合您的要求：

（我使用 std::min_element 和仿函数）

```
#include <algorithm>
#include <cmath>

const int ARRAY_LENGTH = 5;
double myarray[ARRAY_LENGTH] = { 1.0, 1.2, 1.4, 1.5, 1.9 };

struct CompareDistanceFromLevel
{
    CompareDistanceFromLevel(double cLevel) : level(cLevel) {}

    bool operator()(double lhs, double rhs)
    {
        return std::abs(level - lhs) < std::abs(level - rhs);
    }

private:
    double level;
};

size_t getPositionOfLevel(double level)
{
    double *result;
    result = std::min_element(myarray, myarray+ARRAY_LENGTH, CompareDistanceFromLevel(level));
    return (result-myarray); // returns the index
} 
```

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2009-03-31T14:45:50.320

```
#include "stdafx.h"
#include <limits>

using namespace std;

static const int array_len = 5;
double myarray[array_len] = { 1.0, 1.2, 1.4, 1.5, 1.9 };

int approx_search(const double val)
{
    double min_val = numeric_limits<double>::max();
    int index = 0;

    for(int i=0;i<array_len;++i)
    {
        double diff = abs(myarray[i] - val);
        if(diff<min_val)
        {
            min_val = diff;
            index = i;
        }
    }
    return index;
}
int _tmain(int argc, _TCHAR* argv[])
{
    printf("approximate %d\n",approx_search(1.6));
    printf("approximate %d\n",approx_search(1.7996));
    printf("approximate %d\n",approx_search(1.4996));
    printf("approximate %d\n",approx_search(0.0002));

    return 0;
 } 
```

# php - “大多变量回声”的方式更简单？

> ID：698522
> 
> 赞同：1
> 
> 时间：2009-03-30T18:43:44.920
> 
> 标签：php, arrays, variables

假设我在 PHP 中呼应大量变量，我不会让它变得简单，我该怎么做？目前我的代码如下，但是写出所有不同的变量名是非常繁琐的工作。

```
echo $variable1;
echo $variable2;
echo $variable3;
echo $variable4;
echo $variable5; 
```

您会注意到变量名称是相同的，除了末尾的递增数字。我将如何编写一个`$variable;`多次打印 echo 并在最后添加一个递增数字的脚本，以节省我写出多个变量名并多次粘贴一个脚本的时间。？

谢谢，斯坦尼

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2009-03-30T18:47:12.340

您可以使用[变量变量](http://us.php.net/language.variables.variable)：

```
for($x = 1; $x <= 5; $x++) {
    print ${"variable".$x};
} 
```

然而，无论你在做什么，几乎可以肯定有一个更好的方法：可能使用数组。

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2009-03-30T18:53:54.303

我第二个保罗贝尔甘蒂诺。如果你可以使用一个更好的数组。如果你不知道怎么做，你去：

而不是像这样制作变量：

```
$var1='foo';
$var2='bar'; 
$var3='awesome'; 
```

...等...您可以创建一个称为数组的单个变量，如下所示：

```
$my_array = array('foo','bar','awesome'); 
```

你知道，在数组中，第一个元素是第 0 个元素（不是第一个）。所以，为了呼应 'foo' 和 'bar' 你可以这样做：

```
echo $my_array[0]; // echoes 'foo'
echo $my_array[1]; // echoes 'bar' 
```

但是，将值放入数组而不是一堆变量的真正好处是您可以像这样循环数组：

```
foreach($my_array as $item) {
    echo $item;
} 
```

就是这样。因此，无论您的数组中有多少项目，都只需要这三行即可将它们打印出来。祝你学习 PHP 好运！

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2009-03-30T18:49:22.693

使用动态变量名：

```
for($i=1; $i < 6; $i++) echo ${'variable'.$i} 
```

# cocoa - 带有蓝色外观的 NSButton 默认按钮

> ID：698529
> 
> 赞同：27
> 
> 时间：2009-03-30T18:45:47.177
> 
> 标签：cocoa, user-interface

我有一个带有 1 个或多个按钮的对话框，并且希望能够以编程方式将最右边的按钮设置为默认按钮，这样当用户按下 Enter 或 Return 键时，它应该像用户单击它一样响应。

我正在使用`[btn setKeyEquivalent:@"\r"]`，这使它工作正常，但我希望按钮具有蓝色的外观，这不会发生。我需要做什么？

* * *

## 回答 #1

> 赞同：40
> 
> 时间：2009-03-30T20:23:57.753

我错过了正确设置按钮边框样式的方法，这就是它看起来不正确的原因。我现在将按钮设置为：

```
[btn setBezelStyle:NSRoundedBezelStyle]; 
```

然后其中任何一个都可以设置默认按钮：

```
[myWindow setDefaultButtonCell:[btn cell]]; 
```

或者

```
[btn setKeyEquivalent:@"\r"] 
```

* * *

## 回答 #2

> 赞同：7
> 
> 时间：2017-03-03T12:19:20.233

我的设置是一个自定义工作表，我希望默认按钮在 NSAlert 中出现。以下配置为我提供了蓝色的默认外观。在 10.12.3 Sierra 中工作。

```
 button.bezelstyle = NSBezelStyleRounded; // Push in Interface Builder
   button.keyEquivalent = @"\r";
   button.highlighted = YES; // this is the most important part. 
```

* * *

## 回答 #3

> 赞同：6
> 
> 时间：2009-03-30T18:52:25.743

文档说：

> 请注意，如果您将键设置为等效于 Return，则该按钮将成为默认按钮。

因此，你做对了。您可以在设置等效密钥后尝试此操作：

```
[button setNeedsDisplay:YES]; 
```

这会强制按钮重新绘制自身。

* * *

## 回答 #4

> 赞同：2
> 
> 时间：2018-11-07T22:27:07.690

对于 Swift 4.2，只需使用

```
button.isHighlighted = true 
```

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2009-03-30T18:59:18.190

```
[myWindow setDefaultButtonCell:[btn cell]]; // should do the trick. 
```

有关详细信息，请参阅[Apple 的文档。](http://developer.apple.com/documentation/Cocoa/Reference/ApplicationKit/Classes/NSWindow_Class/Reference/Reference.html#//apple_ref/occ/instm/NSWindow/setDefaultButtonCell:)

# visual-studio - Web客户端软件工厂单元测试大失败

> ID：698534
> 
> 赞同：0
> 
> 时间：2009-03-30T18:46:47.363
> 
> 标签：visual-studio, unit-testing, wcsf

又是我……问题太多了，我知道，但在这方面我是个新手……

好吧，我在为使用 Microsoft 的 Web 客户端软件工厂构建的项目创建测试时遇到问题：我收到一条错误消息：

> 无法为 MyClassName 类设置 TestContext 属性。错误：System.ArgumentException：“Microsoft.VisualStudio.TestTools.TestTypes.Unit.UnitTestAdapterContext”类型的对象无法转换为“Microsoft.VisualStudio.TestTools.UnitTesting.TestContext”类型。

并且测试永远不会运行，有什么想法吗？

再次，提前感谢=）

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2009-03-30T19:00:02.120

MyClassName 类的 TestContext 属性的类型是什么？根据错误消息，它是错误的类型。将其与有效的测试进行比较。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-03-31T17:28:08.823

再一次，其中一个看不到的细节：我只需要更新这些库的引用：

*   Microsoft.VisalStudio.QualityTools.UnitTestFramework
*   Microsoft.VisalStudio.QualityTools.WebTestFramework

从版本 8.0 到 9.0。真的很明显，但这有效。

感谢一切。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2011-10-24T15:34:48.903

这是我讨厌的那种非特定的答案，但无论如何：

使用不同的单元测试框架！

与修复有错误的代码相比，我花费了至少 3 倍的时间来修复由于 MSTest 的“功能”而失败的测试。

随意对此投反对票，因为它对雨果没有帮助。我的真正目的是帮助警告其他人远离 MSTest 野兽。

# c# - 为什么我不能在这种情况下设置不透明度？

> ID：698535
> 
> 赞同：2
> 
> 时间：2009-03-30T18:47:02.650
> 
> 标签：c#, wpf, listbox, tabcontrol, opacity

情况是这样的……在顶层，我有一个 TabControl。TabControl 中的每个页面都包含一个 ListBox：

```
<TabControl>
    <TabItem Header="item 1">
        <ListBox>
            <ListBoxItem>sub item 1</ListBoxItem>
            <ListBoxItem>sub item 2</ListBoxItem>
            <ListBoxItem>sub item 3</ListBoxItem>
        </ListBox>
    </TabItem>
    <TabItem Header="item 2">
        <ListBox>
            <ListBoxItem>sub item 1</ListBoxItem>
            <ListBoxItem>sub item 2</ListBoxItem>
        </ListBox>
    </TabItem>
</TabControl> 
```

ListBox 有一个水平方向的 StackPanel 作为它们的 ListTemplate：

```
<Style TargetType="ListBox">
    <Setter Property="ItemsPanel">
        <Setter.Value>
            <ItemsPanelTemplate>
                <StackPanel Orientation="Horizontal"
                      VisibleChanged="onStackPanelVisibilityChange"
                      Loaded="onStackPanelLoaded"
                      VerticalAlignment="Center" HorizontalAlignment="Center" />
            </ItemsPanelTemplate>
        </Setter.Value>
    </Setter>
</Style> 
```

您会注意到我在该堆栈面板上有一些事件处理程序。这些是为堆栈面板中的项目设置动画，因此它们按顺序淡入视图。事件处理程序实现为：

```
void onStackPanelLoaded(object sender, RoutedEventArgs e)
{
    StackPanel panel = sender as StackPanel;

    applySubItemAnimations(panel);
}

void onStackPanelVisibilityChange(object sender, DependencyPropertyChangedEventArgs e)
{
    StackPanel panel = sender as StackPanel;

    if (panel.IsVisible)
    {
        applySubItemAnimations(panel);
    }
}

private void applySubItemAnimations(StackPanel panel)
{
    DoubleAnimation fadeIn = new DoubleAnimation();
    fadeIn.DecelerationRatio = 0.1;
    fadeIn.Duration = new Duration(new TimeSpan(0, 0, 0, 0, 500));
    fadeIn.From = 0.0;
    fadeIn.To = 1.0;

    for (int i = 0; i < panel.Children.Count; i++)
    {
        panel.Children[i].Opacity = 0.0;
        fadeIn.BeginTime = new TimeSpan(0, 0, 0, 0, 200 * i + 50);
        panel.Children[i].BeginAnimation(UIElement.OpacityProperty, fadeIn);
    }
} 
```

在大多数情况下，这很好用。当您第一次单击（或加载）选项卡时，堆栈面板中的子项会一个接一个地淡入视图。问题是当您单击返回到之前已经显示过一次的选项卡时（即，您处于“VisibleChanged”事件处理程序而不是“Loaded”处理程序中），所有项目都已显示并且它们按顺序*闪烁*，而不是从隐藏开始并按顺序*显示*。

这就是它变得丑陋的地方。这一行：

```
panel.Children[i].Opacity = 0.0; 
```

... 什么也没做。如果我在调试器中单步执行代码并在“panel.Children[i].Opacity”上进行观察，它会保持在 1.0。没有例外或任何东西。它只是......不起作用。

有任何想法吗？

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2009-03-31T14:13:09.960

我猜测可能会发生什么：WPF 不会在动画完成后删除动画，因此当您的代码`applySubItemsAnimations`第二次运行该方法时，之前的动画仍然存在。因此，您可以尝试通过将**null**作为第二个参数传递给

```
panel.Children[i].BeginAnimation(UIElement.OpacityProperty, null); 
```

之后，您可以应用新动画，因此整个`for`循环将如下所示：

```
for (int i = 0; i < panel.Children.Count; i++)
{            
    panel.Children[i].Opacity = 0.0;            
    fadeIn.BeginTime = new TimeSpan(0, 0, 0, 0, 200 * i + 50);            
    panel.Children[i].BeginAnimation(UIElement.OpacityProperty, null);        
    panel.Children[i].BeginAnimation(UIElement.OpacityProperty, fadeIn);        
} 
```

# delphi - 将 TObject 保存到文件

> ID：698536
> 
> 赞同：11
> 
> 时间：2009-03-30T18:47:03.557
> 
> 标签：delphi, object, save, delphi-7

如何将当前状态下的对象保存到文件中？这样就可以立即读取并恢复其所有变量。

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2009-03-30T19:57:54.213

As already stated, the easiest way is to use a **Stream** and its **WriteComponent** and **ReadComponent** methods.
But **be aware** that :
- it works **for descendants of TComponent**, not plain TObject;
- only **for the published properties** (those saved in a dfm), not the public ones nor (a fortiori) the privwte ones;
- you have to **pay a special attention for the Name property** when restoring the component.

You may find some code you could use in these SO answers: [Replace visual component at runtime in Delphi](https://stackoverflow.com/questions/120858/replace-visual-component-at-runtime-in-delphi-win32/122915#122915), [Duplicating components at Run-Time](https://stackoverflow.com/questions/239002/duplicating-components-at-run-time/239321#239321)

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2009-03-30T19:28:03.347

如果你从 TComponent 继承你的对象，你可以使用一些内置的功能将对象流式传输到文件中。我认为这只适用于简单的对象。

一些示例代码可以帮助您入门：

```
unit Unit1;

interface

uses
  Classes;

type
  TMyClass = class(TComponent)
  private
    FMyInteger: integer;
    FMyBool: boolean;
    FMyString: string;
  public
    procedure ToFile(AFileName: string);
  published
    property MyInteger: integer read FMyInteger write FMyInteger;
    property MyString: string read FMyString write FMyString;
    property MyBool: boolean read FMyBool write FMyBool;
  end;

implementation

{ TMyClass }

procedure TMyClass.ToFile(AFileName: string);
var
  MyStream: TFileStream;
begin
  MyStream := TFileStream.Create(AFileName);
  try
    Mystream.WriteComponent(Self);
  finally
    MyStream.Free;
  end;
end;

end. 
```

* * *

## 回答 #3

> 赞同：4
> 
> 时间：2009-03-30T18:54:53.397

您正在寻找的是所谓的对象持久性。这篇[文章](http://www.delphicorner.f9.co.uk/articles/comps5.htm)可能会有所帮助，如果您在谷歌上搜索“delphi 持久对象”，还有很多其他文章。

* * *

## 回答 #4

> 赞同：2
> 
> 时间：2009-03-30T19:05:18.833

在 SO上还有一个自己滚动的[XML 方法](https://stackoverflow.com/questions/396550/delphi-object-persistence-what-is-the-best-way)

* * *

## 回答 #5

> 赞同：2
> 
> 时间：2009-04-13T12:10:19.680

1.  非常简单高效的解决方案：[DragonSoft 的 XML Class Serializer](http://www.dragonsoft.us/delphi_vcl.php)
2.  您也可以使用 JVCL TJvAppXMLFileStorage：

    使用 JvAppXMLStorage；

    ```
    var
      Storage: TJvAppXMLFileStorage;
    begin
      Storage := TJvAppXMLFileStorage.Create(nil);
      try
        Storage.WritePersistent('', MyObject);
        Storage.Xml.SaveToFile('S:\TestFiles\Test.xml');
        Storage.Xml.LoadFromFile('S:\TestFiles\Test.xml');
        Storage.ReadPersistent('', MyObject);
      finally
        Storage.Free;
      end;
    end; 
    ```

* * *

## 回答 #6

> 赞同：1
> 
> 时间：2009-03-30T19:04:03.280

[这里有一个很好的教程](http://delphi.about.com/od/windowsshellapi/a/reader-writer.htm)。请记住，您必须拥有 RTTI（运行时类型信息）才能使用此方法在运行时保存对象，因此它只会捕获类的**已发布**属性。

* * *

## 回答 #7

> 赞同：-1
> 
> 时间：2009-03-30T22:50:37.543

你的问题已经得到了一些很好的答案。根据您实际执行的操作，可能需要使用预构建的库或组件来保存对象。这是一个便宜且漂亮的库/组件集，它使得持久化和恢复对象变得微不足道，并且非常容易（即，使用一点代码）适应持久化甚至对象的未发布成员： [http://www.deepsoftware。 ru/rsllib/index.html](http://www.deepsoftware.ru/rsllib/index.html) 不是什么火箭科学，但是如果你做很多这类事情，这个组件会为它提供一个很好的框架。

Developer Express 还包括一个通用的 cxPropertiesStore 组件，作为 ExpressEditors 库的一部分，该库随一些组件一起提供。

# javascript - JavaScript 习惯用法：创建一个函数只是为了调用它

> ID：698548
> 
> 赞同：16
> 
> 时间：2009-03-30T18:49:47.950
> 
> 标签：javascript, jquery, yui, idioms

我正在学习[YUI](http://en.wikipedia.org/wiki/Yahoo!_UI_Library)，偶尔会看到这个成语：

```
 <script>
     (function x(){ do abcxyz})();
 </script> 
```

为什么他们创建一个函数只是为了调用它？为什么不直接写：

```
<script>
    do abcxyz
</script> 
```

例如看[这里](http://yuiblog.com/blog/2008/10/17/loading-yui/)。

* * *

## 回答 #1

> 赞同：45
> 
> 时间：2009-03-30T18:53:54.693

他们正在利用[闭包](http://www.jibbering.com/faq/faq_notes/closures.html)。

一个简短的解释：由于 JS 使用函数级别的作用域，你可以在一个函数中做一堆动作，并让它保持在那个作用域内。这对于调用不会与全局命名空间混淆的代码很有用。它还允许创建私有变量 - 如果您在匿名函数内部声明一个变量并立即执行它，那么只有匿名函数内部的其他代码才能访问该变量。

例如，假设我想制作一个全局唯一 id 生成器。一个人可能会做这样的代码：

```
var counter = 0;
var genId = function()
{
    counter = counter + 1;
    return counter;
} 
```

但是，现在任何人都可以弄乱*counter*，而我现在已经用两个变量（*counter*和*genId*）污染了全局命名空间。

相反，我可以使用匿名函数来生成我的计数器函数：

```
var genId = function()
{
    var counter = 0;
    var genIdImpl = function()
    {
        counter = counter + 1;
        return counter;
    }

    return genIdImpl;
}(); 
```

现在，我在全局命名空间中只有一个变量，这是有利的。更重要的是，counter 变量现在可以安全地被修改——它只存在于匿名函数的作用域中，因此只有函数 genIdImpl（在同一作用域中定义）可以访问它。

看起来在 YUI 的示例代码中，他们只想执行完全不污染全局命名空间的代码。

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2009-03-30T18:56:47.277

我猜他们想避免命名空间冲突。似乎是 JS 中的一个好习惯。

# python - Google App Engine 本地环境错误：“无法导入名称 webapp”

> ID：698549
> 
> 赞同：0
> 
> 时间：2009-03-30T18:49:52.317
> 
> 标签：python, google-app-engine

我在 Windows 机器上建立了一个 GAE 站点，我想在我的 MacBook 上工作。我有远程 SVN 中的代码，我安装了这个启动程序附带的 Mac 版本的 GAE。当我在启动器中配置我的应用程序并启动应用程序时，我收到以下错误：

```
22 from datetime import timedelta
23
24 from google.appengine.ext import webapp
25 from google.appengine.ext.webapp import template
26 
google undefined, webapp undefined

<type 'exceptions.ImportError'>: cannot import name webapp 
```

这对我来说真的很奇怪，因为它在生产环境和我的 Windows 开发机器上运行了很长时间，所以它一定与平台变化有关。有没有人遇到过这个问题？这就像 google.appengine 模块丢失或什么的。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2009-03-30T19:57:35.523

听起来您的 Mac GAE 安装伙伴出了点问题。我假设你已经安装了 Leopard。正如文档所说，[Leo 带有 py2.5](http://code.google.com/appengine/docs/python/gettingstarted/devenvironment.html)，我再次假设您正在使用它。您可能需要通过[MacPorts](http://www.macports.org/install.php)安装 Python 2.5并将您的 GAE 开发服务器重新指向该服务器。我相信这就是我的 MacBook 的设置方式，但我很久以前就做过了，我不记得了。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-05-20T19:02:10.410

我知道这是一个死问题，但我最近在使用[django-nonrel](https://django-nonrel.readthedocs.org/en/latest/content/djangoappengine%20-%20Django%20App%20Engine%20backends%20%28DB,%20email,%20etc.%29.html#file-uploads-downloads)时遇到了同样的问题，这会让我在 gae 上放置一个 django 项目。

从内部检查`lib`文件夹后`google_appengine`，我发现我有两个 webob 文件夹（`webob_1_1_1`和`webob_0_9`），所以我已经软链接（`ln -s`-*nix / 或简单地复制）`webob_1_1_1`到`webob`.

这解决了我的问题。

希望它可以帮助某人。

# sharepoint - 创建员工目录

> ID：698556
> 
> 赞同：3
> 
> 时间：2009-03-30T18:51:06.837
> 
> 标签：sharepoint, sharepoint-2007, outlook-2007

我们正在研究我们环境中存在的各种选项以创建员工目录。我们有一个 SharePoint 门户 AD，并且最近从 Lotus Notes 迁移到了 Exchange。我们当前的员工搜索是一个自定义的 Notes 数据库，该数据库已经退役。

自一年前迁移到 SharePoint 以来，我们使用了一个自定义列表，该列表使用从 AD 更新的 SharePoint 配置文件。但是简单的列表界面对用户不是很友好，而且速度很慢。其中一些要求包括预先输入、图片以及技能/认证的详细信息和其他人口统计信息等。我们正在考虑构建一个可以使用 SharePoint 列表中的信息的 ASP.NET 或 SilverLight 应用程序。随着 Outlook 和全局地址列表的引入，我们现在想知道在 Outlook 中构建某些东西是否会更容易。

有没有人走过类似的道路，你会建议我们做什么？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-03-30T20:19:45.377

Microsoft在 Sharepoint 中为[协作和社交计算提供了大量产品。](http://www.microsoft.com/sharepoint/capabilities/collaboration/overview.mspx)

有关与员工目录相关的功能的信息，包括技能/认证和其他人口统计信息的详细信息，请参阅[本文档第 8 页和第 9 页。](http://www.microsoft.com/downloads/details.aspx?FamilyId=C5844123-7F31-49D4-811C-7B90E6217B1D)

单个功能（例如人物档案和人物搜索）的点菜可用性和定价可能是一个问题，但您可能希望考虑购买某些东西而不是构建它（如果您能以您可以的价格获得您想要的部分）买得起）。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-08-06T15:14:31.737

我们非常有效地使用人员搜索。我们在 AD 中填充数据，然后将配置文件属性连接到 AD 属性。不过，这只是在您拥有 MOSS 的情况下。如果您正在使用 WSS，您将不得不构建一些更自定义的东西。

然而，一个问题是开箱即用的人物搜索并不容易进行部分搜索（即搜索“john”与“johnson”不匹配）。在我看来，这是一个很大的挫折。您可以使用 Ramon Scott 的Content Editor Webpart[方法](http://www.ramonscott.com/wordpress/?p=8)和表单和一些 Javascript 来解决它，您也可以通过高级搜索框（尽管是间接的）到达那里，但如果它很容易制作肯定会很好默认搜索框进行部分名称搜索。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-03-30T20:04:53.073

如果您想使用 Outlook，Sharepoint 可以与 Outlook 连接以保持列表同步。并且肯定有很多不同的方法可以更改列表在 Sharepoint 门户中的显示方式，以使它们更加用户友好。将这些详细信息与 SharePoint 中强大的搜索和索引功能结合使用时，门户上的这些详细信息肯定会是一个福音，因此您可以根据员工的个人资料详细信息轻松识别员工。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2014-07-16T13:21:51.553

这应该通过使用 SharePoint 中可用的“我的网站”功能来解决。然后，您将能够按技能、证书、项目和教育资格搜索 SharePoint 用户。

有关详细信息，请参阅 TechNet 上的 SharePoint 规划和部署材料。

上海。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2013-12-13T15:50:35.163

我最近刚刚发现了一个稍微简单的 Visual Basic 脚本，它从活动目录中提取信息，您可以在其中指定要从哪个 OU 中提取，它在一个简单的 .HTM 页面中显示所有用户信息。它包括一个搜索栏，识别模式（地址）（公司电话号码）等...如果您愿意，我可以为您发布。您只需要填写几个部分（目录的显示名称、OU、OU 显示和标签），您也可以随时更改事物的外观。

# emacs - 在 Emacs Org-Mode 导出中禁用下划线到下标

> ID：698562
> 
> 赞同：71
> 
> 时间：2009-03-30T18:53:31.013
> 
> 标签：emacs, latex, tex, org-mode

当我通过 org-mode (Cc Ce d) 导出到 PDF 时，任何带下划线的单词最终都会部分转换为下标。我怎样才能防止这种情况发生？

我找到了这篇关于这个主题的文章：

[在 Emacs Tex 模式下禁用下划线下标](http://gimbo.org.uk/blog/2007/11/11/disabling_underscore_subscript_emacs_tex_mode/)

但是，我要么无法找出正确的 elisp，要么它根本不起作用。请注意，我不想更改任何全局字体选项。我只希望此修复适用于 tex/latex/org-mode。

我也找到了这篇文章，虽然它也没有工作：

[禁用下标上标升高/降低？](http://groups.google.com/group/gnu.emacs.help/browse_thread/thread/bfc9141338bde20b)

* * *

## 回答 #1

> 赞同：103
> 
> 时间：2009-03-30T19:59:09.733

您可以通过添加以下行来禁用 org 文件中的超级/下标：

```
#+OPTIONS: ^:nil 
```

查看组织手册以获取更多选项。
以下命令插入包含所有选项的模板： `C-c C-e #`

* * *

## 回答 #2

> 赞同：35
> 
> 时间：2009-03-31T14:22:30.640

我能够通过设置以下变量来解决这个问题：

```
(setq org-export-with-sub-superscripts nil) 
```

* * *

## 回答 #3

> 赞同：8
> 
> 时间：2013-04-29T08:31:25.787

我认为这会更容易：[http](http://orgmode.org/manual/Subscripts-and-superscripts.html) ://orgmode.org/manual/Subscripts-and-superscripts.html 用反斜杠转义下划线：

![在此处输入图像描述](https://i.stack.imgur.com/p6Opd.jpg)

![在此处输入图像描述](https://i.stack.imgur.com/pTaDX.jpg)

现在，逃避_：

![在此处输入图像描述](https://i.stack.imgur.com/SLQBI.jpg)

![在此处输入图像描述](https://i.stack.imgur.com/vjiFB.jpg)

您可以在这里看到这一点：[http ://www.railsonmaui.com/blog/2013/04/27/octopress-setup-with-github-and-org-mode/](http://www.railsonmaui.com/blog/2013/04/27/octopress-setup-with-github-and-org-mode/)

* * *

## 回答 #4

> 赞同：6
> 
> 时间：2018-12-05T16:35:05.843

使用`\under`（组织手册上的文档[：特殊符号](https://orgmode.org/manual/Special-symbols.html#Special-symbols)）

例如：

```
text\under{}text 
```

* * *

## 回答 #5

> 赞同：5
> 
> 时间：2009-03-31T05:15:59.707

您想防止源文件的屏幕显示或输出 PDF 的文本中出现下标吗？如果是后者，那么你想要

```
\usepackage{underscore} 
```

它也不会破坏数学模式下下划线的使用。

* * *

## 回答 #6

> 赞同：4
> 
> 时间：2012-03-15T10:12:01.027

对于个别情况，以这种方式插入文字下划线：

```
text text one\textunderscore{}two text 
```

* * *

## 回答 #7

> 赞同：0
> 
> 时间：2018-06-13T20:56:50.450

就我而言，任何包含下划线的单词都可能是变量名或类似名称。我只是用`=`or包围它，`~`这样它就被这样对待了。然后它将相应地导出。

# javascript - 通过单击具有嵌套 div 的 div 来加载 iframe

> ID：698564
> 
> 赞同：0
> 
> 时间：2009-03-30T18:53:54.193
> 
> 标签：javascript

我有一组带有嵌套项目的 div

```
<div id="second-item" class="dock-item">
  <div class="website-name">Facebook.com</div>
  <div class="website-screenshot"><img src="fb-thumb.png" /></div>
  <div class="page-name">Facebook</div>
</div>
    <div id="third-item" class="dock-item">
  <div class="website-name">Mozilla.com</div>
  <div class="website-screenshot"><img src="uwdt-thumb.jpg" /></div>
  <div class="page-name">Mozilla</div>
</div> 
```

我有一个 iframe #frame1

```
<iframe id="frame1"></iframe> 
```

当用户单击父#second-item div 时，我需要 iframe #frame1 来加载 facebook.com

当用户单击父级#third-item div 时，我需要 iframe #frame1 来加载 mozilla.com

我怎么做？

我尝试在 div #second-item 和 #third-item 中添加以下 onclick 但它不起作用：

'onclick="frames['frame1'].location.href=' [http://sitename.com](http://sitename.com) '"'

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2009-03-30T19:54:42.737

Many ways lead to Rome (Here just two ways!).

```
<!-- points on first frame-->
<div id="second-item" class="dock-item" onclick="window.frames[0].location.href='http://facebook.com'">
  <div class="website-name">Facebook.com</div>
  <div class="website-screenshot"><img src="fb-thumb.png" /></div>
  <div class="page-name">Facebook</div>
</div>
<!-- points on name -->
<div id="third-item" class="dock-item" onclick="window.frames['frame1'].location.href='http://mozilla.com'">
  <div class="website-name">Mozilla.com</div>
  <div class="website-screenshot"><img src="uwdt-thumb.jpg" /></div>
  <div class="page-name">Mozilla</div>
</div>
<iframe id="frame1" name="frame1"></iframe> 
```

The better solution:

```
<!-- points on id -->
<div id="fourth-item" class="dock-item" onclick="document.getElementById('frame1').src='http://www.phpclasses.org';return false;">
  <div class="website-name">phpclasses.org</div>
  <div class="website-screenshot"><img src="uwdt-thumb.jpg" /></div>
  <div class="page-name">PhpClasses</div>
</div> 
```

# tomcat - OSGi 插件不会在 tomcat 中启动

> ID：698568
> 
> 赞同：0
> 
> 时间：2009-03-30T18:54:18.563
> 
> 标签：tomcat, plugins, eclipse-plugin, osgi

我有一个带有激活器的 OSGi 插件，我要求在我的 tomcat jsf 项目下启动它。

基于： http: [//www.eclipse.org/equinox/documents/quickstart.php](http://www.eclipse.org/equinox/documents/quickstart.php)和其他一些文档，我已将此结构放在我的 WEB-INF 目录下以启动 osgi 的Equinox 实现。我已经能够直接访问插件，但不能通过从另一个插件引用它以编程方式访问它。这就是那个例子。

MyProject 配置/config.ini org.eclipse.osgi_3.3.0.jar org.eclipse.equinox.common_3.3.0.jar org.eclipse.update.configurator_3.2.100.jar plugins/com.fnet.tts.service_1.0.0.jar

我在 config.ini 中放置了以下两行

osgi.bundles=org.eclipse.equinox.common@2:start, org.eclipse.update.configurator@start, org.eclipse.equinox.registry@3:start, com.fnet.tts.service@4:start osgi .bundles.defaultStartLevel=4

但是，当我尝试激活调用 tts.service 的包时出现此错误。

详细信息：com.fnet.runtime.KSException：无法在 com.runtime.impl.RuntimeServiceImpl$KSImpl .loadKnowledgebase(RuntimeServiceImpl.java:190) 处启动捆绑“com.fnet.tts.service.viewSchedule_2.0.0.jar” ..loadKnowledgebaseHandle(InterviewContext.java:83) 原因：org.osgi.framework.BundleException：无法解析捆绑包。原因：缺少约束：Require-Bundle: com.fnet.tts.service；bundle-version="1.0.0" at org.eclipse.osgi.framework.internal.core.BundleHost.startWorker(Bundl eHost.java:305) at org.eclipse.osgi.framework.internal.core.AbstractBundle.start(摘要 tBundle.java:265) 在 org.eclipse.osgi.framework.internal.core.AbstractBundle.start(Abstract tBundle.java:257) 在 com.fnet.runtime.impl.RuntimeServiceImpl$KSImpl .loadKnowledgebase(RuntimeServiceImpl.java:

我已经看了好几个小时了，我正在寻找线索、提示或答案，以便我可以继续前进。

谢谢。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2009-03-31T03:00:14.977

您能否启用更多调试输出以查看“com.fnet.tts.service”捆绑包发生了什么？Equinox 是否尝试加载它但失败了，或者甚至没有尝试？

另外，您可以访问 OSGi 控制台吗？如果是这样，已安装捆绑包的列表如何？您可以从控制台手动安装捆绑包吗？

您在开始级别 4 开始您的捆绑包。可能尚未达到此开始级别。当您在第 1 级启动捆绑包（所有捆绑包？）时它是否有效？

# flash - 有没有办法检查 AS2 中的 Flash 电影元素？

> ID：698571
> 
> 赞同：0
> 
> 时间：2009-03-30T18:55:24.720
> 
> 标签：flash, actionscript-2, section508

我在基于 Flash 的培训课程中遇到了一个主要问题，该课程正在渲染看不见的额外图形。当使用屏幕阅读器在课程上运行 508 合规性测试时，就会实现这一点。有很多时候它只是说“图形 13”，而我无法知道获取此标题并可供屏幕阅读器使用的对象是什么，以便我可以禁用它。我需要一种方法，以便它可以以某种方式突出显示，或者我可以检查整个 Flash 文档，以便我可以看到当前名称为“graphic 13”的内容。有任何想法吗？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-03-30T20:48:28.240

你应该试试[X-Ray](http://osflash.org/xray)，它适用于 AS2，非常适合这类事情。

# nunit - NUnit 忽略所有测试

> ID：698572
> 
> 赞同：29
> 
> 时间：2009-03-30T18:55:26.907
> 
> 标签：nunit

我可以在测试中添加一个属性来忽略它

```
[Test]
[Ignore("Foo Bar")] 
```

有什么方法可以忽略文件中的所有测试（在 TestFixture 级别）？

* * *

## 回答 #1

> 赞同：80
> 
> 时间：2009-08-01T17:36:49.743

```
[TestFixture, Ignore("reason")]
public class YourTestFixture { } 
```

或者，如果您希望将属性分解为每行一个：

```
[TestFixture]
[Ignore("reason")]
public class YourTestFixture { } 
```

* * *

## 回答 #2

> 赞同：8
> 
> 时间：2009-07-20T17:22:02.840

如建议的那样，该`[Explicit]`属性运行良好。您也可以简单地将`[Ignore()]`属性放在属性下`[TestFixture]`，如文档中所示：

[http://www.nunit.org/index.php?p=ignore&r=2.5](http://www.nunit.org/index.php?p=ignore&r=2.5)

如果`[Ignore()]`您希望将测试标记为忽略（因此如果所有其他测试都通过，您会看到黄色条）。如果`[Explicit]`您希望测试完全打折（因此如果所有其他测试都通过，您将获得绿色条）。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2009-03-30T18:56:58.320

从类中删除`[TestFixture]`属性似乎可行。

编辑：从 NUnit 2.5 开始，当该`[TestFixture]`属性对于非参数化的非泛型夹具成为可选时，这个答案就出错了。请参阅[此处](http://nunit.org/index.php?p=testFixture&r=2.6.2)了解更多信息。

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2009-05-13T00:33:47.860

您可以使用该属性使整个`TestFixture`“按需” 。`[Explicit]`然后它在你想要的时候就在那里，但只有当你明确地点击它时。

* * *

## 回答 #5

> 赞同：-13
> 
> 时间：2009-03-30T18:56:50.710

只需不要在类上应用 TextFixture 属性。

# indexing - 是否有索引/监控驱动器文件的最佳实践或技巧？

> ID：698574
> 
> 赞同：0
> 
> 时间：2009-03-30T18:56:05.593
> 
> 标签：indexing, desktop-application, drive

我需要查找和监控硬盘驱动器或照片管理器文件夹中的所有照片。目前我正在天真地这样做：递归遍历，手动将文件夹标记为索引，并重复该过程以捕捉添加或移动照片的时间。

问题在于足够大的文件夹树，这非常昂贵，因此我正在寻找以不同方式执行此操作的技巧和/或保持其低 CPU 进程的技巧。

理想情况下，解决方案不依赖于平台。

编辑：我目前正在使用 xulrunner，但可以编译一个模块来做平台特定的东西。
第一次跑呢？除了手动运行整个文件夹树之外，是否没有解决方案（甚至取决于平台）。

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2009-03-30T19:13:28.360

> 理想情况下，解决方案不依赖于平台。

不可能的。Win32API 有 FindFirstChangeNotification，Linux 有 inotify（和其他），Mac OS X 有 FSEvents 等等。这是非常底层的东西，没有任何操作系统与任何其他操作系统一样。如果你想要跨平台的东西，你必须找到一个在你想要的平台上工作的具有多个后端的 API，但如果有的话，我还没有找到它们。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-03-30T19:03:45.450

我不知道以独立于平台的方式执行此操作的方法，但是在 Linux 上，我会挂接到 inotify 以在添加或更新文件时调用某些内容。发生这种情况时，您甚至可以使用[inotify-tools](http://inotify-tools.sourceforge.net/)运行脚本，因此如果这些事件不频繁，您不必一直运行来捕获所有这些事件。只需让脚本更新数据库，如果它正在运行，可选择通知您的画廊/显示程序。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-03-30T19:05:38.893

你在.NET上编码吗？如果是这样，您可以改用[FileSystemWatcher](http://msdn.microsoft.com/en-us/library/system.io.filesystemwatcher.aspx)类。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2009-03-30T19:06:13.073

为什么不使用文件观察程序，它会通知您特定文件夹树的更改？

如果您想编写自己的代码，可以使用 FileSystemWatcher 类来完成。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2015-01-26T00:26:50.647

截至 2014 年的一个答案是 facebook 的守望者：[https ://facebook.github.io/watchman/](https://facebook.github.io/watchman/)

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2017-11-07T01:05:45.050

[几年前，我将 Windows API 的一些功能移植到 Linux，例如（ FindFirstChangeNotification](https://github.com/paulorb/FileMonitor)，FindCloseChangeNotification ...） [/paulorb/文件监视器](https://github.com/paulorb/FileMonitor)

# vb.net - 导出到 Excel

> ID：698578
> 
> 赞同：1
> 
> 时间：2009-03-30T18:58:00.613
> 
> 标签：vb.net, excel, asp.net-2.0, export-to-excel

我想将 GridView 导出到 excel，这很容易。但在网格上方，在 Excel 中，我想要一些其他信息用于识别。我可以以某种方式导出除网格视图以外的东西，然后放入下面的网格视图吗？

**编辑：** 由于某种原因，当 GridView1 可见并且我尝试导出时，整个页面都会导出，而不仅仅是 gridview。不知道为什么！

```
Protected Sub btnExport_Click(ByVal sender As Object, ByVal e As System.EventArgs) Handles btnExport.Click
    'Create a StringWriter and HtmlTextWriter
    Dim sw As System.IO.StringWriter = New System.IO.StringWriter()
    Dim htw As New System.Web.UI.HtmlTextWriter(sw)

    'Clear the Response object's content and specify the header for the HTML response and type of application file to create
    Response.ClearContent()
    Response.AddHeader("content-disposition", "attachment; filename=SaveFile.xls")
    Response.ContentType = "application/vnd.ms-excel"
    Response.Charset = ""
    EnableViewState = False

    htw.WriteLine("Test, test, test")

    Try
        'Check for the number of GridView rows
        If GridView1.Rows.Count < 65535 Then
            'Turn sorting and paging off and rebind the GridView control
            GridView1.AllowSorting = False
            GridView1.AllowPaging = False
            GridView1.PageSize = GridView1.Rows.Count
            GridView1.AutoGenerateSelectButton() = False
            GridView1.DataBind()

            'Render the GridView1 as HTML - this will cause an error that will fire the VerifyRenderingInServerForm event -- this event is trapped by the Overriding sub procedure given at the end of the program listing
            GridView1.RenderControl(htw)

            'Write the response
            Response.Write(sw.ToString())
            Response.End()

            'Turn sorting and paging on and rebind the GridView control
            GridView1.AllowSorting = True
            GridView1.AllowPaging = True
            '.GridView1.PageSize = 10
            GridView1.AutoGenerateSelectButton() = True
            GridView1.DataBind()
        End If
    Catch ex As Exception

    End Try

End Sub 
```

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2009-03-30T19:04:50.220

是的你可以。

做这样的事情：

```
HttpContext.Current.Response.Write("some string value") 
```

在你通过你的gridview之前。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-03-30T20:00:42.973

如果您想将内容导出到 ExcelML，请查看[Telerik的 RadGrid](http://demos.telerik.com/aspnet-ajax/grid/examples/generalfeatures/exporting/defaultcs.aspx)

您还可以将标题信息插入网格等

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2009-06-29T10:38:09.600

这是我做同样事情的代码

```
protected void ExportExcel_OnClick(object sender, EventArgs e) {
    响应。清除（）；
    Response.AddHeader("content-disposition", "attachment;filename=brugere.xls");
    Response.Charset = "windows-1252";
    Response.ContentType = "应用程序/vnd.xls";
    使用 (StringWriter stringWrite = new StringWriter())
    使用 (HtmlTextWriter htmlWrite = new HtmlTextWriter(stringWrite)) {
        GridView1.AllowPaging = false;
        GridView1.DataBind();
        GridView1.RenderControl(htmlWrite);
        字符串 html = stringWrite.ToString();
        字符串结果 = Replacer.Replace(html, "");
        Response.Write(结果);
    }
    响应。结束（）；
}

```

请注意，我使用正则表达式修剪生成的 html 以避免格式化、图像、div 和诸如此类的东西。

```
静态只读 Regex Replacer = new Regex("(<input[^<>]*>)|"+
  "(类=\"[^\"]*\")|(样式=\"[^\"]*\")|"+
  "(<a[^]*>)|(</a>)|(<div>)|(</div>)|" +
  "(cellspacing=\"[^\"]*\")|(cellpadding=\"[^\"]*\")|" +
  "(id=\"[^\"]*\")|(border=\"[^\"]*\")", RegexOptions.IgnoreCase);

```

请记住覆盖以下内容以确保网格将呈现在页面之外

```
公共覆盖无效VerifyRenderingInServerForm（控制控制）{
    返回;
}

```

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2012-02-24T09:56:58.217

在 Excel 中打开此文件将生成一条警告消息。我会使用像 NPOI 这样的开源导出库之一。 [http://npoi.codeplex.com/](http://npoi.codeplex.com/)

如果您仍然喜欢使用 HTML 输出，您可以考虑从以下链接下载 Microsoft 关于 Office HTML 格式的文档：http: [//msdn.microsoft.com/en-us/library/aa155477%28office.10%29.aspx](http://msdn.microsoft.com/en-us/library/aa155477%28office.10%29.aspx)

您只需要此存档中的 CHM 文件（打包在 EXE 中）。

祝你好运。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2011-11-23T12:12:28.103

如果您的 GridView 使用来自 DataTable、DataSet 或 List<> 的数据填充，则以下库将允许您通过调用一个“ **CreateExcelDocument** ”函数将其导出到 Excel 2007 (.xlsx) 文件。

```
// Step 1: Create a DataSet, and put some sample data in it
DataSet ds = CreateSampleData();

// Step 2: Create the Excel .xlsx file
try
{
    string excelFilename = "C:\\Sample.xlsx";
    CreateExcelFile.CreateExcelDocument(ds, excelFilename);
}
catch (Exception ex)
{ 
    MessageBox.Show("Couldn't create Excel file.\r\nException: " + ex.Message);
    return;
} 
```

提供了完整的源代码，因此您可以对其进行调整，以在一个或多个工作表的顶部添加额外的数据行。

这个库使用*Open XML*库，所以它是完全免费的。 [http://www.mikesknowledgebase.com/pages/CSharp/ExportToExcel.htm](http://www.mikesknowledgebase.com/pages/CSharp/ExportToExcel.htm)

# user-interface - 应用界面模板

> ID：698581
> 
> 赞同：0
> 
> 时间：2009-03-30T18:58:25.417
> 
> 标签：user-interface, project-planning

我正在为数据收集 Web 应用程序创建前端。使用数据收集应用程序的操作员将记录十几个不同项目的数据，每个项目需要不同的字段。有一些常见字段（如姓名、地址……等），但每个项目也有自定义字段，用于需要收集的额外数据。有些项目需要几十个额外的字段，而有些项目只需要 1 或 2 个字段。谁能想到一种“干净”的方式来处理这种情况？我不想为每个项目创建一个输入页面，有些人正在折腾用 XML 做 UI 模板的想法。任何指导将不胜感激。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-03-30T19:10:01.317

XML 将为您的问题提供一个简洁的解决方案。根据用户的选择，要求用户填写更多字段。从您的问题陈述来看，您知道有多少项目需要额外的字段，哪些不需要。如果您知道这些数据，则将这些数据输入数据库，然后相应地生成您的表单页面。但是，即使使用交互式 javascript 和 ajax 可以动态获得数据，您也可以轻松实现简洁的解决方案。

# file - 调度 RichCopy 作业

> ID：698582
> 
> 赞同：0
> 
> 时间：2009-03-30T18:58:49.753
> 
> 标签：file, copy

有人使用 RichCopy 的计时器功能吗？当我手动开始工作时，我有一份工作正常。但是，当我安排作业并单击运行时，该应用程序似乎正在等待预定时间过去但从未触发。有趣的是，当我停止工作时，副本开始。

有人有使用 RichCopy 计时器的经验吗？

伊恩B

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-08-26T15:17:22.437

尝试使用命令行选项创建一个批处理文件。然后使用 windows scheduler 启动批处理。

* * *

## 回答 #2

> 赞同：-3
> 
> 时间：2010-03-14T22:51:33.057

OMBG (Bill Gates) 您需要阅读并获得安全策略以及它必须对上游对象和凭证的层次结构的尊重。嗯，这就是MS的回答和态度......

现实情况是，如果您正在使用服务器操作系统，您需要了解它们的安全和策略框架，以及如何调试它们:)。如果您的进程失去了必要的文件权限或权利（2 种不同的事情），您应该问：“该死的，我为什么不在配置/设置中修复它”。爆破供应商/项目（甚至@#@#&$！MS）的人只是对解决方案视而不见。

在大多数情况下，此类问题是由于 Windows 的 AD 删除了本地管理员用户运行计划任务的权限。这是企业网络中的一种常见安全设置（由域管理员高兴地实施以使开发人员感到不安），尽管它现在实际上是一个默认设置。发生这种情况是因为机器根据上游策略更新（在您安排任务之后）并突然决定它不会信任您运行它（即使之前它允许您设置它）。在一个完美的世界里，它不会让你首先设置它，但这不是策略在 Windows 中应用的方式......（@#@#&$！MS）。哈哈

哇，只用了5个月就得到答案！（但他们至少是为下一个人准备的！）

# c# - 正则表达式匹配多个字符串

> ID：698596
> 
> 赞同：16
> 
> 时间：2009-03-30T19:03:32.657
> 
> 标签：c#, regex

我需要创建一个可以匹配多个字符串的正则表达式。例如，我想查找“好”或“好”的所有实例。我找到了一些例子，但我想出的似乎不起作用：

```
\b(good|great)\w*\b 
```

谁能指出我正确的方向？

**编辑：**我应该注意，我不想只匹配整个单词。例如，我可能也想匹配“ood”或“reat”（部分单词）。

**编辑 2：**这是一些示例文本：*“这是一个非常棒的故事。”* 我可能想匹配“this”或“really”，或者我可能想匹配“eall”或“reat”。

* * *

## 回答 #1

> 赞同：24
> 
> 时间：2009-03-30T19:37:21.593

如果您可以保证单词列表中没有保留的正则表达式字符（或者如果您对它们进行转义），则可以使用此代码将其`a big word list`转换为`@"(a|big|word|list)"`. 操作员在您使用它时没有任何问题`|`，只要它们`()`围绕它。听起来`\w*`和`\b`模式是干扰您的比赛的原因。

```
String[] pattern_list = whatever;
String regex = String.Format("({0})", String.Join("|", pattern_list)); 
```

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2009-03-30T19:06:15.727

```
(good)*(great)* 
```

编辑后：

```
\b(g*o*o*d*)*(g*r*e*a*t*)*\b 
```

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2012-01-16T11:47:08.377

我认为您是在要求某种东西

例如在“John and Shelly are cool”中搜索 {Jack, Jim}

正在搜索名称 {J,a,c,k,i,m} 中的所有字母

*J*ohn * *a* *nd Shelly *a*re

为此，您不需要 REG-EX :)

在我看来，**后缀**树可以帮助你

[http://en.wikipedia.org/wiki/Suffix_tree#Functionality](http://en.wikipedia.org/wiki/Suffix_tree#Functionality)

请享用。

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2009-03-30T19:40:55.330

我没有正确理解这个问题：

如果你想匹配“great”或“reat”，你可以用如下模式来表达：

```
"g?reat" 
```

这只是说“reat”部分必须存在，“g”是可选的。

这将匹配“reat”和“great”但不匹配“eat”，因为“reat”中的第一个“r”是必需的。

如果你有“great”和“good”这两个词，并且你想用可选的“g”来匹配它们，你可以这样写：

```
(g?reat|g?ood) 
```

如果您想包含一个单词边界，例如：

```
\b(g?reat|g?ood) 
```

您应该知道，这与“breat”之类的内容不匹配，因为您有“reat”，但“r”由于“b”而不在单词边界处。

因此，如果您想匹配包含子字符串链接“reat”或“ood”的整个单词，那么您应该尝试：

```
"\b\w*?(reat|ood)\w+\b" 
```

内容如下： 1\. 从单词边界开始匹配任意数量的单词字符，但不要贪心。2\. 匹配“reat”或“ood”确保只有那些包含其中一个的单词才匹配。3\. 匹配“reat”或“ood”之后的任意数量的单词字符，直到到达下一个单词边界。

这将匹配：

“goodness”、“good”、“ood”（如果是一个完整的词）

它可以读作：给我所有包含“ood”或“reat”的完整单词。

那是你要找的吗？

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2009-03-30T19:57:36.663

我不完全确定单独的正则表达式可以为您尝试做的事情提供解决方案。但是，您可以使用以下代码为给定单词创建正则表达式。虽然，***由此产生的正则表达式模式有可能变得非常漫长和缓慢***：

```
function wordPermutations( $word, $minLength = 2 )
{
    $perms = array( );

    for ($start = 0; $start < strlen( $word ); $start++)
    {
        for ($end = strlen( $word ); $end > $start; $end--)
        {
            $perm = substr( $word, $start, ($end - $start));

            if (strlen( $perm ) >= $minLength)
            {
                $perms[] = $perm;
            }
        }
    }

    return $perms;
} 
```

测试代码：

```
$perms = wordPermutations( 'great', 3 );  // get all permutations of "great" that are 3 or more chars in length
var_dump( $perms );

echo ( '/\b('.implode( '|', $perms ).')\b/' ); 
```

示例输出：

```
array
  0 => string 'great' (length=5)
  1 => string 'grea' (length=4)
  2 => string 'gre' (length=3)
  3 => string 'reat' (length=4)
  4 => string 'rea' (length=3)
  5 => string 'eat' (length=3)

/\b(great|grea|gre|reat|rea|eat)\b/ 
```

* * *

## 回答 #6

> 赞同：1
> 
> 时间：2013-04-01T15:59:06.903

只需检查`Regex.IsMatch()`返回的布尔值。

```
if (Regex.IsMatch(line, "condition") && Regex.IsMatch(line, "conditition2")) 
```

该行将具有两个正则表达式，对。

# wpf - 为什么我的文字被裁剪？

> ID：698617
> 
> 赞同：3
> 
> 时间：2009-03-30T19:06:31.263
> 
> 标签：wpf, user-interface, xaml

当我尝试将文本块添加到边框元素时，我只看到部分文本。我将文本添加到边框后旋转文本，这导致了问题。增加边框的宽度可以解决此问题。但是，我的边界只需要 20 个单位宽。

[替代文字 http://img257.imageshack.us/img257/1702/textcrop.jpg](http://img257.imageshack.us/img257/1702/textcrop.jpg)

我在这里想念什么？

```
 <Border
          Name="BranchBorder"
          CornerRadius="0"
          HorizontalAlignment="Left"
          Width="20">
          <TextBlock 
            Name="Branch" 
            FontSize="14"
            FontWeight="Bold"
            VerticalAlignment="Center">
           <TextBlock.RenderTransform>
             <RotateTransform 
               Angle="-90"/>
           </TextBlock.RenderTransform>
            Branch
          </TextBlock>
        </Border> 
```

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2009-03-30T19:40:42.537

尝试使用[LayoutTransform](http://msdn.microsoft.com/en-us/library/system.windows.frameworkelement.layouttransform.aspx)

```
 <Border
      Name="BranchBorder"
      CornerRadius="0"
      HorizontalAlignment="Left"
      Width="20">
      <TextBlock
         Name="Branch"
         FontSize="14"
        FontWeight="Bold"
        VerticalAlignment="Center">
       <TextBlock.LayoutTransform>
         <RotateTransform
            Angle="-90"/>
       </TextBlock.LayoutTransform>
        Branch
      </TextBlock>
    </Border> 
```

有很多博客文章描述了[RenderTransform 和 LayoutTransform](http://www.google.com/search?q=Differences+LayoutTransform+RenderTransform)之间的区别，这里是 Charles Petzold [RenderTransformVersusLayoutTransform.xaml的一个很酷的可视化演示](http://www.charlespetzold.com/blog/2006/03/RenderTransformVersusLayoutTransform.xaml)

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-03-30T19:40:27.857

看起来好像文本在旋转变换有机会旋转它*之前*`<border>`继承了变换。这意味着文本首先被裁剪为 20 个单位宽，*然后*旋转 -90 度。

 **虽然我没有实际的解决方案，但我可以确认导致问题的转换顺序。

# java - 使用 SWT 进行快速像素绘图？

> ID：698620
> 
> 赞同：3
> 
> 时间：2009-03-30T19:07:09.653
> 
> 标签：java, canvas, swt, plot, pixel

我正在寻找一种快速简便的方法来在 SWT 画布中绘制任意颜色的像素。到目前为止，我正在使用类似的东西：

```
// initialization:
GC gc = new GC(canvas);

// inside the drawing loop:
Color cc = new Color(display, r, g, b);
gc.setForeground(cc);
gc.drawPoint(x, y);
cc.dispose(); 
```

这是非常可怕的缓慢。用像素填充 300x300 画布大约需要一秒半的时间。我可以在屏幕外创建一个图像，在其中设置像素，然后绘制图像。这会更快，但我特别想要在画布上逐像素绘制图像的渐变绘画效果。

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2009-03-30T20:16:04.263

我敢打赌，扼杀性能的是分配和释放 90,000 个`Color`对象。请记住，在 SWT 中，每个`Color`对象都分配本地资源，这就是您必须这样做的原因`dispose()`。这意味着每次分配和处置`Color`对象时，都必须从 JVM 转换到本机代码并返回。

`Color`您可以在 300x300 像素循环中缓存您的实例，然后在循环后处理对象吗？你需要一个有点智能的缓存，最多只能保存这么多对象，然后会处理它的一些条目，但这应该会**大大**加快速度。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-03-31T00:15:32.160

您可以绘制多个屏幕外图像，逐渐填充 300x300 区域。通过这种方式，您可以控制图像出现的速度。

* * *

## 回答 #3

> 赞同：-3
> 
> 时间：2011-12-20T13:14:17.777

创建一个 BufferedImage 对象：

```
BufferedImage bi = new new BufferedImage(300, 300, BufferedImage.TYPE_INT_RGB); 
```

在绘图循环内设置您的像素：

```
bi.setRGB(x, y, int_rgb);
... 
```

最后显示缓冲图像：

```
g.drawImage(bi, 0, 0, null); 
```

如果你发现 setRGB() 很慢，你可以直接访问位图数据：

```
int[] raster = ((DataBufferInt)bi.getRaster().getDataBuffer()).getData(); 
```

然后

```
raster[y * 300 + x] = int_rgb; 
```

# testing - 我为什么要写测试？

> ID：698626
> 
> 赞同：4
> 
> 时间：2009-03-30T19:08:35.797
> 
> 标签：testing

### 复制：

> [单元测试无用的项目类型](https://stackoverflow.com/questions/520830/type-of-projects-where-unit-testing-is-useless)
> [何时进行单元测试与手动测试](https://stackoverflow.com/questions/601438/when-to-unit-test-vs-manual-test)
> [单元测试值得付出努力吗？](https://stackoverflow.com/questions/67299/is-unit-testing-worth-the-effort)

我想知道为什么我应该为我自己已经手动测试过的东西编写测试。我不写 rspec 测试或类似的东西。为了测试，我会写一些东西然后转到浏览器并确保更改符合我的要求。我听说这种方法被描述为“错误驱动的开发”。

我现在写的应用程序通常范围和大小都很小。我是唯一的开发人员（通常），所以我不必担心将其他人的代码合并到我自己的测试中。

我可以看到需要使用数百种表单来测试大型应用程序。但是对于我自己开发的较小的应用程序，编写测试所花费的时间比自己填写信息要长得多。我听说很多开发人员提倡测试驱动开发，但我还没有“看到光明”。这似乎是一个好主意，但我无法证明编写测试（似乎）需要的工作量。

* * *

## 回答 #1

> 赞同：9
> 
> 时间：2009-03-30T19:10:32.813

一个词：回归。确保你不会破坏过去可以工作的东西是非常值得编写测试的。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2009-03-30T19:13:26.130

即使是小型应用程序，手动检查代码也可能非常耗时。请记住，即使您更改了应用程序的一部分，您仍然可以破坏另一部分。仅仅因为你改变了函数 E 就必须测试函数 A、B、C 和 D，这会让你在没有测试的情况下发疯。现在花少量时间编写测试代码，这样如果应用程序在某个时候增长或离开你的手，对每个人来说都会更容易。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2009-03-30T19:13:17.987

我也进行错误驱动开发，但测试仍然证明在 sql 查询、页面加载、路由和用户输入的情况下很有用。在 Web 开发的某些立场中，存在相当多的复制粘贴，您永远不知道自己会遇到什么错误。在考虑测试时，它总是比抱歉的方法更安全。

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2009-03-30T19:14:18.903

一开始，你不会在意是否编写测试。这会很烦人，让人分心，你只会放弃，直接写代码。然后从现在开始的 3 个月后，您将回去维护一些代码，进行一些小的更改，客户将开始致电询问功能 X 是如何破坏的。经过 3 天的代码挖掘，您会发现一些回归问题已修复，而在喝了几杯酒和一个小假期后，您又忘记了这个问题。

又过了一个月，需要进行一些其他的小修复，并且用户再次调用功能 X。这种情况发生在你身上四五次，最后你回头看，意识到你浪费了 3 天五次，希望你有你生活中的三个工作周回来构建有趣的东西。从那时起，您将至少编写一些单元测试，一边叹息一边希望您有更多时间。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2009-03-30T19:13:30.887

当你晋升到老板的职位时，下一个开发人员会和你一样勤奋吗？在修改代码后，他/她会知道要执行的适当手动测试吗？

# ms-access - MS 访问属性

> ID：698627
> 
> 赞同：7
> 
> 时间：2009-03-30T19:09:44.687
> 
> 标签：ms-access, vba

在哪里可以找到可用的 MS Access 属性的本机列表：

```
 CurrentDb.Properties("Property_Name_Here") 
```

例如，我知道；

*   AppTitle 可用于访问应用程序的标题
*   AppIcon 可用于访问用于应用程序的图标的路径

对于不同的版本，我确信有不同的属性。有按版本列出的吗？例如，MS Access 2003 具有这些属性……而 MS Access 2007 具有这些属性……等等。

* * *

## 回答 #1

> 赞同：10
> 
> 时间：2009-03-30T19:21:25.190

我不相信任何地方都有清单。寿，Properties 属性是一个集合。您可以遍历它们并获取所有关联的。您必须对您感兴趣的所有版本的 MS Access 执行此操作。为了进一步说明，几乎所有内部​​对象，例如表、字段、查询等，都具有属性。字段属性特别有用，因为您可以指定 MS Access 如何链接和向用户显示字段。

* * *

## 回答 #2

> 赞同：7
> 
> 时间：2009-03-30T19:38:52.900

有一个属性集合：

```
Sub ListProps()
    For i = 0 To CurrentDb.Properties.Count - 1
        Debug.Print CurrentDb.Properties(i).Name
    Next
End Sub 
```

* * *

## 回答 #3

> 赞同：3
> 
> 时间：2009-03-30T19:31:38.800

很难找到这样的信息。

我确实在[这里](http://msdn.microsoft.com/en-us/library/bb258165.aspx)找到了访问定义的 DAO 属性的链接

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2009-05-15T15:07:15.137

这样可以吗？:)

```
Option Compare Database
Option Explicit

Private Sub btnShowDbProps_Click()
On Error GoTo Err_btnShowDbProps_Click

  Dim prp As DAO.Property
  Dim dbs As Database
  Dim strProps As String

  Set dbs = CurrentDb

  For Each prp In dbs.Properties
    Dim propval As String
    propval = "<not defined>"

    On Error Resume Next
    propval = CStr(prp.value)

    If propval = vbNullString Then propval = "<empty>"

    strProps = strProps & prp.Name & "=" & propval & " (" & PropertyType(prp.Type) & ")" & vbNewLine
    Debug.Print strProps
  Next

  MsgBox strProps

Exit_btnShowDbProps_Click:
    Exit Sub

Err_btnShowDbProps_Click:
    MsgBox Err.Description
    Resume Exit_btnShowDbProps_Click

End Sub

Function PropertyType(intType As Integer) As String

   Select Case intType
      Case dbBoolean
         PropertyType = "dbBoolean"
      Case dbByte
         PropertyType = "dbByte"
      Case dbInteger
         PropertyType = "dbInteger"
      Case dbLong
         PropertyType = "dbLong"
      Case dbCurrency
         PropertyType = "dbCurrency"
      Case dbSingle
         PropertyType = "dbSingle"
      Case dbDouble
         PropertyType = "dbDouble"
      Case dbDate
         PropertyType = "dbDate"
      Case dbText
         PropertyType = "dbText"
      Case dbLongBinary
         PropertyType = "dbLongBinary"
      Case dbMemo
         PropertyType = "dbMemo"
      Case dbGUID
         PropertyType = "dbGUID"
      Case Else
         PropertyType = "Unknown:" & intType
   End Select

End Function 
```

# java - 为什么 ConcurrentHashMap 会阻止 null 键和值？

> ID：698638
> 
> 赞同：154
> 
> 时间：2009-03-30T19:12:10.297
> 
> 标签：java, concurrenthashmap

的 JavaDoc 是[`ConcurrentHashMap`](http://java.sun.com/javase/6/docs/api/java/util/concurrent/ConcurrentHashMap.html)这样说的：

> 与 类似`Hashtable`但不同`HashMap`的是，此类*不允许*用作`null`键或值。

我的问题：为什么？

第二个问题：为什么`Hashtable`不允许null？

我使用了很多 HashMaps 来存储数据。但是当更改为`ConcurrentHashMap`NullPointerExceptions 时，我遇到了几次麻烦。

* * *

## 回答 #1

> 赞同：234
> 
> 时间：2012-02-15T17:23:02.020

[来自`ConcurrentHashMap`他自己的作者（Doug Lea）](http://cs.oswego.edu/pipermail/concurrency-interest/2006-May/002485.html)：

> ConcurrentMaps (ConcurrentHashMaps, ConcurrentSkipListMaps) 中不允许使用空值的主要原因是无法容纳在非并发映射中几乎无法容忍的歧义。主要的是，如果`map.get(key)`返回`null`，您无法检测键是否显式映射到`null`与键未映射。在非并发映射中，您可以通过 进行检查 `map.contains(key)`，但在并发映射中，映射可能在调用之间发生了变化。

* * *

## 回答 #2

> 赞同：51
> 
> 时间：2011-01-21T13:26:16.760

我相信，至少在一定程度上，它允许您合并`containsKey`并`get`成为一个单一的呼叫。如果映射可以包含空值，则无法判断是否`get`返回空值是因为该值没有键，或者只是因为该值是空值。

为什么这是个问题？因为自己没有安全的方法来做到这一点。采取以下代码：

```
if (m.containsKey(k)) {
   return m.get(k);
} else {
   throw new KeyNotPresentException();
} 
```

由于`m`是一个并发映射，键 k 可能会在`containsKey`and`get`调用之间被删除，导致此代码段返回一个从未在表中出现的空值，而不是所需的`KeyNotPresentException`.

通常你会通过同步来解决这个问题，但是使用并发地图当然不会工作。因此，必须更改 for 的签名`get`，并且以向后兼容的方式做到这一点的唯一方法是防止用户首先插入空值，并继续将其用作“未找到密钥”的占位符。

* * *

## 回答 #3

> 赞同：4
> 
> 时间：2009-03-30T20:01:28.993

乔什·布洛赫设计`HashMap`；道格李设计`ConcurrentHashMap`。我希望这不是诽谤。实际上我认为问题在于空值通常需要包装，以便真正的空值可以代表未初始化。如果客户端代码需要空值，那么它可以支付（诚然很小的）包装空值本身的成本。

* * *

## 回答 #4

> 赞同：3
> 
> 时间：2009-03-30T19:18:16.180

您无法在 null 上进行同步。

编辑：这并不是在这种情况下的确切原因。我最初认为锁定事物以防止并发更新或以其他方式使用对象监视器来检测是否修改了某些东西，但在检查[源代码](http://gee.cs.oswego.edu/dl/classes/EDU/oswego/cs/dl/util/concurrent/ConcurrentHashMap.java)时似乎我错了 - 他们使用基于“段”的“段”锁定哈希的位掩码。

在那种情况下，我怀疑他们这样做是为了复制 Hashtable，我怀疑 Hashtable 这样做是因为在关系数据库世界中，null != null，所以使用 null 作为键没有任何意义。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2009-03-30T19:17:01.393

ConcurrentHashMap 是线程安全的。我相信不允许空键和值是确保它是线程安全的一部分。

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2009-03-30T19:29:01.707

我想 API 文档的以下片段给出了一个很好的提示：“在依赖线程安全但不依赖同步细节的程序中，此类与 Hashtable 完全可互操作。”

`ConcurrentHashMap`他们可能只是想让`Hashtable`. 而且 as`Hashtable`不允许空键和值..

* * *

## 回答 #7

> 赞同：-3
> 
> 时间：2019-01-08T09:43:05.213

我不认为不允许空值是一个正确的选择。在许多情况下，我们确实希望将具有空值的键放入并发映射中。但是，通过使用 ConcurrentHashMap，我们无法做到这一点。我建议即将到来的 JDK 版本可以支持这一点。

# nhibernate - NHibernate：根据父级将同一类映射到多个表

> ID：698651
> 
> 赞同：2
> 
> 时间：2009-03-30T19:18:14.777
> 
> 标签：nhibernate, fluent-nhibernate

我有一个模型，其中多个类都有一个值类型列表：

```
class Foo { public List<ValType> Vals; }
class Bar { public List<ValType> Vals; } 
```

Foo 和 Bar 除了它们都包含这些 val 之外是无关的。ValTypes 的添加、删除等规则对于每个类都不同。我想将此设计保留在我的代码中。

例如，有时我想将一些 Vals 从 Foo 复制到 Bar。在数据库中，每个 ValType 都有自己的表，以保持它小而轻（它只有父 ID + 2 个字段），并允许完整性检查。我知道 NHibernate 说我应该让我的对象像数据库一样细化，但这只会让我的代码更丑陋。

到目前为止，我想到的最好的方法是为 ValType 创建单独的子类，每个父类一个。然后我可以在那个级别映射那些。然后，我将连接添加和删除逻辑以在正确的子类之间自动转换，并将它们实际存储在具有正确子类类型的私有列表中。但这似乎有点令人费解。

我如何在 NHibernate 中映射它（如果可能的话，流利的 NHibernate）？

请让我知道这是否是重复的——我不太确定如何搜索它。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2009-03-30T19:47:55.703

在数据库级别，解决方案是：

```
Val(Id)
Bar(Id)
BarToVal(IdBar, IdVal)
FooToVal(IdFoo, IdVal) 
```

我不太确定这些将如何映射。也许是这样的：

```
// BarMap:  
HasManyToMany(x => x.Vals).WithTableName("BarToVal");

// FooMap:  
HasManyToMany(x => x.Vals).WithTableName("FooToVal"); 
```

希望这是有道理的...

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2009-04-21T13:16:47.687

[您可以在Google 代码页面上找到 Fluent NHibernate](http://code.google.com/p/fluent-nhibernate/wiki/Examples)的示例。

**模型**

```
public class Customer
{
    public string Name { get; set; }
    public string Address { get; set; }
} 
```

**架构**

```
table Customer (
    Id int primary key
    Name varchar(100)
)

table CustomerAddress (
    CustomerID int,
    Address varchar(100)
) 
```

**映射**

```
public class CustomerMap : ClassMap<Customer>
{
    public CustomerMap()
    {
        Id(x => x.Id);
        Map(x => x.Name);

        WithTable("CustomerAddress", m =>
        {
            m.Map(x => x.Address);
        });
    }
} 
```

在此示例中，一个实体在数据库中的两个表中拆分。这些表通过键上的一对一连接。使用 WithTable 功能，您可以告诉 NHibernate 将这两个表视为一个实体。

# c++ - 如何对 NON-.NET 应用程序/DLL 的内存使用进行分类？

> ID：698655
> 
> 赞同：1
> 
> 时间：2009-03-30T19:21:04.723
> 
> 标签：c++, memory, memory-management, heap-memory

我有一个 32 位 Visual Studio 8.0 C++ Windows DLL（非 .NET），它占用的内存似乎比我预期的要多。我想确切地确定内存的去向，而不仅仅是使用的总内存的一个数字（对任务管理器或资源监视器的内存使用值不感兴趣）。回到 16 位时代，HeapWalker 非常有用，您甚至可以选择一个 BITMAP 句柄并查看它的图形内容。我试图记住如何阅读 .MAP 文件并将各个部分相加，但文档很少，我不确定这种技术有多准确。有人有什么建议吗？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-03-30T19:44:23.590

如果需要查找 DLL 各个部分的大小，可以使用 dumpbin.exe。它是用于检查 DLL 和可执行文件的命令行工具。确保在尝试运行之前运行 vcvars32.bat。

要查看 DLL 的实际内存消耗，我建议从 umdh.exe 开始。它作为来自 Microsoft 的 windbg 的一部分提供。只要您使用 pdb 构建文件，它将能够解析应用程序中的符号。然后，您可以拍摄一些内存快照以查找泄漏。您还可以对所有分配进行完整转储，以查看分配了内存的位置以及分配了多少内存。

# sql - 计数 DIFFDATE 超过指定值 - 步骤 2

> ID：698673
> 
> 赞同：0
> 
> 时间：2009-03-30T19:27:32.507
> 
> 标签：sql

进一步回答我之前的问题。现在我有两个不同的查询。第一个查询返回 5092 的结果，第二个返回 1885 的结果加起来为 6977。我想将它们组合成一个查询以返回 6977 的结果。如何让一个查询计算条件评估日期的数量有效、逾期超过 14 天且为空（算作逾期）？提前致谢。

```
select count (*)
from task_conditionassessment t
    inner join taskitems_conditionassessment ti on
        t.task_conditionassessmentguid=ti.task_conditionassessmentguid  
    inner join conditionassessmentassignmentitem c on
        ti.taskitems_conditionassessmentid=c.taskitems_conditionassessmentid
where datediff(dd,c.conditionassessmentdate,t.nextduedate)>14 and t.isactive=1

select t.taskname,t.nextduedate,c.conditionassessmentdate
from task_conditionassessment t
    inner join taskitems_conditionassessment ti on
        t.task_conditionassessmentguid=ti.task_conditionassessmentguid
    inner join conditionassessmentassignmentitem c on
        ti.taskitems_conditionassessmentid=c.taskitems_conditionassessmentid
where c.conditionassessmentdate IS NULL and t.isactive=1 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-03-30T19:32:29.327

如果您只想要符合任一组标准的记录计数，只需`or`在您的`where`子句中使用：

```
select count (*)
from task_conditionassessment t
inner join taskitems_conditionassessment ti on
    t.task_conditionassessmentguid=ti.task_conditionassessmentguid  
inner join conditionassessmentassignmentitem c on
    ti.taskitems_conditionassessmentid=c.taskitems_conditionassessmentid
where (c.conditionassessmentdate IS NULL or
       datediff(dd,c.conditionassessmentdate,t.nextduedate)>14) and
      t.isactive=1 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-03-30T19:31:50.890

如果我理解正确，只需`OR`将两个条件放在一起：

```
select count (*)
from task_conditionassessment t
    inner join taskitems_conditionassessment ti on t.task_conditionassessmentguid=ti.task_conditionassessmentguid
    inner join conditionassessmentassignmentitem c on ti.taskitems_conditionassessmentid=c.taskitems_conditionassessmentid
where (datediff(dd,c.conditionassessmentdate,t.nextduedate)>14
        or c.conditionassessmentdate IS NULL)
    and t.isactive=1 
```

# c# - C#中的套接字问题

> ID：698692
> 
> 赞同：2
> 
> 时间：2009-03-30T19:34:52.287
> 
> 标签：c#, sockets

```
Socket socket = new Socket(ipe.AddressFamily, SocketType.Stream, ProtocolType.Tcp);
...
socket.SetSocketOption(SocketOptionLevel.Socket, SocketOptionName.ReceiveTimeout, 1000);
...
socket.Send(bytesSent, bytesSent.Length, 0);
...
bytes = socket.Receive(bytesReceived, bytesReceived.Length, 0); 
```

socket发送数据后，服务器没有响应，程序等待响应。如何在 1000 毫秒后停止接收数据？Ы

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-03-30T19:38:20.327

在调用 socket.Receive(...) 之前设置此属性。来自[MSDN](http://msdn.microsoft.com/en-us/library/system.net.sockets.socket.receivetimeout.aspx)

```
socket.ReceiveTimeout = 1000; 
```

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2010-03-17T10:21:19.870

```
Socket socket = new Socket(AddressFamily.InterNetwork, SocketType.Stream, ProtocolType.Tcp);
socket.RecieveTimeout = 1000;
socket.SendTimeout = 1000;

// Not needed
// socket.SetSocketOption(SocketOptionLevel.Socket, SocketOptionName.ReceiveTimeout, 1000);

IPAddress ipAddress = IPAddress.Parse("192.168.2.2");
int port = 9000;

try
{
    // could take 15 - 30 seconds to timeout, without using threading, there
    // seems to be no way to change this
    socket.Connect(ipAddress, port);

    // Thanks to send timeout this will now timeout after a second
    socket.Send(bytesSent, bytesSent.Length, 0);

    // This should now timeout after a second
    bytes = socket.Receive(bytesReceived, bytesReceived.Length, 0);
}
finally
{
    socket.Close();
} 
```

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2013-10-24T09:11:36.140

您可以使用**[Socket.Poll()](http://msdn.microsoft.com/en-us/library/system.net.sockets.socket.poll.aspx)** ，而不是依赖**Socket.ReceiveTimeout**来完成这项工作。使用**ReceiveTimeout**会在发生超时时抛出异常，而**Poll()**不会。您现在将能够以更优雅的方式处理超时。

 ****```
var received = -1;
var receiveBuffer = new byte[_receiveBufferSize];

// The poll will timeout after 5 seconds (Defined in microseconds)
var canRead = _socket.Poll(5000000, SelectMode.SelectRead);
if(canRead)
    received = _socket.Receive(receiveBuffer);

if (received > 0)
{
    // Parse the buffer
}
else
{
    // Do other stuff
} 
```

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2009-03-30T19:55:53.767

According to [this MS article](http://msdn.microsoft.com/en-us/library/26f591ax.aspx), you need to call Accept before Receive and Connect before Send.

# java - How do I build a HTML table from Glazed List?

> ID：698699
> 
> 赞同：3
> 
> 时间：2009-03-30T19:36:47.227
> 
> 标签：java, collections, html-table, glazedlists

Lat week I downloaded the Glazed List library into eclipse. I have been looking through the tutorials and it seems that everything is designed to run jTable or SWT. I am need a backing list(Map, table, whatever) for simple HTML tables that can be sortable. I have been doing this by rolling my own classes to create HTML tables from either Lists or Maps(Very Large Lists and Maps). No scripting allowed.

Is Glazed List overkill for what I am wanting to do? If there is a way, could someone point me in the right direction, perhaps a example or a tutorial.

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-03-31T06:41:13.590

I think it is not exactly the right tool for the job. GlazedLists was created to support mostly Swing or SWT based UIs. You can get it to work well as a backing model for the HTML table on the server side, but you would have to create the rendering code yourself.

In this URL you can see that the documentation mentions that it can be used with swing or SWT out of the box, but no HTML mentioned:

[http://sites.google.com/site/glazedlists/propaganda/features#TOC-Swing-or-SWT](http://sites.google.com/site/glazedlists/propaganda/features#TOC-Swing-or-SWT)

All said, however, it does make a good backing model. Creating the rendering code might not be so hard.

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-05-14T06:22:58.340

We had a volunteer for an [official GWT port](http://www.nabble.com/GlazedList-GWT-td23002550.html), but it's not available yet. In an unrelated effort, there's an EventList in the [gwt-stuff project](http://code.google.com/p/gwt-stuff/wiki/GwtStuffEventList), but I haven't investigated it.

# ruby-on-rails - 在 Rails 中转义 HTML

> ID：698700
> 
> 赞同：25
> 
> 时间：2009-03-30T19:36:51.830
> 
> 标签：ruby-on-rails, xss

什么是转义 HTML 以防止 Rails 应用程序中的 XSS 漏洞的推荐方法是什么？

您是否应该允许用户将任何文本放入数据库但在显示时对其进行转义？您是否应该添加 before_save 过滤器来转义输入？

* * *

## 回答 #1

> 赞同：24
> 
> 时间：2009-03-31T16:16:24.503

解决这个问题有三种基本方法。

1.  `h()`在您的意见中使用。这里的缺点是，如果你忘记了，你会得到 pwnd。
2.  使用保存时转义内容的插件。我的插件[xss_terminate](http://github.com/look/xss_terminate/tree/master)就是这样做的。然后你不必`h()`在你的视图中使用（大部分）。还有其他在控制器级别上工作。这里的缺点是（a）如果转义代码中存在错误，您可能会在数据库中获得 XSS；和 (b) 在某些极端情况下您仍想使用`h()`.
3.  使用在显示内容时转义内容的插件。[CrossSiteSniper](http://xss.rubyforge.org/)可能是其中最著名的。这会为您的属性设置别名，以便当您调用 foo.name 时，它​​会转义内容。如果您需要未转义的内容，有一种解决方法。我喜欢这个插件，但我并不热衷于让 XSS 首先进入我的数据库......

然后是一些混合方法。

没有理由不能同时使用 xss_terminate 和 CrossSiteSniper。

还有一个名为[Erubis](http://www.kuwata-lab.com/erubis/)的 ERb 实现，可以对其进行配置，以便任何类似的调用都`<%= foo.name %>`被转义——相当于`<%= h(foo.name) %>`. 不幸的是，Erubis 似乎总是落后于 Rails，因此使用它会减慢您的速度。

If you want to read more, I wrote a blog post (which Xavor kindly linked to) about [using xss_terminate](http://railspikes.com/2008/1/28/auto-escaping-html-with-rails).

* * *

## 回答 #2

> 赞同：14
> 
> 时间：2009-03-30T23:09:36.607

**h**是[html_escape](http://railsapi.com/doc/v2.3.2/classes/ERB/Util.html#M000143)的别名，它是一种用于转义所有 HTML 标记字符的实用方法：

```
html_escape('<script src=http://ha.ckers.org/xss.js></script>')
# => &lt;script src=http://ha.ckers.org/xss.js&gt;&lt;/script&gt; 
```

如果您需要更多控制，请使用[sanitize](http://apidock.com/rails/ActionView/Helpers/SanitizeHelper/sanitize)方法，该方法可用作标签和属性的白名单以允许：

```
sanitize(@article.body, :tags => %w(table tr td), :attributes => %w(id class style)) 
```

我将允许用户输入任何内容，将其按原样存储在数据库中，并在显示时转义。这样您就不会丢失输入的任何信息。您以后可以随时调整转义逻辑...

* * *

## 回答 #3

> 赞同：5
> 
> 时间：2009-03-30T19:41:37.717

在视图模板中使用 h 方法。假设您有一个带有评论属性的 post 对象：

```
<div class="comment">
    <%= h post.comment %>
</div> 
```

* * *

## 回答 #4

> 赞同：2
> 
> 时间：2009-03-30T20:18:03.463

或者使用这个插件 - 不需要 h 8)

[http://railspikes.com/2008/1/28/auto-escaping-html-with-rails](http://railspikes.com/2008/1/28/auto-escaping-html-with-rails)

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2009-10-15T07:24:13.913

I've just released a plugin called [ActsAsSanitiled](http://github.com/dasil003/acts_as_sanitiled) using the [Sanitize](http://wonko.com/post/sanitize) gem which can guarantee well-formedness as well being very configurable to what kind of HTML is allowed, all without munging user input or requiring anything to be remembered at the template level.

# php - 跨多个 PHP 页面传输 MySQL 数据库链接

> ID：698701
> 
> 赞同：2
> 
> 时间：2009-03-30T19:37:04.043
> 
> 标签：php, mysql, database-link

在多个 PHP 页面之间传输和/或共享资源链接是否有任何技巧？我不希望服务器继续连接到数据库只是为了获得另一个链接到同一个数据库中的同一个用户。

请记住，从 mysql_connect() 返回的链接在它源自的脚本完成执行后会自动关闭。无论如何在每个会话结束时手动关闭它吗？

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2009-03-30T19:40:24.800

PHP 允许持久的 mysql 连接，但[也有缺点](http://www.php.net/manual/en/function.mysql-pconnect.php#85670)。最重要的是，空闲的 apache 孩子最终会坐在那里，保持空闲的数据库连接处于打开状态。数据库连接会占用大量内存，因此您真的只希望它们在实际使用时打开。

如果您的用户每分钟打开一个页面，那么在您不使用它的每一分钟中关闭数据库连接 59 秒，并在需要时重新打开它，而不是持续打开它。

相反，您可能应该研究连接池。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-03-30T19:58:37.660

One of the advantages of Mysql over other heavier-weight database servers is that connections are cheap and quick to setup.

If you are concerned about large numbers of connections to retrieve the save information, you may like to look at such things as caching of information instead, or as well as getting the information from disk. As usual, profiling of the number, and type of calls to SQL that are being made, will tell you are great deal more than anyone here guessing at what you should really be doing next.

# email - 接受电子邮件作为应用程序输入的指南

> ID：698702
> 
> 赞同：7
> 
> 时间：2009-03-30T19:37:09.630
> 
> 标签：email, web-applications

许多应用程序具有允许用户响应来自应用程序的通知电子邮件的便利功能。响应被吞回应用程序。

例如，如果您正在构建客户支持系统，则电子邮件可能包含一些令牌，以将响应链接回正确的服务票证。

实施此类系统有哪些指导方针、提示和技巧？有哪些潜在的陷阱需要注意？希望那些实施过这样的系统的人可以分享他们的智慧。

* * *

## 回答 #1

> 赞同：10
> 
> 时间：2009-04-06T17:21:33.980

一些指导方针和注意事项：

地址问题：最好的办法是使用电子邮件 (myaddr**+custom**@gmail.com) 地址的“+”扩展部分。这使得路由更容易，但最重要的是，更容易跟踪到系统的地址路由。其他技术可能会在主题中使用标记

**垃圾邮件**：在应用程序之外进行垃圾邮件处理，并让应用程序根据标题进行过滤。

**排队失败的消息**：在大多数情况下，不要。标准的电子邮件行为是尝试最多 3 天来传递消息。对于应用程序电子邮件服务器，所有这些都是创建您很可能永远不会处理的巨大邮件假脱机文件。仅当故障原因超出您的控制范围（例如，服务器已关闭）时才将消息排队。

**无效消息处理**：消息无效的方式有多种。有些是库的限制（它无法解析地址，即使它是 RFC 有效的地址）。其他原因是由于客户端损坏（例如，省略了某些标题周围的引号）。其他的可能太大，或者使用未知的编码，缺少关键的标头，有多个值，应该只有一个，违反某些特定于您的应用程序的语义，等等等等。基本上，Java 邮件 API*可以*在任何地方抛出异常是一种错误处理情况，您**必须**确定如何适当地处理。

**错误响应**：并非每个错误都值得响应。有些是由于垃圾邮件而产生的，您应该避免将邮件发送回这些地址。其他来自自动化系统（您自己、假期响应者、另一个应用程序邮件系统等），如果您回复，它会向您发送另一条消息，重复循环。

**特定于客户端的技巧**：就像上面一样，每个客户端几乎没有什么不同，这会使您的代码复杂化。每当您遍历消息的结构时，请记住这一点。

**发件人、回复和循环**：根据您的情况，您可能会收到来自以下某些来源的邮件：

*   真实的人，可能来自外部来源
*   邮件列表
*   您自己或您自己的收件人地址之一
*   其他邮件服务器（退回、失败等）
*   另一个系统中的实体（my-ldap-group@company.com、system-monitor@localhost）
*   自动化系统
*   上述之一的别名
*   别名的别名

现在，您的第一直觉可能是“只接受来自正确来源的邮件！”，但这会让您头疼不已，因为人们会将最该死的东西发送到应用程序邮件服务器。我发现接受一切并明确否认例外情况会更好。

**调试**：保存您收到的任何消息的标头副本。每当您遇到问题时，这将极大地帮助您。

- 编辑 -

我买了 rossfabricant 提到的书 Building Scalable Web Sites。它-确实-有一个很好的电子邮件部分。它有几个重要的点是关于处理来自无线运营商的电子邮件和电子邮件的身份验证。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2009-03-30T19:50:47.163

您可以设置发送电子邮件的地址，如果有人只是按“回复”，将把什么放入“收件人：”地址。让它独一无二，你就可以知道它来自哪里，以及它必须被引导回哪里。

当谈到在它旁边放一个名字时，尽管“这里有东西” - 放一些邀请他们回复邮件的东西。我见过一个主要的网络应用程序，它带有“不回复”的电子邮件捕获功能，这使人们无法实际向其发送任何内容。

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2009-04-06T16:19:56.217

[构建可扩展的网站](https://rads.stackoverflow.com/amzn/click/com/0596102356)有一个很好的部分关于处理电子邮件。它是由 Flickr 开发人员编写的。

[![替代文字](https://i.stack.imgur.com/75uBg.jpg)](https://i.stack.imgur.com/75uBg.jpg)
[（来源：[lsl.com.au](http://www.lsl.com.au/images/images-ref/building-scalable-website.jpg)）]

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2009-03-30T19:52:15.303

编辑：我误解了你的问题。

您可以将您的电子邮件服务器配置为包罗万象，并生成一个唯一的回复地址。例如 CST-2343434@example.com。

服务器上的轮询过程可以读取收件箱并从收到的电子邮件中解析出相关部分，CS-2343434 可能意味着客户支持票证 ID 号。2343434。

我使用[JavaMail API](http://java.sun.com/products/javamail/)实现了类似的东西。

只是一个想法。

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2009-04-13T14:47:30.473

实现这一点的最佳方法是编写一个窗口服务，其作用类似于邮件客户端 [pop3 或 imap]。此 Windows 服务应执行由计时器触发的定时操作，该计时器连接到邮件服务器并轮询服务器以查找电子邮件收件箱中可用的任何未读消息。要检查的电子邮件 ID 是用户将输入/发送到的电子邮件 ID。如果 Windows 服务客户端发现存在任何新邮件，则应下载并过滤电子邮件正文，并根据电子邮件中的用户输入进一步推送以进行处理。您可以在同一个 Windows 服务中托管输入处理，但不建议这样做。Windows 服务可以将输入放在一个特殊的应用程序目录或数据库中，您的主应用程序可以从中读取电子邮件中收到的用户输入并根据需要处理它们。

为此，您需要开发一个高性能 TCP/IP 客户端。由于性能问题，我建议您不要使用默认的 .Net 库，而是使用 .Net 的最佳可用开源 TCP/IP 实现之一，例如 kodart 的[XF.Server](http://www.kodart.com)。我们在我们的应用程序中使用了它并取得了非常好的结果。

希望这可以帮助..

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2009-04-06T16:26:41.660

Bose 有一个非常棒的系统，他们将队列和票证 ID 嵌入到电子邮件本身中。

我的公司在主题行上有传统的案例#，但是在创建案例时，需要在主题行上使用特定的字符串“新案例”“技术支持问题”来通过垃圾邮件过滤器。

如果电子邮件与创建或更新语义不匹配，自动回复器会向收件人发送一封电子邮件，说明如何正确发送电子邮件，或将他们引导至我们的论坛或 Web 支持站点。

它有助于消除垃圾邮件问题，但仍然可供仍然严重依赖电子邮件的广大技术受众访问。

* * *

## 回答 #7

> 赞同：0
> 
> 时间：2009-04-06T16:37:24.537

垃圾邮件将成为一个问题。但是，由于您正在发起对话，因此您可以使用唯一标识符的存在（我更喜欢使用主题行 - “故障单：无法登录网络...[artf123456]”）来过滤垃圾邮件。请务必偶尔检查过滤器，因为有些人在回复时会破坏主题。

* * *

## 回答 #8

> 赞同：0
> 
> 时间：2009-04-13T13:40:59.977

电子邮件是糟糕标准和坏客户的污水池。你需要准备好接受几乎任何东西作为输入。您需要非常宽容地容忍哪些类型的输入。任何对你来说容易编程的东西都可能很难让你的用户正确使用。考虑要求您在主题行中发出命令的旧邮件列表程序。只有铁杆书呆子才能有效地使用它们。而你提到的一些问题单 CRM 的东西有一些奇怪的要求，比如强制用户在文本中的两个特定文本标记之间进行回复。这样的事情让人们感到困惑。

您需要处理向您发送格式化文本而不是纯文本的电子邮件客户端。一些电子邮件客户端仍然不能正确处理 HTML（*咳嗽*GMail），因此您的回复也需要适当设计。也有多种方式可以通过电子邮件“上传”照片，尤其是在涉及手机的情况下。您将需要实施各种技巧和启发式方法来处理这些情况。

您也完全有可能收到有效但您正在使用的电子邮件解析库无法使用的电子邮件。这是否重要到足以让您自己动手将是一个判断电话。

最后，其他人提到使用特定的电子邮件地址来唯一标识“对话”。这可能是执行此操作的最简单方法，因为邮件的内容通常无法在与客户的往返行程中保存下来。但是，请准备好从老客户那里收到旧 ID 的邮件，他们不会以某种方式打开新票，而是回复旧票。您的应用程序可能需要一些方法来手动或自动将具有旧 ID 的电子邮件推送到新案例中。对于 CRM 系统，即使您已经向他发送了一封带有新 ID 的新电子邮件，用户也很可能会回复旧电子邮件。至于您应该使用 some.email.address+some.id@yourdomain.com 还是只使用 some.id@yourdomain.com，我会选择后者，因为加号会使一些电子邮件客户端感到困惑。制作你的 ID 指南或其他东西，并有一些方法来验证它们（例如 CRC 或其他东西），你会得到更少的垃圾。人类永远不必输入 GUID，只需回复它们即可。缺点是垃圾邮件过滤：用户的计算机可能会将此类电子邮件地址视为垃圾邮件，并且没有简单的方法将这些地址列入白名单。

这提醒了我：这些天发送电子邮件充满了陷阱。有许多反垃圾邮件技术使您很难向客户发送电子邮件。您将需要研究所有这些，并且需要小心并进行一些测试，以确保您可以联系到主要的电子邮件提供商。 如果您要发送电子邮件，像[Campaign Monitor这样的网站可以为您提供帮助。](http://www.campaignmonitor.com/)

# c# - 如何在以下代码中找到嵌套的 Asp:GridView？

> ID：698705
> 
> 赞同：0
> 
> 时间：2009-03-30T19:37:38.503
> 
> 标签：c#, asp.net, gridview

我在 aspx 页面中有以下结构：

```
<asp:Panel ID="pnlCust" runat="server">
    <asp:GridView ID="gvMaster" runat="server" 
                  OnRowCreated="gvMaster_RowCreated">
        <Columns>
            <asp:TemplateField>
                <ItemTemplate>
                    <asp:Panel ID="pnlMaster" runat="server">
                        //...
                    </asp:Panel>
                    <asp:Panel ID="pnlDetails" runat="server">
                        <asp:GridView ID="gvDetails" runat="server">
                            <Columns>
                                //...
                            </Columns>
                        </asp:GridView>
                    </asp:Panel>
                </ItemTemplate>
            </asp:TemplateField>
        </Columns>
    </asp:GridView>
</asp:Panel> 
```

这些面板用于 Ajax Control Toolkit 中的 CollapsiblePanelExtender。

我正在尝试使用 FindControl 在代码隐藏中查找 gvDetails 控件，但我最近的尝试没有奏效，它在 gvMaster_RowCreated 事件中：

```
GridView gv =  
e.Row.FindControl("pnlDetails").FindControl("gvDetails") as GridView; 
```

其中 e 是 GridViewRowEventArgs

我基本上是在做这个页面上的事情，但我没有使用 SqlDataSource，但是，这个人基本上是通过 FindControl 从 RowCreated 事件传入的 e 参数中找到 SqlDataSource。链接在这里：

[http://mosesofegypt.net/post/2008/02/Building-a-grouping-Grid-with-GridView-and-ASPNET-AJAX-toolkit-CollapsiblePanel.aspx](http://mosesofegypt.net/post/2008/02/Building-a-grouping-Grid-with-GridView-and-ASPNET-AJAX-toolkit-CollapsiblePanel.aspx)

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-03-30T19:49:07.167

我不相信 GridView 可以有这样的子控件。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-03-30T21:25:28.357

这是一个对我有用的方法背后的代码：

```
protected void gvMaster_RowCreated(object sender, GridViewRowEventArgs e)
{
    if (e.Row.RowType == DataControlRowType.DataRow) {
        GridView gv = (GridView)e.Row.FindControl("gvDetails");
    }
} 
```

您的应用程序是否抛出异常？什么工作不正常？

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-03-30T20:15:01.207

您需要将面板放在模板字段中。你可以尝试这样的事情：

```
<asp:Panel ID="pnlCust" runat="server"> 
    <asp:GridView ID="gvMaster" runat="server" >
        <columns>
            <asp:TemplateField>
                <ItemTemplate>
                    <asp:Panel ID="pnlDetails" runat="server">
                        <asp:GridView ID="gvDtails" runat="server">
                            <columns>
                                <asp:TemplateField>
                                    <ItemTemplate>
                                        <%-- columns here --%>
                                    </ItemTemplate>
                                </asp:TemplateField>
                            </columns>
                        </asp:GridView> <%-- end gvDetails --%>
                    </asp:Panel> <%-- end pnlDetails--%>
                </ItemTemplate>
            </asp:TemplateField>
        </columns>
    </asp:GridView> <%-- end gvMaster --%>
</asp:Panel> <%-- end pnlCust --%> 
```

# python - Python tkinter 标签在函数开始时不会改变

> ID：698707
> 
> 赞同：3
> 
> 时间：2009-03-30T19:38:01.390
> 
> 标签：python, function, label, tkinter, statusbar

我正在使用 tkinter 和 Python 为将 Excel 文件转换为 CSV 的程序创建用户界面。

我创建了一个标签来充当状态栏，并将 statusBarText 设置为 StringVar() 作为文本变量。inputFileEntry 和 outputFileEntry 是包含输入和输出文件路径的文本变量。

```
def convertButtonClick():
    statusBarText.set('Converting...')

    if inputFileEntry.get() == '' or outputFileEntry.get() == '':
        statusBarText.set('Invalid Parameters.')
        return

    retcode = subprocess.('Program.exe' ,shell=true)

    if retcode == 0:
        statusBarText.set('Conversion Successful!')
    else:
        statusBarText.set('Conversion Failed!') 
```

当您单击转换按钮时，此函数会被调用，并且一切正常，除了状态栏永远不会更改为“正在转换...”。

如果输入或输出为空，状态栏文本将更改为无效参数，并根据返回码更改为成功或失败。问题是它永远不会更改为“正在转换...”

我已经将该确切的行复制并粘贴到 if 语句中，它工作正常，但由于某种原因，它在子进程位于函数顶部时运行之前永远不会改变。任何帮助将不胜感激。

* * *

## 回答 #1

> 赞同：11
> 
> 时间：2009-03-30T21:16:58.173

由于您在单个方法调用中完成所有这些操作，因此在您启动子进程之前，GUI 永远不会有机会更新。查看 update_idletasks() 调用...

来自[http://infohost.nmt.edu/tcc/help/pubs/tkinter/universal.html](http://infohost.nmt.edu/tcc/help/pubs/tkinter/universal.html)

**`w.update_idletasks()`** 一些更新显示的任务，例如调整大小和重绘小部件，被称为空闲任务，因为它们通常被推迟到应用程序完成事件处理并返回主循环以等待新事件。
如果您想在应用程序下一次空闲之前强制更新显示，请在任何小部件上调用 w.update_idletasks() 方法。

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2009-03-30T21:14:34.840

你是如何创建你的标签的？我有这个小测试设置：

```
from Tkinter import *
class LabelTest:

    def __init__(self, master):
        self.test = StringVar()

        self.button = Button(master, text="Change Label", command=self.change)
        self.button.grid(row=0, column=0, sticky=W)

        self.test.set("spam")
        self.testlabel = Label(master, textvariable = self.test).grid(row = 0,column = 1)
    def change(self):

        self.test.set("eggs")

root = Tk()
root.title("Label tester")
calc = LabelTest(root)

root.mainloop() 
```

它有效。您确定使用“textvariable = StatusBarText”而不是“text=StatusBarText.get()”吗？

# http - 让 URL 的一部分成为参数的那个东西的名称是什么？

> ID：698711
> 
> 赞同：1
> 
> 时间：2009-03-30T19:39:11.467
> 
> 标签：http, url-rewriting

例如：

```
http://stackoverflow.com/questions/698627/ms-access-properties 
```

该数字是 URL 的一部分，但它是 Web 应用程序的参数，而不是其他选项，例如：

```
http://www.google.com/firefox?client=firefox-a&rls=org.mozilla:en-US:official 
```

所有 args 都在 ' `?`' 之后。*我以前用过第二种形式，我只是想了解第一种形式。*

我敢肯定，一旦我知道那叫什么，我就能找到我还需要的东西，这样我就可以谷歌了。

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2009-03-30T19:40:12.257

[URL重写](http://en.wikipedia.org/wiki/URL_rewriting)，一般。

编辑：这是对 URL 重写[的一个很好的介绍。](http://www.addedbytes.com/apache/url-rewriting-for-beginners/)

* * *

## 回答 #2

> 赞同：5
> 
> 时间：2009-03-30T19:41:17.530

Variables passed in the form of a URL are called the [Query String](http://en.wikipedia.org/wiki/Query_string). In a url like:

```
 http://examples.com?a=b&c=d&e=f 
```

The query string is ?a=b&c=d&e=f

In the Stackoverflow example, it uses URL Rewriting, specifically with [MVC Routing](http://weblogs.asp.net/scottgu/archive/2007/12/03/asp-net-mvc-framework-part-2-url-routing.aspx) to make 'pretty URLs'. There are other ways to do it in other languages. Some make use of Apache's [mod_rewrite](http://httpd.apache.org/docs/1.3/mod/mod_rewrite.html) ([example](http://www.workingwith.me.uk/articles/scripting/mod_rewrite)) while others parse the requested URI. In PHP a url like

```
 http://example.com/index.php/test/path/info 
```

can be parsed by reading $_SERVER['PATH_INFO'] which is /text/path/info.

Generally, they are using URL Rewriting to simulate the query string however. In the Stackoverflow example:

```
 http://stackoverflow.com/questions/698711/what-is-the-name-for-that-thing-that-lets-part-of-the-url-be-an-argument 
```

The important parts are the **questions/698711**. You can change the title of the question with impunity but the other two parts you cannot.

* * *

## 回答 #3

> 赞同：3
> 
> 时间：2009-03-30T19:40:36.923

It's usually called the 'path info'.

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2009-03-30T19:40:34.613

That's just URL mapping. It lets you use pretty URLs instead of a large query string.

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2009-03-30T19:40:48.730

I believe the StackOverflow URL works that way because it is using MVC whereas your bottom example is using standard requests.

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2009-03-30T19:44:09.627

It is indeed done by URL rewriting.

Usually, web application frameworks do this automatically if you install it correctly on your server.

Check out [CakePHP](http://www.cakephp.org) as an example.

* * *

## 回答 #7

> 赞同：0
> 
> 时间：2009-03-30T19:45:02.153

It's called a URL parameter and uses the [HTTP GET method](http://en.wikipedia.org/wiki/Hypertext_Transfer_Protocol). As others mentioned, it can be rewritten using URL rewriting so that the URL is easier to read and use. Some search keywords: "SEF URLs", "Apache Rewrite", "pretty URLs".

# security - Excel 2007 的 VBA 宏可以关闭的所有地方在哪里？

> ID：698720
> 
> 赞同：2
> 
> 时间：2009-03-30T19:40:44.083
> 
> 标签：security, excel, excel-2007, windows-server-2003, vba

宏拒绝在 Windows Server 2003 上的 Excel 2007 中为我运行。功能区上的宏和 Visual Basic 图标显示为灰色。如果我打开带有宏的工作簿，我会收到警告：“此工作簿已丢失其 VBA 项目、ActiveX 控件和任何其他与可编程性相关的功能。” 如果我尝试在 VSTO 中创建新的 excel 模板（当时 Excel 已关闭），我会收到错误消息：“无法启用对 Microsoft Office Visual Basic for Applications 项目系统的编程访问......”

我检查了是否安装了 VBA（最初没有，我通过办公室设置添加了它）。我还尝试卸载并重新安装office和VBA，没有骰子。我制作了一个启用宏的工作簿。我将工作簿的位置设置为受信任。我将 Excel 选项/信任中心下可用的所有安全设置配置为允许一切无提示。我设置了“启用所有宏”和“信任对 VBA 对象模型的访问”。我下载了组策略管理模板，并验证这些都不是通过组策略设置的。

这就是我可以在 Google 中找到的所有尝试，但显然还有另一个地方可以关闭 VBA。我还能在哪里看？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2009-04-03T06:23:15.177

您确定没有禁止 VBA 的系统策略吗？

编辑：一些阅读，如果你还没有看过这些：

[http://support.microsoft.com/kb/282847/en-us](http://support.microsoft.com/kb/282847/en-us)

[http://support.microsoft.com/kb/287567](http://support.microsoft.com/kb/287567)

[http://support.microsoft.com/kb/281954/en-us](http://support.microsoft.com/kb/281954/en-us) - 适用于早期版本，但部分/全部可能仍与 2k7 相关

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-07-06T18:53:45.070

excel中的Alt+F11，看看里面有没有可以修改的选项....

# java - 序列生成的 Id 上的 firePropertyChange

> ID：698732
> 
> 赞同：0
> 
> 时间：2009-03-30T19:43:59.300
> 
> 标签：java, swing, jpa, persistence

当调用 persist 时，永远不会调用 setId 方法，这反过来会导致 firePropertyChange 不执行。我需要触发 changeSupport 方法，因为我的功能取决于我的实体状态。

```
public void setId(Long id) {
    Long oldId = this.id;
    this.id = id;
    changeSupport.firePropertyChange("id", oldId, id);
} 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2009-03-30T20:37:26.100

这很可能是因为您注释了 id 字段而不是 setter 或 getter。

至少 Hibernate 将使用它作为使用直接字段访问而不是 setter 的指示符。

# c# - Web 服务动态调用程序问题

> ID：698738
> 
> 赞同：3
> 
> 时间：2009-03-30T19:45:54.087
> 
> 标签：c#, web-services, binding, proxy

我一直在使用 Web 服务上的属性，并且我已经看到 SoapHttpClientProtocol 类需要定义一个 WebServiceBinding 属性。

看着这个[问题](https://stackoverflow.com/questions/417275/-net-attributes-why-does-getcustomattributes-make-a-new-attribute-instance-eve)，似乎无法在运行时修改属性，如何实现在运行时更改此属性的动态 Web 服务调用？是否可以？

[编辑] 我正在寻找一种方法来执行动态调用“通用样式”，而不是修改 WebServiceBinding 属性。

简而言之，这是我的课：

```
using System.Web.Services;
using System.Web.Services.Protocols;

namespace Whatever {
    [WebServiceBinding(Name = "", Namespace = "")]
    public class WebServiceInvoker : SoapHttpClientProtocol {
        public WebServiceInvoker(string url, string ns, string bindingName) {

            ChangeNamespace(ns);
            ChangeBinding(bindingName);
            Url = url;
            // credentials, etc
    }
        public void ChangeNamespace(string ns) {
            var att = GetType().GetCustomAttributes(typeof (WebServiceBindingAttribute), true);         
            if (att.Length > 0) {
                // doesn't work
                ((WebServiceBindingAttribute)att[0]).Namespace = ns;
            }
        }
        private void ChangeBinding(string bindingName) {
            var att = GetType().GetCustomAttributes(typeof(WebServiceBindingAttribute), true);

            if (att.Length > 0) {
                // doesn't work
                ((WebServiceBindingAttribute)att[0]).Name = bindingName;
            }
        }
        public object[] MakeInvoke(string method, object[] args) {
            var res = Invoke(method, method);
            return res;
        }

        public TRet InvokeFunction<TRet>(string method) {
            //Funcion<T1, T2, T3, TRet>
            var res = Invoke(method, null);
            return MyUtils.ForceCast<TRet>(res);
        }
        public TRet InvokeFunction<T1, TRet>(string method, T1 par1) {
            //Funcion<T1, T2, T3, TRet>
            var args = new object[] { par1 };
            var res = Invoke(method, args);
            return MyUtils.ForceCast<TRet>(res);
        }
        public TRet InvokeFunction<T1, T2, TRet>(string method, T1 par1, T2 par2) {
            //Funcion<T1, T2, T3, TRet>
            var args = new object[] { par1, par2 };
            var res = Invoke(method, args);
            return MyUtils.ForceCast<TRet>(res);
        }
        public TRet InvokeFunction<T1, T2, T3, TRet>(string method, T1 par1, T2 par2, T3 par3) {
            //Funcion<T1, T2, T3, TRet>
            var args = new object[] {par1, par2, par3};
            var res = Invoke(method, args);
            return MyUtils.ForceCast<TRet>(res);
        }

        public void InvokeAction(string metodo) {
            //Funcion<T1, T2, T3, TRet>
            Invoke(method, null);
        }
        public void InvokeAction<T1>(string method, T1 par1) {
            //Funcion<T1, T2, T3, TRet>
            var args = new object[] { par1 };
            Invoke(method, args);
        }
        public void InvokeAction<T1, T2>(string method, T1 par1, T2 par2) {
            //Funcion<T1, T2, T3, TRet>
            var args = new object[] { par1, par2 };
            Invoke(method, args);
        }
        public void InvokeAction<T1, T2, T3>(string method, T1 par1, T2 par2, T3 par3) {
            //Funcion<T1, T2, T3, TRet>
            var args = new object[] { par1, par2, par3 };
            Invoke(method, args);
        }
    }
} 
```

[编辑] 我想这样称呼我的班级：

```
var miProxy = new WebServiceInvoker("http://webServiceLocation", "ns", "Binding");
var res = miProxy.InvokeFunction<string, string, Entity>("MyWebMethod", stringPar1, stringPar2); 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-03-30T19:54:34.220

您不能在运行时更改属性。它们只是 IL 代码中的元数据，如果您查询属性，则会创建并返回指定属性类的实例。因此，在您查询它们之前，实际的属性实例并不存在。

可能可以使用反射来修改程序集，但我不确定，这可能不是您喜欢尝试的事情。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2009-04-11T02:03:14.647

[Crows Programming](http://www.crowsprogramming.com/archives/66)还有另一个很好的例子。它描述了一个类，允许您在任何 Web 服务上调用任意消息。它实际上非常光滑。希望能帮助到你。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2009-03-30T19:58:21.420

我不确定您在这里要完成什么...您是否正在尝试创建一个支持调用者调用任意方法的 Web 服务？如果是这样，下面是一个实践示例：[创建动态 Web 服务以简化代码](http://www.techrepublic.com/article/applied-reflection-creating-a-dynamic-web-service-to-simplify-code/)

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2009-03-30T20:06:07.110

正如您所说，您不能在运行时修改属性。

在运行时实现添加/删除/更改属性效果的唯一方法是创建一个包装实际类型的新类型。但是，运行时代理类有开销（开发复杂性和性能），并且在生产代码中很少值得。

但是，我会调查该陈述的正确性：

> SoapHttpClientProtocol 类需要定义一个 WebServiceBinding 属性。

Microsoft 通常会为您提供至少两种剥猫皮的方法。我敢打赌，以上内容并非绝对正确。可能还有另一种方法可以完成您正在尝试做的事情。

我想说的是：您*可能*会通过追求运行时属性路线来寻找错误的树。

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2011-06-30T16:31:51.560

你试过这个

[http://techmentis.blogspot.com/2011/05/dynamic-web-service-invoker.html](http://techmentis.blogspot.com/2011/05/dynamic-web-service-invoker.html)

# c - 为什么在声明具有可变大小的 C 数组时没有出现编译错误？

> ID：698739
> 
> 赞同：6
> 
> 时间：2009-03-30T19:46:01.527
> 
> 标签：c, arrays

我的理解一直是，当我在堆栈上声明一个大小作为变量或参数传入的数组时，我应该得到一个错误。

但是，我注意到如果我没有显式初始化数组，我不会收到任何错误（是的，它不会在堆栈上，但我想知道是否没有错误）。例如，以下代码因为 array2 而无法编译：

```
#define N 30

void defineArrays(int n)
{
    int i,j;
    int array1[N] = {};

    int array2[n] = {};

    for(i=0; i<N; ++i) array1[i] = 0;

    for(j=0; j<n; ++j) array2[j] = 0;
} 
```

但是即使我从 main 发送了一个真实的 n，以下代码也会编译并运行：

```
#define N 30

void defineArrays(int n)
{
    int i,j;
    int array1[N] = {};

    int array2[n];

    for(i=0; i<N; ++i) array1[i] = 0;

    for(j=0; j<n; ++j) array2[j] = 0;
} 
```

我在这里缺少什么？是否将array2 声明为指针？我正在使用 gcc

**更新：感谢所有回答的人。问题确实是我的 gcc 版本出于某种奇怪的原因默认为 C99（或者不是那么奇怪，也许我太老了），并且我错误地认为它默认为 C90，除非我另有说明。**

* * *

## 回答 #1

> 赞同：14
> 
> 时间：2009-03-30T19:50:12.390

C99 引入了拥有可变长度数组的功能，该功能现在在 GCC 中可用（尽管据报道它不完全符合标准）。在第二个示例中，您似乎正在利用该功能。

链接到 GCC 关于可变长度数组的信息：http: [//gcc.gnu.org/onlinedocs/gcc/Variable-Length.html](http://gcc.gnu.org/onlinedocs/gcc/Variable-Length.html)

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2009-03-30T19:51:17.503

我认为你需要选择你的C标准版本。

```
gcc -fsyntax-only -std=c89 -pedantic -x c -

<stdin>: In function ‘defineArrays’:
<stdin>:6: warning: ISO C forbids empty initializer braces
<stdin>:8: warning: ISO C90 forbids variable length array ‘array2’ 
```

对比

```
gcc -fsyntax-only -std=c99 -pedantic -x c -
<stdin>: In function ‘defineArrays’:
<stdin>:6: warning: ISO C forbids empty initializer braces 
```

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2009-03-30T19:51:21.217

使用初始化器声明数组会强制数组是静态的（在编译时创建），即使范围在函数内。编译器无法在编译时定义数组，因为它不知道“n”的值。

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2009-03-30T19:51:21.530

当我用 gcc 编译第一个示例时，它给了我这个错误：

```
error: variable-sized object may not be initialized 
```

我想这是不允许的，因为您不知道`n`会有多大，因此您无法确定它是否足够大以容纳您尝试初始化的所有元素。也就是说，假设你有这样的代码：

```
int array2[n] = { 1, 2, 3, 4 }; 
```

这要求 array2 有（至少）4 个插槽。如果`n`传入为零怎么办？

第二个示例没有这个问题，因为您没有对 array2 的大小进行任何隐式声明。

希望有帮助，

埃里克·梅尔斯基

# .net - Sys.WebForms.PageRequestManagerServerErrorException: An unknown error

> ID：698740
> 
> 赞同：3
> 
> 时间：2009-03-30T19:46:32.680
> 
> 标签：.net, webforms

I have created a text area that allows users to enter html code. When I attempt to post this code back to the server, I get a popup window that says "Sys.WebForms.PageRequestManagerServerErrorException: An unknown error occured while processing the request on the server. The status code returned from the server was: 500".

I believe this has something to do with the fact that what I am posting back contains html.

How do I do this safely and without causing this error message?

Thanks!

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2010-03-05T17:03:59.440

不幸的是，这是一个非常普遍的错误，似乎是由许多事情引起的，从应用程序回收、损坏的 cookie、RoleManager 等等。

以供参考：

*   [http://forums.asp.net/p/1046935/1576341.aspx#1576341](http://forums.asp.net/p/1046935/1576341.aspx#1576341)
*   [http://forums.asp.net/p/1069384/1555817.aspx](http://forums.asp.net/p/1069384/1555817.aspx)

我*强烈*建议不要关闭验证，这并不能解决问题，它只是隐藏了症状，它为 XSS 敞开了大门。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-04-17T02:41:30.587

您可以在页面上使用 validateRequest="false"，然后使用 Server.HtmlEncode 和 Server.HtmlDecode 验证您需要确保数据安全的字段。

# jquery - ASP.NET MVC 将多个参数从 getJson 传递到控制器

> ID：698741
> 
> 赞同：4
> 
> 时间：2009-03-30T19:46:46.110
> 
> 标签：jquery, asp.net-mvc, json, asp.net-mvc-routing

我正在使用 getJson 方法在 javascript 中调用控制器操作。我需要将两个参数传递给控制器​​上的操作方法，但我正在努力这样做。我不完全了解路由表，并且不确定这是否是我需要使用它才能使其正常工作。请参阅下面的示例，了解我正在尝试做的事情。

```
var action = "<%=Url.Content('~/Postcode/GetAddressResults/')%>" + $get("Premise").value + "/" + $get("SearchPostcode").value
$.getJSON(action, null, function(data) {
  $("#AddressDropDown").fillSelect(data);
}); 
```

这是我的路线，我不明白如何利用......

```
routes.MapRoute(
 "postcode",
 "Postcode/GetAddressResults/{premise}/{postcode}",
 new {
  controller = "Motor", action = "GetAddressResults",
    premise = "", postcode = ""
 }); 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-03-31T03:01:09.670

您肯定走在正确的道路上，尽管我需要查看您的控制器才能确定。它需要看起来像这样：

```
public ActionResult GetAddressResults(string premise, string postcode)
{
  //Do something.
  return Json(AddressService.GetResultsOfSomeKind(premise, postcode);
} 
```

在您的 ActionResult 上设置一个断点，以便您知道它正在被调用。如果不是，请使用 Firefox 并检查错误控制台是否有语法错误（您发布的代码有一些）。

更新：

什么是

```
$get("Premise").value? 
```

要通过 jQuery 获取输入值，请使用：

```
$("#fieldid").val(); 
```

我推荐使用 Firefox 的 Firebug 插件。这样你就可以确切地知道你的 javascript 是在什么时候被破坏的。您很可能会发现在 $.getJSON 调用向您的控制器发送请求之前，您的“var action =”语句没有正确地在客户端附加表单字段值。

# c - 引用 C 中的二维数组列？

> ID：698745
> 
> 赞同：4
> 
> 时间：2009-03-30T19:47:58.293
> 
> 标签：c, arrays

有没有一种简单的方法可以将二维数组中的列作为*普通旧 C*（不是 C++ 或 C#）中的单独一维数组来引用？连续这样做很容易。假设我有 2 个功能：

```
double doSomethingWithARow( double theRow[3] );
double doSomethingWithACol( double theCol[100] ); 
```

然后，我可能会像这样使用第一个：

```
double matrix[100][3];
double result;

// pass a single row to a function as an array
// this essentially passes the 3-element array at row 48 to the function
for( int i=0; i < 100; i++ )
{
   result = doSomethingWithARow( matrix[i] );
} 
```

我想要一种轻松访问列的方法。

```
for( int j=0; j < 3; j++ )
{
   result = doSomethingWithACol( ??????????? );
} 
```

到目前为止，我唯一想到的就是转换矩阵以将行与列交换。但是这段代码应该在内存和速度方面尽可能高效。使用 C 中引用指针的所有复杂方法，似乎应该有一种方法可以做到这一点。

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2009-03-30T19:53:58.810

好吧，您必须传递行的大小和行数：

```
 double doSomethingWithACol(double *matrix, size_t colID, size_t rowSize, size_t nRows); 
```

现在您可以利用 matrix[i][j] = matrix + i * rowSize + j; 的事实。

*或者*，您也可以使用以下签名：

```
 double doSomethingWithACol(double *colPtr, size_t rowSize, size_t nRows); 
```

在这里，您必须将指针传递给要处理的列的第一个元素，而不是指向第一行的指针。

* * *

**示例代码：**此代码对第二列中的元素求和（使用*gcc -o main -Wall -Wextra -pedantic -std=c99 test.c*编译）：

```
#include <stdio.h>
#include <stdlib.h>

double colSum1(double *matrix, size_t colID, size_t rowSize, size_t nRows)
{
  double *c = NULL, *end = matrix + colID + (nRows * rowSize);
  double sum = 0;

  for (c = matrix + colID; c < end; c += rowSize) {
    sum += *c;
  }

  return sum;
}

double colSum2(double *colPtr, size_t rowSize, size_t nRows)
{
  double *end = colPtr + (nRows * rowSize);
  double sum = 0;

  for (; colPtr < end; colPtr += rowSize) {
    sum += *colPtr;
  }

  return sum;
}

int
main(void)
{
  double matrix[4][3] = {
    {0,  1, 2},
    {3,  4, 5},
    {6,  7, 8},
    {9, 10, 11}
  };

  printf("%f\n", colSum1(*matrix, 1, 3, 4));
  printf("%f\n", colSum2(&matrix[0][1], 3, 4));
  printf("%f\n", colSum2(matrix[0] + 1, 3, 4));

  return EXIT_SUCCESS;
} 
```

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2009-03-30T19:56:52.467

在不将尺寸指定为单独参数的情况下执行此操作的一种不错的类型安全方法如下：

```
#define ROWS 100
#define COLUMNS 30 

void doSomethingToAllRows(double (*row)[ROWS][COLUMNS], int col, double val)
{
    for(size_t i = 0; i < ROWS; ++i)
        (*row)[i][col] = val;
}

void doSomethingToAllColumns(double (*col)[ROWS][COLUMNS], int row, double val)
{
    for(size_t i = 0; i < COLUMNS; ++i)
        (*col)[row][i] = val;
}

int main(int argc, char **argv)
{
    double matrix[ROWS][COLUMNS];

    /* Modify each column of the 10th row with the value of 3 */
    doSomethingToAllColumns(&matrix, 10, 3); 

    /* Modify each row of the 10th column with the value of 3 */
    doSomethingToAllRows(&matrix, 10, 3);

    return 0;
} 
```

由于这个原因，传递双 ** 是完全错误的：

```
void test()
{
  double **a;
  int i1 = sizeof(a[0]);//i1 == 4 == sizeof(double*)

  double matrix[ROWS][COLUMNS];
  int i2 = sizeof(matrix[0]);//i2 == 240 == COLUMNS * sizeof(double)
} 
```

如果你传入一个双 ** 然后像数组一样访问它，你会导致崩溃、段错误或未定义的行为。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-03-30T19:52:30.233

由于您所称的“列”不连续地存储在内存中，因此没有真正的方法可以直接将其关闭。

但是，您可以创建一个指针数组，并将对另一个数组索引的引用存储在该数组中。您需要遍历数组中的所有元素，因此它可能不是比任何其他解决方案更好的解决方案。不过，根据您需要按列访问数组的频率，这可能是值得的。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2009-03-30T19:55:45.903

你不能真正做到这一点，因为 C 中的数组是这样存储的，每行的元素都存储在一起。这意味着数组的一行是一个连续的内存块，就 C 而言，它本身也可能是一个独立的数组。它与列的工作方式不同，因为列的元素在内存中不连续；相反，它们以字节为间隔`N`，其中每一行都是`N`字节长。这意味着您可以通过使用指针算法有效地访问 2D 数组的列的各种*元素*，但是除了将元素复制到新数组中之外，没有办法将列实际变成数组本身。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2009-03-30T19:55:58.570

不，没有。不可能，因为在 C 中，数组是内存的连续部分，行*和*列不能同时连续是微不足道的。

话虽如此，如果您知道行的长度，从一列的一个单元格跳到下一个单元格是相当容易的。举个例子：

```
void processColumn(double *array, int colIdx, int rowLen, int rowCnt) {
    for (int i = colIdx; i < rowCnt * rowLen; i += rowLen) {
       // do whatever you want
    }
}

#define N 5
#define M 10

double array[N*M];

processColumn(array, 3, N, M); 
```

# ruby-on-rails - 在 Rails 中提交时在参数中查找上传

> ID：698751
> 
> 赞同：0
> 
> 时间：2009-03-30T19:50:17.897
> 
> 标签：ruby-on-rails, http, syntax, file-upload

我试图找出这些参数中的哪些包含上传的文件。此代码有效

```
 params[:upload].each do | uploaded_image |
    if (uploaded_image[1] != "")
      # do something with uploaded_image[1];
    end
  end 
```

但是我通过参数移动的方式（例如使用 [1]）似乎是错误的。这样做的正确方法是什么？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-03-30T20:02:12.953

您将使用该 do 循环一次获取一张图像，因此您无需对数组进行索引。

像这样：

```
 params[:upload].each do | uploaded_image |
    unless uploaded_image.blank?
      # do something with uploaded_image[1];
    end
  end 
```

。空白的？将覆盖 nil 或空

# macos - 使用 rsync 仅复制隐藏文件

> ID：698764
> 
> 赞同：10
> 
> 时间：2009-03-30T19:52:47.080
> 
> 标签：macos, rsync

我想使用 rsync 备份我的 homedir 中的所有隐藏文件和目录，而不是非隐藏文件和目录。

例如，给定这个目录列表：

```
drwxr-xr-x   7 sophie  sophie  238 31 Mar 08:45 .
drwxr-xr-x  15 sophie  sophie  510 31 Mar 08:14 ..
-rw-r--r--   1 sophie  sophie    4 31 Mar 08:12 .foo
drwxr-xr-x   3 sophie  sophie  102 31 Mar 08:45 .hiddendir
drwxr-xr-x   4 sophie  sophie  136 31 Mar 08:13 VisibleDirectory
-rw-r--r--   1 sophie  sophie    9 31 Mar 08:13 VisibleFile 
```

我想备份 .foo、.hiddendir 和 .hiddendir 的所有内容，无论它们是否隐藏。我不想备份 VisibleDirectory 或 VisibleFile。

我想出的所有咒语都备份了“。”，因此它的所有内容包括 VisibleFile 和 VisibleDirectory，我不知道如何排除它。请帮忙！

我正在使用 Mac OS X 10.5.6 (Leopard) 和 rsync 版本 2.6.9 协议版本 29。

* * *

## 回答 #1

> 赞同：12
> 
> 时间：2009-03-30T20:04:39.970

它通常是“.??*”以确保您不复制“。” 和 ”..”

（如果你有一个只是 ".a" 的文件呢？）

* * *

## 回答 #2

> 赞同：12
> 
> 时间：2009-03-30T21:17:15.363

匹配隐藏项目的常见模式是`.[^.]*`

```
rsync -a ~/.[^.]* /path/to/backup 
```

这会复制以单个点开头的所有文件。请注意，它不包括以多个点开头的文件。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-03-30T19:58:45.660

你试过像./.*这样的化身吗？

您能否将隐藏文件复制到临时目录，备份临时目录，然后将其删除？

# qt - Can font size be disabled in QFontDialog::getFont()?

> ID：698767
> 
> 赞同：0
> 
> 时间：2009-03-30T19:54:22.397
> 
> 标签：qt, fonts

I want to allow users to pick a font but the size they choose will have no effect. So it would be best to have that part of the dialog disabled. Is this possible?

Thank you!

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-03-30T19:57:48.427

Think twice before you try to do this. Character sizes aren't always the same for different fonts - what looks just right in one font might be too small in another, and too large in yet another.

# c# - 如何从 winform 控件生成位图？

> ID：698773
> 
> 赞同：5
> 
> 时间：2009-03-30T19:55:34.810
> 
> 标签：c#, .net-3.5, bitmap

如何使用 C# 在 winform 上生成控件的位图？

* * *

## 回答 #1

> 赞同：11
> 
> 时间：2009-03-30T19:59:25.987

您可以尝试[Control.DrawToBitmap()](http://msdn.microsoft.com/en-us/library/system.windows.forms.control.drawtobitmap.aspx)。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-03-30T19:59:05.583

也许这可以帮助：[http ://www.syncfusion.com/FAQ/windowsforms/faq_c3c.aspx#q870q](http://www.syncfusion.com/FAQ/windowsforms/faq_c3c.aspx#q870q)

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-03-30T19:59:57.467

使用 Control.DrawToBitmap [MSDN](http://msdn.microsoft.com/en-us/library/system.windows.forms.control.drawtobitmap.aspx)

# c# - 打印属性名称（不是您想的那样）

> ID：698789
> 
> 赞同：5
> 
> 时间：2009-03-30T19:59:05.473
> 
> 标签：c#

这是一个粗略的问题，我无法完全回答。

主程序

```
class Program{
    static void Main(string[] args){
        Console.WriteLine("Begin");
        var myClass = new MyClass();
        Util.Print(myClass.Id);
        Util.Print(myClass.Server);
        Util.Print(myClass.Ping);
        Console.WriteLine("End");
    }   
} 
```

如何实现 Util.Print 方法以将此输出到控制台：

```
Begin
Id
Server
Ping
End 
```

* * *

## 回答 #1

> 赞同：14
> 
> 时间：2009-03-30T20:03:40.953

假设您不想使用字符串，最常见的答案是通过`Expression`- 基本上模拟缺失的`infoof`; 你将不得不使用类似的东西：

```
 Console.WriteLine("Begin");
    var myClass = new MyClass();
    Util.Print(() => myClass.Id);
    Util.Print(() => myClass.Server);
    Util.Print(() => myClass.Ping);
    Console.WriteLine("End"); 
```

假设它们都是属性/字段（**编辑**添加的方法调用支持）：

```
 public static class Util
{
    public static void Print<T>(Expression<Func<T>> expr)
    {
        WriteExpression(expr);
    }
    public static void Print(Expression<Action> expr) // for "void" methods
    {
        WriteExpression(expr);
    }
    private static void WriteExpression(Expression expr)
    {
        LambdaExpression lambda = (LambdaExpression)expr;
        switch (lambda.Body.NodeType)
        {
            case ExpressionType.MemberAccess:
                Console.WriteLine(((MemberExpression)lambda.Body)
                    .Member.Name);
                break;
            case ExpressionType.Call:
                Console.WriteLine(((MethodCallExpression)lambda.Body)
                    .Method.Name);
                break;
            default:
                throw new NotSupportedException();
        }
    }
} 
```

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2009-03-30T20:05:39.640

除了 Marc 的回答：[这里有一篇文章](http://abdullin.com/journal/2008/12/13/how-to-find-out-variable-or-parameter-name-in-c.html)解释了几种方法来做你想做的事情（其中一种方法使用表达式）。

* * *

## 回答 #3

> 赞同：-1
> 
> 时间：2009-03-30T20:06:34.583

```
public string Id {
    get {
      return "Id;"
    }
} 
```

呵呵，嗯，尽管我认为这不是您的意思:-(答案可能与反思有关。

看看[http://msdn.microsoft.com/en-us/library/ms173183(VS.80).aspx](http://msdn.microsoft.com/en-us/library/ms173183(VS.80).aspx)

# .net - 如何向 .NET 应用程序添加安全 FTP 功能

> ID：698794
> 
> 赞同：5
> 
> 时间：2009-03-30T20:00:15.313
> 
> 标签：.net, asp.net-mvc, ftp, sftp

我正在将内部客户端-服务器应用程序重写为 .NET MVC 应用程序。它需要通过安全的 FTP 发送和接收文件。最初的应用程序是客户端-服务器，并使用 MOVEit Freely 进行 SFTP。有没有我可以在 .NET 中使用的库或产品？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-03-30T20:02:04.360

[http://www.enterprisedt.com/products/edtftpnet/overview.html](http://www.enterprisedt.com/products/edtftpnet/overview.html)

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2009-03-30T20:03:38.893

只需使用内置的[FtpWebRequest](http://msdn.microsoft.com/en-us/library/system.net.ftpwebrequest.aspx)和[FtpWebResponse](http://msdn.microsoft.com/en-us/library/system.net.ftpwebresponse.aspx)类。

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2009-03-31T15:25:48.600

看看[SharpSSH](http://sourceforge.net/projects/sharpssh/)，我知道他们支持sftp，不知道写服务器端会有多难。

* * *

## 回答 #4

> 赞同：2
> 
> 时间：2009-05-28T07:32:17.113

我们的[Rebex 文件传输包](http://www.rebex.net/file-transfer-pack/)支持安全 FTP 的两种变体 - SFTP 和 FTPS (FTP/SSL)。

* * *

## 回答 #5

> 赞同：2
> 
> 时间：2010-10-18T20:37:48.987

If you don't want to pay anything, you can easily use the built-in [FtpWebRequest](http://msdn.microsoft.com/en-us/library/system.net.ftpwebrequest.aspx) for vanilla FTP and FTPES (explicit FTP with SSL). For FTPS (implicit FTP+SSL), I recommend [Alex FTPS Client](http://ftps.codeplex.com/). And finally, for SFTP (FTP over SSH), you can use [SharpSSH](http://www.tamirgal.com/blog/category/SharpSSH.aspx). This method isn't for everyone - it's really just for the cheap skate. But, I've been using this combo for all my data transfer needs in a production environment and it works great. The products are stale, but the protocols are stable, so who cares.

* * *

## 回答 #6

> 赞同：1
> 
> 时间：2009-05-27T10:36:37.537

看看[edtFTPnet/PRO](http://www.enterprisedt.com/products/edtftpnetpro/overview.html)，它为 .NET 中的 SFTP 提供了全面支持。

您可能还想看看[CompleteFTP](http://www.enterprisedt.com/products/completeftp/overview.html)，它是一个用于 Windows 平台的快速、紧凑的 SFTP 服务器（它还支持 FTP 和 FTPS）。

我可能会补充说，使用术语“安全 FTP”可能会让人感到困惑。它可能意味着 SFTP，它是一种通过 SSH 运行的安全文件传输协议。或者它可能意味着 FTPS，它基本上是通过 SSL 连接运行的标准 FTP 命令。

* * *

## 回答 #7

> 赞同：0
> 
> 时间：2009-03-30T20:03:50.470

这是 .NET 中的本机。您想要的类位于 System.Net 命名空间中。看看 FtpWebRequest 和 FtpWebResponse 类。快乐编码:)

* * *

## 回答 #8

> 赞同：0
> 
> 时间：2011-06-21T02:55:52.093

I was involved in creating MOVEit Freely. It never had support for SFTP over SSH - it only had support for FTP/S. Its original role was to be a "drop-in" command-for-command replacement of Microsoft's FTP.exe client - with extra support for SSL/TLS.

MOVEit Freely was originally built on top of a Dundas FTP/S stack, but we heavily modifed the original source code as FTP/S evolved. (We got in a bit early.) These days Dundas is focused on Dashboard components and the license agreement we signed with Dundas said that we'd never publish a standalone FTP/S component based on their code. (That's standard for that kind of OEM license.) In other words, I'd check out one of the Windows-based recommendations above. (I recommend components from \n software, and also like the Rebex offering on Windows.)

# math - Math question: How know section number on a list

> ID：698801
> 
> 赞同：1
> 
> 时间：2009-03-30T20:00:49.197
> 
> 标签：math

Imagine I have this list, that is divided by 3

```
1
2
3
4
5
6
7
8
9 
```

Now, I have 9 items, grouped in 3 sections.

My question is how know in which section is 6 (ie: 6 belong to section 2, 2 to section 1, 9 to section 3)

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2009-03-30T20:04:08.533

嗯……`section = ((item-1) / 3) + 1`

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2009-03-30T20:03:30.533

`section = ceiling (n / 3)`

例如，

`ceiling (4 / 3) = ceiling ( 1.33 ) = 2`

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2009-03-30T22:26:53.107

对于划分为 size`n`部分的项目列表，项目的部分`s`由`i`下式给出：

```
s = (i + (n-1)) / n, 
```

其中`/`是整数除法。

因此，对于您的示例，第 6 项给出了`(6 + (3-1))/3 = (6+2)/3 = 8/3 = 2`.

这也适用于许多其他事情 - 我遇到它是“我需要在每个节点的`n`CPU 的集群上请求多少个节点？”

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2009-03-30T20:04:45.727

我不完全确定你在问什么，但试试这个：

```
floor((itemNumber - 1)/numberOfGroups) + 1 
```

# mysql - InnoDb 有时会工作，但有时不工作

> ID：698807
> 
> 赞同：1
> 
> 时间：2009-03-30T20:02:30.630
> 
> 标签：mysql, innodb

我正在交换数据库以重写我的程序，其中一部分是编写转换脚本和创建新表的脚本。

我正在重命名表、更改索引并通常以某种方式更改大部分表，其中一部分是我正在从 MyISAM 更改为 InnoDB 表。

转换脚本完美无缺，但创建新表的脚本在特定点失败。

```
Query:
create table team_resources
(
     amount double not null default 0,
     resource int unsigned not null default 0,
     team int unsigned not null default 0,
     primary key (resource,team)
) ENGINE = InnoDB 
```

我收到[错误 121](http://forums.mysql.com/read.php?22,33999,33999)，这是无法创建表时给出的错误。该脚本是从 Python 文件运行的，但我在我的 SQL 程序和 phpMyAdmin 中的原始脚本和表向导帮助程序表单中都遇到了相同的错误。

这些表都转换为 InnoDB 很好，所以我很难理解为什么它在创建新表时会出现问题。如果我取出 InnoDB 部分，则此查询有效。

有什么建议么？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-03-30T20:05:22.667

我可以在 MySQL 5.0.32 安装上运行该语句。这可能是一个已修复的错误。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-03-30T20:09:54.183

[错误 26507](http://bugs.mysql.com/bug.php?id=26507)对此有所了解。看起来创建/删除表不是很原子。

一种选择是执行 mysqldump 并尝试加载到新安装的数据库中。

[另一种处理此问题的方法在Bug 17546](http://bugs.mysql.com/bug.php?id=17546)的末尾进行了描述，但您应该验证问题出在 frm 文件上。

# javascript - 更快的填充方式使用 Javascript，我在表单上有两个 <select> 框。在第一个 <select> 框中选择一个项目将确定第二个 <select> 中应该出现的内容（使用 Ajax http_request）。在某些情况下，第二个选择中可能有 500 个（猜测）大项目，并且在 IE 中更新需要 5-10 秒的时间。Firefox 似乎运行良好。我想知道是否有更快的方法来实现这一点。当前，服务器创建一个字符串将其传递给客户端，然后将其分解并通过创

> ID：698817
> 
> 赞同：15
> 
> 时间：2009-03-30T20:04:46.723
> 
> 标签：javascript, ajax, internet-explorer, performance, html-select

* * *

## 回答 #1

> 赞同：20
> 
> 时间：2009-03-30T22:54:40.420

500 个元素并不是很多，即使对于 IE 也是如此。你必须做其他事情来导致滞后。

我刚刚在 IE6、IE7、FF2 和 FF3 中尝试了 500 多个选项，并且几乎都是瞬时的。我使用了这段代码：

```
var data = [
    { text: 'foo', value: 'bar' },
    // ...
    { text: 'foo', value: 'bar' }
];

var select = document.getElementsByTagName('select')[0];
select.options.length = 0; // clear out existing items
for(var i=0; i < data.length; i++) {
    var d = data[i];
    select.options.add(new Option(d.text, i))
} 
```

我建议对获取数据并填充下拉列表的代码进行分析。其他事情可能会占用时间。例如，检查“分解”从服务器返回的字符串值的代码是否清晰（听起来您正在那里进行自己的自定义解析）。

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2012-09-04T23:48:19.143

第一个代码很好，但这对我来说效果更好：

```
var data = [
    { text: 'uno', value: '1' },
    {text: 'dos', value: '2' }
];

var select = document.getElementById('select-choice-1');
select.options.length = 0; // clear out existing items
for (var i = 0; i < data.length; i++) {
    var d = data[i];
    select.options.add(new Option(d.text, d.value))
} 
```

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2009-11-20T20:44:02.087

SelectElement.innerHTML 的所有这些答案的问题在于，您不能使用 SELECT 来完成这个技巧。解决方案是在 SELECT 元素本身的 PARENT 上使用 innerHTML。因此，在您的 ajax/jquery/whatever 代码中创建一个包含所有 SELECT HTML 的字符串，然后获取持有者（div 或 span 或其他）并将 innerHTML 设置为您构建的字符串。

您需要将 SELECT 与页面隔离，并为其指定一个显式父元素（span 或 div），以防止其他 html 元素在您销毁/重建 SELECT 元素时造成伤亡。

简短的回答：

```
parentselectelement.removeChild(selectelement);
parentselectelement.innerHTML = "<select ...><options...></select>"; 
```

* * *

## 回答 #4

> 赞同：2
> 
> 时间：2009-03-30T20:09:40.893

**使用SelectElement.innerHTML**设置它是最快的......但是**[在 IE 中失败了](http://webbugtrack.blogspot.com/2007/08/bug-274-dom-methods-on-select-lists.html)**。

最后我检查了一下，你可以在 IE 中执行此操作，如果你将所有选项包装在一个虚假的**<div>**标记中，或者在 IE 中设置选择列表的整个 .outerHTML。

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2009-03-30T20:30:22.963

我会在服务器上创建整个**选择**并将其注入页面。这种方法绕过了恼人的浏览器差异，并降低了客户端代码的复杂性。

You did mention that you tried that, but it failed in firefox. I would suggest persevering in getting it to work, posting another question asking for help on that issue, or editing your question to show us what you made that didn't work in firefox.

* * *

## 回答 #6

> 赞同：1
> 
> 时间：2012-02-24T01:30:18.237

`document.createDocumentFragment()`在将其附加到 SELECT 之前，不要忘记先附加到。

* * *

## 回答 #7

> 赞同：0
> 
> 时间：2013-03-12T14:29:17.537

如果您不介意使用 CoffeeScript，那么下面的代码用几行 JSON 数据填充选择列表。

**HTML**

```
<select id="clients"></select> 
```

**咖啡脚本**

```
fillList=($list, url)=>
    $.getJSON(url)
    .success((data)->
        $list
        .empty()
        .append("<option value=\"#{item.Id}\">#{item.Name}</option>" for item in data)
    )

$ -> 
    fillList($('#clients'), '/clients/all') 
```

**注意**：在调用该方法*一次*之前，内部的循环会`append`生成整个 html 字符串。这是很好和有效的。`append`

 ***示例 JSON**

```
[
  {"Id":"1","Name":"Client-1"},
  {"Id":"2","Name":"Client-2"}
] 
```

* * *

## 回答 #8

> 赞同：0
> 
> 时间：2009-03-30T20:23:41.157

查看您的代码将有很大帮助。

如果您正在创建一个`<option>`元素*并*在每次迭代时附加它，您应该考虑一次创建所有`<option>`元素，然后一次附加它们。

所以（在伪代码中）：

```
// Don't do this:
for choice in choices:
    option = new Options(choice)
    select.append(option)

// Do this instead
var options = array()

for choice in choices:
   options.append( new Options(choice) )

for option in options:
   select.append(option)

// Or you might try building the select element off-screen and then appending to the DOM
var options = array()
var select = new SelectElement()

for choice in choices:
   select.append( new Options(choice) )

dom_element.append(select) 
```

* * *

## 回答 #9

> 赞同：0
> 
> 时间：2009-03-31T13:29:23.747

当我使用它的第一个版本时，它可以工作，但更新第二个选择时可能会很慢

```
<html>
<form id='myform' method='post' action='$_SERVER[PHP_SELF]'>
<表格>
<tr><td><select onselect='CALL_AJAX_AND_UPDATE();'></select></td></tr>
<tr><td><select id='selectid'></select></td></tr>
</table>
</form>
</html>

<脚本类型=\"文本/javascript\">
函数更新（更新数据）
{                   
    var itemid = document.getElementById('selectid');               

    var data = updatedata.split('|');
    var len = 数据长度；                                                          

    对于（我=0；我<长度；我++）
    {
        var opt = document.createElement('option');
        opt.text = 数据[i];

        尝试
        {
            itemid.add(opt, null);                        
        }
        抓住（前）
        {
            itemid.add( 选择 );      
        }       
    }                                           
}
</脚本>

```

这个版本在 IE 中工作，但 firefox 似乎没有发布第二个选择数据。我错过了什么吗？

```
<html>
<form id='myform' method='post' action='$_SERVER[PHP_SELF]'>
<表格>
<tr><td><select onselect='CALL_AJAX_AND_UPDATE();'></select></td></tr>
<tr><td><div id='addselect'></div></td></tr>
</table>
</form>
</html>

<脚本类型=\"文本/javascript\">
函数更新（更新数据）
{               
    // 更新数据是full select html  
    var itemid = document.getElementById('addselect');              
    itemid.innerHTML = 更新数据；                                                          
}
</脚本>

```

* * *

## 回答 #10

> 赞同：0
> 
> 时间：2013-01-04T03:16:24.340

我喜欢 Crescent Fresh 和 Kemal Fadillah 的回答，因为两者都使用：

```
select.options.add(new Options(name, value)) 
```

至于数据对象，我建议进行如下小调整：

```
var data = {
  'uno': 1,
  'dos': 2
};

var select = document.getElementById('select-choice-1');
select.options.length = 0; // clear out existing items
for (var i in data) {
      select.options.add(new Option(i, data[i]));
} 
```

# c# - 使用 Web 服务/WCF 的命名约定并且没有重载

> ID：698818
> 
> 赞同：7
> 
> 时间：2009-03-30T20:04:47.393
> 
> 标签：c#, wcf, web-services, naming-conventions

目前的任务是在 c# 中设计一个 Web 服务（我要去 wcf，但原则仍然适用）。问题是没有我知道的方法重载，所以我需要用不同的名称命名 web 方法。

我真的很想对命名约定进行一些输入，例如，那里似乎没有任何内容。

我的主要方法是 GetMortgages() - 它返回所有抵押贷款。我需要另一个它会在一定的价格范围内归还抵押贷款所以你会为这个 GetMorgagesPriceRange、InPriceRange、WithPriceRange 推荐什么。

我对命名网络方法的最佳实践有点困惑，我很想重载 GetMortgages 但当然对于网络服务我不能......

那么做GetNounDescription会更好吗？

任何人都知道那里有任何好的 web 服务，它们有一个相同的方法，但每个方法都有不同的参数传递 - 真的很想知道这里的任何事情

如果可以练习使用 GET 启动我的网络方法，如果它是返回某些东西的东西？

存东西送东西呢，这里有标准吗？？即放置或保存？？？

一定有某种规则书可以遵循？？

真的想要一些输入是任何人有任何

谢谢马克

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2009-03-30T20:10:03.683

实际上没有任何命名约定的“规则手册”。你会找到一个适合你的。

.Net 最常见的采用是遵循 Microsoft .Net 命名约定，而对于 Web 服务，只需将它们视为程序集的扩展，而不是特殊情况。

[http://msdn.microsoft.com/en-us/library/ms229045.aspx](http://msdn.microsoft.com/en-us/library/ms229045.aspx)

因此，GetMortgages()、GetMortgagesInPriceRange(startPrice,endPrice) 等... 没问题。

至于“保存”，很多人会使用“提交名词”。

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2009-03-31T17:22:56.900

此外，您应该避免重载 Web 服务方法。使用不同的方法名称。

* * *

## 回答 #3

> 赞同：3
> 
> 时间：2009-07-31T11:10:43.717

您还可以让 GetMortgages() 服务方法采用“文档”而不是参数，并在文档中设计可选的过滤条件。这样，您只有一种方法可以处理所有“重载”。

```
<GetMortgages>
  <filter> .... </filter>
  <sort> .... </sort>
  <group> .... </group>
</GetMortgages> 
```

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2009-03-31T14:30:48.017

如果您有类似存储库的服务（正如我在您的示例中假设的那样）约定，您可以使用存储库模式

```
GetXByY(params) 
```

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2009-03-30T22:35:15.457

我觉得你做得很好。根据他们正在做什么来描述他们。GetAllMortgages()、GetMortgagesInPriceRange() 等。

考虑任何特定领域的术语。例如，如果抵押贷款价格范围的抵押贷款行业术语是“人口统计”，那么 GetMortgagesForDemographic 将是更好的名称，即使您知道唯一的“人口统计”特征是价格范围。

# java - Hibernate 在后续查询中使用初始 WHERE 子句

> ID：698822
> 
> 赞同：1
> 
> 时间：2009-03-30T20:05:43.757
> 
> 标签：java, hibernate, jpa

在使用 Hibernate 的 JPA 实现时，我注意到一个有趣的优化行为。在同一事务中，初始 JPA 查询的 WHERE 子句用于涉及初始查询结果的后续查询。

例如，人有姓氏和一组拥有的书籍。

```
// (1) get person by last name
Query q = entityManager.createQuery("SELECT p FROM Person p WHERE p.firstName = :lastName");
q.setParameter("lastName", "Smith");
List<Person> persons = q.getResultList();

// (2) get books owned by some arbitrary person in persons
Person person = persons.get(n);
Collection<Book> books = person.books; 
```

(1) 翻译成SQL：

```
SELECT ... FROM Person WHERE lastName = 'Smith' 
```

当 (2) 运行并访问 Person 的书籍时，它会生成 SQL：

```
SELECT ... FROM Person_Book book0_ WHERE book0_.personId IN (SELECT ... FROM ... WHERE lastName = 'Smith') 
```

不知何故，来自 (1) 的 WHERE 子句被记住并用于涉及检索到的人的后续查询 (2)。Hibernate 中的这种行为是什么，我该如何配置它？

**跟进**：我在人的书上使用子选择。这解释了我所看到的行为。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-03-30T21:45:37.120

[从此链接](http://www.javalobby.org/java/forums/t33002.html)中提取：

*我要介绍的最后一种获取形式是子选择获取。子选择提取与我刚刚描述的批量大小控制提取非常相似，但将“数字复杂性”排除在外。子选择提取实际上是一种不同类型的提取策略，适用于集合样式关联。然而，与连接样式获取不同，子选择获取仍然与惰性关联兼容。不同之处在于，子选择获取只是像我的同事所说的那样获得“整个射击比赛”，而不仅仅是一批。换句话说，它使用子选择执行将主实体集的 ID 集传递到关联表的 select off 中：*

> 从所有者中选择 *
> 
> select * from pet where owner_id in (select id from owner)

# .net - 模型视图控制器listview接口查询

> ID：698825
> 
> 赞同：0
> 
> 时间：2009-03-30T20:06:01.870
> 
> 标签：.net, model-view-controller, design-patterns

刚开始在移动应用程序中使用模型视图控制器设计模式，我有一个快速查询。

基本上，如果我的视图上有一个 listview 控件，并且我的控制器需要在执行操作时访问 listview 上的属性，比如检查的项目和 listviewitem vales，我是否只是在我的视图界面上公开一个 Listview 类型的属性，它返回我的控制器的列表视图？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-03-30T20:12:27.827

不，因为您的视图界面不应该是特定于技术的。理想情况下，您应该公开某种列表视图的**抽象**。在使用 MVC/MVP 设计 UI 时，最好考虑抽象的用户界面。不要过早开始设计控件。

顺便说一句：我建议使用 MVP 而不是 MVC。查看在 Winforms 上使用 MVP 的示例代码：[Implementing MVC with Windows Forms](https://stackoverflow.com/questions/654722/implementing-mvc-with-windows-forms/685722#685722)

以下是一些可以帮助您在 MVC 和 MVP 之间做出决定的链接：

*   [http://greggalipeau.wordpress.com/2008/04/04/choosing-a-ui-pattern-mvc-mvp-and-aspnet-mvc/](http://greggalipeau.wordpress.com/2008/04/04/choosing-a-ui-pattern-mvc-mvp-and-aspnet-mvc/)
*   [http://dotnetslackers.com/articles/designpatterns/Evergreen-but-still-topical-MVC-vs-MVP.aspx](http://dotnetslackers.com/articles/designpatterns/Evergreen-but-still-topical-MVC-vs-MVP.aspx)

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-03-31T16:53:07.737

您应该定义一个您的表单类实现的接口。该接口将具有允许底层 UI 类查询或控制表单的属性和方法。如果您决定更改表单（例如使用树视图而不是列表视图），那么您所要做的就是更改实现接口的代码。

# iphone - 手机软件开发语言

> ID：698829
> 
> 赞同：-1
> 
> 时间：2009-03-30T20:07:43.830
> 
> 标签：iphone, blackberry

是否存在通用手机开发语言？我的意思是，例如，php 或 java 或其他

编辑：我们必须开发一些手机应用程序，我们正在寻找不同设备（黑莓、iPhone、摩托罗拉等）中最好的可重用语言

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2009-03-30T21:35:44.273

[Rhomobile的](http://Rhomobile.Com/)[Rhodes](https://GitHub.Com/Rhomobile/Rhodes/)是一个用于构建跨平台电话应用程序的 Ruby 框架。它允许您构建适用于所有主要智能手机的单一应用程序：iPhone、BlackBerry、Windows Mobile、Symbian 和 Android。（唯一明显的遗漏似乎是 OpenMoko 和 PalmOS/webOS，但您列出的所有手机都支持。）

Rhodes 的工作方式是用 Ruby 编写应用程序，用 HTML 编写 UI。一个 Ruby 实现、Rhodes 框架本身、您的应用程序脚本和您的 HTML 文件然后被打包成一个看起来像单个本地应用程序的手机操作系统。然后，Rhodes 在手机内部运行一个网络服务器并从那里为应用程序提供服务，使用手机的内置网络浏览器 UI 组件和 JavaScript UI 库，使网络应用程序看起来像一个原生应用程序。（例如 iPhone 的 iUI。）

在 Mountain West RubyConf 2009 上，Rhomobile 的 CEO 对 Rhodes做了很好的[介绍（带有实时编码）](http://MtnWestRubyConf.Org/2009/speakers#rhomobile)，该[视频可在 Confreaks 网站上找到](http://MWRC2009.Confreaks.Com/14-mar-2009-11-05-rhodes-the-open-source-ruby-framework-for-building-mobile-applications-adam-blum.html)。

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2009-03-30T20:09:48.537

Java 与您将要来的一样接近，但它远非通用（iPhone 不支持它！）

由于 iPhone 的语言也没有被其他任何东西使用，因此您几乎找不到通用的解决方案。

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2009-03-30T20:35:06.790

Java（更具体地说是 J2ME）可以在大多数手机上运行。Google 的 Android 和 Blackberry 开发也涉及 Java。在 Symbian 手机上，您可以使用 C 进行开发，并且有一个 python 解释器。如果你的目标是 iPhone 市场，你必须坚持使用 Objective-C 和 Cocoa Touch 框架。

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2009-05-28T21:09:53.970

您可能想查看 Symbian 手机操作系统，它原本是诺基亚、摩托罗拉和爱立信联合合作的通用操作系统。参见：www.symbian.org/index.php

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2009-05-28T21:12:38.050

HTML + Javascript + CSS

电话间隙！

它是我所知道的唯一跨平台移动框架。具有对 iPhone、Android 和黑莓的功能支持

[http://phonegap.com/](http://phonegap.com/)

* * *

## 回答 #6

> 赞同：1
> 
> 时间：2009-03-30T20:42:51.030

没有通用语言，也没有所有主要平台都支持的通用运行时。两个主要参与者是[J2ME](http://java.sun.com/javame/index.jsp)、[BlackBerry](http://na.blackberry.com/eng/developers/)和[Android设备上的 Java 和](http://code.google.com/android/)[iPhone](http://developer.apple.com/iphone/)上的 Objective-C 。

* * *

## 回答 #7

> 赞同：0
> 
> 时间：2009-05-28T21:16:03.287

即使你能做到，编写一个没有真正充分利用它所在的任何设备的平庸应用程序有什么好处？

咬紧牙关，选择在选定的移动平台子集上进行出色的实施。

* * *

## 回答 #8

> 赞同：0
> 
> 时间：2009-03-30T20:09:40.707

出色地！！！大多数手机都支持java。你想做什么？学习一门新的语言？

* * *

## 回答 #9

> 赞同：0
> 
> 时间：2009-03-30T20:09:55.043

Java 可能是您能找到的最接近的。

# .net - 将选定和未聚焦的列表框样式更改为不灰显

> ID：698830
> 
> 赞同：31
> 
> 时间：2009-03-30T20:08:23.750
> 
> 标签：.net, wpf, listbox

我有一个非常简单的 WPF ListBox，SelectionMode 设置为 Multiple。

```
<ListBox SelectionMode="Multiple" /> 
```

当 ListBox 失去焦点时，很难判断选择了什么，因为选择颜色从蓝色变为浅灰色。更改此行为以使其保持蓝色的最简单方法是什么？

我知道这可能与 ListItem 的样式有关，但我找不到在哪里。

干杯。

**类似：** [WPF ListView 非活动选择颜色](https://stackoverflow.com/questions/382006/wpf-listview-inactive-selection-color)

* * *

## 回答 #1

> 赞同：50
> 
> 时间：2009-03-30T20:17:06.443

我在合并的 ResourceDictionary 中使用以下内容完成了类似的操作，它可能会对您有所帮助：

```
<Style TargetType="ListBoxItem">
    <Style.Resources>
        <!--SelectedItem with focus-->
        <SolidColorBrush x:Key="{x:Static SystemColors.HighlightBrushKey}" Color="LightBlue" Opacity=".4"/>
        <!--SelectedItem without focus-->
        <SolidColorBrush x:Key="{x:Static SystemColors.InactiveSelectionHighlightBrushKey }" Color="LightBlue" Opacity=".4"/>
    </Style.Resources>
</Style> 
```

* * *

## 回答 #2

> 赞同：11
> 
> 时间：2009-08-28T15:47:11.987

这不是问题的答案，但我在寻找一种方法来禁用列表框中的选择时发现了这一点。通过使用上述 Guy's & Bendewey 技术的稍微修改的形式，事实证明，您可以在列表框中显示没有选择的外观，而无需替换底层项目控件或类似的东西。这是我使用的代码：

```
<Grid.Resources>
  <Style TargetType="ListBoxItem">
    <Style.Resources>
      <SolidColorBrush x:Key="{x:Static SystemColors.HighlightBrushKey}" Color="White" />
      <SolidColorBrush x:Key="{x:Static SystemColors.HighlightTextBrushKey}" Color="Black" />
      <SolidColorBrush x:Key="{x:Static SystemColors.ControlBrushKey}" Color="White" />
    </Style.Resources>
  </Style>
</Grid.Resources> 
```

我还发现以下 MSDN 页面很有帮助：

[MSDN：SystemColors 成员 (System.Windows)](http://msdn.microsoft.com/en-us/library/system.windows.systemcolors_members.aspx)

谢谢你们的帮助，伙计们。

* * *

## 回答 #3

> 赞同：7
> 
> 时间：2013-10-04T13:22:55.307

更完整的解决方案是让新画笔引用 HighlightColor：

```
<Style TargetType="ListBox">
    <Setter Property="ItemContainerStyle">
        <Setter.Value>
            <Style TargetType="ListBoxItem">
                <Style.Resources>
                    <SolidColorBrush x:Key="{x:Static Member=SystemColors.InactiveSelectionHighlightBrushKey}"
                                     Color="{DynamicResource ResourceKey={x:Static Member=SystemColors.HighlightColorKey}}" />
                </Style.Resources>
            </Style>
        </Setter.Value>
    </Setter>
</Style> 
```

这将确保它使用相同的颜色并匹配系统主题（即使系统主题在运行时发生变化，这要归功于 DynamicResource）。

顺便说一句，WPF 的最新版本似乎不再为此使用“ControlBrush”，而是更合适的“InactiveSelectionHighlightBrush”。

* * *

## 回答 #4

> 赞同：4
> 
> 时间：2009-03-30T20:24:22.073

您可能可以通过重新编写模板来解决您的问题，但请尝试这个简单的补丁。

```
<Style TargetType="ListViewItem">
  <Style.Resources>
    <SolidColorBrush x:Key="{x:Static SystemColors.HighlightBrushKey}" Color="Blue" />
    <SolidColorBrush x:Key="{x:Static SystemColors.ControlBrushKey}" Color="Blue" />
  </Style.Resources>
</Style> 
```

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2017-10-25T12:58:44.923

当您选择的项目变灰时，这是因为您的控件失去了逻辑焦点。多个控件具有同时具有逻辑焦点的能力。因此，一个简单的解决方案可能是通过 FocusManager 为您的 ListBox 提供一个 FocusScope。

```
<ListBox SelectionMode="Multiple" FocusManager.IsFocusScope="True"></ListBox> 
```

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2013-11-21T16:36:27.823

我也有这个问题。但我通过使用 IsSynchronizedWithCurrentItem="True" 解决了这个问题：

```
<ListBox 
IsSynchronizedWithCurrentItem="True" /> 
```

# ms-access - 如何提取 Access (.mdb) 数据库的架构？

> ID：698839
> 
> 赞同：29
> 
> 时间：2009-03-30T20:10:01.047
> 
> 标签：ms-access, ms-jet-ace

我正在尝试提取 .mdb 数据库的架构，以便可以在其他地方重新创建数据库。

我怎样才能完成这样的事情？

* * *

## 回答 #1

> 赞同：24
> 
> 时间：2009-03-30T23:54:41.397

可以用 VBA 做一些事情。例如，这里是为具有本地表的数据库创建脚本的开始。

```
Dim db As Database
Dim tdf As TableDef
Dim fld As DAO.Field
Dim ndx As DAO.Index
Dim strSQL As String
Dim strFlds As String
Dim strCn As String

Dim fs, f

    Set db = CurrentDb

    Set fs = CreateObject("Scripting.FileSystemObject")
    Set f = fs.CreateTextFile("C:\Docs\Schema.txt")

    For Each tdf In db.TableDefs
        If Left(tdf.Name, 4) <> "Msys" Then
            strSQL = "strSQL=""CREATE TABLE [" & tdf.Name & "] ("

            strFlds = ""

            For Each fld In tdf.Fields

                strFlds = strFlds & ",[" & fld.Name & "] "

                Select Case fld.Type

                    Case dbText
                        'No look-up fields
                        strFlds = strFlds & "Text (" & fld.Size & ")"

                    Case dbLong
                        If (fld.Attributes And dbAutoIncrField) = 0& Then
                            strFlds = strFlds & "Long"
                        Else
                            strFlds = strFlds & "Counter"
                        End If

                    Case dbBoolean
                        strFlds = strFlds & "YesNo"

                    Case dbByte
                        strFlds = strFlds & "Byte"

                    Case dbInteger
                        strFlds = strFlds & "Integer"

                    Case dbCurrency
                        strFlds = strFlds & "Currency"

                    Case dbSingle
                        strFlds = strFlds & "Single"

                    Case dbDouble
                        strFlds = strFlds & "Double"

                    Case dbDate
                        strFlds = strFlds & "DateTime"

                    Case dbBinary
                        strFlds = strFlds & "Binary"

                    Case dbLongBinary
                        strFlds = strFlds & "OLE Object"

                    Case dbMemo
                        If (fld.Attributes And dbHyperlinkField) = 0& Then
                            strFlds = strFlds & "Memo"
                        Else
                            strFlds = strFlds & "Hyperlink"
                        End If

                    Case dbGUID
                        strFlds = strFlds & "GUID"

                End Select

            Next

            strSQL = strSQL & Mid(strFlds, 2) & " )""" & vbCrLf & "Currentdb.Execute strSQL"

            f.WriteLine vbCrLf & strSQL

            'Indexes
            For Each ndx In tdf.Indexes

                If ndx.Unique Then
                    strSQL = "strSQL=""CREATE UNIQUE INDEX "
                Else
                    strSQL = "strSQL=""CREATE INDEX "
                End If

                strSQL = strSQL & "[" & ndx.Name & "] ON [" & tdf.Name & "] ("

                strFlds = ""

                For Each fld In tdf.Fields
                    strFlds = strFlds & ",[" & fld.Name & "]"
                Next

                strSQL = strSQL & Mid(strFlds, 2) & ") "

                strCn = ""

                If ndx.Primary Then
                    strCn = " PRIMARY"
                End If

                If ndx.Required Then
                    strCn = strCn & " DISALLOW NULL"
                End If

                If ndx.IgnoreNulls Then
                    strCn = strCn & " IGNORE NULL"
                End If

                If Trim(strCn) <> vbNullString Then
                    strSQL = strSQL & " WITH" & strCn & " "
                End If

                f.WriteLine vbCrLf & strSQL & """" & vbCrLf & "Currentdb.Execute strSQL"
            Next
        End If
    Next

    f.Close 
```

* * *

## 回答 #2

> 赞同：13
> 
> 时间：2012-03-28T15:23:31.897

现在这是一个古老的问题，但不幸的是常年:(

我认为这段代码可能对寻找解决方案的其他人有用。它旨在通过 cscript 从命令行运行，因此无需将代码导入您的 Access 项目。[类似于Oliver](https://stackoverflow.com/users/28828/oliver)在[How do you use version control with Access development](https://stackoverflow.com/questions/187506/how-do-you-use-version-control-with-access-development)中的代码（并受其启发）。

```
' Usage:
'  CScript //Nologo ddl.vbs <input mdb file> > <output>
'
' Outputs DDL statements for tables, indexes, and relations from Access file 
' (.mdb, .accdb) <input file> to stdout.  
' Requires Microsoft Access.
'
' NOTE: Adapted from code from "polite person" + Kevin Chambers - see:
' http://www.mombu.com/microsoft/comp-databases-ms-access/t-exporting-jet-table-metadata-as-text-119667.html
'
Option Explicit
Dim stdout, fso
Dim strFile
Dim appAccess, db, tbl, idx, rel

Set stdout = WScript.StdOut
Set fso = CreateObject("Scripting.FileSystemObject")

' Parse args
If (WScript.Arguments.Count = 0) then
    MsgBox "Usage: cscript //Nologo ddl.vbs access-file", vbExclamation, "Error"
    Wscript.Quit()
End if
strFile = fso.GetAbsolutePathName(WScript.Arguments(0))

' Open mdb file
Set appAccess = CreateObject("Access.Application")
appAccess.OpenCurrentDatabase strFile
Set db = appAccess.DBEngine(0)(0)

' Iterate over tables
  ' create table statements
For Each tbl In db.TableDefs
  If Not isSystemTable(tbl) And Not isHiddenTable(tbl) Then
    stdout.WriteLine getTableDDL(tbl)
    stdout.WriteBlankLines(1)

    ' Iterate over indexes
      ' create index statements
    For Each idx In tbl.Indexes
      stdout.WriteLine getIndexDDL(tbl, idx)
    Next

    stdout.WriteBlankLines(2)
  End If
Next

' Iterate over relations
  ' alter table add constraint statements
For Each rel In db.Relations
  Set tbl = db.TableDefs(rel.Table)
  If Not isSystemTable(tbl) And Not isHiddenTable(tbl) Then
    stdout.WriteLine getRelationDDL(rel)
    stdout.WriteBlankLines(1)
  End If
Next

Function getTableDDL(tdef)
Const dbBoolean = 1
Const dbByte = 2
Const dbCurrency = 5
Const dbDate = 8
Const dbDouble = 7
Const dbInteger = 3
Const dbLong = 4
Const dbDecimal = 20
Const dbFloat = 17
Const dbMemo = 12
Const dbSingle = 6
Const dbText = 10
Const dbGUID = 15
Const dbAutoIncrField = 16

Dim fld
Dim sql
Dim ln, a

    sql = "CREATE TABLE " & QuoteObjectName(tdef.name) & " ("
    ln = vbCrLf

    For Each fld In tdef.fields
       sql = sql & ln & " " & QuoteObjectName(fld.name) & " "
       Select Case fld.Type
       Case dbBoolean   'Boolean
          a = "BIT"
       Case dbByte   'Byte
          a = "BYTE"
       Case dbCurrency  'Currency
          a = "MONEY"
       Case dbDate 'Date / Time
          a = "DATETIME"
       Case dbDouble    'Double
          a = "DOUBLE"
       Case dbInteger   'Integer
          a = "INTEGER"
       Case dbLong  'Long
          'test if counter, doesn't detect random property if set
          If (fld.Attributes And dbAutoIncrField) Then
             a = "COUNTER"
          Else
             a = "LONG"
          End If
       Case dbDecimal    'Decimal
          a = "DECIMAL"
       Case dbFloat      'Float
          a = "FLOAT"
       Case dbMemo 'Memo
          a = "MEMO"
       Case dbSingle    'Single
          a = "SINGLE"
       Case dbText 'Text
          a = "VARCHAR(" & fld.Size & ")"
       Case dbGUID 'Text
          a = "GUID"
       Case Else
          '>>> raise error
          MsgBox "Field " & tdef.name & "." & fld.name & _
                " of type " & fld.Type & " has been ignored!!!"
       End Select

       sql = sql & a

       If fld.Required Then _
          sql = sql & " NOT NULL "
       If Len(fld.DefaultValue) > 0 Then _
          sql = sql & " DEFAULT " & fld.DefaultValue

       ln = ", " & vbCrLf
    Next

    sql = sql & vbCrLf & ");"
    getTableDDL = sql

End Function

Function getIndexDDL(tdef, idx)
Dim sql, ln, myfld

    If Left(idx.name, 1) = "{" Then
       'ignore, GUID-type indexes - bugger them
    ElseIf idx.Foreign Then
       'this index was created by a relation.  recreating the
       'relation will create this for us, so no need to do it here
    Else
       ln = ""
       sql = "CREATE "
       If idx.Unique Then
           sql = sql & "UNIQUE "
       End If
       sql = sql & "INDEX " & QuoteObjectName(idx.name) & " ON " & _
             QuoteObjectName(tdef.name) & "( "
       For Each myfld In idx.fields
          sql = sql & ln & QuoteObjectName(myfld.name)
          ln = ", "
       Next
       sql = sql & " )"
       If idx.Primary Then
          sql = sql & " WITH PRIMARY"
       ElseIf idx.IgnoreNulls Then
          sql = sql & " WITH IGNORE NULL"
       ElseIf idx.Required Then
          sql = sql & " WITH DISALLOW NULL"
       End If
       sql = sql & ";"
    End If
    getIndexDDL = sql

End Function

' Returns the SQL DDL to add a relation between two tables.
' Oddly, DAO will not accept the ON DELETE or ON UPDATE
' clauses, so the resulting sql must be executed through ADO
Function getRelationDDL(myrel)
Const dbRelationUpdateCascade = 256
Const dbRelationDeleteCascade = 4096
Dim mytdef
Dim myfld
Dim sql, ln

    With myrel
       sql = "ALTER TABLE " & QuoteObjectName(.ForeignTable) & _
             " ADD CONSTRAINT " & QuoteObjectName(.name) & " FOREIGN KEY ( "
       ln = ""
       For Each myfld In .fields 'ie fields of the relation
          sql = sql & ln & QuoteObjectName(myfld.ForeignName)
          ln = ","
       Next
       sql = sql & " ) " & "REFERENCES " & _
             QuoteObjectName(.table) & "( "
       ln = ""
       For Each myfld In .fields
          sql = sql & ln & QuoteObjectName(myfld.name)
          ln = ","
       Next
       sql = sql & " )"
       If (myrel.Attributes And dbRelationUpdateCascade) Then _
             sql = sql & " ON UPDATE CASCADE"
       If (myrel.Attributes And dbRelationDeleteCascade) Then _
             sql = sql & " ON DELETE CASCADE"
       sql = sql & ";"
    End With
    getRelationDDL = sql
End Function

Function isSystemTable(tbl)
Dim nAttrib
Const dbSystemObject = -2147483646
    isSystemTable = False
    nAttrib = tbl.Attributes
    isSystemTable = (nAttrib <> 0 And ((nAttrib And dbSystemObject) <> 0))
End Function

Function isHiddenTable(tbl)
Dim nAttrib
Const dbHiddenObject = 1
    isHiddenTable = False
    nAttrib = tbl.Attributes
    isHiddenTable = (nAttrib <> 0 And ((nAttrib And dbHiddenObject) <> 0))
End Function

Function QuoteObjectName(str)
    QuoteObjectName = "[" & str & "]"
End Function 
```

如果您也想导出查询定义，[这个问题](https://stackoverflow.com/questions/1275502/using-vba-to-export-all-ms-access-sql-queries-to-text-files)应该会有所帮助。这有点不同，因为您通常不会使用简单的 DDL`CREATE VIEW foo AS ...`语法创建 querydef，实际上我不确定您是否可以（？）

但这是我为将查询备份到单独的 .sql 文件而编写的一小段脚本（它是用于备份所有前端数据库代码的较大脚本的一部分，请参阅 Oliver[对此问题](http://stackoverflow.com/questions/187506/how-do-you-use-version-control-with-access-development)的回答）。

```
Dim oApplication
Set oApplication = CreateObject("Access.Application")
oApplication.OpenCurrentDatabase sMyAccessFilePath
oApplication.Visible = False

For Each myObj In oApplication.DBEngine(0)(0).QueryDefs
    writeToFile sExportpath & "\queries\" & myObj.Name & ".sql", myObj.SQL 
Next

Function writeToFile(path, text)
Dim fso, st
  Set fso = CreateObject("Scripting.FileSystemObject")
  Set st = fso.CreateTextFile(path, True)
  st.Write text
  st.Close
End Function 
```

* * *

## 回答 #3

> 赞同：9
> 
> 时间：2009-06-11T11:44:44.153

以下 C# 概述了如何从 .mdb 文件中获取架构。

获取到数据库的连接：

```
String f = "Provider=Microsoft.Jet.OLEDB.4.0;Data Source=" + "database.mdb";
OleDbConnection databaseConnection = new OleDbConnection(f);
databaseConnection.Open(); 
```

获取每个表的名称：

```
DataTable dataTable = databaseConnection.GetOleDbSchemaTable(OleDbSchemaGuid.Tables, new object[] { null, null, null, "TABLE" });
int numTables = dataTable.Rows.Count;
for (int tableIndex = 0; tableIndex < numTables; ++tableIndex)
{
    String tableName = dataTable.Rows[tableIndex]["TABLE_NAME"].ToString(); 
```

获取每个表的字段：

```
 DataTable schemaTable = databaseConnection.GetOleDbSchemaTable(OleDbSchemaGuid.Columns, new object[] { null, null, tableName, null });
    foreach (DataRow row in schemaTable.Rows)
    {
        String fieldName = row["COLUMN_NAME"].ToString(); //3
        String fieldType = row["DATA_TYPE"].ToString(); // 11
        String fieldDescription = row["DESCRIPTION"].ToString(); //27
    }
} 
```

`3`和`11`来自哪里`27`？我通过`DataRow.ItemArray`调试器检查找到了它们，有人知道“正确”的方法吗？

* * *

## 回答 #4

> 赞同：7
> 
> 时间：2009-03-31T13:07:47.827

如果您乐于使用纯 Access SQL 以外的其他东西，则可以保留 ADOX 对象的集合并使用这些对象重新创建表结构。

示例（在 Python 中，当前不重新创建关系和索引，因为我正在处理的项目不需要它）：

```
import os
import sys
import datetime
import comtypes.client as client

class Db:
    def __init__(self, original_con_string = None, file_path = None,
                 new_con_string = None, localise_links = False):
        self.original_con_string = original_con_string
        self.file_path = file_path
        self.new_con_string = new_con_string
        self.localise_links = localise_links

    def output_table_structures(self, verbosity = 0):
        if os.path.exists(self.file_path):
            if not os.path.isdir(self.file_path):
                raise Exception("file_path must be a directory!")
        else:
            os.mkdir(self.file_path)
        cat = client.CreateObject("ADOX.Catalog")
        cat.ActiveConnection = self.original_con_string
        linked_tables = ()
        for table in cat.Tables:
            if table.Type == u"TABLE":
                f = open(self.file_path + os.path.sep +
                         "Tablestruct_" + table.Name + ".txt", "w")
                conn = client.CreateObject("ADODB.Connection")
                conn.ConnectionString = self.original_con_string
                rs = client.CreateObject("ADODB.Recordset")
                conn.Open()
                rs.Open("SELECT TOP 1 * FROM [%s];" % table.Name, conn)
                for field in rs.Fields:
                    col = table.Columns[field.Name]
                    col_details = (col.Name, col.Type, col.DefinedSize,
                                   col.Attributes)
                    property_dict = {}
                    property_dict["Autoincrement"] = (
                        col.Properties["Autoincrement"].Value)
                    col_details += property_dict,
                    f.write(repr(col_details) + "\n")
                rs.Close()
                conn.Close()
                f.close()
            if table.Type == u"LINK":
                table_details = table.Name,
                table_details += table.Properties(
                    "Jet OLEDB:Link DataSource").Value,
                table_details += table.Properties(
                    "Jet OLEDB:Link Provider String").Value,
                table_details += table.Properties(
                    "Jet OLEDB:Remote Table Name").Value,
                linked_tables += table_details,
        if linked_tables != ():
            f = open(self.file_path + os.path.sep +
                     "linked_list.txt", "w")
            for t in linked_tables:
                f.write(repr(t) + "\n")
        cat.ActiveConnection.Close() 
```

类似的反向函数使用第二个连接字符串重建数据库。

* * *

## 回答 #5

> 赞同：5
> 
> 时间：2009-03-31T09:11:14.743

您可以使用 ACE/Jet OLE DB Provider 和 ADO Connection 对象的 OpenSchema 方法来获取作为 Recordset 的架构信息（这可以说比 Collection 更好，因为它可以被过滤、排序等）。

基本方法是使用 adSchemaTables 获取基表（不是 VIEW），然后使用每个 TABLE_NAME 获取 ORDINAL_POSITION、!DATA_TYPE、!IS_NULLABLE、!COLUMN_HASDEFAULT、!COLUMN_DEFAULT、!CHARACTER_MAXIMUM_LENGTH、!NUMERIC_PRECISION、!NUMERIC_SCALE 的 adSchemaColumns。

adSchemaPrimaryKeys 很简单。adSchemaIndexes 是您可以找到 UNIQUE 约束的地方，不确定这些是否可以与唯一索引区分开来，以及插入 adSchemaForeignKeys 行集中的 FOREIGN KEY 的名称，例如（伪代码）：

```
rsFK.Filter = "FK_NAME = '" & !INDEX_NAME & "'") 
```

-- 注意 Jet 3.51 允许基于无名 PK 的 FK（！！）

验证规则和 CHECK 约束的名称可以在 adSchemaTableConstraints 行集中找到，使用 OpenSchema 调用中的表名，然后使用对 adSchemaCheckConstraints 行集的调用中的名称，过滤 CONSTRAINT_TYPE = 'CHECK'（陷阱是一个名为'ValidationRule' + Chr$(0)，所以最好从名称中转义空字符）。请记住，ACE/Jet 验证规则可以是行级或表级（CHECK 约束始终是表级），因此您可能需要在过滤器中使用表名：for adSchemaTableConstraints is [].[].ValidationRule将是 adSchemaCheckConstraints 中的 [].ValidationRule。另一个问题（疑似错误）是字段的宽度为 255 个字符，因此任何超过 255 个字符的验证规则/检查约束定义都将具有 NULL 值。

adSchemaViews，用于基于非参数化 SELECT SQL DML 的 Access Query 对象，非常简单；您可以使用 adSchemaColumns 中的 VIEW 名称来获取列详细信息。

PROCEDURES 在 adSchemaProcedures 中，是所有其他类型的 Access Query 对象，包括参数化的 SELECT DML；对于后者，我更喜欢用 PROCEDURE_DEFINITION 中的 CREATE PROCEDURE PROCEDURE_NAME 替换 PARAMETERS 语法。不要打扰查看 adSchemaProcedureParameters，您不会找到任何东西：可以通过使用 ADOX 目录对象来枚举参数以返回 ADO 命令，例如（伪代码）：

```
Set Command = Catalog.Procedures(PROCEDURE_NAME).Command 
```

然后枚举 .Name 的 Comm.Parameters 集合，DATA_TYPE 的 .Type，IS_NULLABLE 的（.Attributes 和 adParamNullable），COLUMN_HASDEFAULT 和 COLUMN_DEFAULT 的 .Value，.Size，.Precision，.NumericScale。

对于 ACE/Jet 特定的属性，例如 Unicode 压缩，您需要使用另一种对象。例如，可以使用 ADO 目录对象找到 Access-speak 中的长整数自动编号，例如（伪代码）：

```
bIsAutoincrement = Catalog.Tables(TABLE_NAME).Columns(COLUMN_NAME).Properties("Autoincrement").Value 
```

祝你好运 ：）

* * *

## 回答 #6

> 赞同：2
> 
> 时间：2009-03-30T21:38:18.497

查看 docmd。[传输数据库](http://msdn.microsoft.com/en-us/library/aa220761(office.11).aspx)命令。对于需要复制数据结构的构建集成，这可能是您的最佳选择

* * *

## 回答 #7

> 赞同：2
> 
> 时间：2009-06-23T07:59:05.037

Compare'Em [http://home.gci.net/~mike-noel/CompareEM-LITE/CompareEM.htm](http://home.gci.net/~mike-noel/CompareEM-LITE/CompareEM.htm) 将愉快地生成需要重新创建 MDB 的 VBA 代码。或者创建两个 MDB 之间差异的代码，以便您可以对现有的 BE MDB 进行版本升级。这有点古怪，但有效。注意它不支持新的 ACE (Access2007) ACCDB 等格式。

我用它所有的时间。

（OneDayWhen 的编辑是正确的三分之一和错误的三分之二。）

* * *

## 回答 #8

> 赞同：1
> 
> 时间：2009-03-30T20:45:51.507

在 Access 中很难执行 DDL 脚本/查询。它可以完成，但你最好只创建数据库的副本 - 删除所有数据并压缩它。然后使用它的副本在其他地方重新创建数据库。

* * *

## 回答 #9

> 赞同：1
> 
> 时间：2015-11-16T18:08:24.347

很有帮助的帖子！

我已经修改了脚本以生成 SQL Server 的数据定义语言。我认为它可能对某人有用，所以我分享它。我遇到的一个问题是 VBS 脚本会提取表中的所有字段作为索引。我还不确定如何解决这个问题，所以我只提取第一个字段。这适用于大多数主键。最后，并不是所有的数据类型都被证明了，但我想我得到了大部分。

```
Option Compare Database

Function exportTableDefs()

Dim db As Database
Dim tdf As TableDef
Dim fld As DAO.Field
Dim ndx As DAO.Index
Dim strSQL As String
Dim strFlds As String

Dim fs, f

    Set db = CurrentDb

    Set fs = CreateObject("Scripting.FileSystemObject")
    Set f = fs.CreateTextFile("C:\temp\Schema.txt")

    For Each tdf In db.TableDefs
        If Left(tdf.Name, 4) <> "Msys" And Left(tdf.Name, 1) <> "~" Then
            strSQL = "CREATE TABLE [" & tdf.Name & "] (" & vbCrLf

            strFlds = ""

            For Each fld In tdf.Fields

                strFlds = strFlds & ",[" & fld.Name & "] "

                Select Case fld.Type

                    Case dbText
                        'No look-up fields
                        strFlds = strFlds & "varchar (" & fld.SIZE & ")"

                    Case dbLong
                        If (fld.Attributes And dbAutoIncrField) = 0& Then
                            strFlds = strFlds & "bigint"
                        Else
                            strFlds = strFlds & "int IDENTITY(1,1)"
                        End If

                    Case dbBoolean
                        strFlds = strFlds & "bit"

                    Case dbByte
                        strFlds = strFlds & "tinyint"

                    Case dbInteger
                        strFlds = strFlds & "int"

                    Case dbCurrency
                        strFlds = strFlds & "decimal(10,2)"

                    Case dbSingle
                        strFlds = strFlds & "decimal(10,2)"

                    Case dbDouble
                        strFlds = strFlds & "Float"

                    Case dbDate
                        strFlds = strFlds & "DateTime"

                    Case dbBinary
                        strFlds = strFlds & "binary"

                    Case dbLongBinary
                        strFlds = strFlds & "varbinary(max)"

                    Case dbMemo
                        If (fld.Attributes And dbHyperlinkField) = 0& Then
                            strFlds = strFlds & "varbinary(max)"
                        Else
                            strFlds = strFlds & "?"
                        End If

                    Case dbGUID
                        strFlds = strFlds & "?"
                    Case Else
                        strFlds = strFlds & "?"

                End Select
                strFlds = strFlds & vbCrLf

            Next

            ''  get rid of the first comma
            strSQL = strSQL & Mid(strFlds, 2) & " )" & vbCrLf

            f.WriteLine strSQL

            strSQL = ""

            'Indexes
            For Each ndx In tdf.Indexes

                If Left(ndx.Name, 1) <> "~" Then
                    If ndx.Primary Then
                        strSQL = "ALTER TABLE " & tdf.Name & " ADD  CONSTRAINT " & tdf.Name & "_primary" & " PRIMARY KEY CLUSTERED ( " & vbCrLf
                    Else
                        If ndx.Unique Then
                            strSQL = "CREATE UNIQUE NONCLUSTERED INDEX "
                        Else
                            strSQL = "CREATE NONCLUSTERED INDEX "
                        End If
                        strSQL = strSQL & "[" & tdf.Name & "_" & ndx.Name & "] ON [" & tdf.Name & "] ("
                    End If

                    strFlds = ""

                    '''  Assume that the index is only for the first field.  This will work for most primary keys
                    '''  Not sure how to get just the fields in the index
                    For Each fld In tdf.Fields
                        strFlds = strFlds & ",[" & fld.Name & "] ASC "
                        Exit For
                    Next

                    strSQL = strSQL & Mid(strFlds, 2) & ") "
                End If
            Next
           f.WriteLine strSQL & vbCrLf
        End If
    Next

    f.Close

End Function 
```

* * *

## 回答 #10

> 赞同：0
> 
> 时间：2020-07-20T07:18:26.770

上面 Roland 的回答（由 Tobias 编辑）对我有用，但有一些变化。首先我解决了在主键中查找所有字段的问题；那么索引sql代码的写入文件是在错误的地方：选项比较数据库

```
Function exportTableDefs()

Dim db As Database
Dim tdf As TableDef
Dim fld As DAO.Field
Dim ndx As DAO.Index
Dim strSQL As String
Dim strFlds As String

Dim fs, f

    Set db = CurrentDb

    Set fs = CreateObject("Scripting.FileSystemObject")
    Set f = fs.CreateTextFile("C:\temp\Schema.txt")

    For Each tdf In db.TableDefs
        If Left(tdf.Name, 4) <> "Msys" And Left(tdf.Name, 1) <> "~" Then
            strSQL = "CREATE TABLE [" & tdf.Name & "] (" & vbCrLf

            strFlds = ""

            For Each fld In tdf.Fields

                strFlds = strFlds & ",[" & fld.Name & "] "

                Select Case fld.Type

                    Case dbText
                        'No look-up fields
                        strFlds = strFlds & "varchar (" & fld.SIZE & ")"

                    Case dbLong
                        If (fld.Attributes And dbAutoIncrField) = 0& Then
                            strFlds = strFlds & "bigint"
                        Else
                            strFlds = strFlds & "int IDENTITY(1,1)"
                        End If

                    Case dbBoolean
                        strFlds = strFlds & "bit"

                    Case dbByte
                        strFlds = strFlds & "tinyint"

                    Case dbInteger
                        strFlds = strFlds & "int"

                    Case dbCurrency
                        strFlds = strFlds & "decimal(10,2)"

                    Case dbSingle
                        strFlds = strFlds & "decimal(10,2)"

                    Case dbDouble
                        strFlds = strFlds & "Float"

                    Case dbDate
                        strFlds = strFlds & "DateTime"

                    Case dbBinary
                        strFlds = strFlds & "binary"

                    Case dbLongBinary
                        strFlds = strFlds & "varbinary(max)"

                    Case dbMemo
                        If (fld.Attributes And dbHyperlinkField) = 0& Then
                            strFlds = strFlds & "varbinary(max)"
                        Else
                            strFlds = strFlds & "?"
                        End If

                    Case dbGUID
                        strFlds = strFlds & "?"
                    Case Else
                        strFlds = strFlds & "?"

                End Select
                strFlds = strFlds & vbCrLf

            Next

            ''  get rid of the first comma
            strSQL = strSQL & Mid(strFlds, 2) & " )" & vbCrLf

            f.WriteLine strSQL

            strSQL = ""

            'Indexes
            For Each ndx In tdf.Indexes

                If Left(ndx.Name, 1) <> "~" Then
                    If ndx.Primary Then
                        strSQL = "ALTER TABLE " & tdf.Name & " ADD  CONSTRAINT " & tdf.Name & "_primary" & " PRIMARY KEY CLUSTERED ( " & vbCrLf
                    Else
                        If ndx.Unique Then
                            strSQL = "CREATE UNIQUE NONCLUSTERED INDEX "
                        Else
                            strSQL = "CREATE NONCLUSTERED INDEX "
                        End If
                        strSQL = strSQL & "[" & tdf.Name & "_" & ndx.Name & "] ON [" & tdf.Name & "] ("
                    End If

                    strFlds = ""

                    '''  use the ndx collection rather than tdf
                    For Each fld In ndx.Fields
                        strFlds = strFlds & ",[" & fld.Name & "] ASC "
                        Exit For
                    Next

                    strSQL = strSQL & Mid(strFlds, 2) & ") "
                End If
                ''' write to file for each iteration of the loop to get multiple indexes
                f.WriteLine strSQL & vbCrLf
            Next
        End If
    Next

    f.Close

End Function 
```

# iis - IIS7 身份验证问题

> ID：698849
> 
> 赞同：3
> 
> 时间：2009-03-30T20:13:18.513
> 
> 标签：iis, iis-7, windows-authentication

我已将网站部署到带有 IIS7 的 Win 2008 Web 服务器。该站点在带有 IIS6 的 Win 2003 标准服务器上运行良好。在 2008 框中，每当我从名为 Reports 的文件夹中请求页面（htm 或 aspx）时，都会遇到 Windows 身份验证对话框的挑战。

我在网站上启用了匿名身份验证和表单身份验证。我对 NETWORK SERVICE 和 IIS_IUSRS 的站点根目录应用了完全控制权限，但这并没有什么不同。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2010-08-10T17:51:17.600

就像之前已经提到的帖子一样，这里是解决这个问题的详细步骤:)

如果应用程序中有一个名为“Reports”的文件夹，并且服务器上安装了 SQL Server Reporting Services，则同样名为“Reports”的 Reporting Services 虚拟目录文件夹将与应用程序“Reports”文件夹发生冲突。要解决此问题，请打开 Reporting Services 配置管理器（开始->所有程序->MS SQL Server->配置工具）并更改左侧菜单中“报表管理器 URL”下的虚拟目录。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-03-31T13:30:13.857

您是否在新机器上安装了 MSSQL Reporting Services？它将使用 Reports 文件夹作为报告工具包（默认设置），并且在 MSSQL 2008 下，[您不能开箱即用地启用匿名访问。](http://blogs.msdn.com/jameswu/archive/2008/07/15/anonymous-access-in-sql-rs-2008.aspx)

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2010-10-11T16:30:17.263

我假设您没有在同一台服务器上运行 SQL Reporting Services：

1 - 授予用户“IUSR”和运行您的应用程序池的用户权限。2 - 覆盖子文件夹权限和所有权。2 - 检查该文件夹中是否有设置不同访问规则的 web.config 文件。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2010-08-10T16:06:20.083

好吧，在这里谈到同样的主题，昨天我在 Windows Server 2008 上部署我的应用程序，在那里也运行 IIS7 w/MSSQL 2008。在我网站的树结构中，我有一个名为 Reports 的文件夹，其中有一个子文件夹，然后是实际页面。它看起来像这样“Reports/SalaryReports/SalaryReport.aspx” 有趣的是，当我单击一个超链接转到“Reports/SalaryReports/SalaryReport.aspx”时，我从服务器收到了用户名/密码提示。当我在开发机器上运行应用程序时，VS 开发服务器上没有发生这种情况。所以我就像嗯？我查看了 SalaryReport.aspx 中的代码隐藏，没有发现任何异常。所以我放了一个默认值。aspx 直接在 Reports 文件夹中（认为身份验证从根向下两个节点到达 SalaryReport.aspx 可能有问题），但服务器仍然请求用户名/密码，即使没有安全设置应用于这个新的默认值.aspx。所以我想一定是文件夹被命名为“Reports”，所以我将它重命名为“Reports1”和bigno！一切正常！....我今天仍然会进一步研究这个问题，但似乎 IIS 7 HttpModule（不是我的一个）正在尝试为自己“保留”名为“Reports”的文件夹或其他东西否则...我将研究上面提到的 SQL Server 报告服务...无论如何，只是想分享:) aspx），但服务器仍然请求用户名/密码，即使没有应用到这个新的 Default.aspx 的安全设置。所以我想一定是文件夹被命名为“Reports”，所以我将它重命名为“Reports1”和bigno！一切正常！....我今天仍然会进一步研究这个问题，但似乎 IIS 7 HttpModule（不是我的一个）正在尝试为自己“保留”名为“Reports”的文件夹或其他东西否则...我将研究上面提到的 SQL Server 报告服务...无论如何，只是想分享:) aspx），但服务器仍然请求用户名/密码，即使没有应用到这个新的 Default.aspx 的安全设置。所以我想一定是文件夹被命名为“Reports”，所以我将它重命名为“Reports1”和bigno！一切正常！....我今天仍然会进一步研究这个问题，但似乎 IIS 7 HttpModule（不是我的一个）正在尝试为自己“保留”名为“Reports”的文件夹或其他东西否则...我将研究上面提到的 SQL Server 报告服务...无论如何，只是想分享:)

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2009-05-05T17:57:01.817

引用另一个论坛为我解决了这个问题：“如果您在 IIS 上安装 SQL Server Reporting Services，默认情况下会创建一个名为 Reports 的文件夹。如果您安装 SQL 2008，则 Reporting Services 不需要使用 IIS，而是会尝试使用 HTTP.Sys 服务保留 URL。

我相信这是您所看到的冲突的原因。您可以尝试通过 SQL Server Reporting Services 配置管理器更改 Reporting Services 使用的 URL。”

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2009-03-30T20:30:17.817

您的 web.config 中的身份验证模式是什么，请确认不在 Windows 中

```
<authentication mode="Windows" /> 
```

还要确保在 iis 中禁用集成 Windows 身份验证

* * *

## 回答 #7

> 赞同：0
> 
> 时间：2009-03-30T22:05:38.633

您可以尝试从 SysInternals 运行 FileMon，以查看是否是文件系统发送回“拒绝访问”。

# tfs - 让 TFS 将每个项目输出到自己的目录的最佳方法是什么？

> ID：698855
> 
> 赞同：60
> 
> 时间：2009-03-30T20:15:04.843
> 
> 标签：tfs, msbuild

我正在将一个大型代码库放入 Team Foundation Server。我希望构建过程为我们的项目创建一个“准备部署”的构建。

我们一直这样做的正常方式是让每个项目的输出都在自己的文件夹中。因此，例如，我们最终会得到类似的东西

```
C:\project1\
            assembly1.dll
            assembly2.dll
            project1.exe
            project1.exe.config
C:\project2\
            assembly2.dll
            assembly3.dll
            project2.exe
            project2.exe.config
C:\project3\
            assembly1.dll
            assembly3.dll
            project3.exe
            project3.exe.config 
```

这是我们喜欢的方式。

不过，TFS 似乎想把所有东西都放在同一个目录中。

```
C:\output\
          assembly1.dll
          assembly2.dll
          assembly3.dll
          project1.exe
          project1.exe.config
          project2.exe
          project2.exe.config
          project3.exe
          project3.exe.config 
```

虽然它节省了一些磁盘空间（每个程序集只有一次），但这并不是我们想要的。

指定 TFS/MSBuild 应将输出文件放在何处的最佳方法是什么？我是否需要单独编辑 sln/csproj 文件来实现这一点，或者我可以在 TFSBuild.proj 文件中进行吗？（即，在特定于 MSBuild 的文件中）

* * *

## 回答 #1

> 赞同：44
> 
> 时间：2009-06-11T20:04:15.183

我刚刚在这里写了另一种方法：

[http://mikehadlow.blogspot.com/2009/06/tfs-build-publishedwebsites-for-exe-and.html](http://mikehadlow.blogspot.com/2009/06/tfs-build-publishedwebsites-for-exe-and.html) 但如果您懒得点击链接，这里是完整的：

将团队控制下的所有代码收集在单个超级解决方案中通常是一种很好的做法，如本 Patterns and Practices PDF, Team Development with TFS Guide 中所述。如果您随后配置 TFS 构建服务器来构建此解决方案，则默认行为是将构建输出放置到单个文件夹“Release”中。

解决方案中的任何 Web 应用程序项目也将输出到名为 _PublishedWebsites\ 的文件夹中。这非常好，因为这意味着您可以简单地通过 robocopy 部署 Web 应用程序。

不幸的是，其他项目类型（如 WinForms、控制台或库）没有类似的默认行为。如果我们可以有一个 _PublishedApplications\ 子文件夹，其中包含任何选定项目的输出，那就太好了。幸运的是，这并不难做到。

_PublishedWebsites 的工作方式非常简单。如果您查看 Web 应用程序的项目文件，您会注意到底部附近有一个导入：

```
<Import Project="$(MSBuildExtensionsPath)\Microsoft\VisualStudio\v9.0\WebApplications\Microsoft.WebApplication.targets" /> 
```

在我的机器上，MSBuildExtensionsPath 属性评估为 C:\Program Files\MSBuild，如果我们打开 Microsoft.WebApplication.targets 文件，我们可以看到它是一个非常简单的 MSBuild 文件，它可以识别何时构建不是桌面构建，即它是TFS 构建，并将输出复制到：

```
$(OutDir)_PublishedWebsites\$(MSBuildProjectName) 
```

我只是复制了 Micrsoft.WebApplication.targets 文件，将它放在源代码管理下，并使用我的项目文件的相对路径，并将 _PublishedWebsites 更改为 _PublishedApplications 并将文件重命名为 CI.exe.targets。对于我想要输出到 _PublishedApplications 的每个项目，我只是在项目文件的底部添加了这个导入：

```
<Import Project="<your relative path>\CI.exe.targets" /> 
```

您可以编辑 CI.exe.targets（或任何您想调用的名称）来进行投标。就我而言，到目前为止唯一的更改是添加几行来复制 App.config 文件：

```
<Copy SourceFiles="$(OutDir)$(TargetFileName).config" DestinationFolder="$(WebProjectOutputDir)\bin" SkipUnchangedFiles="true" /> 
```

Microsoft.WebApplication.targets 中有很多只与 Web 应用程序相关的内容，并且可以为其他项目类型剥离，但我将把它留给读者作为练习。

* * *

## 回答 #2

> 赞同：39
> 
> 时间：2014-05-07T22:33:16.827

### TFS 2012+

我喜欢这个解决方案...

编辑您的构建定义。在进程部分下，设置`MSBuild arguments`为

`/p:GenerateProjectSpecificOutputFolder=true`

像这样：

![在此处输入图像描述](https://i.stack.imgur.com/09aKm.png)

* * *

## 回答 #3

> 赞同：10
> 
> 时间：2009-06-12T02:28:35.260

默认情况下，每个项目文件（*.csproj、*.vbproj 等）都指定一个默认输出目录（通常是 bin\Debug、bin\Release 等）。Team Build 实际上覆盖了这一点，这样您就不会随心所欲地决定开发人员在项目文件中设置的属性，而且还可以让 Team Build 对输出的位置做出假设。

覆盖此行为的最简单方法是在 SolutionToBuild 项组中将 CustomizableOutDir 设置为 true，如下所示：

```
<ItemGroup>
  <SolutionToBuild Include="$(BuildProjectFolderPath)\path\MySolution.sln" />
    <Properties>CustomizableOutDir=true</Properties>
  </SolutionToBuild>
</ItemGroup> 
```

如果您构建解决方案，这将使放置文件夹结构大致匹配您在本地获得的结构。

这种方法绝对比覆盖可能导致升级问题的 Core* 目标更可取。

* * *

## 回答 #4

> 赞同：6
> 
> 时间：2009-05-01T17:03:22.070

对于每个 SolutionToBuild 节点，将属性 OutDir 设置为 $(OutDir)\SubFolder
例如：

```
 <ItemGroup>
   <SolutionToBuild Include="Project1.sln" >
    <Properties>OutDir=$(OutDir)\Project1\</Properties>      
   </SolutionToBuild>
   <SolutionToBuild Include="Project2.sln" >
    <Properties>OutDir=$(OutDir)\Project2\</Properties>      
   </SolutionToBuild>
   <SolutionToBuild Include="Project3.sln" >
    <Properties>OutDir=$(OutDir)\Project3\</Properties>      
   </SolutionToBuild>
  <ItemGroup> 
```

（这适用于 TF2008，但不适用于 TF2005。）

* * *

## 回答 #5

> 赞同：5
> 
> 时间：2012-10-05T07:11:04.180

我回答这个问题有点晚了，但是有一种非常简单的方法可以实现 Mike Hadlows 的回答。有人写了一个 nuget 包，它完全符合 Mike 所说的。你可以在这里找到它：[http ://www.nuget.org/packages/PublishedApplications](http://www.nuget.org/packages/PublishedApplications)

* * *

## 回答 #6

> 赞同：4
> 
> 时间：2012-07-09T18:55:11.917

TFS 2010（以及即将推出的 TFS 2012）的更新。Jason Stangroome 写了一篇很好的博客文章，概述了如何做到这一点。

[https://blog.stangroome.com/2012/02/03/override-the-tfs-team-build-outdir-property/](https://blog.stangroome.com/2012/02/03/override-the-tfs-team-build-outdir-property/)

> # 覆盖 TFS Team Build OutDir 属性
> 
> **更新：[使用 .NET 4.5 有一种更简单的方法](http://blog.stangroome.com/2012/05/10/override-the-tfs-team-build-outdir-property-net-4-5/)。**
> 
> Team Foundation Server 构建系统的用户非常普遍的抱怨是它改变了项目输出的文件夹结构。默认情况下，Visual Studio 将所有文件放在每个项目各自的 /bin/ 或 /bin// 文件夹中，但 Team Build 仅使用平面文件夹结构将所有文件放在放置文件夹根目录中，或者再次放置在放置中的 // 子文件夹文件夹，所有项目输出混合在一起。
> 
> 此外，由于 Team Build 通过 MSBuild.exe 命令行设置 OutDir 属性并结合[MSBuild 的属性优先级](http://blogs.msdn.com/b/aaronhallberg/archive/2007/07/16/msbuild-property-evaluation.aspx)来实现这一点，因此无法从 MSBuild 本身轻松更改此值，流行的解决方案是[将 Build Process Template *.xaml 文件编辑为使用不同的属性名称](http://blogs.msdn.com/b/jimlamb/archive/2010/04/13/customizableoutdir-in-tfs-2010.aspx)。但除非绝对必要，否则我不喜欢接触工作流程。
> 
> 相反，我同时使用解决方案之前的目标和 MSBuild v4 的内联任务功能来覆盖用于在解决方案中构建单个项目的 MSBuild 任务的默认实现。在我的替代实现中，我阻止了 OutDir 属性被传递，并且我传递了一个名为 PreferredOutDir 的属性，而不是如果需要，单个项目可以使用该属性。
> 
> 第一部分，在解决方案级别用 OutDir 属性替换 PreferredOutDir 属性，只需将新文件添加到解决方案文件所在的目录即可。这个新文件应按照“before..sln.targets”模式命名，例如对于名为“Foo.sln”的解决方案文件，那么新文件将是“before.Foo.sln.targets”。这个新文件的内容应该[是这样](https://gist.github.com/1727206#file_before.the_solution.sln.targets)的。确保这个新文件被签入到源代码管理。
> 
> 第二部分，让每个项目控制其输出文件夹结构，只需在项目的 *.csproj 或 *.vbproj 文件中添加一行（取决于语言）。找到项目文件中没有指定 Condition 属性的第一个元素，并找到该元素的相应结束标记。在结束标记的正上方添加如下一行：
> 
> `<OutDir Condition=" '$(PreferredOutDir)' != '' ">$(PreferredOutDir)$(MSBuildProjectName)\</OutDir>`
> 
> 在此示例中，项目将输出到与项目文件同名的子文件夹下的 Team Build 放置文件夹（不带 .csproj 扩展名）。您可以选择不同的模式。此外，Web 项目通常在 Team Build 放置文件夹的 _PublishedWebSites 子文件夹下创建自己的输出文件夹，为了保持这种行为，只需将 OutDir 属性设置为与 PreferredOutDir 属性完全相同。
> 
> 您可以在签入之前验证您的更改是否已在本地计算机上生效，只需从命令行运行 MSBuild 并像 Team Build 一样指定 OutDir 属性，例如：
> 
> `msbuild Foo.sln /p:OutDir=c:\TestDropFolder\`

* * *

## 回答 #7

> 赞同：1
> 
> 时间：2011-12-06T19:37:40.383

对于那些好奇它如何与 TFS 2010 一起工作的人，[这篇](https://stackoverflow.com/a/8235585/154047)文章有几个答案，其中链接的答案对我来说效果很好。

* * *

## 回答 #8

> 赞同：0
> 
> 时间：2009-04-01T23:17:49.973

您可以为每个项目创建一个构建脚本，这完全可以满足您的需求。只需创建一个新的 TFSBuild 文件，将您想要构建的项目添加到项目组（按照您希望它们构建的顺序），设置您希望输出的位置。这是通过覆盖 TFSBuild 文件中的 - 属性来完成的。

但我也同意之前的海报——你为什么不只运行一个构建脚本，并在最后添加一个 zip 任务？为每个项目维护一个构建脚本确实会增加维护开销......

* * *

## 回答 #9

> 赞同：0
> 
> 时间：2010-07-08T06:52:53.523

把它放在一个属性组中：

```
<CustomizableOutDir>true</CustomizableOutDir> 
```

它将覆盖默认设置为 False 的全局“CustomizableOutDir”属性。在 SolutionToBuild 的属性中设置此项将不起作用。

* * *

## 回答 #10

> 赞同：-2
> 
> 时间：2009-04-06T11:55:20.190

您可以通过覆盖默认的 CoreDropBuild 目标实现来实现此目的。

在您的 TFSBuild.proj 文件（默认存储在 TeamBuildTypes/<Build Type> 下）中添加以下目标：

```
 <!-- Override default implementation -->
    <Target 
       Name="CoreDropBuild"
       Condition=" '$(SkipDropBuild)'!='true' and '$(IsDesktopBuild)'!='true' "
       DependsOnTargets="$(CoreDropBuildDependsOn)">
...
    </Target> 
```

在此目标中，您可以根据需要操作输出。默认设置是从 $(BinariesRoot)\$(BuildType) 复制所有内容到 $(DropLocation)\$(BuildNumber)。

我通常将[Microsoft.Sdc.Tasks 项目](http://www.codeplex.com/sdctasks)用于文件复制功能。

* * *

## 回答 #11

> 赞同：-3
> 
> 时间：2009-04-07T19:21:15.180

简单的解决方案：

将所有 <SolutionToBuild> 节点替换为 <SolutionToPublish>。这当然只适用于可发布项目（例如 Web 项目和应用程序），不适用于库项目。

就如此容易 ：）

# .net-1.1 - GetProcessesByName() 抛出进程性能计数器被禁用

> ID：698856
> 
> 赞同：1
> 
> 时间：2009-03-30T20:15:10.507
> 
> 标签：.net-1.1, performancecounter

我们有一个使用的应用程序，`Process.GetProcessesByName()`但它仅在一台用户 PC 上失败，并出现以下错误：

> 进程性能计数器已禁用

我在注册表中搜索了**禁用性能计数器**条目，但它不存在，值设置为 1。

用户 env 是具有管理权限的 XP。

我知道在 Windows Server 2003 上，用户帐户需要是性能计数器用户组的成员才能完成此操作。

关于如何启用进程性能计数器的任何想法？

* * *

## 回答 #1

> 赞同：-1
> 
> 时间：2020-01-02T00:35:26.713

可负责的问题：.NET 版本不兼容，需要启用性能计数器或权限问题

引用自[MSDN](https://social.msdn.microsoft.com/Forums/vstudio/en-US/482b5994-32a4-4c95-a73f-3c05ca2aaf93/systeminvalidoperationexception-process-performance-counter-is-disabled-so-the-requested?forum=netfxbcl)

> 在 .NET 1.0/1.1 中，Process 类依赖于性能计数器来提供有关本地和远程进程的性能信息。
> 
> .NET 2.0，不再存在这种对本地进程的依赖。
> 
> 出于以下几个原因，可能会引发此异常：
> 
> 1.  性能计数器被禁用 - Windows 资源工具包包含一个称为可扩展计数器列表的工具，可用于启用/禁用计数器
> 2.  用户没有足够的权限 - 非管理员用户（我认为）可能没有足够的权限来访问性能计数器。

如果可能，请安装 .NET > 2.0 并以较新版本为目标

这里有一个教程向您展示如何使用可扩展计数器列表来启用性能[计数器](https://support.symantec.com/us/en/article.TECH40069.html)

> 通过单击 Start > Run > Type in Perfmon 打开 Performance Monitor，然后选择 Ok。验证 Process Monitor 对象是否存在，如上面发布的屏幕截图所示。
> 
> 如果 Process 对象存在，请选择所有 Process objects 计数器和所有实例，单击 Add，然后查看图表。
> 
> 他们都成功运行了吗？
> 
> 如果计数器丢失，则需要启用它们。Microsoft 提供了几篇知识库文章来处理这种情况。首先阅读[http://support.microsoft.com/default.aspx?kbid=300956](http://support.microsoft.com/default.aspx?kbid=300956)
> 
> 如果此 KB 中的步骤无法正常工作，并且您的服务器是 Microsoft Windows Server 2003，请尝试下一步 在 Notification Server 或 Task Server 上下载并安装 Windows Server 2003 资源工具包
> 
> 打开 Windows Server 2003 Resource Kit 命令提示符 键入“exctrlst.exe”以调出可扩展计数器列表，如下面的屏幕截图所示，然后向下滚动并启用性能计数器

# c# - C# 自定义按钮

> ID：698857
> 
> 赞同：1
> 
> 时间：2009-03-30T20:15:42.860
> 
> 标签：c#, button

我正在尝试编写自定义按钮用户控件。我在绘制图像时遇到了挑战。

有没有一种简单的方法来绘制 ImageAlign 和 TextImageRelation 的图像？（有点像 StringFormat 使文本对齐变得轻而易举）

还是我必须手动完成所有对齐逻辑和东西？

谢谢

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-03-30T20:31:51.400

你想实现什么功能？也许它应该从 Button 类（假设 WinForms）继承，并覆盖适当的方法。根据您需要做什么，如果您这样做，您可能会免费获得按钮中许多较低级别的功能。

回到你的问题；不，如果您需要自己绘制东西，没有神奇的简单方法可以确定各个像素应该去哪里 :-) 您应该知道的一个很好的帮手是 Graphics.DrawString 方法。它允许您在使用选定字体和大小在控件上绘制时测量给定文本字符串的尺寸。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-03-30T20:31:35.020

我不知道有什么可以为您做这些事情的，但请注意 ControlPaint 类，因为它有一堆方便的实用方法来绘制控件。

# ruby-on-rails - Rails 中的 link_to 方法和单击事件

> ID：698858
> 
> 赞同：75
> 
> 时间：2009-03-30T20:15:43.233
> 
> 标签：ruby-on-rails, ruby

如何创建这种类型的链接：

```
<a href="#" onclick="document.getElementById('search').value=this.value"> 
```

`link_to`在 Rails 中使用方法？

[我无法从Rails 文档](http://api.rubyonrails.org/classes/ActionView/Helpers/UrlHelper.html)中弄清楚。

* * *

## 回答 #1

> 赞同：194
> 
> 时间：2009-03-30T20:24:43.913

您可以使用[`link_to_function`](http://api.rubyonrails.org/classes/ActionView/Helpers/JavaScriptHelper.html#M001756)（在 Rails 4.1 中删除）：

```
link_to_function 'My link with obtrusive JavaScript', 'alert("Oh no!")' 
```

或者，如果您绝对需要使用[`link_to`](http://api.rubyonrails.org/classes/ActionView/Helpers/UrlHelper.html#M001597)：

```
link_to 'Another link with obtrusive JavaScript', '#',
        :onclick => 'alert("Please no!")' 
```

但是，将 JavaScript 直接放入您生成的 HTML 中会显得很**突兀**，而且是**不好的做法**。

相反，您的 Rails 代码应该是这样的：

```
link_to 'Link with unobtrusive JavaScript',
        '/actual/url/in/case/javascript/is/broken',
        :id => 'my-link' 
```

假设您使用的是[Prototype JS 框架](http://prototypejs.org/)，那么您的 JS 如下所示`application.js`：

```
$('my-link').observe('click', function (event) {
  alert('Hooray!');
  event.stop(); // Prevent link from following through to its given href
}); 
```

或者，如果您使用的是[jQuery](http://jquery.com/)：

```
$('#my-link').click(function (event) {
  alert('Hooray!');
  event.preventDefault(); // Prevent link from following its href
}); 
```

通过使用这第三种技术，您可以保证如果 JavaScript 对用户不可用，该链接将继续指向其他页面，而不仅仅是静默失败。请记住，JS 可能不可用，因为用户的互联网连接不佳（例如，移动设备、公共 wifi）、用户或用户的系统管理员禁用了它，或者发生了意外的 JS 错误（例如，开发人员错误）。

* * *

## 回答 #2

> 赞同：25
> 
> 时间：2010-12-19T09:42:39.487

如果使用 JQuery 并将其放入 application.js 或 head 部分，则要跟进 Ron 的回答，您需要将其包装在 ready() 部分中......

```
$(document).ready(function() {
  $('#my-link').click(function(event){
    alert('Hooray!');
    event.preventDefault(); // Prevent link from following its href
  });
}); 
```

* * *

## 回答 #3

> 赞同：9
> 
> 时间：2016-01-15T10:34:09.950

只需使用

```
=link_to "link", "javascript:function()" 
```

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2019-05-31T14:26:30.113

另一个解决方案是捕获 onClick 事件并将数据聚合到 js 函数中，您可以

.hmtl.erb

```
<%= link_to "Action", 'javascript:;', class: 'my-class', data: { 'array' => %w(foo bar) } %> 
```

.js

```
// handle my-class click
$('a.my-class').on('click', function () {
  var link = $(this);
  var array = link.data('array');
}); 
```

# c++ - 从字符串设置 boost dynamic_bitset

> ID：698859
> 
> 赞同：7
> 
> 时间：2009-03-30T20:15:55.747
> 
> 标签：c++, boost, bitsets

[动态位集](http://www.boost.org/doc/libs/1_38_0/libs/dynamic_bitset/dynamic_bitset.html,)

我有一个需要填充的用例

```
boost::dynamic_bitset<unsigned char> , from a std::string buffer. 
```

你能建议如何去做吗？所以我需要想出一个功能

```
void populateBitSet (std::string &buffer, 
            boost::dynamic_bitset<unsigned char> & bitMap) {

     //populate bitMap from a string buffer
} 
```

* * *

## 回答 #1

> 赞同：10
> 
> 时间：2009-03-30T20:32:03.320

如果你有这样的二进制数据：

```
string buffer = "0101001111011"; 
```

你想像这样初始化它（原来有一个处理这种情况的[构造函数）：](http://www.boost.org/doc/libs/1_38_0/libs/dynamic_bitset/dynamic_bitset.html#cons3)

```
void populateBitSet (std::string &buffer, boost::dynamic_bitset<unsigned char> & bitMap) 
{        
   bitMap = boost::dynamic_bitset<unsigned char> (buffer);
} 
```

如果您想要原始数据，请使用[迭代器构造函数](http://www.boost.org/doc/libs/1_38_0/libs/dynamic_bitset/dynamic_bitset.html#cons4)：

```
void populateBitSet (std::string &buffer, boost::dynamic_bitset<unsigned char> & bitMap) 
{        
   bitMap = boost::dynamic_bitset<unsigned char> (buffer.begin(), buffer.end());
} 
```

这些最终会分配两次所需的内存，因此使用堆栈分配和交换可能会更好。或者你可以等到 C++0x 并让移动语义来做他们的事情。

```
// Unecessary in C++0x
void populateBitSet (std::string &buffer, boost::dynamic_bitset<unsigned char> & bitMap) 
{        
   boost::dynamic_bitset<unsigned char> localBitmap(buffer.begin(), buffer.end());
   bitMap.swap(localBitmap);
} 
```

编辑：澄清为什么第一个版本分配两倍的内存：

看一下第一个版本的另一种写法：

```
typedef boost::dynamic_bitset<unsigned char> bits; // just to shorten the examples.
void populateBitSet (std::string &buffer, bits &bitMap) 
{        
   const bits &temp = bits(buffer); // 1\. initialize temporary
   bitMap = temp; // 2\. Copy over data from temp to bitMap
} 
```

如果你把这两行放在一起，就像第一个例子一样，你仍然会在堆栈上得到一个临时构造，然后是一个赋值。1\. boost 需要为整组位分配足够的内存。在 2 中，boost 需要再次分配足够的内存来保存同一组位，然后将值复制过来。bitMap 可能已经有足够的内存，因此它可能并不总是需要重新分配，但它也有可能释放其后备内存并从头开始重新分配。

大多数适合 stl 模具的容器还具有交换功能，当您打算丢弃交换的一侧时，可以使用该功能代替分配。这些通常是 O(1) 并且不会抛出，因为它们通常只涉及交换一些指针。请参阅此[GotW](http://www.gotw.ca/gotw/059.htm)以了解这些有用的另一个原因。

在 C++0X 中，您将能够使用赋值，并且仍然获得交换的优势。由于您可以重载 r 值（例如临时值），因此容器知道当您分配临时值时，它知道它可以蚕食临时值并基本上进行交换。[Visual Studio 团队博客在这里很好地](http://blogs.msdn.com/vcblog/archive/2009/02/03/rvalue-references-c-0x-features-in-vc10-part-2.aspx)介绍了右值和移动语义。

# wpf - 自定义/用户控制

> ID：698862
> 
> 赞同：1
> 
> 时间：2009-03-30T20:17:07.740
> 
> 标签：wpf, custom-controls, user-controls

我有这样的任务 - 创建联合两个控件（来自 WPFToolkit 和标准工具栏的 DataGrid）的控件。在大范围内，它联合了哪些特定控件并不重要，我需要找出可用于构建我需要的东西的常见做法。乍一看，我需要像用户控件这样的东西，即控件的组合，我可以将其作为一个整体实现并在之后重用。但是，我的任务要求我能够在 XAML 中调整我的复合控件。因此，如果我组合 Toolbar 和 DataGrid，我希望它们的属性和事件都将被公开。所以我可以在 XAML 中设置，例如，数据网格的列和工具栏的栏：

（我故意在标签名称中加入空格，因为本地解析器由于某种原因没有输入它们）

```
<MyDataGridToolBarControl>
<DataGrid>
        <DataGrid.Columns>
            <DataGridTextColumn Header="firstColumn">
            </DataGridTextColumn>
            <DataGridTextColumn Header="secondColumn"/>
        </DataGrid.Columns>
</DataGrid>
<ToolBar Background="{x:Null}"> 
        <Button ToolTip="New">
            <Image Source="New.png"/>
        </Button>
        <Button ToolTip="Save">
            <Image Source="Save.png"/>
        </Button>
        <Button ToolTip="Delete">
            <Image Source="Delete.png"/>
        </Button>               
</ToolBar>
</MyDataGridToolBarControl> 
```

现在唯一不适合我的决定是让自定义控件继承自 Datarid（因为 DataGrid 在这对中更重要）并重新定义模板，包括数据网格和工具栏。这给了我数据网格的所有力量，但是，如果我想获得工具栏部分，我需要通过代码来完成，在虚拟和逻辑树中寻找它，即以编程方式访问它，这不是一个很好的决定。请帮助新手解决此任务）在此先感谢...

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-03-30T20:35:11.813

如果只是希望外部用户通过 Xaml 访问网格的每个属性和工具栏的每个属性，那么使用组合可以创建一个用户控件并像这样公开两个控件：

```
<UserControl>

    <StackPanel>
        <ToolBar x:Name="ToolBar" x:FieldModifier="Public" />
        <DataGrid x:Name="Grid" x:FieldModifier="Public" />         
    </StackPanel>

<UserControl> 
```

这种方法的问题是用户不能覆盖网格和工具栏的布局，因为它是一个用户控件。然而，它们可以完全覆盖工具栏和网格的模板和样式。

更好的方法是创建一个自定义控件（再次使用组合）。您可以像这样在模板中提供网格和工具栏：

```
<ControlTemplate>
        <StackPanel>
            <ToolBar x:Name="PART_ToolBar" />
            <DataGrid x:Name="PART_Grid" />         
        </StackPanel>
</ControlTemplate>

[TemplatePart("PART_ToolBar", typeof(ToolBar))]
[TemplatePart("PART_Grid", typeof(DataGrid))]
public class MyCustomControl : Control
{
    private ToolBar _ToolBar;
    public ToolBar ToolBar {get{return _ToolBar;}}

    private DataGrid _Grid;
    public DataGrid Grid {get{return _Grid;}}

    protected overrides OnApplyTemplate()
    {
         _ToolBar = this.Template.FindName("PART_ToolBar", this) as ToolBar;
         _Grid = this.Template.FindName("PART_Grid", this) as DataGrid;
    }
} 
```

# vb.net - 实体框架插入代码

> ID：698867
> 
> 赞同：2
> 
> 时间：2009-03-30T20:22:53.247
> 
> 标签：vb.net, linq, entity-framework

我有一个简单的实体框架。为简单起见，我将实体名称转换为 Northwind Like。

我有一个客户和项目对象的 IEnumerable

我正在尝试创建订单，这当然是由（简单地）一个项目和一个客户组成的。
我该如何创建和插入这些订单？

-甘蔗

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2009-03-30T20:36:12.950

试试这个

```
Using context As New MyEfContext
  Dim order As New Order
  order.Customer = context.Customers.FirstOrDefault(Function(cust) cust.Id = custId)
  Dim item As Item
  item = context.Items.FirstOrDefault(Function(item) item.Id = itemId)
  If (Not(item Is Nothing)) Then _
    order.Items.Add(item)
  context.AddToOrders(order)
  context.SaveChanges()
End Using 
```

# c# - 水晶报表+c#日期格式

> ID：698868
> 
> 赞同：0
> 
> 时间：2009-03-30T20:23:20.157
> 
> 标签：c#, crystal-reports

我有日期时间变量，我在水晶报表中向他展示

我想看短格式 (dd/mm/yyyy) - 但我看到他长格式 (dd/mm/yyy hh:mm:ss)

我能做些什么 ？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-03-30T20:26:54.970

您必须在 Crystal Reports 编辑器中格式化该字段。在设计模式下右键单击该字段，然后选择“格式”或类似的东西。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-06-13T02:04:07.183

如果要在公式字段中，您还可以使用 CStr 函数根据需要格式化日期。我相信下面会起作用，但没有尝试确定。

```
Cstr({field}, "dd/MM/yyyy") 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2011-06-24T18:54:58.890

我使用这种方法来格式化日期

```
ToText(Date ({Table.DATEField}),"MM/dd/yyyy") 
```

# xml - 以编程方式将具有表结构的 Word 文档转换为 XML 的最佳方法是什么

> ID：698880
> 
> 赞同：0
> 
> 时间：2009-03-30T20:30:05.650
> 
> 标签：xml, ms-word, data-conversion

所以，我有这个word文档，里面有一大堆表格，其中一些很长。在某些情况下，它跨越许多页面。我需要以编程方式将此东西转换为 XML。

我最初被告知我们可以将粘贴复制到 Excel 中并将其保存为 CSV，然后我可以从那里进行转换，这将非常容易。但是，由于某些字段的格式，在复制到 Excel 后需要对电子表格进行大量额外操作，以使其看起来正确并正确输出 CSV。

我应该注意，这是一个用 VB.Net 1.1 编写的旧应用程序的附加组件（提示皱眉脸）:(。但是，我正在讨论是否可以在 C# 3.5 中编写一个单独的命令行工具。似乎 C# 有一些我怀疑是在 1.1 框架中的 Word 互操作的东西，但我还没有调查太远。

所以，我只是在寻找可以实现的最好/最快的方法。只要实现并且以编程方式完成，它是如何实现的并不重要。如果不是太难，一些步骤可以手动完成。就像如果首先将其转换为其他格式会节省大量编码并且不会太难那样就可以了。

有没有人做过这样的事情？有任何想法吗？

**更新** 好的，所以这是我需要做的一个例子。

我有一个看起来像这样的word doc...

```
PROTOCOL:  BIRDS           

Field Name      Data Type      Required      Length      Total Digits      Fraction Digits      ValidValues/Comparison      Description
OBSERVATION_ID  Text           Yes           16          n/a               n/a                                              Unique observation identification.  Primary key. 
```

因此，有一个带有名称和供应商的表（在本例中为 Protocol 和 Birds）。例如，它只有一个字段。有效值/比较可以有多个用逗号分隔的事物，其中每个事物都由 XML 中的值标签括起来。

现在我基本上需要做的是把它转换成这个 XML ......

```
<?xml version="1.0" encoding="utf-8"?>
<Formats xmlns:xsd="http://www.w3.org/2001/XMLSchema" xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance" xmlns="Formats.xsd">
  <VendorFormats Vendor="PROTOCOL" LastModified="2005-9-13">
    <Format Name="BIRDS" Version="3" VersionDate="2005-9-10">
      <BaseTable>BIRDS</BaseTable>
      <StageTable>STAGE_BIRDS</StageTable>
      <Fields>
        <Text Name="OBSERVATION_ID" Required="Y">
          <NullValue />
          <Description>Unique observation identification.  Primary key.</Description>
          <Length>16</Length>
        </Text>
      </Fields>
    </Format>
   </VendorFormats>
 </Formats> 
```

总会有一个基表和一个阶段表，其中基表与冒号开头的任何名称相同（PROTOCOL：BIRDS，因此它将是 BIRDS），阶段表始终是 STAGE_，然后是冒号。您还会注意到 XML 中的版本和最后修改日期和版本日期。这些事情可以在以后担心，也许是手动添加的。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-09-15T19:03:26.593

您应该意识到没有 MS Word 文档之类的东西。有许多格式，一些早期的格式不值得命名，但更好地描述为 hacky 压缩文本的内存转储。您实际上并不需要 XML，这是以后的问题。您必须控制文档中的数据。除非那是最新的、有些记录的格式之一，否则您只有一个选择：破解它。编写一个程序来操作文档，直到你得到你想要的。唯一知道 MS-Word 格式的人是 MS-Word 本人。因此，如果您可以说服她将内容转储为或多或少定义的格式，例如 RTF，您就有了更好的起点。

# java - 小程序无法从 jar 加载类

> ID：698890
> 
> 赞同：3
> 
> 时间：2009-03-30T20:33:39.493
> 
> 标签：java, jakarta-ee, applet

一些用户抱怨小程序不再工作，当他们查看 java 控制台时，他们会看到 java.lang.noClassDefFoundError 并检查我的访问日志，我看到他们已经下载了包含该类的 jar 文件，然后发出 get请求特定的类。

不同的用户在不同的课程上休息。

有些用户很好。

任何可能导致此/解决此问题的想法。

我已经检查以确保文件在他们的 java 缓存中，清除了缓存等。似乎没有什么可以修复它们。

如果他们访问了一个 qa 站点，它也会中断。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-04-02T12:08:14.943

jar 在传输过程中损坏，我们正在考虑从 oracle/bea 获取服务器补丁。

看来，如果连接太慢（调制解调器速度），weblogic 将通过发送 len=0 的数据包来发出传输结束的信号。

网络将向 java 发出信号，表示下载已成功完成，然后 java 失败并出现 java.lang.noClassDefFoundError。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-03-30T21:09:04.463

如果可以加载类本身但不能加载该类的某些依赖项，则可能会发生这种情况。是否存在作为依赖项的外部 JAR？

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-03-30T20:42:53.417

您确定 jar 文件包含所有必要的类吗？在您最喜欢的 Zip 应用程序中打开它并仔细检查。也许那个罐子的最新版本搞砸了，里面没有所有东西。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2009-03-31T00:34:44.547

我假设您已经通过您的措辞进行了一些更新。某些用户很可能缓存了以前的 Jar 文件。

在实时配置中部署新的小程序版本时，我执行以下操作：

1.  确保保存小程序的页面没有被缓存——使用[HTTP 无缓存技术](http://www.htmlgoodies.com/beyond/reference/article.php/3472881)。您可能希望使用这些标头从新页面重新部署，以确保不是这种情况。
2.  为每次更新从不同的 URL 部署 jar 文件（我将版本号编码到一个目录中，但您同样可以重命名 jar 文件）。
3.  如果小程序执行任何客户端服务器交互，请确保您检查版本号并向用户报告不正确的版本。

即使您按照此操作，用户仍可能遇到问题，请他们一次尝试这些（按他们应该尝试的顺序列出）：

1.  按浏览器窗口上的刷新。
2.  重新启动所有浏览器窗口
3.  卸载在“添加/删除程序”中找到的*所有*Java 虚拟机并重新安装最新的 Java（是的，他们必须自担风险！）

# php - 尝试使用 stat() 或 filemtime() 时的 PHP 警告

> ID：698894
> 
> 赞同：0
> 
> 时间：2009-03-30T20:34:27.823
> 
> 标签：php, linux, command-line-interface

我正在尝试获取肯定存在的文件的最后修改时间：/document_root/myfile.pdf -rwxr-xr-x 1 11018 11008 198621 Nov 26 2007 myfile.pdf

当我运行以下语句时（通过 PHP CLI 作为 root）： filemtime('/document_root/myfile.pdf');

我收到错误：警告：stat(): Stat failed for /document_root/myfile.pdf (errno=2 - No such file or directory)

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-04-02T13:51:29.763

您的**文件路径错误**，或者您**无权**统计相关文件。

错误的文件路径？

```
filemtime('/document_root/myfile.pdf'); 
```

正确的文件路径？

```
filemtime($_SERVER['DOCUMENT_ROOT'].'/myfile.pdf'); 
```

检查文件的权限：运行 PHP 的用户可以读取文件吗？

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-03-30T20:45:22.150

您没有在未传递 document_root 值的函数中执行类似的操作吗？

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-04-01T03:57:21.087

你确定你有正确的道路吗？

/document_root/myfile.pdf

看起来像一个绝对路径，但我怀疑您的“document_root”是否在根文件系统中。

如果不是这样，还要确保 apache 用户具有对文件本身的读取访问权限，以及对导致文件路径的所有目录的 r+x 访问权限。

# c# - 如何将解决方案文件夹文件添加到 VS 项目模板？

> ID：698895
> 
> 赞同：5
> 
> 时间：2009-03-30T20:34:31.440
> 
> 标签：c#, visual-studio

我正在尝试在 Visual Studio 中创建一个项目模板。我的基本解决方案包含两个项目和一个“解决方案项目”解决方案文件夹，其中包含两个项目需要作为参考的（除其他外）库 (.dlls)。

我的项目模板创建两个项目，“解决方案项目”文件夹和“解决方案项目”中的另一个文件夹（根据需要）。但是，它不会添加应该填充“解决方案项”的 .dll 和其他文件。

在 .vstemplate 文件中，我将 .dll 的引用添加为直接位于“TemplateContent”节点下方的“ProjectItem”项，它们被忽略。

如果我尝试添加一个“项目”节点（好像我的解决方案项目文件夹是一个项目），我会收到各种错误。

我必须实际创建一个虚拟项目来保存这些文件吗？

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2009-04-09T17:06:13.637

看来我确实需要在项目中包含杂项文件（Microsoft 的术语），以便项目生成器找到它们。我将它们放入一个文件夹并将它们包含在我的一个项目模板中。

然后我实现了一个 IWizard，它也包含在解决方案模板中，在构建该项目之后，它将把文件移动到我想要它们的位置，并修改 .csproj 文件，这样它就不会错过它们。

这一切都很好，但感觉就像是最粗暴的黑客......！有人从MS那里吗？

* * *

## 回答 #2

> 赞同：-1
> 
> 时间：2009-03-31T04:19:39.873

我以前从未创建过模板，所以我只能猜测您在做什么。在我们的 .sln 文件中，我们的解决方案项如下所示：

```
Project("{2150E333-8FDC-42A3-9474-1A3956D46DE8}") = "_Build", "_Build", "{45E29CA9-E213-4C73-AA54-AE9B87F79F2D}"
    ProjectSection(SolutionItems) = preProject
        _Build\Project.proj = _Build\Project.proj
    EndProjectSection
EndProject 
```

解决方案文件夹在哪里`_Build`，我们将其映射到也称为“_”的物理文件夹`Build`。在这种情况下，它包含一个文件，Project.proj 文件，它当然映射到物理文件夹版本。

希望这甚至有帮助..？

# language-agnostic - 我应该“淘汰”新重写项目的旧主干吗？

> ID：698902
> 
> 赞同：0
> 
> 时间：2009-03-30T20:35:52.327
> 
> 标签：language-agnostic, version-control

最近，我一直在重温一个旧项目，大约两年前我最后一次从事该项目。显然，在这段时间里，我已经学会了如何最好地编程的新习惯，并且我渴望保留测试、取消实施并重新实施整个项目。这不是一个大项目，我相信我不会因为重写它而损失太多。

但是，我不知道如何处理版本历史。很可能当我完成更新后，新版本将只与旧版本共享 3-4% 的代码。此外，这些更改往往影响广泛，以至于试图保持干净的更改集是一种挫败感和徒劳的练习。鉴于此，似乎没有必要强迫潜在的开发人员下载旧的不相关版本。

我一直在考虑的一个选择是将主干移动到一个分支，例如`old-trunk/`，然后在一个空分支中开始开发。我不知道这是否是个好主意，而且我担心拥有两个树干会导致混乱。这让我想到了这个问题：

**SO怎么想的？如果你遇到一个项目“重置”了它的主干，你会不会被它迷惑？**

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2009-03-30T20:40:26.577

为什么不用“OldVersion”标记/标记主干并在同一位置继续开发？这样您就可以完全避免双重分支，并且仍然保持访问旧版本代码的方法。除非您正在开发不同的产品，否则您可能希望保留相同的主干。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-03-30T20:40:37.933

我标记了 $trunk，所以有一个“副本”。将它标记为发布的最后一个版本，或者您重新开始使用它之前的日期等。我实际上标记了发布日期，并将我的标签命名为实际日期本身。（如果您的系统支持，请使用标签代替标签）。

标记后，根据需要删除/重命名/大修。版本历史记录在那里，以防万一。并且，您有一个完整的副本标记/标记用于存档目的。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-03-30T20:40:58.913

假设您使用的是 SVN，实际上没有什么额外的事情可做。只要记住你开始重构的版本，然后继续在主干上工作。这比移动到空分​​支要好，因为将记录从旧代码到新代码的更改历史。

但是，如果您打算从头开始编写这个东西并且只是复制一些旧代码，也许您应该考虑在一个新的存储库中启动它。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2009-03-30T20:41:55.887

我认为没有必要丢弃旧版本。只需进行所有更改并签入。新开发人员不必下载任何旧代码，他们将始终只签出新版本。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2009-03-30T20:44:30.793

不，它不会让我感到困惑，因为项目文档会在我进入它之前就显示出来。我们都有需要重做的废话，坦率地说，应该是。

告诉每个人它不安全且不符合 HIPAA，他们会让你重新编码；o) 然后开始为我们其他人将素材发布到 The Daily WTF 80))

# web-services - ASP.NET 3.5 AJAX AutoCompleteExtender - 如何让它填充所有控件？

> ID：698904
> 
> 赞同：0
> 
> 时间：2009-03-30T20:36:11.250
> 
> 标签：web-services, asp.net-ajax, autocompleteextender

**前言：**

我正在使用 ASP.NET 3.5 和 AJAXControlToolkit。我正在尝试在我正在编写的控件上使用 AutoCompleteExtender，它是一个地址控件。

Address 控件有一堆文本框，例如 Address1、Address2、City、Zip 和下拉列表，例如 State 和 Country。

**设想：**

我希望用户开始在 Address1 中输入，然后向他们显示与他们输入的内容相匹配的其他地址。如果他们选择一个，我需要所有其他文本框和下拉列表来填充该信息。此外，我需要他们选择的地址行的主键显示在幕后的代码中，这样我们就不会复制数据，只需添加对该 ID 的引用。

我希望这是有道理的。

到目前为止，我已经创建了 ScriptManager、WebService 和 AutoCompleteExtender。

```
<asp:ScriptManager ID="ScriptManager1" runat="server">
    <Services>
        <asp:ServiceReference Path="EntityService.asmx" />
    </Services>
</asp:ScriptManager>

<ajax:AutoCompleteExtender 
    runat="server" 
    ID="autoComplete1" 
    TargetControlID="txtAddress1"
    ServiceMethod="GetAddressList"
    ServicePath="EntityService.asmx"
    MinimumPrefixLength="2" 
    CompletionInterval="500"
    EnableCaching="true"
    CompletionSetCount="20" 
    CompletionListCssClass="autocomplete_completionListElement" 
    CompletionListItemCssClass="autocomplete_listItem" 
    CompletionListHighlightedItemCssClass="autocomplete_highlightedListItem"
    DelimiterCharacters=";, :"
    ShowOnlyCurrentWordInCompletionListItem="true">
</ajax:AutoCompleteExtender> 
```

关于如何正确填充此控件集合的任何建议都非常感谢。

谢谢。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-04-08T05:01:53.133

好吧，我自己找到了解决方案。您可以在单击下拉菜单时绑定一个事件，并让 Web 服务返回一个 ID 字段作为事件参数的一部分。然后使用它来调用另一个返回具有值的复杂类型的 Web 服务。最后，使用 javascript 将这些值分配给所有控件。

易榨柠檬汁！

# javascript - 在浏览器之外使用 javascript 解析 xml？

> ID：698907
> 
> 赞同：0
> 
> 时间：2009-03-30T20:37:13.777
> 
> 标签：javascript, parsing, photoshop

我需要能够使用 javascript 在 photoshop 中解析 xml 文件。我尝试了activex，但它没有用。我该如何解析它。javascript 本身是否有 xml 解析器？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-03-30T22:42:38.497

不，JavaScript 是一种相对紧凑的语言——浏览器中的 XML 解析等内容来自 DOM。

这是 JSON 在 JS 开发人员中越来越受欢迎的部分原因——它更简单，但可以完成开发人员传统上使用 XML 的大部分工作，并且有多个纯 JS 解析器实现，实际上在语法上与 JS 兼容（所以 eval，等将起作用——尽管如果给出不受信任的内容，它们是不安全的）——并且在 SpiderMonkey 中，至少 JSON 可以作为基本 JS 实现的一部分。

# java - Oracle 数据源返回空连接

> ID：698908
> 
> 赞同：7
> 
> 时间：2009-03-30T20:37:19.437
> 
> 标签：java, database, oracle, connection, datasource

当连接请求数较多时，oracle 数据源返回空连接。我启用了隐式缓存。oracle 规范说只有在设置 ConnectionWaitTimeout 时才返回 null。我没有在缓存属性中为 ConnectionWaitTimeout 设置值。

这就是规范所说的

连接等待超时

指定请求连接并且已经有 MaxLimit 连接处于活动状态时的缓存行为。如果 ConnectionWaitTimeout 大于零，则每个连接请求都会等待指定的秒数或直到连接返回到缓存。如果在超时之前没有将连接返回到缓存，则连接请求返回 null。

默认值：0（无超时）

数据源可以返回空连接的其他可能性是什么？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-03-30T20:50:18.457

我认为默认值可能会因您使用的 Oracle 版本而异。一些信息是矛盾的，例如 Oracles“[优化连接池行为](http://download.oracle.com/docs/cd/B28359_01/java.111/e10788/optimize.htm)”意味着默认值为 3 秒（11g？）而其他来源声明它是零，如问题中所述。

我建议将其明确设置为零，看看行为是否仍然表现出来。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-03-30T21:35:53.790

我尝试设置此值。虽然文档说默认没有超时，但当我没有设置此属性时，数据源返回 null。当我明确指定连接正在等待的值时，即使值为 0 也会给我一个空连接。

# mfc - 当用户从 CComboBox 中选择项目时捕获

> ID：698910
> 
> 赞同：7
> 
> 时间：2009-03-30T20:38:03.290
> 
> 标签：mfc, ccombobox

这是最基本的。

我想捕捉用户从`CComboBox`（实际上是 的子类`CComboBox`）中选择项目的时间。

尝试了很多 , 的`OnCblSelChange`组合`OnCommand`。猜猜我还没有击中正确的组合（没有双关语）。

操作系统是 Vista，但我强制使用 XP 样式的对话框（这不重要，应该吗？）

我能够捕获派生自`CEdit`和的类的事件`CFileDialog`。

我在这里束手无策。任何帮助将不胜感激。

当然，任何源代码都会比以往任何时候都更受欢迎。

* * *

## 回答 #1

> 赞同：9
> 
> 时间：2009-11-04T00:43:35.970

`SELEND_OK`不幸的是，组合框更改的所有消息（甚至 ）似乎都是在文本实际更改*之前*`DoDataExchange`发送的，因此将为您提供`CComboBox`. [根据 MSDN 的建议，](http://msdn.microsoft.com/en-us/library/12h9x0ch(VS.80).aspx)我使用了以下方法：

```
void MyDialog::DoDataExchange(CDataExchange* pDX)
{
    DDX_Text(pDX, IDC_COMBO_LOCATION, m_sLocation);
    CDialog::DoDataExchange(pDX);
}

BEGIN_MESSAGE_MAP(MyDialog, CDialog)
    ON_CBN_SELENDOK(IDC_COMBO1, &MyDialog::OnComboChanged)
    ON_CBN_EDITUPDATE(IDC_COMBO1, &MyDialog::OnComboEdited) // This one updates immediately
END_MESSAGE_MAP()

...

void MyDialog::OnComboChanged()
{
    m_myCombo.GetLBText(m_myCombo.GetCurSel(), m_sSomeString);
}

void MyDialog::OnComboEdited()
{
    UpdateData();
} 
```

它似乎工作得很好。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-03-30T20:43:16.537

`CBN_SELENDOK`应该是您正在寻找的消息。它在用户选择完成后但在组合框关闭之前发送（如果确实如此）。 在选择实际保存到组合框控件*之前*`CBN_SELCHANGE`发送。

 *[这个 MSDN 链接](http://msdn.microsoft.com/en-us/library/12h9x0ch(VS.80).aspx)有更多信息（你可能已经看过了......）

这是我向你承诺的代码。收集此信息时我注意到的一件事是，如果您`ON_CONTROL_REFLECT`在派生自`CComboBox`. 这将导致控件本身处理消息而不是将其传递给父级。你可以通过使用`ON_CONTROL_REFLECT_EX`正确的返回码来解决这个问题，这将使盒子本身和父母都能收到消息。

无论如何，这是代码片段：

```
class SPC_DOCK_CLASS ProcessingExceptionDockDlg : public CSPCDockDialog
{
    SPC_DOCK_DECLARE_SERIAL(ProcessingExceptionDockDlg);

public:
    // ... redacted ...

    //{{AFX_DATA(ProcessingExceptionDockDlg)
    CComboBox                   m_comboFilter;
    //}}AFX_DATA

    //{{AFX_VIRTUAL(ProcessingExceptionDockDlg)
    protected:
    virtual void DoDataExchange(CDataExchange* pDX);
    //}}AFX_VIRTUAL

protected:

    //{{AFX_MSG(ProcessingExceptionDockDlg)
    afx_msg void OnSelendokComboTreeFilter();
    //}}AFX_MSG
    DECLARE_MESSAGE_MAP()
};

/****************/

// ProcessingExceptionDockDlg.cpp : implementation file
//

#include "stdafx.h"
#include "resource.h"
#include "ProcessingExceptionDockDlg.h"

// ... much code redacted ...

void ProcessingExceptionDockDlg::DoDataExchange(CDataExchange* pDX)
{
    CSPCDockDialog::DoDataExchange(pDX);
    //{{AFX_DATA_MAP(ProcessingExceptionDockDlg)
    DDX_Control(pDX, IDC_COMBO_TREE_FILTER, m_comboFilter);
    //}}AFX_DATA_MAP
}

BEGIN_MESSAGE_MAP(ProcessingExceptionDockDlg, CSPCDockDialog)
    //{{AFX_MSG_MAP(ProcessingExceptionDockDlg)
    ON_CBN_SELENDOK(IDC_COMBO_TREE_FILTER, OnSelendokComboTreeFilter)
    //}}AFX_MSG_MAP
END_MESSAGE_MAP()

void ProcessingExceptionDockDlg::OnSelendokComboTreeFilter() 
{
    // ... code redacted ...
} 
```

# .net - 使用 ASP.NET 比较验证器确保字段是唯一的

> ID：698911
> 
> 赞同：1
> 
> 时间：2009-03-30T20:39:28.840
> 
> 标签：.net, asp.net, validation, controls

我想使用验证器来保证给定文本框提交的内容是**唯一的**。我想确保放入框中的名称与任何其他文本框都不相同。

问题是我在编译时不知道它将与多少其他文本框进行比较。它可以是 0 到 n 个其他名称文本框之间的任何位置。

谢谢你提供的所有帮助。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-03-30T21:16:54.507

如果您想在客户端上执行此操作，一种简单的方法（虽然可能不是最好的方法）是这样的：

```
<html xmlns="http://www.w3.org/1999/xhtml" >
<head runat="server">
    <title></title>
    <script type="text/javascript">
        function CheckUnique(sender, args) {
            var inputArray = document.getElementsByTagName("input");
            for (var i = 0; i < inputArray.length; i++) {
                if (inputArray[i].type == "text" && inputArray[i].id != "TextBox1" && inputArray[i].value == args.Value) {
                    args.IsValid = false;
                    return;
                }
            }
        }
    </script>
</head>
<body>
    <form id="form1" runat="server">
    <div>
        <asp:CustomValidator ID="CustomValidator1" runat="server" ControlToValidate="TextBox1" ErrorMessage="CustomValidator" ClientValidationFunction="CheckUnique"></asp:CustomValidator>
        <asp:TextBox ID="TextBox1" runat="server"></asp:TextBox>
        <asp:TextBox ID="TextBox2" runat="server"></asp:TextBox>
        <asp:TextBox ID="TextBox3" runat="server"></asp:TextBox>
        <asp:Button ID="Button1" runat="server" Text="Button" />
    </div>
    </form>
</body>
</html> 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-03-30T20:51:56.593

我不确定您希望它在错误消息方面如何显示在您的 UI 上，但您可以使用页面上的 CustomValidator 控件来完成此操作。

当`ServerValidate`事件触发时，只需使用 FindControl() 或其他最简单的方法在页面上找到所有文本框，也许您已经将它们放在集合中。

检查唯一值的一种简单方法是尝试将值添加到 a `Dictionary<string, Textbox>`，由文本值键入。如果键已经存在，Add 方法会抛出异常。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-03-30T20:48:53.310

我认为您应该使用[自定义验证器](http://msdn.microsoft.com/en-us/library/system.web.ui.webcontrols.customvalidator.aspx)而不是比较验证器。在客户端或服务器端将所有控件的值存储到一个数组中并检查该项目是否在数组中。

这是一个[很好的 CustomValidator 示例](http://www.4guysfromrolla.com/articles/073102-1.aspx)。

# asp.net - ASP.NET 在 SQL 中存储 Image 并检索 Asp:Image

> ID：698912
> 
> 赞同：3
> 
> 时间：2009-03-30T20:39:32.367
> 
> 标签：asp.net, sql, image

我希望在 updateprofilepicture 页面上将图片 jpeg、gif 等文件上传到 SQL 数据库中。然后在配置文件页面上，我想从 sql 数据库中检索图像并将其显示在 Asp:Image 控件中。我有很多代码试图做到这一点，但它不起作用。该表包含一个 Image 类型的列。

* * *

## 回答 #1

> 赞同：8
> 
> 时间：2009-03-30T21:12:44.283

正如 Joel 提到的，您应该使用 HttpHandler 或页面来显示图像。这是输出图像（**Image.ashx**）的示例代码：

```
// ProcessRequest method of Image.ashx
long imageId = Convert.ToInt64(Request.QueryString["ImageId"]);

using (var conn = new SqlConnection(connectionString))
using (var command = new SqlCommand(
    "SELECT ImageFile FROM ImageTable WHERE ImageId = @ImageID", conn))
{
    command.Parameters.Add("@ImageID", SqlDbType.Int).Value = imageId;
    conn.Open();

    Response.ContentType = "image/gif";
    Response.BinaryWrite((byte[]) command.ExecuteScalar());
} 
```

然后在您的页面中使用图像：

```
 <asp:Image id="Image1" runat="server" ImageUrl="Image.ashx?ImageID=12"/> 
```

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2009-03-30T20:49:25.430

这里要记住的重要一点是，您不应该尝试使用个人资料页面本身传输图像数据。相反，您希望您的个人资料页面为浏览器生成如下所示的 HTML 标记：

```
<img src="~/MyImageHandler.ashx?UserID=1234" alt="User 1234 avatar" width="100px" height="150px" /> 
```

那是你`<asp:Image .../>`控制的最终结果。然后浏览器将发送一个完全独立的 Http 请求来检索图像。这就是网站上的图片的工作方式。然后，您需要能够处理该附加请求。为此，请创建一个`Http handler (*.ashx file)`并使用它从数据库中检索适当的图像数据并将其发送到浏览器。

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2009-03-30T21:47:22.997

如果您使用 SQL 2005 或更高版本，则不应使用数据类型 Image 因为它现在[已弃用](http://msdn.microsoft.com/en-us/library/ms191262.aspx)。相反，如果可能，您希望使用新的 Varbinary(MAX) 类型。一旦存储了它，您需要做的就是通过 ADO.Net 调用检索它并将单元格值转换为 Byte[] 类型，然后像上面 ScarletGarden 的示例一样调用 Response.BinaryWrite。

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2009-08-05T20:44:32.483

看了几百G的图片后，相信你会发现自己认为操作系统的文件系统和静态文件http服务器比数据库更适合存储图片，数据库比较忙，还有很多其他细节。它还允许您使用数千种现有的免费工具来处理、移动、托管等图像。

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2010-04-04T19:18:51.880

不要将图像存储在数据库中，而是存储图像的路径和/或文件名。图像将填满数据库并使其变慢。

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2013-03-14T13:13:39.707

```
protected void Page_Load(object sender, EventArgs e) {
    GridView1.DataSourceID = "";
    GridView1.DataSource = SqlDataSource1;
    GridView1.DataBind();
}

protected void btnSubmit_Click(object sender, EventArgs e) {
    string strImageName = txtImageName.Text.ToString();

    if (FileUpload1.PostedFile != null && FileUpload1.PostedFile.FileName != "") {
        byte[] imageSize = new byte[FileUpload1.PostedFile.ContentLength];
        HttpPostedFile uploadedImage = FileUpload1.PostedFile;
        uploadedImage.InputStream.Read(imageSize, 0, (int)FileUpload1.PostedFile.ContentLength);

        // Create SQL Connection
        SqlConnection con = new SqlConnection();
        con.ConnectionString = "Data Source=RND3" + "\\" + "SQLEXPRESS;Initial Catalog=SSSolutionFiles;Integrated Security=True";

        // Create SQL Command 
        SqlCommand cmd = new SqlCommand();
        cmd.CommandText = "INSERT INTO Imagess(ImageName,Image)" + " VALUES (@ImageName,@Image)";
        cmd.CommandType = CommandType.Text;
        cmd.Connection = con;

        SqlParameter ImageName = new SqlParameter("@ImageName", SqlDbType.VarChar, 50);
        ImageName.Value = strImageName.ToString();
        cmd.Parameters.Add(ImageName);

        SqlParameter UploadedImage = new SqlParameter("@Image", SqlDbType.Image, imageSize.Length);
        UploadedImage.Value = imageSize;
        cmd.Parameters.Add(UploadedImage);
        con.Open();
        cmd.ExecuteNonQuery();
        con.Close();

        Label1.Text = "File Uploaded";

        GridView1.DataSourceID = "";
        GridView1.DataSource = SqlDataSource1;
        GridView1.DataBind();
        con.Close();
    }
} 
```

* * *

## 回答 #7

> 赞同：0
> 
> 时间：2014-11-29T05:30:41.797

试试这些链接它可能对你有帮助..

您也可以尝试通过将图像文件存储在服务器上并将路径存储在 Sql 表上.. 通过这些链接

[http://pratikataspdotnet.blogspot.in/2014/11/retrieve-images-from-path-stored-in.html](http://pratikataspdotnet.blogspot.in/2014/11/retrieve-images-from-path-stored-in.html)

# mysql - 如何使用 XAMPP for Windows 访问 MySQL 命令行？

> ID：698914
> 
> 赞同：151
> 
> 时间：2009-03-30T20:39:52.600
> 
> 标签：mysql, windows, xampp, mysqldump

如何使用 XAMPP for Windows 访问 MySQL 命令行？

* * *

## 回答 #1

> 赞同：220
> 
> 时间：2009-03-30T20:47:15.747

你的 MySQL 二进制文件应该在你的 XAMPP 文件夹下。查找 /bin 文件夹，您会在周围找到 mysql.exe 客户端。假设它位于 c:\xampp\mysql\bin 中，那么您应该在此文件夹中启动命令提示符。

这意味着，启动“cmd”，然后输入：

```
cd c:\xampp\mysql\bin
mysql.exe -u root --password 
```

如果你想使用 mysqldump.exe，你也应该在那里找到它。

登录到您的 mysql 服务器，然后开始输入您的命令。

希望能帮助到你...

* * *

## 回答 #2

> 赞同：41
> 
> 时间：2010-09-20T22:35:30.203

在 Mac 上，或者至少在我使用默认安装的 Mac 上，我在以下位置访问它：

```
/Applications/xampp/xamppfiles/bin/mysql -uroot -p

```

* * *

## 回答 #3

> 赞同：37
> 
> 时间：2011-08-28T15:46:33.983

对于 Linux：

```
/opt/lampp/bin/mysql -u root -p 
```

要仅使用“mysql -u root -p”命令，然后将“/opt/lampp/bin”添加到环境变量的 PATH 中。

* * *

## 回答 #4

> 赞同：33
> 
> 时间：2011-06-14T20:46:55.420

`mysql`要在 Windows 中访问命令而不手动更改目录，请执行以下操作：

*   进入控制面板 > 系统 > 高级系统设置。
*   将出现系统属性。
*   单击“高级”选项卡。
*   单击“环境变量”。
*   在系统变量下，找到“路径”并单击编辑。
*   将 MySQL 安装路径附加到现有“变量值”的末尾。例子：

    ```
    %systemDrive%\xampp\mysql\bin\
    ```

    或者，如果您愿意

    ```
    c:\xampp\mysql\bin\
    ```

*   最后，打开一个新的命令提示符使此更改生效。

*请注意，[MySQL 关于设置环境变量的文档对于](http://dev.mysql.com/doc/refman/5.0/en/setting-environment-variables.html)在 Windows 中处理此问题几乎没有说明。*

* * *

## 回答 #5

> 赞同：24
> 
> 时间：2013-06-15T17:14:04.090

1.  打开 XAMPP 控制面板。
2.  单击`Shell`。
3.  键入`mysql --user=your_user_name --password=your_password`。

* * *

## 回答 #6

> 赞同：12
> 
> 时间：2017-10-31T11:03:36.603

您可以使用 XAMPP for Windows 访问 MySQL 命令行

[![在此处输入图像描述](https://i.stack.imgur.com/wDEzR.jpg)](https://i.stack.imgur.com/wDEzR.jpg)

1.  单击 XAMPP 图标以启动其 cPanel

2.  单击外壳按钮

3.  输入这个`mysql -h localhost -u root`并点击进入

**您应该看到所有命令行以及它们的作用**

```
Setting environment for using XAMPP for Windows.
Your PC c:\xampp

# mysql -h localhost - root

mysql  Ver 15.1 Distrib 10.1.19-MariaDB, for Win32 (AMD64)
Copyright (c) 2000, 2016, Oracle, MariaDB Corporation Ab and others.

Usage: mysql [OPTIONS] [database]

Default options are read from the following files in the given order:
C:\WINDOWS\my.ini C:\WINDOWS\my.cnf C:\my.ini C:\my.cnf C:\xampp\mysql\my.ini C:\xampp\mysql\my.cnf C:\xampp\mysql\bin\my.ini C:\xampp\mysql\bin\my.cnf
The following groups are read: mysql client client-server client-mariadb
The following options may be given as the first argument:
--print-defaults        Print the program argument list and exit.
--no-defaults           Don't read default options from any option file.
--defaults-file=#       Only read default options from the given file #.
--defaults-extra-file=# Read this file after the global files are read.

  -?, --help          Display this help and exit.
  -I, --help          Synonym for -?
  --abort-source-on-error
Abort 'source filename' operations in case of errors
  --auto-rehash       Enable automatic rehashing. One doesn't need to use
                      'rehash' to get table and field completion, but startup
                      and reconnecting may take a longer time. Disable with
                      --disable-auto-rehash.
                      (Defaults to on; use --skip-auto-rehash to disable.)
  -A, --no-auto-rehash
                      No automatic rehashing. One has to use 'rehash' to get
                      table and field completion. This gives a quicker start of
                      mysql and disables rehashing on reconnect.
  --auto-vertical-output
                      Automatically switch to vertical output mode if the
                      result is wider than the terminal width.
  -B, --batch         Don't use history file. Disable interactive behavior.
                      (Enables --silent.)
  --character-sets-dir=name
                      Directory for character set files.
  --column-type-info  Display column type information.
  -c, --comments      Preserve comments. Send comments to the server. The
                      default is --skip-comments (discard comments), enable
                      with --comments.
  -C, --compress      Use compression in server/client protocol.
  -#, --debug[=#]     This is a non-debug version. Catch this and exit.
  --debug-check       Check memory and open file usage at exit.
  -T, --debug-info    Print some debug info at exit.
  -D, --database=name Database to use.
  --default-character-set=name
                      Set the default character set.
  --delimiter=name    Delimiter to be used.
  -e, --execute=name  Execute command and quit. (Disables --force and history
                      file.)
  -E, --vertical      Print the output of a query (rows) vertically.
  -f, --force         Continue even if we get an SQL error. Sets
                      abort-source-on-error to 0
  -G, --named-commands
                      Enable named commands. Named commands mean this program's
                      internal commands; see mysql> help . When enabled, the
                      named commands can be used from any line of the query,
                      otherwise only from the first line, before an enter.
                      Disable with --disable-named-commands. This option is
                      disabled by default.
  -i, --ignore-spaces Ignore space after function names.
  --init-command=name SQL Command to execute when connecting to MySQL server.
                      Will automatically be re-executed when reconnecting.
  --local-infile      Enable/disable LOAD DATA LOCAL INFILE.
  -b, --no-beep       Turn off beep on error.
  -h, --host=name     Connect to host.
  -H, --html          Produce HTML output.
  -X, --xml           Produce XML output.
  --line-numbers      Write line numbers for errors.
                      (Defaults to on; use --skip-line-numbers to disable.)
  -L, --skip-line-numbers
                      Don't write line number for errors.
  -n, --unbuffered    Flush buffer after each query.
  --column-names      Write column names in results.
                      (Defaults to on; use --skip-column-names to disable.)
  -N, --skip-column-names
                      Don't write column names in results.
  --sigint-ignore     Ignore SIGINT (CTRL-C).
  -o, --one-database  Ignore statements except those that occur while the
                      default database is the one named at the command line.
  -p, --password[=name]
                      Password to use when connecting to server. If password is
                      not given it's asked from the tty.
  -W, --pipe          Use named pipes to connect to server.
  -P, --port=#        Port number to use for connection or 0 for default to, in
                      order of preference, my.cnf, $MYSQL_TCP_PORT,
                      /etc/services, built-in default (3306).
  --progress-reports  Get progress reports for long running commands (like
                      ALTER TABLE)
                      (Defaults to on; use --skip-progress-reports to disable.)
  --prompt=name       Set the mysql prompt to this value.
  --protocol=name     The protocol to use for connection (tcp, socket, pipe,
                      memory).
  -q, --quick         Don't cache result, print it row by row. This may slow
                      down the server if the output is suspended. Doesn't use
                      history file.
  -r, --raw           Write fields without conversion. Used with --batch.
  --reconnect         Reconnect if the connection is lost. Disable with
                      --disable-reconnect. This option is enabled by default.
                      (Defaults to on; use --skip-reconnect to disable.)
  -s, --silent        Be more silent. Print results with a tab as separator,
                      each row on new line.
  --shared-memory-base-name=name
                      Base name of shared memory.
  -S, --socket=name   The socket file to use for connection.
  --ssl               Enable SSL for connection (automatically enabled with
                      other flags).
  --ssl-ca=name       CA file in PEM format (check OpenSSL docs, implies
                      --ssl).
  --ssl-capath=name   CA directory (check OpenSSL docs, implies --ssl).
  --ssl-cert=name     X509 cert in PEM format (implies --ssl).
  --ssl-cipher=name   SSL cipher to use (implies --ssl).
  --ssl-key=name      X509 key in PEM format (implies --ssl).
  --ssl-crl=name      Certificate revocation list (implies --ssl).
  --ssl-crlpath=name  Certificate revocation list path (implies --ssl).
  --ssl-verify-server-cert
                      Verify server's "Common Name" in its cert against
                      hostname used when connecting. This option is disabled by
                      default.
  -t, --table         Output in table format.
  --tee=name          Append everything into outfile. See interactive help (\h)
                      also. Does not work in batch mode. Disable with
                      --disable-tee. This option is disabled by default.
  -u, --user=name     User for login if not current user.
  -U, --safe-updates  Only allow UPDATE and DELETE that uses keys.
  -U, --i-am-a-dummy  Synonym for option --safe-updates, -U.
  -v, --verbose       Write more. (-v -v -v gives the table output format).
  -V, --version       Output version information and exit.
  -w, --wait          Wait and retry if connection is down.
  --connect-timeout=# Number of seconds before connection timeout.
  --max-allowed-packet=#
                      The maximum packet length to send to or receive from
                      server.
  --net-buffer-length=#
                      The buffer size for TCP/IP and socket communication.
  --select-limit=#    Automatic limit for SELECT when using --safe-updates.
  --max-join-size=#   Automatic limit for rows in a join when using
                      --safe-updates.
  --secure-auth       Refuse client connecting to server if it uses old
                      (pre-4.1.1) protocol.
  --server-arg=name   Send embedded server this as a parameter.
  --show-warnings     Show warnings after every statement.
  --plugin-dir=name   Directory for client-side plugins.
  --default-auth=name Default authentication client-side plugin to use.
  --binary-mode       By default, ASCII '\0' is disallowed and '\r\n' is
                      translated to '\n'. This switch turns off both features,
                      and also turns off parsing of all clientcommands except
                      \C and DELIMITER, in non-interactive mode (for input
                      piped to mysql or loaded using the 'source' command).
                      This is necessary when processing output from mysqlbinlog
                      that may contain blobs.

Variables (--variable-name=value)
and boolean options {FALSE|TRUE}  Value (after reading options)
--------------------------------- ----------------------------------------
abort-source-on-error             FALSE
auto-rehash                       FALSE
auto-vertical-output              FALSE
character-sets-dir                (No default value)
column-type-info                  FALSE
comments                          FALSE
compress                          FALSE
debug-check                       FALSE
debug-info                        FALSE
database                          (No default value)
default-character-set             auto
delimiter                         ;
vertical                          FALSE
force                             FALSE
named-commands                    FALSE
ignore-spaces                     FALSE
init-command                      (No default value)
local-infile                      FALSE
no-beep                           FALSE
host                              localhost
html                              FALSE
xml                               FALSE
line-numbers                      TRUE
unbuffered                        FALSE
column-names                      TRUE
sigint-ignore                     FALSE
port                              3306
progress-reports                  TRUE
prompt                            \N [\d]>
quick                             FALSE
raw                               FALSE
reconnect                         TRUE
shared-memory-base-name           (No default value)
socket                            C:/xampp/mysql/mysql.sock
ssl                               FALSE
ssl-ca                            (No default value)
ssl-capath                        (No default value)
ssl-cert                          (No default value)
ssl-cipher                        (No default value)
ssl-key                           (No default value)
ssl-crl                           (No default value)
ssl-crlpath                       (No default value)
ssl-verify-server-cert            FALSE
table                             FALSE
user                              (No default value)
safe-updates                      FALSE
i-am-a-dummy                      FALSE
connect-timeout                   0
max-allowed-packet                16777216
net-buffer-length                 16384
select-limit                      1000
max-join-size                     1000000
secure-auth                       FALSE
show-warnings                     FALSE
plugin-dir                        (No default value)
default-auth                      (No default value)
binary-mode                       FALSE 
```

* * *

## 回答 #7

> 赞同：8
> 
> 时间：2012-03-08T17:36:22.920

阿杰，

您看不到其他表的原因是您需要以“root”身份登录才能看到它们

```
mysql -h localhost -u root 
```

* * *

## 回答 #8

> 赞同：4
> 
> 时间：2016-01-02T04:47:11.473

去`/xampp/mysql/bin` 寻找`mysql. exe`

打开`cmd`，写入后将目录更改为mysq`cmd`

`mysql -h localhost -u root`

* * *

## 回答 #9

> 赞同：4
> 
> 时间：2016-10-24T07:03:52.620

**Xampp 控制面板 v2.3.1** 使用 -h localhost 时出现错误

# mysql -h 本地主机 -u 根

```
ERROR 2003 (HY000): Can't connect to MySQL server on 'localhost' (10060) 
```

因此，如果您按原样安装 xampp 并且没有自定义任何 documentroot、serverroot 等，那么以下工作：-

> 在 xampp 控制面板上启动这两个服务单击 shell 输入：# mysql -h 127.0.0.1 -u root

效果很好。以下是日志记录：-

```
# mysql -h 127.0.0.1 -u root
Welcome to the MySQL monitor.  Commands end with ; or \g.
Your MySQL connection id is 1
Server version: 5.6.21 MySQL Community Server (GPL)

Copyright (c) 2000, 2014, Oracle and/or its affiliates. All rights reserved.

Oracle is a registered trademark of Oracle Corporation and/or its
affiliates. Other names may be trademarks of their respective
owners.

Type 'help;' or '\h' for help. Type '\c' to clear the current input statement.

mysql> 
```

* * *

## 回答 #10

> 赞同：3
> 
> 时间：2017-05-08T17:23:23.020

在终端：

```
cd C:\xampp\mysql\bin

mysql -h 127.0.0.1 --port=3306 -u root --password 
```

`ENTER`如果密码为空字符串，则命中。现在您进入了。您可以列出所有可用的数据库，并使用以下命令选择一个：

```
SHOW DATABASES;
USE database_name_here;

SHOW TABLES
DESC table_name_here
SELECT * FROM table_name_here 
```

记住`;`每个 SQL 语句末尾的“”。

Windows cmd 终端不是很好，不支持`Ctrl`+ `C`、`Ctrl`+ `V`（复制、粘贴）快捷方式。如果您打算在终端中大量工作，请考虑安装替代终端 cmd 行，我使用**cmder**终端 -[下载页面](http://cmder.net/)

* * *

## 回答 #11

> 赞同：3
> 
> 时间：2018-10-21T10:09:56.303

要在 Windows 中访问 MySQL，您需要安装 XAMPP。

*   打开 XAMPP 控制面板并启动 MySQL。
*   现在转到命令提示符并打开

    ```
    C:\>cd xampp
    C:\xampp>cd MySQL 
    C:\xampp\mysql>cd bin 
    C:\xampp\mysql\bin>mysql -h localhost -u root 
    ```

您的数据库现在可以执行了。

* * *

## 回答 #12

> 赞同：3
> 
> 时间：2019-04-11T09:00:22.140

我遇到过同样的问题。首先，这就是我所拥有的：

1.  赢得 10
2.  `xampp`
3.  重击

我这样做是为了解决我的问题：

1.  转到搜索框（PC）
2.  录音这个`environnement variable`
3.  转到“路径”点击“编辑”
4.  添加这个`"%systemDrive%\xampp\mysql\bin\" C:\xampp\mysql\bin\`
5.  点击确定
6.  转到***Git Bash***并右键单击它并打开它并***以管理员身份运行***
7.  如果您的密码为空或您确实有密码，请在您的***Git Bash上正确设置*** `winpty mysql -u root``winpty mysql -u root -p`

* * *

## 回答 #13

> 赞同：2
> 
> 时间：2016-02-15T01:19:03.057

[运行 xampp shell 以解决使用 pw 连接到 root 的问题](http://i.stack.imgur.com/aFzbh.jpg)

`mysql -h localhost -u root -p` 并输入root pw

* * *

## 回答 #14

> 赞同：2
> 
> 时间：2017-04-26T05:09:11.707

要通过命令行访问 SQL，我们只需导航到 xampp 文件夹。该文件夹通常位于 c:\ 驱动器上。

1.  输入：cd c:\xampp\mysql\bin 然后按回车键。
2.  输入：`in mysql -u root -p` 然后按回车。
3.  在新行中输入数据库的密码。
4.  类型：显示数据库；查看您有权访问的所有数据库。
5.  一旦您知道要使用的数据库类型（例如 cms_database）、类型`use cms_data`或任何其他 db_name，它应该说 Database changed

// 额外注意，在使用数据库时，您不应该使用 root 用户。您可能希望创建一个具有特殊权限的单独帐户（例如 cms_user）来限制错误。

做那种类型：

```
GRANT ALL PRIVILEGES IN cms_database.*
TO 'cms_user'@'localhost' 
IDENTITIED BY 'yourpassword' 
```

使用命令仔细检查：

```
SHOW GRANT FOR 'cms_user'@localhost; 
```

如果您已经有了用户名和要使用的特定数据库，请将步骤 2 更改为此。

```
mysql -u cms_user -p cms_database 
```

* * *

## 回答 #15

> 赞同：1
> 
> 时间：2018-09-21T06:12:03.947

对于窗户

```
cd\xampp\mysql\bin
mysql -u root -p 
```

linux打开mysql的简单命令：

```
sudo /opt/lampp/bin/mysql 
```

* * *

## 回答 #16

> 赞同：1
> 
> 时间：2021-09-26T13:59:38.490

进入 MySQL 的命令行界面，我发现：

```
C:\xampp\mysql\bin\mysql -u root 
```

# c++ - 在 Windows 移动设备上监控每个线程的 CPU 使用率

> ID：698921
> 
> 赞同：3
> 
> 时间：2009-03-30T20:42:33.107
> 
> 标签：c++, windows, performance, windows-ce, cpu

是否可以以编程方式 (c++) 在 Windows Mobile（或 CE 5）设备上测量每个线程的 CPU？如果不是，它们是否是一个可以监控进程 CPU 使用率的实用程序？

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2009-03-30T23:35:51.117

CPU 使用率无法直接测量，因为与 x86 不同，ARM 处理器没有针对它的寄存器。您可以使用[Toolhelp API](http://msdn.microsoft.com/en-us/library/aa914815.aspx)计算它以获取进程及其子线程的列表，然后使用[GetThreadTimes](http://msdn.microsoft.com/en-us/library/aa909163.aspx)来计算每个线程使用了多少时间。

请记住，执行此计算会直接影响 CPU 的使用量。

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2009-09-30T17:07:16.300

有人在PC上写了一个看起来很像任务管理器的工具： [http ://www.vttoth.com/LPK/taskmanager.html](http://www.vttoth.com/LPK/taskmanager.html)

正如 ctacke 所说，它似乎确实使用了大量的 CPU。它报告在我们的 800MHz ARM 设备上使用了大约 15%-30% 的 CPU。

# java - 休眠对象与数据库物理模型

> ID：698922
> 
> 赞同：2
> 
> 时间：2009-03-30T20:42:47.257
> 
> 标签：java, performance, hibernate

当休眠对象模型和数据库物理模型不再匹配时，是否存在任何实际问题 - 例如性能？有什么顾虑吗？他们应该保持同步吗？

我们当前的系统最初是为少数用户设计的，因此没有做太多努力来保持物理和对象的同步。开发人员继续他们的任务，而架构师没有监控。现在我们正在将遗留系统重写/导入到新系统中，有人担心遗留系统处理大量用户量并可能使新系统崩溃。

**更新 20090331**
来自 Pete 下面的评论 - 关注的是数据层与对象层中的表/数据关系。如果两者之间没有依赖关系，那么如果这些关系不匹配，就不会影响性能？那是对的吗？

我认为，开发团队花费大量时间“调整”休眠查询/对象，但在数据库层没有任何工作来提高应用程序的性能。我会假设他们会在两个层次上进行调整。

这些问题可能只是因为最初的数据库设计不佳，并试图通过使用 Hibernate 来弥补/弥补差异吗？

（我是这个项目的新手，所以追赶）

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-03-31T00:33:10.400

**更新：回应评论：** 除了 Hibernate 使用之外，优化数据库是至关重要的。仔细想想，在 hibernate 所做的所有工作之后，最终它只是查询数据库。如果数据库性能不佳（索引错误或缺失、表空间设置不当等），那么调整 Hibernate 的多少都没有关系。另一方面，如果您的数据库设置良好但 Hibernate 设置不正确（可能缓存设置不正确等，并且您返回数据库的次数超出了您的需要），那么性能将受到影响好。端到端调整系统始终很重要，但要从基础（数据库）开始并逐步完善。

**结束更新**

我很好奇您对“不匹配”的意思是什么-您的意思是已将列添加到未在休眠数据对象中表示的表中吗？表已添加？我认为这样的事情不会影响性能（如果您不插入/更新所有列，则更有可能是数据完整性）

一般来说，对象模型的目标不应该与数据库模式逐字匹配。您想要抽象底层数据复杂性/连接/规范化，这就是使用 Hibernate 之类的东西的全部意义所在。

因此，例如，假设您有（保持非常简单）“订单”和“订单商品”，

您的应用程序代码应该能够执行类似的操作

order.getItems()

不必知道在它下面是一对多的关系。hibernate 代码中的细节控制加载的完成方式（延迟、缓存等）。

如果这不能回答您的问题，请提供更多详细信息

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-03-30T20:49:30.720

你当然可以在 asm 中编写你的抽象层——“可能”（对开发人员来说是个可怕的词）会更快。

这是过早的优化——可能会破坏干净的项目布局。

正如在休眠手册中一样 - 优化可以有不同的方式 - 简单编码某些部分“可能”是其中的一部分。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-03-30T20:51:37.563

您描述的更改当然可能会导致性能问题。我原以为这应该是设计规范的一部分。
因此，在编写代码时，请牢记性能标准。

真正了解的唯一方法是将数据加载到测试环境中，然后运行一些测试。

这绝对应该在上线之前完成，因为它可能会产生一些非常有趣的结果。

# .net - 无效的回发或回调参数

> ID：698923
> 
> 赞同：0
> 
> 时间：2009-03-30T20:42:50.330
> 
> 标签：.net, postback, callback, modal-dialog, event-validation

这个问题好像以前也有人问过，但我感觉我的情况略有不同。

我有一个包含gridview 的页面。当按下按钮编辑gridview 中的一条记录时，该按钮首先执行一些客户端脚本，该脚本会弹出一个模式窗口以进行编辑（使用.onClientClick 设置）。从这个弹出窗口中，用户点击更新数据库并关闭窗口。一旦窗口关闭，按钮的服务器端代码应该会触发，这将调用函数来刷新gridview。相反，我收到错误消息：

> 无效的回发或回调参数。使用配置或页面启用事件验证。出于安全目的，此功能验证回发或回调事件的参数是否源自最初呈现它们的服务器控件。如果数据有效且符合预期，请使用 ClientScriptManager.RegisterForEventValidation 方法注册回发或回调数据以进行验证。

真正让我恼火的是，我在不同的页面上使用了完全相同的逻辑，而且效果很好。

关于如何避免这种情况的任何建议？

更新：我已经删除了添加客户端脚本的代码行，但仍然出现错误。所以我相当肯定它只是由回发引起的。经过仔细检查，我意识到实际上有一些 ListItems 以编程方式绑定到 DropDownLists。所以......我可能需要做 ClientScriptManager.RegisterForEventValidation 的事情......有人可以给我一个例子来说明这样做的语法是什么样的吗？似乎与 ScriptManager 对象的设置不同......

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-03-30T20:58:23.367

如果您的按钮是在代码隐藏中创建的（例如，您的`RowDataBound`事件创建了一个新实例`Button`并将其添加到单元格），那么您将需要`ID`在页面的 Control Events 阶段之前重新创建这些控件（具有相同的 s）生命周期。在事件中重新创建按钮`Load`应该可以正常工作。

如果您的控件已创建并且您已将处理程序附加到它们的事件，则此错误的最可能原因是 javascript 修改了您的 DOM/表单。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-03-30T21:08:22.267

这可能是一个棘手的调试。如果您不使用动态生成的控件，那么最大的罪魁祸首通常是客户端脚本修改了控件绑定到的数据。例如，使用 javascript 将另一个列表项添加到下拉列表将触发此错误，因为服务器会注意到添加的项不是原始数据的一部分。

如果您使用动态控件，则必须确保在每次回发时都以相同的方式创建控件及其数据。

每当我遇到不可调和的事件验证问题时，我通常会在页面上禁用它。这应该是一个安全问题，但我还没有看到依赖于事件验证的漏洞被关闭。实际上，也许我会在 SO 上问这个，看看是否有人知道。清理您的页面输入很容易，并且应该在不考虑事件验证是否会保护您的情况下完成。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-03-30T21:51:33.440

在页面指令中尝试这一行，一旦我遇到类似的错误，错误就解决了

```
EnableEventValidation="false" 
```

问候！！！

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2009-03-30T22:05:26.293

事件验证将尝试确保有人不会向页面添加与您第一次处理/呈现时允许的值不对应的值。根据您拥有的控件，如果您正在对 gridview 进行完全重新绑定，并且基础数据已更改，这可能会使页面上的“有效值”与回发中收到的不匹配。

取决于场景的一个选项是在这种情况下不使用回发，而是执行常规链接以刷新页面。或者，您可以按照建议执行 EnableEventValidation=false，但您需要额外确保您不依赖发送给客户端的任何值，即下拉列表可能包含不在您绑定的列表中的值。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2021-02-04T20:28:00.340

每次遇到这个问题都是因为我使用客户端脚本来操作服务器端对象。这可以在从服务器调用脚本但客户端尝试通过回发运行脚本时找到；它会弹出错误。

最好只使用带有客户端脚本的客户端对象。

* * *

## 回答 #6

> 赞同：-1
> 
> 时间：2014-07-31T12:47:05.717

我在创建 ASP.Net WebForm 并单击“提交”按钮时收到此错误。

HTML 是使用嵌套在标签中的标签创建的，浏览器将嵌套标签视为关闭 ASP.Net 表单。结果，__EVENTVALIDATION 隐藏字段位于表单之外，并且未发送到服务器。

从标记中清除嵌套标签解决了这个问题。

我知道您的问题已得到解决，但我希望这可以帮助遭受同样痛苦的人。

# linux - 在 Linux 中使用索引的文件搜索算法

> ID：698943
> 
> 赞同：4
> 
> 时间：2009-03-30T20:48:20.207
> 
> 标签：linux, algorithm

我想在linux中使用索引来实现一个文件搜索程序......我知道还有其他几个文件搜索程序，比如beagled。但我这样做是出于学习目的......我对如何进行索引感到震惊..我有以下想法，我从 maemo-mapper 应用程序中获得......例如，如果你有一个名为“suresh”的文件，它的索引在文件系统作为文件...

/home/$USERNAME/.file_search_index/s/u/r/e/s/h/list.txt ..这个list.txt包含所有文件的位置名称=“suresh”...请提出一个更好的主意/算法来实现它......如果有关于各种文件搜索技术的任何材料，请发布......

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2009-03-30T22:03:13.133

[您还没有看到findutils](http://www.gnu.org/software/findutils/)附带的 locate 命令吗？与 beagled 一样，它是免费软件，因此您可以研究代码。

findutils 包一直在寻找贡献者。

有关数据库格式的信息位于[http://www.gnu.org/software/findutils/manual/html_node/find_html/Database-Formats.html](http://www.gnu.org/software/findutils/manual/html_node/find_html/Database-Formats.html)

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2009-03-31T04:50:24.027

Beagle 对 inotify 使用了一种非常有趣的方法。它启动，在父目录上建立监视并启动另一个执行递归扫描的线程。随着越来越多的目录被访问，父级会看到它们并添加更多的监视，同时查看它已经知道的内容。

因此，当它开始时，您可以非常便宜地观看一整棵树（每个目录一次观看）并为整个内容编制索引。这也有助于确保在扫描期间不会“遗漏”任何文件。

所以，这就是你的大部分战斗......通常 FS 搜索程序在索引时会遇到缓慢的点，例如“updatedb”。

至于存储索引，我不赞成在目录中拆分它。您实质上是在文件名数组中的每个字符上调用 stat() 。例如 some-very-long-shared-object-name.so.0 将是对名称中每个字符的一次调用 stat()。您可以尝试使用设计良好的 SQLite3 数据库。

我正在做一些非常相似的事情，一个为 PCI 认证（信用卡处理器）提供稍微便宜的审计手段的程序，而不使用内核审计钩子。

# web-services - 在 SharePoint 上运行的 SOAP Web 服务

> ID：698945
> 
> 赞同：1
> 
> 时间：2009-03-30T20:48:44.637
> 
> 标签：web-services, sharepoint, soap

我在 _layouts 目录下的共享点框上运行了一个 SOAP Web 服务，以及一个使用该 SOAP 服务的胖客户端。我们有一个使用基本身份验证的共享点框和另一个使用客户端证书的共享点框。我需要该 SOAP 服务来更新文档库中的一些列表项。除非我在提升的权限块中运行，否则我遇到的问题似乎没有任何效果。这是我正在尝试做的代码片段。

```
using (SPSite site = new SPSite(fileUrl))
using (SPWeb web = site.OpenWeb()) {
   // web.CurrentUser is always null unless in elevated privileges block.
   // do something with document library...
   web.Files.Add(...); // fails with access denied unless in elevated privileges block.
} 
```

我也尝试过“SPContext.Current.Web”，但即使我处于提升的权限块中，它也会为“web.CurrentUser”返回 null。

我真的不能使用提升的权限块，因为用户抱怨我的 SOAP 服务接触到的任何东西都被系统修改了。

在胖客户端中，我们使用如下代码......

```
HttpWebRequest request = (HttpWebRequest)WebRequest.Create(requestString);
if(basicAuth) {
   request.Credentials = System.Net.CredentialCache.DefaultCredentials;
}
else {
   X509Store store = new X509Store(StoreName.My, StoreLocation.CurrentUser);
   store.Open(OpenFlags.ReadOnly);
   foreach (X509Certificate2 certificate in store.Certificates) {
      request.ClientCertificates.Add(certificate);
}
request.GetResponse(); 
```

由于各种原因，我们手动构建 SOAP 请求。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-03-31T19:25:54.017

如果您希望您的 web 服务正确集成到共享点上下文中（即能够查询“当前共享点用户”），您应该真正将其部署到 _vti_bin（12 hyve 的 ISAPI 子文件夹），而不是 _layouts。

发现有点麻烦，需要手动调整文件（有关详细信息，请参阅[关于 SharePoint 中的自定义 Web 服务的 MSDN 文章](http://msdn.microsoft.com/en-us/library/ms464040.aspx)），但由于您手动构建请求，因此发现不应该成为问题。

**[编辑]**作为替代方案，您可以尝试获取 windows 身份验证用户的 SPUserToken，

```
SPUserToken token = web.AllUsers[WindowsIdentity.GetCurrent().Name].UserToken; 
```

然后使用此令牌以该用户身份打开站点和 Web。

# django - 在Django中锁定对象的最简单方法是什么

> ID：698950
> 
> 赞同：20
> 
> 时间：2009-03-30T20:49:20.687
> 
> 标签：django, concurrency

当其他一些用户在 update_object 视图中处于活动状态时，当用户尝试删除对象时，我想引发错误。我觉得为此需要某种类似互斥锁的锁定机制。你有什么建议吗？

* * *

## 回答 #1

> 赞同：29
> 
> 时间：2017-08-22T21:56:09.780

[select_for_update](https://docs.djangoproject.com/en/1.11/ref/models/querysets/#select-for-update)是获取对象锁定的最简单方法，前提是您的数据库支持它。根据 Django 文档，至少 PostgreSQL、Oracle 和 MySQL 支持它。

示例代码：

```
import time

from django.contrib.auth import get_user_model
from django.db import transaction

User = get_user_model()

@transaction.atomic
def my_example_function():
    my_user = User.objects.all()[0]

    print("Acquiring lock...")
    locked_user = User.objects.select_for_update().get(pk=my_user.pk)
    print(locked_user)

    while True:
        print("sleeping {}".format(time.time()))
        print("holding lock on {}".format(locked_user))
        time.sleep(5) 
```

请注意，您必须`select_for_update`在事务中使用，因此是`@transaction.atomic`装饰器。

* * *

## 回答 #2

> 赞同：16
> 
> 时间：2009-03-30T22:05:32.970

因此，有几种方法可以满足您的要求。但是其中很大一部分不会独立于实现：您可以使用锁或 rlock，但它们实际上只能在 100% 线程服务器上工作，而且可能根本不适用于 fork/pre-fork 实现。

这或多或少意味着锁定实现将取决于您。两个想法：

1.  `.lock`文件系统上的文件
2.  `locked`模型类中的属性

在这两种情况下，您都必须在更新时手动设置锁定对象，并在删除时对其进行检查。尝试类似：

```
def safe_update(request,model,id):
    obj = model.objects.get(id)
    if obj.locked:
        raise SimultaneousUpdateError #Define this somewhere
    else:
        obj.lock()
        return update_object(request,model,id)

# In models file
class SomeModel(models.Model):
    locked = models.BooleanField(default = False)
    def lock(self):
        self.locked = True
        super(models.Model,self).save()
    def save(self):
        # overriding save because you want to use generic views
        # probably not the best idea to rework model code to accomodate view shortcuts
        # but I like to give examples.
        self.locked = False
        # THIS CREATES A DIFFERENT CRITICAL REGION!
        super(models.Model,self).save() 
```

这确实是一个笨拙的实现，您必须清理它。您可能对创建了不同的关键区域这一事实感到不舒服，但是如果您将数据库用作实现而不使实现变得更加复杂，我不认为您会做得更好。（一种选择是使锁完全分离对象。然后你可以在调用 save() 方法后更新它们。但我不想编码。）如果你真的想使用基于文件的锁定系统，也能解决问题。如果您是数据库命中偏执狂，那么这可能适合您。就像是：

```
class FileLock(object):
    def __get__(self,obj):
        return os.access(obj.__class__+"_"+obj.id+".lock",os.F_OK)
    def __set__(self,obj,value):
        if not isinstance(value,bool):
            raise AttributeError
        if value:
            f = open(obj.__class__+"_"+obj.id+".lock")
            f.close()
        else:
            os.remove(obj.__class__+"_"+obj.id+".lock")
    def __delete__(self,obj):
        raise AttributeError

 class SomeModel(models.Model):
     locked = FileLock()
     def save(self):
         super(models.Model,self).save()
         self.locked = False 
```

无论如何，也许有一些方法可以根据您的口味混合和匹配这些建议？

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2009-03-30T23:55:22.677

由于您的范围仅限于删除而不是更新，因此一种选择是将“删除”的想法重新考虑为“取消发布”操作。例如，采用以下模型：

```
class MyManager(models.Manager):
    def get_query_set(self):
        super(MyManager, self).get_query_set().filter(published=True)

class MyModel(models.Model):
    objects = MyManager()
    published = models.BooleanField(default=True)
    ... your fields ...

    def my_delete(self):
        self.published = False
        super(MyModel, self).save()

    def save(self):
        self.published = True
        super(MyModel, self).save() 
```

这样，无论何时提交编辑，所有用户都可以看到它……但其他人仍然可以自由删除项目。这种技术的一个优点是您不必有任何额外的逻辑来锁定项目并向用户呈现不同的 UI。缺点是在 db 表中使用了额外的空间，并且删除的项目“神奇地”重新出现的罕见情况。

（这可能只是一个起点。如果您走这条路，您可能希望根据您的用例对这个想法进行修改。）

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2009-03-30T21:13:55.310

我建议使用简单的读写锁，因为您不想阻止用户同时访问该对象（仅来自编辑）。

执行此操作的一般方法是创建一个维护活跃读者计数的函数。当您需要写入该对象时，您将创建另一个函数来阻止新读者访问（想想维护页面），并可能重定向现有读者。一旦没有更多的读者，您将完成您的写入，然后解锁对象。

# c# - 有什么可以用 C# 事件做而不能用 VB 事件做的事情吗？

> ID：698956
> 
> 赞同：3
> 
> 时间：2009-03-30T20:50:01.297
> 
> 标签：c#, vb.net, events, delegates

我的朋友主要是一名 VB 开发人员，他一次又一次地说，在 VB 中编写事件比 C# 简单得多。我对这个问题的看法是它可能更容易，但如果没有增加复杂性的原因，他们可能会在 C# 中让它变得简单。谁能告诉我是否有任何额外的灵活性或任何能力，一般来说，可以用 C# 事件而不是 VB.Net 事件来完成？

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2009-03-30T20:54:29.910

对于 C#，唯一想到的是能够使用匿名函数订阅 void 返回事件（实际上是所有事件）。VB.Net 9.0 仅支持返回值的 Lambda 表达式（这在 VB 10.0 中已修复）。

VB 在事件方面有一点 C# 中没有的灵活性

*   支持[轻松的代表](http://www.developer.com/net/vb/print.php/3664491)。这允许 VB 使用仅需要事件类型中的一部分参数的事件处理程序（主要与空参数函数一起使用）
*   与 C# 相比，Handles 子句使删除设计器生成事件变得更加容易，您必须在 .Designer.cs 文件中进行挖掘
*   RaiseEvent 关键字使空事件检查问题在 VB.Net 中不存在

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2009-03-30T20:52:50.353

大多数时候我更喜欢 VB 而不是 C#，但我对两者都很流利。

在我的脑海中，有两个地方我知道 VB.Net 使它变得更容易。一个是您不必`null`在引发事件之前进行检查。那里可能会有一些权衡，但我不知道。

另一个是`Handles`关键字的添加。您可以声明一个完整的方法来处理事件并将其连接到一个语句中的事件。这对于 VB 来说是一个明显的优势，因为您仍然可以在没有该关键字的情况下以长格式执行所有操作。这只是额外的一小块语法糖。在 C# 中可以做到这一点的唯一方法是使用 lambda 表达式/匿名委托。

语法的其余部分几乎是一个洗涤：你更喜欢“ `+=`”还是“ `AddHandler`”？

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2009-03-30T20:54:28.197

使用VB，你不能暗示一个签名，而不是说明一个委托类型吗？

```
Public Event OnChange(ByVal Text As String) 
```

我不确定这是一件好事，但是...

另外 - 不会`RaiseEvent`自动处理空值（非订阅事件）？微不足道的做，当然。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2009-03-30T21:14:32.423

您的朋友可能习惯于通过从源代码页顶部的两个组合框中选择控件和事件来创建事件处理程序。在 C# 中，您手动编写 += 处理程序。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2009-04-03T14:18:31.947

在 C# 中，您可以拥有虚拟事件并在派生类中覆盖它们。VB.NET 中没有这样的东西。

# objective-c - 从 Cocoa 中的 C 方法访问属性

> ID：698957
> 
> 赞同：1
> 
> 时间：2009-03-30T20:50:02.637
> 
> 标签：objective-c, cocoa, cocos2d-iphone, chipmunk

我正在尝试学习 Objective C 和 Cocoa，但我无法访问对象内的属性。特别是来自 C 方法的对象。我正在使用花栗鼠动态库。

Chipmunk 有一个类似于 NSPoint 的东西，叫做 cpVect。现在我在我的对象中定义一个 cpVect 没有问题，但是当我尝试使用 @property 和 @synthesize 制作访问器时，我不断收到错误：所以

```
@interface ControlsLayer : Layer {
    Sprite * touchMarker, *dragMarker;
    cpVect * forceVector;
} 
```

工作正常

但

```
@interface ControlsLayer : Layer {
    Sprite * touchMarker, *dragMarker;
    cpVect * forceVector;
}

@property (retain) cpVect forceVector;

@end 
```

给我错误`"property 'forceVector' with 'retain' must be of object type"`

所以没有“保留”我会得到一个不同的错误

```
"type of property 'forceVector' does not match type of ivar 'forceVector'" 
```

我正在兜圈子试图弄清楚这一点，有没有我可以使用的特定类型，它是花栗鼠和可可之间的不兼容，还是......或者......我不知道。Chipmunk 对文档非常了解，我发现的所有示例似乎都没有使用对象，所有示例都只使用一个类来处理所有内容。

任何帮助，非常感谢。这件事快把我逼疯了。

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2009-03-30T20:56:53.087

您得到的错误是因为`retain`（即引用计数内存管理，setter 增加新值的引用计数并减少旧值的引用计数）的语义仅对 Objective-C 对象有意义。属性的默认语义是`retain`，但您可以指定属性`assign`如下：

```
@property (assign) cpVect *forceVector; 
```

我假设该属性实际上是 a `cpVect*`，而不是`cpVect`您所写的 a 。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2009-03-30T20:57:42.040

您在实例变量中有一个指向 cpVect 的指针，但在您的属性中没有。

试试这个：

`@property (assign) cpVect * forceVector;`

# ruby-on-rails - 在具有关系的表单中自动填充 ID

> ID：698961
> 
> 赞同：2
> 
> 时间：2009-03-30T20:51:00.590
> 
> 标签：ruby-on-rails, ruby, forms, session, relational

我创建了一个博客，它会有帖子，并且帖子是由用户创建的。我的博客中已经有一个登录系统。我已经建立了用户和他的帖子之间的关系。现在，当我想添加新帖子时，我希望 Rails 自动填充 user_id 字段。

我应该添加一个隐藏字段并从我保存它的会话中添加 user_id 吗？

还是 Ruby on Rails 有自己的方式来处理关系和使用 ID？

@编辑：

该模型：

```
class Post < ActiveRecord::Base
  validates_presence_of :subject, :body
  has_many :comments
  belongs_to :user 
end 
```

控制器：

```
....
  def new
    @post = Post.new

    respond_to do |format|
      format.html # new.html.erb
      format.xml  { render :xml => @post }
    end
  end
... 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2009-03-31T03:56:58.773

如果您想确保博主的帖子与正确的用户相关联，那么根本不要为此使用表单字段，因为最终用户可以更改它们的值。最好依靠您拥有的登录系统，并在提交博客文章表单时执行以下操作：

```
def create
  @post = current_user.posts.build(params[:post])
  if @post.save
    ...
  else
    ...
  end
end 
```

这是假设您有一个`current_user`方法，可能在 application.rb 中，通过您的登录系统获取当前用户。也许是这样的：

```
def current_user
  @current_user ||= User.find(session[:user_id])
end 
```

并假设您已经放入`has_many :posts`了 User.rb。

# java - 检查 ClientSocket 是否已在 java 中断开连接挂起

> ID：698964
> 
> 赞同：4
> 
> 时间：2009-03-30T20:51:57.937
> 
> 标签：java, sockets

这是对以下内容的跟进：

[这个问题](https://stackoverflow.com/questions/495922/what-is-the-best-way-to-implement-a-heartbeat-in-c-to-check-for-socket-connecti)

基本上，我有一个服务器循环来管理与一个单独客户端的连接。在循环中的某一时刻，如果存在 ClientSocket，它会尝试读取以检查客户端是否仍然连接：

```
if (bufferedReader.read() == -1) {
    logger.info("CONNECTION TERMINATED!");
    clientSocket.close();
    setUpSocket(); // sets up the server to reconnect to the client
} else {
    sendHeartBeat(); // Send a heartbeat to the client
} 
```

问题是，一旦创建了套接字，应用程序将在读取时挂起，我假设等待永远不会到来的数据，因为客户端永远不会发送到服务器。在此之前没问题，因为这正确处理了断开连接（当客户端断开连接时读取最终会失败）并且循环将尝试重新建立连接。但是，我现在添加了上面的 sendHeartBeat() 方法，它会定期让客户端知道服务器仍在运行。如果读取保持线程，那么心跳永远不会发生！

所以，我假设我正在测试连接是否仍然不正确。作为一个快速破解，我可以在单独的线程中运行 bufferedReader.read()，但是我会遇到各种我真的不想处理的并发问题。

所以问题有几个：

1.  我是否正确检查客户端断开连接？
2.  如果没有，我该怎么做？
3.  如果我做对了，我如何才能让阅读不把进程当作人质？还是线程是唯一的方法？

* * *

## 回答 #1

> 赞同：9
> 
> 时间：2009-03-30T21:20:10.553

创建套接字时，首先设置超时：

```
private int timeout    = 10000;
private int maxTimeout = 25000;

clientSocket.setSoTimeout(timeout); 
```

有了这个，如果读取超时，你会得到`java.net.SocketTimeoutException`（你必须抓住）。因此，你可以做这样的事情，假设你之前设置了 SO_TIMEOUT 如上所示，并假设心跳总是会从远程系统得到响应：

```
volatile long lastReadTime;

try {
    bufferedReader.read();
    lastReadTime = System.currentTimeMillis();
} catch (SocketTimeoutException e) {
    if (!isConnectionAlive()) {
        logger.info("CONNECTION TERMINATED!");
        clientSocket.close(); 
        setUpSocket(); //sets up the server to reconnect to the client
    } else {
        sendHeartBeat(); //Send a heartbeat to the client
    }
}

public boolean isConnectionAlive() {
    return System.currentTimeMillis() - lastReadTime < maxTimeout;
} 
```

处理此问题的常用方法是将超时设置为某个数字（例如 10 秒），然后跟踪您最后一次从套接字成功读取的时间。如果您的超时时间已过 2.5 倍，则放弃客户端并关闭套接字（从而向另一端发送一个 FIN 数据包，以防万一）。

如果心跳*不会*从远程系统得到任何响应，而只是在连接断开时最终生成 IOException 的一种方式，那么您可以这样做（假设 sendHeartBeat 本身不会抛出 IOException）：

```
try {
    if (bufferedReader.read() == -1) {
        logger.info("CONNECTION TERMINATED with EOF!");
        resetConnection();
    }
} catch (SocketTimeoutException e) {
    // This just means our read timed out ... the socket is still good
    sendHeartBeat(); //Send a heartbeat to the client
} catch (IOException e) {
    logger.info("CONNECTION TERMINATED with Exception " + e.getMessage());
    resetConnection();
}

....

private void resetConnection() {
    clientSocket.close(); 
    setUpSocket(); //sets up the server to reconnect to the client
} 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-03-30T21:38:52.240

您检查正确，您可以添加一个带有 IOException 的 try catch，以防它发生。

有一种方法可以避免线程，您可以使用带有非阻塞套接字的选择器。

```
public void initialize(){
  //create selector
  Selector selector = Selector.open();
  ServerSocketChannel acceptSocket = ServerSocketChannel.open();
  acceptSocket.configureBlocking(false);
  String bindIp = "127.0.0.1";
  int bindPort = 80;
  acceptSocket.socket().bind(new InetSocketAddress(bindIp, bindPort));
  //register socket in selector for ACCEPT operation
  acceptSocket.register(selector, SelectionKey.OP_ACCEPT);
  this.selector = selector;
  this.serverSocketChannel = serverSocketChannel;
}

public void serverStuff() {
   selector.select(maxMillisecondsToWait);
   Set<SelectionKey> selectedKeys = selector.selectedKeys();
   if( selectedKeys.size() > 0 )
   {
      if( key.isAcceptable() ){
        //you can accept a new connection
        SocketChannel clientSk = serverSocketChannel.accept();
        clientSk.configureBlocking(false);
        //register your SocketChannel in the selector for READ operations
    clientSk.register(selector, SelectionKey.OP_READ);
      } else if( key.isReadable() ){
        //you can read from your socket.
        //it will return you -1 if the connection has been closed
      }
   }

   if( shouldSendHeartBeat() ){
     SendHeartBeat
   }
} 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-03-30T21:19:16.077

您应该在断开连接检测中添加错误检查。有时，当与另一端的连接丢失时，可能会引发 IOException。

恐怕这里的线程是不可避免的。如果您不想阻止代码的执行，则需要创建一个单独的线程。

# c++ - WM_CREATE 中的 InvalidateRect 不起作用

> ID：698967
> 
> 赞同：2
> 
> 时间：2009-03-30T20:53:10.600
> 
> 标签：c++, c, windows, winapi

我想在创建窗口时使其无效。我怎样才能做到这一点？在 WM_CREATE 期间调用 InvalidateRect 不起作用。

问题是我在 WM_CREATE 中调用 SetWindowLongPtr 并设置 GWLP_USERDATA。WM_PAINT 在 USER_DATA 中查找一些指针，但是当我第一次收到 WM_PAINT 时，数据显然不在那里，所以它不会绘制我的东西。

也试过这个：

```
#define MyDefinedMsg (WM_APP+1)
//...//
case WM_CREATE:
  //...//
  SetWindowLongPtr(hWnd,GWLP_USERDATA,ptr);
  PostMessage(hWnd,MyDefinedMsg,0,0);

  break;
case MyDefinedMsg: 
  InvalidateRect(hWnd,NULL,TRUE);
  break; 
```

但没有用。

提前致谢

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2009-03-30T21:06:55.607

1.  您的窗口在创建时已经无效
2.  `WM_CREATE/WM_SIZE/WM_PAINT`PostMessage 将消息放入队列中，因此很可能在常规创建消息（等）之后到达。

如果您的绘画由于 GWLP_USERDATA 为 NULL 而失败，那么正在发生其他事情......

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-03-30T21:16:29.483

`::UpdateWindow(...)`打电话后尝试，`::CreateWindow(...)`而不是发送您的消息。

# c - 请问我能得到关于在哪里关注格式化的提示吗？

> ID：698973
> 
> 赞同：0
> 
> 时间：2009-03-30T20:54:41.487
> 
> 标签：c, arrays, arguments, sum

该程序应该计算参数的数量，迭代参数列表，对于每个参数，将参数转换为整数并将其复制到数组，迭代数组的元素，将每个元素的值添加到变量（这计算元素的总和），并打印总和。参数不会超过 15 个。到目前为止，我有：

```
int sumofA (int sizeofA, int x, int y){  
  int i = sizeofA;  
   if (i <= 15){  
      int z = x + y;  
      return z;  
   }  
}  

int main (int argc, char*argv[]){    
   int sizeofA = argc - 1;  
   int i = 1;  
   while (i <= sizeofA){  
      int x = GetInt (argc, argv, i);  
      i = i + 1;  
      int y = GetInt (argc, argv, i);     
      printf ("%d\n", sumofA (sizeofA, x, y));
   }  
   return 0;  
} 
```

好的，现在（当给定三个参数而不是 ./a 时）它打印第一个参数和第二个参数的总和......然后是第二个和第三个......然后是第三个参数的值。为什么？

这是 GetInt 的代码（我必须使用它）：

```
int GetInt (int argc, char * argv[], int i) {  
   if (i < 0 || i >= argc) return 0;  
   return atoi(argv[i]);  
} 
```

我是否需要通过并将每个参数分配给一个整数（例如`int z = GetInt (argc, argv, i + 2)`）？

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2009-03-30T21:03:17.083

这里有几个问题：

*   ~~i 未在 sumofA 中定义，因此与之比较会产生未定义的行为。~~
*   如果 i >= 15，则不清楚 sumofA 将返回什么。
*   ~~你在循环内返回；这肯定不是你想要的。~~
*   ~~您的代码实际上并未在数组 A 中存储任何内容。~~

请在所有警告标志上编译您的代码（gcc：-Wall -Werror -pedantic），并确保在您的代码编译时*没有*警告。

请注意，不需要变量*大小*：使用*while (i < argc)*。

**编辑：**现在您添加了*GetInt*的代码，替换

```
GetInt (argc, argv, i); 
```

和

```
atoi(argv[i]); 
```

*GetInt*没有用，因此您可以完全删除它。

最后：在您的问题中，您提到将数字存储在数组中，然后对它们求和。你*想*这样做，还是*需*要这样做（由于某些任务？）因为没有必要：只需将所有调用的结果添加到*atoi*。那么数组*A*是多余的。

**编辑 2：**我看到您在某些地方修复了代码。您的代码当前（23:31 CEST）将第一个参数分别添加到每个参数并打印它们。你还没到那一步。祝你好运！

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2009-03-30T20:59:52.597

你的问题在这里：

```
 int x = GetInt (argc, argv, 1);
 int y = GetInt (argc, argv, i); 
```

当您第一次通过循环时，i 是什么，它会打印出什么？第二次通过循环呢？

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2009-03-30T21:00:18.790

对于初学者，您在循环的第一次迭代后返回 0。

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2009-03-30T22:59:49.080

由于您需要格式化帮助...

`=`首先，C 有更多的赋值运算符，而不仅仅是`x = x + 1`. 大多数语言（包括 C 语言）都提供了一个`+=`运算符，如下所示：`x += 1`. 这与 做同样的事情`x = x + 1`，而且更好。语法糖，但糖很好吃。

当我们谈到它时，C 和许多其他语言为`+= 1`- `++`C++ 得名的运算符提供了一种特殊情况。所以真的，`x = x + 1`可以重写为`x++`具有*完全相同的效果*。`x++`但是请注意，和之间存在主要区别`++x`，但目前这并不重要。现在，使用您想要的任何一个，并确保将其单独放在自己的行上，直到您了解 和 之间的`x++`区别`++x`。

如果你发现你有一个你正在使用一次的变量，不要使用它。而不是这个：

```
int sizeofA = argc - 1;
...
while (i <= sizeofA){
  ...
  printf ("%d\n", sumofA (sizeofA, x, y));
} 
```

试试这个：

```
...
while (i <= argc - 1){
  ...
  printf ("%d\n", sumofA (argc - 1, x, y));
} 
```

或者（可能更好）：

```
...
while (i < argc){
  ...
  printf ("%d\n", sumofA (argc - 1, x, y));
} 
```

第三，你不应该盲目地将你的整个参数列表传递给它，只传递你当前想要转换的参数，但这是另一个问题，我想你不能改变`GetInt()`. 这似乎是另一天的战斗。

（第四，为什么这是一个社区 Wiki 问题？）

第五，我认为你的逻辑是错误的——如果你从 1 开始，我认为你不想在列表结束之前停止 1。但这是一个简单的错误，您可以稍后在您确定这实际上是错误时修复它。

最后，我建议您定义一个变量 , `int answer`，而不是`printf()`ing列表中的*所有*元素，只需遍历列表，将每个元素的数值添加到`answer`, 然后最后，打印输出`answer`。但也许我错过了任务的重点。或者，每次您遍历循环时，打印出`answer`，这样您就可以看到值每次都正确增长。我认为这更接近你在作业中真正想要做的，但我不能花时间检查，因为我有课要上。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2009-03-30T21:05:00.493

第一次通过你的循环 x 和 y 都被赋予相同的值（因为 i=1），它们的总和被打印出来，然后函数返回结束你的程序。因此，您将获得第一个增值。

# windows - 学习音频处理

> ID：698974
> 
> 赞同：4
> 
> 时间：2009-03-30T20:55:22.187
> 
> 标签：windows, audio, theory, audio-recording

我想了解如何构建像 CakeWalk、Cubase 和 ProTools 这样的应用程序。有没有什么好的资源来学习这种类型的开发？

**资源**

*   [数字信号处理基础](http://www.dsptutor.freeuk.com/)

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2009-03-30T21:36:02.480

如果您想了解这些程序的功能是如何实现的（我说的是滤波、合成、混合等），请尽可能多地阅读有关**数字信号处理**(DSP) 的内容。如果您碰巧能够在学院或大学参加 DSP 课程，您可能会从中获得很多有用的信息。（我自己也上过几门这样的课，它们很棒）除此之外，还有几十本关于 DSP 各个方面的书籍和研究论文；试着找到一个（或几个）好的并潜入其中。谷歌搜索绝对可以让你开始。

如果您想了解更多有关音频编程的一般信息，即如何访问操作系统的音频资源（麦克风/扬声器/等），我想我可以回应 Dan 关于 Audacity 的建议...

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2009-03-30T21:03:59.780

[Audacity](http://audacity.sourceforge.net/)的人可能会提供帮助。参与开源项目是帮助社区和获得新技术指导的好方法。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2018-07-05T02:12:16.373

任何对此主题感兴趣并了解有关数字音乐技术的更多信息的人也可以查看[https://ardour.org/](https://ardour.org/) - 一个正在开发中的开源数字音频工作站，并拥有一个活跃的开发者社区。[http://community.ardour.org/community](http://community.ardour.org/community)。

*“Ardour 是一个由音乐家、程序员和专业录音工程师组成的全球团队的开源协作成果。开发是透明的——任何人都可以看到我们的工作。就像一件好的老式硬件一样，你可以打开盒子然后看看里面。 ”*

# asp.net-mvc - mvc 1.0 和 DLL 位置

> ID：698975
> 
> 赞同：3
> 
> 时间：2009-03-30T20:55:49.800
> 
> 标签：asp.net-mvc

[Scott](http://media.wiley.com/assets/1539/15/professionalaspnet35mvc_chapter13.pdf)说我们在 BIN 文件夹中需要这 3 个 DLL：1 - System.Web.Abstractions.dll，2 - System.Web.Mvc.dll，和 3 - System.Web.Routing.dll

我在 Windows 2008 x64 上安装了[AspNetMVC1.msi](http://www.microsoft.com/downloads/details.aspx?FamilyID=53289097-73ce-43bf-b6a6-35e00103cb4b&displaylang=en)并找到了这个文件，但其他文件似乎在运行中丢失了。有任何想法吗？

C:\Program Files (x86)\Microsoft ASP.NET\ASP.NET MVC 1.0\Assemblies\System.Web.Mvc.dll 和 xml 但其他 2 隐藏在其他地方？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-03-30T20:58:13.913

其他文件是 .NET Framework 的 SP1 的一部分。

它们位于目录 C:\Program Files\Reference Assemblies\Microsoft\Framework\v3.5\

当您安装 sp1 时，它们也会在 gac 中注册。

# sql - 有哪些方法可以提高 PostgreSQL 8 中正则表达式查询的性能？

> ID：698977
> 
> 赞同：5
> 
> 时间：2009-03-30T20:56:08.270
> 
> 标签：sql, regex, performance, postgresql

我正在对`character varying(256)`PostgreSQL 8.3.3 中的类型列执行正则表达式匹配。该列当前没有索引。如果可以的话，我想提高这个查询的性能。

添加索引会有帮助吗？我还有其他可以帮助提高性能的方法吗？

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2009-03-30T22:13:48.397

你不能创建一个可以加速任何通用正则表达式的索引；但是，如果您有一个或有限数量的正则表达式要与之匹配，那么您有几个选择。

正如 Paul Tomblin 所提到的，您可以使用额外的一列或多列来指示给定行是否与该正则表达式或正则表达式匹配。该列可以被索引并有效地查询。

如果您想更进一步，[本文](http://oak.cs.ucla.edu/~cho/papers/cho-regex.pdf)讨论了一种针对正则表达式进行索引的有趣技术，该技术涉及在正则表达式中查找长子字符串，并根据这些子字符串是否存在于文本中生成候选匹配项进行索引。这会过滤掉您实际需要检查正则表达式的行数。您可能可以使用[GiST](http://gist.cs.berkeley.edu/)索引来实现这一点，尽管这将是一项非常重要的工作。

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2009-03-30T20:58:17.127

索引不能用正则表达式做任何事情。您将不得不进行全表扫描。

如果可能的话，比如如果您一直在查询同一个正则表达式，您可以添加一个列来指定该行是否与该正则表达式匹配，并在插入和更新时维护它。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-03-30T20:59:32.100

正则表达式匹配在相当大的文本列上表现不佳。尝试在不使用正则表达式的情况下完成此操作，或者如果数据集不大，则在代码中进行匹配。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2009-03-30T21:01:28.193

这可能是您不想使用 RegEx 的时候之一。你的正则表达式代码是什么样的？也许这是加快速度的一种方式。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2009-03-31T05:39:12.990

如果您有一组有限的正则表达式要匹配，您可以创建一个表，其中包含表的主键和一个指示它是否与该正则表达式匹配的字段，您将在触发器上更新它，然后在该表中索引您的表键。这以更新和插入速度的小幅下降换取了选择速度的可能大幅提高。

或者，您可以编写一个函数，将您的字段与该正则表达式进行比较（或者甚至将正则表达式与您匹配到该函数的字段一起传递），然后针对该函数在您的表上创建一个功能索引。这也假设了一组固定的正则表达式（但您可以通过这种方式更轻松地添加新的正则表达式匹配）。

如果正则表达式是从用户输入动态创建的，您可能不得不忍受表扫描或更改用户应用程序以生成更简单的搜索，*如 'value%' 之类的字段*，它将使用字段上的索引（*'%value%'*不会）。

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2009-04-01T02:41:16.357

如果您确实设法减少对简单 LIKE 查询的需求，请使用 text_pattern_ops 查找索引以加快速度。

# web-services - WCF 和 gSOAP - 可互操作的代码？

> ID：698979
> 
> 赞同：1
> 
> 时间：2009-03-30T20:57:20.903
> 
> 标签：web-services, soap, wcf, wcf-client, gsoap

我正在尝试使用 SOAP 1.2 协议编写一个简单的 WCF 服务器 + gSOAP 客户端概念验证应用程序。这是服务器代码：

```
[ServiceContract(Namespace="http://test.com")]
public interface IService1
{
    [OperationContract]
    void HelloWorld();
}

[ServiceBehavior(Namespace = "http://test.com")]
public class Service1 : IService1
{
    public void HelloWorld()
    {
    }
}

static void Main(string[] args)
{
    var svc =  new Service1();
    Uri uri = new Uri("http://localhost:8201/Service1");
    ServiceHost host = new ServiceHost(typeof(Service1), uri);
    host.Description.Namespace = "http://test.com";

    var binding = new WSHttpBinding() { Namespace = "http://test.com" };
    ServiceEndpoint endpoint = host.AddServiceEndpoint(typeof(IService1), binding, uri);
    endpoint.Behaviors.Add(new InlineXsdInWsdlBehavior());

    host.Description.Behaviors.Add(new ServiceMetadataBehavior() { HttpGetEnabled = true });
    var mex = host.AddServiceEndpoint(typeof(IMetadataExchange), MetadataExchangeBindings.CreateMexHttpBinding(), "mex");
    host.Open();

    Console.ReadLine();
} 
```

然后我启动服务并使用以下命令生成代码：

```
wsdl2h.exe -gyf -t WS/WS-typemap.dat -o Service.h http://localhost:8201/Service1?wsdl WS/WS-Addressing05.xsd
soapcpp2.exe -C -L -w -x -i -2 Service.h -ID:\...\gsoap-2.7\gsoap\import 
```

然后我编译以下 C++ 代码：

```
#include "soapWSHttpBinding_USCOREIService1Proxy.h"
#include "WSHttpBinding_USCOREIService1.nsmap"
#include "stdsoap2.h" 

int _tmain(int argc, _TCHAR* argv[])
{
    WSHttpBinding_USCOREIService1Proxy svc;

    _ns1__HelloWorld req;
    _ns1__HelloWorldResponse rsp;
    int hr = svc.HelloWorld( &req, &rsp );
    if ( hr != SOAP_OK )
    {
        _tprintf( _T("Error: %i\n"), hr );
    }

    return 0;
} 
```

这会生成错误 8 (SOAP_MUSTUNDERSTAND)。有没有人曾经生成工作 WCF 到 gSOAP 链接？我究竟做错了什么？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2009-04-06T18:06:21.173

我猜 -soapcpp2 中的开关已修复错误 8，所以开关现在是：

```
soapcpp2.exe -C -L -w -x -i -2 -a Service.h -I<...path...> 
```

# ruby-on-rails - 如果您使用belongs_to 而没有相应的has_one，会发生什么？

> ID：698986
> 
> 赞同：12
> 
> 时间：2009-03-30T20:58:25.223
> 
> 标签：ruby-on-rails, activerecord

我有一个核心模型`Item`，以及一个从自定义源（想想，RSS 提要）填充它的脚本。在提要中，每个项目都用`guid`; 在我的系统中，Item 只有一个自动生成的`id`主键。

比方说，我想拥有`ItemFeedInfo`那个地图`guid->id`（这样我就可以区分新项目和修改项目）

我正在考虑创建

```
class ItemFeedInfo
  belongs_to :Item
end 
```

我不想修改`Item`，因为它的定义在逻辑上独立于`ItemFeedInfo`但是，我能找到的每个使用的例子`belongs_to`，都提到了一个`has_one`对应物。是必需的吗？

* * *

## 回答 #1

> 赞同：17
> 
> 时间：2009-03-30T21:13:54.030

没关系。

`belongs_to`只需在`ItemFeedInfo`类中添加一些方法。你知道当你这样做`item_feed_info.items.find_all`......这`items`只是一个在你调用时动态添加的方法`belongs_to`。

如果您不修改`Item`类，那么您根本不会在另一边添加方法。您将无法这样做`item.item_feed_infos.find_all`，因为如果不添加`has_many :item_feed_infos`，该方法将不会添加到`Item`类中，但如果您实际上不需要这样做，那也没关系。

# .net - 将应用程序层拆分为不同的程序集

> ID：698998
> 
> 赞同：8
> 
> 时间：2009-03-30T21:00:26.247
> 
> 标签：.net, architecture, com+

我的公司正在进行一场辩论。一些人提倡将业务、数据和业务实体移动到一个组件中，以实现

*   可发现性目的。让您轻松找到所需内容。
*   减少我们需要添加到项目中进行开发的dll的数量

引用应用程序架构指南的其他人希望每个层和业务实体在一个单独的程序集中。

请注意

*   我们的业务层和数据层都由 com + 组件组成。
*   我们当前的硬件架构在同一个盒子上拥有 Web、业务和数据。
*   SQL 在不同的盒子上。
*   我们目前没有使用 dll 版本控制，因为无论如何它对 com+ 几乎没有用处。

有些用户有一种直觉，认为我们应该拆分我们的业务、数据和实体，但缺乏理由。

*   潜在地减少内存消耗
*   通过仅将业务层程序集添加到 Web 项目来鼓励正确的体系结构。如果数据服务也可用，那么很容易以错误的方式做事
*   当我们将 Web 服务器与业务层和数据层分开时，我们将不必安装我们不需要的垃圾组件。

现在我们的系统中有大约 600 个 dll。所以我们处于一个极端，一切都被分裂了。肯定会发生一些整合，但所提议的是将我们带到一个完全的另一个极端，即每个应用程序都在一个 dll 中。

我可以从外部角度了解这个常见问题吗？

谢谢！

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2009-03-30T21:08:30.423

DLL 或程序集是分发单元。

1.  如果特定命名空间或类中的代码与另一个命名空间或类紧密耦合，那么它应该在同一个分布单元中。如果 foo.* 文件中的代码在不需要 bar.* 文件中的代码的情况下永远不会被使用，那么您也可以将它们构建到相同的分发单元中。
2.  如果一个名称空间或一组类代表一个可重用的组件（即，该代码正在两个或多个产品/应用程序中使用），那么单独版本化并成为其自己的分发单元是一个很好的候选者。

对我来说，它主要是关于内聚、耦合和重用。
我喜欢特定分布单元中的类具有内聚性，我不喜欢分布单元之间的耦合（我几乎总是希望依赖于包含接口的第三个分布单元，以便通过对抽象的依赖来实现耦合而不是结石）。在决定分配单位时，重用是我的关键。如果代码要在多个应用程序/产品中使用，那么它需要是一个单独的分发单元，具有自己的版本号，该版本号与应用程序版本号是分开的。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2009-03-30T21:13:59.320

在物理部署边界上拆分是个好主意。如果您有可以托管以供远程使用的组件，那么单独的程序集是有意义的。对于初学者来说，这可能是您可以拆分的最简单和最可靠的路线。*例如，您希望*Web 层同时包含业务服务和数据访问代码的情况很少。

从那里开始，尝试将程序集简化为对独立版本有意义的东西。如果您总是需要一起复制 10 多个程序集，那么它们可能应该被构建为一个程序集。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2009-03-30T21:10:54.507

我们团队的目标是尽可能少地组装。除了您列出的好处之外，我还发现当 DLL 数量较少时，更容易处理 DLL 版本控制噩梦。使用过多的程序集还会带来在程序集之间创建循环引用的风险。

我们不会特意将代码塞入它不属于的程序集中。但我们绝对不会在没有充分理由的情况下创建新程序集。通常，我们有一个用于应用程序共享逻辑（业务对象等）的程序集和一个用于用户界面的程序集（Web 程序集、WinForms 程序集等）。我们也不会为了避免创建新的程序集而在程序集之间复制代码/类。*****************