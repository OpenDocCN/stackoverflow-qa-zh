# StackOverflow 问答 000615000-000615999

# windows - 如何创建将按计划删除文件夹的批处理脚本？

> ID：615008
> 
> 赞同：0
> 
> 时间：2009-03-05T14:31:14.910
> 
> 标签：windows, scripting

### 精确重复：

*   [如何编写批处理文件以从文件夹中删除 5 天或更早的文件？](https://stackoverflow.com/questions/661447/)
*   [编写批处理文件以从文件夹中删除 6 天前的文件](https://stackoverflow.com/questions/662607/)
*   [编写一个批处理文件以从文件夹中删除 5 天的旧文件](https://stackoverflow.com/questions/659770/)
*   [如何编写批处理文件以按时间删除文件夹和文件？](https://stackoverflow.com/questions/625613/)
*   [编写一个批处理文件以按日期和时间删除文件夹。](https://stackoverflow.com/questions/613803/)
*   [编写脚本从文件夹中删除比当前日期早 5 天的文件](https://stackoverflow.com/questions/658717/)

如何创建将按计划删除文件夹的批处理脚本？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2009-03-05T14:34:27.350

Write a batch script to delete the file

```
rd <YOURDIR> 
```

and then schedule it in Windows Tasks.

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2009-03-05T14:32:49.260

创建一个批处理以删除文件，然后将其放置在服务器或工作站上的计划任务中。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-03-05T15:10:27.513

在文本编辑器中执行以下操作

```
@echo off
rd <enter your directory name here> 
```

将文件另存为 filename.bat

创建计划任务并选择批处理文件作为要运行的文件。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2009-03-05T15:18:35.123

您编写批处理文件，然后，甚至比手动使用调度程序更好，您可以使用**at**命令安排 .bat 文件定期运行。

这样做的好处是您可以将最终**的 at**命令放在第二个 bat 文件中，以便更轻松地分发到目标系统。

[**在**help.microsoft.com 上的参考页面](http://support.microsoft.com/kb/313565)

# javascript - 如何从 RJS 模板更改 html 标签属性值？

> ID：615010
> 
> 赞同：2
> 
> 时间：2009-03-05T14:31:56.267
> 
> 标签：javascript, ruby-on-rails, ruby, rjs

是否可以从 RSJ 模板更改 html 标签属性值？我知道有一个 page.replace_html 方法，但在我的情况下它不是很有用，因为我有各种属性的冗长值（例如 alt、图像的标题）。我想要的是更改 RJS 中 img 标签的 src 属性。这有可能吗？

谢谢你。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2009-03-05T14:40:33.733

**编辑：**我的第一次尝试没有成功，但这次成功了。

```
update_page do |page|
  page['image_id']['src'] = new_image_url
end 
```

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2009-03-15T18:58:40.687

对Can的答案稍作修改。正如建议的那样，

```
update_page do |page|
    page['image_id']['src'] = new_image_url
end 
```

翻译成 JS：

```
$('image_id').src = new_image_url 
```

这适用于某些具有直接 JS DOM 变量访问权限的属性，但许多属性没有。幸运的是 RJS 非常擅长重写 JS 方法调用：

```
update_page do |page|
    page['image_id'].set_attribute('attrib', new_attrib_val)
end 
```

翻译成 JS：

```
$('image_id').setAttribute('attrib', new_attrib_val) 
```

你应该很高兴。

* * *

小更新：如果你想要 IE 兼容性，你可能想要使用 write_attribute。

* * *

小更新：在上面，如果 [:src] 和 :attrib 是静态的，它们可能会是更好的样式。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2010-07-17T00:25:23.273

根据 Rails 设置，上面的代码可能仅在排除 page_update 开始和结束行时才有效——我在 Windows 7 上的 mongrel 上运行 Rails，并将 page[element][attribute] 代码放在它自己的外部update_page 块的一部分，工作正常，但将其包含在块中会破坏代码。

# ruby-on-rails - 最佳实践：我应该对静态数据使用 AR 模型还是全局哈希？

> ID：615015
> 
> 赞同：13
> 
> 时间：2009-03-05T14:33:25.530
> 
> 标签：ruby-on-rails

我正在考虑一个社交网站。我的用户模型应该有一个属性“eyecolor”，可以在带有选择框/下拉列表的视图页面上设置。

我的问题：-> 我应该制作一个 AR 模型还是应该为数据使用全局哈希/常量？“静态模型”是否有最佳实践？

以及如何在没有 AR 模型的情况下将关注与关系关联：

```
u = User.first 
u.eyecolor 
==> 1 (not the eyecolor-string!) 
```

我需要的是眼睛颜色字符串：

```
u = User.first 
u.eyecolor 
==> "brown" 
```

谢谢，对不起我的英语不好！

* * *

## 回答 #1

> 赞同：8
> 
> 时间：2009-03-05T15:20:54.213

您可以创建一个模型来处理您的眼睛颜色逻辑：

```
class EyeColor
   COLORS = ['blue','brown','hazel']

   attr_accessor :color

   # Some logic methods...
   def is_brown?
     self.color == 'brown'
   end

end 
```

注意：此模型不是 Active Record 模型，但它确实为您尝试建模的真实世界对象创建了一个抽象。

编辑：我也喜欢这种方法，而不是全局散列，因为它可以在 EyeColor 中组织您的静态定义，而不是在您的程序中浮动，这清楚地表明了这个定义的位置。

```
<%= select :user, :eye_color, EyeColor::COLORS %> 
```

编辑：在谓词方法中添加了问号。

* * *

## 回答 #2

> 赞同：5
> 
> 时间：2009-03-05T15:44:35.077

你想要的是一个常数。我把这些放在 config/initializers/constants.rb 的文件中；这样他们都在同一个地方。

```
EyeColors = %w{Blue Brown Hazel Green} 
```

在您的表格中，只需执行以下操作：

```
<%= f.select :eye_color, EyeColors %> 
```

* * *

## 回答 #3

> 赞同：4
> 
> 时间：2009-03-05T18:29:40.517

如果你有一些数据，你应该把它放在数据库中。这并不意味着每次使用时都必须加载它：

```
class EyeColor < ActiveRecord::Base
  has_many :users

  def self.allowed_eye_colors
    @@eye_colors ||= AllowedEyeColor.find(:all)
  end
end 
```

您以`EyeColor.allowed_eye_colors`. 它在您第一次使用时加载，然后缓存在类变量中。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2009-03-05T17:17:19.253

您可能需要检查[constant_cache](https://github.com/tpitale/constant_cache)。将此信息存储在数据库中，但将其缓存可让您在不更改实际代码的情况下添加/删除常量（在数据库中）。

# .net - Skip .NET Framework 3.5 language pack download

> ID：615021
> 
> 赞同：0
> 
> 时间：2009-03-05T14:34:33.187
> 
> 标签：.net, installation, .net-3.5

I downloaded the .NET 3.5 SP1 redistributable package (231MB). On my machine I have more than 1 language pack. When trying to install .NET 3.5 SP1, the installer connects to the internet and downlands language packs.

If no internet connection exists, the installer has 5 (depending on how many language packs exists on my operating system) attempts to download (takes a lot).

How can I stop this?

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2009-03-05T16:28:11.197

尝试`dotnetfx35.exe /lang:ENU`（或您选择的语言）（通过[此处](http://www.mydigitallife.info/2008/11/23/download-microsoft-net-framework-35-sp1-standalone-full-redistributable-setup-installer/)的评论）

# xml - XSLT - 匹配其中包含某个节点的节点（如 jQuery ":has"）

> ID：615023
> 
> 赞同：2
> 
> 时间：2009-03-05T14:34:52.467
> 
> 标签：xml, xslt, xpath

假设我有以下 XML 文件

```
<a id="123">
   <b type="foo" value="1" />
   <b type="baz" value="1" />
</a>
<a id="789">
  <b type="bar" value="12" />
</a>
<a id="999">
   <b type="foo", value="2" />
</a> 
```

我想获取所有具有“b”子节点的“a”节点的列表，该子节点的类型=“foo”和值=“1”。你可以在 jQuery 中使用 ":has" 选择器做类似的事情。

作为记录，我计划在命令行上使用 xmlstarlet （但我不喜欢这样做），所以以这种方式工作的 xslt 是最好的。

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2009-03-05T14:40:48.990

像这样的东西：

```
a[b[@type='foo'][@value='1']] 
```

应该做的伎俩

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2009-03-05T14:52:46.183

这可以使用 Gizmo 的回答中指出的单个 XPath 表达式来完成。

因为这个问题专门针对 XSLT，所以这里是一个使用键**的有效 XSLT 解决方案：**

```
<xsl:stylesheet version="1.0"
 xmlns:xsl="http://www.w3.org/1999/XSL/Transform">
 <xsl:output omit-xml-declaration="yes"/>
<!--                                      --> 
 <xsl:key name="kAByBTypeVal" 
  match="a"
  use="concat(b/@type,'+',b/@value)"/>
<!--                                      -->       
    <xsl:template match="/">
      <xsl:copy-of select=
       "key('kAByBTypeVal', 'bar+12')"/>
    </xsl:template>
</xsl:stylesheet> 
```

**在此 XML 文档上应用上述转换时**：

```
<t>
    <a id="123">
        <b type="foo" value="1" />
        <b type="baz" value="1" />
    </a>
    <a id="789">
        <b type="bar" value="12" />
    </a>
    <a id="999">
        <b type="foo" value="2" />
    </a>
</t> 
```

**产生正确的结果**：

```
<a id="789">
  <b type="bar" value="12"/>
</a> 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-03-05T14:43:24.007

我认为这将是：/b[@type='foo' and @value=1]/parent::a

* * *

## 回答 #4

> 赞同：-1
> 
> 时间：2009-03-05T14:42:14.463

```
<xsl:variable name="nodeList" select="a[b[@type='foo' and @value=1]]"/>

<xsl:for-each select="$nodeList">
    <xsl:value-of select="."/>
</xsl:for-each> 
```

# php - iphone 的谷歌地图 api 访问可能性？（处理没有 UIWebView 的 javascript）

> ID：615025
> 
> 赞同：0
> 
> 时间：2009-03-05T14:35:59.093
> 
> 标签：php, javascript, iphone, google-maps

我想从谷歌地图访问一些数据。唯一可能的方法是为此使用JS。我不想通过 webview 访问它。

用例：

*   我有第 1 点 (lat,lng) 和第 2 点 (lat,lng)。我想使用谷歌地图 api 来确定这两个之间的行驶距离。

所以换句话说，我想在服务器端使用 Google maps api。

现在，当我尝试加载该 html 页面的数据（使用 document.write() 来解析距离）时，我得到的是 Javascript 而不是正在处理的 Javascript。

我可以以任何方式让 Javascript 通过 Objective-C 处理吗？php？

我的最终目标是发送带有不同点的 post vars 的请求，并将我的数据以 JSON 格式返回 2 点之间的每个距离

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-03-05T15:29:45.160

您需要在服务器上有一些容器来执行 Javascript。仅从 HTTP 请求中加载 Javascript 不会执行它。

你看过[CloudMade 的路由 API](http://developers.cloudmade.com/projects/show/routing-http-api)吗？它们听起来像是满足您要求的更好解决方案

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-03-06T02:52:54.877

您需要 UIWebView 来运行 JavaScript。这是我更喜欢的方式：

1.  子类化一个 UIWebView，并将其添加到 UIView 的子视图中（这样你就可以同时在 UIView 上控制你的 UI 手势）
2.  要求 UIWebView 加载处理您要使用的 JavaScript 的 PHP 网页。
3.  您使用 stringByEvaluatingJavaScriptFromString: 在您的应用程序中执行脚本。
4.  最后，服务器端的 PHP 网页可以响应您的脚本执行。

Google 代码中有一个小示例/项目可以解决问题：[iphone-google-maps-component](http://code.google.com/p/iphone-google-maps-component/)，这家伙使用 UIWebView 加载自定义版本的 Google 地图，并提供了一组 Objective-C 方法来控制地图。

# c# - 使用 USB 条形码扫描仪读取条形码，同时忽略键盘数据输入，而扫描仪产品 ID 和供应商 ID 未知

> ID：615036
> 
> 赞同：12
> 
> 时间：2009-03-05T14:39:12.333
> 
> 标签：c#, usb, barcode-scanner

有没有办法在忽略键盘且不知道 USB 扫描仪的 PID 或 VID 的情况下从 USB 条形码阅读器读取？我知道有一种方法可以通过使用 USB 扫描仪的 VID 和/或 PID 来区分 USB 扫描仪输入和键盘输入；这是使用来自[http://nicholas.piasecki.name/blog/2009/02/distinguishing-barcode-scanners-from-the-keyboard-in-winforms/](http://nicholas.piasecki.name/blog/2009/02/distinguishing-barcode-scanners-from-the-keyboard-in-winforms/)的代码完成的 但是还有另一种解决方案来区分键盘和 USB 扫描仪没有将扫描仪的 VID 或 PID 放在配置文件（或源代码）中？不想将各种 VID 或 PID 放在配置文件中的原因是，正在开发的应用程序将部署在许多笔记本电脑上，并附有任意类型的扫描仪。

另外，我不想使用将输出的开始和或结束序列配置扫描仪，因为扫描仪也被同一台机器上的其他软件使用，我不想更改代码在其他软件上。出于前面提到的相同原因，我也不想将条形码阅读器编程为串行模式。

* * *

## 回答 #1

> 赞同：14
> 
> 时间：2009-06-18T12:00:25.410

有一种方法可以区分键盘和 USB 条码阅读器

* * *

从以下假设开始：

1.  条码阅读器扫描的代码长度至少为 4 个字符
2.  条码阅读器扫描的代码以“ENTER”键结束
3.  传输整个条码不到 50 毫秒

这个使用 VS2005 VB 的简单表格包含：

1.  文本框1
2.  文本框2
3.  文本框3
4.  按钮1
5.  Timer1“时间间隔设置为50ms”

* * *

```
Public Class Form1

Dim BarcodeStr As String = ""
Dim IsBarcodeTaken As Boolean = False
Dim Str As String = ""
Dim str3 As String = ""

Private Sub Form1_KeyDown(ByVal sender As Object, ByVal e As System.Windows.Forms.KeyEventArgs) Handles Me.KeyDown

    If Timer1.Enabled = False Then
        Str = TextBox1.Text
        str3 = TextBox3.Text
    End If

End Sub

Private Sub Form1_KeyPress(ByVal sender As Object, ByVal e As System.Windows.Forms.KeyPressEventArgs) Handles Me.KeyPress
    If Timer1.Enabled = False Then
        Timer1.Enabled = True
    End If

    BarcodeStr = BarcodeStr & e.KeyChar
    If Asc(e.KeyChar) = 13 And Len(BarcodeStr) >= 4 Then
        IsBarcodeTaken = True
        TextBox2.Text = BarcodeStr

    End If

End Sub
Private Sub Form1_KeyUp(ByVal sender As Object, ByVal e As System.Windows.Forms.KeyEventArgs) Handles Me.KeyUp
    If IsBarcodeTaken = True Then
        TextBox1.Text = Str
        TextBox1.Select(Len(TextBox1.Text), 0)
        Str = ""

        TextBox3.Text = str3
        TextBox3.Select(Len(TextBox3.Text), 0)
        str3 = ""
    End If

End Sub

Private Sub Timer1_Tick(ByVal sender As System.Object, ByVal e As System.EventArgs) Handles Timer1.Tick
    BarcodeStr = ""
    IsBarcodeTaken = False
    Timer1.Enabled = False
End Sub

Private Sub Button1_Click(ByVal sender As System.Object, ByVal e As System.EventArgs) Handles Button1.Click
    TextBox2.Text = ""

End Sub

End Class 
```

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2010-06-16T13:12:14.390

好吧，我使用的解决方案[与 Ehab](https://stackoverflow.com/a/1012262)的解决方案非常相似——我只是为我的应用程序清理了一点代码。我正在为我的编辑控件使用自定义类（它也在做其他一些事情） - 但这些是重要的部分：

```
public class ScannerTextBox : TextBox
{
    public bool BarcodeOnly { get; set; }

    Timer timer;

    private void InitializeComponent()
    {
        this.SuspendLayout();

        this.ResumeLayout(false);
    }

    void timer_Tick(object sender, EventArgs e)
    {
        if (BarcodeOnly == true)
        {
            Text = "";
        }

        timer.Enabled = false;
    }

    protected override void OnKeyPress(KeyPressEventArgs e)
    {
        base.OnKeyPress(e);

        if (BarcodeOnly == true)
        {
            if (timer == null)
            {
                timer = new Timer();
                timer.Interval = 200;
                timer.Tick += new EventHandler(timer_Tick);
                timer.Enabled = false;
            }
            timer.Enabled = true;
        }

        if (e.KeyChar == '\r')
        {
            if (BarcodeOnly == true && timer != null)
            {
                timer.Enabled = false;
            }
        }
    }
} 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-03-05T14:47:40.487

[这里](https://stackoverflow.com/questions/613881/how-to-read-a-value-from-a-barcode-reader-using-c/613899#613899)还有一个关于条形码的问题，该链接会将您发送到通过串行端口使用条形码的答案。也许这对你来说是一个解决方案？

恕我直言：最简单的解决方案是接受键盘输入。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2009-06-18T12:06:33.293

也许这是一个过于简单的解决方案，但是您能否捕获按键事件并简单地阻止通过键盘输入？

# .net - 编写迷你语言

> ID：615040
> 
> 赞同：7
> 
> 时间：2009-03-05T14:40:29.833
> 
> 标签：.net, language-design

我有一个应用程序需要允许用户编写类似于 excel 的表达式：

(H1 + (D1 / C3)) * I8

还有更复杂的事情，比如

如果（H1 = '真'，D3 * .2，D3 * .5）

我只能用正则表达式做这么多。任何关于正确方法的建议以及我可以从中学习的任何资源都将不胜感激。

谢谢！

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2009-03-05T14:44:19.807

其他一些问题，您会在以下位置找到提示：

*   [如何编写编程语言？](https://stackoverflow.com/questions/229854/how-to-write-a-programming-language)
*   [学习编写编译器](https://stackoverflow.com/questions/1669/learning-to-write-a-compiler)
*   [在 python 中为 DSL 编写编译器](https://stackoverflow.com/questions/339217/writing-a-compiler-for-a-dsl-in-python])

祝你好运！

* * *

## 回答 #2

> 赞同：7
> 
> 时间：2009-03-05T16:59:41.993

当遇到类似的情况时——需要处理短的单行表达式——我写了一个解析器。表达式是布尔逻辑，形式为

```
n1 = y and n2 > z
n2 != x or (n3 > y and n4 = z) 
```

等等。在英语中，你可以说有由 AND 和 OR 连接的原子，每个原子都有三个元素 - 左侧属性、运算符和值。因为它非常简洁，我认为解析更容易。可能的属性集是已知的和有限的（例如：名称、大小、时间）。运算符因属性而异：不同的属性采用不同的运算符集。可能值的范围和格式也因属性而异。

为了解析，我使用 String.Split() 在空格上拆分字符串。后来我意识到，在 Split() 之前，我需要对输入字符串进行规范化——在括号前后插入空格。我用 regex.Replace() 做到了这一点。

拆分的输出是一个令牌数组。然后在一个大的 for 循环中进行解析，并在左侧属性值上进行切换。在循环的每一次循环中，我都被设置为啜饮一组代币。如果第一个令牌是一个开放括号，那么该组只是一个长度令牌：括号本身。对于众所周知的标记 - 我的属性值 - 解析器必须在一组 3 个标记中啜饮，每个标记用于名称、运算符和值。如果在任何时候没有足够的标记，解析器就会抛出异常。基于令牌流，解析器状态会改变。连接（AND，OR，XOR）意味着将前一个原子推入堆栈，当下一个原子完成时，我会弹出前一个原子并将这两个原子连接成一个复合原子。等等。

```
Atom current;
for (int i=0; i < tokens.Length; i++) 
{
  switch (tokens[i].ToLower())
  {
    case "name":
        if (tokens.Length <= i + 2)
            throw new ArgumentException();
        Comparison o = (Comparison) EnumUtil.Parse(typeof(Comparison), tokens[i+1]);
        current = new NameAtom { Operator = o, Value = tokens[i+2] };
        i+=2;
        stateStack.Push(ParseState.AtomDone);
        break;
    case "and": 
    case "or":
        if (tokens.Length <= i + 3) 
          throw new ArgumentException();
        pendingConjunction = (LogicalConjunction)Enum.Parse(typeof(LogicalConjunction), tokens[i].ToUpper());
        current = new CompoundAtom { Left = current, Right = null, Conjunction = pendingConjunction };
        atomStack.Push(current);
        break;

    case "(":
        state = stateStack.Peek();
        if (state != ParseState.Start && state != ParseState.ConjunctionPending && state != ParseState.OpenParen)
          throw new ArgumentException();
        if (tokens.Length <= i + 4)
          throw new ArgumentException();
        stateStack.Push(ParseState.OpenParen);
        break;

    case ")":
        state = stateStack.Pop();
        if (stateStack.Peek() != ParseState.OpenParen)
            throw new ArgumentException();
        stateStack.Pop();
        stateStack.Push(ParseState.AtomDone);
        break;

    // more like that...
    case "":
       // do nothing in the case of whitespace
       break;
    default:
        throw new ArgumentException(tokens[i]);
  }

  // insert housekeeping for parse states here

} 
```

那是简化的，只是一点点。但想法是每个案例陈述都相当简单。在表达式的原子单元中解析很容易。棘手的部分是将它们适当地结合在一起。

这个技巧是在管理部分完成的，在每个 slurp 循环结束时，使用状态堆栈和原子堆栈。根据解析器状态，可能会发生不同的事情。正如我所说，在每个 case 语句中，解析器状态可能会发生变化，之前的状态会被压入堆栈。然后在 switch 语句的末尾，如果状态说我刚刚完成了一个原子的解析，并且有一个未决的连词，我会将刚刚解析的原子移动到 CompoundAtom 中。代码如下所示：

```
 state = stateStack.Peek();
            if (state == ParseState.AtomDone)
            {
                stateStack.Pop();
                if (stateStack.Peek() == ParseState.ConjunctionPending)
                {
                    while (stateStack.Peek() == ParseState.ConjunctionPending)
                    {
                        var cc = critStack.Pop() as CompoundAtom;
                        cc.Right = current;
                        current = cc; // mark the parent as current (walk up the tree)
                        stateStack.Pop();   // the conjunction is no longer pending 

                        state = stateStack.Pop();
                        if (state != ParseState.AtomDone)
                            throw new ArgumentException();
                    }
                }
                else stateStack.Push(ParseState.AtomDone); 
            } 
```

另一个神奇之处是 EnumUtil.Parse。这使我可以将诸如“<”之类的内容解析为枚举值。假设您像这样定义枚举：

```
internal enum Operator
{
    [Description(">")]   GreaterThan,
    [Description(">=")]  GreaterThanOrEqualTo,
    [Description("<")]   LesserThan,
    [Description("<=")]  LesserThanOrEqualTo,
    [Description("=")]   EqualTo,
    [Description("!=")]  NotEqualTo
} 
```

通常 Enum.Parse 查找枚举值的符号名称，而 < 不是有效的符号名称。EnumUtil.Parse() 查找描述中的内容。代码如下所示：

```
internal sealed class EnumUtil
{
    /// <summary>
    /// Returns the value of the DescriptionAttribute if the specified Enum value has one.
    /// If not, returns the ToString() representation of the Enum value.
    /// </summary>
    /// <param name="value">The Enum to get the description for</param>
    /// <returns></returns>
    internal static string GetDescription(System.Enum value)
    {
        FieldInfo fi = value.GetType().GetField(value.ToString());
        var attributes = (DescriptionAttribute[])fi.GetCustomAttributes(typeof(DescriptionAttribute), false);
        if (attributes.Length > 0)
            return attributes[0].Description;
        else
            return value.ToString();
    }

    /// <summary>
    /// Converts the string representation of the name or numeric value of one or more enumerated constants to an equivilant enumerated object.
    /// Note: Utilised the DescriptionAttribute for values that use it.
    /// </summary>
    /// <param name="enumType">The System.Type of the enumeration.</param>
    /// <param name="value">A string containing the name or value to convert.</param>
    /// <returns></returns>
    internal static object Parse(Type enumType, string value)
    {
        return Parse(enumType, value, false);
    }

    /// <summary>
    /// Converts the string representation of the name or numeric value of one or more enumerated constants to an equivilant enumerated object.
    /// A parameter specified whether the operation is case-sensitive.
    /// Note: Utilised the DescriptionAttribute for values that use it.
    /// </summary>
    /// <param name="enumType">The System.Type of the enumeration.</param>
    /// <param name="value">A string containing the name or value to convert.</param>
    /// <param name="ignoreCase">Whether the operation is case-sensitive or not.</param>
    /// <returns></returns>
    internal static object Parse(Type enumType, string stringValue, bool ignoreCase)
    {
        if (ignoreCase)
            stringValue = stringValue.ToLower();

        foreach (System.Enum enumVal in System.Enum.GetValues(enumType))
        {
            string description = GetDescription(enumVal);
            if (ignoreCase)
                description = description.ToLower();
            if (description == stringValue)
                return enumVal;
        }

        return System.Enum.Parse(enumType, stringValue, ignoreCase);
    }

} 
```

我从其他地方得到了 EnumUtil.Parse() 东西。也许在这里？

* * *

## 回答 #3

> 赞同：4
> 
> 时间：2009-03-05T17:22:56.930

一个小的递归下降解析器非常适合这个。您甚至可能不必构建解析树 - 您可以在解析时进行评估。

```
 /* here's a teeny one in C++ */
void ScanWhite(const char* &p){
  while (*p==' ') p++;
}

bool ParseNum(const char* &p, double &v){
  ScanWhite(p);
  if (!DIGIT(*p)) return false;
  const char* p0 = p;
  while(DIGIT(*p)) p++;
  if (*p == '.'){
    p++;
    while(DIGIT(*p)) p++;
  }
  v = /* value of characters p0 up to p */;
  return true;
}

bool ParseId(const char* &p, double &v){
  ScanWhite(p);
  if (ALPHA(p[0]) && DIGIT(p[1])){
    v = /* value of cell whose name is p[0], p[1] */;
    p += 2;
    return true;
  }
  return false;
}

bool ParseChar(const char* &p, char c){
  ScanWhite(p);
  if (*p != c) return false;
  p++;
  return true;
}

void ParseExpr(const char* &p, double &v); /* forward declaration */

void ParsePrimitive(const char* &p, double &v){
  if (ParseNum(p, v));
  else if (ParseId(p, v));
  else if (ParseChar(p, '(')){
    ParseExpr(p, v);
    if (!ParseChar(p, ')'){/* throw syntax error */}
  }
  else {/* throw syntax error */}
}
#define PARSE_HIGHER ParsePrimitive

void ParseUnary(const char* &p, double &v){
  if (ParseChar(p, '-')){
    ParseUnary(p, v);
    v = -v;
  }
  else {
    PARSE_HIGHER(p, v);
  }
}
#undef  PARSE_HIGHER
#define PARSE_HIGHER ParseUnary

void ParseProduct(const char* &p, double &v){
  double v2;
  PARSE_HIGHER(p, v);
  while(true){
    if (ParseChar(p, '*')){
      PARSE_HIGHER(p, v2);
      v *= v2;
    }
    else if (ParseChar(p, '/')){
      PARSE_HIGHER(p, v2);
      v /= v2;
    }
    else break;
  }
}
#undef  PARSE_HIGHER
#define PARSE_HIGHER ParseProduct

void ParseSum(const char* &p, double &v){
  double v2;
  PARSE_HIGHER(p, v);
  while(true){
    if (ParseChar(p, '+')){
      PARSE_HIGHER(p, v2);
      v += v2;
    }
    else if (ParseChar(p, '-')){
      PARSE_HIGHER(p, v2);
      v -= v2;
    }
    else break;
  }
}
#undef  PARSE_HIGHER
#define PARSE_HIGHER ParseSum

void ParseExpr(const char* &p, double &v){
  PARSE_HIGHER(p, v);
}

double ParseTopLevel(const char* buf){
  const char* p = buf;
  double v;
  ParseExpr(p, v);
  return v;
} 
```

现在如果你只是调用 ParseTop，它会为你计算一个表达式的值。

使用 PARSE_HIGHER 宏的原因是更容易在中间优先级添加运算符。

执行“if”语句涉及更多内容。每个解析例程都需要一个额外的“启用”参数，因此除非启用，否则它不会进行计算。然后解析单词“if”，解析测试表达式，然后解析两个结果表达式，禁用不活动的一个。

* * *

## 回答 #4

> 赞同：3
> 
> 时间：2009-03-05T17:21:23.720

您可以使用 .NET JScript 编译器，或与 IronPython、IronRuby 或 IronScheme 接口（按字母顺序命名，而不是首选项 ;p）。

* * *

## 回答 #5

> 赞同：2
> 
> 时间：2009-03-05T14:49:25.117

我有一个如何**不**这样做的反例：[Will o' the Wisp](http://www.codeplex.com/wisp)（因为这是我自己的代码，我有信心批评它）。

守则有什么**好处？**

1.  因此，它使用了一种设计模式：解释器模式
2.  它有一个相当干净的设计
3.  它以一种很好的方式使用属性。
4.  它产生漂亮的图形。;-)

[海龟图形 http://i3.codeplex.com/Project/Download/FileDownload.aspx?ProjectName=wisp&DownloadId=34823](http://i3.codeplex.com/Project/Download/FileDownload.aspx?ProjectName=wisp&DownloadId=34823)

代码有什么**不好**？

1.  **很慢**！
2.  该语言在列表（数据与代码）方面定义不明确。

* * *

## 回答 #6

> 赞同：2
> 
> 时间：2009-03-05T18:10:42.090

查看[ANTLR](http://www.antlr.org/)。您定义语言语法，使用 GUI 工具对其进行测试并生成各种语言的源代码。开源。

* * *

## 回答 #7

> 赞同：2
> 
> 时间：2009-03-05T18:24:20.497

我会推荐这本书[Constructing Little Languages](https://rads.stackoverflow.com/amzn/click/com/0471597538)。它带您了解正确完成此任务所需的许多编译器基础知识。

您提出了一个事实，即除非您对您的语言有一些严格的限制，否则正则表达式将不起作用。就像其他人所说的那样，[递归下降解析器](http://en.wikipedia.org/wiki/Recursive_descent_parser)可以解决问题。

接下来的选择是是使用像[ANTLR这样的](http://en.wikipedia.org/wiki/ANTLR)[解析器生成器](http://en.wikipedia.org/wiki/Parser_generator)，还是从头开始编写一个。

* * *

## 回答 #8

> 赞同：1
> 
> 时间：2009-03-05T15:05:40.553

看看这个开源项目：

[Excel 财务函数](http://www.csharpopensource.com/excelfinancialfunctionsfordotnet.aspx)

* * *

## 回答 #9

> 赞同：0
> 
> 时间：2012-05-18T03:26:03.173

我建议查看 CoreCalc/FunCalc 的工作： [http ://www.itu.dk/people/sestoft/funcalc/](http://www.itu.dk/people/sestoft/funcalc/)

我在生产中将他们的语法用于 COCO\R 解析器生成器，它运行得非常快。

您需要做的就是： 1\. 从 corecalc 获取 excel 语法 2\. 在其上运行 coco.exe（为类似 excel 的表达式生成解析器） 3\. 将表达式树转换为反向波兰符号 4\. 简单的计算

# model-view-controller - mvc没有代码隐藏强类型的viewdata标头不起作用

> ID：615044
> 
> 赞同：5
> 
> 时间：2009-03-05T14:40:57.740
> 
> 标签：model-view-controller, header, code-behind, strong-typing, viewdata

我将它添加到我的标题中`<%@ Page Language="C#" MasterPageFile="~/Views/Shared/Site.Master" Inherits="System.Web.Mvc.ViewPage" %>`，并且能够访问 ViewData 及其所有内部以及所有 mvc 对象，如 url 和 html。一旦我添加“ `System.Web.Mvc.ViewPage<app.Models.tTable>`”，我就无法访问任何 mvc 类和辅助方法。我很困惑为什么会这样。我最近完成了从 mvc preview 5 到 rc1 的升级，但是我向 rc1 的过渡完美无缺，没有任何错误或错误。

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2009-03-05T15:27:45.773

在钓鱼（很多钓鱼）之后我找到了答案，这是因为我没有阅读官方发行说明，而是浏览了博客中的教程，但是任何人要让它工作，你需要替换`<pages>`web.config 中的节点在您的“/ Views”目录中的文件

```
<!--
        Enabling request validation in view pages would cause validation to occur
        after the input has already been processed by the controller. By default
        MVC performs request validation before a controller processes the input.
        To change this behavior apply the ValidateInputAttribute to a
        controller or action.
    -->
    <pages
        validateRequest="false"
        pageParserFilterType="System.Web.Mvc.ViewTypeParserFilter, System.Web.Mvc, Version=1.0.0.0, Culture=neutral, PublicKeyToken=31BF3856AD364E35"
        pageBaseType="System.Web.Mvc.ViewPage, System.Web.Mvc, Version=1.0.0.0, Culture=neutral, PublicKeyToken=31BF3856AD364E35"
        userControlBaseType="System.Web.Mvc.ViewUserControl, System.Web.Mvc, Version=1.0.0.0, Culture=neutral, PublicKeyToken=31BF3856AD364E35">
      <controls>
        <add assembly="System.Web.Mvc, Version=1.0.0.0, Culture=neutral, PublicKeyToken=31BF3856AD364E35" namespace="System.Web.Mvc" tagPrefix="mvc" />
      </controls>
    </pages> 
```

我从预先构建的 web.config 文件中添加了评论

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2009-04-01T21:15:01.970

有个窍门。/Views 文件夹下有一个 web.config。哇，我没看到。

感谢发帖

# .net - CascadingDropDown 错误 - “选项”为空或不是对象

> ID：615045
> 
> 赞同：1
> 
> 时间：2009-03-05T14:41:00.347
> 
> 标签：.net, asp.net, ajax, drop-down-menu, cascadingdropdown

我有五个s 与AJAX 控件`DropDownList`链接在一起。`CascadingDropDown`当它在本地运行时，它们工作正常。但是，当通过 Internet 在生产服务器上运行时，每次选择新项目时都会出现此错误：

```
'options' is null or not an object 
```

调试它显示了导致它的函数（它是来自`CascadingDropDown`控件的 JS）：

```
_clearItems : function() {
    /// <summary>
    /// Clear the items from the drop down
    /// </summary>
    /// <returns />

    var e = this.get_element();
    while (0 < e.options.length) {
        e.remove(0);
    }
}, 
```

有没有人对它为什么这样做有任何想法？我怀疑这是因为通过互联网加载项目需要更长的时间，并且不知何故这会影响控制？

我正在运行.NET 3.5。

提前致谢。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2009-08-28T15:03:41.760

确保下拉列表有 autopostback = "false".autopostback = "true" 对我造成了问题。- 法赫德

# javascript - jquery分层菜单设计

> ID：615051
> 
> 赞同：0
> 
> 时间：2009-03-05T14:41:56.787
> 
> 标签：javascript, jquery, html, menu

**编辑：** 好的，行：

```
$( <?php echo("'#".$_GET['item']."'")  ?> ).parent().show(); 
```

显然并试图在正确的位置保持菜单打开。我认为这从来没有奏效（让我讨厌处理其他 ppls 代码）。

那么我目前的问题是如何使用该项目 id=001`<ul class="myul">`直接访问上面的？`<li id="001" >`

你好

我正在尝试修复一个现在丢失的程序员留给我的一段代码。它可以工作，但缺少一个功能；选择菜单项时，我不会在正确的位置保持打开状态。

查询：

```
$.swapImage(".swapImage");                                  
            $( <?php echo("'#".$_GET['item']."'")  ?> ).parent().show();
            $('.myul').hide();              
            $('.slide_ul li:not(:first-child)').hide();     
            $('.hideMe').click(function(){ 
                $(this).next('ul').slideToggle('fast').siblings('ul:visible').slideUp('fast');
            });                             
            $('.myul a').click(function(e){
                var url = $(this).attr('href');
                var index = url.indexOf('=');
                var substr = url.slice(index+1);                    
                $('#productContainer >div').hide();
                $('#productContainer').load("products/"+substr+"/product.html", function(){
                    $(this).fadeIn('slow'); 
                    var i = 0;
                    $('.slide_ul li:not(:first-child)').hide();                                                                             
                });                 
            }); 
```

HTML：

```
 <!-- Right Navigation -->
                        <div id="rightNav">
                            <div id="navMenu">
                                <h2 id="navMenuheader">Catalogue</h1>
                                <h3 class="hideMe">Widgets</h3>
                                <ul class="myul">
                                    <h4 class="hideMe">Widget Coins</h2>
                                    <ul class="myul">
                                        <li id="001" >
                                             <a href="products.php?item=001">The South African Widget</a>
                                          </li> 
```

菜单点击的结果是将Content注入到页面中间的一个黑色div中。`$(document).ready(function(){`每次发生这种情况都会发生吗？否则我看不出为什么所有的菜单位置都被更新了。

我想我需要更多的代码来识别我们在菜单中的位置并让它们保持打开状态。我的桌子上有蚂蚁。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-03-06T05:29:16.997

在我看来像坏的结束标签

```
<h4 class="hideMe">Widget Coins</h2> 
```

是你的主要问题，当它被点击时

```
$(this).next('ul') 
```

找不到 ul 因为它是孩子而不是 h4 的兄弟姐妹将其
更改为

```
<h4 class="hideMe">Widget Coins</h4> 
```

让它更好地工作，不确定这是否就是你想要的

```
$( <?php echo("'ul:has(#".$_GET['item'].")'");  ?> ).show(); 
```

将打开每个具有指定 id 的后代的 ul
仅使用 .parent() 没有让顶部 ul 显示

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-03-10T16:12:20.570

只需添加一些 jquery 即可在菜单的相关部分全部隐藏后重新打开它。因此，在该行之后，`$('.myul').hide()`我根据 url 查询（ products.php?item=001 ）重新打开菜单部分：

```
var item =  <?php echo("'".$_GET['item']."'")  ?>;

                if (item != '')             
                {
                    item = "li#" + item;            
                    $(item).parent().show();
                    $(item).parent().parent().show();
                } 
```

# linux - Automated Script for testing Network Connectivity in Linux

> ID：615056
> 
> 赞同：-1
> 
> 时间：2009-03-05T14:43:27.283
> 
> 标签：linux, ant, networking

I have got a requirement to test network connectivity to around 30 servers with different ports as part of some new firewall rules implementation. After the rules are in place i need to check whether the connectivity is succesfull or not, and i need to test the same rules from 3 servers. SO i am looking at some way i can automate this. Currently i use telnet to test connectivity, but this is too slow, I am open to a shell script and ant script. The end result should be a log file listing the server and port to which the connect attempt was made, and the status of the attempt (success/failure)

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-03-05T14:54:09.770

我相信[nmap](http://nmap.org/)可以做到。它可以扫描选定/所有端口并生成报告。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-03-05T16:00:35.303

If you don't mind a Perl solution, [Net::Ping](http://search.cpan.org/~smpeters/Net-Ping-2.35/lib/Net/Ping.pm) is pretty helpful. I use this for testing SSH connectivity to servers in our test environment.

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-03-05T14:57:19.683

Ping 可能有帮助，甚至卷曲？如果脚本检查不应该阻塞，请描述 ==“它死了，吉姆！”的场景。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2009-03-05T15:18:01.910

Nagios 可能会做你想做的事。

[http://www.nagios.org/](http://www.nagios.org/)

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2009-03-05T19:28:08.783

尝试[fping](http://fping.sourceforge.net/)。非常简单，可能会为您提供大部分您正在寻找的东西。如果您阻止 ICMP 或想使用 ssh 或 telnet 做某事，那么您应该按照[Brian Lindauer](https://stackoverflow.com/questions/615056/automated-script-for-testing-network-connectivity-in-linux/615209#615209)的回答查看 nagios。

获取启动的主机列表： `fping -a -f hostlist.txt`

获取停机主机列表： `fping -u -f hostlist.txt`

# visual-studio - 如何让 Visual Studio 编译器忽略文件？

> ID：615058
> 
> 赞同：11
> 
> 时间：2009-03-05T14:44:01.807
> 
> 标签：visual-studio, compiler-construction, configuration-files, config

有没有人知道在编译时让 Visual Studio 完全忽略文件的方法？我有一个 C# 解决方案，它有一个 foo.config 文件，它不是真正的标准配置文件——它只是一个文本文件。在编译过程中，VS 会抓住文件和炸弹。

我想让它表现得好像它只是一个文本文件。我没有更改文件名的选项。

编辑：请注意 BuildAction 不会从编译器中排除文件检查它们。它只是决定文件是否被编译到程序集中，它是否是内容（如 jpg 或其他东西），或者它是否是资源文件。有关详细信息：[请参阅 MSDN 页面](http://msdn.microsoft.com/en-us/library/0c6xyb66(VS.80).aspx)。

EDIT2：显然，如果您有一个名为 foo.config 的文本文件并且在构建时将其打开，VS2005 会弹出一个错误，认为该文件应该是 xml。但是，如果您关闭该文件，VS2005 将忽略它。

解决方案：如果在构建期间打开了不合规的文件，Visual Studio 验证会导致错误。有关如何关闭此功能的示例（对于 HTML），请参阅[Scott Guthrie 的帖子](http://weblogs.asp.net/scottgu/archive/2005/11/23/431350.aspx)。正如艾伦所说，您还应该将 Build Action 设置为“None”。不幸的是，如果您打开文件，这不会停止构建错误。

* * *

## 回答 #1

> 赞同：24
> 
> 时间：2009-03-05T14:47:16.603

右键单击>属性

构建操作：设置为“无”

编辑：如果你在谈论 app.config，你真的不能弄乱它的格式，你需要把它放在一个不同的 .config 文件中。

我只是仔细检查了一下，VS.net 不在乎，只要它不是 app.config 或 web.config 并且配置文件构建操作设置为“无”，如果您打开文件，它将“错误”，但它不会导致构建失败或阻止它构建程序集。

关闭文件，错误就会消失，类似于您遇到的有关 HTML 标记的错误。这些“错误”的显示可能是 vs.net 中的可配置设置

* * *

## 回答 #2

> 赞同：5
> 
> 时间：2009-03-05T14:47:16.027

要采取的操作取决于解决方案和文件类型。例如（在 VS2005 中），在 C++ 解决方案中，我可以在解决方案资源管理器中右键单击源文件名并查看其属性。第一个“常规”选项是“从构建中排除”，这将允许您将文件从构建过程中排除，而不会完全从项目中排除。

我在 C# 解决方案中提取了一个 .config 文件，并在“高级”部分下找到了“构建操作”选项。这可能应该设置为“无”。

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2009-03-05T14:46:26.543

只需右键单击文件并选择“从项目中排除”。

如果您仍想在项目中看到它，请选择项目并单击解决方案资源管理器顶部的“显示所有文件”按钮。这将显示目录树中的所有文件，即使它们实际上不是项目的一部分。

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2009-03-05T14:46:54.590

你确定VS编译.config文件？？？

您应该在文件选项中检查它的构建操作，并且可以将其设置为无。

# java - 在 Java 中实现朋友（在 C++ 中可用）功能

> ID：615063
> 
> 赞同：1
> 
> 时间：2009-03-05T14:44:54.673
> 
> 标签：java, javadoc

好吧，让我们离开友谊是否打破封装的争论，并实际尝试优雅地提出一个连贯的设计。这是一个双重功能：

1）关于如何实施的一般问题：

```
 public class A 
   {
      friend class B;
   } 
```

2) 为什么我需要这个功能？我的一些类实现了 Serializable 接口。但是，我想在 Derived 类中保护 Serializable 方法，这样我就不会将它们暴露给客户端（以及文档——javadoc）。但是，内部类应该能够访问它们。在java中解决这个问题的一般方法是什么？

注意：我使用当前 C++ 标准中定义的友谊。

谢谢

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2009-03-05T14:49:13.760

一般的解决方案是使方法包私有（这是 Java 中的默认保护级别）。这样，同一包中的任何代码都可以访问它们，但不能访问外部代码。

Java 不允许与特定的外部类任意共享方法。

编辑：受保护的成员实际上*不如*包私有。如果您有受保护的成员，您可以从包外的派生类和包内的任何类访问它们。所以这可能是您问题的解决方案 - 在您要导出到的包中的另一个类中派生该类。

Java一般认为包是封装的主要模块。public/protected 接口用于包外的类，默认保护级别允许包内的访问。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2009-03-05T15:08:42.293

好像你想要一个外观。

您似乎有一个类需要公开访问实现中涉及的各种其他类（甚至在不同的包中）。但是您不希望客户有权访问。

因此，使实现尽可能复杂。有一个外观类，只有你想要的接口，委托给实现。

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2012-09-27T19:00:39.897

此链接提供了一种在 Java 中模拟朋友访问的方法：http: [//macchiato.com/columns/Durable7.html](http://macchiato.com/columns/Durable7.html)

从链接复制的代码（以防网站无法访问）：

```
public class A {
private int privateInt = 31415;

public class SomePrivateMethods {
    public int getSomethingPrivate() { return privateInt; }
    private SomePrivateMethods() {} // no public constructor
}
public void giveKeyTo(B other) {
    other.receiveKey(new SomePrivateMethods());
}
}

public class B {
private A.SomePrivateMethods key;

public void receiveKey(A.SomePrivateMethods key) {
    this.key = key;
}

public void usageExample() {
    A anA = new A();

    //int foo = anA.privateInt; // doesn't work, not accessible

    anA.giveKeyTo(this);
    int fii = key.getSomethingPrivate();
    System.out.println(fii);
}
} 
```

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2009-03-05T15:44:38.243

我注意到一件事......听起来你不希望你必须重写的方法，因为你正在实现 Serializable 以公开。但有一件事，Serializable 是一个标记接口（它不提供被覆盖的方法），并且 readObject 和 writeObject 方法应该是私有的。

我错过了什么吗？

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2011-05-27T15:45:03.900

您的问题有两种解决方案，它们不涉及将所有类保存在同一个包中。

第一种是使用(Practical API Design, Tulach 2008) 中描述的 Friend Accessor/ [Friend Package模式。](http://wiki.apidesign.org/wiki/APIDesignPatterns:FriendPackages)

二是使用OSGi。[这里](http://www.1biznow.com/2009/02/hide-private-parts-of-your-bundle.html)有一篇文章解释了 OSGi 是如何做到这一点的。

相关问题：[1](https://stackoverflow.com/questions/5872124/how-to-hide-the-internal-structure-of-a-java-api-to-the-rest-of-the-world/6154321#6154321)、[2](https://stackoverflow.com/questions/4759692/hiding-classes-in-a-jar-file)、[3](https://stackoverflow.com/questions/4647599/why-friend-directive-is-missing-in-java)和[4](https://stackoverflow.com/questions/182278/is-there-a-way-to-simulate-the-c-friend-concept-in-java)。

# c++ - How can I make my C++ ActiveX control print nicely in Excel?

> ID：615068
> 
> 赞同：3
> 
> 时间：2009-03-05T14:45:44.267
> 
> 标签：c++, excel, printing, activex

I am trying to get my ActiveX control to print out nicely in Excel.

The control is written in C++. Originally I generated the control using the Visual Studio 2005 wizard. I have tested this with a simple wizard generated control to experiment with the OnDraw function and I discovered that even a control straight out of the wizard doesn't print well either. It appears to clip out a large portion of the control - which by default renders a black outline and some text in the centre.

The function IDataObject_GetData is called on my ActiveX control which in turn creates a metafile and renders to it.

Does anyone know how to get an ActiveX control to print out nicely? Alternatively links to useful information will be appreciated.

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-03-05T16:42:15.313

经过多次头疼后，我找到了解决问题的方法。

Visual Studio 2005 向导生成的`OnDraw`函数通过调用该函数来设置剪辑区域`SelectClipRgn`。正是这种剪裁设置导致 ActiveX 控件在打印时出现剪裁。注释掉代码可以使 ActiveX 控件完美地打印出来。注释掉代码似乎也不会导致任何其他问题 - 至少在我的情况下不会。

我只能假设用于剪辑的任何坐标系都与绘制到元文件 DC 时使用的坐标系不兼容。

以下是一些我发现的有关打印 ActiveX 控件的有用信息的链接：

[http://www.codeproject.com/KB/COM/officeatlprint.aspx](http://www.codeproject.com/KB/COM/officeatlprint.aspx)

[http://www.codeproject.com/KB/COM/WirgerPrintArticle.aspx](http://www.codeproject.com/KB/COM/WirgerPrintArticle.aspx)

[http://support.microsoft.com/kb/81497](http://support.microsoft.com/kb/81497)

[http://support.microsoft.com/kb/84984](http://support.microsoft.com/kb/84984)

# ruby - 迭代序列并一次更改一个对象的最佳方法（Ruby）

> ID：615069
> 
> 赞同：2
> 
> 时间：2009-03-05T14:45:54.720
> 
> 标签：ruby

我是 ruby​​ 的新手，感觉我仍然以 C 语言的方式做很多事情 :-)。假设您有一个对象数组（问题：has_many=>:answers）。我想遍历所有答案，如果某些答案符合标准，请更改答案属性。目前我这样做如下：

```
def iterate_and_do_stuff
   for (a in self.answers)
      if(a.somecriteria==true)
         a.some_attr=some_val
      end
   end
end 
```

还有什么其他方法可以做到这一点？块，循环等？

请建议。

谢谢你。

* * *

## 回答 #1

> 赞同：12
> 
> 时间：2009-03-05T14:50:58.467

使用[Array#each](http://www.ruby-doc.org/docs/ProgrammingRuby/html/ref_c_array.html#Array.each)：

`self.answers.each {|a| a.some_attr = some_val if a.some_criteria}`

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2009-03-05T15:12:32.407

我更喜欢地图！或收集！在这种情况下，因为您可以使用 ! 语义上表示您正在更改数组的方法。

```
self.answers.map!{ |a| 
   a.some_criteria ? (a.some_attr = some_val) : a.some_attr  
} 
```

或者

```
self.answers.collect!{ |a| 
   a.some_criteria ? (a.some_attr = some_val) : a.some_attr
} 
```

这样很明显你打算改变数组。

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2009-03-05T14:57:12.040

```
self.answers.select{|a| a.somecriteria}.each{|a| a.some_attr = some_val} 
```

或者

```
self.answers.find_all{|a| a.somecriteria}.each{|a| a.some_attr = some_val} 
```

不过，两者都比您的原始代码效率低。

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2009-03-05T14:54:34.883

只是为了好玩

```
self.answers.select{|a| a.some_criteria}.each{|a| a.some_attr = some_val} 
```

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2009-03-06T20:35:50.733

如果您使用 ActiveRecord 模型，请不要忘记您可以在数据库级别而不是在内存中进行选择。换句话说，您可以从数据库中仅检索您想要放入数组的值，然后简单地更改这些值。

这是一个使用自定义查找器的示例（一种较旧的方法）：

```
class Question < ActiveRecord::Base
  has_many :answers do
    def accepted
      find :all, :conditions => { :accepted => true }
    end
  end
end

class Answer < ActiveRecord::Base
  belongs_to :question
end

q = Question.find :first
q.answers.accepted.each { |a| a.do_something! } 
```

或者你可以用另一个协会来做：

```
class Question < ActiveRecord::Base
  has_many :answers
  has_many :accepted_answers, :class_name => "Answer", :conditions => { :accepted => true }
end

class Answer < ActiveRecord::Base
  belongs_to :question
end

q = Question.find :first
q.accepted_answers.each { |a| a.do_something! } 
```

这是另一个在您的子类上使用命名范围（更新一点，在我看来是首选）的示例：

```
class Question < ActiveRecord::Base
  has_many :answers
end

class Answer < ActiveRecord::Base
  belongs_to :question
  named_scope :accepted, :conditions => { :accepted => true }
end

q = Question.find :first
q.answers.accepted.each { |a| a.do_something! } 
```

但在任何情况下，您都抽象了“选择”，这有一些好处：

1.  在大型集合的情况下更快
2.  您已将较低级别的选择标准抽象为具有较高级别语义含义的内容，这使您的代码更易于阅读和维护

# silverlight - Problem with WCF-Service between Silverlight and Azure Cloud WebRole

> ID：615070
> 
> 赞同：3
> 
> 时间：2009-03-05T14:45:56.730
> 
> 标签：silverlight, wcf, azure

I want to use a Silverlight application in a cloud on Azure. The communication between the Silverlight application and the WebRole is a WCF-Service with Basic-HTTP-Binding. My problem is, that the communication doesn't work. I think the endpoint-address is not correct, but I'm not sure.

Can someone help me?

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2009-03-06T09:51:14.620

您是否尝试过使用[Fiddler](http://www.fiddlertool.com/fiddler/)，它至少会告诉您终点是否正确。如果有任何权限问题，它也应该有所帮助。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-04-11T15:46:15.933

我发现[Silverlight Web 服务团队博客](http://blogs.msdn.com/silverlightws/)引用了这些[示例](http://code.msdn.com/wcfazure)。已知[问题 Wiki](http://code.msdn.microsoft.com/wcfazure/Wiki/View.aspx?title=KnownIssues&referringTitle=Home)也很有帮助。这些示例使用二进制 HTTP 绑定而不是 BasicHttpBinding，但它们完成了工作。

如果您像我一样运行 Vista，您可能需要为 IIS 7 注册 WCF MIME 类型。您可以在提升模式下运行命令提示符并执行以下命令：

> C:\Windows\Microsoft.NET\Framework\v3.0\Windows Communication Foundation\ServiceModelReg.exe -i

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-04-06T16:28:26.243

链接到 Azure 中的 Web 服务存在问题。我会检查 Silverlight 应用程序中的端点，并确保它与 Azure 应用程序中使用的端口相同。

我在通过 Azure 实验室工作时遇到了同样的问题并重写了练习 3（使用 WCF）以便它可以工作 - 现在可以在 CodeProject 上使用（[http://www.codeproject.com/articles/34612/Getting-WCF -to-work-with-Azure.aspx](http://www.codeproject.com/articles/34612/Getting-WCF-to-work-with-Azure.aspx)）。

我基于 David Burela 的 House-o-blog 上的一篇文章，他对问题的描述可以在他的博客上找到。

# mysql - Storing SQL field names and general SQL usage with Delphi

> ID：615073
> 
> 赞同：3
> 
> 时间：2009-03-05T14:46:27.120
> 
> 标签：mysql, database, delphi, field, names

I'm starting to write my first Delphi application that connects to an SQL database (MySQL) using the ADO database components. I wondered whether there was any best way of storing the names of the fields in the database for easy reference when creating SQL queries later on.

First of all I made them a simple constant e.g. `c_UserTable_Username, c_UserTable_Password`, but then decided that was not a particularly good way of doing things so I am now storing them in a constant record e.g.:

```
type
   TUserTable = record
     TableName : String;
     Username : String;
     Password : String;
 end;

const
UserTable : TUserTable =
    (
      TableName : 'users';
      Username : 'Username';
      Password : 'Password';
    ); 
```

this allows me to create a statement like:

```
query.SQL.Add('SELECT ' + UserTable.Username + ' FROM ' + UserTable.TableName); 
```

and not have to worry about hard coding the field names etc.

I've now run into the problem however where if I want to cycle through the table fields (for example if there are 20 or so fields), I can't. I have to manually type the record reference for every field.

I guess what I'd like to know is whether there is a way to iterate though all field names at once, or singularly; or am I going about this the wrong way? Perhaps I shouldn't be storing them like this at all?

Also, I've made a “Database” class which basically holds methods for many different SQL statements, for example GetAllUsers, GetAllProducts, etc. Does that sound correct? I've taken a look at a lot of Delphi/SQL tutorials, but they don't seem to go much past showing you how to run queries.

I suppose I'm just a little lost and any help is very welcome. Thanks :)

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2009-03-05T21:55:11.050

您还可以将查询存储为 RESOURCESTRING，这将允许在事后使用资源编辑器（如有必要）对其进行编辑。

```
RESOURCESTRING
  rsSelectFromUsers = 'SELECT USERNAME FROM USERS '; 
```

您的数据库类方法效果很好。我已经在我的几个项目中做到了这一点，将接口返回到包含数据集的对象......这样做的好处是当返回的接口变量超出范围时，数据集将被关闭并清除。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2009-03-05T14:51:44.423

好吧，您是对字段名称进行硬编码；您只需将它们硬编码在 const 中，而不是在查询本身中。我不确定这实际上会改善什么。就遍历字段而言，试试这个：

```
var
  Field: TField;
begin
  for Field in query.Fields do begin
     // do stuff with Field
  end;
end; 
```

我可能会使用 TDataModule，而不是创建“数据库”类。这与您的类几乎相同，只是它允许您在设计时交互式地设计查询。您可以将所需的任何方法放在 DataModule 上。

这也使得实例化持久 TField 变得非常容易（请参阅有关该主题的帮助），您可能会发现比使用 const 存储字段名称更符合您的喜好的解决方案。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2009-03-06T02:01:59.460

如果您真的要使用如图所示的数据库类，请考虑记录在 D2007 及更高版本中包含函数的能力。

例如，您的示例将变为：

```
type
   TUserTable = record
     TableName : String;
     Username : String;
     Password : String;
     function sqlGetUserName(where:string=''):string;
   end;

const
UserTable : TUserTable =
    (
      TableName : 'users';
      Username : 'Username';
      Password : 'Password';
    );

function TUserTable.sqlGetUserName(where:string=''): string;
begin
if where='' then result := Format('SELECT %s from %s', [userName, tableName])
else             result := Format('SELECT %s from %s where %s', [userName, tableName, where]);
end; 
```

这使得：

```
query.SQL.add(userTable.sqlGetUserName); 
```

或者

```
query.SQL.add(userTable.sqlGetUserName(Format('%s=%s', [userTable.userName,'BOB'])); 
```

正如您所说明的那样，我真的不建议直接使用 SQL。在我看来，你永远不应该对表进行直接的 SQL 调用。这在 UI 和数据库（不应该存在）之间引入了很多耦合，并阻止您对直接表修改设置高级别的安全性。

我会将所有内容包装到存储过程中，并拥有一个数据库接口类，将所有数据库代码封装到一个数据模块中。您仍然可以使用直接链接到数据模块中的数据感知组件，您只需在链接前加上 DM 名称即可。

例如，如果您构建了一个类似的类：

```
type
   TDBInterface = class
      private
         function q(s:string):string; //just returns a SQL quoted string
      public
         procedure addUser(userName:string; password:string);
         procedure getUser(userName:string);
         procedure delUser(userName:string);

         function testUser:boolean;

         procedure testAllDataSets;
      end;

function TDBInterface.q(s:string):string;
begin
result:=''''+s+'''';
end;

procedure TDBInterface.addUser(userName:string; password:string);
begin
cmd.CommandText:=Format( 'if (select count(userName) from users where userName=%s)=0 '+
                         'insert into users (userName, password) values (%s,%s) '+
                         'else '+
                         'update users set userName=%s, password=%s where userName=%s',
                         [q(userName), q(userName), q(password), q(userName), q(password), q(userName)]);
cmd.Execute;
end;

procedure TDBInterface.getUser(userName:string);
begin
qry.SQL.Add(Format('select * from users where userName=%s', [q(userName)]));
qry.Active:=true;
end;

procedure TDBInterface.delUser(userName:string);
begin
cmd.CommandText:=Format('delete from users where userName=%s',[userName]);
cmd.Execute;
end;

procedure TDBInterface.testAllDataSets;
begin
assert(testUser);
end;

function TDBInterface.testUser: boolean;
begin
result:=false;

   addUser('99TEST99','just a test');
   getUser('99TEST99');
   if qry.IsEmpty then exit;
   if qry.FieldByName('userName').value<>'99TEST99' then
      exit;
   delUser('99TEST99');
   if qry.IsEmpty then
      result:=true;
end; 
```

您现在可以在数据接口上进行某种形式的单元测试，您已经从 UI 中删除了 SQL，并且事情正在好转。你的接口代码中仍然有很多丑陋的 SQL，所以把它移到存储过程中，你会得到：

```
type
   TDBInterface = class
      public
         procedure addUser(userName:string; password:string);
         procedure getUser(userName:string);
         procedure delUser(userName:string);

         function testUser:boolean;

         procedure testAllDataSets;
      end;

procedure TDBInterface.addUser(userName:string; password:string);
begin
cmd.CommandText:='usp_addUser;1';
cmd.Parameters.Refresh;
cmd.Parameters.ParamByName('@userName').Value:=userName;
cmd.Parameters.ParamByName('@password').Value:=password;
cmd.Execute;
cmd.Execute;
end;

procedure TDBInterface.getUser(userName:string);
begin
sproc.Parameters.ParamByName('@userName').Value:=userName;
sproc.Active:=true;
end;

procedure TDBInterface.delUser(userName:string);
begin
cmd.CommandText:='usp_delUser;1';
cmd.Parameters.Refresh;
cmd.Parameters.ParamByName('@userName').Value:=userName;
cmd.Execute;
end; 
```

您现在可以将其中一些函数移动到 ADO 线程中，并且 UI 不会知道添加或删除用户是在单独的进程中发生的。请注意，这些都是非常简单的操作，因此如果您想做一些方便的事情，例如在处理完成时通知父级（例如在添加/删除/更新发生后刷新用户列表），您需要将其编码到线程中模型。

顺便说一句，添加代码的存储过程如下所示：

```
create procedure [dbo].[usp_addUser](@userName varchar(20), @password varchar(20)) as
if (select count(userName) from users where userName=@userName)=0
   insert into users (userName, password) values (@userName,@password)
else 
   update users set userName=@userName, password=@password where userName=@userName 
```

另外，一点免责声明：这篇文章很长，虽然我试图检查大部分内容，但我可能在某个地方遗漏了一些东西。

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2009-06-05T19:14:55.040

可能有点离题，但您可以使用RemObjects 中的[Data Abstract](http://www.dataabstract.com/)。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2009-06-05T13:12:16.437

[在Analyzing DataSets（在 Delphi 和 Kylix 中）](http://www.drbob42.com/examines/examin17.htm)获取战利品

该代码是操作表元数据的一个很好的例子。您可以获取字段名称，然后编写可以创建基本单元/或其接口部分的代码生成器。

# apache-flex - Flex - 将滚动条的位置更改到 Horizo ntalList 组件的顶部

> ID：615074
> 
> 赞同：3
> 
> 时间：2009-03-05T14:46:31.457
> 
> 标签：apache-flex, actionscript-3, scrollbar, horizontallist

默认情况下，Horizo​​ntalList 组件的 Horizo​​ntal ScrollBar 将位于底部。有没有办法重新定位它使其位于顶部？

为清楚起见，我并不是指使用 scrollToIndex 或 Horizo​​ntalScrollPosition 或类似方法移动滚动位置，而是使用滚动条组件的实际物理位置。

任何建议将不胜感激！

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2009-03-05T16:19:56.943

不久前我正在寻找类似的东西并找到[了这篇文章](http://yourpalmark.com/2008/06/18/reposition-scrollbars-in-flex-components/)。我最终以另一种方式解决了我的问题，因此没有使用该解决方案，但是它可能适用于您想要的。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-03-24T08:10:13.493

我以前必须做同样的事情。我不得不在基类中挖掘（以处理一些掩蔽/定位问题），这就是我想出的：

```
package
{
    import flash.display.DisplayObject;

    import mx.controls.HorizontalList;
    import mx.core.EdgeMetrics;

    public class ReverseHList extends HorizontalList
    {
        override protected function updateDisplayList(unscaledWidth:Number, unscaledHeight:Number):void
        {
            super.updateDisplayList(unscaledWidth, unscaledHeight);

            var w:Number = unscaledWidth;
            var h:Number = unscaledHeight;
            var vm:EdgeMetrics = viewMetrics;
            if (horizontalScrollBar && horizontalScrollBar.visible)
            {
                horizontalScrollBar.setActualSize(w - vm.left - vm.right,
                                                  horizontalScrollBar.minHeight);
                horizontalScrollBar.move(vm.left, vm.top);

                horizontalScrollBar.enabled = enabled;
            }

            var mask:DisplayObject = maskShape;

            var wd:Number = w - vm.left - vm.right;
            var ht:Number = h - vm.top - vm.bottom;

            mask.width = wd < 0 ? 0 : wd;
            mask.height = ht < 0 ? 0 : ht;

            mask.x = vm.left;
            mask.y = vm.top + vm.bottom;
        }

        override protected function adjustListContent(unscaledWidth:Number = -1,
                                       unscaledHeight:Number = -1):void
        {
            super.adjustListContent(unscaledWidth, unscaledHeight);

            var lcx:Number = viewMetrics.left + listContent.leftOffset;
            var lcy:Number = (viewMetrics.top + listContent.topOffset) + viewMetrics.bottom;
            listContent.move(lcx, lcy);
        }

    }
} 
```

# c# - 从 C# Windows 窗体向我的域中的客户端发送消息框

> ID：615086
> 
> 赞同：1
> 
> 时间：2009-03-05T14:47:49.487
> 
> 标签：c#

我有一个 Windows 窗体项目，而不是将文件和文件夹复制到我域中的客户端。将文件或将目录进程复制到我域中的 [x] 客户端时。我想向它发送一个消息框，上面写着“您的 [xdirectory] ​​中有一个新文件夹或文件”。

我不能通过 Messenger 服务来做到这一点，因为 Messenger 服务在 XP Sp2 中不起作用，所以我需要另一种方法。也许可以制作客户端/服务器端应用程序。客户端中会有一个监听器应用程序，然后我将向它发送一个`messagebox.show`代码，然后它会向我们显示一个消息框。等等

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2009-03-05T15:01:38.860

我以前做过一次类似的事情。我从其他地方获得了大部分代码，但我不记得是从哪里获得的。

首先是服务器代码：

```
public class HSTcpServer
{
    private TcpListener m_listener;
    private IPAddress m_address = IPAddress.Any;
    private int m_port;
    private bool m_listening;   
    private object m_syncRoot = new object();
    public event EventHandler<TcpMessageReceivedEventArgs> MessageReceived;

    public HSTcpServer(int port)
    {
        m_port = port;
    }

    public IPAddress Address
    {
        get { return m_address; }
    }

    public int Port
    {
        get { return m_port; }
    }

    public bool Listening
    {
        get { return m_listening; }
    }

    public void Listen()
    {
        try
        {
            lock (m_syncRoot)
            {
                m_listener = new TcpListener(m_address, m_port);

                // fire up the server
                m_listener.Start();

                // set listening bit
                m_listening = true;
            }

            // Enter the listening loop.
            do
            {
                Trace.Write("Looking for someone to talk to... ");

                // Wait for connection
                TcpClient newClient = m_listener.AcceptTcpClient();
                //Trace.WriteLine("Connected to new client");

                // queue a request to take care of the client
                ThreadPool.QueueUserWorkItem(new WaitCallback(ProcessClient), newClient);
            }
            while (m_listening);
        }
        catch (SocketException se)
        {
            Trace.WriteLine("SocketException: " + se.ToString());
        }
        finally
        {
            // shut it down
            StopListening();
        }
    }

    public void StopListening()
    {
        if (m_listening)
        {
            lock (m_syncRoot)
            {
                // set listening bit
                m_listening = false;
                // shut it down
                m_listener.Stop();
            }
        }
    }

    private void sendMessage(string message)
    {
        // Copy to a temporary variable to be thread-safe.
        EventHandler<TcpMessageReceivedEventArgs> messageReceived = MessageReceived;
        if (messageReceived != null)
            messageReceived(this, new TcpMessageReceivedEventArgs(message));
    }

    private void ProcessClient(object client)
    {
        TcpClient newClient = (TcpClient)client;
        try
        {
            // Buffer for reading data
            byte[] bytes = new byte[1024];
            StringBuilder clientData = new StringBuilder();

            // get the stream to talk to the client over
            using (NetworkStream ns = newClient.GetStream())
            {
                // set initial read timeout to 1 minute to allow for connection
                ns.ReadTimeout = 60000;
                // Loop to receive all the data sent by the client.
                int bytesRead = 0;
                do
                {
                    // read the data
                    try
                    {
                        bytesRead = ns.Read(bytes, 0, bytes.Length);
                        if (bytesRead > 0)
                        {
                            // Translate data bytes to an ASCII string and append
                            clientData.Append(Encoding.ASCII.GetString(bytes, 0, bytesRead));
                            // decrease read timeout to 1 second now that data is 
                            // coming in
                            ns.ReadTimeout = 1000;
                        }
                    }
                    catch (IOException ioe)
                    {
                        // read timed out, all data has been retrieved
                        Trace.WriteLine("Read timed out: {0}", ioe.ToString());
                        bytesRead = 0;
                    }
                }
                while (bytesRead > 0);

                bytes = Encoding.ASCII.GetBytes("clowns");

                // Send back a response.
                ns.Write(bytes, 0, bytes.Length);
                sendMessage(clientData.ToString());
            }
        }
        finally
        {

            // stop talking to client
            if (newClient != null)
                newClient.Close();
        }
    }
}

public class TcpMessageReceivedEventArgs : EventArgs
{
    private string m_message;

    public TcpMessageReceivedEventArgs(string message)
    {
        m_message = message;
    }

    public string Message
    {
        get
        {
            return m_message;
        }
    }
} 
```

客户代码：

```
 class HSTcpClient
{
    private TcpClient _client;
    private IPAddress _address;
    private int _port;
    private IPEndPoint _endPoint;
    private bool _disposed;

    public HSTcpClient(IPAddress address, int port)
    {
        _address = address;
        _port = port;
        _endPoint = new IPEndPoint(_address, _port);
    }

    public void SendForwardedClientMessage(int senderId, int receiverId, int hsId)
    {
        SendMessage(senderId.ToString() + ":" + receiverId.ToString() + ":" + hsId.ToString());
    }

    public void SendUpdatedCGBMessage()
    {
        SendMessage("Update your CGB you clowns");
    }

    public void SendMessage(string msg)
    {
        try
        {
            _client = new TcpClient();
            _client.Connect(_endPoint);

            // Get the bytes to send for the message
            byte[] bytes = Encoding.ASCII.GetBytes(msg);
            // Get the stream to talk to the server on
            using (NetworkStream ns = _client.GetStream())
            {
                // Send message
                Trace.WriteLine("Sending message to server: " + msg);
                ns.Write(bytes, 0, bytes.Length);
                // Get the response
                // Buffer to store the response bytes
                bytes = new byte[1024];

                // Display the response
                int bytesRead = ns.Read(bytes, 0, bytes.Length);
                string serverResponse = Encoding.ASCII.GetString(bytes, 0, bytesRead);
                Trace.WriteLine("Server said: " + serverResponse);
            }
        }
        catch (SocketException se)
        {
            Trace.WriteLine("There was an error talking to the server: " +
                se.ToString());
        }
        finally
        {
            Dispose();
        }
    }

    #region IDisposable Members

    public void Dispose()
    {
        Dispose(true);
        System.GC.SuppressFinalize(this);
    }

    private void Dispose(bool disposing)
    {
        if (!_disposed)
        {
            if (disposing)
            {
                if (_client != null)
                    _client.Close();
            }
            _disposed = true;
        }
    }

    #endregion

} 
```

然后使用，在您的表单代码中创建一个服务器变量：

```
private HSTcpServer m_server; 
```

我创建了一个后台工作线程：

```
private System.ComponentModel.BackgroundWorker hsTcpServerThread; 
```

处理 DoWork 事件：

```
private void hsTcpServerThread_DoWork(object sender, DoWorkEventArgs e)
    {
        m_server = new HSTcpServer(<pick your port>);
        m_server.MessageReceived += new EventHandler<TcpMessageReceivedEventArgs>(m_server_MessageReceived);
        m_server.Listen();
    } 
```

然后处理收到的消息事件：

```
void m_server_MessageReceived(object sender, TcpMessageReceivedEventArgs e)
    {
        //<your code here> - e contains message details
    } 
```

然后向服务器发送消息：

```
HSTcpClient client = new HSTcpClient(<ip address>, <port you picked>);
            client.SendForwardedClientMessage(<message details>); 
```

希望我在那里得到了一切。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2009-03-05T14:58:26.093

您可以在客户端中使用[FileSystemWatcher](http://msdn.microsoft.com/en-us/library/system.io.filesystemwatcher.aspx)。这样您就不必处理远程处理或侦听端口。

如果您真的想在两台机器之间进行通信，您可以使用[远程处理](http://msdn.microsoft.com/en-us/library/ms973857.aspx)或通过[TcpListener 进行](http://msdn.microsoft.com/en-us/library/system.net.sockets.tcplistener.aspx)。

# tsql - TSQL 字符串连接在 WHILE 循环中不起作用？

> ID：615087
> 
> 赞同：2
> 
> 时间：2009-03-05T14:48:04.730
> 
> 标签：tsql, string

下面的代码不起作用，有什么想法吗？

```
declare @Counter int
set @Counter = 0
declare @ConcText nvarchar(1000)

while @Counter < 5
begin
    --set @ConcText = @ConcText + cast(@Counter as nvarchar(10)) + N' counter,'
    --set @ConcText = @ConcText + convert(nvarchar(10), @Counter) + N' counter,'
    set @ConcText = @ConcText + N' counter,'
    set @Counter = @Counter + 1
end
print @ConcText --<-- this is null, why  ?? 
```

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2009-03-05T14:50:51.023

请参阅[MSDN：+（字符串连接）（Transact-SQL）](http://msdn.microsoft.com/en-us/library/ms177561.aspx)：

> 就像对空值执行的算术运算一样，当将空值添加到已知值时，结果通常是未知值，对空值执行的字符串连接操作也应该产生空结果。

因此，为了让事情顺利进行，最好在声明后立即启动 varchar 变量：

```
DECLARE @ConcText NVARCHAR(1000)
SET @ConcText  = '' 
```

处理 NULL concat 问题的其他方法（如果您不知道值是否为 NULL） - ISNULL 或 COALESCE：

```
SET @ConcText = ISNULL(@ConcText, '') + N' counter,'
SET @ConcText = COALESCE(@ConcText, '') + N' counter,' 
```

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2009-03-05T14:51:40.163

您没有在开始时将 @ConcText 设置为任何内容，因此当您将任何内容连接到 NULL 时，您会得到 NULL。

# log4net - Log4Net：滚动文件附加器，定义扩展

> ID：615092
> 
> 赞同：70
> 
> 时间：2009-03-05T14:49:42.603
> 
> 标签：log4net, config, rollingfileappender

我希望我的日志文件看起来像这样：2009-02-13.log

但问题是我似乎找不到任何添加 .log 扩展名的方法。

我已经尝试了很多东西，但没有任何帮助。这就是我到目前为止所拥有的：

```
<appender name="RollingFileAppender" type="log4net.Appender.RollingFileAppender">
    <file value="Logs/Log4Net/.log"/>
    <appendToFile value="true"/>
    <rollingStyle value="Date"/>
    <datePattern value="yyyy-MM-dd" />
    <layout type="log4net.Layout.PatternLayout">
      <conversionPattern value="%date [%thread] %-5level %logger [%property{NDC}] - %message%newline"/>
    </layout>
</appender> 
```

* * *

## 回答 #1

> 赞同：120
> 
> 时间：2009-03-16T17:12:11.527

其他答案转义了“log”中的“g”，因为“g”是 datePattern 中的特殊字符。这没有错，但我更喜欢将整组非日期字符用单引号括起来，如下所示：

```
<datePattern value="yyyy-MM-dd'.log'" /> 
```

这给出了相同的结果，但对我来说更容易管理。这样，我不必回忆哪些特定字符对于 datePattern 是特殊的（列表很长且多种多样）。如果我忘记了一个字符，那么我就不会冒冒名的风险；他们都很好地逃脱了集体。

* * *

## 回答 #2

> 赞同：60
> 
> 时间：2009-03-05T14:58:51.130

尝试像这样将 .log 扩展名添加到您的日期模式并将其从文件属性中删除。

```
<datePattern value="yyyy-MM-dd.lo\g"/>
...
<staticLogFileName value="false" /> 
```

* * *

## 回答 #3

> 赞同：21
> 
> 时间：2014-04-15T08:37:57.120

log4net 现在还提供了一个`PreserveLogFileNameExtension`属性，可以强制您的 .log 扩展名到复合文件名的末尾（包括日期模式和/或大小序列号）：

```
<file value="LogFiles/.log"/>
<preserveLogFileNameExtension value="true" />
<datePattern value="yyyy-MM-dd" /> 
```

* * *

## 回答 #4

> 赞同：8
> 
> 时间：2009-03-05T14:59:07.823

将“.lo\g”添加到日期模式的末尾

* * *

## 回答 #5

> 赞同：4
> 
> 时间：2012-11-22T13:35:37.203

这是我的日志文件 xml 配置。日志文件的路径在“file”标签中

这将在我网站的路由文件夹中的文件夹“LogFiles”下创建一个日志文件“2012-11-22.log”。

**注意：首先确保该文件夹存在！**

```
<?xml version="1.0"?>
<configuration>
  <configSections>
    <section name="log4net" type="log4net.Config.Log4NetConfigurationSectionHandler,     log4net"/>
  </configSections>
  <log4net>
    <root>
      <level value="INFO"/>
      <appender-ref ref="RollingFileAppender"/>
    </root>
    <appender name="RollingFileAppender" type="log4net.Appender.RollingFileAppender">
      <file value="LogFiles/"/>
      <appendToFile value="true"/>
      <rollingStyle value="Date"/>
      <maxSizeRollBackups value="5"/>
      <maximumFileSize value="10MB"/>
      <datePattern value="yyyy-MM-dd'.log'" />
      <staticLogFileName value="false"/>
      <layout type="log4net.Layout.PatternLayout">
        <conversionPattern value="%date [%thread] %level %logger - %message%newline%exception"/>
      </layout>
    </appender>
  </log4net>
</configuration> 
```

# sql - 标签/关键字匹配的最佳解决方案是什么？

> ID：615098
> 
> 赞同：5
> 
> 时间：2009-03-05T14:51:50.303
> 
> 标签：sql, search, stored-procedures, many-to-many

我正在寻找数据库中不同记录之间关键字匹配的最佳解决方案。这是一个经典问题，我发现了类似的问题，但没有具体的问题。

我已经完成了全文搜索、连接和子查询、临时表……所以我真的很想看看你们是如何解决这样一个常见问题的。

所以，假设我有两张桌子；`Products`并且`Keywords`它们`Products_Keywords`以经典的多对多关系与第三个表相关联。

如果我`Product`在页面上显示一条记录并想显示前*n 个*相关产品，最好的选择是什么？

我们应该考虑到记录可能共享多个关键字，这一事实应该确定最相关产品的排序。

我也对其他想法持开放态度，但由于性能原因，T-SQL 将是更可取的解决方案。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2009-03-05T15:56:19.340

我的第一个镜头是这样的：

```
SELECT
    P.product_id,
    COUNT(*)
FROM
    Product_Keywords PK1
INNER JOIN Product_Keywords PK2 ON
    PK2.keyword_id = PK1.keyword_id
INNER JOIN Products P ON
    P.product_id = PK.product_id
WHERE
    PK1.product_id = @product_id
GROUP BY
    P.product_id
ORDER BY
    COUNT(*) DESC 
```

Product_Keywords 到 Product_Keywords（PK2 到 PK1）的连接可能很粗糙，所以我无法谈论性能。这是我要开始的地方，然后看看优化。

作为 Assaf 评论的后续行动，需要考虑的一件事是，您可以为 Product_Keywords 和 SUM(PK1.weight) + SUM(PK2.weight) 添加“权重”以进行排名。只是一个想法。

编辑：详细说明权重...您可能决定要允许对关键字进行加权。不过，用于确定权重的实际方法将是一个商业决策，所以我真的不能在那里给你太多的指导。

作为一个例子，这个问题是关于“编程”、“关键字匹配”和“SQL”的。编程是相当通用的，所以如果两个问题有共同点，它仍然可能并不意味着它们是相关的，所以也许你只把它加权为 1。SQL 更具体一点，所以你可以加权为 5。关键字匹配既是问题的主要焦点，又非常具体，所以你可以用 10 来衡量它。

当然，这只是一个例子，正如我所说，权重的确切确定以及如何评分取决于具体的业务。您可能会认为匹配关键字的数量比权重更重要，因此权重可能仅用作决胜局等 HTH。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-03-05T15:44:05.437

好吧，也许类似于以下内容：

```
select p.productId, p.name, r.rank
from products p inner join (
/* this inner select should bring in only products that have at least one keyword
=> shared with the requested product, and will count the actual number shared (for ranking)*/
    select related.productId, count(related.productId) as rank
    from
        products_keywords related   inner join 
        products_keywords pk ON (pk.productId = @productId  AND related.keywordId = pk.keywordId)
    where related.productId <> @productId
    group by related.productId
) r on p.productId = r.productId
order by r.rank DESC /* added DESC (not in orignal solution, but needed to put higher ranked on top)*/ 
```

现在我严重怀疑这是一个最佳的 sql 语句，但它应该可以完成工作。我无法验证它，因为我只是从头开始编写它，没有实际的后备表或要测试的数据。

# c++ - 我应该在 C++ 之后学习 Python 吗？

> ID：615100
> 
> 赞同：8
> 
> 时间：2009-03-05T14:52:34.563
> 
> 标签：c++, python

我目前正在学习 C++ 并想学习另一种语言。
对于工作，我使用 C# + ASP（实际上是刚开始学习它），但我想要一些“不那么微软”且功能强大的东西。
我听说 Python 是一种流行且功能强大的语言，没有 C++ 复杂。但是很多人提到他们很难从 Python 回到 C++/Java，因为他们开始思考它，习惯了没有内存管理等等。你有什么建议？

* * *

## 回答 #1

> 赞同：30
> 
> 时间：2009-03-05T14:57:27.670

没有正确或错误的答案，真的。但我认为你会从学习 Python 中受益更多。鉴于 C# 和 C++ 之间的相似之处，您将从 Python 中学到不同的思维方式。你学会思考问题的方法越多，它对你作为程序员的影响就越大，不管是什么语言。

* * *

## 回答 #2

> 赞同：9
> 
> 时间：2009-03-05T14:56:24.083

从更静态的语言到动态语言的好处是改变你的编程范式——这不是变得“懒惰”而是实现完成事情的新方法，这将使你在任何语言中都变得更好。

* * *

## 回答 #3

> 赞同：4
> 
> 时间：2009-03-05T15:02:04.977

好吧，我在 C/C++、Java 和 C# 之后学习了 Python。Python 是一门很棒的语言，它的简单性和一致性改善了我的编码方式。它还帮助我更清楚地思考代码背后的算法。我可以继续说它给我带来的好处，相反我会总结学习它的原因 ->

> 学习一门新的语言不会带走，它会增加你的编程技能，并通过教你在每种语言所需*的思维框架之间转换来让你保持敏锐。*

所以去那里学习Python。您的代码将改进（TM）。

**PS**
1.如果你忽视他们的维护和维护，你将失去 C++（或任何其他语言）技能。这完全取决于你。

2.程序员（智能）懒惰是一种美德。

* * *

## 回答 #4

> 赞同：4
> 
> 时间：2009-03-05T15:03:13.927

许多人会争辩说，在C++ *之前*学习 Python 会受益匪浅。

*   语法障碍要低得多。
*   调试更加友好
*   有大量的库——包括电池，你知道的。在 Python 中试验 Web 抓取、XML 等很容易。同样，进入 C++ 的门槛要高得多。

学习 C/C++ 还是不错的，因为它与机器的联系很紧密。但是一个新的程序员可以从 Python 的探索中学到很多东西。

* * *

## 回答 #5

> 赞同：2
> 
> 时间：2009-03-05T14:56:50.153

我不认为“Python 让你变得懒惰”（无论如何，这个标题不错！）。
相反，在编程和生活中一样，了解一种以上的语言很重要；我认为您会发现 python 很有趣，并且与 C++ 或 C# 有很大不同，因此这些语言不会在您的脑海中混杂......

* * *

## 回答 #6

> 赞同：2
> 
> 时间：2009-03-05T15:05:22.473

Python 是 C++ 的补充，易于与 C++ 集成。（作为这种说法的证据，来自 Boost 的 C++ 专家使用 Python。）

正如您所说，Python 为您提供了一种在 Microsoft 轨道之外获得视角的方法。但即使在那里，如果您需要将 Python 与 MS 工具集成，还有 IronPython。

* * *

## 回答 #7

> 赞同：1
> 
> 时间：2009-03-05T14:58:00.150

学习更多的语言只会让你成为一个更好的开发者，不管他们的方法是什么。此外，您使用 C++（或至少是 C）的经验对于使用 Python 的 C API 编写应用程序的高性能部分非常有用，它可以让“原始”C 和 C++ 代码与纯 Python 代码很好地混合。

我仍然每天使用 Objective-C（内存管理之前的 1.0...）和 Python 编写代码。多样性实际上很有趣，而不是令人困惑；让事情变得无聊。

* * *

## 回答 #8

> 赞同：1
> 
> 时间：2009-03-05T14:59:03.097

锻炼你的大脑并提高你的技能。试一试函数式语言。

* * *

## 回答 #9

> 赞同：1
> 
> 时间：2009-03-05T15:02:37.597

这取决于您要编程的应用程序类型，例如对于需要访问数据库的网站，我会选择 Ruby（和 Ruby on Rails 框架），对于金融应用程序或需要大量并行处理的应用程序我会选择像 Haskell、oCaml 或新的 F# 这样的功能性编程语言，即使你在它们中编程不多，最后 3 种语言也会让你成为一个更好的程序员，顺便说一下 c# 最近在最新版本中添加越来越多的函数式编程特性。我会学习 Python 以获得安全性并利用各种应用程序。

* * *

## 回答 #10

> 赞同：1
> 
> 时间：2009-03-06T13:33:55.117

我按顺序学习了 C/C++、Java、Python 和 C#。

我实际上总是最终使用的两个是 C++ 和 Python；我发现 Java 和 C# 在它们之间占据的位置太窄了，以至于感觉需要大量使用它们（至少对于我所做的事情）。

我还认为我并没有真正“获得”C++ 函子，`boost::bind`直到我接触了 Python。

* * *

## 回答 #11

> 赞同：1
> 
> 时间：2009-08-05T19:53:14.600

许多语言与其他语言非常相似，但要在命令式和函数式/动态和静态/对象和过程语言之间移动，您确实需要训练自己在所使用语言的限制范围内思考。由于大多数项目至少需要几周时间，所以最初几天后这通常不是问题。

您会发现在业余时间/爱好发展中从您喜欢的语言+环境中切换出来会更加困难。

*   C、Macro Assembler => 基本相同——区别主要是库
*   C++、Java、C#、Delphi => 基本相同的范式 - 您可以快速学习如何利用特定语言的特性并从一种语法采用概念到另一种语法。基本上是一样的思维方式，最大的例外是你对内存管理的看法。

*   Python - 好语言，战略上比 ruby​​ 更好的选择，尽管 ruby​​ 的其他方面可以说是优越的。使 python 成为一个不错选择的原因是存在一种正式的语言体，它使不同平台上的 python 环境彼此非常兼容。

如果您有兴趣，请阅读`http://cmdematos.com/?p=120`有关做出战略性语言选择的文章。

* * *

## 回答 #12

> 赞同：0
> 
> 时间：2009-03-05T15:04:04.253

你可以学习一门新的编程语言，比如 python，并用它来完成你通常用你的“核心”语言执行的所有任务；或者您可以采用一种语言（如 python 或 perl）并使用它来补充您的核心语言。

您可以学习 VBScript 并使用它来编写将您的代码和其他代码粘合在一起的脚本。如果你不想要微软的东西，那么 python、perl 或 bash 脚本将是一个好主意——不仅要学习如何在新的代码中编写代码，还要学习如何以不同于通常的“编写应用程序”的方式做事。

* * *

## 回答 #13

> 赞同：0
> 
> 时间：2009-03-05T15:19:45.230

从实用程序的角度来看，学习一种更动态的语言，如 Python（或 Ruby 或 Perl）也很好。它们不仅可以扩展您的思维，而且在某些类型的任务中表现出色。例如，如果你想操作文本，C++ 比 Python 更难使用。它会在您的箭筒中为您提供另一个箭头，以便在适当的时候使用。

* * *

## 回答 #14

> 赞同：0
> 
> 时间：2009-03-05T15:25:30.410

我按顺序学习了：

*   基本的
*   帕斯卡
*   艾达
*   （一点点Haskell）
*   爪哇
*   Python
*   C++
*   C＃

我不觉得 Python 抑制了我学习或使用 C++ 的能力。我很高兴在遇到 Java、Python 和 C# 中的引用类型之前我在 Pascal 中学习了指针，因为我觉得它为我理解“值类型”和“引用类型”之间的差异提供了一个很好的基础。我认为**对我来说**最重要的语言是 Python、Haskell 和 C++。所有这些都相辅相成，虽然有时我在一个工作中并希望我有另一个功能，但总的来说，我认为我从对类型系统、面向对象和元编程等事物的更深入理解中受益匪浅看到这些语言处理这些事情的不同方式。

* * *

## 回答 #15

> 赞同：0
> 
> 时间：2009-03-05T15:27:00.690

请改用 LISP（或之后，由您决定）。不过，您至少部分正确。使用 Python 一段时间会让你不想回到静态类型和编译的语言。不必像所有时间一样取悦编译器，这真是太舒服了；）。还有一个方面是 python 代码的可读性，这太棒了。

* * *

## 回答 #16

> 赞同：0
> 
> 时间：2009-03-06T00:10:24.580

是真的。在学习了 python 之后，对于完成相同数量的实际工作，其他一切似乎都太费力了。你会习惯 GC 简洁、小巧的语法和自由。您将喜欢在列表组合、生成器等方面工作。您将开始使用 python 和 C++ 进行思考，而 Java 将就像在瓶子中建造一艘船，一次一根一根的小棍子。

但是，既然它*容易*得多，难道没有诱惑你更多地尝试它吗？

* * *

## 回答 #17

> 赞同：0
> 
> 时间：2009-06-04T10:44:49.203

我认为了解几种编程语言总是好的。我在学校学过 c++，在过去的几年里我经常使用它，因为它确实是业界的标准。我已经自学了 python，并且正在使用它来制作很多不错的工具，这些工具对于用 c++ 编写来说太长了。Python 对我的 c++ 技能产生了非常积极的影响。它提供了另一种思考方式。

# c# - IDisposable 有什么用途？

> ID：615105
> 
> 赞同：21
> 
> 时间：2009-03-05T14:53:21.830
> 
> 标签：c#, garbage-collection, dispose, idisposable

如果 .NET 有垃圾收集，那么为什么必须显式调用`IDisposable`？

* * *

## 回答 #1

> 赞同：49
> 
> 时间：2009-03-05T14:56:00.060

垃圾收集是为了内存。您需要处理非内存资源 - 文件句柄、套接字、GDI+ 句柄、数据库连接等。这通常是`IDisposable`类型的基础，尽管实际句柄在引用链中可能有很长的路要走。例如，您可能会处理一个`Dispose`它有一个引用的对象，它会处理*它*有一个引用的对象，这会释放文件句柄本身。`XmlWriter``StreamWriter``FileStream`

 ** * *

## 回答 #2

> 赞同：9
> 
> 时间：2009-03-05T15:36:25.033

扩展一下其他评论：

应该对所有引用非托管资源的对象调用 Dispose() 方法。此类示例包括文件流、数据库连接等。大多数情况下有效的基本规则是：“如果 .NET 对象实现了 IDisposable，那么当您完成该对象时，您应该调用 Dispose()。

但是，还有一些其他的事情要记住：

*   调用 dispose 并不能让您控制对象实际销毁和内存释放的时间。GC 为我们处理了这个问题，并且做得比我们做得更好。
*   正如 Jon 所指出的，Dispose 会清理所有本地资源，一直到基类堆栈的下方。然后它调用 SuppressFinalize() 来指示对象已准备好被回收并且不需要进一步的工作。GC 的下一次运行将清理它。
*   如果没有调用 Dispose，那么 GC 会找到需要清理的对象，但必须先调用 Finalize，以确保释放资源，对 Finalize 的请求排队等待 GC 继续，因此缺少调用 Dispose 会强制再运行一次 GC，然后才能清理对象。这会导致对象被提升到下一代“GC”。这可能看起来没什么大不了的，但在内存压力应用程序中，将对象提升到更高代的 GC 可以将高内存应用程序推向内存不足的应用程序。
*   除非绝对需要，否则不要在您自己的对象中实现 IDisposable。实施不当或不必要的实施实际上会使事情变得更糟而不是更好。可以在这里找到一些很好的指导：

    [实现 Dispose 方法](http://msdn.microsoft.com/en-us/library/fs2xkftw.aspx)

    [或者阅读 MSDN 关于垃圾收集的整个部分](http://msdn.microsoft.com/en-us/library/0xy59wtx.aspx)

* * *

## 回答 #3

> 赞同：5
> 
> 时间：2009-03-05T14:56:17.453

因为对象有时会在内存之外拥有资源。GC释放内存；IDisposable 是为了让你可以释放其他任何东西。

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2009-03-05T14:58:07.670

因为您想控制对象持有的资源何时被清理。

看，GC 是有效的，但它会在需要时这样做，即使这样，您添加到对象的终结器也只会在 2 次 GC 收集后被调用。有时，您想立即清理这些对象。

这是使用 IDisposable 的时候。通过显式调用 Dispose() （或使用 using 块的语法糖），您可以访问对象以标准方式清理自身（即您可以实现自己的 cleanup() 调用并显式调用它）

您希望立即清理的示例资源是：数据库句柄、文件句柄、网络句柄。

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2009-03-05T20:17:39.930

为了使用 using 关键字，对象必须实现 IDisposable。 [http://msdn.microsoft.com/en-us/library/yh598w02(VS.71).aspx](http://msdn.microsoft.com/en-us/library/yh598w02(VS.71).aspx)

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2017-06-26T15:09:38.443

`IDisposable`接口通常用资源来描述，但大多数这样的描述都没有真正考虑“资源”的真正含义。

一些对象需要要求外部实体代表他们做某事，以损害其他实体，直到另行通知。例如，包含文件流的对象可能需要请求文件系统（可能位于连接的 Universe 中的任何位置）授予对文件的独占访问权限。在许多情况下，对象对外部实体的需求将与外部代码对对象的需求相关联。例如，一旦客户端代码完成了与上述文件流对象相关的所有操作，该对象将不再需要对其关联文件具有独占访问权（或任何访问权）。

一般来说，要求实体做某事直到另行通知的对象 X 会产生交付此类通知的义务，但只要 X 的客户可能需要 X 的服务，就不能交付此类通知。的目的`IDisposable`是提供一种统一的方式让对象知道不再需要他们的服务，以便他们可以通知代表他们行事的实体（如果有的话）不再需要*他们的服务。*调用的代码`IDisposable`既不需要知道也不需要关心对象从外部实体请求了什么（如果有）服务，因为`IDisposable`只是邀请对象履行对外部实体的义务（如果有的话）。

用“资源”的术语来说，当一个对象要求外部实体代表它做某事（通常，但不一定，授予对某物的独占使用权）直到另行通知时，它会获取资源，并在它释放资源时释放资源告诉外部实体不再需要其服务。获取资源的代码不会获得“东西”，而是会产生义务；释放资源并没有放弃“事物”，而是履行了一项义务。

# c# - 在 CurrentItemChanged 上将文本框的内容设置为大写

> ID：615106
> 
> 赞同：1
> 
> 时间：2009-03-05T14:53:24.450
> 
> 标签：c#, .net, visual-studio, textbox

每当触发 currentItemChanged 时，我希望将 textBox 中的文本设置为大写。换句话说，每当框中的文本发生变化时，我都希望将内容设为大写。这是我的代码：

```
private void rootBindingSource_CurrentItemChanged(object sender, System.EventArgs e)
{
    toUserTextBox.Text.ToUpper();
    readWriteAuthorization1.ResetControlAuthorization();
} 
```

该事件肯定会触发，我已经使用 messageBox 进行了测试。所以我知道我在这里做错了什么......问题是什么。

* * *

## 回答 #1

> 赞同：24
> 
> 时间：2009-03-05T15:18:17.120

如果您需要做的只是强制输入为大写，请尝试文本框的[CharacterCasing](http://msdn.microsoft.com/en-us/library/system.windows.forms.textbox.charactercasing.aspx)属性。

```
toUserTextBox.CharacterCasing = CharacterCasing.Upper; 
```

* * *

## 回答 #2

> 赞同：5
> 
> 时间：2009-03-05T14:56:39.920

字符串是不可变的。ToUpper() 返回一个新字符串。试试这个：

```
private void rootBindingSource_CurrentItemChanged(object sender, System.EventArgs e)
{
    toUserTextBox.Text = toUserTextBox.Text.ToUpper();
    readWriteAuthorization1.ResetControlAuthorization();
} 
```

* * *

## 回答 #3

> 赞同：3
> 
> 时间：2009-03-05T14:58:29.960

我想你的问题是为什么你的代码不起作用。

您没有再次将“Uppered”文本分配给文本框。

应该：

```
private void rootBindingSource_CurrentItemChanged(object sender, System.EventArgs e)
{
    toUserTextBox.Text = toUserTextBox.Text.ToUpper();
    readWriteAuthorization1.ResetControlAuthorization();
} 
```

# visual-studio-2008 - Vista Home Premium 和 Ultimate 之间真正的日常运营差异是什么？

> ID：615110
> 
> 赞同：1
> 
> 时间：2009-03-05T14:54:21.890
> 
> 标签：visual-studio-2008, operating-system, vista64

我要跳到安装了 Vista Home Premium 64 的新机器上。我用VS2008做开发。我有一个 Ultimate 64 许可证和光盘，所以如果需要，我可以重新安装。

Home Premium 和 Ultimate 之间的日常运营差异是什么？我知道 IIS7 应该是“精简”的，但这到底是什么意思？

网络和授权呢？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-03-05T14:57:01.727

对我来说最重要的是 Ultimate 具有域加入功能以及远程桌面支持 - 这两个功能都未包含在 Home Premium 中。

除此之外 - 终极版几乎是商业版和家庭高级版功能的结合。

我将 Ultimate 版用于我的开发笔记本电脑，将 Business 版用于我的工作站——并且在这两个版本上都没有遇到 IIS 问题。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-03-05T15:07:56.333

当然，它是 Microsoft Tinker，一款去年附带 Ultimate 附加功能的游戏；）

除了 Dreamscene（你知道，动画桌面背景，对于 VS 开发人员来说绝对必不可少）之外，我没有错过 Home Premium 的任何功能。我不知道 Home Premium 没有 RDP 和 Domain Join 功能，但无论如何我的 Home Premium 机器上都不需要这两个功能。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-03-05T15:08:13.120

我遇到了 64 位的问题，我找不到某些硬件（智能卡、安全令牌等）的驱动程序，它仅适用于某些 OEM 的 32 位

# windows - 获取 .net 中所有区域设置格式的列表

> ID：615119
> 
> 赞同：1
> 
> 时间：2009-03-05T14:56:39.217
> 
> 标签：windows, vb.net, winapi

在控制面板 -> 区域和语言选项中，有一个格式选项卡，其中包含所有可能的语言格式的下拉列表。我希望使用 VB.NET 检索此列表。谁能指出使用哪个 Windows API 调用的方向？

谢谢

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-03-05T15:02:14.710

你试过了`System.Globalization.CultureInfo.GetCultures(CultureTypes.AllCultures)`吗？返回一个包含所有可用文化的数组。无需 Windows API。查看其他 CultureTypes 值以过滤文化列表。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-03-05T15:04:42.083

您应该看看 .net 框架中的 System.globalization.CultureInfo 类。 [http://msdn.microsoft.com/en-us/library/system.globalization.cultureinfo.aspx](http://msdn.microsoft.com/en-us/library/system.globalization.cultureinfo.aspx)

# apache-flex - Flex：在显示对象上设置注册点

> ID：615131
> 
> 赞同：6
> 
> 时间：2009-03-05T14:58:09.430
> 
> 标签：apache-flex, actionscript-3

在 Flex 3 显示对象上更改/设置注册点的最佳方法是什么？我知道这并不是为了轻松更改而真正内置的，但是有人对我如何扩展 UIComponent 来实现这一点有任何建议吗？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-04-10T16:17:49.203

出于某种原因，Flash Player API 没有公开 的注册点`DisplayObjects`（并且 Flash IDE 使它们在创建对象后很难修改）。正如大卫指出的那样，最好的解决方案是将您的组件添加为另一个组件的子组件（`UIComponent`没问题）。因此，例如，如果我有 a`Button`并且我希望它的注册点位于其中心，我会将其添加为 a `UIComponent`(not `Canvas`) 的子级，并通过将其位置设置为来偏移该子级`(-button.width/2, -button.height/2)`。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-08-23T03:09:57.110

将您的 DisplayObject 放入 sprite 并将 DisplayObject 的 x 和 y 位置设置为目标注册点的负值。将所有变换应用到 Sprite 容器。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-03-05T18:16:24.197

将其放入`Canvas`容器中，并将其`clipContent`属性设置为 false。在画布内，您可以将对象放在您喜欢的任何位置。

# .net - 如何在我的 .NET 应用程序中使用 W3C 标记验证器 API？

> ID：615132
> 
> 赞同：2
> 
> 时间：2009-03-05T14:58:11.257
> 
> 标签：.net, visual-studio, api, soap, w3c

我发现有一个[用于 W3C Markup Validator 的 API](http://validator.w3.org/docs/api.html)。

我之前问过： [W3C 标记验证器 API 是否有 .NET 库？](https://stackoverflow.com/questions/583409/is-there-a-net-library-for-the-w3c-markup-validator-api)

[阿萨夫](https://stackoverflow.com/users/11208/assaf)的[回答](https://stackoverflow.com/questions/583409/is-there-a-net-library-for-the-w3c-markup-validator-api/583433#583433)：

> 此 API 基于 SOAP。如果您想在 .net 应用程序中使用它，您只需添加 Web 引用和针对它的代码。看起来很简单，因为它基本上是一个单一方法的 API ......

所以，我尝试在地址“添加服务参考” `http://validator.w3.org/check`。

首先对话框显示：

> 请等待下载服务信息...

然后：

> [尝试在“ http://validator.w3.org/check](http://validator.w3.org/check) ”中查找服务时发生错误...

[Visual Studio 添加服务参考对话框 http://img17.imageshack.us/img17/719/addservicereference.gif](http://img17.imageshack.us/img17/719/addservicereference.gif)

错误详情：

> HTML 文档不包含 Web 服务发现信息。元数据包含无法解析的引用：“ [http://validator.w3.org/check](http://validator.w3.org/check) ”。内容类型 text/html；响应消息的 charset=utf-8 与绑定的内容类型不匹配 (application/soap+xml; charset=utf-8)。如果使用自定义编码器，请确保正确实现 IsContentTypeSupported 方法。响应的前 1024 个字节是：

```
<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Strict//EN"
"http://www.w3.org/TR/xhtml1/DTD/xhtml1-strict.dtd"> <html xmlns="http://www.w3.org/1999/xhtml" xml:lang="en" lang="en">   <head>
<meta http-equiv="Content-Type" content="text/html;charset=utf-8" />
<title>

        Validation Results - W3C Markup Validator</title>
    <link rel="icon" href="data:image/png,%89PNG%0D%0A%1A%0A%00%00%00%0DIHDR%00%00%00%10%00%00%00%10%08%02%00%00%00%90%91h6%00%00%00%19IDAT(%91c%BCd%AB%C2%40%0A%60%22I%F5%A8%86Q%0DCJ%03%00%DE%B5%01S%07%88%8FG%00%00%00%00IEND%AEB%60%82" type="image/png" />
<link rev="made" href="mailto:www-validator@w3.org" />
<link rev="start" href="./" title="Home Page" />
<style type="text/css" media="all">@import "./style/base.css";
        @import "./style/results.css";</style>
<meta name="keywords" content="HTML, HyperText Markup Language, Validation,
  W3C Markup Validation Service" />
<meta name="description" content="W3C's easy-to-use
  H 
```

> 如果在当前解决方案中定义了服务，请尝试构建解决方案并再次添加服务引用。

如何在我的 .NET 应用程序中使用 W3C 标记验证器 API？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2011-03-25T13:25:43.763

W3C 服务不是标准的 SOAP 服务！它可以提供 SOAP 格式的响应，但称其为基于单一 REST URL 的服务 [http://validator.w3.org/check?uri=YourURLToProof&charset=utf-8&output=soap12](http://validator.w3.org/check?uri=YourURLToProof&charset=utf-8&output=soap12)

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2009-08-02T09:02:33.260

为了使 Web 引用正常工作，我认为它需要服务的所有者发布一个 WSDL 文件供 .Net 读取和创建本地对象。然后，您在项目中调用这些本地对象，并使用 SOAP 使用来自服务另一端的数据填充它们。

我一直在寻找描述 W3C 验证 SOAP 在其网站上某处的 WSDL 文件，但到目前为止还没有运气。鉴于 W3C 管理 WSDL 协议，这很奇怪。你真的希望他们使用它！

如果有人知道：

1.  一种无需 WSDL 或...
2.  W3C Validator 的 WSDL 文件在哪里...

那么请告诉我...

[如果做不到这一点 - W3C 在他们的网站 ( http://validator.w3.org/docs/api.html#libs](http://validator.w3.org/docs/api.html#libs) )上放置了一个 C# 库的链接，该链接很容易下载和构建。但这使用 LINQ 来构建基于 W3C 返回的 SOAP 的对象——这对于我的目的来说似乎有点重……如果没有别的，这是一个有用的起点。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2009-08-03T01:43:14.437

SOAP Web 服务必须具有 WSDL。我在 W3C 站点上看到了一些关于 SOAP API 的提及，但是 API 或 WSDL 的位置并不明显。

用必应四处寻找和搜索，我发现了以下内容：[http ://www.w3.org/Search/Mail/Public/search?type-in​​dex=www-validator&index-type=t&keywords=wsdl&search=Search](http://www.w3.org/Search/Mail/Public/search?type-index=www-validator&index-type=t&keywords=wsdl&search=Search)

祝你好运。似乎他们在这方面做得有点倒退，因为 Web 服务是那些不太了解 WSDL 概念的人事后才想到的。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2017-08-02T08:49:44.447

您实际上可以从[https://github.com/validator/validator下载验证器并将其安装到您自己的站点上](https://github.com/validator/validator)

[关于页面](https://validator.w3.org/nu/about.html)的一些有用说明

我通过调用创建了一个快速的 c# 验证器方法：[https ://validator.w3.org/nu/?doc=http://www.example.com&out=json](https://validator.w3.org/nu/?doc=http://www.example.com&out=json)

像这样：

```
using Newtonsoft.Json;
using System.Net;
using System.Net.Http;

private void ValidateFromW3Org(string url)
{
    HttpClientHandler clientHandler = new HttpClientHandler();
    HttpClient client = new HttpClient(clientHandler);
    client.DefaultRequestHeaders.TryAddWithoutValidation("User-Agent",
            "Mozilla/5.0 (Windows NT 6.2; WOW64; rv:19.0) Gecko/20100101 Firefox/19.0");

    string validator = string.Format(
        "http://validator.w3.org/nu/?doc={0}&out=json", url);

    string response = client.GetStringAsync(url).Result;

    PageValidationResult pageResults = JsonConvert.DeserializeObject<
        PageValidationResult>(response);
    IList<ValidationResult> results = pageResults.Messages;

    foreach(ValidationResult result in results)
    {
        Console.WriteLine("{0}:{1} line: {2} - {3}", result.Type,
            result.SubType, result.LastLine, result.Message);
    }
}

public class ValidationResult
{
    public string Type { get; set; }
    public string SubType { get; set; }
    public int LastLine { get; set; }
    public int FirstColumn { get; set; }
    public int LastColumn { get; set; }
    public string Message { get; set; }
    public string Extract { get; set; }
    public int HiliteStart { get; set; }
    public int HiliteLength { get; set; }
}

public class PageValidationResult
{
    public string Url { get; set; }
    public IList<ValidationResult> Messages { get; set; }
} 
```

请注意，这只是一个示例。您不想以这种方式重用 HttpClient 。这也使用第三方 Newtonsoft.Json 来解析 json 结果。

# sql - 在 SQL 中重复一行？

> ID：615143
> 
> 赞同：43
> 
> 时间：2009-03-05T15:00:07.943
> 
> 标签：sql

好的，我有一个包含两列的表，用户 ID 和课程 ID。它用于将培训课程分配给用户。它看起来像这样：

```
userid   courseid
0          1
0          3
0          6
1          1
1          4
1          5 
```

所以用户 0 被分配到课程 1,3,6 并且用户 1 被分配到 1, 4 5

无论如何，我需要将每个分配给 6 的用户并创建一个具有该 userid 和 courseid 11 的新行，基本上将当前分配给 6 的每个用户也分配给 11

出于某种原因（我没有创建这个数据库），这两行都被标记为主键，并且我尝试过的一些语句因此引发了错误，这到底是怎么回事？

哦，也许是因为有一些用户已经分配到 11，所以可能会窒息这些用户？

请帮忙

* * *

## 回答 #1

> 赞同：66
> 
> 时间：2009-03-05T15:02:46.613

```
Insert Into TableName (userID, courseID)
  Select userID, 11 From TableName Where courseID=6; 
```

另外，我对您的评论感到有些困惑，即两者都是主键。这两行都可以是主键的*一部分*，或者都可以是唯一键，但它们不能都是主键。就错误而言，这可能是因为查询尝试插入与现有行重复的行。要消除这种可能性，您可以这样做：

```
Insert Into TableName (userID, courseID)
  Select userID, 11 From TableName Where courseID=6 
     AND (userID not in (Select userID From TableName Where courseID=11)) 
```

根据您的数据库，这也可以工作：

```
INSERT OR IGNORE INTO TableName (userID, courseID)
    SELECT userID, 11 FROM TableName WHERE courseID=6; 
```

无论如何，你去吧。

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2009-03-05T15:05:32.503

```
insert into TableName (userId, courseId)
    select userId, 11
    from   TableName
    where  courseId = 6
    and    not exists (
               select 1
               from   TableName nested
               where  nested.userId = TableName.UserId
               and    nested.courseId = 11
           ) 
```

选择分配给 courseId 6 但尚未分配给 courseId 11 的所有用户，并为他们在表中插入一条新记录，用于 courseId 11。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-03-05T15:04:33.207

这应该有助于：

```
INSERT
INTO   [table]
       (
              userid,
              courseid
       )
SELECT userid,
       11
FROM   [table]
WHERE  courseid    = 6
   AND userid NOT IN
                     (SELECT userid
                     FROM    [table]
                     WHERE   courseid = 11
                     ); 
```

这将选择课程 6 中而不是课程 11 中的所有用户，并将它们与课程 11 一起添加到表中。

# javascript - 在 asp.net mvc 中提交时未清除密码字段

> ID：615144
> 
> 赞同：0
> 
> 时间：2009-03-05T15:00:37.007
> 
> 标签：javascript, asp.net-mvc, forms, passwords, submit

我有一个用户偏好页面，用户可以在其中输入当前密码、新密码并确认新密码。当用户提交表单时，它会将它们发送到一个操作。问题是当表单提交时，密码字段保持填写状态。我要他们清除。我尝试了 javascript，但是当我使用 document.preferences.submit() 时，提交没有被触发，或者动作没有被触发，或者两者兼而有之。这是代码：

```
<script language="JavaScript" type="text/javascript">
    function clearpwd() {
        document.preferences.submit();
        document.preferences.currentPassword.value = '';
        document.preferences.newPassword.value = '';
        document.preferences.confirmPassword.value = '';
    }
</script>
 <% using (Html.BeginForm("ChangePreferences", "Home", FormMethod.Post, new { id="preferences", name="preferences" })) { %>
        <div>
            <div style="text-align:left; width:500px;">
            <div class="FormLabel">User Information:</div>
            <table border="0" cellpadding="4" cellspacing="0">
                <tr>
                    <td>First Name:</td>
                    <td>
                        <%= Html.TextBox("firstName")%>
                        <%= Html.ValidationMessage("FirstName") %>
                    </td>
                </tr>
                <tr>
                    <td>Last Name:</td>
                    <td>
                        <%= Html.TextBox("lastName") %>
                        <%= Html.ValidationMessage("LastName") %>
                    </td>
                </tr>
                <tr>
                    <td>New email:</td>
                    <td>
                        <%= Html.TextBox("email")%>
                        <%= Html.ValidationMessage("Email") %>
                    </td>
                </tr>
                <tr>
                    <td>Billing Method:</td>
                    <td>
                            <%=Html.RadioButton("billingMethod", 'E', new { id = "BillingMethod_E", value = 'E' })%><label for="BillingMethod_E">Electronic</label>

                            <%=Html.RadioButton("billingMethod", 'M', new { id = "BillingMethod_M", value = 'M' })%><label for="BillingMethod_M">Mailing</label>
                    </td>
                </tr>

            </table>
            </div>
            <br /><br />

            <div style="text-align:left; width:500px;">
            <div class="FormLabel">Login and Security Information:</div>
            <table border="0" cellpadding="4" cellspacing="0">
                <tr>
                    <td>Current Password</td>
                    <td>
                        <%= Html.Password("currentPassword") %>
                        <%= Html.ValidationMessage("currentPassword") %>
                    </td>
                </tr>
                <tr>
                    <td>New password:</td>
                    <td>
                        <%= Html.Password("newPassword") %>
                        <%= Html.ValidationMessage("newPassword") %>
                    </td>
                </tr>
                <tr>
                    <td>Confirm new password:</td>
                    <td>
                        <%= Html.Password("confirmPassword") %>
                        <%= Html.ValidationMessage("confirmPassword") %>
                    </td>
                </tr>
                <tr>
                    <td>Security Question:</td>
                    <td>
                        <%= Html.TextBox("securityQuestion") %>
                        <%= Html.ValidationMessage("SecurityQuestion") %>
                    </td>
                </tr>
                <tr>
                    <td>Security Answer:</td>
                    <td>
                        <%= Html.Password("securityAnswer") %>
                        <%= Html.ValidationMessage("SecurityAnswer") %>
                    </td>
                </tr>        
            </table>
            </div>
            <br /><br />
            <table>
                <tr>
                    <td></td>
                    <td><input type="submit" value="Change Preferences" onclick="clearpwd()" /></td>
                </tr>
            </table>
        </div>
    <% } %> 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-03-05T16:21:31.370

*   要调试 JavaScript 问题，最好发布生成的 HTML
*   要更轻松地调试 JavaScript 问题，请使用带有 Firebug 扩展的 Firefox 浏览器。

编辑：提交页面后，您正在尝试清除密码。提交页面导航到另一个页面后，所以我认为，此后 JavaScript 不会影响任何 DOM 元素。

您可以尝试以下顺序。

*   将用户名和密码存储在 JavaScript 变量上。
*   清除用户名和密码值。
*   使用存储的值发布到页面。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-03-05T16:36:35.123

如果您将其设置为记住密码，则可能是您的浏览器填写了密码字段。我曾经发生过这种情况。

# php - 如何在 PHP 中正确地对十六进制值进行 sha1 哈希处理？

> ID：615157
> 
> 赞同：1
> 
> 时间：2009-03-05T15:04:22.757
> 
> 标签：php, hash, hex

我有一系列十六进制字节。理论上，最后 20 个字节是第一部分的 sha1 哈希：

```
3F F4 E5 25 98 20 52 70 01 63 00 68 00 75 00 79 00 69 00 00 00 74 28 96 10 09 9D C9 01 00 74 A0 D7 DB 0B 9D C9 01 4D 00 79 00 47 00 72 00 6F 00 75 00 70 00 00 00 2F 00 00 00 BD 0D EA 71 BE 0B 25 75 E7 5C 58 20 31 57 F3 9A EF 69 1B FD 
```

如果我像这样在 PHP 中将 sha1 应用于它们：

```
echo sha1("3FF4E525982052700163006800750079006900000074289610099DC9010074A0D7DB0B9DC9014D007900470072006F007500700000002F000000"); 
```

我回来了：

```
d68ca0839df6e5ac7069cc548d82f249752f3acb 
```

但我正在寻找这个值：

```
bd0dea71be0b2575e75c58203157f39aef691bfd  

(BD 0D EA 71 BE 0B 25 75 E7 5C 58 20 31 57 F3 9A EF 69 1B FD) 
```

是因为我将十六进制值视为字符串吗？我需要做什么？

编辑：

这是我正在使用的原始信息：

```
ticketBytes
{byte[0x0000003a]}
    [0x00000000]: 0x3f
    [0x00000001]: 0xf4
    [0x00000002]: 0xe5
    [0x00000003]: 0x25
    [0x00000004]: 0x98
    [0x00000005]: 0x20
    [0x00000006]: 0x52
    [0x00000007]: 0x70
    [0x00000008]: 0x01
    [0x00000009]: 0x63
    [0x0000000a]: 0x00
    [0x0000000b]: 0x68
    [0x0000000c]: 0x00
    [0x0000000d]: 0x75
    [0x0000000e]: 0x00
    [0x0000000f]: 0x79
    [0x00000010]: 0x00
    [0x00000011]: 0x69
    [0x00000012]: 0x00
    [0x00000013]: 0x00
    [0x00000014]: 0x00
    [0x00000015]: 0x74
    [0x00000016]: 0x28
    [0x00000017]: 0x96
    [0x00000018]: 0x10
    [0x00000019]: 0x09
    [0x0000001a]: 0x9d
    [0x0000001b]: 0xc9
    [0x0000001c]: 0x01
    [0x0000001d]: 0x00
    [0x0000001e]: 0x74
    [0x0000001f]: 0xa0
    [0x00000020]: 0xd7
    [0x00000021]: 0xdb
    [0x00000022]: 0x0b
    [0x00000023]: 0x9d
    [0x00000024]: 0xc9
    [0x00000025]: 0x01
    [0x00000026]: 0x4d
    [0x00000027]: 0x00
    [0x00000028]: 0x79
    [0x00000029]: 0x00
    [0x0000002a]: 0x47
    [0x0000002b]: 0x00
    [0x0000002c]: 0x72
    [0x0000002d]: 0x00
    [0x0000002e]: 0x6f
    [0x0000002f]: 0x00
    [0x00000030]: 0x75
    [0x00000031]: 0x00
    [0x00000032]: 0x70
    [0x00000033]: 0x00
    [0x00000034]: 0x00
    [0x00000035]: 0x00
    [0x00000036]: 0x2f
    [0x00000037]: 0x00
    [0x00000038]: 0x00
    [0x00000039]: 0x00

hashed
{byte[0x00000014]}
    [0x00000000]: 0xbd
    [0x00000001]: 0x0d
    [0x00000002]: 0xea
    [0x00000003]: 0x71
    [0x00000004]: 0xbe
    [0x00000005]: 0x0b
    [0x00000006]: 0x25
    [0x00000007]: 0x75
    [0x00000008]: 0xe7
    [0x00000009]: 0x5c
    [0x0000000a]: 0x58
    [0x0000000b]: 0x20
    [0x0000000c]: 0x31
    [0x0000000d]: 0x57
    [0x0000000e]: 0xf3
    [0x0000000f]: 0x9a
    [0x00000010]: 0xef
    [0x00000011]: 0x69
    [0x00000012]: 0x1b
    [0x00000013]: 0xfd 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-03-05T15:14:48.767

不幸的是，这也不能为您提供正确的值，但它可能会为您指明正确的方向。无论哪种方式，在散列之前将十六进制代码实际转换为二进制字符串是一个更好的主意。像这样：

```
$str = "3F F4 E5 25 98 20 52 70 01 63 00 68 00 75 00 79 00 69 00 00 00 74 28 96 10 09 9D C9 01 00 74 A0 D7 DB 0B 9D C9 01 4D 00 79 00 47 00 72 00 6F 00 75 00 70 00 00 00 2F 00 00 00";

// Create an array where each entry represents a single byte in hex
$arr = explode(" ", $str);
// Convert the hex to decimal
$arr = array_map("hexdec", $arr);
// Convert the decimal number into the corresponding ASCII character
$arr = array_map("chr", $arr);

// Implode the array into a string, and hash the result
$result = sha1(implode($arr));

echo $result."\n"; 
```

结果是 fa3ebc158305d09443b4315d35c0eee5aa72daef，这也是 vartecs 代码产生的结果。我认为我们不知道如何计算正确参考的某些方面，因为根据我们所知道的事实，这里和 vartec 使用的方法绝对是最合乎逻辑的方法。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2009-03-05T15:21:04.493

```
$hexes = "3F F4 E5 25 98 20 52 70 01 63 00 68 00 75 00 79 00 69 00 00 00 74 28 96 10 09 9D C9 01 00 74 A0 D7 DB 0B 9D C9 01 4D 00 79 00 47 00 72 00 6F 00 75 00 70 00 00 00 2F 00 00 00";
$hexes = split(' ',$hexes);
$hexes = array_map('hexdec',$hexes);
$hexes = call_user_func_array('pack',array_merge(array('C*'),$hexes));
echo sha1($hexes); 
```

顺便提一句。您可以通过以另一种格式传递它来实现相同的目的：

```
$hexes = "\x3F\xF4\xE5\x25\x98\x20\x52\x70\x01\x63\x00\x68\x00\x75\x00\x79\x00\x69\x00\x00\x00\x74\x28\x96\x10\x09\x9D\xC9\x01\x00\x74\xA0\xD7\xDB\x0B\x9D\xC9\x01\x4D\x00\x79\x00\x47\x00\x72\x00\x6F\x00\x75\x00\x70\x00\x00\x00\x2F\x00\x00\x00";
echo sha1($hexes); 
```

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2009-03-05T15:25:11.113

这里有些不对劲。[SHA1 摘要是 160 位](http://www.w3.org/PICS/DSig/SHA1_1_0.html)，即 20 个十六进制数字，由 40 个字符表示。您期望的值是 32 个字符，这意味着它不是 SHA1 摘要 - 或者缺少我还不理解的其他内容。

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2009-03-05T15:13:44.183

`chr()`使用..将它们转换为字符串

```
$string = "3f ........"
$c = split(' ',$string);
$string2 = '';
foreach( $c as $char )
{
 $string2 .= chr(hexdec($c));
}

echo sha1($string2); 
```

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2009-03-05T16:56:16.480

您可以使用该[`pack`函数](http://docs.php.net/pack)将十六进制字符串转换为二进制：

```
$bin = pack('H*', preg_replace('/[^0-9a-fA-F]+/', '', $hex)); 
```

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2009-03-05T15:13:09.910

这有效：

```
function strToHex($string)
{
    $hex='';
    for ($i=0; $i < strlen($string); $i++)
    {
        $hex .= dechex(ord($string[$i]));
    }
    return $hex;
}
echo sha1(strToHex("3FF4E525982052700163006800750079006900000074289610099DC9010074A0D7DB0B9DC9014D007900470072006F007500700000002F000000"));

>> 5b102a482247fef726843f214f8a81b1627bb634 
```

* * *

## 回答 #7

> 赞同：0
> 
> 时间：2009-03-09T17:54:49.550

原来我需要使用带有验证密钥的 hash_hmac() 而不是 sha1()。

# .net - 在 .NET 中，当您将类实例/接口作为参数传递时，您是传递一个对象还是完整的 vtable

> ID：615168
> 
> 赞同：3
> 
> 时间：2009-03-05T15:06:15.277
> 
> 标签：.net, oop, clr, cil, virtual-functions

如果您将接口或类的实例作为参数传递，我们是在传递许多对象还是完整的 vtable，因为一旦您在实例上调用方法，它就需要递归 vtable 并调用适当的方法？
这是如何运作的？

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2009-03-05T15:19:44.420

您正在传递一个引用（按值）。引用的确切表示是特定于实现的，但在大多数情况下它将是一个指针:)

有关详细信息，请参阅[http://yoda.arachsys.com/csharp/parameters.html 。](http://yoda.arachsys.com/csharp/parameters.html)

（我现在正在打电话 - 如果有人可以重新格式化会有所帮助的链接:)

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-03-05T15:09:45.940

您最终将传递一个指向对象的指针，其中包含指向 vtable 的指针。嗯，基本上。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2011-02-21T23:14:15.620

关于在 IL 中调用方法时究竟会发生什么，我已经完成了一系列文章。该系列开始于[http://www.simple-talk.com/community/blogs/simonc/archive/2010/11/01/95464.aspx](http://www.simple-talk.com/community/blogs/simonc/archive/2010/11/01/95464.aspx)

简而言之，将原生大小的指针压入堆栈，该指针指向对象实例开始处的堆（同步块索引，然后是类型指针，然后是实例的字段值）。CLR 通过类型指针访问 vtable。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2009-03-05T15:10:09.730

这是一个实现细节，所以我认为你不应该依赖它！:)

顺便说一句，没有“在参数中传递接口”之类的东西。你总是传递一个对象引用，它可以实现一个、一个或多个接口。

# visual-studio - 具有 VS 2005 和 VS 2008 的开发人员在同一项目上工作

> ID：615173
> 
> 赞同：0
> 
> 时间：2009-03-05T15:07:54.930
> 
> 标签：visual-studio, build-process, compatibility

我们有一个包含网站和类库的解决方案。我们也有开发人员在 VS 2005 和 VS 2008 中工作。问题是当用户从类库中添加文件/删除文件时，它不会被添加到使用其他版本的用户的项目文件中VS。我还必须设置我们的自动构建以使用一个项目文件。有没有办法解决这个问题，或者我们是否需要将每个人都升级到 2008？

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2009-03-05T15:21:48.970

在一个由多个项目成员组成的团队中使用两个不同版本的 Visual Studio 绝对没有意义。我建议降级到 Visual Studio 2005 或升级到 Visual Studio 2008。您可以在同一台机器上安装多个版本的 Visual Studio，而不会产生副作用。

* * *

## 回答 #2

> 赞同：5
> 
> 时间：2009-03-05T15:16:24.020

您需要将每个解决方案文件保存在相同的 Visual Studio 版本中。不过，可以将您的产品拆分为多个解决方案。在这种情况下，您可能有 1 个保存 2005 年项目的 .sln 文件和 1 个保存 2008 年项目的 .sln 文件。

正如您所提到的，没有*自动*方法可以使 2005 和 2008 项目保持同步，因为当您将文件添加到其中一个项目时，另一个将没有该新文件。同样，当您删除文件时。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-03-05T15:12:37.243

也许您应该降级到 VS 2005 - 因为我现在正在使用 VS08 开发一个项目，并且引用的 dll 的路径时不时地混淆并且 dll 丢失了 - 或者我们遇到了与您刚刚描述的文件相同的问题从一个用户添加的内容在更新后不在下一个用户的项目文件中。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2009-03-05T17:04:36.350

我不确定“网站”（而不是“Web 应用程序”）项目，但通常您不需要 2005 年和 2008 年的不同项目文件。您只需要单独的解决方案文件。

只需在 2008 年打开您的 2005 年项目并允许它升级您的解决方案/项目。您可能会收到一个对话框，要求您更新 CLR 版本，只需说不。

一旦你有一个工作的 2008 解决方案，将 *.sln 文件复制到另一个名称（我将我的副本称为 *.2005.sln），在记事本或你喜欢的文本编辑器中打开复制的 *.sln 文件。在第 2 行找到“Format Version 10.0”，并更改为“Format Version 9.0”。保存文件。

就是这样，您升级的解决方案文件在 VS 2008 中运行，而您复制和更改的解决方案文件在 VS 2005 中运行。

如果您有 Web 应用程序项目，那么还有一个额外的步骤。在 Web 应用程序的 vbproj 或 csproj 文件中，找到以下行：

```
<Import Project="$(MSBuildExtensionsPath)\Microsoft\VisualStudio\v9.0\WebApplications\Microsoft.WebApplications.targets" Condition="" /> 
```

并用这两行替换这一行：

```
<Import Project="$(MSBuildExtensionsPath)\Microsoft\VisualStudio\v8.0\WebApplications\Microsoft.WebApplications.targets" Condition="'$(Solutions.VSVersion)' == '8.0'" />
<Import Project="$(MSBuildExtensionsPath)\Microsoft\VisualStudio\v9.0\WebApplications\Microsoft.WebApplications.targets" Condition="'$(Solutions.VSVersion)' == '9.0'" /> 
```

这两行将根据使用的 VS 版本有条件地选择正确的 MSBuild 路径。

# java - 什么是序列版本 ID？

> ID：615181
> 
> 赞同：15
> 
> 时间：2009-03-05T15:09:46.360
> 
> 标签：java, eclipse

重复[什么是serialVersionUID，我为什么要使用它？](https://stackoverflow.com/questions/285793/why-should-i-bother-about-serialversionuid)

现在使用 Eclipse 进行一些 java 工作。我的班级名称带有黄色下划线。我可以抑制警告或只添加 frickin 序列号。

我不关心任何一种方式（或者我应该？），但这个序列号到底是什么？

谢谢

* * *

## 回答 #1

> 赞同：17
> 
> 时间：2009-03-05T15:14:41.840

它与Java序列化有关。

当类的字段更改时，您不能再反序列化该类的其他版本。如果您尝试，Java 将抛出异常。

然而，有时字段的变化并不重要，你想说“无论如何都要反序列化”。为此，您需要定义此序列号。现在 Java 将使用该数字而不是反射来决定您的类定义是否“不同”。

最后，您可以通过定义自己的序列化函数来解决所有这些问题，而且确实许多拥护者坚持认为您应该这样做。

# wix - Windows 安装程序：签署转换

> ID：615185
> 
> 赞同：0
> 
> 时间：2009-03-05T15:10:25.300
> 
> 标签：wix, windows-installer, signing, wix3

我已经围绕这个主题进行了相当多的谷歌搜索，但我还没有找到明确的答案。希望你们中的一个人能够提供帮助:-)

我正在使用 WiX 制作多语言用户界面 (MUI) 安装程序；输出是针对每个目标区域性的本地化 MSI。在构建 MSI 之后，将在 en-US MSI（基础）和本地化 MSI 之间生成转换 (MST)。这样我们只打包了一个MSI，并且可以根据用户的语言选择在运行时应用MST。

我刚刚实施了一个新的构建步骤，它签署了我们的基础 MSI。似乎[对已签名的 MSI 应用转换不会破坏数字签名](http://www.eggheadcafe.com/conversation.aspx?messageid=32040885&threadid=32040884)，但我很好奇 MST 是否也需要签名。在生成转换之前，是否也应该对本地化的 MSI 进行签名？

提前致谢！

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-03-16T17:43:12.980

少量的接触测试意味着仅签署 MSI 就足够了，本地化的 MSI 和 MST 也不需要签署。

希望能帮助其他任何研究该领域的人。

# winapi - Are there special considerations for a windows service to send messages to user windows?

> ID：615195
> 
> 赞同：1
> 
> 时间：2009-03-05T15:13:19.207
> 
> 标签：winapi, windows-services, ipc, sendmessage

I have to write a Windows Service application (no GUI) that will monitor an event, and if it occurs will send a standard windows message to an application. The handle of the application will be given to the service by a DLL which is then unloaded, so a windows message is the way we wish to use.

The question though is whether the service needs to do anything special to use SendMessage to the window handle, given that it might be on a different screen or something in Vista. Is this possible, and if so, what do I have to do please?

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2009-03-05T15:20:42.793

**User Interface Privilege Isolation (UIPI):**

> Microsoft Windows Vista and later. Message sending is subject to User Interface Privilege Isolation (UIPI). The thread of a process can send messages only to message queues of threads in processes of lesser or equal integrity level.

[Source](http://msdn.microsoft.com/en-us/library/ms644950(VS.85).aspx)

You can read about [User Interface Privilege Isolation (UIPI) here](http://en.wikipedia.org/wiki/User_Interface_Privilege_Isolation).

To get around this you can set uiAccess to true in your manifest file. You also have to make sure your application is signed using authenticode with a certificate from a signing authority such as VeriSign. This can get pretty expensive.

* * *

**Session 0 isolation:**

It is also my belief that you can't call SendMessage across sessions. So if you have a service running in session 0 you need to find another means to communicate with your process that would be running in a session > 0\. Example: via pipe.

In Windows Vista, Windows 2008 Server and later all services run in session 0, and all applications that you start run in session > 0\. This is called session 0 isolation. Here is a good document that has [information all about session 0 isolation](http://www.microsoft.com/whdc/system/vista/services.mspx).

If you don't have access to the source of the program you want to send messages to, you could get around this by making an application that communicates with your service and acts as a proxy to relay the message to the application in its same session.

* * *

**Overall:**

If you develop your application on pre-Vista and it works fine. There is a **very high** chance it will be broken in Vista.

# workflow-foundation - Workflow Foundation：在没有 SharePoint 的情况下使用工作流任务？

> ID：615199
> 
> 赞同：0
> 
> 时间：2009-03-05T15:14:24.977
> 
> 标签：workflow-foundation

我以前做过由 SharePoint 网站托管的 WF 工作流。我们目前必须为一个普通的 ASP.NET 应用程序开发一个非常复杂的工作流，可惜它不能在 SharePoint 上下文中运行。

我注意到，当我在 VS2008 中创建“普通”WF 工作流时，我没有 CreateTask、onTaskChanged 等活动。我想这是因为所有的任务 API 都是由额外的 MOSS 层提供的。

我的问题是，是否有任何库可以为 WF 实现面向任务的东西，还是我们必须自己推出？

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2009-03-13T16:01:23.240

WF（没有 SharePoint）不提供开箱即用的此类功能。我不知道任何提供任务/收件箱功能的库，所以我们构建了自己的。

任务由自定义活动创建。工作流将使用普通的 WF 3.5 接收活动发出信号，这会导致工作流等待来自任何 WF 外部 GUI 的信号。

[Microsoft](http://www.microsoft.com/downloads/details.aspx?familyid=a438a9b9-9f15-42ec-866f-2ea58e10db36&displaylang=en)的一个示例显示了类似的内容，尽管它没有使用 WF 服务。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-01-05T13:48:48.097

我只在.Net 中创建了一个工作流，但是那个工作流使用了Web 服务入口点，例如MyService.xamlx 是在SOAP 请求中调用的URL，使用Receive 活动名称作为操作名称并传递在ReceiveParametersContent 元素中定义的参数。

（我确实注意到 VS 2010 服务调用程序感到困惑，不允许我指定参数，但 SoapUI 非常愿意使用从 MyService.xamlx?wsdl 返回的 WSDL。）

项目模板是“WCF 工作流服务应用程序”

# c# - C# 图遍历

> ID：615202
> 
> 赞同：12
> 
> 时间：2009-03-05T15:15:43.460
> 
> 标签：c#, graph, traversal

该算法在遍历图中的节点方面做得很好。

```
Dictionary<Node, bool> visited = new Dictionary<Node, bool>();

Queue<Node> worklist = new Queue<Node>();

visited.Add(this, false);

worklist.Enqueue(this);

while (worklist.Count != 0)
{
    Node node = worklist.Dequeue();

    foreach (Node neighbor in node.Neighbors)
    {
        if (!visited.ContainsKey(neighbor))
        {
            visited.Add(neighbor, false);
            worklist.Enqueue(neighbor);
        }
    }
} 
```

我可以使用它在图中找到目标节点。工作清单在处理工作清单时使项目出队（或弹出）。找到目标后，如何返回节点的完整路径？

**更新** 我试图弄清楚如何将路径反转到根目录。该方法在根节点上调用，之后子节点可能有两个父节点，所以并不像在每个节点上调用父属性并向上遍历那么简单。

该方法的目标是找到路径，而不是迭代所有节点，或者检查节点是否存在。

* * *

## 回答 #1

> 赞同：11
> 
> 时间：2009-03-05T15:31:59.723

跟踪前驱节点。在最简单的实现中，这是一个字典，通常在伪代码中表示为 π：

```
Dictionary<Node, bool> visited = new Dictionary<Node, bool>();
Dictionary<Node, Node> π = new Dictionary<Node, Node>();

Queue<Node> worklist = new Queue<Node>();

visited.Add(this, false);

worklist.Enqueue(this);

while (worklist.Count != 0)
{
    Node node = worklist.Dequeue();

    foreach (Node neighbor in node.Neighbors)
    {
        if (!visited.ContainsKey(neighbor))
        {
            visited.Add(neighbor, false);
            π.Add(neighbor, node);
            worklist.Enqueue(neighbor);
        }
    }
} 
```

然后您可以遍历这些前辈以从任何节点回溯路径，例如`e`：

```
while (π[e] != null) {
    Console.WriteLine(e);
    e = π[e];
} 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-03-05T15:20:03.483

是“this”，即当前实例，图的“根”，如果有这样的东西？

图是循环的还是非循环的？恐怕我不知道图论的所有术语。

这是我真正想知道的：

```
A -> B -> C ------> F
     B -> D -> E -> F 
```

以下是我的问题：

*   这会发生吗？
*   您的代码中的“this”可以从 B 开始吗？
*   F 的路径是什么？

如果图在分裂时从未重新连接在一起，不包含循环，并且“this”将始终是图的根/开始，一个简单的字典将处理路径。

```
Dictionary<Node, Node> PreNodes = new Dictionary<Node, Node>(); 
```

对于您访问的每个节点，将相邻节点添加为键，并将其相邻的节点添加为值。这将允许您在找到目标节点后回溯以获取反向路径。

换句话说，上图的字典在完全遍历之后将是：

```
B: A
C: B
D: B
E: D
F: C (or E, or both?) 
```

要找到 E 节点的路径，只需回溯：

```
E -> D -> B -> A 
```

这为您提供了路径：

```
A -> B -> D -> E 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-03-05T15:23:21.353

由于您没有始终跟踪到“当前”节点的路径，因此您必须在找到目标时构建该路径。如果您的 Node 类具有 Parent 属性，您可以轻松地回溯树以构造完整路径。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2009-03-05T15:36:36.280

Peter is almost correct. I don't think you can store a link to the parent vertex in the node class, because it changes depending on the vertex at which you start your breadth first search. You need to create a Parent Dictionary with the keys being nodes and the values being parent nodes. As you visit each vertex (but before processing) you add the parents to the dictionary. Then you can walk up the parent path back to the root vertex.

# javascript - WYMeditor 不会将内容反映到 textarea 值中

> ID：615203
> 
> 赞同：9
> 
> 时间：2009-03-05T15:15:57.487
> 
> 标签：javascript, jquery, wymeditor

我开始在网站上的所有内容类型中部署 WYMeditor，它看起来不错。现在我要看看它是如何保存和查看的，但它没有提交任何东西，我不知道为什么。

我从几个角度看待这个问题。我什至会在这一点上使用猴子补丁，如果我可以自己学习如何获取数据，我可以在提交时将其粘贴到字段中。那或者它不能自行工作的真正原因会很棒。有人有想法吗？

```
<li><label for="id_comment">comment on this article:</label> <textarea id="id_comment" rows="10" cols="40" name="comment"></textarea> 
<script type="text/javascript"> 
    $(document).ready(function(){

    jQuery("#id_comment").wymeditor({
      "toolsItems":[
         {
            "name":"Bold",
            "css":"wym_tools_strong",
            "title":"Strong"
         },
         {
            "name":"Italic",
            "css":"wym_tools_emphasis",
            "title":"Emphasis"
         },
         {
            "name":"InsertOrderedList",
            "css":"wym_tools_ordered_list",
            "title":"Ordered_List"
         },
         {
            "name":"InsertUnorderedList",
            "css":"wym_tools_unordered_list",
            "title":"Unordered_List"
         },
         {
            "name":"Indent",
            "css":"wym_tools_indent",
            "title":"Indent"
         },
         {
            "name":"Outdent",
            "css":"wym_tools_outdent",
            "title":"Outdent"
         },
         {
            "name":"Undo",
            "css":"wym_tools_undo",
            "title":"Undo"
         },
         {
            "name":"Redo",
            "css":"wym_tools_redo",
            "title":"Redo"
         },
         {
            "name":"CreateLink",
            "css":"wym_tools_link",
            "title":"Link"
         },
         {
            "name":"Unlink",
            "css":"wym_tools_unlink",
            "title":"Unlink"
         },
         {
            "name":"Paste",
            "css":"wym_tools_paste",
            "title":"Paste_From_Word"
         }
      ],
      "logoHtml":"",
      "updateEvent":"blur",
      "stylesheet":"/static/yui/tiny_mce.css",
      "skin":"twopanels",
      "classesHtml":"",
      "updateSelector":"textarea"
      });

    });
</script></li> 
```

* * *

## 回答 #1

> 赞同：12
> 
> 时间：2009-04-16T06:01:06.407

我遇到了同样的问题，并通过查看他们网站提供的 wymexamples 目录中的示例 1 注意到 Wymeditor 使用特殊元素类（CSS 类）来指示页面中需要添加额外行为的部分。

特别是，提交按钮有一个 wymupdate 类，我认为这会导致预提交处理程序与控件相关联。

一旦我将 wymupdate 类添加到源代码中的提交按钮，然后在提交之前用 HTML 填充 textarea 字段，它会在正确的 POST 变量中显示服务器端。

我在示例源的相关位下面包含了使其工作的...

```
<script type="text/javascript">
jQuery(function() {
    jQuery('.wymeditor').wymeditor();
});
</script> 
```

...

```
<form method="post" action="">
<textarea class="wymeditor">&lt;p&gt;Hello, World!&lt;/p&gt;</textarea>
<input type="submit" class="wymupdate" />
</form> 
```

...虽然 wymupdate 类关联似乎是自动的，但 wymeditor 类关联是显式触发的，如 中所示`<script>`，然后这必然导致它查找 wymupdate 类的东西。

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2011-04-16T23:16:37.790

而不是这个：

```
"updateEvent":"blur",
"updateSelector":"textarea" 
```

你需要：

```
"updateEvent":"click",    
"updateSelector":"[type=submit]" 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-06-02T13:39:48.170

您还可以强制更新所有 wymeditors，我需要在实际提交之前执行此操作，因为我有自定义功能来操纵 textarea 内容。

```
document.addEventListener('submit',function(e){
    e.preventDefault();
    //update all the wymeditors
    var i=0,wym = jQuery.wymeditors(i);
    while(wym){
        i++;
        wym._element.html(wym.xhtml());
        //wym.update();//would use this, but it is not reliable
        wym = jQuery.wymeditors(i);
    }
    e.target.submit();
}); 
```

# regex - 正则表达式设置锚标签的href参数

> ID：615204
> 
> 赞同：1
> 
> 时间：2009-03-05T15:16:07.360
> 
> 标签：regex

我正在寻找一种查找和替换大量文本文件的方法。例如;

我要选择；

```
<li><a href="">Istanbul, TR POS </a></li>
<li><a href="">Ankara, TR POS </a></li>
<li><a href="">Izmir, TR POS </a></li> 
```

和;

```
<li><a href="pos-istanbul-tr.php">Istanbul, TR POS </a></li>
<li><a href="pos-ankara-tr.php">Ankara, TR POS </a></li>
<li><a href="pos-izmir-tr.php">Izmir, TR POS </a></li> 
```

请注意，标签的首字母是小写的，并且也作为链接的一部分添加。这应该针对大量文本文件完成，因此我正在通过正则表达式或您认为可能有帮助的任何软件寻找最有效的方法。

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2009-03-05T15:29:03.960

```
$ perl -i.bak \
>  -pe's/href="">([^,]+)/\'href="pos-\'. (lc $1) . \'-tr.php">\'. $1/eg' \
>  *.html 
```

### 跨平台变体（+ 基于[@Jonathan Leffler 的回答](https://stackoverflow.com/questions/615204/replace-text-with-regular-expression/615286#615286)）

保存到`fill-href.pl`：

```
#!/usr/bin/perl -w -pi.bak
s/href="">([^,]+)/href="pos-\L$1\E-tr.php">$1/g 
```

跑：

```
perl fill-href.pl test1.html test2.html 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-03-05T15:33:05.120

```
perl -pi.bak -e 's%<li><a href="">(\W+), TR POS </a></li>%<li><a href="pos-\L$1\E-tr.php">$1, TR POS </a></li>%g;' file1 file2 ... 
```

未经测试 - 可能过于简化，但应该适用于样本数据。' `-p`' 使 Perl 打印每一行；' `-i.bak`' 创建带有 ' `.bak`' 扩展名的文件的备份并覆盖原始文件。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2009-03-05T15:35:34.613

如果您碰巧可以访问与 Perl 兼容的正则表达式 (PCRE) 引擎，例如 PHP [`preg_replace()`](http://www.php.net/preg_replace)，甚至是 Perl，如果您必须;-)，您可以替换这个正则表达式：

```
<a href="">([^,]+),\s+(\w+)\s+(\w+) 
```

有了这个：

```
<a href="\L$3-$1-$2\E.php">$1, $2 $3 
```

和修饰符`\L`为`\E`你做小写。

```
$i = '<li><a href="">Izmir, TR POS </a></li>';
$r = '/<a href="">([^,]+),\\s+(\\w+)\\s+(\\w+)/';
$s = '<a href="\\L$4-$2-$3\\E.php">$1, $2 $3';

$o = preg_replace($r, $s, $i);
echo $o; 
```

VI / VIM 在反向引用中具有类似的大小写处理机制。

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2009-03-05T16:07:20.403

使用 textmate 正则表达式引擎，您需要的是：

查找：<li><a href="">([A-Za-z]+)，TR POS </a></li>

替换：<li><a href="pos-\L$1-tr.php">$1, TR POS </a></li>

观察第一个替换有一个修饰符，它将第一个匹配项变为小写。第二个 $1 没有修饰符。我对其进行了测试，它完全符合您的需要。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2009-03-05T15:19:28.273

我认为您将需要编程来执行此操作，因为您想要操作匹配的文本。

[awk](http://www.gnu.org/software/gawk/)听起来很可行，如果你在一个拥有它的平台上。或者你可以用 Python、Perl 或任何你喜欢的东西来做一些事情。实际代码很可能会有其他答案。

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2009-03-05T15:23:53.737

如果您使用的是 Linux，您可能会发现此线程很有帮助：

*   [在多个文件中替换 - Linux 的图形工具](https://stackoverflow.com/questions/189190/replace-in-multiple-files-graphical-tool-for-linux/189265#189265)（Regexxer [http://regexxer.sourceforge.net/](http://regexxer.sourceforge.net/)是公认的答案）

您可以使用 sed 之类的命令行工具、Python/Perl 之类的脚本语言或任何数量的其他解决方案来执行此操作。如果您可以提供有关您正在寻找什么以及它需要在什么操作系统上运行的更多详细信息，这将有助于提供更具体的答案。

* * *

## 回答 #7

> 赞同：0
> 
> 时间：2009-03-05T15:23:58.480

使用一些能够正则表达式和“在文件中搜索”的文本编辑器。例如EditPlus

然后替换

> `<li><a href="">([A-Za-z]+), TR POS <\/a><\/li>`

和

> `<li><a href="pos-\1-tr.php">\1, TR POS </a></li>`

（可能需要更多转义，即反斜杠......）

# c# - 距离计算功能的优化

> ID：615206
> 
> 赞同：8
> 
> 时间：2009-03-05T15:17:07.343
> 
> 标签：c#, geolocation

在我的代码中，我必须在成对的纬度/经度值之间进行大量距离计算。

代码如下所示：

```
double result = Math.Acos(Math.Sin(lat2rad) * Math.Sin(lat1rad) 
+ Math.Cos(lat2rad) * Math.Cos(lat1rad) * Math.Cos(lon2rad - lon1rad)); 
```

（lat2rad 例如是将纬度转换为弧度）。

我已将此功能确定为我的应用程序的性能瓶颈。有什么办法可以改善这一点吗？

（我不能使用查找表，因为坐标是变化的）。我还查看了[这个问题](https://stackoverflow.com/questions/516574/how-can-i-do-efficient-range-searching-counting-with-latitude-longitude-data)，其中建议使用像网格这样的查找方案，这可能是一种可能性。

谢谢你的时间！;-)

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2009-03-05T15:48:44.410

**如果您的目标是对距离进行排名（比较）**，那么近似值（`sin`和`cos`表格查找）可以大大减少您所需的计算量（实现**快速拒绝**。）

您的目标是仅在近似距离（要排名或比较）之间的差异低于某个阈值时才继续进行实际的三角计算。

例如，使用具有 1000 个样本的查找表（即每 1`sin`次`cos`采样`2*pi/1000`），查找不确定性最多为 0.006284。使用参数 to的[不确定性计算](http://spiff.rit.edu/classes/phys273/uncert/uncert.html)`ACos`，累积不确定性，也就是阈值不确定性，最多为 0.018731。

因此，如果评估两个坐标集对（距离）的`Math.Sin(lat2rad) * Math.Sin(lat1rad) + Math.Cos(lat2rad) * Math.Cos(lat1rad) * Math.Cos(lon2rad - lon1rad)`使用表`sin`和`cos`查找表会产生一定的排名（根据近似值，一个距离看起来比另一个大），并且差的模量大于上述阈值，那么近似值是有效的。否则继续进行实际的三角计算。

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2009-03-05T15:31:31.630

CORDIC算法[是否](http://en.wikipedia.org/wiki/CORDIC)适合您（在速度/准确性方面）？

* * *

## 回答 #3

> 赞同：3
> 
> 时间：2009-03-05T15:54:30.497

使用来自@Brann 的灵感，我认为您可以稍微减少计算（警告它很长一段时间，因为我做了任何这些，需要验证）。某种预计算值的查找可能是最快的

你有 ：

1: ACOS( SIN A SIN B + COS A COS B COS(AB) )

但是 2： COS(AB) = SIN A SIN B + COS A COS B

改写为 3： SIN A SIN B = COS(AB) - COS A COS B

将 SIN A SIN B 替换为 1\. 你有：

4: ACOS( COS(AB) - COS A COS B + COS A COS B COS(AB) )

您预先计算 X = COS(AB) 和 Y = COS A COS B，然后将值放入 4

给：

ACOS( X - Y + XY )

4 次三角计算而不是 6 次！

* * *

## 回答 #4

> 赞同：2
> 
> 时间：2009-03-05T16:05:59.363

更改存储长/纬度的方式：

```
struct LongLat
{
  float
    long,
    lat,
    x,y,z;
} 
```

创建 long/lat 时，还要计算 (x,y,z) 3D 点，该点表示以原点为中心的单位球体上的等效位置。

现在，要确定点 B 是否比点 C 更接近点 A，请执行以下操作：

```
// is B nearer to A than C?
bool IsNearer (LongLat A, LongLat B, LongLat C)
{
  return (A.x * B.x + A.y * B.y + A.z * B.z) < (A.x * C.x + A.y * C.y + A.z * C.z);
} 
```

并获得两点之间的距离：

```
float Distance (LongLat A, LongLat B)
{
  // radius is the size of sphere your mapping long/lats onto
  return radius * acos (A.x * B.x + A.y * B.y + A.z * B.z);
} 
```

您可以删除“半径”项，有效地标准化距离。

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2009-03-05T15:30:25.190

切换到 sin/cos/acos 的查找表。会更快，有很多 c/c++ 定点库也包括这些。

这是其他人在[Memoization](http://www.itu.dk/~sestoft/gcsharp/Memoization.cs)上的代码。如果使用的实际值更聚集，这可能会起作用。

[这是关于Fixed Point](https://stackoverflow.com/questions/79677/whats-the-best-way-to-do-fixed-point-math)的 SO question 。

* * *

## 回答 #6

> 赞同：1
> 
> 时间：2009-03-05T15:57:55.543

什么是瓶颈？是正弦/余弦函数调用还是反正弦调用？

如果你的正弦/余弦调用很慢，你可以使用以下定理来防止这么多的调用：

```
1 = sin(x)^2 + cos(x)^2
cos(x) = sqrt(1 - sin(x)^2) 
```

但我喜欢映射的想法，这样你就不必重新计算你已经计算过的值。虽然要小心，因为地图可能会很快变得非常大。

* * *

## 回答 #7

> 赞同：0
> 
> 时间：2009-03-05T15:25:04.220

您需要这些值有多精确？

如果您将您的值四舍五入，那么您可以存储所有查找的结果并检查是否已在每次计算之前使用它们？

* * *

## 回答 #8

> 赞同：0
> 
> 时间：2009-03-05T15:34:18.923

好吧，由于 lat 和 lon 都在一定范围内，您可以尝试使用某种形式的查找表来调用 Math.* 方法。说，一个`Dictionary<double,double>`

* * *

## 回答 #9

> 赞同：0
> 
> 时间：2009-03-05T16:02:28.857

我认为您可能需要重新检查您是如何发现该功能成为瓶颈的。（IE 您是否对应用程序进行了概要分析？）

这个方程对我来说似乎很轻，*不应该*造成任何麻烦。 *诚然，我不知道你的申请，你说你做了很多这样的计算。*

尽管如此，这是值得考虑的事情。

* * *

## 回答 #10

> 赞同：0
> 
> 时间：2009-03-05T16:13:53.540

正如其他人指出的那样，您确定这是您的瓶颈吗？

我已经对正在构建的类似应用程序进行了一些性能测试，在该应用程序中我调用了一个简单的方法来使用标准三角函数返回两点之间的距离。对它的 20,000 次调用将它推到了分析输出的顶部，但我无法让它更快......这只是调用次数的剪切。

在这种情况下，我需要减少对它的 # 调用......并不是说这是瓶颈。

* * *

## 回答 #11

> 赞同：0
> 
> 时间：2009-03-05T16:28:25.457

我使用不同的算法来计算 2 个纬度/经度位置之间的距离，它可能比你的更轻，因为它只进行 1 个 Cos 调用和 1 个 Sqrt 调用。

```
public static double GetDistanceBetweenTwoPos(double lat1, double long1, double lat2, double long2)
{
  double distance = 0;
  double x = 0;
  double y = 0;

  x = 69.1 * (lat1 - lat2);
  y = 69.1 * (long1 - long2) * System.Math.Cos(lat2 / 57.3);

  //calculation base : Miles
  distance = System.Math.Sqrt(x * x + y * y);

  //Distance calculated in Kilometres
  return distance * 1.609;
} 
```

* * *

## 回答 #12

> 赞同：0
> 
> 时间：2009-03-05T17:09:08.617

有人已经提到过记忆，这有点相似。如果您将同一点与许多其他点进行比较，那么最好预先计算该等式的各个部分。

代替

 `````
double result = Math.Acos(Math.Sin(lat2rad) * Math.Sin(lat1rad) 
+ Math.Cos(lat2rad) * Math.Cos(lat1rad) * Math.Cos(lon2rad - lon1rad));

````  `有：

 `````
double result = Math.Acos(lat2rad.sin * lat1rad.sin 
+ lat2rad.cos * lat1rad.cos * (lon2rad.cos * lon1rad.cos + lon1rad.sin * lon2rad.sin));

````  `我认为这与其他人发布的公式相同，因为当您展开括号时，部分等式将消失:)

# java - 2009 年最好的新开发工具是什么？

> ID：615208
> 
> 赞同：0
> 
> 时间：2009-03-05T15:17:49.150
> 
> 标签：java, sql-server, vb.net, developer-tools

我希望在工作中向我们的开发团队做一个演示。我想知道他们是否有任何易于演示的新工具。谈论新技术只是下班后的事情。谢谢

* * *

## 回答 #1

> 赞同：14
> 
> 时间：2009-03-05T18:42:37.770

我想说，2009 年迄今为止，甚至可能是全年最大的事情是[Gilad Bracha](http://GBracha.BlogSpot.Com/)的[新语编程语言](http://NewspeakLanguage.Org/)[原型](http://NewspeakLanguage.Org/downloads/)的[发布](http://GBracha.BlogSpot.Com/2009/02/newspeak-prototype-escapes-into-wild.html)，以及它随附的[GUI 框架巴西](http://Blog.3plus4.Org/2008/05/08/which-is-which-in-newspeak-ui-brazil/)、[应用程序开发框架 Hopscotch](http://Blog.3plus4.Org/2008/06/20/which-is-which-in-newspeak-ui-hopscotch/)和[Hopscotch IDE 和调试器](http://GBracha.BlogSpot.Com/2008/11/dynamic-ides-for-dynamic-languages.html)。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-03-05T15:29:04.770

无法想象 2009 年发布的任何新的开发工具值得展示。

但也许你可以展望未来，告诉他们几个月后会发生什么。例如，对于所有 .NET 人员，您可以讲述一些新语言，如 Visual Studio 2010 中的 F# 和 IronPython。与 C# 或 VB.net 相比，它们之间有什么区别......像这样的东西

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2009-03-05T16:05:08.523

[历史调试](http://channel9.msdn.com/posts/VisualStudio/Historical-Debugger-and-Test-Impact-Analysis-in-Visual-Studio-Team-System-2010/)。在 VS.net 版本 10 中实现。不能等到它进入 java 平台。于 2008 年底推出，但我认为这是最近的事了。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2009-03-05T15:26:29.973

很难告诉你 2009 年最好的情况是什么，我们只是在 3 月份。如果您向我们提供有关您感兴趣的工具类型、您开发的系统等的更多信息，这也可能是最好的。也可能我们的一些建议最终将来自 2008 年，而您可能没有以前听说过或尝试过。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2009-03-05T15:48:57.173

去年发生的最大的事情（无论如何，就我而言）是几个高质量、开源、分布式版本控制系统的出现和崛起。即：

*   [混帐](http://git-scm.com/)
*   [水银](http://www.selenic.com/mercurial/wiki/)
*   [市场](http://bazaar-vcs.org/)

...但你可能已经知道了。

# sqlite - 在哪里可以找到旧 SQLite 版本的源档案？

> ID：615213
> 
> 赞同：23
> 
> 时间：2009-03-05T15:19:01.067
> 
> 标签：sqlite

[www.sqlite.org](http://www.sqlite.org)上的[下载](http://www.sqlite.org/download.html)页面似乎只有当前版本的链接，我想获得以前的版本。我在网站上看不到任何指向历史版本的明显链接，而且（除非我遗漏了一些明显的东西）似乎没有 sourceforge 项目。

如果存在这样的事情，有人可以指向我旧 SQLite 源版本的存档吗？

奈杰尔。

* * *

## 回答 #1

> 赞同：15
> 
> 时间：2009-03-05T15:27:48.877

我在他们的旧邮件列表档案中找到了这个。希望这会有所帮助：

> 旧版本的 SQLite 可从该网站获得，但网页上没有直接链接。您需要手动编辑链接以获取所需的文件。
> 
> 数据库文件的 2.1 版本意味着它是使用 2.XY 版本的 SQLite 创建的。您应该获得最新版本，即 2.8.17（我相信）。
> 
> 如果你去下载页面 [http://www.sqlite.org/download.html](http://www.sqlite.org/download.html) 并右键点击链接下载最新的 Windows 二进制文件，然后
> 
> 选择复制链接位置（至少使用 Firefox，在 IE 中命令是复制快捷方式）。现在打开一个新选项卡或窗口并将链接粘贴到
> 
> 地址栏。您可以编辑链接并将版本号替换为您要下载的版本。在您的情况下，您需要将 [http://www.sqlite.org/sqlitedll-3_5_6.zip](http://www.sqlite.org/sqlitedll-3_5_6.zip)更改 为 [http://www.sqlite.org/sqlitedll-2_8_17.zip](http://www.sqlite.org/sqlitedll-2_8_17.zip) 然后按 Enter 开始

* * *

## 回答 #2

> 赞同：9
> 
> 时间：2009-03-05T15:32:53.077

**直接访问源**

另外，如果你想自己编译。对所有 SQLite 源代码的访问都保存在 CVS 存储库中，任何人都可以只读访问。[您可以通过访问此链接](http://www.sqlite.org/cvstrac/dir?d=sqlite)以交互方式查看存储库内容并下载单个文件

还

[www.sqlite.org/src/timeline?t=release](http://www.sqlite.org/src/timeline?t=release)将显示每个 sqlite 版本的发布时间。

从您想要的日期开始从 cvs 签出并编译。如何从 cvs 结帐的说明在[这里](http://www.sqlite.org/download.html)
注意：使用 -D 选项按日期结帐

* * *

## 回答 #3

> 赞同：9
> 
> 时间：2016-06-08T20:17:16.077

我知道这个问题有点老了，但是有一种更简单的方法可以获取旧 zip 文件的 URL。

使用此处的答案组合，您可以计算所需特定版本的 zip 文件的下载 URL。

1.  确定要获取的版本号（我们以 3.8.7.4 为例）

2.  查看时间线 ( [http://www.sqlite.org/src/timeline?t=release](http://www.sqlite.org/src/timeline?t=release) ) 找出您想要的版本发布的年份（3.8.7.4 于 2014 年发布）

3.  将版本号规范化为 7 位数字。将每个部分扩展为 2 位数字，前导零除外，最初的 3 位应保留为 1 位数字。例如 3.8.7.4 变为 3080704。3.13.0 变为 3130000。（如果没有第 4 个句点分隔片，则使用 00）

4.  使用您的规范化版本号，将其插入其中一种格式，具体取决于您要查找的内容（将下面 url 中的文本“7DIGITS”替换为您的规范化版本号，将文本 YEAR 替换为版本所在的年份被释放

来源： [http ://www.sqlite.org/YEAR/sqlite-src-7DIGITS.zip](http://www.sqlite.org/YEAR/sqlite-src-7DIGITS.zip)

合并： [http ://www.sqlite.org/YEAR/sqlite-amalgamation-7DIGITS.zip](http://www.sqlite.org/YEAR/sqlite-amalgamation-7DIGITS.zip)

所以我们的示例版本变成了 [http://www.sqlite.org/2014/sqlite-src-3080704.zip](http://www.sqlite.org/2014/sqlite-src-3080704.zip)和[http://www.sqlite.org/2014/sqlite-amalgamation-3080704.zip](http://www.sqlite.org/2014/sqlite-amalgamation-3080704.zip)

我没有为每个版本都尝试过，但我的 3 个测试版本都有效。我想其他下载类型（如预编译的二进制文件、文档等）也可以。

* * *

## 回答 #4

> 赞同：2
> 
> 时间：2016-05-04T18:24:31.167

我在此页面和其他地方尝试了一些解决方案，我所看到的所有解决方案似乎都已过时且不再有效。截至 2016 年 5 月 4 日，我已成功完成以下步骤。

1.  访问[http://system.data.sqlite.org/index.html/finfo?name=www/downloads.wiki](http://system.data.sqlite.org/index.html/finfo?name=www/downloads.wiki)查看 SQLite 下载 wiki 的历史。
2.  搜索 (ctrl+f) 以找到您想要的版本（例如 1.0.91.0）
3.  选择提交 ID，它将打开旧版本的页面，其中包含指向源代码的下载链接以及预编译的二进制文件和设置。

您不会总是在搜索中找到版本（例如 1.0.98.0），但通过周围的版本/提交找到正确的页面应该相当容易。

您还可以查看 archive.org 的下载页面： http:
[//web.archive.org/web/20150101000000](http://web.archive.org/web/20150101000000) */ [http://system.data.sqlite.org/index.html/doc/trunk/www/downloads .wiki从](http://system.data.sqlite.org/index.html/doc/trunk/www/downloads.wiki)[SQLite 新闻页面](https://system.data.sqlite.org/index.html/doc/trunk/www/news.wiki)
中找到您想要的版本发布的日期（您可能需要在此之后选择下一个存档日期）。选择您想要的链接（有时下载页面已存档，更多情况下似乎没有）。如果下载页面未存档，请编辑地址栏以删除与 archive.org 相关的信息，您应该能够直接导航到该版本的 SQLite 下载页面。

* * *

## 回答 #5

> 赞同：2
> 
> 时间：2016-08-09T06:46:12.940

TomWitt2 的想法很棒（我花了几个小时寻找解决方案），但现在链接似乎已修改，因此请按照以下步骤获取您的存档版本：

1.  从此处的下载页面获取最新版本链接[http://www.sqlite.org/download.html](http://www.sqlite.org/download.html)

2.  获取 TomWitt2 回答中提到的标准化 7 位数字

3.  只需替换链接中的数字即可

* * *

## 回答 #6

> 赞同：1
> 
> 时间：2016-02-07T18:41:16.790

按照此[链接](http://www.sqlite.org/getthecode.html)访问官方网站，在“3.0 直接从版本控制系统获取代码”下，您可以阅读更多说明：

*   获取发布签到列表（此[链接](http://www.sqlite.org/cgi/src/timeline?t=release&n=0)）
*   选择所需的值机
*   下载源代码存档

现在可用的最旧版本是从 2007-08-13 开始的。

* * *

## 回答 #7

> 赞同：0
> 
> 时间：2019-05-23T08:01:08.383

您正确地指出[https://www.sqlite.org/download.html](https://www.sqlite.org/download.html)仅链接到最新版本，但始终链接当前版本的页面与[Wayback Machine](https://archive.org/web/)相结合，保留了所说的每个（嗯，希望如此）版本页面，您只需要下载您喜欢的版本：

[http://web.archive.org/web/*/https://www.sqlite.org/download.html](http://web.archive.org/web/*/https://www.sqlite.org/download.html)

当然，鉴于二进制文件本身并没有被删除，但幸运的是它们对我来说似乎完好无损。其实我只是通过这个页面下载了SQLite 3.9.2：http://web.archive.org/web/20151231190003/https: [//www.sqlite.org/download.html](http://web.archive.org/web/20151231190003/https://www.sqlite.org/download.html)

* * *

## 回答 #8

> 赞同：0
> 
> 时间：2021-09-09T09:13:38.403

您可以从[https://www.sqlite.org/chronology.html](https://www.sqlite.org/chronology.html)获取 SQLite 的所有版本，该页面包含 SQLite 版本的历史

# php - 在 PHP 或 JAVASCRIPT 中回发？

> ID：615214
> 
> 赞同：1
> 
> 时间：2009-03-05T15:19:12.907
> 
> 标签：php, javascript

如何回发已经在文本字段中的数据？

示例：如果我错过了其中一个必填字段，当我单击提交按钮时会提示错误。

如何使用 php 或 javascript 以该形式回发数据并将鼠标光标直接定位到导致错误的字段？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-03-05T15:28:23.993

PHP 中没有自动回写字段信息的方法，因此您只需将其回显即可。

假设您有一个“用户名”字段（ <input type="text" name="username" /> ），您只需要添加以下内容：

```
value="<?php echo isset($_POST['username']) ? $_POST['username'] : ''; ?>" 
```

或者如果你喜欢更多：

```
value="<?php if(isset($_POST['username'])) echo $_POST['username']; ?>" 
```

**变成 ''**

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-03-05T15:31:13.923

这听起来像是基本的表单验证。我建议阅读其中一些教程或寻找一些预先构建的 PHP 表单验证机制。

1.  [使用 PHP 进行表单验证](http://www.php-mysql-tutorial.com/wikis/php-tutorial/form-validation-using-php.aspx)
2.  [PHP/CSS 表单验证](http://www.oreillynet.com/pub/a/php/2004/04/22/php_css_forms.html)
3.  [PHP 表单验证](http://htmlcenter.com/blog/php-form-validation/)

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2009-03-05T15:34:17.957

如果您使用自己的库，一些框架（例如[CodeIgniter ）会为您执行此操作。](http://codeigniter.com/)值得检查这样一个框架，因为它们提供了许多其他好处。当然，转移现有应用程序并不总是可能的，但记住未来仍然很有用。

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2009-03-05T15:41:25.740

如果我理解正确，你想保留用户已经输入的任何数据，告诉他他做错了什么，最好关注坏的领域。如果是这样，那么这是一个非常基本的示例，它使用具有两个字段的表单，两个字段都需要填写才能继续。

```
<?php

$field1=$_POST['field1'];
$field2=$_POST['field2'];

$badField="";
if($_POST['form_action']=="submitted") {
    //Check incoming data
    if(empty($field1)) {
        $badField="field1";
        echo 'field1 is empty<br>';
    }
    elseif(empty($field2)) {
        $badField="field2";
        echo 'field2 is empty<br>';
    }
    else {  //Everything ok - move to next page
        header('Location: <next page>');
    }
}

echo '<form name="mybo" action="' . $_SERVER['PHP_SELF'] . '" method="POST">
        <input type="text" name="field1" value="' . $field1 . '"><br>
        <input type="text" name="field2" value="' . $field2 . '"><br>
        <input type="submit" name="Submit" value="    Enter    ">
        <input type="hidden" name="form_action" value="submitted">
    </form>';

//Focus on empty field
if(!empty($badField)) {
    echo '<SCRIPT language="JavaScript">
        document.mybo.' . $badField . '.focus(); </SCRIPT>';
}
?> 
```

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2009-03-05T15:44:48.603

我认为 Moav 的回答是“哲学上”正确的，但是如果你想这样做，你可以：

1) 通过 GET 或 POST 传递文本控件 id；2) 在服务器上检查错误情况；3) 用页面上返回的值填充隐藏的输入字段 4) 如果使用 JS 的错误可以执行：window.onload = init; // 这里初始化东西 function init() { checkForError(); }

函数 checkForError() { var h = document.getElementById("error_field"); var v = h.value; if(v) document.getElementById(v).focus(); }

但是，如果您对每个错误字段都这样做，就会有一个帖子，从用户的角度来看，这很无聊......所以最好采用其他方法......

* * *

## 回答 #6

> 赞同：-1
> 
> 时间：2009-03-05T15:22:57.797

我会采取不同的方法：

验证应该在 JS 中，因此您永远不会丢失数据，因为您不提交。提交并在服务器上捕获的任何错误数据都是由于有人试图通过您的 JS 验证，这意味着他通常有犯罪的想法。

# java - 奇怪的 Tomcat 和 Axis Web 服务行为

> ID：615222
> 
> 赞同：1
> 
> 时间：2009-03-05T15:20:10.830
> 
> 标签：java, web-services, tomcat, axis

我使用 Apache Axis 在 tomcat 上部署了一个简单的 Web 服务。

如果我以[http://localhost:8080/webservices/TransactionService](http://localhost:8080/webservices/TransactionService)访问网络服务，我会看到通常的消息

> **事务服务**
> 
> 您好，这是 AXIS 服务！
> 
> 也许这里会有一个调用服务的表格......

表明 Web 服务可用并且可以使用。

但是，如果我以[http://10.0.0.1:8080/webservices/TransactionService](http://10.0.0.1:8080/webservices/TransactionService)访问它（10.0.0.1 是机器的实际 IP。我在与上面相同的机器上访问它，机器托管 tomcat）我得到：

> **HTTP 状态 404 - /webservices/TransactionService**
> 
> **-------------------------------------------------- ------------------------------**
> 
> **类型：**状态报告
> 
> **消息：** /webservices/TransactionService
> 
> **描述：**请求的资源 (/webservices/TransactionService) 不可用。
> 
> **-------------------------------------------------- ------------------------------**
> 
> **Apache Tomcat/5.5**

tomcat 日志中没有任何内容

如果我尝试在 Jetty 上部署它一切正常。

对此有什么解释吗？任何指针最受欢迎。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2009-03-05T15:50:25.030

Tomcat 可以以不同的方式监听不同的主机名/IP。具体来说，每个主机/IP 都可以有自己的工作目录：

```
<Host name="localhost" workDir="/workdir">
  ...
</Host> 
```

部署到一个工作目录的应用程序将无法用于具有另一个工作目录的主机。

检查您的配置。

**更新**：如果名称被指定为名称，而不是 IP，请检查该名称是否也解析为 10.* 地址。

此外，其中一台主机是默认主机。如果没有特定的主机，它现在也会响应所有请求，无论它们的目标是什么主机。对于您的设置，您可能只想让那一个处于活动状态。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-03-05T15:58:04.687

我不认为改变 Tomcat 配置是答案。我不必做这样的事情来使用我的本地 IP 地址或 localhost。

它可以像添加到您的主机文件一样简单吗？我在 c:/windows/system32/drivers/etc/hosts 中有我的，其中有一个“127.0.0.1 localhost”条目。

# version - 版本号怎么做？

> ID：615227
> 
> 赞同：166
> 
> 时间：2009-03-05T15:21:46.067
> 
> 标签：version, product

我的公司正在开发一种产品。它将由 SVN 进行版本控制。这是一个网络应用程序，所以基本上永远不会有一个版本没有其中的某些功能，因此总是可以标记为测试版。但由于它将成为一种企业产品，我真的不希望出现“不稳定的警戒”。那么您将如何进行版本控制？1.0稳定吗？构建日期是否应该在版本号中？告诉我你们在想什么！

* * *

## 回答 #1

> 赞同：265
> 
> 时间：2009-03-05T15:31:26.280

[**主要**].[**次要**].[**发布**].[**构建**]

**Major** : 真正的营销决策。你准备好调用 1.0 版本了吗？公司是否认为这是客户可能需要支付更多费用的主要版本，还是当前主要版本的更新可能是免费的？与其说是研发决策，不如说是产品决策。

**次要：每当****主要**增加时从 0 开始。每个公开的版本 +1。

**release**：每次你达到一个开发里程碑并发布产品时，即使是在内部（例如给 QA），都会增加它。这对于组织中团队之间的沟通尤为重要。不用说，永远不要发布相同的“发布”两次（即使是在内部）。在次要++ 或主要++ 时重置为 0。

**build**：可以是 SVN 版本，我觉得效果最好。

**示例**
我当前的 chrome：83.0.4103.61

* * *

## 回答 #2

> 赞同：71
> 
> 时间：2009-03-05T15:24:53.517

xyzg

g 的增量是不稳定的。z 中的（或 RC）增量是稳定的并且意味着错误修复。
y 的增量是稳定的并且意味着新特征。
x 中的增量是稳定的主要版本，没有 100% 向后兼容性。

* * *

## 回答 #3

> 赞同：34
> 
> 时间：2009-03-05T15:26:26.120

我曾经为我的一个大型项目写了一份详尽的“版本控制风格指南”。该项目未能实现，但样式指南[仍可在线获取](http://rootdirectory.de/wiki/VersioningStyleGuide)。这是我个人的看法，也许对你有帮助（或鼓舞人心）。

请注意，这是一个很长的文本，涉及到组件版本控制与产品版本控制之类的东西。也对一些在OSS社区流行的版本方案表达了强烈的意见，但是我有，所以表达出来。;-)

例如，我不同意使用 Subversion 修订号。您可能希望在继续在 TRUNK 中开发的同时维护已发布的版本，因此您将设置一个维护分支 - 并且您的修订号版本控制会付诸东流。

**编辑：**作为总结，它区分版本控制源文件、组件和整个产品。它对组件和产品使用单独的 xy 版本控制系统，两者之间具有很好的相互依赖关系，这使得跟踪哪个组件版本属于哪个产品版本变得微不足道。它还讨论了如何在不破坏系统的情况下处理 alpha/beta/release/patch 周期。实际上，这是整个开发周期的作案手法，因此您可能需要挑选。;-)

**编辑 2：**由于有足够多的人发现我的文章对使它成为“好答案”有用，我再次开始撰写这篇文章。PDF 和 LaTeX 版本现已推出，一旦我有时间，我会尽快进行完整的重写，包括更好的语言和解释性图形。感谢您的投票！

* * *

## 回答 #4

> 赞同：31
> 
> 时间：2009-03-05T15:25:27.027

从 Wikipedia 中获得一些灵感：[“软件版本控制”](http://en.wikipedia.org/wiki/Versioning)

另一个“新”和“相对流行”的选项是[语义版本控制](http://semver.org/)

**概括：**

> 给定版本号 MAJOR.MINOR.PATCH，增加：
> 
> 1.  进行不兼容的 API 更改时的主要版本，
> 2.  以向后兼容的方式添加功能时的次要版本，以及
> 3.  进行向后兼容的错误修复时的补丁版本。
> 
> 预发布和构建元数据的附加标签可作为 MAJOR.MINOR.PATCH 格式的扩展。

* * *

## 回答 #5

> 赞同：11
> 
> 时间：2014-12-18T17:16:31.130

**A B C D**

增量：何时
-d **：**错误修复**-c**
：维护，例如性能改进 -b ：新功能**-a** **：** 架构更改

 ******强制项是最左边的一项，例如，如果有新功能和修复的错误，那么您只需要增加**b**。

* * *

## 回答 #6

> 赞同：9
> 
> 时间：2014-07-18T06:00:32.557

根据我在复杂的企业平台级依赖管理和发布版本控制方面的经验，我开始推荐一种我喜欢称之为**半语义版本控制**的方法。

基本上，它建立在[Semantic Versioning 2.0](http://semver.org)之上，但并不那么严格。

半语义版本段：

```
<primary.release.segment>[-<pre.release.segment>][+<post.release.segment>] 
```

主要发布段格式：

> MARKETTING.MAJOR.MINOR.PATCH

每个段都应允许使用字母数字，但建议使用纯数字进行逻辑增量更改。

与 SemVer 一样，我建议使用**Major、Minor 和 Patch 组件**来表示反向兼容层，但我也建议在前面添加**Marketing 组件**。这允许产品所有者、功能史诗/组和业务关注点独立于技术兼容性关注点来影响主要组件。

与其他答案不同，我不建议将内部版本号附加到主要部分。相反，在“+”之后添加一个**发布后段**（例如：1.1.0.0+build.42）。SemVer 称之为构建元数据，但我认为 Post-Release Segment 更清晰。该段非常适合将后缀数据声明为与主要**版本段中的兼容性信息无关**. 然后可以为您的持续集成构建提供先前的版本号，并在每个主要版本之后重置一个增量构建号（例如：1.1.0.0 -> 1.1.0.0+build.1 -> 1.1.0.0+build.2 -> 1.1.0.1）。有些人交替喜欢将 svn 修订号或 git commit sha 放在这里，以便于绑定到代码存储库。另一种选择是将发布后部分用于修补程序和补丁，但可能值得考虑为此添加新的主要发布组件。当补丁组件增加时，它总是会被丢弃，因为版本是有效的左对齐和排序的。

除了发布和发布后段，人们通常希望使用**预发布段**来指示几乎稳定的预发布，如 alpha、beta 和候选发布。SemVer 方法效果很好，但我建议将数字组件与字母数字分类器分开（例如：1.2.0.0+alpha.2 或 1.2.0.0+RC.2）。通常，您会在添加发布后段的同时添加发布段，然后在下次添加主发布段时删除预发布段（例如：1.0.1.2 -> 1.2.0.0-RC.1 - > 1.2.0.0)。添加预发布部分以表明发布版本即将发布，通常只是一组固定的功能，用于更深入的测试和共享，不会因更多的提交而每时每刻发生变化。

**以涵盖几乎所有用例的方式对所有这些进行语义定义的美妙之处在于，您可以以标准方式解析、排序、比较和递增它们。**当将 CI 系统用于具有大量独立版本化的小型组件（如微服务）的复杂应用程序时，这一点尤其重要，每个组件都有自己的托管依赖项。

如果你有兴趣，我[用 ruby​​ 写了一个半语义解析器](https://github.com/pivotal-cf-experimental/semi_semantic)。我不仅需要使用这种模式，还需要能够管理使用它的其他应用程序。

* * *

## 回答 #7

> 赞同：4
> 
> 时间：2009-03-05T15:44:04.780

“版本号”是您内部版本控制系统的问题。版本号是另一回事（应该保持不同）。

坚持一个简单的 MAJOR.MINOR 发布系统（如 v1.27），其中 MAJOR 是兼容性级别（2.x 版与 1.x 版不兼容或至少有很大不同），而 MINOR 是您的错误修复版本或次要增强. 只要遵循 XY 格式，还可以使用其他系统，如 YEAR.MONTH (2009.12) 或 YEAR.RELEASE (2009.3)。但实际上，除非您有充分的理由不这样做，否则您可能最好坚持使用 MAJOR.MINOR。

绝对不要使用任何不适合 XY 格式的东西，因为它会让发行版、公告网站等难以与您合作，仅此一项就会严重影响您项目的受欢迎程度。

在您的（最好是分布式的）版本控制系统中使用分支和标签将特定的内部版本号分别标记为与 MAJORS 和 MINORS 相关。

是的，1.0 应该是稳定的。所有版本都应该是稳定的，除非它们被标记为 alpha、beta 或 RC。将 Alphas 用于已知的损坏和不完整。已知损坏的 Betas。RC 表示“试试看；你可能会发现我们错过的东西”。任何没有其中之一的东西都应该（当然，理想情况下）经过测试，已知良好，拥有最新的手册等。

* * *

## 回答 #8

> 赞同：3
> 
> 时间：2013-07-04T21:55:00.290

版本方案：[major].[minor].[devrel][mark]
[major]：如果您在开发中有重大变化，则增加。
[minor]：如果您在开发中有微小的变化，则增加。
[devrel]：如果您有错误修复，则增加。如果major++ 或minor++ 则重置为零。
[标记]：a、b 或 rc：a 是 alpha 版本，b 是 beta 版本，rc 是候选版本。请注意，1.3.57a 或 1.3.57b 或 1.3.57rc 等版本在 1.3.57 之前。从 0.0.0 开始。

* * *

## 回答 #9

> 赞同：2
> 
> 时间：2009-03-05T15:23:11.557

如果它在 SVN 中，那么为什么不使用 SVN 修订号？

如果您查看此网页的右下角，您将看到 Stack Overflow 版本号，即 SVN 修订号。

* * *

## 回答 #10

> 赞同：2
> 
> 时间：2009-03-05T15:23:22.100

现在很流行只使用 Subversion 修订号。

* * *

## 回答 #11

> 赞同：2
> 
> 时间：2009-03-05T15:26:19.927

版本控制取决于您；我会将 1.0 放在我有信心的第一个版本上。您可能希望快速跟进其他版本，因为一些软件供应商给 1.0 带来了坏名声。

您确实希望通过某种方式将版本号与所使用的确切构建联系起来，但您可能希望它对您的最终用户来说既好又简单。考虑使用标准版本号，并使用包含的版本号标记 SVN 存储库。

* * *

## 回答 #12

> 赞同：2
> 
> 时间：2009-03-05T15:28:08.597

虽然只使用 Subversion 修订号既好又简单，但它确实从版本号中删除了信息。用户可能会认为这是一件坏事。

我假设您的 webapp 将有某种部署过程，因此并非 Subversion 中的每个修订版都实际发布。由于不可能从“外部”（从用户的角度）确定何时发布，以及代码将在它们之间进行多少次修订，这使得数字几乎是随机的。它们会增加，我想从比较两个修订版可以推测*出某种*距离，但不会太多。

经典版本号倾向于“戏剧化”发布，以便用户可以建立某种期望。认为“我有 1.0 版，现在 1.1 版添加了这个那个，这听起来很有趣”比认为“昨天我们运行 SO 修订版 2587，今天是 3233，它一定要好得多！”更容易。

当然，这种戏剧化也可能被夸大，公司选择的版本号听起来比产品的实际差异更有趣，我想用修订号来反驳这一点。

* * *

## 回答 #13

> 赞同：1
> 
> 时间：2009-03-05T16:48:07.343

我们花了太多时间来决定何时增加主要版本。有些商店很少这样做，因此您会发布 1.25.3 之类的版本，而其他商店会一直这样做，为您提供 15.0

我受够了这一点，并说服大家主要版本号只是一年，而次要版本只是一年内的连续版本。用户似乎很喜欢它，并且想出下一个版本号是不费吹灰之力的。

Year.Release.build

*   年份 = 当前年份
*   发布 = 具有新功能的公开发布的序列号 - 每年重置为 1
*   build = 针对错误修复和内部发布而增加

编辑

** 现在这是针对不断增强的内部应用程序 **

这可能不适用于商业应用程序，因为在一年中的不同时间发布主要版本以用于营销和财务目的很重要。

* * *

## 回答 #14

> 赞同：1
> 
> 时间：2009-03-06T17:44:58.477

存在这个问题的原因是因为我们没有一个统一的方式来进行配置管理。

我喜欢做版本号的方式只是从 1 递增整数。我不想要一个我必须解释或记录的多部分版本号。而且我不想使用 SVN rev number，因为这也需要一些解释。

您需要在 SVN 之上的一些发布脚本来实现这一点

* * *

## 回答 #15

> 赞同：0
> 
> 时间：2009-03-05T15:30:29.493

我在该地区的经验很少。但是，这就是我要做的：

1.  选择一个编号修订方案并坚持下去。始终如一。
2.  每个版本的变化都应该代表*一个重大的变化*。更改的重要性以及版本号中反映的更改级别取决于您。

当然，您可以只使用 svn 修订号 --- 就像许多其他人建议的那样！！！

我希望这有帮助。

* * *

## 回答 #16

> 赞同：0
> 
> 时间：2009-03-10T03:28:18.067

我们使用简单的major.minor.julian_date 语法。

在哪里;

*   主要 - 第一个版本是 1，然后当我们引入主要的新功能或更改非常重要时，它们不向后兼容会增加这个数字。
*   次要 - 主要里程碑版本。对于生产推动的每个构建，这个数字都会增加。
*   julian_date -构建被推送到 QA的[Julian Day 。](http://en.wikipedia.org/wiki/Julian_day)

1/15 推送到 QA 的第
一个版本的示例是 -> 1.0.015 3/4 推送到生产的第一个版本的示例是 -> 1.1.063

它并不完美，但很方便，因为我们几乎每天都会将构建推送到 QA。

* * *

## 回答 #17

> 赞同：0
> 
> 时间：2009-04-13T20:52:18.897

这里有一些很好的信息：

[何时更改文件/程序集版本](http://blogs.msdn.com/suzcook/archive/2003/05/29/57148.aspx)

首先，文件版本和程序集版本不必相互一致。我建议文件版本随着每次构建而改变。但是，不要在每次构建时更改程序集版本，以便您可以分辨同一文件的两个版本之间的区别；为此使用文件版本。决定何时更改程序集版本需要对要考虑的构建类型进行一些讨论：运输和非运输。

非发货版本 一般来说，我建议在发货版本之间保持非发货组件版本相同。这避免了由于版本不匹配而导致的强命名程序集加载问题。有些人更喜欢使用发布者策略为每个构建重定向新的程序集版本。但是，我建议不要将其用于非运输版本：它并不能避免所有加载问题。例如，如果合作伙伴 x 复制您的应用，他们可能不知道安装发布者政策。然后，您的应用程序将被他们破坏，即使它在您的机器上运行良好。

但是，如果同一台机器上的不同应用程序需要绑定到程序集的不同版本，我建议为这些构建提供不同的程序集版本，以便可以为每个应用程序使用正确的程序集版本，而无需使用 LoadFrom/etc。

发布版本 至于为发布版本更改该版本是否是一个好主意，这取决于您希望绑定如何为最终用户工作。您希望这些构建是并排的还是就地的？两个版本之间有很多变化吗？他们会破坏一些客户吗？您是否关心它会破坏它们（或者您是否想强制用户使用您的重要更新）？如果是，您应该考虑增加程序集版本。但是，再一次，请考虑这样做太多次可能会在用户的磁盘上乱扔过时的程序集。

当您更改您的程序集版本时要将硬编码版本更改为新版本，我建议在头文件中为版本设置一个变量，并将源代码中的硬编码替换为该变量。然后，在构建期间运行预处理器以放入正确的版本。我建议在发货后立即更改版本，而不是之前，以便有更多时间来发现由于更改而导致的错误。

* * *

## 回答 #18

> 赞同：-3
> 
> 时间：2009-03-05T15:24:49.070

或使用您的“想法”版本号逗号颠覆号.. zB：

1.0.101 // 修订版 101，发布

或 1.0.101-090303 // 有发布日期，我用这个

# html - IE和FF之间表格行中填充底部的不同行为

> ID：615255
> 
> 赞同：0
> 
> 时间：2009-03-05T15:27:12.047
> 
> 标签：html, css

请阅读以下代码作为示例（注意第二个表格行的“padding-bottom”）：

```
<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">

<html>
<head><title>test</title></head>
<body>
<table style="height:300px;width:200px;background:#660000; float:left">
<tr><td style="height:20px">first row</td></tr>
<tr><td style="height:180px;padding-bottom:20px;">second row</td></tr>
<tr><td style="height:180px;">third row</td></tr>
</table>

<table style="height:300px;width:200px;background:#006600; float:left">
<tr><td style="height:20px">first row</td></tr>
<tr><td style="height:180px;">second row</td></tr>
<tr><td style="height:180px;">third row</td></tr>
</table>
</body>
</html> 
```

我希望两个表的高度在 IE 和 FF 中应该相同。

但是，FF按预期渲染它，但是在IE中，第一个表比第二个表高20px。我应该怎么做才能使它像FF一样渲染？

我也很好奇有什么不同。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2009-03-05T16:43:32.220

IE 和 Firefox 对盒子模型的工作方式有不同的规则。

考虑这一点的最佳方法是 IE 采用该单元格的设置高度，然后向其添加填充。这导致单元格高度为 200 像素。

而 Firefox 正在获取单元格内容的高度，然后对其应用填充。因为内容高度+内边距没有超过单元格的设置高度，所以单元格没有展开。

您可以尝试使用几个 doctype 来查看是否可以让它们匹配，但我认为 IE 7 和 FF3 不适合这种情况，无论 DOCTYPE 是什么。此外，考虑可能使用重置样式表来获取默认边距、字体大小等以匹配。

我接受了您的测试并执行了以下操作以使其在两种浏览器中看起来相同：

```
<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01//EN"
"http://www.w3.org/TR/html4/strict.dtd">
<html>
<head>
<title>test</title>
<style>
    * {margin:0px; padding:0px;font-family: arial;font-size:14px;}
    span { border: solid 1px black; margin-top:4px;display:block;}
    .first { border:solid 1px blue; }
    .second {border:solid 1px orange; }
    .third {border:solid 1px yellow;}
    .paddit {padding-bottom:10px;height:180px;}

</style>
</head>
<body>
<table style="width:200px;background:#660000; float:left">
    <tr valign="top">
        <td class="first" style="height:20px;"><span>first row</span></td>
    </tr>
    <tr valign="top">
        <td class="second paddit"><span>second row. This is a long test to see what happens when a lot of content is placed in here; and I need more content.This is a long test to see what happens when a lot of content is placed in here; and I need more content.This is a long test to see what happens when a lot of content is placed in here; and I need more content.</span></td>
    </tr>
    <tr valign="top">
        <td class="third" style="height:180px;"><span>third row</span></td>
    </tr>
</table>
<table style="width:200px;background:#006600; float:left">
    <tr valign="top">
        <td class="first" style="height:20px;"><span>first row</span></td>
    </tr>
    <tr valign="top">
        <td class="second" style="height:180px;"><span>second row</span></td>
    </tr>
    <tr valign="top">
        <td class="third" style="height:180px;"><span>third row</span></td>
    </tr>
</table>
</body>
</html> 
```

# java - 匹配Java中的日历对象？

> ID：615257
> 
> 赞同：2
> 
> 时间：2009-03-05T15:27:36.147
> 
> 标签：java, calendar

我想要定义部分日期/时间的对象，类似于 Unix crontabs 中的条目，即“任何一个月的第一天”等。

这些对象将与 Calendar 对象进行比较以查看它们是否匹配。

我正要编写自己的“TimePattern”类，但它必须包含很多逻辑，比如检查字段值是否在合法范围内（小时在 0 到 23 之间等），我觉得无论如何都会在类中，比如 Calendar。

所以，现在我只是使用一个（不宽松的）日历对象，其中一些字段未设置，我想将它们与代表固定时间点的完全设置的日历对象进行比较。我是不是该

*   编写我自己的方法，通过相关字段并检查“相等或未设置”
*   扩展（公历）日历类以包含“matchWith”方法
*   使用一些已经存在的比较机制（在 Calendar 类中），但到目前为止我已经忽略了

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-03-05T15:39:54.167

使用[Quartz Cron Expression](http://www.opensymphony.com/quartz/api/org/quartz/CronExpression.html)怎么样？

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-03-05T15:50:03.630

我过去使用的一种解决方案是编写一个 DateFormat，它将仅使用您想要的字段格式化日期，然后比较生成的字符串。例如，不关心时间组件，只关心日期是很常见的，所以你可以这样做：

```
public boolean sameDate(Calendar c1, Calendar c2)
{
    DateFormat datesOnly = new SimpleDateFormat("yyyy-MM-dd");
    return datesOnly.format(c1.getTime()).equals(datesOnly.format(c2.getTime()));
} 
```

如果您要创建一个新库，这可能不是最好的实现，但它在其他情况下效果很好。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-03-05T15:37:30.227

您可以创建一组比较器 - MinuteMatch、HourMatch 等，并使用它们来比较两个日期？

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2009-03-05T16:24:23.593

[Google 的 RFC-2445](http://code.google.com/p/google-rfc-2445/)会有用吗？这是一个日期重复计算器，可让您轻松执行“每三个月的第一个星期一”语义。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2009-03-05T16:48:41.320

这就是我最终所做的：

```
public class CalendarMatch<T extends Calendar> {
    private T _dt;

    public CalendarMatch(T dt) {
        this._dt = dt;
    }

    public boolean fMatches(T dtCmp)
    {
        int[] rgChecks = {
                           Calendar.HOUR_OF_DAY,
                           Calendar.MINUTE,
                           Calendar.SECOND,
                           Calendar.DAY_OF_MONTH,
                           Calendar.MONTH,
                           Calendar.YEAR,
                           Calendar.DAY_OF_WEEK
                         };
        for (int ixField : rgChecks) {
            // if any field in our partial date is set
            // but does not equal its counterpart, it's not a match
            if (this._dt.isSet(ixField) && dtCmp.get(ixField) != this._dt.get(ixField)) {
                return false;
            }
        }
        // otherwise, it is
        return true;
    }
} 
```

# erlang - 使用 Erlang 可以发现哪些弱点？

> ID：615260
> 
> 赞同：16
> 
> 时间：2009-03-05T15:27:54.557
> 
> 标签：erlang

我正在考虑将 Erlang 作为我即将进行的项目的潜力。我需要一个“高度可扩展、高度可靠”（呃，什么项目没有？）网络服务器来接受 HTTP 请求，但不能真正提供 HTML。我们有数以千计的分布式客户端（其他系统，而不是用户）将二进制数据提交到中央服务器集群以进行离线处理。响应将非常短，成功、失败、错误代码、最少数据。我们想使用 HTTP，因为它是我们穿越防火墙的最佳机会。

鉴于项目信息有限，您能否提供使用 Erlang 之类的技术可能出现的任何弱点？例如，我了解 Erlang 的文本处理能力可能会有所不足。

您的意见表示赞赏。谢谢。

* * *

## 回答 #1

> 赞同：10
> 
> 时间：2009-03-05T15:31:15.983

这听起来像是 Erlang 这样的语言的完美候选者。该语言的缩放属性非常好，但如果您担心数据处理能力，您不应该担心。它是一种非常强大的语言，有许多可供开发人员使用的库。这是一门古老的语言，过去曾被大量使用/测试过，所以你想做的一切可能已经在某种程度上完成了。

* * *

## 回答 #2

> 赞同：5
> 
> 时间：2009-03-05T17:41:06.747

确保您使用 erlang 版本 R11B5 或更高版本！早期版本的 erlang 不提供超时 tcp 发送的能力。这导致停滞或恶意客户端能够通过拒绝接收您发送的数据来对您的应用程序执行 DoS 攻击，从而锁定发送过程。

[请参阅R11B5 发行说明](http://www.erlang.org/download/otp_src_R11B-5.readme)中的​​问题 OTP-6684 。

* * *

## 回答 #3

> 赞同：5
> 
> 时间：2009-03-08T13:12:47.473

使用 Erlang，可扩展性和可靠性是存在的，但是从您的项目定义中，您不会概述您将需要哪种类型的文本处理。

我认为 Erlang 的主要限制可能是在您所在地区寻找有经验的开发人员。对 Erlang 架构师和编码员的可用性进行一些研究。

If you are going to teach yourself or have your developers learn it on the job keep in mind that it is a very different way of coding and that while the core documentation is good a lot of people do wish there were more examples. Of course the very active community easily makes up for that.

* * *

## 回答 #4

> 赞同：3
> 
> 时间：2009-03-06T12:19:09.213

> 我了解 Erlang 的文本处理能力可能会有所不足。

[Starling](http://github.com/hypernumbers/starling)项目已经提供了基本的unicode 支持，目前有一个 EEP（Erlang Enhancement Proposal）正在草案中，但正在将其纳入 Erlang/OTP 支持的主流。

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2014-03-22T13:29:40.447

I encountered some problems with Redis read performance from Erlang. Here is [my question](https://stackoverflow.com/questions/22577849/erlang-and-redis-read-performance). I tend to think the reason is Erlang-written module, which has troubles while processing tons of strings during communication with Redis.

# c++ - C++ 并行化库：OpenMP 与线程构建块

> ID：615264
> 
> 赞同：46
> 
> 时间：2009-03-05T15:28:55.380
> 
> 标签：c++, multithreading, multicore, openmp, tbb

我将改造我的自定义图形引擎，以便它能够利用多核 CPU。更确切地说，我正在寻找一个库来并行化循环。

在我看来，OpenMP 和英特尔的线程构建块都非常适合这项工作。此外，Visual Studio 的 C++ 编译器和大多数其他流行的编译器都支持两者。这两个库似乎都非常易于使用。

那么，我应该选择哪一个呢？有没有人尝试过这两个库，并且可以给我一些使用这两个库的利弊？另外，你最终选择了与什么合作？

谢谢，

阿德里安

* * *

## 回答 #1

> 赞同：56
> 
> 时间：2009-03-05T20:46:52.870

我没有广泛使用 TBB，但我的印象是它们相互补充而不是竞争。TBB 提供线程安全容器和一些并行算法，而 OpenMP 更多的是一种并行化现有代码的方法。

就我个人而言，我发现 OpenMP 很容易放入现有代码中，您可以在其中有一个可并行化的循环或一堆可以并行运行的部分。但是，对于需要修改一些共享数据的情况，它对您没有帮助——TBB 的并发容器可能正是您想要的。

如果您想要的只是并行化迭代独立的循环（或者可以很容易地做到这一点），我会选择 OpenMP。如果您需要线程之间的更多交互，我认为 TBB 在这方面可能会提供更多。

* * *

## 回答 #2

> 赞同：26
> 
> 时间：2009-03-05T15:41:12.340

来自英特尔的软件博客：[比较 Windows* 线程、OpenMP*、英特尔® 线程构建块以进行并行编程](http://software.intel.com/en-us/blogs/2008/12/16/compare-windows-threads-openmp-intel-threading-building-blocks-for-parallel-programming/)

这也是风格的问题——对我来说，TBB 非常像 C++，而我不太喜欢 OpenMP 编译指示（有点 C 的味道，如果我必须用 C 编写，我会使用它）。

我也会考虑团队现有的知识和经验。学习一个新库（尤其是在线程/并发方面）确实需要一些时间。我认为目前，OpenMP 比 TBB 更广为人知和部署（但这只是我的观点）。

还有一个因素——但考虑到最常见的平台，可能不是问题——可移植性。但是许可证可能是个问题。

*   TBB 融合了一些源自学术研究的优秀研究，例如[递归数据并行方法](http://software.intel.com/en-us/blogs/2007/09/28/hierarchically-tiled-arrays-and-threading-building-blocks/)。
*   有一些关于缓存友好性的工作，[例如](http://software.intel.com/en-us/blogs/2007/09/25/cache-affinity-support-for-tbb-2/).
*   英特尔博客的讲座似乎很有趣。

* * *

## 回答 #3

> 赞同：19
> 
> 时间：2009-03-06T10:51:20.810

总的来说，我发现使用 TBB 需要对代码库进行更耗时的更改并获得高回报，而 OpenMP 提供快速但适中的回报。如果您正在从头开始关注新模块并考虑长期考虑，请选择 TBB。如果您想要小而直接的收益，请选择 OpenMP。

此外，TBB 和 OpenMP 并不相互排斥。

* * *

## 回答 #4

> 赞同：8
> 
> 时间：2009-04-28T11:54:25.210

我实际上都使用过这两种方法，我的总体印象是，如果您的算法相当容易实现并行（例如，大小均匀的循环，没有太多的数据相互依赖性），OpenMP 更容易，而且很好用。事实上，如果您发现自己可以使用 OpenMP，如果您知道您的平台会支持它，这可能是更好的选择。我没有使用过 OpenMP 的新任务结构，它比原来的循环和部分选项更通用。

TBB 预先为您提供了更多的数据结构，但肯定需要更多的预先准备。另外，它*可能*会更好地让您了解竞争条件错误。我的意思是，在 OpenMP 中通过不共享（或其他）应该共享的东西来启用竞争条件是相当容易的。只有当你得到不好的结果时，你才会看到这一点。我认为 TBB 不太可能发生这种情况。

总的来说，我个人偏爱 OpenMP，尤其是考虑到它在任务方面的表现力更强。

* * *

## 回答 #5

> 赞同：2
> 
> 时间：2012-01-10T07:14:45.103

据我所知，TBB（有一个可用的 GPLv2 下的开源版本）更关注 C++，然后是 C 领域。这些时候很难找到 C++ 和一般的 OOP 并行化特定信息。大多数地址功能性的东西，如 c（在 CUDA 或 OpenCL 上相同）。如果您需要 C++ 支持并行化，请选择 TBB！

* * *

## 回答 #6

> 赞同：2
> 
> 时间：2013-01-24T06:51:44.780

是的，TBB 对 C++ 更友好，而鉴于其设计，OpenMP 更适合 FORTRAN 风格的 C 代码。OpenMP 中的新任务功能看起来很有趣，同时 C++0x 中的 Lambda 和函数对象可能会使 TBB 更易于使用。

* * *

## 回答 #7

> 赞同：1
> 
> 时间：2010-06-28T17:43:23.547

在 Visual Studio 2008 中，您可以添加以下行来并行化任何“for”循环。它甚至可以与多个嵌套的 for 循环一起使用。这是一个例子：

```
#pragma omp parallel for private(i,j)
for (i=0; i<num_particles; i++)
{
  p[i].fitness = fitnessFunction(p[i].present);
  if (p[i].fitness > p[i].pbestFitness)
  { 
     p[i].pbestFitness = p[i].fitness;
     for (j=0; j<p[i].numVars; j++) p[i].pbest[j] = p[i].present[j];
  }
}  
gbest = pso_get_best(num_particles, p); 
```

在我们添加 #pragma omp parallel 后，我的 Core 2 Duo 上的两个内核都使用了最大容量，因此总 CPU 使用率从 50% 上升到 100%。

# wpf - 带有 Blend 的 ListBox 项目的 DataTemplate 中 IsSelected 的 WPF 触发器

> ID：615268
> 
> 赞同：2
> 
> 时间：2009-03-05T15:29:30.107
> 
> 标签：wpf, listbox, datatemplate, expression-blend

当我选择一个 listboxItem 时，我想改变前景色，我用这段代码做到了：

```
<DataTrigger Binding="{Binding  
RelativeSource={RelativeSource Mode=FindAncestor,AncestorType={x:Type ListBoxItem}},Path=IsSelected}" Value="True">
                            <Setter TargetName="descriptionTB" Property="Foreground" Value="#000"/>
</DataTrigger> 
```

[你可以在这里](https://stackoverflow.com/questions/248545/wpf-trigger-for-isselected-in-a-datatemplate-for-listbox-items)找到答案。

但是，如果我想让设计师在**Blend**中做到这一点，他将如何在不深入 xaml 的情况下做到这一点？

谢谢

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-03-05T16:07:59.903

也许我误解了这个问题，但你不能只为 descriptionTB 创建一个样式资源，让设计师只处理那个样式定义而不是绑定吗？

```
<DataTrigger Binding="..">
    <Setter TargetName="descriptionTB" Property="Style" Value="{StaticResource DescriptionTextBoxStyle}" />
</DataTrigger> 
```

在控件或窗口的资源部分添加样式定义：

```
<Style TargetType="{x:Type TextBox}" x:Key="DescriptionTextBoxStyle">
    <Setter Property="Foreground" Value="#000" />
</Style> 
```

如果您想进一步将设计器与 UI 机制隔离开来，您可以在单独的 xaml 文件中创建资源字典，您可以在其中收集所有用于设计器的样式。然后，您可以将该资源字典与您的控件或应用程序的主要资源合并。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2009-03-05T23:21:58.597

阿图尔，

Expression Blend 中的触发器设计器只允许添加和修改 EventTriggers 和 Property 触发器。我还没有找到使用 Blend 添加 DataTriggers 的方法。我也不确定如何使用 Blend 设置 RelativeSource Binding。我一直将 XAML 代码用于测试，并将 Blend 用于其他所有内容。

# ruby-on-rails - 在 Rails 中将自动增量添加回主键列

> ID：615272
> 
> 赞同：18
> 
> 时间：2009-03-05T15:30:25.267
> 
> 标签：ruby-on-rails, activerecord, auto-increment, rails-migrations

我错误地从表的 id 字段中删除了自动增量选项。谁能告诉我如何通过迁移重新插入自动增量选项？

* * *

## 回答 #1

> 赞同：20
> 
> 时间：2009-03-05T15:34:45.273

尝试：

```
change_column :my_table, :id, :primary_key 
```

或者

```
my_table.change_column :id, :primary_key 
```

某些 Rails 数据库适配器可能不允许您调用`change_column`主键。如果是这种情况，那么您可以随时调用`execute`以直接使用 SQL 执行更改：

MySQL：

```
execute('ALTER TABLE "my_table" CHANGE "id" "id"
  bigint DEFAULT NULL auto_increment PRIMARY KEY') 
```

PostgreSQL（方法一）：

```
max_id = execute(%%Q{SELECT id FROM "my_table" ORDER BY "id" DESC
  LIMIT 1}).to_a.first
execute(%%Q{CREATE SEQUENCE "my_table_id_seq" START #{max_id+1}})
execute(%%Q{ALTER TABLE "my_table" ALTER COLUMN "id"
  TYPE bigint})
execute(%%Q{ALTER TABLE "my_table" ALTER COLUMN "id"
  SET DEFAULT nextval('my_table_id_seq'::regclass)})
execute(%%Q{ALTER TABLE "my_table" ADD PRIMARY KEY("id")}) 
```

PostgreSQL（方法二）：

```
max_id = execute(%%Q{SELECT "id" FROM "my_table" ORDER BY "id" DESC
  LIMIT 1}).to_a.first
execute(%%Q{ALTER TABLE "my_table" RENAME COLUMN "id" TO "id_orig"})
execute(%%Q{ALTER TABLE "my_table" ADD COLUMN "id" bigserial NOT NULL})
execute(%%Q{UPDATE "my_table" SET "id"="id_orig"})
execute(%%Q{ALTER SEQUENCE "my_table_id_seq" RESTART #{max_id+1}})
execute(%%Q{ALTER TABLE "my_table" DROP COLUMN "id_orig"}) 
```

如果您不想使用`bigint`/ `bigserial`（64 位），请改用`int(11)`/ `integer`/ `serial`。

* * *

## 回答 #2

> 赞同：7
> 
> 时间：2017-01-03T16:43:04.240

我没有检查其他版本，但在 Rails 5 上你可以设置`auto_increment`选项：

```
change_column :table_name, :id, :int, null: false, unique: true, auto_increment: true 
```

或者，如果你想要一个 bigint：

```
change_column :table_name, :id, :bigint, null: false, unique: true, auto_increment: true 
```

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2009-07-30T11:09:19.497

您的 Postgres 代码不起作用，不可能在 ALTER TABLE 语句中使用 serial 或 bigserial 。PostgreSQL 的正确 SQL 是

```
ALTER TABLE table ALTER COLUMN id TYPE int 
ALTER TABLE table ALTER COLUMN id TYPE bigint 
```

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2020-06-23T14:34:39.220

对于那些来到这里（就像我所做的那样）试图弄清楚如何制作`id`使用`bigint`而不是的自定义列的人`int`，我没有意识到对于 Rails 5.1 及更高版本，`bigint`是 id 的默认类型

[https://github.com/rails/rails/pull/26266](https://github.com/rails/rails/pull/26266)

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2020-10-23T05:40:48.033

***更改列***

Rails5

```
change_column :table_name, :id, :int, null: false, unique: true, auto_increment: true,  primary_key: true 
```

Rails6

```
change_column :table_name, :id, :int, null: false, unique: true, auto_increment: true,  primary_key: true 
```

***添加立柱*** Rails5

```
add_column :table_name, :id, :int, null: false, unique: true, auto_increment: true,  primary_key: true 
```

Rails6

```
add_column :table_name, :id, :int, null: false, unique: true, auto_increment: true,  primary_key: true 
```

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2020-12-17T10:19:57.603

这对我有用，创建了一个主列并为所有行提供了 ID。

```
add_column :tags_posts_rel, :id, :primary_key 
```

# tfs - 为什么有些解决方案不能完全使用 TFS 构建？

> ID：615279
> 
> 赞同：1
> 
> 时间：2009-03-05T15:31:46.713
> 
> 标签：tfs

我注意到 Team Foundation Server 2008 中的一些解决方案无法完全构建。例如，解决方案中的一些项目成功了，但随后一个项目失败了。特定的失败项目说我缺少程序集参考。但我不是 - 该项目有参考。它在我的 PC 上运行良好。我正在查看构建代理下拉的 .csproj 文件，它也有参考（它与我正在构建的项目逐行相同）。

有问题的参考是解决方案中的另一个项目。起初我认为它没有以正确的顺序构建项目，但构建日志告诉我它确实做到了（即，引用所引用的项目成功构建）。所以我的猜测是，在这个项目中（我会说大约 10-20% 的我正在构建的项目都失败了）它正在查看错误的程序集文件夹，但我不知道。

有没有人见过这个？

我确实有一个解决方案，它以错误的顺序构建东西，一些谷歌搜索似乎表明这是将 VS2003 SLN 文件转换为 VS2008 SLN 文件的偶然副作用（它也在 Visual Studio 中发生），所以在那种情况下，我从头开始制作了一个新的 SLN，在有问题的 SLN 的“顶部”检查它，它工作正常。但我在上面的问题中尝试过，但没有任何区别。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2009-03-05T16:04:32.643

I've seen it on multicore machines where the project dependencies haven't been setup correctly, meaning that tfs starts a project compiling before it's dependencies are finished compiling.

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2010-01-07T04:48:22.257

> > 起初我认为它没有以正确的顺序构建项目，但构建日志告诉我它确实做到了（即，引用所引用的项目成功构建）。

定义“构建成功”。特别是，确保 CoreCompile 目标被调用并运行完成。我已经看到在引用项目上构建了不同目标的情况，但该目标不足以生成依赖项目所需的输出。例如，一个包含 Silverlight 控件的 Web 项目将调用 Silverlight 项目上的 GetXapOutputFile 目标——这很好，但它不能替代 CoreCompile。

如果此线索不足以解决您的问题，您可能应该发布指向日志和/或 msbuild makefile 的链接。

# sql-server - 我应该为客户提供具有“db_owner”角色的 SQL Server 登录名吗？

> ID：615280
> 
> 赞同：4
> 
> 时间：2009-03-05T15:31:49.570
> 
> 标签：sql-server, security

我们的一位客户要求我们在他们的网站使用的数据库登录中包含“db_owner”角色，以便他们可以上传脚本（ASP 页面）来运行一些数据库更改。通常，我们服务器上托管的数据库的登录名仅包括“db_reader”和“db_writer”。这可以吗，还是我应该要求他们将 sql 脚本转发给我们以代表他们运行？

还是我保护得太多了？谢谢

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2009-03-05T15:34:38.050

我建议您充当他们之间的过滤器，以及他们可能想要对数据库执行的任何操作，例如上传和运行这些脚本。如果他们得到 db_owner 并将其全部解决，那么您可能仍会因为让他们一开始就将其放在砧板上。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2009-03-05T15:43:13.723

我认为在我对数据库进行如此多的控制之前，我希望有一个每个人都可以接受的服务水平协议。例如，您可以指定如果客户端以无法修复的方式损坏其数据库，您的响应将仅限于在特定时间范围内将其恢复到他们选择的备份点。您可能还要求他们为数据库问题维护一个特定的技术联系人，该联系人将是其开发人员的第一个联系人等。SLA 应说明各种风险，包括数据丢失，继承具有此级别的能力。

一般来说，如果客户愿意承担责任，我倾向于给予更多的控制权，而不是更少。作为使用此类服务​​的人，我知道如果允许我进行需要进行的更改而不必费力，它肯定可以提高生产力。我也愿意接受所涉及的风险，但我清楚地知道其中的含义是什么。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-03-05T15:39:45.620

他们正在运行什么样的脚本？

与其提供直接访问，不如提供 TheTXI 建议的某种接口。我会非常担心给 db_owner 不必要的访问权限。

那可能是您，或者团队成员，或者根据脚本的类型，您可能能够为他们提供某种 Web 界面（从而允许您至少围绕脚本包装一些验证）。

但是，如果他们直接在系统上运行您不想要的东西，它很可能会在您身上（无论是管理恢复还是更严重的事情）

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2009-03-05T15:40:35.647

您可以通过您的权限获得更精细的权限，让他们只做您想做的事。这将取决于他们希望多久进行一次更改以及您对他们的数据负责的程度。除非有充分的理由，否则我不想将 dbo 授予某人。

确保他们是数据库的所有者，而不仅仅是 dbo 角色。如果 dbchaining 在具有相同所有者的另一个数据库中打开，他们可以在他们的数据库中打开它并在该其他数据库中具有 dbo 权限。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2009-03-05T15:41:45.410

或者，让他们签署一份协议，上面写着“您对数据或数据库架构造成的任何损害，由您或任何以所述数据库帐户登录的人造成的，都不是您的错，不能归咎于您，等等。”在至少如果他们把东西搞砸了，这样你就被覆盖了，客户也很高兴。尽管您可能希望为此给他们一个单独的登录名，这样他们就不能将错误的更改归咎于网站代码。

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2014-08-27T20:57:21.310

对于过度保护的 DBA 有一个词：“受雇”

其余的，不多。

# terminal - RHEL 5.x 中默认的 LS_COLORS 设置在哪里？

> ID：615282
> 
> 赞同：4
> 
> 时间：2009-03-05T15:32:12.313
> 
> 标签：terminal, redhat, rhel, ls-colors

在 Red Hat Enterprise Linux 5.x 的终端中，运行：

```
[$] Env 
```

返回（除其他外）：

```
"LS_COLORS=no=00:fi=00:di=01;34:ln=01;36:pi=40;33 . . ." 
```

我在文件中找到的大部分内容`LS_COLORS`：

```
/etc/DIR_COLORS 
```

但是值“`no=00:fi=00:di=01;34:ln=01;36:pi=40;33`等”，即使通过系统搜索，我也没有成功找到。

这些值在哪些文件中定义？

是的，我知道我可以将 的内容设置为`LS_COLORS`我喜欢的值，但我想知道的是上面的值是**在哪里****定义**的。

* * *

## 回答 #1

> 赞同：8
> 
> 时间：2009-11-21T19:29:03.440

我认为您可以在以下位置找到您要查找的内容`/etc/profile.d/colorls.sh`：

```
# color-ls initialization

alias ll='ls -l' 2>/dev/null
alias l.='ls -d .*' 2>/dev/null

COLORS=/etc/DIR_COLORS
[ -e "/etc/DIR_COLORS.$TERM" ] && COLORS="/etc/DIR_COLORS.$TERM"
[ -e "$HOME/.dircolors" ] && COLORS="$HOME/.dircolors"
[ -e "$HOME/.dir_colors" ] && COLORS="$HOME/.dir_colors"
[ -e "$HOME/.dircolors.$TERM" ] && COLORS="$HOME/.dircolors.$TERM"
[ -e "$HOME/.dir_colors.$TERM" ] && COLORS="$HOME/.dir_colors.$TERM"
[ -e "$COLORS" ] || return

eval `dircolors --sh "$COLORS" 2>/dev/null`
[ -z "$LS_COLORS" ] && return

if ! egrep -qi "^COLOR.*none" $COLORS >/dev/null 2>/dev/null ; then
        alias ll='ls -l --color=tty' 2>/dev/null
        alias l.='ls -d .* --color=tty' 2>/dev/null
        alias ls='ls --color=tty' 2>/dev/null
fi 
```

该`LS_COLORS`变量是通过对 的输出的评估来设置的`dircolors --sh "$COLORS" 2>/dev/null`，而后者又从 接收其值`/etc/DIR_COLORS`。所以换句话说，默认情况下的值`LS_COLORS`是相同`DIR_COLORS`的。

您可以通过比较以下输出来证明这一点`dircolors --sh "$COLORS"`：

```
$ dircolors --sh "$COLORS" 
LS_COLORS='no=00:fi=00:di=01;34:ln=01;36:pi=40;33:so=01;35:bd=40;33;01:cd=40;33;01:or=01;05;37;41:mi=01;05;37;41:ex=01;32:*.cmd=01;32:*.exe=01;32:*.com=01;32:*.btm=01;32:*.bat=01;32:*.sh=01;32:*.csh=01;32:*.tar=01;31:*.tgz=01;31:*.arj=01;31:*.taz=01;31:*.lzh=01;31:*.zip=01;31:*.z=01;31:*.Z=01;31:*.gz=01;31:*.bz2=01;31:*.bz=01;31:*.tz=01;31:*.rpm=01;31:*.cpio=01;31:*.jpg=01;35:*.gif=01;35:*.bmp=01;35:*.xbm=01;35:*.xpm=01;35:*.png=01;35:*.tif=01;35:';
export LS_COLORS 
```

并且`echo $LS_COLORS`：

```
$ echo $LS_COLORS
no=00:fi=00:di=01;34:ln=01;36:pi=40;33:so=01;35:bd=40;33;01:cd=40;33;01:or=01;05;37;41:mi=01;05;37;41:ex=01;32:*.cmd=01;32:*.exe=01;32:*.com=01;32:*.btm=01;32:*.bat=01;32:*.sh=01;32:*.csh=01;32:*.tar=01;31:*.tgz=01;31:*.arj=01;31:*.taz=01;31:*.lzh=01;31:*.zip=01;31:*.z=01;31:*.Z=01;31:*.gz=01;31:*.bz2=01;31:*.bz=01;31:*.tz=01;31:*.rpm=01;31:*.cpio=01;31:*.jpg=01;35:*.gif=01;35:*.bmp=01;35:*.xbm=01;35:*.xpm=01;35:*.png=01;35:*.tif=01;35: 
```

你有它。

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2012-09-27T12:12:40.890

```
 /etc/DIR_COLORS 
```

上面的和下面的不一样。

```
 /etc/DIR_COLORS.xterm. 
```

使用 SSH 终端文件登录时

```
/etc/DIR_COLORS.xterm 
```

用来。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-03-05T15:48:46.080

来自“dircolors”联机帮助页::

> 如果指定了 FILE，则读取它以确定将哪些颜色用于哪些文件类型和扩展名。否则，使用预编译数据库。有关这些文件格式的详细信息，请运行 `dircolors --print-database'。

所以看起来那些代码是在系统中编译的

# linux - 包含例如 git-branch(1) 的手册页的含义是什么

> ID：615283
> 
> 赞同：3
> 
> 时间：2009-03-05T15:32:21.813
> 
> 标签：linux

**重复：[https ://stackoverflow.com/questions/587676/why-do-programs-in-unix-like-environments-have-numbers-after-their-name/](https://stackoverflow.com/questions/587676/why-do-programs-in-unix-like-environments-have-numbers-after-their-name)**

例如，如果我输入：

```
man ps 
```

...然后滚动到最后我看到这样的内容：

```
SEE ALSO
     kill(1), w(1), kvm(3), strftime(3), sysctl(8) 
```

我该如何解释这个？我知道 kill 是另一个命令，但是（1）的含义是什么？这有什么关系吗？

git 手册页充满了这些：

```
git-add(1), git-am(1), git-archive(1) 
```

有人想告诉我什么？

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2009-03-05T15:44:58.477

要访问给定编号部分的手册页，请键入`man number command`

从`man man`

> 1.  可执行程序或 shell 命令
> 2.  系统调用（内核提供的函数）
> 3.  库调用（程序库中的函数）
> 4.  特殊文件（通常在 /dev 中找到）
> 5.  文件格式和约定，例如 /etc/passwd
> 6.  游戏
> 7.  杂项（包括宏包和约定），例如 man(7)、groff(7)
> 8.  系统管理命令>（通常仅适用于 root）
> 9.  内核例程 [非标准]

例如，

```
man 1 printf 
```

将为您提供 shell printf 命令的页面，而

```
man 3 printf 
```

将为您提供 C 库调用的页面。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2009-03-05T15:37:58.523

手册页分为多个部分，例如系统调用、命令、宏等，主要是为了防止名称冲突，例如当系统调用与命令同名时。

一个例子是`sleep`：

```
man 1 sleep 
```

相对

```
man 3 sleep 
```

[第 1 节](http://linux.die.net/man/1/)是为用户命令保留的。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2009-03-05T15:41:30.373

的内容`man`分为几个部分：

1.  用户可用的命令
2.  Unix 和 C 系统调用
3.  C 程序的 C 库例程
4.  特殊文件名
5.  Unix 使用的文件的文件格式和约定
6.  游戏
7.  文字处理包
8.  系统管理命令和程序

`kill(1)`关于命令也是如此，但`strftime(3)`与 C 例程有关。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2009-03-05T15:42:13.087

手册页分为多个部分。例如第 1 节有命令，第 2 节有系统调用。

如果你运行 man kill 它会找到 kill(1) 这是命令。

如果你运行 man 2 kill，它会显示系统调用也名为 kill。

crontab(1) 和 crontab(5) 也是如此。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2009-03-05T15:59:49.067

正如其他所说，手册页分为几个部分。`git-branch(1)`指`git-branch`手册第 1 节中命名的手册页。您可以使用以下两个命令之一访问此特定手册页（取决于您的 man 风格）：

```
man 1 git-branch 
```

或者

```
man -s 1 git-branch 
```

此外，有些项目可以出现在几个部分中，具有不同的含义，例如，`printf(1)`和`printf(3)`。打字：

```
man printf 
```

根据`MANPATH`环境变量的顺序显示找到的第一项的手册页。您可以重新排序`MANPATH`以更改部分的优先级或使用：

```
man -a printf 
```

用于显示`printf`.

# .net - 有用的 PowerShell 一班轮

> ID：615287
> 
> 赞同：19
> 
> 时间：2009-03-05T15:33:36.850
> 
> 标签：.net, powershell, scripting, scripting-language

请提供您认为有用的一行 PowerShell 脚本，每个答案一个脚本。

这里有一个类似的[问题](https://stackoverflow.com/questions/285064/what-are-some-good-powershell-script-repositories)，但是这个问题只提供了带有脚本的页面的链接，让我们在这里一一回答，并提供最常用或最有用的脚本的贡献列表。

1.  列出最新版本的文件

    `ls -r -fi *.lis | sort @{expression={$_.Name}}, @{expression={$_.LastWriteTime};Descending=$true} | select Directory, Name, lastwritetime | Group-Object Name | %{$_.Group | Select -first 1}`

2.  `gps programThatIsAnnoyingMe | kill`

3.  使用其注册程序打开一个文件（`start`例如`start foo.xls`）

    `ii foo.xls`

4.  检索并显示系统特殊文件夹的路径

    `[enum]::getvalues([system.environment+specialfolder]) | foreach {"$_ maps to " + [system.Environment]::GetFolderPath($_)}`

5.  将环境值复制到剪贴板（所以现在你知道如何使用剪贴板了！）

    `$env:appdata | % { [windows.forms.clipboard]::SetText($input) }`
    或者
    `ls | clip`

**使用管理单元**

1.  TFS 中两个变更集编号之间的文件

    `Get-TfsItemHistory <location> -Recurse -Version <label1>~<label2> | % { $(Get-TfsChangeset $_.ChangeSetID).Changes } | % { $_.Item.ServerItem } | Sort-Object -Unique`

2.  获取所有 Hub 服务器上的错误队列消息以交换 200

    `Get-ExchangeServer | ?{$_.IsHubTransportServer -eq $true} | Get-Queue | ?{$_.LastError -ne $null} | Sort-Object -Descending -Property MessageCount | ft -Property NextHopDomain,@{l="Count";e={$_.MessageCount}},@{l="Last Try";e={$_.LastRetryTime.tosting("M/dd hh:mm")}},@{l="Retry";e={$_.NextRetryTime.tostring("M/dd hh:mm")}},Status,LastError -AutoSize`

* * *

## 回答 #1

> 赞同：21
> 
> 时间：2009-06-03T15:36:41.897

在下午 6:00 左右......

```
exit 
```

* * *

## 回答 #2

> 赞同：13
> 
> 时间：2009-03-05T20:30:30.227

列出我今天更新的所有文件：

```
dir | ?{$_.LastWriteTime -ge [DateTime]::Today} 
```

经常使用它，以至于我实际上在我的个人资料中创建了一个小功能：

```
function Where-UpdatedSince{
Param([DateTime]$date = [DateTime]::Today,
      [switch]$before=$False)
Process
{ 
    if (($_.LastWriteTime -ge $date) -xor $before)
    {
        Write-Output $_
    }
} 
};  set-item -path alias:wus -value Where-UpdatedSince 
```

所以我可以说：

```
dir | wus
dir | wus "1/1/2009" 
```

要查看今天之前更新的内容：

```
dir | wus -before 
```

* * *

## 回答 #3

> 赞同：13
> 
> 时间：2009-03-05T16:33:50.793

Well, here is one I use often along with some explanation.

```
ii .

```

The ii is an alias for Invoke-Item. This commandlet essentially invokes whatever command is registered in windows for the following item. So this:

```
ii foo.xls

```

Would open `foo.xls` in Excel (assuming you have Excel installed and .xls files are associated to Excel).

In `ii .` the `.` refers to the current working directory, so the command would cause windows explorer to open at the current directory.

* * *

## 回答 #4

> 赞同：6
> 
> 时间：2009-03-05T15:37:16.373

我最喜欢的 powershell 一班轮

```
gps programThatIsAnnoyingMe | kill 
```

* * *

## 回答 #5

> 赞同：4
> 
> 时间：2009-03-18T00:29:51.973

```
($x=new-object xml).Load("http://rss.slashdot.org/Slashdot/slashdot");$x.RDF.item|?{$_.creator-ne"kdawson"}|fl descr* 
```

我最喜欢的：这是一个 slashdot 阅读器，没有先生的可怕提交。科道森 它被设计为少于 120 个字符，因此可以用作 / 上的签名。

* * *

## 回答 #6

> 赞同：3
> 
> 时间：2009-03-10T21:02:35.817

检索并显示系统特殊文件夹的路径

```
[enum]::getvalues([system.environment+specialfolder]) | foreach {"$_ maps to " + [system.Environment]::GetFolderPath($_)} 
```

* * *

## 回答 #7

> 赞同：3
> 
> 时间：2009-12-18T13:13:33.543

我不喜欢计算代码行数的复杂应用程序，尤其是因为我认为它首先是一个虚假的指标。我最终改用 PS 单线：

```
PS C:\Path> (dir -include *.cs,*.xaml -recurse | select-string .).Count 
```

我只是在行数中包含我想要包含的文件的扩展名，然后从项目的根目录中获取它。

* * *

## 回答 #8

> 赞同：3
> 
> 时间：2009-06-01T12:15:37.463

我发现显示环境变量的值很有用

```
dir env: 
```

您也可以将 env 值复制到剪贴板

```
$env:appdata | % { [windows.forms.clipboard]::SetText($input) } 
```

（您需要在调用之前加载 windows.forms：Add-Type –a system.windows.forms；并使用 -STA 开关运行 PowerShell）

* * *

## 回答 #9

> 赞同：3
> 
> 时间：2014-04-29T03:39:18.857

我犹豫要一一列举我的 PowerShell 单行代码列表，因为列表编号目前只有大约 400 个条目！:-) 但这里有一些我最喜欢的，以激起你的兴趣：

*   列出所有类型的加速器（需要[PSCX](http://pscx.codeplex.com/)）：`[accelerators]::get`
*   将 XML 的字符串表示形式转换为实际的 XML：`[xml]"<root><a>...</a></root>"`
*   转储一个对象（增加深度以获得更多细节）：`$PWD | ConvertTo-Json -Depth 2`
*   通过子字符串从历史记录中调用命令（查找之前的 'cd' cmd）：`#cd`
*   访问 C# 枚举值：`[System.Text.RegularExpressions.RegexOptions]::Singleline`
*   生成条形图（需要 Jeff Hicks 的[cmdlet](http://jdhitsolutions.com/blog/tag/graphing/)）：`ls . | select name,length | Out-ConsoleGraph -prop length -grid`

整个系列在 Simple-Talk.com 上发布的 4 部分系列中公开提供——我希望这些对 SO 读者有用！

*   第 1 部分：[帮助、语法、显示和文件](http://www.simple-talk.com/sysadmin/powershell/powershell-one-liners-help,-syntax,-display-and--files/)
*   第 2 部分：[变量、参数、属性和对象](http://www.simple-talk.com/sysadmin/powershell/powershell-one-liners-variables,-parameters,-properties,-and-objects/)
*   第 3 部分：[集合和哈希表](http://www.simple-talk.com/sysadmin/powershell/powershell-one-liners--collections,-hashtables,-arrays-and-strings/)
*   第 4 部分：[文件和数据流](http://www.simple-talk.com/sysadmin/powershell/powershell-one-liners--accessing,-handling-and-writing-data-/)

我想将这个系列称为*“在 PowerShell 的一行中做任何事情”，*但我的编辑想要更简洁的东西，所以我们选择了*PowerShell One-Liners*。尽管为了充分披露，只有 98% 左右是真正符合该术语真正精神的单行者；我认为四舍五入已经足够接近了...... :-)

* * *

## 回答 #10

> 赞同：3
> 
> 时间：2012-06-01T13:35:58.077

禁止 Visual Studio 2012 ALL CAPS 菜单 - 安装 VS2012 后我做的第一件事。

```
Set-ItemProperty -Path HKCU:\Software\Microsoft\VisualStudio\11.0\General -Name SuppressUppercaseConversion -Type DWord -Value 1 
```

感谢发现注册表值的[Richard Banks 。](https://stackoverflow.com/users/63179/richard-banks)

* * *

## 回答 #11

> 赞同：2
> 
> 时间：2009-03-22T06:57:27.710

这显示了哪些进程正在使用哪些版本的 MS CRT DLL：

```
gps | select ProcessName -exp Modules -ea 0 | 
  where {$_.modulename -match 'msvc'} | sort ModuleName | 
  Format-Table ProcessName -GroupBy ModuleName 
```

* * *

## 回答 #12

> 赞同：2
> 
> 时间：2009-06-01T11:15:24.153

由于我安装了 TFS PowerTools snap，这可能是作弊，但这对于找出哪些文件在两个变更集、版本或标签之间发生了更改非常有用。

```
Get-TfsItemHistory <location> -Recurse -Version <label1>~<label2> | 
% { $(Get-TfsChangeset $_.ChangeSetID).Changes } |
% { $_.Item.ServerItem } | Sort-Object -Unique 
```

* * *

## 回答 #13

> 赞同：1
> 
> 时间：2011-07-04T03:03:34.223

按 alpha 顺序列出所有 Windows 提供程序：

```
get-winevent -listprovider microsoft-windows* | % {$_.Name} | sort 
```

实际上，您可以将它与通配符一起用于任何特定的提供者组：

```
get-winevent -listprovider microsoft-windows-Securit* | % {$_.Name} | sort 
```

* * *

## 回答 #14

> 赞同：1
> 
> 时间：2013-09-27T18:27:13.020

在文件中生成一些伪随机字节。

```
[Byte[]]$out=@(); 0..9 | %{$out += Get-Random -Minimum 0 -Maximum 255}; [System.IO.File]::WriteAllBytes("random",$out) 
```

Get-Random 算法从系统时钟中获取种子，因此不要将其用于严重的加密需求。

* * *

## 回答 #15

> 赞同：1
> 
> 时间：2012-10-24T23:47:03.640

将某些内容的输出通过管道传输到剪贴板

```
ls | clip 
```

* * *

## 回答 #16

> 赞同：1
> 
> 时间：2016-01-22T05:58:46.787

```
cls 
```

在我尝试的每个命令之后摆脱所有难以处理的、冗长的红色标记，让我以漂亮的豪华清晰屏幕继续。

* * *

## 回答 #17

> 赞同：0
> 
> 时间：2009-12-18T13:07:09.747

功能显示的系统正常运行时间我将其用于我的会计电子表格

```
 function get-uptime
{
$PCounter = "System.Diagnostics.PerformanceCounter"
$counter = new-object $PCounter System,"System Up Time"
$value = $counter.NextValue()
$uptime = [System.TimeSpan]::FromSeconds($counter.NextValue())
"Uptime: $uptime"
"System Boot: " + ((get-date) - $uptime)
} 
```

* * *

## 回答 #18

> 赞同：0
> 
> 时间：2009-06-01T13:48:32.767

Gets queue messages with errors over all Hub servers in exchange 2007 (with some formatting)

```
Get-ExchangeServer | ?{$_.IsHubTransportServer -eq $true} | Get-Queue | ?{$_.LastError -ne $null} | Sort-Object -Descending -Property MessageCount | ft -Property NextHopDomain,@{l="Count";e={$_.MessageCount}},@{l="Last Try";e={$_.LastRetryTime.tosting("M/dd hh:mm")}},@{l="Retry";e={$_.NextRetryTime.tostring("M/dd hh:mm")}},Status,LastError -AutoSize 
```

* * *

## 回答 #19

> 赞同：0
> 
> 时间：2010-02-03T06:12:03.653

复制一些到桌面：

```
Copy-Item $home\*.txt ([Environment]::GetFolderPath("Desktop")) 
```

# ruby - 在新的 Sinatra 扩展中集成模型和视图

> ID：615291
> 
> 赞同：2
> 
> 时间：2009-03-05T15:34:20.267
> 
> 标签：ruby, model, view, sinatra

所以我想使用新的可能性来为[Sinatra](http://www.sinatrarb.com)创建扩展。

我的扩展需要集成模型和一些视图/模板，但我不知道如何或在哪里集成它们？

是否有人已经构建了比文档中的示例更复杂的东西？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-03-12T14:49:49.080

[这](http://www.sinatrarb.com/wild.html#libs)是 Sinatra 网站上的库和扩展列表

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-05-18T16:23:32.570

查看Sinatra官方网站上的[Sinatra：Writing Extensions文章。](http://www.sinatrarb.com/extensions.html)

# sql-server - 让用户查看 sys.databaseprincipals 的所有信息

> ID：615301
> 
> 赞同：0
> 
> 时间：2009-03-05T15:35:53.240
> 
> 标签：sql-server

我有一个数据库，我想让某个角色获得从 sys.databaseprincipals 查询所有信息并查看其他用户名的权限。我怎样才能做到这一点？

谢谢。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-03-05T15:55:32.727

将调用包装在存储的过程或表值函数中，并使用[EXECUTE AS OWNER](http://msdn.microsoft.com/en-us/library/ms181362(SQL.90).aspx)（假设 dbo.nameofcodeobject）。

否则，您必须关闭整个服务器的[MetaData Visibility保护](http://msdn.microsoft.com/en-us/library/ms187113(SQL.90).aspx)

您不能将 EXECUTE AS 用于此处有用的视图...

编辑，根据评论。

从[sys.database_principals](http://msdn.microsoft.com/en-us/library/ms187328.aspx)：

> 在 SQL Server 2005 和更高版本中，目录视图中元数据的可见性仅限于用户拥有或已被授予某些权限的安全对象。有关详细信息，请参阅元数据可见性配置。

*   dbo 拥有一切，因此可以看到一切
*   无法授予权限，因为没有“GRANT VIEW SECURITY”

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-03-05T16:07:55.160

也许只有我和我的服务器设置，但只要我有连接权限，我就可以查询 sys.database_principals。我也可以看到用户名。

您可以通过以下方式授予 Connect：

授予 [用户] 连接

# http - 浏览文件时出现未经授权的错误

> ID：615305
> 
> 赞同：1
> 
> 时间：2009-03-05T15:36:53.830
> 
> 标签：http, iis, windows-authentication, unauthorized

我的 IIS 配置为使用 WindowsAuthentication。

当我浏览文件时：

我可以完美地看到该文件，但是当我使用 charles（http 调试器）检查时，我看到了以下结果。

[替代文字 http://img155.imageshack.us/img155/6428/capturea.jpg](http://img155.imageshack.us/img155/6428/capturea.jpg)

问题是，当浏览器执行此操作时，它会重试（最多 3 次）但是当 .NET（spring.net）尝试此操作时，它在第一次尝试说我未经授权后崩溃。

有人对此有解决方案吗？我已经为这个问题苦苦挣扎了好几个星期了。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-03-07T11:21:21.090

我看这很正常。您可以从这篇知识库文章中了解有关客户端和服务器之间对话的更多信息，

[http://support.microsoft.com/kb/264921](http://support.microsoft.com/kb/264921)

然后你就会知道为什么会有那些 401 消息。

问候，

# c# - 您如何退回原始列表的副本 来自 Func ?

> ID：615310
> 
> 赞同：1
> 
> 时间：2009-03-05T15:37:50.820
> 
> 标签：c#, linq, delegates, .net-3.5, c#-3.0

我发现（以一种艰难的方式）正在枚举的集合不能在“Foreach”语句中修改

> “集合已修改；枚举操作可能无法执行。”

现在，我想出的解决方案是创建一个大小相同的虚拟集合，其中包含一个字典键，并对其进行枚举以修改相关集合。

```
 private void InvalidateAuthenticatedNodes()
    {
        var dummy = new Dictionary<int, bool>(_AuthenticatedNodes.Count);
        foreach (var nodeId in _AuthenticatedNodes.Keys)
            dummy[nodeId] = false;

        foreach (var nodeId in dummy.Keys)
            _AuthenticatedNodes[nodeId] = false;

        ClearAuthenticatedDateTime();
    } 
```

上面的代码运行良好；我正在重构上面的代码以使用 Func 委托返回密钥的副本，如下所示

```
 private void InvalidateAuthenticatedNodes()
    {
        var getNodeIds = 
            new Func<Dictionary<int, bool>, IEnumerable<int>>(
                nodes => nodes.Select(node => node.Key));
        foreach (var nodeId in getNodeIds(_AuthenticatedNodes))
        {
            _AuthenticatedNodes[nodeId] = false;
        }

        ClearAuthenticatedDateTime();
    } 
```

与我的预期不同，*getNodeIds*不返回副本。有没有办法退回副本？

***编辑：** [JaredPar 回答](https://stackoverflow.com/questions/615310/how-do-you-return-a-copy-of-original-listt-from-funct-tresult/615314#615314)之前的临时结果

类似于 JaredPar 的回答，但他的回答更简洁，我同意了他的回答。但这是我想分享的类似结果。

```
 private void InvalidateAuthenticatedNodes()
    {
        var getNodeIds = 
            new Func<Dictionary<int, bool>, IEnumerable<int>>(nodes => 
                nodes.Select(node => node.Key));
        foreach (var nodeId in getNodeIds(_AuthenticatedNodes).ToList())
        {
            _AuthenticatedNodes[nodeId] = false;
        }

        ClearAuthenticatedDateTime();
    } 
```

***编辑**：最终结果（精制）

```
_AuthenticatedNodes.Keys.ToList().ForEach(
    nodeId => _AuthenticatedNodes[nodeId] = false); 
```

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2009-03-05T15:39:45.947

只需将 .ToList() 添加到集合的末尾，它就会自动返回列表的完整副本。

```
foreach (var nodeId in _AuthenticatedNodes.Keys.ToList())
    ... 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-03-05T15:40:12.780

您可以使用普通的 for，而不是使用 foreach。但是，添加/删除项目时要小心，它会更改集合内元素的索引。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2009-03-05T15:41:05.227

一旦您更改了 Enumerable 类，您的原始枚举数可能会变得无效，因此需要创建一个副本并在那里进行修改。

# php - 在 PHP 中上传一个非常大的文件时没有错误？

> ID：615312
> 
> 赞同：3
> 
> 时间：2009-03-05T15:38:40.940
> 
> 标签：php, upload

我有一个用于上传文件的 PHP 表单，它工作正常，如果出现问题，它会显示错误消息。这一切都很好。

问题是当我使用一个非常大的文件进行测试时，它只是刷新页面，就好像我根本没有发送文件一样，并且表单中的 $_POST 变量甚至都没有发送到服务器。

我想向用户显示一个错误，让他们知道文件太大。但是，我不能这样做。

有谁知道发生了什么？

* * *

## 回答 #1

> 赞同：13
> 
> 时间：2009-03-05T15:43:37.293

检查您的 PHP ini 文件，该文件控制 PHP 允许上传的文件大小。这些变量很重要：

*   最大上传文件大小 (upload_max_filesize)
*   最大帖子数据大小（post_max_size）
*   内存限制（memory_limit）

根据您的设置，超出这些范围的任何上传都将被忽略或错误输出。

文档中的这一部分有最好的总结：[http ://ca3.php.net/manual/en/features.file-upload.common-pitfalls.php](http://ca3.php.net/manual/en/features.file-upload.common-pitfalls.php)

编辑：另请注意，大多数浏览器不会发送超过 2GB 的上传文件。此链接已过时，但提供了一个想法：[http](http://www.motobit.com/help/scptutl/pa98.htm) ://www.motobit.com/help/scputl/pa98.htm 。任何人都有更好的信息来源？

服务器也可以施加一些限制，例如 Apache：[http ://httpd.apache.org/docs/2.2/mod/core.html#limitrequestbody](http://httpd.apache.org/docs/2.2/mod/core.html#limitrequestbody)

要真正了解发生了什么，您可能应该检查您的网络服务器日志，检查浏览器上传限制（如果您使用的是 firefox），并尝试查看是否`print_r($_FILES)`生成任何有用的错误编号。如果一切都失败了，请尝试 firebug 中的网络流量监视器。关键是要确定请求是否甚至发送到服务器，以及请求（包括标头）是否是这样的。一旦你在链中走得那么远，你就可以回去看看 PHP 是如何处理上传的。

* * *

## 回答 #2

> 赞同：7
> 
> 时间：2009-03-05T17:35:36.323

您的 $_POST 很可能是空的，因为上传超出了*post_max_size*指令：

从 PHP 的[指令页面](http://us3.php.net/ini.core)：

> 如果 post 数据的大小大于 post_max_size，**则 $_POST 和 $_FILES 超全局变量为空**。这可以通过多种方式进行跟踪，例如通过将$_GET 变量传递给处理数据的脚本，即 `<form action="edit.php?processed=1">`，然后检查是否设置了$_GET['processed']。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2009-03-05T18:33:11.990

在完全上传之前，您无法知道正在上传的文件的大小。所以如果你想确定文件大小，然后对大文件显示错误，首先你必须上传文件，然后检查文件大小。为了上传大文件，您应该在您的 php 配置文件 php.ini 中设置 2 个设置。打开它并搜索“upload_max_filesize”并将值设置为您想要的最大值。那么您必须设置 POST 参数的最大值，因为上传的文件是通过 HTTP POST 方法接收的。找到“post_max_size”并将其设置为较大的值。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2009-03-05T15:43:45.063

我将实现一个简单的脚本，该脚本执行常规的 ajax 调用以了解已完成了多少上传。然后，您可以实现某种进度条。网上有几个例子：

[http://martinjansen.com/2007/04/28/file-upload-progress-bars-with-php/](http://martinjansen.com/2007/04/28/file-upload-progress-bars-with-php/)

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2009-03-28T04:51:21.663

最大上传文件大小 (upload_max_filesize) 最大发布数据大小 (post_max_size) 是您需要设置的指令。我已经用多个操作系统、浏览器等对其进行了测试，这是您唯一需要担心的两件事。

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2016-11-25T06:22:27.797

除了前用户回答的选项之外：

```
max upload filesize (upload_max_filesize)
max post data size (post_max_size)
memory limit (memory_limit) 
```

还有一种情况，当文件很大，或者线路很忙的时候，需要很多时间来执行这个操作，这会达到脚本执行限制的上限。

```
max_execution_time 
```

# c# - Outlook 加载项开发问题

> ID：615326
> 
> 赞同：1
> 
> 时间：2009-03-05T15:42:09.450
> 
> 标签：c#, ms-office, vsto, outlook-addin

我正在阅读“Microsoft Office Outlook 编程应用程序：2007”一书。在示例代码中..

```
private void Application_ItemContextMenuDisplay(
    Microsoft.Office.Core.CommandBar CommandBar,
    Microsoft.Office.Interop.Outlook.Selection Selection)
{
    OutlookItem oItem = new OutlookItem(Selection[1]);

    //...
} 
```

上面代码的问题是我在任何地方都找不到 OutlookItem 类。由于我是 Office/Outlook 编程的新手，因此我需要一些指导。请让我知道如何将 Selection 中的项目作为通用 Outlook 项目访问，而不是指定或强制转换为 MailItem 或 AppointmentItem。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-03-05T16:35:39.900

Outlook 对象模型中没有像 OutlookItem 这样通用的类，上述 booke 的作者提供了 OutlookItem 作为帮助类。通常，帮助程序类使用反射来公开所有 Outlook 项目共有的方法。

因此，从这个答案中可以得出的结论是，当前 Outlook 对象模型中没有项目级别的泛型类，希望 Outlook 团队中的人们将来会包括一个。

# crystal-reports - 能否以只读模式启动 Crystal Reports 10，使用户无法创建或更改报表？

> ID：615330
> 
> 赞同：3
> 
> 时间：2009-03-05T15:42:38.297
> 
> 标签：crystal-reports

我在一个环境中，我在 CrystalReports 10 中创建了报表，并且只希望我的用户从外部应用程序查看报表。该应用程序已设置为使用水晶打开报告，但我不希望我的用户能够创建或更改报告。我似乎找不到执行此操作的命令行选项。是否有仅限运行时的 Crystal 版本？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2009-03-31T20:22:51.057

在您的应用程序中嵌入 crviewer 和 craxdrt 组件（随 CR 开发者版本提供，免费分发），以便您无需修改​​即可查看报告。基本操作（缩放、搜索、导出为 pdf、显示/隐藏详细信息或组）仍然可以完成。

如果您必须从命令行启动此查看器，我建议您将其嵌入到办公文档/文件中并通过 VBA 进行管理。例如，您可以启动 Access 的运行时版本（免费分发），该版本将包含一个用于 Crystal Reports 显示的通用表单。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2009-03-05T15:51:51.283

您可以在项目中使用 Crystal Reports 查看器组件。它们随 Crystal Reports Developer 版本一起提供，您几乎可以在所有编程语言中使用它们。在那里，您可以仅在需要时将报告定义为视图。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2009-03-31T05:15:35.497

转到[SAP.com](http://www.sap.com)并搜索“Crystal Reports Viewer”。它可能会也可能不会做你想做的事。

另请查看“Crystal Reports Server”。CRS XI 是一个不错的报告门户，具有许多有用的服务器端功能。安排报告运行和自动发布。生成 PDF 或 Excel 输出。限制特定用户等对报告（或报告组）的访问。但对于您的应用程序，您可以在应用程序中使用 HTTP 访问已发布的结果。这是一个很好的解决方案，例如当您有大量用户查看相同的报告时。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2010-03-26T14:42:34.607

将文件标记为只读怎么样？如果查看器选项对您不开放。

# java - 像 ReSharper 这样的工具，但适用于 Java？

> ID：615334
> 
> 赞同：52
> 
> 时间：2009-03-05T15:43:29.760
> 
> 标签：java, resharper

我在这里阅读了很多关于 ReSharper 的信息。听起来它有很多很酷的功能可以帮助程序员。问题是，我不会写 C#。

是否有任何工具具有与 ReSharper 类似的功能，但适用于 Java？

谢谢！

* * *

## 回答 #1

> 赞同：82
> 
> 时间：2009-03-05T15:46:04.653

使用来自 JetBrains（ReSharper 的创建者）的[IntelliJ IDEA](http://www.jetbrains.com/idea/index.html) IDE。它不是“像 resharper”——它是原始的，而 resharper 就像 C# 中的一样。

* * *

## 回答 #2

> 赞同：22
> 
> 时间：2009-03-05T15:45:22.830

我相信大多数 Java IDE 已经拥有它——我当然将 ReSharper 视为[将 Visual Studio 提升到 Eclipse 级别的工具](http://codeblog.jonskeet.uk/archive/2007/03/27/visual-studio-2005-vs-eclipse-again-but-this-time-with-resharper):)

您有任何特定的 R# 功能吗？

* * *

## 回答 #3

> 赞同：11
> 
> 时间：2009-03-05T15:45:27.180

Resharper 由 JetBrains 开发，是[IntelliJ](http://www.jetbrains.com/idea/index.html)功能到 C#的一个端口

* * *

## 回答 #4

> 赞同：6
> 
> 时间：2009-08-06T12:23:55.887

使用 NetBeans IDE，这个 IDE 具有 ReSharper 的所有功能，最重要的是，它们在 IDE 中是原生的。

* * *

## 回答 #5

> 赞同：5
> 
> 时间：2009-03-05T15:45:14.420

[http://www.jetbrains.com/idea/](http://www.jetbrains.com/idea/)，由 Resharper 的创建者 Jetbrains 制作的 Java IDE。

它不是 IDE 的插件，但它本身就是一个出色的 IDE。您可以在 ReSharper 中找到的大多数功能（如果不是全部）都在 IntelliJ 中。

* * *

## 回答 #6

> 赞同：4
> 
> 时间：2009-03-05T15:45:29.817

ReSharper 是 Visual Studio 工具，而不是语言工具。最接近的等价物是来自创建 ReSharper 的人的[IntelliJ IDEA 。](http://www.jetbrains.com/idea/index.html)

* * *

## 回答 #7

> 赞同：3
> 
> 时间：2009-03-05T15:45:25.120

如果我没记错的话，resharper 只是 Intellj（jetbrains ide）默认为 java 提供的额外功能

# java - javax.net.ssl.SSLHandshakeException：证书过期 - 本地还是远程？

> ID：615344
> 
> 赞同：1
> 
> 时间：2009-03-05T15:44:53.110
> 
> 标签：java, ssl-certificate

我在尝试与 Web 服务建立 SSL 连接时收到以下异常。此错误是否意味着我的本地密钥库/证书已过期，或者我不能信任远程服务器，因为它具有过期的证书？

```
javax.net.ssl.SSLHandshakeException: certificate expired
    at com.ibm.jsse.bs.a(Unknown Source)
    at com.ibm.jsse.bs.startHandshake(Unknown Source)
    at com.ibm.net.ssl.www.protocol.https.b.o(Unknown Source)
    at com.ibm.net.ssl.www.protocol.https.q.connect(Unknown Source)
    at com.ibm.net.ssl.www.protocol.http.cg.getOutputStream(Unknown Source)
    at com.ibm.net.ssl.www.protocol.https.t.getOutputStream(Unknown Source) 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-03-05T15:48:27.360

远程证书过期，webservice 的应用服务器需要更新其证书。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-03-06T10:58:53.337

见这里[http://www.cs.sunysb.edu/documentation/jsse/jssefaq.html#17](http://www.cs.sunysb.edu/documentation/jsse/jssefaq.html#17)

例如，将 SystemProperty javax.net.debug 设置为 ssl：

```
java -Djavax.net.debug=ssl ... 
```

# apache-flex - 是否有工具可以将对象状态捕获到磁盘？

> ID：615353
> 
> 赞同：0
> 
> 时间：2009-03-05T15:46:27.397
> 
> 标签：apache-flex, testing, serialization

我想做的是将内存中的对象捕获到磁盘以进行测试。由于要达到这种状态需要很多步骤，我想捕获一次并跳过这些步骤。

我意识到我可以手动模拟这些对象，但我宁愿“记录”和“重播”真实对象，因为我认为这会更快。

**编辑：问题是关于整个过程，而不仅仅是对象的序列化（还有文件操作），我希望存在一个工具来对标准对象执行此过程。**

我对 Actionscript 感兴趣，专门针对这个应用程序，但是......

*   在其他编程语言中有这样的例子吗？

*   这个过程通常称为什么？

*   这将如何在 Actionscript 中完成？

编辑：

*   是否有使序列化和文件操作自动化的工具（即没有特殊接口）？

*   其他人会发现提议的工具有用吗（如果它不存在）？

**我正在考虑的用例：**

```
ObjectSaver.save(objZombie,"zombie"); //save the object
var zombieClone:Zombie = ObjectSaver.get("zombie"); // get the object 
```

并且磁盘位置可以在某处进行配置。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2009-03-05T15:47:50.497

将对象转换为字节（以便它们可以保存到磁盘或通过网络传输等）称为[序列化](http://en.wikipedia.org/wiki/Serialization)。

但是在您的情况下，我认为序列化对于测试目的没有那么有用。当测试在每次运行测试时创建其所有测试数据时，您始终可以相信测试数据是您所期望的，并且之前的测试运行不会泄漏任何副作用。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2009-03-05T15:58:15.370

几天前我向 Flex 提出了同样的问题。尽管其中一个响应中提到的 JSON 库看起来很有希望，但 ActionScript 对序列化的支持并不多。 [序列化 Flex 对象以保存恢复应用程序状态](https://stackoverflow.com/questions/603890/serialize-flex-objects-to-save-restore-application-state)

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2009-03-05T15:49:22.897

我认为您在谈论“对象序列化”。

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2009-03-05T15:49:38.340

> **这个过程通常称为什么？**

*   序列化/反序列化
*   编组/解组
*   放气/充气

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2009-03-05T15:51:09.647

这叫[序列化](http://en.wikipedia.org/wiki/Serialization)

Perl 使用 Storable 模块来执行此操作，我不确定 Actionscript。

* * *

## 回答 #6

> 赞同：1
> 
> 时间：2009-03-05T16:28:46.063

这曾经被称为“检查点”（尽管这通常意味着保存整个系统的状态）。您是否考虑过将对象序列化为某种中间格式，然后创建一个可以接受该格式的对象并基于该格式重新创建对象的构造函数？这可能是一种更直接的方法。

* * *

## 回答 #7

> 赞同：0
> 
> 时间：2009-05-02T14:09:38.173

如果您使用的是 AIR，则可以将对象存储在包含的本地数据库中。

这是Adob​​e 网站上[使用本地 SQLite 数据库的简单示例，以及](http://www.adobe.com/devnet/air/ajax/quickstart/sync_simple_sql_database.html)[有关数据如何存储在数据库中的更多信息](http://livedocs.adobe.com/flex/3/langref/localDatabaseSQLSupport.html#dataTypes)。

* * *

## 回答 #8

> 赞同：0
> 
> 时间：2009-03-06T22:22:56.343

查看[flash.utils.IExternalizable](http://livedocs.adobe.com/flex/3/langref/flash/utils/IExternalizable.html)接口。它可用于将 ActionScript 对象序列化为 ByteArray。生成的数据可以很容易地写入磁盘或用于克隆对象。

请注意，这不是“自动的”。您必须手动实现接口并为要序列化的每个类编写`readExternal()`和函数。`writeExternal()`您将很难找到一种“自动”序列化自定义类的方法，因为`private`成员只能在类本身内访问。`public`如果要创建外部序列化方法，则需要对需要的所有内容进行序列化。

* * *

## 回答 #9

> 赞同：0
> 
> 时间：2009-04-27T23:11:01.503

我最接近的方法是使用[appcorelib](http://code.google.com/p/appcorelib/) ClassUtil 从现有对象创建 XML 对象（手动保存 xml）并从此 xml 创建对象。对于具有自定义类型数组的对象，需要按照文档中的说明正确配置 ArrayElementType 元数据标记和编译器选项。

```
ClassUtil.createXMLfromObject(obj);
CreateClassFromXMLObject(obj,targetClass); 
```

# .net - 支持 .NET Framework 3.5 SP1 客户端配置文件？

> ID：615354
> 
> 赞同：2
> 
> 时间：2009-03-05T15:46:58.863
> 
> 标签：.net, .net-3.5, .net-client-profile

面向 .NET Framework 3.5 SP1 客户端配置文件时是否需要考虑任何设计注意事项？我知道它是完整框架的一个子集，但是缺少什么以及我如何知道我的应用程序是否需要客户端配置文件或完整框架？有没有人使用客户端配置文件成功开发了一个可以分享他们对它的想法的应用程序？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-03-05T16:10:59.803

客户端配置文件主要是缺少服务器端的东西，即 ASP.NET 等。您可以只为客户端配置文件开发并让编译器处理其余部分（如果您使用客户端配置文件中不可用的内容，您将收到警告）。如果您对此无能为力，只需单击复选框即可切换到完整框架。

* * *

## 回答 #2

> 赞同：-3
> 
> 时间：2009-03-05T15:54:56.097

如果您考虑使用 LINQ 和 ADO.NET Entity Framework 或新的 System.Addin 命名空间，则只需要[.NET Framwork 3.5功能。](http://en.wikipedia.org/wiki/.net_framework)

![.NET 框架堆栈](https://upload.wikimedia.org/wikipedia/commons/thumb/d/d3/DotNet.svg/521px-DotNet.svg.png)

在 Visual Studio 2008 中创建新项目时，您可以选择目标框架。这将自动显示或隐藏对所选版本不可用的命名空间。

# c++ - 是否有任何理由在删除之前检查 NULL 指针？

> ID：615355
> 
> 赞同：52
> 
> 时间：2009-03-05T15:47:00.577
> 
> 标签：c++, pointers, null, delete-operator

我经常看到在删除指针之前检查遗留代码`NULL`，类似于，

```
if (NULL != pSomeObject) 
{
    delete pSomeObject;
    pSomeObject = NULL;
} 
```

是否有任何理由`NULL`在删除指针之前检查它？之后设置指针的原因是什么`NULL`？

* * *

## 回答 #1

> 赞同：73
> 
> 时间：2009-03-05T15:50:03.083

删除空指针是完全“安全”的；它实际上相当于无操作。

您可能希望在删除之前检查 null 的原因是尝试删除空指针可能表明您的程序中存在错误。

*编辑*

**注意**：如果你重载删除操作符，它可能不再是“安全的”`delete NULL`

* * *

## 回答 #2

> 赞同：40
> 
> 时间：2009-03-05T15:59:28.677

C++ 标准保证在*删除表达式*中使用空指针是合法的（第 8.5.2.5/2 节）。但是，*未指定*这是否会调用释放函数（`operator delete`或`operator delete[]`；§8.5.2.5/7，注意）。

如果使用空指针调用默认释放函数（即由标准库提供），则调用无效（第 6.6.4.4.2/3 节）。

但是如果标准库没有提供释放函数会发生什么，即当我们重载`operator delete`（或`operator delete[]`）时会发生什么，并没有明确说明。

一个称职的程序员会在释放函数中相应地处理空指针*，*而不是在调用之前，如 OP 的代码所示。同样，在删除之后将指针设置为`nullptr`/`NULL`仅用于非常有限的目的。有些人喜欢本着[防御性编程的精神这样做](https://en.wikipedia.org/wiki/Defensive_programming)：在出现错误的情况下，它会使程序行为更加可预测：删除后访问指针将导致空指针访问，而不是对随机内存位置的访问。尽管这两个操作都是未定义的行为，但在实践中，空指针访问的行为更容易预测（它通常会导致直接崩溃而不是内存损坏）。由于内存损坏特别难以调试，因此重置已删除的指针有助于调试。

— 当然，这是治疗症状而不是治疗原因（即错误）。**您应该将重置指针视为代码异味。**干净、现代的 C++ 代码将明确内存所有权并进行静态检查（通过使用智能指针或等效机制），因此可以证明可以避免这种情况。

### 奖励：重载的解释`operator delete`：

`operator delete`是（尽管它的名字）一个可以像任何其他函数一样被重载的函数。`operator delete`每次使用匹配的参数调用时，都会在内部调用此函数。对于`operator new`.

当您想要精确控制内存的分配方式时，重载`operator new`（然后也是`operator delete`）在某些情况下是有意义的。这样做甚至不是很困难，但必须采取一些预防措施以确保正确的行为。Scott Meyers 非常详细地描述了这一点*Effective C++*。

现在，假设我们要重载全局版本的`operator new`调试。在我们这样做之前，关于以下代码中发生的事情的简短通知：

```
klass* pobj = new klass;
// … use pobj.
delete pobj; 
```

这里实际发生了什么？那么上面可以大致翻译成下面的代码：

```
// 1st step: allocate memory
klass* pobj = static_cast<klass*>(operator new(sizeof(klass)));
// 2nd step: construct object in that memory, using placement new:
new (pobj) klass();

// … use pobj.

// 3rd step: call destructor on pobj:
pobj->~klass();
// 4th step: free memory
operator delete(pobj); 
```

注意第 2 步，我们`new`用稍微奇怪的语法调用。这是对所谓*放置`new`*的调用，它接受一个地址并在该地址构造一个对象。该运算符也可以重载。在这种情况下，它只是用于调用类的构造函数`klass`。

现在，事不宜迟，这里是运算符重载版本的代码：

```
void* operator new(size_t size) {
    // See Effective C++, Item 8 for an explanation.
    if (size == 0)
        size = 1;

    cerr << "Allocating " << size << " bytes of memory:";

    while (true) {
        void* ret = custom_malloc(size);

        if (ret != 0) {
            cerr << " @ " << ret << endl;
            return ret;
        }

        // Retrieve and call new handler, if available.
        new_handler handler = set_new_handler(0);
        set_new_handler(handler);

        if (handler == 0)
            throw bad_alloc();
        else
            (*handler)();
    }
}

void operator delete(void* p) {
    cerr << "Freeing pointer @ " << p << "." << endl;
    custom_free(p);
} 
```

与大多数实现一样，此代码仅在内部使用`malloc`/的自定义`free`实现。它还创建一个调试输出。考虑以下代码：

```
int main() {
    int* pi = new int(42);
    cout << *pi << endl;
    delete pi;
} 
```

它产生了以下输出：

```
Allocating 4 bytes of memory: @ 0x100160
42
Freeing pointer @ 0x100160. 
```

现在，这段代码做了一些与标准实现完全不同的事情`operator delete`：**它没有测试空指针！**编译器不会对此进行检查，因此上面的代码可以编译，但是当您尝试删除空指针时，它可能会在运行时产生令人讨厌的错误。

然而，正如我之前所说，这种行为实际上是出乎意料的，库编写者**应该**注意检查`operator delete`. 这个版本改进了很多：

```
void operator delete(void* p) {
    if (p == 0) return;
    cerr << "Freeing pointer @ " << p << "." << endl;
    free(p);
} 
```

总之，虽然一个草率的实现`operator delete`可能需要在客户端代码中进行显式的空检查，但这是非标准行为，只能在遗留支持中被容忍（*如果有的话*）。

* * *

## 回答 #3

> 赞同：9
> 
> 时间：2009-03-05T15:50:15.593

删除 null 是无操作的。在调用 delete 之前没有理由检查 null。

如果指针为 null 包含您关心的一些附加信息，您可能需要检查 null 是否有其他原因。

* * *

## 回答 #4

> 赞同：9
> 
> 时间：2009-03-05T15:59:31.873

删除内部检查 NULL。你的测试是多余的

* * *

## 回答 #5

> 赞同：4
> 
> 时间：2012-04-21T14:20:26.203

根据 C++03 5.3.5/2，删除空指针是安全的。以下内容来自标准：

> 在任一替代方案中，如果 delete 的操作数的值是空指针，则该操作无效。

* * *

## 回答 #6

> 赞同：3
> 
> 时间：2009-03-05T15:51:22.830

如果 pSomeObject 为 NULL，则 delete 不会做任何事情。所以不，您不必检查 NULL。

如果某些笨蛋有可能尝试使用指针，我们认为在删除指针后将其分配为 NULL 是一种很好的做法。使用 NULL 指针比使用指向谁知道什么的指针稍微好一些（NULL 指针会导致崩溃，指向已删除内存的指针可能不会）

* * *

## 回答 #7

> 赞同：1
> 
> 时间：2009-03-05T15:58:52.500

没有理由在删除之前检查 NULL。如果在代码中的某处通过执行 NULL 检查是否已经分配了某个对象，则可能需要在删除后分配 NULL。一个示例是按需分配的某种缓存数据。每当您清除缓存对象时，您将 NULL 分配给指针，以便分配对象的代码知道它需要执行分配。

* * *

## 回答 #8

> 赞同：0
> 
> 时间：2009-03-05T20:46:17.347

我相信以前的开发人员对其进行了“冗余”编码以节省一些毫秒：在删除对象时将指针设置为 NULL 是一件好事，因此您可以在删除对象后立即使用如下行：

```
if(pSomeObject1!=NULL) pSomeObject1=NULL; 
```

但是无论如何 delete 都会进行精确的比较（如果它为 NULL，则什么也不做）。为什么要这样做两次？在调用 delete 之后，您始终可以将 pSomeObject 分配给 NULL，而不管它的当前值是什么 - 但如果它已经具有该值，这将有点多余。

所以我敢打赌，这些行的作者试图确保 pSomeObject1 在被删除后始终为 NULL，而不会产生可能不必要的测试和分配的成本。

* * *

## 回答 #9

> 赞同：-2
> 
> 时间：2009-03-05T16:04:03.627

这取决于你在做什么。例如，一些较旧的实现如果传递了一个指针`free`，就不会高兴。`NULL`一些图书馆仍然有这个问题。例如，`XFree`在 Xlib 库中说：

> 描述
> 
> XFree 函数是释放指定数据的通用 Xlib 例程。您必须使用它来释放由 Xlib 分配的任何对象，除非为该对象明确指定了备用函数。不能将 NULL 指针传递给此函数。

所以考虑释放`NULL`指针作为一个错误，你会很安全。

* * *

## 回答 #10

> 赞同：-5
> 
> 时间：2009-08-07T01:21:06.747

至于我的观察，使用 delete 删除空指针在基于 unix 的机器（如 PARISC 和 itanium）中是安全的。但是对于 Linux 系统来说是非常不安全的，因为这个过程会崩溃。

# iphone - 无需使用两根手指即可在 iPhone 上滚动 div？

> ID：615357
> 
> 赞同：3
> 
> 时间：2009-03-05T15:48:00.513
> 
> 标签：iphone, uiwebview, webview

我在我的 iPhone 应用程序中嵌入了一个 UIWebView，我想始终在页面上保留一个锁定的页眉和页脚 DIV，并带有一个可滚动的中心 DIV。

我知道我可以使用作为 UIView 控件的页眉/页脚来做到这一点，但我希望页眉和页脚是 HTML div，因为纯 HTML/JS/CSS 解决方案将更容易移植到 Android/PalmPre/AdobeAir，这将很快出现在我的待办事项清单上。

我可以使用这里提到的技术来做到这一点：

[http://defunc.com/blog/?p=94](http://defunc.com/blog/?p=94)

但这需要用户使用 2 根手指来滚动 div，这对我来说并不令人满意......

关于如何做到这一点的任何建议？

谢谢，

布拉德

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2009-03-24T17:19:18.557

我发现有人为此实现了可重用的解决方案，带有页眉和页脚：

[http://cubiq.org/iscroll-4](http://cubiq.org/iscroll-4)

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2009-03-05T16:25:59.550

我对 UIWebView 不太熟悉，所以这可能是一个完全愚蠢的建议。但是有什么阻止你在页面上拥有三个 UIWebView 吗？一个用于页眉，一个用于正文，一个用于页脚。因为打破它听起来是正确的想法。

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2009-05-10T03:03:53.017

这是你要找的吗？[在您的 iPhone 设备或模拟器上打开此链接](http://doctyper.com/stuff/iphone/fixed/)。

index.html 文件在 body 正下方有“header”、“container”和“footer”三个 div 元素，而所有工作都在 fixed.js 文件中完成。通过取消“touchmove”事件的正常操作，将文档固定到位：

```
 // Disable flick events
    disableScrollOnBody : function() {
        document.body.addEventListener("touchmove", function(e) {
            e.preventDefault();
        }, false);
    }, 
```

然后，为附加到“container”下的“content”div 的“touchstart”、“touchmove”和“touchend”事件创建事件侦听器需要做很多工作。逻辑归结为简单地上下移动“内容”div。

这个解决方案是 100% HTML/CSS/JavaScript，但是有一些 WebKit 专有的 CSS 和 JavaScript 可能会限制可移植性。在另一台移动设备上工作可能需要一些调整，但这将是一个很好的概念验证开始。

我没有创建这个很棒的示例项目，我只是将它引起社区的注意。有关更多信息和压缩项目的链接，请阅读 Richard "Doctyper" Herrara 关于[移动 Safari 中的固定定位](http://doctyper.com/archives/200808/fixed-positioning-on-mobile-safari/)的整篇文章。

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2009-03-05T15:58:59.690

可能很笨重，但您可以在用户滚动时将页眉和页脚重新定位到 div 的顶部。这样你的主 div 不需要是可滚动的。但是，使用框架对任何事情（仍然）没有帮助。

这是 iPhone/touch 中比较恼人的浏览器问题之一，我希望您可以像普通浏览器一样只关注页面的一部分。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2009-03-17T18:00:35.583

对于仅 CSS 参考，[Safari CSS 参考](http://developer.apple.com/documentation/appleapplications/Reference/SafariCSSRef/Articles/StandardCSSProperties.html#//apple_ref/doc/uid/TP30001266-UserInterface)可能有您正在寻找的内容。您将对以“-webkit”或“-khtml”开头的任何内容特别感兴趣，因为这些是仅可用于 WebKit 的扩展属性，例如 3D 和触摸。也应该适用于Android。

对于 JavaScript [，WebKit DOM 编程主题简介](http://developer.apple.com/documentation/AppleApplications/Conceptual/SafariJSProgTopics/WebKitJavaScript.html#//apple_ref/doc/uid/30001232)和[WebKit DOM API 参考](http://developer.apple.com/documentation/AppleApplications/Reference/WebKitDOMRef/index.html#//apple_ref/doc/uid/TP40006089)是首选指南。一定要看看[light-table 演示](http://tlrobinson.net/iphone/lighttable/)，了解一些复制和粘贴 javascript 来处理你的触摸，因为这就是我解决这个问题的方法。

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2010-06-30T14:04:26.120

我已经在 iphone 上实现了 iScroll，它非常流畅和快速，你可以做任何你想做的事情。缺点是android（1.6）拒绝滚动我想要的方式，有时会阻止其他javascript（如果有的话）。

* * *

## 回答 #7

> 赞同：0
> 
> 时间：2014-03-11T10:18:21.330

```
<meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=0, minimum-scale=1.0, maximum-scale=1.0">
<div style="overflow: scroll"> 
```

将这些添加到您的 html 代码中可能会解决您的问题。

# sharepoint - 从站点创建 Sharepoint 解决方案（包括工作流和自定义 Web 部件）

> ID：615361
> 
> 赞同：2
> 
> 时间：2009-03-05T15:48:46.610
> 
> 标签：sharepoint, templates, solution

这是场景

我创建了一个站点，其中使用了自定义列表、webpart、自定义开发的 webpart、工作流等。您可以将站点视为应用程序。

我要做的是创建一个解决方案包，其中包含我在该站点中构建的所有内容，以便我可以将解决方案文件提供给可以将解决方案安装到他的共享点环境的共享点管理员。

例如，查看可以从 MSDN 下载的免费应用程序模板，我正在努力实现与他们相同的目标。一个解决方案文件可以容纳所有这些！

有任何想法吗？

干杯!

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-03-05T20:36:46.560

获取[STSDev](http://www.codeplex.com/stsdev)和[SharePoint 管理器](http://www.codeplex.com/spm)。STSDev 是用于创建您想要的解决方案的 goog，SharePoint Manager 可用于从您已经创建的自定义项中获取 SchemaXML。

您将需要打包 webpart 和所有内容。不幸的是，这是一个相当长的学习曲线，所以希望对这个主题做大量的阅读和一些实验。但是，这是一个很好的时间，因为解决方案是发布自定义站点定义的“唯一”方式。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-03-05T16:42:26.107

将站点导出为模板并包含所有内容。我相信，工作流程将指向旧站点，并且需要手动更新。其他一切都应该工作。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-03-05T19:25:20.850

使用 SPD 创建的工作流**不能**跨站点移植 - 它们必须重新创建。因此，内森的解决方案可能是唯一的出路。

# objective-c - UICachedDeviceWhiteColor 和 NSAutoRelease 用于表单元格内存泄漏

> ID：615364
> 
> 赞同：0
> 
> 时间：2009-03-05T15:49:29.590
> 
> 标签：objective-c, iphone, cocoa-touch, uitableview

我有一个显示 UICachedDeviceWhiteColor 的内存泄漏。我没有在任何地方使用 UICachedDeviceWhiteColor 并且搜索它会发现人们说这是 iPhone-SDK 中的错误。我发现了这个博客条目： http: [//piezoelectrics.blogspot.com/2009/02/uicacheddevicewhitecolor-leak-in-iphone.html](http://piezoelectrics.blogspot.com/2009/02/uicacheddevicewhitecolor-leak-in-iphone.html)

但我找不到

```
#import "NSAutoreleasePool.h" 
```

我收到“错误：NSAutoReleasePool.h：没有这样的文件或目录”。是否有解决此内存泄漏的方法或从 nib 分配表格单元的正确方法？

这是我目前的做法：

```
 - (UITableViewCell *)tableView:(UITableView *)tableView cellForRowAtIndexPath:(NSIndexPath *)indexPath {   

UITableViewCell *cell = nil;    
cell = [tableView dequeueReusableCellWithIdentifier:@"CellNameIdentifier"];

if (cell == nil) {
[[NSBundle mainBundle] loadNibNamed:@"CellName" owner:self options:nil];
//cellName is IBOutlet to XIB's tablecell.  I reference it several times in this calss
cell = cellName; 
}

return cell; 
```

}

我在这里看不到分配器，为什么会有内存泄漏？这可能是一个问题：

```
@property (nonatomic, retain) IBOutlet UITableViewCell *cellName; 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-03-05T21:05:44.383

实际上，如果您将 NIB 用于您的表格视图单元格（除非您正在做一些真正自定义的事情，否则通常不需要）您将不得不在每次您没有在可重用的表格视图单元格上受到打击时加载它。我认为下面的代码看起来更干净一些：

```
UITableViewCell *cell = [tableView dequeueReusableCellWithIdentifier:@"MyID"];
if (cell == nil) {
    NSArray *nib = [[NSBundle mainBundle] loadNibNamed:@"CellName"
                    owner:self options:nil];
    cell = [nib objectAtIndex:1];
} 
```

如果单元格是 NIB 中的第一个对象（零对象是文件所有者），则 objectAtIndex:1 技巧有效。

做表格视图单元格的一些注意事项：

*   不要通过分配给属性或手动来隐式保留您的单元格对象。这将使可重用表格单元格功能无法正常工作，因为它无法释放单元格内存。
*   不要忘记在界面构建器中设置单元重用标识符，因为如果您使用的是 NIB，则无法在代码中执行此操作。
*   始终确保单元是自动释放的。要么手动完成，要么确保您使用的是返回自动释放内存的可可函数（如 objectAtIndex: 方法所做的那样）。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-03-05T16:23:18.713

由于您的属性声明，您的 cellName 属性的合成设置器将保留传递给它的对象。

您应该在您的 dealloc 方法中向 cellName 发送一条释放消息。

此外，每次请求 cellView 时都无需加载 nib。要么检查 cellName != nil 并返回它，要么在 cellView 上设置重用标识符，以便 dequeueReusableCellWithIdentifier 可以找到它。

# c# - 查找严格以 $ 开头的单词，Regex C#

> ID：615375
> 
> 赞同：2
> 
> 时间：2009-03-05T15:51:07.837
> 
> 标签：c#, regex, word, word-boundary

我需要找到严格以“$”开头且仅包含数字的单词的所有匹配项。所以我写了

```
[$]\d+ 
```

这给了我 4 场比赛

```
$10 $10 $20a a$20 
```

所以我想到了使用 \b 来使用单词边界：

```
[$]\d+\b 
```

但它再次匹配

给我20美元。

我试过

```
\b[$]\d+\b 
```

但我失败了。

我正在寻找说，仅当单词以 $ 开头并且后跟 DIGITS 时才接受。我如何告诉它以 $ 开头，因为我认为 \b 使它假定单词边界，这意味着包围在字母数字字符内。

解决办法是什么？

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2009-03-05T16:00:32.793

不是最好的解决方案，但这应该可行。（它与您的测试用例有关）

```
(?<=\s+|^)\$\d+\b 
```

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2009-03-05T16:02:01.073

你有没有尝试过

> \B\$\d+\b

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2010-05-13T20:26:03.567

你很接近，你只需要逃避$：

```
\B\$\d+\b 
```

在此处查看示例匹配：[http ://regexhero.net/tester/?id=79d0ac3b-dd2c-4872-abb4-6a9780c91fc1](http://regexhero.net/tester/?id=79d0ac3b-dd2c-4872-abb4-6a9780c91fc1)

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2009-03-05T16:09:55.920

试试 ^\$\d+

其中 ^ 表示字符串的开头。

# .net - DataView构造函数的谓词？

> ID：615377
> 
> 赞同：0
> 
> 时间：2009-03-05T15:51:21.503
> 
> 标签：.net, datatable, predicate, dataview

我知道这听起来可能很疯狂，但我发誓在两个不同的场合通过智能感知我已经看到 DataView 构造函数的重载，它接受了 DataTable 和 Predicate 或 Func，我不记得 T 是什么，无论是 DataRow 还是数据行视图。但是现在我找不到了。它还接受了另一个参数，我想说这是一个比较，但我不太关心这个事实。问题是，我再也找不到那个过载了。

查看定义，我看到 DataView 只有 3 个构造函数。我特别记得这个“消失的构造函数”在智能意义上说“4 of 4”。

有人可以帮我解开这个谜吗？请告诉我，我没有妄想，实际上确实看到了这个构造函数（或类似的东西）。也许它实际上不是构造函数而是扩展方法？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-03-05T15:55:07.750

有五个构造函数，但其​​中两个（包括一个接受谓词和一个比较）在`System.Data`程序集内部。我不知道为什么 Intellisense 会向您显示...

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-03-05T15:53:55.210

抱歉 - 不幸的是只有 3 个**公共**构造函数：

[http://msdn.microsoft.com/en-us/library/system.data.dataview.dataview.aspx](http://msdn.microsoft.com/en-us/library/system.data.dataview.dataview.aspx)

# javascript - jQuery - 查找下一个具有特定子元素的元素

> ID：615383
> 
> 赞同：5
> 
> 时间：2009-03-05T15:53:05.197
> 
> 标签：javascript, jquery

可以说我有这样的事情：

```
<tr>
<td><input type="text" /></td>
<td>Somevalue</td>
<td><intput type="text /></td>
</tr> 
```

我在第一个文本框中的按键事件处理程序中。如果使用 jQuery 存在，我想找到下一个包含文本框的 td。

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2009-03-05T16:11:36.337

像这样的东西应该可以工作（假设`this`是输入）。

```
var next = $(this).parent().next("td > input[type='text']"); 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2017-03-20T19:14:13.970

tj111 的回答对我不起作用。可能是因为 jQuery 的更新版本。我想出了这个：

```
var next = $(this).parent().nextAll().has("input[type='text']").first(); 
```

* * *

## 回答 #3

> 赞同：-1
> 
> 时间：2012-01-15T05:22:40.127

我不知道您的选择器是什么，但如果您需要选择所有输入（输入文本）。你可以试试这个。

```
$(function(){ 

    $(':input').each(function(){
        $(this).keypress(function(){
          $(this).next('input[type=text]').val('I\'m the next');
     }) // end of keypress
    }) // enf of each
}) // End of function 
```

所以，不管你把更多的投入放在哪里，你总是可以把它们拿走。

# iis - IIS7 Response.WriteBuffer 不工作

> ID：615388
> 
> 赞同：0
> 
> 时间：2009-03-05T15:55:07.143
> 
> 标签：iis, iis-7, crystal-reports, asp.net-1.1

我们有一个 ASP.NET 1.1 应用程序，它使用 Crystal Reports 输出一个 Excel 电子表格。这些代码在 IIS6 下工作，但是当我们尝试将其迁移到 IIS7 时，它会吐出没有内容的 html 而不是 Excel 文件。

MIME 类型存在。下面是我们正在使用的代码。我没有编写此代码，因为我现在主要在 3.5 框架中工作。我的假设是我在 IIS7 配置中遗漏了一些东西，而不是代码，因为它适用于 IIS6。ASP.NET 1.1 应用程序的其余部分在 IIS7 上运行。

```
 Dim cr As ReportClass
        'EXPORT the report based on the export type passed in.
        Dim ExpOptions As New ExportOptions
        Dim ContentType As String
        Dim strExt As String
        Trace.Write("DisplayReport reportname=" + ReportName + " SQL=" + SQL + " SQLSub1=" + Convert.ToString(Session("SQLSub1")))
        'Get the report filled with the data.
        If Session("SQLSub1") <> "" Then
            If Not Session("SubRptName") Is Nothing Then
                cr = PopulateReport(GetReportObject(ReportName), SQL, Session("SQLSub1"), Session("SubRptName"))
                Session("SQLSub1") = ""
                Session("SubRptName") = Nothing
            Else
                cr = PopulateReport(GetReportObject(ReportName), SQL, Session("SQLSub1"))
                Session("SQLSub1") = ""
            End If
        Else
            cr = PopulateReport(GetReportObject(ReportName), SQL)
        End If

        If DisplayType = ReportType.Excel Then
            If ReportName.ToUpper = "ACTION" Or ReportName.ToUpper = "INVENTORY_EXCEL" _
                Or ReportName.ToUpper = "UNDERPERFORM" Or ReportName.ToUpper = "EMPLOYEE_EXCEL" Then
                Dim excelFormatOpts As New ExcelFormatOptions
                ' Set the excel format options.
                excelFormatOpts.ExcelTabHasColumnHeadings = True
                excelFormatOpts.ExcelUseConstantColumnWidth = False
                ExpOptions.FormatOptions = excelFormatOpts
            Else
                ExpOptions.FormatOptions = New ExcelFormatOptions
            End If
            ExpOptions.ExportFormatType = ExportFormatType.Excel
            ContentType = "application/vnd.ms-excel"
            strExt = ".xls"
        ElseIf DisplayType = ReportType.PDF Then
            ExpOptions.ExportFormatType = ExportFormatType.PortableDocFormat
            ExpOptions.FormatOptions = New PdfRtfWordFormatOptions
            ContentType = "application/pdf"
            strExt = ".pdf"
        End If

        'Stream the report to the screen
        Dim req As New ExportRequestContext
        req.ExportInfo = ExpOptions

        Dim s As Stream
        Try
            s = cr.FormatEngine.ExportToStream(req)
        Catch ex As Exception
            Trace.Warn("DisplayReport cr.FormatEngine.ExportToStream(req) failed: " + ex.Message)
            Dim x As String = String.Empty
        End Try

        Response.Clear()
        'Response.ClearHeaders()
        'Response.ClearContent()
        Response.Buffer = True
        Response.ContentType = ContentType
        Response.AddHeader("Content-Type", ContentType)

        Dim buffer(s.Length) As Byte
        s.Read(buffer, 0, Int(s.Length))
        Response.BinaryWrite(buffer)

        Dim strContentDisposition As String = "inline;filename=" & ReportName.ToString.ToLower & strExt.ToString
        Trace.Write("DisplayReport strContentDisposition=" + strContentDisposition)
        Response.AddHeader("Content-Disposition", strContentDisposition)
        Response.Cache.SetMaxAge(New TimeSpan(0, 0, 10))
        Response.End() 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2009-03-06T15:49:45.633

在工作中问了一些开发人员，这是我到目前为止得到的：

“以前从未见过，我什至从未在水晶中使用导出到流选项。但是，如果我猜测，我会将服务器权限视为可能的错误。我见过用户必须这样做的情况拥有访问流的特权。”

# iis - Intelligencia.UrlRewriter 可以在 IIS7 中工作吗？

> ID：615391
> 
> 赞同：15
> 
> 时间：2009-03-05T15:56:01.307
> 
> 标签：iis, iis-7, url-rewriting

我们继承了一个使用 Intelligencia.UrlRewriter 模块的应用程序。我们的环境虽然是 IIS7。我们已经将我们的站点设置为在经典的 asp.net 应用程序池中运行（这显然适用于很多此类问题）。但是，我们仍然没有看到我们应用程序中的 URL 被重写。

有没有人遇到过这个？

* * *

## 回答 #1

> 赞同：21
> 
> 时间：2009-03-05T16:21:38.093

您需要在 system.webServer 元素上定义配置，例如：

```
 <system.webServer>
         <validation validateIntegratedModeConfiguration="false" />
        <modules runAllManagedModulesForAllRequests="true">
  <add name="UrlRewriter" 
   type="Intelligencia.UrlRewriter.RewriterHttpModule, Intelligencia.UrlRewriter" />
        </modules>
    </system.webServer> 
```

您可以保留两个配置。您现在可能拥有的是：

```
<httpModules>
      <add name="UrlRewriter" type="Intelligencia.UrlRewriter.RewriterHttpModule, Intelligencia.UrlRewriter" />
        </httpModules> 
```

检查[http://learn.iis.net/page.aspx/243/aspnet-integration-with-iis7/上的“将 ASP.NET 应用程序迁移到 IIS 7.0 集成模块”部分](http://learn.iis.net/page.aspx/243/aspnet-integration-with-iis7/)

附言。只要该配置存在，我就一直在毫无问题地使用它。

**更新 1：**同时检查[http://weblogs.asp.net/scottgu/archive/2007/02/26/tip-trick-url-rewriting-with-asp-net.aspx](http://weblogs.asp.net/scottgu/archive/2007/02/26/tip-trick-url-rewriting-with-asp-net.aspx)，特别是“方法 3：使用 HttpModule使用 IIS7 执行无扩展名 URL 重写”，因为我添加的配置具有无扩展名配置。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-03-05T16:05:53.183

Yes I had the exact same problem with Intelligencia.UrlRewriter module, running under Win Vista & IIS7, however switching to the classic asp.net app pool did fix the problem. Are you running the app in a new virtual directory? That can sometimes mess with the root path to the application which could make a difference to the rules in the web.config

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2009-12-17T09:29:51.660

我发现了同样的问题，经过几次尝试后，我发现将 asp 模式更改为集成管道会有所帮助。

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2011-03-13T21:41:47.820

如果您使用的是 IIS7，请不要忘记在 web.config 文件的 system.webServer 部分添加以下行

```
<system.webServer>
<modules runAllManagedModulesForAllRequests=”true”&gt;
<add name=”UrlRewriter” type=”Intelligencia.UrlRewriter.RewriterHttpModule” />
</modules>
<validation validateIntegratedModeConfiguration=”false” />
</system.webServer> 
```

如在

[http://frozengraphics.wordpress.com/2009/12/06/intelligencia-urlrewriter-and-iis7/](http://frozengraphics.wordpress.com/2009/12/06/intelligencia-urlrewriter-and-iis7/)

# c# - 如何保证 NotifyIcon 消失？

> ID：615392
> 
> 赞同：7
> 
> 时间：2009-03-05T15:56:12.240
> 
> 标签：c#, .net, winforms, dispose, notifyicon

我在我的一个子（模态）表单中使用 NotifyIcon 控件，它工作正常。按预期显示气球提示，处理鼠标事件等......但是，当我期望它消失时，它并没有消失。具体来说，当我退出子表单并且父表单重新控制时，图标仍然存在。它的工具提示是可访问的，因此它非常“活跃”。

然后当我退出整个应用程序时，图像仍然存在，直到我将光标悬停在它上面。一旦鼠标它消失。

我怎样才能让它正常运行？好的通常是一个坏词：-0 当创建它的表单消失时，我怎样才能让它消失？

有人能解释一下是什么原因造成的吗，我认为 .net 应该自行清理？

G

**编辑：**如果我以关闭的形式调用 Dispose 方法，这是可行的，但我真的必须这样做吗？G

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2009-03-05T15:58:05.700

这是一个想法，不确定这是否会有所作为，但是当子窗体关闭时，您是否在 NotifyIcon 上调用 Dispose() ？

编辑：刚刚看到您的编辑，是的，我对这有帮助并不感到惊讶，是的，您应该这样做。在幕后，某些东西正在使用一些非托管资源，您需要释放它。通常，您的应用程序中任何实现了您正在使用的 IDisposable 的东西，都请帮自己一个忙并处置它。

* * *

## 回答 #2

> 赞同：5
> 
> 时间：2009-03-05T16:22:09.247

```
Icon.Visible = false 
```

也可以。不管怎样，`Dispose`还是应该调用windows句柄来处理。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2010-11-24T09:06:28.050

[这个问题](https://stackoverflow.com/questions/460059/a-way-to-ensure-that-a-system-tray-icon-is-removed-guaranteed/4264984#4264984)类似。

如果您对清理系统托盘的新程序实例感到满意，而不是试图保证在任何类型的关闭时进行清理，[以下](http://www.computersecurityarticles.info/security/refreshing-the-taskbar-notification-area/)模拟通知托盘清理。它使用了一个 SendMessage 解决方案，该解决方案模拟了用户鼠标悬停清理，不需要实际移动用户的光标。

请注意，在 Windows 7 机器上，名称`Notification Area`应替换为`User Promoted Notification Area`.

# web-services - 将 Web 应用程序转换为 Web 服务

> ID：615395
> 
> 赞同：3
> 
> 时间：2009-03-05T15:56:48.353
> 
> 标签：web-services

一种。我必须考虑哪些事情？湾。我有几个由当前应用程序执行的存储过程。如果我创建等效的方法来执行这些程序，那么风险或挑战会是什么。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-03-05T16:02:52.757

在架构上，将 Web 应用程序转换为 Web 服务时必须考虑的一件事是，对方法和数据的本地访问与远程访问不同。远程访问的设计应使调用更加细化，并一次交换更多信息。

您需要考虑的另一件事是您将使用什么序列化协议。例如，SOAP 与基于 REST 的协议。

另外，请考虑安全性 - Web 应用程序和 Web 服务之间的安全考虑是不同的。

最后，想想其他人将如何知道您的 Web 服务（或者他们是否会知道）。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-03-05T16:05:44.793

一种风险是确保您的代码保持不变。

我的意思是在这种情况下存在明显的代码重复可能性，因此意味着您可能会无意中忘记修改使用存储过程的地方之一（例如，如果您将新变量添加到存储过程调用）。

那么你还必须考虑安全性。例如，公开提供用户列表的 Web 服务调用可能不是一个好主意。您需要计划如何通过/接收身份验证和授权信息。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-03-05T16:13:01.110

如果您创建等价的方法，如斯蒂芬所说的那样管理您的代码库将是一个巨大的挑战。最好将这些方法外推到 Web 应用程序和 Web 服务都将使用的新库中。您的网络应用程序中不应包含任何数据访问代码。

使用 Web 服务，您需要考虑您的客户。谁将访问您的数据以及从何处访问。例如，如果它来自同一网络或机器上的 .net windows 客户端，则 TCP 绑定可能是最好的。或者，如果您需要支持较旧的 .net 框架客户端甚至 Java 客户端，则需要注意您使用的技术。

您还需要在 WCF 或 ASMX 之间进行选择。上一段应该帮助回答。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2009-03-05T22:44:53.210

在我看来，最大的挑战将是你显然很想这样做。我认为你犯了一个错误。

您的 Web 应用程序和您提议的 Web 服务有不同的要求。通过将应用程序“转换”为服务，您将为服务负担应用程序的需求。

这是一个“思想实验”：如果您要从头开始编写服务，而忽略应用程序会怎样。服务和应用程序有多相似？如果他们最终会相似，那么转型将是有意义的。否则，没有那么多。

# .net - how to do location based search

> ID：615403
> 
> 赞同：4
> 
> 时间：2009-03-05T15:58:20.347
> 
> 标签：.net, geolocation

I need to develop a solution that will provide the ability for a user to search based on a city and state. The user should have the ability to request that the search results include not just matches for that city and state, but also include matches in a 25, 50, 100 mile radius. I see that job sites do this type of thing. How is this done and are there vendors that provide open API's for it?

Thanks

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2009-03-05T16:06:02.577

You'll want to start with a database of cities, states and zip codes with their corresponding latitude and longitude. [Here's a link](http://www.boutell.com/zipcodes/) to a site where you can download such a database for free.

Next you'll need an algorithm to find which cities/zip codes are within an X mile radius of the city/zip the person entered. [Here's another link](http://blog.peoplesdns.com/archives/24) that should explain how to do that.

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2009-03-05T16:24:32.483

您正在寻找的似乎是一个 GIS（地理信息系统），其中每条（或部分）信息都与其地理位置相关联。这样的系统允许对那些地理位置执行空间搜索，例如。“给我这个位置 5 英里半径范围内的所有商店，这些商店销售特定产品”（结合空间搜索和传统搜索也是可能的）。

现在，您可以使用一些技术示例：

1.  [PostgreSQL](http://www.postgresql.org/) + [Postgis](http://postgis.refractions.net/)：这种数据库和地理扩展的开源组合足以满足大多数基本用户需求。[你可以从这里开始](http://www.bostongis.com/?content_name=postgis_tut01)
2.  [MySql 空间](http://dev.mysql.com/doc/refman/5.0/en/spatial-extensions.html)
3.  [甲骨文空间](http://www.oracle.com/technology/products/spatial/index.html)
4.  [ArcSde (ESRI)](http://www.esri.com/software/arcgis/arcsde/)

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-03-10T18:53:53.003

您可能想看看[GeoNames](http://www.geonames.org/)。

我为 GeoNames 编写了一个 .NET WCF 客户端，可[在此处](http://www.codeproject.com/KB/WCF/GeoNames-WCFClient.aspx)获得。

# c# - 什么是从“25 10a 36 10b 30”中提取纯数字的好正则表达式

> ID：615421
> 
> 赞同：0
> 
> 时间：2009-03-05T16:03:09.183
> 
> 标签：c#, .net, regex

我需要一个正则表达式，它只会为我返回 25,36,30

> 25 10a 36 10b 30

因为它们是序列中唯一的纯数字。

我试过这个，但它对我不起作用：

```
(^|[ ])\d+|($|[ ]) 
```

有什么建议么？

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2009-03-05T16:17:11.847

全球申请：

```
(?<=^|\s)\d+(?=\s|$) 
```

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2009-03-05T16:06:34.540

您可以使用[单词边界](http://www.regular-expressions.info/wordboundaries.html)选项：

```
\b(\d+)\b 
```

但是某些标点符号将被标记为单词边界，因此这不会提供您想要的。

所以看起来你必须明确地寻找空格：

```
/(^|\s+)(\d+)(\s+|$)/ 
```

提取数字时，请记住获取第二组，因为第一组中只有空格。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-03-05T16:05:09.863

注意到您的多个正则表达式问题，我可能会建议一些教育阅读。[Regular-Expressions.info](http://www.regular-expressions.info/)有一些很棒的教程可以帮助您熟悉 RegEx。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2009-03-05T16:08:00.183

`\d+`是你所需要的全部。如果您使用的是 C#，请注意`Regex`对象上的“匹配”和“匹配”之间的区别。一个找到一个匹配项，另一个找到多个不重叠的匹配项。

[http://msdn.microsoft.com/en-us/library/30wbz966(VS.71).aspx](http://msdn.microsoft.com/en-us/library/30wbz966(VS.71).aspx)

* * *

## 回答 #5

> 赞同：-1
> 
> 时间：2009-03-05T16:06:07.473

您可以使用 \b 作为单词边界。

我猜是这样的：

```
\b\d+\b 
```

* * *

## 回答 #6

> 赞同：-1
> 
> 时间：2009-03-05T16:06:21.017

这个应该做的工作：

```
\b\d+\b 
```

* * *

## 回答 #7

> 赞同：-1
> 
> 时间：2009-03-05T16:06:54.557

如果您只查找整数，请使用`\b\d+\b`.

# grails - 参数值包含“.”的 Grails UrlMappings

> ID：615425
> 
> 赞同：2
> 
> 时间：2009-03-05T16:04:01.130
> 
> 标签：grails, friendly-url, url-mapping

鉴于此 UrlMapping：

```
"/foo/$foobar" {
    controller = "foo"
    action = "foo"
    constraints {
    }
} 
```

结合这个控制器：

```
class FooController {
    def foo = {
        def foobar = params.foobar
        println "foobar=" + foobar
    }
} 
```

并带着这些要求：

*   [http://localhost:8080/app/foo/example.com](http://localhost:8080/app/foo/example.com)给出输出“foobar=example”
*   [http://localhost:8080/app/foo/examplecom](http://localhost:8080/app/foo/examplecom)给出输出“foobar=examplecom”

似乎 Grails 在第一个点（“.”）处削减了“foobar”参数。这是故意的吗？如果我想在我的 URL 映射中使用包含点的参数，是否有解决方法？

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2009-03-05T16:22:48.090

这可以通过设置来解决...

```
grails.mime.file.extensions = false 
```

...在 Config.groovy 中。

似乎 Grails 正试图根据文件名后缀在幕后做一些 MIME 魔术。

**更新：来自**[Grails JIRA](http://jira.codehaus.org/browse/GRAILS-4253)的一些附加信息。

这是 UrlMappingsFilter.java 中的违规代码：

```
 if(WebUtils.areFileExtensionsEnabled()) {
        String format = WebUtils.getFormatFromURI(uri);
        if(format!=null) {
            MimeType[] configuredMimes = MimeType.getConfiguredMimeTypes();
            // only remove the file extension if its one of the configured mimes in Config.groovy                                                                                                           
            for (MimeType configuredMime : configuredMimes) {
                if (configuredMime.getExtension().equals(format)) {
                    request.setAttribute(GrailsApplicationAttributes.CONTENT_FORMAT, format);
                    uri = uri.substring(0, (uri.length() - format.length() - 1));
                    break;
                }
            }
        }
    } 
```

WebUtils.areFileExtensionsEnabled() 返回在 Config.groovy 中配置的“grails.mime.file.extensions”设置的值。

# c# - 如何在 ASP.NET 页面上为 Oracle DB 进行大查询

> ID：615428
> 
> 赞同：1
> 
> 时间：2009-03-05T16:04:23.190
> 
> 标签：c#, asp.net, oracle

我有一个 Oracle DB 和一个包含许多 ListBoxes 和 DropDownLists 的 ASP 页。这些控件使用户输入数据以在下一页上获得过滤结果。

一旦用户点击搜索，就会根据用户的选择生成一个字符串（查询）。结果页面有一个数据网格，它接受这个字符串并使用它从数据库中获取网格的数据。

另外，我想使用一个单独的类和方法来创建字符串。

我的数据网格可以很好地处理我自己键入的查询，但我需要一个类来使用所有用户输入生成该查询。

最好的方法是什么？（我正在使用 ASP.NET 2.0 和 C#）

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-03-05T16:25:38.927

对于如此广泛的问题，您将需要多组信息。

您首先要连接到您的 Oracle 数据库并进行查询（步骤 1）。下一步是在表单上显示结果（第 2 步）。一旦你完成了这项工作，你就可以开始参数化你的查询（第 3 步）。以下是帮助您入门的主题集合。你应该能够从那里把事情拼凑起来。

第 1 步 ::[在 ASP.NET 中连接到 Oracle 数据库](http://www.codeguru.com/csharp/.net/net_asp/tutorials/article.php/c8477)
第 2 步 :: [ASP.NET GridView 数据绑定](http://aspnet.4guysfromrolla.com/articles/110905-1.aspx)
第 3 步 ::[参数化查询](http://www.4guysfromrolla.com/webtech/092601-1.shtml)

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-03-05T17:16:03.687

我们已经做了类似的事情，因为我们有一个巨大的 Criteria 页面，用户可以从大约 400 个数据点中进行选择。然后我们使用所有这些数据将某种查询公式化到数据库中。我们发现将所有 Criteria 数据滚动到可序列化的结构中非常有用，我们使用了可以序列化为 xml 的复杂对象。它使整个系统的测试变得容易了一千倍。它还为我们打开了将保存的搜索添加到系统的大门。

为 Transform-Object-To-Sql 代码使用单独的类。

# css - 包含 IE6 hack 的 CSS 方法

> ID：615448
> 
> 赞同：5
> 
> 时间：2009-03-05T16:08:17.610
> 
> 标签：css, internet-explorer, internet-explorer-6

*   CSS有@import，对吧？
*   IE6 理解`*html selector`hack，对吧？

是否可以像这样组合它们

```
//*html @import url(ie6hacks.css); 
```

或者，可能，

```
//*html { @import url(ie6hacks.css); } 
```

?

好的浏览器必须跳过这个，它仍然可以在 IE6 中工作吗？它看起来如何作为解决方案？我可以清楚地看到它看起来像普通的 CSS 一样丑陋。

* * *

## 回答 #1

> 赞同：12
> 
> 时间：2009-03-05T16:12:11.000

当您可以使用条件注释来仅包含您需要的 CSS 时，为什么还要为这种古怪的 hack 烦恼呢？

```
<!--[if IE 6]>
    <link rel="stylesheet" type="text/css" href="ie-6.0.css" />
<![endif]--> 
```

一些资源：

*   [http://www.quirksmode.org/css/condcom.html](http://www.quirksmode.org/css/condcom.html)
*   [http://virtuelvis.com/archives/2004/02/css-ie-only](http://virtuelvis.com/archives/2004/02/css-ie-only)

如果您真的必须使用@import，您可以利用IE 不遵循@import 规则的规范这一事实。通常它必须是样式表或样式标签中的第一个想法，否则它会被完全忽略。但是，IE6（至少在我测试它时）似乎并不在意。按照这些思路，您可以这样做：

```
<style type="text/css">
.NotARealClass { }

@import url("ie-style.css");
</style> 
```

请注意，除了 FF3（无法加载 ie-style.css）和 IE6（无论如何都会加载它）之外，我还没有在任何东西上测试过这个。你的旅费可能会改变。

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2009-03-05T16:09:30.447

不幸的是，该`*html`hack 不能用于导入其他样式表。

[这是一篇文章](http://www.communitymx.com/content/article.cfm?page=2&cid=C37E0)，解释了 hack 和其他对攻击 IE 特定错误有用的方法。

* * *

## 回答 #3

> 赞同：4
> 
> 时间：2009-03-05T17:33:18.187

> 是否可以像这样组合它们

```
* html @import url(ie6hacks.css); 
```

不，@import 之类的 at 规则不是选择器，因此不能与其他选择器结合使用。

有一些方法可以让 at-rules 像 hack 一样工作，例如：

```
@import url(/* no! */iehacks.css); 
```

将由 IE6/7 加载，但不会由其他浏览器加载。但是，我不建议使用它；这种东西真的很脆弱。这个特定的例子也是无效的 CSS。

正如 Daniel 所说，如果您想要单独的 .css 文件进行黑客攻击，最好的方法是有条件地包含链接标签。“* html”的美妙之处在于您可以将hack-rules放在同一个样式表中，如果只有几个则更易于管理；如果你有一个单独的样式表，它没有任何优势。

IE6 的 IMO “* html” 是目前唯一可以合法使用的 hack。所有盒子模型的东西都与 IE5 一起死了——假设你没有使用 IE6 Quirks Mode，这是你不应该的——而其他浏览器，甚至 IE7，通常都太好了，无法通过简单的 hack 进行攻击；可以针对它们的少数黑客太复杂/脆弱/无效而无法真正使用。

（作为 Simplified Box Model Hack 的发明者，我要对他们说一句衷心的告别。）

# ajax - Create a web Ajax version of excel?

> ID：615449
> 
> 赞同：0
> 
> 时间：2009-03-05T16:08:28.450
> 
> 标签：ajax, spreadsheet

I'm trying to figure out how to create basic functionality of a excel spreadsheet in a web app. Is basic Ajax the best way or is there a good framework for this?

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-03-05T16:11:55.883

[qooxdoo](http://qooxdoo.org/) is one of the best for these kind of applications, in my opinion.

The reason is because it implements its own Widget system (like [Cappuccino](http://cappuccino.org/)), completely using divs and canvas elements, making the development experience much more like a *desktop*.

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-03-05T16:19:30.983

Are you looking to implement saving? Or semi-advanced data retrieval (such as from a database)?

Because I think you can get away with just the Javascript and not have to tap the server too much.

# .net - 我什么时候应该手动处理控件？我如何知道控件是否实现了 IDisposable？

> ID：615466
> 
> 赞同：1
> 
> 时间：2009-03-05T16:12:37.927
> 
> 标签：.net, controls, dispose

在上一个关于删除旧 NotifyIcon 的系统托盘的问题中，有人告诉我我应该处理任何实现 IDisposable 的东西。对我来说听起来像是一个很好的做法，但是作为一个新手，它提出了更多的问题:-)

我如何知道控件是否实现了 IDisposable？

我应该建立一个类来尝试在 formclose 事件中处理我所有表单上的所有内容吗？

像这样的东西？（伪代码）：

```
foreach(control cont in form)  
{  
try{cont.Dispose()}  
catch{}  
} 
```

如果不是，那么我怎么知道我需要手动处理哪些控件，或者我应该在测试期间简单地观察异常行为？

G

**编辑：**所以当我点击我的孩子表单上的大红色“X”时，这不会导致它被丢弃吗？是对的吗？这是什么原因？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-03-05T16:15:57.123

表单拥有的任何控件都会在表单被处置时被处置。换句话说，当调用 Dispose() 时，控件将对它的所有子控件调用 Dispose()。请注意，隐藏表单不会调用 Dispose()，但在大多数情况下，只需创建一个对话框并根据需要处理它就可以了。

设计器生成的表单和控件总是如此。如果您在代码中创建像 NotifyIcon 这样的非可视组件（不设置所有者），则必须手动处置它。但是正确设置所有者通常更容易。

任何实现 IDisposable 的类都应该在其子级上调用 Dispose()，无论是在集合中还是在属性中，除非有充分的理由不这样做（即在某些情况下，调用者可能仍然是对象的所有者 - 但这正是在哪里设置所有权的概念是为了）。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2009-03-05T16:31:31.220

一种选择是在您的程序集上运行 FxCop。其规则之一将验证是否正在对所有实现 IDisposable 的对象调用 Dispose，并在您有违规时警告您。

编辑：为了回答您以后的问题，不会自动调用 Dispose 。你需要自己处理。这是[一篇](http://www.devx.com/dotnet/Article/33167)关于这个主题的文章。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-03-05T16:21:21.620

您可以使用 is 运算符验证对象正在实现 IDisposable：

```
if(object is IDisposable) {
    ((IDisposable)object).Dispose();
} 
```

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2009-12-30T00:36:14.153

如果你点击 X 关闭一个**模态**表单，该表单实际上是隐藏的。您必须手动调用 dispose 来释放资源。
见这里：http: [//msdn.microsoft.com/en-us/library/system.windows.forms.form.dialogresult.aspx](http://msdn.microsoft.com/en-us/library/system.windows.forms.form.dialogresult.aspx)

# c# - Winforms我应该多线程还是使用事件计时器？

> ID：615467
> 
> 赞同：2
> 
> 时间：2009-03-05T16:12:58.143
> 
> 标签：c#, winforms, multithreading, user-interface

我目前有一个线程来侦听来自网络的数据，然后在其上运行规则。然后我想将数据传递给 GUI。我担心在 GUI 中出现死锁。我不知道将互斥锁放在 GUI 端。我也在使用 c# 和 dotnet 3.5。

我想出的是 1) 使用计时器来创建事件并转储线程。担心性能。2) 使用中间事件将数据复制到 GUI。3）挖掘并找出使用GUI的线程安全方式。

你认为最好的方法是什么？

编辑：这是我正在使用的解决方案。我传入更改的元素，然后用互斥锁保护大对象。我使用辅助函数使用 InvokeRequired 然后 BeginInvoke 与委托切换线程。从阅读答案中提取，然后跟随链接，直到到达[Jon Skeet](https://stackoverflow.com/users/22656/jon-skeet)[的 Windows 窗体中](http://www.yoda.arachsys.com/csharp/threads/winforms.shtml)的线程。

```
 delegate void UInt32ParameterDelegate(UInt32 n);

  public void UpdateLocation(UInt32 n)
  {
     if (InvokeRequired)
     {
        // We're not in the UI thread, so we need to call BeginInvoke
        BeginInvoke(new UInt32ParameterDelegate(UpdateLocation), new object[] { n });
        return;
     }
     // Must be on the UI thread if we've got this far

     this.engine.location.UpdateBusy.WaitOne();
     // do the work in here

     this.engine.location.UpdateBusy.ReleaseMutex();

  } 
```

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2009-03-05T16:38:20.033

我希望我能正确理解你的问题。

在后台线程读取数据并执行任何操作后，它应该使用`Invoke`调用 GUI 线程上的方法。该方法将更新应在 GUI 中更新的任何内容。

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2009-03-06T04:04:21.243

Windows 窗体中的同步非常容易。您可以在后台线程中调用 Control.Invoke()。线程将停止，直到委托在 UI 线程上完成运行。根本不需要同步。

如果停止线程是一个问题，请使用 Control.BeginInvoke()。如果线程在继续运行时可能会更改它们，则必须用锁保护传递给委托的对象。在生产者-消费者场景中这种情况很少见，线程可以简单地创建新对象。

请确保您不要过于频繁地调用（）。执行频率超过每秒 1000 次，UI 线程将停止发送 Windows 消息，并因处理调用请求而陷入困境。由于您要取悦的是人眼，因此每秒调用超过 25 次只是浪费精力。池中间结果产生一个集合对象。

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2009-03-05T16:21:14.473

**永远不要**在 GUI 线程上从网络读取。在网络中断期间运行您的应用程序并导致您的 GUI 挂起只是时间问题。这真的会让你的用户感到沮丧。

在您的情况下，我认为最好的方法是让后台线程完成读取操作。[然后获取结果数据并通过SynchronizationContext](http://msdn.microsoft.com/en-us/library/system.threading.synchronizationcontext.aspx) Post 或 Send 方法 将其移回 GUI 线程。

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2009-03-05T17:34:06.780

您应该将一个事件从您的网络线程传递到您的 UI 线程。

然后使用 begininvoke 跨线程，这样就不会出现跨线程异常。

[需要帮助在 C# 中跨 UI 线程和另一个线程获取信息](https://stackoverflow.com/questions/229254/need-help-getting-info-across-a-ui-thread-and-another-thread-in-c/229292#229292)

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2009-03-05T17:40:51.740

您可以使用将在[后台](http://msdn.microsoft.com/en-us/library/system.componentmodel.backgroundworker.aspx)线程中处理数据读取的后台工作人员，完成后您可以结束后台工作人员触发它的 RunWorkerCompletedEventHandler。在 RunWorkerCompletedEventHandler 中，您可以使用结果更新您的 GUI 线程。

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2009-03-05T16:16:59.600

仅仅抛出一个引发通知表单刷新的事件的委托不是更容易吗？

# fonts - Corrupt TrueType Font Detection

> ID：615479
> 
> 赞同：6
> 
> 时间：2009-03-05T16:14:55.783
> 
> 标签：fonts, truetype

I am at present dealing with a corrupt TrueType font. Programs available to me tell me there is a problem with the [`maxp`](http://developer.apple.com/textfonts/ttrefman/rm06/Chap6maxp.html) table -- the `maxContours` member has a value that is too large. Is there a sure-fire way to detect when a `maxContours` value is too high or too low (yes that too can be a problem)? (Fonts are programs so one way to detect a font file is good is to execute them, but this is not an acceptable solution for me.)

I don't need a font library because I can't add one. I have already rolled my own TrueType font parser. What remains is to check if a given value of the above mentioned table is incorrect. I'll then add my parser and the checks to my product.

I don't have the option of rebuilding the font. I am a consumer -- I need to detect if the incoming font is corrupt or not and if it is bail out with as little work done as possible.

In case it helps -- I'm on Windows XP/Vista both 32 & 64 bit and their server versions!

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-01-29T22:58:18.300

> 是否有可靠的方法来检测 maxContours 值何时过高或过低（是的，这也可能是一个问题）？

**是的。**如果您已经按照您的指示构建/拥有一个 TrueType/OpenType 解析库，则此特定值很容易验证。您需要解析每个字形（来自['glyf' 表](http://www.microsoft.com/typography/otspec/glyf.htm)，使用 'loca' 表作为索引），从每个字形中逐一获取轮廓数，并比较整个字体最大存储在['maxp'](http://www.microsoft.com/typography/otspec/maxp.htm)中。

请注意，“maxp”中的其他一些值**并不是那么**容易测试的；例如，maxZones、maxTwilightPoints、maxStorage、maxFunctionDefs、maxInstructionDefs、maxStackElements、maxSizeOfInstructions 都需要解析其他表，其中一些需要访问 TrueType 缩放器和解释器。

一点背景知识：“maxp”（最大配置文件）表旨在作为可能有用的字体范围最大值的快捷方式/摘要，作为内存分配的帮助。所以一般来说，如果 'maxp' 中的值高于实际字体值，最糟糕的情况是你分配了太多内存......也就是说，如果你在一个实际使用所有为此目的的'maxp'值。

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2009-03-05T17:16:26.417

我发现使用[FontForge](http://fontforge.sourceforge.net/)重建故障字体最方便，而不是尝试检测错误。这可以完全自动化，因为它提供了丰富的命令行和脚本 API。另外，如果需要，您可以将字体转换为更方便的格式或编码。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-03-05T17:09:20.070

你用的是什么平台？我已经能够使用 Python 的[FontTools](http://sourceforge.net/projects/fonttools/)库非常愉快地破解 TrueType 文件：

```
font= fontTools.ttLib.TTFont("suspect.ttf")
font['maxp'].maxContours 
```

ETA re q 编辑：那么问题只是“maxContours 的哪些值太低/太高”？据我所知，没有记录的限制，但我知道在 maxContours 上“添加一些”是很常见的，以防字形包含的轮廓比它所声明的要多。

（麻烦字体中的 maxContours 是什么，它与字形中实际使用的轮廓数量有什么关系？）

# vba - How to get Ribbon custom Tabs IDs?

> ID：615482
> 
> 赞同：8
> 
> 时间：2009-03-05T16:16:21.397
> 
> 标签：vba, ribbon, powerpoint

I am working with a Custom Ribbon in Power Point, I need to iterate through all tabs and get the ID of them.

The Ribbon contains Tabs added from different projects (C++, C#) as addins and I don't know their IDs. I am using VBA to handle the events fired from the Ribbon.

How do I do to get the ID from all tabs in the Ribbon using VBA?

Thanks in advance.

* * *

## 回答 #1

> 赞同：9
> 
> 时间：2011-01-06T15:59:09.420

使用返回 IAccessible 对象的 CommandBars("Ribbon") 访问功能区。您通过使用访问选项卡

```
AccessibleChildren _
            Lib "oleacc.dll" _
                (ByVal paccContainer As Object, _
                 ByVal iChildStart As Long, _
                 ByVal cChildren As Long, _
                       rgvarChildren As Variant, _
                       pcObtained As Long) _
            As Long 
```

这将使用所有子元素（选项卡）的列表填充数组，这些子元素也是 IAccessible 对象。您获得的 ID 是字符串，您可以遍历每个 ID 的子项以获取子菜单项等。

这非常复杂，因此完成此操作的最佳方法是从示例中进行操作。幸运的是，这里有一个闪闪发光的例子：[http ://www.wordarticles.com/Shorts/RibbonVBA/RibbonVBADemo.htm](http://www.wordarticles.com/Shorts/RibbonVBA/RibbonVBADemo.htm)

![功能区选项卡](https://i.stack.imgur.com/2LpOM.png)

仔细阅读那个代码。

# linux - 在 linux 内核中运行的服务器。是否应该在线程中进行监听？

> ID：615483
> 
> 赞同：1
> 
> 时间：2009-03-05T16:16:52.550
> 
> 标签：linux, networking, kernel

我正在 linux 内核中编写客户端/服务器（是的。在内核内部。它的设计决定已经完成并最终确定。它不会改变）

服务器从原始套接字读取传入的数据包。这些数据包（原始套接字正在侦听）的传输协议是自定义的，类似于 UDP。简而言之，我不必监听传入的连接，然后派生一个线程来处理该连接。

我只需要处理该原始套接字上的任何 IP 数据报。我将继续在原始套接字上无限循环地读取数据包。在用户级等效程序中，我会创建一个单独的线程并继续侦听传入的数据包。

现在对于内核级服务器，我怀疑是否应该在单独的线程中运行它，因为：

1.  我认为 read() 是一个 I/O 操作。所以在 read() 的某个地方，内核必须调用 schedule() 函数来放弃对处理器的控制。因此，在原始套接字上调用 read() 后，当前内核活动上下文将被搁置（可能放入睡眠队列？），直到数据包可用。当数据包到达时，内核中断上下文将发出信号，表明在队列中休眠的读取上下文再次准备好运行。我在这里故意使用“上下文”而不是“线程”。因此我不应该需要一个单独的内核线程。

2.  另一方面，如果 read() 没有放弃控制，那么整个内核将被阻塞。

谁能提供有关如何设计服务器的提示？第 1 点提出的论点的谬误是什么？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-03-05T22:23:00.313

我不确定内核中是否需要原始套接字。在内核中，您可以添加一个 netfilter 钩子，或者注册其他东西 (???) 它将接收所有数据包；这可能是你想要的。

如果您确实在内核中使用了原始套接字，那么您可能需要有一个内核线程（即由 kernel_thread 启动）才能在其上调用 read()。但它不一定是内核线程，它可以是用户空间线程，它只是进行了特殊的系统调用或设备调用来调用所需的内核模式例程。

如果你注册了一个钩子，它被调用的上下文可能不应该做太多处理；我不知道那可能是什么，它可能是“下半部分处理程序”或“tasklet”，无论是什么（这些类型的控制结构不断从一个版本更改为另一个版本）。我希望它实际上不是一个中断服务程序。

* * *

在回答你原来的问题：

1.  是的， sys_read 将阻塞调用线程，无论是内核线程还是用户空间线程。系统不会挂起。但是，如果调用线程不处于阻塞有意义的状态，内核将恐慌（调度中断或其他东西）

是的，您需要在单独的线程中执行此操作，不，它不会挂起系统。然而，在内核模式下进行系统调用是非常不确定的，尽管它确实有效（有点）。

但是如果你安装了某种钩子，你就不需要这样做了。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-03-05T16:23:54.390

我认为您最好的选择可能是模拟驱动程序的编写方式，将您的服务器视为位于请求来自的设备之上的虚拟设备。示例：鼠标驱动程序接受连续输入，但如果编程正确，则不会锁定系统，并且网络适配器可能与您的情况更相似。

# xna - 在 XNA 中缩小 Texture2D

> ID：615488
> 
> 赞同：5
> 
> 时间：2009-03-05T16:18:02.733
> 
> 标签：xna, collision-detection, scale, texture2d, downsize

我想将一个 Texture2D 对象缩小为 XNA 中的另一个 Texture2D 对象。

原因是使用缩小的对象进行基于像素的碰撞检测。

这可以做到吗？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2009-03-05T17:07:52.023

你应该看看[per-pixel collision tutorial](http://creators.xna.com/en-US/tutorial/collision2dperpixel)以及[transformed per-pixel collision tutorial](http://creators.xna.com/en-US/tutorial/collision2dperpixeltransformed)。

本质上，要对变换的纹理（例如您想要的缩放纹理）进行碰撞检测，您需要使用[变换](http://en.wikipedia.org/wiki/Transformation_matrix) [矩阵](http://msdn.microsoft.com/en-us/library/microsoft.xna.framework.matrix.aspx)。这并不太难，教程给出了一个很好的例子。本教程不缩放而是旋转，但源代码中包含注释，向您展示了在何处以及如何进行缩放。

# iphone - can't draw fast enough to keep up with touchesMoved?

> ID：615492
> 
> 赞同：6
> 
> 时间：2009-03-05T16:19:10.033
> 
> 标签：iphone

I am trying to implement simple paint functionality in my iPhone app. I tried updating a bitmap with a bitmap brush, and I also tried [this tutorial](http://www.ipodtouchfans.com/forums/showthread.php?t=132024).

Both methods have the same problem, even though the code is almost totally different. It happens only on the device - the simulator works fine.

When I touch the screen and move my finger, the screen does not get updated. When I pause or lift my finger, then the screen gets updated. This is not a very good user experience!

I tried calling drawRect from touchesMoved directly, but found that the drawing context (which I retrieve using UIGraphicsGetCurrentContext) is invalid for many of the calls, so painting the screen myself for every touchesMoved doesn't work.

Any ideas?

Thanks for any help, this has been quite frustrating!

Henning

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-03-05T18:09:46.927

在我看来，您没有让主运行循环有机会更新显示。您的绘图代码的执行时间可能比触摸事件之间的时间长，因此显示永远不会更新。当您抬起手指时，它会进行更新，因为它不再为您的绘图带来负担。

您可能会考虑优化您的绘图以加快速度（例如，仅在屏幕的脏区域内绘图），使用类似 NSOperationQueue 的东西来排队您的绘图的繁重计算以在后台线程上运行，或者有选择地放弃触摸绘图事件以保持您的响应顺畅。

另一种可能性是将繁重的绘图代码放在一个单独的方法中，并通过 performSelector:withObject:afterDelay 调用它，延迟为 10 毫秒（或更短）。这可能使主运行循环有机会使用其当前状态更新显示。我没有对此进行测试，但如果我没记错的话，我已经看到了这项工作。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-03-05T16:24:07.790

您不能直接调用`drawRect`:. 要按需刷新屏幕，请尝试`[self setNeedsDisplay]`从您的`touchesMoved`方法调用，这将为调用设置正确的上下文`drawRect:`。

# java - How do I read the manifest file for a webapp running in apache tomcat?

> ID：615493
> 
> 赞同：47
> 
> 时间：2009-03-05T16:19:15.790
> 
> 标签：java, tomcat, jar, manifest

I have a webapp which contains a manifest file, in which I write the current version of my application during an ant build task. The manifest file is created correctly, but when I try to read it in during runtime, I get some strange side-effects. My code for reading in the manifest is something like this:

```
 InputStream manifestStream = Thread.currentThread()
                                 .getContextClassLoader()
                                 .getResourceAsStream("META-INFFFF/MANIFEST.MF");
    try {
        Manifest manifest = new Manifest(manifestStream);
        Attributes attributes = manifest.getMainAttributes();
        String impVersion = attributes.getValue("Implementation-Version");
        mVersionString = impVersion;
    }
    catch(IOException ex) {
        logger.warn("Error while reading version: " + ex.getMessage());
    } 
```

When I attach eclipse to tomcat, I see that the above code works, but it seems to get a different manifest file than the one I expected, which I can tell because the ant version and build timestamp are both different. Then, I put "META-INFFFF" in there, and the above code still works! This means that I'm reading some other manifest, not mine. I also tried

```
this.getClass().getClassLoader().getResourceAsStream(...) 
```

But the result was the same. What's the proper way to read the manifest file from inside of a webapp running in tomcat?

**Edit**: Thanks for the suggestions so far. Also, I should note that I *am* running tomcat standalone; I launch it from the command line, and then attach to the running instance in Eclipse's debugger. That shouldn't make a difference, should it?

* * *

## 回答 #1

> 赞同：91
> 
> 时间：2009-03-05T16:28:39.870

也许您的副作用来自几乎所有罐子都包含 MANIFEST.MF 而您没有得到正确的事实。要从 webapp 中读取 MANIFEST.MF，我会说：

```
ServletContext application = getServletConfig().getServletContext();
InputStream inputStream = application.getResourceAsStream("/META-INF/MANIFEST.MF");
Manifest manifest = new Manifest(inputStream); 
```

请注意，从 Eclipse 运行 Tomcat 与单独运行 Tomcat 不同，因为 Eclipse 使用类加载器。

* * *

## 回答 #2

> 赞同：11
> 
> 时间：2010-03-18T11:29:18.897

有点晚了，但这对我有用（Glassfish中的网络应用程序）

```
Properties prop = new Properties();
prop.load(getServletContext().getResourceAsStream("/META-INF/MANIFEST.MF"));
System.out.println("All attributes:" + prop.stringPropertyNames());
System.out.println(prop.getProperty("{whatever attribute you want}")); 
```

* * *

## 回答 #3

> 赞同：3
> 
> 时间：2012-12-02T16:18:38.183

尝试使用[jcabi-manifests](http://manifests.jcabi.com/index.html)，它会为您完成所有这些加载工作。例如：

```
String version = Manifests.read("My-Version"); 
```

从可用文件之一加载`My-Version`属性。`MANIFEST.MF`

重要的是要提到（更多细节在[这里](http://manifests.jcabi.com/servlets.html)）在大多数 Web 容器中，当前线程类加载器与 servlet 上下文类加载器不同。这就是为什么您应该在运行时将您的 servlet 上下文附加到寄存器（[更多信息](http://manifests.jcabi.com/servlets.html)）：

```
Manifests.append(servletContext); 
```

另外，请查看：[http ://www.yegor256.com/2014/07/03/how-to-read-manifest-mf.html](http://www.yegor256.com/2014/07/03/how-to-read-manifest-mf.html)

* * *

## 回答 #4

> 赞同：2
> 
> 时间：2009-03-05T16:34:14.600

类加载器的默认工作方式是在尝试查找自己的资源之前先顺从父级。因此，如果父类加载器有任何可用的清单，这就是您将得到的。事实上，应用服务器不一定会这样做，以允许应用程序覆盖库的版本。此外，类加载器可以有多个 jar，因此可以有多个清单。

它可能能够获取您唯一命名的资源之一的资源 URL。打开一个连接。投射到`JarURLConnection`. 获取`JarFile`. 从中加载清单。这可能行不通，特别是如果 Tomcat 引发战争。

[更新] 当然，war 文件本身不在类路径中。类路径将包含类似 WEB-INF/lib/( *.jar|* .zip) 和 WEB-INF/classes/ 的内容。从`ServletContext`应该工作中获取资源。

最佳解决方案：做一些不同的事情。:)

* * *

## 回答 #5

> 赞同：2
> 
> 时间：2015-06-22T16:15:02.433

正确的清单存在于服务器的应用程序根目录中。找出应用程序根，例如通过找出类的类路径：

```
String rootPath  = getClass().getProtectionDomain().getCodeSource().getLocation().getPath() 
```

然后将上面的路径替换为已建立的路径： Glassfish 示例：

```
/applications/<webProject>/META-INF/MANIFEST.MF 
```

它对我有用。

* * *

## 回答 #6

> 赞同：1
> 
> 时间：2009-03-05T16:26:25.227

不知道“官方”的阅读方式，但是如果 MANIFEST.MF 不能作为资源正确加载，那么尝试从某个 Web 路径上的“ServletContext.getRealPath()”获取其路径怎么样在您的应用程序中定义？

在构建期间由 ant 将应用程序版本也写入其他地方（WEB-INF/类中的属性文件）是我想到的另一个解决方案。

* * *

## 回答 #7

> 赞同：0
> 
> 时间：2015-08-30T10:43:54.623

这就是我将各种版本打印到日志文件的方法。我已经硬编码了一个扩展路径，但应用程序可以`servletContext.getRealPath("/")`用来读取 webapp 文件夹的完整路径。可以打印刚刚给定的库或 lib 文件夹中的所有内容。

```
// print library versions (jersey-common.jar, jackson-core-2.6.1.jar)
try {
    List<String> jars  = Arrays.asList( "jersey-common", "jackson-core", "openjpa", "mylib" );
    StringBuilder verbuf = new StringBuilder();
    for(File file : new File("/opt/tomcat/webapps/myapp/WEB-INF/lib/").listFiles() ) {
        String name = file.getName();
        if (file.isDirectory() || !file.isFile() || !name.endsWith(".jar") ) continue;
        name = name.substring(0, name.length()-4);
        boolean found = jars.contains(name);
        if (!found) {
            int idx = name.lastIndexOf('-');
            if (idx>0)
                found = jars.contains( name.substring(0, idx) );
        }
        if (!found) continue;

        JarFile jarFile = new JarFile(file, false);
        try {
            String ver;
            Manifest mf = jarFile.getManifest();
            if (mf!=null) {
                ver = mf.getMainAttributes().getValue("Bundle-Version");
                if (ver==null || ver.isEmpty())
                    ver = mf.getMainAttributes().getValue("Implementation-Version");
            } else ver=null;
            if (verbuf.length()>0) verbuf.append(", ");
            verbuf.append(name + "=" + (ver!=null?ver:"") );                        
        } finally {
            jarFile.close();
        }
    }
    System.out.println( verbuf.toString() );
} catch(Exception ex) {
    ex.printStackTrace();
} 
```

# mysql - 从mysql中选择具有引用ID的行到同一个表

> ID：615496
> 
> 赞同：0
> 
> 时间：2009-03-05T16:19:52.900
> 
> 标签：mysql, select

我有一张桌子，例如：

```
id 名称 ref_id 订单 data_obj
-- ---- ------ ----- --------
1 Sam 0 15 [二进制数据]
2 Jack 0 20 [二进制数据]
3 苏 0 25 [二进制数据]
4 Sam2 1 - [无数据]
5 Sue2 3 - [无数据]
6 Sam3 1 - [无数据]

```

这个想法是，除了 data_obj 之外，我还有更多常见的列，所以我不想再次插入它们，只想将引用 id 插入到相同的数据中。

是否可以编写查询并选择此：

```
1 - Sam - 来自 id 1 的二进制数据
4 - Sam2 - 来自 id 1 的二进制数据
6 - Sam3 - 来自 id 1 的二进制数据
2 - Jack - 来自 id 2 的二进制数据
3 - Sue - 来自 id 3 的二进制数据
5 - Sue2 - 来自 id 3 的二进制数据

```

请注意，我是根据名为 order 的列进行排序的，并且对于引用的行，该列没有实际数据。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-03-05T16:27:43.990

```
SELECT t1.id, t1.name, t2.data_obj 
FROM your_table t1
LEFT JOIN your_table t2 ON t1.ref_id = t2.id
ORDER BY t1.order 
```

其他版本，不返回没有 ref 的行

```
SELECT t1.id, t1.name, t2.data_obj 
FROM your_table t1, your_table t2
WHERE t1.ref_id = t2.id
ORDER BY t1.order 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-03-05T17:11:07.990

这是对@vartec[答案](https://stackoverflow.com/questions/615496/selecting-rows-with-reference-ids-to-same-table-from-mysql/615539#615539)的修改。此修改用于`COALESCE()`组合`data_obj`来自主行或引用的行。

```
SELECT t1.id, t1.name, COALESCE(t1.data_obj, t2.data_obj) 
FROM your_table t1
LEFT JOIN your_table t2 ON t1.ref_id = t2.id
ORDER BY COALESCE(t1.order, t2.order), ref_id; 
```

`COALESCE()`是返回其第一个非 NULL 参数的标准 SQL 函数。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-03-05T18:22:14.823

你为什么不用一张以上的桌子？

```
CREATE TABLE user (
    user_id number not null (some form of auto increment or sequence),
    name varchar(50) not null,
    otherdata type,
    primary key (id));

CREATE TABLE common (
    common_id number not null (autoinc),
    user_id number not null,
    commondata type,
    primary key (common_id),
    unique index (user_id, common_id));

SELECT u.name, u.otherdata, c.commondata
FROM user u, common c
WHERE u.user_id = c.user_id

TABLE user
user_id  name   otherdata
1        Sam    abc
2        Jack   def
3        Sue    ghi

Table common
common_id user_id  commondata
1         1        AAA
2         1        BBB
3         1        CCC
4         2        DDD
5         3        EEE
6         3        FFF

Output
name   otherdata  commondata
Sam    abc        AAA
Sam    abc        BBB
Sam    abc        CCC
Jack   def        DDD
Sue    ghi        EEE
Sue    ghi        FFF 
```

# asp.net - 页面上的两个 ModalPopupExtender 导致不正确的验证问题

> ID：615498
> 
> 赞同：1
> 
> 时间：2009-03-05T16:20:12.917
> 
> 标签：asp.net, ajax

我有一个 aspx 页面，上面有两个 UserControl；每个主要是一个 ModalPopupExtender。一个有验证器；一个没有。没有带有 CausesValidation="false" 属性的提交按钮的那个。

单击该提交按钮时，没有任何反应。再次单击它，回发将按预期进行。这里显然存在一些验证问题，因为如果我从页面中删除所有验证器，则回发会在第一次单击时成功。

这里发生了什么？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-03-05T16:26:44.710

如果没有看到代码，我不能肯定地说，但听起来你可能需要使用验证组。验证组将设置在验证组件以及回发页面的按钮上。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-03-09T14:50:00.743

确保显示 ModalPopups 的按钮也标记为 CausesValidation=false。发生的事情是非验证对话框的“显示对话框”按钮没有以这种方式标记；这导致整个页面在显示该对话框时进行验证 - 包括*另一个*对话框，该对话框确实进行了验证并且失败了。这导致提交按钮显然无缘无故失败。

故事的寓意：确保在任何不需要它的按钮上使用 CausesValidation，并使用验证组来分隔各个页面部分，尤其是当页面的某些部分不可见时。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-03-11T11:54:34.283

您是否尝试过从模式弹出窗口中删除 OK 按钮属性？

# vb.net - 如何使用 vb.net 检查活动目录中是否存在ou？

> ID：615499
> 
> 赞同：0
> 
> 时间：2009-03-05T16:20:33.087
> 
> 标签：vb.net, active-directory

我尝试将 Human Resource DB 集成到 Active Directory。一旦我使用 sql，获取所有人员和部门，然后写入广告。但是如果一个部门建立了新的如何检查活动目录中是否存在或新的，那么人也可以使用计算机。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-05-25T23:19:17.717

这篇文章应该会有所帮助： http: [//www.codeproject.com/KB/IP/LDAP_Using_VBnet.aspx](http://www.codeproject.com/KB/IP/LDAP_Using_VBnet.aspx)

我的想法是您将创建一个人员列表 (OU)，一旦您有了这样的列表，创建一个函数来检查列表以查看特定人员是否存在是非常简单的。

因此，如果该人不存在—— CreatePerson()

否则，如果该人存在——UpdatePerson()

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-03-05T16:48:44.643

查看[System.DirectoryServices.AccountManagement](http://msdn.microsoft.com/en-us/library/system.directoryservices.accountmanagement.aspx)命名空间。您可能还想查看 Account Management[示例应用程序](http://msdn.microsoft.com/en-us/library/bb384374.aspx)的想法。要检查 OU，您可以使用[System.DirectoryServices](http://msdn.microsoft.com/en-us/library/system.directoryservices.aspx)根据 OU 的路径（或查找它的搜索器）实例化 DirectoryEntry。如果不存在，则需要获取父 OU 的 DirectoryEntry 对象，然后使用 Invoke 创建一个新的 OrganizationUnit 以调用 ADSI create 方法。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-03-05T17:29:58.740

感谢 JaredPar 的回答。给我 vb.net 中的示例代码。我找不到示例代码。

用上面的代码创建 ou 试试

```
 objOU = objADAM.Children.Add(strOU, "OrganizationalUnit")
                objOU.Properties("description").Add(dr.GetValue(2).ToString)
                objOU.CommitChanges()

            Catch de As Exception
                Console.WriteLine("Error:   Create failed.")
                Console.WriteLine("         {0}", de.Message)
                Return
            End Try 
```

# c# - 如何手动替换 xml 特殊字符？

> ID：615520
> 
> 赞同：0
> 
> 时间：2009-03-05T16:23:35.997
> 
> 标签：c#, xml

我的应用程序生成一个 xml 文件，然后 xslt 将其转换为一个漂亮的 html 报告。但是，我对 \n 有疑问。有一些 xslt 技术可以做到这一点，但它们非常笨拙且耗时。

所以我的解决方案是做一个 string.replace \n 到

<br />

然后强制 xmlWriter 用 WriteRaw(text) 写这个。问题是文本有时包含一些非法字符，例如 >。

我无法在 .net 中找到任何只接收字符串并将其转换为 xml 友好字符串的实用程序方法。我查看了反射器，处理此逻辑的类不是公开的。

任何想法（除了编写我自己的代码来做到这一点）？

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2009-03-05T21:02:46.090

**永远不要使用字符串操作来生成 XML。** 这不仅仅是因为它会让社交能力差的人嘲笑你：它会导致代码中有你不知道存在的错误。

从测试驱动的角度考虑它。您编写了一个使用字符串操作来生成 XML 的方法。好的，现在为它编写一个测试用例，证明它*永远不会*发出格式不正确的 XML。为了让测试证明这一点，您必须测试 XML 建议中列出的所有可能场景。您是否充分了解 XML 建议以能够断言您的测试可以做到这一点？

不，你没有。除非您正在为 XML 生成编写框架，否则您并不真正想要这样做。这就是您使用其中的类`System.Xml`来生成 XML 的原因。编写它们的人做了这些工作，所以你不必这样做。

Tomalak 展示了如何使用 XSLT 完成您正在尝试做的事情。如果您使用 an`XmlWriter`来生成 XML，请使用以下模式：

```
string s = "replace\nnewlines\nwith\nbreaks";
string[] lines = s.Split('\n');
for (int i=0; i<lines.Length; i++)
{
    xw.WriteString(lines[i]);
    if (i<lines.Length - 1)
    {
        xw.WriteElementString("br", "", "");
    }
} 
```

这在适当的地方使用字符串操作 - 当在 XML 之外操作字符串数据时 - 而不是在不适合的地方 - 在生成 XML 文本时。

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2009-03-05T16:35:24.410

我认为这个问题的解决方案会帮助你：

[xslt仅在一个节点中`\n`替换？`<br/>`](https://stackoverflow.com/questions/561235/xslt-replace-n-with-br-only-in-one-node)

您可以将提供的模板合并到您的转换过程中，并且您无需弄脏手即可完成。

# c++ - 可以将参数传递给工厂方法吗？

> ID：615523
> 
> 赞同：12
> 
> 时间：2009-03-05T16:24:00.647
> 
> 标签：c++, dependency-injection, factory

正确实现依赖注入的方法之一是将对象创建与业务逻辑分开。通常，这涉及使用工厂创建对象。

到目前为止，我从未认真考虑过使用工厂，所以如果这个问题看起来有点简单，我深表歉意：

在我遇到的所有工厂模式示例中，我总是看到没有参数化的非常简单的示例。例如，这是从[Misko Hevery](http://misko.hevery.com/)出色的[How To Think About “new” Operator](http://misko.hevery.com/2008/07/08/how-to-think-about-the-new-operator/)文章中偷来的 Factory。

```
类应用程序构建器{
  房屋建造（）{
    返回新房子（新厨房（
               新水槽（），
               新洗碗机（），
               新冰箱（））
           );
  }
}

```

但是，如果我希望我建造的每座房子都有一个名字，会发生什么？如果我按如下方式重写此代码，我是否仍在使用工厂模式？

```
类应用程序构建器{
  房屋建造（const std::string & house_name）{
    返回新房子（房子名称，
                      新厨房（新水槽（），
                                  新洗碗机（），
                                  新冰箱（））
                    );
  }
}

```

请注意，我的工厂方法调用已从这里更改：

```
应用程序构建器；
房子 * my_house = builder.build();
```

对此：

```
应用程序构建器；
房子 * my_house = builder.build("Michaels-Treehouse");
```

顺便说一句：我认为将对象实例化与业务逻辑分离的概念很棒，我只是想弄清楚如何将它应用于我自己的情况。让我感到困惑的是，我看到的所有工厂模式示例都没有将任何参数传递给 build() 函数。

需要明确的是：直到我需要实例化它之前，我才知道房子的名称。

* * *

## 回答 #1

> 赞同：12
> 
> 时间：2009-03-05T16:39:06.460

我已经看过很多使用一组固定参数的示例，例如您的名字示例，并且我自己也使用过它们，我看不出有什么问题。

然而，许多教程或小文章避免展示将参数转发给构造对象的工厂是有充分理由的：*实际上*不可能转发任意数量的参数（即使对于像 6 个参数这样的合理限制）。您转发的每个参数都必须被接受`const T&`，`T&`如果您想要通用的话。

但是，对于更复杂的示例，您需要一组呈指数增长的重载（对于每个参数，一个 const 和一个非常量版本），并且根本不可能进行[完美转发（例如，临时对象被作为临时对象转发）。](http://blogs.msdn.com/vcblog/archive/2009/02/03/rvalue-references-c-0x-features-in-vc10-part-2.aspx)对于下一个 C++ 标准，该问题已解决：

```
class ApplicationBuilder {
  template<typename... T>
  House *build( T&&... t ) {
    return new House( std::forward<T>(t)...,
                      new Kitchen(new Sink(),
                                  new Dishwasher(),
                                  new Refrigerator())
                    );
  }
}; 
```

这样，您可以调用

```
builder.build("Hello", 13); 
```

它会回来

```
new House("Hello", 13, new Kitchen(new Sink(... 
```

阅读我上面链接的文章。

* * *

## 回答 #2

> 赞同：6
> 
> 时间：2009-03-05T16:34:14.677

不仅是可以接受的，而且将参数传递给工厂方法也很*常见。*看看[一些例子](http://en.wikipedia.org/wiki/Factory_method_pattern)。通常参数是告诉工厂要做什么的类型，但没有理由不能添加构建对象所需的其他信息。我认为你正在做的很好。

* * *

## 回答 #3

> 赞同：5
> 
> 时间：2009-03-05T16:28:22.850

我不明白为什么将此参数添加到您的工厂是错误的。但请注意，您最终不应添加许多参数，这些参数可能对工厂创建的所有对象都没有用。如果这样做，您将失去很多工厂的优势！

* * *

## 回答 #4

> 赞同：4
> 
> 时间：2009-03-05T16:31:47.210

工厂的想法是它为您提供类/接口的实例，因此传递参数没有任何问题。如果有，那么将参数也传递给 new() 也很糟糕。

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2009-03-05T16:31:35.480

我同意贝努瓦的观点。想想一个创建类似 sql 连接的工厂，在这种情况下，有必要将有关连接的信息传递给工厂。工厂将使用该信息来使用正确的服务器协议等。

* * *

## 回答 #6

> 赞同：1
> 
> 时间：2009-03-05T16:34:45.707

当然，为什么不..！？

传递参数的好处是它允许您隐藏具体对象的实现。例如，在您发布的代码中，您将参数传递给构造函数。但是，您可以更改实现，以便它们通过**Initiailze**方法传递。通过将参数传递给工厂方法，您可以向调用者隐藏构造和初始化对象的性质。

* * *

## 回答 #7

> 赞同：1
> 
> 时间：2009-03-05T16:40:50.713

看看 Loki::Factory，也有一个非常类似于 Boost 的实现。我经常以不同风格使用的一些示例代码：

typedef Loki::SingletonHolder< Loki::Factory< Component, std::string, Loki::Typelist< const DataCollection&, Loki::Typelist< Game*, Loki::NullType > > > > ComponentFactory;

乍一看这可能有点奇怪，但是让我解释一下这只野兽以及它的真正强大之处。基本上我们创建一个包含工厂的单例，大多数参数用于单例，组件是我们的产品，std::string 是我们的创建 id 类型，之后是创建组件所需的参数类型列表（这可以使用宏定义，也可以使用不那么冗长的语法）。在这一行之后，一个人可以这样做：

ComponentFactory::Instance().CreateObject("someStringAssociatedWithConcreteType", anDataCollection, aGamePointer);

要创建对象，只需使用 ComponentFactory::Instance().Register(); 注册一个对象。《现代 C++ 设计》一书中有一个关于细节的精彩章节。

# c# - 在 .NET c# 中制作 MSSQL 驱动的日历

> ID：615529
> 
> 赞同：2
> 
> 时间：2009-03-05T16:25:20.673
> 
> 标签：c#, .net, sql-server, calendar

我是 .NET 新手，我的第一个项目是创建一个事件日历，以便从 mSQL 中的事件表中填充。我知道标准组件中有一个日历对象，但我想知道是否最好手动填充表格视图，因为我不知道标准对象/组件是否有很多限制。

谢谢你的帮助

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-03-05T16:51:43.560

这可以通过 .NET 提供的内置日历控件轻松完成。你基本上是在处理`DayRender`事件。

一个很好的例子可以在这里找到：[http ://www.c-sharpcorner.com/UploadFile/munnamax/DatabaseDriven08212007012112AM/DatabaseDriven.aspx](http://www.c-sharpcorner.com/UploadFile/munnamax/DatabaseDriven08212007012112AM/DatabaseDriven.aspx)

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-03-05T16:29:32.100

您可以使用标准日历控件。它将使您能够在每个单元格（天）创建中执行代码，因此您可以查询您的数据库，找到您的日期，并且在该特定日期的加载期间，您可以在单元格内编写任何必要的内容。

# c# - CIL：“操作可能会破坏运行时”异常

> ID：615530
> 
> 赞同：1
> 
> 时间：2009-03-05T16:25:29.643
> 
> 标签：c#, silverlight, clr, postsharp, cil

我一直在玩 PostSharp，但遇到了一个令人讨厌的问题。

在 Silverlight 程序集中遵循 IL：

```
.method public hidebysig specialname newslot virtual final instance void 
set_AccountProfileModifiedAt(valuetype [mscorlib]System.DateTime 'value') cil managed
{
    .maxstack 2
    .locals (
        [0] bool ~propertyHasChanged,
        [1] bool CS$4$0000)
    L_0000: nop 
    L_0001: nop 
    L_0002: ldarg.0 
    L_0003: call instance valuetype [mscorlib]System.DateTime 

Accounts.AccountOwner::get_AccountProfileModifiedAt()
    L_0008: ldarg.1 
    L_0009: call bool [mscorlib]System.DateTime::op_Inequality(valuetype 

[mscorlib]System.DateTime, valuetype [mscorlib]System.DateTime)
    L_000e: stloc.0 
    L_000f: ldarg.0 
    L_0010: ldarg.1 
    L_0011: stfld valuetype [mscorlib]System.DateTime 

Accounts.AccountOwner::accountProfileModifiedAt
    L_0016: br.s L_0018
    L_0018: ldloc.0 
    L_0019: ldc.i4.0 
    L_001a: ceq 
    L_001c: stloc.1 
    L_001d: ldloc.1 
    L_001e: brtrue.s L_002b
    L_0020: ldarg.0 
    L_0021: ldstr "AccountProfileModifiedAt"
    L_0026: call instance void 

Accounts.AccountOwner::NotifyPropertyChanged(string)
    L_002b: nop 
    L_002c: leave.s L_002e
    L_002e: ret 
} 
```

触发 System.Security.VerificationException：操作可能会破坏运行时。例外。反射器解析它OK。它有什么问题？

**更新 1** 代码的工作原理如下：

```
public void set_AccountProfileModifiedAt(DateTime value)
{
    bool propertyHasChanged = this.AccountProfileModifiedAt != value;
    this.accountProfileModifiedAt = value;
    if (propertyHasChanged)
    {
        this.NotifyPropertyChanged("AccountProfileModifiedAt");
    }
} 
```

**更新 2** 我在 setter 本身中得到了指定的异常

**更新 3** 作为 callvirt (NotifyPropertyChanged) 进行非静态调用没有帮助

**更新 4** 注释掉（出于测试目的）代码：

```
L_0018: ldloc.0 
L_0019: ldc.i4.0 
L_001a: ceq 
L_001c: stloc.1 
L_001d: ldloc.1 
```

并将 L_001e: brtrue.s L_002b 替换为 L_001e: br.s L_002b 可以解决问题，但它是无条件返回 - 不是我想要的。

**更新 5** 如果我使用 C# 编译器来模拟所需的行为（我仍然需要使用 Postsharp 来做到这一点），我会得到以下 IL：

```
.method public hidebysig specialname newslot virtual final instance void 

set_AccountProfileModifiedAt(valuetype [mscorlib]System.DateTime 'value') cil managed
{
    .maxstack 2
    .locals init (
        [0] bool val,
        [1] bool CS$4$0000)
    L_0000: nop 
    L_0001: ldarg.0 
    L_0002: call instance valuetype [mscorlib]System.DateTime 

Accounts.AccountOwner::get_AccountProfileModifiedAt()
    L_0007: ldarg.1 
    L_0008: call bool [mscorlib]System.DateTime::op_Inequality(valuetype 

[mscorlib]System.DateTime, valuetype [mscorlib]System.DateTime)
    L_000d: stloc.0 
    L_000e: ldarg.0 
    L_000f: ldarg.1 
    L_0010: stfld valuetype [mscorlib]System.DateTime 

Accounts.AccountOwner::accountProfileModifiedAt
    L_0015: ldloc.0 
    L_0016: ldc.i4.0 
    L_0017: ceq 
    L_0019: stloc.1 
    L_001a: ldloc.1 
    L_001b: brtrue.s L_0029
    L_001d: ldarg.0 
    L_001e: ldstr "AccountProfileModifiedAt"
    L_0023: call instance void 

Accounts.AccountOwner::NotifyPropertyChanged(string)
    L_0028: nop 
    L_0029: ret 
} 
```

请注意有细微的差别 - 额外的 br.s 在 L_0016 处跳转和一些奇怪的跳转 L_001e: brtrue.s L_002b。在编译器版本中，我可以直接跳转到 ret。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-03-05T21:14:54.067

你用过peverify吗？在直接使用 MSIL 时，您应该始终运行此实用程序（您可以使用 msbuild 标志 /p:PostSharpVerify=true）。

查看您的代码：

1.  您的局部变量未初始化（缺少“init”关键字）。这是 MethodBodyDeclaration 的一个属性。

2.  您在受保护的块中使用“离开”而不是“jmp”；这是没用的，但应该没关系。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-03-05T16:38:16.743

很难说 - 你有堆栈跟踪吗？当 CLR 无法验证代码的类型安全性时，通常会引发此异常。由于这可能来自此代码或您正在使用的任何方法或类型，因此如果没有堆栈跟踪，将很难说出问题所在。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-03-05T16:38:57.350

[这](http://forums.asp.net/p/981415/1255521.aspx)是处理该错误的帖子。我不知道您的特殊情况是否是由相同的问题引起的，但总的来说，这似乎与代码访问安全性和验证有关。如果是这种情况，Reflector 将能够很好地读取 IL，但 CAS 系统会出于未知原因将其踢出。

看起来您有一个属性设置器调用了一堆其他对象。您应该通过那些其他方法调用来寻找大的 switch 语句，以防它是帖子中提到的具体问题。

# telephony - 发送语音邮件

> ID：615532
> 
> 赞同：0
> 
> 时间：2009-03-05T16:25:56.787
> 
> 标签：telephony, voicemail

我正在研究向英国的许多手机/固定电话发送语音邮件消息（最好是音频文件）的方法（最多可容纳 300 人，但如有必要，我们可以分批发送）。

有没有人有任何尝试这样做的经验？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2009-03-10T12:50:51.630

Asterisk 和可能的其他软交换机（如（Freeswitch））可以为您做到这一点。Asterisk 语音邮件配置文件 voicemail.conf 允许您指定在用户邮箱中留下新语音邮件时运行的命令。您可以创建一个自定义脚本或应用程序来为您进行转发。

或者，您可以通过为 300 人创建一个电子邮件别名，然后将该电子邮件地址分配给特定的 Asterisk 邮箱，完全无需任何编程。Asterisk 默认支持语音邮件到电子邮件，因此不会提供任何特殊配置。

您也可以通过找到支持语音邮件到电子邮件的 VoIP 提供商来避免设置 Asterisk，大多数基于 Asterisk 的提供商都这样做，并将语音邮件转发到您自己的电子邮件别名地址。在这种情况下，您只需要注意谁可以留言！

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-03-05T17:41:33.313

Asterisk 当然可以拨打电话，而不仅仅是接听电话。

我们使用 Asterisk、VOIP 提供商和倒谱语音来发送警报呼叫。如果没有人回答，它会留下一条消息。

让它正确检测应答电话可能有点繁琐，但我们已经让它与我们迄今为止遇到的大多数应答电话一起工作。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-05-28T21:28:16.770

我会推荐 Katalina 'VoiceGuide' - 一个基于 Windows 的 CTI、IVR 和拨号系统，价格合理，支持传统的 POTS/ISDN 电话卡和 VoIP。见：www.voiceguide.com

# perl - 在 Perl 中处理时间数学的最佳方法是什么？

> ID：615541
> 
> 赞同：6
> 
> 时间：2009-03-05T16:28:03.193
> 
> 标签：perl, time

我正在运行两个大型日志文件，我想比较时间戳。

我已经编写了一个 Perl 脚本来查找匹配的日志语句，但我需要找到时间戳的差异。

例如，15:31:19.430888 减去 15:31:19.427763

在 Perl 中处理时间有什么好的结构吗？如果可以避免的话，我不想自己处理时间数学。

* * *

## 回答 #1

> 赞同：13
> 
> 时间：2009-03-05T16:34:34.753

您可以使用[DateTime](http://search.cpan.org/dist/DateTime/lib/DateTime.pm) CPAN 模块。

例如。

```
my $dt = DateTime->new( 
                      year   => 2009,
                      hour   => 15,
                      minute => 31,
                      second => 19,
                      nanosecond => 430888
);
my $dt2 = DateTime->new( 
                      year   => 2009,
                      hour   => 15,
                      minute => 31,
                      second => 19,
                      nanosecond => 427763
);
my $duration = $dt - $dt2; 
```

这将为您提供一个[DateTime::Duration](http://search.cpan.org/dist/DateTime/lib/DateTime/Duration.pm)对象以从中检索结果。

* * *

## 回答 #2

> 赞同：5
> 
> 时间：2009-03-05T17:15:15.467

DateTime 是最好的，但前提是您在执行任何涉及减法的日期数学运算时记得使用 subtract_datetime_absolute 方法而不是重载的减号运算符。这是从两个日期时间中获得“秒表持续时间”的唯一方法，并且只有秒表持续时间对我所做的那种日期算术有用。DateTime::Duration 接口令人困惑和误导，尤其是当您认为自己有秒表持续时间而实际上没有时。

[人们很早就提到这将是多么令人困惑，](http://marc.info/?l=perl-datetime&m=110451908609630&w=2)但从未得到纠正。

Time::Piece 模块是一个不错的选择。我不得不说，总的来说它不如 DateTime 有用，但它绝对避免了这种混乱。我更喜欢 DateTime，但几乎没有。

# c++ - 如何从 CreateWindowEx() 窗口获取宽度和高度？C++

> ID：615551
> 
> 赞同：13
> 
> 时间：2009-03-05T16:31:03.343
> 
> 标签：c++, c, windows, winapi, window

我用 CreateWindowEx() 函数制作了一个窗口，现在如何从我创建的那个窗口中获取宽度和高度？这听起来很基本，但我找不到任何答案;_;

这是必需的，因为窗口高度是根据 Windows 想要创建的方式自动创建的。

语言 C 或 C++

* * *

## 回答 #1

> 赞同：29
> 
> 时间：2009-03-05T16:32:35.757

使用[GetWindowRect](http://msdn.microsoft.com/en-us/library/ms633519(VS.85).aspx)。从左边减去右边得到宽度，从顶部减去底部得到高度。

```
RECT rect;
if(GetWindowRect(hwnd, &rect))
{
  int width = rect.right - rect.left;
  int height = rect.bottom - rect.top;
} 
```

作为旁注，如果您想要客户区而不是整个窗口。您可以使用[GetClientRect](http://msdn.microsoft.com/en-us/library/ms633503(VS.85).aspx)。有关窗口的其他信息，您可以使用[GetWindowInfo](http://msdn.microsoft.com/en-us/library/ms633516(VS.85).aspx)。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-03-05T16:33:02.060

我相信您正在寻找[GetWindowInfo](http://msdn.microsoft.com/en-us/library/windows/desktop/ms633516(v=vs.85).aspx)

例子：

```
HWND window = ::CreateWindowEx(...);
WINDOWINFO info;
if ( ::GetWindowInfo(window, &info) ) {
  ...
} 
```

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2009-03-05T16:35:17.653

您是否尝试过[`GetWindowRect()`](http://msdn.microsoft.com/en-us/library/ms633519(VS.85).aspx)或[`GetWindowInfo()`](http://msdn.microsoft.com/en-us/library/ms633516(VS.85).aspx)返回[`WINDOWINFO`](http://msdn.microsoft.com/en-us/library/ms632610(VS.85).aspx)结构？

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2009-03-05T16:42:20.303

鉴于没有迹象表明您需要大小，并且如果窗口样式设置为包含可调整大小的属性[并且用户使用最小化/最大化/恢复或拖动窗口边缘来调整窗口大小]，则大小可能会改变，您最安全的选择是包含 WM_SIZE 的消息处理程序并使用 wparam 和 lparam 参数值来确定窗口尺寸。这样，您将始终知道当前大小。WM_SIZE 在窗口创建后的消息序列中被调用。

# iis - 尝试同步站点时，MSDeploy 触发 401 Access denied 错误

> ID：615575
> 
> 赞同：9
> 
> 时间：2009-03-05T16:37:56.773
> 
> 标签：iis, ntlm, msdeploy, msdeployserviceagent

我尝试将 IIS 站点从 Win2003 服务器推送/同步到另一个。

这是我的命令：

msdeploy -verb:sync -source:metakey=lm/w3svc/68512112 -dest:metakey=lm/w3svc/68512112,computername=backup-09,username=Administrator,password=PASSWORD -whatif > msdeploysync.log

我还尝试了以下

msdeploy -verb:sync -source:metakey=lm/w3svc/68512112 -dest:metakey=lm/w3svc/68512112,computername=backup-09,username=BACKUP-09\Administrator,password=PASSWORD -whatif > msdeploysync.log

我也试过

msdeploy -verb:sync -source:metakey=lm/w3svc/68512112 -dest:metakey=lm/w3svc/68512112,computername=backup-09,username=Administrator@BACKUP-09,password=PASSWORD -whatif > msdeploysync.log

这是错误：

**致命：** 对远程代理 URL“ [http://backup-09/MSDEPLOYAGENTSERVICE](http://backup-09/MSDEPLOYAGENTSERVICE) ”的请求失败。

**致命：** 远程服务器返回错误：（401）未经授权。死亡人数：1

*   我确实以管理员身份运行了 msdeploy/cmd。
*   我确实尝试访问 [http://backup-09/MSDEPLOYAGENTSERVICE](http://backup-09/MSDEPLOYAGENTSERVICE)，它询问我的权限，我输入了上面的凭据，它工作（显示空站点）。
*   这是 MSDeploy 的 Beta 2

谁能帮我？

我现在什至为所有服务器设置了域控制器......仍然是同样的问题，无论我是否以域控制器身份登录，提供本地帐户，所有变化都会触发 401

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-04-12T14:22:45.010

请注意，Web Deploy 2.0 中存在一个错误（甚至是刷新），它不允许管理员组中的用户进行身份验证。只有域管理员和管理员帐户本身才能对 Web 部署进行身份验证。请参阅以下页面上的 ERROR_USER_NOT_ADMIN 错误代码：[http ://learn.iis.net/page.aspx/1023/web-deploy-error-codes/](http://learn.iis.net/page.aspx/1023/web-deploy-error-codes/)

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2014-04-30T07:30:38.520

我收到此错误是因为 UAC 已打开（Win​​dows Server 2008）。

需要关闭 UAC 进行远程连接：

```
HKEY_LOCAL_MACHINE\SOFTWARE\Microsoft\Windows\CurrentVersion\Policies\System\LocalAccountTokenFilterPolicy=1 
```

* * *

此密钥在另一台服务器（Windows Server 2012）上帮助了我：

```
HKEY_LOCAL_MACHINE\SOFTWARE\Microsoft\WebManagement\Server\WindowsAuthenticationEnabled=1 
```

Michael12345 在这里建议：[https ://stackoverflow.com/a/15059759/991267](https://stackoverflow.com/a/15059759/991267)

* * *

## 回答 #3

> 赞同：3
> 
> 时间：2011-01-17T13:43:46.877

默认情况下，Msdeploy 似乎使用 NTLM 身份验证，即使存在用户名和密码也是如此。要启用“用户名”和“密码”的正确处理，请将以下内容附加到相关源：或目标：参数：“,authType=basic”

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2013-07-16T08:05:54.353

我刚刚经历了 401 和 ERROR_USER_NOT_ADMIN。就我而言，问题是我使用在我的主机文件（也在目标机器上的主机文件中）设置的主机名来`computerName`设置`-dest:`参数。NTLM 试图将此主机名视为用户名的域部分（例如`hostname\userName`）。将其更改为 IP 地址或真实机器名称可解决此问题。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2010-11-10T21:08:54.130

This is a really old question, but I may have found an answer.

I was getting the 401 Unauthorized error message, but still able to login using the account specified in the call to MSDeploy, as described in the question.

In my case, the problem was solved by giving the deploy account admin privileges on the machine being deployed too.

(I see that you were using an account called Administrator, so this might not be the case for you - but I had the same symptoms so wanted to post anyway).

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2016-07-28T11:33:57.077

我之前没有出现此类错误，但在 Visual Studio 2015 Update 3 中，当创建新的 ASP.NET Core 应用程序时，默认发布配置文件不起作用。

我确实找到了解决方案。对我来说添加

```
<AuthType>NTLM</AuthType> 
```

文件中的行`.pubxml`修复了该问题。

# php - mod_rewrite 多个目录到一个 php 文件

> ID：615578
> 
> 赞同：1
> 
> 时间：2009-03-05T16:38:38.567
> 
> 标签：php, .htaccess, mod-rewrite, url-rewriting

```
RewriteEngine on
RewriteRule ^/(dir1|dir2|dir3)/(.*)$ /targetfile.php [R,L] 
```

`http://www.somesite.com/dir1`-> `http://www.somesite.com/targetfile.php`
`http://www.somesite.com/dir2`-> `http://www.somesite.com/targetfile.php`
`http://www.somesite.com/dir3`->`http://www.somesite.com/targetfile.php`

从我在网上看到的情况来看，这应该可以。不幸的是，它不会。有什么见解吗？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-03-05T16:44:37.570

如果要在 .htaccess 文件中使用它，请从模式中删除前导斜杠。并且要仅匹配完整路径段，您必须稍微更改表达式。

所以试试这个：

```
RewriteEngine on
RewriteRule ^(dir1|dir2|dir3)(/|$) targetfile.php [R,L] 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-03-05T16:45:48.347

我不认为正斜杠是必要的，除非您想将其限制为在“dir1”之后需要尾部斜杠。

尝试： RewriteRule ^(dir1|dir2|dir3)$ targetfile.php [QSA,L]

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-03-05T16:49:26.980

我认为问题在于正则表达式要求在目录名称（例如/dir1/）之后使用斜杠，但在示例中最后一个斜杠被省略（[http://www.somesite.com/dir1](http://www.somesite.com/dir1)没有斜杠） .

我想你可以试试

```
RewriteRule ^/(dir[1-3]) /targetfile.php [R,L] 
```

# vb.net - 如何捕获运行时对象上的事件

> ID：615585
> 
> 赞同：0
> 
> 时间：2009-03-05T16:39:10.093
> 
> 标签：vb.net

我正在运行时创建一个带有几个按钮和一个组合框的表单。

```
dim f as new form 
```

（呸呸呸）

然后按钮 acceptDescription 和 rejectDescription 设置...
然后组合框 descriptionCombo 设置...

然后...

```
AddHandler acceptDescription.Click, AddressOf handleAcceptedDescription
AddHandler rejectDescription.Click, AddressOf handleRejectedDescription 
```

然后我有这两种方法来捕获点击事件......但无法弄清楚如何引用其他运行时生成的控件。（如果接受，组合框，如果拒绝，则形成）

```
Private Sub handleAcceptedDescription(ByVal sender As System.Object, ByVal e As System.EventArgs)
  'stub 
  'will need to reference the chosen combobox value here 
  dim acceptedDescription as string = descriptionCombo.selectedValue .tostring  
End Sub
Private Sub handleRejectedDescription(ByVal sender As System.Object, ByVal e As System.EventArgs)
  'I want to close the runtime created form here, but can't reference it
  f.close()
  'and return user to main form
  Me.Focus()
End Sub 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-03-05T16:46:07.660

如果生成表单的代码在您的主表单中，则在主表单类的类级别声明 Form 变量，以便您可以从事件处理程序访问它。您的组合框和文本字段也是如此 - 您需要确保在处理程序范围之外声明变量，以便您可以在处理程序中引用它们。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-03-05T16:45:48.563

为什么不能参考？只需将其保存为模块/表单级变量即可。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-03-09T18:54:37.987

为了避免全局定义，最好的答案是

```
Private Sub handleRejectedDescription(ByVal sender As System.Object, ByVal e As System.EventArgs)
    'sender is a button in this case.
    'get the button
    dim b as new button
    b = ctype(sender,button)
    'now get the button's parent form
    dim f as new form
    f = ctype(b.parent, form)
    'now close the form
    f.close()
End Sub 
```

# javascript - 调用同步xmlhttprequest时IE挂了5分钟

> ID：615592
> 
> 赞同：8
> 
> 时间：2009-03-05T16:40:59.200
> 
> 标签：javascript, ajax, internet-explorer

我有一个网络应用程序并使用 ajax 回调我的网络服务器以获取数据。

有时（在相当不可预测的时刻，但可以重现）IE 完全挂起 5 分钟（窗口显示 Not Responding）然后回来并且 xmlhttprequest 对象响应错误 12002。

我可以重现它的方式如下。

1.  使用按钮从主窗口（A）打开窗口（B）
2.  单击按钮打开窗口 B 时，窗口 A 调用同步 ajax(PROC1)。 PROC1 运行文件。
3.  新窗口（B）具有 ajax 代码（PROC2）并异步调用服务器。运行良好
4.  用户在 PROC2 完成后但在返回数据之前关闭窗口 B。
5.  在主窗口（a）中，用户再次单击按钮。PROC1 再次运行，但现在 send() 调用阻塞 5 分钟。

请帮忙。我已经找了3天了。

请注意： * 我无法在 firefox 中测试它（该应用程序与 firefox 不兼容） * 我**必须**使用同步调用（这是应用程序的构建方式，开发人员需要花费太多精力来重写它）

为什么会发生这种情况以及如何解决？

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2009-03-09T21:51:29.107

你是对的 Jaap，这与 Internet Explorer 的连接限制为 2 有关。出于某种原因，IE 不会释放与在关闭的窗口中执行的 AJAX 请求的连接。

我有一个非常相似的情况，只是稍微简单一点：

*   用户在窗口 A 中单击以打开窗口 B
*   窗口 B 执行需要一段时间的 Ajax 调用
*   在 Ajax 调用返回之前，用户关闭窗口 B。与此调用的连接“泄漏”。
*   再重复 1 次，直到两个可用连接都“泄漏”
*   浏览器变得无响应

您可以尝试的一种技术（在您找到的文章中提到）似乎确实有效，是在页面的卸载事件中中止 XmlHttp 请求。

所以像：

```
var xhr = null;

function unloadPage() {
  if( xhr !== null ) {
    xhr.abort();
  }
} 
```

另一种选择是使用同步 AJAX 调用，这将阻塞直到调用返回，基本上锁定了浏览器。鉴于您的特定情况，这可能会或可能不会接受。

```
// the 3rd param is whether the call is asynchronous
xhr.open( 'get', 'url', false ); 
```

最后，如其他地方所述，您可以调整 IE 在注册表中使用的最大连接数。然而，期望您网站的访问者这样做是不现实的，它实际上并不能解决问题——只是延迟它的发生。附带说明一下，IE8 将允许 6 个并发连接。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2009-03-07T04:22:12.360

感谢您回答Martijn。

它没有解决我的问题。我认为我所看到的在这个网站上得到了最好的描述：http: [//bytes.com/groups/javascript/643080-ajax-crashes-ie-close-window](http://bytes.com/groups/javascript/643080-ajax-crashes-ie-close-window.)

在我的情况下，我的连接不稳定或网络服务器速度很慢，当连接速度太慢并且浏览器和网络服务器仍然有连接时，就会冻结。

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2009-03-10T13:25:50.530

By default Internet Explorer only allows two concurrent connections to the same website for download purposes. If you try and fire up more than this, I.E. stalls until one of the previous requests finishes at which point the next request will complete. I believe (although I could be wrong) this was put in place to prevent overloading websites with many concurrent downloads at a time. There is a registry hack to circumvent this lock.

I found these instructions kicking around the internet which alleviated my problems - I can't promise it will work for your situation, but the multi-connection limit you're facing appears related:

> 1.  Click on the Start button and select Run.
> 2.  On the Run line type Regedt32.exe and hit Enter. This will launch the Registry Editor
> 3.  Locate the following key in the registry: `HKEY_CURRENT_USER\Software\Microsoft\Windows\CurrentVersion\Internet Settings`
> 4.  Click on the Internet Settings Key.
> 5.  Now go to the Edit menu, point to NEW
> 6.  click DWORD Value
> 7.  Type ***MaxConnectionsPer1_0Server*** for the name of this DWORD Value.
> 8.  Double-click on the *MaxConnectionsPer1_0Server* key you just created and enter the following information: Value data: 10\. Base: Decimal.
> 9.  When finished press OK.
> 10.  Repeat steps 4 through 9\. This time naming the key ***MaxConnectionsPerServer*** and assigning it the same values as indicated in Steps 8.
> 11.  When finished press OK
> 12.  Close the Registry Editor.

Of course, I would use these in conjunction with the abort() call previously mentioned. In tandem, they should fix the issue.

* * *

## 回答 #4

> 赞同：2
> 
> 时间：2011-03-09T06:52:17.033

IE5 和 IE6 在尝试从 PHP 脚本接收数据时确实会挂起。原因是这些浏览器无法决定何时接收到所有数据并关闭连接。所以他们等到连接到期（因此挂起 5 或 10 分钟）。解决这个问题的一种方法是告诉浏览器它将接收多少数据。在 PHP 中，您可以使用输出缓冲来做到这一点，例如如下：

```
ob_start();
echo $html_content;
header( 'Connection: close' );
header( 'Content-Length: '.ob_get_length() );
flush();
ob_end_flush(); 
```

当一个人只是加载一个普通的网页时，这是一个解决方案。当通过 Microsoft.XMLHTTP 对象使用 AJAX GET 时，发送带有 GET 请求的“Connection: close”标头就足够了，例如

```
r.request.open( "GET", url, true );
r.request.setRequestHeader( "Connection", "close" );
r.request.send(); 
```

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2009-03-05T17:08:36.187

Winsock Error 12002 根据[msdn的含义如下](http://msdn.microsoft.com/en-us/library/aa385465(VS.85).aspx)

```
ERROR_INTERNET_TIMEOUT

12002

The request has timed out. 
```

Winsock 是 IE 中 XMLHTTP 的底层套接字传输对象，因此任何不在 HTTP 错误范围（300,400,500 等）内的错误几乎总是一个 winsock 错误。

您的问题不清楚的是第二次是否正在查询相同的资源。您可以通过附加以下内容来强制使用新的未缓存资源：

```
'?uid=+'Math.random() 
```

到可能解决问题的 URL。

另一种解决方案可能是将函数附加到窗口对象上的“onbeforeunload”事件，以在窗口 B 关闭之前调用任何活动的 XMLHTTP 请求的 abort()。

希望这两个指针可以解决您的错误。

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2013-05-22T10:37:21.230

所有这些帖子 - 禁用 PDF 阅读器......这些东西......不会解决你的问题......但可以肯定的是 - 运行 WINDOWS 更新......保持最新......这个问题会自行解决......经验会说话;）

海德科技

# sql - Delphi 上的 SQL 解析器需要

> ID：615608
> 
> 赞同：2
> 
> 时间：2009-03-05T16:44:54.870
> 
> 标签：sql, delphi, firebird

有人知道用 Delphi 编写的带有源代码的优秀 SQL 解析器吗？我需要将 SQL 命令（具有 Firebird 2.5 的所有新功能）解析为对象结构。

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2009-03-05T21:13:36.563

阅读这篇关于[Delphi SQL Parser](http://www.felix-colibri.com/papers/db/sql_parser/sql_parser.html)的文章，它使用 IB 作为数据库，但它与 FB 之间应该没有太大区别。

[还有一个名为SQL Parser for Delphi](http://sourceforge.net/projects/gasqlparser/)的开源项目，但自 2005 年以来一直没有更新，但它可能会给你一个起点。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2009-03-06T01:53:42.820

其他 2 个本机 Delphi SQL 解析器：

*   [Zeoslib](http://sourceforge.net/projects/zeoslib)似乎有一个 sql 解析器来解析 Interbase、MySQL、Oracle、Postgres、SqLite 和 Sybase。

*   [通用 SQL 解析器](http://www.sqlparser.com/download.php)（商业）

# sql - Access 查询根据表的链接方式返回空字段

> ID：615609
> 
> 赞同：3
> 
> 时间：2009-03-05T16:45:38.567
> 
> 标签：sql, sql-server-2005, ms-access, ms-access-2007

我有一个用于报告的 Access MDB，它具有来自 SQL Server 2005 的链接表视图。我构建了一个查询，该查询从 PO 表中检索信息并根据来自另一个表的信息对行项目进行分类。我比较确定查询是正常的，直到大约一个月前，当我们根据我们的主要应用程序（创建数据）的要求从服务器上的兼容模式 80 切换到 90 时。我不能 100% 肯定地说这一点，但这是过去 90 天中唯一的重大变化。我们注意到突然数据没有出现在查询中，使得报告看起来很奇怪。

这是失败查询的副本：

```
SELECT dbo_porel.jobnum, dbo_joboper.opcode, dbo_porel.jobseqtype,
    dbo_opmaster.shortchar01, 
    dbo_porel.ponum, dbo_porel.poline, dbo_podetail.unitcost

FROM ((dbo_porel 
LEFT JOIN dbo_joboper ON (dbo_porel.assemblyseq = dbo_joboper.assemblyseq) 
    AND (dbo_porel.jobseq = dbo_joboper.oprseq) 
    AND (dbo_porel.jobnum = dbo_joboper.jobnum)) 
LEFT JOIN dbo_opmaster ON dbo_joboper.opcode = dbo_opmaster.opcode) 
LEFT JOIN dbo_podetail ON (dbo_porel.poline = dbo_podetail.poline) 
    AND (dbo_porel.ponum = dbo_podetail.ponum)

WHERE (dbo_porel.jobnum="367000003") 
```

它返回以下内容：

```
jobnum    opcode  jobseqtype  shortchar01  ponum  poline  unitcost
367000003            S                     6624       2      15 
```

查询通常应该显示 opcode 和 shortchar01 的值。如果我删除链接表 dbo_podetail，它会正确显示这些字段的数据（尽管我显然不再有 unitcost）。起初我认为这可能是数据问题，但我发现如果我嵌套查询然后链接表，它工作正常。

例如，以下代码完美运行：

```
SELECT qryTest.*, dbo_podetail.unitcost

FROM (

    SELECT dbo_porel.jobnum, dbo_joboper.opcode, dbo_porel.jobseqtype,
        dbo_opmaster.shortchar01, dbo_porel.ponum, dbo_porel.poline

    FROM (dbo_porel 
    LEFT JOIN dbo_joboper ON (dbo_porel.jobnum=dbo_joboper.jobnum) 
        AND (dbo_porel.jobseq=dbo_joboper.oprseq) 
        AND (dbo_porel.assemblyseq=dbo_joboper.assemblyseq)) 
    LEFT JOIN dbo_opmaster ON dbo_joboper.opcode=dbo_opmaster.opcode

    WHERE (dbo_porel.jobnum="367000003")

) As qryTest 
LEFT JOIN dbo_podetail ON (qryTest.poline = dbo_podetail.poline) 
    AND (qryTest.ponum = dbo_podetail.ponum) 
```

我不知道为什么它在后一种情况下有效，而不是在第一种情况下有效。更糟糕的是，它似乎对某些记录间歇性地工作，而不是对其他记录（它对它起作用和不起作用的那些是一致的）。

你们中的任何专家有什么想法吗？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-03-06T03:42:29.920

您肯定需要在 Access 中为多个左/右连接使用子查询。
我认为这是 Jet 优化器的一个限制，如果您只是链接左/右连接，则会感到困惑。

您可以[看到这是一个经常出现的问题](http://www.accessmonster.com/Uwe/Misc/SR.aspx?p=multiple+left+join)。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-03-05T18:30:39.983

我总是对 Access 在连接中使用括号感到困惑。尝试去掉多余的括号。

```
FROM 
    dbo_porel 
LEFT JOIN 
    dbo_joboper ON (dbo_porel.assemblyseq = dbo_joboper.assemblyseq) 
        AND (dbo_porel.jobseq = dbo_joboper.oprseq) 
        AND (dbo_porel.jobnum = dbo_joboper.jobnum)
LEFT JOIN 
    dbo_opmaster ON (dbo_joboper.opcode = dbo_opmaster.opcode)
LEFT JOIN 
    dbo_podetail ON (dbo_porel.poline = dbo_podetail.poline) 
        AND (dbo_porel.ponum = dbo_podetail.ponum) 
```

好的，以上不起作用-对不起，我放弃了

# windows - 如果加载它的 DLL 被卸载，DLL 是否会被删除？

> ID：615612
> 
> 赞同：8
> 
> 时间：2009-03-05T16:46:05.273
> 
> 标签：windows, winapi, dll

以一个标准的 Windows 应用程序为例。它使用 LoadLibrary 加载一个 DLL 以调用其中的一个函数（我们称之为 DLL_A）。该函数加载另一个 DLL（我们称之为 DLL_B）。该应用程序现在使用 FreeLibrary 卸载 DLL_A DLL，因为它不再需要它。

问题是： **DLL_B 是否仍在内存中并已加载？**

这是我可以依赖的东西，还是没有记录？

* * *

## 回答 #1

> 赞同：11
> 
> 时间：2009-03-05T16:49:56.853

`DLL_B`不会卸载。的`LoadLibrary()`调用`DLL_A`将增加`DLL_B`. 由于没有相应的`FreeLibrary()`调用`DLL_B`，引用计数不会归零。

从 LoadLibrary() 文档：

> 系统在所有加载的模块上维护每个进程的引用计数。调用 LoadLibrary 会增加引用计数。调用 FreeLibrary 或 FreeLibraryAndExitThread 函数会减少引用计数。当模块的引用计数达到零或进程终止时（无论引用计数如何），系统都会卸载模块。

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2009-03-05T16:56:08.320

在这种情况下，您将遇到句柄泄漏：

```
Program -Load> Dll A 
          -Load> Dll B 
        -Unload> Dll A 
```

正在卸载的模块不会隐式执行任何代码来卸载它加载的模块。

由于没有执行任何代码来减少引用计数，因此模块 B 永远不会被卸载。

**以下是加载/卸载 dll 的规则：**

*   每次调用 LoadLibrary 和 LoadLibraryEx 都会增加该模块的引用计数。这仅在调用进程的上下文中，而不是跨进程边界。
*   每次调用 FreeLibrary 或 FreeLibraryAndExitThread 都会减少引用计数。
*   当引用计数达到 0 时，将被卸载。
*   当 Windows 看到您的程序已*关闭*时，任何泄漏的卸载模块都将被卸载。
*   根据您在做什么，[DllCanUnloadNow](http://msdn.microsoft.com/en-us/library/ms690368(VS.85).aspx)可能对您有用。

**仍在内存中与仍在加载：**

无法保证当引用达到 0 时，您的模块会在某个时间从内存中释放。但是您应该将模块视为在引用计数达到 0 时被卸载。

**阻止 DLL 被卸载：**

要强制卸载 DLL，您可以尝试

*   系统使用 DLL_PROCESS_DETACH 标志调用 DllMain。您可以尝试不通过某种阻塞操作从这里返回。
*   您可以尝试从您希望无法卸载的 DLL 中调用 LoadLibrary。（自载）

**编辑：**

您提到您的目标是将代码注入正在运行的程序中，并且您想故意泄漏句柄。

这很好，但是如果你经常运行这个操作，它可能会导致你的源程序崩溃，因为会使用太多的句柄，或者最终会使用太多的内存。

You can return FALSE from your DllMain to stop it from being loaded so that you don't waste memory. You do this when fdwReason is DLL_PROCESS_ATTACH. You can [read more about it here](http://msdn.microsoft.com/en-us/library/ms682583.aspx).

If you are trying to emulate a DLL and add in your own extra functionality, you will need to implement all of the functions that the source DLL implements and delegate each call back to the source DLL.

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2009-03-05T16:49:46.777

阅读**备注**部分以获得详细说明。

需要注意的关键是：

> 系统为每个加载的模块维护每个进程的引用计数

再往下

> 当模块的引用计数达到零或进程终止时，系统从进程的地址空间卸载模块

来自[MSDN](http://msdn.microsoft.com/en-us/library/ms683152.aspx)：

> 释放加载的动态链接库 (DLL) 模块，并在必要时减少其引用计数。当引用计数达到零时，模块从调用进程的地址空间中卸载，句柄不再有效。

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2009-03-05T16:50:03.360

Windows 中的 DLL 是引用计数的。当 A 被卸载时，您将减少 A 上的引用计数，如果它达到零，它将卸载，并且（假设代码中没有错误）减少 B 上的引用计数。如果 B 上的引用计数变为零，它将被卸载. DLL C 可能在 B 上有一个引用计数，并且卸载 A 不会卸载 B。

# refactoring - 什么时候重构变得不值得了？

> ID：615614
> 
> 赞同：10
> 
> 时间：2009-03-05T16:46:31.527
> 
> 标签：refactoring, scalability, maintainability, rebuild

假设您有一个程序当前按应有的方式运行。该应用程序背后的代码非常糟糕，占用大量内存，不可扩展，并且需要大量重写才能实现功能上的任何更改。

重构在什么时候变得比完全重建更不合逻辑？

* * *

## 回答 #1

> 赞同：10
> 
> 时间：2009-03-05T17:00:36.300

乔尔就这个话题写了一篇很好的文章：

[你不应该做的事情，第 1 部分](http://www.joelonsoftware.com/articles/fog0000000069.html)

我从中得到的关键教训是，虽然旧代码很糟糕，会伤害你的眼睛和审美意识，但很有可能很多代码都在修补未记录的错误和问题。即，它嵌入了很多领域知识，你很难或不可能复制它。您将不断遇到遗漏的错误。

我发现非常有用的一本书是Michael C. Feathers 的[《有效使用遗留代码》 。](https://rads.stackoverflow.com/amzn/click/com/0131177052)它提供了处理真正丑陋的遗留代码的策略和方法。

* * *

## 回答 #2

> 赞同：7
> 
> 时间：2009-03-05T16:53:56.563

重构优于重建的一个好处是，如果您可以逐步进行重构，即增量，您可以在整个系统的上下文中测试增量，从而加快开发和调试速度。

旧的和部署的代码，即使是丑陋和缓慢的，也有经过彻底测试的好处，如果你从头开始，这种好处就会失去。

增量重构方法还有助于确保始终有可用的产品可以交付（并且不断改进）。

网上有一篇很好的文章，介绍[了 Netscape 6 是如何从头开始编写的，但从商业角度来看，这是一个坏主意](http://www.joelonsoftware.com/articles/fog0000000069.html)。

* * *

## 回答 #3

> 赞同：6
> 
> 时间：2009-03-05T16:51:57.240

[Robert L. Glass](http://en.wikipedia.org/wiki/Robert_L._Glass)建议

> [重用代码的修改特别容易出错。如果要修改超过 20% 到 25% 的组件，那么从头开始编写会更加高效和有效。](https://rads.stackoverflow.com/amzn/click/com/0321117425)

* * *

## 回答 #4

> 赞同：3
> 
> 时间：2009-03-05T16:49:48.213

嗯，最简单的答案是，如果重构比重建需要更长的时间，那么你应该重建。

如果它是一个个人项目，那么无论如何您都可能希望重新构建它，因为您可能会从零开始构建而不是从重构中学到更多，这是个人项目的一个重要目标。

但是，在专业的限时环境中，从长远来看，您应该始终选择花费公司最少的钱（同样的回报），这意味着选择花费更少的时间。

当然，它可能比这更复杂一些。如果其他人可以在重构完成时处理功能，那么这可能是一个更好的选择，而不是让每个人都等待构建一个全新的版本。在这种情况下，重建可能比*仅仅*重构所花费的时间更少，但您需要将整个项目和项目的所有贡献者考虑在内。

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2009-03-05T16:48:04.737

当您花费更多时间进行重构而不是实际编写代码时。

* * *

## 回答 #6

> 赞同：1
> 
> 时间：2009-03-05T16:48:49.697

在软件没有做它应该做的事情的时候。当且仅当功能“符合预期”时，重构（更改代码而不更改功能）才有意义。

* * *

## 回答 #7

> 赞同：1
> 
> 时间：2009-03-05T16:52:32.167

我过去曾使用过此类应用程序。我发现最好的方法是循序渐进的：当你编写代码时，找到多次完成的事情，将它们组合成函数。保留一个笔记本（你知道，一个真实的，有纸，铅笔或钢笔），这样你就可以标记你的进步。将它与您的 VCS 结合使用，而不是代替它。该笔记本可用于提供您在重构过程中创建的新功能的概述，VCS 当然会填补空白以获取详细信息。

随着时间的推移，您会将大量代码合并到更合适的位置。在这段时间内重复代码几乎是不可能的，所以尽你所能做到最好，直到你可以*真正*开始重构过程，审核整个代码库并按照整个。

如果您没有足够的时间进行该过程（这将花费很长时间），那么使用测试优先的方法从头开始重写可能会更好。

* * *

## 回答 #8

> 赞同：1
> 
> 时间：2009-03-05T16:53:08.203

如果您有时间完全重建应用程序，不需要逐步改进功能，并且不希望保留任何现有代码，那么重写肯定是一个可行的选择。另一方面，您可以使用重构来进行增量重写，方法是用编写更好、效率更高的等效函数慢慢替换现有函数。

* * *

## 回答 #9

> 赞同：1
> 
> 时间：2009-03-05T17:00:31.570

如果应用程序非常小，那么您可以从头开始重写它。如果应用程序很大，永远不要这样做。逐步重写它，一次一步验证你没有破坏任何东西。

应用程序是规范。如果你从头开始重写它，你很可能会遇到很多隐蔽的错误，因为“没有人知道在那种非常特殊的情况下，对这个函数的调用应该返回 3”（未记录的行为......）。

从头开始重写总是更有趣，所以你的大脑可能会欺骗你认为这是正确的选择。小心，很可能不是。

* * *

## 回答 #10

> 赞同：0
> 
> 时间：2009-03-05T16:48:38.213

一种选择是编写单元测试来覆盖现有的应用程序，然后开始一点一点地重构它，使用单元测试来确保一切都像以前一样工作。

在理想的世界中，您已经对程序进行了单元测试，但是鉴于您对应用程序质量的评论，我猜您不会...

* * *

## 回答 #11

> 赞同：0
> 
> 时间：2009-03-05T17:31:13.277

没有文档，没有原创作者，没有测试用例，还有一堆遗留的错误。

* * *

## 回答 #12

> 赞同：0
> 
> 时间：2009-03-05T21:19:32.150

[鲍勃叔叔](http://blog.objectmentor.com/articles/2009/01/09/the-big-redesign-in-the-sky)提出以下意见：

> **什么时候重新设计才是正确的策略？**
> 
> 我很高兴你问了这个问题。这是答案。**绝不。**
> 
> 看，你弄得一团糟，现在把它清理干净。

* * *

## 回答 #13

> 赞同：0
> 
> 时间：2009-03-05T21:45:29.750

当我继承的代码真的很糟糕时，我对小的增量更改不太幸运。从理论上讲，小增量方法听起来不错，但在实践中，它最终得到的只是一个更好但设计不佳的应用程序，每个人都认为现在是你的设计。当事情破裂时，人们不再认为是因为以前的代码，现在它变成了你的错。所以，我不会使用重新设计、重构或其他任何暗示*经理类型的词*除非我真的要按照自己的方式去做，否则您正在按照自己的方式改变事情。否则，即使您可能已经解决了数十个问题，任何仍然存在（但未发现）的问题现在都将归因于您的返工。请放心，如果代码不好，那么您的修复将发现更多以前被忽略的错误，因为代码一开始就很糟糕。

如果你真的知道如何开发软件系统，那么我会重新设计整个系统。如果你真的不知道如何设计好的软件，那么我会说坚持小的增量更改，否则你可能会得到一个与原始代码库一样糟糕的代码库。

重新设计时经常犯的一个错误是人们忽略了原始代码库。但是，重新设计并不一定意味着完全忽略旧代码。旧代码仍然必须执行新代码必须执行的操作，因此在许多情况下，您需要的步骤已经在旧代码中。复制和粘贴然后调整在重新设计系统时会产生奇迹。我发现在许多情况下，重新设计和重写应用程序并从原始代码中窃取片段比小的增量更改要快得多，也更可靠。

# c# - 如何检查是否使用可执行文件路径安装了 Windows 服务？

> ID：615618
> 
> 赞同：1
> 
> 时间：2009-03-05T16:47:33.833
> 
> 标签：c#, windows-services

如何检查是否仅使用可执行路径安装了 Windows 服务？
我检查了 ServiceController 类 - 它允许您使用服务名称和显示名称，但不能使用可执行名称来验证。

我只有可执行文件的 FullName 可用于我的代码。有任何想法吗？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-03-05T16:48:37.887

两种选择。

1.  WMI。Win32_Service 类的 PathName 属性具有可执行命令行（因此包括参数）。

2.  遍历注册表

# tsql - TSQL 默认最小日期时间

> ID：615625
> 
> 赞同：25
> 
> 时间：2009-03-05T16:48:11.320
> 
> 标签：tsql

使用 Transact SQL 是否可以在列上指定默认日期时间（在 create table 语句中），以便日期时间是日期时间值的最小可能值？

```
创建表
(
  atableID int IDENTITY(1, 1) 主键集群，
  修改日期时间 DEFAULT XXXXX??????
)

```

也许我应该把它留空。

* * *

## 回答 #1

> 赞同：42
> 
> 时间：2009-03-05T17:07:08.980

据我所知，不存在返回这个的函数，你必须硬设置它。

尝试从诸如 0 之类的值进行转换以获得最小日期将默认为 01-01-1900。

正如之前建议的那样，最好将其设置为 NULL（如果需要，请在阅读时使用 ISNULL），或者如果您担心正确设置它，您甚至可以在表上设置一个触发器来设置您在编辑时的修改日期。

如果您决心尽可能缩短约会时间，那么：

```
创建表
(
  atableID int IDENTITY(1, 1) 主键集群，
  修改日期时间 DEFAULT '1753-01-01'
)

```

* * *

## 回答 #2

> 赞同：19
> 
> 时间：2011-03-07T12:32:18.387

我同意“不要使用魔法值”中的观点。但我想指出，有时诉诸此类解决方案是合法的。

将列设置为可空是要付出代价的：NULL 是不可索引的。诸如“获取自 2010 年初以来未修改的所有记录”之类的查询包括从未修改过的记录。如果我们使用可空列，我们将被迫使用 [modified] < @cutoffDate OR [modified] **IS NULL**，这反过来又迫使数据库引擎执行表扫描，因为空值没有被索引。最后一个*可能*是个问题。

在实践中，如果这不会引入实际的、现实世界的性能损失，则应该使用 NULL。但可能很难知道，除非您对今天的实际数据量以及所谓的可预见的未来有所了解。您还需要知道是否会有很大比例的记录具有特殊值 - 如果是这样，那么无论如何都没有必要对其进行索引。

简而言之，根据默认/经验法则，应该选择 NULL。但是，如果有大量记录，数据被频繁查询，并且只有一小部分记录具有 NULL/特殊值，则基于此信息定位记录可能会显着提高性能（当然前提是创建索引！），恕我直言，这有时可以证明使用“神奇”值是合理的。

* * *

## 回答 #3

> 赞同：10
> 
> 时间：2009-03-05T16:51:17.007

“也许我应该让它为空”

不要使用幻数-这是不好的做法-如果您没有值，请将其保留为空

否则，如果您真的想要默认日期 - 使用发布的其他技术之一来设置默认日期

* * *

## 回答 #4

> 赞同：6
> 
> 时间：2010-08-10T08:48:47.847

除非您正在做一个数据库来跟踪一个多世纪前的历史时期，否则使用

```
Modified datetime DEFAULT ((0)) 
```

非常安全可靠，允许比 '1753-01-01' 更优雅的查询和比`NULL`.

但是，由于 first Modified`datetime`是插入记录的时间，您可以使用：

```
Modified datetime NOT NULL DEFAULT (GETUTCDATE()) 
```

这避免了整个问题并使您的插入更容易和更安全 - 因为您根本不插入它，而 SQL 会做家务:-)

有了这个，您仍然可以通过使用 0 作为实际最小值来进行优雅和快速的查询，因为它保证始终低于任何 insert-generated `GETUTCDATE()`。

* * *

## 回答 #5

> 赞同：4
> 
> 时间：2011-10-21T22:48:24.117

有时你继承的脆弱代码已经在很多地方期待魔法值。每个人都是正确的，如果可能，您应该使用 NULL。但是，作为确保对该值的每个引用都相同的捷径，我喜欢将“常量”（因为没有更好的名称）放在 SQL 中的缩放器函数中，然后在需要该值时调用该函数。这样，如果我想将它们全部更新为其他东西，我可以很容易地做到这一点。或者，如果我想更改默认值，我只有一个地方可以更新它。

下面的代码创建函数和一个使用它作为默认 DateTime 值的表。然后插入并从表中选择而不指定 Modified 的值。然后自己清理。我希望这有帮助。

```
-- CREATE FUNCTION
CREATE FUNCTION dbo.DateTime_MinValue ( )
RETURNS DATETIME
AS 
    BEGIN
        DECLARE @dateTime_min DATETIME ;
        SET @dateTime_min = '1/1/1753 12:00:00 AM'
        RETURN @dateTime_min ;
    END ;
GO

-- CREATE TABLE USING FUNCTION FOR DEFAULT
CREATE TABLE TestTable
(
  TestTableId INT IDENTITY(1, 1)
                  PRIMARY KEY CLUSTERED ,
  Value VARCHAR(50) ,
  Modified DATETIME DEFAULT dbo.DateTime_MinValue()
) ;

-- INSERT VALUE INTO TABLE
INSERT  INTO TestTable
        ( Value )
VALUES  ( 'Value' ) ;

-- SELECT FROM TABLE
SELECT  TestTableId ,
        VALUE ,
        Modified
FROM    TestTable ;

-- CLEANUP YOUR DB
DROP TABLE TestTable ;
DROP FUNCTION dbo.DateTime_MinValue ; 
```

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2009-03-05T17:03:09.600

我认为这会奏效...

```
create table atable
(
  atableID int IDENTITY(1, 1) PRIMARY KEY CLUSTERED,
  Modified datetime DEFAULT ((0))
) 
```

编辑：这是错误的......最小的 SQL 日期时间值是 1753 年 1 月 1 日。我的解决方案提供了一个日期时间 = 1/1/1900 00:00:00。其他答案有正确的最短日期...

* * *

## 回答 #7

> 赞同：0
> 
> 时间：2009-03-05T17:08:58.930

我认为你在这里唯一的选择是一个常数。话虽如此 - 不要使用它 - 坚持使用空值而不是虚假日期。

```
create table atable
(
  atableID int IDENTITY(1, 1) PRIMARY KEY CLUSTERED,
  Modified datetime DEFAULT '1/1/1753'
) 
```

# python - 如何检测 compileall.compile_dir 中的错误？

> ID：615632
> 
> 赞同：0
> 
> 时间：2009-03-05T16:48:51.037
> 
> 标签：python

使用 compile_dir 编译 python 文件目录时如何检测错误？

目前我在 stderr 上得到了一些东西，但无法在我的应用程序中检测到它。py_compile.compile() 接受一个“doraise”参数，但这里没有。

或者有没有更好的方法从 python 脚本中做到这一点？

编辑：

我用 os.walk 修复它并为每个文件调用 py_compile.compile 。但问题仍然存在。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-03-05T20:10:23.830

我没有看到更好的方法。该代码旨在支持命令行程序，API 似乎并不完全意味着用作库。

如果你真的必须使用 compileall，那么你可以用这个 hack 来伪造它，它注意到在捕获的异常处理程序中测试“安静”的布尔值。我可以用 nonzero 覆盖它**，**检查异常状态以查看它是否来自 py_compile （在其他上下文中测试安静）并使用该信息做一些事情：

```
import sys
import py_compile
import compileall

class ReportProblem:
    def __nonzero__(self):
        type, value, traceback = sys.exc_info()
        if type is not None and issubclass(type, py_compile.PyCompileError):
            print "Problem with", repr(value)
            raise type, value, traceback
        return 1
report_problem = ReportProblem()

compileall.compile_dir(".", quiet=report_problem) 
```

Förresten, det finns GothPy på första måndagen varje månad, om du骷髅 ta sällskap med andra Python-användare i Gbg。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-03-05T17:02:45.340

对我来说很好。可能是您没有设置`doraise`为`True`某种方式吗？

# c# - 这是控制反转的一个例子吗？

> ID：615641
> 
> 赞同：4
> 
> 时间：2009-03-05T16:50:41.143
> 
> 标签：c#, dependency-injection, inversion-of-control

我刚刚完成了 James Kovac[关于控制反转和依赖注入的文章](http://msdn.microsoft.com/en-us/magazine/cc337885.aspx)，然后使用我学到的知识在下面制作了我自己的 IoC/DI 示例。

我对这个例子很满意，因为它：

*   **满足 IoC 的可测试性** **方面**，它通过传递 Repository 和 MockRepository 来实例化客户
*   授权服务也是**解耦**的，这将允许您编写另一个具有不同规则的授权服务，然后您可以根据其他条件轻松地将它们换掉

然而，从这里开始，有些事情似乎很奇怪：

*   **我似乎没有“容器”**。从这个意义上说，我的客户类是“充当容器”吗？
*   如果我要将其移植到 WPF，**模块（就 Prism 而言）将适合此示例**（例如 AuthorizationService 和 Repository 是否是模块？）
*   如果我要将它移植到 WPF，**MVVM 适合在**哪里？通过依赖注入确实拥有 MVVM 的一部分，或者 MVVM 是完全独立的。

感谢您对此提供的任何指导。

## 基于评论的新代码：

```
using System;
using System.Linq;
using System.Collections.Generic;

namespace TestSimpleDependencyInjection1
{
    class Program
    {
        static void Main(string[] args)
        {
            AuthorizationService authorizationService = new AuthorizationService();

            //real example
            Repository repository = new Repository(authorizationService);
            for (int id = 1; id <= 3; id++)
            {
                Customer customer = repository.GetCustomer(id);
                customer.Display();
            }
            Console.WriteLine();

            //mock test example
            MockRepository mockRepository = new MockRepository(authorizationService);
            Customer mockCustomerAdministrator = repository.GetCustomer(1);
            Customer mockCustomerSalesperson = repository.GetCustomer(2);
            UnitTester.Assert("Administrators have access", mockCustomerAdministrator.GetAuthorizationMessage(), "Access Granted");
            UnitTester.Assert("Salespeople do not have access", mockCustomerAdministrator.GetAuthorizationMessage(), "Access Granted");

            Console.ReadLine();
        }
    }

    public static class UnitTester
    {
        public static void Assert(string title, string value, string expectedResult)
        {
            Console.WriteLine(value == expectedResult ? String.Format("{0}: test succeeded", title) : String.Format("{0}: TEST FAILED!", title));
        }
    }

    public class Customer
    {

        public int ID { get; set; }
        public string FirstName { get; set; }
        public string LastName { get; set; }
        public AccessGroup AccessGroup { get; set; }
        public AuthorizationService AuthorizationService { get; set; }

        public string GetAuthorizationMessage()
        {
            return this.AuthorizationService.GetAccessMessage(this);
        }

        public Customer()
        {

        }

        public void Display()
        {
            Console.WriteLine("Customer: {1}, {0} ({2}): {3}", this.FirstName, this.LastName, this.AccessGroup, this.GetAuthorizationMessage());
        }
    }

    public class AuthorizationService
    {
        public string GetAccessMessage(Customer customer)
        {
            return customer.AccessGroup == AccessGroup.Administrator ? "Access Granted" : "Access Denied";
        }
    }

    public class Repository : IRepository
    {
        private List<Customer> _customerSet = new List<Customer>();
        private AuthorizationService _authorizationService;

        public Repository(AuthorizationService authorizationService)
        {
            _authorizationService = authorizationService;
            _customerSet.Add(new Customer {AuthorizationService = _authorizationService, ID = 1, FirstName = "Jim", LastName = "Smith", AccessGroup = AccessGroup.Administrator });
            _customerSet.Add(new Customer {AuthorizationService = _authorizationService, ID = 2, FirstName = "John", LastName = "Johnson", AccessGroup = AccessGroup.Administrator });
            _customerSet.Add(new Customer {AuthorizationService = _authorizationService, ID = 3, FirstName = "Hank", LastName = "Rivers", AccessGroup = AccessGroup.Salesperson });
        }

        public Customer GetCustomer(int id)
        {
            return (from c in _customerSet
                    where c.ID == id
                    select c).SingleOrDefault();
        }
    }

    public class MockRepository : IRepository
    {
        private List<Customer> _customerSet = new List<Customer>();
        private AuthorizationService _authorizationService;

        public MockRepository(AuthorizationService authorizationService)
        {
            _authorizationService = authorizationService;
            _customerSet.Add(new Customer { AuthorizationService = _authorizationService, ID = 1, FirstName = "Test1AdministratorFirstName", LastName = "Test1AdministratorLastName", AccessGroup = AccessGroup.Administrator });
            _customerSet.Add(new Customer { AuthorizationService = _authorizationService, ID = 2, FirstName = "Test2SalespersonFirstName", LastName = "Test2SalesPersonLastName", AccessGroup = AccessGroup.Salesperson });
        }

        public Customer GetCustomer(int id)
        {
            return (from c in _customerSet
                            where c.ID == id
                            select c).SingleOrDefault();
        }

    }

    public interface IRepository
    {
        Customer GetCustomer(int id);
    }

    public enum AccessGroup
    {
        Administrator,
        Salesperson
    }
} 
```

## 根据要求，这是原始代码：

```
using System;
using System.Collections.Generic;

namespace TestSimpleDependencyInjection1
{
    class Program
    {
        static void Main(string[] args)
        {
            AuthorizationService authorizationService = new AuthorizationService();

            //real example
            Repository repository = new Repository();
            for (int id = 1; id <= 3; id++)
            {
                Customer customer = new Customer(id, authorizationService, repository);
                customer.Display();
            }
            Console.WriteLine();

            //mock test example
            MockRepository mockRepository = new MockRepository();
            Customer mockCustomerAdministrator = new Customer(1, authorizationService, mockRepository);
            Customer mockCustomerSalesperson = new Customer(2, authorizationService, mockRepository);
            UnitTester.Assert("Administrators have access", mockCustomerAdministrator.GetAuthorizationMessage(), "Access Granted");
            UnitTester.Assert("Salespeople do not have access", mockCustomerAdministrator.GetAuthorizationMessage(), "Access Granted");

            Console.ReadLine();
        }
    }

    public static class UnitTester
    {
        public static void Assert(string title, string value, string expectedResult)
        {
            Console.WriteLine(value == expectedResult ? String.Format("{0}: test succeeded", title) : String.Format("{0}: TEST FAILED!", title));
        }
    }

    public class Customer
    {
        private AuthorizationService authorizationService;
        private IRepository repository;

        public int ID { get; set; }
        public string FirstName { get; set; }
        public string LastName { get; set; }
        public AccessGroup AccessGroup { get; set; }

        public string GetAuthorizationMessage()
        {
            return authorizationService.GetAccessMessage(this);
        }

        public Customer(int id, AuthorizationService authorizationService, IRepository repository)
        {
            this.authorizationService = authorizationService;
            this.repository = repository;

            CustomerDB customerDB = repository.GetCustomerDB(id);
            this.ID = customerDB.ID;
            this.FirstName = customerDB.FirstName;
            this.LastName = customerDB.LastName;
            this.AccessGroup = customerDB.AccessGroup;
        }

        public void Display()
        {
            Console.WriteLine("Customer: {1}, {0} ({2}): {3}", this.FirstName, this.LastName, this.AccessGroup, this.GetAuthorizationMessage());
        }
    }

    public class AuthorizationService
    {
        public string GetAccessMessage(Customer customer)
        {
            return customer.AccessGroup == AccessGroup.Administrator ? "Access Granted" : "Access Denied";
        }
    }

    public class Repository : IRepository
    {
        private List<CustomerDB> _customerDBSet = new List<CustomerDB>();

        public Repository()
        {
            _customerDBSet.Add(new CustomerDB { ID = 1, FirstName = "Jim", LastName = "Smith", AccessGroup = AccessGroup.Administrator });
            _customerDBSet.Add(new CustomerDB { ID = 2, FirstName = "John", LastName = "Johnson", AccessGroup = AccessGroup.Administrator });
            _customerDBSet.Add(new CustomerDB { ID = 3, FirstName = "Hank", LastName = "Rivers", AccessGroup = AccessGroup.Salesperson });
        }

        public CustomerDB GetCustomerDB(int id)
        {
            CustomerDB customerDBchosen = null;
            //this should be done with LINQ (couldn't get it CustomerDB to implement IEnumerable correctly)
            foreach (CustomerDB customerDB in _customerDBSet)
            {
                if (customerDB.ID == id)
                {
                    customerDBchosen = customerDB;
                    break;
                }
            }
            return customerDBchosen;
        }
    }

    public class MockRepository : IRepository
    {
        public CustomerDB GetCustomerDB(int id)
        {
            switch (id)
            {
                case 1:
                    return new CustomerDB { ID = 1, FirstName = "Test1AdministratorFirstName", LastName = "Test1AdministratorLastName", AccessGroup = AccessGroup.Administrator };
                case 2:
                    return new CustomerDB { ID = 2, FirstName = "Test2SalespersonFirstName", LastName = "Test2SalesPersonLastName", AccessGroup = AccessGroup.Salesperson };
                default:
                    return null;
            }
        }
    }

    public interface IRepository
    {
        CustomerDB GetCustomerDB(int id);
    }

    public class CustomerDB
    {
        public int ID { get; set; }
        public string FirstName { get; set; }
        public string LastName { get; set; }
        public AccessGroup AccessGroup { get; set; }
    }

    public enum AccessGroup
    {
        Administrator,
        Salesperson
    }
} 
```

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2009-03-05T16:57:49.160

您的代码以非常严重的方式违反了单一责任原则。

[http://en.wikipedia.org/wiki/Single_responsibility_principle](http://en.wikipedia.org/wiki/Single_responsibility_principle)

您的 Customer 对象不应该从存储库中加载自身，存储库应该加载 Customer 对象并将其交还给调用者。

我会期待更多类似的东西：

```
Customer customer = repository.GetCustomer(3); 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-03-05T18:57:15.143

在大多数情况下，使用 Switch 语句违反了 SRP。请[检查此](https://stackoverflow.com/questions/126409/ways-to-eliminate-switch-in-code)内容以了解消除代码中 switch 语句的方法。编写松散耦合代码的挑战和美妙之处在于消除 if、if else 和 switch 语句。

# javascript - 这符合您对回调的定义吗？

> ID：615642
> 
> 赞同：6
> 
> 时间：2009-03-05T16:50:45.353
> 
> 标签：javascript, oop, callback, definition

# 回调的定义：

在组件中设置为属性的函数。并且通常在组件上发生某些事件时调用。

# 例如：

如果您希望在用户单击 Component **componentB时显示一个显示***“我被点击”*的对话框，您可以编写一个存储为变量的方法来执行此操作：

 **```
var mouseDownCallbackFunction = function() {
    alert("I was clicked!");
}; 
```

**接下来**，您将在组件内设置此函数，如下所示...

```
// Set the Component to display the dialog when the 
// user presses the mouse down on it.
componentB.setMouseDownCallback(mouseDownCallbackFunction); 
```

这将导致**mouseDownCallbackFunction**在单击组件时在警报框中显示*“我被单击” 。*

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2009-03-05T16:53:59.030

是的，这是描述回调的确切定义......

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2009-03-05T17:26:54.877

在 JavaScript 中，从技术上讲，这是一个*闭包*，因为它可以绑定到范围内被引用的任何变量。

但是闭包只是一种更好的回调形式，所以是的，这就是回调。C 中的回调更原始，只提供对类型函数的指针引用，而不绑定到任何上下文。

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2009-03-05T16:55:05.517

是的，回调是定义在比调用它的更高级别的函数。您的客户端代码创建该函数，然后将其作为参数传递给`componentB`，以便`componentB`稍后调用它。

* * *

## 回答 #4

> 赞同：2
> 
> 时间：2009-03-05T16:56:44.827

在 C 中，这将是一个有效的回调。但是，我不太熟悉 JavaScript 是否可以说是不是，因为我不确定如何处理变量相对于它们的内存位置。

在 C/C++ 中，您可以声明一个 void 指针：

```
void aFunction()
{
     do stuff
}

int main()
{
    void* myCallback = &aFunction; 
    componentB.setMouseDownCallback(myCallback);
} 
```

会工作。

然而，尽管我缺乏 JavaScript 知识，但我确实知道

```
componentB.setMouseDownCallback(function() {
        alert("I was clicked!");
        };
); 
```

也是有效的。

**编辑**在第二句话中添加了一个不：“我不太熟悉”

* * *

## 回答 #5

> 赞同：-1
> 
> 时间：2009-03-05T16:53:27.017

是的，这是一个回调。

# .net - 如何让我的简单 .NET LRU 缓存更快？

> ID：615648
> 
> 赞同：7
> 
> 时间：2009-03-05T16:52:47.520
> 
> 标签：.net, performance, data-structures, caching, lru

昨晚和今晚，我尝试了几种不同的方法，并提出了一种类似于下面 Jeff 提出的方法（我什至已经完成了他在更新中提出的建议，并将我自己的简单 LL 实现放在一起以获得额外的收益）。这是代码，此时它看起来不再特别干净，但我已经经历了无数次改变我所能做的任何事情来提高性能。

```
public class NewLRU2<K, V> where V : class
{
    int m_iMaxItems;
    Dictionary<K, LRUNode<K, V>> m_oMainDict;

    private LRUNode<K,V> m_oHead;
    private LRUNode<K,V> m_oTail;
    private LRUNode<K,V> m_oCurrent;

    public NewLRU2(int iSize)
    {
        m_iMaxItems = iSize;
        m_oMainDict = new Dictionary<K, LRUNode<K,V>>();

        m_oHead = null;
        m_oTail = null;
    }

    public V this[K key]
    {
        get
        {
            m_oCurrent = m_oMainDict[key];

            if (m_oCurrent == m_oHead)
            {
                //do nothing
            }
            else if (m_oCurrent == m_oTail)
            {
                m_oTail = m_oCurrent.Next;
                m_oTail.Prev = null;

                m_oHead.Next = m_oCurrent;
                m_oCurrent.Prev = m_oHead;
                m_oCurrent.Next = null;
                m_oHead = m_oCurrent;
            }
            else
            {
                m_oCurrent.Prev.Next = m_oCurrent.Next;
                m_oCurrent.Next.Prev = m_oCurrent.Prev;

                m_oHead.Next = m_oCurrent;
                m_oCurrent.Prev = m_oHead;
                m_oCurrent.Next = null;
                m_oHead = m_oCurrent;
            }

            return m_oCurrent.Value;
        }
    }

    public void Add(K key, V value)
    {
        if (m_oMainDict.Count >= m_iMaxItems)
        {   
            //remove old
            m_oMainDict.Remove(m_oTail.Key);

            //reuse old
            LRUNode<K, V> oNewNode = m_oTail;
            oNewNode.Key = key;
            oNewNode.Value = value;

            m_oTail = m_oTail.Next;
            m_oTail.Prev = null;

            //add new
            m_oHead.Next = oNewNode;
            oNewNode.Prev = m_oHead;
            oNewNode.Next = null;
            m_oHead = oNewNode;
            m_oMainDict.Add(key, oNewNode);
        }
        else
        {
            LRUNode<K, V> oNewNode = new LRUNode<K, V>(key, value);
            if (m_oHead == null)
            {
                m_oHead = oNewNode;
                m_oTail = oNewNode;
            }
            else
            {
                m_oHead.Next = oNewNode;
                oNewNode.Prev = m_oHead;
                m_oHead = oNewNode;
            }
            m_oMainDict.Add(key, oNewNode);
        }
    }

    public bool Contains(K key)
    {
        return m_oMainDict.ContainsKey(key);
    }
}

internal class LRUNode<K,V>
{
    public LRUNode(K key, V val)
    {
        Key = key;
        Value = val;
    }

    public K Key;
    public V Value;
    public LRUNode<K, V> Next;
    public LRUNode<K, V> Prev;
} 
```

有一些看起来/感觉很奇怪的部分——比如在进行添加时重用旧节点——但我能够从它们中获得可观的性能提升。我也对从节点上的实际属性切换到公共变量所产生的差异感到有些惊讶，但我想这就是它与这些东西的关系。在这一点上，上面的代码几乎完全受到字典操作的性能限制，所以我不确定我是否会从混搭它中得到更多。我会继续思考并研究一些回应。

来自原帖的解释：大家好。因此，我编写了一个简单的轻量级 LRU 实现以用于压缩库（我使用它在基于散列的 LZW 样式的输入中查找匹配的字节字符串），并且我正在寻找制作方法它更快。

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2009-03-05T17:03:57.600

**更新#2**

这减少了对链表 Remove 进行列表遍历的需要。它引入了一个同时具有键和值的 LruCacheNode。该密钥仅在您修剪缓存时使用。如果您编写自己的链表实现，其中每个节点本质上是一个 LruCacheNode 以及一个 Next 和 Back 引用，您可以获得更好的性能。这就是 LinkedHashMap 所做的事情（请参阅[这](https://stackoverflow.com/questions/272674/what-is-a-data-structure-kind-of-like-a-hash-table-but-infrequently-used-keys-ar) [两个](https://stackoverflow.com/questions/486948/linkedhashmap-in-c-3-0)问题）。

```
public class LruCache<K, V>
{
    private readonly int m_iMaxItems;
    private readonly Dictionary<K, LinkedListNode<LruCacheNode<K, V>>> m_oMainDict;
    private readonly LinkedList<LruCacheNode<K, V>> m_oMainList;

    public LruCache(int iSize)
    {
        m_iMaxItems = iSize;
        m_oMainDict = new Dictionary<K, LinkedListNode<LruCacheNode<K, V>>>();
        m_oMainList = new LinkedList<LruCacheNode<K, V>>();
    }

    public V this[K key]
    {
        get
        {
            return BumpToFront(key).Value;
        }
        set
        {
            BumpToFront(key).Value = value;
        }
    }

    public void Add(K key, V value)
    {
        LinkedListNode<LruCacheNode<K, V>> newNode = m_oMainList.AddFirst(new LruCacheNode<K, V>(key, value));
        m_oMainDict.Add(key, newNode);

        if (m_oMainList.Count > m_iMaxItems)
        {
            m_oMainDict.Remove(m_oMainList.Last.Value.Key);
            m_oMainList.RemoveLast();
        }
    }

    private LruCacheNode<K, V> BumpToFront(K key)
    {
        LinkedListNode<LruCacheNode<K, V>> node = m_oMainDict[key];
        if (m_oMainList.First != node)
        {
            m_oMainList.Remove(node);
            m_oMainList.AddFirst(node);
        }
        return node.Value;
    }

    public bool Contains(K key)
    {
        return m_oMainDict.ContainsKey(key);
    }
}

internal sealed class LruCacheNode<K, V>
{
    private readonly K m_Key;
    private V m_Value;

    public LruCacheNode(K key, V value)
    {
        m_Key = key;
        m_Value = value;
    }

    public K Key
    {
        get { return m_Key; }
    }

    public V Value
    {
        get { return m_Value; }
        set { m_Value = value; }
    }
} 
```

您必须对事物进行概要分析，以查看这是否对您的环境有所改进。

**次要更新：**根据 Tim Stewart 的评论，我更新了 BumpToFront 以检查该节点是否已经位于最前面。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-03-06T16:13:41.333

LRU 缓存的目的不是让您修剪缓存并丢弃最近最少使用的东西吗？:-) 我没有看到任何修剪缓存的代码。既然您很可能想要检索用例的高性能，而修剪用例不太重要，为什么不将列表维护转移到修剪过程呢？

IOW，只需将条目放入缓存中，但在检索时为它们加上时间戳。不要重新排序条目，只需在使用时标记它们。可以是真正的 DateTime 时间戳，也可以是类中的简单计数器，最近使用的最高数字。然后在修剪过程中，只需遍历整个树并删除带有最旧邮票的条目。

* * *

## 回答 #3

> 赞同：-1
> 
> 时间：2009-03-06T05:48:24.707

使用硬件缓存，而不是说 128 个元素，并保持项目 1-128 的顺序，您可能将其设置为 32 x 4，因此 32 行，每行 4 个元素。地址的前 5 位将确定该地址将映射到 32 行中的哪一行，然后您将仅搜索 4 个项目，如果找不到则替换 4 个中最旧的。

这要快得多，并且 IIRC 在 1 x 128 缓存的命中率的 10% 以内。

要翻译，您将拥有多个链表而不是一个链表，因此遍历它们要快得多。您必须有一种方法来确定特定项目映射到哪个列表。

关键是，随着列表大小的增加，您尝试以完美的准确性保持列表中每个元素的确切顺序所获得的回报会逐渐减少。使用无序列表甚至可能会更好，并在缓存未命中时随机替换任何元素。取决于列表的大小，以及错过的惩罚与维护列表的成本。

# c# - 如何判断 SQL Server 已启动并可以使用？

> ID：615662
> 
> 赞同：2
> 
> 时间：2009-03-05T16:57:46.850
> 
> 标签：c#, sql-server, service

我有一个在系统启动时运行的应用程序，它需要与本地 SQL Server 2005 安装进行通信。我正在使用 ServiceController 类来等待它进入“正在运行”状态，并且大多数情况下它工作正常。但是，有时在冷启动时，我的第一个查询失败，说它无法登录当前用户。

这听起来像是一个竞争条件，但我认为我的 WaitForStatus 调用应该可以解决它。

有没有更好的方法来确保它真正运行？我应该多睡一觉并假设它足够长吗？

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2009-03-05T16:59:21.933

您可以捕获异常并重试，直到它起作用...

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2009-03-05T17:06:02.633

您始终可以使用[System.Data.Sql.SqlDataSourceEnumerator](http://msdn.microsoft.com/en-us/library/system.data.sql.sqldatasourceenumerator.aspx)并检查本地实例。

此外，您还可以使用枚举器发现版本信息。

# uptime - 监控远程 Windows 服务器正常运行时间的最佳方法？

> ID：615664
> 
> 赞同：0
> 
> 时间：2009-03-05T16:57:54.167
> 
> 标签：uptime

我工作的公司目前有 10 个运行各种内部脚本的 windows 盒子，但偶尔有一个出现故障，并且长达 24 小时没有人注意到，因为制造的数据仅每周收集一次。有谁知道一个管理系统，它会在机器出现故障时发出通知，并可能将正常运行时间和响应统计信息发送回 linux 机器上的 Web 管理系统？

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2009-03-05T17:00:14.567

有许多。

我使用[Nagios](http://www.nagios.org/)来监控 Windows 和 Linux 服务器。你也可以看看[Zenoss](http://www.zenoss.com/)。两者都是开源的。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-03-05T17:04:12.937

[http://www.pingdom.com/](http://www.pingdom.com/)使用简单，您可以享受 30 天的试用期 - 如果您决定登录，每月 9.95 会为您带来很多好处。我所有的应用都有它

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-03-05T17:00:13.490

我会在机器上使用 bash 脚本调用 ping 并在机器出现故障时给我（或负责的人）发电子邮件。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2009-03-05T17:04:19.613

我见过[IPMonitor](http://www.solarwinds.com/products/ipmonitor/)的使用，它是一个非常好的工具（但价格昂贵）。 [Nagios](http://www.nagios.org/)是一个免费的替代品，它应该是相当不错的，但我自己从未使用过它。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2009-03-05T17:51:49.687

我知道当您使用操作系统指纹识别选项时，[nmap可以向您显示机器的正常运行时间。](http://nmap.org/)

# asp.net - Asp.net Master Page 控件通过后面的代码动态控制

> ID：615666
> 
> 赞同：1
> 
> 时间：2009-03-05T16:59:17.613
> 
> 标签：asp.net, dynamic, master-pages, master

我有 2 个母版页，我想根据站点切换母版页，所以我想在后面的代码中处理切换母版。

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2009-03-05T17:02:40.083

这实际上很容易做到。查看[http://odetocode.com/Articles/450.aspx](http://odetocode.com/Articles/450.aspx)以详细了解它。

基本上，您将覆盖 PreInit 处理程序并指定要使用的页面。

# kindle - 有没有生成 AZW 文件的工具或项目？

> ID：615678
> 
> 赞同：7
> 
> 时间：2009-03-05T17:02:23.393
> 
> 标签：kindle

Kindle*激发*了我阅读我的各种内容的个人兴趣，但总的来说，我对可用的转换工具和格式缺乏连贯的文档不满意。我的问题 ...

**您知道任何用于生成`AZW`文件的资源、工具和/或项目吗？**

我遇到了大量关于[`PRC`](http://wiki.mobileread.com/wiki/PRC)/[`MOBI`](http://wiki.mobileread.com/wiki/MOBI)文件 ( [Mobipocket](http://www.mobipocket.com/dev/) ) 及其来源[Open eBook](http://www.openebook.org/)的信息，但是我还没有找到某些导航功能如何复制。特别是当您阅读 Kindle 提供的博客时，您可以通过按左右键来跳过整篇文章。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-07-09T02:58:42.927

我使用 Stanza 将 Microsoft doc 文件转换为 AZW，并使用 Calibre 来修改元数据。尽管这些工具的文档宣传了完成这项任务的方法，但我仍然没有弄清楚如何制作一个有效的 TOC。我也没有成功包含图像。

当我弄清楚如何做这些事情时，我会回来检查。（我希望其他人已经回答了你的问题！）

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2010-01-07T23:27:40.480

[您可以使用Kindlegen](http://www.amazon.com/gp/feature.html?docId=1000234621)创建 .mobi 书籍。它使用 html 创建支持 TOC 和跳过章节功能的电子书

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2009-07-03T05:16:50.493

我正在开发一个用于将 HTML 文件打包为 MOBI 文档的 Ruby 库。

[http://github.com/josh/kindler](http://github.com/josh/kindler)

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2010-12-17T09:12:43.640

如果您使用 kindlegen，您可以创建一个`.ncx`描述文档结构和目录的文件。您`item`在`manifest`:

```
<item id="My_Table_of_Contents" media-type="application/x-dtbncx+xml" href="KUG.ncx"/> 
```

并且（这是一个关键位，精明的读者会意识到我忘了做什么）在元素的属性中包含`id`目录：`toc``spine`

```
<spine toc="My_Table_of_Contents"> 
```

（以上片段来自`Sample`kindegen 包含的文档。这些文件的规范链接可以在 中找到`Sample/Guide.opf`。）

完成此操作后，kindlegen 应在其输出中包含以下内容：

```
Info(prcgen): Building table of content     URL: /path/to/KUG.ncx 
```

如果以上所有操作都成功了，您应该可以在 Kindle 导航栏上看到“章节”的勾号，并使用左/右按钮从一个章节跳到另一个章节。

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2012-10-16T10:41:22.560

如果您有 ePub 文件，使用 Calibre，只需将 Kindle 连接到计算机；Calibre 将检测您的 Kindle 并将转换后的 .azw 文件直接发送到您的 Kindle。[请参阅此站点](http://www.ehow.com/how_8266356_convert-ebooks-kindle-calibre.html)，该站点对此进行了详细描述。

如果您没有 ePub 文件，Calibre 将帮助您将 .doc 或 .odt 文件转换为 .epub。

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2011-02-07T11:57:16.843

您绝对需要尝试[Calibre](http://calibre-ebook.com/about)。电子书转换为数十种格式，更多功能。我用它将文档转换为我的 Kindle。强力推荐。

# mysql - odbc 导致 mysql 服务器负载高

> ID：615685
> 
> 赞同：0
> 
> 时间：2009-03-05T17:03:16.590
> 
> 标签：mysql, excel, odbc

我听说基于 excel 的 ODBC 连接会导致服务器负载过高（至少反复警告过）。

这是一个包罗万象的免责声明，还是这里有严重的问题？我计划有 5 到 8 张 excel 表格全天打开，每分钟更新一个表格（大约 65 个单元格）。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2009-03-05T17:21:16.373

我无法想象它会造成很大的负载......但肯定最好的方法是在测试环境中尝试它并监控服务器指标......

# asp.net - 如何在安装过程中创建和填充数据库

> ID：615691
> 
> 赞同：3
> 
> 时间：2009-03-05T17:05:33.010
> 
> 标签：asp.net, sql-server, deployment, visual-studio-2005

我想找到一种在 asp.net 设置期间创建和填充数据库的方法。

所以，我愿意做的是：

1.  在设置期间创建数据库
2.  用一些初始数据（国家代码或类似的东西）填充数据库
3.  在配置文件中创建适当的连接字符串

我正在使用 .NET 3.5 和 Visual Studio **2005**，数据库是 SQL Server 2005。

提前致谢。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2009-03-05T17:11:38.720

如果您正在创建一个安装程序，我确信有一种方法可以在其中进行，但我对此并不熟悉。

否则，您可能会执行以下操作。

1.  在 Global.asax 中添加一个 application_start 处理程序，检查有效的连接字符串，如果不存在，继续执行第二步。
2.  使用默认连接字符串登录服务器
3.  执行所需的脚本以创建所需的数据库和对象。
4.  使用连接信息更新 web.config

这里的关键是确定“默认”连接字符串是什么。可能是第二个配置值。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2009-03-05T18:56:20.873

通常，您需要使用 SQL 脚本来执行此操作。无论如何，我倾向于这样做，因为从长远来看，它使数据库的维护和版本控制变得更加容易。

核心思想是，在运行安装程序时，您将有一个自定义操作来执行此脚本。执行您的设置的用户将需要以下权限：

*   创建数据库
*   在新创建的数据库中创建表和其他数据库级对象
*   填充数据

不过，您的脚本会处理所有这些。您将拥有一个`CREATE DATABASE`命令、适当`CREATE SCHEMA`的 、`CREATE TABLE`、`CREATE VIEW`等命令，然后在构建架构后，使用适当的`INSERT`语句来填充数据。

我通常将其分解为多个脚本，但 YMMV：

*   创建架构脚本
*   “通用脚本”（一个用于`aspnet_regsql`Web 项目，一个用于创建企业库日志记录表和过程）
*   如有必要，创建存储过程脚本（在创建模式后执行）
*   填充初始数据脚本

为了将来的维护，我创建了升级脚本，其中一个脚本通常处理整个升级过程。

编写脚本时，请务必`IF EXISTS`在创建对象之前使用适当的安全检查（等）。我也倾向于让我的交易成为交易。

祝你好运！

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2009-03-06T09:39:43.603

好吧，实际上我在 MSDN 上找到了一个教程：[演练：使用自定义操作在安装时创建数据库](http://msdn.microsoft.com/en-us/library/49b92ztk(VS.80).aspx?ppud=4)

我会用它看看它是怎么回事，谢谢你们的帮助，我会让你知道它是怎么回事。

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2009-03-06T10:11:35.430

如果您可以使用 Linq to Sql，那么这很容易。
只需将整个数据库导入到 Linq to Sql 设计器中。这将创建描述数据库中所有对象的对象，包括封装整个数据库设置的 System.Data.Linq.DataContext 派生类。

现在您可以调用 DataContext.CreateDatabase() 来创建数据库。

[请参阅此处了解更多信息](http://msdn.microsoft.com/en-us/library/bb399420.aspx)。

# c++ - 互锁增量用法

> ID：615701
> 
> 赞同：9
> 
> 时间：2009-03-05T17:09:42.690
> 
> 标签：c++, multithreading, winapi, multicore, interlocked

在阅读[InterlockedIncrement](http://msdn.microsoft.com/en-us/library/ms683614(VS.85).aspx#)函数时，我看到了传递的变量必须在 32 位边界上对齐的注释。通常我见过这样使用 InterlockedIncrement 的代码：

```
class A
{
 public:
   A();
   void f();

 private:
  volatile long m_count;
};

A::A() : m_count(0)
{
}

void A::f()
{
  ::InterlockedIncrement(&m_count);
} 
```

上面的代码在多处理器系统中是否正常工作，还是我应该多加注意？

* * *

## 回答 #1

> 赞同：15
> 
> 时间：2009-03-05T17:13:03.570

这取决于您的编译器设置。但是，默认情况下，任何 8 个字节及以下的内容都将在自然边界上对齐。因此，我们在 32 位边界上对齐“int”。

此外，“#pragma pack”指令可用于更改编译单元内的对齐方式。

我想补充一点，答案假定 Microsoft C/C++ 编译器。打包规则可能因编译器而异。但总的来说，我会**假设**大多数 Windows 的 C/C++ 编译器都使用相同的打包默认值，只是为了更轻松地使用 Microsoft SDK 头文件。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-03-05T17:13:36.393

代码看起来很好（变量将正确对齐，除非您专门做一些事情来打破它 - 通常涉及强制转换或“打包”结构）。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-03-05T17:13:37.373

是的，这可以正常工作。除非另有说明，否则编译器通常会对齐。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2009-03-13T14:43:20.557

严格来说，这实际上取决于您对 A 的使用 - 例如，如果您在 shell ITEMIDLIST 中打包一个“A”对象，或者一个带有错误“pragma pack”的结构，则数据可能无法正确对齐。

# objective-c - 在objective-c中YES/NO，TRUE/FALSE和true/false之间有区别吗？

> ID：615702
> 
> 赞同：160
> 
> 时间：2009-03-05T17:09:55.510
> 
> 标签：objective-c, boolean

真的很简单的问题；这些值之间是否存在差异（BOOL 和 bool 之间是否存在差异）？一位同事提到他们在 Objective-C 中评估不同的东西，但是当我查看他们各自 .h 文件中的 typedef 时，YES/TRUE/true 都被定义为`1`，NO/FALSE/false 都被定义为`0`。真的有什么区别吗？

* * *

## 回答 #1

> 赞同：102
> 
> 时间：2011-03-29T12:45:52.737

我相信和之间**有**区别`bool`，`BOOL`请查看此网页以了解原因：http:
[//iosdevelopertips.com/objective-c/of-bool-and-yes.html](http://iosdevelopertips.com/objective-c/of-bool-and-yes.html)

因为`BOOL`是一种`unsigned char`而不是原始类型，所以类型的变量`BOOL`可以包含 和 以外`YES`的值`NO`。

考虑这段代码：

```
BOOL b = 42;

if (b) {
    printf("b is not NO!\n");
}

if (b != YES) {
    printf("b is not YES!\n");
} 
```

输出是：

> b 不是 NO！
> b 不是 YES！

对于大多数人来说，这是一个不必要的问题，但如果你真的想要一个布尔值，最好使用`bool`. 我应该补充一点：iOS SDK 通常`BOOL`在其接口定义上使用，所以这是一个坚持使用`BOOL`.

* * *

## 回答 #2

> 赞同：84
> 
> 时间：2009-03-05T17:22:41.550

***如果***您将`BOOL`变量用作布尔值，则没有实际区别。C 根据布尔表达式的计算结果是否为 0 来处理布尔表达式。所以：

```
if(someVar ) { ... }
if(!someVar) { ... } 
```

意思是一样的

```
if(someVar!=0) { ... }
if(someVar==0) { ... } 
```

这就是为什么您可以将任何原始类型或表达式评估为布尔测试（包括，例如指针）。请注意，您应该做前者，而不是后者。

请注意，如果将钝值分配给所谓的变量并测试特定值，***则会***`BOOL`有所不同，因此请始终将它们用作布尔值并仅从它们的`#define`值中分配它们。

重要的是，永远不要使用字符比较来测试布尔值——这不仅是有风险的，因为`someVar`可以分配一个不是 YES 的非零值，而且在我看来更重要的是，它无法正确表达意图：

```
if(someVar==YES) { ... } // don't do this!
if(someVar==NO ) { ... } // don't do this either! 
```

换句话说，按照预期和记录使用的构造来使用，您将避免在 C 语言中受到伤害。

* * *

## 回答 #3

> 赞同：55
> 
> 时间：2013-02-20T01:35:14.923

我对此进行了详尽的测试。我的结果应该不言自明：

```
//These will all print "1"
NSLog(@"%d", true == true);
NSLog(@"%d", TRUE == true);
NSLog(@"%d", YES  == true);
NSLog(@"%d", true == TRUE);
NSLog(@"%d", TRUE == TRUE);
NSLog(@"%d", YES  == TRUE);
NSLog(@"%d", true == YES);
NSLog(@"%d", TRUE == YES);
NSLog(@"%d", YES  == YES);

NSLog(@"%d", false == false);
NSLog(@"%d", FALSE == false);
NSLog(@"%d", NO    == false);
NSLog(@"%d", false == FALSE);
NSLog(@"%d", FALSE == FALSE);
NSLog(@"%d", NO    == FALSE);
NSLog(@"%d", false == NO);
NSLog(@"%d", FALSE == NO);
NSLog(@"%d", NO    == NO);

//These will all print "0"
NSLog(@"%d", false == true);
NSLog(@"%d", FALSE == true);
NSLog(@"%d", NO    == true);
NSLog(@"%d", false == TRUE);
NSLog(@"%d", FALSE == TRUE);
NSLog(@"%d", NO    == TRUE);
NSLog(@"%d", false == YES);
NSLog(@"%d", FALSE == YES);
NSLog(@"%d", NO    == YES);

NSLog(@"%d", true == false);
NSLog(@"%d", TRUE == false);
NSLog(@"%d", YES  == false);
NSLog(@"%d", true == FALSE);
NSLog(@"%d", TRUE == FALSE);
NSLog(@"%d", YES  == FALSE);
NSLog(@"%d", true == NO);
NSLog(@"%d", TRUE == NO);
NSLog(@"%d", YES  == NO); 
```

输出是：

```
2013-02-19 20:30:37.061 BooleanTests[27433:a0f] 1
2013-02-19 20:30:37.061 BooleanTests[27433:a0f] 1
2013-02-19 20:30:37.072 BooleanTests[27433:a0f] 1
2013-02-19 20:30:37.073 BooleanTests[27433:a0f] 1
2013-02-19 20:30:37.073 BooleanTests[27433:a0f] 1
2013-02-19 20:30:37.074 BooleanTests[27433:a0f] 1
2013-02-19 20:30:37.074 BooleanTests[27433:a0f] 1
2013-02-19 20:30:37.075 BooleanTests[27433:a0f] 1
2013-02-19 20:30:37.075 BooleanTests[27433:a0f] 1
2013-02-19 20:30:37.076 BooleanTests[27433:a0f] 1
2013-02-19 20:30:37.077 BooleanTests[27433:a0f] 1
2013-02-19 20:30:37.077 BooleanTests[27433:a0f] 1
2013-02-19 20:30:37.078 BooleanTests[27433:a0f] 1
2013-02-19 20:30:37.078 BooleanTests[27433:a0f] 1
2013-02-19 20:30:37.079 BooleanTests[27433:a0f] 1
2013-02-19 20:30:37.079 BooleanTests[27433:a0f] 1
2013-02-19 20:30:37.080 BooleanTests[27433:a0f] 1
2013-02-19 20:30:37.080 BooleanTests[27433:a0f] 1
2013-02-19 20:30:37.081 BooleanTests[27433:a0f] 0
2013-02-19 20:30:37.081 BooleanTests[27433:a0f] 0
2013-02-19 20:30:37.082 BooleanTests[27433:a0f] 0
2013-02-19 20:30:37.091 BooleanTests[27433:a0f] 0
2013-02-19 20:30:37.092 BooleanTests[27433:a0f] 0
2013-02-19 20:30:37.093 BooleanTests[27433:a0f] 0
2013-02-19 20:30:37.093 BooleanTests[27433:a0f] 0
2013-02-19 20:30:37.094 BooleanTests[27433:a0f] 0
2013-02-19 20:30:37.094 BooleanTests[27433:a0f] 0
2013-02-19 20:30:37.095 BooleanTests[27433:a0f] 0
2013-02-19 20:30:37.095 BooleanTests[27433:a0f] 0
2013-02-19 20:30:37.096 BooleanTests[27433:a0f] 0
2013-02-19 20:30:37.096 BooleanTests[27433:a0f] 0
2013-02-19 20:30:37.097 BooleanTests[27433:a0f] 0
2013-02-19 20:30:37.098 BooleanTests[27433:a0f] 0
2013-02-19 20:30:37.101 BooleanTests[27433:a0f] 0
2013-02-19 20:30:37.102 BooleanTests[27433:a0f] 0
2013-02-19 20:30:37.102 BooleanTests[27433:a0f] 0 
```

* * *

## 回答 #4

> 赞同：14
> 
> 时间：2009-03-05T17:57:23.433

您可能想阅读这个[问题](https://stackoverflow.com/questions/541289/objective-c-bool-vs-bool/544250#544250)的答案。总之，在 Objective-C 中（来自 objc.h 中的定义）：

```
typedef signed char        BOOL; 
// BOOL is explicitly signed so @encode(BOOL) == "c" rather than "C" 
// even if -funsigned-char is used.
#define OBJC_BOOL_DEFINED

#define YES             (BOOL)1
#define NO              (BOOL)0 
```

* * *

## 回答 #5

> 赞同：14
> 
> 时间：2016-05-14T12:41:56.127

`true`和之间的主要（危险！）区别在于`YES`JSON 序列化。

例如，我们有 JSON 类型的服务器请求，需要在 json sence 中发送 true/false：

```
NSDictionary *r1 = @{@"bool" : @(true)};
NSDictionary *r2 = @{@"bool" : @(YES)};
NSDictionary *r3 = @{@"bool" : @((BOOL)true)}; 
```

然后我们在发送之前将其转换为 JSON 字符串

```
NSData *data = [NSJSONSerialization  dataWithJSONObject:requestParams options:0 error:nil];
NSString *jsonString = [[NSString alloc] initWithData:data encoding:NSUTF8StringEncoding]; 
```

结果是

```
jsonString1 // {"bool":1}
jsonString2 // {"bool":true}
jsonString3 // {"bool":true} 
```

由于 API 逻辑`jsonString1`可能导致错误。

所以要小心 Objective-C 中的布尔值。

总而言之，只有精确`@YES`和强制转换的值`@((BOOL)expression)`是`__NSCFBoolean`类型并`true`使用 JSON 序列化转换为。任何其他表达式，如`@(expression1 && expression2)`(even `@(YES && YES)`) 都是`__NSCFNumber (int)`类型并转换为`1`JSON。

PS您可以简单地使用字符串值布尔值

```
@{@"bool" : @"true"}; // in JSON {"bool":true} 
```

* * *

## 回答 #6

> 赞同：1
> 
> 时间：2014-10-23T03:51:48.130

这里没有人提到一个微妙的错误，我想我会包括......更多的逻辑错误而不是任何东西：

```
int i = 2;
if(i);        //true
if(i==YES);   // false
if((!!i)==YES); //true 
```

所以这里的问题就是这样`(YES==1)`，在 C 中，比较不是布尔值，而是基于值的比较。

因为`YES`它只是一个`#define`（而不是语言固有的东西），它必须具有某种价值，并且`1`最有意义。

* * *

## 回答 #7

> 赞同：0
> 
> 时间：2009-03-05T17:29:25.120

我认为他们在许多情况下添加“是/否”以更加不言自明。例如：

```
[button setHidden:YES]; 
```

听起来比

```
[button setHidden:TRUE]; 
```

* * *

## 回答 #8

> 赞同：-3
> 
> 时间：2018-03-31T21:24:09.383

首先，让我们检查一下什么是真假，以及是什么赋予了它们意义。

我们可以在 lambda 演算中构造一个名为 if a then b else c 的结构，如下所示：

```
(\ifThenElse. <use if then else>)(\a. \b. \c. a b c) 
```

在 JavaScript 中，这看起来像这样：

```
(function(ifThenElse) {
    // use ifThenElse
})(function(a) {
    return function(b) {
        return function(c) {
            return a(b)(c);
        };
    };
}); 
```

为了使 ifThenElse 有用，我们需要一个选择右或左的函数“true”，并在忽略另一个选项的情况下执行此操作，或者选择不使用选项“true”的函数“false”。

我们可以如下定义这些函数：

```
(\true. <use true>)(\a. \b. a) and (\false. <use false>)(\a. \b. b) 
```

在 JavaScript 中它看起来像这样：

```
(function(True) {
    // use True
})(function(a) {
     return function(b) {
         return a;
     }
});

(function(False) {
    // use True
})(function(a) {
     return function(b) {
         return b;
     }
}); 
```

现在我们可以执行以下操作

```
(\true. \false. \ifThenElse. \doThis. \doThat. ifThenElse true doThis doThat)
(\a. \b. a)(\a. \b. b)(\a. \b. \c. a b c)(\a. ())(\a. ()) 
```

doThis 和 doThat 是 (\a. ()) 因为 lambda 演算不提供任何服务，例如打印/数学/字符串，我们所能做的就是什么都不做，说我们做到了（后来通过用服务替换它来作弊）我们的系统提供我们想要的副作用）

所以让我们看看这个在行动。

```
(function(True) {
    return (function(False) {
        return (function(ifThenElse) {
            return (function(doThis) {
                return (function(doThat) {
                    return ifThenElse(True)(doThis)(doThat);
                });
            });
        });
    })
})(function(a) {
     return function(b) {
         return a;
     }
})(function(a) {
     return function(b) {
         return b;
     }
})(function(a) {
    return function(b) {
        return function(c) {
            return a(b)(c);
        };
    };
})(function(a) { console.log("you chose LEFT!"); })
(function(a) {console.log("you chose RIGHT");})(); 
```

如果我们被允许使用数组/映射/参数/或多个语句来拆分为多个函数，那么这是一个可以简化的深层环境，但我想保持尽可能纯粹，因为我可以将自己限制为只有一个参数的函数只要。

请注意，名称 True/False 没有内在意义，我们可以轻松地将它们重命名为 yes/no、left/right、right/left、0/one、apple/orange。它的意义在于，无论做出什么选择，都只是由做出选择的人造成的。所以如果打印“LEFT”，我们知道选择器只能是真的，并且基于这些知识我们可以指导我们进一步的决定。

所以总结一下

```
function ChooseRight(left) {
    return function _ChooseRight_inner(right) {
        return right;
    }
}
function ChooseLeft(left) {
    return function _ChooseLeft_inner(right) {
        return left;
    }
}

var env = {
    '0': ChooseLeft,
    '1': ChooseRight,
    'false': ChooseRight,
    'true': ChooseLeft,
    'no': ChooseRight
    'yes': ChooseLeft,
    'snd': ChooseRight,
    'fst': ChooseLeft
};
var _0 = env['0'];
var _1 = env['1'];
var _true = env['true'];
var _false = env['false'];
var yes = env['yes'];
var no = env['no'];

// encodes church zero or one to boolean
function lambda_encodeBoolean(self) {
    return self(false)(true);
}
// decodes a Boolean to church zero or one
function lambda_decodeBoolean(self) {
    console.log(self, self ? env['true'] : env['false']);
    return self ? env['true'] : env['false'];
}

lambda_decodeBoolean('one' === 'two')(function() {
    console.log('one is two');
})(function() {
    console.log('one is not two');
})();

lambda_decodeBoolean('one' === 'one')(function() {
    console.log('one is one');
})(function() {
    console.log('one is not one');
})(); 
```

* * *

## 回答 #9

> 赞同：-7
> 
> 时间：2009-03-05T17:12:08.517

不，YES/NO 是指 TRUE/FALSE(1/0) 的不同方式

# asp.net - 在验证控件中显示星号，但在摘要中显示错误消息

> ID：615703
> 
> 赞同：3
> 
> 时间：2009-03-05T17:10:22.093
> 
> 标签：asp.net, validation

我想要一种方法来通过无效字段显示星号并在验证摘要中显示详细消息。但是，在验证控件中将 Display 设置为“NONE”会禁止显示在要验证的字段旁边的任何消息。

有没有办法获得这种混合功能？

* * *

## 回答 #1

> 赞同：13
> 
> 时间：2009-03-05T17:13:51.243

是的。

将 text 属性设置为“*”，将 ErrorMessage 属性设置为实际的错误消息。就像是。

```
<asp:RequiredFieldValidator id="ValidateMyField" runat="server" text="*" 
errormessage="Hey, you must really specify something" 
controltovalidate="YourControl" /> 
```

对于显示，您可以使用`display="Dynamic"`* 仅占用实际错误的空间。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-03-05T17:15:06.873

```
 <asp:ValidationSummary ID="valSummary" runat="server" />
<asp:CustomValidator ID="valUserNameTaken" runat="server" ErrorMessage="User name is already used in this system, please choose another.">*</asp:CustomValidator> 
```

# sql-server - 在数据库中存储密码的首选方法

> ID：615704
> 
> 赞同：76
> 
> 时间：2009-03-05T17:10:36.120
> 
> 标签：sql-server, database, security, encryption, passwords

在数据库中存储密码的首选方法/数据类型是什么（最好是 SQL Server 2005）。我在我们的几个应用程序中一直这样做的方式是首先使用 .NET 加密库，然后将它们作为二进制 (16) 存储在数据库中。这是首选方法还是我应该使用不同的数据类型或分配比 16 更多的空间？

* * *

## 回答 #1

> 赞同：82
> 
> 时间：2009-03-05T17:12:46.130

我将密码的加盐哈希等效项存储在数据库中，而不是密码本身，然后始终将哈希与生成的用户传入的哈希值进行比较。

将文字密码数据存储在任何地方都太危险了。这使得恢复变得不可能，但是当有人忘记或丢失密码时，您可以进行一些检查并创建一个新密码。

* * *

## 回答 #2

> 赞同：48
> 
> 时间：2009-03-05T17:16:58.193

首选方法：永远不要在数据库中存储密码。只有哈希值。加盐调味。

* * *

## 回答 #3

> 赞同：15
> 
> 时间：2009-03-05T17:15:00.430

我做了你描述的同样的事情，除了它被存储为一个字符串。我对加密的二进制值进行 Base64 编码。要分配的空间量取决于加密算法/密码强度。

我认为你做对了（假设你使用了[Salt](http://en.wikipedia.org/wiki/Salt_(cryptography))）。

* * *

## 回答 #4

> 赞同：9
> 
> 时间：2009-03-05T17:51:55.583

1.  存储加盐密码的哈希值，例如 bcrypt(nounce+pwd)。您可能更喜欢 bcrypt 而不是 SHA1 或 MD5，因为它可以调整为 CPU 密集型，从而使蛮力攻击的时间更长。
2.  在一些登录错误后向登录表单添加验证码（以避免暴力攻击）
3.  如果您的应用程序有“忘记我的密码”链接，请确保它不会通过电子邮件发送新密码，而是应该发送一个指向（安全）页面的链接，允许用户定义新密码（可能仅在确认后一些个人信息，例如用户的出生日期）。此外，如果您的应用程序允许用户定义新密码，请确保您要求用户确认当前密码。
4.  显然，保护登录表单（通常使用 HTTPS）和服务器本身

通过这些措施，您的用户密码将得到很好的保护，免受：

1.  => 离线字典攻击
2.  => 活字典攻击
3.  => 拒绝服务攻击
4.  => 各种攻击！

* * *

## 回答 #5

> 赞同：8
> 
> 时间：2009-03-05T17:22:10.897

由于哈希函数的结果是 0 到 255（或 -128 到 127，取决于 8 位数据类型的符号）范围内的一系列字节，将其存储为原始二进制字段最有意义，因为它是最紧凑的表示形式，不需要额外的编码和解码步骤。

一些数据库或驱动程序对二进制数据类型没有很好的支持，或者有时开发人员对它们还不够熟悉，不会感到舒服。在这种情况下，使用像 Base-64 或 Base-85 这样的二进制到文本编码，并将生成的文本存储在字符字段中是可以接受的。

所需字段的大小由您使用的散列函数确定。MD5 总是输出 16 个字节，SHA-1 总是输出 20 个字节。一旦你选择了一个哈希函数，你通常会被它所困扰，因为更改需要重置所有现有密码。因此，使用可变大小的字段不会给您带来任何好处。

* * *

关于执行散列的“最佳”方式，我试图为关于该主题的其他 SO 问题提供许多答案：

*   [加密密码](https://stackoverflow.com/questions/287517/encrypting-hashing-plain-text-passwords-in-database#287738)
*   [加密密码](https://stackoverflow.com/questions/116684/what-algorithm-should-i-use-to-hash-passwords-into-my-database)
*   [在 .NET 中加密密码](https://stackoverflow.com/questions/312088/what-is-the-easiest-way-to-create-and-compare-a-salted-password-in-net#312159)
*   [盐](https://stackoverflow.com/questions/55862/how-to-implement-password-protection-for-individual-files#55904)
*   [Salt：秘密还是公开？](https://stackoverflow.com/questions/213380/the-necessity-of-hiding-the-salt-for-a-hash#215165)
*   [哈希迭代](https://stackoverflow.com/questions/348109/is-double-hashing-a-password-less-secure-than-just-hashing-it-once/348140#348140)

* * *

## 回答 #6

> 赞同：4
> 
> 时间：2009-03-05T23:05:30.413

我使用用户名的 sha 哈希、Web 配置中的 guid 和密码，存储为 varchar(40)。如果他们想暴力破解/字典，他们还需要破解 guid 的 Web 服务器。如果用户名确实找到了密码，则会在整个数据库中创建彩虹表。如果用户想更改他们的用户名，我只需同时重置密码。

```
System.Web.Security.FormsAuthentication.HashPasswordForStoringInConfigFile(
    username.ToLower().Trim(),
    ConfigurationManager.AppSettings("salt"),
    password
); 
```

* * *

## 回答 #7

> 赞同：3
> 
> 时间：2009-03-05T18:05:05.270

密码的简单哈希，甚至（盐+密码）通常是不够的。

看：

[http://www.matasano.com/log/958/enough-with-the-rainbow-tables-what-you-need-to-know-about-secure-password-schemes/](http://www.matasano.com/log/958/enough-with-the-rainbow-tables-what-you-need-to-know-about-secure-password-schemes/)

和

[http://gom-jabbar.org/articles/2008/12/03/why-you-should-use-bcrypt-to-store-your-passwords](http://gom-jabbar.org/articles/2008/12/03/why-you-should-use-bcrypt-to-store-your-passwords)

两者都推荐 bcrypt 算法。可以在线找到大多数流行语言的免费实现。

* * *

## 回答 #8

> 赞同：3
> 
> 时间：2009-03-23T16:17:42.863

您可以在数据库中使用多个哈希值，这只需要一点额外的努力。但是，如果您认为将来极有可能需要支持其他格式，那么这是非常值得的。我会经常使用密码条目，例如

{hashId}${salt}${哈希密码}

其中“hashId”只是我在内部使用的一些数字来识别它，例如，我正在使用具有特定哈希模式的 SHA1；"salt" 是 base64 编码的随机盐；“散列密码”是一个 base64 编码的散列。如果您需要迁移哈希，您可以拦截使用旧密码格式的人，并让他们在下次登录时更改密码。

正如其他人提到的那样，您要小心您的哈希值，因为很容易做一些不太安全的事情，例如，H(salt,password) 远比 H(password,salt) 弱，但同时您想要平衡为此付出的努力与网站内容的价值。我会经常使用 H(H(password,salt),password)。

最后，与能够使用各种需要文本数据的工具的好处相比，使用 base64 编码密码的成本适中。是的，它们应该更灵活，但是你准备好告诉你的老板他不能使用他最喜欢的第三方工具，因为你想为每条记录节省几个字节吗？:-)

编辑添加另一条评论：如果我建议故意使用一种算法，该算法甚至会烧掉每个密码的 1/10 秒散列，我会很幸运被我老板的办公室一笑置之。（没那么幸运？他会记下一些东西在我的下一次年度审查中讨论。）当你有几十个甚至几百个用户时，浪费时间不是问题。如果您要推送 10 万用户，通常会有多人同时登录。你需要快速而强大的东西，而不是缓慢而强大的东西。“但是信用卡信息呢？” 充其量是虚伪的，因为存储的信用卡信息不应该在您的常规数据库附近，并且无论如何都会被应用程序加密，而不是个人用户。

* * *

## 回答 #9

> 赞同：2
> 
> 时间：2009-03-05T18:24:55.317

如果您使用 ASP.Net，您可以使用内置的会员 API。

它支持多种类型的存储选项，包括；一种方式哈希，两种方式加密，md5 + salt。[http://www.asp.net/learn/security](http://www.asp.net/learn/security)了解更多信息。

如果您不需要太花哨的东西，这对网站来说非常有用。

如果您不使用 ASP.Net，这里是 4guys 和 codeproject 的几篇文章的好链接

[http://aspnet.4guysfromrolla.com/articles/081705-1.aspx](http://aspnet.4guysfromrolla.com/articles/081705-1.aspx) [http://aspnet.4guysfromrolla.com/articles/103002-1.aspx](http://aspnet.4guysfromrolla.com/articles/103002-1.aspx) [http://www.codeproject.com/KB/security/SimpleEncryption。 aspx](http://www.codeproject.com/KB/security/SimpleEncryption.aspx)

* * *

## 回答 #10

> 赞同：2
> 
> 时间：2010-11-16T23:22:43.793

由于您的问题是关于存储方法和大小的，我将解决这个问题。

存储类型可以是二进制或文本表示（base64 是最常见的）。二进制更小，但我发现使用文本更容易。如果您正在按用户进行加盐（每个密码使用不同的盐），那么将盐 + 哈希存储为单个组合字符串会更容易。

大小取决于哈希算法。MD5的输出总是16字节，SHA1总是20字节。SHA-256 和 SHA-512 分别是 32 和 64 字节。如果您使用文本编码，您将需要更多的存储空间，具体取决于编码方法。我倾向于使用 Base64，因为存储相对便宜。Base64 将需要大约 33% 大的字段。

如果你有每个用户的盐渍，你也需要散列的空间。将它们放在一起 64 位盐 + SHA1 哈希（160 位）base64 编码需要 40 个字符，所以我将其存储为 char(40)。

最后，如果您想正确执行此操作，则不应使用单个散列，而应使用 RBKDF2 之类的密钥派生函数。SHA1 和 MD5 哈希值非常快。即使是单线程应用程序也可以每秒散列大约 30K 到 50K 的密码，这在四核机器上每秒最多可以处理 200K 密码。GPU 每秒可以散列 100 到 1000 倍的密码。以这样的速度，蛮力攻击成为一种可接受的入侵方法。RBKDF2 允许您指定迭代次数以微调散列的“慢”程度。关键不是要让系统屈服，而是要选择多次迭代，以便限制哈希吞吐量的上限（比如每秒 500 个哈希）。未来的证明方法是在密码字段中包含迭代次数（迭代 + 盐 + 哈希）。这将允许在未来增加迭代以跟上更强大的处理器的步伐。为了更加灵活，请使用 varchar 来允许将来可能更大/替代的哈希值。

.Net 实现是 RFC2892DeriveBytes [http://msdn.microsoft.com/en-us/library/system.security.cryptography.rfc2898derivebytes.aspx](http://msdn.microsoft.com/en-us/library/system.security.cryptography.rfc2898derivebytes.aspx)

# java - 同时运行多个 Netbeans RCP 应用程序实例

> ID：615708
> 
> 赞同：2
> 
> 时间：2009-03-05T17:12:12.790
> 
> 标签：java, netbeans, rcp, multiple-instances

我们有一个基于 netbeans 富客户端平台的应用程序。

默认行为是只有一个软件实例可以运行，这可以通过在启动应用程序时指定不同的用户目录作为参数来覆盖。

有没有其他选择？我们的客户依赖于能够运行应用程序的多个实例。

（如果我们不必实现我们自己的启动器来检查 netbeans 用户目录的锁以传递替代用户目录，我们会更喜欢）

netbeans RCP 中是否有内置方法可以轻松支持多个实例？

欢呼/B

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-03-11T20:59:16.173

所以，找不到合适的方法来做到这一点（似乎它可以通过一个新的启动器输入参数与 nb 7 一起使用），我的同事以一种有点骇人听闻的方式实现了它。

他创建了一个替代主类，它检查和操作 user-dir 属性，因此每个实例都有自己的 userdir。

我仍然对 netbeans 没有这个功能感到惊讶！

```
import java.io.File;

import org.netbeans.Main;

/**
 * Launches Netbeans Rich Client Platform application where mulitple instances of 
 * the application can run simultaneously for the same user.
 * <p>
 * Netbeans does not allow to run several instances of an application for the same 
 * user simultaneously, but this class does the job by fooling Netbeans.
 * If an instance is already running then a new folder is created and used for this instance.
 * </p>
 * <p>
 * This is quite tricky and this class is indeed a hack to override Netbeans behaviour.
 * An example makes it a little easier to understand, when application is first started 
 * Netbeans userdir is set from a configuration file like {@code etc/xxxxx.conf} to something like:<br>
 * {@code /home/username/.xxxxx/dev/} which includes a lock file.
 * <br>
 * If application is started again then this lock file is checked and Netbeans tries to connect to the other instance through a socket.
 * This class does the trick by never using this folder but instead creating unique directories for each instance like:<br>
 * {@code /home/username/.xxxxx/instance_01/netbeans/}<br>
 * {@code /home/username/.xxxxx/instance_02/netbeans/}<br>
 * {@code /home/username/.xxxxx/instance_03/netbeans/}<br>
 * ...
 * </p>
 * 
 */
public class MultipleInstancesMain
{
    /** Key for Netbeans default user dir */
    private static final String NETBEANS_USER = "netbeans.user";

    /** Argument to Netbeans for alternate user dir */
    private static final String USERDIR_ARG = "--userdir";

    /** Like "C:\Documents and Settings\username\Application Data\.xxxxx" or "/home/username/.xxxxx" */
    private static final File MAIN_DIR = getMainDir();

    /** Sub dir of MAIN_DIR for each instance of application */
    private static final String INSTANCE_DIR = "instance";

    /** Sub dir of INSTANCE_DIR where netbeans stores it's settings, logs and cache */
    private static final String NETBEANS_SUBDIR = "netbeans";

    /** Name of Netbeans lock file inside of NETBEANS_SUBDIR */
    private static final String LOCKFILE = "lock";

    /** Max number of instance directories we allow */
    private static final int MAX_DIR_COUNT = 999;

    /** Padding of instance dir */
    private static final String PAD = "000";
    private static final int PAD_LENGTH = PAD.length();

    /** 
     * Lock file could be present even though application is not running (after crash).
     * So we treat it as "dead" after some time, to prevent "dead directories".
     */
    private static final long LOCKFILE_MAX_AGE_IN_MILLIS = 1000L * 60L * 60L * 24L * 30L; // 30 days

    /**
     * Launches application with multiple instances support.
     * @param args command line arguments
     */
    public static void main(String[] args) throws Exception
    {
        // Get directory for this instance
        String[] userDir = new String[2];
        userDir[0] = USERDIR_ARG;
        userDir[1] = getNetbeansDir();

        // Remove default dir and set this class not to run again
        deleteDefaultNetbeansDir();
        System.clearProperty("netbeans.mainclass");

        // Start Netbeans again with new userdir and default main class
        startNetbeans(args, userDir);
    }

    /**
     * Starts Netbeans.
     * @param oldArgs command line arguments
     * @param newArgs new arguments added
     */
    private static void startNetbeans(String[] oldArgs, String[] newArgs)  throws Exception
    {
        String[] args = new String[oldArgs.length + newArgs.length];

        for (int i = 0; i <oldArgs.length; i++)
        {
            args[i] = oldArgs[i];
        }

        for (int i = 0; i < newArgs.length; i++)
        {
            args[oldArgs.length + i] = newArgs[i];
        }

        Main.main(args);
    }

    /**
     * @return the directory that Netbeans will use for this instance of the application 
     */
    private static String getNetbeansDir()
    {
        for(int i = 1; i <= MAX_DIR_COUNT; i++)
        {
            File instanceDir = getSuffixedInstanceDir(i);
            if (isLockFileFree(instanceDir))
            {
                File dirToUse = new File(instanceDir, NETBEANS_SUBDIR);
                return dirToUse.getAbsolutePath();
            }
        }

        // This would probably never happen, but we don't want an eternal loop above
        String errorMessage = String.format("Unable to find Netbeans userdir, %s dirs checked in '%s'", 
                MAX_DIR_COUNT, MAIN_DIR.getAbsolutePath());
        throw new RuntimeException(errorMessage);
    }

    private static File getSuffixedInstanceDir(int count)
    {
        String suffix = PAD + count;
        suffix = suffix.substring(suffix.length() - PAD_LENGTH);
        File suffixedDir = new File(MAIN_DIR, INSTANCE_DIR + "_" + suffix);
        return suffixedDir;
    }

    /**
     * Checks is if Netbeans lock file is free.
     * @param instanceDir directory to look for Netbeans directory and lock file in 
     * @return true if {@code instanceDir} does not have a Netbeans folder with a occupied lock file
     */
    private static boolean isLockFileFree(File instanceDir)
    {
        File netbeansDir = new File(instanceDir, NETBEANS_SUBDIR);
        File lockFile = new File(netbeansDir, LOCKFILE);

        if (lockFile.exists())
        {
            return deleteLockFileIfOldEnough(lockFile);
        }
        else
        {
            return true;
        }
    }

    /**
     * Deletes the lock file if it's old enough.
     * @param lockFile lock file to delete
     * @return true if it was deleted
     * @see #LOCKFILE_MAX_AGE_IN_MILLIS
     */
    private static boolean deleteLockFileIfOldEnough(File lockFile)
    {
        long currentTime = System.currentTimeMillis();
        long fileCreated = lockFile.lastModified();
        long ageInMillis = currentTime - fileCreated;

        if (ageInMillis > LOCKFILE_MAX_AGE_IN_MILLIS)
        {
            return lockFile.delete();
        }
        else
        {
            return false;
        }
    }

    /**
     * Netbeans is started with a default userdir, but we need to have a unique dir for each instance.
     * Main dir is the directory where directories of all instances are.
     * @return main directory in users home area where application settings, logs and cache is stored
     */
    private static File getMainDir()
    {
        String defaultNetbeansDir = System.getProperty(NETBEANS_USER);
        File mainDir = new File(defaultNetbeansDir).getParentFile();
        return mainDir;
    }

    /**
     * Since we don't use default Netbeans dir at all, we remove it completely.
     */
    private static void deleteDefaultNetbeansDir()
    {
        File defaultNetbeansDir = new File(System.getProperty(NETBEANS_USER));
        Thread t = new Thread(new DirectoryDeleter(defaultNetbeansDir), "NetbeansDirDeleter");
        t.start();
    }

    /**
     * There are unpredictable behaviour when deleting Netbeans default directory, sometime it succeeds and sometimes not.
     * But after some attempts it always succeeds, by deleting it in the background it will eventually be deleted.
     * @author username
     */
    private static class DirectoryDeleter implements Runnable
    {
        private static final long SLEEP_TIME = 3000;
        private final File dirToDelete;

        DirectoryDeleter(File dirToDelete)
        {
            this.dirToDelete = dirToDelete;
        }

        /**
         * @see java.lang.Runnable#run()
         */
        public void run()
        {
            while(!deleteDirOrFile(dirToDelete))
            {
                try
                {
                    Thread.sleep(SLEEP_TIME);
                }
                catch (InterruptedException e)
                {
                    // No idea to do anything here, should never happen anyway...
                    continue;
                }
            }
        }

        /**
         * Deletes a file or directory
         * @param dirFile directory or file to delete
         * @return true if deletion succeeded
         */
        private boolean deleteDirOrFile(File dirFile)
        {
            if (dirFile.isDirectory())
            {
                for (File f : dirFile.listFiles())
                {
                    boolean deleted = deleteDirOrFile(f);
                    if (!deleted)
                    {
                        return false;
                    }
                }
            }

            // The directory is now empty so delete it
            return dirFile.delete();
        }
    }
} 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2010-09-16T18:26:38.150

我是编写上面*MultipleInstancesMain*类的神秘开发人员 =)

作为对上述 Swati Sharma 和 uvaraj 问题的回答，这些注释可能会有所帮助：

(1) 上面的替代主类应该适用于基于 Netbeans Platform 6.5.1（我们的）构建的应用程序，其他版本我不知道。

(2) 我们将这个类保存在一个小项目中，该项目由我们应用程序的主要 build.xml ant 脚本（“套件”模块中的那个）构建。然后将 jar 复制到*/[appname]/modules/*文件夹（因此它位于 Netbeans 类路径中）

(3) 单独的项目不能是 Netbeans 模块，我猜会有循环依赖或 Netbeans 类加载器无法处理它或类似的东西。

*(4) 然后通过向配置文件/[appname]/etc/.conf*添加参数来启动我们的应用程序：

```
default_options="-J-Dnetbeans.mainclass=com.appname.startup.MultipleInstancesMain" 
```

希望它有所帮助 // Uhlén

# visual-studio - 转换cs文件编码

> ID：615719
> 
> 赞同：2
> 
> 时间：2009-03-05T17:15:29.243
> 
> 标签：visual-studio, character-encoding

我最近被要求查看 Visual Studio 解决方案。我做的第一件事就是在上面运行 SourceMonitor。但是当我试图分析它时，我得到一个错误，说 SourceMonitor 无法解析 Unicode 或 UTF 编码的文件。是否有快速将解决方案中的所有 .cs 文件转换为 ASCII 编码的方法？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-03-05T17:22:25.933

无需转换任何东西：

从[SourceMonitor 页面](http://www.campwoodsw.com/sourcemonitor.html)：

> 选项已添加到选项 | 允许使用 UTF-8 编码解析源代码文件的常规对话框。只要文件中的所有字符都由 8 位代码表示，这些文件就会正确解析。

# wsdl.exe - 使用自定义方法扩展 svcutil.exe 和 wsdl.exe

> ID：615725
> 
> 赞同：1
> 
> 时间：2009-03-05T17:17:57.927
> 
> 标签：wsdl.exe, svcutil.exe

我确实需要将一些我自己的便捷方法添加到由 wsdl.exe 和 svcutil.exe 输出的自动生成的代理文件中。我正在做的是为每个服务方法添加另一种类型的 ***Operation***Async 方法。我希望能够从这样的命令行调用工具：

**superwsdl.exe [此处为 wsdl 命令行参数]**

**supersvcutil.exe [此处为 svcutil 命令行参数]**

并让输出的文件包含我的额外方法。有谁知道这样做的方法？如果它必须是另一种格式的命令行，那也可以。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-03-13T15:29:35.773

我不确定 svcutil.exe，但 wsdl.exe 会生成 C#`partial`类。

您可以创建另一个`partial`具有相同名称的类并将额外的方法放在那里。

* * *

## 回答 #2

> 赞同：-3
> 
> 时间：2009-12-01T20:51:21.443

它应该是您编写的控制台应用程序，例如。C#，它将接受一些参数并执行以下操作：

...

```
Process svcUtil = new Process();
svcUtil.StartInfo.FileName   = "svcutil.exe";
svcUtil.StartInfo.Arguments = "... some arguments here: args[0], args[1], ...";
svcUtil.Start(); 
```

...

韦德兰

# svn - 将转储的 SVN 存储库导入 VisualSVN 服务器

> ID：615728
> 
> 赞同：8
> 
> 时间：2009-03-05T17:19:57.797
> 
> 标签：svn, import, backup, visualsvn, visualsvn-server

我已将旧计算机上的存储库转储到带有该命令的文件中。 `svnadmin dump C:\myrepo/ > mydumpfile`

现在我决定在我的新计算机上使用[VisualSVN 服务器](http://www.visualsvn.com/server/)，而不仅仅是基线颠覆。如何将我的存储库导入 VisualSVN 服务器？

* * *

## 回答 #1

> 赞同：17
> 
> 时间：2009-03-05T17:33:16.533

现在想通了，安德鲁克拉克指出有一个“所有任务”

```
Repository -> All Tasks -> Open Command Prompt

svnadmin create repository-name
svnadmin load repository-name < repository-name.dmp 
```

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2009-03-05T17:23:57.490

尝试将您的存储库复制到 C:\Repositories

或使用 Repositories -> All Tasks -> Import Existing Repository

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2014-12-12T15:44:43.510

[从VisualSVN Server 3.2](https://www.visualsvn.com/server/changes/3.2/)中实现的可移植转储文件导入：

1.  启动**VisualSVN 服务器管理器**控制台。
2.  **在Repositories**节点的上下文菜单中选择**Import Existing Repository命令。**
***   选择**从转储文件加载存储库**，单击**下一步**。*   输入转储文件的路径，然后单击**Next**。**

 **不要忘记为导入的存储库配置 SVN 权限。

![截屏](https://i.stack.imgur.com/cbKL6.png)

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2020-03-27T19:04:09.860

如果您在存储库备份的上下文中提出此问题，请考虑以下答案：[https](https://stackoverflow.com/a/12444944/761095) ://stackoverflow.com/a/12444944/761095 。

> 当您想将现有存储库导入 VisualSVN 服务器时，请阅读文章[KB10：如何将现有存储库导入新安装的 VisualSVN 服务器？](https://www.visualsvn.com/support/topic/00010/). 但是，当您将现有的 VisualSVN 服务器安装迁移到新的服务器计算机时，请阅读文章[KB166：将 VisualSVN 服务器迁移到另一台计算机](https://www.visualsvn.com/support/topic/00166/)。

您有两个选项来导入现有存储库：使用 VisualSVN 服务器管理器控制台中的**导入现有存储库向导**命令或使用[`Import-SvnRepository`](https://www.visualsvn.com/support/topic/00088/#Import-SvnRepository)PowerShell cmdlet。

## 使用 VisualSVN 服务器管理器导入存储库转储

按照以下步骤通过 VisualSVN 服务器管理器导入转储文件：

1.  启动**VisualSVN 服务器管理器**控制台。
2.  右键单击**存储库**，然后单击**导入现有存储库**。
3.  单击**从转储文件加载存储库，**然后单击**下一步**。
4.  输入转储文件的路径或单击浏览以选择它。单击**下一步**。
5.  输入新存储库的名称，然后单击**Next**。
6.  选择存储库权限并单击**Import**。等待导入过程完成。 [![在此处输入图像描述](https://i.stack.imgur.com/lmI9n.png)](https://i.stack.imgur.com/lmI9n.png)
7.  导入过程完成后，单击**完成**。 [![在此处输入图像描述](https://i.stack.imgur.com/sEFut.png)](https://i.stack.imgur.com/sEFut.png)

## 使用 PowerShell 导入存储库转储

按照以下步骤通过 PowerShell 导入转储文件：

1.  [启动**PowerShell**控制台](https://www.visualsvn.com/support/topic/00165/)。
2.  执行以下命令并等待导入过程完成：

    ```
    Import-SvnRepository PATH-TO-DUMP-FILE -DestinationName NEW-REPO-NAME 
    ```

    [![在此处输入图像描述](https://i.stack.imgur.com/eUjtb.png)](https://i.stack.imgur.com/eUjtb.png)

# regex - 二维中的正则表达式有什么好的/有趣的类似物吗？

> ID：615729
> 
> 赞同：28
> 
> 时间：2009-03-05T17:20:00.370
> 
> 标签：regex, algorithm, language-agnostic, graphics

是否有任何好的（或至少有趣但有缺陷的）类似于二维正则表达式的类比？

在一个维度上，我可以写一些东西，比如`/aaac?(bc)*b?aaa/`快速拉出一个交替`b`的 s 和`c`s 的区域，其边界至少为三个`a`s。也许同样重要的是，我可以在一个月后回来，一目了然地看到它在寻找什么。

我发现自己正在为 2d 中的类似问题编写自定义代码（一些更复杂/受约束的问题），即使我必须自己编写引擎背后的引擎，拥有更简洁和标准化的符号也会很好。

第二个示例可能称为“查找 +”。目标是定位 3 个或更多 s 的列，`a`由`b`3 个或更多 s 括起来，下面`a`有 3 个或更多`a`s。它应该匹配：

```
..7...hkj.k f
7...a  h o j 
----a--------
 j .a,g- 8 9 
.aaabaaaaa7 j
 k .a,,g- h j
 hh a----?  j
    a   hjg 
```

并且可以写成 [b^(a{3})v(a{3})>(a{3})<(a{3})] 或...

建议？

* * *

## 回答 #1

> 赞同：10
> 
> 时间：2009-03-06T00:01:08.940

不是正则表达式专家，但发现这个问题很有趣，我环顾四周，发现了这个有趣的[博客条目](http://timepedia.blogspot.com/2007/09/knowledge-extraction-with-2-dimensional.html)。尤其是用于定义 2D 正则表达式的语法看起来很吸引人。那里链接的论文可能比我告诉你更多。

**评论更新：**这里是主要作者页面的链接，您可以在其中下载链接的论文*“二维语言”*： http: [//www.mat.uniroma2.it/~giammarr/Research/pubbl.html](http://www.mat.uniroma2.it/~giammarr/Research/pubbl.html)

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2009-03-05T22:46:39.697

好问题。

首先，问问自己是否可以将模式限制为“+”模式，或者是否还需要测试/匹配矩形。例如，带有边框的*矩形*将匹配下面的中心矩形，但也会匹配 （在您的语法中）的“+”形状`[bc]``a``a``[c([bc]*a})v([bc]*a)>([bc]*a)<([bc]*a)]`

```
xxxaaaaaxxx
yzyabcba12d
defabcbass3
oreabcba3s3
s33aaaaas33
k388x.egiee 
```

如果您可以将其限制为“+”，那么您的任务会容易得多。正如 ShuggyCoUk 所说，解析 RE 通常等同于 DFSM——但对于单个串行输入，这大大简化了事情。

在您的“RE+”引擎中，您不仅要调试引擎，还要调试输入表达式的每个位置。我希望编译器能够捕获任何可能出现的错误。鉴于此，您还可以使用明确是四个 RE 的东西，例如：

```
REPlus engine = new REPlus('b').North("a{3}")
   .East("a{3}").South("a{3}").West("a{3}"); 
```

但是，根据您的实施，这可能很麻烦。

关于遍历引擎——北/西模式会匹配 RtL 还是 LtR？如果模式匹配不同或没有贪心子匹配，这可能很重要。

*顺便说一句，我认为您示例中的 '^' 应该是括号外左侧的一个字符。*

* * *

## 回答 #3

> 赞同：3
> 
> 时间：2009-03-05T17:33:43.957

正则表达式旨在为一维模式建模。据我了解，您想匹配二维字符数组中的模式。

可以使用正则表达式吗？这取决于您要搜索的属性是否可分解为可以一维匹配的组件。如果是这样，您可以在列和行上运行正则表达式，并从中查找解决方案集中的交集。根据您遇到的特定问题，这可能会解决问题，也可能会在您的二维数组中找到可能是解决方案的区域。

无论您的问题是否可分解，我认为编写一些自定义代码将是不可避免的。但至少这听起来是一个有趣的问题，所以工作应该是愉快的。

* * *

## 回答 #4

> 赞同：3
> 
> 时间：2009-03-05T17:43:31.437

您本质上是在谈论[空间查询语言](http://portal.acm.org/citation.cfm?id=512161.512186)。如果您查找空间查询、地理查询和图形查询，则有很多。空间部分通常归结为区域中具有其他给定属性的点、线和对象。可以将区域指定为多边形、与点的距离（例如圆）、与线性要素（例如道路）的距离、线性要素一侧的所有点等...然后您可以进行更复杂的查询，例如 set所有最近邻、最短路径、旅行推销员和镶嵌，如 Delaunay TIN 和 Voronoi 图。

# latex - 在 LaTeX 中添加类似 MS-Word 的注释

> ID：615738
> 
> 赞同：36
> 
> 时间：2009-03-05T17:22:19.833
> 
> 标签：latex, ms-word, comments

我需要一种将“Word 样式”的文本注释添加到 Latex 文档的方法。我不是要评论文档的源代码。我想要的是一种在文档中添加更正、建议等的方法，这样它们就不会打断文本流，但这仍然会让大家很容易知道，它们与句子的哪个部分有关. 在编译打印文档时，它们也应该“消失”。

起初，我考虑编写一个新命令，将输入转发到`\marginpar{}`，并且在编译打印时只会使定义为空。问题是您无法保证评论将出现在哪里，并且您将无法将它们与其他评论区分开来`marginpars`。

任何的想法？

* * *

## 回答 #1

> 赞同：45
> 
> 时间：2009-03-05T22:16:30.330

[`todonotes`](http://ctan.org/pkg/todonotes)是另一个可以制作漂亮标注的包。[您可以在文档](http://tug.ctan.org/tex-archive/macros/latex/contrib/todonotes/todonotes.pdf)中看到许多示例。

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2009-03-05T17:33:31.570

由于 LaTeX 是一种文本格式，如果您想以他们可以使用的方式（并从中挑选）向某人展示差异，请使用标准`diff`工具（例如，`diff -u orig.tex new.tex > docdiffs`）。这是注释 LaTeX 文档等内容的最佳方式，任何参与从 LaTeX 源生成文档的人都可以轻松使用。然后，您可以在补丁中使用标准 LaTeX 注释来解释更改，并且可以非常轻松地集成它们。如果文档存在于某种版本控制系统中，只需使用 VCS 生成可以查看的补丁文件。

* * *

## 回答 #3

> 赞同：3
> 
> 时间：2009-03-05T17:42:10.207

我的小型自制“fixme”工具`\marginpar`在可能的情况下使用，并在难以安排的地方（如字幕）内嵌。这很有效，因为我不经常将页边空白段落用于其他事情。这*确实*意味着在一切都修复之前您无法最终确定布局，但我并没有因此感到太多痛苦......

除此之外，我非常同意[Michael](https://stackoverflow.com/questions/615738/adding-ms-word-like-comments-in-latex/615770#615770)关于使用标准工具和版本控制的观点。

也可以看看：

*   [协作编辑 LaTeX 文档的提示](https://stackoverflow.com/questions/539791/tips-for-collaboratively-editing-a-latex-document/539848#539848)（解决您的主要问题......）
*   [https://stackoverflow.com/questions/193298/best-practices-in-latex](https://stackoverflow.com/questions/193298/best-practices-in-latex)

和一个自插头：

*   [如何让 Emacs 填充句子而不是段落？](https://stackoverflow.com/questions/539984/how-do-i-get-emacs-to-fill-sentences-but-not-paragraphs)

* * *

## 回答 #4

> 赞同：3
> 
> 时间：2009-03-05T22:43:24.023

我用过[`changes.sty`](http://tug.ctan.org/cgi-bin/ctanPackageInformation.py?id=changes)，它给出了基本的改变着色：

```
\添加{新文本}
\deleted{旧文本}
\replaced{新文本}{旧文本}

```

所有这些都带有一个可选参数，其中包含进行此更改的作者的首字母。这导致使用不同的颜色，并且这些首字母在更改的文本之后显示为上标。

```
\replaced[MI]{新文本}{旧文本}

```

`final`您可以通过为包提供选项来隐藏更改标记`changes`。

这是非常基本的，不支持评论，但它可能会有所帮助。

* * *

## 回答 #5

> 赞同：2
> 
> 时间：2012-01-19T23:48:20.823

你也可以试试这个[`trackchanges`](http://sourceforge.net/projects/trackchanges/)包。

* * *

## 回答 #6

> 赞同：1
> 
> 时间：2009-03-05T21:53:48.823

您可以使用[changebar 包](http://tug.ctan.org/pkg/changebar)突出显示受影响的文本区域。

如果您不想手动进行标记（这可能很乏味并且会中断编辑流程），那么整洁的[latexdiff](http://tug.ctan.org/pkg/latexdiff)实用程序将获取您的文档的差异并生成一个带有标记的版本，以直观地显示文档之间的更改排版输出中有两个版本。

这将是我的首选解决方案，尽管我尚未在大型多文件文档上对其进行测试。

* * *

## 回答 #7

> 赞同：1
> 
> 时间：2018-02-05T00:58:10.520

我知道的最好的包是**[Easy Review](https://ctan.org/tex-archive/macros/latex/contrib/easyreview?lang=en)**，它为 LaTeX 环境提供了评论功能。例如，您可以使用以下简单命令，例如`\add{NEW TEXT}`、`\remove{OLD TEXT}`、`\replace{OLD TEXT}{NEW TEXT}`、`\comment{TEXT}{COMMENT}`、`\highlight{TEXT}`和`\alert{TEXT}`。

一些例子可以在[这里](http://ctan.math.washington.edu/tex-archive/macros/latex/contrib/easyreview/doc/easyReview.pdf)找到。

* * *

## 回答 #8

> 赞同：0
> 
> 时间：2012-02-09T15:43:36.253

todonotes 包看起来很棒，但如果使用起来太麻烦，一个简单的解决方案就是使用脚注（例如，用红色将它们与常规脚注分开）。

* * *

## 回答 #9

> 赞同：0
> 
> 时间：2014-03-11T00:41:42.097

包[trackchanges.sty的工作方式与](http://trackchanges.sourceforge.net/)[changes.sty](http://tug.ctan.org/cgi-bin/ctanPackageInformation.py?id=changes)完全相同。请参阅@Svante 的回复。它具有易于记忆的命令，并且您可以在编译文档后更改编辑的显示方式。您还可以隐藏编辑以进行打印。

# wpf - WPF - 从框架内部访问框架的 BackStack 属性

> ID：615742
> 
> 赞同：0
> 
> 时间：2009-03-05T17:23:19.520
> 
> 标签：wpf, navigation

我有一个页面，它通过它的 Source 属性加载到 Frame 元素中。我需要从源 xaml 的代码隐藏中访问 Frames .BackStack 属性...这可能吗？

所以大致的代码是 -

```
<Frame x:Name="contentFrame" Source="ProjectsPage.xaml"/> 
```

在 ProjectsPage.xaml.cs 我想访问其父框架上的属性。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-03-05T20:50:32.097

如果您使用[NavigationService.GetNavigationService](http://msdn.microsoft.com/en-us/library/system.windows.navigation.navigationservice.getnavigationservice.aspx)并从 ProjectsPage 中传入一个元素，您可以在[Frame 的 NavigationService上访问](http://msdn.microsoft.com/en-us/library/system.windows.controls.frame.navigationservice.aspx)[CanGoBack](http://msdn.microsoft.com/en-us/library/system.windows.navigation.navigationservice.cangoback.aspx)和[GoBack](http://msdn.microsoft.com/en-us/library/system.windows.navigation.navigationservice.goback.aspx)之类的内容，这让您完成的工作几乎与拥有 BackStack 本身一样多。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-03-23T20:28:52.790

导航历史是 WPF 严重不足的一个领域。不，我不相信有任何方法可以从页面获取 Frame 的 BackStack。如果您不需要一般地执行此操作，则可以实施一些 hack。挂钩 Frame 的导航事件，并将附加的依赖属性设置到导航到的任何 DependencyObject 上的 Frame。不幸的是，你可以用 BackStack 做的不多，但我假设你已经确定它对于你正在做的事情已经足够好了。

# c# - LINQ2SQL 或实体框架或企业库？

> ID：615746
> 
> 赞同：1
> 
> 时间：2009-03-05T17:24:30.377
> 
> 标签：c#, design-patterns, data-access-layer

使用市场上的实体框架LINQ2SQL，使用企业库数据访问应用程序块来设计数据访问层（DAL）是否有意义？

谢谢。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2009-03-05T17:27:51.910

这就像在问“我应该使用 Dremel Rotary Tool 还是 Ingersol Rand 工业喷砂设备？”

您能描述一下您的应用程序做什么以及将在哪里使用它吗？

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2009-03-05T17:26:49.370

这真的取决于你在做什么。

我写的很多内容都是针对现有的存储过程和其他类似项目。我发现应用程序块中的 SqlHelper 非常适合我的需求，并且没有被迫改变。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2009-03-05T17:28:23.207

我一直在使用 linq2sql，它很棒。也就是说，它可以将您与 sql server 联系起来（尽管有第三方实现可以启用 linq 2 其他数据库系统）。实体框架是相当新的，但没有相同的限制。

我建议选择其中任何一个。

# sql - 您最喜欢调试 MS SQL 存储过程的方法是什么？

> ID：615747
> 
> 赞同：6
> 
> 时间：2009-03-05T17:25:38.610
> 
> 标签：sql, sql-server, debugging, stored-procedures

我的大多数 SP 都可以使用手动输入的数据简单地执行（和测试）。这很好用，使用简单的 PRINT 语句可以让我“调试”。

然而，在某些情况下，涉及多个存储过程并且查找要输入的有效数据是乏味的。从我的网络应用程序中触发事情更容易。

我对分析器有一点经验，但我还没有找到一种方法来逐行探索存储过程中发生的事情。

你的方法是什么？

谢谢你，一如既往。

注意：我假设使用 SQL Server 2005+

* * *

## 回答 #1

> 赞同：8
> 
> 时间：2009-03-05T17:40:28.807

Profiler 非常方便，只需添加 SP:StmtStarting 事件，并通过设置 SPID=xxx 将活动过滤到您的进程。设置好之后，就可以轻而易举地看到发生了什么。

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2009-03-05T17:30:00.907

您实际上可以将调试器附加到您的 sql server :) - 来自 vs，假设您已经在 sql server 上配置了它。

检查此链接以获取更多信息，注意您可以设置断点:) [https://web.archive.org/web/20090303135325/http://dbazine.com/sql/sql-articles/cook1](https://web.archive.org/web/20090303135325/http://dbazine.com/sql/sql-articles/cook1)。

检查此链接以获取更一般的信息集：http: [//msdn.microsoft.com/en-us/library/zefbf0t6.aspx](http://msdn.microsoft.com/en-us/library/zefbf0t6.aspx)

**更新：**关于*“但是，在某些情况下，涉及多个存储过程并且查找要输入的有效数据很乏味。从我的网络应用程序中触发事情更容易。”*

我建议您设置集成测试，重点关注与这些过程交互的特定方法。如果程序是由 Web 应用程序驱动的，那么这是一个可以随时运行有效测试 + 输入的好地方。如果有多个应用程序与程序交互，我会考虑对程序进行单元测试。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2009-03-05T17:30:55.413

我更喜欢只使用存储过程来检索数据集，并在应用程序端做任何复杂的“工作”。因为您是正确的，所以尝试“调试”在许多分层、游标循环、使用临时表、嵌套存储过程的内部发生的事情是非常困难的。

也就是说，[MS KB 316549](http://support.microsoft.com/kb/316549)描述了如何使用 Visual Studio 来调试存储过程。

根据这篇文章，以这种方式进行调试有许多限制：

*   您不能“中断”执行。
*   您不能“编辑并继续”。
*   您不能更改语句执行的顺序。
*   尽管您可以更改变量的值，但您的更改可能不会生效，因为变量值已被缓存。
*   不显示 SQL PRINT 语句的输出。

**编辑**：显然，如果*你*是制作这个存储过程的人，那么不要让它“许多分层、光标循环、使用临时表和嵌套”。不过，在我作为 DBA 的角色中，这几乎就是我每天从应用程序开发人员那里遇到的情况。

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2009-03-05T18:29:45.757

这个技巧非常方便：

[自定义用户可配置 Profiler 事件](http://weblogs.sqlteam.com/mladenp/archive/2008/10/16/Custom-user-configurable-SQL-Server-Profiler-events.aspx)

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2009-03-05T18:04:17.847

至于不知道有效输入是什么，您需要测试各种输入，尤其是无效输入。您应该在编写过程之前定义测试用例。然后，每次有人更改复杂流程时，您就有一组可重现的测试来运行。

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2009-03-05T18:22:08.020

我的团队按规则使用 SP 作为我们与数据库的接口；我们这样做的方式是应用程序用户只能执行 SP（使用我们的命名约定）。

我们使用的一种效果很好的最佳实践是，某些测试脚本包含在 SP 注释中，并且必须在 SP 的每个版本或新 SP 的开发中执行。

您应该始终尽可能彻底地测试 SP，而不涉及任何应用层（例如，通过 Management Studio）。

* * *

## 回答 #7

> 赞同：0
> 
> 时间：2009-07-08T14:13:09.617

确保你在VS2005/2008中进入主存储过程，当它遇到嵌套函数时，按F11（进入）进入...继续调试...从调试菜单上看不是很明显。

* * *

## 回答 #8

> 赞同：0
> 
> 时间：2009-07-08T14:16:49.880

我不喜欢调试，而是进行测试驱动开发，这几乎消除了调试的需要。

# javascript - 这是否符合您对侦听器对象的定义？

> ID：615749
> 
> 赞同：0
> 
> 时间：2009-03-05T17:26:17.500
> 
> 标签：javascript, oop, definition, listener

# 概述：

在我的项目中，所有以 DOM/HTML 呈现的**UI 组件**都存储/管理为**Component**类型的 Javascript 对象。

每个**Component** Object 都包含一个**ComponentListener**类，它监听来自**DOM/HTML 渲染**的事件，并且还*监听*它可能从**EventController**接收到的**Component***触发*的**事件** 。

 *****EventController只是另一个 Javascript 类，它实现了一个**集中***的* **发布者/订阅者模式**（或者如果您愿意，一个*集中的* **主题/观察者模式**）......*以促进解耦。*

*ComponentListener*的定义如下：

# 定义：

一个对象，它从**DOM**中的**托管元素**（由父组件对象管理）或**EventController**接收其父组件对象的事件。

 ****# 例如：

**一个ComponentListener**的实例，它可能有它的**onMouseEnter**方法，当鼠标进入代表它正在监听事件的组件对象的 <div> 元素时将调用该方法。

# 问题：

我对 ComponentListener 的定义是否被定义为另一个术语而不是 Listener？还是我要**“准确地”**将其定义为 ComponentListener？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2009-03-05T17:44:17.253

侦听器侦听**事件**，而不是组件。组件生成事件。如果您搜索事件侦听器，我相信您会找到有趣的材料。

# c# - .Net 字符串解析库，或用于解析 .Net 代码文件的正则表达式

> ID：615755
> 
> 赞同：3
> 
> 时间：2009-03-05T17:28:10.850
> 
> 标签：c#, .net, vb.net, regex, parsing

我希望能够解析 vb.net 代码文件，这样我就可以检查 Subs、Functions（及其内容，包括注释）、私有变量等的集合。

我**可以**打开实际的源代码文件。

例如，如果我有：

```
Public Function FunctionOne(arg1 As String, arg2 as String) as Integer
   here is some code
   ''//here are some comments
End Function

Public Sub FunctionOne(arg1 As integer, arg2 as integer)
   here is some code
   ''//here are some comments
End Sub 
```

我希望能够解析出所有子函数和函数以及公共函数和结束函数之间的所有代码（实际上，可以选择仅包含代码或整个函数定义。

这似乎需要某种解析库，或者相当不错的正则表达式技能。

有什么建议么？

更新：我要实现的主要目标是解析源代码，因此反射也许可以用于获取函数列表以及其他功能，我知道该怎么做，但它是一种正确的**解析**方式我试图弄清楚**的源代码。**

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2009-03-05T17:31:15.150

在运行时从你的程序编译它们，然后在编译的库上使用反射呢？

查看[这个 microsoft thread](http://support.microsoft.com/?scid=kb%3Ben-us%3B304655&x=15&y=8)了解如何做到这一点的详细信息！

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2009-03-06T06:53:15.690

您应该使用[SharpDevelop](http://www.icsharpcode.net/OpenSource/SD/Download/)附带的 NRefactory 库。

该库允许您解析 VB 或 C# 文件。它主要用于[代码转换器](http://converter.telerik.com/compare.aspx)，但也可以用于代码分析（我们公司就是这样做的）。

使用此代码：

```
Imports System

Class MainClass
  Public Function FunctionOne(arg1 As String, arg2 As String) As Integer
    Return Int32.Parse(arg1) + Int32.Parse(arg2)
  End Function

  Public Sub FunctionOne(arg1 As Integer, arg2 As Integer)
    Return
  End Sub

End Class 
```

您可以获得这种结果（我在这里使用了 NRefactoryDe​​mo 应用程序） [替代文本 http://img15.imageshack.us/img15/3564/stackoverflownrefactory.png](http://img15.imageshack.us/img15/3564/stackoverflownrefactory.png)

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2009-03-05T18:02:06.307

我认为您可以使用[Visual Basic.NET Lexical Grammar](http://msdn.microsoft.com/en-us/library/aa711638(VS.71).aspx)和解析器生成器，例如[Flex](http://en.wikipedia.org/wiki/Flex_lexical_analyser)和[Bison](http://en.wikipedia.org/wiki/GNU_bison)（在 C/C++ 中）或[Antlr](http://www.antlr.org/)（用于 .NET）之类的东西。

这就是编译器解析语言以完成其工作的方式。

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2009-03-07T00:13:20.947

这段代码很粗糙，但或多或​​少地完成了我打算做的事情：

```
Private _SourceCode As String = Nothing
Private ReadOnly Property SourceCode() As String
                Get
                    If _SourceCode = Nothing Then
                        Dim thisCodeFile As String = Server.MapPath("~").ToString & "\" & Type.GetType(Me.GetType.BaseType.FullName).ToString & ".aspx.vb"
                        _SourceCode = My.Computer.FileSystem.ReadAllText(thisCodeFile)
                    End If
                    Return _SourceCode
                End Get
End Property  

Private Function extractProcedureDefinition(ByVal procedureName As String) As String
   Return extractStringContents(Me.SourceCode, "Sub " & procedureName & "()", "End Sub", True)
End Function  

Private Function extractFunctionDefinition(ByVal procedureName As String) As String
   'TODO: This works now, but wouldn't if we wanted includeTags = False, as it does not properly handle the "As xxxxx" portion
   Return extractStringContents(Me.SourceCode, "Function " & procedureName, "End Sub", True)
End Function

    Private Function extractStringContents(ByVal body As String, ByVal openTag As String, ByVal closeTag As String, ByVal includeTags As Boolean) As String
                Dim iStart As Integer = body.IndexOf(openTag)
                Dim iEnd As Integer = body.IndexOf(closeTag, iStart)
                If includeTags Then
                    iEnd += closeTag.Length
                Else
                    iStart += openTag.Length
                End If
                Return body.Substring(iStart, iEnd - iStart)
    End Function 
```

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2009-10-15T21:57:23.763

madgnome 对我来说是正确的！我想解析 C# 代码并确定命名空间、类、成员和程序集之间的关系。NRefactory 和 NRefactoryDe​​mo 应用程序正是我解决这个问题所需要的，而且非常容易上手！

非常感谢！

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2009-03-05T17:53:03.363

我认为您正在寻找`Microsoft.CSharp.CSharpCodeProvider`，它接受一个文件并提供对 C# 代码生成器和编译器的直接访问。我想它也可以接受一个字符串。

MSDN：http: [//msdn.microsoft.com/en-us/library/microsoft.csharp.csharpcodeprovider.aspx](http://msdn.microsoft.com/en-us/library/microsoft.csharp.csharpcodeprovider.aspx)

**编辑：**

更新问题后，我发现这无关紧要，但仍然可以利用此对象从公共方法中提取源代码，如您所愿。我再调查一下...

* * *

## 回答 #7

> 赞同：0
> 
> 时间：2009-03-05T18:29:00.250

你可以编译这个东西，然后使用[反射器](http://en.wikipedia.org/wiki/.NET_Reflector)工具。我们都认为 Reflector 主要是一个 GUI 工具，它的一个简洁功能是它可以反编译 .NET 程序集。它可以从 DLL 或 EXE 生成源代码。但是 Reflector 本身可以通过程序进行控制。所以你的应用可以

*   将源代码编译成程序集
*   调用Reflector，要求它反编译
*   以编程方式摆弄 Reflector 的输出 - 获取函数列表，以及与之关联的反编译源。

[例子](http://reflectoraddins.codeplex.com/SourceControl/changeset/view/7860#19978)。

这种方法可能无法满足 - 因为您从 Reflector 获得的源不是原始源，而是反编译的源。注释会没了，反编译也不是100%忠实原著。功能上相同但不是 100% 文本相同。

总之，值得一看。

# delphi - 有多少人滥用了您的“有源”购买选项？

> ID：615766
> 
> 赞同：9
> 
> 时间：2009-03-05T17:32:13.553
> 
> 标签：delphi, components, activex

我有兴趣找到一些东西。在 Delphi 中，从一开始购买组件的默认设置就是能够通过源代码购买它们（即使它可能是一个稍微贵一点的选择）。出于多种原因，这在 Delphi 中是有意义的，首先，Borland 通过在每次安装 Delphi 时提供 VCL 的完整源代码来引领潮流，而且拥有源代码被认为是必不可少的，因为当您升级 Delphi 时，您必须重新编译，有时作者倒闭了。

我很想知道是否有任何 Delphi 组件编写者曾经有理由后悔出售他们的组件“有源代码”？是否有人试图根据您的代码发布竞争产品，或者将其作为自己的代码冒充？

我问的原因是因为在购买 ActiveX 控件或 .NET 程序集时提供“带源”选项似乎仍然是例外而不是常态。也许人们不希望源代码用于邪恶目的的保证可能会说服更多的组件编写者允许与组件一起购买源代码。

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2009-03-06T01:18:32.187

我对此有个人经验。我曾经销售 Delphi 的组件和函数库（Delphi 的 Clipper Functions，AKA CFD）；我们从 96 年的第 1 版升级到 2000 年的第 5 版，当时我接受了一份不允许兼职的工作。最终我们有5000+注册用户；我仍然为其中一些提供免费更新和偶尔的错误修复。

我从来没有任何理由不提供源代码。事实上，没有来源就没有购买差价合约的选择。由于您引用的原因（重新编译新的 Delphi 版本和供应商消失），我不会购买我的应用程序在没有源代码的情况下依赖的任何商业 Delphi 组件库。

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2009-03-05T17:36:13.857

除非组件编写者使用某种形式的混淆，否则任何 .Net 程序集的源都可以通过使用反射器获得。

我已经在 Microsoft 和其他供应商的程序集上使用它来追踪他们代码中的问题。在某些情况下，我继续修补问题并重新编译它；但这样做后果自负。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2009-03-21T17:45:23.327

对于我过去 10 年开发的所有 Delphi 组件，始终包含完整的源代码。然而，在 Delphi 中拥有兼容的二进制 (DCU) 格式（类似于 Java 和 .NET）对于试用版或低成本“个人版”（不吸引真正的商业开发人员的版本）将是一个很大的优势，因为缺少的源代码。为 Delphi 5、6、7、2006、2007 和 2009 编译 DCU 是可能的（如果有 Delphi 许可证），但是管理这么多不同的代码版本需要大量的自动构建和打包系统工作......

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2009-03-05T17:42:10.770

我有一个问题，尤其是 .Net 皮肤库。我发现没有足够好的代码以相当经济的价格包含代码。我说的是超过 1000 美元价格线的价格，我认为这对于一个自由开发者来说是天文数字，对于一个软件来说。但是，那些在每种语言中难以实现的东西也是最昂贵的，因此这两个因素之间存在着一种关系，即难以实现与您自己相似的东西。我知道这不是你的问题的答案，而是我对事物的看法。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2009-03-05T18:49:38.003

我没有这方面的个人经验，但我知道源代码水印是可用的，并且一些供应商已经使用它。不确定它会有多成功。

我从未听说过任何人发布具有来自其他商业供应商的源代码的竞争产品的消息。然而，它确实经常发生在开源项目中。

# test-data - 示例数据创建工具（主要用于数据库）

> ID：615772
> 
> 赞同：3
> 
> 时间：2009-03-05T17:33:58.340
> 
> 标签：test-data, random-sample, sample-data

我正在考虑一些数据库设计概念，并相信创建模拟我的应用程序的真实世界体积的示例数据将有助于巩固一些设计决策。

有谁知道创建示例数据的工具？如果可能的话，我正在寻找与数据库和平台无关的东西（从 MySQL 到 DB/2，从 Windows 到 UNIX），以便跨不同系统/架构测试设计。我正在设想一些您可以使用的工具：

1.  **指向数据库表（** DSN 的某些配置等）
2.  **内省字段并基于字段...**（点击或添加一些配置）
3.  **有一种表达如何创建样本数据的方法**（[MySQL Sample Data Creator](http://mysqlsampledata.enestrom.com/)是我所设想的那种东西，但我认为他们会有更多的选择，比如提交频率，以便创建非常大的数据集......数百万或数十亿行...不要认为这个工具会扩展到我想要创建的数据量）
4.  **按下按钮即可**（取决于您的参数，这可能需要很长时间）

有什么想法吗？当然，我可以编写一个应用程序来做到这一点，但它看起来很普通，我不应该重新发明轮子。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2009-03-05T18:05:00.653

[DBMonster](http://dbmonster.kernelpanic.pl/)很好，但我更喜欢[databene benerator](http://databene.org/databene-benerator)，因为我在这个类似问题的[答案中解释了它。](https://stackoverflow.com/questions/591892/tools-for-generating-mock-data/614382#614382)

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2009-03-05T17:41:11.817

像[DBMonster](http://dbmonster.kernelpanic.pl/)这样的东西？

[此页面](http://www.webresourcesdepot.com/test-sample-data-generators/)还列出了许多 DB 数据生成器。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-03-05T17:37:54.243

我无法在 MySQL 或 DB/2 方面为您提供帮助，但如果有人在需要 MS SQL Server 的情况下得到这个答案，我可以推荐Red Gate的[数据生成器。](http://www.red-gate.com/products/SQL_Data_Generator/index.htm)

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2009-05-19T12:07:48.360

我们的测试数据生成器 Datanamic DB 数据生成器可以为您做到这一点。适用于 MySQL。第一次加载表格时，它使用默认的“生成器设置”。然后，您可以“微调”这些字段和/或选择其他“生成器”。

# c# - SendKeys.发送和关闭键修饰符

> ID：615776
> 
> 赞同：1
> 
> 时间：2009-03-05T17:35:37.633
> 
> 标签：c#, keyboard, sendkeys

我想让 ^N 与树控件中的向下箭头一样工作。我想我只需要将以下内容添加到 KeyDown 处理程序中：

```
SendKeys.Send("{Down}"); 
```

但这被视为 Control-Down 箭头，因为当前按下了控制键。[msdn 页面](http://msdn.microsoft.com/en-us/library/system.windows.forms.sendkeys.send.aspx)描述了 如何打开控制修饰符，但没有描述如何关闭它。

谢谢，基思

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2009-05-21T10:02:10.597

很抱歉来晚了，但我想我找到了解决办法：

首先，导入 SetKeyboardState：

```
[DllImport("user32.dll")]
public static extern bool SetKeyboardState(byte[] lpKeyState); 
```

然后，只需在调用 SendKeys.Send() 之前用一个零字节数组调用它：

```
SetKeyboardState(new byte[256]);
SendKeys.Send("your key sequence"); 
```

这对我有用。希望这可以帮助！

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-03-26T07:15:09.617

您可以 p/invoke 到 keybd_event。这将让您模拟处于“向上”和“向下”状态的键。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-03-05T18:50:33.443

这是做这件事的艰难方法。我承认这不是最好的方法。我相信你已经知道了。您可能希望重载控件的 WindProc 方法并使用 SendMsg Win32 Api。这就是我过去让事情恢复正常的方式。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2020-09-13T19:51:30.730

您也可以尝试等到不再按下控制键，然后才`KeySend`，例如：

```
while (System.Windows.Input.Keyboard.IsKeyDown(Key.LeftCtrl))
{
    // lets try again after a while
    System.Threading.Thread.Sleep(250);
}
SendKeys.Send("{Down}"); 
```

# sql - 计算当前季度的最后一天

> ID：615778
> 
> 赞同：5
> 
> 时间：2009-03-05T17:36:12.033
> 
> 标签：sql, sql-server, coldfusion

计算当前季度最后一天的最有效方法是什么？

示例：给定日期 3/5/09，我想返回 3/31/09。

平台是 ColdFusion 和 SQL Server

* * *

## 回答 #1

> 赞同：8
> 
> 时间：2009-03-05T17:44:17.783

```
SELECT     DATEADD(qq, DATEDIFF(qq, - 1, '3/5/09'), - 1) 
```

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2009-03-05T17:52:51.243

此答案使用内置 Quarter 和 DaysInMonth 函数：

```
#createDate(year(now()), (quarter(now())*3), daysInMonth(createDate(year(now()), quarter(now())*3,1)) )# 
```

如果它打破了一点，它可能更容易阅读。

* * *

编辑（@Sam Farmer：我冒昧地将您的建议转换为 CF 函数）

```
<cffunction name="LastOfQuarter" returntype="date" output="no" access="public">
  <cfargument name="d" type="date" required="no" default="#Now()#">

  <cfset d = CreateDate(Year(d), Quarter(d) * 3, 1)>
  <cfreturn DateAdd("d", d, DaysInMonth(d) - 1)>
</cffunction> 
```

* * *

## 回答 #3

> 赞同：3
> 
> 时间：2009-03-05T17:44:27.393

这可以使用一些重构，但应该能够理解基本思想。

```
<cffunction name="lastDayOfQuarter">
   <cfargument name="d" default="#now()#">
   <cfif month(d) lte 3>
     <cfreturn createDate(year(d),03,31)>
   </cfif>
   <cfif month(d) lte 6>
      <cfreturn createDate(year(d),06,30)>
   </cfif>
    <cfif month(d) lte 9>
      <cfreturn createDate(year(d),9,30)>
   </cfif>
   <cfreturn createDate(year(d),12,31)>
 </cffunction> 
```

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2009-03-05T17:44:33.260

要从特定日期获取季度：

```
SELECT dateadd(dd,-1,dateadd(qq,1,DATEADD(qq, DATEDIFF(qq,0,<date here>), 0))) 
```

或者，如果您指的是当前季度：

```
SELECT dateadd(dd,-1,dateadd(qq,1,DATEADD(qq, DATEDIFF(qq,0,getdate()), 0))) 
```

# .net - 我可以在执行所有更新之前暂停重绘表格吗？

> ID：615781
> 
> 赞同：8
> 
> 时间：2009-03-05T17:37:00.330
> 
> 标签：.net, winforms, drawing, transparency, redraw

使用 C# 和 .Net 2.0，我使用不规则形状的表单（TransparencyKey、FormBorderStyle = None 等），并希望允许“正常”边框模式。

我将背景颜色从 Lime 更改为默认值 我将 FormBorderStyle 更改为 FixedSingle 我将 TransparencyKey 更改为 Colour.None

不幸的是，这在屏幕上看起来完全是一团糟，图像向下和向侧面跳跃了几个像素，形成了石灰绿色。

我认为这是由于在每行代码之后重新绘制表单造成的，是否可以暂停绘制表单，直到我进行更改然后重新绘制一次表单？

G

* * *

## 回答 #1

> 赞同：9
> 
> 时间：2009-03-05T17:39:54.427

新答案：覆盖 WndProc 并在应用新的 Window 属性时阻止 WM_PAINT 消息。

旧答案：覆盖 WndProc，并阻止`WM_ERASEBKGND`消息。

解释以下代码的作用：

当窗口的区域无效时，Windows 会向控件发送一系列消息，从而生成新绘制的小部件。本系列的早期信息是`WM_ERASEBKGND`. 通常，为响应此消息，控件会将自身绘制为纯色。稍后，为了响应`WM_PAINT`消息（通常由我们在 OnPaint 事件中使用），实际的绘图就完成了。如果这个绘图很重要，在小部件更新之前会有延迟，你会得到一个恼人的闪烁。

再次查看您的代码，我显然正在解决一个不同的问题。试试这个新的例子。`bAllowPaint`如果未设置标志，它将阻止窗体/控件的绘制。

新*示例*：

```
 private const int WM_PAINT = 0x000F;

    protected override void WndProc(ref Message m)
    {
        if ((m.Msg != WM_PAINT) ||
            (bAllowPaint && m.Msg == WM_PAINT))
        {
            base.WndProc(ref m);
        }
    } 
```

旧*示例*：

```
 private const int WM_ERASEBKGND = 0x0014;

    protected override void WndProc(ref Message m)
    {
        if (m.Msg != WM_ERASEBKGND) // ignore WM_ERASEBKGND
        {
            base.WndProc(ref m);
        }
    } 
```

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2009-03-05T17:39:29.777

试试 Form.DoubleBuffered 属性。将其设置为“真”。

此外，如果您的表单有任何子控件，也将 DoubleBuffered 设置为 true（以及子控件等）。

最后，在更改之前调用 SuspendLayout，之后调用 ResumeLayout。请记住，这只影响子控件的放置。如果您正在进行任何自定义绘图，DoubleBuffered 属性将为您带来更多收益。

* * *

## 回答 #3

> 赞同：4
> 
> 时间：2009-03-06T03:52:38.227

您正在修改对表单有相当大影响的属性。TransparencyKey 和 FormBorderStyle 需要更改窗口样式位。Windows 不允许更改这些样式位。Windows 窗体通过完全销毁窗口并从头开始重新创建它来实现它们。巧妙的技巧，但这需要时间，并且每次更改样式时都会重新绘制表单。造成你看到的不愉快的视觉效果。

试试这个： 1\. 将 Opacity 设置为 0，使窗体不可见 2\. 更改 BackColor，没问题 3\. 更改 FormBorderStyle，重新创建窗口 4\. 更改 TransparencyKey，重新创建窗口 5\. 将 Opacity 更改为 1，重新创建窗口，然后可见

例如：

```
 this.Opacity = 0;
  this.BackColor = Color.FromKnownColor(KnownColor.Control);
  this.FormBorderStyle = FormBorderStyle.Sizable;
  this.TransparencyKey = Color.Empty;
  this.Opacity = 1; 
```

* * *

## 回答 #4

> 赞同：3
> 
> 时间：2010-01-12T09:02:06.937

如果一切都失败了，您可以通过阻止所有绘制消息到您的表单来尝试一些低级黑客攻击。

警告：我不提倡使用这种方法，但如果你真的想尝试，你可以试试。它过去曾帮助过我。

```
Win32.LockWindowUpdate(this.Handle);
try
{
   //make your changes here
}
finally
{
  //release the lock
  Win32.LockWindowUpdate((IntPtr)0);
} 
```

此代码依赖于以下支持代码：

```
public class Win32
{
  private Win32() { }

    /// <summary>
    /// Lock ore relase the wndow for updating.
    /// </summary>
    [DllImport("user32")]
    public static extern int LockWindowUpdate(HWND hwnd);
 } 
```

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2009-03-05T17:42:24.763

一种将表单的所有“图像”一次性发送到屏幕的方法是启用 DoubleBuffer。

在构造函数中，您可以设置 ControlStyles

VB.NET：

```
SetStyle(ControlStyles.DoubleBuffer, True) 
```

# php - PHP 主机名绑定

> ID：615786
> 
> 赞同：1
> 
> 时间：2009-03-05T17:39:14.007
> 
> 标签：php, linux, email

如果我编写一个 PHP 脚本来连接到 SMTP 服务器（在我的例子中，这是本地安装的 Postfix）并发送一封电子邮件，电子邮件中的第一个“received”标头结果如下：

```
Received: from [SERVER_IP] (SERVER_HOSTNAME [127.0.0.1]) by SERVER_HOSTNAME (Postfix) with ESMTP id D682A34381 for <TO_EMAIL>; Thu,  5 Mar 2009 17:25:18 +0000 (GMT) 
```

这是因为 PHP 脚本是通过浏览器访问的，而 Apache 绑定到 SERVER_IP。

但是，如果我从 PHP CLI 执行相同的脚本，那么第一个“接收到的”标头将改为：

```
Received: from localhost.localdomain (SERVER_HOSTNAME [127.0.0.1]) by SERVER_HOSTNAME (Postfix) with ESMTP id AB51934381 for <TO_EMAIL>; Thu,  5 Mar 2009 17:18:01 +0000 (GMT) 
```

这是因为普通 Linux 用户（通过 cron）正在调用 PHP CLI。

如何使 PHP CLI 绑定到主机名/IP，以便当用户通过 cron 作业调用它时，“received”标头显示服务器主机名/IP 而不是 localhost.localdomain？

**注1：**主机名正确设置在主机名--fqnd、/etc/hosts、/etc/sysconfig/network和/proc/sys/kernel/hostname

**注意 2：**我在 PHP 中使用[Swift Mailer](http://www.swiftmailer.org/)，尽管这可能无关紧要。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2009-03-05T17:53:49.837

我相信如果您不通过本地主机地址连接到服务器，而是通过其分配的真实IP地址或完全限定的域名连接，它会更好地工作。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-03-06T17:38:37.883

认真考虑使用 Swift Mailer 的“NativeMail”甚至“Sendmail”界面。

这两个选项都将避免网络流量、内部 IP 地址和有问题的 Received 标头。它们也将明显更快，这对您可能很重要。

如果您坚持使用 SMTP，请注意 Swift 使用`$_SERVER["SERVER_ADDR"]`不会由 CLI 设置的变量“自动检测”本地主机名（在 SMTP 对话框中提供）。

如果你不能让 this 获得更好的值，你可以将它作为第二个参数传递给 Swift 构造函数，如下所示：

```
$swift = new Swift(new Swift_Connection_SMTP("localhost"), "my_domain_here"); 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-05-28T18:32:13.227

这是我用来将主机名的值放入我的 crons 的一些 php 代码：

```
//get hostname info from /etc/sysconfig/network
preg_match('/HOSTNAME=(.*)/', file_get_contents('/etc/sysconfig/network'), $network);
$hostname = split("\=", $network[0]);
echo $hostname[1]; //this equals the value of your HOSTNAME 
```

# c# - 如何在设计时 (C#) 隐藏一些默认控件属性？

> ID：615791
> 
> 赞同：12
> 
> 时间：2009-03-05T17:40:46.030
> 
> 标签：c#, .net, winforms, user-controls

我有一个我制作的自定义控件。它继承自`System.Windows.Forms.Control`，并具有我添加的几个新属性。是否可以显示我的属性（例如 TextOn 和 TextOff）而不是默认的“文本”属性。

我的控件工作正常，我只想整理属性窗口。

* * *

## 回答 #1

> 赞同：15
> 
> 时间：2009-03-05T17:46:30.883

您可以覆盖它们（如果它们可以被覆盖）并应用[`Browsable`](http://msdn.microsoft.com/en-us/library/system.componentmodel.browsableattribute.aspx)属性，指定`false`，或创建属性的新版本并应用相同的属性（第二种方法似乎并不总是有效，所以 YMMV）。

此外，您可以[`TypeConverter`](http://msdn.microsoft.com/en-us/library/system.componentmodel.typeconverter.aspx)为您的类型使用自定义并覆盖该[`GetProperties`](http://msdn.microsoft.com/en-us/library/system.componentmodel.typeconverter.getproperties.aspx)方法以控制为您的类型显示哪些属性。这种方法对底层基类的变化更加健壮，但可能需要更多的努力，具体取决于您想要实现的目标。

我经常使用[`Browsable`](http://msdn.microsoft.com/en-us/library/system.componentmodel.browsableattribute.aspx)属性和自定义的组合[`TypeConverter`](http://msdn.microsoft.com/en-us/library/system.componentmodel.typeconverter.aspx)。

* * *

## 回答 #2

> 赞同：6
> 
> 时间：2009-03-06T17:36:51.583

覆盖该属性并添加`[Browsable(false)]`.

您可能还需要添加`[EditorBrowsable(EditorBrowsableState.Never)]`，这将在代码编辑器中隐藏 IntelliSense 中的属性。请注意，它只会隐藏在与原始控件不同的解决方案中。

* * *

## 回答 #3

> 赞同：4
> 
> 时间：2011-09-14T09:41:27.080

使用 System.ComponentModel；

```
[Browsable(false), DesignerSerializationVisibility(
                            DesignerSerializationVisibility.Hidden)]
public int MyHiddenProp {get; set; } 
```

以这种方式为我工作，它不会出现在设计器属性中，并且设计器不会初始化该属性，这将覆盖我自己的初始化......

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2009-03-05T17:48:52.780

您正在寻找[设计时属性](http://msdn.microsoft.com/en-us/library/tk67c2t8(VS.71).aspx)，特别是[BrowsableAttribute。](http://msdn.microsoft.com/en-us/library/system.componentmodel.browsableattribute(VS.71).aspx) [DefaultPropertyAttribute](http://msdn.microsoft.com/en-us/library/system.componentmodel.defaultpropertyattribute(VS.71).aspx)设置哪个属性是要编辑的默认属性。

# sql - 清空自引用 MySQL 表的最佳方法是什么？

> ID：615797
> 
> 赞同：21
> 
> 时间：2009-03-05T17:42:00.753
> 
> 标签：sql, mysql, truncate, self-reference

我有一个带有递归 parent_id 的自引用 MySQL 表：

```
CREATE TABLE `recursive` (
  `id` int(11) NOT NULL auto_increment,
  `parent_id` int(11) default NULL,
  `name` varchar(100) NOT NULL,
  PRIMARY KEY  (`id`),
  KEY `data_categorysource_parent_id` (`parent_id`),
  CONSTRAINT `parent_id_refs_id_627b4293`
    FOREIGN KEY (`parent_id`) REFERENCES `data_categorysource` (`id`)
) ENGINE=InnoDB DEFAULT CHARSET=utf8 
```

在测试期间，我想清空它但 TRUNCATE 失败：

```
TRUNCATE `recursive` 
/* SQL Error: Cannot delete or update a parent row: a foreign key
constraint fails... 
```

我目前必须手动删除所有记录，从树的底部开始向上工作。即使是小树，这也会变得繁重。

有没有简单的方法解决这个问题？当其他表引用它时，我不能`DROP`轻松地重新创建表并重新创建它（我已经截断了这些表，因此那里不应该存在数据完整性问题）。

* * *

## 回答 #1

> 赞同：36
> 
> 时间：2009-03-05T17:47:15.437

为什么不：

```
UPDATE 'recursive' SET 'parent_id' = NULL WHERE 'parent_id' IS NOT NULL;
DELETE FROM 'recursive'; 
```

?

* * *

## 回答 #2

> 赞同：18
> 
> 时间：2009-03-05T18:39:48.277

如果您只想清空整个内容以进行测试，请使用：

```
SET FOREIGN_KEY_CHECKS = 0;

// Execute Query

SET FOREIGN_KEY_CHECKS = 1; 
```

这完全绕过了任何外键检查。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2009-03-05T17:47:07.170

好吧，您可以`ON DELETE CASCADE`在`FOREIGN KEY`定义中添加一个……至少是暂时的。这将允许您通过首先删除引用的行来截断表。

还有其他[`ON DELETE`](http://dev.mysql.com/doc/refman/5.1/en/innodb-foreign-key-constraints.html)类型；默认为`ON DELETE NO ACTION`.

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2009-03-05T17:50:20.937

或者只是删除（递归）外键约束，然后截断表，然后重新添加约束。

* * *

## 回答 #5

> 赞同：-1
> 
> 时间：2009-03-05T17:47:36.093

反复选择不显示为父级的行并删除它们，直到表为空。（假设没有循环......）

* * *

## 回答 #6

> 赞同：-2
> 
> 时间：2013-12-19T13:11:04.333

从 table_1 中删除其中 date(table_1_TIME) < (select T.t_Date from (select max(date(table_1_TIME)) as t_Date from table_1 ) as T)

# vmware - 是否可以让 ntpd 在虚拟机上工作？

> ID：615802
> 
> 赞同：4
> 
> 时间：2009-03-05T17:43:05.930
> 
> 标签：vmware, virtual-machine

我们的开发团队最近才开始使用虚拟机进行开发，我们遇到的一个问题是保持时钟同步。我记得过去有一个 ntpd 无法在虚拟机上运行的问题。我还记得将 ntpdate 作为 cron 放入不是一个好主意。所以我的问题是，还有其他解决方案吗？还是我被困在 ntpdate 到 crontab 中？

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2009-03-05T17:54:23.953

时间在虚拟环境中稍微复杂一些。我建议阅读有关计时的[vmware 白皮书。](http://www.vmware.com/pdf/vmware_timekeeping.pdf)

他们已经非常彻底地考虑了这个问题，包括推荐的 ntp 选项和使用 vmware 工具的时间支持。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2009-03-05T17:52:46.470

安装 VMWare 工具并设置

tools.syncTime = "真"

在您的 *.vmx 文件中，它位于您的 vm 安装目录中

[Vmware-Tools 和时间同步](http://sarwiki.informatik.hu-berlin.de/Vmware-Tools_and_time_synchronization)

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2009-03-06T20:36:50.340

我们在 RHEL 4.6 上[的 Linux 客户机中使用 VMware 的最佳计时实践取得了非常好的结果](http://kb.vmware.com/selfservice/microsites/search.do?language=en_US&cmd=displayKC&externalId=1006427)

基本上有几个建议：

*   安装 VMware 工具
*   根据您的发行版，修改一些内核参数
*   启用和使用 NTP

还有一个[计时知识库条目](http://blogs.vmware.com/kb/2009/02/new-timekeeping-articles.html)列表。

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2009-03-05T17:50:19.970

NTP 在虚拟机中不起作用。时期。虚拟机时钟是……虚拟的。它的行为不像真机的时钟，NTP 依赖于它才能正常工作。

但是您应该在 VM 中安装的来宾驱动程序应该负责时钟同步。至少对于 VirtualBox 和 IIRC，VMWare 的工作方式相同。您是否安装了客户机驱动程序？

# javascript - 边距和填充导致计算布局问题

> ID：615813
> 
> 赞同：1
> 
> 时间：2009-03-05T17:45:30.467
> 
> 标签：javascript, css, padding, margin, offset

我遇到了这个问题，我没有在 IE6 中获得真正的偏移量。我正在使用偏移量来定位弹出窗口。

CSS是这样的：

```
.container50-50-right-border              { }
.container50-50-right-border .title       {padding: 0px; margin: 0px;
                                           clear: both;}
.container50-50-right-border .leftcolumn  {width: 47%; float: left;
                                           display:inline;}
.container50-50-right-border .rightcolumn {width: 48%; float: left;
                                           display:inline;
                                           border-left: 1px solid #D6D7DE;
                                           padding: 0px 0px 0px 10px;
                                           margin: 0px 0px 0px 10px;}
.container50-50-right-border .description {clear: both;} 
```

当我从

```
.container50-50-right-border .rightcolumn 
```

它的表现要好一些，但并不完美。定位代码经过了很好的测试，所以我认为不是这样。

抱歉，代码量很少。任何帮助，将不胜感激。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-03-18T16:50:04.037

请记住，IE 将根据它所处的渲染模式（Quirks 模式与标准模式）切换盒子模型。验证您使用的 Doctype 是否将 IE 置于 Strict 模式，否则它用于定位的框模型将不是标准的 W3C 模型。

[http://www.quirksmode.org/css/quirksmode.html](http://www.quirksmode.org/css/quirksmode.html)

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-03-06T01:07:46.127

我用你的 CSS、你评论中的 javascript 和一些组成的 HTML 做了一个简单的测试来测试这个。我添加了`showDiv`要测试的功能

```
<script type='text/javascript'>
function getPositionLeft(This){
    var el = This;
    var pL = 0; 
    while(el){pL+=el.offsetLeft;el=el.offsetParent;} 
    return pL;
}

function getPositionTop(This){ 
    var el = This;
    var pT = 0; 
    while(el){pT+=el.offsetTop;el=el.offsetParent;} 
    return pT;
}

function showDiv(c){
    var d3 = document.getElementById('3');
    d3.style.position = 'absolute';
    d3.style.left = (getPositionLeft(document.getElementById('test')) + 10) + 'px';
    d3.style.top = (getPositionTop(document.getElementById('test')) + 20) + 'px';
}
</script>

<style>
.container50-50-right-border {width: 600px;}
.container50-50-right-border .title {padding: 0px; margin: 0px; clear: both;}
.container50-50-right-border .leftcolumn {width: 47%; float: left; display:inline; border: 1px solid blue;}
.container50-50-right-border .rightcolumn {width: 48%; float: left; display:inline; border-left: 1px solid #D6D7DE; padding: 0px 0px 0px 10px; margin: 0px 0px 0px 10px;}
.container50-50-right-border .description {clear: both;}
</style>

<div class="container50-50-right-border">
    <div class="leftcolumn" id="1">1</div>
    <div class="rightcolumn" id="2"><a href="test" id="test" onclick="showDiv(); return false;">test</a></div>
</div>
<span id="3" style="background: black; color: white;">move me</span> 
```

我在IE6中测试过，定位很好。你能提供更多代码吗，也许是 HTML 和 JavaScript？

# iphone - 运行时的 iPhone 视图？

> ID：615814
> 
> 赞同：1
> 
> 时间：2009-03-05T17:45:32.213
> 
> 标签：iphone, objective-c, cocoa-touch, mobile

我是 iPhone SDK 的新手，正在尝试创建 3 个视图并在它们之间切换。数据将来自服务器，我基本上将显示 1 个视图并缓存另外两个。到目前为止，我只是想创建一个视图并在运行时显示它。我的代码在下面列出。它只显示一个空白屏幕，我想我错过了一个关键概念。有什么帮助吗？

```
#import <UIKit/UIKit.h>
#import "ImageViewController.h"
@interface Test5ViewController : UIViewController 
{
    IBOutlet UIView *rootView;
    ImageViewController *curImage;
    ImageViewController *nextImage;
    ImageViewController *prevImage;
}

@property(nonatomic,retain) IBOutlet UIView *rootView;
@property(nonatomic,retain) ImageViewController *curImage;
@property(nonatomic,retain) ImageViewController *nextImage;
@property(nonatomic,retain) ImageViewController *prevImage;

@end 
```

和

```
- (void)loadView 
{

    self.curImage = [[ImageViewController alloc]initWithNibName:@"ImageView" bundle:[NSBundle mainBundle]];
    UIImage *pic = [UIImage imageNamed:@"baby-gorilla.jpg"];
    [self.curImage assignImage:pic];
    self.rootView = self.curImage.view;

} 
```

和

```
#import <UIKit/UIKit.h>

@interface ImageViewController : UIViewController 
{
    IBOutlet UIImageView *image;
}

-(void)assignImage:(UIImage *)screenShotToSet;

@property(nonatomic,retain) IBOutlet UIImageView *image;

@end 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-03-05T18:18:47.203

欢迎使用 iPhone SDK！

通常，有两种方法可以显示任何视图。

首先，也是最常见的，您使用由 Interface Builder 创建的 NIB 文件。这通常是最简单的入门方法，我建议您在这里尝试使用它。描述您需要执行的所有步骤太冗长了，但基本上从 xcode 开始，创建一个新文件并选择“用户界面”并选择查看 XIB。这将创建一个基本的 NIB 文件（由于历史原因，它们被称为 NIB 而不是 XIB）。界面构建器的第一步是将“文件所有者”的类名更改为您的 UIViewController 子类（Test5ViewController）。然后，您可以将 IB 允许的任何内容拖放到视图窗口中，甚至可以将预先提供的视图对象替换为您自己的视图对象。这是诀窍：确保视图出口（由 UIViewController 超类提供）连接到视图。完成此操作后，该视图将在您的 NIB 加载时自动加载。然后，您可以将 UIViewController 子类 (Test5ViewController) 放在 MainWindow.xib NIB 文件中以获取*它会*自动加载，然后您就开始营业了。

现在，你在这里做的方式是第二种方式。有些人喜欢一直这样编码，而不是用户界面构建器。虽然有时它肯定是必要的，而且总是更灵活，但它会让你更好地理解正在发生的事情。可能还有其他事情，但是您缺少的主要内容是在上面的代码中，您没有将视图添加到视图层次结构中。您需要首先检查您是否有一个 UIApplicationDelegate 子类，并且它需要加载您的“根” UIViewController 类。xcode 中的所有初始项目创建类型都执行此操作（基于窗口的应用程序除外）。它是这样的代码：

```
[window addSubview:rootController.view]; 
```

完成此操作后，如果您的视图控制器没有被 NIB 加载（上面简要描述），您的 loadView 方法将被调用，期望您构建自己的视图层次结构。上面，您创建了视图，但未能将它们放入层次结构中。你需要类似的东西：

```
[self.view addSubview:curImage.view]; 
```

在添加到视图层次结构之前，不会呈现任何视图。确保在文档中查找 UIView 类，并了解向视图层次结构添加和删除视图的各种方法。

我应该警告您几件事： *您上面的代码正在泄漏。您需要查看 Objective-C 属性的工作原理。这个网站上有很多关于它的内容。比我有时间在这里写的更多。* 如果您在此处，请不要创建 rootView 属性。超类（UIViewController）中已经有一个。这只是“视图”。用它来保存你的根视图。

我希望这可以帮助您入门。一开始可能会令人困惑，但你很快就会开始的！我建议在执行“真实”应用程序之前构建、重写和重新构建大量示例代码。SDK 有很多很棒的示例。

# concurrency - 具有多个数据集的 RDL 中的线程安全

> ID：615815
> 
> 赞同：0
> 
> 时间：2009-03-05T17:46:26.110
> 
> 标签：concurrency, reporting-services

我有一个包含多个数据集的 RDL，并且填充数据集的存储存储过程创建和删除具有相同名称的临时表。

这份报告已经运行了 1000 次，没有任何问题，但我想知道是否有竞争条件等待发生。原则上，两个存储过程可以在同一连接上并行执行，并且两个过程都尝试创建/删除具有相同名称的相同临时表——我没有测试过这个说法，我只是在推测。

**RDL 中的多个数据集是否在同一连接上并行执行？**

**如果我的报告中存在并发问题，我该如何解决？**

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-03-05T19:09:18.657

只要它们不是`##<tablename>`全局临时表，就可以了。常规临时表`#<tablename>`是特定于会话的。两个不同的调用将各自`#<table>`在 tempdb 中保留自己的版本，名称如下`#table___________________________________________92343ABE452DC`

# git - Git：如何获取 git 存储库的快照

> ID：615816
> 
> 赞同：37
> 
> 时间：2009-03-05T17:46:26.237
> 
> 标签：git, archive, snapshot

我正在寻找正确的方法来获取没有 .git/ 目录的 git 存储库存档，以便将每日快照发送给测试人员。

* * *

## 回答 #1

> 赞同：53
> 
> 时间：2009-03-05T17:50:04.590

```
git archive HEAD --format=zip > archive.zip 
```

这就像它在锡上所说的那样。

更多信息在这里： http: [//gitready.com/intermediate/2009/01/29/exporting-your-repository.html](http://gitready.com/intermediate/2009/01/29/exporting-your-repository.html)

* * *

## 回答 #2

> 赞同：14
> 
> 时间：2011-05-27T11:50:25.720

这将导致 archive.tar.gz 并添加一个名为“prefix-dir”的前缀目录：

```
git archive --prefix=prefix-dir/ -o archive.tar HEAD
gzip archive.tar 
```

# visual-studio-2008 - 卸载 Visual Studio 2008 Team System 的演示/试用版

> ID：615818
> 
> 赞同：3
> 
> 时间：2009-03-05T17:46:52.567
> 
> 标签：visual-studio-2008, windows-installer

我希望卸载 VS 2008 Team System 的试用版，因为试用期即将结束。我在机器上安装了 VS 2008 专业版，但它仍然显示在添加/删除问题中。

我希望当我卸载 VS 2008 Team System 时，我会留下一个工作正常的 VS 2008 专业版。

当我尝试卸载 VS 2008 Team System 时，我很快收到一个错误对话框，上面写着：

> 加载设置组件时遇到问题。取消设置。

**帮助！**

**进展或不足**

我在命令提示符下完成了 dir %temp%*.log 并且可以看到任何最近的日志文件

我将阅读[http://en.wikipedia.org/wiki/Windows_Installer#Diagnostic_logging](http://en.wikipedia.org/wiki/Windows_Installer#Diagnostic_logging)看看我是否可以获得任何日志记录

Aaron Stebner 的 WebLog 有一篇关于[VS put 的日志文件在哪里](http://blogs.msdn.com/astebner/archive/2007/07/31/4156781.aspx)的帖子，他还有一篇[关于是否将其他一些产品放在那里的日志文件](http://blogs.msdn.com/astebner/archive/2008/02/27/7927123.aspx) 提供了一些关于 VS 设置将它的日志放在哪里的信息等

在我将日志文件发送给 Aaron Ruckman 后，Aaron Ruckman 为我提供了解决方案。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2009-03-06T15:32:37.763

嗨，您的问题可能与发布在[http://blogs.msdn.com/heaths/archive/2008/10/06/adding-features-to-visual-studio-2008-may-fail-to-上的问题有关加载设置组件.aspx](http://blogs.msdn.com/heaths/archive/2008/10/06/adding-features-to-visual-studio-2008-may-fail-to-load-setup-components.aspx)

基本上发生的事情是您仍然安装了 Pro 试用版并且它即将到期。所以您需要做的是转到“添加/删除程序”并卸载 Microsoft Visual Studio Pro 2008 试用版。您不必触摸您的 Microsoft Visual Studio Team Suite 版本。

如果这不起作用，请随时给我发电子邮件 aaronru(a)microsoft.com。当您这样做时，请使用此处描述的工具[http://blogs.msdn.com/heaths/archive/2008/05/09/visual-studio-and-net-log-collection-utility.aspx](http://blogs.msdn.com/heaths/archive/2008/05/09/visual-studio-and-net-log-collection-utility.aspx)收集您的日志和将它们上传到某个地方，然后给我发送一个链接。

谢谢！

亚伦·拉克曼

项目经理

视觉工作室

微软公司

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2009-03-13T15:51:53.390

正如博客中提到的那样[http://blogs.msdn.com/heaths/archive/2008/10/06/adding-features-to-visual-studio-2008-may-fail-to-load-setup-components.aspx](http://blogs.msdn.com/heaths/archive/2008/10/06/adding-features-to-visual-studio-2008-may-fail-to-load-setup-components.aspx)，我尝试使用解决方法，但似乎安装程序错误地确定了可用磁盘空间（我电脑上的 C 驱动器有 5 GB 的可用空间，但安装程序将其计算为 5MB 并且没有继续安装！）

所以我使用了 HOTFOX [http://code.msdn.microsoft.com/KB959417/Release/ProjectReleases.aspx?ReleaseId=2201](http://code.msdn.microsoft.com/KB959417/Release/ProjectReleases.aspx?ReleaseId=2201)并且它有效。

谢谢（你的）信息。萨米尔

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-03-05T17:56:16.507

我有一个类似的问题，不幸的是我不相信我找到了不需要重新安装 VS 2008 专业版的解决方案。

基本上我使用了以下工具：

[自动卸载工具](http://msdn.microsoft.com/en-us/vstudio/bb968856.aspx)

然后手动从添加/删除程序中删除与 Visual Studio 相关的任何内容。

请注意，当我搜索错误报告时，第一页上有一个 stackoverflow 问题： [Visual Studio 设置问题](https://stackoverflow.com/questions/114332/visual-studio-setup-problem-a-problem-has-been-encountered-while-loading-the-s)

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2009-06-02T15:44:40.900

我遇到了同样的问题，我通过运行 %Program Files%\C:\Program Files\Microsoft Visual Studio 9.0\Microsoft Visual Studio Team System 2008 Team Suite - ENU\ 文件夹中的设置文件来修复 ti。

我能够删除安装。

# java - JRuby 准备好投入生产了吗？

> ID：615825
> 
> 赞同：6
> 
> 时间：2009-03-05T17:49:47.397
> 
> 标签：java, ruby-on-rails, jruby

我刚刚发现了**JRuby**，我喜欢在 Rails 上运行 Ruby 并能够调用 Java 库的想法。

我想了解一些在 JRuby 中运行企业生产应用程序的经验。稳定性和性能是否可以接受？

谢谢。

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2009-03-05T18:02:11.330

这是一家公司的博客文章，该公司使用 JRuby 创建了一个跨平台、多线程、桌面模拟应用程序。我认为他们的成功表明 JRuby 已经为企业生产应用程序做好了准备。

[http://spin.atomicobject.com/2009/01/30/ruby-for-desktop-applications-yes-we-can](http://spin.atomicobject.com/2009/01/30/ruby-for-desktop-applications-yes-we-can)

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-03-05T18:45:49.400

其实也挺快的。我不确定它们现在如何比较，但是随着新的动态调用字节码添加到 JVM，它应该成为迄今为止最快的实现。

Groovy 和 Grails 也应该很快会因此而获得巨大的速度提升。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2009-11-11T19:10:22.723

我们在公司的一个大型项目中使用它。我们发现的主要问题是没有像 Java 或 .Net 那样围绕该技术构建的大型社区。这使得招聘变得困难。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2009-03-05T22:47:03.487

JRuby 是目前最快的 Ruby 实现之一，并且绝对可以用于生产。

以下是来自 jruby.org 的一些“成功案例”：

[http://wiki.jruby.org/wiki/Success_Stories](http://wiki.jruby.org/wiki/Success_Stories)

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2009-03-07T07:24:14.483

杰森塞弗说是的。他关于 Ruby VM 的演讲在 InfoQ 上。

了解不同的 Ruby 虚拟机（JRuby、MagLev、IronRuby、Rubinius、MacRuby）以及如何选择最适合企业的虚拟机。

[http://www.infoq.com/presentations/seifer-ruby-vm-comparison](http://www.infoq.com/presentations/seifer-ruby-vm-comparison)

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2010-01-05T14:25:14.480

JRuby Wiki 已移至 Kenai。现在可以在此处找到成功案例页面：

[http://kenai.com/projects/jruby/pages/SuccessStories](http://kenai.com/projects/jruby/pages/SuccessStories)

# wpf - 如何在 WPF 中为用户控件允许多个项目/内容？

> ID：615826
> 
> 赞同：1
> 
> 时间：2009-03-05T17:49:48.753
> 
> 标签：wpf, user-controls

我已经设法将内容重定向到我的堆栈面板，如图所示：

```
<UserControl 
x:Name="taskItem">
<UserControl.ContentTemplate>
    <DataTemplate>
        <StackPanel>
            <Label x:Name="labelHeader" Content="{Binding ElementName=taskItem,Path=Header}" FontFamily="Tahoma" FontSize="16" FontWeight="Bold" />
            <Border BorderThickness="0,1,0,0" BorderBrush="#999999" Margin="5,0,5,0">
                <StackPanel Margin="10,5,0,0">
                    <ContentPresenter Content="{TemplateBinding Content}" />
                </StackPanel>
            </Border>
        </StackPanel>
    </DataTemplate>
</UserControl.ContentTemplate> 
```

我正在尝试创建一个控件，该控件具有标题、其下的一行，然后是 N 个子内容。但是，在当前的实现中，它不允许超过一个。

我在这里做错了什么？

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2009-03-05T18:49:20.843

根据定义，用户控件有一个子控件，因为它继承自 ContentControl。使用户控件具有所有标题，然后使 ItemsControl 成为 UserControl 的内容。将 DataTemplate 应用到 ItemsControl 的 ItemTemplate 属性。

```
 <UserControl x:Class="WindowsApplication1.UserControl1"
    xmlns="http://schemas.microsoft.com/winfx/2006/xaml/presentation"
    xmlns:x="http://schemas.microsoft.com/winfx/2006/xaml">
    <Grid>
      <Grid.RowDefinitions>
        <RowDefinition Height="Auto" />
        <RowDefinition Height="*" />
      </Grid.RowDefinitions>
      <Grid Name="MainHeadersGrid" Grid.Row="0">
        <TextBlock Text="Put your headers here" />
      </Grid>

      <ItemsControl Name="childItemsWillGoInHere"  ItemsSource="{Binding}" Grid.Row="1">
        <ItemsControl.ItemTemplate>
          <DataTemplate>
            <TextBlock Text="{Binding PropertyOfItem}" />
          </DataTemplate>
        </ItemsControl.ItemTemplate>
      </ItemsControl>

    </Grid>
</UserControl> 
```

现在，将 UserControl 模板的 DataContext 分配给要显示的对象的集合。

# asp.net - IIS 404 自定义错误未按预期工作

> ID：615829
> 
> 赞同：11
> 
> 时间：2009-03-05T17:50:05.417
> 
> 标签：asp.net, iis, iis-6

我正在研究 IIS6、ASP.NET、VS2008。该网站使用自定义错误处理程序来捕获 404 错误并提供备用页面。当出现以下形式的 url 时：

**[http://srv/crimson/articles/index](http://srv/crimson/articles/index)**

一切都很完美。但形式的网址：

**[http://srv/crimson/blog.aspx](http://srv/crimson/blog.aspx)**

如果 blog.aspx 不存在，则失败并显示以下消息：

“/Crimson”应用程序中的服务器错误。说明：HTTP 404...

当我尝试调试时，我的 404 处理程序中没有一个断点被命中。因此，似乎有些东西更早地捕获了请求。在哪里？以及如何让它将请求传递给我的处理程序？

**编辑** 感谢那些回答的人，但这些想法都没有奏效。我决定以另一种方式解决这个问题。

* * *

## 回答 #1

> 赞同：10
> 
> 时间：2009-03-05T20:35:03.757

你可能想试试这个：

在 IIS6 中：

*   为您的网站打开“属性”
*   转到“主目录”选项卡
*   点击“配置”
*   寻找扩展名“.aspx”
*   点击“编辑”
*   选中“验证该文件是否存在”复选框

*编辑*

那么这个呢：http: [//msdn.microsoft.com/en-us/library/h0hfz6fc (VS.80).aspx](http://msdn.microsoft.com/en-us/library/h0hfz6fc(VS.80).aspx)

```
<customErrors defaultRedirect="sorry.htm" mode="On">  
     <error statusCode="404" redirect="NotFound.aspx"/>
</customErrors> 
```

因为 'RemoteOnly' 指定自定义错误只显示给远程客户端，而 ASP.NET 错误显示给本地主机。

* * *

## 回答 #2

> 赞同：7
> 
> 时间：2009-03-05T20:23:47.887

嗯，Assaf 是对的，但要添加到他的答案中，我需要发布一些代码。

是的，Assaf 确实意味着 ASP.NET 提供了它自己的错误处理，通过[web.config](http://msdn.microsoft.com/en-us/library/h0hfz6fc.aspx)配置。您可以通过 IIS Admin 管理单元或直接在 web.config 文件中进行管理。

在 <system.web> 元素中，您应该有：

```
<customErrors defaultRedirect="sorry.htm" mode="RemoteOnly">
  <error statusCode="404" redirect="NotFound.aspx"/>
</customErrors> 
```

您可以为每个 HTTP 错误代码配置不同的页面，或者让默认重定向处理它们。

您会发现确实需要在 IIS 自定义错误和 ASP.NET 配置中设置这些错误页面**，**否则您最终会遇到这种情况 - 一些页面转到 404，而其他页面使用默认你没有自定义。

您还应该确保您的自定义 404 页面实际上返回一个 404 标头，以确保搜索引擎等正确处理它。

```
Response.StatusCode = 404;
Response.StatusDescription = "Not found"; 
```

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2009-03-05T17:54:56.293

ASP.Net 有自己的自定义错误配置。

转到虚拟目录（Web 应用程序）的 ASP.Net 配置，然后右键单击 -> ASP.Net -> 编辑配置 -> 自定义错误。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2009-03-07T11:08:26.970

也许您得到了 500，因此不会触发 404 的重定向。您可能首先关注这个 500 错误。

# compiler-construction - VB6 应用消失得无影无踪：PCCode 和 Native Code 之间的切换会产生影响吗？

> ID：615834
> 
> 赞同：0
> 
> 时间：2009-03-05T17:51:50.527
> 
> 标签：compiler-construction, vb6, stability

我知道这个主题已经在新闻组中被写死了，并且有非洲论坛帖子 - 但我希望你们专家可以选择堆栈溢出 :)

我们的 VB6 应用程序偶尔会在用户执行操作时消失，并且不会给出任何类型的错误，也不会出现在 PC 的错误日志中！

我想知道是否有人以前在 VB6 上听说过这个，你做了什么来解决它？

我想也许将所有代码从本机代码更改为 pcode 可能会提供更高的稳定性？

* * *

额外信息：

*   我们正在使用 Mdac 2.8
*   真正的数据库网格 6.0e

编辑中添加的注释：

*   我们的应用程序非常大，有 113 个独立的组件和 120MB 的编译大小（没有嵌入图片或任何东西）
*   我们的表示层动态创建对象，所以一切都是后期绑定的。
*   我并不真正关心 VB6 应用程序的本地性能，因为据我所知，它并没有真正进行任何认真的处理，因此性能完全受到我们在距离 300 位用户 80 英里的数据中心中的 Oracle 数据库的限制 -恶梦！

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-03-05T20:56:06.327

它有所作为。但不赞成其中之一。因为两种方法并不完全相同，所以它们可以在边缘情况下产生不同的结果。

还要了解我所描述的问题是编译器问题，而不是程序员的错误。所以你要真正确定这是问题所在。我们通过将更改与最后一个已知的良好版本进行比较来检查这一点。

我们遇到的问题是，对于我们的一些大型项目，代码中的小改动会导致错误（或者应用程序就消失了）。使用二进制文件时会发生这种情况。

当这种罕见的情况发生时，唯一的解决方法是重新排序代码行或插入像 i = i 这样的虚拟行。任何会强制编译器发出不同序列的程序集或 pcode 的东西。然后问题就消失了。

有几个例子我们这样做，成功编译，改回来，并成功编译回来。我们认为在这种情况下发生的情况是注册表更改足以强制发出一组略有不同的二进制/pcode。

您可能还需要清理注册表和本地临时文件夹。

我的经验是，对于具有多个引用的大型项目的每 1000 到 500 次编译，这可能会发生一次。

作为个人评论，当这种情况发生时，原因和解决方案似乎很荒谬，让我想打破巫毒娃娃并跳起雨舞。

# .net - 基于 Regex.Matches MatchCollection 替换字符串中的内容

> ID：615835
> 
> 赞同：2
> 
> 时间：2009-03-05T17:51:55.270
> 
> 标签：.net, vb.net, regex, string, replace

过去一天左右我一直在研究这个 RegEx，我想我已经解决了它，以便它返回我想要的数据。首先是一点背景。

我有一个内容编辑器，用户可以编辑网页。他们可以格式化文本、添加链接等。标准内容编辑器的东西。当他们单击保存时，编辑器提供了获取内容 (editor.Content) 并将其放入字符串的能力。我想要做的是获取任何链接（`<a>`标签）并找出它们是内部链接还是外部链接以及它们是否是 PDF 文件。

这是我想出的表达式：

```
<a\b[^<>]*href\s*=\s*[\""\'](?<domain>https?:\/\/[^\/\s\'\""]*)*\/?(?<path>\/?[^\s\""]+?)?[[>\""\'] 
```

有了这个，我可以将域（如果有的话）和路径分开。然后，我遍历比赛......

```
dim matchColl as MatchCollection = Regex.Matches(editorContent, regExString)
For Each m as Match in matchColl
   If m.Groups("domain").value <> myInternalDomain and m.Groups("domain").value <> "" then
       'this is an external domain... do some stuff
   End If
   If m.Groups("path").value.EndsWith(".pdf") then
         'it is a pdf, do some other stuff...
   End if
Next 
```

我的问题是……我对这些值“做一些事情”的部分，将其恢复到我的“editorContent”字符串的最佳方法是什么？我可能可以将 editorContent 放入 StringBuilder 并对其进行大量替换，但这是否非常有效？

因此，例如，对于 PDF，我想指定它在新窗口中打开 (target="_blank")，对于外部 URL，将一些 javascript 代码添加到 onclick 属性中。

任何想法都会很棒！

谢谢！

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2009-03-05T17:55:17.977

我想你想做 a[`Regex.Replace`](http://msdn.microsoft.com/en-us/library/cft8645c.aspx)并传入 a `MatchEvaluator`。基本上，`MatchEvaluator`它是返回替换字符串的函数的委托。

# php - Zend 框架：如何在 Zend_Registry 中取消设置键？

> ID：615837
> 
> 赞同：4
> 
> 时间：2009-03-05T17:51:56.223
> 
> 标签：php, zend-framework, registry, config

我正在测试我的 Zend Framework 应用程序，并想测试当注册表中未设置特定键时是否会发生某些事情。这是我正在测试的功能：

```
protected function getDomainFromConfig() {
    $config = Zend_Registry::get('config');
    if (!isset($config->domain)) {
        throw new Exception('Please make sure you have "domain" set in your config file and your config file is being set in the Zend_Registry.');
    }
    return $config->domain;
} 
```

如何取消设置注册表中的键？我试过这个，但没有奏效：

```
$config = Zend_Registry::get('config');
$config->__unset('domain'); 
```

**更新：**我真正想知道的是，当未设置配置文件中的“域”键时，我应该如何测试我的方法是否引发异常。

* * *

## 回答 #1

> 赞同：8
> 
> 时间：2009-03-06T12:56:18.123

更改配置对象值的唯一真正方法是将其转储到变量中，取消设置有问题的项目，要求注册表删除配置项，然后重置它。

```
<?php
$registry = Zend_Registry::getInstance();
$config = $registry->get('config');
unset($config->domain);
$registry->offsetUnset('config');
$registry->set('config', $config);
?> 
```

然而，为了使它工作，您必须在第一次将 Zend_Config 对象设置到注册表之前将其设置为可编辑。

您应该考虑以这种方式编辑注册表不是最佳做法。特别是， Zend_Config 对象被设计为在最初实例化后是静态的。

我希望我已经很好地理解了你的问题！

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-03-05T17:56:18.677

如果您的“配置”实际上是`Zend_Config`，那么默认情况下它是只读的。 `Zend_Config`构造函数的可选第二个参数是 boolean `$allowModifications`，默认设置为`false`.

你可能`Zend_Config_Ini`会`bootstrap.php`用

```
new Zend_Config_Ini(APPLICATION_PATH . '/config/app.ini', 
                    APPLICATION_ENVIRONMENT) 
```

附加`$allowModifications`参数：

```
new Zend_Config_Ini(APPLICATION_PATH . '/config/app.ini', 
                    APPLICATION_ENVIRONMENT, 
                    true) 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-03-05T18:21:16.917

尝试：

```
unset($config->domain); 
```

然后重新注册`$registry->config`修改后的`Zend_Config`类。请注意，正如 vartec 所说，您必须将您的`Zend_Config`实例实例化为可编辑：

```
$config = new Zend_Config('filename', true); 
```

`__unset`您尝试调用的方法是在实例上使用时调用的[魔术方法。](http://uk.php.net/manual/en/language.oop5.magic.php)`unset`

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2009-03-05T18:26:39.493

我看到您正试图删除 $config 中的一个值，其中 $config 在删除之前存储在 Zend_Registry 中。因此，如果删除该值不会影响 Zend_Registry 中存储的 $config 值，我假设通过调用 Zend_Registry::get() 您将获得 $config 的值，而不是 Zend_Registry 中对 $config 的引用。因此，当您更改复制的 $config 中的某些内容时，它不会影响存储的内容。我建议你先更改 $config，然后再覆盖注册表中的 $config，方法是再次设置 Zend_Registry 中的 $config。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2011-05-25T19:05:00.960

对于那些希望完成标题要求的人，取消设置 Zend_Registry 键：

```
class My_Registry extends Zend_Registry
{
    /**
     *
     * @param type $index
     */
    public static function delete($index)
    {
        $instance = self::getInstance();

        if ($instance->offsetExists($index)) {
            $instance->offsetUnset($index);
        }
    }
} 
```

致电：`My_Registry::delete('key')`

# sql - 将一个或多个表从一个 SQL 服务器传输到另一个 SQL 服务器的最佳方法是什么？

> ID：615847
> 
> 赞同：1
> 
> 时间：2009-03-05T17:54:06.530
> 
> 标签：sql, sql-server

我已经在 VB.NET 和 SQL Server 2008 中进行了一段时间的开发，但还没有进行实时安装。在我使用的数据库系统中，它能够将多个表归档到一个 .dga 文件中，就像它被调用的那样。然后我可以将 .dga 文件恢复到另一个数据库或另一个服务器上。

我正在寻找在 SQL Server 中完成类似任务的最简单方法。

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2009-03-05T17:59:17.187

如果要传输特定的表，请使用数据转换服务（在 SQL Server Management Studio 中右键单击数据库并选择“导入数据”，它会弹出对话框）。当然，这假设您有两个数据库可供您使用。

如果您对替换整个数据库感到满意，您可以轻松地备份数据库，然后通过 SQL Server Management Studio（或通过调用相应的 SP）将其恢复到新的数据库中。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2009-03-05T18:03:56.753

我会选择以下之一：

*   在 MS SQL Management Studio 中，右键单击数据库/任务/生成脚本

*   在 Visual Studio 中，在“服务器资源管理器”选项卡中，“发布到提供者”

两者都将启动一个向导，允许您以您想要的方式导出您想要的表（包括数据与否，创建脚本与否等）

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2009-03-05T17:58:21.760

如果要移动没有数据的表，最简单的方法是编写所需的表并运行脚本。

我们编写所有数据库更改并将它们提交到颠覆，然后将它们作为部署过程的一部分运行。

如果您想将整个数据库放在产品上，包括数据（首先清除测试记录！），然后在另一台服务器上进行备份和恢复。

对于未来的更改，我们编写所有数据库更改并将它们提交给 subversion，然后将它们作为部署过程的一部分运行。还有一些工具可以查看两个服务器之间的结构差异并创建脚本。REd-Gate 的 SQL 比较非常适合这一点。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2009-03-05T18:00:28.557

除了 HLGEM 的建议之外，如果这是一个持续的过程，您可以查看 SSIS。

# .net - 在 Windows 上使用的 Subversion 服务器

> ID：615866
> 
> 赞同：13
> 
> 时间：2009-03-05T18:00:56.980
> 
> 标签：.net, svn, tortoisesvn

什么 Subversion (SVN) Server 会推荐新手开始使用 Windows Server 操作系统？

我想我将在客户端上使用 TortoiseSVN，并且主要进行 .NET 开发。

**更新：**
很好的建议。我根据投票来选择我的答案。我将尝试 VisualSVN 和 CollabNet。请阅读我认为非常好的 chyne 的答案（+1）。我也试试这个方法。

我会在一两个星期后回到这个问题，并在评论中更新我的想法。

* * *

## 回答 #1

> 赞同：24
> 
> 时间：2009-03-05T18:03:24.197

我使用[VisualSVN](http://www.visualsvn.com/server/)服务器，发现它很容易设置和使用。

此外，如果您正在进行 .NET 开发，请查看[AnkhSVN](http://ankhsvn.open.collab.net/)以进行 Visual Studio 集成。我将那个和乌龟 SVN 都安装为客户端。

* * *

## 回答 #2

> 赞同：13
> 
> 时间：2009-03-05T18:04:50.170

只需使用[SVN 服务器](http://subversion.tigris.org/)的标准 Windows 发行版，作为服务运行。它对我来说非常好。我也为客户端使用 TortoiseSVN。

* * *

## 回答 #3

> 赞同：6
> 
> 时间：2009-03-05T19:05:16.607

如果你说的是一个人，刚刚开始，在一台 PC 上处理你自己的个人项目，那么我建议从基于文件系统的存储库开始，完全跳过服务器。把事情简单化。

TortoiseSVN 可以创建本地存储库（在网络驱动器或外部驱动器上，如果您需要将工作副本和存储库放在不同位置的安全性）。

只需在某处为您的存储库创建一个文件夹，右键单击它并使用 Tortoise 的“在此处创建存储库”命令。

然后，您的存储库的 URL 将类似于：`file:///X:/path/to/repository`.

如有必要，您可以随时将存储库移动到服务器。

* * *

## 回答 #4

> 赞同：3
> 
> 时间：2009-03-05T18:23:53.930

[sliksvn](http://www.sliksvn.com/en/download)简单、免费且可以正常工作 - 作为服务运行，无需网络服务器。

* * *

## 回答 #5

> 赞同：2
> 
> 时间：2009-03-05T18:53:19.460

Visual SVN 很棒，但我觉得它有点太神奇了。

我按照 Code Magazine 的指示进行了设置。

[http://www.code-magazine.com/Article.aspx?quickid=0807081](http://www.code-magazine.com/Article.aspx?quickid=0807081)

* * *

## 回答 #6

> 赞同：1
> 
> 时间：2009-03-05T18:38:54.783

我在使用 SlickSVN 时遇到了麻烦，您可以在[此处](https://stackoverflow.com/questions/410844/tortoisesvn-cant-connect-to-machine-in-workgroup)阅读。最后我选择了 CollabNet 二进制文件。

* * *

## 回答 #7

> 赞同：0
> 
> 时间：2009-03-05T18:05:53.943

我只是去磨房[SVN 服务器](http://www.collab.net/servlets/OCNDirector?id=CSVN1.5.6WINS)包的基本运行，特别是因为你将使用 Tortoise。它很瘦:)

* * *

## 回答 #8

> 赞同：0
> 
> 时间：2009-03-10T16:16:36.220

我经常将 TortoiseSVN 与官方 Subversion Windows 二进制文件中包含的官方简单 Subversion 服务器结合使用。我创建了一个简单的批处理脚本文件，可以在需要时启动服务器。这里是：

```
@echo Starting SVNServe in daemon mode...
C:\Utils\SVN\bin\svnserve.exe -d -r C:\Repositories 
```

如您所见，我将存储库保存在 C:\Repositories 中。

当然这是一个非常简单的方法。如果您想要更高的安全性，您可能会将存储库托管在不同的服务器等上。但另一方面，这很容易管理。

# c# - 如何将 sortedDictionary 转换为 Dictionary？

> ID：615874
> 
> 赞同：6
> 
> 时间：2009-03-05T18:02:57.520
> 
> 标签：c#, generics

```
Dictionary<string, string> optionDictionary = new Dictionary<string, string>();

optionDictionary = ....;

SortedDictionary<string, string> optionsSorted;

if(sorting)
{
   optionsSorted = new SortedDictionary<string, string>(optionDictionary );
   // Convert SortedDictionary into Dictionary
}

return optionDictionary ; 
```

* * *

## 回答 #1

> 赞同：17
> 
> 时间：2009-03-05T18:05:55.330

您可以将`optionsSorted<TKey,TValue>`字典作为参数传递给 new 的实例，`Dictionary<TKey,TValue>`如下所示：

```
var dictionary = new Dictionary<type1,type2>(optionsSorted); 
```

* * *

## 回答 #2

> 赞同：11
> 
> 时间：2009-03-05T18:07:13.190

尝试以下

```
var dictionary = optionsSorted.ToDictionary(x => x.Key, x=> x.Value); 
```

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2009-03-05T18:49:11.920

我并不完全清楚你想要完成什么。我假设您有一个返回 Dictionary 的函数，并且您希望它在排序为 true 时成为已排序的字典。

如果这是真的，那么您需要一个可以是 Dictionary 或 SortedDictionary 的返回类型。

如果您想要一个函数来执行此操作，我会使用 IDictionay 作为该方法的返回类型。

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2009-03-05T18:07:28.133

只需使用 ToDictionary 方法。

# xslt - XSLT：如何在期间更改属性值 ?

> ID：615875
> 
> 赞同：65
> 
> 时间：2009-03-05T18:03:21.203
> 
> 标签：xslt, xslt-1.0, xslt-2.0

我有一个 XML 文档，我想更改其中一个属性的值。

首先，我使用以下方法复制了从输入到输出的所有内容：

```
<xsl:template match="@*|node()">
  <xsl:copy>
    <xsl:apply-templates select="@*|node()"/>
  </xsl:copy>
</xsl:template> 
```

现在我想更改`"type"`任何名为`"property"`.

* * *

## 回答 #1

> 赞同：64
> 
> 时间：2009-03-06T03:28:38.240

**这个问题有一个经典的解决方案***[：](http://www.dpawson.co.uk/xsl/sect2/identity.html)*使用*和覆盖[**标识模板**](http://www.dpawson.co.uk/xsl/sect2/identity.html)是最基本和最强大的 XSLT 设计模式之一[](http://www.dpawson.co.uk/xsl/sect2/identity.html)***：**

 **```
<xsl:stylesheet version="1.0" 
 xmlns:xsl="http://www.w3.org/1999/XSL/Transform">
    <xsl:output omit-xml-declaration="yes" indent="yes"/>

    <xsl:param name="pNewType" select="'myNewType'"/>

    <xsl:template match="node()|@*">
        <xsl:copy>
            <xsl:apply-templates select="node()|@*"/>
        </xsl:copy>
    </xsl:template>

    <xsl:template match="property/@type">
        <xsl:attribute name="type">
            <xsl:value-of select="$pNewType"/>
        </xsl:attribute>
    </xsl:template>
</xsl:stylesheet> 
```

**应用于此 XML 文档时**：

```
<t>
  <property>value1</property>
  <property type="old">value2</property>
</t> 
```

**产生了想要的结果**：

```
<t>
  <property>value1</property>
  <property type="myNewType">value2</property>
</t> 
```

* * *

## 回答 #2

> 赞同：41
> 
> 时间：2009-03-05T18:20:18.230

在一个简单的例子上测试，工作正常：

```
<xsl:template match="@*|node()">
  <xsl:copy>
    <xsl:apply-templates select="@*|node()"/>
  </xsl:copy>
</xsl:template>
<xsl:template match="@type[parent::property]">
  <xsl:attribute name="type">
    <xsl:value-of select="'your value here'"/>
  </xsl:attribute>
</xsl:template> 
```

编辑包括 Tomalak 的建议。

* * *

## 回答 #3

> 赞同：10
> 
> 时间：2013-12-13T10:16:45.640

如果根元素中有 xmlns 定义，前两个答案将不起作用：

```
<?xml version="1.0"?>
<html xmlns="http://www.w3.org/1999/xhtml">
    <property type="old"/>
</html> 
```

所有解决方案都不适用于上述 xml。

可能的解决方案如下：

```
<?xml version="1.0"?> 

<xsl:stylesheet xmlns:xsl="http://www.w3.org/1999/XSL/Transform" version="1.0">

  <xsl:output omit-xml-declaration="yes" indent="yes"/>
  <xsl:template match="node()[local-name()='property']/@*[local-name()='type']">
      <xsl:attribute name="{name()}" namespace="{namespace-uri()}">
                some new value here
          </xsl:attribute>
  </xsl:template>

  <xsl:template match="@*|node()|comment()|processing-instruction()|text()">
      <xsl:copy>
          <xsl:apply-templates select="@*|node()|comment()|processing-instruction()|text()"/>
      </xsl:copy>
  </xsl:template>
</xsl:stylesheet> 
```

* * *

## 回答 #4

> 赞同：5
> 
> 时间：2009-03-05T18:18:28.623

您需要一个与您的目标属性匹配的模板，仅此而已。

```
<xsl:template match='XPath/@myAttr'>
  <xsl:attribute name='myAttr'>This is the value</xsl:attribute>
</xsl:template> 
```

这是您已经拥有的“全部复制”的补充（实际上在 XSLT 中默认情况下始终存在）。有一个更具体的匹配，它将被优先使用。

* * *

## 回答 #5

> 赞同：2
> 
> 时间：2009-09-07T14:39:49.523

我有一个类似的情况，我想从一个简单的节点中删除一个属性，但不知道哪个轴可以让我读取属性名称。最后，我所要做的就是使用

`@*[name(.)!='AttributeNameToDelete']`

* * *

## 回答 #6

> 赞同：2
> 
> 时间：2016-12-09T08:53:35.793

我也遇到了同样的问题，我解决了如下：

```
<!-- identity transform -->
<xsl:template match="@*|node()">
  <xsl:copy>
    <xsl:apply-templates select="@*|node()"/>
  </xsl:copy>
</xsl:template>

<!-- copy property element while only changing its type attribute -->
<xsl:template match="property">
  <xsl:copy>
    <xsl:attribute name="type">
      <xsl:value-of select="'your value here'"/>
    </xsl:attribute>
    <xsl:apply-templates select="@*[not(local-name()='type')]|node()"/>
  </xsl:copy>
</xsl:template> 
```

* * *

## 回答 #7

> 赞同：1
> 
> 时间：2009-03-05T18:21:58.210

对于以下 XML：

```
<?xml version="1.0" encoding="utf-8"?>
<root>
    <property type="foo"/>
    <node id="1"/>
    <property type="bar">
        <sub-property/>
    </property>
</root> 
```

我能够让它与以下 XSLT 一起工作：

```
<?xml version="1.0" encoding="utf-8"?>
<xsl:stylesheet version="1.0" xmlns:xsl="http://www.w3.org/1999/XSL/Transform">
    <xsl:template match="@*|node()">
        <xsl:copy>
            <xsl:apply-templates select="@*|node()"/>
        </xsl:copy>
    </xsl:template>
    <xsl:template match="//property">
        <xsl:copy>
            <xsl:attribute name="type">
                <xsl:value-of select="@type"/>
                <xsl:text>-added</xsl:text>
            </xsl:attribute>
            <xsl:copy-of select="child::*"/>
        </xsl:copy>
    </xsl:template>
</xsl:stylesheet> 
```

* * *

## 回答 #8

> 赞同：1
> 
> 时间：2013-12-16T04:24:52.230

如果您的源 XML 文档有自己的命名空间，您需要在样式表中声明命名空间，为其分配一个前缀，并在引用源 XML 的元素时使用该前缀 - 例如：

```
<?xml version="1.0" encoding="UTF-8"?>
<xsl:stylesheet version="1.0" 
xmlns:xsl="http://www.w3.org/1999/XSL/Transform"
xmlns:xhtml="http://www.w3.org/1999/xhtml">

<xsl:output method="xml" encoding="utf-8" indent="yes" omit-xml-declaration="yes" />

<!-- identity transform -->
<xsl:template match="node()|@*">
    <xsl:copy>
        <xsl:apply-templates select="node()|@*"/>
    </xsl:copy>
</xsl:template>

<!-- exception-->    
<xsl:template match="xhtml:property/@type">
    <xsl:attribute name="type">
        <xsl:text>some new value</xsl:text> 
    </xsl:attribute>
</xsl:template>

</xsl:stylesheet> 
```

或者，如果您愿意：

```
...
<!-- exception-->    
<xsl:template match="@type[parent::xhtml:property]">
  <xsl:attribute name="type">
        <xsl:text>some new value</xsl:text> 
  </xsl:attribute>
</xsl:template>
... 
```

* * *

附录：在事先不知道 XML 命名空间的极不可能的情况下，您可以这样做：

```
<?xml version="1.0" encoding="UTF-8"?>
<xsl:stylesheet version="1.0" 
xmlns:xsl="http://www.w3.org/1999/XSL/Transform">

<xsl:output method="xml" encoding="utf-8" indent="yes" omit-xml-declaration="yes" />

<!-- identity transform -->
<xsl:template match="node()|@*">
    <xsl:copy>
        <xsl:apply-templates select="node()|@*"/>
    </xsl:copy>
</xsl:template>

<!-- exception -->
<xsl:template match="*[local-name()='property']/@type">
    <xsl:attribute name="type">
        <xsl:text>some new value</xsl:text> 
    </xsl:attribute>
</xsl:template> 
```

当然，很难想象这样一种场景：您会提前知道源 XML 文档包含一个名为“property”的元素，以及一个需要替换的名为“type”的属性——但仍然不知道文档的名称空间。我添加这个主要是为了展示如何简化您自己的解决方案。

# web - 独特项目中接口、注入的必要性

> ID：615885
> 
> 赞同：1
> 
> 时间：2009-03-05T18:06:03.177
> 
> 标签：web, interface

为什么我要在一个几乎没有机会被其他人重用或升级的站点上实现接口和依赖注入？

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2009-03-05T18:09:17.163

它通常使单元测试变得相当简单。例如，您可能有一个类型使用连接到数据库的另一种类型。对于第一种类型的单元测试，您可以注入一个测试模拟来代替第二种类型，从而允许您有效地对第一种类型进行单元测试，而无需通过第二种类型间接连接到数据库。

* * *

## 回答 #2

> 赞同：5
> 
> 时间：2009-03-05T18:13:38.837

当你学会如何为计算机编程时，你正在开发一种你的手艺的“肌肉记忆”。多年来，您继续以同样的心态进行编程。大多数人并没有从一开始就学习所有漂亮的 OOP 原则，所以他们看起来比他们学习的方式更努力。

每当您使用 OOP 语言时，您都应该养成使用 OOP 设计技术的习惯，因为这将使您成为一个整体上更好的开发人员。您的目标应该是重新训练您的编程肌肉记忆以使用这些技术。那么你就不必问这些问题并假设这些技术在某种程度上“妨碍”了你的编程。你变成了一个程序员，只是这样编程。

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2009-03-05T18:08:42.640

为什么，确实？

我不认为接口和注入只是关于重用或升级。

就个人而言，我对所有项目都使用接口和 DI。避免它们成为一种好处是不够的开销。

* * *

## 回答 #4

> 赞同：2
> 
> 时间：2009-03-05T18:08:50.377

因为您所做的假设与导致 Y2K 的假设相同。

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2009-03-05T18:26:20.727

我发现它使以我还没有想到的方式重用我的代码变得更加容易。它还可以更轻松地更改代码的工作方式，而无需更改源代码。

我正在使用[Spring.NET](http://www.springframework.net/)进行依赖注入。

假设您有一个具有 DoWork() 函数的 Machine 类。然后创建一个 IWorkAlgorithm 接口，为每台机器提供特定的算法实现。

Machine 的每个实例都注入了一个 IWorkAlgorithm，Machine.DoWork() 调用注入的实现。

现在您有以下优势：

1.  您只需编辑 XML 文件就可以换入新的实现。
2.  您可以通过编辑 XML 文件来更改每个实现的属性（超时、限制等）。
3.  您可以在 Machine 类之外重用您的实现。

* * *

## 回答 #6

> 赞同：1
> 
> 时间：2009-03-05T18:39:42.427

如果您正在做面向对象的编程，即使您是唯一会查看代码的开发人员，您仍然应该进行单元测试，如果您不使用依赖注入，这将变得复杂。

不要忘记，您软件的“其他开发人员”很可能就是您。您可以将大量高度耦合、相互依赖的代码拼凑在一起，这些代码可以工作，甚至可以在您处理它的同时理解它，但是当您离开项目的那一刻，即使是几天，您也会开始忘记所有阻止毛线球散开的小事。

当你回到它时（我还没有看到一个不需要在路上做一些改变的软件），你会希望你已经遵循了所有的最佳实践。

# web-services - PHP、Ruby、Python……尤玛？

> ID：615886
> 
> 赞同：0
> 
> 时间：2009-03-05T18:06:43.317
> 
> 标签：web-services, realbasic

在考虑创建与数据库后端接口的 Web 应用程序时使用的语言，有没有人有使用 Yuma 的经验，并且可以分享它的稳定性以及它可能提供什么样的性能？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-05-07T22:43:24.433

我使用 Yuma 并且很满意。但是，我没有把厨房水槽扔到它上面，所以不知道它的伸缩性如何。Yuma 确实提供了一个开发者下载，所以如果你有兴趣，你应该去看看。我将它用于一些具有自定义后端的应用程序。如果您熟悉 RealBasic，使用它就是小菜一碟。

唯一的缺点是有大量的 php 和 python（脚本等）源，Yuma 的公开可用源几乎不存在，因为它太新了。此外，找到托管 Yuma 后端的托管服务提供商是可行的，但可能不如 php 流行。

如果您是 RealBasic 用户，我建议您尝试一下。很少的学习曲线和一些好东西，比如缓存和使用 FASTCGI 等。

# java - 我在哪里可以下载 JOGL？

> ID：615899
> 
> 赞同：11
> 
> 时间：2009-03-05T18:11:18.187
> 
> 标签：java, opengl, jogl

我正在寻找开始使用 Java Open GL，但我找不到它。

* * *

## 回答 #1

> 赞同：12
> 
> 时间：2009-03-05T18:14:17.103

你试过[JOGL的网站](http://jogamp.org/jogl/www/)吗？

看起来他们的最新版本可以在[这里找到，或者你可以](http://jogamp.org/deployment/archive/rc/)[在这里](http://jogamp.org/deployment/autobuilds/master)获取每晚的构建。

* * *

## 回答 #2

> 赞同：7
> 
> 时间：2010-10-25T14:52:57.467

要获取新的 JOGL 2.0 beta 的最新稳定版本，请访问[http://jogamp.org/deployment/webstart/](http://jogamp.org/deployment/webstart/)。夜间构建位于[http://jogamp.org/deployment/autobuilds/master/](http://jogamp.org/deployment/autobuilds/master/)。最新的自动构建（截至撰写本文时）位于[http://jogamp.org/deployment/autobuilds/master/jogl-b242-2010-11-28_23-03-07/](http://jogamp.org/deployment/autobuilds/master/jogl-b242-2010-11-28_23-03-07/)。[你可以在http://jogamp.org/wiki/index.php/Jogamp_Versioning_and_Releases](http://jogamp.org/wiki/index.php/Jogamp_Versioning_and_Releases)看到他们版本的描述。

要获取旧的 JOGL 1.1.1a（JOGL 迁移之前的最后一个版本），请访问[http://download.java.net/media/jogl/builds/archive/jsr-231-1.1.1a/](http://download.java.net/media/jogl/builds/archive/jsr-231-1.1.1a/)。

* * *

## 回答 #3

> 赞同：3
> 
> 时间：2009-03-07T18:12:18.183

我同意他们的网站很混乱，很难找到下载链接。

当您访问[他们的网站](https://jogl.dev.java.net/)时，单击“Current release build (JSR-231 1.1.1)”或滚动到页面的最底部，您将看到文件。下载您使用的任何系统的相应文件。

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2010-08-22T03:21:32.870

行。这是我到目前为止所发现的：转到 wiki：http: [//jogamp.org/jogl/doc/deployment/JOGL-DEPLOYMENT.html](http://jogamp.org/jogl/doc/deployment/JOGL-DEPLOYMENT.html)

它表明有一个演示目录：http: [//jogamp.org/deployment/webstart/](http://jogamp.org/deployment/webstart/)

这里有许多 JNLP 文件。随机选择一个：http: [//jogamp.org/deployment/webstart/Gears.jnlp](http://jogamp.org/deployment/webstart/Gears.jnlp)

在浏览器中打开它。浏览器启动 webstart，webstart 安装 3d 扩展并运行演示。它有效，所以很明显正在下载库 - 某处。

美好的。让我们从命令行尝试一下： $ curl [http://jogamp.org/deployment/webstart/Gears.jnlp](http://jogamp.org/deployment/webstart/Gears.jnlp) > Gears.jnlp $ javaws Gears.jnlp

也很好。伟大的！现在的诀窍是弄清楚如何链接到 jws 已经下载的那些库。

嗯......据我所知，他们只是放入 /System/Library/Java/Extensions 中，然后...... drat：“访问限制：由于对所需库 /System/Library 的限制，无法访问类型 DirectionalLight /Java/Extensions/j3dcore.jar"

好的，还有更多的事情要弄清楚。

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2011-09-22T20:57:47.260

当前项目主页：http: [//jogamp.org/jogl/www/](http://jogamp.org/jogl/www/)

# c# - 维护 - 平衡何时以及是否进行更改的问题

> ID：615906
> 
> 赞同：1
> 
> 时间：2009-03-05T18:14:56.527
> 
> 标签：c#, .net, maintenance

我为其他人维护了几个库。在为他们每个人完成了几个版本之后，如果我不得不重新做一些事情，我会做一些不同的事情。

问题是：我应该重做吗？我想我们都面临着这样的困境——如何平衡维护活动的帮助与变革的破坏性影响。

显然，对于错误来说，改变势在必行。那里没有两难境地。对于新功能，这是实用性与增加复杂性的问题。我觉得处理这个问题很舒服。

我要问的是错误修复和新功能之间的模糊空间。一个例子是维护以符合框架设计指南或 CLS 合规性。对于一个图书馆，我写它时没有考虑 CLS 合规性，然后人们要求它。结果，我不得不修改接口以将 uint 换成 int。这是一个破坏性的变化，收益微乎其微（对大多数人来说）。

另一个问题：FxCop 合规性。为了让 FxCop 高兴，我不得不更改某些方法的参数名称。但这些变化实际上只影响使用反射的人——类型没有改变，只有参数的名称。

我现在正在处理的问题是：框架设计指南。关于事件的指南说事件应该有一个带有两个参数的签名：（对象源，EventArgs e）。但是那天我没有参加我的框架设计课程；）。我的库中的事件目前只需要一个 EventArgs 参数。

我现在正在向图书馆添加新活动。新事件是否应该遵循框架设计指南？还是图书馆已经建立的模式？如果我使用新活动的设计指南，我是否应该修改现有活动以也符合设计指南？如果是这样，如何进行迁移？我应该使用 [Obsolete] 属性吗？发行了多少？

更一般地说，我对在错误修复和新功能之间的这个模糊区域进行维护的想法很感兴趣。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-03-05T18:22:41.903

而不是修改旧代码弃用它。以正确的设计开始您的新代码，并为使用旧设计的部分编写替换代码。最终你会得到一个全部使用正确设计的系统，但这不会是一个非常具有破坏性的变化。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-03-05T18:25:31.023

如果您打算进行重大更改，您肯定需要进行很多沟通。即使您将库作为第 2 版重新启动，您也必须告诉您的用户第 1 版将来只会修复错误，并且您将前往第 2 版开发，在那里他们可以找到所有新功能。

但我想我会走这条路。支持版本 1 进行错误修复并移植新版本 2 以进行重大更改。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-03-05T18:27:28.820

如果我尝试遵循一些我以前没有遵循的准则，我将在新代码中执行。对于现有代码，我会修复它们，除非它们被破坏。但是，如果您在现有代码中发现了一些错误，那么在修复错误的同时应用这些指南是一种很好的做法。

# javascript - 闭包与回调有何不同？

> ID：615907
> 
> 赞同：31
> 
> 时间：2009-03-05T18:15:11.080
> 
> 标签：javascript, closures, callback

我问[了一个关于回调的问题](https://stackoverflow.com/questions/615642/does-this-fit-your-definition-of-a-callback/615752#615752)并提出了另一个问题（见评论）。闭包与回调有何不同？

* * *

## 回答 #1

> 赞同：22
> 
> 时间：2009-03-05T18:21:01.970

检查这里的介绍：http: [//jibbering.com/faq/faq_notes/closures.html](http://jibbering.com/faq/faq_notes/closures.html)。它可以帮助您更好地理解闭包与函数的关系。

这是一组闭包示例：[http ://www.javascriptkit.com/javatutors/closures2.shtml](http://www.javascriptkit.com/javatutors/closures2.shtml)

基本上，回调就像一个函数指针。使它成为闭包的一点是，当该函数访问它所在的上下文中的任何内容时，例如它之外的变量。发生这种情况时，该函数将使用变量的当前值（而不是复制它们）。参见示例 4。

* * *

## 回答 #2

> 赞同：13
> 
> 时间：2009-03-05T18:21:28.833

不同的定义：

[回调](http://en.wikipedia.org/wiki/Callback_(computer_science))-

> 回调是作为参数传递给其他代码的可执行代码。

[关闭](http://en.wikipedia.org/wiki/Closure_(computer_science))-

> 闭包是在包含一个或多个绑定变量的环境中评估的函数。调用时，该函数可以访问这些变量。

* * *

## 回答 #3

> 赞同：12
> 
> 时间：2017-02-05T14:55:57.063

简单来说：使用上下文变量的回调是一个闭包。

* * *

## 回答 #4

> 赞同：5
> 
> 时间：2009-03-05T18:20:49.600

[这里](http://www.jibbering.com/faq/faq_notes/closures.html)有一个很好的闭包定义：

> “闭包”是一个表达式（通常是一个函数），它可以具有自由变量以及绑定这些变量的环境（即“关闭”表达式）。

实际上，这意味着它是一个具有一些隐藏变量的函数。

回调是一个更高层次的想法。通常，它是一个传递的函数，目的是在以后调用。在 JavaScript 中，闭包通常用作回调。

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2009-03-05T18:24:36.627

依赖于上下文变量又名绑定变量（== 对象状态）的回调将是一个闭包。它将是一个纯函数，否则，当它只接受自由变量（== 参数）时。

* * *

## 回答 #6

> 赞同：1
> 
> 时间：2018-06-06T14:57:23.237

这是区分这两者的一种方法：

关闭

> 闭包用于扩展功能，例如，如果用户单击按钮，我们希望屏幕上发生一些事情，在这种情况下，我们将使用闭包传递用户事件（单击），然后将数据推送到风景。

打回来

> 回调或多或少类似于闭包，但更多用于通知和提供同步功能。例如，如果您执行 jQuery Ajax 调用，您将拥有诸如`success()`、`error()`等回调`beforeSend()`来处理异步数据。

* * *

## 回答 #7

> 赞同：0
> 
> 时间：2018-09-12T17:06:36.357

**关闭：**

*   另一个函数中的函数关键字，您正在创建一个闭包

*   或者一个函数返回到另一个函数，我们可以说是闭包

**注意简单的英语：**在另一个函数中作为参数传递的一点点差异函数是回调，或者如果在另一个函数中定义是闭包

```
var length = 101;
function fn2() {
	console.log("fffxxx: "+this.length);
}

var obj = {
  length: 5,
  method3: function(fn) {
    fn();
    arguments[0]();
  }
};

obj.method3(fn2, 1); 
```

**输出होगा

```
fffxxx:101
fffxxx:2** 
```

* * *

## 回答 #8

> 赞同：0
> 
> 时间：2018-09-12T17:09:50.997

什么是回调函数？

回调函数是一个函数，它是：

*   作为参数传递给另一个函数
*   在某种事件之后被调用（लागू）
*   一旦其父函数完成，作为参数传递的函数就会被调用

**用简单的英语我们说** *回调是由另一个函数调用的任何函数，它将第一个函数作为参数或作为参数传递的函数*

*   注意： **被调用**：函数内部的代码在函数被调用时执行。或者我们这样说通常使用术语“调用函数”而不是“调用函数”。

“调用函数”、“启动函数”或“执行函数”也很常见。

```
 function getUserInput(firstName, lastName, age, callback2,callback1) {
    var fullName = firstName + " " + lastName;

    // Make sure the callback is a function
    if (typeof callback2 === "function") {
    // Execute the callback function and pass the parameters to it
    callback2(fullName, age);
    }

    if (typeof callback1 === "function") {     
    callback1(lastName);
    }
}

function callbackforlastname1(lname){
 console.log("---");
}

function genericPoemMaker(name, aged) {
    console.log(name + " is finer than fine wine.");
     console.log("A " + aged + " of unfortunl smile");
}

getUserInput("Avinash", "Maurya", "26", genericPoemMaker,callbackforlastname1); 
```

ऐसे कॉल करते है

* * *

## 回答 #9

> 赞同：-1
> 
> 时间：2009-03-05T18:23:21.997

我看不出这两者有什么关系？闭包将局部状态的一部分携带到某种函数中，将其视为通过引用传递。

回调旨在通知您某些更改并重定向程序流。闭包可以修改本地状态，但你永远不会得到处理器时间来处理它，就像你使用回调一样。

# javascript - jQuery 宽度（）返回 0

> ID：615934
> 
> 赞同：19
> 
> 时间：2009-03-05T18:21:28.757
> 
> 标签：javascript, jquery

> **可能重复：**
> [在执行某事之前要求 jQuery 等待所有图像加载的官方方式](https://stackoverflow.com/questions/544993/official-way-to-ask-jquery-wait-for-all-images-to-load-before-executing-somethin)

我正在编写一个 jQuery 插件，它通过一个简单的插件函数调用来处理一堆图像动画（就像一个图像`$("#image1").anims()`在哪里`#image1`），但是作为插件功能的一部分，我`$(this).width()`用来获取图像的宽度函数调用的开始。

但是，由于调用了插件函数`$(document).ready`，它试图在图像加载之前获取图像的宽度，所以它总是返回 0。有解决方法吗？

* * *

## 回答 #1

> 赞同：13
> 
> 时间：2009-03-05T18:32:05.313

[http://docs.jquery.com/Events/load](http://docs.jquery.com/Events/load)

```
$("#image1").load(function () {
$("#image1").anims();
}); 
```

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2009-03-05T18:29:35.400

您可以预加载图像

```
var oImage = new Image();

oImage.onload = function(){
    this.width// width of loaded image
}

oImage.src = '/path/to/image.gif'; 
```

$(document).ready 不会等待图像加载，它会等待 dom 准备好。

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2012-11-02T19:36:24.490

如果您使用 jQuery.append() 或 jQuery.html() 将受信任的 html 插入到“element1”中，并且 element2 的 css 值（无论是 div 还是 span 向左浮动以适合 element3），您将无法获得 offsetWidth 、 clientWidth 、 element3 的 naturalWidth (google crome) 没有新的事件触发器。

```
var element1 = $('div.container');
while(i<=length){
var element2 = $('<span/>').attr({'id':''+[i]+'','class':'container'});
var element3 = $('<img/>').attr('src':''+source[i]+'','class':'img');
$(element1)children().remove();
$(element2).appendTo(element1).append(element3);
var elms = $(element3);
var chwidth = elms[i].offsetWidth // returns 0;
++i;
}; 
```

您可以做的是在加载元素之前返回元素的上下文宽度。

```
while(i<=length){
$(element1).children().remove();
$(elemen2).appendTo(element1).append(element3);
var elms = $(element3);
var newelms = elms[i].load();
var chwidth = newelms[i]['context'].width // returns element3's contextual width
if(chwidth != 0) // make sure only the proper width is returned 
var width = chwidth;
++i;
}; 
```

如果这不起作用，请尝试：

```
while(i<=length){
$(element1).children().remove();
$(elemen2).appendTo(element1).append(element3);
var elms = $(element3);
var newelms = elms[i].load(function (){
//get the widths inside the load context
var width = this.width();
//pass the single width or el[i].width to next function
};
++i;
}; 
```

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2010-10-06T06:08:04.977

在读取任何尺寸之前做一个淡入：

```
$('#image').fadeIn(10,function () {
    var tmpW = $(this).width();
    var tmpH = $(this).height();
}); 
```

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2012-11-03T19:36:40.150

插入受信任的 HTML 并在`widths`不触发新事件的情况下获取，可以通过在插入受信任的 HTML 之后访问其 DOM 上下文来完成，`document.getElementById()`如下所示：

```
var element1 = $('element#one');
var element1id = element1.attr('id');
var newElement1 = document.getElementById(''+element1id+'');
var newElement2 = newElement1.children;
var widths = [];
for (var i = 0; i < newElement2.length; ++i) {
   var img = newElement2[i].children;
   widths[i] = img[0].width;
} 
```

然后只需使用`widths`数组来获取宽度。

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2009-03-05T18:27:36.200

我相信你可以使用

```
$(this).ready(function() {
    // stuff with $(this).width() in here
}) 
```

我不认为 .ready() 是文档独有的。

* * *

## 回答 #7

> 赞同：0
> 
> 时间：2009-03-05T18:27:51.050

到`$(document).ready`调用的时候，图像应该已经被加载了。还有什么不对劲的。

如果您需要在开始动画之前知道图像的宽度，但是在动画开始时图像需要处于某种形式的隐藏状态，您可以`.width()`在动画之前使用捕获图像的宽度，然后调用`.hide()`或其他任何方法适当的，在测量宽度后立即。

* * *

## 回答 #8

> 赞同：-3
> 
> 时间：2009-03-05T18:24:00.607

您可以使用[`setTimeout()`](http://www.w3schools.com/js/js_timing.asp)函数将执行延迟足够长的时间以加载图像。

这是它如何工作的示例：

```
setTimeout("alert('hello world');", 5000); 
```

第一个参数是您的 javascript 引擎将解析为执行代码的字符串，第二个参数是一个整数值，表示您希望在第一个参数中的代码执行之前延迟多少毫秒。

# c# - 从方法中检索调用方法名称

> ID：615940
> 
> 赞同：65
> 
> 时间：2009-03-05T18:22:37.223
> 
> 标签：c#, reflection, methods, calling-convention

我在对象中有一个方法，该方法从对象中的多个位置调用。有没有一种快速简便的方法来获取调用这个流行方法的方法的名称。

伪代码示例：

```
public Main()
{
     PopularMethod();
}

public ButtonClick(object sender, EventArgs e)
{
     PopularMethod();
}

public Button2Click(object sender, EventArgs e)
{
     PopularMethod();
}

public void PopularMethod()
{
     //Get calling method name
} 
```

在里面`PopularMethod()`我想看看`Main`if it was called from `Main`... 我想看看 " `ButtonClick`" if `PopularMethod()`was called from`ButtonClick`

我在看，`System.Reflection.MethodBase.GetCurrentMethod()`但这不会让我得到调用方法。我看过这个`StackTrace`类，但我真的不喜欢每次调用该方法时都运行整个堆栈跟踪。

* * *

## 回答 #1

> 赞同：184
> 
> 时间：2013-01-02T13:08:21.680

在 .NET 4.5 / C# 5 中，这很简单：

```
public void PopularMethod([CallerMemberName] string caller = null)
{
     // look at caller
} 
```

**编译器**自动添加调用者的名字；所以：

```
void Foo() {
    PopularMethod();
} 
```

将通过`"Foo"`。

* * *

## 回答 #2

> 赞同：79
> 
> 时间：2009-03-05T18:29:32.637

我认为不跟踪堆栈就无法完成。但是，这样做相当简单：

```
StackTrace stackTrace = new StackTrace();
MethodBase methodBase = stackTrace.GetFrame(1).GetMethod();
Console.WriteLine(methodBase.Name); // e.g. 
```

但是，我认为你真的必须停下来问问自己这是否有必要。

* * *

## 回答 #3

> 赞同：17
> 
> 时间：2009-03-05T18:27:37.633

这实际上非常简单。

```
public void PopularMethod()
{
    var currentMethod = System.Reflection.MethodInfo
        .GetCurrentMethod(); // as MethodBase
} 
```

但是要小心，我有点怀疑内联该方法是否有任何效果。您可以这样做以确保 JIT 编译器不会妨碍您。

```
[System.Runtime.CompilerServices.MethodImpl(
 System.Runtime.CompilerServices.MethodImplOptions.NoInlining)]
public void PopularMethod()
{
    var currentMethod = System.Reflection.MethodInfo
        .GetCurrentMethod();
} 
```

获取调用方法：

```
[System.Runtime.CompilerServices.MethodImpl(
 System.Runtime.CompilerServices.MethodImplOptions.NoInlining)]
public void PopularMethod()
{
    // 1 == skip frames, false = no file info
    var callingMethod = new System.Diagnostics.StackTrace(1, false)
         .GetFrame(0).GetMethod();
} 
```

* * *

## 回答 #4

> 赞同：5
> 
> 时间：2009-03-05T18:30:12.307

只需传入一个参数

```
public void PopularMethod(object sender)
{

} 
```

IMO：如果它对事件来说足够好，它应该足够好。

* * *

## 回答 #5

> 赞同：4
> 
> 时间：2012-07-25T12:16:35.323

我经常发现自己想要这样做，但最终总是重构我的系统设计，所以我没有得到这种“摇尾巴”的反模式。结果始终是更强大的架构。

* * *

## 回答 #6

> 赞同：1
> 
> 时间：2009-03-05T18:34:28.927

虽然您可以最明确地跟踪堆栈并以这种方式计算出来，但我会敦促您重新考虑您的设计。如果您的方法需要了解某种“状态”，我会说只需创建一个枚举或其他东西，并将其作为您的 PopularMethod() 的参数。类似的东西。根据您发布的内容，跟踪堆栈将是过度的 IMO。

* * *

## 回答 #7

> 赞同：0
> 
> 时间：2009-03-05T18:34:24.920

我认为您确实需要使用该`StackTrace`课程，然后`StackFrame.GetMethod()`在下一帧上使用。

不过，这似乎是一件奇怪的事情`Reflection`。如果您正在定义`PopularMethod`，则无法定义参数或其他东西来传递您真正想要的信息。（或放入基类或其他东西......）

# java - 如何从我的 Java 应用程序运行批处理文件？

> ID：615948
> 
> 赞同：116
> 
> 时间：2009-03-05T18:24:25.863
> 
> 标签：java, batch-file, runtime.exec

在我的 Java 应用程序中，我想运行一个调用“ `scons -Q implicit-deps-changed build\file_load_type export\file_load_type`”的批处理文件

看来我什至无法让我的批处理文件执行。我没主意了。

这就是我在 Java 中所拥有的：

```
Runtime.
   getRuntime().
   exec("build.bat", null, new File(".")); 
```

以前，我有一个我想运行的 Python Sconscript 文件，但由于它不起作用，我决定通过批处理文件调用该脚本，但该方法尚未成功。

* * *

## 回答 #1

> 赞同：190
> 
> 时间：2009-03-05T18:35:47.303

批处理文件不是可执行文件。他们需要一个应用程序来运行它们（即 cmd）。

在 UNIX 上，脚本文件在文件开头有 shebang (#!) 以指定执行它的程序。Windows 中的双击由 Windows Explorer 执行。 `CreateProcess`对此一无所知。

```
Runtime.
   getRuntime().
   exec("cmd /c start \"\" build.bat"); 
```

注意：使用该`start \"\"`命令，将打开一个带有空白标题的单独命令窗口，并且批处理文件的任何输出都将显示在那里。它也应该只使用“cmd /c build.bat”，在这种情况下，如果需要，可以从 Java 中的子进程读取输出。

* * *

## 回答 #2

> 赞同：22
> 
> 时间：2011-11-24T21:40:43.603

有时线程执行处理时间高于JVM线程等待处理时间，这通常发生在你正在调用的进程需要一些时间来处理时，使用waitFor()命令如下：

```
try{    
    Process p = Runtime.getRuntime().exec("file location here, don't forget using / instead of \\ to make it interoperable");
    p.waitFor();

}catch( IOException ex ){
    //Validate the case the file can't be accesed (not enought permissions)

}catch( InterruptedException ex ){
    //Validate the case the process is being stopped by some external situation     

} 
```

这样，JVM 将停止，直到您调用的进程完成，然后再继续线程执行堆栈。

* * *

## 回答 #3

> 赞同：20
> 
> 时间：2011-10-31T09:56:25.907

```
Runtime runtime = Runtime.getRuntime();
try {
    Process p1 = runtime.exec("cmd /c start D:\\temp\\a.bat");
    InputStream is = p1.getInputStream();
    int i = 0;
    while( (i = is.read() ) != -1) {
        System.out.print((char)i);
    }
} catch(IOException ioException) {
    System.out.println(ioException.getMessage() );
} 
```

* * *

## 回答 #4

> 赞同：14
> 
> 时间：2009-03-05T18:39:00.460

[ProcessBuilder](http://java.sun.com/javase/6/docs/api/java/lang/ProcessBuilder.html)是运行外部进程的 Java 5/6 方式。

* * *

## 回答 #5

> 赞同：14
> 
> 时间：2012-10-10T18:12:09.733

如果您正在谈论使用 java 运行批处理文件...

```
String path="cmd /c start d:\\sample\\sample.bat";
Runtime rn=Runtime.getRuntime();
Process pr=rn.exec(path);` 
```

这应该这样做。

* * *

## 回答 #6

> 赞同：11
> 
> 时间：2009-03-05T18:28:30.457

用于运行批处理脚本的可执行文件使用`cmd.exe`标志`/c`来指定要运行的批处理文件的名称：

```
Runtime.getRuntime().exec(new String[]{"cmd.exe", "/c", "build.bat"}); 
```

从理论上讲，您也应该能够以这种方式运行 Scons，尽管我还没有对此进行测试：

```
Runtime.getRuntime().exec(new String[]{"scons", "-Q", "implicit-deps-changed", "build\file_load_type", "export\file_load_type"}); 
```

编辑：阿马拉，你说这行不通。您列出的错误是您在 Windows 机器上从 Cygwin 终端运行 Java 时遇到的错误；这是你在做什么？问题在于 Windows 和 Cygwin 具有不同的路径，因此 Windows 版本的 Java 不会在 Cygwin 路径上找到 scons 可执行文件。如果这是您的问题，我可以进一步解释。

* * *

## 回答 #7

> 赞同：5
> 
> 时间：2013-06-13T12:34:32.213

```
Process p = Runtime.getRuntime().exec( 
  new String[]{"cmd", "/C", "orgreg.bat"},
  null, 
  new File("D://TEST//home//libs//")); 
```

用jdk1.5和jdk1.6测试

这对我来说很好，希望对其他人也有帮助。为了得到这个，我挣扎了更多天。:(

* * *

## 回答 #8

> 赞同：2
> 
> 时间：2016-06-08T21:33:00.630

我遇到过同样的问题。但是有时 CMD 无法运行我的文件。这就是为什么我在我的桌面上创建一个 temp.bat，接下来这个 temp.bat 将运行我的文件，接下来将删除临时文件。

我知道这是一个更大的代码，但是即使 Runtime.getRuntime().exec() 失败，它也能 100% 地为我工作。

```
// creating a string for the Userprofile (either C:\Admin or whatever)
String userprofile = System.getenv("USERPROFILE");

BufferedWriter writer = null;
        try {
            //create a temporary file
            File logFile = new File(userprofile+"\\Desktop\\temp.bat");   
            writer = new BufferedWriter(new FileWriter(logFile));

            // Here comes the lines for the batch file!
            // First line is @echo off
            // Next line is the directory of our file
            // Then we open our file in that directory and exit the cmd
            // To seperate each line, please use \r\n
            writer.write("cd %ProgramFiles(x86)%\\SOME_FOLDER \r\nstart xyz.bat \r\nexit");
        } catch (Exception e) {
            e.printStackTrace();
        } finally {
            try {
                // Close the writer regardless of what happens...
                writer.close();
            } catch (Exception e) {
            }

        }

        // running our temp.bat file
        Runtime rt = Runtime.getRuntime();
        try {

            Process pr = rt.exec("cmd /c start \"\" \""+userprofile+"\\Desktop\\temp.bat" );
            pr.getOutputStream().close();
        } catch (IOException ex) {
            Logger.getLogger(MainFrame.class.getName()).log(Level.SEVERE, null, ex);

        }
        // deleting our temp file
        File databl = new File(userprofile+"\\Desktop\\temp.bat");
        databl.delete(); 
```

* * *

## 回答 #9

> 赞同：1
> 
> 时间：2015-03-11T12:26:57.003

以下工作正常：

```
String path="cmd /c start d:\\sample\\sample.bat";
Runtime rn=Runtime.getRuntime();
Process pr=rn.exec(path); 
```

* * *

## 回答 #10

> 赞同：0
> 
> 时间：2018-01-13T17:04:23.530

此代码将执行路径 C:/folders/folder 中存在的两个 commands.bat。

```
Runtime.getRuntime().exec("cd C:/folders/folder & call commands.bat"); 
```

* * *

## 回答 #11

> 赞同：0
> 
> 时间：2021-03-24T17:21:42.673

```
import java.io.IOException;

public class TestBatch {

    public static void main(String[] args) {
        {
            try {
                String[] command = {"cmd.exe", "/C", "Start", "C:\\temp\\runtest.bat"};
                Process p =  Runtime.getRuntime().exec(command);           
            } catch (IOException ex) {
            }
        }

    }

} 
```

* * *

## 回答 #12

> 赞同：-1
> 
> 时间：2018-03-14T18:08:44.823

要扩展[@Isha's anwser](https://stackoverflow.com/a/7952126/409958)，您可以执行以下操作来获取运行的脚本的返回输出（事后不是实时）：

```
try {
    Process process = Runtime.getRuntime().exec("cmd /c start D:\\temp\\a.bat");
    System.out.println(process.getText());
} catch(IOException e) {
    e.printStackTrace();
} 
```

# c# - 如何访问 GridView 的 HeaderTemplate 中的控件

> ID：615950
> 
> 赞同：10
> 
> 时间：2009-03-05T18:24:43.693
> 
> 标签：c#, asp.net, findcontrol

我想在我的 GridView 的标题中有一个 DropDownList。在我的代码隐藏中，我似乎无法访问它。这是标头模板：

```
<asp:TemplateField SortExpression="EXCEPTION_TYPE">
    <HeaderTemplate>
        <asp:Label ID="TypeId" runat="server" Text="Type" ></asp:Label>
        <asp:DropDownList ID="TypeFilter" runat="server" AutoPostBack="true">
        </asp:DropDownList>
    </HeaderTemplate>
    ...
</asp:TemplateField> 
```

这是我试图访问控件“TypeFilter”的代码中的部分。

```
protected void ObjectDataSource1_Selected(object sender, 
                                          ObjectDataSourceStatusEventArgs e)
{
    DataTable dt = (DataTable)e.ReturnValue;
    int NumberOfRows = dt.Rows.Count;
    TotalCount.Text = NumberOfRows.ToString();
    DataView dv = new DataView(dt);
    DataTable types = dv.ToTable(true, new string[] { "EXCEPTION_TYPE" });
    DropDownList typeFilter = (DropDownList)GridView1.FindControl("TypeFilter");
    typeFilter.DataSource = types;
    typeFilter.DataBind();

} 
```

您会注意到我正在尝试使用 FindControl 来获取对 DropDownList 控件的引用。此调用返回 null 而不是返回控件。如何访问控件？

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2009-03-13T18:54:58.080

使用中继器，您可以使用 OnItemDataBoundEvent 中的 FindControl 访问 headerTemplate 项目，如下所示：

```
RepeaterItem item = (RepeaterItem)e.Item;
if (item.ItemType == ListItemType.Header) {
    item.FindControl("control"); //goes here
} 
```

这也适用于 GridViews 吗？

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2013-06-18T12:52:54.823

```
private void GetDropDownListControl()
    {
        DropDownList TypeFilter = ((DropDownList)this.yorGridView.HeaderRow.FindControl("TypeFilter"));
    } 
```

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2011-08-09T11:16:46.333

```
protected void ObjectDataSource1__RowDataBound(object sender, GridViewRowEventArgs e)
    {
        if (e.Row.RowType == DataControlRowType.Header)
        {
             DropDownList typeFilter = (DropDownList)GridView1.FindControl("TypeFilter");
        }
     } 
```

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2013-08-23T10:19:40.487

如果需要的话，试试这个在 HeaderTemplate 中找到一个没有行数据绑定的控件：

```
private void Lab_1_GV1_Populate_SearchText()
    {
        GridView GV1 = (GridView)FindControl("Lab_1_GV1");
        TextBox TXB1 = (TextBox)GV1.HeaderRow.FindControl("Lab_1_TX2GV1");
    } 
```

谢谢

鲁契尔

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2012-05-22T13:14:09.177

```
protected void GridView_RowDataBound(object sender, GridViewRowEventArgs e)
{
if (e.Row.RowType == DataControlRowType.Header)
{
DropDownList ddlLocation = (DropDownList)e.Row.FindControl("ddlLocation");
ddlLocation.DataSource = dtLocation;
ddlLocation.DataBind();
}
}
} 
```

# ruby - Ruby整数到二进制字符串

> ID：615954
> 
> 赞同：0
> 
> 时间：2009-03-05T18:25:50.057
> 
> 标签：ruby, encryption, binary, cryptography

我需要加密一个整数，但所有的加密库都只支持字符串。

在Ruby中将整数转换为二进制字符串的正确方法是什么？（不是'10111'，我认为它是ASCII值）

编辑：我没有考虑将 Rijndael 作为流加密。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-03-05T18:32:26.640

流加密算法适用于流——一系列字符。您可以将其视为整数或换行符。

Rijndael（分组密码）会很乐意接受非 128 位字符串（流，如果你愿意的话）并用 0 填充结尾。查看文档并试一试。

# c# - 在 C# 下，try、throw 和 catch 块对性能的影响有多大

> ID：615955
> 
> 赞同：15
> 
> 时间：2009-03-05T18:25:59.977
> 
> 标签：c#, performance, catch-block

首先，免责声明：我有其他语言的经验，但仍在学习 C# 的精妙之处

关于问题...我正在查看一些代码，它以与我有关的方式使用 try/catch 块。当调用解析例程时，程序员使用以下逻辑而不是返回错误代码

```
catch (TclException e) {
  throw new TclRuntimeError("unexpected TclException: " + e.Message,e);
} 
```

这被调用者捕获，它抛出相同的错误......
被调用者捕获，它抛出相同的错误......
...... 被调用者捕获，它抛出相同的错误...

备份大约 6 个级别。

我认为所有这些 catch/throw 块都会导致性能问题，或者这是 C# 下的合理实现吗？

* * *

## 回答 #1

> 赞同：16
> 
> 时间：2009-03-05T18:30:59.873

在任何语言下都是一个糟糕的设计。

异常被设计为在您可以处理它们的级别被捕获。捕获异常，然后再次抛出它只是浪费时间（它还会导致您丢失有关原始错误位置的宝贵信息）。

显然，编写该代码的人曾经使用错误代码，然后在没有真正理解它们如何工作的情况下切换到异常。如果在某一级别没有捕获，异常会自动“冒泡”堆栈。

另外，请注意，异常是针对*异常*事件。不该*发生*的事情。它们不应该用于正常的有效性检查（即，不要捕获被零除的异常；预先检查除数是否为零）。

* * *

## 回答 #2

> 赞同：15
> 
> 时间：2009-03-05T18:36:37.940

根据[msdn:Performance Tips and Tricks](http://msdn.microsoft.com/en-us/library/ms973839.aspx?ppud=4)，您可以使用 try 和 catch 而不会出现任何性能问题**，直到真正的 throw 发生**。

* * *

## 回答 #3

> 赞同：12
> 
> 时间：2009-03-05T18:31:14.600

投掷（而不是接球）是昂贵的。

除非您打算做一些有用的事情（即转换为更有用的异常，处理错误），否则不要放入 catch 块。

只是重新抛出异常（不带参数的 throw 语句），或者更糟糕的是，抛出与刚刚捕获的对象相同的对象，这绝对是错误的事情。

编辑：为避免歧义：

重新抛出：

```
catch (SomeException) {
  throw;
} 
```

从先前的异常对象创建异常，其中所有运行时提供的状态（特别是堆栈跟踪）都被覆盖：

```
catch (SomeException e) {
  throw e;
} 
```

后一种情况是丢弃有关异常的信息的毫无意义的方法。并且在 catch 块中的 throw 之前没有任何东西是毫无意义的。情况可能更糟：

```
catch (SomeException e) {
  throw new SomeException(e.Message);
} 
```

它丢失了几乎所有有用的状态信息 e 包含（包括最初抛出的内容。）

* * *

## 回答 #4

> 赞同：2
> 
> 时间：2009-03-05T19:00:22.780

通常，在 .NET 中引发异常的成本很高。简单地有一个 try/catch/finally 块不是。所以，是的，从性能的角度来看，现有代码很糟糕，因为当它抛出时，它会抛出 5-6 个臃肿的异常，而不会增加任何价值，而不是简单地让原始异常自然地冒出 5-6 个堆栈帧。

更糟糕的是，从设计的角度来看，现有代码确实很糟糕。异常处理的主要好处之一（与返回错误代码相比）是您不需要到处检查异常/返回代码（在调用堆栈中）。*您只需要在您真正想要处理*它们的少数地方捕获它们。忽略异常（与忽略返回码不同）不会忽略或隐藏问题。这只是意味着它将在调用堆栈的更高层处理。

* * *

## 回答 #5

> 赞同：2
> 
> 时间：2009-03-05T20:18:43.840

这本身并不可怕，但人们应该真正注意筑巢。

可接受的用例如下：

我是一个低级组件，可能会遇到许多不同的错误，但是我的消费者只对特定类型的异常感兴趣。因此我可以这样做：

```
catch(IOException ex)
{
    throw new PlatformException("some additional context", ex);
} 
```

现在，这允许消费者执行以下操作：

```
try
{
    component.TryThing();
}
catch(PlatformException ex)
{
   // handle error
} 
```

是的，我知道有些人会说，但是消费者应该捕获 IOException ，但这取决于消费代码的实际抽象程度。如果 Impl 正在将某些内容保存到磁盘并且消费者没有正当理由认为他们的操作会触及磁盘怎么办？在这种情况下，将此异常处理放在消费代码中是没有意义的。

通过使用这种模式，我们通常试图避免的是在业务逻辑代码中放置一个“包罗万象”的异常处理程序，因为我们想找出所有可能的异常类型，因为它们可能会导致需要解决的更基本的问题进行了调查。如果我们没有捕捉到，它就会冒泡，到达“顶级”级别的处理程序，并且*应该*停止应用程序继续运行。这意味着客户*将*报告该异常，您将有机会对其进行调查。当您尝试构建强大的软件时，这一点很重要。您需要找到所有这些错误情况并编写特定的代码来处理它们。

不是很漂亮的是嵌套过多，这就是你应该用这段代码解决的问题。

正如另一张海报所说，例外是合理的异常行为，但不要走得太远。基本上，代码应该表达“正常”操作，异常应该处理您可能遇到的潜在问题。

在性能异常方面很好，如果您使用调试器对嵌入式设备进行测试，您将得到可怕的结果，但在没有调试器的版本中，它们实际上非常快。

人们在讨论异常的性能时忘记的主要事情是，在错误情况下，一切都会变慢，因为用户遇到了问题。当网络中断并且用户无法保存他们的工作时，我们真的关心速度吗？我非常怀疑以几毫秒的速度将错误报告返回给用户是否会有所作为。

讨论异常时要记住的主要准则是**异常不应发生在正常的应用程序流程中**（正常意味着没有错误）。其他一切都源于该声明。

在您给出的确切示例中，我不确定。在我看来，将看似通用的 tcl 异常包装在另一个通用的听起来 tcl 异常中并没有真正获得任何好处。如果有的话，我建议追踪代码的原始创建者并了解他的想法背后是否有任何特定的逻辑。虽然你可能会杀死捕获物。

* * *

## 回答 #6

> 赞同：1
> 
> 时间：2009-03-05T18:33:17.853

Try / Catch / Throw 很慢 - 一个更好的实现是在捕获它之前检查值，但如果你绝对不能继续，你最好只在它重要时投掷和捕捉。否则，检查和记录会更有效。

* * *

## 回答 #7

> 赞同：0
> 
> 时间：2009-03-05T19:01:49.173

如果堆栈的每一层都只是用相同的信息重新抛出相同的类型，没有添加任何新内容，那么这完全是荒谬的。

如果它发生在独立开发的库之间的边界，这是可以理解的。有时库作者想要控制从他们的库中逃逸的异常，以便他们以后可以更改其实现，而不必弄清楚如何模拟以前版本的异常抛出行为。

在没有充分理由的情况下，在任何情况下接住并重新投掷通常是一个坏主意。这是因为一旦找到 catch 块，就会执行 throw 和 catch 之间的所有 finally 块。只有在可以从中恢复异常时才会发生这种情况。在这种情况下没关系，因为正在捕获特定类型，因此代码的作者（希望）知道他们可以安全地撤消自己的任何内部状态更改以响应该特定异常类型。

因此，这些 try/catch 块可能在设计时产生成本——它们使程序更加混乱。但是在运行时，它们只会在抛出异常时产生很大的成本，因为将异常向上传输到堆栈已经变得更加复杂。

* * *

## 回答 #8

> 赞同：-1
> 
> 时间：2009-03-05T19:02:42.993

异常很慢，尽量不要使用它们。

[请参阅我在这里](https://stackoverflow.com/questions/161942/how-slow-are-net-exceptions/162027#162027)给出的答案。

基本上，Chris Brumme（CLR 团队的成员）说它们是作为 SEH 异常实现的，所以当它们被抛出时你会受到很大的打击，当它们在操作系统堆栈中冒泡时，你必须承受惩罚。这是一篇真正[优秀的文章](http://blogs.msdn.com/cbrumme/archive/2003/10/01/51524.aspx)，深入探讨了抛出异常时会发生什么。例如。：

* * *

> 当然，异常的最大代价是你实际抛出异常的时候。我会在博客快结束时回到这个话题。

* * *

> 表现。当您实际抛出和捕获异常时，异常会产生直接成本。它们还可能具有与在方法入口上推送处理程序相关的间接成本。通过限制代码生成机会，它们通常会付出不小的代价。

* * *

> 但是，有一个严重的长期性能问题，例外情况必须考虑到您的决定。
> 
> 考虑抛出异常时发生的一些事情：
> 
> *   通过解释编译器发出的元数据来获取堆栈跟踪，以指导我们的堆栈展开。
>     
>     
> *   在堆栈上运行一系列处理程序，调用每个处理程序两次。
>     
>     
> *   补偿 SEH、C++ 和托管异常之间的不匹配。
>     
>     
> *   分配一个托管的 Exception 实例并运行它的构造函数。这很可能涉及查找各种错误消息的资源。
>     
>     
> *   可能通过操作系统内核进行一次旅行。经常出现硬件异常。
>     
>     
> *   通知任何附加的调试器、分析器、向量异常处理程序和其他相关方。
>     
>     
> 
> 这距离从您的函数调用返回 -1 仅数光年。异常本质上是非本地的，如果今天的架构有一个明显且持久的趋势，那就是你必须保持本地以获得良好的性能。

有些人会声称异常不是问题，没有性能问题，通常是一件好事。这些人得到了很多普选票，但他们完全错了。我已经看到微软员工提出了同样的要求（通常具有通常为营销部门保留的技术知识），但从马口中得出的底线是要谨慎使用它们。

古老的格言，*异常应该只用于特殊情况*，这对于 C# 和其他任何语言一样都是正确的。

# .net - 在 web.config 中指定机器密钥

> ID：615957
> 
> 赞同：0
> 
> 时间：2009-03-05T18:26:27.387
> 
> 标签：.net

在网络场的 web.config 中指定机器密钥时是否存在任何安全风险？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2009-03-05T18:39:18.650

如果有人读取机器密钥，这可能是个问题。一个明显的例子是它用于检查视图状态是否被篡改。任何拥有密钥的人都可以绕过它。

请参阅[http://msdn.microsoft.com/en-us/library/dtkwfdky.aspx#](http://msdn.microsoft.com/en-us/library/dtkwfdky.aspx#)，它解释了如何加密它。

哦，最糟糕的是表单身份验证使用它 - 请参阅[ASP.NET 中的 MachineKey 使用](https://stackoverflow.com/questions/550210/uses-for-machinekey-in-asp-net)

也就是说，当有钥匙时，这是一个可以理解的问题。如果有人得到它，那是个问题。如果您尝试保护，那么您需要另一个密钥（即使它是隐藏的）。此外，有人首先得到它。

# c# - 有人可以给我一个正则表达式来识别编码的 URL 吗？

> ID：615958
> 
> 赞同：1
> 
> 时间：2009-03-05T18:26:37.560
> 
> 标签：c#, regex, linux, url

我目前正在寻找检测 URL 是否已编码。下面是一些具体的例子：

1.  `http://www.linxology.com/browse.php?u=Oi8vZXNwbnN0YXIuY29tL21lZGlhLXBsYXllci8%3D&b=13`
2.  `http://www.linxology.com/browse.php?u=Oi8vZXNwbnN0YXIuY29tL290aGVyX2ZpbGVzL2VzcG5zdGFyL25hdl9iZy1vZmYucG5n&b=13`

你能给我一个正则表达式吗？是否有一个自学习正则表达式生成器可以随着输入数量的增加过滤完美的正则表达式？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2009-03-06T22:04:12.237

如果您对 base64 编码的 URL 感兴趣，可以这样做。

一点理论。如果`L`,`R`是正则语言并且`T`是正则转换器，则`LR`(concatenation), `L & R`(intersection), `L | R`(union), `TR(L)`(image), `TR^-1(L)`(kernel) 都是正则语言。每个正则语言都有一个生成它的正则表达式，每个正则表达式都生成一个正则语言。URL 可以用常规语言来描述（除非您需要那些不是的子集），几乎每个转义方案（和 base64）都是常规转换器。因此，理论上是可以的。

在实践中，它变得相当混乱。

有效 base64 字符串的正则表达式是`([A-Za-z0-9+/]{4})*(|[A-Za-z0-9+/]{2}(==|[A-Za-z0-9+/]=)`

如果它嵌入在 url 的查询参数中，它可能会被 urlencoded。让我们假设只有 = 将被 urlencoded（因为其他字符也可以，但不需要）。

这让我们得到类似的东西`[?&][^?&#=;]+=([A-Za-z0-9+/]{4})*(|[A-Za-z0-9+/]{2}(%3D%3D|[A-Za-z0-9+/]%3D)`

另一种可能性是只考虑那些具有某些属性的base64编码的URL - 在你的情况下，你都以“：//”开头，这是幸运的，因为这正好转换为4个字符“Oi8v”。否则，它会更复杂。

这得到`[?&][^?&#=;]+=Oi8v([A-Za-z0-9+/]{4})*(|[A-Za-z0-9+/]{2}(%3D%3D|[A-Za-z0-9+/]%3D)`

如您所见，它变得越来越混乱。因此，我建议您宁愿

1.  分解 URL 的各个部分（例如协议、主机、查询字符串）
2.  从查询字符串中获取参数，并对它们进行 urldecode
3.  尝试对参数值进行 base64 解码
4.  将您的标准应用于“良好的编码 URL”

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-03-05T18:55:53.697

好吧，根据编码文本中的内容，您甚至可能不需要正则表达式。如果那个“u”键中有多个查询字符串参数，也许你可以检查每个查询字符串值的文本长度，如果它超过（比如）50，你可以假设它可能是编码的。我怀疑任何未编码的单个参数都与这些参数一样长，因为它们必须是字符串数据，因此它们可能需要编码！

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-03-05T19:03:50.403

这个问题可能比你意识到的要难。例如：

我可以说，如果查询字符串包含问号字符，那么它后面的内容就会被编码。

现在，它可能是像“？year=2009”这样的简单编码，也可能是像您的示例中那样复杂的编码。

或者

站点 URL 可以使用 URL 重写（就像这个站点一样）。看这个问题的网址。“615958”被编码并且......没有使用问号！

事实上，你可以说整个 URL 都被编码了！

也许您需要更好地定义“编码”的含义。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2009-03-05T19:04:45.890

您无法使用正则表达式可靠地解析 URL。（这是一个如此的口头禅吗？）

> 下面是一些具体的例子：

不清楚“编码”是什么意思——你能给出一些你认为“未编码”的 URL 的反例吗？

你在谈论'u'参数中的[Base64编码吗？](http://en.wikipedia.org/wiki/Base64)虽然可以判断一个字符串是否是有效的 Base64 字符串，但无法检测 Base64 并将其与其他任何字符串区分开来；例如，单词“sausages”也恰好是有效的 Base64（解码为 '\xb1\xab\xacj\x07\xac'）。

# domain-driven-design - 可以将 Datacontext 设置为存储库中的属性吗？

> ID：615960
> 
> 赞同：3
> 
> 时间：2009-03-05T18:26:40.383
> 
> 标签：domain-driven-design, repository-pattern, datacontext

将 datacontext 设置为这样的属性是否有任何潜在问题：

存储库

```
public Repository()
{ 
    public DataContext dc {get;set;}

    public GetOrders(int id)
       { ...from dc.Orders...}
} 
```

服务层：

```
public GetNewOrders()
   {
       ....
       Repository rep=new Repository();
       using {DataContext dc=new DataContext())
        { 
           rep.dc=dc;
           rep.GetOrders(id);
        }
    } 
```

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2009-03-05T19:16:46.143

根据我的阅读，将 DataContext[用于多个业务对话**​​通常是错误的做法**](http://odetocode.com/Blogs/scott/archive/2008/12/11/12384.aspx)。向下滚动到**为什么这很重要？**报价部分。由于缓存和其他因素，您应该立即考虑您的 DataContext 陈旧。由此可以肯定地说，您不想将 DataContext 保留为所有方法都重用的属性。使用 Eric Duncan 的建议，您将需要传入某种 DataContext 工厂以获取每个查询的新上下文。

对于专注于 DataContext 的讨论，APress **Pro LINQ**书有一[整章](http://www.springerlink.com/content/q162545263q20072/)介绍了 DataContext，其中[最后一页](http://books.google.com/books?q=datacontext+stale+immediately&btnG=Search+Books)还建议您“立即考虑 DataContext 过时”。

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2009-03-05T18:58:06.343

在 DDD 中，通过引用具体类，您在这里错过了更大的图景。通过最佳实践，您没有在存储库和“服务层”之间进行交互。如果您必须将 DataContext 注入存储库，我建议重构为：

```
public interface IRepository
{
  IList<Orders> GetNewOrders();
}
public Repository : IRepository
{
  private IDataContext _dataContext;
  public Repository(IDataContext dataContext)
  {
    _dataContext = dataContext;
  }
  public IList<Orders> GetNewOrders()
  {
    // perform your actions on _dataContext here
  }
} 
```

更好的解决方案是让 Repository 自己处理 DataContext - 通过掩盖底层要求来保持 Concert 的分离有效：

```
public interface IRepository
{
  IList<Orders> GetNewOrders();
}
public Repository : IRepository
{
  private IDataContext _dataContext;
  public Repository(String connectionString)
  {
    _dataContext = new DataContext(connectionString);
  }
  public IList<Orders> GetNewOrders()
  {
    // perform your actions on _dataContext here
  }
} 
```

如果您必须自己控制 DataContext（或其他类）（也许您想保留一个静态引用，或者基于 WebRequest 更改设置等），您将需要使用“工厂”。

工厂看起来像这样：

```
public static class DataContextFactory
{
  public static IDataContext GetInstance()
  {
    // return either a static instance, 
    // or threaded instance, a GlobalContext instance
    // or whatever your preference is here
    // 
  }
} 
```

这样，您就可以完全控制如何在“服务”层之外和之外控制 DataContext 的实例。因此，您可以像下面这样使用这个 DataContextFactory：

```
public interface IRepository
{
  IList<Orders> GetNewOrders();
}
public Repository : IRepository
{
  public IList<Orders> GetNewOrders()
  {
    using (var dataContext = DataContextFactory.GetInstance())
    {
      // dataContext is now your IDataContext to work with
    }
  }
} 
```

## “如何访问 IRepository？” 你可能会问？

您的服务层将执行以下操作：

```
public void GetNewOrdersForServices()
{
  // Not recommended!
  //      IRepository repo = new Repository()
  //
  // The following is recommended instead; because, it removes the
  // the Concret reference from your Services layer completely!
  //
  IRepository repo = ServiceLocator.InstanceOf<IRepository>();
  IList myList = repo.GetNewOrders();

} 
```

或者，您可以使用您最喜欢的 Inversion of Control 容器将其注入到服务的构造函数中，如下所示：

```
public class OrderService
{
  private IRepository _repo;

  public OrderService(IRepository repo)
  {
    _repo = repo;
  }

  public void GetNewOrdersForServices()
  {
    IList myList = _repo.GetNewOrders();

  } 
```

如果您不熟悉服务定位器的概念，请查看 Castle Windsor，因为它几乎囊括了您的所有需求。

# c# - 你如何打破实体之间的循环关联？

> ID：615968
> 
> 赞同：13
> 
> 时间：2009-03-05T18:27:53.810
> 
> 标签：c#, sql, oop, modeling

我第一次在该网站上，如果它被错误地标记或在其他地方得到回答，我深表歉意......

我在当前项目中不断遇到特殊情况，我想知道你们将如何处理它。模式是：具有子集合的父级，并且父级具有对子集合中特定项目的一个或多个引用，通常是“默认”子级。

一个更具体的例子：

```
public class SystemMenu 
{
    public IList<MenuItem> Items { get; private set; }
    public MenuItem DefaultItem { get; set; }
}

public class MenuItem
{
    public SystemMenu Parent { get; set; }
    public string Name { get; set; }
} 
```

对我来说，这似乎是一种很好的关系建模方式，但是由于循环关联，我无法在数据库中强制执行关系，并且由于循环外键，LINQ to SQL 爆炸了循环关联。即使我可以绕过这个，这显然不是一个好主意。

我目前唯一的想法是在 MenuItem 上有一个“IsDefault”标志：

```
public class SystemMenu 
{
    public IList<MenuItem> Items { get; private set; }
    public MenuItem DefaultItem 
    {
        get 
        {
            return Items.Single(x => x.IsDefault);
        }
        set
        {
            DefaultItem.IsDefault = false;
            value.DefaultItem = true;
        }
    }
}

public class MenuItem
{
    public SystemMenu Parent { get; set; }
    public string Name { get; set; }
    public bool IsDefault { get; set; }
} 
```

有没有人处理过类似的事情并可以提供一些建议？

干杯!

编辑：感谢到目前为止的回复，也许“菜单”示例并不出色，我试图想一些有代表性的东西，所以我不必深入了解我们不那么不言自明的领域的细节模型！也许更好的例子是公司/员工关系：

```
public class Company
{
    public string Name { get; set; }
    public IList<Employee> Employees { get; private set; }
    public Employee ContactPerson { get; set; }
}

public class Employee
{
    public Company EmployedBy { get; set; }
    public string FullName { get; set; }
} 
```

Employee 肯定需要引用他们的 Company，并且每个 Company 只能有一个 ContactPerson。希望这能让我的原点更清楚一点！

* * *

## 回答 #1

> 赞同：25
> 
> 时间：2009-03-07T17:16:30.563

解决这个问题的诀窍是意识到父母不需要知道孩子的所有方法，孩子也不需要知道父母的所有方法。因此，您可以使用[接口隔离原则](http://www.objectmentor.com/resources/articles/isp.pdf)将它们解耦。

简而言之，您为父级创建了一个接口，该接口只有子级需要的那些方法。您还为子级创建了一个接口，该接口仅具有父级需要的那些方法。然后你让父接口包含一个子接口列表，你让子接口指向父接口。我将其*称为触发器模式*，因为 UML 图具有 Eckles-Jordan 触发器的几何形状（请注意，我是一名老硬件工程师！）

```
 |ISystemMenu|<-+    +->|IMenuItem|
          A    1  \  / *     A
          |        \/        |
          |        /\        |
          |       /  \       |
          |      /    \      |
          |     /      \     |
    |SystemMenu|        |MenuItem| 
```

请注意，此图中没有循环。你不能从一堂课开始，然后按照箭头回到你的起点。

有时，为了使分离恰到好处，您必须移动一些方法。可能有您认为应该在 SystemMenu 中移动到 MenuItem 等的代码。但总的来说，该技术效果很好。

* * *

## 回答 #2

> 赞同：5
> 
> 时间：2009-03-05T18:42:57.567

您的解决方案似乎很合理。

要考虑的另一件事是内存中的对象不必与数据库模式完全匹配。在数据库中，您可以使用具有子属性的更简单的模式，但在内存中，您可以优化事物并让父对象具有对子对象的引用。

* * *

## 回答 #3

> 赞同：3
> 
> 时间：2009-03-07T17:41:46.043

我真的没有看到你的问题。显然，您使用的是 C#，它将对象作为引用而不是实例。这意味着具有交叉引用甚至自引用是完全可以的。

在 C++ 和其他对象组合更多的语言中，您可能会遇到问题，通常使用引用或指针解决这些问题，但 C# 应该没问题。

您的问题很可能是您试图以某种方式遵循所有引用，从而导致循环引用。LINQ 使用延迟加载来解决这个问题。例如，在您引用 Company 或 Employee 之前，LINQ 不会加载它。您只需要避免遵循这些参考超过一个级别。

但是，您不能真正将两个表添加为彼此的外键，否则您将永远无法删除任何记录，因为删除员工需要先删除公司，但您不能在不删除员工的情况下删除公司. 通常，在这种情况下，您只会将一个用作真正的外键，另一个将只是一个伪 FK（即，用作 FK 但未启用约束的一个）。你必须决定哪个是更重要的关系。

在公司示例中，您可能希望删除员工而不是公司，因此将 company->employee FK 设置为约束关系。如果有员工，这可以防止您删除公司，但您可以在不删除公司的情况下删除员工。

此外，避免在这些情况下在构造函数中创建新对象。例如，如果您的 Employee 对象创建了一个新的 Company 对象，其中包括为该员工创建的新员工对象，它最终会耗尽内存。相反，将已经创建的对象传递给构造函数，或者在构造之后设置它们，可能通过使用初始化方法。

例如：

```
Company c = GetCompany("ACME Widgets");
c.AddEmployee(new Employee("Bill")); 
```

然后，在 AddEmployee 中，设置公司

```
public void AddEmployee(Employee e)
{
    Employees.Add(e);
    e.Company = this;
} 
```

* * *

## 回答 #4

> 赞同：2
> 
> 时间：2009-03-05T18:45:55.610

也许自我引用的 GoF 复合模式是这里的命令。一个 Menu 有一个叶子 MenuItem 的集合，它们都有一个共同的接口。这样你就可以用菜单和/或菜单项组成一个菜单。该模式有一个带有外键的表，该外键指向它自己的主键。也适用于步行菜单。

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2009-03-07T17:56:11.950

在代码中，您需要同时引用两种方式来引用事物。但是在数据库中，你只需要引用一种方式就可以了。由于连接的工作方式，您只需要在其中一个表中拥有外键。仔细想想，数据库中的每个外键都可以翻转，并创建和创建循环引用。最好只选择一个记录，在这种情况下，可能是孩子与父母的外键，然后就完成了。

* * *

## 回答 #6

> 赞同：1
> 
> 时间：2009-03-08T12:13:26.480

在领域驱动的设计意义上，您可以选择尽可能避免实体之间的双向关系。选择一个“聚合根”来保存关系，仅在从聚合根导航时使用另一个实体。我尽量避免双向关系。因为 YAGNI，它会让你问“先是先有鸡还是先有蛋？”的问题。有时您仍然需要双向关联，然后选择前面提到的解决方案之一。

```
/// This is the aggregate root
public class Company
{
    public string Name { get; set; }
    public IList<Employee> Employees { get; private set; }
    public Employee ContactPerson { get; set; }
}

/// This isn't    
public class Employee
{
    public string FullName { get; set; }
} 
```

* * *

## 回答 #7

> 赞同：0
> 
> 时间：2009-03-08T12:26:29.240

您可以在两个表相互引用的数据库中强制执行外键。想到了两种方法：

1.  父项中的默认子列最初为 null，并且仅在插入所有子行后才更新。
2.  您将约束检查推迟到提交时间。这意味着您可以先插入对子项的最初引用中断的父项，然后再插入子项。延迟约束检查的一个问题是，您最终可能会在提交时抛出数据库异常，这在许多数据库框架中通常很不方便。此外，这意味着您需要在插入子项之前知道子项的主键，这在您的设置中可能会很尴尬。

我在这里假设父菜单项位于一个表中，而子项位于另一个表中，但如果它们都位于同一个表中，则相同的解决方案将起作用。

许多 DBMS 支持延迟约束检查。尽管您没有提及您正在使用哪个 DBMS，但您的可能也是如此

* * *

## 回答 #8

> 赞同：0
> 
> 时间：2009-03-09T14:15:53.947

感谢所有回答的人，一些非常有趣的方法！最后我不得不匆忙完成一些事情，所以这就是我想出的：

引入了第三个实体，称为`WellKnownContact`和相应的`WellKnownContactType`枚举：

```
public class Company
{
    public string Name { get; set; }
    public IList<Employee> Employees { get; private set; }
    private IList<WellKnownEmployee> WellKnownEmployees { get; private set; }
    public Employee ContactPerson
    {
        get
        {
            return WellKnownEmployees.SingleOrDefault(x => x.Type == WellKnownEmployeeType.ContactPerson);
        }
        set
        {                
            if (ContactPerson != null) 
            {
                // Remove existing WellKnownContact of type ContactPerson
            }

            // Add new WellKnownContact of type ContactPerson
        }
    }
}

public class Employee
{
    public Company EmployedBy { get; set; }
    public string FullName { get; set; }
}

public class WellKnownEmployee
{
    public Company Company { get; set; }
    public Employee Employee { get; set; }
    public WellKnownEmployeeType Type { get; set; }
}

public enum WellKnownEmployeeType
{
    Uninitialised,
    ContactPerson
} 
```

感觉有点麻烦，但绕过了循环引用问题，并且干净地映射到数据库上，这样就省去了试图让 LINQ to SQL 做任何太聪明的事情！还允许多种类型的“知名联系人”，这肯定会在下一个 sprint 中出现（所以不是真正的 YAGNI！）。

有趣的是，一旦我想出了人为的公司/员工示例，它就更容易思考，与我们真正处理的相当抽象的实体形成对比。

# c++ - 如何使用非托管 C++ 获取 Power Point 的运行版本？

> ID：615969
> 
> 赞同：0
> 
> 时间：2009-03-05T18:28:27.757
> 
> 标签：c++, unmanaged, powerpoint, idispatch

我正在使用带有 Power Point（2003 和 2007）的非托管 C++。

如何使用 IDispatch 获得 Power Point 的运行版本（2003 或 2007）？

谢谢，任何帮助都会很棒。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-03-05T19:07:47.850

从 Application 对象中尝试 Version 方法。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-03-10T17:15:29.683

我很抱歉我在另一个项目中工作。我找到了一种使用 CComDispatchDriver 实例获取版本的简单方法。

CComVariant ccVersion；

//disp是CComDispatchDrive类型

disp.GetPropertyByName("版本", ccVersion);

这样做我得到 ccVersion = "11.0" 为 2003 年和 "12.0" 为 2007 年。

要将其转换为字符串，我使用了 CString 类：

CString 版本；

版本 = CString (V_BSTR(&ccVersion));

感谢您的帮助，我希望这对其他人有用

# java - 在 Swing 中运行时更改语言环境

> ID：615973
> 
> 赞同：21
> 
> 时间：2009-03-05T18:28:48.113
> 
> 标签：java, swing, internationalization

我希望能够在运行时更改我的 Swing 应用程序中的语言环境，并让屏幕上的所有文本元素都使用来自新语言环境的 ResourceBundle 的本地化文本进行自我更新。

是否可以在不自定义 Swing 组件或为处理呈现本地化文本的所有组件创建 UIDelegates 的情况下完成此操作？

如果不是，那么我可以考虑实施什么好的解决方案？

* * *

## 回答 #1

> 赞同：17
> 
> 时间：2011-03-01T12:18:12.297

用于`ResourceBundle.getBundle(BUNDLE_NAME).getString(key);`访问字符串。

当更新默认语言环境时，例如通过`Locale.setDefault(Locale.GERMAN);` 清除 Resourcebundle 缓存：`ResourceBundle.clearCache();`

下一次调用`ResourceBundle.getBundle(BUNDLE_NAME).getString(key);`应该返回所选语言环境的本地化字符串。

* * *

## 回答 #2

> 赞同：13
> 
> 时间：2009-05-03T20:53:01.003

1.  您有一个用于更改应用程序区域设置（并且可能保留新值）的方法和另一个用于获取本地化字符串的方法。

2.  创建接口：

    ```
    interface LocaleChangeListener {
        void onLocaleChange();
    } 
    ```

    通过需要能够在运行时更改语言环境并在 overrides 中设置新值的 UI 组件来实现它`onLocaleChange()`。

3.  现在，有一个侦听器列表，将通过第一种方法通知区域设置更改。

* * *

## 回答 #3

> 赞同：3
> 
> 时间：2009-03-05T18:56:08.190

您可能需要保存语言首选项，然后需要重新启动应用程序才能使更改生效。

然后，您应该能够`Locale.setDefault(Locale.<desired language>);`在启动时使用，然后再渲染 GUI。这应该会正确切换您的语言环境，这将导致加载所需的 .properties 文件。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2015-12-10T13:56:36.827

怎么样，在更改语言环境时，执行 firePropertyChangeEvent("locale", "...")，然后添加 propertyChangeListener() 并注册它们，无论标签等要更新吗？

* * *

## 回答 #5

> 赞同：-1
> 
> 时间：2009-03-05T18:45:05.440

我看到了两种明显的方法：

与其`String`从中获取 a `ResourceBundle`，不如获取某种事件源`String`持有者。`Document`将是一个非常繁重的解决方案，但任何可以处理替换不可变值的东西都可以。例如，不仅可以在标签上设置文本，还可以使用一种方法来设置侦听器。请注意，这是一个相当“重”的解决方案。

或者，拥有一个在区域设置更改时触发的侦听器中央存储库，然后每个侦听器都返回并重新执行设置代码的相关部分（不要重复）。对于常见的情况，例如，a`JLabel`按字面意思使用资源字符串，那么您可以将这些全部组合成一个带有 a 的侦听器`WeakHashMap<JLabel,String>`。有时，避免很多小听众会更好。

# .net - .net 如何创建 SHA1 哈希？

> ID：615978
> 
> 赞同：3
> 
> 时间：2009-03-05T18:29:39.050
> 
> 标签：.net, sha1

是否有内置技术可以做到这一点？它期待什么论据？

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2009-03-05T18:31:45.283

根据[MSDN](http://msdn.microsoft.com/en-us/library/system.security.cryptography.sha1.aspx)

```
byte[] data = new byte[DATA_SIZE];
byte[] result; 

SHA1 sha = new SHA1CryptoServiceProvider(); 
// This is one implementation of the abstract class SHA1.
result = sha.ComputeHash(data); 
```

# drm - 我们如何限制用户保存网页？

> ID：615982
> 
> 赞同：8
> 
> 时间：2009-03-05T18:30:08.703
> 
> 标签：drm, restriction

我们如何限制用户保存页面？

请提供一些提示来禁用文件->保存和查看源选项

编辑：显然它不能完成，并且可能不应该尝试。但可能这个问题的一个更有趣的变体是，我们如何才能让用户很难以可用的格式保存页面，以至于他们这样做不值得？这个问题没有任何价值，而是说我们正在保护一个文章订阅网站，用户每年要支付几百美元才能继续访问文本。

* * *

## 回答 #1

> 赞同：55
> 
> 时间：2009-03-05T18:33:07.607

由于页面已发送给客户端，因此总会有一种方法可以获取该信息。试图阻止用户这样做只会让他们感到沮丧。

让用户无法保存文件的唯一方法是不将其发送给他们。

* * *

## 回答 #2

> 赞同：15
> 
> 时间：2009-03-05T18:39:27.387

虽然最好的答案是“不要这样做”，但有一些方法可以让他们更难做到。而且由于该站点的重点实际上是回答问题，即使它很糟糕，这里是最好的方法：

首先，您需要在新窗口中打开页面，在该窗口中关闭地址栏和工具栏以及其他所有内容。这将使用户根本无法轻易进入“文件”菜单。为此，您需要用户加载到的“启动”页面，然后当他们单击链接时，它会打开提供页面主要内容的弹出窗口。关于如何在没有工具栏之类的情况下创建弹出窗口的详细信息在这里： [http ://blazonry.com/javascript/windows.php](http://blazonry.com/javascript/windows.php)

然后，您需要向每个页面添加一些 javascript，以防止用户右键单击。这是一种方法：http: [//javascript.about.com/library/blnoright.htm](http://javascript.about.com/library/blnoright.htm)

最后，如果您不希望看到您的 Javascript 代码，那么混淆您的代码是一种非常有效的方法。如果他们有很多专业知识，他们仍然可以看到代码，但是混淆的代码将是一个巨大的痛苦来实际解释。那里有很多混淆器。这是一个免费的基于网络的： [http ://www.javascriptobfuscator.com/](http://www.javascriptobfuscator.com/)

这远非万无一失。它将阻止所有“临时”用户，但任何高级用户都可能能够轻松找到解决方法。不过，如果这个想法是为了至少阻止其中的大部分，那么这应该就足够了。

**更新问题的更新：** 为了解决您的新扩展问题，我想说完成您所说的最佳方法是使用支持 DRM 的格式。Adobe Acrobat 可能是最佳选择，因为几乎每个人都安装了阅读器。您可以阻止将 PDF 文件保存到计算机，以便它们只能由登录用户从网页加载。用户仍然可以对文档本身进行屏幕截图，我认为这是不可预防的（除非 Adob​​e Reader 对此有一些安全措施，他们可能会这样做），但对于大多数用途来说，它应该是足够的安全性。

* * *

## 回答 #3

> 赞同：11
> 
> 时间：2009-03-05T18:34:09.053

不要这样做。

说真的，如果用户可以在他们的浏览器中看到该页面，他们就可以看到源代码和/或将其保存到他们的计算机上。

你在这里打了一场失败的战斗。

* * *

## 回答 #4

> 赞同：4
> 
> 时间：2009-03-05T19:06:20.507

It's really a waste of time and resources to try and do this in html as any method you use can be trivially circumvented.

Instead I would use some other technology to display the data - you can never get around a screen capture. but if you're for instance displaying text and you want to make it hard for the use to save that text for use elsewhere then possible options include

1.  PDF - which can disable save and print. There are extensions to most popular web languages that will write a pdf on the fly. Indeed you might be as well just to go down the DRM route with Adobe and embed a document

2.  Flash - most probably via Flex which could be used to write a general-purpose app to display text and images. The advantage of Flash is that it's easier to set up links than pdf.

3.  Or something else, a custom java applet, or even a vrml plugin and display the text in 3D!

In all cases you could display text against a disruptive background to make OCR more difficult, and images could be watermarked. However nothing is going to stop a determined and resourceful viewer, although you can possibly make it sufficiently hard that it's not worth their time.

* * *

## 回答 #5

> 赞同：4
> 
> 时间：2009-03-05T18:33:59.227

浏览器的缓存呢？它可以从那里保存。

打印屏幕呢？这也可以保存页面。

阻止用户保存某些内容的唯一方法是首先不向他们显示。

* * *

## 回答 #6

> 赞同：2
> 
> 时间：2009-03-05T19:07:49.067

The least you can do is... the content is generated dynamically by Javascript. In that way, they cannot simply save it. Of course, in FX, they can still view the generated code and then copy&paste. however, normally people cannot save the page.

* * *

## 回答 #7

> 赞同：1
> 
> 时间：2009-03-05T18:41:05.200

这应该不是问题，但是如果您出于某种原因真的不希望用户看到您的代码（javascript、css 或 html），那么您可以使用一些混淆工具来降低代码的可读性。

* * *

## 回答 #8

> 赞同：1
> 
> 时间：2009-03-06T18:06:09.283

尝试javascript“编码”和混淆。

就像是

```
if(document.location == 'mydomain.com') {
  content = getAjax('mycontent.xml');
  // content will hold something like 72, 94, 81, 99, ... - encoded ASCII codes
  document.write(String.fromCharCode(content));
} 
```

总是可以保存页面，但对于非技术人员来说，使其工作更加困难。有2个保护

*   域名
*   转换 ASCII

这只是伪代码，但我想你明白了。

* * *

## 回答 #9

> 赞同：0
> 
> 时间：2018-12-01T15:33:15.110

将这些添加到脚本标记中的代码集

```
document.addEventListener('contextmenu', function (e) {
                e.preventDefault();
});

document.onkeydown = function (e) {
                return false;
}; 
```

* * *

## 回答 #10

> 赞同：-1
> 
> 时间：2009-06-20T07:07:24.883

我想再添加一种方法，恕我直言，很难规避：Ctrl+S！（对我来说，Apple+S）

* * *

## 回答 #11

> 赞同：-1
> 
> 时间：2009-06-20T07:11:26.450

> 我们如何才能让用户以可用的格式保存页面已经足够困难，以至于他们这样做是不值得的

没什么难的：在每一页上添加：“John Stealer 的个人财产，Zetabeta 公司，用信用卡支付 756890987654，账单地址......，订阅将于 12/20 到期”。

这是我刚刚发明的“扩展文本格式”……它有一个惊人的特性：虽然它看起来像普通文本，但用户不太愿意将其打印出来并提供给其他人……

# xslt - XslCompiledTransform 的最快内存缓存

> ID：615991
> 
> 赞同：2
> 
> 时间：2009-03-05T18:31:46.517
> 
> 标签：xslt, xslcompiledtransform

我有一组 xslt 样式表文件。我需要产生 XslConpiledTransform 的最快性能，所以我想在内存中表示这些样式表。

我可以在应用程序启动时将它们作为 IXpathNavigable 加载到内存集合中，然后在每个请求上将每个 IXPAthNavigable 加载到单例 XslCompiledTransform 中。但这仅适用于没有 xsl:import 或 xsl:include 的样式集。（Xsl:import 仅适用于文件）。

我也可以为每个模板加载许多 XSLCompiledTransform 实例到缓存中。合理吗？

还有其他方法吗？哪个最好？提高 MS Xslt 处理器性能的其他技巧是什么？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2009-03-06T04:07:26.587

**[`Load()`](http://msdn.microsoft.com/en-us/library/system.xml.xsl.xslcompiledtransform.load.aspx)在一个实例上成功执行后[`XslCompiledTransform`](http://msdn.microsoft.com/en-us/library/system.xml.xsl.xslcompiledtransform.aspx)，这个实例可以被缓存以达到更好的性能**。

请记住 Load() 是一项非常昂贵的操作。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2010-04-30T15:34:46.577

您可以使用 MS SDK 工具 xsltc.exe（XSL 编译器）生成程序集，而不是在运行时编译和缓存 XSL 转换。

然后，在运行时，您的应用程序将动态加载这些程序集（或者您可以只向应用程序添加静态引用）并调用重载的 XslCompiledTransform.Load(System.Type type) 方法将您编译的类型加载到 XSL 程序集中。

这是绝对最快的方法，因为您不会招致运行时的编译惩罚 - 仅在构建/编译时。

# c++ - 在 C++ 中解析字符串

> ID：615993
> 
> 赞同：1
> 
> 时间：2009-03-05T18:32:17.153
> 
> 标签：c++, parsing, logging, text-parsing

我有大量的日志行，我需要解析每一行（所以效率非常重要）。

每个日志行的格式为

cust_name time_start time_end (IP 或 URL)*

因此，ip 地址、时间、时间和一个可能为空的 ip 地址或 url 列表，以分号分隔。如果最后一个列表中只有 ip 或 url，则没有分隔符。如果超过 1 个，则用分号分隔。

我需要一种方法来解析这一行并将其读入数据结构。time_start 或 time_end 可以是系统时间或 GMT。cust_name 也可以有多个由空格分隔的字符串。

我可以通过逐个字符读取并编写自己的解析器来做到这一点。有一个更好的方法吗 ？

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2009-03-05T18:38:35.517

也许 Boost RegExp lib 会帮助你。 [http://www.boost.org/doc/libs/1_38_0/libs/regex/doc/html/index.html](http://www.boost.org/doc/libs/1_38_0/libs/regex/doc/html/index.html)

* * *

## 回答 #2

> 赞同：5
> 
> 时间：2009-03-05T18:45:16.373

在这类事情上，我已经使用[Boost Tokenizer取得了成功。](http://www.boost.org/doc/libs/1_37_0/libs/tokenizer/index.html)它可以帮助您将输入流分解为标记，并在标记之间使用自定义分隔符。

* * *

## 回答 #3

> 赞同：4
> 
> 时间：2009-03-05T18:53:30.037

使用正则表达式（`boost::regex`对于 C++ 来说是一个很好的实现），您可以轻松地分隔字符串的不同部分 -`cust_name, time_start ...`并找到所有 urls\ips

如果需要，第二步是对该组进行更详细的解析。例如，您可以使用`boost::datetime`库解析日期（如果字符串格式不标准，则编写自定义解析器）。

* * *

## 回答 #4

> 赞同：3
> 
> 时间：2009-03-05T18:36:06.257

为什么要在 C++ 中执行此操作？对于 perl 之类的东西来说，这听起来像是一项显而易见的工作。

* * *

## 回答 #5

> 赞同：2
> 
> 时间：2009-03-05T18:35:25.477

考虑使用[正则表达式库](http://www.boost.org/doc/libs/1_38_0/libs/regex/doc/html/index.html)...

* * *

## 回答 #6

> 赞同：1
> 
> 时间：2009-03-05T18:34:54.263

自定义输入需要自定义解析器。或者，祈祷有一个理想的世界，不存在错误。特别是，如果您想提高效率。发布一些代码可能会有所帮助。

* * *

## 回答 #7

> 赞同：1
> 
> 时间：2009-03-05T18:47:31.720

对于这样一个简单的语法，您可以使用拆分，请查看[http://www.boost.org/doc/libs/1_38_0/doc/html/string_algo/usage.html#id4002194](http://www.boost.org/doc/libs/1_38_0/doc/html/string_algo/usage.html#id4002194)

* * *

## 回答 #8

> 赞同：1
> 
> 时间：2009-03-05T18:59:03.393

**UPDATE**彻底改变了答案！

> 我有大量的日志行，我需要解析每一行（所以效率非常重要）。

请注意，在这种情况下，C++ 在效率方面不会有太大帮助。不要误以为仅仅因为你在 C++ 中有一个快速解析代码，你的程序就会有高性能！

你在这里真正需要的效率不是解析代码的“机器码”级别的性能，而是整体算法级别的性能。

想想你想做什么。
你有一个巨大的文本文件，你想把每一行转换成一个数据结构，

无论您使用什么语言，在内存中存储*巨大的*数据结构都是非常*低效的！*

您需要做的是一次“获取”一行，将其转换为数据结构并进行处理，然后，只有在您完成数据结构后，您才去获取下一行并转换它到一个数据结构，处理它，然后重复。

如果你这样做，你已经解决了主要瓶颈。

对于解析文本行，您的数据格式似乎非常简单，请查看我前段时间提出的类似问题：[C++ string parsing (python style)](https://stackoverflow.com/questions/536148/c-string-parsing-python-style)

在您的情况下，我想您可以使用字符串流，并使用`>>`运算符来读取行中的下一个“事物”。

请参阅[此答案](https://stackoverflow.com/questions/536148/c-string-parsing-python-style/536177#536177)以获取示例代码。

或者，（我不想删除这部分！！）如果你可以用 python 编写它，它会简单得多。我不知道你的情况（看来你被 C++ 困住了），但仍然

查看此演示文稿以使用 python 生成器表达式有效地完成这些任务：[http ://www.dabeaz.com/generators/Generators.pdf](http://www.dabeaz.com/generators/Generators.pdf)

值得一读。在幻灯片 31 中，他处理的内容似乎与您正在尝试做的事情非常相似。

它至少会给你一些灵感。
它还非常强烈地表明，性能不是通过特定的字符串解析代码获得的，而是通过整体算法获得的。

* * *

## 回答 #9

> 赞同：0
> 
> 时间：2009-03-05T18:35:08.317

您可以尝试使用简单的 lex/yacc|flex/bison 词汇来解析这种输入。

* * *

## 回答 #10

> 赞同：0
> 
> 时间：2009-03-06T19:31:35.617

您需要的解析器听起来很简单。[看看这个。](https://stackoverflow.com/questions/615040/writing-a-mini-language/615741#615741)任何编译语言都应该能够以非常高的速度解析它。然后是您构建和保存的数据结构的问题。*********************````*