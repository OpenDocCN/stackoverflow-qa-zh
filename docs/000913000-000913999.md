# StackOverflow 问答 000913000-000913999

# ruby-on-rails - SVN怪异：有没有可能不是我的错

> ID：913003
> 
> 赞同：3
> 
> 时间：2009-05-26T22:05:36.490
> 
> 标签：ruby-on-rails, svn, working-directory

（我真的不在乎这是否是我的错，而是为什么事情会发生，当然......）

我在远程服务器上的 SVN 中有一个 rails 站点。在我的本地副本上，我做了一个切换（svn switch [http://whatever/branch](http://whatever/branch)。），然后事情变得非常奇怪，该站点无法正常工作。我终于找到了它，结果发现构建的一部分（特别是 app/config 目录）指向了错误的分支。请注意：

*   我从不使用 SVN 命令行以外的任何东西进行切换
*   我只在安装的根目录下切换
*   我总是以 root 身份切换（sudo -s），并且我确信在整个树上正确设置了权限（chmod -R 777）

关于工作目录的一部分如何最终指向错误位置的任何想法？在我的记忆中，这不是第一次工作目录的某个子目录指向错误的地方......为什么会发生这种情况？

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2009-05-26T22:37:44.833

在官方 Subversion 常见问题解答中有一整节有关[切换问题的内容。](http://subversion.tigris.org/faq.html#switch-problems)它说：

> 在某些情况下，工作副本中存在未版本化（并且可能被忽略）的项目，svn switch 可能会出错。切换停止，工作副本半切换。

他们的建议是只从干净的工作副本切换。

另一件事是[混合修订工作副本](http://svnbook.red-bean.com/en/1.2/svn.basic.in-action.html#svn.basic.in-action.mixedrevs)。

基本上这意味着您的工作副本中的文件可以（并且通常是）来自不同的修订版。

以下是[SVN 红皮书](http://svnbook.red-bean.com/en/1.2/svn.basic.in-action.html#svn.basic.in-action.mixedrevs)对此的评价（我强调）：

> 例如，假设您有一个完全处于修订版 10 的工作副本。您编辑文件 foo.html，然后执行 svn 提交，这会在存储库中创建修订版 15。提交成功后，**许多新用户会期望工作副本完全处于修订版 15，但事实并非如此！**在版本 10 和 15 之间的版本库中可能发生了任何数量的更改。客户端对版本库中的这些更改一无所知，因为您还没有运行 svn update，并且 svn commit 不会拉下新的更改。另一方面，如果 svn commit 自动下载最新的更改，那么将整个工作副本设置为修订版 15 是可能的——但是我们将打破“推”和“拉”的基本规则剩下的单独行动。因此，Subversion 客户端可以做的唯一安全的事情就是将一个文件——foo.html——标记为修订版 15。工作副本的其余部分保持在修订版 10。只有运行 svn update 才能下载最新的更改，并且整个工作副本标记为修订版 15。

* * *

## 回答 #2

> 赞同：-1
> 
> 时间：2009-05-26T22:31:51.087

对不起，如果你知道你在做什么，但听起来你不知道。（或者问题不清楚）。如果您包含相关目录中**svn status**的结果，我们可以走得更远。

```
svn switch 
```

（svn帮助切换）

用于切换存储库，这不应该是通用工作流程的一部分。

# git - 使用 git 提交到同一个分支

> ID：913012
> 
> 赞同：32
> 
> 时间：2009-05-26T22:08:22.693
> 
> 标签：git, branch

假设有两个人在一个 git 分支上工作，他们同时签出，但其中一个人先提交，另一个人在之后提交。最新的提交是否仍会与之前的提交合并，或者多个人可以同时在同一个分支上工作？

* * *

## 回答 #1

> 赞同：52
> 
> 时间：2009-05-26T22:31:10.340

好吧，当您克隆一个 git 存储库时（这就是您所说的“签出”吗？），您实际上是在创建一个新分支。Git 分支对于每个存储库都是本地的，而不是全局的。话虽如此，您有一个关于如何在存储库之间传输分支更新的协议 - 例如，当您从远程拉取时，默认情况下远程的“主”分支会合并到您的“主”分支中。当您推送时，您的“主”分支可以*附加*到远程的主分支。所以你的主人和远程的主人（“origin/master”，如果你愿意的话）是不同的分支，但按照惯例是相关的。

回到正题——你注意到我说过当你推送到远程时可以*附加你的主分支。*如果两个人获取了 origin/master 的副本并进行了独立更改（请记住，这就像在本地对两个分支进行更改），一旦一个人推送了他们的更改，另一个人的更改就不是简单地追加到 origin/不再掌握 - 他们必须合并。这不会在您推送时发生，只有在您拉动时才会发生（令人困惑的是，“拉动”与“推送”并不完全相反：“获取”与推送相反 - 拉动是获取然后合并（或一个变基））。

因此，如果您处于这种情况下，首先尝试推送更改的人需要从更新的源/主服务器中撤出，合并或重新设置其主服务器版本，然后推送。默认情况下，您不能删除某人对分支的更改并将其替换为您自己的：您至少需要执行“git push -f”来执行此操作，并且远程存储库可以具有设置或挂钩以使其变得更加困难。

或者他们两个可以预先合作：他们中的一个拉另一个的更改，进行合并，然后推送结果。如果更改可能会重叠或相互影响，这可能是一件好事。记住版本控制系统的第一定律：*VCS 不是通信的替代品*。

* * *

## 回答 #2

> 赞同：12
> 
> 时间：2009-05-27T02:45:03.010

在 Git 中，分支严格来说是*本地*的。一个开发人员不能更改另一个开发人员的远程分支（见底部注释）。但是，在*裸*存储库的情况下，如果您的更改会导致快进，您可以“推送”您的更改以更新远程存储库的分支。

但是如果两个开发人员提交到同一个远程存储库，那么只有一个开发人员能够快速转发远程分支，而无需先将他们的分支恢复到最新状态。

例如，假设 Alice 和 Bob 都在他们本地存储库中的主分支上工作，每个都从服务器上的共享（裸）存储库克隆。如果 Alice 先完成她的工作，当她将提交的更改推送到共享的裸存储库时，它将快进裸存储库的主分支。

现在 Bob 不能在不先更新他的本地分支以包含 Alice 添加的提交的情况下快进裸仓库的主分支（因为他添加的提交不是 Alice 创建的提交的祖先）。

Bob 可以做到这一点的一种方法是在 Alice 推送她的提交之后从裸 repo 中提取（或者最好是 rebase）。这会将 Alice 的更改合并到 Bob 的分支中，并使 Bob 可以通过推送快进裸仓库的主分支。

其他工作流程也是可能的：Alice 和 Bob 可以直接相互协作，而无需使用共享的裸存储库。真的有几乎无限的可能性。但总的来说，Git 中的合并是通过*拉取*更改来完成的。

[注意：实际上可以推入非裸存储库，从而更新其他人的分支，但是这通常会产生不直观的结果，不被认为是典型的 git 工作流程，通常不鼓励]

* * *

## 回答 #3

> 赞同：8
> 
> 时间：2009-05-27T11:28:53.110

一个简短的答案是这样的：

```
commit -m "my changes" 
```

检索共享版本

```
git fetch sharedrepo 
```

**这两个中的一个**将您的本地分支与另一个 repo 同步

```
git merge sharedrepo/sharedbranch
git rebase sharedrepo/sharedbranch 
```

如果您不希望最终历史记录中有很多分支，则 Rebase 会序列化历史记录。这两种选择都可能迫使您在完成之前解决冲突。

合并/变基并解决冲突后，您推回回购

```
git push sharedrepo HEAD:sharedbranch 
```

不要在此处使用 -f ，因为这应该是快进。如果你不走运，其他人可能已经推送了一个新版本。如果发生这种情况，请重新启动此过程。

* * *

## 回答 #4

> 赞同：3
> 
> 时间：2009-05-26T22:13:58.690

多人可以同时在同一个分支上工作。当您拉（或让其他人推送）他们对您的更改时，git 会将更改合并在一起，从而产生一个包含您的两个更改的分支。

* * *

## 回答 #5

> 赞同：2
> 
> 时间：2014-12-29T16:52:50.647

您可以单独工作，然后在需要推送/拉取更改时执行以下操作：

```
git add --all .
git commit -m "Commit desc"
git pull
git push 
```

**解释：**

```
git add --all . 
```

添加所有更改，包括删除的文件

```
git commit -m "Commit desc" 
```

声明提交

```
git pull 
```

首先拉取，这将合并，您可能需要修复冲突

```
git push 
```

推送最新的合并版本 [可选 - 如果您想提交更改]

如果您想要进一步控制，例如能够同时处理多个本地/远程版本，请查看[分支](http://git-scm.com/book/en/v2/Git-Branching-Basic-Branching-and-Merging)。

我推荐这个简单而有用的页面作为建议的工作流程[http://genomewiki.ucsc.edu/index.php/Working_with_branches_in_Git](http://genomewiki.ucsc.edu/index.php/Working_with_branches_in_Git)涵盖了一些很棒的程序。

# internet-explorer - 为 kerberos 禁用 IE 提示符

> ID：913019
> 
> 赞同：3
> 
> 时间：2009-05-26T22:10:06.170
> 
> 标签：internet-explorer, kerberos

以为我会在这里试试运气。几乎已经尝试了我可以在那里找到的所有解决方案，包括之前在 SO 中的相关问题。我已经黔驴技穷了。

对于我们的 Intranet 站点，我们的德国用户始终会收到安全提示。对于所有其他人，它工作正常。每个人的 IE 设置都是一样的。

任何为我指明正确方向以禁用提示的好的解决方案都将受到欢迎。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-06-07T22:20:50.160

假设您的 Intranet 站点已正确设置为使用 Kerberos 进行单点登录，您的问题可能是以下两种或多种情况中的任何一种：

1.  德国用户禁用了“启用集成 Windows 身份验证”设置。
2.  您的德国用户进行身份验证并登录到 Windows 的域不受控制服务器的域的信任。

要修复或检查 #1，在 Internet Explorer（对于德国用户）中，转到“工具”菜单并选择“Internet 选项”。然后，在“高级”选项卡上，一直向下滚动到“安全”并确保选中“启用集成 Windows 身份验证”。重新启动 Internet Explorer 并重试。

要修复或检查 #2，您需要域管理员在 Active Directory 中设置域信任。不幸的是，我不知道如何执行此操作的所有步骤，但您可以尝试在 ServerFault 中提出您的问题，看看是否有人可以帮助您。

除了这些罪魁祸首之外，其他可能的问题也深深植根于您的域的设置方式。尝试在德国用户的计算机上下载和安装 Kerbtray.exe，并在尝试连接到您的 Intranet 服务器后检查可用的票证。

[Kerbtray 下载（微软）](http://www.microsoft.com/downloads/details.aspx?familyid=4E3A58BE-29F6-49F6-85BE-E866AF8E7A88&displaylang=en)

您至少应该看到以下三张票：

krbtgt/«域名» HOST/«用户的机器名» HTTP/«应用服务器名称»

如果缺少 HTTP 票证，那么问题在于它们在域中（即使在同一域中）与应用服务器一样受信任的能力。

如果缺少 HOST 票证或 krbtgt 票证，请检查与 keberos 相关的活动目录中的时钟漂移和帐户设置标志（帐户敏感且不信任委派等）

祝你好运 ：）

# python - Python 中缺少动态查找器和方法

> ID：913020
> 
> 赞同：5
> 
> 时间：2009-05-26T22:10:42.487
> 
> 标签：python, google-app-engine, web-applications

我正在尝试在 Python 中实现类似 Rails 动态查找器（用于 webapp/GAE）。动态查找器的工作方式如下：

*   您的 Person 有一些字段：姓名、年龄和电子邮件。
*   假设您要查找名称为“Robot”的所有用户。

Person 类有一个名为“find_by_name”的方法，它接收名称并返回查询结果：

```
 @classmethod
 def find_by_name(cls, name):
    return Person.gql("WHERE name = :1", name).get() 
```

而不是必须为每个属性编写这样的方法，我想拥有像 Ruby 的 method_missing 这样的东西来允许我这样做。

到目前为止，我已经看过这 2 篇博文：[http](http://blog.iffy.us/?p=43) ://blog.iffy.us/?p=43和 [http://www.whatspop.com/blog/2008/08/method-missing-in-python。 cfm](http://www.whatspop.com/blog/2008/08/method-missing-in-python.cfm)，但我想听听“最合适”的做法。

* * *

## 回答 #1

> 赞同：8
> 
> 时间：2009-05-27T00:34:53.473

这里真的没有必要使用 GQL——它只会让事情复杂化。这是一个简单的实现：

```
class FindableModel(db.Model):
  def __getattr__(self, name):
    if not name.startswith("find_by_"):
      raise AttributeError(name)
    field = name[len("find_by_"):]
    return lambda value: self.all().filter(field, value) 
```

请注意，它返回一个 Query 对象，您可以在该对象上调用 .get()、.fetch() 等；这是更通用的，但如果你愿意，你当然可以让它只返回一个实体。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-05-26T22:40:52.877

您可以像 Django 一样使用“find_by”方法和关键字：

```
class Person (object):
    def find_by(self, *kw):
        qspec = ' AND '.join('%s=%s' % kv for kv in kw.items())
        return self.gql('WHERE ' + qspec)

person.find_by(name='Robot')
person.find_by(name='Robot', age='2') 
```

在这条路上，您最终可能会设计自己的查询语法。看看 Django 做了什么……

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-05-26T22:31:23.740

```
class Person(object):
    def __getattr__(self, name):
        if not name.startswith("find_by"): raise AttributeError(name)
        field_name = name.split("find_by_",1)[1]
        return lambda name: Person.gql("WHERE %s = :1" % field_name, name).get() 
```

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2009-10-12T12:50:08.760

```
class Person:

    name = ""
    age = 0
    salary = 0

    def __init__(self, name, age):
        self.name = name
        self.age = age 
```

def find(clsobj, *args): return Person(name="Jack", age=20)

下面的 for 循环为所有类属性插入 @classmethod。这使得“find_by_name”、“find_by_age”和“sinf_by_salary”绑定方法可用。

```
for attr in Person.__dict__.keys():
    setattr(Person, 'find_by_'+attr, find)
    setattr(Person, 'find_by_'+attr, classmethod(find)) 
```

print Person.find_by_name("jack").age # 将打印值 20。

我不确定这是否是正确的做事方式。但是，如果您能够为所有属性实现统一的“查找”，那么上面的脚本就可以工作。

# java - 永不更改表的最佳 Spring/Hibernate 配置

> ID：913025
> 
> 赞同：6
> 
> 时间：2009-05-26T22:12:50.937
> 
> 标签：java, mysql, performance, hibernate, spring

我目前正在为我正在进行的项目使用 Spring+Hibernate+MySQL。我意识到有很多桌子永远不会改变。它们是静态的，在这些表上永远不会发生插入或更新，因此可以认为是不可变的。对这些表的所有访问都是通过实体集合和 hql 查询的延迟加载（可以急切）。

我想知道在这种情况下，处理这种情况的最佳性能方法是什么。我有基础知识，只读ehcache，查询缓存和设置为只读的事务（这对Mysql有什么作用吗？）。我还能查看哪些其他内容？哪种隔离模式、传播模式最好？我应该寻找其他缓存解决方案吗？还是我应该简单地取消所有这些，只需将数据一次加载到一系列哈希图中（希望这将是最后的手段）？

另一种可能（牵强？）的解决方案是拥有一些内存/无事务数据库并让休眠连接到它。这样的数据库引擎存在吗？

我会很感激任何指示，你们有经验！

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2009-05-27T18:34:13.407

为所有实体设置二级cahce（检查hibernate文档以获取各种配置/映射详细信息以进行缓存），配置查询缓存并将它们标记为映射中的不可变/使用只读会话，这将使hibernate不检查这些修改执行“事务性后写”和会话刷新时的实体。

这是一个非常常见的情况，这就是您应该做的所有事情。您不必处理在内存中推出自己的 hashmap 缓存（像 echache 这样的二级缓存为您提供了多种存储选择），二级缓存将为您做些什么。事务较少的数据库访问不会为您提供任何东西，性能方面，所以我不会担心它，让休眠处理它。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2009-05-26T22:18:29.927

我之前已经处理过这类事情，使用不会改变的数据枚举表，坦率地说，最简单的事情就是将表设置为预加载并完成它。除非表非常大，否则您可能从其他任何东西中获得的优化都相对较小。不要轻视，但您的时间可能最好花在优化系统的另一部分上。

也就是说，如果您的表特别大，您可能需要考虑另一种取消引用它们包含的数据的方法；如果表数据很大并且真的永远不会改变，您可能需要考虑使用 Hibernate 之外的另一种填充对象树的方法；简单地为枚举创建一个类并自行管理该引用的关联（即，没有 Hibernate）可能是有益的。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2009-05-27T22:16:23.320

我相信只读事务是一种 Hibernate 优化。如果 Hibernate 知道它不必确定您是否更改了对象中的任何内容，它可以放弃一堆步骤（CGLib 修改类？）

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2009-06-01T23:19:57.230

我认为您的其他大多数问题都已得到解答。然而，就隔离级别而言，如果您的表从未插入或更新，您可以使用 READ_UNCOMMITTED 隔离级别，它允许脏读、不可重复读和幻读。然而，这些都不重要，因为数据永远不会改变。

您可以在 spring javadocs ( [http://docs.huihoo.com/javadoc/spring/2.5/org/springframework/transaction/annotation/Isolation.html](http://docs.huihoo.com/javadoc/spring/2.5/org/springframework/transaction/annotation/Isolation.html) )中查看每个的不同隔离级别和效果

这将最大程度地释放行上的锁，并为您提供最佳性能，至少就锁定而言。

* * *

## 回答 #5

> 赞同：-2
> 
> 时间：2009-05-27T18:26:05.607

以我的经验，这些类型的表需要从数据库中删除并转换为枚举或其他东西。不是因为性能，而是为了可维护性。信不信由你，与编写脚本来更改生产数据库中的数据相比，更改代码（再次根据我的经验）是一种更直接、更简单的操作。特别是如果您不一定自己控制数据库；加倍，尤其是如果您的公司甚至无法控制它。

# c# - C#：什么会占用更多内存？字符串还是字节数组？

> ID：913036
> 
> 赞同：9
> 
> 时间：2009-05-26T22:15:58.747
> 
> 标签：c#, .net, string, bytearray

C#：什么会占用更多内存？字符串还是字节？

假设我有一行读取“我的文本”，该行会以哪种形式占用更多内存，作为字节还是字符串？

* * *

## 回答 #1

> 赞同：14
> 
> 时间：2009-05-26T22:28:30.140

它取决于字节数组的字符编码。您可以将任何字符串转换为字节数组，但您必须选择编码；没有单一的标准或正确的编码。过去被称为 ASCII 的东西在英语世界之外毫无用处。

在大多数编码中，“我的文本”的长度为 7 个字节。但是加入一些欧洲重音字符或日本字符，这些（如果它们可以表示的话）可能每个都超过一两个字节。在某些编码中，对于某些文本字符串，字节数组表示可能大于`System.String`.

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2009-05-26T22:28:49.580

成为 Unicode 并不意味着字符串每个字符占用一个以上的字节，它只是意味着它“可能”每个字符占用一个以上的字节。

[http://www.joelonsoftware.com/articles/Unicode.html](http://www.joelonsoftware.com/articles/Unicode.html)

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2012-10-30T05:20:04.257

> 什么占用更多内存？

所以你问的是**内存表示**的大小。.net 对字符串使用**UTF-16**，这意味着您的示例将由 14 个字节表示，如在此十六进制转储 (UTF-16LE) 中所示：

```
4d 00 79 00 20 00 54 00  65 00 78 00 74 00 
```

**字节数组的大小取决于**您用来表示文本的编码。如果你使用**UTF-16**，像这样

```
Encoding.Unicode.GetBytes(string) 
```

你显然得到了相同的 14 个字节。如果您改用**UTF-8**：

```
Encoding.UTF8.GetBytes(string) 
```

你得到一个 7 个字节的数组：

```
4d 79 20 54 65 78 74 
```

**这是与ASCII**相同的大小（和相同的表示），因为您的示例仅使用 ASCII 字符集中可用的字符。根据定义，所有这些字符在 UTF-8 中都是相同的。

现在，如果您使用**非 ASCII 字符**，比如日语“日”，则 UTF-8 编码将需要 3 个字节：

```
e6 97 a5 
```

UTF-16 只需要 2 个字节：

```
e5 65 
```

尝试将日文字符转换为 ASCII 会产生异常或仅使用“？” 字符，取决于您如何配置`Encoding`，因为 ASCII 只能表示 ASCII 字符。

另一个稍微不同的例子，欧洲字符“ä”。UTF-8 中的 2 个字节：

```
c3 a4 
```

UTF-16 中还有 2 个字节：

```
e4 00 
```

ASCII 不能代表这个字符。

总而言之，**消耗的内存取决于字符串中的实际数据以及用于表示它的编码**。

**以上所有仅讨论原始数据**的内存消耗，请注意，为了计算**总内存消耗**，您还必须包括作为每个数组和字符串一部分的**元数据**，例如它的**长度**，并且，在.net 字符串的情况，也是一个**空终止符**（2 个附加字节，值为“0”）。元数据的字节数是恒定的并且相对较小，因此字符串和数组之间的任何差异只有在您有大量非常小的文本时才有意义。

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2009-05-26T22:18:50.503

两者都非常接近。只有一个真正的答案：

在您的框架/架构上对其进行概要分析。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2009-05-26T22:27:36.883

[这里](http://www.simple-talk.com/community/blogs/jcrease/archive/2009/01/16/71678.aspx)有一篇很好的博客文章，给出了一个字符串占用多少空间的公式，以及与 StringBuilder 和实例分配的各种交互

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2009-05-26T22:18:59.163

除非您有多个字符串副本，否则字节数组将占用更少的内存，在这种情况下，由于字符串表，字符串将占用更少的内存。

但*真正的*问题是，这真的重要吗？将字符串用作字符串而不是将其存储为字节数组有很多好处。

我不知道细节，因为你的问题非常狭窄，但我闻到过早的优化。

* * *

## 回答 #7

> 赞同：0
> 
> 时间：2009-05-26T22:20:37.693

字节数组。这会将您的文本存储为 ASCII（每个字符 1 个字节）字符，而 .NET 字符串使用更大的 Unicode。但是请记住，.NET 字符串可能更有用，并且在大型应用程序中，这种差异可能不会产生巨大的差异。

（另请注意，如果您只在 .NET 字符串中使用 ASCII 字符，那么每个字符仍然只有 1 个字节）

# css - 如何定位黑莓浏览器？

> ID：913040
> 
> 赞同：7
> 
> 时间：2009-05-26T22:16:58.183
> 
> 标签：css, blackberry, mobile, screen, handheld

我正在使用以下内容来定位 iphone 和手持设备以使用特定的移动样式表，但黑莓浏览器只选择常规屏幕样式表。

```
<link media="handheld, only screen and (max-device-width: 320px)" href="mobile.css" type="text/css" rel="stylesheet" />
<link media="only screen and (max-device-width: 480px)" href="mobile.css" type="text/css" rel="stylesheet" /> 
```

我在网站上测试过的所有其他移动设备都选择了正确的样式表。

有谁知道以黑莓浏览器为目标的方法来做同样的事情？

谢谢！

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2009-05-27T09:04:07.303

目前移动浏览器的状态如此混乱，我不建议尝试在客户端中检测版本。最可靠的方法是使用 WURFL [http://wurfl.sourceforge.net/](http://wurfl.sourceforge.net/)之类的东西，并在服务器端进行所有检查。

祝一切顺利在黑莓上运行良好！哦，别忘了，运营商可能会在你的 HTML 到达手机之前就搞砸了。

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2009-05-28T16:24:06.837

我最终使用 Javascript 来检测用户代理。

如果它是移动设备（因为 BlackBerry 和 iPhone 认为它们是屏幕），则为手持设备和屏幕打印 mobile.css，如果它不是移动设备，则打印常规样式表。

它不适用于任何没有 Javascript 的设备，但无论如何他们最好还是查看网站的基本版本。

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2009-05-27T02:11:26.260

我没有确切的答案，我自己也从未尝试过，但您可以尝试查看[Mobile Device Browser File](http://mdbf.codeplex.com/)。这是针对在移动应用程序上工作的 ASP.Net 开发人员，但如果您不这样做，它可能仍然有用。它的开源并在 MS-PL 下获得许可。

如果您使用的是 ASP.Net，请尝试查看 Scott Hanselman 的播客，了解有关 MDBF - [ASP.Net 和移动网络的更多信息](http://www.hanselminutes.com/default.aspx?showID=172)

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2009-06-19T18:27:56.703

我建议查看以下网站：

[http://deviceatlas.com/](http://deviceatlas.com/)

[http://mobileelements.com/](http://mobileelements.com/)

[http://wurfl.sourceforge.net/](http://wurfl.sourceforge.net/)

他们都在谈论您如何针对特定的移动设备，以便您可以为不同的移动设备使用不同的样式表。

通常对于黑莓，只需在用户代理字符串中查找“blackberry”就足够了

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2014-05-27T14:09:34.173

这将专门针对带有名为 blackberry.css 的样式表的黑莓设备

```
var ua = navigator.userAgent;
if (ua.match(/(BlackBerry|Blackberry|blackberry|BB|bb|RIM|rim|Playbook|PlayBook|playbook)/)!=null) { 
     document.write('<link rel="stylesheet" type="text/css" href="blackberry.css">');
     console.log ('Blackberry confirmed'); 
} 
```

# c# - 在 Silverlight 中创建动态日历

> ID：913041
> 
> 赞同：0
> 
> 时间：2009-05-26T22:17:10.460
> 
> 标签：c#, vb.net, silverlight

我正在尝试创建一个远程日历，当用户向左或向右滚动时间时动态加载（和卸载）事件数据。我真的很难弄清楚如何布置 UI 的基本框架以及如何在用户通过在视图区域中单击并拖动鼠标滚动时动态构建界面。有关意图的基本图，请参见下图。每个切片中可能有多个矩形，用于表示当天发生的事件（切片）。我希望每个切片都成为画布，以便我适当地定位这些矩形。[替代文字 http://www.mistertnt.com/images/DynamicCalendarDiagram.jpg](http://www.mistertnt.com/images/DynamicCalendarDiagram.jpg)

有一些问题我还不确定如何解决，但这是我已经考虑了一段时间并且无法完全解决的第一个大问题：

1.  我知道如何动态创建控件，但是如何根据用户滚动的方式将内容添加到可滚动内容的一端，同时从另一端删除内容？

任何正确方向的指导将不胜感激！谢谢。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2011-01-05T07:50:03.183

在我的应用程序中，我使用 silverlight 时间线控件 (http://timeline.codeplex.com/)，这是 SIMILE 时间线小部件的一个端口。非常好！

此致。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-08-19T08:34:14.460

如果您为面板指定名称（我猜您可能正在使用 StackPanel），您可以对 ScrollViewer 上的事件做出反应，然后添加或删除项目。如果您的绑定数据是 ObservableCollection，它可能会更容易。

但是，您几乎将虚拟化数据，这是一项棘手的业务。

考虑使用 Silverlight 3 [VirtualizingStackPanel](http://msdn.microsoft.com/en-us/library/system.windows.controls.virtualizingstackpanel(VS.95).aspx)来协助完成此过程。

# jquery - 将 INPUT 附加到 TEXTAREA 以在 JQuery 中键入

> ID：913042
> 
> 赞同：2
> 
> 时间：2009-05-26T22:17:19.680
> 
> 标签：jquery, input, textbox

我有一个输入文本框。

当有人在 INPUT 文本框中键入时，我需要它来附加/添加到 TEXTAREA 值。

* * *

假设用户在文本框中键入“12345”。

textarea（默认值=“Comment：”）将自动添加：'Comment：12345'。在他们键入时添加“12345”。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-05-26T23:09:23.133

假设`area`是您的 textarea`text`的 id 和您的文本框的 id，

```
$(function() {

  var areaText = $('#area').val();  

  $('#text').bind('keyup keypress', function() { 
      $('#area')[0].value = areaText + $(this)[0].value;
  });

}); 
```

*   [此处的工作示例](http://jsbin.com/otaku)将**/edit**添加到 URL 以使用示例

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2010-06-15T03:25:57.080

Russ Cam 缺少一个边缘案例——您可以通过突出显示和拖动将文本拖放到输入字段中，而他的代码没有考虑到这一点。

下面的代码涵盖了这种情况：

```
$(function() {

  var areaText = $('#area').val();  

  $('#text').bind('keyup keypress drop', dropfunction() { 
      $('#area')[0].value = areaText + $(this)[0].value;
  });

}); 
```

也就是说，还有另一种极端情况，即通过上下文菜单进行删除和操作。截至目前，我看不到检测上下文菜单交互选择的方法......如果这很重要，您可以使用以下代码禁用它

```
$('#text').bind('contextmenu', function() { 
    return false
}); 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-05-26T22:25:29.897

```
$('#your_input').bind('keypress', function(event) { 
    var char_code = event.which ? event.which : window.event.keyCode;
    var char = String.fromCharCode(char_code);
    $('#your_textarea').value += char;
}); 
```

# iis-7 - 将根 Web 应用程序移动到另一个站点的子应用程序的简单方法？

> ID：913052
> 
> 赞同：1
> 
> 时间：2009-05-26T22:19:39.800
> 
> 标签：iis-7, migration

我们有一个 IIS 7 站点，它非常复杂，而且没有文档（大量虚拟目录、子应用程序等）。

我们希望将其从当前位置 (www.xyz.com) 移动为另一个站点 (www.abc.com) 的子文件夹，从而有效地制作类似于 www.abc.com/xyz/<*站点文件*>

显然你不能将它拖放到另一个站点，所以我想知道是否有一种“更简单”的方法可以将此 Web 应用程序复制到另一个文件夹，而不是通过每个文件夹/iis 7 设置。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2009-05-28T05:51:00.173

由于所有 IIS7 设置都存储在每个子文件夹的 web.config 文件中，因此应该非常简单。尝试在 /xyz 下创建一个新应用程序并将其指向 www.xyz.com 指向的同一文件夹。

唯一的问题是 www.abc.com 根目录中的 web.config，它可能与 www.abc.com/xyz 中的 web.config 冲突。然后你必须覆盖 www.abc.com/xyz

我从来没有为复杂的网络应用程序做过这个，但我希望它有效；）

# wpf - 如何在运行时确定 WPF TreeViewItem 中文本的宽度？

> ID：913053
> 
> 赞同：1
> 
> 时间：2009-05-26T22:19:45.073
> 
> 标签：wpf, silverlight, treeview, treeviewitem

如何在运行时确定 WPF TreeViewItem 中文本的宽度？

我需要计算一个偏移量，这样我就可以从一个叶子到另一个 TreeView 的叶子画一条线。所有 'width' 属性返回的大小都比节点的实际文本占用的空间大得多。这一定是可能的，因为选择功能不会突出显示整行。我正在用 WPF 和 Silverlight 编写客户端。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-05-26T22:26:28.243

您对文本或标签不是很具体，所以我假设您正在了解 .Net Framework 的 TreeViewItem。

可能有更简单的方法，但一种可能性是使用 Graphics.MeasureString 方法。当使用特定字体绘制时，它会为您提供以像素为单位的文本大小。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-05-28T06:20:04.867

@mrphil：可爱的流产胎儿，太可怕了

```
myTreeViewItem.Measure(new Size(Double.PositiveInfinity, Double.PositiveInfinity));
Size s = myTreeViewItem.DesiredSize;
return s.Width; 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-05-27T19:33:39.543

我有两个解决方案：

A) 使用可视化树

```
 TreeViewItem selected = (TreeViewItem)dataSourceTreeView.SelectedItem;
    double textWidth = 0;
    double expanderWidth = 0;
    Grid grid = (Grid)VisualTreeHelper.GetChild(selected, 0);

    ToggleButton toggleButton = (ToggleButton)VisualTreeHelper.GetChild(grid, 0);
    expanderWidth = toggleButton.ActualWidth;

    Border bd = (Border)VisualTreeHelper.GetChild(grid, 1);
    textWidth = bd.ActualWidth; 
```

B）如果您不想使用可视化树

```
 TreeViewItem selected = (TreeViewItem)dataSourceTreeView.SelectedItem;
    double textWidth = 0;
    Typeface typeface = new Typeface(selected.FontFamily,
        selected.FontStyle, selected.FontWeight, selected.FontStretch);

    GlyphTypeface glyphTypeface;
    if (!typeface.TryGetGlyphTypeface(out glyphTypeface))
            throw new InvalidOperationException("No glyphtypeface found");

    string headerText = (string)selected.Header;
    double size = selected.FontSize;

    ushort[] glyphIndexes = new ushort[headerText.Length];
    double[] advanceWidths = new double[headerText.Length];

    for (int n = 0; n < headerText.Length; n++)
    {
            ushort glyphIndex = glyphTypeface.CharacterToGlyphMap[headerText[n]];
            glyphIndexes[n] = glyphIndex;

            double width = glyphTypeface.AdvanceWidths[glyphIndex] * size;
            advanceWidths[n] = width;

            textWidth += width;
    } 
```

# visual-studio - Visual Studio 命令不起作用。ctrl + f5 不运行我的应用程序

> ID：913054
> 
> 赞同：41
> 
> 时间：2009-05-26T22:19:52.920
> 
> 标签：visual-studio, visual-studio-2008, keyboard-shortcuts

我曾经能够通过在 Visual Studio 中点击`Ctrl`+来构建和运行我的控制台应用程序。`F5`这不再有效。我到处找。有谁知道如何重新启用此命令？

* * *

## 回答 #1

> 赞同：72
> 
> 时间：2009-05-26T22:43:34.947

可能是一个荒谬的建议，但您的键盘是否有某种“F Lock”键？在我得到一个新键盘并意外击中它后发生在我身上。甚至不知道它在那里:)

* * *

## 回答 #2

> 赞同：12
> 
> 时间：2009-05-26T22:36:50.327

在您删除*所有*设置之前，请考虑重置键盘首选项：

在工具/选项/环境/键盘中，您的键盘方案有一个下拉菜单，旁边有一个重置按钮。确保映射方案设置为您想要的任何内容，然后单击“重置”按钮。

* * *

## 回答 #3

> 赞同：8
> 
> 时间：2009-05-26T22:25:36.043

我遇到了类似的问题，我的一些快捷方式（例如 Alt+Shift+F10 智能感知快捷方式）停止工作......

我通过转到**Tools -> Import and Export Settings -> Reset all settings**来修复它。

在我重置它们之后，我能够重新导入我保存的设置，但只有没有损坏的捷径！

* * *

## 回答 #4

> 赞同：5
> 
> 时间：2010-05-15T19:25:30.647

我有一个类似的问题，阅读这个帖子让我得到了一个类似于 f-Lock 键答案的答案。我正在使用一台新笔记本电脑，并重新介绍自己进行编程。当书上说按 Ctrl-F5 时，我这样做了，唯一发生的事情是我的显示器稍微变暗了，尽管当我单击其他一些东西时它恢复了正常亮度。看完这个帖子，我注意到这个新奇的键盘有一个蓝色的 Fn 键，所有的功能键名称都印成蓝色。换句话说，要获得功能键功能，您必须在点击实际功能键时按住蓝色 Fn 键。所以 F5 变成 Fn-F5 并且 Ctrl-F5 变成 Ctrl-Fn-F5。这是在戴尔 Inspiron 1564 上的。这不像 F-Lock 键那么令人震惊，所以我希望我能很快适应它。

* * *

## 回答 #5

> 赞同：4
> 
> 时间：2010-06-20T21:47:19.850

我通过按 Fn + F5 解决了这个问题，它就在 Windows 按钮旁边。

* * *

## 回答 #6

> 赞同：2
> 
> 时间：2009-06-10T19:13:37.417

有一天，当我对我的 ASP .NET 项目中的项目和解决方案文件进行一些更改时，我遇到了这种情况。当我在 Visual Studio 中打开它时，它允许我重建但不能运行或调试（菜单选项没有出现，`Ctrl`+`F5`不起作用）。

为了让它再次工作，我所做的是右键单击解决方案，进入右侧的 Visual Studio“解决方案资源管理器”树选项卡，您的项目的所有文件都出现在该选项卡中，然后选择属性。

然后，选择一个项目，并将其作为启动项目。

也许这是你的问题。如果没有，我希望它可以帮助将来的人。

* * *

## 回答 #7

> 赞同：0
> 
> 时间：2009-05-26T22:23:43.553

您可能更改了默认设置。转到工具->导入和导出设置...选择“全部重置”，单击“下一步”并选择“Visual C# 开发设置”选项。

* * *

## 回答 #8

> 赞同：0
> 
> 时间：2014-08-21T20:38:20.217

它发生在我身上类似的事情，但只有一个项目，而其他项目则使用 CTRL + F5 运行，所以我将在这里发布我的问题和解决方案，因为它可以帮助人们搜索相同的问题，就像我一样:)

我在 Visual Studio 2012 中打开了一个使用 Visual Studio 2013 创建的解决方案，但它没有使用 CTRL + F5 运行。我用记事本打开解决方案文件，然后更改以下部分：

```
GlobalSection(SolutionConfigurationPlatforms) = preSolution
    Debug|Any CPU = Debug|Any CPU
    Release|Any CPU = Release|Any CPU
EndGlobalSection 
```

与其他：

```
GlobalSection(SolutionConfigurationPlatforms) = preSolution
    Debug_x86|Any CPU = Debug_x86|Any CPU
    Debug_x86|x86 = Debug_x86|x86
    Debug|Any CPU = Debug|Any CPU
    Debug|x86 = Debug|x86
    PruebaRelease|Any CPU = PruebaRelease|Any CPU
    PruebaRelease|x86 = PruebaRelease|x86
    Release|Any CPU = Release|Any CPU
    Release|x86 = Release|x86
EndGlobalSection 
```

这为我解决了问题。

* * *

## 回答 #9

> 赞同：0
> 
> 时间：2015-07-22T16:30:57.063

这个快捷键在 os x 中是默认设置的，你需要禁用它才能使用 ctrl+F5。看看[http://www.daniellewis.me.uk/2015/07/01/ctrl-f5-not-working-in-a-windows-vm-running-on-parallels/](http://www.daniellewis.me.uk/2015/07/01/ctrl-f5-not-working-in-a-windows-vm-running-on-parallels/)来修复。我现在可以在我的虚拟机中运行而无需调试。

* * *

## 回答 #10

> 赞同：0
> 
> 时间：2021-12-13T17:30:20.017

我有同样的问题。就我而言，我刚刚删除了包含我的项目的文件夹并创建了一个新文件夹。一切顺利。

* * *

## 回答 #11

> 赞同：0
> 
> 时间：2017-02-14T06:34:25.123

Alt+F7（在 Resharper 中查找用法）也有类似的问题。事实证明，GeForce Experience 采用了共享功能的捷径。卸载了GE，一切都很好。

# eclipse - 如何在 Eclipse ant 编辑器中启用撤消？

> ID：913059
> 
> 赞同：7
> 
> 时间：2009-05-26T22:20:59.220
> 
> 标签：eclipse, ant, release-management, build-management

在 Eclipse 的 ant 编辑器中，撤消对我不起作用。当我按下 Ctrl-Z 时，什么也没有发生。

是否可以以某种方式启用撤消或者这是一个错误？

我在 Windows XP Professional 上使用 Eclipse 3.4.2 (Ganymede)。

* * *

## 回答 #1

> 赞同：9
> 
> 时间：2009-05-27T04:00:43.700

是的，撤消应该在蚂蚁编辑器中完美运行。不工作可能意味着
：`Ctrl-Z`

*   快捷方式已分配给另一个操作 ( `Windows > Preferences > General > Keys`)
*   撤消缓冲区大小以某种方式为“0”（`Windows > Preferences > General > Editors > Text Editor`）
*   插件以某种方式“窃取”了自己的关键事件

尝试全新安装，并检查最新的 Galileo (3.5RC2) 安装以查看问题是否仍然存在。

* * *

注意：[zvikico](https://stackoverflow.com/users/2823/zvikico)提到 3.4.2 中存在 ant editor 的已知 bug

[快速搜索](https://bugs.eclipse.org/bugs/buglist.cgi?query_format=advanced&short_desc_type=allwordssubstr&short_desc=&classification=Eclipse&component=Ant&long_desc_type=allwordssubstr&long_desc=undo&bug_file_loc_type=allwordssubstr&bug_file_loc=&status_whiteboard_type=allwordssubstr&status_whiteboard=&keywords_type=allwords&keywords=&emailtype1=substring&email1=&emailtype2=substring&email2=&bugidtype=include&bug_id=&votes=&chfieldfrom=&chfieldto=Now&chfieldvalue=&cmdtype=doit&order=Reuse+same+sort+as+last+time&field0-0-0=noop&type0-0-0=noop&value0-0-0=)后，以下错误可能会解释您的情况：

*   [267780](https://bugs.eclipse.org/bugs/show_bug.cgi?id=267780) [ant editor] 移动光标后无法撤消删除行
*   [247434](https://bugs.eclipse.org/bugs/show_bug.cgi?id=247434)无法撤消 Ant 编辑器中的行删除，仅使用**'Eclipse IDE for Java Developers'**，使用 Eclipse Classic 你不会得到这种行为

最后：

*   [239115](https://bugs.eclipse.org/bugs/show_bug.cgi?id=239115) Undo 功能在 ant 编辑器中不再起作用，主要是因为 WTP 问题，仅在 3.5 中解决

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2014-01-16T08:16:02.543

如果 CTRL-Z（撤消）不再起作用，您可以尝试一下。它对我有用：转到 Preferences -> General -> Keys 并单击应用按钮或恢复默认值按钮

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2013-04-01T21:08:39.263

我看到这篇文章很老了，但我正在为通过搜索引擎找到这篇文章的人添加一个回复。

`Ctrl`-`Z`当我对我的代码的一部分进行了小改动时，我停止在 eclipse 中工作，这反过来又在我的代码的不同部分触发了意外的无限循环。

*   我使用 Windows 任务管理器杀死了我在停止工作时一直在测试的应用程序，`Ctrl`然后`Z`我用来`system.out.println()`识别触发无限循环的代码部分。
*   然后我禁用了那段代码，这反过来导致`Ctrl`-`Z`以及其他一切重新开始工作。
*   我能够从那里完成调试。

# c++ - DLL 依赖项 - 在不同的系统上不同？

> ID：913060
> 
> 赞同：0
> 
> 时间：2009-05-26T22:21:02.170
> 
> 标签：c++, dll, dependencies

我在 WinXP 系统中使用 mingw 编译器创建了一个应用程序。它工作得很好。然后我尝试在一个较旧的 WinXP 机器中运行它（它已经在架子上放置了大约 6 个月）。应用程序因异常而终止——“*应用程序无法初始化 (0xc0150002)* ”。

在应用程序上运行 depends.exe 会在目标中显示两个不可用的 dll（ieshims.dll 和 wer.dll）。但是，在构建系统中，依赖关系树是不同的，并且与旧的 winxp 盒子相比，它的 dll 更少。我在两个系统上都完成了所有最新的 Windows 更新。

为什么同一个应用程序依赖于不同系统上的不同dll？我该如何解决这个问题？

谢谢，桑达尔

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-05-26T23:52:48.223

当我遇到这个问题时，这是由于没有在目标机器上安装[某些可再](http://www.microsoft.com/downloads/details.aspx?FamilyID=32BC1BEE-A3F9-4C13-9C99-220B62A191EE&displaylang=en)发行组件（您可能需要寻找 VS 2008 可再发行组件，甚至是 .Net 框架可再发行组件）。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-05-26T22:25:49.150

如果您有相同的更新（希望还有 SP），那么您为什么要调用“旧”XP？此外，这可能是目标上 IE 安装损坏的问题。

# php - IP地址欺骗/更改以在本地机器上进行测试

> ID：913061
> 
> 赞同：3
> 
> 时间：2009-05-26T22:21:03.090
> 
> 标签：php, http, ip

我正在尝试限制访问我网站的流量，以便尝试截取大量数据的人会在一段时间后被阻止。我应该根据传入请求的 IP 来执行此操作。我相信我已经编写了 IP 限制功能，但是我不知道如何测试它。我需要能够多次更改我的 IP 地址，以模拟有效流量。我还需要测试超过 20 个不同的 IP，因此每个 IP 的代理解决方案都不适合我。

我正在我的本地机器（运行 Ubuntu）上测试代码，所以如果我需要这个测试，我可以更改我的服务器设置（Apache）。

我在公司网络后面，所以我无法将 MAC 地址/ARP 设置更改为“重新分配”一个新 IP。我希望有某种 localhost IP 更改类型的东西，所以我可以利用服务器和客户端是同一台机器的事实。

此外，我试图避免在将代码推广到生产服务器之前更改代码，但这可能是最好的方法。

我该如何设置？

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2009-05-26T22:48:08.293

好吧，您可以做的不是实际检查 IP，而是执行以下操作：

```
$ip = '1337.1337.1337.1337'; 
```

代替：

```
$ip = $_SERVER['REMOTE_ADDR'] 
```

然后继续做你的IP检查代码。

所以当你完成后，你可以让你的 $ip 变量代码看起来像这样：

```
//$ip = '1337.1337.1337.1337';
$ip = $_SERVER['REMOTE_ADDR'] 
```

这样您就可以轻松打开和关闭“调试开关”

编辑：

甚至使 IP 动态化：

```
$ips = Array('192.168.1.220', '120.843.592.86', '256.865.463.563');
$ip = $ips[rand(1,count($ips)-1)]; 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-05-27T08:22:57.057

您可以通过在 linux 上运行以下命令轻松地做到这一点：

ifconfig eth0:0 127.0.0.2
ifconfig eth0:1 127.0.0.3
etc...（创建假本地接口）

如果您没有在 0.0.0.0（所有接口）上侦听，您可能必须配置 apache 以侦听这些 IP，然后您可以直接访问这些 IP。

如果您想使用其他 ip，您也可以轻松地做到这一点，但请记住在测试完成后将其删除。

这只能从您的本地机器到您的本地机器。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-05-26T22:31:00.137

有很多方法可以对此进行测试。imo 最简单的方法是创建一个 ARP 条目列表，其中您模拟的 IP 地址指向服务器的 MAC 地址。然后，您可以编写一个简单的应用程序，将 src 地址设置为每个模拟 IP 地址，连接并发送您想要的任何 HTTP 请求。服务器应该回复得很好。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2009-05-26T23:48:22.040

您想考虑在防火墙级别执行此操作（如果不是公司边界防火墙而不是主机上的 SW 防火墙）。在许多情况下，如果您仅在应用程序级别限制滥用主机，它们仍然可以关闭或影响您网站的性能。即使您最终拒绝它们，它们仍在使用套接字和 Web 服务器工作线程。您甚至可能有一些代码在 IP 检查之前需要花费一些费用。这实际上完全取决于您的应用程序的轻量级，但可以肯定的是，防火墙，无论是硬件还是软件，都可以比您的应用程序更有效地阻止不守规矩的客户端。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2009-05-27T00:23:24.777

这个答案对于这个应用程序来说可能是多余的，但我喜欢使用[tcpdump / libpcap](http://www.tcpdump.org/)、[winpcap](http://www.winpcap.org/)和原始套接字来生成流量。您不仅可以很好地控制进出应用程序的流量，还可以了解很多有关防火墙/流量过滤器设置可以为您做的事情以及您没有预料到的流量被阻止（或你不想被阻止）。

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2009-05-26T22:32:34.203

我不确定这是否是你要找的东西，但我不得不欺骗我的 MAC 地址，这样我才能获得一个新的 IP 来绕过我大学的下载配额。更改 MAC 会产生新的 IP。在标准 ubuntu 存储库中有一个名为“macchanger”的程序，只需使用正确的选项（“-r”表示随机）运行它，然后指定设备。像这样。

```
sudo macchanger -r eth0 
```

执行此操作时必须禁用网络。您可以通过右键单击网络图标并取消选中“启用网络”框来执行此操作。

* * *

## 回答 #7

> 赞同：0
> 
> 时间：2016-04-12T07:07:17.950

使用随机函数并将限制设置为 rand(0,255) 并将字符串连接到 IP 格式。当您打电话时，您将获得新的 IP 地址

# interface - 你如何定义一个接口，知道它一旦发布就应该是不可变的？

> ID：913062
> 
> 赞同：1
> 
> 时间：2009-05-26T22:21:09.767
> 
> 标签：interface

任何开发的人都知道代码是有生命的，那么在接口发布之前可能还没有识别出相当多的功能时，你如何定义一个“完整”的接口呢？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2009-05-26T22:30:19.483

测试它很多。我从来没有遇到过解决这个特殊问题的灵丹妙药——根据消费者的特定需求和项目的目标，有不同的策略——例如，你是微软发布了 ASP.NET MVC 框架，还是你正在构建一个内部 LoB 应用程序？但是提炼到最简单的，你永远不会通过测试出错。

通过测试，我的意思是使用接口来实现功能。您正在测试合同以查看它是否可以满足需求。为你能想到的接口想出尽可能多的不同用途，并尽可能地实现它们。白板其余部分，应该清楚缺少什么。我会说对于给定的“缺失成员”，如果您在 3-5 次迭代内没有击中它，您可能不需要它。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-05-26T22:51:10.283

版本号。

定义一个“完整接口”。称之为 1.0 版。

解决问题。称之为 2.0 版。

他们是分开的。它们在功能上重叠，但它们是分开的。

是的，你增加了支持两者的努力。也就是说，直到您弃用 1.0，并且 - 最终 - 停止支持。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-05-26T22:28:31.810

只需让您对未来做出最合理的猜测，如果您需要更多，请创建界面的第二个版本。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2009-05-26T22:30:42.040

你不能在一次性发布中做到这一点。**你需要反馈。**

您可以做的是首先创建一个干净的界面，以提供您的库应提供的所有功能；然后将其公开给您的用户群以供实际使用；然后使用反馈作为指南来更新您的界面 - 不添加辅助函数/类以外的功能 - 直到它开始在界面上稳定。

你不能只依赖经验/良好做法。它确实有帮助，但还远远不够。**你只需要反馈**。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2009-05-26T22:50:09.210

确保接口或接口技术（如 RPC、COM、CORBA 等）具有明确定义的升级和增强接口机制。

比如微软经常有MyInterface，其次是MyInterfaceEx，其次是MyInterfaceEx2等等等等。

其他系统有一种方法可以查询和协商不同版本的接口（参见 DirectX，其中之一）。

# database - SQLite 作为低流量站点的生产数据库？

> ID：913067
> 
> 赞同：71
> 
> 时间：2009-05-26T22:21:44.290
> 
> 标签：database, sqlite, production-environment

我正在考虑使用 SQLite 作为一个站点的生产数据库，该站点可能会同时接收 20 个用户，但峰值可能是该站点的许多倍（因为该站点可以在开放的互联网上访问，并且总是有可能有人会在某个地方发布一个链接，该链接可能会同时将许多人吸引到该站点）。

SQLite 有可能吗？

我知道这不是一个理想的生产场景。我只是在问这是否在现实可能性的范围内。

* * *

## 回答 #1

> 赞同：80
> 
> 时间：2009-05-26T22:37:51.823

~~SQLite 不支持任何类型的并发，因此在生产网站上运行它可能会遇到问题。如果您正在寻找一个“更轻”的数据库，也许可以考虑尝试像 CouchDB 这样的现代对象文档存储。~~

无论如何，继续针对 SQLite 进行开发，最初使用它可能没问题。如果您发现您的应用程序有更多的用户，那么您将希望过渡到 Postgres 或 MySQL。

SQLite 的作者[在网站上](http://www.sqlite.org/whentouse.html)解决了这个问题：

> SQLite 作为大多数中低流量网站（也就是说，大多数网站）的数据库引擎效果很好。SQLite 可以处理的网络流量取决于网站使用其数据库的程度。一般来说，任何每天点击量少于 100K 的网站都可以使用 SQLite。10 万次点击/天的数字是保守估计，而不是硬性上限。SQLite 已被证明可以处理 10 倍的流量。
> 
> SQLite 网站（[https://www.sqlite.org/](https://www.sqlite.org/)）当然使用 SQLite 本身，在撰写本文时（2015 年），它每天处理大约 400K 到 500K 的 HTTP 请求，其中大约 15-20% 是接触数据库的动态页面。动态内容每个网页使用大约 200 个 SQL 语句。此设置在与其他 23 个共享物理服务器的单个 VM 上运行，但在大多数情况下仍将平均负载保持在 0.1 以下。

所以我认为它的长短是，去吧，如果它不适合你，那么过渡到企业级数据库无论如何都是相当微不足道的。但是，请注意您的架构，并在设计数据库时考虑到增长和效率。

* * *

这是[一个线程](http://forum.slicehost.com/comments.php?DiscussionID=1312)，其中包含一些关于将 SQLite 用于生产 Web 应用程序的更多独立评论。听起来它已经被使用了一些混合的结果。

* * *

**编辑（2014）**：

自发布此答案以来，SQLite 现在具有[多线程模式](http://www.sqlite.org/threadsafe.html)和预[写日志模式](http://www.sqlite.org/wal.html)，这可能会影响您对其对中低流量站点的适用性的评估。

Charles Leifer 写[了一篇](http://charlesleifer.com/blog/sqlite-small-fast-reliable-choose-any-three-/)关于 SQLite 的 WAL（预写日志）功能的博客文章，以及一些关于适当用例的深思熟虑的意见。

* * *

## 回答 #2

> 赞同：14
> 
> 时间：2015-05-12T00:46:59.557

[SQLite网站](https://www.sqlite.org/whentouse.html)的一小段摘录说明了一切。

> *   数据是否通过网络与应用程序**分开**？→ 选择 **客户端/服务器**
>     
>     
> *   许多**并发**作家？→ 选择**客户端/服务器**
>     
>     
> *   **大数据**？→ 选择客户端/服务器
>     
>     
> *   否则→选择**SQLite**！

SQLite“正常工作”（直到它当然不工作）

* * *

## 回答 #3

> 赞同：8
> 
> 时间：2009-05-26T23:30:26.740

我们经常将 SQLite 用于内部数据库；员工目录、我们的事件日历和其他 Intranet 服务都运行在轻量级数据库上。以我们在诸如 mySQL 之类的“真实”数据库上运行的规模运行这些应用程序将是非常过大的。当您考虑到它们在一台中端计算机上与其他 4 个虚拟机一起运行时，尤其如此。

有一次，我们有一个面向外的站点，它在一个 sqlite 数据库上运行了几个月，只需要一次重启。显然，它的流量非常低，但它很好地完成了它的工作。

* * *

## 回答 #4

> 赞同：3
> 
> 时间：2014-10-20T06:30:26.183

*我们在绝对没有写入*的环境中遇到了类似的选项，我们选择使用 SQLite。

请参阅我关于该主题的[博客文章](http://uri.agassi.co.il/2014/10/using-sqlite-for-production.html)：

> 好吧，使这个解决方案在理论上可行的主要假设是我们的 SQLite 数据库是完全只读的。我们的服务器代码永远不应该改变它。这将解决任何锁定问题，因为没有读锁。我们在互联网上找不到任何人说在没有写入的情况下 SQLite 的高吞吐量读取存在问题 - 有可能！

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2009-05-26T22:35:07.647

我认为这主要取决于您的读/写比率。如果它主要是从数据库中读取，你可能没问题。SQLite 中的多用户写入可能是一个问题，因为它如何锁定数据库。

* * *

## 回答 #6

> 赞同：1
> 
> 时间：2010-07-03T19:38:34.440

人们谈论并发问题，但 sqlite 有一种方法可以缓存传入的请求并让它们等待一段时间。它不会立即超时。

我已经阅读了有关默认超时设置从零开始的内容，这意味着它会立即超时，这是无稽之谈。也许人们没有调整这个设置？

* * *

## 回答 #7

> 赞同：0
> 
> 时间：2009-05-26T22:37:56.520

取决于网站的使用情况。如果大多数时候您只是在读取数据，那么您几乎可以将任何东西用于数据库并将数据缓存在应用程序中以获得良好的性能。

* * *

## 回答 #8

> 赞同：0
> 
> 时间：2009-07-13T22:15:13.213

我在一个非常低流量的网络服务器（它是一个基因组数据库）中使用它，我没有任何问题。但是只有 SELECT 语句，**没有写入所涉及的数据库**。

* * *

## 回答 #9

> 赞同：0
> 
> 时间：2014-01-18T17:11:23.947

补充一个已经很出色的答案：由于在这种情况下您使用的是无服务器解决方案，因此您可以告别复制，或任何类型的数据库水平扩展，以及其他高级选项。如果您有多个用户更新相同的确切信息块，这也不是最佳选择。如果将来要对数据库进行分片，则必须迁移数据并转移到其他地方。此外，如果您有一个负载均衡器并涉及多个系统，则使用 sqlite 将难以保持数据中心性。这些只是不推荐它的一些原因。它非常适合小型项目，也非常适合开发。

* * *

## 回答 #10

> 赞同：0
> 
> 时间：2015-06-11T01:47:26.560

似乎通过排队，您也可以避免 SQLite 的许多并发写入问题。不是直接写入 sqlite db，而是写入队列，然后依次以先进先出模式顺序写入 sqlite db。不确定您的应用程序是否可以到达您需要它的地方，如果它值得编写或者只是转移到客户端/服务器数据库......但是一个想法。

# c++ - 为什么 push_back 或 push_front 使双端队列的迭代器无效？

> ID：913070
> 
> 赞同：27
> 
> 时间：2009-05-26T22:23:21.867
> 
> 标签：c++, stl, iterator, deque

正如标题所问。

我对双端队列的理解是它分配了“块”。我看不出分配更多空间如何使迭代器无效，如果有的话，人们会认为双端队列的迭代器比向量的迭代器有更多的保证，而不是更少。

* * *

## 回答 #1

> 赞同：21
> 
> 时间：2009-05-27T00:16:52.763

C++ 标准没有指定如何实现双端队列。不需要通过分配一个新块并将其链接到以前的块来分配新空间，所需要的只是在每一端的插入被摊销恒定时间。

因此，虽然很容易看到如何实现双端队列以提供您想要的保证[*]，但这并不是唯一的方法。

[*] 迭代器有一个元素的引用，加上它所在的块的引用，这样当它们到达它们时，它们可以继续向前/向后离开块的末端。另外，我假设对双端队列本身的引用，因此`operator+`对于随机访问迭代器而言，它可以是常数时间——遵循从块到块的链接链还不够好。

* * *

## 回答 #2

> 赞同：15
> 
> 时间：2009-05-27T04:07:53.483

更有趣的是，它`push_back`不会`push_front`使对双端队列元素的任何**引用****无效。**只有迭代器被假定为无效。

 **据我所知，该标准没有说明原因。但是，如果实现了一个知道其直接邻居的迭代器 - 作为一个列表 - 如果它指向一个同时位于双端队列边缘和块边缘的元素，则该迭代器将变得无效。

* * *

## 回答 #3

> 赞同：7
> 
> 时间：2011-03-18T04:08:19.787

我猜。**push_back/push_front**可以分配一个新的内存块。双端队列迭代器必须知道递增/递减运算符何时应该跳转到下一个块。该实现可以将该信息存储在迭代器本身中。**在push_back/push_front**之后递增/递减旧迭代器可能无法按预期工作。

此代码可能会或可能不会因运行时错误而失败。在我的 Visual Studio 上，它在调试模式下失败，但在发布模式下运行到结论。在 Linux 上，它会导致分段错误。

```
#include <iostream>
#include <deque>

int main() {
    std::deque<int> x(1), y(1);
    std::deque<int>::iterator iterx = x.begin();
    std::deque<int>::iterator itery = y.begin();

    for (int i=1; i<1000000; ++i) {
        x.push_back(i);
        y.push_back(i);
        ++iterx;
        ++itery;
        if(*iterx != *itery) {
            std::cout << "increment failed at " << i << '\n';
            break;
        }
    }
} 
```

* * *

## 回答 #4

> 赞同：6
> 
> 时间：2009-05-26T23:00:14.273

关键是不要做任何假设，只是将迭代器视为无效。

即使它现在工作正常，更高版本的编译器或不同平台的编译器可能会出现并破坏您的代码。或者，一位同事可能会出现并决定将您的双端队列转换为向量或链表。

* * *

## 回答 #5

> 赞同：4
> 
> 时间：2016-09-09T22:07:18.320

迭代器不仅仅是对数据的引用。它必须知道如何增加等。

为了支持随机访问，实现将有一个指向块的动态指针数组。deque 迭代器将指向这个动态数组。当双端队列增长时，可能需要分配一个新块。动态数组将增长，使其迭代器失效，从而使双端队列的迭代器失效。

所以不是块被重新分配，而是指向这些块的指针数组可以。事实上，正如 Johannes Schaub 所指出的，引用并没有失效。

还要注意，双端队列的迭代器保证不小于向量的，当容器增长时它们也会失效。

* * *

## 回答 #6

> 赞同：2
> 
> 时间：2009-05-26T22:31:02.600

即使您以块的形式分配，如果没有足够的空间（如向量的情况），插入也会导致该特定块被重新分配。

* * *

## 回答 #7

> 赞同：0
> 
> 时间：2010-04-02T14:14:43.617

因为标准说可以。它不要求将双端队列实现为块列表。它要求具有特定前置条件和后置条件以及特定算法复杂度最小值的特定接口。

实现者可以自由地以他们选择的任何方式来实现它，只要它满足所有这些要求。一个明智的实现可能会使用块列表，或者它可能会使用其他一些具有不同权衡的技术。

对于所有情况下的所有用户来说，可能不可能说一种技术绝对优于另一种技术。这就是为什么该标准给了实现者一些选择的自由。

# hibernate - Hibernate 缺乏对一对一和多对一关系的删除孤儿支持的解决方法？

> ID：913073
> 
> 赞同：16
> 
> 时间：2009-05-26T22:24:17.170
> 
> 标签：hibernate

Hibernate 不支持一对一或多对一关系的“删除-孤儿”级联。我最近发现了这一点，这让我很头疼。我的模型中有几个类，它们的设计使孩子在父母之外没有现实世界的意义。我只有一个用于父类的 DAO，而没有用于子类的单独 DAO。

这有效：

```
parent.getChild().setProperty("something");
parentDao.save(parent); 
```

这没有任何作用：

```
parent.setChild(null);
parentDao.save(parent); 
```

这是非常不幸的，因为现在我必须重新考虑我的 DAO 层和我的服务层的一些操作。

有没有人以优雅的方式解决这个限制？我真的很想只关心持久的父对象。在这种特殊情况下，除了让 Hibernate 高兴之外，没有理由处理子持久性，并且仅在删除子的情况下。

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2009-08-19T11:50:01.990

这似乎是他们可能解决的框架中的一个缺陷，希望很快

[http://opensource.atlassian.com/projects/hibernate/browse/HHH-2608](http://opensource.atlassian.com/projects/hibernate/browse/HHH-2608)

这张票是 2007 年开的，最近一篇抱怨这个问题的帖子是一个月前的。

我正在做的是在我的对象上放置一个名为 isMarkedForDeletion 的属性。如果返回 true，我让我的 dao 或我的服务进行显式删除。它肯定不如 delete-orphan 好，但它在 spring+hibernate 框架中运行良好。

我会密切关注这篇文章，因为这是一个非常重要的问题。

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2010-03-16T15:25:09.507

此处描述的解决方法[https://forum.hibernate.org/viewtopic.php?p=2379216](https://forum.hibernate.org/viewtopic.php?p=2379216)对我有用。它使用@OneToMany 关联与“多”端的单个元素来实现@OneToOne 关联并解决remove-orphans 问题。

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2013-11-05T08:18:27.697

Heureka，在 Hibernate 4.27 中修复 [https://hibernate.atlassian.net/browse/HHH-6484](https://hibernate.atlassian.net/browse/HHH-6484) （未测试）

* * *

## 回答 #4

> 赞同：-1
> 
> 时间：2010-12-23T10:42:40.600

在子表上的更新触发器上写入数据库。如果父键为空，则从子键中删除记录

# maps - 在虚拟地球上绘制地址

> ID：913074
> 
> 赞同：2
> 
> 时间：2009-05-26T22:24:21.553
> 
> 标签：maps, virtual-earth

如何在地图上绘制地址点？

我想基本上使用 VEMap.Find()，但只需获取位置的坐标。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-05-26T22:30:55.457

当您调用 Find() 时，为 showResults 参数传入 true。Microsoft 文档有一个如何执行此操作的示例： [Microsoft 的 VEMap.Find() 文档](http://msdn.microsoft.com/en-us/library/bb429645.aspx)

如果您真的只想要从 VEMap.Find() 返回的结果的纬度/经度，请查看此博客文章： [从 VEMap.Find() 获取坐标](http://blogs.msdn.com/virtualearth/archive/2008/04/08/geocoding-with-virtual-earth.aspx)。坐标可在 GetCoordinates 函数中作为 findPlaceResults 对象的属性进行访问。

# svn - 使用持续集成将第 3 方库存储到源代码控制中

> ID：913077
> 
> 赞同：2
> 
> 时间：2009-05-26T22:25:01.957
> 
> 标签：svn, version-control, continuous-integration, teamcity

我刚刚将一个非常大的第 3 方库 (Boost) 提交到我们的源代码控制中。我用自己的存储库设置它。我标记了它的版本，以便其他项目可以 svn:externals 这个特定版本。

这很好，直到我意识到我的持续集成（CI）服务器每次签入一些代码时都会进行完整的签出。（很明显，我一开始是故意这样设置我的 CI 服务器的）。这可能会导致 CI​​ 服务器端的结帐时间很长。

所以问题是：这是一件好事吗？有人可以建议一种更好的方法来处理这种模式吗？

**编辑：**我正在使用 TeamCity CI 服务器。

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2009-06-09T04:03:26.403

TeamCity 默认配置为缓存导出的源（签出模式：在服务器上自动）。这意味着第一次构建可能需要一些时间，但后续构建会明显更快，因为它只加载更改的文件。自动清洁结帐只会在某些情况下发生。

如果您已经签入了整个 3rd 方库，包括文档和源代码，您可能需要创建一个签出规则来过滤掉那些无关的文件，这样您就只剩下编译解决方案所需的二进制文件（假设您已经检查了在编译的二进制文件中）。

TeamCity 允许在每个构建配置中使用多个 VCS 根，因此您可能更容易在主 VCS 根（这是默认设置）中排除外部，然后添加另一个指向您的其他存储库的 VCS 根，并使用签出规则将在预期目录中提升预编译库。

有关干净结帐和结帐规则的更多信息，请参阅：

[http://www.jetbrains.net/confluence/display/TCD4/Clean+Checkout#CleanCheckout-sourcescache](http://www.jetbrains.net/confluence/display/TCD4/Clean+Checkout#CleanCheckout-sourcescache) [http://www.jetbrains.net/confluence/display/TCD4/VCS+Checkout+Rules](http://www.jetbrains.net/confluence/display/TCD4/VCS+Checkout+Rules)

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2009-05-26T22:41:30.007

想到了一些可能性：

1.  更改 CI 以增量更新。
2.  避免使用 svn:externals，而是在构建期间符号链接结帐。

# c# - Control.PointToScreen 给出不同的结果 - 为什么？

> ID：913078
> 
> 赞同：0
> 
> 时间：2009-05-26T22:25:10.430
> 
> 标签：c#, vb.net, winforms, controls

我有一些标签控件位于窗体上的面板控件上。我想获取标签相对于表单原点的位置，以便在运行时我可以隐藏面板和标签，并在它们的位置直接在表单上绘制一些其他文本。

基本上，我正在做以下计算：使用 Control.PointToScreen() 获取标签的绝对屏幕位置，并使用 Control.PointToClient() 将其转换回相对位置，所以要么：

```
Dim newloc As Point = Me.PointToClient(ctl.PointToScreen(Point.Empty)) 
```

或者

```
Dim newloc As Point = Me.PointToClient(ctl.Parent.PointToScreen(ctl.Location)) 
```

我发现这两种方法有时会给我不同的结果——将我的新点放在负值的可见区域之外！- 但无法确定原因。我原以为它们应该是相同的（大多数时候它们是相同的）。

第一次阅读文档并没有帮助，但也许我跳过了一些东西......无论如何，在我开始扯头发之前，我会感谢任何帮助。

或者，另一方面，有没有更好的方法来做到这一点？

**编辑：示例结果**

所以，这是一个真实的例子。

Panel1 上 {X=4,Y=6} 处的 Label1；Label2 在 {X=163,Y=6} 在同一父级 Panel1 上。显然，我期待不同的 X 位置，但两者的 Y 应该相同。

当我同时运行项目时

```
ctl.PointToScreen(Point.Empty)
```

和

```
ctl.Parent.PointToScreen(ctl.Location)
```

在 {X=959,Y=119} 处为 Label1 提供相同的屏幕位置（当然，此处的绝对值可能会有所不同，具体取决于表单本身的位置），因此当 Me.应用 PointToClient（在 {X=5,Y=32} 处）。

下一行对 Label2 执行相同的计算（记住，相同的父级，父级 (6) 中的相同 Y 值），但结果完全不正确：ctl.Parent.PointToScreen() 给我 {X=1114,Y =63}。X 几乎是正确的 (959-4+163=1118)，但 Y 与我为 Label1 得到的 119 相差甚远。然后 ctl.PointToScreen() 给我 {X=166,Y=29} - 转换回 Form-Coordinates (Me.PointToClient) {X=-784,Y=-2}。

这些数字是一个接一个地计算并直接打印到调试窗口，没有移动任何东西......疯狂。

好的，这变得相当混乱，但我仍然希望有人有一个简单的解释。谢谢！

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2009-05-27T13:17:20.037

好的，我找到了解决方案。

我碰巧在创建控件*之前*调用了 Control.PointToScreen：Control.IsHandleCreated = False。

如果我确保首先创建控件（Control.CreateControl），那么这两种方法都同样有效。

我在后续调用中得到不同结果的原因是对 Control.PointToScreen 的第一次调用也会导致创建控件（因此它的父控件和位于父控件上的任何其他控件），这意味着第二个成功。

好吧，我很高兴能完成这个:-)

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-05-27T05:40:10.477

我觉得是睡觉。：） 代替：

> ctl.PointToScreen(Point.Empty)
> 
> ctl.Parent.PointToScreen(ctl.Location)

尝试：

> ctl.PointToScreen(Point.Empty)
> 
> ctl.PointToScreen(ctl.Location) // 注意没有 .Parent！

相反，您会看到 x/y 坐标的差异。

另外，在进行 PointToScreen 数学运算时，尝试使用 Control.TopLevelControl 或 Control.FindForm() 来获取最外层的 Form。

# apache - 无论文件是否存在，如何配置 Apache 以将某些 URL 转发到我的 servlet 容器

> ID：913079
> 
> 赞同：2
> 
> 时间：2009-05-26T22:25:15.997
> 
> 标签：apache, resin

如何配置 Apache 以将某个扩展名的 URLa（例如 *.htm）转发到我的 Servlet 容器（在本例中为 Resin），而无需先检查文件是否存在。

目前，如果 Apache 在目录结构中找不到请求的文件，它会提供 404，即使我的 web.xml Servlet 映射会在转发时处理请求。

我暂时求助于在我的 web 结构中放置一个与请求文件匹配的空文件（即 c:/dir/dir/index.htm），以便 Apache 转发请求。

Resin 的 Apache 配置与 Tomcat 的（下图）有点不同，但是问题似乎完全存在于 Apache 中，因为请求从未发送到 Resin。

帮助将不胜感激。

```
LoadModule caucho_module c:/resin-pro/win32/apache-2.0/mod_caucho.dll

NameVirtualHost *

<VirtualHost *>
    ServerName sub.domain.com
    DocumentRoot c:/web
    ResinConfigServer sub.domain.com 6802
</VirtualHost> 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-05-26T23:06:27.757

您需要阅读[如何将插件分发到 Resin](http://caucho.com/resin-3.0/install/plugin-dispatch.xtp)并明确配置要由 Resin 处理的 URL 以转发到 Resin：

> mod_caucho 通过联系 httpd.conf 或 resin.ini 中指定的 ResinConfigServer 来发现其配置。ResinConfigServer 可以是任何 Resin 服务器。当用户请求一个 URL 时，mod_caucho 使用它从 ResinConfigServer 确定的配置来确定是 Resin 还是 Apache 应该处理该请求。该决定基于 ResinConfigServer 的resin.conf 中的配置。

这意味着如果您希望 Resin 处理某些 URL，您需要在`resin.conf`.

# iphone - iPhone：跟踪/识别个人触摸

> ID：913086
> 
> 赞同：14
> 
> 时间：2009-05-26T22:26:48.693
> 
> 标签：iphone, cocoa-touch, uikit, multi-touch

我有一个关于跟踪 iPhone 上的触摸的快速问题，我似乎无法就此得出结论，因此非常感谢任何建议/想法：

我希望能够跟踪和识别 iphone 上的触摸，即。基本上每次触摸都有一个起始位置和一个当前/移动位置。触摸存储在 std::vector 中，一旦结束，它们应从容器中删除。一旦他们移动，他们的位置就会更新，但我仍然想跟踪他们最初开始的位置（手势识别）。

我从 [event allTouches] 中得到了触摸，事情是，NSSet 是未排序的，我似乎无法识别已经存储在 std::vector 中的触摸并引用 NSSet 中的触摸（所以我知道哪些已结束并应被删除，或已被移动等）

这是我的代码，当然，只需一根手指在触摸屏上即可完美运行，但如果不止一根，我确实会得到不可预知的结果......

```
 - (void) touchesBegan:(NSSet*)touches withEvent:(UIEvent*)event
{
    [self handleTouches:[event allTouches]];
}

- (void) touchesEnded:(NSSet*)touches withEvent:(UIEvent*)event
{
    [self handleTouches:[event allTouches]];
}

- (void) touchesMoved:(NSSet*)touches withEvent:(UIEvent*)event
{
    [self handleTouches:[event allTouches]];
}

- (void) touchesCancelled:(NSSet*)touches withEvent:(UIEvent*)event
{
    [self handleTouches:[event allTouches]];
}

- (void) handleTouches:(NSSet*)allTouches
{   
    for(int i = 0; i < (int)[allTouches count]; ++i)
    {
        UITouch* touch = [[allTouches allObjects] objectAtIndex:i];
        NSTimeInterval timestamp = [touch timestamp];

        CGPoint currentLocation = [touch locationInView:self];
        CGPoint previousLocation = [touch previousLocationInView:self];

        if([touch phase] == UITouchPhaseBegan)
        {
            Finger finger;
            finger.start.x = currentLocation.x;
            finger.start.y = currentLocation.y;
            finger.end = finger.start;
            finger.hasMoved = false;
            finger.hasEnded = false;

            touchScreen->AddFinger(finger);
        }
        else if([touch phase] == UITouchPhaseEnded || [touch phase] == UITouchPhaseCancelled)
        {
            Finger& finger = touchScreen->GetFingerHandle(i);

            finger.hasEnded = true;
        }
        else if([touch phase] == UITouchPhaseMoved)
        {
            Finger& finger = touchScreen->GetFingerHandle(i);

            finger.end.x = currentLocation.x;
            finger.end.y = currentLocation.y;
            finger.hasMoved = true;
        }
    }

    touchScreen->RemoveEnded();
} 
```

谢谢！

* * *

## 回答 #1

> 赞同：8
> 
> 时间：2010-03-28T07:18:08.340

It appears the "proper" way to track multiple touches is by the pointer value of the UITouch event.

You can find more details in the "Handling a Complex Multi-Touch Sequence" section of this [Apple Developer Documentation](https://developer.apple.com/library/ios/documentation/EventHandling/Conceptual/EventHandlingiPhoneOS/multitouch_background/multitouch_background.html#//apple_ref/doc/uid/TP40009541-CH5-SW9)

* * *

## 回答 #2

> 赞同：7
> 
> 时间：2009-05-27T04:22:36.057

要解决您的问题，请废弃您的“handleTouches”方法。您在 handleTouches 方法中做的第一件事是在 touchPhase 上打开它，但这已经给您了。如果您在 touchesBegan 中收到触摸，您就知道触摸在 UITouchPhaseBegan 中。通过将四个触摸方法中的触摸汇集到一个方法中，您就违背了拥有四个委托方法的目的。

在其中的每一种方法中，Apple 都为您提供了处理当前触摸的不同阶段的机会。

第二件事是您不需要搜索当前触摸的事件，它作为参数提供给您：touches。

一个事件由多组触摸组成。为方便起见，即使它也可以在事件中找到，您也会得到当前的触摸。

因此，在 touchesBegan 中，您开始跟踪触摸。

```
 - (void) touchesBegan:(NSSet*)touches withEvent:(UIEvent*)event{

        NSString *startPoint = NSStringFromCGPoint([[touches anyObject] locationInView:self]);  

        NSDictionary * touchData = [NSDictionary dictionaryWithObjectsandKeys: startPoint, @"location", touches, @"touch"]

        [startingLocations addObject:touchData];

        } 
```

我正在使用一系列字典来保存我的触摸数据。

尝试分离您的代码并将其移动到适当的触摸方法中。对于指导，Apple 有几个示例项目，它们专注于触摸并向您展示如何设置这些方法。

请记住，这些方法将在每个阶段的每次触摸时自动调用，您无需循环通过事件来找出发生了什么。

指向每组触摸的指针保持不变，只是数据发生了变化。

另外，我会阅读有关事件处理的 iPhone OS 编程指南部分，该部分对我上面所说的内容进行了更深入的介绍，其中有几个图表解释了随着时间的推移触摸与事件的关系。

摘录：

> 在 iPhone OS 中，一个 UITouch 对象代表一个触摸，一个 UIEvent 对象代表一个事件。事件对象包含当前多点触控序列的所有触控对象，并且可以提供特定于视图或窗口的触控对象（见图 3-2）。在一个序列中，一个给定手指的触摸对象是持久的，UIKit 在跟踪整个手指时会对其进行变异。改变的触摸属性是触摸的阶段、它在视图中的位置、它的先前位置和它的时间戳。事件处理代码评估这些属性以确定如何响应事件。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-05-26T23:40:12.807

您应该能够通过存储所有触摸的先前位置，然后在检测到新触摸时比较这些先前位置来正确整理您的触摸。

在你的`-handleTouches`方法中，你可以在你的 for 循环中加入这样的东西：

```
// ..existing code..
CGPoint previousLocation = [touch previousLocationInView:self];

// Loop through previous touches
for (int j = 0; j < [previousTouchLocationArray count]; j++) {
  if (previousLocation == [previousTouchLocationArray objectAtIndex:j]) {
    // Current touch matches - retrieve from finger handle j and update position
  }
}

// If touch was not found, create a new Finger and associated entry 
```

显然，您需要做一些工作才能将其集成到您的代码中，但我很确定您可以使用这个想法来正确识别在屏幕上移动的触摸。此外，我刚刚意识到 CGPoint 不能很好地适合 NSArray - 您需要将它们包装在 NSValue 对象中（或使用不同类型的数组）。

# flash - 使用 URLLoader 在 Actionscript 3 中上传带有其他变量的文件？

> ID：913087
> 
> 赞同：0
> 
> 时间：2009-05-26T22:27:09.147
> 
> 标签：flash, actionscript-3, upload

我正在尝试通过 Actionscript 3 中的 URLLoader 上传文件，我知道这是可能的，至少根据文档，但我想不通。因此，如果有人在我想知道我遗漏了什么之前已经这样做了，具体来说，我不确定 URLRequest 及其数据属性。我知道我的文件数据应该去那里，但我不确定如何去。

这是我正在使用的代码的一种非常基本的形式：

```
//===============================================
public function sendRequest():void {
//===============================================

  var newFile:FileReference(); //this eventually gets data loaded to it before I make request
  var sendForm:URLLoader = new URLLoader();
  var urlString:String = "/proposal_request/?";
  var header:URLRequestHeader = new URLRequestHeader("Content-Disposition: attache[attachment]; filename=" + newFile.name);
  ...

  ...
  urlString += "variable=" + instance_name.text;
  urlString += "another_variable=" + another_instance_name.text;
  ...

  ...
  var requester:URLRequest = new URLRequest(urlString);
  requester.contentType = "multipart/form-data";
  requester.method = URLRequestMethod.POST;
  requester.requestHeaders.push(header);
  requester.data = newFile; //here's where I'm most confused, should this be encoded?
  ...

  ...
  sendForm.addEventListener(HTTPStatusEvent.HTTP_STATUS, responseStatus);
  sendForm.load(requester);

} 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-05-27T02:02:12.050

你总是可以那样做——但你真的不必这样做。

*FileReference*类为您提供了一种上传文件的简单方法：方法[*upload()*](http://livedocs.adobe.com/flash/9.0/ActionScriptLangRefV3/flash/net/FileReference.html#upload())。

```
public function upload(request:URLRequest, uploadDataFieldName:String = "Filedata", testUpload:Boolean = false):void 
```

在您的*FileReference 对象*有一些数据后，只需调用*上传*URLRequest和可选的数据字段字符串，以及服务器的一些额外信息，以及将（停用）测试上传的布尔值：如果您的文件超过 10KB，则*闪存*在上传真实文件之前，播放器会尝试发送一个 0 字节的文件作为连接测试。

之后，您可以只监听*progress*、*complete*和*uploadDataComplete*事件来跟踪上传。

[*关于 FileReference.upload() 的 Adob​​e AS3 参考*](http://livedocs.adobe.com/flash/9.0/ActionScriptLangRefV3/flash/net/FileReference.html#upload())

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-10-02T22:42:00.480

如果您在使用 FileReference 浏览后不更改文件数据，则上述方法很好。假设您在上传前调整图像大小或裁剪图像，您将如何使用 FileReference.upload 上传。

URLLoader 可用于将二进制数据发送到服务器，但在这种情况下，上传进度不可用，因为只有在图像完全上传后才会触发 ProgressEvent。

有没有办法显示调整大小图像的中间图像上传进度，类似于 FileReference 组件显示的那种。

# jquery - Jquery 和 ajax - 使用链接注入文件内容

> ID：913088
> 
> 赞同：1
> 
> 时间：2009-05-26T22:27:19.690
> 
> 标签：jquery

我希望实现以下目标。我有一个最初为空的绝对定位的 div（#description），它位于另一个 div（#zoom）的顶部，当用户选择页面侧面的 15 个左右缩略图中的一个时，它会向其中注入大图像。

我在旁边有一个链接，例如：

```
<div id="whatisit"><a href="description.php"></div> 
```

单击时应将“description.php”文件内容注入网站上的#description div。首先，当然需要“淡出”#zoom 的内容。

我有以下代码，我试图将它们放在一起来完成这项工作。

```
 <script language="javascript">
$(document).ready(function() {
    $("#whatisit a").click(function() {
        var descPath = $(this).attr("href");
        $("#zoom img").fadeOut("slow", function() {
            $(this).attr({ src:descPath }).fadeIn("slow");
      });
    return false;
    });
});
</script> 
```

它会淡出#zoom 的内容，但不会注入或淡出“descriptions.php”文件内容。难道我做错了什么？还是错过了什么？

非常感谢您的帮助。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-05-26T22:54:37.937

您必须使用 AJAX 获取请求，因此请执行以下操作：

```
<script language="javascript">
$(document).ready(function() {
    $("#whatisit a").click(function() {
        var descPath = $(this).attr("href");
        $.get(descPath, function(html_returned) {
            $("#zoom img").fadeOut("slow", function() {
                $("#description").html(html_returned).fadeIn("slow");
            });
        }, "html");
        return false;
    });
});
</script> 
```

这应该将description.php 的内容注入#description。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-05-26T22:31:51.103

好吧，看起来您正试图通过像在图像上`div`那样设置其`src`属性来将内容推送到 a 中，但这不会做任何事情。可能如果它`iframe`是有意义的。否则，您将不得不花更多的时间将 description.php 的内容拉入 div，我认为。

# c# - 如何使用 C# 将每个单词的第一个字符或整个字符串的第一个字符大写？

> ID：913090
> 
> 赞同：93
> 
> 时间：2009-05-26T22:28:12.543
> 
> 标签：c#, string, humanize

我可以编写自己的算法来做到这一点，但我觉得应该有相当于[ruby](http://api.rubyonrails.org/classes/ActiveSupport/CoreExtensions/String/Inflections.html#M001339)​​ 在 C# 中的人性化。

我用谷歌搜索了它，但只找到了人性化日期的方法。

例子：

*   一种将“Lorem Lipsum Et”变成“Lorem Lipsum et”的方法
*   一种将“Lorem Lipsum et”变成“Lorem Lipsum Et”的方法

* * *

## 回答 #1

> 赞同：152
> 
> 时间：2009-05-27T07:08:56.777

[正如@miguel's answer](https://stackoverflow.com/questions/913090/how-to-capitalize-the-first-character-of-each-word-or-the-first-character-of-a-w/913102#913102)的评论中所讨论的，您可以使用[`TextInfo.ToTitleCase`](http://msdn.microsoft.com/en-us/library/system.globalization.textinfo.totitlecase.aspx)自 .NET 1.1 以来可用的。这是与您的示例相对应的一些代码：

```
string lipsum1 = "Lorem lipsum et";

// Creates a TextInfo based on the "en-US" culture.
TextInfo textInfo = new CultureInfo("en-US",false).TextInfo;

// Changes a string to titlecase.
Console.WriteLine("\"{0}\" to titlecase: {1}", 
                  lipsum1, 
                  textInfo.ToTitleCase( lipsum1 )); 

// Will output: "Lorem lipsum et" to titlecase: Lorem Lipsum Et 
```

它将忽略所有大写的内容，例如“LOREM LIPSUM ET”，因为它会处理首字母缩略词在文本中的情况，以便“IEEE”（电气和电子工程师协会）不会变成“ieee”或“哎呀”。

但是，如果您只想将第一个字符大写，则可以执行[此处](http://channel9.msdn.com/forums/TechOff/252814-Howto-Capitalize-first-char-of-words-in-a-string-NETC/)的解决方案……或者您可以拆分字符串并将列表中的第一个字符大写：

```
string lipsum2 = "Lorem Lipsum Et";

string lipsum2lower = textInfo.ToLower(lipsum2);

string[] lipsum2split = lipsum2lower.Split(' ');

bool first = true;

foreach (string s in lipsum2split)
{
    if (first)
    {
        Console.Write("{0} ", textInfo.ToTitleCase(s));
        first = false;
    }
    else
    {
        Console.Write("{0} ", s);
    }
}

// Will output: Lorem lipsum et 
```

* * *

## 回答 #2

> 赞同：41
> 
> 时间：2017-07-11T12:27:17.073

还有另一个优雅的解决方案：

`ToTitleCase`在项目的**静态**类中定义函数

```
using System.Globalization;

public static string ToTitleCase(this string title)
{
    return CultureInfo.CurrentCulture.TextInfo.ToTitleCase(title.ToLower()); 
} 
```

然后在项目的任何地方像字符串扩展一样使用它：

```
"have a good day !".ToTitleCase() // "Have A Good Day !" 
```

* * *

## 回答 #3

> 赞同：39
> 
> 时间：2015-04-02T02:11:50.587

使用正则表达式看起来更干净：

```
string s = "the quick brown fox jumps over the lazy dog";
s = Regex.Replace(s, @"(^\w)|(\s\w)", m => m.Value.ToUpper()); 
```

* * *

## 回答 #4

> 赞同：2
> 
> 时间：2009-05-26T22:34:18.133

如果您只想将第一个字符大写，只需将其粘贴在您自己的实用方法中即可：

```
return string.IsNullOrEmpty(str) 
    ? str
    : str[0].ToUpperInvariant() + str.Substring(1).ToLowerInvariant(); 
```

还有一个库方法可以将每个单词的第一个字符大写：

[http://msdn.microsoft.com/en-us/library/system.globalization.textinfo.totitlecase.aspx](http://msdn.microsoft.com/en-us/library/system.globalization.textinfo.totitlecase.aspx)

* * *

## 回答 #5

> 赞同：2
> 
> 时间：2019-03-22T16:20:13.560

所有示例似乎都使其他字符首先降低，这不是我需要的。

`customerName`= `CustomerName`<-- 这就是我想要的

`this is an example`=`This Is An Example`

```
public static string ToUpperEveryWord(this string s)
{
    // Check for empty string.  
    if (string.IsNullOrEmpty(s))
    {
        return string.Empty;
    }

    var words = s.Split(' ');

    var t = "";
    foreach (var word in words)
    {
        t += char.ToUpper(word[0]) + word.Substring(1) + ' ';
    }
    return t.Trim();
} 
```

* * *

## 回答 #6

> 赞同：1
> 
> 时间：2014-10-24T10:27:33.090

CSS 技术没问题，但只会改变浏览器中字符串的呈现方式。更好的方法是在发送到浏览器之前使文本本身大写。

上述大多数实施都可以，但没有一个解决如果您有需要保留的混合大小写单词，或者如果您想使用真正的标题大小写会发生什么问题，例如：

“在哪里学习博士课程在美国”

或者

“国税局表格 UB40a”

同样使用 CultureInfo.CurrentCulture.TextInfo.ToTitleCase(string) 会保留大写单词，如“sports and MLB棒球”中的“Sports And MLB Baseball”，但如果将整个字符串设为大写，则会导致问题。

所以我整理了一个简单的函数，通过将它们包含在 specialCases 和 lowerCases 字符串数组中，您可以保留大写和混合大小写的单词，并使小写的单词小写（如果它们不在短语的开头和结尾）：

```
public static string TitleCase(string value) {
        string titleString = ""; // destination string, this will be returned by function
        if (!String.IsNullOrEmpty(value)) {
            string[] lowerCases = new string[12] { "of", "the", "in", "a", "an", "to", "and", "at", "from", "by", "on", "or"}; // list of lower case words that should only be capitalised at start and end of title
            string[] specialCases = new string[7] { "UK", "USA", "IRS", "UCLA", "PHd", "UB40a", "MSc" }; // list of words that need capitalisation preserved at any point in title
            string[] words = value.ToLower().Split(' ');
            bool wordAdded = false; // flag to confirm whether this word appears in special case list
            int counter = 1;
            foreach (string s in words) {

                // check if word appears in lower case list
                foreach (string lcWord in lowerCases) {
                    if (s.ToLower() == lcWord) {
                        // if lower case word is the first or last word of the title then it still needs capital so skip this bit.
                        if (counter == 0 || counter == words.Length) { break; };
                        titleString += lcWord;
                        wordAdded = true;
                        break;
                    }
                }

                // check if word appears in special case list
                foreach (string scWord in specialCases) {
                    if (s.ToUpper() == scWord.ToUpper()) {
                        titleString += scWord;
                        wordAdded = true;
                        break;
                    }
                }

                if (!wordAdded) { // word does not appear in special cases or lower cases, so capitalise first letter and add to destination string
                    titleString += char.ToUpper(s[0]) + s.Substring(1).ToLower();
                }
                wordAdded = false;

                if (counter < words.Length) {
                    titleString += " "; //dont forget to add spaces back in again!
                }
                counter++;
            }
        }
        return titleString;
    } 
```

这只是一种快速简单的方法 - 如果您想花更多时间在上面，可能会有所改进。

如果您想保留“a”和“of”等较小单词的大写，那么只需将它们从特殊情况字符串数组中删除即可。不同的组织有不同的资本化规则。

您可以在此站点上看到此代码的示例：[Egg Donation London](http://www.eggdonationlondon.co.uk/services/uk-egg-bank/introduction) - 此站点通过解析 url 例如“/services/uk-egg-bank/introduction”在页面顶部自动创建面包屑路径 - 然后每个路径中的文件夹名称将连字符替换为空格并将文件夹名称大写，因此 uk-egg-bank 变为 UK Egg Bank。（保留大写“UK”）

此代码的扩展可能是在共享文本文件、数据库表或 Web 服务中具有首字母缩写词和大写/小写单词的查找表，以便可以从一个地方维护混合大小写单词的列表并应用于许多不同的依赖于该功能的应用程序。

* * *

## 回答 #7

> 赞同：0
> 
> 时间：2009-05-26T22:48:57.090

.NET 中没有用于正确语言大写的预构建解决方案。你要什么样的大写？您是否遵循《芝加哥风格手册》的惯例？AMA 还是 MLA？即使是简单的英文句子大写也有 1000 多个单词的特殊例外。我无法谈论 ruby​​ 的 humanize 做了什么，但我想它可能不遵循大写的语言规则，而是做一些更简单的事情。

在内部，我们遇到了同样的问题并且不得不编写相当多的代码来处理文章标题的正确（在我们的小世界中）大小写，甚至不考虑句子的大写。它确实变得“模糊”:)

这真的取决于你需要什么 - 你为什么要尝试将句子转换为正确的大写（以及在什么情况下）？

* * *

## 回答 #8

> 赞同：0
> 
> 时间：2020-01-26T07:26:22.217

我使用自定义扩展方法实现了同样的目标。对于**第一个子字符串的第一个字母，**请使用方法`yourString.ToFirstLetterUpper()`。对于**不包括冠词和一些命题的每个子串的首字母**，使用 方法`yourString.ToAllFirstLetterInUpper()`。下面是一个控制台程序：

```
class Program
    {
        static void Main(string[] args)
        {
            Console.WriteLine("this is my string".ToAllFirstLetterInUpper());
            Console.WriteLine("uniVersity of lonDon".ToAllFirstLetterInUpper());
        }
    }

    public static class StringExtension
    {
        public static string ToAllFirstLetterInUpper(this string str)
        {
            var array = str.Split(" ");

            for (int i = 0; i < array.Length; i++)
            {
                if (array[i] == "" || array[i] == " " || listOfArticles_Prepositions().Contains(array[i])) continue;
                array[i] = array[i].ToFirstLetterUpper();
            }
            return string.Join(" ", array);
        }

        private static string ToFirstLetterUpper(this string str)
        {
            return str?.First().ToString().ToUpper() + str?.Substring(1).ToLower();
        }

        private static string[] listOfArticles_Prepositions()
        {
            return new[]
            {
                "in","on","to","of","and","or","for","a","an","is"
            };
        }
    } 
```

**输出**

```
This is My String
University of London
Process finished with exit code 0. 
```

* * *

## 回答 #9

> 赞同：-1
> 
> 时间：2009-05-26T22:34:57.150

据我所知，如果不编写（或抄袭）代码，就没有办法做到这一点。C# 网络（哈！）你的上、下和标题（你有什么）案例：

[http://support.microsoft.com/kb/312890/EN-US/](http://support.microsoft.com/kb/312890/EN-US/)

# java - findComponentAt() 可以在绘制 JComponent 之前工作吗？

> ID：913101
> 
> 赞同：0
> 
> 时间：2009-05-26T22:30:26.940
> 
> 标签：java, swing

我正在开发一个 GUI，其中 JComponents 在屏幕上被“标记”。换句话说，不会显示实际的组件，而是显示组件的图像。这是一个图表，其中图表的节点是自定义的 Swing 组件——或者更确切地说是 Swing 组件的标记图像。

现在我想在我的节点中显示特定组件的工具提示。

为此，我创建了一个与显示的 JComponent 相同的 JComponent，并使用鼠标 x 和 y 值向 findComponentAt() 询问正确的组件。这不太好。如果我为节点重用 JComponents，如果我尝试为与最后绘制的节点大小不同的节点获取工具提示，就会感到困惑。如果我在计算工具提示时为每个节点创建一个新的 JComponent 并创建一个新的，则新的初始大小为 0,0。我可以使用 getPreferredSize() 计算来设置大小，但这仍然不起作用。根 JComponent（一个 JPanel）具有正确的大小，但它的子级还没有任何大小。

工具提示计算代码示例：

```
// Get a component that matches the stamped component
JComponent nodeComponent = getNodeComponent();

// These next two lines get the size right      
nodeComponent.setSize(nodeComponent.getPreferredSize());
nodeComponent.revalidate();

Component componentTop = nodeComponent.findComponentAt(relativeX, relativeY); 
```

无论传递什么 x 和 y 值，componentTop 都会作为根 JComponent 返回。

那么是否有可能让 Swing 正确计算 JComponents 的大小和位置而无需实际绘制它们？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2009-05-27T19:43:09.120

您在图表中有组件的图像，它们必须具有它们的大小才能正确绘制。

要找到您的“印章”，您应该在图表中向后走（按 z 顺序）并找到您的鼠标位置落入的第一个图像。

首选尺寸不起作用，我认为您应该依赖“邮票”的尺寸。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-06-03T13:30:53.517

我自己找到了答案。关键问题是 Swing 不想布局组件，除非该组件具有适当的父级。因此，我将代码更改为：

```
 parentComponent.add(nodeComponent);

    // Set the node's size and validate it so it's laid out properly
    nodeComponent.setBounds((int)realizer.getX(), (int)realizer.getY(), (int)realizer.getWidth(), (int)realizer.getHeight());

    nodeComponent.validate();

    // Now we can properly find the child component under our mouse
    Component componentTop = nodeComponent.findComponentAt(relativeX, relativeY);

    // Now remove it from the view
    parentComponent.remove(nodeComponent); 
```

这就像一个魅力。您应该能够使用类似的过程在 JLists 或 JTables（也使用此 Renderer 模式）中查找子组件。

# sql - 编写 SQL 查询，其中一个值映射到所有可能的值

> ID：913112
> 
> 赞同：0
> 
> 时间：2009-05-26T22:31:41.180
> 
> 标签：sql

我有一张桌子

一种

```
name    num
------------
A        1
B        0
C        3 
```

乙

```
num      marks
---------------
1        90
3        40 
```

询问： ？？

结果：

```
name    marks
--------------
A        90
C        40
B        90
B        40 
```

因此，表 A 中的数字“0”对应于所有 num 列值。有没有办法可以编写这个查询

我知道得到这个

```
name    marks
--------------
A       90
C       40 
```

我们可以完成这个

```
select A.name, B.marks from A,B where A.num = B.num; 
```

编辑：在这种情况下 0 映射到 num 值 1 和 3

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2009-05-26T22:34:52.937

怎么样：

```
SELECT A.name, B.marks FROM A, B WHERE A.num = 0 OR A.num = B.num 
```

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2009-05-26T22:41:01.443

```
select a.name, b.marks from a join b on a.num = b.num
union all
select a.name, b.marks from a, b where a.num = 0 
```

您*可能会*发现这比带有“OR”的 where 子句更有效。虽然，老实说，您可能不会，但没有真正的方法可以绕过必须以一种或另一种方式扫描整个 A 和 B。但是查询规划器通常有助于您将“OR”条件拆分为联合。

编辑：

只是想稍微扩展一下。这样做可能是有利的原因是如果工会的两个部分受益于以完全不同的方式完成。例如，第二部分可以从查找 a 中的所有行（num=0）开始，而第一部分可能更适合于对 a 进行全扫描并将索引查找/哈希查找到 b，或者合并 a 上的索引(num) 和 b(num)。

我还要说这个查询源于可疑的设计。你不能有从 a(num) 到 b(num) 的外键约束，即使这样做是有意义的，因为 (a.num=0) 不会匹配 b 中的任何行。如果您在 b 中添加了具有 (num=0,marks=90) 和 (num=0,marks=40) 的行，则可以使用简单的内部连接轻松编写查询。虽然这确实意味着为每个可能的标记保留两行，但这可以使用触发器来完成，该触发器检测 num 的非零值的插入，并使用 num=0 进行额外的插入。我想每种方法都有优点和缺点。但是我真的很喜欢将 fkey 约束放在数据库中，并且在这种情况下不使用它们会让我感到紧张——如果 a 中的记录得到一个不在 b 中的 num 会发生什么？如果 b 中的一行被删除会怎样？

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-05-26T22:36:00.547

```
select A.name, B.marks from A,B where A.num = B.num or A.num=0; 
```

也许？

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2009-05-26T22:42:37.773

```
SELECT  A.name
       ,B.marks
FROM    dbo.so913112_A AS A
INNER JOIN dbo.so913112_B AS B
        ON A.num = B.num
           OR A.num = 0 
```

给出：

```
name marks
---- -----------
A    90
B    90
B    40
C    40

(4 row(s) affected) 
```

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2013-05-28T10:31:06.190

```
select a.name,b.marks
from a,b 
where a.Num=b.num or a.num=0 
```

# c# - DependencyPropert 未使用 DynamicResource 作为参数从 XAML 设置

> ID：913118
> 
> 赞同：1
> 
> 时间：2009-05-26T22:33:16.840
> 
> 标签：c#, properties, wpf-controls, dynamicresource

我正在尝试开发一个自定义的三态按钮用户控件，到目前为止我一直在使用 CTF 来设置属性。
但我想将其更改为使用带有 PropertiesDependencies 的 WPF 属性系统。

不幸的是，当我使用 DynamicResource 从我的 xaml（父亲）设置属性时，我无法使其工作，但未设置该值。

```
<common:StateImageButton x:Name="story_buttonRecord"  BackTest="{DynamicResource backTest}" /> 
```

这是我的按钮控制器中的代码：

```
public ImageSource BackTest
    {
        get { return (ImageSource)this.GetValue(BackProp); }
        set { this.SetValue(WidthProp,value); }
    }

    public static readonly DependencyProperty BackProp =
        DependencyProperty.Register(
            "BackTest",
            typeof(ImageSource),
            typeof(StateImageButton),
            new FrameworkPropertyMetadata()); 
```

我什至还没有在我的按钮 xaml 中使用该属性，但它显然甚至没有进入 Setter。我在网上搜索了很多都没有成功。所以也许我错过了一些东西。

提前感谢您的帮助，鲍里斯

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-05-26T22:51:10.003

此外，WPF 不使用提供的 setter 来设置属性，而是直接进行。

当 WPF 设置属性时进行调试的方法是在设置属性时添加回调，就像这样。

```
public static readonly DependencyProperty BackProp =
    DependencyProperty.Register(
        "BackTest",
        typeof(ImageSource),
        typeof(StateImageButton),
        new FrameworkPropertyMetadata(OnBackChanged));

private static void OnBackChanged(
    DependencyObject d, 
    DependencyPropertyChangedEventArgs e)
{
    var sender = (StateImageButton)d; // Put a breakpoint here
} 
```

# java - 向 JPanel 添加额外的 JPanel

> ID：913139
> 
> 赞同：6
> 
> 时间：2009-05-26T22:38:01.697
> 
> 标签：java, swing, jpanel

伙计们，这是一个相当基本的问题。

基本上我有这样的代码：

```
public SuperPanel() {
    setLayout(new BorderLayout());
    add(panel1(), BorderLayout.NORTH);
    add(panel2(), BorderLayout.CENTER);
    add(panel3(), BorderLayout.SOUTH);
} 
```

这一切都运作良好。问题是我还有另一部分要添加到中心。显然，仅仅使用**`add(newPanel(), BorderLayout.CENTER)`**是行不通的。但是你可以在`JPanel`s 中添加 s `JPanel`，对吗？

所以我做了以下更改：

```
public SuperPanel() {
    setLayout(new BorderLayout());
    add(panel1(), BorderLayout.NORTH);
    add(supersweetpanel(), BorderLayout.CENTER);
    add(panel3(), BorderLayout.SOUTH);
} 
```

存在`supersweetpanel()`：

```
public JPanel supersweetpanel() {
    JPanel sswp = new JPanel();
    setLayout(new BorderLayout());
    add(panel2(), BorderLayout.NORTH);
    return sswp;
} 
```

现在它覆盖了`panel1`！如果我将它设置为其他任何值（`CENTER`, `SOUTH`, 你有什么），前两个面板将完全消失。非常感谢您的帮助。

* * *

## 回答 #1

> 赞同：14
> 
> 时间：2009-05-26T22:55:36.653

`SuperPanel`很可能是 的子类`JPanel`，对吧？您不小心添加`panel2`到`this`(the `SuperPanel`)，而不是`sswp`. 尝试：

```
public JPanel supersweetpanel() {
        JPanel sswp = new JPanel();
        sswp.setLayout(new BorderLayout());
        sswp.add(panel2(), BorderLayout.NORTH);
        return sswp;
    } 
```

# javascript - 如果未启用 JavaScript，则从服务器写入内容

> ID：913142
> 
> 赞同：3
> 
> 时间：2009-05-26T22:39:04.677
> 
> 标签：javascript

我正在开发一个默认情况下通过 AJAX 加载内容的项目。

我希望它检查用户（或 SE bot）是否禁用了 JS，如果是，则通过 PHP 静态显示内容。

有没有办法做到这一点？我认为 noscript 标记在这里不起作用，因为该页面对于非 JS 用户或机器人来说是空的。

另外重定向到不同的页面对我来说没有意义，因为搜索引擎不会考虑到原始页面的链接，并且由于它们将被重定向，因此无法索引该页面。

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2009-05-26T22:47:47.840

当用户没有 JavaScript 时，实际上并没有办法自动切换到不同的页面。

我要做的是将非 JS 版本显示为默认值，但在每个页面上都有一个脚本，该脚本重定向到 AJAX 版本并设置一个 cookie，以便从那时起所有页面立即显示 AJAX 版本。哦，最好保留一个带有指向非 AJAX 版本的链接的 noscript 标签，以防出现任何问题，例如已经有 cookie 禁用 JavaScript 的人。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2009-05-26T23:11:16.013

[不显眼的 JS](http://en.wikipedia.org/wiki/Unobtrusive_JavaScript)怎么样？您可以将纯 html 页面设为默认页面，然后使用 JS 隐藏或用您喜欢的 AJAX 控件替换笨重的位。您最终每个视图只有一页，它会动态升级自身。URL 也可以安全地传递。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2009-05-27T00:10:36.487

您可以使用`<noscript>`html 标记。

所有主要浏览器都支持该标签。这包括 IE、Firefox、Opera、Chrome 和 Safari。

这是一个正常的例子：

```
<script type="text/javascript">
document.write("Hello World!")
</script>
<noscript>Your browser does not support JavaScript!</noscript> 
```

这是一个使用`<meta>`重定向标签的变体，它将重定向不支持 javascript 的浏览器（经过测试并且有效）：

```
<script type="text/javascript">
document.write("Hello World!")
</script>
<noscript>Please wait while you're being redirected to the no-script version...
<META http-equiv="refresh" content="1;URL=http://yoursite/index.php?version=noscript">
</noscript> 
```

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2009-05-27T01:18:02.373

两种方法可以考虑，如下：（CSS 显示或 DOM 节点移除）

1）***CSS：***

考虑以 JS 为条件的各种节点的 css 显示控件。

在加载时，JavaScript 可以将相关元素的显示样式更改为“无”。

*   如果没有 JS，则页面元素不隐藏。

在您的 onload init 函数中，设置：`elObj.style.display:none;`.

添加 noscript 链接或通知，以便仅禁用 JavaScript 的人可以根据您告诉他们他们没有看到的内容来选择启用或不启用它。

或者

2）***节点提取：***

第二种选择是让 JavaScript 实际上删除冗余节点 onload。

*   机器人和非 JS 用户将可以立即、非侵入性地访问页面元素。
*   JS 用户将获得您的脚本交付的商品。

例如，您可能要删除一个具有已知 id 的祖父容器分区，例如“nonjs”。

我用来从内存中删除它们的函数：

```
XDOM.deleteNode = function(node) {
    if (!node || typeof node != "object") {return;}
    var trashcan = XDOM.getElementById('xdomtrashcan');
    if (!trashcan) {
        trashcan = document.createElement('DIV');
            // quick and dirty property set:
        trashcan.id = 'xdomtrashcan';
        trashcan.style.display = 'none';
        document.body.appendChild(trashcan);
     }
     trashcan.appendChild(node);
     trashcan.innerHTML = ""; //empty the trash
  }; 
```

*   （XDOM 规范了浏览器差异。此代码使用 XDOM.getElementById。改用您最喜欢的跨浏览器函数。）

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2009-05-27T01:25:54.247

如果您有一个“主页”或用户从您导航的其他一些先前页面，则可以包含一些 javascript 来设置 cookie。当用户选择您的目标页面时，您可以生成纯 HTML 或 AJAXy 页面，具体取决于是否设置了 cookie。

A varation on this would be to publish the URL address of a "landing" page which sets (or doesnt set) the cookie with an "onload" script and does an HTML redirect to the page with the data.

# php - 确保在使用 PHP 时考虑所有异常

> ID：913143
> 
> 赞同：4
> 
> 时间：2009-05-26T22:39:46.703
> 
> 标签：php, exception-handling

我在 Java 中使用过异常，并且喜欢它不会让您调用方法的方式，除非您捕获或抛出它可能抛出的异常。

我在 PHP 中寻找类似的东西。我意识到 PHP 比 Java 更动态，甚至不允许你定义它抛出的异常，但我能得到的最接近的是什么？

我们使用 PHP Doc 记录我们的方法，因此如果您在没有正确的 try/catch 块的情况下调用方法，或者在没有正确的 @thows 注释的情况下引发异常，那么触发 E_WARNING 的东西将是完美的。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-05-27T00:19:40.387

PHP本身没有办法做到这一点。您将不得不解析 PHP 并自己弄清楚。尝试为此编写[phc 插件](http://www.phpcompiler.org/)。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-05-26T22:45:35.567

我认为您根本无法合理地接近，因为语言核心没有提供任何东西供您使用。充其量，您最终会创建某种完全用户空间的函数调用/异常验证机制，这将对性能产生绝对可怕的影响。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2009-05-26T23:02:09.357

我不确定您能否实现既定目标。PHP 环境不会分析函数可能会或可能不会做什么，这通常是其他语言的编译时操作（我认为）。我认为您甚至无法通过反射找到那种东西。

但是，当您说您无法定义抛出的异常时，您错了，因为 Exception 基类是[完全可扩展](http://www.php.net/manual/en/language.exceptions.extending.php)的。PHP默认不会抛出任何异常，它会触发错误。触发错误和异常之间存在根本区别，后者在很大程度上是用户级构造。

这不是你的问题，但我提出一个建议，如果你想迁移到一个完全面向异常的环境，你可以使用[set_error_handler()](http://www.php.net/manual/en/function.set-error-handler.php)编写自己的错误处理程序并管理 PHP 触发的错误，并拥有它抛出异常。

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2009-05-27T08:12:56.203

我认为您可以使用异常处理程序和反射在 PHP 中简单地重现此行为。

```
class YourException extends Exception {
  public function __toString() {
    return __CLASS__;
  }
}

class MyObject {
    public function __construct(){}
    /**
    * @throws MyException
    */
    public function myMethod() {
        return 'foo';
    }
}

try {
    $o = new MyObject();
    $o->myMethod();
} 
catch(YourException $e) {
    $method = new ReflectionMethod('MyObject', 'myMethod');
    $method->getDocComment();

    $throws = // Get the @throws comment (foreach, regexp, whatever);
    if($e === $throws) {
        // do something
    }
} 
```

[设置您自己的异常处理程序。](http://php.net/set_exception_handler)

[使用反射机制抓取和分析评论（见 getDocComment）](http://php.net/manual/en/language.oop5.reflection.php#language.oop5.reflection.reflectionclass)

# wpf - 文本框焦点上的 ListBoxItem 选择

> ID：913144
> 
> 赞同：13
> 
> 时间：2009-05-26T22:40:37.433
> 
> 标签：wpf, textbox, listbox, selection

我有一个使用以下 DataTemplate 显示项目的 ListBox：

```
<DataTemplate x:Key="PersonTemplate" DataType="{x:Type DAL:ResultItem}" >
  <StackPanel Width="280" >
    <TextBox BorderThickness="0" IsReadOnly="True" Background="Transparent" Text="{Binding FullName1, Mode=OneWay}"/>
    ... 
  </StackPanel>
</DataTemplate> 
```

我使用透明、只读、无边框的 TextBox 而不是 TextBlock，因为我希望用户能够选择要复制的文本。我应该采取不同的做法吗？我怎样才能这样写，以便当用户单击 TextBox 时， ListBoxItem 也会被选中？

谢谢！

* * *

## 回答 #1

> 赞同：22
> 
> 时间：2009-05-26T23:39:24.990

我发现答案只是从 ListBoxItem 的角度来执行此操作，将以下内容添加到其 DataTemplate：

```
<Style.Triggers>
  <Trigger Property="IsKeyboardFocusWithin" Value="True">
    <Setter Property="IsSelected" Value="True"/>
  </Trigger>
</Style.Triggers> 
```

# .net - 在 vb2005 中通过表单上的所有控件的最佳方法是什么

> ID：913152
> 
> 赞同：1
> 
> 时间：2009-05-26T22:43:03.200
> 
> 标签：.net, vb.net

在 vb2005 中通过窗体上的所有控件的最佳方法是什么？我正在编写一个程序，它可以根据表单上的信息编辑一串字节。每个控件都标有它修改的十六进制地址和可能的值，遍历表单上所有控件的最佳方法是什么，即使是嵌入在其他控件中的那些控件？

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2009-05-26T22:48:43.657

像这样，传入表单开始：

```
Private Sub DoSomethingToAllControls(ByVal Container As Control)
    Dim ctl As Control
    For Each ctl In Container.Controls
        ' Do Something..

        ' Recursively call this function for any container controls.
        If ctl.HasChildren Then
            DoSomethingToAllControls(ctl)
        End If
    Next
End Sub 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-05-26T22:54:32.773

从当前窗体中获取 System.Windows.Forms.Control.ControlCollection (Me.Controls) 的实例。从那里逐步浏览集合中的控件。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2009-05-26T23:01:50.323

这是 C#，但应该给出这个想法。该函数只是递归地枚举所有控件，您可以随心所欲地使用它们。

```
public static IEnumerable<Control> GetControlsRecursive(Control control)
{
    yield return control;

    foreach (Control directSubcontrol in control.Controls)
    {
        foreach (Control subcontrol in GetControlsRecursive(directSubcontrol))
        {
            yield return subcontrol;
        }
    }
} 
```

用法将是这样的。

```
foreach (Control control in GetControlsRecursive(myForm))
{
    DoStuff(control);
} 
```

解决方案 没有该`yield return`语句在 VB.NET 中不可用。

```
public static IEnumerable<Control> GetControlsRecursive(Control control)
{
    List<Control> controls = new List<Control>() { control };

    foreach (Control subcontrol in control.Controls)
    {
        controls.AddRange(GetControlsRecursive(subcontrol));
    }

    return controls;
} 
```

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2009-05-26T23:20:33.967

```
Private Sub enumerateControls(ByVal controlcontainer As Object)
        Dim basec As Control = controlcontainer
        If basec.HasChildren Then
            For Each itm As Control In basec.Controls
                enumerateControls(itm)
            Next
        End If
        If controlcontainer.tag IsNot Nothing Then
run function to determine control type and function

        End If
    End Sub 
```

# ruby - 使用 gem 而不安装它

> ID：913153
> 
> 赞同：8
> 
> 时间：2009-05-26T22:43:21.733
> 
> 标签：ruby, rubygems

我需要运行我在没有 sudo 访问权限的服务器上编写的一堆 ruby​​ 脚本。
在我自己的机器上，我使用'sudo gem install ..'安装了一堆gem并在我的代码中使用它们。
有没有什么机制可以让我使用这些gem而不在远程机器上正式安装它们？

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2009-05-26T23:57:10.960

你可以，但这很棘手。

首先，使用`--install-dir`选项安装它们，即：

```
gem install gem_name --install-dir /some/directory/you/can/write/to 
```

其次，确保您`.gemrc`的主目录中有一个类似于以下内容的文件：

```
gemhome: /some/directory/you/can/write/to
gempath:
 - /some/directory/you/can/write/to
 - /usr/local/lib/ruby/gems/1.8 
```

`gemhome`是寻找宝石时应该首先寻找宝石的地方。`gempath`是它在寻找宝石时应该检查的所有路径。所以在`.gemrc`上面，我告诉我的代码首先在本地目录中查找，如果没有找到，请检查系统 gem 目录。

第三，请注意某些代码——甚至是 gem 中的代码——可以对 gem 的位置做出假设。某些代码可能会以编程方式更改`gempath`或`gemhome`. 您可能需要在自己的代码中“改回”。

关于如何做到这一点的文档并不多（阅读：没有） - 弄清楚它的最佳方法是阅读 RubyGems 源代码中包含的测试。以下是我如何在 rake 任务中破解 gem 路径以指向我的 capistrano 冻结版本：

```
 Gem.use_paths(Gem.dir, ["#{RAILS_ROOT}/vendor/gems"])
  Gem.refresh # picks up path changes 
```

# silverlight-3.0 - 在 Silverlight 3 中使用元素到元素绑定？

> ID：913159
> 
> 赞同：0
> 
> 时间：2009-05-26T22:46:41.977
> 
> 标签：silverlight-3.0, mvvm

如果使用 MVVM，我真的不认为 Silverlight 3 中需要元素到元素的绑定。拥有一个属性不会直接影响另一个适当的原因导致该属性不可测试吗？

对我来说，对 ViewModel 中定义的显式属性进行双向绑定更有意义。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2009-05-27T00:09:03.370

我同意 MVVM 的使用严重削弱了元素到元素绑定的有用性。

尽管如此，如果您所做的只是使用 ViewModel 属性绑定两个元素……您可以测试什么？您可以测试在 ViewModel 中设置属性会发送一个 PropertyChanged 事件......但仅此而已。只有当其他人关心该值时，测试这样的属性才有用。

在简单的情况下，我可以看到 element2element 绑定更有效且代码更少。

# .net - 在 Vista Home Premium 上开发 .NET 我会失去什么

> ID：913169
> 
> 赞同：3
> 
> 时间：2009-05-26T22:50:04.730
> 
> 标签：.net, windows-vista, operating-system

我最近购买了一台笔记本电脑来做一些异地开发，以及我自己在通勤期间的一些工作。

我习惯在 XP 上开发，但笔记本电脑捆绑了 Vista Home Premium 版本（不幸的是，我对此没有发言权）。我尝试在其上安装 XP，但由于 XP 安装未附带 SATA 驱动程序而失败。

我知道您可以使用 nlite 创建 XP 安装程序的“滑流”版本，并且可能会这样做，尽管根据我的研究，这对许多人来说是个问题，缺少驱动程序，蓝屏等。

我正在尝试决定是否采用此选项，或者只是接受我的 Vista 安装，所以我想了解我将在开发方式中失去什么，例如 IIS 限制（Cassini 是可以接受的替代品吗？）。如果有的话，我会限制使用什么版本的 SQL。在 .NET 开发方面，我还应该注意什么，或者，对于我的需要，家庭高级版不是一个有效的选择吗？

**编辑**

要回答为什么我想回到 XP 安装，我猜是负面的 Vista 新闻，以及我对操作系统名称中的“Home”这个词的天生势利:)。

不过，如果我不是作为一名开发人员步履蹒跚的话，我很乐意继续坚持下去，因为我宁愿用我所拥有的东西来破解，也不愿忍受试图从当前良好的 XP 中破解工作的痛苦系统。

感谢您的回答，非常高兴听到更多信息

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2009-05-26T22:55:03.723

我在这个操作系统上进行开发，并且在 .NET 堆栈、Visual Studio、MS Sql 2005/2008 的任何部分以及与 PHP/Apache/MySql 工作的 LAMP 堆栈的部分混合方面总共遇到了零问题。

唯一的抱怨是我正在运行 IIS7，并且我在使用 Ajax 和使用 WebForms 应用程序的 [WebMethod] 技术时遇到了某些 IIS6 HTTP post 怪异。所需要的只是一些研究和 web.config 更改。

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2009-05-27T09:40:31.830

假设您是 .NET 2.0（或更高版本）开发人员，我认为您在 Vista Home Premium 上工作不会有任何损失。

安装 Visual Studio 2005（或更高版本），一切顺利。如果您是 Web 开发人员 Cassini 应该没问题，但如果您真的需要 IIS，可以根据这篇[TechNet 文章](http://technet.microsoft.com/en-us/library/cc732624.aspx)将它安装在 Home Premium 上：

> “您可以在 Windows Vista® Home Premium、Windows Vista® Business、Windows Vista® Ultimate 或 Windows Server® 2008 上安装 IIS 7”

我还想为[Web Platform Installer](http://www.microsoft.com/web/downloads/platform.aspx)提供支持。它使设置您的机器以开发各种应用程序（包括基于 PHP 的应用程序）变得非常容易。

是的，Vista 有一个耻辱（在我看来这是不公平的，但我有偏见），但你不应该在给它一个裂缝之前就将它排除在外。有些事情会有所不同（UAC、界面等），但您可以根据需要进行调整和关闭，以适应新环境。

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2009-05-26T22:56:04.453

这是一个完美的开发平台。它有 IIS。您可以毫无问题地设置 SQL Server 2005 SP2 和 SQL Server 2008。我看不出它不比 XP 好。

* * *

## 回答 #4

> 赞同：2
> 
> 时间：2009-05-27T09:48:19.913

我必须同意这种观点，你绝对不会放弃任何与 Vista 相关的东西，在我看来恰恰相反。

不确定Vista的负面新闻是什么，我认为工作流程的转变是人们遇到的问题，虽然pre sp1有一些问题，比如通过网络复制文件需要很长时间，但这些问题很久以前就已经解决了。

此外，Vista 中的 IIS7 比 XP 中的 IIS5（XP x64 中为 6）的限制要少得多，例如，您可以拥有多个网站，并且还可以获得集成管道。

它在很多方面都是一个更现代的系统，很遗憾它没有被更广泛地采用（我上次查看时为 30%），但我怀疑经济也与采用率有关。

* * *

## 回答 #5

> 赞同：2
> 
> 时间：2009-05-27T11:27:17.933

自从 Vista 处于测试阶段以来，我一直将 Vista 用于 .NET 开发，而且我从来没有遇到任何问题。现在我已经升级到 Windows 7 并且哇 Win7 踢屁股。如果您要设置一个新环境，请跳过 Vista 并直接进入 Win7。你会很开心。

* * *

## 回答 #6

> 赞同：2
> 
> 时间：2009-05-28T16:09:50.517

我发现了 Home Premium 的一个小问题，但我还没有找到解决方案。它似乎没有用于将用户分组和创建组的 UI。我正在尝试使用 SQL Server Reporting Services，它似乎需要其初始管理员用户位于“BUILTIN\Administrators”组中。即使我是管理用户，我也不被视为属于该组。

我可能会尝试编写一个程序来弥补 UI 的不足，但据我所知，没有“用户和组”插件。

* * *

## 回答 #7

> 赞同：1
> 
> 时间：2009-05-27T11:32:52.867

在 Vista 中开发可能不是一件坏事。这是微软在安全方面的发展方向。Win 7 确实是去掉了烦人的东西的 Vista。事情是 Vista II，IIS 7 有一些不同的锁定，所以可能会有一些令人头疼的问题。否则你在 vista/Win 7 环境中什么都不会丢失。

* * *

## 回答 #8

> 赞同：1
> 
> 时间：2009-05-31T10:46:58.303

实际上，我认为如果继续使用 XP，您会损失很多。

Vista 引入了诸如 UAC 之类的功能，这些功能也进入了 Windows 7。如果您仍然使用 XP，那么您将迟到。

此时，如果你真的期待 Windows 7 发布，我建议你使用公开可用的 Windows 7 RC。我已经使用了好几个星期了，真的很享受其中的乐趣。

* * *

## 回答 #9

> 赞同：1
> 
> 时间：2009-05-31T10:54:12.453

你有多少内存？您可以随时在虚拟机中运行 XP（或您的选择）——如果免费的话，VMware Player（您可以通过[EasyVMX](http://www.easyvmx.com/)创建机器）。然后，您可以随身携带您的开发机器（如果您愿意，甚至可以放在（大）记忆棒上）。

这种方法还可以让您开发全*系列*的平台——需要在 Win2003 Server 上开发一些东西吗？没问题。但是 MSDN 订阅（用于操作系统许可证）会有所帮助；-p

* * *

## 回答 #10

> 赞同：0
> 
> 时间：2009-05-26T23:02:23.460

我不明白你为什么害怕离开 XP。自 SP1 以来，Vista（1 个家庭高级版，1 个终极版）要好得多。我在工作和家里都在 Vista x64 机器上进行开发，最近开始使用 win7。我还没有遇到过 VS、Adobe cs3/cs4、MsSQL、php、MySQL 和其他所有问题。

一件事我不相信你可以在 vista 上回到 IIS6 或 IE6。

* * *

## 回答 #11

> 赞同：0
> 
> 时间：2009-05-27T06:01:37.120

没有理由不只是坚持使用 Vista。Vista GUI 的一部分是使用 .NET 框架创建的，因此与 .NET 的集成（如果有任何区别的话）对 Vista 用户有利。大多数负面新闻都与可能在 Vista 下无法工作的驱动程序有关。毫不奇怪，因为他们基本上已经重新设计了驱动程序策略。

自从 Vista 发布以来，我一直在并行研究 XP 和 Vista，在体验上没有明显差异，并且在解决了我一开始遇到的驱动器问题之后，我更喜欢 Vista。

# iphone - 当我在没有动画的情况下推动多个控制器时布局搞砸了

> ID：913171
> 
> 赞同：3
> 
> 时间：2009-05-26T22:50:20.737
> 
> 标签：iphone, cocoa-touch

所以我有一个由三个 UITableViewController 组成的堆栈，当我手动点击 UI 时，每个都在导航栏下方正确显示其视图。

但是，现在我正在努力在应用程序重新启动时恢复状态，因此我将相同的两个控制器推送到根视图控制器的顶部，一次一个，在主线程中以相同的方法。最终发生的事情是中间控制器的视图布局太靠下，而顶部控制器的视图太靠上（在导航栏下方）。

相关代码：

```
for (int i = 0; i < [controllerState count]-1; i++) {
    MyViewController* top = (MyViewController*)navigationController.topViewController;
    int key = [[controllerState objectAtIndex:i] integerValue];
    [top restoreNextViewController:key]; // this calls pushViewController: 
    // so top will be different in the next iteration
} 
```

我怀疑问题在于我不允许在两次推送之间发生一些重要的 UI 刷新过程，因为它们发生在同一个线程中。看起来好像应该影响顶部控制器的自动视图调整反而影响了中间控制器。

是对的吗？如果是这样，我应该怎么做，因为我确实希望在应用程序启动后立即进行所有状态恢复？

编辑：看起来我不清楚。`restoreNextViewController:`是一个 MyViewController 子类方法，它根据存储的键恢复控制器的状态，然后使用`[self.navigationController pushViewController:foo animated:NO]`. 我这样做是因为我的实际应用程序与这个简化的案例不同，堆栈中有多达 6 个控制器，而且它们并不总是相同的。所以我认为这将是一个更简洁的设计，而不是沿着堆栈检查控制器的类。每个控制器已经知道如何推送子控制器以响应用户输入；为什么不在应用重启时重用它？

让控制器出现我没有任何问题；他们只是被奇怪地布置了。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-06-07T13:10:29.737

您是否考虑过让每个视图控制器在 期间推送它的孩子`viewWillAppear:`？我只需`isRestoringState`在您的 appDelegate 中设置一个属性并检查是否在 期间`viewWillAppear:`，如果已设置，则为该视图运行您的恢复，包括推送任何可见的子视图。就像是：

```
- (void)viewWillAppear:(BOOL)animated {
    if ([[UIApplication sharedApplication] isRestoringState]) {
        // restore local state, set myChildController if a child is visible
        if (myChildController) {
            [self.navigationController pushViewController:myChildController animated:NO];
        }
    }
} 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-05-27T04:10:30.213

您可以多次调用 pushViewController:animated:。请张贴代码`-restoreNextViewController`。令人困惑的是，为什么这段代码如此复杂。您是否阅读过 View Controller Guide 中有关[创建导航控制器](http://developer.apple.com/iphone/library/featuredarticles/ViewControllerPGforiPhoneOS/UsingNavigationControllers/UsingNavigationControllers.html#//apple_ref/doc/uid/TP40007457-CH7-SW16)的部分？它们涵盖了在启动时将视图控制器推送到堆栈上。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-05-27T05:58:17.093

我同意 Rob 的观点，我会考虑在加载应用程序时实现 UINavigationController。然后，您将按您希望它们分层的顺序将每个控制器推送到 UINavigtionController 上。

```
- (void)pushViewController:(UIViewController *)viewController animated:(BOOL)animated 
```

因此，如果您知道要将应用程序返回到什么状态，您可以在稍后的系列中加载适当的 ViewController 并将它们推送到 NavigationController 上。

```
UIViewController *myViewController = [[UIViewController alloc] initWithNibName:@"myView" bundle:nil];
[navigationController pushViewController:myViewController animated:NO]; 
```

然后，如果您想“弹出”回 UIViewController，用户可以免费按下导航栏上的“返回”按钮。或者你可以控制导航

```
- (UIViewController *)popViewControllerAnimated:(BOOL)animated

eg [[self navigationController] popViewControllerAnimated:NO]; 
```

如果您想自己控制推送/弹出，您还可以控制是否要显示 NavigationBar。我希望我已经很好地解释了这一点，我自己最近刚刚走过这条路。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2009-05-28T15:12:26.217

我最终在其控制器的`viewWillAppear:`.

# css - 带有淡入淡出效果的身体背景图像变化 mootools

> ID：913173
> 
> 赞同：1
> 
> 时间：2009-05-26T22:50:36.523
> 
> 标签：css, mootools

我正在使用 Mootools 更改我的背景图像 css 属性：

**$(document.body).setStyle('background-image','url(' + pBackground + ')');**

*这是它的工作原理，但是如何在图片变化之间产生一种淡化效果呢？*

谢谢，佩德罗

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2009-05-26T23:10:42.660

您不能专门淡化背景......您必须淡化具有背景的元素。

对于您的情况，我建议使用`<div>`包含`<body>`HTML 中所有内容的 a，即：

```
<html>
<body>
<div id="main">

</div>
</body> 
```

然后，您可以设置 #main div 的 background-image 属性，并执行以下操作：

```
function backgroundChange(pBackground)
{
    var m = $('main');
    var fx = new Fx.Tween(m,{
        duration: 1500,
        onComplete: function(){ 
            m.setStyle('background-image','url(' + pBackground + ')');
            m.fade('in');
        }
    });
    fx.start('opacity',1,0);
} 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-05-28T11:44:43.220

提醒一下，该 div 的任何子元素也会褪色，因此如果您希望背景褪色而其上的元素保持不透明，则需要绝对定位任何子元素。

当您有可变长度的内容时，绝对定位所有元素会带来其他问题，但也有解决方法。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-05-26T22:56:17.323

不知道我在说什么，但是因为它不是 html 文档的一部分，所以它不是一个“元素”，所以 javascript 不应该能够处理它。

但是，这只是一个想法，并且根据您网站的外观，您可以尝试设置不透明度，以模拟身体上的不透明度，这可能会导致您想要的效果..

# php - 为不同的浏览器创建不同的 Web 文件

> ID：913187
> 
> 赞同：1
> 
> 时间：2009-05-26T22:55:56.250
> 
> 标签：php, html, css, browser, compatibility

我突然想到，在过去的十年里，所有关于 HTML/CSS 的书籍总是谈论浏览器不兼容以及如何通过向 CSS、JS 或 HTML 添加更多“hacks”来解决这个问题。为什么他们从未建议过另一种解决方法（我相信最好的方法）是在 html 文件的第一行添加代码（php、c 等），检测正在使用的浏览器然后添加为该浏览器提供适当的 CSS/JS 文件？

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2009-05-26T23:06:44.167

过去，您会在 JavaScript 中添加 hack 来确定客户端正在使用哪个浏览器并基于此运行代码。似乎没有确定的最佳方法，所以每本书都有自己的实现。

您会在很多旧书中找到用于确定浏览器的代码，然后在整个代码中您会看到如下内容：

```
if (NS4) {

} elseif (IE) {

} 
```

但现在基本上已经过时了。

我们现在拥有的另一件大事是像 JQuery 这样的框架，它希望抽象出一些仍然存在的现有不兼容性。在我看来，过去人们只会推出自己风格的 JQuery-esq 框架，所以没有一个统一的框架被更大的社区接受。

我最喜欢的关于用户代理字符串的引用之一是随 Chrome 一起发布的：

> “因此 Chrome 使用 WebKit，并且伪装成 Safari，WebKit 伪装成 KHTML，KHTML 伪装成 Gecko，所有的浏览器都伪装成 Mozilla，Chrome 将自己称为 Mozilla/5.0（Windows；U；Windows NT 5.1 ; en-US) AppleWebKit/525.13 (KHTML, like Gecko) Chrome/0.2.149.27 Safari/525.13，用户代理字符串完全一团糟，几乎没用，每个人都假装成其他人，混乱比比皆是。”

这是一部很好的喜剧读物 - [http://webaim.org/blog/user-agent-string-history/](http://webaim.org/blog/user-agent-string-history/)

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2009-05-26T22:59:06.960

这是因为服务器/客户端的划分。无法从服务器上运行的代码中检测客户端设置。

HTML 中有条件注释，如果您愿意，可以加载备用 CSS 或 Javascript 文件。

[关于条件注释的快速参考](http://www.quirksmode.org/css/condcom.html)

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2009-05-26T22:59:53.417

因为那时你必须维护两组css和js文件。这与向一个文件中添加“hacks”并没有什么不同，只是每次进行更改时都必须对两个文件进行更改。

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2009-05-26T23:13:09.007

如果您使用纯粹的浏览器检测，则每次发布新的浏览器或浏览器版本时，您都需要更新您的列表。这会导致荒谬的情况，例如新版本的用户被告知~~升级~~降级到旧版本。

浏览器不一致应通过功能测试来处理。正如其他人所提到的，有像 JQuery 这样的 JavaScript 框架可以为您处理这个问题。关于 CSS，正如其他人所提到的，使用条件注释来定位旧版本的 Internet Explorer。尽量避免使用“hacks”，因为它们可以在较新的版本中修复，而不会修复您试图解决的问题。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2014-04-15T20:45:10.487

我认为有一个更好的解决方案：

简单的解决方案，只需使用这个 JS 库，您就可以轻松地为每个浏览器/操作系统组合应用样式：

[浏览器类.js](http://browserclass.org/)

这样，您将在 body 标记上获得一个类名，其中包含当前名称和浏览器版本以及使用的操作系统。

包含文件后：

```
<script src="js/browserclass.js"></script> 
```

例如，在带有最新 chrome 的 Windows 8.1 上，您将看到：

```
<body class="chrome chrome34 win desktop"> 
```

在您的样式文件中，您可以参考：（.sass 样式）

```
body.chrome
  #example
    color: blue 
```

或者

```
body.win.chrome
  #example
    color: red 
```

笔记：

[if IE] 语句自 IE10 以来已弃用，因此这是解决方案

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2009-05-26T23:02:25.253

为了进一步说明 Matthew Vines 所说的，条件注释看起来有点像这样......

```
<!--[if lte IE 6]><link href="LayoutIE6.css" type="text/css" rel="stylesheet" /><![endif]-->
<!--[if gte IE 7]><link href="LayoutIE7.css" type="text/css" rel="stylesheet" /><![endif]-->
<!--[if !IE]><link href="Layout.css" type="text/css" rel="stylesheet" /><![endif]--> 
```

希望这可以帮助 ：）

* * *

## 回答 #7

> 赞同：0
> 
> 时间：2009-05-26T23:04:59.193

这是因为（在大多数情况下，甚至“传统上”）CSS 黑客是/由前端开发人员实现的，他们并不总是可以访问后端脚本。如果早期 Web 开发是由后端开发人员推动的，我经常认为情况会大不相同。

顺便说一句，我认为这根本不是一个坏问题（最初由于某种原因被否决）。而且，为了记录，CSS 的条件注释和像 jQuery 这样的稳定​​ JS 框架绝对是要走的路。

# javascript - 获取包含 iframe 的 div

> ID：913192
> 
> 赞同：0
> 
> 时间：2009-05-26T22:58:27.537
> 
> 标签：javascript, iframe

我有这个结构：

```
<div id="source1">
    <iframe src="foo.html"></iframe>
</div>
<div id="source2">
    <iframe src="foo.html"></iframe>
</div> 
```

如果我在 foo.html 中有一些 js 代码，有没有办法告诉它在哪个 div 中（不向 iframe 代码添加参数）？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-05-26T23:19:49.680

从 foo.html，你可以得到父窗口`parent`；到达那里后，您可以将每个 iframe 的`contentWindow`属性与`this`- 匹配的是您。

在父级中搜索所有 iframe 是其中最难的部分；使用 jQuery 之类的库可以很容易地快速编写，但这里有一些东西可以快速组合在一起：

```
var mycontainer;
var iframes = document.getElementsByTagName("iframe");
for (var iter = 0; iter <iframes.length; iter++){
    if( iframes[iter].contentWindow && iframes[iter].contentWindow === window){
        mycontainer = iframes[iter].parentNode;
    }
} 
```

# fitnesse - Fitnesse Suite 无法执行测试

> ID：913196
> 
> 赞同：0
> 
> 时间：2009-05-26T22:59:59.673
> 
> 标签：fitnesse

我正在尝试运行一套 Fitnesse 测试，但是我不断收到以下错误消息。

测试中断，结果不完整。测试页：0 正确，0 错误，0 忽略，0 异常断言：0 正确，0 错误，0 忽略，0 异常

这两个页面本身运行良好，但是当链接包含在套件页面上时，它们似乎没有被检测到。

有没有人遇到过这个？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-05-30T19:43:37.850

当您将一个页面包含到另一个页面中时，仅包含该页面的文本，而不包含属性。标记为套件的页面不会作为测试执行，除非它们也标记为测试。如果您使用 Test 属性标记您的套件页面，那么您包含的测试可能会运行（尽管这在很大程度上取决于这些测试页面中的内容！）

我还猜测您“链接”到测试中的两个页面不在套件页面下方（即 SuitePage.TestPageOne；也称为子 wiki），而是位于 wiki 的其他位置（即 SomeOtherPage.TestPageOne）。如果是这种情况，您可能还想移动您的测试页面，以便它们直接位于您的套件页面下方。这就是所谓的子维基。 [你可以在这里找到更多关于它们的信息](http://www.fitnesse.org/FitNesse.UserGuide.SubWiki)。

希望有帮助

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2010-08-02T21:15:02.700

另一种可能性是页面属性上的“修剪”复选框已被选中。它具有非常相似的影响。prune 旨在允许关闭套件的某些部分，以免运行。

有趣的是，如果直接运行，prune 对子树或节点没有影响。

# c# - 托管堆是否不能扩展到多核系统

> ID：913199
> 
> 赞同：4
> 
> 时间：2009-05-26T23:00:48.297
> 
> 标签：c#, .net

我在我编写的多线程应用程序中看到了一些奇怪的行为，它不能很好地跨多个内核扩展。

以下代码说明了我看到的行为。看起来堆密集型操作并没有跨多个内核扩展，而是它们似乎变慢了。即使用单个线程会更快。

```
class Program
{
   public static Data _threadOneData = new Data();
   public static Data _threadTwoData = new Data();
   public static Data _threadThreeData = new Data();
   public static Data _threadFourData = new Data();

   static void Main(string[] args)
   {
      // Do heap intensive tests
      var start = DateTime.Now;
      RunOneThread(WorkerUsingHeap);
      var finish = DateTime.Now;
      var timeLapse = finish - start;
      Console.WriteLine("One thread using heap: " + timeLapse);

      start = DateTime.Now;
      RunFourThreads(WorkerUsingHeap);
      finish = DateTime.Now;
      timeLapse = finish - start;
      Console.WriteLine("Four threads using heap: " + timeLapse);

      // Do stack intensive tests
      start = DateTime.Now;
      RunOneThread(WorkerUsingStack);
      finish = DateTime.Now;
      timeLapse = finish - start;
      Console.WriteLine("One thread using stack: " + timeLapse);

      start = DateTime.Now;
      RunFourThreads(WorkerUsingStack);
      finish = DateTime.Now;
      timeLapse = finish - start;
      Console.WriteLine("Four threads using stack: " + timeLapse);

      Console.ReadLine();
   }

   public static void RunOneThread(ParameterizedThreadStart worker)
   {
      var threadOne = new Thread(worker);
      threadOne.Start(_threadOneData);

      threadOne.Join();
   }

   public static void RunFourThreads(ParameterizedThreadStart worker)
   {
      var threadOne = new Thread(worker);
      threadOne.Start(_threadOneData);

      var threadTwo = new Thread(worker);
      threadTwo.Start(_threadTwoData);

      var threadThree = new Thread(worker);
      threadThree.Start(_threadThreeData);

      var threadFour = new Thread(worker);
      threadFour.Start(_threadFourData);

      threadOne.Join();
      threadTwo.Join();
      threadThree.Join();
      threadFour.Join();
   }

   static void WorkerUsingHeap(object state)
   {
      var data = state as Data;
      for (int count = 0; count < 100000000; count++)
      {
         var property = data.Property;
         data.Property = property + 1;
      }
   }

   static void WorkerUsingStack(object state)
   {
      var data = state as Data;
      double dataOnStack = data.Property;
      for (int count = 0; count < 100000000; count++)
      {
         dataOnStack++;
      }
      data.Property = dataOnStack;
   }

   public class Data
   {
      public double Property
      {
         get;
         set;
      }
   }
} 
```

此代码在 Core 2 Quad（4 核系统）上运行，结果如下：

一个使用堆的线程：00:00:01.8125000

使用堆的四个线程：00:00:17.7500000

一个线程使用堆栈：00:00:00.3437500

四个线程使用堆栈：00:00:00.3750000

因此，使用具有四个线程的堆完成了 4 倍的工作，但花费了将近 10 倍的时间。这意味着在这种情况下只使用一个线程会快两倍？？？？？？

使用堆栈比预期的要多得多。

我想知道这里发生了什么。一次只能从一个线程写入堆吗？

* * *

## 回答 #1

> 赞同：13
> 
> 时间：2009-05-26T23:34:04.657

答案很简单——在 Visual Studio 之外运行...

我刚刚复制了你的整个程序，并在我的四核系统上运行它。

内部 VS（发布版本）：

```
One thread using heap: 00:00:03.2206779
Four threads using heap: 00:00:23.1476850
One thread using stack: 00:00:00.3779622
Four threads using stack: 00:00:00.5219478 
```

VS外部（发布版本）：

```
One thread using heap: 00:00:00.3899610
Four threads using heap: 00:00:00.4689531
One thread using stack: 00:00:00.1359864
Four threads using stack: 00:00:00.1409859 
```

注意区别。在 VS 之外构建的额外时间几乎都是由于启动线程的开销。在这种情况下，您的工作太小而无法真正进行测试，而且您没有使用高性能计数器，因此这不是一个完美的测试。

主要的经验法则 - 总是表现出色。在 VS 之外进行测试，即：使用 Ctrl+F5 而不是 F5 运行。

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2009-05-27T01:22:37.153

除了 debug-vs-release 效果之外，您还应该注意一些事情。

***您无法在 0.3 秒内有效评估多线程代码的性能。***

线程的意义有两个：在代码中有效地模拟并行工作，并有效地利用并行资源（CPU、内核）。

您正在尝试评估后者。鉴于与您计时的时间间隔相比，线程启动开销并非微不足道，因此您的测量结果立即令人怀疑。在大多数性能测试试验中，适当的预热间隔是合适的。这对你来说可能听起来很傻——它毕竟是一个计算机程序，而不是割草机。但是如果你真的要评估多线程性能，预热是绝对必要的。缓存被填满，管道被填满，池被填满，GC 代被填满。稳态、连续性能是您想要评估的。出于本练习的目的，该程序的行为类似于割草机。

你可以说——*嗯，不，我不想评估稳态性能。* 如果是这样的话，那么我会说你的场景非常专业。大多数应用场景，无论其设计者是否明确意识到，都需要持续、稳定的性能。

如果您确实需要仅在单个 0.3 秒间隔内表现良好，那么您已经找到了答案。但请注意不要将结果一概而论。

如果您想要一般结果，则需要有相当长的预热间隔和更长的收集间隔。对于这些阶段，您可能从 20 秒/60 秒开始，但关键是：您需要改变这些间隔，直到您发现结果收敛。YMMV。显然，有效时间取决于应用程序工作负载和专用于它的资源。您可能会发现收敛需要 120 秒的测量间隔，或者您可能会发现 40 秒就可以了。但是（a）你不会知道，直到你测量它，并且（b）你可以打赌 0.3s 不够长。

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2009-05-26T23:24:07.300

[编辑]事实证明，这是一个发布与调试构建问题——不知道为什么会这样，但确实如此。查看评论和其他答案。[/编辑]

这很有趣——我没想到会有这么大的不同。（此处类似的测试机——Core 2 Quad Q9300）

这是一个有趣的比较——在“数据”类中添加一个大小合适的附加元素——我将其更改为：

```
public class Data
{
    public double Property { get; set; }
    public byte[] Spacer = new byte[8096];
} 
```

它仍然不完全相同，但非常接近（在我的机器上运行 10 倍，结果为 13.1 秒与 17.6 秒）。

如果我不得不猜测，我推测它与跨核缓存一致性有关，至少如果我记得 CPU 缓存是如何工作的。对于小版本的“数据”，如果单个缓存行包含多个数据实例，则内核必须不断地使彼此的缓存无效（最坏的情况是它们都在同一缓存行上）。添加了“间隔”后，它们的内存地址相距足够远，以至于一个 CPU 对给定地址的写入不会使其他 CPU 的缓存无效。

另一件需要注意的事情——4 个线程几乎同时启动，但它们不会同时完成——另一个迹象表明这里存在跨核心问题。另外，我猜想在不同架构的多 CPU 机器上运行会带来更多有趣的问题。

我想从中得到的教训是，在高度并发的场景中，如果您正在使用一些小型数据结构进行大量工作，您应该尝试确保它们在内存中不会全部堆叠在一起. 当然，真的没有办法确保这一点，但我猜有一些技术（比如添加垫片）可以用来尝试实现这一点。

[编辑] 这太有趣了——我爱不释手。为了进一步测试这一点，我想我会尝试使用不同大小的垫片，并使用整数而不是双精度来保持对象更小而无需添加任何垫片。

```
class Program
{
    static void Main(string[] args)
    {
        Console.WriteLine("name\t1 thread\t4 threads");
        RunTest("no spacer", WorkerUsingHeap, () => new Data());

        var values = new int[] { -1, 0, 4, 8, 12, 16, 20 };
        foreach (var sv in values)
        {
            var v = sv;
            RunTest(string.Format(v == -1 ? "null spacer" : "{0}B spacer", v), WorkerUsingHeap, () => new DataWithSpacer(v));
        }

        Console.ReadLine();
    }

    public static void RunTest(string name, ParameterizedThreadStart worker, Func<object> fo)
    {
        var start = DateTime.UtcNow;
        RunOneThread(worker, fo);
        var middle = DateTime.UtcNow;
        RunFourThreads(worker, fo);
        var end = DateTime.UtcNow;

        Console.WriteLine("{0}\t{1}\t{2}", name, middle-start, end-middle);
    }

    public static void RunOneThread(ParameterizedThreadStart worker, Func<object> fo)
    {
        var data = fo();
        var threadOne = new Thread(worker);
        threadOne.Start(data);

        threadOne.Join();
    }

    public static void RunFourThreads(ParameterizedThreadStart worker, Func<object> fo)
    {
        var data1 = fo();
        var data2 = fo();
        var data3 = fo();
        var data4 = fo();

        var threadOne = new Thread(worker);
        threadOne.Start(data1);

        var threadTwo = new Thread(worker);
        threadTwo.Start(data2);

        var threadThree = new Thread(worker);
        threadThree.Start(data3);

        var threadFour = new Thread(worker);
        threadFour.Start(data4);

        threadOne.Join();
        threadTwo.Join();
        threadThree.Join();
        threadFour.Join();
    }

    static void WorkerUsingHeap(object state)
    {
        var data = state as Data;
        for (int count = 0; count < 500000000; count++)
        {
            var property = data.Property;
            data.Property = property + 1;
        }
    }

    public class Data
    {
        public int Property { get; set; }
    }
    public class DataWithSpacer : Data
    {
        public DataWithSpacer(int size) { Spacer = size == 0 ? null : new byte[size]; }
        public byte[] Spacer;
    }
} 
```

结果：

1 线程与 4 线程

*   无间隔 00:00:06.3480000 00:00:42.6260000
*   零间隔 00:00:06.2300000 00:00:36.4030000
*   0B 间隔 00:00:06.1920000 00:00:19.8460000
*   4B 间隔 00:00:06.1870000 00:00:07.4150000
*   8B 间隔 00:00:06.3750000 00:00:07.1260000
*   12B 垫片 00:00:06.3420000 00:00:07.6930000
*   16B 垫片 00:00:06.2250000 00:00:07.5530000
*   20B 垫片 00:00:06.2170000 00:00:07.3670000

无垫片 = 1/6 速度，零垫片 = 1/5 速度，0B 垫片 = 1/3 速度，4B 垫片 = 全速。

我不知道 CLR 如何分配或对齐对象的全部细节，所以我无法谈论这些分配模式在实际内存中的样子，但这些肯定是一些有趣的结果。

# .net - 使用 DeflateStream 时可以使用更少的内存吗？

> ID：913202
> 
> 赞同：1
> 
> 时间：2009-05-26T23:01:56.080
> 
> 标签：.net, memory, deflatestream

我的应用程序需要解压缩包含大量 Deflate 压缩块（以及其他类型的压缩和加密）的文件。内存分析显示，deflate 流构造函数负责在其生命周期内分配应用程序的大部分内存（54.19%，其次是 DeflateStream.read，占 12.96%，其他所有内存都低于 2%）。

换个角度来看，每个文件块通常是 4KiB（解压后），而 DeflateStream 的构造函数分配的空间略大于 32KiB（大概是用于滑动窗口）。垃圾收集器有一个现场日，因为所有这些放气流几乎不会持续任何时间（每个都在下一个到来之前消失）！再见缓存效率。

我可以继续使用 DeflateStream，但我想知道是否有更好的选择。也许是一种重置流并再次使用它的方法？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2009-05-27T02:45:02.103

两条评论没有任何实际测量的好处来支持这一点：

*   我想你会发现这些临时缓冲区的分配（和归零）所花费的时间与实际解压缩所花费的时间相比可以忽略不计。
*   这些缓冲区是高度瞬态的，这意味着尽管在应用程序的生命周期中它可能占内存的 50%，但它们都不会同时存在。请注意，这也不应该对缓存效率造成太大影响……我想这些缓冲区中的大多数在缓存内存中的使用不会超过它们的使用时间，因为页面会很快过时。

简而言之，除非您对 deflate 流有可衡量的问题（无论是在速度还是在绝对内存使用方面），我都会继续使用它......最好使用您知道的解决方案，而不是引入另一个可能有完全不同的解决方案一系列更难处理的问题。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2009-05-27T00:02:43.197

您是否有任何实际的性能问题，或者您只是担心内存使用情况？

大多数对象都是短命的，因此内存管理和垃圾收集器旨在有效地处理短命的对象。框架中的许多类被设计为使用一次然后丢弃以更短的寿命。

如果您尝试挂在对象上，它们更有可能在垃圾收集中幸存下来，这意味着它们将从一个堆代移到另一代。堆生成不仅仅是对象的逻辑划分，而是对象实际上从一个内存区域移动到另一个内存区域。垃圾收集器的工作原理通常是将堆中的所有活动对象移动到下一代，然后清空堆，因此成本高的是长期存在的对象，而不是短期存在的对象。

由于这种设计，内存吞吐量较高而实际内存使用量保持较低是很正常的。

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2009-05-27T02:16:51.040

DotNetZip 中有一个 DeflateStream [，](http://dotnetzip.codeplex.com)有效地替代了 .NET BCL 中的内置 DeflateStream。Ionic.Zlib.DeflateStream 有一个可调的缓冲区大小。我不知道它是否会在您的场景中带来更好的内存效率，但它可能值得一试。 [这是文档](http://cheeso.members.winisp.net/DotNetZipHelp/html/433075df-7d0c-2869-3166-76ee1a2bcd17.htm)。

我没有测试解压，而是压缩。在我的测试中，对于我压缩的数据子集，我发现将缓冲区大小扩展到 4k 以上的回报有限。另一方面，即使缓冲区是 1024 字节，您仍然可以获得准确、正确的压缩，尽管它的效果较差。我想你会在减压中看到类似的结果。

在任何一种情况下，都不能直接从公共界面设置窗口大小。但是，它是开源的，您可以根据需要轻松修改默认的 Wwindow 大小。此外，如果您认为它很有价值，我可以请求将窗口大小公开为 DeflateStream 上的可设置参数。我没有暴露它，因为没有人要求它。然而？

你说你也有其他压缩。如果您使用 Zlib 或 GZip，DotNetZip 包中也有 ZlibStream 和 GZipStream。

如果你想做 Zip 文件，你需要完整的 DotNetZip 库（Ionic.Zip.dll，大约 400k）。如果你只是在做 {Deflate, Zlib, GZip}Stream，那么就有一个 Ionic.Zlib.dll，大约 90k。

DotNetZip 是免费的，但[鼓励捐款](http://cheeso.members.winisp.net/DotNetZipDonate.aspx)。

# python - 是否可以在同一台 PC 上安装 python 3 和 2.6？

> ID：913204
> 
> 赞同：3
> 
> 时间：2009-05-26T23:02:23.363
> 
> 标签：python, python-3.x

我该怎么做？原因是我想尝试一些 pygame，但我目前安装了 python 3 并且一直在学习它。我也有兴趣尝试 wxpython 或类似的东西，但我还没有查看它们的兼容性。

编辑:: 我在 Windows vista 64 位

* * *

## 回答 #1

> 赞同：9
> 
> 时间：2009-05-26T23:06:24.463

如果您使用的是 Windows，则只需使用安装程序安装另一个版本的 Python。它将被安装到另一个目录中。

然后，如果您使用安装程序安装其他软件包，它会询问您要应用哪个 python 安装。如果您使用从源代码安装或 easy_install，则只需确保在安装时使用的是正确版本之一。

如果您在当前的 python-3 中安装了许多软件包，那么只需对当前安装进行 zip 备份以防万一。

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2009-05-26T23:07:25.773

嗯……是的。我刚刚在这台计算机上安装了 Python 3.0 来测试它。您还没有指定您的操作系统，但我正在运行 Ubuntu 9.04，我可以通过键入`python2.5 myscript.py`或来明确指定我想要运行的 Python 版本`python3.0 myscript.py`，具体取决于我的需要。

* * *

## 回答 #3

> 赞同：3
> 
> 时间：2009-05-26T23:07:40.577

通常，python 安装的名称类似于`python2.6`，因此您可以拥有多个。*可能*存在`python`指向其中一个编号文件的符号链接。很实用。

* * *

## 回答 #4

> 赞同：2
> 
> 时间：2009-05-26T23:22:37.863

是的，有可能。

我维护 3 个 python 安装（2.5、2.6、3.0）。唯一可能令人困惑的问题是确定哪个 Python 版本在 PATH 变量（如果有）中具有优先权。要执行特定版本的脚本，您将进入该版本的 python 目录

C:\Python25\、C:\Python26\、C:\Python30\ 等。

将文件放在那里，然后从命令行运行“python.exe file.py”。

您甚至可以将每个 python.exe 重命名为 python25.exe python26.exe python30.exe 并将每个目录都放在 PATH 中，以便在任何版本上执行任何脚本都很容易。

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2009-05-26T23:05:02.063

我假设它与运行两个版本的 2.x 相同；只要他们每个人都在自己的目录中，您就可以了。

* * *

## 回答 #6

> 赞同：1
> 
> 时间：2009-05-26T23:07:14.277

你当然可以。在 Mac Ports 上，有一个名为 python_select 的工具可以让你在 python 版本之间切换；如果在 Windows 上不存在类似的东西（暂时的谷歌搜索没有发现），它当然可以被编写。

* * *

## 回答 #7

> 赞同：0
> 
> 时间：2009-05-26T23:32:41.917

您可以使用[virtualenv](http://pypi.python.org/pypi/virtualenv)设置[虚拟 python 环境](http://dumbotics.com/2009/05/24/virtual-pythonenvironments/)。

# subdomain - 单独的图像服务器（例如 images.mydomain.com）的优缺点？

> ID：913208
> 
> 赞同：11
> 
> 时间：2009-05-26T23:04:07.510
> 
> 标签：subdomain, web-deployment

我们的网站提供了一些图像和 PDF 文档。这些图像和文档存储在源代码管理中，并在部署时复制内容。我们正在考虑创建一个单独的图像服务器来放置我们的库存图像和 PDF 文档——从而显着减少我们部署包的体积。

有没有人有这种方法的经验？

我想知道任何“陷阱”——比如 XSS 问题和/或从备用子域传递内容的浏览器问题？

* * *

## 回答 #1

> 赞同：21
> 
> 时间：2009-05-26T23:56:06.970

临：

许多浏览器只会分配两个套接字来从单个主机下载资产。因此，如果 index.html 是从 www.domain.com 下载的，它引用了 6 个图像文件、3 个 javascript 文件和 3 个 CSS 文件（都在 www.domain.com 上），浏览器将一次下载 2 个，并且其他阻塞，直到套接字空闲。

如果您将 6 个图像文件拉到一个单独的主机上，例如 images.domain.com，您将获得额外的两个专用于下载图像的套接字。这使资产下载过程并行化，因此理论上，您的页面可以呈现两倍的速度。

缺点：

如果您使用 SSL，则需要为 images.domain.com 获取额外的单主机 SSL 证书或为 *.domain.com 获取通配符 SSL 证书（匹配任何子域）。否则将在浏览器中生成警告，指出该页面包含混合的安全和不安全内容。

* * *

## 回答 #2

> 赞同：8
> 
> 时间：2009-05-27T00:02:47.377

您还将使用不同的域，不会在每个请求中发送 cookie 数据。这可以提高性能。

* * *

## 回答 #3

> 赞同：5
> 
> 时间：2009-05-27T02:28:29.533

尚未提及的另一件事是，您可以使用不同的 Web 服务器来提供不同类型的内容。例如，您的静态内容可以通过 lighttpd 或 nginx 提供，同时仍可通过 Apache 提供您的动态内容。

* * *

## 回答 #4

> 赞同：3
> 
> 时间：2009-05-26T23:12:27.010

优点：

-负载均衡

- 隔离不同的功能

缺点：

- 更多工作（当您在主站点上创建页面时，您必须在单独的服务器上维护资源）

XSS 之类的问题是代码没有清理输入（或输出）的问题。唯一可能出现的问题是，如果您有用于身份验证的子域特定 cookie.. 但这确实是一个微不足道的修复。

* * *

## 回答 #5

> 赞同：2
> 
> 时间：2009-05-26T23:41:58.917

如果您使用 HTTPS 并从 HTTP 域提供图像，那么您会在使用它时弹出浏览器安全警报​​警告。

因此，如果您使用 HTTPS，如果您不想惹恼您的用户，您将需要为您的图像域购买 HTTPS :)

还有其他方法可以解决这个问题，但这并不是特别在这个答案的范围内 - 这只是一个警告！

# .net - System.Xml.XmlDocument，缓存外部依赖项 DTD 的最佳方法是什么？

> ID：913214
> 
> 赞同：1
> 
> 时间：2009-05-26T23:05:53.107
> 
> 标签：.net, dtd, xmldocument

我正在将有效的 XHTML 加载到 XmlDocument 中，但加载需要 2 秒。我发现如果我删除 DTD，它是即时的，但是我必须替换   到   等。声明的 HTML 实体的数量很大，所以我觉得应该加载 DTD。那么用最少的人工预加载 DTD 的最简单方法是什么？比如说，如果我可以将 DTD 作为资源文件放入程序集中并将其注入......？有什么建议么？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-05-26T23:42:44.907

我在这里找到了一种技术，通过实现抽象类 XmlResolver 并将其设置为 XmlDocument 的 XmlResolver 属性。抽象类实现为所请求的 URL 返回一个 MemoryStream 对象，该对象包含 DTD 或通常通过 HTTP 加载的任何其他资源。

[http://www.codeproject.com/KB/XML/HTML2XHTML.aspx?display=Print](http://www.codeproject.com/KB/XML/HTML2XHTML.aspx?display=Print)

# c# - 为什么这段代码不能编译？- 对象赋值、调用、递增、递减和new可以作为指令使用

> ID：913215
> 
> 赞同：2
> 
> 时间：2009-05-26T23:05:59.833
> 
> 标签：c#

我正在测试 Visual Studio Express 2008 中的 C# 中的一些代码：

```
delegate void Hm(int k);

static void Main(string[] args)
{
    char[] m = new char[10];

    m[0] = 'H'; m[5] = 'M';
    m[1] = 'o'; m[6] = 'u';
    m[2] = 'l'; m[7] = 'n';
    m[3] = 'a'; m[8] = 'd';
    m[4] = ' '; m[9] = 'o';

    unsafe { fixed (char* p = m) { Hm H = (k) => recurd(k, p); H(0); } }
    Console.ReadLine();
}

static unsafe int recurd(int i, char* p) 
{
      Console.WriteLine(p[i]); 
      if (i == 10) return 0; else return recurd(i + 1, p);    
} 
```

它编译得很好，但是如果我对“recurd”函数做一点改动：

```
static unsafe int recurd(int i, char* p) 
{
      Console.WriteLine(p[i]);
      i == 10 ? 0 : recurd(i + 1, p);
     // if (i == 10) return 0; else return recurd(i + 1, p);    
} 
```

我收到一条错误消息，上面写着“只有对象赋值、调用、递增、递减和 new 的表达式可以用作指令”（这是西班牙语的翻译）。

为什么我会收到此错误？我该如何解决？

* * *

## 回答 #1

> 赞同：12
> 
> 时间：2009-05-26T23:07:36.350

您缺少“return”关键字：

```
return i == 10 ? 0 : recurd(i + 1, p); 
```

* * *

## 回答 #2

> 赞同：9
> 
> 时间：2009-05-26T23:08:30.747

试试这个：

```
static unsafe int recurd(int i, char* p) 
{
      Console.WriteLine(p[i]);
      return i == 10 ? 0 : recurd(i + 1, p);
} 
```

它在抱怨，因为你没有对表达式的结果做任何事情。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2009-05-26T23:10:41.680

这个

```
static unsafe int recurd(int i, char* p) 
{
      Console.WriteLine(p[i]);
      i == 10 ? 0 : recurd(i + 1, p);
     // if (i == 10) return 0; else return recurd(i + 1, p);    
} 
```

不会工作，因为它不返回任何东西。

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2009-05-26T23:10:51.490

应该是： return i == 10 ？0 : 递归(i + 1, p);

你忘了加上你的回报。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2009-05-26T23:07:48.923

```
i = (i == 10) ? 0 : recurd(i + 1, p); 
```

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2009-05-27T01:15:46.387

我试过： i= i == 10 ？返回 0 : 返回递归(i + 1, p);

还有 i == 10 ？返回 0 : 返回递归(i + 1, p);

我得到错误。

但我试过： return i== 10 ？0 : 递归(i + 1, p);

它有效！谢谢乔尔！谢谢乔纳森！

我的错误是认为该值是自动返回的，而“返回”这个词是不必要的。

* * *

## 回答 #7

> 赞同：0
> 
> 时间：2009-05-27T03:34:08.403

我试过： i= i == 10 ？返回 0 : 返回递归(i + 1, p);

还有 i == 10 ？返回 0 : 返回递归(i + 1, p);

我得到错误。

但我试过： return i== 10 ？0 : 递归(i + 1, p);

它有效！谢谢乔尔！谢谢乔纳森！

我的错误是认为该值是自动返回的，而“返回”这个词是不必要的。

# asp.net - jQuery 和 Asp.Net 兼容性

> ID：913227
> 
> 赞同：0
> 
> 时间：2009-05-26T23:07:57.737
> 
> 标签：asp.net, jquery, ajax

我正在尝试使用 jQuery 和 Asp.net Ajax 库。jQuery 代码是可靠的，我让它在一个单独的页面上工作。当我将 jQuery 代码合并到使用 Asp.net Ajax 的现有页面中时，jQuery 代码不起作用。

我认为这与名称修饰有关。

如何阻止 asp.net 进行名称修改或其他任何事情？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-05-26T23:23:29.127

如果您遇到主要的命名问题，请利用 QJuery 将几乎任何东西用作选择器的能力，包括类。当然，类查找不如 id 查找快，但它更不容易被自动生成的代码破坏。

这是一篇很好的文章，详细介绍了[如何在 ASP.NET 中使用 JQuery](http://dotnetslackers.com/articles/ajax/Using-jQuery-with-ASP-NET.aspx)。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-05-26T23:19:27.823

一般来说，这两个框架不会相互干扰。但是，您可能会遇到问题，因为 asp.net ajax 为一些基本类型（如字符串、int 或数据）添加了一堆额外的函数。

但是通常仅使用 jquery 时这不是问题，但是我遇到了一些可能没有编写的插件的问题，所以这可能就是您的问题所在。

话虽如此，如果没有更多信息或/和代码，很难为您提供任何具体帮助。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-05-26T23:51:44.967

也许这两个框架（jQuery 和 ASP.Net AJAX）在定义一些运算符（如 $.

这个[旧论坛帖子](http://forums.asp.net/p/957108/1179734.aspx)是由面临类似情况的人发布的。

# datatable - 我应该 Dispose() DataSet 和 DataTable 吗？

> ID：913228
> 
> 赞同：210
> 
> 时间：2009-05-26T23:08:09.000
> 
> 标签：datatable, dataset, dispose, idisposable, using

DataSet 和 DataTable 都实现了 IDisposable，因此，按照常规的最佳实践，我应该调用它们的 Dispose() 方法。

但是，从我目前所读到的内容来看，DataSet 和 DataTable 实际上没有任何非托管资源，因此 Dispose() 实际上并没有做太多事情。

另外，我不能只使用`using(DataSet myDataSet...)`，因为 DataSet 有一个 DataTables 集合。

因此，为了安全起见，我需要遍历 myDataSet.Tables，处理每个 DataTable，然后处理 DataSet。

那么，在我的所有数据集和数据表上调用 Dispose() 是否值得？

**附录：**

对于那些认为应该处置 DataSet 的人：通常，处置模式是使用`using`or `try..finally`，因为您想保证 Dispose() 将被调用。

然而，这对于一个集合来说变得非常难看。例如，如果对 Dispose() 的调用之一引发异常，您会怎么做？你吞下它（这是“坏的”），以便你可以继续处理下一个元素吗？

或者，您是否建议我只调用 myDataSet.Dispose()，而忘记在 myDataSet.Tables 中处理 DataTables？

* * *

## 回答 #1

> 赞同：158
> 
> 时间：2009-05-26T23:29:07.663

这里有几个讨论解释了为什么 DataSet 不需要 Dispose。

[处置还是不处置？](http://web.archive.org/web/20100724023926/http://www.developerdotstar.com/community/node/247)：

> DataSet 中的 Dispose 方法的存在只是因为继承的副作用——换句话说，它实际上并没有在终结中做任何有用的事情。

[应该对 DataTable 和 DataSet 对象调用 Dispose 吗？](http://web.archive.org/web/20081203232123/http://www.devnewsgroups.net/group/microsoft.public.dotnet.framework.adonet/topic42917.aspx)包括来自 MVP 的一些解释：

> system.data 命名空间 (ADONET) 不包含非托管资源。因此，只要您没有为自己添加一些特殊的东西，就不需要处理任何这些。

[了解 Dispose 方法和数据集？](http://www.velocityreviews.com/forums/t90672-understanding-the-dispose-method-and-datasets.html)有权威斯科特艾伦的评论：

> 在实践中，我们很少 Dispose 数据集，因为它提供的好处很少”

因此，共识**是目前没有充分的理由在 DataSet 上调用 Dispose。**

* * *

## 回答 #2

> 赞同：136
> 
> 时间：2009-10-21T20:47:36.420

**更新（2009 年 12 月 1 日）：**

我想修改这个答案并承认原来的答案是有缺陷的。

最初的分析***确实***适用于需要最终确定的对象——没有准确、深入的理解，不应该在表面上接受实践的观点仍然存在。

然而，事实证明 DataSets、DataViews、DataTables**在它们的构造函数中抑制了终结**——这就是为什么在它们上显式调用 Dispose() 什么都不做的原因。

据推测，这是因为它们没有非托管资源。因此，尽管**MarshalByValueComponent**允许使用非托管资源，但这些特定的实现不需要，因此可以放弃最终确定。

（.NET 作者会注意抑制通常占用最多内存的类型的终结性，这说明了这种做法对于可终结类型的重要性。）

尽管如此，自从 .NET Framework （大约 8 年前）问世以来，这些细节仍然没有得到充分的记录，这非常令人惊讶（您基本上只能依靠自己的设备来筛选相互冲突、模棱两可的材料来将各个部分组合在一起有时令人沮丧，但确实提供了对我们每天所依赖的框架的更完整的理解）。

经过大量阅读，这是我的理解：

如果一个对象需要终结，它占用的内存***可能***比它需要的时间长——原因如下： a) 任何定义析构函数（或从定义析构函数的类型继承）的类型都被认为是可终结的；b) 在分配时（在构造函数运行之前），一个指针被放置在终结队列上；c) 一个可终结的对象通常需要回收**2 个集合**（而不是标准的 1 个）；d) 抑制终结不会从终结队列中删除对象（如 SOS 中的 !FinalizeQueue 所报告的） 此命令具有误导性；知道最终队列中的对象（本身）是没有帮助的；知道什么对象在终结队列上并且仍然需要终结将是有帮助的（有这个命令吗？）

抑制终结会在对象的标头中关闭一点，向运行时指示它不需要调用其终结器（不需要移动 FReachable 队列）；它保留在 Finalization 队列中（并继续由 SOS 中的 !FinalizeQueue 报告）

DataTable、DataSet、DataView 类都植根于 MarshalByValueComponent，这是一个可以（可能）处理非托管资源的可终结对象

*   因为 DataTable、DataSet、DataView 不引入非托管资源，它们在构造函数中抑制了终结
*   虽然这是一种不寻常的模式，但它使调用者不必担心在使用后调用 Dispose
*   这一点，以及 DataTables 可能在不同的 DataSets 之间共享这一事实，可能是 DataSets 不关心处置子 DataTables 的原因
*   这也意味着这些对象会出现在 SOS 中的 !FinalizeQueue 下
*   **但是，这些对象在单次收集后仍应可回收，就像它们的不可终结对象一样**

**4（新参考）：**

*   [http://www.devnewsgroups.net/dotnetframework/t19821-finalize-queue-windbg-sos.aspx](http://www.devnewsgroups.net/dotnetframework/t19821-finalize-queue-windbg-sos.aspx)
*   [http://blogs.msdn.com/tom/archive/2008/04/28/asp-net-tips-looking-at-the-finalization-queue.aspx](http://blogs.msdn.com/tom/archive/2008/04/28/asp-net-tips-looking-at-the-finalization-queue.aspx)
*   [http://issuu.com/arifaat/docs/asp_net_3.5unleashed](http://issuu.com/arifaat/docs/asp_net_3.5unleashed)
*   [http://msdn.microsoft.com/en-us/magazine/bb985013.aspx](http://msdn.microsoft.com/en-us/magazine/bb985013.aspx)
*   [http://blogs.msdn.com/tess/archive/2006/03/27/561715.aspx](http://blogs.msdn.com/tess/archive/2006/03/27/561715.aspx)

**原答案：**

对此有很多误导性且通常非常糟糕的答案 - 任何来到这里的人都应该忽略噪音并仔细阅读下面的参考资料。

毫无疑问，**应该**在任何 Finalizable 对象上调用 Dispose。

数据表**是可**终结的。

调用 Dispose**显着**加快了内存的回收。

**MarshalByValueComponent**在其 Dispose() 中调用**GC.SuppressFinalize(this)** - 跳过这意味着在回收内存之前必须等待数十个（如果不是数百个）Gen0 集合：

> 有了对 finalization 的基本理解，我们已经可以推断出一些非常重要的事情：
> 
> 首先，需要终结的对象比不需要终结的对象寿命更长。事实上，他们可以活得更久。例如，假设需要完成 gen2 中的对象。将安排完成，但对象仍在 gen2 中，因此在下一次 gen2 收集发生之前不会重新收集它。这确实可能是一个很长的时间，事实上，如果事情进展顺利，这将是很长一段时间，因为 gen2 收集成本很高，因此我们希望它们很少发生。需要完成的旧对象可能必须等待数十个甚至数百个 gen0 集合才能回收它们的空间。
> 
> 其次，需要最终确定的对象会造成附带损害。由于内部对象指针必须保持有效，不仅直接需要终结的对象会在内存中徘徊，而且对象直接和间接引用的所有内容也将保留在内存中。如果一棵巨大的对象树由一个需要最终确定的对象锚定，那么整个树将徘徊，可能会像我们刚刚讨论的那样持续很长时间。因此，谨慎使用终结器并将它们放置在具有尽可能少的内部对象指针的对象上是很重要的。在我刚刚给出的树示例中，您可以通过将需要完成的资源移动到单独的对象并在树的根中保留对该对象的引用来轻松避免该问题。
> 
> 最后，需要终结的对象为终结器线程创建工作。如果您的终结过程是一个复杂的过程，那么唯一的终结器线程将花费大量时间执行这些步骤，这可能会导致工作积压，从而导致更多对象等待终结。因此，终结者尽可能少地做工作是至关重要的。还要记住，虽然所有对象指针在终结期间都保持有效，但这些指针可能会指向已经终结的对象，因此可能不太有用。即使指针是有效的，在终结代码中避免跟随对象指针通常是最安全的。安全、简短的最终确定代码路径是最好的。

从在 Gen2 中看到 100 MB 的非引用数据表的人那里得到它：这非常重要，并且完全被这个线程上的答案所忽略。

**参考：**

[1](http://msdn.microsoft.com/en-us/library/ms973837.aspx) - [http://msdn.microsoft.com/en-us/library/ms973837.aspx](http://msdn.microsoft.com/en-us/library/ms973837.aspx)

[2](http://vineetgupta.spaces.live.com/blog/cns!8DE4BDC896BEE1AD!1104.entry) - [http://vineetgupta.spaces.live.com/blog/cns!8DE4BDC896BEE1AD!1104.entry](http://vineetgupta.spaces.live.com/blog/cns!8DE4BDC896BEE1AD!1104.entry) [http://www.dotnetfunda.com/articles/article524-net-best-practice-no-2-improve-garbage -collector-performance-using-finalizedispose-pattern.aspx](http://www.dotnetfunda.com/articles/article524-net-best-practice-no-2-improve-garbage-collector-performance-using-finalizedispose-pattern.aspx)

[3](http://www.dotnetfunda.com/articles/article524-net-best-practice-no-2-improve-garbage-collector-performance-using-finalizedispose-pattern.aspx) - [http://codeidol.com/csharp/net-framework/Inside-the-CLR/Automatic-Memory-Management/](http://codeidol.com/csharp/net-framework/Inside-the-CLR/Automatic-Memory-Management/)

* * *

## 回答 #3

> 赞同：27
> 
> 时间：2009-05-26T23:25:02.960

您应该假设它做了一些有用的事情并调用 Dispose，即使它在当前的 .NET Framework 版本中什么都不做。无法保证它会在未来的版本中保持这种状态，从而导致资源使用效率低下。

* * *

## 回答 #4

> 赞同：18
> 
> 时间：2009-05-27T08:39:05.263

即使一个对象没有非托管资源，disposing 也可能通过破坏对象图来帮助 GC。通常，如果一个对象实现了 IDisposable，则应调用 Dispose()。

Dispose() 是否真的做某事取决于给定的类。对于 DataSet，Dispose() 实现继承自 MarshalByValueComponent。它从容器中移除自己并调用 Disposed 事件。源代码如下（用.NET Reflector反汇编）：

```
protected virtual void Dispose(bool disposing)
{
    if (disposing)
    {
        lock (this)
        {
            if ((this.site != null) && (this.site.Container != null))
            {
                this.site.Container.Remove(this);
            }
            if (this.events != null)
            {
                EventHandler handler = (EventHandler) this.events[EventDisposed];
                if (handler != null)
                {
                    handler(this, EventArgs.Empty);
                }
            }
        }
    }
} 
```

* * *

## 回答 #5

> 赞同：8
> 
> 时间：2009-05-27T08:49:48.627

您自己创建数据表吗？因为通常不需要遍历任何对象的子对象（如在 DataSet.Tables 中），因为处理其所有子成员是父对象的工作。

通常，规则是：如果您创建了它并且它实现了 IDisposable，则 Dispose 它。如果您没有创建它，则不要处置它，这是父对象的工作。但是每个对象可能都有特殊的规则，请查看文档。

对于 .NET 3.5，它明确表示“不再使用时将其丢弃”，这就是我要做的。

* * *

## 回答 #6

> 赞同：7
> 
> 时间：2009-05-26T23:19:21.177

每当对象实现 IDisposeable 时，我都会调用 dispose。它的存在是有原因的。

数据集可能会占用大量内存。越早标记它们进行清理越好。

**更新**

我回答这个问题已经5年了。我还是同意我的回答。如果有一个 dispose 方法，则应该在您处理完对象后调用它。IDispose 接口的实现是有原因的。

* * *

## 回答 #7

> 赞同：5
> 
> 时间：2009-05-26T23:34:55.360

如果您的意图或这个问题的上下文确实是垃圾收集，那么您可以将数据集和数据表显式设置为 null 或使用关键字 using 并让它们超出范围。Dispose 并没有像 Tetraneutron 之前所说的那样做太多事情。GC 将收集不再引用的数据集对象以及超出范围的对象。

我真的希望 SO 迫使人们在拒绝投票之前实际写评论。

* * *

## 回答 #8

> 赞同：1
> 
> 时间：2009-05-26T23:18:25.017

数据集通过实现 IDisposable 的 MarshalByValueComponent 实现 IDisposable。由于数据集是管理的，调用 dispose 并没有真正的好处。

* * *

## 回答 #9

> 赞同：0
> 
> 时间：2013-11-20T16:49:15.097

尝试使用 Clear() 函数。它非常适合我处理。

```
DataTable dt = GetDataSchema();
//populate dt, do whatever...
dt.Clear(); 
```

* * *

## 回答 #10

> 赞同：0
> 
> 时间：2020-09-30T17:31:29.263

这是正确处置`DataTable`.

```
private DataTable CreateSchema_Table()
{
    DataTable td = null;
    try
    {
        td = new DataTable();
        //use table DataTable here

        return td.Copy();
    }
    catch {  }
    finally
    {
        if (td != null)
        {
            td.Constraints.Clear();
            td.Clear();
            td.Dispose();
            td = null;
        }
    }
} 
```

* * *

## 回答 #11

> 赞同：0
> 
> 时间：2018-10-11T12:51:45.930

> 不需要 Dispose() 因为 DataSet 继承 MarshalByValueComponent 类和 MarshalByValueComponent 实现 IDisposable 接口

* * *

## 回答 #12

> 赞同：0
> 
> 时间：2020-09-30T17:40:25.693

这可能是处置和释放`DataSet`.

```
try
    {
        DataSet ds = new DataSet("DS");
        //use table DataTable here

    }
    catch {  }
    finally
    {
        if (ds != null)
                {
                    ds.EnforceConstraints = false;
                    ds.Relations.Clear();
                    int totalCount = ds.Tables.Count;

                    for (int i = totalCount - 1; i >= 0; i--)
                    {
                        DataTable td1 = ds.Tables[i];
                        if (td1 != null)
                        {
                            td1.Constraints.Clear();
                            td1.Clear();
                            td1.Dispose();
                            td1 = null;
                        }
                    }

                    ds.Tables.Clear();
                    ds.Dispose();
                    ds = null;
                }
    } 
```

# css - css 和 div 标签布局问题

> ID：913230
> 
> 赞同：0
> 
> 时间：2009-05-26T23:09:20.370
> 
> 标签：css, html, alignment

我有一个水平跨越我的网页的标题栏，它由一个 div 标签和三个嵌套的 div 标签组成。

HTML：

```
<div id="top-bar">
    <div id="leftTop">
        LEFT
    </div>
    <div id="rightTop">
        RIGHT
    </div>
    <div id="centerTop">
        CENTER
    </div>
</div> 
```

CSS：

```
#top-bar
{
    margin: 0;
    padding: 1px 4px;
    font-size: x-small;
    background-color: #005555;
    font-family: Arial;
}
#top-bar .separator
{
    padding: 0 7px;
    border-right: 0px solid #fff;
    border-left: 0px solid #fff;
}
#leftTop
{
    display: inline;
    float: left;
}
#rightTop
{
    display: inline;
    float: right;
}
#centerTop
{
    color: #ffffff;
    text-align: center;
} 
```

它工作得很好，除了 div 标签在 HTML 代码中乱序，我不喜欢。如果我通过将 div 标签放置在 HTML 中的 Left、Center 和 Right 来排序它们，那么 Right div 就会从网页中消失！我猜它与 float 和 text-align 属性发生冲突有关。

任何人都对这里发生的事情有任何想法，或者在 CSS 中有更简单的方法吗？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-05-26T23:12:43.187

`float: left;`在没有任何花车的情况下试穿`#centerTop`或试穿`display: inline`这三个。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-05-26T23:30:25.010

这工作正常，但这取决于你需要什么。如果您不知道内容的高度并且希望它动态扩展，那么这还不够：

```
 #leftTop
    {
        float: left;
    }
    #rightTop
    {            
        float: right;
    }
    #centerTop
    {
        float:left;
        text-align: center;
    } 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-05-26T23:45:02.313

我刚刚在 Firefox 3.0.10、Opera 9.64、IE8 和 Google Chrome 2.0.181.1 中测试了原始帖子中的代码

所有浏览器都显示了所有 3 个 div，没有一个 div 从屏幕上掉下来……您可能使用的是 IE6 吗？

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2009-05-27T05:09:37.317

浮动后，使用相对定位交换 div 的位置：

**的HTML**

```
<div id="top-bar">
    <div id="leftTop">
        LEFT
    </div>
    <div id="centerTop">
        CENTER
    </div>
    <div id="rightTop">
        RIGHT
    </div>
</div> 
```

**CSS**

```
#leftTop {
   width:33%;
   float:left;
}
#centerTop {
   width:33%;
   float:right;
   position:relative;
   right:33%;
}
#rightTop {
   width:33%;
   float:right;
   position:relative;
   left:33%;
} 
```

我在[Perfect Liquid Layouts](http://matthewjamestaylor.com/blog/perfect-3-column.htm)中使用相同的过程来更改[列源排序](http://matthewjamestaylor.com/blog/equal-height-columns-cross-browser-css-no-hacks)。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2009-05-27T00:12:14.020

我正在运行您的 FF 3.0.10 的 HTML 和 CSS。当您将 CENTERTOP div 重新排列在 LEFTOP 和 RIGHTTOP div 之间时，RIGHTTOP div 不会“脱离页面”，但“RIGHT”文本只会落在下一行。

下面提出了我的解决方案（您会注意到我有一些补充和一些最佳实践技术）。

**HTML 代码：**

```
<html>
<head>
    <link rel="stylesheet" href="global.css">
</head>
<body>
    <div id="top-bar">
        <div id="leftTop">
                LEFT
        </div>
        <div id="centerTop">
            CENTER
        </div>
        <div id="rightTop">
                RIGHT
        </div>
    </div>
    <div class="clearer">
    </div>
    <div id="randomContent">
            RANDOM CONTENT
    </div>
</body> 
```

**代码：**

```
#top-bar {
    margin: 0;
    font-family: Arial;
}

#leftTop {
    float: left;
    width: 20%;
    border: 1px solid red;
}

#centerTop {
    float: left;
    width: 20%;
    border: 1px solid blue;
}

#rightTop {
    border: 1px solid green;
}

.clearer {
    clear: both;
}

#randomContent {
    background-color: yellow;
} 
```

所以你会注意到在 HTML 中 div 是按照从左到中到右的顺序排列的。在这个 CSS 中，这已经通过向左浮动 LEFTTOP 和 CENTRETOP div 反映出来。您还会注意到我在 LEFTTOP 和 CENTERTOP div 上指定了一个 width 属性，以使您能够根据需要将 div 隔开。（当我在 div 的边框中添加时，您将能够直观地看到您的宽度修改）。没有在 RIGHTTOP div 上应用宽度百分比属性，因为它将消耗剩余的 60% 的宽度（在 LEFTTOP 和 CENTRETOP 消耗了 40% 之后）。

我还添加了一个更清晰的 div。想想 CLEARER div 是一个水平换行符。本质上，它充当了一条分界线，将浮动的 div 与下面的内容分开。

然后，您可以在 RANDOMCONTENT div 中添加您想要的任何内容。

希望这可以帮助 ：）

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2009-05-27T04:13:53.573

另一种解决方案：

*   将 leftTop、centerTop 和 rightTop 设置为***display:table-cell***，
*   将顶栏设置为***display:table-row***，
*   设置要***显示的容器：table***
*   将容器和行（#table-bar）的宽度设置为100%；
*   将列的宽度设置为所需的比例（例如，左右 25%，中心 50%）
*   警告：表格、表格行和表格单元格 css 显示值在 IE 5.5 或 6（可能还有 Opera 8）中不起作用；但它们在所有当代浏览器中都能很好地工作。IE 条件可用于拆分 IE > 5 和 IE < 7 的代码。

测试：

```
<html>
<head>
<title>3 Column Header Test</title>
<style type="text/css">
body#abod {
background-color:#F5ECBD;
color:#000;
}
#hdrrow {
margin:0;
padding:0;
width:100%;
border:1px solid #0C5E8D;
display:table;
}
#top-bar {
margin:0;
padding:1px 4px;
width:100%;
font-size:100%;
background-color:orange;/*#005555;*/
font-family: Arial;
border:1px solid #000;
display:table-row;
}
#leftTop {
margin:0;
padding:0 16px;
width:24%;
text-align:left;
color:#000;
background-color:#F0DD80;
border:1px dashed #f00;
display:table-cell;
}
#centerTop {
margin:0;
padding:0 16px;
width:40%;
margin:0 auto;
text-align:center;
color:#000;
background-color:#F5ECBD;
border:1px dashed #f00;
display:table-cell;
}
#rightTop {
margin:0;
padding:0 16px;
width:24%;
text-align:right;
color:#000;
background-color:/*#F0DD80;*/transparent;
   /*shows the orange row color*/
border:1px dashed #f00;
display:table-cell;
}
#footer {
padding:25px;
color:#000;
background-color:#F5ECBD;
}
</style>
</head>
<body id="abod">
<div id="hdrrow">
    <div id="top-bar">
        <div id="leftTop">
        LEFT
        </div>
        <div id="centerTop">
         CENTER
         </div>
         <div id="rightTop">
         RIGHT
        </div>
    </div>
</div>
<h4 id="footer">Footer Lorem ipsum dolor sit amet</h4>
</body>
</html> 
```

* * *

## 回答 #7

> 赞同：0
> 
> 时间：2009-05-27T04:32:52.697

我不知道它会消失，但它会下降一行。很多网站都因为这个原因把它弄乱了（我知道我这样做）。

另一种选择：

```
#top-bar
{

    margin: 0;
    padding: 1px 4px;
    font-size: x-small;
    background-color: #005555;
    font-family: Arial;
}
#top-bar .separator
{
    padding: 0 7px;
    border-right: 0px solid #fff;
    border-left: 0px solid #fff;
}
#top-bar>div
{
    float: left;
    width: 33%;

}
#rightTop
{
    text-align: right;
}
#centerTop
{
    color: #ffffff;
    text-align: center;
    width: 34%;
} 
```

然后`<br style="clear:both"/>`在关闭顶栏 div 之前放置。

```
<div id="top-bar">
    <div id="leftTop">
        LEFT
    </div>
    <div id="centerTop">
        CENTER
    </div>
    <div id="rightTop">
        RIGHT
    </div>
    <br style="clear:both"/>
</div> 
```

但是，不确定您是否希望像这样定义宽度。

# python - Ubuntu 9.04 上的 mod_wsgi 2.5 和 Python 2.6.2 安装

> ID：913232
> 
> 赞同：1
> 
> 时间：2009-05-26T23:09:29.560
> 
> 标签：python, compiler-construction, ubuntu, mod-wsgi, wsgi

有没有人在默认 Python 安装（2.6.2）的 Ubuntu 9.04 上成功使用 mod_wsgi 2.5？

我得到编译错误：

```
mod_wsgi.c:119:2: error: #error Sorry, mod_wsgi requires at least Python 2.3.0.
mod_wsgi.c:123:2: error: #error Sorry, mod_wsgi requires that Python supporting thread. 
```

**Python**给出 /usr/bin/python 和**/usr/bin/python -V**返回 Python 2.6.2 所以我不确定第一个有什么问题，老实说我不知道​​如何检查编译中使用的选项Ubuntu 上的默认 Python。

还有很多其他错误，但那些 2 看起来最相关。

还有什么可能是错的？

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2009-05-26T23:23:29.577

从您的错误中，我看到您必须编译 python 扩展。如果你还没有，我建议你安装 python-dev 包，因为它通常是编译 python 扩展所必需的，它不是默认安装的一部分。

安装包就像运行一样简单：

> sudo apt-get install python-dev

从命令行。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2009-05-26T23:15:25.367

也许服务器正在运行的用户在其路径上没有 /usr/bin ，并且路径上的其他地方有另一个版本的 python < 2.3

尝试：

```
which -a python 
```

找到你路径上的所有蟒蛇。也许其中之一就是服务器正在运行的内容。

# iphone - iPhone static library distribution and release build errors (but not for debug)

> ID：913259
> 
> 赞同：1
> 
> 时间：2009-05-26T23:19:32.393
> 
> 标签：iphone, cocoa-touch, xcode

**Update**

Daniel was close, it just wasn't the search path. The **Prefix Header** under GCC 4.2 was set to: $(SYSTEM_LIBRARY_DIR)/Frameworks/AppKit.framework/Headers/AppKit.h

I missed that when I was combing through the first 2 times. I removed it and now all is well.

* * *

**Original Question**

I have been using/building products with a static libraries for about a week now with no issues.

For the first time, I tried to make a distribution build (for ad hoc testing) and I am getting errors all over the place.

The errors, strangely say that it can't find Appkit headers. Which is odd because it is an iPhone app and shouldn't be linking to Appkit headers

Additionally, the library name, "libFJSCodeDebug.a" turns red while when I switch from debug to distribution/release. I figure this must be a big clue.

To test, I duplicated the debug configuration and renamed it release. This built fine. So it seems the problem is somewhere in the configuration. Below is a snippet of what I get in Xcode when I build. (Note: I named my target FJSCodeDebug even though it will be used for both debug and release builds)

```
Building target “FJSCodeDebug” of project “FJSCode” with configuration “Release” — (169 errors)
    Checking Dependencies
        cd /[redacted]/FJSCode
    setenv PATH "/DeveloperBeta/Platforms/iPhoneOS.platform/Developer/usr/bin:/DeveloperBeta/usr/bin:/usr/bin:/bin:/usr/sbin:/sbin"
    /DeveloperBeta/Platforms/iPhoneOS.platform/Developer/usr/bin/gcc-4.2 -x objective-c-header -arch armv6 -fmessage-length=0 -pipe -std=c99 -Wno-trigraphs -fpascal-strings -fasm-blocks -Os -Wreturn-type -Wunused-variable -isysroot /DeveloperBeta/Platforms/iPhoneOS.platform/Developer/SDKs/iPhoneOS3.0.sdk -gdwarf-2 -mthumb -miphoneos-version-min=3.0 -iquote /[redacted]/build/FJSCode.build/Release-iphoneos/FJSCodeDebug.build/FJSCodeDebug-generated-files.hmap -I/[redacted]/build/FJSCode.build/Release-iphoneos/FJSCodeDebug.build/FJSCodeDebug-own-target-headers.hmap -I/[redacted]/build/FJSCode.build/Release-iphoneos/FJSCodeDebug.build/FJSCodeDebug-all-target-headers.hmap -iquote /U[redacted]/build/FJSCode.build/Release-iphoneos/FJSCodeDebug.build/FJSCodeDebug-project-headers.hmap -F/[redacted]/build/Release-iphoneos -I/[redacted]/build/Release-iphoneos/include -I/Users/coreyfloyd/Xcode/ProductionProjects/build/FJSCode.build/Release-iphoneos/FJSCodeDebug.build/DerivedSources/armv6 -I/[redacted]/build/FJSCode.build/Release-iphoneos/FJSCodeDebug.build/DerivedSources -c /System/Library/Frameworks/AppKit.framework/Headers/AppKit.h -o /var/folders/R+/R+ofDLtuH1GOYQ1ZQ2C5mk+++TI/-Caches-/com.apple.Xcode.501/SharedPrecompiledHeaders/AppKit-gihvhjsfuggoevbehiszhgrzcska/AppKit.h.gch
/System/Library/Frameworks/AppKit.framework/Headers/AppKit.h:11:33: error: AppKit/AppKitDefines.h: No such file or directory
/System/Library/Frameworks/AppKit.framework/Headers/AppKit.h:12:32: error: AppKit/AppKitErrors.h: No such file or directory
/System/Library/Frameworks/AppKit.framework/Headers/AppKit.h:13:37: error: AppKit/NSGraphicsContext.h: No such file or directory
/System/Library/Frameworks/AppKit.framework/Headers/AppKit.h:14:35: error: AppKit/NSAccessibility.h: No such file or directory
/System/Library/Frameworks/AppKit.framework/Headers/AppKit.h:15:32: error: AppKit/NSActionCell.h: No such file or directory

...... (continues for everything in AppKit)......

Build failed (169 errors) 
```

I'm looking for 1 of 2 solutions: Obviously, fix the release build to not get these errors OR Tweak the debug configuration to have all the important settings that a release configuration requires.

Any ideas??

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-05-26T23:30:19.830

This

```
-c /System/Library/Frameworks/AppKit.framework/Headers/AppKit.h 
```

leads me to believe your build target is trying to compile AppKit.h for some reason (while I don't think it should be doing that at all), and/or it's looking for it in the wrong place (i.e. in the root /System instead of in the SDK /Developer/Platforms/...).

You should double check your build settings library/frameworks search paths, and that AppKit.h isn't in the compile phase.

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-05-26T23:40:37.843

Does your project include Mac OS products? Are you sure you haven't accidently included a Mac library/framework in your frameworks group?

In SDK2.2.1, I don't know why, but the thing that always gets me is when "Active SDK" and "Active Executable" become out of sync (in the build configuration dropdown). This leads to weird linker errors where the iPhone tries to *dynamically* link against its libraries. This setting seems to occasionally go out of sync whenever I switch from debug/release or device/simulator.

Perhaps its a similar case, its hard to tell without seeing the actual project settings.

# java - EJB - Home/Remote 和 LocalHome/Local 接口

> ID：913267
> 
> 赞同：15
> 
> 时间：2009-05-26T23:22:35.227
> 
> 标签：java, jakarta-ee, interface, ejb

修改一些过去的考试试卷主要集中在面向组件的设计和J2EE上，我遇到了以下问题：

*对场景 3：“交换请求”的初步调查表明，两个 EJB 将提供一个合适的解决方案：一个名为 EnterExchangeRequest 的会话 bean 来控制处理，一个名为 ExchangeRequest 的实体 bean 来表示请求的持久属性。讨论以下接口的作用：*

*   家
*   偏僻的
*   本地首页
*   当地的

*以及他们将如何提供对上述 EJB 服务的访问。*

我可以尝试解释如何将接口融入图片中`Home`。`Remote`我也听讲师说一个可以替换`Home`为`LocalHome`, 和`Remote`（`Local`为什么？），但他们为什么要我同时讨论所有四个的角色？

* * *

我说得对吗，*EJB 容器*（应用程序服务器）会看到一个接口是`Home`or`Remote`然后决定 bean 可以在集群中的任何机器上“存在”，而在这种情况下，接口是`LocalHome`并且`Local`容器会知道 bean 不能分布在多台机器上，因此只能在一台机器上保持它们“活着”？

* * *

我完全迷失在这个企业 Java 丛林中。我正在经历 BeanOverflow。您能否告诉我我的哪些假设是错误的，指出我的误解和错误。

感谢所有愿意帮助我处理这些 EJB 接口的人。

PS 请注意，我并不是要您回答过去试卷中的问题。只是好奇你在问这个问题时是否对他们有什么想法。

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2009-05-26T23:37:43.263

Home 负责创建 Remote（有点像它的构造函数），并且 LocalHome 和 Local 具有相同的关系。

在每种情况下，容器都会为您提供一个代理，该代理引用您编写的真实 EJB 类。

如果我不得不猜测，那么问题是对会话 bean 使用远程，对实体 bean 使用本地。

无论如何，尽管这些概念仍然存在，但在 EJB3 中事情已经得到了更好的简化。

编辑：作为对评论的回应，使用 EJB3，bean 类本身可以直接实现远程和家庭接口（对于会话 bean）。它们是用单个注释制作的 EJB。有状态的 bean 有更多的注释来处理状态问题。实体bean没有Home接口，也不需要本地接口，可以直接与java对象交互。有一个 EntityManager 可以根据查询检索正确的实体 bean，并且该 EntityManager 是通过注释注入的。

这种总结在一个段落中。网上有很多关于这些东西的教程，但是 EJB 通常会解决一类问题，除非您处理这些问题，否则很难理解。它们不是解决它的唯一方法，但除非你处理这种类型的编程，否则仅仅阅读它并不能真正帮助你理解它。

* * *

## 回答 #2

> 赞同：7
> 
> 时间：2009-05-28T12:54:45.387

正如 Yishay 所指出的，Home/Remote 和 LocalHome/Local 是绑定在一起的，并且 Home 接口用作构造函数。

本地 bean 与它们所在的 JVM 相关联，您无法从外部访问它们。可以从其他 JVM 访问远程 bean。

我使用类似的方法：我总是张开耳朵。用于耳朵的豆子我制作本地豆子，用于其他耳朵的豆子我制作的远程豆子。但是可以在其他耳朵中使用本地bean，只要它们部署在同一个JVM中

# css - 如何在 SharePoint 我的网站中更改 Person.aspx 的主题

> ID：913268
> 
> 赞同：1
> 
> 时间：2009-05-26T23:22:36.583
> 
> 标签：css, sharepoint, themes

除了“我的站点”下的用户个人资料页面（即 Person.aspx 页面）之外，我的自定义主题无处不在。关于如何将主题应用于此页面的任何想法？或者甚至只是硬编码自定义样式？

谢谢，羽衣甘蓝

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2009-05-27T01:34:32.823

问题是 person.aspx 与用户站点中的其余页面位于完全不同的站点集合中。您需要将主题单独应用到 mysite 主机站点。

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2009-05-27T03:18:27.903

最好的方法是使用解决方案包将包含母版页/页面布局/样式的功能推送到网站集。这样，您只需在每个站点集合中激活该功能...例如，一个用于您的 Intranet，一个用于您的 MySites 站点集合。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2009-05-27T01:29:09.793

硬编码自定义样式可以通过替换 MySite 站点定义中的 Person.aspx 页面来完成，但这不是推荐的做法。

[这](http://www.sharepointblogs.com/mirjam/archive/2008/02/22/customizing-the-my-site-look-and-feel.aspx)是一种可能对您有用的不同方法，这取决于您在 MySite 推出方面取得的进展。

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2009-06-10T11:37:09.320

这是我对这个问题的解决方案。假设您的个人资料页面 URL [http://sitename/Person.aspx](http://sitename/Person.aspx) 在 IE 上输入以下 url 并登录 http sitename/_layouts/settings.aspx

页面 (_layouts/settings.aspx) 可能需要管理员权限。登录后，您将可以选择更改主题和其他功能。就是这样。

# apache-flex - Flex 如何将 setStyle 延迟到下一次更新？

> ID：913275
> 
> 赞同：1
> 
> 时间：2009-05-26T23:24:50.323
> 
> 标签：apache-flex, actionscript-3, user-interface, components

我有一个由两部分组成的组件，假设一个 Vbox 中有两个 Hbox A 和 B。

在特定呼叫中，我想：

```
- Hide B with B.visible = false
- setStyle("borderSkin", FooBorderOn); 
```

问题是在调整父 Vbox 的大小之前就绘制了边框，所以我最终在 Vbox 周围出现了一个边框，其中 B 不可见：

```
.....................
.         A         .
.                   .
.                   .
.                   .
.     BLANK SPACE   .
..................... 
```

我希望边框围绕 vbox 的下一个更新大小。有没有类似**“重绘后做”的东西？**在弹性？

非常感谢

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-05-26T23:28:16.667

看一下 callLater 方法。这会将方法调用推迟到下一帧更新。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-05-26T23:28:46.697

是 callLater ... 我在记忆中的某个地方

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-05-27T02:14:20.060

即使隐藏了 VBox，HBox B 仍然存在。我会缩小 VBox 的高度，将 VerticalScrollPolicy 设置为 false（这样滚动条就不会显示），或者只是从 VBox 中删除 HBox（myVBox.removeChild () ）。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2010-05-06T16:50:54.543

有几种方法可以推迟行动。如果您自己开发 UI 组件，请查看 invalidateProperties / commitProperties。这是一种不会陷入更新循环的机制：您标记要更新的属性（通常通过将其存储在临时变量中和/或添加 xxxChanged 布尔值）并调用 invalidateProperties()。Flex 稍后将调用 commitProperties() - 累积几个可能相互影响的更改 - 您可以在其中进行实际更改。

[callLater](http://livedocs.adobe.com/flex/3/html/help.html?content=layoutperformance_12.html) would also be an option, though usually it's not as "later" as one would think :) (It's the next screen refresh, which could happen quite soon, even before other queued actions)

However in your case, from your description, I think you just missed the "includeInLayout" property. Containers will decide to display (visible) or make room for (includeInLayout) for objects based on those two, separate properties. See also [Preventing layout of hidden controls](http://livedocs.adobe.com/flex/3/html/help.html?content=size_position_4.html#237855).

# javascript - 如何使用 jQuery 找到元素在页面中的位置？

> ID：913279
> 
> 赞同：4
> 
> 时间：2009-05-26T23:25:37.780
> 
> 标签：javascript, jquery, css, position

我知道 position 方法，但它检索相对于偏移父级的位置。我是否只是抛出一个循环来横向遍历文档节点？

我想我很惊讶它不是核心的一部分，我想知道它是否藏在我不知道的某个地方。

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2009-05-26T23:30:22.840

```
jQuery(elem).offset(); 
```

有关摘要，请参见[http://docs.jquery.com/CSS/offset](http://docs.jquery.com/CSS/offset)

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-05-26T23:31:04.353

如果没有 jQuery，您可以使用：

```
document.getElementById('elemId').clientTop
document.getElementById('elemId').clientLeft 
```

或者

```
document.getElementById('elemId').offsetTop
document.getElementById('elemId').offsetLeft 
```

# c# - 将每个图形形状分为两部分 - 它的几何和渲染组件是一个好主意吗？

> ID：913281
> 
> 赞同：0
> 
> 时间：2009-05-26T23:26:02.647
> 
> 标签：c#, graphics, oop

我正在使用 C# 为一个大学项目编写一个简单的图形编辑器。
我创建了一个层次结构，其中每种类型的形状——圆形、矩形、椭圆……——都继承自基类 Shape，它包含一个形状颜色作为受保护的字段。

```
 public abstract class Shape {
        protected Color color;

        public Shape(Color c) {
            color = c;
        }

        public Color FigureColor {
            get { return color; }
            protected set { color = value; }
        }

        public abstract void render(Bitmap canvasToDrawOn);

        public abstract void unrender(Bitmap canvasToDrawOn);

        public abstract void renderPrototype(Bitmap canvasToDrawOn);
    } 
```

这个想法是我希望每种形状都封装它的几何部分，例如：

```
 public class TwoDPoint: TwoDShape {
        Point2DGeometry point;

        public TwoDPoint(Color c, Point2DGeometry p): base(c) {
            point = new Point2DGeometry(p);
        }

public struct Point2DGeometry {
        Int32 x;
        Int32 y;

        public Point2DGeometry(Int32 X, Int32 Y) {
            x = X;
            y = Y;
        }

        public Point2DGeometry(Point2DGeometry rhs) {
            x = rhs.Abscissa;
            y = rhs.Ordinate;
        }

        public Int32 Abscissa {
            get { return x; }
            private set { x = value; }
        }

        public Int32 Ordinate {
            get { return y; }
            private set { y = value; }
        }
    } 
```

Ellipse 类将封装 EllipseGeometry 等。
就 OO 设计而言，这是一个好的决定吗？如果是，创建这种仅几何类型的并行层次结构可能是更好的主意？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-05-26T23:36:33.063

我认为答案是肯定的，因为它遵循了受人尊敬的 MVC 模式所制定的轨道。

另一个优点是它为您提供了更换图形库的选项，而无需重写所有这些基本几何类。使用界面使这更容易做到。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-05-27T05:15:47.233

我会说这取决于。您是要在形状对象之外重用几何对象，还是将几何对象共享为享元？如果没有，您可能会不必要地使您的类层次结构复杂化。

查看您的代码，您可能还需要考虑以下内容：

1.  在您的私有字段和您的公共属性之间有某种命名约定。当您的私有变量是 x/y 并且您的构造函数采用 X/Y 时，使用 Abscissa/Ordinate 是没有意义的。形状中的同上颜色和图形颜色。

2.  在 Shape 中，当“FigureColor”也有一个受保护的 setter 时，为什么要让“color”受到保护？在大多数 API 中（您可以将抽象类视为其派生类的 API），您会希望在更改状态时尽量减少对使用哪些成员的混淆。在这个特定的例子中，我很可能将“颜色”设为私有。

3.  在您的类层次结构中注意不增加任何价值的“内部类”。例如，您有一个抽象的 Shape 类，从外观上看，TwoDShape 也是如此。两者有什么区别？是否支持 3 维？你的继承树看起来更像一根棍子吗？

HTH，祝你的项目好运。

# linux - Shred：在 Journaled FS 上不起作用？

> ID：913282
> 
> 赞同：11
> 
> 时间：2009-05-26T23:26:52.630
> 
> 标签：linux, filesystems, shred, journal

Shred 文档说 shred “不能保证有效”（见底部）。所以如果我在我的 Ext3 文件系统或 Raid 上粉碎一个文档，会发生什么？我要切碎文件的一部分吗？它有时会切碎整个东西，有时不会吗？可以撕碎别的东西吗？它只粉碎文件头吗？

> 注意：请注意，shred 依赖于一个非常重要的假设：文件系统会在原地覆盖数据。这是做事的传统方式，但许多现代文件系统设计不满足这个假设。以下是 shred 无效或不保证在所有文件系统模式下都有效的文件系统示例：
> 
> *   日志结构或日志文件系统，例如随 AIX 和 Solaris（以及 JFS、ReiserFS、XFS、Ext3 等）提供的文件系统
>     
>     
> *   写入冗余数据并在某些写入失败的情况下继续执行的文件系统，例如基于 RAID 的文件系统
>     
>     
> *   生成快照的文件系统，例如 Network Appliance 的 NFS 服务器
>     
>     
> *   缓存在临时位置的文件系统，例如 NFS 版本 3 客户端
>     
>     
> *   压缩文件系统
>     
>     
> 
> 在 ext3 文件系统的情况下，上述免责声明仅在 data=journal 模式下适用（因此 shred 的有效性有限），除了元数据之外，它还记录文件数据。在 data=ordered（默认）和 data=writeback 模式下，shred 照常工作。可以通过将 data=something 选项添加到 /etc/fstab 文件中特定文件系统的挂载选项来更改 Ext3 日志模式，如挂载手册页 (man mount) 中所述。

* * *

## 回答 #1

> 赞同：15
> 
> 时间：2009-05-26T23:56:15.567

shred 所做的只是覆盖、刷新、检查成功并重复。确定覆盖文件是否真的会导致包含原始数据的块被覆盖完全没有任何作用。这是因为在不了解底层文件系统的非标准信息的情况下，它不能。

因此，日志文件系统不会覆盖原来的块，因为这会阻止它们从更改被写入一半的错误中干净地恢复。如果记录了数据，则每次切碎都可能被写入磁盘上的新位置，在这种情况下，什么都不会被切碎。

RAID 文件系统（取决于 RAID 模式）可能不会覆盖原始块的所有副本。如果存在冗余，您可能会切碎一个磁盘而不切碎其他磁盘，或者您可能会发现不同的通道影响了不同的磁盘，因此每个磁盘都被部分切碎。

在任何文件系统上，磁盘硬件本身可能碰巧检测到错误（或者，在闪存的情况下，即使没有错误，也可以应用磨损均衡）并将逻辑块重新映射到不同的物理块，使得原始块是标记为有缺陷（或未使用）但从未被覆盖。

压缩文件系统可能不会覆盖原始块，因为 shred 覆盖的数据在每次传递时要么是随机的，要么是极其可压缩的，任何一个都可能导致文件从根本上改变其压缩大小并因此被重新定位。NTFS 将小文件存储在 MFT 中，当 shred 将文件大小四舍五入到一个块的倍数时，它的第一次“覆盖”通常会导致文件被重新定位到新位置，然后将被毫无意义地切碎，留下小MFT 插槽保持不变。

Shred 无法检测到任何这些情况（除非您有一个直接解决您的 fs 和块驱动程序的特殊实现 - 我不知道是否真的存在任何此类事情）。这就是为什么在整个磁盘上使用它比在文件系统上使用更可靠的原因。

Shred 从不切碎其他文件意义上的“其他东西”。在上面的某些情况下，它会粉碎以前未分配的块，而不是包含您的数据的块。它也不会粉碎文件系统中的任何元数据（我猜这就是你所说的“文件头”）。-u 选项确实会尝试覆盖文件名，方法是重命名为相同长度的新名称，然后在删除文件之前一次将一个字符缩短为 1 个字符。如果您也指定 -v，您可以看到这一点。

* * *

## 回答 #2

> 赞同：5
> 
> 时间：2009-05-27T00:37:30.240

其他答案已经很好地解释了为什么 shred 可能无法正常工作。

这可以概括为：

*shred 仅适用于分区，不适用于单个文件*

如其他答案中所述，如果您粉碎单个文件：

*   不能保证实际数据真的被覆盖，因为文件系统可能会将对同一文件的写入发送到磁盘上的不同位置
*   不能保证 fs 没有在其他地方创建数据副本
*   fs 甚至可能决定“优化”您的写入，因为您正在重复写入同一个文件（同步应该可以防止这种情况，但同样：不能保证）

但是即使你知道*你的*文件系统没有做上述任何令人讨厌的事情，你也必须考虑到许多应用程序会自动创建文件数据的副本：

*   字处理器、编辑器（如 vim）等将定期写入的崩溃恢复文件
*   文件管理器中的缩略图/预览文件（有时甚至是非图像文件）
*   许多应用程序使用的临时文件

因此，如果没有检查您用于处理数据的每个二进制文件，它可能会在您不知情的情况下被复制到右侧、左侧和中心。唯一现实的方法是始终切碎完整的分区（或磁盘）。

* * *

## 回答 #3

> 赞同：3
> 
> 时间：2009-05-26T23:44:54.997

问题是数据可能存在于磁盘上的多个位置。当数据恰好存在于一个位置时，shred 可以确定性地“擦除”该信息。但是，日志文件系统或其他高级文件系统可能会将您的文件数据临时写入磁盘上的多个位置。Shred - 事后 - 无法知道这一点，也无法知道数据可能临时写入磁盘的位置。因此，它无法擦除或覆盖这些磁盘扇区。

想象一下：您将文件写入日志文件系统上的磁盘，该文件系统不仅记录元数据，还记录文件数据。文件数据暂时写入日志，然后写入其最终位置。现在您在文件上使用 shred。写入数据的最终位置可以被 shred 安全地覆盖。但是，shred 必须有某种方式来保证日志中临时包含文件内容的扇区也被覆盖​​，以保证您的文件确实不可恢复。想象一个文件系统，其中日志甚至不在固定位置或固定长度。

如果您使用的是 shred，那么您正在尝试确保无法重建您的数据。shred 的作者说实话，有一些他们无法控制的情况，他们无法做出这种保证。

# sql - SQL 区分和计数

> ID：913302
> 
> 赞同：22
> 
> 时间：2009-05-26T23:36:49.940
> 
> 标签：sql, count, aggregate, distinct

我有一个查询，我想在其中获取不同的日期、与这些日期关联的电话号码以及每个日期的电话号码计数。

例如，我有一个包含日期和电话号码的数据库，我希望结果是

```
9/2005      5554446666    3
9/2005      4445556666    1
10/2005     1112223333    1
11/2005     2223334444    2 
```

我可以使用此查询获取日期和计数：

```
SELECT DISTINCT date, count(phone) AS count
FROM calls
GROUP BY date 
```

我似乎无法得到“计数”正在计数的电话号码。我想我需要某种聚合函数来获取唯一值列表的单个实例，但 First() 和其他一些只抛出 SQL 错误。我需要子查询吗？

* * *

## 回答 #1

> 赞同：32
> 
> 时间：2009-05-26T23:39:34.273

```
SELECT date, PhoneNumber, count(phone) AS count
    FROM calls
    GROUP BY date, PhoneNumber 
```

我认为应该这样做

* * *

## 回答 #2

> 赞同：8
> 
> 时间：2009-05-26T23:39:57.643

您可能想尝试类似的东西

```
SELECT Date, Phone, Count(*) As Count From Calls GROUP BY Date, Phone 
```

这将为您提供每个日期的每个电话号码的计数，以及该号码在该日期出现的次数。

* * *

## 回答 #3

> 赞同：4
> 
> 时间：2009-05-26T23:41:42.130

```
SELECT date, phone, count(phone) AS count FROM calls GROUP BY date, phone 
```

（你不需要 DISTINCT 和 GROUP BY。）

* * *

## 回答 #4

> 赞同：2
> 
> 时间：2009-05-26T23:38:45.757

那是因为您是按*日期*而不是*电话*分组。

在一组日期中可能有三个不同的数字，SQL 不可能知道您想要哪一个。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2013-12-19T16:42:37.563

尝试以下

计数（电话）来自呼叫

会给你不同的计数。

# version-control - 如何保持代码和规范同步？- 有没有好的工具

> ID：913303
> 
> 赞同：13
> 
> 时间：2009-05-26T23:37:12.827
> 
> 标签：version-control, documentation, specifications

在我的团队中，我们有一个很棒的源代码控制系统，我们有很棒的规格。我想解决的问题是如何使规范与代码保持同步。随着时间的推移，规格往往会老化并过时

制定规范的人往往不喜欢源代码控制，而程序员往往不喜欢共享点。

我很想听听其他人使用什么解决方案？某处有快乐的中间吗？

* * *

## 回答 #1

> 赞同：11
> 
> 时间：2009-05-26T23:50:09.960

没有。没有快乐的中间。他们有不同的受众和不同的目的。

以下是我作为架构师和规范编写者所学到的知识： **规范几乎没有长期价值。** 克服它。

这些规范虽然很适合开始编程，但无论您做什么，都会随着时间的推移失去其价值。该规范的受众是没有太多洞察力的程序员。这些程序员变成了不再需要规范的知识渊博的程序员。

规范的某些部分——尤其是概述——可能具有一些长期价值。

如果规范的其余部分有价值，程序员会让它们保持最新。

行之有效的方法是使用嵌入在代码中的注释以及提取这些注释并生成当前实时文档的工具。Java 使用 javadoc 做到这一点。Python 使用[epydoc](http://epydoc.sourceforge.net/)或[Sphinx](http://sphinx.pocoo.org/)执行此操作。C（和 C++）使用[Doxygen](http://www.doxygen.org/)。有很多选择：[http ://en.wikipedia.org/wiki/Comparison_of_documentation_generators](http://en.wikipedia.org/wiki/Comparison_of_documentation_generators)

概述应该从原始规范中取出并放入代码中。

应提取最终文件。本文档可以通过使用规范概述和代码详细信息来替换规范。

当需要大修时，会有新的规格。可能需要对现有规范进行修订。起点是自动生成的规范文档。规格。作者可以从这些开始，然后添加/更改/删除他们心中的内容。

* * *

## 回答 #2

> 赞同：5
> 
> 时间：2009-05-26T23:42:09.167

我认为非 Sharepoint wiki 有助于使文档保持最新。大多数非技术人员都能理解如何使用 wiki，并且大多数程序员会非常乐意使用一个好的 wiki。在我看来，Sharepoint 中的 wiki 和文档控制系统使用起来很笨拙且令人沮丧。

[Mediawiki](http://www.mediawiki.org/wiki/MediaWiki)是一个不错的选择。

我真的很喜欢 wiki，因为它们是迄今为止采用和跟上的最小痛苦。它们为您提供自动版本控制，并且通常非常直观供每个人使用。很多公司都希望为此使用 Word、Excel 或其他类型的文档，但是让所有内容都在线并从通用界面访问是关键。

* * *

## 回答 #3

> 赞同：4
> 
> 时间：2009-05-27T00:02:17.347

规范应该尽可能地是可执行的，通过 rspec 或 doctest 和类似的框架。代码规范应与单元测试和具有良好命名的方法和变量的代码一起记录。

然后规范文档（最好在 wiki 中）应该为您提供更高级别的事物概述 - 并且不会发生太大变化或快速不同步。

这种方法肯定会使规范和代码保持同步，并且当它们不同步时测试将失败。

话虽这么说，在许多项目中，上述内容都是天方夜谭。在那种情况下，S. Lott 是对的，克服它。它们不会保持同步。将规范视为开发人员获得的路线图，而不是他们所做工作的文档。

*如果拥有当前的规范非常重要，那么在编写代码后*应该在项目上分配特定的时间来编写（或重写）规范。然后它将是准确的（直到代码更改）。

所有这一切的替代方法是将规范和代码保持在源代码控制之下，并检查签入以确保规范与代码一起更改。它会减慢开发过程，但如果它真的那么重要......

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2009-05-26T23:42:37.793

对于您所描述的内容，我不知道有什么特别好的解决方案；通常，我见过的唯一真正使这类东西保持同步的解决方案是从源代码（doxygen、Javadoc）生成文档的工具。

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2009-05-26T23:46:47.660

用于使文档与代码保持同步的一种技术是[文学编程](http://nwalsh.com/docs/articles/xml2002/lp/paper.html)。这将代码和文档保存在同一个文件中，并使用预处理器从文档中生成可编译的代码。据我所知，这是[Donald Knuth](http://en.wikipedia.org/wiki/Donald_Knuth)使用的技术之一——如果人们在他的代码中发现错误，他很乐意[付钱给他们。](http://en.wikipedia.org/wiki/Knuth_reward_check)

# c# - 使用 FTP 和 C# 下载所有文件

> ID：913312
> 
> 赞同：2
> 
> 时间：2009-05-26T23:40:34.333
> 
> 标签：c#, ftp, download

使用 C# 和 FTP 下载远程目录中的所有文件并将它们保存到本地目录的最佳方法是什么？

谢谢。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2009-06-02T16:39:20.437

下载特定文件夹中的所有文件似乎是一件容易的事。但是，有一些问题需要解决。仅举几例：

*   如何获取文件列表（System.Net.FtpWebRequest 为您提供未解析的列表和目录列表格式在任何 RFC 中均未标准化）
*   如果远程目录既有文件又有子目录怎么办。我们是否必须深入到子目录并下载它的内容？
*   如果本地计算机上已经存在一些远程文件怎么办？他们应该被覆盖吗？跳过？我们应该只覆盖旧文件吗？
*   如果本地文件不可写怎么办？整个转移应该失败吗？我们是否应该跳过该文件并继续下一个？
*   如何处理由于我们没有足够的访问权限而无法读取的远程磁盘上的文件？
*   [符号链接](http://en.wikipedia.org/wiki/Symbolic_link)、[硬链接](http://en.wikipedia.org/wiki/Hard_link)和[连接点](http://en.wikipedia.org/wiki/NTFS_junction_point)是如何处理的？链接可以很容易地用于创建[无限递归的目录树结构](http://blogs.msdn.com/oldnewthing/archive/2004/12/27/332704.aspx)。考虑文件夹 A 和子文件夹 B，它实际上不是真正的文件夹，而是指向文件夹 A 的 *nix 硬链接。天真的方法将在一个永远不会结束的应用程序中结束（至少如果没有人设法拔掉插头）。

体面的第三方 FTP 组件应该有处理这些问题的方法。以下代码使用我们的[Rebex FTP for .NET](http://www.rebex.net/ftp.net/)。

```
using (Ftp client = new Ftp())
        {
            // connect and login to the FTP site
            client.Connect("mirror.aarnet.edu.au");
            client.Login("anonymous", "my@password");

            // download all files
            client.GetFiles(
                "/pub/fedora/linux/development/i386/os/EFI/*",
                "c:\\temp\\download",
                FtpBatchTransferOptions.Recursive,
                FtpActionOnExistingFiles.OverwriteAll
            );

            client.Disconnect();
        } 
```

代码取自我在[blog.rebex.net](http://blog.rebex.net/news/archive/2009/06/02/howto-download-all-files-from-a-remote-ftp-directory-and-save-them-to-a-local-disk.aspx)上的博文。博文还引用了一个示例，该示例显示了如何询问用户如何处理每个问题（例如覆盖/覆盖旧的/跳过/全部跳过）。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-04-03T13:46:34.747

使用 C# FtpWebRequest 和 FtpWebReponse，您可以使用以下递归（确保文件夹字符串以 '\' 结尾）：

```
 public void GetAllDirectoriesAndFiles(string getFolder, string putFolder)
    {
        List<string> dirIitems = DirectoryListing(getFolder);
        foreach (var item in dirIitems)
        {
            if ( item.Contains('.')  )
            {
                GetFile(getFolder + item, putFolder + item);
            }
            else
            {
                var subDirPut = new DirectoryInfo(putFolder + "\\" + item);
                subDirPut.Create();
                GetAllDirectoriesAndFiles(getFolder + item + "\\", subDirPut.FullName + "\\");
            }
        }
    } 
```

“item.Contains('.')”有点原始，但对我的目的有用。如果您需要方法示例，请发表评论：

```
GetFile(string getFileAndPath, string putFileAndPath) 
```

或者

```
DirectoryListing(getFolder) 
```

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2016-05-19T11:54:27.867

对于 FTP 协议，您可以使用.NET 框架中的[`FtpWebRequest`类](https://docs.microsoft.com/en-us/dotnet/api/system.net.ftpwebrequest)。尽管它对递归文件操作（包括下载）没有任何明确的支持。您必须自己实现递归：

*   列出远程目录
*   迭代条目，下载文件并递归到子目录（再次列出它们等）

棘手的部分是从子目录中识别文件。没有办法以便携的方式使用`FtpWebRequest`. 不幸的`FtpWebRequest`是不支持该`MLSD`命令，这是在 FTP 协议中检索具有文件属性的目录列表的唯一可移植方式。另请参阅[检查 FTP 服务器上的对象是文件还是目录](https://stackoverflow.com/q/36895021/850848)。

您的选择是：

*   对文件名执行操作，对于文件肯定会失败，而对于目录会成功（反之亦然）。即您可以尝试下载“名称”。如果成功，它是一个文件，如果失败，它是一个目录。但是，当您有大量条目时，这可能会成为性能问题。
*   您可能很幸运，在您的特定情况下，您可以通过文件名来区分目录中的文件（即所有文件都有扩展名，而子目录没有）
*   您使用长目录列表（`LIST`命令 =`ListDirectoryDetails`方法）并尝试解析特定于服务器的列表。许多 FTP 服务器使用 *nix 样式的列表，您可以通过`d`条目开头的 来标识目录。但是许多服务器使用不同的格式。以下示例使用这种方法（假设 *nix 格式）

```
void DownloadFtpDirectory(string url, NetworkCredential credentials, string localPath)
{
    FtpWebRequest listRequest = (FtpWebRequest)WebRequest.Create(url);
    listRequest.UsePassive = true;
    listRequest.Method = WebRequestMethods.Ftp.ListDirectoryDetails;
    listRequest.Credentials = credentials;

    List<string> lines = new List<string>();

    using (WebResponse listResponse = listRequest.GetResponse())
    using (Stream listStream = listResponse.GetResponseStream())
    using (StreamReader listReader = new StreamReader(listStream))
    {
        while (!listReader.EndOfStream)
        {
            lines.Add(listReader.ReadLine());
        }
    }

    foreach (string line in lines)
    {
        string[] tokens =
            line.Split(new[] { ' ' }, 9, StringSplitOptions.RemoveEmptyEntries);
        string name = tokens[8];
        string permissions = tokens[0];

        string localFilePath = Path.Combine(localPath, name);
        string fileUrl = url + name;

        if (permissions[0] == 'd')
        {
            Directory.CreateDirectory(localFilePath);
            DownloadFtpDirectory(fileUrl + "/", credentials, localFilePath);
        }
        else
        {
            FtpWebRequest downloadRequest = (FtpWebRequest)WebRequest.Create(fileUrl);
            downloadRequest.UsePassive = true;
            downloadRequest.UseBinary = true;
            downloadRequest.Method = WebRequestMethods.Ftp.DownloadFile;
            downloadRequest.Credentials = credentials;

            using (Stream ftpStream = downloadRequest.GetResponse().GetResponseStream())
            using (Stream fileStream = File.Create(localFilePath))
            {
                ftpStream.CopyTo(fileStream);
            }
        }
    }
} 
```

`url`必须是这样的：

*   `ftp://example.com/`或者
*   `ftp://example.com/path/`

* * *

或者使用支持递归下载的 3rd 方库。

例如，使用[WinSCP .NET 程序集](https://winscp.net/eng/docs/library)，您可以通过一次调用下载整个目录[`Session.GetFiles`](https://winscp.net/eng/docs/library_session_getfiles)：

```
// Setup session options
SessionOptions sessionOptions = new SessionOptions
{
    Protocol = Protocol.Ftp,
    HostName = "example.com",
    UserName = "user",
    Password = "mypassword",
};

using (Session session = new Session())
{
    // Connect
    session.Open(sessionOptions);

    // Download files
    session.GetFiles("/home/user/*", @"d:\download\").Check();
} 
```

`MLSD`如果服务器支持，WinSCP 在内部使用该命令。如果没有，它会使用该`LIST`命令并支持数十种不同的列表格式。

*（我是WinSCP的作者）*

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2010-10-08T18:05:44.480

您可以使用`System.Net.WebClient.DownloadFile()`支持 FTP 的 . [MSDN 详细信息在这里](http://msdn.microsoft.com/en-us/library/system.net.webclient%28VS.80%29.aspx)

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2010-09-19T17:16:40.343

您可以使用[来自 laedit.net 的 FTPClient](http://old.laedit.net/fr/Framework/code/Net-FTPClient.html)。它在 Apache 许可下并且易于使用。

它使用[FtpWebRequest](https://msdn.microsoft.com/fr-fr/library/system.net.ftpwebrequest%28v=vs.110%29.aspx)：

*   首先，您需要使用`WebRequestMethods.Ftp.ListDirectoryDetails`来获取文件夹的所有列表的详细信息
*   对于您需要用来将`WebRequestMethods.Ftp.DownloadFile`其下载到本地文件夹的每个文件

# c# - 命令窗口和立即窗口之间的实际区别是什么？

> ID：913316
> 
> 赞同：25
> 
> 时间：2009-05-26T23:41:38.747
> 
> 标签：c#, visual-studio-2008

只是好奇。

* * *

## 回答 #1

> 赞同：18
> 
> 时间：2009-05-26T23:46:42.167

这篇[博](http://dotnetdud.wordpress.com/2007/12/25/immediate-and-command-window-in-visual-studio/)文对这两个窗口的用户进行了相当不错的概述。从该页面引用：

> **命令窗口**用于直接在 Visual Studio 集成开发环境 (IDE) 中执行命令或别名。您可以执行菜单命令和未出现在任何菜单上的命令。要显示命令窗口，请从视图菜单中选择其他窗口，然后选择命令窗口
> 
> **立即窗口**用于调试和评估表达式、执行语句、打印变量值等等。它允许您在调试期间输入要由开发语言评估或执行的表达式。要显示“立即”窗口，请打开一个项目进行编辑，然后从“调试”菜单中选择“Windows”并选择“立即”。

它还包括一个看似非常完整的命令和别名列表，您可以执行（至少对于 VS 2005）——据我所知，可以从任一窗口执行。一个不错的功能是，您只需执行`cmd`and`immed`命令即可在两个窗口之间切换。

此外，另请参阅[Command Window](http://msdn.microsoft.com/en-us/library/c785s0kz.aspx)和[Immediate Window](http://msdn.microsoft.com/en-us/library/f177hahy.aspx)上的 MSDN 页面。

* * *

## 回答 #2

> 赞同：6
> 
> 时间：2009-05-26T23:46:11.047

两者之间的一个区别是命令窗口将随时接受命令（Visual Studio 命令），而即时窗口（评估）仅在调试会话期间接受命令。

* * *

## 回答 #3

> 赞同：4
> 
> 时间：2009-05-26T23:46:34.167

从[MSDN（命令窗口）](http://msdn.microsoft.com/en-us/library/c785s0kz(VS.80).aspx)：

> 命令窗口用于直接在 Visual Studio 集成开发环境 (IDE) 中执行命令或别名。您可以执行菜单命令和未出现在任何菜单上的命令。

从[MSDN（立即窗口）](http://msdn.microsoft.com/en-us/library/f177hahy(VS.80).aspx)：

> 即时窗口在设计时用于调试和评估表达式、执行语句、打印变量值等。它允许您在调试期间输入要由开发语言评估或执行的表达式。

# php - 如何使用一个正则表达式选择这些属性的标记名称和属性和值？

> ID：913320
> 
> 赞同：0
> 
> 时间：2009-05-26T23:42:31.553
> 
> 标签：php, regex, preg-match-all

我从这篇文章中得到了以下正则表达式（[用于提取标签属性](https://stackoverflow.com/questions/317053/regular-expression-for-extracting-tag-attributes)的正则表达式）。

```
(\S+)=["\']?((?:.(?!["\']?\s+(?:\S+)=|[>"\']))+.)["\']? 
```

我创建了以下 PHP 代码，它运行良好。我从 preg_match_all() 函数中 得到 [ ***id='gridview1' and 'id' and 'gridview1' ]。***

```
$regexp = '/(\S+)=["\']?((?:.(?!["\']?\s+(?:\S+)=|[>"\']))+.)["\']?/';
$text = '<asp:gridview id=\'gridview1\' />';

$matches = null;
preg_match_all($regexp, $text, $matches);

print_r($matches); 
```

**应该如何将正则表达式更改为也返回“asp”和“gridview”？**（或“Foo”和“bAR”，当我使用：

> **<Foo:bAR />**

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-05-27T00:03:00.870

`([a-zA-Z]+)\:([a-zA-Z]+)` 适用于 Foo:bar 之类的东西

`<.*?([a-zA-Z])+.*?\:.*?([a-zA-Z])+.*?\/>`适用于 < Foo : BArrr />

可以根据您的要求以及您是否知道强制执行某种类型的格式来优化事情。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-05-27T06:13:53.840

[您不应该使用正则表达式来解析 HTML](http://www.google.nl/search?q=do+not+use+regular+expressions+to+parse+html)

# c# - 如何制作 LINQ 表达式来调用方法？

> ID：913325
> 
> 赞同：2
> 
> 时间：2009-05-26T23:44:23.357
> 
> 标签：c#, linq, expression-trees, dynamic-language-runtime

我一直在玩弄[DLR](http://www.codeplex.com/dlr)并且有点卡在调用方法上。例如，假设我想创建一个表达式来将某些东西压入堆栈：

```
class StackInfo{

    protected Stack<SomeClass> _stack;

    public Expression Push(SomeClass item)
    {
        MethodInfo mi = _stack.GetType().GetMethod("Push");
        return Expression.Call(_stack, mi, item);
    }
} 
```

我被卡住了，因为我不确定如何从 _stack 或项目中获取表达式。有人能把我推向正确的方向吗？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2009-05-27T00:12:28.137

使用`Expression.Constant`工厂方法：

```
class StackInfo
{
    protected Stack<SomeClass> _stack;

    public Expression Push(SomeClass item)
    {
        MethodInfo mi = _stack.GetType().GetMethod("Push");

        return Expression.Call(Expression.Constant(_stack), mi, Expression.Constant(item));
    }
} 
```

# c++ - 如何静态断言许多类的共同属性

> ID：913338
> 
> 赞同：0
> 
> 时间：2009-05-26T23:47:37.050
> 
> 标签：c++, boost, static-assert

假设我有 3 节课。我希望每个类的 sizeof() 完全相同——比如 512 个字节。

我怎样才能使用类似的东西`BOOST_STATIC_ASSERT`适用于所有这些，这样

1.  我只需要`BOOST_STATIC_ASSERT`在一个地方使用（DRY原则）
2.  在编译时而不是运行时评估一次

注意：我们可以使用我们想要的任何 C++ 技术（创建更多类、使用继承等）

我的幼稚解决方案如下所示：

```
class A { ...stuff }; BOOST_STATIC_ASSERT( sizeof(A) == 512 );
class B { ...stuff }; BOOST_STATIC_ASSERT( sizeof(B) == 512 );
class C { ...stuff }; BOOST_STATIC_ASSERT( sizeof(C) == 512 ); 
```

* * *

## 回答 #1

> 赞同：9
> 
> 时间：2009-05-27T00:05:28.433

这似乎适用于 gcc 4.0.1 和 boost 1.39：

```
 template <typename T, size_t S>
struct enforce_size
{
    enforce_size()
    {
        BOOST_STATIC_ASSERT( sizeof( T ) == S );
    }
};

class A: enforce_size<A,512> { /* stuff */ }; 

```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-05-27T00:25:32.120

由于这些类没有关系，我现在看到了这样做的方法，因为您必须明确说明要检查的女巫类型。

Nikolai N Fesissov 提出的唯一 DRY 方式来执行此操作。我正在编写一个类似的示例，并进行了一些小的修改，但总体思路是创建一个 boost::nocopy - 类似的类，它将强制子类具有给定的大小。

```
template< typename CheckedType, size_t FixedSize >
class SizeChecked // simple, no inheritance overload
{
public:
    SizeChecked()
    {
        // c++0x or compilers with static_assert() available
        //static_assert( sizeof( CheckedType ) == FixedSize, "Type size check failed!" );
        BOOST_STATIC_ASSERT( sizeof( CheckedType ) == FixedSize );
    }

};

template< typename CheckedType >
class Size512 : public SizeChecked< CheckedType, 512 > // simple, no inheritance overload
{}; 

////////////////////////////////////////////////////////////////////

class A : Size512< A > // automatically check
{
};

class B : Size512< B > // automatically check
{
    std::array< char, 512 > m_array;
};

class C : SizeChecked< C, 1 >
{
    char m_char;
};

class D : SizeChecked< D, 4 >
{
    short m_k;
    char m_u;

};

int wmain()
{
    // need instantiation to be checked !
    //A a; // will trigger the assertion at compile time
    B b; // sizeof(B) == 512 : will be fine
    C c; // sizeof(C) == 1 : will be fine
    //D d; // will fail because sizeof( short ) + sizeof( char ) != 4 !

} 
```

请注意：如果您失去继承，您仍然必须对子类进行显式检查，检查不会被继承！

顺便说一句，一种更 DRY 的可能方法是将所有静态断言放在一个地方。

# java - Hibernate 可以使用 MySQL 的“ON DUPLICATE KEY UPDATE”语法吗？

> ID：913341
> 
> 赞同：33
> 
> 时间：2009-05-26T23:49:45.017
> 
> 标签：java, mysql, hibernate, orm

MySQL 支持一种 " `INSERT ... ON DUPLICATE KEY UPDATE ...`" 语法，允许您“盲目地”插入数据库，并在存在记录时回退到更新现有记录。

当您想要快速隔离事务并且想要更新的值依赖于数据库中已有的值时，这很有帮助。

作为一个人为的例子，假设您想计算一个故事在博客上的浏览次数。使用此语法的一种方法可能是：

```
 INSERT INTO story_count (id, view_count) VALUES (12345, 1)
 ON DUPLICATE KEY UPDATE set view_count = view_count + 1 
```

这将比启动事务更有效，更有效地处理新故事登上头版时发生的不可避免的异常。

我们如何使用 Hibernate 做同样的事情或实现同样的目标？

首先，Hibernate 的 HQL 解析器会抛出异常，因为它不理解特定于数据库的关键字。事实上，HQL 不喜欢任何显式插入，除非它是“ `INSERT ... SELECT ....`”。

其次，Hibernate 将 SQL 限制为仅选择。如果您尝试调用 Hibernate 将抛出异常`session.createSQLQuery("sql").executeUpdate()`。

第三，`saveOrUpdate`在这种情况下，Hibernate 不符合要求。您的测试将通过，但如果您每秒访问的访问者超过一个，您将遇到生产失败。

我真的要颠覆Hibernate吗？

* * *

## 回答 #1

> 赞同：31
> 
> 时间：2009-05-27T01:00:08.213

你看过 Hibernate [@SQLInsert](http://docs.jboss.org/hibernate/stable/annotations/reference/en/html/entity.html#entity-hibspec-customsql)注解吗？

```
@Entity
@Table(name="story_count")
@SQLInsert(sql="INSERT INTO story_count(id, view_count) VALUES (?, ?)
 ON DUPLICATE KEY UPDATE view_count = view_count + 1" )
public class StoryCount 
```

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2013-05-17T17:58:07.373

这是一个老问题，但我遇到了类似的问题，我想我会添加到这个主题中。我需要将日志添加到现有的 StatelessSession 审计日志编写器。现有实现使用 StatelessSession，因为标准会话实现的缓存行为是不必要的开销*，*我们不希望我们的休眠侦听器触发审计日志写入。这个实现是关于在没有交互的情况下实现尽可能高的写入性能。

但是，新的日志类型需要使用 insert-else-update 类型的行为，我们打算使用事务时间更新现有日志条目作为“标记”行为类型。在 StatelessSession 中，不提供 saveOrUpdate()，因此我们需要手动实现 insert-else-update。

鉴于这些要求：

您*可以*通过自定义 sql-insert 为 hibernate 持久对象使用 mysql“insert ... on duplicate key update”行为。您可以通过注释（如上面的答案）或通过 sql-insert 实体和休眠 xml 映射来定义自定义 sql-insert 子句，例如：

```
<class name="SearchAuditLog" table="search_audit_log" persister="com.marin.msdb.vo.SearchAuditLog$UpsertEntityPersister">

    <composite-id name="LogKey" class="SearchAuditLog$LogKey">
        <key-property
            name="clientId"
            column="client_id"
            type="long"
        />
        <key-property
            name="objectType"
            column="object_type"
            type="int"
        />
        <key-property
            name="objectId"
            column="object_id"
        />
    </composite-id>
    <property
        name="transactionTime"
        column="transaction_time"
        type="timestamp"
        not-null="true"
    />
    <!--  the ordering of the properties is intentional and explicit in the upsert sql below  -->
    <sql-insert><![CDATA[
        insert into search_audit_log (transaction_time, client_id, object_type, object_id)
        values (?,?,?,?) ON DUPLICATE KEY UPDATE transaction_time=now()
        ]]>
    </sql-insert> 
```

原始海报专门询问了MySQL。当我用 mysql 实现 insert-else-update 行为时，我在执行 sql 的“更新路径”时遇到异常。具体来说，mysql 报告在仅更新 1 行时更改了 2 行（表面上是因为删除了现有行并插入了新行）。有关该特定功能的更多详细信息，请参阅[此问题](https://stackoverflow.com/questions/3747314/why-are-2-rows-affected-in-my-insert-on-duplicate-key-update)。

因此，当更新返回 2 倍受休眠影响的行数时，休眠将抛出 BatchedTooManyRowsAffectedException，将回滚事务并传播异常。即使您要捕获异常并处理它，到那时事务已经回滚了。

经过一番挖掘，我发现这是休眠使用的实体持久性的问题。在我的例子中，hibernate 使用的是 SingleTableEntityPersister，它定义了一个期望，即更新的行数应该与批处理操作中定义的行数相匹配。

使此行为起作用所需的最后调整是定义一个自定义持久化器（如上面的 xml 映射所示）。在这种情况下，我们所要做的就是扩展 SingleTableEntityPersister 并“覆盖”插入期望。例如，我只是将这个静态类添加到持久性对象上，并将其定义为休眠映射中的自定义持久性：

```
public static class UpsertEntityPersister extends SingleTableEntityPersister {

    public UpsertEntityPersister(PersistentClass arg0, EntityRegionAccessStrategy arg1, SessionFactoryImplementor arg2, Mapping arg3) throws HibernateException {
        super(arg0, arg1, arg2, arg3);
        this.insertResultCheckStyles[0] = ExecuteUpdateResultCheckStyle.NONE;
    }

} 
```

花了很长时间挖掘休眠代码才能找到这个 - 我无法在网上找到任何主题来解决这个问题。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2014-09-21T17:05:59.607

如果您使用的是 Grails，我发现此解决方案不需要将您的 Domain 类移动到 JAVA 世界并使用 @SQLInsert 注释：

1.  创建自定义休眠配置
2.  覆盖 PersistentClass 映射
3.  使用 ON DUPLICATE KEY 将您的自定义 INSERT sql 添加到您想要的持久类中。

例如，如果您有一个名为 Person 的域对象，并且您希望 INSERTS 成为 INSERT ON DUPLICATE KEY UPDATE，您将创建如下配置：

```
public class MyCustomConfiguration extends GrailsAnnotationConfiguration {

    public MyCustomConfiguration() {
        super();

        classes = new HashMap<String, PersistentClass>() {
            @Override
            public PersistentClass put(String key, PersistentClass value) {
                if (Person.class.getName().equalsIgnoreCase(key)) {
                    value.setCustomSQLInsert("insert into person (version, created_by_id, date_created, last_updated, name) values (?, ?, ?, ?, ?) on duplicate key update id=LAST_INSERT_ID(id)", true, ExecuteUpdateResultCheckStyle.COUNT);
                }
                return super.put(key, value);
            }
        };
    } 
```

并将其添加为 DataSource.groovy 中的 Hibernate 配置：

```
dataSource {
    pooled = true
    driverClassName = "com.mysql.jdbc.Driver"
    configClass = 'MyCustomConfiguration'
} 
```

请注意使用 LAST_INSERT_ID 时要小心，因为如果执行的是 UPDATE 而不是 INSERT，则不会正确设置，除非您在语句中明确设置它，例如 id=LAST_INSERT_ID(id)。我还没有检查 GORM 从哪里获取 ID，但我假设它在某个地方使用 LAST_INSERT_ID。

希望这可以帮助。

# .net - 在 .net petshop 4 中使用 log4net

> ID：913343
> 
> 赞同：0
> 
> 时间：2009-05-26T23:50:39.320
> 
> 标签：.net, logging, log4net

我有一个关于 log4net 使用在 .net petshop 4 应用程序中记录信息的问题。如何使用它来记录与消息大小和记录发生时间相关的信息。请帮助！我尝试使用视觉打开 .net petshop c# express edition 2008 和visual web developer 2008 但是这两种情况下解决方案项都不可用。请建议如何打开这个应用程序

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-05-27T06:53:55.943

假设 log4net 配置在应用程序 web.config 中完成，您应该能够格式化日志记录以包括日志时间。根据[PatternLayout](http://logging.apache.org/log4net/release/sdk/log4net.Layout.PatternLayout.html)转换模式，您可以为此使用 %date 说明符。

至于消息大小，您是在寻找消息字符串的长度吗？

# c++ - 如何删除 VS 警告 C4091: 'typedef' : 在没有声明变量时在 'SPREADSHEET' 左侧被忽略

> ID：913344
> 
> 赞同：15
> 
> 时间：2009-05-26T23:50:54.327
> 
> 标签：c++, compiler-construction, struct, typedef, warnings

此警告在我的代码中由同一个声明多次触发，内容如下：

```
// Spreadsheet structure
typedef struct SPREADSHEET
{    
      int ID;               // ID of the spreadsheet    
      UINT nLines;          // Number of lines

      void CopyFrom(const SPREADSHEET* src)
      {
           ID = src->ID;
           nLines = src->nLines;
      }
}; 
```

我不想关掉那个警告，

而是更改代码，以免出现警告！

注意：我不想在这里声明任何变量（它是一个头文件），只定义结构'SPREADSHEET'应该包含的内容......

* * *

## 回答 #1

> 赞同：35
> 
> 时间：2009-05-26T23:55:42.010

删除`typedef`。这是声明结构的 C 方式，C++ 会自动为您完成。

* * *

## 回答 #2

> 赞同：7
> 
> 时间：2009-05-26T23:55:38.373

您需要在终止之前添加一些标识符`;`，例如：

```
typedef struct BLAH { ... } BLAH; 
```

* * *

## 回答 #3

> 赞同：5
> 
> 时间：2009-05-27T00:05:26.437

只需删除“ `typedef`”。您声明了一个新结构，并且`typedef`没有使用关键字。您将使用`typedef`为现有类型定义新名称，如下所示：

```
typedef int number; 
```

* * *

## 回答 #4

> 赞同：2
> 
> 时间：2011-02-09T05:42:57.490

是的，右大括号`BLAH` *后*的大括号对于使其`typedef`有效很重要。您可以`SPREADSHEET`从当前位置删除 并将其保留在`}`和之间`;`。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2015-08-11T20:13:10.997

我对这个警告的解释是编译器表明该`typedef`关键字是不必要的，因为没有声明变量。因此，如果代码的目的是简单地声明 a`struct`是`typedef`多余的。

# ruby-on-rails - 这个 Rails 文件存储在哪里？db/development.sqlite3

> ID：913345
> 
> 赞同：10
> 
> 时间：2009-05-26T23:51:21.520
> 
> 标签：ruby-on-rails, database, sqlite, configuration

我正在尝试查找 rails 创建的 sqlite 数据库文件。

抱歉，如果这是一个愚蠢的问题，但该文件存储在哪个文件夹中？

我查看了 Rails 项目中的所有文件夹，但找不到。

我的`database.yml`：

```
 development:
      adapter: sqlite3
      database: db/development.sqlite3
      pool: 5
      timeout: 5000 
```

* * *

## 回答 #1

> 赞同：21
> 
> 时间：2009-05-26T23:53:11.937

它在 RAILS_ROOT/db/development.sqlite3

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2011-08-01T11:28:18.017

在以下目录中给出“scaffold”命令后，您可以找到您的数据库文件如果您在项目文件夹中然后转到“DB”文件夹，那么您可以看到“development.sqlite3”文件这是sqlite数据库文件

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2009-05-27T21:51:46.083

FWIW 如果您尚未完成 rake db:create，则该文件可能不存在。

* * *

## 回答 #4

> 赞同：-1
> 
> 时间：2012-04-04T22:19:54.617

`sqlite://db/development.sqlite3`

# ruby - 在 Ruby 中创建属性别名的最佳方法是什么？

> ID：913349
> 
> 赞同：20
> 
> 时间：2009-05-26T23:53:01.033
> 
> 标签：ruby

在Ruby中为实例属性创建别名的最佳方法是什么（我没有使用rails或任何ruby gem，只是Ruby）。
例如，给定下面的类，如何为`:student_name`属性访问器创建别名？

```
class Student
  attr_accessor :student_name
  alias :name :student_name    #wrong
end

s = Student.new
s.student_name = "Jordan"
puts s.name  # --> Jordan
s.name = "Michael" # --> NoMethodError: undefined method `name=' for #<Student:0x572394> ... 
```

多谢你们！

* * *

## 回答 #1

> 赞同：32
> 
> 时间：2009-05-26T23:56:13.380

添加

```
alias :name :student_name    # not wrong, only for getter
alias :name= :student_name=  # add this for setter
alias :name? :student_name?  # add this for boolean 
```

* * *

## 回答 #2

> 赞同：18
> 
> 时间：2017-01-30T08:06:39.347

**对于导轨**

`alias_attribute new_name, old_name`

来源[http://api.rubyonrails.org/classes/ActiveModel/AttributeMethods/ClassMethods.html#method-i-alias_attribute](http://api.rubyonrails.org/classes/ActiveModel/AttributeMethods/ClassMethods.html#method-i-alias_attribute)

**用例：**当您很可能希望在不更改架构且不破坏现有功能的情况下更改属性名称

* * *

## 回答 #3

> 赞同：13
> 
> 时间：2009-05-27T00:40:45.070

正如 John 所指出的，您需要同时为读者和作者设置别名。这是 Ruby，很容易定义自己的别名方法来为您处理。

```
class Module
  def alias_attr(new_attr, original)
    alias_method(new_attr, original) if method_defined? original
    new_writer = "#{new_attr}="
    original_writer = "#{original}="
    alias_method(new_writer, original_writer) if method_defined? original_writer
  end
end 
```

# iphone - iPhone游戏开发

> ID：913352
> 
> 赞同：5
> 
> 时间：2009-05-26T23:54:01.967
> 
> 标签：iphone

人们主要使用什么来构建 iPhone 游戏？我正在学习 iPhone 编程。目前，我正在观看所有 stanford 的 vidcast，做任务，并阅读开始的 iphone development apress book。我想开始构建游戏，并想知道开发人员是使用 opengl 构建所有东西还是使用预先存在的游戏引擎？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-05-26T23:58:29.570

我相信大多数人只是在使用 Apple 的 API。除此之外，我认为[cocos2d](http://cocos2d.org/)很受欢迎。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2009-05-26T23:58:34.157

取决于应用程序的图形密集程度。

如果需要大量图形，请使用预先存在的引擎。

如果没有，许多人使用 OpenGL ES

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2009-05-26T23:59:35.760

你可以在这里找到一堆建议：

[学习iphone游戏开发](https://stackoverflow.com/questions/720901/learning-iphone-game-development)

[您建议我在创建 iPhone 游戏之前学习哪些技术/概念？](https://stackoverflow.com/questions/601604/which-technologies-concepts-do-you-suggest-i-learn-before-creating-an-iphone-game)

* * *

## 回答 #4

> 赞同：2
> 
> 时间：2009-05-28T15:47:26.320

我使用了统一。有很多很棒的游戏（甚至前 10 名）都使用了它。你甚至不需要知道objective-C。代码使用 C#、Javascript 或 boo 以脚本语言编写，然后编译。它是昂贵的。使用独立许可证来制作 iPhone 应用程序至少要花费 600 美元。unity3d.com

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2009-05-28T15:55:34.040

很难用所有的 API 来学习和几个好的游戏示例（尤其是如果你是 Objective-C 的新手）来加快编写游戏的速度。我最终找到了旧的 crashlander 源，自从 Apple 撤下它后，它就很难找到了。

大概有六本 iPhone 游戏编程书籍正在筹备中。在那之前，学习曲线非常陡峭。

我建议从基于 OpenGL 2D sprite 的游戏开始。首先学习 OpenGL ES，触摸系统，然后是音频系统。

# iphone - 在 Xcode 中切换构建配置时链接的静态库变红是什么意思？

> ID：913354
> 
> 赞同：6
> 
> 时间：2009-05-26T23:55:20.607
> 
> 标签：iphone, cocoa, cocoa-touch, xcode

我觉得标题很清楚。我已经遇到过两次了。

第一次它表明有问题，我的项目无法编译。第二次一切仍然有效。

如果当它变红时我的代码仍然可以构建，这只是侥幸吗？

* * *

## 回答 #1

> 赞同：14
> 
> 时间：2009-05-27T00:56:13.337

文件和组列表中变为红色的任何内容都表示缺少文件或目录。这不一定引起关注，因为在许多情况下，该文件预计将作为构建过程的一部分进行构建。

对于链接的静态库，您可能依赖第二个目标或项目来构建静态库。当您更改构建配置时，Xcode 注意到它尚未构建，因此将其显示为红色。当您构建项目并且依赖库本身构建时，它再次变黑。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-05-27T18:17:06.187

> 第一次它表明有问题，我的项目无法编译。第二次一切仍然有效。

这表明您没有正确设置构建依赖项，每次进行干净构建时都会对您不利。您需要使需要静态库的目标对构建该库的目标具有显式的构建依赖关系。

# c# - 如何在 C# 中订阅其他类的事件？

> ID：913374
> 
> 赞同：21
> 
> 时间：2009-05-27T00:02:57.783
> 
> 标签：c#, events, .net-2.0, event-handling

一个简单的场景：引发事件的自定义类。我希望在表单中使用此事件并对其做出反应。

我怎么做？

请注意，表单和自定义类是单独的类。

* * *

## 回答 #1

> 赞同：36
> 
> 时间：2009-05-27T01:50:50.873

```
public class EventThrower
{
    public delegate void EventHandler(object sender, EventArgs args) ;
    public event EventHandler ThrowEvent = delegate{};

    public void SomethingHappened() => ThrowEvent(this, new EventArgs());
}

public class EventSubscriber
{
    private EventThrower _Thrower;

    public EventSubscriber()
    {
        _Thrower = new EventThrower();
        // using lambda expression..could use method like other answers on here

        _Thrower.ThrowEvent += (sender, args) => { DoSomething(); };
    }

    private void DoSomething()
    {
       // Handle event.....
    }
} 
```

* * *

## 回答 #2

> 赞同：6
> 
> 时间：2009-05-27T00:07:18.117

在您的表格内：

```
private void SubscribeToEvent(OtherClass theInstance) => theInstance.SomeEvent += this.MyEventHandler;

private void MyEventHandler(object sender, EventArgs args)
{
    // Do something on the event
} 
```

您只需像订阅表单中的事件一样订阅其他类的事件。要记住的三个重要事项：

1.  您需要确保您的方法（事件处理程序）具有适当的声明以匹配另一个类上的事件的委托类型。

2.  其他类的事件需要对您可见（即：公共或内部）。

3.  订阅类的有效实例，而不是类本身。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-05-27T00:08:24.323

假设您的事件由 EventHandler 处理，则此代码有效：

```
protected void Page_Load(object sender, EventArgs e)
{
    var myObj = new MyClass();
    myObj.MyEvent += new EventHandler(this.HandleCustomEvent);
}

private void HandleCustomEvent(object sender, EventArgs e)
{
    // handle the event
} 
```

如果您的“自定义事件”需要一些其他签名来处理，您将需要使用该签名。

# javascript - Javascript可以切换边框吗？

> ID：913378
> 
> 赞同：1
> 
> 时间：2009-05-27T00:05:04.300
> 
> 标签：javascript, html, css

我正在尝试使用 JS 来切换框架的 frameborder 属性。这是我的测试用例：

```
<html>
  <head>
  <script type="text/javascript">
    function off() {
      var f1 = document.getElementById("f1");
      var f2 = document.getElementById("f2");
      alert ("before, frame f1 had frameBorder=" + f1.frameBorder);
      f1.frameBorder = "0";
      alert ("after, frame f1 has frameBorder=" + f1.frameBorder);
      alert ("before, frame f2 had frameBorder=" + f2.frameBorder);
      f2.frameBorder = "0";
      alert ("after, frame f2 has frameBorder=" + f2.frameBorder);
    }
  </script>
  </head>

  <frameset cols="50%, 50%" name="fs">
    <frame frameborder="1" src="http://bikeshed.com" id="f1" name="f1" />
    <frame frameborder="1" src="http://bikeshed.com" id="f2" name="f2" />
  </frameset>
</html> 
```

我在 Firefox 中加载它，打开 Firebug，然后在控制台中输入“off()”。它运行我的函数，报告两个框架边框都设置为“1”，现在设置为“0”。但是，框架边框没有消失。

我正在尝试做的事情可能吗？如果是这样，怎么做？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-05-27T00:39:10.033

使用 iframes 而不是框架似乎有效。您必须在 CSS 上做一些工作才能完成框架集的错觉。

```
<!DOCTYPE html PUBLIC "-//W3C//DTD HTML 4.01//EN"
   "http://www.w3.org/TR/html4/strict.dtd">

<html lang="en">
<head>
  <title>Frame Test</title>
  <script language="javascript">
    var off = function () {
      document.getElementById('frame1').style.borderWidth = 0;
      alert('off');
    }
  </script>

</head>
<body style="margin: 0; padding: 0">
<table style="width: 100%; height: 100%" cols="2">
<tr>
<td><iframe id="frame1" src="http://www.google.com" style="margin: 0; width: 100%; height: 100%"></iframe></td>
<td><iframe id="frame2" src="http://www.google.com" style="margin: 0; width: 100%;  height: 100%"></iframe></td>
</tr>
</table>

</body>
</html> 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-05-27T00:11:58.420

对于某些属性，您需要使用[setAttribute](https://developer.mozilla.org/en/DOM/element.setAttribute)。尝试

```
f1.setAttribute('frameborder', 0); 
```

# ruby - 与框架无关的 Ruby 后台工作程序库的最佳选择是什么？

> ID：913379
> 
> 赞同：0
> 
> 时间：2009-05-27T00:05:18.667
> 
> 标签：ruby, backgroundworker, amqp, daemons

我正在使用 Ruby 和 Sinatra 为 iPhone 应用程序构建一个简单的食谱搜索引擎，并将 RabbitMQ 用于我的消息队列。我环顾四周，为后台进程找到了许多不同的实现选择，但其中大多数要么实现自定义消息队列算法，要么作为 Rails 插件运行。

就可以与 RabbitMQ 很好地配合使用的与框架无关的高质量工作库而言，有哪些内容？

在编写工作代码时，是否有任何我应该牢记的最佳实践，除了显而易见的：

```
# BAD, don't do this!
begin
  # work
rescue Exception
end 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-05-27T14:06:13.637

我正在使用 Beanstalk 并使用[daemons gem](http://daemons.rubyforge.org/)编写了我自己的守护程序。[Daemon kit](http://github.com/kennethkalmer/daemon-kit/tree/master)是一个新项目，但尚未实现队列循环。如果它符合您的需求，您也可以查看[Nanite ，它与框架无关。](http://github.com/ezmobius/nanite/tree/master)

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-05-29T18:01:46.470

我最终写[了我自己的图书馆](http://github.com/sporkmonger/chaingang/tree/master)，在一阵无法控制的牦牛剃须中。守护程序套件是正确的总体思路，但对于我的需求来说太重了。我不希望我的每个守护进程看起来像一个完整的 Rails 应用程序。我最终会得到至少 3 个守护进程，那将是一大堆目录。daemons gem 有一个糟糕的 API，虽然我很想将它抽象出来，但我意识到自己管理 fork 可能更容易，所以我就是这样做的。

API 如下所示：

```
require "rubygems"
require "chaingang"

class Worker
  def setup
    # Set up connections here
  end

  def teardown
    # Tear down connections here
  end

  def call
    # Do some work
    sleep 1
  end
end
ChainGang.prepare(Worker.new) 
```

然后您只需使用包含的 rake 任务来启动/停止/重新启动或检查状态。我从 Rack playbook 中获取了一个页面：任何实现该`call`方法的东西都是公平的游戏，作为 ChainGang.prepare 和 ChainGang.work 方法的参数，所以 a`Proc`是一个有效的工作对象。

比起使用其他东西，我花了更长的时间来构建它，但我有一个模糊的怀疑，即从长远来看它会得到回报。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-05-30T05:20:05.650

查看 nanite（用 Ruby 编写），这是一个在 rabbitmq 上编写的年轻项目。

github.com/ezmobius/nanite/tree/master

# c++ - 重载 new 和 delete 以查找内存泄漏时如何处理静态对象？

> ID：913386
> 
> 赞同：0
> 
> 时间：2009-05-27T00:09:29.517
> 
> 标签：c++, visual-c++

我试图通过全局重载 new 和 delete 以进行调试构建并维护已分配块的列表来检测内存泄漏。这可行，但会错误地报告某些静态对象的泄漏。例如，静态 std::vector 本身不是使用 new 和 delete 分配的，但它的内部缓冲区是分配的。由于我的检测代码在主函数返回之前运行，因此尚未调用这些对象的析构函数，因此它们尚未删除其缓冲区，这显示为“泄漏”。

我发现的一种解决方法是在检查泄漏之前删除并放置新的每个静态对象以清除它们的缓冲区：

```
std::vector<int> f;

f.~std::vector<int>();
new (&f) std::vector<int>(); 
```

这真的很丑陋，包括不需要的清理代码似乎很糟糕。有什么方法可以让我的代码在静态数据被破坏后运行？（即使它是特定于 Microsoft 的）

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-05-27T00:13:18.260

您需要查看`std::allocator`- 几乎所有 STL 容器的第二个模板参数。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-05-27T00:34:36.610

编写一个函数来清空分配的块列表。在所有静态初始化之后，但在您的程序开始分配您想要跟踪的任何内容之前调用它。main() 中的第一件事应该这样做。当然，您仍然会看到已调整大小的静态向量的泄漏，因此您可能希望将它们保留得更大，以便在泄漏检测模式下开始。如果静态向量随着时间的推移无情地增长，那么您可能想知道这一点并将其视为泄漏，即使它是静态的。

编辑以回应评论：

例如，不是在关闭时销毁所有全局变量的中央代码：

```
template<typename T> 
class Reserve {
     Reserve(T &t, typename T::size_type size) {
         t.reserve(size);
     }
};

static std::vector<int> foo;
static Reserve<std::vector<int> > foo_r(foo, 50);

static std:string bar;
static Reserve<std::string> bar_r(bar, 256); 
```

您可能可以使用函数模板做一些事情，这样类型推断就无需重复类型。怎么样：

```
template<typename T>
int reserve(T &t, typename T::size_type size) {
    t.reserve(size);
    return 0;
}

static std::vector<int> foo;
static int foo_r = reserve(foo, 50);

static std:string bar;
static int bar_r = reserve(bar, 256); 
```

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2009-05-27T01:57:06.740

将所有泄漏检测代码放在另一个单独的 DLL 中。然后确保要检查泄漏的代码取决于 DLL。这让加载程序可以确保“泄漏检查 DLL”在其他所有操作之前被初始化，并且在其他所有操作之后也被卸载。这样做将确保您的泄漏检查代码在所有其他代码被卸载（并调用析构函数）之后运行。

这是我在创建[Visual Leak Detector](http://www.codeproject.com/KB/applications/visualleakdetector.aspx)时使用的技术，它似乎运行良好。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2009-05-27T00:14:17.930

您可以尝试使用[atexit](http://www.cplusplus.com/reference/clibrary/cstdlib/atexit/)处理程序。

# ruby - 测试集合索引类型（即 [] 方法的参数）

> ID：913387
> 
> 赞同：0
> 
> 时间：2009-05-27T00:09:36.787
> 
> 标签：ruby

如果集合支持字符串索引，那么一种有效的、rubyesque 的测试方法是什么？

长版：我想让我的一类人标准化某些值。为此，实例将一组值作为其“值”属性。我想`values=`同时接受列表（整数索引集合，包括内置数组）和关联数组（对象索引集合，例如哈希）。如果传递一个列表，它会通过反转键和值将列表转换为关联数组。这意味着该方法需要区分列表和关联数组。它还应该适用于任何索引集合，而不仅仅是 Array 和 Hash 的后代，因此任何类型的嗅探集合类型的类型都被认为是丑陋和错误的。类型嗅探索引类型，但是...

目前，我使用异常来区分，但我更喜欢将异常用于异常情况，而不是一般的控制结构。这只是个人喜好，我不太喜欢。如果例外是解决此问题的红宝石方法，请告诉我。

```
def values=(values)
    begin
        values['']
        @values = values.dup
    rescue TypeError
        @values = Hash[ values.zip((0..values.length-1).to_a) ]
    end
    @values.each_value { |v| @values[v] = v}
end 
```

注意：一个完整​​的解决方案将采用 的传递闭包`values`，但现在我可以假设 的键和值`values`来自不同的域。

这一切的重点是启用如下代码：

```
toggle.values = [:off, :on]
toggle.normalise(:off) == 0
toggle.normalise(1) == 1

bool.values = {:off => 0, :false => 0, :no => 0,
               :on => 1,  :true => 1,  :yes => 1}
bool.normalise(:yes) == 1
bool.normalise(0) == 0 
```

PS。这是针对个人项目的，因此优雅和 Ruby 方式至关重要。我正在寻找有趣的方法，特别是如果它们说明了一个有趣的概念（例如“异常可以用作行为测试”）。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-05-27T13:46:16.187

鸭子打字来救援！

```
 hash = if collection.respond_to? :to_hash
          collection.to_hash
        elsif collection.respond_to? :to_ary
          collection.to_ary.inject({}) { |_hash,(key,value)| _hash.merge!(key => value) }
        else if collection.respond_to? :inject
          collection.inject({}) { |_hash,(key,value)| _hash.merge!(key => value) }
        else
          raise ArgumentError, "not a collection type I understand"
        end
 if want_dupe and collection.object_id == hash.object_id
    hash = hash.dup
 end 
```

# c++ - 无法捕获异常！

> ID：913396
> 
> 赞同：4
> 
> 时间：2009-05-27T00:14:37.760
> 
> 标签：c++, python, exception, swig

我正在使用 swig 用 python 包装一个 C++ 库中的类。它总体上可以工作，但是从库中抛出了一个异常，我似乎无法在 swig 界面中捕获它，所以它只会使 python 应用程序崩溃！

PyMonitor.cc 类描述了所需类 Monitor 的 swig 接口。如果连接失败，Monitor 的构造函数会抛出异常。我想在 PyMonitor 中处理这个异常，例如：

PyMonitor.cc：

```
#include "Monitor.h"  

// ...  

bool PyMonitor::connect() {  
    try {  
        _monitor = new Monitor(_host, _calibration);  
    } catch (...) {  
        printf("oops!\n");  
    }  
}

// ... 
```

但是，connect() 方法永远不会捕获异常，我只是得到一个“在抛出 ... 后调用终止”错误，然后程序中止。

我对 swig 了解不多，但在我看来，这一切都很好 C++，异常应该在终止程序之前传播到 connect() 方法。

有什么想法吗？

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2011-09-16T11:21:28.097

如果要在那里解析异常，则必须将异常转发给 Python。请参阅[SWIG 文档](http://www.swig.org/Doc1.3/Customization.html#exception)。为了转发异常，您只需在 SWIG 接口 (.i) 文件中添加一些代码。基本上，它可以在 .i 文件中的任何位置。

此处应指定所有类型的异常，并且 SWIG**仅**捕获列出的异常类型（在本例中为 std::runtime_error、std::invalid_argument、std::out_of_range），所有其他异常都作为未知异常被捕获（并因此被转发正确！）。

```
// Handle standard exceptions.
// NOTE: needs to be before the %import!
%include "exception.i"
%exception
{
 try
 {
   $action
 }
 catch (const std::runtime_error& e) {
   SWIG_exception(SWIG_RuntimeError, e.what());
 } 
 catch (const std::invalid_argument& e) {
   SWIG_exception(SWIG_ValueError, e.what());
 }
 catch (const std::out_of_range& e) {
   SWIG_exception(SWIG_IndexError, e.what());
 }
 catch (...) { 
   SWIG_exception(SWIG_RuntimeError, "unknown exception");
 } 
} 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-05-27T01:07:33.393

我不熟悉 swig，也不熟悉同时使用 C++ 和 Python，但如果这是在最新版本的 Microsoft Visual C++ 下，那么`Monitor`该类可能会抛出 C 结构化异常，而不是 C++ 类型的异常。C 结构化异常不会被 C++ 异常处理程序捕获，即使是`catch(...)`一个。

如果是这种情况，您可以使用`__try/__except`关键字（而不是`try/catch`），或使用该`_set_se_translator`函数将 C 结构化异常转换为 C++ 类型异常。

（如果我没记错的话，旧版本的 MSVC++ 将 C 结构化异常视为 C++`int`类型，并被 C++ 处理*程序捕获。）*

如果这*不在*Microsoft Visual C++ 下，那么我不确定这是怎么发生的。

编辑：既然你说这不是 MSVC，也许其他东西在你的代码得到它之前捕获异常（并终止程序），或者你的 catch 块中可能有一些东西抛出另一个异常？如果没有更多细节可以处理，这些是我能想到的唯一会导致这些症状的情况。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2009-05-28T07:18:07.440

监视器直接或间接调用的函数可能`constructor`违反其异常规范并且不允许`std::bad_exception`被抛出。如果您没有替换用于捕获此问题的标准函数，那么它将解释您所看到的行为。

要测试这个假设，您可以尝试定义自己的处理程序：

```
void my_unexpected()
{
    std::cerr << "Bad things have happened!\n";
    std::terminate();
}

bool PyMonitor::connect() {  

    std::set_unexpected( my_unexpected );

    try {  
        _monitor = new Monitor(_host, _calibration);  
    } catch (...) {  
        printf("oops!\n");  
    }  
} 
```

如果你得到“坏事发生了！” 错误消息然后您已确认是这种情况，但不幸的是，您可以做的可能不多。如果您“幸运”，您可能会抛出`my_unexpected`当前失败的函数的异常规范所允许的异常，但无论如何您的意外处理程序都不允许正常终止。它必须抛出或以其他方式终止。

要解决此问题，您确实需要进入被调用代码并更正它以便不违反异常规范，或者通过修复规范本身或修复代码以便它不会抛出意外的异常.

另一种可能性是在堆栈展开期间抛出了一个异常，该异常是由抛出的原始异常引起的。这也会导致进程终止。在这种情况下，虽然您可以替换标准终止功能，但您别无选择，只能中止程序。终止处理程序不允许抛出或返回，它必须终止程序。

# c++ - find_if 函数构建问题

> ID：913397
> 
> 赞同：1
> 
> 时间：2009-05-27T00:14:57.853
> 
> 标签：c++, stl

我正在尝试在 1 文件 .cpp 文件中构建以下代码块：

```
#include <iostream>

#include <algorithm>
using namespace std;

class test
{

public:

    int a[10];
    int index;

    test();
    ~test();
    bool equals(int p);
    void search();
};

test::test()
{
    int temp[10] = {4, 9, 5, 6, 9, 10, 9, 255, 60, 0};

    memcpy(a, temp, sizeof(temp));

    index = -1;
}

bool test::equals(int p)
{
    return p == 9;
}

void test::search()
{
    int* p = std::find_if(a, a+10, &test::equals);
    while (p != a+10)
    {
        cout<< *p;
        index = p - a;
        p = std::find_if(p+1, a+10, &test::equals);
    }
}

int main(int argc, char *argv[])
{
    test object;

    object.search();

    return 0;
} 
```

我收到如下所示的错误，我不确定在类的成员方法中使用 find_if 函数时到底发生了什么，并且每当我这样做时都会收到此错误。

```
1>c:\program files\microsoft visual studio 8\vc\include\algorithm(87) : 错误 C2064: 术语不计算为采用 1 个参数的函数
1> c:\program files\microsoft visual studio 8\vc\include\algorithm(96) : 请参阅正在编译的函数模板实例化 '_InIt std::_Find_if(_InIt,_InIt,_Pr)' 的参考
1> 与
1> [
1> _InIt=int *,
1> _Pr=bool (__thiscall test::* )(int)
1>]
1> c:\testprogram\nomfc\main.cpp(32) : 参见正在编译的函数模板实例化 '_InIt std::find_if(_InIt,_InIt,_Pr)' 的参考
1> 与
1> [
1> _InIt=int *,
1> _Pr=bool (__thiscall test::* )(int)
1>]

```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-05-27T00:24:59.377

`test::equals`是一个成员函数，它的指针语法与普通函数指针不同。特别是，要调用它，`find_if`需要一个它没有的类型的对象`test`（例如，它不会自动调用它 on `this`，我猜这就是你的想法）。

您可以将函数移到`equals`类之外`test`，它应该可以工作。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-05-27T00:27:52.037

该`find_if`函数需要一个可作为没有参数的函数调用的对象。这类似于自由函数、函数对象或静态类函数。您传入的`equals`成员函数的地址不是这些。您可以通过将`equals`函数设为自由函数或静态函数来解决此问题，因为它不需要`test`实例的任何成员。

```
// static
class test
{
  public:
    static bool equals(int p); // etc
};
int* p = std::find_if(a, a+10, &test::equals);

// free
bool equals(int p)
{
    return p == 9;
}
int* p = std::find_if(a, a+10, equals); 
```

如果您的真实代码示例要求它是成员函数，那么您需要传入一个函数对象，该对象充当类实例的闭包。我喜欢为此使用 Boost 绑定方法，但也有其他方法。

```
int* p = std::find_if(a, a+10, boost::bind(&test::equals, this, _1)); 
```

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2009-05-27T00:49:08.860

```
int *p = find_if(a, a+10, bind1st(mem_fun(&test::equals), this)); 
```

或者更好的是，去掉那个`test::equals()`成员函数，然后

```
int *p = find_if(a, a+10, bind2nd(equals(), 9)); 
```

其中 equals 实际上是`std::equals()`在 header 中定义的二进制函子`<functional>`。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2009-05-27T00:28:58.823

第三个参数`find_if`必须是一个（指向一个）函数或函子，它采用一个参数，而不是您正在使用的（指向一个）实例方法。例如，一个合适的仿函数可能是（大致改编自 [this thread][1]）：

```
template <typename PType, typename ArgType>
class is_good_test : unary_function<PType, bool>
{ public:
is_good_test(const ArgType & arg) : _val(arg) { }
~is_good_test() { }

bool operator()(const PType p) const
{
return p->equals(_val);
}

private:
ArgType _val;
}; 
```

它可以让你做这样的电话：

```
std::find_if(a, a+10, is_good_test<test*, int>(10))

  [1]: http://www.velocityreviews.com/forums/t288980-functors-and-stl-findif.html 
```

# c# - 只读是否有任何运行时开销？

> ID：913400
> 
> 赞同：19
> 
> 时间：2009-05-27T00:17:19.143
> 
> 标签：c#, performance, readonly, immutability

出于某种原因，我一直假设`readonly`字段具有与之相关的开销，我认为这是 CLR 跟踪`readonly`字段是否已初始化。这里的开销将是一些额外的内存使用来跟踪状态并在分配值时进行检查。

也许我假设这是因为我不知道一个`readonly`字段只能在构造函数内或字段声明本身内初始化，并且没有运行时检查，您将无法保证它不会被多次分配方法。但是现在我知道了，C# 编译器可以很容易地对其进行静态检查，对吧？是这样吗？

另一个原因是我读到使用 对`readonly`性能有“轻微”影响，但他们从未提出过这种说法，我找不到关于这个主题的信息，因此我提出了问题。我不知道除了运行时检查之外还有什么其他的性能影响。

第三个原因是我看到它`readonly`在编译后的 IL 中保留为`initonly`，那么如果`readonly`C# 编译器保证该字段永远不会分配给构造函数还是声明？

另一方面，我发现您可以通过反射设置 a 的值，而 CLR 不会抛出异常，如果是运行时检查`readonly int`，这是不可能的。`readonly`

所以我的猜测是：“只读”只是一个编译时特性，任何人都可以确认/否认这一点吗？如果是，那么将这些信息包含在 IL 中的原因是什么？

* * *

## 回答 #1

> 赞同：16
> 
> 时间：2009-05-27T01:06:26.953

您必须从与访问修饰符相同的角度来看待它。访问修饰符存在于 IL 中，但它们真的是运行时检查吗？(1) 我不能在编译时直接分配私有字段，(2) 我可以使用反射来分配它们。到目前为止，似乎没有运行时检查，例如*readonly*。

但是让我们检查访问修饰符。请执行下列操作：

1.  使用公共类 C 创建程序集 A.dll
2.  创建一个引用 A.dll 的程序集 B.exe。B.exe 使用 C 类。
3.  构建两个程序集。运行 B.exe 工作正常。
4.  重建 A.dll，但将 C 类设置为内部。替换 B.exe 目录中的 A.dll。

现在，运行 B.exe 会引发运行时异常。

访问修饰符也存在于 IL 中，对吗？那么他们的目的是什么？目的是引用 .Net 程序集的其他程序集需要知道它们被允许访问和不允许访问的内容，包括编译时和运行时。

*Readonly 在 IL 中似乎有类似的目的*。它告诉其他程序集是否可以写入特定类型的字段。但是，*readonly* **似乎没有**我上面的示例中显示的访问修饰符相同的运行时检查。似乎 readonly 是编译时检查，不会发生在运行时。在此处查看性能示例：[只读性能与 const](http://dotnetperls.com/Content/readonly-Field.aspx)。

同样，这并不意味着 IL 没有用。IL 确保首先发生编译时错误。请记住，当您构建时，您不是针对代码进行构建，而是针对程序集进行构建。

* * *

## 回答 #2

> 赞同：7
> 
> 时间：2009-05-27T01:11:06.990

如果您使用的是标准的实例变量，readonly 的执行几乎与普通变量相同。添加的 IL 成为编译时检查，但在运行时几乎被忽略。

如果您使用的是静态只读成员，情况会有所不同......

由于静态只读成员是在静态构造函数期间设置的，因此 JIT“知道”一个值存在。没有额外的内存 - readonly 只是阻止其他方法设置它，但这是编译时检查。

因为 JIT 知道这个成员永远不会改变，所以它在运行时被“硬编码”，所以最终效果就像拥有一个 const 值。不同之处在于 JIT 时间本身需要更长的时间，因为 JIT 编译器需要做额外的工作来将 readonly 的值硬连接到位。（不过，这将非常快。）

[Marcus Hegee 的Expert C++/CLI](https://rads.stackoverflow.com/amzn/click/com/1590597567)对此有相当好的解释。

* * *

## 回答 #3

> 赞同：4
> 
> 时间：2012-04-23T17:45:23.877

任何其他答案尚未提及的重要一点是，当访问只读字段或访问任何属性时，使用数据副本满足请求。如果所讨论的数据是具有超过 4-8 字节数据的值类型，则这种额外复制的成本有时可能会很大。请注意，虽然当结构从 16 字节增长到 17 字节时成本会大幅增加，但在许多应用程序中，*如果不经常复制*结构，结构可能会比类大得多并且仍然比类快。例如，如果一个人应该有一种表示三维空间中三角形顶点的类型。一个简单的实现将是一个包含三个结构的结构`float`对于每个点；可能总共 36 个字节。如果点和每个点内的坐标是可变的公共字段，则可以`someTriangle.P1.X`快速轻松地访问，而无需复制除顶点 1 的 Y 坐标以外的任何数据。另一方面，如果`P1`是属性或`readonly`字段，编译器必须复制`P1`到一个临时结构，然后`X`从中读取。

* * *

## 回答 #4

> 赞同：3
> 
> 时间：2009-05-27T01:12:08.937

即使 readonly 仅在编译时生效，仍然需要将数据存储在程序集（即 IL）中。CLR 是一个**公共** **语言**运行时——用一种语言编写的类既可以被其他语言使用也可以被其他语言扩展。

由于 CLR 的每个编译器都不知道如何读取和编译所有其他语言，为了保留`readonly`字段的语义，需要将数据存储在程序集中，以便其他语言的编译器会尊重它。

当然，字段被标记的事实`readonly`意味着 JIT 可以做其他事情，比如优化（例如值的内联使用）等。不管您使用反射来更改字段值的事实如何，创建 IL 来修改`initonly`相应构造函数之外的字段（实例或静态，取决于字段类型），将导致无法验证的程序集。

# macos - OS X Leopard 上的 FSEvents 怪异

> ID：913401
> 
> 赞同：2
> 
> 时间：2009-05-27T00:18:29.233
> 
> 标签：macos, filesystems, macos-carbon, fsevents

我想监视 mac 上几个目录的文件系统事件。我要监视的目录可能会在运行时发生变化，因此使用 FSEvents 这是我的应用程序所做的：

*   创建一个全局回调函数来处理回调
*   为每个文件夹创建一个新的 FSEventStreamRef，将其与上面创建的回调相关联，并向 eventStream 添加一个上下文，以帮助我将更改回调与此文件夹相关联

东西似乎大部分都有效，但我注意到在调用回调和将“eventPaths”值发送到回调时有些奇怪。

例如，如果我为 /Foo 和 /Bar 创建了 StreamRefs，如果我在 /Bar 中添加一个文件，我的回调几乎会立即被调用，但 eventPaths 指向 /Foo 中的一个位置，并且我与 StreamRef 关联的上下文是也是 /Foo 的。

或者，假设我正在监视 /Foo 和 /Bar，然后删除 /Bar（通过正确停止和关闭 /Bar 的 StreamRef）。我现在为 /Fee 创建一个新的 FSEventStreamRef 并与同一个回调关联。我对 /Fee 所做的任何更改都不会导致调用回调，但对 /Foo 的更改会继续引发回调。

我在网上看到的任何示例或文档都只讨论监视单个文件夹。我如何将单个回调与多个 FSEventStreamRefs 关联起来有什么问题吗？听起来这应该不是问题……

有没有人以可靠的方式做过类似的事情，或者对我可能会尝试不同的方法有什么建议？

我在试验时尝试做的一件事是使用单个 FSEventStreamRef 并通过我想要的所有路径向它传递一个 CFArrayRef，当我的监视列表更改关闭并重新创建一个新的 FSEventStreamRef - 这更糟糕的是以上。

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2009-05-27T02:12:03.920

[为我工作。](https://bitbucket.org/boredzo/fs-notifier/)我模仿了这些特征：

1.  每个流一个路径
2.  每个路径/流一个上下文
3.  所有流的一个回调

你能显示失败的代码吗？

# c++ - 如何将整数值“0”存储在 .bin 文件中？(C++)

> ID：913405
> 
> 赞同：0
> 
> 时间：2009-05-27T00:20:11.460
> 
> 标签：c++, file-io, binary-data, zero

编辑：显然，问题出在读取功能中：我在十六进制编辑器中检查了数据

`02 00 00 00 01 00 00 00 00 00 00 00`

所以零被存储为零，而不是读为零。

因为当我使用我的正常存储在 bin 文件功能时：

```
int a = 0;
file.write(reinterpret_cast<char*>(&a), sizeof(a)); 
```

它将 0 存储为`char`版本，或“\0”，显然没有存储（因为它是一个空值？）所以当我调用我的函数来读取零值时，它会在它之后（或之前读取值）如果它是文件中的最后一个）。那么如何正确地将零存储在 .bin 文件中呢？

编辑：以下是与读/写过程相关的一些功能：

```
//Init program: creates a sector.bin for another program to read from.
#include<fstream>
using namespace std;

int main()
{
    fstream file;
    file.open("sector.bin", ios::out | ios::binary);
    if(!file.is_open())
    {
        file.open("sector.bin", ios::out | ios::binary);
        file.close();
        file.open("sector.bin", ios::out | ios::binary);
        if(!file.is_open())
        {
            return -1;
        }
    }
    file.seekp(file.beg);
    int a = 2;
    int b = 1;
    int c = 0;
    file.write(reinterpret_cast<char*>(&a), sizeof(a));
    file.write(reinterpret_cast<char*>(&b), sizeof(b));
    file.write(reinterpret_cast<char*>(&c), sizeof(c));
    file.close();
    return 0;
}

//Read function:  part of another program that intializes variables based off
//of sector.bin
void sector::Init(std::fstream& file)
{
    int top_i = FileRead(file,0);
    std::cout<<top_i<<std::endl;
    for(int i = 0; i < top_i; i++)
    {
        accessLV[i] = FileRead(file,i+1);
        std::cout<<accessLV[i]<<std::endl;
    }
    std::cin.ignore();
    viral_data.add(new X1(5,5,'X'));
    viral_data.add(new X1(9,9,'X'));
    player.set(0,0,'O');
    return;
}
//the FileRead used in init
int FileRead(std::fstream& file, int pos)
{
    int data;
    file.seekg(file.beg + pos);
    file.read(reinterpret_cast<char*>(&data), sizeof(data));
    return data;
} 
```

此外，使用的输出`sector::Init`如下：

```
2
1
1 
```

我试图写入垃圾箱的输出是

```
2
1
0 
```

因此，要么 0 被读/写为 1，要么没有被写入，而 Init 正在读取最后一个值两次。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-05-27T00:29:01.880

```
 int num = 0;
write( fd, &num, sizeof( int )); 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-05-27T00:28:17.730

目前尚不清楚在文件中“存储整数值 0”是什么意思。文件包含字节，而不是整数。您需要存储 sizeof(int) 0 字节，还是只存储一个 '\0' 字节？

PS我也猜想问题可能出在您的阅读代码中。您是否在十六进制编辑器中查看了您的 .bin 文件？

PPS**您的问题在于 seekg() 函数的使用。不是以字节为单位传递偏移量，而是传递 pos。它应该是 pos * sizeof(int) 。**

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2009-05-27T00:34:57.110

我不确定你想做什么，对我来说，你提供的代码似乎满足了你的要求：

```
int main() {
   std::ofstream file("/tmp/tst.out");
   int a = 0;
   file.write(reinterpret_cast<char*>(&a), sizeof(a));
   return 0;
} 
```

这会产生一个四字节大小的文件，其中包含零整数的二进制表示：

```
$ hexdump /tmp/tst.out
0000000 0000 0000
0000004 
```

如果要将整数存储为 ASCII 表示形式，则应使用格式化的流输出`<<`：

```
std::ofstream file("/tmp/tst.out");
int a = 0;
file << a << std::endl; 
```

这样你得到：

```
$ cat /tmp/tst.out
0 
```

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2009-05-27T00:33:49.453

您需要考虑二进制文件应该包含什么格式 - 您不必以与文本文件相同的方式来做这件事，这就是为什么多次使用文本文件的原因。

假设一台（32 位）机器 sizeof(int) == 4（和 CHAR_BITS == 8），那么您可以使用本机格式在当前文件位置存储全为零的 4 个字节，然后您将得到什么应该工作，我想。您可以尝试使用其他值，例如 0x01020304，您将在您的机器上看到字节布局。

当然，你需要小心地读回它，颠倒用于写入的过程。并且不要忘记在尝试重新读取刚刚写入的数据之前重新定位文件。

# dll - DLL 符号 _FooBar@16 中的数字 16 代表什么？

> ID：913406
> 
> 赞同：5
> 
> 时间：2009-05-27T00:21:11.567
> 
> 标签：dll, symbols

DLL 符号中的数字 16`_FooBar@16`代表什么？

* * *

## 回答 #1

> 赞同：8
> 
> 时间：2009-05-27T00:25:48.797

这意味着 _FooBar 是一个 __stdcall 函数，它需要 16 个字节的参数。

此处描述了 x86 上的 32 位调用约定：http: [//blogs.msdn.com/oldnewthing/archive/2004/01/08/48616.aspx](http://blogs.msdn.com/oldnewthing/archive/2004/01/08/48616.aspx)

* * *

## 回答 #2

> 赞同：5
> 
> 时间：2009-05-27T00:25:58.390

这是通用名称修饰，取决于函数的调用约定。

应用于函数的各种调用约定和名称修改记录为[参数传递和命名约定](http://msdn.microsoft.com/en-us/library/984x0h58.aspx)。您必须单击各个链接才能查看应用的确切修改。

在您的情况下，您有一个`__stdcall`使用以下命名约定的约定：

> 名称前加下划线 (_)。名称后跟 at 符号 (@)，后跟参数列表中的字节数（十进制）。因此，声明为 int func( int a, double b ) 的函数修饰如下： _func@12

# mysql - mysql存储函数的奇怪问题

> ID：913408
> 
> 赞同：0
> 
> 时间：2009-05-27T00:22:16.557
> 
> 标签：mysql, stored-functions

只是为了测试，

但很奇怪：

```
 DELIMITER |

DROP FUNCTION IF EXISTS get_idiscussion_ask|

CREATE FUNCTION get_idiscussion_ask(iask_id INT UNSIGNED) RETURNS TEXT DETERMINISTIC
BEGIN
  DECLARE done INT DEFAULT 0;
  DECLARE body varchar(600);
  DECLARE created DATETIME;
  DECLARE anonymous TINYINT(1);
  DECLARE screen_name varchar(64);
  DECLARE result TEXT;
  DECLARE cur1 CURSOR FOR SELECT body,created,anonymous,screen_name from idiscussion left join users on idiscussion.uid=users.id where idiscussion.iask_id=iask_id;
  DECLARE CONTINUE HANDLER FOR SQLSTATE '02000' SET done = 1;

  SET result = '';
  OPEN cur1;
  REPEAT
    FETCH cur1 INTO body, created, anonymous, screen_name;
    SET result = CONCAT(result,'<comment><body><![CDATA[',body,']]></body>','<replier>',if(screen_name is not null and !anonymous,screen_name,''),'</replier>','<created>',created,'</created></comment>');
  UNTIL done END REPEAT;
  CLOSE cur1;

  RETURN result;
END |

DELIMITER ;

mysql> DELIMITER ;
mysql> select get_idiscussion_ask(1);
+------------------------+
| get_idiscussion_ask(1) |
+------------------------+
| NULL                   |
+------------------------+
1 row in set (0.01 sec)

mysql> SELECT body,created,anonymous,screen_name from idiscussion left join users on idiscussion.uid=users.id where idiscussion.iask_id=1;
+------+---------------------+-----------+-------------+
| body | created             | anonymous | screen_name |
+------+---------------------+-----------+-------------+
| haha | 2009-05-27 04:57:51 |         0 | NULL        |
| haha | 2009-05-27 04:57:52 |         0 | NULL        |
| haha | 2009-05-27 04:57:52 |         0 | NULL        |
| haha | 2009-05-27 04:57:53 |         0 | NULL        |
+------+---------------------+-----------+-------------+
4 rows in set (0.00 sec) 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-05-27T00:27:16.377

你应该做

```
Select Result 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-05-27T00:27:21.197

1）你没有在你的例子中调用你的函数。

2) 连接任何与 null 结果为 null

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2011-03-09T22:58:03.080

如果你改变这个：

```
DECLARE cur1 CURSOR FOR 
  SELECT body,created,anonymous,screen_name 
  FROM idiscussion 
  LEFT JOIN users ON idiscussion.uid=users.id 
  WHERE idiscussion.iask_id=iask_id; 
```

至

```
DECLARE cur1 CURSOR FOR SELECT   
ifnull(body,'')  
,ifnull(created,now())    
,ifnull(anonymous,0)  
,ifnull(screen_name,'')  
FROM idiscussion   
LEFT JOIN users on idiscussion.uid=users.id   
WHERE idiscussion.iask_id=iask_id; 
```

CONCATing nulls 应该没有任何问题

另外我想知道这部分
`where idiscussion.iask_id=iask_id;`
是否不会产生名称冲突，也许您应该将参数
iask_id 更改为
piask_id
（但我不确定那部分）。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2009-05-27T00:28:50.070

你......连接一个空值和一个字符串......这是一个空值。如果您甚至不调用它，存储过程与它有什么关系？

# python - Python3.0：标记化 & BytesIO

> ID：913409
> 
> 赞同：1
> 
> 时间：2009-05-27T00:22:37.540
> 
> 标签：python, io, tokenize, bytesio

在 python3.0 中尝试`tokenize`字符串时，为什么`'utf-8'`在标记开始之前我会得到一个前导？

从[python3 文档](http://docs.python.org/3.0/library/tokenize.html)，`tokenize`现在应该按如下方式使用：

```
g = tokenize(BytesIO(s.encode('utf-8')).readline) 
```

但是，在终端尝试此操作时，会发生以下情况：

```
>>> from tokenize import tokenize
>>> from io import BytesIO
>>> g = tokenize(BytesIO('foo'.encode()).readline)
>>> next(g)
(57, 'utf-8', (0, 0), (0, 0), '')
>>> next(g)
(1, 'foo', (1, 0), (1, 3), 'foo')
>>> next(g)
(0, '', (2, 0), (2, 0), '')
>>> next(g) 
```

`utf-8`其他令牌之前的令牌是什么？这应该发生吗？如果是这样，那么我应该总是跳过第一个令牌吗？

## [编辑]

我发现令牌类型 57 是[tokenize.ENCODING](http://docs.python.org/3.0/library/tokenize.html#tokenize.ENCODING)，如果需要，可以轻松地将其从令牌流中过滤掉。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-05-27T00:29:10.163

那是源的编码cookie。您可以明确指定一个：

```
# -*- coding: utf-8 -*-
do_it() 
```

否则，Python 采用默认编码，Python 3 中的 utf-8。

# wpf - 是否会弃用 Windows 窗体以支持 WPF？

> ID：913417
> 
> 赞同：19
> 
> 时间：2009-05-27T00:26:16.580
> 
> 标签：wpf, winforms

我们正在开始一个新项目，并试图决定使用 Windows 窗体或 WPF。

我阅读了其他一些 Stack Overflow 帖子，并意识到 WPF 在数据绑定和外观领域具有一些优势，但也有陡峭的学习曲线和相当不成熟的工具和控件。

我们想更好地了解 Microsoft 是否计划停止 Windows 窗体技术的新开发并强制所有新开发最终转到 WPF，或者这两种技术是否都将得到维护和改进。（或者他们只是在下定决心之前等待，看看情况如何？）

目前，对于不需要在 UI 中添加额外花里胡哨[的业务线](http://en.wikipedia.org/wiki/Line_of_business)应用程序来说， WPF 似乎不一定是最佳方式。但是，很高兴知道 WPF 是否是我们迟早需要接受的东西。

* * *

## 回答 #1

> 赞同：53
> 
> 时间：2009-05-27T02:38:57.063

这部分是合理的论点，部分是发自内心的咆哮……

WinForms 基于自现代 Windows 诞生以来就存在的 user32/GDI 技术。从任何意义上来说，它都不会去任何地方：它不会获得新功能；它不会得到支持。

或者也许它会。.NET 4.0 中的图表 API 是新的，是为 GDI 而不是 WPF 编写的。

一般来说，Microsoft 拥有如下新技术的历史：

1.  发明新的 API。
2.  使用该 API 进行 2 或 3 个产品周期的创新。
3.  意识到继续创新意味着对向后兼容性做出不合理的让步，或者意识到该技术最初并未解决。
4.  通过包装或保留现有 API 来发明新的 API。现有的 API 不会消失，但新的东西也不会使用它。

RDO -> DAO -> ADO -> ADO.NET -> LINQ to SQL -> 实体框架，折腾一些 ODBC ......有一个“死”和包装技术的宝​​库，它们仍然可用并且今天仍然存在。这些是数据访问技术，但同样的想法也适用；UI 框架会持续更长时间，因为它们是应用程序中最明显的区域。

如果我戴上我的 Nostradomus 帽子，我可以肯定地说，当 .NET，哦，6.0 在 2015 年发布时——这听起来很遥远，但与 2003 年一样接近——WPF 将像 Windows 一样“死”表单，因为将创建一些其他漂亮的托管界面，以消除 WPF 的所有尚未发现的错误和不便。谁在乎？到那时，我们今天喋喋不休的一切都将被弃用。（无论如何，在 .NET 5.0 中必须做出一些让步，因为框架变得非常大。）

如果有的话，Windows Forms 的目标是它基于已经存在了十多年的技术，并且这种惯性不会很快消失：您输入的浏览器正在使用 GDI，任务栏是使用 GDI，您的即时消息应用程序正在使用 GDI，Windows 7 中的新功能区控件正在使用 GDI，您办公桌上 60 美元的打印机正在使用 GDI 打印机驱动程序，您手机上运行的 Windows CE 应用程序运行 Windows 窗体和GDI，Windows Vista中新的Event Viewer使用的是Windows Forms，而Windows Forms平台背后有一个庞大的第三方组件社区——WPF是一个非常小众的产品，只存在于托管世界中，它本身就是小于其非托管对应物。

为此，我觉得所有这些“WinForms vs. WPF”的讨论都在夸大其词；这些技术并不相互排斥或劣势/优越，正如微软营销可能让我们相信的那样，微软的开发人员足够聪明，能够意识到这一点。它们只是不同，其中一个恰好更老。如果我们不定期考虑这一点，我们都会在 2005 年听取 Gartner 的意见，并完全停止构建 Windows 应用程序，并将一切都转移到 Web 上的 AJAX 上……使用我们的 SOA 接口……公开一个替代的 REST 接口…… . 在该后端使用 TDD DDD 模型...由 ORM 从数据库中抽象出来。

因为害怕被弃用而如此急于放弃一项技术只会向我们的客户保证，我们将在编程软件解决方案方面保持恒定水平的缺乏经验和无能。

WPF 是未来的一部分，可以肯定的是，但它不是未来。就个人而言，我正在观望 WPF 是否在 UI 技术意义上“成功”，而以前的数据访问技术没有，尽管 Visual Studio 在 2010 年采用它是一个非常令人欣慰的迹象，表明微软实际上是认真对待它的在旗舰产品中进行测试。

总结一下：如果你正在构建一个 LOB 应用程序，我不会对使用 WinForms 感到内疚。如果您需要高级布局方案，WPF 互操作始终可供您使用，就像偶尔使用 Flash 对象增强常规网站一样。但是对于其他任何事情，您应该为您的客户提出一个将整个团队和外壳转换为 WPF 的充分理由；Windows Forms 有它的问题，但是与任何平台的一半战斗是知道问题和限制*是*什么，而且世界上大多数人（包括微软）仍在学习 WPF。

* * *

## 回答 #2

> 赞同：5
> 
> 时间：2009-05-27T02:17:55.983

**WinForms 在 Win32 出现之前不会被弃用……这可能是相当长的一段时间！**

（记住 WinForms 基本上是对 Win32 的抽象）

另一方面，WPF 对 Win32 的直接依赖很少，因此可能会在未来版本的 Windows 上形成“全新启动”UI 层的基础。到那时，我会想象 Win32（以及 WinForms）将被完全抛弃，只能通过虚拟化获得。正如我所说，这可能还很遥远:)

* * *

## 回答 #3

> 赞同：4
> 
> 时间：2009-05-27T00:50:17.767

Microsoft 对 .NET Framework 及其中所有类的支持政策是 5+5：发布后 5 年的主流支持，然后提供 5 年的扩展支持，或收费。

随着 .NET 4.0 更新（包括所有 WinForms 内容）于 2009 年发布，您将获得 5 年的主流支持，直到 2014 年，任何基于 .NET 4.0 构建的 WinForms 应用程序。

.NET 4.0 之后的任何内容都可能包含 WinForms，在这种情况下，时钟会重置。

此 5+5 策略适用于所有与业务相关的基础架构软件：Windows、Windows Server、SQL Server、Visual Studio、.NET 等。

关键是，您不必担心缺少对 WinForms 的支持。

但是，之前的海报是正确的 - 进步正在进入 WPF。

* * *

## 回答 #4

> 赞同：2
> 
> 时间：2009-05-27T00:38:33.733

我不会太担心长期支持。WPF 最近可能受到了大家的喜爱，但是那里有太多的 WinForms 代码需要放弃支持。毕竟，即使是 MFC 仍然会随着每个 Visual Studio 版本获得更新。

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2009-05-27T00:38:13.313

我认为 Windows 窗体将继续由 Microsoft 维护，但仅在小方面进行了改进。所有热门的新创新都将归于 WPF。[Windows 窗体与LINQ to SQL](http://en.wikipedia.org/wiki/Language_Integrated_Query#LINQ_to_SQL)处于相似的位置。LINQ to SQL 是一个紧凑、紧凑、快速的[ORM](http://en.wikipedia.org/wiki/Object-relational_mapping)，非常棒，但微软正在大力支持[Entity Framework](http://en.wikipedia.org/wiki/ADO.NET_Entity_Framework)。

Windows 窗体非常适合它的本质和用途，即小型、紧密包装的应用程序。它还剩下很多年的生命。

如果您想要一个可以（更）轻松地在 Web 界面、WPF 界面或 Silverlight（甚至是 Flex）界面之间移植的应用程序，Windows 窗体可能不适合您。这些其他接口使用基于标准的标记，以及更适合企业开发的架构。

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2009-05-27T00:47:53.370

几年前，我去了[雷德蒙德的一个 WPF 预览营，我向其中一位从事 Crossbow（WPF/Windows 窗体互操作）工作的人提出了同样的问题。](http://en.wikipedia.org/wiki/Redmond,_Washington)他的回答是在可预见的将来会支持 Windows 窗体，但不能保证。

鉴于此，我认为您可以将应用程序基于 Windows 窗体，因为您知道您将对 .NET 的下一版本或两个版本（例如，3-5 年）提供一定程度的支持。

考虑到微软对 Win32 的持续支持，我个人会打赌接近 10 年。您可能不会在每个版本中获得大量新功能，但您也不会被丢弃。

无论如何，我实际上会更关心微软从富客户端技术到基于 Web 的技术的转变，但不足以忽视在任何一种情况下创建引人注目的应用程序的机会。

* * *

## 回答 #7

> 赞同：0
> 
> 时间：2009-05-27T00:48:31.747

我当然不会称 WinForms 已死……但我也不会在其中编写新项目。出于各种原因，我会使用 WPF 编写所有新项目。最大的好处是，如果您使用 WPF/XAML，您向 Silverlight 的移植工作会容易得多。

# visual-studio-2008 - 与 VSTS 2008 并排运行 VSTS 2010

> ID：913418
> 
> 赞同：0
> 
> 时间：2009-05-27T00:26:42.413
> 
> 标签：visual-studio-2008, visual-studio-2010

> **可能重复：**
> [将 Visual Studio 2010 与 VS2008 并排安装会导致问题吗？](https://stackoverflow.com/questions/879913/will-installing-visual-studio-2010-side-by-side-with-vs2008-cause-problems)

我打算在我的开发工作站中安装 VSTS 2010 Beta 1，但我不知道我的 VSTS 2008 是否会继续工作..

有人试过这个吗？？

谢谢！

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2010-08-07T16:57:24.637

是的。

[http://msdn.microsoft.com/en-us/library/ms246609.aspx](http://msdn.microsoft.com/en-us/library/ms246609.aspx)

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-05-27T00:30:23.920

不确定这种具体情况，但根据过去多年的经验，似乎人们会后悔将测试版与其他东西一起安装。

两个 Visual Studio 的发布版本很可能会愉快地共存。

只是测试版并不是为了防弹。它们旨在限制在沙箱中。如果你没有其他机器的奢侈，可以创建一个单独的分区或虚拟机来安装测试版吗？

您真的不想弄乱您的开发工作站并且必须重新安装所有东西。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2009-05-27T00:34:39.340

是的。为我工作。你的旅费可能会改变。

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2009-05-27T00:35:39.840

许多人同时安装了 VSTS 2010 和 VSTS 2008。我就是其中之一。

另请参阅有关[Team Explorer 2010 Beta 1 兼容性的博客](http://blogs.msdn.com/teams_wit_tools/archive/2009/05/18/team-explorer-2010-beta-1-compatibility.aspx)

在这个[问题中也回答了](https://stackoverflow.com/questions/879913/will-installing-visual-studio-2010-beta-side-by-side-with-vs2008-cause-problems)

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2009-05-27T00:31:09.723

总是有出现问题的风险，然后不要责怪微软。如果您在工作站上编写任何生产代码，我建议您将其安装在虚拟机上，尤其是在当今如此简单的情况下。

# c# - 使用 System.Net.Socket，我们如何知道远程套接字何时关闭？

> ID：913430
> 
> 赞同：2
> 
> 时间：2009-05-27T00:30:27.213
> 
> 标签：c#, .net, sockets

好的，事情是这样的：

```
[Server] Start
[Server] Socket.AcceptConnection
[Client] Start
[Client] Socket.Connect 
[Server] Receive //blocking
[Client] Send
[Server] Print
[Server] Receive
[Client] Close socket 
```

有什么方法可以知道客户端何时关闭连接？我目前正在使用 MSDN 上描述的假数据包技巧，在一个单独的线程上我做了一个

```
[Server] socket.Send(byte[], 0,0); 
```

我检查它是否抛出任何错误，但它没有，即使客户端关闭了套接字。

PS我实际上在想，如果我在服务器端（TCP）有一个套接字并且在客户端有一个 TcpClient 会不会有问题？

谢谢你。

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2009-05-27T05:32:41.453

根据[Socket.Connected](http://msdn.microsoft.com/en-us/library/system.net.sockets.socket.connected.aspx)的文档：

> Connected 属性的值反映了最近一次操作时的连接状态。如果您需要确定连接的当前状态，请进行非阻塞、零字节的发送调用。如果调用成功返回或抛出 WAEWOULDBLOCK 错误代码（10035），则套接字仍处于连接状态；否则，套接字不再连接。

请注意，据我所知，您当前的呼叫是阻塞呼叫 - 您需要根据该文档进行非阻塞呼叫。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-05-27T00:38:32.313

TCP 连接应该返回`0`，即`EOF`在从已收到 FIN 的套接字读取时返回，但您最好设计您的协议，以便各方在何时断开/关闭套接字时相互告知。同样从多个线程玩同一个套接字会咬你 - 避免它。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-12-23T17:37:28.960

```
bool part1 = s.Poll(1000, SelectMode.SelectRead);
bool part2 = (s.Available == 0);
if (part1 & part2)
{//connection is closed
} 
```

# sql - SQL 2008 全文分词指针

> ID：913434
> 
> 赞同：0
> 
> 时间：2009-05-27T00:34:21.900
> 
> 标签：sql, full-text-search

如果我在 SQL 2008 上进行全文搜索，是否可以获得一个指针（文件或数据库），这样我就不必通过 Business Object 加载 100MB 备注字段并再次进行搜索？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-05-27T01:57:26.477

# c# - 让自己熟悉 C#、.NET 框架等的快速方法是什么？

> ID：913440
> 
> 赞同：3
> 
> 时间：2009-05-27T00:35:30.463
> 
> 标签：c#, .net, web-services, nt

我刚大学毕业，大约一个月后将开始工作，我被要求熟悉用于 NT 服务和 Web 服务的 C++、C#、.NET 框架。

我很感激有关如何在短时间内熟悉这些主题（书籍？互联网链接？）的建议。我不希望在一个月内成为专家，但我也不想一无所知。我已经知道 C++，并且我认为自己相当精通它，并且我知道 C# 的基础知识，即使我没有使用它那么多。对于 C#，我确实拥有一本名为 O'Reilley *Programming C#*的书。

谢谢！

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2009-05-27T00:48:05.007

我将首先删除 Microsoft 的[Visual Studio Express](http://www.microsoft.com/Express/)产品。您的 O'Reilly 书是一本非常好的入门书。

开始阅读博客和收听播客，开始熟悉围绕 c# 的所有技术。你会对你能学到的东西感到非常兴奋。以下是一些更好的：

[http://www.hanselminutes.com/](http://www.hanselminutes.com/)

[http://www.dotnetrocks.com/](http://www.dotnetrocks.com/)

[http://channel9.msdn.com/](http://channel9.msdn.com/)

[http://weblogs.asp.net/scottgu/](http://weblogs.asp.net/scottgu/)

[http://weblogs.asp.net/](http://weblogs.asp.net/)

此外，MSDN 库是非常宝贵的资源。你几乎总能在那里找到你需要的东西。这是整个 .NET 框架的参考所在。

[http://msdn.microsoft.com/en-us/library/default.aspx](http://msdn.microsoft.com/en-us/library/default.aspx)

狩猎愉快！

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2009-05-27T01:45:19.043

没有什么比实际使用该语言更好的了。尽管已经引用的一些信息来源对检查非常有用，但我想说确保您至少尝试编写一些具体的 C#。

最好的起点可能是你已经用你知道的东西编写的一个非平凡但不太大的应用程序，并尝试将它转换为 C#...如果你能找到精通 C# 的人，那就更好了对您的结果进行同行评审，以提出建议，以便更好地利用您可能不熟悉的语言特定功能。

从根本上说，如果你只是看书和看视频，你可能会觉得你真的知道，但这和自己做完全不一样（正如我的大学数学课教给我的......一个好老师可以让不可能的事情看起来微不足道）黑板）。

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2009-05-27T00:44:45.747

那是一个巨大的表面积。[Andrew Troelsen的 Pro C# 2008 和 .NET 3.5 平台](https://rads.stackoverflow.com/amzn/click/com/1590598849)是一个很好的起点。

这些是很好的播客，可以为您提供概述：

[.NET 摇滚](http://www.dotnetrocks.com/)

[电视](http://www.dnrtv.com/)

[羊群代码](http://herdingcode.com/)

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2009-05-27T00:47:16.150

微软[实验室和网络广播](http://www.microsoft.com/events/series/msdnvisualcsharp.aspx)

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2009-05-27T00:47:22.513

这是一个很好的[SO 线程，有很多资源](https://stackoverflow.com/questions/780198/please-suggest-some-great-websites-for-a-net-programmer/780302#780302)。我建议您查看[MSDN Virtual Labs](http://msdn.microsoft.com/en-us/virtuallabs/default.aspx)。他们有很多很棒的培训，可以让您掌握技术，特别是查看[C# 的](http://msdn.microsoft.com/en-us/virtuallabs/aa740375.aspx)。

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2009-05-27T01:02:21.923

我在 2008 年 11 月下旬遇到了同样的情况。如果您熟悉 IDE 和另一种编程语言，请下载 Visual Studio Express 并开始使用它。免费 ：）

[http://www.microsoft.com/express/](http://www.microsoft.com/express/)

我总是推荐这个网页：

[http://www.java2s.com/Tutorial/CSharp/CatalogCSharp.htm](http://www.java2s.com/Tutorial/CSharp/CatalogCSharp.htm)

* * *

## 回答 #7

> 赞同：0
> 
> 时间：2009-05-27T01:53:18.340

您可以根据标签名称在这个 stackoverflow 网站上选择您感兴趣的相关主题，并阅读一些帖子，它会让您很好地了解人们在日常编程中面临的常见问题/挑战。

* * *

## 回答 #8

> 赞同：0
> 
> 时间：2009-09-22T19:30:01.360

一种方法是收听播客。我们做了一个名为[Deep Fried Bytes](http://deepfriedbytes.com)的内容，其中包含关于任何事物的各种主题。

# emacs - 更改 Paredit 格式

> ID：913449
> 
> 赞同：10
> 
> 时间：2009-05-27T00:38:43.763
> 
> 标签：emacs, parentheses, paredit

在 C 等编程模式中使用 paredit 时，键入 ( 将在我尝试调用函数时在括号前插入一个空格，从而留下：

```
foo () 
```

有没有办法在不更改 paredit 源的情况下禁用空间插入？

* * *

## 回答 #1

> 赞同：12
> 
> 时间：2009-05-27T03:36:21.463

好吧，paredit 的工作方式似乎是它检查语法表以查看您是否在单词/符号/等之后插入一对，在这种情况下，它会强制插入一个空格。您需要覆盖该功能 - 可以通过多种不同方式完成：建议、重新定义函数确定空间、更改语法表等。

我会尝试直截了当：

```
(defun paredit-space-for-delimiter-p (endp delimiter)
  (and (not (if endp (eobp) (bobp)))
       (memq (char-syntax (if endp (char-after) (char-before)))
             (list ?\"  ;; REMOVED ?w ?_
                   (let ((matching (matching-paren delimiter)))
                     (and matching (char-syntax matching))))))) 
```

这显然适用于您使用的所有地方`paredit`。如果您想要更具体的模式，您可以在该`and`语句中添加一些条件（例如`(and ... (memq major-mode '(c-mode lisp-mode)))`）。

所以......我想我确实改变了“来源”，但你可以用一块`defadvice`......做同样的事情......这都是elisp，所以差异很小。似乎没有控制这种行为的设置。

* * *

## 回答 #2

> 赞同：5
> 
> 时间：2011-02-14T17:53:02.503

看`paredit-space-for-delimiter-predicates`

* * *

## 回答 #3

> 赞同：4
> 
> 时间：2009-05-27T07:17:57.603

好吧，[Paredit](http://www.emacswiki.org/emacs/ParEdit)非常适合编辑由 S 表达式构建的语言。如果您只是喜欢它自动插入结束括号的方式，请使用功能[骨架对](http://www.gnu.org/software/emacs/manual/html_node/autotype/Inserting-Pairs.html)。

```
(setq skeleton-pair t)
(global-set-key "(" 'skeleton-pair-insert-maybe) 
```

# iphone - 组织复杂 iPhone 项目文件结构的最佳方式？

> ID：913452
> 
> 赞同：2
> 
> 时间：2009-05-27T00:39:52.247
> 
> 标签：iphone

在处理 iPhone 项目时，它会变得非常混乱，并且会创建许多文件（库、视图控制器、界面......） 组织项目文件的最佳方式是什么？你使用什么组结构？我应该按照 MVC 范式分组吗？

谢谢！

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-07-27T11:05:25.397

使您的应用程序结构最明显的是简短但最终无益的答案。我不确定是否有一个正确的答案。

作为一个数据点，以下是我构建最复杂应用程序的大致方式：

*   应用程序范围的数据（模型）有自己的组
*   实用程序类/函数有自己的组（有时嵌套在它们需要自己的多个类的地方）
*   我有一个`UI`简单观点的小组。这些类通常还包含控制器
*   我有一堆其他组用于一系列连接视图。例如，我的应用程序的一部分显示标签，并且有两个或三个与此相关的视图。我将视图、控制器，有时还有数据分组在一起

分组不反映类结构。我的一般规则是，我希望同时将要修改的文件放在一起。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-05-27T00:44:31.910

我们通常有一组视图控制器和自定义列表单元。

在我们当前的项目中，我们还有一个 XMLParsers 组（我们有很多这样的线程实例来解析来自服务器的传入消息）。

MVC 范式在这里基本上没有实际意义——当然，它是你应该遵循的——但我认为 XCode 的团队不仅仅是在文件系统布局方面迎合 MVC。

# javascript - 在Javascript中比较表单中的两个字段 - 不工作

> ID：913456
> 
> 赞同：1
> 
> 时间：2009-05-27T00:42:11.603
> 
> 标签：javascript, jquery, html

谁能告诉我我做错了什么？我的 comparePasswords() 不工作...

```
 <script>

            function comparePasswords()
            {
                if (post-form.password.value != post-form.password2.value)
                {
                    $('passwordShow').innerHTML = '';
                }
                else
                {
                    $('passwordShow').innerHTML = 'Passwords do not match';
                }
            }
        </script>

<form id="post-form" action="signup.php" method="post" >

<input type="password" id="password" name="password" onkeyup="testPassword(this.value);" maxlength="50" size="25" tabindex="102" value="">

<input type="password" id="password2" name="password2" onkeyup="comparePasswords();" maxlength="50" size="25" tabindex="104" value="">

</form> 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-05-27T00:45:06.700

你需要使用

```
document.getElementById('password').value 
```

和

```
document.getElementById('password2').value 
```

另外，你的逻辑是错误的。如果密码不匹配，将触发第一个条件块。

**编辑**

看来您正在使用 jQuery，所以只需使用

```
$('#password').val() 
```

获取字段的值。

您还应该使用 jQuery（也可以）使用`html()`方法设置 innerHTML

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-05-27T00:45:18.120

问题在于您如何访问表单对象。

```
post-form.password 
```

对于 javascript 引擎，这与此相同：

```
post - (form.password) 
```

此外，您必须为您的表单提供一个`name`属性（而不仅仅是一个 id）才能以这种方式访问​​它。如果您想按名称访问它，您将使用如下内容：

```
document['post-form'].password 
```

或通过 id：

```
document.getElementById("post-form"); 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-05-27T00:44:17.683

你的 if 中的测试是倒退的。第一个分支是测试两个密码是否不相等。

# unit-testing - 说服开发人员学习 TDD 的最佳论据是什么？

> ID：913458
> 
> 赞同：7
> 
> 时间：2009-05-27T00:42:29.060
> 
> 标签：unit-testing, tdd

让我先出柜。我是 TDD 的信徒。我正在尝试尽可能多地练习测试驱动开发。

我工作中的一些开发人员甚至拒绝尝试。我自己通过尝试向我的一位同行证明测试驱动开发是一个坏主意来开始 TDD。论据是：

*   为什么？到目前为止，我是非常成功的开发人员。
*   它会让我慢下来。

听到或使用过的最好的专业 TDD 论点是什么？

* * *

**另请参阅：** [单元测试的最佳理由是什么？](https://stackoverflow.com/questions/135386)

* * *

## 回答 #1

> 赞同：31
> 
> 时间：2009-05-27T01:21:16.580

也许他们知道得更好。

**开发人员的单元测试**是一种非常有用的实践，我不能过分强调它的好处，不仅在初始开发期间，而且在重构期间，单元测试不仅可以及早发现普通代码缺陷，还可以发现开发人员所做的假设的突破，而这些假设从未在正式文档，因此很可能在重构发生时丢失。

话虽如此，TDD 并不是神奇的精灵尘埃：

1.  “只需编写足够的代码以通过测试”的方法会产生误报。经常有一些已知的谬误和问题，“刚刚好”的方法无法解决。快速想到的例子是[分布式系统谬误](http://en.wikipedia.org/wiki/Fallacies_of_Distributed_Computing)或 NUMA 性能问题。仅仅捕获这些需求并简单地*表达*TDD 的那些测试用例本身就会变成一项全职工作。
2.  对于任何大型项目，起订量的爆炸都会失控。模拟是像任何其他代码一样的代码，它们需要维护，只是不要突然写出自己。
3.  TDD 经常被用作消除 QA 测试的借口。“我们的开发人员已经编写了经过测试的 id，让我们发布吧”完全忽略了 QA 应该涵盖的端到端面向特征的测试
4.  我不相信守卫鸡舍的狐狸。如果在测试和实现中都犯了同样的错误，那么*错误*的算法仍然可以通过 TDD 并取得优异的成绩。
5.  所有的方法论最终都试图用过程来替代人才。

我与 TDD 的主要争论是它被认为是大多数开发问题的神奇解决方案，但其成本却被其拥护者隐瞒了下来。使用 moqs 将代码库翻倍或翻三倍并不是免费的。我宁愿看到一些在开发过程中编写的综合单元测试。测试优先的 TDD 方法，我还没有在实际规模的项目中看到它的好处。

我知道我现在会因为张贴这个而被蛋死，但是到底是什么，谁在乎......

* * *

## 回答 #2

> 赞同：20
> 
> 时间：2009-05-27T00:47:42.950

再多的争论都无法说服任何人使用 TDD。

您必须展示它们，并展示其好处。通过展示而不是讲述更容易让某人“点亮”。

* * *

## 回答 #3

> 赞同：15
> 
> 时间：2009-06-02T14:37:37.740

TDD 是“现在付款或以后付款”的权衡。如果只计算从开始编码到签入代码的时间，那么 TDD 通常确实需要更长的时间，尤其是在第一次学习 TDD 时。回报会在测试阶段后期出现，也会出现在未来的几轮编码中。

对于测试阶段，我发现使用 TDD：

1.  我的错误大大减少。我的最后一个 TDD 代码只有由于对需求的误解（或更改）或在我无法对代码进行测试的区域（在这种情况下为 PHP 代码）而出现错误。
2.  我的错误通常更容易在测试中重现，因为我已经得到了测试中的系统。
3.  修复错误更快，并且通过测试，我可以更加相信我没有引入新错误。

代码本身具有以下属性：

1.  当我开始像代码的客户一样思考时，代码往往更易于使用。（这是首先编写测试的好处之一）。

2.  代码更容易测试。

3.  在之前而不是之后编写单元测试更容易（并且在许多情况下更有趣），因此编写了更多测试。

4.  代码更容易重构和清理。对于 Python 来说尤其如此，因为自动重构工具的难度更大。

正因为如此，当需要重新访问代码时，它更容易理解，也更容易更改，而且我们至少已经进行了一些回归测试。

这意味着 TDD 时间的回报可能在*几个月*后。此外，使用遗留代码启动 TDD 特别困难。然后需要时间来学习如何编写好的测试（一个糟糕的测试集可能不足，或者更糟的是脆弱，使得重构变得更难，而不是更容易）以及如何让一个复杂的系统被测试。

我不得不承认我并没有真正让太多其他人切换到 TDD。我想我之所以切换主要是因为我想要一种更简单的测试方式，而且我有机会通过一个小型代码库和个人项目来学习如何进行测试。

* * *

## 回答 #4

> 赞同：3
> 
> 时间：2009-05-27T00:59:04.330

不同的人会以不同的方式被说服（或不相信），所以唯一诚实的答案是“视情况而定”。

我见过几次工作的一种方法是在某人一直在为一大段代码苦苦挣扎之后与他们坐在一起，然后使用 TDD 重新创建它。生成的代码通常更小更清晰。

* * *

## 回答 #5

> 赞同：3
> 
> 时间：2009-05-27T01:00:38.510

我不练习 TDD。虽然我知道如果您有复杂的项目并且有许多不同的测试用例要测试是多么好，但我认为在简单的 Web 应用程序中使用它并没有很大的好处。

有人可以说服我使用 TDD 的一种方法是，如果我们将同一个项目并排进行，看看谁得出了更好的结果，谁更快地完成了任务。

* * *

## 回答 #6

> 赞同：2
> 
> 时间：2009-05-27T14:48:04.893

对我来说，“啊哈”的时刻是阅读 James Newkirk 的“Microsoft.Net 中的测试驱动开发”的第 2 章。（并不是说本书的其余部分不重要……他用几章专门介绍了在 TDD 中构建多层应用程序）。

他构建了一个简单的堆栈，但您会看到代码“进化”了它的复杂性，而不是一开始就很复杂。

即便如此，你仍然很难说服反对者，因为 TDD 似乎比传统编程需要更多的工作。然而，大多数反 TDD 的开发人员在最后忘记了单元测试的开发时间，至少在我的经验中是这样。

* * *

## 回答 #7

> 赞同：2
> 
> 时间：2009-05-27T14:36:27.490

与他们配对。您不必将其称为“结对编程”——这对于那些甚至不愿意考虑 TDD 等“激进”技术的人来说是很可怕的——但是如果你们两个坐在办公桌前一起解决同一个问题，那么很容易证明 TDD 的价值。这不可能是谈话的结束，但它是一个地狱般的开始。让你在接下来的对话中获得可信度，并为你提供一些真实的东西作为进一步讨论的基础。

* * *

## 回答 #8

> 赞同：1
> 
> 时间：2009-05-27T00:45:12.220

你列出的论点不是理性的、合乎逻辑的论点。他们背后没有任何理由（除非您实际上只是总结了更长的真实论点。）

因此，我认为您无法用您自己的理性论据说服任何提出这些主张的人。最好的方法是诉诸他们论点的来源；经验。要么让他们暂时使用 TDD 一段时间，看看他们的想法，要么自己做 TDD 工作，这显然是非常好的工作，并将其作为示例展示给他们。

（我不是 TDD 的信徒。这是一种实用的方法，你可以让我相信这是个好主意。）

* * *

## 回答 #9

> 赞同：0
> 
> 时间：2009-05-27T14:39:31.650

彻底的单元测试减少了错误的发生，但它们也减少了再犯或再犯造成的损害范围。

* * *

## 回答 #10

> 赞同：0
> 
> 时间：2009-05-27T00:52:12.380

作为 10 多年的专业开发人员，我能提出的最好的论点是，即使我在真正能够“运行”应用程序之前就发现了我的错误。

我还发现我的代码设计更健壮，更容易更改，这让我对重构更有信心。

“相当成功”不等于“非常成功”。

另一个很大的优势是我不再需要编写测试工具，因为单元测试运行器有效地成为我的测试工具。

* * *

## 回答 #11

> 赞同：0
> 
> 时间：2009-05-27T00:54:04.980

向他们展示此演示文稿。它卖给了我。

[http://www.slideshare.net/sebastian_bergmann/testing-with-phpunit-and-selenium-156187](http://www.slideshare.net/sebastian_bergmann/testing-with-phpunit-and-selenium-156187)

任何曾经面临过具有很多边缘条件的非常复杂任务的程序员都应该能够看到 TDD 的价值。当涉及到诸如确保搜索引擎匹配某些字符串之类的事情时，TDD 是您在维护期间能够保持理智的唯一方法——这是确保您已修复一个案例而不会破坏其他案例的唯一方法是自动化测试。

# c++ - c ++没有随机化

> ID：913459
> 
> 赞同：0
> 
> 时间：2009-05-27T00:43:40.977
> 
> 标签：c++, random

我不知道为什么我不能在这里得到我的变量的差异值，帮助！

```
int main()
{
    srand(time(NULL));
    srand48(time(NULL));
    Packet* firstPacket = new Packet();
    firstPacket->packetSize =  randSize();
    firstPacket->dest = randDest();
    firstPacket->arrivalTime = myExp(lamb);
    Host[firstPacket->dest].Frame.push_back(firstPacket);   // adding first packet
    Host[firstPacket->dest].numOfPack++;
    calcFrameSize(Host[firstPacket->dest]);
    cout << Host[token].frameTVTime << " " << Host[token].frameSize
                    << " " << token << " " << curTime << endl;
} 
```

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2009-05-27T02:25:17.713

你的陈述是：

```
srand(time(NULL));
srand48(time(NULL)); 
```

打电话给你：

```
inline float time(int size) { return (10.0*(float)size/12500); } 
```

而不是系统时间？

这可以解释为什么你没有得到随机数。

正如所指出的， time() 对该函数来说是一个坏名字。

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2009-05-27T00:49:57.673

randSize() 和 randDest() 中有什么？确保这些函数不会在内部调用 srand() 。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2009-05-27T03:06:16.727

```
srand(time(0)); 
```

或者

```
#include <sys/time.h>
timeval tim;
gettimeofday(&tim, NULL);
srand((unsigned int) tim.tv_usec); 
```

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2009-05-27T01:49:55.023

这就是我拥有的其他功能。

```
inline int randSize() { return (rand()%1518 + 64); }

inline int randDest() { return (rand()%10); }

inline float time(int size) { return (10.0*(float)size/12500); } 
```

这就是我在控制台中的内容：

```
~/152a/2phase$ ./phase2
0 0 1 0.01
0.5752 719 6 0.06 
```

我一直得到这些数字，我认为我不应该这样。

谢谢。

# ios - iOS：如何使用 Quartz 测量字符串的宽度和高度？

> ID：913470
> 
> 赞同：19
> 
> 时间：2009-05-27T00:46:15.747
> 
> 标签：ios, objective-c, quartz-graphics, core-text

在我提出问题之前，这是来自 Apple 的文档 re：how to determine the width of a string of using Quartz：

> 如果文本测量对您的应用很重要，则可以使用 Quartz 2D 函数来计算它们。但是，您可能首先考虑使用 ATSUI，它的优势在于文本布局和测量。ATSUI 有几个获取文本度量的函数。您不仅可以获得布局后文本指标，而且在极少数需要它们的情况下，您可以获得布局前文本指标。与您必须自己执行计算的 Quartz 不同，ATSUI 会为您计算测量值。例如，您可以通过调用 ATSUI 函数 ATSUMeasureTextImage 来获取文本的图像边界矩形。
> 
> 如果您认为 Quartz 文本比 ATSUI（或 Cocoa）更适合您的需求，您可以按照以下步骤在 Quartz 绘制文本之前测量文本的宽度：
> 
> 1.  调用函数 CGContextGetTextPosition 获取当前文本位置。
> 2.  使用函数 CGContextSetTextDrawingMode 将文本绘制模式设置为 kCGTextInvisible。
> 3.  通过调用函数CGContextShowText来绘制文本，在当前文本位置绘制文本。
> 4.  通过调用函数 CGContextGetTextPosition 确定最终文本位置。
> 5.  从结束位置减去开始位置以确定文本的宽度。

以下是我的问题：

1.  这真的是使用 Core Graphics 确定字符串宽度的最佳方法吗？它看起来很脆弱，因为我的文本与 2D 图形元素共存，所以我想对所有渲染使用相同的上下文。我希望会有一些紧凑的方法，比如：

    ```
    CGContextGetTextWidthAndHeight(context, text); 
    ```

2.  我读到 ATSUI 已经过时，将被 Core Text 取代。这是真的吗？如果是这样，是在 iOS 中吗？

* * *

## 回答 #1

> 赞同：22
> 
> 时间：2009-05-27T00:55:56.100

在 iPhone SDK 上，有一系列方法`NSString`可以提供您想要的。

从 iOS 7.0 开始，[这些方法是](https://developer.apple.com/library/ios/documentation/UIKit/Reference/NSString_UIKit_Additions/index.html#//apple_ref/occ/instm/NSString/boundingRectWithSize:options:attributes:context:)：

```
- boundingRectWithSize:options:attributes:context:
- sizeWithAttributes: 
```

在旧版本的 iOS 上，我们有这些，现在已弃用：

```
– sizeWithFont:  
– sizeWithFont:forWidth:lineBreakMode:  
– sizeWithFont:constrainedToSize:  
– sizeWithFont:constrainedToSize:lineBreakMode:  
– sizeWithFont:minFontSize:actualFontSize:forWidth:lineBreakMode: 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2010-10-19T08:18:36.853

在 UI 线程以外的线程上执行绘图操作时，您必须使用您描述的技术。在使用诸如 CATiledLayer 之类的东西时，这一点尤其重要，它在后台线程上异步执行渲染，或者在出于任何其他原因在后台绘制自定义图形时。

当你在做“简单”的图形时，我同意 PGB，并且保证你在主线程上运行。但是，sizeWithFont 与您描述的技术做同样的事情 - 它只是使用 UIGraphicsGetCurrentContext() 为您做这件事。

# .net - 为什么 UnhandledExceptionEventArgs.ExceptionObject 是对象而不是异常？

> ID：913472
> 
> 赞同：130
> 
> 时间：2009-05-27T00:47:02.950
> 
> 标签：.net, exception, exception-handling, unhandled-exception

为什么是`UnhandledExceptionEventArgs.ExceptionObject`一个对象而不是一个`Exception`？

我附在`AppDomain.UnhandledException`.

我想投到`UnhandledExceptionEventArgs.ExceptionObject`一个`Exception`并询问它。

考虑到这一点，它会永远为空吗？

[MSDN 文档](http://msdn.microsoft.com/en-us/library/system.unhandledexceptioneventargs.exceptionobject.aspx)不是特别有用。

> 获取未处理的异常对象。

* * *

## 回答 #1

> 赞同：153
> 
> 时间：2009-05-27T00:51:31.303

这不能输入到 Exception，因为可能会在 .Net 中抛出不是从 System.Exception 派生的对象。这在 C# 或 VB.Net 中是不可能的，但在其他基于 CLR 的语言中是可能的。因此 API 必须支持这种可能性并使用类型对象。

因此，虽然它不应该为 null，但它实际上可能不是 System.Exception。

有关更多详细信息，请参阅 CLI 规范第 10.5 节（特别是 CLS 规则 40）

* * *

## 回答 #2

> 赞同：82
> 
> 时间：2009-09-17T15:30:52.673

除了 Jared 已经提到的内容之外，如果已应用于您的程序集（将由 C# 和 VB 编译器自动添加） ，您可以`Exception`在 .NET Framework 2.0 及更高版本中安全地转换为。`RuntimeCompatibilityAttribute(WrapNonExceptionThrows=true)`

应用此属性后，非异常“异常”将被包裹在`RuntimeWrappedException`.

# sharepoint - 从 SharePoint ListItem 数据中删除“;#”

> ID：913481
> 
> 赞同：1
> 
> 时间：2009-05-27T00:48:45.100
> 
> 标签：sharepoint, sharepoint-2007, sharepoint-api

在 SharePoint 中，许多字段 id-value 对的格式类似于以下 id;#value。这对于像多查找这样的字段更加复杂，在提取该字段的值时可以产生像 id_1;#value_1;#id_2;#value_2;#id_3;#value_3 这样的结果

我想知道是否有任何已知的内置函数可以简化此过程并至少从值中删除 ID。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-05-27T01:03:47.550

字段值对象作为字符串存储在 Sharepoint 数据库中。对于简单的值（例如“Hello world”），这很简单。但是对于复杂的字段值——例如 ID/值对，如何将整个值存储为单个字符串显然也更复杂。Sharepoint 中的每个字段值类都负责自己的存储实现。`ToString()`负责*编写*值的字符串表示；而字段值的构造函数接受一个字符串并负责解析它并适当地设置其自身的所有属性。

例如，SPFieldUrlValue（表示`<a href="url">description</a>`）具有 Url 和 Description 属性。创建一个新`SPFieldUrlValue(string fieldValue)`对象将解析该值并相应地设置属性。

为了获得字段值的真实/正确（通常是强类型！）表示，您必须知道该字段是什么类型，以及该字段的值类是什么。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2009-06-26T13:11:12.267

[SPField 类有许多派生](http://msdn.microsoft.com/en-us/library/ms409131.aspx)类

例如，假设查找字段类型（使用 ID；#value），您可以检查[SPField.Type](http://msdn.microsoft.com/en-us/library/microsoft.sharepoint.spfield.type.aspx) == SPFieldType.Lookup，然后将 SPField 转换为[SPFieldLookup](http://msdn.microsoft.com/en-us/library/microsoft.sharepoint.spfieldlookup.aspx)并使用其覆盖的方法来获取记录值。

有关更多详细信息，请参阅[自定义字段值类](http://msdn.microsoft.com/en-us/library/ms480788.aspx)

另外 - 如果我没记错（我现在无法检查这个所以 DYOR）你可以在基础 SPField 对象上调用 .ValueAsText 和 .ValueAsHtml ，它会从值中删除 ID;#。

# objective-c - 记录所有可可事件？

> ID：913485
> 
> 赞同：1
> 
> 时间：2009-05-27T00:50:03.040
> 
> 标签：objective-c, cocoa

我正在进行可用性测试，并希望记录所有用户输入事件：鼠标移动、单击、拖动和键盘输入。我没有太多运气弄清楚如何或找到任何代码来做到这一点。有什么提示吗？我看了一下 CoreGraphics EventTap 机制，但我担心它会太低级；我想知道用户点击了哪些特定的 UI 元素。

编辑以澄清：

我正在做可用性测试，所以我想跟踪用户使用和不使用界面的哪些部分。所以，我想跟踪“按钮'foo'在这些特定的时间戳被点击了 7 次，用户滚动了这个列表并选择了这样的项目”等等。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2009-05-27T00:55:25.180

如果您只是想为您的应用程序跟踪它们，您可以覆盖[`-[NSApplication sendEvent:]`](http://developer.apple.com/documentation/Cocoa/Reference/ApplicationKit/Classes/NSApplication_Class/Reference/Reference.html#//apple_ref/occ/instm/NSApplication/sendEvent:). 它负责将您的应用程序接收到的所有事件分派给适当的响应者。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2009-05-27T05:55:40.437

我认为你需要做很多[swizzling](http://developer.apple.com/documentation/Cocoa/Reference/ObjCRuntimeRef/Reference/reference.html#//apple_ref/c/func/method_exchangeImplementations)。

先尝试调酒`tryToPerform:with:`；如果这不起作用，您需要调配诸如`mouseDown:`、`mouseUp:`、拖动事件方法、`keyDown:`、`keyUp:`和[未记录的手势方法之类的方法](http://cocoadex.com/2008/02/nsevent-modifications-swipe-ro.html)。

后一种解决方案的一个复杂之处在于，您不仅需要在 NSResponder 上调配这些方法，而且还需要在它的几个子类上调配这些方法，因为许多视图类提供自己的实现，这些实现可能会或可能不会调用其祖先的实现。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2009-05-27T16:06:33.253

Instruments 有一种记录用户界面事件的方法。似乎您可以使用作为此基础的 dtrace 调用来完成您的目标。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2009-05-27T03:15:49.110

这与您现在所想的完全不同，但如果您还没有考虑过[Silverback 之类的东西，请考虑一下。](http://silverbackapp.com/)

# c# - 电子邮件监视器同步

> ID：913487
> 
> 赞同：1
> 
> 时间：2009-05-27T00:51:23.473
> 
> 标签：c#, email, synchronization, gmail, pop3

我正在编写一个 C# 程序，该程序使用 POP3 监视专用的 Gmail 帐户以接收专门的命令电子邮件并做出适当的反应。

为了获得最大的可靠性，我将在全国的多台计算机上运行这个程序。我目前有一个竞争条件，程序的两个实例可以在其中一个删除相同的消息之前读取它，导致消息被处理两次。

如何确保每个命令只处理一次？

Gmail 的 POP3 访问过去只为每封邮件提供一次（使 RETR 和 DELE 成为单个原子操作），但我无法再重现这种行为。

计算机之间唯一的通信方法是 SQL Server 和 HTTP 服务器（由我控制）。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-05-27T00:57:29.297

我想到的一个选项是使用 POP3 的 UIDL 命令，并在 SQL Server 中有一个表，其中包含已处理的唯一 UIDL 列。

然后，在下载每条消息之前，守护程序会将 UIDL 插入表中，如果出现错误，则跳过该消息。（我假设 SQL Server 的 INSERT 命令是原子操作）。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-05-27T01:21:14.363

首先我必须承认我不知道 POP3 支持什么命令，但是......如果你可以做一个明确的'DELE'并且如果消息不再存在则得到一个错误，那么我会说：

*   撤回消息
*   删除消息
*   仅在 DELE 成功时处理

编辑：

阅读 RFC1939 后，这种方法应该可行；来自 RFC：

```
DELE msg

     Arguments:
         a message-number (required) which may NOT refer to a
         message marked as deleted

     Restrictions:
         may only be given in the TRANSACTION state

     Discussion:
         The POP3 server marks the message as deleted.  Any future
         reference to the message-number associated with the message
         in a POP3 command generates an error.  The POP3 server does
         not actually delete the message until the POP3 session
         enters the UPDATE state.

     Possible Responses:
         +OK message deleted
         -ERR no such message

     Examples:
         C: DELE 1
         S: +OK message 1 deleted
            ...
         C: DELE 2
         S: -ERR message 2 already deleted 
```

这当然是假设 Gmail 实现实际上遵守 RFC。

# xml - 如何在 Ruby 中通过 RELAX NG 验证 XML？

> ID：913489
> 
> 赞同：7
> 
> 时间：2009-05-27T00:51:34.860
> 
> 标签：xml, ruby, relaxng

该`REXML`模块似乎支持[RELAX NG 验证](http://www.germane-software.com/software/rexml/doc/classes/REXML/Validation/RelaxNG.html)，但文档没有任何关于使用框架验证部分的真实信息。

您将如何使用 RELAX NG 模式验证 XML 文档？代码片段将是最有帮助的。蒂亚！

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2009-06-01T03:43:04.553

好吧，我构建了一个程序，但结果并不好。

我的结论如下：

1.  rexml 松弛模式解析可能不起作用。代码说明它不完整
2.  rexml 拉解析可能有效，但很难说
3.  以上两项均未记录在案
4.  您应该使用真正的 XML 库，例如 libxml

这是我的测试程序：**test.rb**

```
require 'rexml/validation/relaxng.rb'
require 'rexml/parsers/pullparser.rb'

# USAGE: ruby test.rb XML-FILE
xml = ARGV[0]

# schema must be a Relax NG XML (NOT compact / .rnc)
schema = File.new( "example.rng" )
validator = REXML::Validation::RelaxNG.new( schema )

# The structure the validator made, which should be a complex structure but isn't
validator.dump

xmlfile = File.new( xml )
parser = REXML::Parsers::PullParser.new( xmlfile )
while parser.has_next?
  # Returns an PullEvent
  e = parser.pull
  # puts "Event ", e.inspect
  validator.validate(e)
end 
```

我制作了一些玩具示例 XML 文件和 RNG 文件，然后在 OSX 10.5.x 上进行了尝试（为了使其可读，换行很长）：

```
$ /usr/bin/ruby test.rb good.xml 
< S.1 #{doc}, :end_document(  ) >
/System/Library/Frameworks/Ruby.framework/Versions/1.8/usr/lib/ruby/1.8/rexml/
  validation/validation.rb:24:in `validate': Validation error.  Expected:
  :start_element( doc ) from < S.1 #:start_element( doc ), {head}, {body},
  :end_element(  ), :end_document(  ) >  but got "doc"(  )
  (REXML::Validation::ValidationException)
        from test.rb:20 
```

（我和 1.9 一样）

所以，几乎失败了。

（我本可以进一步优化测试程序以使用 add_listener 但这似乎不值得）

* * *

## 回答 #2

> 赞同：6
> 
> 时间：2010-03-25T10:00:29.943

我在[Nokogiri](http://nokogiri.org)上取得了成功（从`libxml-ruby`gem 切换后，因为每次使用 v1.1.3 都会出现段错误，尽管更改日志说一些 Windows 段错误问题已得到解决）。

这是我正在使用的代码：

首先，安装 Nokogiri，如果遇到问题，请查看[安装教程。](http://nokogiri.org/tutorials/installing_nokogiri.html)

```
gem install nokogiri 
```

如果在 Rails 上运行，请在`"Rails.root/config/enviroment.rb`“”中配置 gem，例如：

```
config.gem 'nokogiri' 
```

相反，只要`require "nokogiri`运行 Ruby。

要根据预定义的 RelaxNG 模式验证 XML 文档（我们假设文件存储在 中`'public'`），请使用以下代码段：

```
schema_path = "public/mySchema.rng"    # Or any valid path to a .RNG File
doc_path    = "public/myInstance.xml"  # Or any valid path to a .XML File

schema = Nokogiri::XML::RelaxNG(File.open(schema_path))

instance = Nokogiri::XML(File.open(doc_path))
errors = schema.validate(instance)

is_valid = errors.empty? 
```

希望这可以帮助 ！

# javascript - 如何再次赋予页面焦点，以便空格键在 FF 中向下翻页？

> ID：913498
> 
> 赞同：2
> 
> 时间：2009-05-27T00:55:42.810
> 
> 标签：javascript, jquery, firefox, yui

我有一个带有“获取更多帖子”按钮的 ajax 脚本，可以插入几个屏幕/视口的信息。在执行此操作时，文档会在某些时候失去焦点，因此空格键（向下翻页）的默认行为在 Firefox 中不起作用。

如何再次聚焦文档以恢复默认行为？哪些组件控制这种行为？

**它适用于 Chrome 和 IE（令人惊讶），但不适用于 FF。**

我尝试了一个回调函数：document.body.focus() 和 document.getElementById('someClickableElement').click()，但没有运气。

如果我真的在显示内容后点击了页面，那么我可以用空格键再次滚动。

由于这是一个经常使用的功能，点击“加载更多”，**再次点击**，然后空格向下翻页很烦人。

想法？建议？

**编辑：** 好的，所以我在界面上使用了一个**YUI**按钮（只是一个漂亮的 html“按钮”元素，带有一些 css 样式）。我用链接替换它，我不再有这个问题。

有趣的是，它在 Chrome 和 IE 中按预期工作，我什至没有使用 YUI 监听器来处理事件（只是漂亮的按钮）。它由 jquery 的 live 方法（事件委托的 b/c）处理。

**同样有趣的是，我不能以编程方式做我能做的事情（即“点击”）。**

**即使有一些 YUI 错误，似乎 firefox 应该能够通过一些 javascript 操作重新获得焦点。**

很奇怪。仍然有任何输入表示赞赏（尝试更多 JavaScript 建议？）。我有点致力于我目前的界面。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-05-27T01:00:18.557

我还没有尝试过，但是在身体或窗户上做一个 blur() 怎么样。

```
window.blur(); 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-05-27T05:15:56.097

看起来您需要模糊 YUI 按钮元素。或者在整个文档和 YUI 按钮之间使用 Tab 键执行某些操作。

所以 - 不是 focus() 文档，而是 blur() YUI 按钮。

或者，您可以尝试应用模拟“TAB”键的“keypress”事件。

# sockets - How to let kernel choose a port number in the range (1024,5000) in TCP socket programming

> ID：913501
> 
> 赞同：20
> 
> 时间：2009-05-27T00:56:05.537
> 
> 标签：sockets, kernel, tcpclient, tcplistener

When I run the following code:

```
struct   sockaddr_in sin;
int addrlen;   
addrlen=sizeof(sin);   
memset(&sin, 0, sizeof(sin));  
sin.sin_family = AF_INET;  
sin.sin_addr.s_addr=inet_addr("123.456.789.112");  
sin.sin_port=htons(0); // so that the kernel reserves a unique port for us  
sd_server = socket(PF_INET, SOCK_STREAM, 0);  
bind(sd_server, (struct sockaddr *) &sin, sizeof(sin));  
getsockname(sd_server,(struct sockaddr*)&sin,&addrlen);  
port=ntohs(sin.sin_port); 
printf("port number = %d\n",port); 
```

According to sockets, I must get a port number between 1024 and 5000, but I'm getting port numbers around 30,000.
What should I do?

* * *

## 回答 #1

> 赞同：36
> 
> 时间：2009-05-29T04:03:25.160

Port numbers have a range of 0..65535 (although often 0 has special meaning). In the original BSD TCP implementation, only `root` can bind to ports 1..1023, and dynamically assigned ports were assigned from the range 1024..5000; the others were available for unprivileged static assignment. These days 1024..5000 is often not enough dynamic ports, and [IANA has now officially designated the range 49152..65535 for dynamic port assignment](https://www.iana.org/assignments/service-names-port-numbers/service-names-port-numbers.xhtml). However even that is not enough dynamic ports for some busy servers, so the range is usually configurable (by an administrator). On modern Linux and Solaris systems (often used as servers), the default dynamic range now starts at 32768\. Mac OS X and Windows Vista default to 49152..65535.

```
linux$ cat /proc/sys/net/ipv4/ip_local_port_range 
32768   61000

solaris$ /usr/sbin/ndd /dev/tcp tcp_smallest_anon_port tcp_largest_anon_port
32768

65535

macosx$ sysctl net.inet.ip.portrange.first net.inet.ip.portrange.last
net.inet.ip.portrange.first: 49152
net.inet.ip.portrange.last: 65535

vista> netsh int ipv4 show dynamicport tcp
Protocol tcp Dynamic Port Range
---------------------------------
Start Port : 49152
Number of Ports : 16384 
```

* * *

## 回答 #2

> 赞同：6
> 
> 时间：2009-05-27T01:11:21.653

Look at `sysctl` for your platform. Here is what I see on my Mac:

```
 nickf@goblin:~$ sysctl -a|grep port
...
net.inet.ip.portrange.hilast: 65535
net.inet.ip.portrange.hifirst: 49152
net.inet.ip.portrange.last: 65535
net.inet.ip.portrange.first: 49152
net.inet.ip.portrange.lowlast: 600
net.inet.ip.portrange.lowfirst: 1023
... 
```

These are the ranges kernel peeks ephemeral ports from.

# c++ - 根据数据转换 void 指针 (C++)

> ID：913505
> 
> 赞同：0
> 
> 时间：2009-05-27T00:57:36.393
> 
> 标签：c++, casting, void-pointers

基本上我想要做的是，根据某些变量，将 void 指针转换为不同的数据类型。例如（'cast' 变量只是为了表达我的观点）：

```
void* ptr = some data;
int temp = some data;
int i = 0;

...

if(temp == 32)      cast = (uint32*)
else if(temp == 16) cast = (uint16*)
else                cast = (uint8*)

i = someArray[*((cast)ptr)]; 
```

C++ 中是否有任何东西可以做这样的事情（因为你实际上不能将变量分配为只是 (uint32*) 或类似的东西）？如果不清楚，我深表歉意，任何帮助将不胜感激。

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2009-05-27T01:40:38.723

“正确”的方式：

```
union MyUnion
{
     uint32 asUint32;
     uint16 asUint16;
     uint8 asUint8;
}

uint32 to_index(int size, MyUnion* ptr) 
{  
    if (size== 32) return ptr->asUint32;  
    if (size== 16) return ptr->asUint16;
    if (size== 8) return ptr->asUint8;  
}

i = someArray[to_index(temp,ptr)] 
```

[更新：修正了愚蠢的错字]

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2009-05-27T11:03:17.453

显然，[`boost::variant`](http://www.boost.org/doc/libs/1_39_0/doc/html/variant.html)是要走的路。它*已经*存储了一个类型标记，使您无法转换为错误的类型，并在编译器的帮助下确保了这一点。下面是它的工作原理

```
typedef boost::variant<uint32_t*, uint16_t*, uint8_t*> v_type;

// this will get a 32bit value, regardless of what is contained. Never overflows
struct PromotingVisitor : boost::static_visitor<uint32_t> {
    template<typename T> uint32_t operator()(T* t) const { return *t; }
};

v_type v(some_ptr); // may be either of the three pointers

// automatically figures out what pointer is stored, calls operator() with
// the correct type, and returns the result as an uint32_t.
int i = someArray[boost::apply_visitor(PromotingVisitor(), v)]; 
```

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2009-05-27T01:16:51.470

更清洁的解决方案：

```
uint32 to_index(int temp, void* ptr) {
  if (temp == 32) return *((uint32*)ptr);
  if (temp == 16) return *((uint16*)ptr);
  if (temp == 8) return *((uint8*)ptr);
  assert(0);
}

i = someArray[to_index(temp,ptr)] 
```

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2009-05-27T02:42:30.533

如果您被锁定使用 void ptr，并且绝对需要使用不同类型调用 []：

```
template <typename cast_to>
inline
int get_int_helper(someArray_t someArray, void* ptr) {
   return someArray[*static_cast<cast_to*>(ptr)];
}

int get_int(someArray_t someArray, void* ptr, int temp) {
   switch ( temp ) {
      case 32: return get_int_helper<uint32>(someArray,ptr);
      case 16: return get_int_helper<uint16>(someArray,ptr);
      default: return get_int_helper<uint8>(someArray,ptr);
   }
} 
```

但是，正如其他人指出的那样；可能有更好/其他的方法来做到这一点。最有可能的是，您拥有的任何数组都没有多个运算符 []，因此它不需要不同的类型。此外，您可以使用 boost::variant 来保存类型的可区分联合，这样您就不必传递 temp

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2009-05-28T11:33:49.593

您似乎想要存储采用 void* 并生成无符号整数的“cast”函数。所以，让它成为一个函数：

```
std::map<int, boost::function<unsigned(*)(void*)> casts;
template <typename T> unsigned cast(void* v) { return *(T*)v; }
casts[32] = cast<uint32>;
casts[16] = cast<uint16>;
casts[8] = cast<uint8>;
casts[128] = MySpecialCastFromDouble;

void* foo = getFoo();
unsigned bar = casts[16](foo); 
```

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2009-05-27T01:05:26.207

听起来您可能正在寻求联合，或者您正在使用 Visual Studio _variant_t。或者也许 typeinfo() 会有所帮助？（老实说，我不太确定你到底想做什么）。

至于演员表，你可以将任何东西转换成任何东西——这就是 C++ 危险的原因（如果你真的很小心的话，它会很强大）。

另外，请注意，指针值在大多数平台上都是 32 位或 64 位的，因此您无法在 32 位平台上将 uint64 存储在 void* 中。

最后，也许这就是你想要的：

```
void* p = whatever;

uint32 x = (uint32)p; 
```

或者可能

```
uint32 source = 6;

void* p = &source;

uint32 dest = *((uint32*)p);

void* p = 
```

# javascript - jQuery Ajax 网格

> ID：913514
> 
> 赞同：1
> 
> 时间：2009-05-27T01:02:07.133
> 
> 标签：javascript, jquery

我们正在启动一个新的 ASP.NET MVC 应用程序并希望使用 jQuery Ajax 网格。

我遇到了以下选项：

*   jqGrid（比 Flexigrid 更好，因为它支持可编辑的单元格）
*   Flexigrid（看起来比 jqGrid 好）
*   分拣机
*   英格丽德
*   jqGridView
*   其他的？

**哪个是 jQuery Ajax 网格的最佳选择？** 哪个是最受欢迎的 jQuery 网格/表格？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2009-05-27T01:13:49.077

对于仅平面视图的网格，我只需使用 tablesorter。正确配置 CSS 后，它会看起来很棒，支持排序、交替颜色等。

如果您需要编辑，我会选择 jqGrid。我在使用 Flexigrid 时遇到了几个问题，并且（如您所见）它并没有得到积极维护。**另一方面， jqGrid**正在积极开发中，并与包括主题支持在内的 jQuery UI 组件内联。

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2009-06-15T20:02:33.120

在您列出的选项中，我是[jQuery tablesorter的粉丝。](http://tablesorter.com/docs/)

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-06-16T10:09:21.613

嗨，我们刚刚在我们当前正在构建的应用程序上解决了这个问题。我强烈建议使用[YUI datatable](http://developer.yahoo.com/yui/datatable/)。我知道您可能在想“但我们只使用 jquery”——至少[在这篇文章](http://yuiblog.com/blog/2008/10/15/datatable-260-part-one/)中有一个小测验，这是对其功能的一个很好的概述。我认为，一旦你包含了所有不同的 jquery 插件来实现 jQuery UI，你就可以拥有整个 YUI 库，在我看来，这是非常优越的。jQuery 和 YUI 也完美和谐地生活在一起

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2009-12-07T00:41:56.217

我认为[Telerik Grid](http://demos.telerik.com/aspnet-mvc/)可以成为最佳 jQuery 数据表及其 oss 的蛋糕！

# php - PHP邮件是否可以将电子邮件发送到特定的IP地址？

> ID：913522
> 
> 赞同：0
> 
> 时间：2009-05-27T01:06:02.880
> 
> 标签：php, email, spam

我们有一个客户端无法使用 PHP 邮件从专用服务器接收电子邮件，因为当他们的垃圾邮件服务器对 IP 进行 MX 记录查找时，它找不到一个（因此它会退回电子邮件）。

这是因为邮件交换完全在不同的服务器上。客户说他们有一个绕过垃圾邮件拦截器的 IP 地址。

所以我想知道PHP邮件是否可以向特定IP发送电子邮件？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2009-05-27T01:12:06.130

您的服务器是否不符合垃圾邮件过滤器的邮件发件人资格？因为我猜他们可以收到其他人的邮件。

因此，我认为您需要查看服务器的设置，以使其符合他们的资格（例如可逆名称，或者他们要求电子邮件发件人提供的任何其他规则）

因为使用 PHP（和其他语言）您只需发送电子邮件，有些工具可以通过另一个有资格发送电子邮件的服务器发送电子邮件，但通常您使用服务器本身。

例如，您可以使用 Zend Mail 库[通过另一个 SMTP 服务器发送。](http://framework.zend.com/manual/en/zend.mail.sending.html)

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2009-05-27T01:22:15.627

答案是肯定的。但是，PHP 中的[mail()](http://php.net/mail)调用实际发送邮件的方式完全取决于您的系统设置，因此您在发送邮件时遇到的任何问题都不会在您的 PHP 代码中得到解决，它们将在您的邮件设置。

通常，您应该能够将一封电子邮件发送到“user@192.168.1.1”并成功到达。

这里有一篇关于您的一些邮件设置的好[文章](http://www.sitepoint.com/article/advanced-email-php/)。

# sockets - 我可以在使用 sendmsg() 之前连接套接字吗？

> ID：913524
> 
> 赞同：0
> 
> 时间：2009-05-27T01:07:05.000
> 
> 标签：sockets

我试图在进程之间传递 fd 并且我找到了类似[portlisten](http://lists.canonical.org/pipermail/kragen-hacks/2002-January/000292.html)的示例代码。在示例中，a`recvmsg()`可以将绑定的套接字作为参数（并将 msghdr.msg_name 保留为 NULL），但`sendmsg()`不能 - 它必须`sockaddr*`在 msghdr.msg_name 中使用 a。

我试图通过先连接来修改程序但失败了，发现评论为`/* doesn't do anything at the moment`但我不明白为什么。

这是 sendmsg() 不能将已连接的套接字作为参数的限制吗？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-05-27T01:15:01.087

从 sendmsg 手册页：

> sendmsg() 函数应通过连接模式或无连接模式套接字发送消息。如果套接字是无连接模式，则消息应发送到 msghdr 指定的地址。如果套接字是连接模式，则 msghdr 中的目标地址应被忽略。

这意味着如果您使用 TCP 连接*，msghdr 中的目标地址将被忽略*。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-05-27T01:44:18.017

查看 libancillary 的源代码。由于我是新用户，我无法发布链接，但您可以在 Google 上找到它。

# language-agnostic - 关于错误发现的静态分析的良好介绍性文本？

> ID：913538
> 
> 赞同：6
> 
> 时间：2009-05-27T01:17:27.587
> 
> 标签：language-agnostic, static-analysis, qa, testing-strategies

我正在寻找关于用于查找错误的静态分析理论的良好介绍性文本。有什么建议吗？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2009-05-27T02:15:40.993

*   [Patrick Cousot 和 Radhia Cousot，“抽象解释的基本概念”。](http://www.di.ens.fr/~cousot/COUSOTpapers/WCC04.shtml)
*   [Patrick Cousot，“基于抽象解释的形式化方法和未来挑战”。](http://www.di.ens.fr/~cousot/COUSOTpapers/LNCS2000-01.shtml)
*   [Bruno Blanchet 等人，“大型安全关键软件的静态分析器”。](http://www.di.ens.fr/~cousot/COUSOTpapers/PLDI03.shtml)
*   [Jérôme Feret，“数字滤波器的静态分析”。](http://www.di.ens.fr/~feret/publication/esop2004.html)
*   [Antoine Miné，“用于检测浮点运行时错误的关系抽象域”。(PDF)](http://www.di.ens.fr/~mine/publi/article-mine-esop04.pdf)
*   [空客法国：通过抽象解释计算航空电子程序的最坏情况执行时间 (PDF)](http://www.absint.com/aiT_airbus.pdf)
*   [程序分析器生成器：相关白皮书](http://www.absint.com/pag/papers.htm)

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2009-05-27T01:21:30.183

[维基百科的文章](http://en.wikipedia.org/wiki/Static_code_analysis)足够介绍吗？它有许多指向更深入信息的链接。

还有一个关于[软件工程广播的](http://www.se-radio.net)[播客](http://www.se-radio.net/podcast/2007-06/episode-59-static-code-analysis)。

[这里](http://sei.pku.edu.cn/~wqx/publications/Towards%20SOA-based%20Code%20Defect%20Analyzing.pdf)、[这里](http://www.dse.nl/~thelosen/artikelen/static_analysis.pdf)和[这里](http://publik.tuwien.ac.at/files/pub-et_10826.pdf)是一些学术论文，但它们可能更难阅读和理解。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2009-05-27T01:32:27.307

试试这篇[论文](http://osq.cs.berkeley.edu/public/Pincus-StaticAnalyzer.pdf)，它首先介绍了微软的[Prefast](http://msdn.microsoft.com/en-us/library/ms933794.aspx)工具。这是最成功的静态分析工具之一。

# sql - 在现有表上将 newid() 更改为 newsequentialid()

> ID：913545
> 
> 赞同：5
> 
> 时间：2009-05-27T01:22:07.280
> 
> 标签：sql, clustered-index, newsequentialid, newid

目前，我们有许多在主键上使用 newid() 的表。这导致了大量的碎片。因此，我想将列更改为使用 newsequentialid() 。

我想现有数据将保持相当碎片化，但新数据将不那么碎片化。这意味着在将 PK 索引从非集群更改为集群之前，我可能应该等待一段时间。

我的问题是，有人有这方面的经验吗？有什么我忽略的事情需要注意吗？

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2009-05-27T01:40:02.487

您可能会考虑使用[comb guids](http://www.informit.com/articles/article.aspx?p=25862)，而不是newsequentialid。

```
cast(
    cast(NewID() as binary(10)) +
    cast(GetDate() as binary(6))
as uniqueidentifier) 
```

Comb guid 是纯随机 guid 与当前日期时间的非随机性的组合，因此连续几代的梳 guid 彼此靠近，并且通常按升序排列。与 newsequentialid 相比，Comb guid 具有多种优势，包括它们不是黑盒、可以在默认约束之外使用此公式以及可以在 SQL Server 之外使用此公式的事实。

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2009-05-27T01:45:41.773

如果您切换到顺序引导*并同时*重新组织一次索引，您将消除碎片。我不明白你为什么要等到碎片化的页面链接在连续范围内重新排列。

话虽如此，您是否进行了任何测量以表明碎片实际上正在影响您的系统？仅查看索引并看到“碎片化 75%”并不**意味着**访问时间受到影响。还有更多因素在起作用（缓冲池页面的预期寿命、读取与写入的速率、顺序操作的位置、操作的并发性等）。虽然从 guid 切换到顺序 guid 通常是安全的，但您仍然可能会引入问题。例如，您可以看到插入密集型 OLTP 系统的页面锁存器争用，因为它创建了一个插入累积的热点页面。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2014-10-24T18:04:24.383

谢谢你，yfeldblum！您对 COMB GUID 的简单明了的解释确实帮助了我。我实际上正在考虑做这篇文章的相反操作：我不得不摆脱依赖，`newsequentialid()`因为我试图将 SQL Server 2012 db 迁移到 Azure，并且`newsequentialid()`那里不支持该功能。

我能够使用以下语法将我的所有表 PK 默认值更改为 COMB GUID：

```
ALTER TABLE [dbo].[Company] 
ADD  CONSTRAINT [DF__Company__Company_ID__72E6D332]  
    DEFAULT (CONVERT([uniqueidentifier],CONVERT([binary](10),newid(),0)+CONVERT([binary](6),getdate(),0),0)) FOR [CompanyId]
GO 
```

我的 SQL2012 数据库现在愉快地生活在 Azure 云中。

* * *

## 回答 #4

> 赞同：-4
> 
> 时间：2009-05-27T01:27:36.753

如果这是 SQL Server，您将通过调用 newid() 生成 Guid。这对主键不利。使用整数标识列作为主键，并使您的 Guid 成为代理键（和行 guid 列）。

# django - 如何在 Django 中使用不同的设置进行单元测试？

> ID：913549
> 
> 赞同：136
> 
> 时间：2009-05-27T01:24:16.697
> 
> 标签：django, settings, testing, django-managers

是否有任何简单的机制可以覆盖单元测试的 Django 设置？我的一个模型上有一个管理器，它返回特定数量的最新对象。它返回的对象数量由 NUM_LATEST 设置定义。

如果有人要更改设置，这有可能使我的测试失败。如何覆盖设置`setUp()`并随后恢复它们`tearDown()`？如果那不可能，有什么方法可以修改方法或模拟设置吗？

**编辑：**这是我的经理代码：

```
class LatestManager(models.Manager):
    """
    Returns a specific number of the most recent public Articles as defined by 
    the NEWS_LATEST_MAX setting.
    """
    def get_query_set(self):
        num_latest = getattr(settings, 'NEWS_NUM_LATEST', 10)
        return super(LatestManager, self).get_query_set().filter(is_public=True)[:num_latest] 
```

管理器用于`settings.NEWS_LATEST_MAX`对查询集进行切片。`getattr()`仅用于在设置不存在时提供默认值。

* * *

## 回答 #1

> 赞同：180
> 
> 时间：2011-06-20T17:35:09.393

编辑：如果您想更改**少量****特定**测试的设置，此答案适用。

从 Django 1.4 开始，有一些方法可以在测试期间覆盖设置： [https ://docs.djangoproject.com/en/stable/topics/testing/tools/#overriding-settings](https://docs.djangoproject.com/en/stable/topics/testing/tools/#overriding-settings)

`TestCase`将有一个`self.settings`上下文管理器，还有一个`@override_settings`可以应用于测试方法或整个`TestCase`子类的装饰器。

这些特性在 Django 1.3 中还不存在。

如果要更改**所有**测试的设置，则需要为测试创建单独的设置文件，该文件可以加载和覆盖主设置文件中的设置。在其他答案中有几种很好的方法；我已经看到了[hspander](https://stackoverflow.com/a/30846788/137635)和[dmitrii](https://stackoverflow.com/a/41349685/137635)方法的成功变化。

* * *

## 回答 #2

> 赞同：48
> 
> 时间：2009-05-27T01:50:13.557

你可以对子类做任何你喜欢的事情`UnitTest`，包括设置和读取实例属性：

```
from django.conf import settings

class MyTest(unittest.TestCase):
   def setUp(self):
       self.old_setting = settings.NUM_LATEST
       settings.NUM_LATEST = 5 # value tested against in the TestCase

   def tearDown(self):
       settings.NUM_LATEST = self.old_setting 
```

但是，由于 django 测试用例运行单线程，我很好奇还有什么可能会修改 NUM_LATEST 值？如果您的测试例程触发了“其他东西”，那么我不确定任何数量的猴子补丁是否会在不使测试本身的准确性失效的情况下保存测试。

* * *

## 回答 #3

> 赞同：28
> 
> 时间：2016-06-10T06:32:29.180

您可以`--settings`在运行测试时通过选项

```
python manage.py test --settings=mysite.settings_local 
```

* * *

## 回答 #4

> 赞同：25
> 
> 时间：2015-06-15T13:44:14.183

尽管在运行时覆盖设置配置可能会有所帮助，但我认为您应该创建一个单独的文件进行测试。这为测试节省了大量配置，这将确保您永远不会做一些不可逆的事情（比如清理暂存数据库）。

假设您的测试文件存在于“my_project/test_settings.py”中，添加

```
settings = 'my_project.test_settings' if 'test' in sys.argv else 'my_project.settings' 
```

在你的 manage.py 中。这将确保您在运行时`python manage.py test`仅使用 test_settings。如果您正在使用其他一些测试客户端，例如 pytest，您可以轻松地将其添加到 pytest.ini

* * *

## 回答 #5

> 赞同：20
> 
> 时间：2010-08-19T08:28:12.673

**更新**：仅在 Django 1.3.x 及更早版本上需要以下解决方案。对于 >1.4，请参阅[slinkp 的答案](https://stackoverflow.com/a/6415129/15770)。

如果您在测试中经常更改设置并使用 Python ≥2.5，这也很方便：

```
from contextlib import contextmanager

class SettingDoesNotExist:
    pass

@contextmanager
def patch_settings(**kwargs):
    from django.conf import settings
    old_settings = []
    for key, new_value in kwargs.items():
        old_value = getattr(settings, key, SettingDoesNotExist)
        old_settings.append((key, old_value))
        setattr(settings, key, new_value)
    yield
    for key, old_value in old_settings:
        if old_value is SettingDoesNotExist:
            delattr(settings, key)
        else:
            setattr(settings, key, old_value) 
```

然后你可以这样做：

```
with patch_settings(MY_SETTING='my value', OTHER_SETTING='other value'):
    do_my_tests() 
```

* * *

## 回答 #6

> 赞同：13
> 
> 时间：2016-12-27T17:41:26.257

`@override_settings`如果您的生产和测试环境配置之间没有太多差异，那就太好了。

在其他情况下，您最好只使用不同的设置文件。在这种情况下，您的项目将如下所示：

```
your_project
    your_app
        ...
    settings
        __init__.py
        base.py
        dev.py
        test.py
        production.py
    manage.py 
```

因此，您需要将大部分设置保存在其他文件中`base.py`，然后在其他文件中导入所有内容，并覆盖一些选项。这是您的`test.py`文件的外观：

```
from .base import *

DEBUG = False

DATABASES = {
    'default': {
        'ENGINE': 'django.db.backends.sqlite3',
        'NAME': 'app_db_test'
    }
}

PASSWORD_HASHERS = (
    'django.contrib.auth.hashers.MD5PasswordHasher',
)

LOGGING = {} 
```

然后你要么需要`--settings`在@MicroPyramid 答案中指定选项，要么指定`DJANGO_SETTINGS_MODULE`环境变量，然后你可以运行你的测试：

```
export DJANGO_SETTINGS_MODULE=settings.test
python manage.py test 
```

* * *

## 回答 #7

> 赞同：10
> 
> 时间：2019-11-07T19:23:28.123

对于**pytest**用户。

最大的问题是：

*   `override_settings`不适用于 pytest。
*   对 Django 进行子类`TestCase`化将使其工作，但是您不能使用 pytest 固定装置。

解决方案是使用[此处](https://pytest-django.readthedocs.io/en/latest/helpers.html#id4)`settings`记录的夹具。

例子

```
def test_with_specific_settings(settings):
    settings.DEBUG = False
    settings.MIDDLEWARE = []
    .. 
```

如果您需要更新多个字段

```
def override_settings(settings, kwargs):
    for k, v in kwargs.items():
        setattr(settings, k, v)

new_settings = dict(
    DEBUG=True,
    INSTALLED_APPS=[],
)

def test_with_specific_settings(settings):
    override_settings(settings, new_settings) 
```

* * *

## 回答 #8

> 赞同：8
> 
> 时间：2020-07-01T13:20:05.553

您甚至可以为单个测试功能覆盖设置。

```
from django.test import TestCase, override_settings

class SomeTestCase(TestCase):

    @override_settings(SOME_SETTING="some_value")
    def test_some_function(): 
```

或者您可以覆盖类中每个函数的设置。

```
@override_settings(SOME_SETTING="some_value")
class SomeTestCase(TestCase):

    def test_some_function(): 
```

* * *

## 回答 #9

> 赞同：3
> 
> 时间：2009-12-14T15:26:21.987

在尝试修复一些 doctests 时发现了这个...为了完整起见，我想提一下，如果您要在使用 doctests 时修改设置，则应该在导入其他任何内容之前执行此操作...

```
>>> from django.conf import settings

>>> settings.SOME_SETTING = 20

>>> # Your other imports
>>> from django.core.paginator import Paginator
>>> # etc 
```

* * *

## 回答 #10

> 赞同：3
> 
> 时间：2020-07-11T23:27:38.933

我创建了一个新的 settings_test.py 文件，该文件将从 settings.py 文件中导入所有内容并修改任何不同的内容以用于测试目的。就我而言，我想在测试时使用不同的云存储桶。 [![在此处输入图像描述](https://i.stack.imgur.com/hFVJq.png)](https://i.stack.imgur.com/hFVJq.png)

**settings_test.py：**

```
from project1.settings import *
import os

CLOUD_STORAGE_BUCKET = 'bucket_name_for_testing' 
```

**管理.py：**

```
def main():

    # use seperate settings.py for tests
    if 'test' in sys.argv:
        print('using settings_test.py')
        os.environ.setdefault('DJANGO_SETTINGS_MODULE', 'project1.settings_test')
    else:
        os.environ.setdefault('DJANGO_SETTINGS_MODULE', 'project1.settings')

    try:
        from django.core.management import execute_from_command_line
    except ImportError as exc:
        raise ImportError(
            "Couldn't import Django. Are you sure it's installed and "
            "available on your PYTHONPATH environment variable? Did you "
            "forget to activate a virtual environment?"
        ) from exc
    execute_from_command_line(sys.argv) 
```

* * *

## 回答 #11

> 赞同：2
> 
> 时间：2018-04-10T14:02:03.807

我正在使用pytest。

我设法通过以下方式解决了这个问题：

```
import django    
import app.setting
import modules.that.use.setting

# do some stuff with default setting
setting.VALUE = "some value"
django.setup()
import importlib
importlib.reload(app.settings)
importlib.reload(modules.that.use.setting)
# do some stuff with settings new value 
```

* * *

## 回答 #12

> 赞同：2
> 
> 时间：2019-09-07T06:59:42.350

您可以通过这种方式覆盖测试中的设置：

```
from django.test import TestCase, override_settings

test_settings = override_settings(
    DEFAULT_FILE_STORAGE='django.core.files.storage.FileSystemStorage',
    PASSWORD_HASHERS=(
        'django.contrib.auth.hashers.UnsaltedMD5PasswordHasher',
    )
)

@test_settings
class SomeTestCase(TestCase):
    """Your test cases in this class""" 
```

如果您在另一个文件中需要这些相同的设置，您可以直接导入`test_settings`.

* * *

## 回答 #13

> 赞同：0
> 
> 时间：2019-09-27T19:20:31.300

如果您在子目录（python 包）中放置了多个测试文件，您可以根据 sys.argv 中存在“测试”字符串的条件覆盖所有这些文件的设置

```
app
  tests
    __init__.py
    test_forms.py
    test_models.py 
```

__init__.py：

```
import sys
from project import settings

if 'test' in sys.argv:
    NEW_SETTINGS = {
        'setting_name': value,
        'another_setting_name': another_value
    }
    settings.__dict__.update(NEW_SETTINGS) 
```

不是最好的方法。用它来将 Celery 代理从 Redis 更改为 Memory。

# smalltalk - 在 Pharo 中安装 Magma 和 LPF

> ID：913551
> 
> 赞同：2
> 
> 时间：2009-05-27T01:25:46.727
> 
> 标签：smalltalk, pharo

我一直在尝试在 Pharo 中安装 Magma，但完全没有运气。这是我到目前为止尝试过的东西：

1.  使用蒙蒂塞洛安装`squeaksource.com/MagmaTester`- MaObjectSerializer 中的语法错误 >> setUpClassDefinitionProcessing。
2.  从 Universe 安装 - 图像挂起，显然在尝试点击`installer.pbwiki.com/f/mc15.st`.
3.  直接安装 LPF `HTTPSocket httpFileIn: 'ftp.squeak.org/3.11/bob/LPF.st'`-- 我得到一个语法错误，因为显然其中一个安装程序文件是 Unicode（或者至少每个字符都意外地是双倍宽）。

有没有人有这方面的运气？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2009-05-27T17:34:58.723

如果您在 Magma 邮件列表或什至在 Pharo 中提问，您会得到更多答案，但不是在这里。

# ruby-on-rails - attachment_fu：不要重新加载缩略图

> ID：913555
> 
> 赞同：3
> 
> 时间：2009-05-27T01:27:36.940
> 
> 标签：ruby-on-rails, attachment-fu

我有一个不错的小“照片”类，附有图像。当我转到页面对照片的顺序进行排序时，它会遍历每张照片，设置新的“排序”值并保存它。到目前为止一切都很好。

问题是，我注意到这种行为相当缓慢。事实证明，attachment_fu 会在每次保存时重新加载缩略图 - 无论是否有新的图像数据可供使用。

显然，这个系统是经过深思熟虑的，所以我只能假设存在针对这种情况的规定。我如何告诉 attachment_fu 在不合适的时候不要重新生成缩略图？

谢谢，*--Matchu*

**编辑：**我只记得，对于这种特殊情况，我可以使用 update_attribute 来躲避所有验证和其他回调。然而，对于整个大场景，这并不是一个真正可行的答案。我错过了什么？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2009-05-27T03:31:46.660

进去并破解了 attachment_fu ，并重写了`save_attachment?`行为。几乎，我添加了一些新条件：除了存在临时文件之外，以下条件之一必须为真：

1.  图像的文件不存在（使用`full_filename`属性）。
2.  使用该`uploaded_data=`方法显式更新图像数据。
3.  图像是缩略图。

它通过了所有三个测试用例——新照片上传、编辑照片图像和编辑非图像照片数据——但我还没有真正在野外测试过。我可能需要做一些修复；我们会看看会发生什么。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-07-13T20:31:09.120

我在这个主题上看到的唯一一个适度有用的线程是在这里：

[http://groups.google.com/group/rubyonrails-talk/browse_thread/thread/709d97e06b373786](http://groups.google.com/group/rubyonrails-talk/browse_thread/thread/709d97e06b373786)

我认为 Matchu 的解决方案可能是正确的，只需快速查看 attachment_fu 代码即可。如果 Matchu 可以分享他修改后的 save_attachment 的补丁或片段，我会很高兴？方法。我将自己深入研究这个问题，因为这对我来说已经成为一个问题，而且它可能比完全替换 attachment_fu 工作更少......

*更新*

根据 Matchu 的大纲，我想出了一个简短（如果不优雅）的解决方案，在经过轻度测试后似乎可以工作。

我修改了 save_attachment？在 attachment_fu/attachment_fu.rb 中：

```
def save_attachment?
  return false unless (thumbnail || !full_filename || @active_upload) #added
  File.file?(temp_path.to_s)
end 
```

...检查Matchu制定的条件。我想不出一种优雅的方式来判断数据是否已传递给 upload_data=setter 方法（如果有人有更好的方法来做到这一点，我全神贯注；我仍然是 ruby​​/rails 菜鸟) 所以我还在uploaded_data= 中添加了一行来设置全局变量@active_upload：

```
def uploaded_data=(file_data)
  return nil if file_data.nil? || file_data.size == 0
  self.content_type = file_data.content_type
  self.filename     = file_data.original_filename if respond_to?(:filename)
  @active_upload=true # added
  if file_data.is_a?(StringIO)
    file_data.rewind
    self.temp_data = file_data.read
  else
    self.temp_path = file_data
  end
end 
```

希望这会有所帮助，如果有人有更优雅的方式来处理我在全局变量中所做的事情，我很想听听。

# java - 什么是“静态”？

> ID：913560
> 
> 赞同：10
> 
> 时间：2009-05-27T01:33:24.900
> 
> 标签：java, static

我开始用Java编程。

```
public static void main(String[]args) 
```

一本书说我应该在这种情况下使用静态，但没有明确说明我为什么应该使用或它的含义。

你能澄清一下吗？

* * *

## 回答 #1

> 赞同：23
> 
> 时间：2009-05-27T01:41:31.610

的概念`static`与某物是类还是对象（实例）的一部分有关。

在`main`声明为 的方法的情况下`static`，它表示该`main`方法是类方法 - 一种方法，它是类的一部分，而不是对象的一部分。这意味着另一个类可以通过引用`ClassName.method`. 例如，调用 run 方法`MyClass`将通过以下方式完成：

```
MyClass.main(new String[]{"parameter1", "parameter2"}); 
```

另一方面，没有`static`修饰符的方法或字段意味着它是对象（或也称为“实例”）的一部分，而不是类的一部分。它由方法或字段所属的特定对象的名称来引用，而不是类名：

```
MyClass c1 = new MyClass();
c1.getInfo()     // "getInfo" is an instance method of the object "c1" 
```

由于每个实例可能具有不同的值，因此不同对象中具有相同名称的方法或字段的值不一定必须相同：

```
MyClass c1 = getAnotherInstance();
MyClass c2 = getAnotherInstance();

c1.value     // The field "value" for "c1" contains 10.
c2.value     // The field "value" for "c2" contains 12.
             // Because "c1" and "c2" are different instances, and 
             // "value" is an instance field, they can contain different
             // values. 
```

结合实例变量和类变量这两个概念。假设我们声明了一个包含实例和类变量和方法的新类：

```
class AnotherClass {
    private int instanceVariable;
    private static int classVariable = 42;

    public int getInstanceVariable() {
        return instanceVariable;
    }

    public static int getClassVariable() {
        return classVariable;
    }

    public AnotherClass(int i) {
        instanceVariable = i;
    }
} 
```

上面的类有一个实例变量`instanceVariable`和一个用修饰符`classVariable`声明的类变量。`static`同样，有一个实例和类方法来检索值。

实例的构造函数将一个值作为参数分配给实例变量。类变量被初始化为`42`永远不会改变。

让我们实际使用上面的类，看看会发生什么：

```
AnotherClass ac1 = new AnotherClass(10);

ac1.getInstanceVariable();             // Returns "10"
AnotherClass.getClassVariable();       // Returns "42" 
```

请注意调用类和实例方法的不同方式。他们通过名称引用类`AnotherClass`或通过名称引用实例的方式`ac1`。让我们进一步看看这些方法的行为差异：

```
AnotherClass ac1 = new AnotherClass(10);
AnotherClass ac2 = new AnotherClass(20);

ac1.getInstanceVariable();             // Returns "10"
AnotherClass.getClassVariable();       // Returns "42"
ac2.getInstanceVariable();             // Returns "20"
AnotherClass.getClassVariable();       // Returns "42" 
```

可以看出，实例变量是由对象（或“实例”）持有的变量，因此对于该特定实例是唯一的，在本例中是 和 引用的`ac1`对象`ac2`。

另一方面，类变量只对整个类是唯一的。为了更好地理解这一点，让我们添加一个新方法到`AnotherClass`：

```
public int getClassVariableFromInstance() {
    return classVariable;
} 
```

然后，运行以下命令：

```
AnotherClass ac1 = new AnotherClass(10);
AnotherClass ac2 = new AnotherClass(20);

ac1.getInstanceVariable();             // Returns "10"
ac1.getClassVariableFromInstance();    // Returns "42"
ac2.getInstanceVariable();             // Returns "20"
ac2.getClassVariableFromInstance();    // Returns "42" 
```

虽然`getClassVariableFromInstance`是一个实例方法，但通过引用实例`ac1`和调用可以看出`ac2`，它们都返回相同的值，`42`。这是因为在这两种实例方法中，它们都引用类唯一的类方法，而不是实例——类`classVariable`只有一个副本。`classVariable``AnotherClass`

我希望有些东西可以澄清`static`修饰符的用途。

[Sun的 Java 教程](http://java.sun.com/docs/books/tutorial/index.html)有一个名为“[了解实例和类成员](http://java.sun.com/docs/books/tutorial/java/javaOO/classvars.html)”的部分，其中还介绍了两种类型的变量和方法。

* * *

## 回答 #2

> 赞同：11
> 
> 时间：2009-05-27T01:35:58.517

请在[Wikipedia上查看一个不错的描述](http://en.wikipedia.org/wiki/Method_(computer_science))

例如，注意在数学课上，你可以说像

```
Math.Abs(x); 
```

不用说

```
Math m = new Math(); 
```

这些是静态方法，因为您不需要实例。实例方法是那些要求您拥有类的实例的方法。

```
Employee e = new Employee();
e.Terminate(); 
```

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2009-05-27T01:38:08.650

静态方法是应用于整个类的方法，而不是任何特定成员。.goExtinct() 将是整个鸭子种群的一种方法，而不是任何特定的鸭子。main 是公共的和静态的，因为它必须始终可用，并且它不是任何特定类的一部分。

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2009-05-27T01:49:40.767

通常，你必须有一个对象，一个类的实例，才能调用它的方法，至少有两个原因：

1.  这取决于哪个类实现被调用的方法的对象。例如，如果您有一个子类的实例，则将调用子类中的方法，即使调用该方法的代码是相同的。
2.  对象通常具有内部状态（字段），方法可以引用。如果没有对象实例，这将不起作用。

您可以通过调用类的构造函数来创建对象实例：

```
MyObject a = new MyObject(); 
```

静态方法是不附加到对象实例的方法。只需命名类即可调用它们。因此，他们

1.  不能动态分派给子类（这就是为什么[当您尝试在对象实例上调用它时会收到警告](https://stackoverflow.com/questions/610458/why-isnt-calling-a-static-method-by-way-of-an-instance-an-error-for-the-java-com)，这只是令人困惑的语法）
2.  它们[不能引用实例状态](https://stackoverflow.com/questions/290884/what-is-the-reason-behind-non-static-method-cannot-be-referenced-from-a-static-co)（非静态字段和其他非静态方法）。

许多人认为静态方法是一种糟糕的设计模式，并建议不要使用它们（除了`public static void main`）查找单例实例模式以寻找替代方案。

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2009-05-27T08:32:19.067

在这种特殊情况下，主方法必须是静态的，因为 JVM 将开始加载类和创建对象。当您启动 Java 程序时，JVM 将查找传递给它的类的定义并加载它。所以java MyClass 会导致加载MyClass 类的定义。

根据定义，Java 程序将在作为初始加载的类传递给 JVM 的类的 main() 方法中开始执行。此时尚未创建 MyClass 类型的实例（对象），因此 main 方法必须是静态的以允许开始执行程序。

如果您想查看在 Java 程序执行期间正在加载哪些类，您可以使用 -verbose:class 命令行选项。

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2009-05-27T01:43:39.623

在任何面向对象的编程语言（如 Java 或 C++）中，您创建的类在最基本的层面上就像建筑物的蓝图。您可以查看蓝图并确定各种组件是如何连接的，但您实际上无法生活在其中。类和对象也是如此。类是蓝图，您创建一个称为对象的类的实例。对于同一个蓝图，您可以拥有多个建筑物，对于一个班级，您可以拥有多个对象。对象是类的一个实例。类中的每个方法都可以在 Object 或类的实例上调用，而对于调用静态方法实际上不需要实例，您可以直接调用 ClassName.method() 而无需实际创建类的实例。

* * *

## 回答 #7

> 赞同：0
> 
> 时间：2014-06-10T10:21:55.153

有时您会想要定义一个独立于该类的任何对象使用的类成员。通常，类成员只能与其类的对象一起访问。但是，可以创建一个可以自己使用的成员，而无需参考特定实例。要创建这样的成员，请在其声明之前加上关键字 static。当一个成员被声明为静态时，它可以在其类的任何对象被创建之前被访问，并且不引用任何对象。您可以将方法和变量都声明为静态的。最常见的静态成员示例是 main()。main() 被声明为静态的，因为它必须在任何对象存在之前被调用。静态成员的两种类型是静态字段和静态方法：

```
Static field: 
```

使用 static 关键字声明的字段，如下所示：

```
private static int ballCount: 
```

静态关键字的位置可以与可见性关键字（私有和公共以及受保护）的位置互换。因此，以下语句也有效：

```
static private int ballCount; 
```

作为惯例，大多数程序员倾向于将可见性关键字放在首位。

静态字段的值在类的所有实例中都是相同的。换句话说，如果一个类有一个名为 CompanyName 的静态字段，则从该类创建的所有对象都将具有相同的 CompanyName 值。

首次加载类时会创建和初始化静态字段。当引用类的静态成员或创建类的实例时会发生这种情况，以先到者为准。

```
Static method: 
```

使用 static 关键字声明的方法。与静态字段一样，静态方法与类本身相关联，而不是与从该类创建的任何特定对象相关联。因此，您不必在使用类定义的静态方法之前从类中创建对象。

最著名的静态方法是 main，Java 运行时调用它来启动应用程序。main 方法必须是静态的，这意味着应用程序默认在静态上下文中运行。

使用静态方法的基本规则之一是您不能从静态方法访问非静态方法或字段，因为静态方法没有可用于引用实例方法或字段的类的实例。

# jquery - 如何在 jquery 中序列化文件类型输入

> ID：913562
> 
> 赞同：12
> 
> 时间：2009-05-27T01:35:30.950
> 
> 标签：jquery, serialization, forms

以前使用 Prototype 我可以序列化输入类型文件，它给了我正在上传的文件的文件名，但是当我在 jquery 中序列化表单时，我只得到输入类型文本而其他人没有文件我该怎么做？

* * *

## 回答 #1

> 赞同：11
> 
> 时间：2009-06-25T15:19:15.837

在 Firebug 中花费了几分钟后，实际上似乎有几种方法可以解决这个问题。例如，我能够从 fileObject 本身获取文件列表：

```
var file = $("#control").attr("files")[0];
var fileName = file.fileName;
var fileSize = file.fileSize;

alert("Uploading: "+fileName+" @ "+fileSize+"bytes"); 
```

显然我可以读取序列化的值。但写作是另一个问题。

但显然这并不像其他人声称的那么容易。我冒昧地下载了 Prototype 源代码，但找不到将 FileList 数据用于 File Upload 对象的说明。

事实上，我在网上找到了一篇论文，它对序列化文件上传对象本身的问题进行了分类，声称没有 AJAX 库做得很好（注意，这是在 2007 年编写的）。不过，这个主题很有趣，您似乎可以使用多种方法从文件上传中提取数据 - 规范本身包含充足的信息来指导您走这条路。

我希望我有一个关于如何编写文件并将文件添加到文件列表的答案，但目前我和你一样迷失（或者在问这个问题的时候）。多读一点，这可能比我想象的要容易得多——但目前我没有时间投资。

祝你好运。

### 相关文档：

1.  [W3C 上的文件上传](http://www.w3.org/TR/file-upload/)
2.  Garrett Smith 的[表格序列化，2007 年](http://dhtmlkitchen.com/rec/FormSerialization.html)
3.  [原型 1.6.1RC3 源代码](http://www.prototypejs.org/assets/2009/6/16/prototype.js)（第 3967 行：Form.serializeElements 开始）

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2012-03-13T14:26:43.677

正如其他人提到的，您可以通过 ajax 提交包含文件输入的表单，但它需要一些毛茸茸的 iframe 魔法。如果您不介意使用 jQuery，我强烈建议您使用[jquery.forms](http://jquery.malsup.com/form/)插件的 ajaxSubmit 函数。

* * *

## 回答 #3

> 赞同：3
> 
> 时间：2012-03-09T15:44:03.090

相关 jQuery 错误： [http ://bugs.jquery.com/ticket/2656](http://bugs.jquery.com/ticket/2656)

我添加了自己的 serializeAll 方法而不是序列化：

```
 (function($) { 
    $.fn.serializeAll = function() {
        var rselectTextarea = /^(?:select|textarea)/i;
        var rinput = /^(?:color|date|datetime|datetime-local|email|file|hidden|month|number|password|range|search|tel|text|time|url|week)$/i;
        var rCRLF = /\r?\n/g;

        var arr = this.map(function(){
            return this.elements ? jQuery.makeArray( this.elements ) : this;
        })
        .filter(function(){
            return this.name && !this.disabled &&
                ( this.checked || rselectTextarea.test( this.nodeName ) ||
                    rinput.test( this.type ) );
        })
        .map(function( i, elem ){
            var val = jQuery( this ).val();

            return val == null ?
                null :
                jQuery.isArray( val ) ?
                    jQuery.map( val, function( val, i ){
                        return { name: elem.name, value: val.replace( rCRLF, "\r\n" ) };
                    }) :
                    { name: elem.name, value: val.replace( rCRLF, "\r\n" ) };
        }).get();

        return $.param(arr);
    }
})(jQuery); 
```

然后调用：

```
$('#form').serializeAll() 
```

* * *

## 回答 #4

> 赞同：3
> 
> 时间：2009-07-27T20:26:22.040

这是 FireFox 3 中的一项新功能。

查看[http://blog.igstan.ro/2009/01/pure-javascript-file-upload.html](http://blog.igstan.ro/2009/01/pure-javascript-file-upload.html)

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2010-11-30T18:57:21.763

在原型源（上面引用）中，serializeElements 区分“element.type！='file'”和其他。元素类型“文件”未序列化。

# language-agnostic - 有没有人见过类似的编程难题？

> ID：913566
> 
> 赞同：7
> 
> 时间：2009-05-27T01:37:29.167
> 
> 标签：language-agnostic, dynamic-programming

“假设你想用一排 4×1 和 6×1 的乐高积木拼成一个实心面板。为了结构强度，积木之间的空间绝不能在相邻的行中排列。例如，所示的 18×3 面板下面是不可接受的，因为前两行块之间的空间对齐。

构建 10×1 面板有 2 种方式，构建 10×2 面板有 2 种方式，构建 18×3 面板有 8 种方式，构建 36×5 面板有 7958 种方式。

构建 64×10 面板有多少种不同的方法？答案将适合 64 位有符号整数。编写程序计算答案。你的程序应该运行得非常快——当然，它不应该超过一分钟，即使在旧机器上也是如此。让我们知道您的程序计算的值，您的程序计算该值所用的时间，以及您在哪种机器上运行它。包括程序的源代码作为附件。"

我最近收到了一个编程难题，并且一直在绞尽脑汁试图解决它。我使用 c++ 编写了一些代码，我知道这个数字很大......我的程序运行了几个小时，然后我决定停止它，因为即使在慢速计算机上也需要 1 分钟的运行时间。有没有人见过类似的谜题？已经有几个星期了，我不能再提交了，但这真的让我很烦恼，我无法正确解决它。关于使用算法的任何建议？或者也许可能的解决方法是“开箱即用”。我采用的是制作一个程序，该程序构建每个可能的 4x1 和 6x1 块“层”以制作 64x1 层。结果证明有大约 3300 个不同的层。然后我让我的程序运行并将它们堆叠到所有可能的 10 层高墙上，这些墙没有排列的裂缝……正如你所看到的，这个解决方案需要很长时间。所以很明显，蛮力似乎并不能在时间限制内有效地解决这个问题。任何建议/见解将不胜感激。

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2009-05-27T02:22:02.057

主要见解是：在确定第 3 行中的内容时，您不关心第 1 行中的内容，而只关心第 2 行中的内容。

因此，让我们将如何构建 64x1 层称为“行场景”。您说大约有 3300 行场景。那还不错。

让我们计算一个函数：

f(s, r) = 将行场景编号“s”放入“r”行并合法填充“r”以上所有行的方式数。

（我数的是顶部的“1”行，底部的“10”行）

如果您想避免剧透，请立即停止阅读。

现在很清楚（将我们的行从 1 编号到 10）：

f(s, 1) = 1

对于“s”的所有值。

此外，这就是洞察力的来源，（使用*Mathematica* -ish 表示法）

```
f(s, r) = Sum[ f(i, r-1) * fits(s, i) , {i, 1, 3328} ] 
```

其中“fits”是一个函数，它接受两个场景编号，如果您可以合法地将这两行堆叠在一起，则返回“1”，如果不能，则返回“0”。这使用了洞察力，因为放置场景的合法方式的数量仅取决于根据“适合”在其上方放置场景的方式的数量。

现在，可以预先计算拟合并将其存储在 3328 x 3328 字节数组中。这只是大约 10 兆的内存。（如果您喜欢并将其存储为位数组，则更少）

那么答案显然只是

```
Sum[ f(i, 10) , {i, 1, 3328} ] 
```

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2009-05-29T10:35:48.040

这是我的答案。它是 Haskell，除其他外，您可以免费获得 bignums。

编辑：它现在实际上在合理的时间内解决了问题。

更多编辑：使用稀疏矩阵在我的计算机上需要半秒钟。

您计算平铺一行的每种可能方式。假设有 N 种方法来平铺一行。制作一个 NxN 矩阵。如果第 i 行可以出现在第 j 行旁边，则元素 i,j 为 1，否则为 0。从包含 N 个 1 的向量开始。将矩阵乘以向量的次数等于墙的高度减去 1，然后对结果向量求和。

```
module Main where
import Data.Array.Unboxed
import Data.List
import System.Environment
import Text.Printf
import qualified Data.Foldable as F
import Data.Word
import Data.Bits

-- This records the index of the holes in a bit field
type Row = Word64

-- This generates the possible rows for given block sizes and row length
genRows :: [Int] -> Int -> [Row]
genRows xs n = map (permToRow 0 1) $ concatMap comboPerms $ combos xs n
  where
    combos [] 0 = return []
    combos [] _ = [] -- failure
    combos (x:xs) n =
      do c <- [0..(n `div` x)]
         rest <- combos xs (n - x*c)
         return (if c > 0 then (x, c):rest else rest)
    comboPerms [] = return []
    comboPerms bs =
      do (b, brest) <- choose bs
         rest <- comboPerms brest
         return (b:rest)
    choose bs = map (\(x, _) -> (x, remove x bs)) bs
    remove x (bc@(y, c):bs) =
      if x == y
         then if c > 1
                 then (x, c - 1):bs
                 else bs
         else bc:(remove x bs)
    remove _ [] = error "no item to remove"
    permToRow a _ [] = a
    permToRow a _ [_] = a
    permToRow a n (c:cs) =
      permToRow (a .|. m) m cs where m = n `shiftL` c

-- Test if two rows of blocks are compatible
-- i.e. they do not have a hole in common
rowCompat :: Row -> Row -> Bool
rowCompat x y = x .&. y == 0

-- It's a sparse matrix with boolean entries
type Matrix = Array Int [Int]
type Vector = UArray Int Word64

-- Creates a matrix of row compatibilities
compatMatrix :: [Row] -> Matrix
compatMatrix rows = listArray (1, n) $ map elts [1..n] where
  elts :: Int -> [Int]
  elts i = [j | j <- [1..n], rowCompat (arows ! i) (arows ! j)]
  arows = listArray (1, n) rows :: UArray Int Row
  n = length rows

-- Multiply matrix by vector, O(N^2)
mulMatVec :: Matrix -> Vector -> Vector
mulMatVec m v = array (bounds v)
    [(i, sum [v ! j | j <- m ! i]) | i <- [1..n]]
  where n = snd $ bounds v

initVec :: Int -> Vector
initVec n = array (1, n) $ zip [1..n] (repeat 1)

main = do
  args <- getArgs
  if length args < 3
    then putStrLn "usage: blocks WIDTH HEIGHT [BLOCKSIZE...]"
    else do
      let (width:height:sizes) = map read args :: [Int]
      printf "Width: %i\nHeight %i\nBlock lengths: %s\n" width height
             $ intercalate ", " $ map show sizes
      let rows = genRows sizes width
      let rowc = length rows
      printf "Row tilings: %i\n" rowc
      if null rows
        then return ()
        else do
          let m = compatMatrix rows
          printf "Matrix density: %i/%i\n"
                 (sum (map length (elems m))) (rowc^2)
          printf "Wall tilings: %i\n" $ sum $ elems
                  $ iterate (mulMatVec m) (initVec (length rows))
                            !! (height - 1) 
```

而结果...

```
$ time ./a.out 64 10 4 6
Width: 64
Height 10
Block lengths: 4, 6
Row tilings: 3329
Matrix density: 37120/11082241
Wall tilings: 806844323190414

real    0m0.451s
user    0m0.423s
sys     0m0.012s 
```

好的，500 毫秒，我可以忍受。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2009-05-27T02:58:51.750

我为编程竞赛解决了一个类似的问题，该竞赛用各种形状的瓷砖平铺了一条长长的走廊。我使用了动态编程：给定任何面板，有一种方法可以通过一次放置一行来构建它。每行的末端可以有有限多个形状。因此，对于每个行数，每个形状，我计算有多少种方法可以制作该行。（对于底行，每个形状只有一种方法。）然后每一行的形状决定了下一行可以采用的形状数量（即永远不要排列空格）。这个数字对于每一行都是有限的，事实上，因为你只有两种尺寸的砖，它会很小。因此，您最终会在每行花费固定的时间，并且程序会很快完成。

为了表示一个形状，我只需制作一个 4 和 6 的列表，然后使用这个列表作为表中的键来存储在第*i*行中为每个*i*制作该形状的方法的数量。

# objective-c - 是否有资源可以解释如何将照片导出到网站，例如 iPhoto 到 Facebook 导出？

> ID：913569
> 
> 赞同：3
> 
> 时间：2009-05-27T01:39:45.963
> 
> 标签：objective-c, plugins, export, iphoto

我试图了解从 iPhoto 导出到网站的过程。这将网站将是一个内容管理系统。我已经找到了用于导出的 iPhoto SDK，但无法理解如何将目标更改为网站/服务以及所涉及的过程。我正在寻找一些资源来给我一个整体的架构概述。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2011-02-14T02:24:34.003

我已经用 NSMutableURLRequest 上传了照片。只需将您的照片添加为 POST 数据。

以下是一些可以引导您走上正确道路的链接：

[http://www.cocoadev.com/index.pl?HTTPFileUpload](http://www.cocoadev.com/index.pl?HTTPFileUpload)

[http://www.cocoadev.com/index.pl?POSTMethodANDNSURLRequest](http://www.cocoadev.com/index.pl?POSTMethodANDNSURLRequest)

如果在那之后您真的无法弄清楚，请对此答案发表评论，我会挖掘一些我的旧代码。

# c# - 使用 ObjectDataSource 和 DataObjectTypeName，你如何处理只有一个 id 参数的删除方法？

> ID：913571
> 
> 赞同：4
> 
> 时间：2009-05-27T01:40:24.980
> 
> 标签：c#, .net, asp.net, vb.net, objectdatasource

如果我有一个 ObjectDataSource 设置，例如：

```
<asp:ObjectDataSource 
    ID="ObjectDataSource1" 
    runat="server" 
    DataObjectTypeName="Employee"
    InsertMethod="Insert" 
    UpdateMethod="Update"
    DeleteMethod="Select" 
    TypeName="EmployeeDB">
</asp:ObjectDataSource> 
```

以及具有以下方法的数据/业务对象：

```
public class EmployeeDB
{
    public void Insert(Employee emp)
    public int Update(Employee emp)
    public bool Delete(int id)
} 
```

如何让 objectdatasource 使用带有不是 Employee 对象的参数的 Delete 方法？

如果这不可能，推荐的替代架构是什么？

**编辑：**

为了澄清，我想在我的数据/业务对象上使用方法签名，如上所示，但是如果我尝试允许使用 DataObjectTypeName 将 Employee 对象传递给某些方法，那么我似乎失去了拥有某些方法的能力仅以整数 id 为例。

如果我不使用 DataObjectTypeName，那么我必须将所有方法参数放在 ObjectDataSource 中并更改数据/业务对象上的方法以匹配，这似乎是一个糟糕的设计选择，因为随着 Employee 对象的更改，我将不得不更新这些方法中的每一个。有更好的架构吗？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-12-03T14:56:56.963

这是解决方案，它适用于我的更新操作，然后删除比更新容易得多：

1.  创建类以传递参数。例如：我正在传递 Usermaster 表的参数：UserMasterDT：

    ```
    public UserMasterDT(int userid, int roleid, string Firstname, string )
    {
        this.muserid = userid;
        this.mroleid = roleid;
        this.mfirstname = Firstname;
        this.mlastname = Lastname;
    }

    //Here set this prop as DUMMY output variable, that u used everywhere to get   output value
    public int iRecUpdated
    {
        get { return mrecupdated; }
        set { mrecupdated = value; }
    } 
    ```

2.  我将objectdatasource绑定到formview以更新uperation.Set objectdatasource如下：

    ```
    <asp:ObjectDataSource ID="odsUser" runat="server" 
        TypeName="MMCTaxINTLXMLValidation.UserBLL"
        SelectMethod="GetUserRoleByUserId" 
        DataObjectTypeName="MMCTaxINTLXMLValidation.UserMasterDT"  
        OldValuesParameterFormatString="original_{0}" 
        UpdateMethod="UpdateUserWithTransaction" onupdated="odsUser_Updated">        
        <SelectParameters>
            <asp:QueryStringParameter  Name="iUId" QueryStringField="UserId" Type="Int32" 
                DefaultValue="-1" />
        </SelectParameters>
        <UpdateParameters>
            <asp:Parameter  Name="UserId" Type="Int32" ConvertEmptyStringToNull="true" />
            <asp:Parameter  Name="RoleId" Type="Int32" ConvertEmptyStringToNull="true" />
            <asp:Parameter  Name="Firstname" Type="String"  ConvertEmptyStringToNull="true" />
            <asp:Parameter  Name="Lastname" Type="String" ConvertEmptyStringToNull="true" />       
            <asp:Parameter  Name="BirthDate" Type="String" ConvertEmptyStringToNull="true" />
            <asp:Parameter  Name="MMCEmail" Type="String" ConvertEmptyStringToNull="true" />
            <asp:Parameter  Name="Homecontact" Type="String" ConvertEmptyStringToNull="true" />
            <asp:Parameter  Name="Officecontact" Type="String" ConvertEmptyStringToNull="true" />
            <asp:Parameter  Name="Cellcontact" Type="String" ConvertEmptyStringToNull="true" />
            <asp:Parameter  Name="Logon" Type="String" ConvertEmptyStringToNull="true" />
            <asp:Parameter  Name="Password" Type="String" ConvertEmptyStringToNull="true" />
            <asp:Parameter  Name="PasswordQ1" Type="String" ConvertEmptyStringToNull="true" />
            <asp:Parameter  Name="PasswordA1" Type="String" ConvertEmptyStringToNull="true" />               
        </UpdateParameters>
    </asp:ObjectDataSource> 
    ```

    注意这里没有任何输出参数

3.  现在，IN UR BLL 在更新方法中，传递并返回 UserMasterDT 作为输入和输出。不要传递单独的参数和输出变量。编写如下代码：

    在这里，我正在传入和传出 UserMasterDT

    ```
    [System.ComponentModel.DataObjectMethodAttribute(System.ComponentModel.DataObjectMethodType.Update, true)]
    public UserMasterDT UpdateUserWithTransaction(UserMasterDT tempuser)
    {
        int iRecUpdated = -1;
        Adapter.BeginTransaction();

        try
        {
            string sFlag = "UpdateUserRole";
            int iUserId = tempuser.UserId;
            int iRoleId = tempuser.RoleId;
            string sFirstname = tempuser.Firstname;
            string sLastname = tempuser.Lastname;
            int? iReturnData;

            //THIS OUT IS FROM MY SQL STORED PROCE NOT WITH OBJECTDATASOURCE OUT PARAMETER. IT HAS NOTHING TO DO WITH OBJECT DATA SOUCE.
            Adapter.UpdateUserRole(sFlag,iUserId,iRoleId,sFirstname,sLastname,out iReturnData);

            if (iReturnData == 1)
            {
                iRecUpdated = 1;
                this.Adapter.CommitTransaction();
            }
            else if (iReturnData == null)
                iRecUpdated = -1;

            //What ever is return, set it back to UserMasterDT's iRecUpdated prop
            tempuser.iRecUpdated = iRecUpdated;
            return tempuser;
        }
        catch (Exception ex)
        {
            if (ex != null)
            {
                Adapter.RollbackTransaction();
                //CustomEX objCUEx = new CustomEX(ex.Message, ex);
                ex = null;
                iRecUpdated = -1;    //-1 : Unexpected Error
                //What ever is return, set it back to UserMasterDT's iRecUpdated prop
                tempuser.iRecUpdated = iRecUpdated;
                return tempuser;
            }
        }
        finally
        {
            tempuser.iRecUpdated = iRecUpdated;
        }

        //Return tempuser back
        return tempuser;
    } 
    ```

4.  然后在 aspx.cs 页面中读取 UserMasterDT 的属性如下：

    ```
    if (e.Exception == null)
    {
        UserMasterDT tempuser = (UserMasterDT) e.ReturnValue;
        lblMsg.Text = "Record Updated : " + tempuser.iRecUpdated.ToString();
    } 
    ```

5.  我的存储过程是：

    ```
    set ANSI_NULLS ON

    create PROCEDURE [dbo].[UpdateUserRole]
    (
        @sFlag varchar(50),
        @iUserId int,
        @iRoleId int,
        @sFirstname varchar(50),
        @sLastname varchar(50),
        @iReturnData int output
    )
    as
    Begin
        Declare @errnum as int
        Declare @errseverity as int
        Declare @errstate as int
        Declare @errline as int
        Declare @errproc as nvarchar(100)
        Declare @errmsg as nvarchar(4000)

        -----------------------
        if @sFlag = upper('UPDATEUSERROLE')
        begin
            begin try
                begin tran
                    --Update User Master Table
                    UPDATE    tblUserMaster
                    SET  Firstname = @sFirstname,
                    Lastname = @sLastname,
                    WHERE UserId = @iUserId

                    --Update tblUserRolesTran Table
                    update  tblUserRolesTran
                    set roleid = @iRoleId
                    where Userid = @iUserId

                commit tran -- If commit tran execute then trancount will decrease by 1

                -- Return Flag 1 for update user record and role record
                SET @iReturnData = 1

            end try
            begin catch
                IF @@Trancount > 0
                    -- Get Error Detail In Variable
                    Select  @errnum =@@ERROR,
                    @errseverity = ERROR_SEVERITY(),
                    @errstate = ERROR_STATE(),
                    @errline = ERROR_LINE(),
                    @errproc = ERROR_PROCEDURE(),
                    @errmsg = ERROR_MESSAGE()

                    rollback tran

                    -- To see print msg, keep raise error on, else these msg will not be printed and dislayed
                    print '@errnum : ' + ltrim(str(@errnum ))
                    print '@errseverity : ' + ltrim(str(@errseverity))
                    print '@errstate : ' + ltrim(str(@errstate))
                    print '@errline : ' + ltrim(str(@errline))
                    print '@errproc : ' + @errproc
                    print '@errmsg : ' + @errmsg

                    --Raise error doesn't display error message below 50000
                    --So we have to create custom message and add to error table using  sp_addmessage ( so_addmessage is built-in sp)
                    --In custom error message we have line number and error message
                    Declare @custerrmsg as nvarchar(4000)
                    Select @custerrmsg =  'Proc: UpdateUserRole, Line: ' + ltrim(str(@errline)) +  ': ' + @errmsg

                    if (@errnum < 50000)
                        EXEC SP_ADDMESSAGE @msgnum = 50002, @severity = 16,  @msgtext = @custerrmsg, @replace = 'REPLACE'

                    --After adding custom error message we need to raise error
                    --Raise error will appear at client (.net application)
                    RAISERROR(50002,16,1)
            end catch
            end
            set nocount off
    End 
    ```

* * *

希望这对您需要做的任何事情都有帮助。赛拉姆

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-05-27T02:16:05.830

您必须`DataObjectTypeName="Employee"`从对象数据源声明中删除。此属性获取和设置 ObjectDataSource 控件用于删除方法中的参数的类的名称。

```
 <asp:ObjectDataSource 
        ID="ObjectDataSource1" 
        runat="server" 
        InsertMethod="Insert" 
        UpdateMethod="Update"
        DeleteMethod="Delete" 
        TypeName="EmployeeDB">
        <deleteparameters>
            <asp:parameter name="EmpID" type="Int32" />
        </deleteparameters>
    </asp:ObjectDataSource> 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2011-12-22T12:14:21.557

对象方法签名变量名称必须与对象属性名称完全匹配，并且它将起作用。例如 edit* 也不要忘记 DataKeyNames 属性

```
public class EmployeeDB
{
    public int ID{get;set;}
    public string Name {get;set;}
    public ing Age{get;set;}

    //both these would work
    public void Insert(Employee emp)
    public void Insert(string Name,int Age)

    //both these would work
    public void Update(Employee emp)
    public void Update(int ID,string Name,int Age)

    //works
    public void Delete(Employee emp)

    //WONT work
    public bool Delete(int empId)
    //will work
    public void Delete(int ID)

} 
```

* * *

```
<asp:ObjectDataSource 
    ID="ObjectDataSource1" 
    runat="server" 
    DataObjectTypeName="Employee"
    InsertMethod="Insert" 
    UpdateMethod="Update"
    DeleteMethod="Select" 
    TypeName="EmployeeDB" 
     DataKeyNames="ID">
<DeleteParameters>
    <asp:Parameter Name="ID" Type="Int32" />
</DeleteParameters>
</asp:ObjectDataSource> 
```

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2009-06-08T09:37:36.510

不久前，我将 LinqToSql 用于与此类似的项目。我有两种不同类型的删除方法：

```
 public void DeleteDisconnected(Product original_entity)
    {
        var db = new RmsConcept2DataContext(base.ConnectionString);

        db.Products.Attach(original_entity, false);

        db.Products.DeleteOnSubmit(original_entity);

        db.SubmitChanges();
    }

    public void Delete(int ID)
    {
        var db = new RmsConcept2DataContext(base.ConnectionString);

        Product product = db.Products.Single(p => p.ProductID == ID);

        // delete children
        foreach (Release release in product.Releases)
            db.Releases.DeleteOnSubmit(release);

        db.Products.DeleteOnSubmit(product);

        db.SubmitChanges();
    } 
```

..您可以看到该`DeleteDisconnected`方法旨在接受来自“ObjectDataSource”的整个实体对象。我正在使用

```
ConflictDetection="CompareAllValues" 
```

..和

```
OldValuesParameterFormatString="original_{0}" 
```

在这种情况下，'ObjectDataSource' 上的 ..params 但您可能不需要这样做。我想我仍然可以使用上述方法在删除时获得并发异常 - 这是我当时想要的 - 以利用 LinqToSql 内置的冲突检测/并发功能。

您的架构取决于您如何处理应用程序较低层中的数据等（您似乎在问题中没有提及太多）。将业务对象而不是所有字段作为方法参数传递绝对是更成熟的设计。但有时（对于删除功能）只有`int`ID 是必需的。但这取决于您的底层实现。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2009-05-27T01:50:04.260

当您将 objectdatasource 绑定到控件时，您应该能够根据您尝试绑定的数据获取**Id**（在您的示例中，我假设为 EmployeeId），然后您可以将其设置为删除参数。

在此处查看[msdn 示例](http://msdn.microsoft.com/en-us/library/system.web.ui.webcontrols.objectdatasource.deletemethod.aspx)。

```
<asp:objectdatasource
          id="ObjectDataSource1"
          runat="server"
          selectmethod="GetAllEmployees"
          deletemethod="DeleteEmployee"
          ondeleting="NorthwindEmployeeDeleting"
          ondeleted="NorthwindEmployeeDeleted"
          typename="Samples.AspNet.CS.EmployeeLogic">
          <deleteparameters>
            <asp:parameter name="EmpID" type="Int32" />
          </deleteparameters>
        </asp:objectdatasource> 
```

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2009-05-28T07:21:24.233

即使您按如下方式实现您的类：

```
public class EmployeeDB
{
    public Employee Insert(Employee emp)
    public Employee Update(Employee emp)
    public void Delete(Employee emp)
} 
```

当您尝试删除时，您只会获得绑定到对象上传递的[“DataKeys”的字段，例如ID。](http://msdn.microsoft.com/en-us/library/system.web.ui.webcontrols.gridview.datakeys.aspx)

*附带说明，在插入或更新之后返回对象允许 DataView 更新行。

我记得它的工作方式是您可以配置 ObjectDataSource 以将参数传递给您的 db 层**或**传递对象，而不是两者的组合。

这意味着使用手动配置的参数可以实现以下操作：

```
public class EmployeeDB
{
    public int Insert(string name, DateTime dob)
    public int Update(int id, string name, DateTime dob)
    public void Delete(int id)
} 
```

* * *

## 回答 #7

> 赞同：0
> 
> 时间：2015-05-27T21:10:24.640

遇到这个问题，希望能解决这个确切的难题，在尝试了其他答案提出的建议后，得出的结论是**你不能混合方法**。您的所有方法（插入、更新、删除）都具有：

*   单个自定义类参数（其类型在`DataObjectTypeName`属性中指定），或
*   每个属性的参数列表（在每个或`<InsertParameters>`中指定）。`<UpdateParameters>``<DeleteParameters>`

您不能拥有`Insert`使用单参数版本的`Delete`方法和仅使用`Int32`参数的方法。当我阅读清楚说明的[`ObjectDataSource`文档时，我的发现得到了证实：](https://msdn.microsoft.com/en-us/library/system.web.ui.webcontrols.objectdatasource.dataobjecttypename(v=vs.110).aspx)

> 当设置 DataObjectTypeName 属性并且 ObjectDataSource 控件与数据绑定控件相关联时，由 InsertMethod 和 DeleteMethod 属性指定的方法必须每个都具有一个在 DataObjectTypeName 属性中指定的类型的参数。

唯一的例外可能是`Update`根据`ConflictDetection`属性可以有一个或两个参数的方法，但这是一个完全不同的故事。

我得到的唯一解决方案是重载`Delete`方法来欺骗`ObjectDataSource`，并在内部使用参数调用我的`Delete`方法`Int32`：

```
// This method gets called by the ObjectDataSource
public Int32 Delete(MyCustomClass foo)
{
    // But internally I call the overloaded method
    Delete(foo.Id);
}

public Int32 Delete(Int32 id)
{
    // Delete the item
} 
```

* * *

## 回答 #8

> 赞同：0
> 
> 时间：2016-02-15T17:41:40.157

如果使用 DataObjectTypeName 而不是单独的参数，您正在使用的业务对象将起作用。您只需要添加 DataKeyNames="Id" ，其中 Id 是您的 Bound 控件（如 GridView 或其他内容）中的主键字段。

它将填充您的类型参数，在您的情况下，“Employee”类型带有“Id”值，可用于删除实体。

# c++ - 学习和练习 C++

> ID：913573
> 
> 赞同：3
> 
> 时间：2009-05-27T01:41:18.363
> 
> 标签：c++

我正在尝试学习 C++，我真的很想做很多编码，但我不确定我能编码什么。。Tbh，书本练习对我来说不是很有趣（通常是因为它们太短了）。我喜欢编写与操作系统相关的东西，比如 I/O 东西。

我正在考虑查看 linux 并尝试模仿那里的一些工具..这是个好主意吗？

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2009-05-27T01:45:19.027

重写工具是个好主意 - 我的 C++ 教授让我们在允许我们在家庭作业中使用它们之前手动重写所有标准库字符串函数，因此这也可能对您有所帮助。您还可以查看[Project Euler](http://projecteuler.net/)。

* * *

## 回答 #2

> 赞同：6
> 
> 时间：2009-05-27T01:47:37.570

这是一个涉及I/O的好任务，有有趣的算法，不太简单，不太难，甚至可以有实际应用：

**编写一个简单的压缩器/解压缩器。**

开始的简单想法：LZW，霍夫曼代码。

* * *

## 回答 #3

> 赞同：4
> 
> 时间：2009-05-27T01:54:16.700

我写我感兴趣的东西……例如游戏。扑克游戏或二十一点游戏。我还使用现有的库，看看是否可以制作更好的版本，例如尝试制作性能优于框架版本的 QuickSort。有一天我会写一个国际象棋游戏，但这需要一些时间。:)

* * *

## 回答 #4

> 赞同：4
> 
> 时间：2009-05-27T03:11:31.270

写语言！让 C# 编译为 Sparc V9 程序集（开个玩笑。）但是说真的，我认为，编写一个生成实际机器代码的小型编译器是学习大量软件和硬件（以及操作系统和库，等等等等），并在此过程中学到了很多有用的技能。这是帮助您入门[的龙：）](http://dragonbook.stanford.edu/)

* * *

## 回答 #5

> 赞同：4
> 
> 时间：2009-05-27T03:31:41.590

如果您想编写代码，可以尝试参与一些开源项目。如果您发现一个对您个人有用的项目，它将大大提高您的兴趣水平，并降低您厌倦它并转向其他事情的可能性。另外，您将能够从同一项目的其他开发人员那里获得一些反馈。

* * *

## 回答 #6

> 赞同：1
> 
> 时间：2009-05-27T01:51:47.453

试试 TopCoder。他们的比赛小程序有数百个示例编程问题。其中一些肯定比书中的练习更有趣，而且您还可以看到自己解决问题的能力如何与其他用户相提并论。

# installation - 4：在 g++ apt-get install version string 中是什么意思？

> ID：913575
> 
> 赞同：2
> 
> 时间：2009-05-27T01:41:50.953
> 
> 标签：installation, g++, version, apt-get

在源自 Ubuntu 的 EasyPeasy 1.1（用于迷你笔记本）上，我使用 apt-get 安装了 g++：

```
$ apt-get install g++ 
```

显示的行之一是：

```
Setting up g++ (4:4.3.1-1ubuntu2) ... 
```

“4：”是什么意思？

```
$ g++ --version
g++ (Ubuntu 4.3.2-1ubuntu12) 4.3.2 
```

apt-get 中的“4.3.1”与“4.3.2”g++ 版本有什么关系？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-05-27T02:07:34.113

这是一个[时代](http://www.debian.org/doc/debian-policy/ch-controlfields.html#s-f-Version)。根据 debian 政策手册，

> epochs 的目的是让我们在版本编号中留下错误，并应对版本编号方案发生变化的情况

IIRC gcc 3.4.x 从 3.3.x 系列中引入了与 ABI 不兼容的更改，而这个时代可能是由 debian 维护者当时引入的。

# iphone - 找到离给定点最近的点

> ID：913576
> 
> 赞同：11
> 
> 时间：2009-05-27T01:41:57.863
> 
> 标签：iphone, objective-c, gps

我已经到处搜索了这个，但我似乎找不到最好的方法。我有大约 22000 个纬度/经度点，我想找到最接近 iPhone 当前位置的点。我见过人们询问四叉树、Dijkstra 算法和空间数据库。哪个最适合 iPhone？空间数据库似乎最简单，但我不确定。

编辑：实际上有超过 20,000 点。你认为遍历所有这些是这样做的方法吗？但感谢您的输入。

谢谢。

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2009-05-27T01:51:23.087

实际上，最好对 Lat/Long 点使用 Haversine（大圆）计算，否则越来越大的距离将是错误的，特别是如果您使用[Jherico 的答案](https://stackoverflow.com/questions/913576/finding-the-closest-point-to-a-given-point/913592#913592)中的简单三角函数。

快速搜索提供了这个 javascript 示例：

```
var R = 6371; // km Radius of earth
var dLat = (lat2-lat1).toRad();
var dLon = (lon2-lon1).toRad(); 
var a = Math.sin(dLat/2) * Math.sin(dLat/2) +
        Math.cos(lat1.toRad()) * Math.cos(lat2.toRad()) * 
        Math.sin(dLon/2) * Math.sin(dLon/2); 
var c = 2 * Math.atan2(Math.sqrt(a), Math.sqrt(1-a)); 
var d = R * c; 
```

在数据结构方面，[Geohash](http://en.wikipedia.org/wiki/Geohash)值得一看。

* * *

## 回答 #2

> 赞同：5
> 
> 时间：2009-05-29T04:09:47.827

如果你需要比 O(N) 更好的东西，你只能先支付 N lg N 来构建某种空间散列（四叉树、八叉树、散列网格或类似的）。然后每个测试将大约为 O(lg N)，如果有很多一致性（通常有），通常可以通过缓存您检查的最后一个位置来更好地进行测试。

我可能会在欧拉（地心，XYZ）空间中构建一个八叉树，因为这可以让我获得“真实”的距离，而不是“扭曲”的纬度/经度距离。但是，在实践中，纬度/经度空间中的四叉树可能会运行得很好。命中后，您将保留该树节点（假设树在运行时未重新构建），并且下一个查询从该树节点开始遍历，并且只需要担心可能更接近的节点上一点离上一个答案更远了。

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2009-05-27T09:42:26.273

正如您在 iPhone 上一样，您可以使用 CoreLoaction 来执行地理距离 - 使用 CLLocation 的`– getDistanceFrom:`

我很想在所有 2k 点上使用蛮力线性搜索，如果这还不够快，请切换到 GeoHash 之类的东西来存储针对您的搜索点的元数据。

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2009-05-29T07:01:22.933

为什么不将地球平铺成区域？（想想十六进制。）然后，当您将点添加到列表中时，或者在一个大的预处理循环中，对于每个点，存储它所在的区域。

那么，在 hex X 中搜索点 A 附近的点时，只需要检查 hex X 中的点和最多 3 个相邻的 hex。

如果仍然需要检查的点太多，请添加子区域。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2015-02-19T09:30:17.640

您必须考虑到要使用 Dijkstra，您必须知道您在图中的节点位置，而不是您要解决的问题；你不在图中，但你想知道离你最近的点

很简单，正如 Chaos 告诉你的那样，你必须计算你的位置和所有 20.000 个点之间的所有距离，然后对它们进行排序

* * *

## 回答 #6

> 赞同：-3
> 
> 时间：2009-09-19T21:47:57.903

我认为这个算法有效：

创建一个按纬度排序的数组 创建一个按经度排序的数组

要找到最接近的，首先通过在纬度数组中进行二进制搜索来按纬度找到最近的。对经度数组执行相同的操作。现在你有 2 个点，一个最接近纬度，另一个最接近经度。通过勾股定理计算到每个点的距离。最近的点获胜。

罗杰

# regex - 如何在跳过某些文件夹时重写所有 url？

> ID：913577
> 
> 赞同：0
> 
> 时间：2009-05-27T01:42:30.420
> 
> 标签：regex, mod-rewrite

我正在尝试重写我的网址以转到单个 php 文件：

```
RewriteRule ^dir/(?:(?!style|js).)*$ http://www.domain.com/single.php?uri=$1 [QSA] 
```

然而，排除 /dir/js 和 /dir/style 并没有像我希望的那样工作......

*   [重定向] domain.com/dir
*   [重定向] domain.com/dir/jason
*   [重定向] domain.com/dir/jason/pete
*   [不重定向：好] domain.com/dir/js
*   [不重定向：好] domain.com/dir/js/*
*   [不重定向：错误] domain.com/dir/ **js** on

**如何更改正则表达式以满足我的需要？**

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-05-27T02:03:41.970

尝试替换`style|js`为`style\b|js\b`.

也许`RewriteCond`可以像在

```
RewriteCond %{REQUEST_URI} !^/dir/(style|js)($|/)
RewriteRule ^/dir/(.*)$ http://www.domain.com/single.php?uri=$1 [QSA] 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-05-27T01:59:30.170

编辑：

domain.com/dir/json 不会重定向，因为它与正则表达式不匹配。

/dir/json 不重定向的原因是因为 js 遵循 dir/，并且您的正则表达式仅在 dir/ 未遵循样式或 js*时匹配。*我认为消极的前瞻是错误的方法。我认为您真正想要的是：

```
RewriteCond %{REQUEST_URI} !^/dir/(js|style)(/.*)?$
RewriteRule ^dir/(.*)$ http://www.domain.com/single.php?uri=$1 [LQSA] 
```

这基本上意味着如果 URL*不*以 /js 或 /style 结尾（可选地在这些目录下具有更多路径组件），*则*应用重定向规则。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-08-03T14:41:12.007

要么与您的否定前瞻断言：

```
RewriteRule ^dir/(?!(?:style|js)(?:/|$))(.*) http://www.example.com/single.php?uri=$1 [QSA] 
```

但这不是很好。

或者你只是添加另一个关于如何`$1`开始的测试：

```
RewriteCond $1 !^(style|js)(/|$)
RewriteRule ^dir/(.*) http://www.example.com/single.php?uri=$1 [QSA] 
```

# google-maps - 使用具有不同域的谷歌地图 API

> ID：913580
> 
> 赞同：2
> 
> 时间：2009-05-27T01:43:45.270
> 
> 标签：google-maps, google-api

好的，所以我有一个使用 google maps API 的站点，我想从更多域中提供它。API 密钥与域绑定的事实极大地阻碍了我在这方面的努力。

有没有比为每个域获取密钥更优雅的解决方案？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2009-06-30T06:53:43.907

有一种方法可以完全避免使用 API 密钥*-*使用版本 3 API。

v3 API 仍处于“测试版”，但它具有大多数人用于地图的密钥（不是双关语）功能，并且不需要密钥。根据谷歌的说法，未来也不会有。如果您可以在没有可拖动标记之类的功能的情况下度过难关，那么 v3 将运行良好。我将它用于我的主地图页面并且没有任何问题。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2009-05-27T01:51:01.543

您可以设置代理。但显然这会使您的代码复杂化，并且您有责任确保只有您的域可以访问代理。

# directshow - DirectX 运行时是否包含 directshow 运行时库？

> ID：913586
> 
> 赞同：1
> 
> 时间：2009-05-27T01:45:58.073
> 
> 标签：directshow

我正在编写一个使用直接显示来捕获和显示网络摄像头数据的 activex 控件。

如果 DirectX 运行时包含用于 directshow 的所有内容，我不需要将它与控件捆绑在一起。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-05-27T03:24:03.837

为带有 Service Pack 2 (SP2) 和更高版本的 Windows XP 编写的 DirectShow 应用程序不需要重新分发任何 DirectShow DLL。

对于带有 Service Pack 1 (SP1) 和更早版本的 Windows XP，可从 Microsoft DirectX SDK 获得可再发行的 DirectShow DLL。这些 DLL 的最新版本是 9.0c 版。没有计划进一步开发这些可再分发的 DLL。带有 Service Pack 2 (SP2) 的 Windows XP 包含 9.0c 版 DLL。

[http://msdn.microsoft.com/en-us/library/dd377592(VS.85).aspx](http://msdn.microsoft.com/en-us/library/dd377592(VS.85).aspx)

# git - 通过 SSH 推送到远程存储库时出现“拒绝访问”

> ID：913587
> 
> 赞同：2
> 
> 时间：2009-05-27T01:46:09.557
> 
> 标签：git, ssh

我是 Git 的新手，似乎在通过网络推送到存储库时遇到问题。
这是我为重现问题所做的工作：

1.  在计算机上创建一个新的 Git 存储库以推送到

    ```
    mkdir ~/git/test.git
    cd !$
    git --bare init 
    ```

2.  然后在我的本地计算机上创建一个新的 Git 存储库并向其中添加一个随机文件：

    ```
    mkdir test
    git init
    touch TEST
    git add .
    git commit -m "initial commit" 
    ```

3.  然后通过以下方式添加远程计算机：`git remote add origin ssh://user@site.com/~/git/test.git`

4.  然后我尝试通过以下方式将本地存储库推送到远程：`git push origin master`

这就是我这样做时得到的：

```
fatal: protocol error: bad line length character  <- sometimes not there
Access denied
Access denied
Access denied
Access denied
FATAL ERROR: Server sent disconnect message
type 2 (protocol error):
"Too many authentication failures for user" 
```

我在 XP 机器上使用 cygwin 并尝试推送到 unix 服务器。

我也在家里的两台电脑之间尝试过，我也有同样的问题，顺便说一句，这两台电脑都是windows机器。

我已经通过 SSH 设置了`ssh`无密码登录，我可以通过以下方式解决问题：`ssh user@site.com`

我已经尝试了两天了，任何帮助将不胜感激

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2009-05-27T18:18:50.863

问题可能是 ~ 在 ssh URI 中使用时无法正确扩展。您需要在 ssh URI 中指定远程计算机上 git 存储库的绝对路径，如下所示：

```
ssh://user@site.com/home/user/git/test.git
```

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2011-06-20T16:09:46.483

我遇到了类似的问题，但解决方案对我的情况有点不同。我收到的错误消息是：

```
$> git push -v unfuddle master
Pushing to git@subdomain.unfuddle.com:subdomain/repo.git
Received disconnect from 174.129.246.239: 2: Too many authentication failures for git
fatal: The remote end hung up unexpectedly 
```

我无法弄清楚问题是什么， ssh -vv 也没有显示任何内容。我的 ~/.ssh/config 中已经有了这个文本

```
Host subdomain.unfuddle.com
    User git
    IdentityFile ~/.ssh/unfuddle-subdomain-key 
```

问题原来是 Unfuddle 的 SSH 服务器被配置为在尝试了一定数量的 SSH 密钥后拒绝访问。尽管我有一个特定的 IdentityFile 集，但我的 SSH 客户端出于未知原因，会按顺序尝试所有本地 SSH 密钥，直到 Unfuddle 拒绝访问。解决方案是将 SSH“IdentitiesOnly”配置选项设置为“yes”，这会告诉本地 SSH 客户端只发送那个 IdentityFile 而没有其他的。

```
# The fixed ~/.ssh/config line
Host subdomain.unfuddle.com
    User git
    IdentitiesOnly yes
    IdentityFile ~/.ssh/unfuddle-subdomain-key 
```

参考：[http ://railspikes.com/2010/2/1/fixing-the-heroku-too-many-authentication-failures-for-git-problem](http://railspikes.com/2010/2/1/fixing-the-heroku-too-many-authentication-failures-for-git-problem)

希望这可以帮助某人。

詹姆士

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2009-05-27T18:26:50.287

尝试使用

```
ssh://user@site.com:/home/user/git/test.git 
```

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2009-05-27T02:53:53.240

我不确定您的访问问题，但路径

```
git remote add origin ssh://user@site.com/~/git/test.git 
```

让我担心。你得到什么

```
git remote add origin ssh://user@site.com/git/test.git 
```

?

也请显示输出`git push -v ...`

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2013-08-16T08:51:41.927

解决此类问题的另一个关键。在我们的例子中，原因是带有存储库和权限的 gitolite.conf 文件。有人使用 Windows 记事本对其进行了编辑，并在其中添加了 BOM 标头。在此存储库出现非常奇怪的行为之后，当一些用户可以但有些用户无法写入它时，会收到拒绝访问的消息。

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2009-05-30T18:13:48.507

在您的情况下，问题可能是 ~ 字符。利用：

```
 git remote add origin user@site.com/git/test.git 
```

但是，当用户名（“user@”）部分丢失时，我也看到了这个问题（总是在 Windows 客户端机器上），所以其他有这个问题的人也应该检查一下。

# python - Django表单，表单字段的继承和顺序

> ID：913589
> 
> 赞同：70
> 
> 时间：2009-05-27T01:46:50.083
> 
> 标签：python, django, django-forms

我在我的网站中使用 Django 表单，并希望控制字段的顺序。

这是我定义表单的方式：

```
class edit_form(forms.Form):
    summary = forms.CharField()
    description = forms.CharField(widget=forms.TextArea)

class create_form(edit_form):
    name = forms.CharField() 
```

该名称是不可变的，仅应在创建实体时列出。我使用继承来添加一致性和 DRY 原则。发生的事情并没有错，事实上完全可以预料的是，名称字段在视图/html 中最后列出，但我希望名称字段位于摘要和描述之上。我确实意识到我可以通过将摘要和描述复制到 create_form 并松散继承来轻松修复它，但我想知道这是否可能。

**为什么？**想象一下，您在 edit_form 中有 100 个字段，并且必须在 create_form 的顶部添加 10 个字段 - 复制和维护这两个表单看起来不会那么性感。（这*不是*我的情况，我只是在编一个例子）

那么，我怎样才能覆盖这种行为呢？

**编辑：**

显然，如果不经历令人讨厌的黑客攻击（摆弄 .field 属性），就没有合适的方法来做到这一点。.field 属性是一个 SortedDict（Django 的内部数据结构之一），它不提供任何重新排序键：值对的方法。但是，它确实提供了一种在给定索引处插入项目的方法，但这会将项目从类成员移动到构造函数中。这种方法可行，但会使代码的可读性降低。我认为合适的唯一其他方法是修改框架本身，这在大多数情况下都不是最佳的。

简而言之，代码将变成这样：

```
class edit_form(forms.Form):
    summary = forms.CharField()
    description = forms.CharField(widget=forms.TextArea)

class create_form(edit_form):
    def __init__(self,*args,**kwargs):
        forms.Form.__init__(self,*args,**kwargs)

        self.fields.insert(0,'name',forms.CharField()) 
```

那让我闭嘴：）

* * *

## 回答 #1

> 赞同：107
> 
> 时间：2009-07-15T19:29:22.687

### 从 Django 1.9+

Django 1.9 添加了一个新`Form`属性 ,`field_order`允许对字段进行排序，而不管它们在类中的声明顺序。

```
class MyForm(forms.Form):
    summary = forms.CharField()
    description = forms.CharField(widget=forms.TextArea)
    author = forms.CharField()
    notes = form.CharField()

    field_order = ['author', 'summary'] 
```

缺少的字段在`field_order`类中保持其顺序，并附加在列表中指定的字段之后。上面的示例将按以下顺序生成字段：`['author', 'summary', 'description', 'notes']`

请参阅文档：[https ://docs.djangoproject.com/en/stable/ref/forms/api/#notes-on-field-ordering](https://docs.djangoproject.com/en/stable/ref/forms/api/#notes-on-field-ordering)

### 高达 Django 1.6

我遇到了同样的问题，我在[Django CookBook](http://code.djangoproject.com/wiki/CookBookNewFormsFieldOrdering)中找到了另一种重新排序字段的技术：

```
class EditForm(forms.Form):
    summary = forms.CharField()
    description = forms.CharField(widget=forms.TextArea)

class CreateForm(EditForm):
    name = forms.CharField()

    def __init__(self, *args, **kwargs):
        super(CreateForm, self).__init__(*args, **kwargs)
        self.fields.keyOrder = ['name', 'summary', 'description'] 
```

* * *

## 回答 #2

> 赞同：16
> 
> 时间：2015-06-12T03:27:41.527

从 Django 1.9：[https ://docs.djangoproject.com/en/1.10/ref/forms/api/#notes-on-field-ordering](https://docs.djangoproject.com/en/1.10/ref/forms/api/#notes-on-field-ordering)

* * *

**原始答案：**默认情况下，Django 1.9 将在表单上支持此功能`field_order`：

```
class MyForm(forms.Form):
    ...
    field_order = ['field_1', 'field_2']
    ... 
```

[https://github.com/django/django/commit/28986da4ca167ae257abcaf7caea230eca2bcd80](https://github.com/django/django/commit/28986da4ca167ae257abcaf7caea230eca2bcd80)

* * *

## 回答 #3

> 赞同：12
> 
> 时间：2010-04-12T02:38:58.320

我使用了 Selene 发布的解决方案，但发现它删除了所有未分配给 keyOrder 的字段。我子类化的表单有很多字段，所以这对我来说效果不佳。我使用 akaihola 的答案编写了这个函数来解决问题，但是如果你想让它像 Selene 一样工作，你需要做的就是设置`throw_away`为`True`.

```
def order_fields(form, field_list, throw_away=False):
    """
    Accepts a form and a list of dictionary keys which map to the
    form's fields. After running the form's fields list will begin
    with the fields in field_list. If throw_away is set to true only
    the fields in the field_list will remain in the form.

    example use:
    field_list = ['first_name', 'last_name']
    order_fields(self, field_list)
    """
    if throw_away:
        form.fields.keyOrder = field_list
    else:
        for field in field_list[::-1]:
            form.fields.insert(0, field, form.fields.pop(field)) 
```

这就是我在自己的代码中使用它的方式：

```
class NestableCommentForm(ExtendedCommentSecurityForm):
    # TODO: Have min and max length be determined through settings.
    comment = forms.CharField(widget=forms.Textarea, max_length=100)
    parent_id = forms.IntegerField(widget=forms.HiddenInput, required=False)

    def __init__(self, *args, **kwargs):
        super(NestableCommentForm, self).__init__(*args, **kwargs)
        order_fields(self, ['comment', 'captcha']) 
```

* * *

## 回答 #4

> 赞同：10
> 
> 时间：2014-05-12T17:35:17.040

似乎在某些时候，字段顺序的基础结构从特定的 django 更改`SordedDict`为 python 标准`OrderedDict`

因此，在 1.7 中，我必须执行以下操作：

```
from collections import OrderedDict

class MyForm(forms.Form):

    def __init__(self, *args, **kwargs):
        super(MyForm, self).__init__(*args, **kwargs)
        original_fields = self.fields
        new_order = OrderedDict()
        for key in ['first', 'second', ... 'last']:
            new_order[key] = original_fields[key]
        self.fields = new_order 
```

我敢肯定有人可以将它打成两三条线，但出于这样的目的，我认为清楚地展示它是如何工作的比切肉刀更好。

* * *

## 回答 #5

> 赞同：7
> 
> 时间：2011-12-12T15:26:51.133

您还可以创建一个装饰器来排序字段（受 Joshua 解决方案的启发）：

```
def order_fields(*field_list):
    def decorator(form):
        original_init = form.__init__
        def init(self, *args, **kwargs):
            original_init(self, *args, **kwargs)        
            for field in field_list[::-1]:
                self.fields.insert(0, field, self.fields.pop(field))
        form.__init__ = init
        return form            
    return decorator 
```

这将确保传递给装饰器的所有字段都排在第一位。你可以像这样使用它：

```
@order_fields('name')
class CreateForm(EditForm):
    name = forms.CharField() 
```

* * *

## 回答 #6

> 赞同：6
> 
> 时间：2014-12-15T21:53:46.140

接受的答案的方法使用了在 Django 1.7 中更改的内部 Django 表单 API。[项目团队的意见是，一开始就不应该使用它。](https://code.djangoproject.com/timeline?from=2014-09-07T19%3A47%3A59%2B01%3A00&precision=second)我现在使用这个功能来重新排列我的表格。此代码使用`OrderedDict`：

```
def reorder_fields(fields, order):
    """Reorder form fields by order, removing items not in order.

    >>> reorder_fields(
    ...     OrderedDict([('a', 1), ('b', 2), ('c', 3)]),
    ...     ['b', 'c', 'a'])
    OrderedDict([('b', 2), ('c', 3), ('a', 1)])
    """
    for key, v in fields.items():
        if key not in order:
            del fields[key]

    return OrderedDict(sorted(fields.items(), key=lambda k: order.index(k[0]))) 
```

我在这样的课程中使用：

```
class ChangeOpenQuestionForm(ChangeMultipleChoiceForm):

    def __init__(self, *args, **kwargs):
        super().__init__(*args, **kwargs)
        key_order = ['title',
                     'question',
                     'answer',
                     'correct_answer',
                     'incorrect_answer']

        self.fields = reorder_fields(self.fields, key_order) 
```

* * *

## 回答 #7

> 赞同：3
> 
> 时间：2009-05-27T02:05:53.197

[请参阅此 SO question](https://stackoverflow.com/questions/350799/how-does-django-know-the-order-to-render-form-fields)中有关 Django 内部跟踪字段顺序的方式的注释；答案包括有关如何根据自己的喜好“重新排序”字段的建议（最终归结为弄乱`.fields`属性）。

* * *

## 回答 #8

> 赞同：2
> 
> 时间：2009-11-09T21:22:10.813

更改字段顺序的替代方法：

弹出和插入：

```
self.fields.insert(0, 'name', self.fields.pop('name')) 
```

弹出和附加：

```
self.fields['summary'] = self.fields.pop('summary')
self.fields['description'] = self.fields.pop('description') 
```

全部弹出并追加：

```
for key in ('name', 'summary', 'description'):
    self.fields[key] = self.fields.pop(key) 
```

订购副本：

```
self.fields = SortedDict( [ (key, self.fields[key])
                            for key in ('name', 'summary' ,'description') ] ) 
```

但是 Selene 从 Django CookBook 中的方法仍然感觉最清晰。

* * *

## 回答 #9

> 赞同：1
> 
> 时间：2012-09-17T16:40:49.033

基于@akaihola 的回答并更新为与最新的 Django 1.5 一起使用，因为`self.fields.insert`它正在[折旧](https://github.com/django/django/blob/master/django/utils/datastructures.py#L227)。

```
from easycontactus.forms import *
from django import forms
class  CustomEasyContactUsForm(EasyContactUsForm):
    ### form settings and configuration
    CAPTHCA_PHRASE = 'igolf'

    ### native methods
    def __init__(self, *args, **kwargs):
        super(CustomEasyContactUsForm, self).__init__(*args, **kwargs)
        # re-order placement of added attachment field 
        self.fields.keyOrder.insert(self.fields.keyOrder.index('captcha'),
                                    self.fields.keyOrder.pop(self.fields.keyOrder.index('attachment'))
                                    )

    ### field defintitions
    attachment = forms.FileField() 
```

在上面我们扩展了一个 EasyContactUsForm 基类，因为它在[django-easycontactus](https://github.com/danielsokolowski/django-easycontactus)包中定义。

* * *

## 回答 #10

> 赞同：0
> 
> 时间：2015-10-09T09:31:11.177

我构建了一个从 Django-Registration-Redux 的“RegistrationForm”继承的表单“ExRegistrationForm”。我遇到了两个问题，其中一个是在创建新表单后重新排序 html 输出页面上的字段。

我解决了它们如下：

**1\. 问题 1：从注册表单中删除用户名：在 my_app.forms.py**

```
 class ExRegistrationForm(RegistrationForm):
          #Below 2 lines extend the RegistrationForm with 2 new fields firstname & lastname
          first_name = forms.CharField(label=(u'First Name'))
          last_name = forms.CharField(label=(u'Last Name'))

          #Below 3 lines removes the username from the fields shown in the output of the this form
          def __init__(self, *args, **kwargs):
          super(ExRegistrationForm, self).__init__(*args, **kwargs)
          self.fields.pop('username') 
```

**2\. 问题 2：让 FirstName 和 LastName 出现在顶部：在 templates/registration/registration_form.html**

您可以按所需顺序单独显示字段。如果字段数量较少，这将有所帮助，但如果您有大量字段，实际上不可能在表单中实际写入它们，这将有所帮助。

```
 {% extends "base.html" %}
     {% load i18n %}

     {% block content %}
     <form method="post" action=".">
          {% csrf_token %}

          #The Default html is: {{ form.as_p }} , which can be broken down into individual elements as below for re-ordering.
          <p>First Name: {{ form.first_name }}</p>
          <p>Last Name:  {{ form.last_name }}</p>
          <p>Email: {{ form.email }}</p>
          <p>Password: {{ form.password1 }}</p>
          <p>Confirm Password: {{ form.password2 }}</p>

          <input type="submit" value="{% trans 'Submit' %}" />
      </form>
      {% endblock %} 
```

* * *

## 回答 #11

> 赞同：0
> 
> 时间：2019-06-21T05:35:21.127

上面的答案是正确的，但不完整。它们仅在所有字段都定义为类变量时才有效。`__init__`必须在初始化程序 ( )中定义的动态表单字段呢？

```
from django import forms

class MyForm(forms.Form):
    field1 = ...
    field2 = ...

    field_order = ['val', 'field1', 'field2']

    def __init__(self, val_list, *args, **kwargs):
        super(MyForm, self).__init__(*args, **kwargs)
        vals = zip(val_list, val_list)
        self.fields['val'] = forms.CharField(choices=vals) 
```

上述内容永远不会适用，`val`但适用于`field1`and `field2`（如果我们重新排序它们）。您可能想尝试`field_order`在初始化程序中定义：

```
class MyForm(forms.Form):
    # other fields

    def __init__(self, val_list, *args, **kwargs):
        super(MyForm, self).__init__(*args, **kwargs)
        vals = zip(val_list, val_list)
        self.fields['val'] = forms.CharField(choices=vals)
        self.field_order = ['val', 'field1', 'field2'] 
```

但这也会失败*，**因为*在调用.*`super()`*

 *因此，唯一的解决方案是构造函数 ( `__new__`) 并设置`field_order`为类变量。

```
class MyForm(forms.Form):
    # other fields

    field_order = ['val', 'field1', 'field2']

    def __new__(cls, val_list, *args, **kwargs):
        form = super(MyForm, cls).__new__(cls)
        vals = zip(val_list, val_list)
        form.base_fields['val'] = forms.CharField(choices=vals)
        return form 
```

# python - django错误'解包的值太多'

> ID：913590
> 
> 赞同：25
> 
> 时间：2009-05-27T01:46:50.133
> 
> 标签：python, django, sqlite

我正在通过构建一个简单的食谱应用程序来学习 Django。我有一个使用配方类别的“选择”字段选项的 1 表模型，而不是使用第二个“类别”表和外键关系。所以我通过syncdb创建了数据库表，然后用测试数据加载了表。当我转到管理员并单击“食谱”链接以尝试查看食谱时，我收到以下错误：

```
Template error

In template /var/lib/python-support/python2.6/django/contrib/admin/templates/admin/change_list.html, error at line 34
Caught an exception while rendering: too many values to unpack 
```

如果有人能阐明这个神秘的错误，那就太好了。Db 是 Sqlite。Django 版本是 1.0。型号如下：

```
from django.db import models

class Recipe(models.Model):
    CATEGORY_CHOICES = (
        (1, u'Appetizer'),
        (2, u'Bread'),
        (3, u'Dessert'),
        (4, u'Drinks'),
        (5, u'Main Course'),
        (6, u'Salad'),
        (7, u'Side Dish'),
        (8, u'Soup'),
        (9, u'Sauce/Marinade'),
        (10, u'Other'),        
    )
    name = models.CharField(max_length=255)
    submitter = models.CharField(max_length=40)
    date = models.DateTimeField()
    category = models.SmallIntegerField(choices=CATEGORY_CHOICES)
    ingredients = models.TextField()
    directions = models.TextField()
    comments = models.TextField(null=True, blank=True) 
```

* * *

## 回答 #1

> 赞同：22
> 
> 时间：2011-11-21T02:24:40.817

**编辑：根据 kibibu 的更正进行了更新。**

我遇到了我认为是同样的错误，产生了以下消息：

```
Caught ValueError while rendering: too many values to unpack 
```

我的表单类如下：

```
class CalcForm(forms.Form):
    item = forms.ChoiceField(choices=(('17815', '17816'))) 
```

请注意，我`choices`这里的类型是一个元组。`choices`Django 官方文档中的arg内容如下：

> 2 元组的可迭代（例如，列表或元组）用作该字段的选择。此参数接受与模型字段的选择参数相同的格式。

来源：[https ://docs.djangoproject.com/en/1.3/ref/forms/fields/#django.forms.ChoiceField.choices](https://docs.djangoproject.com/en/1.3/ref/forms/fields/#django.forms.ChoiceField.choices)

通过我观察文档并使用**元组列表解决了这个问题：**

```
class CalcForm(forms.Form):
    item = forms.ChoiceField(choices=[('17815', '17816')]) 
```

请注意，虽然文档声明可以使用任何正确形式的可迭代对象，但 2 元组的元组不起作用：

```
item = forms.ChoiceField(choices=(('17815', '17816'), ('123', '456'))) 
```

这产生了与以前相同的错误。

教训：错误发生。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2011-05-13T10:45:47.210

You should use a `ChoiceField` instead of `SmallIntegerField`

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2009-05-27T02:22:04.537

根据[http://code.djangoproject.com/ticket/972](http://code.djangoproject.com/ticket/972)，您需要将赋值移到语句`CATEGORY_CHOICES = ...` *之外*`class`。

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2009-05-27T01:53:35.437

如果我不得不猜测，那是因为管理模板中的任何内容都需要一个元组列表，但是您却提供了一个元组的元组（因此“值太多”）。尝试用列表替换：

```
CATEGORY_CHOICES = [    # Note square brackets.
    (1, u'Appetizer'),
    (2, u'Bread'),
    (3, u'Dessert'),
    (4, u'Drinks'),
    (5, u'Main Course'),
    (6, u'Salad'),
    (7, u'Side Dish'),
    (8, u'Soup'),
    (9, u'Sauce/Marinade'),
    (10, u'Other'),        
] 
```

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2013-10-10T18:01:42.047

kibibu's comment to Kreychek's answer is correct. This isn't a Django issue but rather an interesting aspect of Python. To summarize:

In Python, round parentheses are used for both order of operations and tuples. So:

```
foo = (2+2) 
```

will result in foo being 4, not a tuple who's first and only element is 4: 4

```
foo = (2+2, 3+3) 
```

will result in foo being a two-dimensional tuple: (4,6)

To tell Python that you want to create a one-dimensional tuple instead of just denoting the order of operations, use a trailing comma:

```
foo = (2+2,) 
```

will result in foo being a one-dimensional tuple who's first and only element is 4: (4,)

So for your scenario:

```
class CalcForm(forms.Form):
    item = forms.ChoiceField(choices=(('17815', '17816'),)) 
```

would give what you want. Using a list is a great solution too (more Pythonic in my opinion), but hopefully this answer is informative since this can come up in other cases.

For example:

```
print("foo: %s" % (foo)) 
```

may give an error if foo is an iterable, but:

```
print("foo: %s" % (foo,)) 
```

or:

```
print("foo: %s" % [foo]) 
```

will properly convert foo to a string whether it's an iterable or not.

Documentation: [http://docs.python.org/2/tutorial/datastructures.html#tuples-and-sequences](http://docs.python.org/2/tutorial/datastructures.html#tuples-and-sequences)

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2009-05-27T02:37:17.363

我让它工作了。我在谷歌搜索时遇到的大多数“太多值无法解包”错误都是值错误类型。我的错误是模板语法类型。为了加载我的食谱表，我导入了一个 csv 文件。我在想sqlite允许导入的数据中可能存在问题。所以我删除了所有数据，然后通过 django 管理表单手动添加了 2 个食谱。之后加载的食谱列表。

谢谢。

* * *

## 回答 #7

> 赞同：0
> 
> 时间：2010-05-06T01:37:56.000

我只是遇到了同样的问题......我的 cvs 文件来自 ms excel，并且日期字段在节省时间时格式错误。我将格式更改为“2010-05-04 13:05:46.790454”（excel 给了我 2010 年 5 月 5 日 10:05:47）之类的格式，并且瞧，不再需要“解包的值太多”</p>

* * *

## 回答 #8

> 赞同：0
> 
> 时间：2019-04-12T11:12:00.533

当函数返回三个值并将其分配给 2 时，IMO 会发生此错误。例如：

```
def test():
    a=0
    b=0
    c=0
.... 
a,b=test() <---three values returned, but only assigning to 2. 
```

a,b,c=test() <---返回三个值，赋值给3.OK

# c# - c#真值和假值

> ID：913606
> 
> 赞同：37
> 
> 时间：2009-05-27T01:53:44.080
> 
> 标签：c#, .net

在 JavaScript 中有真值和假值的概念。

例如

*   0：总是假的
*   1：总是正确的
*   “0”：始终为真
*   '1' : 总是正确的

.NET 框架上的 C# 语言中是否有等效的真值和假值列表？

我想知道这一点的原因是我发现自己在做以下事情

```
if(obj != null)
{
   // Do something with the object
} 
```

当我可以写以下

```
if(obj)
{
   // Do something with the object
} 
```

* * *

## 回答 #1

> 赞同：47
> 
> 时间：2009-05-27T02:00:24.427

C# 只有文字`true`和`false`值。

C# 要求您在声明中非常明确，因为它是一种强类型语言，而 JavaScript 则可以在需要时进行隐式转换。

需要注意的是，“强类型”并不是 C# 不隐式转换为“真/假”值的原因。该语言有意尝试避免其他编译语言（例如 C++）的缺陷，其中某些值可能是真实的，例如 ' `0`' 或 ' `1`' 这可能允许您犯语法错误，直到运行时您的代码行为异常时才注意到。

* * *

## 回答 #2

> 赞同：33
> 
> 时间：2009-06-05T13:22:17.977

默认情况下，C# 仅提供`true`和`false`.

但是，您可以通过实现运算符让您自己的自定义类型变为“真”和“假” `true`。当一个类型实现`true`操作符时，该类型的实例可以用作布尔表达式。从[C# 语言规范](http://download.microsoft.com/download/3/8/8/388e7205-bc10-4226-b2a8-75351c669b09/csharp%20language%20specification.doc)的第 7.19 节：

> 当布尔表达式的类型不能隐式转换为 bool 但确实实现了 operator true 时，在对该表达式求值之后，调用该类型提供的 operator true 实现以产生一个 bool 值。
> 
> §11.4.2 中的`DBBool`struct 类型提供了实现 operator true 和 operator false 的类型示例。

这是`true`运算符声明的代码片段（它可能会完成您在问题中想要做的事情）：

```
public static bool operator true(MyType myInstance)
{
    return myInstance != null;
} 
```

如果你实现了`true`运算符，那么你也必须实现`false`运算符。

* * *

## 回答 #3

> 赞同：16
> 
> 时间：2009-05-27T04:57:34.640

您的问题的正确答案可在 C# 3.0 规范的第 7.19 节中找到，您可以在 Internet 上轻松找到。为方便起见，相关文字为：

> 7.19 布尔表达式
> 
> 布尔表达式是产生布尔类型结果的表达式。
> 
> if 语句 [...] 的控制条件表达式是布尔表达式。[...]
> 
> 布尔表达式必须是可以隐式转换为 bool 的类型或实现 operator true 的类型。如果两个要求都不满足，则会发生编译时错误。
> 
> 当布尔表达式的类型不能隐式转换为 bool 但确实实现了 operator true 时，在对该表达式求值之后，调用该类型提供的 operator true 实现以产生一个 bool 值。

除了 bool 本身之外，没有其他类型可以通过内置转换隐式转换为 bool，但是当然，用户定义的到 bool 的隐式转换可以由用户定义。

* * *

## 回答 #4

> 赞同：14
> 
> 时间：2009-05-27T02:02:12.113

这样的代码将（并且应该）无法编译。如果您特别想覆盖该行为，您可以创建一个[隐式转换](http://msdn.microsoft.com/en-us/library/z5z9kes2(VS.80).aspx)为布尔值。像这样的东西：

```
public class Foo {
    public static implicit operator bool(Foo me) {
        if (me == null) {
            return false;
        }

        return true; // maybe add more logic before saying True
    }
} 
```

我认为这是一种不好的做法，因为对于不熟悉您的项目的编码人员来说，并不清楚什么逻辑提供了布尔转换。更惯用的方法是明确地告诉读者你的代码在做什么，就像内置的 String 类一样，使用静态辅助函数：

```
if (String.IsNullOrEmpty(str){
    // ...
} 
```

代码只写一次，经常阅读；优化可读性。

* * *

## 回答 #5

> 赞同：13
> 
> 时间：2009-05-27T01:59:31.963

**简短的回答：**

在 C# 中：

*   true : 总是正确的
*   false : 总是假的

其他一切都不是布尔值。

* * *

## 回答 #6

> 赞同：3
> 
> 时间：2009-05-27T02:00:52.163

if 语句评估可以转换为 / 等于 / 返回布尔值或布尔值本身的东西......检查 null 像 obj != null 就是这样一个表达式，

'if (obj)' 只有在 obj 能够转换为 bool 的情况下才能工作，而不是在它为 null 的情况下。

* * *

## 回答 #7

> 赞同：2
> 
> 时间：2013-12-20T18:49:19.070

前面的答案是正确的。但是，我有一个在极少数情况下使用的扩展方法：

```
public static bool IsTruthy(this object obj)
{
    if (obj == null || obj is DBNull)
        return false;

    var str = obj as string;
    if (str != null)
        return !string.IsNullOrWhiteSpace(str) && 
            !str.Trim().Equals(bool.FalseString, StringComparison.OrdinalIgnoreCase);

    try
    {
        if (Convert.ToDecimal(obj) == 0)
            return false;
    }
    catch { }

    if (obj is BigInteger)
        return ((BigInteger)obj) != 0; 

    return true;
} 
```

关于这一点的一些注意事项：

*   此方法与javascript处理字符串“False”的方式不一致
*   该方法对空枚举返回true，与javascript一致

* * *

## 回答 #8

> 赞同：0
> 
> 时间：2017-12-02T05:57:41.320

您可以通过扩展方法定义自己的真假。

```
public static bool Falsy(this object obj) {
        if(obj == null) return true;
        if (obj is string)
            if(obj as string == string.Empty) return true;
        if(obj is byte)
            if((byte)obj == 0) return true;
        if(obj is sbyte)
            if((sbyte)obj == 0) return true;
        if(obj is short)
            if((short)obj == 0) return true;
        if(obj is ushort)
            if((ushort)obj == 0) return true;
        if(obj is int)            
            if((int)obj == 0) return true;
        if(obj is uint)
            if((uint)obj == 0) return true;
        if(obj is long)
            if((long)obj == 0) return true;
        if(obj is ulong)
            if((ulong)obj == 0) return true;
        if(obj is float)
            if((float)obj == 0) return true;
        if(obj is double)
            if((double)obj == 0) return true;
        if(obj is decimal)
            if((decimal)obj == 0) return true;
        if(obj is IEnumerable<object>)
            if((obj as IEnumerable<object>).Count<object>() == 0)
                return true;
        if(obj is Array)
            if(((Array)obj).Length <= 0)
                return true;
        if(obj is ObjectId)
            if(((ObjectId)obj).Pid == 0) return true;
        if(obj is System.Collections.ObjectModel.ObservableCollection<M>)
            if(((ObservableCollection<M>)obj).Count <= 0) return true;
                return false;
}

public static bool Truthy(this object obj) {
   return !Falsy(obj);
} 
```

因此，您可以执行以下操作：

if(customerList.Falsy()) { throw new Exception("不能为 null 或为空。"); }

* * *

## 回答 #9

> 赞同：-1
> 
> 时间：2009-05-27T01:58:07.253

如果`obj`是您创建的类型，您可以定义用户定义的隐式转换为`bool`.

* * *

## 回答 #10

> 赞同：-7
> 
> 时间：2009-05-27T02:00:59.230

C# 是一种静态类型语言，也就是说对象的类型在设置它是什么时很重要。

例如，“4”！= 4。

然而，JavaScript 是一种动态类型语言，因此类型并不重要。

所以在 JavaScript 中，“4” == 4。

“真”值是恰好满足 x == true 的值，而“假”值不满足。

如果没有类型安全，某些功能（例如重载）将产生不可预测的行为。

有关更多信息，您可以[在此处查看](http://www.exforsys.com/tutorials/csharp/.-net-type-safety.html)。

# subsonic - SubStage 在启动时立即崩溃

> ID：913617
> 
> 赞同：2
> 
> 时间：2009-05-27T01:59:52.743
> 
> 标签：subsonic, substage

我刚刚在 XP Sp3 VM .NET Framework 3.5 上安装了 subSonic 2.2，当我尝试启动 SubStage exe 时，它​​立即崩溃。有任何想法吗？

想我会补充一点，我在 Mac OSX 上的 VMWare 中运行 VM。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-05-29T04:59:19.850

我意识到崩溃的是 src 下载中的预编译 exe。一时兴起，我在本地构建项目并尝试运行本地构建的输出 - 太好了！奇迹般有效。

不知道为什么最初的构建不起作用，但在本地构建它让我启动并运行。小号

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-05-28T21:02:50.643

我在我的 Vista 机器上经历过这种情况，以管理员身份运行该应用程序允许它为我工作。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-09-22T18:26:24.883

这是一个 system.io 异常，所以我想知道是否存在路径问题。我将 ..\SubSonic 2.2\SubStage\MasterStore.xml 重命名为 MasterStore.xml.old，然后运行 ​​SubStage，它就成功了。它重新生成了 MasterStore.xml。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2009-11-29T20:43:50.427

我还将 ..\SubSonic 2.2\SubStage\MasterStore.xml 重命名为 MasterStore.xml.old，然后运行 ​​SubStage，它工作正常。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2010-04-07T15:40:27.850

重命名 MasterStore.xml 并以管理员身份运行为我解决了这个问题。

# iphone - iPhone应用程序电池日志如何工作？

> ID：913621
> 
> 赞同：1
> 
> 时间：2009-05-27T02:01:18.807
> 
> 标签：iphone

我做了一些研究，发现 /private/var/ 中有一个日志，我们可以在其中获取电池日志。但不幸的是，iphone 应用程序没有对该文件的读取权限。

所以我想知道“电池日志”是如何工作的？（Battery Log 是应用商店中的一款应用，可以显示电池使用历史记录）

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-05-27T02:20:28.003

在应用程序描述中，它说应用程序仅在启动时收集数据（考虑到苹果对应用程序的限制，并且 - 正如您提到的 - 电池日志文件是私有的，这是有道理的）。应用程序描述还指出，该应用程序仅在相对基础上工作，无法获得准确的电压。除此之外，它似乎是一些黑魔法。

# algorithm - 成对比较可以返回比 -1、0、+1 更多信息的排序算法

> ID：913624
> 
> 赞同：22
> 
> 时间：2009-05-27T02:02:12.380
> 
> 标签：algorithm, language-agnostic, sorting, comparison

大多数排序算法依赖于成对比较来确定是 A < B、A = B 还是 A > B。

我正在寻找利用成对比较函数的算法（以及奖励积分，Python 中的代码），该函数可以区分少得多与少一点或多与多一点。所以也许不是返回 {-1, 0, 1} 比较函数返回 {-2, -1, 0, 1, 2} 或 {-5, -4, -3, -2, -1, 0, 1 , 2, 3, 4, 5} 甚至是区间 (-1, 1) 上的实数。

对于某些应用程序（例如近似排序或近似排序），这可以通过较少的比较来确定合理的排序。

* * *

## 回答 #1

> 赞同：14
> 
> 时间：2013-05-27T20:30:03.053

额外的信息确实可以用来最小化比较的总数。对 super_comparison 函数的调用可用于进行等价于对常规比较函数的大量调用的扣除。例如，`a much-less-than b`并`c little-less-than b`暗示`a < c < b`。

扣除可以组织成箱或分区，每个都可以单独分类。实际上，这等效于具有 n 路分区的 QuickSort。这是 Python 中的一个实现：

```
from collections import defaultdict
from random import choice

def quicksort(seq, compare):
    'Stable in-place sort using a 3-or-more-way comparison function'
    # Make an n-way partition on a random pivot value
    segments = defaultdict(list)
    pivot = choice(seq)
    for x in seq:
        ranking = 0 if x is pivot else compare(x, pivot)
        segments[ranking].append(x)
    seq.clear()

    # Recursively sort each segment and store it in the sequence
    for ranking, segment in sorted(segments.items()):
        if ranking and len(segment) > 1:
            quicksort(segment, compare)
        seq += segment

if __name__ == '__main__':
    from random import randrange
    from math import log10

    def super_compare(a, b):
        'Compare with extra logarithmic near/far information'
        c = -1 if a < b else 1 if a > b else 0
        return c * (int(log10(max(abs(a - b), 1.0))) + 1)

    n = 10000
    data = [randrange(4*n) for i in range(n)]
    goal = sorted(data)
    quicksort(data, super_compare)
    print(data == goal) 
```

通过使用*跟踪*模块检测此代码，可以测量性能增益。在上面的代码中，常规的三路比较使用了 133,000 次比较，而超级比较函数将调用次数减少到了 85,000 次。

该代码还可以轻松地尝试各种比较功能。这将表明，朴素的 n 路比较函数对排序几乎没有帮助。例如，如果比较函数对于大于四的差异返回 +/-2，对于差异小于等于四的差异返回 +/-1，则比较次数仅会适度减少 5%。根本原因是一开始使用的课程粒度分区只有少数“近匹配”，而其他所有内容都属于“远匹配”。

对超级比较的一个改进是覆盖对数范围（即，如果在十以内，则为 +/-1，如果在一百以内，则为 +/-2，如果在一千以内，则为 +/-。

理想的比较函数将是自适应的。对于任何给定的序列大小，比较函数应努力将序列细分为大小大致相等的分区。信息论告诉我们，这将使每次比较的信息位数最大化。

自适应方法也具有很好的直观意义。人们应该首先被划分为*爱*与*喜欢*，然后再进行更精细的区分，例如爱多与爱少。进一步的划分通道应该每个都做出越来越精细的区分。

* * *

## 回答 #2

> 赞同：7
> 
> 时间：2009-05-27T02:18:17.743

您可以使用修改后的快速排序。当你比较函数返回 [-2, -1, 0, 1, 2] 时，让我解释一个例子。说，你有一个数组 A 来排序。

创建 5 个空数组 - Aminus2、Aminus1、A0、Aplus1、Aplus2。

选择 A、X 的任意元素。

对于数组的每个元素，将其与 X 进行比较。

根据结果​​，将元素放在 Aminus2、Aminus1、A0、Aplus1、Aplus2 数组之一中。

递归地对 Aminus2、Aminus1、Aplus1、Aplus2 应用相同的排序（注意：您不需要对 A0 进行排序，因为那里的所有元素都等于 X）。

连接数组以获得最终结果：A = Aminus2 + Aminus1 + A0 + Aplus1 + Aplus2。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2009-05-27T02:32:54.877

似乎使用 raindog 的修改后的快速排序可以让您更快地输出结果，并且可能更快地进入它们。

也许这些功能已经可以从精心控制的 qsort 操作中获得？我没有想太多。

这听起来也有点像基数排序，只是不是查看每个数字（或其他类型的桶规则），而是从丰富的比较中组成桶。我很难想到有丰富的比较可用但数字（或类似的东西）不可用的情况。

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2009-05-27T02:43:37.367

我想不出这会真正有用的任何情况。即使我可以，我怀疑对模糊值进行排序所需的额外 CPU 周期会比你提到的那些“额外比较”更多。但我仍然会提供一个建议。

考虑这种可能性（所有字符串都使用 27 个字符 az 和 _）：

```
 11111111112
   12345678901234567890
1/ now_is_the_time
2/ now_is_never
3/ now_we_have_to_go
4/ aaa
5/ ___ 
```

显然，字符串 1 和 2 比 1 和 3 更相似，并且*比*1 和 4 更相似。

一种方法是缩放每个相同字符位置的差值并使用第一个不同的字符来设置最后一个位置。

暂时把符号放在一边，比较字符串 1 和 2，位置 8 的差异为 'n' - 't'。那是 6 的差异。为了将其转换为单个数字 1-9，我们使用以下公式：

```
digit = ceiling(9 * abs(diff) / 27) 
```

因为最大差异是 26。最小差异 1 变成数字 1。最大差异 26 变成数字 9。我们的差异 6 变成 3。

并且因为差异在位置 8，所以 out 比较函数将返回 3x10 ^(-8)（实际上它会返回负数，因为字符串 1*在*字符串 2 之后。

对字符串 1 和 4 使用类似的过程，比较函数返回 -5x10 ^(-1)。可能的最高返回值（字符串 4 和 5）在 '-' - 'a' (26) 的位置 1 上存在差异，它生成数字 9，因此给我们 9x10 ^(-1)。

采纳这些建议并在您认为合适的时候使用它们。我很想知道你的模糊比较代码最终是如何工作的。

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2009-05-27T03:31:43.663

考虑到您希望根据人工比较订购许多物品，您可能希望像体育比赛一样处理这个问题。您可以允许每个人工投票将获胜者的得分增加 3，将较松的得分减少 3、+2 和 -2、+1 和 -1，或者仅 0 0 为平局。

然后，您只需根据分数进行常规排序。

另一种选择是单淘汰或双淘汰锦标赛结构。

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2009-05-27T15:45:11.330

您可以使用两个比较来实现这一点。将更重要的比较乘以 2，然后将它们加在一起。

这是我在 Perl 中的意思的示例。它按第一个元素比较两个数组引用，然后按第二个元素。

```
use strict;
use warnings;
use 5.010;

my @array = (
  [a => 2],
  [b => 1],
  [a => 1],
  [c => 0]
);

say "$_->[0] => $_->[1]" for sort {
  ($a->[0] cmp $b->[0]) * 2 +
  ($a->[1] <=> $b->[1]);
} @array; 
```

```
一个 => 1
一个 => 2
b => 1
c => 0

```

您可以很容易地将其扩展到任意数量的比较。

* * *

## 回答 #7

> 赞同：0
> 
> 时间：2009-05-27T16:21:05.907

也许有一个很好的理由这样做，但我认为它在任何给定情况下都不能胜过其他选择，*当然*也不适用于一般情况。原因？除非您对输入数据的域和值的分布有所了解，否则您无法真正改进，例如快速排序。如果你*确实*知道这些事情，通常会有更有效的方法。

反例：假设您的比较对于相差超过 1000 的数字返回“巨大差异”值，并且输入为 {0, 10000, 20000, 30000, ...}

反例：同上，但输入 {0, 10000, 10001, 10002, 20000, 20001, ...}

但是，你说，我知道我的输入看起来不像那样！好吧，在这种情况下，请详细告诉我们您的输入的真实情况。然后有人可能会*真正*提供帮助。

例如，有一次我需要对历史数据进行排序。数据保持排序。当添加新数据时，它被附加，然后再次运行列表。我没有新数据附加到哪里的信息。我为这种情况设计了一种混合排序，通过选择一种对已排序数据快速的排序并在遇到未排序的数据时将其调整为快速（基本上切换到 qsort），轻松击败了 qsort 和其他排序。

您要改进通用类型的唯一方法是了解您的数据。如果你想要答案，你必须在这里很好地沟通。

# java - 是否有绘制 B-TREE 的 API？

> ID：913625
> 
> 赞同：2
> 
> 时间：2009-05-27T02:03:07.820
> 
> 标签：java, user-interface, b-tree

这是一个简单的问题：在 Java 中是否有用于绘制[B-tree的 API？](http://en.wikipedia.org/wiki/B-tree)我只是不想花太多时间重新发明轮子。我对*每个 si*的算法没有问题，经过大量阅读（特别是 Lafore 的 Java 中的数据结构和算法）后，我的工作非常好，我只是不知道如何以一种好的方式打印 B-tree。

提前致谢。

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2009-05-27T02:20:52.683

您有几个选项可以将图形“渲染”到屏幕上 -

*   Graphviz 有一个 Java API（编辑：一个名为 LJV 的插件，它提供了 API）。

*   我认为您应该能够使用免费版本的 JGraph 来做同样的事情。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-05-27T02:21:48.547

我知道人们已经使用 daVinci（现在[的 uDraw](http://www.informatik.uni-bremen.de/uDrawGraph/en/index.html)）取得了成功。自 2003 年以来我就没有使用过它，但据我记得，你必须为你的树生成一个带括号的文本文件，然后程序会解析它。您应该能够通过简单的树遍历来输出您的文本。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-05-27T07:22:52.743

看看[yEd](http://www.yworks.com/en/products_yed_about.html)。我很确定，仅为 API 许可 yFiles 来显示树结构有点夸张，但是图形编辑器是免费的，您可以使用它来渲染树。我通常以一种受支持的文件格式转储我的原始图形数据，用 yEd 打开输出文件并让它进行布局。

# http - 包含多个文件的 Multipart HTTP 请求应该是什么样的？

> ID：913626
> 
> 赞同：109
> 
> 时间：2009-05-27T02:03:14.107
> 
> 标签：http, file, multipart

我正在开发一个使用多个图像文件发出多部分 HTTP 请求的 iPhone 应用程序。

在服务器端，看起来正在发生的事情是其中一个图像正在正确解析，但其他两个文件没有。

任何人都可以发布包含多个图像文件的示例 HTTP 多部分请求吗？

* * *

## 回答 #1

> 赞同：178
> 
> 时间：2009-05-27T02:59:33.527

好吧，请注意该请求包含二进制数据，因此我不会这样发布请求 - 相反，我已将每个不可打印的 ascii 字符转换为一个点（“.”）。

```
POST /cgi-bin/qtest HTTP/1.1
Host: aram
User-Agent: Mozilla/5.0 Gecko/2009042316 Firefox/3.0.10
Accept: text/html,application/xhtml+xml,application/xml;q=0.9,*/*;q=0.8
Accept-Language: en-us,en;q=0.5
Accept-Encoding: gzip,deflate
Accept-Charset: ISO-8859-1,utf-8;q=0.7,*;q=0.7
Keep-Alive: 300
Connection: keep-alive
Referer: http://aram/~martind/banner.htm
Content-Type: multipart/form-data; boundary=2a8ae6ad-f4ad-4d9a-a92c-6d217011fe0f
Content-Length: 514

--2a8ae6ad-f4ad-4d9a-a92c-6d217011fe0f
Content-Disposition: form-data; name="datafile1"; filename="r.gif"
Content-Type: image/gif

GIF87a.............,...........D..;
--2a8ae6ad-f4ad-4d9a-a92c-6d217011fe0f
Content-Disposition: form-data; name="datafile2"; filename="g.gif"
Content-Type: image/gif

GIF87a.............,...........D..;
--2a8ae6ad-f4ad-4d9a-a92c-6d217011fe0f
Content-Disposition: form-data; name="datafile3"; filename="b.gif"
Content-Type: image/gif

GIF87a.............,...........D..;
--2a8ae6ad-f4ad-4d9a-a92c-6d217011fe0f-- 
```

请注意，每一行（包括最后一行）都由 \r\n 序列终止。

* * *

## 回答 #2

> 赞同：62
> 
> 时间：2014-05-07T12:43:21.960

**编辑**：我在以下位置保持类似但更深入的答案：[https ://stackoverflow.com/a/28380690/895245](https://stackoverflow.com/a/28380690/895245)

要准确查看正在发生的事情，请使用`nc -l`浏览器或 cURL 等用户代理。

将表单保存到`.html`文件：

```
<form action="http://localhost:8000" method="post" enctype="multipart/form-data">
  <p><input type="text" name="text" value="text default">
  <p><input type="file" name="file1">
  <p><input type="file" name="file2">
  <p><button type="submit">Submit</button>
</form> 
```

创建要上传的文件：

```
echo 'Content of a.txt.' > a.txt
echo '<!DOCTYPE html><title>Content of a.html.</title>' > a.html 
```

跑：

```
nc -l localhost 8000 
```

在浏览器上打开 HTML，选择文件并单击提交并检查终端。

`nc`打印收到的请求。火狐发送：

```
POST / HTTP/1.1
Host: localhost:8000
User-Agent: Mozilla/5.0 (X11; Ubuntu; Linux i686; rv:29.0) Gecko/20100101 Firefox/29.0
Accept: text/html,application/xhtml+xml,application/xml;q=0.9,*/*;q=0.8
Accept-Language: en-US,en;q=0.5
Accept-Encoding: gzip, deflate
Cookie: __atuvc=34%7C7; permanent=0; _gitlab_session=226ad8a0be43681acf38c2fab9497240; __profilin=p%3Dt; request_method=GET
Connection: keep-alive
Content-Type: multipart/form-data; boundary=---------------------------9051914041544843365972754266
Content-Length: 554

-----------------------------9051914041544843365972754266
Content-Disposition: form-data; name="text"

text default
-----------------------------9051914041544843365972754266
Content-Disposition: form-data; name="file1"; filename="a.txt"
Content-Type: text/plain

Content of a.txt.

-----------------------------9051914041544843365972754266
Content-Disposition: form-data; name="file2"; filename="a.html"
Content-Type: text/html

<!DOCTYPE html><title>Content of a.html.</title>

-----------------------------9051914041544843365972754266-- 
```

或者，cURL 应该发送与浏览器表单相同的 POST 请求：

```
nc -l localhost 8000
curl -F "text=default" -F "file1=@a.html" -F "file1=@a.txt" localhost:8000 
```

您可以使用以下方法进行多项测试：

```
while true; do printf '' | nc -l localhost 8000; done 
```

# iphone - UIViewController -viewDidLoad 没有被调用

> ID：913627
> 
> 赞同：33
> 
> 时间：2009-05-27T02:03:22.610
> 
> 标签：iphone, cocoa-touch, uiview, uiviewcontroller

作为 Cocoa 的新手，我在`Interface Builder`,`UIViewController`和朋友方面遇到了一些问题。

我有一个在 xib 中定义的`UIViewController`子类`UIView`，并且控制器的视图出口连接到视图。xib 的“文件所有者”设置为*myViewcontroller*子类。

在这个实例中，以下用于加载控制器/视图（从主视图控制器）的代码无法按预期工作：

```
if ( self.myViewController == nil )
{
    self.myViewController = [[MyViewController alloc]
        initWithNibName:@"MyViewController" bundle:nil];
}

[self.navigationController 
    pushViewController:self.myViewController animated:YES]; 
```

在 MyViewController 的方法中，我放置了断点并记录消息以查看发生了什么：

```
-(id)initWithNibName:(NSString *)nibNameOrNil bundle:(NSBundle *)nibBundleOrNil {

    if (self = [super initWithNibName:nibNameOrNil bundle:nibBundleOrNil]) {
        NSLog(@"initWithNibName\n");
    }

    return self;
}

-(void)viewDidLoad {

    [super viewDidLoad];
    NSLog(@"viewDidLoad\n");
} 
```

**预期结果**

`-initWithNibName`和方法都`-viewDidLoad`被调用，并显示了myViewController的视图。

**观察结果**

只有`-initWithNibName`被调用，视图不显示。

我错过了什么吗？任何人都可以推荐任何要检查的东西吗？（特别是在非常不透明的界面生成器工具中）。

* * *

## 回答 #1

> 赞同：36
> 
> 时间：2010-08-29T23:22:53.033

回复：找到解决方案！！！！！！

确实这似乎是一个可行的解决方案，但真正的技巧不是将`view.hidden`属性设置为 NO，使视图从 nib 文件加载的原因是调用`UIViewController's`视图方法，视图仅在第一次调用 view 方法。

从这个意义上说，一条简单的`[viewController view]`消息将强制视图从 nib 文件加载。

* * *

## 回答 #2

> 赞同：15
> 
> 时间：2009-05-27T05:40:45.983

好的，我有一个部分答案-也许大师可以解释更多。问题是：

```
[self.navigationController pushViewController:myViewController animated:YES]; 
```

仔细观察，在这种情况下`self.navigationController`是 nil - 所以推送消息无处可去。

相反，如果我发送：

```
[self.view addSubview:self.myViewController.view]; 
```

然后视图出现并被`-viewDidLoad`调用。

我不完全确定为什么`self.navigationController`没有在这种情况下设置 - 我唯一能想到的是它`self`是`UIViewController`而不是`UITableViewController`（`pushViewController`代码来自哪里）的子类。

此外，静默允许消息为零似乎是一个坏主意，尽管[这些答案](https://stackoverflow.com/questions/156395/sending-a-message-to-nil) 另有说明。另请参阅我的[问题](https://stackoverflow.com/questions/914166/is-there-a-way-to-trap-messages-sent-to-nil-in-objective-c)。

最终编辑：

在下面的评论中的答案，我已经意识到我实际上追求的显示功能（假设 myViewController 是模态的）是：

```
[self presentModalViewController:myViewController animated:YES]; 
```

感谢大家的有益回复。

* * *

## 回答 #3

> 赞同：10
> 
> 时间：2010-01-15T03:55:51.897

找到解决方案！！！！

甚至像这样无害的事情也会使`viewDidLoad`方法调用发生。

在 alloc 之后插入这个`initWithNibName`

```
viewController.view.hidden = NO; //calls viewDidLoad 
```

* * *

## 回答 #4

> 赞同：5
> 
> 时间：2009-05-27T02:15:05.583

确保 File's Owner（您的 viewController 子类）中的视图出口连接到实际视图（即您在屏幕上看到的用于构建 UI 的 480X320 画布）

* * *

## 回答 #5

> 赞同：5
> 
> 时间：2016-05-11T06:08:13.740

很有可能您可能没有将假定`ViewController`的输入`main.storyboard`从您创建`Identity Inspector`的自定义链接到`class`您创建的自定义。您可能可以通过 segue 从其他视图控制器导航到该控制器，但不会执行任何等`viewDidLoad()`。`viewWillAppear()`

* * *

## 回答 #6

> 赞同：4
> 
> 时间：2012-03-04T10:48:16.040

只需使用

```
- (void)viewDidAppear:(BOOL)animated{ 
        [super viewDidAppear:animated];
        //Your Code here
  } 
```

而不是 viewDidLoad 方法。

* * *

## 回答 #7

> 赞同：4
> 
> 时间：2015-10-18T08:56:46.747

回想起来有些明显的另一个原因：如果`viewController.view`在代码中设置了，则不会触发 viewDidLoad 事件。

* * *

## 回答 #8

> 赞同：3
> 
> 时间：2009-05-27T02:22:21.823

对我来说，这似乎是一个大写问题。您在调用 pushViewController 时 引用的是类`MyViewController`而不是属性。`myViewController`

* * *

## 回答 #9

> 赞同：2
> 
> 时间：2009-05-27T02:47:29.713

检查您的运行日志是否有错误。几乎可以肯定的是，NIB 没有加载，因此应该有错误。最可能的原因是未能将其放入捆绑包中。查看您的“复制资源”构建阶段并确保实际复制了 XIB。为模拟器构建，然后进入构建目录并确保 NIB 在 .app 包中。

* * *

## 回答 #10

> 赞同：0
> 
> 时间：2020-01-31T11:21:12.093

除了这里的其他答案，

当您从情节提要中实例化 ViewController 的标识符不正确时，通常会发生这种情况。例如

`[[self getStoryboard] instantiateViewControllerWithIdentifier:MyVC];`

如果`MyVC`是某个其他 ViewController 的标识符，则可能会发生这种情况。

OP`nib`在这里使用而不是故事板。但答案适用。

* * *

## 回答 #11

> 赞同：0
> 
> 时间：2021-01-30T06:16:00.913

**该页面已呈现但在调试视图层次结构和设备（模拟器也）中不可见，问题发生基于并且我找到了修复：**

```
func viewWillLayoutSubviews{
     if day == true{
            self.view.backgroundColor = .clear
     }else{
            self.view.backgroundColor = .blue
     }
} 
```

**不要尝试在 layoutsubviews 的功能中实现 self.view（viewcontrollers 视图）。**所以最好在 viewwillappear 或 viewdidload 中使用 self.view。此问题从 v-14 设备开始。

希望它也适合你。

# vb.net - 在 VB.NET 中读取文件错误？

> ID：913630
> 
> 赞同：0
> 
> 时间：2009-05-27T02:07:33.617
> 
> 标签：vb.net

该文件的工作方式是有一个空缓冲区，然后是一个用户校验和，然后是一个字节，它为您提供用户名字母计数，然后一个字节表示要跳到下一个用户的字节数，以及一个用户文件的字节用户保留他们的设置。

IF 语句中带有 usersm 变量的循环设置整个文件流以进行提取。然而，使用几乎完全相同的代码，else 子句特别是 else 代码中的 str.Read(xnl, 0, usn - 1) 似乎正在读取文件的最开头，尽管文件流的位置被设置得较早，任何人都知道这里发生了什么事？

这是vb2005

```
Private Sub readusersdata(ByVal userdatafile As String)
    ListView1.BeginUpdate()
    ListView1.Items.Clear()
    Using snxl As IO.Stream = IO.File.Open(userdatafile, IO.FileMode.Open)

        Using str As New IO.StreamReader(snxl)
            str.BaseStream.Position = 4
            Dim usersm As Integer = str.BaseStream.ReadByte()
            Dim users As Integer = usersm
            While users > 0
                If usersm = users Then
                    Dim trailtouser As Integer = 0
                    str.BaseStream.Position = 6
                    Dim ust As Integer = str.BaseStream.ReadByte()
                    str.BaseStream.Position = 8
                    Dim snb(ust - 1) As Char
                    str.ReadBlock(snb, 0, ust)
                    Dim bst = New String(snb)
                    If usersm = 1 Then
                        str.BaseStream.Position = 16
                    Else
                        str.BaseStream.Position = 15
                    End If
                    cLVN(ListView1, bst, str.BaseStream.ReadByte)
                    str.BaseStream.Position = 8 + snb.Length
                    str.BaseStream.Position += str.BaseStream.ReadByte + 1
                Else

                    Dim usn As Integer = str.BaseStream.ReadByte
                    str.BaseStream.Position += 2
                    Dim chrpos As Integer = str.BaseStream.Position
                    Dim xnl(usn - 1) As Char
                    str.Read(xnl, 0, usn - 1)
                    Dim skpbyte As Integer = str.BaseStream.ReadByte
                    str.BaseStream.Position += 3
                    Dim udata As Integer = str.BaseStream.ReadByte

                End If

                users -= 1

            End While
        End Using
    End Using
    ListView1.EndUpdate()
End Sub 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-05-27T05:24:54.703

当您更改底层流的位置时，`StreamReader`不知道您已经这样做了。如果它之前读取了“太多”数据（故意地，为了提高效率 - 它试图避免对底层流进行大量小读取），那么它将使用缓冲数据，而不是直接与重新定位的数据对话溪流。您需要[`StreamReader.DiscardBufferedData`](http://msdn.microsoft.com/en-us/library/system.io.streamreader.discardbuffereddata.aspx)在重新定位流后调用以避免这种情况。

# python - apache prefork/mod_wsgi 产生的进程计数看似过去的配置

> ID：913632
> 
> 赞同：4
> 
> 时间：2009-05-27T02:09:00.850
> 
> 标签：python, apache, mod-wsgi

在运行 nginx 的生产环境中，返回到 apache mpm-prefork/mod_wsgi，我看到**90 个**apache 子进程，而我预计最多 40 个，如下配置。配置/设置并不令人兴奋：

1.  nginx 通过反向代理到 apache `proxy_pass`，并提供静态媒体
2.  apache 只提供动态请求

相关的nginx配置：

```
worker_processes 15;

events {
    worker_connections  1024;
}

keepalive_timeout 10; 
```

相关的apache配置：

```
KeepAlive Off
MaxKeepAliveRequests 100 
KeepAliveTimeout 15

<IfModule mpm_prefork_module>
    StartServers        20
    MinSpareServers     7      
    MaxSpareServers     10
    MaxClients          200
    MaxRequestsPerChild 0
</IfModule> 
```

mod_wsgi 配置，`webapp`进程名称在哪里：

```
WSGIDaemonProcess webapp user=www group=users threads=1 processes=40 
```

我错过了什么吗？

* * *

## 回答 #1

> 赞同：10
> 
> 时间：2009-06-24T11:14:09.333

mod_wsgi 守护进程看起来像是 Apache 服务器子进程，即使它们并不相同。这是因为 mod_wsgi 守护进程是 Apache 父进程的 fork，而不是 fork/exec。换句话说，它们的可执行文件名称不会改变。

为了能够将 mod_wsgi 守护进程与普通的 Apache 服务器子进程区分开来，请为 WSGIDaemonProcess 提供“显示名称”选项。此选项允许您将进程重命名为在“ps”程序和某些程序变体（如“top”）的输出中可见。请参阅 mod_wsgi 站点上的 WSGIDaemonProcess 指令文档。

[http://code.google.com/p/modwsgi/wiki/ConfigurationDirectives#WSGIDaemonProcess](http://code.google.com/p/modwsgi/wiki/ConfigurationDirectives#WSGIDaemonProcess)

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-05-27T04:40:32.867

可能有比 WSGI 实例更多的 apache 进程。

如果要限制 apache 进程，请将 apache 的 MaxClients 更改为 40。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-05-27T10:16:46.080

您`mod_wsgi`在守护程序模式下使用，因此`mod_wsgi`进程和 Apache 处理程序进程是独立的。

通过您在 apache 启动后的配置，您拥有：

*   40(processes=) 个`mod_wsgi`进程同时启动。
*   20(StartServers) Apache 处理程序进程，如果没有传入活动，可以自动减少到 10(MaxSpareServers)。

然后在加载时，Apache 处理程序进程可以增长到 200（MaxClients）。但是`mod_wsgi`进程数将是相同的 - 40。

我的建议是使用 worker mpm 而不是 Apache 只处理动态内容。它可以帮助减少内存消耗和更好的可扩展性。

# cocoa - 如何显示未归档的自定义 NSView 对象

> ID：913633
> 
> 赞同：1
> 
> 时间：2009-05-27T02:09:17.433
> 
> 标签：cocoa, nsview

我正在学习 Cocoa 编程，但我无法弄清楚如何归档和取消归档自定义 NSView 子类

我制作了一个显示窗口的玩具应用程序。此窗口包含我的自定义 BackgroundView 类的实例（存档在 xib 文件中）。单击此 BackgroundView 中的任意位置会创建并显示一个蓝色方块，其原点是单击点。这个正方形是我的 Square 类的一个实例。所有这些都按我的预期工作。

Square 类实现了 NSCoding 协议。我在 MyDocument 类中添加了 dataOfType: typeName: error: 和 readfromData: ofType: error: 方法。据我从日志语句中可以看出，Square 正在归档到文件中，并在文件加载时取消归档。但我无法让方块显示在窗口上。Square 类的 drawWithRect: 方法永远不会被调用，即使我在每个方格上都调用了 setNeedsDisplay:YES。

代码如下：

```
Square.h
#import <Cocoa/Cocoa.h>
@interface Square : NSView <NSCoding> {
}
@end

Square.m
#import "Square.h"
@implementation Square

- (id)initWithFrame:(NSRect)frame {
   self = [super initWithFrame:frame];
   return self;
}

- (void)drawRect:(NSRect)rect {
       [[NSColor blueColor] set];
       NSBezierPath *newPath = [NSBezierPath bezierPathWithRect:[self bounds]];
       [newPath fill];
}

-(void)encodeWithCoder:(NSCoder *)coder
{
       [coder encodeRect:[self frame] forKey:@"frame"];
}

-(id)initWithCoder:(NSCoder *)coder
{
       NSRect theRect = [coder decodeRectForKey:@"frame"];
       self = [super initWithFrame:theRect];
       return self;
}
@end
-----
BackgroundView.h
#import <Cocoa/Cocoa.h>
@interface BackgroundView : NSView {
}
@end

BackgroundView.m
#import "BackgroundView.h"
#import "Square.h"
@implementation BackgroundView

- (id)initWithFrame:(NSRect)frame {
   self = [super initWithFrame:frame];
   if (self) {
       // Initialization code here.
   }
   return self;
}

- (void)drawRect:(NSRect)rect {
       for (Square *subview in self.subviews)
               [subview setNeedsDisplay:YES];
}

-(void)mouseDown:(NSEvent *)theEvent {
       NSPoint unsetClick = [theEvent locationInWindow];
       NSPoint theClick = [self convertPoint:unsetClick fromView:nil];
       NSRect theRect;
       theRect.origin = theClick;
       theRect.size.width = 100.00;
       theRect.size.height = 100.00;
       Square *newSquare = [[Square alloc] initWithFrame:theRect];
       [self addSubview:newSquare];
       [newSquare setNeedsDisplay:YES];
}
@end
------
MyDocument.h
#import <Cocoa/Cocoa.h>
@class BackgroundView;

@interface MyDocument : NSDocument
{
       IBOutlet BackgroundView *theBackgroundView;
}
@end

MyDocument.m
#import "MyDocument.h"

@implementation MyDocument

- (id)init
{
   self = [super init];
   return self;
}

- (NSString *)windowNibName
{
   return @"MyDocument";
}

- (void)windowControllerDidLoadNib:(NSWindowController *) aController
{
   [super windowControllerDidLoadNib:aController];
}

- (NSData *)dataOfType:(NSString *)typeName error:(NSError **)outError
{
   return [NSKeyedArchiver
archivedDataWithRootObject:[theBackgroundView subviews]];
   if ( outError != NULL ) {
               *outError = [NSError errorWithDomain:NSOSStatusErrorDomain
code:unimpErr userInfo:NULL];
       }
       return nil;
}

- (BOOL)readFromData:(NSData *)data ofType:(NSString *)typeName
error:(NSError **)outError
{
   [theBackgroundView setSubviews:[NSKeyedUnarchiver
unarchiveObjectWithData:data]];
   [theBackgroundView setNeedsDisplay:YES];
   if ( outError != NULL ) {
               *outError = [NSError errorWithDomain:NSOSStatusErrorDomain
code:unimpErr userInfo:NULL];
       }
   return YES;
}

@end 
```

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2011-04-13T03:05:41.763

由于 Square 是 NSView 的子类，而 NSView 也实现了 NSCoding，所以需要调用 super 对 encodeWithCoder: 和 initWithCoder: 的实现。

```
@implementation Square
- (id)initWithFrame:(NSRect)frame
{
    return [super initWithFrame:frame];
}

-(id)initWithCoder:(NSCoder *)coder
{
    if ((self = [super initWithCoder:coder]))
    {
        NSRect theRect = [coder decodeRectForKey:@"frame"];
        self = [super initWithFrame:theRect];
        return self;
    }
}

- (void)encodeWithCoder:(NSCoder *)coder
{
    [super encodeWithCoder:coder];
    [coder encodeRect:[self frame] forKey:@"frame"];
}

- (void)drawRect:(NSRect)rect
{
    [[NSColor blueColor] set];
    [[NSBezierPath bezierPathWithRect:[self bounds]] fill];
}
@end 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-05-27T05:56:08.173

正如我所见，您没有添加任何 initWithXXX 和 encodeWithXXX 方法，因为您没有自定义成员变量。

我建议查看 Apple 的[Sketch Example](http://developer.apple.com/samplecode/Sketch-112/)。

# javascript - 使用 jQuery 循环插件作为图像旋转器和寻呼机的问题

> ID：913639
> 
> 赞同：3
> 
> 时间：2009-05-27T02:14:30.840
> 
> 标签：javascript, jquery, jquery-plugins, cycle, image-rotation

我正在尝试使用 jQuery 为 tumbs 和大图像制作寻呼机，但我没有成功。

我正在使用jQuery 网站上的[这个例子](http://malsup.com/jquery/cycle/pager2.html)，我想我遵循了这个方向，但它似乎并不奏效。

我确实只看到了第一张图像，而不是全部，但没有寻呼机。我错过了什么吗？

所以这是我的HTML：

```
<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head runat="server">
    <title></title>

    <script src="jquery-1.3.2.js" type="text/javascript"></script>

    <script src="jquery.cycle.all.js" type="text/javascript"></script>

    <script type="text/javascript">
        $(document).ready(function() {
            $('#slideshow').before('<ul id="nav">').cycle({
                fx: 'turnDown',
                speed: 'fast',
                timeout: 0,
                pager: '#nav',

                // callback fn that creates a thumbnail to use as pager anchor 
                pagerAnchorBuilder: function(idx, slide)
                {
                    return '<li><a href="#"><img src="' + slide.src + '" width="50" height="50" /></a></li>';
                }
            });
        });
    </script>

    <style type="text/css">
#slideshow { left: 20px }
#nav { width: 300px; margin: 15px }
#nav li { width: 50px; float: left; margin: 8px; list-style: none }
#nav a { width: 50px; padding: 3px; display: block; border: 1px solid #ccc; }
#nav a.activeSlide { background: #88f }
#nav a:focus { outline: none; }
#nav img { border: none; display: block }
    </style>
</head>
<body>
    <form id="form1" runat="server">
    <div id="slideshow" >
        <img src="http://www.freefoto.com/images/12/13/12_13_4---Flowers-in-a-Garden-Border_web.jpg" />
        <img src="http://www.cssnz.org/flower.jpg" />
        <img src="http://www.global-b2b-network.com/direct/dbimage/50322257/Sun_Flowers.jpg" />
    </div>
    </form>
</body>
</html> 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-05-27T02:23:41.850

您需要添加一个容器

前任

```
<body>
   <form id="form1" runat="server">
      <ul id="nav"></ul>  <!-- You need this -->
      <div id="slideshow">
         <img src="http://www.freefoto.com/images/12/13/12_13_4---Flowers-in-a-Garden-Border_web.jpg" />
         <img src="http://www.cssnz.org/flower.jpg" />
         <img src="http://www.global-b2b-network.com/direct/dbimage/50322257/Sun_Flowers.jpg" />
      </div>
   </form>
</body> 
```

更新：

对于幻灯片下方页面底部的水平

你需要添加这个 CSS

```
#nav li{
  float: left;
} 
```

和 HTML 更改为

```
 <form id="form1" runat="server">
      <div id="slideshow">
         <img src="http://www.freefoto.com/images/12/13/12_13_4---Flowers-in-a-Garden-Border_web.jpg" />
         <img src="http://www.cssnz.org/flower.jpg" />
         <img src="http://www.global-b2b-network.com/direct/dbimage/50322257/Sun_Flowers.jpg" />
      </div>
      <ul id="nav"></ul>  <!-- You need this -->
   </form> 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-05-27T02:21:58.487

您是否应该在文件准备好后开始循环？我对循环仪不熟悉，但试试这个：

```
<script type="text/javascript">
    $(function() {
        $('#slideshow').before('<ul id="nav">').cycle({
            fx: 'turnDown',
            speed: 'fast',
            timeout: 0,
            pager: '#nav',

            // callback fn that creates a thumbnail to use as pager anchor 
            pagerAnchorBuilder: function(idx, slide)
            {
                return '<li><a href="#"><img src="' + slide.src + '" width="50" height="50" /></a></li>';
            }
        });
     });    
</script> 
```

也许您正试图在一个尚不存在的元素上运行循环器，因为文档尚未准备好。另外，我认为创建元素的语法要求它们是自闭合的，即，你应该有`.before('<ul id="nav" />').cycle()`......，但我对 jQuery 的来龙去脉还不是很熟悉。

# qt - qmake 和 QT_INSTALL_PREFIX。如何为 Qt 库选择新位置？

> ID：913642
> 
> 赞同：19
> 
> 时间：2009-05-27T02:15:38.263
> 
> 标签：qt, build, qmake

我是 qmake 的新手，我正在尝试构建一个现有的应用程序。Qt 最初安装在 /usr/local/lib/Qt-4.3.5 中，'qmake -query QT_INSTALL_PREFIX' 返回该路径。

我已将 Qt 库移动到另一个位置，并且生成的 Makefile 中充满了 /usr/local 原始路径。

如何在不重新编译 Qt 的情况下强制 qmake 使用我选择的新位置？

* * *

## 回答 #1

> 赞同：39
> 
> 时间：2011-11-01T15:20:57.180

我正在研究这个并通过使用`qt.conf`文件自定义 qt 找到了一种可行的方法（在 qt 4.7.2 中）。

就我而言，我添加了一个`qt4-4.7.2/bin/qt.conf`（它必须与`qmake`可执行文件位于同一位置）

具有以下内容：

```
[Paths]
Prefix = c:/my_path/to/qt4-4.7.2 
```

并且 qmake -query 开始返回正确的路径！

有关详细信息，请参阅：[http ://doc.qt.io/qt-4.8/qt-conf.html](http://doc.qt.io/qt-4.8/qt-conf.html)

* * *

[更新：]因为至少 Qt 5.3.1（在 Windows 8 上使用静态版本的 5.3.1 和 5.5 测试）你可以简单地做

```
[Paths]
Prefix = .. 
```

并在任何地方部署 Qt 安装。

* * *

## 回答 #2

> 赞同：9
> 
> 时间：2009-05-27T06:16:57.577

这是从 qconfig.cpp 编译到 qmake 中的“内置”。最好的方法是用另一个 -prefix 重新配置 Qt 并不幸地重建。对于大多数其他变量，您可以使用 .qmake.cache 文件。看

[http://doc.qt.digia.com/qt/qmake-environment-reference.html](http://doc.qt.digia.com/qt/qmake-environment-reference.html)

了解更多信息

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2011-02-17T14:41:32.000

正如 Henrik Hartz 所指出的，QT_INSTALL_PREFIX 是内置的，无法更改。但是，如果您只是想临时解决不得不重新构建 Qt 的问题，那么您可以尝试以下方法：

查询 qmake 的安装前缀，重新创建报告的目录结构，并使用符号链接或硬链接到重新定位的 Qt 版本所在的位置。例如在 Linux 上

*   获取报告的路径`/new/Qt/location/bin/qmake -query QT_INSTALL_PREFIX`。说这个报道`/Parent/Dirs/Prefix`。
*   创建路径的任何父目录，例如`mkdir -p /Parent/Dirs/`
*   符号链接到新位置，例如`ln -s /new/Qt/location /Parent/Dirs/Prefix`

如果您有一群开发人员需要使用相同的 Qt 预构建版本，则上述内容也很有用，其中该 Qt 版本不一定复制到所有开发人员计算机上的相同路径，并且您只需要为最终用户将 Qt 共享库与您的应用程序捆绑在一起（即您不会发送标头或构建工具）。

# wpf - ListCollectionView 移动到新创建的记录

> ID：913644
> 
> 赞同：0
> 
> 时间：2009-05-27T02:15:48.437
> 
> 标签：wpf, listcollectionview

使用 ListCollectionView 时，如何将焦点移至新创建的记录？我的声明是

```
Public WithEvents Data As PersonList = PersonList.GetList()
Private MyView As New ListCollectionView(Data)
Private WithEvents _Person As Person 
```

我用来插入一个人的代码是

```
 _Person = New Person("AAAA", 100)
    Data.Insert(0, _Person) 
```

我试过使用 MyView.MoveCurrentTo(Dunno what to put here)，但似乎没有任何效果。

如果我正在使用底层的 ObservableCollection，那么我会转到索引 0，但我不能依赖它，因为 ListCollectionView 可以进行排序和过滤，因此记录不再与 ObservableCollection 的顺序相同。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2009-05-27T08:30:37.557

你试过吗？

```
MyView.MoveCurrentTo(MyView.CurrentAddItem) 
```

您还可以使用 MyView.AddNew 添加新项目，我怀疑它会使其成为当前项目。

另外，不要忘记在 ItemsControl 上将 IsSynchronizedWithCurrentItem 设置为 True

# c# - C# 真实地移动鼠标

> ID：913646
> 
> 赞同：12
> 
> 时间：2009-05-27T02:16:23.207
> 
> 标签：c#, mouse

我正在演示一个软件，并想构建一个鼠标“移动器”功能，这样我就可以基本上自动化这个过程。我想创建逼真的鼠标移动，但在思考过程中有一点心理障碍。我可以使用 c# 轻松移动鼠标，但希望它比光标出现在某个 x、y 坐标处然后按下按钮更真实一点。

我得到鼠标的当前位置，然后得到终点。计算两点之间的弧线，然后我需要计算沿该弧线的点，以便我可以在其中添加一个计时器事件，以便我可以从一个点移动到下一个点，然后重复这个直到我到达目标...

有人要详细说明吗？

谢谢，R。

* * *

## 回答 #1

> 赞同：23
> 
> 时间：2009-05-27T02:35:58.363

我尝试了圆弧计算方法，结果很复杂，最后看起来不太现实。正如 JP 在他的评论中所建议的那样，直线看起来更人性化。

这是我编写的用于计算线性鼠标移动的函数。应该是不言自明的。GetCursorPosition() 和 SetCursorPosition(Point) 是 win32 函数 GetCursorPos 和 SetCursorPos 的包装。

就数学而言 - 从技术上讲，这称为线段的[线性插值。](http://en.wikipedia.org/wiki/Linear_interpolation)

```
public void LinearSmoothMove(Point newPosition, int steps) {
    Point start = GetCursorPosition();
    PointF iterPoint = start;

    // Find the slope of the line segment defined by start and newPosition
    PointF slope = new PointF(newPosition.X - start.X, newPosition.Y - start.Y);

    // Divide by the number of steps
    slope.X = slope.X / steps;
    slope.Y = slope.Y / steps;

    // Move the mouse to each iterative point.
    for (int i = 0; i < steps; i++)
    {
        iterPoint = new PointF(iterPoint.X + slope.X, iterPoint.Y + slope.Y);
        SetCursorPosition(Point.Round(iterPoint));
        Thread.Sleep(MouseEventDelayMS);
    }

    // Move the mouse to the final destination.
    SetCursorPosition(newPosition);
} 
```

* * *

## 回答 #2

> 赞同：12
> 
> 时间：2012-12-08T13:55:17.327

我将`WindMouse`前面提到的函数转换为 C#，它实际上是非常现实的。请注意，这只是一个粗略的示例，并没有使用 和 的包装`GetCursorPos`器`SetCursorPos`。我将使用[Windows 输入模拟器](http://inputsimulator.codeplex.com/)包装器。

```
static class SampleMouseMove {

    static Random random = new Random();
    static int mouseSpeed = 15;

    static void Main(string[] args) {
        MoveMouse(0, 0, 0, 0);
    }

    static void MoveMouse(int x, int y, int rx, int ry) {
        Point c = new Point();
        GetCursorPos(out c);

        x += random.Next(rx);
        y += random.Next(ry);

        double randomSpeed = Math.Max((random.Next(mouseSpeed) / 2.0 + mouseSpeed) / 10.0, 0.1);

        WindMouse(c.X, c.Y, x, y, 9.0, 3.0, 10.0 / randomSpeed,
            15.0 / randomSpeed, 10.0 * randomSpeed, 10.0 * randomSpeed); 
    }

    static void WindMouse(double xs, double ys, double xe, double ye,
        double gravity, double wind, double minWait, double maxWait,
        double maxStep, double targetArea) {

        double dist, windX = 0, windY = 0, veloX = 0, veloY = 0, randomDist, veloMag, step;
        int oldX, oldY, newX = (int)Math.Round(xs), newY = (int)Math.Round(ys);

        double waitDiff = maxWait - minWait;
        double sqrt2 = Math.Sqrt(2.0);
        double sqrt3 = Math.Sqrt(3.0);
        double sqrt5 = Math.Sqrt(5.0);

        dist = Hypot(xe - xs, ye - ys);

        while (dist > 1.0) {

            wind = Math.Min(wind, dist);

            if (dist >= targetArea) {
                int w = random.Next((int)Math.Round(wind) * 2 + 1);
                windX = windX / sqrt3 + (w - wind) / sqrt5;
                windY = windY / sqrt3 + (w - wind) / sqrt5;
            }
            else {
                windX = windX / sqrt2;
                windY = windY / sqrt2;
                if (maxStep < 3)
                    maxStep = random.Next(3) + 3.0;
                else
                    maxStep = maxStep / sqrt5;
            }

            veloX += windX;
            veloY += windY;
            veloX = veloX + gravity * (xe - xs) / dist;
            veloY = veloY + gravity * (ye - ys) / dist;

            if (Hypot(veloX, veloY) > maxStep) {
                randomDist = maxStep / 2.0 + random.Next((int)Math.Round(maxStep) / 2);
                veloMag = Hypot(veloX, veloY);
                veloX = (veloX / veloMag) * randomDist;
                veloY = (veloY / veloMag) * randomDist;
            }

            oldX = (int)Math.Round(xs);
            oldY = (int)Math.Round(ys);
            xs += veloX;
            ys += veloY;
            dist = Hypot(xe - xs, ye - ys);
            newX = (int)Math.Round(xs);
            newY = (int)Math.Round(ys);

            if (oldX != newX || oldY != newY)
                SetCursorPos(newX, newY);

            step = Hypot(xs - oldX, ys - oldY);
            int wait = (int)Math.Round(waitDiff * (step / maxStep) + minWait);
            Thread.Sleep(wait);
        }

        int endX = (int)Math.Round(xe);
        int endY = (int)Math.Round(ye);
        if (endX != newX || endY != newY)
            SetCursorPos(endX, endY);
    }

    static double Hypot(double dx, double dy) {
        return Math.Sqrt(dx * dx + dy * dy);
    }

    [DllImport("user32.dll")]
    static extern bool SetCursorPos(int X, int Y);

    [DllImport("user32.dll")]
    public static extern bool GetCursorPos(out Point p);
} 
```

* * *

## 回答 #3

> 赞同：3
> 
> 时间：2009-05-28T08:26:54.057

```
procedure WindMouse(xs, ys, xe, ye, gravity, wind, minWait, maxWait, maxStep, targetArea: extended);
var
  veloX, veloY, windX, windY, veloMag, dist, randomDist, lastDist, step: extended;
  lastX, lastY: integer;
  sqrt2, sqrt3, sqrt5: extended;
begin
  sqrt2:= sqrt(2);
  sqrt3:= sqrt(3);
  sqrt5:= sqrt(5);
  while hypot(xs - xe, ys - ye) > 1 do
  begin
    dist:= hypot(xs - xe, ys - ye);
    wind:= minE(wind, dist);
    if dist >= targetArea then
    begin
      windX:= windX / sqrt3 + (random(round(wind) * 2 + 1) - wind) / sqrt5;
      windY:= windY / sqrt3 + (random(round(wind) * 2 + 1) - wind) / sqrt5;
    end else
    begin
      windX:= windX / sqrt2;
      windY:= windY / sqrt2;
      if (maxStep < 3) then
      begin
        maxStep:= random(3) + 3.0;
      end else
      begin
        maxStep:= maxStep / sqrt5;
      end;
    end;
    veloX:= veloX + windX;
    veloY:= veloY + windY;
    veloX:= veloX + gravity * (xe - xs) / dist;
    veloY:= veloY + gravity * (ye - ys) / dist;
    if hypot(veloX, veloY) > maxStep then
    begin
      randomDist:= maxStep / 2.0 + random(round(maxStep) / 2);
      veloMag:= sqrt(veloX * veloX + veloY * veloY);
      veloX:= (veloX / veloMag) * randomDist;
      veloY:= (veloY / veloMag) * randomDist;
    end;
    lastX:= Round(xs);
    lastY:= Round(ys);
    xs:= xs + veloX;
    ys:= ys + veloY;
    if (lastX <> Round(xs)) or (lastY <> Round(ys)) then
      MoveMouse(Round(xs), Round(ys));
    step:= hypot(xs - lastX, ys - lastY);
    wait(round((maxWait - minWait) * (step / maxStep) + minWait));
    lastdist:= dist;
  end;
  if (Round(xe) <> Round(xs)) or (Round(ye) <> Round(ys)) then
    MoveMouse(Round(xe), Round(ye));
end;

{*******************************************************************************
procedure MMouse(x, y, rx, ry: integer);
By: Benland100
Description: Moves the mouse.
*******************************************************************************}
//Randomness is just added to the x,y. Might want to change that.
procedure MMouse(x, y, rx, ry: integer);
var
  cx, cy: integer;
  randSpeed: extended;
begin
  randSpeed:= (random(MouseSpeed) / 2.0 + MouseSpeed) / 10.0;
  if randSpeed = 0.0 then
    randSpeed := 0.1;
  getMousePos(cx,cy);
  X := x + random(rx);
  Y := y + random(ry);
  WindMouse(cx,cy,x,y,9.0,3.0,10.0/randSpeed,15.0/randSpeed,10.0*randSpeed,10.0*randSpeed);
end; 
```

以下是一些用 SCAR 编写的方法。将它们转换为 C# 应该不会太难，这些都是非常现实的。

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2009-05-27T02:34:59.177

我认为，一种常用的方法是用自己的手实际移动真实的鼠标：让软件捕捉这些（真实的）动作，并重放它们。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2020-08-08T12:35:23.880

你可以试试这个。

```
public static class Mouse
{
    private const float MOUSE_SMOOTH = 200f;

    public static void MoveTo(int targetX, int targetY)
    {
        var targetPosition = new Point(targetX, targetY);
        var curPos = Cursor.Position;

        var diffX = targetPosition.X - curPos.X;
        var diffY = targetPosition.Y - curPos.Y;

        for (int i = 0; i <= MOUSE_SMOOTH; i++)
        {
            float x = curPos.X + (diffX / MOUSE_SMOOTH * i);
            float y = curPos.Y + (diffY / MOUSE_SMOOTH * i);
            Cursor.Position = new Point((int)x, (int)y);
            Thread.Sleep(1);
        }

        if (Cursor.Position != targetPosition)
        {
            MoveTo(targetPosition.X, targetPosition.Y);
        }
    }
} 
```

# ruby-on-rails - 适用于 ror 的默认 .htaccess 文件

> ID：913654
> 
> 赞同：0
> 
> 时间：2009-05-27T02:18:57.523
> 
> 标签：ruby-on-rails

为了在 Rails 中工作，我的 .htaccess 文件应该包含什么，这就是我现在拥有的，我想确保它是正确的：

AddHandler fastcgi-script .fcgi
选项 +FollowSymLinks +ExecCGI
RewriteEngine On
RewriteRule ^$ index.html [QSA]
RewriteRule ^([^.]+)$ $1.html [QSA]
RewriteCond %{REQUEST_FILENAME} !-f
RewriteRule ^(. *)$ dispatch.fcgi [QSA,L]

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-05-28T01:11:09.083

您可以使用该命令设置一个新的临时 Rails 应用程序框架`rails`，并将现有`.htaccess`文件与那里生成的新`.htaccess`文件进行比较。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-05-28T02:16:34.660

这是我使用的那个有效的。以防万一其他人需要一个适用于带有 fcgi（FastCGI）的 ruby​​ on rails

AddHandler fastcgi-script .fcgi
AddHandler cgi-script .cgi
Options +FollowSymLinks +ExecCGI
RewriteEngine On
RewriteRule ^$ index.html [QSA]
RewriteRule ^([^.]+)$ $1.html [QSA]
RewriteCond %{REQUEST_FILENAME} ！ -f
RewriteRule ^(.*)$ dispatch.fcgi [QSA,L]

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-05-27T02:35:52.247

确保某事正确的方法是对其进行操作测试。只是在说'。

# sql - 交通时刻表系统数据库设计

> ID：913661
> 
> 赞同：4
> 
> 时间：2009-05-27T02:22:12.213
> 
> 标签：sql, database-design, timetable

自从我在大学二年级的时候上数据库设计课已经有一段时间了。而且我在此期间没有做过任何设计，所以我的技能目前充其量是生疏的。我已经开始从事一个涉及铁路时刻表系统的个人项目，并且似乎被困在类似于这样的表格设计上 -

```
StationTbl
------------
  StnName
  StnCity
  StnCode -  {Primary Key}

TrainTbl
---------
  TrnName
  TrnNumber -  {Primary Key}
  SourceStn
  DestStn
  DaysofWeek 

TrainHopTbl
--------------
  TrnNumber   -  {Primary Key}
  StationCode -  {Primary Key}
  ArrTime
  DepTime
  HopIndex 
```

除了 Time 字段和 TrainHopTbl 中的 HopIndex 之外，大多数字段都是字母数字的。如您所见，初步设计非常粗糙，远未完成。

用户将能够根据列车名称/编号或指定源站和目的地站来查找列车。第一个查询可以轻松处理，但我在为第二个搜索编写查询时遇到问题，其中用户提供 src/dest 对，服务器返回在该路线上运行的火车列表。此信息将从 TrainHopTbl 中提取，其中包含特定火车的跳数列表，如下所示 -

```
TrainHopTbl
--------------
Num StnCode  ArrTime  DepTime  HopIndex
121  WDC     0900      0910        1
121  BAL     1005      1010        2
121  NYC     1145       -          3 
```

如果用户输入**WDC/NYC**作为 src/dest 对，则查询应返回 Train Number 121，因为它是有效路线。

任何关于数据库设计的指针/链接/书籍建议都会有所帮助。哎呀，在这一点上，即使是可运行的查询或整个重新设计也会有所帮助，因为我似乎陷入了难以摆脱的陈规之中，这完全阻碍了我的进步。

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2009-05-27T03:02:22.460

我会把你的 SourceStn 和 DestStn 从你的 TrainTbl 中拿出来——这是不必要的混乱。

无论如何，你可以得到你正在寻找的东西：

```
select 
    src.TrnNumber,
    srcSt.StnName as SourceStation, 
    srcSt.StnCity as SourceCity,
    src.DepTime,
    destSt.StnName as DestinationStation,
    destSt.StnCity as DestinationCity,
    dest.ArrTime,
    (abs(dest.HopIndex - src.HopIndex)) as Stops
from
    TrainHopTbl src
    inner join TrainHopTbl dest on
        src.TrnNumber = dest.TrnNumber
    inner join StationTbl srcSt on
        src.StnCode = srcSt.StationCode
    inner join StationTbl destSt on
        dest.StnCode = destSt.StationCode
where
    src.StnCode = 'WDC'
    and dest.StnCode = 'NYC'
    and src.HopIndex < dest.HopIndex
order by
    Stops asc,
    DepTime asc 
```

编辑：我没有考虑这里的转账。你的问题只提到了直行列车。让我知道你是否也想转让。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2009-05-27T10:45:13.683

我还没有考虑到这一点，所以这个回应可能会很遥远。

我认为 TrainHopTbl 记录网络中的节点，在网络中记录边缘会更有用。一条边将有一个火车号、一个出发站、一个出发时间、一个到达站和一个到达时间。也许像你一样的跳跃索引。

所以，

编号：121，Hopindex：1，DepStnCode：WDC，DepTime：910，ArrStnCode：BAL，ArrTime：1005

将描述从华盛顿到巴尔的摩的“跃点”，即跃点网络中的一个边缘。

（另外，我将一跳称为“腿”，但这只是命名选择。）

通过让啤酒花将两个站点连接在一起，可以将一系列啤酒花连接起来，让您在一次旅行中从一个地方到另一个地方。有些旅行甚至可能涉及在某个车站换乘火车，前提是到达时间比下一跳的出发时间早一点。

不利的一面是车站代码有更多的冗余。我还没有弄清楚这种冗余是否有害。

* * *

## 回答 #3

> 赞同：-2
> 
> 时间：2009-05-27T03:02:02.727

您似乎正在尝试解决数据库的硬图问题。将字段添加到以字符串形式存储停靠点列表的火车表中可能会容易得多

```
"WDC, BAL, NYC" 
```

然后您只需要找到包含您要查找的两个子字符串的火车，在本例中为“WDC”和“NYC”。这大大缩小了您的搜索范围，以至于您可以在 SQL 之外的代码中考虑生成的火车。

如果不做比我现在愿意做的更多的研究，那么你要做的就是

SELECT from where contains "WDC" AND contains "NYC"

我不知道最好的方式来包含...评论任何人？

# iphone - 不能在控制器类之外设置 UISwitch

> ID：913663
> 
> 赞同：0
> 
> 时间：2009-05-27T02:22:56.703
> 
> 标签：iphone

iphone 程序设置在 Utility Application 模型中，其中有一个根视图和两个子视图（mainViewController 和 FlipsideViewController），它们是插座。

如果我尝试在 rootViewController 的 viewDidLoad 上设置 UISwitch（使用 [flipsideViewController.switchInstance setOn:YES]），它就不起作用。

在 FlipsideViewController 中，该方法有效，但在其外部无效。知道为什么吗？我可以通过其他方法...

即使我将一个方法传递给然后执行 setOn 方法的flipsideViewController，它仍然不起作用......

有任何想法吗？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-05-27T20:37:32.003

就像“健全性检查”（正如其他人对我所说）一样，您是否在调用上述代码时确保您的 flipsideViewController 变量不为空？

# spring - 不同的 DelegatingFilterProxy 和 FilterToBeanProxy

> ID：913667
> 
> 赞同：1
> 
> 时间：2009-05-27T02:24:09.620
> 
> 标签：spring, spring-mvc, spring-security

谁能清楚地向我解释 web.xml 中定义的这两个类之间的区别？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2009-05-27T07:02:31.530

FilterToBeanProxy (F2BP) 是一个 Acegi 安全类，其用途与 Springs DelegatingFilterProxy (DFP) 相似。据我所知，不再需要使用 F2BP，现在 Acegi Security 是 Spring 的一部分，您可以使用 Spring 的 DFP 达到相同的效果。

请参阅 javadocs 进行确认： [FilterToBeanProxy Javadoc](http://static.springsource.org/spring-security/site/apidocs/org/springframework/security/util/FilterToBeanProxy.html)

# compiler-construction - 有 Lisp 本机代码编译器吗？

> ID：913671
> 
> 赞同：32
> 
> 时间：2009-05-27T02:25:54.843
> 
> 标签：compiler-construction, lisp

是否有适用于 Lisp 的本机代码编译器？它甚至可以在多大程度上被编译，具有动态特性、垃圾收集、宏等等？

* * *

## 回答 #1

> 赞同：53
> 
> 时间：2009-05-27T07:18:37.417

许多 Lisp 编译器编译为“本机”代码。'Native' 在这里是指'机器代码'（32 位或 64 位模式下的 x86，PowerPC，SPARC，...）。

其他问题：

*   “非本机代码”编译器可以生成单文件可执行文件吗？-> 是的。

*   “本机代码”编译器可以生成单文件可执行文件吗？-> 是的。

*   'native' 是如何'native' 的？-> Lisp 系统大部分时间都会有自己的内部数据结构布局（CLOS 类）、自己的错误处理（“条件”）、自己的内存管理（垃圾收集）、自己的库，...

*   Lisp 可以在没有 GC 的情况下运行吗？-> 通常不会。也有例外。

*   应用程序大小如何？-> 默认情况下，生成 Lisp 应用程序的简单方法通常会生成大型可执行文件。可执行文件包括整个 Lisp，包括它的库、所有符号的名称、有关函数参数列表的信息、编译器、调试器、源代码位置信息等等。一些编译器也会生成较大的代码（SBCL 就是一个例子）。

*   有没有办法缩小应用程序的大小？-> 这取决于 Lisp 系统。像 LispWorks 和 Allegro CL 这样的商业 Lisp 系统可以。对于应用程序交付，他们可以删除未使用的代码、删除调试信息、删除 Lisp 的某些部分（库、编译器等）等等。

*   Common Lisp 系统可以生成小的可执行文件。我的意思是真的很小。-> 不是真的。可执行文件要么很大（CCL），要么非常大（SBCL）。一些 Common Lisp 系统可以生成中等大小的可执行文件。但是没有一个可以真正生成小的可执行文件。

*   真的没有办法生成非常小的可执行文件吗？-> 多年前编写的编译器可以生成相对紧凑的 C 代码，而无需大型库。但是这些编译器没有维护。

*   还有其他方法可以缩小可执行文件吗？-> 如果你想运行多个 Lisp 应用程序，在一个或多个共享库中重用运行时、编译器、库是有意义的。这样，当运行时已经安装为共享库（或类似库）时，要交付的代码会更小。

*   如何找出我使用的 Lisp 支持作为应用程序交付的内容？-> 阅读手册并询问其他用户。

*   好的，所以大多数 Common Lisp 系统无法生成微小的应用程序。是否有其他 Lisp 方言可以生成更小的可执行文件。-> 是的，一些 Scheme 编译器可以。

*   Common Lisp 如何处理运行时错误？-> 取决于您生成应用程序的方式。默认情况下，您会获得一个 Lisp 调试器（除非您已将其删除）。但是您可以在应用程序中使用自己的错误处理例程，并且可以阻止调试器出现。

*   当生成非常小的可执行文件时，Common Lisp 的特殊优势是什么？-> 你可以包含一个 REPL 来与应用程序交互，你可以使用一个包含的编译器在运行时编译新的（或更改的代码），你可以使用 FASL（编译的 Lisp 代码）加载器在运行时加载额外的本机代码（想想插件，补丁，扩展，...），复杂的错误处理，包括错误恢复是可能的，...

*   但是 Lisp 是动态的吗？-> 是的，动态意味着它可以在运行时改变很多东西。例如，在 Common Lisp 中，您可以在运行时更改 CLOS 类，并且该类的实例将采用这些更改。但是各种 Lisp 系统有不同的方法来删除一些动态特性。结构的动态性不如 CLOS 类。您可以声明类型并使用不同的优化设置（速度、安全性、调试......）进行编译。您可以内联函数。和更多。

查看函数的编译代码的一种简单方法是使用 Common Lisp 函数 DISSASSEMBLE。x86-64 Mac 上的 Clozure CL 示例

```
? (defun foo (x y) (if (= x y) (sin x) (* y (cos x))))
FOO
? (disassemble 'foo)
L0
  [0]     (leaq (@ (:^ L0) (% rip)) (% fn))
  [7]     (cmpl ($ 16) (% nargs))
  [10]    (jne L209)
  [16]    (pushq (% rbp))
  [17]    (movq (% rsp) (% rbp)) 
```

...

```
 [172]   (pushq (@ 77752))
  [179]   (jmpq (@ 10 (% temp0)))
L189
  [189]   (leaq (@ (:^ L0) (% rip)) (% fn))
  [196]   (jmpq (@ .SPNVALRET))
L209
  [209]   (uuo-error-wrong-number-of-args)
NIL 
```

DISSASSEMBLE 的输出显然取决于处理器架构、操作系统、使用的 Lisp 编译器和当前的优化设置。

* * *

## 回答 #2

> 赞同：9
> 
> 时间：2009-05-27T04:13:20.343

有许多 Lisp 编译器可以编译为本机代码。CMUCL、SBCL、ClozureCL 在开源 Lisp 编译器中是众所周知的。

垃圾收集不是编译为本机代码的障碍。此外，在某些情况下，Lisp 可以使用不需要 GC 的堆栈分配，并且可以大大提高性能（使用动态范围声明；至少 SBCL 支持这一点）。

宏（以及在读取时（读取宏和读取评估）、编译时（宏、编译器宏、eval-when 中的代码）运行的任何代码）需要增量编译（必须编译第一个宏函数，然后可以编译使用宏的代码）。这有点使编译复杂化，但问题不大。此外，宏和编译器宏甚至有助于编译过程，因为它们允许程序员编写代码生成器和代码优化器，本质上是自定义编译器。

所以编译器比一些更简单的语言（如 C）更复杂，但复杂性是可控的（参见[CMU Common Lisp 的设计](http://common-lisp.net/project/cmucl/doc/CMUCL-design.pdf)）。

Common Lisp 的动态特性是可控的，并且设计为可高效编译。与其他一些动态语言（例如 Python）相比，动态性受到限制（例如，您不能在运行时采用当前的词法环境），这给编译器一些优化的自由。

* * *

## 回答 #3

> 赞同：6
> 
> 时间：2009-05-27T02:29:25.617

本机代码有大量的 Lisp 编译器，请参阅[http://www.thefreecountry.com/compilers/commonlisp.shtml](http://www.thefreecountry.com/compilers/commonlisp.shtml)和例如 CMU Common Lisp Compiler。

* * *

## 回答 #4

> 赞同：4
> 
> 时间：2009-05-27T02:28:38.177

你打赌。 [Chez Scheme](http://www.scheme.com)（一种商业编译器）是更好的编译器之一。Gambit 和 Larceny 是也生成本机代码的研究编译器。

* * *

## 回答 #5

> 赞同：4
> 
> 时间：2009-10-23T22:13:50.410

不要忘记[鸡](http://www.call-with-current-continuation.org/) 计划。

* * *

## 回答 #6

> 赞同：3
> 
> 时间：2009-05-27T02:30:18.297

是的。请参阅[http://en.wikipedia.org/wiki/Common_Lisp](http://en.wikipedia.org/wiki/Common_Lisp)。它提到[Steel Bank Common Lisp](http://en.wikipedia.org/wiki/Steel_Bank_Common_Lisp)（一个相当流行的实现）默认将所有内容编译为本机。使用垃圾收集等的事实并不是本机代码的障碍。这只是意味着需要某种运行时。但那又怎样？甚至 C 也有运行时。

# java - 是什么导致了这个 MySQLSyntaxError 异常？

> ID：913674
> 
> 赞同：0
> 
> 时间：2009-05-27T02:28:03.293
> 
> 标签：java, mysql, exception, jsp

我写了这个查询（在java类中）从MySQL数据库中选择一些信息并在jsp页面上查看......

> 从教师、部门、教学中选择教师名称

但有异常发生！

> javax.servlet.ServletException: com.mysql.jdbc.exceptions.MySQLSyntaxErrorException: 你的 SQL 语法有错误；检查与您的 MySQL 服务器版本相对应的手册，以在第 1 行的 '.student_id='3'ANDteacher.section = section.number AND section.instructor_id=ins' 附近使用正确的语法

,,

顺便说一句，我是用 PhpMyAdmin 写的，它的工作..

应用服务器：Sun GlassFish Enterprise Server v2.1

请帮我...

问候

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2009-05-27T02:31:14.333

后面需要一个空格`'3'`。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-05-27T02:32:03.910

好像少了一个空格。'.student_id='3'AND -> '.student_id='3' AND

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-05-27T02:44:18.143

“teach.student_id”的数据类型是什么？它是数字还是varchar。如果是数字，则无需将 '3' 放在单引号内。例如教.student_id = 3

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2009-05-27T03:01:44.927

谢谢大家

我在这样的java类中写查询

> ResultSet rs =stmt.executeQuery("SELECT coach.name " + "FROM coach,section,teach" + "WHERE tea.student_id=" + "'" + idd + "'" + " ANDteacher.section = section.number AND section.instructor_id=instructor.ID");

然后我消除所有行，然后像这样将查询放在一行中，然后就解决了...

问候

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2009-05-27T02:33:47.900

如果您的查询与您显示的完全一样：

```
SELECT instructor.name FROM instructor,section,teach WHERE teach.student_id='3'AND
    teach.section = section.number AND section.instructor_id= instructor.ID 
```

那么你需要在上面显示的第一行`'3'`之前和之后有一个空格。`AND`

# mysql - MySql 分组方式

> ID：913684
> 
> 赞同：0
> 
> 时间：2009-05-27T02:31:17.063
> 
> 标签：mysql, database

大家好，我有下表，'t1'

```
id     r_id     o_id     count
1       2       100       1
2       3       100       1
3       5       100       1
4       2       101       2
5       3       101       2
6       4       101       2 
```

我要做的是，对于给定的 r_id 列表，返回计数最高（最大值）的 r_id 和 o_id。所以理想情况下，给定 3 和 5 的 r_id，我会得到以下结果：

```
r_id      o_id
 5         100
 3         101 
```

我尝试了以下方法：

```
select o_id, max(count), r_id from t1 where r_id IN (3, 5) group by r_id; 
```

但它似乎没有给我正确的关联o_id。有任何想法吗？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2009-05-27T02:44:19.720

乍一看比我想象的要难 - 这应该有效：

```
select a.r_id,a.o_id from t1 a inner join (select r_id,max(count) as max from t1 group by r_id) as b on a.r_id = b.r_id and a.count = b.max where a.r_id in (3,5) 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-05-27T03:08:55.380

正如你所说的那样`r_id`，`o_id`作为两个输出列......：

```
SELECT r_id, o_id
FROM t1 AS a
WHERE r_id in (3, 5)
AND count =
  (SELECT MAX(count)
   FROM t1 AS b
   WHERE b.r_id = a.r_id
  ) 
```

如果某一个`o_id`具有相同“最大计数”的不止一个`r_id`，这将全部返回（而不是任意选择其中一个）。

在带有示例表的 MySQL 5.1 上：

```
mysql> select * from t1;
+------+------+------+-------+
| id   | r_id | o_id | count |
+------+------+------+-------+
|    1 |    2 |  100 |     1 | 
|    2 |    3 |  100 |     1 | 
|    3 |    5 |  100 |     1 | 
|    4 |    2 |  101 |     2 | 
|    5 |    3 |  101 |     2 | 
|    6 |    4 |  101 |     2 | 
+------+------+------+-------+
6 rows in set (0.00 sec) 
```

这个查询给了我你要求的结果：

```
+------+------+
| r_id | o_id |
+------+------+
|    5 |  100 | 
|    3 |  101 | 
+------+------+
2 rows in set (0.31 sec) 
```

顺便说一句，我的确切版本：

```
mysql> SELECT VERSION();
+-----------+
| VERSION() |
+-----------+
| 5.1.34    | 
+-----------+
1 row in set (0.00 sec) 
```

# php - 如何在php中的特定日期发送？

> ID：913685
> 
> 赞同：2
> 
> 时间：2009-05-27T02:31:20.730
> 
> 标签：php, email, datetime

我想要电子贺卡或类似的东西。用户可以选择电子贺卡，选择后，他必须输入一些字段，如姓名（to and from），email（to and from），message，我想让用户选择发送电子贺卡的日期.

如何在特定日期发送电子贺卡？我需要编写一个每天运行的脚本吗？怎么做？抱歉，我是 php 新手...（但不是初学者，甚至不知道如何执行 mysql 查询，从 url 获取消息等）

* * *

## 回答 #1

> 赞同：9
> 
> 时间：2009-05-27T02:38:12.853

是的，您需要一个每天运行的脚本。（除非通过检查 Web 请求来尝试伪装这种可笑的操作。）在 Unix 上下文中执行此操作的常用方法称为**cron 作业**；如果您的托管服务提供商是基于 Unix 的，您应该查看他们为您提供 cron 作业所提供的内容。在 Windows 上，有一个名为 Scheduled Tasks 的并行服务。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2009-05-27T14:44:41.530

这是针对 *nix 的。假设您有一个名为 mailer.php 在特定日期发送电子邮件的 php 脚本

```
<?php
    //mailer.php
    if (date("m/d/Y") == "06/02/2009") {
        mail("client@email", "Subject", "Body");
    }
?> 
```

我们将假设您已经在后台运行了 cron 守护程序。

如果您对您的机器具有 root 访问权限，那么设置 cron 作业就像编辑文件一样简单。

打开 /etc/crontab 文件并添加以下任务：

```
1 14 * * * root php /path/to/your/scrip/mailer.php 
```

这意味着，作为 root，mailer.php 脚本将在每天下午 2:01 运行。您可以将数字更改为您想要的任何数字。

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2009-05-27T15:27:07.233

这里讨论了一个类似的问题 reset [-a-mysql-field-value-without-user-execution](https://stackoverflow.com/questions/902277/resetting-a-mysql-field-value-without-user-execution/902929#902929)

我只是重申一下：也有基于 Web 的 cron 服务。如果您只有共享托管计划并且无法添加 cron 作业，这可能会派上用场。他们将定期调用您可以设置的 URL。通常非常便宜。（无论如何都比升级到根访问服务器便宜。）

只需在 Google 上搜索[基于 Web 的 cron](http://www.google.com/search?hl=en&q=web+based+cron&aq=f&oq=&aqi=g3)

再见！/0

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2009-05-27T14:26:35.903

这有点复杂。首先，这取决于您的系统。如果它是 Linux/BSD/Unix/Solaris，那么你有这个方便的实用程序作为**cron**。如果您使用的是 Windows，则您有**Scheduled Tasks**。每天（或根据需要）运行您的脚本并检查您今天必须发送哪些卡片。

# asp.net - 从启动浏览器禁用 Visual Studio ASP.Net 调试

> ID：913689
> 
> 赞同：5
> 
> 时间：2009-05-27T02:33:37.277
> 
> 标签：asp.net, visual-studio, visual-studio-2008, configuration

每当我调试 ASP.NET 项目时，如何配置 Visual Studio 以停止启动浏览器窗口？

* * *

## 回答 #1

> 赞同：17
> 
> 时间：2009-05-27T02:36:09.703

在“开始操作”下的“Web”选项卡 (VS2008) 上的 Web 项目的属性中，或直接在其他版本的 Visual Studio 中的“开始选项”下。选择“不打开页面。等待来自外部应用程序的请求”单选按钮。

那应该做的工作。但可能会发现您需要一个浏览器来测试它。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-05-27T03:17:01.387

解决这个问题的最好方法是构建解决方案（右键单击解决方案 -> 构建解决方案），然后像往常一样使用浏览器。它的执行速度也更快，这是一个优点。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2014-07-02T18:26:59.210

我正在使用VS2013。我这样做的方法是右键单击项目名称->属性-> Web->选择“不要打开页面。等待来自外部应用程序的请求”

# dll - DLL 和 LIB 文件 - 什么以及为什么？

> ID：913691
> 
> 赞同：263
> 
> 时间：2009-05-27T02:33:47.680
> 
> 标签：dll, static-libraries

我对 DLL 和 LIB 知之甚少，除了它们包含程序正常运行所需的重要代码 - 库。但是为什么编译器会生成它们呢？将所有代码包含在一个可执行文件中不是更容易吗？DLL 和 LIB 之间有什么区别？

* * *

## 回答 #1

> 赞同：361
> 
> 时间：2009-05-27T02:57:25.857

有静态库 (LIB) 和动态库 (DLL) - 但请注意，.LIB 文件可以是静态库（包含目标文件）或导入库（包含允许链接器链接到 DLL 的符号）。

使用库是因为您可能拥有要在许多程序中使用的代码。例如，如果您编写一个计算字符串中字符数的函数，该函数将在许多程序中很有用。一旦你让那个函数正常工作，你就不想每次使用它时都重新编译代码，所以你把那个函数的可执行代码放在一个库中，链接器可以提取编译后的代码并将其插入你的程序. 出于这个原因，静态库有时被称为“档案”。

动态库更进一步。让库函数的多个副本在每个程序中占用空间似乎很浪费。为什么他们不能都共享该功能的一份副本？这就是动态库的用途。与其在编译时将库代码构建到程序中，不如在加载到内存时将其映射到程序中来运行它。同时运行的多个程序使用相同的功能可以共享一份，节省内存。实际上，您可以仅根据需要加载动态库，具体取决于代码的路径。如果您不进行任何打印，那么让打印机例程占用内存毫无意义。另一方面，这意味着您必须在运行程序的每台机器上安装动态库的副本。

例如，几乎每个用“C”编写的程序都需要来自称为“C 运行时库”的库中的函数，尽管很少有程序需要所有函数。C 运行时有静态和动态两种版本，因此您可以根据特定需要确定您的程序使用哪个版本。

* * *

## 回答 #2

> 赞同：41
> 
> 时间：2012-07-03T05:32:27.467

另一个方面是安全性（混淆）。一旦从主应用程序中提取一段代码并放入“分离的”动态链接库，就更容易攻击、分析（逆向工程）代码，因为它已被隔离。当同一段代码保存在 LIB 库中时，它是已编译（链接）目标应用程序的一部分，因此很难将该段代码与其余目标二进制文件隔离（区分）。

* * *

## 回答 #3

> 赞同：20
> 
> 时间：2009-05-27T02:46:59.510

创建 DLL/LIB 而不仅仅是将代码编译成可执行文件的一个重要原因是重用和重定位。普通的 Java 或 .NET 应用程序（例如）很可能会使用多个第 3 方（或框架）库。仅针对预构建库进行编译会更容易和更快，而不必将所有 3rd 方代码编译到您的应用程序中。将您的代码编译到库中还鼓励良好的设计实践，例如设计您的类以用于不同类型的应用程序。

* * *

## 回答 #4

> 赞同：9
> 
> 时间：2016-01-19T12:11:35.123

DLL 是在其他可执行程序之间共享的函数库。只需查看您的 windows/system32 目录，您就会发现其中有几十个。当您的程序创建 DLL 时，它通常还会创建一个 lib 文件，以便应用程序 *.exe 程序可以解析在 DLL 中声明的符号。

.lib 是静态链接到程序的函数库——它们不被其他程序共享。每个与 *.lib 文件链接的程序都包含该文件中的所有代码。如果您有两个与 C.lib 链接的程序 A.exe 和 B.exe，那么每个 A 和 B 都将包含 C.lib 中的代码。

您如何创建 DLL 和库取决于您使用的编译器。每个编译器的做法都不同。

* * *

## 回答 #5

> 赞同：7
> 
> 时间：2017-09-08T06:33:21.187

另一个区别在于性能。

由于 DLL 在运行时由 .exe(s) 加载，因此 .exe(s) 和 DLL 使用共享内存概念，因此与静态链接相比性能较低。

另一方面，.lib 是在编译时静态链接到请求的每个进程的代码。因此 .exe(s) 将具有单个内存，从而提高进程的性能。

# c# - 通过 HTTPS C# 下载文件 - Cookie 和标头问题？

> ID：913694
> 
> 赞同：1
> 
> 时间：2009-05-27T02:34:40.190
> 
> 标签：c#, asp.net, https

我正在尝试通过 HTTPS 下载文件，但我只是在正确设置 Cookie 和标头的情况下不断遇到砖墙。

有没有人有/知道我可以检查以正确执行此操作的任何代码？即通过https下载文件并设置cookies/headers？

谢谢！

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-05-27T04:36:16.193

前几天我这样做了，总而言之，您需要创建一个 HttpWebRequest 和 HttpWepResponse 来提交/接收数据。由于您需要跨多个请求维护 cookie，因此您需要创建一个 cookie 容器来保存您的 cookie。如果需要，您也可以在请求/响应中设置标头属性......

基本概念：

```
Using System.Net;

// Create Cookie Container (Place to store cookies during multiple requests)

CookieContainer cookies = new CookieContainer();

// Request Page
HttpWebRequest req = (HttpWebRequest)WebRequest.Create("https://www.amazon.com");
req.CookieContainer = cookies;

// Response Output (Could be page, PDF, csv, etc...)

HttpWebResponse resp= (HttpWebResponse)req.GetResponse();

// Add Response Cookies to Cookie Container
// I only had to do this for the first "login" request

cookies.Add(resp.Cookies); 
```

解决这个问题的关键是捕获真实请求的流量。我使用 Fiddler 完成了这项工作，在几次捕获（几乎 10 次）的过程中，我弄清楚了我需要做些什么来重现登录到我需要根据不同的选择标准（日期范围、部分）运行一些报告的站点等）并将结果下载到 CSV 文件中。它工作完美，但 Fiddler 是解决这个问题的关键。

[http://www.fiddler2.com/fiddler2/](http://www.fiddler2.com/fiddler2/)

祝你好运。

扎克

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-05-27T03:15:15.477

这家伙写了一个应用程序来使用 HTTP 下载文件：

[http://www.codeproject.com/KB/IP/DownloadDemo.aspx](http://www.codeproject.com/KB/IP/DownloadDemo.aspx)

不太清楚设置 cookie 和标头是什么意思。您下载的网站是否要求这样做？如果是，需要设置哪些 cookie 和标头？

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-05-27T04:45:11.447

我在 WebClient 类上运气不错。它是 HttpWebRequest 的包装器，可以节省几行代码：http: [//msdn.microsoft.com/en-us/library/system.net.webclient.aspx](http://msdn.microsoft.com/en-us/library/system.net.webclient.aspx)

# windows - 应用程序截取的屏幕截图在 Vista 上是空白的

> ID：913697
> 
> 赞同：0
> 
> 时间：2009-05-27T02:35:19.293
> 
> 标签：windows, windows-vista

你好，

我们有一个捕获桌面屏幕截图的 C# 应用程序。它在 windows XP 上运行良好，但在 vista 上，屏幕截图是空白的。为什么这样 ？？有什么解决办法吗？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2009-05-27T02:35:19.480

这应该去stackoverflow；原因是 UI 编程模型在 XP 和 Vista 之间发生了根本性的变化，您将能够在那里获得一些很好的帮助。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-05-27T02:35:19.527

可能是因为 UAC 它使用不同的桌面来显示自己。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-05-27T03:45:02.060

请发布代码以帮助您。我曾经写过[一篇关于屏幕截图](http://www.dotnetcurry.com/ShowArticle.aspx?ID=303)（VB.net 和 c#）的文章。它在 XP 和 Vista 中运行良好。如果有兴趣，请查看。

你如何捕捉它？屏幕大小不一样吗？

# git - 如何更改 git 子模块的远程存储库？

> ID：913701
> 
> 赞同：868
> 
> 时间：2009-05-27T02:35:49.860
> 
> 标签：git, git-submodules

我创建了一个带有子模块的 git 存储库。我能够告诉子模块本身更改其远程存储库路径，但我不确定如何告诉父存储库如何更改子模块的远程存储库路径。

如果我有点不走运并且必须手动执行操作，我不会感到惊讶，因为即使删除子模块也不容易。

* * *

## 回答 #1

> 赞同：1177
> 
> 时间：2009-05-27T05:25:39.867

您应该能够编辑`.gitmodules`文件以更新 URL，然后运行`git submodule sync --recursive`以将该更改反映到超级项目和您的工作副本。

然后你需要转到`.git/modules/path_to_submodule`目录并更改其配置文件以更新 git 路径。

如果回购历史不同，那么您需要手动签出新分支：

```
git submodule sync --recursive
cd <submodule_dir> 

git fetch
git checkout origin/master
git branch master -f
git checkout master 
```

* * *

## 回答 #2

> 赞同：192
> 
> 时间：2015-06-05T20:17:48.367

这些命令将在命令提示符下完成工作，而不会更改本地存储库中的任何文件

```
git config --file=.gitmodules submodule.Submod.url https://github.com/username/ABC.git
git config --file=.gitmodules submodule.Submod.branch Development
git submodule sync
git submodule update --init --recursive --remote 
```

请查看博客的屏幕截图：[将 GIT 子模块 URL/分支更改为同一存储库的其他 URL/分支](http://pa1gitsolutions.blogspot.ca/2015/07/changing-git-submodules-urlbranch-to.html)

* * *

## 回答 #3

> 赞同：186
> 
> 时间：2009-05-27T05:40:27.497

使用 Git 2.25（2020 年第一季度），您可以对其进行**修改**。
请参阅“ [Git submodule url changed](https://stackoverflow.com/a/59364554/6309) ”和新命令

```
git submodule set-url [--] <path> <newurl> 
```

（在`--`分隔符上，请参阅“[双连字符作为停止选项解释并按字面处理所有后续参数的信号](https://stackoverflow.com/a/1192194/6309)”）

警告：[Hi-Angel](https://stackoverflow.com/users/2388257/hi-angel)[在评论](https://stackoverflow.com/questions/913701/how-to-change-the-remote-repository-for-a-git-submodule/914135?noredirect=1#comment118169982_914135)中提到（即使使用 Git 2.31.1 测试）：

> 应该小心，`git submodule set-url`因为它有一个错误：
> 
> 如果在您的`.gitmodules`文件中，路径看起来像这样`some-path`，然后您执行一个`git submodule set-url some-path/ new-url`（注意尾部斜杠`/`），那么，该命令将*添加*另一个子模块，而不是修改现有的子模块。

* * *

原始答案（2009 年 5 月，十年前）

实际上，[已经在 2009 年 4 月提交了](https://public-inbox.org/git/526944450904080004r1249d1b8j4a44472d72502b9c@mail.gmail.com/)一个补丁来澄清`gitmodule`角色。

所以现在[gitmodule 文档](http://git-scm.com/docs/git-submodule)还没有包括：

> 该`.gitmodules`文件位于 git 工作树的顶级目录中，是一个文本文件，其语法与要求 -of linkgit:git-config [4](https://public-inbox.org/git/526944450904080004r1249d1b8j4a44472d72502b9c@mail.gmail.com/)匹配。
> [新]：
> 由于此文件由 Git 管理，它跟踪项目子模块的 +records。
> 此文件中存储的信息用作提示，以启动存储在项目配置文件中的记录的权威版本。
> 应该对配置文件进行用户特定的记录更改（例如，考虑到由于网络情况导致的子模块 URL 的差异），**而要传播的记录更改（例如，由于子模块源的重定位）应该对此文件进行.**

这几乎证实了[吉姆的回答](https://stackoverflow.com/questions/913701/changing-remote-repository-for-a-git-submodule/914090#914090)。

* * *

如果您遵循这个[git 子模块教程](https://git.wiki.kernel.org/index.php/GitSubmoduleTutorial)，您会看到需要一个“ `git submodule init`”来将子模块存储库 URL 添加到 .git/config。

" `git submodule sync`" 已[在 2008 年 8 月添加，](https://public-inbox.org/git/23327a679798d19dc52a27c55a58c5b8c9ebe945.1219598198.git.davvid@gmail.com/)正是为了在 URL 更改时使该任务更容易（尤其是在子模块的数量很重要的情况下）。
该命令的关联脚本非常简单：

```
module_list "$@" |
while read mode sha1 stage path
do
    name=$(module_name "$path")
    url=$(git config -f .gitmodules --get submodule."$name".url)
    if test -e "$path"/.git
    then
    (
        unset GIT_DIR
        cd "$path"
        remote=$(get_default_remote)
        say "Synchronizing submodule url for '$name'"
        git config remote."$remote".url "$url"
    )
    fi
done 
```

目标依然： **`git config remote."$remote".url "$url"`**

* * *

## 回答 #4

> 赞同：152
> 
> 时间：2017-05-12T11:48:59.843

简单来说，你只需要编辑 .gitmodules 文件，然后重新同步和更新：

通过 git 命令或直接编辑文件：

```
git config --file=.gitmodules -e 
```

要不就：

```
vim .gitmodules 
```

然后重新同步并更新：

```
git submodule sync
git submodule update --init --recursive --remote 
```

* * *

## 回答 #5

> 赞同：80
> 
> 时间：2013-10-01T21:46:14.190

什么对我有用（在 Windows 上，使用 git 版本 1.8.3.msysgit.0）：

*   使用新存储库的 URL 更新 .gitmodules
*   从“.git/config”文件中删除相应的行
*   删除“.git/modules/external”目录下的对应目录（最近的git版本为“.git/modules”）
*   删除签出的子模块目录本身（不确定是否有必要）
*   运行`git submodule init`和`git submodule update`
*   确保签出的子模块处于正确的提交位置，并提交，因为哈希可能会有所不同

完成所有这些之后，一切都处于我所期望的状态。我想存储库的其他用户在更新时也会有类似的痛苦——在你的提交消息中解释这些步骤是明智的！

* * *

## 回答 #6

> 赞同：13
> 
> 时间：2009-05-29T23:27:19.103

只需编辑您的**.git/config**文件。例如; 如果您有一个*“通用”*子模块，您可以在超级模块中执行此操作：

```
git config submodule.common.url /data/my_local_common 
```

* * *

## 回答 #7

> 赞同：3
> 
> 时间：2017-04-01T16:39:26.233

`git config --file=.gitmodules -e`打开默认编辑器，您可以在其中更新路径

* * *

## 回答 #8

> 赞同：-1
> 
> 时间：2020-12-09T08:15:38.077

蛮力方法：

*   更新`.gitmodules`超级模块中的文件以指向新的子模块 url，
*   添加并提交更改`supermodule/.gitmodules`，
*   在您计算机的其他位置创建超级模块的新克隆（确保`.gitmodules`文件的最新更改反映在克隆中），
*   将您的工作目录更改为超级模块的新克隆，
*   在子模块上运行`git submodule update --init --remote path-to-submodule`，

等等！超级模块的新克隆中的子模块配置正确！

* * *

## 回答 #9

> 赞同：-2
> 
> 时间：2021-10-05T11:48:31.390

很多人（这里和整个互联网上）都提出了需要手动编辑或删除多个文件的解决方案。但这真的不需要！

即使在 Git `2.25`（以及`git submodule set-url <path> <newurl>`.

根据 Git 版本和子模块设置，您*可能*需要`<path>`在再次添加之前手动删除。无需其他手动操作！

```
git submodule deinit <path>
rm -rf <path>
git submodule add <repository> [<path>] 
```

之后，该`.gitmodules`文件将具有不同的 URL，并且应该被提交。所有其他地方（配置、工作树）已经由 git 处理。

为了解释什么`deinit`，我想引用 Git 手册：

> **`deinit [-f|--force] (--all|[--] <path>…​)`**
> 
> 取消注册给定的子模块，即从 .git/config 中删除整个`submodule.$name` 部分及其工作树。进一步的调用 [..] 将跳过任何未注册的子模块，直到它们再次被初始化

# resin - Resin 欢迎文件不加载 servlet！

> ID：913710
> 
> 赞同：0
> 
> 时间：2009-05-27T02:38:58.590
> 
> 标签：resin

Resin (3.0.27) 是否可以将欢迎文件映射到 Servlet？

我在 Caucho 文档中找不到任何说明不支持此功能的内容。您的帮助将不胜感激。

```
<servlet-mapping>
    <servlet-name>td</servlet-name>
    <url-pattern>*.htm</url-pattern>
</servlet-mapping>

<welcome-file-list>
    <welcome-file>index.htm</welcome-file>
</welcome-file-list> 
```

编辑：如果从我的帖子中看不出来，则上述内容不起作用。:)

编辑：如果我将 index.htm 放在文件系统中，则 servlet 映射有效。就好像 Resin 找不到物理文件时终止请求一样。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-05-27T03:42:31.507

由于 caucho_module 加载其配置的方式，它很可能会忽略欢迎文件。欢迎文件映射由 servlet 容器（例如，在您的情况下为 Resin）完成。但是 caucho_module 似乎正在寻找一个存在的显式映射，以帮助它决定什么去和什么不去 Resin，以及 Apache 将尝试为自己服务什么。

也许这是 caucho_module 中的一个错误，它不考虑欢迎文件处理？

如果这是真的，那么您可以解决此问题的一种笨方法是将 Apache 的 mod_rewrite 用于您希望映射到“欢迎文件”的 URL。确实，尝试这样做很可能会证明这一点。例如，类似：

```
RewriteEngine on
RewriteRule ^/your/url/$  /your/url/index.htm [R=permanent,L] 
```

您可能想尝试以最后一个斜杠结尾和不以斜杠结尾的 URL 版本……我对 mod_rewrite 不够熟悉，不知道这是否会有所作为。无论如何，这将告诉 Apache 告诉客户端重定向（重新加载页面到）以您的欢迎页面结尾的 URL。如果这种事情解决了问题，那么 IMO 这是 cacho_module 中的一个错误。

作为测试的另一件事是直接进入 Resin——通常在端口 8888 上——绕过 Apache HTTP 以查看是否正确处理直接进入 Resin 的欢迎页面。

# java - jvm如何处理在循环内创建对象

> ID：913712
> 
> 赞同：0
> 
> 时间：2009-05-27T02:40:37.340
> 
> 标签：java, performance, jvm

```
List list = new ArrayList();

String[] test = {"ram", "mohan", "anil", "mukesh", "mittal"};

for(int i =0; i < test.length; i++)

{

  A a = new A();

  a.setName(test[i]);

  list.add(a);

} 
```

JVM 如何在每个循环中处理对象 a 的创建？“列表”如何区分不同实例？在每次迭代中创建对象是一种好习惯吗？如果不是，将对象添加到列表中的最佳解决方案是什么。

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2009-05-27T02:52:04.773

在您的示例中，循环的每次迭代都会创建一个新对象。该列表能够区分它们，因为它不在乎您在代码中将它们全部称为“a”，它通过每次调用时重新分配的引用来跟踪它们

```
a = new A(); 
```

每次调用该行代码时，都会在堆上创建一个新对象，并将其在内存中的地址分配给引用 a。列表记录的是该引用，而不是变量名。

这是填充列表的一种非常好的和正常的方式（除了其他人提到的语法错误，我假设您可以在尝试编译代码时修复）。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2009-05-27T02:43:22.950

List 包含对创建的每个实例的引用。可以在循环内创建每个对象（我假设您的意思是与在循环外声明“a”变量然后在每次迭代中重新分配它相反）。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2009-05-27T07:36:34.017

> 在每次迭代中创建一个新对象是一种好习惯吗？我的一位朋友告诉我，创建这么多实例并不是一个好习惯。

如果您需要不同的单个实例，则需要创建它们。由于您的列表需要五个具有不同名称的对象（r​​am、mohan、anil 等），因此每次循环迭代都需要一个新对象。你还打算如何存储这五个名字？

至于`a`在循环之外声明变量，我认为这不会影响性能并且还会降低易读性。

```
A a;  // dont do this
for(int i =0; i < test.length; i++){
  a = new A();
  a.setName(test[i]);
  list.add(a);
} 
```

您可能对 for-each 循环感兴趣

```
for(String name: test){
   A a = new A();
   a.setName(name);
   list.add(a); 
} 
```

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2009-05-27T07:50:13.427

如果我对 JVM 的理解是正确的，那么发布的代码与

```
for (String name : test )
{
   list.add(new A(name));
} 
```

（当然，假设构造函数 A(String s) 是另一种创建具有特定名称的新实例的方法）

# jquery - 如何让这行 jQuery 验证为严格的 XHTML

> ID：913717
> 
> 赞同：3
> 
> 时间：2009-05-27T02:44:11.437
> 
> 标签：jquery, html, xhtml-1.0-strict, xhtml

我的页面顶部有一些 jQuery（用于简单的图像轮播）：

```
$(document).ready(function(){   
    $("#slider").easySlider({
        prevText:'<div id="backarrow">Back</div>',
        nextText:'<div id="nextarrow">View Other Projects</div>',
        orientation:'horizontal'
    });
}); 
```

但是，我无法验证 XHTML 严格：

> 第 12 行，第 33 列：文档类型在此处不允许元素“div”

有任何想法吗？

* * *

## 回答 #1

> 赞同：12
> 
> 时间：2009-05-27T02:48:25.297

```
<script type="text/javascript">
/* <![CDATA[ */
$(document).ready(function(){   
    $("#slider").easySlider({
            prevText:'<div id="backarrow">Back</div>',
            nextText:'<div id="nextarrow">View Other Projects</div>',
            orientation:'horizontal'
    });
});
/* ]]> */
</script> 
```

这告诉验证器将脚本解释为字符数据，而不是标记，因此它不会解析 CDATA 块的结构。维基百科[有更多信息](http://en.wikipedia.org/wiki/CDATA)。

* * *

## 回答 #2

> 赞同：-1
> 
> 时间：2009-05-27T02:48:28.243

它与 JQuery 无关。只需在 JS 中加上注释（ceejayoz 给出的 CDATA 也应该可以）。

# objective-c - 在 Quartz 2D 中，是否可以通过删除除所需颜色通道之外的所有内容来屏蔽图像？

> ID：913719
> 
> 赞同：1
> 
> 时间：2009-05-27T02:44:18.847
> 
> 标签：objective-c, quartz-graphics, masking

所以我尝试使用 Quartz CGImageCreateWithMaskingColors 函数，但他唯一的问题是它掩盖了您选择的颜色范围。

我想屏蔽除我选择的颜色范围之外的所有内容。例如，我想在图片中显示所有红色，但删除其他通道（绿色和蓝色）。

我在 Objective-C 中这样做，我是一个菜鸟，所以请给我例子:)

任何帮助是极大的赞赏。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2009-09-28T06:55:17.427

使用这些方法。我在其中一篇 SO 帖子中找到了它们。

```
-(void)changeColor
{
    UIImage *temp23=Image;//Pass your image here
    CGImageRef ref1=[self createMask:temp23];
    const float colorMasking[6] = {1.0, 3.0, 1.0, 2.0, 2.0, 3.0};
    CGImageRef New=CGImageCreateWithMaskingColors(ref1, colorMasking);
    UIImage *resultedimage=[UIImage imageWithCGImage:New];
    EditImageView.image = resultedimage;
    [EditImageView setNeedsDisplay];
}

-(CGImageRef)createMask:(UIImage*)temp
{

    CGImageRef ref=temp.CGImage;
    int mWidth=CGImageGetWidth(ref);
    int mHeight=CGImageGetHeight(ref);
    int count=mWidth*mHeight*4;
    void *bufferdata=malloc(count);

    CGColorSpaceRef colorSpaceRef = CGColorSpaceCreateDeviceRGB();
    CGBitmapInfo bitmapInfo = kCGBitmapByteOrderDefault;
    CGColorRenderingIntent renderingIntent = kCGRenderingIntentDefault;

    CGContextRef cgctx = CGBitmapContextCreate (bufferdata,mWidth,mHeight, 8,mWidth*4, colorSpaceRef, kCGImageAlphaPremultipliedFirst); 

    CGRect rect = {0,0,mWidth,mHeight};
    CGContextDrawImage(cgctx, rect, ref); 
    bufferdata = CGBitmapContextGetData (cgctx);

    CGDataProviderRef provider = CGDataProviderCreateWithData(NULL, bufferdata, mWidth*mHeight*4, NULL);
    CGImageRef savedimageref = CGImageCreate(mWidth,mHeight, 8, 32, mWidth*4, colorSpaceRef, bitmapInfo,provider , NULL, NO, renderingIntent);
    CFRelease(colorSpaceRef);
    return savedimageref;
} 
```

然后在按钮单击事件上调用 changecolor 方法并查看结果

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2010-05-20T05:10:19.823

我找到了上述问题的答案，按照上面的 Rahul 代码进行一些更改以设置自己的颜色，

```
-(void)changeColor
{
    UIImage *temp23=Image;//Pass your image here
    CGImageRef ref1=[self createMask:temp23];
    const float colorMasking[6] = {1.0, 3.0, 1.0, 2.0, 2.0, 3.0};
    CGImageRef New=CGImageCreateWithMaskingColors(ref1, colorMasking);
    UIImage *resultedimage=[UIImage imageWithCGImage:New];
    EditImageView.image = resultedimage;
    [EditImageView setNeedsDisplay];
}

-(CGImageRef)createMask:(UIImage*)temp
{
   CGImageRef ref=temp.CGImage;
   int mWidth=CGImageGetWidth(ref);
   int mHeight=CGImageGetHeight(ref);
   int count=mWidth*mHeight*4;
   void *bufferdata=malloc(count);

   CGColorSpaceRef colorSpaceRef = CGColorSpaceCreateDeviceRGB();
   CGBitmapInfo bitmapInfo = kCGBitmapByteOrderDefault;
   CGColorRenderingIntent renderingIntent = kCGRenderingIntentDefault;

   CGContextRef cgctx = CGBitmapContextCreate (bufferdata,mWidth,mHeight, 8,mWidth*4,colorSpaceRef, kCGImageAlphaPremultipliedLast); 
   CGRect rect = {0,0,mWidth,mHeight};  
   CGContextDrawImage(cgctx, rect, ref); 
   CGContextSaveGState(cgctx);  
   CGContextSetBlendMode(cgctx, kCGBlendModeColor); 
   CGContextSetRGBFillColor (cgctx, 1.0, 0.0, 0.0, 1.0);
   CGContextFillRect(cgctx, rect);

   bufferdata = CGBitmapContextGetData (cgctx);
   const float colorMasking[6] = {1.0, 3.0, 1.0, 2.0, 2.0, 3.0};
   CGDataProviderRef provider = CGDataProviderCreateWithData(NULL, bufferdata, mWidth*mHeight*4, NULL);
   CGImageRef savedimageref = CGImageCreate(mWidth,mHeight, 8, 32, mWidth*4, colorSpaceRef, bitmapInfo,provider , NULL, NO, renderingIntent);
   CFRelease(colorSpaceRef);
   return savedimageref;
} 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2011-10-05T17:57:23.620

嗯……

我可能遗漏了一些东西，但我不相信提供的答案适用于该问题。第二个响应更接近标记，但它包含与解决方案无关的虚假代码。

该`createMask`方法制作原始图像的副本，假设 alpha 在 LSB 位置。changeColor 执行一个对 RGB 图像没有太大作用的掩码调用——基本上只有黑色会被掩码（即，(1,1,2) 到 (3, 2,1))。

我猜正在观察到的红移是由于参数

`kCGImageAlphaPremultipliedFirst`

在行中

```
CGContextRef cgctx = CGBitmapContextCreate (bufferdata,mWidth,mHeight, 8,mWidth*4, colorSpaceRef, kCGImageAlphaPremultipliedFirst); 
```

由于 alpha 通道处理不当。如果在`changeColor`方法中您修改了块

```
CGImageRef ref1=[self createMask:temp23];
const float colorMasking[6] = {1.0, 3.0, 1.0, 2.0, 2.0, 3.0};
CGImageRef New=CGImageCreateWithMaskingColors(ref1, colorMasking);
UIImage *resultedimage=[UIImage imageWithCGImage:New];
EditImageView.image = resultedimage; 
```

成为

```
CGImageRef ref1=[self createMask:temp23];
UIImage *resultedimage=[UIImage imageWithCGImage:ref];
EditImageView.image = resultedimage; 
```

你会看到显示没有区别。将 CGBitmapInfo 常量更改为`kCGImageAlphaPremultipliedLast`应该使用上述任一代码块正确显示图像。

下一个响应更接近 OP 的要求，但它是在视觉效果方面，而不是实际数据。这里的相关代码`createMask`是

```
CGContextRef cgctx = CGBitmapContextCreate (bufferdata,mWidth,mHeight, 8,mWidth*4,colorSpaceRef, kCGImageAlphaPremultipliedLast); 
```

正确显示图像，然后是

```
CGContextSetBlendMode(cgctx, kCGBlendModeColor); 
CGContextSetRGBFillColor (cgctx, 1.0, 0.0, 0.0, 1.0);
CGContextFillRect(cgctx, rect); 
```

然后是构建图像的逻辑。混合逻辑在原始图像上覆盖红色色调，实现与原始响应中放错位置的 Alpha 通道类似的效果。这仍然不是 OP 所要求的，即掩盖一个或多个通道，而不是混合颜色。

这实际上相当于将不需要的颜色的通道值设置为零。这是一个仅返回红色通道作为 OP 请求的示例；假设像素的格式是 ABGR：

```
- (CGImageRef) redChannel:(CGImageRef)image 
{
    CGDataProviderRef provider = CGImageGetDataProvider(image);
    NSMutableData* data = (id)CGDataProviderCopyData(provider);

    int width = CGImageGetWidth(image);
    int height = CGImageGetHeight(image);

    [data autorelease];

    // get a mutable reference to the image data
    uint32_t* dwords = [data mutableBytes];

    for (size_t idx = 0; idx < width*height; idx++) {
        uint32_t* pixel = &dwords[idx];
        // perform a logical AND of the pixel with a mask that zeroes out green and blue pixels
        *pixel &= 0x000000ff;
    }

    CGColorSpaceRef colorSpaceRef = CGColorSpaceCreateDeviceRGB();
    CGBitmapInfo bitmapInfo = kCGBitmapByteOrderDefault;
    CGColorRenderingIntent renderingIntent = kCGRenderingIntentDefault;

    // now create a new image using the masked original data
    CGDataProviderRef iprovider = CGDataProviderCreateWithData(NULL, dwords, width*height*4, NULL);
    CGImageRef savedimageref = CGImageCreate(width, height, 8, 32, width*4, colorSpaceRef, bitmapInfo, iprovider, NULL, NO, renderingIntent);
    CGColorSpaceRelease(colorSpaceRef);
    CGDataProviderRelease(iprovider);

    return savedimageref;
} 
```

可以在[这里](http://www.gamedev.net/page/reference/index.html/_/technical/game-programming/bitwise-operations-in-c-r1563)找到按位运算的一个很好的总结。

[正如这里](https://stackoverflow.com/questions/5487373/how-to-color-mask-in-ctp://stackoverflow.com/questions/5487373/how-to-color-mask-in-c)所指出的，您可能需要根据像素中位的 LSB/MSB 排序来更改掩码的结构。此示例假定标准 iPhone PNG 的 32 位像素。

# sql - 如果有相同的记录，我会增加数值，如果没有，则插入想要做 0

> ID：913723
> 
> 赞同：0
> 
> 时间：2009-05-27T02:45:42.713
> 
> 标签：sql, mysql

请帮我。

```
select * from hoge where id=xxx; 
```

如果有数据，我就去做，但是虽然我实现了这一步，但是程序中有if，并且insert hoge set data=0很麻烦，如果update hoge set data=data+1，结果为0线。

你可能不通过 SQL 来实现这个程序吗？将 hoge select id, data+1 替换为来自 hoge 的数据，其中 id = x; 是这个 SQL 的时候，因为在 NULL 的情况下没有输入数据所以结果不能使用。

毕竟if语句中不会有复数还是SQL的梳子？如果有更简单的方法，请教。

人们提前感谢你。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2009-05-27T03:03:09.010

如果我正确理解了这个问题（我认为 OP 不是以英语为母语的人），你可以`ON DUPLICATE KEY`在 MySQL 中使用它。

```
INSERT INTO table 
  (column1, column2, ...)
VALUES
  ('initial value for column1', 'initial value for column2', ...)
ON DUPLICATE KEY UPDATE
  column1 = column1 + 1, column2 = 'new value for column2'; 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-05-27T02:53:23.803

您似乎在问如何创建一个行，如果它不存在，或者如果它确实存在，更新其中的一个字段。

正常的方法（对于不提供某种形式的`UPSERT`语句的 DBMS）是：

```
insert into TBL(keycol,countcol) values (key,-1)
update TBL set countcol = countcol + 1 where keycol = key 
```

您需要忽略第一行上的任何错误（如果该行已经存在，则应该发生这种情况）。然后第二个语句将更新它。

最初插入零条目也是不寻常的，因为您通常在第一次添加一个“事物”时。在这种情况下，插入会将值设置为 0，而不是 -1。

# asp.net - 将数据从名称值对表中获取到 DataSet 的高效 SQL 过程？

> ID：913732
> 
> 赞同：0
> 
> 时间：2009-05-27T02:51:06.040
> 
> 标签：asp.net, sql-server, entity-attribute-value

使用 SQL Server，有一个名称值对表。每一行基本上都是userid，contentid，sectionid，parameter，value。所以有我想在表格中显示的数据，例如用户信息。每一点信息都在它自己的行中，那么我如何将它放入 DataSet 以在中继器中使用？我可以以某种方式将行合并为一个吗？所以我可以在一行上获得多个参数/值对？

像……

用户 32 的两行：

```
(param / value)
fname / Bob
lname / Smith 
```

显示在中继器的一行中，如下所示：

```
Bob Smith 
```

有任何想法吗？哦，是的，它采用名称/值对格式的原因是为了遵守所需的标准。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-05-27T03:01:31.777

也许像...

```
SELECT fff.firstname, lll.lastname
FROM (
  SELECT ff.value AS firstname
  FROM PairTable AS ff
  WHERE ff.param = 'fname'
    AND ff.userId = 32
) fff, (
  SELECT ll.value AS lastname
  FROM PairTable AS ll
  WHERE ll.param = 'lname'
    AND ll.userId = 32
) lll 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-05-27T02:55:50.023

糟糕的标准.... :)

无论如何，你最好的选择是用你的存储过程玩一些魔法（光标），并以你想要的格式从存储过程中返回数据。然后绑定到数据集或字符串列表是微不足道的。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-05-27T03:06:22.187

另一种选择是[PIVOT](http://msdn.microsoft.com/en-us/library/ms177410.aspx)。

像这样的东西（未经测试，因为我现在没有 SQL Server）

```
SELECT UserID, [fname] AS firstname, [lname] AS lastname
FROM 
(SELECT UserID, value, name from PairTable WHERE UserID=32 ) p
PIVOT
(
value
FOR name IN
( [fname], [lname] )
) AS pvt 
```

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2009-05-27T03:24:47.563

那张桌子太糟糕了。没有冒犯的意思 ;-）

关系数据库只是不能很好地处理 EAV 表。

您还可以分组并执行条件 CASE 语句 - 如下所示：

```
SELECT   UserID,
         MAX(CASE WHEN param = 'fname' THEN value ELSE '' END) AS fname,
         MAX(CASE WHEN param = 'lname' THEN value ELSE '' END) AS lname
FROM     MyEAVTable
GROUP BY UserID 
```

PIVOT 语法很棒——这个解决方案的唯一好处是它也可以与 SQL 2000 一起使用。

# .net - 接受 Drop 时如何在文本框中移动插入符号

> ID：913735
> 
> 赞同：2
> 
> 时间：2009-05-27T02:52:04.073
> 
> 标签：.net, winforms, treeview, textbox, drag-and-drop

我在 Windows 窗体的同一个窗体上有一个 TreeView 和一个多行文本框。我有拖放设置，以便我可以将节点从 TreeView 拖到文本框并将文本插入文本框（这是有效的）。

我想增强这一点，以便当鼠标在文本框上拖动时，某种指示器会在文本中移动，向用户显示文本将被插入的位置，以及当它被放置在该位置时被插入。目前我只是将文本放在 SelectionStart 处，但拖动操作不会更新 SelectionStart，因此它位于用户上次使用光标的任何位置。

这是我当前的代码：

```
 private void treeView1_ItemDrag(object sender, ItemDragEventArgs e)
    {
        if (e.Button != MouseButtons.Left)
            return;

        object item = e.Item;
        treeView1.DoDragDrop(((TreeNode)item).Tag.ToString(), DragDropEffects.Copy | DragDropEffects.Scroll);
    }

    private void textBox1_DragEnter(object sender, DragEventArgs e)
    {
        if (e.Data.GetDataPresent(DataFormats.StringFormat))
        {
            e.Effect = DragDropEffects.Copy | DragDropEffects.Scroll;
        }
        else
        {
            e.Effect = DragDropEffects.None;
        }
    }

    private void textBox1_DragDrop(object sender, DragEventArgs e)
    {
        if (e.Data.GetDataPresent(DataFormats.StringFormat))
        {
            textBox1.SelectionLength = 0;
            textBox1.SelectedText = (string)e.Data.GetData(DataFormats.StringFormat);
        }
    } 
```

* * *

## 回答 #1

> 赞同：8
> 
> 时间：2010-10-06T15:26:14.060

我在所有这些关于拖放的建议中错过的是使文本插入符号可见。最终，我发现您只需将焦点设置到控件中！所以 textBox1.DragOver 事件处理程序的最终代码如下。我已经包含了上一个答案中的 GetCaretIndexFromPoint 函数：

```
/// <summary>
/// Gives visual feedback where the dragged text will be dropped.
/// </summary>
private void textBox1_DragOver(Object sender, System.Windows.Forms.DragEventArgs e)
{
    // fake moving the text caret
    textBox1.SelectionStart = GetCaretIndexFromPoint(textBox1, e.X, e.Y);
    textBox1.SelectionLength = 0;
    // don't forget to set focus to the text box to make the caret visible!
    textBox1.Focus();
}

/// <remarks>
/// GetCharIndexFromPosition is missing one caret position, as there is one extra caret
/// position than there are characters (an extra one at the end).
/// </remarks>
private int GetCaretIndexFromPoint(System.Windows.Forms.TextBox box, int x, int y)
{
    Point realPoint = box.PointToClient(newPoint(x, y));
    int index = box.GetCharIndexFromPosition(realPoint);
    if (index == box.Text.Length - 1)
    {
        Point caretPoint = box.GetPositionFromCharIndex(index);
        if (realPoint.X > caretPoint.X)
        {
            index += 1;
        }
    }
    return index;
} 
```

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2009-05-27T03:00:52.713

我想你会想看看处理 textBox1_DragOver 事件。将 DragOver 事件参数中包含的鼠标位置传递给“textBox1.GetCharIndexFromPosition()”

您应该能够使用 char 位置来设置插入符号的位置。

这是[GetCharIndexFromPosition的文档](http://msdn.microsoft.com/en-us/library/system.windows.forms.textboxbase.getcharindexfromposition(VS.80).aspx)

* * *

## 回答 #3

> 赞同：3
> 
> 时间：2009-09-30T12:21:08.377

这实际上真的很烦人，因为 GetCharIndexFromPosition （显然）缺少一个插入符号位置，因为有一个额外的插入符号位置而不是字符数（最后一个额外的插入符号位置）。我用它来设置 DragOver 上的 SelectionStart 和 DragDrop 上的 Insert。

```
 private int GetCaretIndexFromPoint(TextBox tb, int x, int y)
    {
        Point p = tb.PointToClient(new Point(x, y));
        int i = tb.GetCharIndexFromPosition(p);
        if (i == tb.Text.Length - 1)
        {
            Point c = tb.GetPositionFromCharIndex(i);
            if (p.X > c.X)
                i++;
        }
        return i;
    } 
```

不是很完美，但它可以完成工作。如果有人找到本机版本，请告诉我:)

* * *

## 回答 #4

> 赞同：2
> 
> 时间：2013-04-05T23:58:24.673

我正在寻找此解决方案的 WPF 实现，但找不到。因此实现如下（感谢原始解决方案作者）。希望它可以帮助正在寻找 WPF 版本的人。

```
 /// <summary>
    /// Handles the Preview DragOver event to set the textbox selection at the precise place where the user dropped the dragged text
    /// </summary>
    private static void element_PreviewDragOver(object sender, DragEventArgs dragEventArgs)
    {
        TextBox textBox = sender as TextBox;
        if (textBox != null && dragEventArgs != null)
        {
            // Set the caret at the position where user ended the drag-drop operation
            Point dropPosition = dragEventArgs.GetPosition(textBox);

            textBox.SelectionStart = GetCaretIndexFromPoint(textBox, dropPosition);
            textBox.SelectionLength = 0;

            // don't forget to set focus to the text box to make the caret visible!
            textBox.Focus();
            dragEventArgs.Handled = true;
        }
    }

    /// <summary>
    /// Gets the caret index of a given point in the given textbox
    /// </summary>
    /// <param name="textBox"></param>
    /// <param name="point"></param>
    /// <returns></returns>
    private static int GetCaretIndexFromPoint(TextBox textBox, Point point)
    {
        int index = textBox.GetCharacterIndexFromPoint(point, true);

        // GetCharacterIndexFromPoint is missing one caret position, as there is one extra caret position than there are characters (an extra one at the end).
        //  We have to add that caret index if the given point is at the end of the textbox
        if (index == textBox.Text.Length - 1)
        {
            // Get the position of the character index using the bounding rectangle
            Rect caretRect = textBox.GetRectFromCharacterIndex(index);
            Point caretPoint = new Point(caretRect.X, caretRect.Y);

            if (point.X > caretPoint.X)
            {
                index += 1;
            }
        }
        return index;
    }

    /// <summary>
    /// Handler for preview drag event in a textbox
    /// </summary>
    /// <param name="sender"></param>
    /// <param name="dragEventArgs"></param>
    private static void element_PreviewDrop(object sender, DragEventArgs dragEventArgs)
    {
        TextBox textBox = sender as TextBox;
        if (textBox != null && dragEventArgs != null && dragEventArgs.Data != null && dragEventArgs.Data.GetDataPresent(DataFormats.StringFormat))
        {
            string newText = dragEventArgs.Data.GetData(DataFormats.StringFormat) as string;
            if (!string.IsNullOrEmpty(newText))
            {
                // do your custom logic here
                textBox.Focus();
            }
            dragEventArgs.Handled = true;
        }
    } 
```

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2014-01-08T02:30:32.987

要模拟常用工具（如记事本）的行为，GetCaretIndexFromPoint() 函数必须同时检查 X 和 Y 坐标。

```
/// <summary>
/// Gives visual feedback where the dragged text will be dropped.
/// </summary>
private void textBox1_DragOver(Object sender, System.Windows.Forms.DragEventArgs e)
{
    // fake moving the text caret
    textBox1.SelectionStart = GetCaretIndexFromPoint(textBox1, e.X, e.Y);
    textBox1.SelectionLength = 0;
    // don't forget to set focus to the text box to make the caret visible!
    textBox1.Focus();
}

/// <remarks>
/// GetCharIndexFromPosition is missing one caret position, as there is one extra caret
/// position than there are characters (an extra one at the end).
/// </remarks>
private int GetCaretIndexFromPoint(System.Windows.Forms.TextBox box, int x, int y)
{
    Point realPoint = box.PointToClient(new Point(x, y));
    int index = box.GetCharIndexFromPosition(realPoint);
    if (index == box.Text.Length - 1)
    {
        Point caretPoint = box.GetPositionFromCharIndex(index);
        if ((realPoint.X > caretPoint.X) || (realPoint.Y > caretPoint.y))
        {
            index += 1;
        }
    }
    return index;
} 
```

如果文本框中的最后一个字符是一行文本之后的新行，并且您将文本放在 caretPoint 的下方和左侧，而不是 caretPoint 的下方和右侧，您可以看到差异。

感谢 user468106 的出色回答！

# c++ - Windows Mobile 中的 _CrtDbgReportW 输出在哪里？

> ID：913738
> 
> 赞同：1
> 
> 时间：2009-05-27T02:52:53.430
> 
> 标签：c++, c, windows-mobile, msvcrt

我正在使用 ASSERTE 宏来检查前置条件。根据它的定义，它使用 ASSERT_BASE，然后调用 _CrtDbgReportW 来打印消息。_CrtDbgReportW 输出到哪里？

我假设如果应用程序是从调试器启动的，它将进入调试器窗口。如果不在调试器下，消息会去哪里？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-05-27T03:42:03.737

[_CrtDbgReportW](http://msdn.microsoft.com/en-us/library/8hyw4sy7(VS.80).aspx)的输出取决于您的设置方式。默认情况下，它会将其发送到[OutputDebugString](http://msdn.microsoft.com/en-us/library/aa363362.aspx) API。

调试器捕获 OutputDebugString 输出，并通常按照您的建议将它们显示在调试器窗口中。

还有一些应用程序可以捕获输出，例如可用于 PC 应用程序的[DebugView 。](http://technet.microsoft.com/en-us/sysinternals/bb896647.aspx)

更新：我错过了 Windows Mobile 位。我仍然相信它是输出到 OutputDebugString 但我不知道有任何第三方应用程序可以工作。我知道在 Windows Mobile 下捕获 OutputDebugString 输出的唯一方法是使用[调试函数](http://msdn.microsoft.com/en-us/library/aa909241.aspx) [DebugActiveProcess](http://msdn.microsoft.com/en-us/library/aa908990.aspxvv) / [WaitForDebugEvent](http://msdn.microsoft.com/en-us/library/aa911511.aspx)捕获 OUTPUT_DEBUG_STRING_EVENT 事件并将它们写出某处。

# cocoa - 将 NSArrayController 中项目的属性的聚合设置为依赖键

> ID：913743
> 
> 赞同：2
> 
> 时间：2009-05-27T02:57:03.330
> 
> 标签：cocoa, data-binding, binding

假设我有一个 NSArrayController ，其中包含每个具有 netCost 和 netProfit 属性的项目，我想创建一个 Total Percent Profit 标签（包含利润总和除以成本总和）。

在引用数组控制器的控制器类中，我尝试按如下方式执行此操作：

```
+ (NSSet *)keyPathsForValuesAffectingTotalPercentProfit {
    return [NSSet setWithObjects:
            @"myArrayController.arrangedObjects.@sum.netProfit", 
            @"myArrayController.arrangedObjects.@sum.netCost", 
            nil];
}

- (NSDecimalNumber *)totalPercentProfit {
    NSDecimalNumber *totalProfit = [self valueForKeyPath:@"myArrayController.arrangedObjects.@sum.netProfit"];
    NSDecimalNumber *totalCost = [self valueForKeyPath:@"myArrayController.arrangedObjects.@sum.netCost"];
    if (!([totalCost compare:[NSDecimalNumber zero]] == NSOrderedSame)) {
        return [totalProfit decimalNumberByDividingBy:totalCost];
    } else {
        return nil;
    }
} 
```

然而，当依赖键路径更改时，绑定到此 totalPercentProfit 属性的标签不会刷新。

有人能指出我解决这个问题的正确方向吗？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-05-27T04:02:23.110

学习 KVO 编程指南，[注册依赖键](http://developer.apple.com/documentation/Cocoa/Conceptual/KeyValueObserving/Concepts/DependentKeys.html#//apple_ref/doc/uid/20002179)。你不能以这种方式观察到多关系，你也绝对不能以这种方式观察聚合。阅读“Mac OS X v10.4 和 Mac OS X v10.5 上的多对多关系”部分。

# tcl - 将 zlib 与 ActiveTcl 8.5 连接？

> ID：913745
> 
> 赞同：1
> 
> 时间：2009-05-27T02:58:49.970
> 
> 标签：tcl, zlib, activetcl

我正在尝试使用 ActiveTcl 8.5 中的 zlib 扩展，以便将压缩的 blob 保存到文件中。win32 上的 ActiveTcl 8.5.5 和 8.5.6 都有一个 zlibtcl 1.2.3 扩展。我都试过了：

```
package require zlibtcl 
```

和

```
load zlibtcl123.dll 
```

这两者似乎都表明扩展已正确加载。但是，我似乎无法弄清楚访问扩展需要什么命令。我知道 ActiveTcl 8.6b1 及更高版本具有内置的 zlib 功能（[http://wiki.tcl.tk/4610](http://wiki.tcl.tk/4610)），但是我需要部署到必须使用 8.5.x 的现有系统。

据我所知，加载扩展不会向解释器添加任何新命令，这很令人困惑。在 dll 上运行**字符串**似乎不会显示任何其他信息。

注意：我的备份计划是 SWIG zlib，但如果可能的话，我更喜欢使用现有的扩展。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-05-27T10:42:54.030

您可能对 vfs::zip 包有更多的运气。[这里](http://groups.google.com/group/comp.lang.tcl/tree/browse_frm/thread/2a9317f4aeb26920/6ba43633b72df121?rnum=1&q=lemburg&_done=%2Fgroup%2Fcomp.lang.tcl%2Fbrowse_frm%2Fthread%2F2a9317f4aeb26920%2F33cecc0122085ae7%3Flnk%3Dgst%26q%3Dlemburg%26#doc_33cecc0122085ae7)有一个关于 comp.lang.tcl 的例子。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2010-09-17T12:19:56.437

您可以从[equi4](http://www.equi4.com/pub/tk/tars/zlib.tar.gz)获得 zlib 包的副本，它作为对`tclkit`Tcl 解释器/打包系统的支持的一部分提供。它不支持 8.6 中使用的完整接口，但它确实足够你可以压缩和解压缩。

或者你可以使用`tclkit`而不是`tclsh`/`wish`并且已经内置了 zlib 包。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2009-06-19T21:50:40.523

zlibtcl 仅由 Img 包用于处理 PNG 等图像格式的压缩。如上所述，尝试 vfs::zip。Trf 包也值得研究。见[http://wiki.tcl.tk/479](http://wiki.tcl.tk/479)

# bdd - 使用 xUnit.NET 的 BDD、规范和“规范报告”？

> ID：913751
> 
> 赞同：1
> 
> 时间：2009-05-27T03:01:18.373
> 
> 标签：bdd, specifications, xunit.net

我是软件开发和“规范”的 BDD 方法的新的但超级粉丝。我一直在使用[xUnit.NET](http://www.codeplex.com/xunit)、[Moq](http://code.google.com/p/moq/)和[xUnit.NET 的扩展，](http://iridescence.no/post/Extending-xUnit-with-a-Custom-ObservationAttribute-for-BDD-Style-Testing.aspx)它允许我执行 BDD 样式的测试（我正在松散地使用测试，因为它并不是真正的测试，因为它指定了预期的行为） . 目前，我使用 ReSharper 运行我的所有测试，很高兴看到我的规格详细说明并且全面绿色。

然而，既然我定期使用 BDD 方法，我想要一个更好的报告解决方案，它可以以一种很好的格式呈现系统的所有规范，可以作为新开发人员的一种文档形式引用，在未来的重构等

有谁知道任何现有的工具，最好是免费的，可以与 xUnit.NET 集成以提供格式良好的报告？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-08-02T18:01:20.290

您可以使用 Björn Rochel 的[xUnit BDD Extensions](https://github.com/chadly/xUnit-BDD-Extensions)。它们[包括一个报告生成器](http://www.bjoernrochel.de/2009/07/05/dude-i-can-do-reports)。

马蒂亚斯

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-12-31T17:31:41.233

看起来像 MSpec，它有一个不错的报告，[从 7 月开始](http://elegantcode.com/2009/07/05/mspec-take-2/)支持 xUnit 。

# javascript - 将信息从 JS 传递到 ASP 服务器端

> ID：913761
> 
> 赞同：0
> 
> 时间：2009-05-27T03:08:29.640
> 
> 标签：javascript, asp.net, ajax, postback

我一直在尝试以某种方式让我的 javascript 函数（我在 aspx 页面的 head 部分中）在隐藏项中设置一个值，然后服务器端（值得信赖的 'ol ASP）如何读取该数据所以我可以根据它的内容做一些工作。我的整个页面都包含在一个更新面板中，并且我的拖放问题已基本解决。理想的情况是拥有它，因此一旦对象被拖放到拖放区，javascript 代码块（我很讨厌 JS）将为隐藏字段分配一个值，然后让更新面板执行其异步回发之一并刷新自身（这将从基于隐藏值运行的函数中提取数据）。这是我当前（损坏的）javascript部分的内容：

```
<script type="text/javascript">  
  $(document).ready(function() {  
doReady();  

var prm = Sys.WebForms.PageRequestManager.getInstance();  
prm.add_endRequest(function(s, e) {  
    doReady();  
});  
}); 
```

以上所有内容都使得JQuery在回发后不会自行解决

```
function doReady() {

$('.drag').draggable({ revert: true, helper: 'clone' });
$('.drop').droppable({
    tolerance: "touch", // Here should be a string
    drop: function() {

        $('#myHidden').val('Testy test test');
        __doPostBack('<%= HiddenButton.UniqueID  %>', '');
        alert(#myHidden.val);

    }

});

} // End of do ready
</script> 
```

这里是相关的 ASPX 部分，它有那个神秘的“myHidden”东西。

```
<input type="hidden" id="myHidden" />
<asp:Button ID="HiddenButton" runat="server" Text="Button" /> 
```

我在我的 javascript 部分做错了什么，还是我对这个 fubar 的整个概念？

谢谢！账单

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2009-05-27T03:51:59.173

如果您想要回发隐藏的输入，您需要提供名称和 id。只有带有名称的输入与发布的表单一起发送。您可能希望将其设为 asp:HiddenField 以便您可以轻松地在服务器端检索它的值，尽管您也可以从 Request.Form 集合中获取它。

```
<asp:HiddenField runat="server" id="myHidden" /> 
```

将您的 javascript 更改为：

```
drop: function() {

    $('[id$="myHidden"]').val('Testy test test');
    __doPostBack('<%= HiddenButton.UniqueID  %>', '');
    alert($('[id$="myHidden"]').val());

} 
```

# java - 如何在 Java 中将表格数据格式化为文本？

> ID：913765
> 
> 赞同：6
> 
> 时间：2009-05-27T03:10:35.143
> 
> 标签：java, text, formatting

我想从任意数据集对象模型中生成格式良好的表格文本。在 Java 中是否有一个很好的库可以做到这一点？

具体来说，我想要的输出格式类似于命令行数据管理工具，例如 mysql 的 CLI。例子：

```
+---------+--------------+------+-----+---------+-------+
| Field   | Type         | Null | Key | Default | Extra |
+---------+--------------+------+-----+---------+-------+
| name    | varchar(100) | YES  |     | NULL    |       |
| release | year(4)      | YES  |     | NULL    |       |
| studio  | varchar(50)  | YES  |     | NULL    |       |
| review  | varchar(50)  | YES  |     | NULL    |       |
| gross   | int(11)      | YES  |     | NULL    |       |
+---------+--------------+------+-----+---------+-------+ 
```

一个主要挑战是在开始遍历数据之前我不会自动知道最大列宽。此外，还有很多边缘情况，例如处理非常大的值长度和大量的行和列。

如果我必须自己构建它，我想我会使用 String.format，并且我需要在开始输出之前预先分析完整的数据集。不过，这是一个非常低级的编码，所以我很想找到一个已经解决了这个问题的好库。

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2009-05-27T03:26:51.833

查看[TableFormatter](https://github.com/iNamik/Java-Text-Table-Formatter)：它似乎可以执行您想要格式化表格数据的操作。源代码也可用。您可以使用流畅的界面方法将行和单元格附加到表中。一个例子如下：

```
TableFormatter tf = new SimpleTableFormatter(true) // true = show border
        .nextRow()
            .nextCell()
                .addLine("Field")
            .nextCell()
                .addLine("Type") 
```

因此它将以正确的格式构建单元格并相应地调整空格。它还允许您对单元格内的文本进行基本对齐（中心、顶部、底部）

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2010-01-19T13:07:45.823

trac.inamik.com/trac/jtable_format 受 GPL 许可，在某些情况下不适用。

另一种选择（Apache 2 许可证）：

[http://sourceforge.net/projects/texttablefmt/](http://sourceforge.net/projects/texttablefmt/)

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2013-06-07T08:48:05.137

对于那些感兴趣的人，[我已经分叉了 TableFormatter](https://github.com/assylias/Java-Text-Table-Formatter)（它是双重许可 GPL 和 MIT）以使其对泛型友好并删除所有编译警告。

请注意，我使用 Java 7 菱形运算符，因此要使其与 Java 6 兼容，需要在列表声明中添加类型。

# open-source - 如何处理死掉的开源依赖？

> ID：913767
> 
> 赞同：6
> 
> 时间：2009-05-27T03:11:13.377
> 
> 标签：open-source, binary, distribution, software-distribution

我正在尝试为开源版本准备一个项目，但遇到了一个问题……这个项目依赖于一些开源组件，迄今为止我刚刚将它们作为 JAR 文件存储在我的 lib 目录中。其中一些可以追溯到几年前，至少其中一些来自一个开源项目，该项目的站点已经消失，我无法找到其源代码（Radeox 库）。

我的困境是我不知道在发布项目时如何打包我的项目......我不应该包含没有源代码的 JAR 文件，因为这会违反我自己使用代码的许可条款，但是我不认为这个 JAR 文件很容易找到，所以我也不想有一个 README 说“找到这个 JAR，祝你好运！”。

在这种情况下，最佳做法是什么？（除了“保留从现在开始导入的所有 JAR 的源代码！）其次，有人知道我在哪里可以找到这个特定库的源代码吗？

谢谢！

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2009-05-27T03:29:49.237

如果许可证说您必须包含源代码，那么您必须包含源代码。

尝试联系原作者。也许[这个 Ohloh 链接](https://www.ohloh.net/p/5565/stacks)会有所帮助。如果您无法联系到他们，也许您可​​以从另一个使用该库的项目中获取源代码的副本。作为最后的手段，你可以试试[谷歌的缓存](http://google.com/search?q=site:www.radeox.org%20%22package+org.radeox%22%20filetype:java)或archive.org。

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2009-05-27T04:35:56.910

**更新：宾果！！**

这是 Radeox [Subversion 存储库](http://svn.codehaus.org/radeox/)。向下导航到[http://svn.codehaus.org/radeox/main/trunk/src/java/org/radeox/](http://svn.codehaus.org/radeox/main/trunk/src/java/org/radeox/)以获取源代码。

**早些时候...**

看起来，作者 Stephan Schmidt 目前正在[http://www.codemonkeyism.com](http://www.codemonkeyism.com)上运行一个博客。他的联系信息，包括电子邮件在[这里](http://www.codemonkeyism.com/about/)，[2007 年 8 月](http://www.codemonkeyism.com/archives/2007/08/20/forking-radeox-a-new-wiki-render-engine/)的一篇文章谈到了将项目分叉到 Reposita.org（似乎还没有启动）。他的[演讲](http://www.codemonkeyism.com/my-presentations/)让他去年参加了 ImobilienScout24。

我敢肯定，你已经意识到依赖一个死的、无人维护的项目的危险。我们刚刚清除了我们的软件中的几个这样的依赖项，并且睡得更好了。它们包括用于 SOAP Web 服务的 Axis 1.4（在 2005 年因严重的线程错误而被放弃），被普通 Java 逻辑所取代；kxml 解析器（也于 2005 年废弃），被 JAXP 取代；和一个没有名字的 HTTP 客户端（被遗弃了，我们甚至找不到旧的源代码），被 Apache HTTP 客户端取代。不过，Radeox 听起来像是一个更困难的案例。

获得法律建议，努力寻找来源和/或斯蒂芬，记录你所做的一切。这可能足以让您在制定替换策略时分发二进制文件。

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2009-05-27T04:54:38.073

我们的方法是确保在获取二进制文件时获取源。然后，由于您引用的确切原因，我们将所有第三方依赖项永久存档在本地。这有点痛苦，因为使用第三方库比简单地下载 tarball 并运行要复杂一些，但这意味着当一个库被弃用时，我们可以继续履行我们的客户义务和我们的法律义务.

请注意，我们目前维护的软件已经有将近 15 年的历史了，而且我们的一些第三方软件包早于流行的网络，因此我们的解决方案可能对您来说太过分了。

还有其他优点；我们不得不修补其中一些产品来修复错误或添加上游维护者无法或不愿意添加的功能，但我们需要这些功能，并且可以无缝地融入这个过程。

# optimization - 包含的绝对 URL 中是否有额外的开销？

> ID：913769
> 
> 赞同：0
> 
> 时间：2009-05-27T03:13:55.260
> 
> 标签：optimization, include

我有一种情况，看起来最简单的解决方案是将相对路径转换为包含文件（如 CSS 和 Javascript）的绝对路径。每页总共包含大约 10 个包含文件 - 大多数页面上几乎相同的 10 个。

我想知道这样做是否会产生任何重大开销（或者实际上是不利的，而不是便携性）？这是专用服务器上的 LAMP 设置，所有内容都通过 https 运行。

编辑：澄清一下，我的意思是从“../foo.css”到“ [https://bar.com/foo.css](https://bar.com/foo.css) ”。

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2009-05-27T03:16:43.413

唯一的额外开销是它们会稍微大一些（因此使包含它们的页面变得更大）。除非您每页有大量 URL，否则这种差异应该可以忽略不计。

也就是说：当对性能有疑问时，最好的办法就是衡量它。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-05-27T03:21:14.840

我认为将路径从相对更改为绝对不会对性能产生重大影响。

我的建议是尝试将您的 CSS 文件组合在一起，形成一个 CSS 文档，对于 JS 文件也是如此。

这样，您的网站性能将得到优化，因为您只需向服务器发出 2 个 HTTP 请求（对于 CSS 和 JS 文件，不包括页面上的图像和其他元素）（一个用于 CSS 文件，一个用于 JS文件）而不是您当前制作的 10 个。

我只能认为维护站点的个人的性能会受到阻碍：与相对 URL 相比，绝对 URL 的维护是一种痛苦

我刚找到这个资源，似乎他们没有看到这两种 URL 对性能的影响：http: [//good.ly/wj3cfe](http://good.ly/wj3cfe)

# wordpress - 如何防止通过ip访问WordPress博客？

> ID：913773
> 
> 赞同：0
> 
> 时间：2009-05-27T03:15:49.983
> 
> 标签：wordpress, .htaccess

我遇到了问题，因为某个 IP 地址的某些计算机正试图访问我服务器上的所有文件。

我应该如何更改`.htaccess`文件以使 IP 地址根本无法访问任何文件？我要更改哪个`.htaccess`文件？看起来我每个文件夹里都有一个。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2009-05-27T03:19:09.760

基本的 mod_access 模块应该可以满足您的需求

```
Order allow,deny
Allow from all
Deny from xxx.xxx.xxx.xxx 
```

类似的东西。我不知道确切的语法。请记住，根据您的 Apache 的确切版本（1.3/2.0/2.2），模块要求可能会有所不同。我认为在 2.2 中您需要 authz_host 模块，但在 1.3 中需要它的 mod_access。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-05-27T03:22:42.840

对于简单的情况，您可以尝试[http://wordpress.org/extend/plugins/wp-ban/](http://wordpress.org/extend/plugins/wp-ban/)，它可以阻止 IP 或 IP 范围访问您的博客。

如果这还不够，您可以修改 .htaccess 如下

> 拒绝来自 xx.xx.xx.xx/xx
> 
> 全部允许

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2009-05-27T03:23:29.827

另一种方式，这次在文件中使用`mod_rewrite`规则。`.htaccess`

```
RewriteEngine on
RewriteCond %{HTTP_HOST} ^123.123.123.123$
RewriteRule ^(.*)$ blocked.html [L,F] 
```

`[L,F]`表示“停止执行进一步的规则，并`403 Forbidden`以 HTTP 状态返回”。`blocked.html`可能包含一条消息，表明它们已被阻止。

# xcode - 在 xcode 中保留包含路径

> ID：913782
> 
> 赞同：2
> 
> 时间：2009-05-27T03:19:15.593
> 
> 标签：xcode, header

我将头文件分隔在以下文件夹中：

```
libraryA
  |-libA1.h
  |-libA2.h

libraryB
  |-libB1.h
  |-libB2.h 
```

然而，Xcode 默认会删除路径，所以

```
#include "libraryA/libA1.h"
#include "libraryB/libB1.h" 
```

不起作用，只有：

```
#include "libA1.h"
#include "libB1.h" 
```

如何让 xcode 保留包含的路径名？

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2009-05-27T03:33:05.347

在目标的构建窗格中，将 Header Search Paths 设置为 $(SRCROOT)（假设它们位于顶层）或 $(SRCROOT)/include 或任何匹配项。为了简单起见，我只建议在此处使用构建窗格。我实际上[建议](http://robnapier.net/blog/build-system-1-build-panel-360)人们放弃构建窗格并使用 xcconfig 文件，在这种情况下，设置为 HEADER_SEARCH_PATHS。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-05-27T03:20:54.653

Xcode 文件列表中的组不一定与磁盘上的文件夹相对应。如果您真的希望它们以这种方式工作，您需要在源代码树中创建文件夹，将标题移到那里，然后在 Xcode 中获取有关文件组的信息并将它们指向新文件夹。

# powershell - Powershell太聪明了

> ID：913788
> 
> 赞同：7
> 
> 时间：2009-05-27T03:20:55.793
> 
> 标签：powershell

为可能是一个新问题的问题道歉。

我正在编写一些针对 AD 运行各种查询的 Powershell 脚本。他们通常会返回一堆结果，这些结果很容易处理，即：

```
$results = myQuery
write-host "Returned " + $results.Count + " results."
foreach ($result in $results) { doSomething } 
```

不用担心。但是，如果只有 1 个结果，Powershell 会自动将该结果转换为单个对象，而不是包含 1 个对象的数组。所以上面的代码会在 Count 和 foreach 处中断。我确信同样的问题会发生在 0 个结果中。

有人可以提出一种优雅的方式来处理这个问题吗？也许某种方式来转换结果，所以它们总是一个数组？

* * *

## 回答 #1

> 赞同：11
> 
> 时间：2009-05-27T03:31:47.953

将第一行代码更改为

```
$results = @(myQuery) 
```

这将始终返回一个数组。有关其他详细信息，请参阅[此博客条目](http://blogs.msdn.com/powershell/archive/2007/01/23/array-literals-in-powershell.aspx)。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-05-28T22:38:21.247

实际上，foreach 工作得很好。foreach 的所有使用（foreach 关键字、Foreach-Object cmdlet 和 Foreach-Object 的别名“foreach”和“%”）都具有相同的行为，即在需要时将相关对象“包装”在一个数组中。因此，foreach 的所有用法都适用于标量和数组值。

令人讨厌的是，这意味着它们也可以使用空值。说我同意：

```
$x = $null
foreach ($y in $x) {Write-Host "Hello world 1"}
$x | Foreach-Object {Write-Host "Hello world 2"} 
```

我去拿

```
"Hello world 1"
"Hello world 2" 
```

从中。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-05-27T03:31:11.577

这也咬了我。没有关于如何修复的聪明想法`$results.Count`，但可以通过切换到管道来修复 foreach。

```
$scalar = 1
$list = (1,2)
$list | % { $_ } 
```

打印 1 2

```
$scalar | % { $_ } 
```

打印 1

# scripting - 是否有清理 script(1) 工具输出的工具？

> ID：913791
> 
> 赞同：1
> 
> 时间：2009-05-27T03:22:07.677
> 
> 标签：scripting, text-processing, terminfo

`script(1)`是用于记录交互式终端会话的工具；默认情况下它写入文件`transcript`。我的问题是我使用`ksh93`具有 readline 功能的 ，因此脚本被各种终端转义序列弄乱了，重建实际执行的命令可能非常困难。更不用说流浪`^M`者之类的了。

我正在寻找一种工具，它可以读取由 编写的脚本文件`script`，删除所有垃圾，并重建 shell 认为它正在执行的内容，所以我有一些东西可以显示`$PS1`和实际执行的命令。如果做不到这一点，我正在寻找关于如何编写这样一个工具的建议，最好是使用 terminfo 数据库中的知识，或者如果做不到，只使用 ANSI 转义序列。

一个查看 shell 历史的作弊，只要它真的有效，也是可以接受的。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-06-20T22:10:50.920

cat/more 默认情况下不能用于浏览成绩单吗？您是否打算根据实际执行的命令创建一个脚本（根据我的经验，这可能很危险）？

无论如何，3年没有答案，所以我会尝试一个不完整的解决方案。如果您只对实际键入的命令感兴趣，请删除不可打印的字符，然后将 PS1' 替换为可读且唯一的内容，然后用 grep 查找该唯一字符串。像这样：

```
$ sed -i 's/[^[:print:]]//g' transcript

$ sed 's/]0;cartman@southpark: ~cartman@southpark:~/CARTMAN/g' transcript | grep CARTMAN 
```

说明：在第一次 sed 之后，PS1' 可以从脚本文件的前几行之一中获取，因为 -- PS1' 与 PS1 不同 -- 并且可以使用唯一的可读字符串进行修改（此处为“CARTMAN”） . 请注意，提示末尾的美元符号是故意省略的。

在我尝试的几个示例中，这并没有解决所有问题，但解决了大多数问题。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2015-02-25T21:51:44.783

这基本上与最近在[我可以使用 unix utils 以编程方式将 ANSI 控制代码“烧入”到文件中提出的问题相同吗？](https://stackoverflow.com/questions/28269278/can-i-programmatically-burn-in-ansi-control-codes-to-a-file-using-unix-utils/28334291#28334291)-- 删除所有非打印字符不会修复

*   嵌入式转义序列
*   退格/强调下划线
*   使用回车符进行过度罢工

# php - 为什么 html 标签出现在我的 PHP 字符串中？

> ID：913793
> 
> 赞同：2
> 
> 时间：2009-05-27T03:22:37.613
> 
> 标签：php, email, header, html-email

我正在使用一个邮件函数，它发送回包含在变量 $body 中的消息。我想用某些粗体字和一些中断标签向自己发送消息。

这是我的代码（HEREDOC 语法）：

```
$body = <<<CTS
<h1><b>Order for $name on datevariable</b></h1><br /><br />

<b><u>Administrative Details</u></b><br />
<b>Employee ID:</b> $id<br />
<b>Cost Center:</b> $cost_center<br />
<b>Approved By:</b> $approved_by<br />
<b>Delivery Bldg:</b> $delivery_bldg<br />
<b>Delivery Contact Email:</b> $delivery_contact<br />
<b>Ext:</b> $del_contact_ext<br />
CTS; 
```

出于某种原因，当我收到电子邮件时，它看起来像这样：

```
<h1><b>Order for James Important on datevariable</b></h1><br /><br />
<b><u>Administrative Details</u></b><br />
<b>Employee ID:</b> 213123<br />
<b>Cost Center:</b> 132123<br />
<b>Approved By:</b> Chris Seckla<br />
<b>Delivery Bldg:</b> 6<br />
<b>Delivery Contact Email:</b> test@email.com<br />
<b>Ext:</b> 56<br /> 
```

它填充变量值，但由于某种原因忽略了 html 标记。有人可以告诉我如何解决这个问题吗？

此外，它忽略了中断标签，仅在我留下一行空白时才放置中断。对此有什么想法吗？

* * *

## 回答 #1

> 赞同：16
> 
> 时间：2009-05-27T03:25:19.467

如果这是一封电子邮件，您必须将 mime 类型设置为 text/html 而不是 text/plain。否则，您的电子邮件阅读器会将消息解释为纯文本并忽略所有 html 标签。

例如，假设您正在调用这样的`mail`函数：

```
mail( $to, $subject, $message, $headers ) 
```

在`$headers`中，您需要一些类似的东西（当然，根据您的特定情况进行调整）：

```
$headers = "From: webmaster@example.com\r\n";
$headers .= "Reply-To: webmaster@example.com\r\n";
$headers .= "Content-Type: text/html"; 
```

如果您想发送纯文本和 html 电子邮件（因此非 html 读者可以看到没有所有这些标签的电子邮件的干净版本），我建议您查看[本](http://www.webcheatsheet.com/PHP/send_email_text_html_attachment.php)教程以获取有关多部分电子邮件的更详细说明。

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2009-05-27T03:25:07.233

从 php 发送电子邮件时，您必须设置一个额外的标题才能使用 html 格式显示：

内容类型：文本/html；字符集=随便

* * *

## 回答 #3

> 赞同：3
> 
> 时间：2009-05-27T03:27:20.303

确保您发送标明它是 HTML 的标头...

例子：

```
mail('email@domain.com', 'Subject',
'<html><body><b>Hello</b></body></html>',
"To: The Receiver <recipient@domain.com>\n" .
"From: The Sender <email@domain.com>\n" .
"MIME-Version: 1.0\n" .
"Content-type: text/html; charset=iso-8859-1"); 
```

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2009-05-27T14:22:43.493

如果您想使用 PHP 发送邮件，我建议您使用 PEAR Mail_Mime 包而不是普通邮件功能

# upload - 上传用户画像的最佳方式是什么

> ID：913795
> 
> 赞同：0
> 
> 时间：2009-05-27T03:23:26.693
> 
> 标签：upload, avatar

存储在数据库或文件系统中？

我需要几种不同的尺寸。如 128*128、96*96、64*64 等。

上传用户画像的最佳方式是什么？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-05-27T03:27:06.483

不知道您的所有限制，我会上传 128x128 图片，然后即时创建所有其他肖像。

我认为您不必担心将图像存储在数据库中，特别是如果您正在运行 SQLServer 2008（并且您使用新的 FILESTREAM 类型）。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-05-27T03:58:49.377

绝对取决于您需要存储的图像数量。

如果将它们存储在文件系统中，则只需将图像的 URL 或位置保留在数据库中。要更改大小，您可以使用组件实时更改大小，以根据您使用的语言实现更改。对于 .NET [ASPjpeg](http://www.aspjpeg.com/)是一个非常好的方法，但是您可以使用 System.Drawing.Imaging 类来操作图像。无需操作数据库文件流或 BLOB 字段。

另一方面，将图像存储在数据库中可能会使其太大，以便根据记录的数量进行备份或下载，即使您使用的是 SQL 服务器，但您将所有内容都放在同一个地方。维护速度更快。

将图像存储在文件系统中的问题是清理过程，如果删除记录，则需要将文件系统中的图像也删除，以防止留下垃圾。

# opengl - glTexImage2D 函数中的边框是什么意思？

> ID：913801
> 
> 赞同：3
> 
> 时间：2009-05-27T03:24:23.820
> 
> 标签：opengl, border, glteximage2d

的`border`价值是`glTexImage2D`多少？它是 0 或 1。它决定这个纹理是否有边框？

值在哪里`border`设置？

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2009-06-01T05:02:34.747

是的，边框值表示纹理是否有边框。

`glTexParameter()`边框的颜色是通过使用参数调用来定义的`GL_TEXTURE_BORDER_COLOR`。默认情况下，它是黑色的。

请注意，边框颜色仅在使用钳制（`GL_CLAMP`和类似）映射纹理时使用 - 边框对于重复图案没有意义，并且当线性插值用于纹理数据（`GL_LINEAR`和类似）时。

另请注意，OpenGL 的 OpenGL ES 变体（用于嵌入式系统）不支持纹理边框。

# apache - 对服务器和 VPS 与专用服务器进行压力测试

> ID：913805
> 
> 赞同：1
> 
> 时间：2009-05-27T03:25:25.563
> 
> 标签：apache, sysadmin

我们曾经有一个专用服务器 (1&1)，并且很少遇到服务器有问题的问题。

最近，我们迁移到了与旧专用服务器具有相似规格的 VPS (Wiredtree.com)，但注意到内存不足、mysql 必须重新启动等常见问题......正常使用。

正因为如此，我们正在考虑迁移到另一个 VPS——这次是在 Slicehost，看看它是否表现更好。

我的问题有两个...

他们的直接方法是我们可以在 Slicehost 上对 VPS 进行压力测试，看看是否会发生相同的问题，而无需实际迁移所有内容吗？

此外，我们面临的问题是否可能不仅仅是因为提供商（Wiredtree），而只是因为专用盒子和 VPS 之间的差异（尽管具有相似的规格）？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2009-06-05T20:01:27.193

对环境进行压力测试的最佳方法是将其置于负载下。如果此 VPS 托管 Web 应用程序，请使用众多可用的 Web 服务器基准测试工具之一：[ab](http://httpd.apache.org/docs/2.2/programs/ab.html)、[httperf](http://www.hpl.hp.com/research/linux/httperf/)、[Siege](http://www.joedog.org/index/siege-home)或[http_load](http://acme.com/software/http_load/)。您不必太在意工具本身的统计信息，但更多的是它在服务器上施加了可预测的负载，以便您可以调整 Apache 来处理它，或者至少不会崩溃和烧毁。

对 Slicehost 进行测试时遇到的一个问题是，您受制于 Internet 和 Slicehost 的带宽。您可能无法在服务器上施加足够的负载来得出有意义的结论。

相反，您可能会发现运行市场上众多虚拟化产品之一并设置与您正在考虑的 VPS 计划具有可比性的 VM 一样有价值。在您的 LAN 上进行本地测试将允许您在服务器上施加更高且更可预测的负载。

在任何一种情况下，您都不需要迁移所有内容，但您需要为您的应用程序设置一个运行环境，并在您的数据库中包含代表性数据。

与专用服务器具有相似规格的 VPS 的性能应该大致相同，但为了获得良好的性能，您仍然需要调整 Apache、MySQL 和任何其他长期存在的服务器进程。根据我的经验，许多 Linux 发行版中 Apache 的开箱即用配置并不理想，并且会允许过多的子进程、过度使用内存并使服务器陷入交换死亡螺旋。

# floating-point - Fortran 实数表达式中的后缀“d+0”

> ID：913816
> 
> 赞同：3
> 
> 时间：2009-05-27T03:31:56.520
> 
> 标签：floating-point, fortran, notation, double-precision

有谁知道后缀“ **d+0** ”在下面 M1、M2 和 M4 的作业中是什么意思，或者在网络或书籍上有什么资源很可能找到这些信息吗？

* * *

```
 subroutine plot( t, x, p, q, nga, nt, wron, 
     &                 ngq, gq, ngaq1, ngaq2, gaq, rwh, iwh )
        implicit none

        integer*4 nga, nt, ngq, ngaq1, ngaq2, iwh(*)

        real*8 t, x(*), p(*), q(*), wron(nga,*),
     &         gq(ngq,*), gaq(ngaq1,ngaq2,*), rwh(*)

        real*8 M1, M2, M3, M4, mr, mst, h3, Tc
        integer*8 iflag

c       DISCRETIZE1( Tc, rwh, iwh )

        M1 = 0.1362d+0
        M2 = 0.09806d+0
        M3 = M1 + M2
        M4 = 0.236d+0

        mr = M1*x(1) + M2*x(2) + M3*x(3) + M4*x(4)
        mst =  M1*q(1) + M2*q(2) + M4*q(3)

        call mess3( t, x, h3, p, q, rwh, iwh, iflag )

        write (10,100) t, x(1), x(2), x(3), x(4), Tc, h3, mr-mst
100     format( e20.10, 7(1x,e20.10) ) 

  end 
```

* * *

## 回答 #1

> 赞同：9
> 
> 时间：2009-05-27T03:36:45.690

它表示“双精度”，+0 表示 10 的零次方（零是指数）。

这是我能找到的[第一个参考](http://www.obliquity.org/computer/fortran/datatype.html)的引述：

> 存储在计算机中的数字在大小和精度上都是有限的。限制取决于特定的计算机。因此，REAL 数只有一定数量的有效数字。如果计算需要更多有效数字，则必须使用双精度数字。DOUBLE PRECISION 常数以与单精度 REAL 常数相同的指数形式写入，不同之处在于用 D 而不是 E 将尾数与指数分开。

这里引用了一个更好的参考资料[www.fortran.com](http://www.fortran.com/F77_std/rjcnf0001-sh-4.html#sh-4.2.1)，特别是 F77 标准。

> 4.5.2 双精度常数。
> 
> 双精度常数的形式有：
> 
> 1.  基本实常数后跟双精度指数
> 2.  整数常量，后跟双精度指数
> 
> 双精度常量的值是 D 前面的常量和 D 后面的整数所指示的 10 的幂的乘积。形式 (2) 的整数常量部分可以写成比处理器使用的位数更多的数字来近似常数的值。

# python - 如何调试 fastcgi 应用程序？

> ID：913817
> 
> 赞同：3
> 
> 时间：2009-05-27T03:32:40.310
> 
> 标签：python, debugging, web-applications, fastcgi

如何调试 FastCGI 应用程序？我有一个应用程序正在死去，但我不知道为什么，即使它可能会在 stderr 上抛出堆栈跟踪。从命令行运行它会导致错误提示：

```
RuntimeError: No FastCGI Environment: 88 - Socket operation on non-socket 
```

如何为调试目的设置“FastCGI 环境”？这不是我的应用程序——它是第 3 方开源应用程序——所以我宁愿避免添加一堆日志来找出问题所在。

如果重要的话，应用程序是 Python，但 FastCGI 是 FastCGI，对吗？是否有 shim 或其他东西可以让您从命令行调用 fastcgi 程序并将其连接到终端，以便您可以看到它的 stdout/stderr？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-06-17T03:43:01.923

应用程序是 Python 确实很重要。您的问题实际上是“当我自己不启动脚本时如何调试 Python”。

您想使用远程调试器。优秀的 WinPDB 有[一些关于嵌入式调试的文档](http://winpdb.org/docs/embedded-debugging/)，您应该能够使用这些文档附加到您的 FastCGI 应用程序并逐步完成它。

# asp.net - 拥有超过 200 万用户的 ASP.NET 会员资格 - 有任何问题吗？

> ID：913824
> 
> 赞同：4
> 
> 时间：2009-05-27T03:36:24.380
> 
> 标签：asp.net, asp.net-membership

ASP.NET Membership 能否处理超过 200 万用户的场景？是否有人在（非常）大规模使用该提供商方面有好的或不好的经验？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2009-05-27T05:53:56.867

[Omar Al Zabir](http://www.codeproject.com/script/Articles/MemberArticles.aspx?amid=138289)还发布了[10 个 ASP.NET 性能和可扩展性秘密](http://www.codeproject.com/KB/aspnet/10ASPNetPerformance.aspx)，其中一项是**如何在不关闭站点的情况下查询 ASP.NET 2.0 成员资格表**。基本上它与以确保使用正确索引的方式查询数据库有关。此列表中还有另一个关于配置文件的提示。我不确定这些技巧是否与马特推荐的文章中的相同。

我相当肯定 Omar 的[http://www.pageflakes.com/](http://www.pageflakes.com/)站点使用 SQLMembership ASP.NET Membership 提供程序，他可能是一个很好的人来判断这种情况是否可行。鉴于他的社区努力，我相信您可以通过网站联系页面找到他。让他在这里发布答案！

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2009-05-27T05:17:32.413

Omar al Zabir 有一些建议：[http ://weblogs.asp.net/omarzabir/archive/2009/03/14/optimize-asp-net-membership-stored-procedures-for-greater-speed-and-scalability.aspx](http://weblogs.asp.net/omarzabir/archive/2009/03/14/optimize-asp-net-membership-stored-procedures-for-greater-speed-and-scalability.aspx)

# c# - 将用户环境变量读入批处理文件

> ID：913826
> 
> 赞同：0
> 
> 时间：2009-05-27T03:39:28.897
> 
> 标签：c#, batch-file

我有一个在 C# 中设置用户环境变量的应用程序

`PCManufacturer`和`PCModel`

我需要能够从批处理文件中的变量中读取值。我该怎么做呢？

我试过了`%PCManufacturer%`，`%PCModel%`但他们没有用。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-05-27T03:46:41.033

转到命令提示符并执行 SET 命令。验证 PCManufacturer 和 PCModel 是否在列表中，并且它们是否设置为实际值。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-05-27T05:58:27.157

c_workman:

作为后续，这个网页应该被证明是有价值的：

[http://www.microsoft.com/resources/documentation/windows/xp/all/proddocs/en-us/batch.mspx?mfr=true](http://www.microsoft.com/resources/documentation/windows/xp/all/proddocs/en-us/batch.mspx?mfr=true)

# ruby-on-rails - 如何连接到 pop 邮箱并使用 Rails 处理邮件？

> ID：913828
> 
> 赞同：1
> 
> 时间：2009-05-27T03:40:43.140
> 
> 标签：ruby-on-rails, email

我需要某种方式连接到弹出邮箱（这是只读的 - 我不发送任何电子邮件），然后解析邮箱中的消息。

Rails 中是否有用于此的插件或库？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-05-27T04:28:23.903

我相信您可以使用[Net::POP3](http://www.ruby-doc.org/stdlib/libdoc/net/pop/rdoc/classes/Net/POP3.html)做到这一点。

# cluster-computing - 有没有好用的集群搭建软件？

> ID：913829
> 
> 赞同：0
> 
> 时间：2009-05-27T03:41:01.160
> 
> 标签：cluster-computing

假设有几台计算机，分布在同一个网络中。我在所有这些上都安装了一个程序，因此有一个集群。我可以登录它，运行我的应用程序（如网络服务器、数据库服务器等）。我不需要配置IP，不需要平衡负载。

现在有这样的软件吗？

编辑：好的，我想建立一个可以提供企业网络服务器（也是数据库服务器存储数据）的集群，我们有很多 PC，他们现在只运行一个小程序（用于车间工作流程控制）。我想使用额外的 CPU 和磁盘资源来构建服务。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-05-27T03:44:26.473

您计划使用集群服务于什么目的？这将决定您要使用的工具。

话虽如此，您将不得不进行一些配置，例如 IP、身份验证机制等。如果你不告诉它你想要什么，它怎么会知道？

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-11-26T15:45:25.927

一般来说，如果应用程序不是为集群而设计的，那么您将面临更多的痛苦而不是优势。

当前单盒硬件的当前负载是否太高？

# sharepoint - 如何使用 SharePoint、K2 和域控制器复制虚拟 PC

> ID：913832
> 
> 赞同：1
> 
> 时间：2009-05-27T03:42:20.557
> 
> 标签：sharepoint, virtualization, k2

是否有人知道复制和重命名运行 SharePoint、K2 并充当域控制器的虚拟 PC（可以是 MS VPC、VMWare 或 Virtual Box）的简单方法？我正在寻找一种创建图像的方法，该图像可以由同一网络上的多方同时快速轻松地复制和运行，而不会发生名称冲突。据我所知，要么就是这样，要么在每台机器上都经过一个全新的构建。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2009-05-30T02:25:39.493

我建议不要这样做.. 重命名已安装的 SharePoint 机器肯定会导致您无法确定和意外地感到痛苦。方法是使用脚本安装：

*   使用操作系统创建 VM 的副本
*   重命名机器 + 运行 sysprep
*   脚本安装 SQL
*   脚本安装MOSS
*   脚本配置 MOSS（替换配置向导 + 大量手动设置）

这一切都可以在无人看管的情况下完成。

作为安装短期开发机器的快捷方式，我使用了以下方法。只需确保 SharePoint 配置向导在重命名后运行，应该没有问题。

*   创建具有以下内容的 VM 的副本：OS+SQL+MOSS（无配置向导）
*   重命名机器
*   脚本配置MOSS

它的优点是您的开发机器安装相同。创建一个新的大约需要 10 分钟。它没有 sysprep，但它们已重命名，因此您可以在网络上运行它们。不运行 sysprep 从来没有让我感到悲伤，但我不会在生产环境中这样做。运行 MOSS 脚本的配置确保它可以在重命名的环境中工作（并且所有 MOSS 场的配置完全相同，相同的端口，SSP 设置等，耶！）

对于 MOSS 配置脚本，请参阅 h tt p://stsadm.blogspot.com/2008/03/sample-install-script.html 也有大量的 SQL 示例。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-05-27T10:46:27.063

SharePoint 不喜欢从它的脚下重新命名服务器（可以这么说）。SQL Server 也没有（我假设您已经在 VM 上安装了它以进行安装）。不确定DC是否被重命名，那里可能也有问题......

话虽如此，我已经阅读了一些关于重命名 SharePoint 计算机和 SQL Server 计算机的说明，因此您可能会有所收获。

另一方面，我已经尝试了几次，并且总是最终为 SharePoint 从头开始​​重建服务器，因为它可能会以一种并不总是立即显而易见的方式被巧妙地破坏（管理界面和共享服务似乎特别容易混淆）。我发现这些天我可以很快地构建一个香草 MOSS 安装......

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-05-27T11:19:42.927

Sharepoint 将服务器的名称写入 SQL Server 的配置表中。因此，如果您更改服务器的名称，事情就会停止工作。

您可以做的就是只安装操作系统。然后在每次需要新机器时复制一份。运行[系统准备](http://support.microsoft.com/kb/892778)

给机器一个新名称。然后安装 SQL Server 和 MOSS。

这不完全是您所追求的，但它应该可以为您节省一些时间。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2009-06-01T05:45:21.913

我已经这样做了，而且还不错。

首先重命名 SharePoint 服务器，然后重命名 Windows 服务器。

[这个帖子](http://www.sharepointblogs.com/nrdev/archive/2008/07/15/tip-how-to-rename-a-sharepoint-server-machine-name.aspx)有一个很好的清单。

不要忘记从虚拟机的设置文件中删除 NIC 节点，否则会由于 MAC 地址重复而导致名称冲突。[这是一个操作方法](http://www.aspdeveloper.net/Virtual_PC/rn-739-36343_How_to_generate_new_MAC_address.aspx)。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2009-06-02T21:13:29.640

我相信上面的解决方案真的很好。但我会建议一个替代方案......

如果这是开发虚拟 PC，我建议您执行以下操作

1.  不要重命名服务器
2.  将 IP 地址更改为在不同的网络上
3.  更改 MAC 地址，以免发生数据包冲突
4.  由于您将其用作开发 VPC，因此编辑计算机的 lmhosts 文件编辑条目以指向新 IP 地址

您可能想跳过第 2 步并在同一个网络上。但是更改主机文件仍然会指向您。例如，您的服务器名称是“myserver”，它被指向 192.168.1.100，这是本地 ip（有 hosts 文件条目），然后如果您复制服务器，给它 ip 192.168.1.150 并编辑 hosts 文件并将 myserver 指向 192.168 .1.150，系统仍将完美运行。机器的事件日志中会有一些域名冲突，但不会影响你的开发。

# subsonic - Subsonic 将名为“Media”的表重命名为“Medium”

> ID：913834
> 
> 赞同：2
> 
> 时间：2009-05-27T03:43:11.713
> 
> 标签：subsonic

我的 SQL2005 DB 中有一个名为 MultiMedia 的表 - 在使用 SubSonic v2.2 生成 DAL 之后，生成的类名为“MultiMedium”。该表最初被命名为 Media，这也导致了名为 Medium 的类 - 在项目的这一点上很容易更改我的表的名称，但想知道是否有其他人遇到过这个问题，从团队的角度来看，这是一个已知问题？我可能会遇到什么其他命名问题，因为更改表名不会长期无关紧要。

谢谢！

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2009-05-27T06:05:15.773

我大约每 6 个月得到一次其中一个 :) - 他们歇斯底里 :)。是的 - 我们确实将 Octopus 更改为 Octopi ......我们的变形器非常漂亮。

无论如何-您可以设置`fixPluralClassNames`为`false`您的提供商-它将改变这一点：

[https://web.archive.org/web/20090524072848/http://subsonicproject.com/configuration/config-options/](https://web.archive.org/web/20090524072848/http://subsonicproject.com/configuration/config-options/)

# javascript - CSS 问题 - 我的 DIV 保持折叠状态！

> ID：913835
> 
> 赞同：1
> 
> 时间：2009-05-27T03:43:22.197
> 
> 标签：javascript, asp.net, html, css, drag-and-drop

在我网站的主页 - www.mobiuspc.com 上，我有一些不同的部分，我用颜色进行了编码，这样我就可以看到它们是如何布局的。有一个母版页部分，它工作得很好（它是带有“组件”等按钮的棕褐色栏），并且在那个级别及更高级别上，一切都按我希望的那样工作。

下面我有一些问题。我使用 3 个主要 DIV 来分解页面：

```
<div id="mainarea" runat="server" > 
```

这是页眉/母版页区域和黄色编码区域之间的任何内容。这个大区域应该是 700px 高，1024px 宽，并且是银色的。如果您访问该站点，您会发现它不是。有一个带有重复硬盘驱动器图像的面板，这是我拖放功能的拖放区（与此问题无关）。我将它设置为运行服务器，因为如果我不这样做，那么 Drag 'n Drop 似乎会中断。

```
<div id="categorybar"> 
```

这是包含我所有按钮的黄色编码区域。我很高兴。点击名为“显示”的按钮，观察上面的 DIV 发生了什么。它超出了界限！我的 CSS 设置它的宽度和高度似乎被否决了。

```
<div id="detailbox"> 
```

这是蓝色区域，这里没有问题。最终我会把控件放在这里，但现在蓝色很好。

最初的想法可能是我的 CSS 很糟糕。如果是这样的话，我看不到哪里！我已经设置了高度/宽度和所有好东西。我尝试将 float:left 添加到随机部分，但没有效果。这是我的 CSS 文件的相关摘录”

```
#mainarea
{
background-color:Silver;
height:700px;
width:1024px;
}

#categorybar
{
background-color:Yellow;
height:80px;
width:1024px;
}

#detailbox
{
background-color:Blue;
height:420px;
width:1024px;
} 
```

当您单击“显示”按钮时，我会在运行时创建对象，并将所有这些对象添加到位于#mainarea DIV 中的窗格中。该窗格被称为工具箱，这里是它的 CSS 属性：

```
#toolboxpanel
{
height:700px;
width:324px;
max-height:700px;
max-width:324px;
overflow:scroll;
} 
```

出于某种原因，当我在运行时添加控件而不是像我喜欢的那样简单地使用滚动条时，它会不断扩展超出其预定义的大小。将所有硬盘图片作为拖放区的面板，也在#mainarea DIV 中，如果相关，这里是 CSS：

```
#droppanel
{
height:700px;
width:700px;
margin-top:-700px;
margin-left:324px;
} 
```

我应该摆脱 runat=server 位吗？如果我这样做并单击显示按钮，我仍然会让那个可怕的面板一直扩展到页面底部，但至少银色的#mainarea DIV 保持适当的大小（面板刚刚失控）。如果我走那条路，知道为什么它会破坏我的拖放操作吗？我希望我不必走那条路，相反，我的 CSS 中有一些愚蠢的东西我忽略了......

谢谢你的帮助！账单

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2009-05-27T03:48:26.870

runat="server" 将更改您正在使用它的控件的客户端 ID，这意味着您的 #mainarea css 将不适用。

您可以通过为 mainarea 分配一个 css 类并使用它来应用样式而不是它的 id 来解决这个问题。

# visual-studio - 为什么我的类在 Visual Studio 中默认是私有的？

> ID：913836
> 
> 赞同：7
> 
> 时间：2009-05-27T03:43:55.193
> 
> 标签：visual-studio

我创建了一个新的类文件，Visual Studio 默认不公开它。我可以改变这个吗？

* * *

## 回答 #1

> 赞同：12
> 
> 时间：2009-05-27T03:53:45.307

默认情况下，没有访问说明符的类是内部的，成员默认为私有的。这使得可见性尽可能受到限制，从而增加了封装性。

甚至不考虑就公开一个新类会破坏封装的整个想法。

VS 用来创建新类的类模板可以在这个 zip 文件中找到（如果是 CSharp）：

使用 VS 时 C:\Program Files\Microsoft Visual Studio 8\Common7\IDE\ItemTemplates\CSharp\1033\Class.zip 或 C:\Program Files\Microsoft Visual Studio 9.0\Common7\IDE\ItemTemplates\CSharp\Code\1033逆戟鲸

打开 zip 文件，添加 public 关键字，保存它就完成了。每次添加课程时，它都会公开。希望这可以帮助。

[资源](http://blogs.infosupport.com/blogs/patrickg/archive/2007/05/31/Change-standard-content-of-Class1.cs-when-adding-a-new-Class-with-Visual-Studio.aspx)

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-05-27T03:53:31.860

默认代码模板还有其他问题 - 例如，它们不符合开箱即用的 StyleCop，因为“使用”行在命名空间声明之外。

您可以使用 ReSharper 从模板创建类文件，允许您将所需的任何代码放入模板中。我就是做这个的 ：）

* * *

## 回答 #3

> 赞同：-1
> 
> 时间：2009-05-27T03:52:27.800

您的意思是该课程本身在其他课程中不可用？还是您的意思是文件的所有内容都默认为私有访问？

如果您希望该类在其他类中可见，您只需要确保命名空间在其他类中可见（使用 c# 中的“using”关键字，或者将它们放在同一个命名空间中）。

不知道你说的是哪种语言，但在 c# 中，所有方法、成员变量、属性等都默认为私有。如果您希望它们公开，则需要为每个成员单独指定。我认为不可能在 c# 中改变这种行为。

* * *

## 回答 #4

> 赞同：-1
> 
> 时间：2009-05-27T04:01:57.417

我不认为您可以更改 VS 中的选项，以便默认情况下创建的所有类都是公共的（但我会研究它。）

我认为，除非您非常具体地需要将所有类声明为公共（我想不出任何），否则您应该保留默认值。这使您可以准确地决定哪些类是公共的，哪些应该保留在内部。在我看来，一个好的设计选项会规定类默认声明为“内部”。

* * *

## 回答 #5

> 赞同：-1
> 
> 时间：2009-05-27T03:51:26.113

我听说过对此的抱怨，我不相信这是一个可以改变的选择。

# mysql - MySQL 条件插入

> ID：913841
> 
> 赞同：105
> 
> 时间：2009-05-27T03:48:00.583
> 
> 标签：mysql, insert, conditional

我很难形成有条件的 INSERT

我有 x_table 列（实例、用户、项目），其中实例 ID 是唯一的。仅当用户还没有给定项目时，我才想插入新行。

例如尝试插入 instance=919191 user=123 item=456

```
Insert into x_table (instance, user, item) values (919191, 123, 456) 
    ONLY IF there are no rows where user=123 and item=456 
```

任何正确方向的帮助或指导将不胜感激。

* * *

## 回答 #1

> 赞同：127
> 
> 时间：2009-05-27T04:31:08.277

如果您的 DBMS 在执行插入时没有限制您从哪个表中选择，请尝试：

```
INSERT INTO x_table(instance, user, item) 
    SELECT 919191, 123, 456
        FROM dual
        WHERE NOT EXISTS (SELECT * FROM x_table
                             WHERE user = 123 
                               AND item = 456) 
```

在此，`dual`是一个只有一行的表（最初在 Oracle 中找到，现在也在 mysql 中）。逻辑是 SELECT 语句生成具有所需值的单行数据，但仅在尚未找到值时。

或者，查看 MERGE 语句。

* * *

## 回答 #2

> 赞同：54
> 
> 时间：2012-04-25T06:52:03.827

当您在 (user, item) 上有唯一索引时，您还可以使用`INSERT IGNORE`which 静默忽略插入，而不是更新或插入行。

查询将如下所示：

```
INSERT IGNORE INTO x_table(instance, user, item) VALUES (919191, 123, 456) 
```

您可以使用添加唯一索引`CREATE UNIQUE INDEX user_item ON x_table (user, item)`。

* * *

## 回答 #3

> 赞同：37
> 
> 时间：2011-10-15T21:35:16.897

你有没有尝试过这样的事情？

```
INSERT INTO x_table (instance, user, item)
SELECT 919191 as instance, 123 as user, 456 as item
FROM x_table
WHERE (user=123 and item=456)
HAVING COUNT(*) = 0; 
```

* * *

## 回答 #4

> 赞同：10
> 
> 时间：2009-05-27T04:37:40.513

用`UNIQUE(user, item)`，做：

```
Insert into x_table (instance, user, item) values (919191, 123, 456) 
  ON DUPLICATE KEY UPDATE user=123 
```

该`user=123`位是“无操作”，用于匹配`ON DUPLICATE`子句的语法，而在有重复项时实际上不做任何事情。

* * *

## 回答 #5

> 赞同：3
> 
> 时间：2014-08-29T11:23:48.333

如果您不想设置唯一约束，这就像一个魅力：

```
INSERT INTO `table` (`column1`, `column2`) SELECT 'value1', 'value2' FROM `table` WHERE `column1` = 'value1' AND `column2` = 'value2' HAVING COUNT(`column1`) = 0 
```

希望能帮助到你 ！

* * *

## 回答 #6

> 赞同：3
> 
> 时间：2015-03-27T18:49:13.327

你想要的是`INSERT INTO table (...) SELECT ... WHERE ...`. 来自[MySQL 5.6 手册](http://dev.mysql.com/doc/refman/5.6/en/insert.html)。

在你的情况下，它是：

```
INSERT INTO x_table (instance, user, item) SELECT 919191, 123, 456 
WHERE (SELECT COUNT(*) FROM x_table WHERE user=123 AND item=456) = 0 
```

或者，也许因为您没有使用任何复杂的逻辑来确定是否运行，`INSERT`您可以只`UNIQUE`在这两列的组合上设置一个键，然后使用`INSERT IGNORE`.

* * *

## 回答 #7

> 赞同：1
> 
> 时间：2009-05-27T04:00:26.117

如果添加 (x_table.user, x_table.item) 唯一的约束，则插入具有相同用户和项目的另一行将失败。

例如：

```
mysql> create table x_table ( instance integer primary key auto_increment, user integer, item integer, unique (user, item));
Query OK, 0 rows affected (0.00 sec)

mysql> insert into x_table (user, item) values (1,2),(3,4);
Query OK, 2 rows affected (0.00 sec)
Records: 2  Duplicates: 0  Warnings: 0

mysql> insert into x_table (user, item) values (1,6);
Query OK, 1 row affected (0.00 sec)

mysql> insert into x_table (user, item) values (1,2);
ERROR 1062 (23000): Duplicate entry '1-2' for key 2 
```

* * *

## 回答 #8

> 赞同：1
> 
> 时间：2009-05-27T04:03:02.893

虽然在插入数据之前检查重复是很好的，但我建议你在列上放置一个唯一的约束/索引，这样就不会错误地插入重复的数据。

* * *

## 回答 #9

> 赞同：1
> 
> 时间：2018-08-15T22:55:36.077

您可以使用以下解决方案来解决您的问题：

```
INSERT INTO x_table(instance, user, item) 
    SELECT 919191, 123, 456
        FROM dual
        WHERE 123 NOT IN (SELECT user FROM x_table) 
```

* * *

## 回答 #10

> 赞同：0
> 
> 时间：2013-03-13T13:01:09.057

所以这个代表PostgreSQL

```
INSERT INTO x_table
SELECT NewRow.*
FROM (SELECT 919191 as instance, 123 as user, 456 as item) AS NewRow
LEFT JOIN x_table
ON x_table.user = NewRow.user AND x_table.item = NewRow.item
WHERE x_table.instance IS NULL 
```

* * *

## 回答 #11

> 赞同：0
> 
> 时间：2011-07-25T05:50:04.630

对亚历克斯的回应稍作修改，您也可以只引用现有的列值：

```
Insert into x_table (instance, user, item) values (919191, 123, 456) 
  ON DUPLICATE KEY UPDATE user=user 
```

* * *

## 回答 #12

> 赞同：0
> 
> 时间：2020-09-28T07:55:06.990

我今天发现一个`SELECT`语句可以`WHERE`有条件，即使它没有`FROM`子句并且根本不读取任何表。

这使得使用这个结构有条件地插入一些东西变得非常容易：

```
SELECT ... INTO @condition;
-- or if you prefer: SET @condition = ...

INSERT INTO myTable (col1, col2) SELECT 'Value 1', 'Value 2' WHERE @condition; 
```

在 MySQL 5.7 和 MariaDB 10.3 上对此进行了测试。

* * *

## 回答 #13

> 赞同：-1
> 
> 时间：2009-05-27T03:56:41.883

```
Insert into x_table (instance, user, item) values (919191, 123, 456) 
    where ((select count(*) from x_table where user=123 and item=456) = 0); 
```

语法可能因您的数据库而异...

# postgresql - 如何将 PostgreSQL 表导出为 HTML？

> ID：913843
> 
> 赞同：5
> 
> 时间：2009-05-27T03:48:31.787
> 
> 标签：postgresql

如何将 PostgreSQL 表保存为 HTML？

* * *

## 回答 #1

> 赞同：11
> 
> 时间：2009-05-27T04:24:46.373

我会试着假设你的意思。在 psql 中：

```
数据库名称=# \H
dbname=# \d 表名

```

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2009-05-27T03:52:12.997

下面是一个 XML“森林”的例子：

```
SELECT xmlforest (
  "FirstName" as "FName", "LastName" as "LName",
  ’string’ as "str", "Title", "Region" )
FROM "Demo"."demo"."Employees"; 
```

对于员工表中的一些数据，这可能会导致：

```
<FName>Nancy</FName>
<LName>Davolio</LName>
<str>string</str>
<Title>Sales Representative</Title>
<Region>WA</Region>
...
<FName>Anne</FName>
<LName>Dodsworth</LName>
<str>string</str>
<Title>Sales Representative</Title> 
```

[http://wiki.postgresql.org/wiki/XML_Support](http://wiki.postgresql.org/wiki/XML_Support)

# c# - 如何创建像 Microsoft Office 2010 TP 这样的半透明 Windows 窗体？

> ID：913845
> 
> 赞同：0
> 
> 时间：2009-05-27T03:51:34.693
> 
> 标签：c#, winforms, user-interface, aero

我需要创建具有以下功能的 Windows 窗体。

1.  表格上半部分半透明（约 100-200 像素）。
2.  Microsoft Office 2010 TP 等快速访问工具栏。
3.  由 Windows API 生成的控制框（最小化、最大化、关闭按钮）（我不喜欢创建自定义控制框）。

[替代文字 http://rabu4g.bay.livefilestore.com/y1pkkJL5_Xgghjczn0wckj0lpDrPXL4EhIzUX9d5FyWXI5Pqoe8bz9F9y1agq18jEb5bSiK3anmEyiq7bfkhqju-dilWu_GgHCt/Capture.PNG](http://rabu4g.bay.livefilestore.com/y1pkkJL5_Xgghjczn0wckj0lpDrPXL4EhIzUX9d5FyWXI5Pqoe8bz9F9y1agq18jEb5bSiK3anmEyiq7bfkhqju-dilWu_GgHCt/Capture.PNG)

**谢谢，**

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-05-27T04:46:17.437

有许多第三方控件可以在标题栏中提供工具栏——我喜欢[DevExpress 的产品](http://devexpress.com/Products/NET/Controls/WinForms/Bars/)——但我不确定半透明方面。

# java - DateChooser 无法在 smartgwt 中直观地更改为选定的日期

> ID：913847
> 
> 赞同：2
> 
> 时间：2009-05-27T03:52:00.077
> 
> 标签：java, gwt, smartgwt

我在我的项目中使用 DateChooser。在选择其他日期后，dateChooser 保持在同一日期（在当前日期）。它在视觉上没有改变。我也尝试使用 setData() 和 redraw() 方法。但它仍然不是工作。我正在使用 smartgwt-1.1 和 gwt-1.6.4 版本。我的示例代码是：

```
final DateChooser dateChooser = new DateChooser();
    dateChooser.setWidth("180");
    dateChooser.setHeight("180");

dateChooser.addDataChangedHandler(new DataChangedHandler() {
        public void onDataChanged(DataChangedEvent event) {
                            SC.say(dateChooser.getData()+"");
            dateChooser.setData(dateChooser.getData());
            dateChooser.redraw();
        }
    }); 
```

任何人都可以提出建议吗？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2011-10-03T04:37:51.367

您不需要设置任何处理程序`DateChooser`来使项目工作。你试过没有`DataChangedHandler`?

附带说明一下，您应该使用`addChangedHandler`，而不是`addDataChangedHandler`当您希望事件在字段中的用户输入时触发。DataChangedHandler 在绑定数据源的数据更改（从数据源获取新数据）时触发，而不是在用户更改项目上的值时触发。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-05-27T04:49:24.127

您在哪里更改代码中的日期？我只看到`dateChooser.setData(dateChooser.getData())`，而且很明显该代码永远不会改变数据。

# c# - 读取 xml 时应该何时使用 xml 架构（.xsd）？

> ID：913851
> 
> 赞同：3
> 
> 时间：2009-05-27T03:53:43.310
> 
> 标签：c#, xml, xsd

我有一个 XML 文件，其中包含数据源的配置数据，以及保存在“dataseries”元素中的相关查询。

因为我真的不需要由 XML 组成的域对象，而只是读取设置并用于配置连接等。我想知道使用我定义的 XML 模式是否有任何优势？

我正在使用 LINQ to XML 来读取我的 XML，并且最初认为使用强类型 XML 是一个好主意。

我应该使用 .xsd 还是矫枉过正？

一个模拟 XML 文件：

```
 <?xml version="1.0" encoding="utf-8" ?>
<datasource name=" Datasource" cache="true">
  <database>
    <connection>
      <provider-name>sqlServer6.0</provider-name>
      <source name="E5"
            connectionString=""/>
    </connection>
    <update-interval>30</update-interval>
    <minimum-update-interval>2</minimum-update-interval>
  </database>
  <dataseries name="" identifier="e5">
    <graph-type></graph-type>
      <query>
        SELECT Period, Price
        FROM PriceUS
        WHERE Date = @date
      </query>
  </dataseries>
  <dataseries name="" identifier="e52">
    <graph-type></graph-type>
    <query>
      SELECT Period, Price
      FROM PriceUS
      WHERE Date = @date
    </query>
  </dataseries>
</datasource> 
```

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2009-05-27T04:00:15.493

“正确”的 XML 文档有两个级别：[格式良好的和有效的](http://en.wikipedia.org/wiki/XML)。格式良好意味着它符合 XML 规范，有效意味着它符合您的模式。如果并且当您从一个完全陌生的人那里接受 XML 文档时，通常最好在继续之前检查文档的有效性。

正如您所提到的，XML 模式也可用于生成 XML 数据绑定实体。当您向世界或您的客户发布服务或模式时，模式文档可以用作规范。然后，世界或您的客户可以使用 XSD 文件来验证或数据绑定到您交换的 XML 文档。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-05-27T15:01:30.717

从技术上讲，XML 中有两种正式的模式类型。有原始模式语法，称为文档类型定义 (DTD)，它是古代 SGML 时代的遗留物。然后是 W3C 标准 XSD，它更兼容现代数据。

我提到这一点的唯一原因是您可能会收到一个使用 DTD 描述的 XML 文件，并且您可能需要知道如何处理它。

但是请朋友们不要让朋友们为新的应用程序创建 DTD。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-05-27T03:58:38.517

当您想要**验证**XML 时，模式是很好的，例如，确保某些元素存在或具有一组有限的值。如果您将使用 XML 进行大量工作，那么架构也很好，并且将 XML 转换为 C# 对象会更容易——在这种情况下，您可以使用`xsd.exe`代码生成器生成可以编组和解组的 C# 对象从 XML。

# javascript - Javascript 匹配并替换为 unicode

> ID：913866
> 
> 赞同：5
> 
> 时间：2009-05-27T04:02:26.387
> 
> 标签：javascript, regex, unicode

我有一些 javascript 可以读取一些 cookie，并进行一些匹配。我正在使用分组来捕获正则表达式的一部分并在以后使用它们。不过，我遇到了 unicode 字符的问题。如果我有一个像 \u25BA ► 这样的字符，当我在一个分组中找到这个字符时，它会返回字符串 '\u25BA' 而不是我正在寻找的 unicode 字符。如果我指定字符，我可以解决问题，但我不能让它更普遍地工作。以下将按我的意愿工作：

```
var matches=theOnclick.match(/.*\(event, ?"([^"]*)", ?"([^"]*)".*\)/);
var expand=matches[1].replace(/\\u25BA/, '\u25BA'); 
```

但这不起作用：

```
var expand=matches[1].replace(/\\u([0-9A-Z])/, '\u\1'); 
```

有什么建议么？

更多信息：感谢您的回答。让我再添加一点背景。我认为问题在于我从跨度上的“onclick”中获取匹配项。我在下面包含了一个更详细的示例。如果我有一个包含 unicode 字符的普通字符串，那么当我进行匹配时，我会得到 unicode 字符。但是，当我从 onclick 的值中获取字符串时，我得到的是 unicode 转义序列。所以我一直在尝试将 unicode 转义序列转换回 unicode 字符。我希望这是有道理的。也许还有另一种方法可以做到这一点。

在下面的示例中， bar 的行为如我所愿，而 foo 则不然。

```
<html>
<body>
<span id='foo' onclick='expandCollapse(event, "►", "▼");'>foo</span>
<script type='text/javascript'>
var foo= document.getElementById('foo').onclick+'';
alert(foo);
var foomatches=foo.match(/.*\(event, ?"([^"]*)", ?"([^"]*)".*\)/);
alert(foomatches);
var bar='expandCollapse(event, "►", "▼");'
var barmatches=bar.match(/.*\(event, ?"([^"]*)", ?"([^"]*)".*\)/);
alert(barmatches);
</script>
</body>
</html> 
```

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2009-05-27T04:13:05.227

我认为你的 \1 是错误的。它应该是这样的：

```
"\u2603".replace(/(.)/, "$1")) 
```

$1 是替换文本中的反向引用。

但我不完全确定你想要做什么。请记住 \u 只能与 unicode *literals*一起使用。所以正则表达式中的 \u 匹配文字 \ 然后是文字 u。替换文本中的 \u 是 u。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-05-27T04:11:30.840

关于什么

```
var expand=matches[1].replace(/\\u([0-9A-Z])/, '\1'); 
```

? 我不认为你需要在`\u`那里逃跑的人。

# apache - 如何将 Apache 的默认编码更改为 UTF-8

> ID：913869
> 
> 赞同：145
> 
> 时间：2009-05-27T04:04:02.367
> 
> 标签：apache, character-encoding, apache-config

我正在使用托管公司，如果文件`index.html`不存在，它将列出目录中的文件。它使用[ISO 8859-1](https://en.wikipedia.org/wiki/ISO/IEC_8859-1)作为默认编码。

如果服务器是 Apache，有没有办法将 UTF-8 设置为默认值？

我发现它实际上使用的是 HTML 3.2 的 DOCTYPE，然后根本没有`charset`……所以它没有设置任何编码。但是有没有办法将其更改为使用 UTF-8？

* * *

## 回答 #1

> 赞同：183
> 
> 时间：2009-05-27T04:11:25.020

在 httpd.conf 添加（或更改，如果它已经存在）：

```
AddDefaultCharset utf-8 
```

* * *

## 回答 #2

> 赞同：58
> 
> 时间：2012-06-07T06:44:40.787

将此添加到您的`.htaccess`：

```
IndexOptions +Charset=UTF-8 
```

或者，如果您具有管理员权限，则可以通过编辑`httpd.conf`和添加全局设置：

```
AddDefaultCharset UTF-8 
```

（您也可以使用`AddDefaultCharset`in `.htaccess`，但它不会以这种方式影响 Apache 生成的目录列表。）

* * *

## 回答 #3

> 赞同：30
> 
> 时间：2009-05-27T04:11:01.993

请参阅[AddDefaultCharset 指令](http://httpd.apache.org/docs/2.2/en/mod/core.html#adddefaultcharset)、[AddCharset 指令](http://httpd.apache.org/docs/2.2/en/mod/mod_mime.html#addcharset)和[本文](http://edipage.wordpress.com/2006/08/26/apache-default-encoding/)。

```
AddDefaultCharset utf-8 
```

> 但我不得不时不时地使用汉字。`&#`以前，我使用hack将汉字翻译成 Unicode 代码并将其包含在文档中 。但它只对有几个字符的页面有用。
> 
> 有一种更好的方法可以做到这一点：在文件名中编码字符集信息，apache 将基于此输出正确的编码头。这要归功于 `AddCharset`conf 文件中的行，例如下面的行：
> 
> `conf/httpd.conf`：

```
AddCharset UTF-8 .utf8 
```

> 因此，如果您有一个名称以`.html.utf8`.

* * *

## 回答 #4

> 赞同：25
> 
> 时间：2013-03-06T16:49:40.583

在 Ubuntu 12.04 上，取消注释`AddDefaultCharset UTF-8`. `/etc/apache2/conf.d/charset`如果您使用的是上游 Apache，该文件可能名为 httpd.conf，您可能必须插入该行。

* * *

## 回答 #5

> 赞同：25
> 
> 时间：2014-08-12T03:09:23.727

在文件*.htaccess*中，添加以下行：

```
AddCharset utf-8 .html .css .php .txt .js 
```

这适用于那些无法访问其服务器配置文件的人。当其他尝试失败时，这只是另一件事。

至于有关使用文件*.htaccess*的性能问题，我还没有看到这一点。我的典型页面加载时间是 150-200 毫秒，有或没有文件*.htaccess*。

如果您的页面无法正确呈现，性能有什么好处？大多数共享服务器不允许用户访问配置文件，这是添加字符集的首选位置。

* * *

## 回答 #6

> 赞同：12
> 
> 时间：2014-08-26T00:27:34.170

为了完整起见，在 Ubuntu 上的 Apache2 上，您将在 conf-available 中的 charset.conf 中找到默认字符集。

取消注释该行

```
AddDefaultCharset UTF-8 
```

* * *

## 回答 #7

> 赞同：11
> 
> 时间：2009-05-27T04:12:27.953

我不确定您是否有权访问 Apache 配置 (httpd.conf)，但您应该能够设置 AddDefaultCharset 指令。看：

[http://httpd.apache.org/docs/2.0/mod/core.html](http://httpd.apache.org/docs/2.0/mod/core.html)

查找 mod_mime.c 模块并确保设置了以下内容：

```
AddDefaultCharset utf-8 
```

或等效的 Apache 1.x 文档 ( [http://httpd.apache.org/docs/1.3/mod/core.html#adddefaultcharset](http://httpd.apache.org/docs/1.3/mod/core.html#adddefaultcharset) )。

但是，这仅在“响应内容类型为 text/plain 或 text/html”时才有效。

您还应该确保您的页面也有字符集。有关更多信息，请参见：

[http://www.w3.org/TR/REC-html40/charset.html](http://www.w3.org/TR/REC-html40/charset.html)

* * *

## 回答 #8

> 赞同：8
> 
> 时间：2009-05-27T04:09:46.170

这是未经测试的，但它可能会起作用。

在您的*.htaccess*文件中，添加：

```
<Files ~ "\.html?$">  
     Header set Content-Type "text/html; charset=utf-8"
</Files> 
```

但是，这将需要服务器上的*mod_headers*。

* * *

## 回答 #9

> 赞同：4
> 
> 时间：2016-05-03T20:40:01.417

如果您有 UTF-8 格式的长文件名，请提示：默认情况下，它们将被缩短为 20 个字节，因此最后一个字符可能会被“切成两半”，因此无法正确识别。然后您可能需要设置以下内容：

`IndexOptions Charset=UTF-8 NameWidth=*`

`NameWidth`设置将防止缩短您的文件名，使它们正确显示和可读。

正如其他用户已经提到的，这应该添加到`httpd.conf`或`apache2.conf`（如果您有管理员权限）或`.htaccess`（如果您没有）中。

* * *

## 回答 #10

> 赞同：3
> 
> 时间：2014-12-11T07:59:55.443

在所有 HTML 文件都采用 UTF-8 格式并且没有内容类型的元标记的情况下，我只能通过添加两个指令来为 Apache 2.4 发送这些文件设置所需的默认值：

```
AddLanguage ru .html
AddCharset UTF-8 .html 
```

* * *

## 回答 #11

> 赞同：2
> 
> 时间：2016-11-04T09:55:39.173

把它留空：`'default_charset' in WHM :::::: default_charset =''`

PS：在WHM中，转到→*主页*→*服务配置*→ *PHP配置编辑器*→单击*“高级模式”* →找到“default_charset”并将其留空。什么都没有，不是 UTF-8 也不是 ISO。

* * *

## 回答 #12

> 赞同：1
> 
> 时间：2020-10-22T16:37:52.613

**<meta charset='utf-8'>**覆盖 Apache 默认字符集（*cf /etc/apache2/conf.d/charset*）

如果这还不够，那么您可能使用[ISO 8859-1](https://en.wikipedia.org/wiki/ISO/IEC_8859-1)编码字符集创建了原始文件。您必须将其转换为正确的字符集：

```
iconv -f ISO-8859-1 -t UTF-8 source_file.php -o new file.php 
```

* * *

## 回答 #13

> 赞同：0
> 
> 时间：2020-01-11T19:15:27.263

就我而言，我将此添加到文件*.htaccess*：

```
AddDefaultCharset off
AddDefaultCharset windows-1252 
```

# java - 如何在基于抽象语法树的解释器中表示类

> ID：913871
> 
> 赞同：5
> 
> 时间：2009-05-27T04:05:12.853
> 
> 标签：java, php, compiler-construction, interpreter, abstract-syntax-tree

我已阅读相关问题，但似乎都没有直接解决这个问题。我正在编写一个 PHP 脚本解释器。我让 AST 为除类之外的所有内容生成适当的节点。处理类与处理函数有点不同，所以我正在寻找如何处理独立的类以及扩展其他类的类。

我看过 ANTLR，但我负担不起开销，因为这是嵌入式平台。我正在寻找的是 AST 中的类在概念上的理论，因此它们可以由解释器的执行程序部分执行。非常感谢与此问题的具体答案的良好链接。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-05-28T23:30:43.170

ANTLR 或多或少与您的问题无关。

PHP 中的类基本上是从字符串到属性的映射。每个属性都可以是公共的、私有的、受保护的。每个属性还包含一个值，它可以是静态变量或方法。方法是（在 PHP 中）采用隐式 $this 参数的函数。所以你可以把一个类看作是 PHP 中的一个奇特的数组对象。

当你创建一个对象时，你给它一个指向你的 PHP 类对象的指针。当您在该对象上调用方法时，您会通过通过该指针获得的类对象查找方法。

我希望这有帮助。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-05-28T23:21:49.723

也许您需要一些从源语法中移除的解释结构？我对 PHP 了解不多，但听起来你真的在问如何以一种便于解释的方式构建程序模型。我认为通过 ANTLR 生成的 AST 有点过于接近你想要的源。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-05-27T17:07:21.727

我发现自上而下编译器中最好的方法，最好的方法是将类通常像函数一样对待，因为它们只是节点，而无需在下降到树中之前评估参数。

不同之处在于执行程序，它必须创建一个执行范围，在其中封装构成类节点的方法和变量。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2009-05-29T05:48:36.260

我建议使用 JavaCC（或 fork FreeCC）来解析和构建您的 AST。JavaCC 生成一个没有运行时依赖的解析器。编写比 JavaCC 生成的代码更小/更快的解析器是很困难的。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2009-07-29T15:55:53.013

看看[phc 抽象语法](http://www.phpcompiler.org/doc/latest/grammar.html)，它就是这样做的。（顺便说一句，听起来使用 phc 的前端可能比重新发明轮子更好）。

```
Class_def ::= Class_mod CLASS_NAME extends:CLASS_NAME? implements:INTERFACE_NAME* Member* ;
Class_mod ::= "abstract"? "final"? ;

Interface_def ::= INTERFACE_NAME extends:INTERFACE_NAME* Member* ;

Member ::= Method | Attribute ;

Method ::= Signature Statement*? ;
Signature ::= Method_mod is_ref:"&"? METHOD_NAME Formal_parameter* ;
Method_mod ::= "public"? "protected"? "private"? "static"? "abstract"? "final"? ;
Formal_parameter ::= Type is_ref:"&"? var:Name_with_default ;
Formal_parameter ::= Type is_ref:"&"? var:Name_with_default ;
Type ::= CLASS_NAME? ;
Name_with_default ::= VARIABLE_NAME Expr? ;

Attribute ::= Attr_mod vars:Name_with_default* ;
Attr_mod ::= "public"? "protected"? "private"? "static"? "const"?  ; 
```

# iphone - EXC_BAD_ACCESS，但没有僵尸，并且不在调试构建配置中

> ID：913872
> 
> 赞同：3
> 
> 时间：2009-05-27T04:05:23.727
> 
> 标签：iphone, cocoa-touch

这让我发疯了。我刚刚第一次将我的第一个应用程序上传到 App Store，当然，现在我的应用程序正在左右爆炸。当我使用发布构建配置进行构建时，我随机`EXC_BAD_ACCESS`在应用程序上敲击一段时间后得到一个。我重新打开了 Zombies，但问题似乎不是过度释放变量，因为我没有收到关于向已释放变量发送消息的消息。

该错误总是出现在我的代码中的同一位置。看起来我正在尝试保留一个尚未正确初始化的变量。我一点也不知道我怎么能做到这一点。

但奇怪的是：如果我在调试版本配置中构建，它永远不会崩溃。我可以整天敲打这东西，而且它坚如磐石。我使用发布配置构建，它会间歇性地崩溃。

查看两种配置中的 Build 设置，并没有太多差异。在调试中，GCC 4.0 优化级别是“无”，而在发布中，它是“最快、最小”。如果我将 Release 中的优化级别切换为“None”，则应用程序会自行运行。有谁知道我应该寻找什么来解决这个问题？或者，如果我在没有优化的情况下进行分发，会发生多少坏事？

**更新：**

当！我真的需要一个神奇的内存错误调试工具。我在最后一天左右一直在解决这个问题。我添加了一个`exercise`可靠地产生崩溃的方法，并开始寻找导致它的代码区域。

当我执行一种特定类型的操作时，该应用程序通常会在第 3-5 次崩溃。这种类型的操作唯一不同的是我从辅助方法返回的值。附件方法通常返回`NSDecimalNumber`值为 0-3 的 s，但是当我返回`NSDecimalNumber`一个非整数值时，有一种特殊情况。我会测试寻找非整数值的附件方法的结果。我将特殊情况更改为返回`NSDecimalNumber`值为 -1 而不是非整数值的 an，并且我不能再使应用程序崩溃。

基本上，我所做的唯一改变是从 `[[NSNumber numberWithDouble:num] decimalValue]`--> crash 切换到 `[[NSNumber numberWithInteger:num] decimalValue]`--> no crash

它有点但比这更复杂，但并不多。

现在，我很高兴应用程序不再崩溃，但我所做的更改并没有让我充满信心，因为旧的代码似乎并没有以任何方式“损坏”。所以，虽然我的应用程序不再崩溃，但这并不是因为我“修复”了它，我只是随机更改了一些东西，现在它可以工作了。8^(

**更新：**

调试器不会像通常在程序崩溃时那样吐出堆栈跟踪。当它崩溃时，调试控制台输出以下内容：

正在将程序加载到调试器中……</p>

[...版权的东西...]

```
This GDB was configured as "i386-apple-darwin".warning: Unable to read symbols for "/System/Library/Frameworks/UIKit.framework/UIKit" (file not found).

warning: Unable to read symbols from "UIKit" (not yet mapped into memory).

warning: Unable to read symbols for "/System/Library/Frameworks/CoreGraphics.framework/CoreGraphics" (file not found).

warning: Unable to read symbols from "CoreGraphics" (not yet mapped into memory).
Program loaded.

sharedlibrary apply-load-rules all

Attaching to program: `/Users/...', process 10066.

Re-enabling shared library breakpoint 1

Cannot access memory at address 0x4

Cannot access memory at address 0x4

(gdb) 
```

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2009-05-27T04:37:36.927

如果它像打开 Zombies 一样简单，并且你总能找到你的过度发布......有很多 Zombies 无法检测到的此类错误。内存错误没有神奇的调试工具；只需要仔细编程（并且有些模式会使这些错误更加罕见，并且在它们确实发生时更容易调试）。

优化的代码可以摆脱许多未优化代码中没有出现的东西。它确实略微暗示它可能是局部变量而不是 ivar，但可能不是。可能只是时机；更快可能会使竞争条件更频繁地发生相反的情况。

如果你可以让它崩溃，当然第一步是查看堆栈跟踪。

在没有优化的情况下进行分发并没有什么大错，但这只是掩盖了问题。里面有编码错误。优化不会破坏您的代码。你的代码坏了。

这里有一个很好的关于调试内存问题的[讨论](https://stackoverflow.com/questions/172125/avoiding-finding-and-removing-memory-leaks-in-cocoa)。#1 规则是您必须使用访问器。他们会为你省去很多心痛，所以希望你已经这样做了。我在[内存管理规则](http://robnapier.net/blog/three-magic-words-6)的简短讨论中提供了其他一些建议。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-05-27T04:52:07.840

我建议提高编译器的警告级别，看看是否有任何弹出。打开您的项目设置并启用您可以找到的每个“警告”选项。或者，找到名为**Other C Flags**的项目设置并添加 flags `-Wall -Wextra`。

对于有符号/无符号不匹配、可能的精度损失等问题，您将获得大量白噪声，您可以（通常）安全地忽略这些问题。但是，可能会弹出一些您绝对不应该忽略的关键警告：例如从没有强制转换的整数创建指针（反之亦然）。如果您不能 100% 确定可以忽略警告，请修复代码以使警告消失。

# sharepoint - 将 Search Server 2008 Express 与 WSS 3.0 集成

> ID：913876
> 
> 赞同：0
> 
> 时间：2009-05-27T04:06:43.650
> 
> 标签：sharepoint

我正在使用 WSS (Windows SharePoint Services) 3.0 为 Intranet 设置环境。问题在于将环境配置为与 MS Search Server 2008 Express 一起使用。

这是我要设置的环境：

A：网络服务器；赢服务器 2003 SP2; WSS 3.0 SP2；IIS 6.0；.NET 3.5 SP1

B：搜索服务器；赢服务器 2003 SP2; WSS 3.0 SP2；IIS 6.0；.NET 3.5 SP1；搜索服务器 2008 速成版

C：数据库服务器；赢服务器 2003 SP2; SQL Server 2000 SP3 - 管理数据库、内容数据库、配置数据库、搜索数据库

问题是是否可以像上述配置一样使用 3 个服务器，或者搜索服务器 (B) 是否必须与 (A) 结合使用，因为我们使用的是搜索服务器的免费 Express 版本。MS 的文档并没有说清楚。我可以通过反复试验来解决这个问题，但我宁愿不这样做。

更大的问题是：WSS / Search Server 安装的最佳实践是什么？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2009-05-27T20:49:49.140

也试试这个网站：

www.technotesblog.com/collaboration/upgrading-windows-sharepoint-services-wss-30-to-search-server-2008-express/

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-05-27T06:28:30.587

这些文件应该回答您的问题：

[从 Windows SharePoint Services 3.0 升级到 Search Server 2008](http://technet.microsoft.com/en-us/library/cc297193.aspx)

[计划部署 Search Server 2008 或 Search Server 2008 Express](http://technet.microsoft.com/en-us/library/cc298315.aspx)

# silverlight - Silverlight 的规则引擎？

> ID：913877
> 
> 赞同：0
> 
> 时间：2009-05-27T04:07:48.147
> 
> 标签：silverlight, silverlight-3.0, rule-engine

目前我正在使用 Silverlight 3.0 开发基于 Web 的应用程序。对于业务规则，我正在寻找一个对我和我的用户都易于使用的规则引擎，它可以与 SL3 一起使用。类似的东西是开箱即用的还是我需要自己推出？

我用谷歌搜索并查看了各种代码站点（Codeplex、代码项目等），但没有看到任何适合我需要的东西。

我也对 NxBRE 做了很长的了解，但它的规则语法对于“虚拟”用户来说太复杂了。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-05-27T04:42:31.697

Windows Workflow Foundation 附带的规则引擎怎么样？

[http://blogs.microsoft.co.il/blogs/bursteg/archive/2007/08/09/WF-Rules-Engine-without-Workflow.aspx](http://blogs.microsoft.co.il/blogs/bursteg/archive/2007/08/09/WF-Rules-Engine-without-Workflow.aspx)

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-06-25T23:27:41.590

对于偶然发现此线程并希望将 NxBRE 用作具有 Silverlight (SL) 的规则引擎的人，这是我的两分钱。

1.  我尝试在我的 SL 项目中引用 NxBRE dll，但没有成功。SL 不允许在 SL 项目中引用不是使用 SL CLR 构建的 dll。
2.  幸运的是，NxBRE 是一个开源项目，所以我下载了源文件以使用 SL CLR 构建它。
3.  SL 不支持很多 .NET 类型，即命名空间 System.Xml.XPath、System.Xml.XPath 等中的对象。这些是 NxBRE 编译所必需的。

所以我没有运气使用 NxBRE 和 SL。这些是我的第一印象，如果我通过深入挖掘发现更多，我会告诉你们。

希望这对那里的人有所帮助。

谢谢赛古迪贡德拉

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-06-01T20:48:37.130

我搜索了更多，并确定规则引擎实际上不能满足我们的要求。我们不需要规则，我们希望在该属性的值发生变化时对该属性进行计算。

谢谢你的回答，

干杯，弗朗西丝

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2009-07-29T22:56:51.203

对于那些可能感兴趣的人：最终我们[为 Silverlight 选择了 CSLA .Net](http://www.lhotka.net/cslalight/)

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2010-05-05T15:03:41.357

回到原来的规则引擎问题……

如果您想*在*Silverlight 中运行规则引擎，您需要找到一个已构建为仅使用 Silverlight 支持的有限 .NET 子集的引擎。例如，Silverlight 支持[泛型集合 (List)，但不支持无类型集合 (List)。](http://blogs.msdn.com/bclteam/archive/2007/06/25/bcl-refresher-converting-the-non-generic-collections-inbar-gazit.aspx)

目前，我不知道已经（重新）针对 Silverlight CLR 的 .NET 规则引擎。

此外，虽然客户端规则引擎有一些有趣的应用程序（例如：在浏览器或移动设备上），但应始终考虑规则引擎是否更适合托管在后端。考虑调用规则的频率、移动的数据量等。

# svn - 为什么站点会显示 SVN 版本，有什么优势？

> ID：913904
> 
> 赞同：9
> 
> 时间：2009-05-27T04:18:12.990
> 
> 标签：svn, version-control, versioning

到目前为止，我还没有使用过 SVN。为什么网站（例如 Stack Overflow）会在底部显示 SVN 版本？它是什么版本？在公共场合展示它有什么好处？

[替代文字 http://shobankr.googlepages.com/so.jpg](http://shobankr.googlepages.com/so.jpg)

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2009-05-27T04:20:00.157

因此，当用户抱怨时，支持人员可以问他它是什么版本。用户可能会看到问题，然后更新站点软件并且他的抱怨不再相关，因此开发人员将浪费时间尝试重现。

该数字是 SVN 修订号。它从零开始，并在 SVN 存储库的生命周期内随着每个源代码添加/更新而自动递增。知道这个数字，就很容易获得完全处于相应状态的完整源代码——存储库有一个方法。

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2009-05-27T04:40:31.167

在传统软件上，您有 1.0、1.1、2.0 等版本号，主要用于支持和营销目的。

在网站上，通常没有版本号的概念，因为它们通常比“传统”软件更频繁地更改。此外，有时只是“架构”更改，例如“这里稍加优化，那里稍作清理” - “传统”软件中也会发生更改，但通常不保证发布新版本（并增加版本从 1.0 到 1.0.1)

因此，StackOverflow 不只是每两天增加一些任意数字，而是决定使用其源代码控制中的修订号（即 Subversion，但每个源代码控制系统都有一些数字来识别签入）。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2009-05-27T04:19:54.757

它提供了一个简单、明确的版本号，而无需任意决定任何给定代码推送的版本。

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2009-05-27T04:56:47.103

发布修订号的另一个原因是帮助您进行测试。如果您正在跟踪错误或测试发布候选版本，显示修订号可以避免您对当前正在测试的版本感到困惑。

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2009-05-27T05:14:51.290

如果您使用 CruiseControl.Net，您可以使用以下命令将 .state 文件的 SVN 修订捕获：[http](http://code.google.com/p/svnrevisionlabeller/) ://code.google.com/p/svnrevisionlabeller/ 。

然后查询状态文件中的 XML 并将其显示在您想要的位置。

```
XDocument stateFileRoot = XDocument.Load("path-to-state-file");

var q = (from label in stateFileRoot.Descendants("Label")
         select (string)label).SingleOrDefault();

if (q != null)
{
    result = q.ToString().Substring(0, q.LastIndexOf(".")); // lop off last digit
    HttpContext.Current.Application["BuildLabel"] = result;
} 
```

（在这种情况下，我将其放入缓存中以便于访问和性能。）

# objective-c - 退出 NSThread

> ID：913905
> 
> 赞同：1
> 
> 时间：2009-05-27T04:19:34.553
> 
> 标签：objective-c, cocoa

如何在线程处于运行模式时退出线程......当我使用 NSThread 退出时，我的应用程序被挂起......任何人都可以帮助我吗？我可以在这里使用什么来退出线程或关闭线程

谢谢 这是我在这里的第一篇文章。

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2009-05-27T04:22:25.263

您正在寻找的例程是`return`.

当您启动它的函数完成时，线程将终止。您不需要终止 NSThread；它会自己处理。您只需要从函数调用中返回。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2016-06-10T04:10:24.930

我假设您正在寻找一种在启动线程后取消线程的方法。这一切都在设置中。这是一个例子：

*   (

    void) doCalculation{ /* 在这里进行计算 */ }

    *   (void)calculationThreadEntry{ NSAutoreleasePool *pool = [[NSAutoreleasePool alloc] init]; NSUInteger 计数器 = 0；while ([[NSThread currentThread] isCancelled] == NO){ [self doCalculation]; 计数器++；如果（计数器 >= 1000）{ 中断；} } [池释放]; } 应用程序：（UIApplication *）应用程序
    *   (BOOL) didFinishLaunchingWithOptions:(NSDictionary *)launchOptions{ /*启动线程 */ [NSThread detachNewThreadSelector:@selector(calculationThreadEntry) toTarget:self withObject:nil]; // 应用程序启动后自定义的覆盖点。[self.window makeKeyAndVisible]; 返回是；}

在此示例中，循环的条件是线程处于非取消状态。

# python - 对 urllib2.urlopen() 返回的类文件对象使用轮询？

> ID：913913
> 
> 赞同：0
> 
> 时间：2009-05-27T04:22:12.390
> 
> 标签：python, python-2.6

我在尝试轮询 urllib2.urlopen() 返回的类文件对象时遇到了[http://bugs.python.org/issue1327971中描述的错误。](http://bugs.python.org/issue1327971)

不幸的是，对于 Python 来说相对较新，我实际上无法从响应中确定如何解决这个问题，因为它们似乎主要是为了修复错误，而不是破解触发它工作的代码。

这是我的代码的提炼版本，它会引发错误：

```
import urllib2, select

if __name__ == "__main__":
    p = select.poll()
    url = "http://localhost/"
    fd = urllib2.urlopen(url)
    p.register(fd, select.POLLIN | select.POLLERR | select.POLLHUP | select.POLLNVAL)

    result = p.poll()
    for fd, event in result:
        if event == select.POLLIN:
            while 1:
                buf = fd.read(4096)
                if not buf:
                    break
                print buf 
```

当我在 python 2.6 上运行它时引发的错误：

```
Traceback (most recent call last):
  File "/home/shab/py/test.py", line 9, in <module>
    p.register(fd, select.POLLIN | select.POLLERR | select.POLLHUP | select.POLLNVAL)
  File "/usr/lib/python2.6/socket.py", line 287, in fileno
    return self._sock.fileno()
AttributeError: HTTPResponse instance has no attribute 'fileno' 
```

更新：我不想修改系统库。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-05-27T04:56:09.537

如果您不想修改系统库，您也可以`httplib`即时修补以匹配错误报告中的补丁：

```
import httplib

@property
def http_fileno(self):
   return self.fp.fileno

@http_fileno.setter
def http_fileno(self, value):
   self.fp.fileno = value

httplib.HTTPResponse.fileno = http_fileno

# and now on with the previous code
# ... 
```

然后您会收到一个错误，`fd.read(4096)`因为`fd`返回的`poll`是原始文件描述符值，而不是类似文件的对象。您可能需要使用原始文件对象来读取数据，而不是 poll 返回的值。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-05-27T04:29:08.537

看起来你想用[这个补丁](http://bugs.python.org/file13033/urllib_fileno_2.diff)修改 urllib 。请记住，此代码尚未发布是有原因的。它还没有被完全审查。

编辑：实际上，我想你想用[另一个补丁](http://bugs.python.org/file13032/httplib_fileno_2.diff)修改 httplib 。

# java - 参数化测试的解决方案

> ID：913928
> 
> 赞同：1
> 
> 时间：2009-05-27T04:30:36.950
> 
> 标签：java, unit-testing, junit

我熟悉 JUnit 中参数化测试的使用，例如：

[http://junit.org/apidocs/org/junit/runners/Parameterized.html](http://junit.org/apidocs/org/junit/runners/Parameterized.html)

但我想知道是否有任何替代（可能更好）的方法来处理外部定义的测试数据。我真的不想在我的源文件中硬编码我的测试数据——我更喜欢用 XML 或某种其他结构化方式来定义它。

是否有一个特定的框架或对一个框架的扩展，它为我提供了比标准 JUnit 方法更好的解决方案。你找到的最好的方法是什么？

编辑：我熟悉 FIT 框架及其在这种情况下的使用，如果可能的话，我想避免这种情况。如果有 JUnit 扩展或类似框架提供比 TestNG 更好的解决方案，请告诉我。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-05-27T04:33:31.200

您可以为此尝试[依赖注入或控制反转。](http://en.wikipedia.org/wiki/Dependency_injection)[Spring 框架](http://en.wikipedia.org/wiki/Spring_Framework)就是这样做的。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-05-27T06:01:19.053

所以我找到了 TestNG 的方法，它允许你为测试指定参数，更多信息在这里：

[http://testng.org/doc/documentation-main.html#parameters-testng-xml](http://testng.org/doc/documentation-main.html#parameters-testng-xml)

这方面的一个例子是：

```
@Parameters({ "first-name" })
@Test
public void testSingleString(String firstName) { 
  System.out.println("Invoked testString " + firstName);
  assert "Cedric".equals(firstName);
} 
```

和：

```
<suite name="My suite">
  <parameter name="first-name"  value="Cedric"/>
  <test name="Simple example"> 
```

您还可以使用数据源（例如 Apache Derby）来指定此测试数据，但我想知道这是多么灵活的解决方案。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-06-02T15:47:12.540

在参数化测试示例中，我没有看到任何需要您将数据存储在类本身中的内容。使用从 xml 文件中提取数据并返回 Object[][] 的方法，并在示例中使用静态代码的地方调用该方法。如果你想切换TestNG，当然他们已经为你写了一个XML解析器。看起来[JUnitExt](http://junitext.sourceforge.net/tutorial.html)也为 JUnit 4 提供了一个，或者您可以自己编写一个。

# html - 在 IE7-8 中出现在背景图片后面的网站徽标

> ID：913930
> 
> 赞同：0
> 
> 时间：2009-05-27T04:32:07.170
> 
> 标签：html, css

我网站的标志在Firefox等中正常显示，但在Internet Explorer中，标志出现在背景图像后面，看起来很糟糕。有人可以告诉我如何使徽标出现在背景图像的前面吗？

像这样的网站，你可以看看编码：http: [//turquoisegrotto.com/](http://turquoisegrotto.com/)

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-05-27T05:03:28.457

你写了一些古怪的 CSS，所有的负边距是怎么回事？我会远离那些东西，不知道为什么你的#navi 也有 120px 的高度，（以及所有的 -margins）。

尽管如此，IE 没有理由在主体的背景图像后面放置一个标志！那肯定很奇怪。

无论如何，这些变化将把标志带回身体的神奇世界：

```
body {
    background-color: #CCFFFF;
    color: #000000; 
    font-family: Tahoma; 
    text-align: center;       
    background-image:url("images/bg.png");
    background-position: top left;
    background-repeat: repeat-x;

    /* changed */
    margin-top: 0;
}

#navi{
    width: 100%;
    background-color: transparent; 
    text-align: left;

    /* changed */
    margin-top: 3px;
    height: 20px;
}

#logo{
    height: 120px; 
    background-color: transparent; 
    margin-bottom: 70px; 
    /* changed */
    margin-top: 5px;
} 
```

我确信您的其他元素将需要调整，因为徽标和导航不再有很大的负边距。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-05-27T05:09:27.660

摆脱所有古怪的 * 选择器，添加严格的 DOCTYPE 并重试。徽标不在背景后面，它在屏幕外的某个地方。

编辑：你有一个 DOCTYPE，去掉上面的评论。DOCTYPE 必须在第一行。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-05-27T04:54:19.867

尝试将徽标图像的 z-index（CSS 属性）设置为 10。

# oracle - Oracle 日期舍入

> ID：913932
> 
> 赞同：3
> 
> 时间：2009-05-27T04:32:32.820
> 
> 标签：oracle

这个电话——

`SELECT ((TO_DATE ('06/06/2009 16:00:00', 'DD/MM/YYYY HH24:MI:SS') - TO_DATE ('06/06/2009 14:25:00', 'DD/MM/YYYY HH24:MI:SS')) * 1440.000) from dual`

产生 95 的结果 - 这是您对计算的期望。

这个电话——

`SELECT trunc((TO_DATE ('06/06/2009 16:00:00', 'DD/MM/YYYY HH24:MI:SS') - TO_DATE ('06/06/2009 14:25:00', 'DD/MM/YYYY HH24:MI:SS')) * 1440.000) from dual`

产生 94 的结果。

建议的修复是 - `SELECT trunc((TO_DATE ('06/06/2009 16:00:00', 'DD/MM/YYYY HH24:MI:SS') - TO_DATE ('06/06/2009 14:25:00', 'DD/MM/YYYY HH24:MI:SS')) * 1440.000+.00001) from dual`

这个解决方案对我来说似乎是错误的 - 任何人都可以提出更好的选择吗？实际要求是计算两个日期之间的整分钟差异。

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2009-05-27T06:29:43.487

很好的问题。

由于此处的数据类型转换，日期算术并不完全准确。

```
TO_DATE('06/06/2009 16:00:00', 'DD/MM/YYYY HH24:MI:SS')
- TO_DATE('06/06/2009 14:25:00', 'DD/MM/YYYY HH24:MI:SS'))
= .0659722222222222222222222222222222222222000000000000000 
```

但

```
.0659722222222222222222222222222222222222000000000000000
* 1440
=94.9999999999999999999999999999999999999700000000000 
```

这意味着 TRUNC、ROUND、CEIL 和 FLOOR 都不能在所有情况下工作。

要解决此问题，您需要能够在对其进行算术运算之前将每个日期转换为整数，例如：

```
select FLOOR((TO_CHAR(TO_DATE('06/06/2009 16:00:00', 'DD/MM/YYYY HH24:MI:SS'),'J') * 1440
+ TO_CHAR(TO_DATE('06/06/2009 16:00:00', 'DD/MM/YYYY HH24:MI:SS'),'SSSSS') / 60)
- (TO_CHAR(TO_DATE('06/06/2009 14:25:00', 'DD/MM/YYYY HH24:MI:SS'),'J') * 1440
+ TO_CHAR(TO_DATE('06/06/2009 14:25:00', 'DD/MM/YYYY HH24:MI:SS'),'SSSSS') / 60))
from dual; 
```

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2009-05-27T06:49:26.510

忘记日期并使用时间戳。使用时间戳算法，Oracle 使用 INTERVAL 数据类型来避免舍入问题。

```
select extract (minute from cast(later as timestamp) - cast(earlier as timestamp)) +
       (extract (hour from cast(later as timestamp) - cast(earlier as timestamp)) * 60)
from
(select TO_DATE ('06/06/2009 16:00:00', 'DD/MM/YYYY HH24:MI:SS') later,
       TO_DATE ('06/06/2009 14:25:00', 'DD/MM/YYYY HH24:MI:SS') earlier
from dual)
/ 
```

If the dates are more than a day apart, you'll need to add in consideration for that too.

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-05-27T04:44:13.100

为什么不使用`ROUND`代替`TRUNC`？它在应用于日期时为您提供最接近日期的结果，当应用于数字时为您提供最接近的整数（`TRUNC`截断，并且似乎在这里遇到了奇怪的算术问题）。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2009-05-27T05:56:28.033

好吧，并不是说它应该更好，但是您尝试过 FLOOR 代替 TRUNC 吗？（如果它确实有效，您可能想要测试结果是否为负，在这种情况下，您需要添加一个，因为 FLOOR “四舍五入”为负无穷大，而 TRUNC 则四舍五入为零。这可能或可能不要比在使用 TRUNC 之前增加几分之一秒更难看。）

# python - 在python中解码html编码的字符串

> ID：913933
> 
> 赞同：1
> 
> 时间：2009-05-27T04:32:50.747
> 
> 标签：python, html, xml

我有以下字符串...

```
"Scam, hoax, or the real deal, he&#8217;s gonna work his way to the bottom of the sordid tale, and hopefully end up with an arcade game in the process." 
```

我需要把它变成这个字符串......

> 骗局、恶作剧或真正的交易，他将努力追查这个肮脏故事的底部，并希望在此过程中以一款街机游戏告终。

这是非常标准的 HTML 编码，我一生都无法弄清楚如何在 python 中转换它。

我发现了这个： [GitHub](http://github.com/sku/python-twitter-ircbot/blob/321d94e0e40d0acc92f5bf57d126b57369da70de/html_decode.py)

它非常接近工作，但是它不输出撇号，而是输出一些非 unicode 字符。

这是 GitHub 脚本的输出示例...

> 骗局、恶作剧或真正的交易，他将努力追查这个肮脏故事的底部，并希望在此过程中以一款街机游戏告终。

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2009-05-27T04:49:52.833

您正在尝试做的事情称为“HTML 实体解码”，它在过去的许多 Stack Overflow 问题中都有介绍，例如：

*   [如何在 Python 中转义撇号等？](https://stackoverflow.com/questions/816272/how-to-unescape-apostrophes-and-such-in-python)
*   [使用 Python 解码 HTML 实体](https://stackoverflow.com/questions/628332/decoding-html-entities-with-python)

[这是使用Beautiful Soup](http://www.crummy.com/software/BeautifulSoup/) HTML 解析库来解码您的示例的代码片段：

```
#!/usr/bin/env python
# -*- coding: utf-8 -*-
from BeautifulSoup import BeautifulSoup

string = "Scam, hoax, or the real deal, he&#8217;s gonna work his way to the bottom of the sordid tale, and hopefully end up with an arcade game in the process."
s = BeautifulSoup(string,convertEntities=BeautifulSoup.HTML_ENTITIES).contents[0]
print s 
```

这是输出：

> 骗局、恶作剧或真正的交易，他将努力追查这个肮脏故事的底部，并希望在此过程中以一款街机游戏告终。

# c - 任务的 UML 表示

> ID：913936
> 
> 赞同：0
> 
> 时间：2009-05-27T04:33:43.557
> 
> 标签：c, task, uml, rtos

我正在设计具有许多任务和许多任务间消息的系统。该系统将基本上用C语言开发。

在我的设计中，我尝试使用 UML 表示来显示在任务之间传递的消息。但是，代表决策等事情变得越来越困难。

他们是否有任何预定义的方法来为使用大量消息的基于任务的系统创建流程图？

不必是UML，他们还有什么其他标准方法可以用于这个设计吗？

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2009-06-10T20:58:54.303

对于记录消息流，我发现状态机和序列图各有其用处。状态机更擅长描述改变系统状态的决策。序列图更擅长描述实现协议特定元素的消息。

因为无论如何我都喜欢使用[Doxygen](http://www.doxygen.org/)进行内部文档，并且它喜欢使用[GraphViz 工具 dot](http://www.graphviz.org/)绘制调用图和其他图形，所以我开始使用 dot 来记录我的状态机。由于 Doxygen 的语法可以直接在源代码中包含点语言（甚至允许从绘图中的元素到生成的文档的其他页面的超链接），这非常方便。[最近，Doxygen 增加了对用mscgen](http://www.mcternan.me.uk/mscgen/)表示的序列图的明确支持，允许使用两种样式的图。

与在 Visio 或其他绘图工具中外部绘制的情况相比，直接在源代码中以合理自然的方式表达图形使它们更有可能被维护。

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2009-05-27T04:39:18.547

也许您需要[状态机](http://en.wikipedia.org/wiki/Finite_state_machine)或[序列图](http://en.wikipedia.org/wiki/Sequence_diagram)。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2009-05-27T05:28:18.773

如果您在 UML 中表示您的设计，请尝试使用名为 Umbrello 的软件。这为您提供了很大的灵活性来表示您的设计

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2012-12-11T13:10:29.933

使用带有 MARTE 的序列图或状态机图（用于实时嵌入式系统建模和分析的 UML 配置文件）注释，因为我注意到您正在使用实时操作系统

# exception - 生成Javadoc时出现BufferOverflowException？

> ID：913937
> 
> 赞同：2
> 
> 时间：2009-05-27T04:33:56.020
> 
> 标签：exception, unicode, javadoc, buffer-overflow

有没有人遇到过导致 java.nio.BufferOverflowException 的 javadoc 工具问题？

我正在尝试为带有日语注释（字符集 MS932）的代码生成 Javadoc。我认为这可能是相关的。有人知道这个问题的解决方法吗？

这是堆栈跟踪：

```
java.nio.BufferOverflowException
at java.nio.Buffer.nextPutIndex(Buffer.java:495)
at java.nio.HeapCharBuffer.put(HeapCharBuffer.java:145)
at com.sun.tools.javac.util.DefaultFileManager.decode(DefaultFileManager.java:830)
at com.sun.tools.javac.util.DefaultFileManager.access$300(DefaultFileManager.java:76)
at com.sun.tools.javac.util.DefaultFileManager$RegularFileObject.getCharContent(DefaultFileManager.java:1353)
at com.sun.tools.javac.util.DefaultFileManager$RegularFileObject.getCharContent(DefaultFileManager.java:1252)
at com.sun.tools.javac.main.JavaCompiler.readSource(JavaCompiler.java:483)
at com.sun.tools.javac.main.JavaCompiler.parse(JavaCompiler.java:550)
at com.sun.tools.javac.main.JavaCompiler.parse(JavaCompiler.java:541)
at com.sun.tools.javadoc.JavadocTool.getRootDocImpl(JavadocTool.java:126)at com.sun.tools.javadoc.Start.parseAndExecute(Start.java:330)
at com.sun.tools.javadoc.Start.begin(Start.java:128)
at com.sun.tools.javadoc.Main.execute(Main.java:41)
at com.sun.tools.javadoc.Main.main(Main.java:31) 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-07-24T13:27:22.723

我的猜测是字符编码设置不正确。

# windows - 当值仅使用默认名称时，如何在 Inno Setup 中获取注册表值？

> ID：913938
> 
> 赞同：11
> 
> 时间：2009-05-27T04:35:16.693
> 
> 标签：windows, registry, inno-setup, pascal

我正在尝试使用 Inno Setup 的 Pascal 脚本从 Windows 注册表（在本例中为 Google Sketchup）获取应用程序的安装目录，以便我可以在那里安装插件。

注册表项没有名称，它在 Regedit 中只有“（默认）”。

我试过这个：

```
RegQueryStringValue( HKLM, 'SOFTWARE\Google\Google Sketchup 6', '(Default)', pluginLoc ); 
```

但它不返回值。有什么建议么？

* * *

## 回答 #1

> 赞同：19
> 
> 时间：2009-05-28T05:17:43.640

只留下`SubKeyName`空的，像这样：

```
[Code]
function InitializeSetup(): Boolean;
var
  V: string;
begin
  if RegQueryStringValue(HKLM, 'SOFTWARE\Google\Google Sketchup 6', '', V) then
    MsgBox('Value is "' + V + '"', mbInformation, MB_OK);
  Result := TRUE;
end; 
```

底层 API 调用的匹配文档适用于*[RegQueryValueEx()](http://msdn.microsoft.com/en-us/library/ms724911(VS.85).aspx)*，其中指出：

> 注册表值的名称。
> 
> 如果 lpValueName 为 NULL 或空字符串“”，则函数检索键的未命名或默认值（如果有）的类型和数据。

# language-agnostic - 什么是 NOR 逻辑运算符？

> ID：913941
> 
> 赞同：4
> 
> 时间：2009-05-27T04:36:15.147
> 
> 标签：language-agnostic, logic, boolean

*也不*是：

!(a 或 b)
!a 或 !b
!(a 和 b)

别的东西？

* * *

## 回答 #1

> 赞同：16
> 
> 时间：2009-05-27T04:37:59.610

!(a 或 b)

有关更多信息，请参见[http://en.wikipedia.org/wiki/Logical_NOR](http://en.wikipedia.org/wiki/Logical_NOR)：

> 在[布尔逻辑](https://en.wikipedia.org/wiki/Boolean_logic)中，**逻辑或**或**联合否定**是一个真值函数运算符，它产生的结果是[逻辑或](https://en.wikipedia.org/wiki/Logical_disjunction)的否定。也就是说，当 p 和 q 都不为真时——即当*p*和*q*都为假时，形式为 ( *p* NOR *q ) 的句子为真。*在[语法](https://en.wikipedia.org/wiki/Grammar)中，并列[连词](https://en.wikipedia.org/wiki/Grammatical_conjunction)**也不**是...

 ***** * *

## 回答 #2

> 赞同：10
> 
> 时间：2009-05-27T04:39:00.280

[!(a 或 b)](http://en.wikipedia.org/wiki/Logical_NOR)

* * *

## 回答 #3

> 赞同：8
> 
> 时间：2009-05-27T04:42:34.257

`NOR(a, b)`被定义`NOT(OR(a, b))`为`!(a or b)`中缀符号。根据[德摩根定律](http://en.wikipedia.org/wiki/De_Morgan%27s_Laws)，这也相当于`(!a) and (!b)`。

* * *

## 回答 #4

> 赞同：5
> 
> 时间：2009-05-27T04:38:12.463

你的第一个选择：`!`（a或b）

这恰好相当于 !a 和 !b

* * *

## 回答 #5

> 赞同：5
> 
> 时间：2009-05-27T04:47:39.917

`((a NAND a) NAND (b NAND b)) NAND ((a NAND a) NAND (b NAND b))`如果您想对电路制造友好。:)

# javascript - 如何在客户端 C# 应用程序中模拟 JavaScript

> ID：913948
> 
> 赞同：4
> 
> 时间：2009-05-27T04:38:35.147
> 
> 标签：javascript, simulation, simulate

我正在编写一个网络爬虫（网络蜘蛛）来爬取网站中的所有链接。我的应用程序是一个 Win32 应用程序，用 C# 和 .Net framework 3.5 编写。现在我正在使用 HttpWebRequest 和 HttpWebResponse 与 Web 服务器进行通信。我还构建了自己的 Http Parser，它可以解析任何我想要的东西。我在解析中找到了像“href”、“src”、“action”这样的所有链接。但是我不能解决一个问题：在页面中模拟客户端脚本（如JS和VBS）例如，如果一个链接像：

a href = "javascript:buildLink(1)"

... with buildLink(parameter) 是一个 Javascript 函数，它将根据参数创建自定义链接。

请帮我解决这个问题。如何在这个应用程序中模拟 JavaScript？我可以解析 HTML 源代码并将所有 JavaScript 代码放到另一个文件中，但是如何模拟它的功能呢？谢谢。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2009-05-27T04:53:58.103

你基本上是在假装自己是一个浏览器，除了 HttpWebRequest 只为你做网络工作。

我建议使用 ie Web 浏览器控件并从您的 c# 应用程序中互操作。这将允许您运行 JavaScript、设置变量、发布等。

这是我在搜索“ie web browser control”后找到的一些基本链接：

[http://www.c-sharpcorner.com/UploadFile/mahesh/WebBrowserInCSMDB12022005001524AM/WebBrowserInCSMDB.aspx](http://www.c-sharpcorner.com/UploadFile/mahesh/WebBrowserInCSMDB12022005001524AM/WebBrowserInCSMDB.aspx) [http://support.microsoft.com/kb/313068](http://support.microsoft.com/kb/313068)

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2009-05-27T05:12:28.953

您唯一真正的选择是自动化浏览器。正如其他答案所说，如果没有完整的 DOM，您将无法可靠地模拟浏览器 javascript。

幸运的是，有一些方法可以使浏览器自动化，请查看[Selenium](http://seleniumhq.org/)。

它有一个[C# API](http://seleniumhq.org/about/platforms.html#programming-languages)，因此您可以从 C# 控制浏览器。

使用您的 .NET 网络爬虫代码来爬取站点。每当您遇到`href="javascript:...`链接时，请在 Selenium 中处理包含该链接的页面：

1.  使用 Selenium API 告诉浏览器加载页面。
2.  使用 Selenium API 查找页面上的所有链接。

这样，您的蜘蛛仅在必要时使用 Selenium（没有 javascript 链接的页面可以由您已经获得的无浏览器蜘蛛代码处理）。而且由于这是一个[令人尴尬的并行](http://en.wikipedia.org/wiki/Embarrassingly_parallel)工作负载，您可以轻松地同时运行多个 Selenium 进程（在一台计算机或其他计算机上）。

但请记住，这`href="javascript`并不是页面可以拥有动态链接的唯一方式。更常见的情况可能是 a `onload`or`$(document).ready()`脚本操作 DOM 并以这种方式添加链接。

为了捕捉这种情况（和其他情况），蜘蛛可能必须对所有具有`<script>`标签的页面使用 Selenium。

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2009-05-27T04:49:23.003

这是一个不容易解决的问题。您可以考虑采用现有的 JavaScript 实现之一，并以某种方式移植或与之交互。

如果我要解决这个问题，我可能会在[Rhino](http://www.mozilla.org/rhino/)之上用 Java 构建一个小型的侧应用程序，并在其上分层一些 RPC 框架，以便我可以从我的主应用程序与其通信。

不幸的是，如果没有完整的 DOM 实现，您将只能使用非常简单的 javascript。

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2009-05-27T05:07:48.597

[您可以使用 MS JScript 引擎](http://www.west-wind.com/WebLog/posts/10688.aspx)或类似的东西来执行 javascript 。

*   [MSDN 参考](http://msdn.microsoft.com/en-us/library/microsoft.jscript.eval.jscriptevaluate.aspx)
*   [Eric Lippert 关于使用 Eval 的博客（第 1 部分）](http://blogs.msdn.com/ericlippert/archive/2003/11/01/53329.aspx)（[第 2 部分](http://blogs.msdn.com/ericlippert/archive/2003/11/04/53335.aspx)）（[第 3 部分](http://blogs.msdn.com/ericlippert/archive/2004/01/26/63087.aspx)）

这不能保证有效，特别是如果 javascript 尝试访问[DOM](http://en.wikipedia.org/wiki/Document_Object_Model)或类似的......但对于简单的脚本，这可能就足够了。

# ssh - 如何防止 ssh-keygen 在公钥中使用我的登录名和计算机名？

> ID：913958
> 
> 赞同：25
> 
> 时间：2009-05-27T04:41:28.233
> 
> 标签：ssh, customization

我`ssh-keygen`在 OS X 上运行，当我显示生成的公钥时，我看到我的登录名和机器名出现在密钥的最后一部分。有没有办法让它使用不同的值或根本不使用它？

* * *

## 回答 #1

> 赞同：27
> 
> 时间：2009-05-27T06:06:52.697

从手册页'ssh-keygen(1)'：

```
对于 RSA1 密钥，密钥文件中还有一个注释字段，仅用于
方便用户帮助识别钥匙。评论可以说明什么
关键是为了，或者任何有用的东西。评论初始化为“user@host”
创建密钥时，但可以使用 -c 选项进行更改。
…
-C 评论
        提供新评论。

-c 请求更改私钥和公钥文件中的注释。这
        仅 RSA1 密钥支持操作。程序会提示
        包含私钥的文件，如果密钥有密码短语
        一，对于新的评论。

```

因此，在创建`-C "$desiredcommenttext"`用于提供您喜欢的任何评论文本的密钥时；或对于现有密钥，使用`-c`选项更改注释。

* * *

## 回答 #2

> 赞同：7
> 
> 时间：2009-05-27T04:43:45.237

是的！根本不需要它，它只是任意附加，以便您轻松记住它的来源。如果要编辑它，只需打开终端会话并键入：

```
$ nano ~/.ssh/id_rsa.pub 
```

删除行的结尾部分（在双等号之后）。

# javascript - 用于 RESTful PUT/DELETE 链接的 DRY jQuery

> ID：913959
> 
> 赞同：2
> 
> 时间：2009-05-27T04:41:28.843
> 
> 标签：javascript, jquery, rest

我正在将 PUT/DELETE 链接放在一起，一个 la Rails，当单击它时创建一个带有隐藏输入的 POST 表单，标记为 _method 发送预期的请求类型。我想让它更干燥，但我的 jQuery 知识达不到它的要求。

HTML：

```
<a href="/articles/1" class="delete">Destroy Article 1</a>
<a href="/articles/1/publish" class="put">Publish Article 1</a> 
```

jQuery：

```
$(document).ready(function() {

  $('.delete').click(function() {
    if(confirm('Are you sure?')) {
      var f = document.createElement('form');
      $(this).after($(f).attr({
        method: 'post',
        action: $(this).attr('href')
      }).append('<input type="hidden" name="_method" value="DELETE" />'));
      $(f).submit();
    }
    return false;
  });

  $('.put').click(function() {
    var f = document.createElement('form');
    $(this).after($(f).attr({
      method: 'post',
      action: $(this).attr('href')
    }).append('<input type="hidden" name="_method" value="PUT" />'));
    $(f).submit();
    return false;
  });

}); 
```

* * *

## 回答 #1

> 赞同：8
> 
> 时间：2009-05-27T04:57:09.100

好的，所以我终于测试了这个。它做了它在盒子上声称的事情。

```
$(document).ready(function() {

  $.fn.getClassInList = function(list){
       for(var i = 0; i < list.length; i++)
       {
          if($(this).hasClass(list[i]))
             return list[i];
       }
       return "";
  }

  $('.delete,.put').click(function() {
    if(confirm('Are you sure?')) {
      var f = document.createElement('form');
      $(this).after($(f).attr({
        method: 'post',
        action: $(this).attr('href')
      }).append('<input type="hidden" name="_method" value="' 
            + $(this).getClassInList(['put', 'delete']).toUpperCase() 
            + '" />'));
      $(f).submit();
    }
    return false;
  });

}); 
```

* * *

## 回答 #2

> 赞同：5
> 
> 时间：2009-05-27T05:30:10.660

如果您想使用 ajax，您可以只使用表单而不是链接，并让[jQuery 表单插件处理提交：](http://www.malsup.com/jquery/form/)

```
<form class="delete" method="post" action="/articles/1">
    <input type="hidden" name="_method" value="delete"/>
    <button type="submit">Delete</button>
</form> 
```

jQuery：

```
$(document).ready(function() {
    $('form.delete').ajaxForm(options);
}); 
```

options 变量可以包含提交前和提交后的回调。

如果您需要的话，可以像链接一样设置按钮的样式。

* * *

## 回答 #3

> 赞同：-1
> 
> 时间：2009-05-27T06:31:22.920

我刚刚测试了以下内容，它对我有用：

```
$(function() {
  $('.post, .POST').click(function() {
    $('<form method="POST" style="display:none"><input type="hidden" name="_method" value="POST" /></form>')
      .insertAfter($(this))
      .attr({
        action: $(this).attr('href')
      }).submit();
    return false;
  });
  $('.put, .PUT').click(function() {
    $('<form method="POST" style="display:none"><input type="hidden" name="_method" value="PUT" /></form>')
      .insertAfter($(this))
      .attr({
        action: $(this).attr('href')
      }).submit();
    return false;
  });
  $('.delete, .DELETE').click(function() {
    if(confirm('Are you sure?')) {
      $('<form method="POST" style="display:none"><input type="hidden" name="_method" value="DELETE" /></form>')
        .insertAfter($(this))
        .attr({
          action: $(this).attr('href')
        }).submit();
    }
    return false;
  });
}); 
```

你有什么样的问题？

* * *

## 回答 #4

> 赞同：-2
> 
> 时间：2009-05-27T05:02:14.013

忘记您的隐藏字段，只需更改放置或删除的方法。我会选择表单而不是创建它，然后只需更改属性

$("form").attr("method", "put").submit()

# php - 如何让 PHP 显示今天的日期？

> ID：913965
> 
> 赞同：0
> 
> 时间：2009-05-27T04:43:21.900
> 
> 标签：php, function, date, variables

我正在向自己发送邮件功能。

我的第一行是'Order for $name on $date' $name 变量来自用户填写的表格。我希望 $date 变量是今天的日期，无论那天是什么。

如何使 $date 变量显示今天的日期？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-05-27T04:45:45.813

[http://us3.php.net/manual/en/function.date.php](http://us3.php.net/manual/en/function.date.php) date() 函数可以做到这一点。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-05-27T04:46:49.697

```
$date = date('m/d/Y'); 
```

有关 date() 的语法，请参见[http://en.php.net/manual/en/function.date.php](http://en.php.net/manual/en/function.date.php)

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-05-27T04:47:07.670

这会将今天的[日期](http://us3.php.net/manual/en/function.date.php)放在一个字符串中，所有这些都准备好被卡入数据库:)。

```
$todays_date_string = date("Y-m-d H:i:s"); 
```

# latex - 如何使用 Latex Beamer 在多张幻灯片中拆分目录？

> ID：913966
> 
> 赞同：46
> 
> 时间：2009-05-27T04:43:33.740
> 
> 标签：latex, beamer

我目前正在为演示准备一些幻灯片，并且正在使用带有 Beamer 包的 Latex。目前，我的演示文稿的部分和小节导致目录幻灯片中的演示文稿概述文本超出页面底部。

有没有办法拆分我的目录，以便它们显示在多张幻灯片中？

* * *

## 回答 #1

> 赞同：62
> 
> 时间：2009-05-27T04:54:18.197

```
\begin{frame}[allowframebreaks]{Outline} 
```

上面的代码将跨多张幻灯片拆分任何悬垂。

* * *

## 回答 #2

> 赞同：13
> 
> 时间：2010-04-19T19:14:30.620

你也可以试试：

```
\begin{frame}[shrink]{Outline} 
```

以上将尝试缩小内容以适应框架边距。

* * *

## 回答 #3

> 赞同：13
> 
> 时间：2011-03-23T19:25:29.337

您可以将演示文稿分成几部分

```
\part{1} .... \part{n} 
```

然后你可以在另一张幻灯片上显示每个部分的目录

```
\tableofcontents[part=1] 
```

如果你使用

```
\tableofcontents[currentsection] 
```

只会显示零件的目录...

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2021-09-22T10:14:27.060

如果您手动拆分目录，您可以更精细地控制选择一个好的断点：

```
\documentclass{beamer}

\begin{document}

\begin{frame}
  \only<1>{\tableofcontents[sections={1-4}]}
  \only<2>{\tableofcontents[sections={5-}]} 
\end{frame} 

\section{title1}
\begin{frame}
content...
\end{frame}
\section{title2}
\begin{frame}
content...
\end{frame}
\section{title3}
\begin{frame}
content...
\end{frame}
\section{title4}
\begin{frame}
content...
\end{frame}
\section{title5}
\begin{frame}
content...
\end{frame}
\section{title6}
\begin{frame}
content...
\end{frame}
\section{title7}
\begin{frame}
content...
\end{frame}
\section{title8}
\begin{frame}
content...
\end{frame}

\end{document} 
```

# c++ - 对双端队列中的迭代器失效感到困惑

> ID：913980
> 
> 赞同：14
> 
> 时间：2009-05-27T04:47:15.470
> 
> 标签：c++, stl, standards, deque

我对双端队列中的迭代器失效感到有点困惑。（在[这个](https://stackoverflow.com/questions/913070/why-does-pushback-or-pushfront-invalidate-a-deques-iterators)问题的背景下）

以下是摘自 -- The C++ Standard Library: A Tutorial and Reference，作者 Nicolai M. Josuttis

> **除**开头或结尾之外的任何元素的插入或删除 都会使引用双端队列元素的所有指针、引用和迭代器无效。

[以下是SGI](http://www.sgi.com/tech/stl/Deque.html)网站的摘录：

> deque 的迭代器失效语义如下。Insert（包括`push_front`and `push_back`）使所有引用双端队列的迭代器无效。在双端队列中间进行擦除会使所有引用该双端队列的迭代器无效。仅当迭代器指向被擦除的元素时，在双端队列（包括`pop_front`and ）的开头或结尾进行 擦除才会使迭代器无效。`pop_back`

恕我直言，双端队列是块的集合，第一个块在一个方向上增长，最后一个块在相反方向上增长。

```
 -   -  -  
  -   -  -
  |   -  -  ^
  |   -  -  |
  V   -  -  |
      -  -  -
      -  -  - 
```

`push_back, push_front`不应该对双端队列迭代器产生任何影响（我同意 Josuttis 的观点）。

正确的解释是什么？标准对此有何评论？

* * *

## 回答 #1

> 赞同：13
> 
> 时间：2009-05-27T05:06:22.653

来自[标准工作草案](http://www.open-std.org/jtc1/sc22/wg21/docs/papers/2005/n1905.pdf)

> 模板<class InputIterator> void insert(迭代器位置, InputIterator first, InputIterator last);
> 
> 1 效果：双端队列中间的插入使所有迭代器和对双端队列元素的引用无效。在双端队列的任何一端插入都会使双端队列的所有迭代器无效，但对双端队列元素引用的有效性没有影响。”

所以两者都是正确的。正如 Josuttis 所指出的，在前面或后面的插入不会使对双端队列元素的引用无效，只会使*双端队列本身*的迭代器无效。

编辑：[更新的草案](http://www.open-std.org/jtc1/sc22/wg21/docs/papers/2008/n2798.pdf)基本上说同样的话（第 23.2.2.3 节）

* * *

## 回答 #2

> 赞同：12
> 
> 时间：2013-01-05T14:31:23.027

> 恕我直言，双端队列是块的集合，第一个块在一个方向上增长，最后一个块在相反方向上增长。

你的意见是你的特权，但这是错误的。:)

`deque`*语义*上就是这样一个容器，但就实现而言，它被设计为由一个或多个内存块实现。[C++ 的迭代器失效规则](https://stackoverflow.com/a/6442829/560648)来自实现，所以这就是原因。可以说这是一个小的抽象泄漏，但是，无论如何。

SGI STL 文档不是适合阅读的文档，因为[SGI STL 不是 C++ 标准库](https://stackoverflow.com/q/5205491/560648)。不幸的是，Josuttis 是那些称其为“STL”的人之一，这导致了您的困惑。

* * *

> 以下是摘自 -- The C++ Standard Library: A Tutorial and Reference，作者 Nicolai M. Josuttis
> 
> > **除**开头或结尾之外的任何元素的插入或删除都会使引用双端队列元素的所有指针、引用和迭代器无效。

简而言之，Josuttis 的这段话具有*误导性*，暗示插入或删除位于开头或结尾的*元素**不会*使指针、引用或迭代器无效……尽管值得注意的是，他从未站出来直接断言这一点。

* * *

以下是真正的、适当的、官方的规则`std::deque`：

## C++03

*   **插入**：所有迭代器和引用都无效，除非插入的成员位于双端队列的末端（前面或后面）（在这种情况下，所有迭代器都无效，但对元素的引用不受影响）[23.2.1.3/1]

*   **擦除**：所有迭代器和引用都无效，除非被擦除的成员位于双端队列的末端（前面或后面）（在这种情况下，只有迭代器和对被擦除成员的引用无效）[23.2.1.3/4]

*   **调整大小**：根据插入/擦除 [23.2.1.2/1]

## C++11

*   **插入**：所有迭代器和引用都无效，除非插入的成员位于双端队列的末端（前面或后面）（在这种情况下，所有迭代器都无效，但对元素的引用不受影响）[23.3.3.4/1]

*   **Erasure**：擦除最后一个元素只会使迭代器和对被擦除元素的引用和过去的迭代器无效；擦除第一个元素只会使迭代器和对被擦除元素的引用无效；擦除任何其他元素会使所有迭代器和引用无效（包括过去的迭代器）[23.3.3.4/4]

*   **调整大小**：根据插入/擦除 [23.3.3.4/1]

* * *

## 进一步阅读

*   [迭代器失效规则](https://stackoverflow.com/questions/6438086/iterator-invalidation-rules)
*   [“STL”和“C++ 标准库”有什么区别？](https://stackoverflow.com/q/5205491/560648)

[我不确定你在寻找什么对可靠来源的进一步参考——相关的标准段落已经被引用和引用。]

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-05-27T05:05:29.970

SGI 实现可能使用可增长数组，因此如果插入导致数组增长，则指向旧数组的迭代器无效。

编辑：

查看 The C++ Programming Language Third Edition 的第 17.2.3 节，我在 deque 的描述中看不到任何指示哪些操作保留或使迭代器无效的内容。我可能看错了地方，或者行为可能未定义。

# sql-server - 如何找出 Sql 数据库字段何时被修改？

> ID：913985
> 
> 赞同：3
> 
> 时间：2009-05-27T04:49:01.850
> 
> 标签：sql-server

表中的一个数据库字段正在被一些代码修改。我就是想不通在哪里！

所以，我想知道是否有一种方法可以找到。

我正在使用 SQL 2008。可以使用*Profiler*来确定特定字段是否正在更新？如何？

*触发器*呢？如果使用触发器（例如在 UPDATE 上），您能否确定调用它的代码是什么？触发器如何“通知我”？电子邮件/文件？

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2009-05-27T04:52:46.497

是的，该特定表和字段上的“AFTER UPDATE”触发器可能会为您提供一些关于何时以及为什么更改该字段的线索。

来自在线书籍：

```
CREATE TRIGGER reminder
ON Person.Address
AFTER UPDATE 
AS 
  IF ( UPDATE (StateProvinceID) OR UPDATE (PostalCode) )
  BEGIN
    RAISERROR (50009, 16, 10)
  END;
GO 
```

触发器基本上可以执行任何 T-SQL 代码——如果您正确设置了数据库邮件，它可以向您发送电子邮件，是的。或者它可以将审计条目写入另一个表或类似的东西。

编辑：如果您需要找出哪些语句更新了您的列，实际上您最好在服务器上运行跟踪，仅限于该特定表，然后跟踪那里发生的事情。我不认为触发器可以为您提供该信息（哪些代码导致更新发生）。

马克

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-05-27T04:53:11.193

确定对表的最后一次更新或选择（没有触发器！）

[http://sqlblogcasts.com/blogs/tonyrogerson/archive/2007/06/03/determining-the-last-update-to-or-select-against-a-table-without-a-trigger.aspx](http://sqlblogcasts.com/blogs/tonyrogerson/archive/2007/06/03/determining-the-last-update-to-or-select-against-a-table-without-a-trigger.aspx)

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-05-27T04:55:05.980

是的，您可以使用触发器在表格更新时执行一些代码（跟踪谁更新了表格、给您发送电子邮件等）。请参阅此链接： [使用数据库触发器跟踪更新](http://weblogs.asp.net/jgalloway/archive/2008/01/27/adding-simple-trigger-based-auditing-to-your-sql-server-database.aspx)

编辑：最初发布了错误的链接

# asp.net - 如何将报表数据从 SQL/ASP.NET 导出到带有颜色和格式的 .XLS 下载？

> ID：913991
> 
> 赞同：0
> 
> 时间：2009-05-27T04:50:11.600
> 
> 标签：asp.net, export, xls

希望能够为单元格设置标题颜色等不同的字体大小和背景颜色。

请用 C#。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2009-05-27T05:31:17.587

这个解决方案非常聪明。它使用 StringWriter 使用 mime 类型将数据网格导出到 excel 文件：

[http://blog.aasheim.org/2008/03/export-data-from-web-page-to-excel.html](http://blog.aasheim.org/2008/03/export-data-from-web-page-to-excel.html)

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-05-27T06:14:57.083

我和这些人相处得很好：http: [//officewriter.softartisans.com/OfficeWriter-257.aspx](http://officewriter.softartisans.com/OfficeWriter-257.aspx)

不便宜，但对象模型非常优雅，并且您可以对外观进行大量控制。（我使用了以前的 COM 版本，并假设新版本也一样好。）

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-05-27T06:31:59.037

*   魔法

如果你想依赖 MS Excel 魔法，你可以设置

```
Response.ContentType = "application/vnd.ms-excel"; 
```

在 HTML 输出中创建表格，并让 Excel 将其解释为 XLS 文件。

如果您使用非标准颜色，您可能需要将它们添加到 <HEAD> 部分中，正如我刚刚在我过去的一个项目中发现的那样：

```
<!--[if gte mso 9]>
  <xml>
    <o:OfficeDocumentSettings>
      <o:Colors>
        <o:Color>
          <o:Index>16</o:Index>
          <o:RGB>#E10056</o:RGB>
        </o:Color>
        <o:Color>
          <o:Index>17</o:Index>
          <o:RGB>#d4d1b8</o:RGB>
        </o:Color>
      </o:Colors>
    </o:OfficeDocumentSettings>
  </xml>
<![endif]--> 
```

*   办公自动化

使用 Excel COM 自动化创建*真正的*XLS 服务器端，并通过 Response.WriteBinary 发送

*   第三方工具

正如马特回答的那样*******