# StackOverflow 问答 000650000-000650999

# sql-server - 在 sql server 中从真实数据类型转换为货币数据类型时会丢失精度吗？

> ID：650001
> 
> 赞同：1
> 
> 时间：2009-03-16T11:13:25.523
> 
> 标签：sql-server, database, types

我有一个带有真实数据类型数据字段的表。转换为货币或十进制数据类型时是否会丢失精度？

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2009-03-16T11:50:53.750

这取决于您为小数类型指定的精度和小数位数。例如，如果您有一个`decimal(19,2)`并尝试转换`real`数字`1.123`，您将获得该值`1.12`。

`decimal`类型比类型具有更高的精度，`real`因此它能够处理其`real`范围内的任何值而不会丢失精度。

该`money`类型可以保存与小数（19,4）相同的数据。

`decimal`and`money`类型是精确类型，while是`real`近似类型。如果您将 a 转换`real`为 a，`decimal`您可能会看到一个与您在值中看到的不完全一样的`real`值，但那是因为该`real`值在显示时被四舍五入，而该`decimal`值不是。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2009-06-19T18:22:32.657

Float(4)（又名 real）和 float(8) 是 IEEE 754 浮点类型。**用它们来代表货币价值是错误的**。它们适用于值具有较大动态范围而存储在相对较少的字节中的计算。浮点数的使用以及它们的精确度和准确性本身就是一门科学，不容易解释。

# css - 动态地将 CSS 添加到 CMS 时，我应该将其写入数据库还是文件

> ID：650007
> 
> 赞同：1
> 
> 时间：2009-03-16T11:17:58.460
> 
> 标签：css, language-agnostic, content-management-system

我在 CMS 上工作，我希望能够通过管理控制面板添加 CSS。

当我添加 css 时，我应该将它附加到我拥有的样式表的底部，还是最好将数据添加到数据库，然后使用处理程序获取它。

在我看来，他们似乎都有优势。

写入文件：
很简单，只需要很少的代码
文件是可移植的，可以像任何其他css文件一样复制

写入数据库：
我有更多控制权
我只能加载每个文档所需的类

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-03-16T11:35:30.667

我会修改 CSS 文件本身。在整个站点中使用动态 CSS 会导致您出现问题，因为样式表会被缓存，因此最好将所有样式放入文件中并允许本地缓存来加速页面，而不是尝试制作大量小的 CSS 文件。

将每个规则存储在数据库中并使用该信息创建 .css 文件不会有任何害处 - 这比解析 CSS 文件中的字符串并找到插入点要容易，但请确保您只编写 CSS 文件当有变化时。如果您按需执行，您将不必要地不断地访问您的数据库。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2009-03-16T12:03:15.730

在前世做过这两件事后，我认为答案取决于谁在维护 CSS。

如果它是非技术用户管理一些简单样式的简单界面，我会将其存储在数据库中，但作为结构化数据，而不是原始 CSS，并在运行时自行生成 CSS。但是，正如 Sohnee 所提到的，您需要确保不是为每个请求都生成它，因为这将是不必要的开销 - 您应该生成一个平面文件，或者有效地缓存。

如果它是 Web 开发人员类型的人的界面，他们了解文件的概念，并且您想让他们完全访问编写他们喜欢的任何 CSS（并且您信任他们！），那么我会将其存储为文件（如果我是开发人员，我希望它使用我的原始 CSS）。但是，我不会将它附加到现有样式表（假设这是站点的默认基本样式集），我将有一个用于用户定义样式的单独样式表，在页面中使用单独的链接标记调用。这将使站点“代码”与其“内容”分开。还要注意 Zhaph - Ben Duguid 在这里所说的关于通过向 URL 添加某种版本参数来确保浏览器不缓存旧版本的内容。

> 写入数据库：我有更多控制权我只能加载每个文档所需的类

我想说只加载每个文档的类通常是一个坏主意。浏览器已针对 CSS 缓存进行了调整，因此使用适当的缓存标头从外部文件调用所有 CSS 几乎总是会更好。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2009-03-16T11:51:18.070

将样式附加到现有 CSS 的最大危险是，如果浏览器缓存了文件的某个版本，则在浏览器刷新缓存之前，他们将看不到更新的样式。

一种解决方法是在调用样式表的某处包含一个版本字符串（例如（来自 SO））：

```
<link rel="stylesheet" href="/Content/all.min.css?v=2644"> 
```

但是，这意味着您还必须在每次进行更改时更新对文件的调用，这可能是不可能的。

也就是说，如果我要添加的样式经常不能上传新版本的样式表，这可能是我会采取的方法。

# mvvm - MVVM 路由和中继命令

> ID：650010
> 
> 赞同：77
> 
> 时间：2009-03-16T11:20:05.180
> 
> 标签：mvvm, command, relaycommand, routedcommand

[RoutedCommand](http://msdn.microsoft.com/en-us/library/system.windows.input.routedcommand.aspx)和[RelayCommand 有](http://msdn.microsoft.com/en-us/magazine/dd419663.aspx#id0090051)什么区别？在 MVVM 模式中何时使用 RoutedCommand 以及何时使用 RelayCommand？

* * *

## 回答 #1

> 赞同：69
> 
> 时间：2009-03-19T20:34:47.943

[RoutedCommand](http://msdn.microsoft.com/en-us/library/system.windows.input.routedcommand.aspx)是 WPF 的一部分，而[RelayCommand](http://msdn.microsoft.com/en-us/magazine/dd419663.aspx#id0090051)是由 WPF 门徒 Josh Smith 创建的；）。

不过，说真的，RS Conley 描述了其中的一些差异。主要区别在于 RoutedCommand 是一个 ICommand 实现，它使用 RoutedEvent 在树中路由，直到找到该命令的 CommandBinding，而 RelayCommand 不进行路由，而是直接执行一些委托。在 MV-VM 场景中，RelayCommand（Prism 中的 DelegateCommand）可能是更好的选择。

* * *

## 回答 #2

> 赞同：35
> 
> 时间：2011-06-22T14:21:24.417

关于在 MVVM 中使用 RelayCommand 和 RoutedCommand，对我来说主要区别如下：

**代码位置**

RelayCommand 允许您在任何类中实现命令（作为具有委托的 ICommand 属性），然后通常将数据绑定到调用命令的控件。这个类是*ViewModel*。如果使用路由命令，则必须在控件的*代码隐藏*中实现与命令相关的方法，因为这些方法由 CommandBinding 元素的属性指定。假设严格的 MVVM 意味着有一个“空”的代码隐藏文件，实际上不可能将标准路由命令与 MVVM 一起使用。

RS Conley 所说的，RelayCommand 允许您在 ViewModel 之外定义 RelayCommand 是对的，但首先它允许您在 ViewModel*内部*定义它，而 RoutedCommand 没有。

**路由**

另一方面，RelayCommands 不支持通过树进行路由（如前所述），这不是问题，只要您的界面基于单个 viewModel。如果不是，例如，如果您有一组具有自己的 viewModel 的项目，并且想要一次从父元素中为每个项目调用子 ViewModel 的命令，则必须使用路由（另请参见 CompositeCommands） .

总而言之，我想说，标准的 RoutedCommands 在严格的 MVVM 中不可用。RelayCommands 非常适合 MVVM，但不支持您可能需要的路由。

* * *

## 回答 #3

> 赞同：22
> 
> 时间：2009-03-16T12:53:47.967

不同之处在于 RelayCommand 可以接受委托。您可以在 ViewModel 之外定义 RelayCommand。然后，ViewModel 可以在创建命令并将命令绑​​定到 UI 对象（如控件）时向命令添加委托。委托反过来可以访问 ViewModel 的私有变量，因为它们是在 View Model 本身的范围内定义的。

它用于减少 ViewModel 中包含的代码量，因为趋势是将 Routed 命令定义为 ViewModel 内的嵌套类。两者的功能在其他方面相似。

* * *

## 回答 #4

> 赞同：15
> 
> 时间：2012-07-17T19:30:22.270

我认为 RoutedCommands 在严格的 MVVM 中是完全合法的。尽管 RelayCommands 通常因其简单性而受到青睐，但 RoutedCommands 有时会提供组织优势。例如，您可能希望多个不同的视图连接到一个共享的 ICommand 实例，而无需将该命令直接暴露给底层的 ViewModel。

作为旁注，请记住严格的 MVVM 并不禁止使用代码隐藏。如果那是真的，那么您将永远无法在视图中定义自定义依赖项属性！

为了在严格的 MVVM 框架中使用 RoutedCommand，您可以按照以下步骤操作：

1.  为您的自定义命令声明一个静态 RoutedCommand 实例。如果您打算使用 ApplicationCommands 类中的预定义命令，则可以跳过此步骤。例如：

    ```
    public static class MyCommands {
        public static RoutedCommand MyCustomCommand = new RoutedCommand();
    } 
    ```

2.  使用 XAML 将所需的视图附加到 RoutedCommand：

    ```
    <Button Command="{x:Static local:MyCommands.MyCustomCommand}" /> 
    ```

3.  您绑定到合适 ViewModel 的视图之一（即，无论哪个 ViewModel 实现命令功能）都需要公开一个自定义 DependencyProperty，该自定义 DependencyProperty 将绑定到您的 ViewModel 的实现：

    ```
    public partial class MainView : UserControl
    {
        public static readonly DependencyProperty MyCustomCommandProperty =
            DependencyProperty.Register("MyCustomCommand",
            typeof(ICommand), typeof(MainView), new UIPropertyMetadata(null));

        public ICommand MyCustomCommand {
            get { return (ICommand)GetValue(MyCustomCommandProperty); }
            set { SetValue(MyCustomCommandProperty, value); }
        } 
    ```

4.  相同的视图应将自身绑定到步骤 1 中的 RoutedCommand。在 XAML 中：

    ```
    <UserControl.CommandBindings>
        <CommandBinding Command="{x:Static local:MyCommands.MyCustomCommand}"
                        CanExecute="MyCustomCommand_CanExecute"
                        Executed="MyCustomCommand_Executed"
                        />
    </UserControl.CommandBindings> 
    ```

    在您的视图的代码隐藏中，关联的事件处理程序将仅从步骤 3 中声明的依赖属性委托给 ICommand：

    ```
    private void MyCustomCommand_CanExecute(object sender, CanExecuteRoutedEventArgs e) {
        var command = this.MyCustomCommand;
        if (command != null) {
            e.Handled = true;
            e.CanExecute = command.CanExecute(e.Parameter);
        }
    }
    private void MyCustomCommand_Executed(object sender, ExecutedRoutedEventArgs e) {
        var command = this.MyCustomCommand;
        if (command != null) {
            e.Handled = true;
            command.Execute(e.Parameter);
        }
    } 
    ```

5.  最后，将 ViewModel 的命令实现（应该是 ICommand）绑定到 XAML 中的自定义依赖项属性：

    ```
    <local:MainView DataContext="{Binding MainViewModel}"
                    MyCustomCommand="{Binding CustomCommand}" /> 
    ```

这种方法的优点是您的 ViewModel 只需要提供 ICommand 接口的单个​​实现（它甚至可以是 RelayCommand），而任意数量的视图可以通过 RoutedCommand 附加到它，而无需直接绑定到那个视图模型。

不幸的是，有一个缺点是 ICommand.CanExecuteChanged 事件将不起作用。当您的 ViewModel 希望 View 刷新 CanExecute 属性时，您必须调用 CommandManager.InvalidateRequerySuggested()。

# certificate - 证书中的“主题”是什么意思？

> ID：650017
> 
> 赞同：52
> 
> 时间：2009-03-16T11:23:56.043
> 
> 标签：certificate, pki, x509

相关链接是这篇[MSDN 文章](http://msdn.microsoft.com/en-us/library/bfsktky3(VS.80).aspx)。

我总是对术语“主题”感到困惑，例如，sk 选项“指定主题的密钥容器位置”，sr 选项“指定主题的证书存储位置”。这里的主题到底是什么意思？证书所有者？证书颁发者（例如颁发证书的根 CA）？或者是其他东西？

* * *

## 回答 #1

> 赞同：36
> 
> 时间：2009-03-16T14:58:06.530

主体，在安全中，是被保护的东西。在这种情况下，它可能是一个人的电子邮件、一个网站或一台机器。

如果我们以电子邮件为例，比如我的电子邮件，那么主题密钥容器将是包含我的私钥的受保护位置。

证书存储通常是指 Microsoft 证书存储，其中包含来自受信任根、网络上的机器、人员等的证书。在我的情况下，主题证书存储将是这个存储中保存我的证书的地方。

如果您在 Microsoft 域中工作，则主题名称将始终包含主题的专有名称，这是域引用主题并将其保存在其目录中的方式。例如 CN=Mark Sutton、OU=Developers、O=Mycompany C=UK

要在 Microsoft 机器上查看您的证书：-

在运行时登录
>mmc
选择文件>添加/删除管理单元并选择证书然后选择我的用户帐户
单击完成然后关闭然后确定。
查看商店的个人区域。

在商店的其他区域，您将看到用于验证签名等的其他受信任证书。

* * *

## 回答 #2

> 赞同：23
> 
> 时间：2009-04-03T15:28:00.487

我的典型期望是，在这样的上下文中使用“主题”时，它意味着证书的目标。如果您将证书视为对**事物**（人、设备、通信渠道等）的加密安全描述，那么主题就是与该事物相关的**事物**。

这不是事情本身。例如，没有人会说“受试者拿着他的智能卡并验证他的 PIN”。那将是“用户”。

但它通常涉及与那个东西相关的各种数据项。例如：

*   **Subject DN** = Subject Distinguished Name = 这个东西的唯一标识符。包括有关被认证事物的信息，包括通用名称、组织、组织单位、国家代码等。
*   **主题密钥**= 证书的私钥/公钥对的一部分（或全部）。如果它来自证书，它就是公钥。如果它来自安全位置的密钥库，则可能是私钥。密钥的任何一部分都是接收证书的事物使用的加密数据。
*   **主题证书**- 交易的终点 - 这是要求某些安全功能的东西 - 例如完整性检查、身份验证、隐私等。

通常，它用于区分 PKI 世界中的其他玩家。即“发行者”和“根”。颁发者是颁发证书（给主体）的 CA，根是作为层次结构中所有信任的端点的 CA。典型的关系是root--->issuer--->subject。

* * *

## 回答 #3

> 赞同：8
> 
> 时间：2012-05-06T13:39:02.097

证书的主体是与其公钥相关联的实体（即证书的“所有者”）。

正如[RFC 5280 所说](https://www.rfc-editor.org/rfc/rfc5280#section-4.1.2.6)：

> 主题字段标识与存储在主题公钥字段中的公钥相关联的实体。主题名称可以在主题字段和/或 subjectAltName 扩展中携带。

X.509 证书有一个主题（专有名称）字段，并且在主题备用名称扩展中也可以有多个名称。

主题 DN 由多个相对专有名称 (RDN)（它们本身[由属性断言值组成](https://stackoverflow.com/a/3196955/372643)）组成，例如“CN=yourname”或“O=yourorganization”。

在您链接到的文章的上下文中，主题将是证书的用户/所有者。

* * *

## 回答 #4

> 赞同：4
> 
> 时间：2009-03-16T11:26:39.500

主题是证书的通用名称，如果它是服务器证书并且客户端正在寻找肯定的标识，则在很多情况下它是证书的关键属性。

作为网站 SSL 证书的示例，主题将是网站的域名。

# javascript - 如何在 JavaScript 中拆分具有多个分隔符的字符串？

> ID：650022
> 
> 赞同：664
> 
> 时间：2009-03-16T11:25:52.623
> 
> 标签：javascript, regex, split

如何在 JavaScript 中拆分具有多个分隔符的字符串？

我正在尝试拆分*逗号*和*空格*，但 AFAIK JavaScript 的`split()`函数仅支持一个分隔符。

* * *

## 回答 #1

> 赞同：891
> 
> 时间：2009-03-16T11:30:45.590

传入一个正则表达式作为参数：

```
js> "Hello awesome, world!".split(/[\s,]+/)
Hello,awesome,world! 
```

**编辑添加：**

您可以通过选择数组的长度减去 1 来获取最后一个元素：

```
>>> bits = "Hello awesome, world!".split(/[\s,]+/)
["Hello", "awesome", "world!"]
>>> bit = bits[bits.length - 1]
"world!" 
```

...如果模式不匹配：

```
>>> bits = "Hello awesome, world!".split(/foo/)
["Hello awesome, world!"]
>>> bits[bits.length - 1]
"Hello awesome, world!" 
```

* * *

## 回答 #2

> 赞同：265
> 
> 时间：2009-03-16T11:29:36.343

您可以将正则表达式传递给 JavaScript 的[split()](https://developer.mozilla.org/en/Core_JavaScript_1.5_Reference/Global_Objects/String/split)方法。例如：

```
"1,2 3".split(/,| /) 
["1", "2", "3"] 
```

或者，如果您想让**多个分隔符**一起作为一个分隔符：

```
"1, 2, , 3".split(/(?:,| )+/) 
["1", "2", "3"] 
```

（您必须使用非捕获`(?:)`括号，否则它会被拼接回结果中。或者您可以像 Aaron 一样聪明并使用字符类。）

在 Safari 和 Firefox 中测试的示例。

* * *

## 回答 #3

> 赞同：89
> 
> 时间：2016-05-02T06:39:45.640

另一种简单但有效的方法是重复使用 split + join。

```
"a=b,c:d".split('=').join(',').split(':').join(',').split(',') 
```

本质上，先进行拆分，然后进行连接就像全局替换，所以这会用逗号替换每个分隔符，然后一旦全部替换，它会在逗号上进行最终拆分

上述表达式的结果是：

```
['a', 'b', 'c', 'd'] 
```

对此进行扩展，您还可以将其放在一个函数中：

```
function splitMulti(str, tokens){
        var tempChar = tokens[0]; // We can use the first token as a temporary join character
        for(var i = 1; i < tokens.length; i++){
            str = str.split(tokens[i]).join(tempChar);
        }
        str = str.split(tempChar);
        return str;
} 
```

用法：

```
splitMulti('a=b,c:d', ['=', ',', ':']) // ["a", "b", "c", "d"] 
```

如果您经常使用此功能，甚至可能值得考虑包装 `String.prototype.split`方便（我认为我的功能相当安全 - 唯一的考虑是条件的额外开销（次要）以及它缺少限制参数的实现这一事实如果传递了一个数组）。

`splitMulti`如果使用下面的这种方法简单地包装它，请务必包含该函数:)。还值得注意的是，有些人不赞成扩展内置插件（因为很多人做错了，可能会发生冲突），所以如果有疑问，请在使用此插件之前与更资深的人交谈或询问 SO :)

```
 var splitOrig = String.prototype.split; // Maintain a reference to inbuilt fn
    String.prototype.split = function (){
        if(arguments[0].length > 0){
            if(Object.prototype.toString.call(arguments[0]) == "[object Array]" ) { // Check if our separator is an array
                return splitMulti(this, arguments[0]);  // Call splitMulti
            }
        }
        return splitOrig.apply(this, arguments); // Call original split maintaining context
    }; 
```

用法：

```
var a = "a=b,c:d";
    a.split(['=', ',', ':']); // ["a", "b", "c", "d"]

// Test to check that the built-in split still works (although our wrapper wouldn't work if it didn't as it depends on it :P)
        a.split('='); // ["a", "b,c:d"] 
```

享受！

* * *

## 回答 #4

> 赞同：29
> 
> 时间：2015-08-31T22:27:01.633

**让我们保持简单：（**在您的 RegEx 中添加“[ ]+”表示“1 或更多”）

这意味着“+”和“{1,}”是相同的。

```
var words = text.split(/[ .:;?!~,`"&|()<>{}\[\]\r\n/\\]+/); // note ' and - are kept 
```

* * *

## 回答 #5

> 赞同：15
> 
> 时间：2013-07-04T13:32:23.087

棘手的方法：

```
var s = "dasdnk asd, (naks) :d skldma";
var a = s.replace('(',' ').replace(')',' ').replace(',',' ').split(' ');
console.log(a);//["dasdnk", "asd", "naks", ":d", "skldma"] 
```

* * *

## 回答 #6

> 赞同：8
> 
> 时间：2012-08-27T15:23:41.603

对于那些希望对其拆分功能进行更多自定义的人，我编写了一个递归算法，该算法将给定的字符串与要拆分的字符列表分开。我在看到上面的帖子之前写了这个。我希望它可以帮助一些沮丧的程序员。

```
splitString = function(string, splitters) {
    var list = [string];
    for(var i=0, len=splitters.length; i<len; i++) {
        traverseList(list, splitters[i], 0);
    }
    return flatten(list);
}

traverseList = function(list, splitter, index) {
    if(list[index]) {
        if((list.constructor !== String) && (list[index].constructor === String))
            (list[index] != list[index].split(splitter)) ? list[index] = list[index].split(splitter) : null;
        (list[index].constructor === Array) ? traverseList(list[index], splitter, 0) : null;
        (list.constructor === Array) ? traverseList(list, splitter, index+1) : null;    
    }
}

flatten = function(arr) {
    return arr.reduce(function(acc, val) {
        return acc.concat(val.constructor === Array ? flatten(val) : val);
    },[]);
}

var stringToSplit = "people and_other/things";
var splitList = [" ", "_", "/"];
splitString(stringToSplit, splitList); 
```

上面的示例返回：`["people", "and", "other", "things"]`

注意：`flatten`函数取自[Rosetta Code](http://rosettacode.org/wiki/Flatten_a_list)

* * *

## 回答 #7

> 赞同：8
> 
> 时间：2014-04-22T04:46:15.237

您可以将要用作分隔符的所有字符单独或集中汇总到正则表达式中，然后将它们传递给 split 函数。例如你可以写：

```
console.log( "dasdnk asd, (naks) :d skldma".split(/[ \(,\)]+/) ); 
```

输出将是：

```
["dasdnk", "asd", "naks", ":d", "skldma"] 
```

* * *

## 回答 #8

> 赞同：6
> 
> 时间：2019-10-15T10:47:31.140

我对@Brian 答案的重构

```
var string = 'and this is some kind of information and another text and simple and some egample or red or text';
var separators = ['and', 'or'];

function splitMulti(str, separators){
            var tempChar = 't3mp'; //prevent short text separator in split down

            //split by regex e.g. \b(or|and)\b
            var re = new RegExp('\\b(' + separators.join('|') + ')\\b' , "g");
            str = str.replace(re, tempChar).split(tempChar);

            // trim & remove empty
            return str.map(el => el.trim()).filter(el => el.length > 0);
}

console.log(splitMulti(string, separators))
```

* * *

## 回答 #9

> 赞同：6
> 
> 时间：2021-10-07T20:52:51.797

我很惊讶还没有人建议它，但我的 hack-ey（和疯狂的快速）解决方案是在由同一个字符分割之前附加几个“替换”调用。

即删除a、b、c、d和e：

```
let str = 'afgbfgcfgdfgefg'
let array = str.replace('a','d').replace('b','d').replace('c','d').replace('e','d').split('d') 
```

这可以方便地概括为拆分器数组，如下所示：

```
function splitByMany( manyArgs, string ) {
  do {
    let arg = manyArgs.pop()
    string = string.replace(arg, manyArgs[0])
  } while (manyArgs.length > 2)
  return string.split(manyArgs[0])
} 
```

所以，在你的情况下，你可以打电话

```
let array = splitByMany([" ", ","], 'My long string containing commas, and spaces, and more commas'); 
```

* * *

## 回答 #10

> 赞同：5
> 
> 时间：2016-03-09T13:36:13.977

嗨，例如，如果您在字符串 07:05:45PM 中拆分和替换

```
var hour = time.replace("PM", "").split(":"); 
```

结果

```
[ '07', '05', '45' ] 
```

* * *

## 回答 #11

> 赞同：5
> 
> 时间：2019-09-07T15:02:10.343

我将为这样的功能提供一个经典的实现。该代码适用于几乎所有版本的 JavaScript，并且在某种程度上是最佳的。

*   它不使用难以维护的正则表达式
*   它不使用 JavaScript 的新特性
*   它不使用需要更多计算机内存的多个 .split() .join() 调用

只是纯代码：

```
var text = "Create a function, that will return an array (of string), with the words inside the text";

println(getWords(text));

function getWords(text)
{
    let startWord = -1;
    let ar = [];

    for(let i = 0; i <= text.length; i++)
    {
        let c = i < text.length ? text[i] : " ";

        if (!isSeparator(c) && startWord < 0)
        {
            startWord = i;
        }

        if (isSeparator(c) && startWord >= 0)
        {
            let word = text.substring(startWord, i);
            ar.push(word);

            startWord = -1;
        }
    }

    return ar;
}

function isSeparator(c)
{
    var separators = [" ", "\t", "\n", "\r", ",", ";", ".", "!", "?", "(", ")"];
    return separators.includes(c);
} 
```

您可以看到在 Playground 中运行的代码： [https ://codeguppy.com/code.html?IJI0E4OGnkyTZnoszAzf](https://codeguppy.com/code.html?IJI0E4OGnkyTZnoszAzf)

* * *

## 回答 #12

> 赞同：5
> 
> 时间：2020-07-29T15:53:19.440

**通过.com/**或**.net/**分割 URL

 **```
url.split(/\.com\/|\.net\//) 
```

* * *

## 回答 #13

> 赞同：5
> 
> 时间：2021-05-02T14:44:46.307

以下是一些使用正则表达式可能会有所帮助的案例：

*   `\W`匹配任何字符 else word character `[a-zA-Z0-9_]`。例子：

```
("Hello World,I-am code").split(/\W+/); // would return [ 'Hello', 'World', 'I', 'am', 'code' ] 
```

*   `\s+`匹配一个或多个空格
*   `\d`匹配一个数字
*   如果你想用一些字符分割，只让我们说`,`，`-`你可以使用`str.split(/[,-]+/)`...等

* * *

## 回答 #14

> 赞同：4
> 
> 时间：2019-06-24T13:25:20.783

**这是在ES6**中实现相同目标的新方法：

```
function SplitByString(source, splitBy) {
  var splitter = splitBy.split('');
  splitter.push([source]); //Push initial value

  return splitter.reduceRight(function(accumulator, curValue) {
    var k = [];
    accumulator.forEach(v => k = [...k, ...v.split(curValue)]);
    return k;
  });
}

var source = "abc,def#hijk*lmn,opq#rst*uvw,xyz";
var splitBy = ",*#";
console.log(SplitByString(source, splitBy));
```

请注意此功能：

*   不涉及正则表达式
*   **以与它出现的相同顺序返回拆分值`source`**

上述代码的结果将是：

[![在此处输入图像描述](https://i.stack.imgur.com/FadrH.png)](https://i.stack.imgur.com/FadrH.png)

* * *

## 回答 #15

> 赞同：3
> 
> 时间：2019-04-09T12:04:27.167

```
a = "a=b,c:d"

array = ['=',',',':'];

for(i=0; i< array.length; i++){ a= a.split(array[i]).join(); } 
```

这将返回没有特殊字符的字符串。

* * *

## 回答 #16

> 赞同：2
> 
> 时间：2014-07-15T07:49:40.637

我不知道 RegEx 的性能，但这是 RegEx 利用本机 HashSet 并在 O( max(str.length, delimeter.length) ) 复杂度下工作的另一种选择：

```
var multiSplit = function(str,delimiter){
    if (!(delimiter instanceof Array))
        return str.split(delimiter);
    if (!delimiter || delimiter.length == 0)
        return [str];
    var hashSet = new Set(delimiter);
    if (hashSet.has(""))
        return str.split("");
    var lastIndex = 0;
    var result = [];
    for(var i = 0;i<str.length;i++){
        if (hashSet.has(str[i])){
            result.push(str.substring(lastIndex,i));
            lastIndex = i+1;
        }
    }
    result.push(str.substring(lastIndex));
    return result;
}

multiSplit('1,2,3.4.5.6 7 8 9',[',','.',' ']);
// Output: ["1", "2", "3", "4", "5", "6", "7", "8", "9"]

multiSplit('1,2,3.4.5.6 7 8 9',' ');
// Output: ["1,2,3.4.5.6", "7", "8", "9"] 
```

* * *

## 回答 #17

> 赞同：2
> 
> 时间：2015-07-13T16:19:12.577

我发现我需要这个的主要原因之一是在`/`和`\`. 这有点棘手的正则表达式，所以我会在这里发布以供参考：

```
var splitFilePath = filePath.split(/[\/\\]/); 
```

* * *

## 回答 #18

> 赞同：2
> 
> 时间：2015-08-25T13:25:38.790

我认为如果您指定要留下的内容而不是要删除的内容会更容易。

好像你只想有英文单词，你可以使用这样的东西：

```
text.match(/[a-z'\-]+/gi); 
```

示例（运行片段）：

```
var R=[/[a-z'\-]+/gi,/[a-z'\-\s]+/gi];
var s=document.getElementById('s');
for(var i=0;i<R.length;i++)
 {
  var o=document.createElement('option');
  o.innerText=R[i]+'';
  o.value=i;
  s.appendChild(o);
 }
var t=document.getElementById('t');
var r=document.getElementById('r');

s.onchange=function()
 {
  r.innerHTML='';
  var x=s.value;
  if((x>=0)&&(x<R.length))
   x=t.value.match(R[x]);
  for(i=0;i<x.length;i++)
   {
    var li=document.createElement('li');
    li.innerText=x[i];
    r.appendChild(li);
   }
 }
```

```
<textarea id="t" style="width:70%;height:12em">even, test; spider-man

But saying o'er what I have said before:
My child is yet a stranger in the world;
She hath not seen the change of fourteen years,
Let two more summers wither in their pride,
Ere we may think her ripe to be a bride.

—Shakespeare, William. The Tragedy of Romeo and Juliet</textarea>

<p><select id="s">
 <option selected>Select a regular expression</option>
 <!-- option value="1">/[a-z'\-]+/gi</option>
 <option value="2">/[a-z'\-\s]+/gi</option -->
</select></p>
 <ol id="r" style="display:block;width:auto;border:1px inner;overflow:scroll;height:8em;max-height:10em;"></ol>
</div>
```

* * *

## 回答 #19

> 赞同：2
> 
> 时间：2021-01-09T11:52:51.863

我在寻找 C# string.Split() 函数的替代品时遇到了这个问题，该函数使用其参数中的字符拆分字符串。

在 JavaScript 中，您可以使用 map 和 reduce 来迭代拆分字符和中间值：

```
let splitters = [",", ":", ";"]; // or ",:;".split("");
let start= "a,b;c:d";
let values = splitters.reduce((old, c) => old.map(v => v.split(c)).flat(), [start]);
// values is ["a", "b", "c", "d"] 
```

flat() 用于展平中间结果，因此每次迭代都在没有嵌套数组的字符串列表上工作。每次迭代都将 split 应用于 old 中的所有值，然后返回中间结果列表，这些结果将被拆分器中的下一个值拆分。reduce() 使用包含初始字符串值的数组进行初始化。

* * *

## 回答 #20

> 赞同：1
> 
> 时间：2016-02-11T09:46:05.530

从@stephen-sweriduk 解决方案开始（这对我来说更有趣！），我稍微修改了它以使其更通用和可重用：

```
/**
 * Adapted from: http://stackoverflow.com/questions/650022/how-do-i-split-a-string-with-multiple-separators-in-javascript
*/
var StringUtils = {

  /**
   * Flatten a list of strings
   * http://rosettacode.org/wiki/Flatten_a_list
   */
  flatten : function(arr) {
    var self=this;
    return arr.reduce(function(acc, val) {
        return acc.concat(val.constructor === Array ? self.flatten(val) : val);
    },[]);
  },

  /**
   * Recursively Traverse a list and apply a function to each item
   * @param list array
   * @param expression Expression to use in func
   * @param func function of (item,expression) to apply expression to item
   *
   */
  traverseListFunc : function(list, expression, index, func) {
    var self=this;
    if(list[index]) {
        if((list.constructor !== String) && (list[index].constructor === String))
            (list[index] != func(list[index], expression)) ? list[index] = func(list[index], expression) : null;
        (list[index].constructor === Array) ? self.traverseListFunc(list[index], expression, 0, func) : null;
        (list.constructor === Array) ? self.traverseListFunc(list, expression, index+1, func) : null;
    }
  },

  /**
   * Recursively map function to string
   * @param string
   * @param expression Expression to apply to func
   * @param function of (item, expressions[i])
   */
  mapFuncToString : function(string, expressions, func) {
    var self=this;
    var list = [string];
    for(var i=0, len=expressions.length; i<len; i++) {
        self.traverseListFunc(list, expressions[i], 0, func);
    }
    return self.flatten(list);
  },

  /**
   * Split a string
   * @param splitters Array of characters to apply the split
   */
  splitString : function(string, splitters) {
    return this.mapFuncToString(string, splitters, function(item, expression) {
      return item.split(expression);
    })
  },

} 
```

进而

```
var stringToSplit = "people and_other/things";
var splitList = [" ", "_", "/"];
var splittedString=StringUtils.splitString(stringToSplit, splitList);
console.log(splitList, stringToSplit, splittedString); 
```

以原始形式返回：

```
[ ' ', '_', '/' ] 'people and_other/things' [ 'people', 'and', 'other', 'things' ] 
```

* * *

## 回答 #21

> 赞同：1
> 
> 时间：2017-01-23T06:08:49.837

> 一个简单的方法是使用每个分隔符处理字符串的每个字符并构建一个拆分数组：

```
splix = function ()
{
  u = [].slice.call(arguments); v = u.slice(1); u = u[0]; w = [u]; x = 0;

  for (i = 0; i < u.length; ++i)
  {
    for (j = 0; j < v.length; ++j)
    {
      if (u.slice(i, i + v[j].length) == v[j])
      {
        y = w[x].split(v[j]); w[x] = y[0]; w[++x] = y[1];
      };
    };
  };

  return w;
}; 
```

```
console.logg = function ()
{
  document.body.innerHTML += "<br>" + [].slice.call(arguments).join();
}

splix = function() {
  u = [].slice.call(arguments);
  v = u.slice(1);
  u = u[0];
  w = [u];
  x = 0;
  console.logg("Processing: <code>" + JSON.stringify(w) + "</code>");

  for (i = 0; i < u.length; ++i) {
    for (j = 0; j < v.length; ++j) {
      console.logg("Processing: <code>[\x22" + u.slice(i, i + v[j].length) + "\x22, \x22" + v[j] + "\x22]</code>");
      if (u.slice(i, i + v[j].length) == v[j]) {
        y = w[x].split(v[j]);
        w[x] = y[0];
        w[++x] = y[1];
        console.logg("Currently processed: " + JSON.stringify(w) + "\n");
      };
    };
  };

  console.logg("Return: <code>" + JSON.stringify(w) + "</code>");
};

setTimeout(function() {
  console.clear();
  splix("1.23--4", ".", "--");
}, 250);
```

```
@import url("http://fonts.googleapis.com/css?family=Roboto");

body {font: 20px Roboto;}
```

> 用法：`splix(string, delimiters...)`
> 
> 例子：`splix("1.23--4", ".", "--")`
> 
> 回报：`["1", "23", "4"]`

* * *

## 回答 #22

> 赞同：1
> 
> 时间：2018-08-31T13:23:09.730

不是最好的方法，但可以使用多个不同的分隔符/分隔符进行拆分

html

```
<button onclick="myFunction()">Split with Multiple and Different seperators/delimiters</button>
<p id="demo"></p> 
```

javascript

```
<script>
function myFunction() {

 var str = "How : are | you doing : today?";
 var res = str.split(' | ');

 var str2 = '';
 var i;
 for (i = 0; i < res.length; i++) { 
    str2 += res[i];

    if (i != res.length-1) {
      str2 += ",";
    }
 }
 var res2 = str2.split(' : ');

 //you can add countless options (with or without space)

 document.getElementById("demo").innerHTML = res2;
}
</script> 
```

* * *

## 回答 #23

> 赞同：1
> 
> 时间：2020-09-18T20:52:43.403

我通过减少和过滤解决了这个问题。它可能不是最易读的解决方案，也不是最快的解决方案，在现实生活中我可能会[在这里使用 Aarons answere](https://stackoverflow.com/a/650037/1788771)，但写起来很有趣。

```
[' ','_','-','.',',',':','@'].reduce(
(segs, sep) => segs.reduce(
(out, seg) => out.concat(seg.split(sep)), []), 
['E-mail Address: user@domain.com, Phone Number: +1-800-555-0011']
).filter(x => x) 
```

或者作为一个函数：

```
function msplit(str, seps) {
  return seps.reduce((segs, sep) => segs.reduce(
    (out, seg) => out.concat(seg.split(sep)), []
  ), [str]).filter(x => x);
} 
```

这将输出：

```
['E','mail','Address','user','domain','com','0','Phone','Number','+1','800','555','0011'] 
```

如果最后没有过滤器，您将在数组中获得空字符串，其中两个不同的分隔符彼此相邻。

* * *

## 回答 #24

> 赞同：1
> 
> 时间：2021-10-12T13:52:18.970

[在Github](https://github.com/gbenroscience/gscanner-js)上查看我的简单库

如果你真的不想访问或与 repo 交互，这里是工作代码：

```
/**
 * 
 * @param {type} input The string input to be split
 * @param {type} includeTokensInOutput If true, the tokens are retained in the splitted output.
 * @param {type} tokens The tokens to be employed in splitting the original string.
 * @returns {Scanner}
 */
function Scanner(input, includeTokensInOutput, tokens) {
    this.input = input;
    this.includeTokensInOutput = includeTokensInOutput;
    this.tokens = tokens;
}

Scanner.prototype.scan = function () {
    var inp = this.input;

    var parse = [];
    this.tokens.sort(function (a, b) {
        return b.length - a.length; //ASC, For Descending order use: b - a
    });
    for (var i = 0; i < inp.length; i++) {

        for (var j = 0; j < this.tokens.length; j++) {

            var token = this.tokens[j];
            var len = token.length;
            if (len > 0 && i + len <= inp.length) {
                var portion = inp.substring(i, i + len);
                if (portion === token) {
                    if (i !== 0) {//avoid empty spaces
                        parse[parse.length] = inp.substring(0, i);
                    }
                    if (this.includeTokensInOutput) {
                        parse[parse.length] = token;
                    }
                    inp = inp.substring(i + len);
                    i = -1;
                    break;
                }

            }

        }

    }
    if (inp.length > 0) {
          parse[parse.length] = inp;
    }

    return parse;

}; 
```

用法非常简单：

```
 var tokens = new Scanner("ABC+DE-GHIJK+LMNOP", false , new Array('+','-')).scan();

console.log(tokens); 
```

给出：

```
['ABC', 'DE', 'GHIJK', 'LMNOP'] 
```

如果您希望`(+ and -)`在输出中包含拆分标记，请将 to 设置`false`为`true`并瞧！它仍然有效。

现在的用法是：

```
var tokens = new Scanner("ABC+DE-GHIJK+LMNOP", true , new Array('+','-')).scan(); 
```

和

```
console.log(tokens); 
```

会给：

```
['ABC', '+', 'DE', '-', 'GHIJK', '+', 'LMNOP'] 
```

**请享用！**

* * *

## 回答 #25

> 赞同：-2
> 
> 时间：2015-04-01T19:01:34.693

我使用正则表达式：

```
str =  'Write a program that extracts from a given text all palindromes, e.g. "ABBA", "lamal", "exe".';

var strNew = str.match(/\w+/g);

// Output: ["Write", "a", "program", "that", "extracts", "from", "a", "given", "text", "all", "palindromes", "e", "g", "ABBA", "lamal", "exe"] 
```

# c# - 如何移动工具提示？

> ID：650026
> 
> 赞同：1
> 
> 时间：2009-03-16T11:28:25.207
> 
> 标签：c#, .net, winforms, datagridview, tooltip

我正在使用`CellToolTipTextNeeded`a 的事件`DataGridView`，并且工具提示显示在鼠标下方。我可以`ToolTip`通过反射将对象取出，但我无法控制它的位置，因为我不是调用`Show()`. 如何移动工具提示？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-03-25T16:00:10.690

如果您想使用 2.0 框架控制工具提示的定位方式和位置，除非您想进入 Window 的 API 调用，否则您必须自己使用 Show 和 Hide 方法控制工具提示。

不幸的是，看起来工具提示的位置在它创建的非常非常早的时候就设置好了。工具提示只有 3 个事件要处理，在这种情况下我们对 Dispose 不是很感兴趣。

Draw 事件在 Popup 事件之后触发，并且似乎位置已经设​​置为 PopupEventArgs 中的 Bounds 属性是只读的。

这是关于创建自定义控件的许多文章之一的链接（在本文发布时）：http: [//andrusdevelopment.blogspot.com/2007/10/implementing-custom-tooltip-in-c.html](http://andrusdevelopment.blogspot.com/2007/10/implementing-custom-tooltip-in-c.html)

而关于使用工具提示的 Show 和 Hide 方法的 MSDN 文档实际上相当不错：http: [//msdn.microsoft.com/en-us/library/44atyhsa (VS.80,printer).aspx](http://msdn.microsoft.com/en-us/library/44atyhsa(VS.80,printer).aspx)

抱歉，但这似乎没有一个快速简便的答案。希望有人会证明我错了，因为两者都是为了。

斯科特

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-03-19T01:57:25.827

定制的怎么样？

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2009-03-19T02:12:35.370

我认为简短的回答是：你不能，反正现在还不能。我可能会考虑构建一个自定义的，如建议的“未知（雅虎）”。

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2012-02-24T01:46:41.027

此链接上有一个使用 Tooltip 对象的好答案。

[如何覆盖 C# datagridview 的默认工具提示行为以增加特定单元格的工具提示延迟](https://stackoverflow.com/questions/5718141/how-to-override-default-tooltip-behavior-of-a-c-sharp-datagridview-to-increase-t)

# c++ - DM_simtoolTest.h:39：错误：请求从“int (*)(int)”转换为非标量类型“std::string”

> ID：650028
> 
> 赞同：0
> 
> 时间：2009-03-16T11:28:51.523
> 
> 标签：c++

我的代码：

功能：它是一个需要三个参数并创建文件的函数。

```
void performLog(string strStoredProcName, int nCount, double time)

{
    int tme=(int) time;

    int hour=tme/3600;

    tme=tme%3600;

    int min=tme/60;

    tme=tme%60;
    int sec=tme;

    char *StrLen;
    int len = 0;
    int lenpass = 0;

    StrLen = &strStoredProcName[0];
    len = strlen(StrLen);

    lenpass = 41 - len;

       fstream outFile( "Perform.out", ios_base::out | ios_base::app );

        if ( ! outFile ) 
        {
            cerr << "Cannot open 'Perform.out' for output" << "\n" << endl;
            exit(-1);
        }

    if (paramLogCreation == false)
    {

        outFile << "**************Performance Log*********************" << "\n" << endl; 
        outFile << "DB Type: MYSQL" << "\n" << endl;
        outFile << "-----------------------------------------------------------------------------------------" << "\n" << "\t" << "\t" << "\t" << "\t" << "Stored Procedure Statitics" << "\n" << endl;
        outFile << "-----------------------------------------------------------------------------------------" << "\n" << endl;
        outFile << "Store Procedure Name" << setw(30) << "Execution Count" << setw(30) << "Time Taken to Execute" << "\n" << endl; 
        paramLogCreation = true ;        
    }

    outFile << strStoredProcName << setw(lenpass) << nCount << setw(20) <<hour<<"::"<<min<<"::"<<sec <<"\n" << endl;
    outFile.close();
} 
```

在这里，我正在为我编写的代码编写一个单元测试用例，该功能是其中的功能之一。请帮助我，如何解决这个问题。请我是 C++ 的新手，需要知道我在哪里犯了错误。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-03-16T11:40:20.903

我认为这是错误：

```
void performLog(string strStoredProcName, int nCount, double time)
[...]
char *StrLen;
[...]
StrLen = &strStoredProcName[0]; 
```

要将字符串转换为 char*，您应该使用[c_str](http://www.cplusplus.com/reference/string/string/c_str.html)：

```
StrLen = new char [strStoredProcName.size()+1];
strcpy (StrLen, strStoredProcName.c_str()); 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-03-16T11:40:35.553

假设通过字符串你的意思是 std:;string 那么当你说：

```
StrLen = &strStoredProcName[0];
len = strlen(StrLen); 
```

不能保证 proc 名称包含一个以 null 结尾的字符串，以便 strlen() 可以处理。如果您想要字符串的长度，请使用**size()**成员函数：

```
len = strStoredProcName.size(); 
```

但是，这不应该导致您收到错误消息，因此**请在您的帖子中指出错误在哪里！！！**

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-03-16T19:47:35.757

看起来您遇到的错误出现在头文件（DM_simtoolTest.h）中，而不是源文件中，您似乎已将其粘贴到问题中。

编译器抱怨您的代码试图使用函数指针（这是奇怪的`int (*)(int)`语法）来获取字符串。在没有看到有问题的代码的情况下，我的第一个（疯狂的、推测性的）猜测是您忘记引用您要测试的函数的名称。我还需要查看标题的来源以正确识别问题。

# asp.net - Asp.net Gridview 分页的问题

> ID：650030
> 
> 赞同：0
> 
> 时间：2009-03-16T11:29:06.907
> 
> 标签：asp.net, vb.net

我在 asp.net 中使用了 Gridview_PageIndexChanging 事件。我使用了如下代码：

```
gridFileDetails.PageIndex = e.NewPageIndex 
```

在我点击下一页的运行时，它会产生一个错误：

> FFK.DLL 中出现“System.InvalidCastException”类型的异常，但未在用户代码中处理
> 
> 附加信息：无法将“System.Web.UI.WebControls.ContentPlaceHolder”类型的对象转换为“System.Web.UI.WebControls.GridViewRow”类型。

在 RowCommand 事件中，

我使用了以下 RowCommand 事件：

```
Protected Sub gridFileDetails_RowCommand(ByVal sender As Object, ByVal e As System.Web.UI.WebControls.GridViewCommandEventArgs) Handles gridFileDetails.RowCommand

    Dim row As GridViewRow = CType(CType(e.CommandSource, Control).NamingContainer, GridViewRow)
    Dim rowkey As DataKey = Me.gridFileDetails.DataKeys(row.DataItemIndex)
    Dim key As String = rowkey(0).ToString()
    If e.CommandName = "FileStatus" And e.CommandArgument <= 0 Then
        Response.Redirect("FFKFile.aspx?FileId=" + key)
    ElseIf e.CommandName = "TradexStatus" And e.CommandArgument <= 0 Then
        Response.Redirect("TradeX.aspx?FileId=" + key)
    ElseIf e.CommandName = "BondStatus" And e.CommandArgument <= 0 Then
        Response.Redirect("BondMaster.aspx?FileId=" + key)
    ElseIf e.CommandName = "FDStatus" And e.CommandArgument <= 0 Then
        Response.Redirect("FrmFileDocument.aspx?FileId=" + key)
    ElseIf e.CommandName = "InvoiceStatus" And e.CommandArgument <= 0 Then
        Response.Redirect("InvoiceMaster.aspx?FileId=" + key)
    ElseIf e.CommandName = "PDStatus" And e.CommandArgument <= 0 Then
        Response.Redirect("PackagingDetails.aspx?FileId=" + key)
    End If
End Sub 
```

你能解决这个问题吗？我在 RowCommand 事件的第一行收到错误，即

```
Dim row As GridViewRow = CType(CType(e.CommandSource, Control).NamingContainer, GridViewRow) 
```

在 PageIndexChanging 事件中，我写了如下：

Protected Sub gridFileDetails_PageIndexChanging(ByVal sender As Object, ByVal e As System.Web.UI.WebControls.GridViewPageEventArgs) 处理 gridFileDetails.PageIndexChanging gridFileDetails.PageIndex = e.NewPageIndex End Sub

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-03-16T12:01:17.733

而不是这个：

```
Dim row As GridViewRow = CType(CType(e.CommandSource, Control).NamingContainer, GridViewRow) 
```

使用索引`EventArgs`以编程方式获取行，如下所示：

```
Dim index As Integer = Convert.ToInt32(e.CommandArgument)
Dim row As GridViewRow = gridFileDetails.Rows(index) 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-03-16T12:01:36.813

[参考System.Web.UI.WebControls.GridViewCommandEventArgs](http://msdn.microsoft.com/en-us/library/system.web.ui.webcontrols.gridviewcommandeventargs.aspx)类的 MSDN，那里提取 gridviewrow 的示例是这样的：

```
 ' Convert the row index stored in the CommandArgument
  ' property to an Integer.
  Dim index As Integer = Convert.ToInt32(e.CommandArgument)

  ' Retrieve the row that contains the button clicked 
  ' by the user from the Rows collection.
  Dim row As GridViewRow = ContactsGridView.Rows(index) 
```

看看这是否可以帮助您在没有演员表错误的情况下获得您的行。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2009-03-16T12:03:14.717

这可能会有所帮助：

```
Dim index As Integer = Convert.ToInt32(e.CommandArgument)
Dim row As GridViewRow = gridFileDetails.Rows(index) 
```

# java-me - 如何开始使用 J2ME？

> ID：650033
> 
> 赞同：3
> 
> 时间：2009-03-16T11:29:42.147
> 
> 标签：java-me, java

我是 J2ME 的新手。请告诉我如何安装它以及从哪里安装它。我还需要下载什么才能使用 JDK 安装 J2ME。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2009-03-16T11:53:30.513

如果您是初学者，我建议您从[Netbeans](http://www.netbeans.org/downloads/) IDE 开始。下载包含 Mobility Pack 的版本。有许多教程可用于使用 Netbeans 开发移动应用程序。

您可能还需要[WTK](http://java.sun.com/products/sjwtoolkit/)（不记得它是否与 Netbeans 一起提供），

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2009-03-16T11:51:16.307

如果您以前没有做过任何 Java 编程，那么开始 J2ME 开发（例如 MIDP）并不容易。您可能想从这个[NetBeans 快速入门](http://www.netbeans.org/kb/docs/javame/quickstart.html)开始。

还有一堆模拟器，需要在您的 IDE 上进行一些配置（例如 Netbeans 或 Eclipse）。这是因为不同的手机制造商在 J2ME 上都有自己的实现 SDK（例如[SonyEricsson](http://developer.sonyericsson.com/site/global/docstools/java/p_java.jsp)）。

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2009-03-17T19:32:57.087

工具

j2me 开发的基本工具是来自 SUN 的[WTK](http://java.sun.com/products/sjwtoolkit/)（无线工具包），其中包含开发所需的仿真器和其他库。WTK 还包含用于签名、预验证、网络监控工具的实用程序。Netbeans[和](http://www.netbeans.org)Eclipse[等](http://www.eclipse.org)IDE具有用于 j2me 开发的插件。这些插件将集成 WTK 和库。对于 netbeans，所有这些都捆绑在一个包中，因此易于安装和配置。对于 Eclipse，您必须安装[MTJ](http://www.eclipse.org/dsdp/mtj/)（java 移动工具）插件。

您可以检查两个 IDE，然后选择您最熟悉的一个。

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2010-11-17T16:09:10.350

没有像完整包这样的东西。您需要基本设置和可选的设备提供程序包（主要是模拟器）。

***基本设置：***

*   **[SUN WTK（包括基本的 J2ME SDK）](http://www.oracle.com/technetwork/java/index-jsp-137162.html)**
*   **[Eclipse 插件](http://eclipseme.org/)**

***可选包：***

*   **[索尼](http://developer.sonyericsson.com/wportal/devworld/technology/java/sdk)**
*   **[摩托罗拉](http://developer.motorola.com/docstools/sdks/)**
*   **[诺基亚](http://www.forum.nokia.com/Library/Tools_and_downloads/)**

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2009-03-17T09:56:41.813

您需要 Sun 无线工具包。您需要为库使用它，还需要“预验证”您的类文件，否则它们将不会加载到移动 VM 上。

[http://www.jguru.com/faq/view.jsp?EID=201507](http://www.jguru.com/faq/view.jsp?EID=201507)

* * *

## 回答 #6

> 赞同：-1
> 
> 时间：2009-03-16T11:34:33.647

您可以从[Sun Microsystems](http://www.sun.com/)网站 下载 J2ME

# c# - WPF - 屏幕保护程序图形性能改进

> ID：650038
> 
> 赞同：2
> 
> 时间：2009-03-16T11:31:23.313
> 
> 标签：c#, wpf, graphics

我拿了这个[WPF-VS2008 ScreenSaver 模板](http://www.developerzen.com/2008/03/17/wpf-screen-saver-template-for-visual-studio-2008/)并开始制作一个新的屏幕保护程序。我对 winForms 平台 (GDI+) 屏幕保护程序有一些经验，所以我对 WPF 有点迷失。

1.  我的屏幕保护程序的背景元素是 Canvas。
2.  DispatcherTimer 滴答设置为 33 毫秒，即 ~ 30 FPS。
3.  背景颜色只是一个巨大的 LinearGradientBrush。
4.  在屏幕上，我有（每个可用屏幕，在我的本地计算机上我有 2 个）用随机计算的（初始化）背景颜色 + Alpha 通道绘制的 n 椭圆。它们都在 Canvas 的儿童系列中。
5.  我正在使用一些逻辑（每个 DispatcherTimer 滴答声）在屏幕上移动这些省略号。我按椭圆移动，然后为每个椭圆调用 Canvas.SetLeft(...) 和 Canvas.SetTop(...)。
6.  如果 N（椭圆数）大于 70-80，我开始注意到图形速度变慢。

现在，我想知道，在选择更高的 N 值时，我是否可以做些什么来提高图形的平滑度？我可以在移动椭圆之前“冻结”“某物”并在完成后“解冻”“某物”吗？或者我还有什么其他的技巧吗？

并不是说我对提到的性能下降会太挑剔 - 因为当 N==50 时，一切都会正常运行。即使椭圆都在同一个地方（大量透明的东西），也完全没有问题。

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2009-03-27T04:56:29.210

您是否尝试过在 CompositionTarget.Rendering 事件中而不是在计时器中进行渲染？在使用渲染事件并进行自己的双缓冲时，我在 3D 屏幕保护程序中获得了令人印象深刻的性能。（参见[http://stuff.seans.com/2008/08/21/simple-water-animation-in-wpf/](http://stuff.seans.com/2008/08/21/simple-water-animation-in-wpf/)，[http://stuff.seans.com/2008/08/24/raindrop-animation-in -wpf/](http://stuff.seans.com/2008/08/24/raindrop-animation-in-wpf/)和[http://stuff.seans.com/2008/09/01/writing-a-screen-saver-in-wpf/](http://stuff.seans.com/2008/09/01/writing-a-screen-saver-in-wpf/)）

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-03-16T12:06:37.690

一旦被冻结，就不可能解冻某些东西（尽管对象的副本默认情况下是解冻的）。默认情况下，WPF 中也启用了双缓冲，因此您无法在此处获得。

如果您不需要所有事件，那么如果您不需要所有事件，则使用[几何对象](http://msdn.microsoft.com/en-us/library/ms751808.aspx#wcpsdk_graphics_geometry_geometryandshapes)（例如[椭圆几何](http://msdn.microsoft.com/en-us/library/system.windows.media.ellipsegeometry.aspx)）而不是形状，因为这些事件的重量较轻，如果尚未这样做，那么提高性能的一种方法是使用几何对象。

我还发现这篇 MSDN 文章[Optimizing Performance: 2D Graphics and Imaging](http://msdn.microsoft.com/en-us/library/bb613591.aspx)表明 CachingHint 可能会与其他一些技巧一起提供帮助。

最后确保您使用的是最新的服务包之一，因为它[在此处列出了许多性能改进](http://blogs.msdn.com/jgoldb/archive/2008/05/15/what-s-new-for-performance-in-wpf-in-net-3-5-sp1.aspx)

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-03-16T12:22:10.523

如果对从 Freezable 继承的对象（例如画笔）调用 Freeze 方法，您将提高性能。

原因是 Freezable 支持必须由图形系统处理的额外更改通知，当您调用 Freeze 时，对象不能再更改，因此不再有更改通知。

对于这个通知系统的一个例子，如果你创建一个画笔，用它来绘制一个矩形（例如），然后改变画笔，屏幕上的矩形会改变颜色。

# eclipse - 在 Zend Studio for Eclipse 中查找文件的最快方法是什么？

> ID：650039
> 
> 赞同：6
> 
> 时间：2009-03-16T11:32:15.260
> 
> 标签：eclipse, eclipse-plugin, keyboard-shortcuts, zend-studio, text-search

我希望能够在 Zend Studio for Eclipse 中快速查找文件，而无需通过包含数十个文件夹和数百个文件的树形视图进行路由。

我真正追求的是在我输入时过滤文件名的东西。想想 Mac 上的聚光灯，或 Vista 开始菜单上的过滤器。

* * *

## 回答 #1

> 赞同：15
> 
> 时间：2009-03-16T11:33:40.920

Ctrl+Shift+R（或 Mac 的 Command+Shift+R）应该可以工作。Zend 破解了吗？

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-11-20T13:27:21.570

`Ctrl+Shift+R`在 Eclipse 和 Zend Studio 中。
NetBeans 中的等价物是`Shift + Alt + O`.

# sql-server - 具有多个表和计算值的 mssql 中的可更新视图

> ID：650040
> 
> 赞同：0
> 
> 时间：2009-03-16T11:32:30.237
> 
> 标签：sql-server, database, sql-server-2005, union

mssql2005 中的大型数据库，具有很大的代码库，具体取决于该数据库的结构。

我有大约 10 个类似的表，它们都包含文件名或文件的完整路径。完整路径始终取决于项目 ID，因此将其存储在数据库中没有意义。从这些表中获取有用的数据有点像这样：

```
SELECT a.item_id
, a.filename
FROM (
    SELECT id_item AS item_id
    , path AS filename
    FROM xMedia

    UNION ALL

    -- media_path has a different collation
    SELECT item_id AS item_id
    , (media_path COLLATE SQL_Latin1_General_CP1_CI_AS) AS filename
    FROM yMedia

    UNION ALL

    -- fullPath contains more than just the filename
    SELECT itemId AS item_id
    , RIGHT(fullPath, CHARINDEX('/', REVERSE(fullPath))-1) AS filename
    FROM zMedia

    -- real database has over 10 of these tables
) a 
```

我想创建所有这些表的单一视图，以便使用此数据灾难的新代码不需要了解所有不同的媒体表。我还想将此视图用于插入和更新语句。显然，旧代码仍将依赖表来更新。

在阅读了有关[在 mssql2005 中创建视图](http://msdn.microsoft.com/en-us/library/ms187956(SQL.90).aspx)的 msdn 页面后，我认为使用 SCHEMABINDING 的视图就足够了。

我将如何创建这样一个可更新的视图？

这是正确的方法吗？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-03-16T11:43:10.757

在您链接的页面上向下滚动，您将看到有关可更新视图的段落。除其他限制外，您不能基于联合更新视图。这背后的逻辑可能很简单，Sql Server 应该如何决定哪个源表/视图应该接收更新/插入？

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-03-16T12:05:04.870

您可以修改分区视图，前提是它们满足某些条件。

这些条件包括将 a`partitioning column`作为每个表的主键的一部分，并在分区列的非重叠检查约束上设置一组。

这似乎不是你的情况。

在您的情况下，您可以执行以下任一操作：

*   将您的表重新创建为视图（带有计算列）以使您的旧软件工作，并从新软件中引用整个表
*   使用`INSTEAD OF`触发器更新表。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-09-24T15:03:56.407

如果一个视图基于多个基表，则视图上的 UPDATE 语句可能会或可能不会工作，具体取决于 UPDATE 语句。如果 UPDATE 语句影响多个基表，SQL Server 会抛出错误。然而，如果 UPDATE 仅影响视图中的一个基表，则 UPDATE 将起作用（并非总是正确）。插入和删除语句总是会失败。

INSTEAD OF 触发器用于正确地从基于多个基表的视图中更新、插入和删除。以下链接包含示例以及相同的视频教程。

[INSTEAD OF INSERT 触发器](http://csharp-video-tutorials.blogspot.com/2012/09/instead-of-insert-trigger-part-45.html)
[INSTEAD OF UPDATE 触发器](http://csharp-video-tutorials.blogspot.com/2012/09/instead-of-update-triggers-part-46.html)
[INSTEAD OF DELETE 触发器](http://csharp-video-tutorials.blogspot.com/2012/09/instead-of-delete-trigger-part-47.html)

# asp.net - 如何在应用程序的根目录中配置所有 MachineToApplication 设置？

> ID：650046
> 
> 赞同：0
> 
> 时间：2009-03-16T11:35:39.980
> 
> 标签：asp.net

`Default allowDefinition='MachineToApplication'`

我一直在不同的网站和论坛上四处寻找，我遇到的问题与某些人以前遇到的类似......使用注册为 allowDefinition='MachineToApplicat 的部分是错误的

如何使用此解决方案：

在应用程序的根目录中配置所有 MachineToApplication 设置，并从应用程序的子目录中删除所有 MachineToApplication 设置。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2009-03-16T11:37:59.210

这意味着如果您的子目录中有任何 web.config 文件，请删除 MachineToApplication 部分。

但是，此问题通常表明其他问题。

您可以发布整个堆栈跟踪吗？

# linq - Linq to Nibernate 设计

> ID：650047
> 
> 赞同：0
> 
> 时间：2009-03-16T11:36:06.607
> 
> 标签：linq, nhibernate, linq-to-nhibernate

我认为使用 Linq2Nibernate 的目的是返回 IQueryable 并建立一个表达式树。我不确定这是否正确。

如果他们不打算返回 IQueryable，为什么有人会使用 Linq2Nibernate？

它还能用来做什么？

**我希望对此主题有更多的投入**

[用于休眠的 Linq](http://ayende.com/Blog/archive/2007/03/16/Linq-for-NHibernate.aspx)

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2009-03-16T21:07:58.137

我打算使用 NHibernate.Linq 用 LINQ 表达式替换我的 HQL 和标准 API 查询。换句话说，我将在代码中生成查询（作为 LINQ 表达式），然后将其传递给 NHibernate.Linq 和 NHib 以将其转换为数据库查询。

仅供参考，有可用的[alpha 版本](http://groups.google.com/group/nhusers/browse_thread/thread/b7a3f537f4cbf46d/90e24322340268c5)。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-03-27T09:01:02.147

我已经计划开始​​使用 Linq2Nibernate，但还没有开始。

我想要使​​用 Linq2Nibernate 的原因是构造标准并稍后查询它们时的好语法。

这是一个很好的简单示例。 [http://ayende.com/Blog/archive/2007/03/16/Linq-for-NHibernate.aspx](http://ayende.com/Blog/archive/2007/03/16/Linq-for-NHibernate.aspx)

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2009-03-29T19:35:48.457

我将 Linq2Nhibernate 与返回 IQueryable 对象的存储库模式一起使用。如您所知，IQueryable 只是一个查询定义——还没有触及数据库。

然后将本地需求添加到查询中，最后具体化对象或列表。

似乎工作得很好，并且可以防止在更高抽象层对部分数据进行不必要的数据库查询。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2009-03-16T14:00:22.503

什么是 Linq2NHibernate？因为有几个项目试图为 nhibernate 实现一个 linq 提供程序，但在完成之前都停止了。

任何 linq 提供程序都需要返回 IQueryable，或者更好的是 IEnumerable，因为这就是 linq 的工作方式。返回 IQueryable 很方便，因为您可以重新使用现有代码将其他运算符填充到已创建的查询中（因为可能返回 IQueryable 的 ctx.Employee 已经是一个查询）

# c - 开发内核并在虚拟机中测试它们

> ID：650050
> 
> 赞同：8
> 
> 时间：2009-03-16T11:36:43.923
> 
> 标签：c, assembly, kernel, virtual-machine

我喜欢编程挑战，编写内核似乎是一个编程挑战。

不幸的是，内核特别难以测试，因为它们基本上是操作系统的核心，因此它们不能轻易地在操作系统之上运行。

但是，我知道可以模拟计算机硬件的称为虚拟机的应用程序。

使用虚拟机开发和测试内核（C+Assembly）的最简单/最好的方法是什么？

* * *

## 回答 #1

> 赞同：11
> 
> 时间：2009-03-16T17:06:13.460

虽然 BOCHS 似乎更善于在您的宠物操作系统出现严重问题时通知您……但它非常慢！当事情变得模糊时，我使用 VirtualPC 进行通用测试和 BOCHS。

此外，您很有可能每 2 分钟启动一次操作系统，因此采用某种自动化方式来构建启动映像并启动 Virtual PC 会有所帮助。

我用所有必要的东西构建了一个 GRUB 启动软盘映像，以使它从根目录启动 Kernel.Bin。我使用批处理文件将此文件复制到虚拟项目目录，使用[FAT Image Generator](http://www.assembla.com/wiki/show/zerospace/fat_imgen)将我的内核复制到映像。然后只需启动 VirtualPC 项目。沃拉！

摘自我的批处理文件：

```
COPY Images\Base.vfd Images\Boot.vfd /Y
fat_imgen.exe modify Images\Boot.vfd -f Source\Bin\KERNEL.BIN
COPY Images\Boot.vfd Emulators\VirtualPC\ /Y
START Emulators\VirtualPC\MyOS.vmc 
```

最后一个建议：将 VirtualPC 进程优先级设置为低 - 相信我！我很乐意交换一些代码！

**工具：** DGJPP、NASM、GRUB。
**代码：** osdev.org、osdever.net

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-03-16T17:43:17.443

您可能有兴趣查看[HelenOS](http://helenos.org)。它是一个从头开始的微内核，已移植到使用 Simics 和 QEMU 等模拟器开发的许多架构（在裸机上启动就好了）。

我们使用在构建过程中复制到最终 ISO 的静态 grub。在操作系统变为自托管之前，有些事情必须如此。我强烈建议不要实现自己的用户空间 C 库，除非你真的想从头开始做所有事情......你会很快成为自托管 :)

尽管 Simics 不是免费的，但我强烈推荐它（以及它内置的调试/分析工具），同时制作你的内核。一旦你有了某种内核控制台和记录器，QEMU 就会做得很好。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-03-16T11:50:22.470

可能只是设置一台机器（我猜是 x86），然后准确调查它在引导期间的行为。主机文件系统中应该有一个或多个文件充当虚拟机的文件系统，然后您需要在其中放置一些引导扇区信息，以使您的开发中的内核启动。

这当然意味着主机上的构建系统有办法将内核写入虚拟机的文件系统，这可能会有所不同。

随机选择一个，[bochs](http://bochs.sourceforge.net/)似乎[支持](http://bochs.sourceforge.net/cgi-bin/topper.pl?name=New+Bochs+Documentation&url=http://bochs.sourceforge.net/doc/docbook/user/index.html)使用 dd 等标准工具从外部编辑引导媒体。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2009-03-16T11:50:37.383

这很简单。设置虚拟机，编写内核，将其复制到虚拟机，启动虚拟机。

如果您需要更具体的建议，则需要更具体。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2009-03-16T22:18:36.267

您需要问自己的第一个问题是您的目标硬件架构是什么？为了讨论，我假设您的目标是 IA_32 架构，这可能是一个明智的选择，因为该处理器上有大量现成的文档。

如果您真的认真对待这项工作，那么您肯定会希望针对模拟器或 VM 运行调试/代码/构建/部署周期。有人提到BOCHS，非常流行。如果您喜欢仿真速度，那么还有一个名为 Qemu 的仿真器，它比 BOCHS 更快。

我建议您的开发环境在 Linux 或 Windows 下运行，由于这些开发环境的可用文档，这可能又是一个明智的选择。

Make是你的朋友。使用它来自动化构建/执行过程。我建议您预先选择您的工具集/编译器，并花一些时间好好学习它们。从长远来看，它会拯救你。

# asp.net-mvc - StructureMap / ASP.MVC / Visual Studio / LinqToSql 的奇怪行为

> ID：650059
> 
> 赞同：5
> 
> 时间：2009-03-16T11:40:47.627
> 
> 标签：asp.net-mvc, linq-to-sql, dependency-injection, structuremap

我最近一直在使用带有 StructureMap 的新 MVC 框架，并且总体上取得了不错的效果，但是，我一直遇到一个非常奇怪的错误，我无法理解或想出如何解决。

这是我的架构：

*   DBContext - linqToSql 数据上下文。
*   IRepository - 合同定义数据方法。
*   IService - 定义服务方法的合同。
*   控制器 - 本例中为两个。

因此，我有：

```
public class Repo : IRepository
{
    public Repo(DBContext db)
    {
       .....
    }
}

public class Service : IService
{
    public Service(IRepository repo)
    {
       .....
    }
}

public class ControllerOne : Controller
{
    public ControllerOne(IService service)
    {
       .....
    }
}

public class ControllerTwo : Controller
{
    public ControllerTwo(IService service)
    {
       .....
    }
} 
```

StructureMap 用于为 IRepository 和 IService 定义具体类型，并且 DBContext 由 DSL 注册表配置的 Lamba 表达式 - () => new DBContext() 构造。

**目前没有缓存DBContext**

关于问题：

我的索引页面加载并同时向 ControllerOne 和 ControllerTwo 发出两个 Ajax 请求，这些请求是通过 MvcContrib 的 StructureMap 控制器工厂构造的。

StructureMap 正在注入 IService 的具体类型，而这些类型又是使用配置的 IRepository 实例和新的 DBContext 对象创建的。

ControllerOne 正在从 IService 实例请求模型，然后将其作为 JsonActionResult 返回，由 Newtonsoft.Json 呈现。

ControllerTwo 向 IService 实例请求不同的模型，当 MVC 框架执行 ActionResult 时，该模型也被序列化为 Json 对象。

我在 VS2008 中通过 Cassini 运行网站。

我不时看到的问题是从 LinqToSql 内部生成的错误

*   无法读取数据，已经有一个读取器打开或
*   由于数据已经存在，因此无法将数据加载到数据表中（目前我没有确切的例外情况，但两者都是 LinqToSql 内部的）。

如果错误发生在 ControllerOne 中，那么 ControllerTwo 也会失败并出现类似的错误，就好像这两个请求正在使用共享对象运行一样。

它不会一直出错，但足以让我担心我的架构以及它在某种程度上配置错误。

StructureMap 是否可以在后续请求中返回相同的 ControllerOne 和 ControllerTwo 实例，或者是否以任何方式缓存 DBContext？即使我没有要求它？

有没有人在 Visual Studio / Cassini 中工作时看到过类似的东西？通过 IIS 有帮助吗？

我应该删除 LinqToSql 吗？

关闭 Visual Studio 并再次打开通常可以在一段时间内解决问题。

非常感谢，如果有人能阐明这个问题。

编辑：包括来自 NLog 日志文件的日志记录片段（线程 id 是分号前的数字）：

```
03/20/2009 01:40:32 12: controller=Timesheet,date=2001-05-06,Action=WeekEnding /beta/Timesheet/2001-05-06?_dc=1237513232397 
03/20/2009 01:40:32 10: controller=Timesheet,date=2001-05-06,Action=WeekEnding /beta/Timesheet/2001-05-06?_dc=1237513232449 
03/20/2009 01:40:32 10: There is already an open DataReader associated with this Command which must be closed first. System.InvalidOperationException[br]   at System.Data.SqlClient.SqlInternalConnectionTds.ValidateConnectionForExecute(SqlCommand command)
   at System.Data.SqlClient.SqlConnection.ValidateConnectionForExecute(String method, SqlCommand command)
   at System.Data.SqlClient.SqlCommand.ValidateCommand(String method, Boolean async)
   at System.Data.SqlClient.SqlCommand.RunExecuteReader(CommandBehavior cmdBehavior, RunBehavior runBehavior, Boolean returnStream, String method, DbAsyncResult result)
   at System.Data.SqlClient.SqlCommand.RunExecuteReader(CommandBehavior cmdBehavior, RunBehavior runBehavior, Boolean returnStream, String method)
   at System.Data.SqlClient.SqlCommand.ExecuteReader(CommandBehavior behavior, String method)
   at System.Data.SqlClient.SqlCommand.ExecuteDbDataReader(CommandBehavior behavior)
   at System.Data.Common.DbCommand.ExecuteReader()
   at System.Data.Linq.SqlClient.SqlProvider.Execute(Expression query, QueryInfo queryInfo, IObjectReaderFactory factory, Object[] parentArgs, Object[] userArgs, ICompiledSubQuery[] subQueries, Object lastResult)
   at System.Data.Linq.SqlClient.SqlProvider.ExecuteAll(Expression query, QueryInfo[] queryInfos, IObjectReaderFactory factory, Object[] userArguments, ICompiledSubQuery[] subQueries)
   at System.Data.Linq.SqlClient.SqlProvider.System.Data.Linq.Provider.IProvider.Execute(Expression query)
   at System.Data.Linq.DataQuery`1.System.Linq.IQueryProvider.Execute[S](Expression expression)
   at System.Linq.Queryable.Sum[TSource](IQueryable`1 source, Expression`1 selector)
   at HCD.Intranet.Core.Data.Linq.LinqEmployeeRepository.CalculateHolidaysRemaining(Employee employee, DateTime weekEnding, Int32 nonProjectId)
   at HCD.Intranet.Core.Services.Impl.EmployeeService.CalculateHolidaysRemaining(Employee employee, DateTime weekEnding)
   at HCD.Intranet.Core.Models.Timesheet.CalculateHolidaysRemaining()
   at HCD.Intranet.Core.Models.Json.TimesheetJsonConverter.WriteTimesheet(JsonWriter writer, Timesheet timesheet)
   at HCD.Intranet.Core.Models.Json.TimesheetJsonConverter.WriteJson(JsonWriter writer, Object value)
   at Newtonsoft.Json.JsonSerializer.SerializeValue(JsonWriter writer, Object value, JsonConverter memberConverter)
   at Newtonsoft.Json.JsonSerializer.WriteMemberInfoProperty(JsonWriter writer, Object value, JsonMemberMapping memberMapping)
   at Newtonsoft.Json.JsonSerializer.SerializeObject(JsonWriter writer, Object value)
   at Newtonsoft.Json.JsonSerializer.SerializeValue(JsonWriter writer, Object value, JsonConverter memberConverter)
   at Newtonsoft.Json.JsonSerializer.Serialize(JsonWriter jsonWriter, Object value)
   at HCD.Intranet.Core.Web.Mvc.NewtonsoftJsonResult.ExecuteResult(ControllerContext context)
   at System.Web.Mvc.ControllerActionInvoker.InvokeActionResult(ControllerContext controllerContext, ActionResult actionResult)
   at System.Web.Mvc.ControllerActionInvoker.<>c__DisplayClass11.<InvokeActionResultWithFilters>b__e()
   at System.Web.Mvc.ControllerActionInvoker.InvokeActionResultFilter(IResultFilter filter, ResultExecutingContext preContext, Func`1 continuation)
   at System.Web.Mvc.ControllerActionInvoker.<>c__DisplayClass11.<>c__DisplayClass13.<InvokeActionResultWithFilters>b__10()
   at System.Web.Mvc.ControllerActionInvoker.InvokeActionResultFilter(IResultFilter filter, ResultExecutingContext preContext, Func`1 continuation)
   at System.Web.Mvc.ControllerActionInvoker.<>c__DisplayClass11.<>c__DisplayClass13.<InvokeActionResultWithFilters>b__10()
   at System.Web.Mvc.ControllerActionInvoker.InvokeActionResultWithFilters(ControllerContext controllerContext, IList`1 filters, ActionResult actionResult)
   at System.Web.Mvc.ControllerActionInvoker.InvokeAction(ControllerContext controllerContext, String actionName)
03/20/2009 01:40:32 12: Invalid attempt to call Read when reader is closed. System.InvalidOperationException[br]   at System.Data.Linq.SqlClient.SqlProvider.Execute(Expression query, QueryInfo queryInfo, IObjectReaderFactory factory, Object[] parentArgs, Object[] userArgs, ICompiledSubQuery[] subQueries, Object lastResult)
   at System.Data.Linq.SqlClient.SqlProvider.ExecuteAll(Expression query, QueryInfo[] queryInfos, IObjectReaderFactory factory, Object[] userArguments, ICompiledSubQuery[] subQueries)
   at System.Data.Linq.SqlClient.SqlProvider.System.Data.Linq.Provider.IProvider.Execute(Expression query)
   at System.Data.Linq.DataQuery`1.System.Linq.IQueryProvider.Execute[S](Expression expression)
   at System.Linq.Queryable.Sum[TSource](IQueryable`1 source, Expression`1 selector)
   at HCD.Intranet.Core.Data.Linq.LinqEmployeeRepository.CalculateHolidaysRemaining(Employee employee, DateTime weekEnding, Int32 nonProjectId)
   at HCD.Intranet.Core.Services.Impl.EmployeeService.CalculateHolidaysRemaining(Employee employee, DateTime weekEnding)
   at HCD.Intranet.Core.Models.Timesheet.CalculateHolidaysRemaining()
   at HCD.Intranet.Core.Models.Json.TimesheetJsonConverter.WriteTimesheet(JsonWriter writer, Timesheet timesheet)
   at HCD.Intranet.Core.Models.Json.TimesheetJsonConverter.WriteJson(JsonWriter writer, Object value)
   at Newtonsoft.Json.JsonSerializer.SerializeValue(JsonWriter writer, Object value, JsonConverter memberConverter)
   at Newtonsoft.Json.JsonSerializer.WriteMemberInfoProperty(JsonWriter writer, Object value, JsonMemberMapping memberMapping)
   at Newtonsoft.Json.JsonSerializer.SerializeObject(JsonWriter writer, Object value)
   at Newtonsoft.Json.JsonSerializer.SerializeValue(JsonWriter writer, Object value, JsonConverter memberConverter)
   at Newtonsoft.Json.JsonSerializer.Serialize(JsonWriter jsonWriter, Object value)
   at HCD.Intranet.Core.Web.Mvc.NewtonsoftJsonResult.ExecuteResult(ControllerContext context)
   at System.Web.Mvc.ControllerActionInvoker.InvokeActionResult(ControllerContext controllerContext, ActionResult actionResult)
   at System.Web.Mvc.ControllerActionInvoker.<>c__DisplayClass11.<InvokeActionResultWithFilters>b__e()
   at System.Web.Mvc.ControllerActionInvoker.InvokeActionResultFilter(IResultFilter filter, ResultExecutingContext preContext, Func`1 continuation)
   at System.Web.Mvc.ControllerActionInvoker.<>c__DisplayClass11.<>c__DisplayClass13.<InvokeActionResultWithFilters>b__10()
   at System.Web.Mvc.ControllerActionInvoker.InvokeActionResultFilter(IResultFilter filter, ResultExecutingContext preContext, Func`1 continuation)
   at System.Web.Mvc.ControllerActionInvoker.<>c__DisplayClass11.<>c__DisplayClass13.<InvokeActionResultWithFilters>b__10()
   at System.Web.Mvc.ControllerActionInvoker.InvokeActionResultWithFilters(ControllerContext controllerContext, IList`1 filters, ActionResult actionResult)
   at System.Web.Mvc.ControllerActionInvoker.InvokeAction(ControllerContext controllerContext, String actionName)
03/20/2009 01:41:58 12: controller=Timesheet,month=6,year=2001,Action=Calendar /beta/Timesheet/Calendar/6/2001?_dc=1237513318470 
03/20/2009 01:41:59 10: controller=Timesheet,date=2001-06-03,Action=WeekEnding /beta/Timesheet/2001-06-03?_dc=1237513318509 
03/20/2009 01:41:59 12: The null value cannot be assigned to a member with type System.Int32 which is a non-nullable value type. System.InvalidOperationException[br]   at Read_TimesheetEntry(ObjectMaterializer`1 )
   at System.Data.Linq.SqlClient.ObjectReaderCompiler.ObjectReader`2.MoveNext()
   at System.Collections.Generic.List`1..ctor(IEnumerable`1 collection)
   at System.Linq.Enumerable.ToList[TSource](IEnumerable`1 source)
   at HCD.Intranet.Core.Data.Linq.LinqTimesheetRepository.GetEntries(Int32 timesheetHeaderId)
   at HCD.Intranet.Core.Services.Impl.TimesheetService.GetEntries(Int32 timesheetHeaderId)
   at HCD.Intranet.Core.Models.Timesheet.get_InnerEntries()
   at HCD.Intranet.Core.Models.TimeMap..ctor(Timesheet timesheet)
   at HCD.Intranet.Core.Models.Json.TimesheetCalendarJsonConverter.WriteTimesheet(JsonWriter writer, Timesheet[] timesheets)
   at HCD.Intranet.Core.Models.Json.TimesheetCalendarJsonConverter.WriteJson(JsonWriter writer, Object value)
   at Newtonsoft.Json.JsonSerializer.SerializeValue(JsonWriter writer, Object value, JsonConverter memberConverter)
   at Newtonsoft.Json.JsonSerializer.Serialize(JsonWriter jsonWriter, Object value)
   at HCD.Intranet.Core.Web.Mvc.NewtonsoftJsonResult.ExecuteResult(ControllerContext context)
   at System.Web.Mvc.ControllerActionInvoker.InvokeActionResult(ControllerContext controllerContext, ActionResult actionResult)
   at System.Web.Mvc.ControllerActionInvoker.<>c__DisplayClass11.<InvokeActionResultWithFilters>b__e()
   at System.Web.Mvc.ControllerActionInvoker.InvokeActionResultFilter(IResultFilter filter, ResultExecutingContext preContext, Func`1 continuation)
   at System.Web.Mvc.ControllerActionInvoker.<>c__DisplayClass11.<>c__DisplayClass13.<InvokeActionResultWithFilters>b__10()
   at System.Web.Mvc.ControllerActionInvoker.InvokeActionResultFilter(IResultFilter filter, ResultExecutingContext preContext, Func`1 continuation)
   at System.Web.Mvc.ControllerActionInvoker.<>c__DisplayClass11.<>c__DisplayClass13.<InvokeActionResultWithFilters>b__10()
   at System.Web.Mvc.ControllerActionInvoker.InvokeActionResultWithFilters(ControllerContext controllerContext, IList`1 filters, ActionResult actionResult)
   at System.Web.Mvc.ControllerActionInvoker.InvokeAction(ControllerContext controllerContext, String actionName)
03/20/2009 01:41:59 12: controller=Timesheet,date=2001-06-03,Action=WeekEnding /beta/Timesheet/2001-06-03?_dc=1237513318545 
03/20/2009 01:41:59 12: There is already an open DataReader associated with this Command which must be closed first. System.InvalidOperationException[br]   at System.Data.SqlClient.SqlInternalConnectionTds.ValidateConnectionForExecute(SqlCommand command)
   at System.Data.SqlClient.SqlConnection.ValidateConnectionForExecute(String method, SqlCommand command)
   at System.Data.SqlClient.SqlCommand.ValidateCommand(String method, Boolean async)
   at System.Data.SqlClient.SqlCommand.RunExecuteReader(CommandBehavior cmdBehavior, RunBehavior runBehavior, Boolean returnStream, String method, DbAsyncResult result)
   at System.Data.SqlClient.SqlCommand.RunExecuteReader(CommandBehavior cmdBehavior, RunBehavior runBehavior, Boolean returnStream, String method)
   at System.Data.SqlClient.SqlCommand.ExecuteReader(CommandBehavior behavior, String method)
   at System.Data.SqlClient.SqlCommand.ExecuteDbDataReader(CommandBehavior behavior)
   at System.Data.Common.DbCommand.ExecuteReader()
   at System.Data.Linq.SqlClient.SqlProvider.Execute(Expression query, QueryInfo queryInfo, IObjectReaderFactory factory, Object[] parentArgs, Object[] userArgs, ICompiledSubQuery[] subQueries, Object lastResult)
   at System.Data.Linq.SqlClient.SqlProvider.ExecuteAll(Expression query, QueryInfo[] queryInfos, IObjectReaderFactory factory, Object[] userArguments, ICompiledSubQuery[] subQueries)
   at System.Data.Linq.SqlClient.SqlProvider.System.Data.Linq.Provider.IProvider.Execute(Expression query)
   at System.Data.Linq.DataQuery`1.System.Linq.IQueryProvider.Execute[S](Expression expression)
   at System.Linq.Queryable.Sum[TSource](IQueryable`1 source, Expression`1 selector)
   at HCD.Intranet.Core.Data.Linq.LinqEmployeeRepository.CalculateHolidaysRemaining(Employee employee, DateTime weekEnding, Int32 nonProjectId)
   at HCD.Intranet.Core.Services.Impl.EmployeeService.CalculateHolidaysRemaining(Employee employee, DateTime weekEnding)
   at HCD.Intranet.Core.Models.Timesheet.CalculateHolidaysRemaining()
   at HCD.Intranet.Core.Models.Json.TimesheetJsonConverter.WriteTimesheet(JsonWriter writer, Timesheet timesheet)
   at HCD.Intranet.Core.Models.Json.TimesheetJsonConverter.WriteJson(JsonWriter writer, Object value)
   at Newtonsoft.Json.JsonSerializer.SerializeValue(JsonWriter writer, Object value, JsonConverter memberConverter)
   at Newtonsoft.Json.JsonSerializer.WriteMemberInfoProperty(JsonWriter writer, Object value, JsonMemberMapping memberMapping)
   at Newtonsoft.Json.JsonSerializer.SerializeObject(JsonWriter writer, Object value)
   at Newtonsoft.Json.JsonSerializer.SerializeValue(JsonWriter writer, Object value, JsonConverter memberConverter)
   at Newtonsoft.Json.JsonSerializer.Serialize(JsonWriter jsonWriter, Object value)
   at HCD.Intranet.Core.Web.Mvc.NewtonsoftJsonResult.ExecuteResult(ControllerContext context)
   at System.Web.Mvc.ControllerActionInvoker.InvokeActionResult(ControllerContext controllerContext, ActionResult actionResult)
   at System.Web.Mvc.ControllerActionInvoker.<>c__DisplayClass11.<InvokeActionResultWithFilters>b__e()
   at System.Web.Mvc.ControllerActionInvoker.InvokeActionResultFilter(IResultFilter filter, ResultExecutingContext preContext, Func`1 continuation)
   at System.Web.Mvc.ControllerActionInvoker.<>c__DisplayClass11.<>c__DisplayClass13.<InvokeActionResultWithFilters>b__10()
   at System.Web.Mvc.ControllerActionInvoker.InvokeActionResultFilter(IResultFilter filter, ResultExecutingContext preContext, Func`1 continuation)
   at System.Web.Mvc.ControllerActionInvoker.<>c__DisplayClass11.<>c__DisplayClass13.<InvokeActionResultWithFilters>b__10()
   at System.Web.Mvc.ControllerActionInvoker.InvokeActionResultWithFilters(ControllerContext controllerContext, IList`1 filters, ActionResult actionResult)
   at System.Web.Mvc.ControllerActionInvoker.InvokeAction(ControllerContext controllerContext, String actionName)
03/20/2009 01:41:59 10: Invalid attempt to call Read when reader is closed. System.InvalidOperationException[br]   at System.Data.Linq.SqlClient.SqlProvider.Execute(Expression query, QueryInfo queryInfo, IObjectReaderFactory factory, Object[] parentArgs, Object[] userArgs, ICompiledSubQuery[] subQueries, Object lastResult)
   at System.Data.Linq.SqlClient.SqlProvider.ExecuteAll(Expression query, QueryInfo[] queryInfos, IObjectReaderFactory factory, Object[] userArguments, ICompiledSubQuery[] subQueries)
   at System.Data.Linq.SqlClient.SqlProvider.System.Data.Linq.Provider.IProvider.Execute(Expression query)
   at System.Data.Linq.DataQuery`1.System.Linq.IQueryProvider.Execute[S](Expression expression)
   at System.Linq.Queryable.Sum[TSource](IQueryable`1 source, Expression`1 selector)
   at HCD.Intranet.Core.Data.Linq.LinqEmployeeRepository.CalculateHolidaysRemaining(Employee employee, DateTime weekEnding, Int32 nonProjectId)
   at HCD.Intranet.Core.Services.Impl.EmployeeService.CalculateHolidaysRemaining(Employee employee, DateTime weekEnding)
   at HCD.Intranet.Core.Models.Timesheet.CalculateHolidaysRemaining()
   at HCD.Intranet.Core.Models.Json.TimesheetJsonConverter.WriteTimesheet(JsonWriter writer, Timesheet timesheet)
   at HCD.Intranet.Core.Models.Json.TimesheetJsonConverter.WriteJson(JsonWriter writer, Object value)
   at Newtonsoft.Json.JsonSerializer.SerializeValue(JsonWriter writer, Object value, JsonConverter memberConverter)
   at Newtonsoft.Json.JsonSerializer.WriteMemberInfoProperty(JsonWriter writer, Object value, JsonMemberMapping memberMapping)
   at Newtonsoft.Json.JsonSerializer.SerializeObject(JsonWriter writer, Object value)
   at Newtonsoft.Json.JsonSerializer.SerializeValue(JsonWriter writer, Object value, JsonConverter memberConverter)
   at Newtonsoft.Json.JsonSerializer.Serialize(JsonWriter jsonWriter, Object value)
   at HCD.Intranet.Core.Web.Mvc.NewtonsoftJsonResult.ExecuteResult(ControllerContext context)
   at System.Web.Mvc.ControllerActionInvoker.InvokeActionResult(ControllerContext controllerContext, ActionResult actionResult)
   at System.Web.Mvc.ControllerActionInvoker.<>c__DisplayClass11.<InvokeActionResultWithFilters>b__e()
   at System.Web.Mvc.ControllerActionInvoker.InvokeActionResultFilter(IResultFilter filter, ResultExecutingContext preContext, Func`1 continuation)
   at System.Web.Mvc.ControllerActionInvoker.<>c__DisplayClass11.<>c__DisplayClass13.<InvokeActionResultWithFilters>b__10()
   at System.Web.Mvc.ControllerActionInvoker.InvokeActionResultFilter(IResultFilter filter, ResultExecutingContext preContext, Func`1 continuation)
   at System.Web.Mvc.ControllerActionInvoker.<>c__DisplayClass11.<>c__DisplayClass13.<InvokeActionResultWithFilters>b__10()
   at System.Web.Mvc.ControllerActionInvoker.InvokeActionResultWithFilters(ControllerContext controllerContext, IList`1 filters, ActionResult actionResult)
   at System.Web.Mvc.ControllerActionInvoker.InvokeAction(ControllerContext controllerContext, String actionName) 
```

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2009-03-16T17:42:47.350

我正在与 Jeremy Miller 讨论这个问题，您*不想*使用 SM 管理数据库上下文的生命周期 - 让 repo 根据需要进行实例化。这给您将如何进行对象更新/持久性带来了问题（如果您依赖于一个上下文为多个请求保持活动状态），但是对于 Web 应用程序*不*依赖它是值得的。

出于这样的原因，我不得不从店面中删除数据库上下文管理的东西——我遇到了内存泄漏。我不会说这是 SM 的错——但总的来说，只是让 repo 打开一个新的上下文。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2009-03-16T12:16:41.627

添加：

```
MultipleActiveResultSets=True 
```

到连接字符串的末尾（假设 MSSQL 2005+）

要为您的 linq 上下文执行此操作：打开属性选项卡 -> 展开连接 -> 单击“连接字符串”上的“...” -> '高级' -> 'MultipleActiveResultSets' -> true。

我今天自己解决了这个问题，我的架构几乎相同（除了统一而不是结构图）。包括通过 JS 加载的两个控制器！

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2009-03-16T16:15:05.393

将 DI 容器与 ASP.NET MVC 一起使用时的一个常见错误是许多 DI 容器默认为单例模式。我不知道这里是否是这种情况，但你应该仔细检查一下。ASP.NET MVC 要求在每个请求上创建控制器，因为它具有每个请求的状态和上下文。

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2009-03-17T02:36:17.223

您是否完全确定对象层次结构中没有任何内容被缓存/或具有生命周期配置？我有一个配置如下的产品应用程序：

```
 ForRequestedType<SomeDataContext>().TheDefault.Is.ConstructedBy(
        () => new SomeDataContext(someConnString); 
```

它没有使用 asp.net MVC。关于范围问题，如果您没有设置任何内容，结构映射将默认为 PerRequest（不是 asp.net 请求，而是结构映射请求，如每个 .GetInstance 调用） - [http://structuremap.sourceforge.net/Scoping。 .htm](http://structuremap.sourceforge.net/Scoping.htm) _ 如果您肯定没有配置会影响它，那么请查看 mvc contrib 或其他东西是否可能正在重用实例。

* * *

关于发布的异常信息。该错误涉及操作结果、操作结果过滤器、json 序列化、自定义方法的组合，以及一个 linq2sql 调用因意外 null 而失败。这是许多不同部分的组合，其中一些我不知道。我会玩得更安全，并将在进行序列化时调用的计算内容（调用 linq2sql）移动到不涉及 json 序列化/动作结果片段的其他地方。这只是一个疯狂的猜测，因为我不知道这些部分是如何/何时被调用的，以及它们在内部有什么类型的操作。

# html - 在哪里放置页面导航链接

> ID：650067
> 
> 赞同：1
> 
> 时间：2009-03-16T11:43:13.503
> 
> 标签：html, navigation

我想知道将网页上的第一行“重要”链接/按钮复制到底部有什么好处？
传统上，表单或页面的底部用于放置站点地图和隐私信息等无聊的东西；但; 在您向下滚动许多页面的页面中（写得很有趣），不得不返回顶部单击“问题”或“提问”等链接是一件痛苦的事情。我希望底部复制页面的顶部。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-03-16T11:49:51.130

这是非常主观的，并且实际上取决于所讨论的网页。如果，正如您所暗示的那样，页面很长并且涉及大量滚动，那么在底部重复链接可能在可用性方面是一个好主意。但是，很长的页面可能会暗示网站设计可以与一些外观有关，因为这通常被认为不是好的设计（同样是主观的，因为这取决于网站的内容和功能。）

“不要让我思考”通常被认为是网页设计的权威来源，因此将是开始获得这些类型问题的答案的好地方。

底线是您可以随意设计您的页面，如果您认为在页面底部重复导航会更加用户友好，那么请继续。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2009-03-16T11:54:01.057

多个地方的导航对我来说似乎很好。我见过很多页面，其中主要导航项在底部重复。我认为它非常方便。

值得研究 CSS 替代方案，例如 www.anncoulter.com 等网站上的固定导航。此方法将导航块放置在相对于滚动位置保持在一个位置的一侧；也就是说，它永远不会移动。我提到 Ann Coulter 网站只是因为它是我所见过的最顺利的概念执行。

不过，它似乎在 IE7 中不起作用。FF、Opera、Chrome 和 Safari for Windows 都可以正常工作；在 IE7 中，导航块随着页面顶部滚动而看不见。

史蒂夫·厄巴赫·
尼纳，威斯康星州

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-03-16T12:08:53.517

我的网页设计很生疏，但在 6 到 8 年前，在页面底部重复导航以及添加`'back to top'`链接被认为是一种很好的做法：

> 主页 | 新闻 | 联系方式 | 链接 | （回到顶部）

但我个人最喜欢的是固定导航 div，以便它始终可见，无论你滚动多远，正如[serbach](https://stackoverflow.com/questions/650067/where-to-put-page-navigation-links/650092#650092)建议的那样。但是IE6让我很头疼，这也是我放弃这个想法的原因。我相信 IE8 有一个改进的 css 实现，所以你可能想看看这个。

# flex3 - Flex 3 中的 for 循环

> ID：650072
> 
> 赞同：0
> 
> 时间：2009-03-16T11:46:04.040
> 
> 标签：flex3, for-loop, mxml

我想使用我的 mxml 代码创建一个循环，以基于整数值创建可变数量的输入字段，该值是获取数据库表中列数的调用的结果。

我曾尝试使用中继器组件，但它需要一个数组，而我的调用是一个 int。

flex mxml 中有什么东西可以取一个 int 然后根据需要循环吗？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-03-16T12:08:57.513

我建议创建一个基于整数构建所需数组的函数，并将生成的数组提供给中继器。

我希望这会有所帮助，现在没有更多时间了；）

# mysql - InnoDB 隐藏自动增量和双主

> ID：650073
> 
> 赞同：0
> 
> 时间：2009-03-16T11:46:41.870
> 
> 标签：mysql, replication, innodb

当创建一个没有主键的 InnoDB 表时，会创建一个“隐藏的”自动 inc 键并将其用于索引。有谁知道这把钥匙是否是多主安全的？

如果在多主数据库中设置自动 incs，标准的 mysql 方法是将 auto_increment_increment 和 auto_increment_offset 设置为适合您服务器数量的值。

InnoDB 的隐藏密钥是否尊重这些设置，或者它甚至需要这样做？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-04-24T15:09:38.770

由于隐藏值不会通过复制共享（无论 STATEMENT 或 ROW binlog 格式如何），因此它们是安全的。从站是否与主站拥有相同的内部值并不重要。auto_incrementing 字段和 InnoDB 的内部键之间没有关系。

关于复制没有主键的表的常见警告适用。

# java - ant 中的 unix2dos（或 dos2unix）

> ID：650075
> 
> 赞同：13
> 
> 时间：2009-03-16T11:47:42.103
> 
> 标签：java, ant, dos2unix

我如何用 ant 做 unix2dos（或 dos2unix）。即我想将换行从linux换行（如果有的话）更改为dos换行

* * *

## 回答 #1

> 赞同：22
> 
> 时间：2009-03-16T11:51:51.327

找到 - 这是 Ant [FixCRLF 任务](http://ant.apache.org/manual/Tasks/fixcrlf.html)。

* * *

## 回答 #2

> 赞同：5
> 
> 时间：2012-11-15T08:22:08.073

`fixcrlf`您可以在一组文件上使用内置的ant 任务，而不是使用`dos2unix`.
下面的例子相当于在“SQL”目录下的`dos2unix`所有文件上运行：`*.sql`

```
<fixcrlf srcdir="${SQL}" includes="**/*.sql" eol="lf" eof="remove" /> 
```

[更多详细信息，请参阅](https://ant.apache.org/manual/Tasks/fixcrlf.html)。

# visual-studio-2008 - VS 2008的Visual Studio 2010配色方案？

> ID：650077
> 
> 赞同：3
> 
> 时间：2009-03-16T11:48:52.817
> 
> 标签：visual-studio-2008, color-scheme

有谁知道 Visual Studio 2008 是否存在配色方案，所以它看起来更像新的 Visual Studio 2010？如果不是整个 IDE，那么至少是“字体颜色”部分。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2010-01-19T13:38:39.623

微软可能想出的最糟糕的配色方案，深蓝色在一段时间内看起来不错，但肯定不能一次忍受几个小时，让我觉得我盯着一个愚蠢的黑暗窗口。（不知道如何解释，但整体配色方案完全烂透了，作为开发人员，您不能长时间使用它）

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2010-01-19T14:00:03.880

我认为找到这样的配色方案你不会很幸运，因为 Visual Studio 2008 选项对话框中的“字体和颜色”页面只处理代码编辑器的内容。

2008 年和 2010 年之间更改的颜色在代码编辑器*之外*，例如在代码编辑器和其他内部窗口之间的“背景”上，如以下示例屏幕转储所示：

**Visual Studio 2008** [（来源：][[visitmix.com](http://visitmix.com/labs/rosetta/images/ftsl/setup/screen3_800.jpg)][）][![](https://i.stack.imgur.com/LGbEt.jpg)](https://i.stack.imgur.com/LGbEt.jpg)

**视觉工作室 2010** ![](https://edotnetdevs.files.wordpress.com/2009/02/vs2010image.png)

# wpf - WPF 列表框向下滚动

> ID：650085
> 
> 赞同：2
> 
> 时间：2009-03-16T11:51:58.737
> 
> 标签：wpf, scrollbar

假设我有一个包含许多项目的列表框，因此会出现垂直滚动，但我已经隐藏了滚动条

```
ScrollViewer.VerticalScrollBarVisibility="Hidden" 
```

有什么办法可以为我添加一个向下滚动的按钮？iv尝试添加

```
Command="ScrollBar.LineDownCommand" 
```

到一个按钮，但没有任何效果。

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2009-03-16T12:26:31.027

您需要告诉 WPF 从哪里开始寻找命令处理程序。不告诉它，它会从 开始查找`Button`并且找不到任何处理`LineDownCommand`. 不幸的是，将它设置为 是`ListBox`不够的，因为它`ScrollViewer`是*模板*的`ListBox`一部分，所以 WPF 仍然找不到它。

将其设置为`ListBoxItem`s 之一是不正常的，但有效：

```
<Window x:Class="WpfApplication1.Window1"
    xmlns="http://schemas.microsoft.com/winfx/2006/xaml/presentation"
    xmlns:x="http://schemas.microsoft.com/winfx/2006/xaml"
    Title="Window1" Height="300" Width="300">
    <Grid>
        <Grid.RowDefinitions>
            <RowDefinition Height="*"/>
            <RowDefinition Height="Auto"/>
        </Grid.RowDefinitions>

        <ListBox x:Name="_listBox" ScrollViewer.VerticalScrollBarVisibility="Hidden">
            <ListBoxItem x:Name="_listBoxItem">One</ListBoxItem>
            <ListBoxItem>Two</ListBoxItem>
            <ListBoxItem>Three</ListBoxItem>
            <ListBoxItem>One</ListBoxItem>
            <ListBoxItem>Two</ListBoxItem>
            <ListBoxItem>Three</ListBoxItem>
            <ListBoxItem>One</ListBoxItem>
            <ListBoxItem>Two</ListBoxItem>
            <ListBoxItem>Three</ListBoxItem>
            <ListBoxItem>One</ListBoxItem>
            <ListBoxItem>Two</ListBoxItem>
            <ListBoxItem>Three</ListBoxItem>
        </ListBox>
        <Button Grid.Row="1" Command="ScrollBar.LineDownCommand" CommandTarget="{Binding ElementName=_listBoxItem}">Scroll Down</Button>
    </Grid>
</Window> 
```

一个更好的方法是重新模板`ListBox`并将其粘贴在`Button`模板内部，或者`CommandTarget`在代码隐藏中连接。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-03-17T20:45:22.530

我有一个应用程序，我想手动控制 ScrollViewer 的滚动。基本上，我得到了 ScrollViewer 的引用，然后使用 ScrollToHorizo​​ntalOffset() 方法来控制滚动。以下是我解释我使用的过程的博客文章：

[http://www.developingfor.net/wpf/fun-with-the-wpf-scrollviewer.html](http://www.developingfor.net/wpf/fun-with-the-wpf-scrollviewer.html)

[http://www.developingfor.net/wpf/more-fun-with-wpf-scrollviewer.html](http://www.developingfor.net/wpf/more-fun-with-wpf-scrollviewer.html)

# asp.net-mvc - 保护 mvc 视图，以便只有服务器可以访问它

> ID：650090
> 
> 赞同：1
> 
> 时间：2009-03-16T11:53:51.213
> 
> 标签：asp.net-mvc

我正在构建一个 .Net MVC 应用程序，我在其中使用一个特定视图来生成内部报告。我根本不希望该站点的用户访问此页面。

我有一个控制台应用程序，它会经常触发它，它会通过点击它的 URL 从这个页面中抓取一些细节。

我不喜欢将 URL 挂在那里的想法，但我不确定另一种解决方法。

关于解决这个问题的最佳实践方法的想法是什么？

编辑：

这是我最终做的，在解决方案中创建了一个新的 WCF 服务项目。我还基本上将 MVC 视图页面复制*到*了该项目中的新标准 Web 表单页面中。除了通过常规的 .net 身份验证方法添加安全性（例如，设置只有有效的 Windows 用户可以访问该页面）之外，我还可以将虚拟主机锁定为只能由某些 IP 访问。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-03-16T12:08:42.567

最佳实践是为此公开 wcf 服务，并设置与网站不同的安全模型。

如果必须使用 MVC，最好的方法是使用带有 mvc 的表单身份验证并设置

```
[Authorize(Roles = "SecureUser")] 
```

在视图上。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-03-16T12:00:24.130

如果视图根本不需要渲染，除了为控制台应用程序提供数据，那么为什么不让控制台应用程序简单地连接到您的数据库以直接获取数据，而不是通过 Web 应用程序呢？即使视图确实需要对某些用户可用，您仍然可以为控制台应用程序执行此操作，然后使用 Authorization 属性控制对视图的访问，现在可以适当地限制外部应用程序不需要访问它。

# c++ - 在 C++ 中使用抽象类

> ID：650091
> 
> 赞同：16
> 
> 时间：2009-03-16T11:53:58.703
> 
> 标签：c++, abstract-class, parameters

在将扩展对象作为参数传递给函数时，我尝试使用抽象类，但到目前为止我的尝试导致了一些编译器错误。

我有一些关于问题所在的线索，我显然不允许实例化抽象类，而且我相信 MyClass 中的一些代码正在尝试这样做，即使这不是我的意图。一些研究表明我应该将该对象作为指针引用来实现我想要的，但到目前为止我的尝试都失败了，我什至不确定这是不是答案（因此我在这里问）。

现在我将提交我对 Java 比对 C++ 更熟悉，并且我确信我的部分问题是由于这个。

这是我在我的程序中尝试做的一个例子：

```
class A {
    public:
        virtual void action() = 0;
};

class B : public A {
    public:
        B() {}

        void action() {
            // Do stuff
        }
};

class MyClass {

    public:

        void setInstance(A newInstance) {
            instance = newInstance;
        }

        void doSomething() {
            instance.action();
        }

    private:

        A instance;
};

int main(int argc, char** argv) {
    MyClass c;
    B myInstance;
    c.setInstance(myInstance);
    c.doSomething();
    return 0;
} 
```

此示例产生了与我在程序中遇到的相同的编译器错误：

```
sean@SEAN-PC:~/Desktop$ gcc -o test test.cpp
test.cpp:20: error: cannot declare parameter ‘newInstance’ to be of abstract type ‘A’
test.cpp:2: note:   because the following virtual functions are pure within ‘A’:
test.cpp:4: note:   virtual void A::action()
test.cpp:30: error: cannot declare field ‘MyClass::instance’ to be of abstract type ‘A’
test.cpp:2: note:   since type ‘A’ has pure virtual functions
test.cpp: In function ‘int main(int, char**)’:
test.cpp:36: error: cannot allocate an object of abstract type ‘A’
test.cpp:2: note:   since type ‘A’ has pure virtual functions 
```

## 更新

感谢大家的反馈。

从那以后，我将“MyClass::instance”更改为包含 A 类型的指针，但现在我得到了一些与 vtable 相关的奇怪错误：

```
sean@SEAN-PC:~/Desktop$ gcc -o test test.cpp
/tmp/ccoEdRxq.o:(.rodata._ZTI1B[typeinfo for B]+0x0): undefined reference to `vtable for __cxxabiv1::__si_class_type_info'
/tmp/ccoEdRxq.o:(.rodata._ZTI1A[typeinfo for A]+0x0): undefined reference to `vtable for __cxxabiv1::__class_type_info'
/tmp/ccoEdRxq.o:(.rodata._ZTV1A[vtable for A]+0x8): undefined reference to `__cxa_pure_virtual'
collect2: ld returned 1 exit status 
```

我的修改代码如下（A和B没有修改）：

```
class MyClass {

    public:

        void setInstance(A* newInstance) {
            instance = newInstance;
        }

        void doSomething() {
            instance->action();
        }

    private:

        A* instance;
};

int main(int argc, char** argv) {
    MyClass c;
    B myInstance;
    c.setInstance(&myInstance);
    c.doSomething();
    return 0;
} 
```

* * *

## 回答 #1

> 赞同：27
> 
> 时间：2009-03-16T12:07:37.030

您的问题是您应该在函数中接受引用。原因是引用实际上并没有复制传递的参数。但是，如果您接受`A`- 而不是引用`A&`- 那么您实际上将传递的参数复制到参数对象中，而您得到的是一个类型的对象`A`- 但实际上这是不允许的！

```
 // the reference parameter will reference the actual argument
    void setInstance(A &newInstance) {
            // assign the address of the argument to the pointer member
            // instance. 
            instance = &newInstance;
    } 
```

然后您必须将类中的成员更改为指针。它不能是一个引用，因为`setInstance`它会改变它所引用的内容——一个引用在其整个生命周期内只能引用一个对象，而一个指针可以通过重新分配一个不同的地址来设置指向做不同的事情。剩下的部分看起来像这样

```
 void doSomething() {
        // call a member function on the object pointed to
        // by instance!
        instance->action();
    }

private:

    // a pointer to some object derived from A
    A *instance; 
```

另请注意，您必须使用 编译 C++ 程序`g++`，因为它另外将 C++ 标准库链接到您的代码

```
g++ -o test test.cpp # instead of gcc! 
```

* * *

## 回答 #2

> 赞同：5
> 
> 时间：2009-03-16T12:00:00.763

您所做的将在 Java 中起作用，因为声明“A”类型的参数或成员变量实际上意味着“指向 A 的指针”。在 C++ 中，您实际上需要明确这一点，因为它们是两个不同的东西：

```
void setInstance(A* newInstance) { // pointer to an "A"
                instance = newInstance;
} 
```

并在声明中：

```
A* instance; // Not an actual "A", but a pointer to an "A" 
```

* * *

## 回答 #3

> 赞同：3
> 
> 时间：2009-03-16T12:11:44.463

我相信这就是你想要做的。它通过实际打印出取决于句柄类是否指向 B 或 C 的实例来演示多态性。其他人是正确的，您可能还需要一个虚拟析构函数。

这编译： g++ test.cpp -o Test

```
#include <stdio.h>

class A {
    public:
        virtual void action() = 0;
};

class B : public A {
    public:
        B() {}

        void action() {
                printf("Hello World\n");
        }
};

class C : public A {
    public:
        C() {}

        void action() {
                printf("Goodbye World\n");
        }
};

class AHandleClass {

    public:

        void setInstance(A *A_Instance) {
                APointer = A_Instance;
        }

        void doSomething() {
                APointer->action();
        }

    private:

        A *APointer;
};

int main(int argc, char** argv) {
    AHandleClass AHandle;
    B BInstance;
    C CInstance;
    AHandle.setInstance(&BInstance);
    AHandle.doSomething();
    AHandle.setInstance(&CInstance);
    AHandle.doSomething();
    return 0;
} 
```

* * *

## 回答 #4

> 赞同：3
> 
> 时间：2009-03-16T12:32:20.763

你现在的问题是一个链接。对于 C++ 程序，必须添加标准 C++ 库：

gcc -o 测试**-lstdc++**测试.cpp

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2009-03-16T12:00:11.853

您应该将 A 存储为指针。

```
A* instance; 
```

编辑：我之前写过“参考”。C ++中存在差异。

* * *

## 回答 #6

> 赞同：1
> 
> 时间：2009-03-17T10:20:37.263

**如果您辞去 setter 并使用构造函数，则**不必使用指针。**这是 C++ 的重要特性之一：构造函数中的基本初始化程序通常允许避免使用指针。**

 **```
class MyClass {

        public:

                MyClass(A & newInstance) : instance(newInstance) {
                }

                void doSomething() {
                        instance.action();
                }

        private:

                A & instance;
};

int main(int argc, char** argv) {
        B myInstance;
        MyClass c(myInstance); 
```

* * *

## 回答 #7

> 赞同：1
> 
> 时间：2010-12-20T13:14:22.570

我之前包含了这个`parent.h`问题`iostream`：

错误的：

```
include "parent.h"
include <iostream> 
```

对：

```
include <iostream>
include "parent.h" 
```

* * *

## 回答 #8

> 赞同：1
> 
> 时间：2012-11-23T07:04:55.910

Johannes Schaub - litb 是正确的。

在 C++ 中，抽象类不能用作函数的参数或返回类型。我们不能实例化一个抽象对象。

所以需要使用&或*。

* * *

## 回答 #9

> 赞同：0
> 
> 时间：2009-03-16T12:02:22.833

您必须使用指向 A 的指针作为 MyClass 的成员。

```
class MyClass {

    public:

        void setInstance(A *newInstance) {
                instance = newInstance;
        }

        void doSomething() {
                instance->action();
        }

    private:

        A *instance;
}; 
```

如果您不这样做，MyClass 构造函数将尝试实例化一个 A 对象（就像对任何成员对象一样），这是不可能的，因为 A 是抽象的。

* * *

## 回答 #10

> 赞同：0
> 
> 时间：2009-03-16T12:05:29.877

当你说

```
A instance; 
```

您将创建一个类型为 A 的新对象。但是您已经说过 A 是一个抽象类，所以您不能这样做。正如其他几个人所指出的那样，您需要使用指针，或者使 A 非抽象。

* * *

## 回答 #11

> 赞同：0
> 
> 时间：2009-03-16T12:37:01.437

Dmitry 是正确的，如果你使用 gcc，你应该使用 -lstdc++，但更好的是使用它`g++`。（相同的语法）。
此外，您会注意到（我猜如果您添加 -Wall）您会收到警告说您的带有虚函数的类没有析构函数，所以一个好主意是向 A 添加一个（虚拟）析构函数。

# javascript - XHTML/CSS/Javascript 方法使表列可选？

> ID：650093
> 
> 赞同：0
> 
> 时间：2009-03-16T11:55:51.320
> 
> 标签：javascript, css, xhtml, css-tables

我正在使用一个简单的 TABLE 来显示表格数据，其中行需要对齐，但是在选择表格内容时，我只希望用户能够在每一列中进行选择。默认浏览器行为是在所有列中选择行，但我们需要以某种方式只允许在列中选择。

我希望有一种新奇的 CSS 或 XHTML 1.0 方式将表格定义为列而不是行，然后浏览器会在其中强制选择。我知道这可能是不可能的，并且需要构建一种 javascript 选择方式来覆盖浏览器选择。显然，像谷歌电子表格这样的 javascript 电子表格小部件允许根据我的需要在行和列中进行选择，但我希望找到一个基于 Prototype 构建的网格类型小部件或编写我自己的功能。

内置此列选择的小部件的任何提示或链接？是否有一个 HTML/CSS 技巧可以使这样的事情起作用？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-03-16T13:43:08.597

使用 colgroup 标签 - [http://www.w3schools.com/tags/tag_colgroup.asp](http://www.w3schools.com/tags/tag_colgroup.asp)

您可以将所需的任何样式应用于整个列。当鼠标在列中移动/单击时更改样式可以在 jquery 中完成......您可以使用此处其他答案中的脚本，但将“table td”选择器替换为“table colgroup”。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-03-16T12:06:56.597

我不确定您的意思，但您似乎希望能够以不同于其他列的方式为单个列着色。最简单的方法是使用 colgroup 和 col 标签：

css

```
.name {width:5em;background:#ccc;}
.value {width:3em;text-align:center;color:#f00;}
.comment {text-align:right;} 
```

HTML

```
<table>
<caption>My Test Table</caption>
<col class="name">
<colgroup class="value" span="3"></colgroup>
<col class="comment">
</colgroup>
<tr>
<th>Name</th>
<th>Value 1</th>
<th>Value 2</th>
<th>Value 3</th>
<th>Comment</th>
</tr>
<tr>
<td>Bob</td>
<td>Yes</td>
<td>No</td>
<td>42</td>
<td>I like cheese</td>
</tr>
<tr>
<td>Susan</td>
<td>No</td>
<td>Yes</td>
<td>42</td>
<td>Sharp Cheddar</td>
</tr>
</table> 
```

[从http://www.webmasterworld.com/forum83/6826.htm](http://www.webmasterworld.com/forum83/6826.htm)窃取的代码

只有一部分 CSS 属性可以在列上设置。W3C 有一个[列表](http://www.w3.org/TR/CSS2/tables.html#q4)。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2009-03-16T12:31:26.570

如果您只想在用户单击表格时突出显示一列，您可以使用[jquery轻松完成](http://jquery.com)

```
$("table td").bind('click',function(){
            $("table td").css('background','');
            $(this).css('background','green');
         }); 
```

# java - 2个类互相引用可以吗？

> ID：650094
> 
> 赞同：6
> 
> 时间：2009-03-16T11:55:51.663
> 
> 标签：java, class

如果我有一个类 gui 和一个逻辑类，是否在 gui 中引用逻辑和逻辑到 gui 非常糟糕？

* * *

## 回答 #1

> 赞同：11
> 
> 时间：2009-03-16T12:00:49.527

作为一般规则，让“逻辑”类了解“gui”类是不好的。分离背后的想法是模型/视图设计模式（或模型/视图/控制器）。视图将需要对模型的引用。仔细看看为什么模型需要对视图的引用。通常当模型需要向视图发送信息时使用事件侦听器（参见 javax.swing 表和模型列表的示例）。

* * *

## 回答 #2

> 赞同：5
> 
> 时间：2009-03-16T12:01:10.683

应该避免。在您的 GUI 中，您可以引用您的域逻辑，但您不应该在您的域逻辑中引用您的 GUI。

为什么 ？因为否则，您将没有优势将 GUI 和域逻辑拆分到单独的文件中。当您的 Logic 依赖于您的 GUI 时，您就不能将您的 Logic 与另一个 GUI 一起使用。

所以，你应该尽量避免这种从你的逻辑到你的 gui 的依赖，或者你应该对它进行抽象。

我希望我在这里说清楚。:)

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-03-16T11:59:12.090

如果你可以避免它，你可能应该。否则你以后可能会遇到很多循环依赖的问题。

他们真的必须互相了解吗，或者您是否可以有第三个“控制”概念来引用两者？

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2010-03-05T12:58:51.353

GUI 可能需要向逻辑类公开某种接口，以便在逻辑类发生更改时更新 GUI。

逻辑不应该直接了解 GUI 实现，只有它的接口。

[观察者模式](http://en.wikipedia.org/wiki/Observer_pattern)有时用于此目的。

# html - 闪过闪 - 问题

> ID：650097
> 
> 赞同：1
> 
> 时间：2009-03-16T11:57:37.290
> 
> 标签：html, css, flash

我的页面上有像背景一样的 flash，页面上的所有内容都在 html 标记中，女巫在那个 flash 上，效果很好。该闪光灯的封面 div 具有固定的位置 (position:fixed;) 样式，这对于滚动功能很重要。我的问题在于，当我尝试在当前页面中心的 iframe 中包含附加页面时，以及包含一些 flash 对象的新页面时，该对象在 iframe 中不可见，它在此处但位于固定 flash 对象上方，如果我从样式中删除 (position:fixed;) ，它是可见的，但我的滚动功能不像以前那样工作。什么css风格可以解决这个问题？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-03-16T12:13:04.320

您是否尝试过添加

```
<param name="wmode" value="opaque"> 
```

到`<object>`你看不到的flash元素的标签？这可能会有所帮助。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2016-10-24T20:18:42.790

如果您正在编写 HTML 5 滚动，则 Iframe 不支持如前所述，请使用 object 对象标记并设置参数。

```
 <object id="FlashID" classid="clsid:D27CDB6E-AE6D-11cf-96B8-444553540000" width="1000" height="600"><param name="movie" value="mainswf/f_cbt.swf" />
    <param name="quality" value="high" />
    <param name="wmode" value="opaque" />
    <param name="swfversion" value="11.0.0.0" />
    <!-- This param tag prompts users with Flash Player 6.0 r65 and higher to download the latest version of Flash Player. Delete it if you don’t want users to see the prompt. -->
    <param name="expressinstall" value="Scripts/expressInstall.swf" /> 
```

# c# - 如何使用 C# 执行 .SQL 脚本文件

> ID：650098
> 
> 赞同：151
> 
> 时间：2009-03-16T11:58:13.077
> 
> 标签：c#, sql, oracle, scripting

我确定这个问题已经得到解答，但是我无法使用搜索工具找到答案。

使用 c# 我想运行一个 .sql 文件。sql 文件包含多条 sql 语句，其中一些语句被分成多行。我尝试读取文件并尝试使用 ODP.NET 执行文件......但是我不认为 ExecuteNonQuery 真的是为了做到这一点而设计的。

因此，我尝试通过生成进程来使用 sqlplus ...但是，除非我使用设置为 true 的 UseShellExecute 生成进程，否则 sqlplus 会挂起并且永远不会退出。这是不起作用的代码。

```
Process p = new Process();
p.StartInfo.UseShellExecute = false;
p.StartInfo.RedirectStandardOutput = true;
p.StartInfo.FileName = "sqlplus";
p.StartInfo.Arguments = string.Format("xx/xx@{0} @{1}", in_database, s);
p.StartInfo.CreateNoWindow = true;

bool started = p.Start();
p.WaitForExit(); 
```

WaitForExit 永远不会返回......除非我将 UseShellExecute 设置为 true。UseShellExecute 的一个副作用是您无法捕获重定向的输出。

* * *

## 回答 #1

> 赞同：207
> 
> 时间：2009-11-13T12:12:00.250

```
using System;
using System.Collections.Generic;
using System.Linq;
using System.Web;
using System.Web.UI;
using System.Web.UI.WebControls;
using Microsoft.SqlServer.Management.Smo;
using Microsoft.SqlServer.Management.Common;
using System.IO;
using System.Data.SqlClient;

public partial class ExcuteScript : System.Web.UI.Page
{
    protected void Page_Load(object sender, EventArgs e)
    {
        string sqlConnectionString = @"Integrated Security=SSPI;Persist Security Info=False;Initial Catalog=ccwebgrity;Data Source=SURAJIT\SQLEXPRESS";

        string script = File.ReadAllText(@"E:\Project Docs\MX462-PD\MX756_ModMappings1.sql");

        SqlConnection conn = new SqlConnection(sqlConnectionString);

        Server server = new Server(new ServerConnection(conn));

        server.ConnectionContext.ExecuteNonQuery(script);
    }
} 
```

* * *

## 回答 #2

> 赞同：117
> 
> 时间：2011-10-12T13:48:30.983

我用 Microsoft.SqlServer.Management 尝试了这个解决方案，但它不适用于 .NET 4.0，所以我只使用 .NET libs 框架编写了另一个解决方案。

```
string script = File.ReadAllText(@"E:\someSqlScript.sql");

// split script on GO command
IEnumerable<string> commandStrings = Regex.Split(script, @"^\s*GO\s*$", RegexOptions.Multiline | RegexOptions.IgnoreCase);

Connection.Open();
foreach (string commandString in commandStrings)
{
    if (!string.IsNullOrWhiteSpace(commandString.Trim()))
    {
        using(var command = new SqlCommand(commandString, Connection))
        {
            command.ExecuteNonQuery();
        }
    }
}     
Connection.Close(); 
```

* * *

## 回答 #3

> 赞同：20
> 
> 时间：2017-08-09T15:42:25.933

这适用于 Framework 4.0 或更高版本。支持“GO”。还显示错误消息、行和 sql 命令。

```
using System.Data.SqlClient;

        private bool runSqlScriptFile(string pathStoreProceduresFile, string connectionString)
    {
        try
        {
            string script = File.ReadAllText(pathStoreProceduresFile);

            // split script on GO command
            System.Collections.Generic.IEnumerable<string> commandStrings = Regex.Split(script, @"^\s*GO\s*$",
                                     RegexOptions.Multiline | RegexOptions.IgnoreCase);
            using (SqlConnection connection = new SqlConnection(connectionString))
            {
                connection.Open();
                foreach (string commandString in commandStrings)
                {
                    if (commandString.Trim() != "")
                    {
                        using (var command = new SqlCommand(commandString, connection))
                        {
                        try
                        {
                            command.ExecuteNonQuery();
                        }
                        catch (SqlException ex)
                        {
                            string spError = commandString.Length > 100 ? commandString.Substring(0, 100) + " ...\n..." : commandString;
                            MessageBox.Show(string.Format("Please check the SqlServer script.\nFile: {0} \nLine: {1} \nError: {2} \nSQL Command: \n{3}", pathStoreProceduresFile, ex.LineNumber, ex.Message, spError), "Warning", MessageBoxButtons.OK, MessageBoxIcon.Warning);
                            return false;
                        }
                    }
                    }
                }
                connection.Close();
            }
        return true;
        }
        catch (Exception ex)
        {
            MessageBox.Show(ex.Message, "Warning", MessageBoxButtons.OK, MessageBoxIcon.Warning);
            return false;
        }
    } 
```

* * *

## 回答 #4

> 赞同：8
> 
> 时间：2009-03-16T12:27:21.040

将执行sql脚本的命令放入批处理文件，然后运行以下代码

```
string batchFileName = @"c:\batosql.bat";
string sqlFileName = @"c:\MySqlScripts.sql";
Process proc = new Process();
proc.StartInfo.FileName = batchFileName;
proc.StartInfo.Arguments = sqlFileName;
proc.StartInfo.WindowStyle = ProcessWindowStyle.Hidden;
proc.StartInfo.ErrorDialog = false;
proc.StartInfo.WorkingDirectory = Path.GetDirectoryName(batchFileName);
proc.Start();
proc.WaitForExit();
if ( proc.ExitCode!= 0 ) 
```

在批处理文件中写这样的东西（sql server 的示例）

```
osql -E -i %1 
```

* * *

## 回答 #5

> 赞同：7
> 
> 时间：2016-12-02T05:39:06.047

这对我有用：

```
public void updatedatabase()
{

    SqlConnection conn = new SqlConnection("Data Source=" + txtserver.Text.Trim() + ";Initial Catalog=" + txtdatabase.Text.Trim() + ";User ID=" + txtuserid.Text.Trim() + ";Password=" + txtpwd.Text.Trim() + "");
    try
    {

        conn.Open();

        string script = File.ReadAllText(Server.MapPath("~/Script/DatingDemo.sql"));

        // split script on GO command
        IEnumerable<string> commandStrings = Regex.Split(script, @"^\s*GO\s*$", RegexOptions.Multiline | RegexOptions.IgnoreCase);
        foreach (string commandString in commandStrings)
        {
            if (commandString.Trim() != "")
            {
                new SqlCommand(commandString, conn).ExecuteNonQuery();
            }
        }
        lblmsg.Text = "Database updated successfully.";

    }
    catch (SqlException er)
    {
        lblmsg.Text = er.Message;
        lblmsg.ForeColor = Color.Red;
    }
    finally
    {
        conn.Close();
    }
} 
```

* * *

## 回答 #6

> 赞同：4
> 
> 时间：2009-03-23T12:32:01.017

我设法通过阅读手册找出答案:)

此摘自 MSDN

> 该代码示例通过在 p.WaitForExit 之前调用 p.StandardOutput.ReadToEnd 来避免死锁情况。如果父进程在 p.StandardOutput.ReadToEnd 之前调用 p.WaitForExit 并且子进程写入足够的文本来填充重定向的流，则可能导致死锁情况。父进程将无限期地等待子进程退出。子进程将无限期地等待父进程从完整的 StandardOutput 流中读取。
> 
> 当您从标准输出和标准错误流中读取所有文本时，也会出现类似的问题。例如，以下 C# 代码对两个流执行读取操作。

把代码变成这个；

```
Process p = new Process();
p.StartInfo.UseShellExecute = false;
p.StartInfo.RedirectStandardOutput = true;
p.StartInfo.FileName = "sqlplus";
p.StartInfo.Arguments = string.Format("xxx/xxx@{0} @{1}", in_database, s);

bool started = p.Start();
// important ... read stream input before waiting for exit.
// this avoids deadlock.
string output = p.StandardOutput.ReadToEnd();

p.WaitForExit();

Console.WriteLine(output);

if (p.ExitCode != 0)
{
    Console.WriteLine( string.Format("*** Failed : {0} - {1}",s,p.ExitCode));
    break;
} 
```

现在正确退出。

* * *

## 回答 #7

> 赞同：4
> 
> 时间：2016-03-09T11:59:54.147

添加了对 surajits 答案的其他改进：

```
using System;
using Microsoft.SqlServer.Management.Smo;
using Microsoft.SqlServer.Management.Common;
using System.IO;
using System.Data.SqlClient;

namespace MyNamespace
{
    public partial class RunSqlScript : System.Web.UI.Page
    {
        protected void Page_Load(object sender, EventArgs e)
        {
            var connectionString = @"your-connection-string";
            var pathToScriptFile = Server.MapPath("~/sql-scripts/") + "sql-script.sql";
            var sqlScript = File.ReadAllText(pathToScriptFile);

            using (var connection = new SqlConnection(connectionString))
            {
                var server = new Server(new ServerConnection(connection));
                server.ConnectionContext.ExecuteNonQuery(sqlScript);
            }
        }
    }
} 
```

此外，我必须在我的项目中添加以下引用：

*   `C:\Program Files\Microsoft SQL Server\120\SDK\Assemblies\Microsoft.SqlServer.ConnectionInfo.dll`
*   `C:\Program Files\Microsoft SQL Server\120\SDK\Assemblies\Microsoft.SqlServer.Smo.dll`

我不知道这些是否是正确的 dll:s，因为 C:\Program Files\Microsoft SQL Server 中有几个文件夹，但在我的应用程序中这两个工作。

* * *

## 回答 #8

> 赞同：2
> 
> 时间：2016-08-16T12:02:01.070

有两点需要考虑。

1）这个源代码对我有用：

```
private static string Execute(string credentials, string scriptDir, string scriptFilename)
{ 
  Process process = new Process();
  process.StartInfo.UseShellExecute = false;
  process.StartInfo.WorkingDirectory = scriptDir;
  process.StartInfo.RedirectStandardOutput = true;
  process.StartInfo.FileName = "sqlplus";
  process.StartInfo.Arguments = string.Format("{0} @{1}", credentials, scriptFilename);
  process.StartInfo.CreateNoWindow = true;

  process.Start();
  string output = process.StandardOutput.ReadToEnd();
  process.WaitForExit();

  return output;
} 
```

我将工作目录设置为脚本目录，以便脚本中的子脚本也可以工作。

称它为`Execute("usr/pwd@service", "c:\myscripts", "script.sql")`

2) 你必须用语句完成你的 SQL 脚本`EXIT;`

* * *

## 回答 #9

> 赞同：1
> 
> 时间：2018-06-07T08:37:14.137

使用 EntityFramework，您可以使用这样的解决方案。我使用此代码来初始化 e2e 测试。防止sql注入攻击，请确保不要根据用户输入生成此脚本或为此使用命令参数（请参阅接受参数的ExecuteSqlCommand的重载）。

```
public static void ExecuteSqlScript(string sqlScript)
{
    using (MyEntities dataModel = new MyEntities())
    {
        // split script on GO commands
        IEnumerable<string> commands = 
            Regex.Split(
                sqlScript, 
                @"^\s*GO\s*$",
                RegexOptions.Multiline | RegexOptions.IgnoreCase);

        foreach (string command in commands)
        {
            if (command.Trim() != string.Empty)
            {
                dataModel.Database.ExecuteSqlCommand(command);
            }
        }              
    }
} 
```

* * *

## 回答 #10

> 赞同：0
> 
> 时间：2018-10-16T16:36:38.310

我找不到任何准确有效的方法来做到这一点。所以一整天后，我带着这个从不同来源获得的混合代码，并试图完成工作。

`ExecuteNonQuery: CommandText property has not been Initialized`但是即使它成功运行了脚本文件，它仍然会产生异常——在我的例子中，它成功地创建了数据库并在第一次启动时插入数据。

```
public partial class Form1 : MetroForm
{
    SqlConnection cn;
    SqlCommand cm;
    public Form1()
    {
        InitializeComponent();
    }

    private void Form1_Load(object sender, EventArgs e)
    {
        if (!CheckDatabaseExist())
        {
            GenerateDatabase();
        }
    }

    private bool CheckDatabaseExist()
    {
        SqlConnection con = new SqlConnection(@"Data Source=.\SQLEXPRESS;Initial Catalog=SalmanTradersDB;Integrated Security=true");
        try
        {
            con.Open();
            return true;
        }
        catch
        {
            return false;
        }
    }

    private void GenerateDatabase()
    {

        try
        {
            cn = new SqlConnection(@"Data Source=.\SQLEXPRESS;Initial Catalog=master;Integrated Security=True");
            StringBuilder sb = new StringBuilder();
            sb.Append(string.Format("drop databse {0}", "SalmanTradersDB"));
            cm = new SqlCommand(sb.ToString() , cn);
            cn.Open();
            cm.ExecuteNonQuery();
            cn.Close();
        }
        catch
        {

        }
        try
        {
            //Application.StartupPath is the location where the application is Installed
            //Here File Path Can Be Provided Via OpenFileDialog
            if (File.Exists(Application.StartupPath + "\\script.sql"))
            {
                string script = null;
                script = File.ReadAllText(Application.StartupPath + "\\script.sql");
                string[] ScriptSplitter = script.Split(new string[] { "GO" }, StringSplitOptions.None);
                using (cn = new SqlConnection(@"Data Source=.\SQLEXPRESS;Initial Catalog=master;Integrated Security=True"))
                {
                    cn.Open();
                    foreach (string str in ScriptSplitter)
                    {
                        using (cm = cn.CreateCommand())
                        {
                            cm.CommandText = str;
                            cm.ExecuteNonQuery();
                        }
                    }
                }
            }
        }
        catch
        {

        }

    }

} 
```

# c# - C# 设置 xml 文件位置

> ID：650100
> 
> 赞同：5
> 
> 时间：2009-03-16T11:58:54.260
> 
> 标签：c#, settings

我有一个项目，它根据 C# Setting 类中的值读取文件。然而，这个值会随着机器的变化而变化，我宁愿在程序第一次作为公司环境运行时不询问用户，而是希望在安装程序中设置它，但文件在哪里？有没有更简单的方法？

这是一个视觉工作室插件不是一个独立的程序

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2009-03-16T12:12:46.287

从您的帖子看来，您有一个 Windows 应用程序？，您可以在应用程序配置中存储一个初始值，您可以在 Visual Studio 中制作一个安装程序并编写自定义操作，这些操作可以在您安装项目的第一次安装时将值写入文件。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2009-04-08T03:27:43.607

配置文件是完成您所要求的最简单的方法，但它不是最好的。事实上，建议不要在这种情况下使用 .config 文件。

*   每当用户安装“更新”时，都存在覆盖其现有更改的风险。

*   一些企业可能对 .config 文件有政策限制。

*   用户不能轻易地将他的设置从一台 PC 移动到另一台 PC。

根据我自己的经验，使用 XML、MS-Access、注册表或文本文件来存储用户设置已证明比使用 .config 文件更有用。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2009-03-16T13:37:27.907

我相信您在谈论设计器生成的设置（.settings 文件）？

确切的路径通常包含某种哈希（检查[此](https://stackoverflow.com/questions/621265/-net-2-0-application-settings-user-config-file-location)链接）。我通常有自己的设置类，我使用[XmlSerializer](http://msdn.microsoft.com/en-us/library/system.xml.serialization.xmlserializer.aspx)与 xml 进行序列化，这给了我更多的自由（例如，我认为 C# 设置文件不允许您添加自定义枚举，或者它们使它更难做它不仅仅是将它们添加到 .settings 文件中）。

但是，也许在安装过程中不需要设置值？例如，您可以添加一个`FirstStartup`设置（设置为`true`最初），您可以在您的应用程序第一次启动时读取该设置，然后将其设置为`false`. 这样，您可以在检测到“首次启动”时设置默认设置。

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2009-03-16T13:55:01.203

在安装程序结束时，您肯定需要某种自定义操作。你没有提到你使用什么技术来部署你的应用程序，所以我不会给出任何具体的指导。

我建议在您的`App.config`. 这是一个 xml 文件，将`MyApplication.exe.config`在与您的应用程序相同的目录中命名。如果它还没有，请将其添加到您的安装程序中。在您的安装程序中，添加一个新设置：

```
<configuration>
  <appSettings>
    <add key="MySetting" value="My Value"/>
  </appSettings>
</configuration> 
```

在您的代码中，检索设置：

```
String setting = ConfigurationSettings.AppSettings["MySetting"]; 
```

如果这是机器范围的设置，则此安装程序是设置此设置的正确位置。如果您在第一次执行时执行此操作，如果第一个运行应用程序的人是权限有限的用户，您将遇到文件和目录权限问题。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2009-03-16T12:03:23.187

最适合您的注册表或 INI 文件或 XML 文件。

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2009-03-16T12:12:01.513

最好的选择是注册表。安装应用程序需要管理员访问权限，因此在安装期间写入注册表不会成为问题。

此外，如果有人不小心删除了 ini 或设置文件，那么程序可能会停止工作。

* * *

## 回答 #7

> 赞同：0
> 
> 时间：2009-04-08T03:28:13.967

你说这是为了企业环境。您可以为组策略创建管理模板以在注册表中设置默认值。然后，如果尚未设置默认值，您的程序可以只查询该注册表值。

* * *

## 回答 #8

> 赞同：0
> 
> 时间：2009-09-09T21:42:12.137

我个人永远不会使用 web.config 或 app.config。只需阅读您自己的 xml 文件，看看我的帖子： [http ://www.picnet.com.au/blogs/Guido/post/2009/09/10/XML-Settings-Files-No-more- webconfig.aspx](http://www.picnet.com.au/blogs/Guido/post/2009/09/10/XML-Settings-Files-No-more-webconfig.aspx)

谢谢

圭多

* * *

## 回答 #9

> 赞同：0
> 
> 时间：2015-12-03T12:11:27.507

为感兴趣的人回答原始问题的“文件位于何处”位（我假设有问题的“设置文件”是“添加新项目”对话框中可用的“设置文件”项目）。

在 Win7（可能还有其他所有）中，设置文件将在路径下生成：

> C:\Users\[用户]\AppData\Local

从这里开始的文件夹结构取决于您的 AssemblyInfo 和构建信息，“AssemblyCompany”字段（如果已填充）用于最顶层的文件夹，下面是复制应用程序可执行文件名称的文件夹，然后是构建，然后最后是设置文件（名为“*.config”）。

就我而言，完整的路径如下：

> C:\Users\[user]\AppData\Local\[company_name]\Application.exe_StrongName_zx0v1qxyoass4d0z3mtwe3vbrhaehkjg\0.0.5812.21662\user.config

* * *

## 回答 #10

> 赞同：-2
> 
> 时间：2009-04-08T03:08:42.640

我的情况不同，我的项目是一个具有 app.config 文件的类库（dll）。我决定创建 4 个应用程序设置变量（标题、网址、限制、速率）。要创建它，我右键单击项目 --> 属性 --> 设置。您可以使用此命令在代码中检索此值 --> Settings.Default.title, ...etc

问题是假设我从这个库中实例化了 5 个对象（相同的对象，例如 MyProject.MyClass），我希望实例能够拥有自己的设置。我的意思是每个实例都可能有它们的 xml 设置文件。可以这样做吗？

# php - 我应该将我的数据库用户名和密码存储在 PHP 应用程序的什么位置？

> ID：650101
> 
> 赞同：2
> 
> 时间：2009-03-16T11:58:54.260
> 
> 标签：php, mysql, database, passwords

这可能也适用于其他语言。到目前为止，我已经创建了几个网站，其中许多使用数据库（通常是 mySQL）。我需要将数据库密码存储在源代码中的某处，但这似乎是一个安全问题，有点像黑客攻击。除了在我需要使用数据库的任何地方都包含的配置文件之外，还有更好的方法来存储密码吗？

**重复：[如何在 PHP 中保护数据库密码？](https://stackoverflow.com/questions/97984/how-to-secure-database-passwords-in-php)**

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-03-16T12:05:50.670

一个无法从外部访问的配置文件，除了 htdocs 等之外的某个地方。

# c# - ASP dot NET 中的搜索引擎友好 URL

> ID：650109
> 
> 赞同：0
> 
> 时间：2009-03-16T12:00:56.750
> 
> 标签：c#, asp.net, asp.net-2.0

**目标是：**

**将details.aspx?GUID=903901823908129038 之**类的页面更改为**/adrian_seo 之类的页面**

实现：现在使用 Response.AddHeader("Location", url);

我能够删除所有大写的网址。我使用以下功能：

```
protected void Page_Load(object sender, EventArgs e)
{
    string url = Request.Url.ToString();
    if (url != Request.Url.ToString().ToLower())
    {
        url = Request.Url.ToString().ToLower();
        Response.Status = "301 Moved Permanently";
        Response.AddHeader("Location", url);
    }
} 
```

**问题是：**

如何更改这些以清除 /adrian_seo 之类的网址

我的意思是我如何处理来到 /adrian_seo 的请求，以及如何用新的 url 显示我的旧页面。

我需要使用 Global.asax 吗？

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2009-03-16T12:07:29.857

看看[ASP.NET 路由](http://msdn.microsoft.com/en-us/library/cc668201.aspx)。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-03-16T12:14:47.530

使用 HttpModule：

```
 public void Init(HttpApplication context)
  {
    context.BeginRequest += new EventHandler(context_BeginRequest);
  }

  void context_BeginRequest(object sender, EventArgs e)
  {
    HttpContext context = ((HttpApplication)sender).Context;
    if (context.Request.RawUrl.ToLowerInvariant().Equals("YOURSEOURL"))
      context.RewritePath("YOURNONSEOURL");
  } 
```

请注意，您不想对所有这些进行硬编码。找到某种正则表达式来满足您的需要，例如如果 SEO url 是：/page/234234/This-is-my-page-title，您获取 234234 并重写 page.aspx?pageid=234234 的路径

更新您还可以使用[IIS 7 重写模块](http://www.iis.net/downloads/default.aspx?tabid=34&g=6&i=1691)

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2009-03-16T12:17:06.087

我推荐使用[UrlRewritingNet](http://urlrewriting.net/149/en/home.html)组件。在编写自己的库时，您需要克服一些困难，这个库已经为您处理了这些东西......

> 它是针对 ASP.NET 2.0 调整的重写模块，并提供对
> 
> *   主题和母版页
> *   常用表达
> *   好的回发网址
> *   无 Cookie 会话
> *   在共享主机或中等信任环境中运行
> *   支持输出缓存
> *   可以重定向，甚至可以重定向到其他域

要使用 IIS 6 或更低版本在 asp.net 中启用无扩展 url，您还需要[配置 IIS](http://professionalaspnet.com/archive/2007/07/27/Configure-IIS-for-Wildcard-Extensions-in-ASP.NET.aspx)以让 asp.net 处理所有传入请求。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2009-03-16T12:13:38.873

您可以使用[http://urlrewriter.net/](http://urlrewriter.net/)可以在 asp.net 1.1 上使用 ->

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2009-03-16T15:14:23.103

在阅读了一些关于 Asp.net 中的路由之后：

[http://blog.eworldui.net/post/2008/04/ASPNET-MVC---Legacy-Url-Routing.aspx](http://blog.eworldui.net/post/2008/04/ASPNET-MVC---Legacy-Url-Routing.aspx)

这为 SEO 页面排名和 Asp.net Routing 带来了永久有机 SEO 解决方案的 301 重定向。

# .net - WPF .NET 中的拼写检查器

> ID：650117
> 
> 赞同：7
> 
> 时间：2009-03-16T12:02:52.923
> 
> 标签：.net, wpf

我正在尝试在您键入拼写检查器时实现“下划线\修复”，任何人都可以指出一些示例。

* * *

## 回答 #1

> 赞同：16
> 
> 时间：2009-03-16T12:04:10.410

你不需要 WPF 有一个内置的拼写检查器。

```
 <TextBox Name="x" SpellCheck.IsEnabled="True" Language="en-us"></TextBox> 
```

当文本框中的单词拼写错误时，它将：

*   用红色在拼写错误的单词下划线。
*   右键单击该单词将显示带有建议的上下文菜单。

拼写建议取自 Office2007 使用的字典。您不需要安装 Office 2007，因为它使用字典的副本。但是，功能将是相同的。

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2009-03-16T12:05:14.290

.NET [Netspell Spellchecker](http://sourceforge.net/projects/netspell/)是一个免费（开源）拼写检查库，以防您在寻找其他人如何实现它。

# ios - iOS 应用程序中的复选框

> ID：650131
> 
> 赞同：36
> 
> 时间：2009-03-16T12:05:30.577
> 
> 标签：ios, iphone, checkbox

我需要在我的表单中添加复选框控件。我知道 iOS SDK 中没有这样的控件。我怎么能这样做？

* * *

## 回答 #1

> 赞同：32
> 
> 时间：2010-04-10T21:23:12.713

这也让我发疯了，我找到了一个不同的解决方案，它对我很有效，并且避免了使用图像。

1.  向 Interface Builder 添加一个新的标签对象。
2.  在 Xcode 中创建一个 IBOutlet 属性并将其连接到它。在下面的代码中，我将其称为“fullPaid”，因为我想知道是否有人已经全额支付了一笔钱。
3.  添加下面的2个功能。“touchesBegan”函数检查您是否触摸了“fullyPaid”标签对象内的某个位置，如果是，它调用“togglePaidStatus”函数。'togglePaidStatus' 函数设置两个字符串，它们的 unicode 字符分别代表一个空框 (\u2610) 和一个复选框 (\u2611)。然后它比较“fullyPaid”对象中当前的内容，并将其与另一个字符串切换。

您可能希望在 viewDidLoad 函数中调用 togglePaidStatus 函数，将其初始设置为空字符串。

显然，如果标签未启用，您可以添加额外的检查以防止用户切换复选框，但这未在下面显示。

```
-(void)touchesBegan:(NSSet *)touches withEvent:(UIEvent *)event
{
UITouch *touch = [touches anyObject];   
    if (CGRectContainsPoint([fullyPaid frame], [touch locationInView:self.view]))
    {
        [self togglePaidStatus];
    }
}
-(void) togglePaidStatus
{
    NSString *untickedBoxStr = [[NSString alloc] initWithString:@"\u2610"];
    NSString *tickedBoxStr = [[NSString alloc] initWithString:@"\u2611"];   

    if ([fullyPaid.text isEqualToString:tickedBoxStr])
    {
        fullyPaid.text = untickedBoxStr;
    }
    else
    {
        fullyPaid.text = tickedBoxStr;
    }

    [tickedBoxStr release];
    [untickedBoxStr release];
} 
```

* * *

## 回答 #2

> 赞同：25
> 
> 时间：2009-03-16T12:12:56.393

通常，您会将 UISwitch 用于类似复选框的功能。

您可以通过使用带有两个图像（选中/未选中）的图像控件并在它们触摸控件/时切换图像来滚动自己

* * *

## 回答 #3

> 赞同：14
> 
> 时间：2009-03-16T12:33:15.473

如果您要显示一组选项并且用户可以选择其中一个，请使用带有复选标记附件的表格视图，并在所选行上使用不同的文本颜色。

如果您只有一个选项，最好的选择是使用开关。如果您不能或不想，请使用按钮，将普通图像设置为空框，将所选图像设置为选中框。您必须自己制作这两个图像，或者找到用于它们的库存图形。

* * *

## 回答 #4

> 赞同：9
> 
> 时间：2014-03-19T04:17:55.977

延伸到[Adrean 的想法](https://stackoverflow.com/a/2615036/634958)，我用一种非常简单的方法实现了这一点。我的想法是根据其状态
更改按钮（比如说）文本，然后在其更改按钮的状态。 下面是我如何做到这一点的代码：`checkBtn``IBAction`

```
- (void)viewDidLoad
{
    [super viewDidLoad];

    [checkBtn setTitle:@"\u2610" forState:UIControlStateNormal];    // uncheck the button in normal state
    [checkBtn setTitle:@"\u2611" forState:UIControlStateSelected];  // check the button in selected state
}

- (IBAction)checkButtonTapped:(UIButton*)sender {
    sender.selected = !sender.selected;    // toggle button's selected state  

    if (sender.state == UIControlStateSelected) {    
        // do something when button is checked 
    } else {
        // do something when button is unchecked
    }
} 
```

* * *

## 回答 #5

> 赞同：6
> 
> 时间：2014-12-31T13:44:30.607

这是我的 iPhone 复选框版本。

它是扩展 UIButton 的单个类。这很简单，所以我将它粘贴在这里。

CheckBoxButton.h 文件内容

```
#import <UIKit/UIKit.h>

@interface CheckBoxButton : UIButton

@property(nonatomic,assign)IBInspectable BOOL isChecked;

@end 
```

CheckBoxButton.m 文件内容

```
#import "CheckBoxButton.h"

@interface CheckBoxButton()

@property(nonatomic,strong)IBInspectable UIImage* checkedStateImage;
@property(nonatomic,strong)IBInspectable UIImage* uncheckedStateImage;

@end

@implementation CheckBoxButton

-(id)init
{
    self = [super init];

    if(self)
    {
        [self addTarget:self action:@selector(switchState) forControlEvents:UIControlEventTouchUpInside];
    }

    return self;
}

-(id)initWithFrame:(CGRect)frame
{
    self = [super initWithFrame:frame];

    if(self)
    {
        [self addTarget:self action:@selector(switchState) forControlEvents:UIControlEventTouchUpInside];
    }

    return self;
}

-(id)initWithCoder:(NSCoder *)aDecoder
{
    self = [super initWithCoder:aDecoder];

    if(self)
    {
        [self addTarget:self action:@selector(switchState) forControlEvents:UIControlEventTouchUpInside];
    }

    return self;
}

-(void)setIsChecked:(BOOL)isChecked
{
    _isChecked = isChecked;

    if(isChecked)
    {
        [self setImage:self.checkedStateImage forState:UIControlStateNormal];
    }
    else
    {
        [self setImage:self.uncheckedStateImage forState:UIControlStateNormal];
    }
}

-(void)switchState
{
    self.isChecked = !self.isChecked;
    [self sendActionsForControlEvents:UIControlEventValueChanged];
}

@end 
```

您可以在 Visual Studio 的属性检查器中为选中/未选中以及 isChecked 属性设置图像。

![在此处输入图像描述](https://i.stack.imgur.com/8kugS.png)

要在情节提要或 xib 中添加 CheckBoxButton，只需添加 UIButton 并设置自定义类，如下一张图像。

![在此处输入图像描述](https://i.stack.imgur.com/rrTVu.png)

每次更改 isChecked 状态时，按钮都会发送 UIControlEventValueChanged 事件。

* * *

## 回答 #6

> 赞同：6
> 
> 时间：2010-05-21T16:46:29.317

我想以编程方式进行此操作，同时也解决命中区域实在太小的问题。这改编自各种来源，包括 Mike 和 Mike 的评论者 Agha。

在你的标题中

```
@interface YourViewController : UIViewController {
    BOOL checkboxSelected;
    UIButton *checkboxButton;
}

@property BOOL checkboxSelected;;
@property (nonatomic, retain) UIButton *checkboxButton;

-(void)toggleButton:(id)sender; 
```

在你的实施中

```
// put this in your viewDidLoad method. if you put it somewhere else, you'll probably have to change the self.view to something else
// create the checkbox. the width and height are larger than actual image, because we are creating the hit area which also covers the label
UIButton* checkBox = [[UIButton alloc] initWithFrame:CGRectMake(100, 60,120, 44)];  
[checkBox setImage:[UIImage imageNamed:@"checkbox.png"] forState:UIControlStateNormal];
// uncomment below to see the hit area
// [checkBox setBackgroundColor:[UIColor redColor]];
[checkBox addTarget:self action:@selector(toggleButton:) forControlEvents: UIControlEventTouchUpInside];
// make the button's image flush left, and then push the image 20px left
[checkBox setContentHorizontalAlignment:UIControlContentHorizontalAlignmentLeft];
[checkBox setImageEdgeInsets:UIEdgeInsetsMake(0.0, 20.0, 0.0, 0.0)];
[self.view addSubview:checkBox];

// add checkbox text text
UILabel *checkBoxLabel = [[UILabel alloc] initWithFrame:CGRectMake(140, 74,200, 16)];
[checkBoxLabel setFont:[UIFont boldSystemFontOfSize:14]];
[checkBoxLabel setTextColor:[UIColor whiteColor]];
[checkBoxLabel setBackgroundColor:[UIColor clearColor]];
[checkBoxLabel setText:@"Checkbox"];
[self.view addSubview:checkBox];

// release the buttons
[checkBox release];
[checkBoxLabel release]; 
```

并将此方法也放入：

```
- (void)toggleButton: (id) sender
{
    checkboxSelected = !checkboxSelected;
    UIButton* check = (UIButton*) sender;
    if (checkboxSelected == NO)
        [check setImage:[UIImage imageNamed:@"checkbox.png"] forState:UIControlStateNormal];
    else
        [check setImage:[UIImage imageNamed:@"checkbox-checked.png"] forState:UIControlStateNormal];

} 
```

* * *

## 回答 #7

> 赞同：4
> 
> 时间：2012-07-18T07:03:53.907

这里的每个人的代码都很长，略显凌乱，而且可以做得更简单。我在 GitHub 上有一个项目，它是 UIControl 的子类，您可以下载并查看它，并为您提供一个几乎原生的复选框 UI 元素：

[https://github.com/Brayden/UICheckbox](https://github.com/Brayden/UICheckbox)

* * *

## 回答 #8

> 赞同：1
> 
> 时间：2010-07-23T09:41:11.697

我喜欢 Adrian 使用字符而不是图像的想法。但我不喜欢这个框，它只需要复选标记本身（@“\u2713”）。我以编程方式绘制了一个框（一个圆角框），并在其中放置了一个包含复选标记的 UILabel。这种实现方式可以轻松地在任何应用程序中使用自定义视图，而无需关心任何依赖资源。您还可以轻松自定义复选标记、圆角框和背景的颜色。这是完整的代码：

```
#import <UIKit/UIKit.h>

@class CheckBoxView;

@protocol CheckBoxViewDelegate
- (void) checkBoxValueChanged:(CheckBoxView *) cview;
@end

@interface CheckBoxView : UIView {
    UILabel *checkMark;
    bool isOn;
    UIColor *color;
    NSObject<CheckBoxViewDelegate> *delegate;
}
@property(readonly) bool isOn;
@property(assign) NSObject<CheckBoxViewDelegate> *delegate;

- (void) drawRoundedRect:(CGRect) rect inContext:(CGContextRef) context;
@end

#import "CheckBoxView.h"

#define SIZE 30.0
#define STROKE_WIDTH 2.0
#define ALPHA .6
#define RADIUS 5.0

@implementation CheckBoxView
@synthesize isOn, delegate;

- (id)initWithFrame:(CGRect)frame {
    if ((self = [super initWithFrame:CGRectMake(frame.origin.x, frame.origin.y, SIZE, SIZE)])) {
        // Initialization code
    }
    //UIColor *color = [UIColor blackColor];
    color = [[UIColor alloc] initWithWhite:.0 alpha:ALPHA];

    self.backgroundColor = [UIColor clearColor];
    checkMark = [[UILabel alloc] initWithFrame:CGRectMake(STROKE_WIDTH, STROKE_WIDTH, SIZE - 2 * STROKE_WIDTH, SIZE - 2*STROKE_WIDTH)];
    checkMark.font = [UIFont systemFontOfSize:25.];
    checkMark.text = @"\u2713";
    checkMark.backgroundColor = [UIColor clearColor];
    checkMark.textAlignment = UITextAlignmentCenter;
    //checkMark.textColor = [UIColor redColor];
    [self addSubview:checkMark];
    [checkMark setHidden:TRUE];
    isOn = FALSE;
    return self;
}

// Only override drawRect: if you perform custom drawing.
// An empty implementation adversely affects performance during animation.
- (void)drawRect:(CGRect)rect {
    // Drawing code
    CGRect _rect = CGRectMake(STROKE_WIDTH, STROKE_WIDTH, SIZE - 2 * STROKE_WIDTH, SIZE - 2*STROKE_WIDTH);
    [self drawRoundedRect:_rect inContext:UIGraphicsGetCurrentContext()];
    [checkMark setHidden:!isOn];
}

- (void)dealloc {
    [checkMark release];
    [color release];
    [super dealloc];
}

- (void) drawRoundedRect:(CGRect) rect inContext:(CGContextRef) context{
    CGContextBeginPath(context);
    CGContextSetLineWidth(context, STROKE_WIDTH);
    CGContextSetStrokeColorWithColor(context, [color CGColor]);
    CGContextMoveToPoint(context, CGRectGetMinX(rect) + RADIUS, CGRectGetMinY(rect));
    CGContextAddArc(context, CGRectGetMaxX(rect) - RADIUS, CGRectGetMinY(rect) + RADIUS, RADIUS, 3 * M_PI / 2, 0, 0);
    CGContextAddArc(context, CGRectGetMaxX(rect) - RADIUS, CGRectGetMaxY(rect) - RADIUS, RADIUS, 0, M_PI / 2, 0);
    CGContextAddArc(context, CGRectGetMinX(rect) + RADIUS, CGRectGetMaxY(rect) - RADIUS, RADIUS, M_PI / 2, M_PI, 0);
    CGContextAddArc(context, CGRectGetMinX(rect) + RADIUS, CGRectGetMinY(rect) + RADIUS, RADIUS, M_PI, 3 * M_PI / 2, 0);
    CGContextClosePath(context);
    CGContextStrokePath(context);
}

#pragma mark Touch
- (void)touchesEnded:(NSSet *)touches withEvent:(UIEvent *)event{
    UITouch *touch = [touches anyObject];
    CGPoint loc = [touch locationInView:self];
    if(CGRectContainsPoint(self.bounds, loc)){
        isOn = !isOn;
        //[self setNeedsDisplay];
        [checkMark setHidden:!isOn];
        if([delegate respondsToSelector:@selector(checkBoxValueChanged:)]){
            [delegate checkBoxValueChanged:self];
        }
    }
} 
```

* * *

## 回答 #9

> 赞同：1
> 
> 时间：2013-06-14T10:12:42.290

在 .h 文件中

```
#import <UIKit/UIKit.h>

@interface ViewController : UIViewController
{
    BOOL isChecked;
    UIImageView * checkBoxIV;
}
@end 
```

和 .m 文件

```
- (void)viewDidLoad
{
    [super viewDidLoad];
    isChecked = NO;

    //change this property according to your need
    checkBoxIV = [[UIImageView alloc] initWithFrame:CGRectMake(10, 10, 15, 15)]; 
    checkBoxIV.image =[UIImage imageNamed:@"checkbox_unchecked.png"]; 

    checkBoxIV.userInteractionEnabled = YES;
    UITapGestureRecognizer *checkBoxIVTapGesture = [[UITapGestureRecognizer alloc] initWithTarget:self action:@selector(handlecheckBoxIVTapGestureTap:)];
    checkBoxIVTapGesture.numberOfTapsRequired = 1;
    [checkBoxIV addGestureRecognizer:checkBoxIVTapGesture];
}

- (void)handlecheckBoxIVTapGestureTap:(UITapGestureRecognizer *)recognizer {
    if (isChecked) {
        isChecked = NO;
        checkBoxIV.image =[UIImage imageNamed:@"checkbox_unchecked.png"];
    }else{
        isChecked = YES;
        checkBoxIV.image =[UIImage imageNamed:@"checkbox_checked.png"];   
    }
} 
```

这会成功的......

* * *

## 回答 #10

> 赞同：1
> 
> 时间：2014-10-07T11:13:05.453

我使用 UITextField 来避免绘制任何奇怪的东西，但我喜欢将 NSString 的刻度 unicode (Unicode Character 'CHECK MARK' (U+2713)) 作为文本放入内部：@"\u2713"。

这样，在我的 .h 文件中（实现 UITextField 'UITextFieldDelegate' 的协议）：

```
UITextField * myCheckBox; 
```

在我的 viewDidLoad 或准备 UI 的函数中：

```
...
myCheckBox = [[UITextField alloc] initWithFrame:aFrame];
myCheckBox.borderStyle = UITextBorderStyleRoundedRect; // System look like
myCheckBox.contentVerticalAlignment = UIControlContentVerticalAlignmentCenter;
myCheckBox.textAlignment = NSTextAlignmentLeft;
myCheckBox.delegate = self;
myCheckBox.text = @" -"; // Initial text of the checkbox... editable!
... 
```

然后，在触摸事件中添加一个事件选择器，并调用“responseSelected”事件：

```
...
UITapGestureRecognizer *tapGesture = [[UITapGestureRecognizer alloc] initWithTarget:self action:@selector(checkboxSelected)];
[myCheckBox addGestureRecognizer:tapGesture];
... 
```

最后响应那个选择器

```
-(void) checkboxSelected
{
    if ([self isChecked])
    {
        // Uncheck the selection
        myCheckBox.text = @" -";
    }else{
       //Check the selection
       myCheckBox.text = @"\u2713";
    }
} 
```

函数 'isChecked' 仅检查文本是否为 @"\u2713" 复选标记。为了防止在选择文本字段时显示键盘，请使用 UITextField 'textFieldShouldBeginEditing' 的事件并添加事件选择器来管理选择：

```
-(BOOL)textFieldShouldBeginEditing:(UITextField *)textField
{
    // Question selected form the checkbox
    [self checkboxSelected];

    // Hide both keyboard and blinking cursor.
    return NO;
} 
```

* * *

## 回答 #11

> 赞同：1
> 
> 时间：2015-05-13T11:59:15.443

子类 UIButton，放置一个按钮以查看控制器，选择它并在身份检查器中将类名更改为 CheckBox。

```
#import "CheckBox.h"

@implementation CheckBox

#define checked_icon @"checked_box_icon.png"
#define empty_icon @"empty_box_icon.png"

- (id)initWithCoder:(NSCoder *)aDecoder
{
    self = [super initWithCoder:aDecoder];
    if (self)
    {
        [self setImage:[UIImage imageNamed:empty_icon] forState:UIControlStateNormal];
        [self addTarget:self action:@selector(didTouchButton) forControlEvents:UIControlEventTouchUpInside];
    }
    return self;
}

- (void)didTouchButton {
    selected = !selected;
    if (selected)
        [self setImage:[UIImage imageNamed:checked_icon] forState:UIControlStateNormal];
    else
        [self setImage:[UIImage imageNamed:empty_icon] forState:UIControlStateNormal];
}

@end 
```

* * *

## 回答 #12

> 赞同：1
> 
> 时间：2019-04-01T20:36:35.610

我最近做了一个。从 GitHub 免费获取。看看[这](https://github.com/zjkuang/SmartOptionItemComboView/blob/master/README.md)是否会有所帮助。效果就像

[![在此处输入图像描述](https://i.stack.imgur.com/7k6ge.png)](https://i.stack.imgur.com/7k6ge.png)

* * *

## 回答 #13

> 赞同：0
> 
> 时间：2013-01-20T03:15:07.690

用户 Aruna Lakmal；仅供参考，当您将此代码添加到 IB 时，正如您所描述的那样，不会调用 initWithFrame，而是调用 initWithCoder。实施 initWithCoder ，它将按照您的描述工作。

* * *

## 回答 #14

> 赞同：0
> 
> 时间：2021-09-30T12:37:46.613

使用 SF 符号的简单 UIButton 子类可以解决问题

```
class CheckBoxButton: UIButton {
    override init(frame: CGRect) {
        super.init(frame: frame)
        setup()
    }

    required init?(coder: NSCoder) {
        super.init(coder: coder)
        setup()
    }

    func setup() {
        setImage(UIImage(systemName: "square.fill"), for: .normal)
        setImage(UIImage(systemName: "checkmark.square.fill"), for: .selected)
    }
} 
```

**故事板**

如果您使用故事板，请确保按钮类型设置为`custom`如下图所示

[![按钮类型自定义](https://i.stack.imgur.com/wfHV2.png)](https://i.stack.imgur.com/wfHV2.png)

* * *

**用法**

您所要做的就是`isSelected`在动作/选择器方法中切换变量

```
@objc func toggle(_ sender: UIButton) {
    sender.isSelected.toggle()
} 
```

* * *

**演示**

[![复选框演示](https://i.stack.imgur.com/NWpwh.gif)](https://i.stack.imgur.com/NWpwh.gif)

* * *

## 回答 #15

> 赞同：0
> 
> 时间：2021-09-24T06:46:28.390

一个简单的`UIButton`子类将能够表现得像 Android 中的复选框。

```
import UIKit

class CheckedUIButton: UIButton {
    var checked: Bool = false {
        didSet {
            if checked {
                setImage(UIImage(systemName: "checkmark.circle"), for: .normal)
            } else {
                setImage(UIImage(systemName: "circle"), for: .normal)
            }
        }
    }

    //initWithFrame to init view from code
    override init(frame: CGRect) {
        super.init(frame: frame)

        commonInit()
    }

    //initWithCode to init view from xib or storyboard
    required init?(coder aDecoder: NSCoder) {
        super.init(coder: aDecoder)

        commonInit()
    }

    private func commonInit() {
        addTarget(self, action: #selector(self.checkedTapped), for: .touchUpInside)
    }

    @objc
    private func checkedTapped() {
        self.checked.toggle()
    }
} 
```

## 输出

[![在此处输入图像描述](https://i.stack.imgur.com/fNPOp.png)](https://i.stack.imgur.com/fNPOp.png)

**（未选中状态）**

* * *

[![在此处输入图像描述](https://i.stack.imgur.com/NqmC2.png)](https://i.stack.imgur.com/NqmC2.png)

**（检查状态）**

# php - 如何在没有内容长度的 PHP 中发送数据？

> ID：650149
> 
> 赞同：4
> 
> 时间：2009-03-16T12:09:56.357
> 
> 标签：php, mysql, header

我知道这是可能的，但我似乎无法弄清楚。

我有一个有几十万个结果的 mySQL 查询。我希望能够发送结果，但似乎响应需要内容长度标头才能开始下载。

在phpMyAdmin中，如果你去导出一个数据库，它会立即开始下载，FF只是说未知文件大小，但它可以工作。我查看了该代码，但无法弄清楚。

帮助？

谢谢。

* * *

## 回答 #1

> 赞同：10
> 
> 时间：2009-03-16T12:16:46.183

[该文档](http://www.w3.org/Protocols/rfc2616/rfc2616-sec14.html)在第 14.14 节中指出，*在 HTTP 中，只要可以在传输之前确定消息的长度，就应该发送它，除非第 4.4 节中的规则禁止这样做*。这意味着如果您不能说出它的大小，则不必发送它。

只是不要发送它。

如果您想在所有数据可用之前将部分数据发送到浏览器，是否**刷新**输出缓冲区？也许这就是问题所在，而不是缺少标题？

你使用flush的方式是这样的：

*   **生成**一些输出，应该将其添加到缓冲区
*   **flush()**它，它应该将当前缓冲区发送到客户端
*   转到 1

因此，如果您的查询返回大量结果，您可以只生成 100 或 1000 个结果的输出，然后刷新，依此类推。

此外，要告诉客户端浏览器尝试保存文件而不是在窗口中显示它，您也可以尝试使用*Content-disposition: 附件*标头。请参阅此处的[规范](http://www.w3.org/Protocols/rfc2616/rfc2616-sec19.html)，第 19.5.1 节。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2009-03-16T13:18:48.797

您可以使用分块传输编码。基本上，您发送一个“Transfer-encoding: chunked”标头，然后以分块模式发送数据，这意味着您发送一个块的长度，然后是该块。你一直重复这个直到数据结束，此时你发送一个零长度的块。

详细信息在[RFC 2616](https://www.rfc-editor.org/rfc/rfc2616)中。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2009-03-16T12:29:48.757

您可能正在使用等待所有内容生成的 gzip。检查您的 .htaccess 以获取有关此的指令。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2009-03-16T12:15:23.067

您不需要设置`Content-Length`标题字段。此标头字段只是告诉客户端它必须预期的数据量。事实上，一个“错误”的值会导致客户端丢弃一些数据。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2009-03-16T12:18:28.817

如果您在 FireFox 中使用 LiveHTTPHeaders 插件，您可以看到 phpMyAdmin 发送的标头与您的应用程序发送的标头之间的差异。我不知道你具体错过了什么，但这应该给你一个提示。我看到运行快速测试的一个标头是“Transfer-Encoding: chunked”，我还看到它们没有发送内容长度。如果您还没有 FireFox 插件，这里有一个链接： [LiveHTTPHeaders](https://addons.mozilla.org/en-US/firefox/addon/3829)

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2009-03-16T12:20:03.163

http 内容长度是一个 SHOULD 字段，所以你可以删除它......但你必须设置传输编码然后看看[Why "Content-Length: 0" in POST requests?](https://stackoverflow.com/questions/328281/why-content-length-0-in-post-requests/328652#328652)

# c# - 为什么 PageMethods 调用不起作用？

> ID：650157
> 
> 赞同：1
> 
> 时间：2009-03-16T12:13:26.080
> 
> 标签：c#, asp.net, javascript, pagemethods

我有一个对 C# WebMethod 的 javascript 调用。同一页面有另一个调用，它正在工作。我调试了javascript代码，这被称为：

```
function userUpdReq_onOk()
{
...
var clientValidationPassed =Page_ClientValidate();

if( clientValidationPassed )
{
PageMethods.RequestUserUpdate(username, email, sex, zipCode, state, city, neighborhood, address, addressNumber, addressComplement, phone, promotionalInfo, connectionType, connectionSpeed, userUpdReq_OnComplete, userUpdReq_OnError);
}
...
} 
```

调试器经过这一行，但它进入的下一个方法是 userUpdReq_OnError( )。为什么会这样？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-03-16T12:29:21.533

传递给 userUpdReq_OnError() 的错误参数中的消息是什么？

当您的页面方法内部发生错误时，将调用 OnError 方法。有时这将是一个强制转换问题，或者由于某些其他原因导致的服务器错误。传递给您的 OnError 方法的错误消息应该能够引导您了解失败的原因。

要获取错误消息，您可以按如下方式定义错误处理程序：

```
function userUpdReq_OnError(error){} 
```

错误参数将有一条消息指示失败的原因。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2010-09-29T18:02:07.917

我认为这是另一个“无辜”的问题，但它给了我很多麻烦，但是，由于某种未知的原因，aspx 在某些地方丢失了对 ScriptManager 的一些引用，所以，我们必须做的修复它是从 aspx 中删除 ScriptManager，添加它再次将位于属性窗口中的 EnablePageMethods 设置为 true。

问候。

# design-patterns - 遵循 Microsoft 最佳实践的项目源代码

> ID：650160
> 
> 赞同：0
> 
> 时间：2009-03-16T12:14:03.817
> 
> 标签：design-patterns

我想知道您是否知道一些具有遵循 Microsoft 最佳实践的优秀源代码的网站？

通过最佳实践，我的意思是最有可能符合的项目，这个文档： http: [//www.codeplex.com/AppArchGuide](http://www.codeplex.com/AppArchGuide) [http://apparch.codeplex.com/Wiki/View.aspx?title=Pocket%20Guides&referringTitle=家](http://apparch.codeplex.com/Wiki/View.aspx?title=Pocket%20Guides&referringTitle=Home)

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-03-16T12:24:07.147

我相信微软自己的代码遵循他们的最佳实践，所以看看[Shared Source Initiative](http://www.microsoft.com/resources/sharedsource/default.mspx)。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-03-16T12:41:02.443

我怀疑您会发现遵循 Microsoft 在 Microsoft 之外的最佳实践的“出色的源代码”(ahem)，原因如下：

1.  大多数产品将是商业的（-> 闭源）
2.  要遵循微软的开发风格，你需要成为拥有大量开发人员的大公司。大多数 OSS 项目都比较小（即一个小的核心团队和很多志愿者）。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-03-16T12:48:06.153

可能很难找到任何符合微软标准的开源代码。[但是，您可以使用StyleCop](http://code.msdn.microsoft.com/sourceanalysis)和[FXCop](http://msdn.microsoft.com/en-us/library/bb429476(VS.80).aspx)与默认规则集检查给定项目的符合程度。

我会看的一个地方是[Mono Project](http://www.mono-project.com/Main_Page)，以及[使用它构建的程序](http://mono.wikia.com/wiki/Software_using_Mono)。

此外，[mad-j](https://stackoverflow.com/questions/650160/project-source-code-that-follows-microsoft-best-practices/650188#650188)查看共享源计划的想法可能会有所帮助，但我猜并非他们的所有代码都严格遵循他们的指导方针。

* * *

## 回答 #4

> 赞同：-1
> 
> 时间：2009-03-16T12:38:07.677

查看[http://msdn.microsoft.com/en-us/practices/default.aspx](http://msdn.microsoft.com/en-us/practices/default.aspx)，如果您没有 VS 2008，请下载 FxCop， http: [//msdn.microsoft.com/en-us/library/ bb429476(VS.80).aspx](http://msdn.microsoft.com/en-us/library/bb429476(VS.80).aspx)

# c++ - 为什么 switch 语句不能应用于字符串？

> ID：650162
> 
> 赞同：284
> 
> 时间：2009-03-16T12:14:28.700
> 
> 标签：c++, string, switch-statement

编译以下代码并得到错误`type illegal`。

```
int main()
{
    // Compilation error - switch expression of type illegal
    switch(std::string("raj"))
    {
    case"sda":
    }
} 
```

您不能在`switch`或中使用字符串`case`。为什么？是否有任何解决方案可以很好地支持类似于打开字符串的逻辑？

* * *

## 回答 #1

> 赞同：229
> 
> 时间：2009-03-16T12:30:36.803

原因与类型系统有关。C/C++ 并不真正支持字符串作为一种类型。它确实支持常量 char 数组的想法，但它并没有真正完全理解字符串的概念。

为了生成 switch 语句的代码，编译器必须理解两个值相等的含义。对于整数和枚举之类的项目，这是一个微不足道的比较。但是编译器应该如何比较两个字符串值呢？区分大小写、不区分大小写、文化意识等……如果不完全了解字符串，就无法准确回答。

此外，C/C++ switch 语句通常生成为[分支表](http://en.wikipedia.org/wiki/Branch_table)。为字符串样式开关生成分支表并不容易。

* * *

## 回答 #2

> 赞同：67
> 
> 时间：2009-03-16T12:52:08.530

如前所述，编译器喜欢构建查找表，`switch`尽可能将语句优化到接近 O(1) 的时间。将此与 C++ 语言没有字符串类型的事实结合起来 -`std::string`是标准库的一部分，而标准库本身不是语言的一部分。

我将提供您可能想要考虑的替代方案，我过去曾使用过它，效果很好。不是切换字符串本身，而是切换使用字符串作为输入的哈希函数的结果。如果您使用一组预定的字符串，您的代码将几乎与切换字符串一样清晰：

```
enum string_code {
    eFred,
    eBarney,
    eWilma,
    eBetty,
    ...
};

string_code hashit (std::string const& inString) {
    if (inString == "Fred") return eFred;
    if (inString == "Barney") return eBarney;
    ...
}

void foo() {
    switch (hashit(stringValue)) {
    case eFred:
        ...
    case eBarney:
        ...
    }
} 
```

有许多明显的优化几乎遵循 C 编译器对 switch 语句所做的事情......这很有趣。

* * *

## 回答 #3

> 赞同：36
> 
> 时间：2017-10-12T14:07:05.373

C++

constexpr 哈希函数：

```
constexpr unsigned int hash(const char *s, int off = 0) {                        
    return !s[off] ? 5381 : (hash(s, off+1)*33) ^ s[off];                           
}                                                                                

switch( hash(str) ){
case hash("one") : // do something
case hash("two") : // do something
} 
```

* * *

**更新：**

上面的例子是 C++11。`constexpr`函数必须带有单个语句。这在下一个 C++ 版本中得到了放松。

在 C++14 和 C++17 中，您可以使用以下哈希函数：

```
constexpr uint32_t hash(const char* data, size_t const size) noexcept{
    uint32_t hash = 5381;

    for(const char *c = data; c < data + size; ++c)
        hash = ((hash << 5) + hash) + (unsigned char) *c;

    return hash;
} 
```

C++17 也有`std::string_view`，所以你可以用它代替`const char *`.

在 C++20 中，您可以尝试使用`consteval`.

* * *

## 回答 #4

> 赞同：19
> 
> 时间：2014-12-10T00:07:27.413

C++ 11 更新显然不是上面的@MarmouCorp，而是[http://www.codeguru.com/cpp/cpp/cpp_mfc/article.php/c4067/Switch-on-Strings-in-C.htm](http://www.codeguru.com/cpp/cpp/cpp_mfc/article.php/c4067/Switch-on-Strings-in-C.htm)

使用两个映射在字符串和类枚举之间进行转换（比普通枚举更好，因为它的值被限定在其中，并且反向查找漂亮的错误消息）。

通过编译器对初始化列表的支持，可以在 codeguru 代码中使用静态，这意味着 VS 2013 plus。gcc 4.8.1 没问题，不确定它还能兼容多远。

```
/// <summary>
/// Enum for String values we want to switch on
/// </summary>
enum class TestType
{
    SetType,
    GetType
};

/// <summary>
/// Map from strings to enum values
/// </summary>
std::map<std::string, TestType> MnCTest::s_mapStringToTestType =
{
    { "setType", TestType::SetType },
    { "getType", TestType::GetType }
};

/// <summary>
/// Map from enum values to strings
/// </summary>
std::map<TestType, std::string> MnCTest::s_mapTestTypeToString
{
    {TestType::SetType, "setType"}, 
    {TestType::GetType, "getType"}, 
}; 
```

...

```
std::string someString = "setType";
TestType testType = s_mapStringToTestType[someString];
switch (testType)
{
    case TestType::SetType:
        break;

    case TestType::GetType:
        break;

    default:
        LogError("Unknown TestType ", s_mapTestTypeToString[testType]);
} 
```

* * *

## 回答 #5

> 赞同：13
> 
> 时间：2009-03-16T12:24:53.667

问题是，出于优化的原因，C++ 中的 switch 语句除了基本类型外，不能用于任何东西，您只能将它们与编译时常量进行比较。

据推测，限制的原因是编译器能够应用某种形式的优化，将代码编译为一条 cmp 指令和一个 goto，在运行时根据参数的值计算地址。由于分支和循环不能很好地与现代 CPU 配合使用，因此这可能是一项重要的优化。

要解决这个问题，恐怕您将不得不诉诸 if 语句。

* * *

## 回答 #6

> 赞同：13
> 
> 时间：2017-02-25T22:51:11.893

**`std::map`+ 没有枚举的 C++11 lambdas 模式**

`unordered_map`对于潜在的摊销`O(1)`： [在 C++ 中使用 HashMap 的最佳方法是什么？](https://stackoverflow.com/questions/3578083/what-is-the-best-way-to-use-a-hashmap-in-c)

```
#include <functional>
#include <iostream>
#include <string>
#include <unordered_map>
#include <vector>

int main() {
    int result;
    const std::unordered_map<std::string,std::function<void()>> m{
        {"one",   [&](){ result = 1; }},
        {"two",   [&](){ result = 2; }},
        {"three", [&](){ result = 3; }},
    };
    const auto end = m.end();
    std::vector<std::string> strings{"one", "two", "three", "foobar"};
    for (const auto& s : strings) {
        auto it = m.find(s);
        if (it != end) {
            it->second();
        } else {
            result = -1;
        }
        std::cout << s << " " << result << std::endl;
    }
} 
```

输出：

```
one 1
two 2
three 3
foobar -1 
```

**在方法内部使用`static`**

要在类中有效地使用此模式，请静态初始化 lambda 映射，否则您`O(n)`每次都需要付费从头开始构建它。

在这里，我们可以摆脱方法变量的`{}`初始化：[类方法中的静态变量](https://stackoverflow.com/questions/6223355/static-variables-in-class-methods)，但我们也可以使用描述的方法：[C++ 中的静态构造函数？](https://stackoverflow.com/questions/1197106/static-constructors-in-c-i-need-to-initialize-private-static-objects)[我需要初始化私有静态对象](https://stackoverflow.com/questions/1197106/static-constructors-in-c-i-need-to-initialize-private-static-objects)`static`

有必要将 lambda 上下文捕获`[&]`转换为参数，否则将是未定义的：[const static auto lambda used with capture by reference](https://stackoverflow.com/questions/30999807/const-static-auto-lambda-used-with-capture-by-reference)

产生与上述相同输出的示例：

```
#include <functional>
#include <iostream>
#include <string>
#include <unordered_map>
#include <vector>

class RangeSwitch {
public:
    void method(std::string key, int &result) {
        static const std::unordered_map<std::string,std::function<void(int&)>> m{
            {"one",   [](int& result){ result = 1; }},
            {"two",   [](int& result){ result = 2; }},
            {"three", [](int& result){ result = 3; }},
        };
        static const auto end = m.end();
        auto it = m.find(key);
        if (it != end) {
            it->second(result);
        } else {
            result = -1;
        }
    }
};

int main() {
    RangeSwitch rangeSwitch;
    int result;
    std::vector<std::string> strings{"one", "two", "three", "foobar"};
    for (const auto& s : strings) {
        rangeSwitch.method(s, result);
        std::cout << s << " " << result << std::endl;
    }
} 
```

* * *

## 回答 #7

> 赞同：10
> 
> 时间：2016-07-03T05:02:16.823

要使用最简单的容器添加变体（不需要有序的地图）......我不会为枚举而烦恼 - 只需将容器定义放在开关之前，这样就很容易看到哪个数字代表这种情况下。

这会在 中进行散列查找，`unordered_map`并使用关联`int`来驱动 switch 语句。应该挺快的。请注意，`at`它用于代替`[]`，因为我已经制作了该容器`const`。使用`[]`可能很危险——如果该字符串不在映射中，您将创建一个新映射，最终可能会得到未定义的结果或不断增长的映射。

请注意，`at()`如果字符串不在地图中，该函数将引发异常。所以你可能想先使用`count()`.

```
const static std::unordered_map<std::string,int> string_to_case{
   {"raj",1},
   {"ben",2}
};
switch(string_to_case.at("raj")) {
  case 1: // this is the "raj" case
       break;
  case 2: // this is the "ben" case
       break;

} 
```

对未定义字符串进行测试的版本如下：

```
const static std::unordered_map<std::string,int> string_to_case{
   {"raj",1},
   {"ben",2}
};
// in C++20, you can replace .count with .contains
switch(string_to_case.count("raj") ? string_to_case.at("raj") : 0) {
  case 1: // this is the "raj" case
       break;
  case 2: // this is the "ben" case
       break;
  case 0: //this is for the undefined case

} 
```

* * *

## 回答 #8

> 赞同：6
> 
> 时间：2009-03-16T12:17:44.730

在 C++ 和 C 中，开关仅适用于整数类型。请改用 if else 阶梯。C++ 显然可以为字符串实现某种 swich 语句——我想没有人认为这是值得的，我同意他们的观点。

* * *

## 回答 #9

> 赞同：6
> 
> 时间：2016-10-11T11:09:42.203

为什么不？您可以使用具有等效语法和相同语义的[switch 实现。](https://github.com/oklas/switch)该`C`语言根本没有对象和字符串对象，但字符串中`C`的字符串是指针引用的以空结尾的字符串。该`C++`语言有可能为对象比较或检查对象相等性创建重载函数。因为足够灵活，可以对语言字符串`C`和 支持比较或检查语言相等性的任何类型的对象进行这种切换。而现代允许这个开关实现足够有效。`C++``C``C++``C++11`

您的代码将如下所示：

```
std::string name = "Alice";

std::string gender = "boy";
std::string role;

SWITCH(name)
  CASE("Alice")   FALL
  CASE("Carol")   gender = "girl"; FALL
  CASE("Bob")     FALL
  CASE("Dave")    role   = "participant"; BREAK
  CASE("Mallory") FALL
  CASE("Trudy")   role   = "attacker";    BREAK
  CASE("Peggy")   gender = "girl"; FALL
  CASE("Victor")  role   = "verifier";    BREAK
  DEFAULT         role   = "other";
END

// the role will be: "participant"
// the gender will be: "girl" 
```

例如，可以使用更复杂的类型`std::pairs`或任何支持相等操作（或*快速*模式的组合）的结构或类。

## 特征

*   支持比较或检查相等性的任何类型的数据
*   构建级联嵌套 switch 语句的可能性。
*   通过案例陈述打破或失败的可能性
*   使用非常量 case 表达式的可能性
*   可以通过树搜索启用快速静态/动态模式（用于 C++11）

与语言切换的 Sintax 差异是

*   大写关键字
*   CASE 语句需要括号
*   分号';' 不允许在语句末尾
*   CASE 语句中的冒号 ':' 是不允许的
*   在 CASE 语句的末尾需要 BREAK 或 FALL 关键字之一

对于`C++97`使用线性搜索的语言。对于`C++11`更现代的可能使用`quick`模式 wuth 树搜索，其中不允许 CASE中的*return语句。*`C`语言实现存在于使用`char*`类型和以零结尾的字符串比较的地方。

阅读[有关](https://github.com/oklas/switch)此开关实现的更多信息。

* * *

## 回答 #10

> 赞同：4
> 
> 时间：2009-03-16T12:31:01.437

我认为原因是 C 中的字符串不是原始类型，正如 tomjen 所说，将字符串视为 char 数组，因此您不能执行以下操作：

```
switch (char[]) { // ...
switch (int[]) { // ... 
```

* * *

## 回答 #11

> 赞同：3
> 
> 时间：2009-03-16T13:28:29.693

在 c++ 中，字符串不是一等公民。字符串操作是通过标准库完成的。我想，这就是原因。此外，C++ 使用分支表优化来优化 switch case 语句。看看链接。

[http://en.wikipedia.org/wiki/Switch_statement](http://en.wikipedia.org/wiki/Switch_statement)

* * *

## 回答 #12

> 赞同：2
> 
> 时间：2009-03-16T12:15:25.920

在 C++ 中，您只能在 int 和 char 上使用 switch 语句

* * *

## 回答 #13

> 赞同：2
> 
> 时间：2020-08-29T15:58:29.357

聚会迟到了，这是我前段时间想出的一个解决方案，它完全遵守所要求的语法。

```
#include <uberswitch/uberswitch.hpp>

int main()
{
    uswitch (std::string("raj"))
    {
        ucase ("sda"): /* ... */ break;  //notice the parenthesis around the value.
    }
} 
```

这是代码：[https ://github.com/falemagn/uberswitch](https://github.com/falemagn/uberswitch)

* * *

## 回答 #14

> 赞同：1
> 
> 时间：2021-05-16T18:20:43.310

您可以将字符串放在一个数组中，并`constexpr`在编译时使用 a 将它们转换为索引。

```
constexpr const char* arr[] = { "bar", "foo" };
constexpr int index(const char* str) { /*...*/ }

do_something(std::string str)
{
    switch(quick_index(str))
    {
        case index("bar"):
            // ...
            break;

        case index("foo"):
            // ...
            break;

        case -1:
        default:
            // ...
            break;
    } 
```

对于`quick_index`，不一定是`constexpr`，您可以例如在运行时使用 an`unordered_map`来完成 O(1) 。（或者对数组进行排序并使用二进制搜索，[请参见此处的示例](https://stackoverflow.com/a/67551448/579344)。）

这是 C++11 的完整示例，带有一个简单的自定义`constexpr`字符串比较器。将在编译时检测到重复的情况和不在数组中的情况（`index`给定）。`-1`显然没有发现失踪案件。后来的 C++ 版本有更灵活`constexpr`的表达式，允许更简单的代码。

```
#include <iostream>
#include <algorithm>
#include <unordered_map>

constexpr const char* arr[] = { "bar", "foo", "foobar" };

constexpr int cmp(const char* str1, const char* str2)
{
    return *str1 == *str2 && (!*str1 || cmp(str1+1, str2+1));
}

constexpr int index(const char* str, int pos=0)
{
    return pos == sizeof(arr)/sizeof(arr[0]) ? -1 : cmp(str, arr[pos]) ? pos : index(str,pos+1);
}

int main()
{
    // initialize hash table once
    std::unordered_map<std::string,int> lookup;
    int i = 0;
    for(auto s : arr) lookup[s] = i++;
    auto quick_index = [&](std::string& s)
        { auto it = lookup.find(s); return it == lookup.end() ? -1 : it->second; };

    // usage in code
    std::string str = "bar";

    switch(quick_index(str))
    {
        case index("bar"):
            std::cout << "bartender" << std::endl;
            break;

        case index("foo"):
            std::cout << "fighter" << std::endl;
            break;

        case index("foobar"):
            std::cout << "fighter bartender" << std::endl;
            break;

        case -1:
        default:
            std::cout << "moo" << std::endl;
            break;
    }
} 
```

* * *

## 回答 #15

> 赞同：0
> 
> 时间：2016-03-08T16:58:26.920

```
 cout << "\nEnter word to select your choice\n"; 
    cout << "ex to exit program (0)\n";     
    cout << "m     to set month(1)\n";
    cout << "y     to set year(2)\n";
    cout << "rm     to return the month(4)\n";
    cout << "ry     to return year(5)\n";
    cout << "pc     to print the calendar for a month(6)\n";
    cout << "fdc      to print the first day of the month(1)\n";
    cin >> c;
    cout << endl;
    a = c.compare("ex") ?c.compare("m") ?c.compare("y") ? c.compare("rm")?c.compare("ry") ? c.compare("pc") ? c.compare("fdc") ? 7 : 6 :  5  : 4 : 3 : 2 : 1 : 0;
    switch (a)
    {
        case 0:
            return 1;

        case 1:                   ///m
        {
            cout << "enter month\n";
            cin >> c;
            cout << endl;
            myCalendar.setMonth(c);
            break;
        }
        case 2:
            cout << "Enter year(yyyy)\n";
            cin >> y;
            cout << endl;
            myCalendar.setYear(y);
            break;
        case 3:
             myCalendar.getMonth();
            break;
        case 4:
            myCalendar.getYear();
        case 5:
            cout << "Enter month and year\n";
            cin >> c >> y;
            cout << endl;
            myCalendar.almanaq(c,y);
            break;
        case 6:
            break;

    } 
```

* * *

## 回答 #16

> 赞同：0
> 
> 时间：2018-11-18T09:39:03.603

开关问题的更多功能解决方法：

```
class APIHandlerImpl
{

// define map of "cases"
std::map<string, std::function<void(server*, websocketpp::connection_hdl, string)>> in_events;

public:
    APIHandlerImpl()
    {
        // bind handler method in constructor
        in_events["/hello"] = std::bind(&APIHandlerImpl::handleHello, this, _1, _2, _3);
        in_events["/bye"] = std::bind(&APIHandlerImpl::handleBye, this, _1, _2, _3);
    }

    void onEvent(string event = "/hello", string data = "{}")
    {
        // execute event based on incomming event
        in_events[event](s, hdl, data);
    }

    void APIHandlerImpl::handleHello(server* s, websocketpp::connection_hdl hdl, string data)
    {
        // ...
    }

    void APIHandlerImpl::handleBye(server* s, websocketpp::connection_hdl hdl, string data)
    {
        // ...
    }
} 
```

* * *

## 回答 #17

> 赞同：0
> 
> 时间：2020-08-05T08:19:28.653

您可以在字符串上使用开关。你需要的是字符串表，检查每个字符串

```
char** strings[4] = {"Banana", "Watermelon", "Apple", "Orange"};

unsigned get_case_string(char* str, char** _strings, unsigned n)
{
    while(n)
    {
        n--
        if(strcmp(str, _strings[n]) == 0) return n;
    }
    return 0;
}

unsigned index = get_case_string("Banana", strings, 4);

switch(index)
{
    case 1: break;/*Found string `Banana`*/
    default: /*No string*/
} 
```

* * *

## 回答 #18

> 赞同：0
> 
> 时间：2021-10-26T09:37:30.823

野兔对尼克的解决方案的评论真的很酷。这里是完整的代码示例（在 C++11 中）：

```
constexpr uint32_t hash(const std::string& s) noexcept
{
    uint32_t hash = 5381;
    for (const auto& c : s)
        hash = ((hash << 5) + hash) + (unsigned char)c;
    return hash;
}

constexpr inline uint32_t operator"" _(char const* p, size_t) { return hash(p); }

std::string s = "raj";
switch (hash(s)) {
case "sda"_:
    // do_something();
    break;
default:
    break;
} 
```

* * *

## 回答 #19

> 赞同：-1
> 
> 时间：2009-03-16T12:28:34.593

您不能在 switch case 中使用字符串。只允许使用 int 和 char。相反，您可以尝试使用 enum 来表示字符串并在 switch case 块中使用它，例如

```
enum MyString(raj,taj,aaj); 
```

在 swich case 语句中使用它。

* * *

## 回答 #20

> 赞同：-1
> 
> 时间：2012-08-11T04:21:19.680

开关仅适用于整数类型（int、char、bool 等）。为什么不使用映射将字符串与数字配对，然后将该数字与开关一起使用？

* * *

## 回答 #21

> 赞同：-1
> 
> 时间：2016-09-23T03:11:15.703

在许多情况下，您可以通过从字符串中拉出第一个字符并打开它来获得额外的工作。如果您的案例以相同的值开头，则可能最终不得不在 charat(1) 上进行嵌套切换。任何阅读您的代码的人都会感谢您的提示，因为大多数人会怀疑 if-else-if

* * *

## 回答 #22

> 赞同：-2
> 
> 时间：2016-03-24T19:46:31.043

那是因为 C++ 将开关变成了跳转表。它对输入数据执行一个简单的操作，并在不比较的情况下跳转到正确的地址。由于字符串不是数字，而是数字数组，因此 C++ 无法从中创建跳转表。

```
movf    INDEX,W     ; move the index value into the W (working) register from memory
addwf   PCL,F       ; add it to the program counter. each PIC instruction is one byte
                    ; so there is no need to perform any multiplication. 
                    ; Most architectures will transform the index in some way before 
                    ; adding it to the program counter

table                   ; the branch table begins here with this label
    goto    index_zero  ; each of these goto instructions is an unconditional branch
    goto    index_one   ; of code
    goto    index_two
    goto    index_three

index_zero
    ; code is added here to perform whatever action is required when INDEX = zero
    return

index_one
... 
```

（来自维基百科的代码[https://en.wikipedia.org/wiki/Branch_table](https://en.wikipedia.org/wiki/Branch_table)）

# asp.net - Visual Studio 2008 中的项目级导入存储在哪里？

> ID：650165
> 
> 赞同：4
> 
> 时间：2009-03-16T12:14:47.827
> 
> 标签：asp.net, vb.net, visual-studio, visual-studio-2008, web-services

我在 Visual Studio 2008 中有一个 Web 服务应用程序项目。这应该是一个 ASP.Net 2.0 项目，并且在某些时候已经使用 3.5 进行了重建。

VS 友好地添加了对 System.Linq 和 System.Xml.Linq 的项目级导入，但是当我将项目重新定位为 2.0 时，这些项目级导入仍然存在。

因为 Web 服务应用程序项目没有用于编辑项目引用的详细窗口，所以我找不到如何删除这些项目级别的导入。

没有 .proj 文件，我认为这些文件包含在其中。

我现在无法构建项目，因为它失败了，即使我只收到警告（没有报告错误），例如：

*在项目级导入“System.Linq”中指定的命名空间或类型不包含任何公共成员或找不到。确保命名空间或类型已定义并包含至少一个公共成员。确保导入的元素名称不使用任何别名。*

帮助将不胜感激。

* * *

## 回答 #1

> 赞同：13
> 
> 时间：2009-03-16T12:24:47.583

请执行下列操作

*   右键单击项目并选择属性
*   导航到参考选项卡
*   页面底部将是一个“Imported Namespaces”组
*   取消选中您不想导入的命名空间

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2009-03-16T12:18:05.167

你可以做两件事之一。

**1.**在 Visual Studio 中，展开“References”文件夹并通过右键单击并选择删除来删除每个有问题的引用。

**2.**编辑项目文件并从各自的`ItemGroup`部分删除有问题的引用。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2009-03-16T12:26:25.427

我在 Web 应用程序项目中遇到了同样的问题 - 违规行在 web.config 中。不确定 Web 服务项目是否有 web.config，但请查看它使用的任何等效项。

# svn - 发布提交挂钩以更新版本下的文件

> ID：650168
> 
> 赞同：8
> 
> 时间：2009-03-16T12:16:12.113
> 
> 标签：svn, hook, post-commit

我制作了一个名为 version.ini 的文件，该文件受版本控制（/trunk/version.ini）我现在想制作一个提交后挂钩以使用最新版本更新该文件。但我不知道什么命令可以做到这一点。我知道我有这个参数：

```
#!/bin/sh

REPOS = "$1"
REV = "$2" 
```

但是如何在不进行新修订的情况下替换该文件的内容？我的回购中还有这些变化吗？

更新：因为也许我还不清楚，我会尝试更详细的解释：假设我有这个 repo：/svn/repos/project/trunk/，其中我有一个名为 version.ini 的文件，它受版本控制。我想要做的是在每次提交时将该文件更新为新版本。假设当前版本为 263，我希望该文件中写入 263。并且要回复下面的答案，您不能使用关键字，因为它们仅在我更新该文件并且我不想这样做时才起作用。

希望我有道理，并感谢您提供的任何帮助。干杯

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2009-03-17T00:02:18.483

您真正想要的不是修改提交的方法，而是类似[svn:keywords](http://svnbook.red-bean.com/en/1.5/svn.advanced.props.special.keywords.html)的东西。不幸的是，正如您在“$GlobalRev$ 在哪里？”框中看到的那样。这并没有真正做到你想要的。相反，您必须编写一个脚本来调用和解析[svnversion](http://svnbook.red-bean.com/en/1.5/svn.ref.svnversion.re.html)的输出，并以某种方式将结果作为构建的一部分放入您的文件中。

现在，要回答你的字面问题，想想在 svn 钩子脚本中你能做什么和不能做什么仍然很有趣：

**您不能从提交后挂钩更改提交**

在 post-commit 钩子运行时，提交已经完成（顾名思义），因此更改文件是不可能的。此时您只能检查更改。

**您也不能从预提交挂钩修改待处理的提交**

[您可以通过使用带有 --transaction 开关的svnlook](http://svnbook.red-bean.com/en/1.5/svn.ref.svnlook.html)工具从预提交挂钩检查待处理事务的内容，但您无法更改它。

如果可以在预提交挂钩中进行任意更改，那么显然服务器需要将这些更改报告给 svn 客户端。否则客户会认为他的文件处于提交的修订版，而它们实际上是不同的。如果 svn 客户端接受此类报告的更改，则可能会导致您的工作*被提交清除*。委婉地说，对于版本控制系统来说，这将是一个令人惊讶的功能。不用说颠覆不允许这样做。

* * *

## 回答 #2

> 赞同：5
> 
> 时间：2009-03-16T12:36:20.550

如果不修改修订号，就无法更改 repo 中的任何内容。

解决方案是将[特殊关键字](http://svnbook.red-bean.com/en/1.0/ch07s02.html)（搜索`svn:keywords`）放入文件中，并在结帐时让 SVN 替换它们。这些值似乎来自存储库，但存储库中文件的表示不会改变。

您可能正在寻找 $LastChangedRevision$（或简称 $Rev$）。

另一种解决方案是向您的构建工具/Makefile/whatever 添加一个规则，该规则在`svn info`项目的根目录中使用以确定当前修订并将其放入临时文件（*未*添加到您的存储库中）。

# floating-point - 散列浮点向量的好方法？

> ID：650175
> 
> 赞同：31
> 
> 时间：2009-03-16T12:18:26.210
> 
> 标签：floating-point, hashtable, hash

我很清楚比较浮点数所涉及的所有问题。这正是这个问题的原因。
我正在寻找为 3D 向量（3 个浮点数 - x、y、z）的值创建一个快速哈希表。可以假设向量的长度总是1.0（`sqrt(x*x+y*y+z*z)`是1.0）

本质上，这意味着我正在寻找一个散列函数，它的值几乎等于相同的 unsigned int 值，并且如果散列值相等，则对应的相等运算符为真（不一定只有它们相等）

**编辑**-
误报（即不同但映射到同一个桶的向量）是给定的，因为这是一个哈希表。
假阴性（即接近但映射到不同存储桶的向量）是不可取的，但似乎没有办法避免它们。就我而言，它们不会导致完全损坏，只是一些数据重复，这是我必须忍受的。

* * *

## 回答 #1

> 赞同：16
> 
> 时间：2009-03-16T12:28:37.183

我认为你正在寻找的东西是不可能的。等式的一个重要特性是它是可传递的。（即，如果 a == b 且 b == c，则 a == c）。但是，使用距离度量，您真的不想要这个属性。例子：

取一个浮点数（为简单起见）。假设我们想要对每个浮点数进行散列，使得小于 1e-3 的浮点数是相同的值。现在，假设我们将 1000 个浮点值添加到这个哈希表中，所有这些值都相隔 1e-4。任何相邻的 2 个值都应该散列到相同的浮点数，因为它们比 1e-3 更接近。但是，由于传递性，这些值的邻居也应该具有相同的值，以及它们的邻居等等。结果，所有 1000 个值，包括相距超过 1e-3 的对，都将散列为相同的整数。如果您要在图片上绘制这些点：

```
A  B  C  D  E  F  G  H ... Y Z 
```

假设所有间隙的距离 < 1e-3，但 A 和 Z 的距离 > 1e-3（不按比例！）。这不能满足，因为如果 hash(A) == hash(B) 和 hash(B) == hash(C) 等所有对（因为它们相距 < 1e-3）而不是 hash(A ) 必须 == 哈希(Z)。

一种可能的选择是定义向量空间的区域，其中所有向量将散列到相同的值（即在散列它们之前将它们四舍五入），但您仍然可以在它们各自空间的边缘上获得 2 个向量，它们靠近在一起但散列为不同的值。您可以通过在所有相邻空间中搜索向量来解决此问题。（即在上面的一维情况下，您会将所有向量四舍五入到最接近的 1e-3 倍数，然后搜索邻居，因此 5.3e-3 将搜索 5e-3、4e-3 和 6-e3。在更高维度的情况下，您必须搜索所有维度的邻居。）

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2009-03-16T12:25:38.690

I'd convert the float values into integers like this:

```
unsigned int IntValue = (int)(floatValue * MULT) + MULT; 
```

so you get some of the first digits and then use

```
const MULT1 = (MULT << 1) + 1;
unsigned long long HashValue = (xIntValue * MULT1  * MULT1) + (yIntValue * MULT1) + zIntValue; 
```

as a hash value (using (MULT * 2) + 1 because the IntValues will be between 0 and MULT * 2 inclusive).

The memory needed will be depending on the multiplicator MULT. For example, using 32 you'll get a hashtable using 64 * 64 * 64 * (Hash item size) = 262144 * (Hash item size) bytes.

* * *

## 回答 #3

> 赞同：3
> 
> 时间：2009-03-16T12:32:00.717

某些语言（C、Java 5）允许您访问浮点数的二进制值。这样，您可以提取尾数的前 N ​​位（忽略在比较期间导致问题的最后几位）并从中计算散列。

* * *

## 回答 #4

> 赞同：2
> 
> 时间：2012-05-31T15:08:42.457

我认为您正在有效地尝试解决 K 最近的问题。我相信您正在寻找的是[localitysensitive hashing](http://en.wikipedia.org/wiki/Locality-sensitive_hashing)。您也可以使用四叉树结构来实现相同的结果。

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2009-03-16T12:49:43.327

你能详细说明你的问题吗？

假设您使用哈希图将一些附加数据映射到特定向量，您可以只使用组件的二进制表示的 XOR（如果这在您选择的语言中是可能的）。然后根据哈希映射的需要使用尽可能多的 LSB（以减少冲突）。这当然具有两个相等（通过浮点比较）向量可能不具有相同散列的属性（例如，IEEE 浮点 0 等于 -0，但它们具有不同的符号位）。

但是，如果您计划使用作为不同计算结果的向量来进行哈希查找，那么您将自己设置为由于舍入错误而没有匹配哈希码的可能性，并且您可能应该使用其他东西。

* * *

## 回答 #6

> 赞同：1
> 
> 时间：2021-12-07T21:22:40.720

对的，这是可能的。我写了[一篇文章如何散列浮点向量](https://vitali-fedulov.github.io/algorithm-for-hashing-high-dimensional-float-vectors.html)和[用 Go 语言编写散列浮点向量](https://github.com/vitali-fedulov/hyper)。

* * *

## 回答 #7

> 赞同：0
> 
> 时间：2010-07-02T08:34:10.793

你需要它是一个快速的哈希表还是树结构？

在我看来，在某种搜索树中查找匹配的浮点数会更容易。假设您选择了正确的节点大小，B-Tree 可以最大限度地减少缓存未命中的数量[。](http://en.wikipedia.org/wiki/B-tree)这在实践中应该会很快。

* * *

## 回答 #8

> 赞同：0
> 
> 时间：2010-07-02T08:18:29.717

不知道这可能有多快，但是由于您有单位向量，它们都位于球体的表面上。转换为[http://en.wikipedia.org/wiki/Spherical_coordinate_system](http://en.wikipedia.org/wiki/Spherical_coordinate_system)。然后使用 phi 和 theta 来选择一个桶。不会有误报。您可以在相邻单元格中查找假阴性。

# sql - 在 Postgres / SQL 中，如何搜索不以字母开头的名称？

> ID：650178
> 
> 赞同：0
> 
> 时间：2009-03-16T12:19:30.200
> 
> 标签：sql, postgresql

我想找到所有以数字开头的名称、奇怪的字符（.、-#$ 等）以及其他所有非字母的名称。

例如，我有 3 个名字：John、#1 John 和 2John。我想得到的是最后两个名字。（而且我不知道名字可以用什么奇怪的字符开头，所以它一定是像！[aZ]）..

我正在使用postgresql。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2009-03-16T12:29:12.143

```
SELECT  *
FROM    Table
WHERE   name ~ '^[^a-zA-Z]' 
```

如果重音或非拉丁字符不属于您对“奇怪的东西”的定义，您可以使用：

```
SELECT  *
FROM    Table
WHERE   name ~ '^[^[:alpha:]]' 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-03-16T12:26:07.017

[PostgreSQL 手册：模式匹配](http://www.postgresql.org/docs/8.1/static/functions-matching.html)

# sql - 代表 NCAA 篮球支架的最佳模式

> ID：650182
> 
> 赞同：20
> 
> 时间：2009-03-16T12:20:52.087
> 
> 标签：sql, database-design, language-agnostic, database-agnostic

代表 NCAA 男篮支架的最佳数据库模式是什么？如果您不熟悉，这里是一个链接：http: [//www.cbssports.com/collegebasketball/mayhem/brackets/viewable_men](http://www.cbssports.com/collegebasketball/mayhem/brackets/viewable_men)

我可以看到几种不同的方法可以对这些数据进行建模，使用单个表、许多表、硬编码列、有些动态的方法等。您需要一种方法来对每个团队所在的种子和位置以及每个团队进行建模游戏和每个的结果（可能还有得分）。您还需要一种方法来代表谁在比赛的哪个阶段扮演谁。

本着疯狂三月的精神，我认为这是一个好问题。这里有一些明显的答案，这个问题的主要目标是查看您可以回答它的所有不同方式。哪种方式最好可能取决于您使用的语言或您使用它的准确程度，但请尽量保持答案与数据库无关、语言无关和相当高的水平。如果有人对如何更好地表达这个问题或更好地定义它有任何建议，请在评论中告诉我。

* * *

## 回答 #1

> 赞同：11
> 
> 时间：2009-03-24T20:11:43.807

自然的倾向是按照游戏进行的顺序查看括号。您从外向内阅读传统图表。但让我们反过来想它。每场比赛在两支球队之间进行。一个赢，另一个输。

现在，它不仅仅是这个。一对特定游戏的获胜者在另一场游戏中相互对抗。因此，游戏本身之间也存在关系，无论谁在玩这些游戏。也就是说，在每场比赛（第一轮除外）中对峙的球队是前两场比赛的获胜者。

因此，您可能会注意到，每场比赛之前都有两个“子比赛”，并决定了谁在该比赛中面对。这听起来就像一棵二叉树：每个根节点最多有两个子节点。如果您知道谁赢得了每场比赛，则可以轻松确定“父”比赛中的球队。

因此，要设计一个数据库来对此进行建模，您实际上只需要两个实体：`Team`和`Game`. 每个`Game`都有两个与其他`Game`s 相关的外键。名称无关紧要，但我们会将它们建模为单独的键，以强制要求每个游戏不超过两个前面的游戏。让我们称它们为`leftGame`和`rightGame`，以保持二叉树命名法。同样，我们应该有一个名为`parentGame`跟踪反向关系的键。

此外，正如我之前提到的，您可以通过查看前两场比赛的获胜者来轻松确定每场比赛的对手。所以你真的只需要追踪每场比赛的获胜者。所以，给`Game`实体一个表的`winner`外键`Team`。

现在，有播种支架的小问题。也就是说，为第一轮比赛建模。您可以通过`Game`为整个比赛中的每支球队建立一个模型来建模，该球队是该球队`winner`并且没有之前的比赛。

因此，整体架构将是：

```
Game:
    winner: Team
    leftGame: Game
    rightGame: Game
    parentGame: Game
    other attributes as you see fit

Team:
    name
    other attributes as you see fit 
```

当然，您可以将您想要的所有其他信息添加到实体中：位置、分数、结果（以防游戏因没收或其他异常情况而获胜）。

* * *

## 回答 #2

> 赞同：6
> 
> 时间：2009-03-16T12:40:53.067

对于 RDBMS，我认为仍然足够灵活以适应大多数情况的最简单方法是执行以下操作：

*   **团队**有*[team-id (PK)]*、*[name]*、*[region-id (FK to **Regions** )]*、*[initial-seed]*。每个团队都有一个条目。（区域表是一个简单的代码表，只有四个条目，每个 NCAA 区域一个，此处未列出。）

*   **参与者**有*[game-id (FK to **Games** )]* , *[team-id (FK to **Teams** )]* , *[score (nullable)]* , *[outcome]*。*[score]*可以为空，以反映团队可能会被没收。每场比赛通常有两名参与者。

*   **游戏**有*[game-id (PK)]* , *[date]* , *[location]*。要找出参加比赛的球队，请在参与者表中查找相应的比赛 ID。（请记住，如果有人退出或被取消资格，可能会有两个以上的团队。）

要设置初始支架，请将适当的种子相互匹配。随着比赛的进行，请注意哪支球队的*结果=*特定比赛的获胜者；这支球队将与另一场比赛的获胜者进行比赛。填写括号，直到没有更多的获胜队伍。

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2009-03-16T12:59:32.430

由于您没有指定 RDBMS，因此我将有所不同，并使用 CouchDB 方法，因为我本周末正在阅读有关该方法的内容。这是我提出的代表游戏的文档结构。

```
{
  "round" : 1, //The final would be round 5, and I guess Alabama St. vs. Morehead would be 0
  "location" : "Dayton, OH",
  "division": "South",
  "teams" : ["UNC", "Radford"]  //A feature of Couch is that fields like teams don't need a fixed nuber of columns.
  "winner" : "UNC"  //Showing my bias
} 
```

更有趣或更完整的应用程序可能还会在某处存储团队、排名等数据。约翰的方法似乎很好地涵盖了这个角度。我欢迎那些更了解我的沙发技能的人发表任何评论。

* * *

## 回答 #4

> 赞同：2
> 
> 时间：2009-03-24T20:29:01.067

我用下表创建了一个小系统：

游戏：GameId、TournId、RoundId、Sequence、Date、VisitorId、VisitorScore、HomeId、HomeScore、WinnerId、WinnerGameId、WinnerHome（位）

预测：PredId、UserId、GameId、PredVisitorId、PredHomeId、PredWinnerId

轮次：RoundId、TournId、RoundNum、Heading1、Heading2

团队：TeamId、TournId、TeamName、Seed、MoreInfo、Url

锦标赛：TournId、TournDesc

用户：TournId、用户名

WinnerGameId 将一场比赛的获胜者与他们的下一场比赛联系起来。WinnerHome 告诉获胜者是下一场比赛的主场还是访客。除此之外，我认为这是不言自明的。

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2009-03-24T22:05:43.283

**4张桌子：**

**团队**（团队、地区、种子）

**用户**（用户 ID、电子邮件、blablabla）

**括号**（BracketId、UserId、点）

**选择**（BracketId、GameId、团队、积分）

一个人提交的每个括号将在 Pick 表中有 63 行。
每场比赛结束后，您将更新选秀表以对个人选秀进行评分。此表中的积分字段对于尚未进行的游戏将为空，0 表示错误选择或正数表示正确选择。GameId 只是一个关键，用于确定用户选择该选择的位置（例如：East_Round2_Game2、FinalFour_Game1）。

括号表中的点列可以在每次更新选择表后更新，因此它包含该括号的点总和。最看的东西是积分榜，不想每次有人想查看排行榜时都重新总结。

您不需要保留所有实际进行的游戏或其结果的表格，只需在每场比赛后更新选择表即可。您甚至可以通过查看选秀表中的点列来突出显示正确/不正确选秀。

* * *

## 回答 #6

> 赞同：1
> 
> 时间：2009-03-25T07:51:37.977

## 建议模型

[提议的 ER 图 http://img257.imageshack.us/img257/1464/ncaaer.jpg](http://img257.imageshack.us/img257/1464/ncaaer.jpg)

## 团队表

我们只需要知道一个团队的名字和种子。因此，我们需要一个“团队”表来存储种子值。唯一的候选键是团队名称，因此我们将使用它作为主要键以保持简单。NCAA 球队名称不太可能在单个锦标赛期间更改或包含重复，因此它应该是一个足够的关键。

## 比赛表

“MatchUp”表可用于将球队配对到每个比赛中。“团队”的外键（FK1，FK2）将确保团队存在，并且这些值的主键确保团队只相互匹配一次。

“MatchUp”表中的“Team”表的外键 (FK4) 将记录获胜者。从逻辑上讲，获胜者需要是参加比赛的两支球队之一。针对主键的检查约束可以确保这一点。

一旦确定了比赛的结果，就可以从球队表中检索维克多的种子，以便与其他维克多的种子进行比较，以确定随后的比赛。这样做后，可以将结果比赛的 FK (FK3) 写入确定的比赛中，以描述比赛的进展情况（尽管该数据可能随时得到）。

## 游戏桌

我还模拟了每个 Match Up 的游戏。一场比赛由它所属的比赛和基于比赛期间发生的顺序的序列号来识别。游戏有一个来自团队表 (FK2) 的获胜者。分数也可以记录在这个表中。

* * *

## 回答 #7

> 赞同：1
> 
> 时间：2014-01-22T16:11:27.950

跟踪大量不同的括号预测：您可以使用 67 位来跟踪每场比赛的结果。（即，在锦标赛中进行的 67 场比赛中的每一场都由一个位表示，1 =“A 队获胜”，0 =“B 队获胜”）。要显示任何给定的括号，您可以使用一个非常简单的函数将 67 位映射到 UI。该函数知道团队名称及其初始位置，然后在跟踪“位板”时通过支架跟踪他们的移动。

* * *

## 回答 #8

> 赞同：-4
> 
> 时间：2009-03-26T02:31:48.953

我对所有数据库都使用相同的模式。

```
t
--------
1 guid PK
2 guid FK
3 bit 
```

然后在我的代码中：

```
select [2],[3] from t where [1] = @1 
```

@1 是我正在获取的数据的 ID。然后如果 [2] 不为空，我再次选择，将@1 设置为 [2]。

这使得对您发布的情况进行建模变得非常容易。

# c# - 阅读 web.config 内容的最佳方式

> ID：650189
> 
> 赞同：2
> 
> 时间：2009-03-16T12:24:35.697
> 
> 标签：c#, asp.net

我需要阅读 Web.Config 的内容并通过电子邮件发送它们，是否有更好的方法来执行以下操作：

```
 string webConfigContents = String.Empty;
        using (FileStream steam = new FileStream(
                 Server.MapPath("~/web.config"),
                 FileMode.Open, FileAccess.Read, FileShare.Read))
        {
            using (StreamReader reader = new StreamReader(steam))
            {
                webConfigContents = reader.ReadToEnd();
            }
        } 
```

我不想锁定文件。有任何想法吗？

*编辑 - 我需要文件的原始转储，我无法附加文件（Webhost 说不！），我没有在里面寻找任何特定的东西*

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2009-03-16T12:38:36.177

你可以用这个替换你的代码：

```
string webConfigContents = File.ReadAllText(Server.MapPath("~/web.config")); 
```

该文件在读取时将被锁定以进行写入，但不会被锁定。但我不认为这会是一个问题，因为 web.config 文件通常不会被写入（因为这会重新启动 Web 应用程序）。

* * *

## 回答 #2

> 赞同：-1
> 
> 时间：2009-03-16T12:28:18.200

通过使用[asp.net api](http://msdn.microsoft.com/en-us/library/610xe886.aspx)。

System.Configuration.Configuration 根WebConfig1 =

```
System.Web.Configuration.WebConfigurationManager.OpenWebConfiguration(null);
if (0 < rootWebConfig1.AppSettings.Settings.Count)
{
  System.Configuration.KeyValueConfigurationElement customSetting = 
  rootWebConfig1.AppSettings.Settings["customsetting1"];
  if (null != customSetting) {
    Console.WriteLine("customsetting1 application string = \"{0}\"",                  customSetting.Value);
  }
  else {
    Console.WriteLine("No customsetting1 application string");
  }
} 
```

# sharepoint - How to get in CAML (Sharepoint 2007) the same results as SPNavigation.QuickLaunch?

> ID：650192
> 
> 赞同：1
> 
> 时间：2009-03-16T12:25:09.627
> 
> 标签：sharepoint, sharepoint-2007, caml

I have a website in Sharepoint.

To get a list of sites ordered by the exploration, that is to say, ordered by the user in the sharepoint administration, i would write the following code:

```
 SPWeb web = CurrentSite.OpenWeb(currentSite);
 SPNavigation nav = web.Navigation;
 SPNavigationNodeCollection nodeColl = nav.QuickLaunch; 
```

That is ok, but i need to do it with CAML. The only problem is that i don't know how to get the items ordered as the user did it, i get the items unordered or ordered by a column, i don't think there is a column for the user's order.

Plz give me some code.

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-03-16T20:15:09.043

不幸的是，导航信息没有与库中的页面一起存储。导航可以存储更多刚刚发布的页面，因此导航必须存储在它自己的结构中。

这意味着没有内容查询。

# java - Correct heap implementation in a priority queue

> ID：650197
> 
> 赞同：-1
> 
> 时间：2009-03-16T12:26:11.947
> 
> 标签：java, heap

My issue is more semantic than functional, As the code does seem to implement the deQueue and enQueue functions correctly.

The reheapDown and reheapUp functions are being used incorrectly, And i believe the issue lies in my heap function

```
package priqueue;

public class Hosheap{
  private Patient[] elements;
  private int numElements;

  public Hosheap(int maxSize)
  {
    elements= new Patient[maxSize];
    numElements=maxSize;
  }

  public void ReheapDown(int root,int bottom)
  {
    int maxChild;
    int rightChild;
    int leftChild;
    leftChild=root*2+1;
    rightChild=root*2+2;

    if (leftChild<=bottom)
    {
      if(leftChild==bottom)
        maxChild=leftChild;
      else
      {
        if(elements[leftChild].getPriority() <= elements[rightChild].getPriority())
          maxChild=rightChild;
        else
          maxChild=leftChild;
      }
      if(elements[root].getPriority()<elements[maxChild].getPriority())
      {
        Swap(root,maxChild);
        ReheapDown(maxChild,bottom);
      }
    }
  }

  public void ReheapUp(int root,int bottom)
  {
    int parent;
    if(bottom>root)
    {
      parent=(bottom-1)/2;
      if(elements[parent].getPriority()<elements[bottom].getPriority())
      {
        Swap(parent,bottom);
        ReheapUp(root,parent);
      }
    }
  }

 public void Swap(int Pos1, int Pos2)
 {
   Patient temp;
   temp = elements[Pos1];
   elements[Pos1]=elements[Pos2];
   elements[Pos2]=temp;
 }

 public Patient getElement(int e)
 {
   return elements[e];
 }

 public void setElement(Patient p, int n)
 {
    elements[n]=p;
 }
} 
```

The idea is to rearrange a simple priority queue system so when a patient object is removed, ReheapUp or down correctly rearranges the queue, Which the code does not accomplish. Should i also include the priority queue code, Or is this already too lengthy?

I am using NetBeans IDE 6.0.1, If that helps.

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-03-16T12:44:39.313

根据您的使用要求，与 TreeSets 相关的答案很可能会满足您的需求。

然而，如果你*真的*需要一个队列，而不是一个排序的集合，那么内置的[PriorityQueue](http://java.sun.com/j2se/1.5.0/docs/api/java/util/PriorityQueue.html)可能会很有用。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-03-16T12:40:09.200

不完全回答您的问题，但对于 Java，您可能希望查看内置的 Collection 类。您可以获得优先队列行为，但使用 TreeSet（一种有序集）并为 Patient 实例实现自定义比较器。根据您要达到的目标，这可能更可取。它看起来像这样：

在 Patient.java ...

```
class Patient implements Comparator { 
...
public int compareTo(Patient other) {
    return getPriority() > other.getPriority() ? 1 : 0;
} 
```

然后在你要使用队列的地方

```
Set<Patient> queue = new TreeSet<Patient>();
queue.add(p1);
queue.add(p2);
//traverse in order of priority
for(Patient p : queue) {
  doStuff();
} 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2011-05-19T20:01:22.867

这是一个 PriorityHeap 的简单实现。我很快就把它编码了，所以它可能有一些缺陷，但我已经实现了 pushUp() 和 pushDown() 逻辑。

```
import java.util.Random;

public class Heap {

    private Double[] data;
    private int lastItem;

    public Heap(int initialSize) {
        // to simplify child/parent math leave the first index empty
        // and use a lastItem that gives us the size
        data = new Double[initialSize];
        lastItem = 0;
    }

    public void insert(Double d) {
        // double size if needed
        // should have a matching shrink but this is example code
        if (lastItem + 1 >= data.length) {
            Double[] doubled = new Double[data.length * 2];
            System.arraycopy(data, 0, doubled, 0, data.length);
            data = doubled;
        }
        data[lastItem + 1] = d;
        lastItem++;
        pushUp(lastItem);
    }

    public void pushDown(int index) {

        if (lastItem > 1) {

            int leftChildIndex = index * 2;
            int rightChildIndex = leftChildIndex + 1;

            // assume that neither child will dominate (in priority) 
            // the item at index
            int indexToPromote = index;
            // there may not be a left child
            if (leftChildIndex <= lastItem) {

                Double leftChild = data[leftChildIndex];
                Double tmp = data[index];
                if (tmp.compareTo(leftChild) < 0) {
                    indexToPromote = leftChildIndex;
                }

                // there might not be a right child
                if (rightChildIndex <= lastItem) {
                    Double rightChild = data[rightChildIndex];
                    tmp = data[indexToPromote];
                    if (tmp.compareTo(rightChild) < 0) {
                        indexToPromote = rightChildIndex;
                    }
                }
            }

            // did either child dominate the item at index
            // if so swap and push down again
            if (indexToPromote != index) {
                swap(index, indexToPromote);
                pushDown(indexToPromote);
            }
        }
    }

    public void pushUp(int index) {
        if (index > 1) {
            // equivalent to floor((double)index/2.0d);
            // if item at index is greater than its parent
            // push the item up to until if finds a home
            int parentIndex = index >>> 1;
            Double parent = data[parentIndex];
            Double item = data[index];
            if (item.compareTo(parent) > 0) {
                swap(parentIndex, index);
                pushUp(parentIndex);
            }
        }
    }

    public Double removeTop() {
        // assume size is zero then examine other cases
        Double top = null;
        if (lastItem > 1) {
            // save the top item and take the bottom item and place it 
            // at the top the push the new top item down until it 
            // finds a home
            top = data[1];
            Double bottom = data[lastItem];
            lastItem--;
            data[1] = bottom;
            pushDown(1);
        } else if (lastItem == 1) {
            top = data[1];
            lastItem--;
        }
        return top;
    }

    public int size() {
        return lastItem;
    }

    private void swap(int index1, int index2) {
        Double temp = data[index1];
        data[index1] = data[index2];
        data[index2] = temp;
    }

    public static void main(String[] args) {
        Heap heap = new Heap(4);
        Random r = new Random();
        for (int i = 0; i < 100000; i++) {
            Double d = Double.valueOf(r.nextDouble() * 100.0d);
            heap.insert(d);
        }
        double max = Double.MAX_VALUE;
        while (heap.size() > 0) {
            Double top = heap.removeTop();
            if (top.doubleValue() > max) {
                System.out.println("bad ordering...");
            }
            max = top.doubleValue();
            System.out.println(max);
        }
        System.out.println("done...");
    }
} 
```

# .net - .NET - 在正在运行的进程中调用方法

> ID：650198
> 
> 赞同：2
> 
> 时间：2009-03-16T12:26:19.000
> 
> 标签：.net, process

有没有办法在正在运行的 .NET 程序集中调用方法。

问题是我有一个 .NET 应用程序，它在系统启动时运行并将自身放入系统托盘中。用户可以通过双击托盘图标打开应用程序对话框，但即使用户再次启动应用程序（并且它已经在运行），我也想显示表单。目前在主要方法中，我将正在运行的 .NET 程序集作为 Process 但不知道如何获取对内部类/方法的引用。

我能够获得一个实例是否已经在运行，但想知道如何从我拥有的进程句柄中调用方法。当它是第二个实例时，我检查所有正在运行的进程并获得指向我已经运行的进程的指针。我想知道.NET 中是否有一种方法（彻底反射或其他方法）可以使用此进程句柄并向我返回一个指向接口的指针。

- 2009 年 4 月 7 日添加- 有许多解决方案可以查找实例是否已经在运行，但我真正想要的是将进程转换为某个接口并在其上调用方法。或使用一些参数将消息传递到正在运行的应用程序。

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2009-03-16T12:46:03.977

这并不是问题的真正解决方案（调用特定方法），但它可以解决您打开表单的问题。

该解决方案太复杂，无法在此处复制，因此请查看： http: [//www.codeproject.com/KB/cs/SingleInstanceAppMutex.aspx](http://www.codeproject.com/KB/cs/SingleInstanceAppMutex.aspx)

这段代码有什么作用？

> 1.  当用户第二次尝试打开应用程序时，第二个实例不会在屏幕上打开。
> 2.  相反，第一个实例出现在前台。如果它被最小化，它会被恢复。
> 3.  如果应用程序被最小化到 SYSTEM TRAY，那么它会从那里恢复。

如果您需要在实例之间传递参数，您甚至可以跳到页面末尾（我真的很喜欢 VB 解决方案......很遗憾它不是为任何语言设计的。但您仍然可以通过引用来使用它C# 应用程序中的 VisualBasic 命名空间。）

希望这可以帮助。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-03-16T12:33:21.900

并非不使用某种进程间通信机制。在 .Net 中实现这种 IPC 机制的一种相对直接的方法是使用 WCF 并在 WCF 端点中公开您需要的接口。

您可以使用其他 IPC 机制，包括命名管道、套接字等，但在这些情况下，您必须担心数据协议和序列化。WCF 的优势就是为您处理一切。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-03-16T12:39:24.677

IMO，对您来说更好的是使用 Mutex 将您的应用程序限制为单个实例，该实例可以设置一个标志，并且在应用程序启动时您可以重新检查该标志以查看应用程序是否已经在运行。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2009-03-16T12:50:23.637

这样做的最佳解决方案是声明一个全局互斥锁

```
 try
            {
                System.Threading.Mutex.OpenExisting("mymutex");
                //MessageBox.Show("already exist instance");
                //TODO

            }
            catch
            {
                m = new System.Threading.Mutex(true, "mymutex");

            } 
```

# excel - 检测是否安装了 Excel 2003 的最佳方法是什么？

> ID：650207
> 
> 赞同：3
> 
> 时间：2009-03-16T12:28:29.337
> 
> 标签：excel, wix, installation, windows-installer, wix3

我正在使用 Wix v3.0（归结为 MSI 安装程序），并且我正在尝试编写一个条件以确保已安装 Excel 2003。检测机器上是否存在 Excel 2003 的最佳（最可靠）方法是什么？

我看过很多不同的建议，但没有明确或权威的答案。

* * *

## 回答 #1

> 赞同：8
> 
> 时间：2009-03-16T15:20:11.157

[我在 Office 2003 工具包、 Office 2003 密钥路径和默认安装设置工作簿](http://www.microsoft.com/downloads/details.aspx?FamilyID=879c23e5-734d-4885-8d52-767bb9e37f37&DisplayLang=en)中找到了一个文件，其中包含 Office 组件的所有 GUID。基于此，我使用了组件搜索来定位 Core Excel 组件。在 WiX 中，我的情况如下所示：

```
 <Property Id="EXCEL2003INSTALLED">
      <!-- This is the Component Id of Global_Excel_Core -->
      <ComponentSearch Id="DetectExcel2003" Guid="{A2B280D4-20FB-4720-99F7-40C09FBCE10A}" Type="file"/>
    </Property>
    <Condition Message="This application requires Excel 2003 to be installed."><![CDATA[Installed OR EXCEL2003INSTALLED]]></Condition> 
```

[此页面](http://support.microsoft.com/kb/234788)包含其他 Office 应用程序和其他版本的组件指南。

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2009-03-16T12:51:01.687

我们在以下位置检查 InstallRoot 注册表项：

```
HKLM\Software\Microsoft\Office\12.0\Excel\InstallRoot 
```

（将 12.0 替换为您的应用程序的相关版本号）。

请注意，在 64 位操作系统上，这将反映到注册表的 32 位部分（有关注册表反射的更多信息，请参阅[此 Microsoft 文章](http://msdn.microsoft.com/en-us/library/aa384235%28v=vs.85%29.aspx)）。

这似乎至少适用于 2000、XP、2003、2007 和 2010 版本。2010 年的唯一变化是 64 位版本需要您查看注册表的 64 位部分。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-03-16T12:30:51.907

您可以尝试检查注册表，或者可能是 excel 的典型安装路径。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2009-03-16T12:52:40.793

Excel (Office) 也由 windows 安装程序安装。为什么不检查 excel 组件代码？

# java - JButton 在其本机类之外的范围

> ID：650210
> 
> 赞同：1
> 
> 时间：2009-03-16T12:28:41.973
> 
> 标签：java

如果我的 gui 中有一个返回 JButtons 列表的方法，那么在我的 makeFrame() 方法中，我用这些按钮填充我的 GridView，我怎样才能在我的逻辑类中获取这些按钮，

我使用的逻辑是检查按钮的标签，如果连续三个具有相同的标签，则赢，否则继续。但是逻辑类不能引用 gui 类，所以我不确定如何检查标签：p

谢谢

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-03-16T12:48:21.037

您的逻辑类不应该检查实际的 GUI 按钮，而是应该保存按钮状态的模型，例如，在 2D 数组中。然后，您可以在逻辑类中使用状态来检查胜利等。

GUI 上的按钮应该只代表逻辑类中的状态。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-03-16T12:47:17.343

您不想将 GUI 元素暴露给您的逻辑类。相反，公开 GUI 的状态，例如当有一个标记为“活动”的 JCheckBox 时，添加`isActive()`而不是`getCheckBox()`在您的 GUI 类中。

# linux - 如何在 X-Windows 中改变焦点？

> ID：650223
> 
> 赞同：3
> 
> 时间：2009-03-16T12:31:59.390
> 
> 标签：linux, x11, motif

我正在为 Linux 开发基于 Motif 的旧应用程序。我希望能够以编程方式更改我们应用程序的活动窗口。我可以使用 XSetInputFocus() 函数重定向输入并且键盘输入开始到那里，但是 XReconfigureWMWindow() 和 XRaiseWindow() 函数不起作用。

我读过窗口管理器试图阻止这种行为，所以试图禁用配置重定向，但这也不起作用。任何想法如何在窗口堆栈顶部制作我自己的窗口之一？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-03-17T18:32:01.840

有一个名为[wmctrl](http://tripie.sweb.cz/utils/wmctrl/)的小程序可用（至少在 Debian/Ubuntu 中它是标准发行版），它能够在 Windows 和桌面上执行许多操作，并处理大量的窗口管理器。我建议测试它是否适用于您的环境，如果可以，请查看其来源。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-03-16T12:46:32.197

您可能会发现这个问题的答案取决于用户正在使用的窗口管理器，甚至取决于他们为窗口管理器提供的设置。我喜欢将我的窗口管理器设置为“焦点跟随鼠标”，这意味着你不能将焦点发送到我没有把鼠标放在上面的窗口，除非你也在那里扭曲鼠标（那个函数叫做 XWarpMouse ？）。

# java - java eclipse-plugin：菜单项出现在Windows中但不在Linux上

> ID：650225
> 
> 赞同：1
> 
> 时间：2009-03-16T12:32:10.483
> 
> 标签：java, linux, eclipse-plugin, menu

我正在使用 plugin.xml 中的以下行使用我自己的操作 cmd 扩展工具菜单

```
 ...
   <extension
         point="org.eclipse.ui.menus">
      <menuContribution
            locationURI="menu:org.eclipse.ui.main.menu?after=edit">
         <menu
               id="geditorToolsMenu"
               label="T&amp;ools"
               mnemonic="Tools">
            <dynamic
                  class="com.myproject.eclipse.geditor.editors.ExternalToolsMenuCompoundContributionItem"
                  id="my.project.MyCompoundContributionItem">
            </dynamic>
            <visibleWhen>
               <with
                     variable="activePart">
                  <or>
                     <or>
                        <instanceof
                              value="org.eclipse.ui.views.navigator.IResourceNavigator">
                        </instanceof>
                        <instanceof
                              value="com.myproject.eclipse.geditor.editors.GBaseEditor">
                        </instanceof>
                        <instanceof
                              value="org.eclipse.jdt.internal.ui.packageview.PackageExplorerPart">
                        </instanceof>
                        <instanceof
                              value="org.eclipse.ui.navigator.resources.ProjectExplorer">
                        </instanceof>
                     </or>
                  </or>
               </with>
            </visibleWhen>
         </menu>
      </menuContribution>
   </extension>
   ... 
```

我面临的问题是“工具”菜单在 Windows 中的所有菜单项中看起来都很好，但在 linux 上会出现“工具”菜单，但是在单击它时，我看到一个像弹出窗口一样的小气泡。

有什么想法可能导致这种情况吗？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-03-16T14:10:47.203

Eclipse 3.4.x 中 Linux 的“菜单显示”的唯一问题在[此**错误 227243**](https://bugs.eclipse.org/bugs/show_bug.cgi?id=227243)中进行了描述。

您能否检查该错误中评论中详述的场景是否适用于您的案例？

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-03-25T18:39:01.587

您是否正在使用全新且干净的 Eclipse 安装进行测试？到目前为止，我对 Eclipse 的经验表明，随着时间的推移，Eclipse 有时会变得有点混乱或混乱，有时需要重新安装才能正常工作。不过，我不应该责怪 Eclipse，因为它完全可能是操作员的错误。

# c# - 在浏览器关闭时结束会话？

> ID：650228
> 
> 赞同：0
> 
> 时间：2009-03-16T12:33:10.900
> 
> 标签：c#, .net, asp.net

我想在用户关闭网络浏览器后立即刷新用户与我的网站的会话。我该如何实施呢？

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2009-03-16T12:45:45.723

这并不容易，因为 http 是无状态的。因此，当浏览器关闭时，您没有打开的连接。没有办法保证工作。可能会断开连接或断电，这会使任何“onClose”事件不可靠。

您可以在一定量的不活动后超时会话。但是，不能保证用户不只是去吃午饭，并且在他们回来时想要一个开放的会话。

如果您担心将人们指示为离线，您可以在 ajax 中进行一些轮询以保持会话处于活动状态并销毁超过轮询间隔未使用的会话。但是，如果您只是担心资源，我猜这弊大于利。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2009-03-16T12:41:14.267

[在onbeforeunload()](http://msdn.microsoft.com/en-us/library/ms536907(VS.85).aspx)事件中进行 ajax 调用并调用：

```
Session.Abandon(); 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-03-16T13:03:01.377

正如其他人指出的那样，您最好的选择可能是进行 Ajax 调用，这将使会话保持活动状态。如果您保持精简，此调用可能会以较快的间隔发生。然后你可以使用某种会话超时算法。

话虽如此，有几点需要注意。您可能希望在协议中构建一种方法来强制用户注销应用程序。想象一下，一个用户登录到您的应用程序，他周末回家时没有关闭他的计算机。

在周末，您进行了部署，这将使所有 ajax 通信无效，因为您修改了协议或其他内容。除非您强制他退出，否则他将继续登录，并且在他周一早上来时可能会出错。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2009-03-16T12:48:19.913

当用户关闭窗口或离开页面时，您没有在服务器端触发任何事件，您可以使用会话超时来检查它，然后确保会话不会因空闲用户而死，这可能是在浴室，或者制作咖啡，用 AJAX 左右验证它。

```
MakeDummyRequest(); // with a simple http request, you can keep your session alive. 
```

# c++ - 使用指向存储在向量中的对象的指针... c++

> ID：650232
> 
> 赞同：1
> 
> 时间：2009-03-16T12:33:38.653
> 
> 标签：c++, pointers, iterator, stdvector

我在全局范围内有一个 myObjects 向量。

```
std::vector<myObject> 
```

方法被传递一个指向向量中元素之一的指针。这个方法可以增加指针，以到达下一个元素，

```
myObject* pmObj;

++pmObj; // the next element ?? 
```

还是应该传递一个`std::Vector<myObject>::iterator`并增加它？

现在假设向量在此期间不会改变。

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2009-03-16T12:35:36.370

是的-标准在技术更正中保证向量的存储是连续的，因此将指针递增到向量中将起作用。

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2009-03-16T12:39:32.820

是的，这将按预期工作，因为`std::vector`标准要求使用连续存储。如果您正在处理一系列对象，我建议您传入一对迭代器。这几乎是 STL 使用的标准习语。这也将使您的代码更安全一些，因为您有一个明确的迭代端点，而不是依赖于计数或类似的东西。

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2009-03-16T12:36:14.217

如果向量没有重新分配并且您确定不会超出向量的范围，那么您可以使用这种方法。递增指针是合法的，当你有空间移动到下一个元素时，你可以通过递增指针来做到这一点，因为向量的缓冲区是单个内存块。

# vb.net - 有什么方法可以将 ParamArray 值处理为 byRef 以便可以更新它们？

> ID：650233
> 
> 赞同：5
> 
> 时间：2009-03-16T12:34:15.580
> 
> 标签：vb.net, parameters, byref, paramarray

听起来很简单，但它不起作用。在此示例中，我想将 3 个字段的值设置为第 4 个。我可以做这样的事情......

```
Dim str1 As String = "1"
Dim str2 As String = "2"
Dim str3 As String = "3"
Dim str4 As String = "4"

str2 = str1
str3 = str1
str4 = str1 
```

...但这有点罗嗦（是的，我知道，vb 在大多数情况下都是罗嗦的）。我想有一些东西可以用来减少单行调用，所以我做了这个扩展方法。

```
Module Module1

    Sub Main()

        Dim str1 As String = "1"
        Dim str2 As String = "2"
        Dim str3 As String = "3"
        Dim str4 As String = "4"

        Console.WriteLine("Extension method return value = {0}", str1.SetEqual(str2, str3, str4))
        Console.WriteLine("String 1 = {0}", str1)
        Console.WriteLine("String 2 = {0}", str2)
        Console.WriteLine("String 3 = {0}", str3)
        Console.WriteLine("String 4 = {0}", str4)

        Console.ReadKey()

    End Sub

    <System.Runtime.CompilerServices.Extension()> _
    Public Function SetEqual(Of T)(ByVal source As T, _
                                   ByVal ParamArray targets() As T) _
                                   As T

        For _index = 0 To targets.Length - 1
            targets(_index) = source
            Console.WriteLine("Target Value {0} = {1}", _index, targets(_index))
        Next

        Return source

    End Function

End Module 
```

看起来很简单，对吧？嗯，输出是这样的……

```
Target Value 0 = 1
Target Value 1 = 1
Target Value 2 = 1
Extension method return value = 1
String 1 = 1
String 2 = 2
String 3 = 3
String 4 = 4 
```

参数数组中的值没有在返回中更新！我期待现在所有的最终值都是“1”，就像它们在函数中一样。

有没有办法获得这样的可更新 ParamArray 集合？ParamArray 必须声明为 ByVal，但使用像 String 这样的引用类型，难道不应该只复制指针并允许我更改基础值吗？

有没有更好的方法来得到我想要的？（C# 不是这个选项）。

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2009-03-16T12:38:12.123

使用 ParamArray 无法实现您想要做的事情。当您调用 ParamArray 方法时，会在后台发生以下情况

1.  CLR 分配适当长度的数组
2.  然后将值复制到数组中
3.  数组向下传递给函数

没有调用后操作会将值从数组中复制回传入的原始变量中。

让函数修改值并在调用站点看到它的唯一可靠方法是传递值 ByRef。您可以做一些魔术来拥有一组采用 ByRefs 的重载，手动转换为数组，然后进行复制。但那是你将得到的最接近的。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2018-08-21T00:07:13.020

举例来说可能有点晚了（大约 10 年前），但如果可行的话可能会帮助其他人......

您不能将参数数组作为引用传递，但可以将数组作为引用传递。

将其更改为**ByRef**并*删除* **ParamArray**

然后修改这一行：

```
Console.WriteLine("Extension method return value = {0}", str1.SetEqual({str2, str3, str4})) 
```

只需注意额外的“{”和“}”以将字符串作为数组而不是 ParamArray 传递

我在一个类中使用它来传递一组控件并且它有效（ParamArray 没有）所以我希望（不能在这里测试它）但它可能值得一试

# mysql - 如何显示在 MySQL 上执行的最后一个查询？

> ID：650238
> 
> 赞同：520
> 
> 时间：2009-03-16T12:35:54.390
> 
> 标签：mysql, logging

是否有任何查询/方式来显示在**所有**服务器上执行的最后查询？

* * *

## 回答 #1

> 赞同：887
> 
> 时间：2009-03-24T17:02:32.263

对于那些拥有 MySQL >= 5.1.12 的人，您可以在运行时全局控制此选项：

1.  执行`SET GLOBAL log_output = 'TABLE';`
2.  执行`SET GLOBAL general_log = 'ON';`
3.  看看表`mysql.general_log`

如果您更喜欢输出到文件而不是表：

1.  `SET GLOBAL log_output = "FILE";` *默认的*.
2.  `SET GLOBAL general_log_file = "/path/to/your/logfile.log";`
3.  `SET GLOBAL general_log = 'ON';`

我更喜欢这种方法来编辑 .cnf 文件，因为：

1.  您没有编辑`my.cnf`文件并可能永久打开日志记录
2.  您不会在文件系统中四处寻找查询日志——或者更糟的是，因为需要完美的目的地而分心。 `/var/log /var/data/log` `/opt /home/mysql_savior/var`
3.  您不必重新启动服务器并中断与它的任何当前连接。
4.  重新启动服务器会让你回到你开始的地方（默认情况下日志仍然关闭）

有关更多信息，请参阅 [MySQL 5.1 参考手册 - 服务器系统变量 - general_log](http://dev.mysql.com/doc/refman/5.1/en/server-system-variables.html#sysvar_general_log)

* * *

## 回答 #2

> 赞同：44
> 
> 时间：2009-03-16T12:40:36.670

您可以为此类诊断启用[常规查询日志。](http://dev.mysql.com/doc/refman/5.0/en/query-log.html)通常，您不会在生产服务器上记录所有 SELECT 查询，它是性能杀手。

编辑您的 MySQL 配置，例如 /etc/mysql/my.cnf - 查找或添加这样的行

```
[mysqld]
log = /var/log/mysql/mysql.log 
```

重新启动 mysql 以获取该更改，现在您可以

```
tail -f /var/log/mysql/mysql.log 
```

嘿 presto，您可以在查询进入时查看它们。

* * *

## 回答 #3

> 赞同：23
> 
> 时间：2015-06-18T17:49:01.777

```
SELECT * FROM  mysql.general_log  WHERE command_type ='Query' LIMIT total; 
```

* * *

## 回答 #4

> 赞同：19
> 
> 时间：2015-03-30T10:15:46.257

你可以做流动的事情来监控 mysql 查询日志。

打开mysql配置文件my.cnf

```
sudo nano /etc/mysql/my.cnf 
```

在标题下搜索以下行`[mysqld]`并取消注释这些行以启用日志

```
general_log_file        = /var/log/mysql/mysql.log
general_log             = 1 
```

重新启动您的 mysql 服务器以反映更改

```
sudo service mysql start 
```

在终端中使用以下命令监控 mysql 服务器日志

```
tail -f /var/log/mysql/mysql.log 
```

* * *

## 回答 #5

> 赞同：17
> 
> 时间：2015-11-26T07:02:31.153

1）如果启用了通用mysql日志记录，那么我们可以根据我们在配置中提到的内容检查日志文件或表中的查询。使用以下命令检查启用了什么

```
mysql> show variables like 'general_log%';
mysql> show variables like 'log_output%'; 
```

如果我们需要表中的查询历史记录，那么

```
Execute SET GLOBAL log_output = 'TABLE';
Execute SET GLOBAL general_log = 'ON'; 
```

看一下表 mysql.general_log

如果您更喜欢输出到文件：

```
SET GLOBAL log_output = "FILE"; which is set by default.
SET GLOBAL general_log_file = "/path/to/your/logfile.log";
SET GLOBAL general_log = 'ON'; 
```

2）我们也可以查看.mysql_history文件cat ~/.mysql_history中的查询

* * *

## 回答 #6

> 赞同：5
> 
> 时间：2009-03-16T12:39:03.540

也许您可以通过查看[查询日志](http://dev.mysql.com/doc/refman/5.1/en/query-log.html)来发现这一点。

* * *

## 回答 #7

> 赞同：4
> 
> 时间：2014-02-09T09:02:24.643

如果启用了*mysql binlog*，您可以通过浏览到 mysql binlog 目录在 linux 控制台中执行以下命令来检查用户运行的命令

```
mysqlbinlog binlog.000001 >  /tmp/statements.sql 
```

**启用**

```
[mysqld]
log = /var/log/mysql/mysql.log 
```

或者一般日志会影响mysql的性能

* * *

## 回答 #8

> 赞同：4
> 
> 时间：2016-02-12T00:13:21.367

如果您不想更改 MySQL 配置，您可以使用 SQL 分析器，例如“Neor Profile SQL” [http://www.profilesql.com](http://www.profilesql.com)。

* * *

## 回答 #9

> 赞同：3
> 
> 时间：2018-03-26T17:44:35.430

[阅读保罗的回答后，我继续在https://dev.mysql.com/doc/refman/5.7/en/query-log.html](https://dev.mysql.com/doc/refman/5.7/en/query-log.html)上挖掘更多信息

我发现一个人的一个非常有用的代码。这是上下文的摘要。

（注：以下代码不是我的）

此脚本是保持表格清洁的示例，可帮助您减小表格大小。一天后，将有大约 180k 的日志查询。（在一个文件中，每天 30MB）

您需要添加一个额外的列（event_unix），然后您可以使用此脚本来保持日志干净......它将时间戳更新为 Unix 时间戳，删除早于 1 天的日志，然后将 event_time 更新为时间戳来自 event_unix... 听起来有点混乱，但它工作得很好。

**新列的命令：**

```
SET GLOBAL general_log = 'OFF';
RENAME TABLE general_log TO general_log_temp;
ALTER TABLE `general_log_temp`
ADD COLUMN `event_unix` int(10) NOT NULL AFTER `event_time`;
RENAME TABLE general_log_temp TO general_log;
SET GLOBAL general_log = 'ON'; 
```

**清理脚本：**

```
SET GLOBAL general_log = 'OFF';
RENAME TABLE general_log TO general_log_temp;
UPDATE general_log_temp SET event_unix = UNIX_TIMESTAMP(event_time);
DELETE FROM `general_log_temp` WHERE `event_unix` < UNIX_TIMESTAMP(NOW()) - 86400;
UPDATE general_log_temp SET event_time = FROM_UNIXTIME(event_unix);
RENAME TABLE general_log_temp TO general_log;
SET GLOBAL general_log = 'ON'; 
```

归功于 Sebastian Kaiser（代码的原始作者）。

希望有人会像我一样发现它有用。

* * *

## 回答 #10

> 赞同：1
> 
> 时间：2013-04-17T09:01:40.357

你可以在linux中查看以下内容

```
cd /root

ls -al 
```

`vi .mysql_history` 它可能会有所帮助

# c# - GTK#绘图区鼠标事件

> ID：650252
> 
> 赞同：10
> 
> 时间：2009-03-16T12:38:12.933
> 
> 标签：c#, .net, mono, gtk#

我有一个 DrawingArea，我想接收鼠标事件。从教程中我发现 KeyPressEvent 也会捕获鼠标事件。但是，对于以下代码，永远不会调用处理程序。

```
static void Main ()
{
    Application.Init ();
    Gtk.Window w = new Gtk.Window ("");

    DrawingArea a = new CairoGraphic ();
    a.KeyPressEvent += KeyPressHandler;
    w.Add(a);

    w.Resize (500, 500);
    w.DeleteEvent += close_window;
    w.ShowAll ();

    Application.Run ();
}

private static void KeyPressHandler(object sender, KeyPressEventArgs args)
{
    Console.WriteLine("key press event");   
} 
```

我通过阅读不同的论坛和教程尝试了很多东西，包括：

将 EventBox 添加到窗口并将 DrawingArea 放入事件框中并订阅 EventBox 的 KeyPressEvent。（没用）

调用 AddEvents((int)Gdk.EventMask.AllEventsMask); 在任何和所有小部件上

我确实发现订阅 Windows KeyPressEvent 确实给了我键盘事件，但没有给我鼠标点击事件。

单声道文档中的所有相关页面都给了我错误，所以我有点卡住了

* * *

## 回答 #1

> 赞同：16
> 
> 时间：2009-04-30T09:56:12.573

您还应该记住，应该将事件掩码添加到您的 DrawingArea：

```
a.AddEvents ((int) 
            (EventMask.ButtonPressMask    
            |EventMask.ButtonReleaseMask    
            |EventMask.KeyPressMask    
            |EventMask.PointerMotionMask)); 
```

所以你的最终代码应该是这样的：

```
class MainClass
{
    static void Main ()
    {
        Application.Init ();
        Gtk.Window w = new Gtk.Window ("");

        DrawingArea a = new DrawingArea ();
        a.AddEvents ((int) EventMask.ButtonPressMask);
        a.ButtonPressEvent += delegate(object o, ButtonPressEventArgs args) {
            Console.WriteLine("Button Pressed");
        };

        w.Add(a);

        w.Resize (500, 500);
        w.DeleteEvent += close_window;
        w.ShowAll ();

        Application.Run ();
    }

    static void close_window(object o, DeleteEventArgs args) {
        Application.Quit();
        return;
    }
} 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-03-16T15:00:16.117

如果要捕获鼠标事件，则必须使用 ButtonPressEvent、ButtonReleaseEvent 和 MotionNotifyEvent：

```
a.ButtonPressEvent += delegate(object o, ButtonPressEventArgs args) {
    Console.WriteLine("Button Pressed");
} 
```

KeyPressEvent 仅用于键。

# c# - C++ ULONG 定义为 VB.NET 还是 C# 等效？

> ID：650261
> 
> 赞同：1
> 
> 时间：2009-03-16T12:40:01.900
> 
> 标签：c#, c++, vb.net, types

我正在尝试使用使用套接字的呼叫记录 API。我们有 API 文档，但示例都使用 C++。

我将如何在 VB.NET 或 C# 中声明以下内容？

```
#define SIF_GENERAL 0x08000000
#define SIF_CONFIGURATION 0x08010000
#define SIF_ARCHIVE 0x08020000
#define SIF_SEARCH 0x08030000
#define SIF_REPLAY 0x08040000
#define SIF_STATISTICS 0x08050000
#define SIF_ENGINEER 0x08060000 
```

文档中的注释：消息标识符是无符号的 32 位值 ( `ULONG`)。

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2009-03-16T12:42:55.853

VB.NET

```
Module Constants
  Public Const SIF_GENERAL as Integer =&H08000000
  Public Const SIF_CONFIGURATION As Integer = &H08010000
  Public Const SIF_ARCHIVE As Integer = &H08020000
  Public Const SIF_SEARCH As Integer = &H08030000
  Public Const SIF_REPLAY As Integer = &H08040000
  Public Const SIF_STATISTICS As Integer = &h08050000
  Public Const SIF_ENGINEER As Integer = &h08060000

End Module 
```

C＃

```
public static class Constants {
  public const int SIF_GENERAL =0x08000000;
  public const int SIF_CONFIGURATION = 0x08010000;
  public const int SIF_ARCHIVE = 0x08020000;
  public const int SIF_SEARCH = 0x08030000;
  public const int SIF_REPLAY = 0x08040000;
  public const int SIF_STATISTICS = 0x08050000;
  public const int SIF_ENGINEER = 0x08060000;
} 
```

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2009-03-16T12:50:16.493

C++ ULONG 是 32 位无符号整数类型。在这种情况下，您的常量不需要无符号，因此只需在 C# 中使用 int 或在 VB.NET 中使用 Integer。

VB.NET

```
Public Const SIF_GENERAL as Integer = &H08000000 
```

C＃

```
public const int SIF_GENERAL = 0x08000000; 
```

不要使用 64 位长数据类型，因为数据大小对于您的 API 调用不正确。

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2009-03-16T13:00:39.197

您可以使用枚举使这些值看起来更像 .NETty：

```
//C#
public enum SIF : uint
{
    SIF_GENERAL = 0x08000000,
    SIF_CONFIGURATION = 0x08010000,
    SIF_ARCHIVE = 0x08020000,
    SIF_SEARCH = 0x08030000,
    SIF_REPLAY = 0x08040000,
    SIF_STATISTICS = 0x08050000,
    SIF_ENGINEER = 0x08060000,
} 
```

或者

```
'VB.NET
Public Enum SIF As UInt32
    SIF_GENERAL = &H08000000
    SIF_CONFIGURATION = &H08010000
    SIF_ARCHIVE = &H08020000
    SIF_SEARCH = &H08030000
    SIF_REPLAY = &H08040000
    SIF_STATISTICS = &H08050000
    SIF_ENGINEER = &H08060000
End Enum 
```

通过这种方式，您可以获得枚举的可发现性和类型安全性（除了通过接口传递它们的地方，您需要将它们强制转换的地方）。

您甚至可以通过重命名它们来增加 .NET 的外观——例如 SIF.SIF_GENERAL 可以变为 SIF.General，尽管优势很小。

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2009-03-16T13:32:00.947

如果你有常量 >= 0x8000000，那么你可以这样定义它们：

```
class Test
{
   public const int AllBits = unchecked((int)0xFFFFFFFF);
   public const int HighBit = unchecked((int)0x80000000);
} 
```

[请参阅有关 unchecked 的 MSDN 文章](http://msdn.microsoft.com/en-us/library/aa691349%28VS.71%29.aspx)。

# .net - Windows 窗体 DataGridView 的 ItemDataBound？

> ID：650271
> 
> 赞同：2
> 
> 时间：2009-03-16T12:41:15.187
> 
> 标签：.net, windows, winforms, data-binding

我将数组绑定到 DataGridView。我有一列包含映射到一列按钮的文件路径。我想预处理文件路径，以便 DataGridViewButtonColumn 仅显示文件名（无父文件夹）。

如何在值绑定到 DataGridView 的列之前拦截和预处理值？

（我在 ASP.NET 数据绑定中看到过类似的东西，并希望我能在这里做同样的事情。）

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2009-03-16T13:41:57.943

处理 CellFormatting 事件。您将从事件 args 中获得一个表示未格式化值的值。接受它并解析它（Path.GetFileName()) 或类似的东西），然后将 ConvertEventArgs.Value 属性设置为您的新字符串。将“FormattingApplied”标志设置为 true，以防止进一步的格式化事件。那应该覆盖你。

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2009-03-16T13:06:42.053

检查单元格格式化[事件](http://msdn.microsoft.com/en-us/library/system.windows.forms.datagridview.cellformatting.aspx)。

那里有一个示例应该适用于您的场景。

# java - 在 Java 中处理大型数据结构

> ID：650274
> 
> 赞同：7
> 
> 时间：2009-03-16T12:42:34.530
> 
> 标签：java, memory, matrix

我正在开发一个需要处理非常大的矩阵的 Java 应用程序。例如将两个 1000 万 * 1000 万矩阵相乘！当然，Java 堆甚至没有足够的空间来存储这些矩阵之一。我应该怎么办？我是否应该使用数据库来存储我的矩阵并将每个需要的部分都带入内存并一个接一个地相乘？

* * *

## 回答 #1

> 赞同：8
> 
> 时间：2009-03-18T04:38:56.260

首先，一个 1000 万 x 1000 万的矩阵简直是巨大的。假设每个单元加倍并且没有过度存储，这些东西中的每一个都将是 800 TB。只需从主内存中读取每个单元格（如果它以某种方式神奇地适合那里，这显然不会发生），需要几天的时间。从任何一种合理的 SAN（我们将其放在 10GbE 上）执行此操作更可能需要几个月的时间。并且没有矩阵乘法具有 O(n) 复杂度 - 正常的方法是 O(n^3)。所以……你不是用内存映射文件、通用数据库或任何类似的东西来做这件事的。

执行此类操作的代码将在缓存效率上生死攸关，其中“缓存”包括充分利用主内存、本地磁盘驱动器。由于任何拥有超过一个 800 TB 矩阵的存储接口都必然是某种 SAN，因此您几乎肯定会涉及到多个服务器读取和处理它的不同部分。

有许多众所周知的方法可以并行化矩阵乘法（本质上是将各种大小的子矩阵相乘，然后组合结果），并通过围绕[空间填充曲线](http://portal.acm.org/citation.cfm?id=1366223)组织数据来改变布局，以便访问模式具有合理的缓存局部性行/列排列。您肯定会想看看经典的[LAPACK](http://www.netlib.org/lapack/)接口和设计、[英特尔的 MKL](http://www.intel.com/cd/software/products/asmo-na/eng/307757.htm)、[GotoBLAS](http://www.tacc.utexas.edu/resources/software/#blas)作为针对特定现代硬件调整的 BLAS 功能的实现，然后您可能会冒险进入未开发的领域:-)

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2009-03-16T12:53:00.153

如果简单地执行矩阵乘法的复杂性是 O(n^3)，但确实存在更有效的算法。无论如何，对于一个 1000 万 * 1000 万的矩阵，这将需要很长时间，并且您可能会面临相同的堆问题，但具有递归性。

如果您对复杂的数学感兴趣，您可能会在[本文](http://en.wikipedia.org/wiki/Matrix_multiplication#Algorithms_for_efficient_matrix_multiplication)中找到可以帮助您的工具。

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2009-03-16T12:44:31.343

考虑使用像[http://hsqldb.org/这样的内存数据库](http://hsqldb.org/)

* * *

## 回答 #4

> 赞同：2
> 
> 时间：2009-03-16T12:56:03.233

由于这是一个如此庞大的计算，我认为您将在存储问题的同时遇到性能问题。所以我会考虑并行化这个问题，并让多个机器/核心来处理数据子集。

幸运的是，矩阵乘法解决方案会自然分解。但我会关注某种形式的网格或分布式计算解决方案。

* * *

## 回答 #5

> 赞同：2
> 
> 时间：2009-03-16T12:58:03.837

使用适用于您的数据的任何稀疏矩阵算法。（假设您没有 2.4 PB 的磁盘空间来保存 3 个 10^8 平方非稀疏双精度矩阵，更不用说内存数据库的那么多 RAM - Blue Gene/Q 'only' 有1.6 PB。）

* * *

## 回答 #6

> 赞同：1
> 
> 时间：2009-03-16T16:32:10.953

尝试通过将所有数据存储在外部文件中并通过 FileChannel 对象访问它来使用[内存映射文件。](http://en.wikipedia.org/wiki/Memory-mapped_file)

查看[这篇文章](http://www.developer.com/java/other/article.php/1548681)，了解 MMF 的简要介绍。

* * *

## 回答 #7

> 赞同：1
> 
> 时间：2009-03-16T12:46:52.600

好吧，如果您被迫使用 Java 并且无法编写将其作为本机方法处理的代码（也就是说，通过告诉 Java 调用一些 C 代码），那么最有效的做法是使用简单的二进制文件。在这种情况下，我会远离数据库，因为它们比直接文件访问慢，而且您不需要它们提供的功能。

* * *

## 回答 #8

> 赞同：1
> 
> 时间：2009-03-16T12:54:02.193

看看[hadoop](http://hadoop.apache.org/core/)。

* * *

## 回答 #9

> 赞同：0
> 
> 时间：2009-03-16T15:24:38.290

看看 CGL-MapReduce [http://www.cs.indiana.edu/~jekanaya/cglmr.html#Matrix_Multiplication](http://www.cs.indiana.edu/~jekanaya/cglmr.html#Matrix_Multiplication)

# eclipse-plugin - Eclipse 插件开发：如何使用新的富文本悬停（自 3.4 起）

> ID：650278
> 
> 赞同：3
> 
> 时间：2009-03-16T12:43:55.680
> 
> 标签：eclipse-plugin, eclipse-rcp

我已经使用 ITextHover 在我的插件中实现了纯文本悬停。现在我想使用新的 eclipse 3.4 功能 - 富文本悬停在文本样式、图像和操作中。但我找不到关于它的文章/示例。我应该使用哪些接口以及在哪里使用？我找到了 ITextHoverExtension2 接口，但找不到如何创建悬停对象（它们应该是什么类？）以及应该捕获它们的接口是什么？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-03-24T04:12:26.313

我不知道 OP 是否仍然感兴趣，但为了记录：我之前写的内容对了一半，错了四分之三以上（是的，我可以做数学 :-) 我写了[一篇博](http://www.outofwhatbox.com/blog/2009/05/eclipse-rich-hovers-redux/)文我希望在涵盖这个主题方面做得更好。

（如果你对这种自我推销不满意，你可以微笑着知道这次更新不太可能吸引很多读者。）

# .net - Paypal 与适用于 Windows mobile 6.0 的袖珍 PC 应用程序集成

> ID：650279
> 
> 赞同：0
> 
> 时间：2009-03-16T12:44:22.730
> 
> 标签：.net, compact-framework, paypal, pocketpc

我正在为 Windows mobile 6.0 开发袖珍 PC 应用程序，并且我想使用 Paypal。

我应该为此使用 Web 浏览器控件吗？我需要了解将 PayPal 实施到我的智能设备应用程序的整个过程和流程。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-03-16T12:53:55.297

我不确定您的具体要求是什么，但我将从[PayPal Web 服务 API](https://developer.paypal.com/en_US/pdf/PP_APIReference.pdf)开始。

# .net - OleDbException：条件表达式中的数据类型不匹配

> ID：650282
> 
> 赞同：0
> 
> 时间：2009-03-16T12:44:40.407
> 
> 标签：.net, sql, ms-access

我使用 C# 从 MS Access 读取数据。但是让 OleDbException 尝试执行这样的查询：

```
SELECT * FROM Flats 
WHERE Flats.VersionStamp <= [theDate] AND Flats.Flat=[theFlat] 
```

OleDb 异常：

```
Data type mismatch in criteria expression. 
```

另一方面，以下任何一个查询都可以正常工作：

```
SELECT * FROM Flats 
WHERE Flats.VersionStamp <= [theDate] AND Flats.Flat=1

SELECT * FROM Flats 
WHERE Flats.VersionStamp <= #1/1/2009# AND Flats.Flat=[theFlat] 
```

C# 代码始终保持不变：

```
DbParameter theFlat = new OleDbParameter("theFlat", 1);
DbParameter theDate = new OleDbParameter("theDate", new DateTime(2009, 1, 1));

using (DbDataReader reader = dbHelper.ExecuteReader(sqlText, theFlat, theDate))
{ } 
```

最后，可以直接在 MS Access UI 中成功执行查询。

这里有什么问题？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-03-16T12:48:50.897

我不确定，但我认为 OleDb 类不支持命名参数。请尝试以下 SQL：

```
SELECT * FROM Flats WHERE Flats.VersionStamp <= ? AND Flats.Flat=? 
```

参数必须以正确的顺序添加到命令对象（我没有看到您在代码中添加参数）。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-03-16T12:47:15.767

您在哪里定义/使用 SQL 字符串中的参数；我没有看到他们。

试试这个：

```
SELECT * From Flats WHERE VersionStamp = @theDate AND Flat = @theFlat

DbParameter = new OleDbParameter ("@theDate", someDate); 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-03-16T16:03:49.133

[http://support.microsoft.com/default.aspx?scid=kb;en-us;316744](http://support.microsoft.com/default.aspx?scid=kb;en-us;316744)

> 与前面的文档错误所描述的相反，OleDbCommand 参数在与 Microsoft SQL Server OLE DB 提供程序一起使用时是位置参数。参数的名称可以是任意的... 添加到 OleDbParameterCollection 的参数的顺序必须与存储过程中的参数顺序相匹配。

# c++ - 均衡对象时复制数组

> ID：650283
> 
> 赞同：1
> 
> 时间：2009-03-16T12:45:43.710
> 
> 标签：c++, arrays, pointers, object, operators

大家好。我需要一些经验来了解如何使用对象处理动态数组。

我有一个类'SA'，由几个对象'Obj1'，'Obj2'等组成......

在类中，我有一个动态数组“SA_Array”，我以以下方式对其进行初始化，其中大小设置其长度：

```
double * SA_Array;
SA_Array = new double [size]; 
```

现在我一直在尝试对上述对象使用“=”运算符来复制每个对象中的数组。不幸的是，我意识到它只会使指针相等，因此如果我在一个对象中修改数组，所有对象 SA_Array 的修改都是相同的......基本上只剩下数组上的一个副本。

例如 Obj1.SA_Array == Obj2.SA_Array...

关于如何克服这个问题并实现 SA_Array 的对象特定副本，有什么好的建议吗？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2009-03-16T12:50:23.153

如果大小是在运行时确定的，最容易使用的一个是向量

```
vector<double> SA_Array(size); 
```

现在您可以复制、交换、调整它的大小，它会相应地采取行动。如果您需要一个指向开头的指针，您可以使用`&SA_Array[0]`. 如果大小在编译时确定并固定，则可以使用 boost::array

```
boost::array<double, size> SA_Array; 
```

您可以像使用数组一样使用它，但也可以复制它并执行类似`SA_Array.begin()`向量的操作。如果您需要一个指向开头的指针，您可以使用`SA_Array.data()`or来完成`&SA_Array[0]`。

也有像你一样使用原始指针的方法，并手动复制它

```
double *SA_Array;
SA_Array = new double[size];

double *SA_Copy;
SA_Copy = new double[size];
std::copy(SA_Array, SA_Array + size, SA_Copy); 
```

但这很麻烦，因为您需要记住`delete[]`它们，向量将为您完成所有工作。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-03-16T12:51:10.157

`std::vector<double>`要么使用标准库集合，如

# windows - 如何阻止脚本运行？

> ID：650286
> 
> 赞同：0
> 
> 时间：2009-03-16T12:46:01.540
> 
> 标签：windows, batch-file, scripting

我有以下脚本，

```
more +1 "C:\Documents and Settings\Administrator\Desktop\Backup Data\import file\1.txt" > "C:\Documents and Settings\Administrator\Desktop\Backup Data\import file\2.txt"
"C:\Program Files\Microsoft Office\Office11\MSACCESS.EXE" "C:\Power Play\Daily\Daily.mdb" /x "Macro1"
DEL  "C:\Documents and Settings\Administrator\Desktop\Backup Data\import file\*.*" /q 
```

我正在做的第一行是因为我的文本文件顶部有一个空行，然后是标题，然后是数据。

我的问题如下，有时文本文件只包含空行和标题。所以在截断之后，我只得到了标题。当我将数据导入访问时，这给我带来了问题。

如果文件为空，谁能提供我可以停止导入访问的方式

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-03-16T17:01:06.607

You can add the following to your script to exit if the file contains just an empty line and the header:

```
@echo off
setlocal enableextensions enabledelayedexpansion

set INPUT="C:\Documents and Settings\Administrator\Desktop\Backup Data\import file\1.txt"
set OUPUT="C:\Documents and Settings\Administrator\Desktop\Backup Data\import file\2.txt"

:: Get the number of lines in the file.
:: Skip the first line since it is blank.
set LINES=0
for /f "skip=1 delims=" %%I in (%INPUT%) do (
    set /a LINES=LINES+1
    if !LINES! EQU 2 goto :PROCESS
)
@echo %INPUT% is empty.
endlocal
exit /b 1

:PROCESS
:: Process the file
more +1  %INPUT% > %OUTPUT%
"C:\Program Files\Microsoft Office\Office11\MSACCESS.EXE" ^
"C:\Power Play\Daily\Daily.mdb" /x "Macro1"
DEL "C:\Documents and Settings\Administrator\Desktop\Backup Data\import file\*.*" /q

endlocal
exit /b 0 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-03-16T15:14:13.683

我找到了一种检查文件大小的方法：

```
for %R in ("C:\...\import file\1.txt") do if %~zR lss 80 exit 1 
```

这会检查文件大小（如果它小于 80 字节）。我不知道如何检查 Windows 批处理文件中的行数。

我建议停止使用这个残缺的发明（批处理文件）并改用理智的外壳。

# excel-formula - 当一系列数字变为负数时确定单元格 ID 的 Excel 公式

> ID：650306
> 
> 赞同：5
> 
> 时间：2009-03-16T12:52:02.743
> 
> 标签：excel-formula, excel, vba

样本数据

```
 A            B
1  Date        Amount
2  Apr 1        $6,000
3  May 1        $4,250
4  June 1       $2,750
5  July 1       $1,000
6  Aug 1       -$0.075   <- This Cell/Row
7  Sept 1     -$0.2500 
```

在一列数字（实际上是 100-200 行）中，当值变为负数时，例如，如果这些是我们欠贷款的金额，那么贷款将在何时还清。请注意，数字之间的实际差异会根据利息、税收、一次性付款等而波动。所以我不能只计算（总额/付款）= 月数。

有没有办法使用 Excel 的公式来确定这一点？这可能是需要 VBA 的情况（这很好），但如果我能避免它，我愿意。

* * *

## 回答 #1

> 赞同：9
> 
> 时间：2009-03-16T13:06:58.980

match 函数返回一个范围索引

```
=MATCH(matchValue, range, matchType: 0=exact, 1=greater than, -1=less than

=MATCH(0, B2:B7, -1) 
```

匹配区域 B2:B7 中小于 0 的第一个单元格。从您的示例数据中，这将返回 5

使用 Offset 函数根据索引值返回特定单元格

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2009-03-17T01:12:15.397

使用**MATCH**公式确定行号。

```
=MATCH(lookup value, lookup range, lookup type)
=MATCH(0,B1:B7,-1) 
```

您将需要使用匹配类型 -1，因为您的数据是按降序排列的。此设置将返回大于或等于查找值 0 的最小值。

根据您的数据，这将返回行号**5**。您期望看到行号**6**，因此需要将公式扩展如下。

```
=MATCH(0,B1:B7,-1)+1 
```

要确定单元格 ID，您需要将此公式包装到**ADDRESS**公式中。

```
=ADDRESS(Row number, Column number)
=ADDRESS(MATCH(0,B1:B7,-1)+1,2) 
```

这将返回值**$B$6**

返回相关的日期或值可能会更有用。这可以通过**OFFSET**公式来完成。

```
=OFFSET(A1,MATCH(0,B1:B7,-1),0)
=OFFSET(A1,MATCH(0,B1:B7,-1),1) 
```

第一个公式将返回 A6 中的日期，**8 月 1 日**

第二个公式将返回 B6 中的值**-$0.075**

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2009-03-16T13:09:38.567

我不确定你想要做什么。

如果你想避免负数，你可以这样做：

```
=IF(YOUR_CELL_ACTUAL_FORMULA < 0 , 0, YOUR_CELL_ACTUAL_FORMULA) 
```

如果您想知道数字何时变为负数，您可以执行以下操作：

```
=MATCH(0, YOUR_AMOUNT_RANGE, -1) 
```

当金额为负数时，这将为您提供第一行号。

# c++ - 如何抑制“延迟写入失败”消息？

> ID：650309
> 
> 赞同：0
> 
> 时间：2009-03-16T12:52:50.683
> 
> 标签：c++, mfc, windows-services

我有一个 Windows 服务在指定的用户帐户中运行，该用户帐户对另一台计算机上的共享驱动器具有写入权限。该服务正在登录该共享驱动器。

我允许用户输入映射路径或网络路径（例如 z:\MyRemoteFolder 或 \RemoteComputer\MyRemoteFolder）作为日志目的地。

由于我处于不稳定的网络环境中，有时我会看到错误“Windows - 延迟写入失败”。

我知道您可以在每个驱动器（包括映射驱动器）的基础上禁用缓存，但是有没有办法为任何直接访问网络（\RemoteComputer\MyRemoteFolder）禁用缓存？

非常感谢，

网卡

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2009-03-25T18:29:13.700

在创建文件中使用“FILE_FLAG_WRITE_THROUGH”和“FILE_FLAG_NO_BUFFERING”对我有用。

# lingo - 在提示点方面需要帮助（Adobe Director 项目）！

> ID：650314
> 
> 赞同：0
> 
> 时间：2009-03-16T12:54:13.410
> 
> 标签：lingo

我有一个小问题，Adobe Director 中有另一个开发人员完成的 cd 项目。它有三种语言。这个项目有带字幕的视频文件......借助提示点附加到视频的字幕......如果用户选择另一种语言，字幕也会改变......图书馆有带文本的图像（即字幕），这些图像有像提示点这样的名称加上最后有一种语言代码。例如 firstSentRu 或 firstSentEn，对应的提示点名称为 firstSen。所以我希望逻辑清楚......这些提示点的问题是当用户在语言之间导航时，最后一个字幕出现在以前的语言中，一旦视频到达下一个提示点，字幕就会变为当前语言. 我明白为什么会这样，但是因为我在这方面有点新，所以我不知道如何解决这个小问题。对此的替代方法可能是在用户更改语言时从头开始播放视频......我再次不知道如何......

我希望你能建议我一个出路，提前谢谢:)！

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2011-05-08T10:55:30.713

听起来您需要从库中的提示点创建一个适当的数据结构 - 尽管我想您继承的代码已经这样做了。显而易见的选择是列表。一旦你有了这个，你应该能够使用 findPosNear() 来获取上一个 cuepoint。不过，这将需要使用排序列表。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-11-10T18:06:14.157

您可以找到完成语言更改的位置并发送事件以将字幕更新到控制它的对象。该系统可能依赖于全局标志来识别语言（不好！）

# javascript - javascript下拉菜单

> ID：650316
> 
> 赞同：0
> 
> 时间：2009-03-16T12:55:40.597
> 
> 标签：javascript, jquery

我不确定我在这里缺少什么。这是我放置的代码：

```
 <script type="text/javascript">
    $(function(){
        $(".category_list").hide(); return false;
        $("#sol-surface").click( function() {
            $(this).next().toggle();
            return false;
        });
        $("#nat-stone").click( function() {
            $(this).next().toggle();
            return false;
        });
        $("#man-surface").click( function() {
            $(this).next().toggle();
            return false;
        });
    });

</script> 
```

虽然它隐藏了子菜单，但当我单击该项目时它也没有出现 - 这是我查看页面源时出现的内容：

```
 <div class="cat_nav">
    <ul>
        <li><a href="#" id="sol-surface">Solid Surface</a></li>

        <li><a href="#" id="nat-stone">Natural Stone</a></li>
        <li><a href="#" id="man-surface">Manufactured Surface</a></li>
    </ul>
    <div id="sub-nav">
    <ul class="category_list">
    <li><a href="http://www.metrostoneworks.com/products/?c=corian">Corian</a></li>
</ul>
    <ul class="category_list">

    <li><a href="http://www.metrostoneworks.com/products/?c=granite">Granite</a></li>
    <li><a href="http://www.metrostoneworks.com/products/?c=silestone">Silestone</a></li>
</ul>
    <ul class="category_list">
    <li><a href="http://www.metrostoneworks.com/products/?c=zodiaq">Zodiaq</a></li>
</ul>
    </div> <!-- EO #sub-nav -->
</div> <!-- EO .cat_nav --> 
```

而且我不确定为什么我无法进入子菜单...谢谢

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2009-03-16T13:03:27.770

为什么隐藏后立即返回false？

```
$(".category_list").hide(); return false; 
```

该返回退出您所在的函数并且不绑定其余元素。

此外，您的 HTML 不是您的代码工作所应具备的。它应该如下所示：

```
<div class="cat_nav">
    <ul>
    <li><a href="#" id="sol-surface">Solid Surface</a>
        <ul class="category_list">
        <li><a href="http://www.metrostoneworks.com/products/?c=corian">Corian</a></li>
        </ul>
    </li>
    <li><a href="#" id="nat-stone">Natural Stone</a>
        <ul class="category_list">
        <li><a href="http://www.metrostoneworks.com/products/?c=granite">Granite</a></li>
        <li><a href="http://www.metrostoneworks.com/products/?c=silestone">Silestone</a></li>
        </ul>   
    </li>
    <li><a href="#" id="man-surface">Manufactured Surface</a>
        <ul class="category_list">
        <li><a href="http://www.metrostoneworks.com/products/?c=zodiaq">Zodiaq</a></li>
        </ul>   
    </li>
    </ul>
</div> 
```

一旦你的 HTML 看起来像这样，你可以替换它：

```
 $("#sol-surface").click( function() {
            $(this).next().toggle();
            return false;
    });
    $("#nat-stone").click( function() {
            $(this).next().toggle();
            return false;
    });
    $("#man-surface").click( function() {
            $(this).next().toggle();
            return false;
    }); 
```

有了这个：

```
 $("div.cat_nav > ul li a").click( function() {
            $(this).next().toggle();
            return false;
    }); 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-03-16T13:05:08.657

因为`$(this).next()`在所有三种情况下都返回 undefined。您的链接没有兄弟姐妹。

# c - 长整数作为 C 中的数组索引会导致分段错误

> ID：650320
> 
> 赞同：4
> 
> 时间：2009-03-16T12:58:54.880
> 
> 标签：c, pointers, segmentation-fault

以下 C 代码给出了分段错误：

```
#include <stdio.h>
#include <stdint.h>

int main(){
        uint32_t *a;
        uint32_t idx=1233245613;
        a[idx]=1233;
        return 0;
} 
```

如何在 C 中使用 uint32_t 作为数组的索引？或者如何使用可以获取 uint32_t 和 12 位数字作为索引的数组结构？

我会很感激任何帮助。

* * *

## 回答 #1

> 赞同：9
> 
> 时间：2009-03-16T13:00:36.093

*   变量“a”只是一个指针变量。
*   指针变量保存内存位置的地址。
*   您需要将 a 指向已分配所需空间的内存位置。

您还试图在数组中索引很远。您可能没有足够的可用内存，因此请务必检查 NULL。

```
#include <stdio.h>
#include <stdint.h>
#include <stdlib.h>

int main(void){

        uint32_t *a;
        uint32_t idx=1233245613;

        //This allows you to index from 0 to 1233245613
        // don't try to index past that number
        a = malloc((idx+1) * sizeof *a);
        if(a == NULL)
        {
           printf("not enough memory");
           return 1;
        }

        a[idx]=1233;
        free(a);
        return 0;
} 
```

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2009-03-16T13:06:28.480

如果您想使用“12 位数字”作为索引，则意味着您需要超过 10 亿个项目。每个项目都是一个 uint32_t，这意味着每个项目占用四个字节的内存。因此，您看到此阵列的内存总量约为 4 GB。出于性能和其他原因，数组通常不会那么大。

如果您真的需要这十亿个项目中的每一个，请查看适合实现这种巨型阵列的磁盘支持算法，也许是[红黑树。](http://en.wikipedia.org/wiki/Red-black_tree)

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2009-03-16T13:01:26.153

那么对于初学者来说，你需要为 a 分配空间。

当该代码运行时， a 指向您可能不拥有的内存中的一些空间。
当您尝试访问它时（实际上是当您尝试访问 + 1233245613 时），您将进入您绝对不拥有的内存空间，这是一个禁忌，会导致崩溃。

```
#include <stdio.h>
#include <stdint.h>

int main(){
        uint32_t *a;
        uint32_t idx=1233245613;
        a = malloc(sizeof(unit32_t) * (idx+1));//+1 cause remember, arrays are 0-based
        if(a == NULL) 
        {
           printf("Array could not be allocated"); 
           return 1;
        }
        a[idx]=1233;
        free(a);//good practice to avoid memory leaks
        return 0;
} 
```

但即使这样也不能解决您使用 GIANT 数组的问题。您的标准设置（台式机甚至大多数服务器）在尝试分配 4.6GB 内存时会卡住。因此，除非您考虑到这一点，否则您可能需要退后一步，重新考虑您要做什么以及如何做。

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2009-03-16T13:16:09.160

你需要两件事：

*   为数组分配内存`a`，例如 uint32_t a[2000000000];
*   在可以寻址超过 4Gb 内存的 64 位架构上编译。

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2009-03-16T13:41:58.460

哇。那是一团糟。

好的。这里有两个问题。第一个问题是您声明了一个指向整数的指针，从未将它指向任何东西，然后尝试使用它。这只是一个错误。最有可能的是，指针恰好指向一个甚至不是您的进程的有效内存的地方（或指向 NULL）。在这种情况下，任何使用它的尝试都会给你一个段错误，就像你得到的一样。

第二个问题是您试图索引它的值。即使您*为*指针分配了内存，我也严重怀疑您是否可以为它分配 4.8 GB。大多数计算机没有那么多内存，而且在一个连续的块中肯定没有那么多。如果您尝试对分配给数组的内存进行索引，那么任何事情都可能发生，但是如果您*过去*，很可能会出现段错误。

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2009-03-16T13:02:58.210

a 是一个指针，它指向任何确定的内容。你想要一个数组

```
uint32_t a[42]; 
```

它创建了一个由 42 个整数组成的数组。但是，您对它的访问仍然会导致问题（确切地说是未定义的行为），因为它超出了此数组或任何其他合理数组的范围。

# javascript - 模态图像弹出窗口

> ID：650322
> 
> 赞同：4
> 
> 时间：2009-03-16T12:59:20.637
> 
> 标签：javascript, image, modal-dialog

我见过一些有缩略图的网站，当您单击它时，它会以弹出窗口等模式放大图像。谁能告诉我这是怎么做到的？

谢谢！

* * *

## 回答 #1

> 赞同：10
> 
> 时间：2009-03-16T13:00:51.647

它是用[灯箱](http://www.lokeshdhakar.com/projects/lightbox2/)完成的。还有其他几个脚本可以做到这一点，例如[jquery plugin](http://leandrovieira.com/projects/jquery/lightbox/)。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-03-16T13:09:44.183

[Jquery](http://jquery.com/)是一种实现模式弹出窗口的简单方法。它通常使用许多插件之一来完成。

*   [皮罗盒](http://www.pirolab.it/pirobox/)
*   [花式盒](http://fancy.klade.lv/)
*   [漂亮的照片](http://www.no-margin-for-errors.com/projects/prettyPhoto-jquery-lightbox-clone/)
*   [尼罗莫代尔](http://nyromodal.nyrodev.com/)
*   [厚箱](http://jquery.com/demo/thickbox/)

名单还在继续。[你可以在这里](http://www.blogrammierer.de/jquery-die-23-besten-bildergalerie-plugins/)查看前 23 名

* * *

## 回答 #3

> 赞同：-1
> 
> 时间：2009-03-16T13:04:04.370

您还应该能够在.net 中使用 ajax 来实现。这是一个对话框示例，您可以根据自己的使用情况进行修改。[http://www.asp.net/ajax/ajaxcontroltoolkit/samples/modalpopup/modalpopup.aspx](http://www.asp.net/ajax/ajaxcontroltoolkit/samples/modalpopup/modalpopup.aspx)

# visual-studio - Visual Studio 字体和颜色设置

> ID：650327
> 
> 赞同：4
> 
> 时间：2009-03-16T13:01:02.130
> 
> 标签：visual-studio

# 复制：

> [你用什么配色方案来编程？](https://stackoverflow.com/questions/9951/what-color-scheme-do-you-use-for-programming)
> 
> [Visual Studio 颜色主题](https://stackoverflow.com/questions/15841/visual-studio-color-theme)
> 
> [视觉效果更好的视觉工作室颜色设置](https://stackoverflow.com/questions/99792/visual-studio-color-settings-for-better-eye)

我正在使用 Visual Studio IDE。我尝试使用一些不同的视觉设置，但没有人满意。有人可以推荐一些健康眼睛的好设置吗？

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2009-03-16T13:04:19.627

不久前，我将 VIM 墨罐配色方案的一个版本移植到 .vssettings 文件中。这是一种很好的深色风格，对我来说很容易。

[![墨水瓶](https://i.stack.imgur.com/ZuOgi.png)](https://i.stack.imgur.com/ZuOgi.png)
[（来源：[msdn.com](http://blogs.msdn.com/blogfiles/jaredpar/WindowsLiveWriter/InkpotColorScheme_12121/Inkpot_2.png)）]

该方案的 .vssettings 文件可在此处获得：http: [//blogs.msdn.com/jaredpar/archive/2008/06/02/inkpot-color-scheme.aspx](http://blogs.msdn.com/jaredpar/archive/2008/06/02/inkpot-color-scheme.aspx)

# sql-server - 当 UPDATE 的结果不明确时，为什么 SQL Server 不会失败？

> ID：650328
> 
> 赞同：4
> 
> 时间：2009-03-16T13:01:11.037
> 
> 标签：sql-server, sql-server-2005, sql-server-2008

我有两个表，一个更新的目的地：

```
create table dest (value int)
insert into dest values (0) 
```

和一个来源：

```
create table source (value int)
insert into source values (4)
insert into source values (1) 
```

如果我运行此查询：

```
UPDATE dest SET value = (select value from source WHERE 1=1) 
```

SQL Server 失败并显示：

```
Subquery returned more than 1 value. This is not permitted when 
the subquery follows =, !=, <, <= , >, >= ... 
```

这是完美的。但是如果我运行这个查询：

```
UPDATE dest SET value = source.value FROM dest INNER JOIN Source ON 1=1 
```

...它从源中随机选择一个值并用它更新 dest。

可怕的？对此有解释吗？

* * *

## 回答 #1

> 赞同：11
> 
> 时间：2009-03-16T13:06:58.853

是的，您的第一个查询失败的原因与更新语句无关，请运行此查询：

```
select * from dest
where value = (select value from source) 
```

当您有一个使用任何运算符（例如 =、!= 等）的子查询时，您不能返回一个以上的结果。如果您想说给我 dest 中匹配值在源中的所有值，那么您将使用 In 子句：

```
select * from dest
where value in (select value from source) 
```

至于你问题的第二部分，一个单元格只能有一个值，所以你所做的就是一遍又一遍地替换它。这是完全有效的。

正如您所指出的，无法确定将选择哪一行，这确实很有趣，特别是考虑到如果内存服务于不同版本的 SQL 选择不同的行（旧版本我认为使用最后一行，而现在他们使用第一行排）。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2009-03-16T13:21:14.467

`Oracle`确实禁止这样的查询：

```
UPDATE dest SET value = source.value FROM dest INNER JOIN Source ON 1=1 
```

，如果`source`表不是`key-preserved`表（即，您加入某个未明确声明的`dest`字段（由 a或 a ）。`source``UNIQUE``UNIQUE INDEX``PRIMARY KEY`

这是一种确保`dest`在视图中最多选择一行的方法。

如果没有`UNIQUE`任何类型的约束，更新无论如何都会失败，即使`source`.

`SQL Server`没有这个限制，只会更新遇到的第一个值，跳过其他值。

哪个值首先取决于几个条件，包括优化器选择的连接方法。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-03-16T13:14:43.517

在第一个示例中，子查询返回多行并且更新失败。在第二个示例中，连接成功，因此可以继续更新。结果是不可预测的，因为连接不受约束。

# javascript - Simplest JQuery validation rules example

> ID：650336
> 
> 赞同：16
> 
> 时间：2009-03-16T13:03:45.883
> 
> 标签：javascript, jquery, validation, declarative

The following HTML form successfully utilizes jQuery's form validation, displaying "This field is required" to the right of the form field if left blank, and "Please enter at least 2 characters" if fewer than 2 characters were entered. However, instead of the validation metadata being specified using the class and minlength attributes on the "cname" form input field, I'd like to use jQuery's "rules" API instead, where the rules are specified in the body of the validate function. Thanks in advance:

```
 <!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN" 
                    "http://www.w3.org/TR/html4/loose.dtd">
<html>
<head>
  <script src="/lib/js/jquery.js"></script>
  <script src="/lib/js/jquery.validate.js"></script>
  <script>
  $(document).ready(function(){$("#commentForm").validate(
    /*
     rules/messages here
    */
    );}
    );
  </script>
</head>
<body>

 <form id="commentForm" method="get" action="">
 <fieldset>
   <legend>A simple comment form with submit validation and default messages</legend>
   <p>
     <label for="cname">Name</label>
     <em>*</em><input id="cname" name="name" size="25" class="required" minlength="2" />
   </p>
   <p>
     <input class="submit" type="submit" value="Submit"/>
   </p>
 </fieldset>
 </form>
</body>
</html> 
```

* * *

## 回答 #1

> 赞同：14
> 
> 时间：2009-03-16T13:17:35.817

```
rules: {
    cname: {
        required: true,
        minlength: 2
    }
},
messages: {
    cname: {
        required: "<li>Please enter a name.</li>",
        minlength: "<li>Your name is not long enough.</li>"
    }
} 
```

* * *

## 回答 #2

> 赞同：12
> 
> 时间：2009-03-16T15:00:59.937

The examples contained in [this blog post](http://web.archive.org/web/20120108075037/http://www.raymondcamden.com/index.cfm/2009/2/10/An-Introduction-to-jQuery-and-Form-Validation-2) do the trick.

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2009-03-16T13:22:15.073

```
$("#commentForm").validate({
    rules: {
     cname : { required : true, minlength: 2 }
    }
}); 
```

Should be something like that, I've just typed this up in the editor here so might be a syntax error or two, but you should be able to follow the pattern and the [documentation](http://docs.jquery.com/Plugins/Validation "documentation")

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2011-09-01T01:20:39.773

The input in the markup is missing `"type"`, the input (text I assume) has the attribute `name="name"` and `ID="cname"`, the provided code by Ayo calls the input named "cname"* where it should be *"name"*.

# python - Python 列表是否与 dict.get 等效？

> ID：650340
> 
> 赞同：16
> 
> 时间：2009-03-16T13:04:46.333
> 
> 标签：python, list

我有一个整数列表。我想知道数字 13 是否出现在其中，如果出现，在哪里。我是否必须像下面的代码那样搜索列表两次？

```
if 13 in intList:
   i = intList.index(13) 
```

在字典的情况下，有一个`get`功能可以确定成员资格并使用相同的搜索执行查找。列表有类似的东西吗？

* * *

## 回答 #1

> 赞同：14
> 
> 时间：2009-03-16T13:07:46.560

你自己回答了，用`index()`方法。如果找不到索引，这将引发异常，所以只需抓住它：

```
def getIndexOrMinusOne(a, x):
  try:
    return a.index(x)
  except ValueError:
    return -1 
```

* * *

## 回答 #2

> 赞同：8
> 
> 时间：2009-03-16T13:10:07.070

看起来你只需要捕捉异常......

```
try:
    i = intList.index(13)
except ValueError:
    i = some_default_value 
```

* * *

## 回答 #3

> 赞同：4
> 
> 时间：2009-03-16T13:12:22.447

不，没有直接匹配您要求的内容。不久前 Python 邮件列表上对此进行**[了讨论](http://mail.python.org/pipermail/python-dev/2006-July/067263.html)**，人们得出的结论是，如果您需要它，这可能是代码异味。如果您需要以这种方式测试成员资格，请考虑使用*dict*或*set代替。*

* * *

## 回答 #4

> 赞同：2
> 
> 时间：2009-03-16T13:13:41.817

您可以捕获 ValueError 异常，也可以执行以下操作：

```
i = intList.index(13) if 13 in intList else -1 
```

(Python 2.5+)

顺便提一句。如果你打算做一大批类似的操作，你可以考虑构建逆字典值 -> 索引。

```
intList = [13,1,2,3,13,5,13]
indexDict = defaultdict(list)
for value, index in zip(intList, range(len(intList))):
   indexDict[value].append(index)

indexDict[13]
[0, 4, 6] 
```

* * *

## 回答 #5

> 赞同：-1
> 
> 时间：2009-03-16T13:11:07.020

只需将你得到的东西放在一个函数中并使用它:)

您可以使用`if i in list: return list.index(i)`或`try/except`，具体取决于您的偏好。

# c# - 继承和转换对象

> ID：650343
> 
> 赞同：1
> 
> 时间：2009-03-16T13:06:05.207
> 
> 标签：c#, oop

我有`SalesMan`从类继承`User`并实现`ISalesMan`接口的类。

```
public class SalesMan : User, ISalesMan
{
 ...
} 
```

我需要将`User`对象转换为`SalesMan`对象。我知道从`User`对象类型直接转换为`SalesMan`类型是不可能的。我应该如何进行转换？我在想两种不同的方式：

1.  为接受参数的`SalesMan`类创建构造函数，并根据给定的.`User``SalesMan``User`

2.  `SalesMan`为作为参数的类创建新方法，并根据给定参数`User`返回一个新对象。`SalesMan``User`

...或者有没有更聪明的方法来解决这类问题？

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2009-03-16T13:10:40.127

选项 1 中描述的构造函数是我在探索不熟悉的 API 时期望找到的。

虽然它们可能是无聊的野兽，但您可能会在向 User 类添加新字段时忘记更新它们。[因此（如果性能考虑允许），请考虑按照本示例的思路](http://www.johnsadventures.com/archives/2006/07/an_intelligent_copy_constructor_in_c_usi/)使用反射编写“智能”构造函数。

关于构造函数与工厂方法的问题，[框架设计指南](http://www.amazon.co.uk/Framework-Design-Guidelines-Conventions-Development/dp/0321545613)提供了以下建议：

> *   DO 更喜欢构造函数而不是工厂，因为它们通常比专门的构造机制更有用、更一致、更方便。
>     
>     
> *   如果您需要比构造函数在创建实例时提供的更多控制，请考虑使用工厂。
>     
>     
> *   务必使用开发人员可能不知道要
>     构造哪种类型的工厂，例如在
>     针对基本类型或接口进行编码时。
>     
>     
> *   如果具有命名方法是使操作不言自明的唯一方法，请考虑使用工厂。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-03-16T13:09:36.103

选项 1 是最整洁和最直观的。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-03-16T13:25:47.407

如果您真的想从 User 对象创建 SalesMan 对象，那么您描述的任何一个选项都可以使用。

但我认为你需要问问自己你想要做什么。用户何时/为什么成为销售员？您是否试图改变现有对象的行为？您的系统中的行为是否定期发生变化？

根据您的需要，您可能会考虑使用策略或模板方法模式。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2009-03-16T13:26:26.453

我使用选项 1\. 升级构造函数或转换构造函数。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2009-03-16T15:24:37.447

您已经收到的答案绰绰有余。但是，我注意到您提到无法进行投射。如果您有某种理由使用强制转换，您可以*通过*重载运算符来实现。

```
public static explicit operator SalesMan(User user)
{
    // Your logic to create a new SalesMan using data from user.
} 
```

确定哪种解决方案*更智能*需要比原始帖子中提供的更多信息。但是，我倾向于在完整性和多功能性方面进行宣传，并且会考虑两者兼而有之。

```
public class SalesMan
{
    public SalesMan(User user)
    {
        // Your logic to create a new SalesMan using data from user.
    }

    public static explicit operator SalesMan(User user)
    {
        return new SalesMan(user);
    }
} 
```

伊恩是对的。一般的经验法则是，仅当您有构造函数无法满足的功能要求，或者语言的约束开始妨碍您时，才使用工厂。例如，需要两个具有相同签名的不同构造函数。

# erlang - mnesia delete_object 异常？

> ID：650348
> 
> 赞同：2
> 
> 时间：2009-03-16T13:07:25.670
> 
> 标签：erlang, mnesia

我看不出这里有什么问题，但我可能只是误解了语法。我正在尝试从我的“用户”mnesia 表中删除一个名字为“ryan”的“用户”记录（它们有多个）。这是我所做的：

```
Delete=#user{first_name = "ryan", _ = '_'},
mnesia:dirty_delete_object(Delete) 
```

这是我的记录定义：

```
-record(user, {id,
               username,
               password,
               email,
               first_name,
               last_name,
               last_login, % Date/time user last logged in
               reg_date}). % Date/time user registered the account 
```

这是我得到的例外：

```
** exception exit: {aborted,
                       {bad_type,user,
                           {user,'_','_','_','_',"ryan",'_','_','_'}}}
     in function  mnesia:abort/1
     in call from users:register/1 
```

这似乎是一个完美的匹配。什么可能导致这个问题？

* * *

## 回答 #1

> 赞同：12
> 
> 时间：2009-03-16T14:14:53.153

`mnesia:delete_object/1`并`/3`用于从表中删除**给定**的记录。它不会根据*匹配规范*删除多条记录。它只是一个更精确的版本`mnesia:delete/*`- 它为您提供了一种从**包**表中删除**特定**记录的方法。

 **要删除与规范匹配的多个记录（例如 with `name="ryan"`），请使用以下代码：

```
Delete=#user{first_name = "ryan", _ = '_'},
List = mnesia:dirty_match_object(Delete)
lists:foreach(fun(X) ->
                      mnesia:dirty_delete_object(X)
              end, List). 
```

或者它的交易版本：

```
Delete=#user{first_name = "ryan", _ = '_'},
Fun = fun() ->
              List = mnesia:match_object(Delete)
              lists:foreach(fun(X) ->
                                    mnesia:delete_object(X)
                            end, List)
      end,
mnesia:transaction(Fun). 
```

# mysql - 复杂的数据库备份

> ID：650352
> 
> 赞同：0
> 
> 时间：2009-03-16T13:08:31.970
> 
> 标签：mysql, backup, mysqldump

我需要从数据库的某些表中备份某些行。通常标准需要连接等。有什么好方法可以做到这一点？（我不必使用 mysqldump）。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-03-16T13:25:31.993

我想说只是备份整个数据库。这将是一个更简单的过程，并且您将更轻松地维护身份完整性，以防您需要恢复备份。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-03-16T13:24:43.163

如果您只对备份数据感兴趣，并且不需要将其输出为 SQL，则可以将您的 select SQL 语句放入文件中并使用 mysql 命令执行这些语句，重定向到如下文件：

```
mysql my_database < queries.sql > backup.txt 
```

就分隔符等而言，还有一些其他选项。查看 mysql 手册页。

# asp.net - 在 ASP.Net 中，我有时会收到以下错误 - Viewstate 验证失败。原因：视图状态提供的完整性检查失败

> ID：650353
> 
> 赞同：6
> 
> 时间：2009-03-16T13:09:16.557
> 
> 标签：asp.net, visual-studio, iis, iis-7, viewstate

背景：我用 C# 在 ASP.Net 3.5 中开发了一个 Web 应用程序。它运行良好，但现在一些用户报告说他们有时会收到错误。我试图复制错误，但很难。有一次，当我让应用程序坐下时，我稍后回来并试图移动它，但它出错了。我认为这与超时有关，但我正在使用视图状态。

有任何想法吗？当我查看 eventLog 时，我确实看到了以下错误条目。

感谢您的帮助和想法！

约翰

* * *

我的事件日志有以下错误：

事件代码：4005

事件消息：请求的表单身份验证失败。原因：提供的票已过期。

活动时间：14/03/2008 13:19:26

活动时间（UTC）：14/03/2008 13:19:26

事件 ID：d9f0333c2eed46e0b0207da69d2ea70e

事件序列：154

事件发生：5

活动详情代码：50202

* * *

事件代码：3005

事件消息：发生未处理的异常。

活动时间：3/12/2009 7:49:59 AM

活动时间 (UTC)：2009 年 3 月 12 日上午 11:49:59

事件 ID：590ac0f6ad734d988e9e02f0fb7800eb

事件序列：52

事件发生：1

事件详细代码：0

应用信息：

```
Application domain: /LM/W3SVC/32/ROOT-1-128813294498061103 

Trust level: Full 

Application Virtual Path: / 

Application Path: C:\Home\LocalUser\ucpga\Web\ 

Machine name: 169349-WEB2 
```

处理信息：

```
Process ID: 6912 

Process name: w3wp.exe 

Account name: NT AUTHORITY\NETWORK SERVICE 
```

* * *

这是最新的错误：

事件代码：4009 事件消息：Viewstate 验证失败。原因：视图状态提供的完整性检查失败。事件时间：2009 年 3 月 15 日晚上 10:26:27 事件时间 (UTC)：2009 年 3 月 16 日上午 2:26:27 事件 ID：3b5be134005e49c3b40400bcaa5cb48d 事件序列：56 事件发生：1 事件详细代码：50203

应用信息：应用域：/LM/W3SVC/32/ROOT-1-128816433841748972 信任级别：完整应用虚拟路径：/应用路径：C:\Home\LocalUser\ucpga\Web\机器名：169349-WEB2

进程信息：进程ID：8892 进程名称：w3wp.exe 帐号名称：NT AUTHORITY\NETWORK SERVICE

请求信息：请求URL：[https](https://hr.ucpga.org:443/application.aspx) ://hr.ucpga.org:443/application.aspx 请求路径：/application.aspx 用户主机地址：74.160.64.222 用户：
是否认证：False 认证类型：
线程账号名：169349- WEB2\ucpga

ViewStateException 信息：异常消息：无效的视图状态。客户端 IP：74.160.64.222 端口：1251 用户代理：Mozilla/4.0（兼容；MSIE 7.0；Windows NT 5.1；GTB5；.NET CLR 1.1.4322；InfoPath.1）

* * *

## 回答 #1

> 赞同：10
> 
> 时间：2009-03-16T13:48:25.213

此问题通常是由服务器文件中自动生成`<machineKey />`的密钥引起的。`machine.config`每次您的应用程序重新启动时，它都会生成新的密钥。这会使任何现有的加密视图状态或表单身份验证票证无效。

尝试将`<machineKey />` `validationKey`and设置`decryptionKey`为固定值。有关更多信息，请参阅以下链接：

> [如何：在 ASP.NET 2.0 (MSDN) 中配置 MachineKey](http://msdn.microsoft.com/en-us/library/ms998288.aspx)

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2009-03-16T13:33:03.113

我强烈怀疑这个问题是否与 Viewstate 有关。它与会话状态和身份验证 cookie 有更多关系。

您的应用程序是否在 Web 农场/花园上运行？如果是这样，你应该看看[这篇文章](http://msmvps.com/blogs/omar/archive/2006/08/20/108307.aspx)。

否则，如果您的 FormsAuthenticationTicket 超时小于会话超时，则通常会发生此错误。发生的情况是 Auth 票证比用户的会话更早过期，并且下一个请求无法通过身份验证。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2009-03-16T13:12:47.890

这看起来像一个身份验证问题。您可能在即将到期的身份验证票上设置了超时。如果您使用滑动超时，那么每次您访问服务器时，票证都会被更新。如果你不这样做，你的票就会过期，你需要处理这种情况。

* * *

### 编辑：

您可以查看这篇[支持](http://support.microsoft.com/kb/555353)文章，看看它是否适用于您。

您还可以查看此[视图​​状态查看器](http://alt.pluralsight.com/tools.aspx)，它可能会帮助您确定视图状态是否无效。

[这是 Microsoft 升级工程师](http://blogs.msdn.com/tess/archive/2007/06/11/a-case-of-invalid-viewstate.aspx)的另一篇好帖子

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2011-06-14T20:22:20.947

我也有这个错误....

如果您查看错误，则可能是您的加密 URL 查询字符串。发生的情况是 webresource.axd 生成的 URL 字符串具有使用 machinekey 设置加密的身份。这些过期，如果您有一个页面，然后尝试使用加密字符串提交，则触发事件 ID 1316 或 4009。您可能会在 Application_Error 事件中捕获此异常并检查 CryptographicException 是否被触发。

# wcf - HttpRequest.ServerVariables 在带有 IIS7 的 WCF 中引发 ArgumentException

> ID：650357
> 
> 赞同：5
> 
> 时间：2009-03-16T13:09:59.177
> 
> 标签：wcf

我们有一个在 IIS7 中运行的 WCF (.NET 3.5 SP1) 服务，它被标记为允许 ASP.NET 兼容模式，因此我们可以访问`HttpContext.Current`：

```
[AspNetCompatibilityRequirements(
    RequirementsMode = AspNetCompatibilityRequirementsMode.Allowed)] 
```

但是，当尝试访问任何服务器变量时，它会抛出`ArgumentException`：

```
System.ArgumentException: Value does not fall within the expected range. 
    at System.Runtime.InteropServices.Marshal.ThrowExceptionForHRInternal(Int32 errorCode, IntPtr errorInfo) 
    at System.Web.Hosting.IIS7WorkerRequest.GetServerVariableInternal(String name) 
    at System.Web.Hosting.IIS7WorkerRequest.GetServerVariable(String name) 
    at System.Web.Hosting.IIS7WorkerRequest.GetRemoteAddress() 
    at System.Web.HttpRequest.get_UserHostAddress() 
```

例如，以下任何一行都会引发此异常：

```
ha = HttpContext.Current.Request.UserHostAddress;
ip = HttpContext.Current.Request.ServerVariables["HTTP_X_FORWARDED_FOR"];
us = HttpContext.Current.Request.UserAgent; 
```

这似乎是内部框架调用的结果，这意味着调用代码没有错误。

大概是我们的配置中有什么东西导致了这个问题，但我不知道是什么。有任何想法吗？或者任何想法我可以如何检索这三位数据（不幸的是，它们似乎没有被 WCF 本机公开）。

* * *

## 回答 #1

> 赞同：14
> 
> 时间：2009-03-16T13:35:20.503

原来问题是该操作标有...

```
[OperationContract(IsOneWay = true)] 
```

...并且服务器变量在单向操作中不可用。

可耻的例外并没有说明这一点......

# asp.net - IIS7 url rewrite w/ ASP.Net 3.5 SP1 + asp:Login Form does not work

> ID：650372
> 
> 赞同：2
> 
> 时间：2009-03-16T13:13:16.327
> 
> 标签：asp.net, authentication, .net-3.5, url-rewriting

This question was kind of touched before but not the answer I was looking for.

I am using the IIS7 URL Rewrite module to rewrite my pages, and now my asp.net login form does not work!!!

On my master page I have this (ASP.Net 3.5 SP1 feature)...

```
 if (!String.IsNullOrEmpty(Request.ServerVariables["HTTP_X_ORIGINAL_URL"]))
    {
        form1.Action = Request.ServerVariables["HTTP_X_ORIGINAL_URL"];
    } 
```

Which makes the page post back to the currently rewritten page.

However my login control just post backs without firing ANY events. Therefore it does not log in, the onlogginerror etc events don't fire, nothing!!

I have tried this...

```
 if (!String.IsNullOrEmpty(Request.ServerVariables["HTTP_X_ORIGINAL_URL"]))
    {
        Login Login1 = LoginView1.FindControl("Login1") as Login;
        if (Login1 != null)
            Login1.DestinationPageUrl = Request.ServerVariables["HTTP_X_ORIGINAL_URL"];
    } 
```

ith no avail...

Please also note I am using the CSS Friendly Adapters for my login control, and even tried changing this line here from...

```
PostBackOptions options = new PostBackOptions(btn, "", "", false, false, false, clientSubmit, true, login.UniqueID); 
```

to...

```
PostBackOptions options = new PostBackOptions(btn, "", HttpContext.Current.Request.ServerVariables["HTTP_X_ORIGINAL_URL"], false, false, false, clientSubmit, true, login.UniqueID); 
```

with no avail...

Please help :(

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-03-16T13:37:06.223

Sorry spoke too soon...

As mentioned in another topic, [this web site](http://weblogs.asp.net/scottgu/archive/2007/02/26/tip-trick-url-rewriting-with-asp-net.aspx) has the solution.

Just basically add the `App_Browser` file, and create the form rewriter file.

Form.browser:

```
<browsers>
    <browser refID="Default">
        <controlAdapters>
            <adapter controlType="System.Web.UI.HtmlControls.HtmlForm" adapterType="FormRewriterControlAdapter" />
        </controlAdapters>
    </browser>

</browsers> 
```

FormRewriter.cs:

```
using System.Web;
using System.Web.UI;

public class FormRewriterControlAdapter : System.Web.UI.Adapters.ControlAdapter
{
    protected override void Render(System.Web.UI.HtmlTextWriter writer)
    {
        base.Render(new RewriteFormHtmlTextWriter(writer));
    }
}

public class RewriteFormHtmlTextWriter : HtmlTextWriter
{
    public RewriteFormHtmlTextWriter(HtmlTextWriter writer) : base(writer)
    {
        this.InnerWriter = writer.InnerWriter;
    }

    public RewriteFormHtmlTextWriter(System.IO.TextWriter writer) : base(writer)
    {
        base.InnerWriter = writer;
    }

    public override void WriteAttribute(string name, string value, bool fEncode)
    {

        // If the attribute we are writing is the "action" attribute, and we are not on a sub-control,
        // then replace the value to write with the raw URL of the request - which ensures that we'll
        // preserve the PathInfo value on postback scenarios

        if ((name == "action")) {

            HttpContext Context = default(HttpContext);
            Context = HttpContext.Current;

            if (Context.Items["ActionAlreadyWritten"] == null) {

                // Because we are using the UrlRewriting.net HttpModule, we will use the
                // Request.RawUrl property within ASP.NET to retrieve the origional URL
                // before it was re-written. You'll want to change the line of code below
                // if you use a different URL rewriting implementation.

                value = Context.Request.RawUrl;

                // Indicate that we've already rewritten the <form>'s action attribute to prevent
                // us from rewriting a sub-control under the <form> control

                Context.Items["ActionAlreadyWritten"] = true;
            }
        }

        base.WriteAttribute(name, value, fEncode);
    }
} 
```

# java - JavaScript (Rhino) 使用库或包含其他脚本

> ID：650377
> 
> 赞同：28
> 
> 时间：2009-03-16T13:14:48.663
> 
> 标签：java, javascript, rhino

在JDK6中，有没有办法加载多个脚本，每个脚本都在一个文件中，并让一个脚本引用另一个脚本的方法？有点像“包括”？

* * *

## 回答 #1

> 赞同：30
> 
> 时间：2009-03-16T18:31:55.937

我认为您在使用Rhino 的全局对象/范围的[load() 方法/属性](http://www.mozilla.org/rhino/shell.html)

```
load("file1.js");
load("file2.js");
load("file3.js");

methodFromFileOne();
var bar = methodFromFileTwo();
var etc = dotDotDot(); 
```

这将加载一个 javascript 源文件，类似于 PHP 中的 include/require 方式。加载文件后，您将能够调用和运行或使用加载文件中定义的任何对象。

这就是您使用 Rhino shell 时的工作方式，这是我知道的唯一上下文（您的问题提到了 Java SDK，这超出了我的经验范围）

* * *

## 回答 #2

> 赞同：10
> 
> 时间：2011-08-19T18:28:01.683

如果您碰巧尝试在 ant 中执行此操作，您可能会看到以下错误：

```
<script language="javascript">
    load('foo.js');
</script>
javax.script.ScriptException: sun.org.mozilla.javascript.internal.EcmaError: TypeError: Cannot find function load. 
```

但你可以回避它：

```
<script language="javascript">
    eval(''+new String(org.apache.tools.ant.util.FileUtils.readFully(new java.io.FileReader('foo.js'))));
</script> 
```

* * *

## 回答 #3

> 赞同：10
> 
> 时间：2013-04-29T13:24:46.310

这次是一个真实的例子，即用 Rhino 1.7R4运行[esprima解析器。](http://esprima.org "esprima")

```
import org.mozilla.javascript.Context;
import org.mozilla.javascript.Scriptable;
import org.mozilla.javascript.ScriptableObject;
...

Context context = Context.enter();
Scriptable globalScope = context.initStandardObjects();
Reader esprimaLibReader = new InputStreamReader(getClass().getResourceAsStream("/esprima.js"));
context.evaluateReader(globalScope, esprimaLibReader, "esprima.js", 1, null);

// Add a global variable out that is a JavaScript reflection of the System.out variable:
Object wrappedOut = Context.javaToJS(System.out, globalScope);
ScriptableObject.putProperty(globalScope, "out", wrappedOut);

String code = "var syntax = esprima.parse('42');" +
    "out.print(JSON.stringify(syntax, null, 2));";

// The module esprima is available as a global object due to the same
// scope object passed for evaluation:
context.evaluateString(globalScope, code, "<mem>", 1, null);
Context.exit(); 
```

运行此代码后，您应该会看到如下输出：

```
{
  "type": "Program",
  "body": [
    {
      "type": "ExpressionStatement",
      "expression": {
        "type": "Literal",
        "value": 42,
        "raw": "42"
      }
    }
  ]
} 
```

所以确实，诀窍在于重用`globalScope`对象。

* * *

## 回答 #4

> 赞同：6
> 
> 时间：2009-03-16T15:14:49.640

只要您使用相同的作用域来执行每个文件，它们就可以从以前执行的文件中引用函数和变量。

# django - 如何使用 Django 编写 Facebook 应用程序？

> ID：650382
> 
> 赞同：33
> 
> 时间：2009-03-16T13:16:41.500
> 
> 标签：django, facebook, social-networking, pinax

我正在使用 Django 为 Facebook 开发一些应用程序！我首先在 Django 中构建了应用程序，并且它的形状很好，现在我想知道如何将它变成一个 Facebook 应用程序。

我非常感谢使用 Django 制作的 Facebook 应用程序的真实示例。

* * *

## 回答 #1

> 赞同：27
> 
> 时间：2010-03-10T10:49:26.657

我刚刚在**Pycon 2010上看到了**[***Eric Florenzano 先生***](http://www.eflorenzano.com/)[**的演讲**](http://blip.tv/file/3261337)，他谈到了他在 facebook 上使用 django 完成的一个副项目。[](http://www.eflorenzano.com/)

 ***从 PYCON 2010 开始：

> 如果您已经使用 Django 一段时间，那么您可能已经学习了一些关于如何使用它的非常标准的实践。本演讲旨在打破这些概念，并教您使用 Django 的替代方法。
> 
> 这些替代方式大致分为两种：在 Django 之外使用部分内容，以及选择 Django 提供的替代方案。如果您以前没有做过任何这些事情，这可能看起来很棘手或困难。事实上，它可能不是。
> 
> 本演讲将引导您完成整个过程，并讨论如果您的项目似乎不“符合标准”会发生什么。

我建议您查看他的博客和演示文稿。

*   博客：[http ://www.eflorenzano.com/](http://www.eflorenzano.com/)
*   介绍：[http ://blip.tv/file/3261337](http://blip.tv/file/3261337)

更多资源：

1.  [如何在 Django 中构建 Facebook 应用程序](http://uswaretech.com/blog/2009/02/how-to-build-a-facebook-app-in-django/)

2.  [Django 中的示例 Facebook 应用程序](http://www.rkblog.rk.edu.pl/w/p/example-facebook-application-django/)

3.  [双面 Django 第 1 部分：构建一个同时存在于 Facebook 和 Web 上的项目](http://lethain.com/entry/2007/dec/04/two-faced-django-part-1-building-project-exists-si/)

    *   [双面 Django 第 2 部分：模型和 Django 测试](http://lethain.com/entry/2007/dec/04/two-faced-django-part-2-models-and-django-testing/)

    *   [双面 Django 第 3 部分：新形式](http://lethain.com/entry/2007/dec/04/two-faced-django-part-3-newforms/)

    *   [双面 Django 第 4 部分：Webapp](http://lethain.com/entry/2007/dec/09/two-faced-django-implementing-most-webapp/)

* * *

## 回答 #2

> 赞同：5
> 
> 时间：2011-02-15T19:17:10.930

如果您只是想开始，请查看github 上的[Fandjango 。](https://github.com/jgorset/fandjango)它是一个简单的中间件层，`facebook_user`在用户登录时向请求对象添加一个属性，并在用户未登录时将其设置为 None。它还有一种使用用户凭据调用 Graph API 的简单方法。

注意：它仅适用于 Facebook 应用程序。使用 facebook 连接的网站使用稍微不同的协议。

另请注意：任何引用“pyfacebook”的库都在使用旧的 FB API，您应该避免这种情况。 ~~使用 Graph API 的新 API 是[python-sdk](https://github.com/facebook/python-sdk)。~~您也不应该使用 python-sdk，因为它已被弃用 - 感谢@pydanny。我还没有研究过它，但[facebook-sdk](https://github.com/pythonforfacebook/facebook-sdk)看起来是积极维护的。

* * *

## 回答 #3

> 赞同：5
> 
> 时间：2011-04-14T09:47:06.137

Python Sdk 维护得很差。认为你最好的选择是 Django Facebook： [https ://github.com/tschellenbach/Django-facebook](https://github.com/tschellenbach/Django-facebook)

基础教程 [http://www.mellowmorning.com/2011/06/23/django-facebook-2-0-integrating-facebook/](http://www.mellowmorning.com/2011/06/23/django-facebook-2-0-integrating-facebook/)

* * *

## 回答 #4

> 赞同：4
> 
> 时间：2009-03-16T15:40:11.233

信息：

[这里](http://www.chickenwingsoftware.com/scratches/python/django-facebook-1)，[这里](http://www.chickenwingsoftware.com/scratches/python/django-facebook-2)和[这里](http://www.chickenwingsoftware.com/scratches/python/django-facebook-3)+ [pyFacebook](http://wiki.developers.facebook.com/index.php/PythonPyFacebookTutorial)。

# http - http负载测试工具

> ID：650383
> 
> 赞同：4
> 
> 时间：2009-03-16T13:17:21.637
> 
> 标签：http, load-testing

我想像单个用户一样记录网络活动，然后运行一个或多个这样的同时用户（也许调整一些参数，例如转换`user/password`为`user1/password`, ..., `usern`/ `password`）。玩时间也不错。

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2009-03-16T14:19:52.720

[Grinder](http://grinder.sourceforge.net/)是我用过的最好的工具之一，该工具是用 java 构建的，但我用它来测试我的 ASP.NET 应用程序。使用 3 台机器进行测试。（每台机器一次最多只能模拟 1000 个用户）。我们最终对 3000 个并发用户进行了负载测试。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2009-03-16T14:44:25.547

我的公司 BrowserMob 提供[低成本的负载测试服务](http://browsermob.com/load-testing)，它可能对您很有效。您可以注册[免费试用](https://browsermob.com/free-stress-test)，上传 Selenium 脚本，然后进一步修改脚本以使用不同的登录名等。整个脚本最终使用 [JavaScript API](http://static.browsermob.com/api)编写，因此您可以做一些非常高级的事情。您可以进行价值 100 美元的免费测试，这可能会有很长的路要走，特别是如果您使用我们的虚拟用户功能而不是我们的真实浏览器用户功能。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2009-03-16T14:08:04.713

[ab](http://httpd.apache.org/docs/2.0/programs/ab.html)是一个很好的简单的开始方式。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2012-08-13T07:05:08.777

我从事一个可能符合要求的项目。它被称为[吞噬](http://engulf-project.org)。如果你需要产生大量的负载吞没效果很好，因为它支持多个工作人员。它还具有实时网络界面，观看恕我直言非常愉快。

# user-interface - UI设计师和信息架构师有什么区别？

> ID：650388
> 
> 赞同：3
> 
> 时间：2009-03-16T13:18:21.340
> 
> 标签：user-interface

UI设计师和信息架构师有什么区别？

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2009-03-16T13:22:44.323

信息架构师关注数据如何在应用程序中流动，并且主要关注数据。UI 设计师将获取该信息并生成一个界面来表示该流程，并且主要关注用户。

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2009-03-16T13:42:35.960

'Information Architect' 和' [Architect](http://www.iasahome.org/web/home/home) ' 一样，至少具有与组织一样多的不同含义。

1.  在某些组织中，您可能会授予 Intranet 网站管理员一个听起来很花哨的头衔（如果 Intranet 是为搜索和导航而精心设计的，并且混合了一些不错的[本体](http://en.wikipedia.org/wiki/Ontology_(information_science))和[分类法，这](http://en.wikipedia.org/wiki/Taxonomy)**可能**是合理的）。
2.  在某些组织中，信息架构师也可能被称为数据仓库或商业智能架构师，负责确保数据质量以及对历史和当前数据的可用和及时分析。[星型模式](http://en.wikipedia.org/wiki/Star_schema)、SQL 数据库、[实体关系图](http://en.wikipedia.org/wiki/Entity-relationship_model)、业务对象建模是可以使用和生成的工件。
3.  在一些组织中，信息架构师通过致力于统一的逻辑数据模型和集成模式来补充内部和外部系统的集成。[XML 模式](http://en.wikipedia.org/wiki/XML_schemas)、业务对象建模、数据流图和业务术语都在处理的工件中。
4.  在某些组织中，信息架构师主要或什至专门处理事物的业务方面，并确保整个组织中的每个人都同意我们所说的“客户”、“订单”、“产品”的含义，以及我们如何唯一地识别它们，以及它们具有哪些属性以及我们可以应用哪些分类学分类。业务对象建模和业务[术语](http://en.wikipedia.org/wiki/Terminology)是可以处理的主要工件之一。

但最常见的是，它是所有这些的混合体，甚至更多，取决于个人。用户界面设计只是许多组织实践的整个信息架构范围的一小部分。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2009-03-16T13:23:16.490

用户界面设计师设计用户看到的应用程序部分。信息架构师设计他们不设计的部分。

如果应用程序要可用，这两个部分都很重要。它们是不同的，但必须很好地协同工作（或者至少它们的设计必须），

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2010-01-12T22:34:03.527

通常，信息架构师与业务部门合作确定：

1.  数据（“用户和业务需要什么数据来完成这个任务？”）
2.  流程（“完成此任务的过程是什么？具体步骤是什么，顺序是什么？”）。

另一方面，UI 设计师将与用户合作并处理特定于平台的问题。例如，在 iPhone 上，UI 设计师会：

1.  确定信息架构师定义的每个数据/任务使用哪些 UI 控件（“使用 UITableView 进行简单的选项列表；使用 UIPicker 进行多级选择”）；
2.  确定哪些转换用于哪些活动（“用于通过多步骤流程进行的水平幻灯片；用于选择选项的垂直幻灯片”）和其他特定于 UI 的标准
3.  与信息架构师合作以精简、简化或以其他方式优化数据和流程，以满足特定平台（例如 iPhone）的要求以及最终用户通常如何使用它
4.  成为官方 UI 指南的*专家*（例如 Apple）

信息架构师可能会使用线框（事物的大致位置），而 UI 设计师会使用诸如 Interface Builder 之类的 GUI 工具或仅使用 OmniGraffle 和/或 Photoshop 之类的工具中的漂亮图片（像素完美再现）来处理模型。

# asp.net - 获取浏览器和连接信息的页面

> ID：650392
> 
> 赞同：5
> 
> 时间：2009-03-16T13:18:54.443
> 
> 标签：asp.net, javascript, browser, cross-browser

我们使用 ASP.NET 和 C# 编写软件即服务解决方案。

有时，由于特定的浏览器设置/细微差别，客户端可能会遇到问题。或者他们在一个未知的代理服务器后面。他们还可能报告实际上与本地带宽问题相关的问题。

我们正在尝试组合一个测试页面，该页面执行多项检查，例如

*   浏览器类型/版本
*   屏幕分辨率
*   带宽估计
*   是否启用了javascript
*   他们是否在代理服务器后面
*   启用/禁用 Http 压缩

任何人都可以提出执行这些检查的任何示例以及任何其他有用的检查吗？

我们的目标是在用户遇到问题时将其发送到此页面，以便它可以通过电子邮件向我们发送尽可能多的详细信息，以帮助追查核心问题。

谢谢！

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-03-16T15:39:06.523

这应该让你在那里的方式的一部分：

[http://www.codeproject.com/KB/aspnet/detectbrowser.aspx](http://www.codeproject.com/KB/aspnet/detectbrowser.aspx)

```
浏览器/版本
活动X
Javascript
VB脚本
Java 小程序

```

# asp.net-mvc - 带有 null 模型的 renderpartial 传递了错误的类型

> ID：650393
> 
> 赞同：202
> 
> 时间：2009-03-16T13:19:29.947
> 
> 标签：asp.net-mvc, renderpartial

我有一个页面：

```
<%@ Page Inherits="System.Web.Mvc.View<DTOSearchResults>" %> 
```

在其上，以下内容：

```
<% Html.RenderPartial("TaskList", Model.Tasks); %> 
```

这是 DTO 对象：

```
public class DTOSearchResults
{
    public string SearchTerm { get; set; }
    public IEnumerable<Task> Tasks { get; set; } 
```

这是部分：

```
<%@ Control Language="C#" Inherits="System.Web.Mvc.ViewUserControl<IEnumerable<Task>>" %> 
```

当 Model.Tasks 不为空时，一切正常。但是，当它为空时，我得到：

> 传递到字典中的模型项的类型为“DTOSearchResults”，但此字典需要类型为“System.Collections.Generic.IEnumerable`1[Task]”的模型项。

我认为它一定不知道要使用哪个重载，所以我这样做（见下文）是为了明确，但我仍然遇到同样的问题！

```
<% Html.RenderPartial("TaskList", (object)Model.Tasks, null); %> 
```

我知道我可以通过检查 null 或什至不传递 null 来解决这个问题，但这不是重点。为什么会这样？

* * *

## 回答 #1

> 赞同：351
> 
> 时间：2009-04-03T13:32:52.337

安德鲁，我认为您遇到的问题是当您传递的模型为空时，RenderPartial 方法使用调用（视图）的模型到局部视图的结果。您可以通过执行以下操作来解决这种奇怪的行为：

```
<% Html.RenderPartial("TaskList", Model.Tasks, new ViewDataDictionary()); %> 
```

这有帮助吗？

* * *

## 回答 #2

> 赞同：48
> 
> 时间：2011-03-15T15:14:17.523

@myandmycode 的答案很好，但会稍短一些

```
<% Html.RenderPartial("TaskList", new ViewDataDictionary(Model.Tasks)); %> 
```

这是有效的，因为它`ViewDataDictionary`是保存模型的东西，它可以接受模型作为构造函数参数。这基本上传递了一个“整个”视图数据字典，当然它只包含可能为空的模型。

* * *

## 回答 #3

> 赞同：28
> 
> 时间：2010-07-30T16:35:11.687

看来，当您传入的模型的属性为空时，MVC 会故意恢复为“父”模型。显然，MVC 引擎将 null 模型值解释为使用前一个模型值的意图。

这里稍微详细一点：[ASP.NET MVC，强类型视图，部分视图参数故障](https://stackoverflow.com/questions/1049027/asp-net-mvc-strongly-typed-views-partial-view-parameters-glitch)

* * *

## 回答 #4

> 赞同：20
> 
> 时间：2012-08-20T12:23:52.077

如果您不想在局部视图中丢失以前的 ViewData，您可以尝试：

```
<% Html.RenderPartial("TaskList", Model.Tasks, new ViewDataDictionary(ViewData){Model = null});%> 
```

* * *

## 回答 #5

> 赞同：12
> 
> 时间：2011-11-29T17:21:01.580

一个解决方案是像这样创建一个 HtmlHelper：

```
public static MvcHtmlString Partial<T>(this HtmlHelper htmlHelper, string partialViewName, T model)
{
    ViewDataDictionary viewData = new ViewDataDictionary(htmlHelper.ViewData)
    {
        Model = model
    };
    return PartialExtensions.Partial(htmlHelper, partialViewName, model, viewData);
} 
```

之前的`Partial<T>(...)`matched，`Partial(...)`编译的时候很方便，没有歧义错误。

我个人觉得很难理解这种行为 - 似乎很难将其想象为设计选择？

* * *

## 回答 #6

> 赞同：11
> 
> 时间：2012-04-21T11:41:10.517

尽管已经回答了这个问题，但我遇到了这个问题，并决定为我的项目解决这个问题，而不是使用`new ViewDataDictionary()`.

我创建了一组扩展方法： [https](https://github.com/q42jaap/PartialMagic.Mvc/blob/master/PartialMagic.Mvc/PartialExtensions.cs)
://github.com/q42jaap/PartialMagic.Mvc/blob/master/PartialMagic.Mvc/PartialExtensions.cs 我还添加了一些在模型为空时不调用部分的方法，这将节省大量的 if 语句。

我为 Razor 创建了它们，但其中一些也应该与 aspx 样式视图一起使用（使用 HelperResult 的视图可能不兼容）。

扩展方法如下所示：

```
@* calls the partial with Model = null *@
@Html.PartialOrNull("PartialName", null)
@* does not call the partial if the model is null *@
@Html.PartialOrDiscard("PartialName", null) 
```

还有一些`IEnumerable<object>`模型方法，丢弃方法也可以使用 Razor lambda 调用，它允许您使用一些 html 包装部分结果。

如果您愿意，请随意使用它们。

* * *

## 回答 #7

> 赞同：1
> 
> 时间：2015-01-21T07:57:20.047

我的解决方法是：

```
 <% Html.RenderPartial("TaskList", Model.Tasks ?? new List()); %> 

```

# perl - Perl 是否有适用于所有国家/地区的电话号码验证器？

> ID：650396
> 
> 赞同：3
> 
> 时间：2009-03-16T13:20:43.067
> 
> 标签：perl, validation, phone-number

我正在使用 Perl 进行 Web 开发。我需要为所有国家/地区进行电话号码验证。是否有可以执行以下操作的开源 Perl 模块？

例如：国家=马来西亚，如果用户输入电话号码=+60127008007，验证后返回这是一个在马来西亚有效的手机号码，其中：在马来西亚本地，我们直接拨打：0127008007。“+6”是国际代码。

而如果用户输入电话号码 = +600127008007，则返回无效电话号码。因为在马来西亚本地，没有这样的号码：00127008007。

任何免费模块都可以做到这一点，在 CPAN 或其他方面？

* * *

## 回答 #1

> 赞同：9
> 
> 时间：2009-03-16T13:31:45.627

看看 Number::Phone::NANP ( [lNumber::Phone::NANP](http://search.cpan.org/perldoc?Number::Phone::NANP) )。我想您将为未覆盖的国家/地区添加新的子类。

* * *

## 回答 #2

> 赞同：8
> 
> 时间：2009-03-16T14:10:55.550

验证假设您比输入数据的人了解更多，但在这种情况下您不知道。假设我是一名美国人，在加拿大签订长期合同。我保留了我的手机，因为我工作的公司正在支付漫游费。当我访问您的网站并输入我的美国手机号码和加拿大地址时，您的验证脚本声称它无效，否则无效。这会导致客户的困惑和愤怒。

如果有效的电话号码（或就此而言的电子邮件）是您的业务的绝对要求，您必须致电（或发送电子邮件）该号码（或电子邮件地址）的人并让他们输入您提供的代码。有设计用于自动拨打号码并向收件人提供消息的[硬件/软件。](http://code.google.com/p/robodialer/)您可以使用[Festival](http://festvox.org/festival/)等文本转语音软件通过电话播放特殊键，然后让他们将其键入您的网站以确认他们可以访问该电话。即便如此，这也不是万无一失的，因为我可以买一部扔掉的手机或创建一个扔掉的电子邮件地址。

* * *

## 回答 #3

> 赞同：3
> 
> 时间：2009-03-17T08:32:49.193

验证的目的是通过捕获强制他们在输入期间使用特定格式的输入错误来帮助用户。

有一点验证不再对用户有帮助。通常，这也是验证规则的异常变得太多而程序员无法处理的地方，因为他进入了收益递减的领域。

为什么需要经过验证的电话号码？您确定用户不会尝试在同一字段中输入两个数字并沮丧地放弃吗？您确定用户不会输入“555-5555（询问史蒂夫）”或“555-5555（分机 123）”或其他一些完全有效的输入吗？您确定您足够聪明，可以预测用户可能需要在该字段中输入的每个输入吗？

不要试图智取你的用户。帮助他。:)

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2009-03-16T13:29:25.353

为每个国家/地区保留最新的有效区号和号码长度列表几乎是不可能的。

我建议你检查一下：

1.  国际电话代码（1 到 3 位）
2.  区号（通常为 3 位，但范围为 1 到 5 位）
3.  电话号码（通常为 6 至 8 位，但范围为 4 至 13 位）

所以你有 6 到 21 位数字，特别感谢奥地利。=)

话虽如此，除非您拨打电话号码，否则您永远无法确定电话号码是否有效。您*将*让人们围绕验证工作（例如，通过输入不属于他们的有效公众号），因此您应该问自己：“这真的有必要吗？”

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2011-02-21T21:11:45.097

To expand on Chas. and Domchi's points: There are two reasons to validate a phone number:

1.  To help the user to correctly enter his/her number (often when the user WANTS you to have their number)
2.  To prevent the user from proceeding without entering a valid number (often when the user would rather not give it to you)

If your case is case #1 simple validation is all you need since you don't want to prevent a fringe case correct entry and frustrate your user, you simply want to help them from incorrectly entering their number.

If your case is case #2, no amount of validation will prevent a user from entering a valid number that isn't theirs. To really do this you would need to do an automated call-back with a validation code, in which case you are now more in case #1 since they will need to provide a correct number to get the validation code. This will be MUCH more work though.

In the end, you really only need to cover case #1, help the user to enter a correct number. Don't frustrate away a potential user, just due to phone number validation.

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2011-02-21T19:30:35.693

有人打算将 libphonenumber 移植到 Perl，但还没有发生。

已经有一个完整的 JavaScript 端口。

到目前为止，Ruby、PHP 和 Python 的端口不完整。C++ 移植预计在几个月内完成。

请留意：[http](http://code.google.com/p/libphonenumber/) ://code.google.com/p/libphonenumber/以了解其他任何宣布的内容。

* * *

## 回答 #7

> 赞同：-2
> 
> 时间：2009-03-16T13:31:13.290

我不知道 Perl，但这似乎是使用 Regexp 的完美案例。

但无论如何，每个国家都需要一个，显然这不能包括世界上任何国家，但你可以[在这里找到电话模式](http://en.wikipedia.org/wiki/Telephone_numbering_plan)。

# java - Servlet 程序即服务

> ID：650405
> 
> 赞同：0
> 
> 时间：2009-03-16T13:23:20.343
> 
> 标签：java

我有一个 Java servlet 程序，它在 tomcat 启动时启动。我已经提到该程序在启动时加载。我没有使用任何 HTTP 请求或响应。

我需要的是我需要将程序作为服务运行或需要在特定时间间隔自动刷新。怎么做？有人可以帮助我！

谢谢，戈帕尔。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2009-03-16T15:51:42.127

Quartz 是一个好主意，但根据您的需要，可能有点矫枉过正。我认为你真正的问题是试图将你的服务塞进一个 servlet，而你实际上并没有监听传入的 HttpServletRequests。相反，请考虑使用 ServletContextListener 来启动您的服务和 Timer，正如 Maurice 建议的那样：

网页.xml：

```
<listener>
    <listener-class>com.myCompany.MyListener</listener-class>
</listener> 
```

然后你的班级看起来像这样：

```
public class MyListener implements ServletContextListener {

    /** the interval to wait per service call - 1 minute */
    private static final int INTERVAL = 60 * 60 * 1000;

    /** the interval to wait before starting up the service - 10 seconds */
    private static final int STARTUP_WAIT = 10 * 1000;

    private MyService service = new MyService();
    private Timer myTimer;

    public void contextDestroyed(ServletContextEvent sce) {
        service.shutdown();
        if (myTimer != null)
            myTimer.cancel();
    }

    public void contextInitialized(ServletContextEvent sce) {
        myTimer = new Timer();
        myTimer.schedule(new TimerTask() {
            public void run() {
                myService.provideSomething();
            }
        },STARTUP_WAIT, INTERVAL
      );
    }
} 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-03-16T13:44:27.127

我建议您使用[Quartz](http://www.quartz-scheduler.org/)。您可以使用石英定义计划作业。

```
import org.quartz.Scheduler;
import org.quartz.SchedulerException;
import org.quartz.impl.StdSchedulerFactory;

public class QuartzTest {
   public static void main(String[] args) {
     try {
        Scheduler scheduler = StdSchedulerFactory.getDefaultScheduler();
        scheduler.start();

        scheduler.shutdown();
      } catch (SchedulerException se) {
        se.printStackTrace();
      }
  }
} 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-03-16T13:26:38.043

每次 .war 文件更改时，tomcat 都会自动刷新

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2009-03-16T13:36:10.250

我有时会使用计时器来定期发出 HTTP 请求：

```
 timer = new Timer(true);
    timer.scheduleAtFixedRate(
        new TimerTask() {
            URL url = new URL(timerUrl);
            public void run() {
                try {
                    url.getContent();
                } catch (IOException e) {
                    e.printStackTrace();
                }
            }
        },
        period,
        period); 
```

# javascript - HTML iframe 和 javascript

> ID：650409
> 
> 赞同：6
> 
> 时间：2009-03-16T13:24:40.030
> 
> 标签：javascript, html, iframe

我有两个 iframe，每个 iframe 显示两个不同的 html 页面。两个 html 页面都引用了一个包含全局变量的通用 javascript 文件。如果我在 html 页面加载期间在一帧中设置该全局变量的值。是否可以使用相同的全局变量访问另一个 iframe html 页面的值？为什么或者为什么不？

* * *

## 回答 #1

> 赞同：11
> 
> 时间：2009-03-16T13:27:04.593

不，JavaScript 作用域空间的顶层是页面级别。但是，您可以通过使用访问另一个页面的范围`window.parent`

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-08-18T21:34:09.640

实际上，我注意到它似乎没有保持范围，也许有人可以对此有所了解。

示例 1：您有一个包含一些 Flash 内容的 HTML 页面，该页面具有一些获取 SWF 对象和触发命令的功能。当此页面加载到 IFRAME 中时，“getSWFObj”是“不是函数”。

示例 2：我加载了一个 HTML 页面，其中包含一系列基于对象的 JavaScript 文件。我创建了一个名为“播放器”的实例，它创建了一些子对象，例如“导航”。当我调用“player.navigation”时，我收到一条错误消息，指出加载到 IFRAME 时它不存在。

# algorithm - 匈牙利算法（也是 Munkres 的分配算法）

> ID：650417
> 
> 赞同：6
> 
> 时间：2009-03-16T13:27:01.287
> 
> 标签：algorithm, math

我最近偶然发现了[这个算法](http://en.wikipedia.org/wiki/Hungarian_algorithm)，我很难向自己解释它。该算法解决了O(n ^(4 ) 中的)[分配问题](http://en.wikipedia.org/wiki/Assignment_problem)（显然可以改进为 O(n ³ )），但我不明白为什么。

直觉上，我可以看到该算法往往会找到最佳解决方案，但我看不到证据！到目前为止，我看到的所有证明都包含我不熟悉的符号。我的问题是：任何人都可以严格而简单地解释它吗？

我已经明白问题可以转移到一个值矩阵，其中必须选择每一行和每一列中的一个值。可能的最小值（来自所选元素）和产生的选择是算法计算的。显然，找到选择也会找到最小值。

* * *

在符号方面，我正在努力的部分是[here](http://en.wikipedia.org/wiki/Hungarian_algorithm#Setting)。*设置*部分的第三段开始“让我们调用一个函数”......

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-03-16T13:45:30.150

您链接到的[Wikipedia 页面](http://en.wikipedia.org/wiki/Hungarian_algorithm#Matrix_interpretation)包含有关如何在矩阵上手动执行此算法的步骤。[python 实现](http://www.clapper.org/software/python/munkres/)也使用矩阵。有时，理解算法的唯一方法是手动或在交互式控制台中逐步完成。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2010-02-01T21:22:30.603

你可以看看 Jungnickel 的这[本书](http://books.google.com/books?id=NvuFAglxaJkC&printsec=frontcover&dq=Graphs,+Networks+and+Algorithms&cd=1#v=onepage&q=&f=false)，它从第 421 页开始对匈牙利算法进行了彻底的理论讨论，但也给出了一个例子。通过这个例子，你应该能够明白为什么算法是 O(n3))。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-03-16T13:53:49.490

也就是说，对于 S 和 T 中的每个位置，如果 i 处的 y 和 j 处的 y 加起来小于迄今为止为该位置计算的成本（找到最低的潜在答案），则 S 和 T 值中的 y 是一个潜在答案。

如果我没记错的话，这是一个动态编程问题。一个完美的匹配是当他最便宜的价格恰好是他被选中做的事情时。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2009-03-16T13:53:54.263

该函数将图中的每个顶点（即 S 和 T 的并集，即 U 形符号的含义）映射到有理数系统中，即 Q 由给定顶点对的不等式表示。符号的哪一部分仍然没有意义？

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2009-03-16T14:14:23.623

势函数 y 以这样的方式为完整二部图中的每个顶点分配一个数字，即来自 S（所有人的集合）的任何顶点和来自 T（所有工作的集合）的任何顶点的势之和是小于连接这些顶点的边的值（因此小于做这项工作的人的成本）。将 0 分配给每个顶点的函数是有效势函数的一个很好的例子。

势 y 的值是所有顶点的势之和（这是定义）。

> 可以看出，每一次完美匹配的代价至少是每一次势能的价值。

这是相当明显的：在完美匹配中，您必须选择没有共同顶点的 n 条边。每条边的成本都低于其顶点势的总和（根据势的定义）。当您将匹配中所有边的成本相加时，它将高于图的潜力值。

现在，该算法计算潜在和匹配，以使它们的成本/价值相同。因为潜力的价值是问题的最小成本的下限，所以你得到了一个最优解。

这证明了算法。现在您需要查看它并了解它为什么以及如何找到完美匹配和具有相同成本/价值的潜力。

# java - 为什么我使用 SSL 收到“Error commiting response java.io.IOException: Broken pipe at sun.nio.ch.FileDispatcher.write0(Native Method)”

> ID：650433
> 
> 赞同：0
> 
> 时间：2009-03-16T13:32:25.360
> 
> 标签：java, sunone

当我将页面从 http 重定向到 https 时，我遇到了这个异常。奇怪的是，我可以在前 10 到 20 个请求中访问 https。但随后的请求我遇到了这个破管道问题

以下是完整的例外

提交 responsejava.io.IOException 时出错：sun.nio.ch.IOUtil 的 sun.nio.ch.SocketDispatcher.write(SocketDispatcher.java:29) 的 sun.nio.ch.FileDispatcher.write0(Native Method) 的管道损坏。 writeFromNativeBuffer(IOUtil.java:104) 在 sun.nio.ch.IOUtil.write(IOUtil.java:75) 在 sun.nio.ch.SocketChannelImpl.write(SocketChannelImpl.java:302) 在 com.sun.enterprise.server .ss.ASOutputStream.write(ASOutputStream.java:120) 在 com.sun.net.ssl.internal.ssl.OutputRecord.writeBuffer(OutputRecord.java:283) 在 com.sun.net.ssl.internal.ssl.OutputRecord .write(OutputRecord.java:272) 在 com.sun.net.ssl.internal.ssl.SSLSocketImpl.writeRecord(SSLSocketImpl.java:666) 在 com.sun.net.ssl.internal.ssl.AppOutputStream.write(AppOutputStream .java:59) 在 org.apache.coyote.http11.InternalOutputBuffer.commit(InternalOutputBuffer.java:602) 在 com.sun.enterprise.web.connector。grizzly.ProcessorTask.action(ProcessorTask.java:721) at org.apache.coyote.Response.action(Response.java:188) at org.apache.coyote.Response.sendHeaders(Response.java:380) at org.apache .coyote.tomcat5.OutputBuffer.doFlush(OutputBuffer.java:357) 在 org.apache.coyote.tomcat5.OutputBuffer.close(OutputBuffer.java:318) 在 org.apache.coyote.tomcat5.CoyoteResponse.finishResponse(CoyoteResponse.java :528) 在 com.sun.enterprise.web.connector.grizzly.ProcessorTask.doProcess(ProcessorTask.java:604) 在 com.sun 的 org.apache.coyote.tomcat5.CoyoteAdapter.service(CoyoteAdapter.java:192)。 Enterprise.web.connector.grizzly.ProcessorTask.process(ProcessorTask.java:475) 在 com.sun.enterprise.web.connector.grizzly.ProcessorTask.doTask(ProcessorTask.java:426) 在 com.sun.enterprise.web。 com.sun.enterprise.web.connector 上的 connector.grizzly.TaskBase.run(TaskBase.java:281)。grizzly.WorkerThread.run(WorkerThread.java:83

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2011-04-17T04:44:56.737

我通过增加 JVM 可用的 RAM 解决了类似的问题，例如：

```
java -jar <your JAR file> -Xms512m 
```

# objective-c - 带有 UIButtons 的 UIScrollview - 如何重新创建跳板？

> ID：650437
> 
> 赞同：34
> 
> 时间：2009-03-16T13:33:29.057
> 
> 标签：objective-c, uiscrollview, uibutton, programmatically-created

我正在尝试在我的应用程序中创建一个类似跳板的界面。我正在尝试使用添加到 UIScrollView 的 UIButtons。我遇到的问题是按钮没有将任何触摸传递给 UIScrollView - 如果我尝试轻弹/滑动并碰巧按下按钮，它不会注册 UIScrollView，但是如果我轻弹之间的空间按钮它将起作用。如果我触摸它们，按钮会单击/工作。

是否存在强制按钮将触摸事件发送到其父级（超级视图）的属性或设置？在添加 UIScrollView 之前，是否需要将按钮添加到其他内容？

这是我的代码：

```
//init scrolling area
UIScrollView *scrollView = [[UIScrollView alloc] initWithFrame:CGRectMake(0, 0, 480, 480)];
scrollView.contentSize = CGSizeMake(480, 1000);
scrollView.bounces = NO;
scrollView.delaysContentTouches = NO;

//create background image
UIImageView *rowsBackground = [[UIImageView alloc] initWithImage:[self scaleAndRotateImage:[UIImage imageNamed:@"mylongbackground.png"]]];
rowsBackground.userInteractionEnabled = YES;

//create button
UIButton *btn = [[UIButton buttonWithType:UIButtonTypeCustom] retain];
btn.frame = CGRectMake(100, 850, 150, 150);
btn.bounds = CGRectMake(0, 0, 150.0, 150.0);
[btn setImage:[self scaleAndRotateImage:[UIImage imageNamed:@"basicbutton.png"]] forState:UIControlStateNormal];
[btn addTarget:self action:@selector(buttonClick) forControlEvents:UIControlEventTouchUpInside];

//add "stuff" to scrolling area
[scrollView addSubview:rowsBackground];
[scrollView addSubview:btn];

//add scrolling area to cocos2d
//this is just a UIWindow
[[[Director sharedDirector] openGLView] addSubview:scrollView];

//mem-mgmt
[rowsBackground release];
[btn release];
[scrollView release]; 
```

* * *

## 回答 #1

> 赞同：44
> 
> 时间：2010-08-04T13:44:20.380

对我有用的解决方案包括：

1.  设置`canCancelContentTouches`为。`UIScrollView`_`YES`
2.  扩展`UIScrollView`覆盖`touchesShouldCancelInContentView:(UIView *)view`以返回`YES`when`view`是一个`UIButton`.

根据文档`touchesShouldCancelInContentView`返回“`YES`取消更多触摸消息以查看，`NO`让视图继续接收这些消息。默认返回值是`YES`如果视图不是`UIControl`对象；否则，它返回`NO`。”

Since `UIButton` is a `UIControl` the extension is necessary to get `canCancelContentTouches` to take effect which enables scrolling.

* * *

## 回答 #2

> 赞同：28
> 
> 时间：2009-03-18T15:56:18.410

为了`UIScrollView`确定通过其内容视图的点击与变成滑动或捏合的触摸之间的区别，它需要延迟触摸并查看您的手指是否在该延迟期间移动。通过在上面的示例中设置`delaysContentTouches`为`NO`，您可以防止这种情况发生。因此，滚动视图总是将触摸传递给按钮，而不是在用户执行滑动手势时取消它。尝试设置`delaysContentTouches`为`YES`.

从结构上讲，将要在滚动视图中托管的所有视图添加到公共内容视图并仅使用该视图作为滚动视图的子视图也可能是一个好主意。

* * *

## 回答 #3

> 赞同：5
> 
> 时间：2010-04-27T09:11:58.950

我有一个类似的情况，即 UIScrollView 上有许多按钮，我想滚动这些按钮。一开始，我继承了 UIScrollView 和 UIButton。但是，我注意到我的子类 UIScrollView 没有收到 touchesEnded 事件，所以我改为仅子类 UIButton。

```
 @interface MyPhotoButton : UIButton {
}

- (void)touchesMoved:(NSSet *)touches withEvent:(UIEvent *)event;
- (void)touchesEnded:(NSSet *)touches withEvent:(UIEvent *)event;
- (void)touchesCancelled:(NSSet *)touches withEvent:(UIEvent *)event;
@end 
```

```
 @implementation MyPhotoButton

- (void)touchesMoved:(NSSet *)touches withEvent:(UIEvent *)event {
    [super touchesMoved:touches withEvent:event];
    [self setEnabled:NO];
    [self setSelected:NO];
}

- (void)touchesEnded:(NSSet *)touches withEvent:(UIEvent *)event {
    [super touchesEnded:touches withEvent:event];
    [self setEnabled:YES];
}

- (void)touchesCancelled:(NSSet *)touches withEvent:(UIEvent *)event {
    [super touchesCancelled:touches withEvent:event];
    [self setEnabled:YES];
}

@end 
```

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2009-03-16T14:15:38.207

UIScrollView 自己处理很多事件。您需要手动处理 touchesDidEnd 并点击测试 UIScrollView 内的按钮。

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2010-02-26T02:55:46.600

好的，这是你的答案：

子类 UIButton。（注意：在每次覆盖开始时调用 [super ....]。

*   添加属性。BOOL 类型之一（称为 enableToRestore）
*   添加属性。CGPoint 类型之一（称为 startTouchPosition）
*   在 awakeFromNib 和 initWithFrame 中，将 enableToRestore 设置为 isEnabled 属性）
*   覆盖“touchesBegan：withEvent：”以存储触摸位置的开始。
*   覆盖 "touchesMoved: withEvent:" 以检查是否有水平移动。
*   如果是，则将启用设置为 NO 并选择为 NO。

示例代码：

```
- (void)touchesBegan:(NSSet *)touches withEvent:(UIEvent *)event 
{
    UITouch *touch = [touches anyObject];

    [super touchesBegan:touches withEvent:event];
    [self setStartTouchPosition:[touch locationInView:self]];
}

//
// Helper Function
//
- (BOOL)isTouchMovingHorizontally:(UITouch *)touch 
{
    CGPoint currentTouchPosition = [touch locationInView:self];
    BOOL      rValue = NO;

    if (fabsf([self startTouchPosition].x - currentTouchPosition.x) >= 2.0) 
    {
        rValue = YES;
    }

    return (rValue);
}

//
// This is called when the finger is moved.  If the result is a left or right
// movement, the button will disable resulting in the UIScrollView being the
// next responder.  The parrent ScrollView will then re-enable the button
// when the finger event is ended of cancelled.
//
- (void)touchesMoved:(NSSet *)touches withEvent:(UIEvent *)event 
{
    [super touchesMoved:touches withEvent:event];
    if ([self isTouchMovingHorizontally:[touches anyObject]]) 
    {
        [self setEnabled:NO];
        [self setSelected:NO];
    } 
} 
```

这将激活 UIScrollView。

子类 UIScrollView。（注意：在每次覆盖开始时调用 [super ....]。

*   覆盖 "touchesEnded: withEvent:" 和 "touchesCancelled: withEvent:"
*   在覆盖中，重置所有子视图（及其子视图）启用标志。
*   注意：使用类别并将方法添加到 UIView：

.

```
- (void) restoreAllEnables
{
    NSArray   *views = [self subviews];

    for (UIView *aView in views)
    {
        if ([aView respondsToSelector:@selector(restoreEnable)])
        {
            [aView restoreEnable];
        }
    }
}

- (void) touchesEnded:(NSSet *)touches withEvent:(UIEvent *)event
{
    [super touchesEnded:touches withEvent:event];
    [self restoreAllEnables];
}

- (void)touchesCancelled:(NSSet *)touches withEvent:(UIEvent *)event
{
    [super touchesEnded:touches withEvent:event];
    [self restoreAllEnables];
} 
```

*   在类别中：

.

```
-(void) restoreEnable
{
    NSArray   *views = [self subviews];

    if ([self respondsToSelector:@selector(enableToRestore)])
    {
        [self setEnabled:[self enableToRestore]];
    }

    for (UIView *aView in views)
    {
        if ([aView respondsToSelector:@selector(restoreEnable)])
        {
            [aView restoreEnable];
        }
    }
} 
```

编辑注意：我从来没有得到答案 3 的工作。同样： setDelaysContentTouches:NO （在视图控制器或某个地方设置）将设置为答案 4 的最佳结果。这提供了对按钮的非常快速的响应。设置 setDelaysContentTouches:YES 会对按钮的响应时间产生严重影响（150 毫秒），并使轻快的触摸变得不可能。

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2009-05-30T17:55:50.750

另一种方法是：
1\. 用简单的自定义 UIView 替换 de 按钮
2\. 放置标志“userInterationEnable = yes;” 关于 init 方法
3\. 在视图中覆盖 UIResponder 方法“touchesEnded”，您可以在此处触发您需要的操作，如按钮。

* * *

## 回答 #7

> 赞同：0
> 
> 时间：2009-11-11T09:12:48.783

以我的经验，第一个答案，即简单地设置`delaysContentTouches`为`YES`，并不会改变与问题有关的任何内容。这些按钮仍然不会将跟踪结果传递到滚动视图。第三个答案既简单又非常有用。谢谢西罗奥吉！

但是，要使第三个答案起作用，您还需要 `delaysContentTouches`设置为`YES`. 否则，该方法`touchesEnded`也将被调用以在视图中进行跟踪。因此我可以通过以下方式解决问题：

> 1.  用一个简单的自定义 UIView 替换 de 按钮
> 2.  把标志“userInterationEnable = yes;” 在初始化方法上
> 3.  在视图中重写 UIResponder 方法“touchesEnded”在这里你可以触发你的动作

第四。设置`delaysContentTouches`为`YES`

# actionscript-3 - 闪存使用AS3.0

> ID：650439
> 
> 赞同：0
> 
> 时间：2009-03-16T13:34:07.527
> 
> 标签：actionscript-3

我创建了一个名为 splash_mc 的影片剪辑，我只想在“启动页面”上查看它。但是，当我将 splash_mc 链接到主时间线或任何其他影片剪辑时，它（当然）会在我单击导航栏上的各种链接时将其传播到我的所有帧中。基本上，我只希望动画出现在指定的标签“splash”下，这样当我单击主导航中指向其他页面的链接时，动画就会消失。我尝试通过将我的动画与我的导航电影剪辑一起使用'this.removeChild'并且它起作用了。但只有当我第一次在我的启动页面上使用导航时；当我尝试单击内部页面中的链接时，出现错误，因为 eventListener 仍在运行该功能，但当然不再需要摆脱 splash_mc 了。

我能做些什么？我在这里看到我可以将我的 splash_mc 加载到一帧，所以当我的链接被点击时，理论上，播放头移出该帧并且我的动画不再可见。这是一个更好的选择吗？

谢谢你。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2009-03-16T14:03:06.723

无论哪种方式都是可以接受的。我想这真的取决于你喜欢哪种方法。您可以通过在执行 removeChild 的同一函数中使用 removeEventListener() 来消除该错误。

# php - 缓存 AJAX 请求

> ID：650440
> 
> 赞同：8
> 
> 时间：2009-03-16T13:34:29.973
> 
> 标签：php, javascript, jquery, ajax, caching

我正在向 PHP 应用程序发送 AJAX GET 请求，并希望缓存请求返回以供以后使用。

由于我使用 GET 这应该是可能的，因为不同的请求请求不同的 URL（例如 getHTML.php?page=2 和 getHTML.php?page=5）。

我需要在 PHP 应用程序中声明哪些标头以使客户端浏览器以正确的方式缓存请求 URL 内容？我是否需要在处理 AJAX 请求的 Javascript 中声明任何内容（我正在使用具有缓存参数的 jQuery 的 $.ajax 函数）？

我将如何处理更改例如 getHTML.php?page=2 内容的编辑，以便客户端不会退回到缓存版本？向 GET 请求添加另一个参数，例如 getHTML.php?page=2&version=2 是不可能的，因为到所请求的 URL 的链接是自动创建的，没有任何检查（最好是我想要的方式）。

当我尝试 AJAX 请求缓存的请求 URL 时，浏览器将如何反应？AJAX 请求会立即返回成功吗？

谢谢

威廉

* * *

## 回答 #1

> 赞同：9
> 
> 时间：2010-05-05T22:53:33.057

在服务器上添加以下标头：

```
 header("Cache-Control: private, max-age=$seconds");
    header("Expires: ".gmdate('r', time()+$seconds)); 
```

哪里`$seconds`有明显的含义。

我们在这里设置了一个`Expires`标头，即使如果之前设置`Cache-Control`了带有`max-age`参数的标头，也应该忽略它，因为[有些客户端不遵循标准](https://www.w3.org/Protocols/HTTP/Issues/expire-cache.html)。

另外，检查您的服务器是否没有发出其他一些反缓存标头，例如`Pragma`. 如果是这样，`Pragma: cache`也添加标题。

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2009-03-16T14:31:12.333

刷新页面后，您仍然会为内容进行服务器调用，即使您之前已经请求过它们。PHP 标头不会帮助您解决这个问题。

我认为您需要的是当前页面中已经从服务器请求的内容的客户端缓存机制。

对于这个用例，您可以在 JavaScript 中使用哈希表并在调用服务器之前对其进行查询。这将增强用户体验，因为用户不必等待他已经看过的内容的另一个请求。

这是一个例子：

```
//placeholder for hash table as cache
var cache = [];

var getPage = function(pageNr){
    if(cache[pageNr]){
        //content is already in cache, use it from there
        handleContent(cache[pageNr]);
    }
    else{
        //object with parameteres sent with GET request
        var params = {};
        params.page = pageNr;

        $.ajax({
          url: "getHTML.php",
          data: params,
          cache: false,
          success: function(response){
            //handle your response here
            handleContent(response);

            //store the response in the cache for later use
            cache[pageNr] = response;
          }
        });
    }
}; 
```

现在请求页面将首先在当前缓存中查看是否有内容。如果没有，它将使服务器调用并将响应存储在缓存中。

类似于在[Google 财经中滚动浏览新闻时的用户体验](http://www.google.com/finance?q=goog)

**请注意，如果您刷新页面，此缓存将被清除。**

如果对页面进行编辑，您将不得不使用 Maurice Perry 的 Yahoo Exceptional Performance 链接，以确保您的服务器始终返回最新版本的内容。

更多关于 JavaScript 中的哈希表： [http ://www.mojavelinux.com/articles/javascript_hashes.html](http://www.mojavelinux.com/articles/javascript_hashes.html)

# vb.net - 关于图像和winforms的问题

> ID：650444
> 
> 赞同：0
> 
> 时间：2009-03-16T13:37:04.307
> 
> 标签：vb.net, visual-studio-2008, system.drawing

我正在创建一个 Kiosk 应用程序。我有它全屏，我直接在表格上绘图：

```
Private Function CreateHeader(ByVal headerText As String) As Boolean
    Try
        Dim oGFX As Graphics = Graphics.FromHwnd(hwnd:=_oP.Handle)
        Dim oRect As Rectangle = New Rectangle(x:=0, y:=0, Width:=_screenSize.X, Height:=150)
        Dim oBMP As New Bitmap(GetEmbeddedResourceStream("Kiosk.logo.jpg"))

        Dim oBrush As Brush = New SolidBrush(Color.FromArgb(red:=0, green:=0, blue:=153))

        oGFX.FillRectangle(brush:=oBrush, rect:=oRect)
        oGFX.DrawImage(image:=oBMP, _
                           x:=0, _ 
                           y:=0, _
                       width:=oBMP.Width, _ 
                      height:=oBMP.Height)

        If Not String.IsNullOrEmpty(headerText) Then
            Dim oFont As New Font("Impact", 48, FontStyle.Regular)
            Dim g As Graphics = Me.CreateGraphics()

            Dim oStringSize As SizeF = g.MeasureString(headerText, oFont)

            g = Nothing

            oGFX.DrawString(s:=headerText, _
                         font:=oFont, _
                        brush:=Brushes.White, _
                            x:=(oRect.Width - Math.Round(oStringSize.Width, 0)) / 2, _
                            y:=(oRect.Height - Math.Round(oStringSize.Height, 0)) / 2)
        End If

        Return True
    Catch ex As Exception
        Return False
    End Try
End Function 
```

一切都画得很好，但是当我按下 Alt 或 Tab （单独或一起，以任何顺序）时，我绘制的矩形消失了。如果我再次调用该函数，无论我按什么按钮，它都会重绘并保持不变。是否有某种我需要调用的 .NET 函数，所以我的绘图函数只需要调用一次？

谢谢。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-03-16T13:39:18.637

您应该通过覆盖来进行绘画[`OnPaint`](http://msdn.microsoft.com/en-us/library/3e40ahaz.aspx)- 然后您将能够根据需要重新绘画。此刻，你画的任何东西都只在屏幕下有效，是无效的。

# sql-server - 使用经典 ASP 将文件上传到 SQL 数据库

> ID：650449
> 
> 赞同：3
> 
> 时间：2009-03-16T13:38:08.467
> 
> 标签：sql-server, asp-classic, upload

我正在尝试将文件 (.doc/.pdf) 上传到 SQL 数据库 (2005)，但我真的很难找到任何分步指南。

这是我的 ASP 表单上发生的情况：

*   用户选择一个文档
*   文档当前上传到临时文件并发送到电子邮件地址

但是，它也需要存储在数据库字段中。

我已将数据库中的字段类型设置为 Image。但是当我真正拥有的只是来自用户的文档链接（例如 C://）时，我不确定如何保存二进制数据信息。

我也希望以后能下载这个文件，这也可以吗？

预先感谢您的任何帮助。

谢谢克莱尔

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-04-28T16:51:17.353

当然，使用[freeaspupload](http://www.freeaspupload.net/)上传文件。它很容易使用。上传文件后，您需要二进制读取文件，然后将该二进制流写入您的数据库。该[网站](http://www.chestysoft.com/upload/demo.asp)似乎有一个您正在尝试做的工作示例。查看代码并找出您需要的部分。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-03-23T10:53:12.363

正如之前提到的——在数据库中存储二进制数据通常不是一个好主意。

将文件存储在磁盘上还不够好，其中文档表 id/PK 成为文件名并仅在数据库中存储文件名/id、原始文件名和文件描述？

这将解决您的大部分问题：

*   以简单的方式存储/生成文档链接。

*   轻松下载（只需链接到磁盘上的文件）。

这也防止了快速增长的数据库大小以及编写和维护额外代码来存储、搜索和提供存储在数据库中的文档的问题。

如果您真的只需要一个链接来记录，我认为这是更好的解决方案。

[这](http://support.microsoft.com/kb/299692)是来自 Microsoft 支持站点的 VB6 代码，它将上传的文件保存到 Web 服务器上的文件中。

目前它没有做你想做的事（将上传的文件存储在磁盘上，而不是在数据库中），但我希望修改它不会很难。

祝你好运！

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2009-03-22T13:28:11.047

你不能自己用经典的 ASP 来做这件事，但你可以花 200 美元购买[ASPUpload](http://www.aspupload.com/)来为你做这件事。如果你查看他们的网站，它似乎已经有一段时间没有更新了，但那是因为它们都没有经典的 ASP，呵呵。

早在 2001-2005 年，我自己就用它来用经典的 ASP 上传图像、文档等。它易于使用，易于上手，而且效果很好。太棒了。

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2009-03-16T15:14:26.270

（在数据库中存储二进制数据通常是个坏主意。）

经典 ASP 没有对文件上传的内置支持，因此您需要在服务器上安装上传组件。对于大多数部分，上传组件中包含示例，展示了如何直接上传到数据库中。

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2009-10-23T15:31:32.187

我之前使用过 CodeProject 中的“ [Advanced ASP Uploader](http://www.codeproject.com/KB/asp/aspupl.aspx) ”。这将帮助您将文件发送到服务器。然后，您只需将字节存储在数据库中。

这是否是一个好主意，我将留给其他人，因为[在最近的这个线程中对此](https://stackoverflow.com/questions/3748/storing-images-in-db-yea-or-nay)进行了一些辩论。

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2009-03-22T13:34:30.580

我已成功使用[FreeASPUpload](http://www.freeaspupload.net/)满足您的第一个要求。
我认为一旦找到正确的答案，上传到 SQL 将相当简单。很遗憾，我自己没有这块拼图。

* * *

## 回答 #7

> 赞同：0
> 
> 时间：2009-03-22T13:39:07.777

大约七年前我放弃了使用 ASP，但我记得当时我有一些[纯 ASP 代码](http://lanfear.c0la.se/~emil/asp-upload/)来完成这件事。我链接到的代码正是我在 2001 年的项目中使用它的方式。该类本身不是我编写的，而是在网上某个地方找到的（似乎它附带了一个名为 Sagasnet webstudio 的东西）。这个例子是我的，而这并不是我最近引以为豪的事情。希望能帮助到你。

* * *

## 回答 #8

> 赞同：0
> 
> 时间：2009-10-23T15:22:46.483

这是一个链接，向您展示如何将文件上传到数据库。我有它的工作，现在我只需要弄清楚如何检索它。

[链接文本](http://www.aspne)

# c# - 带有`in`子句的C#参数化查询MySQL

> ID：650455
> 
> 赞同：7
> 
> 时间：2009-03-16T13:40:01.567
> 
> 标签：c#, mysql, parameters

我正在将几个硬编码到应用程序中并动态构建的查询转换为参数化查询。我在处理一个特定查询时遇到问题，该查询有一个`in`子句：

```
UPDATE TABLE_1 SET STATUS = 4 WHERE ID IN (1, 14, 145, 43); 
```

第一个参数很简单，因为它只是一个普通参数：

```
MySqlCommand m = new MySqlCommand("UPDATE TABLE_1 SET STATUS = ? WHERE ID IN (?);");
m.Parameters.Add(new MySqlParameter("", 2)); 
```

但是，第二个参数是一个整数列表，表示需要更新的行的 id。如何为单个参数传入整数列表？或者，您将如何设置此查询，以便您不必在每次调用它时都完全构建它，并且可以防止 SQL 注入攻击？

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2009-03-16T13:49:38.517

这在 MySQL 中是不可能的。您可以创建所需数量的参数并执行 UPDATE ... IN (?,?,?,?)。这可以防止注入攻击（但仍然需要您为每个参数计数重建查询）。

另一种方法是传递一个逗号分隔的字符串并解析它。

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2009-03-16T13:47:21.723

您可以基于（可能）可变数量的参数“即时”构建参数化查询，并对其进行迭代以将它们传入。

所以，像：

```
List foo; // assuming you have a List of items, in reality, it may be a List<int> or a List<myObject> with an id property, etc.

StringBuilder query = new StringBuilder( "UPDATE TABLE_1 SET STATUS = ? WHERE ID IN ( ?")
for( int i = 1; i++; i < foo.Count )
{   // Bit naive 
    query.Append( ", ?" );
}

query.Append( " );" );

MySqlCommand m = new MySqlCommand(query.ToString());
for( int i = 1; i++; i < foo.Count )
{
    m.Parameters.Add(new MySqlParameter(...));
} 
```

* * *

## 回答 #3

> 赞同：3
> 
> 时间：2009-03-16T13:42:27.520

IN 子句不能使用参数。

* * *

## 回答 #4

> 赞同：3
> 
> 时间：2015-12-25T18:04:52.127

老问题，但如果有人通过谷歌遇到这个问题，这就是我使用的：

```
int status = 4;  
string ids = "1,14,145,43";      

m.Parameters.AddWithValue("@Status", status);
m.Parameters.AddWithValue("@IDs", ids);

UPDATE TABLE_1 SET STATUS = @Status WHERE FIND_IN_SET(ID, @IDs) > 0; 
```

注意：FIND_IN_SET 是一个特定于 mySQL 的函数。

信用，信用到期：看到这个问题：[Add List<int> to a mysql parameter](https://stackoverflow.com/questions/5681320/add-listint-to-a-mysql-parameter)

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2009-03-16T13:44:18.670

循环您的整数列表并执行单独的更新。

MSSQL 2008 提供了表值参数来避免这个问题，我不知道 MySQL 中有任何类似的功能。

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2020-05-26T12:46:14.317

从 MySQL 4.0 开始，您可以使用**FIND_IN_SET**函数创建带有“in 子句”的参数化 SQL。

你的代码：

```
UPDATE TABLE_1 SET STATUS = 4 WHERE ID IN (1, 14, 145, 43); 
```

改为使用 FIND_IN_SET：

```
UPDATE TABLE_1 SET STATUS = 4 WHERE FIND_IN_SET(ID, 1, 14, 145, 43); 
```

最后，您可以使用变量来参数化您的查询：

```
var s = "UPDATE TABLE_1 SET STATUS = 4 WHERE FIND_IN_SET(ID, ?)";
var params = "1, 14, 145, 43";

dataSource.Execute(s, params); 
```

请参阅[W3Schools 参考](https://www.w3schools.com/sql/func_mysql_find_in_set.asp)和[MySQL 教程](https://www.mysqltutorial.org/mysql-find_in_set/)

由于**FIND_IN_SET**是一个 MySQL 函数**，它适用于所有语言，而不仅仅是 C#**。

* * *

## 回答 #7

> 赞同：0
> 
> 时间：2021-02-05T05:53:05.810

我最近发现 find_in_set 有多慢，所以我尽量避免它。我也尽量避免构建我的 sql 以帮助防止注入攻击。我发现您可以实现所需的功能并同时使用参数化查询。

```
int[] ids = new int[] { 1, 2, 3};

command.CommandText = @"
  SET @temp = @ids;
  SELECT * FROM table_name WHERE table_name_id IN @temp;
";

command.Parameters.AddWithValue("ids", string.Join(",", ids)); 
```

老问题，但它证实了我的怀疑，我想出了这个解决方法。

* * *

## 回答 #8

> 赞同：-1
> 
> 时间：2009-03-16T13:43:15.337

我建议创建一个函数（假设 mysql 支持用户定义的函数）来分解参数以返回一个表。

# c++ - 我可以对宏使用哪些技巧？

> ID：650461
> 
> 赞同：29
> 
> 时间：2009-03-16T13:42:17.477
> 
> 标签：c++, c, c-preprocessor, stringification

在我们的遗留代码以及现代代码中，我们使用宏来执行漂亮的解决方案，如代码生成等。我们同时使用`#`和`##`运算符。

我很好奇其他开发人员如何使用宏来做很酷的事情，如果他们使用它们的话。

* * *

## 回答 #1

> 赞同：30
> 
> 时间：2009-03-16T14:40:21.813

在 C 中，通常定义宏来执行某些操作以获取逐字参数，同时定义能够透明地获取其地址的函数。

```
// could evaluate at compile time if __builtin_sin gets
// special treatment by the compiler
#define sin(x) __builtin_sin(x)

// parentheses avoid substitution by the macro
double (sin)(double arg) {
    return sin(arg); // uses the macro
}

int main() {
    // uses the macro
    printf("%f\n", sin(3.14));

    // uses the function
    double (*x)(double) = &sin;

    // uses the function
    printf("%f\n", (sin)(3.14));
} 
```

* * *

## 回答 #2

> 赞同：18
> 
> 时间：2009-03-16T14:44:58.293

还有 X Macro 成语可用于 DRY 和简单的代码生成：

一个使用**尚未定义**的宏在标头 gen.x 中定义一种表：

```
/** 1st arg is type , 2nd is field name , 3rd is initial value , 4th is help */
GENX( int , "y" , 1 , "number of ..." );
GENX( float , "z" , 6.3 , "this value sets ..." );
GENX( std::string , "name" , "myname" , "name of ..." ); 
```

然后他可以在不同的地方使用它，为每个#include定义它，通常有不同的定义：

```
class X
{
public :

     void setDefaults()
     {
#define GENX( type , member , value , help )\
         member = value ;
#include "gen.x"
#undef GENX
     }

     void help( std::ostream & o )
     {
#define GENX( type , member , value , help )\
          o << #member << " : " << help << '\n' ;
#include "gen.x"
#undef GENX
     }

private :

#define GENX( type , member , value , help )\
     type member ;
#include "gen.x"
#undef GENX
} 
```

* * *

## 回答 #3

> 赞同：15
> 
> 时间：2009-03-16T13:54:52.763

最酷的宏是：断言、包含守卫、__FILE__、__LINE__。
避免在代码中使用其他宏。

**编辑：**
仅当您没有没有它们的合法解决方案时才使用宏。

* * *

## 回答 #4

> 赞同：14
> 
> 时间：2009-03-16T17:04:08.753

SHOW() 用于调试：

```
#define SHOW(X) cout << # X " = " << (X) << endl 
```

* * *

扩展参数技巧的双重评估：（例如，使用实际的行号而不是“__LINE__”。）

```
 /* Use CONCATENATE_AGAIN to expand the arguments to CONCATENATE */
#define CONCATENATE(      x,y)  CONCATENATE_AGAIN(x,y)
#define CONCATENATE_AGAIN(x,y)  x ## y 
```

* * *

静态编译时断言。
例如：

```
#define CONCATENATE_4(      a,b,c,d)  CONCATENATE_4_AGAIN(a,b,c,d)
#define CONCATENATE_4_AGAIN(a,b,c,d)  a ## b ## c ## d

    /* Creates a typedef that's legal/illegal depending on EXPRESSION.       *
     * Note that IDENTIFIER_TEXT is limited to "[a-zA-Z0-9_]*".              *
     * (This may be replaced by static_assert() in future revisions of C++.) */
#define STATIC_ASSERT( EXPRESSION, IDENTIFIER_TEXT)                     \
  typedef char CONCATENATE_4( static_assert____,      IDENTIFIER_TEXT,  \
                              ____failed_at_line____, __LINE__ )        \
            [ (EXPRESSION) ? 1 : -1 ] 
```

通过以下方式使用：

```
typedef  int32_t  int4;

STATIC_ASSERT( sizeof(int4) == 4, sizeof_int4_equal_4 ); 
```

* * *

初始化类 CodeLocation 的实例：（从调用点存储文件/行/函数——这可以*仅*通过宏或直接访问源点的 __FILE__/__LINE__/etc 宏来完成。）

```
 /* Note:  Windows may have __FUNCTION__.  C99 defines __func__. */
#define CURRENT_CODE_LOCATION()  \
           CodeLocation( __PRETTY_FUNCTION__, __FILE__, __LINE__ ) 
```

* * *

随后被 MESSAGE/WARN/FAIL 宏用作方便的源位置打印机制。例如：

```
#define WARN_IF_NAN(X)                                      \
  do                                                        \
  {                                                         \
    if ( isnan(X) != 0 )                                    \
      WARN( # X " is NaN (Floating Point NOT-A-NUMBER)" );  \
    if ( isinf(X) != 0 )                                    \
      WARN( # X " is INF (Floating Point INFINITY)" );      \
  } while ( false ) 
```

* * *

断言/除非宏。您可以通过宏传递任何标记，包括像“==”这样的运算符。所以构造如下：

```
ASSERT( foo, ==, bar ) 
```

或者

```
UNLESS( foo, >=, 0, value=0; return false; ); 
```

是合法的。Assert/Unless 宏可以自动添加各种有用的信息，例如 CodeLocation、堆栈跟踪或抛出异常/核心转储/优雅退出。

* * *

使 errno 更简单：

```
#define ERRNO_FORMAT  "errno= %d (\"%s\")"
#define ERRNO_ARGS    errno, strerror(errno)
#define ERRNO_STREAM  "errno= " << errno << " (\"" << strerror(errno) << "\") " 
```

例如 printf("打开失败。" ERRNO_FORMAT, ERRNO_ARGS );

* * *

## 回答 #5

> 赞同：12
> 
> 时间：2009-03-16T13:53:34.437

您可以查看[Boost.Preprocessor](http://www.boost.org/doc/libs/1_38_0/libs/preprocessor/doc/index.html)以找到预处理器的许多有趣用途...

* * *

## 回答 #6

> 赞同：9
> 
> 时间：2009-03-16T15:01:16.023

我最喜欢的技巧之一是将可变数量的参数传递给宏，以便稍后用于调用类似 printf 的函数。为此，我指定宏只有一个参数，并在不带 () 的宏主体中使用它，但将所有参数传递给 (( 和 )) 中的宏，因此列表看起来像单个参数。例如，

```
#define TRACE( allargs) do { printf allargs; } while ( 0)
...
TRACE(( "%s %s\n", "Help", "me")); 
```

* * *

## 回答 #7

> 赞同：9
> 
> 时间：2009-03-17T00:58:53.683

我把这个有趣的归功于 Sean Barrett：

```
#ifndef blah
    #define blah(x) // something fun
    #include __FILE__
    #undef blah
#endif

#ifndef blah
    #define blah(x) // something else that is also fun
    #include __FILE__
    #undef blah
#endif

#ifdef blah
    blah(foo)
    blah(bar)
#endif 
```

一种让预处理器根据可以通过宏表达的更高级别结构为您生成代码的 hacky 方法。

* * *

## 回答 #8

> 赞同：7
> 
> 时间：2009-03-16T14:21:59.393

日志是特别经常使用宏的地方之一：

```
#define LOG(log) \
  if (!log.enabled()) {} \
  else log.getStream() << __FILE__ << "@" << __LINE__ << ": "

log_t errorlog;
...

LOG(errorlog) << "This doesn't look good:" << somedata; 
```

* * *

## 回答 #9

> 赞同：7
> 
> 时间：2012-12-09T14:55:56.080

对于嵌入式代码，embeddedgurus.com 的一个很好的技巧[使](http://embeddedgurus.com/barr-code/2009/09/binary-literals-in-c/) 您能够处理二进制值：

```
B8(01010101) // 85
B16(10101010,01010101) // 43,605
B32(10000000,11111111,10101010,01010101) // 2,164,238,93 
```

这实现了与@Ferruccio 先前关于 BOOST_BINARY 的响应类似的目标，尽管有点扩展。

这是代码（复制粘贴，未经测试，请参阅链接了解更多详细信息）

```
// Internal Macros
#define HEX__(n) 0x##n##LU
#define B8__(x) ((x&0x0000000FLU)?1:0) \
  +((x&0x000000F0LU)?2:0) \
  +((x&0x00000F00LU)?4:0) \
  +((x&0x0000F000LU)?8:0) \
  +((x&0x000F0000LU)?16:0) \
  +((x&0x00F00000LU)?32:0) \
  +((x&0x0F000000LU)?64:0) \
  +((x&0xF0000000LU)?128:0)

// User-visible Macros
#define B8(d) ((unsigned char)B8__(HEX__(d)))
#define B16(dmsb,dlsb) (((unsigned short)B8(dmsb)<<8) + B8(dlsb))
#define B32(dmsb,db2,db3,dlsb) \
  (((unsigned long)B8(dmsb)<<24) \
  + ((unsigned long)B8(db2)<<16) \
  + ((unsigned long)B8(db3)<<8) \
  + B8(dlsb)) 
```

我喜欢宏。调试时非常有趣！

* * *

## 回答 #10

> 赞同：6
> 
> 时间：2009-03-16T13:57:27.500

我使用宏的主要地方是在我自己的测试框架中。例如，当我想断言某些代码必须抛出时，我使用这个宏：

```
#define MUST_THROW( expr )                       
  try {                                
    (expr);                              
    (myth_suite_).Fail( #expr +                    
            std::string( " should throw but didn't" ) );  
  }                                  
  catch( ... ) {                            
  } 
```

并像这样使用它：

```
MUST_THROW( some_bogus_stuff() );
MUST_THROW( more_bogus_stuff() ); 
```

我使用它们的唯一其他地方是在类声明中。我有一个宏：

```
#define CANNOT_COPY( cls )              \
  private:                              \
    cls( const cls & );                 \
    void operator=( const cls & )       \ 
```

我用它来指定一个类不能被复制（或分配）：

```
class BankAccount {

    CANNOT_COPY( BankAccount );
    ....
}; 
```

这并没有做任何特别的事情，但会引起人们的注意并且很容易被搜索到。

* * *

## 回答 #11

> 赞同：6
> 
> 时间：2011-10-31T12:36:31.413

使用 C99 可变参数宏构造具有默认值（非零）的字面量

```
struct Example {
   int from;
   int to;
   const char *name;
}

#define EXAMPLE(...) ((struct Example){.from=0, .to=INT_MAX, .name="", __VA_ARGS__}) 
```

using`EXAMPLE(.name="test")`使用默认值，但显式覆盖`name`. 后面提到的同一成员的这种阴影在标准中得到了很好的定义。

* * *

## 回答 #12

> 赞同：5
> 
> 时间：2009-03-16T23:44:36.093

我经常将调试声纳之类的东西包装在一个简单的宏中，允许它从发布版本中编译出来：

```
#ifdef DEBUG
#define D(s) do { s; } while(0)
#else
#define D(s) do {/**/} while(0)
#endif 
```

以后的用法通常是这样的：

```
D(printf("level %d, condition %s\n", level, condition)); 
```

该`do{}while(0)`成语用于避免因意外使用`D(...)`条件或循环的唯一内容而可能导致的问题。毕竟，您不希望这样的代码意味着错误：

```
for(i=1;i<10;++i) D(printf("x[%d]=%f\n",i,x[i]));
SomeReallyExpensiveFunction(x); 
```

如果我能让这种情况抛出一个错误，我会的，但是预处理器本身必须是一个完整的编译器才能告诉`D()`宏是循环体的唯一内容。

我也是编译时断言的忠实粉丝。我的配方略有不同，但与我见过的其他配方相比并没有真正的优势。关键是形成一个唯一命名的 typedef，如果断言条件为假，则抛出错误，否则不抛出错误。在 cassert.h 我们有：

```
/*! \brief Compile-time assertion.
 *
 *  Note that the cassert() macro generates no code, and hence need not
 *  be restricted to debug builds.  It does have the side-effect of
 *  declaring a type name with typedef.  For this reason, a unique
 *  number or string of legal identifier characters must be included
 *  with each invocation to avoid the attempt to redeclare a type.
 *
 *  A failed assertion will attempt to define a type that is an array
 *  of -1 integers, which will throw an error in any standards
 *  compliant compiler. The exact error is implementation defined, but
 *  since the defined type name includes the string "ASSERTION" it
 *  should trigger curiosity enough to lead the user to the assertion
 *  itself.
 *
 *  Because a typedef is used, cassert() may be used inside a function,
 *  class or struct definition as well as at file scope.
 */
#define cassert(x,i) typedef int ASSERTION_##i[(x)?1:-1] 
```

在某些源文件中，任何 typedef 都是合法的：

```
#include "cassert.h"
...
cassert(sizeof(struct foo)==14, foo1);
... 
```

生成的错误消息通常是模糊的，但将包含标识符片段，使违规行能够被蛮力发现。

我一直在编写代码生成实用程序可能是首选答案的地方使用预处理器而感到内疚，就像另一个答案中的代码根据枚举成员名称的唯一部分生成大量样板。这在编写大量要在 C 中编译的消息调度胶水时特别方便。

* * *

## 回答 #13

> 赞同：3
> 
> 时间：2009-03-16T13:47:48.757

从 CrashRpt 项目中，需要技巧来扩大宏并定义：

```
#define WIDEN2(x) L ## x 
#define WIDEN(x) WIDEN2(x)
std::wstring BuildDate = std::wstring(WIDEN(__DATE__)) + L" " + WIDEN(__TIME__); 
```

* * *

## 回答 #14

> 赞同：3
> 
> 时间：2009-03-16T21:25:35.833

可以简化重复的事情，即。枚举列表

```
enum {
  kOneEnum,
  kTwoEnum,
  kThreeEnum,
  kFourEnum
}; 
```

...然后以结构化方式进行切换案例

```
#define TEST( _v ) \
    case k ## _v ## Enum: \
      CallFunction ## _v(); \
      break;

switch (c) {
    TEST( One   );
    TEST( Two   );
    TEST( Three );
    TEST( Four  );
} 
```

*注意：*当然这可以通过函数指针数组来完成，但这会带来更多的灵活性来添加参数，并且还可以使用带有单个哈希的字符串扩展。

...或测试字符串以获得正确的枚举值

```
int value = -1;
char *str = getstr();

#define TEST( _v ) \
    if (!strcmp(# _v, str)) \
        value = k ## _v ## Enum

TEST( One   );
TEST( Two   );
TEST( Three );
TEST( Four  ); 
```

* * *

## 回答 #15

> 赞同：3
> 
> 时间：2011-10-31T15:26:06.037

您可以使用宏来定义具有不同数据类型的相同功能。例如：

```
#include <stdio.h>
#include <stdlib.h>
#include <limits.h>
#include <string.h>

#define DEFINE_BITS_STR(name, type)               \
char *bits_str_##name(type value)                 \
{                                                 \
    int len = sizeof(type) * CHAR_BIT;            \
    char *result;                                 \
    type n;                                       \
    int i;                                        \
                                                  \
    result = (char *)calloc(len+1, sizeof(type)); \
    if(result == NULL)                            \
        return NULL;                              \
                                                  \
    memset(result, '0', len);                     \
    result[len] = 0x00;                           \
                                                  \
    n = value;                                    \
    i = len;                                      \
    while(n)                                      \
    {                                             \
        if(n & 1)                                 \
            result[i] = '1';                      \
                                                  \
        n >>= 1;                                  \
        --i;                                      \
    }                                             \
                                                  \
    return result;                                \
}

DEFINE_BITS_STR(uchar, unsigned char)
DEFINE_BITS_STR(uint, unsigned int)
DEFINE_BITS_STR(int, unsigned int)

int main()
{
    unsigned char value1 = 134;
    unsigned int value2 = 232899;
    int value3 = 255;
    char *ret;

    ret = bits_str_uchar(value1);
    printf("%d: %s\n", value1, ret);

    ret = bits_str_uint(value2);
    printf("%d: %s\n", value2, ret);

    ret = bits_str_int(value3);
    printf("%d: %s\n", value3, ret);

    return 1;
} 
```

在这个例子中，定义了三个函数（`bits_str_uchar()`, `bits_str_uint()`, `bits_str_int()`）来处理三种不同的数据类型（`unsigned char`, `unsigned int`, `int`）。但是，所有都返回一个字符串，其中包含传递的值的位。

* * *

## 回答 #16

> 赞同：2
> 
> 时间：2009-03-16T13:49:41.793

当您实现 COM 服务器时，您必须注意代码可能抛出的所有异常——让异常通过 COM 方法边界通常会使调用应用程序崩溃。

方法括号对此很有用。有一个左括号是一个包含“try”的宏和一个包含一组“catch”的右括号，将异常包装到 ErrorInfo 并产生 HRESULT。

* * *

## 回答 #17

> 赞同：1
> 
> 时间：2009-03-16T13:59:39.273

大多数（全部？）C++ 单元测试框架都是基于宏构建的。我们使用[UnitTest++](https://github.com/unittest-cpp/unittest-cpp)。查看它以查看各种精美的宏。

* * *

## 回答 #18

> 赞同：1
> 
> 时间：2009-03-16T14:00:58.867

BOOST_BINARY宏执行一些 clevel 预处理器技巧，使 C++ 能够以二进制形式表示数字常量[。](http://www.boost.org/doc/libs/1_38_0/libs/utility/utility.htm#BOOST_BINARY)但是，它仅限于 0-255。

* * *

## 回答 #19

> 赞同：1
> 
> 时间：2009-10-30T08:52:25.077

在微控制器上，通常使用 UART 调试代码，因为硬件断点有很多缺点。

这是一个简单的宏，已被证明非常有用：

```
#define DEBUG_OUT(value) sprintf(uartTxBuf, "%s = 0x%04X\n", #value, value);\
                         puts_UART((uint16_t *) uartTxBuf) 
```

使用示例：

```
for (i=0; i < 4; i++)
{
    DEBUG_OUT(i);
    DEBUG_OUT(i % 3);
} 
```

接收流：

```
i = 0x0000
i % 3 = 0x0000
i = 0x0001
i % 3 = 0x0001
i = 0x0002
i % 3 = 0x0002
i = 0x0003
i % 3 = 0x0000 
```

是的，它很粗糙而且不安全。它只在错误被隔离之前应用，所以这个宏没有害处。

* * *

## 回答 #20

> 赞同：0
> 
> 时间：2009-03-16T14:07:25.230

[pthreads 实用程序宏](http://math.arizona.edu/~swig/documentation/pthreads/pt.h)特别令人印象深刻，恕我直言。

* * *

## 回答 #21

> 赞同：0
> 
> 时间：2009-03-16T14:11:40.353

当我处理像 3GPP RRC/NBAP/RNSAP 那样的大型 c/c++ 嵌套结构时，我会遵循这个技巧来使代码看起来干净。

```
struct leve1_1
{
  int data;

  struct level2
  {
    int data;

    struct level3
    {
      int data;
    } level_3_data;

  } level_2_data;

} level_1_data;

level_1_data.data = 100;

#define LEVEL_2 leve1_1_data.level_2_data
LEVEL_2.data = 200;

#define LEVEL_3 LEVEL_2.level_3_data
LEVEL_3.data = 300;

#undef LEVEL_2
#undef LEVEL_3 
```

这将使维护期间的生活更轻松..也在设计时和代码将是可读的。

* * *

## 回答 #22

> 赞同：0
> 
> 时间：2009-03-16T20:50:46.993

将它们转换为语言结构以提高类型安全性和调试能力。

* * *

## 回答 #23

> 赞同：0
> 
> 时间：2009-08-28T08:41:08.897

```
void _zero_or_die(int v, const char* filename, int line)
{
    if (v != 0)
    {
       fprintf(stderr, "error %s:%d\n", filename, line);
       exit(1);
    }
}

#define ZERO_OR_DIE_ for (int _i=1; _i == 1; _zero_or_die(_i, __FILE__, __LINE__)) _i=

ZERO_OR_DIE_   pipe(fd);
ZERO_OR_DIE_   close(0);
ZERO_OR_DIE_   sigaction(SIGSEGV, &sigact, NULL);
ZERO_OR_DIE_   pthread_mutex_lock(&mt);
ZERO_OR_DIE_   pthread_create(&pt, NULL, func, NULL); 
```

* * *

## 回答 #24

> 赞同：0
> 
> 时间：2012-11-02T21:20:03.793

我经常用这个。我有一个`debug.h`标题定义如下：

```
#ifndef DEBUG_H
#define DEBUG_H
    #ifdef DEBUG
    #define debuf if(1)
    #else
    #define debug if(0)
    #endif
#endif 
```

进而：

```
debug {
   printf("message from debug!");
} 
```

如果你想得到`"message from debug!"`消息，编译：

```
gcc -D DEBUG foo.c 
```

否则，什么都不会发生。Gcc 是一个非常聪明的编译器。如果`DEBUG`未定义，则生成的`if(0)`（死代码）将从您的代码中删除，并进行一些优化。

你仍然可以做更多：

```
debug 
{
   pritnf("I'm in debug mode!\n");
} 
else 
{
  printf("I'm not in debug mode\n");
} 
```

几天前，我看到[D 编程语言](http://dlang.org/index.html)也提供了一个非常相似的功能。

如果您在没有上下文的情况下认为上述内容，则可以将认为定义为

```
#define in_debug if(1)
#define not_debug else 
```

进而

```
in_debug {
  printf("I'm in debug mode!");
}
not_debug {
  printf("Not in debug mode!");
} 
```

* * *

## 回答 #25

> 赞同：-1
> 
> 时间：2013-06-20T10:42:28.700

在宏中，很容易**做控制流**，因为它只是文本替换。这是一个带有 for 循环的示例：

```
#include <stdio.h>

#define loop(i,x) for(i=0; i<x; i++)

int main(int argc, char *argv[])
{
    int i;
    int x = 5;
    loop(i, x)
    {
        printf("%d", i); // Output: 01234
    } 
    return 0;
} 
```

# jquery - Jquery包含AJAX？想法？

> ID：650464
> 
> 赞同：1
> 
> 时间：2009-03-16T13:42:46.210
> 
> 标签：jquery, ajax

随着 .NET 4.0 的出现，MS AJAX 是否仍有一席之地，或者您认为 JQuery 是否会扩展到包含 AJAX 的全部功能，并使我们所知的 MS AJAX 变得多余？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-03-16T15:12:03.563

请记住，ASP.NET AJAX 由客户端 JavaScript 库 (MicrosoftAjax.js)**和**System.Web.Extensions 中的服务器端组件组成。jQuery 的包含可能根本不会影响 ASP.NET AJAX 的服务器端部分。

在客户端，jQuery 几乎可以做 MicrosoftAjax.js 今天可以做的所有事情。MS AJAX 使调用 ASMX/WCF Web 服务更容易一些（代价是客户端占用更大的空间），但[jQuery 也可以调用 ASP.NET AJAX 服务](http://encosia.com/2008/03/27/using-jquery-to-consume-aspnet-json-web-services/)。

根据迄今为止我们在 CodePlex 预览中看到的情况，微软似乎专注于客户端模板、与 ADO.NET 数据服务的客户端-服务器集成、客户端模板中数据的两种“实时绑定” ，以及其他类似的东西。基本上，专注于 jQuery 没有解决的特定于 .NET 的客户端问题。

所以，为了回答你的问题，我认为 jQuery 的使用可能会扩展到 ASP.NET AJAX 的*客户端*库目前占据的大部分领域，但是 ASP.NET AJAX 的客户端库将发展成为 jQuery 的其他有用的东西不提供。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-03-16T14:04:12.197

来自[Scott Guthrie 的博客](http://weblogs.asp.net/scottgu/archive/2008/09/28/jquery-and-microsoft.aspx)：

> 展望未来，我们将使用 jQuery 作为库之一，用于在 ASP.NET AJAX 控件工具包中实现更高级别的控件，以及为 ASP.NET MVC 实现新的 Ajax 服务器端帮助器方法。我们添加到 ASP.NET AJAX 的新功能（如新的客户端模板支持）也将被设计为与 jQuery 很好地集成。

因此，在我看来，MS AJAX 在客户端呈现 javascript 时将开始使用和使用 JQuery。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2009-03-16T14:08:40.203

根据我目前听到的情况，ASP.NET AJAX 库中的任何内容都不会被 jQuery 取代。微软只会将 jQuery 库添加到发行版中。基本上，您将拥有与今天相同的选项，而无需额外下载 jQuery 库。

关于 ASP.NET 和 ASP.NET AJAX 的未来，已经有一些公告。查看以下第 9 频道视频：

[10-4 第 8 集：使用 ASP.NET AJAX 4.0 进行纯客户端开发](http://channel9.msdn.com/shows/10-4/10-4-Episode-8-ASPNET-AJAX-40/)

[Stephen Walther - ASP.NET 4.0 的新特性](http://channel9.msdn.com/shows/The+Knowledge+Chamber/Stephen-Walther-New-Features-of-ASPNET-40/)

在技​​术的使用方面，我认为人们在进行客户端服务调用时会坚持使用 ASP.NET AJAX。这要容易得多。我认为人们也会采用客户端模板。里面有一些很酷的东西。许多其余的客户端编程（例如事件处理和 DOM 操作）将使用 jQuery 完成。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2009-03-16T13:47:53.763

我确信 MS 仍然会支持 Asp.Net Ajax（我祈祷他们做一些重大改进），但我认为在 Visual Studio 中包含 JQuery 是一个强烈的迹象，我只是不知道是什么*。*也许参加过 PDC '08 的人可以告诉我们 MS 在哪里采用 Asp.Net Ajax。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2009-03-16T14:01:49.283

jQuery 是关于 DOM 的。所以在这方面，我想 MicrosoftAjax.js 中所有与 DOM 相关的代码都将更改为简单地指向 jQuery 等价物。例如：

```
Sys.UI.DomEvent.addHandler = function(element, eventName, handler) {
    jQuery(element).bind(eventName, handler)
}

Sys.UI.DomElement.getLocation = function(element) {
    var jPos = jQuery(element).offset();
    return new Sys.UI.Point(jPos.left, jPot.top)
} 
```

然而，与“框架”相关的所有其他内容可能会保留：`Sys.Component`、`Sys.Net.WebServiceProxy`、`Date.format()`、`Enum`s `Type.registerClass()`（以及一般的类继承）、`Function.createDelegate()`、`pageLoad()`，并且列表还在继续。

# sql - SQL 2000 表名作为存储过程中的变量

> ID：650465
> 
> 赞同：0
> 
> 时间：2009-03-16T13:43:06.257
> 
> 标签：sql, stored-procedures, parameters, dynamic-sql, tablename

表名：
RM_master

字段：
cust_no
acct_no
acct_code

问题是，我想让表 RM_master 作为存储过程中的参数中的变量？

这没有语法错误，但是当我通过右键单击存储过程名称在查询分析器中执行此操作时，未识别变量表名称（RM_master）
这是我的存储过程；

```
CREATE PROCEDURE RMQUERY

  @cusnumber  nvarchar (255) = '' ,
  @acctnumber nvarchar (255) = '' ,
  @master nvarchar (255) = ''

AS

BEGIN

SET @CUSNUMBER = @CUSNUMBER
DECLARE @RMRM AS NVARCHAR (255)
SET @RMRM =n'SELECT * FROM' + @MASTER + 'WHERE ACCT_NO =' + @ACCTNUMBER

EXEC RMQUERY2 
END 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-03-16T13:56:53.710

不建议这样做，因为您只是在存储过程中创建动态 sql。这会打开 sql 注入后门，因为您不了解输入创建的 sql：参数值本身不应用作查询元素，而只能用作查询中的值（可以动态创建，但始终应使用参数）。

尽管如果必须，您应该使用外部存储的 proc sp_executesql 并将 sql 提供给该 proc。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-03-16T13:57:40.947

您没有为@master 赋值。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-03-16T14:15:00.563

您可能需要在表名前后添加空格，否则它将如下所示：

```
SELECT * FROMTABLENAMEWHERE ACCT_NO =0 
```

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2009-03-16T14:49:28.547

在动态 sql 查询中，“FROM”和“WHERE”之间需要一个空格

代替

```
SET @RMRM =n'SELECT * FROM' + @MASTER + 'WHERE ACCT_NO =' + @ACCTNUMBER 
```

你应该做

```
SET @RMRM = N'SELECT * FROM ' + @MASTER + N' WHERE ACCT_NO =' + @ACCTNUMBER 
```

# c - 如何使用 fprintf 并写入管道？

> ID：650468
> 
> 赞同：8
> 
> 时间：2009-03-16T13:43:31.327
> 
> 标签：c, pipe, system, printf

我创建了一个管道，并使用 dup2() 将流 1 和 2（stdout 和 stderr）覆盖到这些管道中。

现在我希望使用 fprintf 写入流 1 或 2，但我的程序似乎没有在管道的另一侧接收任何内容。我试过使用 printf()，但我不确定这是否默认写入标准输出或流 1。如果它写入流 1，我猜它是我代码中某个更深的地方的问题。

本质上我是在问，给定一个表示流的 int，我怎样才能获得适合在 fprintf() 中使用的 FILE*？

* * *

## 回答 #1

> 赞同：8
> 
> 时间：2009-03-16T13:47:28.383

如果你有一个文件描述符并且想要一个`FILE*`，你可以使用`fdopen`

```
FILE *fdopen(int fd, const char *mode); 
```

[`fdopen`](http://www.opengroup.org/onlinepubs/9699919799/functions/fdopen.html)是一个 Posix 函数，并记录在`man fdopen`. 要反过来，您可以使用[`fileno`](http://www.opengroup.org/onlinepubs/9699919799/functions/fileno.html)

# matlab - 检查每个像素的特定颜色（在某个阈值内）

> ID：650472
> 
> 赞同：2
> 
> 时间：2009-03-16T13:44:30.997
> 
> 标签：matlab, image-processing, colors, rgb

我在 MATLAB 中有一个 RGB 图像，我想遍历每个像素并检查它是否是肤色（ish）[我可能会在稍后的时间点在 HSV 空间中执行它以消除照明等的影响]

有谁知道做到这一点的最佳方法？MATLAB 奇怪的语法让我有点困惑！

目前我有：

```
for x = 1:size(I,1)
    for y = 1:size(I,2)
            %Get the value from this x,y coordinate and check the colour.
    end
end 
```

但我认为这是非常错误的。

如何正确访问矩阵的不同部分？

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2009-03-16T13:53:25.530

埃德，

您不需要循环：

```
>> a  = magic(5)

a =

    17    24     1     8    15
    23     5     7    14    16
     4     6    13    20    22
    10    12    19    21     3
    11    18    25     2     9

>> vi = (a > 5) & (a < 10)

vi =

     0     0     0     1     0
     0     0     1     0     0
     0     1     0     0     0
     0     0     0     0     0
     0     0     0     0     1 
```

您可以看到如何为 RGB 等扩展此语句。我会做一个功能

* * *

函数输出 = isFlesh(in)

%% 在这里放肉检查代码

* * *

我怀疑你会想要一系列这些（isCaucasian、isAsian 等......）问题是肉色的范围很广，所以你要检查与邻居的接近度相似的颜色范围。

这部分问题很简单，但更大的问题却充满了危险。

-道格

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2009-03-16T14:07:21.097

要记住的一件事是 RGB 图像是 3-D 矩阵。第一个“页面”（即**A(:,:,1)**）是红色的，第二个是绿色的，第三个是蓝色的。有时我发现通过将 RGB 矩阵重新整形为 N×3 矩阵更容易操作，其中所有红色像素在第 1 列，绿色在第 2 列，蓝色在第 3 列。这是如何做到的：

```
A = (a 3-D RGB image);
matSize = size(A);
A = reshape(A,prod(matSize(1:2)),3);
...
% Modify or extract data from reshaped matrix
...
A = reshape(A,matSize);  % Return A to original dimensions 
```

不确定这是否会具体帮助您完成您想做的事情，但我经常发现它很有用。

* * *

## 回答 #3

> 赞同：3
> 
> 时间：2009-03-17T20:50:01.487

对每个通道进行阈值化并不是一种非常可靠的肤色检测方法。一个简单的查找表效果更好。查找表将为每种颜色记录一个值，它是皮肤的可能性有多大。您可以使用各种肤色数据集来获取这些值。然后您可以将像素的颜色与表中的值进行比较，并根据阈值进行决策。

# java - 将 servlet 自动部署到 glassfish 后出现 404

> ID：650479
> 
> 赞同：0
> 
> 时间：2009-03-16T13:46:58.447
> 
> 标签：java, servlets, glassfish

我尝试将我创建的 servlet 部署到 Glassfish 应用程序服务器，但我似乎遇到了一些绊脚石。代码可以很好地部署到自动部署文件夹，一旦部署，以下内容将写入日志文件：

```
[#|2009-03-16T13:41:29.303+0000|INFO|sun-appserver2.1|javax.enterprise.system.tools.deployment|_ThreadID=23;_ThreadName=Timer-7;|[AutoDeploy] Selecting file /opt/glassfish-2.1.b60e/domains/imageTransformer/autodeploy/image-transformer.war for autodeployment.|#]

[#|2009-03-16T13:41:29.304+0000|INFO|sun-appserver2.1|javax.enterprise.system.tools.deployment|_ThreadID=23;_ThreadName=Timer-7;|Autoundeploying application :image-transformer|#]

[#|2009-03-16T13:41:29.360+0000|INFO|sun-appserver2.1|javax.enterprise.system.stream.out|_ThreadID=23;_ThreadName=Timer-7;|
classLoader = WebappClassLoader
  delegate: true
  repositories:
    /WEB-INF/classes/
----------> Parent Classloader:
EJBClassLoader : 
urlSet = []
doneCalled = false 
 Parent -> java.net.URLClassLoader@39cf701c

|#]

[#|2009-03-16T13:41:29.361+0000|INFO|sun-appserver2.1|javax.enterprise.system.stream.out|_ThreadID=23;_ThreadName=Timer-7;|
SharedSecrets.getJavaNetAccess()=java.net.URLClassLoader$7@5e7408d9|#]

[#|2009-03-16T13:41:29.487+0000|INFO|sun-appserver2.1|javax.enterprise.system.tools.deployment|_ThreadID=23;_ThreadName=Timer-7;|[AutoDeploy] Successfully autoundeployed : /opt/glassfish-2.1.b60e/domains/imageTransformer/autodeploy/image-transformer.war.|#]

[#|2009-03-16T13:41:29.612+0000|INFO|sun-appserver2.1|javax.enterprise.system.tools.deployment|_ThreadID=23;_ThreadName=Timer-7;|deployed with moduleid = image-transformer|#]

[#|2009-03-16T13:41:29.783+0000|INFO|sun-appserver2.1|javax.enterprise.system.tools.deployment|_ThreadID=23;_ThreadName=Timer-7;|[AutoDeploy] Successfully autodeployed : /opt/glassfish-2.1.b60e/domains/imageTransformer/autodeploy/image-transformer.war.|#] 
```

所以没有明显的错误，但在那之后我从访问 servlet 应该绑定到的路径中得到一个 404。我还需要完成另一个步骤吗？

我的 WAR 文件中的 web.xml 如下所示：

```
<web-app>
     <servlet>
       <servlet-name>MyServlet</servlet-name>
         <servlet-class>my.servlet.MyServlet</servlet-class>
     </servlet>

    <servlet-mapping>
        <servlet-name>MyServlet</servlet-name>
        <url-pattern>/hello</url-pattern>
    </servlet-mapping>
 </web-app> 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-03-16T17:42:11.783

此部署存在一些问题。首先，需要在目录中包含第二个配置文件`WEB-INF`，名为`sun-web.xml`. 它的内容需要类似于以下内容：

```
<?xml version="1.0" encoding="UTF-8"?>
<!DOCTYPE sun-web-app PUBLIC "-//Sun Microsystems, Inc.//DTD Application Server 8.1 Servlet 2.4//EN" "http://www.sun.com/software/appserver/dtds/sun-web-app_2_4-1.dtd">
<sun-web-app error-url="">
    <context-root>/MyServlet </context-root>
</sun-web-app> 
```

它似乎有可能变得比这更复杂（参见[文档](http://docs.sun.com/app/docs/doc/819-2634/6n4tl5kp3?a=view#gchwx)）。

其次，我不得不更改`web.xml`文件的标题，因此它相应地读取：

```
<?xml version="1.0" encoding="UTF-8"?>
<web-app xmlns="http://java.sun.com/xml/ns/j2ee"
        xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance"
        xsi:schemaLocation="http://java.sun.com/xml/ns/j2ee
        http://java.sun.com/xml/ns/j2ee/web-app_2_4.xsd"
        version="2.4">
    <servlet>
        <servlet-name>MyServlet</servlet-name>
        <servlet-class>my.servlet.MyServlet</servlet-class>
    </servlet>

    <servlet-mapping>
        <servlet-name>MyServlet</servlet-name>
        <url-pattern>/hello</url-pattern>
    </servlet-mapping>
</web-app> 
```

注意表明这是 servlet 规范 2.4 的标题。

最后，好像也不能直接访问这个servlet；您必须`MyServlet/`在路径的开头添加（或特定于 servlet 的名称）。所以要访问这个 servlet 需要你访问`/MyServlet/hello`.

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2015-05-08T03:19:25.453

我修改了 web.xml；我只是为 ords 添加了配置目录的完整路径。

```
<display-name>Oracle Application Express Listener</display-name>
<context-param>
    <param-name>config.dir</param-name>
    <!-- Enter the location where configuration settings should be stored -->
    <param-value>/odata/apps/ords/config</param-value>
</context-param> 
```

无论 sun-web.xml 是否存在，它都有效。

# sql - 从 SQLite 中的 DATETIME 获取月份

> ID：650480
> 
> 赞同：30
> 
> 时间：2009-03-16T13:47:03.360
> 
> 标签：sql, sqlite

我正在尝试从`DATETIME`SQLite 的字段中提取月份。`month(dateField)`不如`strftime('%m', dateStart)`.

有任何想法吗？

* * *

## 回答 #1

> 赞同：40
> 
> 时间：2009-03-16T13:55:22.373

我不明白，答案在你的问题中：

```
select strftime('%m', dateField) as Month ... 
```

* * *

## 回答 #2

> 赞同：22
> 
> 时间：2009-03-16T14:00:17.680

```
SELECT strftime('%m', datefield) FROM table 
```

如果您正在搜索月份名称，SQLite 的核心发行版似乎不支持文本月份名称

* * *

## 回答 #3

> 赞同：13
> 
> 时间：2010-09-13T09:52:28.030

我猜你想把月份作为一个字符串。不是最友好的外观，但您可能明白这一点。只需将 date('now') 替换为您的变量即可。

```
select case strftime('%m', date('now')) when '01' then 'January' when '02' then 'Febuary' when '03' then 'March' when '04' then 'April' when '05' then 'May' when '06' then 'June' when '07' then 'July' when '08' then 'August' when '09' then 'September' when '10' then 'October' when '11' then 'November' when '12' then 'December' else '' end
as month 
```

* * *

## 回答 #4

> 赞同：13
> 
> 时间：2012-11-13T13:03:09.007

尝试使用以下内容：

```
select strftime('%m', datetime(datefield, 'unixepoch')) as month from table 
```

* * *

## 回答 #5

> 赞同：3
> 
> 时间：2020-01-14T20:17:09.133

这是一个没有所有 case when 语句的解决方案。希望它会有所帮助。

```
select substr('JanFebMarAprMayJunJulAugSepOctNovDec', 1 + 3*strftime('%m', date('now')), -3) 
```

* * *

## 回答 #6

> 赞同：2
> 
> 时间：2019-09-10T17:48:15.553

我猜`strftime('%m', dateStart)`对你不起作用，因为 dateStart 变量是日期/日期时间类型。

然后你必须使用：

```
strftime('%m', date(dateStart)) 
```

* * *

## 回答 #7

> 赞同：1
> 
> 时间：2021-05-04T15:10:12.463

这么多年过去了，我想我明白你的问题是什么了。您可能将日期存储为字符串。这样，当您从假设中搜索数据时，您应该像这样编写 sql：

`Select * from table where strftime('%m', datefield) = '05'`

写“05”而不是“5”很重要。使用“5”会给你零结果。

* * *

## 回答 #8

> 赞同：0
> 
> 时间：2020-01-15T22:56:47.570

这是对我有用的解决方案

```
MONTH_DICT={ "Jan" : '01', "Feb" : '02', "Mar" : '03', "Apr" : '04', "May" : '05', "Jun" : '06', "Jul" : '07', "Aug" : '08', "Sep" : '09', "Oct" : 10, "Nov" : 11, "Dec" : 12 }

self.cursor.execute("SELECT * FROM error_log WHERE strftime('%m',Date_column)=?",(MONTH_DICT[query_month],)) 

print('output:', self.cursor.fetchall()) 
```

* * *

## 回答 #9

> 赞同：-3
> 
> 时间：2021-04-29T05:23:09.787

SELECT strftime('%m',datetime_col) as "Month" FROM table_name;

只需将 'datetime_col' 替换为您的日期时间列

# colors - Colorjack - 你如何使用它？

> ID：650482
> 
> 赞同：2
> 
> 时间：2009-03-16T13:47:21.830
> 
> 标签：colors

有人用colorjack吗？前几天这里有人提到它，所以我检查了一下。这是一个非常漂亮的工具，但我很难弄清楚它是如何使用的？

[http://www.colorjack.com/sphere/](http://www.colorjack.com/sphere/)

我使用 asp.net 进行所有 Web 开发，我的优势在于后端编程，但我很想加强我的设计技能，看起来 colorjack 可能会有所帮助，但我不明白它应该如何最好用过...网站上的指导很少。

你用它吗？在什么阶段？它如何适合您的网页设计工具箱？

编辑：如果不是 colorjack，但您使用另一个类似的工具，同样的问题适用 - 它适合哪里？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-03-16T14:03:59.000

Colorjack 是一个配色方案生成器。

如果您想快速为您的用户界面找到一个漂亮的配色方案，这很有用。它基于色彩理论：方案可以是类比的、互补的、三色的、四色的等等......

它还具有有用的功能来模拟具有某些视图限制（红眼、红眼等）的人如何看到生成的配色方案。

它使您能够以与 illustrator、photoshop 和其他图形设计师程序兼容的格式导出您的配色方案。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-03-16T14:03:59.873

colorjack 等工具用于帮助您为设计选择配色方案。[基于色彩理论](http://en.wikipedia.org/wiki/Color_theory)的不同方面，人们设计了许多方法来挑选一组看起来不错的颜色。我在 Colorjack 博客上找到了这篇简短的[文章](http://www.colorjack.com/articles/color_formulas.html)，其中描述了您可以选择配色方案的一些方法以及每种方法的相对优点。

您通常使用此类工具生成的配色方案作为起点，但最终可能会根据您的特定需求对其进行自定义或调整。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2009-03-17T21:24:15.913

[COLOURlovers](http://www.colourlovers.com/)也是一个很好的资源。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2009-03-17T00:41:54.020

[Adobe 有一个名为Kuler](http://kuler.adobe.com)的非常相似的 Flash/Flex 版本。

# sql-server - SQL Server 2000+ 事务连接是否依赖？

> ID：650489
> 
> 赞同：0
> 
> 时间：2009-03-16T13:48:36.337
> 
> 标签：sql-server, connection, transactions

情况1：

1.  我开始连接到数据库

2.  我开始交易

3.  我关闭连接

    交易会发生什么？

案例二：

1.  我开始连接到数据库

2.  我开始交易

3.  我开始到同一个数据库的并发连接

4.  通过第二个连接，我修改了表格的内容

5.  通过第一个连接，我回滚了事务

    修改会发生什么？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-03-16T13:53:15.687

案例一：回滚

情况2：在第4步，你不能修改第一个连接接触的行，所以没有效果：第二个连接不能修改，它会等待（由于锁）。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-03-17T17:45:44.510

只是要补充一点：交易取决于会话 - 这解释了您的第一个问题。

# ms-access - MS Access 不支持连接表达式吗？

> ID：650490
> 
> 赞同：4
> 
> 时间：2009-03-16T13:49:17.600
> 
> 标签：ms-access, join

谁能向我解释我的查询有什么问题？

```
SELECT T2.TIPOPRODUTO
    , T2.PRODUTO
    , T1.ESPESSURA
    , '' AS LARGURA
    , '' AS COMPRIMENTO
    , '' AS [ACABAM REVEST]
    , '' AS [ESPECIF QUALIDADE]
    , T1.CÓDIGORASTREABILIDADE
    , T3.DATA
    , T4.NOMEFANTASIA
    , T7.NOME
    , T5.DT_INICIO_RESERVA
    , T1.PESO
    , T5.DT_FIM_RESERVA
    , '' AS DESTINO
    , T3.OBSERVAÇÃO
    , '' AS [CUSTO TOTAL]
FROM ([TABELA DE PRODUTOS/ESTOQUE] LEFT OUTER JOIN [TABELA DE PRODUTOS] ON ([TABELA DE PRODUTOS/ESTOQUE].PRODUTO=[TABELA DE PRODUTOS].ID))
, [TABELA DE PRODUTOS/ESTOQUE ] AS T1
    , [TABELA DE PRODUTOS] AS T2
    , [TABELA DE MOVIMENTAÇÃO DE ESTOQUE] AS T3
    , [TABELA DE FORNECEDORES] AS T4
    , RESERVAS_PRODUTOS_ESTOQUE AS T5
, [TABELA DE MOVIMENTAÇÃO DE PRODUTOS/ESTOQUE] AS T6
    , [TABELA DE USUÁRIOS] AS T7
    , [TABELA DE PEDIDOS DE COMPRA] AS T8
WHERE (((T1.Produto)=[T2].[ID]) 
    AND ((T1.ID)=[T5].[ID_PRODUTO_ESTOQUE]) 
    AND ((T5.id_vendedor)=[T7].[ID]) 
    AND ((T3.ID)=[T6].[ID]) 
    AND ((T2.ID)=[T6].[PRODUTO]) 
    AND ((T4.ID)=[T8].[FORNECEDOR]) 
    AND ((T8.Comprador)=[T7].[ID])); 
```

我最好的猜测是它在这条线上失败了：

```
([TABELA DE PRODUTOS/ESTOQUE] LEFT OUTER JOIN [TABELA DE PRODUTOS] ON ([TABELA DE PRODUTOS/ESTOQUE].PRODUTO=[TABELA DE PRODUTOS].ID)) 
```

* * *

## 回答 #1

> 赞同：8
> 
> 时间：2009-03-16T15:12:03.280

您将连接语句与“经典连接”（在 where 语句中带有条件的表的逗号分隔列表）混合在一起，我认为这是不允许的。

将查询更改为仅使用连接语句。在 Access 中，您必须使用括号对联接进行配对，方式如下：

```
from (((t1 join t2 on ...) join t3 on ...) join t4 on ...) 
```

# unit-testing - 使用“传统”记录/重播与最小起订量模型进行模拟

> ID：650494
> 
> 赞同：10
> 
> 时间：2009-03-16T13:50:06.723
> 
> 标签：unit-testing, mocking, moq

我是模拟新手，正在决定一个模拟框架。起订[量家庭](http://code.google.com/p/moq/)报价

> 目前，它是唯一一个与所有其他框架的通用且有些不直观（尤其是对于新手）记录/回复方法背道而驰的模拟库。

谁能简单地解释一下记录/重播方法是什么以及起订量有何不同？从决定框架的角度来看，每种方法的优缺点是什么？

谢谢。

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2009-03-16T14:45:53.937

[RhinoMocks](http://ayende.com/projects/rhino-mocks.aspx)支持 Record/Replay 方法。基本思想是你的测试执行分为两个阶段，记录阶段和回放阶段。更具体一点

```
var repo = new MockRepository();
var dependency = repo.DynamicMock<IDependency>();
With.Mocks(repo).Expecting(delegate {
         Expect.Call(dependency.AMethod(1)).Return(result);                    
      }).Verify(delegate {
         var sut = new Sut(wrappee);
         sut.DoStuffThatCallsAMethod();
         Assert.IsTrue(sut.ResultState);
      }); 
```

所以 Expecting 块是 Record 阶段，Verify 块是 Replay 阶段。

此代码的 Moq 变体将是

```
var dependency = new Mock<IDependency>();
dependency.Expect(dep => dep.AMethod(1)).Returns(result);          
var sut = new Sut(wrappee.Object);
sut.DoStuffThatCallsAMethod();
Assert.IsTrue(sut.ResultState); 
```

如您所见，阅读起来要好得多。我曾经使用 RhinoMocks，但自从我发现 Moq 我只使用 Moq。我发现它会产生更具可读性的代码。所以我的建议是选择最小起订量。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2011-03-30T12:12:51.903

RhinoMocks 实际上非常通用，您可以使用任何一种方法。RhinoMocks 在 expect/verify 样式下看起来比 Moq 好一点。然而，即使你可以使用这种风格的事实也隐藏在文档中（我上次查看）。在我当前的项目中，我们选择了 Moq 而不是 RhinoMocks，因为我们没有意识到它确实进行了设置/验证。

记录/重播语法确实使您能够更改方法将在随后调用该方法时返回的值。这有时很有用。话虽如此，这样做的需要通常是您的设计不太正确的气味。但是，当您可以清楚地看到问题所在并且您必须继续前进时，它很有用。

起订量确实有能力改变价值，但它有点笨拙（来自文档）

```
// returning different values on each invocation 
var mock = new Mock<IFoo>(); 
var calls = 0; 
mock.Setup(foo => foo.GetCountThing())
.Returns(() => calls)
.Callback(() => calls++); 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-05-21T17:06:01.723

我已经离开了记录/重播，因为它很难在设置中看到什么是存根/模拟或只是运行代码。我相信 Rhino 有多种工作方式。特别是，您可以使用`using()`块将 setup 与其他调用隔离开来。

# iphone - 关于“CGImageCreateWithImageInRect”的查询

> ID：650495
> 
> 赞同：1
> 
> 时间：2009-03-16T13:50:09.920
> 
> 标签：iphone, objective-c, cocoa

我正在尝试剪切图像并对其进行遮罩..我能够成功完成..但程序在几分钟后退出，状态为 101

```
- (void) maskImage {

        if(scopeOn==1){

    UIGraphicsBeginImageContext(self.bounds.size);
    [self.layer renderInContext:UIGraphicsGetCurrentContext()];
    cachedImage=[UIImage imageNamed:@"loop.png"];
    cachedImage = UIGraphicsGetImageFromCurrentImageContext();
    UIGraphicsEndImageContext();

     imageRef = [cachedImage CGImage];

     subImage = CGImageCreateWithImageInRect(imageRef, CGRectMake(scopeLoc.x-25, scopeLoc.y-25, 50, 50));
     xMaskedImage = CGImageCreateWithMask(subImage, mask);
    zoomImg.image = [UIImage imageWithCGImage:xMaskedImage]; // retImage;
    [zoomImg setCenter:scopeLoc];

    [self addSubview:zoomImg];

    CGImageRelease(subImage);
            CGImageRelease(xMaskedImage);

} 
```

}

这是我使用的代码....因为我没有分配显式内存，我的猜测是 CGImageCreateWithImageInRect 函数正在分配内存但它没有被释放......这个函数每 0.1 秒调用一次......所以最终一个很大分配了内存的数量（我在内存泄漏性能监视器中看到了这一点）

那么有没有其他方法可以在没有此功能的情况下实现相同的功能？

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2009-03-16T14:28:43.930

您稍后会释放 subImage 变量吗？CGImageCreateWithImageInRect 遵循 CoreFoundation 的“创建”规则，因此需要您稍后释放变量。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-03-25T10:06:12.397

您可以通过以下方式释放为 subImage 和 xMaskedImage 分配的内存

```
 CGImageRelease(subImage);           // Decrements the retain count of a bitmap image.
    subImage=nil;
CGImageRelease(xMaskedImage);
xMaskedImage=nil; 
```

它肯定会解决你的问题。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-03-17T09:38:59.627

也许尝试添加一个测试是否`zoomImg`已经是一个子视图：

```
if (zoomImg.superview != self)
    [self addSubview:zoomImg]; 
```

虽然这是一个相当长的镜头。

# asp.net - ASP.NET ScriptManager 在 Chrome 中导致警告

> ID：650498
> 
> 赞同：1
> 
> 时间：2009-03-16T13:51:50.870
> 
> 标签：asp.net, web-services, google-chrome, scriptmanager

我在 chrome 开发人员 javascript 控制台中收到以下警告：

> Uncaught SyntaxError: Unexpected token < [http://.../Question.asmx/js](http://.../Question.asmx/js)（第 1 行）
> 
> 资源解释为脚本，但使用 MIME 类型 text/html 传输。 [http://.../Question.asmx/js](http://.../Question.asmx/js)

HTML 源代码看起来不错：

```
<script src="../../../Question.asmx/js" type="text/javascript"></script> 
```

我使用 ASP ScriptManager 来包含这些 Web 服务。他们工作正常，我只是想知道问题到底是什么，因为我有强迫症问题，如何摆脱警告。

编辑：不涉及自定义处理程序。这只是我使用脚本管理器包含的标准 WebService：

```
<asp:ScriptManager runat="server" ID="scm1" EnablePageMethods="true" EnablePartialRendering="true" >
        <Services>
            <asp:ServiceReference Path="~/Question.asmx" />
        </Services>
    </asp:ScriptManager> 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-03-16T14:10:49.560

第二个警告是因为您的自定义处理程序 (Question.asmx) 未正确设置您发回的资源的 mime 类型。

您应该将以下内容添加到 ProcessRequest 方法中：

```
context.Response.ContentType = "text/javascript"; 
```

这也可能会消除第一个错误，因为 HTML 页面应该以 <!Doctype 元素开头才有效，这就是我认为该错误所抱怨的。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-08-14T17:28:18.037

不确定 Chrome 中错误的原因是什么，但避免它的一种方法是将服务代理 (question.asmx/js) 的 javascript 直接嵌入到您的页面中。这意味着客户端下载量更大，但到服务器的往返次数减少（或两次，具体取决于您站点的身份验证方法）。

只需在 ServiceReference 标记中设置 InlineScript="true"

有关更多信息，请参阅[http://weblogs.asp.net/dwahlin/archive/2006/12/28/understanding-asp-net-ajax-web-service-proxies.aspx](http://weblogs.asp.net/dwahlin/archive/2006/12/28/understanding-asp-net-ajax-web-service-proxies.aspx)

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-11-10T17:02:46.397

也许这就是你需要的？[http://blog.lavablast.com/post/2008/10/Gotcha-WebKit-%28Safari-3-and-Google-Chrome%29-Bug-with-ASPNET-AJAX.aspx](http://blog.lavablast.com/post/2008/10/Gotcha-WebKit-%28Safari-3-and-Google-Chrome%29-Bug-with-ASPNET-AJAX.aspx)

# asp.net - 使用 asp.net 菜单控件打开弹出窗口

> ID：650504
> 
> 赞同：1
> 
> 时间：2009-03-16T13:53:15.263
> 
> 标签：asp.net, menu, popup

大家好，我有一个可怕的问题我必须用 asp.net 菜单控件打开弹出窗口（javascript），但我不能。菜单项不包含“属性”，所以我不能分配 javascript 代码。我该如何解决？谢谢你的建议

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-03-16T14:09:42.993

您可以在 NavigateURL 属性中设置 Javascript 调用

```
menuItem.NavigateUrl = String.Format("javascript:openPopup('{0}');", sURL); 
```

# python - 如何使用 Python Flup fastcgi 服务器制作单例类？

> ID：650518
> 
> 赞同：0
> 
> 时间：2009-03-16T13:55:46.070
> 
> 标签：python, django, flup

我使用 Flup 作为 Django 的 fastcgi 服务器。

请向我解释如何使用单例？我不确定我是否理解 Flup 的线程模型。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2009-06-12T14:37:52.933

如果您使用分叉服务器，您将根本无法拥有单例（至少没有比您的实际上下文寿命更长的单例）。

使用线程服务器，它应该是可能的（但我不太喜欢 Django 和 Web 服务器！）。

您是否尝试过这样的代码（作为附加模块）：

```
# Singleton module
_my_singleton = None

def getSingleton():
   if _my_singleton == None:
      _my_singleton = ...
   return _my_singleton 
```

当然，在树点（“...”）处，您必须添加编码来创建单例对象。

这还不是生产性代码，但是您可以使用它来检查单例是否可以与您的框架一起使用。因为单例只有在手头有某种“全局存储”的情况下才有可能。分叉的服务器使这变得更加困难。

如果“正常的全局存储”不起作用，则有另一种可能性。您可以使用 Python 的序列化工具将您的单例存储在文件系统上。但是，当然，这实际上会增加更多开销！

# c# - c# WebRequest 使用 WebBrowser cookie

> ID：650536
> 
> 赞同：10
> 
> 时间：2009-03-16T13:59:18.777
> 
> 标签：c#, browser, webrequest

我正在使用 WebBrowser 登录网站，然后我想使用正则表达式来获取一些数据，但 webRequest 没有使用网络浏览 cookie，

我的 webBrowser 是公开的，有什么方法可以在 webRequest 中使用 WebBrowser cookie 吗？

* * *

## 回答 #1

> 赞同：12
> 
> 时间：2010-05-11T18:34:52.193

```
 public CookieContainer GetCookieContainer()
    {
        CookieContainer container = new CookieContainer();

        foreach (string cookie in webBrowser1.Document.Cookie.Split(';'))
        {
            string name = cookie.Split('=')[0];
            string value = cookie.Substring(name.Length + 1);
            string path = "/";
            string domain = ".google.com"; //change to your domain name
            container.Add(new Cookie(name.Trim(), value.Trim(), path, domain));
        }

        return container;
    } 
```

这适用于大多数网站，但是使用子域的网站可能会出现问题。

* * *

## 回答 #2

> 赞同：7
> 
> 时间：2009-03-16T14:15:22.513

您可以将 CookieContainer 用于 Web 请求。

```
 web_cookies = new CookieContainer();
 // Create a 'WebRequest' object with the specified url.                 
 HttpWebRequest myWebRequest = (HttpWebRequest)WebRequest.Create(url);

 myWebRequest.CookieContainer = web_cookies; 
```

希望这可以帮助。

好的，你想登录。那是另一回事。您可以为此使用 NetworkCredential。

```
public string get_secure_webpage(string url, string username, string password)
    {
        WebRequest myWebRequest = WebRequest.Create(url);
        NetworkCredential networkCredential = new NetworkCredential(username, password);
        myWebRequest.Credentials = networkCredential; 
```

...

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2010-10-20T22:05:46.200

这是银光吗？如果是这样，从 silverlight 3 开始，如果您使用浏览器网络堆栈，那么您应该免费获得 cookie。默认情况下，当您使用 WebRequest.Create() 方法创建 n HttpWebrequest 时，您会获得浏览器堆栈。请注意，如果您使用 CreateHTTP 方法，您将获得一个客户端堆栈，默认情况下它不包括浏览器 cookie（如前所述，您必须通过诡计来获取它们）

请参阅[http://msdn.microsoft.com/en-us/library/dd920295(VS.95).aspx](http://msdn.microsoft.com/en-us/library/dd920295(VS.95).aspx)关于 silverlight 自版本 3 以来的网络堆栈

# .net - .NET 框架版本要求

> ID：650554
> 
> 赞同：0
> 
> 时间：2009-03-16T14:03:07.863
> 
> 标签：.net, asp.net

Web 用户有没有办法确定他们正在查看的特定网页所需的 .NET 框架版本？

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2009-03-16T14:06:41.800

ASP.NET 网页在服务器上进行处理，并将纯 HTML 发送到浏览器。在查看使用 ASP.NET 创建的网页时，客户端不需要在其 PC 上安装 .NET Framework。但是，服务器需要安装正确版本的 .NET Framework 才能处理该页面。

在服务器端，除了 Visual Studio 2008 之外，所有版本的 VS 都绑定到特定版本的框架。

Visual Studio.NET (2002) => .NET Framework 1.0 Visual Studio.NET 2003 => .NET Framework 1.1 Visual Studio.NET 2005 => .NET Framework 2.0

有一个 Framework 3.0，它添加了 Windows 演示、通信和工作流框架，这些应用程序可以使用 Visual Studio 2005 构建，并安装适当的插件。Visual Studio 2008 可以针对任何 2.0、3.0 和 3.5 框架。

如果您尝试下载现有项目，并尝试确定哪些主机可以运行该应用程序，那么您应该检查您希望使用的应用程序的网站，它应该会提供您的要求。在大多数情况下，这些框架是向后兼容的，因此为 2.0 构建的应用程序将在 3.5 上运行。因此，您不需要完全匹配，但是 1.0 和 1.1 应用程序不会在仅安装 2.0 或更高版本的服务器上运行。

希望这可以帮助。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-03-16T14:06:09.430

我不认为这是可能的。由网站所有者选择应用程序将使用的框架（在 IIS 中），而不是在 .net 1.1 中有效的某些功能。在 3.5 中不再有效，所以如果存在类似的东西，那么应用程序将无法工作。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-03-16T14:33:13.890

没有特意为此提供任何机制。您也许能够找出一些在受控情况下有效的技巧，但我个人并不知道。

# c# - 如何在 Visual C# 中使用设置

> ID：650555
> 
> 赞同：14
> 
> 时间：2009-03-16T14:03:28.407
> 
> 标签：c#, vb.net, settings

我长期从事 VB.net 开发，最近改用 C#。当我使用 VB.net 调用用户设置时，我只需要使用设计器创建一个新设置，然后使用 My 命名空间从代码中调用它。
这是
`My.settings.anysetting`
我可以更改或从中获取数据的代码。但是在 C# 中，My 关键字不起作用，那么我该怎么做才能调用设置？

* * *

## 回答 #1

> 赞同：30
> 
> 时间：2009-03-16T14:07:14.700

`Settings`存储在`Application`文件夹下，因此，将其用作其命名空间。

```
int myInt = Properties.Settings.Default.myVariable;
Properties.Settings.Default.myVariable = 12;
Properties.Settings.Default.Save(); 
```

[在 C# 中使用设置](http://msdn.microsoft.com/en-us/library/aa730869.aspx)

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2016-06-18T11:04:20.767

有点像这样：

```
this.BackColor = Properties.Settings.Default.myColor; 
```

文档： [https ://msdn.microsoft.com/en-us/library/bb397759(v=vs.110).aspx](https://msdn.microsoft.com/en-us/library/bb397759(v=vs.110).aspx)

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-03-16T14:06:16.840

```
// Retrieving connection string from Web.config.
String connStringMSQL = WebConfigurationManager.ConnectionStrings["andi_msql"].ToString(); 
```

在我的情况下，这是用于我的 connectionStrings 设置，但根据您的设置所在的节点，您可以相应地更改它。

希望这可以帮助

# .net - 性能是拥有单例类或静态类的充分理由吗？

> ID：650556
> 
> 赞同：2
> 
> 时间：2009-03-16T14:03:53.383
> 
> 标签：.net, performance, oop, static, singleton

我有一个我认为不应该是单例或静态类的类。它具有状态，尽管状态*可以*由消费者共享。当存在共享状态时，我喜欢远离单例，但我听到的论点是，我将从在任何给定时间只存在一个对象实例中获得性能优势。

在我的特定情况下，与此对象相关联的数据并不多——两个字典（最多）每个字典中有 150 个条目。

性能论点在什么时候——如果有的话——有任何价值吗？

仅供参考 - 我正在使用 .NET。

谢谢！

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2009-03-16T14:12:16.560

不，性能论点没有任何价值。

在假设您有性能问题之前，您应该进行基准测试并确认/识别性能问题。10 次中有 9 次不是你想的那样。

如果需要一个单例，它就是。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2009-03-16T14:12:43.797

单例模式的存在主要是为了让您指定您只需要一个类的实例。静态类通常用于提供无状态行为。你所描述的似乎并不真正适合任何一个类别。我会研究使用缓存而不是单例模式来提高代码的性能。当然，*你的缓存可能是一个单例*，但在缓存的情况下它是有意义的。

当然，如果您的对象是缓存，那么我只是把自己说成一个圈子。

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2009-03-16T14:13:12.767

出于性能原因，您不应该考虑创建单例（或静态类）。

**您要么需要通过设计**使其成为 Singleton ，要么不需要。如果你的类的多个实例应该存在并且彼此不同，那么你不能使用单例。

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2009-03-16T14:10:39.607

我不认为性能是一个非常有力的论据，无论是支持还是反对使用单例模式。这是一个设计问题，使用单例是否有意义：

如果您只需要一个对象实例，请使用单例。

如果您需要多个实例，请不要。

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2009-03-16T21:29:10.147

您应该仅在*概念上*只能存在一个对象实例的情况下使用 Singleton，而不是人为地将开发人员限制为一个实例。如果可能有两个实例，那么它不应该是单例。

如果是前者，并且存在与对象关联的状态，那么如果与初始化相关联的成本很高，并且有可能永远不会使用该类，或者有延迟初始化的原因，那么单例是有用的。在这种情况下，单例是好的。另一种方法是使用静态类，只要上述不适用，您就应该使用它。

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2009-03-16T14:15:01.983

如果构建成本很高，那么您可能更适合返回公共实例的[抽象工厂](http://en.wikipedia.org/wiki/Abstract_factory_pattern)模式。Singleton 的名声不好，特别是在 TDD 人群中，但实际上 AF 和 Singleton 可以做同样的事情（AF 可以做的更多，但那是另一回事）。

既然你没有很大的成本，那么它可能并不重要。

* * *

## 回答 #7

> 赞同：0
> 
> 时间：2009-03-16T14:39:00.897

通常，单例会抑制性能，比什么都重要。这意味着您*必须*在多线程应用程序中将类包装在锁和同步中。如果没有使用单例或全局变量，这可能是可以避免的。

所以单例可能会更慢，但我想不出任何情况下它会更快。

如果您希望您的应用程序共享一个对象的单个实例，则传递对该对象的引用。这也使您可以灵活地在以后更改设计，因为事实证明，出于缓存或并发原因，使用多个单独的实例实际上会更快。

关于性能，要记住的最重要的一点是它很难预测。不管你猜你的瓶颈是什么，你几乎肯定是错的。因此，确保良好性能的最佳方法是让您的程序易于修改。单身人士在那里对你不利。一旦你有了一个单例，就几乎不可能删除。即使多个实例的性能会更好，即使局部变量而不是全局单例会提高缓存的使用率，您也会被该类的一个通用实例所困扰。

# .net - 如何使用图片框进行“填充颜色”（来自 mspaint）？

> ID：650560
> 
> 赞同：0
> 
> 时间：2009-03-16T14:05:33.287
> 
> 标签：.net

我做了一些研究，但我没有找到方法，有人知道吗？

c# 或 vb.net

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-03-16T14:22:37.690

您在寻找洪水填充算法吗？例如检查这个：[C#和GDI+中的Flood Fill Algorithms](http://www.codeproject.com/KB/GDI-plus/floodfillincsharp.aspx)

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-06-23T11:00:37.417

[最后我使用了这段代码](http://www.vbforums.com/showthread.php?t=556493)

# apache-flex - AS3：使用动作脚本设置 DisplayObject 的注册点？

> ID：650567
> 
> 赞同：10
> 
> 时间：2009-03-16T14:07:12.937
> 
> 标签：apache-flex, flash, actionscript-3

您将如何通过 actionscript 在 Sprite 或 Shape 上设置注册点（我知道这使用 Flash 很简单，但我需要纯粹在 actionscript 中完成）

* * *

## 回答 #1

> 赞同：12
> 
> 时间：2009-04-10T16:34:23.720

Flash Player API 不公开这一点。我相信这是因为 Flash 在创建 SWF 时实际上会将注册点烘焙到形状数据中。因此，没有要移动的实际注册点（相反，您将移动形状数据……如果 Flash Player 允许您编辑形状数据！）。

我总是通过简单地将我的精灵/形状设置为另一个 DisplayObject 来解决这个问题。所以，如果我有 spriteA 并想将其注册点设置为 (15, 35)，我会这样做：

```
 var spriteB:Sprite = new Sprite();
spriteB.addChild(spriteA);
spriteA.x = 15;
spriteA.y = 35; 
```

然后从那时起，在我之前提到 spriteA 的任何地方都引用 spriteB。

* * *

## 回答 #2

> 赞同：5
> 
> 时间：2009-12-30T06:19:57.493

使用变换矩阵这是可能的。这是在[此站点](http://flashscript.ca/set-registration-as3.php)上找到的一个很好的实现。

```
public function setRegistrationPoint(s:Sprite, regx:Number, regy:Number, showRegistration:Boolean )
{
    //translate movieclip 
    s.transform.matrix = new Matrix(1, 0, 0, 1, -regx, -regy);

    //registration point.
    if (showRegistration)
    {
        var mark:Sprite = new Sprite();
        mark.graphics.lineStyle(1, 0x000000);
        mark.graphics.moveTo(-5, -5);
        mark.graphics.lineTo(5, 5);
        mark.graphics.moveTo(-5, 5);
        mark.graphics.lineTo(5, -5);
        s.parent.addChild(mark);
    }
} 
```

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2009-03-16T15:36:26.313

~~你的意思是索引？~~

跟进评论，您可以像下面这样快速实施。这并不是您想要的，因为您无法为每个孩子设置不同的对齐方式。我只是不想让它太复杂，它更像是'工作伪代码'来给你一个想法......

```
package  
{
    import flash.display.DisplayObject;
    import flash.display.Sprite;    

    public class SpriteWithRegistration extends Sprite 
    {

        private var _regV:String = "T";
        private var _regH:String = "L";

        private var _width:Number = 0;
        private var _height:Number = 0;

        public function SpriteWithRegistration(width:Number, height:Number, registrationPoint:String = "TL")
        {
            this.width  = height;
            this.height = width;
            this.registrationPoint = registrationPoint;
        }

        public function set registrationPoint(p:String):void
        {
            if(p.length != 2) return;

            var regV:String = p.toUpperCase().substr(0, 1);
            var regH:String = p.toUpperCase().substr(1, 1);

            _regV = (regV == "T" || regV == "C" || regV == "B" ) ? regV : _regV;
            _regH = (regH == "L" || regH == "C" || regH == "R" ) ? regH : _regH;

            alignChildren();
        }

        override public function addChild(child:DisplayObject):DisplayObject
        {
            alignChild(child);
            super.addChild(child);
            return child;
        }

        override public function set width(value:Number):void
        {
            _width = value;
            alignChildren();
        }

        override public function get width():Number
        {
            return _width;
        }

        override public function set height(value:Number):void
        {
            _height = value;
            alignChildren();
        }

        override public function get height():Number
        {
            return _height;
        }

        private function alignChildren():void
        {
            for(var index:int = 0;index < numChildren; index++ )
                alignChild(getChildAt(index));
        }

        private function alignChild(disp:*):void
        {
            switch(_regH)
            {
                case "L":   disp.x = 0;                             break;
                case "C":   disp.x = _width*.5 - disp.width * .5;   break;
                case "R":   disp.x = _width - disp.width;           break;
            }

            switch(_regV)
            {
                case "T":   disp.y = 0;                             break;
                case "C":   disp.y = _height*.5 - disp.height * .5; break;
                case "B":   disp.y = _height - disp.height;         break;
            }
        }
    }
} 
```

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2017-10-26T16:32:24.970

我希望这会对某人有所帮助。Starling 框架有一个很棒的方法，叫做“alignPivot()”。我采用了他们的概念并将其改编为 Flash DisplayList。您实际上是告诉精灵将其注册更改为左、右、中心、顶部和底部。此代码将您的精灵放置到容器精灵中并适当地定位自己。它返回容器精灵，其中包含原始精灵。

代码存储在一个单独的名为“Position”的地方。

```
 public static function alignPivot(s:DisplayObject, horizontalAlign: String = "center", verticalAlign: String = "center", showRegistration: Boolean = false, _color: uint = 0x000000): Sprite {

        //create a container sprite to house the sprite you'd like to move
        var _container: Sprite = new Sprite();
        //add your sprite to the continer sprite (the container sprite is what will be returned)
        _container.addChild(s);
        //using getBounds(), find the x,y,width,and height of your sprite within the continer.
        var bounds:Rectangle = _container.getBounds(s);
        //create variables for x and y cooridnates
        var xVal: Number;
        var yVal: Number;

        //I have a separate class called Align which contains public static constants for positiong.
        //Check the values passed above and get the correct x value;
        if (horizontalAlign == Align.LEFT) xVal = -bounds.x;
        else if (horizontalAlign == Align.CENTER) xVal = -bounds.x - bounds.width * .5;
        else if (horizontalAlign == Align.RIGHT) xVal = -bounds.x - bounds.width;
        else throw new ArgumentError("Invalid horizontal alignment: " + horizontalAlign);

        //Check the values passed above and get the correct y value;
        if (verticalAlign == Align.TOP) yVal = -bounds.y;
        else if (verticalAlign == Align.CENTER) yVal = -bounds.y - bounds.height * .5;
        else if (verticalAlign == Align.BOTTOM) yVal = -bounds.y - bounds.height;
        else throw new ArgumentError("Invalid vertical alignment: " + verticalAlign);

        //apply the new x and y cooridnates to your sprite (the one moving within the container we created above)
        s.x = xVal;
        s.y = yVal;

        //optional - this will create a small X at the 0,0 position of the container.
        //This is helpful if you want to see where your registration points are
        if (showRegistration) {
            var mark: Sprite = new Sprite();
            mark.graphics.lineStyle(1, _color);
            mark.graphics.moveTo(-5, -5);
            mark.graphics.lineTo(5, 5);
            mark.graphics.moveTo(-5, 5);
            mark.graphics.lineTo(5, -5);
            _container.addChild(mark);
        }
        //return your contianer sprite
        //This will replace the sprite that you passed in the first parameter.
        //That sprite is inside the container, so you won't notice
        return _container;

    } 
```

执行：

```
//Create your sprite
        var _holder: Sprite = new Sprite();
    //Create a shape to put in your sprite
        var my_shape: Shape = new Shape();
        my_shape.graphics.beginFill(0x000000);
        my_shape.graphics.drawRect(0, 0, 200, 100);
        my_shape.graphics.endFill();
    //Add the shape to your sprite
        _holder.addChild(my_shape);
    //Align the holder (must be done AFTER all children have been added)
    //This will put the registration point at the top-center of the sprite. 
    //_holder is replaced by a sprite (container) that contains _holder.
    //The _holder inside the container is positioned appropriately.
    _holder = Position.alignPivot(_holder,Align.CENTER, Align.TOP);
    //Add the new sprite to your stage.
    this.addChild(_holder); 
```

常量列表，因此您不必自己编写它们：

```
 public static const CENTER:String = "center";
    public static const LEFT:String = "left";
    public static const RIGHT:String = "right";
    public static const TOP:String = "top";
    public static const BOTTOM:String = "bottom"; 
```

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2009-03-16T20:43:12.657

根据您需要它的原因，它可能会通过使用 DisplayObject 来解决。[变换](http://livedocs.adobe.com/flex/3/langref/flash/display/DisplayObject.html#transform)。[matrix](http://livedocs.adobe.com/flex/3/langref/flash/geom/Transform.html#matrix)，它返回一个[Matrix](http://livedocs.adobe.com/flex/3/langref/flash/geom/Matrix.html)对象。

例如，如果你想改变旋转点，那么你可以使用变换的矩阵来做到这一点。

# c# - ADO.Net 实体框架：这是什么？

> ID：650572
> 
> 赞同：1
> 
> 时间：2009-03-16T14:07:32.330
> 
> 标签：c#, sql, entity-framework, ado.net

我刚刚开始使用 ADO.NET Entity Framework 进行开发，但我不知道如何编写：

```
 ClientEntities clientContext = new ClientEntities();

   ObjectQuery clientQuery = 
        clientContext.Client.Where("it.email = @email AND it.password = @password",
                    new ObjectParameter("email", "xxx@hotmail.com"),
                    new ObjectParameter("password", "xAdxar12s"));

            Console.WriteLine(clientQuery.Count());
            Console.ReadLine(); 

```

它有效！

但是，这是什么？

```
 "it.email = @email AND it.password = @password" 

```

我在哪里可以学习这种“SQL 语法”？我不知道为什么我必须使用**it.email**或**SELECT VALUE**的含义。它是“实体 SQL”吗？

谢谢！

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-03-17T14:28:25.983

是的，这是实体 SQL。

“LINQ to Entities”是从上下文中检索实体实例的一种方式。实体 SQL 是另一个。两者都工作，得到支持，并相互补充。

[SELECT VALUE](http://msdn.microsoft.com/en-us/library/bb399554.aspx)的意思是“这个语句应该返回实体实例”。（与行包装器相反。）您将得到一个对象查询。

现在，什么是“它”？嗯，Client 是生成的 ObjectContext 的属性，类型为 ObjectQuery<Client>。您可以在模型的 codegen 文件（扩展名为 .Designer.cs 的文件）中查看 Client 的源代码：

```
 /// <summary>
    /// There are no comments for Client in the schema.
    /// </summary>
    public global::System.Data.Objects.ObjectQuery<Client> Client
    {
        get
        {
            if ((this._Client== null))
            {
                this._Client = base.CreateQuery<Client>("[Client]");
            }
            return this._Client;
        }
    }
    private global::System.Data.Objects.ObjectQuery<Client> _Client; 
```

你看到那里的实体 SQL 了吗？不仔细看很容易错过。我将它复制到这里：

```
"[Client]" 
```

我找不到此语法的文档，但这主要是因为搜索方括号而不是任何其他 Entity SQL 关键字对于大多数搜索引擎来说有点困难。与 T-SQL 一样，方括号似乎意味着“将它们之间的所有内容视为标识符”。但该声明似乎是以下的简写：

```
 "SELECT VALUE it FROM MyEntities.[Client] AS it" 
```

所以现在你知道“它”是从哪里来的了。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-03-16T14:17:20.403

你从哪里得到那个样本？这样做的正常方法是：

```
string email = "xxx@hotmail.com",
       pw = "xAdxar12s";
var qry = from client in clientContext.Client
          where client.email == email
             && client.password == pw
          select client;

Console.WriteLine(qry.Count()); 
```

这给了你静态类型，等等——而且更友好！

（注意：检查你有`using System.Linq;`在文件的顶部）

# c# - C# 中有类似 PHP 的可选参数吗？

> ID：650574
> 
> 赞同：2
> 
> 时间：2009-03-16T14:08:12.123
> 
> 标签：c#, php, overloading, optional-parameters

使用**PHP 可选参数**，如果您不发送参数，它将被分配给默认值：

```
public function getCustomer(id, optionalMessage = "(no message)") {
    ...
} 
```

**在 C# 中，我通常使用C# 方法重载**来解决这个问题，例如：

```
public void GetCustomer(int id) 
{
    ...
}

public void GetCustomer(int id, string optionalMessage)
{
    ...
} 
```

但我想念实用的 PHP 变体，**C# 是否也有一些含糖的语法来执行可选参数**，就像在 PHP 示例中一样？

* * *

## 回答 #1

> 赞同：8
> 
> 时间：2009-03-16T14:08:50.250

不在 C# 3.0 中；此功能在 C# 4.0 的工作表上 - 请参见[此处](http://marcgravell.blogspot.com/2008/11/immutability-and-optional-parameters.html)。

现在，您将不得不使用不同的重载：

```
public void Foo(int a) {Foo(a, "");}
public void Foo(int a, string b) {...} 
```

建议的语法是：

```
public void Foo(int a, string b = "") {...} 
```

用以下任何一种方式调用：

```
Foo(123); // use default b
Foo(123, "abc"); // optional by position
Foo(123, b: "abc"); // optional  by name 
```

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2009-03-16T14:19:13.097

不，但是您可以在一定程度上模拟它们，特别是如果您的可选参数属于同一类型（或者您不介意进行一些转换）。

您可以使用 params 标志。

```
void paramsExample(object arg1, object arg2, params object[] argsRest) 
```

不过我应该指出，这会失去类型安全性，并且没有参数或顺序的类型强制。

# visual-studio - 如何使 Visual Studio 2008 中的文档选项卡以从左到右的顺序显示，就像在早期的 VS 中一样？

> ID：650576
> 
> 赞同：7
> 
> 时间：2009-03-16T14:08:33.293
> 
> 标签：visual-studio, visual-studio-2008

在早期版本的 VS（肯定是 2003 年，可能是 2005 年）中，当您打开项目文件时，选项卡会在右侧打开。在当前的 VS 2008 中，它总是向左打开，所以我必须手动重新排列它们。这既耗时又愚蠢，因为我觉得我被迫按从右到左的顺序写作。我寻找适当的设置，但没有找到任何东西。

这种行为是永久性的吗？有什么办法让它变回来？

* * *

## 回答 #1

> 赞同：28
> 
> 时间：2010-01-20T19:38:06.613

在 Visual Studio 2010 中，可以从左到右打开文档选项卡。该选项位于：工具>环境>文档

选中“在现有选项卡的右侧插入文档”

[http://blogs.msdn.com/b/zainnab/archive/2010/02/10/insert-documents-to-the-right-of-existing-tabs-vstipenv0001.aspx](http://blogs.msdn.com/b/zainnab/archive/2010/02/10/insert-documents-to-the-right-of-existing-tabs-vstipenv0001.aspx)

![替代文字](https://farm3.static.flickr.com/2719/4290601573_568d419cc6_o.jpg)

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-03-17T13:32:46.990

在 Visual Studio 2005 中对打开文档选项卡的一侧进行了更改。在 2003 年，新选项卡在右侧打开。在 2005 年及以后，新标签页在左侧打开。就个人而言，我不喜欢这种行为，但几年后我已经习惯了。

不幸的是，这种行为是永久性的，并且没有恢复它的设置。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2009-09-04T09:17:36.993

Visual Studio 的Commercial [Tabs Studio 插件](http://www.tabsstudio.com)默认在右侧打开新选项卡，通常允许大量选项卡自定义。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2009-03-17T13:29:33.770

您可以尝试删除 \Visual Studio 2008\Settings\CurrentSettings.vssettings （嗯，备份它）并重新排列您的窗口并再次退出 - 这是保存您的个人首选项的文件，它可能已经成为以某种方式损坏。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2009-04-06T14:18:12.377

有趣的是，这个选项卡功能让我**每次**使用它时都不喜欢 Visual Studio。

1）它不会在右侧打开新文档（而是在左侧）

2) Ctrl+Tab 不会转到下一个选项卡。（但改为以前使用的选项卡）

相当不错的成绩。

没有办法改变这一点。我想我是愚蠢的不习惯这一点。

# visual-c++ - 在 Visual C++ 中替换 #import

> ID：650578
> 
> 赞同：30
> 
> 时间：2009-03-16T14:08:40.423
> 
> 标签：visual-c++, com

我们有大型 C++ 项目，我们使用 /MP 开关进行编译以利用多个内核。

然而，我们最近引入了一些在几个 tlb 上使用 #import 的代码，而 #import 与 /MP 不兼容，这意味着我们回到了单线程构建，并且有更多的时间去喝咖啡。

关于如何让#import 和 /MP 发挥出色的任何建议？是否有一种工具可以从#import 静态生成 C++ 标头作为预构建步骤？

**更新：**

遵循马特的建议效果很好。对于在谷歌中遇到这个问题的其他人：

1.  创建一个单独的静态库项目
2.  设置足够的包含，以便您可以将`#import`语句放在 lib 项目中
3.  使您的主项目依赖于 lib 项目（以确保正确的构建顺序）
4.  将 lib 项目的临时构建文件夹添加到主项目的包含路径
5.  `#include``.tlh`您正在执行的生成文件`#import`
6.  启用`/MP`开关并失去咖啡休息时间......

* * *

## 回答 #1

> 赞同：27
> 
> 时间：2009-03-16T14:18:04.817

为什么不只是`#include`从创建的生成的标头`#import`？

* * *

## 回答 #2

> 赞同：8
> 
> 时间：2009-03-16T15:30:01.273

（我对这个问题有点晚了，但这是我心中的一个近在咫尺的问题。）

您可以尝试使用从 C/C++ 访问 COM 对象的老式方法。这涉及提供具有 C/C++ 版本的 COM 接口的客户端 .h 文件的 COM 对象的开发人员。这些文件看起来像是#import 制作的简单版本。

这些文件来自哪里？如果 COM 对象是用 C/C++ (VC++) 编写的，那么这些对象来自 MIDL 编译器。此命令行工具获取 ODL/IDL 文件并从中创建 C/C++ 源代码。它发出的一些内容对客户端应用程序很有用。

**如果您有 COM 对象的来源，您可能已经有了这些文件！**

如果您只有 TLB 文件，您可以使用 OLE/COM 对象查看器（OLEVIEW.exe - 至少附带 VC++ 6.0）打开类型库并另存为和 OLD/IDL 文件。然后运行 ​​MIDL 编译器生成客户端 C/C++ 包含文件。第三方 COM 对象可能会随这些文件一起提供，但它们通常没有（我记得 Crystal Reports有一段时间*这样做*了，然后停止运送它们 - 让我们大吃一惊 - 但我离题了）。

将 ATL 智能指针（和其他支持类）与 MIDL 创建的接口类一起使用几乎与 #import 创建的一样好。这取决于您使用了多少#import 特定功能。

***对于 /MP，我已经完成了我的建议以及已接受的 Matt Davison 回答所建议的一些内容。***

* * *

## 回答 #3

> 赞同：8
> 
> 时间：2009-06-05T12:27:45.810

您可以对整个项目使用 /MP 选项，然后使用***/MP1***选项对单个文件进行例外处理。

* * *

## 回答 #4

> 赞同：4
> 
> 时间：2013-08-12T16:15:23.543

如果您可以限制#import'ing 文件的数量，您可以将它们放在已经自动从/MP 中排除的预编译头文件（例如stdafx.h）中。这避免了提到的问题，因为所有其他文件将等待编译器直到 stdafx.cpp 完成，并且都将“继承”相同的 #import 定义。

* * *

## 回答 #5

> 赞同：2
> 
> 时间：2009-03-16T14:16:36.380

一种选择是将导入移动到单独的 DLL 中，并使用不透明指针为它们提供包装类。然后仅为该 DLL 禁用 /MP，其余的构建应该没问题。

* * *

## 回答 #6

> 赞同：1
> 
> 时间：2009-03-16T14:15:06.070

您可以将项目分成两部分，一部分或多或少地执行禁用/MP 的导入，另一部分执行启用/MP 的所有其他操作。

# asp.net - 无法删除测试服务器上的 cookie

> ID：650581
> 
> 赞同：0
> 
> 时间：2009-03-16T14:09:04.900
> 
> 标签：asp.net, firefox, cookies

我在删除测试服务器上的 cookie 时遇到问题。在我的开发机器上，cookie 删除得很好。

这是来自提琴手的请求/响应。我正在尝试删除 .Hv2 cookie [![替代文字](https://i.stack.imgur.com/5GUA6.png)](https://i.stack.imgur.com/5GUA6.png)

我试过不设置响应cookie的路径部分——没有区别。这是 FF 中 cookie 的外观。

[![替代文字](https://i.stack.imgur.com/7L0B6.png)](https://i.stack.imgur.com/7L0B6.png)

我注意到我的开发机器和测试服务器之间的一个区别是我的开发机器上 cookie 的主机是 .my.hostname.dev 而不是 .hostname.dev

这是我用来删除 cookie 的代码

```
var oldFormsCookie = context.Request.Cookies[".Hv2"];
if (oldFormsCookie != null)
{
    context.Response.Cookies.Remove(oldFormsCookie.Name);
    var removalCookie = new HttpCookie(oldFormsCookie.Name)
    {
        Expires = DateTime.Now.AddYears(-1), 
        Domain = oldFormsCookie.Domain,
        Value = "remove"
    };
    context.Response.SetCookie(removalCookie);
} 
```

在我看来，它应该删除这个 cookie！任何人有任何想法？谢谢

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-03-17T10:05:57.643

好吧，看起来问题在于 cookie 的域显示为 null，而实际上它与 FormsAuth cookie 相同。我将代码更改为

```
Domain = oldFormsCookie.Domain ?? FormsAuthentication.CookieDomain 
```

它似乎有效

# java - 浏览器上通常安装哪些 Java 版本，假设 1.4 是否安全？

> ID：650582
> 
> 赞同：5
> 
> 时间：2009-03-16T14:09:16.100
> 
> 标签：java, applet, jvm, version

是否有任何关于大多数人在 WWW 上使用的 Java 版本的网站/分析？似乎此数据在网络服务器日志中不可用（与 Flash 版本相比）

我们是否可以安全地将 Java 1.4.2 设置为我们的小程序的最低要求，或者仍然有很多用户使用 Java 1.1（MS one）或 Java 1.2-1.3？

如果 Java 太旧，更新它仍然是一个复杂的过程，例如在 Windows 机器上需要管理员权限，并且在某些 Linux 发行版中也有点困难。

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2009-03-16T14:23:15.223

[这张图表](http://www.riastats.com/#)可能会有所帮助。

在过去 30 天内，来自 47 个站点的 1,471,010 个浏览器...

*   6% 有 1.4,
*   16% 有 1.5
*   50% 有 1.6

[http://weblogs.java.net/blog/editors/archives/2009/03/bedbugs_and_bal.html](http://weblogs.java.net/blog/editors/archives/2009/03/bedbugs_and_bal.html)是一篇关于图表的文章。

* * *

## 回答 #2

> 赞同：5
> 
> 时间：2009-05-01T08:36:26.673

您可以修改 Google 分析代码以检测 Java 版本，请参阅[此脚本](http://cowwoc.blogspot.com/2008/12/tracking-java-versions-using-google.html)。

关于 1.4 之前的 Java 版本，可用数据很少，我在 2 月中旬进行了自己的测试，抽样了近 20,000 名使用 Java 的访问者：

```
Java 编号  
1.6 15516 79.5%
1.5 2161 11.1%
1.4 685 3.5%
1.3 36 0.2%
1.2 0 0.0%
1.1 1115 5.7%
合计 19513 100.0%

```

根据这些数据，我最终将要求从 1.1 提高到 1.4，在 Swing 发布后仅十年就允许使用！

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-05-01T20:45:35.890

你可以考虑java web start。这允许您使用您希望的任何最新版本。它甚至允许您使用比浏览器的默认版本更旧的版本。例如，如果您有一个仅适用于 Java 5 但安装了 Java 6 的程序。

# .net - 检测线程组何时完成的最佳实践

> ID：650587
> 
> 赞同：0
> 
> 时间：2009-03-16T14:09:46.597
> 
> 标签：.net, multithreading, transactional

检测整个线程组何时完成处理的最佳实践是什么？我有一个进程将查询 [长期运行] Web 服务以获取任意数量的对象，然后需要在所有对象都成功完成后采取事务操作。我目前正在使用 .Net 线程池中的委托异步运行它们。同步运行它们，违背了在多个线程上运行它们的目的......我还能如何检测所有何时完成？我虽然使用了一个计数器，（又名 COM 引用计数）为到达线程增加它，并在回调函数中减少它，并保留一个动态列表，其中包含对其中每个线程的引用，以显式跟踪每个线程当它们完成时，但这两种解决方案似乎都有些笨拙......

感谢所有人...根据您的建议，并且需要将对象实例传递给异步线程（由下面的 ref 变量 uPL 表示），我正在使用以下代码...注意：IEEDAL.GetUsagePayloadReadings(uPL1)是远程 Web 服务调用

```
 foreach (MeterChannel chgChan in chgChs)
        foreach (UsagePayload uPL in chgChan.IntervalPayloads)
        {
            ManualResetEvent txEvnt = new ManualResetEvent(false);
            UsagePayload uPL1 = uPL;
            ThreadPool.QueueUserWorkItem(
                delegate(object state)
                    {
                        if (!uPL1.HasData)
                            IEEDAL.GetUsagePayloadReadings(uPL1);
                        UsageCache.PersistPayload(uPL1);
                        SavePayLoadToProcessFolder(uPL1);
                        txEvnt.Set();
                    } );
            waitHndls.Add(txEvnt);
        }
    WaitHandle.WaitAll(waitHndls.ToArray()); 
```

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2009-03-16T15:39:59.453

我见过的最好的方法是使用倒计时锁存器。在 2007 年 5 月的 MSDN 杂志上有[很好的描述，包括 C# 源代码。](http://msdn.microsoft.com/en-us/magazine/cc163427.aspx)

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2009-03-16T14:15:14.917

您可以使用[WaitHandle.WaitAll](http://msdn.microsoft.com/en-us/library/z6w25xa6.aspx)。

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2009-03-16T14:14:42.407

有几个选项。

信号量允许您在所有线程中使用一个计数器。如果您确切知道有多少，您可以使用它来检查它们何时完成。

另一种可能的替代方法是为每个线程设置一个 ResetEvent。只需将事件设置在线程的“末尾”，然后在主线程中检查它们。不过，这可能更困难。

* * *

## 回答 #4

> 赞同：2
> 
> 时间：2009-03-16T14:20:45.790

我不知道这是否是“最佳实践”，但 System.Threading.ManualResetEvent 和 System.Threading.WaitHandle 类是我发现线程需要相互发送信号时必不可少的两个类。这是一个关于如何将它们与 ThreadPool 线程一起使用的基本示例。

```
 List<WaitHandle> handles = new List<WaitHandle>();
    for ( int iii = 0; iii < 10; iii++ ) {
        ManualResetEvent transactionEvent = new ManualResetEvent( false );
        ThreadPool.QueueUserWorkItem( delegate( object state ) {
            // Do your work here...
            transactionEvent.Set();
        } );
        handles.Add( transactionEvent );
    }
    WaitHandle.WaitAll( handles.ToArray() ); 
```

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2009-03-16T14:21:41.297

```
Dim WaitAllEvents(1) As AutoResetEvent

Dim thread1 As Thread
Dim thread2 As Thread

thread1 = New Thread(AddressOf Thread1Worker)
thread2 = New Thread(AddressOf Thread2Worker)

WaitAllEvents(0) = New AutoResetEvent(False)
WaitAllEvents(1) = New AutoResetEvent(False)

thread1.Start()
thread2.Start()

'Main thread will wait until all instances of AutoResetEvent 
'have become signaled with a call to Set()

WaitHandle.WaitAll(WaitAllEvents)

Console.WriteLine("All threads done exiting main thread")
thread2 = Nothing
thread1 = Nothing

'...
'...

Private Sub Thread1Worker()
    Thread.Sleep(5000)
    Console.WriteLine("Thread1 done")
    WaitAllEvents(0).Set() 
End Sub

Private Sub Thread2Worker()
    Thread.Sleep(3000)
    Console.WriteLine("Thread2 done")
    WaitAllEvents(1).Set() 
End Sub 
```

# visual-studio - 有人在 Visual Studio 中使用“数据库项目”吗？

> ID：650602
> 
> 赞同：18
> 
> 时间：2009-03-16T14:13:55.277
> 
> 标签：visual-studio, visual-studio-2008, database-design, database-project

我最近尝试了一下（SQL 2008 版本），我发现它们还不错。好吧，唯一的问题是向导不够智能，无法在不先擦除所有数据的情况下更新数据库结构。这就是为什么这些项目没有在实践中使用的原因吗？

实际上从未见过任何人使用它们或根本没有提及它们。除非您明确查找，否则在博客和论坛中也看不到任何内容。

他们怎么了？

* * *

## 回答 #1

> 赞同：9
> 
> 时间：2009-03-16T14:16:28.890

我使用作为 Visual Studio 数据库版一部分的数据库项目。这是一个很棒的工具。基本上，您在创建脚本时定义整个架构，然后将其签入源代码管理。然后它内置了工具来生成不同的脚本，顺便说一下，这些脚本不会删除数据。

它还具有数据比较工具，因此您可以比较数据库之间的数据并生成脚本以使数据库相同。

最近的 GDR 版本添加了一些有趣的功能。这样听起来，如果您使用他们内置的部署方法，您可以生成一个部署包，当您运行它时，它将分析目标数据库并仅应用差异。

如果您有 Team Studio - Team Suite 或 Development 版本，那么您可以使用 Database Edition。

试一试，这是数据库开发的一次伟大变革

* * *

## 回答 #2

> 赞同：8
> 
> 时间：2009-03-16T14:40:09.397

像 Glennular 一样，我们使用它们来控制我们的模式和 s'procs。

虽然我们有一个相当先进的版本控制结构（CI、自动部署到 dev、单击部署到 stage 和 prod）；我们不包括该结构中的任何数据库项目。我们只是还不相信它。

**更新：（**在太空中）

我们针对公司的职能领域（销售、营销等）有单独的 TFS 项目。在每个 TFS 项目中，我们都有一个 Main 和 Production 文件夹。我们还有一个包含数据库项目的 TFS 项目和另一个包含通用程序集/Visual Studio 项目的 TFS 项目。

发布后，我们从 Main 分支到 Production。我们没有临时分支，因为我们行动太快而无法处理。对与错，我们的生产力部分是由我们每周发布的生产级别的数量来衡量的；错误修复、新功能等。

CI 设置在 Main 分支上，这样每次签入都会导致 Build 服务器部署到我们的 DEV 环境中。然后运行单元和 Web 测试，如果成功完成，构建质量会自动设置为“开发”。当有人将构建质量更改为“暂存”时，这会导致任何先前的“暂存”构建被设置为“拒绝”，并导致该构建被推送到我们的暂存服务器，同时更新配置文件以指向正确的服务器。（为此我使用了 TFS Deployer 和 PowerShell 脚本）。

QA 对我们的登台服务器进行测试。一旦他们满意，生产团队就会将构建质量更改为“生产”。这会导致构建被发送到生产区域，然后手动复制到正确的位置。完成后，生产会通知开发人员，然后开发人员将该版本分支到生产文件夹中。QA 也会收到通知，然后谁会进行一系列生产测试，以验证一切是否确实按预期工作。

我们设置了报告来向我们展示生产版本之间存在哪些更改，以便我们了解正在部署的每个签入。这可以防止出现未知数，例如数据库更改等或其他一些潜在的破坏代码。

此外，我们的 BA 正在通过 Team System Web Access 跟踪工作项目，并知道这些项目何时投入生产。

尽管我们的 DBA 使用的是 Database Edition (GDR)，但他们对自动部署的控制水平并没有留下深刻的印象。我希望 Rosario 能够为产品线带来更好的部署控制；但在那之前，我们有 TFS Deployer 和 powershell。

* * *

## 回答 #3

> 赞同：5
> 
> 时间：2009-03-16T14:18:51.147

我们使用它们。我们保留所有模式创建/更新脚本和存储过程。主要目的是我们可以将项目连接到 SourceSafe 或 SVN。

它是一种保持 SQL 脚本版本受控的简单方法。

尝试在 VS 中进行一些 SQL 测试有点古怪，但您可以找到解决方法。

*更新*

实际上，我们将它内置到我们的部署脚本、我们的部署工具中，通过数据库项目（标记文件夹除外）并运行所有脚本。我们刚刚构建了一个运行项目的快速工具。如果有人有其他解决方案来部署数据库项目，那将很有帮助。

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2009-03-16T14:41:47.830

我们使用数据库项目为我们的 SQL 脚本提供版本控制。我们也喜欢使用 Visual Studio 环境来编辑 SQL；对于我们的一些新开发人员来说，它比查询分析器更容易使用。

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2009-05-27T20:31:33.327

我在一些付费项目中使用过它们，我认为它是一个很棒的工具。也就是说，我已经看到了一些问题。

1.  如果 db 项目文件夹中的 .dat 文件与数据库的临时实例不同步，架构比较将给出不准确的结果。不确定这是怎么发生的，如果事情看起来不对，请仔细查看架构比较并删除您的 .dat 文件（在关闭解决方案后）。

2.  如果您有 20 多个数据库并且它们相互引用并使用循环引用......它会受到伤害。我还没有想出如何让它适应这种情况。GDR 2 似乎提供了一些希望。

# sql - MySQL 查询（将插入与选择混合）

> ID：650613
> 
> 赞同：0
> 
> 时间：2009-03-16T14:16:26.380
> 
> 标签：sql, mysql, database

我在一个表中有一堆行，其中有`a`, `b`, `c`. 我希望能够选择 a = 1 的所有行，并用 a = 2 重新插入它们。基本上保持 a 列存在的所有行原样，并拥有一批新的行 a = 2。建立这种多插入查询的最佳查询是什么？这一切都发生在同一张桌子上。如果需要，我不介意使用临时的。

* * *

## 回答 #1

> 赞同：9
> 
> 时间：2009-03-16T14:20:25.543

轻松搞定。

```
INSERT INTO mytable
(a, b, c)
SELECT 2, b, c
FROM mytable
WHERE a = 1 
```

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2009-03-16T14:20:26.137

```
insert into table1 (col1, col2, col3) select col1, col2, 2 
  from table2 where col3 = 1 
```

# vb.net - 将 NHibernate 与存储库模型一起使用的最佳方式

> ID：650617
> 
> 赞同：8
> 
> 时间：2009-03-16T14:17:01.900
> 
> 标签：vb.net, nhibernate, repository

我有一个存储库类，它定义了一些基本的 Get/Save/Delete 方法。在这些内部，我使用 NHibernate 来处理我的业务实体。例如：

```
Public Class SecurityRepositoryNHibImpl : Implements ISecurityRepository
    Public Function GetUser(ByVal UUID As System.Guid) As Entities.User Implements ISecurityRepository.GetUser
        Dim eUser As Entities.User
        Using session As ISession = NHibernateHelper.OpenSession()
            eUser = session.Get(Of Entities.User)(UUID)
        End Using
        Return eUser
    End Function
End Class 
```

但是，在我的 User 类中，我有一些属性和其他对象的集合，理想情况下我希望延迟加载。但是，当然，ISession 是在存储库中创建和处置的，我猜这就是为什么，除此之外，当我尝试访问这些属性时，我会收到“无法初始化代理 - 无会话”错误。

那么我唯一的选择是在使用存储库时禁用延迟加载吗？还是有可能（或只是愚蠢）以某种方式将会话纳入业务层的范围？

我确实喜欢存储库模型，并且 NHibernate 正在我身上成长（经过很多最初的挫折试图使其工作），那么你们大师们发现一起使用它们的最佳方式是什么？

一般来说，我对 NHibernate 和存储库模型很陌生（在工作中我们仍然主要使用 VB6！），所以请原谅可能是一个愚蠢的问题。谢谢。

* * *

@mookid：谢谢老兄，这真的很有帮助，但我可能会让它打开更长的时间。它是 WCF Web 服务的后端，所有功能都是每次调用的上下文，因此每次调用的会话寿命会很好。只是不确定如何让这样的东西在业务层工作，理想情况下我不希望业务对象必须直接与任何 NHibernate 类交互。我想 NHibernate 会话的某种包装器至少将它抽象出来......嗯，你至少让我走上了正确的轨道。

* * *

看起来这里的关键词是“工作单元”，网络上存在大量与 NHibernate 相关的资源。特别是寻找[Ayende](http://ayende.com/Blog/archive/2007/06/08/Rhino-Commons-RepositoryltTgt-and-Unit-Of-Work.aspx)在 Rhino Commons 中的实现，以及他的 App Architecture 网络广播[（Hibernating Rhinos 中的第 9 号）](http://ayende.com/hibernating-rhinos.aspx)，非常有用。起初我很困惑，因为我虽然在业务层中放置“工作单元”会混合关注点，[但我很快就得到了纠正。](http://groups.google.com/group/nhusers/browse_thread/thread/6e8e76b08c05ebf)

* * *

## 回答 #1

> 赞同：12
> 
> 时间：2009-03-16T14:38:01.727

创建您的 ISession 并在您的存储库中显式地处理它对于小型且非常简单的项目来说是可以的 - 但是，正如您所发现的，当您开始想要使用 NHibernate 支持的一些很酷的功能时，它就会变得很短。

您可能应该让会话的生活方式由存储库之外的东西控制 - 例如，如果您正在执行 ASP.NET Web 应用程序，您可能希望将会话保存在当前请求中（`HttpContext.Current.Items`如果我没记错的话）持续Web 请求，然后在请求结束时提交和处置（如果发生异常则回滚）。

我不知道在 ASP.NET 应用程序中控制会话生活方式的最佳方法，但必须有某种方法可以在每个请求的开头和结尾调用代码。在 ASP.NET MVC 中，它可以通过从覆盖其`OnActionExecuting`和`OnActionExecuted`方法的基本控制器派生所有控制器来轻松完成。

# c# - ASP.NET 随机减速

> ID：650618
> 
> 赞同：1
> 
> 时间：2009-03-16T14:17:08.030
> 
> 标签：c#, asp.net, iis

我们的 ASP.NET 应用程序遇到随机间歇性减速。大多数页面需要 100-500 毫秒来呈现（取决于页面上使用了哪些模块）。然而，偶尔——也许 100 个请求中有 1 个，这些数字更像是 5000-10000 毫秒。这不是与数据库相关的问题——我已经检查过慢查询，并且与页面的复杂性无关——例如，一个需要 100 毫秒的页面在速度变慢时可能需要 10000 毫秒。我认为应用程序池也不会回收 - 通常会在任务管理器中看到这一点。它可能是GC吗？有任何想法吗？w3wp 应用程序通常始终使用稳定的 800MB-1GB 内存。

谢谢马库斯

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-03-16T14:22:12.620

我可以告诉你的最好的事情是附加一个分析器（在这个网站上搜索一个好的 .NET 分析器，我个人使用[ANTS](http://www.red-gate.com/Products/ants_profiler/index.htm)）来识别瓶颈。如果没有良好的个人资料数据，我们在这里的所有建议都只是猜测。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-03-16T14:22:12.667

应用程序是否使用缓存来维护大量静态数据？即使应用程序池没有回收，缓存中的一些大对象也可能已过期，然后需要缓存的下一个命中必须重新填充它。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-03-16T14:29:21.060

根据[Tess Ferrandez](http://blogs.msdn.com/tess/)（ASP.NET 升级工程师）的说法，您正处于 32 位服务器上的那个神奇点，您可能会开始看到内存不足异常 - 这也可能会产生影响。

她有许多关于这个主题的有用帖子：

1.  [技术资源](http://blogs.msdn.com/tess/archive/2008/11/21/slides-and-resources-for-teched-presentations-about-debugging-net-issues-with-windbg.aspx)
2.  [调试内存](http://blogs.msdn.com/tess/archive/2008/02/15/net-debugging-demos-lab-3-memory.aspx)
3.  [调试内存泄漏](http://blogs.msdn.com/tess/archive/2008/03/17/net-debugging-demos-lab-6-memory-leak.aspx)

正如其他人所说，分析器和跟踪也会有所帮助。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2009-12-10T18:29:01.760

您是否尝试过在进程内会话状态模式下运行您的 Web 应用程序，看看是否有任何区别？

# c# - 为什么javascript无法获取asp:Label innerText？

> ID：650630
> 
> 赞同：0
> 
> 时间：2009-03-16T14:21:14.543
> 
> 标签：c#, javascript, asp.net-ajax

我有两个标签：用户名和电子邮件。我使用它们来检索它们的内容并将它们作为方法参数传递。

```
var lblEmail = $get('<%= lblEmail.ClientID %>');
var email = lblEmail.innerText;

var lblUsername = '<%= lblUsername.ClientID %>';
var username = lblUsername.innerText; 
```

电子邮件标签的定义方式与用户名标签的定义方式相同，但对于最后一个我无法获取值，innertext 返回未定义。

...

```
<td class="inputField">
<table cellpadding="0" cellspacing="0" border="0">
<tr>
<asp:Label ID="lblUsername" CssClass="font1" runat="server"/>
</tr>
</table>
</td> 
```

...

```
...
<td class="inputField">
<table cellpadding="0" cellspacing="0" border="0">
<tr>
<td>
<asp:Label runat="server" ID="lblEmail" CssClass="font1" />
</td>
... 
```

有什么可能的理由来证明正在发生的事情是正当的？我怎么解决这个问题？我在页面上看到两个标签值，我将它们设置在同一个地方（当页面加载时）。

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2009-03-16T14:30:35.877

在代码的第二部分

```
var lblEmail = $get('<%= lblEmail.ClientID %>');
var email = lblEmail.innerText;

var lblUsername = '<%= lblUsername.ClientID %>';
var username = lblUsername.innerText; 
```

**$get**调用不存在。应该

```
var lblEmail = $get('<%= lblEmail.ClientID %>');
var email = lblEmail.innerText;

var lblUsername = $get('<%= lblUsername.ClientID %>');
var username = lblUsername.innerText; 
```

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2009-03-16T14:25:28.370

因为您只为 userName 标签定义了客户端 ID：

```
var lblEmail = $get('<%= lblEmail.ClientID %>');
var email = lblEmail.innerText;

var lblUsername = '<%= lblUsername.ClientID %>';
var username = lblUsername.innerText; 
```

# windows - 如何保护 Windows 中的文件

> ID：650634
> 
> 赞同：2
> 
> 时间：2009-03-16T14:21:42.217
> 
> 标签：windows, file-permissions, file-access

**更新 3：**现在使用安全选项卡限制访问。（手动）现在希望以编程方式（使用 Visual C#）以及如何在简单的用户帐户中使用管理员帐户访问文件。提示 - 我在 Windows 中注意到此功能，右键单击并使用“执行为”，输入管理员密码，然后您可以访问该文件。

**更新 2：**找到如何显示安全选项卡

> 显示安全选项卡
> 
> 在控制面板中打开文件夹选项。（单击开始，单击控制面板，单击外观和主题，然后单击文件夹选项。）
> 
> 在查看选项卡的高级设置下，清除使用简单文件共享 [推荐]。

**更新1：**我找到了以下[文章](http://technet.microsoft.com/en-us/library/bb456977.aspx)，它建议了如何授予文件权限，但是当我单击属性时我没有找到安全选项卡，你有吗？任何想法如何得到它

我有一个文件要防止被修改。不要对我说加密它，这不能解决问题，我希望用户不能更改文件，但只有我（我的程序）。是否有任何类型的 Windows 文件身份验证，我知道我所说的身份验证是愚蠢的，但是某些 Windows 文件无法访问，例如用户配置文件中的“ntuser.dat.LOG”。当我尝试打开此文件时，它不会打开。

我想要这样的东西，对于这个文件，似乎是因为 Windows 正在使用它。对。但是如果我的程序关闭了，我也不希望在这种情况下更改文件。我该怎么办？

我不要求完整的详细解决方案，我想要想法、建议、提示或任何您知道会有所帮助的东西，因为它似乎很复杂：p

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-03-16T14:27:28.443

您可以运行锁定文件或其他东西的Windows服务

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-03-16T14:29:36.440

您是在 Windows 域上，还是只是一个工作组？这是什么版本的Windows？您是计算机的管理员吗？

您应该能够获得文件的所有权，然后设置权限，以便您是唯一可以访问该文件的人。在 Windows XP 上（Vista 类似）右键单击文件并查看`Properties`. 选择`Security`选项卡，然后您可以设置文件的特定权限。您可以单击`Advanced`并设置更具体的选项。

如果您在域中，域管理员将始终能够查看/编辑您的任何文件。

编辑：来自[KB 290403](http://support.microsoft.com/kb/290403)：

> 在 Windows XP Home Edition 和 Windows XP Professional 中，如果在工作组中工作，默认情况下隐藏“安全”选项卡。出现此问题的原因是在 Windows XP Home Edition 和 Windows XP Professional 中，来宾被强制登录到工作组。

因此，如果您想这样做，您可以将计算机启动到安全模式，然后您会看到该`Security`选项卡。

您也可以取消选中`Simple file sharing`选项`Advanced`。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-03-16T14:28:39.203

撤销除您自己（或程序运行的帐户）以外的所有用户的访问权限。在 Windows 资源管理器、属性、安全中单击鼠标右键。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2009-03-16T14:28:54.727

想法，然后：修改您的文件，以便只有一个用户可以访问它。删除所有其他用户权限。将您的应用程序作为服务运行，该服务已通过唯一有权访问该文件的用户进行身份验证。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2009-03-16T14:29:39.827

您可以更改文件的权限，以使所有者成为您的应用程序在安装时创建的用户。但无论如何，管理员车会覆盖这个，我看不到成功锁定它的方法。

甚至可以关闭Windows服务，据我所知，没有绝对的解决方案。

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2009-03-16T14:29:42.183

该文件必须由 SYSTEM 用户拥有，并且只有普通用户组具有读取权限。

您的安装程序应该能够创建文件，完全控制系统，然后消除本地用户权限。除了阅读权。

* * *

## 回答 #7

> 赞同：0
> 
> 时间：2009-03-16T14:29:56.517

使用文件的内容创建一个 MD5 或类似的哈希。重新打开文件时，检查存储的哈希以确保文件没有更改。

* * *

## 回答 #8

> 赞同：0
> 
> 时间：2009-03-16T14:32:58.710

这是我的想法！可能不是很有用！

限制对文件的权限（这很常见）并确保只有您的 porgram 可以访问它。但这不是失败证明，因为管理员用户可以更改文件的安全性。

读取前 n 个字节或一些随机字节并将其存储在注册表中。下次您的程序启动时检查字节是否匹配，如果文件未更改。如果是这样，您尝试重新创建文件。

* * *

## 回答 #9

> 赞同：0
> 
> 时间：2009-03-16T14:44:48.590

做不到！

很抱歉这个直率的回答，但尽管有任何建议的软件措施来“保护”文件，但这无济于事。

如果用户真的想访问该文件，他可以简单地将硬盘插入另一台计算机并修改该文件。或者她可以使用独立于安装的操作系统运行的 Linux live CD。

* * *

## 回答 #10

> 赞同：0
> 
> 时间：2009-03-16T14:45:04.063

使用嵌入在应用程序中的私钥对文件进行签名，并在加载文件之前检查签名。每次写入文件时都必须重新签名，以便签名反映任何更改（如果文件在未经签名的情况下被修改，则在尝试加载文件时会很明显）。

注意这并不完全安全。可以想象，破解者可以从您的应用程序中提取密钥，并使用它来签署他修改后的文件版本。它不能防止恶意攻击，但可以防止普通用户修改文件。

编辑：嗯，您似乎不在乎检测文件是否被修改，您实际上想防止文件被修改。抱歉，我认为没有办法做到这一点。用户可以轻松地终止任何“锁定”文件的进程，甚至可以使用 Live CD 或其他东西启动并以这种方式编辑文件。

* * *

## 回答 #11

> 赞同：0
> 
> 时间：2009-03-16T16:49:26.840

我敢说……“ [NTFS 备用数据流](http://support.microsoft.com/kb/105763)”——请不要开枪！

是的，它们很容易修改，但一般的瘾君子不容易找到。

* * *

## 回答 #12

> 赞同：0
> 
> 时间：2017-02-16T03:53:27.280

*由于大多数版本的 Windows 不采用密码保护您的文件和文件夹的方式，因此此页面提供了加密文件和文件夹的步骤。要密码保护您在 Windows 中的文件和文件夹，您想使用第三方程序。*

**Microsoft Windows Vista、7、8 和 10 位用户**

不幸的是，Windows vista、Windows 7、Windows 8 和 Windows 10 不提供任何密码保护文件或文件夹选项。您想使用第三方软件包程序来完成此操作。如果您想对文件或文件夹进行编码，可以按照以下步骤完成：

1.  选择您要编码的文件或文件夹。
2.  右键单击文件或文件夹，然后选择属性。
3.  在常规选项卡上，单击高级按钮。
4.  选中“加密内容以保护数据”选项的复选框。
5.  单击应用，然后单击确定。

**Microsoft Windows XP 专业版用户**

以下在 Windows XP Professional 上加密文件的步骤适用于使用具有 2 个或多个帐户的笔记本电脑的用户。如果您使用单个帐户，请参阅相反的安全解决方案部分。

1.  选择您要编码的文件或文件夹。
2.  右键单击文件或文件夹，然后单击属性。
3.  在常规选项卡上，单击高级按钮。
4.  选中“加密内容以保护数据”选项。
5.  单击应用，然后单击确定。

**Microsoft Windows XP 家庭用户**

1.  选择您要编码的文件或文件夹。
2.  右键单击文件或文件夹，然后单击属性。
3.  单击共享选项卡。
4.  选中复选框将此文件夹设为私有
5.  单击应用，然后单击确定。

要了解有关此主题的更多信息，请转到[windows 中的密码学](http://goutamaman.blogspot.com/2017/01/how-to-protect-files-with-cryptography_54.html)

***来源***：- [技术](http://goutamaman.blogspot.in)

# lucene - Lucene 索引：存储和索引模式解释

> ID：650643
> 
> 赞同：45
> 
> 时间：2009-03-16T14:24:19.230
> 
> 标签：lucene

我想我仍然不了解 lucene 索引选项。

以下选项是

*   `Store.Yes`
*   `Store.No`

和

*   `Index.Tokenized`
*   `Index.Un_Tokenized`
*   `Index.No`
*   `Index.No_Norms`

我真的不明白商店的选择。为什么你不想存储你的字段？
标记化是拆分内容并删除干扰词/分隔符（如“and”、“or”等）
我不知道规范可能是什么。如何存储标记化的值？
如果我在“fieldName”中存储一个值“我的字符串”会发生什么？为什么没有查询

```
fieldName:my string 
```

退货？

* * *

## 回答 #1

> 赞同：86
> 
> 时间：2009-03-17T04:05:08.993

## 商店。是的

表示该字段的值将存储在索引中

## 店铺号

表示该字段的值*不会*存储在索引中

Store.Yes/No 不影响使用 lucene 进行索引或搜索。它只是告诉 lucene 您是否希望它充当字段中值的数据存储。如果您使用 Store.Yes，那么当您搜索时，该字段的值将包含在您的搜索结果 Documents 中。

如果您将数据存储在数据库中并且仅使用 Lucene 索引进行搜索，那么您可以在所有字段上使用 Store.No。但是，如果您也将索引用作存储，那么您将需要 Store.Yes。

## Index.Tokenized

意味着该字段在被索引时将被标记（你得到了那个）。这对于包含多个单词的长字段很有用。

## Index.Un_Tokenized

表示该字段将不被分析，并将存储为单个值。这对于*关键字/单个词*和一些短的多词字段很有用。

## 索引号

正是它所说的。该字段不会被索引，因此无法搜索。但是，您*可以*将 Index.No 与 Store.Yes 一起使用来存储您不希望可搜索的值。

## Index.No_Norms

与 Index.Un_Tokenized 相同，只是不存储一些规范化数据会节省一些字节。该数据用于增强和字段长度标准化。

为了进一步阅读，lucene javadocs 是无价的（当前 API 版本 4.4.0）：

*   [字段索引](http://lucene.apache.org/core/4_4_0/core/org/apache/lucene/document/Field.Index.html)
*   [字段存储](http://lucene.apache.org/core/4_4_0/core/org/apache/lucene/document/Field.Store.html)

对于您的最后一个问题，关于为什么您的查询没有返回任何内容，而不知道您如何索引该字段，我会说这是因为您的 fieldName 限定符仅附加到“我的”字符串。要搜索您想要的短语“我的字符串”：

> 字段名：“我的字符串”

在 fieldName 字段中同时搜索单词“my”和“string”：

> 字段名：（我的字符串）

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2014-01-14T22:11:04.217

如果任何 Java 用户偶然发现这一点，Lucene 4.6.0 Java 库中仍然存在 2009 年 3 月答案中的相同选项，但已弃用。当前设置这些选项的方法是通过[FieldType](http://lucene.apache.org/core/4_6_0/core/org/apache/lucene/document/FieldType.html)。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2017-10-19T01:50:18.840

Store.YES 将使您能够突出显示与您的搜索关键字匹配的单词（通过突出显示功能）。这意味着不仅检索，而且显示

# .net - 术语 - 可以“抛出”事件吗？

> ID：650644
> 
> 赞同：6
> 
> 时间：2009-03-16T14:24:21.010
> 
> 标签：.net, exception, events, terminology

本周两次，我读到人们写了一个事件（.net）被“抛出”。我一直认为与事件一起使用的动词是“fire”或“raise”。我认为“抛出”用于异常，但不是事件（“raise”可用于任何一种）。

是否有其他人发现“抛出”事件令人困惑？

* * *

## 回答 #1

> 赞同：18
> 
> 时间：2009-03-16T14:25:40.163

我同意，事件被引发/触发/触发。如果有任何东西被抛出，那就是例外。

* * *

## 回答 #2

> 赞同：7
> 
> 时间：2009-03-16T15:05:08.477

MSDN 库中的标准约定似乎是指[*Raising an Event*](http://msdn.microsoft.com/en-us/library/wkzf914z(VS.71).aspx) and [*Throwing an Exception*](http://msdn.microsoft.com/en-us/library/5b2yeyab(VS.71).aspx)。

* * *

## 回答 #3

> 赞同：5
> 
> 时间：2009-03-16T14:28:08.973

另一个术语是“调用”。由于事件是委托，它们被调用来调用它们，但是是的，一般术语是“解雇”或“引发”。

此外，在这种情况下使用“throw”这个词是令人困惑的，因为它会与“throw”关键字混淆。不能使用 throw 关键字抛出事件。

* * *

## 回答 #4

> 赞同：3
> 
> 时间：2009-03-16T14:26:29.647

Raise 是 MSDN 文档中最常见的动词。

我同意 - 如果我听说有东西被抛出，我认为这是一个例外。C# 语言使这一点非常明确 - throw 是用于异常的保留字。

* * *

## 回答 #5

> 赞同：3
> 
> 时间：2009-03-16T14:30:48.170

尽管有可能`throw`不是例外的事情，但很明显，这`throw`仅适用于例外情况。*Raise*确实是您用来表示事件已经发生的术语。

* * *

## 回答 #6

> 赞同：3
> 
> 时间：2009-03-16T14:39:04.127

不，它们不能被扔掉，但就像矮人和霍比特人一样，它们可以被扔掉。

* * *

## 回答 #7

> 赞同：2
> 
> 时间：2009-05-27T17:42:03.187

我认为可以抛出事件，但如果你真的这样做，那就是不称职的编码。

让我解释。在 C++ 中，您可以抛出任何类型。你可以抛出布尔值。你可以扔`enum error_type`。你可以扔`std::exception`。当然你也可以扔`struct XEvent`.

但是如果你真的做了，你很可能正在做一些非常错误或非常混乱（因此是错误的）的事情。

我完全赞成不要重载单词的含义，以避免歧义（不需要存在的地方）。

我认为“抛出”通常被理解为暗示调用堆栈展开（因为当你有一个定义明确的堆栈时，但我认为它可以扩展到一个无界入度的单链表；也就是说，一个父指针树）。让我们坚持下去。

“raise”一词也用于信号。如果也可以避免将其用于事件，那就太好了。

我更喜欢在事件发生时“触发”（“onMouseOver 事件刚刚触发”），并且可能在事件侦听器通知消费者时“被触发”（“XMouseMotionNotify 事件被发送给客户端”）。

* * *

## 回答 #8

> 赞同：1
> 
> 时间：2009-03-16T14:27:04.543

您通常会听到人们提到被解雇或引发的事件。但在我看来，投掷完全没问题。关键是他们是否说事件被抛出。

不要试图分裂成许多头发。我们的职业已经足够复杂，有成千上万种技术，更不用说考虑我们沟通方式的细微差别了。

* * *

## 回答 #9

> 赞同：1
> 
> 时间：2009-03-16T14:57:49.557

我会说你*发布*一个事件。

# python - 基于端点的旋转

> ID：650646
> 
> 赞同：2
> 
> 时间：2009-03-16T14:25:00.070
> 
> 标签：python, geometry, pygame

我正在使用 pygame 在两个任意点之间画一条线。我还想在线的行进方向上朝外的线的末端附加箭头。

在最后粘贴箭头图像很简单，但我不知道如何计算旋转度数以保持箭头指向正确的方向。

* * *

## 回答 #1

> 赞同：9
> 
> 时间：2009-03-16T16:12:37.380

这是执行此操作的完整代码。请注意，使用 pygame 时，y 坐标是从顶部开始测量的，因此在使用数学函数时我们取负数。

```
import pygame
import math
import random
pygame.init()

screen=pygame.display.set_mode((300,300))
screen.fill((255,255,255))

pos1=random.randrange(300), random.randrange(300)
pos2=random.randrange(300), random.randrange(300)

pygame.draw.line(screen, (0,0,0), pos1, pos2)

arrow=pygame.Surface((50,50))
arrow.fill((255,255,255))
pygame.draw.line(arrow, (0,0,0), (0,0), (25,25))
pygame.draw.line(arrow, (0,0,0), (0,50), (25,25))
arrow.set_colorkey((255,255,255))

angle=math.atan2(-(pos1[1]-pos2[1]), pos1[0]-pos2[0])
##Note that in pygame y=0 represents the top of the screen
##So it is necessary to invert the y coordinate when using math
angle=math.degrees(angle)

def drawAng(angle, pos):
    nar=pygame.transform.rotate(arrow,angle)
    nrect=nar.get_rect(center=pos)
    screen.blit(nar, nrect)

drawAng(angle, pos1)
angle+=180
drawAng(angle, pos2)
pygame.display.flip() 
```

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2009-03-16T15:14:25.570

我们假设 0 度表示箭头指向右侧，90 度表示指向正上方，180 度表示指向左侧。

有几种方法可以做到这一点，最简单的可能是使用 atan2 函数。如果您的起点是 (x1,y1) 并且您的终点是 (x2,y2) 那么两者之间的线的角度是：

```
import math
deg=math.degrees(math.atan2(y2-y1,x2-x1)) 
```

这将为您提供 -180 到 180 范围内的角度，因此您需要从 0 到 360 的角度，您必须照顾好自己。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2009-03-16T14:29:56.907

我将不得不查找要使用的确切函数，但是如何制作一个直角三角形，其中斜边是所讨论的线并且腿是轴对齐的，并使用一些基本的三角函数来计算基于该线的角度三角形的边长？当然，您将不得不使用已经轴对齐的特殊情况线，但这应该是微不足道的。

此外，[这篇关于斜坡的维基百科文章](http://en.wikipedia.org/wiki/Slope)可能会给您一些想法。

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2009-03-17T21:34:41.397

只是为了附加到上面的代码，你可能想要一个事件循环，这样它就不会立即退出：

```
...
clock = pygame.time.Clock()
running = True

while (running):
    clock.tick() 
```

# web-applications - JBoss Seam 教程

> ID：650647
> 
> 赞同：6
> 
> 时间：2009-03-16T14:25:16.310
> 
> 标签：web-applications, jboss, frameworks, seam

假设我是 JBoss Seam 的新手，有没有办法让我的技能加快速度？有什么好的教程吗？

* * *

## 回答 #1

> 赞同：12
> 
> 时间：2009-03-18T08:33:06.323

你可能想买一本Dan Allen写的名为“ [Seam In Action ”的书。](https://rads.stackoverflow.com/amzn/click/com/1933988401)它带您了解 Jboss Seam 粘合在一起的所有框架，而不仅仅是 Jboss Seam 本身。

除此之外，您可以从 Jboss Seam 中的示例中学到很多东西，您几乎可以开箱即用地编译和运行这些示例，或者使用 seamgen。

如果这是您第一次使用 jsf、hibernate、drools 等，并且您对双射不熟悉，请阅读本书。

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2009-12-13T00:01:41.107

Seam in Action 这本书是一本关于 Seam 框架的非常好的参考书。如果您想成为 Seam 开发人员**，请仔细阅读。****特别看一下以下主题**：

**2.3.2**与 seam-gen 的问答环节

**2.3.3**创建基本项目结构

**2.5.3**探索生成项目的结构

**2.6.2**使用IDE加速开发

**第 3 章**Seam 生命周期

**第 4 章**组件和上下文

**第 5 章**Seam 组件描述符

**第六章**绝对控制反转

**第 7 章**对话：Seam 的工作单元

**第 9 章**Seam 管理的持久性和事务

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2009-03-16T17:23:30.547

请参阅 Seam 手册，[第 1 章。Seam 教程](http://docs.jboss.com/seam/latest/reference/en-US/html/tutorial.html)。

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2009-03-25T14:48:47.897

这取决于您在**JSF 生命周期**和**EJB3（会话 Bean 和 JPA）方面的技能。**了解这些是必须了解与 Seam 的交易的必要条件。

您还应该阅读一些关于**facelets**和**Rich Faces**的内容，因为教程中的示例使用了它们。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2009-06-04T18:36:40.827

我也是 java 和 Seam 的新手，正在尝试一个相当雄心勃勃的网站！

我同意，如果您还不是 Java Web 程序员，那么这项技术的学习曲线会很陡峭。

我同意关于打破它的评论。以下是对我有帮助的事情：

Seam in Action——我无法从头到尾阅读这样的书，但我已经阅读并重读了一些开篇章节，发现它很有帮助。

从命令行的 seam-gen 和一个基本的文本编辑器开始。我最终让我的 Seam 应用程序在 Eclipse 中运行，但这并不像某些人想象的那么容易，对我来说，这只是克服的另一个障碍。我使用一个简单的 mysql 数据库作为具有 3 个实体的后端。步骤是：

```
seam setup  
seam new-project  
seam generate  
seam explode 
```

此外，由于 Seam 将 JSF 和 EJB3 “编织在一起”，因此下一步是学习其中的每一个。

我现在正在网上做一个很好的 JSF 教程。在[http://learn.exadel.com/](http://learn.exadel.com/)

如果您已经了解 Java，您可能可以相当轻松地学习 EJB3。

如果您不了解 Java，请从 www.javapassion.com 上的 Java 类介绍开始。

我仍然经常遇到撞墙事件，但情况正在好转。

TDR

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2009-07-22T11:12:27.810

Seam 手册足以启动，但您可以阅读 Seam In Action 和 code.google.com/p 以获取示例源代码。其中之一是[http://sourceforge.net/projects/tekir/](http://sourceforge.net/projects/tekir/)。Tekir 是用 Seam 编写的。

* * *

## 回答 #7

> 赞同：0
> 
> 时间：2011-12-30T08:50:12.407

您可以关注 seam 用户论坛来提高自己，我也可以在行动手册中向我建议 seam。您可以通过跟踪缝酒店预订示例了解一些情况。

好学。

# c# - C# 编译器或 JIT 在什么级别优化应用程序代码？

> ID：650652
> 
> 赞同：8
> 
> 时间：2009-03-16T14:26:53.920
> 
> 标签：c#, .net, optimization, compiler-construction, jit

我想知道这些信息以减少我的代码大小，这样我就不会浪费我的时间来优化将由编译器或 JIT 完成的事情。

例如：

如果我们假设编译器内联对属性的 get 函数的调用，那么我不必将返回值保存在局部变量中以避免函数调用。

我想推荐一个很好的参考来描述发生了什么？

* * *

## 回答 #1

> 赞同：18
> 
> 时间：2009-03-16T14:51:55.357

你可能想看看这些文章：

[JIT 优化 - (Sasha Goldshtein - CodeProject)](http://www.codeproject.com/KB/dotnet/JITOptimizations.aspx)
[Jit 优化：内联 I (David Notario)](http://blogs.msdn.com/davidnotario/archive/2004/10/28/248953.aspx)
[Jit 优化：内联 II (David Notario)](http://blogs.msdn.com/davidnotario/archive/2004/11/01/250398.aspx)

老实说，您不应该过多担心这种级别的微观细节。让编译器/JIT'er 为您担心这个问题，在几乎所有情况下它都比您做得更好。不要挂断[过早的优化](http://en.wikipedia.org/wiki/Optimization_(computer_science)#When_to_optimize)。专注于让您的代码正常工作，然后在 (a) 它运行速度不够快，(b) 您有“大小”问题时担心以后的优化。

* * *

## 回答 #2

> 赞同：17
> 
> 时间：2009-03-16T14:38:37.433

如果您担心性能，请运行分析器。**然后**改代码。很有可能，在一百万年后，您永远不会 100% 正确地猜出时间的去向。您可能会更改 0.02% 的时间，并留下造成 62% 负担的方法。你也可能使情况变得更糟。没有分析器和证据，你就是盲人。

* * *

您不能**假设**JIT 将内联属性获取器。它可能会或可能不会这样做的原因有很多；方法体的大小、虚拟、值与引用类型、架构、附加的调试器等。

“吊装”还是有一席之地的，*如果*代码在一个紧密的循环中重复调用，仍然可以实现节省；例如：

```
var count = list.Count;
for(int i = 0 ; i < count ; i++) {...} 
```

（忘记上面的`for`vs`foreach`辩论 - 这是一个正交讨论）。在上面，“提升”将有助于性能。但只是为了*真正*令人困惑 - 对于数组，情况正好相反，*不*提升它更有效：

```
for(int i = 0 ; i < arr.Length ; i++) {...} 
```

JIT 认识到这一点并删除边界检查（因为数组是固定大小的）。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2009-03-16T14:39:41.503

这看起来像是一种你不应该关注的微优化。如果我没记错的话，这取决于应用哪种优化的 CLR 的体系结构和版本。

如果你的方法被调用了这么多，并且你**真的**希望它内联，你可以自己内联它，代价是意大利面条式的代码。

我建议分析您的算法，内联方法不会节省速度，而更好的算法可以使您的运行时间从几小时减少到几秒钟。

* * *

## 回答 #4

> 赞同：-1
> 
> 时间：2009-07-27T17:25:07.913

JIT 执行的最强大的优化通常是内联。JIT 甚至可以内联数百个函数（我听说 JikesRVM 的这个数字）。他们甚至会内联并不总是可以内联的东西，并在需要时将其退出（称为动态去优化）。

一个很好的概述是[http://java.sun.com/products/hotspot/docs/whitepaper/Java_Hotspot_v1.4.1/Java_HSpot_WP_v1.4.1_1002_4.html](http://java.sun.com/products/hotspot/docs/whitepaper/Java_Hotspot_v1.4.1/Java_HSpot_WP_v1.4.1_1002_4.html)。

对于您的具体问题，我可能会说，如果有问题的函数调用是*hot*。

# web-services - 有哪些很好的资源可用于设计可以很好扩展的基于 Web 服务的架构？

> ID：650654
> 
> 赞同：3
> 
> 时间：2009-03-16T14:27:12.437
> 
> 标签：web-services, architecture, resources, scalability

我有一个 Web 应用程序，目前有大约 500,000 个用户，平均每小时大约 500 个页面浏览量，我们预计在明年内必须扩展到 20,000,000 个用户。

我们当前的系统无法处理这种规模，因此我们需要转向可以处理的系统。

我在想基于服务的架构会更加健壮，并允许组件服务相互独立地扩展，也可以独立于主应用程序进行扩展。

但有人警告我，可以很容易地设计一个无法很好扩展的服务架构，而且由于我几乎没有设计这样一个系统的经验，因此通过一些推荐的资源可能比仅仅“尝试一下”要好。 "

那么，推荐哪些资源来构建一个可扩展的系统呢？该平台是.Net，但我想同样的信息适用于任何基于服务的架构，无论平台如何。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-03-22T10:59:13.137

我首先要回答 Gennady Shumakher 的评论 - “目前您认为不可扩展的系统瓶颈是什么？”。一旦知道了这一点，您就可以专门处理它，然后根据需要处理整个应用程序。

一项有趣的研究是推特。它开始时只有少量请求，但已迅速发展成为一个使用量很大的平台，拥有全球流量。[这](http://www.businessinsider.com/2008/5/why-can-t-twitter-scale-blaine-cook-tries-to-explain)可能很有用。[这个关于可扩展性的博客](http://highscalability.com/flickr-architecture)可能也很有趣。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2009-05-13T16:41:36.003

我想推荐 Ebay[架构原理演示文稿](http://www.infoq.com/presentations/shoup-ebay-architectural-principles)以及演示文稿的好[文章](http://www.infoq.com/articles/ebay-scalability-best-practices)。实际上，Ebay 采用了典型的面向服务的方法。服务由函数提取，每个服务都可以独立扩展。我认为有一些你可以学习的好点。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2009-03-16T14:48:21.060

理论上它可以扩展，但你需要小心延迟。假设您将一个模块外部化，现在您可以拥有两个服务，代替一个服务，但是在发送、处理、回复外部服务上的一个请求所花费的时间里，您可能已经处理了 100 个内部请求，所以除非您有100 台服务器实际上会降低吞吐量，但无论哪种方式，使用 100 台服务器与 1 台服务器相比，您在维护和空间方面付出的代价要高得多。根据经验，如果您需要发送大量数据，通常必须衡量延迟和处理之间的平衡数据，您最好不要将该步骤分离到服务中。幸运的是，您有一个正在运行的系统，您可以根据该系统进行测量，大多数人不得不仅根据规格来猜测这一点。

因此，请考虑您的数据流模式并偏爱局部性，将您的应用程序切入服务中是一门艺术，而不是反对它。

您可能有兴趣阅读并发模式，因为它归结为。

# c# - 如何将接口方法的返回类型定义为另一个接口？

> ID：650663
> 
> 赞同：12
> 
> 时间：2009-03-16T14:29:28.720
> 
> 标签：c#, interface

我是接口和抽象类的新手。我想创建几个接口来为购物车系统的对象定义核心方法和变量。然后我想创建实现核心功能的抽象类。这个想法是它们可以被其他类以稍微不同的方式用于不同的项目。

这是我的（精简）界面：

```
public interface ICart
{
    ...
    List<ICartItem> CartItems { get; set; }
}

public interface ICartItem
{
    int ProductId { get; set; }
    int Quantity { get; set; }
} 
```

这是我实现 ICart 的抽象 Cart 类（同样，只显示相关行）：

```
public abstract class Cart : ICart
{

    private List<CartItem> _cartItems = new List<CartItem>();

    public List<CartItem> CartItems 
    {
        get
        {
            return _cartItems;
        }
    }
} 
```

还有我的实现 ICartItem 的 CartItem 类：

```
public abstract class CartItem : ICartItem
{
    ...
} 
```

当我尝试编译这些类时，我收到一条错误消息：“Cart”没有实现接口成员“CartItems”。“Cart.CartItems”无法实现“ICart.CartItems”，因为它没有 System.Collections.Generic.List<ICartItem> 的匹配返回类型。

我认为这里的想法是接口可以由许多类实现，这些类以不同的方式执行核心功能并添加新方法等。为什么我的接口需要知道实际使用的是什么类，只要因为那个类实际上正确地实现了接口？

* * *

## 回答 #1

> 赞同：20
> 
> 时间：2009-03-16T14:32:29.493

您需要在 C# 2 中使用泛型来实现：

```
public interface ICart<T> where T : ICartItem
{
    // ...
    List<T> CartItems { get; set; }
}

public abstract class Cart : ICart<CartItem>
{
    // ...
    public List<CartItem> CartItems { get; set; }
} 
```

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2009-03-16T14:34:08.020

在您的抽象类中，您应该定义 CartItems 属性的返回类型是 type `List<ICartItem>`。

但是，如果您真的希望该属性是 type `List<CartItem>`，您可以这样做：

```
public interface ICart<TCartItem> where TCartItem : ICartItem
{
   List<TCartItem> CartItems { get; set; }
}

public interface ICartItem
{
}

public abstract class Cart : ICart<CartItem>
{
     public List<CartItem> { get; set; }
}

public abstract class CartItem : ICartItem
{
} 
```

* * *

## 回答 #3

> 赞同：3
> 
> 时间：2009-03-16T14:35:29.127

这是一个反/协方差的问题。

进行此编译需要 2 处更改。

1）去掉接口属性上的“set”选项。（它只是实现一个 get; 属性，无论如何，这是最有意义的）

2) 将购物车更改为：

```
`public abstract class Cart : ICart
{

```
private List<CartItem> _cartItems = new List<CartItem>();

public List<ICartItem> CartItems 
{ ... 
```` 

我还强烈建议您更改界面以公开 IList 而不是 List。设计指南（和 FxCop）建议不要在公共界面中公开 List。List 是一个实现细节 - IList 是适当的接口/返回类型。

* * *

## 回答 #4

> 赞同：2
> 
>             
> 
> 时间：2009-03-16T14:42:38.577

接口是一种协议。如果你愿意，你和任何使用你的班级的人之间的合同。通过告诉人们您正在实现 ICart 接口，您向他们保证接口中的所有方法都存在于您的类中。因此，您的所有方法都必须与接口方法的签名相匹配。

为了返回*实现*ICartItem 的项目列表，您需要按照 DrJokepu 的建议使用泛型。这告诉大家，该接口只提供了一个实现 ICartItem 的对象列表，而不是具体的 ICartItem。

```
public interface ICart<T> where T : ICartItem
{
    List<T> CartItems { get; set; }
} 
```

* * *

## 回答 #5

> 赞同：0
> 
>             
> 
> 时间：2009-03-16T14:32:53.470

ICart 为 CartItems 指定了一个 getter 和 setter，但您的实现只有一个 get。

* * *

## 回答 #6

> 赞同：0
> 
>             
> 
> 时间：2012-01-31T22:45:09.127

有两种方法可以做到这一点。您可以使用泛型或显式实现接口成员。

泛型

```
public interface ICart<TCartItem> where TCartItem : ICartItem
{
    ...
    List<TCartItem> CartItems { get; set; }
}

public interface ICartItem
{
    int ProductId { get; set; }
    int Quantity { get; set; }
}

public abstract class Cart : ICart<CartItem>
{

    private List<CartItem> _cartItems = new List<CartItem>();

    public List<CartItem> CartItems 
    {
        get
        {
            return _cartItems;
        }
    }
}
public abstract class CartItem : ICartItem
{
    ...
} 
```

显式实现的成员

```
public interface ICart
{
    ...
    List<ICartItem> CartItems { get; set; }
}
public interface ICartItem
{
    int ProductId { get; set; }
    int Quantity { get; set; }
}

public abstract class Cart : ICart
{
    private List<CartItem> _cartItems = new List<CartItem>();

    List<ICartItem> ICart.CartItems
    {
       get
       {
           return CartItems;
       }
    }
    public List<CartItem> CartItems 
    {
        get
        {
            return _cartItems;
        }
    }
}
public abstract class CartItem : ICartItem
{
    ...
} 
```

# java - 休眠教程

> ID：650680
> 
>         
> 
> 赞同：13
> 
>         
> 
> 时间：2009-03-16T14:32:01.413
> 
>         
> 
> 标签：java, hibernate

假设我是 Hibernate 的新手，有没有办法让我的技能加快速度？有什么好的教程吗？

* * *

## 回答 #1

> 赞同：7
> 
>             
> 
> 时间：2009-03-16T14:35:00.907

Hibernate.org 指出这一点开始：
 [Hibernate 入门](http://www.hibernate.org/152.html)

然后我会推荐阅读这本非常好的书：
 [Java Persistence with Hibernate（Christian Bauer 和 Gavin King）](http://www.manning.com/bauer2/)

* * *

## 回答 #2

> 赞同：3
> 
>             
> 
> 时间：2009-03-16T14:38:35.593

Hibernate.org 的教程：

[http://www.hibernate.org/hib_docs/v3/reference/en/html/tutorial.html](http://www.hibernate.org/hib_docs/v3/reference/en/html/tutorial.html)

不过，这取决于您是否只是想在不了解 Hibernate 是什么的情况下进入 Hibernate，或者只是想深入了解您遇到的第一个教程？

如果您想基本了解 Hibernate 是什么，请查看此链接（非常简单，简短阅读）：

[http://www.laliluna.de/what-is-hibernate.html](http://www.laliluna.de/what-is-hibernate.html)

对于对 Hibernate 一无所知（有用）的外行来说，他们将其简化到足以掌握它是什么以及它是如何工作的。

* * *

## 回答 #3

> 赞同：2
> 
>             
> 
> 时间：2009-03-16T14:37:58.607

Java Passion 中有 J2EE 课程，其中有关于 Hibernate的完整[部分。](http://www.javapassion.com/j2ee/#Hibernate)

* * *

## 回答 #4

> 赞同：0
> 
>             
> 
> 时间：2009-09-18T19:23:28.270

这是一个关于如何在 Eclipse 中设置休眠和创建第一个应用程序的屏幕截图教程。浏览这个[休眠教程](http://www.skill-guru.com/blog/2009/08/05/first-hibernate-tutorial-%E2%80%93get-hands-on-experience/)

如果您正在寻找阅读此[Hibernate JPA 教程的内容](http://www.skill-guru.com/blog/2009/08/06/hibernate-tutorial-continued-using-annotations/)

# database - 从 ActionScript3 连接到 SQL server2005

> ID：650682
> 
>         
> 
> 赞同：0
> 
>         
> 
> 时间：2009-03-16T14:32:39.943
> 
>         
> 
> 标签：database, actionscript-3, sql-server-2005, connection

我想从 ActionScript3 连接到数据库 SQL2005，我需要从 actionscript 执行查询语句！谁能告诉我请代码来做到这一点？？？？我搜索了这个问题，结果没有帮助我，因为代码不起作用所以我很困惑。

* * *

## 回答 #1

> 赞同：1
> 
>             
> 
> 时间：2009-05-25T11:21:05.277

在 adobe air 中尝试此代码

```
import flash.display.*;
import flash.data.*;
//import flash.data.SQLSchema;
import flash.events.SQLEvent;
import flash.events.SQLErrorEvent;
import flash.data.SQLConnection;
import flash.data.SQLStatement;
import flash.errors.SQLError;
//import flash.filesystem;

var conn:SQLConnection;
var dbStatement:SQLStatement;

 trace("sandeep mittal");
 init();

function init():void
{
    conn = new SQLConnection();
    conn.addEventListener(SQLEvent.OPEN, connOpenHandler);
    trace("sandeep mittal");
    dbStatement = new SQLStatement();
    dbStatement.sqlConnection = conn;
    dbStatement.text = "SELECT id, name, ssn FROM employees";

    var dbFile:File = new File(File.separator + "");
    conn.open(dbFile);
}

function connOpenHandler(e:SQLEvent):void
{
    trace("Sandeep Mittal");
    dbStatement.addEventListener(SQLEvent.RESULT, resultHandler);
    dbStatement.addEventListener(SQLErrorEvent.ERROR, errorHandler);
    dbStatement.execute();
}

function resultHandler(even:SQLEvent):void
{
    var result1:SQLResult = dbStatement.getResult();
    if (result1 != null)
    {
        var numRows:int = result1.data.length;
        for (var i:int = 0; i < numRows; i++)
        {
            var row:Object = result1.data[i];
            trace("id:", row.id, ", name:", row.name, ", ssn:", row.ssn);
        }
    }
}
function errorHandler(event:SQLErrorEvent):void
{
    trace("An error occured while executing the statement.");
} 
```

# c# - 在 log4net 中以编程方式更改日志级别？

> ID：650694
> 
>         
> 
> 赞同：17
> 
>         
> 
> 时间：2009-03-16T14:37:21.493
> 
>         
> 
> 标签：c#, log4net

有没有办法以编程方式在 log4net 中设置日志级别？我以为会有一个属性可以让你这样做，但我似乎找不到。

我想要做的是有一个可配置的选项来进入调试模式。这将导致额外的日志记录。

我正在使用单独的 log4net 配置 xml 文件。目前我提出的解决方案如下：

1.  使用 dom 编辑日志文件，然后调用 XMLConfigurator 根据文件配置日志文件。

2.  有两个日志配置文件，并在选项更改时调用 xml Configurator 以使用相应的日志配置文件。

我倾向于2，有什么理由这行不通吗？

* * *

## 回答 #1

> 赞同：28
> 
>             
> 
> 时间：2009-03-16T15:40:52.447

您可以以编程方式更改 log4net 记录器的日志记录级别，但如何做到这一点并不明显。我有一些代码可以做到这一点。鉴于此记录器：

```
private readonly log4net.ILog mylogger; 
```

您必须执行以下花哨的步骤才能将其设置为 Debug：

```
((log4net.Repository.Hierarchy.Logger)mylogger.Logger).Level = log4net.Core.Level.Debug; 
```

* * *

## 回答 #2

> 赞同：7
> 
>             
> 
> 时间：2009-03-16T15:34:01.450

这是我以编程方式配置 log4net 的方式：

```
//declared as a class variable   
private static readonly ILog logger = LogManager.GetLogger(MethodBase.GetCurrentMethod().DeclaringType);

 PatternLayout layout = new PatternLayout(@"%date %-5level %message%newline");
    RollingFileAppender appender = new RollingFileAppender();
    appender.Layout = layout;
    appender.File = "c:\log.txt";
    appender.AppendToFile = true;
    appender.MaximumFileSize = "1MB";
    appender.MaxSizeRollBackups = 0; //no backup files
    appender.Threshold = Level.Error;
    appender.ActivateOptions();                       
    log4net.Config.BasicConfigurator.Configure(appender); 
```

我认为 Appender 的 Threshold 属性是您要寻找的，它将控制 appender 将输出的日志记录级别。

log4net[手册](http://logging.apache.org/log4net/release/manual/configuration.html)有很多很好的配置示例。

* * *

## 回答 #3

> 赞同：0
> 
>             
> 
> 时间：2009-05-20T08:57:32.433

[您可以从这里](http://fs18545.flosoft-servers.net/StackOverflow/DynTurnOnLoggingLevelOnLog4Net.zip)下载示例项目或复制粘贴下面的代码。代码末尾是保存日志信息的表的 DDL SQL ..

```
 using System;
  using System.Collections.Generic;
  using System.Text;
  using log4net;
  using log4net.Config;
  using NUnit.Framework;
  using GenApp.Utils; 

  namespace ExampleConsoleApplication
  {

    class TestClass
    {

        private static readonly ILog logger =
                 LogManager.GetLogger ( typeof ( TestClass ) );

        static void Main ( string[] args )
        {
        TestClass objTestClass = new TestClass ();
  //log4net.Appender.ColoredConsoleAppender.Colors.HighIntensity
        GenApp.Bo.UserSettings us = new GenApp.Bo.UserSettings ();
        GenApp.Bo.User userObj = new GenApp.Bo.User ()
        {

          UserSettings = us

        };
        userObj.UserSettings.LogLevel = 4; 

        #region SetDynamicallyLogLevel

        Logger.Debug ( userObj, logger, " -- Debug msg -- " );
        Logger.Info ( userObj, logger, " -- Info msg -- " );
        Logger.Warn ( userObj, logger, " -- Warn msg -- " );
        Logger.Error ( userObj, logger, " -- Error msg -- " );
        Logger.Fatal ( userObj, logger, " -- Fatal msg -- " );
        #endregion SetDynamicallyLogLevel

        #region RemoveDynamicallyAppenders
        Logger.SetThreshold ( "LogFileAppender", log4net.Core.Level.Off );

        //and echo again
        Logger.Debug ( userObj, logger, " -- Debug msg -- " );
        Logger.Info ( userObj, logger, " -- Info msg -- " );
        Logger.Warn ( userObj, logger, " -- Warn msg -- " );
        Logger.Error ( userObj, logger, " -- Error msg -- " );
        Logger.Fatal ( userObj, logger, " -- Fatal msg -- " );

        #endregion RemoveDynamicallyAppenders

        Console.WriteLine ( " END HIT A KEY TO EXIT " );
            Console.ReadLine ();
            } //eof method 

    } //eof class 

  } //eof namespace 

  /* App.config CopyPaste 
  <?xml version="1.0" encoding="utf-8" ?>
<configuration>
<configSections>
  <section name="log4net"
       type="log4net.Config.Log4NetConfigurationSectionHandler, log4net" />
</configSections>

<log4net>
  <appender name="LogFileAppender" type="log4net.Appender.FileAppender">
    <param name="File" value="Program.log" />
    <param name="AppendToFile" value="true" />
    <layout type="log4net.Layout.PatternLayout">
      <!--<param name="Header" value="======================================" />
      <param name="Footer" value="======================================" />-->
      <param name="ConversionPattern" value="%date{yyyy'.'MM'.'dd --- HH':'mm':'ss'.'fff} [%t] %-5p -- %m%n" />
    </layout>
  </appender>

  <appender name="ColoredConsoleAppender" type="log4net.Appender.ColoredConsoleAppender">
    <mapping>
      <level value="ERROR" />
      <foreColor value="Red" />
    </mapping>
    <mapping>
      <level value="DEBUG" />
      <foreColor value="HighIntensity" />
    </mapping>
    <mapping>
      <level value="INFO" />
      <foreColor value="Green" />
    </mapping>
    <mapping>
      <level value="WARN" />
      <foreColor value="Yellow" />
    </mapping>
    <mapping>
      <level value="FATAL" />
      <foreColor value="White" />
      <backColor value="Red" />
    </mapping>

    <layout type="log4net.Layout.PatternLayout">
      <!-- You could change here the date format -->
      <conversionPattern value="%date{yyyy'.'MM'.'dd --- HH':'mm':'ss'.'fff}  [%thread] %-5level %logger [%property{NDC}] - %message%newline" />
    </layout>
  </appender>

  <appender name="AdoNetAppender" type="log4net.Appender.AdoNetAppender">
    <connectionType value="System.Data.SqlClient.SqlConnection, System.Data, Version=1.2.10.0, Culture=neutral, PublicKeyToken=b77a5c561934e089" />
    <connectionString value="data source=ysg;initial catalog=DBGA_DEV;integrated security=true;persist security info=True;" />
    <commandText value="INSERT INTO [DBGA_DEV].[ga].[tb_Data_Log] ([Date],[Thread],[Level],[Logger],[Message]) VALUES (@log_date, @thread, @log_level, @logger, @message)" />

    <parameter>
      <parameterName value="@log_date" />
      <dbType value="DateTime" />
      <layout type="log4net.Layout.PatternLayout" value="%date{yyyy'.'MM'.'dd HH':'mm':'ss'.'fff}" />
    </parameter>
    <parameter>
      <parameterName value="@thread" />
      <dbType value="String" />
      <size value="255" />
      <layout type="log4net.Layout.PatternLayout" value="%thread" />
    </parameter>
    <parameter>
      <parameterName value="@domainName" />
      <dbType value="String" />
      <size value="255" />
      <layout type="log4net.Layout.PatternLayout" value="%user" />
    </parameter>
    <parameter>
      <parameterName value="@log_level" />
      <dbType value="String" />
      <size value="50" />
      <layout type="log4net.Layout.PatternLayout" value="%level" />
    </parameter>
    <parameter>
      <parameterName value="@logger" />
      <dbType value="String" />
      <size value="255" />
      <layout type="log4net.Layout.PatternLayout" value="%logger" />
    </parameter>
    <parameter>
      <parameterName value="@message" />
      <dbType value="String" />
      <size value="4000" />
      <layout type="log4net.Layout.PatternLayout" value="%message" />
    </parameter>
  </appender>
  <root>
    <level value="ALL" />
    <appender-ref ref="LogFileAppender" />
    <appender-ref ref="AdoNetAppender" />
    <appender-ref ref="ColoredConsoleAppender" />
  </root>
</log4net>
</configuration>
   */
  #region TheReferencesInThecsprojFile
  //<Reference Include="log4net, Version=1.2.10.0, Culture=neutral, PublicKeyToken=1b44e1d426115821, processorArchitecture=MSIL">
  //  <SpecificVersion>False</SpecificVersion>
  //  <HintPath>..\..\..\Log4Net\log4net-1.2.10\bin\net\2.0\release\log4net.dll</HintPath>
  //</Reference>
  //<Reference Include="nunit.framework, Version=2.4.8.0, Culture=neutral, PublicKeyToken=96d09a1eb7f44a77, processorArchitecture=MSIL" />
  #endregion TheReferencesInThecsprojFile

namespace GenApp.Bo
{
  public class User
  {

    public int LogLevel { get; set; }
    public UserSettings UserSettings { get; set; }

  } //eof class 

  public class UserSettings
  {
    public int LogLevel;
  }

} //eof namespace 

namespace GenApp.Utils
{
  ///<version> 1.1 </version>
  ///<author> Yordan Georgiev </author>
  ///<summary> Wrapper around log4net with dynamically adjustable verbosity</summary>
  public class Logger
  {

    private static Logger inst = new Logger ();
    public static Logger Inst ()
    {
      inst.ConfigureLogging ();
      return inst;
    }

    public enum DebugLevel : int
    {
      Fatal_Msgs = 0,
      Fatal_Error_Msgs = 1,
      Fatal_Error_Warn_Msgs = 2,
      Fatal_Error_Warn_Info_Msgs = 3,
      Fatal_Error_Warn_Info_Debug_Msgs = 4
    }

    public static void Debug ( GenApp.Bo.User userObj, ILog logger, string msg )
    {
      DebugLevel debugLevel = (DebugLevel)userObj.UserSettings.LogLevel;
      string strLogLevel = Logger.GetLogTypeString ( debugLevel );
      inst.SetLogingLevel ( strLogLevel );
      logger.Debug ( msg );

    } //eof method 

    public static void Info ( GenApp.Bo.User userObj, ILog logger, string msg )
    {
      DebugLevel debugLevel = (DebugLevel)userObj.UserSettings.LogLevel;
      string strLogLevel = Logger.GetLogTypeString ( debugLevel );
      inst.SetLogingLevel ( strLogLevel );
      logger.Info ( msg );

    } //eof method 

    public static void Warn ( GenApp.Bo.User userObj, ILog logger, string msg )
    {
      DebugLevel debugLevel = (DebugLevel)userObj.UserSettings.LogLevel;
      string strLogLevel = Logger.GetLogTypeString ( debugLevel );
      inst.SetLogingLevel ( strLogLevel );
      logger.Warn ( msg );

    } //eof method 

    public static void Error ( GenApp.Bo.User userObj, ILog logger, string msg )
    {
      DebugLevel debugLevel = (DebugLevel)userObj.UserSettings.LogLevel;
      string strLogLevel = Logger.GetLogTypeString ( debugLevel );
      inst.SetLogingLevel ( strLogLevel );
      logger.Error ( msg );
    } //eof method 

    public static void Fatal ( GenApp.Bo.User userObj, ILog logger, string msg )
    {
      DebugLevel debugLevel = (DebugLevel)userObj.UserSettings.LogLevel;
      string strLogLevel = Logger.GetLogTypeString ( debugLevel );
      inst.SetLogingLevel ( strLogLevel );
      logger.Fatal ( msg );
    } //eof method 

    /// <summary>
    /// Activates debug level 
    /// </summary>
    /// <sourceurl>http://geekswithblogs.net/rakker/archive/2007/08/22/114900.aspx</sourceurl>
    private void SetLogingLevel ( string strLogLevel )
    {

      this.ConfigureLogging ();
      string strChecker = "WARN_INFO_DEBUG_ERROR_FATAL";

      if (String.IsNullOrEmpty ( strLogLevel ) == true || strChecker.Contains ( strLogLevel ) == false)
        throw new ArgumentOutOfRangeException ( " The strLogLevel should be set to WARN , INFO , DEBUG ," );

      log4net.Repository.ILoggerRepository[] repositories = log4net.LogManager.GetAllRepositories ();

      //Configure all loggers to be at the debug level.
      foreach (log4net.Repository.ILoggerRepository repository in repositories)
      {
        repository.Threshold = repository.LevelMap[strLogLevel];
        log4net.Repository.Hierarchy.Hierarchy hier = (log4net.Repository.Hierarchy.Hierarchy)repository;
        log4net.Core.ILogger[] loggers = hier.GetCurrentLoggers ();
        foreach (log4net.Core.ILogger logger in loggers)
        {
          ( (log4net.Repository.Hierarchy.Logger)logger ).Level = hier.LevelMap[strLogLevel];
        }
      }

      //Configure the root logger.
      log4net.Repository.Hierarchy.Hierarchy h = (log4net.Repository.Hierarchy.Hierarchy)log4net.LogManager.GetRepository ();
      log4net.Repository.Hierarchy.Logger rootLogger = h.Root;
      rootLogger.Level = h.LevelMap[strLogLevel];
    }

    ///<summary>
    ///0 -- prints only FATAL messages 
    ///1 -- prints FATAL and ERROR messages 
    ///2 -- prints FATAL , ERROR and WARN messages 
    ///3 -- prints FATAL  , ERROR , WARN and INFO messages 
    ///4 -- prints FATAL  , ERROR , WARN , INFO and DEBUG messages 
    ///</summary>
    private static string GetLogTypeString ( DebugLevel debugLevel )
    {

      string srtLogLevel = String.Empty;
      switch (debugLevel)
      {
        case DebugLevel.Fatal_Msgs:
          srtLogLevel = "FATAL";
          break;
        case DebugLevel.Fatal_Error_Msgs:
          srtLogLevel = "ERROR";
          break;
        case DebugLevel.Fatal_Error_Warn_Msgs:
          srtLogLevel = "WARN";
          break;
        case DebugLevel.Fatal_Error_Warn_Info_Msgs:
          srtLogLevel = "INFO";
          break;
        case DebugLevel.Fatal_Error_Warn_Info_Debug_Msgs:
          srtLogLevel = "DEBUG";
          break;
        default:
          srtLogLevel = "FATAL";
          break;
      } //eof switch
      return srtLogLevel;

    } //eof GetLogTypeString

    /// <summary>
    /// The path where the configuration is read from.
    /// This value is set upon a call to ConfigureLogging().
    /// </summary>
    private string configurationFilePath;
    public void ConfigureLogging ()
    {
      lock (this)
      {
        bool configured = false;

        #region ConfigureByThePathOfTheEntryAssembly
        // Tells the logging system the correct path.
        Assembly a = Assembly.GetEntryAssembly ();

        if (a != null && a.Location != null)
        {
          string path = a.Location + ".config";

          if (File.Exists ( path ))
          {
            log4net.Config.DOMConfigurator.Configure (
              new FileInfo ( path ) );
            configurationFilePath = path;
            configured = true;
          }
          else
          {
            path = FindConfigInPath ( Path.GetDirectoryName ( a.Location ) );
            if (File.Exists ( path ))
            {
              log4net.Config.DOMConfigurator.Configure (
                new FileInfo ( path ) );
              configurationFilePath = path;
              configured = true;
            }
          }
        }
        #endregion ConfigureByThePathOfTheEntryAssembly

        #region ConfigureByWeb.config
        //// Also, try web.config.
        //if (!configured)
        //{
        //  if (HttpContext.Current != null &&
        //    HttpContext.Current.Server != null &&
        //    HttpContext.Current.Request != null)
        //  {
        //    string path = HttpContext.Current.Server.MapPath (
        //      HttpContext.Current.Request.ApplicationPath );

        //    path = path.TrimEnd ( '\\' ) + "\\Web.config";

        //    if (File.Exists ( path ))
        //    {
        //      log4net.Config.DOMConfigurator.Configure (
        //        new FileInfo ( path ) );
        //      configurationFilePath = path;
        //      configured = true;
        //    }
        //  }
        //}
        #endregion ConfigureByWeb.config

        #region ConfigureByThePathOfTheExecutingAssembly
        if (!configured)
        {
          // Tells the logging system the correct path.
          a = Assembly.GetExecutingAssembly ();

          if (a != null && a.Location != null)
          {
            string path = a.Location + ".config";

            if (File.Exists ( path ))
            {
              log4net.Config.DOMConfigurator.Configure (
                new FileInfo ( path ) );
              configurationFilePath = path;
              configured = true;
            }
            else
            {
              path = FindConfigInPath ( Path.GetDirectoryName ( a.Location ) );
              if (File.Exists ( path ))
              {
                log4net.Config.DOMConfigurator.Configure (
                  new FileInfo ( path ) );
                configurationFilePath = path;
                configured = true;
              }
            }
          }
        }
        #endregion ConfigureByThePathOfTheExecutingAssembly

        #region ConfigureByThePathOfTheCallingAssembly
        if (!configured)
        {
          // Tells the logging system the correct path.
          a = Assembly.GetCallingAssembly ();

          if (a != null && a.Location != null)
          {
            string path = a.Location + ".config";

            if (File.Exists ( path ))
            {
              log4net.Config.DOMConfigurator.Configure (
                new FileInfo ( path ) );
              configurationFilePath = path;
              configured = true;
            }
            else
            {
              path = FindConfigInPath ( Path.GetDirectoryName ( a.Location ) );
              if (File.Exists ( path ))
              {
                log4net.Config.DOMConfigurator.Configure (
                  new FileInfo ( path ) );
                configurationFilePath = path;
                configured = true;
              }
            }
          }
        }
        #endregion ConfigureByThePathOfTheCallingAssembly

        #region ConfigureByThePathOfTheLibIsStored
        if (!configured)
        {
          // Look in the path where this library is stored.
          a = Assembly.GetAssembly ( typeof ( Logger ) );

          if (a != null && a.Location != null)
          {
            string path = FindConfigInPath ( Path.GetDirectoryName ( a.Location ) );
            if (File.Exists ( path ))
            {
              log4net.Config.DOMConfigurator.Configure (
                new FileInfo ( path ) );
              configurationFilePath = path;
              configured = true;
            }
          }
        }
        #endregion ConfigureByThePathOfTheLibIsStored

      } //eof lock   
    } //eof method 

    /// <summary>
    /// Searches for a configuration file in the given path.
    /// </summary>
    private string FindConfigInPath (
      string path )
    {
      string[] files = Directory.GetFiles ( path );

      if (files != null && files.Length > 0)
      {
        foreach (string file in files)
        {
          if (Path.GetExtension ( file ).Trim ( '.' ).ToLower (
            CultureInfo.CurrentCulture ) == "config")
          {
            return file;
          }
        }
      }

      // Not found.
      return string.Empty;
    } //eof method 

    /// <summary>
    /// Remove dynamically appenders
    /// </summary>
    /// <param name="appenderName"></param>
    /// <param name="threshold"></param>
    public static void SetThreshold ( string appenderName, Level threshold )
    {
      foreach (AppenderSkeleton appender in LogManager.GetRepository ().GetAppenders ())
      {
        if (appender.Name == appenderName)
        {
          appender.Threshold = threshold;
          appender.ActivateOptions ();

          break;
        }
      }
    } //eof method 

  } //eof class 

} //eof namespace 

USE [DBGA_DEV]
GO

/****** Object:  Table [ga].[tb_Data_Log]    Script Date: 05/20/2009 12:16:01 ******/
SET ANSI_NULLS ON
GO

SET QUOTED_IDENTIFIER ON
GO

SET ANSI_PADDING ON
GO

CREATE TABLE [ga].[tb_Data_Log](
    [ID] [int] IDENTITY(1,1) NOT NULL,
    [Date] [datetime] NOT NULL,
    [Thread] [varchar](255) NOT NULL,
    [Level] [varchar](20) NOT NULL,
    [Logger] [varchar](255) NOT NULL,
    [Message] [varchar](4000) NOT NULL
) ON [PRIMARY]

GO

SET ANSI_PADDING ON
GO 
```

* * *

## 回答 #4

> 赞同：-1
> 
>             
> 
> 时间：2009-03-16T15:52:50.063

这是您对米奇回答的评论的后续行动。

虽然您可能能够以编程方式设置级别，但为什么不将日志级别设置为调试呢？这样您的用户就不必担心将日志级别设置为调试，相信我，当您需要它时，它永远不会打开。

然后，当发生错误时，只需让用户将完整的日志文件发送给您，并使用[Apache Chainsaw](http://logging.apache.org/chainsaw/index.html)之类的日志查看器来选择性地仅查看您想要查看的级别。

另一种解决方案是将不同级别记录到单独的文件中。这样您就可以让用户只向您发送您想要查看的级别。

# iphone - RESTful iPhone 客户端和模型层次结构

> ID：650700
> 
>         
> 
> 赞同：0
> 
>         
> 
> 时间：2009-03-16T14:38:36.060
> 
>         
> 
> 标签：iphone, cocoa, cocoa-touch, web-services, rest

我很好奇你们中的大多数人正在采用什么策略来构建关于模型层次结构的可靠 RESTful iPhone 客户端。我所说的模型层次结构的意思是我有一个 REST 服务器，其中几个资源相互关联。例如，假设出于假设目的，我有一个 REST 服务器，它可以输出有关学校的信息。如果我想获取特定班级的所有学生，我首先需要查询 REST 服务器以获取有关学校的信息，然后我需要查询服务器以获取有关学校必须提供的所有班级的信息，然后是对特定班级的所有学生的后续请求。最终，客户端引入了 3 个独特的 XML 树。在那时候，你们大多数人是否编写自己的算法来构建最终将成为您的数据源的树？您是否在这方面不聚合 XML 树，而是使用不同的方法？

您更喜欢在服务器上获取无数相关资源并将它们放入一棵对客户端有意义的树中？

感谢您的洞察力。

* * *

## 回答 #1

> 赞同：2
> 
>             
> 
> 时间：2009-03-16T15:38:35.013

您选择如何在 iPhone 上存储管理模型数据可能取决于您正在处理的 XML 数据有多少变化，以及它可能会变得多么臃肿。

如果这是一个不太可能更改的简单 XML 模型，并且不携带太多冗余信息，那么您最好直接使用您描述的 XML 树。

但是对于稍微复杂一点的东西，我更喜欢将 XML 表示形式转换为我的 Objective-C 代码最容易操作的格式。例如，考虑一下您的应用程序有一天会扩展以支持其他基于 Web 的服务的可能性，这些服务提供类似的数据，但作为 JSON 或 SOAP 格式的数据。现在您开始为在应用程序中维护 3 种不同类型的模型而头疼，而最好只维护一种。

我会将基于 XML 的 REST 资源视为需要处理成本地可操作格式的“外部数据”。如果您采用本地格式以最大限度地简化执行特定于应用程序的操作，那么您可以调整来自任何其他外部格式的输入，并根据需要转换回外部格式以进行上传/编辑/其他操作。

丹尼尔

* * *

## 回答 #2

> 赞同：2
> 
>             
> 
> 时间：2009-03-16T17:46:09.650

有一个名为[iPhone on Rails的项目，他们在其中创建了](http://iphoneonrails.com/)[ActiveResource](http://api.rubyonrails.org/classes/ActiveResource/Base.html)的 Objective-C 实现。我还没有机会玩它，但它可能值得一试。

* * *

## 回答 #3

> 赞同：0
> 
>             
> 
> 时间：2009-03-16T17:30:08.207

我目前正在做一个项目来解决这个问题，当我们得到一个稳定的点时，我们将发布代码。

如果您没有标准化的系统来序列化从服务器返回的所有对象，这将是一个非常棘手的问题。幸运的是，在这个项目中，我们确实有一个通用的序列化机制，所以我们构建了一个抽象的 SAX 解析器，我们从它继承，然后使用[类型自省](http://en.wikipedia.org/wiki/Introspection_(computer_science))和[NSCoding](http://developer.apple.com/documentation/Cocoa/Reference/Foundation/Protocols/NSCoding_Protocol/Reference/Reference.html)来弥合 Objective-C 和 XML 之间的差距。你可以自己做一个类似的概念。

在这个项目之前，我只是构建/重用了几个类来处理[NSURLConnection](http://developer.apple.com/DOCUMENTATION/Cocoa/Reference/Foundation/Classes/NSURLConnection_Class/Reference/Reference.html)和[NSXMLParser](http://developer.apple.com/documentation/Cocoa/Reference/Foundation/Classes/NSXMLParser_Class/Reference/Reference.html)工作，但我没有使用类型自省，而是使用了[委托模式](http://en.wikipedia.org/wiki/Delegation_pattern)。

* * *

## 回答 #4

> 赞同：0
> 
>             
> 
> 时间：2009-03-16T17:43:22.950

在我自己的例子中，我一直在使用[ASIHTTPRequest](http://allseeing-i.com/ASIHTTPRequest)的包装器来构建 RESTful 查询。我一直在使用[libxml2](http://xmlsoft.org/)处理结果，直接解析为呈现到用户界面中的模型对象。

我不确定我是否为您提供了一个包罗万象的解决方案，但我认为您将从功能分离为不同的、可重用的方法中获益良多。这样，您就不必担心返回的 XML 树的数量。您只需向您拥有的任何内容发出查询，以便填充您的界面。

# c# - 通过引用传递到 C# 代码时不会修改可空值

> ID：650707
> 
>         
> 
> 赞同：2
> 
>         
> 
> 时间：2009-03-16T14:39:59.363
> 
>         
> 
> 标签：c#, interop, f#, null, stored-procedures

我有一个 F# 变量定义如下

```
let id = new Nullable<int>() 
```

我将它从 F# 传递到一个 C# 函数，该函数接受 a`ref Nullable<int>`并随后为其分配一个值（它基本上是由 Linq2Sql 自动生成的存储过程代码）。

不幸的是，当函数调用退出时，我的`id`变量仍然没有值（即为空）。我尝试将其声明为，`mutable`但 F# 抱怨我不能在闭包中使用可变变量。

有人可以帮忙吗？谢谢！

* * *

## 回答 #1

> 赞同：3
> 
>             
> 
> 时间：2009-03-16T15:44:52.423

C＃：

```
namespace TestLibrary
{
    public class TakesRefNullableInt
    {
        public void Foo(ref Nullable<int> ni)
        {
            ni = null;
        }
    }
} 
```

F＃：

```
// mutable version
let Main() =
    let mutable ni = new System.Nullable<int>(42)
    let tfni = new TestLibrary.TakesRefNullableInt()
    printfn "%A" ni
    tfni.Foo(&ni)
    printfn "%A" ni
Main()

// 'ref' version
let Main2() =
    let ni = ref(new System.Nullable<int>(42))
    let tfni = new TestLibrary.TakesRefNullableInt()
    printfn "%A" !ni
    tfni.Foo(ni)
    printfn "%A" !ni
Main2() 
```

（可能另见[http://lorgonblog.spaces.live.com/blog/cns!701679AD17B6D310!677.entry](http://lorgonblog.spaces.live.com/blog/cns!701679AD17B6D310!677.entry)）

# c++ - 将指向堆栈变量的指针传递给 realloc() 是否有效？

> ID：650708
> 
>         
> 
> 赞同：4
> 
>         
> 
> 时间：2009-03-16T14:40:00.083
> 
>         
> 
> 标签：c++, c, memory, memory-management, heap-corruption

```
int main()
{
   char myString = NULL;
   realloc(&myString, 5);
   strncpy((char *)&myString, "test", 5);
} 
```

似乎工作正常，但我仍然对堆栈与堆有点困惑。这是允许的吗？如果允许，是否`myString`需要手动释放或者超出范围时是否会释放？

* * *

编辑：感谢您的回复，所以我认为这同样是非法的

```
//I want the code to change myString to "tests"
char myString[5] = "test";
realloc(&myString, strlen(myString)+2);
myString[4] = 's';
myString[5] = '\0'; 
```

* * *

## 回答 #1

> 赞同：19
> 
>             
> 
> 时间：2009-03-16T14:44:17.077

不，这是完全错误的。realloc 应该只用于重新分配 malloc 分配的内存，你正在做的事情只是偶然的，最终会可怕地崩溃

```
char *myString = malloc(x);
myString = realloc(myString,y);
free(myString) 
```

但是，最好使用 new 和 delete，甚至更好地使用 std::string。

* * *

## 回答 #2

> 赞同：8
> 
>             
> 
> 时间：2009-03-16T14:43:48.950

**您发布的代码存在一些问题：**

*   是的，您需要释放使用 malloc、realloc 和其他相关的 C 风格内存分配函数分配的所有内容。

*   我认为您的意思是拥有 char *myString，而不是 char。传入堆栈上某些东西的地址（你的字符）是完全错误的。

*   在 realloc 中使用之前，您需要将 myString char 指针初始化为 NULL。

*   你应该将 4 传递给 strncpy 而不是 5，如果你有一个更大的字符串，你会覆盖内存。

*   您应该释放您在示例中创建的缓冲区

*   您应该检查 realloc 调用的返回值。重新分配（）

> [关于 realloc 的返回值：] 在大小不等于 0 的情况下成功完成后，realloc() 返回一个指向（可能已移动的）分配空间的指针。如果 size 为 0，则返回可以成功传递给 free() 的空指针或唯一指针。如果没有足够的可用内存，realloc() 将返回一个空指针并将 errno 设置为 [ENOMEM]。

*   当你传入 NULL 时，re-alloc 将像 malloc 一样工作：

> 如果 ptr 是空指针，则 realloc() 的行为与指定大小的 malloc() 类似。

**一种更 C++ 的方法：**

不过，您将其标记为 C++，并且使用 C++ 的 new 运算符更安全。尽管 new 运算符不允许重新分配，但它可以用于分配和重新使用现有缓冲区（放置新）。

```
char *myString = new char[5];
strncpy(myString, "test", 4); 
//...
delete[] myString; 
```

甚至：

```
#include <string>

//...

std::string str = "test"; 
```

[前 2 名报价的来源](http://www.opengroup.org/onlinepubs/007908775/xsh/realloc.html)

* * *

## 回答 #3

> 赞同：4
> 
>             
> 
> 时间：2009-03-16T14:43:03.977

这不应该工作。您正在重新分配一开始没有分配的东西。不，当它超出范围时它不会被释放 - 当你使用 malloc 或 realloc 时，这完全取决于你。

更新：您的编辑不会改变任何东西 - 您仍在尝试重新分配一开始没有分配的东西。此外，您不能忽略 realloc 的返回值 - 如果 realloc 必须将内存移动到其他地方，您会在返回中找到它。换句话说：

```
char* ptr = malloc(4);
ptr = realloc(ptr, 5); 
```

在 realloc 之后，ptr 可能指向内存中完全不同的位置，继续使用 ptr 的原始值可能会让您使用已被释放的内存，并且没有您想象的那么大。

* * *

## 回答 #4

> 赞同：2
> 
>             
> 
> 时间：2009-03-16T14:46:52.453

这很危险！这会破坏你的堆栈。如果您要在返回 main() 的函数的堆栈上重新分配某些内容，则实际上最终会覆盖堆栈帧并返回 main() 以外的其他位置。这是一个潜在的安全漏洞。

尝试运行以下命令。如果它在 realloc 上崩溃，你很幸运。你可以用 memcpy(&myString) 之类的东西造成严重的损害。

```
int dostuff();

int main()
{
        dostuff();
        return 0;
}

int dostuff()
{
        char myString = NULL;
        realloc(&myString, 5);
        strncpy((char *)&myString, "test", 5);
        return 0;
} 
```

* * *

## 回答 #5

> 赞同：2
> 
>             
> 
> 时间：2009-03-16T14:51:24.283

这是你永远不应该做的。尝试 free() 或 realloc() 堆栈变量可能会导致未定义的行为，包括（但不限于）损坏的堆栈（导致不可预测的控制流）、损坏的堆服务结构、损坏的用户内存。如果程序只是与 AV 一起崩溃，那你就很幸运了。在某些情况下它可能会起作用，但你永远不应该尝试这样做。

经验法则：仅将内存返回给分配它的内存管理器。在这种情况下，不要尝试将堆栈变量返回到运行时堆。

* * *

## 回答 #6

> 赞同：2
> 
>             
> 
> 时间：2009-03-25T23:26:31.303

您的程序在语法上是有效的 C++，但它会产生未定义的行为，因为您将堆栈对象的地址传递给堆分配器。通常这意味着您的程序在执行时会崩溃。

堆栈和堆是分配给执行程序的进程的两个不同的内存区域。当你输入一个函数来保存它的参数和局部变量时，堆栈会增长，当你从函数返回时它会自动收缩。另一方面，堆是一个单独的地址区域，可以按需获取内存，并且在不再需要时必须显式释放。

如果将局部变量的地址传递给 realloc()，它可能会尝试释放其内存并将其分配到其他地方。由于地址不是来自堆，而 realloc() 在堆上操作，这将失败。realloc() 很可能会检测到地址不是来自堆并中止程序。

* * *

除此之外，示例程序包含一些逻辑错误。

```
 char myString = NULL; 
```

您声明一个变量来保存一个字符，而不是一个字符串。C 风格的字符串具有 type `char*`，即指向 char 的指针。

此外，char 被分配`NULL`，通常分配给无效指针的地址为零。这是编译的，因为预处理器替换`NULL`为文字`0`。实际上，您在 char 中存储了一个零字节，按照惯例，它也是 C 样式字符串的终止符。

```
 realloc(&myString, 5); 
```

如上所述，这是非法的，因为您将堆栈对象的地址传递给堆分配器。此问题仍然存在于您的第二个代码示例中。

此外，您丢弃了返回值。`realloc()`返回分配新内存的地址。它可能与以前的地址不同。它甚至可能是 NULL，这是`realloc()`告诉您内存不足的一种方式。

```
 strncpy((char *)&myString, "test", 5); 
```

这是正确的，但演员表是多余的。

* * *

这是您的程序的更正确版本：

```
 #include <stdlib.h>
#include <string.h>

int main()
{
   /* allocate space for, say, one character + terminator */
   char* myString = (char*) malloc(2);

   /* some code using myString omitted */

   /* get more space */
   myString = (char*) realloc(myString, 5);

   /* write to the string */
   strncpy(myString, "test", 5);

   /* free the memory */
   free(myString);

   return 0;
} 
```

在 C++ 中，最好完全避免 realloc()。例如，您可以使用如下内容：

```
 #include <string>

int main()
{
   std::string myString;

   /* some code using myString */

   myString = "test";

   return 0;
} 
```

* * *

## 回答 #7

> 赞同：0
> 
>             
> 
> 时间：2009-03-16T14:47:21.967

您不必释放`myString`，因为它在堆栈上（离开范围时会“释放”）。

`realloc`在这里是非法的，地址必须是`NULL`或 由先前调用返回的地址`realloc`,`malloc`或`calloc`。

您声明的每个变量都在堆栈上，甚至是指针：

诠释* x；

变量`x`在堆栈上！它是类型`pointer`并拥有一个地址。

x = (int *)malloc(sizeof(int));

将返回的地址分配给`malloc`变量 x! 的内容`x`是一个内存地址！

* * *

## 回答 #8

> 赞同：0
> 
>             
> 
> 时间：2009-03-16T14:51:47.760

您正在做的事情的问题是您正在处理不是变量的东西。您将 myString 定义为 char，因此试图更改其地址。那很糟。

函数 realloc() 不应更改传递给它的任何内容。它需要一个指向堆上某个内存的指针（或空指针，如果没有分配任何内容）并返回一个指向堆上某个内存的指针。

因此，您提供空指针或指向由 malloc() 或 realloc() 或 calloc() 分配的内容的指针，并存储返回的指针。

就像是

```
char * myString = NULL;
myString = realloc(myString, 5); 
```

会工作，但你会想要 free() myString.

然而，在 C++ 中，使用 std::string。

* * *

## 回答 #9

> 赞同：0
> 
>             
> 
> 时间：2009-03-16T15:15:23.197

响应您的第二个代码示例：

是的，这也是非法的。myString 不是用 malloc（或 calloc）分配的，所以不能用 realloc 重新分配，也不能用 free 释放。

另外， realloc 不会将指向指针的指针作为其第一个参数。它需要一个指向已分配内存的指针，并返回另一个（可能不同的）指针。改为这样编写调用：

```
myString = realloc(myString, strlen(myString)+2); 
```

# c# - 处理 Internet Explorer 网页中的控件

> ID：650709
> 
>         
> 
> 赞同：0
> 
>         
> 
> 时间：2009-03-16T14:40:01.313
> 
>         
> 
> 标签：c#, windows, internet-explorer, textbox, handle

我在 Windows 窗体应用程序中嵌入了 Internet Explorer 浏览器，但无法修改此窗体的源代码。但是，我已经掌握了 IE 窗口的句柄，并且可以执行各种`SendInput`功能。如果我单击一个控件，我如何判断它是否是`TextBox`，然后如何向该控件发送字符`TextBox`？  

我需要使用我已经为我的其他功能获得的 IE 窗口句柄的答案。我需要的答案必须涉及到 IE 窗口的句柄。

* * *

## 回答 #1

> 赞同：0
> 
>             
> 
> 时间：2009-03-18T12:06:16.123

你不能。IExplore 上的控件不再是 Windows 控件 - 它们是由 IExplore 呈现的自定义实体，只是看起来类似于实际的 Windows 控件。

与网页上的控件交互的唯一方法是访问 Internet Explorer 窗口的 activeX 控件，向它询问 IID_IWebBrowser2，然后从该点导航文档对象模型命名空间。

如果“没有能力修改这种形式的源代码”是指你的代码运行在一个完全不同的进程中，那么你就有一个非常非常大的问题。如果您在同一个过程中，WinForms 很有可能有一个 API，您可以使用它来强制访问任何 activex 控件其托管。

鉴于您对这种开发语言的次优选择 - c# - 我无法就与 activex 控件的互操作的简单性或可能性给出任何建议。

* * *

## 回答 #2

> 赞同：0
> 
>             
> 
> 时间：2011-06-15T15:00:39.190

[http://watin.org/](http://watin.org/)为您提供了很多访问 Web 浏览器的可能性——不知道这是否包括嵌入在其他应用程序中的那些。

无论哪种方式，您都可以获得有关如何“自动化”浏览器窗口的更多信息。

# java - 空指针异常 JLabel

> ID：650719
> 
>         
> 
> 赞同：0
> 
>         
> 
> 时间：2009-03-16T14:43:08.640
> 
>         
> 
> 标签：java, nullpointerexception, jlabel

当我尝试在标签上运行它时，为什么会得到 NullPointerException：

```
JLabel player1CurrentScore = new JLabel("" + matchPlay.returnPL1GamesWon(),
                                        JLabel.CENTER); 
```

是因为我不能像这样连接两个字符串吗？

理想情况下，我试图将标签设置为玩家的分数，以便可以在需要时正确递增。

这是我的异常堆栈转储：

```
java.lang.NullPointerException
at GUI.makeFrame(GUI.java:71)
at GUI.<init>(GUI.java:28)
at sun.reflect.NativeConstructorAccessorImpl.newInstance0(Native Method)
at sun.reflect.NativeConstructorAccessorImpl.newInstance(NativeConstructorAccessorImpl.java:39)
at sun.reflect.DelegatingConstructorAccessorImpl.newInstance(DelegatingConstructorAccessorImpl.java:27)
at java.lang.reflect.Constructor.newInstance(Constructor.java:513)
at bluej.runtime.ExecServer$3.run(ExecServer.java:808) 
```

* * *

## 回答 #1

> 赞同：3
> 
>             
> 
> 时间：2009-03-16T14:44:28.683

除非 matchPlay 为 null 或 matchPlay.returnPL1GamesWon() 本身引发空指针异常，否则不会导致空指针异常。

更新：基于异常来自 GUI.makeFrame 的事实，我不得不问你是否真的有图形显示？这是命令行应用程序、Swing 应用程序还是 Applet？看起来您正在尝试创建没有图形上下文的 JLabel。

* * *

## 回答 #2

> 赞同：3
> 
>             
> 
> 时间：2009-03-16T14:44:58.043

根据问题中的信息：参考 matchPlay 为空。

更新：鉴于 matchPlay 不能为 null 的信息，那么在 matchPlay 上调用的方法必须抛出异常。检查上一个方法调用的堆栈跟踪，应该有助于查明问题。

* * *

## 回答 #3

> 赞同：0
> 
>             
> 
> 时间：2009-03-16T15:15:26.690

我已经设法回答了，

这是我在构造函数中分配字段的顺序

抱歉打扰

感谢大家

# asp.net - 无法在本地 ASP.NET 开发 Web 服务器上建立连接？

> ID：650735
> 
>         
> 
> 赞同：1
> 
>         
> 
> 时间：2009-03-16T14:46:39.240
> 
>         
> 
> 标签：asp.net, visual-studio, configuration

我正在使用 Visual Studio 2008，并且我的 ASP.NET 开发配置工作正常，但是今天当我尝试在开发 Web 服务器中启动任何 ASP.NET 项目时，浏览器会打开，但出现错误`Can't establish a connection to localhost:64428`（端口在每次尝试）。

即使是新创建的 Web 应用程序也会出现问题。

当我尝试在与默认页面关联的 C# 代码文件中添加断点时，我收到一条警告：`The breakpoint will not currently be hit. No symbols have been loaded for this document.`

我想我已经设法破坏了本地 ASP.NET 开发 Web 服务器的配置。有谁知道如何解决这种情况？

* * *

## 回答 #1

> 赞同：2
> 
>             
> 
> 时间：2009-03-23T16:48:11.980

我在这里找到了一种潜在的解决方案：

[http://www.grumpydev.com/2009/03/12/strange-problem-unable-to-connect-to-the-aspnet-webserver-on-localhost/comment-page-1/#comment-73](http://www.grumpydev.com/2009/03/12/strange-problem-unable-to-connect-to-the-aspnet-webserver-on-localhost/comment-page-1/#comment-73)

总之，编辑您的主机文件以包括：

127.0.0.1 本地主机

不确定我的更改是如何更改的，或者是否更改是导致问题的原因，但是我现在可以开始了，因为添加了上述条目并注释掉了“::1”条目。

* * *

## 回答 #2

> 赞同：0
> 
>             
> 
> 时间：2009-03-16T15:02:43.553

我之前遇到过这个问题，我会从几件事开始。

1.  在托盘中，确认没有运行 asp.net Web 服务器。如果是这样，请停止它，以便在您从 VS 启动应用程序时重新启动它。

2.  当应用程序被复制或未正确打开时，我已经看到“无断点”错误，无论是由于 IIS 中的更改还是其他原因。尝试在文件级别或 Web 级别（与您正在执行的操作不同）打开项目，看看是否可以解决问题。这将帮助您隔离那里发生的事情。如果 sln 文件中存在无效引用，您可能需要尝试打开 csproj 文件而不是 sln 文件来隔离。

3.  您可能想要调试并执行“附加到进程”。这也将有助于确定正在发生的事情并让您能够调试它。

# asp.net - SQL 查询不是在一个地方，而是在通过多个系统层时动态组合。这是一个好习惯吗？

> ID：650737
> 
>         
> 
> 赞同：0
> 
>         
> 
> 时间：2009-03-16T14:46:57.977
> 
>         
> 
> 标签：asp.net, sql

我个人觉得这让最近加入该项目的开发人员的生活变得非常悲惨。如果对框架机制没有几乎完美的理解，开发和调试就像是一种折磨，因为每当我遇到错误或意外行为时，我都不知道该去哪里找。在极少数情况下，通过解决方案按 Ctrl+F 会有所帮助，但在大多数情况下，我要么必须请教高级人员，要么使用 try & error 方法。在许多情况下，没有办法测试它是否运行良好，测试人员和可悲的是客户必须检查它。

我认为将查询放在存储过程中或至少放在代码中的一个位置可能会有所帮助。

这种动态查询方法是业务应用程序中的标准做法吗？我个人对此非常不适应。

* * *

## 回答 #1

> 赞同：2
> 
>             
> 
> 时间：2009-03-16T14:57:33.440

我看到这种方法的一个大问题是没有明确的责任分离。由于多个层拥有创建 SQL 查询的逻辑的不同部分，您的应用程序将无法很好地扩展并且难以修改。

* * *

## 回答 #2

> 赞同：2
> 
>             
> 
> 时间：2009-03-16T16:14:59.510

如果调试是一场噩梦，那么您已经有了答案：这不是最佳实践，将来应该避免这种模式。

就其价值而言，动态 SQL 不一定是坏事，它在大型业务应用程序中极为常见。如果做得好，它可以提高代码的可维护性：

*   大多数像 Hibernate 这样的 ORM 使数据库访问对程序员来说是透明的。例如，当您请求一个类似的对象时`User.GetByID(12)`，ORM 将动态构造 SQL，执行它，将字段映射到您的对象，然后返回它。作为一名程序员，你的大量时间被释放了，因为你不再需要编写 SQL 查询，你可以专注于编写你的应用程序。**您可以查询数据库，而无需在应用程序的任何地方看到、触摸或闻到硬编码的 SQL 字符串，这样您就可以在不编写存储过程的情况下保持业务逻辑和数据访问层之间的硬分离。**

*   如果您的动态构造的 SQL 是很好抽象的，那么您可以在不更改数据访问逻辑的情况下换出数据库。例如，NHibernate 会根据您的配置文件中列出的任何数据库供应商生成正确的 SQL，并且它可以正常工作。**原则上，您可以对任何数据库供应商使用相同的数据访问逻辑。**

*   我见过包含 1000 多个表示琐碎查询（即简单的选择、插入、更新和删除）的存储过程的应用程序。维护这些数据库非常麻烦，尤其是当您的数据库架构频繁更改时。使用编写良好的动态 SQL，您可以在几个函数（即传递表名和一些参数的函数）中表示 1000 条等效查询。ORM 已经为您提供了这种抽象，因此对数据库模式的更改不需要更改您的应用程序代码（当然，除非您想将该新字段添加到您的业务对象中）。**您可以更改数据库架构（添加新字段、更改列的数据类型等），而无需更改应用程序代码或数据访问逻辑。**

*   还有一些较小的好处：

    *   不管有什么政策要求程序员或 CM 将存储过程复制到源代码控制中，我们都忘记了。如果 SQL 是以编程方式构建的，它总是在源代码控制中。

*   关于存储过程相对于动态 SQL 的优势有很多神话：

    *   “动态 SQL 容易发生 SQL 注入，而存储过程则不会”——根本不正确。动态 SQL 参数化很简单，实际上参数化动态 SQL 比使用过多字符串连接的动态 SQL 更容易编写。即便如此，如果您与一个疏忽大意以至于编写不安全的动态 SQL 的程序员一起工作，那么他很可能会编写同样糟糕的存储过程（[将此作为案例研究](https://stackoverflow.com/questions/434414/what-is-the-most-evil-code-you-have-ever-seen-in-a-production-enterprise-environm/434562#434562)）。

    *   “存储过程是预编译的，所以运行速度更快。SQL Server 无法缓存动态 SQL 的执行计划”——至少对于 SQL Server，这是绝对错误的。从 SQL Server 7.0 开始，“[存储过程在执行时被编译，就像任何其他 Transact-SQL 语句一样。SQL Server 2000 和 SQL Server 7.0 在过程缓存中保留所有 SQL 语句的执行计划，而不仅仅是存储过程执行计划。](http://msdn.microsoft.com/en-us/library/aa174792.aspx) ”

    *   “存储过程让您无需重新部署应用程序即可更改 SQL。” - 这对于非常微不足道的调整是正确的，但在 95% 的情况下，对数据库的更改无论如何都需要更改应用程序。

*动态 SQL本身*并不坏，但是有很多警告标志表明你什么时候做错了：

*   您*永远不*应该使用正则表达式来剖析 SQL 语句。

*   您*永远不*应该将大量 SQL 传递给您的数据访问层。例如，带有签名的方法`User GetUser(string whereclause)`非常脆弱。如果您的数据库架构发生变化，您的应用程序逻辑也会发生变化。

*   数据访问应该是类型安全的。你不应该传递无类型的数据集或字符串——或者如果你这样做了，你需要将这些对象包装在一个有类型的对象中，然后再将它们返回给用户。

*   在推出自己的 ORM 之前，请始终考虑使用现有的 ORM。

您可能已经注意到我在这篇文章中谈到了很多关于 ORM 的内容。这是因为，一般来说，硬编码 SQL 字符串是一件*坏事*。使用动态 SQL 的正确方法是拥有一个即时生成 SQL 的工具，这正是许多 ORM 能够并且已经做到的。

* * *

## 回答 #3

> 赞同：1
> 
>             
> 
> 时间：2009-03-16T14:48:30.327

动态查询也可以让您接受 SQL 注入。将它们放在带有参数的存储过程中有助于降低这种风险。

如果您确实需要/想要在代码中动态地进行查询，我建议将它们全部放在一个数据类或类似的数据类中。这样，如果需要任何更改，它们都在一个地方，而且您可以在创建新查询之前查看现有查询是否已经存在。如果您需要使用新数据库或想要切换到存储过程，这也有帮助，因为所有内容都包含在单个位置的调用中。

* * *

## 回答 #4

> 赞同：1
> 
>             
> 
> 时间：2009-03-16T14:50:28.577

你没有错，我个人认为你应该使用存储过程或有一个专门用于与数据库对话的类。只是在代码中的“任何地方”组装查询是自找麻烦。

* * *

## 回答 #5

> 赞同：0
> 
>             
> 
> 时间：2009-03-16T16:28:35.767

存储过程是必须的。这里有两个原则：良好的工程和安全性

数据库也不是 OOP 也不是函数式编程语言（尽管它们假装是）。数据库的优势在于它的 ACID 特性。为了利用这种能力，数据库确实需要自己的层来遵守这些原则。

其次，正如其他人所提到的，数据注入攻击是一个巨大的威胁。当您有数百万美元的风险时，您的股东或客户认为此类数据没有通过使用存储过程或某种类型的安全数据绑定来保护是犯罪过失。

如果您必须动态构建查询，确保其安全的最佳方法是只允许将输入转换为已知的整数/枚举值。没有自由文本输入。

很容易标准化一些用户输入并检查数组中的已知值。我通常跨多个层执行此操作，以便多次检查输入并多次标准化。

但又一次。存储过程是必须的。

* * *

## 回答 #6

> 赞同：-1
> 
>             
> 
> 时间：2009-03-16T19:03:00.840

尽管似乎每个人都在指出 SQL 注入攻击是一个很大的安全漏洞，但在我看来，这并不是动态 SQL 造成的最大安全漏洞。如果您正确编码前端并且没有正确编码您的存储过程，您仍然可以让自己容易受到攻击，您可以防止 SQL 注入攻击。

我认为使用动态 SQL 最大的安全漏洞是现在前端用户需要访问底层表。这意味着那里有一个用户，无论是 Windows 身份验证还是 SQL 登录，都可以在几乎没有规则的情况下破坏数据库。我什至无法计算我进入一家新商店的次数，并发现登录信息以纯文本形式保存在某个配置文件中。即使不是，开发人员几乎总是知道该帐户的用户名/密码。

公司中的大多数安全漏洞（从长远来看）都是内部工作 - 心怀不满的员工，希望通过出售 SSN 快速赚钱的人，或者只是认为为前女友查找医疗信息没有任何问题的人从高中开始。**再加上在确定**自己在开发服务器上时发出“TRUNCATE TABLE”的开发人员。然后你也有一些人登录并在某处的表中添加一行以“修复”问题，但他们不明白每当你向表 X 中添加一行时，你都需要向表 Y 中写入一行。如果通过存储过程强制执行所有访问，他们将无法做到这一点。

* * *

## 回答 #7

> 赞同：-4
> 
>             
> 
> 时间：2009-03-16T16:45:03.293

我想补充一点，现在我们有休眠和 linq 存储过程在大多数项目中都是多余的。我知道在某些情况下，由于性能限制，存储过程是不可避免的，因为在应用程序服务器和数据库之间来回传输大量数据是昂贵的。

我当前的项目使用 SP，而我以前的工作使用休眠。在当前的工作中，如果我们使用 ORM，其中有很多是永远不会发生的错误。此外，在 SP 项目中，我们有一个存储过程中的 SQL 注入错误。我从来没有在我以前工作过的代码库上看到过 SQL 注入问题 :) 似乎人们的大脑在开始编写存储过程时就关闭了。

你为什么想要更多的错误和做更多的工作只是为了取悦一些搞砸的宗教原则：'我们必须使用存储过程'。

# c - 检查是否可以使用便携式 C 打开文件

> ID：650739
> 
>         
> 
> 赞同：2
> 
>         
> 
> 时间：2009-03-16T14:47:06.697
> 
>         
> 
> 标签：c, file-io

我想快速检查是否可以打开文件。它应该用可移植的 C 语言编写，或者至少可以在 Win32 和 POSIX 系统上工作。#ifdefs 是可以接受的。

我试图避免这种情况：

```
int openable(const char*filename) {
    FILE *f = fopen(filename,"r");
    if (!f)
        return 0; /* openable */
    fclose(f);
    return 1; /* not openable */
} 
```

据我所知，stat() 最简单的形式可用于检查文件是否存在，但不能检查它是否真的可以打开。

* * *

## 回答 #1

> 赞同：3
> 
>             
> 
> 时间：2009-03-16T15:31:21.113

POSIX 标准解决方案是`[access](http://www.opengroup.org/onlinepubs/000095399/functions/access.html)()`，它也在 Windows 运行时中作为`[_access()](http://msdn.microsoft.com/en-us/library/1w06ktdy%28VS.80%29.aspx)`.

我想它比`fopen()`+稍微好一点，`fclose()`因为：

*   它是测试文件访问权限问题的众所周知的标准解决方案

*   它很可能更快，内存开销更少

当然，它与进行此类测试的任何其他方式一样容易受到竞争条件的影响。在某种程度上，知道文件是否可供读取的唯一安全方法是打开它并尝试读取，而不是在两者之间关闭它。当然，即便如此，您仍然需要注意“意外的”EOF。I/O 很难。

* * *

## 回答 #2

> 赞同：1
> 
>             
> 
> 时间：2009-03-16T14:56:51.803

在您知道文件是“可打开的”之前，您需要检查许多因素，并且尝试以跨平台的方式检查它们是愚蠢的。

我认为您现在所做的事情既简单又安全。**但是请记住，仅仅因为文件***现在*是“可打开的”并不意味着它仍然会在您实际打开它时仍然存在。没有什么能阻止它在此期间发生变化。

* * *

## 回答 #3

> 赞同：1
> 
>             
> 
> 时间：2009-03-16T14:58:18.493

我认为您所拥有的可能与您将获得的一样好（尽管您的评论与应有的相反）。有很多事情可以阻止文件打开：权限、保持打开文件的其他因素、资源不足等。

要准确地完成所有这些检查，您不妨打开它。

但是，还要注意，在大多数系统上，您返回的内容可能是对调用者的谎言 - 当您向调用者返回有关文件是否可以打开的指示时，系统的状态可能会改变（例如，保持文件打开的东西可以关闭它）。因此，应用程序知道它们是否可以打开和使用文件的唯一真正有效的方法就是打开和使用文件（并处理任何故障）。

换句话说，如果您将 ' `true`' 返回给调用者，他们可能会尝试打开文件，但它可能仍然会失败。

# perl - 在 Perl 中，如何从文件中删除 ^M？

> ID：650743
> 
>         
> 
> 赞同：37
> 
>         
> 
> 时间：2009-03-16T14:48:16.647
> 
>         
> 
> 标签：perl, carriage-return, hidden-characters

我有一个将新字段附加到现有 CSV 的脚本，但是`^M`字符出现在旧行的末尾，因此新字段最终出现在新行而不是同一行上。如何`^M`使用 Perl 从 CSV 文件中删除字符？

* * *

## 回答 #1

> 赞同：51
> 
>             
> 
> 时间：2009-03-16T14:51:33.377

^M 是回车。你可以这样做：

```
$str =~ s/\r//g 
```

* * *

## 回答 #2

> 赞同：27
> 
>             
> 
> 时间：2009-03-16T16:36:04.203

或 1 线：

```
perl -p -i -e 's/\r\n$/\n/g' file1.txt file2.txt ... filen.txt 
```

* * *

## 回答 #3

> 赞同：15
> 
>             
> 
> 时间：2009-03-16T17:36:39.533

你发现你也可以这样做：

```
$line=~ tr/\015//d; 
```

* * *

## 回答 #4

> 赞同：8
> 
>             
> 
> 时间：2009-03-16T17:45:32.787

有点不相关，但要使用 Perl 从命令行中删除 ^M，请执行以下操作：

```
perl -p -i -e "s/\r\n/\n/g" file.name 
```

* * *

## 回答 #5

> 赞同：6
> 
>             
> 
> 时间：2013-08-05T15:34:50.903

我更喜欢使用 DOS 或 Unix 输入的更通用的解决方案。假设输入来自 STDIN：

```
while (defined(my $ln = <>))
  {
    chomp($ln);
    chop($ln) if ($ln =~ m/\r$/);

    # filter and write
  } 
```

* * *

## 回答 #6

> 赞同：3
> 
>             
> 
> 时间：2012-08-03T23:04:29.990

这一行替换了所有 ^M 字符：

```
dos2unix <file-name> 
```

您可以从 Perl 内部或直接在 Unix 提示符下调用它。

* * *

## 回答 #7

> 赞同：2
> 
>             
> 
> 时间：2009-03-16T14:51:33.627

要将 DOS 样式转换为 UNIX 样式的行尾：

```
for ($line in <FILEHANDLE>) {
   $line =~ s/\r\n$/\n/;
} 
```

或者，要删除 UNIX 和/或 DOS 样式的行尾：

```
for ($line in <FILEHANDLE>) {
   $line =~ s/\r?\n$//;
} 
```

* * *

## 回答 #8

> 赞同：1
> 
>             
> 
> 时间：2016-03-17T06:57:53.787

这就是解决我的问题的方法。^M 是一个回车，在 Perl 脚本中可以很容易地避免它。

```
while(<INPUTFILE>)
{
     chomp;
     chop($_) if ($_ =~ m/\r$/);
} 
```

* * *

## 回答 #9

> 赞同：0
> 
>             
> 
> 时间：2016-09-18T04:28:51.623

我有这个小脚本。对其进行修改有助于过滤掉跨平台遗留文件中的一些其他不可打印字符。

```
#!/usr/bin/perl
# run this as
# convert_dos2unix.pl < input_file > output_file
undef $/;
$_ = <>;
s/\r//ge;
print; 
```

* * *

## 回答 #10

> 赞同：0
> 
>             
> 
> 时间：2021-12-17T18:32:21.393

perl 命令将 dos 行结尾转换为以原始文件备份结尾的 unix 行：

```
perl -pi.bak -e 's/\r\n/\n/g' filename 
```

此命令生成带有 unix 行结尾的文件名，并将原始文件保留为 filename.bak。

* * *

## 回答 #11

> 赞同：-1
> 
>             
> 
> 时间：2009-03-16T17:45:19.933

在 vi 中命中`:`。

然后`s/Control-VControl-M//g`。

`Control-V` `Control-M`显然是那些钥匙。不要拼出来。

# c# - 如何使用 C# 删除 StartMenu 快捷方式

> ID：650746
> 
>         
> 
> 赞同：1
> 
>         
> 
> 时间：2009-03-16T14:48:34.897
> 
>         
> 
> 标签：c#, windows

如何使用 C# 从 Windows 的 Startmenu 中删除快捷方式文件夹，我知道如何使用以下代码执行此操作：

```
 private void RemoveShortCutFolder(string folder)
    {
        folder = folder.Replace("\"  ", "");
        folder = Path.Combine(Environment.GetFolderPath(Environment.SpecialFolder.StartMenu), folder);
        try
        {
            if (System.IO.Directory.Exists(folder))
            {
                System.IO.Directory.Delete(folder, true);
            }
            else
            {
            }
        }
        catch (Exception)
        {
        }
    } 
```

但问题是我需要删除 ALL USERS 文件夹中的一个快捷方式文件夹，而不是当前登录的用户。Environment.SpecialFolder.StartMenu 给了我当前用户而不是所有用户文件夹。

任何想法，

谢谢，

* * *

## 回答 #1

> 赞同：5
> 
>             
> 
> 时间：2009-03-16T15:49:27.187

如果你不介意一点 Win32，你可以使用[`SHGetSpecialFolderPath`](http://msdn.microsoft.com/en-us/library/bb762204.aspx).

```
[DllImport("shell32.dll")]
static extern bool SHGetSpecialFolderPath(IntPtr hwndOwner, StringBuilder lpszPath, CSIDL nFolder, bool fCreate);

enum CSIDL
{
  COMMON_STARTMENU = 0x0016,
  COMMON_PROGRAMS = 0x0017
}

static void Main(string[] args)
{
  StringBuilder allUsersStartMenu = new StringBuilder(255);
  SHGetSpecialFolderPath(IntPtr.Zero, allUsersStartMenu, CSIDL.COMMON_PROGRAMS, false);
  Console.WriteLine("All Users' Start Menu is in {0}", allUsersStartMenu.ToString());
} 
```

* * *

## 回答 #2

> 赞同：2
> 
>             
> 
> 时间：2011-11-24T09:44:39.000

使用 Environment.SpecialFolder.CommonStartMenu 而不是 StartMenu。

* * *

## 回答 #3

> 赞同：0
> 
>             
> 
> 时间：2009-03-16T14:57:41.193

谢谢各位，我找到了答案：

```
 private void RemoveShortCutFolder(string folder)
    {
        folder = folder.Replace("\"  ", "");
        folder = Path.Combine(Path.Combine(Path.Combine(Environment.GetEnvironmentVariable("ALLUSERSPROFILE"), "Start Menu"), "Programs"), folder);
        try
        {
            if (System.IO.Directory.Exists(folder))
            {
                System.IO.Directory.Delete(folder, true);
            }
            else
            {
            }
        }
        catch (Exception)
        {
        }
    } 
```

# vbscript - 有人在 Visual Studio 2005 中成功编辑 .vbs 脚本吗？

> ID：650749
> 
>         
> 
> 赞同：0
> 
>         
> 
> 时间：2009-03-16T14:50:55.110
> 
>         
> 
> 标签：vbscript

我想做一些 VB 脚本并正在寻找一个好的编辑器。我突然想到我可以用 VS 2005 来编辑它。

您是否使用 VS 2005 来编辑 .vbs 脚本？对此有任何指示吗？

* * *

## 回答 #1

> 赞同：1
> 
>             
> 
> 时间：2009-03-16T14:51:09.773

我找到了这个指针，但还没有开始使用它：
 [http ://social.microsoft.com/Forums/en-US/vbide/thread/bb28fc96-36ae-4590-aedf-b7eb75fe1526](http://social.microsoft.com/Forums/en-US/vbide/thread/bb28fc96-36ae-4590-aedf-b7eb75fe1526)

还有其他建议吗？

* * *

## 回答 #2

> 赞同：0
> 
>             
> 
> 时间：2009-03-16T16:45:15.617

虽然我想您可能可以在 VS 2005 中编写 VB 脚本，但我不确定会有什么好处。不支持 IDE 内置的 VB 脚本，调试器也无法使用。

如果您正在寻找带有 VB 脚本调试器的编辑器，请查看[VbsEdit](http://www.vbsedit.com/)。

我使用[notepad++](http://notepad-plus.sourceforge.net/uk/site.htm)，它支持[自动完成](http://notepad-plus.sourceforge.net/uk/auto-completion-HOWTO.php)。

另外，请查看[Komodo 编辑](http://www.activestate.com/komodo_edit/)。我用的不多，但它也支持自动完成。

# architecture - COTS 与定制/构建与购买：决策树和最佳实践

> ID：650750
> 
>         
> 
> 赞同：6
> 
>         
> 
> 时间：2009-03-16T14:51:08.713
> 
>         
> 
> 标签：architecture, cots

### 背景：

我在一家拥有大量 SAP 投资的公司工作，我们还有数十个大型 .NET 系统（主要用于内部工程系统）和 Java 平台（主要用于外部 Web 应用程序）。因此，我们在 ABAP、C# 和 Java EE 上有大型开发商店。

### 问题：

简而言之，**我们需要一种更好的方法来确定何时应使用商业现货 (COTS) 软件，以及何时应利用我们自己的开发人员。**

### 标准：

我想根据最佳实践构建一个决策树来帮助解决这个问题。

在最高级别，Jeff Atwood 的相关帖子总结得很好：[The Best Code is No Code At All](http://www.codinghorror.com/blog/archives/000878.html)

再深入一点，我希望看到如下标准：

是否有满足大部分要求的 COTS 系统？（如果是，COTS 系统可能是一个不错的选择：（避免重新发明轮子））

*   如果是这样，是否有完全公开的 API 可用？（这对于集成/定制至关重要）

*   如果是这样，源代码可用吗？（这对于深度集成/定制至关重要）

该系统是否旨在满足核心业务功能/创造竞争优势？（如果是这样，定制开发可能是一个不错的选择：[请参阅 Joel Sposky 的：为非此处发明综合症辩护](http://www.joelonsoftware.com/articles/fog0000000007.html)）

*   如果是这样，定制开发是否允许在未来/其他系统中重用代码？（重用现有代码有很多好处）

定制应用程序与 COTS 产品的 TCO 是多少？

是否存在定制开发无法满足的时间限制？（如果是，COTS 系统可能是一个不错的选择）

* * *

## 回答 #1

> 赞同：2
> 
>             
> 
> 时间：2009-03-18T20:42:31.497

我不完全确定您的要求是什么，但我想我会评论多年来我在 COTS 与定制开发选择中看到的一些事情：

1.  正确分析任何 COTS 系统的适用性需要时间。无论是从需求角度还是技术角度。可以做多少定制开发而不是分析？

2.  当心 COTS 销售宣传的承诺月亮在棍子上。他们有很多。来自应援者的华而不实的演讲，他们将提供满足任何要求以达成交易。最危险的陷阱是被承诺的功能目前不在 COTS 中，但它们会为您添加 - 通常情况下，推销员对您说“是”，甚至没有发现他们的产品是否可以这样做它。

3.  检查 COTS 中的单元测试以及它们使用的开发实践。良好的质量指标。牛仔开发实践、缺乏测试和文档是未来的可维护性问题。

4.  如果 COTS 供应商没有提供有关其产品技术方面的太多信息，请小心。

If your desired system is fairly simple then your COTS choice will also be fairly simple. But if it's a large, complex system you would presumably offer it out for RFP (request for proposal) and to do that you are going to have to have a thorough and correct requirements specification. Will the time taken to produce requirements for the RFP out weigh a custom dev agile solution? You are going to have to nail those requirements down super tight to make sure the COTS system delivers and that will take a lot of time and effort.

Personally, I would never consider COTS unless:

1.  The source code is available and I have had programmers assess it

2.  I've seen and tried a working demo and not just glitzy sales pitches

3.  There isn't time or personnel to do it in-house.

Ultimately, I agree with Joel's statement: If it's a core business function -- do it yourself, no matter what.

# asp.net - 模拟单击 ASP.NET 按钮的问题

> ID：650753
> 
>         
> 
> 赞同：0
> 
>         
> 
> 时间：2009-03-16T14:51:31.647
> 
>         
> 
> 标签：asp.net, javascript

我有一些这样的代码

```
<asp:Button ID="cancelDummyButt" runat="server" CausesValidation="False" 
    Text="cancel" onclick="cancelDummyButt_Click" Enabled="True" /> 
```

(Javascript:)

```
buttid = '<%=cancelDummyButt.ClientID.ToString%>';
eltoclick = document.getElementById(buttid);
eltoclick.click(); 
```

不调用服务器端代码。怎么了？在“点击”之前一切正常。调试的最佳方法是什么？

*（这是为了从更新面板中的 iframe 中获取正确的回发）*

* * *

## 回答 #1

> 赞同：1
> 
>             
> 
> 时间：2009-03-16T19:59:06.353

Olav，模态窗口的诀窍是在模态窗口*之外*有一个隐藏的 ASP:Button 。您可以在模式窗口中有一个常规的 html 按钮，单击该按钮时，会为隐藏的 ASP:Button 控件调用 __doPostback('', '') 方法。这与实际单击 ASP 按钮的效果相同。

 `````
<!-- start modal dialog div -->

   <input type="button" onclick="__doPostBack('<%= btnDoIt.UniqueID %>','');" value="Do It!" />

<!-- end modal dialog div -->

<asp:Button id="btnDoIt" style="display:none;" runat="server"></asp:Button> 
````  `* * *

## 回答 #2

> 赞同：1
> 
>             
> 
> 时间：2009-03-16T20:56:44.013

以编程方式调用控件的 click() 事件**不会**触发事件处理函数。您需要手动调用它....

```
if(eltoclick.onclick())
  eltoclick.click(); 
```

* * *

## 回答 #3

> 赞同：0
> 
>             
> 
> 时间：2009-03-16T15:14:50.997

已解决 - 这是由模态 jQuerywindow 引起的！

（当然，想要一些解决方法）

奥拉夫

* * *

## 回答 #4

> 赞同：0
> 
>             
> 
> 时间：2009-03-16T14:56:28.437

首先，你在这一行有一个错误：

```
buttid = '<%= cancelDummyButt.ClientID.ToString() %>'; 
```

我的建议是，将您的 javascript 代码放在代码后面，然后像这样注册到页面：

```
string script = string.Format("var buttid = '{0}';", cancelDummyButt.ClientID);
if (!ClientScript.IsClientScriptBlockRegistered("myScript"))
{
    ClientScript.RegisterClientScriptBlock(typeof(_Default), "myScript", script, true);
} 
```

# sql-server - 使用 SQL 跟踪/查询状态更改

> ID：650758
> 
>         
> 
> 赞同：0
> 
>         
> 
> 时间：2009-03-16T14:53:17.460
> 
>         
> 
> 标签：sql-server, linq, tsql

我得到了一个数据库设计，它存储有关组织的信息以及组织已经发生或将要发生的任何更改。由于几乎任何关于组织的事情都可能发生变化，因此有一个表只包含名为“Organizations”的表中的唯一 OrganizationID。对该组织的更改都具有生效日期并遵循类似的设计模式，例如以下位置更改：

```
Table: organization_locations

organization_id (int, not null) - Relates back to the Organizations.ID column.
location_id (int, not null) - Relates to Locations.ID
eff_date (datetime, not null) - The date this change becomes effective

Table: Locations

ID (int, pk, identity, not null) - ID of the location
Name (varchar(255), not null) - Name of the location
... Other miscellaneous columns that aren't important for this discussion ... 
```

EG 组织可能只包含两行，它们分别简单地保存 id 的 1 和 2。位置可能有 3 个位置`(id, name)`：

```
1, Location1
2, Location2
3, Location3

organization_locations (organization_id, location_id, eff_date):

1, 1, 1/1/2000  <--- Organization 1 is starting at location 1
1, 2, 1/1/2010  <--- On 1/1/2010, organization 1 moves to location 2 (from location 1)
1, 3, 1/1/2011 <--- On 1/1/2011, organization 1 moves to location 3 (in this case from location 2) 
```

我已经有一个大型且可能过于复杂的查询来指定日期并在给定时间取回组织状态，但我觉得可能有更简单的方法。但是，手头的问题如下：

从这个模式中，我如何回答诸如“在给定的时间范围内哪些组织将从位置 1 移动到另一个位置以及哪些组织将从另一个位置移动到位置 1：date1 到 date2？”之类的问题？

一个类似的问题也可以回答第一个问题：如何查询每个组织的位置更改（简单），同时显示他们正在移动的先前位置（困难？）？

注意：包括 LINQ 标记以防万一在 LINQ 中有一种简单的方法可以做到这一点，我可以走这条路。

* * *

## 回答 #1

> 赞同：1
> 
>             
> 
> 时间：2009-03-16T15:05:04.670

到位置 1：

```
SELECT  DISTINCT organization_id
FROM    organization_locations ol
WHERE   ol.eff_date BETWEEN @date1 AND @date2
        AND ol.location = 1 
```

从位置 1：

```
SELECT  DISTINCT organization_id
FROM    (
        SELECT organization_id,
               (
               SELECT  TOP 1 location_id
               FROM    organization_locations oln
               WHERE   oln.organization_id = ol.organization_id
                       AND oln.eff_date < ol.eff_date
               ORDER BY
                       organization_id DESC, eff_date DESC
               ) AS previous_location
        FROM   organization_locations ol
        WHERE  eff_date BETWEEN @date1 AND @date2
        ) olo
WHERE   previous_location = 1 
```

显示以前的位置：

```
SELECT ol.*,
       (
       SELECT  TOP 1 location_id
       FROM    organization_locations oln
       WHERE   oln.organization_id = ol.organization_id
               AND oln.eff_date < ol.eff_date
               AND location_id = 1
       ORDER BY
               organization_id DESC, eff_date DESC
       ) AS previous_location
FROM   organization_locations ol 
```

穿上`UNIQUE INDEX`会对`(organization_id, eff_date)`你有很大帮助。

# asp.net - 您使用 ASP.Net 框架的哪个部分对 IIS 的每个入站请求执行任意代码？

> ID：650760
> 
>         
> 
> 赞同：0
> 
>         
> 
> 时间：2009-03-16T14:53:35.603
> 
>         
> 
> 标签：asp.net, httpmodule, pipeline

我想为通过 IIS 中某个网站的每个请求运行一段离散的 .Net 代码。这是完全独立的代码——它不会影响它之前或之后的任何东西——它会从请求中记录一些信息，然后结束。

请注意，这不是我可以放入 Application_OnRequestBegin 或其他一些 ASP.Net 文件的内容，因为我需要为非 .Net 文件（PDF、图像等）执行此操作。它需要执行通常不会命中 .Net 框架的请求。

我正在寻找一个 HTTP 模块吗？我已经使用了很多 RTFM，但似乎有许多不同的方法可以操纵管道，我不太确定应该使用哪一种。

* * *

## 回答 #1

> 赞同：3
> 
>             
> 
> 时间：2009-03-16T14:57:29.090

您可以使用[HTTP 模块](http://msdn.microsoft.com/en-us/library/ms227673.aspx)，但是，要使用它，您需要将所有请求映射到 IIS，这可以使用[通配符映射来完成。](http://www.microsoft.com/technet/prodtechnol/WindowsServer2003/Library/IIS/5c5ae5e0-f4f9-44b0-a743-f4c3a5ff68ec.mspx?mfr=true). 这将对性能产生影响，因为您将通过 .net 运行时强制所有请求。

您也可以编写自己的 ISAPI 过滤器，但我相信您必须使用 C++。

# 编辑

如果您执行所需的通配符映射，ASP.Net 有一个默认处理程序，请确保您的 windows/microsoft.net/framework..../config/ 文件夹中的 web.config 中仍有此处理程序：

```
<httpHandlers>
....
            <add path="*" verb="GET,HEAD,POST" type="System.Web.DefaultHttpHandler" validate="True"/>
</httpHandlers> 
```

您可能还删除了 Web 配置文件中的处理程序。最后，您可以尝试为 pdf 文件添加显式映射。

* * *

## 回答 #2

> 赞同：1
> 
>             
> 
> 时间：2009-03-16T14:56:26.347

您想编写一个[ISAPI 过滤器](http://msdn.microsoft.com/en-us/library/ms524610.aspx)（5.0 术语）或扩展（在 6.0 中）。

# sql-server - SQL Server 触发器 - 按事务分组

> ID：650761
> 
>         
> 
> 赞同：2
> 
>         
> 
> 时间：2009-03-16T14:54:05.853
> 
>         
> 
> 标签：sql-server, sql-server-2008, triggers

在工作中，我们刚刚开始为我们的数据库构建一个审计框架（即记录在创建或更新时发生了哪些数据更改）。

我们非常希望使用触发器来实现这一点，因为数据有时会从其他地方导入系统，而不仅仅是通过前端。这似乎是一个相当[普遍的解决方案](https://stackoverflow.com/questions/3823/suggestions-for-implementing-audit-tables-in-sql-server)。

但是，我想补充一点：如果用户运行的更新更新了多个表，我希望将它们组合成一个批次（即为每组更新生成一个唯一的批次 ID）。

问题是，从触发器中获取批次 ID。每个更新都将在一个事务中运行，所以我想知道是否可以使用事务 ID 来生成批处理 ID。但是，我在 T-SQL 中的任何地方都找不到访问事务 ID 的方法。

有人有想法么？

PS - 我们正在运行 SQL Server 2008，如果它有什么不同的话

* * *

## 回答 #1

> 赞同：2
> 
>             
> 
> 时间：2009-03-16T16:18:48.083

你可以只使用 select * from sys.dm_tran_current_transaction

[sys.dm_tran_current_transaction](http://msdn.microsoft.com/en-us/library/ms186327.aspx)

* * *

## 回答 #2

> 赞同：1
> 
>             
> 
> 时间：2009-03-16T17:20:57.683

超出了问题的范围，但在设计审计解决方案时需要考虑一些事情。如果您打算审核包含批量插入的记录，请确保您的批量插入都包含 FIRE_TRIGGERS 关键字。您还需要确保触发器本身正确处理多行插入（而不是，不是，不是通过游标！）。

* * *

## 回答 #3

> 赞同：0
> 
>             
> 
> 时间：2009-03-16T15:03:08.623

[在网上](http://tipsonlips.net/post/2007/08/Get-an-SQL-Server-current-transaction-id.aspx)找到这个来获取当前的事务 id（然后你可以用它来生成一个批处理 id），但不确定它是否会工作：

```
SELECT TOP 1
@transactionID = req_transactionID
FROM
  master..syslockinfo l
INNER JOIN
  master..sysprocesses p ON l.req_spid = p.spid AND l.rsc_dbid = p.dbid AND p.spid = @@spid
WHERE
 l.rsc_dbid = db_id() AND p.open_tran != 0 AND req_transactionID > 0
 ORDER BY req_transactionID 
```

# javascript - __proto__ 与 constructor.prototype 有何不同？

> ID：650764
> 
>         
> 
> 赞同：174
> 
>         
> 
> 时间：2009-03-16T14:55:53.943
> 
>         
> 
> 标签：javascript, inheritance, prototype-programming

```
function Gadget(name, color)
{
   this.name = name;
   this.color = color;
}

Gadget.prototype.rating = 3

var newtoy = new Gadget("webcam", "black")

newtoy.constructor.prototype.constructor.prototype.constructor.prototype 
```

它总是返回 rating = 3 的对象。

但是，如果我执行以下操作：

```
newtoy.__proto__.__proto__.__proto__ 
```

链条最终返回`null`。

同样在 Internet Explorer 中，如果没有`__proto__`属性，我将如何检查 null？

* * *

## 回答 #1

> 赞同：219
> 
>             
> 
> 时间：2012-06-28T16:55:50.430

我最近一直在努力解决这个问题，最后想出了这张“地图”，我认为它可以充分说明这个问题

[http://i.stack.imgur.com/KFzI3.png](https://i.stack.imgur.com/KFzI3.png)
![在此处输入图像描述](https://i.stack.imgur.com/KFzI3.png)

我知道我不是第一个编造这个的人，但弄清楚它比找到它更有趣:-)。无论如何，在那之后我发现了另一个我认为基本相同的图表：

[Javascript对象布局](http://www.mollypages.org/tutorials/js.mp)

对我来说最令人惊讶的是发现它`Object.__proto__`指向`Function.prototype`，而不是`Object.prototype`，但我确信这是有充分理由的 :-)

如果有人想测试它，我也会在此处粘贴图像中提到的代码。请注意，一些属性被添加到对象中，以便在一些跳转后轻松知道我们在哪里：

```
Object.O1='';
Object.prototype.Op1='';

Function.F1 = '';
Function.prototype.Fp1 = '';

Cat = function(){};
Cat.C1 = '';
Cat.prototype.Cp1 = '';

mycat = new Cat();
o = {};

// EDITED: using console.dir now instead of console.log
console.dir(mycat);
console.dir(o); 
```

* * *

## 回答 #2

> 赞同：69
> 
>             
> 
> 时间：2009-03-16T16:12:11.217

`constructor`是函数对象的属性所指向的对象的预定义 [[DontEnum]] 属性，`prototype`最初将指向函数对象本身。

`__proto__`等价于对象的内部 [[Prototype]] 属性，即它的实际原型。

当您使用运算符创建对象时`new`，其内部 [[Prototype]] 属性将设置为构造函数属性指向的对象`prototype`。

这意味着`.constructor`将评估为`.__proto__.constructor`，即用于创建对象的构造函数，正如我们所了解的，`protoype`此函数的属性用于设置对象的 [[Prototype]]。

它`.constructor.prototype.constructor`与`.constructor`（只要这些属性没有被覆盖）相同；有关更详细的说明，请参见[此处。](http://joost.zeekat.nl/constructors-considered-mildly-confusing.html)

如果`__proto__`可用，您可以遍历对象的实际原型链。在普通的 ECMAScript3 中没有办法做到这一点，因为 JavaScript 不是为深度继承层次结构设计的。

* * *

## 回答 #3

> 赞同：32
> 
>             
> 
> 时间：2013-02-06T15:23:14.423

JavaScript 中的原型继承是基于`__proto__`属性的，从某种意义上说，每个对象都继承了其属性引用的对象的内容`__proto__`。

该`prototype`属性仅对`Function`对象是特殊的，并且仅在使用`new`运算符调用 a`Function`作为构造函数时才特殊。在这种情况下，创建的对象`__proto__`将被设置为构造函数`Function.prototype`。

这意味着添加 to`Function.prototype`将自动反映在`__proto__`引用`Function.prototype`.

`Function.prototype`用另一个对象替换构造函数**不会**更新`__proto__`任何已经存在的对象的属性。

请注意，`__proto__`不应直接访问属性，而应使用[Object.getPrototypeOf(object)](https://developer.mozilla.org/en-US/docs/JavaScript/Reference/Global_Objects/Object/getPrototypeOf)代替。

为了回答第一个问题，我创建了一个定制的图表`__proto__`和`prototype`参考，不幸的是，stackoverflow 不允许我添加“少于 10 名声望”的图像。也许其他时间。

[编辑] 该图使用`[[Prototype]]`代替，`__proto__`因为这就是 ECMAScript 规范引用内部对象的方式。我希望你能弄清楚一切。

这里有一些提示可以帮助您理解该图：

```
red    = JavaScript Function constructor and its prototype
violet = JavaScript Object constructor and its prototype
green  = user-created objects
         (first created using Object constructor or object literal {},
          second using user-defined constructor function)
blue   = user-defined function and its prototype
         (when you create a function, two objects are created in memory:
          the function and its prototype) 
```

请注意，`constructor`创建的对象中不存在属性，而是从原型继承的。

![在此处输入图像描述](https://i.stack.imgur.com/yt3hb.png)

* * *

## 回答 #4

> 赞同：15
> 
>             
> 
> 时间：2012-07-27T00:40:34.800

**`Object`是夏娃，`Function`也是亚当，亚当 ( `Function`) 用他的骨头 ( `Function.prototype`) 创造了夏娃 ( `Object`)。那么是谁创造了亚当（`Function`）？-- JavaScript 语言的发明者:-)。**

根据 utsaina 的回答，我想添加更多有用的信息。

> 对我来说最令人惊讶的是发现它`Object.__proto__`
>   指向`Function.prototype`，而不是`Object.prototype`，但我确信这是有充分理由的 :-)

不应该。  `Object.__proto__`不应该指向`Object.prototype`. `Object` `o`相反，的实例`o.__proto__`应该指向`Object.prototype`。

（请原谅我在 JavaScript 中使用这些术语`class`，`instance`但你知道 :-)

我认为类`Object`本身是一个实例`Function`，这就是为什么`Object.__proto__ === Function.prototype`。因此：`Object`是夏娃，`Function`也是亚当，亚当 ( `Function`) 用他的骨头 ( `Function.prototype`) 创造了夏娃 ( `Object`)。

此外，甚至类`Function`本身也是它自己的一个实例`Function`，也就是说`Function.__proto__ === Function.prototype`，这也是为什么`Function === Function.constructor`

此外，常规类`Cat`是 的一个实例`Function`，即`Cat.__proto__ === Function.prototype`。

上面的原因是，当我们在 JavaScript 中创建一个类时，实际上我们只是在创建一个函数，它应该是`Function`.  `Object`并且`Function`只是特殊的，但它们仍然是类，而是`Cat`普通类。

**作为一个因素，在 Google Chrome JavaScript 引擎中，以下 4 个：**

*   `Function.prototype`

*   `Function.__proto__`

*   `Object.__proto__`

*   `Cat.__proto__`

它们都`===`（绝对等于）其他 3 个，它们的值是`function Empty() {}`

```
> Function.prototype
  function Empty() {}
> Function.__proto__
  function Empty() {}
> Object.__proto__
  function Empty() {}
> Cat.__proto__
  function Empty() {}
> Function.prototype === Function.__proto__
  true
> Function.__proto__ === Object.__proto__
  true
> Object.__proto__ === Cat.__proto__
  true 
```

好的。那么谁创造了特殊的`function Empty() {}`（`Function.prototype`）？想一想:-)

* * *

## 回答 #5

> 赞同：7
> 
>             
> 
> 时间：2015-06-06T09:31:11.617

我真的不知道为什么人们没有纠正你关于你理解的实际问题的地方。

这将使您更容易发现问题

那么让我们看看发生了什么：

```
var newtoy = new Gadget("webcam", "black")

newtoy 
  .constructor //newtoy's constructor function is newtoy ( the function itself)
    .prototype // the function has a prototype property.( all functions has)
      .constructor // constructor here is a **property** (why ? becuase you just did `prototype.constructor`... see the dot ? )  ! it is not(!) the constructor function  !!! this is where your mess begins. it points back to the constructor function itself ( newtoy function)
         .prototype // so again we are at line 3 of this code snippet
            .constructor //same as line 4 ...
                .prototype 
                 rating = 3 
```

太好了，现在让我们看看这个`__proto__`

在此之前，请记住两件事`__proto__`  ：

1.  当你用`new`操作符创建一个对象时，它的内部`[[Prototype]]`/`proto__`属性将被设置为它的`prototype`property(1)`constructor function`或“创建者”，如果你喜欢的话。  

2.  在 JS 中硬编码 - :`Object.prototype.__proto__`是`null`.

让我们将这两点称为“ `bill`”

```
newtoy
     .__proto__ // When `newtoy` was created , Js put __proto__'s value equal to the value of the cunstructor's prototype value. which is `Gadget.prototype`.
       .__proto__ // Ok so now our starting point is `Gadget.prototype`. so  regarding "bill" who is the constructor function now? watch out !! it's a simple object ! a regular object ! prototype is a regular object!! so who is the constructor function of that object ? Right , it's the `function Object(){...}`.  Ok .( continuing "bill" ) does it has a `prototype` property ? sure. all function has. it's `Object.prototype`. just remember that when Gadget.prototype was created , it's internal `__proto__` was refered to `Object.prototype` becuase as "bill" says :"..will be set to the `prototype` property of   its `constructor function`"
          .__proto__ // Ok so now our satrting point is `Object.prototype`. STOP. read bullet 2.Object.prototype.__proto__ is null by definition. when Object.prototype ( as an object) was created , they SET THE __PROTO__ AS NULL HARDCODED 
```

更好的？

* * *

## 回答 #6

> 赞同：2
> 
>             
> 
> 时间：2013-12-29T13:47:38.550

每个函数都会创建它的原型。当我们使用该函数构造函数创建一个对象时，我的对象的**__proto__**属性将开始指向该函数的原型。

* * *

## 回答 #7

> 赞同：2
> 
>             
> 
> 时间：2018-06-06T21:19:15.130

如果所有这些数字都是压倒性的，那么让我们来看看这些属性的含义。

### `STH.prototype`

创建新函数时，会并行创建一个空对象，并通过`[[Prototype]]`链链接到函数。要访问此对象，我们使用  `prototype`函数的属性。

```
function Gadget() {}
// in background, new object has been created
// we can access it with Gadget.prototype
// it looks somewhat like {constructor: Gadget} 
```

*请记住，`prototype`属性仅可用于函数。*

### STH.constructor

上面提到的原型对象除了一个 - 之外没有任何属性`constructor`。此属性表示创建原型对象的函数。

```
var toy = new Gadget(); 
```

在创建`Gadget`函数时，我们也创建了一个类似的对象`{constructor: Gadget}`- 这与`Gadget.prototype`. as`constructor`指的是创建对象原型的函数，`toy.constructor`代表`Gadget`函数。我们写作`toy.constructor.prototype`，我们`{constructor: Gadget}`又来了。

因此，出现了一个恶性循环：你可以使用`toy.constructor.prototype.constructor.prototype.constructor.prototype.constructor.prototype.constructor.prototype.constructor.prototype.constructor.prototype.constructor.prototype`，而且永远都是`Gadget.prototype`.

```
toy
.constructor    // Gadget
.prototype    // {constructor: Gadget}
.constructor    // Gadget
.prototype    // {constructor: Gadget}
// ... 
```

### STH.__proto__

While`prototype`是特定于函数的属性，`__proto__`可用于所有对象，因为它位于`Object.prototype`. 它指的是可以创建对象的函数的原型。

```
[].__proto__ === Array.prototype
// true

({}).__proto === Object.prototype
// true 
```

这里，`toy.__proto__`是`Gadget.prototype`。作为`Gadget.prototype`一个对象 ( `{}`) 并且对象是用`Object`函数创建的（参见上面的示例），我们得到`Object.prototype`. 这是 JavaScript 中的高级对象，它`__proto__`只能表示`null`.

```
toy
.__proto__    // Gadget.prototype (object looking like {constructor: Gadget})
.__proto__    // Object.prototype (topmost object in JS)
.__proto__    // null - Object.prototype is the end of any chain 
```

* * *

## 回答 #8

> 赞同：2
> 
>             
> 
> 时间：2020-05-29T01:05:12.393

简短的回答：是对创建对象的构造函数`__proto__`的属性的引用。`prototype`

## JavaScript 中的对象

JavaScript 对象是零个或多个属性*集合*的内置类型。属性是保存其他对象、原始值或函数的容器。

## JavaScript 中的构造函数

函数是常规对象（`[[Call]]`以 ECMA-262 术语实现），具有可调用的附加功能，但在 JavaScript 中扮演另一个角色：如果通过运算符调用，它们将成为构造函数（对象的*工厂*`new`） 。因此，构造函数粗略地类似于其他语言中的类。

每个 JavaScript 函数实际上都是`Function`内置函数对象的一个​​实例，它具有一个名为的特殊属性，`prototype`用于实现基于原型的继承和共享属性。构造函数创建的每个对象都有一个对其构造函数值的*隐式*引用（称为原型或`__proto__`）`prototype`。

构造函数`prototype`是一种构建对象的*蓝图*，因为构造函数创建的每个对象都继承了对其`prototype`.

## 原型链

对象通过内部属性`[[Prototype]]`或指定其原型`__proto__`。两个对象之间的原型关系是关于继承的：每个对象都可以有另一个对象作为它的原型。原型可能是`null`值。

由`__proto__`属性连接的对象链称为*原型链*。当引用对象中的属性时，该引用是指原型链中包含该名称的属性的第一个对象中遇到的属性。原型链的行为就好像它是一个单独的对象。

![原型继承.jpg](https://i.stack.imgur.com/BymBf.jpg)

每当您尝试访问对象中的属性时，JavaScript 都会开始在该对象中搜索它，并继续查找其原型、原型的原型等，直到遇到该属性或如果`__proto__`持有该值`null`。

> 这种使用原型链的继承通常称为*委托*，以避免与使用类链的其他语言混淆。

几乎所有对象都是 的实例`Object`，因为`Object.prototype`在它们的原型链中是最后一个。但`Object.prototype`不是`Object`因为`Object.prototype.__proto__`持有值的实例`null`。

`null`您还可以使用如下原型创建对象：

```
var dict = Object.create(null); 
```

这样的对象是比文字对象更好的映射（字典），这就是为什么这种模式有时被称为*字典*模式（*字典*表示字典）。

注意：使用创建的文字对象是since`{}`的实例，是对.`Object``({}).__proto__``Object.prototype`

# c++ - C++：是否可以通过分叉进程共享指针？

> ID：650770
> 
>         
> 
> 赞同：5
> 
>         
> 
> 时间：2009-03-16T14:57:16.220
> 
>         
> 
> 标签：c++, pointers, fork

我有一个计数变量，应该由我分叉并由母进程使用/读取的几个进程计算。

我试图在母进程的 main() 函数中创建一个指针，并在分叉的子进程中计算该指针。那是行不通的！每个孩子似乎都有自己的副本，即使每个进程中的地址都相同。

最好的方法是什么？

* * *

## 回答 #1

> 赞同：15
> 
>             
> 
> 时间：2009-03-16T15:00:02.093

每个子进程都有自己的父进程内存副本（至少在它尝试修改任何内容时）。如果您需要在进程之间共享，您需要查看共享内存或一些类似的 IPC 机制。

顺便说一句，你为什么要把它变成一个社区维基 - 你这样做可能会限制响应。

* * *

## 回答 #2

> 赞同：2
> 
>             
> 
> 时间：2009-03-16T15:03:00.167

2 个进程不能共享相同的内存。确实，分叉的子进程将在分叉后共享相同的底层内存，但尝试写入该内存会导致操作系统在其他地方为其分配新的可写空间。

研究另一种形式的[IPC](http://en.wikipedia.org/wiki/Inter-process_communication)以使用。

* * *

## 回答 #3

> 赞同：1
> 
>             
> 
> 时间：2009-03-17T09:54:43.147

我的经验是，如果你想在至少两个进程之间共享信息，你几乎不想只共享一些 void* 指针到内存中。你可能想看看

[提升进程间](http://www.boost.org/doc/libs/1_38_0/doc/html/interprocess/some_basic_explanations.html#interprocess.some_basic_explanations.sharing_information "提升进程间")

这可以让您了解如何在进程之间共享结构化数据（阅读“类”和“结构”）。

* * *

## 回答 #4

> 赞同：0
> 
>             
> 
> 时间：2009-03-16T15:01:32.323

不，使用 IPC 或线程。仅共享文件描述符（但不共享查找指针）。

* * *

## 回答 #5

> 赞同：0
> 
>             
> 
> 时间：2009-03-16T15:03:45.050

您可能想查看共享内存。

* * *

## 回答 #6

> 赞同：0
> 
>             
> 
> 时间：2009-03-16T15:22:21.087

指针总是位于同一个进程中。**相对于进程的基地址，它是进程私有的。**在任何操作系统中都有不同类型的 IPC 机制可用。您可以选择 Windows 消息、共享内存、套接字、管道等。根据您的要求和数据大小选择一种。另一种机制是使用可用的虚拟内存API将数据写入目标进程，并使用相应的指针通知进程。

* * *

## 回答 #7

> 赞同：0
> 
>             
> 
> 时间：2009-03-16T15:34:33.460

一个简单的选择但有限的 IPC 形式可以很好地用于共享计数是“共享数据段”。在 Windows 上，这是使用`#pragma data_seg`指令实现的。

有关示例，请参见[本文。](http://www.codeguru.com/cpp/misc/misc/ipctechniques/article.php/c305)

# java - 在 Eclipse RCP 中，如何根据编辑器中的“脏”属性禁用保存工具栏按钮

> ID：650775
> 
>         
> 
> 赞同：4
> 
>         
> 
> 时间：2009-03-16T14:57:58.557
> 
>         
> 
> 标签：java, eclipse-rcp

在我的 Eclipse RCP 3.3 应用程序中，我想根据当前编辑器[脏标志](http://help.eclipse.org/help33/topic/org.eclipse.platform.doc.isv/reference/api/org/eclipse/ui/part/EditorPart.html#isDirty())启用或禁用“保存”工具栏按钮。

我正在尝试使用 < [enabledWhen](http://help.eclipse.org/help33/index.jsp?topic=/org.eclipse.platform.doc.isv/reference/api/org/eclipse/core/expressions/package-summary.html) > 标签，但我无法使其工作。

这是 plugin.xml 中的代码部分：

```
<command
 commandId="org.acme.command.save"
 icon="icons/save.png"
 id="org.acme.command.save"
 style="push">
 <enabledWhen>
    <instanceof value="activeEditor"/>
     <test property="dirty" value="true"/>
 </enabledWhen>
</command> 
```

你知道这应该如何工作吗？

* * *

## 回答 #1

> 赞同：5
> 
>             
> 
> 时间：2009-03-31T18:14:44.343

工作台提供了对“保存”和“全部保存”操作的支持，因此您无需像尝试做的那样自己实现它。

推荐的方法是在扩展 ActionBarAdvisor 的类中添加支持。确切的代码将取决于类的结构，但您需要的代码如下。

在您的字段声明中：

```
private IWorkbenchAction saveAction;
private IWorkbenchAction saveAllAction; 
```

在您的 makeActions 方法中：

```
 saveAction = ActionFactory.SAVE.create(window);
    register(saveAction);

    saveAllAction = ActionFactory.SAVE_ALL.create(window);
    register(saveAllAction); 
```

在您的 fillActionBars 方法中：

```
 IToolBarManager saveToolbar = new ToolBarManager(SWT.FLAT | SWT.RIGHT);
    saveToolbar.add(saveAction);
    saveToolbar.add(saveAllAction);
    coolBar.add(new ToolBarContributionItem(saveToolbar, "save")); 
```

工作台将为您处理启用和禁用。

如果您出于某种原因确实想实现自己的代码来执行此操作，那么您采用的方法将起作用。您将需要更正 XML（例如，instanceof 元素正在检查所选对象是否是名为“activeEditor”的类的实例，这可能不是预期的）。

* * *

## 回答 #2

> 赞同：4
> 
>             
> 
> 时间：2009-05-12T11:15:27.667

我的一位才华横溢的同事刚刚找到了 eclipse >= 3.3 的答案：

以下是如何在 plugin.xml 中定义命令：

```
 <command
        commandId="com.acme.bo.command.done"
        id="com.acme.bo.menu.done"
        label="Command to do">
     <visibleWhen>
        <with variable="activeMenuSelection">
           <iterate>
              <adapt type="com.acme.bo.model.Pojo"></adapt>
              <test
                    args="valueThatYouWantToPassTest"
                    property="com.acme.namespace.testedProperty"
                    value="something">
              </test>
           </iterate>
        </with>
     </visibleWhen>
  </command> 
```

然后，您必须再次在 plugin.xml 中定义 propertyTester：

```
 <extension
       point="org.eclipse.core.expressions.propertyTesters">
    <propertyTester
          class="com.acme.namespace.tester.YourPropertyTester"
          id="com.acme.namespace.tester.testedPropertyTester"
          namespace="com.acme.namespace"
          properties="testedProperty"
          type="com.acme.bo.model.Pojo">
    </propertyTester>
 </extension> 
```

这是进行测试的*YourPropertyTester*类：

```
package com.acme.namespace.tester;

import org.eclipse.core.expressions.PropertyTester;

import com.acme.bo.model.Pojo;

public class YourPropertyTester extends PropertyTester {

   @Override
   public boolean test(Object receiver, String property, Object[] args, Object expectedValue) {
      if (receiver == null || !(receiver instanceof Pojo))
         return false;

      Pojo pojo = (Pojo) receiver;
      if (args != null) {
         for (Object object : args) {
            if (pojo.getYourProperty().contains((String)object))
               return true;
         }
      }
      return false;
   }
} 
```

* * *

## 回答 #3

> 赞同：0
> 
>             
> 
> 时间：2009-03-16T15:49:34.893

我不确定它是否可以完全是声明性的。  

```
saveAction = ActionFactory.SAVE.create(PlatformUI.getWorkbench().getActiveWorkbenchWindow());
configurer.registerGlobalAction(saveAction); 
```

你检查[以下线程是否可以帮助你](http://dev.eclipse.org/newslists/news.eclipse.platform.rcp/msg13616.html)？

在 Save Action 的情况下，它可能是[Retargetable action](http://help.eclipse.org/help33/index.jsp?topic=/org.eclipse.platform.doc.isv/guide/wrkAdv_retarget.htm)。

* * *

## 回答 #4

> 赞同：0
> 
>             
> 
> 时间：2009-03-23T20:05:21.740

尝试这个：

```
org.eclipse.core.variables.dynamicVariables
-(variable) [here you should implement resolver class to return active editor]

org.eclipse.core.expressions.definitions
-(definition)
--(with) [reference here your variable]
---(test) [test if dirty]

org.eclipse.ui.commands !mistake: not commands, but handlers
-(handler)
--(enabledWhen)
---(reference) [reference your definition here]

**(updated)**
org.eclipse.core.properties.propertyTesters
-(propertyTester) 
```

我不确定它是否会起作用，但有机会......

* * *

## 回答 #5

> 赞同：0
> 
>             
> 
> 时间：2010-05-30T08:39:07.107

如果您在激活属性测试器时遇到问题，请注意您的属性测试器实现必须位于与*org.eclipse.core.expressions.propertyTesters*扩展点相同的插件中。

# sql - 缺少连接谓词警告

> ID：650779
> 
>         
> 
> 赞同：0
> 
>         
> 
> 时间：2009-03-16T14:58:45.107
> 
>         
> 
> 标签：sql, sql-server, performance, profiler

我正在使用探查器运行 SQL Server 2005 跟踪。我看到一些丢失的连接谓词警告，但我无法确定它与他们给我的数据发生在哪里。我只有事务ID。有什么方法可以找出造成这种情况的对象是什么？

* * *

## 回答 #1

> 赞同：3
> 
>             
> 
> 时间：2009-03-16T15:04:17.327

如果您有探查器跟踪数据，这将是由于在它之前运行的查询。

# c# - 将当前路由值/url 放入表单 post

> ID：650780
> 
>         
> 
> 赞同：0
> 
>         
> 
> 时间：2009-03-16T14:59:11.363
> 
>         
> 
> 标签：c#, .net, asp.net-mvc

在我的母版页中，我有一个语言下拉菜单。当用户从下拉列表中选择一种语言时，提交会将当前选择的语言发送到我的控制器中的“翻译”方法。之后它应该重定向到翻译提交之前的 url，以便它可以显示完全相同的页面，但现在使用新选择的语言。

我最好怎么做？我应该以某种方式在隐藏字段中发送当前网址吗？或者我可以发送当前的路由值字典，所以我的翻译方法可以直接重定向到路由吗？  

或者也许有更好的方法？

**--EDIT--**

因为我希望我的书签也包含站点语言，所以我所有公开的操作也有一个 siteLanguage 参数。如果我能以某种方式有效地向用户显示一堆常规（GET）链接，其中 siteLanguage 参数填充了相关值，那就更好了。但据我所知，除了 java 之外，没有办法将链接放在下拉列表中。

* * *

## 回答 #1

> 赞同：1
> 
>             
> 
> 时间：2009-03-16T15:20:19.940

我有类似的情况，我的解决方法略有不同。

因为我的母版页中有*功能*，所以我创建了一个新的基本控制器类（从 Controller 继承）并且我所有的真实控制器都从我的自定义类继承。

然后，我在基类中实现 OnActionExecuting 来做一些常见的工作。

然后，在您的母版页中，如果您有这样的表单，它将使用 GET 请求提交到当前 URL，并将语言添加为查询字符串参数：

```
<form id="language" method="get" >
    <select name="language">
        <option value="en">English</option>
        <option value="es">Spanish</option>
        ...
    </select>
</form> 
```

使用 jQuery 将其连接到自动提交等。

您可以在基本控制器类的查询字符串中查找语言参数，并设置标志来告诉真正的控制器方法使用哪种语言。在模型中，您直接进入真实控制器重新生成页面并避免重定向。

请注意，如果您还没有使用查询字符串参数，这只能通用。

如果这对您不起作用，您也可以使用当前方法，但在隐藏字段中包含要重定向到的 URL，如下所示：

```
<%= Html.Hidden("redirect", Request.Url %> 
```

* * *

## 回答 #2

> 赞同：0
> 
>             
> 
> 时间：2009-03-16T15:06:41.157

```
public ActionResult Translate(string _lang){
      switch(_lang){
             case "English":
                   return View("English");
             case: "French":
                   return View("French");
             default:
                   return View("English");
} 
```

我个人会这样做

* * *

## 回答 #3

> 赞同：0
> 
>             
> 
> 时间：2009-03-16T15:10:29.057

我会将返回 url 放在查询字符串中，就像表单身份验证在重定向到登录页面时所做的那样。

当您执行翻译请求时，将 returnUrl 包含在 routeValues 中。

# c# - 确定用户输入是否发生更改事件

> ID：650784
> 
>         
> 
> 赞同：8
> 
>         
> 
> 时间：2009-03-16T15:00:07.320
> 
>         
> 
> 标签：c#, .net

在 C# 中，无论值是由用户直接更改还是由于某些其他事件以编程方式更改，都会触发控件（例如 numericupdown）的 Changed 事件。

有没有办法确定事件是否是由于用户输入而发生的？例如，手动更改 numericUpDown1 的值和单击 button1 都会显示“值已更改”。如果我只想显示“值已更改”，如果它是通过用户单击控件中的向上/向下箭头而不是由于单击 button1 而更改的，该怎么办？

```
 private void numericUpDown1_ValueChanged(object sender, EventArgs e)
    {
        MessageBox.Show("value changed");
    }

    private void button1_Click_1(object sender, EventArgs e)
    {
        numericUpDown1.Value = 3;
    } 
```

* * *

## 回答 #1

> 赞同：5
> 
>             
> 
> 时间：2009-03-16T15:05:10.223

没有很好的方法可以做到这一点。您可以找到针对特定情况的解决方法，例如

*   在数字下拉列表中收听 MouseDown 或其他内容，而不是 valueChanged。

*   在按钮单击事件处理程序中设置一个标志，该标志将禁止显示消息框。

    通常，您应该尝试以与更改值无关的方式来组织表单。

* * *

## 回答 #2

> 赞同：5
> 
>             
> 
> 时间：2009-03-16T16:09:21.897

您可以检查 numericUpDown 是否是 ActiveControl。当您在按钮单击期间设置 numericUpDown 的值时，button1 应该是 ActiveControl。当用户通过 numericUpDown 更改值时，numericUpDown 应该是 ActiveControl。

```
if(numericUpDown1 == this.ActiveControl)
{
    MessageBox.Show("value changed");
} 
```

* * *

## 回答 #3

> 赞同：1
> 
>             
> 
> 时间：2009-03-16T15:05:04.220

不，没有内置方法可以执行您尝试执行的操作，因为触发事件的代码会在值更改时触发。

* * *

## 回答 #4

> 赞同：0
> 
>             
> 
> 时间：2014-04-03T08:07:44.780

1.  继承 NumericUpDown 类

2.  创建一个标志以确定以编程方式更改或由 GUI 更改的值

3.  重载值属性以设置上述标志

这是我在 VB .NET 中的解决方案

```
 Private m_blnIsValueChangedByGui As Boolean = True

    Public Property IsValueChangedByGui() As Boolean
        Get
            Return m_blnIsValueChangedByGui
        End Get
        Set(ByVal value As Boolean)
            m_blnIsValueChangedByGui = value
        End Set
    End Property

    Public Shadows Property Value() As Decimal
        Get
            Return MyBase.Value
        End Get
        Set(ByVal value As Decimal)
            IsValueChangedByGui = False

            If (value > Me.Maximum) Then
                MyBase.Value = Me.Maximum
            ElseIf (value < Me.Minimum) Then
                MyBase.Value = Me.Minimum
            Else
                MyBase.Value = value
            End If

            IsValueChangedByGui = True
        End Set
    End Property 
```

* * *

## 回答 #5

> 赞同：0
> 
>             
> 
> 时间：2014-04-03T08:24:25.420

一个有趣的案例是 ComboBox 控件，它确实区分了由 SelectionChangeCommitted 事件引起的选择更改，该事件仅在用户通过 GUI 进行更改时引发，而 SelectedIndexChanged 事件在每次 SelectedIndex 属性更改时引发。您可以检查 ComboBox 的源代码，看看它是如何完成的。当然，不能保证该原则可以转移到其他控件。

* * *

## 回答 #6

> 赞同：0
> 
>             
> 
> 时间：2016-04-01T21:19:32.727

我以前解决过这个问题。我们以 NumericUpDown 控件为例。

首先，创建一个继承自 NumericUpDown 的新控件（称为 MyNumericUpDown）。为 UpButton、DownButton 和 OnLostFocus 方法创建覆盖。还要创建一个公共方法来以编程方式设置控件的值。创建一个名为“ValueChangedType”的枚举类型，它有 4 个不同的值，分别称为 TextEdit、UpButton、DownButton 和 Programmatic（或您喜欢的任何名称）。还要创建一个名为 ChangedType 的 ValueChangedType 类型的属性。这是班级的样子。

```
public partial class MyNumericUpDown : NumericUpDown
{
    public enum ValueChangedType
    {
        TextEdit,
        UpButton,
        DownButton,
        Programmatic
    }
    public ValueChangedType ChangedType = ValueChangedType.Programmatic;
    public MyNumericUpDown()
    {
        InitializeComponent();
    }
    public override void UpButton()
    {
        this.ChangedType = ValueChangedType.UpButton;
        base.UpButton();
    }
    public override void DownButton()
    {
        this.ChangedType = ValueChangedType.DownButton;
        base.DownButton();
    }
    protected override void OnLostFocus(EventArgs e)
    {
        this.ChangedType = ValueChangedType.TextEdit;
        base.OnLostFocus(e);
    }
    public void SetValue(decimal val)
    {
        this.ChangedType = ValueChangedType.Programmatic;
        this.Value = val;
    }
} 
```

现在，在您的表单中，创建一个 MyNumericUpDown 控件（称为“myNUD”）。在控件的 ValueChanged 事件处理程序中，您可以获取 ChangedType 属性的值，并对其进行处理：

```
 private void myNUD_ValueChanged(object sender, EventArgs e)
    {
            MyNumericUpDown nud = sender as MyNumericUpDown;
            var myChangedType = nud.ChangedType;
            /* do something */
    } 
```

# javascript - 通过 POST 的图像响应

> ID：650785
> 
>         
> 
> 赞同：2
> 
>         
> 
> 时间：2009-03-16T15:00:07.350
> 
>         
> 
> 标签：javascript, image, post

我收到一张图片作为对发布请求的响应。如何使用 JavaScript 在网络浏览器上显示相同的内容。是否可以使用 JavaScript 处理二进制数据？

* * *

## 回答 #1

> 赞同：4
> 
>             
> 
> 时间：2009-03-16T15:04:02.427

您也许可以使用 base64 src 创建一个 img-tag：

```
<img alt="嵌入图像"
  src="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAADIA..." />

```

这可能也可以动态完成，使用 .createElement 并设置 src。

但随后您需要以某种方式使用 javascript 将二进制数据转换为 base64。如果您可以在服务器端进行操作会更简单，因为在 javascript 中处理二进制数据可能会给您带来一些麻烦。然而，这会给你带来相当多的开销，但也许这不是问题。

否则，看看这是否对您有帮助：
 [http ://www.webtoolkit.info/javascript-base64.html](http://www.webtoolkit.info/javascript-base64.html)

* * *

## 回答 #2

> 赞同：1
> 
>             
> 
> 时间：2009-03-16T15:41:54.397

使用[Gears](http://gears.google.com/)，您可以将响应转换为 blob，并使用本地缓存服务器绑定到 URL。之后，对该 URL 的任何引用都将在本地使用图像数据进行响应。

* * *

## 回答 #3

> 赞同：1
> 
>             
> 
> 时间：2009-03-16T15:06:51.703

根据数据格式，您可能可以使用[数据 URI](http://en.wikipedia.org/wiki/Data_URI_scheme)来加载图像。注意要注意浏览器支持。

* * *

## 回答 #4

> 赞同：1
> 
>             
> 
> 时间：2009-03-17T09:33:21.713

最跨浏览器的方法是简单地获取图像 URL 作为 POST 请求的响应，然后使用 img src="..." 对图像进行 GET 调用

* * *

## 回答 #5

> 赞同：0
> 
>             
> 
> 时间：2009-03-16T15:03:51.867

否：图像始终从 URL 加载

# c++ - 实现基于表查找的三角函数

> ID：650797
> 
>         
> 
> 赞同：2
> 
>         
> 
> 时间：2009-03-16T15:02:40.653
> 
>         
> 
> 标签：c++, optimization, trigonometry

对于我在业余时间实现的视频游戏，我尝试使用查找表实现我自己的 sinf()、cosf() 和 atan2f() 版本。目的是使实现速度更快，但准确性较低。

我的初始实现如下。这些函数工作，并返回良好的近似值。唯一的问题是它们*比*调用标准 sinf()、cosf() 和 atan2f() 函数要慢。

那么，我做错了什么？

```
// Geometry.h includes definitions of PI, TWO_PI, etc., as
// well as the prototypes for the public functions
#include "Geometry.h"

namespace {
    // Number of entries in the sin/cos lookup table
    const int SinTableCount = 512;

    // Angle covered by each table entry
    const float SinTableDelta = TWO_PI / (float)SinTableCount;

    // Lookup table for Sin() results
    float SinTable[SinTableCount];

    // This object initializes the contents of the SinTable array exactly once
    class SinTableInitializer {
    public:
        SinTableInitializer() {
            for (int i = 0; i < SinTableCount; ++i) {
                SinTable[i] = sinf((float)i * SinTableDelta);
            }
        }
    };
    static SinTableInitializer sinTableInitializer;

    // Number of entries in the atan lookup table
    const int AtanTableCount = 512;

    // Interval covered by each Atan table entry
    const float AtanTableDelta = 1.0f / (float)AtanTableCount;

    // Lookup table for Atan() results
    float AtanTable[AtanTableCount];

    // This object initializes the contents of the AtanTable array exactly once
    class AtanTableInitializer {
    public:
        AtanTableInitializer() {
            for (int i = 0; i < AtanTableCount; ++i) {
                AtanTable[i] = atanf((float)i * AtanTableDelta);
            }
        }
    };
    static AtanTableInitializer atanTableInitializer;

    // Lookup result in table.
    // Preconditions: y > 0, x > 0, y < x
    static float AtanLookup2(float y, float x) {
        assert(y > 0.0f);
        assert(x > 0.0f);
        assert(y < x);

        const float ratio = y / x;
        const int index = (int)(ratio / AtanTableDelta);
        return AtanTable[index];    
    }

}

float Sin(float angle) {
    // If angle is negative, reflect around X-axis and negate result
    bool mustNegateResult = false;
    if (angle < 0.0f) {
        mustNegateResult = true;
        angle = -angle;
    }

    // Normalize angle so that it is in the interval (0.0, PI)
    while (angle >= TWO_PI) {
        angle -= TWO_PI;
    }

    const int index = (int)(angle / SinTableDelta);
    const float result = SinTable[index];

    return mustNegateResult? (-result) : result;
}

float Cos(float angle) {
    return Sin(angle + PI_2);
}

float Atan2(float y, float x) {
    // Handle x == 0 or x == -0
    // (See atan2(3) for specification of sign-bit handling.)
    if (x == 0.0f) {
        if (y > 0.0f) {
            return PI_2;
        }
        else if (y < 0.0f) {
            return -PI_2;
        }
        else if (signbit(x)) {
            return signbit(y)? -PI : PI;
        }
        else {
            return signbit(y)? -0.0f : 0.0f;
        }
    }

    // Handle y == 0, x != 0
    if (y == 0.0f) {
        return (x > 0.0f)? 0.0f : PI;
    }

    // Handle y == x
    if (y == x) {
        return (x > 0.0f)? PI_4 : -(3.0f * PI_4);
    }

    // Handle y == -x
    if (y == -x) {
        return (x > 0.0f)? -PI_4 : (3.0f * PI_4);
    }

    // For other cases, determine quadrant and do appropriate lookup and calculation
    bool right = (x > 0.0f);
    bool top = (y > 0.0f);
    if (right && top) {
        // First quadrant
        if (y < x) {
            return AtanLookup2(y, x);
        }
        else {
            return PI_2 - AtanLookup2(x, y);
        }
    }
    else if (!right && top) {
        // Second quadrant
        const float posx = fabsf(x);
        if (y < posx) {
            return PI - AtanLookup2(y, posx);
        }
        else {
            return PI_2 + AtanLookup2(posx, y);
        }
    }
    else if (!right && !top) {
        // Third quadrant
        const float posx = fabsf(x);
        const float posy = fabsf(y);
        if (posy < posx) {
            return -PI + AtanLookup2(posy, posx);
        }
        else {
            return -PI_2 - AtanLookup2(posx, posy);
        }
    }
    else { // right && !top
        // Fourth quadrant
        const float posy = fabsf(y);
        if (posy < x) {
            return -AtanLookup2(posy, x);
        }
        else {
            return -PI_2 + AtanLookup2(x, posy);
        }
    }

    return 0.0f;
} 
```

* * *

## 回答 #1

> 赞同：9
> 
>             
> 
> 时间：2009-03-16T15:12:20.597

“过早的优化是万恶之源”——Donald Knuth

如今，编译器为三角函数提供了非常有效的内在函数，这些函数可以从现代处理器（SSE 等）中获得最佳效果，这解释了为什么你很难击败内置函数。不要在这些部分上浪费太多时间，而是专注于您可以使用分析器发现的真正瓶颈。

* * *

## 回答 #2

> 赞同：3
> 
>             
> 
> 时间：2009-03-16T16:04:57.617

请记住，您有一个协处理器……如果是 1993 年，您会看到速度有所提高……但是今天您将难以击败本机内在函数。

尝试查看 disassebly to sinf。

* * *

## 回答 #3

> 赞同：2
> 
>             
> 
> 时间：2009-03-16T15:15:08.750

有人已经对此进行了基准测试，看起来`Trig.Math`功能已经优化，并且比您可以提出的任何查找表都要快：

[http://www.tommti-systems.de/go.html?http://www.tommti-systems.de/main-Dateien/reviews/languages/benchmarks.html](http://www.tommti-systems.de/go.html?http://www.tommti-systems.de/main-Dateien/reviews/languages/benchmarks.html)

（他们没有在页面上使用锚点，所以你必须向下滚动大约 1/3）

* * *

## 回答 #4

> 赞同：0
> 
>             
> 
> 时间：2009-03-16T15:11:34.763

我担心这个地方：

```
// Normalize angle so that it is in the interval (0.0, PI)
while (angle >= TWO_PI) {
    angle -= TWO_PI;
} 
```

但是您可以：为所有功能添加时间计，编写特殊的性能测试，运行性能测试，打印时间测试报告。我想你会在这些测试之后知道答案。  

您也可以使用一些分析工具，例如 AQTime。

* * *

## 回答 #5

> 赞同：0
> 
>             
> 
> 时间：2009-03-16T15:18:55.667

内置功能已经很好地优化了，所以要打败它们真的很难。就个人而言，我会在其他地方寻找获得表现的地方。

也就是说，我可以在您的代码中看到一项优化：

```
// Normalize angle so that it is in the interval (0.0, PI)
while (angle >= TWO_PI) {
    angle -= TWO_PI;
} 
```

可以替换为：

```
angle = fmod(angle, TWO_PI); 
```

# c# - 从 C# 中杀死进程外 COM 对象

> ID：650801
> 
>         
> 
> 赞同：2
> 
>         
> 
> 时间：2009-03-16T15:03:41.337
> 
>         
> 
> 标签：c#, com

我有一个进程外 COM 对象，我们使用 dllhost 从 C# 调用（我们无法使用 COM+）。这很好用，而且我有自己的对象池，可以随时使用。COM 对象将被多次重复使用并且运行时间很长（有时超过 20 分钟）。不幸的是，这是一个偶尔挂起的旧 VB ActiveX dll。所以，我需要能够杀死它。我尝试过显式释放 COM 对象，然后从另一个线程收集垃圾，但这无济于事。除了获取 dllhost 的 PID 并在我启动它时将其杀死（可能不那么安全）之外，还有其他人有什么想法吗？谢谢您的帮助。

我试过了

```
System.Runtime.InteropServices.Marshal.ReleaseComObject(m_MyObj);
GC.Collect();
GC.WaitForPendingFinalizers();
m_MyObj = null; 
```

我创建它

```
 uint hResult = Ole32Methods.CoCreateInstance(ref CalcServerGuid, null, (uint)CLSCTX.CLSCTX_LOCAL_SERVER, ref IID_IUnknown,
            out CalcServerInstance); 
```

* * *

## 回答 #1

> 赞同：0
> 
>             
> 
> 时间：2009-03-16T15:18:28.820

如果我了解您正在运行 VB6 COM 对象并且您在 dllhost 中说。这对我来说意味着这是一个在 COM+ 下运行的配置组件。如果这是一个服务器应用程序，您可以使用 COM+ 管理目录关闭服务器应用程序。

仅供参考 dllhost 是 COM+ 托管进程。

为什么要使用 CoCreateInstance？而不是导入包装器并使用 .net bcl 来创建对象。

我唯一的另一个想法是您最好解决挂起问题，然后尝试关闭池。您实际上是通过 COM+ 在 VB 中使用对象池吗？我似乎记得如果不超出 VB6 的约束，就无法使用 VB6 COM 对象进行池化。

# asp.net - 本地化 asp.net 应用程序的最佳方法是什么？

> ID：650807
> 
>         
> 
> 赞同：1
> 
>         
> 
> 时间：2009-03-16T15:04:41.317
> 
>         
> 
> 标签：asp.net, localization

我使用 .po 文件来翻译我的 PHP 应用程序。是否有有效翻译 ASP.net 应用程序的等效方法？

干杯

* * *

## 回答 #1

> 赞同：2
> 
>             
> 
> 时间：2009-03-16T15:09:03.803

使用[资源文件的](http://msdn.microsoft.com/en-us/library/ms227427.aspx)[ASP.NET 本地化](http://msdn.microsoft.com/en-us/library/aa308935.aspx)

例子：

[.NET 中的全球化和本地化](http://www.c-sharpcorner.com/UploadFile/ankithakur/Globalization_Localization_in_DotNet_CSharp07032006023510AM/Globalization_Localization_in_DotNet_CSharp.aspx)

[ASP.NET 2.0 中的本地化](http://www.ondotnet.com/pub/a/dotnet/2005/08/08/localizingaspnet20.html)

* * *

## 回答 #2

> 赞同：1
> 
>             
> 
> 时间：2009-03-16T15:14:37.283

[资源文件的此链接](http://msdn.microsoft.com/en-us/library/ms227427.aspx)应该对您有所帮助。它提供了在 ASP.NET 中进行本地化的标准方法。

# javascript - 添加 HTML 元素 - 使用 Javascript 动态添加文本区域

> ID：650808
> 
>         
> 
> 赞同：1
> 
>         
> 
> 时间：2009-03-16T15:04:43.517
> 
>         
> 
> 标签：javascript

我知道可以使用 Javascript 向网页动态添加/删除 HTML 元素。我想知道以下可能 -

我的coldfusion网页有一个两列表格，表格的最后一行在第一列有一个链接，第二列是空白的。当用户点击该链接时，文本区域会显示在第二列中，该列到目前为止是空白的。

是否可以使用 Javascript 来做到这一点？我浏览了网络上的一些链接和一些指针，如[http://www.dustindiaz.com/add-and-remove-html-elements-dynamically-with-javascript/](http://www.dustindiaz.com/add-and-remove-html-elements-dynamically-with-javascript/)确实有帮助，但似乎它们没有帮助我在我的情况下。

我在这里先向您的帮助表示感谢。

* * *

## 回答 #1

> 赞同：4
> 
>             
> 
> 时间：2009-03-16T15:09:44.300

对于您的方案，可能不需要添加元素。您可以改为将元素加载到 dom 中（但隐藏），然后触发一些代码以在单击链接时显示它。用于此的 javascript 非常简单。

```
function ShowTextArea()
{
    var ta = document.getElementById("textareaId");
    ta.style = "display:inline";
} 
```

* * *

## 回答 #2

> 赞同：3
> 
>             
> 
> 时间：2009-03-16T15:09:06.953

你当然可以这样做。但是，我认为完成它的最佳方法是通常将项目创建为页面的一部分，然后使用 css 样式将其隐藏，直到您想通过 javascript 显示它，而不是从头开始动态创建它。这应该更容易与您的服务器端代码集成。

# .net - 结构到字节数组以通过套接字发送

> ID：650815
> 
>         
> 
> 赞同：2
> 
>         
> 
> 时间：2009-03-16T15:06:27.227
> 
>         
> 
> 标签：.net, sockets, serialization, bytearray, struct

从结构中获取字节数组以通过 TCP 套接字发送的最佳方法是什么？我正在使用 .Net（VB 或 C#）。

* * *

## 回答 #1

> 赞同：8
> 
>             
> 
> 时间：2009-03-16T15:22:28.733

一种选择是将结构的本机表示直接编组到缓冲区中，类似于`memcpy`在 C 中的工作方式。

您需要将适当的属性添加到您的结构中，

```
 [StructLayout(LayoutKind.Sequential, CharSet = CharSet.Ansi, Pack=1)] 
```

然后您可以使用以下方法对其进行序列化：

```
 /// <summary>
    /// Serializes the specified object into a byte array.
    /// </summary>
    /// <param name="nativeObject">The object to serialize.</param>
    /// <returns></returns>
    public static byte[] Serialize(object obj)
    {
        Type objectType = obj.GetType();
        int objectSize = Marshal.SizeOf(obj);
        IntPtr buffer = Marshal.AllocHGlobal(objectSize);
        Marshal.StructureToPtr(obj, buffer, false);
        byte[] array = new byte[objectSize];
        Marshal.Copy(buffer, array , 0, objectSize);
        Marshal.FreeHGlobal(buffer);
        return array;
    } 
```

尽管如此，这是迄今为止最不便携的解决方案。双方都需要使用相同的对齐方式和字节序，如果您需要更改结构本身，则需要自己实现版本控制。

在大多数情况下，您的序列化格式不应该是内部数据结构的直接副本。

* * *

## 回答 #2

> 赞同：3
> 
>             
> 
> 时间：2009-03-16T15:18:25.700

您应该查看[Serialization](http://msdn.microsoft.com/en-us/library/7ay27kt9(VS.85).aspx)。您可以使用许多选项，从[Protocol ](http://code.google.com/p/protobuf/) [Buffers](http://code.google.com/p/protobuf-net/)（由排名第一和第二的 SO 用户实现）到[Xml](http://msdn.microsoft.com/en-us/library/ms950721.aspx)到[BinaryFormatter](http://msdn.microsoft.com/en-us/library/system.runtime.serialization.formatters.binary.binaryformatter.aspx)。

* * *

## 回答 #3

> 赞同：2
> 
>             
> 
> 时间：2013-10-14T17:07:54.190

为什么不直接使用二进制读取器来填充结构的字段，然后再次读取它们呢？您需要知道的只是结构中字段的大小及其在流中的位置，不需要非托管解决方案。这是我写的 waveplayer 的一个例子。

```
 /// <summary>Copies header to a stream</summary>
    /// <param name="waveData">Wav data stream</param>
    /// <param name="format">WAVEFORMATEX wav format</param>
    /// <returns>Stream</returns>
    public Stream CreateStream(Stream waveData, WAVEFORMATEX format)
    {
        MemoryStream stream = new MemoryStream();
        BinaryWriter writer = new BinaryWriter(stream);

        writer.Write(System.Text.Encoding.ASCII.GetBytes("RIFF".ToCharArray()));
        writer.Write((Int32)(waveData.Length + 36)); //File length minus first 8 bytes of RIFF description
        writer.Write(System.Text.Encoding.ASCII.GetBytes("WAVEfmt ".ToCharArray()));
        writer.Write((Int32)16); //length of following chunk: 16
        writer.Write((Int16)format.wFormatTag);
        writer.Write((Int16)format.nChannels);
        writer.Write((Int32)format.nSamplesPerSec);
        writer.Write((Int32)format.nAvgBytesPerSec);
        writer.Write((Int16)format.nBlockAlign);
        writer.Write((Int16)format.wBitsPerSample);
        writer.Write(System.Text.Encoding.ASCII.GetBytes("data".ToCharArray()));
        writer.Write((Int32)waveData.Length);

        waveData.Seek(0, SeekOrigin.Begin);
        byte[] b = new byte[waveData.Length];
        waveData.Read(b, 0, (int)waveData.Length);
        writer.Write(b);
        writer.Seek(0, SeekOrigin.Begin);
        return stream;
    } 
```

* * *

## 回答 #4

> 赞同：1
> 
>             
> 
> 时间：2009-03-16T15:10:10.180

如果您愿意处理字节序（在异构网络中进行通信），那么做到这一点的唯一方法是逐个字段。

* * *

## 回答 #5

> 赞同：0
> 
>             
> 
> 时间：2009-03-16T15:09:34.880

您需要更具体并告诉我们您的语言。

对于许多语言来说，有现成的框架，甚至是语言标准环境的一部分，可以做这些事情。

* * *

## 回答 #6

> 赞同：0
> 
>             
> 
> 时间：2009-03-16T15:11:20.990

我假设 C 语言，因为你说“结构”

您可以使用一个名为

> ssize_t write(int fd, const void *buf, size_t count);

其中 FD 是套接字的文件描述符，缓冲区是结构的地址，count 是字节大小

您可以将其用作：

> 写（套接字，&struct_var，sizeof（struct_var））；

# dotnetnuke - 调试 DotNetNuke 模块

> ID：650818
> 
>         
> 
> 赞同：1
> 
>         
> 
> 时间：2009-03-16T15:07:18.783
> 
>         
> 
> 标签：dotnetnuke, dotnetnuke-module, dotnetnuke-imc

DotNetNuke 4.8 模块间通信开发的最佳 VS 解决方案设置是什么？  

我目前有一个解决方案，其中包含多个 Web 应用程序项目，用于我的 DotNetNuke 模块 - 每个模块都有带有控件的页面作为测试工具。这一切都很好，直到我需要模块开始使用 IModuleCommunicator 和 IModuleListener 相互通信 - 但现在我正在进行模块间通信，调试将不再以这种方式进行。

我很好奇其他人是如何处理这个问题的——有没有办法让你的测试页面模拟 Nuke 环境？你在核弹网站上测试吗？我的解决方案是使用 VSS 进行源代码控制，因此我不想将完整的 nuke 网站作为项目添加到我的解决方案中，因为这会迫使我将其添加到源代码控制中——而且我宁愿没有完整的 nuke 网站源头控制。

我已经能够通过附加到本地 IIS 工作进程进行调试，但这有点痛苦。有没有人对如何减轻调试模块间通信的痛苦有任何建议？  

任何建议将不胜感激。

* * *

## 回答 #1

> 赞同：2
> 
>             
> 
> 时间：2009-03-16T16:18:59.937

我们倾向于在开发 DotNetNuke 站点中进行测试，通常只是附加到 IIS 工作进程进行调试（只是因为它比使用 F5 重建更快）。

我认为，一般来说，您使用 DNN 提供的功能越多，您在 DNN 环境之外进行测试的能力就越少。由于 IMC 是一个专门的 DNN 流程，因此在您让 DNN 成为执行该流程的人之前，您无法进行完整的测试。

* * *

## 回答 #2

> 赞同：2
> 
>             
> 
> 时间：2009-03-18T14:14:35.283

经过大量的反复试验，这就是我最终得到的结果——而且似乎效果很好。

1.  在模块项目上创建了一个 Post-build 事件以复制到本地 nuke 站点进行调试。在“属性/构建事件/构建后事件命令行”下找到...复制 $(TargetDir)$(TargetName).* C:\Inetpub\wwwroot\bin* /y

2.  更改了 Web 设置以默认启动 localhost 网站。在“属性/Web/服务器/使用自定义 Web 服务器”下找到 - 更改为“ [http://localhost/](http://localhost/) ”

3.  在支持类库项目上创建构建后事件以将文件复制到本地网络服务器。也可能只是更改了模块项目上的构建后事件以包含其他文件。

一旦这些设置到位，按 F5 运行项目将启动浏览器并自动附加到 IIS 工作进程。

另外，请记住，如果您在具有 UAC（Vista，win 2008，win 7）的机器上运行此程序，则必须以管理员身份运行 VS，因为复制到 wwwroot 和附加到工作进程都需要提升权限.

# xml - 如何在 T-SQL 中的 XML 字符串中的属性中转义双引号？

> ID：650821
> 
>         
> 
> 赞同：174
> 
>         
> 
> 时间：2009-03-16T15:08:04.680
> 
>         
> 
> 标签：xml, tsql, escaping

非常简单的问题 - 我有一个属性，我想在其中添加双引号。如何转义它们？我试过了

*   \"

*   “”

*   \\"

我已经为所有这些都设置了 xml 类型和 varchar(max) 的 @xml 变量。

```
 declare @xml xml --(or varchar(max) tried both)

 set @xml = '<transaction><item value="hi "mom" lol" 
    ItemId="106"  ItemType="2"  instanceId="215923801"  dataSetId="1" /></transaction>'

 declare @xh int
 exec sp_xml_preparedocument @xh OUTPUT, @xml

 insert into @commits --I declare the table, just removed it for brevity
 select
    x.*
 from openxml(@xh,'/transaction/item')
  WITH (
    dataItemId int,
     dataItemType int,
    instanceId int,
    dataSetId int,
    value varchar(max)
  ) x 
```

* * *

## 回答 #1

> 赞同：273
> 
>             
> 
> 时间：2009-03-16T15:10:12.037

那不是`&quot;`在xml中吗？IE

```
"hi &quot;mom&quot; lol" 
```

**编辑：**经过测试；工作正常：

```
declare @xml xml

 set @xml = '<transaction><item value="hi &quot;mom&quot; lol" 
    ItemId="106"  ItemType="2"  instanceId="215923801"  dataSetId="1" /></transaction>'

select @xml.value('(//item/@value)[1]','varchar(50)') 
```

* * *

## 回答 #2

> 赞同：4
> 
>             
> 
> 时间：2009-03-16T15:14:37.363

tSql 用另一个双引号转义一个双引号。因此，如果您希望它成为您的 sql 字符串文字的一部分，您可以这样做：

```
declare @xml xml 
set @xml = "<transaction><item value=""hi"" /></transaction>" 
```

如果要在 xml 本身的*值*中包含引号，请使用实体，如下所示：

```
declare @xml xml
set @xml = "<transaction><item value=""hi &quot;mom&quot; lol"" /></transaction>" 
```

* * *

## 回答 #3

> 赞同：4
> 
>             
> 
> 时间：2011-09-14T19:52:41.497

无法再发表评论，但投了赞成票，并想让人们知道`&quot;`在 Solr 中为 RegexTransformer 形成正则表达式时，xml 配置文件非常有效，如下所示：`regex=".*img src=&quot;(.*)&quot;.*"`使用转义版本而不是双引号。

* * *

## 回答 #4

> 赞同：2
> 
>             
> 
> 时间：2010-11-18T19:54:48.687

在 Jelly.core 中测试一个文字字符串，可以使用：

```
&lt;core:when test="${ name == 'ABC' }"&gt; 
```

但如果我必须检查字符串“Toy's R Us”：

```
&lt;core:when test="${ name == &amp;quot;Toy&apos;s R Us&amp;quot; }"&gt; 
```

如果内部允许使用双引号，它将是这样的：

```
&lt;core:when test="${ name == "Toy's R Us" }"&gt; 
```

# java - 创建原始数据包以欺骗 UDP 数据包

> ID：650825
> 
>         
> 
> 赞同：2
> 
>         
> 
> 时间：2009-03-16T15:08:59.920
> 
>         
> 
> 标签：java, sockets, udp

我正在寻找使用 Java 来欺骗 UDP 数据包。是否有任何好的 Java 库可以让您创建自己的 RAW SOCKETS？

* * *

## 回答 #1

> 赞同：5
> 
>             
> 
> 时间：2009-03-20T01:09:37.033

我会使用包装[libpcap](http://www.tcpdump.org/)的 Java API 。

libpcap 有一个“注入”功能，允许您发送原始数据包。（当然，您在尝试发送数据包的机器上必须具有 root 或管理员权限。）有许多可用的 Java API，例如[jNetPcap](http://jnetpcap.com/)或[jpacp](http://netresearch.ics.uci.edu/kfujii/jpcap/doc/)。例如，jpcap 有一个[类允许您发送任何数据包](http://netresearch.ics.uci.edu/kfujii/jpcap/doc/javadoc/jpcap/JpcapSender.html)。

* * *

## 回答 #2

> 赞同：0
> 
>             
> 
> 时间：2009-03-16T15:12:00.583

这不是需要不同库的东西。它通常是平台上标准套接字库的一部分，如[Winsock](http://msdn.microsoft.com/en-us/library/ms741416.aspx)或 Berkeley 套接字。相关选项通常称为`ASOCK_RAW`.

* * *

## 回答 #3

> 赞同：0
> 
>             
> 
> 时间：2009-03-16T15:16:38.887

在 Windows XP SP2（可能是更高版本，包括 vista，但我不确定）中，[原始套接字被禁用](http://msdn.microsoft.com/en-us/library/ms740548.aspx)。UDP 套接字的这些限制比 TCP 套接字要宽松一些，因此您仍然可以做任何您想做的事情。该链接包含有关您可以做什么以及如何做的信息，这些信息可能会对您有所帮助，或者至少可以帮助您确定是否可行。

* * *

## 回答 #4

> 赞同：-2
> 
>             
> 
> 时间：2010-09-01T05:04:34.637

如果您想编写一个 java 程序来欺骗 UDP 数据包，那么我会按照 Mike 的建议使用 jNetPcap 或 jpcap。如果您只是想欺骗（而不是编写程序），那么我会尝试使用[wireshark](http://www.wireshark.org/)。

# nhibernate - 具有流畅映射和 Syscache2 二级缓存的 NHibernate

> ID：650836
> 
>         
> 
> 赞同：0
> 
>         
> 
> 时间：2009-03-16T15:10:34.407
> 
>         
> 
> 标签：nhibernate, fluent-nhibernate, second-level-cache

我有一个非常简单的 Country 实体，我想缓存它。这非常有效，但我希望返回缓存实例的克隆版本或将其设为只读，以防止开发人员更改它的状态。

我将如何实现这一目标？我认为 Fluent Readonly() 方法会强制执行此操作，但事实并非如此。

流利映射示例：

```
 Id(x => x.Id);
        Map(x => x.Name).WithLengthOf(50).Not.Nullable().Unique();
        Map(x => x.IsoCode).WithLengthOf(10).Not.Nullable().Unique();
        HasMany(x => x.States).Cascade.None().LazyLoad();          
        Cache.AsReadOnly(); 
```

我的单元测试清楚地表明实体已缓存，并且在后续获取时返回相同的实体，但我希望对象在从持久存储加载后是不可变的。

谢谢！

* * *

## 回答 #1

> 赞同：3
> 
>             
> 
> 时间：2009-03-16T21:30:54.930

如果您希望您的类的实例是不可变的（从某种意义上说，不可能修改对象实例），那么您需要根据它来编写您的类——这与 NHib 或 Fluent NHib 无关。例如，将 NHib 映射到私有字段或私有属性设置器，并且只公开公开属性获取器。

使用 NHib 可以在您的类映射上指定“mutable=false”（不确定如何使用 FNH 执行此操作，抱歉）。这不会使对象在运行时不可变，但它确实通知 NHib 不要检查这些实体的插入、更新和删除。

# jsf - JSF ResponseWriter 自定义组件

> ID：650838
> 
>         
> 
> 赞同：4
> 
>         
> 
> 时间：2009-03-16T15:11:20.210
> 
>         
> 
> 标签：jsf, uicomponents

我知道 ResponseWriter 上的 startElement、endElement 和 writeAttribute 方法。我的问题是我想例如通过将 ah:commandLink 声明为`HtmlCommandLink link = new HtmlCommandLink();`.

如何在我自己的组件中输出类似这样的其他 UIComponent？我可能还想在我的组件中使用一些 RichFaces ajax 东西，所以希望我可以避免从头开始。

编辑：我想做的是使用以下标签创建我自己的标签库`<myTags:commentTree>`。每个评论都有一个回复按钮，当点击回复按钮时，我会在评论下方呈现回复表单。一旦呈现，我想输出例如richfaces`<a4j:commandButton>`组件。这必须在我自己调用的 java 标记文件中完成`CommentsTreeUI.java`。

通常我会输出显示表单和按钮的所有元素，`writer.startElement("input", myComponent); writer.writeAttribute("type", "button", null);`但如果我可以这样做，例如`startElement("a4j:commandbutton", myComponent)`这将有助于我的很多，因为它具有所有内置的 ajax 功能等。

有什么线索吗？

* * *

## 回答 #1

> 赞同：3
> 
>             
> 
> 时间：2009-03-20T11:47:12.087

通过使用添加新组件解决了这个问题

```
HtmlCommandButton button = new HtmlCommandButton();
button.encodeAll(context); 
```

* * *

## 回答 #2

> 赞同：2
> 
>             
> 
> 时间：2009-03-16T15:15:59.357

你可以这样做：

```
HtmlCommandLink link = new HtmlCommandLink();
getChildren().add(link); 
```

它确实取决于您想对子组件做什么，即如果您希望它们被自定义 HTML 包围（例如，在 HTML 列表中），您将需要一些更复杂的东西。

* * *

## 回答 #3

> 赞同：0
> 
>             
> 
> 时间：2009-03-16T22:10:49.453

制作复合控件的一种方法是使用*binding*属性将标记与您自己的代码相关联：

```
<f:view>
    <h:form>
        <h:panelGroup binding="#{compositeControlBean.panelGrid}" />
    </h:form>
</f:view> 
```

*faces-config.xml*中的 bean 配置：

```
<managed-bean>
    <managed-bean-name>compositeControlBean</managed-bean-name>
    <managed-bean-class>
        composite.CompositeControlBean
    </managed-bean-class>
    <managed-bean-scope>request</managed-bean-scope>
</managed-bean> 
```

豆代码：

```
/**
 * Configure this bean in request scope as "compositeControlBean".
 */
public class CompositeControlBean {

  private transient UIComponent panelGrid;

  public UIComponent getPanelGrid() {
    if (panelGrid == null) {
      panelGrid = createCompositePanel();
    }
    return panelGrid;
  }

  public void setPanelGrid(UIComponent panelGrid) {
    this.panelGrid = panelGrid;
  }

  private UIComponent createCompositePanel() {
    initContextMemebers();

    UIComponent commandLink = createCommandLink();

    String id = view.createUniqueId();
    UIComponent panelGrid = application
        .createComponent("javax.faces.HtmlPanelGroup");
    panelGrid.setId(id);
    panelGrid.setRendererType("javax.faces.Group");

    panelGrid.getChildren().add(commandLink);

    return panelGrid;
  }

  private UIComponent createCommandLink() {
    // create control
    String id = view.createUniqueId();
    UIComponent commandLink = application
        .createComponent("javax.faces.HtmlCommandLink");
    commandLink.setId(id);
    commandLink.setRendererType("javax.faces.Link");
    // set attributes (bind to printHello method)
    Map<String, Object> attributes = commandLink
        .getAttributes();
    MethodExpression action = expressionFactory
        .createMethodExpression(elContext,
            "#{compositeControlBean.printHello}",
            String.class, new Class<?>[0]);
    attributes.put("value", "print hello");
    attributes.put("actionExpression", action);
    return commandLink;
  }

  private transient FacesContext context;
  private transient Application application;
  private transient ELContext elContext;
  private transient ExpressionFactory expressionFactory;
  private transient UIViewRoot view;

  private void initContextMemebers() {
    context = FacesContext.getCurrentInstance();
    application = context.getApplication();
    elContext = context.getELContext();
    expressionFactory = application.getExpressionFactory();
    view = context.getViewRoot();
  }

  public String printHello() {
    System.out.println("Hello");
    return null;
  }

} 
```

# multithreading - 在多线程 Windows http 服务器中运行非线程安全的 dll

> ID：650841
> 
>         
> 
> 赞同：3
> 
>         
> 
> 时间：2009-03-16T15:11:28.913
> 
>         
> 
> 标签：multithreading, vb6, activex, thread-safety, activex-exe

我需要将 VB6 应用程序封装为将由 IIS 调用的 COM 对象。VB6 应用程序使用的其中一个 dll 不是线程安全的。

如何确保每当调用我的 COM 对象时它不会与自身的其他实例共享相同的 dll？

我在某处读到 ActiveX exe 在不同的进程中运行每个实例，这就足够了吗？

* * *

## 回答 #1

> 赞同：1
> 
>             
> 
> 时间：2009-03-16T15:57:30.363

您需要阅读 COM 和单元线程模型，[链接文本](http://msdn.microsoft.com/en-us/library/ms693344(VS.85).aspx)。虽然您所做的事情是可能的，但您的性能将会很糟糕，因为您最终将使用单线程公寓，因此所有请求都将被序列化。您确实应该调查为每个请求创建一个单独的进程。

# c# - 关于 UNION、INTERSECT 和 EXCEPT 的 SqlException

> ID：650847
> 
>         
> 
> 赞同：7
> 
>         
> 
> 时间：2009-03-16T15:12:17.320
> 
>         
> 
> 标签：c#, sql, linq-to-sql

有人可以帮我解决这个例外吗？我不明白它的含义或如何解决它......这是一个带有以下消息的 SqlException：

> 使用 UNION、INTERSECT 或 EXCEPT 运算符组合的所有查询必须在其目标列表中具有相同数量的表达式。

我在伪代码中运行查询时得到它，如下所示：

```
// Some filtering of data
var query = data.Subjects
            .Where(has value)
            .Where(has other value among some set of values);

// More filtering, where I need to have two different options
var a = query
            .Where(some foreign key is null);
var b = query
            .Where(some foreign key is not null)
            .Where(and that foreign key has a property which is what I want);
query = a.Union(b);

// Final filter and then get result as a list
var list = query
            .Where(last requirement)
            .ToList(); 
```

如果我删除这些`a.Union(b)`部件，它会毫无例外地运行。所以我知道错误在那里。但为什么我会得到它？我该如何解决？我在这里做的事情太疯狂了吗？我误解了如何使用这个`Union`东西吗？

基本上我所拥有的是一些实体，它们对其他实体具有外键。而且我需要获取所有具有该外键设置`null`或该外部实体满足某些要求的实体。

* * *

## 回答 #1

> 赞同：10
> 
>             
> 
> 时间：2009-07-23T12:26:37.600

从您列出的 SQL 错误来看，您可能遇到了与我相同的问题。基本上，当在两个不同查询上使用 Concat 或 Union 扩展方法的 Linq to SQL 查询时，Linq to SQL 中似乎存在一个错误，该错误会分别优化每个投影，而不考虑投影必须保持不变才能完成的事实SQL 联盟。

参考：

[使用 UNION 或 CONCAT 时，LINQ to SQL 会产生不正确的 TSQL](https://connect.microsoft.com/VisualStudio/feedback/ViewFeedback.aspx?FeedbackID=355734)

[Linq to SQL Union 相同的字段名生成错误](http://social.msdn.microsoft.com/Forums/en-US/linqtosql/thread/00e387f6-0633-4779-a2d7-af60e78857d5)

如果这也恰好是您的问题，我已经找到了一个对我有用的解决方案，如下所示。

```
var queryA = 
    from a in context.TableA
    select new 
    {
        id,
        name,
        onlyInTableA,
    }

var queryB = 
    from b in context.TableB
    let onlyInTableA = default(string)
    select new 
    {
        id,
        name,
        onlyInTableA,
    }

var results = queryA.Union(queryB).ToList(); 
```

* * *

## 回答 #2

> 赞同：5
> 
>             
> 
> 时间：2009-03-17T08:31:24.967

由于这看起来像是生成的 SQL 的问题，您应该尝试使用 SQL Profiler，或使用[DebuggerWritter 类](http://www.u2u.info/Blogs/Kris/Lists/Posts/Post.aspx?ID=11)的此代码将 SQL 写入 Visual Studio 中的输出窗口。

SQL 错误通常是由于为 UNION 检索到的字段与 2 个查询不同。例如，如果第一个查询可能有 3 个字段，但第二个查询有 4 个字段，则会出现此错误。因此，在这种情况下，查看生成的 SQL 肯定会有所帮助。

* * *

## 回答 #3

> 赞同：0
> 
>             
> 
> 时间：2009-03-16T15:21:41.043

你能不能把它写在一个查询中？

```
.Where(row => row.ForeignKey == null || row.ForeignKey.SomeCondition); 
```

也有合并表达式 ( `OrElse`) 的方法，但这不是微不足道的。

不过，不确定错误来自哪里！

编辑：尚未对其进行测试，但这在逻辑上应该等同于 UNION：

```
public static IQueryable<T> WhereAnyOf<T>(
    this IQueryable<T> source,
    params Expression<Func<T, bool>>[] predicates)
{
    if (source == null) throw new ArgumentNullException("source");
    if (predicates == null) throw new ArgumentNullException("predicates");
    if (predicates.Length == 0) return source.Where(row => false);
    if (predicates.Length == 1) return source.Where(predicates[0]);

    var param = Expression.Parameter(typeof(T), "row");
    Expression body = Expression.Invoke(predicates[0], param);
    for (int i = 1; i < predicates.Length; i++)
    {
        body = Expression.OrElse(body,
            Expression.Invoke(predicates[i], param));
    }
    return source.Where(Expression.Lambda<Func<T, bool>>(body, param));
} 
```

* * *

## 回答 #4

> 赞同：0
> 
>             
> 
> 时间：2009-03-16T15:25:51.063

> 查询 = a.Union(b);

改变捕获的变量不是一个好主意......可能是错误的原因。

更新：好的不

这是另一个想法。提示在错误消息中。

```
var a = query
         .Where(some foreign key is null)
         .Select(x => x); 
```

或者通过添加另一个“假”来玩，直到它们变得相等:)

* * *

## 回答 #5

> 赞同：0
> 
>             
> 
> 时间：2009-03-17T12:29:16.707

我会调用`data.GetCommand(query)`并分析结果`DbCommand`（尤其是生成的 SQL 字符串）。这应该给你一个线索，知道出了什么问题。

任何地方都没有投影，所以我希望两个目标列表是相同的。

您可以尝试将您的查询减少到一个仍然不起作用的较小的查询。开始`query.Union(query)`（这至少应该有效）。比`Where`一一添加您的电话，看看它何时停止工作。

它必须是您的`Where`电话之一，将额外的列添加到您的选择列表中。

* * *

## 回答 #6

> 赞同：0
> 
>             
> 
> 时间：2009-03-18T07:30:13.133

您是否有机会将值传递给变量中的“选择”端，或者您是否多次返回同一字段？SP1 引入了一个错误，它试图“优化”这些事情，这可能导致联合查询中断（由于查询部分“优化”了不同的传入参数）。

如果您发布您的实际查询而不是伪代码，则更容易识别是否是这种情况。

（如果是这种情况，一种解决方法是首先实现各个部分，然后进行客户端（L2O）联合）。

* * *

## 回答 #7

> 赞同：0
> 
>             
> 
> 时间：2009-11-10T07:19:56.507

jpierson 正确总结了问题。

我也遇到了问题，这次是由 select 语句中的一些文字引起的：

`Dim results = (From t in TestDataContext.Table1 _

Where t.ID = WantedID _

Select t.name, SpecialField = 0, AnotherSpecialField = 0, t.Address).Union _

From t in TestDataContext.Table1 _

Where t.SecondID = WantedSecondID _

Select t.name, SpecialField = 1, AnotherSpecialField = 0, t.Address)`  

“SpecialField = 0”和“AnotherSpecialField = 0”的第一个子查询进行了优化，导致在联合中使用一个字段而不是两个字段，这显然会失败。

我必须更改第一个查询，以便 SpecialField 和 AnotherSpecialField 具有不同的值，就像在第二个子查询中一样。

* * *

## 回答 #8

> 赞同：0
> 
>             
> 
> 时间：2010-05-26T11:43:07.993

好吧，我对此有疑问。使用 Sql 08 我有两个表函数，在这两种情况下都返回一个 int 和一个字符串。我创建了一个复杂的对象并使用 linq 来尝试 UNION。有一个 IEqualityComparer 进行比较。一切编译正常，但因不支持的重载而崩溃。好的，我意识到所讨论的问题似乎有点延迟执行。所以我得到了集合，并放置了 ToList()，然后执行 UNION，一切都很好。不确定这是否有帮助，但它对我有用

# c# - 以编程方式更改系统日期

> ID：650849
> 
>         
> 
> 赞同：60
> 
>         
> 
> 时间：2009-03-16T15:12:29.363
> 
>         
> 
> 标签：c#, datetime, date, time, system

如何使用 C# 以编程方式更改本地系统的日期和时间？

* * *

## 回答 #1

> 赞同：88
> 
>             
> 
> 时间：2009-03-16T15:17:56.060

[这是我找到答案的地方。](http://www.codeguru.com/forum/archive/index.php/t-246724.html); 我在这里重新发布它以提高清晰度。

定义这个结构：

```
[StructLayout(LayoutKind.Sequential)]
public struct SYSTEMTIME
{
    public short wYear;
    public short wMonth;
    public short wDayOfWeek;
    public short wDay;
    public short wHour;
    public short wMinute;
    public short wSecond;
    public short wMilliseconds;
} 
```

将以下`extern`方法添加到您的类中：

```
[DllImport("kernel32.dll", SetLastError = true)]
public static extern bool SetSystemTime(ref SYSTEMTIME st); 
```

然后使用您的结构实例调用该方法，如下所示：

```
SYSTEMTIME st = new SYSTEMTIME();
st.wYear = 2009; // must be short
st.wMonth = 1;
st.wDay = 1;
st.wHour = 0;
st.wMinute = 0;
st.wSecond = 0;

SetSystemTime(ref st); // invoke this method. 
```

* * *

## 回答 #2

> 赞同：18
> 
>             
> 
> 时间：2013-12-30T21:33:40.087

这里已经有很多很棒的观点和方法，但是这里有一些目前被遗漏的规范，我觉得它们可能会绊倒一些人。

1.  在**Windows Vista、7、8 操作系统**上，这将*需要*UAC 提示以获得成功执行该`SetSystemTime`功能所需的管理权限。原因是调用进程需要**SE_SYSTEMTIME_NAME**权限。

2.  该`SetSystemTime`函数需要一个`SYSTEMTIME`协调世界时**(UTC)**中的结构。否则它将无法按预期工作。

根据您获取`DateTime`值的位置/方式，最好[`ToUniversalTime()`](http://msdn.microsoft.com/en-us/library/system.datetime.touniversaltime%28v=vs.110%29.aspx)在设置结构中的相应值之前安全使用并使用它`SYSTEMTIME`。

代码示例：

```
DateTime tempDateTime = GetDateTimeFromSomeService();
DateTime dateTime = tempDateTime.ToUniversalTime();

SYSTEMTIME st = new SYSTEMTIME();
// All of these must be short
st.wYear = (short)dateTime.Year;
st.wMonth = (short)dateTime.Month;
st.wDay = (short)dateTime.Day;
st.wHour = (short)dateTime.Hour;
st.wMinute = (short)dateTime.Minute;
st.wSecond = (short)dateTime.Second;

// invoke the SetSystemTime method now
SetSystemTime(ref st); 
```

* * *

## 回答 #3

> 赞同：15
> 
>             
> 
> 时间：2009-03-16T15:28:20.683

您可以使用对 DOS 命令的调用，但在 windows dll 中调用该函数是一种更好的方法。

```
public struct SystemTime
{
    public ushort Year;
    public ushort Month;
    public ushort DayOfWeek;
    public ushort Day;
    public ushort Hour;
    public ushort Minute;
    public ushort Second;
    public ushort Millisecond;
};

[DllImport("kernel32.dll", EntryPoint = "GetSystemTime", SetLastError = true)]
public extern static void Win32GetSystemTime(ref SystemTime sysTime);

[DllImport("kernel32.dll", EntryPoint = "SetSystemTime", SetLastError = true)]
public extern static bool Win32SetSystemTime(ref SystemTime sysTime);

private void button1_Click(object sender, EventArgs e)
{
    // Set system date and time
    SystemTime updatedTime = new SystemTime();
    updatedTime.Year = (ushort)2009;
    updatedTime.Month = (ushort)3;
    updatedTime.Day = (ushort)16;
    updatedTime.Hour = (ushort)10;
    updatedTime.Minute = (ushort)0;
    updatedTime.Second = (ushort)0;
    // Call the unmanaged function that sets the new date and time instantly
    Win32SetSystemTime(ref updatedTime);
} 
```

* * *

## 回答 #4

> 赞同：8
> 
>             
> 
> 时间：2014-09-04T02:21:59.193

**使用此功能更改系统时间（在window 8中测试）**

```
 void setDate(string dateInYourSystemFormat)
    {
        var proc = new System.Diagnostics.ProcessStartInfo();
        proc.UseShellExecute = true;
        proc.WorkingDirectory = @"C:\Windows\System32";
        proc.CreateNoWindow = true;
        proc.FileName = @"C:\Windows\System32\cmd.exe";
        proc.Verb = "runas";
        proc.Arguments = "/C date " + dateInYourSystemFormat;
        try
        {
            System.Diagnostics.Process.Start(proc);
        }
        catch
        {
            MessageBox.Show("Error to change time of your system");
            Application.ExitThread();
        }
    }
void setTime(string timeInYourSystemFormat)
    {
        var proc = new System.Diagnostics.ProcessStartInfo();
        proc.UseShellExecute = true;
        proc.WorkingDirectory = @"C:\Windows\System32";
        proc.CreateNoWindow = true;
        proc.FileName = @"C:\Windows\System32\cmd.exe";
        proc.Verb = "runas";
        proc.Arguments = "/C time " + timeInYourSystemFormat;
        try
        {
            System.Diagnostics.Process.Start(proc);
        }
        catch
        {
            MessageBox.Show("Error to change time of your system");
            Application.ExitThread();
        }
    } 
```

**示例：**
调用
setDate("5-6-92");**形式的加载方法；**setTime("2:4:5 AM");

* * *

## 回答 #5

> 赞同：7
> 
>             
> 
> 时间：2009-03-16T15:16:22.897

1.  PInvoke 调用 Win32 API SetSystemTime，（**[示例](http://www.pinvoke.net/default.aspx/kernel32/SetSystemTime.html)**）

2.  System.Management 类与 WMI 类 Win32_OperatingSystem 并在该类上调用 SetDateTime。  

两者都要求调用者已被授予 SeSystemTimePrivilege 并启用此权限。  

* * *

## 回答 #6

> 赞同：3
> 
>             
> 
> 时间：2009-03-16T22:29:55.070

由于我在评论中提到它，这里是一个 C++/CLI 包装器：

```
#include <windows.h>
namespace JDanielSmith
{
    public ref class Utilities abstract sealed /* abstract sealed = static */
    {
    public:
        CA_SUPPRESS_MESSAGE("Microsoft.Security", "CA2122:DoNotIndirectlyExposeMethodsWithLinkDemands")
        static void SetSystemTime(System::DateTime dateTime) {
            LARGE_INTEGER largeInteger;
            largeInteger.QuadPart = dateTime.ToFileTimeUtc(); // "If your compiler has built-in support for 64-bit integers, use the QuadPart member to store the 64-bit integer."

            FILETIME fileTime; // "...copy the LowPart and HighPart members [of LARGE_INTEGER] into the FILETIME structure."
            fileTime.dwHighDateTime = largeInteger.HighPart;
            fileTime.dwLowDateTime = largeInteger.LowPart;

            SYSTEMTIME systemTime;
            if (FileTimeToSystemTime(&fileTime, &systemTime))
            {
                if (::SetSystemTime(&systemTime))
                    return;
            }

            HRESULT hr = HRESULT_FROM_WIN32(GetLastError());
            throw System::Runtime::InteropServices::Marshal::GetExceptionForHR(hr);
        }
    };
} 
```

C# 客户端代码现在非常简单：

```
JDanielSmith.Utilities.SetSystemTime(DateTime.Now); 
```

* * *

## 回答 #7

> 赞同：2
> 
>             
> 
> 时间：2021-05-07T10:19:53.820

为其他正在寻找的人提供的复制/粘贴课程

```
using System;
using System.ComponentModel;
using System.Runtime.InteropServices;

public static class SystemDateTime
{
    [DllImport("kernel32.dll", EntryPoint = "SetSystemTime", SetLastError = true)]
    private static extern bool Win32SetSystemTime(ref SystemTime sysTime);

    [StructLayout(LayoutKind.Sequential)]
    public struct SystemTime
    {
        public ushort Year;
        public ushort Month;
        public ushort DayOfWeek;
        public ushort Day;
        public ushort Hour;
        public ushort Minute;
        public ushort Second;
        public ushort Millisecond;
    };

    public static void SetSystemDateTime(int year, int month, int day, int hour,
        int minute, int second, int millisecond)
    {
        SystemTime updatedTime = new SystemTime
        {
            Year = (ushort) year,
            Month = (ushort) month,
            Day = (ushort) day,
            Hour = (ushort) hour,
            Minute = (ushort) minute,
            Second = (ushort) second,
            Millisecond = (ushort) millisecond
        };

        // If this returns false, then the problem is most likely that you don't have the 
        // admin privileges required to set the system clock
        if (!Win32SetSystemTime(ref updatedTime))
        {
            throw new Win32Exception(Marshal.GetLastWin32Error());
        }
    }

    public static void SetSystemDateTime(DateTime dateTime)
    {
        SetSystemDateTime(dateTime.Year, dateTime.Month, dateTime.Day, dateTime.Hour, dateTime.Minute,
            dateTime.Second, dateTime.Millisecond);
    }
} 
```

* * *

## 回答 #8

> 赞同：1
> 
>             
> 
> 时间：2019-05-07T07:46:00.250

当心！。如果您从结构中删除未使用的属性，则会设置错误的时间。我因此失去了 1 天。我认为结构的顺序很重要。

这是正确的结构：

```
public struct SystemTime
        {
            public ushort Year;
            public ushort Month;
            public ushort DayOfWeek;
            public ushort Day;
            public ushort Hour;
            public ushort Minute;
            public ushort Second;
            public ushort Millisecond;

        }; 
```

如果您运行 SetSystemTime()，它会按预期工作。对于测试，我将时间设置如下；

```
SystemTime st = new SystemTime();
st.Year = 2019;
st.Month = 10;
st.Day = 15;
st.Hour = 10;
st.Minute = 20;
st.Second = 30;

SetSystemTime(ref st); 
```

**时间设定：15.10.2019 10:20，没关系。** 

但是我删除了未使用的 DayOfWeek 属性；

```
public struct SystemTime
            {
                public ushort Year;
                public ushort Month;
                public ushort Day;
                public ushort Hour;
                public ushort Minute;
                public ushort Second;
                public ushort Millisecond;

            };

SystemTime st = new SystemTime();
    st.Year = 2019;
    st.Month = 10;
    st.Day = 15;
    st.Hour = 10;
    st.Minute = 20;
    st.Second = 30;

    SetSystemTime(ref st); 
```

**运行相同的代码，但时间设置为：10.10.2019 20:30**

请注意 SystemTime 结构的顺序和所有字段。优素福

* * *

## 回答 #9

> 赞同：-4
> 
>             
> 
> 时间：2014-12-28T11:49:13.130

> proc.Arguments = "/C 日期：" + dateInYourSystemFormat;

这是功函数：

```
void setDate(string dateInYourSystemFormat)
{
    var proc = new System.Diagnostics.ProcessStartInfo();
    proc.UseShellExecute = true;
    proc.WorkingDirectory = @"C:\Windows\System32";
    proc.CreateNoWindow = true;
    proc.FileName = @"C:\Windows\System32\cmd.exe";
    proc.Verb = "runas";
    proc.Arguments = "/C Date:" + dateInYourSystemFormat;
    try
    {
        System.Diagnostics.Process.Start(proc);
    }
    catch
    {
        MessageBox.Show("Error to change time of your system");
        Application.ExitThread();
    }
} 
```

# jquery - jQuery：向选择器添加上下文比优化选择器要快得多？

> ID：650860
> 
>         
> 
> 赞同：12
> 
>         
> 
> 时间：2009-03-16T15:14:56.597
> 
>         
> 
> 标签：jquery, css-selectors

我刚刚注意到向选择器添加上下文比优化选择器要快得多。

`$('li',$('#bar')).append('bla');`

比以下速度快两倍：

`$('#bar li').append('bla');`

这通常是真的吗？

* * *

## 回答 #1

> 赞同：15
> 
>             
> 
> 时间：2009-03-16T19:28:51.683

> 向选择器添加上下文比优化选择器要快得多

这在一般情况下是正确的。但是，对于您的具体示例，jQuery <= 1.2.6 不一定是正确的。

直到并包括 jQuery 1.2.6，选择器引擎以“自上而下”（或“从左到右”）的方式工作。这意味着您的两个示例都将像这样（大致）运行：

```
var root = document.getElementById('bar');
return root.getElementsByTagName('li'); 
```

jQuery 1.3.x（即jQuery 嵌入的[Sizzle](http://sizzlejs.com/)）[引入了一种“自下而上”（或“从右到左”）方法](http://www.slideshare.net/jeresig/recent-changes-to-jquerys-internals)来查询 DOM。所以`$('#bar li')`现在变成（大致）：

```
var results = [];
var elements = document.getElementsByTagName('li');
for(var i=0; i < elements.length; i++) {
    var element = elements[i];
    var parent = element.parentNode;
    while(parent) {
        if(parent.id == 'bar') {
            results.push(element)
            break;
        }
        parent = parent.parentNode;
    }
}
return results 
```

这两种方法都有优点和缺点。你发现了其中一个缺点。

**编辑**：刚刚从[这个讨论](http://groups.google.com/group/jquery-dev/msg/97555a542602fc74)中发现，Sizzle 主干现在特别豁免了选择器 where `#id`is first。它使用它作为根上下文，加快了速度。如果不能消除您看到的速度差异，这应该会减少。

# .net - RESTful WCF 服务在 POST 操作中返回“找不到端点”错误

> ID：650864
> 
>         
> 
> 赞同：10
> 
>         
> 
> 时间：2009-03-16T15:15:30.917
> 
>         
> 
> 标签：.net, wcf, rest

我已经构建了一个通过 SOAP 和 RESTfully 公开的 WCF 服务。所有 SOAP 操作都按照宣传的方式工作。GETS/PUTS 也可以，但是当我尝试对我的服务中的操作执行 POST 时，会返回以下错误：

“未找到端点”

IPersonEditServiceContract 片段：

```
[OperationContract]
[WebInvoke(Method="POST", 
   UriTemplate="/persons", 
   RequestFormat=WebMessageFormat.Xml, 
   ResponseFormat=WebMessageFormat.Xml)]
SavePersonResponse SavePerson(SavePersonRequest request);

[OperationContract]
WebGet(UriTemplate = "/persons/{personId}",
   ResponseFormat = WebMessageFormat.Xml,
   BodyStyle = WebMessageBodyStyle.Bare,
   RequestFormat = WebMessageFormat.Xml)]
Person GetClaimantById(string personId); 
```

服务是这样配置的：

```
<behaviors>
   <endpointBehaviors>
    <behavior name="restBehavior">
     <webHttp />
    </behavior>
   </endpointBehaviors>
</behaviors>
<services>
  <service>
    <endpoint address="" binding="basicHttpBinding" 
        name="DefaultEndpoint"
        bindingNamespace="http://mycompany.com/ServiceContracts"
        contract="IPersonEditServiceContract" />
     <endpoint 
         address="rest" binding="webHttpBinding"
         name="RESTEndpoint" 
         bindingNamespace="http://mycompany.com/ServiceContracts"
         contract="IPersonEditServiceContract" 
         behaviorConfiguration="restBehavior"/>
  </service>
</services> 
```

因为我可以对同一个端点执行其他 RESTful 操作，所以我不完全确定它为什么会给我这个半有用的错误。

想法？

* * *

## 回答 #1

> 赞同：5
> 
>             
> 
> 时间：2009-03-19T07:58:14.697

我认为 WCF 给出了错误，因为它真的找不到端点。您是否使用 POST 到 /rest 下的正确 URL 来点击它？尝试[Fiddler](http://www.fiddler2.com/fiddler2/)创建 POST 调用。

# apache-flex - 如何修复画布中重叠的 VBox 子项？

> ID：650865
> 
>         
> 
> 赞同：0
> 
>         
> 
> 时间：2009-03-16T15:15:52.117
> 
>         
> 
> 标签：apache-flex, layout

我在画布内的 VBox 中有多个 HBox，如下所示：

```
<?xml version="1.0" encoding="utf-8"?>
<mx:Application xmlns:mx="http://www.adobe.com/2006/mxml" layout="absolute" xmlns:local="*">
<mx:Canvas  width="600" height="500">
        <mx:VBox height="100%" left="10" right="10">
        <mx:HBox width="100%" >
        <mx:VBox width="48%" height="100%" horizontalAlign="left">
        <mx:Label text="Label" />

        </mx:VBox>

        <mx:VBox width="48%" height="100%" horizontalAlign="left">
        <mx:Label text="Label" />
        <mx:HBox width="100%">
            <mx:VBox width="48%">   
                <mx:Label text="Label" />
                <mx:ComboBox />
            </mx:VBox>

        </mx:HBox>
        </mx:VBox>

        </mx:HBox>
        <mx:VBox>
            <mx:HBox>
                <mx:Label text="Label" />
                <mx:Label text="Label" />
            </mx:HBox>
        </mx:VBox>
        <mx:HBox>
            <mx:Label text="Label" />
            <mx:ComboBox/>
        </mx:HBox>
        <mx:HBox>
        <mx:VBox horizontalScrollPolicy="off" verticalScrollPolicy="off"
        includeInLayout="false" >
        <mx:Label text="Label"  />

        </mx:VBox>
        <mx:VBox>
        <mx:HBox horizontalScrollPolicy="off" verticalScrollPolicy="off"
            includeInLayout="false"
            >
            <mx:VBox >
                    <mx:Label text="Text" />
                    <mx:ComboBox />
            </mx:VBox>
            <mx:VBox>
                    <mx:Label text="Label" />
                    <mx:ComboBox />
            </mx:VBox>
        </mx:HBox>
        <mx:HBox horizontalScrollPolicy="off" verticalScrollPolicy="off"
            includeInLayout="false"
            >
            <mx:VBox>
                <mx:Label text="Label:"/>
                <mx:ComboBox />
            </mx:VBox>
            <mx:VBox>
                <mx:Label text="Label: "/>
                <mx:ComboBox   />
            </mx:VBox>
        </mx:HBox>
        </mx:VBox>
        </mx:HBox>
        <mx:HBox >
            <mx:Label text="Label:" />
            <mx:CheckBox />
        </mx:HBox>
        </mx:VBox>
    </mx:Canvas>
</mx:Application> 
```

VBox 中的最后一个子元素与其他组件重叠。**如何防止 Canvas 中 VBox 的子级重叠？你如何调试这种情况？**

我尝试了以下方法：

*   删除基于百分比的大小

*   IncludeInLayout = 真

Sceenshot - 标签和复选框重叠：
[![替代文字](https://i.stack.imgur.com/UYI1O.jpg)](https://i.stack.imgur.com/UYI1O.jpg)

* * *

## 回答 #1

> 赞同：0
> 
>             
> 
> 时间：2009-03-17T23:40:21.937

我通过使其中一些组件的 includeInLayout 属性与其可见属性使用的条件相同来解决此问题。

不知道是什么导致了这个问题。

* * *

## 回答 #2

> 赞同：0
> 
>             
> 
> 时间：2009-03-17T02:51:15.347

提供的信息很难说，但首先想到的两个问题是：

1.  您的 VBox 高度是否大于其子项高度的总和？

2.  您是否在 VBox 上设置了 verticalGap 属性？verticalGap 确定子项之间的垂直间距。

* * *

## 回答 #3

> 赞同：0
> 
>             
> 
> 时间：2009-03-17T03:43:25.660

我刚刚尝试了这个（AIR 应用程序），它看起来还不错。

```
<?xml version="1.0" encoding="utf-8"?>
<mx:WindowedApplication xmlns:mx="http://www.adobe.com/2006/mxml" layout="absolute">

    <mx:Canvas height="100%" width="100%"
      borderStyle="solid" 
      backgroundColor="0x0000ff">

      <mx:VBox height="100%" width="100%">

        <mx:VBox backgroundColor="0xff0000" height="50%" width="100%">
            <mx:HBox backgroundColor="0x000000" height="50%" width="50%"/>
            <mx:HBox backgroundColor="0xffffff" height="50%" width="50%"/>
            <mx:HBox backgroundColor="0x00ffff" height="50%" width="50%"/>
        </mx:VBox>

    <mx:HBox height="50%" width="100%" 
        backgroundColor="0xff0000" backgroundAlpha="0.5" 
        borderColor="0x000000" borderStyle="solid" borderThickness="1"/>

    </mx:VBox>          

    </mx:Canvas>

</mx:WindowedApplication> 
```

# c# - 从 C# 中的 msi 文件中获取产品名称

> ID：650866
> 
>         
> 
> 赞同：5
> 
>         
> 
> 时间：2009-03-16T15:15:57.623
> 
>         
> 
> 标签：c#, .net, windows-installer

我有一个安装应用程序的 msi 文件。在安装开始*之前*，我需要知道该应用程序的产品名称。

我尝试了以下方法：

```
{ 

...
Type type = Type.GetType("Windows.Installer");
WindowsInstaller.Installer installer = (WindowsInstaller.Installer)
Activator.CreateInstance(type);

installer.OpenDatabase(msiFile, 0); //this is my guess to pass in the msi file name...
...
} 
```

但现在？类型是*null*，这会给我一个错误。我在哪里传递 MSI 文件的名称？

感谢您的任何提示和评论。

* * *

## 回答 #1

> 赞同：6
> 
>             
> 
> 时间：2009-03-16T22:33:10.523

你需要使用：

```
 Type installerType = Type.GetTypeFromProgID("WindowsInstaller.Installer"); 
```

这是我的一些代码的示例 - 在我的情况下，我得到了安装程序版本：

```
 // Get the type of the Windows Installer object
        Type installerType = Type.GetTypeFromProgID("WindowsInstaller.Installer");

        // Create the Windows Installer object
        Installer installer = (Installer)Activator.CreateInstance(installerType);

        // Open the MSI database in the input file
        Database database = installer.OpenDatabase(inputFile, MsiOpenDatabaseMode.msiOpenDatabaseModeReadOnly);

        // Open a view on the Property table for the version property
        View view = database.OpenView("SELECT * FROM Property WHERE Property = 'ProductVersion'");

        // Execute the view query
        view.Execute(null);

        // Get the record from the view
        Record record = view.Fetch();

        // Get the version from the data
        string version = record.get_StringData(2); 
```

* * *

## 回答 #2

> 赞同：2
> 
>             
> 
> 时间：2009-03-16T15:53:57.533

使用此代码会不会更容易：

`Type type = typeof(Windows.Installer);`

如果您更喜欢 Type.GetType(String) 重载，则必须在类的完整路径后包含正确的程序集名称，例如：

`Type type = Type.GetType("Windows.Installer, <assembly for MsiInstaller>");`

* * *

## 回答 #3

> 赞同：1
> 
>             
> 
> 时间：2009-03-16T15:43:09.493

你从哪里得到“Windows.Installer”的东西？

...因为：

1.  `Type.GetType`采用 .NET 类型名称，而不是 COM ProgId。

2.  Windows Installer（至少在 Windows 2003 上）没有 ProgId。

总结：使用 P/Invoke（`DllImport`等）与 MSI API 对话。

# visual-studio - 从网站中排除文件在 Visual Studio 中发布

> ID：650875
> 
>         
> 
> 赞同：84
> 
>         
> 
> 时间：2009-03-16T15:18:48.430
> 
>         
> 
> 标签：visual-studio, visual-studio-2005, web-publishing

在 Visual Studio 2005 中发布网站时可以排除文件夹或文件吗？我想在解决方案资源管理器中保留各种资源，例如各种环境的备用配置文件，但我真的不想将它们发布到服务器。有什么办法可以排除它们吗？当使用其他项目类型（例如 .dll 程序集）时，我可以将文件的 Build Action 属性设置为“None”，并将其 Copy to Output Directory 属性设置为“Do not copy”。我在网站中找不到任何类似的文件设置。

如果 IDE 不提供此功能，是否有人有处理此类文件的好技术？

* * *

## 回答 #1

> 赞同：139
> 
>             
> 
> 时间：2013-07-14T09:31:44.437

通过向项目文件（.csproj、.vbproj 等）添加元素来排除文件和文件夹`ExcludeFilesFromDeployment`。`ExcludeFoldersFromDeployment`您将需要在文本编辑器中编辑该文件，或者在 Visual Studio 中通过卸载项目然后对其进行编辑。

在适当的（调试、发布等）中的任何位置添加标签`PropertyGroup`，如下所示：

```
<PropertyGroup Condition=" '$(Configuration)|$(Platform)' == 'Debug|AnyCPU' "> 
  ... 
  <ExcludeFilesFromDeployment>File1.aspx;Folder2\File2.aspx</ExcludeFilesFromDeployment> 
  <ExcludeFilesFromDeployment>**\.svn\**\*.*</ExcludeFilesFromDeployment>
  <ExcludeFoldersFromDeployment>Folder1;Folder2\Folder2a</ExcludeFoldersFromDeployment> 
</PropertyGroup> 
```

支持通配符。

解释上面的例子：

*   第一个`ExcludeFilesFromDeployment`排除`File1.aspx`（在项目的根目录中）和`Folder2\File2.aspx`（`Folder2`在项目的根目录中）

*   第二个`ExcludeFilesFromDeployment`排除任何命名文件夹`.svn`及其任何子文件夹中的所有文件

*   名为（在项目的根目录中）和（在项目的根目录中）的`ExcludeFoldersFromDeployment`排除文件夹`Folder1``Folder2\Folder2a``Folder2`

有关详细信息，请参阅 MSDN 博客文章[Web 部署：通过 Web 应用程序的项目文件排除文件和文件夹](https://devblogs.microsoft.com/aspnet/web-deployment-excluding-files-and-folders-via-the-web-applications-project-file/)

* * *

## 回答 #2

> 赞同：38
> 
>             
> 
> 时间：2015-04-17T00:33:16.190

令人惊讶的是，Visual Studio 2012 的答案不在这里：

*   带有绿色复选标记的答案不是答案。

*   最高的“升级”答案引用了 2010 年的一篇文章，并说您必须编辑您的 csproj 项目文件，该文件现在不正确。我将 ExcludeFoldersFromDeployment XML 元素添加到了我的 Visual Studio 2012 csproj 文件中，但它什么也没做，该元素被认为是无效的，这是因为 ExcludeFoldersFromDeployment 已被移动到看起来像的 .pubxml 文件中。

**对于 Web 应用程序和网站**，您可以编辑 .pubxml 文件！

您可以按照我的回答或尝试我稍后找到的本指南：http:
 [//www.leniel.net/2014/05/using-msdeploy-publish-profile-pubxml-to-create-an-empty-folder-structure- on-iis-and-skip-deleting-it-with-msdeployskiprules.html#sthash.MSsQD8U1.dpbs](http://www.leniel.net/2014/05/using-msdeploy-publish-profile-pubxml-to-create-an-empty-folder-structure-on-iis-and-skip-deleting-it-with-msdeployskiprules.html#sthash.MSsQD8U1.dpbs)

是的，您不仅可以为网站项目执行此操作，还可以为网站执行此操作。我在互联网上花了很长时间寻找 Visual Studio 网站（不是网站项目）的这种难以捉摸的排除功能，之前得出的结论是不可能的，但看起来是这样的：

在您的 [mypublishwebsitename].pubxml 文件中，在 ~/Properties/PublishProfiles 中找到 Web 应用程序项目和 ~/App_Data/PublishProfiles 中的网站，只需添加：

```
 <ExcludeFilesFromDeployment>File1.aspx;Folder2\File2.aspx</ExcludeFilesFromDeployment> 
 <ExcludeFoldersFromDeployment>Folder1;Folder2\Folder2a</ExcludeFoldersFromDeployment> 
```

`<PropertyGroup>`作为.pubxml 文件中主要元素的子元素。除非您键入特定的构建类型，例如发布或调试，否则无需添加新元素。

**可是等等！！！**

如果您在发布配置中使用以下设置从目标/目标服务器中删除文件：

![在此处输入图像描述](https://i.stack.imgur.com/tMH9Q.png)

然后，Web 发布过程将在您的源/目标服务器上删除任何排除在外的内容，例如您在`<ExcludeFoldersFromDeployment>`和`<ExcludeFilesFromDeployment>`!

**MsDeploy 跳过规则来救援：**

首先，Web Publish 使用 MSBuild 以外的东西来发布（称为 Task IO 或类似的东西），但它有一个错误并且无法识别跳过规则，因此您必须添加到您的 .pubxml：

```
<PropertyGroup>
    <WebPublishMethod>MSDeploy</WebPublishMethod>
</PropertyGroup> 
```

*我会保留`<WebPublishMethod>`它自己的`<PropertyGroup>`，你会认为你可以在你的 .pubxml 中只有一个元素，但是我的跳过规则直到我移动到它自己的元素`<PropertyGroup>`才被调用。是的，很疯狂，但是您需要为 Web Publish 执行所有这些操作以排除并且不删除服务器上的文件夹/文件这一事实很疯狂。`<WebPublishMethod>``<PropertyGroup>`*

现在我的 .pubxml 中的实际 SkipRules、ExcludeFolders 和 ExcludeFiles 声明：

```
<ExcludeFoldersFromDeployment>Config</ExcludeFoldersFromDeployment>
<ExcludeFoldersFromDeployment>Photos</ExcludeFoldersFromDeployment>
<ExcludeFoldersFromDeployment>Temp</ExcludeFoldersFromDeployment>
<ExcludeFilesFromDeployment>Web.config</ExcludeFilesFromDeployment>
 <AfterAddIisSettingAndFileContentsToSourceManifest>AddCustomSkipRules</AfterAddIisSettingAndFileContentsToSourceManifest> 
```

现在跳过规则（`<Target>`是您的.pubxml 中的一个子`<Project>`项）：（**您可以将`<SkipAction>`所有操作留空以跳过，但我没有对此进行测试并且不确定。**

```
 <Target Name="AddCustomSkipRules">
    <Message Text="Adding Custom Skip Rules" />
    <ItemGroup>
      <MsDeploySkipRules Include="SkipConfigFolder">
        <SkipAction>Delete</SkipAction>
        <ObjectName>dirPath</ObjectName>
        <AbsolutePath>$(_DestinationContentPath)\\Config</AbsolutePath>
        <XPath>
        </XPath>
      </MsDeploySkipRules>
      <MsDeploySkipRules Include="SkipPhotosFolder">
        <SkipAction>Delete</SkipAction>
        <ObjectName>dirPath</ObjectName>
        <AbsolutePath>$(_DestinationContentPath)\\Photos</AbsolutePath>
        <XPath>
        </XPath>
      </MsDeploySkipRules>
      <MsDeploySkipRules Include="SkipWebConfig">
        <SkipAction>Delete</SkipAction>
        <ObjectName>filePath</ObjectName>
        <AbsolutePath>$(_DestinationContentPath)\\Web\.config</AbsolutePath>
        <XPath>
        </XPath>
      </MsDeploySkipRules>
      <MsDeploySkipRules Include="SkipWebConfig">
        <SkipAction>Delete</SkipAction>
        <ObjectName>dirPath</ObjectName>
        <AbsolutePath>$(_DestinationContentPath)\\Temp</AbsolutePath>
        <XPath>
        </XPath>
      </MsDeploySkipRules>
    </ItemGroup>
  </Target> 
```

**并且请不要忘记`.`使用反斜杠转义 filePath Skip 规则。**

* * *

## 回答 #3

> 赞同：33
> 
>             
> 
> 时间：2009-03-16T15:35:46.173

如果您可以根据扩展名识别文件，则可以使用[web.config 中的 buildproviders 标记进行](http://msdn.microsoft.com/en-us/library/h0e51sw9.aspx)配置。添加扩展并将其映射到 ForceCopyBuildProvider。例如，要配置要使用发布操作复制的 .xml 文件，您可以执行以下操作：

```
<configuration>...
    <system.web>...
        <compilation>...
            <buildProviders>
                <remove extension=".xml" />
                <add extension=".xml" type="System.Web.Compilation.ForceCopyBuildProvider" />
            </buildProviders> 
```

为了防止给定文件被复制，您将执行相同的操作，但使用 System.Web.Compilation.IgnoreFileBuildProvider 作为类型。

* * *

## 回答 #4

> 赞同：11
> 
>             
> 
> 时间：2011-04-12T14:13:54.563

我在同样的问题上苦苦挣扎，最终触发了将网站转换为 Web 应用程序的操作。一旦我这样做了，我就获得了所有 IDE 的好处，例如构建操作，并且它编译速度更快（不再验证网站......）。

第 1 步：将您的“网站”转换为“网络应用程序”。为了转换它，我刚刚创建了一个新的“Web 应用程序”，删除了它自动创建的所有文件，然后复制并粘贴了我的网站。这很好。请注意，报告文件需要将其构建操作设置为“内容”而不是“无”。

第 2 步：现在您可以设置任何文件的“构建操作”属性。

希望这可以帮助。

* * *

## 回答 #5

> 赞同：8
> 
>             
> 
> 时间：2015-07-28T21:51:46.963

在 Visual Studio 2013 中，我找到了 Keith 的答案，将`ExcludeFoldersFromDeployment`元素添加到项目文件中，但没有奏效（我没有读过 Brian Ogden 的答案，其中提到了这一点）。但是，我发现我可以在 Visual Studio 2013 中发布时排除文本文件，只需在文本文件本身上设置以下属性：

1) 构建操作：无

2）复制到输出目录：不要复制

最初我尝试自行设置 Copy to Output Directory 属性，但是当 Build Action 设置为默认值 Content 时，这不起作用。然后，当我将 Build Action 设置为 None 时，文本文件在我发布时不再复制到目标文件夹。

要在 Visual Studio GUI 中查看这些属性，请在解决方案资源管理器中右键单击要排除的文件，然后从上下文菜单中选择属性。

* * *

## 回答 #6

> 赞同：5
> 
>             
> 
> 时间：2009-03-16T15:30:57.760

我认为您在这里只有两个选择：

*   使用“从项目中排除”功能。这并不理想，因为项目项将从任何集成的 IDE 源代码控制操作中排除。如果您需要在解决方案资源管理器中查看文件，则需要单击解决方案窗口上的“显示所有文件”按钮，但这也会显示您不感兴趣的文件和文件夹。

*   使用构建后事件脚本删除您不想发布的任何项目项（假设您要发布到本地文件夹然后上传到服务器）。

我以前经历过这个，无法想出任何真正优雅的东西。

* * *

## 回答 #7

> 赞同：3
> 
>             
> 
> 时间：2018-06-09T17:19:45.260

对于 Visual Studio 2017，**WebApp Publish**，首先创建一个标准文件系统发布配置文件。转到 App_Data\PublishProfiles\ 文件夹并编辑 [profilename].pubxml 文件。

添加

```
<ExcludeFilesFromDeployment>[file1.ext];[file2.ext];[file(n).ext]</ExcludeFilesFromDeployment> 
```

在标签下这个标签`<PropertyGroup>`
只能指定一次，否则只会取最后一个的值。

例子：

```
<Project ToolsVersion="4.0" xmlns="http://schemas.microsoft.com/developer/msbuild/2003">
  <PropertyGroup>
    <WebPublishMethod>FileSystem</WebPublishMethod>
    <LastUsedBuildConfiguration>Release</LastUsedBuildConfiguration>
    <LastUsedPlatform>Any CPU</LastUsedPlatform>
    <SiteUrlToLaunchAfterPublish />
    <LaunchSiteAfterPublish>True</LaunchSiteAfterPublish>
    <ExcludeApp_Data>True</ExcludeApp_Data>
    <publishUrl>C:\inetput\mysite</publishUrl>
    <DeleteExistingFiles>False</DeleteExistingFiles>
    <ExcludeFilesFromDeployment>web.config;mysite.sln;App_Code\DevClass.cs;</ExcludeFilesFromDeployment>
  </PropertyGroup>
</Project> 
```

确保标签 DeleteExistingFiles 设置为**False**

* * *

## 回答 #8

> 赞同：1
> 
>             
> 
> 时间：2009-03-16T15:28:45.440

如果您的项目被创建为“Web 应用程序”，则您正在寻找的功能存在。网站“项目”只是文件的集合，这些文件被认为是与部署到 Web 服务器的 1:1 的文件*。*

就功能而言，两者是相同的，但是 Web 应用程序将所有源代码编译为 DLL，而不是将裸源代码文件复制到 Web 服务器并根据需要进行编译。

* * *

## 回答 #9

> 赞同：1
> 
>             
> 
> 时间：2019-12-04T23:39:06.783

*这只是此处其他有用答案的附录，以及我发现有用的东西......*

**使用 wpp.targets 排除文件和文件夹**

当您针对不同环境进行多个部署时，最好只有一个通用文件，您可以在其中设置所有排除的文件和文件夹。您可以通过`*.wpp.targets`在项目的根目录中创建一个文件来执行此操作，如下例所示。

**有关详细信息，请参阅此 Microsoft 指南：**

[如何：在 Visual Studio Web 项目中编辑发布配置文件 (.pubxml) 文件和 .wpp.targets 文件中的部署设置](https://docs.microsoft.com/en-us/previous-versions/aspnet/ff398069(v=vs.110))

```
<?xml version="1.0" encoding="utf-8" ?>
<Project ToolsVersion="4.0" xmlns="http://schemas.microsoft.com/developer/msbuild/2003">
  <PropertyGroup>
    <EnableMSDeployAppOffline>True</EnableMSDeployAppOffline>
    <ExcludeFilesFromDeployment>
      *.config;
      *.targets;
      *.default;
    </ExcludeFilesFromDeployment>
    <ExcludeFoldersFromDeployment>
      images;
      videos;
      uploads;
    </ExcludeFoldersFromDeployment>
  </PropertyGroup>
</Project> 
```

* * *

## 回答 #10

> 赞同：0
> 
>             
> 
> 时间：2019-01-10T10:53:41.450

在 Visual Studio 2017（在我的情况下为 15.9.3）中，.csproj-File 的操作确实可以正常工作！无需修改 pubxml。

然后，您可以使用 PropertyGroup 条件在 .csproj-File 中构造非常好的设置，例如：

```
 <PropertyGroup Condition="$(Configuration.StartsWith('Pub_'))">
    <ExcludeFoldersFromDeployment>Samples</ExcludeFoldersFromDeployment>
  </PropertyGroup> 
```

从配置以“Pub_”开头的所有部署中排除“Samples”文件夹...

* * *

## 回答 #11

> 赞同：0
> 
>             
> 
> 时间：2019-01-28T15:28:54.240

作为当代答案，在带有 .net 核心站点的 Visual Studio 2017 中：

您可以像在 csproj 中那样从发布中排除，其中 CopyToPublishDirectory 永远不会。

```
 <ItemGroup>
    <Content Update="appsettings.json">
      <CopyToOutputDirectory>PreserveNewest</CopyToOutputDirectory>
      <CopyToPublishDirectory>PreserveNewest</CopyToPublishDirectory>
    </Content>
    <Content Update="appsettings.Local.json">
      <CopyToOutputDirectory>PreserveNewest</CopyToOutputDirectory>
      <CopyToPublishDirectory>Never</CopyToPublishDirectory>
    </Content>
  </ItemGroup> 
```

此处对此进行了更详细的讨论：[https ://docs.microsoft.com/en-us/aspnet/core/host-and-deploy/visual-studio-publish-profiles?view=aspnetcore-2.2](https://docs.microsoft.com/en-us/aspnet/core/host-and-deploy/visual-studio-publish-profiles?view=aspnetcore-2.2)

```
<PropertyGroup>
    <ExcludeFilesFromDeployment>appsettings.Local.json</ExcludeFilesFromDeployment>
</PropertyGroup> 
```

早期的建议对我不起作用，我猜是因为 Visual Studio 现在在下面使用不同的发布机制，我推测是通过“dotnet publish”cli 工具或下面的等效工具。

# python - Python，将 Popen 的流重定向到 python 函数

> ID：650877
> 
>         
> 
> 赞同：6
> 
>         
> 
> 时间：2009-03-16T15:19:11.830
> 
>         
> 
> 标签：python, stream, subprocess, yield, popen

我是 python 编程的新手。我有这个问题：我有一个文本文件列表（压缩和未压缩），我需要： - 连接到服务器并打开它们 - 打开文件后，我需要获取他的内容并将其传递给另一个我写的python函数

```
def readLogs (fileName):
f = open (fileName, 'r')
inStream = f.read()
counter = 0
inStream = re.split('\n', inStream) # Create a 'list of lines'
out = ""              # Will contain the output
logInConst = ""       # log In Construction
curLine = ""          # Line that I am working on

for nextLine in inStream:
    logInConst += curLine  
    curLine = nextLine
    #   check if it is a start of a new log && check if the previous log is 'ready'
    if newLogRegExp.match(curLine) and logInConst != "":

        counter = counter + 1

        out = logInConst
        logInConst = ""
        yield out

yield logInConst + curLine

def checkFile (regExp, fileName):
    generatore = readLogs(fileName)
    listOfMatches=[]

    for i in generatore: #I'm now cycling through the logs
        # regExp must be a COMPILE regular expression
        if regExp.search(i):
            listOfMatches.append(i)
    return listOfMatches 
```

为了详细说明这些文件中包含的信息。该函数的目的是使用 3 行仅在 1 行中写入存储在这些文件中的日志......该函数在从我的本地计算机读取的文件上运行良好，但我无法弄清楚如何连接到远程服务器和创建这些单行日志而不将每个文件的内容存储到一个字符串中，然后使用该字符串......我用来连接到远程机器的命令是：

```
connection_out = Popen(['ssh', retList[0], 'cd '+retList[2]+'; cat'+fileName], stdout=PIPE).communicate()[0] 
```

retList[0] 和 retList[2] 是 user@remote 和我必须访问的文件夹名称

提前感谢大家！

**更新：**

我的问题是我必须先建立一个 ssh 连接：

```
pr1=Popen(['ssh', 'siatc@lgssp101', '*~/XYZ/AAAAA/log_archive/00/MSG_090308_162648.gz*' ], stdout=PIPE).communicate()[0] 
```

我需要打开的所有文件都存储在一个列表中，fileList[]，其中一部分是压缩的（.gz），一部分只是文本文件！我已经尝试了你在 bot 之前展示的所有程序，但没有任何效果......我想我必须修改 Popen 函数的第三个参数，但我不知道该怎么做！有没有人可以帮助我？？？

* * *

## 回答 #1

> 赞同：5
> 
>             
> 
> 时间：2009-03-16T15:48:11.587

您不必自己将流/文件拆分为行。只需迭代：

```
for ln in f:
    # work on line in ln 
```

这对于文件（使用 open() 处理 file()）和管道（使用 Popen）同样适用。使用`stdout`popen对象的属性访问连接到子进程stdout的管道

**例子**

```
from subprocess import Popen, PIPE
pp = Popen('dir', shell=True, stdout=PIPE)

for ln in pp.stdout:
    print '#',ln 
```

* * *

## 回答 #2

> 赞同：1
> 
>             
> 
> 时间：2009-03-16T16:45:49.843

删除 InStream 并仅使用文件对象。

这样您的代码将显示为：

```
for nextLine in f.readlines():
    .
    .
    . 
```

贝尔说得对。  

澄清一下，文件对象的默认迭代行为是返回下一行。所以“ **for nextLine in f** ”会给你与“ **for nextLine in f.readlines()** ”相同的结果。

有关详细信息，请参阅文件对象文档：http: [//docs.python.org/library/stdtypes.html#bltin-file-objects](http://docs.python.org/library/stdtypes.html#bltin-file-objects)

* * *

## 回答 #3

> 赞同：0
> 
>             
> 
> 时间：2009-04-28T10:11:44.473

如果你想通过 ssh 做一些事情，为什么不使用[Python SSH 模块](http://pyssh.sourceforge.net/)呢？

* * *

## 回答 #4

> 赞同：0
> 
>             
> 
> 时间：2011-10-03T17:20:53.863

试试这个页面，到目前为止我找到的关于 popen 的最佳信息....

[http://jimmyg.org/blog/2009/working-with-python-subprocess.html](http://jimmyg.org/blog/2009/working-with-python-subprocess.html)

# java - 在虚拟机中开发 Java 有什么好处吗？

> ID：650881
> 
>         
> 
> 赞同：3
> 
>         
> 
> 时间：2009-03-16T15:20:53.900
> 
>         
> 
> 标签：java, virtualization

我来自 .Net 阵营，在该阵营中，虚拟化对于在服务器软件和系统范围的实体（如 GAC）上运行的需求更为普遍。

现在我在做 Java 开发，继续使用虚拟化有意义吗？我们使用的是 VirtualPC，IMO 并不是最好的产品。如果我们要继续前进，我们希望能够使用 VMWare。

我们正在做 Web 开发，不会使用虚拟化来测试不同风格的服务器部署。

优点：

*   允许整个团队的开发环境相同

*   允许与主机隔离

*   跨平台/浏览器测试

缺点：

*   缺少多显示器支持（不在 VMWare 中？）

*   性能下降 - 主要是 I/O

*   巨大的虚拟磁盘

* * *

## 回答 #1

> 赞同：6
> 
>             
> 
> 时间：2009-03-16T15:24:09.337

一个可能的优势是您可以在各种操作系统和各种 JVM 上从技术上测试相同的程序。

与流行的观点相反，Java 不是 100% 可移植的，而且很可能编写不可移植的代码。此外，库之间还有微妙的版本。如果您使用不同的 JVM，也可能存在差异。

但是，由于 Java IDE 是重量级的，在 VM 中运行 IDE 可能并不有趣。

Java 确实支持某些形式的远程部署，可能有助于探索这些形式，同时仍在本地进行 IDE 工作。

* * *

## 回答 #2

> 赞同：2
> 
>             
> 
> 时间：2009-03-16T15:31:36.620

我不喜欢在虚拟机中开发。好消息是，与您所写的缺点相比，VMWare 支持多个监视器，并且由于 VMWare 从 USB 硬盘上运行起来非常流畅，因此巨大的磁盘并不是真正的问题。

正如 Uri 所说，在 VM 中运行重量级的 Java IDE 不会很有趣。但是，在 VM 中运行 Visual Studio 也不是很有趣。因此，如果您对虚拟机中的 VS 感到满意，那么请尝试使用 Java，因为它的缺点并没有您想象的那么强大：)

* * *

## 回答 #3

> 赞同：1
> 
>             
> 
> 时间：2009-03-16T15:35:57.873

你说你在做java web开发，所以在不同的操作系统上使用不同的web浏览器测试你的应用程序是有意义的。VMware 将对此很有用。

[Netbeans](http://www.netbeans.org) IDE 独立于操作系统，因此您可以让开发人员在不同的操作系统上工作而不会遇到任何麻烦。

* * *

## 回答 #4

> 赞同：1
> 
>             
> 
> 时间：2009-03-16T15:48:00.607

我在 VirtualBox 实例中运行 eclipse，它工作正常。我过去使用过 VMWare，这也很好。

我喜欢将我的开发环境与我的 PC 其他部分（玩游戏、上网、阅读电子邮件等）分开

我在家工作，因此虚拟化提供了必要的工作/娱乐分离。它还允许我分别升级每个环境并对环境进行更多控制。

如果安装“不稳定”，我也可以安全地尝试新的东西并恢复。对不起，技术性很强的术语。;-)

编辑：它还允许我满足公司 VPN 访问要求，而不会使我的家庭环境受到过度的公司影响。

* * *

## 回答 #5

> 赞同：1
> 
>             
> 
> 时间：2009-03-16T16:00:35.910

如果您需要一个虚拟机来验证应用程序是否也可以在不同的操作系统上运行，您可以通过使用持续集成服务器并在该机器（即 Linux / Windows / OSX）上启动/运行虚拟机实例来覆盖相当多的基础。然后解压最新的构建，在交付的类上运行单元测试。然后运行自动化集成测试。然后，您必须将结果报告回 CI 环境。如果集成测试很好，这可以在提交到 SCM 后立即捕获许多常见的多平台错误。

# java - C3p0 中的锁排序

> ID：650882
> 
>         
> 
> 赞同：5
> 
>         
> 
> 时间：2009-03-16T15:21:17.970
> 
>         
> 
> 标签：java, multithreading, deadlock, connection-pooling, c3p0

我正在尝试使用 c3p0's 在我们的应用程序中记录数据库连接的创建和销毁`ConnectionCustomizer`。在其中，我有一些看起来像这样的代码：

```
log(C3P0Registry.getPooledDataSources()) 
```

我遇到了僵局。我发现 c3p0 在其库中至少有几个使用同步方法的对象，并且似乎没有指定它们预期的锁定顺序。当我记录连接时，我会锁定`C3P0Registry`并最终`PoolBackedDataSource`（只需创建数据源列表即可访问导致锁定的哈希码）。

关闭连接提供程序（调用`C3P0ConnectionProvider.close()`）会导致以相反的顺序调用锁。但是，当子数据源被关闭时，我的日志记录被触发了。结果是死锁。

似乎我对 c3p0 库进行的两个调用都是有效的预期调用：

*   `C3P0ConnectionProvider.close()`

*   `C3P0Registry.getPooledDataSources()`

似乎（除非在文档中明确说明）管理它自己的锁定策略应该是库的责任。（我说这不是为了责怪任何人.. 只是为了确认我对最佳实践的理解）

我应该如何处理这个问题？由于 c3p0 使用同步方法而不是更现代的机制，因此我无法真正测试锁。

从我的`DataSource`关闭代码中，我可以`C3P0Registry`在关闭`DataSource`. 我会猜测正确的锁定顺序，我不知道我是否觉得舒服。

我不认为我可以反转日志调用的锁定顺序。我需要`C3P0Registry`来获取 的列表`DataSources`，所以如果`DataSources`没有先锁定`C3P0Registry`来获取对它们的引用，我就无法锁定 。

当然，另一种解决方案是在 c3p0 之上提供另一个更高级别的锁。在连接池的情况下，这似乎违背了这一点。

现在，我正在回滚我的日志记录。谢谢你的帮助。

* * *

## 回答 #1

> 赞同：0
> 
>             
> 
> 时间：2011-02-05T06:11:14.867

我不知道如何解决锁定问题，但我认为你应该退后一步，想想原来的问题。“我正在尝试在我们的应用程序中记录数据库连接的创建和破坏......”

我会推荐以下。

创建一个类并使其实现 javax.sql.DataSource。创建一个相同类型的字段并将所有方法委托给它。在 getConnection() 方法中，返回您自己的 Connection 类，包裹 java.sql.Connection 等等。然后将此类包装在您的原始数据源周围。在您的课程中，您现在可以简单地创建一个记录器并记录您希望在日志中看到的所有操作。

# wix - Wix 安装程序和禁用的功能

> ID：650884
> 
>         
> 
> 赞同：4
> 
>         
> 
> 时间：2009-03-16T15:21:47.860
> 
>         
> 
> 标签：wix, windows-installer, wix3

我正在使用带有功能树 UI 的 Wix3 测试版。我将几个程序集作为单独的组件安装到 ProgramFiles 内的自定义子目录以及 GAC 中。此外，我想将相同程序集的调试版本打包为一个组件，并让用户决定是否安装它们。现在这个带有调试程序集的功能默认是禁用的，但无论如何都会安装调试程序集。

在相关片段下方：

```
<DirectoryRef Id="INSTALLDIR">
  <Directory Id="bin" Name="bin">
    <Directory Id="Debug" Name="Debug">
      <Component Id="DebugComponent" Guid="PUT-GUID-HERE">
        <File Id="DebugAssemblyXXX" DiskId="1" Source="Debug\XXX.dll"></File>
      </Component>
    </Directory>
    <Directory Id="Release" Name="Release">
      <Component Id="ReleaseComponent" Guid="PUT-GUID-HERE">
        <File Id="ReleaseAssemblyXXX" DiskId="1" Source="Release\XXX.dll"></File>
      </Component>
    </Directory>
  </Directory>
</DirectoryRef>

<Feature Id="All" ConfigurableDirectory="INSTALLDIR" Title="Title" Level="1"
         Display="expand" AllowAdvertise="no" Absent="disallow" Description="Desc">

  <Feature Id="DebugAssemblies" Title="Debug Assemblies" Level="1000" Absent="allow"
           AllowAdvertise="no" Description="Debug versions of assemblies.">
    <ComponentRef Id="DebugComponent" />
  </Feature>

  <Feature Id="ReleaseFeature1" Title="Feature" Level="3"
           AllowAdvertise="no" Description="Another description">
    <ComponentRef Id="ReleaseComponent"/>
  </Feature>
</Feature> 
```

奇怪的是，如果我再次运行 msi 文件并转到“更改”并禁用调试功能，调试程序集将被删除，例如这次逻辑工作正常。

默认 INSTALLLEVEL 为 3。

有什么建议么？

* * *

## 回答 #1

> 赞同：7
> 
>             
> 
> 时间：2009-03-17T09:17:14.577

万一其他人对此感到困惑：显然顶级功能不应该像我的情况那样命名为“全部” - 它可能对 Wix/Windows Installer 有一些默认含义。将其重命名为其他名称后，一切都按预期工作。

# c++ - 有没有办法防止工具栏的隐藏操作？

> ID：650889
> 
>         
> 
> 赞同：23
> 
>         
> 
> 时间：2009-03-16T15:23:22.507
> 
>         
> 
> 标签：c++, qt, qtoolbar

在 Qt 中，如果我右键单击工具栏，将显示允许我隐藏工具栏的菜单。我需要禁用此功能，因为我不希望工具栏可能隐藏。有没有办法做到这一点？

* * *

## 回答 #1

> 赞同：34
> 
>             
> 
> 时间：2012-01-26T08:05:06.303

只要我使用或，我就可以直接在*工具栏*（而不是主窗口）上设置 ContextMenuPolicy 。消除了上下文菜单并使右键单击对工具栏没有影响，同时制作了一个很好的上下文菜单，由我工具栏中已有的操作组成。似乎没有任何效果。`Qt::PreventContextMenu``Qt::ActionsContextMenu``Prevent``Actions``Qt::NoContextMenu`

`toolbar->setContextMenuPolicy(Qt::PreventContextMenu);`

* * *

## 回答 #2

> 赞同：17
> 
>             
> 
> 时间：2009-03-16T17:22:15.590

使用[setContextMenuPolicy (Qt::NoContextMenu)](http://doc.trolltech.com/4.5/qwidget.html#contextMenuPolicy-prop)作为工具栏的主窗口。

* * *

## 回答 #3

> 赞同：11
> 
>             
> 
> 时间：2016-05-24T20:59:01.507

覆盖 QMainWindow::createPopupMenu() 例如

```
QMenu* MyApp::createPopupMenu()
{
  QMenu* filteredMenu = QMainWindow::createPopupMenu();
  filteredMenu->removeAction( mUnhidableToolBar->toggleViewAction() );
  return filteredMenu;
} 
```

请注意，建议禁用上下文菜单的其他答案仅在您要禁用*所有*工具栏和*所有*停靠小部件的隐藏/显示时才有效。  

* * *

## 回答 #4

> 赞同：11
> 
>             
> 
> 时间：2016-10-05T11:10:13.427

有几种方法可以实现这一点，而无需更改 contextMenu 功能。请参阅以下 3 个 PySide 示例：

**`toggleViewAction``QToolBar`**1.**禁用****:**

```
UnhidableToolBar = QToolBar()
UnhidableToolBar.toggleViewAction().setEnabled(False) 
```

**2.连接`visibilityChanged`信号**：

```
toolbar.visibilityChanged.connect(lambda: toolbar.setVisible(True)) 
```

**3.子类`QToolBar`化并使用`hideEvent`**：

```
class UnhideableQToolBar(QToolBar):
    def hideEvent(self, event):
        self.setVisibile(True) 
```

# 推荐：

虽然 2 和 3 很脏，但解决方案 1 在上下文菜单中显示了工具栏，就像`QDockWidget`具有功能`DockWidgetClosable`集的工具栏一样。因此，要么使用解决方案 1，要么如果您想删除该操作，请查看 Steven 的回答。

* * *

## 回答 #5

> 赞同：3
> 
>             
> 
> 时间：2009-03-16T15:28:34.037

继承 QToolbar 并重新实现`contextMenuEvent()`.

# java - 更改参数化测试的名称

> ID：650894
> 
>         
> 
> 赞同：216
> 
>         
> 
> 时间：2009-03-16T15:25:21.987
> 
>         
> 
> 标签：java, junit, junit4, parameterized

在 JUnit4 中使用参数化测试时，有没有办法设置我自己的自定义测试用例名称？

我想将默认值更改为`[Test class].runTest[n]`有意义的东西。

* * *

## 回答 #1

> 赞同：320
> 
>             
> 
> 时间：2012-04-13T15:34:58.697

**此功能已进入[JUnit 4.11](https://github.com/junit-team/junit/wiki/Download-and-Install)。**

要使用更改参数化测试的名称，您可以说：

```
@Parameters(name="namestring") 
```

*`namestring`*是一个字符串，它可以有以下特殊的占位符：

*   `{index}`- 这组参数的索引。默认*`namestring`*值为`{index}`.

*   `{0}`- 来自此测试调用的第一个参数值。

*   `{1}`- 第二个参数值

*   等等

测试的最终名称将是测试方法的名称，后跟*`namestring`*括号中，如下所示。

例如（改编自`Parameterized`注解的单元测试）：

```
@RunWith(Parameterized.class)
static public class FibonacciTest {

    @Parameters( name = "{index}: fib({0})={1}" )
    public static Iterable<Object[]> data() {
        return Arrays.asList(new Object[][] { { 0, 0 }, { 1, 1 }, { 2, 1 },
                { 3, 2 }, { 4, 3 }, { 5, 5 }, { 6, 8 } });
    }

    private final int fInput;
    private final int fExpected;

    public FibonacciTest(int input, int expected) {
        fInput= input;
        fExpected= expected;
    }

    @Test
    public void testFib() {
        assertEquals(fExpected, fib(fInput));
    }

    private int fib(int x) {
        // TODO: actually calculate Fibonacci numbers
        return 0;
    }
} 
```

将给出类似`testFib[1: fib(1)=1]`and的名称`testFib[4: fib(4)=3]`。（名称的`testFib`一部分是 的方法名称`@Test`）。

* * *

## 回答 #2

> 赞同：38
> 
>             
> 
> 时间：2009-03-16T15:49:14.363

查看 JUnit 4.5，它的运行器显然不支持这一点，因为该逻辑隐藏在 Parameterized 类中的私有类中。您不能使用 JUnit Parameterized 运行程序，而是创建自己的运行程序来理解名称的概念（这导致了如何设置名称的问题......）。

从 JUnit 的角度来看，如果不是（或除了）仅传递一个增量，而是传递逗号分隔的参数，那就太好了。TestNG 就是这样做的。如果该功能对您很重要，您可以在 www.junit.org 上引用的 yahoo 邮件列表中发表评论。

* * *

## 回答 #3

> 赞同：19
> 
>             
> 
> 时间：2010-01-12T20:42:19.960

我最近在使用 JUnit 4.3.1 时遇到了同样的问题。我实现了一个扩展名为 LabelledParameterized 的 Parameterized 的新类。它已经使用 JUnit 4.3.1、4.4 和 4.5 进行了测试。它使用来自@Parameters 方法的每个参数数组的第一个参数的字符串表示来重构Description 实例。您可以在以下位置查看代码：

[http://code.google.com/p/migen/source/browse/trunk/java/src/.../LabelledParameterized.java?r=3789](http://code.google.com/p/migen/source/browse/trunk/java/src/uk/ac/lkl/common/util/testing/LabelledParameterized.java?r=3789)

及其使用示例：

[http://code.google.com/p/migen/source/browse/trunk/java/src/.../ServerBuilderTest.java?r=3789](http://code.google.com/p/migen/source/browse/trunk/java/src/uk/ac/lkl/common/util/restlet/test/builder/ServerBuilderTest.java?r=3789)

测试描述在 Eclipse 中的格式很好，这正是我想要的，因为这使得失败的测试更容易找到！在接下来的几天/几周内，我可能会进一步完善和记录这些课程。删除“？” 如果您想要最前沿的部分 URL。:-)

要使用它，您所要做的就是复制该类（GPL v3），并将 @RunWith(Parameterized.class) 更改为 @RunWith(LabelledParameterized.class) 假设参数列表的第一个元素是合理的标签。

我不知道 JUnit 的任何后续版本是否解决了这个问题，但即使他们解决了，我也无法更新 JUnit，因为我所有的共同开发人员也必须更新，而且我们的优先级高于重新工具。因此，类中的工作可由多个版本的 JUnit 编译。

* * *

**注意：**有一些反射 jiggery-pokery 以便它在上面列出的不同 JUnit 版本中运行。[可以在此处](http://code.google.com/p/migen/source/browse/trunk/java/src/uk/ac/lkl/common/util/testing/LabelledParameterized.java?r=3775)找到专门针对 JUnit 4.3.1 的版本，对于 JUnit 4.4 和 4.5，可以[在此处找到](http://code.google.com/p/migen/source/browse/trunk/java/src/uk/ac/lkl/common/util/testing/NewLabelledParameterized.java?r=3777)。

* * *

## 回答 #4

> 赞同：13
> 
>             
> 
> 时间：2010-08-04T09:35:17.430

作为`Parameterized`一个模型，我编写了我自己的自定义测试运行程序/套件——只花了大约半个小时。它与 darrenp 略有不同`LabelledParameterized`，它允许您显式指定名称，而不是依赖第一个参数的`toString()`.

它也不使用数组，因为我讨厌数组。:)

```
public class PolySuite extends Suite {

  // //////////////////////////////
  // Public helper interfaces

  /**
   * Annotation for a method which returns a {@link Configuration}
   * to be injected into the test class constructor
   */
  @Retention(RetentionPolicy.RUNTIME)
  @Target(ElementType.METHOD)
  public static @interface Config {
  }

  public static interface Configuration {
    int size();
    Object getTestValue(int index);
    String getTestName(int index);
  }

  // //////////////////////////////
  // Fields

  private final List<Runner> runners;

  // //////////////////////////////
  // Constructor

  /**
   * Only called reflectively. Do not use programmatically.
   * @param c the test class
   * @throws Throwable if something bad happens
   */
  public PolySuite(Class<?> c) throws Throwable {
    super(c, Collections.<Runner>emptyList());
    TestClass testClass = getTestClass();
    Class<?> jTestClass = testClass.getJavaClass();
    Configuration configuration = getConfiguration(testClass);
    List<Runner> runners = new ArrayList<Runner>();
    for (int i = 0, size = configuration.size(); i < size; i++) {
      SingleRunner runner = new SingleRunner(jTestClass, configuration.getTestValue(i), configuration.getTestName(i));
      runners.add(runner);
    }
    this.runners = runners;
  }

  // //////////////////////////////
  // Overrides

  @Override
  protected List<Runner> getChildren() {
    return runners;
  }

  // //////////////////////////////
  // Private

  private Configuration getConfiguration(TestClass testClass) throws Throwable {
    return (Configuration) getConfigMethod(testClass).invokeExplosively(null);
  }

  private FrameworkMethod getConfigMethod(TestClass testClass) {
    List<FrameworkMethod> methods = testClass.getAnnotatedMethods(Config.class);
    if (methods.isEmpty()) {
      throw new IllegalStateException("@" + Config.class.getSimpleName() + " method not found");
    }
    if (methods.size() > 1) {
      throw new IllegalStateException("Too many @" + Config.class.getSimpleName() + " methods");
    }
    FrameworkMethod method = methods.get(0);
    int modifiers = method.getMethod().getModifiers();
    if (!(Modifier.isStatic(modifiers) && Modifier.isPublic(modifiers))) {
      throw new IllegalStateException("@" + Config.class.getSimpleName() + " method \"" + method.getName() + "\" must be public static");
    }
    return method;
  }

  // //////////////////////////////
  // Helper classes

  private static class SingleRunner extends BlockJUnit4ClassRunner {

    private final Object testVal;
    private final String testName;

    SingleRunner(Class<?> testClass, Object testVal, String testName) throws InitializationError {
      super(testClass);
      this.testVal = testVal;
      this.testName = testName;
    }

    @Override
    protected Object createTest() throws Exception {
      return getTestClass().getOnlyConstructor().newInstance(testVal);
    }

    @Override
    protected String getName() {
      return testName;
    }

    @Override
    protected String testName(FrameworkMethod method) {
      return testName + ": " + method.getName();
    }

    @Override
    protected void validateConstructor(List<Throwable> errors) {
      validateOnlyOneConstructor(errors);
    }

    @Override
    protected Statement classBlock(RunNotifier notifier) {
      return childrenInvoker(notifier);
    }
  }
} 
```

还有一个例子：

```
@RunWith(PolySuite.class)
public class PolySuiteExample {

  // //////////////////////////////
  // Fixture

  @Config
  public static Configuration getConfig() {
    return new Configuration() {
      @Override
      public int size() {
        return 10;
      }

      @Override
      public Integer getTestValue(int index) {
        return index * 2;
      }

      @Override
      public String getTestName(int index) {
        return "test" + index;
      }
    };
  }

  // //////////////////////////////
  // Fields

  private final int testVal;

  // //////////////////////////////
  // Constructor

  public PolySuiteExample(int testVal) {
    this.testVal = testVal;
  }

  // //////////////////////////////
  // Test

  @Ignore
  @Test
  public void odd() {
    assertFalse(testVal % 2 == 0);
  }

  @Test
  public void even() {
    assertTrue(testVal % 2 == 0);
  }

} 
```

* * *

## 回答 #5

> 赞同：7
> 
>             
> 
> 时间：2011-06-08T14:30:53.800

您可能还想尝试 JUnitParams：[http ://code.google.com/p/junitparams/](http://code.google.com/p/junitparams/)

* * *

## 回答 #6

> 赞同：6
> 
>             
> 
> 时间：2011-01-04T21:34:06.800

从 junit4.8.2 开始，您可以通过简单地复制 Parameterized 类来创建自己的 MyParameterized 类。更改 TestClassRunnerForParameters 中的 getName() 和 testName() 方法。

* * *

## 回答 #7

> 赞同：2
> 
>             
> 
> 时间：2009-08-10T20:23:50.170

您可以创建一个方法，如

```
@Test
public void name() {
    Assert.assertEquals("", inboundFileName);
} 
```

虽然我不会一直使用它，但准确确定 143 是哪个测试编号会很有用。

* * *

## 回答 #8

> 赞同：2
> 
>             
> 
> 时间：2010-01-14T17:19:14.807

我为 Assert 和朋友广泛使用静态导入，因此我很容易重新定义断言：

```
private <T> void assertThat(final T actual, final Matcher<T> expected) {
    Assert.assertThat(editThisToDisplaySomethingForYourDatum, actual, expected);
} 
```

例如，您可以在测试类中添加一个“名称”字段，在构造函数中初始化，并在测试失败时显示该字段。只需将其作为每个测试的参数数组的第一个元素传递。这也有助于标记数据：

```
public ExampleTest(final String testLabel, final int one, final int two) {
    this.testLabel = testLabel;
    // ...
}

@Parameters
public static Collection<Object[]> data() {
    return asList(new Object[][]{
        {"first test", 3, 4},
        {"second test", 5, 6}
    });
} 
```

* * *

## 回答 #9

> 赞同：2
> 
>             
> 
> 时间：2011-05-24T17:11:09.267

没有一个对我有用，所以我获得了 Parameterized 的源代码并对其进行了修改，创建了一个新的测试运行器。我不必改变太多，但它工作！

```
import java.lang.annotation.ElementType;
import java.lang.annotation.Retention;
import java.lang.annotation.RetentionPolicy;
import java.lang.annotation.Target;
import java.lang.reflect.Constructor;
import java.lang.reflect.InvocationTargetException;
import java.lang.reflect.Method;
import java.lang.reflect.Modifier;
import java.util.ArrayList;
import java.util.Arrays;
import java.util.Collection;
import java.util.List;
import org.junit.Assert;
import org.junit.internal.runners.ClassRoadie;
import org.junit.internal.runners.CompositeRunner;
import org.junit.internal.runners.InitializationError;
import org.junit.internal.runners.JUnit4ClassRunner;
import org.junit.internal.runners.MethodValidator;
import org.junit.internal.runners.TestClass;
import org.junit.runner.notification.RunNotifier;

public class LabelledParameterized extends CompositeRunner {
static class TestClassRunnerForParameters extends JUnit4ClassRunner {
    private final Object[] fParameters;

    private final String fParameterFirstValue;

    private final Constructor<?> fConstructor;

    TestClassRunnerForParameters(TestClass testClass, Object[] parameters, int i) throws InitializationError {
        super(testClass.getJavaClass()); // todo
        fParameters = parameters;
        if (parameters != null) {
            fParameterFirstValue = Arrays.asList(parameters).toString();
        } else {
            fParameterFirstValue = String.valueOf(i);
        }
        fConstructor = getOnlyConstructor();
    }

    @Override
    protected Object createTest() throws Exception {
        return fConstructor.newInstance(fParameters);
    }

    @Override
    protected String getName() {
        return String.format("%s", fParameterFirstValue);
    }

    @Override
    protected String testName(final Method method) {
        return String.format("%s%s", method.getName(), fParameterFirstValue);
    }

    private Constructor<?> getOnlyConstructor() {
        Constructor<?>[] constructors = getTestClass().getJavaClass().getConstructors();
        Assert.assertEquals(1, constructors.length);
        return constructors[0];
    }

    @Override
    protected void validate() throws InitializationError {
        // do nothing: validated before.
    }

    @Override
    public void run(RunNotifier notifier) {
        runMethods(notifier);
    }
}

@Retention(RetentionPolicy.RUNTIME)
@Target(ElementType.METHOD)
public static @interface Parameters {
}

private final TestClass fTestClass;

public LabelledParameterized(Class<?> klass) throws Exception {
    super(klass.getName());
    fTestClass = new TestClass(klass);

    MethodValidator methodValidator = new MethodValidator(fTestClass);
    methodValidator.validateStaticMethods();
    methodValidator.validateInstanceMethods();
    methodValidator.assertValid();

    int i = 0;
    for (final Object each : getParametersList()) {
        if (each instanceof Object[])
            add(new TestClassRunnerForParameters(fTestClass, (Object[]) each, i++));
        else
            throw new Exception(String.format("%s.%s() must return a Collection of arrays.", fTestClass.getName(), getParametersMethod().getName()));
    }
}

@Override
public void run(final RunNotifier notifier) {
    new ClassRoadie(notifier, fTestClass, getDescription(), new Runnable() {
        public void run() {
            runChildren(notifier);
        }
    }).runProtected();
}

private Collection<?> getParametersList() throws IllegalAccessException, InvocationTargetException, Exception {
    return (Collection<?>) getParametersMethod().invoke(null);
}

private Method getParametersMethod() throws Exception {
    List<Method> methods = fTestClass.getAnnotatedMethods(Parameters.class);
    for (Method each : methods) {
        int modifiers = each.getModifiers();
        if (Modifier.isStatic(modifiers) && Modifier.isPublic(modifiers))
            return each;
    }

    throw new Exception("No public static parameters method on class " + getName());
}

public static Collection<Object[]> eachOne(Object... params) {
    List<Object[]> results = new ArrayList<Object[]>();
    for (Object param : params)
        results.add(new Object[] { param });
    return results;
}
} 
```

* * *

## 回答 #10

> 赞同：2
> 
>             
> 
> 时间：2013-06-05T17:09:57.873

一种解决方法是将所有 Throwable 捕获并嵌套到一个新的 Throwable 中，其中包含有关参数的所有信息的自定义消息。该消息将出现在堆栈跟踪中。
**这适用于所有断言、错误和异常的测试失败，因为它们都是 Throwable 的子类。**

我的代码如下所示：

```
@RunWith(Parameterized.class)
public class ParameterizedTest {

    int parameter;

    public ParameterizedTest(int parameter) {
        super();
        this.parameter = parameter;
    }

    @Parameters
    public static Collection<Object[]> data() {
        return Arrays.asList(new Object[][] { {1}, {2} });
    }

    @Test
    public void test() throws Throwable {
        try {
            assertTrue(parameter%2==0);
        }
        catch(Throwable thrown) {
            throw new Throwable("parameter="+parameter, thrown);
        }
    }

} 
```

失败测试的堆栈跟踪是：

```
java.lang.Throwable: parameter=1
    at sample.ParameterizedTest.test(ParameterizedTest.java:34)
Caused by: java.lang.AssertionError
    at org.junit.Assert.fail(Assert.java:92)
    at org.junit.Assert.assertTrue(Assert.java:43)
    at org.junit.Assert.assertTrue(Assert.java:54)
    at sample.ParameterizedTest.test(ParameterizedTest.java:31)
    ... 31 more 
```

* * *

## 回答 #11

> 赞同：0
> 
>             
> 
> 时间：2012-03-27T16:19:44.817

查看 dsaff 提到的 JUnitParams，使用 ant 在 html 报告中构建参数化测试方法描述。

这是在尝试 LabelledParameterized 并发现它虽然可以与 eclipse 一起使用但就 html 报告而言不适用于 ant 之后。

干杯，

* * *

## 回答 #12

> 赞同：0
> 
>             
> 
> 时间：2017-06-06T17:00:04.053

由于访问的参数（例如`"{0}"`总是返回`toString()`表示，一种解决方法是进行匿名实现并`toString()`在每种情况下覆盖。例如：

```
public static Iterable<? extends Object> data() {
    return Arrays.asList(
        new MyObject(myParams...) {public String toString(){return "my custom test name";}},
        new MyObject(myParams...) {public String toString(){return "my other custom test name";}},
        //etc...
    );
} 
```

* * *

## 回答 #13

> 赞同：0
> 
>             
> 
> 时间：2021-04-09T15:09:47.410

参数化测试在内部调用`toString()`。如果您创建一个对象包装器覆盖`toString()`，它将更改测试的名称。

这是一个例子，我在其他帖子中回答过。
[https://stackoverflow.com/a/67023556/1839360](https://stackoverflow.com/a/67023556/1839360)

# database - 什么是比较数据库市场份额的好信息来源

> ID：650896
> 
>         
> 
> 赞同：2
> 
>         
> 
> 时间：2009-03-16T15:26:38.503
> 
>         
> 
> 标签：database

我很想知道主要数据库在受欢迎程度方面的比较。甲骨文有多少市场？MS SQL 有多少？MySQL，PostGre，...？在较小的市场（例如小型 Web 应用程序、大型 Web 应用程序、大型企业服务......）中，这种细分如何？

我在这里寻找统计数据。不是印象。

注意：我想说基于给定数据库的应用程序/项目的数量将是流行度的衡量标准。

* * *

## 回答 #1

> 赞同：1
> 
>             
> 
> 时间：2009-03-17T03:44:50.837

哈维尔给了你一个和我在精神上没有什么不同的答案——一组问题。但这里的问题略有不同：

*   分发了多少份？

*   收到多少钱？

*   管理的数据量？

*   非复制数据量？

第一个措施可能有利于开源产品；第二个有利于更昂贵的；第三个有利于大型机；第四个惩罚谷歌。这两组问题的组合会给你足够的怀疑来阅读各种文件，这些文件会让你对这些数字有所了解。

Gartner 曾经是此类信息的来源；其他类似的分析公司可能也可以提供帮助。我不确定[VLDB](http://www.vldb.org/)网站是否有很大帮助。谷歌“dbms 市场份额”来自 Gartner——我用它来确认我的回忆。

* * *

## 回答 #2

> 赞同：1
> 
>             
> 
> 时间：2009-11-26T19:13:33.213

在 Oracle 网站上，它们排名第一。

[来源](http://www.oracle.com/database/number-one-database.html)

Gartner 2008 年全球 RDBMS 市场份额报告甲骨文 (*) 份额为 48.9%

Gartner 根据软件总收入公布了 2008 年按操作系统划分的市场份额数据。据 Gartner 称，甲骨文

继续以 48.9% 的份额保持整体排名第一 继续占据比其最接近的六个竞争对手的总和更多的市场份额 在 Linux 上继续以 75.8% 的份额排名第一

(*) 资料来源：市场份额：2008 年全球按操作系统划分的关系数据库管理系统软件 - Colleen Graham、Bhavish Sood、Horiuchi Hideaki、Dan Sommer - 2009 年 6 月 12 日

三大 DBMS 供应商保持不变：Oracle 紧随其后的是 IBM，其次是 Microsoft。在三巨头之后，第四是 Sybase，市场份额为 3.5%，第五是 Teradata，市场份额为 3.3%。

* * *

## 回答 #3

> 赞同：1
> 
>             
> 
> 时间：2011-01-14T16:36:04.333

总而言之：一个“难以回答的问题”。Gartner 清楚地衡量了收入，它按价格倾斜并最大限度地减少了开源的使用。另一方面，其他 DBMS 可以要求较高的使用份额，因为它们嵌入在应用程序中（如 iPhone 中的 SQLite、Cisco 路由器中的 Postgre、Sharepoint 中的 MS SQL Server 等）。所以它可能取决于细分市场：例如，SQLite 可能永远不会成为数据仓库的大玩家！

* * *

## 回答 #4

> 赞同：0
> 
>             
> 
> 时间：2009-03-16T15:35:07.500

我没有任何消息来源，但我想你问的任何人都会对“流行”的不同定义有不同的答案，例如：

*   针对此数据库开发的开发人员数量

*   使用此数据库的数据库管理员数量

*   运行此数据库的商店数量

*   使用此数据库的服务器数量

*   在此数据库之上运行的应用程序数量

*   此数据库上管理的记录数

*   此数据库上的应用程序服务的用户数

在我完全不知情的情况下，我猜第一个定义偏爱 SQLite 或 MySQL，而最后几个定义偏爱 Oracle

# java - 为什么这两个内容相同的jar文件的文件大小不同？

> ID：650897
> 
>         
> 
> 赞同：5
> 
>         
> 
> 时间：2009-03-16T15:27:23.557
> 
>         
> 
> 标签：java, jar

我正在重新组织我们的 java 代码库，并想比较我们生成的 jar 文件。

当我在旧的源代码树中构建时，我得到一个大小为 3360081 的 jar 文件。

在新的源代码树中，它是 3360128。

我做了一个“jar tvf jarfile”，然后从文件中删除日期。

清单如下所示：

```
 0 Mon Mar 16 10:41:16 EDT 2009 META-INF/
   102 Mon Mar 16 10:41:14 EDT 2009 META-INF/MANIFEST.MF
     0 Mon Mar 16 10:41:14 EDT 2009 decodes/ 
```

删除日期后，列表如下所示：

```
 0  META-INF/
   102  META-INF/MANIFEST.MF
     0  decodes/ 
```

这两个 jar 列表是相同的。

什么会导致“相同”的 jar 文件出现 47 字节的差异？

我在 RedHat Linux 4 上运行编译。

* * *

## 回答 #1

> 赞同：7
> 
>             
> 
> 时间：2009-03-16T15:30:07.030

编译文件的文件修改时间很可能是原因。此外，您的类文件实际上可能不同。如果你重新组织你的包结构，他们肯定会的。

* * *

## 回答 #2

> 赞同：2
> 
>             
> 
> 时间：2009-03-16T15:59:28.847

可能不是这种情况 - 但是您在编译两个源代码库时是否使用不同的编译器版本（甚至是微小的版本差异）？

* * *

## 回答 #3

> 赞同：1
> 
>             
> 
> 时间：2009-03-16T16:34:16.733

如果您使用[BeyondCompare](http://www.scootersoftware.com/)（或类似的），它将区分您的 jar 文件并识别档案中的不同文件（直至文本文件的行/字符差异，或仅突出显示已更改的二进制文件）。

（我认为文件修改时间不会以 .jar 格式存储在它们的文本表示中，而且我不相信它们会影响 .jar 文件的大小）

# c# - 可以在显式接口实现中引用同名的隐式属性吗？

> ID：650898
> 
>         
> 
> 赞同：1
> 
>         
> 
> 时间：2009-03-16T15:27:45.897
> 
>         
> 
> 标签：c#, explicit-interface

假设我有一个实现字符串类型属性的类型：

```
public class Record
{
     public string Value { get; set; }
} 
```

然后我有一个定义同名属性的接口：

```
public interface IIntValued
{
     public int Value { get; set; }
} 
```

我可以使用如下显式接口：

```
public class Record : IIntValued
{
     public string Value { get; set; }
     int IIntValued.Value 
     {
          get{ return 0; } set{}
     }
} 
```

但是，如果我希望能够在我的显式接口中引用字符串“Value”，我可以这样做吗？如果是这样，怎么做？我想它是这样的：

```
public class Record : IIntValued
{
     public string Value { get; set; }
     public int IIntValued.Value 
     {
          get
          {
               string value = /*Magic here*/.Value;
               return int.parse(value); 
          } 
          set{}
     }
} 
```

如您所见，我想要“int valued”“Value”属性中的表达式的“string valued”“Value”属性。如果它是另一个显式实现的接口成员，我可以类型转换为该接口然后使用，但它如何用于隐式类型成员？

注意：这个例子有点做作，但希望能演示语言问题。

* * *

## 回答 #1

> 赞同：3
> 
>             
> 
> 时间：2009-03-16T15:33:13.357

对于隐式类型成员，只是`Value`或`this.Value`应该没问题 - 因为默认情况下它不会解析`IIntValued.Value`。

* * *

## 回答 #2

> 赞同：2
> 
>             
> 
> 时间：2009-03-16T15:38:03.483

你当然可以！问题是您将可访问性关键字放置在非法的地方。显式实现的成员不能有可访问性关键字。一个隐式实现的将在没有 IIntValue 的情况下写入。成员名称的前缀。

这是一个有效的示例。

```
public interface IIntValued
{
  int Value { get; set; }
}

public class Record : IIntValued
{
  public string Value { get; set; }
  int IIntValued.Value
  {
    get
    {
      string value = this.Value;
      return int.Parse(value);
    }
    set { }
  }
} 
```

* * *

## 回答 #3

> 赞同：1
> 
>             
> 
> 时间：2009-03-16T15:33:12.077

是的，您可以访问这两个属性。这取决于用于访问属性的变量的类型。观察：

```
Record myInstanceAsRecord = myInstance;
IIntValued myInstanceAsIIntValued = myinstance;

string valueAsString = myInstanceAsRecord.Value;
int valueAsInt = myInstanceAsIIntValued.Value; 
```

* * *

## 回答 #4

> 赞同：0
> 
>             
> 
> 时间：2009-03-16T15:36:19.213

呃，写完总结后，我意识到我知道答案了。:P 如果我将`this`其转换为类类型，则将不包括显式实现：

```
string value = ((Record)this).Value; //is the implicit string. 
```

**编辑：**经过进一步的输入（感谢响应者！）有人指出，无需手动执行编译器自动执行的操作。因此：

```
string value = this.Value; 
```

本来可以的。当然，这是因为`this`不是接口变量，所以隐式属性将是默认选择的那个。

# java - 在 Jetty 中设置 JDBC 身份验证

> ID：650904
> 
>         
> 
> 赞同：3
> 
>         
> 
> 时间：2009-03-16T15:28:58.670
> 
>         
> 
> 标签：java, authentication, jdbc, jetty

我需要使用码头设置基本的 jdbc 身份验证。

谁能给我一些指示（文章，教程甚至一些简单的解决方案）

* * *

## 回答 #1

> 赞同：0
> 
>             
> 
> 时间：2009-12-16T04:10:46.970

查看[在 Jetty 中设置领域的文档](http://docs.codehaus.org/display/JETTY/Realms)。向下滚动到“JDBCUserRealm”。

# tfs - 在 TFS 中处理死分支的最佳方法是什么？

> ID：650911
> 
>         
> 
> 赞同：15
> 
>         
> 
> 时间：2009-03-16T15:30:44.860
> 
>         
> 
> 标签：tfs, branch

在 TFS 中，标记死分支的最佳方法是什么？你移动你的分支吗？分行发布吗？删除它？重命名它？对于这些方法中的每一种，您都遇到了哪些问题？有哪些优点？

如果有一个简单的界面解决方案可以在特定分支被标记为已死时简单地标记或过滤当前视图，那就太好了。这样你就不必做一些永久性的事情，比如 rename 或 delete a branch 。. .

* * *

## 回答 #1

> 赞同：9
> 
>             
> 
> 时间：2009-03-16T15:35:12.273

删除不是永久性的，所以我会选择这个选项。

然后，您可以选择是否在 SCE 中查看已删除的项目（工具 -> 选项 -> 源代码管理 -> Visual Studio Team Foundation Server -> 在源代码管理资源管理器中显示已删除的项目）。

如有必要，您可以选择取消删除分支。

* * *

## 回答 #2

> 赞同：2
> 
>             
> 
> 时间：2009-03-16T15:44:51.580

合并回主干后，我们确实删除它们比将它们隐藏在工作区中要容易得多，请参阅 Ian 关于删除不是永久的。

* * *

## 回答 #3

> 赞同：1
> 
>             
> 
> 时间：2009-09-07T14:29:20.523

我们将死分支移动到项目的存档区域。  

*   因为 TFS 中的分支很便宜，所以没有空间问题。

*   当有人尝试添加具有相同名称的新内容时，删除可能会导致奇怪的问题。

*   移动它们可以继续使用诸如 Annotate（又名责备）之类的功能，它允许钻取分支以查看完整的更改历史记录。

# sql-server - 为 SQL Server 2005 优化未知数？

> ID：650914
> 
>         
> 
> 赞同：3
> 
>         
> 
> 时间：2009-03-16T15:31:25.700
> 
>         
> 
> 标签：sql-server, sql-server-2005, podcast

我正在收听 SO 播客，他们提到了为 SQL Server 2008 优化未知，他们还提到 SQL Server 2005 有类似的东西。有人知道这是什么吗？

* * *

## 回答 #1

> 赞同：2
> 
>             
> 
> 时间：2009-03-17T02:02:42.670

正如@Mladen Prajdic 提到的，`OPTIMIZE FOR UNKNOWN`仅在 SQL Server 2008 中引入。

如果您对查询工作负载有合理的了解，可以使用 OPTIMIZE FOR 来改进查询计划缓存：

[http://blogs.msdn.com/sqlprogrammability/archive/2008/11/26/optimize-for-unknown-a-little-known-sql-server-2008-feature.aspx](http://blogs.msdn.com/sqlprogrammability/archive/2008/11/26/optimize-for-unknown-a-little-known-sql-server-2008-feature.aspx)

[http://decipherinfosys.wordpress.com/2007/10/23/optimize-for-query-hint-in-sql-server-2005/](http://decipherinfosys.wordpress.com/2007/10/23/optimize-for-query-hint-in-sql-server-2005/)

* * *

## 回答 #2

> 赞同：2
> 
>             
> 
> 时间：2010-02-10T16:03:43.007

我遇到了这个问题......我知道它已经快一年了。但是在存储过程中，您可以使用本地参数来模仿 OPTIMIZE FOR UNKNOWN 的行为。请参阅这个[相关的 stackoverflow 问题](https://stackoverflow.com/questions/2225325/is-this-query-equivalent-to-sql-server-2008s-optimize-for-unknown)。

* * *

## 回答 #3

> 赞同：1
> 
>             
> 
> 时间：2009-03-16T16:23:28.523

在 sql server 2005 中，您没有未知选项。所以你唯一能做的就是指定某种值。

# javascript - 使用 javascript 调整和重新定位 div

> ID：650916
> 
>         
> 
> 赞同：2
> 
>         
> 
> 时间：2009-03-16T15:31:52.750
> 
>         
> 
> 标签：javascript, html, coding-style, resize

我正在尝试对显示 ajax 加载图像的 div 元素进行简单的调整大小和重新定位。它加载的内容可以改变大小，所以我希望将 div 元素调整为父元素的大小，在这种情况下，它是一个 ID 为“thEngineCategories”的表格维度。

```
function resize_divProgress() {
    var control = document.getElementById('thEngineCategories');
    var div = document.getElementById('divProgress');

    div.style.left = control.offsetLeft + 'px';
    div.style.top = control.offsetTop + 'px';
    div.style.width = control.offsetWidth + 'px';
    div.style.height = control.offsetHeight + 'px';
} 
```

以下是我拥有的 javascript，它错误

```
div.style.left = control.offsetLeft + 'px'; 
```

说“div.style 未定义”。这里有什么问题？

html中的div如下：

```
<div class="overlay" id="divProgress"> 
```

js函数调用如下：

```
<th id="thEngineCategories" onmouseover="resize_divProgress()" > 
```

CSS是：

```
.overlay
{
    border: black 1px solid;
    padding: 5px;
    z-index: 100;
    width: 300px;
    position: absolute;
    background-color: #fff;
    -moz-opacity: 0.75;
    opacity: 0.75;
    filter: alpha(opacity=75);
    font-family: Tahoma;
    font-size: 11px;
    font-weight: bold;
    text-align: center;
} 
```

有没有更好的方法来处理我正在尝试做的事情？

* * *

## 回答 #1

> 赞同：2
> 
>             
> 
> 时间：2009-03-18T05:48:01.897

我根据您提供的代码[创建了一个基本测试页面](http://pastebin.com/f35593ddb)，但无法重现该问题。这表明您的页面中还有其他原因导致您看到的行为。

你能把你的页面缩减到一个最小的例子来展示 JavaScript 错误吗？您会发现执行此过程通常会揭示错误的原因 - 您将删除某些内容并且它将开始工作，这表明该删除的代码部分中的某些内容是问题的根源:)

* * *

## 回答 #2

> 赞同：0
> 
>             
> 
> 时间：2013-03-25T18:58:30.120

div.style.width 不是访问 div 宽度的有效属性。

分别使用**div.offsetWidth**和**div.offsetHeight**作为宽度和高度。

# desktop - Web 与桌面开发（在线与智能客户端）

> ID：650917
> 
>         
> 
> 赞同：5
> 
>         
> 
> 时间：2009-03-16T15:32:39.707
> 
>         
> 
> 标签：desktop, smartclient, design-decisions

我在一家拥有大量 SAP 投资的公司工作，我们还有数十个大型 .Net 系统（主要用于内部工程系统）和 Java 平台（主要用于外部 Web 应用程序）。因此，我们在 ABAP、C# 和 Java EE 上有大型开发商店。

对于在哪个域中使用哪个平台，我们有很好的标准，但是对于何时使用 Web UI 以及何时使用桌面 UI，我们并没有很清楚。

我过去看过一些关于这个主题的优秀研究（[像这样](http://answers.google.com/answers/threadview/id/747326.html)），但我想要一些更有条理的东西

我想根据最佳实践构建一个决策树来帮助解决这个问题。

我过去看到的一些标准包括：

*   该应用程序是否针对具有不同操作系统配置的用户？

*   应用程序是否需要 OS 类型的功能来排序和编辑数据？（我知道 AJAX / 异步 JS 为 Web 应用程序提供了更丰富的类似桌面的功能，但有些人认为桌面仍然是该领域的王者）

*   Web 应用程序能否提供桌面应用程序可以提供的可用性、响应性、清晰度和实用性？

* * *

## 回答 #1

> 赞同：5
> 
>             
> 
> 时间：2009-03-16T15:53:06.520

我认为我们看到 Web 和桌面应用程序之间的分离已经软化了很多。丰富的互联网应用程序（使用 Flex、Silverlight、Ajax）开启了这一趋势，而 WPF 和 XBAP 正在将基于浏览器的应用程序的用户体验提升到另一个层次。提出这个论点变得更加复杂，因为现在在 Web 和桌面应用程序之间的范围内有更多的风格。

还有一些问题要问：

*   应用程序的主要目标是什么 - 数据操作或数据查看？

*   需要在一个屏幕上一起查看/编辑的数据点/记录的数量是多少？

*   组织的 IT 基础架构是什么样的？他们能够适应新的部署模型吗？

*   用户会在远程位置使用中央数据库吗？

*   组织是否拥有异地用户的 VPN 基础架构，用户如何进行身份验证？

*   是否存在同一个用户组正在使用的现有应用程序，这些应用程序是如何部署的？

*   应用程序是否需要离线功能？

*   鉴于它们如此不同，Web 和桌面 API 的开发团队的技能组合是什么？

# iphone - 关于在 iPhone 上更新 UITableViewCell 的问题

> ID：650918
> 
>         
> 
> 赞同：3
> 
>         
> 
> 时间：2009-03-16T15:32:40.127
> 
>         
> 
> 标签：iphone, objective-c, cocoa, cocoa-touch

我想做一些简单的事情，比如深入研究一个特定的 UITableViewCell，这会带来一个细节视图控制器。在那里，用户可以更改单元格下方模型的属性。例如，如果我正在显示引用列表，并且用户单击引用并在子控制器中将其收藏，我希望能够显示现在隐藏的图像，因为它已被收藏，可能是一颗星。以诸如时尚之类的方式更新一个特定 UITableViewCell 的最简单方法是什么？是否最好将选定的 UITableViewCell 引用到子控制器中并以这种方式耦合它们？这样的事情是怎么做的？

谢谢。

* * *

## 回答 #1

> 赞同：5
> 
>             
> 
> 时间：2009-03-16T16:35:37.027

简单地更新模型对象然后调用`[tableView reloadData];`.

然后更改您的绘图代码以考虑更改并显示隐藏的图像或其他内容。

* * *

## 回答 #2

> 赞同：2
> 
>             
> 
> 时间：2010-09-09T22:59:57.210

`setNeedsLayout`为我做的。

* * *

## 回答 #3

> 赞同：1
> 
>             
> 
> 时间：2009-03-16T17:09:44.310

有关完整的代码示例，请查看 ADC 上的 SQLite Books 项目。

* * *

## 回答 #4

> 赞同：-1
> 
>             
> 
> 时间：2009-03-16T16:30:03.390

要重绘一个特定的单元格，您应该找到它的矩形 (rectForRowAtIndexPath)，然后使用这个矩形在 UITableView 上调用 setNeedsDisplayInRect。

# c# - 使用隐式类型的局部变量

> ID：650919
> 
>         
> 
> 赞同：65
> 
>         
> 
> 时间：2009-03-16T15:32:55.277
> 
>         
> 
> 标签：c#, coding-style, implicit-typing

[我刚刚安装了ReSharper](http://www.jetbrains.com/resharper/index.html)的试用版，我注意到的第一件事是它总是建议用隐式类型的局部变量替换显式类型的局部变量，例如：

```
public string SomeMethod(int aParam)
{
    int aNumber = SomeOtherMethod(aParam);
    // should be changed to:
    var aNumber = SomeOtherMethod(aParam);
} 
```

我认为显式类型的变量更具可读性（更明确）。

您如何看待 ReSharper 的建议？使用隐式类型变量有什么好处吗？你什么时候使用隐式/显式变量？

* * *

## 回答 #1

> 赞同：74
> 
>             
> 
> 时间：2009-03-16T15:48:22.977

我个人只在通过阅读声明就能清楚地区分变量类型的情况下使用“var”，例如：

```
var someVariable = new List<int>(); 
```

在上面的例子中，很明显“var”指的是“List<int>”。

当我必须去一些方法定义来找出变量类型“var”代表什么或不得不依赖于 Visual Studio intelli-popup 或任何被调用的东西时，我不喜欢使用“var”，例如这个在我不行：

```
var someVaraible = SomeMethod(); 
```

我的意思是，“SomeMethod”函数应该返回什么？只看这行代码你能知道吗？不，你不能，所以这就是为什么我避免在这些情况下使用“var”。

* * *

## 回答 #2

> 赞同：39
> 
>             
> 
> 时间：2009-03-16T15:40:29.250

关于这个有很多讨论，但我认为这完全取决于个人喜好，就像几乎在任何地方都使用“this”关键字一样。

我*个人*更喜欢显式类型的变量，但是当使用嵌套的泛型集合时，使用隐式类型的变量可以变得更具可读性。看着：

```
Dictionary<string, Dictionary<string, string>> myDictionary = new Dictionary<string, Dictionary<string, string>>(); 
```

与：

```
var myDictionary = new Dictionary<string, Dictionary<string, string>>(); 
```

编辑：这个 SO 主题涵盖了相同的主题，并有一些很好的回复：[使用什么：var 或对象名称类型？](https://stackoverflow.com/questions/236878/what-to-use-var-or-object-name-type)

EDIT2：现在大量使用异步，我发现使用显式类型变量有时可以防止讨厌的错误。考虑这个愚蠢的示例，您希望返回用户的 Id。还要考虑`GetUserAsync`返回 a `Task<User>`。如果你使用隐式类型的变量，你最终会使用这样的东西：

```
public long GetUserId()
{
  var user = GetUserAsync();
  return user.Id;
} 
```

这编译，但它是错误的。“用户”实际上是一个`Task<User>`. 它编译为`Task`也有一个`Id`属性。在这种情况下，可能会意外返回任务的 ID 而不是用户。

```
public long GetUserId()
{
  User user = GetUserAsync();
  return user.Id;
} 
```

以上内容无法编译，因为编译器会抱怨您无法将任务强制转换为用户。添加`await`关键字当然可以解决这个问题。

我实际上曾经发生过这种情况:-)

* * *

## 回答 #3

> 赞同：17
> 
>             
> 
> 时间：2009-03-16T17:06:21.773

万一有些人还没有注意到，您可以轻松地更改 Reshaper 中的“建议”（Reshaper -> Options -> Languages -> Context Actions -> “Replace explicit type specification with 'var'”）。

我个人更喜欢到处都有明确的类型规范，但我对此并不太挑剔。

* * *

## 回答 #4

> 赞同：6
> 
>             
> 
> 时间：2009-03-16T15:35:37.000

有时键入 var 伪关键字比键入巨大的类型名称更容易，尤其是在可能涉及泛型的情况下。但是，您应该知道它们在功能上是相同的。没有性能差异或任何一种方式。编译器派生赋值右侧的类型并将 var 替换为该类型。它不像 VB 变体那样在运行时发生。

* * *

## 回答 #5

> 赞同：6
> 
>             
> 
> 时间：2009-03-16T15:40:47.283

FWIW， var 关键字在许多情况下都是可读的。特别是如果...

1.  赋值的右侧是构造函数表达式。

    var map = new Dictionary>();

2.  局部变量有好名字。

高温高压

# c - 不会停止等待用户输入的游戏循环

> ID：650923
> 
>         
> 
> 赞同：3
> 
>         
> 
> 时间：2009-03-16T15:33:49.110
> 
>         
> 
> 标签：c, loops

我已经开始摆弄 C 来提高我的编程技能，并决定尝试实现一个俄罗斯方块游戏。没什么太花哨的，它会在控制台上运行。

尽管有用户输入，我从来没有实现过一个持续运行的游戏，并且直到我开始考虑游戏算法之前我才知道我必须处理这个问题。

谷歌搜索解决方案我想出了一个 _kbhit() 函数，但我在 Linux 机器上编程，该函数仅在 Windows 上可用。我该怎么做？

* * *

## 回答 #1

> 赞同：3
> 
>             
> 
> 时间：2009-03-16T15:46:41.857

对于控制台应用程序，您可以考虑使用[GNU ncurses](http://www.gnu.org/software/ncurses/ncurses.html)，它是一种用于编写控制台应用程序的工具包，并支持此类输入。它还应该通过提供在坐标处打印字符的方法等来帮助您处理游戏的输出。

* * *

## 回答 #2

> 赞同：0
> 
>             
> 
> 时间：2009-03-16T16:03:04.640

为了能够拦截特殊字符，请将终端切换到[非规范模式](http://www.gnu.org/software/libtool/manual/libc/Terminal-Modes.html#Terminal-Modes)

# python - 你如何用一个数字字符替换 Python 捕获？

> ID：650926
> 
>         
> 
> 赞同：3
> 
>         
> 
> 时间：2009-03-16T15:34:43.010
> 
>         
> 
> 标签：python, regex, string

使用[re.sub](http://docs.python.org/library/re.html)时，如何处理需要捕获后跟替换字符串中的数字的情况？例如，您不能将“\10”用于捕获 1 后跟“0”字符，因为它将被解释为捕获 10。

* * *

## 回答 #1

> 赞同：6
> 
>             
> 
> 时间：2009-03-16T15:40:27.847

```
\g<1>0 
```

[http://docs.python.org/library/re.html#re.sub](http://docs.python.org/library/re.html#re.sub)

> \g<number> 使用对应的组号；因此，\g<2> 等价于 \2，但在诸如 \g<2>0 之类的替换中并没有歧义。\20 将被解释为对第 20 组的引用，而不是对第 2 组的引用，后跟文字字符“0”。

# c# - UserControl 中的 AJAX ScriptManager

> ID：650927
> 
>         
> 
> 赞同：4
> 
>         
> 
> 时间：2009-03-16T15:34:43.040
> 
>         
> 
> 标签：c#, ajax, user-controls, scriptmanager

我有一个 UserControl，其中包含一个包含其他控件的 UpdatePanel。UserControl 将用于一些已经有 ScriptManager 的页面和其他没有 ScriptManager 的页面。如果不存在，我希望 UserControl 自动带来自己的 ScriptManager。

我已经尝试过 ScriptManager.GetCurrent，如果它返回 null，我将创建自己的 ScriptManager 并将其插入到表单中，但我无法在 UserControl 的生命周期中找到足够早的位置来运行此代码。我不断收到错误消息“ID 为 'uPnlContentList' 的控件需要页面上的 ScriptManager。ScriptManager 必须出现在任何需要它的控件之前。” 每次我尝试加载页面。我尝试运行我的代码的地方是 OnInit、CreateChildControls 和 PageLoad，它们永远不会被调用，因为它在到达它们之前就死了。

我应该把这张支票放在哪里？

* * *

## 回答 #1

> 赞同：11
> 
>             
> 
> 时间：2009-03-16T16:21:09.077

在您的所有 ASPX 文件引用的 MasterPage 中放置一个 ScriptManager。然后在站点中您需要使用 ScriptManager 的任何其他地方使用 ScriptManagerProxy，它将从母版页获取 ScriptManager，并让您在用户控件和后面的代码中使用它。

现在调用 ScriptManager.GetCurrent(Page) 将为您提供对脚本管理器的引用。

```
<asp:ScriptManagerProxy>
  <Scripts>
    <asp:ScriptReference Path="~/Scripts/myscript.js" />
  <Scripts>
</asp:ScriptManagerProxy> 
```

这是一个链接：

[MSDN 信息](http://msdn.microsoft.com/en-us/library/system.web.ui.scriptmanagerproxy.aspx)

* * *

## 回答 #2

> 赞同：2
> 
>             
> 
> 时间：2009-03-16T15:38:49.020

我讨厌从另一个方向来，但是您使用的是母版页吗？如果是这样，您是否考虑过在其上放置一个 ScriptManager 并完成它？

* * *

## 回答 #3

> 赞同：0
> 
>             
> 
> 时间：2009-03-16T16:32:32.433

我认为 Init 事件应该起作用。使用您描述的技术（即在添加之前检查 ScriptManager.GetCurrent 返回 null）但是当您添加 ScriptManager 时，请确保将其添加为表单内的第一个控件。

我没有对此进行测试，但我认为它会起作用。

* * *

## 回答 #4

> 赞同：0
> 
>             
> 
> 时间：2012-05-15T15:14:25.660

对我有用的是在 <form> 之后包含这一行

```
 <asp:ScriptManager ID="scriptManager" runat="server"/> 
```

这让我明白了“......页面上需要一个 ScriptManager。ScriptManager 必须出现在任何需要它的控件之前。”

* * *

## 回答 #5

> 赞同：0
> 
>             
> 
> 时间：2015-03-26T12:20:27.317

我做了两件有效的事情。

在 UserControl 上制作这个 Sub：

```
Public Sub SetFocus()
    txtBox.Focus()
End Sub 
```

在 caling 站点上，在 ScriptManagerCall 之前调用它

```
userControl.SetFocus() 
```

如果您在 UserControl 上有 AutoPostback，您还必须在 TextChanged 事件中设置焦点。

```
Protected Sub txtBox_TextChanged(ByVal sender As Object, ByVal e As System.EventArgs) Handles txtBox.TextChanged
    txtBox.Focus()
    ......
End Sub 
```

希望这有效。

# svn - TortoiseSVN 的源代码控制替代方案，供单人开发人员使用，仅限本地使用

> ID：650929
> 
>         
> 
> 赞同：9
> 
>         
> 
> 时间：2009-03-16T15:35:08.373
> 
>         
> 
> 标签：svn, version-control

我以前从未使用过源代码控制（总是使用重命名文件和其他方法），所以我一直在寻找一个相对简单的解决方案来开始我的工作。我在寻找

*   简单的东西

*   带有 GUI 界面（以及一个命令行）

*   比较常用

*   有关于这个主题的书（最重要的）

*   也可以随身携带Word文件

我找到了 TortoiseSVN。考虑到上述情况，可能的替代方案是什么？

ps 是的，我知道这已经被问死了，所以如果你知道一个已回答的问题，请把它转给我。我正在把它变成一个社区 wiki，所以它不会在第一分钟就关闭，然后我可能会删除它，所以它不会造成冗余。

* * *

相关：[单一开发者的源代码控制系统](https://stackoverflow.com/questions/45400/source-control-system-for-single-developer)

* * *

## 回答 #1

> 赞同：8
> 
>             
> 
> 时间：2009-03-16T16:39:18.267

对于您的标准，我认为您不会找到比 TortoiseSVN 更好的东西。还有一些其他的用于颠覆的 GUI，如下所述。

*   **一些简单**的事情：一旦你掌握了基础知识，你可能不会比[颠覆](http://subversion.tigris.org/)容易得多。您还可以尝试[SourceGear Vault](http://www.sourcegear.com/vault/)，它易于上手，并且对一位用户免费。我发现[Mercurial](http://www.selenic.com/mercurial/wiki/)易于使用，用于分布式版本控制系统，但如果您想要一些简单的东西，最好从非分布式系统开始。

*   **带有 GUI 界面（以及命令行界面）**：Subversion 有[TortoiseSVN](http://tortoisesvn.tigris.org/)、[RapidSVN](http://rapidsvn.tigris.org/)，它更像是传统的 UI 或[AnkhSVN](http://ankhsvn.open.collab.net/)用于 Visual Studio 集成。SourceGear Vault 有一个模仿 Visual Source Safe 的 UI。Mercurial 有[TortoiseHg](http://bitbucket.org/tortoisehg/stable/wiki/Home)，另一个 Explorer 插件，但它不像 TortoiseSVN 那样成熟，以及其他[IDE 集成](http://www.selenic.com/mercurial/wiki/index.cgi/OtherTools)。

*   **相对使用**：你不会比 Subversion/TortoiseSVN 更常用。它已成为事实上的首选 VCS。分布式工具（git、Mercurial）变得越来越流行，尤其是在开源领域，但仍然落后于 Subversion。Subversion、git 或 Mercurial 可能不会出错，因为它们有很好的追随者。

*   **有关于该主题的书籍（最重要）**：有[Subversion](http://svnbook.red-bean.com/)和[Mercurial](http://www.selenic.com/mercurial/wiki/index.cgi/MercurialBook)的在线书籍。我没有调查过 Vault 的帮助，但我确信 Vault 也有[很好的资源](http://www.sourcegear.com/vault/info.html)。

*   **也可以将 Word 文件放入其中**：安装了 TortoiseSVN 来[执行此操作](http://tortoisesvn.net/node/152)，尽管我尚未对其进行测试。您可以按文件类型分配差异程序。

祝你好运！

* * *

## 回答 #2

> 赞同：7
> 
>             
> 
> 时间：2009-03-16T15:37:19.353

TortoiseSVN 是一个非常漂亮的 Windows 用户界面——也是我用过的最好的。Git 有一些不错的功能，但据我所知，尽管正在进行[一些尝试](http://code.google.com/p/tortoisegit/)，但尚未为 Windows 提供完善的 UI 。

我不太熟悉它，但我对[Mercurial](http://www.selenic.com/mercurial/wiki/)有好处。为此也存在一个非常相似的 TortoiseSVN 克隆，称为[TortoiseHg](http://www.selenic.com/mercurial/wiki/index.cgi/TortoiseHg)，而且似乎更进一步。

* * *

## 回答 #3

> 赞同：4
> 
>             
> 
> 时间：2009-03-16T15:42:08.373

SO 社区真的那么残酷，以至于您觉得有必要删除您的问题，即使您对现有问题的回答并不满意？如果您觉得其他问题和答案中缺少某些内容，那么请务必不要担心。我不想认为因为用户社区而没有提出好的问题。

回到问题： Tortoise 确实会成为你会发现的更好的工具之一，因为它能够在一个普通的 Windows 资源管理器窗口中快速查看自你上次提交到存储库以来发生了什么变化。

据我所知，没有其他工具更适合个人开发人员，但这只是我的看法。

* * *

## 回答 #4

> 赞同：3
> 
>             
> 
> 时间：2009-03-16T15:41:57.157

如果您使用的是 Visual Studio，请尝试[AnkhSVN](http://ankhsvn.open.collab.net/)。它是 Visual Studio 的免费 SVN 插件。

此外，这并不是对另一个源代码控制系统的真正建议，但您可能想知道。[XP-Dev.com](http://xp-dev.com/)提供免费的 SVN 托管（最大 1.5 GB）。我已经使用了一段时间，它真的很好。我也是一个单人团队，但有备份和修改是至关重要的。TortoiseSVN 确实是最好的用户界面。

* * *

## 回答 #5

> 赞同：2
> 
>             
> 
> 时间：2009-03-16T15:44:44.483

你应该试试 TortoiseHG ( [Mercurial](http://www.selenic.com/mercurial/wiki/) ) 这很容易使用。

* * *

## 回答 #6

> 赞同：2
> 
>             
> 
> 时间：2009-03-16T16:03:18.370

根据我的经验，目前在 Windows 上没有任何东西可以与 TortoiseSVN 竞争。我真的很高兴乌龟。仅仅是因为你想做一个完美的选择而你要求一个替代方案，还是你不喜欢它？

* * *

## 回答 #7

> 赞同：2
> 
>             
> 
> 时间：2009-03-16T16:20:40.433

我已经在[Bazaar](http://bazaar-vcs.org)工作了几个星期，非常喜欢它。我是一名 linux 开发人员，所以对 Tortois 不太了解，但如果你喜欢它，你应该知道有一个[Tortoisbzr](http://bazaar-vcs.org/TortoiseBzr)

* * *

## 回答 #8

> 赞同：1
> 
>             
> 
> 时间：2009-03-16T15:49:31.413

我不知道您使用的是什么语言，或者您正在进行什么样的开发，但总的来说，源代码控制的最佳选择是可以集成到您的 IDE 中的一种。如果您将所有东西都放在一个地方，那就更容易了。

例如，Eclipse 集成了对 CVS 的支持、对 SVN 的 Subclipse、对 Bazaar 的 BzrEclipse、来自 JGit 的 Git 插件以及对其他 SCM 的类似支持。我认为像 IntelliJIdea 的 Netbeans 这样的 IDE 也有类似的集成选项。

* * *

## 回答 #9

> 赞同：1
> 
>             
> 
> 时间：2009-03-16T16:38:19.813

我可以推荐[http://www.sourcegear.com/](http://www.sourcegear.com/)作为廉价的 SVN 替代品。

* * *

## 回答 #10

> 赞同：0
> 
>             
> 
> 时间：2011-01-09T12:54:34.493

在不了解开发团队规模、工作实践、项目类型、IDE 等的情况下，很难给出准确的答案。鉴于您没有使用源代码控制，我假设您在一个小团队中，或者可能是您重新成为独行侠。考虑到这一点，我将完全破坏我所拥有的少量代表，并建议将 SourceSafe 添加到您的评估列表中（是的，我说的是负载！）。事实是，如果您对独占锁感到满意，它就符合您的所有标准。它非常简单（比 svn 简单）。就个人而言，如果我有很多代码要控制或在一个小团队以外的任何地方工作，我不会使用它，但我确实将它用作我的 SC，为 SME 和家庭项目工作了很多年，这很好。一个缺点是 MS 在 4 月份撤回了主线支持。

就个人而言，我现在在家里和工作中都使用带有 ankh 和 tortoise 插件的 svn。如果您在家工作或在小型开发环境中工作，您实际上可以在 NAS 上托管 svn。另一个值得研究的选择是许多 svn 托管服务提供商（我为我的家庭项目使用了其中一项免费服务，并且发现它们非常好）。在 SOHO 环境中，它可以作为一种简单的方式让您的代码离开现场。

在一两年前进行调查时，我们对主要玩家的偏好顺序为：

1.  强制执行。没有个人经验，但我还没有与不喜欢 perforce 的同时使用 perforce 和 svn 的开发人员交谈过。缺点：需要付费！

2.  SVN。当然，这似乎是大多数人所在的地方。以合适的价格提供（即免费）并且有很多社区插件支持（尽管有些比其他的更脆弱）。

3.  来源安全。它可能是其他 SCS 的白痴兄弟，但它的简单性是它在小型开发环境中的优势。这对你来说可能是正确的。

4.  MS SourceControl（通常称为 TFS）。排在最后是有原因的，每个人都讨厌 TFS！我们从 sourcesafe 迁移到 TFS，并在大约 6 个月后迅速迁移（到 SVN）！

# c++ - C ++ MI静态模板 - 静态方法在加入时消失

> ID：650931
> 
>         
> 
> 赞同：0
> 
>         
> 
> 时间：2009-03-16T15:35:22.820
> 
>         
> 
> 标签：c++, templates, static

```
#include <iostream>
using namespace std;

/*

       TA        <-- defines static function
     /    \
    |      B    <-- subclass TA, inherits it so B::StaticFunc can be used.
     \    /
       C        <-- want to inherit static func from A, subclass B privately
*/

template <class T> class TA
{
public:
    // return ptr to new instance of class T
    static T * instance()
    {
        static T inst;
        return &inst;
    }
};

class B : public TA<B>
{
public:
    void Func() { cout << "B" << endl; }
};

/* HERE:  class C : public TA<C> */
class C : public TA<C>, private B
{
public:
    void Func() { cout << "C" << endl; }
};

int main()
{
    C test();

    B::instance()->Func();
    C::instance()->Func();

    /*
     Expected output:
       B
       C

     Actual error:
        error: `instance' is not a member of `C'|

        If i do not subclass B with C, then it compiles. However, I need
        C to provide some other functionality and but a subclassable Singleton
    */

    return 0;
} 
```

* * *

## 回答 #1

> 赞同：2
> 
>             
> 
> 时间：2009-03-16T15:44:24.890

我得到一个不同的、更合理的错误（使用 g++ 4.3.3）：

```
tst.cpp: In function ‘int main()’:
tst.cpp:49: error: reference to ‘instance’ is ambiguous
tst.cpp:22: error: candidates are: static T* TA<T>::instance() [with T = B]
tst.cpp:22: error:                 static T* TA<T>::instance() [with T = C] 
```

这可以通过明确指定`instance`应该使用的版本来解决`C`：

```
class C : public TA<C>, private B
{
public:
    using TA<C>::instance;
    void Func() { cout << "C" << endl; }
}; 
```

# c# - 如何让 C# 识别外部 .dll 中的自定义属性？

> ID：650941
> 
>         
> 
> 赞同：2
> 
>         
> 
> 时间：2009-03-16T15:36:37.233
> 
>         
> 
> 标签：c#, reflection

下面的代码成功识别了用我的自定义“模块”属性装饰的*内部类，我像这样加载程序集：*

```
Assembly assembly = Assembly.GetExecutingAssembly(); 
```

但是，当我加载**外部模块**并查看其类时，它会在外部程序集中找到类但**无法识别自定义属性**：

```
Assembly assembly = Assembly.LoadFrom(@"c:\tests\modules\CustomModules.dll"); 
```

**我必须指定什么才能让 C# 识别外部 .dll 中的自定义属性，就像它识别内部类一样？**

这是成功运行并识别用我的“模块”属性装饰的内部类的代码：

```
using System;
using System.Collections.Generic;
using System.Linq;
using System.Reflection;

namespace DynamicAssembly2
{
    class Program
    {
        static void Main(string[] args)
        {
            var modules = from t in GetModules()
                           select t;
            foreach (var module in modules)
            {
                ModuleAttribute[] moduleAttributes = GetModuleAttributes(module);
                Console.WriteLine(module.FullName);
                foreach (var moduleAttribute in moduleAttributes)
                {
                    Console.WriteLine(moduleAttribute.Description);
                }
            }
            Console.ReadLine();
        }

        public static IEnumerable<Type> GetModules()
        {
            //Assembly assembly = Assembly.LoadFrom(@"c:\tests\modules\CustomModules.dll");
            Assembly assembly = Assembly.GetExecutingAssembly();

            return GetAssemblyClasses(assembly)
                .Where((Type type) => {return IsAModule(type);});
        }

        public static IEnumerable<Type> GetAssemblyClasses(Assembly assembly)
        {
            foreach (Type type in assembly.GetTypes())
            {
                Console.WriteLine(type.FullName);
                yield return type;
            }
        }

        public static bool IsAModule(Type type)
        {
            return GetModuleAttribute(type) != null;
        }

        public static ModuleAttribute GetModuleAttribute(Type type)
        {
            ModuleAttribute[] moduleAttributes = GetModuleAttributes(type);
            Console.WriteLine(moduleAttributes.Length);
            if (moduleAttributes != null && moduleAttributes.Length != 0)
                return moduleAttributes[0];
            return null;
        }

        public static ModuleAttribute[] GetModuleAttributes(Type type)
        {
            return (ModuleAttribute[])type.GetCustomAttributes(typeof(ModuleAttribute), true);
        }

    }
} 
```

这是我的自定义 Mdoule 属性：

```
using System;

namespace DynamicAssembly2
{
    [AttributeUsage(AttributeTargets.Class)]
    public class ModuleAttribute : Attribute
    {
        public string Description { get; set; }
    }
} 
```

这是一个自定义模块：

```
namespace DynamicAssembly2
{
    [Module(Description="This is the main customer class.")]
    class Customers
    {
    }
} 
```

* * *

## 回答 #1

> 赞同：4
> 
>             
> 
> 时间：2009-03-16T15:42:01.353

您在程序集中定义了多少个 ModuleAttribute 类的实例？

看起来您在 DynamicAssembly2 中有一个，在 CustomModules 中有一个……在这种情况下，它们是不同的类型。

DynamicAssembly2 中的代码应该使用 CustomModules 中定义的属性类（或者两个程序集都应该从第三个程序集中加载属性）。

* * *

## 回答 #2

> 赞同：2
> 
>             
> 
> 时间：2009-03-16T15:42:06.470

我很确定它无法区分...您确定您要的是正确的属性吗？只要两个项目引用**相同** `ModuleAttribute`，那么`typeof(ModuleAttribute)`应该可以工作。否则，您需要先找到所需`Type`属性的 （来自`Assembly.GetType()`），然后在调用`GetCustomAttributes`.

* * *

## 回答 #3

> 赞同：1
> 
>             
> 
> 时间：2009-03-16T16:02:29.447

阿罗哈

我已经测试了您的代码，但无法编译它，因为在`ModuleAttribute`主程序和外部 dll 中都必须知道该类型。我假设没有涉及参考。

我确实通过引入参考来让它工作。

这是课程。此程序集包含对 DynamicAssembly 的引用

```
using System;    

namespace DynamicAssembly2
{
    [DynamicAssembly.Module(Description = "This is the main customer class.")]
    public class Customers
    {
    }
} 
```

这是 DynamicAssembly 中的代码：

```
using System.Reflection;

namespace DynamicAssembly
{
    [AttributeUsage(AttributeTargets.Class)]
    public class ModuleAttribute : Attribute
    {
        public string Description { get; set; }
    }

    class Program
    {
        static void Main(string[] args)
        {
            var modules = from t in GetModules()
                          select t;
            foreach (var module in modules)
            {
                ModuleAttribute[] moduleAttributes = GetModuleAttributes(module);
                Console.WriteLine(module.FullName);
                foreach (var moduleAttribute in moduleAttributes)
                {
                    Console.WriteLine(moduleAttribute.Description);
                }
            }
            Console.ReadLine();
        }

        public static IEnumerable<Type> GetModules()
        {
            Assembly assembly = Assembly.LoadFrom(@"C:\Temp\ClassLibrary1\bin\Debug\ClassLibrary1.dll");

            return GetAssemblyClasses(assembly)
                .Where((Type type) => { return IsAModule(type); });
        }

        public static IEnumerable<Type> GetAssemblyClasses(Assembly assembly)
        {
            foreach (Type type in assembly.GetTypes())
            {
                yield return type;
            }
        }

        public static bool IsAModule(Type type)
        {
            return GetModuleAttribute(type) != null;
        }

        public static ModuleAttribute GetModuleAttribute(Type type)
        {
            ModuleAttribute[] moduleAttributes = GetModuleAttributes(type);
            Console.WriteLine(moduleAttributes.Length);
            if (moduleAttributes != null && moduleAttributes.Length != 0)
                return moduleAttributes[0];
            return null;
        }

        public static ModuleAttribute[] GetModuleAttributes(Type type)
        {
            return (ModuleAttribute[])type.GetCustomAttributes(typeof(ModuleAttribute), true);
        }

    }
} 
```

* * *

## 回答 #4

> 赞同：0
> 
>             
> 
> 时间：2010-12-13T23:51:00.117

我有同样的问题。如果该属性是在内部 *cs 中定义的，我可以获得该属性，但如果它是在外部 dll 中定义的，那么当我查询它时我只会得到 null（没有错误），但也没有链接器错误。

显然，在 DLL 中定义的自定义属性和在本地代码 (*cs) 中定义的相同自定义属性将很高兴地编译到一个应用程序中，而不会发出任何关于多个定义的警告（名称空间相同）。我摆脱了本地代码（*cs），并修复了引用并且它起作用了。

# visual-studio-2008 - VS2008 单元测试失败，当您选择测试-调试-解决方案中的所有测试

> ID：650945
> 
>         
> 
> 赞同：0
> 
>         
> 
> 时间：2009-03-16T15:38:28.897
> 
>         
> 
> 标签：visual-studio-2008, unit-testing, debugging

在调试模式下，抛出自定义异常的测试会给出错误消息，例如

```
Exception of type 'CustomProductException' was thrown instead of 'CustomProductException' 
```

失败。但是当我选择测试 -**运行**- 解决方案中的所有测试而不是调试时，所有测试都通过了。为什么会发生这种情况？任何指针...

* * *

## 回答 #1

> 赞同：1
> 
>             
> 
> 时间：2009-03-16T15:59:32.387

我以前也有过这种情况。我相信这个问题是我的参考。清理整个解决方案，并删除解决方案中每个项目中对包含 CustomProductException 的程序集的每个引用。  

接下来，重新添加您的引用，确保引用编译程序集的项目，而不是磁盘上已编译的程序集。

# linux - 通过调制解调器连接到基于 Linux 的服务器

> ID：650954
> 
>         
> 
> 赞同：0
> 
>         
> 
> 时间：2009-03-16T15:40:13.603
> 
>         
> 
> 标签：linux, modem, ppp

我有一个带有调制解调器的黑盒设备（我可以向它发送命令），并且希望能够连接以从它向服务器发送数据。我有哪些连接选项，PPP 是我需要使用的协议还是有更好的选择？

* * *

## 回答 #1

> 赞同：1
> 
>             
> 
> 时间：2009-03-16T15:46:03.357

ppp 无疑是通过调制解调器获得 IP 连接的最常见解决方案。还有其他解决方案，但如果您需要的是 IP 连接，则没有理由不使用 PPP。

如果您不需要 IP 连接并且您正在编写客户端和服务器，您也可以直接从一个调制解调器到另一个调制解调器进行串行连接，但这有点老派。

* * *

## 回答 #2

> 赞同：0
> 
>             
> 
> 时间：2009-04-07T16:32:24.277

如果您还需要 IP 网关和路由，PPP 可能是您的最佳选择。如果您只需要终端访问设备，并且它运行某种形式的 *nix，您可能有 getty+serial 通信作为选项。您可以在另一端使用任意数量的调制解调器终端客户端。

# windows-mobile - 如何以编程方式更改 Windows Mobile 主屏幕

> ID：650955
> 
>         
> 
> 赞同：3
> 
>         
> 
> 时间：2009-03-16T15:40:21.730
> 
>         
> 
> 标签：windows-mobile, homescreen

有谁知道是否可以更改主屏幕。

我有一个安装所有必要的 xml 文件和主屏幕插件的设置，但我不知道如何在安装过程中将主屏幕更改为我的（并在卸载过程中将其删除）

* * *

## 回答 #1

> 赞同：4
> 
>             
> 
> 时间：2009-03-25T07:12:12.597

对于智能手机设备，您可以使用配置 xml。如果您在 cab 文件中包含配置 xml 作为“post-xml”，则应自动处理卸载。或者，您可以使用自定义设置 dll 中的 DMProcessConfigXML API 自己处理配置 xml。查看以下 MSDN 链接了解更多详细信息。

[主屏幕配置 xml](http://msdn.microsoft.com/en-us/library/aa456136.aspx) 

[prexml 和 /postxml](http://msdn.microsoft.com/en-us/library/aa457875.aspx) 

[DMProcessConfigXML](http://msdn.microsoft.com/en-us/library/ms852998.aspx)  

* * *

## 回答 #2

> 赞同：0
> 
>             
> 
> 时间：2009-03-25T01:41:46.323

我不相信微软提供了任何方法来做你想做的事。  

您可以安装 SP HomeScreen 插件，但由用户自己选择主屏幕插件。如果您愿意，可以提供有关如何使用安装程序 dll 执行此操作的说明。PPC Today Items 也是如此。

# swt - 使用 JFace 数据绑定绑定单选按钮组的正确方法

> ID：650959
> 
>         
> 
> 赞同：11
> 
>         
> 
> 时间：2009-03-16T15:40:52.323
> 
>         
> 
> 标签：swt, eclipse-rcp, jface, data-binding

我想知道是否有人可以向我解释如何使用 JFace 数据绑定将一组单选按钮正确绑定到模型中的布尔变量。

让我先解释一下情况：我创建了一个代表一组 SWT 按钮（样式设置为“SWT.RADIO”）的类，它由三个元素组成：一个带有问题的标签和两个按钮，一个用于“是”的答案和一个“否”。我想在模型中创建一个与布尔变量的绑定，这样当用户选择“是”单选按钮时，布尔值设置为真，当他/她选择“否”按钮时，布尔值是设置为假。

这是我班级的代码：

```
private class YesOrNoRadioButtonGroup {

private static final String YES = "yes";
private static final String NO = "no";
private Button m_yesButton;
private Button m_noButton;

public YesOrNoRadioButtonGroup(final Composite p_parent,
                               final String p_questionText,
                               final IObservableValue p_modelProperty
                               final DataBindingContext p_dbContext) 
{

  Composite radioButtonGroupContainer = new Composite(p_parent, SWT.NONE);
  radioButtonGroupContainer.setLayout(new GridLayout());
  Label question = new Label(radioButtonGroupContainer, SWT.NONE);
  question.setText(p_questionText);

  m_yesButton = new Button(radioButtonGroupContainer, SWT.RADIO);
  m_yesButton.setText(YES);

  m_noButton = new Button(radioButtonGroupContainer, SWT.RADIO);
  m_noButton.setText(NO);
  m_noButton.setSelection(true);

  Listener yesOrNoRadioGroupListener = new Listener() {

    public void handleEvent(Event p_event) {

      Button button = (Button) p_event.widget;

      if (m_yesButton.equals(button)) {
        m_yesButton.setSelection(true);
        m_noButton.setSelection(false);
      }
      else {
        m_yesButton.setSelection(false);
        m_noButton.setSelection(true);
      }
    }
  };

  m_yesButton.addListener(SWT.Selection, yesOrNoRadioGroupListener);
  m_noButton.addListener(SWT.Selection, yesOrNoRadioGroupListener);

  p_dbContext.bindValue(SWTObservables.observeSelection(this.getYesButton()),
      p_modelProperty, null, null);      
}

public Button getYesButton() {
  return m_yesButton;
}

public Button getNoButton() {
  return m_noButton;
}    

} 
```

现在，如您所见，我将“是”按钮绑定到布尔值。具体来说，该值将绑定在 SWT.selection 事件上。这似乎是绑定单选按钮的唯一有效事件。然而，正因为如此，一旦选择了“否”按钮，布尔值保持不变（因为没有触发“是”按钮上的 SWT.selection 事件）。

我该怎么做才能使这项工作按预期的方式工作，即能够根据用户选择的按钮来更改模型中布尔值的值？我在这里遗漏了一些明显的东西吗？谢谢！

* * *

## 回答 #1

> 赞同：7
> 
>             
> 
> 时间：2009-03-17T09:43:11.830

这似乎类似于将[POJO 绑定到属性](http://dev.eclipse.org/newslists/news.eclipse.platform.swt/msg44044.html)。

这意味着你应该有一个对象，你的两个按钮实现一个[IObservable](http://help.eclipse.org/stable/index.jsp?topic=/org.eclipse.platform.doc.isv/reference/api/org/eclipse/core/databinding/observable/IObservable.html)，然后将它绑定到你的属性。

正如您在评论中提到的，您应该扩展[**AbstractObservable**](http://help.eclipse.org/stable/index.jsp?topic=/org.eclipse.platform.doc.isv/reference/api/org/eclipse/core/databinding/observable/IObservable.html)。

你在这里有一个这样的扩展的例子，[这个类测试](http://www.eclipsezone.com/eclipse/forums/t107345.html)关于一个可观察的列表（不是你需要的，但它可以给你关于使用 Observable 的想法来检测通知的变化）

* * *

## 回答 #2

> 赞同：7
> 
>             
> 
> 时间：2013-02-28T14:30:58.413

我想我找到了最合适的实现。您需要使用**org.eclipse.core.databinding.observable.value.SelectObservableValue**。这是代码

```
class YesNoModel{
   public static enum RESPONSE {YES,NO};
   private RESPONSE value;
   public RESPONSE getValue(){return value;}
   public void setValue(RESPONSE value){this.value = value;}
}
class YouGraphicalClass {
   YesNoModel yesNomodel  = new YesNoModel();
   void iniDataBinding(){
        IObservableValue yesBtnSelection  = SWTObservables.observeSelection(this.getYesButton());
        IObservableValue noBtnSelection  = SWTObservables.observeSelection(this.getNoButton());
        SelectObservableValue featureRepoPolicyObservable = new SelectObservableValue(YesNoModel.RESPONSE.class);
        featureRepoPolicyObservable.addOption(RESPONSE.YES, yesBtnSelection);
        featureRepoPolicyObservable.addOption(RESPONSE.NO, noBtnSelection);
        p_dbContext.bindValue(featureRepoPolicyObservable,
                PojoObservables.observeValue(yesNomodel, "value"));
    } 
```

这当然适用于所有类型的枚举或其他类型的可选值。您当然可以使用 String YES 和 NO，但我更喜欢枚举

* * *

## 回答 #3

> 赞同：2
> 
>             
> 
> 时间：2009-07-29T16:12:53.493

同一组合中的单选按钮将作为一个组，因此，只有一个按钮将具有真值，而所有其他按钮都应具有假值。除了这个事实，Yes Button 上的 observeSelection 应该足以反映模型属性侧选择的 yes 或 no 的值。

或者换句话说，修改后的构造函数看起来像这样。

```
public YesOrNoRadioButtonGroup(final Composite p_parent,
            final String p_questionText,
            final IObservableValue p_modelProperty,
            final DataBindingContext p_dbContext) 
{
    Composite radioButtonGroupContainer = new Composite(p_parent, SWT.NONE);
    radioButtonGroupContainer.setLayout(new GridLayout());
    Label question = new Label(radioButtonGroupContainer, SWT.NONE);
    question.setText(p_questionText);

    m_yesButton = new Button(radioButtonGroupContainer, SWT.RADIO);
    m_yesButton.setText(YES);
    m_noButton = new Button(radioButtonGroupContainer, SWT.RADIO);
    m_noButton.setText(NO);
    m_noButton.setSelection(true);
    p_dbContext.bindValue(SWTObservables.observeSelection(this.getYesButton()),
                p_modelProperty, null, null);   
} 
```

我试过了，发现效果很好。只需检查一下。

* * *

## 回答 #4

> 赞同：2
> 
>             
> 
> 时间：2010-12-09T23:12:34.383

如果使用[Nebula RadioGroup](http://eclipse.org/nebula/widgets/radiogroup/radiogroup.php)控件，您可以使用 RadioGroupViewer 并像任何其他查看器一样绑定查看器选择，例如 ComboViewer

* * *

## 回答 #5

> 赞同：0
> 
>             
> 
> 时间：2012-09-17T23:00:29.833

这是我在将单选按钮映射到枚举时得到的结果（我将继续并使其在我们的项目中可重用） - 使用 ISWTObservableValue 可以节省添加侦听器的工作：

```
 final ISWTObservableValue upload = SWTObservables.observeSelection(btnUpload);
    final ISWTObservableValue download = SWTObservables.observeSelection(btnDownload);
    final ISWTObservableValue noTransfer = SWTObservables.observeSelection(btnNoTransfer);
    final IObservableValue btns = new ComputedValue(ExecutableTransferModes.class) {

        @Override
        protected void doSetValue(final Object value) {
            boolean u = false, d = false, n = false;
            switch ((ExecutableTransferModes) value) {
            case Upload:
                u = true;
                break;
            case Download:
                d = true;
                break;
            case Notransfer:
                n = true;
                break;
            }
            upload.setValue(u);
            download.setValue(d);
            noTransfer.setValue(n);
        }

        @Override
        protected Object calculate() {
            if (Boolean.TRUE.equals(upload.getValue())) {
                return ExecutableTransferModes.Upload;
            } else if (Boolean.TRUE.equals(download.getValue())) {
                return ExecutableTransferModes.Download;
            } else if (Boolean.TRUE.equals(noTransfer.getValue())) {
                return ExecutableTransferModes.Notransfer;
            } else {
                return null;
            }
        }
    };
    bindingContext.bindValue(btns, uploadProperty); 
```

* * *

## 回答 #6

> 赞同：0
> 
>             
> 
> 时间：2015-06-28T05:40:27.050

这应该不费吹灰之力，我们都知道这是最好的答案，对吧？

```
public static final void createAndBind(
    final DataBindingContext dbc, 
    final Composite parent,
    final Object bean, 
    final List<Object> options, 
    final String fieldName, 
    final Class<?> fieldType) {
    //
    List<Button> radios = new ArrayList<>();
    Button b;
    for (Object option : options) {
        b = new Button(parent, SWT.RADIO);
        b.setText(option.toString());
        b.setLayoutData(new GridData(GridData.FILL_HORIZONTAL));
        radios.add(b);
    }
    //
    List<IObservableValue> iovs = new ArrayList<>();
    IObservableValue iov;
    for (Button radio : radios) {
        iov = SWTObservables.observeSelection(radio);
        iovs.add(iov);
    }
    SelectObservableValue observable = new SelectObservableValue(fieldType);
    //
    for (int i = 0; i < options.size(); i++) {
        observable.addOption(options.get(i), iovs.get(i));
    }
    //
    dbc.bindValue(observable, PojoObservables.observeValue(bean, fieldName));
} 
```

# asp.net-mvc - ASP.NET MVC RC2 - 为什么我不能使用正常的验证选项？例如RequiredFieldValidator

> ID：650966
> 
>         
> 
> 赞同：8
> 
>         
> 
> 时间：2009-03-16T15:42:07.657
> 
>         
> 
> 标签：asp.net-mvc, validation

我正在尝试验证基本表单，我可以不使用标准验证控件吗？我正在寻找的每个地方似乎都在尝试使用类似下面的东西

```
<%= Html.ValidationSummary() %>

<% using (Html.BeginForm()) {%>

    <fieldset class="fields">
        <legend>Create New Contact</legend>
        <p>
            <label for="task">Task Name:</label>
            <%= Html.TextBox("task") %>
            <%= Html.ValidationMessage("task", "*") %>
        </p>
        <p class="submit">
            <input type="submit" value="Create" />
        </p>
    </fieldset>

<% } %> 
```

我认为我可以使用标准组件吗？任何指针都会很棒！

* * *

## 回答 #1

> 赞同：9
> 
>             
> 
> 时间：2009-03-16T15:49:41.880

ASP.NET MVC 使用与常规 ASP.NET 完全不同的理念；因此，除了一些小例外，几乎没有 ASP.NET 控件（等）可以在 ASP.NET MVC 中工作。除此之外，页面生命周期中他们通常做某事的点**根本不存在**。

有一些方法可以做到这一点，例如在[jQuery 验证插件中](http://bassistance.de/jquery-plugins/jquery-plugin-validation/)，或者通过使用`IDataErrorInfo`等。

请注意，如果您在客户端进行验证，您仍然必须（单独）在服务器上进行验证。那些讨厌的浏览器不能被信任；-p

* * *

## 回答 #2

> 赞同：3
> 
>             
> 
> 时间：2009-03-16T15:47:38.517

ASP.NET MVC 取消了大多数经典的 ASP.NET 控件，因为该框架不支持将这些控件注入您的页面以使其正常工作的许多疯狂的东西。viewstate 和晦涩难懂的 javascript 函数之类的东西随处可见。

* * *

## 回答 #3

> 赞同：3
> 
>             
> 
> 时间：2009-03-16T15:48:52.443

你所说的验证器属于 webforms 和 webcontrols 的领域。在 ASP.NET MVC 中，您在视图中所做的只是生成纯 HTML。Valdiators 本质上是标签 web 控件，需要不再可用的视图状态。

* * *

## 回答 #4

> 赞同：2
> 
>             
> 
> 时间：2009-03-16T17:43:42.543

ASP.NET 验证器不再工作，但已经完成了一些工作来简化任务。例如，我使用了[xVal](http://xval.codeplex.com/)，它完成了一项体面的任务，甚至与 JQuery 验证集成，但我建议您在使用类似的东西之前了解验证的工作原理。

简而言之，ViewData 中有一个错误集合，其中包含两个集合，一个引用每个表单字段，另一个是与它们关联的错误列表。这是在绑定时或手动填充的，如果有一些错误，它们可以显示在摘要中或字段旁边（为此目的使用 html 帮助程序）。

框架自动填充集合并可以将验证规则转换为客户端脚本，但本质是学习验证如何在 MVC 中工作。

* * *

## 回答 #5

> 赞同：0
> 
>             
> 
> 时间：2009-03-17T11:41:21.470

没有我知道的组件。您将不得不像这样自己进行验证（或使用[updatemodel](http://davidhayden.com/blog/dave/archive/2008/09/08/ASPNETMVCUpdateModelTryUpdateModelDataBinding.aspx)等）

```
 if (String.IsNullOrEmpty(username))
    {
        ModelState.AddModelError("username", "You must specify a username.");
    } 
```

然后返回到您的编辑表单，Modelstate 错误将出现在验证摘要中。

[那里有像 xval 这样](http://blog.codeville.net/2009/01/10/xval-a-validation-framework-for-aspnet-mvc/)的验证框架，不确定这是否是您正在寻找的？

# flash - 有没有免费的工具来制作 Flash 应用程序？

> ID：650969
> 
>         
> 
> 赞同：10
> 
>         
> 
> 时间：2009-03-16T15:42:39.543
> 
>         
> 
> 标签：flash

我有一个现有的 javascript/flash -interaction kludge 非常糟糕。现在我决定编写一个不需要与 javascript 交互就可以完成特定事情的 flash 应用程序会更好。

因此，我需要在 linux 中制作 flash 应用程序，而且我现在没有钱投入 adobe（如果他们的软件一直很糟糕，也许永远不会）。也不打算在 Windows 上进行软件开发，一直在那里，结论：这永远不会很好地工作。

那么，有什么解决办法吗？免费还是开源？

* * *

## 回答 #1

> 赞同：8
> 
>             
> 
> 时间：2009-03-16T16:06:42.730

[Flex SDK](http://www.adobe.com/products/flex/flexdownloads/#sdk)应该是要走的路。您唯一会错过的是图形 IDE。不幸的是，最好的开源 Flash IDE [FlashDevelop](http://www.flashdevelop.org)仅适用于 Windows。

替代方案是[OpenLaszlo](http://www.openlaszlo.org)。它是一种成熟且强大的技术，您可以使用它开发复杂的 Flash 应用程序或 RIA。它具有自己的布局标记语言，实际上学习速度非常快且功能强大。额外的好处是，您可以编译为 SWF/Flash 或 DHTML，最终结果完全相同。很花哨。

您可能还想尝试[Haxe](https://haxe.org/)，这是一种相对较新的语言，其语法与 ActionScript/ECMAScript 相似，可以输出为多种不同的格式，例如 SWF、Javascript、PHP 和 C++。最近它非常炒作。绝对值得检查。

关于其他 Flash/OpenSource 相关的项目和工具，可以查看[Open source Flash](http://osflash.org/)站点

* * *

## 回答 #2

> 赞同：3
> 
>             
> 
> 时间：2009-03-16T15:49:16.453

如果您不需要 Flash GUI 功能，您可以查看 Adob​​e 的免费[Flex](http://www.adobe.com/products/flex/)开发人员工具。他们生成 SWF 文件。

* * *

## 回答 #3

> 赞同：2
> 
>             
> 
> 时间：2009-03-16T15:46:02.187

程序化：MING - [http://www.libming.org/](http://www.libming.org/)

* * *

## 回答 #4

> 赞同：0
> 
>             
> 
> 时间：2009-03-16T17:15:26.947

您可能想查看[OSFlash 站点](http://osflash.org/)以获取一些针对 actionscript 的操作系统解决方案。在那里您还会发现对[MTasc AS 编译器](http://www.mtasc.org/)及其[继任者 haxe](http://haxe.org/)的引用（后者从未尝试过）。

# java - 没有 Node.getTextContents() 的 Java XML 节点编辑

> ID：650970
> 
>         
> 
> 赞同：1
> 
>         
> 
> 时间：2009-03-16T15:42:57.560
> 
>         
> 
> 标签：java, xml, dom

我正在使用旧版本的 JRE (1.4)，其中 Node.getTextContents() 和 Node.setTextContents() 不可用。这些行动还有很长的路要走吗？

示例 XML：

```
<MyEle>4119<MyEle/> 
```

爪哇：

```
//myEleNode is a Node found while traversing
String nodeString = myEleNode.getTextContent();
if(nodeString.equals("4119")){//do something} 
```

* * *

## 回答 #1

> 赞同：3
> 
>             
> 
> 时间：2009-03-16T15:50:05.373

文本是 MyEle 元素的子节点，因此您可以使用如下内容：

```
MyEle.getFirstChild().getNodeValue() 
```

* * *

## 回答 #2

> 赞同：1
> 
>             
> 
> 时间：2009-03-16T15:52:19.347

您将不得不遍历孩子，检查他们的类型是否为文本（`node.getNodeType() == Node.TEXT_NODE)`然后使用`node.getNodeValue()`.

# java - 什么时候应该在我的 ColdFusion 应用程序中使用 Java？

> ID：650973
> 
>         
> 
> 赞同：3
> 
>         
> 
> 时间：2009-03-16T15:43:36.123
> 
>         
> 
> 标签：java, coldfusion

问题的回答者当然知道，ColdFusion 是一个 Java EE 应用程序，可以访问所有底层 Java 类，支持 JSP 自定义标签库等。但我想知道的是*什么时候*用 Java 编写代码，将其编译为JAR，并在 CFML 中引用它。

这一切都是在使用 Fusebox、Mach-II 或 Model-Glue 等框架编写的 CF MVC 应用程序的上下文中进行的。

* * *

## 回答 #1

> 赞同：6
> 
>             
> 
> 时间：2009-03-16T17:13:02.633

我可以看到跳入 Java 的三个明显原因：

*   当现有的 Java 功能可以满足您的需求时（不要重新发明轮子）。

*   当 Java 可以做一些比 CF 更好（或不同）的事情时。

*   如果您确定了使用 Java 可以解决的性能问题。

但总的来说，我不会编写*新的*Java 代码以在 CF 中使用——我会寻找已经得到更多证明的现有类。

* * *

## 回答 #2

> 赞同：2
> 
>             
> 
> 时间：2009-03-16T16:04:05.480

理想情况下，你想构建一个 JAR，永远不要。  

如果您可以摆脱从 cfml 进行 java 调用，请改为这样做，或者编写一个 cfc 来为您处理它。    

如果您需要构建的自定义 java 功能尚不存在，则构建一个 JAR。

我的一个例子是在 Coldfusion 中生成条形码。我本可以为出色的 Barbeque 包编写一个 java 包装器。相反，我创建了一个 CFC，然后偶然发现了一个已经建成的。

Java 的美妙之处在于很少有问题是原创的或独特的。很有可能我们的问题已经解决了。Java 已经为它构建了数量惊人的库。

我可能误解了某句话。

* * *

## 回答 #3

> 赞同：2
> 
>             
> 
> 时间：2009-03-17T09:49:44.453

我想了一段时间，对于一个大型 CF 应用程序，你应该从后面开始构建，在 java 中向前。

我认为 CF 在两件事上非常有用。RAD 和构建 HTML 页面。它不是通用语言。

如果您有广泛的业务逻辑，那么我认为您应该在 java 中构建它（或在 CFC 中构建 RAD，然后将它们用作 java 的包装器）。Web 前端只是业务逻辑的一个外观。您可能会发现诸如计费和库存控制之类的东西与其他前端一起工作得更好。在java中拥有系统的核心允许这样做。

CF 是一种越来越小众的技术。CF 开发人员很难找到。虽然我认为它是一门很棒的语言，但我认为从商业角度来看，在 CF 中构建一个大型应用程序可能会浪费金钱。将大部分应用程序保留在 Java 中可以让您从更大的开发人员池中招聘，并为应用程序的大部分提供未来证明。

* * *

## 回答 #4

> 赞同：1
> 
>             
> 
> 时间：2009-03-19T22:03:22.987

我们有一个旧的 CF6.1 应用程序，其中嵌入了 java。迁移到较新的 CF 版本非常痛苦，因为埋藏的 java.lang.

所以我说不要在 Coldfusion 应用程序中使用你自己的 java。

* * *

## 回答 #5

> 赞同：1
> 
>             
> 
> 时间：2009-03-26T19:34:15.537

最好的答案是，这取决于您的具体情况。您的员工在 CF 和 Java 方面的技能是什么？谁在设计和建筑方面更强？预期的代码是什么？您是否希望做一些在 Java 中更容易做的事情？您是否正在重用其他地方已经用 Java 编写的业务逻辑？我不会打算将应用程序的代码分解为两种语言。在需要之前不要引入复杂性。

# css - CSS下拉菜单被照片隐藏

> ID：650974
> 
>         
> 
> 赞同：0
> 
>         
> 
> 时间：2009-03-16T15:44:09.507
> 
>         
> 
> 标签：css, drop-down-menu, z-index

[链接文本](http://autoglass-plus.com/dev/)

上面的链接是一个测试站点。顶部导航栏中标题为“服务”的按钮似乎隐藏在 IE 而不是 Firefox 中。其他人看到它隐藏在照片后面吗？

谢谢！

* * *

## 回答 #1

> 赞同：1
> 
>             
> 
> 时间：2009-03-16T15:48:23.507

尝试分配 z-index: 1000; 到弹出 div 的 CSS 样式。

# python - 是否可以使用 Python 标准库（例如 2.5 版）执行参数化的 MS-SQL 查询？

> ID：650979
> 
>         
> 
> 赞同：2
> 
>         
> 
> 时间：2009-03-16T15:44:47.400
> 
>         
> 
> 标签：python, sql, binding, parameters, sql-injection

虽然我现在使用的特定数据不会是用户生成的，并且会在我通常的验证例程中对其生命周期的一英寸内进行清理，但我想学习如何进行基本的 INSERT、SELECT 等操作。 SQL查询同时保护自己免受SQL注入攻击，仅供参考。我宁愿通过参数化查询学习如何以“正确”的方式做事。

消毒总是好的，但我将我可怜的智力与经验丰富的黑客相提并论。手动转义意味着我可能忽略了一些事情，因为黑名单不如白名单强大。为了进一步澄清，我并不是说使用`(%s)`符号作为参数传递来构建可能名为`sqlstatement`. 我认为我需要知道的神奇词汇之一是“绑定”。

我也希望避免 Python 标准库之外的任何内容。

有问题的应用程序需要 Microsoft SQL 2005（如果相关）。我正在使用 ActiveState Python 以及模块 dbi 和 odbc。因为这是别人的数据库，所以存储过程已经出来了。

* * *

## 回答 #1

> 赞同：5
> 
>             
> 
> 时间：2009-03-16T15:55:32.460

[PEP 249 (DB API 2.0)](http://www.python.org/dev/peps/pep-0249/)定义了 5 个参数样式，[PyMSSQL](http://pymssql.sourceforge.net/)使用 paramstyle == pyformat。但是虽然看起来像字符串插值，**但实际上是绑定**的。

**注意绑定**之间的区别：

```
cur.execute('SELECT * FROM persons WHERE salesrep=%s', 'John Doe') 
```

和插值（这是**不**应该这样做的）：

```
cur.execute('SELECT * FROM persons WHERE salesrep=%s' % 'John Doe') 
```

另见[http://wiki.python.org/moin/DbApiFaq](http://wiki.python.org/moin/DbApiFaq)

* * *

> “我也希望避免 Python 标准库之外的任何东西。”

你在这里不走运。Python 中内置的唯一 RDBMS 驱动程序是 SQLite。

* * *

## 回答 #2

> 赞同：2
> 
>             
> 
> 时间：2009-03-16T16:37:49.550

试试[pyodbc](http://code.google.com/p/pyodbc/)

但是，如果您想让事情变得非常简单（加上大量强大的功能），请查看[sqlalchemy](http://www.sqlalchemy.org/)（顺便说一下，它使用 pyodbc 作为 mssql 的默认“驱动程序”）

# dll - 如何正确安装 msvcr71.dll

> ID：650982
> 
>         
> 
> 赞同：6
> 
>         
> 
> 时间：2009-03-16T15:45:38.067
> 
>         
> 
> 标签：dll, windows-server-2003

我如何在 Windows Server 2003 上安装我的软件所需的 msvcr71.dll。我真的不想把这个 dll 复制到 system32 文件夹，因为它可能会破坏这个目标系统。

* * *

## 回答 #1

> 赞同：1
> 
>             
> 
> 时间：2009-03-16T15:47:04.040

只需将其复制到程序的所有可执行文件所在的文件夹中即可。这是标准做法。搜索库从请求的可执行文件所在的目录开始，因此除非使用带有 LOAD_WITH_ALTERED_SEARCH_PATH 的 LoadLibraryEx()，否则它将正常工作。

* * *

## 回答 #2

> 赞同：-1
> 
>             
> 
> 时间：2014-07-13T11:09:05.327

不要将 .dll 复制到 System32 文件夹。如果它还没有在应用程序的文件夹中，那么也不要将它复制到那里！（这样做会阻止您从 Microsoft 获得安全更新和补丁）。相反，只需安装[Microsoft Visual C++ 2003 Redistributable（包含在 .NET 1.1 Runtime 中）](https://stackoverflow.com/questions/1596167/where-to-download-microsoft-visual-c-2003-redistributable/6132093#6132093)。

# django - 在 Django 中，如何遍历需要参数的自定义模板标签的结果？

> ID：650986
> 
>         
> 
> 赞同：4
> 
>         
> 
> 时间：2009-03-16T15:46:16.820
> 
>         
> 
> 标签：django, arguments, templatetags

如果我创建了模板标签：

```
@register.simple_tag
def last_books(a_cat, cutoff=5):
    objects = Books.objects.filter(category=a_cat)
    return objects[:cutoff] 
```

我怎样才能在我的模板中做这样的事情：

```
{% for book in last_books 'Sports' 3 %} 
```

我目前收到此错误：

> 'for' 语句应使用格式 'for x in y': for x in last_books 'Sports' 3

* * *

## 回答 #1

> 赞同：9
> 
>             
> 
> 时间：2009-03-16T17:21:58.290

就个人而言，我只是通过视图将书作为上下文变量传递。这样你就不需要模板标签了。

或者，您可以改用 contains_tag 装饰器，它包含了将带有自定义上下文的包含模板呈现到当前文档中的想法。

但是如果你想继续当前的路径，`simple_tag`装饰器不是要走的路。当您需要将`string`要直接呈现到模板中的内容返回时使用。您要做的是设置模板上下文变量。这有点涉及，但不是太难。创建一个类似这样的节点：

```
class LastBooksNode(template.Node):
    def __init__(self, category, cutoff=5, var_name='books'):
        self.category = category
        self.cutoff = cutoff
        self.var_name = var_name
    def render(self, context):
        context[self.var_name] = Books.objects.filter(category=self.category)[:self.cutoff]
        return ''

@register.tag(name='last_books')
def do_last_books(parser, token):
    error = False
    try:
        tag_name, category, cutoff, _as, var_name = token.split_contents()
        if _as != 'as':
            error = True
    except:
        error = True

    if error:
        raise TemplateSyntaxError, 'last_books must be of the form, "last_books <category> <cutoff> as <var_name>"'
    else:
        return LastBooksNode(a_cat, cutoff, var_name) 
```

然后，您将调用模板标记：

```
{% import <your tag library> %}
{% last_books 'category' 5 as my_books %}
{% for book in my_books %}
    ....
{% endfor %} 
```

未经测试，但我希望这能证明这个想法。但是，如上所述，如果您不打算在多个地方重用它，那么通过上下文直接将书籍传递给视图或使用包含标签可能会更容易。

* * *

## 回答 #2

> 赞同：3
> 
>             
> 
> 时间：2009-03-16T15:49:45.813

为什么不[与](http://docs.djangoproject.com/en/dev/ref/templates/builtins/?from=olddocs#with)？

# objective-c - Cocoa - 用于调试 Xcode 和 Interface Builder 之间的绑定问题的建议技术

> ID：650989
> 
>         
> 
> 赞同：10
> 
>         
> 
> 时间：2009-03-16T15:47:20.310
> 
>         
> 
> 标签：objective-c, cocoa, interface-builder

我正在研究 Hillegass 的“Mac OS-X 的 Cocoa 编程”一书中的示例。有几次我一直在处理的示例应用程序启动时，我收到一条消息，例如：

> 2009-03-11 00:39:19.167 CarLot [7517:10b] 无法从 _NSControllerObjectProxy 类的对象 <_NSControllerObjectProxy: 0x188bf0> 创建 NSData

我发现解决此类问题的唯一方法是煞费苦心地检查界面构建器中的所有绑定和属性，以查看我错过了一些配置的位置——这一切都需要时间！

有没有更有效的方法可以从错误消息中确定问题所在？是否有任何调试技术可以用来追踪此类问题？

* * *

## 回答 #1

> 赞同：13
> 
>             
> 
> 时间：2010-01-23T06:57:14.657

Apple 的 Dev Site 上有一篇精彩的文章，介绍了绑定故障排除。

[https://developer.apple.com/library/archive/documentation/Cocoa/Conceptual/CocoaBindings/Concepts/Troubleshooting.html](https://developer.apple.com/library/archive/documentation/Cocoa/Conceptual/CocoaBindings/Concepts/Troubleshooting.html)

关键外卖？有一个设置`NSBindingDebugLogLevel`，您可以使用它来获取调试信息。

两种设置方法：

1 - 永久保存在您的默认值中

> 默认写入 com.yourdomain.yourapplication NSBindingDebugLogLevel 1

2 - 调试时将其作为参数传递

> path/to/your/app -NSBindingDebugLogLevel 1

* * *

## 回答 #2

> 赞同：3
> 
>             
> 
> 时间：2009-03-17T05:07:52.773

[本文](http://speirs.org/2007/12/05/what-are-xib-files/)非常简要地讨论了这一点。

基本上，它表明您可以查看 Xib 文件以更快地找出您在应用程序中设置的绑定。

希望有帮助！

* * *

## 回答 #3

> 赞同：1
> 
>             
> 
> 时间：2009-03-16T18:24:24.893

除了在 Interface Builder 本身中之外，我不确定是否有一种方法可以获取您设置的绑定和属性的摘要。据我所知，这是显示此信息的唯一 gui。您可以尝试在调试器中运行您的应用程序并打破异常 (-[NSException raise]) 以查看您是否至少可以跟踪哪个对象给您此错误，这可能有助于您在 IB 中找到错误的连接。

如果您的应用程序足够小并且构建速度很快，并且您刚刚开始使用 IB 和绑定，我建议您建立一个连接并对其进行测试以查看它是否有效，然后继续进行下一个连接。这样，您将知道哪个连接或属性导致了问题。

我希望有人有比这更好的答案，但据我所知，没有工具可以验证和查明 IB 连接问题。

* * *

## 回答 #4

> 赞同：0
> 
>             
> 
> 时间：2009-03-17T08:58:48.957

如果您以编程方式进行绑定而不是在 interfacebuilder 中进行绑定怎么办？

为此，您必须使用 NSObject 的这个方法：

`- (void)bind:(NSString *)binding toObject:(id)observableController withKeyPath:(NSString *)keyPath options:(NSDictionary *)options`

* * *

## 回答 #5

> 赞同：0
> 
>             
> 
> 时间：2009-04-06T05:32:54.417

起初我没有注意到的一件事是，如果您查看对象的连接检查器，它会显示一个很好的列表，其中列出了它所绑定的所有内容，如果您将鼠标悬停在一个项目上，它会突出显示其对应的元素。

当您再次将某些内容绑定到表格列时，这很好。

# mysql - MySQL/Django 中的部分空日期

> ID：650997
> 
>         
> 
> 赞同：4
> 
>         
> 
> 时间：2009-03-16T15:48:30.527
> 
>         
> 
> 标签：mysql, django, date

我目前正在将我的网站从 PHP 转换为 Django，但由于我是 Python 新手，我正在努力解决一些问题。

有时我的数据库中有不完整的日期（即我可能不知道日期甚至月份），所以目前有三个整数字段`date_year`：`date_month`和`date_day`。

我注意到 MySQL 接受了“部分空”`date`字段（例如 2004-04-00、1994-00-00），但 Django 只是将它们视为“完全”空。

我只想以以下格式显示这些日期：

*   `16 March 2009`（完全知道）

*   `March 2009`（未知日期）

*   `2009`（未知日期和月份）

我认为我将无法`date`在 MySQL 中使用正确的字段，并且我必须`date`在模型中创建一个仿制品，然后使用自定义模板过滤器；有人能帮忙吗？

* * *

## 回答 #1

> 赞同：3
> 
>             
> 
> 时间：2009-03-16T19:20:19.020

您可以将两个日期时间存储为一个范围。如果午夜到午夜的意思是“这一天的某个时候”，并且如果范围是整个月，那就是你所知道的。如果你知道确切的时间，他们将是平等的。

* * *

## 回答 #2

> 赞同：1
> 
>             
> 
> 时间：2009-03-16T16:27:25.847

当 MySQL 在[ALLOW_INVALID_DATES](http://dev.mysql.com/doc/refman/5.1/en/server-sql-mode.html#sqlmode_allow_invalid_dates)模式下运行时，它不对输入执行任何验证检查，因此您可以存储无效日期。这是标准 SQL 的扩展，因为 Django 是跨数据库兼容的，所以不支持它。此外，Django 将日期转换为也不支持部分日期的 Python 日期对象。

您最好的选择是将列一分为三，或者将日期存储为文本并自行处理。

* * *

## 回答 #3

> 赞同：1
> 
>             
> 
> 时间：2009-03-17T02:19:49.930

我正在寻找类似问题的解决方案，但使用的是 PostgreSQL。

[PostgreSQL 中的模糊日期匹配](http://www.electricwords.org/2008/11/fuzzy-date-matching-in-postgresql/)

也许你可以适应这样的东西？这有点离谱，我知道。`` 
```*********