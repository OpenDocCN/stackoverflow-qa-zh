# StackOverflow 问答 000143000-000143999

# c++ - Why does my MFC app hang when I throw an exception?

> ID：143006
> 
> 赞同：4
> 
> 时间：2008-09-27T04:38:49.850
> 
> 标签：c++, windows, mfc

If you throw an exception from inside an MFC dialog, the app hangs, even if you have a catch block in your code. It refuses to respond to the mouse or keyboard, and the only way to shut it down is to use Task Manager.

### Why I'm posting this question

To my shame, there is a popular shrink-wrapped application that hangs every time it encounters an exceptional error in a modal dialog. When we made a massive shift from integer error codes to exceptions, I was responsible for choosing std::exception as the base class for the thrown exceptions. It wasn't until a huge amount of work went into the conversion that our testing uncovered this problem, and by then it was too late to change. Hopefully this question/answer will keep someone from making the same mistake.

* * *

## 回答 #1

> 赞同：8
> 
> 时间：2008-09-27T04:39:24.450

The code for CDialog::DoModal makes the dialog modal by disabling the parent window. When the dialog code returns, the window is reenabled. There is an explicit catch for CException* errors, but not for any other kind of thrown exception; thus the parent window never gets reenabled.

Change your code to throw a pointer to any exception derived from CException, and you'll fix the problem.

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2009-03-25T04:15:27.577

If you are interested in learning about how Windows detects apphangs we have added some posts to this on the Windows Error Reporting blog:

[Let there be hangs part 1 of 4](http://blogs.msdn.com/wer/archive/2009/03/19/let-there-be-hangs-part-1-not-responding.aspx)

[Let there be hangs part 2 of 4](http://blogs.msdn.com/wer/archive/2009/03/19/let-there-be-hangs-part-2-wer-history-101.aspx)

[Let there be hangs part 3 of 4](http://blogs.msdn.com/wer/archive/2009/03/19/let-there-be-hangs-part-3-the-hungapp-module.aspx)

[Let there be hangs part 4 of 4](http://blogs.msdn.com/wer/archive/2009/03/19/let-there-be-hangs-part-4-better-bucketing-in-windows-vista.aspx)

Important to note is that this information when sent through Microsoft's Windows Error Reporting gets communicated to the software developers to try and fix these issues. If you are sending in your error reports you WILL help fix issues that are occuring on your PC!

I am a Program Manager at Microsoft on the Windows Error Reporting team.

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2010-11-04T19:12:06.393

Mark's answer is correct. For a much more rigorous analysis of this problem and a detailed suggestion for dealing with it in your own code, see this [FAQ by Doug Harrison](https://web.archive.org/web/20110902181726/http://members.cox.net/doug_web/eh.htm) (section Q6 in particular).

# c# - 使用 WSDL.exe 生成 Web 服务代理时默认使用不同的 URL

> ID：143019
> 
> 赞同：0
> 
> 时间：2008-09-27T04:51:41.877
> 
> 标签：c#, asp.net, web-services, wsdl

我的项目中有许多共享类型的 Web 服务。

为简单起见，我将使用两个 Web 服务进行演示。

WebService1 在[http://MyServer/WebService.asmx](http://MyServer/WebService.asmx) webService2 在[http://MyServer/WebService.asmx](http://MyServer/WebService.asmx)

当我为这两个服务生成代理时，我使用：

wsdl /sharetypes [http://MyServer/WebService1.asmx](http://MyServer/WebService1.asmx) [http://MyServer/WebService2.asmx](http://MyServer/WebService2.asmx) /appsettingurlkey:WebServiceUrl /namespace:MyNamespace /out:MyProxy.cs

问题是代理文件中每个 Web 服务的 appsettingurlkey 都是相同的。我希望能够指定多个 appsettingurlkey 参数。这是如何实现的？我认为自从 /sharetypes 参数可用以来，应该有一个解决方案可以专门为每个识别的 Web 服务指定 appsettingurlkey。

如果 wsdl.exe 无法做到这一点，你会建议我做什么？我宁愿不更新 wsdl.exe 输出的生成代码，也不想通过将 Url 传递给 Web 服务的每个实例的整个应用程序。

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2008-09-28T10:59:57.537

生成的代理类是部分类，因此我的解决方案是在不同的（非生成的）代码文件中添加您自己的构造函数，该代码文件显式读取每个代理的不同设置。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2008-09-29T17:34:00.920

为了补充以利亚自己的回答，这是我给他的电子邮件回答。

我不得不写博客，因为 XML 没有很好地粘贴到这个文本框中：[http ://www.rickdoes.net/blog/archive/2008/09/29/wsdl-shared-types-and-configuration.aspx](http://www.rickdoes.net/blog/archive/2008/09/29/wsdl-shared-types-and-configuration.aspx)

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2008-09-29T16:35:26.457

啊，不是创建另一个带有在 Url 中传递的重载构造函数的部分类，而是 wsdl.exe 的以下附加参数将解决我的问题......

wsdl /sharetypes [http://MyServer/WebService1.asmx](http://MyServer/WebService1.asmx) [http://MyServer/WebService2.asmx](http://MyServer/WebService2.asmx) /appsettingurlkey:WebServiceUrl /namespace:MyNamespace /out:MyProxy.cs **/appsettingurlkey:BaseSoapUrl /appsettingbaseurl: [http://MyServer/](http://MyServer/)**

如果 web.config 有一个 BaseSoapUrl appSetting，那么它将使用它来替换 MyProxy.cs 中的[http://MyServer/](http://MyServer/)子字符串。如果 appSetting 不存在，那么它将只使用 wsdl.exe 中提供的路径（例如：使用 appSetting 时的 {BaseSoapUrl}/WebService1.asmx 或不使用 appSetting 时的[http://MyServer/WebService1.asmx](http://MyServer/WebService1.asmx)） .

感谢 Rick Kierner 为我指明了正确的方向。

# mathematical-optimization - Java 数学优化库——免费还是开源推荐？

> ID：143020
> 
> 赞同：15
> 
> 时间：2008-09-27T04:52:44.323
> 
> 标签：mathematical-optimization, linear-programming, cplex, gurobi, convex-optimization

有谁知道这样一个执行数学优化（线性规划、凸优化或更一般类型的问题）的库？我正在寻找类似 MATLAB 的东西，但它能够处理更大的问题。我是否必须编写自己的实现，或购买其中一种商业产品（CPLEX 等）？

* * *

## 回答 #1

> 赞同：11
> 
> 时间：2008-09-28T18:22:11.280

一个好的答案取决于您所说的“凸”和“更一般”的含义主要的商业求解器，[gurobi](http://www.gurobi.com)，[cplex](http://www.ilog.com/products/cplex)和[Dash](http://www.dashoptimization.com/home/cgi-bin/example.pl#bcl_java)，除非钱对你来说是个大问题。它们都有干净的 JNI 接口，并且在大多数主要平台上都可用。

[coin-or](http://www.coin-or.org)项目有几个优化器，并有一个 JNI 接口项目。它是完全免费的（[EPL](http://www.eclipse.org/legal/eplfaq.php)许可证），但需要更多的工作来设置并且可能不会给您相同的性能。

* * *

## 回答 #2

> 赞同：5
> 
> 时间：2008-09-28T15:23:50.897

有一个称为[lpsolve](http://sourceforge.net/projects/lpsolve)的线性优化工具。它是用 C 语言编写的（我认为），但带有一个 Java/JNI 包装器（API 不是很面向对象，但它可以完成工作）。它非常易于使用，去年我在实时系统中运行得非常愉快且稳定。

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2012-04-13T11:47:58.413

[OptaPlanner](http://www.optaplanner.org)（Java、开源、ASL）可以处理大型问题并且没有约束类型限制（例如线性与凸）。

* * *

## 回答 #4

> 赞同：2
> 
> 时间：2012-12-13T15:24:13.173

您可以尝试[JOptimizer](http://www.joptimizer.com)，开源并适用于一般凸优化问题（线性规划、二次规划、qcqp、锥规划、半定规划等

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2008-09-27T05:07:22.073

你可能想看看[JScience](http://jscience.org/)，它看起来很完整。（数学结构、线性代数求解等）

* * *

## 回答 #6

> 赞同：1
> 
> 时间：2013-05-09T15:47:51.750

IPOPT 有一个[Java 接口](https://projects.coin-or.org/Ipopt/wiki/JavaInterface)。您还可以将 APMonitor 建模语言用于 Java。我开发了这个平台，所以如果有人想为 Java 创建一个新接口，我会很高兴与他们合作。它已经拥有[Python API](http://apmonitor.com/wiki/index.php/Main/PythonApp)和 MATLAB 接口，并包括诸如 IPOPT、APOPT、BPOPT 等可以处理大型系统的求解器。

* * *

## 回答 #7

> 赞同：0
> 
> 时间：2008-09-27T17:18:17.683

查看[AMPL](http://www.AMPL.com "数学编程语言")。基本版是免费的，但遇到更大的问题需要花钱。您无需为语言付费；您为求解器付费。也可以上传您的代码并让它在他们的服务器上运行。

# c - 如何找到结构的大小？

> ID：143025
> 
> 赞同：30
> 
> 时间：2008-09-27T04:58:35.543
> 
> 标签：c, struct, sizeof

```
struct a
{
    char *c;
    char b;
}; 
```

什么是 sizeof(a)？

* * *

## 回答 #1

> 赞同：34
> 
> 时间：2008-09-27T05:13:06.863

```
#include <stdio.h>

typedef struct { char* c; char b; } a;

int main()
{
    printf("sizeof(a) == %d", sizeof(a));
} 
```

我在 32 位机器上得到“sizeof(a) == 8”。结构的总大小将取决于打包：在我的情况下，默认打包为 4，因此“c”占用 4 个字节，“b”占用一个字节，留下 3 个填充字节以将其带到下一个 4 的倍数: 8\. 如果你想改变这个包装，大多数编译器都有改变它的方法，例如在 MSVC 上：

```
#pragma pack(1)
typedef struct { char* c; char b; } a; 
```

给出 sizeof(a) == 5。如果这样做，请注意在任何库头文件之前重置打包！

* * *

## 回答 #2

> 赞同：9
> 
> 时间：2008-09-27T05:10:18.603

与其他一些答案所说的相反，在大多数系统上，在没有编译指示或编译器选项的情况下，结构的大小将至少为 6 个字节，在大多数 32 位系统上，为 8 个字节。对于 64 位系统，大小很容易达到 16 字节。对齐确实起作用了。总是。单个结构的大小必须使得可以分配具有这些大小的数组，并且数组的各个成员对于所讨论的处理器来说是充分对齐的。因此，如果结构的大小如其他人所假设的那样为 5，则由两个此类结构组成的数组将是 10 字节长，并且第二个数组成员中的 char 指针将在奇数字节上对齐，这将（在大多数情况下）处理器）导致性能的主要瓶颈。

* * *

## 回答 #3

> 赞同：5
> 
> 时间：2008-09-27T05:21:41.307

如果你想手动计算它，结构的大小只是考虑对齐后它的每个数据成员的大小。结构没有神奇的开销字节。

* * *

## 回答 #4

> 赞同：2
> 
> 时间：2008-09-27T05:09:58.043

确切的值是*sizeof(a)*。
您也可能冒险并假设在这种情况下不小于 2 且不大于 16。

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2008-09-27T05:04:36.107

这将取决于您的架构以及它如何处理基本数据类型。它还取决于系统是否需要自然对齐。

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2008-09-27T05:00:56.863

我假设您的意思是结构而不是严格，但在 32 位系统上，它将是 5 或 8 个字节，具体取决于编译器是否填充结构。

* * *

## 回答 #7

> 赞同：0
> 
> 时间：2008-09-27T05:02:58.480

我怀疑您的意思是“结构”，而不是“严格”，以及“字符”而不是“字符”。

大小将取决于实现。在大多数 32 位系统上，指针可能为 5 - 4 个字节，字符为 1 个字节。我不相信对齐会在这里发挥作用。但是，如果您交换了“c”和“b”，则大小可能会增长到 8 个字节。

好的，我试了一下（g++ 4.2.3，带有 -g 选项），我得到了 8。

* * *

## 回答 #8

> 赞同：0
> 
> 时间：2008-09-27T05:17:39.210

在 32 位系统上，结构的大小应该是 8 个字节，这样结构的大小就会变成 2 的倍数。这使得在声明结构数组时各个结构在正确的字节边界处可用。这是通过在结构末尾填充 3 个字节来实现的。

如果结构在 char 之后声明了指针，则它的大小仍为 8 字节，但将添加 3 字节填充以使指针（这是一个 4 字节元素）与 4 字节地址边界对齐。

经验法则是元素的偏移量应该是它们字节大小的倍数，并且结构本身的大小应该是 2 的倍数。

# vb6 - VB6 是否有等效的#pragma 包？

> ID：143032
> 
> 赞同：4
> 
> 时间：2008-09-27T05:02:52.770
> 
> 标签：vb6

我正在开发一个必须处理专有二进制协议的 TCP/IP 客户端。我正在考虑使用用户定义的类型来表示协议标头，并使用 CopyMemory 将数据与 UDT 和字节数组进行混洗。但是，VB6 似乎添加了填充字节来对齐用户定义的类型。有什么方法可以强制 VB6 不填充 UDT，类似于`#pragma pack`许多 C/C++ 编译器中可用的指令？也许是传递给编译器的特殊开关？

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2008-09-27T05:20:22.807

不。

最好的办法是用 C 或 C++（你有的地方`#pragma pack`）编写低级代码，然后通过 COM 公开接口。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2008-09-27T05:37:41.127

没有任何方法可以强制 VB6 不填充 UDT，类似于许多 C/C++ 编译器中可用的 #pragma pack 指令，但您可以反过来做。

根据 Q194609，Visual Basic 使用 4 字节对齐，Visual C++ 默认使用 8 字节。

当使用 VB6 调用 C DLL 时，我使用 MS “pshpack4.h” 头文件来处理对齐，因为各种编译器以不同的方式执行此操作，如下所示（经过编辑的）示例：

```
// 这是在一个名为 vbstruct.h 的头文件中
...

# 定义 VBSTRING 字符
# 定义 VBFIXEDSTRING 字符
# 定义 VBDATE 双精度
# 定义 VBSINGLE 浮点数

# ifdef _WIN32
# 定义 VBLONG 长
# 定义 VBINT 短
# else // 这是针对 16 位代码而不是 64 位的！！！！
# 定义 VBLONG 长
# 定义 VBINT 整数
＃ 万一
...

# 包括“pshpack4.h”
...

typedef struct VbComputerNameStruct
    {
    VBLONG 名称；
    VBSTRING 计算机名[VB_COMPUTERNAME_LENGTH];
    } VbComputerNameType;

typedef struct VbNetwareLoginInfoStruct
    {
    VBLONG 对象标识符；
    VBINT 对象类型；
    VBSTRING 对象名[48]；
    } VbNetwareLoginInfoType;
...

# 包括“poppack.h”

```

# c# - 在非焦点 ToolStripItem 上显示工具提示

> ID：143058
> 
> 赞同：8
> 
> 时间：2008-09-27T05:22:13.380
> 
> 标签：c#, .net, winforms, tooltip, toolstrip

当您将鼠标悬停在 ToolStripItems 上时，它们会显示活动突出显示，即使它们所在的表单不在焦点上也是如此。但是，除非表单获得焦点，否则它们不会显示工具提示。我见过[ToolStrip 'click-though' hack](http://blogs.msdn.com/rickbrew/archive/2006/01/09/511003.aspx)。任何人都知道如何让 ToolStripButton 在其父窗体不在焦点时显示其工具提示？

谢谢！

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2008-10-04T13:35:16.857

问题是 ToolStrip“控件”，如 ToolStripButton 或 ToolStripDropDownButton 不继承自 Control。现在我通过在用户将鼠标悬停在按钮上时聚焦 ToolStrip 来解决这个问题。按钮的 MouseHover 事件触发得太晚了——在“显示工具提示”代码运行之后，所以我扩展了 ToolStripDropDownButton 类并使用了我的新按钮。此方法应适用于从 ToolStripItem 继承的任何其他类似按钮的类

```
public class ToolStripDropDownEx : ToolStripDropDownButton
{
    public ToolStripDropDownEx(string text)
    {
    }

    protected override void OnMouseHover(EventArgs e)
    {
        if (this.Parent != null)
            Parent.Focus();
        base.OnMouseHover(e);
    } 
} 
```

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2008-09-28T08:29:14.637

也许这段代码中的两种方法之一会让你朝着正确的方向前进……

```
public Form1()
{
    InitializeComponent();

    tooltip = new ToolTip();
    tooltip.ShowAlways = true;
}

private ToolTip tooltip;
private void toolStripButton_MouseHover(object sender, EventArgs e)
{
    if (!this.Focused)
    {
        ToolStripItem tsi = (ToolStripItem)sender;
        tooltip.SetToolTip(toolStrip1, tsi.AutoToolTip ? tsi.ToolTipText : tsi.Text);
        /*tooltip.Show(tsi.AutoToolTip ? tsi.ToolTipText : tsi.Text, this, 
            new Point(toolStrip1.Left, toolStrip1.Bottom));*/
    }
}

private void toolStripButton_MouseLeave(object sender, EventArgs e)
{
    tooltip.RemoveAll();
} 
```

第一个问题是您不能直接将其设置为按钮，它不会从 Control 继承，并且工具提示不会显示，除非您在条上而不是在按钮上。

第二种（注释掉的方式）的问题是它根本不显示。不太清楚为什么，但也许你可以调试它。

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2012-01-19T21:07:13.283

我尝试了一些东西，发现这是最简单的

当我创建工具条按钮项目时，我向其悬停事件添加了一个事件处理程序：

```
private sub SomeCodeSnippet()

    Me.tooltipMain.ShowAlways = True

    Dim tsi As New ToolStripButton(String.Empty, myImage)
    tsi.ToolTipText = "my tool tip text"
    toolstripMain.Add(tsi)

    AddHandler tsi.MouseHover, AddressOf ToolStripItem_MouseHover

end sub 
```

然后是事件处理程序：

```
Private Sub ToolStripItem_MouseHover(ByVal sender As Object, ByVal e As System.EventArgs)

    If TypeOf sender Is ToolStripButton Then
        Me.tooltipMain.SetToolTip(Me.toolstripMain, CType(sender, ToolStripButton).ToolTipText)
    End If

End Sub 
```

这非常有效，尽管当您第一次将鼠标悬停在工具条上时，我确实注意到了一个微小的初始延迟

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2008-11-20T23:26:07.440

我试图做同样的事情，并确定这将非常具有挑战性并且不值得。原因是在内部，.NET 代码专门设计为仅在窗口处于活动状态时才显示工具提示 - 他们在 Win32 级别检查此内容，因此很难伪造代码。

这是 ToolTip.cs 中检查“GetActiveWindow()”并返回 false 的代码片段。您可以在代码中看到“工具提示应仅在活动 Windows 上显示”中的注释。

顺便说一句，您可以使用 Visual Studio 2008 查看 .NET BCL 的所有源代码，以下是我使用的说明：

[http://blogs.msdn.com/sburke/archive/2008/01/16/configuring-visual-studio-to-debug-net-framework-source-code.aspx](http://blogs.msdn.com/sburke/archive/2008/01/16/configuring-visual-studio-to-debug-net-framework-source-code.aspx)

```
// refer VsWhidbey 498263: ToolTips should be shown only on active Windows.
private bool IsWindowActive(IWin32Window window)
{ 
    Control windowControl = window as Control;
    // We want to enter in the IF block only if ShowParams does not return SW_SHOWNOACTIVATE. 
    // for ToolStripDropDown ShowParams returns SW_SHOWNOACTIVATE, in which case we DONT want to check IsWindowActive and hence return true. 
    if ((windowControl.ShowParams & 0xF) != NativeMethods.SW_SHOWNOACTIVATE)
    { 
        IntPtr hWnd = UnsafeNativeMethods.GetActiveWindow();
        IntPtr rootHwnd =UnsafeNativeMethods.GetAncestor(new HandleRef(window, window.Handle), NativeMethods.GA_ROOT);
        if (hWnd != rootHwnd)
        { 
            TipInfo tt = (TipInfo)tools[windowControl];
            if (tt != null && (tt.TipType & TipInfo.Type.SemiAbsolute) != 0) 
            { 
                tools.Remove(windowControl);
                DestroyRegion(windowControl); 
            }
            return false;
        }
    } 
    return true;
} 
```

# c# - pthread_cond_t 的 EventWaitHandle 行为

> ID：143063
> 
> 赞同：1
> 
> 时间：2008-09-27T05:30:46.977
> 
> 标签：c#, c, multithreading, data-structures, pthreads

我最近看到了 EventWaitHandle 在 C# 中的强大行为，并决定在姊妹应用程序中移动一些功能来做同样的事情。唯一的问题是姊妹应用程序是用 C 编写的。

没什么大不了的，我正在使用 pthreads，它有一个 pthread_cond_t 数据类型，允许发送信号。我唯一的问题是，是否有可能在等待它之前“发出信号”？

现在我的测试说不。也就是说，如果 ThreadA 在 ThreadB 等待之前触发了一个信号，那么 ThreadB 将无限期地等待。是否有另一种我可以使用的 pthread 类型更接近 C# 中 EventWaitHandle 的功能？一个对象是有信号的，这意味着第一个等待它的线程将立即通过，并将其设置为无信号。

将 pthread_cond 包装到另一个数据结构中并不难实现这一点。但同样，这个功能是否已经在 pthread 库中可用？

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2008-09-27T07:01:35.153

如果您正确使用条件变量，这无关紧要。

您的代码的基本流程应该是（在伪代码中）：

```
lock(lockobj);
while (!signalled) {
    wait(condvar);
}
signalled = false;
unlock(lockobj); 
```

在等待侧，并且：

```
lock(lockobj);
signalled = true;
notify(condvar);
unlock(lockobj); 
```

在信令方面。（当然，两侧使用的锁对象和条件变量必须相同。）希望这会有所帮助！

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2008-09-27T07:08:26.307

*如果您想要多个信号*（即，如果信号两次，则两个线程可以在状态再次取消信号之前等待）的替代答案（也在伪代码中）。

等待面：

```
lock(lockobj);
while (signalled != 0) {
    wait(condvar);
}
--signalled;
unlock(lockobj); 
```

信令端：

```
lock(lockobj);
++signalled;
notify(condvar);
unlock(lockobj); 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2008-09-29T02:57:17.627

我最终只是将条件类型包装在一个新结构中，并创建了一些简单的函数来表现得与 C# 中的 EventWaitHandle 非常相似。我需要两个互斥锁来实现正确的序列化访问。

cond_mutex 用于等待条件变量，而 data_mutex 用于将状态从有信号设置为无信号。

重置模式与 C# 相同。自动或手动。这允许 event_wait_t 在等待后自动重置。或者让程序员手动调用 event_wait_reset(event_wait_t *ewh);

# emacs - 在 Emacs 中，其他窗口（Cx o）的相反功能是什么？

> ID：143072
> 
> 赞同：32
> 
> 时间：2008-09-27T05:40:16.847
> 
> 标签：emacs

> **可能重复：**
> [Emacs，切换到上一个窗口](https://stackoverflow.com/questions/91071/emacs-switch-to-previous-window)

`other-window`使我前进到当前帧中的下一个窗口，但我还想要一种方法回到上一个窗口。

Emacs 有`next-buffer`和`previous-buffer`，但没有类似的窗口导航交互功能。只是`other-window`。

* * *

## 回答 #1

> 赞同：35
> 
> 时间：2008-09-27T05:53:04.897

`C-u -`使用（“Control+U”然后“减号”）或更简单的`C--`（“Control减号”）提供否定参数。

*   移至上一个窗口：`C-- C-x o`
*   移至上一帧：`C-- C-x 5 o`

从代码来看，`(other-window -1)`还是`(other-frame -1)`会做同样的事情。

查看您想要反转的键的帮助（例如`C-h k C-x o`显示帮助`C-x o`），如果它说“否定论点......”你知道你可以使用`C--`.

* * *

## 回答 #2

> 赞同：17
> 
> 时间：2011-02-25T12:09:21.763

这是一个旧帖子，但我只是想知道。现在似乎在 Emacs 中有一个功能：`previous-multiframe-window`.

我将它绑定到`C-x O`，如大写字母 o。现在，当我想倒退时，我只是换班。

`(global-set-key (kbd "C-x O") 'previous-multiframe-window)`

* * *

## 回答 #3

> 赞同：10
> 
> 时间：2008-09-27T05:51:52.857

把它放在你的 .emacs 中，并将它绑定到你喜欢的任何键上

```
(defun 后视窗 ()
  （交互的）
  （其他窗口-1））

```

* * *

## 回答 #4

> 赞同：6
> 
> 时间：2011-04-01T23:10:45.870

默认情况下，一个稍微不那么烦人的快捷方式是`C-- C-x o`. 这样您就不必在输入前缀时在 Meta 和 Control 之间切换。

* * *

## 回答 #5

> 赞同：5
> 
> 时间：2008-09-29T02:02:47.633

与您要求的不同，但是[windmove 包](http://hovav.net/elisp/windmove-0.93.el)允许您根据窗口的相对屏幕位置在窗口之间移动，这比重复执行 Cx o 容易得多。

* * *

## 回答 #6

> 赞同：3
> 
> 时间：2008-09-30T16:48:12.567

除了`C-u -`，您还可以只使用`M--`(Meta-Minus) 给出否定前缀参数，即使用 切换到上一个窗口`M-- C-x o`。

# c++ - 在 Windbg 中调试 C++ STL 容器

> ID：143073
> 
> 赞同：10
> 
> 时间：2008-09-27T05:40:27.330
> 
> 标签：c++, stl, windbg

Windbg 粉丝声称它非常强大，我倾向于同意。但是在调试 STL 容器时，我总是卡住。如果变量在堆栈上，`!stl`扩展有时会计算出来，但是当具有复杂类型（例如`std::vector<TemplateField, std::allocator<TemplateField> >`）的容器在堆上或其他结构的一部分时，我只是不知道如何查看其内容。

欣赏任何提示，指针。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2008-09-27T05:55:46.403

我经常发现调试器对 STL 数据类型的支持不足。出于这个原因，我越来越多地使用[日志框架和日志语句](http://www.spinellis.gr/blog/20060501/)。我曾经认为这些是为不能使用调试器的人准备的，但我现在意识到它们提供了真正的价值。它们允许您在代码中嵌入可移植的调试知识，并将其与代码一起维护。相反，您在调试器中所做的工作通常是短暂的。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2008-10-15T19:29:19.383

您可能还想试试这个[调试器扩展。](http://www.nynaeve.net/?p=7)它是一个名为 SDbgExt 的库，由[Skywing](http://www.nynaeve.net)开发。

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2011-04-10T19:56:56.340

[WinDbg (pykd) 的 Python 扩展](http://pykd.codeplex.com/)具有可以转储地图内容的片段[stlp.py。](https://pykd.svn.codeplex.com/svn/snippets/stlp.py)
目前它支持 STLPort 映射实现。在 x86 和 x64 上测试。本文演示了如何使用它（它在俄语[上](http://perfect-coding.blogspot.com/2011/04/stl-map-windbg.html)，但是，示例是不言自明的）。

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2011-01-05T13:37:37.987

前段时间我有完全相同的问题。我的回答是 Visual Studio 确实是一个更好的 STL 和复杂类型的调试器（就像 Visual Studio 只是一个比 MDbg 更好的调试器）。

这并不是说 WinDBG 的功能不那么强大，只是它的级别较低（例如，尝试使用 Visual Studio 对故障转储做任何有用的事情——你不能）。

无论如何，要回答您的问题，您可以使用 Visual Studio 使用一些技巧来查看数据类型：

1.  启动另一个 WinDBG 实例，以非侵入方式附加：`cdb -p <PID> -pv`. 这将暂停被调试者的线程。现在您可以安全地分离原始 WinDBG`qd`
2.  将 Visual Studio 附加到它，然后分离非侵入式 WinDBG `qd`。查看 STL 并按您的意愿继续。
3.  当您需要返回 WinDBG 时，转到第 1 步，与侵入式 WinDBG 进行交换。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2008-09-27T10:37:05.667

我通常最终会`toString()`在我的很多课程中坚持一种方法。这显示了我认为重要的所有信息，然后任何容器都可以调用它以在控制台中显示类信息

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2008-10-12T13:00:58.063

使用 dt -r 即 dt yourapp!class 7ffdf000 -r5

# iphone - NSDateFormatter，我做错了什么还是这是一个错误？

> ID：143075
> 
> 赞同：39
> 
> 时间：2008-09-27T05:41:52.350
> 
> 标签：iphone, ios, objective-c, nsdate, nsdateformatter

我正在尝试以某种格式打印日期：

```
NSDate *today = [[NSDate alloc] init];
NSDateFormatter *dateFormatter = [[NSDateFormatter alloc] init];
[dateFormatter setDateFormat:@"yyyyMMddHHmmss"];
NSString *dateStr = [dateFormatter stringFromDate:today]; 
```

如果 iPhone 设置为 24 小时制，这可以正常工作，另一方面，如果用户已将其设置为 24 小时制，然后返回 AM/PM（在您切换此设置之前它工作正常）然后它附加 AM /PM 最后，即使我没有要求它：

```
20080927030337 PM 
```

我做错了什么还是固件 2.1 的错误？

编辑 1：使描述更清晰

编辑 2 解决方法：事实证明这是一个错误，为了修复它，我将 AM 和 PM 字符设置为“”：

```
[dateFormatter setAMSymbol:@""];
[dateFormatter setPMSymbol:@""]; 
```

* * *

## 回答 #1

> 赞同：31
> 
> 时间：2013-11-08T11:26:18.780

这种行为的原因是语言环境，它设置了正确的语言环境。

**将您的NSDateFormatter**的本地设置为**en_US_POSIX**将解决此问题。它适用于 24 小时和 12 小时格式。

`On iPhone OS, the user can override the default AM/PM versus 24-hour time setting (via Settings > General > Date & Time > 24-Hour Time), which causes NSDateFormatter to rewrite the format string you set.`来自[苹果文档](https://developer.apple.com/library/mac/documentation/Cocoa/Conceptual/DataFormatting/Articles/dfDateFormatting10_4.html#//apple_ref/doc/uid/TP40002369-SW1)

试试这个，

```
NSDate *today = [[NSDate alloc] init];
NSDateFormatter *dateFormatter = [[NSDateFormatter alloc] init];
[dateFormatter setLocale:[[NSLocale alloc] initWithLocaleIdentifier:@"en_US_POSIX"]];
[dateFormatter setDateFormat:@"yyyyMMddHHmmss"];
NSString *dateStr = [dateFormatter stringFromDate:today]; 
```

* * *

## 回答 #2

> 赞同：14
> 
> 时间：2009-12-09T04:41:01.527

这是 iPhone SDK 错误的解释（在 3.1 beta SDK 中仍然存在）

> 首先，关于 iPhone 用户界面的一些背景知识。当 iPhone 用户在“美国”和“法国”之间更改他们的地区格式时，用户的“24 小时制”设置会自动切换到该地区最流行的模式。在法国，这会将 24 小时制设置为“开”，而在美国，这会将其设置为“关”。然后，用户可以手动覆盖该设置，这就是麻烦开始的地方。
> 
> 问题来自 NSDateFormatter 在用户手动选择的 12 或 24 小时时间模式中以某种方式“卡住”。因此，如果法国用户手动选择 12 小时模式，并且应用程序请求 NSDateFormatter 以 24 小时格式“HHmm”输出时间，它实际上会以 12 小时格式接收时间，例如“01:00 PM”，好像应用程序改为请求“hhmm aa”。如果美国用户手动选择 24 小时模式，则会发生相反的情况：以 12 小时格式“hhmm aa”输出时间实际上会以 24 小时格式为您提供时间，例如“17:00”。

可以在此[博客](http://multinc.com/2009/09/27/iphone-sdk-time-bug-for-international-users/)上找到更多详细信息和可能的解决方法。

* * *

## 回答 #3

> 赞同：12
> 
> 时间：2008-09-27T06:17:37.660

使用您在模拟器和 2.1 固件和 24 小时时间设置为关闭的手机上发布的代码，当我这样做时，我从来没有将 AM/PM 附加到 dateStr：

```
NSLog(@"%@", dateStr); 
```

您是否使用 dateStr 做任何其他您没有在此处发布的事情？你如何检查价值？

**跟进**

> 尝试打开上午/下午设置，然后关闭。在我这样做之前，我也没有问题。我和你一样打印出来。

好的，我这样做的时候也看到了。这一定是一个错误。我建议您[提交错误报告](https://bugreport.apple.com/)，同时检查并过滤掉不需要的字符。

* * *

## 回答 #4

> 赞同：9
> 
> 时间：2011-05-20T01:49:28.540

将日期格式化程序上的语言环境设置为 en_US 为我解决了这个问题：

```
 NSDateFormatter * f = [[NSDateFormatter alloc] init];
    [f setDateFormat:@"yyyy-MM-dd'T'HH:mm:ss'Z'"];
    f.timeZone = [NSTimeZone timeZoneForSecondsFromGMT:0];
    f.calendar = [[[NSCalendar alloc] initWithCalendarIdentifier:NSGregorianCalendar] autorelease];
    f.locale = [[[NSLocale alloc] initWithLocaleIdentifier:@"en_US"] autorelease]; 
```

我不确定是否还需要添加日历，但这很好用。

* * *

## 回答 #5

> 赞同：4
> 
> 时间：2010-07-16T21:43:56.367

我认为这是解决方案。

```
NSDateFormatter *df =[[NSDateFormatter alloc] init];
        [df setDateFormat:@"yyyy-MM-dd HH:mm:ss"];
        NSLocale *usLocale = [[NSLocale alloc] initWithLocaleIdentifier:@"en_US"];

[df setLocale: usLocale];

[usLocale release];

 NSDate *documento_en_Linea =[[[NSDate alloc] init]autorelease];

documento_en_Linea=[df dateFromString:@"2010-07-16 21:40:33"];

[df release];

        NSLog(@"fdocumentoenLineaUTC:%@!",documento_en_Linea);

//ouput  
     fdocumentoenLineaUTC:2010-07-16 09:40:33 p.m. -0500! 
```

* * *

## 回答 #6

> 赞同：1
> 
> 时间：2010-07-04T13:47:12.377

对于那些想要使用 NSDateFormatter 解析 24 小时时间并遇到此错误的人，使用 NSDateComponents 解析具有已知格式的日期和时间可以避开此问题：

```
NSString *dateStr = @"2010-07-05";
NSString *timeStr = @"13:30";

NSDateComponents *components = [[NSDateComponents alloc] init];
components.year = [[dateStr substringToIndex:4] intValue];
components.month = [[dateStr substringWithRange:NSMakeRange(5, 2)] intValue];
components.day = [[dateStr substringFromIndex:8] intValue];
components.hour = [[timeStr substringToIndex:2] intValue];
components.minute = [[timeStr substringFromIndex:3] intValue];

NSCalendar *calendar = [[NSCalendar alloc] initWithCalendarIdentifier:NSGregorianCalendar];

NSDate *date = [calendar dateFromComponents:components];

[components release];
[calendar release]; 
```

* * *

## 回答 #7

> 赞同：0
> 
> 时间：2010-09-12T01:48:15.917

这也应该有效（尽管我看到了一些奇怪的结果）。

```
-(NSString*)lowLevTime:(NSString*)stringFormat {
    char buffer[50];
    const char *format = [stringFormat UTF8String];
    time_t rawtime;
    struct tm * timeinfo;
    time(&rawtime);
    timeinfo = localtime(&rawtime);
    strftime(buffer, sizeof(buffer), format, timeinfo);
    return [NSString  stringWithCString:buffer encoding:NSASCIIStringEncoding];
} 
```

* * *

## 回答 #8

> 赞同：0
> 
> 时间：2012-06-20T22:05:00.997

简短回答：尝试`[dateFormatter setDateFormat:@"yyyyMMddhhmmss"];`12 小时格式（注意小写`hh`）。

这是一个令人沮丧的话题，因为很多网站都指示使用`HH`数小时（包括 Apple 官方文档），但这将其设置为 24 小时格式，而`hh`使用 12 小时格式。有关详细信息，请参阅[http://unicode.org/reports/tr35/tr35-6.html#Date_Format_Patterns 。](http://unicode.org/reports/tr35/tr35-6.html#Date_Format_Patterns)

作为奖励，请注意您还可以使用`KK`或`kk`表示一天中的小时格式，该格式可能会减少一个。

更新：我最近在看 NSLocale（https://developer.apple.com/library/mac/#documentation/Cocoa/Reference/Foundation/Classes/NSLocale_Class/Reference/Reference.html），看起来你可以使用autoupdatingCurrentLocale 将应用程序内所做的更改应用到区域设置。这样做的结果是，即使手机设置为使用 24 小时制（就像您切换到法国时一样），您也可以为该应用程序进行 12/24 切换，而不会影响手机上的任何其他应用程序，或要求您离开应用程序进行更改。

# java - 有一个扩展另一个类的“空”类可以吗？

> ID：143084
> 
> 赞同：10
> 
> 时间：2008-09-27T05:56:35.263
> 
> 标签：java

假设我有一个类`Foo`包含一堆逻辑，另一个类`Bar`基本相同。但是，作为`Foo`不同`Bar`（但相关）的实体，我需要从我的代码中看出差异（即我可以判断一个实例是 a`Foo`还是 a `Bar`）

当我不加思索地把它拼凑在一起时，我得到了以下结果：

```
public class Foo {
  /* constructors, fields, method, logic and what-not */
}

public class Bar extends Foo {
  /* nothing here but constructors */ 
} 
```

这个可以吗？做`Bar`一个复合类更好吗？例如：

```
public class Bar {
  private Foo foo;

  /* constructors and a bunch of wrapper methods that call
     into foo */
} 
```

甚至，当我们这样做的时候，一些技术含量更低的东西：

```
public class Foo {
  /* constructors, fields, method, logic and what-not */

  private boolean isABar; // Could be an enum
} 
```

你怎么看？**您如何处理这些“标记类”？**

* * *

作为我的代码可能希望如何处理`Foo`和`Bar`不同的示例，我的代码需要能够执行类似`List<Foo>`和`List<Bar>`. A`Foo`不能进入，`List<Bar>`反之亦然。

* * *

## 回答 #1

> 赞同：14
> 
> 时间：2008-09-27T05:59:19.000

`Foo`在我看来，最好是`Bar`继承一个共同的祖先类（也许`AbstractFoo`），它具有所有功能。`Foo`和之间应该存在什么行为差异`Bar`？将差异编码为 中的抽象方法`AbstractFoo`，而不是在代码中使用`if`语句。

示例：而不是这样：

```
if (foo instanceof Bar) {
    // Do Bar-specific things
} 
```

改为这样做：

```
class Bar extends AbstractFoo {
    public void specialOp() {
        // Do Bar-specific things
    }
}

// ...
foo.specialOp(); 
```

这种方法的好处是，如果您需要第三个类，这很像`Foo`但只有一点点不同，您不必遍历所有代码并添加编辑所有`if`语句。:-)

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2008-09-27T06:16:14.140

**这完全取决于 Foo 和 Bar 类的含义。他们代表什么，他们的目的是什么。请澄清。**

我可以想象您的每个解决方案和建议的解决方案都是正确的情况。

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2008-09-27T06:49:44.323

如果有任何可能性`Foo`并且`Bar`有一天可能会在实现中出现分歧，那么您的问题就得到了回答 - 以任何看起来最好的方式使用继承。

但是，如果您绝对确定它们永远不会分歧，那么显然您正在查看应该由单个类表示的东西，例如`ThingThatIsEitherFooOrBar`.

有了这个类，与其给它一个布尔属性`isFoo`，不如再看看为什么你需要区分 Foo 和 Bar 会更好。Foos 是什么让你以不同于 Bars 的方式处理它们？弄清楚这一点，并创建一个属性来指定不同的信息。Foos更大吗？然后为大小创建一个属性（即使它是一个值为“Foo-sized”和“Bar-sized”的枚举）。

如果没有 Foo 和 Bar 可能是什么的具体例子，这几乎是一个人可以说的。

* * *

## 回答 #4

> 赞同：2
> 
> 时间：2008-09-27T10:28:10.447

## Foo 和 Bar 继承自 FooBarImplementation

我会创建一个类 FooBarImplementation 来实现 Foo 和 Bar 的共同特征。Foo 和 Bar 会从中派生出。但是在您的代码中，永远不要**使用**FooBarImplementation 类型。我的 Java 时代已经过去了，但我想一定有某种方法可以从用户代码中隐藏 FooBarImplementation（使其受保护，或仅包可见，具体取决于您的项目组织。这样，没有用户代码会混合 Foo酒吧（反之亦然）？

```
class FooBarImplementation
{
   public void doSomething() { /* etc. */ }
   /* etc. */
}

class Foo inherits FooBarImplementation { /* etc. */ }
class Bar inherits FooBarImplementation { /* etc. */ } 
```

## Foo 和 Bar 由 FooBarImplementation 组成

另一种可能性是让 Foo 和 Bar 将它们的每个方法转发到一个内部类（同样，FooBarImplementation）。这样，用户代码就不可能是 Foo 和 Bar。

```
class FooBarImplementation
{
   public void doSomething() { /* etc. */ }
   /* etc. */
}

class Foo
{
   private FooBarImplementation fooBarImplementation = new FooBarImplementation() ;

   public void doSomething() { this.fooBarImplementation.doSomething() ; }
   /* etc. */
}

class Bar
{
   private FooBarImplementation fooBarImplementation = new FooBarImplementation() ;

   public void doSomething() { this.fooBarImplementation.doSomething() ; }
   /* etc. */
} 
```

## 不要让 Foo 从 Bar 继承（反之亦然）

Shoudl Foo 继承自 Barn，就语言而言，Foo 将是一个 Bar。不要这样做，你会失去对象之间的差异，这就是你不想要的。

## 不要使用 boolean 和 whataver 类型字段

这是你可能遇到的最糟糕的想法。Bjarne Stroustrup 对 C++ 的这种反模式提出了警告，C++ 不仅仅与 OOP 有关。所以我猜这种模式对于 Java 来说更加“反”...... :-)

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2008-09-27T19:57:36.880

基本上你需要应用[Strategy Pattern](http://en.wikipedia.org/wiki/Strategy_pattern)。

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2008-09-27T06:01:22.037

绝对使用布尔属性。这是最简单的解决方案，除非您预见 Bar 类需要稍后更改它的接口（例如覆盖它的方法）。

* * *

## 回答 #7

> 赞同：0
> 
> 时间：2008-09-27T06:14:37.590

继承最好。
使用布尔属性，类必须知道存在两种不同类型的对象，而这不容易扩展到两个以上。此外，这种方法不允许您重载函数。
组合使您可以为所有函数编写包装器。

* * *

## 回答 #8

> 赞同：0
> 
> 时间：2008-09-27T06:39:18.547

你的数据不够清楚，但根据我认为你需要的，我很困惑为什么你不简单地选择第四个选项：

```
Class MainStuff;
Class TypeA;
Class TypeB; 
```

No 要么让 TypeA 和 B 继承自 MainStuff，要么让 MainStuff 成为 TypeA 和 TypeB 的数据成员。这取决于这 3 个类的含义。

* * *

## 回答 #9

> 赞同：0
> 
> 时间：2008-09-27T10:56:21.440

正如其他人所说，这取决于，但是如果您在 Foo 和 Bar 之间具有共同的功能并且功能上的差异可以表示为参数，那么我投票支持子类。这基本上是我们在实用软件课程结束时所做的事情。

我们应该实现一个数独游戏，最后，我们有一个“AbstractPlayfield”，它能够将任意规则集应用于任意游戏区域。这个 AbstractPlayfield 是我们应该实现的各个变体的子类。这些子类为抽象的运动场设置参数（主要是规则和棋盘的形状），一切都像魅力一样工作。我们甚至最终在这些子类中获得了更多继承，因为其中一些变体包含规则“数字必须在一行中唯一”和“数字必须在一列中唯一”。
使用它，我们能够在大约 3 天内完成估计需要大约 2 个月的工作 :) （他们让我们恼火的是“测试那些微小的属性设置类，因为你可能有错误！测试它们！测试他们！我们不在乎所有重要的逻辑都经过测试！”。）

另一方面，如果类 Bar 与 Bar 没有特殊的不同功能，我看不出添加它的意义——至少从你给我的数据来看。如果您想根据类型执行一些操作并按类型分派，这可能是有道理的，但我无法从 Foo 和 Bar 中读取。在这种情况下，由于 YAGNI，我不会创建 Bar。

* * *

## 回答 #10

> 赞同：0
> 
> 时间：2008-09-29T18:48:26.483

If there is no behavioral difference between Foo and Bar, then the class name "Foo" is not abstract enough. Identify the common abstraction between Foo and Bar and rename the class accordingly. Then provide a member field in the class to identify instances as "Foo", "Bar", etc. Use an enum if you wish to limit possible values to "Foo" and "Bar".

# javascript - JavaScript 对象浏览器？

> ID：143087
> 
> 赞同：7
> 
> 时间：2008-09-27T05:57:14.683
> 
> 标签：javascript

我最近的任务是记录一个我已经维护了一段时间的大型 JavaScript 应用程序。所以我确实对系统有很好的了解。

但是由于应用程序的庞大规模，即使有关于代码和未压缩形式的源代码本身的先验知识，它也可能需要大量时间。

所以我正在寻找可以帮助我探索 JavaScript 中的类和方法及其关系的工具，如果可能的话，一路记录它们，有没有可用的？

VS 中的对象浏览器之类的东西会很好，但是任何可以帮助我更快完成任务的工具都可以。

谢谢！

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2008-09-27T08:15:16.023

[Firebug](https://addons.mozilla.org/firefox/addon/1843)的[DOM 选项卡](http://getfirebug.com/dom.html)允许您浏览全局对象的内容，并且您可以通过在命令行中`window`输入来检查特定对象。`inspect(whatever)`

除非一个对象的实例包含相关对象的实例，否则您将无法使用它来检测关系，但这是一个开始。

您还可以使用 DOM 选项卡上的“选项”菜单将显示的内容限制为用户定义的函数和属性，这将有助于减少混乱。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2008-09-27T06:29:12.003

看看[Aptana](http://www.aptana.com)，它们有一个大纲，可以帮助您确定什么是对象以及它们之间的关系。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2008-09-27T05:58:51.857

Firebug + uneval(obj) 是一个简单的技巧，通常很有帮助。

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2010-10-12T18:13:35.453

我看到很多人谈论在 Firebug 中检查 DOM。但是，从您的问题来看，您似乎想要jsdoc之类的东西？只需通过注释添加类型和类信息，jsdoc 即可生成包含类关系的文档。[http://jsdoc.sourceforge.net/](http://jsdoc.sourceforge.net/)

谷歌有一个带有附加功能的分支[http://code.google.com/p/jsdoc-toolkit/](http://code.google.com/p/jsdoc-toolkit/)

**更新：**这不是一个 fork，它是由最初将 jsdoc 编写为 perl 脚本的开发人员重写的。它旨在更具适应性，因此您可以使用任何您喜欢的 js 继承/事件/属性样式。另一个功能是它允许您以更简单的方式修改用于生成 HTML 的模板。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2008-09-27T09:31:50.673

我们不知道这个 JS 应用程序是否设计为在 Web 浏览器中运行……
如果是的话，如建议的那样，Firebug（Firefox 扩展）在调试 JS 和探索 Dom 方面非常出色。
在 IE 方面，您有一些工具，例如[IEDocMon](http://www.cheztabor.com/IEDocMon/index.htm "IEDocMon")、[Web Accessibility Toolbar](http://www.visionaustralia.org.au/ais/toolbar/ "无障碍网页工具栏")（它的功能远不止其名称）或[Fiddler](http://www.fiddlertool.com/fiddler/ "提琴手")（与您的问题无关，但仍然是一个不错的工具）。

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2010-02-02T11:13:10.430

**Firebug** (Firefox) / **Dragonfly** (Opera) 可以帮助您实时查看对象

**Aptana** / **JS/UML** (Eclipse) 可以帮助处理对象的关系

* * *

## 回答 #7

> 赞同：0
> 
> 时间：2016-03-23T17:32:56.217

这是一个老问题，但无论如何让我回答一下。

1.  使用*IDE*。集成开发环境是为在代码中快速跳转而设计的。您将在探索过程中使用的关键功能是查看文件结构或大纲、跳转到声明或用法以及在整个项目中搜索字符串的所有实例。如果您使用的是 WebStorm，请为生成的文件和 node.js 之外的文件设置自定义范围以帮助搜索。

2.  运行'npm la | less' 列出了所有依赖模块，其中包含一行描述。您可能从未见过 moment.js 并且永远不需要阅读文档，但是花时间阅读它的一行摘要是值得的。如果您需要的工具信息多于一行摘要，请在 SlideShare 上搜索该术语。幻灯片比 ReadTheDocs 快。

3.  边走边记录一点。我喜欢强迫人们经常使用笔记本而不是草稿纸。此外，我发现为每个 JavaScript 文件添加一行注释是值得的。您想知道项目的每个目录中应该有什么。我还建议为您的系统中的领域术语的确切含义构建一个词汇表，例如，您的系统中的“工作”是什么。

4.  最后，您可能只需要在调试器中启动应用程序并开始逐步执​​行其中的一部分。大多数大型项目都从不同技能水平和动机的程序员那里获得了价值。

您的目标是“概念完整性”（引用 Yourdon）或“了解”软件（引用 Heinlien）。它确实需要一些时间，无法绕过，并且可以有效地完成。

# asp.net - 您如何将演示模型与 Web 表单一起使用？

> ID：143098
> 
> 赞同：6
> 
> 时间：2008-09-27T06:05:26.067
> 
> 标签：asp.net, design-patterns, presentation-model

我已经开始使用带有 ASP.NET 网络表单的演示模型，并且非常喜欢这种模式。我真正遇到的问题是在哪里实例化我的一些类，主要是表示模型、我的业务对象以及下拉列表的数据之类的东西。所以我可以使用一些技巧或演示模型的完整示例（到目前为止我只找到了一些片段）。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2008-09-27T06:55:35.450

视频链接 -

[Rik Bardof 谈设计模式](http://codebetter.com/blogs/david_laribee/archive/2008/07/16/rik-on-design-patterns.aspx)（包括 MVP）

[让·保罗·布杜谈 MVP](http://www.dnrtv.com/default.aspx?showID=14)

至于您的其余架构，我建议您阅读 Jeffrey Palermo 关于[洋葱架构](http://jeffreypalermo.com/blog/the-onion-architecture-part-1/)的博客系列。他有一个示例项目 CodeCampServer，说明了一些好的实践。这是一个使用 ASP.NET MVC 的 Web 应用程序，但原理仍然适用。

# c - Windows 的 rand_s 线程安全吗？

> ID：143108
> 
> 赞同：13
> 
> 时间：2008-09-27T06:13:39.857
> 
> 标签：c, windows, multithreading, random

就像标题一样。怀疑是这样，但我在任何明确说明的地方都找不到。对于这个属性，我不想依赖猜测。

* * *

## 回答 #1

> 赞同：11
> 
> 时间：2008-09-27T06:28:11.880

如果您使用 CRT 的[多线程](http://msdn.microsoft.com/en-us/library/abx4dbyh(VS.80).aspx)版本，则所有函数都是线程安全的，因为任何线程特定的信息都存储在[TLS](http://msdn.microsoft.com/en-us/library/ms686749.aspx)中。rand_s 实际上一开始并不使用状态信息，因为它只是调用 OS API，所以 rand_s 不会出现线程安全问题。然而，rand() 依赖于种子值来生成随机数。

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2008-09-27T06:24:27.597

Chris 说：`rand()`不是线程安全的，因为它的内部状态是静态的，但是`rand_s()`应该是线程安全的。

然而，Jeff 补充说，对于 MSVCRT 的多线程版本，`rand()`的状态保存在线程本地存储中，所以仍然可以。

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2008-09-27T06:32:23.587

Visual Studio 附带运行时库的源代码。虽然其中一些可能相当痛苦，但 rand_s() 非常简单。

rand_s() 所做的只是调用 ADVAPI32.DLL 中的 SystemFunction036() 来获取随机值。ADVAPI32.DLL 中的任何内容都应该是线程安全的。

就其本身而言， rand_s() 以线程安全的方式获取指向该函数的指针。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2008-09-27T06:53:47.310

我不知道 rand_s 是否是线程安全的，但似乎它可能是，因为它似乎往返于操作系统以获取熵。（只要你链接到 VC++ 多线程 CRT，如果你链接到单线程，所有的赌注都没有）

如果 Windows CRT 支持它，您可以尝试调用 rand_r，它是 rand 的 posix 可重入版本。或者甚至更好的 boost::random，如果你已经在使用 boost。

考虑到多线程将很快普及，没有人应该在新代码中再使用 rand() - 总是尝试使用 rand_r/rand_s/boost/各种平台相关的安全 rands/等。

* * *

## 回答 #5

> 赞同：-2
> 
> 时间：2008-09-27T06:16:52.983

我想不出任何理由 rand_s() 甚至 rand() 都不是线程安全的。

# php - 使用 SimpleXML 从头开始 创建 XML 对象

> ID：143122
> 
> 赞同：79
> 
> 时间：2008-09-27T06:30:05.650
> 
> 标签：php, xml, simplexml

是否可以使用 PHP 的 SimpleXML 函数从头开始创建 XML 对象？查看函数列表，有一些方法可以将现有的 XML 字符串导入到可以操作的对象中，但是如果我只想从头开始以编程方式生成 XML 对象，那么最好的方法是什么？

我发现你可以使用 simplexml_load_string() 并传入你想要的根字符串，然后你有一个可以通过添加孩子来操作的对象......虽然这看起来像是一种黑客，因为我必须实际上在加载之前将一些 XML 硬编码到字符串中。

我已经使用[DOMDocument 函数](http://us3.php.net/manual/en/book.domxml.php)完成了它，虽然它有点令人困惑，因为我不确定 DOM 与创建纯 XML 文档有什么关系......所以也许它只是名字不好:-)

* * *

## 回答 #1

> 赞同：145
> 
> 时间：2008-09-27T07:42:05.757

你当然可以。例如。

```
<?php
$newsXML = new SimpleXMLElement("<news></news>");
$newsXML->addAttribute('newsPagePrefix', 'value goes here');
$newsIntro = $newsXML->addChild('content');
$newsIntro->addAttribute('type', 'latest');
Header('Content-type: text/xml');
echo $newsXML->asXML();
?> 
```

输出

```
<?xml version="1.0"?>
<news newsPagePrefix="value goes here">
    <content type="latest"/>
</news> 
```

玩得开心。

* * *

## 回答 #2

> 赞同：22
> 
> 时间：2008-09-27T08:50:01.290

在 PHP5 中，您应该改用[Document Object Model](http://us3.php.net/manual/en/book.dom.php "文档对象模型")类。例子：

```
$domDoc = new DOMDocument;
$rootElt = $domDoc->createElement('root');
$rootNode = $domDoc->appendChild($rootElt);

$subElt = $domDoc->createElement('foo');
$attr = $domDoc->createAttribute('ah');
$attrVal = $domDoc->createTextNode('OK');
$attr->appendChild($attrVal);
$subElt->appendChild($attr);
$subNode = $rootNode->appendChild($subElt);

$textNode = $domDoc->createTextNode('Wow, it works!');
$subNode->appendChild($textNode);

echo htmlentities($domDoc->saveXML()); 
```

* * *

## 回答 #3

> 赞同：16
> 
> 时间：2008-09-27T10:01:55.237

请[在此处](https://stackoverflow.com/questions/139650/when-writing-xml-is-it-better-to-hand-write-it-or-to-use-a-generator-such-as-si#140203)查看我的答案。正如[dreamwerx.myopenid.com 所](https://stackoverflow.com/users/15487/dreamwerxmyopenidcom)指出的，可以使用[SimpleXML](http://de.php.net/manual/en/book.simplexml.php)来做到这一点，但[DOM 扩展](http://de3.php.net/manual/en/book.dom.php)会是更好、更灵活的方式。此外还有第三种方法：使用[XMLWriter](http://de3.php.net/manual/en/intro.xmlwriter.php)。它比 DOM 更易于使用，因此它是我从头开始编写 XML 文档的首选方式。

```
$w=new XMLWriter();
$w->openMemory();
$w->startDocument('1.0','UTF-8');
$w->startElement("root");
    $w->writeAttribute("ah", "OK");
    $w->text('Wow, it works!');
$w->endElement();
echo htmlentities($w->outputMemory(true)); 
```

顺便说一句：[DOM](http://www.w3.org/DOM/)代表**D** ocument **O** bject **M** odel ；这是 XML 文档的标准化 API。

# c - 如何在 C 中创建用于读取套接字数据的缓冲区

> ID：143123
> 
> 赞同：9
> 
> 时间：2008-09-27T06:30:47.800
> 
> 标签：c, sockets

使用 C/C++ 套接字编程，以及“read(socket, buffer, BUFSIZE)”方法。“缓冲区”到底是什么我知道 char 和 byte 是一回事，但是字节数组中有多少元素有关系吗？缓冲区是否需要能够保存整个消息直到出现空字符？

* * *

## 回答 #1

> 赞同：14
> 
> 时间：2008-09-27T06:33:07.157

BUFSIZE 应该等于缓冲区的大小（以字节为单位）。read() 将在缓冲区已满时停止读取。这是一个例子：

```
#define MY_BUFFER_SIZE 1024

char mybuffer[MY_BUFFER_SIZE];
int nBytes = read(sck, mybuffer, MY_BUFFER_SIZE); 
```

* * *

## 回答 #2

> 赞同：6
> 
> 时间：2008-10-15T11:00:52.157

与往常一样，`sizeof`有机会时使用。使用内置 operator `sizeof`，您要求编译器计算变量的大小，而不是自己指定。当实际变量的大小与您的想法不同时，这会降低引入错误的风险。

所以，而不是做

```
#define BUFSIZE 1500
char buffer[BUFSIZE];
int n = read(sock, buffer, BUFSIZE); 
```

你真的应该使用

```
char buffer[1500];
int n = read(sock, buffer, sizeof buffer); 
```

请注意您不需要在 sizeof 的参数周围加上括号，除非参数是类型的名称。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2008-09-27T07:48:57.503

您的套接字实现不需要足够大的缓冲区来确定保存整个消息，但它可能会很方便，具体取决于您在做什么。

# svn - 如何同步两个 Subversion 存储库？

> ID：143130
> 
> 赞同：58
> 
> 时间：2008-09-27T06:34:56.917
> 
> 标签：svn, version-control, synchronization

我公司有一家子公司，其 Internet 连接速度很慢。[我们那里的开发人员与我们的中央Subversion](http://en.wikipedia.org/wiki/Subversion_%28software%29)服务器进行交互。是否可以为它们配置从属/镜像？他们将在本地与服务器交互，所有提交将自动同步到主服务器。

这应该对开发人员尽可能透明。可用性是必须的。

请不要建议更改我们的版本控制系统。

* * *

## 回答 #1

> 赞同：49
> 
> 时间：2008-09-27T07:03:48.050

这是可能的，但不一定很简单：您试图解决的问题非常接近于建立一个分布式开发环境，而这并不是 SVN 的设计目标。

**SVN镜像方式**

您可以`svn mirror`按照 SVN 书籍文档中的说明使用来创建主存储库的*只读*镜像。您的开发人员每个人都与离他们最近的镜像交互。但是，从存储库的用户必须使用

svn switch --relocate master_url

在他们提交之前，他们必须记住在完成后重新定位到从站。如果您使用命令行客户端，则可以使用围绕存储库修改命令的包装脚本自动执行此操作。请记住，快速的重定位操作会增加一些开销。（并小心复制存储库 uuid - 请参阅[SVN 文档](http://svnbook.red-bean.com/en/1.5/svn.reposadmin.maint.html#svn.reposadmin.maint.replication)。）

[编辑-检查[TortoiseSVN](http://en.wikipedia.org/wiki/TortoiseSVN)文档，您似乎可以让 TortoiseSVN[在客户端执行钩子脚本](http://tortoisesvn.net/docs/release/TortoiseSVN_en/tsvn-dug-settings.html#tsvn-dug-settings-hooks)。此时您也许可以创建一个前/后提交脚本。或者尝试看看你是否可以使用[TortoiseSVN 自动化接口](http://tortoisesvn.net/docs/release/TortoiseSVN_en/tsvn-automation.html)来做到这一点]。

**SVK方式**

[svk](http://svk.bestpractical.com/view/HomePage)是一组 Perl 脚本，它在 SVN 上模拟分布式镜像服务。您可以对其进行设置，以便多个开发人员共享本地分支（镜像）。然后开发人员的基本用法将完全透明。您将不得不使用 svk 客户端进行樱桃采摘、合并和星形合并。如果你能理解分布式概念，这是可行的。

**git-svn 方式**

虽然我自己从未使用过，但您也可以让远程开发人员在本地使用 git 并使用[git-svn](http://git-scm.com/docs/git-svn)网关进行同步。

**最后的话**

这完全取决于您的开发环境和所需的集成级别。根据您的 IDE（如果您可以更改[SCM](http://en.wikipedia.org/wiki/Source_Code_Management)），您可能想看看其他支持开箱即用的分布式开发的完全分布式 SCM（想想[Mercurial](http://en.wikipedia.org/wiki/Mercurial) / [Bazaar](http://en.wikipedia.org/wiki/Bazaar_%28software%29) / [Git /...）。](http://en.wikipedia.org/wiki/Git_%28software%29)

* * *

## 回答 #2

> 赞同：29
> 
> 时间：2008-09-28T00:41:09.240

当您使用 http 托管您的存储库时，Subversion 1.5 引入了代理支持。开发人员可以从从站签出他们的工作副本。然后所有只读操作（差异、日志、更新等）都将使用从站。提交时，slave 透明地将所有写操作传递给 master。

* * *

## 回答 #3

> 赞同：7
> 
> 时间：2008-09-27T06:46:40.900

你应该试试[SVK 版本控制系统](http://svk.bestpractical.com/view/HomePage)

> [SVK](http://svk.bestpractical.com/view/HomePage)是一个分散的版本控制系统，使用强大的 Subversion 文件系统构建。它支持存储库镜像、断开操作、历史敏感合并，并与其他版本控制系统以及流行的可视化合并工具集成。

[在此链接上有关于使用 SVK 同步 SVN 存储库](http://lajavaloca.wordpress.com/2008/06/03/using-svk-to-synchronize-svn-repositories/)的文本

* * *

## 回答 #4

> 赞同：2
> 
> 时间：2009-12-01T15:01:19.403

如果其中一个存储库是完全只读的，您可以使用“svnsync”使其与主存储库保持同步。此工具通常与代理支持结合使用以创建主从设置。

例如，Apache 这样做是为了将他们的存储库镜像到不同的大陆。主存储库位于美国，但如果我从欧盟访问存储库，我会得到一个与主服务器一样工作的本地镜像。

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2011-06-17T03:08:48.310

inotify-tools 对我来说效果很好，这个网站上提到了细节：

[http://planet.admon.org/synchronize-subversion-repositories-with-inotify-tools/](http://planet.admon.org/synchronize-subversion-repositories-with-inotify-tools/)

* * *

## 回答 #6

> 赞同：1
> 
> 时间：2013-03-22T01:24:35.903

如果您需要超出 svnsync 提供的称为“Subversion MultiSite”的性能和数据安全性，有一个商业解决方案可以提供 Subversion 存储库的真正主动-主动复制（不是主从）。

免责声明：我为提供此解决方案的公司工作

* * *

## 回答 #7

> 赞同：0
> 
> 时间：2014-09-16T12:01:50.420

VisualSVN Server 的[Multisite Repository Replication](http://www.visualsvn.com/server/features/multisite-replication/)就是为这种情况而设计的。

您可以将主存储库保留在您的主要办公室，并在远程位置设置多个可写的从存储库。

> 这应该对开发人员尽可能透明。可用性是必须的。

*   从属和主控之间的复制是透明和自动的，

*   从用户的角度来看，每个主从存储库都是一个可写的 Subversion 存储库，

*   开箱即用，可以通过 VisualSVN 服务器管理器 MMC 控制台单击几下进行配置。

![VisualSVNServerManagerConsoleMultisite](https://i.stack.imgur.com/EG7fF.png)

# algorithm - 用于团查找的 Bron-Kerbosch 算法

> ID：143140
> 
> 赞同：11
> 
> 时间：2008-09-27T06:44:31.433
> 
> 标签：algorithm, graph-theory, clique

谁能告诉我，在网上哪里可以找到 Bron-Kerbosch 算法的解释，或者在这里解释它是如何工作的？

我知道它发表在“算法 457：找到无向图的所有派系”一书中，但我找不到可以描述该算法的免费资源。

我不需要算法的源代码，我需要解释它是如何工作的。

* * *

## 回答 #1

> 赞同：8
> 
> 时间：2010-03-30T16:38:57.740

我在这里找到了算法的解释：[http](http://www.dfki.de/~neumann/ie-seminar/presentations/finding_cliques.pdf) ://www.dfki.de/~neumann/ie-seminar/presentations/finding_cliques.pdf 这是一个很好的解释......但我需要一个库或 C# 中的实现 -.- '

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2008-09-27T09:03:07.700

尝试找一个有 ACM 学生账户的人，他可以给你一份论文，地址在这里：[http ://portal.acm.org/citation.cfm?doid=362342.362367](http://portal.acm.org/citation.cfm?doid=362342.362367)

我刚刚下载了它，它只有两页长，在 Algol 60 中实现！

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2008-10-11T21:20:10.193

[这里](ftp://ftp-sop.inria.fr/geometrica/fcazals/papers/ncliques.pdf)有算法我已经使用Java链表作为集合R，P，X重写了它，它就像一个魅力（好的是在根据算法进行集合操作时使用函数“retainAll”）。

由于重写算法时的优化问题，我建议您考虑一下实现

* * *

## 回答 #4

> 赞同：2
> 
> 时间：2014-06-25T17:59:03.260

我还试图围绕 Bron-Kerbosch 算法进行思考，所以我用 python 编写了自己的实现。它包括一个测试用例和一些评论。希望这可以帮助。

```
class Node(object):

    def __init__(self, name):
        self.name = name
        self.neighbors = []

    def __repr__(self):
        return self.name

A = Node('A')
B = Node('B')
C = Node('C')
D = Node('D')
E = Node('E')

A.neighbors = [B, C]
B.neighbors = [A, C]
C.neighbors = [A, B, D]
D.neighbors = [C, E]
E.neighbors = [D]

all_nodes = [A, B, C, D, E]

def find_cliques(potential_clique=[], remaining_nodes=[], skip_nodes=[], depth=0):

    # To understand the flow better, uncomment this:
    # print (' ' * depth), 'potential_clique:', potential_clique, 'remaining_nodes:', remaining_nodes, 'skip_nodes:', skip_nodes

    if len(remaining_nodes) == 0 and len(skip_nodes) == 0:
        print 'This is a clique:', potential_clique
        return

    for node in remaining_nodes:

        # Try adding the node to the current potential_clique to see if we can make it work.
        new_potential_clique = potential_clique + [node]
        new_remaining_nodes = [n for n in remaining_nodes if n in node.neighbors]
        new_skip_list = [n for n in skip_nodes if n in node.neighbors]
        find_cliques(new_potential_clique, new_remaining_nodes, new_skip_list, depth + 1)

        # We're done considering this node.  If there was a way to form a clique with it, we
        # already discovered its maximal clique in the recursive call above.  So, go ahead
        # and remove it from the list of remaining nodes and add it to the skip list.
        remaining_nodes.remove(node)
        skip_nodes.append(node)

find_cliques(remaining_nodes=all_nodes) 
```

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2008-09-27T11:51:37.937

对于它的价值，我找到了一个 Java 实现：http: [//joelib.cvs.sourceforge.net/joelib/joelib2/src/joelib2/algo/clique/BronKerbosch.java ?view=markup](http://joelib.cvs.sourceforge.net/joelib/joelib2/src/joelib2/algo/clique/BronKerbosch.java?view=markup)

HTH。

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2012-01-28T16:54:02.760

我已经实现了论文中指定的两个版本。我了解到，未优化的版本，如果以递归方式解决，对理解算法有很大帮助。这是版本 1（未优化）的 python 实现：

```
def bron(compsub, _not, candidates, graph, cliques):
    if len(candidates) == 0 and len(_not) == 0:
        cliques.append(tuple(compsub))
        return
    if len(candidates) == 0: return
    sel = candidates[0]
    candidates.remove(sel)
    newCandidates = removeDisconnected(candidates, sel, graph)
    newNot = removeDisconnected(_not, sel, graph)
    compsub.append(sel)
    bron(compsub, newNot, newCandidates, graph, cliques)
    compsub.remove(sel)
    _not.append(sel)
    bron(compsub, _not, candidates, graph, cliques) 
```

然后你调用这个函数：

```
graph = # 2x2 boolean matrix
cliques = []
bron([], [], graph, cliques) 
```

该变量`cliques`将包含找到的派系。

一旦你理解了这一点，就很容易实现优化。

* * *

## 回答 #7

> 赞同：0
> 
> 时间：2012-06-17T12:41:18.713

Boost::Graph 有一个很好的 Bron-Kerbosh 算法实现，给它一个检查。

# c++ - std::list 上的 splice() 和迭代器失效

> ID：143156
> 
> 赞同：12
> 
> 时间：2008-09-27T06:57:27.753
> 
> 标签：c++, list, containers, iterator

的 3 参数形式`list::splice()`将单个元素从一个列表移动到另一个列表。 [SGI 的文档](http://techpubs.sgi.com/library/tpl/cgi-bin/init.cgi)明确指出所有迭代器，*包括指向被移动元素的*迭代器仍然有效。 [Roguewave 的文档](http://www2.roguewave.com/support/docs/)没有说明`splice()`方法的迭代器失效属性，而 C++ 标准明确声明它使所有迭代器和对被拼接元素的引用失效。

splicing() 在实践中按照 SGI 的定义工作，但在微软 STL 实现的调试/安全 SCL 版本（严格遵循标准的字母）中出现断言失败（取消引用无效迭代器）。

现在，我使用 list 正是因为我想在列表之间移动一个元素，同时保留指向它的迭代器的有效性。该标准对原始 SGI 的规范进行了极其无益的更改。

我该如何解决这个问题？或者我应该务实一点，把头埋在沙子里（因为在实践中拼接不会**使**迭代器失效——即使在 MS 的实现中，一旦迭代器调试被关闭）。

* * *

## 回答 #1

> 赞同：11
> 
> 时间：2008-09-27T07:05:05.643

[好的，根据这个](http://www.open-std.org/jtc1/sc22/wg21/docs/lwg-defects.html#250)和[这个](http://www.open-std.org/jtc1/sc22/wg21/docs/lwg-defects.html#278)链接，这似乎是标准中的一个缺陷。似乎“把头埋在沙子里”是一个好策略，因为它将在新的库版本中得到修复。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2008-09-27T07:10:29.920

问题是如果迭代器仍然指向被移动的元素，那么之前与“移动”迭代器关联的“结束”迭代器已经改变。除非您编写一些复杂的循环，否则这实际上是一件坏事——尤其是因为其他开发人员更难以理解。

我认为更好的方法是使用指向移动迭代器之前和之后元素的迭代器。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2008-09-27T10:55:16.293

我有一个列表数组（元素的等效类），并且我正在使用 splice 在列表之间移动元素。我有一个额外的迭代器数组，可以让我直接访问任何列表中的任何元素并将其移动到另一个列表。不会同时搜索和修改任何列表。我*可以*在拼接后重新初始化元素迭代器，但这有点难看。我想我暂时会这样做。

# sharepoint - 您是否已将 MOSS SharePoint 2007 移出 C:\Inetpub\wwwroot\wss\ 文件夹？

> ID：143162
> 
> 赞同：1
> 
> 时间：2008-09-27T07:03:26.787
> 
> 标签：sharepoint, iis

最好*不要*将 C:\Inetpub\wwwroot\wss\ 用于 SharePoint 吗？我担心的是配置向导似乎在寻找这个 C: 路径，*不*使用默认路径可能太复杂了，

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2008-09-27T16:55:55.037

使用备用位置的原因是什么？

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2008-09-27T16:50:57.890

过去仅仅尝试在安装 Sharepoint 后更改 VM 上的机器名称就惨遭失败，很难想象比这个想法更可能令人沮丧的目标！

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2008-09-27T23:55:53.280

我听到的关于不在 Inetpub 目录之外运行 IIS 网站的唯一论据是，它是作恶者在攻击系统时查看的众所周知的位置，但如果您担心安全问题，那么如果攻击者拥有文件系统访问权限。

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2008-09-28T21:34:37.340

您不应该通过 IIS 管理器更改 sharepoint IIS 站点中的任何内容，除非通过 sharepoint Central Admin 站点。共享点配置中的依赖项不仅存储在 IIS 中，尤其是围绕应用程序池等的用户。这个网站完成了您需要做的大部分事情（即主机头等）

所以最佳实践是在 C:\Inetpub\wwwroot\wss\ 中创建一个易于映射到 Web 应用程序的文件夹，然后保持该文件夹不变。

尽管很难在 Central Admin 站点中找到内容，但 SharePoint 的[基础结构更新](http://www.microsoft.com/downloads/details.aspx?FamilyID=256CE3C3-6A42-4953-8E1B-E0BF27FD465B&displaylang=en)会有所帮助。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2008-09-27T12:34:15.213

我们总是让配置向导为我们选择那个位置。底层配置的很多方面都依赖于该位置，而且似乎不值得探索更改主目录。

# linux - 如何使用 xargs 复制名称中包含空格和引号的文件？

> ID：143171
> 
> 赞同：242
> 
> 时间：2008-09-27T07:10:48.330
> 
> 标签：linux, macos, unix, command-line, xargs

我正在尝试复制目录下的一堆文件，并且许多文件的名称中有空格和单引号。当我尝试将`find`和`grep`with串在一起时`xargs`，出现以下错误：

```
find .|grep "FooBar"|xargs -I{} cp "{}" ~/foo/bar
xargs: unterminated quote 
```

关于更强大地使用 xargs 的任何建议？

这是在带有 BSD的[Mac OS X 10.5.3](http://en.wikipedia.org/wiki/Mac_OS_X_Leopard)`xargs` (Leopard) 上。

* * *

## 回答 #1

> 赞同：206
> 
> 时间：2008-09-27T08:22:19.750

您可以将所有这些组合到一个`find`命令中：

```
find . -iname "*foobar*" -exec cp -- "{}" ~/foo/bar \; 
```

这将处理带有空格的文件名和目录。您可以使用`-name`来获得区分大小写的结果。

注意：`--`传递给的标志`cp`阻止它处理`-`以选项开头的文件。

* * *

## 回答 #2

> 赞同：122
> 
> 时间：2008-09-27T07:15:54.557

`find . -print0 | grep --null 'FooBar' | xargs -0 ...`

我不知道在 Leopard 上是否`grep`支持`--null`，也不知道是否`xargs`支持`-0`，但在 GNU 上一切都很好。

* * *

## 回答 #3

> 赞同：101
> 
> 时间：2015-11-04T17:21:16.440

做原始海报想要做的最简单的方法是将分隔符从任何空格更改为仅像这样的行尾字符：

```
find whatever ... | xargs -d "\n" cp -t /var/tmp 
```

* * *

## 回答 #4

> 赞同：74
> 
> 时间：2008-09-29T14:50:21.390

这更有效，因为它不会多次运行“cp”：

```
find -name '*FooBar*' -print0 | xargs -0 cp -t ~/foo/bar 
```

* * *

## 回答 #5

> 赞同：65
> 
> 时间：2012-08-22T05:57:43.863

我遇到了同样的问题。这是我解决它的方法：

```
find . -name '*FoooBar*' | sed 's/.*/"&"/' | xargs cp ~/foo/bar 
```

我曾经`sed`用同一行替换每一行输入，但用双引号括起来。在`sed`手册页中，“ *...替换中出现的 & 符号 (``&'') 被匹配 RE... 的字符串替换*”——在这种情况下，`.*`是整行。

这解决了`xargs: unterminated quote`错误。

* * *

## 回答 #6

> 赞同：56
> 
> 时间：2013-08-28T19:20:38.767

此方法适用于[Mac OS X v10.7.5](http://en.wikipedia.org/wiki/Mac_OS_X_Lion) (Lion)：

```
find . | grep FooBar | xargs -I{} cp {} ~/foo/bar 
```

我还测试了您发布的确切语法。这在 10.7.5 上也可以正常工作。

* * *

## 回答 #7

> 赞同：13
> 
> 时间：2013-06-26T16:41:06.867

只是不要使用`xargs`. `find`这是一个简洁的程序，但在面对非平凡的情况时它并不顺利。

`find`这是一个便携式（POSIX）解决方案，即不需要`xargs`或`cp`GNU 特定扩展的解决方案：

```
find . -name "*FooBar*" -exec sh -c 'cp -- "$@" ~/foo/bar' sh {} + 
```

注意结尾`+`而不是更通常的`;`.

这个解决方案：

*   正确处理带有嵌入空格、换行符或任何外来字符的文件和目录。

*   适用于任何 Unix 和 Linux 系统，即使是那些不提供 GNU 工具包的系统。

*   不使用`xargs`which 是一个很好且有用的程序，但需要太多的调整和非标准功能才能正确处理`find`输出。

*   也比公认的和大多数（如果不是全部）其他答案**更有效**（阅读**速度更快）。**

另请注意，尽管在其他一些回复或评论中说明了什么，但引用`{}`是无用的（除非您使用的是异国情调的`fish`外壳）。

* * *

## 回答 #8

> 赞同：8
> 
> 时间：2008-09-27T07:16:20.203

研究在 find 中使用带有 -print0 选项的 xargs 的 --null 命令行选项。

* * *

## 回答 #9

> 赞同：8
> 
> 时间：2014-03-20T14:10:43.927

对于那些依赖命令而不是 find 的人，例如`ls`：

```
find . | grep "FooBar" | tr \\n \\0 | xargs -0 -I{} cp "{}" ~/foo/bar 
```

* * *

## 回答 #10

> 赞同：6
> 
> 时间：2012-02-09T22:23:51.527

```
find | perl -lne 'print quotemeta' | xargs ls -d 
```

我相信这对于除换行符以外的任何字符都可以可靠地工作（我怀疑如果你的文件名中有换行符，那么你遇到的问题比这更糟糕）。它不需要 GNU findutils，只需要 Perl，所以它几乎可以在任何地方工作。

* * *

## 回答 #11

> 赞同：5
> 
> 时间：2009-01-23T22:39:33.383

我发现以下语法对我很有效。

```
find /usr/pcapps/ -mount -type f -size +1000000c | perl -lpe ' s{ }{\\ }g ' | xargs ls -l | sort +4nr | head -200 
```

在这个例子中，我在安装在“/usr/pcapps”的文件系统中寻找最大的 200 个文件，超过 1,000,000 字节。

“find”和“xargs”之间的 Perl 换行符转义/引用每个空白，因此“xargs”将任何带有嵌入空白的文件名作为单个参数传递给“ls”。

* * *

## 回答 #12

> 赞同：3
> 
> 时间：2014-01-01T13:09:45.457

使用 Bash（不是 POSIX），您可以使用进程替换来获取变量中的当前行。这使您能够使用引号来转义特殊字符：

```
while read line ; do cp "$line" ~/bar ; done < <(find . | grep foo) 
```

* * *

## 回答 #13

> 赞同：3
> 
> 时间：2019-06-28T08:43:05.630

框架挑战——你在问如何使用 xargs。答案是：你不使用 xargs，因为你不需要它。

[注释`user80168`](https://stackoverflow.com/questions/143171/how-can-i-use-xargs-to-copy-files-that-have-spaces-and-quotes-in-their-names#comment20387811_143222)描述了一种直接使用 cp 执行此操作的方法，无需为每个文件调用 cp ：

```
find . -name '*FooBar*' -exec cp -t /tmp -- {} + 
```

这有效，因为：

*   该`cp -t`标志允许在 的开头附近给出目标目录`cp`，而不是在结尾附近。来自`man cp`：

> ```
>  -t, --target-directory=DIRECTORY
>          copy all SOURCE arguments into DIRECTORY 
> ```

*   该`--`标志告诉将后面的所有内容解释为文件名，而不是标志，因此以或不混淆`cp`开头的文件; 你仍然需要这个，因为/字符由 解释，而任何其他特殊字符由 shell 解释。`-``--``cp``-``--``cp`

*   该`find -exec command {} +`变体本质上与 xargs 相同。来自`man find`：

> ```
>  -exec command {} +                                                     
>          This  variant  of the -exec action runs the specified command on
>          the selected files, but the command line is built  by  appending
>          each  selected file name at the end; the total number of invoca‐
>          matched  files.   The command line is built in much the same way
>          that xargs builds its command lines.  Only one instance of  `{}'
>          is  allowed  within the command, and (when find is being invoked
>          from a shell) it should be quoted (for example, '{}') to protect
>          it  from  interpretation  by shells.  The command is executed in
>          the starting directory.  If any invocation  returns  a  non-zero
>          value  as exit status, then find returns a non-zero exit status.
>          If find encounters an error, this can sometimes cause an immedi‐
>          ate  exit, so some pending commands may not be run at all.  This
>          variant of -exec always returns true. 
> ```

通过直接在 find 中使用它，这避免了管道或 shell 调用的需要，这样您就不必担心文件名中的任何讨厌的字符。

* * *

## 回答 #14

> 赞同：2
> 
> 时间：2008-10-02T07:00:01.090

请注意，其他答案中讨论的大多数选项在不使用 GNU 实用程序的平台（例如 Solaris、AIX、HP-UX）上不是标准的。请参阅[POSIX](http://www.opengroup.org/onlinepubs/009695399/toc.htm)规范以了解“标准”xargs 行为。

我还发现 xargs 的行为，即使没有输入，它也会至少运行一次命令，这很麻烦。

我编写了自己的私有版本的 xargs (xargl) 来处理名称中的空格问题（只有换行符分开 - 尽管 'find ... -print0' 和 'xargs -0' 组合非常简洁，因为文件名不能包含 ASCII NUL '\0' 字符。我的 xargl 并不像值得发布的那样完整 - 特别是因为 GNU 具有至少一样好的设施。

* * *

## 回答 #15

> 赞同：2
> 
> 时间：2015-10-08T01:58:36.057

对我来说，我试图做一些不同的事情。我想将我的 .txt 文件复制到我的 tmp 文件夹中。.txt 文件名包含空格和撇号字符。这适用于我的 Mac。

```
$ find . -type f -name '*.txt' | sed 's/'"'"'/\'"'"'/g' | sed 's/.*/"&"/'  | xargs -I{} cp -v {} ./tmp/ 
```

* * *

## 回答 #16

> 赞同：1
> 
> 时间：2009-06-17T01:53:47.073

[bill_starr 的 Perl 版本](https://stackoverflow.com/questions/143171/how-can-i-use-xargs-to-copy-files-that-have-spaces-and-quotes-in-their-names#474907)不适用于嵌入式换行符（仅处理空格）。对于那些在 Solaris 上没有 GNU 工具的用户，更完整的版本可能是（使用 sed）...

```
find -type f | sed 's/./\\&/g' | xargs grep string_to_find 
```

根据需要调整 find 和 grep 参数或其他命令，但 sed 将修复嵌入的换行符/空格/制表符。

* * *

## 回答 #17

> 赞同：1
> 
> 时间：2010-10-31T17:15:31.670

我使用了在 Solaris 上稍作修改[的 Bill Star 的答案：](https://stackoverflow.com/questions/143171/how-can-i-use-xargs-to-copy-files-that-have-spaces-and-quotes-in-their-names#474907)

```
find . -mtime +2 | perl -pe 's{^}{\"};s{$}{\"}' > ~/output.file 
```

这将在每一行周围加上引号。我没有使用“-l”选项，尽管它可能会有所帮助。

我要去的文件列表可能有'-'，但没有换行符。我没有将输出文件与任何其他命令一起使用，因为我想在开始通过 xargs 大量删除它们之前查看找到的内容。

* * *

## 回答 #18

> 赞同：1
> 
> 时间：2015-03-27T14:49:21.203

如果您的系统上的 find 和 xarg 版本不支持`-print0`和`-0`切换（例如 AIX find 和 xargs），您可以使用这个看起来很糟糕的代码：

```
 find . -name "*foo*" | sed -e "s/'/\\\'/g" -e 's/"/\\"/g' -e 's/ /\\ /g' | xargs cp /your/dest 
```

这里 sed 将负责转义 xargs 的空格和引号。

在 AIX 5.3 上测试

* * *

## 回答 #19

> 赞同：1
> 
> 时间：2015-08-05T19:54:41.323

我玩了一点，开始考虑修改 xargs，并意识到对于我们在这里讨论的那种用例，在 Python 中进行简单的重新实现是一个更好的主意。

一方面，整个事情有大约 80 行代码意味着很容易弄清楚发生了什么，如果需要不同的行为，您可以在比获取时间更短的时间内将其破解为新脚本在 Stack Overflow 之类的地方回复。

请参阅[https://github.com/johnallsup/jda-misc-scripts/blob/master/yargs](https://github.com/johnallsup/jda-misc-scripts/blob/master/yargs)和[https://github.com/johnallsup/jda-misc-scripts/blob/master/zargs.py](https://github.com/johnallsup/jda-misc-scripts/blob/master/zargs.py)。

使用 yargs 编写（并安装 Python 3），您可以键入：

```
find .|grep "FooBar"|yargs -l 203 cp --after ~/foo/bar 
```

一次复制203个文件。（当然，这里的 203 只是一个占位符，使用像 203 这样的奇怪数字可以清楚地表明这个数字没有其他意义。）

如果您真的想要更快且不需要 Python 的东西，请将 zargs 和 yargs 作为原型并用 C++ 或 C 重写。

* * *

## 回答 #20

> 赞同：1
> 
> 时间：2018-03-17T17:47:48.223

我围绕“xargs”创建了一个名为“xargsL”的小型便携式包装脚本，它解决了大部分问题。

与 xargs 不同，xargsL 每行接受一个路径名。路径名可以包含除（显然）换行符或 NUL 字节之外的任何字符。

文件列表中不允许或支持引用 - 您的文件名可能包含各种空格、反斜杠、反引号、shell 通配符等 - xargsL 会将它们作为文字字符处理，不会造成任何伤害。

作为一个额外的奖励功能，如果没有输入，xargsL 将*不会运行该命令一次！*

注意区别：

```
$ true | xargs echo no data
no data

$ true | xargsL echo no data # No output 
```

给 xargsL 的任何参数都将传递给 xargs。

这是“xargsL”POSIX shell 脚本：

> ```
> #! /bin/sh
> # Line-based version of "xargs" (one pathname per line which may contain any
> # amount of whitespace except for newlines) with the added bonus feature that
> # it will not execute the command if the input file is empty.
> #
> # Version 2018.76.3
> #
> # Copyright (c) 2018 Guenther Brunthaler. All rights reserved.
> #
> # This script is free software.
> # Distribution is permitted under the terms of the GPLv3.
> 
> set -e
> trap 'test $? = 0 || echo "$0 failed!" >& 2' 0
> 
> if IFS= read -r first
> then
>         {
>                 printf '%s\n' "$first"
>                 cat
>         } | sed 's/./\\&/g' | xargs ${1+"$@"}
> fi 
> ```

将脚本放入 $PATH 中的某个目录，不要忘记

`$ chmod +x xargsL`

那里的脚本使其可执行。

* * *

## 回答 #21

> 赞同：0
> 
> 时间：2013-06-26T16:02:22.980

您可能需要 grep Foobar 目录，例如：

```
find . -name "file.ext"| grep "FooBar" | xargs -i cp -p "{}" . 
```

* * *

## 回答 #22

> 赞同：-1
> 
> 时间：2014-05-21T02:50:59.663

如果您使用的是 Bash，则可以通过以下方式将*stdout*转换为行数组`mapfile`：

```
find . | grep "FooBar" | (mapfile -t; cp "${MAPFILE[@]}" ~/foobar) 
```

好处是：

*   它是内置的，因此速度更快。
*   一次执行所有文件名的命令，因此速度更快。
*   您可以将其他参数附加到文件名。对于`cp`，您还可以：

    ```
    find . -name '*FooBar*' -exec cp -t ~/foobar -- {} + 
    ```

    但是，有些命令没有这样的功能。

缺点：

*   如果文件名太多，可能无法很好地扩展。（限制？我不知道，但我在 Debian 下测试了 10 MB 的列表文件，其中包含 10000 多个文件名，没有问题）

嗯...谁知道 Bash 在 OS X 上是否可用？

# c++ - 如何获取程序运行的目录？

> ID：143174
> 
> 赞同：280
> 
> 时间：2008-09-27T07:18:29.403
> 
> 标签：c++, c, working-directory

是否有一种与平台无关和与文件系统无关的方法来获取使用 C/C++ 运行程序的目录的完整路径？不要与当前工作目录混淆。（请不要推荐库，除非它们是标准库，如 clib 或 STL。）

（如果没有与平台/文件系统无关的方法，也欢迎在 Windows 和 Linux 中针对特定文件系统工作的建议。）

* * *

## 回答 #1

> 赞同：192
> 
> 时间：2008-10-13T16:01:28.090

这是获取执行应用程序的完整路径的代码：

视窗：

```
char pBuf[256];
size_t len = sizeof(pBuf); 
int bytes = GetModuleFileName(NULL, pBuf, len);
return bytes ? bytes : -1; 
```

Linux：

```
int bytes = MIN(readlink("/proc/self/exe", pBuf, len), len - 1);
if(bytes >= 0)
    pBuf[bytes] = '\0';
return bytes; 
```

* * *

## 回答 #2

> 赞同：172
> 
> 时间：2008-09-28T06:04:04.923

如果您在程序第一次启动时获取当前目录，那么您实际上拥有了启动程序的目录。将值存储在变量中，稍后在程序中引用它。这与[保存当前可执行程序文件的目录](https://stackoverflow.com/q/933850/33732)不同。它不一定是同一个目录；如果有人从命令提示符运行程序，那么即使程序文件位于其他位置，程序也会*从命令提示符的当前工作目录运行。*

getcwd 是一个 POSIX 函数，所有兼容 POSIX 的平台都支持开箱即用。您不必做任何特别的事情（除了在 Unix 上包含正确的头文件 unistd.h 和在 Windows 上包含 direct.h ）。

由于您正在创建一个 C 程序，它将与默认的 c 运行时库链接，该库由系统中的所有进程链接（避免特制的异常），并且默认情况下将包含此函数。CRT 从未被视为外部库，因为它为操作系统提供了基本的标准兼容接口。

在 Windows 上，getcwd 函数已被弃用，取而代之的是 _getcwd。我认为您可以以这种方式使用它。

```
#include <stdio.h>  /* defines FILENAME_MAX */
#ifdef WINDOWS
    #include <direct.h>
    #define GetCurrentDir _getcwd
#else
    #include <unistd.h>
    #define GetCurrentDir getcwd
 #endif

 char cCurrentPath[FILENAME_MAX];

 if (!GetCurrentDir(cCurrentPath, sizeof(cCurrentPath)))
     {
     return errno;
     }

cCurrentPath[sizeof(cCurrentPath) - 1] = '\0'; /* not really required */

printf ("The current working directory is %s", cCurrentPath); 
```

* * *

## 回答 #3

> 赞同：46
> 
> 时间：2013-10-23T07:37:39.890

这是来自[cplusplus 论坛](http://www.cplusplus.com/forum/general/11104/)

**在窗户上：**

```
#include <string>
#include <windows.h>

std::string getexepath()
{
  char result[ MAX_PATH ];
  return std::string( result, GetModuleFileName( NULL, result, MAX_PATH ) );
} 
```

**在 Linux 上：**

```
#include <string>
#include <limits.h>
#include <unistd.h>

std::string getexepath()
{
  char result[ PATH_MAX ];
  ssize_t count = readlink( "/proc/self/exe", result, PATH_MAX );
  return std::string( result, (count > 0) ? count : 0 );
} 
```

**在 HP-UX 上：**

```
#include <string>
#include <limits.h>
#define _PSTAT64
#include <sys/pstat.h>
#include <sys/types.h>
#include <unistd.h>

std::string getexepath()
{
  char result[ PATH_MAX ];
  struct pst_status ps;

  if (pstat_getproc( &ps, sizeof( ps ), 0, getpid() ) < 0)
    return std::string();

  if (pstat_getpathname( result, PATH_MAX, &ps.pst_fid_text ) < 0)
    return std::string();

  return std::string( result );
} 
```

* * *

## 回答 #4

> 赞同：29
> 
> 时间：2008-09-27T07:23:51.933

如果您想要一种没有库的标准方式：不。目录的整个概念不包含在标准中。

如果您同意对接近标准库的某些（可移植）依赖是可以的：使用[Boost 的文件系统库](http://www.boost.org/doc/libs/1_36_0/libs/filesystem/doc/reference.html)并请求[initial_path()](http://www.boost.org/doc/libs/1_36_0/libs/filesystem/doc/reference.html#initial_path)。

恕我直言，你可以得到尽可能接近，具有良好的业力（Boost 是一套完善的高质量库）

* * *

## 回答 #5

> 赞同：23
> 
> 时间：2015-08-15T10:58:58.727

我知道在这一天给出答案已经很晚了，但我发现没有一个答案对我来说像我自己的解决方案那样有用。获取从 CWD 到 bin 文件夹的路径的一种非常简单的方法是：

```
int main(int argc, char* argv[])
{
    std::string argv_str(argv[0]);
    std::string base = argv_str.substr(0, argv_str.find_last_of("/"));
} 
```

您现在可以将其用作相对路径的基础。所以例如我有这个目录结构：

```
main
  ----> test
  ----> src
  ----> bin 
```

我想将我的源代码编译到 bin 并写一个日志来测试我可以将这一行添加到我的代码中。

```
std::string pathToWrite = base + "/../test/test.log"; 
```

我已经使用完整路径、别名等在 Linux 上尝试了这种方法，并且效果很好。

笔记：

如果您在 Windows 上，则应使用“\”作为文件分隔符，而不是“/”。你也必须逃避这个，例如：

```
std::string base = argv[0].substr(0, argv[0].find_last_of("\\")); 
```

我认为这应该可行，但尚未测试，因此如果可行，请发表评论，如果不可行，请进行修复。

* * *

## 回答 #6

> 赞同：21
> 
> 时间：2016-01-16T22:20:02.357

文件系统 TS[现在是一个标准](http://www.iso.org/iso/catalogue_detail.htm?csnumber=63483)（gcc 5.3+ 和 clang 3.9+ 支持），所以你可以使用[`current_path()`](http://en.cppreference.com/w/cpp/experimental/fs/current_path)它的函数：

```
std::string path = std::experimental::filesystem::current_path(); 
```

在 gcc (5.3+) 中包含 Filesystem 您需要使用：

```
#include <experimental/filesystem> 
```

并将您的代码与`-lstdc++fs`标志链接。

如果您想将 Filesystem 与 Microsoft Visual Studio 一起使用，[请阅读此](https://msdn.microsoft.com/en-us/library/hh874694).

* * *

## 回答 #7

> 赞同：10
> 
> 时间：2008-09-27T07:22:03.107

不，没有标准的方法。我相信 C/C++ 标准甚至不考虑目录（或其他文件系统组织）的存在。

在 Windows 上，当**hModule**参数设置为**NULL时，** **GetModuleFileName()**将返回当前进程的可执行文件的完整路径。我对 Linux 无能为力。

 ****~~此外，您应该澄清您想要当前目录还是程序图像/可执行文件所在的目录。就目前而言，您的问题在这一点上有点模棱两可。~~

* * *

## 回答 #8

> 赞同：10
> 
> 时间：2013-06-02T22:03:48.000

在 Windows 上，最简单的方法是使用`_get_pgmptr`函数 in`stdlib.h`获取指向字符串的指针，该字符串表示可执行文件的绝对路径，包括可执行文件的名称。

```
char* path;
_get_pgmptr(&path);
printf(path); // Example output: C:/Projects/Hello/World.exe 
```

* * *

## 回答 #9

> 赞同：8
> 
> 时间：2008-09-27T07:32:09.573

也许将当前工作目录与 argv[0] 连接起来？我不确定这是否适用于 Windows，但它适用于 linux。

例如：

```
#include <stdio.h>
#include <unistd.h>
#include <string.h>

int main(int argc, char **argv) {
    char the_path[256];

    getcwd(the_path, 255);
    strcat(the_path, "/");
    strcat(the_path, argv[0]);

    printf("%s\n", the_path);

    return 0;
} 
```

运行时，它输出：

> jeremy@jeremy-desktop:~/Desktop$ ./test
> /home/jeremy/Desktop/./test

* * *

## 回答 #10

> 赞同：7
> 
> 时间：2008-09-27T07:21:01.223

对于 Win32 [GetCurrentDirectory](http://msdn.microsoft.com/en-us/library/aa364934(VS.85).aspx)应该可以解决问题。

* * *

## 回答 #11

> 赞同：6
> 
> 时间：2008-09-27T08:17:00.387

您不能为此目的使用 argv[0]，通常它确实包含可执行文件的完整路径，但不是必须的 - 可以在字段中使用任意值创建进程。

另外请注意，当前目录和包含可执行文件的目录是两个不同的东西，因此 getcwd() 也无济于事。

在 Windows 上使用 GetModuleFileName()，在 Linux 上读取 /dev/proc/ *procID* /.. 文件。

* * *

## 回答 #12

> 赞同：4
> 
> 时间：2020-03-22T19:44:23.713

只是我的两分钱，但以下代码不能在 C++17 中可移植地工作吗？

```
#include <iostream>
#include <filesystem>
namespace fs = std::filesystem;

int main(int argc, char* argv[])
{
    std::cout << "Path is " << fs::path(argv[0]).parent_path() << '\n';
} 
```

似乎至少在 Linux 上对我有用。

基于之前的想法，我现在有：

```
std::filesystem::path prepend_exe_path(const std::string& filename, const std::string& exe_path = ""); 
```

通过实施：

```
fs::path prepend_exe_path(const std::string& filename, const std::string& exe_path)
{
    static auto exe_parent_path = fs::path(exe_path).parent_path();
    return exe_parent_path / filename;
} 
```

和初始化技巧`main()`：

```
(void) prepend_exe_path("", argv[0]); 
```

感谢@Sam Redway 的 argv[0] 想法。当然，我知道当 OP 提出这个问题时，C++17 已经存在很多年了。

* * *

## 回答 #13

> 赞同：3
> 
> 时间：2010-01-27T23:50:14.493

只是为了迟来的堆积在这里，...

没有标准的解决方案，因为这些语言与底层文件系统无关，所以正如其他人所说，基于目录的文件系统的概念超出了 c / c++ 语言的范围。

最重要的是，您想要的不是当前工作目录，而是程序正在运行的目录，这必须考虑程序如何到达它的位置 - 即它是否通过 fork 等作为新进程产生。如解决方案所示，要获取程序运行所在的目录，需要您从相关操作系统的进程控制结构中获取该信息，这是该问题的唯一权威。因此，根据定义，它是特定于操作系统的解决方案。

* * *

## 回答 #14

> 赞同：3
> 
> 时间：2013-06-10T16:52:50.567

对于控制台上的 Windows 系统，您可以使用 system( `dir`) 命令。控制台为您提供有关目录等的信息。`dir`在`cmd`. 但是对于类 Unix 系统，我不知道……如果运行此命令，请阅读 bash 命令。`ls`不显示目录...

例子：

```
int main()
{
    system("dir");
    system("pause"); //this wait for Enter-key-press;
    return 0;
} 
```

* * *

## 回答 #15

> 赞同：3
> 
> 时间：2014-02-19T17:15:35.623

```
#include <windows.h>
using namespace std;

// The directory path returned by native GetCurrentDirectory() no end backslash
string getCurrentDirectoryOnWindows()
{
    const unsigned long maxDir = 260;
    char currentDir[maxDir];
    GetCurrentDirectory(maxDir, currentDir);
    return string(currentDir);
} 
```

* * *

## 回答 #16

> 赞同：2
> 
> 时间：2019-06-10T12:22:04.833

从 C++11 开始，使用实验文件系统，C++14-C++17 以及使用官方文件系统。

应用程序.h：

```
#pragma once

//
// https://en.cppreference.com/w/User:D41D8CD98F/feature_testing_macros
//
#ifdef __cpp_lib_filesystem
#include <filesystem>
#else
#include <experimental/filesystem>

namespace std {
    namespace filesystem = experimental::filesystem;
}
#endif

std::filesystem::path getexepath(); 
```

应用程序.cpp：

```
#include "application.h"
#ifdef _WIN32
#include <windows.h>    //GetModuleFileNameW
#else
#include <limits.h>
#include <unistd.h>     //readlink
#endif

std::filesystem::path getexepath()
{
#ifdef _WIN32
    wchar_t path[MAX_PATH] = { 0 };
    GetModuleFileNameW(NULL, path, MAX_PATH);
    return path;
#else
    char result[PATH_MAX];
    ssize_t count = readlink("/proc/self/exe", result, PATH_MAX);
    return std::string(result, (count > 0) ? count : 0);
#endif
} 
```

* * *

## 回答 #17

> 赞同：1
> 
> 时间：2015-04-21T05:21:19.423

对于相对路径，这就是我所做的。我知道这个问题的年龄，我只是想提供一个在大多数情况下都有效的更简单的答案：

假设您有这样的路径：

```
"path/to/file/folder" 
```

出于某种原因，在 Eclipse 中制作的 Linux 构建的可执行文件可以正常工作。但是，如果给定这样的路径，Windows 会变得非常困惑！

如上所述，有几种方法可以获取可执行文件的当前路径，但我发现在大多数情况下最简单的方法是将其附加到路径的前面：

```
"./path/to/file/folder" 
```

只需添加“./”即可让您排序！:) 然后你可以从你想要的任何目录开始加载，只要它与可执行文件本身一起。

编辑：如果您尝试从 code::blocks 启动可执行文件，如果那是正在使用的开发环境，这将不起作用，因为某种原因，code::blocks 不能正确加载东西......：D

EDIT2：我发现的一些新东西是，如果您在代码中指定像这样的静态路径（假设 Example.data 是您需要加载的东西）：

```
"resources/Example.data" 
```

如果您然后从实际目录启动您的应用程序（或在 Windows 中，您创建一个快捷方式，并将工作目录设置为您的应用程序目录），那么它将像这样工作。在调试与缺少资源/文件路径相关的问题时请记住这一点。（特别是在从 IDE 启动构建 exe 时设置错误工作目录的 IDE 中）

* * *

## 回答 #18

> 赞同：1
> 
> 时间：2017-10-04T09:38:03.557

图书馆解决方案（虽然我知道这不是要求）。如果你碰巧使用 Qt： `QCoreApplication::applicationDirPath()`

* * *

## 回答 #19

> 赞同：1
> 
> 时间：2020-12-28T07:36:08.220

当前 .exe 的路径

```
 #include <Windows.h>

std::wstring getexepathW()
{
    wchar_t result[MAX_PATH];
    return std::wstring(result, GetModuleFileNameW(NULL, result, MAX_PATH));
}

std::wcout << getexepathW() << std::endl;

//  -------- OR --------

std::string getexepathA()
{
    char result[MAX_PATH];
    return std::string(result, GetModuleFileNameA(NULL, result, MAX_PATH));
}

std::cout << getexepathA() << std::endl; 
```

* * *

## 回答 #20

> 赞同：0
> 
> 时间：2008-09-27T07:31:38.717

在 POSIX 平台上，您可以使用[getcwd()](http://www.opengroup.org/onlinepubs/009695399/functions/getcwd.html)。

在 Windows 上，您可以使用[_getcwd()](http://msdn.microsoft.com/en-us/library/sf98bd4y(VS.80).aspx)，因为[getcwd()](http://msdn.microsoft.com/en-us/library/ms235450(VS.80).aspx)的使用已被弃用。

对于标准库，如果 Boost 对您来说足够标准，我会建议 Boost::filesystem，但他们似乎已经从提案中删除了路径规范化。您可能必须等到[TR2 随时可用](http://www.open-std.org/jtc1/sc22/wg21/docs/papers/2006/n1975.html)，才能获得完全标准的解决方案。

* * *

## 回答 #21

> 赞同：0
> 
> 时间：2008-09-28T04:28:35.823

Boost Filesystem's 的`initial_path()`行为类似于 POSIX's `getcwd()`，并且您自己也不需要，但附加`argv[0]`到它们中的任何一个都应该这样做。

您可能会注意到结果并不总是很漂亮——您可能会得到类似`/foo/bar/../../baz/a.out`or的东西`/foo/bar//baz/a.out`，但我相信它总是会产生一个有效的路径来命名可执行文件（请注意，路径中的连续斜杠折叠为一个）。

`envp`我之前使用(第三个参数`main()`在 Linux 上工作但在 Windows 上似乎不工作) 编写了一个解决方案，所以我基本上推荐与其他人之前所做的相同的解决方案，但额外解释了为什么它实际上是正确的即使结果并不漂亮。

* * *

## 回答 #22

> 赞同：0
> 
> 时间：2010-01-28T00:26:18.837

正如*Minok 所*提到的，没有指定 ini C 标准或 C++ 标准的此类功能。这被认为是纯粹的操作系统特定功能，例如在 POSIX 标准中指定。

*Thorsten79*给出了很好的建议，它是 Boost.Filesystem 库。但是，如果您不想为您的程序提供任何二进制形式的链接时依赖项，这可能会带来不便。

我推荐的一个不错的选择是收集 100% 仅标头的[STLSoft C++ 库](http://en.wikipedia.org/wiki/STLSoft_C%2B%2B_Libraries) [Matthew Wilson](http://en.wikipedia.org/wiki/Matthew_Wilson_%28author%29)（有关 C++ 的必读书籍的作者）。有可移植的门面 PlatformSTL 可以访问系统特定的 API：Windows 的 WinSTL 和 Unix 的 UnixSTL，因此它是可移植的解决方案。所有特定于系统的元素都使用特征和策略指定，因此它是可扩展的框架。当然，提供了文件系统库。

* * *

## 回答 #23

> 赞同：0
> 
> 时间：2016-08-22T15:46:54.233

**progname**的 linux bash 命令 将报告程序的路径。

即使可以从您的程序中发出 which 命令并将输出定向到 tmp 文件，并且程序随后读取该 tmp 文件，它也不会告诉您该程序是否正在执行。它只告诉您具有该名称的程序所在的位置。

需要的是获取您的进程 ID 号，并解析出名称的路径

在我的程序中，我想知道程序是从用户的 bin 目录还是从路径中的另一个目录或 /usr/bin 执行的。/usr/bin 将包含支持的版本。我的感觉是，在 Linux 中有一种可移植的解决方案。

* * *

## 回答 #24

> 赞同：0
> 
> 时间：2019-05-09T13:15:54.900

`realpath()`像这样使用`stdlib.h`：

```
char *working_dir_path = realpath(".", NULL); 
```

* * *

## 回答 #25

> 赞同：0
> 
> 时间：2022-02-27T00:22:02.010

以下对我来说在 macOS 10.15.7 上运行良好

```
brew install boost 
```

主文件

```
#include <iostream>
#include <boost/filesystem.hpp>

int main(int argc, char* argv[]){
  boost::filesystem::path p{argv[0]};
  p = absolute(p).parent_path();
  std::cout << p << std::endl;
  return 0;
} 
```

编译

```
g++ -Wall -std=c++11 -l boost_filesystem main.cpp 
```

# release - 库与应用程序版本

> ID：143181
> 
> 赞同：1
> 
> 时间：2008-09-27T07:25:32.630
> 
> 标签：release, versions

如果您有一个发布库和应用程序的项目，您如何处理两者之间的版本号。

示例：您的项目提供了一个库，可将不同的文件格式相互转换。该库已发布以包含在其他应用程序中。但是您还发布了一个命令行应用程序，该应用程序使用该库并实现该功能的接口。

库的新版本会导致应用程序的新版本（以利用所有新功能），但应用程序的新版本可能不会触发库的新版本。现在如何处理版本号：完全独立还是应该以某种方式依赖库和应用程序版本？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2008-09-27T07:28:23.327

完全独立的版本号，但命令行（或任何其他相关）应用程序应该在帮助部分或横幅中说明它是针对哪个版本的库进行编译的。

这样，您将能够判断应用程序将具有哪些功能并减少潜在的混淆，特别是考虑到有人可以出于任何原因针对旧库编译较新的应用程序版本。此外，您可以将它们解耦并可以在库中添加功能，而无需依赖于新应用程序版本的发布等。

如果您确定您将始终希望所有应用程序和库同步进行，那么您可以使用相同的数字，但这并不是一个强有力的理由。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2008-09-27T11:30:12.153

我会说使用单独的版本号，当然还要记录应用程序的每个版本所需的最低库版本。如果它们始终具有相同的版本号，并且您只针对相同编号的库版本测试应用程序，那么它们并不是真正独立的组件，所以不要说它们是。将整个批次作为一个块释放。

如果你将它们分开，你仍然可以在适当的时候给它们相同的版本号——例如，在重大兼容性中断之后，你可能会同时发布两者的 2.0 版。

以下示例说明： xsltproc（命令行应用程序）作为 libxslt（库）的一部分发布，因此没有自己的版本号。但是 libxslt 依赖于另外两个库，并且它们的版本号是独立的。

```
$ xsltproc --version
Using libxml 20628, libxslt 10120 and libexslt 813
xsltproc was compiled against libxml 20628, libxslt 10120 and libexslt 813
libxslt 10120 was compiled against libxml 20628
libexslt 813 was compiled against libxml 20628 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2008-09-27T07:31:25.720

我们构建了一个使用框架的应用程序。我们为两者保留单独的版本号。

这很好用，尤其是现在框架和应用程序已经变得足够大，可以由不同的团队开发。

所以我的意见......保持版本号分开。

# sharepoint - 工作流系统中的单元/自动化测试

> ID：143183
> 
> 赞同：13
> 
> 时间：2008-09-27T07:27:16.933
> 
> 标签：sharepoint, unit-testing, k2

您是否在 K2 等复杂的工作流系统上进行自动化测试？

我们正在构建一个在 Sharepoint 2007 和 K2 之间进行广泛集成的系统。我什至无法想象从哪里开始自动化测试，因为工作流程涉及多个用户与 Sharepoint、K2 工作流程和自定义网页交互。

有人在 K2 这样的工作流服务器上做过自动化测试吗？付出比付出更多吗？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2008-09-27T08:06:03.203

我在测试工作流繁重的基于 MOSS 的应用程序时遇到了类似的问题。在我们的案例中，工作流程基于 WWF。

我的想法是模拟几乎所有你无法从单元测试中控制的东西——文档存储、身份验证、用户权限和操作、sharepoint 工作流的特定于共享点的部分（这些模拟应该经过彻底测试以反映真实组件的行为） .

您使用控制反转使代码选择在运行时使用哪个组件 - 真实或模拟。

然后你可以编写系统范围的测试来测试工作流的行为——设置你自己的环境，检查工作流引擎的反应。这些测试太大而不能称它们为单元测试，但它仍然是自动化测试。

这种方法似乎适用于琐碎的案例，但我仍然必须证明它值得在现实世界的工作流程中使用。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2009-03-11T20:01:42.270

[这是](http://blog.michaelckennedy.net/2009/01/18/significant-advances-in-unit-testing-windows-workflow/)我使用的解决方案。这是一个简单的运行时包装器，允许执行单个活动，简化参数传递，阻塞调用线程直到工作流或活动完成，并转换/重新抛出异常（如果有）。由于我的工作流仅通过自定义工作流服务发送或等待消息，因此我可以模拟该服务以期望来自工作流的某些消息并向其发布某些消息，在这里我正在为我的 WF 进行真正的单元测试！技术的功劳归功于迈克尔·肯尼迪。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2009-07-15T15:58:27.043

如果您要进行单元测试，[Typemock](http://www.typemock.com/sharepointpage.php) Isolator 是目前唯一可以模拟 SharePoint 对象的工具。

顺便说一句，[Richard Fennell](http://blogs.blackmarble.co.uk/blogs/rfennell/default.aspx)正在研究工作流模拟解决方案。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2008-12-09T15:35:42.513

我们今天刚刚编写了一个应用程序来监控我们的 K2 工作清单，从中提取某些任务，填写一些数据并提交任务以供完成。这使我们能够执行自动化测试，找到回归，并在人们花费的时间的一小部分内完成工作流的许多不同路径。我想可以编写一个类似的程序来伪装成共享点。

至于工作流项目本身的单元测试，我们有一个从 k2 引用的 dll，其中包含我们所有的线路规则和处理逻辑。我们在 k2 工作流本身中没有任何代码，它们都是从这些 dll 中引用的。这使我们可以轻松地在它们上编写单元测试来测试所有单独的行规则。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2011-01-24T22:22:04.383

我已经使用 K2ROM API（如果您使用 K2 blackpearl，可能是 SourceCode.Workflow.Client）对 K2 工作流程进行了自动化集成测试。

基本上，您在具有已知作品集的测试服务器上启动一个进程（我生成一个 GUID），然后使用管理 API 将其删除。我编写了诸如 AssertAtClientActivity 之类的辅助方法（基本上使用标准调用 ProvideWorkItem）。

对 StartProcessInstance、WorklistItem.Finish 等使用 IsSynchronous 参数，使相关方法调用在流程实例达到稳定状态之前不会返回。

预计测试会很慢并且偶尔会失败。这些不是单元测试。

如果您想针对其他系统编写单元测试，您可能需要包装 K2 API。

考虑查看[Windows Workflow 4](http://msdn.microsoft.com/en-us/netframework/aa663328)和[SharePoint 2010 中的新工作流功能](http://msdn.microsoft.com/en-us/magazine/ee335710.aspx)。您可能不需要 K2。

# c# - 让 Linq-toSQL 查询显示在 GridView 上

> ID：143194
> 
> 赞同：0
> 
> 时间：2008-09-27T07:46:02.723
> 
> 标签：c#, linq, linq-to-sql, gridview

我有一个非常复杂的 Linq 查询，我似乎无法进入 LinqDataSsource 以在 GridView 中使用：

```
IEnumerable<ticket> tikPart = (
    from p in db.comments where 
        p.submitter == me.id && 
        p.ticket.closed == DateTime.Parse("1/1/2001") && 
        p.ticket.originating_group != me.sub_unit 
    select p.ticket
    ).Distinct(); 
```

我怎样才能把它变成一个 GridView？谢谢！

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2008-09-27T07:47:23.657

```
gridview.DataSource = tikPart.ToList();
gridview.DataBind(); 
```

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2008-09-27T08:04:50.213

@leppie - 将 IQueryable 附加为数据源时，无需调用 ToList() 。

如果在调用 DataBind 方法之前尚未处理您的 DataContext，则 ToList 是一个冗余调用。

默认情况下，DataContext 使用延迟加载，以便仅在枚举 IQueryable 时从数据库中获取数据。ToList() 执行枚举并执行调用，DataBind() 也是如此。

所以你可以做这样的事情：

```
using(MyDataContext ctx = new MyDataContext(){
  this.MyGridView.DataSource = from something in ctx.Somethings where something.SomeProperty == someValue select something;
  this.MyGridView.DataBind();
} 
```

取决于您如何处理 DataContext 确定要绑定到数据源的内容。

然后，您可以在 GridView 上使用自动生成的列，以便返回对象中的每个属性都变成一列，或者您可以使用设计器编写列并在那里设置绑定规则。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2008-09-27T07:48:36.397

您可以在没有数据源的情况下设置 Gridview。设置 gridview 列，并在代码隐藏中将该结果绑定到网格视图。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2010-02-02T02:51:34.730

您可以使用 LinqDataSource 控件将 IQueryable<> 类型绑定到 GridView。[http://johnsobrepena.blogspot.com/2010/01/data-bind-coolgridview-to-iqueryable.html](http://johnsobrepena.blogspot.com/2010/01/data-bind-coolgridview-to-iqueryable.html)

# .net - 如何在 .NET 中获取当前窗口句柄计数和窗口句柄限制？

> ID：143206
> 
> 赞同：11
> 
> 时间：2008-09-27T08:03:04.973
> 
> 标签：.net, window, handle

我想在 C# 中获取当前窗口句柄数和系统范围的窗口句柄限制。我该怎么做？

* * *

## 回答 #1

> 赞同：19
> 
> 时间：2009-02-11T00:50:24.423

如果您阅读 Raymond Chen 的帖子，您可能会发现它和我一样烦人。您只是“可能做错了什么”，因为您正在做 Windows 无法做到的事情。

在我的应用程序中，当用户第一次访问标签页时，我创建并布置了该页上的所有控件。这需要相当长的时间——一个页面上很容易有 50 个控件。因此，如果可能的话，我不会在填充标签页后丢弃它，并将关闭的标签页集留给用户。

碰巧的是，一些用户从不想关闭*任何*一组标签页。我为什么要强迫他们这样做？使用我的 UI，他们可以非常快速地导航到他们负责管理的 300 多组交易中的任何一组。他们的机器足够快，并且有足够的内存，使这一切都非常敏感。唯一的问题是 Windows 不支持它。

为什么我使用控件，而不是其他一些 UI 技术？因为他们*工作*。我需要支持焦点事件、选项卡顺序、验证事件、动态布局和数据绑定——用户实际上是在内存数据集中管理数十个表中的数千条记录。我必须做的开发量 - 比如说 - 使用无窗口控件实现某些东西是天文数字。

我只是“做错了”，因为 Windows 对它可以支持的窗口句柄的数量有硬性限制。这个硬性限制是基于一堆关于如何构建计算机 UI 的十年前的假设。“做错事”的不是我。

无论如何，我对此的解决方案分为两部分。

首先，一个可以告诉您进程正在使用多少个窗口句柄的类：

```
using System;
using System.Runtime.InteropServices;

namespace StreamWrite.Proceedings.Client
{
    public class HWndCounter
    {
        [DllImport("kernel32.dll")]
        private static extern IntPtr GetCurrentProcess();

        [DllImport("user32.dll")]
        private static extern uint GetGuiResources(IntPtr hProcess, uint uiFlags);

        private enum ResourceType
        {
            Gdi = 0,
            User = 1
        }

        public static int GetWindowHandlesForCurrentProcess(IntPtr hWnd)
        {
            IntPtr processHandle = GetCurrentProcess();
            uint gdiObjects = GetGuiResources(processHandle, (uint)ResourceType.Gdi);
            uint userObjects = GetGuiResources(processHandle, (uint)ResourceType.User);

            return Convert.ToInt32(gdiObjects + userObjects);
        }
    }
} 
```

其次，我维护一个最近最少使用的标签页对象缓存。.NET 框架不提供通用 LRU 缓存类，因此我构建了一个，如果需要，可以[在此处获取。](http://csharp-lru-cache.googlecode.com)每次用户访问标签页时，我都会将其添加到 LRU 缓存中。然后我检查我是否在窗口句柄上运行不足。如果是，我会丢弃最近最少使用的标签页上的控件，并继续这样做，直到我再次有足够的窗口句柄为止。

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2008-09-27T08:17:05.847

正如 Raymond Chen 前段时间所说，如果您正在考虑窗口句柄限制，那么您可能做错了什么:)

无论如何，我敢打赌没有特殊的 C# 方法可以做到这一点，因为它是非常特定于系统的。您可以使用在 C++ 应用程序中使用的相同函数。使用 P/Invoke 调用函数。要了解如何编写导入，请访问[pinvoke.net](http://www.pinvoke.net)。

编辑：据我了解您的问题，我假设您已经知道如何在 Win32 应用程序中执行此操作。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2008-09-27T09:31:10.443

OregonGhost 引用的完整报价是

> 如果你不得不问，你可能做错了什么。

它来自[为什么每个进程的窗口句柄限制为 10,000？](https://devblogs.microsoft.com/oldnewthing/20070718-00/?p=25963)你应该读这个。

# asp.net - Silverlight 中的全屏模式

> ID：143212
> 
> 赞同：2
> 
> 时间：2008-09-27T08:07:21.640
> 
> 标签：asp.net, silverlight

是否可以使用silverlight以全屏模式显示图像。我正在寻找一些东西，比如 Flash 视频播放器的全屏选项。

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2008-09-27T12:05:57.857

你可以设置

Application.Current.Host.Content.IsFullScreen = true;

这必须通过鼠标按钮事件或单击来完成，您不能在没有用户交互的情况下强制用户进入全屏状态。

然后你需要缩放图像。如果它位于自动缩放的元素中，例如 Grid 单元格并且 Grid 自动调整大小（例如，如果它是页面上的根元素并且页面没有指定宽度或高度），那么你很好，但否则你'将需要处理 Application.Current.Host.Content.FullScreenChanged 事件并对图像或其容器调整大小或应用缩放变换以使其充满屏幕，并在返回非全屏模式时执行相同操作.

* * *

## 回答 #2

> 赞同：-1
> 
> 时间：2008-09-27T08:26:35.527

设置 System.Windows.Interop.BrowserHost.IsFullScreen = true。

# iphone - 如何在 iPhone 上使用 Quartz 显示文本？

> ID：143215
> 
> 赞同：7
> 
> 时间：2008-09-27T08:10:34.317
> 
> 标签：iphone, cocoa-touch, quartz-2d

我一直在尝试使用 Quartz 上下文显示文本，但无论我尝试了什么，我都没有运气让文本显示（尽管我能够显示各种其他 Quartz 对象）。有人知道我可能做错了什么吗？

例子：

```
-(void)drawRect:(CGRect)rect
{   
  // Drawing code
  CGContextRef  context = UIGraphicsGetCurrentContext();
  CGContextSelectFont(context, "Arial", 24, kCGEncodingFontSpecific);
  CGContextSetTextPosition(context,80,80);
  CGContextShowText(context, "hello", 6);
  //not even this works
  CGContextShowTextAtPoint(context, 1,1, "hello", 6);
} 
```

* * *

## 回答 #1

> 赞同：9
> 
> 时间：2010-08-11T13:13:48.407

好，我知道了。首先，将您的编码模式更改为 kCGEncodingMacRoman。其次，在它下面插入这一行：

```
CGContextSetTextMatrix(canvas, CGAffineTransformMake(1, 0, 0, -1, 0, 0)); 
```

这会设置文本的转换矩阵，以便正确绘制。如果您不输入该行，则您的文本将上下颠倒并从后向前。不知道为什么这不是默认设置。最后，确保您设置了正确的填充颜色。如果您忘记将背景颜色更改为文本颜色并最终得到白底白字，则很容易犯错误。

* * *

## 回答 #2

> 赞同：7
> 
> 时间：2008-09-27T10:04:29.770

这是我正在使用的代码片段。

```
UIColor *mainTextColor = [UIColor whiteColor];
[mainTextColor set];
drawTextLjust(@"Sample Text", 8, 50, 185, 18, 16); 
```

和：

```
static void drawTextLjust(NSString* text, CGFloat y, CGFloat left, CGFloat right,
                          int maxFontSize, int minFontSize) {
    CGPoint point = CGPointMake(left, y);
    UIFont *font = [UIFont systemFontOfSize:maxFontSize];
    [text drawAtPoint:point forWidth:right - left withFont:font
       minFontSize:minFontSize actualFontSize:NULL
       lineBreakMode:UILineBreakModeTailTruncation
       baselineAdjustment:UIBaselineAdjustmentAlignBaselines];
} 
```

# sql - 克隆分层数据

> ID：143226
> 
> 赞同：2
> 
> 时间：2008-09-27T08:26:43.390
> 
> 标签：sql, database-design, postgresql

让我们假设我有一个自引用分层表构建像这样的经典方式：

```
CREATE TABLE test
(name text,id serial primary key,parent_id integer
references test);

insert into test (name,id,parent_id) values
('root1',1,NULL),('root2',2,NULL),('root1sub1',3,1),('root1sub2',4,1),('root
2sub1',5,2),('root2sub2',6,2);

testdb=# select * from test;

   name    | id | parent_id
-----------+----+-----------
 root1     |  1 |  
 root2     |  2 |  
 root1sub1 |  3 |         1
 root1sub2 |  4 |         1
 root2sub1 |  5 |         2
 root2sub2 |  6 |         2 
```

我现在需要的是一个函数（最好是纯 sql），它将获取测试记录的 id 并克隆所有附加记录（包括给定的记录）。克隆的记录当然需要有新的 id。例如，期望的结果是这样的：

```
Select * from cloningfunction(2);

   name    | id | parent_id    
-----------+----+-----------
 root2     |  7 |  
 root2sub1 |  8 |         7
 root2sub2 |  9 |         7 
```

任何指针？我使用的是 PostgreSQL 8.3。

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2008-09-27T09:37:04.857

递归地提取这个结果是很棘手的（尽管可能）。但是，它通常不是很有效，并且有*更好*的方法来解决这个问题。

基本上，您用一个额外的列来扩充表格，该列将树追踪到顶部——我将其称为“上行链”。它只是一个长字符串，看起来像这样：

```
name | id | parent_id | upchain
root1 | 1 | NULL | 1:
root2 | 2 | NULL | 2:
root1sub1 | 3 | 1 | 1:3:
root1sub2 | 4 | 1 | 1:4:
root2sub1 | 5 | 2 | 2:5:
root2sub2 | 6 | 2 | 2:6:
root1sub1sub1 | 7 | 3 | 1:3:7: 
```

使用表上的触发器可以很容易地保持该字段的更新。（为术语道歉，但我一直使用 SQL Server 这样做）。每次添加或删除记录，或更新 parent_id 字段时，您只需要更新树的那部分上的 upchain 字段。这是一项微不足道的工作，因为您只需获取父记录的上行链并附加当前记录的 id。使用 LIKE 可以轻松识别所有子记录，以检查其上游链中具有起始字符串的记录。

当您读取数据时，您正在有效地做的是用一些额外的写入活动来节省*大量资金。*

当您想在树中选择一个完整的分支时，这很简单。假设您想要节点 1 下的分支。节点 1 有一个上行链“1：”，因此您知道该节点下的树分支中的任何节点都必须有一个以“1：...”开头的上行链。所以你只需这样做：

```
SELECT *
FROM table
WHERE upchain LIKE '1:%' 
```

这是*非常*快的（当然索引 upchain 字段）。作为奖励，它还使许多活动变得非常简单，例如查找部分树、树中的关卡等。

我在跟踪大型员工报告层次结构的应用程序中使用了它，但您几乎可以将它用于任何树结构（部件分解等）

备注（有兴趣的朋友）：

*   我没有给出一步一步的SQL代码，但是一旦你掌握了原理，实现起来就很简单了。我不是一个伟大的程序员，所以我是根据经验说话的。
*   如果表中已有数据，则需要进行一次更新以使上行链最初同步。同样，这并不难，因为代码与触发器中的 UPDATE 代码非常相似。
*   这种技术也是识别循环引用的好方法，否则很难发现。

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2008-09-27T12:18:27.543

Joe Celko 的方法类似于[njreed 的答案](https://stackoverflow.com/questions/143226/cloning-hierarchical-data#143313)，但更通用，可以在这里找到：

*   [树的嵌套集模型](http://www.dbmsmag.com/9603d06.html)（在文章中间）
*   [树的嵌套集模型，第 2 部分](http://www.dbmsmag.com/9604d06.html)
*   [SQL 中的树——第三部分](http://www.dbmsmag.com/9605d06.html)

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2008-09-28T19:41:40.233

[@Maximilian](https://stackoverflow.com/questions/143226/cloning-hierarchical-data#145298)：您说得对，我们忘记了您的实际要求。递归存储过程怎么样？我不确定这在 PostgreSQL 中是否可行，但这是一个有效的 SQL Server 版本：

```
CREATE PROCEDURE CloneNode
    @to_clone_id int, @parent_id int
AS
    SET NOCOUNT ON
    DECLARE @new_node_id int, @child_id int

    INSERT INTO test (name, parent_id) 
        SELECT name, @parent_id FROM test WHERE id = @to_clone_id
    SET @new_node_id = @@IDENTITY

    DECLARE @children_cursor CURSOR
    SET @children_cursor = CURSOR FOR 
        SELECT id FROM test WHERE parent_id = @to_clone_id

    OPEN @children_cursor
    FETCH NEXT FROM @children_cursor INTO @child_id
    WHILE @@FETCH_STATUS = 0
    BEGIN
        EXECUTE CloneNode @child_id, @new_node_id
        FETCH NEXT FROM @children_cursor INTO @child_id
    END
    CLOSE @children_cursor
    DEALLOCATE @children_cursor 
```

您的示例由`EXECUTE CloneNode 2, null`（第二个参数是新的父节点）完成。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2008-09-27T10:31:28.923

这听起来像是 Joe Celko 的“SQL For Smarties”中的一个练习……

我手头没有我的副本，但如果这是你需要解决的问题，我认为这本书会对你有很大帮助。

# automation - 防止自动化

> ID：143231
> 
> 赞同：7
> 
> 时间：2008-09-27T08:30:17.763
> 
> 标签：automation, bots, protection

我们的下一个项目应该是一个基于 MS Windows 的游戏（用 C# 编写，带有一个 winform GUI 和一个集成的 DirectX 显示控件），供想要将奖品赠送给最佳玩家的客户。这个项目打算运行几年，包括锦标赛、阶梯、锦标赛、玩家对玩家行动等等。

这里的一个主要问题是作弊，因为如果玩家能够 - 例如 - 让定制的机器人为他玩游戏（更多地是在策略决策方面，而不是在玩很多小时方面），他将会受益匪浅.

所以我的问题是：我们有哪些技术可能性来检测机器人活动？我们当然可以跟踪播放的小时数，分析检测异常的策略等等，但就这个问题而言，我更感兴趣的是了解详细信息，例如

*   如何检测另一个应用程序是否定期截屏？
*   如何检测另一个应用程序是否扫描我们的进程内存？
*   有什么好方法可以确定用户输入（鼠标移动、键盘输入）是否是人工生成的而不是自动化的？
*   是否可以检测另一个应用程序是否请求有关我们应用程序中控件的信息（控件的位置等）？
*   还有哪些其他方法可以让作弊者收集有关当前游戏状态的信息，将这些信息提供给机器人并将确定的操作发送回客户端？

非常感谢您的反馈！

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2008-09-27T09:29:50.460

不久前，我编写了 d2botnet，一个 .net 暗黑破坏神 2 自动化引擎，您可以添加到需要注意的事项列表中的是格式错误/无效/伪造的数据包。我假设这个游戏将通过 TCP 进行通信。数据包嗅探和伪造通常是游戏（无论如何在线）自动化的第一种方式。我知道暴雪会检测到格式错误的数据包，我试图避免在 d2botnet 中这样做。

因此，请确保您检测到无效数据包。加密它们。哈希它们。做一些事情以确保它们是有效的。如果您考虑一下，如果有人可以确切地知道来回发送的每个数据包的含义，他们甚至不需要运行客户端软件，这使得任何基于进程的检测都成为争议点。因此，您还可以添加某种基于数据包的质询响应，您的客户必须知道如何响应。

* * *

## 回答 #2

> 赞同：5
> 
> 时间：2008-09-27T08:39:54.840

只是一个想法，如果“骗子”在虚拟机（如 vmware）中运行您的软件并制作该窗口的屏幕截图怎么办？我怀疑你可以防御这一点。

您显然无法抵御“模拟差距”，例如作弊者的系统使用高质量相机制作外部屏幕截图 - 我想这只是一个理论问题。

也许你应该调查国际象棋网站。国际象棋有很多钱，他们也不喜欢机器人——也许他们已经想出了解决办法。

* * *

## 回答 #3

> 赞同：3
> 
> 时间：2008-09-27T09:17:44.170

对自动化的最佳保护是没有需要磨削的任务。

话虽如此，检测自动化的最佳方法是积极吸引用户并要求定期进行类似 CAPTCHA 的测试（除非没有图像等）。我建议使用包含数千个简单的一次性问题的数据库，这些问题每隔一段时间就会向用户提出。

但是，根据您的问题，我想说您最好的选择是不要在 C# 中实现反自动化功能。您几乎没有机会从托管代码中检测到编写良好的黑客/机器人，尤其是当黑客所要做的只是进入 ring0 以避免通过任何标准方法检测时。我推荐一种类似于 Warden 的方法（可下载的模块，您可以随时更新）结合内核模式驱动程序，该驱动程序挂钩所有 Windows API 函数并监视它们是否存在“不适当的”调用。但是请注意，您会遇到很多误报，因此您不需要将您的禁令系统建立在您的自动化数据上。在禁止之前，请始终对其进行人工检查。

* * *

## 回答 #4

> 赞同：2
> 
> 时间：2008-09-27T09:40:16.160

在应用程序中侦听键盘和鼠标输入的常用方法是使用 SetWindowsHookEx 设置窗口挂钩。供应商通常会在安装过程中尝试保护他们的软件，这样黑客就不会为他们的应用程序自动化和破解/找到序列号。谷歌这个词：“Key Loggers”......这是[一篇](http://www.szabist.edu.pk/ncet2004/Docs/ZSession%20II%20Paper%20No%205%20(P%20189-191).pdf)描述问题和防止它的方法的文章。

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2008-09-27T09:23:29.820

我对 PunkBuster 和此类软件的工作原理没有更深入的了解，但这是我要走的路：

Iintercept 对处理诸如**ReadProcessMemory**、**WriteProcessMemory**等内存内容的 API 函数的调用。

您将检测您的进程是否参与调用，记录它，然后将调用跳回原始函数。

这也适用于截屏，但您可能想要拦截 BitBlt 函数。

这是关于函数拦截的基本教程： [拦截系统 API 调用](http://softwarecommunity.intel.com/articles/eng/3651.htm)

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2008-09-27T08:35:30.683

你应该研究一下 Punkbuster、Valve Anti-Cheat 和其他一些反作弊的东西，以获得一些指导。

编辑：我的意思是，看看他们是*怎么*做的；他们是如何检测到这些东西的。

* * *

## 回答 #7

> 赞同：0
> 
> 时间：2008-09-27T08:59:54.697

我不知道技术细节，但是 Intenet Chess Club 的 BlitzIn 程序似乎集成了程序切换检测。这当然是为了检测在侧面运行国际象棋引擎的人，并不直接适用于您的情况，但是您可以将方法推断为如果进程 X 在下一个 Y 周期占用超过 Z% CPU 时间，它可能一个机器人正在运行。

作为竞赛规则的一部分，除了“您在玩游戏时不得运行任何其他东西以获得奖品”之外可能会起作用。

此外，严苛的“我们可能会出于任何原因随时决定您一直在使用机器人并取消您的资格”规则也有助于上述启发式方法（用于珍贵的 ICC 国际象棋锦标赛）。

所有这些问题都可以通过上面的规则 1 轻松解决：

```
* how to detect if another application makes periodical screenshots?
* how to detect if another application scans our process memory?
* what are good ways to determine whether user input (mouse movement, keyboard input) is human-generated and not automated?
* is it possible to detect if another application requests informations about controls in our application (position of controls etc)? 
```

我认为让破解者更难解决问题的一个好方法是在您的服务器中拥有游戏状态的唯一权威副本，仅向客户端发送和接收更新，这样您就可以嵌入通信协议本身客户端验证（它没有被破解，因此检测规则仍然存在）。那，并积极监控发现的新奇怪行为可能会让你更接近你想去的地方。

# c# - 对于任何 C# 开发人员来说，哪些是“必须遵循”的 FxCop 规则？

> ID：143232
> 
> 赞同：28
> 
> 时间：2008-09-27T08:30:24.130
> 
> 标签：c#, .net, fxcop

我计划在我们正在进行的项目之一中开始使用 FxCop。但是，当我尝试选择所有可用规则时，看起来我必须对我的代码进行大量更改。作为“团队成员”，我不能立即开始进行这些更改，例如更改命名约定等。无论如何，我想开始使用具有最小规则集的 FxCop，并随着我们的继续而逐渐增加规则集。你能建议我一些必须有我应该开始遵循的 FxCop 规则吗？或者你有什么更好的方法吗？

注意：我的大部分代码都是用 C# 编写的。

* * *

## 回答 #1

> 赞同：12
> 
> 时间：2008-09-27T08:58:13.627

在我们最重要的代码上：

*   将警告视为错误（级别 4）
*   FxCop 必须通过 100%（通常不允许忽略）
*   [宪兵](http://www.mono-project.com/Gendarme)作为指导方针（有时与 FxCop 冲突）

信不信由你，FxCop 会教你很多关于如何编写更好的代码的知识……很棒的工具！所以对我们来说，所有规则都同等重要。

* * *

## 回答 #2

> 赞同：8
> 
> 时间：2008-09-27T08:38:07.060

在我看来，请执行以下操作：

对于任何新项目，请遵守所有 FxCop 规则。您可能想要禁用其中的一些，因为并非所有内容都对您的项目有意义。对于现有项目，请遵循以下类别中的规则作为最低限度：

*   全球化
*   互操作性
*   安全
*   表现
*   可移植性

由于与其他类别相比，这些通常只是现有项目中的少数违规行为，但可能会提高您的应用程序的质量。当这些规则明确时，尝试修复以下类别：

*   设计
*   用法

因为这些将使您更容易发现与违规有关的错误，但是您将在现有代码中遇到大量违规。

始终按级别/修复类别对违规进行排序，并从关键违规开始。暂时跳过警告。

如果您不知道，Microsoft 还提供 StyleCop，可在源代码级别检查您的代码。请务必在安装期间启用 MSBuild 集成。

* * *

## 回答 #3

> 赞同：4
> 
> 时间：2010-01-27T10:56:08.280

一些规则避免了我们的错误或泄漏：

*   不要捕获一般的异常类型（对我们来说可能是最好的规则。根据情况，执行起来可能容易或困难）
*   正确测试 NaN（易于实施）
*   一次性字段应该被处理（很容易执行）
*   Dispose 应该调用 base dispose （很容易执行）
*   一次性类型应该声明终结器（很容易执行）

有些帮助我们有更好的设计，但要小心，当中心 API 受到影响时，它们可能会导致你进行大规模的重构。我们喜欢

*   集合属性应该是只读的（在我们的例子中很难强制执行）
*   不要暴露通用列表
*   成员不应公开某些具体类型
*   查看使用的参数（轻松改进您的 API）

我们项目中的某个人尝试了**性能规则**，但没有任何改进。（实际上，这些规则是关于微优化的，如果没有瓶颈识别表明需要微优化，则不会给出结果）。我建议*不要*从这些开始。

* * *

## 回答 #4

> 赞同：2
> 
> 时间：2010-12-14T15:12:32.987

最小的 fxcop 和代码分析（如果使用 VS2010 Premium 或 Ultimate）如下：http: [//msdn.microsoft.com/en-us/library/dd264893.aspx](http://msdn.microsoft.com/en-us/library/dd264893.aspx)

* * *

## 回答 #5

> 赞同：2
> 
> 时间：2008-12-18T17:14:51.737

一次打开一个规则。修复或排除它报告的任何警告，然后从下一个开始。

* * *

## 回答 #6

> 赞同：2
> 
> 时间：2008-12-18T16:52:06.070

FxCop 的替代方法是使用 NDepend 工具，该工具允许[在 C# LINQ 查询（即 CQLinq）上编写代码规则](http://www.ndepend.com/Features.aspx#CQL)。*免责声明：我是该工具的开发人员之一*

默认提出超过[200 条代码规则。](http://www.ndepend.com/DefaultRules/webframe.html)*借助众所周知的*C# LINQ 语法，自定义现有规则或创建自己的规则非常简单。

NDepend 在某些代码规则上与 FxCop 重叠，但提出了许多独特的代码规则。以下是一些我认为*必须遵守*的规则：

*   [避免通过类型测试降低代码覆盖率](http://www.ndepend.com/DefaultRules/webframe.html?Q_Avoid_decreasing_code_coverage_by_tests_of_types.html)
*   [避免使复杂的方法更加复杂（来源 CC）](http://www.ndepend.com/DefaultRules/webframe.html?Q_Avoid_making_complex_methods_even_more_complex_%28Source_CC%29.html)
*   [避免将不可变类型转换为可变类型](http://www.ndepend.com/DefaultRules/webframe.html?Q_Avoid_transforming_an_immutable_type_into_a_mutable_one.html)
*   [Method() 的覆盖应该调用 base.Method()](http://www.ndepend.com/DefaultRules/webframe.html?Q_Overrides_of_Method%28%29_should_call_base.Method%28%29.html)
*   [避免单例模式](http://www.ndepend.com/DefaultRules/webframe.html?Q_Avoid_the_Singleton_pattern.html)
*   [具有一次性实例字段的类型必须是一次性的](http://www.ndepend.com/DefaultRules/webframe.html?Q_Types_with_disposable_instance_fields_must_be_disposable.html)
*   [具有非托管资源的一次性类型应声明终结器](http://www.ndepend.com/DefaultRules/webframe.html?Q_Disposable_types_with_unmanaged_resources_should_declare_finalizer.html)
*   [避免命名空间相互依赖](http://www.ndepend.com/DefaultRules/webframe.html?Q_Avoid_namespaces_mutually_dependent.html)
*   [避免命名空间依赖循环](http://www.ndepend.com/DefaultRules/webframe.html?Q_Avoid_namespaces_dependency_cycles.html)
*   [UI 层不应该直接使用 DB 类型](http://www.ndepend.com/DefaultRules/webframe.html?Q_UI_layer_shouldn%27t_use_directly_DB_types.html)
*   [API 重大更改：方法](http://www.ndepend.com/DefaultRules/webframe.html?Q_API_Breaking_Changes__Methods.html)
*   [测试部分覆盖的复杂方法应 100% 覆盖](http://www.ndepend.com/DefaultRules/webframe.html?Q_Complex_methods_partially_covered_by_tests_should_be_100__covered.html)
*   [潜在死亡类型](http://www.ndepend.com/DefaultRules/webframe.html?Q_Potentially_dead_Types.html)
*   [结构应该是不可变的](http://www.ndepend.com/DefaultRules/webframe.html?Q_Structures_should_be_immutable.html)
*   [避免使用相同的标识符命名类型和命名空间](http://www.ndepend.com/DefaultRules/webframe.html?Q_Avoid_naming_types_and_namespaces_with_the_same_identifier.html)

[请注意，可以在 Visual Studio 中](http://www.ndepend.com/Doc_VS_CQL.aspx)和在构建过程中在[生成的 HTML+javascript 报告](http://www.ndepend.com/Doc_CI_Report.aspx#CQLRule)中实时验证规则。

* * *

## 回答 #7

> 赞同：1
> 
> 时间：2008-09-27T09:04:45.187

我们是一家网上商店，所以我们放弃了以下规则：

*   任何与 Interop 相关的东西（除非客户付费，否则我们不支持 COM 集成！）
*   密钥签名（Web 应用程序不应该需要高安全性）

有时我们会放弃在依赖项中使用更高框架的规则，因为我们的一些 CMS 仍然是 .NET 2.0，但这并不意味着只要您不尝试，DAL/业务层就不能是 .NET 3.5返回 IQueryable（或任何 .NET 3、3.5）。

* * *

## 回答 #8

> 赞同：1
> 
> 时间：2008-09-28T18:13:56.027

在我们的流程中，我们启用了所有规则，然后我们必须证明任何禁止行为是我们审查流程的一部分。通常，就截止日期或错误引发的错误（有时会发生这种情况 - 特别是如果您的架构通过反射处理插件时）以省时的方式修复错误是不可能的。

我们还为全球化编写了一个自定义规则来替换现有的规则，因为我们不想全球化传递给异常的字符串。

一般来说，我会说最好尝试遵守所有规则。在我当前的家庭项目中，我有四个构建配置 - 一组指定 CODE_ANALYSIS 定义，一组不指定。这样，我可以通过构建非 CODE_ANALYSIS 配置来查看我抑制的所有消息。这意味着可以定期查看被抑制的消息，并可能根据需要对其进行处理或删除。

从长远来看，我想做的是有一个构建步骤，根据实际错误分析 SuppressMessage 属性并突出显示不再需要的那些抑制，但我的设置目前无法做到这一点。

* * *

## 回答 #9

> 赞同：0
> 
> 时间：2008-09-27T08:34:24.917

设计和安全规则是一个很好的起点。

* * *

## 回答 #10

> 赞同：0
> 
> 时间：2008-09-27T10:05:19.360

我完全同意 Sklivvz。但对于现有项目，您可以按类别清理 FxCop 违规行为。

宪兵不时接受非常有用的新规则。因此，您还可以使用宪兵。

# c++ - 如何将数据重定向到单个可执行文件中的标准输入？

> ID：143233
> 
> 赞同：4
> 
> 时间：2008-09-27T08:32:33.173
> 
> 标签：c++

我正在使用[cxxtest](http://cxxtest.tigris.org/)作为我的 C++ 类的测试框架，并且想找出一种方法来模拟向通常期望从标准输入接收数据的类发送数据。我有几个不同的文件，我想在不同的测试期间发送到类，所以从命令行重定向到测试套件可执行文件不是一个选项。

基本上，我真正想做的是找到一种方法来重新定义或重定向“stdin”句柄到我在程序内部创建的其他值，然后从这些测试中使用 fwrite() 以便相应的 fread()类的内部从程序中提取数据，而不是从与可执行文件关联的实际标准 I/O 句柄中提取数据。

这甚至可能吗？独立于平台的解决方案的加分点，但至少，我需要它才能在 Windows 下使用 Visual Studio 9。

* * *

## 回答 #1

> 赞同：10
> 
> 时间：2008-09-27T08:35:18.360

适当的方法是重写您的类，以便它们是可测试的。他们应该接受他们应该从中读取数据的句柄、流或文件作为参数 - 在您的测试框架中，您可以在流中模拟或提供包含测试数据的文件的路径。

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2008-09-27T08:36:59.557

您应该能够使用 freopen() 将标准输入指向任意文件。

* * *

## 回答 #3

> 赞同：3
> 
> 时间：2008-09-27T08:59:13.310

[rdbuf](http://www.cplusplus.com/reference/iostream/ios/rdbuf.html)完全符合您的要求。您可以打开一个文件进行读取，并将 cin 的 rdbuf 替换为文件中的rdbuf。（有关使用 cout 的示例，请参阅链接）。

在类 unix 操作系统上，您可以关闭 0 文件句柄 (stdin) 并打开另一个文件。它将具有最低的可用句柄，在本例中为 0。或者使用执行此操作的 posix 调用之一。我不确定，但这也可能适用于 Windows。

* * *

## 回答 #4

> 赞同：2
> 
> 时间：2008-09-27T08:51:27.027

我认为您希望您的课程使用输入流而不是`std::cin`直接使用。您需要将输入流传递给类或通过某种方法将其设置在它们上。例如，您可以使用 a`stringstream`传递您的测试输入：

```
 std::istringstream iss("1.0 2 3.1415");
some_class.parse_nums(iss, one, two, pi); 
```

* * *

## 回答 #5

> 赞同：2
> 
> 时间：2008-09-27T16:29:18.160

我们可以重定向 cin 以便它从文件中读取数据。这是一个例子：

```
#include <iostream>
#include <fstream>
#include <string>

int main()
{
    std::ifstream inputFile("Main.cpp");
    std::streambuf *inbuf = std::cin.rdbuf(inputFile.rdbuf());

    string str;
    // print the content of the file without 'space' characters
    while(std::cin >> str)
    {
        std::cout << str;
    }

    // restore the initial buffer
    std::cin.rdbuf(inbuf);
} 
```

# lua - Lua = 运算符作为打印

> ID：143234
> 
> 赞同：5
> 
> 时间：2008-09-27T08:33:07.227
> 
> 标签：lua

在 Lua 中，使用不带左值的 = 运算符似乎等同于 print(r-value)，以下是在 Lua 独立解释器中运行的一些示例：

```
> = a
nil
> a = 8
> = a
8
> = 'hello'
hello
> = print
function: 003657C8 
```

等等...

我的问题是：在哪里可以找到 = 运算符的这种用法的详细说明？它是如何工作的？是通过暗示一个特殊的默认 l 值吗？我想我的问题的根源是我不知道在谷歌中输入什么来查找有关它的信息:-)

**编辑**：

感谢您的回答，您是对的，这是解释器的一个功能。愚蠢的问题，因为我不知道我完全忽略了显而易见的原因。我应该避免在早上喝咖啡之前发帖 :-) 为了完整起见，这里是解释器中处理这个问题的代码：

```
while ((status = loadline(L)) != -1) {
  if (status == 0) status = docall(L, 0, 0);
  report(L, status);
  if (status == 0 && lua_gettop(L) > 0) {  /* any result to print? */
    lua_getglobal(L, "print");
    lua_insert(L, 1);
    if (lua_pcall(L, lua_gettop(L)-1, 0, 0) != 0)
      l_message(progname, lua_pushfstring(L,
                           "error calling " LUA_QL("print") " (%s)",
                           lua_tostring(L, -1)));
  }
} 
```

**编辑2**：

真正完整的是，将值压入堆栈的整个技巧在于“pushline”函数：

```
if (firstline && b[0] == '=')  /* first line starts with `=' ? */
  lua_pushfstring(L, "return %s", b+1);  /* change it to `return' */ 
```

* * *

## 回答 #1

> 赞同：15
> 
> 时间：2008-09-27T09:09:05.330

引用[手册页](http://www.lua.org/manual/5.1/lua.html)：

> 在交互模式下... 如果一行以 '=' 开头，那么 lua 会在该行的其余部分显示所有表达式的值。表达式必须用逗号分隔。

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2008-09-27T08:44:02.677

我认为这一定是独立口译员的一个特点。我无法在我将 lua 编译成的任何东西上进行这项工作。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2008-09-27T08:48:45.257

我不会把它称为一个特性——解释器只是返回语句的结果。这是他的工作，不是吗？

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2008-09-27T08:58:13.267

赋值不是返回 in 的表达式，就像 in`Lua`一样`C`。

# offline - 移动浏览器 RIA 的当前状态是什么？有哪些解决方案？

> ID：143253
> 
> 赞同：0
> 
> 时间：2008-09-27T08:45:02.237
> 
> 标签：offline, web-applications

任何优秀的网络应用程序的核心是它的离线功能和 JavaScript 功能。目前，桌面网络应用程序制造商可以使用哪些工具和包装器来跨入移动市场？对于这样一个团队来说，必要的阅读是什么？

澄清：我正在搜索有关移动电话上的离线功能和 JavaScript 功能改进了多少的信息。我知道“手机”这个词太宽泛了。我知道 Gears、Adobe AIR、Silverlight 等离线解决方案。但这些真的适用于手机吗？

JavaScript 在 iPhone 和 Symbians 等移动 Webkit 浏览器上改进了多少？OperaMini 还声称有一些 JavaScript 功能。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2008-09-27T09:06:05.977

我不确定我是否理解您的问题，但您可能需要先查看[iPhone 开发中心](http://developer.apple.com/iphone/)和[Google Android SDK](http://code.google.com/android/)。[黑莓](http://na.blackberry.com/eng/developers/resources/)也有一个开发计划。除此之外，您可能还想研究[WAP 和 WML](http://www.w3schools.com/wap/)。[Google Gears](http://gears.google.com/)、[Adobe Air](http://www.adobe.com/products/air/)和[Mozilla 的 XUL](http://www.mozilla.org/projects/xul/)将为您提供一些离线功能，但据我所知，它们不会包装现有的桌面应用程序并使其可用于网络。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2008-09-27T09:18:14.373

> 任何优秀的网络应用程序的核心是它的离线功能和 JavaScript 功能。

您在谈论像 GMail 这样的单页 webapp 对吗？那么您可能需要一个 Mashup 平台（这里是一个[很好的起点](http://en.wikipedia.org/wiki/Mashup_(web_application_hybrid)#Mashup_editors)）。

我不知道其中哪些支持移动。可能没有，因为手机上的 Javascript 支持基本上为零。

# asp.net - ASP.NET 应用程序中的 Silverlight 控件

> ID：143281
> 
> 赞同：1
> 
> 时间：2008-09-27T09:07:10.267
> 
> 标签：asp.net, silverlight

我需要我的 ASP.NET Web 应用程序才能在我的网页中使用 Silverlight 控件。请让我知道如何使用它们。我是否需要在我的 Visual Studio 2005 中为它们添加任何引用。Framework 2.0 和 ASP.NET 2.0 应用程序环境。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2008-09-27T09:40:22.557

一个很好的帖子在[这里](http://blogs.sqlxml.org/bryantlikes/archive/2007/05/02/silverlight-hello-world-in-c-from-vs-2005.aspx)可以解决您的问题。

干杯。

# java - 枚举占用多少内存？

> ID：143285
> 
> 赞同：54
> 
> 时间：2008-09-27T09:15:15.333
> 
> 标签：java, c++, memory, enums

例如，如果我有一个有两种情况的枚举，它是否比布尔值占用更多的内存？语言：Java、C++

* * *

## 回答 #1

> 赞同：50
> 
> 时间：2008-09-27T09:23:20.337

在 Java 中，an[`enum`是一个成熟的类](http://download.oracle.com/javase/tutorial/java/javaOO/enum.html)：

> Java 编程语言的枚举类型比其他语言中的枚举类型强大得多。枚举声明定义了一个类（称为枚举类型）。枚举类主体可以包括方法和其他字段。

为了查看每个 的实际大小`enum`，让我们创建一个实际的`enum`并检查`class`它创建的文件的内容。

假设我们有以下`Constants`枚举类：

```
public enum Constants {
  ONE,
  TWO,
  THREE;
} 
```

编译上述内容`enum`并反汇编生成的`class`文件`javap`给出以下内容：

```
Compiled from "Constants.java"
public final class Constants extends java.lang.Enum{
    public static final Constants ONE;
    public static final Constants TWO;
    public static final Constants THREE;
    public static Constants[] values();
    public static Constants valueOf(java.lang.String);
    static {};
} 
```

反汇编表明 an 的每个字段都是该类`enum`的一个实例`Constants` `enum`。（进一步分析`javap`会发现每个字段都是通过调用`new Constants(String)`静态初始化块中的构造函数来创建一个新对象来初始化的。）

因此，我们可以看出`enum`，我们创建的每个字段至少与在 JVM 中创建对象的开销一样多。

* * *

## 回答 #2

> 赞同：17
> 
> 时间：2008-09-27T10:18:12.403

在 Java 中，每个枚举值在内存中应该只有一个实例。然后，对枚举的引用只需要该引用的存储。检查枚举的值与任何其他参考比较一样有效。

* * *

## 回答 #3

> 赞同：8
> 
> 时间：2008-09-27T10:57:19.923

只有在存储大量枚举时才会担心这一点。对于 Java，在某些情况下您可以使用 EnumSet。它在内部使用一个位向量，非常节省空间且速度很快。

[http://java.sun.com/j2se/1.5.0/docs/api/java/util/EnumSet.html](http://java.sun.com/j2se/1.5.0/docs/api/java/util/EnumSet.html)

* * *

## 回答 #4

> 赞同：7
> 
> 时间：2008-09-27T10:10:54.403

`bool`可以实现为单个字节，但通常在结构中它会被具有对齐要求的其他元素包围，这意味着布尔值将有效地占用至少与`int`.

现代处理器从主存加载数据作为整个高速缓存行，64 字节。从 L1 缓存加载一个字节和加载四个字节之间的差异可以忽略不计。

如果您正在尝试优化高性能应用程序中的缓存行，那么您可能会担心枚举有多大，但通常我会说定义枚举比使用布尔值更清楚。

* * *

## 回答 #5

> 赞同：4
> 
> 时间：2008-09-27T09:27:34.927

在 Java 中，它会占用更多内存。在 C++ 中，它不会占用相同类型的常量所需的内存（它在编译时评估并且在运行时没有剩余意义）。在 C++ 中，这意味着枚举的默认类型将占用与 int 相同的空间。

* * *

## 回答 #6

> 赞同：3
> 
> 时间：2008-09-29T12:50:18.887

在 ISO C++ 中，枚举没有义务大于其最大枚举数所需的大小。特别是，即使在 sizeof(bool)==sizeof(int) 时，枚举 {TRUE, FALSE} 也可能具有 sizeof(1)。根本没有要求。一些编译器使枚举与 int 大小相同。这是一个编译器特性，这是允许的，因为标准只规定了最低限度。其他编译器使用扩展来控制枚举的大小。

* * *

## 回答 #7

> 赞同：1
> 
> 时间：2008-09-27T09:30:46.497

```
printf("%d", sizeof(enum)); 
```

* * *

## 回答 #8

> 赞同：1
> 
> 时间：2008-09-27T23:29:20.240

在 C++ 中，枚举通常与`int`. 也就是说，编译器提供命令行开关以允许将枚举的大小设置为适合定义的值范围的最小大小的情况并不少见。

* * *

## 回答 #9

> 赞同：0
> 
> 时间：2008-09-27T09:18:45.153

不，枚举通常与 int 大小相同，与布尔值相同。

* * *

## 回答 #10

> 赞同：0
> 
> 时间：2008-09-27T09:35:59.777

如果您的枚举只有两种情况，那么确实使用布尔值可能是一个更好的主意（内存大小、性能、使用/逻辑），在 Java 中甚至更多。
如果您想知道内存成本，这可能意味着您计划使用大量内存。在 Java 中，您可以使用 BitSet 类，或者在更小的范围内，在这两种语言中，您都可以使用按位操作来操作位。

* * *

## 回答 #11

> 赞同：0
> 
> 时间：2008-09-27T18:14:48.187

sizeof(enum) 取决于枚举中的内容。我最近试图使用默认构造函数参数查找 ArrayList() 的大小，并且内部没有存储对象（这意味着存储容量为 10）。原来 ArrayList 并没有太大 < 100 字节。

因此，一个非常简单的枚举的 sizeof(enum) 应该小于 10 个字节。你可以写一个小程序，给它一定的内存，然后尝试分配枚举。你应该能够弄清楚（这就是我发现ArrayList的内存的方式）

BR，
~A

* * *

## 回答 #12

> 赞同：0
> 
> 时间：2008-09-28T03:18:30.157

在 C/C++ 中，枚举的大小与 int 相同。

使用 gcc，您可以将**属性**((packed)) 添加到枚举定义中，以使其占用最小的空间。如果枚举中的最大值 < 256，这将是一个字节，如果最大值是 < 65536，则为两个字节，等等。

```
typedef enum {
    MY_ENUM0,
    MY_ENUM1,
    MY_ENUM2,
    MY_ENUM3,
    MY_ENUM4,
    MY_ENUM5
} __attribute__((packed)) myEnum_e; 
```

# html - 伪类 :hover 在 IE7 中不起作用

> ID：143296
> 
> 赞同：11
> 
> 时间：2008-09-27T09:23:08.417
> 
> 标签：html, css, internet-explorer-7

我有这么简单的代码：

```
<div class="div1">
  <div class="div2">Foo</div>
  <div class="div3">
    <div class="div4">
      <div class="div5">
        Bar
      </div>        
    </div>
  </div>
</div> 
```

这个CSS：

```
.div1{
  position: relative;
}
.div1 .div3 {
  position: absolute;
  top: 30px;
  left: 0px;
  width: 250px;
  display: none;
}
.div1:hover .div3 {
  display: block;
}
.div2{
  width: 200px;
  height: 30px;
  background: red;
}
.div4 {
  background-color: green;
  color: #000;  
}
.div5 {} 
```

问题是：当我将光标从移动`.div2`到`.div3`（`.div3`应该保持可见，因为它是 的子级`.div1`）然后悬停被禁用。我在 IE7 中测试它，在 FF 中它工作正常。我究竟做错了什么？我也意识到，当我删除`.div5`标签时，它会起作用。有任何想法吗？

* * *

## 回答 #1

> 赞同：25
> 
> 时间：2008-09-27T22:26:02.607

IE7 不允许您将`:hover`伪类应用于非锚元素，除非您明确指定文档类型。只需将 doctype 声明添加到您的页面，它应该可以完美运行。

```
<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01//EN"
    "http://www.w3.org/TR/html4/strict.dtd"> 
```

更多关于 IE7/quirks 模式的信息可以在[这篇博](http://www.bernzilla.com/item.php?id=762)文中找到。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2008-09-27T09:31:28.727

我发现这个解决方案效果更好，而且更干净一些：

```
 <style type="text/css">
        * {
            color: #fff;
        }
        .wrapper {

        }

        .trigger {
            background: #223;
        }

        .appear {
            background: #334;
            display: none;
        }

        .trigger:hover .appear {
            display: block;
        }
    </style>
</head>

<body>

    <div class="wrapper">
        <div class="trigger">
            <p>This is the trigger for the hover element.</p>
            <div class="appear">
                <p>I'm <strong>alive!</strong></p>
            </div>
        </div>
    </div>

</body> 
```

[粘贴箱](http://paste2.org/p/79237)。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2010-11-11T09:15:39.493

会不会是双倍保证金问题？我做了一个 display: inline-block 当它发生在一个 li [http://www.positioniseverything.net/explorer/doubled-margin.html](http://www.positioniseverything.net/explorer/doubled-margin.html)

# php - 使用 Zend 框架创建 cronjob

> ID：143320
> 
> 赞同：22
> 
> 时间：2008-09-27T09:43:40.897
> 
> 标签：php, zend-framework, cron, command-line-interface

我正在尝试编写一个 cronjob 控制器，所以我可以调用一个网站并执行所有模块 cronjob.php。现在我的问题是我该怎么做？

curl 是一种选择，所以我也可以计算错误和成功吗？

[更新]

我想我解释得还不够。

我想要做的是有一个文件，我可以从[http://server/cronjob](http://server/cronjob)调用它，然后让它执行每个 /application/modules/*/controller/CronjobController.php 或者有另一种方式来做所有的cronjobs 不在一个地方，而是在模块所在的同一个地方。这会给我带来好处，如果一个模块不存在，它就不会尝试运行它的 cronjob。

现在我的问题是您将如何执行所有模块 CronjobController 或者您会以完全不同的方式执行它以便它仍然保持模块化？

我希望能够给出有多少 cronjobs 成功运行，有多少没有

* * *

## 回答 #1

> 赞同：12
> 
> 时间：2009-07-16T15:31:48.643

经过一些研究和大量拖延，我得出了一个简单的结论，即 ZF 化的 cron 脚本应该包含您 zend 框架应用程序的所有功能 - 没有所有视图的东西。我通过在我的应用程序目录中创建一个新的 cronjobfoo.php 文件来实现这一点。然后我从以下方面获取了最低限度： -my front controller (index.php) -my bootstrap.php

我拿出了所有的视图材料，专注于保持环境设置、数据库设置、自动加载器和注册表设置。我不得不花一点时间来更正文档根变量并删除从我的引导程序中复制的一些 OO 功能。

在那之后我只是编码了......在我的情况下，它正在编译并通过电子邮件发送夜间报告。使用 Zend_Mail 很棒。当我确信我的脚本按我想要的方式运行时，我只是将它添加到我的 crontab 中。

祝你好运！

* * *

## 回答 #2

> 赞同：10
> 
> 时间：2009-08-12T20:45:20.367

对于 Zend Framework，我目前正在使用下面列出的代码。该脚本仅包含门户文件 index.php，其中引导所有路径、环境和其他 Zendy 代码。通过在 cron 脚本中定义一个常量，我们取消了运行应用程序的最后一步。

这意味着应用程序只是设置，甚至没有引导。在这一点上，我们开始引导我们需要的资源，那就是

```
//public/index.php

if(!defined('DONT_RUN_APP') || DONT_RUN_APP == false) {  
    $application->bootstrap()->run();
}

// application/../cron/cronjob.php

define("DONT_RUN_APP",true);
require(realpath('/srv/www/project/public/index.php'));
$application->bootstrap('config');
$application->bootstrap('db');

//cron code follows 
```

* * *

## 回答 #3

> 赞同：7
> 
> 时间：2008-09-27T13:44:35.607

我会警告将您的 cronjobs 向公众开放，因为它们可能会在正常时间之外触发，并且取决于它们的工作，会导致问题（我知道这不是您想要的，但是通过将它们放入实际的控制器中，它变得可以访问从浏览器）。例如，我有一个发送电子邮件的 cron。如果有人找到 cron URL 并开始点击它，我会不断收到垃圾邮件。

我所做的是创建一个 cron 文件夹，并在其中创建了一个 heartbeat.php，它为我引导 Zend 框架（减去 MVC）。它检查一个数据库，其中包含所有已安装的 cron 作业的列表，如果该运行它们，则生成 cron 作业类的实例并运行它。

cron 作业只是抽象 cron 类的子类，具有 install()、run()、deactivate() 等方法。

为了启动我的工作，我只有一个简单的 crontab 条目，它每 5 分钟运行一次，它会访问 heartbeat.php。到目前为止，它在两个不同的站点上运行良好。

* * *

## 回答 #4

> 赞同：3
> 
> 时间：2011-11-11T17:35:00.120

我可以访问专用服务器，并且最初对 cron 作业有不同的引导程序。我最终讨厌这个想法，只是希望我可以在现有的 MVC 设置中做到这一点，而不必费心移动东西。

我创建了一个文件 cron.sh，保存在我的站点根目录（非公开）中，并在其中放置了一系列我想运行的命令。因为我想一次运行许多命令，所以我像往常一样在我的控制器中编写了 PHP，并在 cron.sh 中为这些 url 添加了 curl 调用。例如`curl http://www.mysite.com/cron_controller/action`然后在我运行的 cron 界面上`bash /path/to/cron.sh`。

正如其他人指出的那样，任何猜到 url 的人都可以解雇您的 crons，所以总是有这个警告。您可以通过许多不同的方式找到解决方案。

* * *

## 回答 #5

> 赞同：3
> 
> 时间：2008-09-27T14:42:32.207

几天前有人在 fw-general 上提到[了这个博客条目](http://webfractor.wordpress.com/2008/08/14/using-zend-framework-from-the-command-line/)（我建议您在使用 Zend 框架时阅读该[邮件列表）。](http://framework.zend.com/wiki/display/ZFDEV/Contributing+to+Zend+Framework#ContributingtoZendFramework-Subscribetotheappropriatemailinglists)

[Zend_Controller_Request_Cli](http://framework.zend.com/wiki/display/ZFPROP/Zend_Controller_Request_Cli)也有一个提议，迟早会解决这个问题。

* * *

## 回答 #6

> 赞同：1
> 
> 时间：2009-04-09T07:19:09.267

为什么不直接创建一个 crontab.php，包括或需要 index.php 引导文件？

考虑到引导程序正在执行`Zend_Loader::registerAutoload()`，您可以直接开始使用模块，例如，`myModules_MyClass::doSomething();`

这样你就跳过了控制器。Controller的工作是通过http控制访问。在这种情况下，您不需要控制器方法，因为您是在本地访问。

* * *

## 回答 #7

> 赞同：1
> 
> 时间：2010-12-18T11:29:34.950

看看`zf-cli`：

*   [来自 padraic/ZFPlanet 的 master 脚本 - GitHub](https://github.com/padraic/ZFPlanet/tree/master/scripts)

这可以很好地处理所有 cron 作业。

* * *

## 回答 #8

> 赞同：0
> 
> 时间：2008-09-27T19:01:23.753

您是否具有对模块目录的文件系统访问权限？您可以遍历目录并确定 CronjobController.php 可用的位置。然后您可以使用`Zend_Http_Client`通过 HTTP 访问控制器或使用类似的方法`Zend_Test_PHPUnit`：在本地模拟实际的调度过程。

* * *

## 回答 #9

> 赞同：0
> 
> 时间：2008-09-28T02:30:04.703

您可以设置一个数据库表来保存对 cronjob 脚本（在您的模块中）的引用，然后使用 exec 命令并在通过/失败时返回值。

* * *

## 回答 #10

> 赞同：0
> 
> 时间：2012-07-27T11:36:50.167

***这是我使用 Zend Framework 运行 Cron 作业的方式***

在**Bootstrap**中，我将保留环境设置，因为它减去 MVC：

```
public static function setupEnvironment()
{
     ...
     self::setupFrontController();
     self::setupDatabase();
     self::setupRoutes();
     ...
     if (PHP_SAPI !== 'cli') { 
          self::setupView();
          self::setupDbCaches();
     }
     ...
} 
```

同样在 Bootstrap 中，我将修改 setupRoutes 并添加自定义路由：

```
public function setupRoutes()
{   
    ...
    if (PHP_SAPI == 'cli') { 
        self::$frontController->setRouter(new App_Router_Cli());
        self::$frontController->setRequest(new Zend_Controller_Request_Http());        
    }
} 
```

**App_Router_Cli**是一种新的路由器类型，它根据这种类型的请求确定控制器、操作和可选参数：`script.php controller=mail action=send`. 我在这里找到了这个新路由器：[使用 Zend Framework 1.11 设置 Cron](http://www.mediabandit.co.uk/blog/248_setting-up-cron-with-zend-framework-1-11) ：

```
class App_Router_Cli extends Zend_Controller_Router_Abstract 
{
    public function route (Zend_Controller_Request_Abstract $dispatcher) 
    {
        $getopt = new Zend_Console_Getopt (array());
        $arguments = $getopt->getRemainingArgs();
        $controller = "";
        $action = "";
        $params = array();

        if ($arguments) {

            foreach($arguments as $index => $command) {

                $details = explode("=", $command);

                if($details[0] == "controller") {
                    $controller = $details[1];
                } else if($details[0] == "action") {
                    $action = $details[1];
                } else {
                    $params[$details[0]] = $details[1];
                }
            }

            if($action == "" || $controller == "") {
                die("Missing Controller and Action Arguments == You should have: 
                     php script.php controller=[controllername] action=[action]");
            }
            $dispatcher->setControllerName($controller);
            $dispatcher->setActionName($action);
            $dispatcher->setParams($params);

            return $dispatcher;
        }
        echo "Invalid command.\n", exit;
        echo "No command given.\n", exit;
    }

    public function assemble ($userParams, $name = null, $reset = false, $encode = true)
    {
        throw new Exception("Assemble isnt implemented ", print_r($userParams, true));
    }
} 
```

在**CronController**我做了一个简单的检查：

```
public function sendEmailCliAction()
{   
    if (PHP_SAPI != 'cli' || !empty($_SERVER['REMOTE_ADDR'])) { 
        echo "Program cannot be run manually\n";
        exit(1);
    } 
    // Each email sent has its status set to 0; 
```

crontab 运行这种命令：

```
 * * * * * php /var/www/projectname/public/index.php controller=name action=send-email-cli >> /var/www/projectname/application/data/logs/cron.log 
```

* * *

## 回答 #11

> 赞同：0
> 
> 时间：2011-01-13T01:32:03.690

[我用这篇文章](http://www.codediesel.com/php/quick-way-to-determine-if-php-is-running-at-the-command-line/)扩展了 gregor 的答案。这是出来的：

```
//public/index.php 

// Run application, only if not started from command line (cli)
if (php_sapi_name() != 'cli' || !empty($_SERVER['REMOTE_ADDR'])) {
    $application->run();
} 
```

谢谢格雷戈！

* * *

## 回答 #12

> 赞同：0
> 
> 时间：2011-05-09T08:52:34.233

我的解决方案：

*   卷曲/cron
*   全局 cron 方法将 include_once 所有控制器
*   检查每个控制器是否有 ->cron 方法
*   如果有，请运行它们。

公共 cron url（用于 curl）不是问题，有很多方法可以避免滥用。如前所述，检查远程 IP 是最简单的。

* * *

## 回答 #13

> 赞同：0
> 
> 时间：2019-04-13T07:26:24.843

在同一目录或 cron 作业文件夹中运行引导程序是没有意义的。我创建了一种更好、更简单的方法来实现 cron 作业。请遵循以下事项，以使您的工作变得轻松而智能：

1.  随心所欲地创建一个 cron 作业文件夹，例如“cron”或“crobjob”等。

2.  有时我们需要 cron 作业在不同间隔的服务器上运行，例如 1 小时间隔或 1 天间隔，我们可以在服务器上设置。

3.  在 cron 作业文件夹中创建一个文件，就像我创建了一个“init.php”一样，现在假设您想每天向用户发送一份时事通讯。您不需要在 init.php 中执行 zend 代码。

4.  因此，只需在 init.php 中设置 curl 函数，并在该 curl 函数中添加控制器操作的 URL。因为我们的主要目的是每天都应该调用一个动作。例如，URL 应该是这样的：

**[https://www.example.com/cron/newsletters](https://www.example.com/cron/newsletters)**

所以在 curl 函数中设置这个 URL 并在同一个文件的 init.php 中调用这个函数。

在上面的链接中，您可以看到“cron”是控制器，而 newsletters 是您可以完成工作的操作，同样，不需要运行引导文件等。

# language-agnostic - 哪些游戏在游戏玩法中包含编码？

> ID：143322
> 
> 赞同：8
> 
> 时间：2008-09-27T09:44:47.600
> 
> 标签：language-agnostic, list

每个答案一个标题。

* * *

## 回答 #1

> 赞同：15
> 
> 时间：2008-09-27T09:48:04.347

Core War ( [http://en.wikipedia.org/wiki/Core_war](http://en.wikipedia.org/wiki/Core_war) ) 是经典之作，其中两个程序在模拟机器中运行，每个程序都试图阻止另一个程序。

* * *

## 回答 #2

> 赞同：12
> 
> 时间：2008-09-27T10:26:59.183

[Robocode](http://robocode.sourceforge.net/)是学习 Java 并从中获得乐趣的好方法。您编写 Java 代码对机器人进行编程，然后机器人与一个或多个其他机器人进行战斗。几年前我试过了，但我记得做起来很开心。我们甚至在工作中对机器人进行了编程（在*实际*工作之间；））并进行了一场小型比赛，看谁能提出最好的算法。推荐的！

* * *

## 回答 #3

> 赞同：8
> 
> 时间：2010-12-06T19:37:35.560

[http://gr1d.org](http://gr1d.org)是一个持久的在线编程角色扮演游戏，您可以在其中编写自己的代理、提升关卡并攻击或防御其他玩家

* * *

## 回答 #4

> 赞同：7
> 
> 时间：2008-09-27T09:47:51.650

[机器人拉力赛！](http://en.wikipedia.org/wiki/RoboRally)

* * *

## 回答 #5

> 赞同：7
> 
> 时间：2008-09-27T09:55:51.803

前几天我发现的一个小 Flash 游戏：[http ://www.gameroo.nl/games/light-bot](http://www.gameroo.nl/games/light-bot)

小心，你可能会失去大约一个小时的生命；）

* * *

## 回答 #6

> 赞同：3
> 
> 时间：2008-09-27T10:35:12.237

[列表和列表：Andrew Plotkin 的交互式教程](http://www.wurb.com/if/game/128)。

> “Scheme 编程语言（Lisp 的一种方言）的入门课程以文本冒险的形式呈现——或者，换句话说，一个带有少量文本冒险的 Scheme 解释器。因为它是 Z 代码，并且第一个 Z 代码游戏是用另一个 Lisp 变体编写的，这一切都有一个奇怪的循环。”

——卡尔·穆肯豪普

* * *

## 回答 #7

> 赞同：3
> 
> 时间：2008-09-27T11:18:39.810

多年前，我在[欧米茄上浪费了太多时间](http://www.the-underdogs.info/game.php?id=783)

* * *

## 回答 #8

> 赞同：2
> 
> 时间：2008-09-27T09:46:48.580

第二人生

* * *

## 回答 #9

> 赞同：1
> 
> 时间：2008-09-27T09:45:53.793

生活？ 

* * *

## 回答 #10

> 赞同：1
> 
> 时间：2008-09-27T09:48:36.203

[机器人](http://en.wikipedia.org/wiki/Crobots)

* * *

## 回答 #11

> 赞同：1
> 
> 时间：2008-09-27T09:49:09.527

通过玩棋盘游戏发现计算机编程的基础知识；c-jump 帮助孩子们学习编程语言的基础知识，例如 C、C++ 和 Java。

[http://www.c-jump.com/](http://www.c-jump.com/)

* * *

## 回答 #12

> 赞同：1
> 
> 时间：2008-09-27T09:49:34.860

GNU Robots ( [http://en.wikipedia.org/wiki/GNU_Robots](http://en.wikipedia.org/wiki/GNU_Robots) ) 是进入 Lisp 的好方法。

* * *

## 回答 #13

> 赞同：1
> 
> 时间：2008-09-27T09:51:29.550

Starship Soccer ( [http://www.geocities.com/siliconvalley/horizo](http://www.geocities.com/siliconvalley/horizon/8596/StarshipSoccer.html) ​​n/8596/StarshipSoccer.html ) 让 C++ 控制的球队相互对抗，混合了太空战争和足球。

* * *

## 回答 #14

> 赞同：1
> 
> 时间：2008-09-27T09:55:32.817

[维基百科](http://en.wikipedia.org/wiki/Programming_game)上的好清单！

> 值得注意的编程游戏包括 Core War、Robocode、RoboWar、Robot Battle、Crobots 和 AI Wars。《最终幻想 XII》还包含了一些编程游戏的元素，玩家可以创建角色的 AI，尽管玩家也可以选择直接控制动作。

* * *

## 回答 #15

> 赞同：1
> 
> 时间：2008-09-27T09:56:06.483

EpsiTec [CeeBot](http://www.ceebot.com/ceebot/family-e.php)

* * *

## 回答 #16

> 赞同：1
> 
> 时间：2008-09-27T10:10:14.357

微软的[Terrarium](http://www.codeplex.com/terrarium2)涉及使用任何 .Net 语言对生物的智能进行编程，现已向[CodePlex开源](http://www.codeplex.com/terrarium2)

# winforms - 在 alpha 混合表单上显示控件

> ID：143338
> 
> 赞同：0
> 
> 时间：2008-09-27T09:50:10.553
> 
> 标签：winforms, .net-2.0, alphablending

我尝试了 Visual C# Kicks[代码的 alpha 混合形式](http://vckicks.110mb.com/splash-screen.php)。这有效（一旦我删除该`TransparencyKey`属性）；也就是说，我可以使用 W3C 的[PNG alpha 测试图像](http://www.w3.org/Graphics/PNG/alphatest.png)并查看下面的其他窗口，但会使表单上的所有控件不可见。据推测，它们根本没有被绘制，就像`OnPaint`被覆盖一样。我尝试调用超类的`OnPaint`：

```
Protected Overrides Sub OnPaint(ByVal e As System.Windows.Forms.PaintEventArgs)
    UpdateFormDisplay()

    MyBase.OnPaint(e)
End Sub 
```

，但这并没有改变任何东西。`MyBase.OnPaint` *（先*打电话也没有任何区别。）

不幸的是，大多数关于 alpha 混合表单的文章都集中在没有任何控件的纯启动屏幕上——但我们需要一个面板，它首先显示登录字段，然后是进度条。

顺便说一句，控件不需要透明度。只有在外部边缘，PNG 的透明度才真正重要。因此，通过在这一切之上添加另一种形式（两者总是串联移动）来伪造这一点可能就足够了，但我更喜欢更平滑的解决方案。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2008-09-27T10:34:01.290

尝试在 InitializeComponents(); 之后将其放入您的表单 ctor；

base.SetStyle(ControlStyles.OptimizedDoubleBuffer | ControlStyles.AllPaintingInWmPaint | ControlStyles.UserPaint, true);

# java - 是否有任何框架可以在 Swing 应用程序中处理数据库请求？

> ID：143341
> 
> 赞同：4
> 
> 时间：2008-09-27T09:53:01.857
> 
> 标签：java, database, multithreading, swing

我相信任何在 gui 应用程序中处理数据库请求的程序员都会遇到以下部分或全部问题：

*   您的 GUI 冻结，因为您从事件调度线程中调用数据库层
*   当您有多个窗口/面板/jframes 用户可以在其中启动数据库请求时，您的性能会降低，因为您无法控制用户创建的线程
*   用户可能能够锁定应用程序甚至数据库，因为他在第一个操作完成之前多次调用任何操作

我想知道的是：是否有任何框架可以处理在事件调度线程之外处理一组有序的长时间运行的操作（包括但不限于数据库调用，即计算）的要求？

注意：我知道 SwingWorker ;-)

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2008-09-27T18:09:28.607

裸对象促进了一个干净的域模型，它们还有一个 GUI 2 DB 映射层——http: [//www.nakedobjects.org/home/index.shtml](http://www.nakedobjects.org/home/index.shtml)

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2008-09-27T11:22:05.697

我怀疑您会找到特定于数据库请求的内容。您可以尝试重用现有的通用任务调度库。一个例子是 Eclipse 作业 API。这不依赖于 IDE。

见[http://www.eclipse.org/articles/Article-Concurrency/jobs-api.html](http://www.eclipse.org/articles/Article-Concurrency/jobs-api.html)

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2008-09-27T14:07:57.890

例如，应该在 Netbeans 中找到这样的东西。请参阅请求处理器。但在更简单的情况下，这不是必需的。上次我需要线程调度和控制之类的东西时，我只是使用了 J5 中包含的新并发包（我使用了 J6）。使用它的 ExecutorFactory-ies，您可以简单地实现对任务的基本控制。您也可以使用一些队列。[此 PDF 可以提供帮助](http://java.cz/dwn/1003/8060_CZJUG_SwingInAction.pdf)。PDF 是用斯洛伐克语编写的，但单/多任务工作人员是用 Java 编写的；）

# html - 如何从嵌入在 HTML 中的 Flash 应用程序控制移动软键

> ID：143365
> 
> 赞同：0
> 
> 时间：2008-09-27T10:18:00.703
> 
> 标签：html, mobile, softkeys

我有一个运行 Flash 9 (CS3) 的 Flash 应用程序。当此 Flash 应用程序加载到受支持的移动设备中时，应用程序能够控制软键。但是，应用程序无法控制何时将其嵌入 HTML 页面并通过支持的移动设备进行浏览。任何想法如何使这项工作？

谢谢 Keerthi

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2008-09-27T17:49:24.970

嵌入 HTML 时没有特殊的方式来接收软键事件 - 如果浏览器/操作系统将事件提供给 Flash，那么您可以像任何其他键事件一样捕获它们：

```
var myListener = new Object();
myListener.onKeyDown = function() {
    var code = Key.getCode();
    if (code==ExtendedKey.SOFT1) {
        trace("I got a soft key event");
    }
}
Key.addListener(myListener); 
```

但是，您会发现当您的 SWF 嵌入 HTML 时，大多数手机/浏览器不会为您提供软键事件。这不是 Flash Lite 规范的一部分——严格来说，我相信如果他们愿意，他们可以为您提供这些事件，但大多数手机只是将这些键用于浏览器功能，并在进入 Flash 之前使用它们。

请注意，您可以在运行时检查软键是否可用：

```
trace(System.capabilities.hasMappableSoftKeys);
trace(System.capabilities.softKeyCount); 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-01-19T10:33:36.360

如果你使用 switch 语句，你可以有多个键码与一个动作相关联，你也可以制作一个用于测试的桌面版本。我自己做过。

# html - 推荐的 HTML 格式化程序脚本/实用程序？

> ID：143367
> 
> 赞同：4
> 
> 时间：2008-09-27T10:22:26.950
> 
> 标签：html, formatting, dreamweaver

简单的问题 - 我有一大堆肮脏的 html 页面要清理，我正在寻找一个开源或免费软件脚本/实用程序来删除任何垃圾并将它们重新格式化为布局良好的一致代码。有什么建议吗？

如果它是相关的，我通常会在 Dreamweaver 中操作 HTML - 但是通过编辑代码并使用所见即所得窗口作为预览而不是反之亦然 - 所以与 Dreamweaver 兼容的脚本将是一个加号。

* * *

## 回答 #1

> 赞同：21
> 
> 时间：2008-09-27T10:25:42.370

我不认为它可以插入 Dreamweaver 但每当我需要清理 html 时[HTML Tidy](http://tidy.sourceforge.net/)就是我的首选

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2008-09-27T10:33:32.290

我第二个 HTML Tidy。
我只是想添加它是一个具有各种端口和绑定的库。因此，它也集成在一些编辑器中，如 HTML-Kit 或 NoteTab，并且它有一个 GUI 前端。所有这些都链接在上面给出的页面中。
另请注意，[W3C 标记验证服务](http://validator.w3.org/ "W3C 标记验证服务")具有“使用 HTML Tidy 清理标记”选项（验证结果显示后）。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2008-09-27T16:58:11.320

Dreamweaver CS3 在“命令”菜单项下有一个内置的“清理 HTML”选项。我不认为它几乎像 HTML Tidy 那样全面。

从[Adob​​e 网站](http://livedocs.adobe.com/en_US/Dreamweaver/9.0/help.html?content=WSc78c5058ca073340dcda9110b1f693f21-7ba0.html)：

> **清理代码**
> 
> 您可以自动删除空标签、组合嵌套字体标签，并以其他方式改进混乱或不可读的 HTML 或 XHTML 代码。
> 
> 有关如何清理从 Microsoft Word 文档生成的 HTML 的信息，请参阅打开和编辑现有文档。
> 
> 1.  打开一个文档：
>     
>     
>     *   如果文档是 HTML，请选择命令 > 清理 HTML。
>     *   如果文档是 XHTML，请选择命令 > 清理 XHTML。-- 对于 XHTML 文档，Clean Up XHTML 命令修复 XHTML 语法错误，将标签属性的大小写设置为小写，除了执行 HTML 清除操作之外，还添加或报告标签缺少的必需属性。
> 2.  在出现的对话框中，选择任意选项，然后单击“确定”。-- 注意：根据文档的大小和选择的选项数量，完成清理可能需要几秒钟的时间。
>     
>     
> 
> **删除空容器标签** 删除它们之间没有内容的所有标签。例如，<b></b> 和 <font color="#FF0000"></font> 是空标签，但 <b>some text</b> 中的 &ly;b> 标签不是。
> 
> **移除冗余嵌套标签** 移除标签的所有冗余实例。例如，在代码<b>This is what I <b>really</b>想要说</b>中，围绕单词的b标签真的是多余的，将被删除。
> 
> **删除非 Dreamweaver HTML 注释** 删除所有不是由 Dreamweaver 插入的注释。例如，<!--begin body text--> 将被删除，但 <!-- TemplateBeginEditable name="doctitle" --> 不会，因为它是一个 Dreamweaver 注释，它标记了一个可编辑区域的开始模板。
> 
> **删除 Dreamweaver 特殊标记**删除 Dreamweaver 添加到代码中的注释，以便在更新模板和库项目时自动更新文档。如果您在清理基于模板的文档中的代码时选择此选项，则该文档将从模板中分离。有关详细信息，请参阅从模板中分离文档。
> 
> **移除特定标签** 移除相邻文本框中指定的标签。使用此选项可删除由其他可视化编辑器插入的自定义标签以及您不希望出现在您的网站上的其他标签（例如，blink）。用逗号分隔多个标签（例如，字体、闪烁）。
> 
> **尽可能合并嵌套的 <font> 标签 当** 它们控制相同的文本范围时合并两个或多个字体标签。例如，<font size="7"><font color="#FF0000">big red</font></font> 将更改为 <font size="7" color="#FF0000">big red </font>。
> 
> **完成时显示日志**显示一个警告框，其中包含有关清理完成后对文档所做更改的详细信息。

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2009-09-06T07:38:21.753

我使用[HTML Formatter](http://www.logichammer.com) ...它完全符合您的要求。

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2010-03-12T19:38:54.083

我绝对认为最好的工具是 Logichammer.com 的[HTML Formatter](http://www.logichammer.com "HTML 格式化程序")。它完全符合您的需求，而且使用起来非常简单。值得一试……这家伙甚至在他的网站上有一段视频，展示了它的易用性。我已经使用它两年了，没有它就活不下去了……我得到了很多乱七八糟的代码。

* * *

## 回答 #6

> 赞同：1
> 
> 时间：2011-03-04T14:11:17.490

我使用[Cleanup HTML](http://www.cleanuphtml.com)它可以很好地清理和格式化 HTML

* * *

## 回答 #7

> 赞同：1
> 
> 时间：2012-02-22T06:17:16.213

我建议[purehtml.in](http://www.purehtml.in) ...它美化了 html、样式和 JavaScript 标签...

* * *

## 回答 #8

> 赞同：0
> 
> 时间：2008-09-27T11:10:25.413

您甚至可以在现有的 HTML 到达浏览器之前通过 HTML Tidy 对其进行缓冲 - 如果它是一个低流量站点，那么这将使事情变得整洁而不费力。

* * *

## 回答 #9

> 赞同：0
> 
> 时间：2009-09-06T07:52:42.347

我也推荐 HTML Tidy，虽然它不再由 Dave Ragett 维护，但该工具肯定会经常通过调整进行更新。

我使用[HTML Trim](http://int64.org/projects/htmltrim)这是一个 win32 应用程序来清理我们的一些开发人员敲掉的一些糟糕的自动生成的代码块。

您还可以获取可以集成到 Dreamweaver 中的命令行版本。

抱歉，我不能发布多个超链接 - 这里仍然是一个 n00b。

* * *

## 回答 #10

> 赞同：0
> 
> 时间：2011-01-15T13:18:26.613

我已经使用[Polystyle](http://www.polystyle.com/)很长时间了，我很高兴。格式化规则相当灵活，成本约为 15 美元。提供试用版。

* * *

## 回答 #11

> 赞同：-1
> 
> 时间：2010-08-18T09:25:27.903

我会推荐vim。您可以使用 v 格式化代码块以选择块，并使用 '=' 缩进代码。

# command-line - CALL -151 它在 APPLE 上做了什么][

> ID：143374
> 
> 赞同：25
> 
> 时间：2008-09-27T10:31:01.907
> 
> 标签：command-line, call, 8-bit, apple-ii

很久以前我有一个苹果][。

我记得命令调用 - 151 但我不记得它做了什么？

* * *

## 回答 #1

> 赞同：25
> 
> 时间：2008-09-27T10:37:13.857

呼叫-151

输入机器码监视器——

[http://www.skepticfiles.org/cowtext/apple/memorytx.htm](http://www.skepticfiles.org/cowtext/apple/memorytx.htm)

**更新：**

该链接似乎已失效，这是 Wayback Machine 替代方案：

> [http://web.archive.org/web/20090315100335/http://www.skepticfiles.org/cowtext/apple/memorytx.htm](http://web.archive.org/web/20090315100335/http://www.skepticfiles.org/cowtext/apple/memorytx.htm)

这是完整的文章，以防万一 Wayback 消失：

```
APPLE CALL、PEEK、POKE LIST CALL 144 扫描输入缓冲区 呼叫 151 输入显示器标准

            APPLE CALL、PEEK、POKE LIST

-------------------------------------------------- ----------------------------
调用 -144 扫描输入缓冲区
呼叫 -151 正常进入显示器
呼叫 -155 进入监视器和响铃
调用 -167 进入监视器并重置
CALL -198 响铃（模拟控制 G）
呼叫 -211 打印“错误”并响铃
CALL -259 从磁带读取
呼叫 -310 写入磁带
调用 -321 显示 A、S、Y、P 和 S 寄存器
CALL -380 设置普通视频模式
CALL -384 设置反向视频模式
呼叫 -415 拆卸 20 条指令
呼叫 -458 验证（比较并列出差异）

拨动 60,61 旧开始 - 62,63 旧结束后调用 -468 内存移动
                          64,65 新结局 - 66,67 新星

呼叫 -484 移动
CALL -517 显示字符和更新屏幕位置
调用 -531 显示字符、掩码控制字符并保存 7 个寄存器。& 累加器
CALL -550 显示 A 寄存器的十六进制值（累加器）
呼叫 -656 响铃并等待回车

CALL -657 GET LINE OF INPUT，NO PROMPT，NO L/F, & WAIT(COMMA,COLON OK
调用 -662 获取输入行，有提示，无 L/F 和等待
调用 -665 获取输入行，带有提示、换行和等待
上述 3 次调用 (-657, -662, -665) 指的是来自 512-767 的输入缓冲区

呼叫 -715 获取字符
呼叫 -756 等待按键
CALL -856 时间延迟（戳 69,XX 设置延迟时间）
调用 -868 清除从光标到行尾的光标行
呼叫 -912 将文本向上滚动 1 行
呼叫 -922 换行
呼叫 -936 清除屏幕（主页）
CALL -958 从光标到屏幕底部清除屏幕
CALL -998 将光标上移 1 行
CALL -1008 将光标向后移动 1 个空格
调用 -1024 仅显示字符
调用 -1036 将光标向前移动 1 个空格
呼叫 -1063 向电流输出设备发送铃
呼叫 -1216 文本和图形模式
调用 -1233 将光标移动到屏幕底部
呼叫 -1321 控制 E
调用 -1717 将光标下移 5 行
呼叫 -1840 拆卸 1 指令
呼叫 -1953 更改颜色 +3
CALL -1994 清除 LO-RES 屏幕（前 40 行）
CALL -1998 清除图形屏幕 (LO-RES)
CALL -2007 垂直线
CALL -2023 水平线
致电 -2458 进入迷你组装机
呼叫 -3100 打开第 1 页，无需清除它
呼叫 -3776 保存整数
CALL -3973 加载整数
调用 -6090 运行整数
CALL -8117 列出整数
呼叫 -8189 输入基本信息并继续
CALL -8192 ENTER BASIC 和 RESET (INTEGER BASIC KILL)
呼叫 -16303 文本模式
呼叫 -16304 图形模式
呼叫 -16336 切换扬声器
致电 42350 目录磁盘
调用 54915 清理堆栈，清除“内存不足”错误
呼叫 64166 启动冷启动（磁盘引导）
致电 64246 全新 - 你想办法

呼叫 64367 扫描内存 LOC 1010 和 1011 并将值插入位置
           1012 等于 (PEEK(1011)-165)

-------------------------------------------------- ----------------------------
PEEK 33 文本窗口宽度 (1-40)
PEEK 34 顶部边缘的文本窗口 (0-22)
PEEK 35 文字窗口底部 (1-24)
PEEK 36 水平光标位置 (0-39)
PEEK 37 垂直光标位置 (0-23)
PEEK 43 引导槽 X 16（引导后）
最后一个 HLIN、VLIN 或绘图的 PEEK 44 端点
PEEK 48 LO-RES 颜色值 X 17

PEEK 50 文本输出格式：63=反向 255=正常
           127=闪光（PEEK 243 设置为 64）

PEEK 51 提示字符
PEEK 74,75 LOMEM 地址 (INT)
PEEK 76,77 HIMEM 地址 (INT)
PEEK 103,104 FP 程序起始地址
PEEK 104 如果返回 8，则 FP 在 ROM 中
PEEK 105,106 FP 可变空间起始地址
PEEK 107,108 FP 阵列起始地址
PEEK 109,110 FP 数字存储地址结束
PEEK 111,112 FP 字符串存储起始地址
PEEK 115,116 FP HIMEM 地址
PEEK 117,118 FP 行号正在执行
程序停止时的 PEEK 119,120 FP 行
PEEK 121,122 FP 行正在执行地址
PEEK 123,124 正在读取数据的行
PEEK 125,126 数据位置地址
PEEK 127,128 输入或数据地址
PEEK 129,130​​ FP 最后使用的变量名
PEEK 131,132 FP 上次使用的变量地址
PEEK 175,176 FP 程序结束地址
PEEK 202,203 INT 程序起始地址
PEEK 204,205 INT 变量存储结束
PEEK 214 FP 运行标志（自动运行 IF >127）
PEEK 216 ONERR 标志（>127 如果 ONERR 处于活动状态）
PEEK 218,219 发生错误的行
PEEK 222 ONERR 错误代码
PEEK 224,225 最后一个 HPLOT 的 X 坐标
最后一个 HPLOT 的 PEEK 226 Y 坐标
PEEK 228 盐酸值 0=0 85=2 128=4 213=6
                42=1 127=3 170=5 255=7
PEEK 230 高分辨率绘图页（32=第 1 页 64=第 2 页 96=第 3 页）
PEEK 231 刻度值
PEEK 232,233 形状表起始地址
PEEK 234 高分辨率碰撞计数器
PEEK 241 256 负速度值
PEEK 243 闪光面罩（64=当 PEEK 50 设置为 127 时闪光）
PEEK 249 腐烂值
PEEK 976-978 DOS 重新进入向量
PEEK 1010-1012 重置矢量
PEEK 1013-1015 与号 (&) 矢量
PEEK 1016-1018 CONTROL-Y 矢量
PEEK 43140-43271 DOS 命令表
PEEK 43378-43582 DOS 错误消息表
PEEK 43607 MAXFILES 值
PEEK 43616,46617 上次加载的长度
PEEK 43624 驱动器号
PEEK 43626 插槽号
PEEK 43634,43635 上次 BLOAD 的起始地址
PEEK 43697 MAXFILES 默认值
PEEK 43698 DOS 命令字符
PEEK 43702 基本标志（0=INT 64=FP ROM 128=FP RAM）
PEEK 44033 目录编号（17 为标准）
PEEK 44567 目录文件名中的字符数减 1
PEEK 44611 位数减 1 扇区数和体积数
PEEK 45991-45998 文件类型代码表
PEEK 45999-46010 磁盘卷标题
PEEK 46017 磁盘卷号
PEEK 46064 扇区数（13=DOS 3.2 16=DOS 3.3）
PEEK 49152 读键盘（如果 >127 则按键已被按下
PEEK 49200 拨动式扬声器（点击）
PEEK 49248 盒式输入（>127=BINARY 1, 127 如果按钮按下）
PEEK 49250 桨 1 按钮 (>127 IF 按钮按下 GD)
PEEK 49251 桨 2 按钮 (>127 如果按钮按下)
PEEK 49252 阅读游戏桨 0 (0-255)
PEEK 49253 阅读游戏桨 1 (0-255)
PEEK 49254 阅读游戏桨 2 (0-255)
PEEK 49255 阅读游戏桨 3 (0-255)
PEEK 49408 读取槽 1
PEEK 49664 读取槽 2
PEEK 49920 读取槽 3
PEEK 50176 读取槽 4
PEEK 50432 读取槽 5
PEEK 50688 读取插槽 6（162=磁盘控制卡）
PEEK 50944 读取槽 7

PEEK 64899 指示您正在使用哪台计算机
           223=Apple II 或 II+，234=FRANKLIN ACE 或？，255=APPLE IIE

POKE 33,33 SCRUNCH 列表并删除报价单中的空格
POKE 36,X 用作打印机选项卡 (X=TAB - 1)
POKE 50,128 使屏幕上的所有输出不可见
POKE 50，随机打乱输出到屏幕
POKE 51,0 击败“非直接命令”，有时不起作用
POKE 82,128 使盒式磁带程序在加载时自动运行
POKE 214,255 设置在 FP 中运行标志和任何键击都将运行磁盘程序
POKE 216,0 取消 ONERR 标志

POKE 1010,3 设置复位向量以启动
POKE 1011,150 冷启动（启动）

戳 1010,102 使
戳 1011,213 重置
戳 1012,112 运行

POKE 1014,165 设置与号 (&) 向量
戳 1015,214 列出您的程序

POKE 1014,110 设置与号 (&) 向量
将 1015,165 插入磁盘目录

POKE 1912+SLOT,1 ON APPLE PARALLEL CARD (with P1-02 PROM) 将启用 L/F'S
POKE 1912+SLOT,0 ON APPLE PARALLEL CARD (with P1-02 PROM) 将启用 L/F'S

POKE 2049,1 这将导致第一行程序重复列出
POKE 40514,20 允许文本文件问候程序
POKE 40514,52 允许二进制文件问候程序

戳 40993,24 这允许
POKE 40994,234 磁盘命令
POKE 40995,234 直接模式

POKE 42319,96 禁用初始化命令

戳 42768,234 全部取消
POKE 42769,234 DOS 错误
戳 42770,234 条消息
POKE 43624,X 选择磁盘驱动器而不执行命令（48K 系统）

POKE 43699,0 关闭执行文件，但在 FP 之前将其打开，关闭
POKE 43699,1 重新打开一个执行文件。初始化或 MAXFILES 问题

POKE 44452,24 允许 20 个文件名（额外 2 个）
在目录暂停前戳 44605,23

POKE 44505,234 显示已删除的文件
在目录中戳 44506,234 个名字

POKE 44513,67 目录将只返回锁定的文件
POKE 44513,2 目录恢复正常
POKE 44578,234 取消运输
POKE 44579,234 目录后返回
戳 44580,234 个文件名

戳 44596,234 取消
POKE 44597,234 目录停止
屏幕已满时戳 44598,234

POKE 44599,234 停止每个文件的目录
POKE 44600,234 命名并等待按键

POKE 46922,96 这允许磁盘
POKE 46923,234 初始化
戳 46924,234 不放
在磁盘上戳 44723,4 DOS

POKE 49107,234 预防语言
加载中的 POKE 49108,234 卡
重新启动期间戳 49109,234

POKE 49168,0 透明键盘
POKE 49232,0 显示图形
POKE 49233,0 显示文本
POKE 49234,0 显示完整图形
POKE 49235,0 显示文本/图形
POKE 49236,0 显示图形第 1 页
POKE 49237,0 显示图形第 2 页
POKE 49238,0 显示知识
POKE 49239,0 显示雇用
-------------------------------------------------- ----------------------------

                48K 内存图

   十进制十六进制用法
-------------------------------------------------- ----------------------------
    0-255 $0-$FF 零页系统存储
  256-511 $100-$1FF 系统堆栈
  512-767 $200-$2FF 键盘字符缓冲器
  768-975 $300-$3CF 通常作为免费空间提供给用户程序
  976-1023 $3D0-3FF 系统向量
 1024-2047 $400-$7FF 文字和 LO-RES 图形 第 1 页
 2048-LOMEM 800 美元的 LOMEM 程序存储
 2048-3071 $800-$BFF 文字和 LO-RES 图形第 2 页或可用空间
 3072-8191 $C00-$1FFF 可用空间，除非 RAM APPLESOFT 正在使用中
 8192-16383 $2000-$3FFF 高分辨率第 1 页或免费空间
16384-24575 $4000-$5FFF 高分辨率第 2 页或免费空间
24576-38999 $6000-$95FF 可用空间和字符串存储
38400-49151 $9600-$BFFF DOS
49152-53247 $C000-$CFFF I/O 硬件（保留）
53248-57343 $D000-$DFFF APPLESOFT 语言卡或 ROM
57344-63487 $E000-$F7FF APPLESOFT 或 INTEGER BASIC 语言卡或 ROM
63488-65535 $F800-$FFFF 系统监视器

PEEK：检查任何内存位置 L，打印 PEEK (L)，其中 L 是小数
号码 0-65535。在后续位置 L 和
L+1，打印 PEEK (L) + PEEK (L+1) * 256

POKE：将值 X (0-255) 分配给位置 L；戳 L，X。戳两字节
数字（如果 X>255 则需要）、POKE L,X-INT(X/256)*256 和 POKE L+1,INT(X/256)。

CALL：要在位置 L 执行机器语言子程序，请调用 L。

只是为了好玩试试这个：戳 33,90。然后尝试列出您的程序。或尝试：
0,99 或戳 50,250 或戳 50,127。使用复位返回正常。

对于真正的随机数生成，试试这个：X= RND(PEEK(78)+PEEK(79)*256)

要找到最后一个加载文件的起始地址，请使用：PEEK(-21902)+PEEK
(-21901)*256（结果为十六进制）

确定最后加载文件的长度使用：PEEK(-21920)+PEEK(-21919
*256（结果为十六进制）

要确定导致错误发生的行号，请将 X 设置为：PEEK(218
+窥视(219)*256

-------------------------------------------------- ----------------------------

电子邮件 Fredric L. Rice / 怀疑论者坦克

```

* * *

## 回答 #2

> 赞同：11
> 
> 时间：2010-03-29T01:55:19.723

调用 -151 进入监视器，3D0G 将您带回 BASIC，然后在监视器中键入插槽 #，然后按 Ctrl-P 将启动该设备。令人惊讶的是20年后的记忆！

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2015-11-04T13:02:33.123

我还可以补充一点，-151 是苹果 ][ 表示十六进制数的方式，应该表示 $FF69（Apple II 中使用的十六进制语法，即 0xFF68）。CALL 是一个 Apple Basic 命令，它调用由参数（此处为 -151）给出的程序集子例程。IIRC，此命令可以接受地址作为负十进制值，用于使用 2 的补码解释在 $8000-$FFFF 之间的地址。

对于那些对历史感兴趣的人，这里是 Apple ][ 的监视器 rom 列表（在 6502 程序集中），地址 $FF69 带有标签 MONZ，它是处理来自用户的机器代码处理命令的命令提示符的开始。使用“*”作为提示符的一种。一个非常原始的命令提示符。

[Apple II 系统监视器](http://www.easy68k.com/paulrsm/6502/MON.TXT)

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2008-09-27T10:38:44.617

克里基，那是过去的爆炸。我认为它进入了监视器 ROM（我在这和 Integer BASIC 之间纠结，但我很确定它是监视器）。

您可以下载 Apple II 模拟器并找出答案。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2020-06-27T21:43:39.490

作为旁注，这是一个负数而不是正确的**CALL 65385**的原因是因为 Apple II 的第一种 BASIC 形式被称为 Integer BASIC。它只理解从-32768到32767的带符号的16位整数值，因此不可能以正常的正值方式直接寻址超过32767的内存。

如果您尝试在 Integer BASIC 中实际输入 POKE 49200,0 或 CALL 65385，您将收到类似“>32767 ERR”的消息

当使用浮点数替换 Microsoft Applesoft BASIC（是的，来自他们）时，它们包括对负 POKE 值的支持，以便在一定程度上向后兼容旧的 Integer BASIC 程序。尽管这种兼容性是有限的，因为 Applesoft 缺少 Integer 的其他编程功能，例如 MOD 除法余数。

由于早期 Integer BASIC 编程方法的强大影响，有许多 PEEK POKE 和 CALL 命令通常只能通过其十六进制和负十进制值来识别，而不能通过其正十进制值来识别。

# servlets - Servlet 构造函数和 init() 方法

> ID：143386
> 
> 赞同：7
> 
> 时间：2008-09-27T10:39:02.043
> 
> 标签：servlets, init

为什么我们需要 servlet 中的 init() 方法？我们不能使用构造函数来初始化吗？

* * *

## 回答 #1

> 赞同：18
> 
> 时间：2008-09-27T10:53:22.133

因为 Servlet 是一个接口，而不是一个抽象类。不能在接口上指定构造函数参数，因此需要在普通方法签名上指定 ServletContext。

这允许应用程序服务器知道如何正确初始化任何 Servlet 实现。

另一种解决方案是要求，但在编译时不强制执行采用 ServletContext 的构造函数。然后应用程序服务器将通过反射调用构造函数。然而，Servlet 规范的设计者并没有选择这条路。

# java - Java：嵌入到 Java 桌面应用程序中的脚本语言（宏）

> ID：143388
> 
> 赞同：9
> 
> 时间：2008-09-27T10:42:07.463
> 
> 标签：java, javascript, scripting, lua, jython

我正在用 Java 编写图形应用程序。最终我想建立一种脚本语言，这样事情就可以编程了。你推荐哪个语言库？

可能的嫌疑人是：

*   [犀牛](http://www.mozilla.org/rhino/)(JavaScript)
*   [JRuby](http://jruby.codehaus.org/)（红宝石）
*   [Jython](http://www.jython.org/Project/) (Python)

不太可能的候选人是：

*   [使用JavaCC 打造](https://javacc.dev.java.net/)我自己的语言
*   [LuaJava](http://www.keplerproject.org/luajava/) (Lua)
*   [时髦的](http://groovy.codehaus.org/)
*   [JavaFX](http://java.sun.com/javafx/)
*   [符文](http://www.gimp.org/docs/scheme_plugin/)

目标受众可能不是铁杆程序员，因此首选不那么晦涩难懂的语言。我的猜测是 JavaScript 更容易被他们接受，即使它有怪癖，只是因为他们看到的更多。

Lua 似乎在 C/C++ 中很流行，但至少 LuaJava 需要额外的 .dll/.so，这使得部署变得复杂。

编辑： [PhiLho](https://stackoverflow.com/questions/143388/java-scripting-language-macro-to-embed-into-a-java-desktop-application#143421)写道，有一个名为 kahlua 的 Lua 的 Java[实现](http://code.google.com/p/kahlua/)。

* * *

相关问题：

*   [在现有代码库中支持哪种脚本语言？](https://stackoverflow.com/questions/15349/which-scripting-language-to-support-in-an-existing-codebase)（在 C/C++ 中）
*   [向 .net 应用程序添加脚本功能](https://stackoverflow.com/questions/260/adding-scripting-functionality-to-net-apps)
*   [嵌入 C# 桌面应用程序的最佳脚本语言是什么。](https://stackoverflow.com/questions/137933/what-is-the-best-scripting-language-to-embed-in-a-c-desktop-application)

* * *

## 回答 #1

> 赞同：9
> 
> 时间：2008-09-27T10:55:03.423

如果目标受众是“没有编程技能....”，则选择 jython (python) 它很容易学习。（我 7 岁的女儿学得很快）

Bruce Eckel 在“thinking in java”中与 jython 一起写了一章。

在获得“否决票”的危险中，python 比 BASIC 更容易:-)

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2008-09-27T11:04:14.150

Lua 因其语言的简单性而受到赞赏，使其易于学习。LuaJava 使用原始的 Lua 实现，使其完整，但正如您指出的那样，安装起来可能很微妙。我至少知道 Lua 的纯 Java 实现：[Kahlua](http://code.google.com/p/kahlua/ "甘露酒")。它不完整（除其他外缺少协程支持，但没有它们可以做很多事情），但可能已经可用于您的目标。
不像，比如说，Groovy，它不应该给你的应用程序增加太多开销......

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2008-09-30T01:15:29.563

如果您想全力以赴，您可以使用JSR 223[定义](http://java.sun.com/developer/technicalArticles/J2SE/Desktop/scripting/ "Java 平台的脚本")的 Java 平台脚本。采用这种方法将允许应用程序使用任何具有一致[脚本引擎](https://scripting.dev.java.net/ "脚本：项目主页")的语言。

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2008-09-27T12:22:53.727

还有 BeanShell，它的优点是成为完全认可的 JSR，因此可能更容易留下来。

[http://www.beanshell.org/](http://www.beanshell.org/)

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2008-10-17T09:47:23.833

Java 6 已经提供了 javascript 作为 JSR 223 脚本语言，开箱即用。

* * *

## 回答 #6

> 赞同：1
> 
> 时间：2008-10-29T07:44:29.170

我刚刚阅读了 Steve Yegge 的[通用设计模式](http://steve-yegge.blogspot.com/2008/10/programmers-view-of-universe-part-1.html)。这篇文章的主题比 Java 应用程序中的嵌入式脚本要广泛得多，但是由于作者编写了一个允许编写脚本的 Java 应用程序（使用 Jython），因此我发现了一些有趣的深刻观点。

> JavaScript 是地球上最好的两种脚本语言之一，在“脚本语言”一词的最正确意义上：即专门设计用于嵌入更大的主机系统然后用于操作或“脚本”的语言主机系统中的对象。这就是 JavaScript 的设计初衷。它相当小，有一些可选的扩展，它有一个相当严格的非正式规范，它有一个精心设计的接口，用于在 JavaScript 中透明地显示主机系统对象。
> 
> 相比之下，Perl、Python 和 Ruby 是巨大的蔓延，都试图（如 C++ 和 Java）成为每项任务的最佳语言。在编写任意主机系统的脚本方面，唯一与 JavaScript 竞争的其他主流语言是 Lua，它以游戏行业首选的脚本语言而闻名。

我同意他将范围缩小到 JavaScript 和 Lua。

> 如果没有方便的示例，我所能做的就是说使用 JavaScript/Rhino（或 Lua，一旦它在 JVM 上可用）可能会让我的生活更轻松。

我个人更喜欢 Java 平台上的 JavaScript。用户基数更大。正如 Yegge 所说，它是“世界上最容易被误解的编程语言”，但该语言的可用资源量是一个加分项。[犀牛](http://www.mozilla.org/rhino/)似乎是一只成熟的野兽。

* * *

## 回答 #7

> 赞同：1
> 
> 时间：2009-03-13T10:02:22.807

我目前正在寻找一个允许我使用 Lua 脚本中的 Java 对象和方法的库。

我的第一个想法是也使用 LuaJava，但由于我希望它可以在 Linux、Mac 和 Windows 上运行，我被它除了使用 Java 之外还使用编译库这一事实而推迟了。只有 Windows 预编译的二进制文件可用，而且我不是 Mac 专家，所以我试图在纯 Java 中找到一些东西，我发现了这个：http: [//sourceforge.net/projects/luaj](http://sourceforge.net/projects/luaj)

它似乎实现了 Lua 文档中描述的 C API，以及来自 LuaJava 的 API。

该项目看起来非常先进，有来自 Lua (!) 的 Swing 调用示例，它们在我的 Linux 机器上工作。但奇怪的是，邮件列表、论坛和文档真的很少。

我也要在 Windows 和 Mac 上试试这个。希望它有效。

已经提到了 Kahlua，但它只针对 J2ME，这就是为什么它缺少 Lua 的某些部分。我认为有一个名为 Mochalua 的项目具有相同的目标。

另一方面，LuaJ 有两个版本，一个针对 J2SE，它实现了一切（协程也是），另一个针对 J2ME，我认为它缺少 2 或 3 个库（包括需要反射的 LuaJava 东西）。

* * *

## 回答 #8

> 赞同：0
> 
> 时间：2008-09-27T13:33:25.773

你可以考虑[Jacl](http://tcljava.sourceforge.net/docs/website/index.html)。它基于最初设计为可嵌入脚本语言的 Tcl。因此，有人可能会争辩说，它比其他能够嵌入附加的脚本语言更适合该目的。

特别是如果目标受众是“非核心程序员”，Jacl 是一个不错的选择。聪明的人（尤其是那些没有硬性编程偏见的人）可以在早上轻松掌握 Tcl 语法。

* * *

## 回答 #9

> 赞同：0
> 
> 时间：2014-02-19T20:01:24.317

您可以使用[RelProxy](https://github.com/jmarranz/relproxy/) - Java，它提供了真正的纯 Java 作为脚本语言，包括用 Java 制作的 shell 脚本，这要归功于它的即时编译。因为 Java“脚本”是共享启动器 ClassLoader 执行的，所以集成很简单。

# java - Java：文本到语音引擎概述

> ID：143390
> 
> 赞同：54
> 
> 时间：2008-09-27T10:43:20.923
> 
> 标签：java, text-to-speech

我现在正在寻找 Java 文本转语音 (TTS) 框架。在我的调查中，我发现[JSAPI 实现页面](http://java.sun.com/products/java-media/speech/reference/codesamples/index.html)上列出了几个 JSAPI1.0-（部分）兼容的框架，以及一对似乎不遵循 JSAPI 规范的 Java TTS 框架（[Mary](http://mary.dfki.de/)，[Say-It-Now](http://www.say-it-now.com/mainsite.htm)） . 我还注意到目前不存在 JSAPI 的参考实现。

我为 FreeTTS（JSAPI impls 页面中列出的第一个）所做的简短测试表明，它远非阅读简单明了的单词（例如：ABC、黑板）。其他测试目前正在进行中。

这是问题（实际上是6）：

1.  您使用过哪些基于 Java 的 TTS 框架？
2.  您认为哪些能够阅读最大的词库？
3.  他们的语音质量怎么样？
4.  他们的表现如何？
5.  现场有哪些具有 Java 绑定的非 Java 框架？
6.  你会推荐他们中的哪一个？

预先感谢您的意见和建议。

* * *

## 回答 #1

> 赞同：18
> 
> 时间：2008-09-27T11:36:42.700

实际上，我在[FreeTTS 上运气不错](http://freetts.sourceforge.net/)

* * *

## 回答 #2

> 赞同：12
> 
> 时间：2013-09-13T15:36:58.630

谷歌翻译有一个秘密的 tts api： [https ://translate.google.com/translate_tts?ie=utf-8&tl=en&q=Hello%20World](https://translate.google.com/translate_tts?ie=utf-8&tl=en&q=Hello%20World)

* * *

## 回答 #3

> 赞同：8
> 
> 时间：2014-12-25T14:55:57.610

其实，选择并不大：

*   节日，最古老。用 C++ 编写，但绑定到 Java。
*   eSpeak，快速简单，由 Google 翻译使用
*   姆布罗拉

纯Java：

*   FreeTTS，代码是从 Festival 移植过来的，然后开源了，开发就停止了。
*   MaryTTS - 更强大，看起来已经准备好生产。

还有其他专有程序，例如：

*   阿卡贝拉
*   细微差别发声器

如果您的软件仅适用于 Windows，则可以使用 Microsoft Speech API。

* * *

## 回答 #4

> 赞同：7
> 
> 时间：2008-09-27T10:58:04.540

我以前用过 Mary，声音的质量给我留下了深刻的印象。不幸的是，我没有使用任何其他的。

* * *

## 回答 #5

> 赞同：5
> 
> 时间：2008-09-29T19:30:42.153

我使用了提供 JSAPI 和 MS SAPI 挂钩的[AT&T Natural Voices 。](http://www.naturalvoices.att.com/)它提供优质的声音、良好的“通用”语音词典、对发音的许多控制和多种语言。它有点贵，但效果很好。

我用它在移动传感器应用程序中向驱动程序读取重要的传感器遥测数据。我们对语音质量没有任何抱怨。它在科学术语方面具有大约 75% 的开箱即用准确率，而在正常对话方面则更高（可能 90% 以上）。通过使用标记，我们将其准确率提高到 99% 以上（大多数错误是在科学术语上带有不寻常的音素组合）。

处理器有点困难（我们在 Pentium-III 等效机器上运行，它正在推动 50%-75% 的峰值 CPU）。它使用带有 Java 接口的本机语音引擎（Windows、Linux 和 Mac 兼容）。

有各种各样的声音和语言......

* * *

## 回答 #6

> 赞同：1
> 
> 时间：2008-09-29T09:28:21.273

非常感谢大家，诀窍在于 FreeTTS 源代码。简而言之：如果作为 运行`java -jar freetts.jar some-more-args-here`，它的拼写比以 bin/Server.jar 和 bin/Client.jar 的方式执行时要少。

* * *

## 回答 #7

> 赞同：1
> 
> 时间：2009-04-10T13:32:55.903

我使用了 FreeTTS，但在让 MBrola 声音在 My MacbookPro 上运行时遇到了一个大问题。我确实让 MBrola 声音在 Windows（痛苦地）和 Linux 上运行。我没有运气在 FreeTTS 上加载任何其他语音包，这是一种耻辱，因为提供的语音是可怕的 IMO。除此之外，我在 Cloudgarden 上也取得了一些成功，但它只在 Windows AFAIK 上运行。我很想听听其他人使用语音引擎的成功/失败，因为这类工作特别具有挑战性。我也在玩弄Sphinx4。昨晚我刚刚下载了 JVXML（它似乎基于 Sphinx4），但由于某种奇怪的原因无法让它运行。

* * *

## 回答 #8

> 赞同：1
> 
> 时间：2010-02-27T14:19:20.073

我为玛丽做出了贡献。*如果有人*比我更聪明，我觉得它有潜力将 HMM 声音从核心中分离出来（这些声音不需要大型数据集并且听起来不错）。我也在尝试为 freetts 做一个事件系统，以便在它说一个词时发送事件。我已经成功了，但是现在在 linux 中它被打破了。（可能是因为计时器错误）。

* * *

## 回答 #9

> 赞同：0
> 
> 时间：2017-08-08T12:21:31.763

[我发现MarryTTS](http://mary.dfki.de/)不太舒服它有多种语言和清晰的声音可以理解。

T 将语音转换为文本，更好的选择是 [sphinx4-5prealpha](https://cmusphinx.github.io/wiki/download/)。我给一个拇指，因为它具有可调节、灵活和可修改的识别器和语法。

# visual-studio-2008 - A#.Net 在 Visual Studio 2008 中是否工作？

> ID：143396
> 
> 赞同：2
> 
> 时间：2008-09-27T10:52:42.930
> 
> 标签：visual-studio-2008, compatibility, ada

按照标题。对于那些不知道的人，它基本上是 .Net 的 Ada。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2008-09-27T11:07:01.227

根据 [wikipedia]( [http://en.wikipedia.org/wiki/A_Sharp_(.NET))](http://en.wikipedia.org/wiki/A_Sharp_(.NET)))，A#.Net 已被折叠成“GNAT for .Net”以供将来发布

> [AdaCore](http://www.adacore.com/home/)接手了这项开发，并发布了“GNAT for .NET”，这是一个完全支持的 .NET 产品，具有 A# 的所有功能以及更多功能。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2010-07-01T17:48:43.403

2010 年的 .Net。版本应该适用于 MVS 2008。

# apache-flex - PureMVC 的可移植性如何使应用程序开发人员受益？

> ID：143403
> 
> 赞同：6
> 
> 时间：2008-09-27T10:55:36.713
> 
> 标签：apache-flex, puremvc

PureMVC 框架的既定目标之一是避免平台依赖性以实现可移植性。考虑到由于语言和 API 的差异，应用程序代码将始终严重依赖于平台，并且避免平台依赖会使框架重新发明轮子和/或仅提供最小公分母功能集，可移植性以何种方式作为应用程序开发人员，该框架对我有什么好处？

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2008-09-27T11:12:27.377

我曾与 PureMVC 合作过。他们试图用很多语言来实现他们的东西。关于最小公分母，你可能是对的，但总的来说，它不是一个糟糕的框架，而且我在 PureMVC 中看到了一个非常好的 AS3 应用程序。

我不认为他们在谈论移植实际代码的可移植性。您使用通用 MVC 架构的想法更多，您可以将其应用于其他项目和其他语言。

他们试图说，如果您熟悉 PureMVC 模式，您可能会接触到新的 PureMVC 代码库，即使它是另一种语言，并且您已经了解了这片土地。

您也可能会说，开发出良好的 PureMVC 技能的开发人员可能会养成良好的习惯，这些习惯会随着他们从一种语言转换到另一种语言。但话又说回来，也许不是……因为你提到的原因。

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2008-12-24T18:49:10.057

我们现在已经在两个项目中使用了 PureMVC，在我看来，尝试独立于语言是一个相当大的负担。

如果语言还不是很相似（C# 到 java 是有意义的，as3 到 php 不是），那么因为已经知道框架而直接进入项目的承诺似乎与我无关——我同意它是有用的已经知道解决问题的方法，但是“普通”模式已经足够好了。

但是，我也不完全同意项目使用的各种模式的使用，因此我们选择在下一个项目中不使用它可能与这两个问题有关，而不仅仅是语言/平台独立性的尝试。

* * *

## 回答 #3

> 赞同：3
> 
> 时间：2009-11-05T16:25:04.537

当您迁移到另一种语言或用另一种语言重新实现时，PureMVC 的可移植性将为您提供帮助。

我数不清有多少平台和语言我为它们编写的代码现在已经灭绝，即使我还有源代码，它也几乎毫无价值，今天必须从头开始重写，因为代码通常是 100% 特定于平台的。

但是所有应用程序代码都不需要严重依赖于平台。视图组件和服务（您的应用程序的边界）必然是，但夹在边界之间的应用程序逻辑不一定是。

PureMVC 的范围真的很窄；只是为了帮助您将代码拆分为 MVC 元模式所禁止的三层。没有理由将此代码与您的平台紧密绑定才能达到最佳状态。

当需要迁移时，您会发现框架参与者及其角色、职责和协作保持不变。这使您可以处理语言的语法差异，重新创建视图组件和服务。至少你不必完全重新架构。

对于以不同语言重新实现的情况，假设您正试图通过您的应用程序占领移动市场的重要部分。市场如此分散，您必须在 2 个或更多 Windows Mobile、iPhone、Flash 和 Java 上实现相同的程序。当然，您可能会有不同的团队负责应用程序，但为什么会有完全不同的架构呢？使用 PureMVC，您可以为应用程序的所有版本使用单一架构。

-=悬崖>

* * *

## 回答 #4

> 赞同：2
> 
> 时间：2009-01-12T16:41:44.743

对于选择不使用 Flex 框架的 Flash 平台开发人员来说，PureMVC 是唯一真正的选择。对于某些项目，Flex 的规模成本太贵了（它发生了！）。

我喜欢在 Flex 中制作原型，然后在应用程序接近完成时将其撕掉并用自定义组件替换我的视图。PureMVC 使用它的 Mediator 模式使这变得非常容易。我不确定是否有任何其他框架可以让我使用这个工作流程。

就我个人而言，我认为 PureMVC 的可移植性目标太过分了：我喜欢它与 Flash 和 Flex 一起工作的事实（出于上述原因），但觉得它应该停在那里，并利用原生 Flash Player 事件建筑学。

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2009-12-09T10:23:20.050

是否有使用 PureMVC 跨多个平台构建和移植应用程序的示例？

我的公司正在构建一个我们可能需要移植到其他平台的 Flex 应用程序：

*   银光（可能）
*   手机（可能）
*   桌面（也许——不仅仅是 AIR！）
*   电视机（也许最终）

如果 PureMVC 可以简化移植和维护，我正在考虑将其作为一个框架。我很想知道其他人是否已将 PureMVC 应用程序移植到不同的平台，以及他们在移植和在多个平台上并行开发应用程序的经验。

干杯，

卡尔提克

* * *

## 回答 #6

> 赞同：1
> 
> 时间：2010-08-17T07:52:03.753

PureMVC 的内部工作（Flash 事件等）不依赖于平台。因此，虽然它不会让移植变得更容易，但它可以通过向我们展示它友好和熟悉的面孔来帮助我们，无论我们选择去哪里;-)

# c# - C# 接口。隐式实现与显式实现

> ID：143405
> 
> 赞同：666
> 
> 时间：2008-09-27T10:56:16.430
> 
> 标签：c#, .net, interface

在 C# 中**隐式**和**显式**实现接口有什么区别？

什么时候应该使用隐式，什么时候应该使用显式？

两者有什么优点和/或缺点吗？

* * *

Microsoft 的官方指南（来自第一版[框架设计指南](https://rads.stackoverflow.com/amzn/click/com/0321246756)）指出**不建议使用显式实现**，因为它会给代码带来意想不到的行为。

**我认为这个指导方针在 IoC 之前的时代**非常有效，当你不把东西作为接口传递时。

任何人都可以触及这方面吗？

* * *

## 回答 #1

> 赞同：514
> 
> 时间：2008-09-27T11:07:40.117

**隐式**是当您通过类中的成员定义接口时。**显式**是当您在接口上的类中定义方法时。我知道这听起来令人困惑，但我的意思是：`IList.CopyTo`将隐式实现为：

```
public void CopyTo(Array array, int index)
{
    throw new NotImplementedException();
} 
```

并明确为：

```
void ICollection.CopyTo(Array array, int index)
{
    throw new NotImplementedException();
} 
```

不同之处在于隐式实现允许您通过您创建的类访问接口，方法是将接口转换为该类和接口本身。显式实现允许您仅通过将接口转换为接口本身来访问接口。

```
MyClass myClass = new MyClass(); // Declared as concrete class
myclass.CopyTo //invalid with explicit
((IList)myClass).CopyTo //valid with explicit. 
```

我主要使用显式来保持实现干净，或者当我需要两个实现时。无论如何，我很少使用它。

我确信有更多理由使用/不使用其他人会发布的明确内容。

请参阅此线程中的[**下一篇文章**](https://stackoverflow.com/questions/143405/c-interfaces-implicit-and-explicit-implementation#143425)，了解每个文章背后的出色推理。

* * *

## 回答 #2

> 赞同：207
> 
> 时间：2008-09-27T11:09:57.910

隐式定义是直接将接口所需的方法/属性等添加到类中作为公共方法。

显式定义仅在您直接使用接口而不是底层实现时才强制公开成员。在大多数情况下，这是首选。

1.  通过直接使用接口，您不会承认并将您的代码耦合到底层实现。
2.  如果您的代码中已经有一个公共属性 Name 并且您想要实现一个也具有 Name 属性的接口，那么显式执行它将使两者分开。即使他们在做同样的事情，我仍然会将显式调用委托给 Name 属性。您永远不会知道，您可能想要更改 Name 对普通类的工作方式以及 Name 的工作方式，接口属性稍后会工作。
3.  如果你隐式地实现了一个接口，那么你的类现在暴露了可能只与接口的客户端相关的新行为，这意味着你没有让你的类足够简洁（我的观点）。

* * *

## 回答 #3

> 赞同：73
> 
> 时间：2008-09-27T11:59:02.037

除了已经提供的出色答案之外，在某些情况下，编译器需要显式实现才能弄清楚需要什么。看看`IEnumerable<T>`一个可能会经常出现的主要例子。

这是一个例子：

```
public abstract class StringList : IEnumerable<string>
{
    private string[] _list = new string[] {"foo", "bar", "baz"};

    // ...

    #region IEnumerable<string> Members
    public IEnumerator<string> GetEnumerator()
    {
        foreach (string s in _list)
        { yield return s; }
    }
    #endregion

    #region IEnumerable Members
    IEnumerator IEnumerable.GetEnumerator()
    {
        return this.GetEnumerator();
    }
    #endregion
} 
```

在这里，`IEnumerable<string>`implements `IEnumerable`，因此我们也需要。但是等等，通用版本和普通版本**都实现了具有相同方法签名的函数**（C# 忽略了返回类型）。这是完全合法的。编译器如何解决使用哪个？它迫使您最多只有一个隐式定义，然后它可以解决它需要的任何问题。

IE。

```
StringList sl = new StringList();

// uses the implicit definition.
IEnumerator<string> enumerableString = sl.GetEnumerator();
// same as above, only a little more explicit.
IEnumerator<string> enumerableString2 = ((IEnumerable<string>)sl).GetEnumerator();
// returns the same as above, but via the explicit definition
IEnumerator enumerableStuff = ((IEnumerable)sl).GetEnumerator(); 
```

PS：IEnumerable 的显式定义中的一小部分间接有效，因为在函数内部，编译器知道变量的实际类型是 StringList，这就是它解析函数调用的方式。对于实现一些抽象层，一些 .NET 核心接口似乎已经积累了一些漂亮的小事实。

* * *

## 回答 #4

> 赞同：37
> 
> 时间：2011-02-09T18:40:36.297

通过 C# 引用 CLR 中的 Jeffrey Richter
（**EIMI**表示**E** xplicit **I interface** **M** method **I** mplementation ）

> 了解使用 EIMI 时存在的一些后果对您来说至关重要。由于这些后果，您应该尽量避免使用 EIMI。幸运的是，通用接口可以帮助您避免 EIMI。但是有时您可能仍然需要使用它们（例如实现两个具有相同名称和签名的接口方法）。以下是 EIMI 的大问题：
> 
> *   没有说明类型如何具体实现 EIMI 方法的文档，也没有 Microsoft Visual Studio [IntelliSense](https://en.wikipedia.org/wiki/Intelli-sense)支持。
> *   值类型实例在转换为接口时被装箱。
> *   派生类型不能调用 EIMI。

如果您使用接口引用，则可以在任何派生类上将任何虚拟链显式替换为 EIMI，并且当将此类类型的对象强制转换为接口时，您的虚拟链将被忽略并调用显式实现。那不是多态性。

EIMI 还可用于从基本框架接口的实现（例如 IEnumerable<T>）中隐藏非强类型接口成员，因此您的类不会直接公开非强类型方法，但语法正确。

* * *

## 回答 #5

> 赞同：35
> 
> 时间：2010-06-14T01:31:06.437

## 原因 #1

*[当我想劝阻“为实现编程”（来自设计模式的设计原则](http://www.artima.com/lejava/articles/designprinciples.html)*）时，我倾向于使用显式接口实现。

例如，在基于[MVP](https://en.wikipedia.org/wiki/Model%E2%80%93view%E2%80%93presenter)的 Web 应用程序中：

```
public interface INavigator {
    void Redirect(string url);
}

public sealed class StandardNavigator : INavigator {
    void INavigator.Redirect(string url) {
        Response.Redirect(url);
    }
} 
```

现在另一个类（例如[Presenter](https://en.wikipedia.org/wiki/Model%E2%80%93view%E2%80%93presenter#Pattern_description)）不太可能依赖于 StandardNavigator 实现，而更可能依赖于 INavigator 接口（因为需要将实现转换为接口才能使用 Redirect 方法）。

## 原因 #2

我可能会使用显式接口实现的另一个原因是保持类的“默认”接口更干净。例如，如果我正在开发一个[ASP.NET](http://en.wikipedia.org/wiki/ASP.NET)服务器控件，我可能需要两个接口：

1.  类的主要接口，供网页开发者使用；和
2.  我开发的演示者用来处理控件逻辑的“隐藏”接口

下面是一个简单的例子。这是一个列出客户的组合框控件。在此示例中，网页开发人员对填充列表不感兴趣；相反，他们只想能够通过 GUID 选择客户或获取所选客户的 GUID。演示者将在第一个页面加载时填充该框，并且该演示者由控件封装。

```
public sealed class CustomerComboBox : ComboBox, ICustomerComboBox {
    private readonly CustomerComboBoxPresenter presenter;

    public CustomerComboBox() {
        presenter = new CustomerComboBoxPresenter(this);
    }

    protected override void OnLoad() {
        if (!Page.IsPostBack) presenter.HandleFirstLoad();
    }

    // Primary interface used by web page developers
    public Guid ClientId {
        get { return new Guid(SelectedItem.Value); }
        set { SelectedItem.Value = value.ToString(); }
    }

    // "Hidden" interface used by presenter
    IEnumerable<CustomerDto> ICustomerComboBox.DataSource { set; }
} 
```

演示者填充数据源，网页开发人员永远不需要知道它的存在。

### 但这不是银色炮弹吗

我不建议总是使用显式接口实现。这些只是两个可能有用的例子。

* * *

## 回答 #6

> 赞同：19
> 
> 时间：2008-10-01T13:08:01.167

除了已经说明的其他原因之外，在这种情况下，一个类正在实现两个不同的接口，这些接口具有具有相同名称和签名的属性/方法。

```
/// <summary>
/// This is a Book
/// </summary>
interface IBook
{
    string Title { get; }
    string ISBN { get; }
}

/// <summary>
/// This is a Person
/// </summary>
interface IPerson
{
    string Title { get; }
    string Forename { get; }
    string Surname { get; }
}

/// <summary>
/// This is some freaky book-person.
/// </summary>
class Class1 : IBook, IPerson
{
    /// <summary>
    /// This method is shared by both Book and Person
    /// </summary>
    public string Title
    {
        get
        {
            string personTitle = "Mr";
            string bookTitle = "The Hitchhikers Guide to the Galaxy";

            // What do we do here?
            return null;
        }
    }

    #region IPerson Members

    public string Forename
    {
        get { return "Lee"; }
    }

    public string Surname
    {
        get { return "Oades"; }
    }

    #endregion

    #region IBook Members

    public string ISBN
    {
        get { return "1-904048-46-3"; }
    }

    #endregion
} 
```

此代码编译并运行正常，但 Title 属性是共享的。

显然，我们希望 Title 的返回值取决于我们是将 Class1 视为 Book 还是 Person。这是我们可以使用显式接口的时候。

```
string IBook.Title
{
    get
    {
        return "The Hitchhikers Guide to the Galaxy";
    }
}

string IPerson.Title
{
    get
    {
        return "Mr";
    }
}

public string Title
{
    get { return "Still shared"; }
} 
```

请注意，显式接口定义被推断为 Public - 因此您不能将它们显式声明为 public（或以其他方式）。

另请注意，您仍然可以拥有“共享”版本（如上所示），但虽然这是可能的，但这种属性的存在是值得怀疑的。也许它可以用作 Title 的默认实现 - 这样就不必修改现有代码来将 Class1 转换为 IBook 或 IPerson。

如果您没有定义“共享”（隐式）标题，Class1 的使用者**必须首先**将 Class1 的实例显式转换为 IBook 或 IPerson - 否则代码将无法编译。

* * *

## 回答 #7

> 赞同：17
> 
> 时间：2014-08-15T08:27:10.507

我大部分时间都使用显式接口实现。以下是主要原因。

**重构更安全**

更改接口时，最好编译器可以检查它。这对于隐式实现更难。

我想到了两种常见的情况：

*   *将函数添加到接口，其中实现此接口的现有类恰好具有与新方法具有相同签名的方法*。这可能会导致意想不到的行为，并多次咬我。调试时很难“看到”，因为该函数可能不在文件中的其他接口方法中（下面提到的自文档问题）。

*   *从接口中删除功能*。隐式实现的方法会突然变成死代码，但显式实现的方法会被编译错误捕获。即使死代码很好保留，我也想被迫审查并推广它。

不幸的是，C# 没有强制我们将方法标记为隐式实现的关键字，因此编译器可以进行额外的检查。由于需要使用“覆盖”和“新”，虚拟方法不存在上述任何一个问题。

注意：对于固定或很少更改的接口（通常来自供应商 API），这不是问题。但是，对于我自己的界面，我无法预测它们何时/如何改变。

**它是自我记录的**

如果我在一个类中看到“public bool Execute()”，则需要额外的工作才能确定它是接口的一部分。有人可能不得不这样评论它，或者把它放在一组其他接口实现中，所有这些都在一个区域或分组评论下，说“ITask 的实现”。当然，这仅在组标题不在屏幕外的情况下才有效。

鉴于：'bool ITask.Execute()' 清晰明确。

**接口实现清晰分离**

我认为接口比公共方法更“公共”，因为它们经过精心设计，只暴露了具体类型的一小部分表面区域。他们将类型简化为一种能力、一种行为、一组特征等。在实现中，我认为保持这种分离是有用的。

当我查看一个类的代码时，当我遇到显式接口实现时，我的大脑就会进入“代码契约”模式。通常这些实现只是简单地转发给其他方法，但有时它们会进行额外的状态/参数检查，转换传入参数以更好地匹配内部需求，甚至为版本控制目的进行转换（即多代接口都针对通用实现）。

（我意识到公共也是代码契约，但接口要强大得多，尤其是在接口驱动的代码库中，直接使用具体类型通常是内部代码的标志。）

相关：[Jon 以上的原因 2](https://stackoverflow.com/a/3034603/14582)。

**等等**

加上这里其他答案中已经提到的优势：

*   需要时，根据[消歧](https://stackoverflow.com/a/157490/14582)或需要[内部接口](http://www.csharp411.com/c-internal-interface/)
*   不鼓励“为实现编程”（[Jon 的原因 1](https://stackoverflow.com/a/3034603/14582)）

## 问题

这并不全是乐趣和幸福。在某些情况下，我坚持使用隐式：

*   值类型，因为这需要装箱和较低的性能。这不是一个严格的规则，它取决于接口和它的使用方式。可比？隐式的。IFormattable？可能是明确的。
*   具有经常直接调用的方法的琐碎系统接口（如 IDisposable.Dispose）。

此外，当您确实具有具体类型并且想要调用显式接口方法时，进行强制转换可能会很痛苦。我以两种方式之一处理这个问题：

1.  添加公共并将接口方法转发给它们以进行实现。在内部工作时，通常发生在更简单的接口上。
2.  （我的首选方法）添加一个`public IMyInterface I { get { return this; } }`（应该内联）并调用`foo.I.InterfaceMethod()`. 如果有多个接口需要这种能力，把名字扩展到我之外（根据我的经验，我很少有这种需要）。

* * *

## 回答 #8

> 赞同：8
> 
> 时间：2008-09-27T11:12:33.380

如果显式实现，则只能通过接口类型的引用来引用接口成员。作为实现类的类型的引用不会公开这些接口成员。

如果您的实现类不是公共的，除了用于创建类的方法（可以是工厂或[IoC](http://en.wikipedia.org/wiki/Inversion_of_control)容器）和接口方法（当然）之外，那么我认为显式实现没有任何优势接口。

否则，显式实现接口可确保不使用对具体实现类的引用，从而允许您稍后更改该实现。我想，“确保”是“优势”。一个精心设计的实现可以在没有显式实现的情况下实现这一点。

在我看来，缺点是您会发现自己在可以访问非公共成员的实现代码中向/从接口转换类型。

像许多事情一样，优点就是缺点（反之亦然）。显式实现接口将确保您的具体类实现代码不暴露。

* * *

## 回答 #9

> 赞同：6
> 
> 时间：2011-05-26T14:12:52.827

隐式接口实现是您拥有具有相同接口签名的方法。

显式接口实现是您显式声明该方法属于哪个接口的地方。

```
interface I1
{
    void implicitExample();
}

interface I2
{
    void explicitExample();
}

class C : I1, I2
{
    void implicitExample()
    {
        Console.WriteLine("I1.implicitExample()");
    }

    void I2.explicitExample()
    {
        Console.WriteLine("I2.explicitExample()");
    }
} 
```

MSDN：[**隐式和显式接口实现**](http://blogs.msdn.com/b/mhop/archive/2006/12/12/implicit-and-explicit-interface-implementations.aspx)

* * *

## 回答 #10

> 赞同：6
> 
> 时间：2014-05-12T17:33:26.000

每个实现接口的类成员都会导出一个声明，该声明在语义上类似于 VB.NET 接口声明的编写方式，例如

```
Public Overridable Function Foo() As Integer Implements IFoo.Foo 
```

尽管类成员的名称通常与接口成员的名称匹配，并且类成员通常是公共的，但这些都不是必需的。还可以声明：

```
Protected Overridable Function IFoo_Foo() As Integer Implements IFoo.Foo 
```

在这种情况下，类及其派生类将被允许使用名称访问类成员`IFoo_Foo`，但外部世界只能通过转换为来访问该特定成员`IFoo`。这种方法通常适用于接口方法在所有实现上都具有*指定*行为，但仅对某些实现*有用*的行为[例如，只读集合`IList<T>.Add`方法的指定行为是 throw `NotSupportedException`]。不幸的是，在 C# 中实现接口的唯一正确方法是：

```
int IFoo.Foo() { return IFoo_Foo(); }
protected virtual int IFoo_Foo() { ... real code goes here ... } 
```

没那么好看。

* * *

## 回答 #11

> 赞同：4
> 
> 时间：2019-10-16T11:28:36.653

前面的答案解释了为什么在 C# 中显式实现接口可能是*可取*的（主要是出于形式上的原因）。但是，有一种情况是*强制*显式实现的：为了避免接口为非但`public`实现类为时泄露封装`public`。

```
// Given:
internal interface I { void M(); }

// Then explicit implementation correctly observes encapsulation of I:
// Both ((I)CExplicit).M and CExplicit.M are accessible only internally.
public class CExplicit: I { void I.M() { } }

// However, implicit implementation breaks encapsulation of I, because
// ((I)CImplicit).M is only accessible internally, while CImplicit.M is accessible publicly.
public class CImplicit: I { public void M() { } } 
```

上述泄漏是不可避免的，因为根据[C# 规范](https://docs.microsoft.com/en-us/dotnet/csharp/language-reference/language-specification/interfaces#interface-members)，“所有接口成员都隐含地具有公共访问权限”。因此，隐式实现也必须提供`public`访问权限，即使接口本身是 eg `internal`。

C# 中的隐式接口实现非常方便。在实践中，许多程序员*一直/无处不在*地使用它而没有进一步考虑。这充其量会导致杂乱的类型表面，最坏的情况是泄漏封装。其他语言，例如 F#，[甚至不允许它](https://docs.microsoft.com/en-us/dotnet/fsharp/language-reference/interfaces#implementing-interfaces-by-using-class-types)。

* * *

## 回答 #12

> 赞同：2
> 
> 时间：2012-11-03T22:56:38.833

显式接口实现的一个重要用途是在需要实现具有**混合可见性**的接口时。

问题和解决方案在文章*[C# Internal Interface](http://www.csharp411.com/c-internal-interface/)*中有很好的解释。

例如，如果您想保护应用程序层之间的对象泄漏，此技术允许您指定可能导致泄漏的成员的不同可见性。

# ms-access - 如何修改已保存的 Microsoft Access 2007 或 2010 导入规范？

> ID：143420
> 
> 赞同：44
> 
> 时间：2008-09-27T11:03:01.687
> 
> 标签：ms-access

有谁知道如何修改 Microsoft Access 2007 或 2010 中的现有导入规范？在旧版本中，在导入向导期间曾经有一个高级按钮，允许您选择和编辑现有规范。我不再看到此功能，但希望它仍然存在并且刚刚移到其他地方。

* * *

## 回答 #1

> 赞同：45
> 
> 时间：2008-09-29T16:14:19.427

我可以在使用 MS Access 2007 的机器上使用此功能。

*   在功能区上，选择外部数据
*   选择“文本文件”选项
*   这将显示获取外部数据向导
*   指定要导入的文件的位置
*   单击确定。这将显示“导入文本向导”
*   此对话框屏幕的底部是您引用的高级按钮
*   单击此按钮应显示“导入规范”屏幕，并允许您选择和修改现有的导入规范。

对于它的价值，我正在使用 Access 2007 SP1

* * *

## 回答 #2

> 赞同：17
> 
> 时间：2008-09-27T12:07:01.597

我不相信有直接支持的方式。但是，如果您感到绝望，请在导航选项下选择显示系统对象。然后在您的表列表中，系统表将出现。这里有两个表：MSysIMEXspecs 和 MSysIMEXColumns。您将能够编辑导入和导出信息。祝你好运！

* * *

## 回答 #3

> 赞同：7
> 
> 时间：2009-05-13T00:20:37.010

[即使在完整版本中， Tim Lentine 的回答](https://stackoverflow.com/a/149417/14420)似乎也是正确的。我还想提一件事。

如果您在没有进入“高级...”并保存规范的情况下完成导入，但您确实保存了导入以在向导结束时重复使用（新功能 AFAIK），您将无法返回并编辑它规格。它内置在“保存的导入”中。这可能是诺克斯所指的。

但是，您可以做部分工作：

1.  导入一个新文件（或重新导入相同的文件）但是，
2.  这次选择追加，而不是新建
3.  单击确定。
4.  进入“高级”所有列标题和数据类型都将在那里。
5.  现在您可以进行所需的更改并将规范保存在该对话框中。然后取消那个导入（这不是你想要的，对吧？）
6.  然后，您可以将该规范用于任何进一步的导入。这不是一个完整的解决方案，但可以节省一些工作。

* * *

## 回答 #4

> 赞同：7
> 
> 时间：2013-01-21T16:29:43.200

以下是可用于更改和使用 MS Access 2010 导入规范的三个函数。第三个子更改现有导入规范的名称。第二个 sub 允许您更改导入规范中的任何 xml 文本。如果您需要更改列名、数据类型、添加列、更改导入文件位置等，这将非常有用。本质上，您想为现有规范修改任何内容。第一个 Sub 是一个例程，允许您调用现有的导入规范，针对您尝试导入的特定文件对其进行修改，导入该文件，然后删除修改后的规范，保持导入规范“模板”不变且完整。享受。

```
Public Sub MyExcelTransfer(myTempTable As String, myPath As String)
On Error GoTo ERR_Handler:
    Dim mySpec As ImportExportSpecification
    Dim myNewSpec As ImportExportSpecification
    Dim x As Integer

    For x = 0 To CurrentProject.ImportExportSpecifications.Count - 1
    If CurrentProject.ImportExportSpecifications.Item(x).Name = "TemporaryImport" Then
        CurrentProject.ImportExportSpecifications.Item("TemporaryImport").Delete
        x = CurrentProject.ImportExportSpecifications.Count
    End If
    Next x
    Set mySpec = CurrentProject.ImportExportSpecifications.Item(myTempTable)
    CurrentProject.ImportExportSpecifications.Add "TemporaryImport", mySpec.XML
    Set myNewSpec = CurrentProject.ImportExportSpecifications.Item("TemporaryImport")

    myNewSpec.XML = Replace(myNewSpec.XML, "\\MyComputer\ChangeThis", myPath)
    myNewSpec.Execute
    myNewSpec.Delete
    Set mySpec = Nothing
    Set myNewSpec = Nothing
    exit_ErrHandler:
    For x = 0 To CurrentProject.ImportExportSpecifications.Count - 1
    If CurrentProject.ImportExportSpecifications.Item(x).Name = "TemporaryImport" Then
        CurrentProject.ImportExportSpecifications.Item("TemporaryImport").Delete
        x = CurrentProject.ImportExportSpecifications.Count
    End If
    Next x
Exit Sub    
ERR_Handler:
    MsgBox Err.Description
    Resume exit_ErrHandler
End Sub

Public Sub fixImportSpecs(myTable As String, strFind As String, strRepl As String)
    Dim mySpec As ImportExportSpecification    
    Set mySpec = CurrentProject.ImportExportSpecifications.Item(myTable)    
    mySpec.XML = Replace(mySpec.XML, strFind, strRepl)
    Set mySpec = Nothing
End Sub

Public Sub MyExcelChangeName(OldName As String, NewName As String)
    Dim mySpec As ImportExportSpecification
    Dim myNewSpec As ImportExportSpecification
    Set mySpec = CurrentProject.ImportExportSpecifications.Item(OldName)    
    CurrentProject.ImportExportSpecifications.Add NewName, mySpec.XML
    mySpec.Delete
    Set mySpec = Nothing
    Set myNewSpec = Nothing
End Sub 
```

* * *

## 回答 #5

> 赞同：3
> 
> 时间：2013-07-28T22:17:14.770

当我想检查或更改导入/导出规范时，我会查询 MS Access 中定义规范的表。

```
SELECT 
    MSysIMEXSpecs.SpecName,
    MSysIMexColumns.*
FROM 
    MSysIMEXSpecs
    LEFT JOIN MSysIMEXColumns 
    ON MSysIMEXSpecs.SpecID = MSysIMEXColumns.SpecID
WHERE
    SpecName = 'MySpecName'
ORDER BY
    MSysIMEXSpecs.SpecID, MSysIMEXColumns.Start; 
```

您还可以使用 UPDATE 或 INSERT 语句来更改现有列或将新列插入和附加到现有规范。您可以使用此方法创建全新的规范。

* * *

## 回答 #6

> 赞同：2
> 
> 时间：2017-03-06T17:53:39.550

另一个不错的选择是用于 Microsoft Access的免费[V-Tools插件。](http://www.skrol29.com/us/vtools.php)在其他有用的工具中，它有一个表格来编辑和保存导入/导出规范。

[![在此处输入图像描述](https://i.stack.imgur.com/H5h0v.jpg)](https://i.stack.imgur.com/H5h0v.jpg)

[![在此处输入图像描述](https://i.stack.imgur.com/GQ0IK.jpg)](https://i.stack.imgur.com/H5h0v.jpg)

*注意：从 1.83 版开始，在 Windows 10 上枚举代码页时存在一个错误。（显然是由于 Windows 10 中缺少/更改了 API 函数）这些工具仍然很好用，您只需注释掉几行代码或在调试窗口中跳过它。*

在为我们的在线订单编辑复杂的导入规范时，这对我来说是一个真正的救命稻草。

* * *

## 回答 #7

> 赞同：1
> 
> 时间：2014-02-26T17:12:03.880

为什么这么复杂？

只需检查 Access-Options/Current Database/Navigation Options/Show System Objects 中的 System Objects

打开表“MSysIMEXSpecs”并根据您的需要进行更改 - 它易于阅读...

* * *

## 回答 #8

> 赞同：0
> 
> 时间：2014-03-12T15:16:55.913

如果您保存了规格，Tim Lentine 的答案就有效。你的问题没有具体说明，它只是说你已经导入了数据。他的方法不会以这种方式保存您的规格。

保存当前导入规范的方法是重新打开导入，点击“追加”，这将允许您使用 MS Access 拾取的当前导入设置。（*如果您希望在导入 MS ACCESS 之前使用 Excel 格式保留导入规范，这很有用。*）

进入附加选项后，请使用 Tim 的说明，即使用高级选项和“另存为”。从那里，只需单击取消，您现在可以将任何其他类似的数据导入到各种表等。

* * *

## 回答 #9

> 赞同：0
> 
> 时间：2015-01-29T18:04:04.790

我刚刚在 Access 中的整个保存的导入/XML 设置中发现了一个明显的错误。还对保存的导入系统的僵化感到沮丧，我创建了表单并编写了代码来分离存储保存的导入规范的 XML，以至于我可以使用这个工具通过编码从头开始实际创建保存的导入检查源 Excel 工作簿。

我发现，虽然 Access 根据用户对默认设置的修改正确地导入了工作表（例如，它喜欢采用标题名称以“ID”结尾的任何列，并将其作为索引字段在结果表，但您可以在导入过程中取消此操作），虽然它也根据用户更改正确创建 XML，但如果您随后删除表并使用保存的导入重新导入工作表，它会忽略 XML导入规范并恢复使用自己发明的默认值，至少在“ID”列的情况下。

您可以自行尝试：导入一个工作表 Excel，其中至少有一个以“ID”结尾的列标题名称（“OrderID”、“User ID”或只是简单的“ID”）。在此过程中，请务必将这些列的“索引”设置为否。执行导入并在最终对话框窗口中选中“保存导入步骤”。如果您检查生成的表设计，您将看到相关字段上没有索引。然后删除表，找到保存的导入，再次执行。这一次，这些字段将在表设计中设置为索引，即使 XML 仍然显示没有索引。

我一直在努力，直到我发现发生了什么，将我从头开始构建的 XML 与通过 Access 工具创建的示例进行比较。

* * *

## 回答 #10

> 赞同：0
> 
> 时间：2020-11-06T13:36:44.490

我使用了[Mike Hansen 的解决方案](https://stackoverflow.com/a/14443025/7625157)，非常棒。我在某一点修改了他的解决方案，而不是替换我修改 XML 属性的部分字符串。当您可以修改字符串时，也许这太费力了，但无论如何，这是我的解决方案。这可以很容易地进一步修改以更改表格等，这非常好恕我直言。

对我有帮助的是帮助子将 XML 写入文件，这样我就可以检查它的结构和内容：

```
Sub writeStringToFile(strPath As String, strText As String)
    '#### writes a given string into a given filePath, overwriting a document if it already exists
        Dim objStream

        Set objStream = CreateObject("ADODB.Stream")
        objStream.Charset = "utf-8"
        objStream.Open
        objStream.WriteText strText
        objStream.SaveToFile strPath, 2
    End Sub 
```

具有 2 列的表的 /my ImportExportSpecification 的 XML 如下所示：

```
<?xml version="1.0"?>
<ImportExportSpecification Path="mypath\mydocument.xlsx" xmlns="urn:www.microsoft.com/office/access/imexspec">
    <ImportExcel FirstRowHasNames="true" AppendToTable="myTableName" Range="myExcelWorksheetName">
        <Columns PrimaryKey="{Auto}">
            <Column Name="Col1" FieldName="SomeFieldName" Indexed="NO" SkipColumn="false" DataType="Double"/>
            <Column Name="Col2" FieldName="SomeFieldName" Indexed="NO" SkipColumn="false" DataType="Text"/>
        </Columns>
    </ImportExcel>
</ImportExportSpecification> 
```

然后我写了一个函数来修改路径。我在这里省略了错误处理：

```
Function modifyDataSourcePath(strNewPath As String, strXMLSpec As String) As String
'#### Changes the path-name of an import-export specification
    Dim xDoc As MSXML2.DOMDocument60
    Dim childNodes As IXMLDOMNodeList
    Dim nodeImExSpec As MSXML2.IXMLDOMNode
    Dim childNode As MSXML2.IXMLDOMNode
    Dim attributesImExSpec As IXMLDOMNamedNodeMap
    Dim attributeImExSpec As IXMLDOMAttribute

    Set xDoc = New MSXML2.DOMDocument60
    xDoc.async = False: xDoc.validateOnParse = False
    xDoc.LoadXML (strXMLSpec)
    Set childNodes = xDoc.childNodes

    For Each childNode In childNodes
           If childNode.nodeName = "ImportExportSpecification" Then
                Set nodeImExSpec = childNode
                Exit For
            End If
    Next childNode

    Set attributesImExSpec = nodeImExSpec.Attributes

    For Each attributeImExSpec In attributesImExSpec
        If attributeImExSpec.nodeName = "Path" Then
            attributeImExSpec.Value = strNewPath
            Exit For
        End If
    Next attributeImExSpec

    modifyDataSourcePath = xDoc.XML
End Function 
```

在执行 newSpec 之前，我在 Mike 的代码中使用它，而不是替换语句。此外，我将 XML 字符串写入 XML 文件中相对于数据库的位置，但该行是可选的：

```
Set myNewSpec = CurrentProject.ImportExportSpecifications.item("TemporaryImport")
    myNewSpec.XML = modifyDataSourcePath(myPath, myNewSpec.XML)
    Call writeStringToFile(Application.CurrentProject.Path & "\impExpSpec.xml", myNewSpec.XML)
    myNewSpec.Execute 
```

# coding-style - 你见过最没用的评论是什么？

> ID：143429
> 
> 赞同：20
> 
> 时间：2008-09-27T11:11:00.077
> 
> 标签：coding-style, comments

我们都知道，注释我们的代码是编码风格的重要组成部分，它可以让下一个出现的人，甚至是我们自己在 6 个月左右的时间内都能理解我们的代码。

但是，有时评论并不能解决问题。我不是在谈论明显的笑话或发泄的挫败感，我说的是似乎试图解释的评论，但做得很糟糕，他们可能不在那里。**太短**、**太神秘**或完全**错误**的评论。

作为一个警示故事，您能否分享您所看到的确实很**糟糕**的东西，如果不是很明显，请显示它所指的代码并指出它有什么问题？那里**应该**放什么？

也可以看看：

*   [何时不评论您的代码](https://stackoverflow.com/questions/163600/when-not-to-comment-code)
*   [你觉得你的评论怎么样？（最佳实践）](https://stackoverflow.com/questions/121945/how-do-you-like-your-comments-best-practices)
*   [你在源代码中遇到过的最好的注释是什么？](https://stackoverflow.com/questions/184618/what-is-the-best-comment-in-source-code-you-have-ever-encountered)

* * *

## 回答 #1

> 赞同：112
> 
> 时间：2008-09-27T11:15:52.360

只是典型的 Comp Sci 101 类型注释：

```
$i = 0; //set i to 0

$i++; //use sneaky trick to add 1 to i!

if ($i==$j) { // I made sure to use == rather than = here to avoid a bug 
```

之类的东西。

* * *

## 回答 #2

> 赞同：75
> 
> 时间：2008-09-27T12:53:40.893

未填充的 javadoc 样板注释特别无用。他们消耗了大量的屏幕空间，却没有提供任何有用的东西。最糟糕的是，在出现这样一条评论的地方，肯定有数百条评论在后面。

```
/**
 * Method declaration
 *
 *
 * @param table
 * @param row
 *
 * @throws SQLException
 */
void addTransactionDelete(Table table, Object row[]) throws SQLException { 
```

* * *

## 回答 #3

> 赞同：53
> 
> 时间：2008-09-27T11:22:04.717

我发现自己以前写过这个小宝石：

```
//@TODO: Rewrite this, it sucks. Seriously. 
```

通常这是一个好兆头，表明我已经完成了当晚的编码会话。

* * *

## 回答 #4

> 赞同：51
> 
> 时间：2008-09-29T13:20:30.983

```
// remember to comment code 
```

什么？:D

* * *

## 回答 #5

> 赞同：42
> 
> 时间：2008-10-03T20:58:52.000

像这样的东西：

```
// This method takes two integer values and adds them together via the built-in
// .NET functionality. It would be possible to code the arithmetic function
// by hand, but since .NET provides it, that would be a waste of time
private int Add(int i, int j) // i is the first value, j is the second value
{
    // add the numbers together using the .NET "+" operator
    int z = i + j;

    // return the value to the calling function
    // return z;

    // this code was updated to simplify the return statement, eliminating the need
    // for a separate variable.
    // this statement performs the add functionality using the + operator on the two
    // parameter values, and then returns the result to the calling function
    return i + j;
} 
```

等等。

* * *

## 回答 #6

> 赞同：41
> 
> 时间：2008-09-27T11:39:59.773

每条只是重复代码所说的注释都是无用的。评论不应该告诉我代码的作用。如果我对编程语言不够了解，仅仅通过阅读代码来理解发生了什么，我根本不应该阅读该代码。评论喜欢

```
// Increase i by one
i++; 
```

完全没用。我看到 i 增加了 1，这就是代码所说的，我不需要对此发表评论！注释应该用来解释**为什么要**做某事（如果它远非显​​而易见）或**为什么**以这种方式而不是任何其他方式来做某事（这样我就可以理解另一个程序员做出的某些设计决策，这些决策在一次）。进一步的注释对于解释棘手的代码很有用，其中绝对不可能通过快速查看代码来确定发生了什么（例如，有一些棘手的算法来计算数字中设置的位数；如果你不知道这段代码做了什么，你就没有机会猜测那里发生了什么）。

* * *

## 回答 #7

> 赞同：38
> 
> 时间：2008-09-27T12:32:28.727

```
Thread.Sleep(1000); // this will fix .NET's crappy threading implementation 
```

* * *

## 回答 #8

> 赞同：37
> 
> 时间：2008-09-27T11:32:28.373

我曾经用一个奇怪的 C 编译器参与过一个项目。除非在两个语句之间插入注释，否则它会在有效代码段上出错。所以我把评论改成：

```
// Do not remove this comment else compilation will fail. 
```

而且效果很好。

* * *

## 回答 #9

> 赞同：29
> 
> 时间：2008-09-27T23:48:19.617

我不相信。我是在得到 22 个答案后才提出这个问题的，但没有人指出最不实用的评论类型：

错误的评论。

人们写多余的注释妨碍了代码的理解，这已经够糟糕了，但是当有人写了详细的注释来解释某事是如何工作的时，它要么一开始就错了，要么在没有更改注释的情况下更改了代码之后就错了（更有可能的情况），这绝对是最糟糕的评论。

* * *

## 回答 #10

> 赞同：25
> 
> 时间：2008-09-27T19:21:54.267

GhostDoc 自己提出了一些非常有趣的方法。

```
/// <summary>
/// Toes the foo.
/// </summary>
/// <returns></returns>
public Foo ToFoo() 
```

* * *

## 回答 #11

> 赞同：22
> 
> 时间：2008-10-03T20:42:45.620

```
// secret sauce 
```

* * *

## 回答 #12

> 赞同：21
> 
> 时间：2008-09-27T11:41:59.083

```
// Don't know why we have to do this 
```

* * *

## 回答 #13

> 赞同：20
> 
> 时间：2008-10-03T22:13:18.293

```
try
{
...some code...
}
catch
{
// Just don't crash, it wasn't that important anyway.
} 
```

*叹

* * *

## 回答 #14

> 赞同：18
> 
> 时间：2008-09-27T23:22:57.087

曾经遇到过一个文件。数千行代码，其中大部分非常可怕。命名错误的变量、棘手的循环条件以及隐藏在文件中间的一条注释。

```
 /* Hmmm. A bit tricky. */ 
```

* * *

## 回答 #15

> 赞同：16
> 
> 时间：2008-10-03T21:48:24.410

```
//' OOOO oooo that smell!! Can't you smell that smell!??!??!!!!11!??/!!!!!1!!!!!!1

If Not Me.CurrentMenuItem.Parent Is Nothing Then
    For Each childMenuItem As MenuItem In aMenuItem.Children
        do something
    Next

    If Not Me.CurrentMenuItem.Parent.Parent Is Nothing Then
        //'item is at least a grand child
        For Each childMenuItem As MenuItem In aMenuItem.Children
            For Each grandchildMenuItem As MenuItem In childMenuItem.Children
                do something
            Next
        Next

        If Not Me.CurrentMenuItem.Parent.Parent.Parent Is Nothing Then
            //'item is at least a grand grand child
            For Each childMenuItem As MenuItem In aMenuItem.Children
                For Each grandchildMenuItem As MenuItem In childMenuItem.Children
                    For Each grandgrandchildMenuItem As MenuItem In grandchildMenuItem.Children
                        do something
                    Next
                Next
            Next

        End If
    End If
End If 
```

* * *

## 回答 #16

> 赞同：15
> 
> 时间：2008-09-27T13:25:10.677

IDE 插入的默认注释。

我参与的最后一个使用 WebSphere Application Developer 的项目有很多维护开发人员和承包商，他们似乎并没有被数百甚至数千个包含以下内容的 Java 类所困扰：

```
/**
 * @author SomeUserWhoShouldKnowBetter
 *
 * To change this generated comment edit the template variable "typecomment":
 * Window>Preferences>Java>Templates.
 * To enable and disable the creation of type comments go to
 * Window>Preferences>Java>Code Generation.
 */ 
```

在认为您实际上找到了一个注释良好的源文件和意识到，是的，它是另一个默认注释，它迫使您使用`SWEAR_WORD_OF_CHOICE`.

* * *

## 回答 #17

> 赞同：15
> 
> 时间：2009-04-22T13:29:47.647

我昨天在 C# 应用程序中看到了这条评论：

```
//TODO: Remove this comment. 
```

* * *

## 回答 #18

> 赞同：13
> 
> 时间：2008-09-27T19:35:22.657

我最喜欢的所有时间评论。

```
/* our second do loop */
do { 
```

不管是谁写的——你知道你是谁。

* * *

## 回答 #19

> 赞同：11
> 
> 时间：2008-10-03T20:56:47.497

多年前 C 语言中的一个非常大的数据库引擎项目 - 数千行代码，变量名称短且拼写错误，没有注释......直到嵌套 if 条件深入到模块中数千行出现以下注释：

```
//if you get here then you really f**ked 
```

到那时，我想我们已经知道了！

* * *

## 回答 #20

> 赞同：10
> 
> 时间：2008-09-27T12:47:34.760

在一个巨大的 VB5 应用程序中

```
dim J
J = 0 'magic
J = J 'more magic
for J=1 to 100
...do stuff... 
```

引用显然是[THIS](http://catb.org/esr/jargon/html/magic-story.html) ... 是的，没有这两行的应用程序在运行时失败并出现未知错误代码。我们仍然不知道为什么。

* * *

## 回答 #21

> 赞同：10
> 
> 时间：2008-10-03T20:49:56.743

摘自我的[一篇博](http://geekswithblogs.net/sdorman/archive/2007/09/28/Priceless.aspx)文：

> 在清理我管理的一个项目的一些源代码的过程中，我遇到了以下评论：

```
/*
   MAB 08-05-2004: Who wrote this routine? When did they do it? Who should 
   I call if I have questions about it? It's worth it to have a good header
   here. It should helps to set context, it should identify the author 
   (hero or culprit!), including contact information, so that anyone who has
   questions can call or email. It's useful to have the date noted, and a 
   brief statement of intention. On the other hand, this isn't meant to be 
   busy work; it's meant to make maintenance easier--so don't go overboard.

   One other good reason to put your name on it: take credit! This is your
   craft
*/ 
```

然后再往下一点：

```
#include "xxxMsg.h" // xxx messages
/*
   MAB 08-05-2004: With respect to the comment above, I gathered that
   from the filename. I think I need either more or less here. For one
   thing, xxxMsg.h is automatically generated from the .mc file. That might
   be interesting information. Another thing is that xxxMsg.h should NOT be
   added to source control, because it's auto-generated. Alternatively, 
   don't bother with a comment at all.
*/ 
```

然后又一次：

```
/*
   MAB 08-05-2004: Defining a keyword?? This seems problemmatic [sic],
   in principle if not in practice. Is this a common idiom? 
*/ 
```

* * *

## 回答 #22

> 赞同：10
> 
> 时间：2009-10-09T14:23:08.887

AHHHRRRGGHHH 刚刚在一些古老的代码中发现了这个，打赌这家伙认为他很有趣

```
private
  //PRIVATE means PRIVATE so no comments for you
  function LoadIt(IntID: Integer): Integer; 
```

* * *

## 回答 #23

> 赞同：9
> 
> 时间：2008-09-28T08:28:25.170

最糟糕的评论是对代码功能的错误解释。这比根本没有评论更糟糕。

我在代码中看到过这种带有太多注释的事情（不应该存在，因为代码本身就足够清晰），并且它主要发生在代码更新（重构、修改等）时但评论并没有随之更新。

一个好的经验法则是：只写注释来解释代码**为什么**做某事，而不是它做了**什么**。

* * *

## 回答 #24

> 赞同：8
> 
> 时间：2008-10-03T21:23:17.240

肯定必须是代替错误处理的注释。

```
if(some_condition){
    do_stuff();
}
else{
    //An error occurred!
} 
```

* * *

## 回答 #25

> 赞同：8
> 
> 时间：2009-10-09T20:06:53.373

我刚刚找到了这个，写在注释掉的代码行之前的行上：

```
//This causes a crash for some reason. I know the real reason but it doesn't fit on this line. 
```

* * *

## 回答 #26

> 赞同：7
> 
> 时间：2008-09-27T19:07:07.173

从 vb6 移植到 vb.net 的 100k LOC 应用程序。看起来好像以前的开发人员在一个方法上放置了一个注释标题，然后将确切的注释复制并粘贴到他从那时起编写的每个方法上。数百种方法，每一种都被错误地注释了……

当我第一次看到它时，我笑了…… 6 个月后，这个笑话变得越来越淡了。

* * *

## 回答 #27

> 赞同：7
> 
> 时间：2008-10-06T20:15:51.210

这是来自数据库触发器的绝对真实示例：

```
/******************************************************************************
   NAME:       (repeat the trigger name)
   PURPOSE:    To perform work as each row is inserted or updated.
   REVISIONS:
   Ver        Date        Author           Description
   ---------  ----------  ---------------  ------------------------------------
   1.0        27.6.2000             1\. Created this trigger.
   PARAMETERS:
   INPUT:
   OUTPUT:
   RETURNED VALUE:
   CALLED BY:
   CALLS:
   EXAMPLE USE:
   ASSUMPTIONS:
   LIMITATIONS:
   ALGORITHM:
   NOTES:
******************************************************************************/ 
```

* * *

## 回答 #28

> 赞同：6
> 
> 时间：2008-10-06T20:22:34.583

```
/** function header comments required to pass checkstyle */ 
```

* * *

## 回答 #29

> 赞同：5
> 
> 时间：2008-10-29T15:14:21.740

我见过的最无用的两条评论...

```
try
{
  ...
}
catch
{
  // TODO: something catchy
} 
```

我也在 Daily WTF 上发布了这个，所以我会把它修剪成评论......

```
 // TODO: The following if block should be reduced to one return statememt:
  // return Regex.IsMatch(strTest, NAME_CHARS);
  if (!Regex.IsMatch(strTest, NAME_CHARS))
    return false;
  else
    return true; 
```

* * *

## 回答 #30

> 赞同：5
> 
> 时间：2008-11-24T21:29:16.707

我从来没有发现非常有用的一个：

```
<!--- Lasciate ogne speranza, voi ch'intrate ---> 
```

* * *

## 回答 #31

> 赞同：4
> 
> 时间：2008-09-27T12:58:33.500

> 只是典型的 Comp Sci 101 类型注释：

如果我的学生在作业中这样做，我会以随机的极端暴力行为威胁他们。他们*仍然*做到了。然而，他们似乎完全失去了正确缩进的意义。我想这说明了为什么 Python 会成为初学者的理想语言。

* * *

## 回答 #32

> 赞同：4
> 
> 时间：2008-09-27T13:41:39.700

由自动 javadoc 工具（例如[JAutoDoc](http://jautodoc.sourceforge.net/)）生成的注释。我让一个团队成员提交了大量的代码，评论如下：

```
/**
 * Gets the something
 *
 * @param num The num
 * @param offset The offset
 */
public void getSomething(int num, bool offset) 
```

也许它作为一个起点是有帮助的，但根据定义，如果程序正在解析变量和方法名称以使其注释它不会有太大用处。

* * *

## 回答 #33

> 赞同：4
> 
> 时间：2008-09-27T23:27:21.010

每当我用 C++ 或 Java 教授 OOP 时，我通常会得到以下信息：

```
// My class!
Class myclass 
{
    //Default constructor
    public myClass()
    {
       ...
    }
} 
```

我的政策是向学生宣布，他们将因文件不足和多余而被扣分

* * *

## 回答 #34

> 赞同：4
> 
> 时间：2008-09-28T08:08:43.940

我有很多这样的：

```
# For each pose in the document
doc.elements.each('//pose') do |pose| ...

# For each sprite in sprites
@sprites.each do |sprite| ...

# For each X in Y
for X in Y do ... 
```

不过，我正试图减少这一点。:(

* * *

## 回答 #35

> 赞同：4
> 
> 时间：2008-10-29T17:48:00.823

```
#include <stdio.h>
//why isn't this working! 
```

使用仅支持`/*-style */`全局注释的 c 编译器。

* * *

## 回答 #36

> 赞同：4
> 
> 时间：2009-04-22T13:55:05.450

我们维护着糟糕的 PHP 应用程序，原始开发人员习惯于将“调试代码”注释掉。正如他常说的那样，这是因为“如果他再次需要它们，他只需取消注释它们，瞧，这样可以为他节省很多工作”。

所以所有的脚本实际上都充满了这样的行：

```
//echo "asdfada";
//echo $query."afadfadf"; 
```

它们中没有一个实际上以任何方式起作用。他们主要是为了确认代码执行达到那个点。

在相关说明中，他从未删除过任何过时的脚本或数据库表。因此，我们的目录中充满了诸如 dosomething.php、dsomething1.php、dsomething1.bak、dsomething1.bak.php 等文件……每个人都害怕删除任何内容，因为没有人知道真正使用了什么。

* * *

## 回答 #37

> 赞同：3
> 
> 时间：2008-09-27T23:33:17.220

我的研究涉及 API 可用性，我遇到了很多不好的评论，因为它们具有误导性、错位、不正确或不完整。

例如，在 Java 消息传递服务（JMS 或 J2EE 中）中，QueueReceiver.receive 类包含以下 gem：“此调用阻塞，直到消息到达、超时到期或此消息使用者关闭。零超时永不过期并且通话会无限期地阻塞。”

听起来不错？对？

问题是，正如我的实验室研究表明的那样，用户认为评论涵盖了所有内容。面对收不到信息的情况，他们拒绝到别处寻找解释。

在这种情况下，当您从 QueueConnectionFactory 创建 QueueConnection 时，它会告诉您在调用 start 之前不会传递消息。但这并没有出现在接收方法中。

我相信如果没有这条线，更多的人会在别处搜索它。

顺便说一句，我的研究一般涉及 JavaDoc 的可用性，以及人们是否真的在 JavaDocs 中找到了重要的指令。如果有人想看看，相关的就[在这里](http://www.cs.cmu.edu/~udekel/papers/udekel_pushing_unpublished.pdf)。

* * *

## 回答 #38

> 赞同：3
> 
> 时间：2008-10-03T21:13:14.543

我有这样做的一个非常坏的习惯，尤其是当我在滚动时：

```
// TODO: Documentation. 
```

* * *

## 回答 #39

> 赞同：3
> 
> 时间：2008-10-03T21:17:20.200

一个非常大的源文件，在单个进程中实现多线程。在所有调用堆栈切换和信号量抓取以及线程暂停和恢复中，有一个关于指针操作的特别模糊位的简单注释：

```
/* Trickiness */ 
```

恩，谢谢分享。

* * *

## 回答 #40

> 赞同：3
> 
> 时间：2008-10-06T20:25:13.937

无关的评论中断。通常，如果存在逻辑上的流分离，则一行注释如下：

```
/***************************************************************************/ 
```

在该部分代码的上方和下方可能会有所帮助。当您需要稍后返回并将一个大函数（开始时很小）拆分为几个较小的函数以保持代码易于阅读时，它也很不错。

一位不愿透露姓名的前程序员决定添加以下两行：

```
//-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=
//-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-= 
```

在*每一行代码*之后。

* * *

## 回答 #41

> 赞同：3
> 
> 时间：2008-10-06T20:26:01.033

一旦我在某些代码中看到以下注释：

```
//I know that this is very ugly, but I am tired and in a hurry. 
//You would do the same if you were me...
//...
//[A piece of nasty code here] 
```

* * *

## 回答 #42

> 赞同：3
> 
> 时间：2008-10-21T21:04:33.497

这是我最喜欢的两个：

```
 // do nothing 
```

这并没有真正的帮助，因为它只是占用空间。

然后在更远的地方：

```
 // TODO: DAN to fix this.  Not Wes.  No sir.  Not Wes. 
```

我想如果我不是丹或韦斯，我应该忽略这个，对吧？

* * *

## 回答 #43

> 赞同：3
> 
> 时间：2008-10-29T16:21:13.540

```
cntrVal = ""+ toInteger(cntrVal)      //<---MAYBE THIS IS THE WAY I'M GOING THROUGH CHANGES (comin' up comin' up) THIS IS THE WAY I WANNA LIVE 
```

顺便说一句，那是E型歌曲的歌词...

* * *

## 回答 #44

> 赞同：3
> 
> 时间：2009-04-22T13:49:13.640

过度冗余并不能说明发生了什么。这个来自手机固件

```
/*========================================================================

FUNCTION 
    DtFld_SetMin

DESCRIPTION
    This local function sets a nMin member of the Dtfld struct.

DEPENDENCIES
    None

ARGUMENTS
    [in]me
        Pointer to the Dtfld struct.
    [in]val
        Value to set

RETURN VALUE
    None.

SIDE EFFECTS
    None

NOTE
    None
========================================================================*/
/**
 @brief This local function sets a nMin member of the Dtfld struct..
 @param [in] me  Pointer to the Dtfld struct.
 @param [in]val Value to set
 @retval None 
 @note None
 @see None
*/

static __inline void DtFld_SetMin(DtFld *me, int val)
{
  me->nMin = val;
} 
```

* * *

## 回答 #45

> 赞同：3
> 
> 时间：2010-09-17T05:49:19.040

```
// initialise the static variable to 0
count = 1; 
```

* * *

## 回答 #46

> 赞同：2
> 
> 时间：2008-09-27T11:57:58.000

不完全是评论，而是来自描述我曾经不得不使用的系统 API 的 JavaDoc。

```
setAttribute(attributeName, attributeValue)
*设置一个属性*

```

它没有记录什么是属性（它们不是 HTML/XML/etc 属性），存在哪些属性或它们可以具有哪些值。

* * *

## 回答 #47

> 赞同：2
> 
> 时间：2008-09-27T20:14:50.613

```
/* FIXME: documentation for the bellow functionality - and why are we doing it this way */ 
```

对于会计应用程序来说，这是一个庞大的统计程序。我们从来没有弄清楚她为什么这样做——错误的——方式。但我们不得不重写它，并为客户支付了罚款。

* * *

## 回答 #48

> 赞同：2
> 
> 时间：2008-10-06T20:17:16.107

```
// Magic
menu.Visible = False
menu.Visible = True 
```

这是来自我曾经处理过的一些 PowerBuilder 代码中的 UI 框架。框架动态创建菜单项（从数据库数据）。但是，当 PowerBuilder 从 16 位升级到 32 位时，菜单代码停止工作。首席开发人员以某种方式确定隐藏菜单然后显示它会导致它正确显示。

* * *

## 回答 #49

> 赞同：2
> 
> 时间：2008-10-29T14:48:53.087

曾几何时，我看到：

```
#region This is ugly but a mas has to do what a man has to do
Initialization of a gigantic array (...)
#endregion 
// Aren't you glad this has ended? 
```

我很高兴我不是那个开发者。

* * *

## 回答 #50

> 赞同：2
> 
> 时间：2009-04-22T13:12:47.987

我很惊讶以前没有人发布过这样的帖子。

```
 #contentWrapper{
  position:absolute;
  top: 150px; /*80 = 30 + 50 where 50 is margin and 30 is the height of the header*/
 } 
```

完全错误的评论是最糟糕的评论。

* * *

## 回答 #51

> 赞同：2
> 
> 时间：2009-04-22T13:31:03.637

// 祝你好运

* * *

## 回答 #52

> 赞同：2
> 
> 时间：2009-04-22T14:02:19.270

```
/// <summary>
/// Disables the web part. (Virtual method)
/// </summary>
public virtual void EnableWebPart() { /* nothing - you have to override it */ } 
```

* * *

## 回答 #53

> 赞同：2
> 
> 时间：2009-04-22T14:29:56.380

我使用两种语言（英语和法语）工作，但我最喜欢的评论是法语：

```
/* La passe du coyote qui tousse */ 
```

翻译它会给出这样的东西：

```
/* The coughing coyote trick */ 
```

它通常代表一段代码，或者对作者来说似乎是一个聪明的想法并且完全晦涩难懂，或者它是一个奇怪的错误修复，甚至作者都不明白它为什么起作用（想想通过移动 if 语句来修复竞争条件）。在所有情况下，都是写得不好的代码吓坏了任何不得不重构它的人，因为很难预测改变它的效果。

* * *

## 回答 #54

> 赞同：2
> 
> 时间：2009-10-12T20:39:10.413

```
add ax,1 ;add 1 to the accumulator 
```

严重地？那条评论浪费了我生命中的 5 秒。

还有过时的评论 FTL

```
//the system can only handle 5 people right now. make sure where not over
if(num_people>20){ 
```

* * *

## 回答 #55

> 赞同：2
> 
> 时间：2009-11-20T01:50:54.430

我遇到过的最有趣的事情之一。

```
// HACK HACK HACK. REMOVE THIS ONCE MARLETT IS AROUND 
```

一个让我想知道的。

```
// this is a comment - don't delete 
```

* * *

## 回答 #56

> 赞同：2
> 
> 时间：2010-02-04T20:50:50.127

```
// yes, this is going to break in 2089, but, one, I'll be dead, and two, we really ought to be using
// a different system by then
if (yearPart >= 89)
{
    // naughty bits removed....
} 
```

（评论没有用，但都是真实的陈述。）

* * *

## 回答 #57

> 赞同：2
> 
> 时间：2010-10-01T21:52:36.960

我刚刚在一个软件的 INI 文件中看到了这一点（不久前转储给我的几个软件之一）我正在维护：

```
;--- if LOGERR=1, errors are logged but debugging is difficult
;--- if LOGERR=0, errors are not logged but debugging is easy
LOGERR=1 
```

嗯，调试确实很难，但我不敢改变设置。

* * *

## 回答 #58

> 赞同：1
> 
> 时间：2008-09-27T12:13:23.733

我已删除名称以避免尴尬，但这是在某些生产代码中发现的注释。不幸的是，由于这是 ASP 代码，指的是一个 VB6 模块，并且客户非常好奇，当我在咨询访问期间在现场时，是她向我指出了评论。幸运的是，她对此有幽默感。

> '我不知道这个@"%& 的帮助是如何工作的。它是由那个承包商创建的一大堆 &£$! ---------。
> 我将把它留在原处，希望没有人永远需要它改变。

不幸的是，大约一年后代码确实需要更改，此时我们发现我们没有源代码，不得不将其丢弃并免费重写。

* * *

## 回答 #59

> 赞同：1
> 
> 时间：2008-09-29T13:18:45.167

我不得不说，我遇到的最没用的评论类型是第二语言评论。

我宁愿看到用某人的母语清楚地写下的评论，也不愿看到用非常差的近似英语潦草写的评论。至少那时该语言的母语人士可以翻译它。ESL 评论通常对地球上的每个人来说都是不可读的，除了写它们的人，有时甚至不是他们自己。

* * *

## 回答 #60

> 赞同：1
> 
> 时间：2008-10-06T17:40:22.850

取自遗留代码，这是对以下`if`条件目的的唯一描述（条件跨越 120 列的 4 行）：

```
#-- Whoa, now that's a big if condition. 
```

* * *

## 回答 #61

> 赞同：1
> 
> 时间：2008-10-21T20:52:10.807

从记忆中引用此内容，因此可能不准确。

> 我不知道这他妈的是做什么的，但它似乎有效，所以我没有碰它。

有趣的是我发现它的方式。此评论嵌入在我们公司的某个开发人员为客户编写的访问应用程序中，并在 MDB 中分发。不幸的是，“似乎工作”的代码被轰炸了，Access 尽职尽责地打开了代码窗口，调试器突出显示了注释正下方的行。它并没有完全激发该客户的信心。

* * *

## 回答 #62

> 赞同：1
> 
> 时间：2008-10-29T16:33:43.297

某人的名字或首字母缩写，仅此而已。有时这些签名定义了一个代码块......

```
//SFD Start
...code...
//SFD End 
```

就像代码是这样的艺术品，他们必须签名！另外，如果其他人需要更改以这种方式标记的代码怎么办？

这不应该与源代码控制系统中的“责备”或“注释”功能相混淆——它们太棒了！

* * *

## 回答 #63

> 赞同：1
> 
> 时间：2009-02-06T20:05:47.473

今天跑了一圈。我应该预料到它是 Excel 工作簿中 VBA 宏的一部分。

```
a.writeline s 'write line 
```

我发现写这篇文章的人花时间写了一个评论，使用空格来清理令人难以置信的混乱的“writeline”命令，但没有发现使用有意义的变量名的必要性，我发现它特别迷人。最好我能说 a 是“a file”的缩写，s 是“a String”的缩写（因为“a”已经被占用了）。

* * *

## 回答 #64

> 赞同：1
> 
> 时间：2009-02-06T20:09:06.673

随机，在代码中间：

```
//??? 
```

* * *

## 回答 #65

> 赞同：1
> 
> 时间：2009-03-20T21:40:46.933

```
if (someFlag)
{
    // YES
    DoSomething();
}
else
{
    // NO
    DoSomethingElse();
} 
```

有一个人经常这样做，团队的其他成员最终说服他停止这样做！

* * *

## 回答 #66

> 赞同：1
> 
> 时间：2009-04-22T13:56:31.563

这：

是的，一个空格，作为颠覆性的更改日志留下。

* * *

## 回答 #67

> 赞同：1
> 
> 时间：2009-05-18T04:18:34.440

我在地图产品的示例应用程序中发现了这一点：

```
// Return value does not matter
return 0; 
```

* * *

## 回答 #68

> 赞同：1
> 
> 时间：2009-05-26T23:44:27.837

我在一个扭曲的程序中发现了这个

```
# Let them send messages to the world
#del self.irc_PRIVMSG  # By deleting the method? Hello? 
```

* * *

## 回答 #69

> 赞同：1
> 
> 时间：2009-08-17T14:31:10.063

```
/**
 * Implements the PaymentType interface.
 */
public class PaymentTypePo implements PaymentType 
```

* * *

## 回答 #70

> 赞同：1
> 
> 时间：2009-10-09T20:30:32.280

我曾经与一位非常有才华的汇编语言程序员一起工作，他用许多宏扩展了基本的 ARM 指令集。他的代码由*数万*条指令组成，看起来像下面这样——我（一个称职的 ARM 程序员）无法阅读的宏指令由 ??? 以及偶尔的常规 ARM 指令，例如 ADD：

```
...
？？？R0,R0,#1
？？？R0,R1
添加 R0,R0,#6 ; 添加 6
？？？R1,R0
？？？R0,R0,R1
...

```

我只能假设，当你的大脑有一颗行星那么大时，应付那些过于简单的讨厌指令就太高调了。

* * *

## 回答 #71

> 赞同：1
> 
> 时间：2009-10-12T20:32:28.337

今天在一堆声明的中间找到了这个：

```
// other variables 
```

啧啧，真的吗？谢谢。

* * *

## 回答 #72

> 赞同：1
> 
> 时间：2009-10-12T22:16:10.193

我曾经在一个 VB.NET 应用程序中遇到过这个小美女

```
Dim huh as String 'Best name for a variable ever. 
```

* * *

## 回答 #73

> 赞同：1
> 
> 时间：2009-11-11T21:22:18.107

**// 返回**

**返回;**

* * *

## 回答 #74

> 赞同：1
> 
> 时间：2009-11-19T03:43:49.813

今天才发现这个。。。

```
// TODO: this is basically a copy of the code at line 743!!! 
```

* * *

## 回答 #75

> 赞同：1
> 
> 时间：2009-11-20T02:11:57.323

这是我在我小组大学期末项目的文件中写的评论

```
/* http://youtube.com/watch?v=oHg5SJYRHA0 */ 
```

* * *

## 回答 #76

> 赞同：1
> 
> 时间：2009-11-20T02:14:37.347

我们在工作中经常拿来开玩笑的经典（有错别字）：

```
// Its stupid but it work 
```

这在旧代码库中多次被发现。

* * *

## 回答 #77

> 赞同：1
> 
> 时间：2009-12-11T16:40:41.733

我必须修复 2000 行代码中的一个错误，该代码将音频从 GSM 转码为 mu-law（主要使用位移和转换值数组）。文件中唯一的注释位于其中定义的唯一方法的顶部。它是：

```
/* Do the business */ 
```

* * *

## 回答 #78

> 赞同：1
> 
> 时间：2010-01-05T04:08:10.147

`// Undocumented`

* * *

## 回答 #79

> 赞同：1
> 
> 时间：2010-01-05T04:15:33.687

我曾经维护我们为 Harris 小型机定制的操作系统代码（是的，这是很久以前的事了）。有一天，通过调度程序代码（汇编程序），我遇到了一个代码块，顶部有注释“Begin Magic”，大约 25 行后有注释“End Magic”。中间的代码是我见过的最紧凑、最复杂、最优雅的代码。我们花了 4 个人来弄清楚那一小段代码实际上在做什么（VM 切换）。

* * *

## 回答 #80

> 赞同：1
> 
> 时间：2010-09-21T12:52:41.593

我正在对一个超过 1000 行但没有任何注释的 java 类进行一些更改。我是他们编码风格的新手，所以我忍不住要添加类似的评论

```
/*Added because someone asked me to add it*/ 
```

* * *

## 回答 #81

> 赞同：1
> 
> 时间：2010-09-28T10:47:35.713

```
if (returnValue ==0)
  doStuff();
else
  System.out.println("Beware of you, the Dragons are coming!"); 
```

* * *

## 回答 #82

> 赞同：0
> 
> 时间：2008-10-21T19:50:54.797

```
/* this is a hack.
 ToDo: change this code */ 
```

* * *

## 回答 #83

> 赞同：0
> 
> 时间：2008-10-21T21:07:47.233

```
//I am not sure why this works but it fixes the problem. 
```

这个是我无用评论的榜首。

* * *

## 回答 #84

> 赞同：0
> 
> 时间：2008-10-21T21:33:46.433

```
// this is messed up, and no one actually knows how it works anymore... 
```

* * *

## 回答 #85

> 赞同：0
> 
> 时间：2008-10-29T15:25:11.360

有人发给我一个 ac 文件，其中描述了他的程序创建的二进制文件。

除了写真实数据的某处外，它不包含任何评论

```
SwapArray(..); // Big endian ???
write(); 
```

我询问了 SwapArray 的实现，他告诉我我不需要它，只是为了确保它可以在 linux 机器上运行。

经过实验，我发现他到处都使用小端（这和正常情况一样），但只有真正的数据是用大端写入的。通常你可以在十六进制编辑器中看到它，但数据是以浮点存储的，所以不容易注意到混合端。

* * *

## 回答 #86

> 赞同：0
> 
> 时间：2008-10-29T16:36:06.070

流行音乐之巅肯定是

```
//  This code should never be called 
```

* * *

## 回答 #87

> 赞同：0
> 
> 时间：2008-10-29T17:11:08.777

当我在一个遗留通信应用程序上工作时，我最喜欢。

```
// Magic happens here... 
```

* * *

## 回答 #88

> 赞同：0
> 
> 时间：2009-03-20T21:28:48.007

今天遇到这个：

```
/// <summary>
/// The Page_Load runs when the page loads
/// </summary>
private void Page_Load(Object sender, EventArgs e) {} 
```

* * *

## 回答 #89

> 赞同：0
> 
> 时间：2009-04-22T13:36:21.347

另一个我记得的：

```
//TODO: This needs to be reworked.  THIS CRAP NEEDS TO STOP!!! 
```

* * *

## 回答 #90

> 赞同：0
> 
> 时间：2009-04-22T14:33:32.690

```
{
    Long complicated code logic  //Added this
} 
```

* * *

## 回答 #91

> 赞同：0
> 
> 时间：2009-10-12T20:56:50.363

{Some Code;} // 我不记得我为什么要这样做，但它确实有效......

* * *

## 回答 #92

> 赞同：0
> 
> 时间：2009-10-12T22:10:51.210

其实我有几个

```
// 18042009: (Name here) made me do this 
```

对这些评论不是很自豪，但我保留它们是为了提醒我为什么我对特定部分进行 WTF 编码，在这方面非常有用。

* * *

## 回答 #93

> 赞同：0
> 
> 时间：2009-11-02T17:27:58.373

我最近在我很久以前写的一些代码中发现了这一点：

```
// it's a kind of magic (number)
$descr_id = 2;
$url_id = 34; 
```

* * *

## 回答 #94

> 赞同：0
> 
> 时间：2009-11-20T01:24:55.873

这条评论实际上是用不同的语言写的，但我会尝试在翻译中传达这种效果：

```
//we trick it, if forbidden, as if it had already existed 
```

评论试图描述的是它处理已关闭的列表项的方式 - 代码将该项标记为重复项，因此应跳过。是的，这是一种非常低调的做事方式，但与荒谬的评论相比，它显得苍白无力。

* * *

## 回答 #95

> 赞同：0
> 
> 时间：2009-11-20T01:37:38.827

```
[some code]
// [a commented out code line]
// this line added 2004-10-24 by JD.
// removed again 2004-11-05 by JD.
// [another commented out code line]
[some more code] 
```

a) 为什么？b) 哪条线？

* * *

## 回答 #96

> 赞同：0
> 
> 时间：2009-11-20T02:26:35.233

我在游戏的 AI 部分看到了一段很棒的代码：

```
..."AI code"...
if(something)
   goto MyAwesomeLabel;   //Who's gonna be the first to dump crap on me for this?
..."More Ai code"...

MyAwesomeLabel:
   //It wasn't that hard to get here, right?
   ..."Even more AI code"... 
```

* * *

## 回答 #97

> 赞同：0
> 
> 时间：2010-03-05T22:03:09.857

> //URGENT TODO：重新实现这个狗屎，旧代码已经坏得要命了……我们坚持我们解决了所有问题

刚刚在我的一个旧项目中发现了这一点。起初我笑了，但最后我很生气，因为我仍然找不到错误。

* * *

## 回答 #98

> 赞同：0
> 
> 时间：2010-03-05T22:11:05.670

`# Below is stub documentation for your module. You'd better edit it`

* * *

## 回答 #99

> 赞同：0
> 
> 时间：2010-10-01T22:08:37.550

不太适合这个问题，但我讨厌看到：

```
try
{
  someSeeminglyTrivialMethod();
}
catch (Exception e)
{
  //Ignore. Should never happen.
} 
```

每当我在代码审查期间看到这一点时，我都会告诉他们将 catch 替换为：

```
catch (Exception e)
{
  System.exit(0);
} 
```

* * *

## 回答 #100

> 赞同：-5
> 
> 时间：2008-09-27T11:54:03.000

我认为这是对 SO 帖子的最糟糕评论，并且很失望地发现并非如此。

* * *

## 回答 #101

> 赞同：-5
> 
> 时间：2008-09-27T12:03:49.233

注释代码是最没用的注释 :)

# audio - 音频样本库（口语文本）

> ID：143431
> 
> 赞同：-1
> 
> 时间：2008-09-27T11:12:12.430
> 
> 标签：audio, text-to-speech

对于我们目前正在进行的项目，我们需要一个包含多种不同语言的口语单词库。

两种选择似乎是可能的：文本转语音或母语人士的“真实”录音。由于质量对我们很重要，我们正在考虑走后一条路。

为了为我们的应用程序创建原型，我们正在寻找包含尽可能多不同语言的单词的库。为了感受我们方法的质量，这个库不应该由合成语音组成。

您知道任何可用/可访问的库吗？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2008-09-27T11:13:20.697

一位同事刚刚发现了这个基于社区的库，它很好，但体积很小：

[Forvo.com](http://www.forvo.com/)

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2008-09-27T11:42:12.047

我刚刚[在 Audacity wiki 上](http://audacityteam.org/wiki/index.php?title=VoxForge)找到了这个：[VoxForge](http://www.voxforge.org/)。从他们的网站：

> VoxForge 的设置是为了收集转录的语音，以供免费和开源语音识别引擎（在 Linux、Windows 和 Mac 上）使用。
> 
> 我们将在 GPL 许可下提供所有提交的音频文件，然后将它们“编译”成声学模型，用于 Sphinx、ISIP、Julius 和 HTK 等开源语音识别引擎（注意：HTK 有分发限制）。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2008-09-27T11:56:30.780

还有[Old time radio](http://www.otr.net/)，但不确定这是否是您想要的那种口语。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2008-09-27T12:28:32.717

我的猜测是，您在任何地方都找不到仅包含单个单词的库。无论您找到什么，您都必须在编辑器（如 Pro Tools 或 Cool Edit）中打开音频并将其分割成单个单词。

您最好为每种语言创建一个您需要的所有单词的列表，然后在录制时找到母语人士阅读它们。您可以让它们慢慢阅读，这样您就可以轻松地切碎每个单词。

* * *

## 回答 #5

> 赞同：-1
> 
> 时间：2018-08-19T10:28:25.160

我经常使用的一个：http: [//shtooka.net/index.php](http://shtooka.net/index.php) 轻松访问录音。

# firefox - Greasemonkey 会导致显示的标题改变吗

> ID：143484
> 
> 赞同：5
> 
> 时间：2008-09-27T12:01:40.580
> 
> 标签：firefox, greasemonkey, title

我想根据从页面中获取的信息更改页面中显示的标题（例如，显示收件箱消息的数量）

`document.getElementsByTagName('title')[0].innerHTML="foo";`确实会更改标题标签，但是当发生这种情况时，Firefox 不会更新显示的标题（在窗口和标签中）。

这可能吗？

* * *

## 回答 #1

> 赞同：17
> 
> 时间：2008-09-27T12:04:33.070

尝试改用这个：

```
document.title = "我的标题";

```

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2008-09-27T12:06:01.537

尝试将[document.title](http://developer.mozilla.org/en/DOM/document.title)设置为新值

# c# - 使用接口的隐式运算符

> ID：143485
> 
> 赞同：61
> 
> 时间：2008-09-27T12:02:16.647
> 
> 标签：c#, generics, compiler-construction, casting, implicit-conversion

我有一个泛型类，我正在尝试为其实现隐式类型转换。虽然它主要工作，但它不适用于界面转换。经过进一步调查，我发现存在编译器错误：“用户定义的接口转换”适用。虽然我知道这应该在某些情况下强制执行，但我正在尝试做的事情似乎是一个合法的案例。

这是一个例子：

```
public class Foo<T> where T : IBar
{
    private readonly T instance;

    public Foo(T instance)
    {
        this.instance = instance;
    }
    public T Instance
    {
        get { return instance; }
    }
    public static implicit operator Foo<T>(T instance)
    {
        return new Foo<T>(instance);
    }
} 
```

使用它的代码：

```
var concreteReferenceToBar = new ConcreteBar();
IBar intefaceReferenceToBar = concreteReferenceToBar;
Foo<ConcreteBar> concreteFooFromConcreteBar = concreteReferenceToBar;
Foo<IBar> fooFromConcreteBar = concreteReferenceToBar;
Foo<IBar> fooFromInterfaceBar = intefaceReferenceToBar; // doesn't work 
```

有谁知道解决方法，或者任何人都可以以令人满意的方式解释为什么我不能`interfaceReferenceToBar`隐式转换为`Foo<IBar>`，因为在我的情况下它没有被转换，而只包含在 Foo 中？

**编辑：** 看起来协方差可能会提供救赎。我们希望 C# 4.0 规范允许使用协方差隐式转换接口类型。

* * *

## 回答 #1

> 赞同：68
> 
> 时间：2008-09-27T12:37:48.963

您不能这样做的原因是因为它在 C# 语言规范中被明确禁止：

[来源：ECMA-334 第 15.10.4 节](https://www.ecma-international.org/wp-content/uploads/ECMA-334_5th_edition_december_2017.pdf)

> 如果满足以下所有条件，则允许类或结构声明从源类型 S 到目标类型 T 的转换：
> 
> *   ...
> *   S 和 T 都不是`object`interface *-type*。

和

> 用户定义的转换不允许从或转换为 *interface-types*。特别是，此限制确保在转换为 interface-type 时不会发生用户定义的转换*，*并且 仅当正在转换的对象实际实现指定的 interface-type 时，才能成功转换为 *interface* *-type*。

> ID：143486
> 
> 赞同：
> 
> 时间：
> 
> 标签：

None

# linux - 如何将字体添加到 netbeans？

> ID：143487
> 
> 赞同：7
> 
> 时间：2008-09-27T12:02:39.720
> 
> 标签：linux, ide, netbeans, fonts

我在 ubuntu 上使用 netbeans，我想给它添加一些字体。谁能告诉我这是怎么做到的？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2008-09-27T12:26:01.833

我假设您的意思是 IDE 的编辑器字体？

我在使用 6.1 的 Windows 上，但我认为该过程将是相同的。

```
Tools > Options > Fonts & Colours > Syntax
    Category: default
    Font: ([...]) > Select Font 
```

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2008-09-27T14:45:53.150

将它们添加到 .fonts/ 目录就可以了。

# java - python / java / c的OCSP库？

> ID：143515
> 
> 赞同：3
> 
> 时间：2008-09-27T12:12:32.690
> 
> 标签：java, python, c, ocsp

回到我之前关于 OCSP 的问题，有人知道 Python、Java 和 C 的“可靠”OCSP 库吗？

我需要“客户端”OCSP 功能，因为我将针对 OCSP 响应者检查证书的状态，因此响应者功能并不那么重要。

谢谢

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2008-09-27T17:53:57.270

[Java 5 支持通过内置的 OCSP](http://java.sun.com/j2se/1.5.0/docs/guide/security/pki-tiger.html#OCSP)进行撤销检查。如果你想构建一个 OCSP 响应器，或者更好地控制撤销检查，请查看[Bouncy Castle](http://www.bouncycastle.org/docs/docs1.5/overview-summary.html)。您可以使用它来实现您自己的[CertPathChecker](http://java.sun.com/javase/6/docs/api/java/security/cert/PKIXCertPathChecker.html)，例如，在其状态检查中使用非阻塞 I/O。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2008-09-27T16:57:12.600

你检查过pyOpenSSL ..我确定openssl支持ocsp并且python绑定可能支持它

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2008-10-09T20:20:57.970

[OpenSSL](http://www.openssl.org/)是 C 语言中使用最广泛的 OCSP 产品。它非常可靠，尽管非常迟钝。我建议查看apps/ocsp.c 以获得如何发出OCSP 请求和验证响应的一个很好的示例。

Vista 和 Server 2008 在 CAPI 中内置了 OCSP 支持；查看[CertVerifyRevocation](http://msdn.microsoft.com/en-us/library/aa377167.aspx)。

# java - 用于 Java 的 x509 证书解析库

> ID：143523
> 
> 赞同：2
> 
> 时间：2008-09-27T12:16:00.653
> 
> 标签：java, certificate, x509

任何推荐的 Java 加密库。我需要的是解析 X.509 证书以提取其中包含的信息的能力。

谢谢

* * *

## 回答 #1

> 赞同：8
> 
> 时间：2008-09-27T17:47:43.010

大多数证书中的内容比`java.security.cert.X509Certificate`. 如果您需要解析扩展值，请查看[Bouncy Castle Crypto API](http://www.bouncycastle.org/index.html)。（也提供 C# 版本。）

* * *

## 回答 #2

> 赞同：6
> 
> 时间：2008-09-27T12:26:28.353

在 Java 中，java.security.cert.CertificateFactory。

“X.509 的证书工厂必须返回作为 java.security.cert.X509Certificate 实例的证书”

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2008-09-27T12:27:13.967

Java 不需要加密库，它已经附带了该功能。特别是 java.security.cert.X509Certificate。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2008-09-27T17:19:54.917

您还可以查看由 google 开发的[Keyczar](http://www.keyczar.org/)。该库试图使安全性尽可能简单，并且可能比标准 java 库更易于使用...

# gcc - 链接器问题 - 未定义的引用

> ID：143530
> 
> 赞同：9
> 
> 时间：2008-09-27T12:18:49.400
> 
> 标签：gcc, linker

我的编译器有问题，告诉我有一个“未定义的引用”我想在库中使用的函数。让我分享一些关于这个问题的信息：

*   我正在使用 gcc for C 进行交叉编译。
*   我正在调用一个库函数，该函数通过包含的标头访问，该标头包含另一个包含原型的标头。
*   我已经使用 -I 包含了 headers 目录，并且我确定它已被找到。
*   我首先创建 .o 文件，然后将它们链接到单独的命令中。

所以我的想法是这可能是我包含库文件的顺序，但我不确定订购它们的正确方法是什么。我尝试在 .o 文件之前和之后包含 headers 文件夹。

一些建议会很棒，也许还有对链接器如何做事的解释。

谢谢！

* * *

对答案的回应

*   没有 .a 库文件，只有 .h 和 .c 在库中，所以 -l 不合适
*   我对库文件的理解是它只是头文件和源文件的集合，但也许它是从源创建的 .o 文件的集合？！
*   没有创建库目标文件，也许应该有？是的，似乎我不明白包含和库之间的区别......我会努力的:-)

感谢所有的回复！我学到了很多关于图书馆的知识。我想把所有的回复都作为接受的答案:-)

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2008-09-27T12:23:51.040

标头提供函数声明和函数定义。要允许链接器找到函数的实现（并摆脱未定义的引用），您需要使用 -l 标志要求编译器驱动程序 (gcc) 链接函数所在的特定库。例如，-lm 将链接数学库。函数的手册页通常会指定必须指定哪个库（如果有）才能找到该函数。

如果链接器找不到指定的库，您可以使用 -L 开关添加库搜索路径（例如，-L/usr/local/lib）。您还可以通过 LIBRARY_PATH 环境变量永久影响库路径。

这里有一些额外的细节可以帮助你调试你的问题。按照惯例，库文件的名称以 lib 为前缀，并且（以其静态形式）具有 .a 扩展名。因此，系统默认数学库的静态链接版本（您使用 -lm 链接的那个）通常位于 /usr/lib/libm.a 中。要查看给定库定义的符号，您可以在库文件上运行 nm --defined-only。在我的系统上，在 libm.a 上运行命令会得到如下输出。

```
e_atan2.o:
00000000 T atan2

e_asinf.o:
00000000 T asinf

e_asin.o:
00000000 T asin 
```

要查看编​​译器使用的库路径以及默认加载的库，您可以使用 -v 选项调用 gcc。再次在我的系统上，这给出了以下输出。

```
GNU assembler version 2.15 [FreeBSD] 2004-05-23 (i386-obrien-freebsd) 
using BFD version 2.15 [FreeBSD] 2004-05-23
/usr/bin/ld -V -dynamic-linker /libexec/ld-elf.so.1 /usr/lib/crt1.o 
/usr/lib/crti.o /usr/lib/crtbegin.o -L/usr/lib /var/tmp//ccIxJczl.o -lgcc -lc 
-lgcc /usr/lib/crtend.o /usr/lib/crtn.o 
```

* * *

## 回答 #2

> 赞同：5
> 
> 时间：2008-09-27T12:38:57.777

听起来您没有编译库中的 .c 文件来生成 .o 文件。链接器将在编译库生成的 .o 文件中查找原型的实现

您的构建过程是否编译库 .c 文件？

如果它实际上只是源代码，为什么称它为“库”？

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2008-09-27T12:33:28.757

我担心您将库和标头概念混为一谈。假设您有一个库`libmylib.a`，其中包含函数和定义其原型`myfunc()`的相应标头。`mylib.h`在您的源文件`myapp.c`中，您包含标题，直接或包含包含它的另一个标题。例如：

```
/* myapp.h
** Here I will include and define my stuff
*/
...
#include "mylib.h"
... 
```

您的源文件如下所示：

```
/* myapp.c
** Here is my real code
*/
...
#include "myapp.h"
...
/* Here I can use the function */
myfunc(3,"XYZ"); 
```

现在您可以编译它以获得`myapp.o`：

```
gcc -c -I../mylib/includes myapp.c 
```

请注意， -I 只是告诉 gcc 头文件在哪里，它们与库本身无关！

现在您可以将您的应用程序与真实库链接：

```
gcc -o myapp -L../mylib/libs myapp.o -lmylib 
```

请注意，`-L`开关告诉 gcc 库在哪里，并告诉 gcc`-l`将您的代码链接到库。

如果您不执行此最后一步，则可能会遇到您描述的问题。

可能还有其他更复杂的情况，但从您的问题来看，我希望这足以解决您的问题。

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2008-09-27T13:21:04.663

发布您的makefile，以及您尝试调用的库函数。即使是简单的 gcc makefiles 通常也有这样的一行：

```
LIBFLAGS =-lc -lpthread -lrt -lstdc++ -lShared -L../shared 
```

在这种情况下，这意味着链接标准 C 库等

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2008-09-27T12:22:50.560

我想你必须添加链接器可以找到图书馆的路径。在 gcc/ld 中，您可以使用 -L 和使用 -l 的库来执行此操作。

> -Ldir，--库路径=目录
> 
> 在标准搜索目录之前搜索目录 dir（此选项必须位于搜索该目录的 -l 选项之前）。
> 
> -落叶松，--library=存档
> 
> 在要链接的文件列表中包含存档文件 arch。

* * *

> 对答案的响应 - 库中没有 .a 库文件，只有 .h 和 .c，所以 -l 不合适

那么您可能必须先创建库？

```
gcc -c mylib.c -o mylib.o
ar  rcs libmylib.a      mylib.o 
```

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2016-10-11T16:43:59.923

我在使用新版本的 gcc 构建程序时遇到了这个问题。通过使用 -std=gnu89 选项调用 gcc 解决了该问题。显然这是由于内联函数声明。我在[https://gcc.gnu.org/gcc-5/porting_to.html找到了这个解决方案](https://gcc.gnu.org/gcc-5/porting_to.html)

# sql - 比较日期范围

> ID：143552
> 
> 赞同：123
> 
> 时间：2008-09-27T12:29:18.813
> 
> 标签：sql, mysql, date

在 MySQL 中，如果我有一个日期范围列表（范围开始和范围结束）。例如

```
10/06/1983 to 14/06/1983
15/07/1983 to 16/07/1983
18/07/1983 to 18/07/1983 
```

我想检查另一个日期范围是否包含列表中已有的任何范围，我该怎么做？

例如

```
06/06/1983 to 18/06/1983 = IN LIST
10/06/1983 to 11/06/1983 = IN LIST
14/07/1983 to 14/07/1983 = NOT IN LIST 
```

* * *

## 回答 #1

> 赞同：465
> 
> 时间：2008-09-27T12:38:15.530

这是一个经典问题，如果你颠倒逻辑，它实际上更容易。

让我给你举个例子。

我将在这里发布一段时期，以及以某种方式重叠的其他时期的所有不同变化。

```
 |-------------------|          compare to this one
               |---------|                contained within
           |----------|                   contained within, equal start
                   |-----------|          contained within, equal end
           |-------------------|          contained within, equal start+end
     |------------|                       not fully contained, overlaps start
                   |---------------|      not fully contained, overlaps end
     |-------------------------|          overlaps start, bigger
           |-----------------------|      overlaps end, bigger
     |------------------------------|     overlaps entire period 
```

另一方面，让我发布所有不重叠的内容：

```
 |-------------------|          compare to this one
     |---|                                ends before
                                 |---|    starts after 
```

因此，如果您简单地将比较简化为：

```
starts after end
ends before start 
```

然后你会找到所有不重叠的，然后你会找到所有不匹配的时期。

对于您最后的 NOT IN LIST 示例，您可以看到它符合这两个规则。

您需要确定以下时段是在您的范围内还是在您的范围之外：

```
 |-------------|
   |-------|                       equal end with start of comparison period
                         |-----|   equal start with end of comparison period 
```

如果您的表有名为 range_end 和 range_start 的列，这里有一些简单的 SQL 来检索所有匹配的行：

```
SELECT *
FROM periods
WHERE NOT (range_start > @check_period_end
           OR range_end < @check_period_start) 
```

注意里面的*NOT*。由于这两个简单的规则找到了所有*不匹配的*行，一个简单的 NOT 会反转它说：*如果它不是不匹配的行之一，它必须是匹配的行之一*。

在这里应用简单的反转逻辑来摆脱 NOT，你最终会得到：

```
SELECT *
FROM periods
WHERE range_start <= @check_period_end
      AND range_end >= @check_period_start 
```

* * *

## 回答 #2

> 赞同：8
> 
> 时间：2008-09-27T12:41:20.593

以 06/06/1983 到 18/06/1983 的示例范围为例，假设您的范围有名为**start**和**end**的列，您可以使用这样的子句

```
where ('1983-06-06' <= end) and ('1983-06-18' >= start) 
```

即检查您的测试范围的开始是在数据库范围的结束之前，并且您的测试范围的结束是在数据库范围的开始之后或之后。

* * *

## 回答 #3

> 赞同：5
> 
> 时间：2008-09-28T19:56:13.130

如果您的 RDBMS 支持 OVERLAP() 函数，那么这将变得微不足道——不需要本土解决方案。（在 Oracle 中它显然可以工作，但没有记录）。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2008-09-29T13:47:03.650

在您的预期结果中，您说

06/06/1983 至 18/06/1983 = 在列表中

但是，此期间不包含也不包含在您的期间表（不是列表！）中的任何期间。但是，它确实与 1983 年 6 月 10 日至 1983 年 6 月 14 日期间重叠。

您可能会发现 Snodgrass 书 ( [http://www.cs.arizona.edu/people/rts/tdbbook.pdf](http://www.cs.arizona.edu/people/rts/tdbbook.pdf) ) 很有用：它早于 mysql，但时间的概念没有改变；-)

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2011-05-03T03:24:04.330

我在 MySQL 中创建了处理这个问题的函数。只需在使用前将日期转换为秒。

```
DELIMITER ;;

CREATE FUNCTION overlap_interval(x INT,y INT,a INT,b INT)
RETURNS INTEGER DETERMINISTIC
BEGIN
DECLARE
    overlap_amount INTEGER;
    IF (((x <= a) AND (a < y)) OR ((x < b) AND (b <= y)) OR (a < x AND y < b)) THEN
        IF (x < a) THEN
            IF (y < b) THEN
                SET overlap_amount = y - a;
            ELSE
                SET overlap_amount = b - a;
            END IF;
        ELSE
            IF (y < b) THEN
                SET overlap_amount = y - x;
            ELSE
                SET overlap_amount = b - x;
            END IF;
        END IF;
    ELSE
        SET overlap_amount = 0;
    END IF;
    RETURN overlap_amount;
END ;;

DELIMITER ; 
```

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2011-12-19T05:52:27.797

看看下面的例子。这将对您有所帮助。

```
 SELECT  DISTINCT RelatedTo,CAST(NotificationContent as nvarchar(max)) as NotificationContent,
                ID,
                Url,
                NotificationPrefix,
                NotificationDate
                FROM NotificationMaster as nfm
                inner join NotificationSettingsSubscriptionLog as nfl on nfm.NotificationDate between nfl.LastSubscribedDate and isnull(nfl.LastUnSubscribedDate,GETDATE())
  where ID not in(SELECT NotificationID from removednotificationsmaster where Userid=@userid) and  nfl.UserId = @userid and nfl.RelatedSettingColumn = RelatedTo 
```

* * *

## 回答 #7

> 赞同：0
> 
> 时间：2013-01-14T03:16:44.727

```
CREATE FUNCTION overlap_date(s DATE, e DATE, a DATE, b DATE)
RETURNS BOOLEAN DETERMINISTIC
RETURN s BETWEEN a AND b or e BETWEEN a and b or  a BETWEEN s and e; 
```

* * *

## 回答 #8

> 赞同：0
> 
> 时间：2015-01-07T08:21:16.050

在 MS SQL 上试试这个

* * *

```
WITH date_range (calc_date) AS (
SELECT DATEADD(DAY, DATEDIFF(DAY, 0, [ending date]) - DATEDIFF(DAY, [start date], [ending date]), 0)
UNION ALL SELECT DATEADD(DAY, 1, calc_date)
FROM date_range 
WHERE DATEADD(DAY, 1, calc_date) <= [ending date])
SELECT  P.[fieldstartdate], P.[fieldenddate]
FROM date_range R JOIN [yourBaseTable] P on Convert(date, R.calc_date) BETWEEN convert(date, P.[fieldstartdate]) and convert(date, P.[fieldenddate]) 
GROUP BY  P.[fieldstartdate],  P.[fieldenddate]; 
```

* * *

## 回答 #9

> 赞同：0
> 
> 时间：2015-10-15T12:35:22.517

另一种使用 BETWEEN sql 语句的方法

期间包括：

```
SELECT *
FROM periods
WHERE @check_period_start BETWEEN range_start AND range_end
  AND @check_period_end BETWEEN range_start AND range_end 
```

排除期间：

```
SELECT *
FROM periods
WHERE (@check_period_start NOT BETWEEN range_start AND range_end
  OR @check_period_end NOT BETWEEN range_start AND range_end) 
```

* * *

## 回答 #10

> 赞同：-2
> 
> 时间：2017-06-22T16:05:57.890

```
SELECT * 
FROM tabla a 
WHERE ( @Fini <= a.dFechaFin AND @Ffin >= a.dFechaIni )
  AND ( (@Fini >= a.dFechaIni AND @Ffin <= a.dFechaFin) OR (@Fini >= a.dFechaIni AND @Ffin >= a.dFechaFin) OR (a.dFechaIni>=@Fini AND a.dFechaFin <=@Ffin) OR
(a.dFechaIni>=@Fini AND a.dFechaFin >=@Ffin) ) 
```

# ruby - firefox 未打开 - cron，ruby，firewatir

> ID：143554
> 
> 赞同：2
> 
> 时间：2008-09-27T12:30:47.703
> 
> 标签：ruby, firefox, automation, cron, firewatir

我编写了一个 ruby​​ 脚本，它在 Firefox 中打开 dlink 管理页面并进行 ADSL 连接或断开连接。

我可以在终端中运行这个脚本没有任何问题。但如果我把它作为 cron 工作，它不会启动 firefox。

这是我在*crontab中的条目*

```
# connect to dataone
55 17 * * * ruby /home/raguanu/Dropbox/nettie.rb >> /tmp/cron_test 
```

我在 /tmp/cron_test 中看到以下条目。所以看起来脚本确实运行了。

```
PROFILE: 
i486-linux
/usr/bin/firefox -jssh 
```

但我不明白为什么我没有看到 Firefox 开放，让这种自动化工作。这是*/home/raguanu/Dropbox/nettie.rb*

```
#!/usr/bin/ruby -w

require 'rubygems'
require 'firewatir'
require 'optiflag'

module Options extend OptiFlagSet
    character_flag :d do
        long_form 'disconnect'
        description 'Mention this flag if you want to disconnect dataone'
    end

    flag :l do 
        optional 
        long_form 'admin_link'
        default 'http://192.168.1.1'
        description 'Dlink web administration link. Defaults to http://192.168.1.1'
    end

    flag :u do
        optional 
        long_form 'user'
        default 'admin'
        description 'Dlink administrator user name. Defaults to "admin"'
    end

    flag :p do 
        optional 
        long_form 'password'
        default 'admin'
        description 'Dlink administrator password. Defaults to "admin"'
    end

    flag :c do 
        optional 
        long_form 'connection_name'
        default 'bsnl'
        description 'Dataone connection name. Defaults to "bsnl"'
    end

    extended_help_flag :h do
        long_form 'help'
    end

    and_process!
end

class DlinkAdmin
    include FireWatir   

    def initialize(admin_link = "http://192.168.1.1", user = 'admin', pwd = 'admin')
        @admin_link, @user, @pwd = admin_link, user, pwd
    end

    def connect( connection_name = 'bsnl' ) 
        goto_connection_page connection_name

        # disconnect prior to connection
        @browser.button(:value, 'Disconnect').click

        # connect
        @browser.button(:value, 'Connect').click

        # done!
        @browser.close
    end

    def disconnect( connection_name = 'bsnl' )
        goto_connection_page connection_name

        # disconnect
        @browser.button(:value, 'Disconnect').click

        # done!
        @browser.close      
    end

    private
    def goto_connection_page( connection_name = 'bsnl')
        @browser ||= Firefox.new
        @browser.goto(@admin_link)

        # login
        @browser.text_field(:name, 'uiViewUserName').set(@user)
        @browser.text_field(:name, 'uiViewPassword').set(@pwd)
        @browser.button(:value,'Log In').click

        # setup > dataone
        @browser.image(:alt, 'Setup').click
        @browser.link(:text, connection_name).click
    end
end

admin = DlinkAdmin.new(Options.flags.l, Options.flags.u, Options.flags.p)

unless Options.flags.d?
    admin.connect( Options.flags.c )
else
    admin.disconnect( Options.flags.c )
end 
```

任何帮助表示赞赏。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2008-09-27T12:58:09.947

您需要有一个指向有效 X 服务器的 DISPLAY 环境。这可能涉及将其设置为值“：0.0”（不带引号），以便它引用您的本地标准 DISPLAY。

不过有几件事要记住：您可以运行 X 虚拟帧缓冲区 (xvfb)，这样 Firefox 只需将其用作显示。这意味着 Firefox 将能够执行其所有图形操作，但它将独立于您的标准图形环境。您必须适当地设置 DISPLAY 变量，使其指向 xvfb 实例。例如，如果您按如下方式调用 xvfb：

```
Xvfb :1 -screen 0 1600x1200x32 
```

然后您可以通过将 DISPLAY 变量设置为 :1 来使用它

您正在启动一个成熟的 Firefox 实例来简单地连接或断开调制解调器。您很可能能够使用“curl”向服务器发送适当的 HTTP 请求，以便它为您执行连接或断开连接。轻松查看应该重新创建的内容的一种方法是安装 Firefox 插件，例如 LiveHTTPHeaders，并在手动执行操作时记下最重要的 HTTP 请求。

甚至还有一个用于 curl 的 ruby​​ 绑定： [libcurl for Ruby](http://curl.haxx.se/libcurl/ruby/)。生成的脚本应该比您当前的脚本小得多。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2008-09-27T12:54:22.763

从 cron 运行的程序没有您的交互式环境。因此它们没有和 DISPLAY 变量，因此您不能运行任何 X（图形）程序，例如 Firefox。

我建议您自己使用 ruby​​ 进行 HTTP 连接，而不是尝试使 Firefox 自动化。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2008-09-27T12:51:46.280

crontab 条目错误

它像是

```
#min  hour  day  month  dow  user                command
55    17    *    *      *    ur_user_is_missing  ruby /home/raguanu/Dropbox/nettie.rb >> /tmp/cron_test 
```

# java - Java 软件合成库

> ID：143566
> 
> 赞同：13
> 
> 时间：2008-09-27T12:37:41.320
> 
> 标签：java, audio

我最近一直在思考一个我想从事的以音乐为导向的项目。有点像游戏……有点像工作室工作站（FL Studio，Reason）。

我想最好的描述方式是：像“吉他英雄”，但没有固定曲目。所有原创音乐 - 由您即时创作 - 但该软件将使用其音乐理论知识（以及一些监督学习算法）来确保您的输入变成听起来很棒的东西。

听起来有点傻，这样解释，但你去吧。我认为这是一个有趣的副项目。

无论如何，我正在寻找一个用于生成实际音频的 Java 库。在sourceforge上浏览，有无数的软件合成器，我不知道该选择哪个。

我的首要任务是它应该听起来令人难以置信......真正丰富，分层，纹理合成器，带有大量可配置参数。声学乐器的仿真对我来说并不重要。

我的第二个优先事项是它应该直接作为一个库使用，完全不涉及 GUI。（如果有一个输出非常惊人的合成器，但它与 GUI 紧密耦合，那么我可能会考虑将音频部分从应用程序中提取出来，但我宁愿从一个包含良好的库开始）。

我知道我可以将 MIDI 发送到独立的合成器，但我认为阅读实际的合成器代码并在我使用它的同时学习一点 DSP 会很酷。

有什么建议么？

哦，是的，我在 Windows 上，所以只有 posix 的东西是不行的。

谢谢！

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2008-09-27T12:41:41.403

你检查过[JFugue](http://www.jfugue.org/)吗？它是一个“没有 MIDI 复杂性的用于音乐编程的开源 Java API”。

**附加信息：在**[JFugue 文档 (pdf)](http://www.jfugue.org/jfugue-chapter1.pdf)中找到了一些其他资源：

*   [音频合成引擎项目](http://openjdk.java.net/projects/audio-engine)：Java 的 MIDI 合成器的开源版本

*   [Gervill](https://gervill.dev.java.net)：作为音频合成引擎项目提案创建的开源软件合成器

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2008-09-27T13:15:42.603

是的，几年前我注意到了 JFugue。它在我有趣的计算机/音乐书签列表中：

[http://delicious.com/BenjiSmith/computermusic](http://delicious.com/BenjiSmith/computermusic) [http://delicious.com/BenjiSmith/programming.java.libraries.music](http://delicious.com/BenjiSmith/programming.java.libraries.music)

但是 JFugue 完全是关于音乐本身的结构……旋律、和声、节奏等等……

我现在正在寻找的只是合成器。像这样的东西...

```
Synth s = new Synth();
Instrument i = s.getInstrument("Robot Bass");
i.makeAwesome(true); 
```

然后我会将我的事件发送到 MIDI 流（或任何合成库提供的控制 API）。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2013-04-01T05:43:03.103

如果 Clojure 是一个可接受的选项（在 JVM 上运行，易于与 Java 集成），那么绝对值得一试[Overtone](http://overtone.github.com/)。

它使用 SuperCollider 作为合成引擎，但将其全部包装在一个漂亮的 DSL 和交互式编程环境中。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2011-02-01T18:22:04.920

[minim](http://code.compartmental.net/tools/minim/)不完全是一个 java 合成器，但它是一个处理库，我想它也应该很容易与 vanilla java 一起使用。

# asp.net-mvc - 包括分部、ASP.NET MVC

> ID：143571
> 
> 赞同：11
> 
> 时间：2008-09-27T12:39:05.077
> 
> 标签：asp.net-mvc

我正在构建我的第一个 ASP.NET MVC 应用程序，但在使用局部视图时遇到了一些问题。

例如，如果我想将“页脚”作为部分内容，我将在“/Views/Shared/Footer.ascx”中创建一个“MVC 视图用户控件”。（我暂时把它留空）

将它添加到我的布局的正确方法是什么？

我试过了：

```
<%=Html.RenderPartial("Footer")%> 
```

和：

```
<%=Html.RenderPartial("~/Views/Shared/Footer.ascx")%> 
```

对于每一个我都有一个例外：

> “CS1502：'System.IO.TextWriter.Write(char)' 的最佳重载方法匹配有一些无效参数”

在 ASP.NET MVC 中处理部分的正确方法是什么？

* * *

## 回答 #1

> 赞同：23
> 
> 时间：2008-09-27T12:41:21.280

在这种情况下，不要使用 <%= 语法。只需使用 <% %> 语法。那么你的例子中的第一种形式应该可以工作。

有关更多信息，请在此处查看：http: [//bradwilson.typepad.com/blog/2008/08/partial-renderi.html](http://bradwilson.typepad.com/blog/2008/08/partial-renderi.html)

* * *

## 回答 #2

> 赞同：13
> 
> 时间：2008-09-27T12:49:26.020

按照@BenScheirman 所说的去做，并在语句的末尾添加一个分号:)

```
<% Html.RenderPartial("~/Views/Shared/Footer.ascx"); %> 
```

更新：我猜 VB 不需要分号。因此，只有在使用 C# 编程时才需要它。

# c++ - 在哪里可以找到开源 2d bin 打包算法？

> ID：143580
> 
> 赞同：8
> 
> 时间：2008-09-27T12:42:22.167
> 
> 标签：c++, algorithm, bin-packing

我正在寻找用于矩形和/或不规则形状的 2d bin 打包的开源（最好是 c++）算法。我找到了几篇关于这个主题的论文，但没有代码。

* * *

## 回答 #1

> 赞同：-1
> 
> 时间：2015-04-06T07:02:52.403

这是我对矩形箱包装的了解最好的：

[http://clb.demon.fi/projects/rectangle-bin-packing](http://clb.demon.fi/projects/rectangle-bin-packing)

# java - 在 catch 块内抛出异常 - 它会再次被捕获吗？

> ID：143622
> 
> 赞同：225
> 
> 时间：2008-09-27T13:10:51.740
> 
> 标签：java, exception

这似乎是一个编程 101 问题，我原以为我知道答案，但现在发现自己需要仔细检查。在下面这段代码中，第一个catch块中抛出的异常会被下面的通用Exception catch块捕获吗？

```
try {
  // Do something
} catch(IOException e) {
  throw new ApplicationException("Problem connecting to server");
} catch(Exception e) {
  // Will the ApplicationException be caught here?
} 
```

我一直认为答案是否定的，但现在我有一些可能由此引起的奇怪行为。大多数语言的答案可能相同，但我正在使用 Java。

* * *

## 回答 #1

> 赞同：269
> 
> 时间：2008-09-27T13:13:30.890

不，因为 new`throw`不是`try`直接在块中。

* * *

## 回答 #2

> 赞同：78
> 
> 时间：2008-09-27T13:48:34.770

不，这很容易检查。

```
public class Catch {
    public static void main(String[] args) {
        try {
            throw new java.io.IOException();
        } catch (java.io.IOException exc) {
            System.err.println("In catch IOException: "+exc.getClass());
            throw new RuntimeException();
        } catch (Exception exc) {
            System.err.println("In catch Exception: "+exc.getClass());
        } finally {
            System.err.println("In finally");
        }
    }
} 
```

应该打印：

```
在捕获 IOException：类 java.io.IOException
终于在
线程“主”java.lang.RuntimeException 中的异常
        在 Catch.main(Catch.java:8)
```

从技术上讲，这可能是编译器错误、依赖于实现、未指定的行为或其他原因。但是，JLS 已经很好地确定了，编译器对于这种简单的事情已经足够好了（泛型的极端情况可能是另一回事）。

另请注意，如果您交换两个 catch 块，它将无法编译。第二个捕获将是完全无法到达的。

请注意，即使执行了 catch 块，finally 块也会始终运行（除了愚蠢的情况，例如无限循环、通过工具接口附加并杀死线程、重写字节码等）。

* * *

## 回答 #3

> 赞同：30
> 
> 时间：2008-09-28T01:28:31.607

Java 语言规范在第 14.19.1 节中说：

> 如果 try 块的执行由于抛出值 V 而突然完成，那么有一个选择：
> 
> *   如果 V 的运行时类型可分配给 try 语句的任何 catch 子句的参数，则选择第一个（最左边）这样的 catch 子句。将值 V 分配给所选 catch 子句的参数，并执行该 catch 子句的 Block。如果该块正常完成，则 try 语句正常完成；**如果该块出于任何原因突然完成，则 try 语句出于同样的原因突然完成。**

参考：http: [//java.sun.com/docs/books/jls/second_edition/html/statements.doc.html#24134](http://java.sun.com/docs/books/jls/second_edition/html/statements.doc.html#24134)

换句话说，可以处理异常的第一个封闭的 catch 确实如此，如果从该 catch 中抛出异常，则它不在原始 try 的任何其他 catch 的范围内，因此他们不会尝试处理它。

一件相关且令人困惑的事情是，在 try-[catch]-finally 结构中，finally 块可能会引发异常，如果是这样，则 try 或 catch 块引发的任何异常都会丢失。当你第一次看到它时，这可能会让人感到困惑。

* * *

## 回答 #4

> 赞同：8
> 
> 时间：2013-06-14T14:52:51.280

如果你想从 catch 块中抛出一个异常，你必须通知你的方法/类/等。它需要抛出所述异常。像这样：

```
public void doStuff() throws MyException {
    try {
        //Stuff
    } catch(StuffException e) {
        throw new MyException();
    }
} 
```

现在你的编译器不会对你大喊大叫了:)

* * *

## 回答 #5

> 赞同：3
> 
> 时间：2008-09-27T13:15:31.883

不——正如 Chris Jester-Young 所说，它将被抛出到层次结构中的下一个 try-catch。

* * *

## 回答 #6

> 赞同：2
> 
> 时间：2008-09-27T13:38:34.967

如上所述...
我要补充一点，如果您无法看到正在发生的事情，如果您无法在调试器中重现问题，您可以在重新抛出新异常之前添加跟踪（使用良好的旧系统.out.println 更糟，否则有像 log4j 这样的良好日志系统）。

* * *

## 回答 #7

> 赞同：2
> 
> 时间：2008-09-27T13:53:35.943

它不会被第二个 catch 块捕获。每个异常仅在 try 块内时才被捕获。您可以嵌套尝试（通常不是一个好主意）：

```
try {
    doSomething();
} catch (IOException) {
   try {
       doSomething();
   } catch (IOException e) {
       throw new ApplicationException("Failed twice at doSomething" +
       e.toString());
   }          
} catch (Exception e) {
} 
```

* * *

## 回答 #8

> 赞同：1
> 
> 时间：2008-09-27T22:05:17.180

不，因为所有的 catch 都指向同一个 try 块，所以从一个 catch 块中抛出将被一个封闭的 try 块捕获（可能在调用这个的方法中）

* * *

## 回答 #9

> 赞同：-6
> 
> 时间：2013-12-01T04:24:53.840

旧帖子但“e”变量必须是唯一的：

```
try {
  // Do something
} catch(IOException ioE) {
  throw new ApplicationException("Problem connecting to server");
} catch(Exception e) {
  // Will the ApplicationException be caught here?
} 
```

# log4net - Binsor 和 log4net

> ID：143623
> 
> 赞同：1
> 
> 时间：2008-09-27T13:11:03.127
> 
> 标签：log4net, castle-windsor, binsor

我正在使用 Castle Windsor 和 Binsor 在我的应用程序中使用依赖注入。我不是任何一个方面的专家。通常我可以弄清楚如何让温莎屈服于我的意愿，但我发现 Binsor 要困难得多，尤其是因为我还没有找到任何合适的文档。

我正在尝试创建一个使用日志记录的 binsor 配置文件。我使用以下 binsor 代码配置日志记录：

```
facility LoggingFacility:
  loggingApi = LoggerImplementation.Log4net
  configFile = "ParasiteLogConf.log4net" 
```

这很好用，所有向容器注册并且将 ILogger 对象作为构造函数的参数的组件都将接收正确的 ILogger 实例。

但是，我现在要做的是为一个特定组件使用*另一个记录器。*我希望该组件记录到文件，而其他组件应该只记录到屏幕。我将如何使用 Binsor 代码表达这一点？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2008-09-27T14:07:35.707

[Aynede@Rahien](http://ayende.com/Blog/category/451.aspx)是你的朋友。他有很多关于使用和配置 Binsor 的博客文章。

对于特殊记录器，需要将其添加为组件，然后将依赖组件的 logger 属性显式设置为特殊记录器组件的 id。

# python - Python 的 Crypto/X509 证书解析库

> ID：143632
> 
> 赞同：6
> 
> 时间：2008-09-27T13:15:33.337
> 
> 标签：python, cryptography, openssl, x509

任何推荐的 Python 加密库。我知道我在[x509 certificate parsing libraries for Java](https://stackoverflow.com/questions/143523/)中问过类似的问题，但我应该将问题一分为二。

我需要的是解析 X.509 证书以提取其中包含的信息的能力。

环顾四周，我发现了两个选择：

*   Python OpenSSL 包装器 ( [http://sourceforge.net/projects/pow](http://sourceforge.net/projects/pow "Python OpenSSL 包装器") )
*   [pyOpenSSL](https://github.com/pyca/pyopenssl)

在这两者中，pyOpenSSL 似乎是最“维护”的，但我想对可能有使用它们经验的任何人提供一些反馈？

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2008-12-08T12:58:51.130

使用 M2Crypto，它是最完整的工具恕我直言

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2008-09-27T17:28:36.143

您可能想尝试我在另一篇文章中提到的[keyczar](http://www.keyczar.org/)，因为该库实际上具有 python 和 java 的实现。这将使在两种情况下都更容易使用它。

一句警告：我实际上并没有使用过这个库 8(，所以请对它持保留态度。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2010-01-10T19:48:35.013

我的经验是，大多数加密库都专注于特定的工作流程 - 使某组任务更容易，而其他任务则变得困难或不可能。例外情况是那些已经存在很长时间并且已经成熟的库（例如openssl、bounceycastle，但在我的经验中没有一个python库）。因此，您确实需要在您尝试做的事情的上下文中评估库。

更具体地说，我使用 pyOpenSSL 来简单地生成私钥和证书请求（即作为 CA 的客户端），并且对此非常满意。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2021-11-27T13:24:34.973

该`keyczar`项目已弃用。你可以签出[`tink`](https://github.com/google/tink)。

# windows - 窗口样式/最小标题栏/边框

> ID：143633
> 
> 赞同：0
> 
> 时间：2008-09-27T13:15:35.770
> 
> 标签：windows, winapi, coding-style, window-style

我正在寻找某种资源（网站），它会列出所有可能的窗口/对话框框架样式以及它们各自*与图像*的组合。我只对 Vista 很感兴趣，因为我的软件无论如何都不支持旧平台。

我在这里也有一个更具体的案例：我想知道是否有其他方法可以为我的窗口实现比正常更小的标题栏`WS_EX_TOOLWINDOW`？工具窗口样式本来可以满足我的需要，但是除了正常的窗口边框之外，它似乎在黑色轮廓内添加了这个 1 像素宽的白色边框，这对于我的目的来说看起来真的很难看。

我记得旧版本的 Adob​​e Photoshop (CS2?) 在工具窗口上有这些可笑的小标题栏，比如 8-10 像素宽。我想知道这些是否可以用普通的winapi来完成，因为IIRC它们也有vista风格，并且符合使用的任何windows皮肤..？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2008-09-27T13:41:26.707

如果它仅适用于 Vista，您可以尝试使用自己的窗口装饰并使用[桌面窗口管理器 (DWM) API](http://msdn.microsoft.com/en-us/library/aa969540.aspx)来提供 Aero Glass Theming。

另一方面，如果您的目标是 Vista 及更高版本，您很可能不必处理低分辨率问题。不要过多考虑或多或少的几个像素。

# c# - 专注于应用程序

> ID：143651
> 
> 赞同：1
> 
> 时间：2008-09-27T13:30:37.323
> 
> 标签：c#, .net, vb.net

我写了一个具有模态形式的应用程序。即使启动其他应用程序，如何确保此表单不会失去焦点？

* * *

## 回答 #1

> 赞同：10
> 
> 时间：2008-09-27T13:35:58.293

实际上，这正是你不应该做的事情。

周围有太多的程序假设它们控制着它们所安装的计算机。应该由您的应用程序的用户来控制。

这就是为什么更高版本的 Windows 不允许窃取焦点，而是坚持只闪烁任务列表栏中的条目。

您可能会找到一种方法来做到这一点（尽管我对此表示怀疑），但我敦促您重新考虑一下。我很想知道你为什么认为这是必要的。

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2008-09-27T13:37:38.040

您可以将“Topmost”属性设置为 true 以使表单保持在所有其他表单的前面，但这不会使其保持焦点。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2008-09-27T13:55:51.337

您必须使对话系统模态化。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2008-09-27T14:26:05.087

我用

```
SetForegroundWindow(Me.Handle) 
```

Me.Handle 是表单的句柄。

您需要在类或 winform 中的某处声明以下内容，但不在函数内

```
Declare Unicode Function SetForegroundWindow Lib "user32.dll" (ByVal hWnd As IntPtr) As Boolean 
```

您可能需要启动一个计时器并在每 10 秒的滴答声上调用 SetForegroundWindow，具体取决于您的偏好。

编辑：它适用于我，如果它不添加以下内容

```
 Declare Unicode Function SystemParametersInfo Lib "user32.dll" Alias "SystemParametersInfoW" (ByVal uiAction As Int32, ByVal uiParam As Int32, ByRef pvParam As Int32, ByVal fWinIni As Int32) As Int32 
```

并用这些包围 SetForegroundWindow

```
 Dim _timeout As Int32
    SystemParametersInfo(&H2000, 0, _timeout, 0)
    SystemParametersInfo(&H2001, 0, 0, 3)
    SetForegroundWindow(Me.Handle)
    SystemParametersInfo(&H2001, 0, _timeout, 2) 
```

这是最后的手段

# perl - 安装 Perl Web 应用程序的最佳系统是什么？

> ID：143680
> 
> 赞同：11
> 
> 时间：2008-09-27T13:59:26.817
> 
> 标签：perl, web-applications, installation

似乎大多数 Perl 安装程序都以安装 Perl 模块为中心，而不是应用程序。像 ExtUtils::MakeMaker 和 Module::Build 这样的东西非常适合模块，但是对于 Web 应用程序需要一些额外的工作。

理想情况下，在从存储库中签出源代码后能够执行以下操作会很好：

*   检测到缺少依赖项
*   从 CPAN 下载并安装依赖项
*   运行命令将源“构建”到最终状态（执行本地环境所需的任何源解析或配置）。
*   运行命令将构建的文件安装到适当的位置。不仅是 perl 模块，还有模板 (.tt) 文件、CGI 脚本、JS 和图像文件等应该可以通过网络访问的内容。
*   确保在已安装的文件上设置了适当的权限（必要时还包括 SELinux 上下文）。

现在我们有一个基于**Module::Build**的系统来完成大部分工作。这项工作是由我当时正在学习使用**Module::Build**的同事完成的，我们想要一些关于推广我们的解决方案的建议，因为它现在是相当特定于应用程序的。特别是，我们的系统要求我们手动安装依赖项（尽管它确实检测到了它们）。

您使用过哪些特别成功的特定系统？**您是否必须根据特定于您的应用程序的Module::Build**或**ExtUtils::MakeMaker**编写安装程序，或者是否有更通用的东西？

**编辑：**回答以下布赖恩的问题：

*   我们可以登录机器
*   我们没有对机器的 root 访问权限
*   这些机器都是（表面上）相同的启用 SELinux 的 RHEL5 版本
*   目前，安装机器的人只是我们集团的程序员，我们的资源不向公众开放。但是，可以想象我们的源代码最终会安装在我们组织中其他人的机器上，由他们的程序员或系统人员安装。
*   我们通过从存储库中签出来安装，尽管我们希望可以选择使用分布式存档（见上文）。

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2008-09-27T16:53:54.310

建议 RPM 的答案绝对是一个好答案。使用系统的包管理器绝对可以让您的生活更轻松。但是，这可能意味着您还需要打包一堆其他 Perl 模块。

你也可以看看[Shipwright](http://search.cpan.org/dist/Shipwright/)。这是一个基于 Perl 的工具，用于打包应用程序及其所有 Perl 模块依赖项。现在还为时尚早，但看起来很有希望。

至于安装依赖项，简单地打包一堆 tarball，然后让你基于 Module::Build 的解决方案安装它们并不难。您应该看一下[pip](http://search.cpan.org/dist/pip/)，这使得从 tarball 安装模块变得非常简单。您可以将其与您的代码库一起打包，然后简单地从您自己的安装程序中调用它来处理 deps。

我质疑依赖 CPAN 是否是一个好主意。CPAN shell 总是获取发行版的最新版本，而不是特定版本。如果您对确保可重复安装感兴趣，那么它不是正确的工具。

* * *

## 回答 #2

> 赞同：6
> 
> 时间：2008-09-27T18:46:55.847

安装 Web 应用程序有哪些限制？可以登录机器吗？所有机器都运行相同的东西吗？安装网络应用程序的人是同事还是普通大众的随机人？安装此系统管理员、程序员、网络管理员或其他什么的人？您是通过分发存档还是从源代码管理中签出来安装的？

对于我的大部分内容，包括熟悉在控制环境中安装 Perl 的系统管理员，我只使用[MakeMaker](http://search.cpan.org/dist/ExtUtils-Makemaker)。如果您对`MakeMaker`. 如果您想了解更多相关信息，请提出另一个问题。;) [Module::Build](http://search.cpan.org/dist/Module-Build)同样简单，如果你还不喜欢使用`MakeMaker`.

`Module::Build`如果人们对命令行和安装软件有一定的了解，那将是处理许多不同情况的好方法。您将拥有很大的灵活性`Module::Build`，但也需要更多的工作。而且，该`cpan`工具（Perl 附带）可以从当前目录安装并为您处理依赖关系。只需告诉它安装当前目录：

```
 $ cpan . 
```

如果您只需在单个平台上安装，您可能会更轻松地以本机格式制作软件包。您甚至可以`Module::Build`为您制作该软件包，以便开发人员具有灵活性`Module::Build`，但安装程序具有本机过程的便利性。坚持`Module::Build`也意味着您可以从一个构建工具为不同的平台创建不同的包。

如果安装 Web 应用程序的人真的不知道命令行、CPAN 和其他东西，您可能希望使用不会吓到他们或让他们思考正在发生的事情的打包程序和安装程序，并且可以自动准确地向您报告问题。

正如 Dave 所指出的，使用真正的 CPAN 镜像总能为您提供模块的最新版本，但您也可以使用您想要的发行版制作自己的“假”CPAN 镜像，并从中安装正常的 CPAN 工具。对于我们的客户，我们制作“CD 上的 CPAN”（尽管拇指驱动器现在也很好）。使用一个简单的“运行我”脚本，所有东西都可以安装在他们需要的版本中。例如，如果您对此感兴趣，请参阅我的制作我自己的 CPAN 演讲。同样，当您考虑这一点时，请考虑观众。这不是你会交给公众的东西。

祝你好运， ：）

* * *

## 回答 #3

> 赞同：3
> 
> 时间：2008-09-27T15:00:14.753

我建议认真考虑使用 RPM 之类的软件包系统来执行此操作。即使您在 Windows 上运行，我也会考虑使用 RPM 和 cygwin 进行安装。您甚至可以设置一个 yum 或 apt 存储库来将软件包传送到远程系统。

如果您正在为运行任意数量的操作系统和发行版的客户寻找通用安装程序，那么问题就会变得更加困难。

* * *

## 回答 #4

> 赞同：2
> 
> 时间：2008-09-29T13:18:50.517

看看[PAR](http://search.cpan.org/dist/PAR/)。

Jonathan Rockway 在他的书中一小部分介绍了如何将其与 Catalyst 一起使用。

# .net - 收集有关应用程序使用情况的数据的最佳方法是什么？

> ID：143681
> 
> 赞同：5
> 
> 时间：2008-09-27T14:00:30.980
> 
> 标签：.net, winforms, user-interface, measurement

我的公司发布了一个小型软件产品，我最近接手了该产品的开发工作。它是一个 C# Windows 窗体应用程序。

我注意到的一件事是，关于软件使用方式的大部分信息都是通过我的上级过滤的，我觉得我在某些信息中遗漏了重要的细节。

我意识到我必须解决这种情况下的管理问题，但是为了对这个问题提出另一种看法，我一直在考虑采用技术解决方案。也许类似于“微软客户体验改善计划”。

我想知道是否有人在他们的应用程序中监控和报告用户行为有任何经验或建议？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2008-09-27T14:06:12.980

我建议你让你的应用程序在某处写下它的“使用信息”，然后*在用户许可的情况下*，每隔一段时间以电子方式传输它。

注意上面的重点。根据您所在的司法管辖区，您可能会在未经许可的情况下从其他人的计算机传输任何类型的数据时遇到严重问题。

在以下情况下，您更有可能获得许可：

1/ 您在安装或更新时明确表示，您的程序只会在获得许可的情况下收集和传输信息。

2/你清楚地解释了信息是什么，它只包含“使用信息”，没有任何东西可以追溯到软件的用户（没有序列号等）。

3/ 您请求不经常传输的许可。如果我有一个讨厌的程序每天都问我，我很快就会完全停止使用它。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2008-09-27T14:28:04.783

我相信您已经就技术解决方案的隐私方面的问题得到了很好的回答。

我还想提一下，您应该尝试在正常的 80/443 端口上使用 HTTP 或 HTTPS - 这些是最不可能导致防火墙和代理问题的。使用 MS IE 代理设置，因为它们通常设置正确。

* * *

从完全不同的角度来看，我想说了解您的软件使用情况的最佳方式是检查您的安装群中是否有任何“友好”用户并采访他们。可能是一些合作伙伴公司或人员，他们是您新版本测试版的“试点小组”。跟他们讲话。抓住你的经理，如果可能的话，花一天时间去他们的网站，自己看看怎么做，然后他们点击按钮。做笔记。听取反馈。建立个人关系，以便下次他们直接与您交谈。

如果您的应用程序很小并且您的公司不是 Microsoft，那么靠近您的用户群比收集匿名使用数据要好得多，因为匿名使用数据需要花费大量精力来收集和处理，然后甚至需要更多的精力来理解。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2008-09-27T14:40:56.530

一种想法是在用户许可的情况下发送匿名统计信息。

另一个想法是在您的应用程序中提供一个大的报告错误/询问问题按钮，以便他们可以告诉您何时发生他们认为错误的事情，您将在报告中发送应用程序状态。

始终清楚您将要发送什么，并使用户可以选择非匿名（始终将匿名数据设置为默认值），当您通过用户选择获得大量非匿名数据时，您可能会感到惊讶。

并且通过使用用户的语言来明确，永远不要说“我要发送应用程序堆栈和堆的当前状态的 Blowfish 加密内存转储。是/否？”，而是像“我要去发送您在程序中的活动列表：您单击的按钮以及您打开的文件的类型和数量。这将帮助我们为您创建更好的程序，但您可以选择您希望我们接收的内容。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2008-12-30T04:59:05.670

免责声明：我是这个产品的开发人员，所以我可能对它的伟大程度有点偏见:)

目前市场上有一种产品可以为您提供用于 .NET 和 Java 应用程序的此功能，我们称之为运行时智能。有关详细信息，请参阅：[http](http://www.preemptive.com/runtime-intelligence-services.html) ://www.preemptive.com/runtime-intelligence-services.html 。

该产品目前可用于 .NET 和 Java，并且提供有限功能集的免费版本将包含在 Visual Studio 2010 中。

可以跟踪应用程序的使用情况，范围从执行次数和操作系统/框架版本的高级统计信息到各个功能的使用频率。

我们为您提供了一种方式，让您的用户在传输使用数据时可以选择加入或选择退出，并且数据通过 SSL（默认）或标准 HTTP 发送。对您的应用程序的性能影响很小，我们非常注意不影响您的代码的响应能力。

此解决方案非常适合评估或 beta 测试，因为您可以直接跟踪应用程序的使用情况，而不是依赖调查或猜测用户在做什么。

对于已发布的应用程序，这提供了客户体验改进计划的脚手架，并且对累积数据的可见性对从高层管理人员到开发人员的每个人都很有价值。

我们发现只需不到一个小时就可以为基本使用情况报告设置应用程序，而无需更改代码，因为我们可以直接处理程序集二进制文件。

有关定价信息或获得评估，请联系我们网站的销售人员，因为我只是一名开发人员 :)

如需详细的技术信息或任何其他问题，请随时与我联系。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2010-01-06T00:18:18.863

实际上，我认为您正在尝试做简单的商业智能。

不要忘记设置“适当的”仪表板以跟踪您收集的数据，深入思考您将实施的指标。

# performance - 将 TLS 与 apache 结合使用对性能有何影响？

> ID：143692
> 
> 赞同：3
> 
> 时间：2008-09-27T14:17:20.130
> 
> 标签：performance, apache, encryption, ssl

通过 TLS 运行所有内容会对我的服务器造成多大的性能影响？我会假设这在当今时代完全可以忽略不计？我曾经听说今天的服务器每秒可以加密千兆字节的数据，这是真的吗？如果是这样，它是否可以线性扩展，如果最高速度是 10GB/秒，加密 1GB 需要 0.1 秒？

我还没有与任何管理员对此（还）处于某种泡菜中。我只是好奇，如果我几乎可以忽略命中，为什么不加密所有内容呢？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2008-09-27T14:27:11.727

[TLS Web 服务器的性能分析 (pdf)](http://www.isoc.org/isoc/conferences/ndss/02/papers/coarfa.pdf)是莱斯大学的一篇论文，早在 2002 年就涵盖了这个主题，他们得出了这样的结论：

> 没有 AXL300 的 Apache TLS 的 CS 跟踪速度在 149 次/秒和 259 次/秒之间，而亚马逊跟踪的速度在 147 次/秒和 261 次/秒之间。这证实了 TLS 会产生巨大的成本，并且相对于不安全的 Apache 将吞吐量降低了 70% 到 89%。

因此，在没有卸载加密的 AXL300 板的情况下，PIII-933MHz 的吞吐量降低了 70-89%。但是，他们在下一节中指出，随着 CPU 速度的提高，吞吐量预计会相应增加。因此，自 2002 年以来，您可能会发现您的工作量没有明显差异。

# f# - 未来 F# 是否有可能比其他 .Net 语言优化得更多？

> ID：143708
> 
> 赞同：14
> 
> 时间：2008-09-27T14:33:39.467
> 
> 标签：f#, functional-programming, parallel-processing, vectorization

微软是否有可能让 F# 程序在 VM 执行时或更可能在编译时检测到程序是用函数式语言构建的并自动更好地并行化它？

现在我相信没有这样的努力来尝试自动执行一个作为单线程程序构建为多线程程序的程序。

也就是说，开发人员将编写一个单线程程序。并且编译器会输出一个编译的程序，该程序是多线程的，在需要时带有互斥锁和同步。

这些优化会在任务管理器中的进程线程数中可见，还是会比这更低？

* * *

## 回答 #1

> 赞同：12
> 
> 时间：2008-09-27T15:05:00.997

我认为这在不久的将来不太可能。如果确实发生了，我认为它更有可能发生在 IL 级别（程序集重写）而不是语言级别（例如 F#/编译器特定的东西）。这是一个有趣的问题，我希望一些优秀的人一直在关注这个问题，并将继续关注这个问题，但在短期内，我认为重点将放在让人类更容易指挥程序的线程化/并行化，而不是像魔术一样让这一切发生。

[（像F# 异步工作流](http://blogs.msdn.com/dsyme/archive/2007/10/11/introducing-f-asynchronous-workflows.aspx)这样的语言特性，以及像[任务并行库和其他](http://blogs.msdn.com/pfxteam/default.aspx)库这样的库，都是这里近期取得进展的好例子；它们可以为您完成大部分繁重的工作，尤其是当您的程序更具声明性而不是命令性时，但它们仍然需要程序员选择加入，对正确性/意义进行分析，并可能对代码结构进行轻微改动以使其全部工作。）

无论如何，这都是猜测；谁能说未来会带来什么？我期待着发现（并希望能实现其中的一些）。:)

* * *

## 回答 #2

> 赞同：7
> 
> 时间：2008-09-27T14:46:27.703

由于 F# 是从 Ocaml 派生的，而 Ocaml 编译器可以比其他编译器更好地优化您的程序，因此可能可以做到。

* * *

## 回答 #3

> 赞同：6
> 
> 时间：2008-10-19T03:46:31.297

我不相信以一种普遍有用的方式自动矢量化代码是可能的，并且 F# 的函数式编程方面在这种情况下基本上是无关紧要的。

最困难的问题不是检测何时可以并行执行子计算，而是确定何时不会降低性能，即何时子任务将花费足够长的时间来计算，值得承担并行生成的性能损失。

我们在科学计算的背景下对此进行了详细研究，并在我们的 F# for Numerics 库中采用了混合方法。我们的并行算法基于 Microsoft 的任务并行库构建，需要一个附加参数，该参数是一个函数，可提供子任务的估计计算复杂度。这允许我们的实现避免过度细分并确保最佳性能。此外，该解决方案非常适合 F# 编程语言，因为描述复杂性的函数参数通常是匿名的一等函数。

干杯，乔恩·哈罗普。

* * *

## 回答 #4

> 赞同：4
> 
> 时间：2008-09-27T15:36:22.187

我认为这个问题忽略了 .NET 架构的重点——F#、C# 和 VB（等）都被编译为 IL，然后通过 JIT 编译器编译为机器代码。程序是用函数式语言编写的这一事实并不相关——如果 IL 中的 JIT 编译器有可用的优化（如尾递归等），编译器应该利用它。

当然，这并不意味着编写函数式代码是无关紧要的——显然，有一些方法可以编写可以更好地并行化的 IL——但是其中许多技术可以在任何 .NET 语言中使用。

因此，没有必要将 IL 标记为来自 F# 以检查它的潜在并行性，这样的事情也不可取。

* * *

## 回答 #5

> 赞同：3
> 
> 时间：2008-09-27T14:47:58.947

对各种语言的自动并行化和自动矢量化进行了积极的研究。人们可能希望（因为我真的很喜欢 F#）他们会想出一种方法来确定是否使用了“纯”无副作用子集，然后将其并行化。此外，自从 Haskell 之父 Simon Peyton-Jones 在 Microsoft 工作以来，我很难不相信会有一些很棒的东西出现。

* * *

## 回答 #6

> 赞同：2
> 
> 时间：2008-09-27T15:52:45.720

这是可能的，但不太可能。Microsoft 将大部分时间用于支持和实施最大客户要求的功能。这通常意味着 C#、VB.Net 和 C++（不一定按此顺序）。F# 在优先级列表中似乎并不高。

* * *

## 回答 #7

> 赞同：2
> 
> 时间：2008-10-19T04:31:37.710

微软目前正在开发两种代码并行化途径：PLINQ（Pararllel Linq，很大程度上归功于函数式语言）和最初属于 Robotics Studio 的任务并行库 (TPL)。PLINQ 的测试版可[在此处](http://www.microsoft.com/downloads/details.aspx?FamilyId=348F73FD-593D-4B3C-B055-694C50D2B0F3&displaylang=en)获得。

我会把钱放在 PLINQ 上，使其成为 .NET 代码自动并行化的标准。

# sql - 比较 SQL 中的两个位掩码以查看是否有任何位匹配

> ID：143712
> 
> 赞同：55
> 
> 时间：2008-09-27T14:38:05.133
> 
> 标签：sql, sql-server, tsql, bitmask

有没有办法比较 Transact-SQL 中的两个位掩码以查看是否有任何位匹配？我有一个用户表，其中包含用户所属的所有角色的位掩码，我想选择在提供的位掩码中具有*任何角色的所有用户。*所以使用下面的数据，角色位掩码 6（设计师+程序员）应该选择 Dave、Charlie 和 Susan，而不是 Nick。

```
用户表
----------
ID 用户名角色
1 戴夫 6
2查理2
3 苏珊 4
4 尼克 1

角色表
------------
身份角色
1 名管理员
2 程序员
4 设计师
```

有任何想法吗？谢谢。

* * *

## 回答 #1

> 赞同：93
> 
> 时间：2012-02-13T15:36:36.120

您的问题的答案是`&`像这样使用 Bitwise：

```
SELECT * FROM UserTable WHERE Roles & 6 != 0 
```

可以将`6`其交换为您想要检查任何用户是否拥有这些位中的一个或多个位的任何组合。在尝试验证这一点时，我通常发现以二进​​制形式将其写出来很有帮助。您的用户表如下所示：

```
 1   2   4
------------------
Dave    0   1   1
Charlie 0   1   0
Susan   0   0   1   
Nick    1   0   0 
```

你的测试（6）是这个

```
 1   2   4
------------------
Test    0   1   1 
```

如果我们通过每个人做 bitwaise 并且针对测试我们得到这些：

```
 1   2   4
------------------
Dave    0   1   1   
Test    0   1   1
Result  0   1   1 (6)

Charlie 0   1   0
Test    0   1   1
Result  0   1   0 (2)

Susan   0   0   1
Test    0   1   1
Result  0   0   1 (4)

Nick    1   0   0
Test    0   1   1
Result  0   0   0 (0) 
```

以上应证明结果不为零的任何记录都具有一个或多个请求的标志。

编辑：这是您想要检查的测试用例

```
with test (id, username, roles)
AS
(
    SELECT 1,'Dave',6
    UNION SELECT 2,'Charlie',2
    UNION SELECT 3,'Susan',4
    UNION SELECT 4,'Nick',1
)
select * from test where (roles & 6) != 0  // returns dave, charlie & susan 
```

或者

```
select * from test where (roles & 2) != 0 // returns Dave & Charlie 
```

或者

```
select * from test where (roles & 7) != 0 // returns dave, charlie, susan & nick 
```

* * *

## 回答 #2

> 赞同：6
> 
> 时间：2008-09-27T14:41:22.613

使用 Transact-SQL[按位与运算符](http://msdn.microsoft.com/en-us/library/ms174965.aspx)“&”并将结果与​​零进行比较。更好的是，不要将角色编码为整数列的位，而是使用布尔列，每个角色一个。那么您的查询将只是设计师和程序员友好的。如果您希望角色在应用程序的整个生命周期中发生很大变化，则使用多对多表来映射用户与其角色之间的关联。这两种选择都比依赖于按位与运算符的存在更具可移植性。

* * *

## 回答 #3

> 赞同：5
> 
> 时间：2012-02-13T14:59:04.043

```
SELECT * FROM UserTable WHERE Roles & 6 > 0 
```

* * *

## 回答 #4

> 赞同：2
> 
> 时间：2010-08-24T22:28:13.943

SELECT * FROM table WHERE mask1 & mask2 > 0

* * *

## 回答 #5

> 赞同：2
> 
> 时间：2010-08-24T23:21:08.533

例子：

```
DECLARE @Mask int
SET @Mask = 6

DECLARE @Users TABLE
(
ID int,
Username varchar(50),
Roles int
)

INSERT INTO @Users (ID, Username, Roles) 
SELECT 1, 'Dave', 6
UNION
SELECT 2, 'Charlie', 2
UNION
SELECT 3, 'Susan', 4
UNION
SELECT 4, 'Nick', 1

SELECT * FROM @Users WHERE Roles & @Mask > 0 
```

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2008-09-27T16:08:34.247

要查找所有程序员，请使用：

```
SELECT * FROM UserTable WHERE Roles & 2 = 2 
```

# python - Python中的“字符串”和“字符串”有什么区别吗？

> ID：143714
> 
> 赞同：71
> 
> 时间：2008-09-27T14:39:01.980
> 
> 标签：python, string, quotes, double-quotes

在 PHP 中，将解析包含在“双引号”中的字符串以查找要替换的变量，而包含在“单引号”中的字符串则不会。在 Python 中，这是否也适用？

* * *

## 回答 #1

> 赞同：119
> 
> 时间：2008-09-27T14:41:59.103

[否](http://docs.python.org/reference/lexical_analysis.html#strings)：

> ### 2.4.1。字符串和字节文字
> 
> ...用简单的英语：两种类型的文字都可以用匹配的单引号 ( `'`) 或双引号 ( `"`) 括起来。它们也可以包含在三个单引号或双引号的匹配组中（这些通常称为三引号字符串）。反斜杠 ( `\`) 字符用于转义具有特殊含义的字符，例如换行符、反斜杠本身或引号字符...

* * *

## 回答 #2

> 赞同：42
> 
> 时间：2008-09-27T14:45:21.217

Python 是少数 (?) 语言之一，其中 ' 和 " 具有相同的功能。我的选择通常取决于里面的内容。如果我要引用一个包含单引号的字符串，我将使用双引号反之亦然，以减少必须转义字符串中的字符。

例子：

```
"this doesn't require escaping the single quote"
'she said "quoting is easy in python"' 
```

这记录在 python 文档的“字符串文字”页面上：

*   [http://docs.python.org/2/reference/lexical_analysis.html#string-literals](http://docs.python.org/2/reference/lexical_analysis.html#string-literals) (2.x)
*   [http://docs.python.org/3/reference/lexical_analysis.html#string-and-bytes-literals](http://docs.python.org/3/reference/lexical_analysis.html#string-and-bytes-literals) (3.x)

* * *

## 回答 #3

> 赞同：8
> 
> 时间：2008-09-27T14:58:26.490

在其他一些语言中，如果您使用单引号，则不会解释元字符。以 Ruby 中的这个例子为例：

```
irb(main):001:0> puts "string1\nstring2"
string1
string2
=> nil
irb(main):002:0> puts 'string1\nstring2'
string1\nstring2
=> nil 
```

在 Python 中，如果您希望字符串按字面意思理解，您可以使用原始字符串（以 'r' 字符开头的字符串）：

```
>>> print 'string1\nstring2'
string1
string2
>>> print r'string1\nstring2'
string1\nstring2 
```

* * *

## 回答 #4

> 赞同：5
> 
> 时间：2008-09-27T14:55:07.107

Python 中的单引号和双引号字符串是相同的。唯一的区别是单引号字符串可以包含未转义的双引号字符，反之亦然。例如：

```
'a "quoted" word'
"another 'quoted' word" 
```

再说一次，有三引号字符串，它允许引号字符和换行符都被转义。

您可以使用命名说明符和 locals() 内置函数替换字符串中的变量：

```
name = 'John'
lastname = 'Smith'
print 'My name is %(name)s %(lastname)s' % locals()  # prints 'My name is John Smith' 
```

* * *

## 回答 #5

> 赞同：5
> 
> 时间：2016-01-03T11:25:18.527

交互式 Python 解释器更喜欢单引号：

```
>>> "text"
'text'

>>> 'text'
'text' 
```

这可能会让初学者感到困惑，所以我会坚持使用单引号（除非你有不同的编码标准）。

* * *

## 回答 #6

> 赞同：4
> 
> 时间：2016-03-15T09:46:16.417

" 和 ' 字符串引用之间的区别只是在样式上 - 除了一个消除了在字符串内容中转义另一个的需要。

## 风格

[PEP8](http://www.python.org/dev/peps/pep-0008/)建议使用一致的规则，[PEP257](http://www.python.org/dev/peps/pep-0257/)建议文档字符串使用三重双引号。

> 在 Python 中，单引号字符串和双引号字符串是一样的。本 PEP 不对此提出建议。选择一个规则并坚持下去。但是，当字符串包含单引号或双引号字符时，请使用另一个字符以避免字符串中出现反斜杠。它提高了可读性。
> 
> 对于三引号字符串，始终使用双引号字符以与 PEP 257 中的文档字符串约定保持一致。

然而，广泛使用的是对自然语言字符串（包括插值）更喜欢双引号的做法 - 因此任何可能成为 I18N 候选者的东西。以及用于技术字符串的单引号：符号、字符、路径、命令行选项、技术正则表达式……

（例如，在为 I18N 准备代码时，我运行了一个半自动 REGEX 快速转换双引号字符串以使用 eg `gettext`）

* * *

## 回答 #7

> 赞同：1
> 
> 时间：2008-09-27T14:43:38.617

有 3 种方法可以在 python 中引用字符串： "string" 'string' """ string string """ 它们都产生相同的结果。

* * *

## 回答 #8

> 赞同：0
> 
> 时间：2008-09-27T14:46:11.090

Python 没有区别，您可以在生成 XML 时真正利用它来发挥自己的优势。正确的 XML 语法需要在属性值周围加上双引号，并且在许多语言（例如 Java）中，这会迫使您在创建如下字符串时转义它们：

```
String HtmlInJava = "<body bgcolor=\"Pink\">" 
```

但在 Python 中，您只需使用另一个引号并确保使用匹配的结束引号，如下所示：

```
html_in_python = '<body bgcolor="Pink">' 
```

很不错吧？您还可以使用三个双引号来开始和结束多行字符串，包括 EOL，如下所示：

```
multiline_python_string = """
This is a multi-line Python string which contains line breaks in the 
resulting string variable, so this string has a '\n' after the word
'resulting' and the first word 'word'.""" 
```

* * *

## 回答 #9

> 赞同：-3
> 
> 时间：2014-08-27T12:29:50.050

是的。那些声称单引号和双引号在 Python 中相同的人是完全错误的。

否则，在下面的代码中，双引号字符串不会多花 4.5% 的时间让 Python 处理：

```
import time

time_single = 0
time_double = 0

for i in range(10000000):
    # String Using Single Quotes
    time1 = time.time()
    str_single1 = 'Somewhere over the rainbow dreams come true'
    str_single2 = str_single1
    time2 = time.time()
    time_elapsed = time2 - time1
    time_single += time_elapsed

    # String Using Double Quotes 
    time3 = time.time()
    str_double1 = "Somewhere over the rainbow dreams come true"
    str_double2 = str_double1
    time4 = time.time()
    time_elapsed = time4 - time3
    time_double += time_elapsed

print 'Time using single quotes: ' + str(time_single)
print 'Time using double quotes: ' + str(time_double) 
```

输出：

```
>python_quotes_test.py
Time using single quotes: 13.9079978466
Time using double quotes: 14.5360121727 
```

因此，如果您想要在您似乎了解您的东西的地方快速清洁可敬的代码，请在可行的情况下对字符串使用单引号。通过跳过 shift 键，您也将消耗更少的能量。

# wpf - 如何访问带有白色的 MessageBox？

> ID：143736
> 
> 赞同：4
> 
> 时间：2008-09-27T14:48:51.973
> 
> 标签：wpf, testing, integration-testing, white-framework

我在 WPF 应用程序中有一个简单的消息框，如下所示：

```
private void Button_Click(object sender, RoutedEventArgs e)
{
   MessageBox.Show("Howdy", "Howdy");
} 
```

我可以得到[白色](http://www.codeplex.com/white "白色的")来单击我的按钮并启动消息框。

UISpy 将它显示为我的窗口的子窗口，我无法找出访问它的方法。

如何访问我的 MessageBox 以验证其内容？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2008-09-27T15:04:37.833

找到了！窗口类有一个 MessageBox 方法可以解决问题：

```
 var app = Application.Launch(@"c:\ApplicationPath.exe");
        var window = app.GetWindow("Window1");
        var helloButton = window.Get<Button>("Hello");
        Assert.IsNotNull(helloButton);
        helloButton.Click();
        var messageBox = window.MessageBox("Howdy");
        Assert.IsNotNull(messageBox); 
```

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2012-12-02T15:36:55.547

请试试这个

```
 Window messageBox = window.MessageBox("");
       var label = messageBox.Get<Label>(SearchCriteria.Indexed(0));
       Assert.AreEqual("Hello",label.Text); 
```

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-08-06T10:37:46.377

White 源代码中包含一些 UI 测试项目（用于测试 White 本身）。

其中一项测试包括 MessageBox 测试，其中包括获取显示消息的方法。

```
[TestFixture, WinFormCategory, WPFCategory]
public class MessageBoxTest : ControlsActionTest
{
    [Test]
    public void CloseMessageBoxTest()
    {
        window.Get<Button>("buttonLaunchesMessageBox").Click();
        Window messageBox = window.MessageBox("Close Me");
        var label = window.Get<Label>("65535");
        Assert.AreEqual("Close Me", label.Text);
        messageBox.Close();
    }

    [Test]
    public void ClickButtonOnMessageBox()
    {
        window.Get<Button>("buttonLaunchesMessageBox").Click();
        Window messageBox = window.MessageBox("Close Me");
        messageBox.Get<Button>(SearchCriteria.ByText("OK")).Click();
    }
} 
```

显然，用于显示文本消息的标签归显示消息框的窗口所有，其主要标识是最大单词值（65535）。

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2016-02-05T08:14:32.367

window.MessageBox() 是一个很好的解决方案！

**但是如果没有出现**消息框，这个方法会**卡很久**。有时我想检查消息框（*警告、错误等*）的“**未出现”。**所以我写了一个方法来通过线程设置timeOut。

 *****```
[TestMethod]
public void TestMethod()
{
    // arrange
    var app = Application.Launch(@"c:\ApplicationPath.exe");
    var targetWindow = app.GetWindow("Window1");
    Button button = targetWindow.Get<Button>("Button");

    // act
    button.Click();        

    var actual = GetMessageBox(targetWindow, "Application Error", 1000L);

    // assert
    Assert.IsNotNull(actual); // I want to see the messagebox appears.
    // Assert.IsNull(actual); // I don't want to see the messagebox apears.
}

private void GetMessageBox(Window targetWindow, string title, long timeOutInMillisecond)
{
    Window window = null ;

    Thread t = new Thread(delegate()
    {
        window = targetWindow.MessageBox(title);
    });
    t.Start();

    long l = CurrentTimeMillis();
    while (CurrentTimeMillis() - l <= timeOutInMillsecond) { }

    if (window == null)
        t.Abort();

    return window;
}

public static class DateTimeUtil
{
    private static DateTime Jan1st1970 = new DateTime(1970, 1, 1, 0, 0, 0, DateTimeKind.Utc);
    public static long currentTimeMillis()
    {
        return (long)((DateTime.UtcNow - Jan1st1970).TotalMilliseconds);
    }
} 
```

# c - 字体图形例程

> ID：143739
> 
> 赞同：1
> 
> 时间：2008-09-27T14:50:44.620
> 
> 标签：c, fonts, embedded, rendering

你怎么做自己的字体？我不想要重量级算法（freetype、truetype、adobe 等），并且可以使用预渲染的位图字体。

我确实想要抗锯齿，如果可能的话，我想要比例字体。

我听说我可以使用 Gimp 进行渲染（进行一些后期处理？）

我正在开发带有 LCD 的嵌入式设备。它有一个 32 位处理器，但我不想运行 Linux（矫枉过正 - 太多的代码/数据空间，而我会使用的功能太少）

C. 必要时使用 C++，但首选 C。算法和想法/概念在任何语言中都很好......

-亚当

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2008-09-27T15:25:54.880

在我以前的演示场景中，我经常在一张大的位图图像中绘制字体中的所有字符。在代码中，我存储了字体中每个字符的 (X,Y) 坐标，以及每个字符的宽度。整个字体的高度通常是恒定的。如果空间不是问题，您可以将所有字符放在一个网格中，即 - 每个字符的左上角之间的距离恒定。

然后，渲染文本变成了一次将一个字母复制到目标位置的问题。那时，我通常保留一种颜色作为“透明”颜色，但今天你绝对可以为此使用 alpha 通道。

可用于小型黑白字体的一种更简单的方法是直接在代码中定义字符：

```
LetterA  db 01111100b
         db 11000110b
         db 11000110b
         db 11111110b
         db 11000110b
         db 11000110b 
```

XPM 文件格式实际上是一种具有 C 语法的文件格式，可以用作存储字符的混合解决方案。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2008-09-27T15:41:10.567

预渲染位图字体可能是要走的路。使用任何东西渲染您的字体，将字符排列在网格中，并将图像保存为简单的未压缩格式，如 PPM、BMP 或 TGA。如果您想要抗锯齿，请确保使用支持透明度的格式（BMP 和 TGA 支持；PPM 不支持）。

为了支持比例宽度，您需要从网格中提取每个字符的宽度。没有简单的方法可以做到这一点，这取决于您如何生成网格。您可能可以编写一些简短的小程序来分析每个字符并找到最小的边界框。获得宽度数据后，将其放入包含每个字符的坐标和大小的辅助文件中。

最后，要渲染一个字符串，您查找每个字符并将其矩形从字体位图中位blit 到您的帧缓冲区，将光栅位置推进字符的宽度。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2008-09-29T15:16:00.470

我们已经成功地将 SRGP 包用于字体。我们确实使用了固定间距字体，所以我不确定它是否可以成比例的字体。

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2009-02-09T13:17:05.103

我们正在使用由 anglecode#s 位图字体生成器生成的位图字体：

[http://www.angelcode.com/products/bmfont/](http://www.angelcode.com/products/bmfont/)

这非常有用，因为它具有 XML 输出，可以轻松转换为您需要的任何数据格式。

Angel Code 的 bmfont 还为 MudFont 的旧替代品添加了字距调整和更好的包装。

# asp-classic - 重构“包含文件地狱”

> ID：143745
> 
> 赞同：5
> 
> 时间：2008-09-27T14:53:47.297
> 
> 标签：asp-classic, vbscript, refactoring

在 ASP 经典项目的代码库上加快速度确实让生活变得困难的一件事是包含文件的情况有点混乱。我有时会发现我正在寻找的函数包含在一个完全不相关的包含文件中。有没有人对如何重构这个有任何建议，这样如果他们需要找到一个函数，就可以更容易地知道它在哪里？

**编辑：**我忘了问一件事：vbscript 是否有任何机制来防止文件被包含两次？有点像 C 中的#ifndef？

* * *

## 回答 #1

> 赞同：14
> 
> 时间：2008-09-27T15:19:59.340

在接管一个经典的 ASP 应用程序时，您可以做一些基本的事情，但您可能最终会后悔这样做。

1.  **消除重复的包含文件**。我见过的每个经典 ASP 应用程序都有 5 个“login.asp”页面和 7 个“datepicker.js”文件等等。查找并删除所有重复项，然后根据需要更改应用程序其余部分中的引用。删除每个文件时要小心地对每个文件进行差异检查 - 通常重复的文件会有细微的差异，因为原作者复制了它，然后只更改了副本。这对 Evolution 来说是一件好事，但对代码来说却不是。
2.  **创建一个合理**的文件夹结构并将所有文件移入其中。这个很明显，但这是你最后悔做的一个。无论应用程序中的链接是相对的还是绝对的，您都必须更改其中的大部分。
3.  **将所有包含文件合并到一个大文件**中。然后，您可以对所有函数进行逻辑重新排序，并将它们分解为单独的、合理命名的文件。然后，您必须逐页浏览应用程序并确定每个页面上的包含语句需要是什么（或坚持使用一个文件，然后将其包含在每个页面上 - 我不记得是否这在 ASP 中是个好主意）。我无法理解这里所涉及的痛苦程度，这是假设现有的包含文件没有大量使用同名全局变量。

我不会做这些。套用 Steve Yegge（我认为）的话，“**经典的 ASP 应用程序没有任何问题，但无法通过完全重写来修复**”。我对此非常认真 - 我认为在这个世界上没有比维护 ASP 应用程序更浪费程序员的时间了，而且随着 ASP 越来越过时，问题只会变得更糟。

* * *

## 回答 #2

> 赞同：10
> 
> 时间：2008-09-27T16:01:20.660

@MusiGenisis[要点](https://stackoverflow.com/questions/143745/refactoring-include-file-hell#143796)列表是很好的建议，但我不同意 -

*“我不会这样做。套用 Steve Yegge（我认为），“经典的 ASP 应用程序没有任何问题，无法通过完全重写来修复”。我对此非常认真 - 我不'认为在这个世界上没有比维护 ASP 应用程序更浪费程序员的时间了，而且随着 ASP 越来越过时，问题只会变得更糟。”*

一切都很好，但如果它是一个相当大的遗留应用程序，由于缺乏开发人员时间/资源，通常不可能进行完全重写。

我们有一个相当大的经典 ASP 应用程序，多年来它已经发展壮大起来，它并不漂亮，但它确实满足了业务需求。我们没有时间花接下来的六个月完全重写，这很好，但不可能。我们的做法是——

1.  在需要新功能的地方，它在 ASP.NET 中实现。这发生在 95% 的时间里。5% 的边缘情况通常是新应用程序代码与旧应用程序接触的大量点，需要我们进行大量经典的 ASP 返工，这可能会使应用程序更加脆弱。

2.  如果功能发生变化，我们会评估是否可以重构为 ASP.NET 而影响最小。如果这不可行，那么我们将在经典 ASP 中实现更改，并在进行过程中整理现有代码，例如简化包含文件嵌套，用更跨浏览器友好的代码替换 javascript，诸如此类。

在回答您关于#ifndef 的问题时，恐怕没有等价物。

* * *

## 回答 #3

> 赞同：3
> 
> 时间：2008-09-29T11:49:41.277

1.  将一个文件用于全局标题并包含（让我们将其命名为 t-head.asp）。此文件包含在所有 asp 文件中。
2.  使用一个文件来制作站点的可视全局标题（徽标、菜单等）并将其包含在 . 让我们称之为 t-begin.asp
3.  使用一个文件使站点可视化全局页脚（版权、谷歌分析等）并关闭在 t-begin.asp 中打开的所有 div 或表。让我们将此文件称为 t-end.asp
4.  使用一个文件夹来放置业务逻辑文件，称为 BUS。此文件夹中的文件不能包含包含。文件中的每个函数都必须以逻辑单元的名称开头（即：products.asp中的所有函数必须以product_*开头）
5.  使用一个文件夹来放置一些称为 UI 的重复使用的 UI 代码。此文件夹中的文件不能包含包含。

例子：

```
<%@  Language=VBScript %>
<% Option Explicit %>
<% Response.Buffer = true%>
<html>
<head>
<!--#include file="../general/t-head.asp"-->
<!--#include file="../bus/product.asp"-->
<title>Products page</title>
</head>
<body>
<!--#include file="../general/t-begin.asp"-->

   <% 'all your code  %>

<!--#include file="../general/t-end.asp"--> 
</body>
</html> 
```

* * *

## 回答 #4

> 赞同：2
> 
> 时间：2008-09-29T09:44:35.463

哇。有多少人讨厌 ASP，这经常让我感到惊讶。在体面的人手中，它是设计 Web 应用程序的完美语言。

但是，我承认在 ASP 中管理包含文件的方式可能有点让人头疼——因为（取决于您如何使用它们）即使您没有使用包含的一半函数，也必须加载和解析它们之内。

我倾向于有一个包含文件（`initialise.asp`或类似文件），它本身包含指向多个函数库（或类似）的链接`lib_http.asp`，`lib_mssql.asp`并且所有库函数都是自包含的，因此不必担心交叉变量。任何全局变量都在主文件中声明和设置。这意味着我可以在任何地方、任何时间使用一个函数，而不必担心它是在哪里定义的，它只是为了使用而存在。当您发现对您不认识的函数的调用时，诸如 Visual Studio 和 Primalscript 之类的 IDE 能够“跳转到定义”。

然后，在调用此主包含文件之后，任何特定于脚本的包含都包含在脚本中。

我承认这是一种需要大量内存的方法，因为所有库中的所有函数都是针对每个脚本调用进行编译的，因此该方法需要针对您开发的每个站点进行改进——决定通过主包含调用什么以及更多页面-具体的。能够只加载您需要的内容会很好——但这是 DLL 方法，不适用于大多数实际开发，而且您必须权衡编译小脚本与编译小脚本的处理器成本加载组件。

简洁的目录结构是必需的，并且易于开发，但遍历现有站点中的所有代码并更改任何链接或 mappath 调用可能是一件苦差事。另外，请注意，某些 IIS 管理员不允许`'..\'`通过 VBScript 遍历目录的方法，因此所有文件引用都必须是绝对路径。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2008-09-27T15:08:53.220

我认为您应该考虑将您的代码从 ASP VBScript 移动到 Visual Basic COM DLL。这会让你有太多的包含。

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2008-10-01T03:02:13.683

除了收到错误消息外，我不知道有什么方法可以防止双重包含。您是否看到整个页面都放置了包含，这使得它们难以被发现？

顺便说一句，您是否在开发服务器上使用代码和数据库的副本？根据我的经验，要做的第一件事是尽快将自己与实时站点分开。虽然最初很麻烦，但它可以让您自由地进行更改而不会弄乱实时站点。在包含和 BAM 中进行微小的更改很容易！整个网站宕机。

我已经完成了一些您描述的项目，并使用了以下策略：

完全重写 - 有时间/金钱时完美，但通常当出现问题并且需要尽快得到结果时我会接到电话。

Smaller projects - I open up everything in the IDE and just start searching all the project files for the functions/sub, in order to build a knowledge of the include logic. Pretty much each time, everything is spread out everywhere, so I start rebuilding the includes organized by business logic. I've also run across inline code (raw code, not subs or functions) thrown into an include, so I'll usually just pull the code back into the page for refactoring later.

Larger projects - I'll use some code I have laying around to parse the includes for lines with sub/function headers and dump those to a text file to build up a list of what routines are where and refer to that. This comes in handy when you've got a ton of includes on each page and can't get your head around the codebase.

# c++ - 对于在 C++ 中找不到异常，您会怎么想？

> ID：143746
> 
> 赞同：12
> 
> 时间：2008-09-27T14:53:58.327
> 
> 标签：c++, exception, containers, usagepatterns

我知道大多数人认为这是一种*不好的做法*，但是当您试图使您的类公共接口仅与引用一起使用时，将指针保留在内部并且仅在必要时，我认为没有办法返回告诉您正在寻找的值的东西容器中不存在。

```
班级名单{
    上市：
        值 &get(键入键);
};

```

假设您不想在类的公共接口中看到危险的指针，在这种情况下如何返回未找到，抛出异常？

你对此有何看法？您是否返回一个空*值*并检查它的空状态？我实际上使用了 throw 方法，但我介绍了一种检查方法：

```
班级名单{
   上市：
      布尔存在（类型键）；
      值 &get(键入键);
};

```

因此，当我忘记首先检查该值是否存在时，我会得到一个异常，这确实是一个*异常*。

你会怎么做？

* * *

## 回答 #1

> 赞同：16
> 
> 时间：2008-09-27T15:12:10.043

The STL deals with this situation by using iterators. For example, the std::map class has a similar function:

```
iterator find( const key_type& key ); 
```

If the key isn't found, it returns 'end()'. You may want to use this iterator approach, or to use some sort of wrapper for your return value.

* * *

## 回答 #2

> 赞同：6
> 
> 时间：2008-09-27T21:16:01.793

正确答案（根据 Alexandrescu）是：

# `Optional`并执行

首先，一定要使用 Accessor，但要以更安全的方式使用，而无需发明轮子：

```
boost::optional<X> get_X_if_possible(); 
```

然后创建一个`enforce`助手：

```
template <class T, class E>
T& enforce(boost::optional<T>& opt, E e = std::runtime_error("enforce failed"))
{
    if(!opt)
    {
        throw e;
    }

    return *opt;
}

// and an overload for T const & 
```

这样，根据缺少值的含义，您可以明确检查：

```
if(boost::optional<X> maybe_x = get_X_if_possible())
{
    X& x = *maybe_x;

    // use x
}
else
{
    oops("Hey, we got no x again!");
} 
```

或隐含地：

```
X& x = enforce(get_X_if_possible());

// use x 
```

当您关心效率或想要在故障发生的地方处理故障时，您会使用第一种方法。第二种方式适用于所有其他情况。

* * *

## 回答 #3

> 赞同：5
> 
> 时间：2008-09-27T15:21:04.377

**Don't** use an exception in such a case. C++ has a nontrivial performance overhead for such exceptions, *even if no exception is thrown*, and it additially makes reasoning about the code much harder (cf. exception safety).

Best-practice in C++ is one of the two following ways. Both get used in the STL:

*   As Martin pointed out, return an iterator. Actually, your iterator can well be a `typedef` for a simple pointer, there's nothing speaking against it; in fact, since this is consistent with the STL, you could even argue that this way is superior to returning a reference.
*   Return a `std::pair<bool, yourvalue>`. This makes it impossible to modify the value, though, since a copycon of the `pair` is called which doesn't work with referende members.

### /EDIT:

This answer has spawned quite some controversy, visible from the comments and not so visible from the many downvotes it got. I've found this rather surprising.

This answer was never meant as the ultimate point of reference. The “correct” answer had already been given by Martin: execeptions reflect the behaviour in this case rather poorly. It's semantically more meaningful to use some other signalling mechanism than exceptions.

Fine. I completely endorse this view. No need to mention it once again. Instead, I wanted to give an additional facet to the answers. While minor speed boosts should never be the first rationale for any decision-making, they can provide further arguments and in some (few) cases, they may even be crucial.

Actually, I've mentioned two facets: performance and exception safety. I believe the latter to be rather uncontroversial. While it's extremely hard to give strong exceptions guarantees (the strongest, of course, being “nothrow”), I believe it's essential: any code that is guaranteed to not throw exceptions makes the whole program easier to reason about. Many C++ experts emphasize this (e.g. Scott Meyers in item 29 of “Effective C++”).

About speed. Martin York has pointed out that this no longer applies in modern compilers. I respectfully disagree. The C++ language makes it necessary for the environment to keep track, at runtime, of code paths that may be unwound in the case of an exception. Now, this overhead isn't really all that big (and it's quite easy to verify this). “nontrivial” in my above text may have been too strong.

However, I find it important to draw the distinction between languages like C++ and many modern, “managed” languages like C#. The latter has *no* additional overhead as long as no exception is thrown because the information necessary to unwind the stack is kept anyway. By and large, stand by my choice of words.

* * *

## 回答 #4

> 赞同：5
> 
> 时间：2008-09-27T15:43:59.577

The problem with exists() is that you'll end up searching twice for things that do exist (first check if it's in there, then find it again). This is inefficient, particularly if (as its name of "list" suggests) your container is one where searching is O(n).

Sure, you could do some internal caching to avoid the double search, but then your implementation gets messier, your class becomes less general (since you've optimised for a particular case), and it probably won't be exception-safe or thread-safe.

* * *

## 回答 #5

> 赞同：2
> 
> 时间：2008-09-27T19:02:06.827

## STL 迭代器？

摆在我面前的“迭代器”想法很有趣，但迭代器的真正意义在于通过容器导航。不是一个简单的访问器。

如果您的访问器是众多访问器之一，那么迭代器就是您要走的路，因为您将能够使用它们在容器中移动。但是，如果您的访问器是一个简单的 getter，能够返回**value或****没有 value**的事实，那么您的迭代器可能只是一个美化的指针......

这导致我们...

## 智能指针？

智能指针的重点是简化指针所有权。使用共享指针，您将获得一个共享的资源（内存），代价是开销（共享指针需要分配一个整数作为引用计数器......）。

您必须选择：您的值已经在共享指针中，然后，您可以返回此共享指针（或弱指针）。或者您的值在原始指针内。然后您可以返回行指针。**如果您的资源尚未在共享指针中，则您不想返回共享指针：**当您的共享指针超出范围并在不告诉您的情况下删除您的值时，将会发生很多有趣的事情......

:-p

## 指针？

如果您的接口清楚地知道其资源的所有权，并且返回的值可以是 NULL，那么您可以返回一个简单的原始指针。如果您的代码的用户足够愚蠢，可以忽略对象的接口契约，或者用您的指针进行算术运算或其他任何操作，那么他/她将足够愚蠢以破坏您选择返回值的任何其他方式，所以智障者不要打扰...

## 未定义值

除非您的 Value 类型确实已经具有某种“未定义”值，并且用户知道这一点并愿意接受处理，否则它是一种可能的解决方案，类似于指针或迭代器解决方案。

但是不要**因为**您提出的问题而在您的 Value 类中添加“未定义”值：您最终会将“引用与指针”之战提升到另一个疯狂程度。代码用户希望您提供给他们的对象要么正常，要么不存在。必须测试该对象仍然有效的所有其他代码行是一种痛苦，并且会因您的错而使用户代码变得无用地复杂化。

## 例外

例外通常不像某些人希望的那样昂贵。但是对于一个简单的访问器，如果您的访问器经常使用，成本可能不是微不足道的。

例如，STL std::vector 有两个通过索引访问其值的访问器：

```
T & std::vector::operator[]( /* index */ ) 
```

和：

```
T & std::vector::at( /* index */ ) 
```

不同之处**`[]`**在于*是非投掷*。因此，如果您在向量范围之外进行访问，则您只能靠自己，可能会冒着内存损坏的风险，并且迟早会崩溃。所以，你真的应该确保你使用它验证了代码。

另一方面，**`at`**是*投掷*。这意味着如果您在向量范围之外访问，那么您将得到一个干净的异常。如果您想将错误处理委托给另一个代码，则此方法会更好。

**`[]`**当我访问循环内的值或类似的东西时，我会使用personnaly 。当我感觉到异常时，我使用**`at`**是返回当前代码（或调用代码）出错事实的好方法。

## 所以呢？

在您的情况下，您必须选择：

如果您真的需要闪电般的快速访问，那么投掷访问器可能是个问题。但这意味着您已经在代码上使用了分析器来确定这是一个瓶颈，不是吗？

;-)

如果您知道没有值可能经常发生，并且/或者您希望您的客户端将可能的空/无效/任何语义指针传播到访问的值，然后返回一个指针（如果您的值在一个简单的指针内）或弱/共享指针（如果您的值由共享指针拥有）。

但是，如果您认为客户端不会传播此“空”值，或者他们不应该在其代码中传播 NULL 指针（或智能指针），那么请使用受异常保护的引用。添加一个返回布尔值的“hasValue”方法，并在用户尝试获取值时添加一个抛出，即使没有。

最后但同样重要的是，考虑对象用户将使用的代码：

```
// If you want your user to have this kind of code, then choose either
// pointer or smart pointer solution
void doSomething(MyClass & p_oMyClass)
{
   MyValue * pValue = p_oMyClass.getValue() ;

   if(pValue != NULL)
   {
      // Etc.
   }
}

MyValue * doSomethingElseAndReturnValue(MyClass & p_oMyClass)
{
   MyValue * pValue = p_oMyClass.getValue() ;

   if(pValue != NULL)
   {
      // Etc.
   }

   return pValue ;
}

// ==========================================================

// If you want your user to have this kind of code, then choose the
// throwing reference solution
void doSomething(MyClass & p_oMyClass)
{
   if(p_oMyClass.hasValue())
   {
      MyValue & oValue = p_oMyClass.getValue() ;
   }
} 
```

因此，如果您的主要问题是在上述两个用户代码之间进行选择，那么您的问题不在于性能，而在于“代码人机工程学”。因此，不应因为潜在的性能问题而搁置异常解决方案。

:-)

* * *

## 回答 #6

> 赞同：2
> 
> 时间：2008-09-27T20:37:35.583

# 访问者？

> 摆在我面前的“迭代器”想法很有趣，但迭代器的真正意义在于通过容器导航。不是一个简单的访问器。

我同意**paercebal**的观点，迭代器就是*迭代*。我不喜欢 STL 的做法。但是访问器的想法似乎更有吸引力。那么我们需要什么？一个类似容器的类，感觉就像一个用于测试的布尔值，但行为类似于原始返回类型。这对于演员表操作员来说是可行的。

```
模板 <T> 类访问器 {
    上市：
        访问器（）：_value（NULL）
        {}

        存取器(T &value): _value(&value)
        {}

        运算符 T &() 常量
        {
            如果（！_值）
               throw Exception("这是个问题，你在某处犯了错误。");
            别的
               返回 *_value;
        }

        运算符 bool () 常量
        {
            返回_值！= NULL；
        }

    私人的：
        T *_值；
};

```

现在，有什么可预见的问题吗？一个示例用法：

```
访问器 <type> value = list.get(key);

如果（值）{
   类型 &v = 值；

   v.doSomething();
}

```

* * *

## 回答 #7

> 赞同：1
> 
> 时间：2008-09-27T15:19:16.797

How about returning a shared_ptr as the result. This can be null if the item wasn't found. It works like a pointer, but it will take care of releasing the object for you.

* * *

## 回答 #8

> 赞同：1
> 
> 时间：2008-09-28T05:04:24.473

*（我意识到这并不总是正确的答案，而且我的语气有点强烈，但在决定其他更复杂的选择之前，您**应该考虑这个问题）：***

那么，返回指针有什么问题呢？

我在 SQL 中多次看到过这种情况，人们会竭尽全力从不处理 NULL 列，就像他们有一些传染性的死亡或其他东西一样。相反，他们巧妙地提出了一个“空白”或“不存在”的人工值，例如 -1、9999 甚至类似“@X-EMPTY-X@”。

我的回答：该语言已经有一个“不存在”的结构；去吧，不要害怕使用它。

* * *

## 回答 #9

> 赞同：0
> 
> 时间：2008-09-27T15:02:26.620

在这种情况下我更喜欢做的是抛出“get”，对于那些性能很重要或失败很常见的情况，有一个“tryGet”函数，类似于“bool tryGet（type key，value **pp）” whoose合同是，如果返回 true，则 *pp == 指向某个对象的有效指针，否则 *pp 为空。

* * *

## 回答 #10

> 赞同：0
> 
> 时间：2008-09-27T21:33:48.910

@aradtke，你说。

> 我同意 paercebal 的观点，迭代器就是迭代。我不喜欢 STL 的做法。但是访问器的想法似乎更有吸引力。那么我们需要什么？一个类似容器的类，感觉就像一个用于测试的布尔值，但行为类似于原始返回类型。这对于演员表操作员来说是可行的。[..] 现在，有什么可预见的问题吗？

首先，您不需要操作员布尔值。有关更多信息，请参阅[安全布尔成语](http://www.artima.com/cppsource/safebool2.html)。但是关于你的问题...

这就是问题所在，用户现在需要在案例中显式转换。类指针[代理](http://en.wikipedia.org/wiki/Proxy_pattern)（例如迭代器、引用计数的指针和原始指针）具有简洁的“get”语法。如果调用者必须使用额外的代码调用它，则提供转换运算符不是很有用。

从您的参考示例开始，最简洁的编写方式：

```
// 'reference' style, check before use
if (Accessor<type> value = list.get(key)) {
   type &v = value;
   v.doSomething();
}
// or
if (Accessor<type> value = list.get(key)) {
   static_cast<type&>(value).doSomething();
} 
```

这没关系，不要误会我的意思，但它比它必须的更冗长。现在考虑我们是否*知道*，由于某种原因， list.get 会成功。然后：

```
// 'reference' style, skip check 
type &v = list.get(key);
v.doSomething();
// or
static_cast<type&>(list.get(key)).doSomething(); 
```

现在让我们回到迭代器/指针行为：

```
// 'pointer' style, check before use
if (Accessor<type> value = list.get(key)) {
   value->doSomething();
}

// 'pointer' style, skip check 
list.get(key)->doSomething(); 
```

两者都非常好，但指针/迭代器语法只是有点短。你可以给'reference'风格一个成员函数'get（）'......但这已经是operator*（）和operator->（）的用途。

“指针”样式的访问器现在具有运算符“未指定的布尔值”、运算符* 和运算符->。

猜猜看……原始指针满足这些要求，因此对于原型设计，list.get() 返回 T* 而不是 Accessor。然后等list的设计稳定了，就可以回来写Accessor，一种指针式的[Proxy](http://en.wikipedia.org/wiki/Proxy_pattern)类型。

* * *

## 回答 #11

> 赞同：-6
> 
> 时间：2008-09-27T15:01:20.397

有趣的问题。我猜想在 C++ 中专门使用引用是一个问题——在 Java 中，引用更加灵活并且可以为空。我不记得强制使用空引用是否合法 C++：

```
MyType *pObj = nullptr;
return *pObj 
```

但我认为这很危险。再次在 Java 中，我会抛出一个异常，因为这在其中很常见，但我很少看到在 C++ 中如此自由地使用异常。如果我正在为可重用的 C++ 组件创建一个公共 API 并且必须返回一个引用，我想我会走异常路线。我真正的偏好是让 API 返回一个指针；我认为指针是 C++ 的一个组成部分。

# javascript - 是否可以通过 JavaScript 触发链接（或任何元素）的点击事件？

> ID：143747
> 
> 赞同：46
> 
> 时间：2008-09-27T14:54:36.717
> 
> 标签：javascript

我正在编写一些需要触发`click`链接事件的 JavaScript 代码。在 Internet Explorer 中，我可以做到这一点

```
var button = document.getElementById('myButton');
button.click(); 
```

但这在 Firefox 中不起作用，我假设任何其他浏览器。在 Firefox 中，我已经这样做了

```
var button = document.getElementById('myButton');
window.location = button.href; 
```

我觉得这不是最好的方法。有没有更好的方法来触发`click`事件？最好是不管元素类型或浏览器如何都可以工作的东西。

* * *

## 回答 #1

> 赞同：73
> 
> 时间：2008-09-27T15:05:56.237

[http://jehiah.cz/archive/firing-javascript-events-properly](http://jehiah.cz/archive/firing-javascript-events-properly)

```
function fireEvent(element,event) {
   if (document.createEvent) {
       // dispatch for firefox + others
       var evt = document.createEvent("HTMLEvents");
       evt.initEvent(event, true, true ); // event type,bubbling,cancelable
       return !element.dispatchEvent(evt);
   } else {
       // dispatch for IE
       var evt = document.createEventObject();
       return element.fireEvent('on'+event,evt)
   }
} 
```

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2008-09-28T06:46:32.747

我不推荐它，但您可以调用 HTML 元素的 onclick 属性作为方法。

```
<a id="my-link" href="#" onclick="alert('Hello world');">My link</a>

document.getElementById('my-link').onclick(); 
```

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2008-09-27T15:00:20.883

通常不可能，afaik，mozilla 具有[click()](http://developer.mozilla.org/En/DOM:element.click#1028373)方法，但仅适用于输入元素，而不适用于链接。

为什么不创建一个按钮将在 onClick 处理程序上调用的函数，并且每当您想“单击”按钮时调用该函数呢？

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2008-09-27T15:03:22.157

Mozilla 对允许的 JS 动作/事件有更严格的政策——我在 click() 事件上也遇到了类似的问题。它在某些元素上被禁用以防止 XSS。

重定向浏览器有什么问题？这在任何地方都有效。

* * *

## 回答 #5

> 赞同：-1
> 
> 时间：2009-09-16T20:40:31.023

嘿，我不是要挖掘一个旧线程 - 但我也在寻找同样问题的答案，并找到了 jQuery 1.3x 的新功能（我遇到了 Ajax 加载内容的问题）

这是我实现它的方式：

HTML

```
<a class="navlink" href="mypage.html">Online Estimate</a> 
```

加载脚本

```
$(".pagelink").click(function(){
    $(".navlink[href="+$(this).attr("href")+"]").trigger('click');
    return false;
}); 
```

加载的 HTML

```
<a class="pagelink" href="mypage.html">Online Estimate</a> 
```

该功能是“触发事件”...
更多详细信息：http: [//docs.jquery.com/Events/trigger#eventdata](http://docs.jquery.com/Events/trigger#eventdata)

* * *

## 回答 #6

> 赞同：-1
> 
> 时间：2010-08-29T01:21:36.353

我正在拼命寻找这个，最简单的似乎可以工作！

```
document.getElementById('foo').onclick(); 
```

它在 chrome 7.0.5 和 8.0.6 中工作

# mysql - MySQL和数据文件加密

> ID：143750
> 
> 赞同：15
> 
> 时间：2008-09-27T14:55:55.903
> 
> 标签：mysql, encryption

有没有办法加密mysql使用的数据文件？我在一台开放的机器上有一个 mysql 服务器，我想加密数据文件，所以即使有人复制数据文件，他们也无法读取数据。

谢谢

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2009-10-12T00:10:43.900

**对于任何研究用于 Linux**的透明 MySQL 加密解决方案的人，我们一直在使用的块上有一个相对较新的产品： [http ://www.gazzang.com/](http://www.gazzang.com/)

我不隶属于 Gazzang... 只是一个快乐的客户。

* * *

## 回答 #2

> 赞同：5
> 
> 时间：2008-09-27T15:31:35.350

MySQL 本身不支持数据文件加密。那里有第 3 种产品，例如：

[http://www.vormetric.com/products/vormetric_database_encryption_expert.html](http://www.vormetric.com/products/vormetric_database_encryption_expert.html)

这里有关于该主题的“白皮书”：

[http://www.vormetric.com/documents/FINALPart2DatabaseEncryptionCoreGuardvsColumnLevelWhitePaper7.pdf](http://www.vormetric.com/documents/FINALPart2DatabaseEncryptionCoreGuardvsColumnLevelWhitePaper7.pdf)

老实说，如果数据库内容具有任何商业价值或包含有关个人的个人数据，您应该真正控制谁可以访问数据文件（无论是否加密）。在英国，将此类数据文件对不经意的路人开放，将是一种数据保护。

* * *

## 回答 #3

> 赞同：5
> 
> 时间：2008-09-28T21:36:57.177

当您说您的机器已打开时，我不确定您是什么意思。如果人们可以访问控制台或您的帐户，则加密文件的任务要困难得多。

你看过[Truecrypt](http://en.wikipedia.org/wiki/TrueCrypt)吗？它适用于大多数流行的操作系统，并允许创建虚拟加密分区、锁定硬盘分区、外部驱动器或 USB 设备。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2008-09-27T15:30:40.390

您可以使用加密文件系统，例如 Windows 上 NTFS 的本机文件系统或 linux 的各种[选项](http://www.linux.com/feature/52820)之一。此外，您可以存储加密的数据。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2014-02-18T06:42:27.280

如果您使用 Windows EFS 并将 MySQL 作为服务启动，则需要执行以下操作：

*   转到服务并找到 MySQL 服务
*   停止服务
*   右键单击-> 属性-> 登录选项卡
*   检查“此帐户”
*   填写您的 Windows 帐户名称，例如。“。\用户名”
*   提供您的密码
*   启动服务

MySQL 服务现在应该可以正常启动了。

要使用 Windows EFS 加密：

[http://windows.microsoft.com/en-us/windows/encrypt-decrypt-folder-file#1TC=windows-7](http://windows.microsoft.com/en-us/windows/encrypt-decrypt-folder-file#1TC=windows-7)

阅读更多关于它的信息：

[http://www.petri.co.il/how_does_efs_work.htm#](http://www.petri.co.il/how_does_efs_work.htm#)

！！！不要忘记导出证书！！！

* * *

## 回答 #6

> 赞同：-2
> 
> 时间：2008-09-27T15:00:54.253

您可以使用内置的加密功能加密 mysql 中的数据。

至于文件，任何文件解决方案都应该可以正常工作。

# sql - PostgreSQL - 重命名数据库

> ID：143756
> 
> 赞同：152
> 
> 时间：2008-09-27T15:00:40.523
> 
> 标签：sql, postgresql

我需要重命名数据库，但是当我这样做时 `PGAdmin : ALTER DATABASE "databaseName" RENAME TO "databaseNameOld"`告诉我它不能。

我该怎么做？

（**WindowsXP 上 8.3 版**）

**更新**

*   第一条错误消息：无法，因为我已连接到它。所以我选择了另一个数据库并进行了查询。

*   我收到第二条错误消息，告诉我它已经连接到用户。我在`PGAdmin`屏幕上看到它有很多`PID`，但它们是不活动的……我不知道如何杀死它们。

* * *

## 回答 #1

> 赞同：210
> 
> 时间：2008-09-27T15:03:27.477

尝试不引用数据库名称：

```
ALTER DATABASE people RENAME TO customers; 
```

还要确保当时没有其他客户端连接到数据库。最后，尝试发布它返回的错误消息，以便我们获得更多信息。

* * *

## 回答 #2

> 赞同：100
> 
> 时间：2011-10-06T18:43:49.377

为了将来参考，您应该能够：

```
-- disconnect from the database to be renamed
\c postgres

-- force disconnect all other clients from the database to be renamed
SELECT pg_terminate_backend( pid )
FROM pg_stat_activity
WHERE pid <> pg_backend_pid( )
    AND datname = 'name of database';

-- rename the database (it should now have zero clients)
ALTER DATABASE "name of database" RENAME TO "new name of database"; 
```

请注意，表`pg_stat_activity`列在 9.2 之前的版本中`pid`被命名`procpid`。因此，如果您的 PostgreSQL 版本低于 9.2，请`procpid`使用`pid`.

* * *

## 回答 #3

> 赞同：7
> 
> 时间：2013-08-25T15:29:14.900

我刚遇到这个，下面是有效的：

1)`pgAdmin`是会议之一。改为使用`psql`。
2) 停止`pgBouncer`Windows 上的和/或调度程序服务，因为这些服务也会创建会话

* * *

## 回答 #4

> 赞同：3
> 
> 时间：2008-09-27T15:16:02.733

Unexist told me in comment to restart the database and it works! Restarting the database kill all existing connection and then I connect to an other database and was able to rename it with my initial query.

Thx all.

* * *

## 回答 #5

> 赞同：3
> 
> 时间：2008-09-27T15:43:10.470

Instead of deploying a nuke (restarting the server) you should try to close those connections that bother you either by finding where are they from and shutting down the client processes or by using the [`pg_cancel_backend()`](http://www.postgresql.org/docs/current/static/functions-admin.html#FUNCTIONS-ADMIN-SIGNAL-TABLE) function.

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2020-03-06T05:03:19.017

对于使用 DBeaver 遇到此问题并收到如下错误消息的任何人：

```
ERROR: database "my_stubborn_db" is being accessed by other users
  Detail: There is 1 other session using the database. 
```

断开当前连接，然后使用不针对您要重命名的数据库的连接重新连接到同一台服务器。

更改活动数据库是不够的。

* * *

## 回答 #7

> 赞同：0
> 
> 时间：2021-04-05T10:49:47.350

当通过 pgadmin 连接时，默认数据库将是 postgres。

```
ALTER DATABASE postgres RENAME TO pgnew; 
```

这行不通。

您需要在 pgadmin 中右键单击服务器并将维护数据库设置为其他数据库并保存。然后重试，如果不存在其他连接，它应该可以工作。

# computer-science - 我应该阅读哪些书籍才能获得计算机科学的本科教育？

> ID：143760
> 
> 赞同：35
> 
> 时间：2008-09-27T15:02:14.390
> 
> 标签：computer-science

我一直是一个很大程度上独立的学习者，我从维基百科和各种书籍中收集我能学到的东西。但是，我担心我可能会因无意中遗漏主题和概念而使我的自我教育产生偏差。我的目标是自学相当于顶尖大学的计算机科学本科学位（不管是哪一所）。

为此，我购买并开始阅读一些学术教科书：

*   [计算机程序的结构和解释](https://rads.stackoverflow.com/amzn/click/com/0262011530)
*   [算法简介](https://rads.stackoverflow.com/amzn/click/com/0262032937)
*   [人工智能：一种现代方法](https://rads.stackoverflow.com/amzn/click/com/0137903952)

以及我在一所平庸的州立大学上过的课留下的一些教科书：

*   [计算机模拟方法简介](https://rads.stackoverflow.com/amzn/click/com/0805377581)
*   [微积分：概念和联系](https://rads.stackoverflow.com/amzn/click/com/007330929X)
*   [计算机组织和体系结构](https://rads.stackoverflow.com/amzn/click/com/0131856448)
*   [操作系统概念](https://rads.stackoverflow.com/amzn/click/com/0471694665)
*   [数据库系统第一门课程](https://rads.stackoverflow.com/amzn/click/com/013600637X)
*   [形式语言和自动机](https://rads.stackoverflow.com/amzn/click/com/0763737984)

我的问题是：

*   此系列未涵盖哪些主题？
*   有没有比这里列出的书更严谨或更透彻（甚至更容易阅读）的书？
*   有没有浪费我时间的书？
*   我应该按什么顺序阅读这些书？
*   麻省理工学院或斯坦福大学（或 UCB 或 CMU ......）本科生学到了哪些我可能会错过的知识？

*欢迎软件工程书籍，但仅限于学术研究。我知道 Code Complete 和 Pragmatic Programmer，但我正在寻找一种更具理论性的方法。谢谢！*

* * *

## 回答 #1

> 赞同：13
> 
> 时间：2008-09-27T15:07:24.457

我看到的最大的两个遗漏：

*   [龙书](http://en.wikipedia.org/wiki/Compilers:_Principles,_Techniques,_and_Tools)
*   [计算机网络](https://rads.stackoverflow.com/amzn/click/com/0130661023)

对于操作系统，我更喜欢 Tanenbaum 而不是 Silberschatz，但两者都很好：

*   [操作系统](https://rads.stackoverflow.com/amzn/click/com/0136374069)

关于订单，这将取决于您的兴趣。没有太多先决条件，编译器自动机是最明显的一个。先读自动机书，再读龙书。

我不知道您拥有的所有书籍，但我知道的那些已经足够好，所以这可能意味着其他的也不错。

您还缺少一些[逻辑](http://www.cs.rice.edu/~vardi/comp409/index.html)和[离散数学](https://rads.stackoverflow.com/amzn/click/com/0387941150)书籍。

我们不要忘记一些[数据库理论](http://oreilly.com/catalog/9780596100124/)书籍！

* * *

## 回答 #2

> 赞同：12
> 
> 时间：2008-09-27T15:09:10.240

我发现最好的方法是选择你最喜欢的大学，访问他们的网站，查看学位课程。许多大的都为每门课程出版了他们的必读读物。麻省理工学院的开放课件就是一个很好的例子。

顺便说一句，这也适用于非 CS 学位课程。

* * *

## 回答 #3

> 赞同：9
> 
> 时间：2008-09-27T15:05:53.210

[Don Knuth 的计算机编程艺术](http://www.amazon.com/s?ie=UTF8&tag=mozilla-20&index=blended&link_code=qs&field-keywords=don%20knuth&sourceid=Mozilla-search)

* * *

## 回答 #4

> 赞同：6
> 
> 时间：2009-06-08T03:34:07.687

麻省理工学院几年前推出了他们的“OpenCourseWare”计划。他们将书籍/家庭作业/讲座放在网上，因此您可以按照麻省理工学院的课程进行学习：

[http://web.mit.edu/catalogue/degre.engin.ch6.shtml](http://web.mit.edu/catalogue/degre.engin.ch6.shtml)

* * *

## 回答 #5

> 赞同：4
> 
> 时间：2008-12-20T03:53:22.020

顶尖大学的许多课程不使用教科书，因为可用的书都不够好。（我在普林斯顿接受教育，在哈佛任教 8 年。）当有人推荐一本书时，询问**这本书是否真的很好**，或者它是否只是**该领域中最好的**。

例如，在**编译器**方面，我不是“龙书”的忠实粉丝；我从不喜欢这种方法，而且当前版本已经过时了。我认为你最好读一本像 Michael Scott 的[Programming Language Pragmatics](http://www.cs.rochester.edu/~scott/pragmatics/)这样的书，虽然有点漫不经心，但它是一本很好读的书。（我从来没有教过它，所以我不能说学生们是怎么想的。）我不知道有一本关于自学者编译器构造的好书，尽管你可以看看 Cooper 和 Torczon 的[Engineering a Compiler](https://rads.stackoverflow.com/amzn/click/com/155860698X)因为它是最新的，由业内两位最优秀的编译器工程师编写。

* * *

## 回答 #6

> 赞同：3
> 
> 时间：2009-01-17T18:11:25.273

对不起，你不能用读一本书或几本书来代替四年的大学，不管书有多好。如果可以，为什么会有人上大学？

* * *

## 回答 #7

> 赞同：3
> 
> 时间：2009-01-17T18:13:15.690

首先，我不会担心它。但是如果你想要一本书来学习一些抽象的 CS 思想，我会推荐[The Turing Omnibus](https://rads.stackoverflow.com/amzn/click/com/0805071660)或[Theoretical Introduction to Programming](https://rads.stackoverflow.com/amzn/click/com/B000WEF23Y)。

如果我决定雇佣两名程序员，但两人都没有太多经验，但一名拥有 CS 学位而另一名没有，我会雇佣拥有 CS 学位的人。但是当你比较两个有十几年经验的程序员时，学历就无关紧要了。

* * *

## 回答 #8

> 赞同：3
> 
> 时间：2009-06-08T04:29:07.603

我可能无法推荐最好的书籍，但是您缺少几个重要的主题：

*   统计数据
*   线性代数
*   图论和离散数学
*   计算机图形学
*   科学计算
*   计算机网络
*   软件工程
*   数据结构

一些可能被认为更“可选”的主题可能是：

*   密码学
*   图像/图案处理和识别
*   生物信息学
*   互联网计算
*   经典物理学

* * *

## 回答 #9

> 赞同：3
> 
> 时间：2009-06-08T04:58:34.610

[计算系统的元素](http://www1.idc.ac.il/tecs/)

本书将带您从硬件设计的基础知识一直到用面向对象语言编写程序。使用模拟器，您可以构建一台完整的计算机。然后你编写一个汇编程序、一个操作系统、一个编译器（用于编译为在 VM 上运行的面向对象语言），然后是使用该语言编写的游戏。

这是很多工作，但作者已经仔细地使任务尽可能简单。您必须努力完成这一任务，但它为您提供了计算机编程的完整视角。

[您可以查看一些示例章节，也可以在此处](http://www1.idc.ac.il/tecs/plan.html)玩模拟器。

**强烈推荐！**（即使是 CS 毕业生）

* * *

## 回答 #10

> 赞同：2
> 
> 时间：2008-09-27T15:46:34.657

*   Discrete Math I & II (my private school)
*   Physics I (Missouri most state schools)
*   Statistics I
*   Cryptography(optional but I liked it)
*   OpenGL in C++ (optional but neat)
*   Systems analysis and Design(Software engineering from the business perspective. The class was so so.)

*   Ethics.

*   Networking (teaches network algorithms, bit patterns dealing with network data).

    There are **some** things that to comprehend them **require** help; not necessarily a Professor(tho they do that for a living), but maybe a friend that has taken the class or studied the field.

**Reading books on these subjects doesn't mean you know them. Doing math on the math, coding on the code, and so on is what helps you understand, and shows you know the subject in the end.**

* * *

## 回答 #11

> 赞同：2
> 
> 时间：2008-09-27T16:05:51.040

我认为您可以使用大多数其他书籍作为参考，并完全吸收[Programming Pearls](https://rads.stackoverflow.com/amzn/click/com/0201657880)。这样做会让你比我见过的 90% 的程序员更好。

* * *

## 回答 #12

> 赞同：1
> 
> 时间：2008-09-27T19:35:20.787

你还应该有一本关于通用数据库的书，而不是深入了解 Oracle、MySQL、SQL Server 等的细节。

我推荐：[数据库系统：全书](http://infolab.stanford.edu/~ullman/dscb.html)

* * *

## 回答 #13

> 赞同：1
> 
> 时间：2009-06-17T05:11:29.877

[计算机编程的概念、技术和模型](http://www.info.ucl.ac.be/~pvr/book.html)似乎对我所见过的各种高级语言编程风格和技术有最广泛的概述。

* * *

## 回答 #14

> 赞同：1
> 
> 时间：2008-09-27T15:12:37.813

I don't know how is it in the US, but in my country we study discrete mathematics and an introduction to graph theory before formal languages and automata.

Also, I don't see any book covering computer networks... why don't you try Andrew Tanenbaum's [Computer Networks](http://books.google.cl/books?id=Pd-z64SJRBAC&dq=computer+networks&pg=PP1&ots=RBONHq-Yhx&sig=5pBT20nKE0wgY6GEM8t9An79HP4&hl=es&sa=X&oi=book_result&resnum=4&ct=result)?

* * *

## 回答 #15

> 赞同：1
> 
> 时间：2008-09-27T15:12:47.983

Before anything else, read [Computer Science: a Modern Introduction](http://www.amazon.co.uk/exec/obidos/ASIN/0131659456/toothycatnet-21). This will give you a good grounding and overview of the subjects there are to pursue.

[Introduction to Algorithms](http://www.amazon.co.uk/exec/obidos/ASIN/0262531968/toothycatnet-21) is very good. For an introduction to functional programming, I recommend working through [ML for the working programmer](http://www.amazon.co.uk/exec/obidos/ASIN/052156543X/toothycatnet-21).

Areas that differentiate the computer scientist from the programmer: a grounding in discrete mathematics, a basic understanding of VLSI and systems architecture, an understanding of the basics of cryptography and security, an understanding of computability theory, an understanding of information theory.

* * *

## 回答 #16

> 赞同：1
> 
> 时间：2008-09-27T15:15:04.547

This is a pretty good list. The two topics I would definitely add to the mix are discrete math, and networks. Other topics that may be interesting to you are compilers, computer graphics, distributed operating systems. There are also cool sub-fields of AI, like computer vision and machine learning. And in order to handle all that, you definitely need linear algebra and probability.

And it goes without saying that you cannot really do computer science by just reading books. To really understand each topic, you have to do projects in it. I would also suggest looking at MIT's Open Courseware, where professors post syllabus, lecture notes, and assignments.

* * *

## 回答 #17

> 赞同：1
> 
> 时间：2008-09-27T16:05:52.023

具体数学

* * *

## 回答 #18

> 赞同：0
> 
> 时间：2010-10-14T13:34:00.943

即使我在同一平面上：下班后的空闲时间学习计算机科学；这些是我现在书架上的一些书

1.  [应用 UML 和模式 - Larman](https://rads.stackoverflow.com/amzn/click/com/0131489062)
2.  [算法简介 - Cormen](https://rads.stackoverflow.com/amzn/click/com/0262033844)
3.  [离散数学及其应用 - 罗森](https://rads.stackoverflow.com/amzn/click/com/0073229725)
4.  [软件工程](https://rads.stackoverflow.com/amzn/click/com/0073375977)
5.  [UNIX 环境中的高级编程](https://rads.stackoverflow.com/amzn/click/com/0321525949)

完成后将进一步更新此列表... :-)

* * *

## 回答 #19

> 赞同：0
> 
> 时间：2009-06-08T04:12:17.980

我会将[计算理论导论](https://rads.stackoverflow.com/amzn/click/com/0534950973)添加到列表中

* * *

## 回答 #20

> 赞同：0
> 
> 时间：2008-09-27T15:50:30.607

Books on Professional Software Development covering how software projects work, different methodologies, and design patters are great. Web-design knowledge is also very useful when it comes to employment.

I don't understand why you are trying to do this yourself though. Even a 'mediocre-at-best' university will be able to teach you the skills far better than you can teach yourself. It's all about meeting people who have experience actually working in the computing industry.

It's not about the university it's about the effort you put in that determines how well you do.

My answer is perhaps unhelpful to you though because I don't know where you are from. In Scotland where I live I got to go to University for free, this may not be the case for you.

* * *

## 回答 #21

> 赞同：0
> 
> 时间：2008-11-25T21:25:00.363

[文件结构：使用 C++ 的面向对象方法](https://rads.stackoverflow.com/amzn/click/com/0201874016)

很多关于块设备和文件结构的好信息，在你列出的任何书籍中都找不到。由于人们不喜欢他的代码示例，它在亚马逊上得到了一些批评性评论，但这本书的重点是教授概念，而不是提供剪切和粘贴代码示例。

还要确保获得一本关于编译器的书

* * *

## 回答 #22

> 赞同：0
> 
> 时间：2009-06-17T05:24:59.657

“四人帮”[设计模式书](https://rads.stackoverflow.com/amzn/click/com/0201633612)。我在大学上的设计模式课程可能是我上过的最有益的课程。

# algorithm - 什么是 search.twitter.com 的“热门话题”算法？

> ID：143781
> 
> 赞同：10
> 
> 时间：2008-09-27T15:11:42.120
> 
> 标签：algorithm, search, twitter, trending

twitter 使用什么算法来确定您可以在[search.twitter.com](http://search.twitter.com)上看到的 10 个主题？我想实现该算法，并且还想展示 50 个最受欢迎的主题（而不是 10 个）。你能描述一下最有效的算法吗？

谢谢！

（Twitter API 可以在[http://apiwiki.twitter.com/REST%20API%20Documentation](http://apiwiki.twitter.com/REST%20API%20Documentation)找到）

此外，我希望能够通过搜索公共时间线来实现该算法 - [http://twitter.com/statuses/public_timeline.rss](http://twitter.com/statuses/public_timeline.rss)

* * *

## 回答 #1

> 赞同：13
> 
> 时间：2011-01-19T17:04:36.550

Twitter 的趋势算法不仅仅是关键词的数量。这是其中的一部分，但还有一个衰减因素，因此“贾斯汀·比伯”不会永远成为热门话题。

quora 上的这篇文章支持了这一点。[http://www.quora.com/Trending-Topics-Twitter/What-is-the-basis-of-Twitters-current-Trending-Topics-algorithm?q=trending+algorithm](http://www.quora.com/Trending-Topics-Twitter/What-is-the-basis-of-Twitters-current-Trending-Topics-algorithm?q=trending+algorithm)

衰减通常是通过在算法中使用帖子的相对年龄来完成的，给新的主题/帖子/等更多的权重。

另请参阅[http://www.quora.com/What-tools-algorithms-or-data-structures-would-you-use-to-build-a-Trending-Topics-algorithm-for-a-high-velocity-流？q=趋势+算法](http://www.quora.com/What-tools-algorithms-or-data-structures-would-you-use-to-build-a-Trending-Topics-algorithm-for-a-high-velocity-stream?q=trending+algorithm)

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-11-03T09:36:54.567

所以 Twitter 可能做的是计算特定术语的提及次数减去停用词（停用词，如：do、me、you、i、not、on 等）所以“猫不在袋子里”和“我的dog ate my cat”意味着 cat ,dog 和 bag 将是它提取的术语（其余都是停用词）然后它将 'cat' 计为 2 个引用，因此在这种情况下 'cat' 将是一个热门话题.

# c++ - 何时通过引用传递函数参数，何时通过地址传递？

> ID：143788
> 
> 赞同：3
> 
> 时间：2008-09-27T15:16:06.573
> 
> 标签：c++, pointers, function, reference

谁能用一些例子来解释什么时候通过引用调用函数更好，什么时候通过地址调用更好？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2008-09-27T15:21:14.563

这已经讨论过了。请参阅[指针与参考](https://stackoverflow.com/questions/114180/pointer-vs-reference)。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2008-09-27T15:24:02.387

尽可能使用引用将参数传递给函数。通过引用传递参数消除了它们为 NULL 的机会。如果您希望可以将 NULL 值传递给函数，请使用指针。

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2008-09-28T00:46:12.397

一个很好的约定是：

*   只要函数可以操作（**副作用**或作为**输出**）对象，就**通过指针**传递对象。
*****   **通过 const reference**传递所有其他对象。****

 ****这使得调用者非常清楚，使用最少的文档和零性能成本，哪些参数是 const 或不是。

您也可以将其应用于原始类型，但是否需要对非输出参数使用 const 引用尚有争议，因为它们显然是按值传递的，不能以任何方式充当函数的输出（对于直接类型 - 当然不是指针/引用）。

# linux - How do I find which process is leaking memory?

> ID：143791
> 
> 赞同：27
> 
> 时间：2008-09-27T15:18:24.117
> 
> 标签：linux, ubuntu, memory-leaks

I have a system (Ubuntu) with many processes and one (or more) have a memory leak. Is there a good way to find the process that has the leak? Some of the process are JVMs, some are not. Some are home grown some are open source.

* * *

## 回答 #1

> 赞同：15
> 
> 时间：2008-09-27T15:25:27.003

You can run the `top` command (to run non-interactively, type `top -b -n 1`). To see applications which are leaking memory, look at the following columns:

*   RPRVT - resident private address space size
*   RSHRD - resident shared address space size
*   RSIZE - resident memory size
*   VPRVT - private address space size
*   VSIZE - total memory size

* * *

## 回答 #2

> 赞同：9
> 
> 时间：2008-09-29T02:28:58.600

如果程序长时间泄漏，top 可能不实用。我会编写一个简单的 shell 脚本，每隔 X 秒将“ps aux”的结果附加到文件中，具体取决于泄漏大量内存所需的时间。就像是：

```
while true
do
echo "---------------------------------" >> /tmp/mem_usage
date >> /tmp/mem_usage
ps aux >> /tmp/mem_usage
sleep 60
done 
```

* * *

## 回答 #3

> 赞同：6
> 
> 时间：2008-11-05T14:57:29.507

我建议使用 htop，作为 top 的更好替代品。

* * *

## 回答 #4

> 赞同：5
> 
> 时间：2008-09-29T17:33:08.863

如果你不能演绎地做到这一点，请考虑 Signal Flare 调试模式：将一个进程分配的内存量增加 10 倍。然后运行你的程序。

如果泄漏的内存量相同，则该进程不是泄漏源；恢复该进程并对下一个进程进行相同的修改。

当您点击负责的进程时，您会看到内存泄漏跳跃的大小（​​“信号耀斑”）。您可以通过有选择地增加此过程中单独语句的分配大小来进一步缩小范围。

* * *

## 回答 #5

> 赞同：5
> 
> 时间：2008-09-27T16:56:15.427

除了顶部，您还可以使用系统监视器（系统 - 管理 - 系统监视器，然后选择进程选项卡）。选择查看 - 所有进程，转到编辑 - 首选项并启用虚拟内存列。按此列或按内存列排序

* * *

## 回答 #6

> 赞同：4
> 
> 时间：2008-09-27T15:21:33.347

Difficult task. I would normally suggest to grab a debugger/memory profiler like [Valgrind](http://valgrind.org/) and run the programs one after one in it. Soon or later you will find the program that leaks and can tell it the devloper or fix it yourself.

* * *

## 回答 #7

> 赞同：3
> 
> 时间：2008-09-27T15:34:54.157

As suggeseted, the way to go is valgrind. It's a profiler that checks many aspects of the running performance of your application, including the usage of memory.

Running your application through Valgrind will allow you to verify if you forget to release memory allocated with malloc, if you free the same memory twice etc.

# php - 在哪里可以找到漂亮的 PHP 代码来阅读？

> ID：143792
> 
> 赞同：16
> 
> 时间：2008-09-27T15:18:55.863
> 
> 标签：php

作为一种寻找灵感和提高我的 PHP 技能的方式，我正在寻找一些漂亮的 PHP 源代码来阅读，最好是一个开源的“标准”网站，而不是像 phpMyAdmin 这样的更像工具的项目。

那么，我在哪里可以找到一些漂亮的 PHP 代码呢？

* * *

## 回答 #1

> 赞同：8
> 
> 时间：2008-09-27T15:51:38.313

并不是所有的开源项目都是如何完成的很好的例子。

看看[PEAR](http://pear.php.net)、[ezComponents](http://ezcomponents.org/)和[Zend 框架](http://framework.zend.com)。这三个都在 PHP 世界中非常流行，它们解决了大量不同的问题 [每个问题有时使用不同的方法]，并且它们都遵循很好的编码标准。

此外，在漂亮/优雅的代码和非常优化的代码之间通常需要权衡取舍。例如，如果您想查看能够运行需要处理大量流量的大型网站的代码，请查看[Mediawiki](http://www.mediawiki.org/wiki/MediaWiki)。它建立在非常高效的代码之上，但不是很漂亮。

* * *

## 回答 #2

> 赞同：8
> 
> 时间：2008-09-27T17:14:08.083

CodeIgniter 代码很漂亮。有许多用 CodeIgniter 编写的项目是公开可用的，您可以查看源代码。

查看 CodeIgniter 教程的[入门](http://codeigniter.com/user_guide/overview/getting_started.html)页面并通读。我可以保证你会受到启发并想要启动你的 IDE 并立即开始编码:)。

您也可以下载并查看[Bamboo invoice](http://bambooinvoice.org/)的源代码。当我需要灵感时，我也会在 youtube 上搜索“php 代码”:)

* * *

## 回答 #3

> 赞同：7
> 
> 时间：2008-09-27T15:44:58.313

尝试查看最好的 PHP 框架的来源 - Zend's、Symfony 和 CakePHP。它们有很好的文档记录，通常设计得很好。

* * *

## 回答 #4

> 赞同：5
> 
> 时间：2008-09-27T17:49:29.667

我会说 Kohana 和 Zend 框架。Zend 的编码标准也值得一读。

* * *

## 回答 #5

> 赞同：5
> 
> 时间：2010-05-04T10:49:06.673

PHPUnit 包含很棒的 PHP5.3 代码[http://github.com/sebastianbergmann/phpunit/tree/](http://github.com/sebastianbergmann/phpunit/tree/)

Lithium Framework 也使用了很棒的 PHP 5.3 代码[http://rad-dev.org/lithium/source](http://rad-dev.org/lithium/source)

* * *

## 回答 #6

> 赞同：4
> 
> 时间：2011-03-18T21:37:16.027

[http://fatfree.sourceforge.net/ 太小](http://fatfree.sourceforge.net/) 了，太疯狂了

[http://fuelphp.com/](http://fuelphp.com/) 非常好用

[https://github.com/auraphp](https://github.com/auraphp) Aura 提供了一些非常有趣的独立软件包

* * *

## 回答 #7

> 赞同：1
> 
> 时间：2008-09-28T17:34:33.347

[ezComponents](http://ezcomponents.org/) : 有据可查，并且有非常方便的教程。

* * *

## 回答 #8

> 赞同：1
> 
> 时间：2008-09-29T16:26:15.187

Krugle.org 是浏览代码的好地方。当然，不仅仅是 PHP。

* * *

## 回答 #9

> 赞同：0
> 
> 时间：2008-09-27T15:50:03.887

PHP.net 是一个开源网站，但并不十分漂亮——其中一些感觉很陈旧，但它可以工作并且非常安全。

[Symfony](http://www.symfony-project.org/)值得一看，[PHP.net CVS](http://cvs.php.net/)中有一些项目比网站更现代一点。

* * *

## 回答 #10

> 赞同：0
> 
> 时间：2010-05-04T10:45:47.807

看看“专家 PHP 5 工具”一书。**网上也有电子书**。

# javascript - 如何将 ScriptObjects 序列化为 JSON 以保存在 Silverlight 隔离存储中？

> ID：143793
> 
> 赞同：0
> 
> 时间：2008-09-27T15:18:58.687
> 
> 标签：javascript, silverlight, json, isolatedstorage

根据这篇文章[Silverlight 2 Beta 2](http://msdn.microsoft.com/en-us/library/cc197951(VS.95).aspx)支持该`DataContractJsonSerializer`对象。但是，当我尝试使用它时，VS 说

> “未定义类型‘DataContractJsonSerializer’”。

我有一个标记为 ScriptableMember 的方法，它从 JavaScript 调用并传递一个对象。在此方法中，我需要将对象序列化为字符串（最好是 JSON），然后将其保存在独立存储中。

Silverlight 2 Beta 2 真的支持 DataContractJsonSerializer 吗？或者有人会推荐另一种将 JavaScript 创建的 ScriptObject 保存在独立存储中的方法吗？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2008-09-28T04:09:48.553

实际上答案是，DataContractJsonSerializer 是 Silverlight 2 Beta 2 的一部分，但您需要在 Silverlight 项目中添加对 System.ServiceModel.Web 的引用才能使用它。

我没有意识到您仍然需要在 Silverlight 中添加 dll 引用。我认为它以与 ASP.NET 类似的方式自动包含所有内容。

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2008-09-29T07:52:48.367

有一个 Silverlight 版本的 Json.NET 可以将您的对象序列化为 JSON。它不需要所有对象的 [DataContract] 和 [DataMember] 属性。

[json.net](http://james.newtonking.com/projects/json-net.aspx)

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2008-09-27T15:34:22.533

目前，我发现的唯一解决方案是使用 ASP.NET AJAX JavaScriptSerializer 在 JavaScript 中进行 JSON 序列化/反序列化，然后使用 Silverlight 存储/检索结果字符串。

```
Sys.Serialization.JavaScriptSerializer.serialize(obj);
Sys.Serialization.JavaScriptSerializer.deserialize(json); 
```

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2008-09-27T23:11:25.400

我会说你自己的答案将是最好的方法。JavaScript 在做这样的事情上非常慢，所以最好将序列化部分留给 ASP.NET。

# c++ - 如何在 VS2005 中提高大型 C++ 应用程序的链接性能

> ID：143808
> 
> 赞同：25
> 
> 时间：2008-09-27T15:24:26.880
> 
> 标签：c++, visual-studio-2005

我们有相当大的 C++ 应用程序，它在 Visual Studio 2005 中由大约 60 个项目组成。目前在发布模式下链接需要 7 分钟，我想尽量减少时间。有什么改善链接时间的技巧吗？

大多数项目都编译成静态库，这使得测试更容易，因为每个项目都有一组相关的单元测试。似乎静态库的使用阻止了 VS2005 使用增量链接，因此即使打开了增量链接，它每次都会执行完整链接。

对子项目使用 DLL 会有什么不同吗？我真的不想浏览所有标题并添加宏来导出符号（即使使用脚本），但如果它可以减少 7 分钟的链接时间，我肯定会考虑它。

由于某种原因，从命令行使用 nmake 会稍微快一些，并且在 Linux（使用 GCC）上链接相同的应用程序要快得多。

*   Visual Studio IDE 7 分钟
*   从命令行使用 nmake 的 Visual C++ - 5 分钟
*   Linux 上的 GCC 34 秒

* * *

## 回答 #1

> 赞同：19
> 
> 时间：2008-09-28T06:54:48.483

如果您使用该[`/GL`](http://msdn.microsoft.com/en-us/library/0zza0de8.aspx)标志来启用整体程序优化 (WPO) 或使用该[`/LTCG`](http://msdn.microsoft.com/en-us/library/xbf3tbeh.aspx)标志来启用链接时间代码生成，关闭它们将显着改善链接时间，但会牺牲一些优化。

此外，如果您使用该[`/Z7`](http://msdn.microsoft.com/en-us/library/958x11bc.aspx)标志将调试符号放入`.obj`文件中，则您的静态库可能很大。如果它阻止链接器从磁盘读取所有调试符号，则使用[`/Zi`](http://msdn.microsoft.com/en-us/library/958x11bc.aspx)创建单独的文件可能会有所帮助。`.pdb`我不确定它是否真的有帮助，因为我没有对它进行基准测试。

* * *

## 回答 #2

> 赞同：13
> 
> 时间：2009-11-20T19:31:13.383

请参阅我在 Microsoft 提出的建议：[https ://connect.microsoft.com/VisualStudio/feedback/ViewFeedback.aspx?FeedbackID=511300](https://connect.microsoft.com/VisualStudio/feedback/ViewFeedback.aspx?FeedbackID=511300)

你应该投票给它！这是我对它的最后评论：

是的，我们正在使用增量链接来构建我们的大部分项目。对于最大的项目，它是没有用的。事实上，使用增量链接将这些项目链接起来需要更多时间（2min50 与 2min44 相比）。我们观察到当 ILK 文件的大小很大时它不起作用（我们最大的项目在 win 32 中生成 262144 KB 的 ilk）。

贝娄，我列出了我们试图减少链接时间的其他事情：

*   显式模板实例化以减少代码膨胀。小收获。
*   IncrediLink（IncrediBuild 为编译提供了有趣的收益，但对链接几乎没有收益）。
*   删除很少调试的库的调试信息（良好的增益）。
*   在 « Pre-Build Event » 中删除 PDB 文件（奇怪的是，它给出了有趣的增益，例如：2min44 而不是 3min34）。
*   将许多静态库转换为 DLL。重要收获。
*   使用配备大量 RAM 的计算机以最大化磁盘缓存。最大的收获。
*   大 obj 与小 obj。没有不同。
*   更改项目选项（/Ob1、/INCREMENTAL、启用 COMDAT 折叠、嵌入清单等）。有些会带来有趣的收获，有些则不会。我们试图不断地最大化我们的设置。
*   最大化内部链接与外部链接。这是一个很好的编程习惯。
*   尽可能多地分离软件组件。您可以在单元测试中快速工作。但是我们仍然必须将事物交互在一起，我们有遗留代码并且我们使用第三方组件。
*   使用秘密链接器开关 /expectedoutputsize:120000000。小收获。

请注意，对于我们所有的实验，我们都仔细测量了链接时间。缓慢的链接时间会严重降低生产力。当您实现复杂的算法或跟踪困难的错误时，您希望快速迭代这个序列：修改一些代码，链接，跟踪调试，修改一些代码，链接等......

优化链接时间的另一点是它对我们的持续集成周期的影响。我们有许多共享公共代码的应用程序，并且我们正在其上运行持续集成。我们所有应用程序的链接时间是周期时间的一半（15 分钟）...

在线程[https://blogs.msdn.microsoft.com/vcblog/2009/09/10/linker-throughput/](https://blogs.msdn.microsoft.com/vcblog/2009/09/10/linker-throughput/)中，提出了一些有趣的建议来改善链接时间。在 64 位计算机上，为什么不提供完全在 RAM 中处理文件的选项？

同样，欢迎任何可以帮助我们减少链接时间的建议。

* * *

## 回答 #3

> 赞同：5
> 
> 时间：2008-09-27T15:40:21.257

通常，使用 DLL 代替静态库会大大缩短链接时间。

* * *

## 回答 #4

> 赞同：4
> 
> 时间：2008-09-27T16:01:49.723

看看Xoreax 的[Incredibuild](http://www.xoreax.com/main.htm)。它的分布式编译大大减少了我们完整的构建/链接时间，从大约 40 分钟到 8 分钟。

此外，该产品具有他们称为[Incredilink](http://www.xoreax.com/webhelp/pages/advanced_incredilink.htm)的功能，它可以帮助您获得增量链接，即使使用静态链接库也是如此。

* * *

## 回答 #5

> 赞同：2
> 
> 时间：2008-09-27T15:37:34.680

我不认为转换为 DLL 会有用。您可以尝试寻找与优化有关的选项，然后将其关闭。链接器可能会花费很长时间查看库中可以消除的冗余代码。您的应用程序最终可能会变大或变慢，但这对您来说可能不是问题。

* * *

## 回答 #6

> 赞同：2
> 
> 时间：2008-09-27T20:13:12.880

有几个人报告（我自己也注意到）在静态链接库中修改文件将禁用整个解决方案的增量链接；这似乎是您所看到的。有关这方面的一些信息，请参阅[此处](http://connect.microsoft.com/VisualStudio/feedback/ViewFeedback.aspx?FeedbackID=229545)和[此处](http://www.virtualdub.org/blog/pivot/entry.php?id=137)的评论。

一种解决方法是使用[快速解决方案构建插件](http://workspacewhiz.com/FastSolutionBuild/FastSolutionBuildReadme.html)。这可能涉及对您的工作空间进行一些更改，但回报*绝对*值得。对于商业解决方案，请使用 Xoreax 的[Incredibuild](http://www.xoreax.com/main.htm)，它基本上采用了相同的技术，但也添加了其他功能。如果我听起来像 Incredibuild 的推销员，我深表歉意——我只是一个非常满意的客户。

* * *

## 回答 #7

> 赞同：2
> 
> 时间：2008-09-28T04:05:26.300

我以前在将大型应用程序与 Visual C++ 链接时也遇到过类似的问题。就我而言，我根本没有足够的可用 RAM 并且过多的磁盘分页导致链接过程停止。将我的内存从 1GB 翻倍到 2GB 取得了显着的进步。你的开发箱运行了多少？

* * *

## 回答 #8

> 赞同：2
> 
> 时间：2009-10-26T00:30:30.050

我刚刚发现我们偶然在一个头文件中定义了一个大的字符串表，它几乎包含在每个（静态）库中。（我说的是一个巨大的 C++ 项目。）当链接器创建 EXE 时，它看起来像是表格的统一（EXE 中只有一个结尾）或库的解析需要很长时间。将表放在一个单独的 C++ 文件中需要花费几分钟在相对较慢的机器上的链接。

不幸的是，除了偶然之外，我不知道如何找到类似的东西。

* * *

## 回答 #9

> 赞同：2
> 
> 时间：2009-11-17T12:56:43.240

对于调试版本，可以使用增量链接，这可以大大缩短链接时间。

可悲的是，有一些陷阱，VS2005 不会警告你。

*   如果使用静态库，那么在修改静态库的文件部分时增量链接将不起作用。解决方案是将链接器选项“使用库依赖输入”设置为“是”（这与VS2003中的快速解决方案构建相同）

*   如果使用 pragma-comment-lib 包含 DLL 的 lib，并指定相对路径而不是单独的 lib，则增量链接将停止工作。解决方案是单独指定 lib，并使用链接器选项 LIBPATH 添加额外的 lib-path。

*   有时 .ilk 文件会损坏（超过 200 MB），然后增量链接器会突然占用正常时间的 10 倍以上。有时它会抱怨 .ilk 文件已损坏，但通常会在几分钟后首先出现。我的解决方案是为“构建事件”->“预链接事件”设置以下命令

    对于 ($(IntDir)*.ilk) 中的 %%f 执行 (如果 "%%~zf" GTR "200000000" (del %%f))

* * *

## 回答 #10

> 赞同：1
> 
> 时间：2008-09-27T15:30:19.330

60 个要链接的库听起来确实很少。这可能是一个极端的措施，但它可能会从根本上加快速度。创建一个包含几个项目的新解决方案，并将现有项目中的所有源代码添加到这些项目中。然后构建并链接它们，只保留小的用于测试。

* * *

## 回答 #11

> 赞同：1
> 
> 时间：2008-09-27T15:34:10.490

获得一台速度更快的具有多个处理器的计算机并启用并行构建（这可能默认情况下处于启用状态）。为了允许最大程度的并行，请确保您的项目依赖项是正确的，并且您没有不必要的依赖项。

* * *

## 回答 #12

> 赞同：1
> 
> 时间：2008-09-28T00:29:22.107

如果您真的在谈论链接时间，那么快速解决方案构建和 Xoreax 之类的东西并不会真正有多大帮助（除了可能的 Incredilink）。假设您真正测量的是链接开始到链接结束，那么我建议您拥有的库数量是问题所在。

至少在最初，链接阶段在加载所有对象和 lib 文件时是 IO 绑定的。您可能会遇到 60 个库以及一些大量 .obj 文件的主项目的情况。我怀疑您可能至少部分地看到了加载所有这些库和 .obj 文件时典型的 Windows 缓慢。

您可以轻松地对此进行测试。获取所有这些 lib 文件并构建一个单独的 lib 文件作为测试。与其链接其中的 60 个，不如链接一个，看看你的时间都花在了哪里。那会很有趣。

NTFS 是出了名的慢。在 Linux 上它不应该是 7m 对 32 秒慢，但这可能是问题的一部分。使用 DLL 会有所帮助，但您会受到应用程序启动时间的影响，尽管这不会太早。我相信您不会有 7m 的应用程序启动时间。

* * *

## 回答 #13

> 赞同：1
> 
> 时间：2008-09-28T04:08:18.510

你可以试试看这个：http: [//msdn.microsoft.com/en-us/library/9h3z1a69.aspx](http://msdn.microsoft.com/en-us/library/9h3z1a69.aspx)

基本上，如果您有多个内核，您可以并行运行项目构建。

* * *

## 回答 #14

> 赞同：1
> 
> 时间：2012-03-16T07:06:27.993

我已经解决了我的链接问题并分享给大家。

我的项目的链接时间是 7 分钟，使用 /Incremental:no 链接（链接时间 7 分钟）。

使用 /Incremental 时为 15 分钟，（链接时间 7 分钟，嵌入清单时间 7 分钟）。所以我关掉了inremental。

我发现附加依赖项也有 a.lib 并且忽略了特定的库！

所以我从忽略特定库中删除它打开/增量。第一次链接时间需要 5 分钟，但嵌入清单时间没有。

我不知道为什么，但增量链接已经奏效。

我回滚了所有项目代码，所以我可以通过库找到问题。如果你做到了以上所有，你可以试试我的方法。祝你好运！

* * *

## 回答 #15

> 赞同：0
> 
> 时间：2012-03-22T17:27:33.557

C++ 构建时间减少的第 1 步是更多的内存。从 4GB 切换到 12GB 后，我看到我的链接所有项目的时间一落千丈：从 5:50 到 1:15。

# language-agnostic - What are some good strategies to allow deployed applications to be hotfixable?

> ID：143814
> 
> 赞同：10
> 
> 时间：2008-09-27T15:27:47.620
> 
> 标签：language-agnostic, deployment, maintenance

In an ideal world, our development processes would be perfect, resulting in regular releases that were so thoroughly tested that it would never be necessary to "hotfix" a running application.

But, unfortunately, we live in the real world, and sometimes bugs slip past us and don't rear their ugly heads until we're already busy coding away at the next release. And the bug needs to be fixed ***Now***. Not as a part of the next scheduled release. Not tonight when the traffic dies down. ***Now***.

How do you deal with this need? It really can run counter to good design practices, like refactoring your code into nice, discrete class libraries.

Hand-editing markup and stored procedures on a production server can be a recipe for disaster, but it can also avert disaster.

What are some good strategies for application design and deployment techniques to find a balance between maintenance needs and good coding practices?

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2008-09-27T15:42:32.437

[Even though we test a lot before we release, ] What we do is this:

Our SVN looks like this:

```
/repo/trunk/
/repo/tags/1.1
/repo/tags/1.2
/repo/tags/1.3 
```

Now whenever we release, we create a tag which we eventually check out in production. Before we do production, we do staging which is [less servers but] pretty much the same as production.

Reasons to create a "tag" include that some of the settings of our app in production code are slightly different (e.g. no errors are emailed, but logged) from "trunk" anyway, so it makes sense to create the tag and commit those changes. And then checkout on the production cluster.

Now whenever we need to *hotfix* an issue, we fix it in tags/x first and then we `svn update` from the tag and are good. Sometimes we go through staging, with some issues (e.g. minor/trivial fixes like spelling) we by-pass staging.

The only thing to remember is to apply all patches from `tags/x` to `trunk`.

If you have more than one server, [Capistrano](http://www.capify.org/) is extremely helpful to run all those operations.

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2008-09-27T15:51:03.150

One strategy is to heavily use declarative-style external configuration files for the different components.

Examples of this:

*   Database access/object-relational mapping via a tool like [IBatis/IBatis.NET](http://ibatis.apache.org/)
*   Logging via a tool like [JLog](http://jlog.org/)/[NLog](http://www.nlog-project.org/)
*   Dependency injection via a tool like [Spring](http://www.springframework.org/)/[Spring.NET](http://www.springframework.net/)

In this way, you can often keep key components separated into discrete parts, hotfix a running application without recompile, and seamlessly use source control (particularly in comparison to stored procedures, which usually require manual effort to source control).

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2008-09-27T16:18:13.567

我们将代码分为框架代码和业务定制。业务定制类使用单独的类加载器加载，我们有工具可以将更改提交到正在运行的生产实例。每当我们需要对任何类进行更改时，我们都会对其进行更改并将其提交给正在运行的实例。正在运行的实例将拒绝旧的类加载器并使用新的类加载器实例再次加载类。这类似于 EJB 的 Jboss 热部署。

# javascript - 确定 HTML 元素的内容是否溢出

> ID：143815
> 
> 赞同：152
> 
> 时间：2008-09-27T15:29:46.070
> 
> 标签：javascript, html, css

如果 HTML 元素溢出其内容，我可以使用 JavaScript 检查（不考虑滚动条）吗？例如，一个小而固定大小的长 div，溢出属性设置为可见，并且元素上没有滚动条。

* * *

## 回答 #1

> 赞同：240
> 
> 时间：2008-09-27T15:55:03.500

通常，您可以比较`client[Height|Width]`with`scroll[Height|Width]`以检测到这一点……但是当溢出可见时，这些值将是相同的。因此，检测例程必须考虑到这一点：

```
// Determines if the passed element is overflowing its bounds,
// either vertically or horizontally.
// Will temporarily modify the "overflow" style to detect this
// if necessary.
function checkOverflow(el)
{
   var curOverflow = el.style.overflow;

   if ( !curOverflow || curOverflow === "visible" )
      el.style.overflow = "hidden";

   var isOverflowing = el.clientWidth < el.scrollWidth 
      || el.clientHeight < el.scrollHeight;

   el.style.overflow = curOverflow;

   return isOverflowing;
} 
```

在 FF3、FF40.0.2、IE6、Chrome 0.2.149.30 中测试。

* * *

## 回答 #2

> 赞同：15
> 
> 时间：2008-09-27T15:37:20.453

尝试比较`element.scrollHeight`/`element.scrollWidth`到`element.offsetHeight`/`element.offsetWidth`

[http://developer.mozilla.org/en/DOM/element.offsetWidth](http://developer.mozilla.org/en/DOM/element.offsetWidth)
[http://developer.mozilla.org/en/DOM/element.offsetHeight](http://developer.mozilla.org/en/DOM/element.offsetHeight)
[http://developer.mozilla.org/en/DOM/element。 scrollWidth](http://developer.mozilla.org/en/DOM/element.scrollWidth)
[http://developer.mozilla.org/en/DOM/element.scrollHeight](http://developer.mozilla.org/en/DOM/element.scrollHeight)

* * *

## 回答 #3

> 赞同：3
> 
> 时间：2020-06-08T23:21:16.107

另一种方法是将元素宽度与其父元素的宽度进行比较：

```
function checkOverflow(elem) {
    const elemWidth = elem.getBoundingClientRect().width
    const parentWidth = elem.parentElement.getBoundingClientRect().width

    return elemWidth > parentWidth
} 
```

* * *

## 回答 #4

> 赞同：2
> 
> 时间：2015-04-17T02:17:03.173

我认为这个答案并不完美。有时即使文本溢出，scrollWidth/clientWidth/offsetWidth 也是相同的。

这适用于 Chrome，但不适用于 IE 和 Firefox。

最后，我尝试了这个答案：[HTML text-overflow ellipsis detection](https://stackoverflow.com/questions/7738117/html-text-overflow-ellipsis-detection)

它很完美，在任何地方都能很好地工作。所以我选择了这个，也许你可以试试，不会让你失望的。

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2019-06-05T16:11:53.073

使用 jQuery，您可以：

```
if ( $(".inner-element").prop('scrollHeight') > $(".inner-element").height() ) {

    console.log("element is overflowing");

} else {

    console.log("element is not overflowing");

} 
```

如果需要，请`.prop('scrollWidth')`更改为。`.width()`

* * *

## 回答 #6

> 赞同：-3
> 
> 时间：2016-05-24T23:43:48.793

这是一个 javascript 解决方案（使用 Mootools），它将减小字体大小以适应 elHeader 的边界。

```
while (elHeader.clientWidth < elHeader.scrollWidth || elHeader.clientHeight < elHeader.scrollHeight) {
  var f = parseInt(elHeader.getStyle('font-size'), 10);
  f--;
  elHeader.setStyle('font-size', f + 'px');
} 
```

elHeader 的 CSS：

```
 width:100%;
    font-size:40px;
    line-height:36px;
    font-family:Arial;
    text-align:center;
    max-height:36px;
    overflow:hidden; 
```

注意 elHeader 的包装器设置了 elHeader 的宽度。

# ruby - Ruby：从字符串到ASCII的字符

> ID：143822
> 
> 赞同：33
> 
> 时间：2008-09-27T15:34:01.053
> 
> 标签：ruby, ascii

这个 wiki 页面给出了如何将单个字符转换为 ascii [http://en.wikibooks.org/wiki/Ruby_Programming/ASCII](http://en.wikibooks.org/wiki/Ruby_Programming/ASCII)

但是假设我有一个字符串并且我想从中获取每个字符的 ascii，我需要做什么？

```
"string".each_byte do |c|
      $char = c.chr
      $ascii = ?char
      puts $ascii
end 
```

它不起作用，因为它对 $ascii = ?char 行不满意

```
syntax error, unexpected '?'
      $ascii = ?char
                ^ 
```

* * *

## 回答 #1

> 赞同：56
> 
> 时间：2008-09-27T15:37:24.587

该`c`变量已经包含字符代码！

```
"string".each_byte do |c|
    puts c
end 
```

产量

```
115
116
114
105
110
103 
```

* * *

## 回答 #2

> 赞同：20
> 
> 时间：2012-03-19T16:37:00.183

```
puts "string".split('').map(&:ord).to_s 
```

* * *

## 回答 #3

> 赞同：10
> 
> 时间：2015-07-23T14:55:08.687

Ruby String 提供了`codepoints`1.9.1 之后的方法。

```
str = 'hello world'
str.codepoints.to_a
=> [104, 101, 108, 108, 111, 32, 119, 111, 114, 108, 100] 

str = "你好世界"
str.codepoints.to_a
=> [20320, 22909, 19990, 30028] 
```

* * *

## 回答 #4

> 赞同：9
> 
> 时间：2013-12-15T19:59:25.227

对单个字符使用 "x".ord，对整个字符串使用 "xyz".sum。

* * *

## 回答 #5

> 赞同：8
> 
> 时间：2010-03-03T09:50:14.090

有关 ruby​​1.9 中的更改，请参阅这篇文章[使用 `?`（问号）在 Ruby 中获取 ASCII 字符代码失败](https://stackoverflow.com/questions/1270209/getting-an-ascii-character-code-in-ruby-fails)

* * *

## 回答 #6

> 赞同：7
> 
> 时间：2015-11-13T19:31:51.837

您也可以在 each_byte 甚至更好的 String#bytes 之后调用 to_a

```
=> 'hello world'.each_byte.to_a
=> [104, 101, 108, 108, 111, 32, 119, 111, 114, 108, 100]

=> 'hello world'.bytes
=> [104, 101, 108, 108, 111, 32, 119, 111, 114, 108, 100] 
```

* * *

## 回答 #7

> 赞同：4
> 
> 时间：2009-10-13T00:53:11.363

```
"a"[0] 
```

或者

```
?a 
```

两者都将返回它们的 ASCII 等价物。

# javascript - 查找项目是否在 JavaScript 数组中的最佳方法？

> ID：143847
> 
> 赞同：819
> 
> 时间：2008-09-27T15:41:12.783
> 
> 标签：javascript, arrays

查找对象是否在数组中的最佳方法是什么？

这是我知道的最好的方法：

```
function include(arr, obj) {
  for (var i = 0; i < arr.length; i++) {
    if (arr[i] == obj) return true;
  }
}

console.log(include([1, 2, 3, 4], 3)); // true
console.log(include([1, 2, 3, 4], 6)); // undefined
```

* * *

## 回答 #1

> 赞同：754
> 
> 时间：2008-09-27T15:45:32.117

从 ECMAScript 2016 开始，您可以使用[`includes()`](https://developer.mozilla.org/en-US/docs/Web/JavaScript/Reference/Global_Objects/Array/includes)

```
arr.includes(obj); 
```

如果要支持 IE 或其他旧版浏览器：

```
function include(arr,obj) {
    return (arr.indexOf(obj) != -1);
} 
```

编辑：但这不适用于 IE6、7 或 8。如果它不存在，最好的解决方法是自己定义它：

1.  [Mozilla 的](https://developer.mozilla.org/en-US/docs/Web/JavaScript/Reference/Global_Objects/Array/indexOf)(ECMA-262) 版本：

    ```
     if (!Array.prototype.indexOf)
       {

            Array.prototype.indexOf = function(searchElement /*, fromIndex */)

         {

         "use strict";

         if (this === void 0 || this === null)
           throw new TypeError();

         var t = Object(this);
         var len = t.length >>> 0;
         if (len === 0)
           return -1;

         var n = 0;
         if (arguments.length > 0)
         {
           n = Number(arguments[1]);
           if (n !== n)
             n = 0;
           else if (n !== 0 && n !== (1 / 0) && n !== -(1 / 0))
             n = (n > 0 || -1) * Math.floor(Math.abs(n));
         }

         if (n >= len)
           return -1;

         var k = n >= 0
               ? n
               : Math.max(len - Math.abs(n), 0);

         for (; k < len; k++)
         {
           if (k in t && t[k] === searchElement)
             return k;
         }
         return -1;
       };

     } 
    ```

2.  [丹尼尔詹姆斯](https://stackoverflow.com/questions/143847/best-way-to-find-an-item-in-a-javascript-array#144172)的版本：

    ```
     if (!Array.prototype.indexOf) {
       Array.prototype.indexOf = function (obj, fromIndex) {
         if (fromIndex == null) {
             fromIndex = 0;
         } else if (fromIndex < 0) {
             fromIndex = Math.max(0, this.length + fromIndex);
         }
         for (var i = fromIndex, j = this.length; i < j; i++) {
             if (this[i] === obj)
                 return i;
         }
         return -1;
       };
     } 
    ```

3.  [公鸡酸](https://stackoverflow.com/questions/143847/best-way-to-find-an-item-in-a-javascript-array#144664)的版本：

    ```
     Array.prototype.hasObject = (
       !Array.indexOf ? function (o)
       {
         var l = this.length + 1;
         while (l -= 1)
         {
             if (this[l - 1] === o)
             {
                 return true;
             }
         }
         return false;
       } : function (o)
       {
         return (this.indexOf(o) !== -1);
       }
     ); 
    ```

* * *

## 回答 #2

> 赞同：208
> 
> 时间：2010-03-27T00:37:28.497

如果您使用的是 jQuery：

```
$.inArray(5 + 5, [ "8", "9", "10", 10 + "" ]); 
```

更多信息：[http ://api.jquery.com/jQuery.inArray/](http://api.jquery.com/jQuery.inArray/)

* * *

## 回答 #3

> 赞同：33
> 
> 时间：2008-09-27T18:10:01.660

首先，`indexOf`在没有 JavaScript 的浏览器中实现它。例如，请参阅[Erik Arvidsson 的数组 extras](http://erik.eae.net/playground/arrayextras/arrayextras.js)（还有[相关的博客文章](http://erik.eae.net/archives/2005/06/05/17.53.19/)）。然后您可以使用`indexOf`而不必担心浏览器支持。这是他的实现的稍微优化的版本`indexOf`：

```
if (!Array.prototype.indexOf) {
    Array.prototype.indexOf = function (obj, fromIndex) {
        if (fromIndex == null) {
            fromIndex = 0;
        } else if (fromIndex < 0) {
            fromIndex = Math.max(0, this.length + fromIndex);
        }
        for (var i = fromIndex, j = this.length; i < j; i++) {
            if (this[i] === obj)
                return i;
        }
        return -1;
    };
} 
```

它已更改为存储长度，因此不需要每次迭代都查找它。但差别不是很大。不太通用的功能可能会更快：

```
var include = Array.prototype.indexOf ?
    function(arr, obj) { return arr.indexOf(obj) !== -1; } :
    function(arr, obj) {
        for(var i = -1, j = arr.length; ++i < j;)
            if(arr[i] === obj) return true;
        return false;
    }; 
```

我更喜欢使用标准功能，并在真正需要时保留这种微优化。但是，如果您热衷于微优化，我将评论中与 roosterononacid 相关的[基准调整为](https://blogs.oracle.com/greimer/resource/loop-test.html)[数组中的基准搜索](http://obscurity.nfshost.com/x/bench.html)。虽然它们非常粗糙，但完整的调查将测试具有不同类型、不同长度的数组并找到出现在不同位置的对象。

* * *

## 回答 #4

> 赞同：11
> 
> 时间：2008-09-27T15:50:00.780

如果数组未排序，则实际上没有更好的方法（除了使用上面提到的 indexOf，我认为这相当于同一件事）。如果数组已排序，则可以进行二进制搜索，其工作原理如下：

1.  选择数组的中间元素。
2.  您正在寻找的元素是否比您选择的元素大？如果是这样，您已经消除了数组的下半部分。如果不是，你已经淘汰了上半部分。
3.  选择数组剩余一半的中间元素，并按照步骤 2 继续，消除剩余数组的一半。最终你要么找到你的元素，要么没有数组可以查看。

二分查找的运行时间与数组长度的对数成正比，因此它比查看每个单独的元素要快得多。

* * *

## 回答 #5

> 赞同：10
> 
> 时间：2012-02-24T18:11:04.137

**[].has(obj)**

假设`.indexOf()`已实现

```
Object.defineProperty( Array.prototype,'has',
{
    value:function(o, flag){
    if (flag === undefined) {
        return this.indexOf(o) !== -1;
    } else {   // only for raw js object
        for(var v in this) {
            if( JSON.stringify(this[v]) === JSON.stringify(o)) return true;
        }
        return false;                       
    },
    // writable:false,
    // enumerable:false
}) 
```

！！！不要这样做，`Array.prototype.has=function(){...`因为您将在每个数组中添加一个可枚举元素，并且 js 已损坏。

```
//use like          
[22 ,'a', {prop:'x'}].has(12) // false
["a","b"].has("a") //  true

[1,{a:1}].has({a:1},1) // true
[1,{a:1}].has({a:1}) // false 
```

使用第二个参数（标志）强制按值而不是参考进行比较

比较原始对象

```
[o1].has(o2,true) // true if every level value is same 
```

* * *

## 回答 #6

> 赞同：7
> 
> 时间：2008-09-27T16:28:33.807

这取决于你的目的。如果您为 Web 编程，请避免`indexOf`，Internet Explorer 6 不支持它（其中很多仍在使用！），或者有条件地使用：

```
if (yourArray.indexOf !== undefined) result = yourArray.indexOf(target);
else result = customSlowerSearch(yourArray, target); 
```

`indexOf`可能是用本机代码编码的，所以它比你在 JavaScript 中可以做的任何事情都要快（如果数组合适，二进制搜索/二分法除外）。注意：这是一个品味问题，但我会`return false;`在你的例程结束时做一个，返回一个真正的布尔值......

* * *

## 回答 #7

> 赞同：5
> 
> 时间：2008-09-27T15:51:46.860

这是给你的一些元知识 - 如果你想知道你可以用数组做什么，请查看文档 - 这是 Mozilla 的数组页面

[https://developer.mozilla.org/en-US/docs/JavaScript/Reference/Global_Objects/Array](https://developer.mozilla.org/en-US/docs/JavaScript/Reference/Global_Objects/Array)

在那里你会看到对 indexOf 的引用，它是在 Javascript 1.6 中添加的

* * *

## 回答 #8

> 赞同：4
> 
> 时间：2011-08-17T12:57:48.340

此处详细介绍了一种检查对象是否为 javascript 中的数组的可靠方法：

这是我附加到“容器”的[xa.js](http://xajs.chalmershouse.com)框架中的两个函数。`utils = {}`这些应该可以帮助您正确检测阵列。

```
var utils = {};

/**
 * utils.isArray
 *
 * Best guess if object is an array.
 */
utils.isArray = function(obj) {
     // do an instanceof check first
     if (obj instanceof Array) {
         return true;
     }
     // then check for obvious falses
     if (typeof obj !== 'object') {
         return false;
     }
     if (utils.type(obj) === 'array') {
         return true;
     }
     return false;
 };

/**
 * utils.type
 *
 * Attempt to ascertain actual object type.
 */
utils.type = function(obj) {
    if (obj === null || typeof obj === 'undefined') {
        return String (obj);
    }
    return Object.prototype.toString.call(obj)
        .replace(/\[object ([a-zA-Z]+)\]/, '$1').toLowerCase();
}; 
```

如果您想检查一个对象是否在数组中，我还将包含以下代码：

```
/**
 * Adding hasOwnProperty method if needed.
 */
if (typeof Object.prototype.hasOwnProperty !== 'function') {
    Object.prototype.hasOwnProperty = function (prop) {
        var type = utils.type(this);
        type = type.charAt(0).toUpperCase() + type.substr(1);
        return this[prop] !== undefined
            && this[prop] !== window[type].prototype[prop];
    };
} 
```

最后是这个 in_array 函数：

```
function in_array (needle, haystack, strict) {
    var key;

    if (strict) {
        for (key in haystack) {
            if (!haystack.hasOwnProperty[key]) continue;

            if (haystack[key] === needle) {
                return true;
            }
        }
    } else {
        for (key in haystack) {
            if (!haystack.hasOwnProperty[key]) continue;

            if (haystack[key] == needle) {
                return true;
            }
        }
    }

    return false;
} 
```

# c++ - 多个 C++ 线程如何在类方法上执行

> ID：143850
> 
> 赞同：2
> 
> 时间：2008-09-27T15:42:29.440
> 
> 标签：c++, multithreading

假设我们有一个 c++ 类，例如：

```
class MyClass
{
   void processArray( <an array of 255 integers> )
   {
     int i ;
     for (i=0;i<255;i++)
     {
        // do something with values in the array
     }
   }
} 
```

以及该类的一个实例，例如：

```
MyClass myInstance ; 
```

和 2 个调用该实例的 processArray 方法的线程（取决于系统如何执行线程，可能以完全不规则的顺序）。该范围内没有使用互斥锁，因此两个线程都可以进入。

**我的问题是 i 发生了什么？每个线程范围是否都有自己的“i”，或者每个进入的线程会在 for 循环中修改 i，导致 i 一直在奇怪地变化。**

* * *

## 回答 #1

> 赞同：15
> 
> 时间：2008-09-27T15:43:23.887

`i`在栈上分配。由于每个线程都有自己独立的堆栈，因此每个线程都有自己的`i`.

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2008-09-27T16:36:09.577

当心。在提供的示例中，方法**processArray**似乎是可*重入*的（不清楚在 *// 对数组中的值进行操作时发生了什么*）。如果是这样，当两个或多个线程同时调用它时不会发生竞争，因此在没有任何锁定机制的情况下调用它是安全的。**要强制执行此操作，您可以使用volatile**限定符标记实例和方法，以让用户知道不需要锁定。Andrei Alexandrescu 发表了一篇关于*volatile 限定符*以及如何使用它来编写正确的多线程类的有趣文章。文章发表在这里： [http ://www.ddj.com/cpp/184403766](http://www.ddj.com/cpp/184403766)

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2008-09-27T15:44:46.550

由于 i 是一个局部变量，它存储在线程自己的私有堆栈中。因此，您不需要使用关键部分来保护 i。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2008-09-27T15:46:53.783

正如亚当所说， i 是存储在堆栈中的变量，并且参数被传入，所以这是安全的。当您必须小心并应用互斥锁或其他同步机制时，如果您正在访问同一类实例中的共享成员变量或程序中的全局变量（甚至是作用域静态）。

# .net - 你使用代码生成工具吗？

> ID：143855
> 
> 赞同：10
> 
> 时间：2008-09-27T15:43:36.647
> 
> 标签：.net, visual-studio, code-generation

您是否使用代码生成工具（除了那些用于生成代理的工具以及内置到 Visual Studio 的设计器）？

您生成应用程序的哪些部分？

您通常使用自己的发电机吗？如果是这样，您编写什么类型的生成器（asp 模板、coddom 等）。如果没有，您使用什么 3rd 方工具？

我目前正在处理几个不同的项目，它们都使用自定义代码生成器来处理从生成数据库结构、业务实体、DAL 和 BLL 的所有内容。我很好奇其他人对这些工具的体验。

* * *

## 回答 #1

> 赞同：9
> 
> 时间：2008-09-27T18:21:58.917

我属于哲学阵营，认为代码生成器是“错误的”，因为它们表明了应该成为语言一部分的东西。

但是，编写代码来编写代码一直是实用程序员道德的重要组成部分，并且在实践中，如果生成的代码默认隐藏，则代码生成效果很好。无论你想成为多么纯粹的哲学，语言永远不会像你想要解决的问题那样快速发展。

想到在 Visual Studio 中构建 Windows 窗体时生成的代码。如果需要，您可以查看生成的代码，但最好不要。然而，使用 WPF 迁移到声明性语言更为优越，因为以编程方式操作声明性代码比命令式代码更干净、更可靠。

他们应该对 LINQ-To-SQL 类做同样的事情。他们需要一种声明性语言，用于仅具有属性且没有自定义行为的类。它可能会使这些实体类更容易动态化——当底层数据库模式更改时自动更改。

我们尝试使用 CodeSmith 为我们数据库中的所有表生成 .NetTiers 类，但遇到了两个问题：

1.  .NetTiers 臃肿，生成的代码非常庞大。我认为代码生成工具使创建feep 变得太容易了。

2.  因为模式正在积极开发和修改，我们也必须重新生成很多东西，这最终使得将所有内容都保留在源代码控制中变得非常困难，因为所有文件都在重新生成和替换。我最终不确定生成的代码是否*应该*在源代码管理中。

代码生成的最佳位置应该是在编译器或构建阶段，而不是设计阶段。当您在 C# 中使用匿名类型或方法时，编译器会即时生成代码。如果你在设计阶段生成代码，你会得到一大堆*东西*，每次底层参数改变时都必须重新生成这些东西。

* * *

## 回答 #2

> 赞同：7
> 
> 时间：2008-09-27T20:12:56.763

并不是说我们在 .net/web 域中工作，而是来自各种自制语言的自制代码生成工具是我们开发工具链的重要组成部分。我们有两个主要的此类工具（带有语法和解析器以及正式定义），以及许多基于 m4 和 perl 等宏的次要工具。它们最终都生成纯 C，它是本机编译的。

根据我的经验，特定领域的语言是任何大型软件工作中程序员生产力的关键工具之一。如果您正在构建诸如编译器、模拟器或其他非常复杂的软件，这些软件具有许多在基本语言（通常意味着可移植的 C 和有时是 C++）中根本不支持的重复模式，那么代码生成工具就是您要走的路。我将特定领域的语言视为泛化的下一步：首先将通用计算分解为函数（或历史的子例程），然后将通用函数分解为模板或泛型（如果这样的工具可用），然后再分解将更多的通用性和重复代码转化为成熟的自定义语言。

这一切都是为了减少您实际编写的代码量，并从编程过程中删除任何形式的繁琐重复和非增值代码。一旦模式重复，应用特定领域的语言！

* * *

## 回答 #3

> 赞同：5
> 
> 时间：2008-09-27T15:59:35.797

当我在做经典的 asp 工作时（大约在 2001 年），我开始使用自己的生成器（数据访问、存储过程等）。我慢慢转向 CodeSmith，因为它更容易处理。我仍然主要是为我的 .NET 代码生成所有数据访问层类型的东西（包括存储过程）。

几年前，我从宏代码生成（即 CodeSmith）跳到了微代码生成。

不同之处在于，使用 CodeSmith，我为我的应用程序生成了大量的代码，所有代码都是通用的，而且是一次性的。当更改模板的源（即表结构）时，这对于边缘情况和重新生成变得有问题。我还遇到过大量携带代码的情况，这些代码我没有使用，而是从我的模板生成的。所有这些方法都有效吗？也许，也许不是。进入并清理生成的代码将是一项巨大的工作（即在同一个代码库上工作一年多之后）。

相比之下，微代码生成允许我在我想要的正确场景中准确生成我需要的类。我用来执行此操作的主要工具是 ReSharper。我这样做的方法是在编写生产代码之前编写单元测试。在这种情况下，ReSharper 使用我的单元测试作为模板来自动生成生产代码的框架。那么这只是填补空白的问题。

对于数据访问，我不再生成任何东西。我发现一个好的 O/RM 取代了我用来放入数据访问层（即 NHibernate）的所有内容。鉴于此，我将永远不会编写或生成另一个数据访问层（我拒绝）。

此外，我还获得了拥有大型单元测试套件的好处，除此之外

* * *

## 回答 #4

> 赞同：5
> 
> 时间：2008-09-27T18:13:49.250

由于 Fog Creek Software 的内部语言 Wasabi 内置了编译时代码生成器，因此我们使用它们来自动创建映射到数据库表的实体类的主体。因此，我们可以编写一个包含十几个不同属性和方法的类，而不是编写：

```
<ActiveRecord("Kiwi")> _
Class CKiwi
End Class 
```

并且 CKiwi 将为 Kiwi 表的基础架构中定义的每一列具有 Load(ix As Int32)、Commit() 和字段/属性。它使我们不必拥有庞大的 O/RM 库，但仍然允许我们快速将表添加到我们的产品中。

* * *

## 回答 #5

> 赞同：4
> 
> 时间：2008-09-27T19:36:49.957

本着编译器精神的代码生成可能很棒。以“向导”的精神进行代码生成一律被证明是一个坏主意。

* * *

## 回答 #6

> 赞同：1
> 
> 时间：2008-09-27T15:50:44.227

我们曾经使用 CodeSmith 来生成 NHibernate hbms、实体和其他一些东西。过了一段时间，我们厌倦了这种流动，所以我们放弃了它。

T4 生成器是免费的，值得研究生成。

我们仍然使用 Castle CodeGenerator 来生成 MonoRail 链接。

* * *

## 回答 #7

> 赞同：1
> 
> 时间：2008-09-27T16:08:57.083

1.  我们使用代码生成器来处理异常
2.  为 CRUD 操作生成 DAO
3.  使用 JAXB 生成代码
4.  使用 XDoclet 生成 EJB 本地/本地接口
5.  使用 Velocity 模板为业务模型生成文档
6.  使用 Apache Axis 生成 WSDL 存根

* * *

## 回答 #8

> 赞同：1
> 
> 时间：2008-09-27T17:59:14.650

我为某些任务创建了自己的工具。从长远来看，这样做很有趣，甚至可以节省时间。对于非常乏味的任务，它甚至可以节省您的理智。

* * *

## 回答 #9

> 赞同：1
> 
> 时间：2008-09-27T19:50:28.877

自制代码生成器非常适合从包含*应*如何工作的示例的最终用户电子表格构建单元测试用例。

有关示例，请参阅[构建测试用例](http://homepage.mac.com/s_lott/iblog/architecture/C20071019092637/E20080830091128/index.html)的工具。

* * *

## 回答 #10

> 赞同：1
> 
> 时间：2008-09-27T22:28:41.820

我们使用 LLBLGen 来生成我们的数据访问层。您将生成器指向您使用的数据库，选择要使用的表，然后生成所需的类。这一切都非常快速和容易。

* * *

## 回答 #11

> 赞同：0
> 
> 时间：2008-09-27T15:54:18.353

我们有一个内部构建的代码生成器来处理数据库访问。一个人编写存储过程并在网关类中抽象出相应的方法。

我们还生成 Web 服务以正确地与 Flash 交互——即以理智的方式处理异常。

最后，我们有一个异常生成器，它消除了异常最佳实践的繁琐工作（大量的构造函数等......）

* * *

## 回答 #12

> 赞同：0
> 
> 时间：2008-09-27T15:57:23.197

在以前的雇主中，我们有一个本地开发的 VB.NET 应用程序，可以将 XML 模式定义文件 (XSD) 转换为静态 C++ 库。这使得使用 C++ 数据类型（bool、std::string 等）变得更加容易，并且所有有趣的 XML 代码都隐藏在这些生成的类中。

* * *

## 回答 #13

> 赞同：0
> 
> 时间：2008-09-27T16:04:19.250

我们刚开始在办公室使用 Grails。以前，我们有一组内部 JSF/Hibernate CRUD 生成脚本。

... Grails 获胜。Grails 的代码生成非常好，可以让您在大约 15 分钟内运行 CRUD 应用程序，而无需将代码实际放入代码文件中！

当然，当你想修改它时，它可以将实际代码生成到代码文件中。大多数情况下，对于常规 CRUD，您只需更改视图即可。

* * *

## 回答 #14

> 赞同：0
> 
> 时间：2008-09-27T16:44:29.933

我用一个来生成可序列化的数据对象，这些数据对象可以跨不同的平台（windows、linux、solaris、mac、bsd 等）进行重组。这是一个内部解决方案。

* * *

## 回答 #15

> 赞同：0
> 
> 时间：2008-09-27T17:09:09.560

我写了一个可爱的工具，在这个工具中，我为其编写了解析器的数据格式的专家可以通过 Web 表单提交他们自己的样本，查看输出，然后告诉我它是否正确。

由此，将生成一个 jUnit 测试。迷人的。

除了没有一个人愿意使用它，我也没有收集任何测试用例。

* * *

## 回答 #16

> 赞同：0
> 
> 时间：2008-09-27T19:26:33.257

像这里的其他人一样，我们也创建了自己的代码生成器（Inon Datamanager/Viewmanager），用于数据访问、HTML 表单处理和某些业务逻辑操作。使这项工作顺利进行的关键是对其进行设计，这样您就不必触摸或查看生成的代码。

通过这种方式，它几乎确实成为了语言的一部分——语言（在我们的例子中是 Java）被扩展为包括域模型规范和视图模型，然后您只需用真实的 Java 代码填充自定义业务逻辑。

这为我们提供了与分析师和业务用户沟通的正确工具，同时仍然拥有 Java 的能力来设置底层行为的细节。

* * *

## 回答 #17

> 赞同：0
> 
> 时间：2008-10-24T15:32:20.703

如果对优秀的 LLBLGEN 感兴趣，您还可以评估亚音速。甚至可以看看 Rob Conery 对亚音速和 t4 之间的任何重叠或相互作用的看法。

* * *

## 回答 #18

> 赞同：0
> 
> 时间：2013-04-20T06:37:33.920

我创建了一个自定义代码生成框架，它为多种语言（如 Java Script、Action Script、Java、C# 和 Objective C）生成 Web 服务的代理类，我不使用模板或工具，只使用普通 C# 代码生成带有一些帮助类的代码, 代码生成确实可以节省很多时间，但是我觉得生成的代码应该尽量简单，不要过度使用。

# .net - 是否有用于通用音频文件解码的 .NET 库？

> ID：143856
> 
> 赞同：8
> 
> 时间：2008-09-27T15:43:40.687
> 
> 标签：.net, audio, mono

您知道任何可以解码多种类型音频文件的 .NET 库吗？理想情况下，它应该与平台无关，因此可以在 Windows 和 *NIX 上与 .NET 和 Mono 一起使用。

我已经折磨了谷歌搜索满足我需求的图书馆，但不幸的是我找不到任何东西。所以在为 GStreamer 和朋友写很多包装类之前，我想我可以在这里问一下。:)

支持的音频文件应该（至少）

*   MP3,
*   OGG Vorbis 和
*   FLAC（可选）。

由于我需要它的应用程序只是为了好玩，因此该库应该是开源的——或者至少是免费的。此外，向用户显示的唠叨屏幕可能会很糟糕或不切实际，因为我计划将其放入服务流程中。

我需要使用这个库/这些库来解码音频文件并将一个字节 [] 传递给我的 libOFA 包装器，以便我可以为它生成一个 MusicDNS 指纹。我的实验应用程序很可能在基于 Linux 的服务器上运行。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2008-09-27T16:00:29.087

有转换音频和视频格式的[ffmpeg库和实用程序。](http://ffmpeg.mplayerhq.hu/)然后，结合[FFmpeg.NET](http://www.codeplex.com/ffmpegdotnet)库，您可以在 .NET 中进行编码/解码。支持您提到的所有格式。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2008-09-27T15:54:06.980

[FMOD Ex](http://www.fmod.org/)音响系统是一款革命性的全新音频引擎，适用于游戏开发人员、多媒体开发人员、声音设计师、音乐家和音频工程师。基于 Firelight Technologies 之前产品的多年经验，FMOD Ex 旨在推动游戏音频的功能，同时使用最少的资源并保持完全可扩展性。

FMOD 非商业许可

如果您的产品不以商业利益为目的，并且不包含用于转售、许可或其他商业分发的 FMOD 库，则可以免费使用 FMOD。是的，没错，免收许可费！

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2008-09-27T15:46:50.710

如果您正在谈论解码文件以播放它们（即用于收听），我建议您使用 Windows Media Player SDK。

它将播放任何安装了编解码器并且不花费任何费用的东西。

[http://msdn.microsoft.com/en-us/library/aa969732.aspx](http://msdn.microsoft.com/en-us/library/aa969732.aspx)

如果您想要更接近金属的东西（即用于学习），您还可以查看 Windows Media Format SDK。

[http://msdn.microsoft.com/en-us/library/aa387410.aspx](http://msdn.microsoft.com/en-us/library/aa387410.aspx)

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2008-09-27T16:08:32.890

Alvas.Audio 是我见过的唯一可以做到这一点的产品（我只是从这篇文章中了解到的）。我认为 MP3 的许可情况阻碍了实现此目的的 .NET 产品的开发。

# oracle - 将数据插入 Oracle 表的最快方法是什么？

> ID：143872
> 
> 赞同：12
> 
> 时间：2008-09-27T15:49:58.270
> 
> 标签：oracle, plsql

我正在用 PL/SQL 编写数据转换，用于处理数据并将其加载到表中。根据 PL/SQL Profiler，转换中最慢的部分之一是实际插入到目标表中。该表有一个索引。

为了准备加载数据，我使用表的行类型填充一个变量，然后将其插入到表中，如下所示：

> `insert into mytable values r_myRow;`

似乎我可以通过执行以下操作来获得性能：

*   在插入期间关闭日志记录
*   一次插入多条记录

这些方法是否可取？如果是这样，语法是什么？

* * *

## 回答 #1

> 赞同：16
> 
> 时间：2008-09-27T16:28:55.180

最好一次插入几百行，使用 PL/SQL 表和 FORALL 绑定到插入语句中。有关这方面的详细信息，请参见[此处](http://download.oracle.com/docs/cd/B19306_01/appdev.102/b14261/tuning.htm#sthref2181)。

还要注意如何构造 PL/SQL 表。如果可能的话，宁愿直接在 SQL 中使用“INSERT INTO t1 SELECT ...”进行所有转换，因为在 PL/SQL 中进行逐行操作仍然比 SQL 慢。

无论哪种情况，您也可以通过 using 使用直接路径插入`INSERT /*+APPEND*/`，这基本上绕过了 DB 缓存，直接将新块分配并写入数据文件。这也可以减少日志记录的数量，具体取决于您如何使用它。这也有一些含义，所以请先阅读[精美的手册](http://download.oracle.com/docs/cd/B19306_01/server.102/b14231/tables.htm#ADMIN01509)。

最后，如果您要截断并重建表，那么首先删除（或标记为不可用）然后重建索引可能是值得的。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2008-09-27T15:58:38.497

常规插入语句是在表中获取数据的最慢方法，不适用于批量插入。以下文章引用了许多不同的技术来提高性能：[http ://www.dba-oracle.com/oracle_tips_data_load.htm](http://www.dba-oracle.com/oracle_tips_data_load.htm)

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2008-09-27T15:54:37.027

删除索引，然后插入行，然后重新创建索引。

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2008-09-27T15:58:54.690

如果删除索引的速度不够快，则需要**Oracle SQL*Loader**：

[http://www.oracle.com/technology/products/database/utilities/htdocs/sql_loader_overview.html](http://www.oracle.com/technology/products/database/utilities/htdocs/sql_loader_overview.html)

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2012-12-14T22:45:33.997

假设您参加了 eid,ename,sal,job。所以首先创建一个表：

```
SQL>create table tablename(eid number, ename varchar2(20),sal number,job char(10)); 
```

现在插入数据：-

```
SQL>insert into tablename values(&eid,'&ename',&sal,'&job'); 
```

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2008-09-27T15:58:15.270

检查此链接 [http://www.dba-oracle.com/t_optimize_insert_sql_performance.htm](http://www.dba-oracle.com/t_optimize_insert_sql_performance.htm)

1.  您的情况要考虑的要点是使用附加提示，因为这将直接附加到表中，而不是使用 freelist。如果您负担得起关闭日志记录而不是使用带有 nologging 提示的 append 来执行此操作
2.  使用批量插入而不是在 PL/SQL 中进行迭代
3.  如果您从文件提要中获取数据，请使用 sqlloaded 将数据直接加载到表中

* * *

## 回答 #7

> 赞同：0
> 
> 时间：2015-02-04T16:52:39.310

这是我对快速插入的建议。

触发器 - 禁用与表关联的任何触发器。插入完成后启用。

索引 - 删除索引并在插入完成后重新创建它。

陈旧的统计信息 - 重新分析表和索引统计信息。

索引碎片整理 - 如果需要，重建索引 使用无日志记录 - 使用 INSERT APPEND 插入（仅限 Oracle）。这种方法是非常危险的方法，不会生成重做日志，因此您不能进行回滚 - 在开始之前备份表并且不要尝试实时表。检查您的数据库是否有类似的选项

并行插入：运行并行插入将更快地完成工作。

使用批量插入约束 - 插入期间开销不大，但仍然是检查的好主意，即使在第 1 步之后它仍然很慢

[您可以在http://www.dbarepublic.com/2014/04/slow-insert.html](http://www.dbarepublic.com/2014/04/slow-insert.html)了解更多信息

* * *

## 回答 #8

> 赞同：-1
> 
> 时间：2009-03-19T14:00:33.077

也许您最好的选择之一是实际上尽可能避免使用 Oracle。我自己对此感到困惑，但 Java 进程通常可以胜过许多使用 OCI（阅读：SQL Plus）或会占用您大量时间来正确处理的 Oracle 实用程序（阅读：SQL*Loader ）。

这也不会阻止您使用特定的提示（例如 / *APPEND* /）。

每次我转向这种解决方案时，我都会感到惊喜。

干杯，

罗洛

# web-services - Java EE 和 Grails：与 Web 服务的通信？哪个框架？

> ID：143898
> 
> 赞同：3
> 
> 时间：2008-09-27T15:59:05.533
> 
> 标签：web-services, grails, jakarta-ee, remoting, ejb

嗨，我正在开发一个 Grails 应用程序，它必须与现有的 Java EE 应用程序（使用 EJB2 构建）进行通信。“旧版”应用程序和新的 Grails 应用程序都将提供服务并使用它们。

出于互兼容性的原因，我正在考虑使用 WebServices 进行通信。现在我想知道我应该在双方都使用哪些框架。

由于 Java EE 应用程序现在在 JDK5 下运行，我可以使用 JAX-WS 我想在 Grails 端使用 Metro ( [https://jax-ws-commons.dev.java.net/grails/](https://jax-ws-commons.dev.java.net/grails/) ) 是有意义的. 有没有人有这方面的经验？或者其他建议？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2008-09-27T17:35:46.283

如果 Grails 和 EJB 应用程序都存在于同一个 LAN 上，那么使用 RMI 就没有问题。它是与 EJB 对话的默认方式，是 Java 原生的，并且在 Grails 中受支持。

如果您需要使用 Web 服务，那么您的容器将内置支持将 EJB 公开为 Web 服务（假设 J2EE 1.4 或更高版本）。你用的是哪个容器？

如果您不能使用（或不信任）WS 支持的容器，那么最好选择一个您可以在两个应用程序中使用的框架，从而避免兼容性问题。Metro 独立运行对我来说效果很好，但我还没有在 Grails 上尝试过。

还有比完整的 SOAP'y Web 服务更轻量级的交换 XML 消息的方法。Hessian 和 Burlap 就是例子，另外 Spring 有自己的 HTTP 消息传递框架。

# ruby - 如何在 RSpec 中运行单个测试/规范文件？

> ID：143925
> 
> 赞同：308
> 
> 时间：2008-09-27T16:11:52.647
> 
> 标签：ruby, testing, rspec

我希望能够运行单个规范文件的测试——例如，对于我正在编辑的一个文件。 `rake spec`执行所有规范。我的项目不是 Rails 项目，所以`rake spec:doc`不起作用。

不知道这是否重要，但这是我的目录结构。

```
./耙文件
./lib
./lib/cushion.rb
./lib/靠垫
./lib/cushion/doc.rb
./lib/靠垫/db.rb
./规格
./spec/spec.opts
./spec/spec_helper.rb
./spec/db_spec.rb

```

* * *

## 回答 #1

> 赞同：420
> 
> 时间：2008-09-27T17:20:10.347

或者您可以跳过 rake 并使用“rspec”命令：

```
rspec path/to/spec/file.rb 
```

在您的情况下，我认为只要您的 ./spec/db_spec.rb 文件包含适当的帮助程序，它就应该可以正常工作。

如果您使用的是旧版本的 rspec，它是：

```
spec path/to/spec/file.rb 
```

* * *

## 回答 #2

> 赞同：207
> 
> 时间：2008-09-27T16:22:06.367

原始调用：

```
耙规格 SPEC=spec/controllers/sessions_controller_spec.rb \
          SPEC_OPTS="-e \"应该使用cookie登录\""

```

现在弄清楚如何将它嵌入到您的编辑器中。

* * *

## 回答 #3

> 赞同：134
> 
> 时间：2012-07-24T21:30:12.920

这个问题是一个老问题，但在搜索如何运行单个测试时，它会出现在 Google 的顶部。我不知道它是否是最近添加的，但是要根据规范运行单个测试，您可以执行以下操作：

```
rspec path/to/spec:<line number> 
```

其中 -line number- 是包含部分测试的行号。例如，如果您有如下规格：

```
1: 
2: it "should be awesome" do
3:   foo = 3
4:   foo.should eq(3)
5: end
6: 
```

假设它保存在 spec/models/foo_spec.rb 中。然后你会运行：

```
rspec spec/models/foo_spec.rb:2 
```

它只会运行那个规范。事实上，这个数字可以是 2 到 5 之间的任何值。

希望这可以帮助！

* * *

## 回答 #4

> 赞同：63
> 
> 时间：2011-04-15T16:37:02.747

您还可以将 *e*xample 测试用例的实际文本与`-e`!

因此对于：

```
it "shows the plane arrival time" 
```

您可以使用

```
rspec path/to/spec/file.rb -e 'shows the plane arrival time'
./scripts/spec path/to/spec/file.rb -e 'shows the plane arrival time' 
```

这里不需要耙子。

* * *

## 回答 #5

> 赞同：19
> 
> 时间：2010-08-17T10:10:24.153

来自帮助（spec -h）：

```
-l, --line LINE_NUMBER           Execute example group or example at given line.
                                 (does not work for dynamically generated examples) 
```

示例：规范规范/runner_spec.rb -l 162

* * *

## 回答 #6

> 赞同：16
> 
> 时间：2017-11-01T21:44:24.943

要运行**所有**rspec 文件：`rspec`

*注意：您必须位于项目的根目录中*

运行**一个**rspec 文件：`rspec 'path_to/spec.rb'`

*注意：将 'path_to/spec.rb' 替换为您的路径。引号可选。*

从一个文件运行**一个**rspec**测试：**`rspec 'path_to/spec.rb:7'`

*注意： :7 是测试开始的行号*

* * *

## 回答 #7

> 赞同：13
> 
> 时间：2008-09-28T20:04:38.383

如果您将 rspec 安装为插件而不是 gem，那么您将没有`spec`可执行文件。

无论如何，您需要做的就是使用 ruby​​ 运行该文件。rspec 代码足够聪明，可以为您运行测试。

例如：

```
ruby myclass_spec.rb 
```

* * *

## 回答 #8

> 赞同：12
> 
> 时间：2009-12-15T18:29:35.497

[http://github.com/grosser/single_test](http://github.com/grosser/single_test)可以让你做类似的事情。

```
rake spec:user          #run spec/model/user_spec.rb (searches for user*_spec.rb)
rake test:users_c       #run test/functional/users_controller_test.rb
rake spec:user:token    #run the first spec in user_spec.rb that matches /token/
rake test:user:token    #run all tests in user_test.rb that match /token/
rake test:last
rake spec:last 
```

* * *

## 回答 #9

> 赞同：10
> 
> 时间：2011-04-14T03:05:14.883

Ruby 1.9.2 和 Rails 3 有一种简单的方法来运行一个规范文件：

```
  ruby -I 规范规范/模型/user_spec.rb

```

解释：

*   `ruby`命令往往比`rake`命令 快
*   `-I spec`表示“在查找文件时包含‘spec’目录”
*   `spec/models/user_spec.rb`是我们要运行的文件。

* * *

## 回答 #10

> 赞同：5
> 
> 时间：2011-03-01T17:10:31.560

我无法让这些示例中的任何一个工作，可能是因为帖子很旧并且命令已经改变？

经过一番摸索，我发现这是可行的：

rspec 规范/模型/user_spec.rb

这将只运行单个文件并在终端中提供有用的输出。

* * *

## 回答 #11

> 赞同：4
> 
> 时间：2009-01-11T06:22:07.460

斑点.vim

* * *

## 回答 #12

> 赞同：4
> 
> 时间：2017-05-15T15:18:41.487

尽管对这个问题写了很多很好的答案，但没有一个使用[Rspec`tags`](https://relishapp.com/rspec/rspec-core/v/2-4/docs/command-line/tag-option)方法。

我使用标签在不同的文件中运行一个或多个规范——仅与我当前的开发任务相关的那些。

例如，我添加标签“dev”，其值为“current”：

```
it "creates an user", dev: :current do
  user = create(:user)
  expect(user.persisted?).to be_truthy
end 
```

然后我跑

```
bundle exec rspec . --tag dev:current 
```

可以在单个规范或组中设置不同的标签/值。

* * *

## 回答 #13

> 赞同：3
> 
> 时间：2008-10-03T09:12:30.920

或者，看看自动测试。

在命令窗口中运行 autotest 意味着无论何时保存该规范文件都会执行。此外，只要您指定的文件运行，它就会运行。

例如，如果您有一个名为 person_spec.rb 的模型规范文件和一个名为 person.rb 的模型文件，那么无论何时您从编辑器中保存这些文件中的任何一个，都会执行该规范文件。

* * *

## 回答 #14

> 赞同：3
> 
> 时间：2014-12-08T10:43:46.517

可以说，您正在运行测试以创建待办事项。您始终可以使用文件 crete_spec.rb 文件运行该特定的待办事项规范代码，如下所示。

```
 rspec/spec/features/controller/spec_file_name.rb

   Example:

   Creating  rspec spec/features/todos/create_spec.rb
   Editing   rspec spec/features/todos/edit_spec.rb
   Deleting  rspec spec/features/todos/destroy_spec.rb 
```

如果您想一次性运行所有规格。

```
 rspec 
```

如果您想在特定控制器用户中运行所有规范，请使用 this。

```
 rspec/spec/feaures/controller_name

  Example:   rspec/spec/features/todos 
```

希望能给大家更多的理解！

* * *

## 回答 #15

> 赞同：-1
> 
> 时间：2021-11-30T14:15:30.477

你可以在你的测试文件中运行特定的行

```
rspec spec/models/model_spec.rb:47 
```

# sql-server - 包装 SQL 报告矩阵

> ID：143926
> 
> 赞同：1
> 
> 时间：2008-09-27T16:13:18.477
> 
> 标签：sql-server, sql-server-2005, reporting-services

我在 SQL 报告中有一个矩阵，我希望它打印在 A4 页面上。如果矩阵的列少于 4 列，则它适合，但对于 4 列以上的列，我希望矩阵换行并每页仅显示 4 列。这可能吗？我在本地模式下使用 SQL Reporting 2005。

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2008-09-29T11:15:54.480

我找到了解决方法：

1.  首先，我在我的数据源中添加了一个名为列计数的字段。因为数据源是在业务对象中构建的，所以我很容易知道有多少列数据。
2.  接下来，我在我的报告上创建了一个列表，并将我的矩阵移动到列表中。
3.  我为列表创建了组表达式 =Ceiling(Fields!ColumnCount.Value/4)。

简而言之，我告诉列表每 4 列断开一次。这会导致矩阵在 4 列后拆分。

这不适用于所有情况，并且可能会搞砸小计，但它适用于我的应用程序。

免责声明：这不是我的主意……我改编自[Chris Hays 的 Sleezy Hacks](http://blogs.msdn.com/chrishays/archive/2004/07/23/HorizontalTables.aspx)。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2008-09-29T11:31:34.287

没有办法在本质上包装列；上面 Mboy 的解决方案与我过去所做的非常相似，因此我不会在此重复他的步骤，尽管我会警告您：对于具有大量列的矩阵，您的报告中的页数将成倍增长。在您的情况下，这可能不是问题；但我们发现，在大多数情况下（就页面输出而言）不换行会更便宜。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2011-05-24T08:06:32.087

除了 MBoy 的回答，我想在一页上显示多个图表，但图表的数量会因数据而异。我想要的是在一行中显示两个图表，其中包含尽可能多的行。我做了如下：

1.  正如 MBoy 所建议的那样，我在数据中创建了一个名为 [ChartNumber] 的“计数”字段，每个图表增加一（因此，如果我有 7 个图表，行将编号为 1-7）。
    为此，我使用 DENSE_RANK() SQL 函数在我的查询中创建了一个字段，例如 DENSE_RANK() OVER (ORDER BY [Data].[ItemtoCount]) AS [ChartNumber]。
    因此，如果我想为每个部门使用不同的图表，我可能会使用 DENSE_RANK() OVER (ORDER BY [Data].[Department]) AS [ChartNumber]

2.  我在表单中添加了一个列表并绑定到我的数据集

3.  然后我将行组设置为在 =Ceiling(Fields!ChartNumber.Value/2) 上分组

4.  然后我在 =Ceiling(Fields!ChartNumber.Value Mod 2) 上添加了一个列组

5.  在列表中创建一个图表并进行预览，您应该会在每行上并排看到两个图表。

我使用了图表，但您可以轻松地将矩阵或任何其他项目放入列表中。

编辑：n 列的更通用解决方案是 =Ceiling(Fields!ChartNumber.Value / n) 和 =Ceiling(n * Fields!ChartNumber.Value Mod n)

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2008-09-27T16:18:16.703

我不这么认为。我发现导出到 excel 然后打印是我发现的最灵活的打印 SSRS 矩阵报告的方式 - 尤其是。因为我的大多数用户都非常了解 excel。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2008-10-01T04:00:49.533

根据[MSDN](http://msdn.microsoft.com/en-us/library/bb934423.aspx)，Tablix 数据区域水平分页的方式与表格垂直分页的方式大致相同，也就是说，您可以在组更改时指定分页符。还有另一篇 MSDN 文章建议使用分页表达式，但是 MBoy 已经解释了这种技术，所以我不会重复它，只是说它是一种认可的技术。

# sql - varchar(255) v tinyblob v tinytext

> ID：143933
> 
> 赞同：15
> 
> 时间：2008-09-27T16:20:01.270
> 
> 标签：sql, mysql, database-design

我的问题是 tinyblob 和 tinytext 之间真的有什么区别吗？

购买我真正的问题是什么原因（如果有的话）我会选择 varchar(255) 而不是 tinyblob 或 tinytext？

* * *

## 回答 #1

> 赞同：18
> 
> 时间：2008-09-27T16:27:54.043

主要是[存储要求](http://dev.mysql.com/doc/refman/5.0/en/storage-requirements.html)和内存处理/速度：

> 在下表中，`M`表示非二进制字符串类型的声明列长度和二进制字符串类型的字节。`L`表示给定字符串值的实际长度（以字节为单位）。
> 
> VARCHAR( `M`), VARBINARY( `M`)：
> `L`如果列值需要 0 – 255 个字节，则
> `L`+ 1 个字节，如果值可能需要超过 255 个字节，则 + 2 个字节
> 
> TINYBLOB，TINYTEXT：
> `L`+ 1 个字节，其中`L`< 2 ⁸

此外，请参阅[此](http://markmail.org/message/u5rl7bhx64jsom2l)帖子：

> 对于正在使用的每个表，MySQL 为 4 行分配内存。对于这些行中的每一行，CHAR(X)/VARCHAR(X) 列占用 X 个字符。
> 
> 另一方面，TEXT/BLOB 由 8 字节指针 + 1-4 字节长度表示（取决于 BLOB/TEXT 类型）。BLOB/TEXT 在使用时动态分配。这将使用更少的内存，但在某些情况下，从长远来看，它可能会分散您的内存。

**编辑**：顺便说一句，blob 存储二进制数据，文本存储 ASCII，这是 TINYBLOB 和 TINYTEXT 之间的唯一区别。

* * *

## 回答 #2

> 赞同：5
> 
> 时间：2008-09-27T16:28:31.937

VARCHAR(255) 比 tinyblob 或 tinytext 更符合 SQL 标准。因此，您的脚本和应用程序将更易于跨数据库供应商移植。

* * *

## 回答 #3

> 赞同：-8
> 
> 时间：2010-01-06T22:29:55.957

您不能将 CHARACTER SET 应用于 TINYTEXT，但可以应用于 VARCHAR(255)

# java - 访问数据库的最佳基于 Web 的应用程序是什么

> ID：143936
> 
> 赞同：3
> 
> 时间：2008-09-27T16:23:24.257
> 
> 标签：java, sql, database

有时我们在客户防火墙后面部署应用程序，我们需要对他们的数据库进行只读访问以调试问题，因为有时他们的 IT 人员并不精通 SQL。我们希望将我们的应用程序与一些基于 Web 的应用程序捆绑在一起，这些应用程序将公开数据库并允许我们触发即席 SQL 查询并在 HTML 表中显示它们的输出。我们不想编写自制代码，我们可以捆绑基于 Java/JSP 的应用程序。

我们的后端是 Oracle，所以我们需要一个可以连接到 oracle 服务器并通过 Web 公开它的解决方案。

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2008-09-27T16:46:09.303

如果您希望数据库位于防火墙后面，相信我，您确实希望您的数据库位于防火墙后面，看看您是否可以使用 VPN 直接进入机箱。进入 VPN 后，您可以使用当前用于管理数据库的任何管理工具。因此，如果您使用 SQL Server，您可以通过 VPN 连接，并使用企业管理器来管理数据库。Oracle 可能有一个类似的工具，虽然我不是很熟悉。虽然拥有 VPN 确实会产生额外费用，但它可能会让事情变得容易很多倍。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2008-09-27T16:32:02.380

如果您使用 MySQL，[phpMyAdmin是一个不错的选择。](http://www.phpmyadmin.net/home_page/index.php)如果数据库打算放在防火墙后面，那么打开这样的应用程序总是有点危险，但是正如您所说，您可以使用只读帐户设置它，并可能在顶部添加额外的安全层，例如简单的 HTTP Basic授权。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2008-09-28T03:09:08.357

[Oracle Tool](http://www.oracletool.com/)是一个相当不错的 Oracle Web 前端。但企业经理也是如此。

无论哪种方式，您都不希望您的数据库以任何方式向外部世界开放，无论是通过某个网站、侦听器或其他任何方式。

VPN解决方案是要走的路，只需获得VPN，然后您就可以使用您通常使用的任何工具，如果VPN不是一个选项，那么一个简单的防火墙规则只允许您的IP访问就可以了，但不如VPN那么好.

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2008-09-28T02:58:37.397

在我当前的项目中，我们使用[SQL Navigator](http://www.quest.com/sql-navigator/)来在我们的 Oracle 数据库上运行查询。我也听说过关于[TOAD](http://www.toadsoft.com/toad_oracle.htm)的好消息。我建议不要仅仅为了运行即席 SQL 查询而编写 Web 应用程序，因为在我看来，有很多工具可以支持您的调试需求。

# delphi - Delphi OTA 和 RTTI 错误

> ID：143938
> 
> 赞同：3
> 
> 时间：2008-09-27T16:24:51.180
> 
> 标签：delphi, plugins, rtti

我正在写一个德尔福专家。我需要能够将值写入作为对象的属性上的属性。例如，我在表单上有一个 GroupBox，我想编辑 Margins.Left 属性。我正在使用以下过程来执行此操作，但如果在标记线上给出了 AV。

该过程从（属性编辑器）获取属性名称（例如“Margins.Left”）和新值的组件，解析出属性名称，获取对象，读取当前值并尝试更改它（如果不同）。然后它调用一个方法来记录任何更改。

```
procedure EditIntegerSubProperty(Component: IOTAComponent;const PropName: String;NewValue: Integer);
var AnObject: TObject;
  TK: TTypeKind;
  At: Integer;
  AClassName, APropName: String;
  PropInfo: PPropInfo;
  OldValue: Integer;
begin
  At := Pos('.', PropName);
  if At < 1 then
  raise Exception.Create('Invalid SubProperty Name: '+PropName);

  AClassName := Copy(PropName, 1, At-1);
  APropName := Copy(PropName, At+1, length(PropName));

  TK := Component.GetPropTypeByName(AClassName);
  if TK <> tkClass then
    EXIT;

  AnObject := GetObjectProp((Component as INTAComponent).GetComponent, AClassName);
  if PropIsType(AnObject, APropName, tkInteger) then
  begin
    OldValue := GetInt64Prop(AnObject, APropName);
    if OldValue <> NewValue then
    begin
      SetInt64Prop(AnObject, APropName, NewValue);  <----AV HERE
      ChangeLogInteger(Name, PropName, OldValue, NewValue);
    end;
  end;
end; 
```

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2008-09-27T17:10:39.120

您是否尝试使用 GetOrdProp、SetOrdProp 而不是 GetInt64Prop、SetInt64Prop？

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2008-09-27T19:37:32.997

Margins.xyzzy 都是 Integer 属性，不是 Int64 属性，所以需要使用 GetOrdProp/SetOrdProp 来读取和修改。

SetInt64Prop 假定它是 64 位属性，并尝试使用 64 位参数调用属性设置器函数。由于属性设置器需要一个 32 位参数，因此它无法正确清理堆栈，从而导致 AV 返回。

您可以根据 PropIsType 调用来判断要调用哪些函数。

*   tkInt64 : 获取/SetInt64Prop
*   tkInteger：获取/SetOrdProp

Get/SetOrdProp 函数也可用于 Char 和 WideChar 属性，我猜这就是为什么名称不是 100% 明显的原因。

# c# - 内存中 LINQ 性能

> ID：143947
> 
> 赞同：8
> 
> 时间：2008-09-27T16:29:07.300
> 
> 标签：c#, linq, performance, complexity-theory

不仅仅是关于 LINQ to [在此处插入您最喜欢的提供程序]，这个问题是关于搜索或过滤内存中的集合。

我知道 LINQ（或搜索/过滤扩展方法）适用于实现`IEnumerable`或`IEnumerable<T>`. 问题是：*由于枚举的性质，每个查询的复杂度至少是**O(n)**吗？*

例如：

```
var result = list.FirstOrDefault(o => o.something > n); 
```

在这种情况下，每个算法至少需要**O(n)**，除非`list`是相对于 排序的`'something'`，在这种情况下，搜索应该是**O(log(n))**：它应该是二分搜索。但是，如果我理解正确，此查询将通过枚举解决，因此它应该采用**O(n)**，即使`list`之前已订购。

*   我可以做些什么来解决**O(log(n))**中的查询吗？
*   如果我想要性能，我应该使用 Array.Sort 和 Array.BinarySearch 吗？

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2008-09-27T17:28:03.603

即使使用并行化，它仍然是 O(n)。常数因子会有所不同（取决于您的核心数量），但随着 n 的变化，总时间仍然会线性变化。

当然，您可以在自己的数据类型上编写自己的各种 LINQ 运算符的实现，但它们仅适用于非常特定的情况 - 您必须确定谓词仅在优化方面进行操作数据。例如，如果您有一个按年龄排序的人员列表，它不会帮助您进行查询以查找具有特定姓名的人:)

要检查谓词，您必须使用表达式树而不是委托，并且生活会变得更加困难。

我怀疑我通常会添加新方法，这些方法可以明显表明您正在使用数据类型的索引/排序/任何性质，并且始终可以正常工作。当然，您不能轻易地从查询表达式中调用这些额外的方法，但是您仍然可以使用带有点表示法的 LINQ。

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2008-09-27T17:29:24.380

是的，正如 Sklivvz 所说，一般情况总是 O(n)。

然而，当实现 IEnumerable 的对象实际实现 ICollection 时，许多 LINQ 方法是特殊情况。（我已经为 IEnumerable.Contains 看到过这个。）

在实践中，这意味着 LINQ IEnumerable.Contains 调用快速 HashSet.Contains，例如，如果 IEnumerable 实际上是一个 HashSet。

```
IEnumerable<int> mySet = new HashSet<int>();

// calls the fast HashSet.Contains because HashSet implements ICollection.
if (mySet.Contains(10)) { /* code */ } 
```

您可以使用反射器来准确检查 LINQ 方法的定义方式，这就是我想出的方法。

哦，LINQ 还包含方法 IEnumerable.ToDictionary（将键映射到单个值）和 IEnumerable.ToLookup（将键映射到多个值）。这个字典/查找表可以创建一次并多次使用，这可以将一些 LINQ 密集型代码加速几个数量级。

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2008-09-27T16:59:53.453

是的，它必须是，因为访问 an 的任何成员的唯一方法`IEnumerable`是使用它的方法，这意味着 O(n)。

这似乎是一个经典案例，语言设计者决定以性能换取通用性。

# java - 是否有 .NET 或 Java 的 SMART 库？

> ID：143969
> 
> 赞同：3
> 
> 时间：2008-09-27T16:40:39.473
> 
> 标签：java, .net, hardware, disk-smart

*我问了一个有点[相关](https://stackoverflow.com/questions/123575/how-to-get-the-temperature-of-motherboard-of-a-pc-and-other-hardware-statistics)的问题，但我希望它更具体和面向“编程”，所以这里是：*

有没有人知道，如果有**.NET**、**JAVA**或任何其他框架、库、.jar 文件或任何东西：访问[SMART](http://en.wikipedia.org/wiki/Self-Monitoring,_Analysis,_and_Reporting_Technology)统计信息？

谢谢！

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2008-09-27T17:41:32.667

您可以通过 System.Management 和 WMI 类“MSStorageDriver_ATAPISmartData”从 .Net 获取 SMART 统计信息。

这是我为您创建的一个简短示例。启动一个新的控制台项目并添加对 System.Management 程序集的引用，然后将其粘贴到 Program.cs 中：

```
using System;
using System.Collections.Generic;
using System.Text;
using System.Management;

namespace GetSMART
{
    class Program
    {
        static void Main(string[] args)
        {
            ManagementObjectSearcher searcher = 
            new ManagementObjectSearcher(
                "root\\WMI",
                "SELECT * FROM MSStorageDriver_ATAPISmartData"
            );

            foreach (ManagementObject item in searcher.Get())
            {
                foreach( PropertyData prop in item.Properties )
                {
                Console.WriteLine("{0} = {1}",
                    prop.Name, prop.Value);
                }
            }

            Console.ReadLine();
        }
    }
} 
```

# version-control - 什么时候应该优先选择标签而不是分支，反之亦然（在 CVS 中）？

> ID：143971
> 
> 赞同：5
> 
> 时间：2008-09-27T16:42:00.093
> 
> 标签：version-control, comparison, cvs

我认为标题应该足够好。

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2008-09-27T16:44:32.867

当您要标记里程碑时，应使用标签。里程碑可能小到每日构建。

当您想独立于另一个分支/主干进行更改时，应使用分支。

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2008-09-27T17:52:46.150

**标签**

把它想象成时间的快照。我希望能够回到那个确切的点。然而，它永远不会改变。您不对标记的元素进行签入。

可以标记的东西：

*   发布（主要和次要）
*   发送给客户的补丁
*   Bug修复
*   里程碑（alpha、beta 等...）
*   成功的每日构建

**分支机构**

该分支将对其进行开发（即签入）。
您可以从标签创建分支（例如进行错误修复）。
您可以创建一个分支来开发一个功能，然后将其合并回主干。
您可以为发布（次要或主要）创建一个分支。

关键是可以修改分支，标签**不应该是**.

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2008-09-27T17:05:32.860

分支也应该用于主要里程碑，例如发布。不过，这取决于您的[分支策略](http://www.google.com/search?hl=en&q=branching+strategy)。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2008-10-09T16:30:41.803

建议其他回复，

我们对次要发布使用标签，对发布使用分支。例如，

```
v1.0 <-- Branch  
  v1.0.1 <-- Tag  
  v1.0.2 <-- Tag  
v1.1 <-- Branch  
  v1.1.1 <-- Tag  
  v1.1.2 <-- Tag  
v1.2 <-- Branch  
  v1.2.1 <-- Tag  
  v1.2.2 <-- Tag  
v1.3 <-- Branch  
  v1.3.1 <-- Tag  
  v1.3.2 <-- Tag  
v1.4 <-- Branch  
  v1.4.1 <-- Tag  
  v1.4.2 <-- Tag  
v1.5 <-- Branch  
  v1.5.1 <-- Tag  
  v1.5.2 <-- Tag 
```

用微软的比喻来说，Branch 是 Windows（95、XP、Vista 等）的一个版本，而标签是一个服务包。

# c# - 你会在哪里使用 C# 运行时编译？

> ID：143973
> 
> 赞同：11
> 
> 时间：2008-09-27T16:42:52.010
> 
> 标签：c#, optimization, runtime-compilation

我最近在另一个网站上偶然发现了一个关于 C# 运行时编译的简短讨论，当时我正在搜索其他内容，并认为这个想法很有趣。你用过这个吗？我正在尝试确定如何/何时可以使用它以及它解决了什么问题。我很想听听您是如何使用它的，或者在什么情况下它是有意义的。

非常感谢。

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2008-09-27T16:46:20.007

通常，我看到这用于您当前正在使用反射并且需要优化性能的情况。

例如，不是使用反射来调用方法 X，而是在运行时生成一个动态方法来为您执行此操作。

* * *

## 回答 #2

> 赞同：5
> 
> 时间：2008-09-27T18:56:11.770

您可以使用它为您的应用程序添加脚本支持。例如看[这里](http://www.codeproject.com/KB/cs/cs-script_for_cp.aspx)或[这里](http://www.vsj.co.uk/articles/display.asp?id=417)。

将您的内部对象框架的一部分发布到脚本部分是很容易的，因此您可以相对轻松地向您的应用程序添加一些具有相同效果的东西，例如 Office 的 VBA。

* * *

## 回答 #3

> 赞同：3
> 
> 时间：2008-09-28T17:24:22.230

我在生成动态代理（[代码项目示例](http://www.codeproject.com/KB/cs/dynamicproxy.aspx) ）或其他优化反射调用的方法（时间方面）时看到了这一点（运行时编译/使用 System.Reflection.Emit 类）。

* * *

## 回答 #4

> 赞同：2
> 
> 时间：2008-09-27T16:49:43.897

至少在生成动态代码时可能会用到它。例如，框架在内部使用它来动态生成 XML 序列化器。在运行时查看一个类后，它可以生成代码来序列化/反序列化该类。然后它编译该代码并根据需要使用它。以同样的方式，您可以生成代码来处理任意 DB 表等，然后编译和加载生成的程序集。

* * *

## 回答 #5

> 赞同：2
> 
> 时间：2008-09-27T16:52:45.933

好吧，所有 C# 代码都是运行时编译的，因为它是 JIT（即时）编译器。我假设您指的是 Reflection.Emit 来动态创建类等。这是我最近在 Xml-Rpc.Net 库中看到的一个示例。

我创建了一个与 XML-RPC 服务的方法调用具有相同签名的 C# 接口，例如

```
IMyProxy : IXmlRpcProxy
{
    [XmlRpcMethod]
    int Add(int a, int b);
} 
```

然后在我的代码中我称之为

```
IMyProxy proxy = (IMyProxy)XmlRcpFactory.Create(typeof(IMyProxy)); 
```

这使用运行时代码生成来为我创建一个功能齐全的代理，所以我可以像这样使用它：

```
int result = proxy.Add(1, 2); 
```

然后它会为我处理 XML-RPC 调用。很酷。

* * *

## 回答 #6

> 赞同：2
> 
> 时间：2008-09-27T17:12:52.313

我在毕业论文中使用了来自 .NET 的运行时编译器服务。基本上，它是关于可视化地为过程可视化创建一些图形组件，这些组件生成为 C# 代码，编译成程序集，然后可以在目标系统上使用而无需解释，以使其更快、更紧凑。而且，作为奖励，生成的图像可以打包到与资源相同的程序集中。

它的另一个用途是在 Java 中。我有一个应用程序，它必须使用用户可以输入的一些数值算法（回到大学）来绘制一个可能很昂贵的函数。我将输入的函数放入一个类中，编译并加载它，然后它可以用于相对快速的执行。

所以，这是我的两个经验，运行时代码生成是一件好事。

* * *

## 回答 #7

> 赞同：2
> 
> 时间：2008-09-27T17:18:00.040

我使用它的目的是允许 C# 和 VB 代码由用户临时运行。他们可以输入一行代码（或几行代码），然后将其编译、加载到应用程序域中、执行，然后卸载。这可能不是其用法的最佳示例，但仍然是一个示例

# c# - 铸造和转换一样吗？

> ID：143997
> 
> 赞同：47
> 
> 时间：2008-09-27T16:57:56.903
> 
> 标签：c#, clr, casting

在 Jesse Liberty 的 Learning C# 一书中，他说“一种类型的对象可以转换为另一种类型的对象。这称为强制转换。”

如果您调查从下面的代码生成的 IL，您可以清楚地看到转换后的赋值与转换后的赋值不同。在前者中，您可以看到正在发生的装箱/拆箱；在后者中，您可以看到对转换方法的调用。

我知道最终这可能只是一个愚蠢的语义差异——但只是转换的另一个词。我并不是要刻薄，但我对任何人对此的直觉不感兴趣——意见在这里不重要！谁能指出一个明确的参考来确认或否认铸造和转换是否是同一件事？

```
 object x;
    int y;

    x = 4;

    y = ( int )x;

    y = Convert.ToInt32( x ); 
```

谢谢

rp

在马特关于显式/隐式的评论之后添加的注释：

我不认为隐式/显式是区别。在我发布的代码中，两种情况下的更改都是明确的。将 short 分配给 int 时会发生隐式转换。

给 Sklivvz 的注意事项：

我想确认我对 Jesse Liberty（通常是清晰明了的）语言松散的怀疑是正确的。我认为 Jesse Liberty 对他的语言有点松懈。我知道转换是在对象层次结构中路由的——即，您不能从整数转换为字符串，但可以从派生自 System.Exception 的自定义异常转换为 System.Exception。

不过，有趣的是，当您尝试从 int 转换为字符串时，编译器会告诉您它无法“转换”该值。也许杰西比我想象的更正确！

* * *

## 回答 #1

> 赞同：29
> 
> 时间：2008-09-27T17:03:44.660

绝对不！

Convert 尝试通过“任何可能的方式”为您提供 Int32。Cast 没有做任何此类事情。使用 cast 您告诉编译器将对象视为 Int，而不进行转换。

当您知道（通过设计）该对象是 Int32 或另一个具有 Int32 转换运算符的类（例如 float）时，您应该始终使用 cast。

Convert 应与 String 或其他类一起使用。

试试这个

```
static void Main(string[] args)
{
    long l = long.MaxValue;

    Console.WriteLine(l);

    byte b = (byte) l;

    Console.WriteLine(b);

    b = Convert.ToByte(l);

    Console.WriteLine(b);

} 
```

结果：

> 9223372036854775807
> 
> 255
> 
> 未处理的异常：
> 
> System.OverflowException：值大于 Byte.MaxValue 或小于 Byte.MinValue 在 System.Convert.ToByte（Int64 值）[0x00000] 在 Test.Main (System.String[] args) [0x00019] 在 /home/marco /develop/test/Exceptions.cs:15

* * *

## 回答 #2

> 赞同：18
> 
> 时间：2008-09-27T17:21:33.197

简单的答案是：视情况而定。

对于值类型，强制转换将涉及真正将其转换为不同的类型。例如：

```
float f = 1.5f;
int i = (int) f; // Conversion 
```

当转换表达式拆箱时，结果（假设它有效）*通常*只是盒子中内容的副本，具有相同的类型。然而，也有例外——你可以从一个装箱的 int 拆箱到一个 enum（具有底层的 int 类型），反之亦然；同样，您可以将装箱的 int 拆箱为 Nullable<int>。

当转换表达式从一种引用类型到另一种引用类型并且不涉及用户定义的转换时，就对象本身而言没有转换 - 只有*引用*的类型“改变” - 这实际上只是value 被视为，而不是引用本身（这将是与以前相同的位）。例如：

```
object o = "hello";
string x = (string) o; // No data is "converted"; x and o refer to the same object 
```

当涉及到用户定义的转换时，这*通常*需要返回不同的对象/值。例如，您可以为您自己的类型定义一个到字符串的转换——这肯定不会是与您自己的对象相同的数据。（当然，它可能是已经从您的对象中引用的现有字符串。）根据我的经验，用户定义的转换通常存在于值类型而不是引用类型之间，因此这很少成为问题。

根据规范，所有这些都算作转换——但它们并不都算作将*对象*转换为不同类型的*对象*。我怀疑这是 Jesse Liberty 使用术语松散的一个案例——我在 Programming C# 3.0 中注意到了这一点，我刚刚读过。

这涵盖了一切吗？

* * *

## 回答 #3

> 赞同：7
> 
> 时间：2008-09-27T17:12:01.550

我见过的最好的解释可以在下面看到，然后是源链接：

“...事实比这要复杂一些。.NET 提供了三种从 A 点到 B 点的方法。

首先，有隐式演员表。这是一个不需要你做任何事情的演员：

```
int i = 5;
double d = i; 
```

这些也称为“扩大转换”，.NET 允许您在没有任何强制转换运算符的情况下执行它们，因为这样做您永远不会丢失任何信息：双精度的可能有效值范围包括 int 的有效值范围，然后一些，所以你永远不会去做这个任务，然后你会惊恐地发现运行时会从你的 int 值中删除几位数字。对于引用类型，隐式转换背后的规则是转换永远不会抛出 InvalidCastException：编译器很清楚转换总是有效的。

您可以为自己的类型创建新的隐式转换运算符（这意味着您可以进行隐式转换来破坏所有规则，如果您对此很愚蠢）。基本的经验法则是隐式转换永远不能包括在转换中丢失信息的可能性。

请注意，底层表示在此转换中*确实*发生了变化：double 的表示方式与 int 完全不同。

第二种转换是显式转换。只要有可能丢失信息，或者转换可能无效并因此抛出 InvalidCastException，就需要显式转换：

```
double d = 1.5;
int i = (int)d; 
```

在这里，您显然会丢失信息：演员表后 i 将是 1，因此 0.5 会丢失。这也称为“缩小”转换，编译器要求您包含显式转换 (int) 以表明是的，您知道信息可能会丢失，但您不在乎。

同样，对于引用类型，编译器在强制类型转换在运行时可能无效的情况下需要显式强制类型转换，作为一个信号，是的，您知道存在风险，但您知道自己在做什么。

第三种转换涉及到表示形式的巨大变化，以至于设计者甚至没有提供明确的转换：他们让你调用一个方法来进行转换：

```
string s = "15";
int i = Convert.ToInt32(s); 
```

请注意，这里没有任何东西绝对需要方法调用。隐式和显式转换也是方法调用（这就是您自己制作的方式）。设计者可以很容易地创建一个将字符串转换为 int 的显式转换运算符。调用方法的要求是一种风格选择，而不是语言的基本要求。

文体推理是这样的：String-to-int 是一个复杂的转换，有很多机会出现可怕的错误：

```
string s = "The quick brown fox";
int i = Convert.ToInt32(s); 
```

因此，方法调用为您提供了可供阅读的文档，并广泛暗示这不仅仅是快速转换。

在设计您自己的类型（尤其是您自己的值类型）时，您可能会决定创建强制转换运算符和转换函数。划分“隐式转换”、“显式转换”和“转换函数”领域的界限有点​​模糊，因此不同的人可能会做出不同的决定来决定什么应该是什么。试着记住信息丢失、异常和无效数据的可能性，这应该有助于你做出决定。”

*   布鲁斯·伍德，2005 年 11 月 16 日

[http://bytes.com/forum/post1068532-4.html](http://bytes.com/forum/post1068532-4.html)

* * *

## 回答 #4

> 赞同：2
> 
> 时间：2008-09-27T17:40:12.857

## 铸造涉及参考

```
List<int> myList = new List<int>();
//up-cast
IEnumerable<int> myEnumerable = (IEnumerable<int>) myList;
//down-cast
List<int> myOtherList = (List<int>) myEnumerable; 
```

请注意，针对 myList 的操作（例如添加元素）反映在 myEnumerable 和 myOtherList 中。这是因为它们都是对同一实例的（不同类型的）引用。

向上转换是安全的。如果程序员在类型中犯了错误，向下转换会产生运行时错误。安全向下转换超出了此答案的范围。

## 转换涉及实例

```
List<int> myList = new List<int>();
int[] myArray = myList.ToArray(); 
```

myList 用于生成 myArray。这是一个非破坏性的转换（myList 在此操作后工作得非常好）。另请注意，针对 myList 的操作（例如添加元素）不会反映在 myArray 中。这是因为它们是完全独立的实例。

```
decimal w = 1.1m;
int x = (int)w; 
```

在 C# 中有使用强制转换语法的操作[实际上是转换](http://forums.microsoft.com/msdn/ShowPost.aspx?PostID=3895492&SiteID=1)。

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2008-10-29T13:49:36.467

除了语义，快速测试表明它们**不等价！**
他们以不同的方式完成任务（或者，他们可能执行不同的任务）。

```
x=-2.5 (int)x=-2 Convert.ToInt32(x)=-2
x=-1.5 (int)x=-1 Convert.ToInt32(x)=-2
x=-0.5 (int)x= 0 Convert.ToInt32(x)= 0
x= 0.5 (int)x= 0 Convert.ToInt32(x)= 0
x= 1.5 (int)x= 1 Convert.ToInt32(x)= 2
x= 2.5 (int)x= 2 Convert.ToInt32(x)= 2 
```

注意`x=-1.5`和`x=1.5`情况。

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2008-09-27T17:04:41.037

强制转换告诉编译器/解释器该对象实际上属于该类型（或具有该类型的基本类型/接口）。与转换相比，这是一件相当快的事情，转换不再是编译器/解释器在做这项工作，而是一个函数实际解析字符串并进行数学运算以转换​​为数字。

* * *

## 回答 #7

> 赞同：0
> 
> 时间：2008-09-27T17:06:24.607

强制转换总是意味着改变对象的数据类型。这可以通过例如将浮点值转换为整数值或通过重新解释位来完成。它通常是一种语言支持（阅读：编译器支持）的操作。

术语“转换”有时用于强制转换，但它通常由某个库或您自己的代码完成，不一定与强制转换相同。例如，如果您有一个英制重量值并将其转换为公制重量，它可能会保持相同的数据类型（例如浮点数），但会变成不同的数字。另一个典型的例子是从度到弧度的转换。

* * *

## 回答 #8

> 赞同：0
> 
> 时间：2008-09-27T17:12:28.010

在与语言/框架无关的说话方式中，从一种类型或类转换为另一种称为**强制转换**。.NET 也是如此，正如您的前四行所示：

```
object x;
int y;

x = 4;

y = ( int )x; 
```

C 和类 C 语言（例如 C#）使用`(newtype)somevar`语法进行转换。例如，在 VB.NET 中有明确的内置函数。最后一行将写为：

```
y = CInt(x) 
```

或者，对于更复杂的类型：

```
y = CType(x, newtype) 
```

其中'C'显然是'cast'的缩写。

然而， .NET 也有这个`Convert()`功能。这不是内置的语言功能（与上述两个不同），而是框架之一。当您使用一种不一定与 .NET 一起使用的语言时，这一点会变得更清楚：它们仍然很可能有自己的转换方式，但 .NET 增加了`Convert()`.

正如马特所说，行为上的差异`Convert()`更加明确。而不是仅仅告诉编译器将`y`其视为整数等价物，而是明确告诉它以适合整数类的方式`x`进行更改，*然后*将结果分配给.`x`*`y`*

 *在您的特定情况下，强制转换执行所谓的“拆箱”，而`Convert()`实际上将获得整数值。结果看起来是一样的，但是[Keith 更好地解释了](https://stackoverflow.com/questions/18465/net-parse-verses-convert#18523)细微的差异。

* * *

## 回答 #9

> 赞同：0
> 
> 时间：2008-09-27T18:17:43.420

根据**MCTS Self-Paced Training Kit (Exam 70-536): Microsoft® .NE​​T Framework 2.0-Application Development Foundation**的第 1 章第 4 课第 55 页上标题为“显式转换的方法”的表 1-7 ，肯定有他们之间的区别。

**System.Convert**与语言无关，可以转换“在实现*System.IConvertible 接口*的类型之间”。

**(type) cast operator**是**C# 特定**的语言功能，可转换“定义*转换运算符*的类型之间”。

此外，在实施自定义转换时，它们之间的**建议不同**。

根据上述课程中第 56-57 页标题为“**如何在自定义类型中实现转换”的部分，***转换运算符（强制转换）旨在简化数字类型之间的转换，而 Convert() 启用特定于文化的转换*。

> 您选择哪种技术取决于您要执行的转换类型：
> 
> *   定义**转换运算符**以简化数值类型之间的缩小和扩大转换。
>     
>     
> *   实现**System.IConvertible**以通过 System.Convert 启用转换。使用此技术来启用特定于文化的转换。
>     
>     
> *   ...

现在应该更清楚了，由于强制转换运算符是独立于 IConvertible 接口实现的，因此 Convert() 不一定只是强制转换的另一个名称。（但我可以设想一个实现可以在哪里引用另一个以确保一致性）。

* * *

## 回答 #10

> 赞同：-2
> 
> 时间：2008-09-27T17:16:10.090

强制转换本质上只是告诉运行时“假装”对象是新类型。它实际上并没有以任何方式转换或更改对象。

但是，Convert 将执行将一种类型转换为另一种类型的操作。

举个例子：

```
char caster = '5';
Console.WriteLine((int)caster); 
```

这些语句的输出将是 53，因为运行时所做的只是查看位模式并将其视为 int。你最终得到的是字符 5 的 ascii 值，而不是数字 5。

但是，如果您使用 Convert.ToInt32(caster)，您将得到 5，因为它实际上会读取字符串并正确修改它。（基本上它知道 ASCII 值 53 实际上是整数值 5。）

* * *

## 回答 #11

> 赞同：-4
> 
> 时间：2008-09-27T17:01:07.210

区别在于转换是隐式的还是显式的。上面的第一个是强制转换，第二个是对转换函数的更明确的调用。他们可能会以不同的方式做同样的事情。**************