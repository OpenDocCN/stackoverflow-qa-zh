# StackOverflow 问答 000634000-000634999

# svn - Svn 回购同步

> ID：634005
> 
> 赞同：2
> 
> 时间：2009-03-11T10:38:52.607
> 
> 标签：svn, version-control, synchronization, replication

我想在我的 SVN 存储库中保留一份第 3 方代码的副本。（所以我可以运行报告和测试）

我如何将某个文件夹/路径从他们的仓库同步到我的？

显然，我不能只从他们的仓库中导出并提交给我的，因为这会错过删除。

自动化解决方案的额外酷点。

svn:externals 可以使用，但并不理想。如果关闭了第 3 方回购，我将无法访问代码。

谢谢，

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2009-03-11T10:46:55.943

如果第 3 方代码位于 SVN 存储库中，您可以使用[svn:externals](http://svnbook.red-bean.com/en/1.0/ch07s03.html)属性。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2009-06-21T01:21:48.890

我正是用[svk](http://svk.bestpractical.com/view/HomePage)做的。

有一些关于[使用 svk 进行镜像和 svn repo](http://svk.bestpractical.com/view/UsingSVKAsARepositoryMirroringSystem)的文档，但不是很好；也许这个程序总结会有所帮助。

1.  如果您不希望它位于主目录下的默认位置，请将您的`SVKROOT`环境变量设置为您的 svk 存储库的适当路径。请注意，这将包含您使用 svk 所做的一切，包括多个 svn 存储库的镜像，因此它可以变得非常大。

2.  `svk init`初始化回购。应该询问您是否要初始化它（如果它不存在）。之后您可能还会收到一条错误消息，“无法识别命令，请尝试 /usr/bin/svk 帮助。”；这似乎是一个无害的错误。

3.  设置你的镜像，给出你想要镜像的仓库的路径，以及你想要放置镜像的 svk 仓库中的路径，例如：

    svk mirror sv+ssh://foo.com/data/repo/head/project //mirror/foo.com/project svk mirror sv+ssh://bar.com/data/repo/head/funstuff //mirror /bar.com/funstuff

4.  运行`svk sync -a`以同步所有镜像。每当您想从镜像存储库将副本更新到最新版本时，您都会运行此程序。

    如果您第一次收到有关 Time::Progress 模块丢失的错误，您可能使用的是最新版本的 Fedora、Ubuntu 或其他带有损坏的 svk 包的发行版。有一些[解决方法](https://bugs.launchpad.net/ubuntu/+source/svk/+bug/317487)；我只是`sudo cpan Time::Progress`为了从 CPAN 中获取我需要的东西。

5.  做`svk co /mirror/foo.com/project`一个检查你的项目。当然，您将拥有完整的历史记录和其他所有内容，只需使用 svk 命令而不是 svn 命令。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-03-11T12:40:03.627

我在想[svk](http://svk.bestpractical.com/view/HomePage)可能能够做到这一点。您将为源存储库和目标存储库设置镜像，并让两个签出指向同一位置。

然后只需从源存储库中提取并推送到目标......或类似的东西。

您应该能够使用由 cron 作业运行的 shell 脚本来自动化它。

* * *

## 回答 #4

> 赞同：-1
> 
> 时间：2009-03-11T11:58:31.513

您可能应该使用一些 DVCS 工具，如 Mercurial（使用 hgsubversion 或 hgsvn）或 Git（git-svn）来制作 SVN 的镜像。

# actionscript - 检测 Flash 测试播放器

> ID：634008
> 
> 赞同：0
> 
> 时间：2009-03-11T10:39:23.323
> 
> 标签：actionscript, air, flash

我注意到某些 AIR 选项在 Flash 测试播放器（当您 Ctrl + Enter 时预览电影的那个）中不起作用。

一个例子是[NativeApplication.startAtLogin](http://livedocs.adobe.com/flash/9.0/ActionScriptLangRefV3/flash/desktop/NativeApplication.html#startAtLogin)。

如果从独立播放器调用它（例如双击 swf 文件）它可以工作，但如果我在 flash ide 上测试它会抛出错误。

有没有办法检测我是否在 ide 中测试电影，从而避免使用该属性？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-03-11T11:05:04.510

[flash.system.Capabilities](http://livedocs.adobe.com/flash/9.0/ActionScriptLangRefV3/flash/system/Capabilities.html#playerType)有一个名为 playerType 的属性，使用测试播放器时设置为“External”，使用 AIR 时设置为“Desktop”。所以，

```
import flash.system.Capabilities;

...

if (Capabilities.playerType != 'External')
  // do stuff that don't work in the test player
if (Capabilities.playerType == 'Desktop')
  // do stuff that works only in AIR 
```

# java - 移动 OSGi 是否已准备好在手机上实际使用？

> ID：634011
> 
> 赞同：3
> 
> 时间：2009-03-11T10:39:40.670
> 
> 标签：java, mobile, osgi

我正在为移动设备开发应用程序。我从来没有为 OSGi 开发过，现在，我正在考虑开始使用它。

我读过很多关于在手机上使用 OSGi 的文章，据说它可以在 J2ME、Symbian、Windows Mobile、Android 上运行……但在我看来，目前似乎没有人在那里使用它。

我真的很想利用 OSGi 的许多好处，但我知道没有它我也能做到。而且我不想排除任何无法在手机上使用 OSGi 或者必须通过复杂的设置过程使他们的手机为 OSGi 做好准备的用户。

而且我简直不敢相信那些便宜的 J2ME 手机中的大多数都可以运行像 OSGi 这样复杂的东西。不是在谈论 1000 美元的智能手机，而是在谈论您可以从索尼爱立信以 100 美元（公平地说是 200 美元）购买的那些消费设备。

**移动 OSGi 现在是真正的替代品，还是只是未来使用的一个很好的前景？**

**编辑：** 到目前为止，只有一个答案，它表明我们离使用移动 OSGi 还很远。但对我来说，一个答案是做出重要决定的依据很少，所以我希望赏金能吸引更多读者。

如果没有更多的答案出现，那么这表明没有人有移动 OSGi 的经验，然后我会得出结论，我不想成为第一个探索它的人。通常我喜欢尝试新技术，但这次押错马是至关重要的。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2009-03-17T12:52:44.840

您没有得到答案的原因可能是因为 OSGi Mobile 还没有为现实世界做好准备。更要命的是，这件事公布了3年多，还没跟上，好像大家都忘记了。这与 MIDP 3.0 类似，每个人都在等待。

据我了解，OSGi 承诺为移动设备提供 CDC 配置，允许它们使用像 Swing 这样的丰富框架。它还将解除 MIDP 配置文件施加的一些限制，最重要的是，它将允许用户通过无线方式下载和安装插件。

您现在需要考虑所有这些如何适应当前的市场状况。我们现在有很多智能手机平台（iPhone、Windows Mobile、Symbian）。这些都是关键参与者，当然他们希望人们更喜欢本机应用程序而不是 Java 应用程序。事实上，Apple 到目前为止已经禁止 iPhone 上的 Java 或任何其他 VM 应用程序。但是，即使制造商没有这样做，我认为客户自己也不会更喜欢更丰富和更强大的本机应用程序的任何风格的 Java 应用程序。Java 移动应用程序在几年前还很有意义，但如今它们似乎已成为过去。

当然有人会争辩说，Sun 不想放弃移动 Java，它已部署在数十亿台设备中，并且会做一些事情来重振它。好吧，他们实际上做了一些事情，这就是[JavaFX mobile](http://www.sun.com/software/javafx/mobile/)。

所以在我看来，OSGi mobile 被排除在现在和未来之外。

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2009-03-17T21:53:05.550

没有理由不应该这样做。OSGi 作为一个框架，bundle 定义和依赖管理都比较紧凑。那么重要的是由 OSGi 标准定义的标准服务。但是，它们不是框架正常运行所必需的。

尽管 OSGi mobile 可能还没有出现，但没有理由不使用专为小型设备设计的 OSGi 平台。一个例子是来自[http://www.buglabs.net/](http://www.buglabs.net/)的 BUG 。他们使用专为小型设备设计的 concierge OSGi 实现 ( [http://concierge.sourceforge.net/](http://concierge.sourceforge.net/) )。

根据 concierge 项目页面：“Concierge 是一个优化的 OSGi R3 框架实现，文件占用空间约为 80 kBytes。这使其成为移动或嵌入式设备的理想选择。”。concierge 项目页面还提供了经过测试的平台列表，参见：[http ://concierge.sourceforge.net/platforms/index.html](http://concierge.sourceforge.net/platforms/index.html)

在我看来，它现在已经是一种替代方案。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-03-11T19:20:45.037

我们离那里还很远，但我完全同意它需要添加到任何地方的手机中。

至少，未来的移动虚拟机正朝着这个方向发展。

所以，现在：不可能。未来：没有人可以说，但那会很棒，实际上很有意义。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2009-04-30T16:13:47.020

抱歉，我不知道这个论坛，所以我之前没有看到这个问题。Mobile OSGi 是活生生的，并且已经由 Sprint 在其 winmobile 设备上发布，并且很快将用于 sprint 产品组合中的其他设备。Sprint 还为任何 winmobile 6.0 手机发布了 Open eval 版本，即使它不在 sprints 网络上。移动 OSGi 提供了移动领域其他任何地方都没有的功能。您可以在 OSGi 中运行完全可管理的 Java Web/App 服务器（来 javaone 并查看演示）。并且可以创建富互联网应用程序，这些应用程序使用设备上的浏览器连接到设备上的服务器，我们称之为富移动网络模式。与 android 不同，它完全可以远程管理。并且不像 iphone 完全打开。它确实需要移动强大的 Java CDC VM 作为基础，因此它不会一直运行到低端设备，但在中段和上段会很好。它也是唯一可以跨操作系统运行的应用程序框架。它是完整的 OSGi r4 meg 堆栈，它为移动设备带来了与 glassfish、oracle 服务器、websphere、springsource 等中使用的 OSGi 相同的功能。这是唯一的移动解决方案，这不是一些独特的移动黑客，而是从玻璃房服务器到云边缘的相同技术。查看 developer.sprint.com/titan Jon Bostrom MobiNoir 咨询总裁 移动 Java 之父 这是唯一的移动解决方案，这不是一些独特的移动黑客，而是从玻璃房服务器到云边缘的相同技术。查看 developer.sprint.com/titan Jon Bostrom MobiNoir 咨询总裁 移动 Java 之父 这是唯一的移动解决方案，这不是一些独特的移动黑客，而是从玻璃房服务器到云边缘的相同技术。查看 developer.sprint.com/titan Jon Bostrom MobiNoir 咨询总裁 移动 Java 之父

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2009-04-30T16:23:00.070

坏消息：作为应用程序开发人员，世界上没有任何技术可以用来开发可以在任何地方运行的应用程序，因此要么将自己限制在一个平台上，要么多次重写应用程序。

好消息：OSGi 已经可用于 4 个平台（Win Mobile、Android、Nokia、Brew），还有什么其他平台可以覆盖？

关于为什么需要 OSGi 的好文章：[http ://www.pikesoft.com/blog/index.php?itemid=220](http://www.pikesoft.com/blog/index.php?itemid=220)

就市场渗透而言，是的，它尚未普遍部署，我理解对于应用程序开发人员（通常不希望将平台与他的应用程序一起部署）这是一个限制。然而，正如乔恩所说，今年美国开始大规模部署，其他部署也将紧随其后。忍受这项技术！

# url-rewriting - 哪种 URL 重写方案更可取？维基/博客风格？

> ID：634014
> 
> 赞同：2
> 
> 时间：2009-03-11T10:40:17.830
> 
> 标签：url-rewriting, mediawiki, friendly-url, blog-engine

我正在编写一些 URL 重写软件，我想从许多角度知道哪种 URL 方案更可取：

*   博客风格：**我的化学答案**——为什么？-- *（不是优选的，技术性的）*
*   Wiki 风格：**My_Chemistry_Answer** -- 为什么不呢？-- *（最好的，正式的）*

**搜索引擎优化：**有人说谷歌只分割由破折号分隔的单词，这就是为什么博客文章比 MediaWiki 设置获得更好的搜索引擎优化，这是真的吗？

**可读性：**最后取决于用户，当他们在搜索引擎结果页面/他们的书签/收藏夹中看到实际的“漂亮”URL 链接时。

我觉得Wiki风格更容易阅读，因为下划线显示为空格，因此不会妨碍阅读，而且看起来更整洁，更正式，因此看起来更权威。

**结论？**那么从“**技术**”的角度来看，哪个更好呢？（搜索引擎优化/索引），并从“**人**”的角度来看？（可读性/友好/漂亮）

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2009-03-11T13:20:12.407

**根据 Google 工程师**Matt Cutts 的说法，就 SEO 而言，“my-chemistry-answer”优于“my_chemistry_answer”，后者优于“mychemistryanswer”。

请参阅他对 Google 版主的问题的回答，询问 Google 工程师： http: [//moderator.appspot.com/#9/e=c9&t=long-haired-dogs](http://moderator.appspot.com/#9/e=c9&t=long-haired-dogs)

至于人的观点，我只能发表我的看法。我倾向于更喜欢“我的化学答案”。URL 通常不会以固定宽度的字体呈现，因此连字符的宽度比下划线更接近空格，所以对我来说它读起来更自然。此外，作为程序员，您可能习惯于看到下划线，因为标识符中不允许使用连字符（因此对您来说看起来更好），但大多数人不是程序员。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2009-03-11T10:52:53.353

如果您正在编写用于通用用途的 url 重写软件，您甚至不应该问这个问题并支持两者。当您为特定站点编写此 url-reweriting 时，您应该以站点的目的为指导。

希望这在某种程度上有所帮助......

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2009-03-11T10:53:33.773

首先，只有谷歌工程师可以肯定地告诉你谷歌的真实情况：）

你是什​​么意思博客文章比媒体维基文章获得更好的搜索引擎优化？你能证明这一点吗？如果是这样，那么为什么维基百科通常出现在前十页。

关于可读性，我同意下划线更适合阅读。

我的结论是，从技术角度来看，只要它不是 /p=34 或类似的形式，样式就无关紧要。任何风格都可以。重要的是内容。不要忘记[内容为王](http://searchenginewatch.com/3625720)

# c# - 我将如何对结构数组进行排序？

> ID：634017
> 
> 赞同：3
> 
> 时间：2009-03-11T10:41:11.230
> 
> 标签：c#, .net, arrays, sorting

我有一个包含歌曲数据的结构：

```
public struct uLib
    {
        public string Path;
        public string Artist;
        public string Title;
        public string Album;
        public string Length;
    } 
```

我的库由这个数组组成`uLib`。我将如何通过说艺术家对这个数组进行排序？我可以在这种类型的数组上调用本机排序函数，还是我必须“自己动手”？

* * *

## 回答 #1

> 赞同：16
> 
> 时间：2009-03-11T10:47:46.643

首先，那不应该是一个结构。它大于 16 个字节，因此您无法获得结构体的性能优势。此外，它不代表单个值，因此使其成为结构在语义上没有意义。只是把它变成一个类。

该类`Array`有一个`Sort`可以使用的方法：

```
Array.Sort(theArray, (x,y) => string.Compare(x.Artist,y.Artist)); 
```

如果您没有 C# 3，则使用委托而不是 lambda 表达式：

```
Array.Sort(theArray, delegate(uLib x, uLib y) { return string.Compare(x.Artist,y.Artist) } ); 
```

编辑：
这是您的数据作为一个类的样子的示例：

```
public class ULib {

    private string _path, _artist, _title, _album, _length;

    public string Path { get { return _path; } set { _path = value; } }
    public string Artist { get { return _artist; } set { _artist = value; } }
    public string Title { get { return _title; } set { _title = value; } }
    public string Album { get { return _album; } set { _album = value; } }
    public string Length { get { return _length; } set { _length = value; } }

    public ULib() {}

    public ULib(string path, string artist, string title, string album, string length) {
       Path = path;
       Artist = artist;
       Title = title;
       Album = album;
       Length = length;
    }

} 
```

在 C# 中有一个属性的缩写形式。这不是为私有变量和 setter 和 getter 编写代码来访问它，而是自动创建它：

```
public string Path { get; set; } 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-03-11T10:47:26.457

从 ULibArray 中按 u.Artist 顺序从 u 中选择 u；

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-03-11T10:47:32.540

假设`uLibs`是`IEnumerable<T>`，你可以试试这个：

```
uLibs.OrderBy(i => i.Artist) 
```

`uLib`这使用键对实例进行排序；在这种情况下，您选择了艺术家作为比较的关键。可以对您的其他字段进行类似的排序。

# serial-port - 与 MW-3170 磁卡读卡器通信

> ID：634018
> 
> 赞同：0
> 
> 时间：2009-03-11T10:41:18.017
> 
> 标签：serial-port, point-of-sale, magnetic-cards

我们的一位客户询问我们是否可以与旧 EPOS 系统的串行磁卡读卡器/编码器连接。该设备没有制造只有[MW-3170](http://www.officezone.com/mw3000.htm)型号。

有人知道我如何与设备通信吗？我目前正在谷歌上寻找编程手册，但没有多大成功。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-03-11T14:53:51.980

它可以读取符合这些标准[ANSI 3554、ISO 7811/3](http://www.cyberd.co.uk/support/technotes/isocards.htm)的卡，从其使用年限来看，它可能是带有[DB-9连接器的](http://en.wikipedia.org/wiki/D-subminiature)[串行](http://en.wikipedia.org/wiki/Serial_port)设备。您为什么不直接致电其中一位供应商并询问更多信息？

编辑：看起来我对[界面](http://championsystems.net/magnetencdr.htm)是正确的：

```
COMMUNICATIONS
Transmission Type  : Asynchronous
Interface          : RS232C
Baud Rate          : 1200, 2400, 4800, 9600 BPS
Data Length        : 7 bits or 8 bits
Parity             : Space, Odd, Even, Mark
Start Bit          : 1 bit
Stop Bit           : 1 bit 
```

我进一步猜测它可能是一个 ASCII 接口，即使您无法获得文档，也很容易进行逆向工程。即使它是二进制的，只要您有包含已知数据的磁卡，您就可以计算出来。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-03-16T19:04:09.090

[经过进一步搜索，我在Partner Tech USA](http://www.partner.com.tw/support/default.asp?dl=MW-3000)上找到了 MW-3000 系列读卡器/写卡器的编程软件。

使用[串口监控软件](http://www.serial-port-monitor.com/)，您可以对发送到读卡器的命令进行反向工程。

要从读卡器读取，请发送以下命令。

```
<STX>R7<ETX> 
Hex: 02 52 37 03 
```

# python - 为什么 Python 的框架会从控制器返回字典？

> ID：634024
> 
> 赞同：2
> 
> 时间：2009-03-11T10:45:28.660
> 
> 标签：python, ruby-on-rails, web2py

为什么（例如 web2py）你从字典中的控制器返回数据而不是变量（参见 Rails）？

例如：

```
return dict(sape=4139, guido=4127, jack=4098) 
```

而不是（Rails 就是这样做的）

```
@var1 = "jello" 
@var2 = "hihi" 
```

使用字典比普通变量（速度方面/代码方面）有什么优势吗？

更新：上述方法实际上是创建字典的正确方法（至少在 Python 2.6.1 中）。另一种方式（很多人说它是正确的）

```
return {"var1": "jello", "var2": "hihi"} 
```

python框架没有大量使用。

来自[Python 的文档](http://docs.python.org/tutorial/datastructures.html)：“当键是简单字符串时，有时使用关键字参数指定对更容易：”

```
dict(sape=4139, guido=4127, jack=4098) 
```

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2009-03-11T11:13:09.513

主要优点是这是 python 中返回 a) 多个值**和**b) 为该值命名的唯一方法。其他选择是使用一个类（额外代码），返回一个元组（没有名字，所以你必须使用索引来访问这些值）或者只允许返回一个值，这可能意味着每个人都会返回一个字典，因为这是最简单的解决方案。

它还允许包装几种方法并加入/合并它们的结果。最后，它允许为每个调用轻松返回不同的值/名称对集，例如，省略可选值或返回额外的提示。

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2009-03-11T11:37:08.083

如果您愿意，可以使用局部变量：

```
def hello():
    var1 = "whatever you like"
    var2 = "another value"
    return locals() # or vars() 
```

`hello.html`：

```
<html><body>
 <p>var1 {{=var1}}</p>
 <p>var2 {{=var2}}</p>
</body></html> 
```

[从 PHP 到 web2py](http://mdp.cti.depaul.edu/AlterEgo/default/show/106)：

> 在 web2py 中，对“/app/c/f”的 HTTP 请求被映射到对应用程序“app”中文件（控制器）c.py 中的函数 f() 的调用。文件 c.py 是用 Python 编写的。函数 f() 的输出可以是一个字符串（在这种情况下它被返回），或一组变量（实现为 python 字典）。在后一种情况下，变量通过文件 c/f.html（称为视图）呈现为 HTML。

* * *

## 回答 #3

> 赞同：-1
> 
> 时间：2009-03-11T11:19:50.840

好消息是像 Jinja2 这样的模板引擎对对象和字典的处理方式类似，所以如果：

```
d = {'color': 'red'}
o = Color(red) 
```

那么这些都在模板语法中起作用：

```
d.color d['color'] o.color o['color'] 
```

# generics - 并行继承链中的多态性和类型安全

> ID：634025
> 
> 赞同：1
> 
> 时间：2009-03-11T10:45:43.030
> 
> 标签：generics, inheritance, polymorphism, strong-typing

我有两个并行的继承链：

```
Chain1:
Animal <- Lion
       <- Gazelle

Chain2:
Food   <- Meat
       <- Grass 
```

我想在 Animal 上实现“Eats”多态属性。这是它的样子：

```
public abstract class Animal
{
  public abstract Food Eats { get; set;}
}

public class Lion : Animal
{
  public override Food Eats
  {
     get { return new Meat();}
     set 
     {
       if (value is Meat) DoSomething(value);
       else throw new Exception("Lions only eat meat. " + 
                                "You better learn that, dude!");
     }
  }
} 
```

但是，此代码不是类型安全的。如果我用草喂我的狮子，我只会在运行时遇到我的错误。

有人可以为我提供一个代码示例，在不牺牲多态性的情况下使用泛型促进类型安全吗？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2009-03-11T12:29:54.057

使用组合而不是继承：

不是基于消化系统进行继承，而是将消化分解为自己的一组类。
首先，一个描述不同饮食方式的界面。

```
public interface IDigest
{
  void Eat(Meat food);
  void Eat(Plant food);
  void Eat(Offal food); //lol nethack
} 
```

肉食动物吃肉，有时可以吃药草，不喜欢废话：

```
public class Carnivorous : IDigest
{ 
  public void Eat(Meat food)
  {
    Console.Write("NOM NOM");
  }
  public void Eat(Plant food)
  {
    if(Starving)
     Console.Write("Ugh, better than nothing.");
    else
      Vomit();
  }
  public void Eat(Offal food)
  {
    Vomit();
  }
} 
```

草食动物很挑剔，宁愿死也不吃肉（我知道，保存你的评论，这是一个例子）

```
public class Herbivorous : IDigest
{ 
  public void Eat(Meat food)
  {
    Vomit();
  }
  public void Eat(Plant food)
  {
    Console.Write("NOM NOM");
  }
  public void Eat(Offal food)
  {
    Vomit();
  }
} 
```

杂食动物什么都吃。见证州博览会。

```
public class Omnivorous : IDigest
{ 
  public void Eat(Meat food)
  {
    Console.Write("NOM NOM");
  }
  public void Eat(Plant food)
  {
    Console.Write("NOM NOM");
  }
  public void Eat(Offal food)
  {
    Console.Write("NOM NOM");
  }
} 
```

所有动物都必须吃东西，所以它们必须有消化系统以及其他系统。

```
public abstract class Animal
{
  /* lots of other stuff */
  public IConsume DigestiveSystem {get;set;}
  /* lots of other stuff */
} 
```

嬉皮士是具有已知口味的动物类别。它在实例化时自行配置。也可以从外部注入行为和系统。

```
public class Hippie : Animal
{
  public Hippie()
  {
    /*stuff*/
    DigestiveSystem = new Herbivore();
    BodyOdorSystem = new Patchouli();
    /*more stuff*/
  }
} 
```

最后，让我们看看嬉皮士吃汉堡。

```
public static void Main()
{
  Hippie dippie = new Hippie();
  Meat burger = new Meat("Burger", 2/*lb*/);
  dippie.DigestiveSystem.Eat(burger);
} 
```

在对像动物这样的复杂系统进行建模时，我更喜欢组合而不是任何时候的继承。复杂的系统可以快速爆炸继承树。以三种动物系统为例：杂食/草食/肉食、水/空气/陆地和夜间/昼夜。我们甚至不用担心如何决定哪个分类成为 Animals 的第一个区分点。我们是先将 Animal 扩展到 Carnivore，先到 WaterLiving，还是先到 Nocturnal？

由于杂食动物可以生活在空中并喜欢夜晚（蝙蝠*），并且还可以是白天行走的陆地生物（人类），因此您必须有一条能够满足每一个选择的继承路径。那是一个已经有 54 种不同类型的继承树（它很早，善良）。动物比这复杂得多。您可以轻松获得具有数百万种类型的继承树。绝对是组合优于继承。

*例如，新西兰短尾蝙蝠是杂食性的。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-03-11T10:52:24.417

Animal 可以是一个泛型类：

```
public abstract class Animal<T> where T : Food
{
    public abstract T Eats {get;set;}
} 
```

那么你可以像这样让狮子成为肉食动物

```
public class Lion : Animal<Meat>
{
    //etc...
} 
```

但这不是最佳解决方案。您不能再将 animal 用作多态接口，因为您需要了解有关其实现的详细信息才能使用它。这可能不是多态性的地方。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-03-11T10:51:39.317

嗯，也许你可以修改你的第一个继承链：

动物 - 食肉动物 - 狮子 - 老虎 - ... - 草食动物 - 羊

然后，你也许可以做这样的事情：

```
public class Animal<T> where T : Food
{
    public abstract T Eats { get; set; }
}

public class Carnivore : Animal<Meat>
{
   ...
} 
```

我没有测试，这只是我的一个想法......

* * *

## 回答 #4

> 赞同：-1
> 
> 时间：2009-03-11T11:21:21.133

我认为这是一个错误的困境。Food 似乎比抽象基类更接近接口，因为听起来 Meat 与 Grass 完全不同。相反，请考虑以下内容：

```
public interface IFood {
  public boolean IsForCarnivores();
}

public class Lion : Animal {
  ...
  public override IFood Eats
  {
    get { ... }
    set 
    {
      if (value.IsForCarnivores()) DoSomething(value);
      else throw new Exception("I can't eat this!");
    }
  }
} 
```

# php - 如何使用 PHP 发送邮件？

> ID：634029
> 
> 赞同：1
> 
> 时间：2009-03-11T10:47:13.447
> 
> 标签：php, email

我正在使用 Windows Vista 操作系统。PHP、MySQL 作为数据库和 Apache Web 服务器。

我想向想要加入我网站的人发送通知。但问题是当我点击提交时。它不会向用户的电子邮件地址发送任何内容。

您认为最好的解决方案是什么？

```
<?php
$to = "recipient@example.com";
$subject = "Hi!";
$body = "Hi,\n\nHow are you?";
if (mail($to, $subject, $body)) {
  echo("<p>Message successfully sent!</p>");
 } else {
  echo("<p>Message delivery failed...</p>");
 }
?> 
```

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2009-03-11T10:58:32.890

你有几个选择：

*   内置[邮件功能](http://www.php.net/mail)，但需要机器上运行一些MTA，不支持认证，发送附件需要下功夫
*   有[Pear Mail](http://pear.php.net/package/Mail)包，如果你喜欢使用 Pear 的东西
*   有一个很好的[PHPMailer 类](http://www.phpclasses.org/browse/package/264.html)，我在过去几年中使用过它，它真的很棒。它喜欢它，因为它非常简单且易于包含在您的项目中（只需一个简单的包含调用），而且功能强大

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2009-03-11T11:04:21.907

[Zend 框架的](http://framework.zend.com/)[Zend_Mail](http://framework.zend.com/manual/en/zend.mail.html)在发送电子邮件方面做得非常好！！你不需要使用整个 Zend 框架，你可以使用 Zend_Mail！

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2009-03-11T10:50:27.307

使用 Pear "Mail" 类，它需要访问在端口 25 上侦听的单独 SMTP 服务器。

示例代码如下：

```
function sendmail($from, $to, $subject, $message, $headers)
{
    if (is_array($to)) {
            $recipients = implode(', ', $to);
    } else {
        $recipients = $to;
    }

    $errorlevel = error_reporting();
    $headers["From"] = $from;
    $headers["To"] = $to;
    $headers["Subject"] = $subject;

    $params = array();
    $params["host"] = "localhost";
    $params["port"] = "25";
    $params["auth"] = false;

    error_reporting($errorlevel & ~E_WARNING);

    $mail_object =& Mail::factory("smtp", $params);
    $res = $mail_object->send($recipients, $headers, $message);

    error_reporting($errorlevel);

    return $res;
} 
```

注意：这是旧代码 - 我现在不记得为什么我必须屏蔽 E_WARNING

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2010-05-06T10:21:30.843

看起来您没有安装邮件服务器。Apache 或 PHP 不会为您发送邮件。Php 正在为此注册功能，但在内部您必须配置一个邮件 smtp 服务器来进行实际发送。

[检查这篇文章](https://stackoverflow.com/questions/2741913/php-how-to-send-email-basics)。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2009-03-11T10:52:26.680

只需查看“[如何从 PHP 脚本发送电子邮件](http://email.about.com/cs/phpemailtips/qt/et031202.htm)”。它使用邮件功能发送邮件，并进一步提供本地和远程 SMTP 配置的配置。

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2009-03-11T11:19:42.480

有很多方法可以通过 PHP 发送电子邮件。`mail()`如果您不使用任何框架，则首先使用内部函数。我建议使用[Zend Framework](http://en.wikipedia.org/wiki/Zend_Framework)的 Zend_Mail 组件。我已经使用过它，它运行良好，并为您提供了一种很好的面向对象的方式来使用 PHP 发送电子邮件。但是如果你有理由使用这个`mail()`函数，那么我想你可能需要知道这些： PHP`mail()`本身不发送电子邮件。它利用其他工具发送电子邮件。如果您在 Unix 系统中运行您的应用程序，`mail()`尝试使用通常安装在大多数类 Unix 系统上的 sendmail 程序发送电子邮件。在 Windows 平台上，没有安装 sendmail，因此 PHP 将尝试使用 SMTP 服务器发送电子邮件。所以你应该告诉 PHP 这个 SMTP 服务器在哪里，并提供 SMTP 服务器的用户名/密码（如果有的话）。您可以通过编辑 PHP 配置文件来做到这一点，`php.ini`. 这个文件是一个基于文本的配置文件，PHP 在执行时将使用它。找到您的`php.ini`文件并在此文件中修改这些值：

```
SMTP = localhost
smtp_port = 25
sendmail_from = me@example.com 
```

如果您不知道您的`php.ini`文件在哪里，请创建一个简单的 PHP 文件，例如`info.php`并将以下代码放入其中：

```
<?php
phpinfo();
?> 
```

运行您的页面并搜索`.ini`. 现在你知道你的`php.ini`文件在哪里了。

* * *

## 回答 #7

> 赞同：0
> 
> 时间：2012-07-02T09:11:18.563

我会推荐使用 swiftmailer 库，该项目有很好的文档并且易于使用。它还为使用默认的 PHP mail() 函数提供了几个优点。

[http://swiftmailer.org/](http://swiftmailer.org/)

# asp.net - 如何检测网格视图中链接按钮的单击事件？

> ID：634039
> 
> 赞同：0
> 
> 时间：2009-03-11T10:50:13.953
> 
> 标签：asp.net, vb.net

我在 Gridview 的列中有一个链接按钮。

当用户单击链接按钮时，我必须重定向到另一个页面。

任何人都可以提供适当的代码来完成此操作吗？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-04-21T21:24:21.713

如果您只需要重定向到另一个页面，为什么不使用[HyperLinkField](http://msdn.microsoft.com/en-us/library/system.web.ui.webcontrols.hyperlinkfield.aspx)呢？

您可以使用数据对象字段设置[url 参数和文本，如下所示：](http://msdn.microsoft.com/en-us/library/system.web.ui.webcontrols.hyperlinkfield.datanavigateurlformatstring.aspx)

```
<asp:hyperlinkfield datatextfield="UnitPrice"
            datatextformatstring="{0:c}"
            datanavigateurlfields="ProductID"
            datanavigateurlformatstring="~\details.aspx?ProductID={0}"          
            headertext="Price"
            target="_blank" /> 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-03-11T14:49:52.770

```
 <asp:LinkButton ID="sessionLink" runat="server" Text='Tickets'
    PostBackUrl="SelectTickets.aspx"/> 
```

当您指定 PostBackUrl 属性时，您的 onclick 事件将永远不会被触发。它只是将您重定向到另一个页面。您可以做的是在您的点击事件中添加以下语句并将 postbackurl 属性删除为：

```
 <asp:LinkButton ID="sessionLink" runat="server" Text='Tickets'
    OnClick="selectTickets" /> 
```

它在后面的代码中调用 selectTickets 函数，因此您必须在后面的代码中创建一个函数，如下所示：

```
Private Sub selectTickets(ByVal sender As Object, ByVal e As CommandEventArgs) 
     'whatever else you want to be done 
      Response.Redirect("SelectTickets.aspx") 
 End Sub 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-03-11T10:52:14.150

将 PostBackUrl 属性设置为要访问的 URL。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2009-03-11T11:49:18.943

另一种方法是在链接按钮的单击事件中使用 response.redirect 或 server.transfer，如下所示：

```
Partial Class _Default
    Inherits System.Web.UI.Page

    Protected Sub LinkButton1_Click(ByVal sender As Object, ByVal e As System.EventArgs) Handles LinkButton1.Click
        Response.Redirect("Page2.aspx")
    End Sub

    Protected Sub LinkButton2_Click(ByVal sender As Object, ByVal e As System.EventArgs) Handles LinkButton2.Click
        Server.Transfer("Page2.aspx")
    End Sub
End Class 
```

区别基本上是 response.redirect 显示新的 URL， server.transfer 没有。

# c# - 反序列化抽象类

> ID：634040
> 
> 赞同：5
> 
> 时间：2009-03-11T10:50:23.487
> 
> 标签：c#, .net, wcf, exception-handling, abstract-class

我有一个抽象类“服务器”，我在我的 UI 中的 JavaScript 中创建它，然后我想在我的 Web 服务上有一个方法，它执行以下操作：

```
public List<Database> GetDatabases(Server server)
{
    Type type = server.GetType();
    Server x = null;

    if (typeof (SqlServer2005Server).Equals(type))
    {
        x = new SqlServer2005Server();
    }

    // Return the Databases from the server
    return x.GetDatabases();
} 
```

我遇到的问题是服务器无法反序列化，因为它是抽象的，我是否需要为我拥有的每个服务器都有一个从具体类型继承的方法，即

```
public List<Database> GetDatabases(SqlServer2005Server server)
{
    // Return the Databases from the server
    return SqlServer2005Serverx.GetDatabases();
}

public List<Database> GetDatabases(OracleServer server)
{
    // Return the Databases from the server
    return SqlServer2005Serverx.GetDatabases();
} 
```

我非常感谢您的帮助，因为我不确定什么是最好的解决方案

我收到的确切错误是：

> 无法创建抽象类的实例。

* * *

## 回答 #1

> 赞同：9
> 
> 时间：2009-03-11T11:47:16.173

WCF 将支持继承，但您需要使用已知类型属性来装饰您的数据协定。例如：

```
[DataContract]
[KnownType(typeof(Customer))]
class Contact
{
   [DataMember]
   public string FirstName
   {get;set;}

   [DataMember]
   public string LastName
   {get;set;}
}
[DataContract]
class Customer : Contact
{
   [DataMember]
   public int OrderNumber
   {get;set;}
} 
```

HTH。

# java - Java 设计模式：这对任何人来说都很熟悉吗？

> ID：634049
> 
> 赞同：2
> 
> 时间：2009-03-11T10:53:27.190
> 
> 标签：java, design-patterns

在我的应用程序中，我有以下重复出现的模式，我觉得这是一些我不知道的常见模式的不完整或扭曲版本。在我的实现中，我似乎找不到实现特定操作的好方法，如下所述。

如果您对它们调用方法，则对象集合（我们称它们为“源”）会产生数据。[ScheduledThreadPoolExecutor](http://java.sun.com/j2se/1.5.0/docs/api/java/util/concurrent/ScheduledThreadPoolExecutor.html)的一个实例（来自`[java.util.concurrent](http://java.sun.com/j2se/1.5.0/docs/api/java/util/concurrent/package-summary.html)`）用于定期读取源并将数据放在一个公共出站队列中：

```
--o
      方法调用 +-----+
--o <-- | ○ | ---> |||||||||||
          --> | 哦 |
--o 数据 +-----+

源线程池出站队列

```

源、线程池和队列是一个类的成员，该类提供添加源和检索队列头的方法。

下面是添加新源的代码。我想知道如果我从集合中删除一个源会发生什么。

```
public void vAddSource(ISource src)
{
    this._rgSources.add(src);
    final ISource srcT = src;
    // q is the outbound queue, which is a private member in the class
    // defining this method. Name is abbreviated for readability
    Runnable cmd = new Runnable() { public void run() { q.add(srcT.sRead()); } }
    // tpx is the thread pool
    this._tpx.scheduleAtFixedRate(cmd, 0L, 1000L, TimeUnit.MILLISECONDS);
} 
```

现在，Java 的工作方式——如果我理解正确的话——src 等是按值传递的对象标识符，所以在上面的代码中只有一个 ISource 对象，并且它的标识符也被添加到集合中传递到线程池中。如果我从集合中删除标识符，对象仍然存在，因此线程池将继续从中读取，就好像什么都没发生一样。

我是否正确理解这一点？如果您希望线程池记录删除并丢弃源，那么典型的方法是什么？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2009-03-11T11:14:05.143

`ThreadPoolExecutor`（因此`ScheduledThreadPoolExecutor`）有一个`remove(Runnable)`方法。`FutureTask`您可能还对哪些可以取消感兴趣（尽管这不会将其从工作队列中删除）。

ETA（由 Hanno Fietz 提供，来自 pgras 的回答）：这还需要将 Runnables 映射到源，以便 removeSource 方法可以使用正确的方法调用 ThreadPoolExecutor.remove。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2009-03-11T12:18:09.140

一种解决方案是保留源和 Runnables 之间的映射，以便您可以实现 removeSource 方法。

另一种方法是保持对源的弱引用而不是硬引用，如果源被垃圾收集，则让 Runnable 自行终止。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-10-22T07:30:01.497

你在写你不知道这个模式。使用`java.lang.Runnable()`命令模式 - 一种行为设计模式。

# sql-server-2008 - SQLXML 与 Windows 2008 和 SQL Server 2008

> ID：634053
> 
> 赞同：1
> 
> 时间：2009-03-11T10:54:28.780
> 
> 标签：sql-server-2008, windows-server-2008, sqlxml

我有一个使用 SQLXML 访问数据库数据的应用程序。我们让它在 Windows 2003 服务器和 SQL Server 2005 上运行。现在客户端想要在 Windows 2008 和 SQL Server 2008 上安装它，我们收到如下错误：
Microsoft.Data.SqlXml.SqlXmlException: Class not registered ---> System.Runtime.InteropServices.COMException (0x80040154)：类未在 Microsoft.Data.SqlXml.Common.UnsafeNativeMethods 注册。ISQLXMLCommandManagedInterface.ExecuteToOutputStream() 在 Microsoft.Data.SqlXml.SqlXmlCommand.innerExecute(Stream strm) ...等

这真让我抓狂。SQLXML 是一种相当过时的技术，我们正在尝试将它与最新的 SO 一起使用。我找不到有关 SQLXML 和 Windows 2008 的官方信息，它似乎不受官方支持，但他们也没有说它也不支持。

SQLXML4.0SP1 安装似乎工作正常，但似乎在运行时失败。

你有什么想法？有人尝试过这样的事情吗？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-01-17T00:40:59.637

SQLXML 4.0 SP1 的包仅可在 2009 年 4 月版的 Microsoft SQL Server 2008 功能包中下载。不知道为什么它们没有出现在 2008 R2 功能包中，但它们没有出现。

这是您指向[功能包](http://www.microsoft.com/download/en/details.aspx?id=3522)
的链接 指向适当版本的 SQLXML 4.0 SP1 的直接链接可在该页面上找到

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-03-11T11:15:54.890

我的建议是利用它适用于 SQL 2005 的事实将代码转换为不使用 SQLXML。您可以利用它有效的事实来创建证明它有效的测试。然后进行转换，并再次测试。如果测试仍然显示它有效，那么您已经摆脱了过时的技术，而仍然有人知道过时的技术意味着什么。

否则，在找到解决此直接问题的方法（可能重新安装 MSXML）之后，您将在 20 年后进行此讨论，但不同的是，没有人知道 SQLXML 曾经是什么。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-06-04T08:45:31.473

默认情况下，SQLXML 未安装到 SQLServer。您应该运行 SQL Server 安装程序，并添加 SQLXML 功能。我的意思是 SQL Server 2008。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2010-06-17T10:17:13.817

您可能正在使用 SQLXML 4.x 中不支持的 ISAPI 功能

在 Win 2008 Server (Vista,7) 上安装 SQLXML 3.0 并为 IIS 7.x 更改[IIS 6 管理兼容性](http://my-tech-talk.blogspot.com/2010/01/how-to-install-sqlxml-3-on-iis-7.html)- 允许 IIS 6 元数据库兼容性和 IIS 6 管理控制台（在管理工具/服务器管理器/“角色 - 网络服务器 (IIS)”中/“角色服务”）。

在 64 位 Win Server 2008 上为 IIS/应用程序池“启用 32 位应用程序”。

# java - url和名称空间java转换

> ID：634059
> 
> 赞同：1
> 
> 时间：2009-03-11T10:56:18.137
> 
> 标签：java, url, namespaces

我需要能够转换：

```
(url) http://www.joe90.com/showroom 
```

到

```
(namespace) com.joe90.showroom 
```

我可以使用令牌等和强制规则集来做到这一点。

但是，有没有一种方法（一个 java 包）可以为我做到这一点？还是我需要自己写一个？

谢谢

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-03-11T11:03:15.000

```
java.net.URL url = new java.net.URL("http://www.joe90.com/showroom");
String tokens[] = url.getHostname().split(".");
StringBuilder sb = new StringBuilder();
for (int i=0; i<tokens.length; i++) {
  if (i > 1) {
    sb.append('.');
  }
  sb.append(tokens[i]);
}
String namespace = sb.toString(); 
```

或者，您可以解析主机名。

```
Pattern p = Pattern.compile("^(\\w+://)?(.*?)/");
Matcher m = p.matcher(url); // string
if (m.matches()) {
  String tokens[] = m.group(2).split(".");
  // etc
} 
```

当然，该正则表达式并不匹配所有 URL，例如：

```
http://username@hostname.com/... 
```

这就是我建议使用 java.net.URL 的原因：它会为您完成所有的 URL 验证和解析。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-03-11T11:09:37.417

您最好的选择是根据`.`and`/`字符拆分字符串（例如使用`Sting.split()`，然后以相反的顺序连接各个部分，跳过任何您不想包含的内容（例如`www`）

# python - Python 拖放

> ID：634067
> 
> 赞同：0
> 
> 时间：2009-03-11T10:59:51.373
> 
> 标签：python, windows, drag-and-drop, permission-denied, ioerror

我在这里研究一个解析器，它打开一个文件，读取它并在另一个文件中打印数据。

输入文件由 sys.argv[1] 确定以处理命令行打开和拖放（在 Windows 中）。但是，当拖放文件时，它给了我

```
ioerror 13: Permission denied 
```

查看 sys.argv 包含的内容，我执行了以下操作（来自 cmd.exe）以使其包含相同的内容：

```
C:\>python C:\test\iotest.py C:\test\iotestin.txt 
```

它失败了。但是，以下工作

```
C:\>cd test
C:\test>python iotest.py iotestin.txt 
```

对我来说，以上将/应该几乎相同。

*   为什么会出现权限错误？
*   如何使 python 能够处理完全指定的路径？（如果这就是问题所在。）
*   如何启用拖放功能？

哦，如果不清楚，我将 input/txt 文件拖到 python 文件中，而不是相反。作为一名编码员，我总是更喜欢 CLI，但这个软件的未来用户不喜欢，因此我需要让它工作。

虽然非常简单，但这里有一些代码可以重现该问题：

```
import sys
print sys.argv
raw_input("")

try:
    print "opening",sys.argv[1]
    infile = open(sys.argv[1])
    outfile = open("out.txt", "w")
    raw_input("")
except IndexError:
    print "usage:",sys.argv[0].split("\\")[-1],"FILE"
    raw_input("")
    exit()
except IOError as (errno, strerror):
    print "I/O error({0}): {1}".format(errno, strerror)
    raw_input("")
    exit()

raw_input("done") 
```

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2009-03-11T11:06:00.343

您使用`outfile = open("out.txt", "w")`- 在第一个示例中，这将转到 c:\out.txt，我认为这是您的错误的根源。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2016-02-11T08:17:03.710

出错时工作目录可能在`C:\Window\System32`：IOError: [Errno 2] No such file or directory: 或 13: Permission denied。

所以你需要先切换到脚本或输入文件目录。如：

`os.chdir(os.path.split(sys.argv[0])[0])`

如果要更改输入文件的文件夹，请尝试：

`os.chdir(os.path.split(sys.argv[1])[0])`

# svn - 带有 32 位服务器和 32/64 位客户端的 Subversion

> ID：634068
> 
> 赞同：3
> 
> 时间：2009-03-11T11:00:18.250
> 
> 标签：svn, tortoisesvn, 64-bit, 32-bit

早上好; 我的 google-fu 今天似乎缺少了。

我刚刚升级到 Vista64 机器，我们现在只有一个 32 位颠覆服务器。

我假设在 32 位服务器上使用 64 位 tortoisesvn 没有问题？

谢谢。最大限度。

（编辑）谢谢大家。

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2009-03-11T11:03:40.317

不会有问题，它们之间的协议是由另一个通道完成的，它们基本上是独立的。

我也有他相同的设置，它工作得很好。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2009-03-11T11:05:07.070

正确，服务器或客户端的体系结构无关紧要。即便如此，SVN 也必须被严重破坏才能发挥作用。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2009-03-11T11:06:31.543

与您类似的情况，在开发工作站上使用 Vista x64，在存储库服务器上使用 2003 x32。Tortoise SVN x64 工作正常。

# wpf - 重新定义/别名 WPF 中的资源？

> ID：634069
> 
> 赞同：20
> 
> 时间：2009-03-11T11:00:50.107
> 
> 标签：wpf, resources

有没有办法重新定义/别名现有的`SolidColorBrush`（或任何其他资源，实际上）？

举个例子：我在一个外部 ResourceDictionary 中有一个画笔，我想用我自己的键而不是原始键来引用它。我不想依赖外部参考，因为将来实际的刷子很容易发生变化。

* * *

## 回答 #1

> 赞同：14
> 
> 时间：2009-03-11T12:22:00.003

```
<Window x:Class="WpfApplication1.Window1"
    xmlns="http://schemas.microsoft.com/winfx/2006/xaml/presentation"
    xmlns:x="http://schemas.microsoft.com/winfx/2006/xaml"
    Title="Window1" Height="300" Width="300">
    <Window.Resources>
        <SolidColorBrush x:Key="SomeExternalResource">Red</SolidColorBrush>
    </Window.Resources>
    <Grid>
        <Grid.Resources>
            <StaticResourceExtension ResourceKey="SomeExternalResource" x:Key="SomeAliasedResource"/>
        </Grid.Resources>

        <Border Background="{StaticResource SomeAliasedResource}"/>
    </Grid>
</Window> 
```

> 我不想依赖外部参考，因为将来实际的刷子很容易发生变化。

您仍然会依赖外部资源，只是在很多地方都没有。

* * *

## 回答 #2

> 赞同：5
> 
> 时间：2014-05-14T15:06:39.113

我有[Ruedi](https://stackoverflow.com/users/470328/ruedi-steinmann)解决方案的更新。这适用于同一资源字典中和应用程序中任何位置的资源。

```
public class Alias : MarkupExtension
{
    public string ResourceKey { get; set; }

    public Alias()
    {

    }
    public Alias(string resourceKey)
    {
        ResourceKey = resourceKey;
    }

    public override object ProvideValue(IServiceProvider serviceProvider)
    {
        return _ProvideLocalValue(serviceProvider) ?? _ProvideApplicationValue();
    }

    private object _ProvideLocalValue(IServiceProvider serviceProvider)
    {
        var rootObjectProvider = (IRootObjectProvider)
            serviceProvider.GetService(typeof(IRootObjectProvider));
        if (rootObjectProvider == null) return null;
        var dictionary = rootObjectProvider.RootObject as IDictionary;
        if (dictionary == null) return null;
        return dictionary.Contains(ResourceKey) ? dictionary[ResourceKey] : null;
    }

    private object _ProvideApplicationValue()
    {
        var value = Application.Current.TryFindResource(ResourceKey);
        return value;
    }
} 
```

用法与上面类似，但关键是在使用`Alias`的地方用作标记扩展，而不是`StaticResource`. 在应用程序资源堆栈的某处，定义资源......

```
<Application x:Class="WPF.App"
             xmlns="http://schemas.microsoft.com/winfx/2006/xaml/presentation"
             xmlns:x="http://schemas.microsoft.com/winfx/2006/xaml"
             xmlns:system="clr-namespace:System;assembly=mscorlib"
             xmlns:wpf="clr-namespace:WPF"
             StartupUri="MainWindow.xaml">
    <Application.Resources>
        <system:String x:Key="Text">Display some text.</system:String>
        <system:String x:Key="Other">4</system:String>
        <wpf:Alias x:Key="Alias" ResourceKey="Text"/>
        <wpf:Alias x:Key="Second" ResourceKey="Other"/>
    </Application.Resources>
</Application> 
```

无论您在哪里引用别名...

```
<Window x:Class="WPF.MainWindow"
        xmlns="http://schemas.microsoft.com/winfx/2006/xaml/presentation"
        xmlns:x="http://schemas.microsoft.com/winfx/2006/xaml"
        xmlns:wpf="clr-namespace:WPF"
        Title="MainWindow" Height="150" Width="300">
    <StackPanel HorizontalAlignment="Center" VerticalAlignment="Center">
        <TextBlock Text="{wpf:Alias Alias}"/>
        <TextBlock Text="{wpf:Alias Second}"/>
    </StackPanel>
</Window> 
```

我的解决方案需要引用字符串，但它适用于您想要别名的任何对象。

* * *

## 回答 #3

> 赞同：4
> 
> 时间：2011-09-22T06:29:02.190

您可以尝试使用 StaticResourceExtension，但在全局资源字典中这不起作用（奇怪的编译器和运行时错误）：

```
<ResourceDictionary 
    xmlns="http://schemas.microsoft.com/winfx/2006/xaml/presentation"
    xmlns:x="http://schemas.microsoft.com/winfx/2006/xaml" >

    <SolidColorBrush x:Key="StatusColor_OK" Color="#ff32a248" />
    <StaticResourceExtension
        x:Key="AliasKey"
        ResourceKey="StatusColor_Error" />
</ResourceDictionary> 
```

为了克服这个问题，我创建了以下类：

```
/// <summary>
/// Defines an Alias for an existing resource. Very similar to 
/// <see cref="StaticResourceExtension"/>, but it works in
///  ResourceDictionaries
/// </summary>
public class Alias: System.Windows.Markup.MarkupExtension
{
    public override object ProvideValue(IServiceProvider serviceProvider)
    {
        IRootObjectProvider rootObjectProvider = (IRootObjectProvider)
            serviceProvider.GetService(typeof (IRootObjectProvider));
        if (rootObjectProvider == null) return null;
        IDictionary dictionary =  rootObjectProvider.RootObject as IDictionary;
        if (dictionary == null) return null;
        return dictionary[ResourceKey];
    }

    public object ResourceKey { get; set; }
} 
```

用法：

```
<ResourceDictionary 
    xmlns="http://schemas.microsoft.com/winfx/2006/xaml/presentation"
    xmlns:x="http://schemas.microsoft.com/winfx/2006/xaml" >

    <SolidColorBrush x:Key="StatusColor_OK" Color="#ff32a248" />
    <Alias
        x:Key="AliasKey"
        ResourceKey="StatusColor_Error" />
</ResourceDictionary> 
```

# c# - 按下 CTRL 时禁用 DataGridViewRow 取消选择

> ID：634072
> 
> 赞同：1
> 
> 时间：2009-03-11T11:02:26.217
> 
> 标签：c#, datagridview

如果按下该`CTRL`键并单击选定的 DataGridViewRow，则该行未被选中。我怎样才能阻止这个？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-03-11T11:04:17.867

这是使用`Ctrl`. 为什么要破坏用户的预期界面？您可以通过检测选择更改来破解它（我会看看......）

（编辑） - 是的，如果你 hook 似乎可以工作`SelectionChanged`，比如：

```
DataGridViewRow[] lastSelectedRows = new DataGridViewRow[0];
void grid_SelectionChanged(object sender, System.EventArgs e) {
    if ((Control.ModifierKeys & Keys.Control) == Keys.Control) {
        foreach (DataGridViewRow row in lastSelectedRows) {
            if (!row.Selected) row.Selected = true;
        }            
    }
    DataGridViewSelectedRowCollection selected = grid.SelectedRows;
    lastSelectedRows = new DataGridViewRow[selected.Count];
    selected.CopyTo(lastSelectedRows, 0);
} 
```

# sql-server - SQL Server Compact 的 SQL 数据比较工具

> ID：634076
> 
> 赞同：1
> 
> 时间：2009-03-11T11:03:37.760
> 
> 标签：sql-server, comparison

有谁知道与 Microsoft SQL Server Compact 3.5 一起使用的类似于 RedGate 的 SQL 数据比较的工具？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2014-01-20T16:08:44.110

对我来说，以下过程有效：

1.  安装 SQL [Server Compact Toolbox](http://visualstudiogallery.msdn.microsoft.com/0e313dfd-be80-4afb-b5e9-6e74d369f7a1/)扩展。

2.  在两个数据库上运行“脚本数据库模式和数据”命令

3.  对生成的文件使用差异工具来查看更改。

    ![项目清单](https://i.stack.imgur.com/RUTui.png)

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-03-11T14:28:08.500

[最后，我通过使用Data Port Console](http://www.primeworks-mobile.com/Products/DataPortConsole.html)将我的 2 个 SQL Server Compact 数据库导出到 SQL Server Express 2005（尽管 2008 可以工作）解决了这个问题。

然后我使用[Red Gate SQL Data Compare 对](http://www.red-gate.com/products/SQL_Data_Compare/index.htm)它们进行了比较。

这个解决方案对我来说很好。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2009-03-12T11:42:45.753

不确定，但您也可以查看 Apex SQL 工具 - Apex SQL Diff 和 A​​pex SQL DataDiff。有网站在[这里](http://www.apexsql.com/sql_tools_diff.asp)。他们没有特别提到 SQL Server Compact - 但我相信您可以向他们咨询。

Red-Gate 和 Apex 是我使用任何类型 SQL 工具的第一选择 :-)

马克

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2009-03-11T13:00:49.960

您是否尝试过starinix 的[SQL 比较？](http://www.starinix.com/sqlcompare02.htm)他们说它支持 SQL Server（所有版本），因此可能包括精简版。

该软件确实可以像我使用它一样工作（对于育空地区）。它也是免费软件，无需担心许可。

# c++ - std::copy 到 std::cout 用于 std::pair

> ID：634087
> 
> 赞同：18
> 
> 时间：2009-03-11T11:06:14.553
> 
> 标签：c++, stl, namespaces, operator-overloading

我有下一个代码：

```
#include <iostream>
#include <algorithm>
#include <map>
#include <iterator>

//namespace std
//{

std::ostream& operator << ( std::ostream& out, 
                const std::pair< size_t, size_t >& rhs )
{
    out << rhs.first << ", " << rhs.second;
    return out;
}
//}

int main() 
{

    std::map < size_t, size_t > some_map;

    // fill  some_map with random values
    for ( size_t i = 0; i < 10; ++i )
    {
        some_map[ rand() % 10 ] = rand() % 100;
    }

    // now I want to output this map
    std::copy( 
        some_map.begin(), 
        some_map.end(), 
        std::ostream_iterator< 
              std::pair< size_t, size_t > >( std::cout, "\n" ) );

    return 0;
} 
```

在这段代码中，我只想将映射复制到输出流。为此，我需要定义运算符 <<(..) - 好的。但是根据名称查找规则编译器找不到我的操作符<<()。
因为 std::cout、std::pair 和 std::copy 调用了我的 operator<< - 都来自命名空间 std。

快速解决方案 - 将我的 oerator<< 添加到 std 命名空间 - 但它很难看，恕我直言。

您知道此问题的哪些解决方案或解决方法？

* * *

## 回答 #1

> 赞同：16
> 
> 时间：2009-03-11T11:14:19.887

没有标准的方法来计算 a `std::pair`，因为，你想要的打印方式可能与下一个人想要的方式不同。这是自定义仿函数或 lambda 函数的一个很好的用例。然后，您可以将其作为参数传递`std::for_each`给完成工作。

```
typedef std::map<size_t, size_t> MyMap;

template <class T>
struct PrintMyMap : public std::unary_function<T, void>
{
    std::ostream& os;
    PrintMyMap(std::ostream& strm) : os(strm) {}

    void operator()(const T& elem) const
    {
        os << elem.first << ", " << elem.second << "\n";
    }
} 
```

要从您的代码中调用此函子：

```
std::for_each(some_map.begin(),
              some_map.end(),
              PrintMyMap<MyMap::value_type>(std::cout)); 
```

* * *

## 回答 #2

> 赞同：16
> 
> 时间：2009-03-14T19:05:54.530

我已经建立了一种新的优雅方法来解决这个问题。
阅读答案时，我有很多有趣的想法：

*   包装迭代器，用于将 std::pair 转换为 std::string；

*   包装 std::pair，因为有机会重载 operator<<(...);

*   将通常的 std::for_each 与打印函子一起使用；

*   使用 std::for_each 和 boost::labda - 看起来不错，除了访问 std::pair< >::first 和 std::pair< >::second 成员；

我想我将来会使用所有这些想法来解决其他不同的问题。
但是对于这种情况，我理解我可以将我的问题表述为“将地图的数据转换为字符串并将它们写入输出流”而不是“将地图的数据复制到输出流”。我的解决方案如下所示：

```
namespace
{
std::string toString( const std::pair< size_t, size_t >& data)
{
    std::ostringstream str;
    str << data.first << ", " << data.second;
    return str.str();
}
} // namespace anonymous

std::transform( 
    some_map.begin(), 
    some_map.end(), 
    std::ostream_iterator< std::string >( std::cout, "\n" ),
    toString ); 
```

我认为这种方法比其他方法最简短、最具表现力。

* * *

## 回答 #3

> 赞同：10
> 
> 时间：2009-03-11T11:19:37.127

我只想指出，根据 C++ 标准，向 std:: 命名空间添加内容是非法的（请参阅第 17.4.3.1 节）。

* * *

## 回答 #4

> 赞同：5
> 
> 时间：2009-03-11T12:28:40.473

你想要的是一个转换迭代器。这种迭代器包装了另一个迭代器，转发所有定位方法如operator++和operator==，但重新定义了operator*和operator->。

速写：

```
template <typename ITER> 
struct transformingIterator : private ITER {
    transformingIterator(ITER const& base) : ITER(base) {}
    transformingIterator& operator++() { ITER::operator++(); return *this; }
    std::string operator*() const
    {
        ITER::value_type const& v = ITER::operator*();
        return "[" + v->first +", " + v->second + "]";
    }
... 
```

* * *

## 回答 #5

> 赞同：4
> 
> 时间：2012-10-21T15:27:05.467

只是路过，但这为我做了工作，所以它可以为其他人（剪辑版）：

```
template<typename First, typename Second>
struct first_of {
    First& operator()(std::pair<First, Second>& v) const {
        return v.first;
    }
}; 
```

给出的用例：

```
transform (v.begin (), v.end (), 
           ostream_iterator<int>(cout, "\n"), first_of<int, string> ()); 
```

* * *

## 回答 #6

> 赞同：2
> 
> 时间：2009-03-11T11:14:30.073

[我宁愿删除这个答案，但我会暂时保留它，以防有人觉得讨论有趣。]

~~因为它是对 std 库的合理扩展，所以我只是将它放在 std 命名空间中，特别是如果这是一次性的事情。如果其他人在其他地方做同样的事情，您可以将其声明为静态以防止它导致链接器错误。~~

想到的另一个解决方案是为 std::pair 创建一个包装器：

```
template<class A, class B>
struct pairWrapper {
  const std::pair<A,B> & x;
  pairWrapper(const std::pair<A,B> & x) : x(x) {}
}

template<class A,class B>
std::ostream & operator<<(std::ostream & stream, const pairWrapper<A,B> & pw) { ... } 
```

* * *

## 回答 #7

> 赞同：2
> 
> 时间：2009-03-11T14:07:44.523

使用 Boost Lambda，你可以尝试这样的事情。我拥有的Boost Lambda版本，这个实际上不起作用，我稍后会测试并修复。

```
#include <boost/lambda/lambda.hpp>
#include <boost/lambda/bind.hpp>

using namespace boost::lambda;

std::for_each( some_map.begin(), some_map.end(), 
               std::cout << bind( &std::map<size_t,size_t>::value_type::first, _1 )
                         << ","
                         << bind( &std::map<size_t,size_t>::value_type::second, _1 ) ); 
```

* * *

## 回答 #8

> 赞同：1
> 
> 时间：2016-03-18T16:07:29.537

```
 for (const auto& your_pair : your_container)
        your_stream << "[" << your_pair.first << "," << your_pair.second << "]" << endl; 
```

更简单通用！

* * *

## 回答 #9

> 赞同：1
> 
> 时间：2020-06-23T09:54:34.073

`std::copy`这是一个与类型一起使用的`std::ostream_iterator`适配器`std::pair`。您最终会持有一个额外的引用，但编译器优化可能会处理它。顺便说一句，第一个类型`std::pair`将`std::map::value_type`是`const`.

```
template <typename pair_type>
class pair_adaptor
{
public:
    const pair_type &m;
    pair_adaptor(const pair_type &a) : m(a) {}

    friend std::ostream &operator << (std::ostream &out, 
        const pair_adaptor <pair_type> &d)
    {
        const pair_type &m = d.m;
        return out << m.first << " => " << m.second;
    }
};

typedef std::map<size_t, size_t>::value_type value_type;

std::copy (mymap.begin(), mymap.end(),
    std::ostream_iterator < 
        pair_adaptor <value_type> > (std::cout, "\n"));

std::copy (mymap.begin(), mymap.end(),
    std::ostream_iterator < 
        pair_adaptor <
            std::pair<const size_t, size_t>>> (std::cout, "\n")); 
```

* * *

## 回答 #10

> 赞同：0
> 
> 时间：2014-12-14T09:07:27.270

```
 for_each(some_map.begin(), some_map.end(), [](const std::map < size_t, size_t >::value_type &ite){
             cout<<ite.first<<" "<<ite.second<<endl;

}); 
```

--- C++11 没问题

# css - 站点通过 mod_rewrite 快 5 倍，但 CSS 图像损坏

> ID：634089
> 
> 赞同：4
> 
> 时间：2009-03-11T11:06:51.107
> 
> 标签：css, .htaccess, mod-rewrite, image, subdomain

我正在使用 .htaccess 通过以下重定向加速网站：

```
request for http://example.com/images/name.jpg  routed to  http://i.example.com/name.jpg
request for http://example.com/css/name.css     routed to  http://c.example.com/name.css 
```

通过收听 Stack Overflow 播客，我了解到这可以使站点更快，因为**浏览器可以同时下载更多文件**（显然每个域有两个流，尽管这未经证实）。

确实，差异是巨大的。页面加载**速度大约是原来的五倍**！

我没有触及原始文件夹和图像——我只是使用 mod_rewrite 将地址从**example.com/images/**更改为**i.example.com/**：

```
rewritecond %{HTTP_HOST} !^i\.example\.com [NC]
rewriterule ^images/([^/]+)$ http://i.example.com/$1 [L]
rewritecond %{HTTP_HOST} !^c\.example\.com [NC]
重写 ^css/([^/]+)$ http://c.example.com/$1 [L]

```

我遇到的问题是，这种技术非常适用于 html 中包含的图像标签，但不适用于通过样式表包含的图像：

> **img src=/images/logo.jpg**完美运行
> 
> **背景：网址（/images/logo.jpg）；**不工作

服务器错误日志包含以下条目：

> 文件不存在：/var/www/html/css/images，引用者：[http ://example.com/page.html](http://example.com/page.html)

这似乎意味着重写规则的应用不正确。

如果我使用样式表工作：

> **背景：网址（[http://i.example.com/logo.jpg](http://i.example.com/logo.jpg)）；**

但是，为了避免重写所有样式表，我想知道：**为什么 url 重写不像 html img 标签那样适用于样式表**。

**[update1]** Safari 4 Beta、Firefox 3.0.3 和 Chrome 中存在此问题，但该**页面在 IE6 中完美运行**。

**[update2]**添加 [L,R=301] 和 [L,R=302] 没有帮助。

**[update3]**我根据 Gumbo 的以下建议尝试了以下方法：

如果路径与主机名不匹配，则在外部重定向：

```
rewritecond %{HTTP_HOST}     !^i\.domain\.com$
rewriterule ^images/([^/]+)$ http://i.domain.com/$1 [L,R=301]
rewritecond %{HTTP_HOST}     !^c\.domain\.com$
rewriterule ^css/([^/]+)$    http://c.domain.com/$1 [L,R=301] 
```

内部重定向；如果有不必要的文件夹名称，请将其删除（请参阅上面的服务器错误）：

```
rewritecond %{HTTP_HOST}     ^i\.domain\.com$
rewriterule ^images/([^/]+)$ $1 [L]
rewritecond %{HTTP_HOST}     ^c\.domain\.com$
rewriterule ^css/([^/]+)$    $1 [L] 
```

它仍然没有工作。奇怪的是，服务器错误是：

> 文件不存在：/var/www/html/css/var，引用者： http: [//domain.com/page.html](http://domain.com/page.html)

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-03-11T12:50:31.980

我能够通过**不尝试将目录合并到子域**来解决此问题：

```
请求 domain.com/images/ 路由到 i.domain.com/images/
对 domain.com/css/ 的请求路由到 c.domain.com/css/

```

它完美地工作并且**仍然非常快**。

现代浏览器中似乎存在一个**错误**，其中重定向的 css 请求将**仅应用新域**，将原始目录作为请求的一部分：

**如果url(domain.com/images/name.jpg)**的 css 图片被重定向到**i.domain.com/name.jpg**，浏览器会错误地请求**i.domain.com/images/name.jpg**。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-03-11T12:52:53.067

如果所有主机名都使用相同的虚拟主机，我找到了解决此问题的方法：

```
# redirect externally if path doesn’t match host name
RewriteCond %{HTTP_HOST} !^i\.example\.com$
RewriteRule ^images/([^/]+)$ http://i.example.com/$1 [L,R=301]
RewriteCond %{HTTP_HOST} !^c\.example\.com$
RewriteRule ^css/([^/]+)$ http://c.example.com/$1 [L,R=301]

# redirect internally to the file
RewriteCond %{HTTP_HOST} ^i\.example\.com$
RewriteRule !^images/ images%{REQUEST_URI} [L]
RewriteCond %{HTTP_HOST} ^c\.example\.com$
RewriteRule !^css/ css%{REQUEST_URI} [L] 
```

这将执行以下操作：

```
http://example.com/css/foo       externally to    http://c.example.com/foo
http://c.example.com/foo         internally to    /css/foo

http://example.com/images/bar    externally to    http://i.example.com/bar
http://i.example.com/bar         internally to    /images/bar 
```

以及更正不匹配的路径和主机名：

```
http://i.example.com/css/foo     externally to    http://c.example.com/foo
http://c.example.com/images/bar  externally to    http://i.example.com/bar 
```

当请求的样式表`http://example.com/css/foo`被重定向到`http://c.example.com/foo`并且样式表内部的图像 URI 引用`/images/bar`从这个新的基本 URI 解析并因此导致`http://c.example.com/images/bar`而不是初始的`http://example.com/images/bar`.

# unix - zcat 到 grep 文件名

> ID：634090
> 
> 赞同：2
> 
> 时间：2009-03-11T11:06:54.600
> 
> 标签：unix, grep, zcat

```
ls -ltr|grep 'Mar  4'| awk '{print $9 }'|xargs zcat -fq |grep  12345 
```

我现在使用这个命令来列出包含我的数字字符串的记录我怎样才能得到这个命令来打印找到字符串的文件的名称？

谢谢

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2009-03-11T11:09:29.773

使用[zgrep](http://linux.about.com/library/cmd/blcmdl1_zgrep.htm)

顺便提一句。你想做的事情可以用[find来完成](http://linux.about.com/od/commands/l/blcmdl1_find.htm)

```
find  -newermt 'Mar 4' -and ! -newermt 'Mar 5' -exec zgrep -l '12345' {} \; 
```

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2009-03-11T11:14:46.890

如果你使用**zgrep**而不是 zcat+grep （它做同样的事情），你这样做像这样的选项：

```
ls -ltr | grep 'Mar 4' | awk '{print $9}' | xargs zgrep 12345 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-03-11T11:10:41.267

`-t`将选项传递给`xargs`，使其在运行`zcat`之前打印正在运行的命令（命令，包括文件名）。该命令被打印到 stderr，因此它不会干扰您的管道。

# java - 如何使用 JMX 公开 HTTP 返回（错误）代码？

> ID：634092
> 
> 赞同：0
> 
> 时间：2009-03-11T11:07:53.037
> 
> 标签：java, tomcat, statistics, jmx

我们希望监控 HTTP 错误代码（例如每分钟）以供以后绘制图表。

我们如何使用 JMX 公开 HTTP 返回（错误）代码？

是否有代码示例或者您是否做过类似的事情？这是否默认包含在 Tomcat 中？

*关于实现：*代码是否应该每分钟增加一个 JMX 计数器并将其设置为 0？感谢您的想法。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-03-11T11:32:06.850

添加一个 JMX bean，每个你关心的 HTTP 错误都有一个字段。随着错误的出现，增加每个字段。JMX 控制台将把它变成一条漂亮的曲线。我不会重置该值，但这主要取决于您的控制台必须显示值的统计信息的功能。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-03-11T12:38:08.623

如果您正在寻找错误率并绘制它们，您最好让服务器返回*错误总数*。这样，客户端就可以得出一个独立于服务器的速率（例如每分钟/每小时/每天）。

更重要的是，您不会错过任何临时的数据激增。如果服务器正在导出一个速率并且您的客户端进程没有获取它（例如，如果它没有在那个特定时间进行监控），那么它就会永远丢失。而维护计数将记录错误总数。

SNMP 代理（和类似的）采用这种方法，允许客户端监控和派生他们认为合适的值。

# castle-windsor - 在 Castle Windsor 配置文件中存储密码？

> ID：634100
> 
> 赞同：0
> 
> 时间：2009-03-11T11:11:56.477
> 
> 标签：castle-windsor, passwords

我有以下内容：

```
interface IDefectRepository { /* ... */ }
class MyDefectRepository : IDefectRepository
{
    public MyDefectRepository(string url, string userName, string password)
    {
        // ...
    }

    // ...
} 
```

我正在使用 <parameters> 从 Web.config 传递构造函数参数。有什么方法可以将加密的密码存储在 Web.config 文件中？其他建议？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-03-11T11:17:46.960

尝试继承`MyDefectRepositoryWithEncryptedPasswords`自`MyDefectRepository`. 在`MyDefectRepositoryWithEncryptedPasswords`构造函数中解密密码并将其传递给`MyDefectRepository`构造函数，如下所示：

```
class MyDefectRepositoryWithEncryptedPasswords : MyDefectRepository
{
    public MyDefectRepositoryWithEncryptedPasswords(string url, string userName, string encryptedPassword)
        : base(url, userName, Decrypt(encryptedPassword))
    {
    }

    public static string Decrypt(string encrypted)
    {
        // Do whatever...
    }
} 
```

无论如何，我认为您不应该使用双向加密方法存储加密密码。您应该使用某种散列（加密类型）并比较散列。这将需要更改您的构造函数以接收不是密码，而是它的哈希值。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-03-11T23:54:14.303

You could inject the password via a [ISubDependencyResolver](http://www.castleproject.org/container/documentation/trunk/manual/mktypedocs/Generated_ISubDependencyResolver.html) ([sample1](http://bugsquash.blogspot.com/2008/09/changing-windsor-components.html), [sample2](http://www.candland.net/blog/2008/05/02/CastleMicroKernelShowsItsStrengthP2.aspx)) which would get the password from an [encrypted section](http://msdn.microsoft.com/en-us/library/zhhddkxy.aspx) in your web.config.

# java - Log4j 正在挂起我的应用程序我做错了什么？

> ID：634102
> 
> 赞同：13
> 
> 时间：2009-03-11T11:13:28.953
> 
> 标签：java, multithreading, log4j, deadlock

首先是应用程序的一些背景。我有一个应用程序通过线程池并行处理许多独立任务。线程池现在挂起。

以下是我的线程转储中的一个片段，我在 pool-2 中的所有线程都被“pool-2-thread-78”阻塞。试图写入控制台似乎被锁定，我觉得这非常奇怪。任何人都可以为我阐明情况吗？

**编辑**：平台详细信息 java 版本“1.6.0_07”Java(TM) SE 运行时环境（构建 1.6.0_07-b06）Java HotSpot(TM) 客户端 VM（构建 10.0-b23，混合模式，共享）

Ubuntu Linux 服务器双四核机器。

它似乎在写入打印流时被锁定，我考虑过只删除控制台附加程序，但是我宁愿知道它为什么会阻塞并根据这些知识将其删除。在过去，删除并查看它是否有效又回来咬我:)

我的 log4j 中的相关部分

> log4j.rootLogger=调试，STDOUT log4j.logger.com.blah=INFO，LOG log4j.appender.STDOUT=org.apache.log4j.ConsoleAppender log4j.appender.LOG=org.apache.log4j.FileAppender

线程转储提取

> "pool-2-thread-79" Id=149 在 org.apache.log4j.spi.RootLogger@6c3ba437 上被阻塞，由 org.apache.log4j.Category.callAppenders 上的 "pool-2-thread-78" Id=148 拥有（ Category.java:201) 在 org.apache.log4j.Category.forcedLog(Category.java:388) 在 org.apache.log4j.Category.error(Category.java:302) 在 com.blah.MessageProcessTask.run(MessageProcessTask .java:103) 在 java.util.concurrent.FutureTask$Sync.innerRun(FutureTask/java:268) 在 java.util.concurrent 的 java.util.concurrent.Executors$RunnableAdapter.call(Executors.java:441)。 FutureTask.run(FutureTask/java:54) at java.util.concurrent.ThreadPoolExecutor$Worker.runTask(ThreadPoolExecutor.java:885) at java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:907) at java .lang.Thread.run(Thread.java:619)
> 
> "pool-2-thread-78" Id=148 在 java.io.FileOutputStream.write(FileOutputStream.java:260) 在 java.io.FileOutputStream.writeBytes(Native Method) 在 java.io.BufferedOutputStream.write(BufferedOutputStream) 可运行.java:105) - 在 java.io.PrintStream.write(PrintStream.java:430) 处锁定 <0x6f314ba4> (a java.io.BufferedOutputStream) - 在 org.apache 处锁定 <0xd5d3504> (a java.io.PrintStream) .log4j.ConsoleAppender$SystemOutStream.write(ConsoleAppender.java:173) 在 sun.nio.cs.StreamEncoder.writeBytes(StreamEncoder.java:202) 在 sun.nio.cs.StreamEncoder.implFlushBuffer(StreamEncoder.java:272) 在sun.nio.cs.StreamEncoder.implFlush(StreamEncoder.java:276) 在 sun.nio.cs.StreamEncoder.flush(StreamEncoder.java:122) - 在 java 锁定 <0x6243a076> (a java.io.OutputStreamWriter)。io.OutputStreamWriter.flush(OutputStreamWriter.java:212) at org.apache.log4j.helpers.QuietWriter.flush(QuietWriter.java:57) at org.apache.log4j.WriterAppender.subAppend(WriterAppender.java:315) at org org.apache.log4j.AppenderSkeleton.doAppend(AppenderSkeleton.java:230) 处的 .apache.log4j.WriterAppender.append(WriterAppender.java:159) - 锁定 <0x45dbd560>（org.apache.log4j.ConsoleAppender）在 org. org.apache.log4j.Category.callAppenders(Category.java:203) 处的 apache.log4j.helpers.AppenderAttachableImpl.appendLoopOnAppenders(AppenderAttachableImpl.java:65) - 锁定 <0x6c3ba437> (一个 org.apache.log4j.spi.RootLogger)在 org.apache.log4j.Category.forcedLog(Category.java:388) 在 org.apache.log4j.Category.error(Category.java:302) 在 com.blah.MessageProcessTask.run(MessageProcessTask.java:103) 在 java.util.concurrent.Executors$RunnableAdapter.call(Executors.java:441) 在 java.util.concurrent.FutureTask$Sync.innerRun(FutureTask/java:268) 在 java.util.concurrent.FutureTask.run (FutureTask/java:54) 在 java.util.concurrent.ThreadPoolExecutor$Worker.runTask(ThreadPoolExecutor.java:885) 在 java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:907) 在 java.lang。线程运行（线程.java：619）第907章）第907章）

* * *

## 回答 #1

> 赞同：12
> 
> 时间：2009-03-11T13:10:08.050

您可以使用 AsyncAppender 更好地将记录器与附加器分离。

在 Windows 上，如果您单击控制台窗口，这将暂停控制台，例如标准输出缓冲区将填满，并且随着控制台附加程序串行写入，您的应用程序将挂起，直到您释放控制台（按 enter 左右）。

考虑将 AsyncAppender 与 log4j 一起使用 - 大多数情况下这是个好主意 - 唯一的问题 - AsynAppender 缓冲区在退出时没有完全刷新。

* * *

## 回答 #2

> 赞同：11
> 
> 时间：2009-03-11T11:25:40.593

首先，我相信 log4j 会串行写入文件和控制台，否则您的所有日志都会被损坏。因此，当一个线程正在写入另一个想要写入的线程时，必须等到另一个线程完成。此外，如果另一端连接到它的任何东西没有耗尽它，stdout 可能会阻塞。

在 unix 中有一个特殊的文件描述符，称为 stdout。当您在控制台中启动应用程序时，标准输出将附加到控制台。您还可以将标准输出重定向到其他文件。例如：java Blah > /dev/null。您可能有标准输出指向一个正在填满的文件。例如，管道是一个文件，如果另一端的程序没有耗尽管道，那么写入管道的程序最终将阻塞。

# python - 用 Python 编写基于套接字的服务器，推荐的策略？

> ID：634107
> 
> 赞同：9
> 
> 时间：2009-03-11T11:15:27.683
> 
> 标签：python, sockets, asynchronous, network-programming, c10k

我最近正在阅读[这篇文档](http://www.kegel.com/c10k.html)，其中列出了一些可用于实现套接字服务器的策略。即，它们是：

1.  每个线程为多个客户端提供服务，并使用非阻塞 I/O 和级别触发的就绪通知
2.  每个线程为多个客户端提供服务，并使用非阻塞 I/O 和就绪更改通知
3.  每个服务器线程为多个客户端提供服务，并使用异步 I/O
4.  使用每个服务器线程为一个客户端提供服务，并使用阻塞 I/O
5.  将服务器代码构建到内核中

**现在，我会很感激在 CPython**中应该使用哪个提示，我们知道它有一些优点，也有一些缺点。我最感兴趣的是高并发下的性能，是的，当前的一些实现太慢了。

因此，如果我可以从简单的开始，“5”就出来了，因为我不会将任何东西侵入内核。

“4” 看起来它也因为 GIL 而必须出局。当然，您可以在这里使用多处理来代替线程，这确实会带来显着的提升。阻塞 IO 还具有更容易理解的优点。

在这里，我的知识有所减弱：

“1”是传统的选择或轮询，可以简单地与多处理结合。

"2" 是准备更改通知，由较新的 epoll 和 kqueue 使用

“3”我不确定是否有任何具有 Python 包装器的内核实现。

因此，在 Python 中，我们有很多很棒的工具，比如 Twisted。也许它们是一种更好的方法，尽管我已经对 Twisted 进行了基准测试，发现它在多处理器机器上太慢了。我不知道，也许用负载平衡器进行 4 次扭曲可能会做到这一点。任何意见，将不胜感激。

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2009-03-11T12:07:05.283

[`asyncore`](http://docs.python.org/library/asyncore.html)基本上是“1”——它在`select`内部使用，你只有一个线程处理所有请求。根据文档，它也可以使用`poll`. （编辑：删除了 Twisted 引用，我认为它使用了 asyncore，但我错了）。

“2”可能是用[python-epoll](http://sourceforge.net/projects/pyepoll)实现的（刚用谷歌搜索过——以前从未见过）。编辑：（来自评论）在 python 2.6 中，[选择模块](http://docs.python.org/library/select.html)具有 epoll、kqueue 和 kevent 内置（在支持的平台上）。因此，您不需要任何外部库来执行边缘触发服务。

不要排除“4”，因为当线程实际上正在执行或等待 IO 操作时（大部分时间可能），GIL 将被丢弃。如果你有大量的连接当然是没有意义的。如果您有很多处理工作要做，那么 python 可能对这些方案中的任何一个都没有意义。

对于灵活性，也许看看[Twisted](http://twistedmatrix.com/trac/)？

在实践中，您的问题归结为您将对请求进行多少处理。如果您有很多处理，并且需要利用多核并行操作，那么您可能需要多个进程。另一方面，如果您只需要侦听大量连接，那么使用少量线程的 select 或 epoll 应该可以工作。

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2009-03-11T15:07:41.447

“叉子”怎么说？（我假设这就是 ForkingMixIn 所做的）如果请求是在“无共享”（数据库或文件系统除外）架构中处理的，fork() 在大多数 *nixes 上启动得很快，你不必担心关于线程的所有愚蠢错误和并发症。

线程是具有过重进程的操作系统强加给我们的一种设计疾病，恕我直言。克隆具有写时复制属性的页表似乎是一个很小的代价，尤其是在您运行解释器的情况下。

抱歉，我不能更具体，但我更像是一个从 Perl 过渡到 Ruby 的程序员（当我在工作中不为大量 Java 苦苦挣扎时）

* * *

更新：我终于在“业余时间”中对线程与分叉进行了一些计时。看看这个：

[http://roboprogs.com/devel/2009.04.html](http://roboprogs.com/devel/2009.04.html)

扩展： [http ://roboprogs.com/devel/2009.12.html](http://roboprogs.com/devel/2009.12.html)

* * *

## 回答 #3

> 赞同：3
> 
> 时间：2010-07-11T03:07:11.470

一种解决方案是gevent。[Gevent](http://www.gevent.org/)将基于 libevent 的事件轮询与由 greenlet 实现的轻量级协作任务切换结合在一起。

你得到的是一个事件系统的所有性能和可扩展性，以及阻塞 IO 编程的优雅和简单的模型。

（我不知道关于回答真正老问题的 SO 约定是什么，但我决定还是加我的 2 美分）

* * *

## 回答 #4

> 赞同：2
> 
> 时间：2009-03-11T15:06:58.657

我可以建议其他链接吗？

[cogen](http://code.google.com/p/cogen/)是一个跨平台的库，用于面向网络的、基于协程的编程，使用来自 python 2.5 的增强生成器。在 cogen 项目的主页上，有几个具有类似目的的项目的链接。

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2009-03-11T11:30:19.550

[http://docs.python.org/library/socketserver.html#asynchronous-mixins](http://docs.python.org/library/socketserver.html#asynchronous-mixins)

至于多处理器（多核）机器。由于[GIL](http://docs.python.org/glossary.html#term-global-interpreter-lock)而使用 CPython ，每个核心至少需要一个进程才能进行扩展。正如您所说，您需要 CPython，您可能会尝试使用`ForkingMixIn`. 使用 Linux 2.6 可能会产生一些有趣的结果。

其他方法是使用[Stackless Python](http://www.stackless.com/)。EVE就是这样[解决](http://www.slideshare.net/Arbow/stackless-python-in-eve)的。但我明白这并不总是可能的。

* * *

## 回答 #6

> 赞同：1
> 
> 时间：2009-03-11T12:22:29.630

我喜欢道格拉斯的回答，但顺便说一句......

您可以使用集中式调度线程/进程来侦听就绪通知，[`select`](http://docs.python.org/library/select.html?highlight=select#module-select)并委托给工作线程/[进程](http://docs.python.org/library/multiprocessing.html#module-multiprocessing)池来帮助实现并行目标。

然而，正如 Douglas 所提到的，GIL 不会在最长时间的 I/O 操作期间保留（因为没有发生 Python-API 事情），所以如果您担心响应延迟，您可以尝试移动您的关键部分CPython API 的代码。

# javascript - 为 IE 中托管的 WinForms 控件实现类似于原型的功能

> ID：634110
> 
> 赞同：0
> 
> 时间：2009-03-11T11:16:44.530
> 
> 标签：javascript, winforms, internet-explorer, com

我`WinForms`在 IE 中使用控件。与此类似的东西：

```
var MyControl = new ActiveXObject("MyComponent.MyControl") 
```

我希望能够为 MyControl 使用原型功能：

```
MyControl.prototype.newFunc = function(){
    alert('hi there');
} 
```

有可能吗？我想过`System.Runtime.InteropServices.Expando`，但我找不到任何关于它的全面文档。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2009-03-11T16:57:36.193

我不认为有任何方法可以修改 ActiveX 对象的原型，因为它们不是从本机 js 对象继承的，因此没有原型。

# c# - 使用 GetType().Name 在事件处理程序中投射发件人对象

> ID：634112
> 
> 赞同：31
> 
> 时间：2009-03-11T11:18:03.933
> 
> 标签：c#, late-binding

我有一个文本框和 RichTextBox 的事件处理程序。代码相同，但

在处理程序＃1中，我这样做：

```
RichTextBox tb = (RichTextBox)sender 
```

相应地在处理程序＃2中：

```
TextBox tb = (TextBox)sender 
```

这样做我可以完全操纵发送控制。我想知道的是如何根据其类型将发送对象转换为 Textbox 或 RichTextbox

```
sender.GetType().Name 
```

然后在运行时创建控件并使用它。这样我只需要一个事件处理函数：更少的代码、更少的错误、更容易维护和 DRY :-)

* * *

## 回答 #1

> 赞同：35
> 
> 时间：2009-03-11T11:22:47.667

你永远不必施放。我刚开始的时候也这么想，这个“模式”是不正确的，而且不合逻辑。

你最好的选择是使用类似的东西：

```
if (sender is TextBox)
{
  TextBox tb = (TextBox)sender;
}
else if (sender is RichTextBox)
{
  RichTextBox rtb = (RichTextBox)sender;
}
else
{
  // etc
} 
```

* * *

## 回答 #2

> 赞同：9
> 
> 时间：2012-07-08T19:46:39.647

我知道这是一篇非常古老的帖子，但在 Framework 4 中，您可以将发件人转换为控件：

```
Control cntrl = (Control)sender;
cntrl.Text = "This is a " + sender.GetType().ToString(); 
```

请注意，您只能引用所有不同控件共有的控件（即文本）。

* * *

## 回答 #3

> 赞同：7
> 
> 时间：2009-03-11T11:22:31.973

而不是你可以使用的类型名称'[是](https://docs.microsoft.com/en-us/dotnet/csharp/language-reference/keywords/is)'。

如果您只想知道类型并且不需要对象引用：

```
if (sender is RichTextBox)
{
    // ...
}
else if (sender is TextBox)
{
    // ...
} 
```

但是，您通常确实需要该对象：C#7 有一个很好的语法，允许您测试并内联获取值：

```
if (sender is RichTextBox richTextBox)
{
    richTextBox.Text = "I am rich";
}
else if (sender is TextBox textBox)
{
    textBox.Text = "I am not rich";
} 
```

* * *

## 回答 #4

> 赞同：4
> 
> 时间：2009-03-11T11:22:25.513

```
RichTextBox textbox = sender as RichTextBox;
if (textbox != null)
{
   // do stuff as a rtb
   textbox.Text = "I'm a rtb";
   return;
}

TextBox textbox = sender as TextBox;
if (textbox != null)
{
   // do stuff as a textbox
   textbox.Text = "I'm a textbox";
} 
```

* * *

## 回答 #5

> 赞同：3
> 
> 时间：2009-03-11T11:22:33.580

转换只能在编译时完成，因此您需要知道要在编译时转换为的类型。因此，在强制转换时不能使用运行时类型（由 GetType() 返回）。

如果您正在寻找的是多态性，您可以通过反射访问 Name 属性。我不会那样做只是为了能够重用事件处理程序。

如果你想要强类型，两个发送者上的公共基类或接口是唯一的方法。

* * *

## 回答 #6

> 赞同：3
> 
> 时间：2009-03-11T11:23:37.900

根据您需要的属性，您可以将发件人转换为 TextBoxBase，因为 TextBox 和 RichTextBox 都继承自该子类。

* * *

## 回答 #7

> 赞同：1
> 
> 时间：2013-10-08T22:51:14.773

上述代码的通用版本：

```
public static void CastAndUse<T>(object item, Action<T> action) where T : class
{
    T thing = item as T;

    if (thing != null)
    {
        action(thing);
    }
} 
```

用作：

```
CastAndUse(sender, new Action((foo) => foo = bar)); 
```

不完美，但很方便。

* * *

## 回答 #8

> 赞同：1
> 
> 时间：2017-07-06T20:44:28.247

您还可以使用 inline-temporary 变量为您处理强制转换。

```
if (sender is RichTextBox tb)
{
    // ... //
} 
else if (sender is TextBox tb)
{
    // ... //
} 
```

* * *

## 回答 #9

> 赞同：0
> 
> 时间：2009-03-11T11:22:57.760

如果代码相同，你需要关心吗？我想知道是否铸造`Control`不会给你你需要的一切......

一个复杂的处理程序不一定比几个简单的处理程序好。无论哪种方式，如果你*必须*走这条路，“as”/“is”是可取的（它不依赖于字符串等）：

```
TextBox tb = sender as TextBox;
if(tb!=null) {/* TextBox specific code */}
... 
```

* * *

## 回答 #10

> 赞同：0
> 
> 时间：2009-03-11T11:29:52.347

如果您不想重复代码，那么您可以强制转换两个控件，将常用操作重构为以 TextBoxBase 作为参数的单独方法。并且在您的事件处理程序中将控件转换为 System.Windows.Forms.TextBoxBase，因为这两个控件都派生自 TexbBoxBase 并调用该方法。

请注意，如果您需要任何这些控件的特定属性，则此重构将不起作用。

# javascript - 用图片库交换 div (Javascript)

> ID：634114
> 
> 赞同：0
> 
> 时间：2009-03-11T11:18:46.367
> 
> 标签：javascript

我现在拥有的是一个预览窗口，当点击它时，它会隐藏以显示一个包含图片库的 div。然而，这是一个瞬间的转变，我希望它是平滑的。图片库是[Smoothgallery](http://smoothgallery.jondesign.net/)。我找到了一种平滑扩展 div 的方法，但这会破坏画廊。由于图库是基于 Mootools 的，有人可以向我展示一种平滑扩展 div 的方法，同时使用 mootools 保持图像库完整吗？

```
<div id="initDiv"> 
    <?php if (has_thumbnail_image($post)) : ?>
        <div onClick="HideDIV('initDiv');animatedcollapse.show('mainDiv');startGallery();"><?php echo thumbnail_image_overlay($post, 580); ?></div>
    <? else: ?>
        <img src='http://localhost:8888/Bionic/bionic-wordpress/bionic-dev/wp-content/themes/bionic/images/black.jpg'>
    <?php endif; ?>
</div>

<div id="mainDiv" style="display:none;">
    <script type="text/javascript">
        function startGallery() {
            var myGallery = new gallery($('myGallery'), {
                timed: false,
                defaultTransition: "fadeslideleft"
            });
        }
        //window.onDomReady(startGallery);
    </script>
    <div id="myGallery">
    <?php echo all_images($post); ?>
    </div>
</div> 
```

任何帮助将不胜感激，谢谢。

编辑

当我扩展图库时，我在 firebug 中收到此错误：element.getElements 不是函数（jd.gallery.js（第 147 行））。我取出平滑扩展，它就消失了。

第二次编辑

我用来显示要扩展的 div 的代码：

```
<span onClick="HideDIV('initDiv');animatedcollapse.show('imgDiv');startGallery();><img></span> 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2009-03-11T11:28:55.390

该错误表明 JS 库无法将其挂钩安装到 DIV 中（getElements() 不是 HTML 元素的标准函数）。你如何获得指向 DIV 的指针？document.getElementByID()？或者你在使用你的 JS 库的元素查找功能？

# wpf - 什么是 .baml 文件？

> ID：634121
> 
> 赞同：35
> 
> 时间：2009-03-11T11:20:04.570
> 
> 标签：wpf, xaml, baml

什么是 .baml 文件，这个文件有什么用？谁创建了这个文件？

* * *

## 回答 #1

> 赞同：46
> 
> 时间：2009-03-11T11:20:47.810

已编译的 XAML 文件。

[维基百科说](http://en.wikipedia.org/wiki/Extensible_Application_Markup_Language#Technology)：

> XAML 文件可以编译为 .baml（二进制 XAML）文件，该文件可以作为资源插入到 .NET Framework 程序集中。在运行时，框架引擎从程序集资源中提取 .baml 文件，对其进行解析，并创建相应的 WPF 可视化树或工作流。

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2009-03-11T11:22:12.347

.baml = 二进制应用程序标记文件，已编译的 XAML 文件。

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2013-07-27T16:22:04.673

BAML 形式是 WPF XAML 实现使用的 XAML 的优化形式。它在某种意义上进行了优化，它为常用类型或成员使用内部查找和标记。该优化可用作解决涉及 XAML 的 WPF 应用程序方案的打包大小和加载时间的实现细节。 [关于 Msdn 的完整主题](http://msdn.microsoft.com/en-us/library/system.windows.baml2006.baml2006reader.aspx)

* * *

## 回答 #4

> 赞同：-2
> 
> 时间：2013-06-18T19:48:30.203

BAML 的目的只是检查生成的 WPF 控件是否在其属性中具有正确的值。编译后的 XAML 也有其自动生成的 *.cs 代码。您可以在您的 app\DEBUG\OBJ 目录中查看。每个 XAML 文件都生成了 cs. 它的名称是 XAMLfileName.g.cs，其中 g 表示生成。

# sql-server - 从 XML 转换为 SQL Server 日期时间时出现毫秒错误

> ID：634122
> 
> 赞同：12
> 
> 时间：2009-03-11T11:20:11.137
> 
> 标签：sql-server, xml, sql-server-2005

我遇到了将日期时间从 XML (ISO8601: yyyy-mm-ddThh:mi:ss.mmm) 转换为 SQL Server 2005 日期时间的问题。问题是转换毫秒时是错误的。我已经使用 nvarchar 中的 convert(datetime, MyDate, 126) 测试了隐式和显式转换，结果是一样的：

```
Original                Result
2009-10-29T15:43:12.990 2009-10-29 15:43:12.990
2009-10-29T15:43:12.991 2009-10-29 15:43:12.990
2009-10-29T15:43:12.992 2009-10-29 15:43:12.993
2009-10-29T15:43:12.993 2009-10-29 15:43:12.993
2009-10-29T15:43:12.994 2009-10-29 15:43:12.993
2009-10-29T15:43:12.995 2009-10-29 15:43:12.997
2009-10-29T15:43:12.996 2009-10-29 15:43:12.997
2009-10-29T15:43:12.997 2009-10-29 15:43:12.997
2009-10-29T15:43:12.998 2009-10-29 15:43:12.997
2009-10-29T15:43:12.999 2009-10-29 15:43:13.000 
```

我的非广泛测试显示最后一位数字是 0、3 或 7。这是一个简单的舍入问题吗？毫秒精度很重要，失去/获得一个或两个不是一种选择。

* * *

## 回答 #1

> 赞同：20
> 
> 时间：2009-03-11T11:21:29.027

是的，`SQL Server`将时间舍入到`3.(3)`毫秒：

```
SELECT CAST(CAST('2009-01-01 00:00:00.000' AS DATETIME) AS BINARY(8))
SELECT CAST(CAST('2009-01-01 00:00:01.000' AS DATETIME) AS BINARY(8))

0x00009B8400000000
0x00009B840000012C 
```

如您所见，这些`DATETIME`' 相差`1`秒，它们的二进制表示相差`0x12C`，即`300`十进制。

这是因为`SQL Server`将`time`部分存储为从午夜`DATETIME`开始的第二个滴答声。`1/300`

如果您想要更高的精度，则需要将`TIME`零件存储为单独的值。例如，将四舍五入到秒的时间存储为`DATETIME`，并将毫秒或您需要的任何精度存储`INTEGER`在另一列中。

这将允许您使用复杂`DATETIME`的算术，例如添加月份或在 's 上查找工作日`DATETIME`，您可以添加或减去毫秒并将结果连接`.XXXXXX+HH:MM`起来以获得有效的`XML`表示。

* * *

## 回答 #2

> 赞同：7
> 
> 时间：2009-03-11T12:04:10.953

由于[Quassnoi 提到的精度问题，](https://stackoverflow.com/questions/634122/milliseconds-wrong-when-converting-from-xml-to-sql-server-datetime/634127#634127)如果您可以选择使用 SqlServer 2008，您可以考虑使用[datetime2 数据类型](http://technet.microsoft.com/en-us/library/bb677335.aspx#)，或者如果您只关心时间部分，您可以使用[time 数据类型](http://technet.microsoft.com/en-us/library/bb677243.aspx)

[日期和时间数据类型](http://technet.microsoft.com/en-us/library/ms186724.aspx#DateandTimeDataTypes)- 列出所有类型及其准确性

在 Sql Server 2005 中，如果我需要 1 毫秒的精度，我将添加一个额外的 int 类型的毫秒列来存储毫秒数并从 dateTime 列中删除毫秒部分（将其设置为 000）。假设您还需要日期信息。

# objective-c - UIActionSheet - 未知数量的按钮，如何知道要调用什么？

> ID：634128
> 
> 赞同：1
> 
> 时间：2009-03-11T11:21:32.367
> 
> 标签：objective-c, iphone, uikit

我有一个 UIActionSheet 按钮数量未定。我需要使用委托方法 buttonClickedAtIndex: （或类似的方法）来决定当用户单击按钮时要调用什么方法。

问题是：在不同的情况下，不同的按钮会出现在不同的索引处，我如何决定点击哪个按钮？

一种解决方案是查看按钮的标题并采取行动 - 但这是丑陋的、不可本地化的并且只是不好的做法。

有任何想法吗？

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2009-03-11T12:44:41.930

在这种情况下，单个控制器可能会显示多个工作表，但您知道每个工作表上会出现哪些按钮？如果是这样，您可以使用工作表的标签属性来区分它们。

```
- (IBAction)showEditSheet:(id)sender {
    UIActionSheet * sheet = [[UIActionSheet alloc] initWith...];
    sheet.tag = 1;
    [sheet showInView:self.view];
}
- (IBAction)showDeleteSheet:(id)sender {
    UIActionSheet * sheet = [[UIActionSheet alloc] initWith...];
    sheet.tag = 2;
    [sheet showInView:self.view];
}
- (void)actionSheet:(UIActionSheet *)actionSheet
  clickedButtonAtIndex:(NSInteger)buttonIndex {
    switch(actionSheet.tag) {
        case 1:
            // This is the edit sheet
            switch(buttonIndex) { ... }
            break;

        case 2:
            // This is the delete sheet
            switch(buttonIndex) { ... }
            break;

        default:
            NSAssert(NO, @"Unknown action sheet");
    }
} 
```

# wcf - WCF 协议异常

> ID：634139
> 
> 赞同：3
> 
> 时间：2009-03-11T11:23:30.880
> 
> 标签：wcf, exception, performance

我们从部署在远程系统上的服务中得到了一些奇怪的行为，我们用它来访问和发布数据。

从服务中检索信息似乎不是问题。但是，每当我们尝试在服务上执行插入方法时，我们都会得到一个`System.ServiceModel.ProtocolException`. 奇怪的是，它会在出错之前成功执行大约 40 条记录。

客户端通过 SSL 进行通信，并且在 wsHttpBinding 上启用了 TransportWithMessageSecurity。

在“设置安全会话活动”中生成错误消息：

> System.ServiceModel.ProtocolException，System.ServiceModel，版本=3.0.0.0，文化=中性，PublicKeyToken=b77a5c561934e089
> 
> 响应消息的内容类型 text/html 与绑定的内容类型不匹配 (application/soap+xml; charset=utf-8)。如果使用自定义编码器，请确保正确实现 IsContentTypeSupported 方法。

我们已经尝试了许多测试，一旦我们达到特定数量的插入，所有这些测试都会出现故障。

任何建议，将不胜感激。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2011-04-06T05:23:51.397

ASP.NET 可能没有正确配置 .NET 4.0 导航到 .NET 4.0 的安装位置，然后尝试运行以下命令重新安装它：

```
C:\Windows\Microsoft.NET\Framework64\v4.0.30319>aspnet_regiis.exe -iru 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-07-09T16:05:19.930

如果一段代码向您发送 HTML，那么您可能应该阅读它以了解它的内容。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2009-03-11T11:32:36.160

我想知道[跟踪查看器](http://msdn.microsoft.com/en-us/library/aa751795.aspx)是否会在这里有所启发？不知道是什么问题，怕是...

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2009-07-09T16:11:40.217

您可能已达到配置的消息大小，并且 WCF 基础结构正在截断 SOAP 消息，从而使序列化程序（合同或 XML 序列化程序）无法反序列化消息。

尝试增加 WCF 请求大小见[< readerQuotas >](http://msdn.microsoft.com/en-us/library/ms731325.aspx)

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2011-11-23T09:50:18.103

这可以帮助某人。我的问题是：我有一个使用 WCF 服务的网站。部署网站后，我也忘记部署 WCF 服务了。

部署 WCF 服务后，一切正常。

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2016-07-15T06:55:09.743

我遇到了同样的问题。`web.config`最后，我通过在文件中添加一些代码得到了解决方案。

我在`<basicHttpBinding>`标签下添加了这些：

```
<binding  name="xyz">
  <security mode= "Transport" />
</binding> 
```

# c# - LINQ to SQL中按项目类型获取表

> ID：634141
> 
> 赞同：0
> 
> 时间：2009-03-11T11:23:50.817
> 
> 标签：c#, linq, linq-to-sql

你怎么能做这样的通用

```
return from items in _db.Table
    select items; 
```

我想做这样的事情

```
public class Data<T> ( where T is the model object ) 
```

所以表将更改为 T 的值

例如，这将如何看起来像具有保存方法的通用类

谢谢

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2009-03-11T11:26:26.097

在 LINQ-to-SQL 中，数据上下文具有[`GetTable<T>()`](http://msdn.microsoft.com/en-us/library/bb357220.aspx)：

```
var table = _db.GetTable<T>();
etc 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-03-11T12:35:35.790

添加到 Marc Gravell 的答案中，您可以使用如下所示的通用更新方法：

```
public void Update(TEntity entity, TEntity original)
{
    using (DataContext context = CreateContext())
    {
        Table<TEntity> table = context.GetTable<TEntity>();

        table.Attach(entity, original);
        context.SubmitChanges();
    }
} 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-03-11T11:26:07.410

```
... _db.GetTable<MyType> ... 
```

# c# - 如何在 C# 中为当前用户获取桌面路径？

> ID：634142
> 
> 赞同：408
> 
> 时间：2009-03-11T11:23:54.950
> 
> 标签：c#, windows, filesystems, directory

如何在 C# 中为当前用户获取桌面路径？

我唯一能找到的是 VB.NET-only class [`SpecialDirectories`](http://msdn.microsoft.com/en-us/library/e0be29hd.aspx)，它具有以下属性：

```
My.Computer.FileSystem.SpecialDirectories.Desktop 
```

我怎样才能在 C# 中做到这一点？

* * *

## 回答 #1

> 赞同：875
> 
> 时间：2009-03-11T11:25:21.967

```
string path = Environment.GetFolderPath(Environment.SpecialFolder.Desktop); 
```

* * *

## 回答 #2

> 赞同：17
> 
> 时间：2020-04-11T15:23:50.127

```
// Environment.GetFolderPath
Environment.GetFolderPath(Environment.SpecialFolder.ApplicationData); // Current User's Application Data
Environment.GetFolderPath(Environment.SpecialFolder.CommonApplicationData); // All User's Application Data
Environment.GetFolderPath(Environment.SpecialFolder.CommonProgramFiles); // Program Files
Environment.GetFolderPath(Environment.SpecialFolder.Cookies); // Internet Cookie
Environment.GetFolderPath(Environment.SpecialFolder.Desktop); // Logical Desktop
Environment.GetFolderPath(Environment.SpecialFolder.DesktopDirectory); // Physical Desktop
Environment.GetFolderPath(Environment.SpecialFolder.Favorites); // Favorites
Environment.GetFolderPath(Environment.SpecialFolder.History); // Internet History
Environment.GetFolderPath(Environment.SpecialFolder.InternetCache); // Internet Cache
Environment.GetFolderPath(Environment.SpecialFolder.MyComputer); // "My Computer" Folder
Environment.GetFolderPath(Environment.SpecialFolder.MyDocuments); // "My Documents" Folder
Environment.GetFolderPath(Environment.SpecialFolder.MyMusic); // "My Music" Folder
Environment.GetFolderPath(Environment.SpecialFolder.MyPictures); // "My Pictures" Folder
Environment.GetFolderPath(Environment.SpecialFolder.Personal); // "My Document" Folder
Environment.GetFolderPath(Environment.SpecialFolder.ProgramFiles); // Program files Folder
Environment.GetFolderPath(Environment.SpecialFolder.Programs); // Programs Folder
Environment.GetFolderPath(Environment.SpecialFolder.Recent); // Recent Folder
Environment.GetFolderPath(Environment.SpecialFolder.SendTo); // "Sent to" Folder
Environment.GetFolderPath(Environment.SpecialFolder.StartMenu); // Start Menu
Environment.GetFolderPath(Environment.SpecialFolder.Startup); // Startup
Environment.GetFolderPath(Environment.SpecialFolder.System); // System Folder
Environment.GetFolderPath(Environment.SpecialFolder.Templates); // Document Templates 
```

# c# - 从网格视图获取单元格值的问题

> ID：634143
> 
> 赞同：0
> 
> 时间：2009-03-11T11:24:26.260
> 
> 标签：c#, gridview, asp.net-2.0

我想从网格视图中获取单元格值。

我正在使用以下代码，但它会产生错误。

### 代码：

```
cmd.Parameters.Add("@ProjectCode", SqlDbType.VarChar).Value = ((GridView)TeamMemberGrid.Rows[e.RowIndex].Cells[1].Controls[0]).ToString(); 
```

### 笔记：

`@ProjectCode`是网格视图中的字段之一。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-03-11T12:09:22.280

正如 Leppie 已经说过的，TableCell 对象公开了一个`Text`属性，可以让您访问 TableCell 的文本内容。

您需要了解的是，该`TeamMemberGrid.Rows[e.RowIndex].Cells[1]`语句**返回一个 TableCell 对象**，该对象引用您的 GridView 中指定的 TableCell。

所以你的陈述变成：

```
cmd.Parameters.Add("@ProjectCode", SqlDbType.VarChar).Value = TeamMemberGrid.Rows[e.RowIndex].Cells[1].Text; 
```

最后，演员表的原因在你的陈述中似乎不清楚，所以我删除了。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-03-11T11:29:37.010

`TableCell`有财产`Text`。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-03-11T11:43:20.457

我想这是：

```
cmd.Parameters.Add("@ProjectCode", SqlDbType.VarChar).Value = ((GridView)TeamMemberGrid.Rows[e.RowIndex].Cells[1].Controls[0]).Text; 
```

# iphone - iPhone 上的性能计数器

> ID：634144
> 
> 赞同：8
> 
> 时间：2009-03-11T11:25:02.607
> 
> 标签：iphone, performance, performancecounter

我正在尝试在 iPhone 上找到最好的 incode 性能监控方法。

在 Windows 平台上，我将使用以下功能：

QueryPerformanceCounter((LARGE_INTEGER *)&ctr);
QueryPerformanceFrequency((LARGE_INTEGER *)&freq);

iPhone上有类似的东西吗？在不使用 Instruments 或 Shark 等外部工具的情况下，我可以计时的最高分辨率是多少？

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2009-03-11T21:02:47.443

我认为 mach_absolute_time 是您正在寻找的。了解更多信息：

*   [技术问答 QA1398：马赫绝对时间单位](http://developer.apple.com/library/mac/#qa/qa1398/_index.html)
*   [教程：性能和时间](http://www.macresearch.org/tutorial_performance_and_time)
*   [iPhone 上的 mach_ absolute_ time](http://shiftedbits.org/2008/10/01/mach_absolute_time-on-the-iphone/)

# jquery - jQuery 验证器 setDefaults 中的错误

> ID：634154
> 
> 赞同：1
> 
> 时间：2009-03-11T11:27:19.637
> 
> 标签：jquery, validation

为验证器配置默认选项时：

```
$.validator.setDefaults({
    errorElement: "em"
}); 
```

然后简单地使用如下：

```
$("form").validate({}); 
```

验证器仍然使用标签元素并忽略默认配置的errorElement em！

在这种情况下我能做什么，当然为每个验证器实例放置 errorElement 不是一个好主意？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-03-11T12:00:28.607

虽然我不确定如何解决这个问题，但我强烈建议使用 errorClass 而不是 errorElement，这对我来说很好用。

通过让默认元素“标签”，您可以让 jQuery Validator 创建“使用 for 属性在错误消息和无效字段之间建立有意义的链接”。

您始终可以使用 CSS 调整该元素（在本例中为标签）的显示方式，并且您应该始终致力于使用 [X]HTML 来稳定页面的**语义**而不是外观。对于后者，有 CSS。

# css - 在由 Ajax 更新的 div 中显示 CSS 图像

> ID：634171
> 
> 赞同：0
> 
> 时间：2009-03-11T11:33:04.180
> 
> 标签：css, image, tree, icons

我想知道是否有人可以提供帮助。我的页面中的 HTML div 包含一个树控件，该控件根据用户按下的按钮显示或隐藏。该按钮触发一个 Ajax 事件，该事件在服务器上设置一个变量以显示或隐藏树，以便保持状态。

但这就是问题所在；重新显示树时，展开/折叠分支的图标不存在。到目前为止，我无法弄清楚为什么会这样。

树如下所示：第一个图形显示了应有的树，第二个图形显示了隐藏并重新显示后的树。

[替代文字 http://www.dcs.bbk.ac.uk/~martin/Tree_with_icons.png](http://www.dcs.bbk.ac.uk/~martin/Tree_with_icons.png) [替代文字 http://www.dcs.bbk.ac.uk/~martin/Tree_without_icons.png](http://www.dcs.bbk.ac.uk/~martin/Tree_without_icons.png)

树的 HTML 作为列表构建在服务器上，每个列表项都有一个对 CSS 的类引用，如下所示：

```
ul.tree  li.liOpen    .bullet {
   background: url(myApp_Minus.png) center left no-repeat;
   cursor: pointer;
}
ul.tree  li.liClosed  .bullet {
   background: url(myApp_Plus.png) center left no-repeat;
   cursor: pointer;
}
ul.tree  li.liBullet  .bullet {
   background: url(myApp_Hyphen.png) center left no-repeat; 
   cursor: pointer;
} 
```

任何人都可以建议在重新显示树时显示图标的方法吗？

我尝试在 div、内联 CSS 元素等中放置指向 CSS 文件的链接，但没有成功。

欢迎任何帮助。

我在运行时附上了树的 HTML 的摘录：

```
<td align = "left">
        <div id = "tree"><ul class = "tree" id = "navTree">
        <li class = "liOpen">
          <a href = "/myDataSharer/aboutConcept#communities">
            <img alt = "Community" src = "/myDataSharer/images/myDataSharer_Community_Small.png">
          </a>&nbsp
          <a href = "/myDataSharer/commDashboard?CommNo=1&TagText=">Martin</a>
          <ul>
              <li class = "liOpen">
                <a href = "/myDataSharer/aboutConcept#datasets">
                  <img alt = "Tabular dataset" src = "/myDataSharer/images/myDataSharer_TabularDataset_Small.png">
                </a>&nbsp
                <a href = "/myDataSharer/displayDataset?DatasetNo=1&pageRowNo=0&TagText=">Planets</a>
              </li>
          <ul>
          <li>
            <a href = "/myDataSharer/aboutConcept#QAV">
               <img alt = "Visualisation" src = "/myDataSharer/images/myDataSharer_Visualisation_Small.png">
            </a>&nbsp
            <a href = "/myDataSharer/displayQAV?QAVNo=109&TagText=">Test QAV</a>
          </li>
          <li>
            <a href 
```

树本身位于一个名为“tree”的 div 中，它从 Javascript 方法更新如下：

```
document.getElementById("tree").style.visibility = "visible";               
document.getElementById("tree").innerHTML = str; 
```

树的Javascript是：

```
/*  WRITTEN BY: Martin O'Shea for myDataSharerAlpha.
 *
 *  This program has been inherited verbatim from the original author's sample code as mentioned
 *  below. No changes have been made other than a rename of a variable on line 121 from 'mktree' to 'tree'.

 *  ===================================================================
 *  Author: Matt Kruse <matt@mattkruse.com>
 *  WWW: http://www.mattkruse.com/
 *
 *  NOTICE: You may use this code for any purpose, commercial or
 *  private, without any further permission from the author. You may
 *  remove this notice from your final code if you wish, however it is
 *  appreciated by the author if at least my web site address is kept.
 *
 *  You may *NOT* re-distribute this code in any way except through its
 *  use. That means, you can include it in your product, or your web
 *  site, or any other form where the code is actually being used. You
 *  may not put the plain javascript up on your site for download or
 *  include it in your javascript libraries for download.
 *  If you wish to share this code with others, please just point them
 *  to the URL instead.
 *  Please DO NOT link directly to my .js files from your site. Copy
 *  the files to your server and use them there. Thank you.
 *  =====================================================================

 *  HISTORY
 *   ------------------------------------------------------------------
 *   December 9, 2003: Added script to the Javascript Toolbox
 *   December 10, 2003: Added the preProcessTrees variable to allow user
 *        to turn off automatic conversion of UL's onLoad
 *   March 1, 2004: Changed it so if a <li> has a class already attached
 *       to it, that class won't be erased when initialized. This allows
 *       you to set the state of the tree when painting the page simply
 *       by setting some <li>'s class name as being "liOpen" (see example)
 *
 *  This code is inspired by and extended from Stuart Langridge's aqlist code:
 *      http://www.kryogenix.org/code/browser/aqlists/
 *      Stuart Langridge, November 2002
 *      sil@kryogenix.org
 *      Inspired by Aaron's labels.js (http://youngpup.net/demos/labels/)
 *      and Dave Lindquist's menuDropDown.js (http://www.gazingus.org/dhtml/?id=109)
 */

// Automatically attach a listener to the window onload, to convert the trees
addEvent(window,"load",convertTrees);

// Utility function to add an event listener
function addEvent(o,e,f){
    if (o.addEventListener){ o.addEventListener(e,f,true); return true; }
    else if (o.attachEvent){ return o.attachEvent("on"+e,f); }
    else { return false; }
}

// utility function to set a global variable if it is not already set
function setDefault(name,val) {
    if (typeof(window[name])=="undefined" || window[name]==null) {
        window[name]=val;
    }
}

// Full expands a tree with a given ID
function expandTree(treeId) {
    var ul = document.getElementById(treeId);
    if (ul == null) { return false; }
    expandCollapseList(ul,nodeOpenClass);
}

// Fully collapses a tree with a given ID
function collapseTree(treeId) {
    var ul = document.getElementById(treeId);
    if (ul == null) { return false; }
    expandCollapseList(ul,nodeClosedClass);
}

// Expands enough nodes to expose an LI with a given ID
function expandToItem(treeId,itemId) {
    var ul = document.getElementById(treeId);
    if (ul == null) { return false; }
    var ret = expandCollapseList(ul,nodeOpenClass,itemId);
    if (ret) {
        var o = document.getElementById(itemId);
        if (o.scrollIntoView) {
            o.scrollIntoView(false);
        }
    }
}

// Performs 3 functions:
// a) Expand all nodes
// b) Collapse all nodes
// c) Expand all nodes to reach a certain ID
function expandCollapseList(ul,cName,itemId) {
    if (!ul.childNodes || ul.childNodes.length==0) { return false; }
    // Iterate LIs
    for (var itemi=0;itemi<ul.childNodes.length;itemi++) {
        var item = ul.childNodes[itemi];
        if (itemId!=null && item.id==itemId) { return true; }
        if (item.nodeName == "LI") {
            // Iterate things in this LI
            var subLists = false;
            for (var sitemi=0;sitemi<item.childNodes.length;sitemi++) {
                var sitem = item.childNodes[sitemi];
                if (sitem.nodeName=="UL") {
                    subLists = true;
                    var ret = expandCollapseList(sitem,cName,itemId);
                    if (itemId!=null && ret) {
                        item.className=cName;
                        return true;
                    }
                }
            }
            if (subLists && itemId==null) {
                item.className = cName;
            }
        }
    }
}

// Search the document for UL elements with the correct CLASS name, then process them
function convertTrees() {
    setDefault("treeClass","tree");
    setDefault("nodeClosedClass","liClosed");
    setDefault("nodeOpenClass","liOpen");
    setDefault("nodeBulletClass","liBullet");
    setDefault("nodeLinkClass","bullet");
    setDefault("preProcessTrees",true);
    if (preProcessTrees) {
        if (!document.createElement) { return; } // Without createElement, we can't do anything
        uls = document.getElementsByTagName("ul");
        for (var uli=0;uli<uls.length;uli++) {
            var ul=uls[uli];
            if (ul.nodeName=="UL" && ul.className==treeClass) {
                processList(ul);
            }
        }
    }
}

// Process a UL tag and all its children, to convert to a tree
function processList(ul) {
    if (!ul.childNodes || ul.childNodes.length==0) { return; }
    // Iterate LIs
    for (var itemi=0;itemi<ul.childNodes.length;itemi++) {
        var item = ul.childNodes[itemi];
        if (item.nodeName == "LI") {
            // Iterate things in this LI
            var subLists = false;
            for (var sitemi=0;sitemi<item.childNodes.length;sitemi++) {
                var sitem = item.childNodes[sitemi];
                if (sitem.nodeName=="UL") {
                    subLists = true;
                    processList(sitem);
                }
            }
            var s= document.createElement("SPAN");
            var t= '\u00A0'; // &nbsp;
            s.className = nodeLinkClass;
            if (subLists) {
                // This LI has UL's in it, so it's a +/- node
                if (item.className==null || item.className=="") {
                    item.className = nodeClosedClass;
                }
                // If it's just text, make the text work as the link also
                if (item.firstChild.nodeName=="#text") {
                    t = t+item.firstChild.nodeValue;
                    item.removeChild(item.firstChild);
                }
                s.onclick = function () {
                    this.parentNode.className = (this.parentNode.className==nodeOpenClass) ? nodeClosedClass : nodeOpenClass;
                    return false;
                }
            }
            else {
                // No sublists, so it's just a bullet node
                item.className = nodeBulletClass;
                s.onclick = function () { return false; }
            }
            s.appendChild(document.createTextNode(t));
            item.insertBefore(s,item.firstChild);
        }
    }
} 
```

谢谢。

网页的Ajax如下图所示：

```
<script language="Javascript">

    function xmlhttpPost(strURL) {
        var xmlHttpReq = false;
        var self = this;

        // Mozilla / Safari.
        if (window.XMLHttpRequest) {
            self.xmlHttpReq = new XMLHttpRequest();
        }

        // IE.
        else if (window.ActiveXObject) {
            self.xmlHttpReq = new ActiveXObject("Microsoft.XMLHTTP");
        }
        self.xmlHttpReq.open('POST', strURL, true);
        self.xmlHttpReq.setRequestHeader('Content-Type', 'application/x-www-form-urlencoded');
        self.xmlHttpReq.onreadystatechange = function() {
            if (self.xmlHttpReq.readyState == 4) {
                updatePage(self.xmlHttpReq.responseText);                                                   
            }
        }
        self.xmlHttpReq.send(getQueryStr());
    }

    function getQueryStr() {
        queryStr = "action=toggleTree";
        return queryStr;
    }

    function updatePage(str) {            
        if (str == "false") {

           // Hide tree buttons and tree.
           document.getElementById("tree").style.visibility = "hidden";
           document.getElementById("expColTreeButtons").style.visibility = "hidden";
        }
        else {

           // Show tree buttons.
           document.getElementById("expColTreeButtons").style.visibility = "visible";

           // Show tree.
           document.getElementById("tree").style.visibility = "visible";
           document.getElementById("tree").innerHTML = str;

        }
    }

    function toggleTree() {

        // Make call to server to toggle tree.
        document.getElementById("tree").innerHTML = "<img src='/myDataSharer/images/myDataSharer_Wait.gif' alt='Growing tree' />"
        xmlhttpPost("/myDataSharer/toggleTree");

   } 
```

上面的 Ajax 是从具有三个按钮的表单触发的。“显示/隐藏”按钮可以查看事物；另外两个按钮也包含在一个 div 中，但它们没问题。

```
<form>
                <input class = "treeButton" type="submit" value="Show / hide" onClick = "toggleTree(); return false;">
                <div id = "expColTreeButtons">
                    <input class = "treeButton" type="submit" value="Expand all" onClick = "expandTree('navTree'); return false;">
                    <br />
                    <input class = "treeButton" type="submit" value="Collapse all" onClick = "collapseTree('navTree'); return false;">
                    <br />
                </div>
            </form> 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2009-03-11T12:59:17.607

您的 CSS 看起来不错，就像可以生成左侧示例的内容一样，因此显示和隐藏的必须是 HTML 或 JavaScript。JavaScript 是如何工作的？

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-03-11T13:03:29.500

这不太可能是 CSS 问题，因为它是第一次工作。我敢打赌，问题在于您的服务器如何生成内容——即没有为每个节点分配正确的属性。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-03-13T15:27:02.480

这个问题现在已经解决了。感谢那些做出贡献的人。

解决方案是在 div 更新后重新处理 Javascript 树。

# screen-capture - 屏幕捕获控制

> ID：634174
> 
> 赞同：1
> 
> 时间：2009-03-11T11:37:45.167
> 
> 标签：screen-capture

是否有任何控件（在 ac# 项目中使用）来记录用户活动，然后将其编码为视频文件？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2009-04-09T12:50:24.947

据我了解，视频文件是静态图像帧的集合。您可以使用来自[http://www.vcskicks.com/ScreenShotTaker.zip](http://www.vcskicks.com/ScreenShotTaker.zip)的此工具的 api ，它实质上向您展示了捕获屏幕的机制。所以你可能需要做的是，根据设定的帧率自动循环捕获图像，然后将其导出为视频。我不确定如何创建媒体流，但你有库来进行屏幕截图。

# .net - 数据上下文 SubmitChanges() 退出代码无异常 - 在 iis5.1 上部署 .net mvc

> ID：634177
> 
> 赞同：0
> 
> 时间：2009-03-11T11:38:39.953
> 
> 标签：.net, asp.net-mvc, publishing, iis-5, submitchanges

我刚刚在 .NET MVC 中部署了我的第一个应用程序，但遇到了问题。

我已经解决了路由的 iis 5.1 问题（如果有人正在寻找这个，请到这里：http: [//itscommonsensestupid.blogspot.com/2008/11/deploy-aspnet-mvc-app-on-windows-xp-iis。 html](http://itscommonsensestupid.blogspot.com/2008/11/deploy-aspnet-mvc-app-on-windows-xp-iis.html) )

**现在我的问题是，无论我在我的数据上下文中调用 db.SubmitChanges() 的任何位置，它似乎都会阻止代码继续并且不进行更新。发布我的网站时是否缺少我的步骤？**

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-03-11T21:05:10.170

你可能遇到了同样的问题我试过这个

[linq to sql Insert 在部署的服务器（IIS）上不起作用](https://stackoverflow.com/questions/632277/linq-to-sql-insert-not-working-on-deployed-serveriis)

哦，找出任何错误的好方法，因为我没有得到任何异常，要么将所有数据库代码放入 try catch，`return "pass"`或者如果失败`return ex.ToString()`

您还可以将错误代码放入 viewdata 对象并使用`<%= ViewData["errorMessage"] %>`

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-03-16T13:53:04.377

这是我导出 webapp 时数据库只读的问题。尽管它似乎坏了，但它并没有给我一个很好的错误消息或异常。我在 IIS 下检查过，它尝试使用的用户帐户只有读取权限。

一旦我改变了这个，我重新启动了 IIS（不是我第一次偶然做的停止/启动）并且问题得到了解决

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-03-11T11:43:03.577

我建议查看事件日志以查看是否记录了有关应用程序退出原因的任何信息。另外，我建议您发布您正在运行的平台。特别是 64 位？

# asp.net - Asp.NET Webpart > Userctrl > ClientScript.RegisterStartupScript 不起作用？

> ID：634184
> 
> 赞同：1
> 
> 时间：2009-03-11T11:43:25.370
> 
> 标签：asp.net, ajax, web-parts

我有一个带有脚本管理器和 webpart 管理器的表单 default.aspx。

我有 4 个 webpart 区域。其中一个区域对其内容具有基本的用户控制。用户控件在更新面板中有一个按钮，我在按钮的单击事件上有以下内容：

```
Protected Sub cmdMarkComplete_Click(ByVal sender As Object, ByVal e As System.EventArgs) Handles cmdMarkComplete.Click
         Me.Page.ClientScript.RegisterStartupScript(Me.Page.GetType, "mymsg",   "<script>alert('hello');</script>", True)
         UpdatePanel1.Update()
End Sub 
```

什么都没有发生，我什至没有收到任何 javascript 错误，但是 aync 确实会循环，因为我可以更改标签值（作为测试）等。如果我在点击后检查源标记，“你好”甚至不存在，所以它好像不是注册脚本。这必须与我在 webpart 中有一个用户 ctrl 的事实有关。任何人都可以帮忙吗？

提前致谢。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-03-11T12:18:11.853

尝试使用 ScriptManager.RegisterStartupScript，这应该提供更好的支持，尤其是在更新面板中添加的脚本

[http://msdn.microsoft.com/en-us/library/system.web.ui.scriptmanager.registerstartupscript.aspx](http://msdn.microsoft.com/en-us/library/system.web.ui.scriptmanager.registerstartupscript.aspx)

# java - 使用 JavaSE 的 Jython Netbeans

> ID：634185
> 
> 赞同：2
> 
> 时间：2009-03-11T11:44:33.980
> 
> 标签：java, netbeans, jython

我想开发一个将 java 与 jython 混合的 Java 应用程序。我正在使用带有 python 插件的 IDE Netbeans。我该怎么做？（有一个对 Groovy 的内置支持，来自 IDE 的 javaSE 从 Java 代码调用 Groovy 类，以及来自 Groovy 代码的 Java 类，但不支持 jython）

参考： http: [//www.netbeans.org/features/groovy/index.html](http://www.netbeans.org/features/groovy/index.html)

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-03-11T11:53:02.930

Netbeans 6.5 支持 Python 和 Jython。

[http://www.netbeans.org/features/python/](http://www.netbeans.org/features/python/)

假设您正在使用带有 Python 插件的那个版本，只需通过平台管理器设置您希望使用的运行时（在这里您可以选择 Jython）。

[替代文字 http://img15.imageshack.us/img15/1586/platformmanager.png](http://img15.imageshack.us/img15/1586/platformmanager.png)

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-03-11T11:56:22.173

我还想补充一点，自 6.5 版本以来，Python 位已大大改进。因此，如果您想尝试新的但不稳定的构建，请从[http://deadlock.netbeans.org/hudson/job/python/获取一个](http://deadlock.netbeans.org/hudson/job/python/)

此外，请参阅[http://wiki.netbeans.org/Python链接的各种文档和我在](http://wiki.netbeans.org/Python)[http://amitksaha.blogspot.com/search/label/nbpython](http://amitksaha.blogspot.com/search/label/nbpython)上的博客文章

如有问题，请在邮件列表中告知我们。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2009-03-11T12:09:36.977

如果您想开发一个与 Jython 混合并在 NetBeans 之外工作的 Java**应用程序**，那么 NB 使用 Jython 运行时的能力并没有多大帮助。相反，您基本上有两种选择：

*   您可以使用[jythonc](http://www.jython.org/docs/jythonc.html)将 Python 编译为 Java 类。
*   或者：您可以在 Java 应用程序中[嵌入](http://www.jython.org/docs/embedding.html)Jython 解释器。

要嵌入，您需要创建一个 Jython 库以包含在您的 Java 应用程序中。为此，请转到 Tools -> Libraries，选择 New Library，然后将内容添加到 NetBeans 的 Jython 目录（我的机器中为 C:\Program Files\NetBeans 6.5\python1\jython-2.5）。您需要 jython.jar 以及 javalib 目录中的至少大部分内容。

# php - Zend 框架和 SQL Server

> ID：634197
> 
> 赞同：0
> 
> 时间：2009-03-11T11:49:15.950
> 
> 标签：php, sql-server, zend-framework

我正在尝试将 Zend Framework 与 SQL Server 2005 express 一起使用（通过带有[wamp](http://www.wampserver.com/en/)安装的 Pdo_Mssql），但似乎 pdo 无法连接到 SQL。这是我的代码：

```
require '../application/bootstrap.php'; 

try {
    $db = Zend_Db::factory('Pdo_Mssql', array(
    'host'     => 'localhost',
    'username' => 'sa',
    'password' => 'verystrongpass',
    'dbname'   => 'msdb'
));
    $db->getConnection();
} catch (Zend_Db_Adapter_Exception $e) {
    $e->getMessage();
} catch (Zend_Exception $e) {
   $e->getMessage();
}

$sql = 'SELECT * FROM table';

$result = $db->fetchAll($sql);

echo "----------------" . var_dump($result); 
```

并且错误结果始终是：

> 致命错误：未捕获异常 'Zend_Db_Adapter_Exception' 并带有消息 'SQLSTATE[01002]**无法连接：SQL Server 不可用或不存在**。（严重性 9）' 在 C:\wamp\bin\php\php5.2.5\lib\Zend\Db\Adapter\Pdo\Abstract.php:130 堆栈跟踪：#0 C:\wamp\bin\php\php5。 2.5\lib\Zend\Db\Adapter\Pdo\Mssql.php(135): Zend_Db_Adapter_Pdo_Abstract->_connect()
> 
> 1 C:\wamp\bin\php\php5.2.5\lib\Zend\Db\Adapter\Abstract.php(389):Zend_Db_Adapter_Pdo_Mssql->_connect()
> 
> 2 C:\wamp\bin\php\php5.2.5\lib\Zend\Db\Adapter\Pdo\Abstract.php(205):Zend_Db_Adapter_Abstract->query('SELECT * FROM t...', Array)
> 
> 3 C:\wamp\bin\php\php5.2.5\lib\Zend\Db\Adapter\Abstract.php(616): Zend_Db_Adapter_Pdo_Abstract->query('SELECT * FROM t...', Array)
> 
> 4 C:\Documents and Settings\Luca\Documenti\Workspace\web\db\public\index.php(27): Zend_Db_Adapter_Abstract->fetchAll('SELECT * FROM t...') #5 {main} 在 C 中抛出:\wamp\bin\php\php5.2.5\lib\Zend\Db\Adapter\Pdo\Abstract.php 在第 130 行

那么有人对ZF + SQL server有一些经验，SQL server需要一些特殊配置吗？在安装时，我只指定使用默认 istance 并使用混合身份验证。此外，我可以通过 Microsoft SQL server management studio express 成功连接 db。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-03-11T11:56:51.733

所有 SQL Server Express 安装在 SQLEXPRESS 的命名实例而不是默认实例上 - 请参阅[此](http://msdn.microsoft.com/en-us/library/ms165614.aspx)。

所以你的主机应该看起来像

```
'host'     => 'localhost\SQLEXPRESS' 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-10-07T18:34:01.340

你能检查你的 PHP.ini 文件，你启用了 Pdo_Mssq.dll

如果不删除“;” 在 Pdo_Mssql.dll 前面

担

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-01-21T17:48:40.907

我认为你的

`'host' => 'localhost\SQLEXPRESS'`配置

应该是这样的：

`'host' => 'computer_name\SQLEXPRESS'`

# java - 如何打印 JAMA 矩阵的列？

> ID：634200
> 
> 赞同：3
> 
> 时间：2009-03-11T11:49:49.893
> 
> 标签：java, matrix, jama

我使用 JAMA.matrix 包..如何打印矩阵的列

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-03-11T12:03:27.117

最简单的方法可能是[转置](http://math.nist.gov/javanumerics/jama/doc/Jama/Matrix.html#transpose())矩阵，然后打印每一行。从[API](http://math.nist.gov/javanumerics/jama/doc/Jama/Matrix.html)中获取部分示例：

```
double[][] vals = {{1.,2.,3},{4.,5.,6.},{7.,8.,10.}};
Matrix a = new Matrix(vals);
Matrix aTransposed = a.transpose();
double[][] valsTransposed = aTransposed.getArray();

// now loop through the rows of valsTransposed to print
for(int i = 0; i < valsTransposed.length; i++) {
    for(int j = 0; j < valsTransposed[i].length; j++) {        
        System.out.print( " " + valsTransposed[i][j] );
    }
} 
```

正如 duffymo 在评论中指出的那样，绕过转置并只编写嵌套的 for 循环来打印列而不是跨行*会更有效。*如果您需要以两种方式打印，这将导致两倍的代码。这是一个足够常见的权衡（代码大小的速度），我让你来决定。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-03-11T12:01:21.333

您可以在矩阵上调用 getArray() 方法来获取表示元素的 double[][]。
然后，您可以遍历该数组以显示您想要的任何列/行/元素。

有关更多方法，请参阅[API](http://math.nist.gov/javanumerics/jama/doc/)。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-05-22T23:09:47.197

```
public static String strung(Matrix m) {
    StringBuffer sb = new StringBuffer();
    for (int r = 0; r < m.getRowDimension(); ++ r) {
        for (int c = 0; c < m.getColumnDimension(); ++c)
            sb.append(m.get(r, c)).append("\t");
        sb.append("\n");
    }
    return sb.toString();
} 
```

# .net - System.Windows.DependencyProperty 与 System.Workflow.ComponentModel.DependencyProperty

> ID：634201
> 
> 赞同：2
> 
> 时间：2009-03-11T11:50:17.927
> 
> 标签：.net, dependency-properties

.NET Framework 似乎有两个 DependencyProperty 对象的实现

1.  [System.Windows.DependencyProperty](http://msdn.microsoft.com/en-us/library/system.windows.dependencyproperty.aspx)
2.  [System.Workflow.ComponentModel.DependencyProperty](http://msdn.microsoft.com/en-us/library/system.workflow.componentmodel.dependencyproperty.aspx)

我知道第一个的正常使用是在 WPF 中，而第二个的正常使用是在 WF 中，但是如果有的话，它们之间有什么区别？
如果我没有使用 WPF/WF 并且仍然想使用最好使用的 DependencyProperty？
未来有合并的计划吗？

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2009-03-11T13:23:27.703

区别很微妙，但很明显：

System.Windows.DependencyProperty 专注于处理任何 WPF 依赖项对象的依赖项属性，您可以使用有关属性元数据的可选附加信息（例如度量、动画和许多 WPF 特定）来注册它。

为什么？因为可以使用 PropertyMetadata 的派生类进一步指定此依赖属性。这包括 WPF 的 UIPropertyMetadata 和 FrameworkPropertyMetadata，用于 WPF 依赖属性的高级注册。

System.Workflow.ComponentModel.DependencyProperty 只能注册为简单的依赖属性，不需要特定WF的PropertyMetadata的额外信息。

目前，还没有整合它们的计划，因为它们在概念和上下文上都是不同的。

# cruisecontrol.net - 为什么在 GetCcNetConfigFiles 之后需要重新启动 CruiseControl.NET？

> ID：634209
> 
> 赞同：7
> 
> 时间：2009-03-11T11:56:16.040
> 
> 标签：cruisecontrol.net

CruiseControl.NET 服务需要重新启动以获取**项目**配置文件中的更改。

我觉得这很烦人，不确定这是一个错误还是它的工作方式。

在人们的经验中，有没有办法克服这个问题？

* * *

## 回答 #1

> 赞同：10
> 
> 时间：2009-03-11T15:04:12.703

如果您的项目与 ccnet.config 位于不同的文件中，那么您需要重新启动服务，除非您触及实际的 ccnet.config。

对于我们的项目，我们在 ccnet.config 中使用 ENTITY 和 SYSTEM 文件引用，所以我们在同一条船上。我很乐意为更轻松的项目维护付出代价，因为编写重启脚本很容易：

```
net stop CCService
net start CCService
IISRESET 
```

如果您想完全自动化此操作，并将您的项目置于源代码控制之下，那么您可以在项目文件被触及时触发更新并重新启动。

* * *

## 回答 #2

> 赞同：5
> 
> 时间：2009-09-23T21:20:49.767

1.4.4 之前的 CC.Net 中存在一个错误，如果您使用预处理器包含，当包含的 ccnet.config 文件被修改时，它不会重新加载配置。

这是我报告的一个错误，它已在 CC.Net 1.4.4 及更高版本中修复。

此外，请记住，如果构建正在运行并且配置发生更改，则在该构建处于空闲状态之前不会发生。

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2009-03-11T15:00:49.530

你是如何更新你的配置文件的？用手？我的总是识别和调整。您的配置文件是否在源代码管理中并旨在将其拉下并替换文件？这对我来说需要一脚。我最终如何修复它是让我的项目将其拉到一个单独的文件夹中。然后我调用 ccnet.exe -validate 以确保它格式正确，然后我将它复制到当前配置文件的顶部。CC.NET 识别新配置中的更改和加载

例外：如果 cc.net 当前正在运行一个项目，在该项目完成之前它不会识别更改。

如果您的 ccnet.config 有错误，它将永远无法识别更改并继续运行它存储在内存中的旧版本。（但是，当 CC.NET 确实重新启动时，它会尝试解析错误填充的配置并阻塞。

希望这可以帮助！！

* * *

## 回答 #4

> 赞同：2
> 
> 时间：2009-03-11T15:08:50.853

您的意思是您使用的是链接文件，即 ccnet.config 文件具有指向独立项目文件的链接。

如果是这样，那么它们不会被拾取，文档中提到它不监视子文件。

在内部，我们已经修改了 CruiseControl.net，以便我们的 ccnet.config 是一个可选的目录 - 我们可以将项目配置文件的快捷方式拖放到该目录中。我们将监视放在目录上，目录中的文件或快捷方式以及快捷方式的所有目标。这意味着我们在 ClearCase 中有我们的项目配置文件，只需将快捷方式放入 ccnet.config 目录。

我刚刚花了半天左右的时间从 1.2 迁移到 1.4.2 将我们的更改放到新版本中供我们内部使用。我们不拥有我们的代码，我们的客户拥有，所以它必须保持在内部:(

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2009-03-11T12:05:11.200

我从来没有经历过这种情况。每当我更改配置文件时，CruiseControl.NET 服务似乎会自动重新读取它们。

我正在使用 CC.NET 1.3 版。

**更新：**

在服务的配置文件 (ccservice.exe.config) 中，有一个设置可以启用/禁用监视 ccnet.config 文件的更改：

```
<add key="WatchConfigFile" value="true"/> 
```

确保将其设置为 true。

# php - 如何在 PHP 中获取不同时区的当前时间？

> ID：634210
> 
> 赞同：0
> 
> 时间：2009-03-11T11:56:21.253
> 
> 标签：php, timezone

不幸的是，我没有使用 PHP 5。在[date](http://php.net/date)函数的文档中，它有一个 timezone 部分，可让您指定与 GMT tome 的区别。您如何使用它来获取指定时区的当前/本地时间，并与夏令时一起使用？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-03-11T12:08:53.937

您可以使用 PEAR Date 包[http://pear.php.net/package/Date将时间转换为不同的时区](http://pear.php.net/package/Date)

这里的例子[http://pear.php.net/manual/en/package.datetime.date.examples.php](http://pear.php.net/manual/en/package.datetime.date.examples.php)

# c# - C# Web 服务模拟

> ID：634221
> 
> 赞同：0
> 
> 时间：2009-03-11T12:01:11.240
> 
> 标签：c#, web-services

如果我在身份为“someID”的 Web 服务中启用模拟...由于 Web 服务是 MTA 应用程序，则应用的模拟可能应用于工作线程，而不是实际调用该方法的线程...我猜你可能会收到拒绝访问错误...没有问题地进行模拟..只需在 webconfig 中启用它即可..我必须对我的功能进行哪些更改来做一些聪明的事情？

```
<identity impersonate="true" userName="DomainName\UserName" 
                         password="ClearTextPassword" /> 
```

Web.config中的`<identity>`元素支持可选的用户名和密码属性，允许您配置特定的固定身份以供您的 Web 服务模拟。这显示在以下配置文件片段中......我还需要写什么？

```
System.Diagnostics.Process[] p = System.Diagnostics.Process.GetProcesses(); 
p.GetExccutiong();
Console.WriteLine(); 
```

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2009-03-11T12:04:20.483

IMO，配置 Web 服务身份的最佳方式是通过主机 - 例如 IIS。在 IIS 中，您可以通过应用程序池标识来配置它（[就像在这个答案中一样）](https://stackoverflow.com/questions/630183/sspi-connection-in-net-2-0-web-service/630220#630220)。不需要纯文本密码，也不需要 hacky 代码。

# php - 用 PHP 加载 XML 耗时太长

> ID：634227
> 
> 赞同：-1
> 
> 时间：2009-03-11T12:04:09.080
> 
> 标签：php, xml

我正在尝试从在线 XML 文件中检索信息，但获取该信息需要很长时间。它甚至在大多数情况下都会出现超时错误。

奇怪的是，当我直接在浏览器上打开[链接时速度很快。](http://apple.accuweather.com/adcbin/apple/Apple_Weather_Data.asp?zipcode=EUR;PT;PO019;REGUA)

```
$xmlobj = simplexml_load_file("http://apple.accuweather.com/adcbin/apple/Apple_Weather_Data.asp?zipcode=EUR;PT;PO019;REGUA");
print header("Content-type: text/plain");
print_r($xmlobj); 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-03-11T12:50:21.747

那是因为他们会根据您使用的浏览器进行阻止。试试这个：

```
$curl = curl_init();
curl_setopt($curl, CURLOPT_USERAGENT, 'Mozilla/5.0 (X11; U; Linux i686; en-US; rv:1.9.0.6) Gecko/2009012700 SUSE/3.0.6-1.4 Firefox/3.0.6');                                                                                                                                     
curl_setopt($curl, CURLOPT_URL,'http://apple.accuweather.com/adcbin/apple/Apple_Weather_Data.asp?zipcode=EUR;PT;PO019;REGUA');             
$xmlstr = curl_exec($curl);
$xmlobj = simplexml_load_string($xmlstr);
print header("Content-type: text/plain");
print_r($xmlobj); 
```

顺便提一句。在文件中您可以看到*“禁止再分发”*，因此您可能需要寻找一些免版税的天气数据来源。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-03-11T12:53:11.630

上面的代码对我来说非常好。尝试从其他位置读取另一个 xml 文件（小尺寸）。

对我来说似乎是防火墙问题！

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-03-12T06:30:44.630

[vartec](https://stackoverflow.com/questions/634227/loading-xml-with-php-taking-too-long/634377#634377)指出，一旦您发送了带有 cURL 的虚假用户代理标头，将 XML 缓存到您的服务器可能是个好主意。对于天气，也许一个小时是一个好时间（玩这个，如果 RSS 更新更频繁，你可能想尝试 15 分钟）。

一旦它在本地保存到您的服务器，读取它并解析 XML 将更快。

请记住，RSS 确实声明了*Redistribution Prohibited*。IIRC 有一些免费的在线天气 RSS 源，所以也许你应该尝试另一个。

# compact-framework - 在 Windows CE 中按一次 ENTER 按钮会触发两次 Keypress 事件

> ID：634230
> 
> 赞同：0
> 
> 时间：2009-03-11T12:04:25.880
> 
> 标签：compact-framework, windows-ce

在开发过程中，我观察到某些带有 Windows CE 和可能的 Windows Mobile 的 PDA 在按键事件中发送了两次 Enter 键，因此我执行了两次位于返回按钮的控件按键事件下的代码。

我怀疑这是一个硬件错误，我想问一下您是如何在不更改应用程序逻辑的情况下解决它的。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2009-03-11T12:23:04.590

我不知道这是否会有所帮助，但如果您阅读键盘端口 Enter 被视为两个字节而不是一个字节。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-03-11T13:35:13.277

不改变逻辑？你真的不能（除非有硬件或固件修复）。我猜想最简单的机制（需要更改逻辑）是在短时间内处理两个 Enter 键或按键（比如 < 100 毫秒），然后忽略第二个。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-06-24T06:18:17.513

这也发生在我身上，原来是因为在控制面板->键盘中启用了“启用字符重复”选项。对于我们使用的键盘，默认的重复延迟太快了，所以我只是放慢了速度，问题就消失了。

# sql - 你可以在 MySql 中使用自动增量而不是主键吗

> ID：634231
> 
> 赞同：3
> 
> 时间：2009-03-11T12:04:34.430
> 
> 标签：sql, mysql, nhibernate, primary-key, auto-increment

我使用 GUID 作为所有其他表的主键，但我有一个需要递增数字的要求。我尝试使用自动增量在表中创建一个字段，但 MySql 抱怨它需要成为主键。

我的应用程序使用 MySql 5，nhibernate 作为 ORM。

我想到的可能的解决方案是：

*   将主键更改为自动增量字段，但仍将 Id 作为 GUID，因此我的应用程序的其余部分是一致的。

*   使用 GUID 和自动增量字段创建复合键。

我目前的想法倾向于复合关键思想。

编辑：行 ID（主键）是当前的 GUID。我想添加一个自动递增的 INT 字段，以便人类可读。我只是不想摆脱将 GUID 作为主键的应用程序中的当前标准。

* * *

## 回答 #1

> 赞同：9
> 
> 时间：2009-03-11T12:26:05.783

GUID 值旨在跨表甚至数据库是唯一的，因此，使 auto_increment 列成为主索引并为 GUID 创建唯一索引

* * *

## 回答 #2

> 赞同：5
> 
> 时间：2009-03-11T12:10:57.240

我会向另一个方向倾斜。

为什么？因为创建复合键会给下一个出现的人留下这样的印象，即在表中具有相同的 GUID 两次但具有不同的序列号是可以的。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-03-11T12:10:50.593

`GUID`'s 不是可订购的，这就是为什么`AUTO_INCREMENT`对他们来说没有意义。

但是，您可以将 an`AUTO_INCREMENT`用于`MyISAM`表中复合主键的第二列。您可以在列上创建复合键`(GUID, INT)`并将第二列设为`AUTO_INCREMENT`.

要生成新的`GUID`，只需`UUID()`在`INSERT`语句或触发器中调用。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2009-03-11T12:11:59.263

几个想法：

*   如果您的 GUID 是非增量且唯一的，为什么不让它成为实际的主键呢？

*   另一方面，您永远不应该根据程序问题做出语义决策：您遇到的是 MySQL 问题，而不是您的 DB 设计问题。

因此，这里有几个解决方法：

*   创建一个触发器，在插入后将 GUID 设置为正确的值。这是 MySQL 问题的 MySQL 解决方案，无需更改架构的语义。

*   在插入之前，启动一个事务（确保自动提交设置为 false），找出最新的 GUID，递增并插入新值。换句话说，自动增量不会自动：P

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2009-03-11T12:42:45.337

不，只有主键可以将 auto_increment 作为其值。

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2010-08-13T16:13:48.963

如果由于某种原因，您不能将标识列更改为主键，那么如何通过某种 SEQUENCE 表手动生成自动增量以及一个触发器来查询 SEQUENCE 表并保存下一个要使用的值。然后将值分配给触发器中的目标表。一样的效果。我唯一的问题是自动递增的值是否会在不重新选择表的情况下通过 NHibernate 返回。

# jquery - 使用 jQuery 只显示一个类的实例

> ID：634232
> 
> 赞同：1
> 
> 时间：2009-03-11T12:04:35.990
> 
> 标签：jquery, css

我已经用谷歌搜索了这个，但无济于事（可能搜索技巧很差）。

我的问题可能很简单，我只是希望 mouseover 事件仅在列表项被鼠标悬停时显示包含的 div （.action）（ui-state-default）。

这是标记

```
<ul id="column-2" class="connectedSortable">
    <li class="ui-state-default">feature
        <div class="action">
            <img src="delete.png" class="delete" alt="Delete this Story">
            <br />
            <img src="duplicate.png" class="delete" alt="Duplicate this Story">
        </div>
    </li>
    <li class="ui-state-default">forward
        <div class="action">
            <img src="delete.png" class="delete" alt="Delete this Story">
            <br />
            <img src="duplicate.png" class="delete" alt="Duplicate this Story">
        </div>
    </li>
</ul> 
```

和 JavaScript

```
$(function() {  
    $(".ui-state-default").mouseenter(function(){
        $(".action").show();
    }).mouseleave(function(){
        $(".action").hide();
        });
}); 
```

现在我意识到这将显示 .action 的每一次出现 - 但我如何确保它只在它的父 li 中显示它？我尝试过使用 jquery 父/子争论，但失败得很惨。

任何帮助将非常感激。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2009-03-11T12:06:18.187

```
$(function() {
  $(".ui-state-default).mouseenter(function() {
    $(this).find(".action").show();
  }).mouseleave(function() {
    $(this).find(".action").hide();
  });
}); 
```

或者只使用 hover() 事件：

```
$(function() {
  $(".ui-state-default").hover(function() {
    $(this).find(".action").show();
  }, function() {
    $(this).find(".action").hide();
  });
}); 
```

代替：

```
$(this).find(".action") 
```

你也可以这样做：

```
$(this).children(".action") 
```

或任何其他选择它的方式。

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2009-03-11T12:07:23.783

您应该将“.action”限制为当前上下文（您悬停的列表项）：

```
$(function (){
  $(".ui-state-default").hover(
    var listItem = this;
    function (){
      $(".action", listItem).show();         
    }
    ,
    function (){
      $(".action", listItem).hide();         
    }
  );
}); 
```

# php - 优雅的数据库设计帮助... (MySQL/PHP)

> ID：634241
> 
> 赞同：3
> 
> 时间：2009-03-11T12:07:32.707
> 
> 标签：php, mysql, database, database-design

我正在建立一个电影网站...我需要显示有关每部电影的信息，包括类型、演员和大量信息（如 IMDB.com）...

我创建了一个包含 ID 和一些基本信息的“电影”表。对于流派，我创建了一个“流派”表，包括 2 列：ID 和流派。然后我使用带有两列的“genres2movies”表：movieID 和genreID，以连接流派和电影表...

这样，例如，如果一部电影有 5 种不同的流派，我会在“genres2movies”表的 5 个不同行中获得电影 ID。它比每部电影每次都包含类型要好，但是...

有更好的方法来做到这一点？？？

我也需要为演员、语言和国家/地区这样做，因此性能和数据库大小非常重要。

谢谢！！！

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2009-03-11T12:14:58.447

听起来您目前正在遵循适当的规范化规则，这正是您想要的。

但是，您可能会发现，如果性能是一个关键因素，您可能希望对数据的某些部分进行反规范化，因为表之间的 JOIN 是相对昂贵的操作。

它通常是正确/完全规范化和性能之间的权衡

* * *

## 回答 #2

> 赞同：5
> 
> 时间：2009-03-11T12:10:53.103

你在正确的轨道上。这就是建立多对多关系的方式。数据库大小不会增长太多，因为您使用整数，并且为了速度，您必须为这些 ID 设置正确的索引。在进行 SELECT 查询时，请查看 EXPLAIN - 它有助于找到速度瓶颈。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-03-11T13:05:26.623

你走在完全正确的轨道上——这是正确的、标准化的方法。

我唯一要添加的是确保连接表（genres2movies）上的索引包括流派和电影ID，并且通常值得（取决于使用的选择）在两个方向上定义索引 - 即。两个索引，有序的流派 ID、电影 ID 和电影 ID、流派 ID。这确保了针对流派或电影的任何范围选择都能够使用索引来检索它需要的所有数据，而不必诉诸全表扫描，甚至不必自己访问表行。

# ajax - ASP.NET MVC 灵活吗？

> ID：634248
> 
> 赞同：1
> 
> 时间：2009-03-11T12:09:37.383
> 
> 标签：ajax, asp.net-mvc, model-view-controller, kigg

能否轻松与 jQuery、(ASP.NET) Ajax、ASP.NET webforms、其他框架结合使用。将动态代码从 ASP.NET MVC 提取到例如经典 ASP 中怎么样？

MVC模型是否意味着很容易定制代码？

背景：

1.  我有一些经验，将依赖于 JavaScript 的框架相互集成会导致问题？
2.  我们有一个经典的 ASP，我们在 ASP.NET 中编写新东西，并在 ASP 文件中包含 .aspx 代码。
3.  我正在为我们需要的东西寻找一些操作系统框架，我认为基于 MVC 的框架应该更容易采用（KIGG）

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-03-11T12:19:03.740

ASP.NET MVC 附带 jQuery 作为默认的 javascript 框架，所以不用担心。框架本身与 jQuery 没有任何联系，因此您也可以使用您选择的框架将其切换出来。MVC 带有它自己的 AJAX 实现，它建立在基础 ASP.NET Ajax 实现上（至少在 javascript 中），所以有 AJAX 支持，但我认为你会发现它有所不同——例如，没有 UpdatePanel——但你'能够做类似的事情。

您可以将 WebForms 与 MVC 混合使用，但您需要为这些 URL 设置 IgnoreRoutes，以便它们不会被处理。我承认我还没有发现需要这样做，但是我不使用第三方控件。这可能是一个领域，至少就目前而言，您仍然需要一些 WebForms。我从来没有使用过经典的 ASP，可能也不会，所以我无法帮助你。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-03-11T16:00:46.750

您可以将任何 Javascript 框架与 MVC 一起使用，它们默认包含 Jquery，但任何人都可以使用它。

就灵活性而言，我们已经部署了一个带有 ASP.NET 网络表单、MVC 和 .NET 1.1 库的工作站点，所以是的，它很灵活。

根据我们的经验，ASP.NET MVC 是 MS 为 Web 开发所做的最好的事情，特别是如果您希望密切控制您的 html 输出并在您的布局和设计中使用 Web 标准。我们已经使用了 6 个月，并且我们永远不会回到 Web 表单。

玩得开心！

# asp.net - Javascript日历不起作用

> ID：634249
> 
> 赞同：1
> 
> 时间：2009-03-11T12:09:51.657
> 
> 标签：asp.net, javascript

我的 JavaScript 日历在 IE 中工作，但在 Mozilla 中不工作。

我的代码：

```
 <table>
   <tr style="height: 5px;">
    <td>
     <asp:TextBox ID="txtBorderedDate" runat="server" CssClass="TextBoxMandatory" Enabled="false"></asp:TextBox>
    </td>
    <td class="FieldButton_bg" style="height: 5px;"> 
     <a onclick="javascript:showCalendarControl(ctl00_SaralConetentPlaceHolder_txtBorderedDate);" href="#">
       <img src="../Images/iconCalendar.png" style="width: 20px; height: 20px; vertical-align: bottom;" border="0" />
     </a>
    </td>
   </tr>
  </table> 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-03-11T12:20:34.860

我不确定这是否与问题有关（您应该发布更多代码），但您不应该在 ASP.NET 中硬编码控件的 ID。另外，我认为 showCalendarControl() 调用中可能缺少一些引号。

替换这个：

```
<a onclick=
 "javascript:showCalendarControl(ctl00_SaralConetentPlaceHolder_txtBorderedDate);" ... 
```

有了这个：

```
<a onclick="showCalendarControl('<%= txtBorderedDate.ClientID %>');" ... 
```

txtBorderedDate 的某些父控件可能会在不同的边框中以不同的方式呈现，从而导致文本框控件的客户端 ID 不同。

# c# - 根据另一个列表视图中的选择更改列表视图中的选定项目

> ID：634254
> 
> 赞同：4
> 
> 时间：2009-03-11T12:11:26.350
> 
> 标签：c#, asp.net, listview, selecteditemtemplate

我有两个列表视图。在第一个 Listview 的 Item 命令事件中，我使用 ajaxtoolkit 在模式弹出窗口中显示第二个列表视图。

```
protected void lvSelection_ItemCommand(object sender, ListViewCommandEventArgs e)
{
    this.lvPopup.Visible = true;
    this.lvPopup.DataSource = linqdataSource;
    this.lvPopup.DataBind();

    this.mdlPopup.Show();
} 
```

现在在第二个列表视图的 itemcommand 事件中，我需要更改第一个列表视图中所选项目的内容。

有可能这样做吗？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-03-11T13:16:34.413

```
protected void lvPopup_ItemCommand(object sender, ListViewCommandEventArgs e)
{
    // Set the text of the first list view item to the selected item 
    // of the second list view.
    lstView1.Items[lstView1.SelectedIndex].Text = 
        lstView2.Items[lstView2.SelectedIndex].Text
} 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-03-30T09:39:40.110

您是否已经尝试过动态生成 List 的项目？

在第一个列表的事件代码上，清除第二个列表中的项目并使用适合您的任何逻辑填充它。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-03-11T13:02:23.357

我认为，如果您要将第一个 ListView 中选择器按钮的 CommandName 设置为“Select” - 从第二个列表视图的 ItemCommand 事件，您应该能够更改 SelectedItemTemplate 或所选项目的当前项目在第一个列表中。

```
protected void lvPopup_ItemCommand(object sender, ListViewCommandEventArgs e)
{

   lvSelection.SelectedItemTemplate = "<div>woohoo!</div>";
   // OR...
   lvSelection.Items[lvSelection.SelectedIndex].SkinID = "SomeNewSkinForExample";

   mdlPopup.Hide();

} 
```

# java - 如何为 EJB 选择本地接口？

> ID：634255
> 
> 赞同：0
> 
> 时间：2009-03-11T12:11:30.280
> 
> 标签：java, jakarta-ee, ejb-3.0, ejb

假设我有以下 EJB（使用 ejb3）：

```
@Stateless(name="Queries")
@Remote(Queries.class)
@Local(Queries.class)
public final class QueriesEJB implements Queries {
    ...
} 
```

该类可通过本地和远程接口使用。

**如何在应用程序的另一部分注入此 EJB 的本地接口？**

具体来说，我不确定如何创建选择*本地*接口的@EJB 注释。例如，以下内容是否足够？

```
@EJB(name="Queries") private Queries queries; 
```

特别是，我想避免仅仅为了通过@EJB 的“beanInterface”属性进行区分而创建单独的本地和远程接口。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2009-03-19T16:55:15.427

根据规范，您不能同时拥有远程和本地接口。但是，您创建了一个超级接口，将所有方法放在那里，然后创建 2 个子接口。完成后，只需使用@EJB。这样，您根本只需要维护一个接口。

[编辑：请参阅http://jcp.org/aboutJava/communityprocess/final/jsr220/index.html](http://jcp.org/aboutJava/communityprocess/final/jsr220/index.html)的“EJB3 规范简化”中的第 3.2 节

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-03-11T18:45:26.777

部署 EJB 时，容器查看接口并识别本地和远程接口。我会说 EJB 容器已经在您的示例中使用了本地接口。在这种情况下使用远程接口根本没有意义，因为容器可以选择使用本地接口。

如果您想确保尝试使用本地接口的 JNDI 名称作为 @EJB 注释的参数。

```
@EJB(name="java:comp/env/ejb/EntitySupplierLocal") 
```

在上面的示例中，我在接口名称中添加了 local。在您的情况下，您必须查看 JNDI 上下文以获得正确的名称，或者您甚至知道它;)。

通常，我建议使用定义了业务方法的基本接口并扩展本地和远程接口。因此，您不必复制方法，并且可以分别扩展本地和远程访问的功能。

```
public interface Queries () { .. }

@Local
public interface QueriesLocal extends Queries () { .. }

@Remote
public interface QueriesRemote extends Queries () { .. } 
```

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2009-06-09T14:34:02.207

先前评论中的解决方案与 Jboss 上的 EJB 3.0 不完全兼容。

你很容易得到这个错误：

```
org.jboss.ejb3.common.resolvers.spi.NonDeterministicInterfaceException:
beanInterface specified, Queries, is not unique within EJB QueriesEJB 
```

只创建这个：

```
public interface Queries ()  //Local by default

@Remote
public interface QueriesRemote extends Queries () { ... } 
```

有用

# mysql - 被删除的行占用的空间会被重新使用吗？

> ID：634257
> 
> 赞同：24
> 
> 时间：2009-03-11T12:11:40.967
> 
> 标签：mysql, database, size, innodb, rows

我已经读过好几遍了，在 MySQL 中删除 InnoDB 表中的一行后，它的空间没有被重用，所以如果你在一个表中进行大量 INSERT，然后定期删除一些行，该表将使用越来越多的空间磁盘，就好像这些行根本没有被删除一样。

最近有人告诉我，已删除行占用的空间会被重新使用，但只有在某些事务完成之后才会重新使用，即使是这样 - 还没有完全使用。我现在很困惑。

有人可以让我明白这一点吗？我需要在 InnoDB 表中执行大量 INSERT，然后每 X 分钟我需要删除超过 Y 分钟的记录。我在这里遇到了不断增长的 InnoDB 表的问题，还是偏执狂？

* * *

## 回答 #1

> 赞同：34
> 
> 时间：2009-03-11T12:44:00.077

这是偏执狂:)

数据库的大小不会不必要地增长，但对于性能问题，空间也不会被释放。

您最可能听到的是，如果您删除记录，则空间不会返回**给操作系统**。相反，它被保留为一个空白空间，供数据库以后重复使用。

这是因为：

*   DB需要有一些HD空间来保存它的数据；如果它没有任何空间，它首先保留一些空白空间。
*   当您插入新行时，会使用该空间的一部分。
*   当您用完可用空间时，会保留一个新块，依此类推。
*   现在，**当你删除一些行时**，为了防止保留越来越多的块，它的空间是空闲的，但永远不会归还给操作系统，所以你以后可以再次使用它，而不需要保留新的块。

如您所见，空间*被*重复使用，但从未归还。这是你问题的关键点。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2009-11-14T05:22:07.303

在 innodb 中，没有实用的方法来释放空间。

*   使用 per table ibdata 文件，这将使您能够删除记录，将数据复制到新表并删除旧表，从而恢复记录。
*   使用 mysqldump 和大量的收据来清理整个服务器。检查以下内容： http:
    [//dev.mysql.com/doc/refman/5.0/en/adding-and-removing.html](http://dev.mysql.com/doc/refman/5.0/en/adding-and-removing.html)

当您使用大型表（在我的情况下它们超过 250GB）时，所有这些方法都变得不切实际，并且您必须让它们删除记录以获得更好的性能。

您将不得不认真考虑，您的硬盘上是否有足够的空间来执行上述功能之一（在我的情况下，我认为 1TB 不足以完成所有这些操作）

使用 Innotab 表（和 mysql 本身），如果数据库大小很大，则该选项相当有限。

# mysql - 如何对 MySQL 查询中的值求和？

> ID：634260
> 
> 赞同：-1
> 
> 时间：2009-03-11T12:12:43.710
> 
> 标签：mysql

我正在使用 MySQL。
我有一个 P_id 应该能够找到最大值。我想通过以下方式显示两个公式的总和：

```
 Then 

          Sum(max(pval)*S_val*Estimate)
          Sum(max(pval)*P_val*Analyze)
    Finally sum the Both above 
```

我使用了以下功能，但它给了我一个错误：

```

> id 显示 P_id P_val 分析 S_id S_val 估计       
> 70 数据1 1 1 178 0 0 0      
> 71 数据2 1 0 0 1 3 50   

```

```
SELECT  SUM( max(pval)*S_val*Estimate) + Sum( max(pval)* P_val * Analyze) from DATA where pid='1' 
```

这导致：

*   答：1*178
*   B：1*3*50
*   总和（A+B）：328

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-04-24T15:23:24.257

您不能嵌套聚合函数 -`SELECT SUM(MAX(x))`总是会出错。

您可以在子查询中获取内部值：

```
SELECT
  SUM(maxpval * S_val * Estimate),
  SUM(maxpval * P_val * Analyze)
FROM
  yourTable
  JOIN (
    SELECT MAX(P_val) AS maxpval FROM yourTable
  ) AS dt; 
```

# sql-server - SSIS SQL Native Client 错误 - 无法诊断原因

> ID：634265
> 
> 赞同：0
> 
> 时间：2009-03-11T12:14:25.873
> 
> 标签：sql-server, sql-server-2005, ssis, sybase

我们有大量的 SSIS 作业，这些作业安排在每天晚上/清晨连续运行。这些作业为我们的生产系统填充和更新大量数据。最近，我们开始在不同时间收到关于不同作业的错误消息。到目前为止，不可能在一致的基础上重现：

```
     代码：0xC0202009     
     来源：[作业名称] 连接管理器“[Connection.Manager.Name]”
     说明：SSIS 错误代码 DTS_E_OLEDBERROR。发生 OLE DB 错误。错误代码：0x80004005。
OLE DB 记录可用。来源：“Microsoft SQL Native Client”Hresult：0x80004005 描述：“通信链路故障”。
OLE DB 记录可用。来源：“Microsoft SQL Native Client”Hresult：0x80004005 描述：“命名管道提供程序：管道的另一端没有进程。”。  
结束错误
错误：2009-03-10 05:19:51.09
     代码：0xC00291EC 来源：更新记录状态执行 SQL 任务
     说明：无法获取连接“[Connection.Manager.Name]”。连接可能未正确配置，或者您可能没有此连接的正确权限... 包执行失败... 步骤失败。

```

连接肯定配置正确，我们以具有适当权限的用户身份运行它。一年多来，这些工作表现完美。谷歌搜索出现的结果似乎涵盖了从可能的连接问题到数据完整性问题的所有内容。我们已尝试从数据源端将此作为连接问题，并通过检查事件日志从 SQL Server db 和服务器框进行处理。似乎什么都没有排队。这是我们的设置：

*   我们有一个带有 SQL Server 2005 的 Server 2003 机器，专门用于容纳和运行 SSIS 作业
*   我们有一个专用的 Server 2003 盒子，上面只有 SQL Server 数据库，用于存放我们的数据并提供 Reporting Services 报告
*   我们的大多数工作都通过 ODBC 连接到 Sybase DB，以从我们的记录系统中获取数据并将其传送到 SQL Server 以进行报告和数据操作

有没有人以类似的方式遇到过这个异常？同样，我们尝试对 SQL Server DB 和 Sybase 连接进行故障排除，但没有成功。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-03-24T15:10:08.633

在我们的例子中，这是资源争用。由于其他作业的表级锁而发生死锁。Native Client 错误的描述性不足以让我们知道最初出现了什么问题。我们必须在数据库上运行 SQL Server Profiler 并过滤死锁错误。[这篇](http://www.simple-talk.com/sql/learn-sql-server/how-to-track-down-deadlocks-using-sql-server-2005-profiler/)文章帮助我们指出了正确的方向。

希望有帮助！！

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-03-11T12:21:40.973

如果 OLE DB 对您撒谎，那么这可能是任何事情。如果不是，那么管道的另一端可能没有进程。您应该查看事件日志等，以查看其他进程是否已死亡。

如果其他情况发生变化，即使是已经在生产中运行多年的流程也可能会改变它们的行为。例如，备份或其他自动化作业可能花费的时间越来越长，并且现在与您的 SSIS 包的现有计划发生冲突。这样的事情可能会强制关闭任何打开的连接，导致“管道另一端没有进程”。

# jsp - JSP页面显示时间

> ID：634266
> 
> 赞同：5
> 
> 时间：2009-03-11T12:14:38.510
> 
> 标签：jsp

这是我在 demo.jsp 中的一行

```
<html>
<head>
<title>demo</title>
</head>
<body>

Hello there!!!   The time is <%= new java.util.Date()%>

</body>
</html> 
```

当我在Firefox中打开时没有显示时间。而是显示同一行：

“时间是 <%= new java.util.Date()%>”

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2011-03-10T11:57:47.837

您的代码完全正确，这将向您显示当前时间，由当前区域设置格式化。正如其他人错误地指出的那样，您将其放置在页面中的位置（即被其他 HTML 标记包围）在这里不是问题。

但是，您似乎是直接从文件位置 (file://yourPath/demo.jsp) 或通过标准 Web 服务器（例如 Apache）访问您的页面，而不是从 Servlet 容器（例如 Tomcat、Jetty、. .)，它实际上会预处理 <% -- %> JSP System 标记。

查找有关如何为您的操作系统配置 Tomcat 或 Jetty 以及将 JSP 页面放置在何处的示例，或者查找有关如何在 Eclipse 或 IDEA 中使用它的教程。

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2009-03-11T12:20:36.263

看起来您将 <%= new java.util.Date()%> 放在了错误的位置，并且它被视为文本而不是代码，它应该看起来像这样：

```
<td width="100%"><b>&nbsp;Current  Date 
and time is:&nbsp; <font color="#FF0000">

<%= new java.util.Date() %>
</font></b></td> 
```

如果您发布代码示例，它将有很大帮助。

这里也有一些例子：[http ://www.roseindia.net/jsp/jsp_date_example.shtml](http://www.roseindia.net/jsp/jsp_date_example.shtml)

戴夫

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-03-11T12:20:25.623

如果您访问此[链接](https://stackoverflow.com/questions/427726/showing-the-current-date-using-jstl-formatdate-tag)，它会提供带有源代码的示例，向您展示如何正确执行此操作。请参阅 JSP 1.2 示例下的“日期”示例。

另一个建议：学习 JSTL 并使用它的格式标签来正确格式化时间和日期。不要使用小脚本。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2021-03-17T17:15:24.373

JSP 页面需要 java 库，并且需要从 demo.jsp 更改一些代码。以下是可以从 JSP 页面自定义日期和时间格式的示例：

```
<%@page contentType="text/html" pageEncoding="UTF-8"%>
<%@page import="java.io.*,java.util.*, javax.servlet.*" %>
<%@page import="java.text.DateFormat"%>
<%@page import="java.text.SimpleDateFormat"%>

<html>
<body>
<p>&nbsp;</p>
<div align="center">
  <center>
  <table border="0" cellpadding="0" cellspacing="0" width="460" bgcolor="#EEFFCA">
    <tr>
      <td width="100%"><font size="6" color="#008000">&nbsp;Date Example</font></td>
    </tr>
    <tr>
      <td width="100%"><b>&nbsp;Current Date and time is:&nbsp; <font color="#FF0000">
      <% DateFormat dateFormat = new SimpleDateFormat("yyyy-MM-dd HH:mm:ss");
   Date date = new Date(); out.println(dateFormat.format(date));%>
    </font></b></td>
    </tr>
  </table>
  </center>
</div>
</body>
</html> 
```

注意：***SimpleDateFormat 允许您以不同的格式显示：***例如“kk:mm:ss a z”或“yyyy/MM/dd HH:mm:ss.SSS”等... kk=24 小时格式，yyyy=year， MM=月，dd=日，HH=小时 24 小时格式，hh=小时 1 到 12，mm=分钟，ss=秒，SSS=秒小数，a =上午或下午，z =时区

底线：要自定义演示，请定义所需的 java 库，然后将**默认日期/时间**格式替换为允许您自定义格式的代码：

你可以改变：

```
<%= new java.util.Date() %> 
```

使用以下格式示例：

```
<%@page import="java.io.*,java.util.*, javax.servlet.*" %>
<%@page import="java.text.DateFormat"%>
<%@page import="java.text.SimpleDateFormat"%>

<html>
.
.
<% DateFormat dateFormat = new SimpleDateFormat("yyyy-MM-dd HH:mm:ss");
       Date date = new Date(); out.println(dateFormat.format(date));%>
.
.
</html> 
```

**输出：**

[![在此处输入图像描述](https://i.stack.imgur.com/rfzYI.jpg)](https://i.stack.imgur.com/rfzYI.jpg)

# c# - C# 无法从 IEnumerable 转换 为 IEnumerable

> ID：634268
> 
> 赞同：8
> 
> 时间：2009-03-11T12:15:18.320
> 
> 标签：c#, inheritance, collections, ienumerable

我最近在尝试将 AddRange(IEnumerable) 添加到列表时遇到了麻烦。可能是一个经典问题，但我还没有真正理解它。

我知道期望 List 参数的方法对 List 不满意，因为它们可能会尝试将 Base 添加到 List 中，这显然是不可能的。

但是，如果我正确理解了这一点，因为 IEnumerables 本身无法更改，它应该在这种情况下工作。

我想到的代码是这样的：

```
class Foo
{
}

class Bar : Foo
{
}

class FooCol
{
    private List<Foo> m_Foos = new List<Foo> ();

    public void AddRange1(IEnumerable<Foo> foos)
    {
        m_Foos.AddRange (foos); // does work
    }

    public void AddRange2<T>(IEnumerable<T> foos) where T : Foo
    {
        m_Foos.AddRange (foos); // does not work
    }
}

class Program
{
    static void Main(string[] args)
    {
        FooCol fooCol = new FooCol ();

        List<Foo> foos = new List<Foo> ();
        List<Bar> bars = new List<Bar> ();

        fooCol.AddRange1 (foos); // does work
        fooCol.AddRange1 (bars); // does not work

        fooCol.AddRange2 (foos); // does work
        fooCol.AddRange2 (bars); // does work
    }
} 
```

我试图在 AddRange2 方法中向编译器传递一个提示，但这只是解决了问题。

我的思维方式有问题吗？这是语言的限制还是设计使然？

IIRC，对这种操作的支持已添加到 Java 1.5，所以也许它会在将来的某个时候添加到 C#...？

* * *

## 回答 #1

> 赞同：19
> 
> 时间：2009-03-11T12:17:04.103

这是协方差，将在 C# 4.0 / .NET 4.0 中修复。目前，通用选项是最好的答案（for `IEnumerable<T>`- [not `IList<T>`etc](http://marcgravell.blogspot.com/2009/02/what-c-40-covariance-doesn-do.html)）。

但是在通用方法中，您必须考虑`T`. 您也可以使用`Cast<T>`or `OfType<T>`with LINQ 来实现类似的功能。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2009-03-18T17:22:53.553

在 C# 3.0 中，您可以使用“Cast”扩展方法。如果您导入 System.Linq 然后使用此代码：

```
public void AddRange2<T>(IEnumerable<T> foos) where T : Foo
{
    m_Foos.AddRange (foos.Cast<Foo>());
} 
```

那么它应该适合你。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-03-11T12:24:15.413

扩展方法有解决方法：

```
public static IEnumerable<TBase> ToBaseEnumerable<TBase, TDerived>( this IEnumerable<TDerived> items ) where TDerived : TBase {
    foreach( var item in items ) {
        yield return item;
    }
}
...
IEnumerable<Employee> employees = GetEmployees(); //Emplyoee derives from Person
DoSomethingWithPersons( employees.ToBaseEnumerable<Person, Employee>() ); 
```

但是“<Person, Employee>”有点尴尬：/。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2009-09-25T22:23:09.627

当然，强制转换解决方案可能会产生类强制转换异常。发布可枚举扩展工作的人说这很尴尬。我想出了一个只有一半尴尬的解决方案，不知道我是否会使用它：

```
public static class UpTo<T>
{
    public static IEnumerable<T> From<F>(IEnumerable<F> source) where F:T
    {
        // this cast is guaranteed to work
        return source.Select(f => (T) f);
    }
} 
```

用法：

IEnumerable 哺乳动物 = UpTo<Mammal>.From(kennel.Dogs)

# php - Codeigniter - 使用多个数据库

> ID：634291
> 
> 赞同：32
> 
> 时间：2009-03-11T12:24:03.463
> 
> 标签：php, database, codeigniter

**数据库.php**：

```
$db['default']['hostname'] = "192.168.2.104";
$db['default']['username'] = "webuser";
$db['default']['password'] = "----";
$db['default']['database'] = "vad";
$db['default']['dbdriver'] = "mysql";
$db['default']['dbprefix'] = "";
$db['default']['pconnect'] = TRUE;
$db['default']['db_debug'] = TRUE;
$db['default']['cache_on'] = FALSE;
$db['default']['cachedir'] = "";
$db['default']['char_set'] = "utf8";
$db['default']['dbcollat'] = "utf8_general_ci";

$db['stats']['hostname'] = "192.168.2.104";
$db['stats']['username'] = "webuser";
$db['stats']['password'] = "---";
$db['stats']['database'] = "vad_stats";
$db['stats']['dbdriver'] = "mysql";
$db['stats']['dbprefix'] = "";
$db['stats']['pconnect'] = TRUE;
$db['stats']['db_debug'] = TRUE;
$db['stats']['cache_on'] = FALSE;
$db['stats']['cachedir'] = "";
$db['stats']['char_set'] = "utf8";
$db['stats']['dbcollat'] = "utf8_general_ci"; 
```

问题是我只能在配置一 `$active_group`、默认值或统计信息中定义。我遵循了 CodeIgniter 文档并添加了以下内容：

```
$DB2 = $this->load->database('stats', TRUE); 
```

这样我连接到第二个数据库，但我失去了与第一个数据库的连接。有没有人知道如何加载两个数据库而不必在所有模型构造函数中执行以下操作？

```
$database1 = $this->load->database('database1', TRUE);
$database2 = $this->load->database('database2', TRUE); 
```

问候，

佩德罗

* * *

## 回答 #1

> 赞同：29
> 
> 时间：2011-01-12T22:01:36.880

codeigniter 中有一个错误。在类中插入一行将解决整个问题。这是原始来源： http: [//koorb.wordpress.com/2007/11/16/codeigniter-connect-to-multiple-databases/](http://koorb.wordpress.com/2007/11/16/codeigniter-connect-to-multiple-databases/)

** 此修复不适用于 PostgreSQL

这是一个副本，以防万一该站点出现故障。

行号已更改。这是来自codeigniter的错误修复：

开始修正

描述

所有数据库调用都转到同一个数据库（最后一个已初始化）

要解决此问题，请更改 /system/database/DB_driver.php 中的 simple_query 函数：

```
function simple_query($sql)
{
    if ( ! $this->conn_id)
    {
        $this->initialize();
    }

    $this->db_select(); //<-----------------  Added this line
    return $this->_execute($sql);
} 
```

这完全解决了问题，所以你可以在模型中做这样的事情

```
$this->legacy_db = $this->load->database('legacy', true); 
```

* * *

## 回答 #2

> 赞同：24
> 
> 时间：2009-06-03T15:47:23.973

除了应用 Camacho 提到的 hack，您还可以将 database.php 文件中的“pconnect”标志设置为所有连接的 FALSE。

* * *

## 回答 #3

> 赞同：5
> 
> 时间：2010-07-06T08:16:51.610

目前，codeigniter 无法在持久连接中连接到多个数据库。所以，你应该关闭你的连接的持久化。你可以这样做..

```
$db['default']['pconnect'] = FALSE;

$db['stats']['pconnect'] = FALSE; 
```

* * *

## 回答 #4

> 赞同：4
> 
> 时间：2009-03-13T14:27:47.460

我修复了在框架上更改 DB_driver.php 的问题。

在我添加的这个功能中`$this->db_select();`，您在使用 2 个数据库时再也不会失去连接。

```
function simple_query($sql)
{
    if ( ! $this->conn_id)
    {
        $this->initialize();
    }

    $this->db_select();

    return $this->_execute($sql);
} 
```

* * *

## 回答 #5

> 赞同：3
> 
> 时间：2010-10-14T05:50:33.850

您可以尝试修改 session.php 文件中的 CI_Session() 函数。

代替

```
$this->CI->load->database(); 
```

有了这个

```
$this->CI->db1 = $this->CI->load->database('default', TRUE);
$this->CI->db2 = $this->CI->load->database('db2', TRUE); 
```

这样，您无需在所有模型文件中加载 2 个 db，而是应直接使用对象来使用它们。

**$this->db1**将访问默认组 db，**$this->db2**将访问 db2 组 db。（两个 db 组都应该在 database.php 中定义）

* * *

桑达尔

* * *

## 回答 #6

> 赞同：1
> 
> 时间：2016-11-24T00:33:31.693

> 如果您只需要在同一连接上使用不同的数据库，则不需要创建单独的数据库配置。您可以在需要时切换到不同的数据库，如下所示：

$this->db->db_select($database2_name);

[CodeIgbiter 用户指南](https://www.codeigniter.com/user_guide/database/connecting.html)

# apache-flex - Flash 应用程序依赖于 Flex。是否有任何 SWF 字节码大小优化器？

> ID：634293
> 
> 赞同：3
> 
> 时间：2009-03-11T12:24:16.037
> 
> 标签：apache-flex, optimization, flash, bytecode

使用 Flex 的 Hello world 应用程序，使用 optimize=true 编译，大小为 178K。如何减小应用程序大小？

我们不喜欢使用 RSL，我们不喜欢避免使用 Flex。

生成的 SWF 的最大部分是未使用的字节码。是否有任何工具可以优化字节码——删除未使用的方法、类、给方法更短的名称等等？

我知道一些这样的 Java 字节码工具。SWF 有吗？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2009-03-11T18:19:11.003

大小是 Flex API 的成本。您不必挑选编译的部分，因此最好的情况仍然会携带很多包袱。

如果大小是一个大问题，您可以只使用 ActionScript 的 flash 部分，但您会失去很多不错的预构建 Flex 组件。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-03-11T12:39:10.870

您可以尝试一些[Flash Optimizer](http://www.swf-optimizer.com/)，但我怀疑事情会变得更好。您是否可以更改源代码，进行您提到的优化并重新编译应用程序？

还是您在谈论 Flex 开销？如果是这样，您不必在意，因为对于更大的项目，这将几乎保持不变，并且如果它增长，那是因为您需要一些类或方法（多媒体等）。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2009-03-11T18:39:41.720

为什么不是 RSL？在您的情况下，将 flex 框架作为 RSL 分开似乎是唯一值得考虑的选择。RSL 在请求之间被缓存。

如果它已经低至 178k，优化器不会显着减小大小。另外，看看那个大小，我想你没有嵌入任何图像或其他资源。如果你是，取出它们并动态加载它们也会有所帮助，但代价是发出更多的 HTTP 请求。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2009-03-13T15:49:20.150

好吧 - 这是选择正确工具的案例吗？如果您需要创建一个应用程序 - 我认为开销不会太有害。如果您正在创建一个网站，我可以看到您可能需要更小的文件大小 - 您可能需要使用纯 actionscript 而没有 flex 框架的开销。

您确实说过您不想避免使用 flex - 您是指 flex builder 还是 flex 框架？您仍然可以使用 flex builder 创建仅操作脚本的项目，与 CS4 中的操作面板相比，这是一个梦想......

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2009-05-01T11:57:12.790

试试这个关于 flex 文件大小优化的链接。
[http://askmeflash.com/article_m.php?p=article&id=9](http://askmeflash.com/article_m.php?p=article&id=9)

这些是可以完成的主要改进。在 Flex 中创建的所有应用程序都在 Flex 框架上运行，因此基本框架必须在那里。例如，如果您使用的是容器，那么像事件管理器、样式表管理器、舞台、应用程序这样的类是必须的，它们使弹性应用程序的初始大小无法避免。另一种选择是仅使用闪存。

* * *

## 回答 #6

> 赞同：-1
> 
> 时间：2009-11-27T19:54:30.617

您想使用 Flex 并且希望您的项目很小。但 Flex 很大。

听起来你必须做出决定。

# xslt - 为什么我的 XSLT 变量没有替换它们的值？

> ID：634295
> 
> 赞同：5
> 
> 时间：2009-03-11T12:24:55.177
> 
> 标签：xslt, variables, substitution

我正在尝试使用 XSLT 变量并且没有取得多大成功，希望我只是在做一些愚蠢的事情。

我有以下代码片段：

```
<xsl:stylesheet
  xmlns:xsl="http://www.w3.org/1999/XSL/Transform"
  xmlns:xalan="http://xml.apache.org/xslt"
  version="1.0">

    <xsl:template match="/">
      <xsl:variable name="config" select="query/@config"></xsl:variable> 
```

所以我希望有一个变量'config'设置为我的顶级元素'query'的'config'属性的值。

然后，我稍后尝试在样式表中使用该变量，例如：

```
<a href="localhost/test?go">
    {$config}
</a> 
```

但我在输出 HTML 文档中看到的输出是：

```
<a href="localhost/test?go">
    {$config}
</a> 
```

所以这个值没有像我预期的那样被替换。

我认为这几乎是最简单的情况，所以我在做傻事！请帮忙，谢谢！

* * *

更新感谢所有回复的人，我误解了我是在属性中还是在属性之外工作的不同背景。很好地解决了我的问题！

如果可以的话，我会接受两个答案，一个是我的答案，另一个是 @Aaron Digulla 的，它解释了属性问题。

* * *

## 回答 #1

> 赞同：13
> 
> 时间：2011-12-14T18:44:32.803

这里有两个问题看起来相同，但有细微的不同：1）*如何*按名称引用变量？2)*在哪里*可以按名称引用变量？

首先，变量总是使用`$varname`语法来引用。其次，这可以在*任何允许表达式的地方*完成。这是第二部分似乎令人困惑。首先，默认情况下，元素或属性的值将按字面输出，因此在以下示例中实际上没有引用任何变量：

```
<element attr="$test">$test or {$test}</element> 
```

输出将与输入的内容完全匹配。

要输出变量的值，我们需要在允许表达式的地方引用它。在元素内容中，我们使用`xsl:value-of`; 在被视为[属性值模板](http://www.w3.org/TR/xslt#attribute-value-templates)的属性（例如文字结果元素的属性）中，表达式由大括号分隔`{}`。假设以下声明：

```
<xsl:variable name="test" select="'value'"/> 
```

...然后是以下内容：

```
<element attr="{$test}"><xsl:value-of select="$test"/></element> 
```

...结果是：

```
<element attr="value">value</element> 
```

关于 AVT 和 的一些离别说明`value-of`：

*   在这两种情况下，变量都被引用为`$test`. AVT 中的大括号不是变量引用的一部分；它们是表达式分隔符。
*   在任何一种情况下，表达式都不需要包含对变量的引用；任何 XPath 表达式都是允许的。
*   并非 XSLT 文档中的所有属性都被视为属性值模板。例如，注意`xsl:value`'s`select`属性*已经接受一个表达式*作为内容。
*   **问题**：为什么不能`value-of`像这样在属性中使用？

    ```
    <element attr="<xsl:value-of select="$test"/>"/> 
    ```

    **答**：因为 XSLT 文档必须包含格式良好的 XML（而事实并非如此）。

*   **问题**：为什么不能`{$varname}`在元素内容中使用？

    **Glib 回答**：因为 XSLT 的创建者没有那样设计它。

* * *

## 回答 #2

> 赞同：12
> 
> 时间：2009-03-11T12:30:58.470

在您的样式表中，您必须使用：

```
<xsl:value-of select="$config"/> 
```

代替：

```
{$config} 
```

* * *

## 回答 #3

> 赞同：6
> 
> 时间：2009-03-11T12:34:40.973

`{$config}`仅适用于 XSLT 元素的属性。（注意：大括号内的美元，因为完整的 XPath 表达式必须用大括号括起来）

* * *

## 回答 #4

> 赞同：3
> 
> 时间：2009-03-11T12:29:59.160

使用`<xsl:value-of select="$config"/>`而不是`{$config}`.

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2014-05-12T22:44:44.547

@lwburk 的答案很棒 (+1)，但最后一个问题/答案仅适用于 XSLT 1.0 和 2.0。在 3.0 中，您可以使用 TVT（[文本值模板](http://www.w3.org/TR/xslt-30/#text-value-templates)；类似于@lwburk 的答案中提到的 AVT（属性值模板））。

要使用 TVT，请将标准属性添加`xsl:expand-text="yes"`到元素。这将导致处理器将该元素的后代文本节点视为 TVT。

例子：

**XSLT 3.0**

```
<xsl:stylesheet version="3.0" xmlns:xsl="http://www.w3.org/1999/XSL/Transform">
    <xsl:output method="xml" omit-xml-declaration="yes"/>

    <xsl:template match="/">
        <xsl:variable name="who" select="'Dan'"/>
        <xsl:variable name="what" select="'BAM!'"/>
        <result xsl:expand-text="yes">This is {$who}'s result: {$what}</result>
    </xsl:template>

</xsl:stylesheet> 
```

**输出**（使用任何格式良好的 XML 作为输入）

```
<result>This is Dan's result: BAM!</result> 
```

*注意：使用 Saxon-PE 9.5 进行测试。*

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2009-03-11T12:30:43.370

因为你需要使用`<xsl:value-of select="config"/>`？

# java - 如何更改 JEditorPane 中 HTMLDocument 的特定元素的颜色？

> ID：634296
> 
> 赞同：2
> 
> 时间：2009-03-11T12:25:34.410
> 
> 标签：java, jeditorpane, dom

当我将鼠标悬停在链接上时，我基本上想实现更改链接的颜色。当我将鼠标悬停在链接上时触发的 HyperlinkEvent 将 HTML 元素交给我，但它不允许我在其上设置任何样式属性，而且我不知道如何获取具有可设置属性的元素。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2009-03-11T17:00:13.440

我想出了使用样式文档和 HTMLEditorKit 的一些帮助我想做什么：

```
public class HighlightHyperlinkExample {
    private static Element lastHyperlinkElementEntered;
    private static JEditorPane textPane;

    public static void main(String[] args) {
        textPane = new JEditorPane();
        textPane.setContentType(new HTMLEditorKit().getContentType());
        JScrollPane scrollPane = new JScrollPane(textPane);
        textPane.setText(
                "Sample text with <a href=\"x\">a link</a> and another <a href=\"x\">link</a>.");

        initListeners();

        JFrame frame = new JFrame();
        frame.add(scrollPane);
        frame.setDefaultCloseOperation(JFrame.EXIT_ON_CLOSE);
        frame.pack();
        frame.setVisible(true);
    }

    private static void initListeners() {
        textPane.addMouseListener(new MouseAdapter() {
            @Override
            public void mouseExited(MouseEvent e) {
                removeHyperlinkHighlight();
            }
        });
        textPane.addMouseMotionListener(new MouseMotionListener() {
            public void mouseDragged(MouseEvent e) {
            }

            public void mouseMoved(MouseEvent e) {
                Point pt = new Point(e.getX(), e.getY());
                int pos = textPane.viewToModel(pt);
                if (pos >= 0) {
                    HTMLDocument hdoc = (HTMLDocument) textPane.getDocument();
                    Element elem = hdoc.getCharacterElement(pos);
                    if (elem != null) {
                        AttributeSet a = elem.getAttributes();
                        AttributeSet anchor = (AttributeSet) a.getAttribute(HTML.Tag.A);
                        if (anchor != null) {
                            //only highlight anchor tags
                            highlightHyperlink(elem);
                        } else {
                            removeHyperlinkHighlight();
                        }
                    }
                }
            }
        });
    }

    private static void removeHyperlinkHighlight() {
        changeColor(lastHyperlinkElementEntered, Color.BLUE);
        lastHyperlinkElementEntered = null;
    }

    private static void highlightHyperlink(Element hyperlinkElement) {
        if (hyperlinkElement != lastHyperlinkElementEntered) {
            lastHyperlinkElementEntered = hyperlinkElement;
            changeColor(hyperlinkElement, Color.RED);
        }
    }

    private static void changeColor(Element el, Color color) {
        if (lastHyperlinkElementEntered != null) {
            HTMLDocument doc = (HTMLDocument) textPane.getDocument();
            int start = el.getStartOffset();
            int end = el.getEndOffset();
            StyleContext ss = doc.getStyleSheet();
            Style style = ss.addStyle("HighlightedHyperlink", null);
            style.addAttribute(StyleConstants.Foreground, color);
            doc.setCharacterAttributes(start, end - start, style, false);
        }
    }
} 
```

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2009-03-11T12:36:26.583

请参阅[突出显示 JTextComponent 中的单词](http://www.exampledepot.com/egs/javax.swing.text/style_HiliteWords.html)。

```
JTextArea textComp = new JTextArea();

// Highlight the occurrences of the word "public"
highlight(textComp, "public");

// Creates highlights around all occurrences of pattern in textComp
public void highlight(JTextComponent textComp, String pattern) {
    // First remove all old highlights
    removeHighlights(textComp);

    try {
        Highlighter hilite = textComp.getHighlighter();
        Document doc = textComp.getDocument();
        String text = doc.getText(0, doc.getLength());
        int pos = 0;

        // Search for pattern
        while ((pos = text.indexOf(pattern, pos)) >= 0) {
            // Create highlighter using private painter and apply around pattern
            hilite.addHighlight(pos, pos+pattern.length(), myHighlightPainter);
            pos += pattern.length();
        }
    } catch (BadLocationException e) {
    }
}

// Removes only our private highlights
public void removeHighlights(JTextComponent textComp) {
    Highlighter hilite = textComp.getHighlighter();
    Highlighter.Highlight[] hilites = hilite.getHighlights();

    for (int i=0; i<hilites.length; i++) {
        if (hilites[i].getPainter() instanceof MyHighlightPainter) {
            hilite.removeHighlight(hilites[i]);
        }
    }
}

// An instance of the private subclass of the default highlight painter
Highlighter.HighlightPainter myHighlightPainter = new MyHighlightPainter(Color.red);

// A private subclass of the default highlight painter
class MyHighlightPainter extends DefaultHighlighter.DefaultHighlightPainter {
    public MyHighlightPainter(Color color) {
        super(color);
    }
} 
```

# .net - 在数据表中查找一行并在 .Net 中将其删除

> ID：634302
> 
> 赞同：0
> 
> 时间：2009-03-11T12:28:08.790
> 
> 标签：.net, findby

我有一个强类型数据表，我通过主键（FyndBy）搜索一行，如果该行存在，我想删除它。从风格的角度来看，您更喜欢以下哪种方法？

```
MyDataRowType selectedRow = table.FindByTablePrimaryKey(something);
if (selectedRow != null)
    selectedRow.Delete(); 
```

或者

```
if (table.FindByTablePrimaryKey(something) != null)
    table.FindByTablePrimaryKey(something).Delete(); 
```

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2009-03-11T12:30:46.007

绝对第一。使用第二个将需要对表进行两次搜索，并且也更难阅读。（恕我直言）

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-03-11T12:31:26.067

一般id说第一个例子..

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2009-03-11T12:36:01.797

选择第一个的技术原因是您使用一个简单的指针（通常只有 4 个字节的内存）来存储对行的引用 - 也就是说，通过使用仅 4 个字节，您无需再次扫描表，这会占用大量资源（当然取决于表的大小）。

# emacs - XEmacs 与 Emacs 哪个更适合 C++ 编程

> ID：634306
> 
> 赞同：11
> 
> 时间：2009-03-11T12:29:52.980
> 
> 标签：emacs, xemacs

哪个是 C++ 编程 XEmacs 或 Emacs 更好的编辑器？

* * *

## 回答 #1

> 赞同：19
> 
> 时间：2009-03-11T12:46:23.410

[对 GNU Emacs 和 XEmacs 之间差异的 Wikipedia 描述](http://en.wikipedia.org/wiki/Xemacs#XEmacs_and_GNU_Emacs)。

在我看来，在 GNU Emacs 21 发布之后，XEmacs 的开发在几年前就开始停滞不前。如今，大多数 elisp 包都是为 GNU Emacs 编写的，并且不能保证它们可以在 XEmacs 中工作。

* * *

## 回答 #2

> 赞同：16
> 
> 时间：2009-03-11T13:08:47.880

[Steve Yegge](http://steve-yegge.blogspot.com/2008/04/xemacs-is-dead-long-live-xemacs.html)对为什么应该使用 GNU Emacs 提出了一些重要的观点。除了有一篇关于[有效](http://steve.yegge.googlepages.com/effective-emacs)使用 Emacs 的精彩文章。这些天来，除非你有特定的理由使用它，否则我会远离 XEmacs。

* * *

## 回答 #3

> 赞同：7
> 
> 时间：2012-05-31T04:32:49.763

哪个编辑器更适合编写 C++ 代码的问题的答案是，对于该功能，实际上没有区别。一个有什么，另一个有类似的功能。您选择并选择您喜欢的那个。

它们之间存在差异，对于某些任务，一种可能比另一种更好。例如，Mule，多语言文件的 XEmacs 实现；XEmacs 做对了，而 Emacs 在某些方面仍然存在问题。这取决于任务。每个人在某些任务上都做得更好，而对于许多任务来说，并没有实际的区别。

至于 XEmacs 没有被积极开发——去年我和儿子写了一个 lisp 程序来实现图标主题。我们还编写了一个缓冲区颜色程序，以便轻松更改不同缓冲区中的颜色，包括基于规则的颜色和任意选择的颜色。这些包都不存在于 Emacs 中。我们还重写了 xpm 模式，将其从 400 行代码增加到 2000 多行代码，添加了对 alpha 图层、渐变填充的支持，改进了显示，添加了更多工具（鼠标光标工具，如画笔）和新的图标栏运行一切……就在去年夏天。制作和编辑图标（以及其他类型的 xpm）的更好工具。Emacs 还没有，尽管他们当然可以移植它。

我只是说，XEmacs 的开发速度慢了很多，但它*仍在*开发中。

根据手头的任务选择您喜欢的编辑器 - 而不是人们说不再开发的编辑器！

* * *

## 回答 #4

> 赞同：5
> 
> 时间：2009-03-11T12:59:04.143

恕我直言，对于 C++ 开发，它们之间没有太多选择，因为基本工具对两者都适用。这些天它们在 GNU Emacs 中的工作可能稍微好一些，因为我觉得这两天针对这两个目标的人越来越少。两者都有一个 GUI，但根据我的经验，你最好在片刻后关闭它的一部分。

我一直是 XEmacs 的长期用户，直到大约两年前，我发现与 GNU Emacs 开发相比，XEmacs 开发似乎明显落后——过去是相反的。我设法毫不费力地进行了切换，并且从那以后一直在使用各种 GNU Emacsen。此外，您会发现许多最近将 Emacs 移植到其他平台（如 Carbon Emacs、Aquamacs 或 EmacsW32）都是基于 GNU Emacs。

* * *

## 回答 #5

> 赞同：3
> 
> 时间：2009-03-11T13:20:45.683

目前使用 GNU Emacs 更好，因为它现在比 XEmacs 有更多的功能。Cedet 目前在 GNU Emacs 上工作得更好

* * *

## 回答 #6

> 赞同：3
> 
> 时间：2009-03-12T17:34:19.983

Xemacs 尚未在积极开发中，因此 emacs 是 emacs 实现的唯一选择。

* * *

## 回答 #7

> 赞同：2
> 
> 时间：2009-03-11T12:45:27.640

Emacs 长期以来在所有平台上都支持 GUI。

除了对外观和感觉的偏好之外，我唯一能想到的就是我听说两者之间存在一些 elisp 兼容性问题。

**编辑：** EmacsWiki 有一篇[EmacsAndXEmacs](http://www.emacswiki.org/emacs/EmacsAndXEmacs)比较文章。

# asp.net - 如何更改 .ASPX 自动格式化设置 (Visual Studio)

> ID：634311
> 
> 赞同：34
> 
> 时间：2009-03-11T12:30:50.047
> 
> 标签：asp.net, visual-studio-2008, formatting

在 .aspx 文件（本例中为 MVC 视图）中键入代码时，Visual Studio 应用两种类型的格式，一种适用于常规 html 标记结构（可以从工具->选项->文本编辑器->Html 进行控制）另一个是 <% %> 标签内的内容。

对于第二种类型的自动格式化，即 <% %> 内容格式化，我遇到了两个烦恼。

首先是如何将新行添加到语句块中：

如果我输入这个：

```
<% if(condition) { %>
    ...
<% } %> 
```

它会自动更正为：

```
<% if(condition) 
   { %>
    ...
<% } %> 
```

如果这是一个 .cs 文件，则更正是正确的，但对于 .aspx 文件的标签汤，我发现第一个更具可读性。有没有办法在不影响 .cs 文件格式的情况下关闭这种行为？

其次，每当我写这样的东西时：

```
<%=Html.ActionLink("Report","ListItems") %> 
```

我找不到让它自动格式化的方法（在适当的地方添加间距）：

```
<%=Html.ActionLink("Report", "ListItems") %> 
```

在代码中，您通常需要一个 ; 或 } 表示您已完成一行/部分代码，以便 Visual Studio 可以对其进行格式化。有没有办法为 <%= 类型的表达式提供此信号？

**澄清**

这个问题是关于 <% %> 标记内的代码格式，**而不影响常规 C# 源文件的格式**。它在第一段中说我完全了解文本编辑器菜单。

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2009-05-08T22:57:35.913

文本编辑器菜单就在那里，它不允许你做你想做的事情。当您右键单击 aspx 页面时，单击“格式化和验证...”，然后单击“标记特定选项...”按钮，您会获得每个客户端或服务器标记的一组设置，但不是针对<%-标签。

至于您问题的第二部分， Ctrl-E,D 格式化您的文档，但不插入您想要的间距。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2009-03-11T14:03:34.830

您可以在此菜单中更改自动格式化：
**工具 -> 选项 -> 文本编辑器**

例如，您可以更改 if 语句的新行，在：
**C#
- 格式
- 新行
--- 将左大括号放在控制块的新行上**

希望这可以帮助。

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2009-05-11T04:14:04.870

目前我知道的唯一答案是使用正则表达式编写宏并将它们分配给易于使用的和弦。我之前回答了一个问题，其中自动格式化会将右大括号更改为：

```
<%
     }
     %> 
```

您可以找到该答案，包括[此处](https://stackoverflow.com/questions/720042/how-do-you-get-server-blocks-to-format-well-in-visual-studio/721957#721957)使用的宏的代码。

* * *

## 回答 #4

> 赞同：2
> 
> 时间：2010-07-31T11:44:46.773

根据微软的说法，这是 Visual Studio 中的一个错误，刚刚修复 - 虽然我还没有看到修复，所以无法确认它们确实有。10 年后他们似乎不太可能突然修复它，但我们拭目以待。请参阅[http://connect.microsoft.com/VisualStudio/feedback/ViewFeedback.aspx?FeedbackID=514691](http://connect.microsoft.com/VisualStudio/feedback/ViewFeedback.aspx?FeedbackID=514691)

* * *

## 回答 #5

> 赞同：-4
> 
> 时间：2009-03-11T15:03:21.943

如果您从未自定义过您的环境，我建议您花一些时间在“工具”>>“选项”对话框中。您可以做很多巧妙的事情来自定义您的环境，以及更改 Visual Studio 的默认行为方式。

我没有在 MVC 视图上尝试过新行，所以我并没有完全相信它可以工作，但它也是我首先尝试的地方。它确实可以在 C# 文件、代码后面或其他方式中工作。

# sharepoint - 能否在 Sharepoint 2007 中改进用于获取文档大小的查询？

> ID：634321
> 
> 赞同：0
> 
> 时间：2009-03-11T12:35:18.710
> 
> 标签：sharepoint, sharepoint-2007

好吧，由于我对 Sharepoint 2007 比较陌生，我想改进我为这个平台编写代码的方式，并改进我已经养成的一些习惯。

在下面的代码中，我正在做的是询问“文档”列表中文档的大小，但我的印象是我创建了许多对象来访问信息。有没有办法直接访问文档（我必须访问 de spweb，然后是列表，然后是文档）？

我要改进的一件事是不要使用 oSPWeb.Lists[0]，它对应于 oSPWeb.Lists["Documents"]，没有一个能说服我，因为这个列表可以称为“Documentos”，o“Documents” “ ETC...

请问你能改进这段代码吗？

```
System.Text.StringBuilder oSb = new System.Text.StringBuilder();

               oSb.Append("     <Where>");
        oSb.Append("         <Eq>");
        oSb.Append("              <FieldRef Name=\"FileLeafRef\" />");
        oSb.Append("              <Value Type=\"Text\">"+documento+"</Value>");
        oSb.Append("         </Eq>");
        oSb.Append("     </Where>");
        oSb.Append("    <ViewFields>");
        oSb.Append("         <FieldRef Name=\"FileSizeDisplay\" />");
        oSb.Append("    </ViewFields>");    

        string sResult = oSb.ToString();

        bool Existe = false;
        SPSite sps = null;
        SPWeb oSPWeb = null;
        SPList oList = null;
        SPListItemCollection col = null;

        try
        {
            sps = SPContext.Current.Site;
            using(oSPWeb = sps.OpenWeb(url))
            {
                oList = oSPWeb.Lists[0];
                SPQuery qry = new SPQuery();
                qry.Query = sResult;

                col=oList.GetItems(qry);
            }
        }

        catch { }

        if (col != null)
        {

            //return col[0].File.Length.ToString();
            return col[0]["FileSizeDisplay"].ToString();
        }
        else
        {
            return null;
        } 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-03-11T17:16:54.023

您可能需要知道文档库的名称、索引或 ID，因为特定站点中可能有多个文档库。因此，名称可能存储在配置位置的某个位置（可能是另一个具有名称-值对的列表），但最终您将不得不执行类似 web.Lists["list name"] （或 list Id - I 'd 避免列表索引）。

使用 CAML 查询（您正在这样做）是从列表/库中选择多个项目的典型方法。我唯一的建议是，如果集合不为空，则不要假设集合中至少有一项。所以而不是：

```
if (col != null) 
```

我会做：

```
if (col != null && col.Count > 0) 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-03-12T11:44:53.517

最后，我按照 Kirk 和 JMD 的建议改进了代码，网址为 [http://blogs.msdn.com/sowmyancs/archive/2008/10/26/best-practices-sharepoint-object-model-for-performance-tuning .aspx](http://blogs.msdn.com/sowmyancs/archive/2008/10/26/best-practices-sharepoint-object-model-for-performance-tuning.aspx)确实是优化代码的一个非常好的开始：

```
System.Text.StringBuilder oSb = new System.Text.StringBuilder();

            oSb.Append("     <Where>");
            oSb.Append("         <Eq>");
            oSb.Append("              <FieldRef Name=\"FileLeafRef\" />");
            oSb.Append("              <Value Type=\"Text\">"+document+"</Value>");
            oSb.Append("         </Eq>");
            oSb.Append("     </Where>");
            oSb.Append("    <ViewFields>");
            oSb.Append("         <FieldRef Name=\"FileSizeDisplay\" />");
            oSb.Append("    </ViewFields>");            

            string sResult = oSb.ToString();

            SPSite sps = null;
            SPWeb oSPWeb = null;
            SPList oList = null;
            SPListItemCollection col = null;

            try
            {
                sps = SPContext.Current.Site;
                using(oSPWeb = sps.OpenWeb(url))
                {
                    //oList = oSPWeb.Lists[0];
                    oList=oSPWeb.GetList(oSPWeb.Url + "/" + listName);
                    SPQuery qry = new SPQuery();
                    qry.Query = sResult;

                    col=oList.GetItems(qry);
                }
            }

            catch { }

            if (col != null && col.Count > 0)
            {
                return col[0]["FileSizeDisplay"].ToString();
            }
            else
            {
                return null;
            } 
```

# javascript - 如何在 Html 文件中自动运行 Active X 控件

> ID：634337
> 
> 赞同：1
> 
> 时间：2009-03-11T12:40:27.090
> 
> 标签：javascript, internet-explorer, web-applications

使用 IE 时，它总是要求我启动活动的 X 控件。是否有任何方法或方式来激活 Active X 控件。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2009-03-11T12:47:36.700

如果您在加载本地文件时询问警告，那么您所要做的就是在您的页面文档类型之后添加以下注释：

```
<!-- saved from url=(0014)about:internet --> 
```

像这样的东西：

```
<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01//EN" "http://www.w3.org/TR/html4/strict.dtd">
<!-- saved from url=(0014)about:internet -->

<html>
<head>
<title></title> 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-03-11T14:56:15.483

对于公司 Intranet 计算机，您可以在 Internet 设置 > 安全 > 受信任的站点下更改设置。将站点添加到受信任站点，选择自定义级别并启用 ActiveX。请注意，已签名和未签名的 ActiveX 之间存在差异，因此您可能希望获取已签名。您必须将这些设置分发给所有用户，这是系统人员应该知道的事情。
但是，如果您在 Internet 上，您可能不想使用 ActiveX。

# c# - 通过反射获取当前 MethodBase

> ID：634340
> 
> 赞同：6
> 
> 时间：2009-03-11T12:42:00.877
> 
> 标签：c#, .net, reflection

我可以以某种方式获取当前方法的 MethodInfo 吗？

* * *

## 回答 #1

> 赞同：17
> 
> 时间：2009-03-11T12:44:11.170

```
System.Reflection.MethodBase.GetCurrentMethod() 
```

在对反射命名空间进行了一番折腾之后，我自己找到了它......

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-03-11T12:45:06.253

试试`System.Reflection.MethodBase.GetCurrentMethod`静态方法。

# java - 从 Hibernate 中的模型中获取表名

> ID：634342
> 
> 赞同：38
> 
> 时间：2009-03-11T12:42:34.480
> 
> 标签：java, hibernate

如何在 Hibernate 中获取模型的表名？

显然曾经有一个`getTableName()`方法 in [`ClassMetadata`](http://www.hibernate.org/hib_docs/v3/api/org/hibernate/metadata/ClassMetadata.html)，但它已被删除。

中有一个[`getClassMapping(String entityName)`](http://www.hibernate.org/hib_docs/v3/api/org/hibernate/cfg/Configuration.html#getClassMapping(java.lang.String))方法[`Configuration`](http://www.hibernate.org/hib_docs/v3/api/org/hibernate/cfg/Configuration.html)，但我不知道如何（或是否应该）在我的 DAO 实现中使用 Configuration 。

我的 DAO 实现是[HibernateGeneralGenericDao](https://source.sakaiproject.org/maven2/org/sakaiproject/generic-dao/site/apidocs/org/sakaiproject/genericdao/hibernate/HibernateGeneralGenericDao.html)的子类。

**更新：**事实证明我可以在没有表名的情况下做我想做的事情。但是，为了参考，我将保持问题开放（并尝试答案）。

* * *

## 回答 #1

> 赞同：37
> 
> 时间：2009-03-20T06:23:35.000

这有点奇怪，但它有效：

```
ClassMetadata hibernateMetadata = sessionFactory.getClassMetadata(pClassName);

if (hibernateMetadata == null)
{
    return;
}

if (hibernateMetadata instanceof AbstractEntityPersister)
{
     AbstractEntityPersister persister = (AbstractEntityPersister) hibernateMetadata;
     String tableName = persister.getTableName();
     String[] columnNames = persister.getKeyColumnNames();
} 
```

* * *

## 回答 #2

> 赞同：28
> 
> 时间：2009-03-11T14:00:33.560

如果您使用 Table 注释，您可以执行以下操作：

```
Table table = Entity.class.getAnnotation(Table.class);
String tableName = table.name(); 
```

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2009-05-28T09:43:25.837

```
Configuration cfg = new Configuration().configure();    
cfg.addResource("com/struts/Entities/User.hbm.xml");
cfg.setProperty("hibernate.dialect", "org.hibernate.dialect.MySQLDialect");
Mappings m=cfg.createMappings();
System.out.println(">> class: "+m.getClass(className));
System.out.println("User table name:: "+m.getClass("User").getTable().getName()); 
```

* * *

## 回答 #4

> 赞同：2
> 
> 时间：2021-03-25T15:29:03.573

`classMetadata`已弃用。

利用：

```
@PersistenceContext
private EntityManager entityManager;

public String extractTableName(final Class<?> modelClazz) {
    final MetamodelImpl metamodel = (MetamodelImpl) entityManager.getMetamodel();
    final EntityPersister entityPersister = metamodel.entityPersister(modelClazz);
    if (entityPersister instanceof SingleTableEntityPersister) {
        return ((SingleTableEntityPersister) entityPersister).getTableName();
    } else {
        throw new IllegalArgumentException(modelClazz + " does not map to a single table.");
    }
} 
```

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2009-03-11T14:42:53.207

使用配置，您可以为特定类型调用 GetClassMapping() 方法，这将为您提供该类型的一些映射信息。

（至少，在 NHibernate 中是这种情况，但我认为在 Hibernate 中也是如此）。

* * *

## 回答 #6

> 赞同：1
> 
> 时间：2016-03-31T10:13:53.850

或者在 GUI 中显示所有列和所有实体的列表，我需要动态加载表、实体、属性和列名、类型、setter、getter 甚至漂亮标签的完整列表，这就是我根据 @ 做的使用 java 8 流重构的 Tom Redfem 解决方案：

```
public void loadHibernateMetadata() throws ClassNotFoundException {
    Map<String, ClassMetadata> hibernateMetadata = sessionFactory.getAllClassMetadata();        

    hibernateMetadata.values()
        .stream()
        .filter(metadata -> metadata != null && metadata instanceof AbstractEntityPersister)
        .map(AbstractEntityPersister.class::cast)
        .forEach( persister -> createNewnParam(persister));
        ;

} 
```

然后 createNewParam 方法是：

```
private void createNewParam(AbstractEntityPersister persister) {
    try {
        Class<?> $class = Class.forName(persister.getEntityName());

        List<String> getterNameRoster = Lists.newArrayList($class.getMethods())
                .stream()
                .filter( method -> method.getName().startsWith("get") || method.getName().startsWith("is"))
                .map(getterName -> getterName.getName())
                .collect(toList())
                ;

        List<String> setterNameRoster = Lists.newArrayList($class.getMethods())
                .stream()
                .filter( method -> method.getName().startsWith("set") )
                .map(setterName -> setterName.getName())
                .collect(toList())
                ;           

        Iterable<AttributeDefinition> attrs = persister.getAttributes();
        attrs.forEach(a -> {        

            String columnName = persister.getPropertyColumnNames(a.getName())[0];
            org.hibernate.type.Type hibernateType =persister.getPropertyType(a.getName());

            Optional<String> optionalGetter = getterNameRoster.stream()
                            .filter(getterStr -> getterStr.equalsIgnoreCase( String.format("get%s", a.getName()) ) ||
                                                 getterStr.equalsIgnoreCase( String.format("is%s", a.getName())) )
                            .findFirst()                                
                            ;

            String getterName = optionalGetter.isPresent() ? optionalGetter.get() : new String("");

            Optional<String> optionalSetter = setterNameRoster.stream()
                                .filter(setterStr -> setterStr.equalsIgnoreCase( String.format("set%s", a.getName()) ))                 
                                .findFirst()                                    
                                ;
            String setterName = optionalSetter.isPresent() ? optionalSetter.get() : new String("");

            Param param = new Param(persister.getEntityName(), 
                                                        persister.getTableName().replaceAll("\"", "").toUpperCase(), 
                                                        columnName.replaceAll("\"", "").toUpperCase(),
                                                        a.getName(),
                                                        getterName, 
                                                        setterName, 
                                                        hibernateType.getName(), 
                                                        capitalizeFirstLetter(splitCamelCase(a.getName()))
                                                        );
            hibernateParamList.add(param);
            logger.debug(param.toString());
        });

    } catch (ClassNotFoundException e) {
        logger.error(String.format("error occured generating the params %s" , e));
    }
} 
```

和两个 String 辅助方法来生成漂亮的标签，这可能与这篇文章无关

```
private String splitCamelCase(String s) {
   return s.replaceAll(
      String.format("%s|%s|%s",
         "(?<=[A-Z])(?=[A-Z][a-z])",
         "(?<=[^A-Z])(?=[A-Z])",
         "(?<=[A-Za-z])(?=[^A-Za-z])"
      ),
      " "
   );
}

private String capitalizeFirstLetter(String s) {
    return Character.toUpperCase(s.charAt(0)) + s.substring(1);
} 
```

当然，在我的 WebAppConfig.class 中，我得到了会话工厂

```
public SessionFactory sessionFactory() {
  LocalSessionFactoryBuilder builder =
            new LocalSessionFactoryBuilder(dataSource());
  builder.addProperties(hibernateProperties());
  builder.scanPackages(new String[] { "com....model" });
  SessionFactory sessionFactory = builder.buildSessionFactory();

  return sessionFactory; 
```

}

也许我们可以进一步优化流，但对我来说这非常快速和容易。

* * *

## 回答 #7

> 赞同：0
> 
> 时间：2009-03-11T13:46:46.417

也许使用[SessionFactory.getClassMetadata](http://www.hibernate.org/hib_docs/v3/api/org/hibernate/SessionFactory.html#getClassMetadata(java.lang.String))？

* * *

## 回答 #8

> 赞同：0
> 
> 时间：2016-01-14T13:44:27.220

您可以使用此函数获取项目中的每个表名称：

```
public Set<String> getTablesName() {
    Set<String> names = new HashSet<>();
    SessionFactory sessionFactory = emf.unwrap(SessionFactory.class);

    Map<String, ClassMetadata> classMetadataMap = sessionFactory.getAllClassMetadata();
    for (ClassMetadata classMetadata : classMetadataMap.values()) {
        AbstractEntityPersister aep = (AbstractEntityPersister) classMetadata;
        String tableName = aep.getTableName();
        if (StringUtils.isBlank(tableName) || StringUtils.containsWhitespace(tableName)) {
            continue;
        }
        names.add(tableName);
    }
    return names;
} 
```

* * *

## 回答 #9

> 赞同：0
> 
> 时间：2020-10-27T05:56:30.100

由于不推荐使用 getClassMetadata 方法。尝试这样的事情。

```
 Configuration configuration = new Configuration();
    configuration.configure();

    StandardServiceRegistry standardRegistry = new StandardServiceRegistryBuilder().configure().build();

    Metadata = new MetadataSources(standardRegistry).getMetadataBuilder().build();
    SessionFactory sessionFactory = configuration.buildSessionFactory();

    String tableName=Metadata.getEntityBinding(entityName).getQualifiedTableName().toString(); 
```

# javascript - 如何撤消最后选中的复选框？

> ID：634348
> 
> 赞同：3
> 
> 时间：2009-03-11T12:43:49.610
> 
> 标签：javascript, checkbox, undo

您好我创建了一个 javascript 函数来检查所选模块的数量是否大于给定值。因此，每次调用复选框时都会调用该函数，并且该函数会遍历所有复选框并计算总数以查看它是否更大。但问题是当用户选中复选框时，如果总积分大于值，我想将复选框设置为选中 = false。但我不知道要撤消哪个复选框。javascript中是否有任何撤消最后点击功能？

* * *

## 回答 #1

> 赞同：8
> 
> 时间：2009-03-11T12:48:46.930

不是真的，但是您可以通过保存最后一个单击的框来轻松地伪造它。此代码可能无法逐字运行，但您明白了：

```
<script>
var last_checked_box;

function onBoxClicked( box ) {
   if ( box.checked ) last_checked_box = box;
}

function undoLastBox() {
   if ( last_checked_box ) last_checked_box.checked = false;
}
</script>

<input type="checkbox" id="box1" onClick="onBoxClicked(this)"/>
... 
```

* * *

## 回答 #2

> 赞同：6
> 
> 时间：2009-03-11T12:49:21.000

使用[jQuery](http://jquery.com/)，您可以执行以下操作：

```
var MAX_CREDITS = 50; // just as an example
$("input[type=checkbox]").change(function (){
  var totalCredits = 0;
  $("input[type=checkbox]").each(function (){
    // augment totalCredits accordingly to each checkbox.
  });

  if(totalCredits > MAX_CREDITS){
    $(this).removeAttr("checked");
  }
}); 
```

如果您以前从未使用过 jQuery，这肯定会让您的眼睛感到痛苦；但正如您所看到的，它非常强大，您的问题可以在几行内解决。我建议您学习并尝试一下；）

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2009-03-11T12:46:38.090

我知道这不是您要寻找的答案，但是当达到最大检查次数时禁用所有未选中的复选框会不会是更好的用户体验？

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2009-03-11T13:49:39.013

这是一个最小但功能齐全且无 jQuery 的解决方案：

```
<script>
function isBox(element) {
    return element.form && element.form === document.forms[0] &&
        element.nodeName.toLowerCase() === 'input' &&
        element.type === 'checkbox';
}

function remaining(dR) {
    var field = document.forms[0].elements[0],
        value = +field.value;

    if(dR) return field.value = value + dR;
    else return value;
}

function listener(event) {
    var box = (event && event.target) ||
        (window.event && window.event.srcElement);

    if(isBox(box)) {
        if(box.checked) {
            if(remaining() > 0)
                remaining(-1);
            else box.checked = false;
        }
        else remaining(+1);
    }
}

if(document.addEventListener)
    document.addEventListener('click', listener, false);
else if(document.attachEvent)
    document.attachEvent('onclick', listener);
</script>
<form>
 <p>remaining: <input type="text" readonly="readonly" value="2"></p>
 <p><input type="checkbox" id="b1"><label for="b1">box1</label></p>
 <p><input type="checkbox" id="b2"><label for="b2">box2</label></p>
 <p><input type="checkbox" id="b3"><label for="b3">box3</label></p>
</form> 
```

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2009-03-11T12:47:39.663

我不认为有，但你总是可以保存对最后一个复选框的引用，所以当你必须取消选中它时，你就在那里。

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2009-03-11T12:54:50.487

我建议测试是否已检查最大对象数，如果为真，则以相同的方法删除所有检查，或者将某个隐藏文本框的值设置为上次选中复选框的 id，以便您可以再次引用它.

# visual-studio-2008 - VS2008.NET：获取引用项目的依赖项以复制到主项目的 bin 文件夹

> ID：634365
> 
> 赞同：6
> 
> 时间：2009-03-11T12:47:01.427
> 
> 标签：visual-studio-2008, dll, user-controls, reference

假设我有一个 C# Winforms 项目 MainGUI。

它引用了同一解决方案中的另一个项目 ControlsLib。

ControlsLib 引用第三方控件套件，例如 Infragistics 或 Telerik 控件，并公开一组在 MainGUI 中使用的用户控件。

在 ControlsLib 中的所有引用上，Copy Local 都设置为 true，并且所有第三方 DLL 都出现在 ControlsLib\bin\release 中。

但是我无法让第三方 DLL 自动复制到 MainGUI\bin\release，这是生成软件安装程序的文件夹（在这种情况下使用 NSIS）

因此，第三方控件 DLL 不会包含在安装中，当使用来自 ControlsLib 的依赖于第三方 DLL 的控件时，这会导致运行时出现 FileNotFoundException。

有没有我不知道的“正确”方法来做到这一点？以前我只是在一个 nant 构建脚本中通过复制文件来处理这个问题，但我正在开始一个新项目，我只是想检查一下。

谢谢

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-03-11T22:54:41.233

我刚刚通过将以下构建后事件命令行添加到 MainGUI 的 .csproj 文件（项目属性 - >构建事件）解决了这个问题

```
copy $(SolutionDir)ControlsLib\bin\$(ConfigurationName)\Infragistics2*.dll $(TargetDir) 
```

没想到做起来这么简单……

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-03-11T12:52:02.787

您需要从 UI 项目 (MainGUI) 添加指向必要文件的链接，并将它们设置为从*那里*复制到输出文件夹。内置的打包工具（IIRC）可以正确地级联这些，但对于外部工具，我希望您需要手动完成。

在我的构建服务器上，我使用一个脚本来调查引用，并在构建之前添加所有后代引用（通过将 csproj 文件编辑为 xml）......代码不是很好，但它可以完成工作。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-03-11T12:56:55.803

我在使用 Gentle.NET (O/R Mapper) 时遇到了类似的问题。其中一个 DLL 拒绝复制。我已经调查了几个小时，但找不到原因。正在复制所有其他文件，但*由于*某种奇怪的原因，该文件被排除在外。Gentle 使用了三个 DLL，Gentle.Common.DLL、Gentle.Framework.DLL 和 Gentle.SQLProvider.DLL。最后一个永远不会被复制。

最后我只是简单地做了一个脚本……</p>

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2012-06-23T04:52:25.787

如果您在“发布”选项卡、“应用程序文件”选项中修改主要项目属性（可执行文件），那么您将能够告诉 VS 包含所有未复制的文件。

# php - SMTP 配置

> ID：634367
> 
> 赞同：0
> 
> 时间：2009-03-11T12:47:29.897
> 
> 标签：php, smtp

我有 Vista Home Premium 操作系统，我正在开发一个发送电子邮件的 PHP Web 应用程序。

我需要配置 SMTP，我已经尝试了几个安装 PHPmailer 的选项。btu 可悲的是它没有发送电子邮件。

我应该继续尝试找出 PHPmailer 还是有更好的方法？如果 PHPmailer 是要走的路，我该如何配置呢？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2009-03-11T12:53:40.053

Vista 中不包含 SMTP 服务器。

[http://weblogs.asp.net/steveschofield/archive/2006/12/19/iis7-post-23-vista-and-smtp-server-where-is-it.aspx](http://weblogs.asp.net/steveschofield/archive/2006/12/19/iis7-post-23-vista-and-smtp-server-where-is-it.aspx)

# php - 命令行指令解析

> ID：634373
> 
> 赞同：5
> 
> 时间：2009-03-11T12:48:54.463
> 
> 标签：php, regex, command-line-interface

我一直在谷歌上，但无法找到可以解析（正确）CLI 参数的正则表达式。

有人在他们的代码库中有这样的东西吗？

理想情况下，它将解析所有样式的参数（即：-v -abc --arg=val --arg="val1 val2" --arg "val"）

谢谢！

PS：这将在 PHP 上下文中使用（preg）

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2009-03-11T12:53:49.367

查看 PEAR 的[Console_Getopt](https://pear.php.net/package/Console_Getopt)或 Zend Framework [Zend_Console_Getopt](http://framework.zend.com/manual/en/zend.console.getopt.html)

您的 PHP 版本可能也支持内置的[getopt 。](http://php.net/getopt)

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2009-03-11T13:08:31.280

[`getopt()`](http://www.php.net/manual/en/function.getopt.php)

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-03-11T13:05:29.323

如果您正在运行 CLI，全局 $argv 已经自动解析命令行参数[。](http://us2.php.net/manual/en/reserved.variables.argv.php)另请参阅：[从命令行使用 PHP](http://docs.php.net/manual/en/features.commandline.php)

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2009-03-17T10:00:51.337

只是想我会让你知道我找到了解决方案。

[http://nlindblad.org/2007/05/12/handling-command-line-arguments-in-php/](http://nlindblad.org/2007/05/12/handling-command-line-arguments-in-php/)

# ruby-on-rails - Rails：Ajax 自动建议插件？

> ID：634393
> 
> 赞同：1
> 
> 时间：2009-03-11T12:54:50.580
> 
> 标签：ruby-on-rails, ajax, plugins, autocomplete

是否有一个 rails（或其他 javascript 框架）插件可以自动建议，如 Stack Overflow 中的相关问题建议，在离开文本字段后会显示相关项目列表？

还有这个 UI 模式的名称吗？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2009-03-11T13:00:50.270

Rails有一个[auto_complete](http://github.com/rails/auto_complete/tree/master)插件，我相信它可以用来实现这种效果。只是防止它填充文本输入，并使用带有链接的更大 div。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-03-11T16:28:50.740

如果你使用 jQuery，你可以使用这个插件： http: [//plugins.jquery.com/project/jq-autocomplete](http://plugins.jquery.com/project/jq-autocomplete)

我以前用过它，它很容易配置。

# coldfusion - 在没有本地 SMTP 服务器的情况下使用 ColdFusion CFMAIL 发送邮件

> ID：634398
> 
> 赞同：1
> 
> 时间：2009-03-11T12:55:24.277
> 
> 标签：coldfusion, smtp, gmail, yahoo

我正在使用共享的 ColdFusion 主机 (Crystaltech)，但我正在使用 Google 域邮件来满足我的电子邮件需求。当我使用 CFMAIL 从该服务器发送邮件时，我尝试使用 Gmail 的 SMTP。但是，它会将我指定的任何地址重写为我用于 SMTP 的 gmail 帐户。

我听说其他人谈论使用雅虎。有人对此有什么好的解决方案吗？

提前致谢。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-03-11T17:43:29.327

经过一番搜索，我的结论是，Chase 说这是设计使然，无法规避，这是正确的。当然，我发现的是从 2005 年开始的，但我后来找不到任何东西说可以做到这一点。下面参考。

[http://www.mobileread.com/forums/showthread.php?threadid=4857](http://www.mobileread.com/forums/showthread.php?threadid=4857)

[http://lifehacker.com/software/email-apps/how-to-use-gmail-as-your-smtp-server-111166.php](http://lifehacker.com/software/email-apps/how-to-use-gmail-as-your-smtp-server-111166.php)

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2010-04-06T05:03:58.683

我理解您的问题的方式是，您希望“发件人”是动态的，基于您为每条消息指定的帐户与您用作发件人邮件服务的主帐户。为了实现这一点，您需要建立您计划在应用程序中使用的任何其他“发件人”帐户作为 Google Mail 中的备用地址。

您将在 Google Mail 的设置 --> 帐户界面中找到建立这些关联帐户的选项。在那里，您可以添加所需的任何其他帐户，向每个帐户发送一封电子邮件以验证您的所有权。验证后，您应该可以通过您的主帐户将这些帐户中的任何一个用作授权发件人。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-03-11T13:40:53.810

假设 CT 提供您没有使用的 SMTP 服务器，我会确保我有一个 SPF 记录，允许 Crystaltech 的 SMTP 服务器为我的域发送邮件，然后只需使用提供的邮件服务器。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2009-03-11T13:25:36.123

这是设计使然。您要做的是继续使用 Gmail，但将[回复](http://www.freesoft.org/CIE/RFC/822/33.htm)字段设置为您希望回复返回的地址。许多电子邮件客户端实际上会在 UI 中将回复值显示为“发件人”。

# c++ - 用 C++ 编写 Mac OS X 应用程序的完整解决方案

> ID：634404
> 
> 赞同：17
> 
> 时间：2009-03-11T12:58:31.523
> 
> 标签：c++, xcode, macos, ide

我正在为我目前的机器寻找替代品，Mac OS X 似乎非常吸引人。

我的主要兴趣领域是 C++ 编程。目前我正在使用 Eclipse + CDT 和 g++ 来创建我的软件；有时它是KDevelop。

我知道 Mac 的主要 IDE 是 Xcode，主要语言是 Objective-C。如果可能的话，我想避免学习 Objective-C。我还听说/读到从 C++ 访问 Mac OS X API 时存在一些问题。

因此我的问题是：为 Mac OS X 开发/调试/测试访问硬件所有方面（UI、声音、视频/加速视频等）的 C++ 应用程序的完整解决方案是什么？

编辑：Xcode 与 Eclipse+CDT 组合相比如何？如果这种比较是可能的......

* * *

## 回答 #1

> 赞同：19
> 
> 时间：2009-03-11T13:20:40.723

如果您想使用 C++ 而不是 Objective-C，并且仍然想避免中间层的库（例如 QT），则可以使用[Carbon](http://developer.apple.com/Carbon/)。

我会使用 XCode 而不是 Eclipse，因为 Eclipse 在处理核心 C/C++ 编程（编译、调试、测试）时速度较慢。

当我第一次开始在 Mac OS X 中编程时，我和你现在处于同一页面。我认为最好坚持使用我知道的语言（C++）并使用较旧的库（Carbon）。出于某种我现在不记得的原因，我强迫自己使用 Cocoa (Objective-C)。回想起来，我认为这是一件好事，因为：

1.  Objective-C 与 C++ 没有根本的不同
2.  Cocoa 比 Carbon 更好、更快、更简单
3.  iPhone Dev 完全是 Cocoa（不支持 Carbon）

* * *

## 回答 #2

> 赞同：9
> 
> 时间：2009-03-11T14:19:32.687

你不应该**避免**学习 Objective-C 和 Cocoa。事实上，它应该是你做的第一件事。除非您在 Smalltalk 方面有扎实的背景，否则您不太可能接触过设计精良的大型（一组）框架。

* * *

## 回答 #3

> 赞同：6
> 
> 时间：2009-03-11T13:11:34.287

Objective-C 并不难。如果您了解 C++，那么您将花费一到三天的时间来学习这些约定。

Cocoa API 和约定需要更长的时间，但这些都是及时的。

祝你好运！

* * *

## 回答 #4

> 赞同：6
> 
> 时间：2009-03-11T14:35:15.630

我一直在尝试使用 Objective-C++ 编写 UI，从而更容易使用 C++ 编写应用程序后端。这对我来说似乎工作得很好。Objective-C 和 Objective-C++ 很容易上手，这让我可以继续使用我来之不易的 C++ 知识。

* * *

## 回答 #5

> 赞同：4
> 
> 时间：2009-03-11T13:06:22.783

除非您正在考虑使用像 QT 这样的中间层，否则我认为您几乎会被 Objective C 卡住来与 API 的某些部分（如 GUI）进行交互，因为它是他们的母语。

也就是说，已经提到您可以轻松地混合使用 Objective-C 代码和 C++ 代码，因此您仍然可以使用 C++ 编写大部分应用程序。

我主要是一名 C++ 程序员，但我总是涉足其他语言，而且我玩过 XCode（是的，我有一台 Mac）。我喜欢它，它有点不同，但作为一种将 OS X GUI 组合在一起的方式，它非常棒，如果你不太喜欢 XCode，剩下的就在你和你最喜欢的编辑器之间。

* * *

## 回答 #6

> 赞同：3
> 
> 时间：2010-07-03T19:38:07.407

C++ 与 Xcode 配合得很好。如果你想要 cocoa，你可以为 gui 层学习最少（我的意思是非常少）的 Obj-C，并在 C++ 中使用大部分代码。

另一种选择是使用其中一个脚本语言框架来连接到 Cocoa API（例如 PyObjc）和 C++ 中的大部分逻辑。

第三个也是最后一个选项是使用跨平台的 gui 工具包，例如 Qt4。如果希望使您的库跨平台，这将是要走的路。

我建议不要使用 Carbon。这绝对是一头垂死的野兽。您还可以使用上述组合，为您的 C++ 代码提供一个库，然后创建链接它们的 gui 特定 UI。

* * *

## 回答 #7

> 赞同：2
> 
> 时间：2009-03-11T13:12:13.410

使用 OS X 中的 gcc 或 g++ 没有问题。XCode 安装无论如何都会为您提供这些编译器，如果您真的需要，您可以加载一个 x 服务器实例并让 KDE 工作。不过我自己喜欢 XCode 编辑器。Eclipse 也适用于 OS X，因此您应该能够使用您当前的环境。

我之前使用过 OS X 机器将 C 代码从 PPC 架构交叉编译到 ARM 架构，没有任何问题。它只是另一个 *nix 风格的系统，所以你熟悉的所有工具都已经存在，如果不存在，只需使用[fink](http://www.finkproject.org/)或[macports](http://www.macports.org/)自己获取它们。

此外，如果你真的想使用 C++ 来开发 GUI OS X 应用程序，你总是可以使用 Carbon 而不是 Cocoa。这是一个完全可行的选择，只是略微被弃用。

* * *

## 回答 #8

> 赞同：2
> 
> 时间：2009-03-11T14:30:34.267

Mac OS X 上的 Carbon 已被有效弃用 - 它不支持也不支持 64 位应用程序。

如果你真的想使用 c++，请使用[Qt Creator](http://labs.trolltech.com/blogs/category/qtcreator/)

现在是免费的，并且 trolltech SDK 包括 Qt 4.5，虽然它是一个 c++ 框架，但它在内部使用 Objective-C 与 MAC OS X 交互，所以你不受 Carbon 的限制。

缺点是 trolltech 库在 mac 上不是标准的，您必须在您的应用程序中提供它们。

* * *

## 回答 #9

> 赞同：1
> 
> 时间：2009-03-11T14:49:09.480

我同意 Pablo Santa Cruz 的观点，并想补充一点，在同一个应用程序（和同一个源文件）中混合 Objective-C 和 C++ 是微不足道的。这被称为 Objective-C++ 并[在本文中](http://developer.apple.com/documentation/Cocoa/Conceptual/ObjectiveC/Articles/ocCPlusPlus.html#//apple_ref/doc/uid/TP30001163-CH10-SW1)讨论。

XCode 使用 GCC 编译，因此您可以随时准备好 Objective C、C 和 C++。

* * *

## 回答 #10

> 赞同：0
> 
> 时间：2009-03-11T13:03:24.883

我自己没有在 OSX 上使用过它（我可以在 Windows 上推荐它），但 Code::Blocks C++ IDE 是使用并支持跨平台 wxWidgets GUI 库实现的。它在 OSX 上受支持 - 请参阅[此页面](http://www.codeblocks.org/)。

* * *

## 回答 #11

> 赞同：0
> 
> 时间：2009-03-11T13:09:33.963

我建议您坚持使用您最熟悉的任何 IDE。就个人而言，我第一次使用 Xcode 时就讨厌它，并拒绝放弃 Eclipse。几天后，我对 Xcode 进行了热身，不介意时不时地使用它。但是，我仍然尽可能使用 Eclipse。

请记住，您不能仅使用 C++ 编写 Cocoa 应用程序，您需要为此深入研究 Obj-C。Carbon 应用程序的外观或行为不像 Cocoa 应用程序。大多数人不会真的介意，但这是值得考虑的事情。我从 java/C# 跳入 Obj-C 没有任何问题。这种语言需要一点时间来适应，但并不难。

* * *

## 回答 #12

> 赞同：0
> 
> 时间：2009-03-11T14:39:35.197

如果您真的想在 Mac OS X 上使用 C++，请使用[SDL](http://www.libsdl.org) / [wxWidgets](http://www.wxwidgets.org) / [Qt](http://qt.nokia.com/)之类的东西。

可以选择将 Objective-C 与 C++ 结合起来，称为[Objective-C++](http://en.wikipedia.org/wiki/Objective-C#Objective-C.2B.2B)。您可以将它用于所有模型材料，而只需将 Objective-C 用于这些材料，如果没有 Foundation 框架，这是不可能的。

作为最后一个选择，我想到了[Carbon 。](http://developer.apple.com/Carbon/)这是一个在前 OSX 时代使用的本机框架，但在 Mac OS X 上运行。问题是，它不支持更新的技术，我认为 OS X 的下一个版本 Snow Leopard 不会支持它根本没有。

苹果 说：

> Carbon 使 C/C++ 开发人员能够利用 Mac OS X 的功能，包括 Quartz 2D 图形库、高效的事件处理机制和多处理支持。此外，Carbon 开发人员还可以使用其他行业标准的 C/C++ API，提供对 OpenGL 绘图系统、Mach 微内核和 BSD 操作系统服务等服务的访问。

不要期望 Carbon 应用程序看起来是 100% 原生的，而且它的编程比 Cocoa 复杂得多。

*不过，我推荐[学习 Objective-C](http://cocoadevcentral.com)，它并不难，而且有很多强大的框架，如 CoreData、CoreGraphics 等。*

* * *

## 回答 #13

> 赞同：0
> 
> 时间：2009-03-12T15:40:31.350

对于一些小的爱好项目，以及我正在制作的 iPhone 应用程序，我混合使用了客观 C++ 和“真正的”C++。XCode 很好地支持两种语言的混合。我使用 Objective C/objective C++ 作为用户界面，并作为 OSX 框架和我自己的代码之间的一个薄层。到目前为止，这已被证明是一种很好的工作方式。

* * *

## 回答 #14

> 赞同：0
> 
> 时间：2010-06-24T09:56:58.473

我现在在 Mac 中用于开发的开发环境是 QTCreator，它是一个免费的 IDE，用于在 QT 中使用 gcc 作为编译器进行开发。它提供了我需要的所有功能，而且它是跨平台的（我正在开发的应用程序的一项要求）。

我不得不说我印象非常深刻。我对这样一个专注（专为 QT 设计）和最近的 IDE 并没有寄予厚望。该环境简单但功能强大（包括 GUI 编辑），并且具有我见过的更好的代码完成。在这种环境下编程是一件轻而易举的事，不要错过一点 Visual Studio。

真的值得一试。

# html - 为什么创建页面时这些 Div 没有出现？为什么它们会出现在调整大小上？

> ID：634405
> 
> 赞同：1
> 
> 时间：2009-03-11T12:58:52.427
> 
> 标签：html, css, internet-explorer

我希望对一些 UI 代码进行刷新，并认为我会看看有关 Web 主要资源之一的想法：[A List Apart](http://www.alistapart.com)。我发现[这篇文章](http://www.alistapart.com/articles/conflictingabsolutepositions)是关于使用固定位置创建具有固定标题、左面板和主面板的布局。我在 MasterPage 中实现了这个想法，但现在得到了非常奇怪的结果：当页面呈现时，标题和主 div 根本不会出现在 IE 7 中。当我将大小调整到最小程度时，一切都会正确弹出。FireFox 没有这样的问题。

这是 CSS（我将每个条目放在一行以节省垂直空间）：

```
html { overflow: hidden; }
body { overflow: hidden; padding: 0; margin: 0; width: 100%; height: 100%; font: 0.8em Verdana, sans-serif; line-height: 1.25; color: #333; background-color: White; }
#coachheader { padding: 0; margin: 0; position: absolute; top: 0px; left: 0px; width: 100%; height: 96px; overflow: hidden; }
#side { padding: 0; margin: 0; position: absolute; top: 100px; left: 20px; bottom: 20px; overflow: auto; width: 200px; }
#main {padding: 0; margin: 0; position: absolute; top: 100px; left: 240px; right: 20px; bottom: 20px; overflow: auto; }
a.SM { color:#666666; text-decoration:none; padding-left: 10px; padding-right:10px; margin-left:2px; margin-right:2px; vertical-align:middle; }
img.SM { height: 20px; vertical-align:middle; } 
```

这是HTML：

```
<%@ Master Language="C#" AutoEventWireup="true" CodeFile="Coach.master.cs" Inherits="FitnessCompanion.Coach" %>
<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml" >
<head id="Head1" runat="server">
    <title>My Title</title>
    <link rel="stylesheet" href="../../stylesheetforstaff.css" type="text/css" />
    <!--[if lt IE 7]>
    <style type="text/css">
        #side { height:expression(document.body.clientHeight-120); }
        #main { height:expression(document.body.clientHeight-120); width:expression(document.body.clientWidth-260); }
    </style>
    <![endif]-->
</head>
<body runat="server" id="body1">
    <form id="form1" runat="server">
    <asp:ScriptManager ID="ScriptManager1" runat="server" />
    <div id="coachheader">  <!-- This div does NOT show up initially -->
        <div style="text-align:left; float:left; margin-left:6px;">
            <img src="/images/BSDILogoWeb.png" alt="BSDI" />
        </div>
        <!-- The Menu -->
        <div style="float:right; margin-right:6px;">
           <a menu table...>
        </div>
    </div>
    <div id="side">
        <menu output for the side - this div shows up!>
    </div>
    <div id="main">
        <!-- Main Page - this Div does not show up. Contents: just a table -->
        <div>
        <asp:contentplaceholder id="ContentBody" runat="server">
        </asp:contentplaceholder>
        </div>
    </div>
    </form>
</body>
</html> 
```

正如你所看到的，这是对这些想法的一个非常简单的应用。我已经玩了几个小时了。我已将溢出设置从自动更改为隐藏等，所以我认为不是这样。奇怪的是，这种方法的一个变体只有一个标题和主要区域在网站的另一部分工作正常，但*即使在我基本上消除了所有内容之后，这个变体也不能在这个页面上工作！* 该站点的这一部分位于子目录中，但这*无关紧要*。

任何帮助，将不胜感激！再一次，我觉得我在 1 毫米之外：它在 Firefox 中运行良好，一旦我在任何方向调整窗口大小，无论多么轻微，它看起来都很好。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-03-11T13:19:21.007

试着把这个：

```
<!--[if lt IE 7]>
    <style type="text/css">
        #side { height:expression(document.body.clientHeight-120); }
        #main { height:expression(document.body.clientHeight-120); width:expression(document.body.clientWidth-260); }
    </style>
<![endif]--> 
```

在 </body> 标签之前的底部。

我不确定这会起作用，但我认为表达式是内联计算的，而 document.body 还不存在。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-03-11T13:39:07.963

是的，IE 有时确实存在元素消失的问题。

但是，当我在 IE7 中尝试您的代码时，元素显示得很好，但这可能是因为我给了它们背景颜色。

有一些技巧可以让 IE 中的页面更稳定，例如添加`position:relative;`将元素变为图层、添加`display:inline;`浮动元素、为元素添加背景或在元素上指定固定大小。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-03-11T13:59:16.417

感谢 John 和 Guffa 提供的帮助。我一直在玩代码，发现它显然是 IE 计算大小的能力的一个缺陷。如果我将 IE 条件代码更改为包含 IE 7，以便在 Javascript 中计算大小，则该页面现在一直有效。原始文章说 IE 7 中修复了大小缺陷，但显然，在某些版本（我在 7.0.5730.11）中，浏览器仍然无法处理这个基本的 CSS。

这是页面的更新部分：

```
<!--[if lt IE 8]>
<style type="text/css">
    #side { height:expression(document.body.clientHeight-120); }
    #main { height:expression(document.body.clientHeight-120); width:expression(document.body.clientWidth-260); }
</style>
<![endif]--> 
```

注意 if 测试中的“8”而不是 7。

# c# - 连接每个非空参数及其值

> ID：634416
> 
> 赞同：-1
> 
> 时间：2009-03-11T13:03:24.507
> 
> 标签：c#, .net, reflection

我有一个方法可以在单独的参数中接受一堆字符串

```
public string GetQueryString(string string1, string string2, string string3...) 
```

它应该以以下形式返回一个字符串

```
"string1:value1 string2:value2 string3:value3..." 
```

因为我不想将反射逻辑放在 的调用者中`GetQueryString`，所以我认为使用`string[,]`参数不是一种选择。

我现在需要的是一种遍历所有参数并将“ `parName:parValue`”添加到我的 S的方法`tringBuilder`。
目前我通过用一个`if`子句检查它们中的每一个来做到这一点

```
if (!string.IsNullOrEmpty(string1))
    sb.AppendFormat("{0}:{1}", "string1", string1); 
```

如何改进？

--澄清--
我相信 OP 想要做的是这样的：

```
string str1 = "Hello";
string s2 = "World";
string MyStr = "Greetings";
string YourStr = "Earthlings";
string query = GetQueryString(str1, s2, MyStr, YourStr); 
```

并让它返回 `"str1:Hello s2:World MyStr:Greetings YourStr:Earthlings"`

--EDIT--
澄清是正确的。
此外，因为我的方法称为 GetQueryString 并不意味着我正在处理 HTML 查询字符串。在这种特殊情况下，它实际上是一个 Lucene 查询字符串。但它可以是任何可以将字符串解析为查询的搜索函数。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-03-11T13:49:29.890

问题是，一旦你编译它，变量名就会消失。反思甚至不会帮助你。

我能想到的唯一可行的方法是使用表达式树（.NET v3.5+）

```
 string GetQueryString(Expression<Func<String, string>> exprTree )
 { 
     // walk expreTree.  
     // exprTree.Body.Left.Name would be the name of the variable
     // exprTree.Body.Left.Value would be it value.
 }

 string q = GetQueryString((str1, s2, MyS, YourS) => str1 + s2 + MyS + YourS); 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-03-11T13:08:01.797

为什么 params 需要反射？我认为解决此问题的一种方法是使用 params 关键字并使用字典作为名称和值。

或者按照你的方式去做。如果您使用参数，您可以提供一些采用两个或三个参数的重载，以避免构建数组。这是一个很小的优化 string.format() 。

# 编辑

另一种选择是创建一个表示可能参数的对象，然后对其进行序列化。然后，您可以使用反射来遍历您自己的字段，在这种情况下，您可以创建一个基类并隔离允许不同表示的算法。

```
public abstract class QueryParams
{
    public string GetQueryString()
    {
        //use reflection here 
    }
}

public class MyQueryParams : QueryParams
{
    public QueryParam MyParam1
    {
        get
        {
            if (_myParam1 == null)
            { 
                _myParam1 = new QueryParam("MyParam1");
            }
            return _myParam1;
        }
    }
}

public class QueryParam 
{
    public string Name;
    public string Value;
} 
```

# 编辑

修改了上面的代码示例以包含 QueryParam，它让您的类拥有查询参数的名称。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-03-11T13:06:52.190

我会为此使用 JSON，它很简单，而且有很多框架。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2009-03-11T13:11:36.580

即使您不太喜欢它，这看起来也像是数组的典型使用场景。如果您绝对必须将 GetQueryString 保留为显式字符串成员，则可以转发到另一种方法，例如：

```
public string GetQueryString(string string1, string string2, string string3...)
{
    return GetQueryStringImpl(string1, string2, string3, ...);
}

public string GetQueryStringImpl(params string[] strings)
{
     foreach (string s in strings)
     {
          // check s for null and append to query string
     }
} 
```

但是，我会质疑在使用这种解决方案之前首先需要这些显式参数的原因。

**更新**：

我刚刚重新阅读并注意到你也想要这些名字。只要值是字符串，这样的东西就可以工作：

```
public string GetQueryString(string string1, string string2, string string3...)
{
    return GetQueryStringImpl("name1", string1, "name2", string2, "name3", string3, ...);
}

public string GetQueryStringImpl(params string[] strings)
{
     for (int i=0; i<strings.Length; i+=2)
     {
          var name = strings[i];
          var s = strings[i+1];
          // check s for null and append to query string
     }
} 
```

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2009-03-11T13:13:10.990

这应该给你你想要的，没有使用反射：

```
public string GetQueryString(params string[] inStrings)
{
    StringBuilder sb = new StringBuilder();
    int iCount = 1;
    foreach (String s in inStrings)
    {
        if (iCount > 1)
            sb.Append(" ");        
        sb.AppendFormat("{0}{1}:{1}", "string", iCount, s);
        iCount++;
    }
    return sb.ToString();
} 
```

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2009-03-11T13:15:16.773

查看`QueryStringHelper`此博客文章中的课程：

[http://bloggingabout.net/blogs/stephan/archive/2008/12/01/passing-query-string-parameters-to-a-silverlight-app-hosted-in-html.aspx](http://bloggingabout.net/blogs/stephan/archive/2008/12/01/passing-query-string-parameters-to-a-silverlight-app-hosted-in-html.aspx)

它使用正则表达式解析出查询字符串中的字符串-值对，并将它们放入`IDictionary<string, string>`. 然后，您可以遍历它并将键值对添加到您的`StringBuilder`如果值不为空。

* * *

## 回答 #7

> 赞同：0
> 
> 时间：2009-03-11T13:23:39.997

```
public string GetQueryString(params string[] paramName)
{
    var result = from p in paramName
                 where !String.IsNullOrEmpty(p)
                 select p + ":" + Request.QueryString[p];
    return String.Join(" ", result.ToArray());
} 
```

电话可能在哪里：

```
Response.Write(GetQueryString("param1", "param2", "param4")); 
```

* * *

## 回答 #8

> 赞同：0
> 
> 时间：2009-03-11T13:58:22.130

如果 OP 正在寻找传递给他的方法的实际参数的名称，那么这很简单：它无法完成。实际参数的名称不会保存在任何地方。

如果参数是表达式，你想显示什么？

* * *

好吧，“表情”这个词引发了回忆。您可以通过使用 LINQ 中的表达式树来做一些事情。请参阅[Charlie Calvert 的社区博客：表达式树基础知识](http://blogs.msdn.com/charlie/archive/2008/01/31/expression-tree-basics.aspx)和[表达式树](http://msdn.microsoft.com/en-us/library/bb397951.aspx)。

# sql - SQL Reporting Services：网格视图

> ID：634428
> 
> 赞同：1
> 
> 时间：2009-03-11T13:05:58.090
> 
> 标签：sql, reporting-services

嗨，我设计了一个返回一组数据的查询，例如：

```
============================================
    |  Name  |  Phone  |  Address  |
--------------------------------------------
     Bob       -         5 Street
     Mary      -         3 Drive 
```

我想要在 SQL Reporting Services 中做的是以网格方式显示数据。如

```
Item 1   Item 2   Item 3   Item 4
Item 5   Item 6   Item 7   Item 8
Item 9   Item 10  Item 11  Item 12 
```

对于我提供的数据集。我希望它在需要时自动分页等。有什么内置的东西可以使用吗？非常感谢有关如何执行此操作的任何建议！谢谢。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-03-24T11:29:53.513

认为您在追求“水平桌子”

[链接文本](http://blogs.msdn.com/chrishays/archive/2004/07/23/HorizontalTables.aspx)

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-03-11T13:10:20.590

一旦页面已满，Reporting Services 将自动分页。

在显示这样的数据方面，我不确定。

# python - 在使用 pyparsing 制作递归解析器时需要帮助

> ID：634432
> 
> 赞同：3
> 
> 时间：2009-03-11T13:07:53.793
> 
> 标签：python, recursion, parsing, pyparsing

我正在尝试使用 python pyparsing 进行解析。我在制作递归解析器时遇到了困难。

让我解释一下问题

我想制作元素的笛卡尔积。语法是

```
cross({elements },{element}) 
```

我以更具体的方式

```
cross({a},{c1}) or cross({a,b},{c1}) or cross({a,b,c,d},{c1}) or 
```

所以一般形式是第一组将有n个元素（a，b，c，d）。第二组将有一个元素，因此最终输出将是笛卡尔积。

语法是递归的，因为它可以像

```
cross(cross({a,b},{c1}),{c2}) 
```

这意味着将 a、b 与 c1 交叉。让我们说结果我们y。我们再次将它与 c2 交叉

这可以直到 n 级 cross(cross(cross(cross......

我想要的是使用 setparseAction 初始化对象

所以我会有2节课

```
class object1(object):
     This will be used by a,b,c,d 

class object2(object):
       This will hold cross elements 
```

我需要帮助，我无法制作递归解析器。

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2009-03-11T13:14:33.687

您应该查看其他语言的定义，以了解通常如何处理。

例如，看看乘法是如何定义的。

它不是

```
{expression} * {expression} 
```

因为递归很难处理，并且没有隐含的从左到右的顺序。你更经常看到的是类似的东西

```
{term} + {factor}
{factor} * {unary-expression} 
```

这将优先级和从左到右的顺序放在运算符周围。

查看[http://www.cs.man.ac.uk/~pjj/bnf/c_syntax.bnf](http://www.cs.man.ac.uk/~pjj/bnf/c_syntax.bnf)之类的内容，以了解此类事物的常见结构示例。

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2009-03-11T14:24:58.477

我同意@S.Lott 你应该重新考虑你的语法。

可以使用以下方法引入递归定义`Forward()`：

```
from pyparsing import (Literal, Word, OneOrMore, Forward, nums, alphas)

def BNF():
    """
    element      :: id
    elements     :: '{' element [ ',' element ]+ '}' 
                  | 'cross' '(' elements ',' '{' element '}' ')'
    """
    lcb, rcb, lb, rb, comma = [Literal(c).suppress() for c in '{}(),']
    element  = Word(alphas, alphas+nums+"_") # id
    elements = Forward()
    elements << ((lcb + element + OneOrMore(comma + element) + rcb) 
                 | (Literal('cross') + lb + elements + comma
                    + lcb + element + rcb + rb))
    return elements

print BNF().parseString("cross(cross({a,b},{c1}),{c2})") 
```

输出：

```
['cross', 'cross', 'a', 'b', 'c1', 'c2'] 
```

* * *

## 回答 #3

> 赞同：3
> 
> 时间：2009-11-04T12:08:47.280

我不知道这是否有帮助，但这里是你在 lepl 中做你想做的事情的方法。由于语法似乎是正确的，我认为它很容易翻译成 pyparsing。

```
from lepl import *

def compile_parser():

    class Cross(Node): pass

    word = Token('[a-z0-9]+')
    par, en, bra, ket = [~Token('\\'+c) for c in '(){}']
    comma = ~Token(',')

    cross  = Delayed()
    vector = bra & word[1:,comma] & ket                 > list
    arg    = vector | cross
    cross += ~word('cross') & par & arg[2,comma] & en   > Cross

    parser = cross.string_parser()
    return lambda expr: parser(expr)[0]

if __name__ == '__main__':

    parser = compile_parser()
    print parser('cross({a},{c1})')
    print parser('cross({a,b},{c1})')
    print parser('cross({a,b,c,d},{c1})')
    print parser('cross(cross({a,b},{c1}),{c2})') 
```

输出是：

```
Cross
 +- [u'a']
 `- [u'c1']

Cross
 +- [u'a', u'b']
 `- [u'c1']

Cross
 +- [u'a', u'b', u'c', u'd']
 `- [u'c1']

Cross
 +- Cross
 |   +- [u'a', u'b']
 |   `- [u'c1']
 `- [u'c2'] 
```

# wpf - 为 WPF 中的所有元素事件添加侦听器

> ID：634434
> 
> 赞同：7
> 
> 时间：2009-03-11T13:08:17.867
> 
> 标签：wpf, events, hook, event-listener

我想在一次调用中挂钩所有可用的元素事件。像这样的一些事情：

```
elem.AddHandler(AnyRoutedEvent, (RoutedEventHandler)handler) 
```

我怎样才能做到这一点？

* * *

## 回答 #1

> 赞同：10
> 
> 时间：2009-03-11T13:20:47.617

试试这个来获取 Button 类型的所有事件......您可以替换不同的类型。

```
RoutedEvent[] events = EventManager.GetRoutedEventsForOwner(typeof(Button));

foreach (RoutedEvent e in events)
   elem.AddHandler(e, handler); 
```

您还可以替换以下内容以获取所有类型的所有路由事件，但这将是一个相当多的列表！

```
RoutedEvent[] events = EventManager.GetRoutedEvents(); 
```

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2009-03-11T13:28:55.523

您可以使用 EventManager 的 RegisterClassHandler 方法一次静态监听所有元素 :)

```
EventManager.RegisterClassHandler(typeof(your class), Button.ClickEvent, new RoutedEventHandler(OnButtonClick));

static void OnButtonClick(object sender, RoutedEventArgs e)
{
    //Do awesome stuff with the button click
} 
```

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2017-09-18T16:06:41.903

我的灵感来自： http: [//geekswithblogs.net/tkokke/archive/2009/07/17/monitoring-routed-events-in-wpf.aspx](http://geekswithblogs.net/tkokke/archive/2009/07/17/monitoring-routed-events-in-wpf.aspx)

```
 /// <summary>
    /// This is used for debugging, when your looking for a specific event
    /// </summary>
    public static void RegisterAllEvents(Type type, FrameworkElement target)
    {
        var events = EventManager.GetRoutedEvents();
        foreach (var routedEvent in events)
        {
            EventManager.RegisterClassHandler(type,
                                routedEvent, new RoutedEventHandler((sender, args) =>
                {
                    if ( sender != target)
                        return;
                    System.Diagnostics.Debug.WriteLine(args.OriginalSource + "=>" + args.RoutedEvent);
                }));
        }
    } 
```

# visual-studio-2008 - 如果 DLL 的 app.config 应该在“主配置”中……我们如何处理 DLL 中的 WCF 引用？

> ID：634439
> 
> 赞同：13
> 
> 时间：2009-03-11T13:08:51.047
> 
> 标签：visual-studio-2008, wcf, .net-3.5, app-config

好的，这很简单，但据我所知……您只能使用某种 Windows 工作流将另一个配置包含到另一个配置中（我拒绝这样做）。

这是交易：

MAINAPP.EXE 引用一个假设的 LIBRARY.DLL。

MAINAPP.EXE 有自己的 MAINAPP.EXE.config。

如果将“配置值”添加到 LIBRARY.DLL（从而在 LIBRARY.DLL 项目中创建 app.config），*即使将 app.config 复制到 LIBRARY.DLL.config 到正确的路径后*，这些值在运行时*也不可用**-构建*。

上述原因是即使引用的库也会从“mainapp.exe”配置中读取。

到现在为止还挺好”。现在，当您添加 WCF 服务引用时，Visual Studio 会使用绑定/端点/等创建或填充您的 app.config；但这已添加到您添加参考配置的项目中；因此，您的 Library.DLL.prj 最终会得到一个不错的 app.config，*它无法正常工作*，因为它永远不会被读取，甚至不会被复制到输出目录。现在您可能认为您可以右键单击该 app.config 并将“始终复制”设置为 true。忘了它。那没有任何作用。（你可以用谷歌搜索那个）。

那么，考虑到上述奇怪的场景，一个使用 .NET 3.5 项目的普通 VS2008 开发人员如何管理他添加到业务层 dll 中的 WCF 服务引用？*每次服务发生变化或每次添加/删除服务时，该开发人员是否应该将其 DLL 中**无用*的 app.config 中的所有部分复制并粘贴到 Mainapp.exe.config 文件中？

 ** * *

## 回答 #1

> 赞同：8
> 
> 时间：2009-03-11T13:13:05.373

是的。复制粘贴就是答案。这不是一个很好的答案，但它就是答案，而且从 .NET 1.0 的第一天开始，它就已经有了 AppSettings。

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2009-05-26T05:42:39.593

您可以让一个库项目包含自定义配置文件，并且这些文件可以复制到另一个应用程序的可执行位置（这有点棘手，但没什么大不了的）。您只需使用 OpenMappedExeConfiguration 即可获取这些文件中的任何信息。然后，当您实例化 WCF 代理（实例化一个 Binding 并将其传递给代理）时，您必须进行一些自定义编码。我在这里聚会迟到了，但如果你有兴趣，我可以提供更多细节。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-03-11T13:12:41.973

不，你是对的。

*但*可以肯定的是，您的 WCF 服务不在业务层项目中，而是在一个单独的项目中，该项目充当业务层的外观。然后，您的业务层只是另一个程序集，它应该是并且不关心它是如何访问的，WCF 项目为它做这件事。

或者当然，您编写自定义服务主机并将最少量的信息放入配置文件（主机名、证书指纹），然后在代码中完成其余的工作。

# java - 从 Maven 启动的 Jetty 实例中创建进程

> ID：634448
> 
> 赞同：1
> 
> 时间：2009-03-11T13:11:36.000
> 
> 标签：java, spring, jetty, maven-2

我希望从在 Jetty 容器中运行的 Spring 控制 bean 的实例中启动一个单独的 Java 进程。Jetty 实例是从`mvn jetty:run`

这个单独的进程通过 RMI 与启动进程进行通信，我希望能够维护进程 ID 或 Process 对象的挂钩，以便以后可以在需要时将其终止。

我们当前启动此过程的方式是维护第二个 jar 依赖项列表作为启动 bean 的 Spring 控制器属性。这不是一个长期的解决方案，因为它迫使我们两次更改 Jars 的版本（一次在 中`pom.xml`，一次在 中`applicationContext.xml`）。然后使用这个列表来建立一个类路径和调用`Runtime.exec`来创建进程。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-03-11T13:33:09.477

使用[ProcessBuilder](http://java.sun.com/j2se/1.5.0/docs/api/java/lang/ProcessBuilder.html)。

# algorithm - 将组分成几乎相等的堆栈

> ID：634450
> 
> 赞同：4
> 
> 时间：2009-03-11T13:12:07.763
> 
> 标签：algorithm, language-agnostic, sorting

我有一个文档列表，我想在网页上按其名称的第一个字母分组显示它们，分三列。

简而言之，是这样的：

```
A | C | E
A | D | F
B | D | F
B | D | F
  | D | 
```

与 Windows 资源管理器视图样式的一个重要区别是我希望字母彼此保持一致。没有打破中组。为了适应这一点，我不在乎一列是否有几个条目太高。

我首先按名称对文档数组进行排序并将它们拆分为嵌套数组。所以我知道（或者很容易找到）：

*   有多少个独特的字母
*   每组有多少个字母
*   总共有多少条目
*   每列中应该有多少个值的平均平均值（理想但不是必须）

我不在乎你的答案是什么。我正在寻找算法而不是实现，这样你就可以编写任何你喜欢的代码（也许 Fortran 除外）。HTML 中的解释也可能很棘手。

我邀请某人在标签上疯狂，因为我想不出任何相关的东西，不，这不是家庭作业，所以请不要这样标记。

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2009-03-11T13:25:56.857

如果您这样看待问题，也许会有所帮助：

对于您的示例，您有一个这样的字符串：

```
AA BB C DDDD E FFF 
```

空间位置是您可以开始新列的位置。在其他任何地方，您都不能在同一列中保留相同的字母。所以你实际上可以像这样标记空间位置：

```
AA1BB2C3DDDD4E5FFF 
```

现在您有 5 个位置可以打破列或不打破列，因为这是一个二元决定，为此使用 0 和 1 的字符串，并暴力破解所有可能的组合：

```
12345

00000 -> no break at all, column count = 1, max. lines = 13
...
01010 -> your example, column count = 3, max. lines = 5
...
11111 -> breaks everywhere, column count = 6, max. lines = 4 
```

这是一种蛮力尝试，但您可以很容易地看到 1 的计数会影响列数（列数 = 1 的数量 + 1），并且您希望最小化最大值。行，这应该可以以某种方式计算而无需测试每个组合。

EDIT2：没有认识到你想要 3 列，这让你更容易知道你只有 3 个 1，但它仍然是蛮力。

编辑：我喜欢的另一种方法：

像这样写字母计数：

```
A B C D E F
2 2 1 4 1 3 
```

您现在可以连接彼此相邻的字母。总是选择计数和最小的两个字母：

```
2 2 1 4 1 3 - lowest = "2 1"
2  3  4 1 3 - lowest = "1 3"
2  3  4  4  - lowest = "2 3"
  5   4  4  - stop now, as we have 3 columns now

Result: AABBC, DDDD, EFFF 
```

这可能不会导致最佳解决方案，但我认为这是解决问题的好方法。

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2009-03-11T13:21:46.803

好吧，您可以期望在每列中总是有一些额外的行。我的意思是，如果你有 2 个 A、2 个 B 和 33 个 C，那么与其他列相比，第三列会相当高。

这不是背包问题，因为它们必须有序。

你可以做的是：

*   计算物品的数量。
*   看看前三分之一会落在哪里。
*   如果它恰好是一个字母更改点，那么你很幸运:)
*   如果不是，则最小化第三部分拆分点与上一个/下一个字母更改点之间的距离 - 即，如果有一个字母更改之前有 2 个条目，之后有 10 个条目，则选择前一个。
*   最后，取其余部分，除以 2，然后按照相同的逻辑从平均值中尽可能地拆分。

* * *

## 回答 #3

> 赞同：3
> 
> 时间：2009-03-11T13:30:05.317

除非输入也是有界的，否则鉴于您的约束，这个问题没有通用的解决方案。例如，考虑一个集合，其中包含一个以字母 A、B、C、E 和 F 开头的文档以及 15 个（或一百万个）以 D 开头的文档。为了将所有 D 分组在一列中，列长度必须至少为 15。如果您使用多于两列，则最多第 1 列的长度为 3，第 2 列的长度为 15（或一百万），第 3 列的长度为 2。这违反了您的“在几个条目内”约束。

您需要确定关于让列不中断字母的约束是否足够重要以保证列大小之间的潜在巨大差异，或者是否输入受到约束，使得问题可以通过给定的约束来解决。就个人而言，我会重新考虑界面作为解决优化问题只是为了让字母保持在一起似乎有点矫枉过正。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2009-03-11T13:30:23.227

我认为你应该从定义一种“度量”开始，它会告诉你哪个布局是最好的，例如，对所有列取 (average_size - actual_size(column))^2 的总和。然后，因为你总是有 3 列（对吗？），它应该相当快地进行所有可能的划分并找到最大化你的度量的那一个。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2009-03-11T13:36:15.833

首先，对文档进行传递以构建一个 letter->count 元组数组。

第一个条目是（数组中的第一个字母）-> 文档 0

然后通过遍历数组找到应该出现在第二列和第三列中的条目，添加计数，但在您通过第二列和第三列的阈值之前停止（这是 1/3 和 2/3总数）。

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2009-03-11T13:41:58.643

这个问题适用于递归解决方案——可能是经典的动态编程，尽管我还没有完全解决。

您有固定数量的潜在分割点，以及一定数量的分割。你应该能够拥有类似的东西

```
(splits, max_ht, min_ht) = split_list(list, requested_splits, 
                                      curr_max, curr_min) 
```

该函数应遍历潜在的拆分点并在列表的其余部分上递归调用自身（请求较少的拆分）。例如，

```
def split_list(list, requested_splits, curr_max, curr_min):
    best_splits = []
    best_split_len = curr_max-curr_min
    best_max = curr_max
    best_min = curr_min

    if requested_splits == 0:
        return (best_splits, curr_max, curr_min)
    for candidate in candidate_split_points:
        this_max = max(curr_max, len(<list up to split point>)
        this_min = min(curr_min, len(<list up to split point>)
        (splits, new_max, new_min) = split_list(<list after split point>,
                                                requested_splits-1,
                                                this_max, this_min)
        if (new_max-new_min) < best_split_len:
            best_split_len = new_max - new_min
            best_max = new_max
            best_min = new_min
            best_splits = [candidate] + splits
    return (best_splits, best_max, best_min) 
```

* * *

## 回答 #7

> 赞同：0
> 
> 时间：2009-03-11T13:49:20.933

这是你可以尝试的东西。由于您知道理想的列号 (n)，因此将所有元素放在第一列中以开始。

尽可能频繁地重复接下来的步骤……它是一种迭代算法，因此在最初的几次迭代中结果会变得更好，然后你的回报开始减少。

依次遍历列。

设当前列中的项目数为 numCurrent。

如果 numCurrent < n，则跳过此列。

跟踪以当前列的第一个字母 (groupFirst) 和最后一个字母 (groupLast) 开头的元素。

计算上一列（如果有）的项目数为 numPrev。如果 abs(n-numCurrent) > abs(n-numPrev+groupFirst)，则将 groupFirst 移至上一列。

重新计算 numCurrent。

和以前一样，如果有下一列，如果 abs(n-numCurrent) > abs(n-numNext+groupLast)，则将 groupLast 移入其中。

冲洗并重复。冲洗次数越多，它看起来应该越整洁。会有一个点不再可能发生变化，也有一个点可以继续进行。您决定迭代次数。

# inversion-of-control - 这在 Prism/Unity 中意味着什么：Container.Resolve ()

> ID：634459
> 
> 赞同：18
> 
> 时间：2009-03-11T13:13:21.253
> 
> 标签：inversion-of-control, unity-container, prism, containers

（来自Prism V2 StockTrader 示例应用程序中的[StockTraderRIBootstrapper.cs文件）](http://msdn.microsoft.com/en-us/library/dd490820.aspx)

这有什么区别：

```
ShellPresenter presenter = new ShellPresenter(); 
```

还有这个：

```
ShellPresenter presenter = Container.Resolve<ShellPresenter>(); 
```

*   我知道第二个示例是将容器视为工厂，走到它面前说“我需要一个 ShellPresenter 类型的实例化对象”。
*   但是，如果，例如我需要发送参数，什么是“new ShellPresenter(1, true)”等的等价物呢？
*   而且由于容器必须被告知 ShellPresenter，我希望在项目中的某个地方找到 ShellPresenter 类向容器注册的地方，例如，我期待

像这样的东西：

```
Container.RegisterType<IShellPresenter, ShellPresenter>(); 
```

但无处可寻。那么容器如何知道这些类型以便它能够解决它们呢？**我在自己的项目中重建了它并得到“依赖项的解决失败”错误**，那么我需要在哪里注册这个依赖项？

这里的任何方向/讨论都会有所帮助。

## 无法解释的答案：

因此，在引导程序中，当我注册 Shell 本身时：

```
protected override void ConfigureContainer()
{
    Container.RegisterType<IShellView, Shell>();
    base.ConfigureContainer();
} 
```

那么 Container 可以解析 ShellPresenter 类型。那么我注册**Shell类型的时候，** **ShellPresenter**类型是怎么注册的呢？

 **## 令人惊讶的答案：

好的，事实证明，您不必注册您尝试解析的类型，但**您必须注册传递给您尝试解析的类型的构造函数的参数（接口）类型**，即因为我注入IShellView 接口到我的 ShellPresenter 的构造函数中，我需要注册 IShellView 类型而不是 IShellPresenter 类型：

```
public ShellPresenter(IShellView view) ... 
```

我通过尝试解析类型**Tester**对此进行了测试：

```
Tester tester = Container.Resolve<Tester>(); 
```

只要我将**SomeClass**注入它的构造函数：

```
public Tester(ISomeClass someClass) 
```

在向容器注册**SomeClass**之前，我得到未解决的依赖错误：

```
Container.RegisterType<ISomeClass, SomeClass>(); 
```

然后它工作。这既令人惊讶，又具有教育意义。需要沉下心来。我要去喝杯咖啡，想一想。

**如果有人能详细说明为什么会这样，将不胜感激。**

* * *

## 回答 #1

> 赞同：12
> 
> 时间：2009-04-21T03:04:04.243

如果您尝试解析具体类并且没有注册实例或子类来满足它，那么 Unity 将为您构造具体类的实例，解决它所具有的任何依赖关系。

因此，当您请求 ShellPresenter 并且尚未注册时，Unity 会为您新建一个 ShellPresenter，并以 ShellView 作为参数。

* * *

## 回答 #2

> 赞同：6
> 
> 时间：2009-03-11T13:26:45.387

你了解基本情况。

有用于解析需要构造函数参数的类型的重载。或者，您始终可以将您的类型编码为具有无参数构造函数。

DI 容器的意义在于，您可以配置它们以更改为特定接口解析的类型，而无需重新编译您的软件。您提供的用于配置提供程序的代码示例不能在运行时更改。这就是为什么大多数依赖注入器允许您在 app.config/web.config/其他一些外部配置文件中配置它们。这样您就可以重新配置您的应用程序以注入不同的类型而无需重新编译，这是 Unity 等 DI 框架的真正强大之处。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2009-03-11T13:25:05.237

好吧，我无法回答 Untiy，但对于 Castle Windsor，注册可以在 app.config/web.config 文件中。还可以在配置 xml 中添加参数。

这允许您更改对象的实现和配置，而无需重新编译您的应用程序。

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2009-03-11T14:07:02.060

在 Unity 中，确实有一个`Container.RegisterType<TFrom, TTo>()`方法集可以在运行时注册类型。使用 XML 配置文件可能更常见，但两者都可以。

有趣的是，在 Unity 中没有`Container.Resolve<T>(params object[] parameters)`-type 方法来解析具有特定构造函数参数值的类型。Unity 建立在 ObjectBuilder 之上，ObjectBuilder 是 P&P 团队用于进行对象构造和连接的库（IIRC，它最初是为 ObjectSpaces 编写的，但现在已得到显着增强）。ObjectBuilder 使您能够以各种方式注入依赖项，包括通过构造函数，因此您可以说 - 例如 - 您可以将它所依赖的类型的新实例传递给已解析类型的构造函数；但该类型也必须注册。您还可以传递注册类型的实例（注册实例/单例等）。但是 AFAICS 没有办法简单地给它一个传递的值。

我认为这样做在某种程度上违背了 IoC 的理念，这就是他们不提供这种设施的原因。理论上，容器应该能够在任何给定情况下为您提供完整的对象图，因此您永远不必传入参数，并使您的对象依赖于构造函数参数而不是可注入对象依赖项（容器将解析为你）被视为糟糕的设计。

我不能代表 Windsor、StructureMap 或其他人，这可能会让你这样做。我什至不能直截了当地说 Unity 没有办法做到这一点，因为我对它还很陌生，但是 IIRC Chris Tavares - 他基本上是 Unity 的开发者 - 不时在这里闲逛，所以也许他会顺便过来回答这个:-)

# llblgenpro - 根据关系集合计数过滤 FetchEntityCollection

> ID：634463
> 
> 赞同：2
> 
> 时间：2009-03-11T13:14:55.260
> 
> 标签：llblgenpro

我目前获取这样的工作集合：

```
jobs = new EntityCollection<JobEntity>(new JobEntityFactory()); 

var bucket = GetJobsBucket(filter);

var tempContext = new Context();
tempContext.Add(jobs);
var sorter = new SortExpression(JobFields.Id | SortOperator.Descending);

adapter.FetchEntityCollection(jobs, bucket, maxCount, sorter, JobListPrefetchPath(false));

filter.TotalMatchesCount = adapter.GetDbCount(new JobEntityFactory().CreateFields(), bucket, null, false);
filter.ReturnedMatchesCount = jobs.Count;

tempContext.Clear();

return jobs; 
```

其中bucket包含很多谓词，例如

```
 bucket.Relations.Add(JobEntity.Relations.JobTypeEntityUsingJobTypeFk);
    bucket.Relations.Add(JobTypeEntity.Relations.JobTypeCategoryEntityUsingCategoryFk);   
    var fieldCompareValuePredicate = new FieldCompareValuePredicate(JobTypeCategoryFields.Filter, null,
                    ComparisonOperator.Equal, filter.JobCategory) { CaseSensitiveCollation = true };                        
    bucket.PredicateExpression.Add(fieldCompareValuePredicate); 
```

Job 实体有一个附件集合（通过外键）

如何过滤作业列表以仅选择带有一个或多个附件的作业？我知道我可以通过动态视图使用内存过滤器（AggregateSetPredicate），但这意味着我必须获取所有作业才能获得正确的计数，当前获取的返回计数具有最大值。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-03-11T15:43:18.507

解决方案是这样做：

```
 bucket.Relations.Add(JobEntity.Relations.AttachmentEntityUsingJobFk);
FieldCompareSetPredicate filteredAttachments;
filteredAttachments = new FieldCompareSetPredicate(JobFields.Id, null,
                                                   AttachmentFields.JobFk, null,
                                                   SetOperator.In, null);
 bucket.PredicateExpression.Add(filteredAttachments); 
```

# visual-studio - 如何将环境变量添加到 VS 解决方案（.sln）

> ID：634466
> 
> 赞同：13
> 
> 时间：2009-03-11T13:15:56.413
> 
> 标签：visual-studio, environment-variables

我需要为解决方案中的所有项目拥有自己的环境变量（如 $(VsInstallDir) ）。我如何在我的解决方案中定义它？

我正在使用 VS2008，C++ 解决方案

* * *

## 回答 #1

> 赞同：10
> 
> 时间：2009-03-11T13:35:10.733

我有一个类似的问题和[随之而来的问题](https://stackoverflow.com/questions/377075/visual-c-2008-how-to-have-global-settings-defined-in-a-solution)。看看那里的答案。简短的回答是：使用[属性表](http://msdn.microsoft.com/en-us/library/5k4a0033(VS.80).aspx)。

例如：

```
<?xml version="1.0" encoding="Windows-1252"?>
<VisualStudioPropertySheet
    ProjectType="Visual C++"
    Version="8.00"
    Name="MyIncludes"
    >
    <UserMacro
        Name="BoostInclude"
        Value="C:\Program Files\boost\boost_1_35_0"
        PerformEnvironmentSet="true"
    />
</VisualStudioPropertySheet> 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-03-11T13:23:18.627

您可以创建一个项目（dll），它只包含您所有的环境变量；称它为solution_env.dll 什么的。解决方案中的所有其他项目都必须引用该 dll。

我怀疑还有其他更好的方法来完成您正在尝试做的事情，但这取决于您实际尝试做的事情。我的意思是，你有一些目标，并且你已经决定你的目标的解决方案是拥有一个解决方案范围的环境变量，所以你已经问过如何做到这一点。询问是否有其他方法可以完成您真正想做的事情可能会更有益。

# workflow - 如何在 X++ 中将采购申请的工作流状态从已完成重置为以编程方式提交？

> ID：634478
> 
> 赞同：1
> 
> 时间：2009-03-11T13:20:32.063
> 
> 标签：workflow, x++, dynamics-ax-2009

微软动态 AX 2009：

我需要从采购订单屏幕中执行此操作，因此我只有 PurchLines 表中的采购申请编号。

非常感谢您的帮助，因为网络上还没有可用的东西（我可以找到）并且 AX 2009 教程中缺少课程。

所有有用的答案肯定会得到我的支持。

编辑：目的是当单击采购订单屏幕上的按钮时，强制现有工作流程从“提交”阶段在采购申请上重新执行。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-03-13T11:16:03.597

我找到了答案（代码）再次将其提交到工作流：

workflowCorrelationId = Workflow::activateFromWorkflowTemplate(workflowTemplateName,recId,note,NoYes::No,'userid');

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-03-11T16:47:49.430

这将重置 PurchReqTable 中的工作流状态和状态字段，但不会执行任何工作流逻辑：

```
PurchReqTable::setWorkflowState(PurchReqTable::find(PurchLine.PurchReqId).RecId, PurchReqWorkflowState::Submitted); 
```

# python - 在单元测试中使用 wsgiref.simple_server

> ID：634485
> 
> 赞同：4
> 
> 时间：2009-03-11T13:22:09.563
> 
> 标签：python, unit-testing, wsgiref

我有一些像这样的功能：

```
 URL = 'http://localhost:8080'
def func():
    response = urlopen(URL)
    return process(response) 

```

我想用unittest测试它。

我做了这样的事情：

```
 from wsgiref.simple_server import make_server
def app_200_hello(environ,start_response):
    stdout = StringIO('Hello world')
    start_response("200 OK", [('Content-Type','text/plain')])
    return [stdout.getvalue()]

s = make_server('localhost', 8080, app_200_hello)

class TestFunc(unittest.TestCase):
    def setUp(self):
        s.handle_request()

    def test1(self):
        r = func()
        assert r, something

if __name__ == '__main__':
    unittest.main() 
```

在 setUp() 我的测试停止，因为 s.handle_request() 等待请求。我怎样才能解决这个问题？在另一个线程中运行 s.handle_request()？或者也许还有另一种解决方案？

编辑：我想测试“func”功能，而不是“app_200_hello”

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2009-03-11T13:44:29.073

如果您正在测试 WSGI 应用程序，我强烈推荐[werkzeug.test](http://werkzeug.pocoo.org/documentation/test)通过在没有服务器的情况下测试应用程序本身来解决这些问题：

```
from werkzeug.test import Client

# then in your test case
def test1(self):
    client = Client(app_200_hello)
    appiter, status, headers = client.open()
    assert ''.join(appiter) == 'Hello World'
    assert status == '200 OK' 
```

这种方法完全消除了对 WSGI 服务器的需求。

当然，如果您确实想启动服务器，则必须使用单独的线程或进程，但是您必须确保事后停止它。但是，让我感到震惊的是，您唯一想要使用真实服务器进行测试的时间是生产集成测试，在这种情况下，您的服务器将不是 wsgiref，它将是您可能不必启动的真实服务器- 停止这样。

* * *

## 回答 #2

> 赞同：5
> 
> 时间：2011-07-03T17:49:28.313

使用多处理在单独的进程中启动服务器

在 setUp 中执行以下操作：

```
self.port = 8000
server = make_server('', self.port, make_my_wsgi_ap())
self.server_process = multiprocessing.Process(target=server.serve_forever)
self.server_process.start() 
```

然后在 tearDown 做：

```
self.server_process.terminate()
self.server_process.join()
del(self.server_process) 
```

我发现如果你没有明确地将 del() 放在那里，那么后续的服务器实例可能会遇到端口已经被使用的问题。

* * *

## 回答 #3

> 赞同：4
> 
> 时间：2009-03-11T13:59:16.963

您的服务器必须是一个单独的进程。

你会想要开始它`subprocess.Popen()`

如果您使用的是 Python 2.6，则可以在拆卸期间终止子进程。

```
def setUp( self ):
    self.server= subprocess.Popen( "python","myserver","etc." )
def tearDown( self ):
    self.server.kill() 
```

如果您不使用 Python 2.6，那么终止服务器可能会令人不快。

* * *

## 回答 #4

> 赞同：2
> 
> 时间：2009-03-11T16:28:20.693

您还可以提供一个`urlopen`实际上并不运行服务器的模拟版本。

假设您的原始代码在 中`mycode.py`，在您的测试代码中，您将执行以下操作：

```
 import mycode

class TestFunc(unittest.TestCase):
    def setUp(self):
        # patch mycode, to use mock version of urlopen
        self._original_urlopen = mycode.urlopen
        mycode.urlopen=self.mock_urlopen

    def tearDown(self):
        # unpatch urlopen
        mycode.urlopen=self._original_urlopen

    def mock_urlopen(self,url):
        # return whatever data you need urlopen to return

    def test1(self):
        r = func()
        assert r, something

if __name__ == '__main__':
    unittest.main() 
```

这被称为“猴子补丁”，有些人对此不以为然，但是对于测试您的代码，它可以使生活变得更加轻松，因为您无需更改原始代码即可使其可测试。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2009-03-11T14:58:23.467

我的解决方案：

```
 URL = 'http://localhost:8085'
def func():
    response = urlopen(URL)
    return response.read()

import unittest
from wsgiref.simple_server import WSGIServer, WSGIRequestHandler
import threading
from urllib2 import urlopen
from cStringIO import StringIO

def app_200_hello(environ,start_response):
    stdout = StringIO('Hello world')
    start_response("200 OK", [('Content-Type','text/plain')])
    return [stdout.getvalue()]

server = WSGIServer(('localhost', 8085), WSGIRequestHandler)
server.set_app(app_200_hello)

t = threading.Thread(target=server.serve_forever)
t.start()

class TestFunc(unittest.TestCase):
    def setUp(self):
        pass

    def test1(self):
        r = func()
        self.assertEqual(r, 'Hello world')

    def __del__(self):
        server.shutdown()

if __name__ == '__main__':
    unittest.main() 

```

我在另一个线程中启动“服务器”并在 TestFunc 析构函数中关闭它。

# sharepoint - 在 SharePoint 中部署控制适配器

> ID：634496
> 
> 赞同：0
> 
> 时间：2009-03-11T13:25:49.413
> 
> 标签：sharepoint, deployment, moss, customization

有没有办法使用 WSP 解决方案和功能在 SharePoint 中自动部署控制适配器（一些菜单修改）？我可以以编程方式编辑/部署一些“.browser”文件吗？

如果不可能，有什么替代方案（一些好的做法）？

我需要这个用于发布网站。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-03-12T09:11:36.180

你可以给[WSPBuilder](http://wspbuilder.codeplex.com/)一个机会。它是一个开源工具包 SharePoint 解决方案。我知道使用 WSPBuilder，您可以将文件部署到应用程序目录 (...\Inetpub\wwwroot\wss\VirtualDirectories\80) 内的 bin 和资源文件夹中。

因此，也许也可以将文件部署到 App_Browsers 文件夹中。我认为值得一试。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-03-12T17:42:41.930

此外，使用功能，您始终可以定义一个 FeatureReceiver，它基本上是对开发人员提供的用于处理功能生命周期事件（ee onFeatureInstalled、onFeatureActivated 等）的程序集的标注。在那里您可以编写 .Net 代码与之交互基础设施。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-01-24T10:06:36.697

[这是一篇](http://blog.mikehacker.net/2009/10/25/using-a-control-adapter-for-branding-part-3/)解释此任务的文章。您可以将这样的方法添加到您的母版页类中：

```
private static void AddControlAdapterToType<T>(Type controlType) where T : ControlAdapter, new()
   {
       if (controlType == null)
       {
           throw new ArgumentNullException("controlType", "This argument can not be null!");
       }

       var adapters = HttpContext.Current.Request.Browser.Adapters;
       var key = controlType.AssemblyQualifiedName;
       if (!adapters.Contains(key))
       {
           var adapter = typeof(T).AssemblyQualifiedName;
           adapters.Add(key, adapter);
       }
   } 
```

然后从 Master Page 构造函数中调用它，如下所示：

```
AddControlAdapterToType<YourCustomAdapter>(typeof(Microsoft.SharePoint.WebPartPages.ContentEditorWebPart)); 
```

# svn - 将已删除目录提交到 SVN 存储库时出现问题

> ID：634498
> 
> 赞同：2
> 
> 时间：2009-03-11T13:26:27.043
> 
> 标签：svn

我正在尝试从我的存储库中删除一个目录。我删除文件夹并执行 svn commit，但出现以下错误：

> 错误：提交失败（详情如下）：
> 
> 错误：访问被拒绝

我的用户在 [/] 上有 rw 权限，我可以提交新的或修改过的文件

关于问题可能是什么的任何想法？

编辑：

似乎我可以执行单个文件删除，但我无法删除目录。示例我可以删除 \data\a.txt 但不能删除 \data

EDIT2：我的授权

> [别名] * =
> 
> [团体]
> 
> # harry_and_sally = 哈利，莎莉
> 
> # harry_sally_and_joe = 哈利，莎莉，&乔
> 
> [/]
> 
> 贝塔 = rw
> 
> 佩拉斯= rw

我的密码

> [用户]
> 
> 测试版 = Bunny1981
> 
> peras = MyDearBunny

**编辑：** 解决方案是对正确答案的评论

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2009-03-11T13:33:01.877

当您从文件系统中删除文件夹时，SVN 认为您的副本中缺少某些内容，因此会显示错误。

相反，您不应该手动删除文件夹，而是告诉 SVN 删除它 - 这样 SVN 将删除文件夹内容并在下次提交时将其标记为删除。

您可以使用“svn rm”命令进行该操作。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2009-03-11T13:35:32.900

您是否使用基于路径的授权？如果是这样，请检查您的 authz 配置是否有错误。

如果您说您可以结帐，但不能提交（添加/修改/删除）并验证授权正常，那么我会说检查您的工作副本 URL 服务器名称，这是一个棘手的问题（使用基于路径的授权）其中 checkout 不区分大小写（对于服务器名称），但 commit 区分大小写。在这种情况下，您需要进行搬迁。

编辑：您可以远程执行删除吗？

`svn delete URL`

这将消除 WC 作为问题的根源。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2009-03-11T13:31:11.447

告诉 SVN 你想用“svn rm”删除文件夹，然后提交。

# java - 如何编译和运行相互依赖的插件 jars

> ID：634500
> 
> 赞同：2
> 
> 时间：2009-03-11T13:26:58.833
> 
> 标签：java, build, jar, eclipse-plugin, cyclic-reference

我必须将两个 eclipse-plugin 项目构建到两个单独的 jar 中，每个 jar 都依赖于另一个进行编译。Eclipse IDE 抱怨“循环依赖...”。如何构建这些插件 jar？我想通过将它们放在 eclipse/plugin 文件夹中运行这些插件应该很顺利。

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2009-03-11T13:30:17.407

如果你有一个循环依赖，你有两个选择：

1.  您可以通过将它们放入一个 JAR 中来摆脱它。如果他们真的相互依赖，他们真的只是一个实体。
2.  您可以将导致循环依赖的包拆分为第三个 JAR，并部署两个插件，每个插件有两个 JAR。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-03-11T13:38:12.897

如果（且仅当）您真的*无法*摆脱这种循环依赖，您可以在插件之间使用松散形式的依赖：[**DynamicImport-Package**](http://dev.eclipse.org/newslists/news.eclipse.platform.rcp/msg15022.html)
（如此[博客条目](http://blog-o-lok.blogspot.com/2008/01/osgi-and-dynamicimport-package.html)中所建议，但强调摆脱循环）

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-09-14T07:45:22.343

或者您可以采用 maven 方法，将版本化 jar 部署到存储库。

那么项目 A 依赖于存储库中 B 的最新发布版本，而 B 依赖于存储库中 A 的最新版本。

# linux - linux启动/停止时运行的脚本？

> ID：634501
> 
> 赞同：0
> 
> 时间：2009-03-11T13:27:05.933
> 
> 标签：linux

在 Linux 中让一个脚本在启动时运行而另一个在关机时运行的最简单方法是什么？

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2009-03-11T13:30:46.033

[SysV 风格的初始化。](http://en.wikipedia.org/wiki/Init#SysV-style)

请参阅介绍性文章[http://www.linux.com/feature/114107](http://www.linux.com/feature/114107)

大多数发行版都有自己的前端来管理运行级别。不幸的是，没有标准工具。

例如，我使用 OpenSUSE，它可以[由 YaST 管理](http://www.linuxtopia.org/online_books/opensuse_guides/opensuse11.1_reference_guide/sec_boot_init.html)。

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2009-03-11T14:40:34.430

在 Debian 或 Ubuntu 中，复制 /etc/init.d/skeleton，一个用于启动/停止守护进程的示例脚本，并根据自己的喜好对其进行编辑，并使其可执行：

```
cp /etc/init.d/skeleton /etc/init.d/mythingy
pico /etc/init.d/mythingy
chmod 755 /etc/init.d/mythingy 
```

这应该为您提供一种启动和停止给定程序/脚本的方法。您可能需要测试您的脚本以确保它按预期工作：

```
/etc/init.d/mythingy start
/etc/init.d/mythingy stop 
```

完成此操作后，使用 update-rcd 命令使其在启动/关闭时运行：

```
update-rcd mythingy defaults 
```

除非您知道自己在做什么，否则使用默认值是非常好的。这应该是您需要做的所有事情！

您可能会发现这些资源很有帮助：

1.  [Debian SysV 初始化](http://www.debian.org/doc/debian-policy/ch-opersys.html#s-sysvinit)
2.  [Ubuntu 初始化](http://www.linux.com/feature/125977?theme=print)

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2009-03-11T13:28:17.053

在 /etc/init.d 中创建脚本并运行`chkconfig myscript on`. 有关示例，请参见 /etc/init.d 中的其他脚本。

正如其他人所指出的，这是基于 Red Hat 的发行版。

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2009-03-12T09:44:21.887

Ubuntu 有 /etc/rc.local，这是一个脚本，你可以编辑它来调用你在启动时需要做的任何事情。

Gentoo 有 /etc/conf.d/local.start 和 /etc/conf.d/local.stop

在 Redhat/fedora 下必须是类似的东西。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2009-03-11T13:31:24.160

这是非常依赖于分布的，并且也会随着运行级别等内容而变化，并且在启动期间您希望脚本运行的确切时间。

但是在 /etc 中四处寻找可能是弄清楚如何为您的特定机器执行此操作的好方法。

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2009-03-11T13:34:07.727

让脚本在启动时运行的最简单方法是在 root 的 crontab 中添加 @reboot 条目。（我不知道任何@shutdown 规则）：

```
@reboot /path/to/script <arguments> 
```

对于 debian 系统（包括 ubuntu），“正确”的方法是根据该目录中的骨架文件在 /etc/init.d 中创建一个初始化脚本。使用 update-rc.d 使其处于活动状态（阅读手册以了解用法）。

* * *

## 回答 #7

> 赞同：0
> 
> 时间：2009-03-11T13:51:09.730

如果您的应用程序不支持守护进程、pid 文件处理等，您可以使用命令[start-stop-daemon](http://man.he.net/man8/start-stop-daemon)在您的 init 脚本中为您提供这些功能。

* * *

## 回答 #8

> 赞同：0
> 
> 时间：2009-03-12T09:51:28.173

由于您没有指定哪个发行版，因此您只能依赖 LSB 中有关[init scripts](http://refspecs.linux-foundation.org/LSB_3.2.0/LSB-Core-generic/LSB-Core-generic/initsrcinstrm.html)的信息。

# c++ - 如何从视频中提取帧（使用 DirectShow）？

> ID：634502
> 
> 赞同：0
> 
> 时间：2009-03-11T13:27:10.113
> 
> 标签：c++, windows, video, directshow

我必须将可以使用标准 Windows 媒体播放器播放的任何视频文件中的帧提取到单独的图像中。你能给我一些关于如何进行的信息，阅读什么文档/书籍等吗？

语言是 C/C++。

另外，不要推荐任何涉及 GPL 代码的解决方案，我必须使用的软件是专有的。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2009-03-11T14:16:09.183

我可以向您推荐以下关于[CodeProject](http://www.codeproject.com/KB/audio-video/VideoImageGrabber.aspx)的优秀示例。它向您展示了如何处理来自相机源或 avi 文件的帧。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-03-11T13:33:06.777

您可以只[`SampleGrabber`](http://msdn.microsoft.com/en-us/library/dd407288(VS.85).aspx)在图表中添加一个过滤器，并在图像向下传递图表时将图像保存到回调函数中的磁盘。

# perl - 如何将 Perl 输出发送到 STDOUT 和变量？

> ID：634508
> 
> 赞同：10
> 
> 时间：2009-03-11T13:29:57.407
> 
> 标签：perl

我想将命令的输出发送到 STDOUT 和变量。我想结合：

```
my $var = `some command` ;   
system( 'some command' ) ; 
```

[Tee](http://metacpan.org/pod/Tee)是朝着正确方向迈出的一步，但这会将其发送到文件而不是变量。我想我可以然后阅读该文件，但直接在那里获取它会更简单。

* * *

## 回答 #1

> 赞同：15
> 
> 时间：2009-03-11T13:33:32.360

两个流的输出是否是同时的？

如果没有，你可以这样做：

```
my $var = 'cmd'
my $output = `$cmd`
print STDOUT $output 
```

或者对于更安全的版本，它不涉及调用子shell，并且一次打印到 STDOUT 一行：

```
sub backtick(@)
{
    my $pid = open(KID, '-|');
    die "fork: $!" unless defined($pid);
    if ($pid) {
        my $output;
        while (<KID>) {
            print STDOUT $_;
            $output .= $_; # could be improved...
        }
        close(KID);
        return $output;
    } else {
        exec @_;
    }
}

my @cmd = ('/bin/ls', '-l');
my $output = backtick(@cmd); 
```

* * *

## 回答 #2

> 赞同：9
> 
> 时间：2009-03-12T01:25:41.103

你想要[Capture::Tiny](http://search.cpan.org/perldoc?Capture::Tiny)

```
use Capture::Tiny 'tee';
my $output = tee { system( "some command" ) }; 
```

我编写它是为了替换 Tee 和大约 20 个其他模块，这些模块可以进行某种捕获，但在某种方式上存在缺陷。

-- xdg（又名 dagolden）

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2009-03-11T15:09:21.367

也许我在这里的回答可以帮助你：[我怎样才能接触到 Perl 的印刷品？](https://stackoverflow.com/questions/387702/how-can-i-hook-into-perls-print/388211#answer-388211)

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2009-03-11T14:39:02.250

您可以使用该[`IO::String`](http://search.cpan.org/~gaas/IO-String-1.08/String.pm)模块将`select()`STDOUT 转换为字符串，然后调用`system()`以运行该命令。您可以从`IO::String`句柄收集输出。这有效地完成了反引号语法的作用。

因此，要实时收集命令输出，请通过或其他方式`system()`异步运行命令并轮询句柄以获取更新。`fork()`

编辑：根据 OP，事实证明这种方法不起作用。 `select()`不影响`system()`通话。

此外，自 Perl 5.8 以来，`IO::String`它已被替换为`open()`执行相同功能的新语法。

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2009-03-11T21:40:30.817

您也可以通过文件句柄执行此操作。不像某些解决方案那样优雅，但它可能会起作用。类似于以下内容：

```
my $foo;
open(READ, "env ps |");
while (<READ>) {
    print;
    $foo .= $_;
}
print $foo;
close(READ); 
```

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2009-03-11T14:28:05.270

将 Tee 模块的输出发送到`/dev/stdout`（或`/dev/fd/1`）。

* * *

## 回答 #7

> 赞同：0
> 
> 时间：2011-06-11T10:37:02.607

```
 package Logger ; 
    # docs at the end ... 
    use lib '.' ; use strict ; use warnings ; use Carp qw(cluck); 

    our ( $MyBareName  , $LibDir , $RunDir ) = () ; 

    BEGIN {     

        $RunDir = '' ; 
        $0 =~ m/^(.*)(\\|\/)(.*)\.([a-z]*)/; 
        $RunDir = $1 if defined $1 ; 
        push ( @INC , $RunDir) ;    
        #debug print join ( ' ' , @INC ) ; 

    } #eof sub

    use Timer ; use FileHandler ; 

    # the hash holding the vars 
    our $confHolder = () ; 

    # ===============================================================
    # START OO

    # the constructor 
    sub new {

        my $self = shift;
        #get the has containing all the settings
        $confHolder = ${ shift @_ } ;                                           
        # Set the defaults ...
        Initialize () ;     
        return bless({}, $self);
    } #eof new 

    BEGIN { 

            # strip the remote path and keep the bare name
            $0=~m/^(.*)(\\|\/)(.*)\.([a-z]*)/; 
            my ( $MyBareName , $RunDir ) = () ; 
            $MyBareName = $3; 
            $RunDir= $1 ; 

            push ( @INC,$RunDir ) ; 

    } #eof BEGIN

    sub AUTOLOAD {

        my $self = shift ; 
        no strict 'refs'; 
            my $name = our $AUTOLOAD;
            *$AUTOLOAD = sub { 
        my $msg = "BOOM! BOOM! BOOM! \n RunTime Error !!!\nUndefined Function $name(@_)\n" ;
        print "$self , $msg";
            };
            goto &$AUTOLOAD;    # Restart the new routine.
    }   

    sub DESTROY {

        my $self = shift;
        #debug print "the DESTRUCTOR is called  \n" ; 
        return ; 
    } 

    END { 

        close(STDOUT) || die "can't close STDOUT: $! \n\n"  ; 
        close(STDERR) || die "can't close STDERR: $! \n\n" ; 
    }

    # STOP OO
    # =============================================================================

    sub Initialize { 

        $confHolder = { Foo => 'Bar' ,   } unless ( $confHolder ) ; 
        # if the log dir does not exist create it 
        my $LogDir = '' ; 
        $LogDir = $confHolder->{'LogDir'} ; 

        # create the log file in the current directory if it is not specified 
        unless ( defined ( $LogDir )) {
        $LogDir = $RunDir  ; 
        }

    use File::Path qw(mkpath);

        if( defined ($LogDir) &&  !-d "$LogDir" ) {  
                mkpath("$LogDir") || 
                cluck ( " Cannot create the \$LogDir : $LogDir $! !!! "  ) ; 
        }

        # START set default value if value not specified =========================
        # Full debugging ....
            $confHolder->{'LogLevel'} = 4   
                    unless ( defined ( $confHolder->{'LogLevel'} ) )  ; 

            $confHolder->{'PrintErrorMsgs'} = 1     
                    unless ( defined ( $confHolder->{'PrintErrorMsgs'} ) )  ; 

            $confHolder->{'PrintDebugMsgs'} = 1 
                    unless ( defined ($confHolder->{'PrintDebugMsgs'})) ; 

            $confHolder->{'PrintTraceMsgs'} = 1 
                    unless ( defined ( $confHolder->{'PrintTraceMsgs'} )) ; 

            $confHolder->{'PrintWarningMsgs'} = 1   
                    unless ( defined ( $confHolder->{'PrintWarningMsgs'} ) )  ; 

            $confHolder->{'LogMsgs'} = 1
                    unless ( defined ( $confHolder->{'LogMsgs'} ) )  ; 

            $confHolder->{'LogTimeToTextSeparator'} = '---'
                    unless ( defined ( $confHolder->{'LogTimeToTextSeparator'} ) )  ; 

        #
        # STOP set default value if value not specified =========================

    } #eof sub Initialize

    # =============================================================================
    # START functions

    # logs an warning message
    sub LogErrorMsg {

        my $self = shift ; 
        my $msg = "@_" ; 
        my $msgType = "ERROR" ; 

        # Do not print anything if the PrintWarningMsgs = 0 
        return if ( $confHolder->{'LogMsgs'} == 0 )     ; 

        # Do not print anything if the PrintWarningMsgs = 0 
        return if ( $confHolder->{'PrintErrorMsgs'} == 0 )  ; 

        $self->LogMsg( $msgType , "$msg" ) if ( $confHolder->{'PrintErrorMsgs'} == 1 ) ; 

    } #eof sub

    # logs an warning message
    sub LogWarningMsg {

        my $self = shift ; 
        my $msg = "@_" ; 
        my $msgType = 'WARNING' ; 

        # Do not print anything if the PrintWarningMsgs = 0 
        return if ( $confHolder->{'LogMsgs'} == 0 )     ; 

        # Do not print anything if the PrintWarningMsgs = 0 
        return if ( $confHolder->{'PrintWarningMsgs'} == 0 )    ; 

        $self->LogMsg( $msgType , "$msg" ) if ( $confHolder->{'PrintWarningMsgs'} == 1 ) ;  

    } #eof sub

    # logs an info message
    sub LogInfoMsg {

        my $self = shift ; 
        my $msg = "@_" ; 
        my $msgType = 'INFO' ; 

        # Do not print anything if the PrintWarningMsgs = 0 
        return if ( $confHolder->{'LogMsgs'} == 0 )     ; 

        # Do not print anything if the PrintWarningMsgs = 0 
        return if ( $confHolder->{'PrintInfoMsgs'} == 0 )   ; 

        $self->LogMsg( $msgType , "$msg" ) if ( $confHolder->{'PrintInfoMsgs'} == 1 ) ;  

    } #eof sub

    # logs an trace message
    sub LogTraceMsg {

        my $self = shift ; 
        my $msg = "@_"  ; 
        my $msgType = 'TRACE' ; 
        my ($package, $filename, $line) = caller();     

        # Do not print anything if the PrintDebugMsgs = 0 
        return  if ( $confHolder->{'PrintTraceMsgs'} == 0 )      ; 

        $msg = "$msg : FROM Package: $package  FileName: $filename Line: $line  "  ; 

        # Do not print anything if the PrintWarningMsgs = 0 
        return if ( $confHolder->{'LogMsgs'} == 0 )     ; 

        # Do not print anything if the PrintWarningMsgs = 0 
        return if ( $confHolder->{'PrintTraceMsgs'} == 0 )  ; 

        $self->LogMsg( $msgType , "$msg" ) if ( $confHolder->{'PrintTraceMsgs'} == 1 ) ;  

    } #eof sub

    # logs an Debug message
    sub LogDebugMsg {

        my $self = shift ; 
        my $msg = "@_" ; 
        my $msgType = 'DEBUG' ; 

        # Do not print anything if the PrintWarningMsgs = 0 
        return if ( $confHolder->{'LogMsgs'} == 0 )     ; 

        # Do not print anything if the PrintWarningMsgs = 0 
        return if ( $confHolder->{'PrintDebugMsgs'} == 0 )  ; 

        $self->LogMsg( $msgType , "$msg" ) if ( $confHolder->{'PrintDebugMsgs'} == 1 ) ;  

    } #eof sub

    sub GetLogFile {

            my $self = shift ; 
            #debug print "The log file is " . $confHolder->{ 'LogFile' } ;  
            my $LogFile = $confHolder->{ 'LogFile' } ; 

            #if the log file is not defined we create one 
            unless  ( $confHolder->{ 'LogFile' } ) { 

                $LogFile = "$0.log"  ;

            }

            return $LogFile ; 
    } #eof sub 

    sub BuildMsg { 

    my $self = shift ; 
    my $msgType = shift ; 

    my $objTimer= new Timer(); 
    my $HumanReadableTime = $objTimer->GetHumanReadableTime(); 
    my $LogTimeToTextSeparator = $confHolder->{'LogTimeToTextSeparator'} ; 

    my $msg = () ; 

        # PRINT TO STDOUT if 
        if (                $msgType eq 'WARNING' 
                    ||      $msgType eq 'INFO' 
                    ||      $msgType eq 'DEBUG' 
                    ||      $msgType eq 'TRACE'                     )   {

            $msg = " $HumanReadableTime $LogTimeToTextSeparator $msgType : @_ \n" ; 

        }
        elsif ( $msgType eq 'ERROR' ) {

            $msg = " $HumanReadableTime $LogTimeToTextSeparator $msgType : @_ \n" ; 

        }
        else {
            $msg = " $HumanReadableTime $LogTimeToTextSeparator $msgType @_ \n" ; 
        }

        return $msg ; 
    } #eof sub BuildMsg

    sub LogMsg { 

    my $self = shift ; 
    my $msgType = shift ; 

    my $msg = $self->BuildMsg ( $msgType , @_ ) ; 
    my $LogFile = $self -> GetLogFile();                            

    # Do not print anything if the LogLevel = 0 
    return              if ( $confHolder->{'LogLevel'} == 0 ) ; 

        # PRINT TO STDOUT if 
        if (                
                                $confHolder->{'PrintMsgs'} == 1 
                    ||      $confHolder->{'PrintInfoMsgs'} == 1 
                    ||      $confHolder->{'PrintDebugMsgs'} == 1 
                    ||      $confHolder->{'PrintTraceMsgs'} == 1 
                    )   {

            print STDOUT $msg ; 
        }

        elsif ( $confHolder->{'PrintErrorMsgs'}  ) {

            print STDERR $msg ; 
        }

        if ( $confHolder->{'LogToFile'} == 1 )  {   

            my $LogFile = $self -> GetLogFile();
            my $objFileHandler = new FileHandler();

            $objFileHandler->AppendToFile( $LogFile , "$msg"  );

        } #eof if

        #TODO: ADD DB LOGGING

    } #eof LogMsg

    # STOP functions
    # =============================================================================

    1;

    __END__

    =head1 NAME

    Logger 

    =head1 SYNOPSIS

    use Logger  ; 

    =head1 DESCRIPTION

    Provide a simple interface for dynamic logging. This is part of the bigger Morphus tool : google code morphus
    Prints the following type of output : 

    2011.06.11-13:33:11 --- this is a simple message  
    2011.06.11-13:33:11 --- ERROR : This is an error message  
    2011.06.11-13:33:11 --- WARNING : This is a warning message  
    2011.06.11-13:33:11 --- INFO : This is a info message  
    2011.06.11-13:33:11 --- DEBUG : This is a debug message  
    2011.06.11-13:33:11 --- TRACE : This is a trace message  : FROM Package: Morphus  
    FileName: E:\Perl\sfw\morphus\morphus.0.5.0.dev.ysg\sfw\perl\morphus.pl Line: 52   

    =head2 EXPORT

    =head1 SEE ALSO

    perldoc perlvars

    No mailing list for this module

    =head1 AUTHOR

    yordan.georgiev@gmail.com

    =head1 COPYRIGHT AND LICENSE

    Copyright (C) 2011 Yordan Georgiev

    This library is free software; you can redistribute it and/or modify
    it under the same terms as Perl itself, either Perl version 5.8.1 or,
    at your option, any later version of Perl 5 you may have available.

    VersionHistory: 
    1.4.0 --- 2011.06.11 --- ysg --- Separated actions of building and printing msgs. Total refactoring. Beta . 
    1.3.0 --- 2011.06.09 --- ysg --- Added Initialize 
    1.2.0 --- 2011.06.07 --- ysg --- Added LogInfoErrorMsg print both to all possible
    1.1.4 --- ysg --- added default values if conf values are not set 
    1.0.0 ---  ysg --- Create basic methods 
    1.0.0 ---  ysg --- Stolen shamelessly from several places of the Perl monks ...

    =cut 
```

* * *

## 回答 #8

> 赞同：0
> 
> 时间：2013-02-05T16:51:51.507

我的 $output = system("你的命令 | tee /dev/tty");

为我工作！！

# clearcase - ClearCase：加载特定目录的旧版本？

> ID：634509
> 
> 赞同：2
> 
> 时间：2009-03-11T13:29:58.127
> 
> 标签：clearcase

如何在 UCM 快照视图中加载旧版本的目录？在我们的项目中，一位开发人员将未编译和不可编译的代码签入到 ClearCase。其他开发人员更新了她的视图，然后他没有编译项目，因为以前的开发人员没有编译代码。所以开发人员只想获取以前版本的目录。如何在快照视图中执行此操作并且仅针对特定目录？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2009-03-11T16:23:33.683

第一种可能性是尝试选择要还原的子目录的正确版本，例如：

```
element /path/to/directory /main/[branch]/[version] 
```

但这显然是错误的，因为：

*   快照视图中不支持扩展路径名，如此[SO question](https://stackoverflow.com/questions/176858/in-clearcase-how-can-i-view-old-version-of-a-file-in-a-static-view-from-the-com/177350#177350)中所述。

*   **仅选择目录是不够的**（文件仍将被选为流中可用的最新版本！）

无论如何，这需要在配置规范中仔细添加，因为：

*   您不能在配置规范中的任何位置添加选择规则（元素 ...）：
    *   如果您将该规则放在最后，它将被忽略（因为首先选择的先前选择规则）
    *   如果你把它放在开头，它将一直工作到下一次“ `setcs -stream`”出现（或下一次你推送“与流同步”时）。那时，UCM 视图（快照或动态）的配置规范被重新生成（根据流的配置）并覆盖您的自定义规则。

* * *

一种可能的解决方案是使用**基于时间的规则**
修改快照视图的配置规范 （它修改了特殊版本标签的含义`LATEST`；该规则从分支中选择在特定时间之前创建的最后一个版本；
请参阅' `cleartool man config_spec`'）：

```
# Add the following temporary rule only for your sub-directory and below
# (hence the '...')
element /aVob/myComponent/mySubDirectory/... .../STREAM_NAME/LATEST -time dd-Month-yyyy

element "[02945650fb1411d68504000180bdc4b6=\aVob]/myComponent/..." .../STREAM_NAME/LATEST
element "[02945650fb1411d68504000180bdc4b6=\aVob]/myComponent/..." FOUNDATION_BASELINE -mkbranch STREAM_NAME
element "[02945650fb1411d68504000180bdc4b6=\aVob]/myComponent/..." /main/0 -mkbranch STREAM_NAME 
```

刚刚在快照 UCM 视图中进行了测试：它可以工作。
将日期格式调整为您需要将该子目录恢复到正确状态的日期和时间。

# .net - SetItemChecked(index,boolean) VS SetItemCheckState(index,Checkstate)

> ID：634515
> 
> 赞同：2
> 
> 时间：2009-03-11T13:30:26.283
> 
> 标签：.net, checkedlistbox

在处理选中的列表框时，我偶然发现了 SetItemChecked 和 SetItemCheckState。

SetItemChecked 采用 listindex 和 True/false 将列表项设置为选中或未选中。

SetItemCheckState 采用 listindex 和 CheckState-enum 将状态设置为选中、未选中或不确定。

为什么 SetItemChecked 存在，而 SetItemCheckState 确实涵盖了所有状态？

是否只是为了方便使用布尔值，因为它是检查/取消选中的最常见用途，还是我错过了什么？

如果只是为了更容易使用布尔值，为什么不把它作为函数的重载呢？

谢谢。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2009-03-11T13:58:31.473

没有真正的区别。SetItemCheck 像这样调用 SetItemCheckedState：

```
public void SetItemChecked(int index, bool value)
{
    this.SetItemCheckState(index, value ? CheckState.Checked : CheckState.Unchecked);
} 
```

就像您已经假设的那样，我想这只是一种帮助开发人员简化事情的方法。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2009-03-11T13:36:35.520

我投票给

> 是否只是为了方便使用布尔值，因为它是检查/取消选中的最常见用途，还是我错过了什么？

但是通常不会使用额外的功能（仅添加了 Indeterminate 情况）

编辑： CheckedListBox.SetItemCheckState(1, CheckState.Checked) 难以阅读（但清楚） CheckedListBox.SetItemChecked(1, true) 更容易阅读

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2009-03-11T14:00:02.530

这是因为想要根据布尔值检查/取消检查更为常见，并且避免必须这样做：

`listbox.SetItemCheckState(i, value ? CheckState.Checked : CheckState.UnChecked)`

每时每刻。此外，它不是重载，因为它反映了 CheckBox 的 Checked 和 CheckState 属性。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2015-04-07T11:29:51.427

很清楚，但令人惊讶的是，这里没有人提到它：

`.SetItemChecked()`您只能选中或取消选中一个项目，同时您还可以将项目选中状态设置为“不确定”，当使用 3D 复选框时，这`.SetItemCheckState()`将在项目上提供一个阴影复选框。

# c# - 如何在 ASP.NET MVC RC2 中实现嵌套母版页？

> ID：634520
> 
> 赞同：0
> 
> 时间：2009-03-11T13:31:54.407
> 
> 标签：c#, asp.net-mvc, master-pages, nested

我有一个主 MasterPage，它为我当前正在设计的 Web 应用程序提供单列布局。我想重新使用现有的 MasterPage 来实现使用嵌套 MasterPages 的两列布局，这在 ASP.NET MVC Framework 的早期版本中是可能的，但我似乎无法让它在 RC2 中工作。

以下是我目前正在处理的代码，

```
<%@ Master Language="C#" 
    MasterPageFile="~/Views/Shared/Site.Master" 
    Inherits="System.Web.Mvc.ViewMasterPage" %>
<%@ Import Namespace="RHP.WebMvcApplication.Library" %>
<asp:Content ID="Content1" ContentPlaceHolderID="TitleContent" runat="server">
    <asp:ContentPlaceHolder ID="TitleContent" runat="server">
        Member List
    </asp:ContentPlaceHolder>
</asp:Content>
<asp:Content ID="Content2" ContentPlaceHolderID="MainContent" runat="server">
    <div id="mainLeftContent">
        <h3>Options</h3>       
        <%= Html.MenuCurrentChildren(); %>
    </div>
<div id="mainContent">
    <% Html.RenderPartial("MemberApplicationStateControl"); %>
    <asp:ContentPlaceHolder id="MainContent" runat="server">

    </asp:ContentPlaceHolder>
</div> 
</asp:Content> 
```

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2009-03-11T13:36:52.150

没关系！我在页面中有一个错误，它阻止了页面的呈现，所以它现在可以工作了。

错误是（;）：

```
<div id="mainLeftContent">
  <h3>Options</h3>       
  <%= Html.MenuCurrentChildren(); %>
</div> 
```

解决方法是：

```
<div id="mainLeftContent">
  <h3>Options</h3>       
  <%= Html.MenuCurrentChildren() %>
</div> 
```

它是使编程变得有趣的小东西。

# wcf - WCF、元数据和 BIGIP - 我可以为 WSDL 项目强制使用正确的 url 吗？

> ID：634522
> 
> 赞同：9
> 
> 时间：2009-03-11T13:32:25.547
> 
> 标签：wcf, wsdl, big-ip

我们有一个托管在 ServerA 上的 WCF 服务，它是一个不能直接访问 Internet 的服务器，并且有一个不可 Internet 路由的 IP 地址。

该服务的前端是 BIGIP，它处理 SSL 加密和解密，并将未加密的请求转发到特定端口上的 ServerA（目前它实际上不做任何负载平衡，但将来可能会添加）。

这意味着我们的客户将通过[https://www.OurDomain.com/ServiceUrl](https://www.OurDomain.com/ServiceUrl)调用服务，并通过 BIGIP 设备在[http://SeverA:85/ServiceUrl上访问我们的服务；](http://SeverA:85/ServiceUrl)

当我们浏览到发布在[https://www.OurDomain.com/ServiceUrl](https://www.OurDomain.com/ServiceUrl)上的 WSDL 时，WSDL 中包含的所有地址都基于[http://SeverA:85/ServiceUrl](http://SeverA:85/ServiceUrl)基地址

我们发现我们可以使用主机头设置来设置域，但我们的问题是虽然这会整理域，但我们仍然会使用错误的方案——它会使用[http://www.OurDomain.com /ServiceUrl](http://www.OurDomain.com/ServiceUrl)而我们需要它是 Https。

此外，由于我们在该服务器上托管了其他服务（基于 asmx），因此我们在设置主机标头时遇到了一些问题，因此我们认为我们可以在服务器上创建另一个站点（例如，使用端口 82）并设置主机头；现在，除了 http/https 问题之外，我们还有一个问题，因为 WSDL 包含所有 url 中的端口号，BigIP 在端口 443 上工作（用于 SSL）

有没有比实现 Host Headers 更灵活的解决方案？理想情况下，我们需要保持灵活性和易于支持。

感谢您的帮助……</p>

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2009-04-17T13:49:49.390

This is essentially a multi-part problem that involves a number of discrete solutions to provide the full answer. Essentially there are 3 problems with sitting behind the F5.

1.  The advertised service endpoint hostname.
2.  Hostname of links to xsd:import'ed schemas that describe the data contract
3.  the http/https problem you describe.

Changing the host headers, as you have found solves 1 and 2 (you can approach this in ways other than host headers, but no need to go into that here). Number 3 is a bit more tricky and requires more code (too much to dump out here).

The short answer is that you need to write a ContractBehavior that implements both IContractBehavior and IWsdlExportExtension.

The important bit you need to implement is the IWsdlExportExtension.ExportEndpoint. Within this method you need to iterate over all the WsdlPort Extensions, and when you find an extension that is of type SoapAddressBinding you need to replace the SoapAddressBinding.Location property with a new Uri that contains the https protocol specifier. You also need to do similar bits for the xsd import addresses and schema links.

If your service is also using WS-Addressing You then need to do something similar to handle the additional addresses it writes out to the wsdl.

I based the code I ended up writing on the WsdlExtras project available on CodePlex ([http://wcfextras.codeplex.com/](http://www.codeplex.com/WCFExtras/)). The method used in the WsdlExtras provides a great base for any extra bits you may need to add to it (From memory I don't think it dealt with the WS-Addressing bits). The bit you want to look at is the "Override SOAP Address Location URL".

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-11-21T10:21:40.417

Thanks to Mark Allanson, I had exactly the same scenario as yossi dahan had, The WCFExtras.dll file worked for me,

step1\. download the WCFExtras.dll [(http://www.codeplex.com/WCFExtras/)](http://www.codeplex.com/WCFExtras/%29).
step2\. add it's reference to your project.
step3\. don't waste your time in writing any code as suggested in the sample server app.
step4\. open the web.config and put the below code:

```
 <system.net>
     <settings>
        <httpWebRequest useUnsafeHeaderParsing="true" />
     </settings>
  </system.net> 
```

```
<system.serviceModel>
<services>
  <service behaviorConfiguration="ServiceBehaviorName" name="ServiceName">
    <endpoint address="" behaviorConfiguration="ServiceEndpointBehaviorName" binding="basicHttpBinding" contract="IServiceName">
      <identity>
        <dns value="localhost" />
      </identity>
    </endpoint>
    <endpoint address="mex" binding="mexHttpBinding" contract="IMetadataExchange" />
  </service>
</services>
<behaviors>
  <endpointBehaviors>
    <behavior name="ServiceEndpointBehaviorName">
      <wsdlExtensions location="https://sslLoadBalancer/ServiceName.svc"/>
    </behavior>
  </endpointBehaviors>
  <serviceBehaviors>
    <behavior name="ServiceBehaviorName">
      <serviceMetadata httpGetEnabled="true" />
      <serviceDebug includeExceptionDetailInFaults="true" />
    </behavior>
  </serviceBehaviors>
</behaviors>
<extensions>
  <behaviorExtensions>
    <!-- Declare that we have an extension called WSDL Extras-->
    <add name="wsdlExtensions" type="WCFExtras.Wsdl.WsdlExtensionsConfig, WCFExtras, Version=1.0.0.0, Culture=neutral, PublicKeyToken=null"/>
  </behaviorExtensions>
</extensions>
        </system.serviceModel> 
```

step5\. also important to note that if you add reference by this URL `"https://sslLoadBalancer/ServiceName.svc"` then it will not work, always remember to add reference as: `"https://sslLoadBalancer/ServiceName.svc?wsdl"` this way you will be able to add reference to your application.

Thats it... if still not works then let me know, I will paste the full web.config file..

Thanks

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-03-28T05:57:42.033

如果您在现有服务之上添加 SSL，它可能还会影响 WCF 客户端的绑定安全模式，您可以轻松覆盖该模式。

对于 WSDL，您为什么不直接下载文件，将 URL 更改为您想要的任何内容，然后手动将它们发布为文件？

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2009-03-30T13:16:52.913

I got a great tip that setting the address attribute on the endpoint to the url you wish to display in the WSDL and then add a listenUri attribute to the endpoint with the actual Uri to listen on would do the trick.

The Url in the test page does not get affected (i.e it will still show the address specified in the ListenUri) but within the WSDL the correct Uri will be set (the one specified in the address.

Most annoyingly, though - when I tried this shortly after I posted the question, I could not get it to work within IIS, only when self hosting in a console app; checking myself today I found that it does indeed work; so now I'm not sure why it didn't work for me before;

What we have done in the mean time is buid a simple custom behaviour that changed the service description putting the address required in the WSDL from configurtion; obviously if there's built in support for that it's much better, so I will hopfully get some time next week to look into this further.

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2009-06-02T16:08:42.177

To your service class add the attribute:

```
<ServiceBehavior(AddressFilterMode:=AddressFilterMode.Any)> 
```

This allows the service to be addressed by the client as https://... but the service to be hosted on http://.....

In the web.config of the service host, the endpoint element must have an absolute URL in the address attribute that is the public URL that will be used by the client. In the same endpoint element, set the listenUri attribute to the absolute URL on which the service host is listening. The way I determine what the default absolute URI the host is listening on is is to add a service reference in a client application which points the the physical server where the service is hosted. The web.config of the client will have an address for the service. I then copy that into the listenUri attribute in the hosts web.config.

In your service behavior configuration add the element serviceMetaData with attribute httpGetEnabled=true

So you'll have something like:

```
<serviceBehaviors>
  <behavior name="myBehavior">
    <serviceMetadata httpGetEnabled="true" />
  </behavior
</serviceBehaviors>
...
<services>
  <service name="NamespaceQualifiedServiceClass" behavior="myBehavior" >
    <endpoint address="https://www.sslloadbalancer.com" binding="someBinding" contract="IMyServiceInterface" listenUri="http://www.servicehost.com" ...  />
  </service>
</services> 
```

I am not sure if this works with message security or transport security. For this particular application, the credentials were passed as part of the DataContract so we had basicHttpBinding security mode = none. Since the transport is secure (to the ssl load balancer) there were no security issues.

It is also possible in to leave the listenUri attribute blank, however it must be present.

Unfortunately, there is a bug in WCF where the the base address of imported schemas in the WSDL have the listenUri base address rather than the public base address (the one configured using the address attribute of the endpoint). To work around that issue, you need to create an IWsdlExportExtension implementation which brings the imported schemas into the WSDL document directly and removes the imports. An example of this is provided here [http://winterdom.com/2006/10/inlinexsdinwsdlwithwcf](http://winterdom.com/2006/10/inlinexsdinwsdlwithwcf). Additionally you can have the example class inherit from BehaviorExtensionElement and complete the two new methods with:

```
Public Overrides ReadOnly Property BehaviorType() As System.Type
    Get
        Return GetType(InlineXsdInWsdlBehavior)
    End Get
End Property

Protected Overrides Function CreateBehavior() As Object
    Return New InlineXsdInWsdlBehavior()
End Function 
```

This will allow you to add an extension behavior in the .config file and add the behavior using configuration rather than having to create a service factory.

under the system.servicemodel configuration element add:

```
 <endpointBehaviors>
    <behavior name="SSLLoadBalancerBehavior">          
      <flattenXsdImports/>
    </behavior>
  </endpointBehaviors>
        </behaviors>
<extensions>
  <behaviorExtensions>
    <!--The full assembly name must be specified in the type attribute as of WCF 3.5sp1-->
    <add name="flattenXsdImports" type="Org.ServiceModel.Description.FlattenXsdImportsEndpointBehavior, Org.ServiceModel, Version=1.0.0.0, Culture=neutral, PublicKeyToken=null"/>        
  </behaviorExtensions>
</extensions> 
```

And then reference the new endpoint behavior in your endpoint configuration using the behaviorConfiguration attribute

```
<endpoint address="" binding="basicHttpBinding" contract="WCFWsdlFlatten.IService1" behaviorConfiguration="SSLLoadBalancerBehavior"> 
```

# html - 如何将 HTML 字符转换为 iPhone 上的等效字符？

> ID：634538
> 
> 赞同：0
> 
> 时间：2009-03-11T13:36:06.847
> 
> 标签：html, xml, iphone

我想转换：

```
&lt;?xml version="1.0"?&gt;
  &lt;Company&gt;
    &lt;CompanyId&gt;5&lt;/CompanyId&gt;
    &lt;Name&gt;Acme Inc.&lt;/Name&gt;
  &lt;/Company&gt; 
```

至：

```
<?xml version="1.0"?>
  <Company>
    <CompanyId>5</CompanyId>
    <Name>Acme Inc.</Name>
  </Company> 
```

在 iPhone 上。但是我在 iPhone 上找不到任何可用的标准功能，也找不到任何成熟的（开源）库。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-03-11T13:49:20.233

CFXMLCreateStringByUnescapingEntities 会[为](http://developer.apple.com/documentation/CoreFOundation/Reference/CFXMLTreeRef/Reference/reference.html)您工作吗？

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-04-21T01:26:52.247

CFXMLCreateStringByUnescapingEntities 在模拟器上工作正常，但在设备上不行。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-01-20T18:15:55.733

从 GitHub 获取 MWFeedParser，其中一个文件将为您转换所有内容

[https://github.com/mwaterfall/MWFeedParser](https://github.com/mwaterfall/MWFeedParser)

看看这个功能

*   (NSString *)stringByDecodingHTMLEntities;
*   (NSString *)stringByEncodingHTMLEntities;

...这至少应该引导您朝着正确的方向前进

# php - PHP 和 ?? 操作员

> ID：634540
> 
> 赞同：5
> 
> 时间：2009-03-11T13:36:21.323
> 
> 标签：php

就像有些人知道的那样，C# 有一个非常有用`??`的运算符，如果左边的表达式为空，它会计算并返回右边的表达式。它对于提供默认值非常有用，例如：

```
int spaces = readSetting("spaces") ?? 5; 
```

如果`readSetting`找不到`"spaces"`并返回 null，变量`spaces`将保持默认值`5`.

您可以在 JavaScript 和 Ruby 中使用运算符执行几乎相同的`||`操作，如

```
var spaces = readSetting("spaces") || 5; 
```

尽管在这种情况下你不能在 JavaScript 中以及在 Ruby 和 JavaScript 中都具有`0`as 的值。`spaces``false`

PHP 有`or`运算符，虽然它`||`在某种意义上不起作用，因为它不会从右侧返回表达式，但它在这里仍然很有用：

```
$spaces = readSetting('spaces') or $spaces = 5; 
```

请注意，除了大多数语言之外，and`""`在PHP 中`"0"`也被视为类似。`false``false, 0``null`

问题是，我应该使用上面的结构吗？除了将大类字符视为错误之外，它是否有副作用？PHP社区通常使用和推荐这项任务的更好的构造吗？

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2009-03-11T13:50:40.697

在这种情况下更明确是个好主意，尤其是在 PHP 中，因为它有一些令人困惑的类型转换规则（例如，正如您所指出的，“0”是错误的）。

如果你想严格，让你的函数`readSettings`返回正确的设置，或者如果没有找到设置，则返回一个明确定义的值，例如`null`. 然后你应该把它用作：

```
$spaces = readSettings('spaces');
if (null === $spaces) {
    $spaces = 5;
} 
```

如果您想更慷慨并且只希望 $spaces 不为空，请使用：

```
$spaces = readSettings('spaces');
if (empty($spaces)) {    // or:  if (!$spaces) {
    $spaces = 5;
} 
```

您可以通过第二次函数调用或丑陋的构造来缩短它（不推荐）：

```
$spaces = readSettings('space') ? readSettings('space') : 5;
$spaces = ($x = readSettings('space')) ? $x : 5;  // UGLY! 
```

但请注意，您是否想`0`成为 ! 的有效值`$spaces`！

来自[Python 之禅](http://www.python.org/dev/peps/pep-0020/)：

> 显式优于隐式。

在你的情况下，我建议只添加第二个`$default`参数`readSettings()`：

```
function readSettings($key, $default=null) {
    return isset($settings[$key]) ? $settings[$key] : $default;
}

$spaces = readSettings('spaces', 5); 
```

* * *

## 回答 #2

> 赞同：6
> 
> 时间：2009-03-11T13:58:48.243

PHP 5.3.0 提供了一个较短的三元运算符 condition?true:false 版本，如下所示：

```
$spaces = readSettings('spaces') ?: 5;
```

请注意，PHP 5.3.0 仍处于测试阶段，尚未准备好生产（虽然它已经是一个候选版本），但它也提供了许多新的很酷的东西，比如 lambda 函数和命名空间，所以绝对值得一试！

这是一篇很好地描述了新功能的文章：

[http://www.sitepoint.com/article/whats-new-php-5-3/](http://www.sitepoint.com/article/whats-new-php-5-3/)

* * *

## 回答 #3

> 赞同：4
> 
> 时间：2009-03-11T13:55:33.307

这个怎么样？

```
$spaces = ($tmp=readSettings('space')) ? $tmp : 5; 
```

或者，更令人困惑但只使用一个变量：

```
$spaces = ($spaces=readSettings('space')) ? $spaces : 5; 
```

* * *

## 回答 #4

> 赞同：4
> 
> 时间：2017-10-02T15:13:02.640

PHP 7 现在支持 ?? 作为*Null 合并运算符*

> 已添加空合并运算符 (??) 作为语法糖，用于需要将三元组与 isset() 结合使用的常见情况。如果存在且不为 NULL，则返回其第一个操作数；否则返回第二个操作数。

```
<?php 
// Fetches the value of $_GET['user'] and returns 'nobody' 
// if it does not exist. 
$username = $_GET['user'] ?? 'nobody'; 
// This is equivalent to: 
$username = isset($_GET['user']) ? $_GET['user'] : 'nobody';

// Coalescing can be chained: this will return the first 
// defined value out of $_GET['user'], $_POST['user'], and 
// 'nobody'. 
$username = $_GET['user'] ?? $_POST['user'] ?? 'nobody'; 
?> 
```

[http://php.net/manual/en/migration70.new-features.php](http://php.net/manual/en/migration70.new-features.php)

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2009-03-11T13:44:31.163

如果您想保证得到 false 或 null，并且不将“0”之类的内容视为“false”，则可以执行以下操作：

```
$spaces = readSetting('spaces');
if($spaces == null || $spaces === false) $spaces = 5; 
```

PHP 中的[===](http://us2.php.net/manual/en/language.operators.comparison.php)运算符查找相同的匹配项，因此“0”、“”不等于 false。显然，您可能想根据自己的喜好重新设计代码，但您明白了。

# jquery - 试图让 JScrollPane 与 div 元素一起工作

> ID：634541
> 
> 赞同：2
> 
> 时间：2009-03-11T13:36:24.477
> 
> 标签：jquery, html, css, jscrollpane

任何人都可以让 JScrollPane 与 JQuery 一起工作吗？

我按照信中的说明进行操作，所发生的只是页面加载时，调用只是隐藏了浏览器的滚动条，但不呈现自定义滚动条。

测试 HTML 页面中包含的文件：

[http://70.85.188.226/_assets/css/jscrollpane.css](http://70.85.188.226/_assets/css/jscrollpane.css)

[http://70.85.188.226/_assets/js/jquery-1.2.3.min.js](http://70.85.188.226/_assets/js/jquery-1.2.3.min.js)

[http://70.85.188.226/_assets/js/jscrollpane.js](http://70.85.188.226/_assets/js/jscrollpane.js)

HTML：

```
<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8" />
<title>Untitled Document</title>
<link rel="stylesheet" type="text/css" href="/_assets/css/jscrollpane.css" media="screen,projection,print" />  
<script type="text/javascript" src="/_assets/js/jquery-1.2.3.min.js"></script>
<script type="text/javascript" src="/_assets/js/jscrollpane.js"></script> 
<style type="text/css">
#test
{
    width:400px;
    height:300px;
    overflow:auto;
    background-color:#2b2b2b;
    color:#ffffff;
}
</style>
<script type="text/javascript">
    $(function()
    {
        $('#test').jScrollPane();
    });
</script>
</head>
<body>
<div id="test">
    <div style="height:36px;">TEST</div>
    <div style="clear:both;"></div>
    <div style="height:36px;">TEST</div>
    <div style="clear:both;"></div>
    <div style="height:36px;">TEST</div>
    <div style="clear:both;"></div>
    <div style="height:36px;">TEST</div>
    <div style="clear:both;"></div>
    <div style="height:36px;">TEST</div>
    <div style="clear:both;"></div>
    <div style="height:36px;">TEST</div>
    <div style="clear:both;"></div>
    <div style="height:36px;">TEST</div>
    <div style="clear:both;"></div>
    <div style="height:36px;">TEST</div>
    <div style="clear:both;"></div>
    <div style="height:36px;">TEST</div>
    <div style="clear:both;"></div>
    <div style="height:36px;">TEST</div>
    <div style="clear:both;"></div>
    <div style="height:36px;">TEST</div>
    <div style="clear:both;"></div>
    <div style="height:36px;">TEST12</div>
    <div style="clear:both;"></div>
</div>
</body>
</html> 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2009-05-11T02:41:12.213

检查 jScrollPane JavaScript 文件的第 50 行。

```
if (percentInView < .99) { 
```

这给我带来了一个问题，

我想`console.log()`它的价值，它总是返回超过 0.99，所以它从来没有添加滚动元素。我预测这可能与我的 CSS 设置方式有关。我建议查看您的 CSS。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2010-03-10T10:29:24.763

这可能是因为您缺少测试 div 所需的类声明。

要应用 jScrollPane，您必须将测试 div 的类设置为“滚动窗格”。

# git - 尽管存在差异，但 Git 合并报告“已经是最新的”

> ID：634546
> 
> 赞同：350
> 
> 时间：2009-03-11T13:36:54.130
> 
> 标签：git, merge

我有一个带有 2 个分支的 git 存储库：master 和 test。

主分支和测试分支之间存在差异。

两个分支都提交了所有更改。

如果我做：

```
git结账大师

git 差异测试

```

出现一个充满变化的屏幕，显示差异。我想合并测试分支中的更改，所以这样做：

```
git 合并测试
```

但收到消息“已经是最新的”

但是，检查每个不同分支下的文件清楚地显示出差异。

这里有什么问题，我该如何解决？

* * *

## 回答 #1

> 赞同：194
> 
> 时间：2009-03-11T13:45:52.067

消息“Already up-to-date”表示您尝试合并的分支中的所有更改都已合并到您当前所在的分支。更具体地说，这意味着您尝试合并的分支*是您当前分支的父级*。恭喜，这是你做过的最简单的合并。:)

用于`gitk`查看您的存储库。“test”分支的标签应该在“master”分支标签的下方。

您的分支相对于其父分支是最新的。根据合并，自上次合并以来，父级没有新的变化。这并不意味着分支是相同的，因为您可以在您的工作分支中进行大量更改，而且听起来确实如此。

2019 年 10 月 12 日编辑：

根据 Charles Drake 在对此答案的评论中，解决问题的一种解决方案是：

```
git checkout master
git reset --hard test 
```

这使它回到“测试”级别。

然后做：

```
git push --force origin master 
```

为了强制更改回到中央回购。

* * *

## 回答 #2

> 赞同：169
> 
> 时间：2013-11-23T12:17:03.843

当我知道远程主机上有更改时，这经常发生在我身上，所以我尝试使用`git merge master`. 但是，这不会与远程主机合并，而是与您的本地主机合并。

所以在做合并之前，checkout master，然后`git pull`就在那里。然后，您将能够将新更改合并到您的分支中。

* * *

## 回答 #3

> 赞同：55
> 
> 时间：2015-01-07T15:33:11.447

`master`假设您有一个具有以下提交历史的分支：

```
A -- B -- C -- D
```

现在，您创建一个分支测试，对其进行处理，并进行 4 次提交：

```
 E -- F -- G -- H
                /
A -- B -- C -- D 
```

`master`的头指向 D，`test`的头指向 H。

当您要合并到的分支的 HEAD 是您要合并的分支的提交链的父级时，会显示“已经是最新的”消息。就是这样，这里：`D`是 的父级`E`。

没有什么可以从 to 合并`test`，`master`因为从那以后没有任何变化`master`。您在这里要做的就是告诉 Git 让`master`' 的头指向 H，因此 master 的分支具有以下提交历史记录：

```
A -- B -- C -- D -- E -- F -- G -- H
```

这是 Git 命令的工作**`reset`**。您还希望工作目录反映此更改，因此您将进行*硬*重置：

```
git reset --hard H
```

* * *

## 回答 #4

> 赞同：31
> 
> 时间：2017-11-02T11:11:20.990

这对我有用。假设您有`branch1`并且想要将其合并到`branch2`.

您打开 git 命令行转到 branch2 的根文件夹并键入：

```
git checkout branch1
git pull branch1
git checkout branch2
git merge branch1
git push 
```

如果您有冲突，请先解决它们`git push`。

* * *

## 回答 #5

> 赞同：14
> 
> 时间：2018-07-18T04:26:49.067

`git merge origin/master`而是`git merge master`为我工作。因此，要将 master 合并到功能分支中，您可以使用：

```
git checkout feature_branch
git merge origin/master 
```

* * *

## 回答 #6

> 赞同：12
> 
> 时间：2018-10-11T12:00:51.420

请务必先签出要合并的分支，然后再将其拉出（以便您的本地版本与远程版本匹配）。

然后结帐到您想要进行合并的分支，您的 git merge 应该可以工作。

* * *

## 回答 #7

> 赞同：6
> 
> 时间：2009-03-11T13:47:16.460

> 合并总是在当前 HEAD 和一个或多个提交（通常是分支头或标签）之间进行，
> 并且索引文件在开始时必须与 HEAD 提交的树（即最后一次提交的内容）匹配。
> 换句话说，`git diff --cached HEAD`必须报告没有变化。
> 
> 合并的提交已经包含在`HEAD`. 这是最简单的情况，称为“Already up-to-date”。

这应该意味着 test 中的提交已经合并到 master 中，但是由于其他提交是在 master 上完成的，`git diff test`因此仍然会产生一些差异。

* * *

## 回答 #8

> 赞同：6
> 
> 时间：2018-04-19T15:30:30.527

发生这种情况是因为您要合并的分支的本地副本已过期。我有我的分支，调用`MyBranch`并且我想将它合并到`ProjectMaster`.

```
_>git status
On branch MyBranch-Issue2
Your branch is up-to-date with 'origin/MyBranch-Issue2'.

nothing to commit, working tree clean

_>git merge ProjectMaster
Already up-to-date. 
```

但**我知道**有一些变化需要合并！

事情是这样的，当我输入 时`git merge ProjectMaster`，git会查看**这个分支的本地副本，这可能不是 current**。要查看是否是这种情况，我首先告诉 Git 检查并查看我的分支是否已过期，如果是，则使用 .uh, 获取任何更改`fetch`。然后我跳到我想合并的分支，看看那里发生了什么......

```
_>git fetch origin

_>git checkout ProjectMaster
Switched to branch ProjectMaster
**Your branch is behind 'origin/ProjectMaster' by 85 commits, and can be fast-forwarded.**
  (use "git pull" to update your local branch) 
```

啊哈！我的本地副本已经过时了 85 次提交，这说明了一切！现在，我`Pull`记下我缺少的更改，然后跳到`MyBranch`并再次尝试合并。

```
_>git pull
Updating 669f825..5b49912
Fast-forward

_>git checkout MyBranch-Issue2
Switched to branch MyBranch-Issue2
Your branch is up-to-date with 'origin/MyBranch-Issue2'.

_>git merge ProjectMaster
Auto-merging Runbooks/File1.ps1
CONFLICT (content): Merge conflict in Runbooks/Runbooks/File1.ps1

Automatic merge failed; fix conflicts and then commit the result. 
```

现在我有另一个问题要解决...

* * *

## 回答 #9

> 赞同：5
> 
> 时间：2014-10-26T19:24:04.667

这发生在我身上，因为奇怪的是 GIT 认为本地分支与远程分支不同。这在分支图中是可见的：它显示了两个不同的分支：remote/origin/branch_name 和 branch_name。

解决方案只是删除本地 repo 并从远程重新克隆它。这样 GIT 就会明白 remotes/origin/branch_name> 和 branch_name 确实是相同的，我可以发出`git merge branch_name`.

```
rm <my_repo>
git clone <my_repo>
cd <my_repo>
git checkout <branch_name>
git pull
git checkout master
git merge <branch_name> 
```

* * *

## 回答 #10

> 赞同：4
> 
> 时间：2016-10-10T17:14:00.870

发生在我身上并被发送到这个页面，不确定我是否有同样的场景，但我是我试图“重新合并”那个“测试”分支。

所以我之前合并了它，但我故意在合并过程中排除了一些特定的变化，所以它显然在分支之间有一些差异。然后我试图重新合并它，因为我意识到/忘记了我应该拥有并且想要添加我之前排除的特定更改/文件，我希望如果我再次合并会显示我之前排除的所有更改，但我错了，而是收到“已经是最新的”消息。

在阅读@Bombe 的评论/答案后，他是对的，我认为 git 的行为是这样的，所以我所做的是对测试分支上的文件进行硬备份，然后签出 master 分支并手动将文件粘贴到其中并提交好像是新的变化。

我不确定这是否是正确的方法或可以帮助其他人遇到同样的问题，但它确实为我的特殊情况提供了解决方案。

* * *

## 回答 #11

> 赞同：3
> 
> 时间：2015-03-13T14:29:34.857

如果将分支 A 合并到分支 B 报告“已经是最新的”，则反向并不总是正确的。仅当分支 B 是分支 A 的后代时才成立，否则分支 B 可以具有不在 A 中的更改。

例子：

1.  您从 master 创建分支 A 和 B
2.  您在 master 中进行了一些更改，并将这些更改仅合并到分支 B（不更新或忘记更新分支 A）。
3.  您在分支 A 中进行了一些更改并将 A 合并到 B。

此时将 A 合并到 B 报告“已经是最新的”，但分支不同，因为分支 B 有来自 master 的更新，而分支 A 没有。

* * *

## 回答 #12

> 赞同：2
> 
> 时间：2015-04-16T18:49:07.790

使用 Git Bash 面对这种情况。

我们的存储库有多个分支，每个分支都有不同的提交周期，合并偶尔发生一次。Old_Branch 被用作 New_Branch 的父级

Old_Branch 更新了一些需要与 New_Branch 合并的更改

在没有任何分支的情况下使用以下拉取命令从所有分支获取所有源。

> git 拉取原点

奇怪的是，这并没有从所有分支中提取所有提交。曾这样认为，因为指示显示了几乎所有分支和标签。

因此，为了解决这个问题，检查了 Old_Branch 提取了最新的使用

> git checkout Old_Branch
> 
> git pull origin Old_Branch

现在签出了 New_Branch

> git checkout New_Branch

拉它以确保

> git pull origin New_Branch
> 
> git 合并 Old_Branch

中提琴从 Old_Branch 到 New_Branch 有冲突需要修复 :) 这是预期的

* * *

## 回答 #13

> 赞同：1
> 
> 时间：2018-11-19T10:58:18.050

我有同样的问题。我在遥控器中进行了更改，它仍然显示“已经是最新的”。重新克隆存储库为我解决了这个问题。

* * *

## 回答 #14

> 赞同：0
> 
> 时间：2014-12-17T10:25:52.190

同样的事情发生在我身上。但是情况有点不同，我有 master 分支，我从中雕刻出了 release_1（比如说）。在 release_1 分支中进行了一些更改并将其合并到 origin。然后我做了 ssh 并在远程服务器上再次使用命令 git checkout -b release_1 签出 release_1 - 这实际上开辟了一个新的分支 release_！从 master 而不是从 origin 签出已经存在的分支 release_1。通过删除“-b”开关解决了问题

* * *

## 回答 #15

> 赞同：0
> 
> 时间：2020-05-25T07:49:08.457

愚蠢，但它可能会发生。假设您的分支名称以问题参考为前缀（例如`#91-fix-html-markup`），如果您执行此合并：

```
$ git merge #91-fix-html-markup 
```

它不会按预期工作，因为之后的所有内容都会`#`被忽略，因为会`#`启动内联注释。

在这种情况下，您可以重命名分支省略`#`或使用单引号将分支名称括起来：`git merge '#91-fix-html-markup'`。

* * *

## 回答 #16

> 赞同：0
> 
> 时间：2021-06-02T13:47:10.277

我在当前分支中提交了更改，然后来自 Origin 分支的合并工作。

* * *

## 回答 #17

> 赞同：0
> 
> 时间：2021-08-17T08:10:33.393

我已经解决了这样的问题，将当前分支重新建立在自身的基础上。

* * *

## 回答 #18

> 赞同：0
> 
> 时间：2021-10-11T19:51:39.583

我不确定我的情况到底是什么问题，但问题的根源似乎是在`branchB`签出后，我无法从`branchA`...中提取最新更改

我必须结帐`branchA`，`pull`然后`checkout branchB`才能`merge branchA`按预期工作。

* * *

## 回答 #19

> 赞同：0
> 
> 时间：2022-01-24T14:22:09.193

尝试以下命令

```
git checkout master
git pull
git fetch --all
git rebase --abort

git checkout test
git pull
git reset --hard  
git merge origin master 
```

大多数情况下，使用 rebase 或已经采用合并分支具有阴影历史记录，清除或重置分支将有助于在文件中获取合并内容。

# db2 - DB2 双数据类型

> ID：634551
> 
> 赞同：2
> 
> 时间：2009-03-11T13:38:20.353
> 
> 标签：db2

在我的 DB2 表中，我看到列数据类型是长度 8 的两倍。

此列有多少小数精度？

（还有另一种数据类型 DECIMAL，我可以在其中指定长度 8 和精度）

双倍呢？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2009-03-11T14:25:48.193

另一点信息（与 DrJokepu 的答案相比）是因为它是 IEEE 754 双精度，你可以获得大约 16 个（有些人会声称 17 个）十进制数字。但是，请注意浮点精度的所有问题。一般来说，在会计包中使用 DOUBLE 来表示货币数量是个坏主意（但对于像美国预算这样的幻想游戏来说可能没问题，因为平衡并不重要）。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2009-03-11T13:42:56.097

根据[DB2 参考](http://publib.boulder.ibm.com/infocenter/db2luw/v8//topic/com.ibm.db2.udb.doc/admin/r0008469.htm)：

> **双精度浮点数（DOUBLE 或 FLOAT）**
> 
> 双精度浮点数是实数的 64 位近似值。该数字可以为零或范围从 -1.79769E+308 到 -2.225E-307，或从 2.225E-307 到 1.79769E+308。

# vb.net - dotNet 互操作用户控件的默认属性

> ID：634559
> 
> 赞同：1
> 
> 时间：2009-03-11T13:41:06.257
> 
> 标签：vb.net, vb6, com-interop

我需要设置 VB6 应用程序使用的 dotNet 控件的默认属性。

```
<ComClass(myControl.ClassId, myControl.InterfaceId, myControl.EventsId)> _
<DefaultProperty("NewProperty")> _
Public Class myControl

    Public Const ClassId As String = "86252de2-ca87-4468-adbe-ad7c47747759"
    Public Const InterfaceId As String = "c1cbf1a1-24bb-46c3-88a4-813eb4917845"
    Public Const EventsId As String = "954ed890-011c-4908-ab33-610159fe6eb1"

    Private newPropertyValue As String
    Public Property NewProperty() As String
        Get
            Return newPropertyValue
        End Get
        Set(ByVal value As String)
            newPropertyValue = value
        End Set
    End Property
End Class 
```

DefualtProperty 属性不能解决问题。

我在[这里](https://stackoverflow.com/questions/299251/exposing-the-indexer-default-property-via-com-interop)读到手动将 DispId 设置为零应该可以解决问题。但如果我这样做：

```
<DispId(0)> Public Property NewProperty() As String 
```

Visual Basic 好心地通知我 DispId 零是为 DefaultProperty 保留的。是的。我知道。我要那个。但是怎么做？

编辑：

```
Default Public Property NewProperty(ByVal foo As Integer) As String 
```

确实可以工作，因为该属性现在显示为 VB6 中的默认属性。但这不会解决我的问题，因为有些代码我无法更改，它会执行以下操作：

```
aStringVariable = myUserControlInstance 
```

[这篇 MSDN 文章](http://msdn.microsoft.com/en-us/library/h7bfkxc1(VS.71).aspx)有一些关于此的信息。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-03-11T15:37:14.357

> 因为有我无法更改的代码

如果是这种情况，那么您需要围绕原始 .NET 类创建一个包装类，并将其导出为 VB6 使用的控件。然后您可以将默认属性标记为使用默认关键字。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-06-29T19:57:58.470

除了在 VB6 中创建一个包装器来模仿 VB6 的默认属性行为之外，别无他法。我不得不创建几个互操作用户控件，这是我们必须在 VB6 中再次包装一个 .Net 互操作控件的主要原因（以避免大量代码更改和大量测试工作）。

# java - 如何从 Java 打开 Windows 命名管道？

> ID：634564
> 
> 赞同：28
> 
> 时间：2009-03-11T13:42:08.470
> 
> 标签：java, windows, named-pipes

在我们的 Linux 系统上，我们使用命名管道进行进程间通信（生产者和消费者）。

为了测试消费者（Java）代码，我想（在Java中）实现一个虚拟生产者，它写入连接到消费者的命名管道。

现在测试也应该在 Windows 开发环境中工作。因此，我想知道如何在 Windows 中从 Java 创建命名管道。在 Linux 中我可以使用 mkfifo（称为 using `Runtime.exec()`），但在 Windows 上我应该如何做到这一点？

* * *

## 回答 #1

> 赞同：28
> 
> 时间：2010-04-09T08:04:07.513

[使用命名管道在 Java 和 .Net 进程之间进行通信](http://v01ver-howto.blogspot.com/2010/04/howto-use-named-pipes-to-communicate.html)

链接中的相关部分

```
try {
  // Connect to the pipe
  RandomAccessFile pipe = new RandomAccessFile("\\\\.\\pipe\\testpipe", "rw");
  String echoText = "Hello word\n";
  // write to pipe
  pipe.write ( echoText.getBytes() );
  // read response
  String echoResponse = pipe.readLine();
  System.out.println("Response: " + echoResponse );
  pipe.close();
} catch (Exception e) {
  // TODO Auto-generated catch block
  e.printStackTrace();
} 
```

* * *

## 回答 #2

> 赞同：10
> 
> 时间：2009-03-11T13:55:34.617

在 Windows 中，[存在命名管道，](http://msdn.microsoft.com/de-de/library/aa365780(en-us).aspx)但它们[不能作为可写文件系统中的文件创建，](http://en.wikipedia.org/wiki/Named_pipe#Named_pipes_in_Windows)并且没有命令行工具。它们存在于一个特殊的文件系统中，只能使用 Win32 API 创建。

看起来你必须求助于本机代码，或者从管道切换到 IPC 的套接字——这可能是最好的长期解决方案，因为它更便携。

* * *

## 回答 #3

> 赞同：4
> 
> 时间：2018-01-08T11:14:49.797

您可以使用 JNA 库[https://github.com/java-native-access/jna创建命名管道](https://github.com/java-native-access/jna)

它清楚地显示在以下测试中：[https ://github.com/java-native-access/jna/blob/master/contrib/platform/test/com/sun/jna/platform/win32/Kernel32NamedPipeTest.java](https://github.com/java-native-access/jna/blob/master/contrib/platform/test/com/sun/jna/platform/win32/Kernel32NamedPipeTest.java)

JNA 包装器的 API 与 Win32 相同，因此您将能够在 Windows 上使用命名管道的所有功能和功能。

* * *

## 回答 #4

> 赞同：2
> 
> 时间：2013-03-20T12:13:14.283

**在 Java 中读取和写入现有的**命名管道是非常可能的。据我所知，您不能在 Windows 环境中创建命名管道。Linux 是一个不同的故事，因为命名管道可以像文件一样被创建和使用。

与现有管道交互的相关链接：http: [//v01ver-howto.blogspot.com/2010/04/howto-use-named-pipes-to-communicate.html](http://v01ver-howto.blogspot.com/2010/04/howto-use-named-pipes-to-communicate.html)

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2011-06-16T16:16:11.387

也许可以使用 cygwin 命名管道——如果你所有的进程都是 cygwin。

# sql - 如何获得列字段的两行之间的差异？

> ID：634568
> 
> 赞同：61
> 
> 时间：2009-03-11T13:43:53.350
> 
> 标签：sql, sql-server, tsql, sql-server-2005

我有一张这样的桌子：

```
rowInt  Value
2       23
3       45
17      10
9       0
.... 
```

列 rowInt 值是整数，但不是具有相同增量的序列。我可以使用以下 sql 按 rowInt 列出值：

```
SELECT * FROM myTable ORDER BY rowInt; 
```

这将按 rowInt 列出值。如何获得两行之间的值差异，结果如下：

```
rowInt   Value Diff
2        23    22    --45-23
3        45    -35   --10-45
9        0     -45   --0-45
17       10    10    -- 10-0
.... 
```

该表位于 SQL 2005 (Miscrosoft) 中

* * *

## 回答 #1

> 赞同：60
> 
> 时间：2009-03-11T13:50:55.830

```
SELECT
   [current].rowInt,
   [current].Value,
   ISNULL([next].Value, 0) - [current].Value
FROM
   sourceTable       AS [current]
LEFT JOIN
   sourceTable       AS [next]
      ON [next].rowInt = (SELECT MIN(rowInt) FROM sourceTable WHERE rowInt > [current].rowInt) 
```

***编辑：***

考虑一下，在选择中使用子查询（ala Quassnoi 的答案）可能会更有效。我会试用不同的版本，并查看执行计划，看看哪个版本在您拥有的数据集大小上表现最佳......

***编辑2：***

我仍然看到这获得了选票，尽管不太可能有很多人仍然使用 SQL Server 2005。

如果您可以访问诸如 之类的窗口函数`LEAD()`，请改用它...

```
SELECT
  RowInt,
  Value,
  LEAD(Value, 1, 0) OVER (ORDER BY RowInt) - Value
FROM
  sourceTable 
```

* * *

## 回答 #2

> 赞同：28
> 
> 时间：2009-03-11T13:50:20.557

```
SELECT rowInt, Value,
       COALESCE(
       (
       SELECT TOP 1 Value
       FROM myTable mi
       WHERE mi.rowInt > m.rowInt
       ORDER BY
             rowInt
       ), 0) - Value AS diff
FROM  myTable m
ORDER BY
      rowInt 
```

* * *

## 回答 #3

> 赞同：18
> 
> 时间：2016-10-04T19:50:09.970

SQL Server 2012 及更高版本支持[LAG](https://docs.microsoft.com/en-us/sql/t-sql/functions/lag-transact-sql) / [LEAD](https://docs.microsoft.com/en-us/sql/t-sql/functions/lead-transact-sql)函数来访问前一行或后一行。SQL Server 2005 不支持此功能（在 SQL2005 中，您需要连接或其他东西）。

此数据的 SQL 2012 示例

```
/* Prepare */
select * into #tmp
from
(
    select 2  as rowint,      23 as Value
    union select 3,       45
    union select 17,      10
    union select 9,       0
) x

/* The SQL 2012 query */
select rowInt, Value, LEAD(value) over (order by rowInt) - Value  
from #tmp 
```

LEAD(value) 将根据“over”子句中的给定顺序返回下一行的值。

* * *

## 回答 #4

> 赞同：12
> 
> 时间：2009-03-12T01:34:26.433

如果您真的想确定订单，请使用“Row_Number()”并比较当前记录的下一条记录（仔细查看“on”子句）

```
T1.ID + 1 = T2.ID 
```

您基本上将下一行与当前行连接起来，而不指定“min”或执行“top”。如果您有少量记录，“Dems”或“Quassanoi”的其他解决方案将可以正常工作。

```
with T2 as (
    select  ID = ROW_NUMBER() over (order by rowInt),
            rowInt, Value
    from    myTable
)
select  T1.RowInt, T1.Value, Diff = IsNull(T2.Value, 0) - T1.Value
from    (   SELECT  ID = ROW_NUMBER() over (order by rowInt), *
            FROM    myTable ) T1
        left join T2 on T1.ID + 1 = T2.ID
ORDER BY T1.ID 
```

* * *

## 回答 #5

> 赞同：4
> 
> 时间：2009-03-12T01:39:10.993

SQL Server 是否支持分析函数？

```
select   rowint,
         value,
         value - lag(value) over (order by rowint) diff
from     myTable
order by rowint
/ 
```

* * *

## 回答 #6

> 赞同：1
> 
> 时间：2009-11-23T12:02:26.593

```
select t1.rowInt,t1.Value,t2.Value-t1.Value as diff
from (select * from myTable) as t1,
     (select * from myTable where rowInt!=1
      union all select top 1 rowInt=COUNT(*)+1,Value=0 from myTable) as t2
where t1.rowInt=t2.rowInt-1 
```

* * *

## 回答 #7

> 赞同：1
> 
> 时间：2016-05-27T17:09:02.597

查询以查找单列的 2 行之间的日期差异

```
SELECT
Column name,
DATEDIFF(
(SELECT MAX(date) FROM table name WHERE Column name < b. Column name),
Column name) AS days_since_last
FROM table name AS b 
```

* * *

## 回答 #8

> 赞同：1
> 
> 时间：2019-07-22T11:38:21.827

我只是为此做一个小功能。折腾两个值，您需要知道它们之间的差异，并让它从较大的值中减去较小的值。就像是：

```
CREATE FUNCTION [dbo].[NumDifference] 
    (   @p1 FLOAT,
        @p2 FLOAT )
RETURNS FLOAT
AS
BEGIN
    DECLARE @Diff FLOAT
    IF @p1 > @p2 SET @Diff = @p1 - @p2 ELSE SET @Diff = @p2 - @p1
    RETURN @Diff
END 
```

在查询中获取 a 列和 b 列之间的差异：

```
SELECT a, b, dbo.NumDifference(a, b) FROM YourTable 
```

# .net - 反射是逆向工程吗？

> ID：634573
> 
> 赞同：8
> 
> 时间：2009-03-11T13:44:32.600
> 
> 标签：.net, reflection, reverse-engineering

您可以通过反射找到有关应用程序内部的大量信息，它由 .NET BCL（基类库）公开，并且可以轻松检索任何 .NET 方法的实际 IL。

[维基百科](http://en.wikipedia.org/wiki/Reverse_engineering)上的逆向工程：

> 逆向工程是通过分析设备、对象或系统的结构、功能和操作来发现其技术原理的过程。

反射肯定会满足结构分析。但是你在哪里划清内省和实际逆向工程之间的界限呢？从法律的角度来看，反射是逆向工程吗？

* * *

## 回答 #1

> 赞同：8
> 
> 时间：2009-03-11T13:51:36.060

两者之间的界限似乎很模糊。从道德上讲，我会在程序员的动机中划清界限。

如果他使用反射来构建一个库、工具或类似软件，该库、工具或类似软件应该与满足某些标准的任何第 3 方代码交互，我不会将其视为逆向工程。

例如，我最近正在为 Linq2SQL 数据层编写一个通用基类。基类使用反射来深入了解数据库布局并正确处理嵌套业务实体的更新。如果其他人将我的基类用于他的 Web 应用程序，我将不会获得有关他的源代码的任何知识。这种反射的使用当然不是逆向工程。

另一方面，如果程序员试图使用反射来理解竞争对手软件的内部工作原理，那么他就是在对其进行逆向工程。

* * *

## 回答 #2

> 赞同：6
> 
> 时间：2009-03-11T13:52:17.090

当轻松反编译语言的能力是语言 ala 反射的一部分时，人们必须质疑*逆向工程的定义。*

使用[.NET Reflector](http://www.red-gate.com/products/reflector/)之类的工具，我觉得线条真的开始变得模糊了！

使用来自 SO 本身的示例，他们最近对其 WMD 编辑器[的源代码进行了去混淆处理。](https://blog.stackoverflow.com/2009/01/wmd-editor-reverse-engineered/)我认为这比反射更能定义逆向工程。

* * *

## 回答 #3

> 赞同：4
> 
> 时间：2009-03-11T15:01:32.820

反射只是从程序集中读取信息的工具，因此它本身并不是逆向工程。

如果您随后使用此信息来了解程序集是如何创建的，例如使用 .NET 反射器生成可以生成相同 IL 代码的可读源代码，这就是逆向工程。

* * *

## 回答 #4

> 赞同：3
> 
> 时间：2009-03-11T14:05:53.547

我想说反射只是一种工具。使用反射并不一定意味着逆向工程。

例如，如果您使用反射来发现程序集中所有公共和受保护方法的签名，这并不意味着逆向工程。

至于法律角度，我建议你要看看你担心的法律，才能找到逆向工程的定义。

* * *

## 回答 #5

> 赞同：2
> 
> 时间：2009-03-11T13:56:05.690

反射是一种可用于许多事情的工具，包括代码的逆向工程。反射也可以用于许多其他目的，例如，由于反射，实现动态语言要容易得多。

仅反射也不足以进行逆向工程。您可以通过这种方式找到有关程序结构的信息，但您仍然需要反编译代码。像反射器这样的工具确实添加了这个功能。

* * *

## 回答 #6

> 赞同：2
> 
> 时间：2009-03-11T14:03:21.133

实际上，它与逆向工程正好相反。

正确地，“逆向工程”是查看一个过程的结果，然后向后工作，以确定它是如何到达那里的。通常，它是在不了解原始代码的情况下完成的，并且通常会产生非常不同的过程。

尽管版权所有者发出可怕的威胁，但它是完全合法的。

“反汇编”（又名“反射”）只是读取硬盘上的字节并赋予它们意义的动作。这正是 CPU 在运行代码时所做的事情。在这里，我们只是让它成为人类可读的。同样，尽管版权所有者发出可怕的威胁，但它是完全合法的。

以一种避免版权所有者从他的作品中获利的方式出售他人的代码（或自己使用它）*是*非法的，但我们在这里不谈论这个。

* * *

## 回答 #7

> 赞同：2
> 
> 时间：2009-03-11T15:03:45.747

我认为您在这里谈论的是两件不同的事情：

*   *反射*是一种技术，可用于逆向工程（除其他外）。
*   *逆向工程*是一种可以但不一定必须使用反射来实现其目标的行为。

从法律的角度来看，如果您将反射用于逆向工程，这取决于您的目标。

当然是 IANAL，但我相信逆向工程本身并不违法。*通过代理*，即通过侵犯版权等，它可能成为非法活动。

* * *

## 回答 #8

> 赞同：0
> 
> 时间：2009-03-11T13:50:12.367

不。通过反射，您通常只是在谈论调用方法的不同方式，或者可能查看方法属性。

相比之下，我希望逆向工程的产品能够生成源代码，我可以查看这些源代码来理解作者的算法和想法，这通常是他们试图保护的内容。

* * *

## 回答 #9

> 赞同：0
> 
> 时间：2009-03-11T13:52:54.297

必须向律师询问法律问题。律师收费。如果您因不请律师而被起诉，不聘请律师可能会花费更多的钱。

最好的选择：不需要问。微软已经发布了很多 .NET 的源代码。请参阅[http://www.microsoft.com/resources/sharedsource/default.mspx](http://www.microsoft.com/resources/sharedsource/default.mspx)。

* * *

## 回答 #10

> 赞同：0
> 
> 时间：2009-03-11T13:53:33.140

这完全取决于你反思的程度。如果您使用[Reflector](http://www.red-gate.com/products/reflector/)之类的工具，或者自己编写类似的代码，那么这将是逆向工程，因为您实际上是在获取源代码。

正如 Don 所说，反射可用于调用方法或查看属性，但也可用于分析程序集的结构，甚至可以查看底层 MSIL 代码。所以反射的一种使用可能是无辜的，一种是逆向工程。

* * *

## 回答 #11

> 赞同：0
> 
> 时间：2009-10-17T04:47:05.973

[反射](http://en.wikipedia.org/wiki/Reflection_%28computer_science%29)是一个通用的计算机科学术语，在引入 Microsoft .Net 框架（而不是 SUN JVM）之前已经使用了几十年。这个想法的目的**不是**逆向工程应用。在特定情况下它可以用于此目的只是偶然的。正如其他人所写，反思是一种“工具”。

* * *

## 回答 #12

> 赞同：-2
> 
> 时间：2009-03-11T13:53:21.783

许多语言（如 .NET 和 Java）中的反射是针对不允许您与对象自由交互的不良语法的补丁。

在像 Smalltak 或 Self 这样的真正面向对象的语言中，您几乎不需要反射，如果需要，它比 .NET 和 Java 提供的功能强大得多**。**

话虽如此，我确实相信反射是逆向工程，考虑到 RE 更像是理解代码来做某事而不是破坏其他人的保护。

我目前正在大量使用 Drupal（基于 PHP），它使用丑陋的东西，例如将模块名称连接到预定义的钩子名称以查找该函数是否存在，以便稍后调用它（例如 module_hook_name）。

它非常方便，但我相信真正的 OO 语言可以通过子类化一个可以回答任何消息的抽象类来避免，子类可以覆盖它。

除了极端情况外，不应使用反射，这是您可以看到编程语言缺陷的地方。

# java - 来自 Java 的 CPU 负载

> ID：634580
> 
> 赞同：19
> 
> 时间：2009-03-11T13:48:12.060
> 
> 标签：java, profiling

有没有办法在不使用 JNI 的情况下获取 Java 下的当前 cpu 负载？

* * *

## 回答 #1

> 赞同：26
> 
> 时间：2009-03-11T14:00:53.450

使用[`ManagementFactory`](http://java.sun.com/javase/6/docs/api/java/lang/management/ManagementFactory.html)获取[`OperatingSystemMXBean`](http://java.sun.com/javase/6/docs/api/java/lang/management/OperatingSystemMXBean.html)并调用[`getSystemLoadAverage()`](http://java.sun.com/javase/6/docs/api/java/lang/management/OperatingSystemMXBean.html#getSystemLoadAverage())它。

* * *

## 回答 #2

> 赞同：7
> 
> 时间：2012-08-05T18:21:23.480

**getSystemLoadAverage()**为您提供超过 1 分钟的时间（每秒刷新一次），并为整个操作系统提供此值。应该通过分别监控每个线程来完成更实时的概览。重要的是还要注意监视刷新间隔 - 您更频繁地检查值，在给定时刻更精确，如果您每毫秒执行一次，它通常是 0 或 100（或更多取决于有多少 CPU）。但是，如果我们允许时间范围（例如 1 秒），我们会得到这段时间的平均值，并且我们会得到更多信息量的结果。此外，重要的是要注意，只有一个线程占用一个以上 CPU（核心）的可能性很小。

以下实现允许使用 3 种方法：

*   **getTotalUsage()** - JVM 中所有线程的总负载
*   **getAvarageUsagePerCPU()** - 每个 CPU（核心）的平均负载
*   **getUsageByThread(Thread t)** - 指定线程的总负载

    ```
    import java.lang.management.ManagementFactory;
    import java.lang.management.OperatingSystemMXBean;
    import java.lang.management.ThreadMXBean;
    import java.util.Collection;
    import java.util.HashMap;
    import java.util.HashSet;
    import java.util.Map;
    import java.util.Set;

    public class MonitoringThread extends Thread {

        private long refreshInterval;
        private boolean stopped;

        private Map<Long, ThreadTime> threadTimeMap = new HashMap<Long, ThreadTime>();
        private ThreadMXBean threadBean = ManagementFactory.getThreadMXBean();
        private OperatingSystemMXBean opBean = ManagementFactory.getOperatingSystemMXBean();

        public MonitoringThread(long refreshInterval) {
            this.refreshInterval = refreshInterval;

            setName("MonitoringThread");

            start();
        }

        @Override
        public void run() {
            while(!stopped) {
                Set<Long> mappedIds;
                synchronized (threadTimeMap) {
                    mappedIds = new HashSet<Long>(threadTimeMap.keySet());
                }

                long[] allThreadIds = threadBean.getAllThreadIds();

                removeDeadThreads(mappedIds, allThreadIds);

                mapNewThreads(allThreadIds);

                Collection<ThreadTime> values;
                synchronized (threadTimeMap) {
                    values = new HashSet<ThreadTime>(threadTimeMap.values());    
                }

                for (ThreadTime threadTime : values) {
                    synchronized (threadTime) {
                        threadTime.setCurrent(threadBean.getThreadCpuTime(threadTime.getId())); 
                    }
                }

                try {
                    Thread.sleep(refreshInterval);
                } catch (InterruptedException e) {
                    throw new RuntimeException(e);
                }

                for (ThreadTime threadTime : values) {
                    synchronized (threadTime) {
                        threadTime.setLast(threadTime.getCurrent());    
                    }
                }
            }
        }

        private void mapNewThreads(long[] allThreadIds) {
            for (long id : allThreadIds) {
                synchronized (threadTimeMap) {
                    if(!threadTimeMap.containsKey(id))
                        threadTimeMap.put(id, new ThreadTime(id));
                }
            }
        }

        private void removeDeadThreads(Set<Long> mappedIds, long[] allThreadIds) {
            outer: for (long id1 : mappedIds) {
                for (long id2 : allThreadIds) {
                    if(id1 == id2)
                        continue outer;
                }
                synchronized (threadTimeMap) {
                    threadTimeMap.remove(id1);
                }
            }
        }

        public void stopMonitor() {
            this.stopped = true;
        }

        public double getTotalUsage() {
            Collection<ThreadTime> values;
            synchronized (threadTimeMap) {
                values = new HashSet<ThreadTime>(threadTimeMap.values());    
            }

            double usage = 0D;
            for (ThreadTime threadTime : values) {
                synchronized (threadTime) {
                    usage += (threadTime.getCurrent() - threadTime.getLast()) / (refreshInterval * 10000);
                }
            }
            return usage;
        }

        public double getAvarageUsagePerCPU() {
            return getTotalUsage() / opBean.getAvailableProcessors(); 
        }

        public double getUsageByThread(Thread t) {
            ThreadTime info;
            synchronized (threadTimeMap) {
                info = threadTimeMap.get(t.getId());
            }

            double usage = 0D;
            if(info != null) {
                synchronized (info) {
                    usage = (info.getCurrent() - info.getLast()) / (refreshInterval * 10000);
                }
            }
            return usage;
        }

        static class ThreadTime {

            private long id;
            private long last;
            private long current;

            public ThreadTime(long id) {
                this.id = id;
            }

            public long getId() {
                return id;
            }

            public long getLast() {
                return last;
            }

            public void setLast(long last) {
                this.last = last;
            }

            public long getCurrent() {
                return current;
            }

            public void setCurrent(long current) {
                this.current = current;
            }
        }
    } 
    ```

* * *

## 回答 #3

> 赞同：5
> 
> 时间：2009-03-11T14:39:56.117

这确实涉及 JNI，但 Hyperic 有一个名为[Sigar](http://www.hyperic.com/products/sigar.html)的 GPL 库，它为所有主要平台提供此信息，以及一堆其他依赖于操作系统的统计信息，如磁盘使用情况。它对我们很有用。

* * *

## 回答 #4

> 赞同：4
> 
> 时间：2009-03-11T13:57:03.693

在 linux 上，您可以只读取文件 /proc/loadavg，其中前三个值代表负载平均值。对于 Windows，您可能必须坚持使用 JNI。

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2009-03-11T13:52:09.117

在 Linux 下，您可以使用[Runtime](http://java.sun.com/j2se/1.5.0/docs/api/java/lang/Runtime.html)。[exec()](http://java.sun.com/j2se/1.5.0/docs/api/java/lang/Runtime.html#exec(java.lang.String))执行“正常运行时间”并评估输出。我不认为在 Linux 下有更好的方法，我认为在 Windows 下也没有同样“方便”的方法。

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2009-03-16T00:18:05.397

如果您使用的是[JRockit JVM](http://www.oracle.com/technology/software/products/jrockit/index.html) ，则可以使用[JMAPI](http://download.oracle.com/docs/cd/E13150_01/jrockit_jvm/jrockit/releases/R27/javadoc/manapi27.2/docs/index.html)。它适用于 JDK 1.4、1.5 和 1.6。

```
System.out.println("Total CPU-usage:" + JVMFactory.getJVM().getMachine().getCPULoad());

System.out.println("Total JVM-load :" + JVMFactory.getJVM().getJVMLoad());

for(Iterator it = JVMFactory.getJVM().getMachine().getCPUs().iterator(); it.hasNext();)
{
   CPU cpu = (CPU)it.next();
   System.out.println("CPU Description: " + cpu.getDescription());
   System.out.println("CPU Clock Frequency: " + cpu.getClockFrequency());
   System.out.println("CPU Load: " + cpu.getLoad());
   System.out.println();
} 
```

# delphi - Delphi：为什么我有时会收到此代码的 I/O 错误 103？

> ID：634587
> 
> 赞同：12
> 
> 时间：2009-03-11T13:50:00.683
> 
> 标签：delphi, file-io

在我的几个应用程序中，我的代码类似于以下内容：

```
if ForceDirectories(ExtractFilePath(lLogName)) then
  begin
    AssignFile(lLog, lLogName);
    try
      if FileExists(lLogName) then
        Append(lLog)
      else
        Rewrite(lLog);
      Writeln(lLog, lLogLine);
    finally
      {$I-}CloseFile(lLog);{$I+}
    end;
  end; 
```

在一个应用程序中，当我第一次尝试执行此操作时，我始终在 Append 语句的行上得到一个 I/O 错误 103 异常（该文件在调用此之前确实存在）。但是，所有后续的操作尝试都可以正常工作 - 直到我重新启动应用程序。

到目前为止，我发现的有关此错误的所有文档都表明，这可能是由于`CloseFile`没有事先调用`Reset`或`Rewrite`（`Append`通常未提及）或该文件正在被另一个进程使用而引起的。由于异常发生在调用`CloseFile`它之前显然不可能是前者。

`Reset`我已经尝试在 for good measure 之后插入 a `AssignFile`，但随后我在该行得到了异常。

也没有其他应用程序公开访问该文件。我说“公然”是因为我确实有点怀疑防病毒（在我的情况下为 TrendMicro）可能是这里的cuplrit（所以也许该文件**正在**使用中）。如果这确实是问题所在，那么最好的解决方法是什么？硬编码自动重试对我来说并不是一个干净的解决方案......

* * *

我有时会收到 103 错误的另一种情况是这段代码，我用它来创建一个空文件（或者更常见的是清空现有文件）：

```
AssignFile(lFile, AFileName);
try
  Rewrite(lFile);
finally
  CloseFile(lFile);
end; 
```

在这种情况下，复制起来要困难得多。它发生的频率要低得多。大多数情况下，这似乎发生在我重新编译应用程序后的第一次运行中。这可能又是防病毒软件的阻碍吗？我只在我的开发机器上看到过这种情况，从未收到客户的报告。与第一种情况一样，每个应用程序会话仅发生一次（如果有的话）。随后的尝试总是成功的。

对于创建空文件或清空现有文件的不同的、可能更安全的方法有什么建议吗？

* * *

## 回答 #1

> 赞同：12
> 
> 时间：2010-11-19T12:55:32.413

好的，已经晚了一年多，但我将对此添加我的评论，因为它解释了为什么会发生这种情况。

我在一个多线程应用程序中遇到了完全相同的问题，其代码几乎与上面的代码片段相同，并且我有保护代码的关键部分。

当一个日志记录操作迅速跟随另一个日志记录操作时，最容易出现问题。由于上述原因，第二次操作将失败。

我还以为是杀毒软件，但错误发生在一台机器上而不是另一台机器上，两台机器都安装了 Norton 360。有问题的机器是全新的 Windows 7，而没有问题的机器是 Windows XP。一位同事在没有安装病毒检查程序的虚拟化 Windows Vista 机器下运行系统时也遇到了问题。

所以我的问题是，“为什么这台 XP 机器如此不同？”。

一方面，它不是处女，这似乎是答案：

机会锁定和 NT 缓存已关闭。大多数（成熟的）Delphi 开发人员都知道，在使用 BDE 时，为了在多用户情况下保持 DBF 和 DB 文件的完整性，这些功能会被关闭。这些设置在较新的机器上没有被禁用，因为我们不再为 Paradox 数据文件开发！

延迟写入缓存似乎会在文件上留下读/写锁定，直到操作系统完成其业务，这可能是几毫秒后。

因此，就我而言，第二个日志事件被第一个日志事件阻止。

好的，我并不是建议您关闭机会锁定 + NT 缓存。我们放弃 BDE 的主要原因之一是避免说服客户修改此类设置。因此，有四种实用的解决方案：

[1) 如dangph](https://stackoverflow.com/a/637307/2047725)所述，在可接受的时间段内重试。

2）在应用程序加载时打开文件并在应用程序的整个持续时间内保持打开状态。如果您正在运行应用程序的多个实例，则不是那么有用。

3) 在日志代码之前懒惰地放一个 sleep(1) 并希望足够长的时间来释放锁。但是，如果您进行大量日志记录，这可能会降低您的系统速度。

或 4) 尝试...除了...结束您的代码。但是你可能会保证错过 100% 的第二条消息（参考我的情况）。

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2009-03-11T13:58:40.600

除了防病毒之外，它还可以是索引软件或文件管理软件，例如 Google 桌面。但是，这里真正的问题是，错误消息并不能帮助您解决问题。我建议您改写代码以使用 TFileStream，只是为了改善您的错误消息。

* * *

## 回答 #3

> 赞同：3
> 
> 时间：2009-03-11T17:57:51.820

您通常应该在尝试 try..finally 之前打开文件：

```
if fileexists then
  append(..)
else
  rewrite(..);
try
  // do something with the file
finally
  CloseFile(..);
end; 
```

和

```
AssignFile(lFile, AFileName);
Rewrite(lFile);
CloseFile(lFile); 
```

（try finally 在最后一种情况下没有任何意义）

否则关闭文件可能会失败，因为它无法打开，这将掩盖真正的错误。

但我认为这不是这里的问题。

* * *

## 回答 #4

> 赞同：2
> 
> 时间：2009-03-12T03:58:12.093

我看不出自动重试有什么问题。我看不出你可以做任何其他事情。如果其他进程正在读取文件，那么您的追加/重写将失败。由于该文件是一个日志，因此很有可能在您尝试打开它的那一刻，诸如日志查看器或文本编辑器之类的东西*会读取它。*

尝试打开文件几次，尝试之间有延迟，然后最终失败。如果你想花哨的话，你可以使用指数退避。

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2009-03-11T14:19:00.130

您的应用程序是多线程的吗？当从两个线程同时调用日志记录代码时，我曾经遇到过与此相同的问题。如果是这样，请使用 TCriticalSection 来控制访问。

* * *

## 回答 #6

> 赞同：1
> 
> 时间：2009-03-12T18:00:45.757

您是否正在查看在 $I- 状态中编译的其他内容的杂散错误？

* * *

## 回答 #7

> 赞同：0
> 
> 时间：2009-03-11T14:01:21.483

您的示例代码应该可以正常工作，这些错误似乎是访问错误。要检测这种情况，您可以尝试禁用 TrendMicro 并查看问题是否仍然存在。

* * *

## 回答 #8

> 赞同：0
> 
> 时间：2009-08-14T10:56:08.870

如果我正确理解这一点，您的文件分配将失败。您确定 FileChecks 是在您调用 AssignFile 时进行的吗？这是非常不寻常的，但您可以使用以下方法进行验证：

```
{$IFOPT I-}

if IOResult <> 0 then
begin
  // Error handling
end;
{$ENDIF} 
```

我同意改用 TFileStream （或除低级文件访问功能之外的任何东西）。这对性能至关重要，并且在迁移到 Unicode 时可能是一个大问题。

* * *

## 回答 #9

> 赞同：0
> 
> 时间：2014-05-23T15:05:01.833

我讨厌 Windows... 看看为什么：

这是解决重写问题的代码（没有消息）：

```
AssignFile(MyFileHandler,RouteToWritableExistantFile);
try
   ReWrite(MyFileHandler); // This sometimes fails
except
      ReWrite(MyFileHandler); // When prior fails, this runs OK
end; 
```

是的，这很荒谬......如果 ReWrite 失败，则进行 Rewrite ......但它在 100% 的情况下对我有用。

我调试了放置大量 ShowMessage 的问题...在尝试了非荒谬的事情（文件以前打开过等）后有点想象力...如果我尝试 ReWrite 两次会发生什么？惊喜......如果第一次失败，第二次尝试成功！

我知道这很荒谬，但它确实有效！

我知道，因为我放了很多信息，就像这样：

```
 ShowMessage('1: - pre - AssignFile - ');
AssignFile(MyFileHandler,RouteToWritableExistantFile);
          ShowMessage('2: - post - AssignFile - ');
try
          ShowMessage('3: - pre - ReWrite - ');
   ReWrite(MyFileHandler); // This sometimes fails
          ShowMessage('4: - pre - ReWrite - ');
except
          ShowMessage('5: - pre - ReWrite - ');
      ReWrite(MyFileHandler); // When prior fails, this allways runs OK (it is absurd, but works)
          ShowMessage('6: - pre - ReWrite - ');
end; 
```

我收到了两条消息：

*   1,2,3,4 当第一次重写工作时
*   1,2,3,5,6 当第一次重写失败时，注意有 6，所以第二次重写有效

希望这可以帮助其他人不要那么生气！！！

PD：Reset 也出现了同样的问题……现在我总是将它们封装到这样的 try...except 块中并摆脱问题！

* * *

## 回答 #10

> 赞同：0
> 
> 时间：2015-04-27T16:37:05.010

你好。回答原始问题可能为时已晚，但我想添加我的文章，尽管它不是对原始问题的直接答案，但我想做出贡献，因为我认为它可能会帮助其他一些寻找这种类型的人的答案。

我得到了同样的错误答案，但是在完全不同的软件中，特别是 EIS 分析器，我尝试打开文件的次数更多，但有时它可能已经打开。这对我来说很好奇，所以我抓住了互联网。实际上，我发现了这样一个错误调用，这似乎是不可能的（因为所指的程序很小）。我正在剥皮上面的答案和一个用绿色检查tic有两个检查的答案，我正确地跟着，只是直观地，它是这样的：当我在另一个程序中打开文件时，它不会让我去在 EIS 分析器中将其作为文件打开。

所以一般结论：当你在一个程序中打开一个文件时，它不会让你在其他任何地方打开它，你会得到一个错误 I/O 错误 103。

PS：有点大胆，松懈和简单的​​结论（没有正确阅读（但没有时间，对不起）以上答案），但我希望你明白这一点。:) 干杯。

* * *

## 回答 #11

> 赞同：0
> 
> 时间：2017-09-30T03:14:53.643

我无意中做了两次 CloseFile 并出现了这个错误。

* * *

## 回答 #12

> 赞同：0
> 
> 时间：2020-03-24T19:28:23.573

我正在回答有关 103 IOResult 错误的原始问题，该错误在运行似乎没问题的代码时有时会发生。我总结了我在这个档案中找到的解决方案： [https ://de.comp.lang.delphi.misc.narkive.com/o1LNZylQ/assignfile-reset-und-ioresult-103](https://de.comp.lang.delphi.misc.narkive.com/o1LNZylQ/assignfile-reset-und-ioresult-103)

基本上，Delphi 仍然包含 20 多年以来继承的一些全局标志。一个是文件模式，另一个是 IOResult。如果打开文件的文件操作正常，则 IOresult 将重置为 0。作为对该规则的一种奇怪解释，closefile() 将 IOResult 输出为 103，“因为”文件显然已关闭。然后尝试打开相同的 OR ANOTHER 文件可能会失败。解决方法很简单：将这一行放在 closefile() 之后：

```
r := IOResult; 
```

它重置 IOResult，代码按预期工作。请注意，多线程需要额外的预防措施。

* * *

## 回答 #13

> 赞同：0
> 
> 时间：2021-03-17T09:18:28.477

对我来说，这是由重复的计时器事件多次触发处理文件的函数引起的。所以第二个定时器事件在前一个定时器调用完成之前被调用。这会导致多次打开同一个文件并导致 103 错误代码。

解决方案是在定时器调用处理中临时禁用定时器，直到处理完成。

# language-agnostic - 作为第一次合同程序员应该知道什么？

> ID：634591
> 
> 赞同：21
> 
> 时间：2009-03-11T13:50:22.133
> 
> 标签：language-agnostic

我是一名大学生，做过几次实习，并认为自己是一名体面的程序员。我有一个朋友从事咨询工作，他希望我帮助他完成他的一个项目。由于我以前从未做过任何合同工作，我应该注意和注意哪些事项？

* * *

## 回答 #1

> 赞同：29
> 
> 时间：2009-03-11T14:39:41.670

哇男孩。在这条路上潜伏着疯狂。

考虑到您的情况，最重要的建议是：以书面形式定义所有内容。您需要的最重要的信息如下：

*   你的报酬是多少，以什么标准衡量？如果是每小时一次，您仍然需要知道何时收到实际支票。是项目启动后吗？如果项目失败了怎么办？你还得到报酬吗？

*   他们是在处理您的税款还是您在处理？（答案几乎总是你是。）

*   您可以累积的计费时间是否有上限？如果你到达它但没有完成会发生什么？

*   您将使用什么设备进行编码？如果他们不提供计算机，则运行。您不应该使用个人电脑进行职业发展；它为您在自己的时间编写的其他代码创建了各种所有权混乱。

*   你需要什么软件？不要将软件的个人副本用于专业工作。特别是如果它是你的破解版的视觉工作室或其他什么。

*   谁将提供图形、布局等？您是否希望创建图形和布局？如果有，用什么软件？小心包含 google-image-searched 小部件等的系统。您最终可能对侵权软件承担共同责任。

*   如何处理对产品的支持？您是否需要提供知识和培训？您将如何获得上述知识和培训的报酬？

*   你的负债是什么？如果代码出现问题或在 3 个月后发现有错误，您是否需要修复它？支持参数是什么？您不想在 6 个月内最终被公司起诉。确保你的*朋友*有责任。

*   您需要为您正在编写的代码提供一个干净的设计规范。仅仅知道它应该做什么是不够的。我再说一遍，**“我想要一个购物车来在线销售我的鞋子”不是设计规范。**您需要详细解释的可靠功能集。您需要清楚地描述您的工作部分，并且您需要有关您的代码必须使用的任何更大框架等的可靠文档。

而这只是一个开始。欢迎来到承包的世界！当您不在公司的法律保护伞下受雇时，情况就是这样！:-D

* * *

## 回答 #2

> 赞同：27
> 
> 时间：2009-03-11T13:58:56.700

宝贵的建议：学会说不。

很多时候，您会发现自己处于客户要求一些额外功能或多个项目同时报价的位置。我推荐的一本好书是[积极的不的力量](https://rads.stackoverflow.com/amzn/click/com/0553804987)。

你必须学会​​在适当的时候说不：如果你因为一天只有 24 小时而不能接受更多的工作，那么拒绝他们或明确指定你可以在 1-2 个月后开始做这些工作；如果某个客户坚持要您做超出范围的事情，请说“不”（当然，除非这是一个非常重要的客户，并且您通过他看到了更多的机会）。

考虑一下通过接受和拒绝工作、客户等你会得到什么，你会失去什么。这样你就会清楚地看到每次做什么。

最后，为每一项工作收取你应该收取的费用，不多不少。如果你是一个优秀的程序员并且善于理解客户的需求，他们会比他们支付的钱更看重这些。

* * *

## 回答 #3

> 赞同：21
> 
> 时间：2009-03-11T13:59:22.767

你真的信任你的朋友吗？因为一旦涉及金钱，友谊通常是一种负担，而不是一种祝福。确保您确实有一份书面合同，其中明确规定您的朋友不能就您将为/与他一起编写的软件起诉您。

当然，购买软件的实际一方也需要这样做。您应该绝对清楚地表明您没有得到公司的支持，因此您必须坚持禁止起诉的条款。

* * *

## 回答 #4

> 赞同：3
> 
> 时间：2009-03-11T14:00:09.113

取决于你在哪里工作。在爱尔兰和欧洲大部分地区，你最好成立一家有限公司，并从中签约。基本上这里的问题是，如果出现问题，公司（具有有限责任）可以被起诉，但不是你个人。'当然，考虑到你是一个体面的程序员，这永远不会发生；）不过，还是要考虑的。

自从我自己做任何合同以来，大约有 20 年了，但我在早期不坚持的一件事就是定价。程序员通常根据编写代码的时间来考虑项目。您实际上需要考虑编码、测试、充分记录、安装和培训需要多长时间。您还需要为不可避免的持续支持定价。

最后，您和您的客户之间签署的许可协议限制了您或您的公司对支付给您的金额的全部责任，即没有间接损失。同样，错误仅限于明确定义的测试用例中的失败，而不是模糊理解/模棱两可的需求。

祝你工作顺利！

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2009-03-11T13:59:17.180

在我看来，我永远不会尝试和朋友一起为钱工作，因为当涉及到钱时，你必须将他们视为普通客户。当事情没有按预期工作时，金钱可以让你的朋友把你当作真正的**产品价格而不是朋友。**因此，他们希望您给他们与普通客户一样多的时间。

* * *

## 回答 #6

> 赞同：1
> 
> 时间：2009-03-11T14:07:57.893

来自 Scott Berkun 最近的一篇关于[“我现在应该辞掉工作吗？”的帖子。](http://www.scottberkun.com/blog/2009/should-i-quit-my-job-now/) 它包含一些很好的咨询意见。

> **开始寻找客户。**问问周围。在您的网络中，哪五个人最有可能需要您的服务。跟他们讲话。如果他们有兴趣，请询问他们您是否是自由职业者。与您所在领域的其他自由职业者交谈——请他们吃午饭并征求意见。他们喜欢独处吗？为什么？为什么不？在实现飞跃之前，成为您所在领域的自由职业者的学生，并弄清楚您对它的幻想是否接近现实。立即开始工作并构建您的网络。开一个关于你的专业知识的博客：它为你的知识创造了一个家，如果你自己去，你的生意。
> 
> **快速获得您的第一个客户：**免费工作。一个好的推荐比支付给一个新的独立人士更有价值。愿意免费工作，在有限的时间安排的基础上，以换取良好的推荐或使用客户的网络。如果您找不到愿意让您免费工作的人，请担心。您可以在周末或离开当前工作时执行此操作。立即着手进行项目，而您几乎没有风险。如果在两个周末的项目之后你讨厌它，你已经知道，在退出之前，自由职业者不适合你。
> 
> **重视生活体验**。当我辞职时，它帮助我接受了即使我失败了，我也会学到很多关于我自己、我的行业和一般生活的知识。我确信有一些我可以学到的教训是我无法以其他方式购买的，我从中获得了力量（结果证明我是对的，但当我退出时我不知道这一点）。我确信在个人层面上我不会输，如果我计划 #1 和 #2，财务风险很小。最坏的情况是，我会带着这些经历回到我以前的职业生涯。

他还建议阅读[百万美元咨询：专业发展实践指南（平装本）](https://rads.stackoverflow.com/amzn/click/com/007138703X)

* * *

## 回答 #7

> 赞同：0
> 
> 时间：2009-03-11T14:05:02.707

我不会和朋友做生意。如果你想成为一名顾问 - 与政府或大公司一起开始掌握绳索。或者使用具有托管/仲裁系统的东西，比如rentacoder.com

* * *

## 回答 #8

> 赞同：0
> 
> 时间：2009-03-11T14:33:32.497

一个简单的提示，但无论您与谁一起工作，都要获得一份书面协议，说明您将做什么以及您预计需要多长时间，并确保双方都已签署。不一定要复杂或法律术语，但您需要绝对清楚*您将做*什么以及评估您的工作并获得报酬的成功标准是什么。这样每个人都知道他们的立场。

* * *

## 回答 #9

> 赞同：0
> 
> 时间：2009-03-11T14:44:53.470

我的建议是做这项工作，尝试在你进行的过程中获得报酬——比如每两周一次，这样你就不会被挂断——并且不要过于纠结于你最初涉足付费编程世界时的注意事项. 合同编程实际上与任何其他工作没有什么不同。

除此之外，其他一些建议是，如果你对这份工作感兴趣，可以灵活调整价格。如果您不感兴趣（并且您并不急需现金），请提高价格。我做过的收入最高的承包工作是编写 javascript 在 Netscape 和 IE 之间工作。我只坚持了 4 个月，之后我就赚够了 3 个月的假期，但在某种程度上，我真的很讨厌浪费了 4 个月的生命来处理如此令人麻木的任务！

* * *

## 回答 #10

> 赞同：0
> 
> 时间：2009-03-11T17:38:29.963

我有很多“朋友”在一个项目上寻求帮助，要求聘请我作为顾问，并以他们不知道如何实施、成本和期望如何的“了不起”的想法提供天空支付我的服务费用。

这些天来，当一个朋友向我提出一个开发项目的好主意时，我就跑了。通常是“我会给你一部分利润/和我做生意”的交易，我做所有的工作，最后得到的很少。

我会质疑你的朋友在项目中的角色，你将如何获得报酬，何时获得报酬，项目何时结束，在你有纸上要求之前不要写一行代码，以及一份你可以接受的合同。

只是我的观点...

* * *

## 回答 #11

> 赞同：0
> 
> 时间：2009-03-11T19:19:35.383

还要考虑*不*按小时工作的选项。有些人认为这是一种亵渎，但如果你能在开始时对项目进行足够好的定义，你可以设定一个固定的价格。如“我将构建一个执行 XY 和 Z 的 ruby​​ 程序，你将支付我 800 美元”。我发现每小时工作（和跟踪时间，以及所有这些）给工作带来的压力超过了工作的价值。

YMMV，显然不是每个项目都有很好的可定义目标。（当然，如果你的项目没有很好的可定义目标，你可能会被搞砸...... :) 我有很多与朋友（甚至家人）合作的好项目，所以不要让它的这方面吓到你很多。

* * *

## 回答 #12

> 赞同：0
> 
> 时间：2009-05-03T02:09:48.800

这取决于您的朋友需要帮助的合同工作类型。

希望这是他与一家为他的服务付费的老牌公司所做的有利可图的工作。在这种情况下，他可以为您插上电源，按小时向您支付费用，一切都很好。

如果这项工作是直接为您的朋友进行他的项目的，那么我会小心不要危及您与付费项目等的友谊。如果您的朋友与一家小公司签约或在该级别有任何财务问题，我d 也尽量小心支付问题等。

一般来说，玩得开心，从中学习，试着弄清楚这是一种不稳定的情况，还是提供的服务有稳定的支付流。

在大约 12 年的时间里，我很少遇到付款问题，有一次是直接为朋友工作，而日程安排已经结束......所以，按小时工作可能比尝试估计时间更容易/cost ，尤其是作为初学者。

# wpf - 如何仅使用 WPF 上传文件

> ID：634592
> 
> 赞同：0
> 
> 时间：2009-03-11T13:50:33.817
> 
> 标签：wpf

祝福大家，

我想知道是否有人知道或拥有在不使用 ftp 和 WPF 的情况下将文件上传到服务器（使用 ISS 的 Web 服务器）的示例代码。

此外，我想问一下您希望上传多媒体的文件是否可以在上传到服务器之前进行预览，然后再使用播放器存档平均 WPF 进行上传

非常感谢。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2009-03-11T14:05:08.773

如果您想在不使用 FTP 的情况下将文件传输到服务器。我建议你制作一个小类库，它将使用服务器上的 Web 服务来上传内容。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2010-07-05T07:49:05.000

System.Net.WebClient 有一个 UploadFile 方法，可以使用 HTTP POST [MSDN docs](http://msdn.microsoft.com/en-us/library/system.net.webclient.uploadfile.aspx)上传文件。

# ubuntu - 机器经常出现段错误

> ID：634597
> 
> 赞同：8
> 
> 时间：2009-03-11T13:51:37.823
> 
> 标签：ubuntu, segmentation-fault, apt

当我使用 apt-get 安装或升级我的 Ubuntu hardy 系统时，我经常收到这样的消息：

```
$ sudo apt-get install foo
Reading package lists... Done
Segmentation faulty tree... 50%

$ sudo apt-get install foo
Reading package lists... Done
Building dependency tree       
Reading state information... Done
Segmentation fault

$ sudo apt-get install foo
Reading package lists... Done
Building dependency tree       
Reading state information... Done
terminate called after throwing an instance of 'std::logic_error'
  what():  basic_string::_S_construct NULL not valid
Aborted

cc  -Os -g -Wall -DLOCAL_ROOT=\"/usr/share/polipo/www/\" -DDISK_CACHE_ROOT=\"/var/cache/polipo/\"  -DCHUNK_SIZE=16384   -c -o http_parse.o http_parse.c
http_parse.c:1564: internal compiler error: Segmentation fault
Please submit a full bug report,
with preprocessed source if appropriate.
See <URL:http://gcc.gnu.org/bugs.html> for instructions.
For Debian GNU/Linux specific bug reporting instructions,
see <URL:file:///usr/share/doc/gcc-4.2/README.Bugs>.
make: *** [http_parse.o] Error 1 
```

它不会一直发生，因此如果您重试足够多，通常可以完成任务，但它确实会在很大一部分时间出现段错误。

知道发生了什么或如何解决它吗？

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2009-03-11T13:54:38.177

如果标准工具间歇性地出现故障，尤其是像这样的内存错误，那么是时候怀疑硬件了。

运行 memtest（最好从 grub 菜单中），让它运行几个周期。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-03-11T13:57:54.703

道格拉斯给出了正确的方向。运行 memtest 是最便宜的选择。

降低 CPU 时钟（如果可能）是另一种选择。如果您有多余的 RAM 模块，请尝试将它们换成您当前的。如果没有任何效果并且您仍然遇到同样的问题，请怀疑主板。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2009-03-11T14:03:59.323

我遇到了类似的问题，结果证明是 CPU 风扇支架破裂了。它使温度飙升。

还要确保您的记忆测试通过。使用您的 ubuntu 安装盘，启动机器并选择内存测试。让它运行大约一个小时，如果有内存问题，它会显示在错误列表中。

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2009-03-11T14:04:35.063

与“常规”使用相比，软件安装对系统的负担可能会更大一些，这可能会导致固有问题从隐藏中爬出来。除了给出的建议之外，如果您开始测试/交换硬件组件，请从电源开始。

可能是 PSU 在负载下“下降”电压，这会对系统造成严重破坏。幸运的是，PSU:s 非常便宜，而且更换 PSU 比更换主板要容易得多。

# java - java:com/env-scheme 如何在 glassfish 中查找自定义资源？

> ID：634598
> 
> 赞同：5
> 
> 时间：2009-03-11T13:51:51.257
> 
> 标签：java, jakarta-ee, glassfish

我在 GlassFish 中创建了一些 JDBC 资源和自定义资源。我命名为 JDBC 资源`jdbc/mydb`和自定义资源`service/test`。

JDBC 连接是通过调用查找的`ic.lookup("java:comp/env/jdbc/mydb")`。也可以用 找到`ic.lookup("jdbc/mydb")`，它有一些缺点，见下面 Robin 的回答。

但是我的自定义资源必须用`ic.lookup("service/test")`. 线路~~`ic.lookup("java:comp/env/service/test")`~~不工作。有可能吗，如果是的话：怎么做？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2009-03-11T14:26:05.993

前缀指示资源引用的使用情况，该资源引用是为从中进行 JNDI 查找的 Java EE 实体定义的。您还必须为您的自定义资源定义这样的引用，以便以相同的方式查找它。

JDBC 查找也不需要前缀，因为您可以使用完整的 jndi 名称。这种方法的问题在于，如果您移动资源使其不再位于本地初始上下文中，则如果不更改代码中的查找名称以包含位置信息，您将无法找到它。使用引用可以屏蔽您的代码，因此只有引用中的映射会改变。

[这里](http://www-01.ibm.com/support/docview.wss?uid=swg21224080)有一些关于使用的信息

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2011-09-27T11:16:05.137

如果您在 domain.xml 中创建了自定义资源，则可能忘记将它们作为资源引用添加到 domain.xml 中的服务器/服务器标记下：

```
 <resources>
        <!-- JDBC RESOURCE -->
        ...
        <custom-resource res-type="java.lang.String" jndi-name="MyCustomStringResource"
                         factory-class="org.glassfish.resources.custom.factory.PrimitivesAndStringFactory">
            <property name="value" value="hello, this is a string resource"></property>
        </custom-resource>
        ...
    </resources>
    <servers>
        <server name="server" config-ref="server-config">
            <application-ref ref="__admingui" virtual-servers="__asadmin"></application-ref>
            ...
            <resource-ref ref="MyCustomStringResource"></resource-ref>
            ...
        </server>
    </servers> 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-03-11T14:27:45.490

我不确定 Glassfish 的“自定义资源”是什么意思。Java EE 规范说“java:comp/env”命名空间是为资源查找保留的，这些资源查找只绑定到该特定应用程序。所以

```
ic.lookup("java:comp/env/jdbc/mydb") 
```

实际上意味着 jdbc/mydb 是您从中进行查找的应用程序（EJB/servlet 等）的名称绑定。在不使用 java:comp/env 前缀的情况下进行直接查找会将您的应用程序与您正在部署的服务器环境联系起来。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2017-06-09T19:39:29.597

glassfish 3 及更高版本在 localhost:4848 上使用管理 gui 使用 gui 并转到 JDNI >Custom Resources>New Resource

对于以前版本的 glassfish，我建议更改 glassfish.xml 以使用说明符实例化新资源

# c - 如何判断进程的状态（即是否为僵尸）

> ID：634608
> 
> 赞同：2
> 
> 时间：2009-03-11T13:55:00.937
> 
> 标签：c, linux, process, zombie-process

如何在 Linux 下使用 C 获取有关进程状态的信息（即，如果它是僵尸）？

在阅读了到目前为止的答案之后，我想稍微缩小我的问题范围：我更喜欢纯 C 解决方案。在阅读了 ps 源代码（读取 /proc/）后，我认为应该有更好的方法并在这里问:)

* * *

## 回答 #1

> 赞同：8
> 
> 时间：2009-03-11T14:23:36.360

您需要了解如何通过典型的 C 标准库调用与 /proc/“伪文件系统”进行交互。入门所需的文档包含在任何 Linux 发行版中，只需 google 搜索即可。

（现在您知道要搜索什么了。我知道这通常是最大的挑战！）

简而言之，正在运行的 Linux 系统的 /proc/ 目录中的目录和文件反映了正在运行的内核的状态，其中（自然）包括进程。但是，在您收费之前，您需要记住一些信息。

A zombie process isn't the same thing as an orphaned process. An orphaned process is a process left running in a waiting state after the process' parent has exited incorrectly. A zombie process is a process which has exited properly, released all its resources, but is maintaining a place in the process table.

This typically happens when a process is launched by a program. You see, the kernel won't remove a finished sub-process' entry in the process table until the parent program properly fetches the return status of the sub-process. That makes sense; how else would the parent program know if the subprocess exited improperly?

So all subprocesses are technically zombies for at least a very short time. It's not inherently a bad state for a program to be in.

Indeed, "zombies" are sometimes created intentionally. For example, sometimes a zombie entry is left in place by a program for a while so that further launched processes won't get the same PID as the previously-launched (and now zombie) process.

In other words, if you go SIGCHLDing zombie processes unnecessarily you might create a serious problem for the spawning program. However, if a process has been a zombie for a half hour or more, it's probably a sign of a bug.

Edit: The question changed on me! No, there's no simpler way than how ps does it. If there was, it would have been integrated into ps a long time ago. The /proc files are the be-all-end-all source for information on the kernel's state. :)

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2009-03-11T14:02:42.680

我只知道两种方法：

*   解析`ps`命令的输出
*   读取 /proc/PID 中的文件，其中 PID 是进程标识符（这就是`ps`内部执行的操作）

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2009-03-11T14:05:18.617

您希望在您的机器上运行的进程然后使用

$ ps辅助

**ps**显示有关活动进程选择的信息。如果您想要重复更新选择和显示的信息，请改用**top**。

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2012-04-26T05:17:04.053

Pseudo file system /proc is describing kernel internal data structures and gives to you opportunity to alter some values directly. Obtaining state of particular process can be easily implemented with I/O C functions. The right file to parse is: */proc/{PID}/status*

Command below can be used to obtain processes in Zombie state.

```
for proc in $(echo /proc/[0-9]*);do if [[ $(sed -n '/^State:\tZ/p' ${proc}/status 2>/dev/null) ]];then basename $proc;fi;done 
```

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2009-03-11T14:04:14.033

[在这里](http://www.howtoforge.com/forums/archive/index.php/t-1397.html)找到：

```
Use this command to display all of your zombie processes:

ps aux | awk '{ print $8 " " $2 }' | grep -w Z 
```

这可以使用 C 轻松解析。

# c# - 单个单词的正则表达式

> ID：634614
> 
> 赞同：1
> 
> 时间：2009-03-11T13:57:07.170
> 
> 标签：c#, regex

我正在使用 Regex.Split 在关键字“GO”上拆分 SQL 脚本。我的问题是我似乎无法理解如何让正则表达式进行拆分。我的正则表达式也会在“GO”上拆分，即使它位于 SQL 语句中，例如：

```
Insert into  x(a,b) values(‘please go get some text’,’abc’) 
```

但我只希望它在关键字“GO”上进行拆分。有什么建议么？

编辑：我正在使用 c#。目前我的正则表达式很简单：

```
 foreach (string batch in Regex.Split(script, "\\bGO\\b", RegexOptions.IgnoreCase))
  {
    yield return batch;
  } 
```

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2009-03-11T14:00:15.183

如果不以真正正确的方式实现完整的 SQL 解析器（您可能不想这样做），这几乎是不可能的。

另一种方法是诉诸一些技巧（即忽略引号内的文本部分），但是如果您的 SQL`GO`在其他地方包含文本“ ”，例如“ `SELECT * FROM GO`”，这仍然不起作用。

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2009-03-11T14:05:37.383

自己在一行上拆分 GO，例如：

```
foreach (string batch in Regex.Split(script, "^GO$\\n", RegexOptions.IgnoreCase | RegexOptions.Multiline))
{
    yield return batch;
} 
```

根据脚本的来源，您可能需要将其更改为**"^GO$\\r\\n"**

* * *

## 回答 #3

> 赞同：3
> 
> 时间：2009-03-11T14:03:20.683

您可以单独在一行上搜索“go”。不保证总是有效，但更有可能有效。

* * *

## 回答 #4

> 赞同：2
> 
> 时间：2009-03-11T14:07:44.027

你可以尝试类似的东西

/;\s*去\s* ;/我

这样，您将覆盖每个 GO 句子，无论它们是否仅在一行中（即其他行中的分号）。

如果您使用查询进行进一步执行，您可能希望将分号添加回每个查询。

请注意，如果出现“;GO;” 发生在插入字符串中，那么如果没有适当的 SQL 解析器，就无法实现您的目标。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2011-03-14T16:02:00.397

这是我用正则表达式解决这个问题的方法。

```
var statements = Regex.Split(sql, @"^\s*GO\s*$", 
    RegexOptions.IgnoreCase | RegexOptions.Multiline); 
```

当它在自己的行上时，它会在“GO”上拆分，并且可以选择用空格包围。这些似乎是 SSMS 强制执行的规则 -`GO`与任何其他语句放在一起会导致错误（分号或否）。

请注意，如果您的脚本在块注释内的自己的行上有 GO 语句，它仍然会中断。这是我能想到的唯一错误。

防弹解决方案是使用 SMO，如本[答案](https://stackoverflow.com/questions/40814/how-do-i-execute-a-large-sql-script-with-go-commands-from-c/40830#40830)中所述。

# c# - .NET 2.0 中的 SignumFramework？

> ID：634628
> 
> 赞同：3
> 
> 时间：2009-03-11T14:00:24.153
> 
> 标签：c#, .net, linq

是否可以将[Signum 框架](http://www.signumframework.com/Default.aspx?AspxAutoDetectCookieSupport=1)与以前版本的 .NET，特别是 2.0 一起使用？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-03-11T16:54:14.797

我是 signum 团队的成员之一，我们之所以认为 SO 是解决有关我们免费 ORM 的所有问题的地方，是因为我们认为它很好地适应了程序员回答技术问题的原则, 对于程序员。

我们接受（并理解）不能在这里发布任何宣传，也不会这样做，这就是我们删除欢迎帖子的原因。但是，我们看不到问题不能在这里发布的原因，因为这是一个专门的地方（以及我们在 codeplex 中发布了代码，一个旨在发布开源代码的地方）。无论如何，内部讨论或错误不会在这里，那些将留在 Codeplex，这将只是一个提出技术问题的地方。

我们认为 SO 是最好的论坛替代方案的原因是：

*   社区和管理 SO 的规则使其成为询问技术问答的最有效场所（尽管今天让我们有些头疼）。
*   很多Signum Framework相关的问题都与其他领域密切相关，比如LINQ、WPF、WCF……所以这样的通用论坛看起来更自然。（即如何创建动态IQueryable）
*   这是可用的技术最先进的论坛。

如果这不能真正实现 SO 原则，我们将停止将 SO 称为向我们提问的地方。

关于傀儡这件事，cad是我们的老朋友了。他有这个问题，他用正常的方式问它。我很难过他现在少了 2 点声望。

回到问题：

Marc 是对的，它仅适用于 .Net 3.5。Signum.Utilities 是基本程序集，大量使用了 Linq 功能。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-03-11T14:38:38.897

我不熟悉signum 也不与signum 相关，但作为LINQ 提供者，这**极**有可能将`Expression`API 用于LINQ 方面（即不仅仅是委托）。因此，我非常怀疑它是否适用于 .NET 3.5 之前的任何东西。

[更新：这里](http://www.signumframework.com/MainPage.ashx)现在也有一个登录支持频道。

# c# - 选择多个项目时如何显示自定义字符串？

> ID：634630
> 
> 赞同：1
> 
> 时间：2009-03-11T14:00:38.537
> 
> 标签：c#, winforms, propertygrid

我有一个属性网格，可以帮助我管理表单上的所有控件。这些控件是为设计师类型的人设计的，所以我不太担心用户界面......直到有人选择多个对象。

我有一个 UITypeEditor 用于这些常见对象的“EffectiveDiameter”属性。它跟踪单位（米与英尺）并即时做一些好事。但是，当有人选择两个或三个公共对象时，EffectiveDiameter 为空白，即使它计算为相同的文本字符串。

例如，在大多数控件中，Microsoft 具有“Anchor”属性，该属性具有“Top, Right”的文本输出。当你把它拉下来时，它是一个带有漂亮 UITypeEditor 的对象。然而，当您在表单上选择五个都具有相同 Anchor 设置的对象时，您仍然可以在属性网格中看到字符串“Top, Right”。

 `````
/// <summary>
/// The default containing class for all Unit-Management Conversion classes.
/// </summary>
[
 Serializable,
 EditorAttribute(typeof(umConversionTypeEditor), typeof(UITypeEditor)),
 TypeConverter(typeof(umConversionTypeConverter)),
]
public class umConversion
{
    ...
}

public class umConversionTypeEditor : UITypeEditor
{
    ...
}

// Now, in my designer class, I have ...
private double _effectiveDiameter { get; set; }

[DisplayName("Effective Diameter")]
public virtual umConversion EffectiveDiameter
{
    get
    {
            umConversion ret = new umConversion (_effectiveDiameter);
            ret.MeasureInSI = _si;
            return ret;
        }
        set
        {
           _effectiveDiameter = value.ImperialUnits;
        }
    }
} 
````  `如果我选择了几个自定义对象——所有对象都具有相同的有效直径——我如何让 EffectiveDiameter 像 Anchor 一样显示在 PropertyGrid 中？现在，该字段始终为空白。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-03-11T14:41:02.230

根据您的描述，您似乎在谈论 double 类型的有效直径。但是在您的示例中，您显示的是 umConversion 类的 UITypeEditor。所以，请澄清。

如果您处于第二种情况，您的属性实际上是您自己的一个类而不是原始类型，那么请确保实现 Equals 方法。MS PropertyGrid 中的 MultiPropertyDescriptorGridEntry 类调用 Equals 以了解所有目标实例是否具有相同的值。不确定这是否是您的问题，但我会对其进行测试以消除这种可能性。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-03-11T14:06:04.140

`TypeConverter`在每个属性上也放置一个属性..

# search - 如何正确提升 Solr Dismax 查询中的结果

> ID：634636
> 
> 赞同：4
> 
> 时间：2009-03-11T14:02:53.663
> 
> 标签：search, lucene, solr

我已经设法在 Solr 中建立了一个索引，我可以搜索关键字、生成方面、查询方面等。这一切都很好。我已经使用 dismax 查询实现了我的搜索，因此它搜索预定的字段。

但是，我的结果按分数排序回来了，该分数似乎仅由关键字相关性计算得出。我想调整字段具有预定值的分数。我想我可以使用 boost 查询和 boost 函数来做到这一点，但这里的文档：

[http://wiki.apache.org/solr/DisMaxRequestHandler#head-6862070cf279d9a09bdab971309135c7aea22fb3](http://wiki.apache.org/solr/DisMaxRequestHandler#head-6862070cf279d9a09bdab971309135c7aea22fb3)

不是特别有帮助。我尝试在搜索中添加一个 bq 参数：

```
&bq=media:DVD^2 
```

（是的，这是电影索引！）但是当我开始添加越来越多的内容时，我发现：

```
&bq=media:DVD^2&bq=media:BLU-RAY^1.5 
```

我发现负面结果——例如，DVD**而非**蓝光电影的评分会受到负面影响。最后，一切似乎都变得平衡了，我的分数与我开始提升之前一样。

我一定是做错了，我想知道“增强功能”是否在某个地方出现。关于如何正确使用 boost 的任何想法？

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2010-06-18T17:27:57.797

这有点晚了，看起来你可能已经有了你要找的东西，但是......

*如果你对 boost函数*感到好奇（从你想要的结果来看，我认为你应该是）你应该检查`bf`参数而不是`bq`参数。

尝试将 bf 参数设置为

```
media:DVD^2 media:BLU-RAY^1.5 
```

我认为这可以实现你想要的。

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2009-06-06T19:13:06.043

显然，这对于 DVD 但不是蓝光的电影来说是正常的，因为它们的分数会受到负面影响。这是因为您添加的约束越多，queryNorm 值减少的越多 - 所有分数都乘以该值。

* * *

## 回答 #3

> 赞同：-1
> 
> 时间：2009-05-04T15:05:25.543

听起来您需要在索引时间而不是查询时间应用提升。因此，当您准备要添加到索引中的文档时，将 DVD 提升 2，将蓝光提升 1.5。

# .net - 确定 .NET CF 中 Web 服务调用的传输数据大小

> ID：634638
> 
> 赞同：3
> 
> 时间：2009-03-11T14:03:07.750
> 
> 标签：.net, web-services, .net-3.5, compact-framework, gprs

我正在开发一个 .NET CF 客户端应用程序并使用 Web 服务进行数据传输。我正在使用 SharpZipLib 压缩传输的数据集，因此我知道传输的字节数组的大小。

我想知道是否有一种简单的方法来确定完成单个调用的请求大小（html headerder、soap 信封和真实数据）。我真的想尽量减少 GPRS 连接成本。

谢谢...

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-03-11T14:12:02.800

重新提出整体问题；对不起，我不知道使用网络跟踪器...

然而; 我可以谦虚地建议数据集和 SOAP 并不总是带宽受限设备的最佳选择吗？压缩做得很好，但并不总是理想的。除非您需要提供的功能，否则可以使用更简单的协议（例如 POX，可能使用内置协议压缩 (GZIP/Deflate)）。

另一方面...如果您可以将事物表述为消息，那么像[protobuf-net](http://code.google.com/p/protobuf-net/)这样的序列化程序可能会很有用（结合原始二进制帖子）；它们的数据非常密集（因此尝试使用压缩不可避免地会增加大小）。但是，您需要在客户端进行自己的数据/更改跟踪，并且 RPC 堆栈尚不完整（我有工作原型代码，但我还没有提交它，因为我还在单元测试它）。服务器也将有所不同（即不是 asmx 或其他任何东西 - 可能是操纵的处理程序或 MVC 控制器）。

作为另一种选择 - ADO.NET 数据服务可能会引起人们的兴趣，尤其是在 JSON 模式下（对于带宽，再次使用协议压缩）。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-03-11T17:17:45.880

WCF 支持消息跟踪，可以让您查看生成的 SOAP+Message 的大小。您可以使用这些跟踪文件来确定您要查找的内容，尽管对您的通信进行压缩后发送的字节数将不那么明显。对于实际的电线尺寸，wireshark 将是一个不错的选择。或者，您可以压缩从 WCF 跟踪中提取的消息并大致了解一下。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-03-11T14:29:33.473

[Wireshark](http://www.wireshark.org/)是著名的协议分析工具。但是，对于您的需求，这可能有点过头了。

还结帐[Fiddler](http://www.fiddlertool.com/fiddler/)。这更容易，它将允许您监控来自模拟器的流量。

[tcpmon](https://tcpmon.dev.java.net/)是一个 Java 实用程序，可以位于服务器和客户端之间。您需要在应用程序中编辑端点以连接到 tcpmon 并配置 tcpmon 以将所有请求代理到实际的 Web 服务。它不应该花费超过 10 分钟 - 这是一个非常简单的实用程序。然后您可以在 tcpmon 中监控原始请求或使用 Fiddler 捕获流量。

# c# - Linq2sql/GridView：分页不起作用？

> ID：634642
> 
> 赞同：2
> 
> 时间：2009-03-11T14:03:37.110
> 
> 标签：c#, sql-server, linq-to-sql, tsql

考虑到我想使用内置分页和排序，将 linq2sql 集合绑定到 GridView 的最佳方法是什么？

我试过了：

```
public static void BindEnquiryList(EnquiryQuery query, GridView view)
        {
            DataContext db = DataContextManager.Context
            //view.DataSource = (from e in EnquiryMethods.BuildQuery(query)
            view.DataSource = (from e in db.Enquiries
                               select new
                               {
                                    Id = e.Id,
                                    Name = e.Name,
                                    PublicId = EnquiryMethods.GetPublicId(e.PublicId),
                                    What = e.WorkType.DescriptionText,
                                    Where = e.EnquiryArea.DescriptionText,
                                    Who = e.EnquiryType0.DescriptionText,
                                    When = e.EnquiryTime0.DescriptionText,
                                    PriceRange = e.EnquiryPrice0.DescriptionText,
                                    DisplayPriceRange = e.EnquiryPrice0.Display,
                                    Description = e.Description,
                                    Published = e.EnquiryPublished
                               });

            view.DataBind();
        } 
```

并且 GridView 设置为 pagesize 20（并正确显示 20），但执行需要永远加载，当我记录 sql 时，我得到：

```
SELECT [t0].[Id], [t0].[Name], [t0].[PublicId] AS [publicId], [t1].[DescriptionText] AS [What], [t2].[DescriptionText] AS [Where], [t3].[DescriptionText] AS [Who], [t4].[DescriptionText] AS [When], [t5].[DescriptionText] AS [PriceRange], [t5].[Display] AS [DisplayPriceRange], [t0].[Description], [t0].[EnquiryPublished] AS [Published]
FROM [dbo].[Enquirys] AS [t0]
LEFT OUTER JOIN [dbo].[WorkTypes] AS [t1] ON [t1].[Id] = [t0].[EnquiryPlace]
LEFT OUTER JOIN [dbo].[EnquiryAreas] AS [t2] ON [t2].[Id] = [t0].[EnquiryPlace]
LEFT OUTER JOIN [dbo].[EnquiryTypes] AS [t3] ON [t3].[Id] = [t0].[EnquiryType]
LEFT OUTER JOIN [dbo].[EnquiryTimes] AS [t4] ON [t4].[Id] = [t0].[EnquiryTime]
LEFT OUTER JOIN [dbo].[EnquiryPrices] AS [t5] ON [t5].[Id] = [t0].[EnquiryPrice]
-- Context: SqlProvider(Sql2005) Model: AttributedMetaModel Build: 3.5.21022.8 
```

没有任何顶部。我希望 GridView 管理 Take 和 Skip 操作？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-03-13T10:24:23.067

最好的方法是使用 LinqDataSource。为 LinqDataSource 上的选择事件创建一个事件处理程序。

```
protected void LinqDataSource1_Selecting(object sender, LinqDataSourceSelectEventArgs e)
{
    e.Result = (from e in db.Enquiries
                               select new
                               {
                                    Id = e.Id,
                                    Name = e.Name,
                                    PublicId = EnquiryMethods.GetPublicId(e.PublicId),
                                    What = e.WorkType.DescriptionText,
                                    Where = e.EnquiryArea.DescriptionText,
                                    Who = e.EnquiryType0.DescriptionText,
                                    When = e.EnquiryTime0.DescriptionText,
                                    PriceRange = e.EnquiryPrice0.DescriptionText,
                                    DisplayPriceRange = e.EnquiryPrice0.Display,
                                    Description = e.Description,
                                    Published = e.EnquiryPublished
                               });

} 
```

Then the LinqDataSource will handle the paging and sorting for you and you get compile checks on you linq query

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-03-11T14:08:30.217

我不确定，但你可以使用 LinqDataSource 吗？否则，我认为 GridView 要求数据位于 DataSet 中，以便它自己进行分页和排序。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-03-13T10:15:09.780

GridView 控件不支持对 IEnumerable<T> 进行排序和分页。但是您当然可以使用 List<T>。只需 .ToList() 您的结果集。

```
grid_PageIndexChanging(object sender, GridViewPageEventArgs e) {
        this.grid.PageIndex = e.NewPageIndex;
        this.grid.DataSource = this.DataSource;
        this.grid.DataBind();
    } 
```

# c# - DataGridView 绑定

> ID：634643
> 
> 赞同：2
> 
> 时间：2009-03-11T14:03:49.637
> 
> 标签：c#, winforms, .net-2.0

我有一个通过通用列表绑定到的 gridview。我自己设置了所有列。我只是想：

编辑行时捕获事件 PRE 格式错误 - 通过隐藏字段获取行信息 - 并保留

我确信这一定很容易，但我对表单工作做得并不多，而且我不熟悉它的 DataGridViews 事件。

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2009-03-11T14:17:26.263

有两种看待这个的方法；

*   处理[CellParsing](http://msdn.microsoft.com/en-us/library/system.windows.forms.datagridview.cellparsing.aspx)事件并解析值
*   `TypeConverter`在属性上使用自定义

我通常更喜欢后者，因为它使这种逻辑远离了 UI；我看看能不能举个例子。。。

* * *

示例（大部分代码是“显示它工作”代码）；在这里，我定义了 a `MyDateTimeConverter`，它将日期格式化/解析为它们**向后**的“dd MMM yyyy”文本（没有很好的理由），并将该转换器与其中一个属性相关联。您可以编辑网格中的值，并将更改推回（更改行以查看“实际”值更新）。由于更改通知的一些细微差别，它不会立即显示；仅仅为此而使示例更复杂是不值得的……

```
using System;
using System.Collections.Generic;
using System.ComponentModel;
using System.Globalization;
using System.Windows.Forms;

class Person
{
    public string Forename { get; set; }
    public string Surname { get; set; }

    [TypeConverter(typeof(MyDateTimeConverter))]
    public DateTime EditableValue { get { return ActualValue; } set { ActualValue = value; } }
    // this just proves what we have set...
    public DateTime ActualValue { get; private set; }
}
class MyDateTimeConverter : TypeConverter
{
    public override bool CanConvertFrom(ITypeDescriptorContext context, Type sourceType)
    {
        return sourceType == typeof(string) || base.CanConvertFrom(context, sourceType);
    }
    public override bool CanConvertTo(ITypeDescriptorContext context, Type destinationType)
    {
        return destinationType == typeof(string) || base.CanConvertTo(context, destinationType);
    }
    const string FORMAT = "dd MMM yyyy";
    public override object ConvertFrom(ITypeDescriptorContext context, System.Globalization.CultureInfo culture, object value)
    {
        if (value != null && value is string)
        {
            string s = (string)value;
            return DateTime.ParseExact(Reverse(s), FORMAT, CultureInfo.InvariantCulture);
        }
        return base.ConvertFrom(context, culture, value);
    }
    public override object ConvertTo(ITypeDescriptorContext context, CultureInfo culture, object value, Type destinationType)
    {
        if (destinationType == typeof(string))
        {
            return Reverse(((DateTime)value).ToString(FORMAT, CultureInfo.InvariantCulture));
        }
        return base.ConvertTo(context, culture, value, destinationType);
    }
    static string Reverse(string value)
    {
        char[] data = value.ToCharArray();
        Array.Reverse(data);
        return new string(data);
    }
}
class MyForm : Form
{
    public MyForm()
    {
        DataGridView grid = new DataGridView();
        grid.Dock = DockStyle.Fill;
        List<Person> people = new List<Person>();
        people.Add(new Person { Forename = "Fred", Surname = "Flintstone", EditableValue = DateTime.Today });
        people.Add(new Person { Forename = "Barney", Surname = "Rubble", EditableValue = DateTime.Today.AddDays(-25) });
        grid.DataSource = people;
        Controls.Add(grid);
    }
    static void Main()
    {
        Application.EnableVisualStyles();
        Application.Run(new MyForm());
    }
} 
```

# javascript - javascript中的for..in和for each..in有什么区别？

> ID：634654
> 
> 赞同：6
> 
> 时间：2009-03-11T14:06:48.707
> 
> 标签：javascript, loops, foreach, enumeration, for-in-loop

javascript中的for..in和for each..in语句有什么区别？是否存在我不知道的细微差别，或者是否相同，并且每个浏览器都有不同的名称？

* * *

## 回答 #1

> 赞同：14
> 
> 时间：2009-03-11T14:11:15.780

**"for each...in"**在指定对象属性的**所有值**上迭代指定变量。

例子：

```
var sum = 0;
var obj = {prop1: 5, prop2: 13, prop3: 8};
for each (var item in obj) {
  sum += item;
}
print(sum); // prints "26", which is 5+13+8 
```

[来源](https://developer.mozilla.org/en/Core_JavaScript_1.5_Reference/Statements/for_each...in)

**"for...in"**以任意顺序在对象的**所有属性**上迭代指定变量。

例子：

```
function show_props(obj, objName) {
   var result = "";
   for (var i in obj) {
      result += objName + "." + i + " = " + obj[i] + "\n";
   }
   return result;
} 
```

[来源](https://developer.mozilla.org/en/Core_JavaScript_1.5_Reference/Statements/for...in)

* * *

注意 03.2013，[不推荐使用](https://developer.mozilla.org/en-US/docs/JavaScript/Reference/Statements/for_each...in)`for each... in`循环。MDN 推荐的“新”语法是.[`for... of`](https://developer.mozilla.org/en-US/docs/JavaScript/Reference/Statements/for...of)

* * *

## 回答 #2

> 赞同：7
> 
> 时间：2009-03-11T14:15:14.273

这个演示应该有望说明差异。

```
var myObj = {
    a : 'A',
    b : 'B',
    c : 'C'
};
for each (x in myObj) {
    alert(x);        // "A", "B", "C"
}
for (x in myObj) {
    alert(x);        // "a", "b", "c"
    alert(myObj[x]); // "A", "B", "C"
} 
```

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2009-03-11T14:12:31.220

阅读优秀的 MDC 文档。

第[一个](https://developer.mozilla.org/en/Core_JavaScript_1.5_Reference/Statements/for...in#Description)是正常循环集合和任意对象的属性。

> for...in 循环不会遍历内置属性。其中包括对象的所有内置方法，例如 String 的 indexOf 方法或 Object 的 toString 方法。但是，循环将遍历所有用户定义的属性（包括任何覆盖内置属性的属性）。
> 
> for...in 循环以任意顺序迭代对象的属性。如果一个属性在一次迭代中被修改，然后在稍后的时间被访问，则循环暴露的值将是它在稍后时间的值。在访问之前删除的属性将不会在以后被访问。添加到发生迭代的对象的属性可以在迭代中访问或省略。一般来说，在迭代过程中最好不要在对象中添加、修改或删除属性，除了当前正在访问的属性；无法保证是否会访问添加的属性，是否会在修改之前或之后访问已修改的属性，或者是否会在删除之前访问已删除的属性。

后者允许您遍历对象的属性[。](https://developer.mozilla.org/En/Core_JavaScript_1.5_Reference:Statements:for_each...in)

> 在对象属性的所有值上迭代指定的变量。对于每个不同的属性，执行指定的语句。

* * *

## 回答 #4

> 赞同：2
> 
> 时间：2009-03-11T14:23:00.043

除了其他答案，请记住这`for each...in`不是 ECMA 标准的一部分，也不包含在[即将发布的 3.1 版本](http://wiki.ecmascript.org/doku.php?id=es3.1:es3.1_proposal_working_draft)中。它是在 JavaScript 1.6 中引入的，它是Mozilla 基金会[对 ECMAScript3 的扩展。](http://en.wikipedia.org/wiki/JavaScript#Versions)

根据链接的 Wikipedia 页面，它仅在 Firefox 1.5+ 和 Safari 3.x(+?) 中实现。

# linux - rsync 看不到什么？

> ID：634659
> 
> 赞同：1
> 
> 时间：2009-03-11T14:08:05.617
> 
> 标签：linux, filesystems, rsync, du

我想复制整个 linux 服务器，该服务器将通过网络停用，因此我们确定不会丢失任何内容。

我做了`du /`并且被告知有 60 GB 的 /

然后我`rsync -r / root@newserver:/old-server`做`du`了，在`old-server`目录中做时我得到了 22 GB。

那么为什么会有这种差异呢？有什么`du`看得见却`rsync`不能复制的东西吗？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2009-03-11T14:15:17.970

您可能已经删除了尚未释放的文件，因为它们上有打开的文件句柄。（我以前不知道 du 会从中看到用法，但一些测试表明确实如此。）您可以使用[lsof](http://en.wikipedia.org/wiki/Lsof)进行研究。根据我的经验，造成这种情况的两个主要原因是删除 Apache 日志而不踢 httpd 和从文件系统中删除 mysql 表，而不是使用 DROP TABLE。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-03-11T14:19:26.197

有一些特殊的文件系统您应该避免使用 复制`rsync`，例如`/proc`, `/sys`, `/tmp`. 他们可能会解释您看到的差异，尽管它似乎太大了。

可能有一些不可读的目录（例如，没有`r`或`x`在它们之上）。我不记得使用`root`权限运行的进程是否可以在不先修复权限的情况下访问此类目录。

更好地生成和比较文件列表及其 md5 总和。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-03-11T14:22:16.580

如果你有一点时间，你可以弄清楚到底有什么区别：`cd /; find . > /tmp/old`在旧服务器上运行，`cd /old-server; find . > /tmp/new`在新服务器上运行，然后`vimdiff`是这两个文件，看看有什么变化。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2009-03-12T08:50:50.003

一些建议：

*   [稀疏文件](http://en.wikipedia.org/wiki/Sparse_file)（使用 -S）
*   [硬链接](http://en.wikipedia.org/wiki/Hard_link)（使用-H）
*   `/proc`和`/sys`（使用 --exclude 或者更好的是 -x 并分别备份每个文件系统）

我倾向于`rsync -axHSW --numeric-ids`在类似的情况下使用。

# asp.net - 如何使用 ScriptManager 调用特定的类方法

> ID：634661
> 
> 赞同：0
> 
> 时间：2009-03-11T14:08:35.723
> 
> 标签：asp.net, asp.net-ajax

我创建了一个特定的服务器控件，其中包含一些我想从 javascript 调用的方法。我知道 ScriptManager 允许调用 Web 服务或页面方法。但是我想调用一个特定的类方法（我可以用 Anthem 甚至 AjaxPro.NET 来做到这一点）。有没有办法使用 ScriptManager 来完成这个？

谢谢。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-03-11T20:21:21.180

除了 Web 服务（asmx 或 WCF），您还可以调用页面方法。这些是用 [WebService] 属性装饰的页面的静态方法。您还需要将脚本管理器的 EnablePageMethods 属性设置为 true。这是一个快速示例：

```
<%@ Page Language="C#" %>
<%@ Import Namespace="System.Web.Services" %>

<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">

<script runat="server">

    [WebMethod]
    public static int AddOne(int arg)
    {
        return arg + 1;
    }

</script>
<html>
<head id="Head1" runat="server">
</head>

<body>
    <form id="form1" runat="server">
        <asp:ScriptManager ID="ScriptManager1" 
            runat="server" EnablePageMethods="true">
        </asp:ScriptManager>

        <script type="text/javascript">
        function doAdd ()
        {
            PageMethods.AddOne(2);
        }
        </script>

        <a href="javascript: doAdd()">click me</a>
        </form>
</body>
</html> 
```

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2009-03-11T14:27:48.173

该类需要作为 Web 服务公开。然后你可以使用 JSON 来访问它的客户端

例如：（在地址.asmx 等 ASMX 文件中）

```
[ScriptService]
[WebService(Namespace = "JsonPanels.Services")]
[WebServiceBinding(ConformsTo = WsiProfiles.BasicProfile1_1)]
[System.ComponentModel.ToolboxItem(false)]
public class Address : WebService {

    [WebMethod]
    public String LoadAddress() {
        return "some values...";
    } // webmethod::StoreValues
} 
```

在页面 aspx 文件中，您将需要一个引用 Web 服务的脚本管理器：

```
<asp:ScriptManager ID="ScriptManager1" runat="server">
    <Services>
        <asp:ServiceReference Path="~/Services/Address.asmx" />
    </Services>
</asp:ScriptManager> 
```

您的 javascript 函数将如下所示：

```
<script type="text/javascript">
    function callLoadAddress() {
        JsonPanels.Services.Address.LoadAddress(GetLoadAddress_success, OnFailed);
    }
    function GetLoadAddress_success(e) {
        var result = e;
        $get('resultAddress').innerHTML = result;
    }
    // --------------------------
    function OnFailed() {
        $get('resultFailed').innerHTML = "failed";
    }
</script> 
```

# c++ - 非静态 const 成员，不能使用默认赋值运算符

> ID：634662
> 
> 赞同：49
> 
> 时间：2009-03-11T14:08:47.347
> 
> 标签：c++, constants

我正在扩展的程序使用`std::pair<>`了很多。

在我的代码中有一点，编译器会抛出一个相当大的问题：

> 非静态 const 成员，'const Ptr std::pair, const double*>::first' 不能使用默认赋值运算符

我不太确定这是指什么？Ptr 类中缺少哪些方法？

导致此问题的原始调用如下：

```
vector_of_connections.pushback(pair(Ptr<double,double>,WeightValue*)); 
```

它把一个`std::Pair<Ptr<double,double>, WeightValue*>`放在一个向量上，哪里`WeightValue*`是一个来自大约 3 个函数的 const 变量，而`Ptr<double,double>`是从一个在另一个向量上工作的迭代器中获取的。

为了将来参考，`Ptr<double,double>`是一个指向`Node`对象的指针。

* * *

## 回答 #1

> 赞同：84
> 
> 时间：2009-03-11T14:20:24.447

你有这样的情况：

```
struct sample {
    int const a; // const!

    sample(int a):a(a) { }
}; 
```

现在，您在某些需要`sample`可分配的上下文中使用它 - 可能在容器中（如地图、矢量或其他东西）。这将失败，因为隐式定义的复制赋值运算符会沿着这条线做了一些事情：

```
// pseudo code, for illustration
a = other.a; 
```

但是`a`是常量！你必须使它成为非常量。这没有什么坏处，因为只要您不更改它，它在逻辑上仍然是 const :) 您也可以通过引入合适的来解决问题`operator=`，从而使编译器*不会*隐式定义一个。但这很糟糕，因为您将无法更改 const 成员。因此，有一个 operator=，但仍然不可分配！（因为副本和赋值不一样！）：

```
struct sample {
    int const a; // const!

    sample(int a):a(a) { }

    // bad!
    sample & operator=(sample const&) { }
}; 
```

**但是**，在您的情况下，明显的问题显然在于`std::pair<A, B>`. 请记住， a`std::map`是按它包含的键排序的。因此，您*无法*更改其键，因为这很容易使地图的状态无效。因此，以下内容成立：

```
typedef std::map<A, B> map;
map::value_type <=> std::pair<A const, B> 
```

也就是说，它禁止更改它包含的密钥！所以如果你这样做

```
*mymap.begin() = make_pair(anotherKey, anotherValue); 
```

映射向您抛出错误，因为在映射中存储的某些值对中，该`::first`成员具有 const 限定类型！

* * *

## 回答 #2

> 赞同：14
> 
> 时间：2010-12-07T07:21:25.223

我遇到了同样的问题，并遇到了这个页面。

[http://blog.copton.net/archives/2007/10/13/stdvector/index.html](http://blog.copton.net/archives/2007/10/13/stdvector/index.html)

从页面：

> 请注意，这不是 GNU 特定的问题。ISO C++ 标准要求 T 有一个赋值运算符（参见第 23.2.4.3 节）。我刚刚在 GNU 的 STL 实现示例中展示了这可能导致的结果。

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2009-03-11T14:20:27.163

据我所知，在某个地方你有类似的东西：

```
// for ease of reading 
typedef std::pair<const Ptr<double, double>, const double*> MyPair;

MyPair myPair = MAKEPAIR(.....);
myPair.first = .....; 
```

由于 MyPair 的成员是 const，因此您不能分配给它们。

* * *

## 回答 #4

> 赞同：-1
> 
> 时间：2009-03-11T14:19:20.177

至少提及编译器抱怨的对象。很可能您缺少自定义分配成员。如果您没有，则使用默认的。可能，您在该类中也有一个 const 成员（正在分配其对象），并且由于无法更改 const 成员，因此您遇到了该错误。

另一种方法：由于它是一个 class `const`，我建议你将其更改为 a`static const`如果这有意义。

# c# - C# - 真的需要在.net中进行调试吗

> ID：634664
> 
> 赞同：4
> 
> 时间：2009-03-11T14:09:42.930
> 
> 标签：c#, .net, debug-build

如果发布版本生成 .pdb 文件并且您可以进入每一行，放置断点等，那么为什么还要费心构建我的组件的“调试”版本呢？

我在我的项目中使用 c#，并且我在调试发布版本时没有问题。在 C++ 中，我在调试优化代码时遇到了问题，但在 C# 中它工作正常。我不是在谈论愚蠢的代码块，比如`if(false)`......

* * *

## 回答 #1

> 赞同：8
> 
> 时间：2009-03-11T14:12:32.190

发布版本更加优化，例如，当我调试发布版本时，当运行时不使用局部变量的值时，它们的值会消失，这让我很恼火。

* * *

## 回答 #2

> 赞同：7
> 
> 时间：2009-03-11T14:14:35.087

一个原因是附加与启动。

如果您在 .Net 中启动零售进程，则调试几乎与启动调试进程一样好。您可能不会注意到调试体验有任何不同。

Attach是一个完全不同的球类游戏。C# 和 VB 都通过了零售版本的 /optimize+ 标志。这将在没有 DebuggingMode.DisableOptimizations 标志的程序集级别嵌入[DebuggableAttribute](http://msdn.microsoft.com/en-us/library/system.diagnostics.debuggableattribute.aspx)。在进程启动期间，VS / CLR 将进行通信以基本上忽略这一事实并禁用影响调试的 JIT 优化。在附加期间，不会发生此类项目，并且 JIT/CLR 将优化它的核心内容。我向你保证，在这种情况下，调试体验要差得多。

您可以在 VS 中进行实验

*   将构建切换到发布
*   CTRL+F5 无需调试即可启动
*   附加到进程。

* * *

## 回答 #3

> 赞同：5
> 
> 时间：2009-03-11T14:15:05.600

在 (c#) winforms 中，您无法在发布版本中编辑和继续。

* * *

## 回答 #4

> 赞同：3
> 
> 时间：2009-03-11T14:24:00.460

除了其他答案之外，`#define DEBUG`当发生未捕获的异常时，我使用自动生成的来更改行为：

*   如果在发布模式下运行，向用户显示一条好消息并可选择记录错误，
*   如果在调试模式下运行，不要做任何事情（这会导致调试器中断）

* * *

## 回答 #5

> 赞同：2
> 
> 时间：2009-03-11T14:18:34.500

有几个原因：

*   默认情况下，发布版本不会在 PDB 文件中包含那么多调试信息。我相信这个选项过去更加突出 - 它现在位于输出下的“高级设置”中，可能的值是“无”、“完整”（调试版本的默认值）和“pdb-only”（发布的默认值）构建）。
*   默认情况下，发布版本是优化的：尽管由于 JIT 完成了大部分工作，这在 C# 中并没有像在其他语言（例如 C++）中那样产生很大的差异，但很可能存在*一些*差异，使其更难调试发布版本。
*   默认情况下，发布版本没有定义 DEBUG 符号，因此任何对`Debug.Assert`etc 的调用都将被删除。

当然，其中很多都可以在构建配置中进行更改。一种相当常见的方法是保留默认设置，*除了*在发布版本中包含更多调试信息，这可以为您提供更有用的堆栈跟踪（如果您使用调试器，则可以提供更好的调试体验*）*。

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2009-03-11T14:16:14.037

发布版本比调试版本执行额外的优化，但是调试版本也会稍微改变 GC 的行为，以确保您在调试会话期间不会从您的下方收集到对象。调试构建还可以防止在 JIT 期间发生某些优化，这将对您的调试会话产生负面影响。

* * *

## 回答 #7

> 赞同：0
> 
> 时间：2009-03-11T14:32:27.867

我同意 Lennaert - 我倾向于在构建之间进行不同的错误处理。例如，对于某些应用程序，我在调试版本中是超级肛门。前置条件和后置条件、断言、异常等。我基本上是在试图强制开发人员正确使用我的库。另一方面，在发布版本中，我放宽了条件以提高性能。

* * *

## 回答 #8

> 赞同：0
> 
> 时间：2009-03-11T14:34:55.550

当您使用**按合同设计**时，重要的是有两个构建 - 一个不检查**Preconditions**、**Postconditions**和**Class Invariants**的发布版本和一个检查它们的调试版本（通过**assertions**）。

在某些情况下，前置条件检查可能会在发布模式下保持活动状态（搜索相关问题），但这并不会改变整个故事。

在开发阶段，您检查所有合同假设，当您发布时，您不再检查它们 - 您知道您已经测试了代码并且它有效，所以您只需*依赖*之前的假设 - 这就是它们的目的首先。

# c# - 我应该在我的命名路由中的哪里添加一个（url 编码的）查询字符串？

> ID：634665
> 
> 赞同：0
> 
> 时间：2009-03-11T14:10:05.067
> 
> 标签：c#, .net, asp.net-mvc, routing

在我的 asp.net-mvc 控制器中，我接受一堆表单字段值，并从中创建一个 Lucene 库可以理解的字符串。然后我想重定向到一个 get 方法，该方法将根据这个 lucene 字符串显示结果。

lucene 字符串的格式为 {fieldName1:value1 fieldName2:value2 ...}

我的 Global.asax 具有以下重定向目标条目：

```
routes.MapRoute(
    "AdvancedSearch",
    "AdvancedSearch.mvc/{displayType}/luceneString",
    new { controller = "Search", action = "AdvancedSearch",
          displayType = "chip", luceneString = "" }
); 
```

所以我的控制器捕捉到帖子，创建 luceneString 并执行以下操作：

```
return RedirectToRoute("AdvancedSearch", new
    {
        Controller = "Search",
        action = "AdvancedSearch",            
        displayType = "chip",
        queryString = Url.Encode("company:test name:testname")
     }); 
```

这给了我一个 500: bad request。即使只有一个参数，它也不起作用。即使使用“：”也不起作用。
我试过：

*   AdvancedSearch.mvc/chip/company%3Atest+name%3AtestName
*   AdvancedSearch.mvc/chip/company:test+name:testName
*   AdvancedSearch.mvc/chip/company:test
*   AdvancedSearch.mvc/chip/company%3Atest

仅当我更改此 url 以采用以下格式的 queryString 时，它才有效

```
AdvancedSearch.mvc/chip?q=company%3Atest+name%3AtestName 
```

如果我必须使用查询字符串，我该如何在路由表中定义这样的东西？我该如何去调用重定向到它？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2009-03-11T15:01:52.273

首先，您的 MapRoute 不应包含任何有关查询字符串的内容。路由只包含 URI 的资源部分；它们不包括查询。

其次，您不需要对查询字符串进行编码；ActionLink/RouteLink/等。会为你做的。在构建 HREF 时，路由中未包含的任何标记都将自动成为编码的查询字符串参数。

消除：

```
/luceneString 
```

...从你的路线。

将您的代码更改为：

```
return RedirectToRoute("AdvancedSearch", new
{
    Controller = "Search",
    action = "AdvancedSearch",            
    displayType = "chip",
    q = "company:test name:testname"
 }); 
```

# c# - 在层边界上记录异常

> ID：634666
> 
> 赞同：2
> 
> 时间：2009-03-11T14:10:07.063
> 
> 标签：c#, .net

在第 196 页的应用程序架构指南 v2.0a（或点击此[链接](http://apparchguide.codeplex.com/Wiki/View.aspx?title=Chapter%2012%20-%20Data%20Access%20Layer%20Guidelines&referringTitle=Home)）中，作者提到了此指南：

“设计一个适当的异常传播策略。例如，允许异常冒泡到边界层，在那里可以根据需要记录和转换它们，然后再将它们传递到下一层。”

在 .NET (C#) 中完成此任务的最佳方法是什么？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-03-11T14:14:42.417

他的意思是你没有捕捉到每一堂课的错误。相反，你会遇到一个边界条件。通常，如果您将其视为 UI，并将 Web 服务（ASMX 或 WCF）作为 UI 包括在内，那么您将在这些层进行捕获。

在 Web 应用程序中，唯一的边界可能是 UI，因此您只能在网站本身上捕获异常。

在分布式应用程序中，您可能会有服务边界（如前所述的 Web 服务）并且您在那里捕获。

你不想做的是让堆栈中的每个类都捕获、记录和抛出相同的异常，因为你最终会得到太多的噪音和足够的信号。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-03-11T19:35:01.663

我认为当他们谈论层边界时，他们谈论的是安全敏感性发生变化的地方，或者呼叫来自您的影响范围之外。主要问题是安全敏感信息不会在异常情况下从您的应用程序中泄漏出来。因此，例如，如果数据库连接出错，则异常消息可能是“无法访问服务器名称上的数据库”。如果这种异常从您的应用程序中消失，它会给黑客您的数据库服务器的名称，这是一件坏事。

这些安全边界通常位于进程边界。在服务器应用程序上，这意味着任何公共 Web 服务、远程过程调用或类似的东西。在 Web 和 Win-Forms 应用程序中也有全局错误处理程序来处理任何未处理的异常。我不希望进程内 dll 包含这样的边界。

一旦您确定了每个边界入口点，您应该使用 try catch，然后将异常传递给[Microsoft 异常处理块](http://msdn.microsoft.com/en-us/library/cc309505.aspx)。异常处理块允许记录异常并允许您决定向用户抛出哪些异常详细信息。这有助于确保安全敏感信息不会在异常堆栈跟踪中从您的应用程序中泄漏出来。

## WinForms 中的全局异常处理程序：

在 WinForms 中有两个全局异常处理程序，它们被定义为每当有未处理的异常时触发的事件。最好的办法是在您的 main() 函数中在 Application.Run 语句之前绑定到这些，如下所示：

```
 static void Main()
    {
        AppDomain.CurrentDomain.UnhandledException += new UnhandledExceptionEventHandler(CurrentDomain_UnhandledException);
        Application.ThreadException += new ThreadExceptionEventHandler(Application_ThreadException);

        Application.Run(new Form1());
    } 
```

使用异常应用程序块，您将处理这些事件，如下所示：

```
 using Microsoft.Practices.EnterpriseLibrary.ExceptionHandling;

    // ...

    static void Application_ThreadException(object sender, ThreadExceptionEventArgs e)
    {
        bool rethrow = ExceptionPolicy.HandleException(e.Exception, "Thread Policy");
        if (rethrow)
        {
            Application.Exit();
        }
    }

    static void CurrentDomain_UnhandledException(object sender, UnhandledExceptionEventArgs e)
    {
        ExceptionPolicy.HandleException((Exception)e.ExceptionObject, "App Policy");
        // This event always exits the 
        // application so there is no point in looking at 
        // HanleException result.
    } 
```

这两个事件的区别在于 ThreadException 事件只处理由 WinForm 的线程创建的事件。如果您不在事件中重新抛出异常，它还将允许应用程序继续。UnhandledException 事件将捕获进程中的所有异常，但不允许您继续，因此它仅适用于日志记录。

最后，要让 MS Exception 块工作，您需要向 App.Config 文件添加一些配置，如下所示：

```
<?xml version="1.0" encoding="utf-8" ?>
<configuration>
  <configSections>
    <section name="exceptionHandling" type="Microsoft.Practices.EnterpriseLibrary.ExceptionHandling.Configuration.ExceptionHandlingSettings, Microsoft.Practices.EnterpriseLibrary.ExceptionHandling, Version=2.0.0.0, Culture=neutral, PublicKeyToken=e99c4c62013e92da"/>    
  </configSections>

  <exceptionHandling>
    <exceptionPolicies>
      <add name="App Policy">
        <exceptionTypes>
          <add name="App Exception" type="System.Exception, mscorlib" postHandlingAction="None" />
        </exceptionTypes>
      </add>
      <add name="Thread Policy">
        <exceptionTypes>
          <add name="App Exception" type="System.Exception, mscorlib" postHandlingAction="None" />
        </exceptionTypes>
      </add>
    </exceptionPolicies>
  </exceptionHandling>
</configuration> 
```

您通常会执行比这更复杂的异常策略，但我不会在这里讨论。

## ASP.Net 中的全局异常处理程序

在 ASP.Net 中，事情要容易一些。您需要做的就是在 Global.asax 文件中实现 Application_Error 事件。要获取最后一个错误调用 Server.GetLastError() 并继续而不重新抛出异常调用 Server.ClearError()。所以你的代码看起来像这样：

```
<%@ Application Language="C#" %>
<script runat="server">        
    void Application_Error(object sender, EventArgs e) 
    {
        Exception ex = Server.GetLastError();
        bool rethrow = ExceptionPolicy.HandleException(ex, "App Exception");
        if (!rethrow)
        {
            Server.ClearError();
        }
        Response.StatusCode = 500;
    }       
</script> 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-03-11T14:13:29.050

你的意思是，除了try/catch？

层边界的概念在 C# 中没有表示形式。您必须设计您的代码，以便您可以看到层边界，然后在这些边界处放置适当的 try/catch 块。

企业库中的异常处理应用程序块对此很有用，因为它允许您配置应如何包装异常。

# macos - sIFR 在 FF3 Mac 中不起作用

> ID：634668
> 
> 赞同：0
> 
> 时间：2009-03-11T14:11:26.810
> 
> 标签：macos, firefox, sifr

我认为这可能是我做错了，但我没有看到它在任何网站上运行，包括 Novemberborn.net。

有任何想法吗？CSS被加载了，所以标题被隐藏了，然后就像根本没有加载JS一样。

这可能是浏览器检测问题吗？

我正在使用最新的 Flash Player 版本 10 的 firefox 3。我也听到了其他 Mac 用户的抱怨。

适用于所有其他浏览器...

编辑：我删除了要隐藏的 CSS，它仍然不起作用。暂停后，它会加载 JS 并删除标题，但不会替换它们。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-03-11T23:13:29.020

检查您是否使用 AdBlock 扩展程序。它在 Firefox 3 下破坏了 Flash。你必须完全卸载它。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-03-30T21:31:31.663

只需禁用（而不是卸载）AdBlock/Filterset.G 即可解决 Windows 上 Firefox 3 中的问题。然而，事实证明 AdBlock/Filterset.G 已经被[AdBlock Plus](https://addons.mozilla.org/en-US/firefox/addon/1865 "AdBlock Plus")取代了。（不知何故，在对 Firefox 进行了多年的增量更新之后，我完全错过了这一点。）

sIFR 3 似乎与较新的[AdBlock Plus](https://addons.mozilla.org/en-US/firefox/addon/1865 "AdBlock Plus")兼容。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-04-17T21:22:53.217

有一个 WordPress sIFR 插件，它以某种方式检测 Mac 上的 adblock，并在 sIFR 处于活动状态时禁用它。黑客在该代码中的某个地方......我仍在寻找方法。这样，文本仍将按应有的方式显示。

谷歌：sIFR firefox 3 广告拦截

# iphone - Cocoa/iPhone：如何为我的应用创建简体中文本地化？

> ID：634674
> 
> 赞同：15
> 
> 时间：2009-03-11T14:13:25.090
> 
> 标签：iphone, cocoa, xcode, localization, internationalization

我正在本地化我的 iPhone 应用程序，我的英语、法语、德语和日语本地化工作没有任何问题。现在我正在尝试使简体中文本地化工作，无论我尝试什么，当我将手机设置为简体中文时，都不会使用中文 .lproj 包。

一个问题是我不确定应该调用什么本地化。我试过“中文”、zh-Hans、zh-CN、zh_Hans、zh_CN，但它们都不起作用。我什至在Remember The Milk 的应用程序包中四处挖掘，看看他们使用了什么。他们正在使用 zh_CN 但这对我不起作用。

我在这里遗漏了一些明显的东西吗？我需要在某处更新一些 plist 吗？据我阅读 I18N 文档和查看相关的 WWDC 会话视频所见，我需要做的就是确保我的应用程序包中有正确的 .lproj 包，我应该很高兴......对？

如果您认为这会有所帮助，我可以提供一个演示问题的测试 xcode 项目...

谢谢

* * *

## 回答 #1

> 赞同：34
> 
> 时间：2009-03-11T14:20:47.800

Simp 是 zh_CN。中文（简体中文），zh_TW 为繁体。中文（繁体中文）。

如果您在 Trad 下测试**zh_CN.lproj** **。中文**设置不行。只需确保您正在使用正确的系统语言设置测试您的应用程序。此外，Localizable.strings 应该使用 UTF-16 编码进行编码。

***更新***：
在最新[的本地化编程指南](https://developer.apple.com/library/ios/documentation/MacOSX/Conceptual/BPInternational/Introduction/Introduction.html)中，这些已更改为**zh-Hans**和**zh-Hant**。

> 特别是在汉语方言中，地区代码并不总是指定正确方言或文字的最佳方式。例如，繁体中文（汉）是台湾使用的默认语言，在 Mac OS X v10.3.9 及更早版本中由代码 zh_TW 标识。然而，繁体中文在香港和澳门也普遍使用，这意味着 zh_TW 指示符在这些地方并不完全准确。新标准为繁体中文 (Hant) 和简体中文 (Hans) 脚本定义了新标签。因此，在任何国家使用的繁体中文都使用代码zh-Hant。台湾使用的繁体中文现在使用区域设置代码 zh-Hant_TW。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2010-09-27T07:19:07.400

由于 iPhone 喜欢缓存资源，因此您应该清理您的应用项目并重新构建它。然后一切都会与您的本地化一起正常工作。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2010-10-12T11:49:36.407

当您为除中文以外的任何语言添加本地化时，您命名为阿拉伯语、德语等，但是对于中文，您必须在命名时进行限制，因为有 2 个中文（简单和繁体）所以在 iphone 本地化中，您必须命名为 zh_CN（对于简体中文）如果您放置了其他名称，则无法翻译，因此必须小心名称

zh_CN（简体中文）。

它解决了你的问题
:)

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2010-12-30T01:23:12.990

正如 digdog 上面所说：“此外，Localizable.strings 应该使用 UTF-16 编码进行编码。”

我发现 Localizable.strings 的 UTF-8 也可以，我成功制作了几种语言，包括 zh_CN

我被以下帖子指导：http: [//www.cocoabuilder.com/archive/cocoa/277415-localization-strings-in-utf16-vs-utf8.html](http://www.cocoabuilder.com/archive/cocoa/277415-localization-strings-in-utf16-vs-utf8.html)

# php - 哪个更有效，PHP 字符串函数或 PHP 中的正则表达式？

> ID：634676
> 
> 赞同：18
> 
> 时间：2009-03-11T14:14:16.677
> 
> 标签：php, regex, string, performance

我正在编写 PHP 代码来解析字符串。它需要尽可能快，那么正则表达式是要走的路吗？我有一种预感，PHP 字符串函数更昂贵，但这只是一个猜测。真相是什么？

这是我需要对字符串执行的具体操作：

抓取前半部分（基于子字符串“000000”的第三个位置）并将其哈希值与接下来的 20 个字节进行比较，丢弃任何剩余的内容。

通过下一个“000000”将第9个字节解析为一条数据。然后抓取接下来的 19 个字节，并将其分成 8 个（折腾 1）和 8 个。然后我做一些其他的事情，将这两个 8 字节的字符串转换为日期。

所以这就是我需要做的事情。

* * *

## 回答 #1

> 赞同：16
> 
> 时间：2009-03-11T14:20:57.300

这取决于您的情况：如果您正在尝试做一些相当基本的事情（例如：搜索字符串，用其他内容替换子字符串），那么常规字符串函数就是要走的路。如果你想做一些更复杂的事情（例如：搜索 IP 地址），那么 Regex 函数绝对是一个更好的选择。

我没有分析正则表达式，所以我不能说它们在运行时会更快，但我可以告诉你，花费额外的时间使用基本函数来破解等价物是不值得的。

* * *

**使用 OP 中的新信息进行编辑：**

听起来好像您实际上需要在这里执行一些小字符串操作。由于每个单独的都是非常基本的，我怀疑您是否能够使用正则表达式一次完成所有这些步骤（甚至是其中的几个步骤），我将使用基本功能：

> 抓取前半部分（基于子字符串“000000”的第三个位置）并将其哈希值与接下来的 20 个字节进行比较，丢弃任何剩余的内容。

使用：[`strpos()`](http://php.net/strpos)和 或：[`substr()`](http://php.net/substr)
`/$(.*?0{6}.*?0{6}.*?)0{6}/`

> 然后抓取接下来的 19 个字节，并将其分成 8（折腾 1）和 8。

使用：-（`substr()`我*假设你的意思是 17 个字节——8 + 1 + 8）*

```
$part1 = substr($myStr, $currPos, 8);
$part2 = substr($myStr, $currPos + 9, 8); 
```

* * *

## 回答 #2

> 赞同：6
> 
> 时间：2009-03-11T14:17:15.080

我相信有一个阈值，正则表达式比一堆 PHP 字符串函数调用更快。无论如何，很大程度上取决于你在做什么。你必须找出平衡。

现在您已经编辑了您的问题。我会使用字符串函数来完成你想要完成的事情。strpos() 和 substr() 是第一眼想到的。

* * *

## 回答 #3

> 赞同：6
> 
> 时间：2009-03-11T14:20:39.907

我认为如果您想要最高性能，您应该避免使用正则表达式，因为它有助于最大程度地减少工作量，但不会获得最佳性能，因为您几乎总是可以使用字符串例程调整代码以解决特定问题并获得很大的性能提升。但是对于无法进行太多优化的简单解析例程，您仍然可以使用正则表达式，因为它在那里不会产生很大的影响。

编辑：对于您发布的这个特定问题，我更喜欢字符串操作，但这只是因为我不知道如何在正则表达式中进行操作。这似乎很简单，除了散列，所以我认为正则表达式/字符串函数不会有很大的不同。

* * *

## 回答 #4

> 赞同：4
> 
> 时间：2009-03-11T14:23:03.130

如果您正在做的事情完全可以合理地使用字符串函数，那么您应该使用它们。就像，如果您要确定常量字符串是否`'abc'`出现在 中`$value`，您肯定要检查`strpos($value, 'abc') !== false`，而不是`preg_match('/abc/', $value)`。但是，如果您发现自己进行了大量的字符串改组和转换以完成您使用正则表达式所做的事情，那么您几乎可以肯定最终会破坏性能和可维护性。

但是，当关心速度时，当它归结为它时，不要考虑它，计时。命令是你的`time`朋友。

* * *

## 回答 #5

> 赞同：4
> 
> 时间：2009-03-12T00:24:04.513

一般来说，字符串函数更快，正则表达式函数更灵活。

与其他任何事情一样，您的结果可能会有所不同，唯一确定的方法是尝试两种方式并进行基准测试。

* * *

## 回答 #6

> 赞同：2
> 
> 时间：2017-04-20T11:55:47.217

我同意每个人的观点：字符串函数比正则表达式函数更高效。我只是想展示一个小测试，我在终端中做了一个证明：

**strpos()**：

```
$ time php -r '$i = 0; while($i++ < 1000000) strpos("abc", "a");'

real    0m0.380s
user    0m0.368s
sys    0m0.008s 
```

**preg_match()**：

```
$ time php -r '$i = 0; while($i++ < 1000000) preg_match("/abc/", "a");'

real    0m0.441s
user    0m0.432s
sys    0m0.004s 
```

* * *

## 回答 #7

> 赞同：1
> 
> 时间：2009-03-11T14:16:29.637

本机字符串函数要快得多。regexp 的好处是你可以用它们做几乎任何事情。

* * *

## 回答 #8

> 赞同：0
> 
> 时间：2009-03-11T14:22:39.933

取决于你的需要。大多数正则表达式操作比人们想象的要快，甚至可以在某些琐碎的操作中胜过内置的字符串函数。请注意，我想到的是 preg 库，而不是内置的正则表达式库，它很慢。

* * *

## 回答 #9

> 赞同：0
> 
> 时间：2018-09-14T09:11:21.083

我正在搜索有关正则表达式性能的一些信息 - 因为我需要进行大量查找 - 而事实是这*取决于您想要实现的目标*。出于我的目的，我测试了一种搜索来比较性能。

规范：我需要在字符串数组中找到简单的字符串。为了测试我有`$testArray`哪些是从关于托尔金的文章中构建的约 11k 多词短语的数组（例如字符串“指环王的历史”、“克里斯托弗·托尔金”）。因为我只想找到包含确切单词的短语，所以我不能使用`strpos()`例如函数。在搜索“铃声”时，它还会找到带有“铃声”字样的短语。

使用php函数的代码：

```
$results = array();
$searchWord = 'rings';
foreach ($testArray as $phrase){
  $phraseArr = explode(' ', $phrase);
  if(in_array($searchWord, $phraseArr)){
    $results[] = $phrase;
  }
} 
```

使用正则表达式函数的代码：

```
$results = array();
$pattern= "/( |^)rings( |$)/";
$results = preg_grep($pattern, $testArray); 
```

我发现在这种情况下，**正则表达式函数快了大约 10 倍**

100 次搜索的执行时间是（使用各种词）

*   php 函数从 0.3436 到 0.3468 秒
*   正则表达式从 0.0332 到 0.0406 秒

这样的搜索可能很简单，但对于更复杂的任务，我认为如果没有正则表达式，仅在本机 php 函数上实现它是非常困难/不可能的。

**总之**：对于简单的任务，您应该使用正则表达式，因为它可能会**更快**，而对于复杂的任务，您**可能**必须使用正则表达式，因为它是解决问题的唯一方法。

## 编辑：

我刚刚意识到这个主题是关于“PHP**字符串**函数”以及我的测试代码使用`explode()`和`in_array()`函数的。所以我尝试了其他方法。由于我的分隔符是空间搜索方法，因此下面的方法也可以使用并使用`strpos()`功能。

使用`strpos()`函数的代码：

```
$results = array();
$searchWord = 'rings';
foreach ($testArray as $phrase){
  if(strpos(' ' . $phrase . ' ', ' ' . $searchWord . ' ')!==FALSE){
    $results[] = $phrase;
  }
} 
```

但是结果仍然比正则表达式的情况差很多。

所以**性能总结**是：

*   php 数组函数从 0.3436 到 0.3468 秒
*   从 0.2001 到 0.2273 秒的`strpos()`函数
*   正则表达式从 0.0332 到 0.0406 秒

正则表达式仍然是一个大赢家。

# c++ - 将索引多边形转换为未索引多边形。出现了几个问题

> ID：634680
> 
> 赞同：1
> 
> 时间：2009-03-11T14:15:02.590
> 
> 标签：c++, algorithm, geometry, polygon

我再次对多边形算法有一些疑问。

我将尝试解释我的问题：

我正在使用名为 Geometric Tools(GT) 的第三方库的一个子集来对我的多边形执行布尔运算。为此，我必须将我的内部多边形格式转换为 GT 使用的格式。

我们的内部多边形格式由一个顶点数组组成，而 GT 多边形由一个索引顶点数组组成，其中每条边由一对索引表示。

用于澄清的正方形示例：

内部格式：

```
vertices[0] = Vertex2D(1,0) -> start
vertices[1] = Vertex2D(1,1)
vertices[2] = Vertex2D(0,1)
vertices[3] = Vertex2D(0,0)
vertices[4] = Vertex2D(1,0) -> end 
```

外部格式：

```
vertices[0] = Vertex2D(1,0) 
vertices[1] = Vertex2D(1,1)
vertices[2] = Vertex2D(0,1)
vertices[3] = Vertex2D(0,0)

edges[0] = std::pair<int,int>(0,1)
edges[1] = std::pair<int,int>(1,2)
edges[2] = std::pair<int,int>(2,3)
edges[3] = std::pair<int,int>(3,0)

//There is also a BSP tree of the polygon which I don't care to depict here. 
```

现在，我编写了一个在大多数情况下都有效的算法，但是当两条边共享相同的起始顶点时会崩溃和烧毁。让我首先解释一下我当前的算法是如何工作的。

创建一个 std::map ，其中键是表示顶点索引的整数。该值表示边缘数组中的哪条边以键索引作为起始索引。

样机示例：

```
std::vector< std::pair< int, int > > edge_array;

edge_array.push_back( std::pair< int, int >( 0, 1 ) );
edge_array.push_back( std::pair< int, int >( 2, 3 ) );
edge_array.push_back( std::pair< int, int >( 1, 2 ) );
edge_array.push_back( std::pair< int, int >( 3, 0 ) );

std::map< int, int > edge_starts;
for ( int i = 0 ; i < edge_array.size(); ++i ) {
  edge_starts[ edge_array[i].first ] = i;
} 
```

要从正确的边缘跳到正确的边缘，我现在可以在 while 循环中执行以下操作：

```
while ( current_placed_index = first_index_in_polygon ) {
  int index_to_next_edge_to_be_traversed = edge_starts[ current_edge.second ];
} 
```

在这个循环中进行了一些优化，并将顶点索引添加到数组中。

每次关闭多边形时，我都会找到第一个未遍历的边并开始制作另一个多边形。我继续这样做，直到 GTPolygon 中不再有未遍历的边缘。

所以每个 GTPolygon 可以产生几个 Polygon(internal) 对象。

当有两条边共享同一个顶点作为起始顶点时，该算法的缺陷就很明显了。例子：

```
<1,2>
<1,3>
<1,5> 
```

当遍历我的边时，我如何知道这些边中的哪一个属于我当前正在遍历的多边形？当发生这种重复情况时，我可以尝试向后遍历边缘。那么问题将是如果在反转时发现另一个重复项，则遍历可能会无限地来回进行。

我的问题是，我该如何解决这个问题？完全可以解决吗？我可以使用 BSP 树以某种方式解决这个问题吗？角落案例的数量有点令人生畏。

非常感谢任何帮助，因为 5 个月的工作取决于这项工作。

**编辑：**

澄清一下：我想从几何工具使用的多边形的索引表示转换为我们的内部多边形格式，这只是列表中的一系列连接顶点。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2009-03-11T19:36:45.700

您实际上是在尝试在[无向](http://www.brpreiss.com/books/opus4/html/page529.html)[图中找到所有](http://en.wikipedia.org/wiki/Graph_(mathematics))[循环](http://en.wikipedia.org/wiki/Cycle_(graph_theory))，其中每个循环代表一个唯一多边形的边缘。[本文](http://www.me.utexas.edu/~bard/IP/Handouts/cycles.pdf)提出了一种[深度优先搜索（DFS）](http://en.wikipedia.org/wiki/Depth-first_search)解决方案。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-03-12T14:37:32.340

哈哈，好吧伙计们。似乎所有的喧嚣都是徒劳的。我发现几何工具有它自己的类来处理这些问题。

示例在 [这里](http://www.geometrictools.com/SampleFoundation/MinimalCycleBasis/MinimalCycleBasis.html)找到。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-03-11T16:48:36.277

为什么不将多边形显式存储为有序的边集合？这将确保您始终知道给定多边形应考虑哪些边。

# c# - 根据文本文件上的列表更快地从 SQL Server 中选择元素

> ID：634684
> 
> 赞同：2
> 
> 时间：2009-03-11T14:15:24.913
> 
> 标签：c#, sql-server

我正在开发应该执行简单搜索功能的 .NET windows 应用程序。该应用程序通过它们在 SQLServer 数据库中的序列号搜索一些卡，这些序列号被导入到一个文本文件中，我只需在文件上打开一个 StreamReader 并开始读取行 - 因为每一行只包含一个序列号。检索数据后，我将它们全部显示在 DataGridView 上。

文件上的那些连续剧不是按一定的顺序排列的（即我做不到`Select * from table where serial between( min and max)`）；他们完全没有关系。所以不用多说，这就是我所做的：

```
DataTable table = new DataTable()

 StreamReader stream= new StreamReader(fileName);                

            while (!stream.EndOfStream) {
                string serial = stream.ReadLine();
                SqlDataReader reader= GetCardBySerial(serial);
                table.Load(reader);
                reader.Close();
            }

  public SqlDataReader GetCardBySerial(string serialNo) {

        SqlConnection cnn = new SqlConnection(connectionString);
        SqlCommand cmd = new SqlCommand("Cards_GetCardBySerial", cnn);
        cmd.CommandType = CommandType.StoredProcedure;
        cmd.Parameters.Add("@serialNo", SqlDbType.NVarChar).Value = serialNo;
        cnn.Open();
        return cmd.ExecuteReader(CommandBehavior.CloseConnection);   

    } 
```

虽然这有效，但对我来说很慢。应该做些什么来加快搜索速度？

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2009-03-11T14:25:22.097

我认为最快的方法是将连续序列批量插入 SQL Server 上的表中。然后通过将搜索表连接到序列号的卡片表中，使用单个 SQL 语句搜索所有序列号。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2009-03-11T14:19:53.997

看起来您正在为每个查询打开一个新连接。

您最好创建一个连接，然后为每个查询重用它。

```
DataTable table = new DataTable()
SqlConnection cnn = new SqlConnection(connectionString);

StreamReader stream = new StreamReader(fileName);                

while (!stream.EndOfStream) {
    string serial = stream.ReadLine();
    SqlDataReader reader = GetCardBySerial(serial, cnn);
    table.Load(reader);
    reader.Close();
}
cnn.Close();

public SqlDataReader GetCardBySerial(string serialNo, SqlConnection cnn) {
    SqlCommand cmd = new SqlCommand("Cards_GetCardBySerial", cnn);
    cmd.CommandType = CommandType.StoredProcedure;
    cmd.Parameters.Add("@serialNo", SqlDbType.NVarChar).Value = serialNo;
    return cmd.ExecuteReader();
} 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-03-11T14:20:18.333

您有几个选项可以加快速度。我知道我更喜欢哪个，但你必须去你觉得最舒服的地方。

由于这是每行一个序列，请考虑将序列加载到表格以外的其他东西中。如果您想要 A 到 Z 或 1 到 9 类型的排序，SortedList 可以工作。

另一种选择是使用 LINQ。有一些方法可以针对平面文件完成此操作，但如果您希望以这种方式加载数据，也可以针对对象完成此操作。

由于您拥有大量连续剧，我可能会使用不同的持久存储，因为平面文件总是需要一些时间来加载。

添加于 2008 年 3 月 11 日上午 9:36 CST

谢谢你的澄清。我认为排序是问题所在。为了加快数据访问速度，您必须一次获取更多数据。尽管建议使用单个连接，但这不会显着提高性能，因为从底层池实例化连接不是您的问题。这是大量的查询（20k +）。

为了加快速度，您必须在单个查询中要求更多。一种选择是创建动态 SQL 语句来请求序列。另一种是使用 XML 并让 SQL 将其用作内存中的“表”。

无论你做什么，你都会用一些延迟时间来换取 SQL 时间。但是，在我能想到的每一种情况下，延迟都会在 SQL Server 时间之前很久就杀死你。

如果您的目标是加载，您可以直接从文件中 BCP 或 BULK_INSERT。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2009-03-11T14:26:32.653

没有金子弹解决方案，但我建议将整个序列的文件读入内存，也许读入 iEnumerable，以便您可以在其上使用 Linq 并以这种方式获取排序列表。

我可能会在我的 SQL 数据库中使用临时表来存储序列，然后使用连接表的存储过程通过阅读器将匹配的记录直接提取到表中。这样一来，您就可以将大部分精力转移到最适合此活动的 SQL Server 上。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2009-03-11T14:34:26.613

与其在数据库上进行 20K 查找，不如创建一个临时 SQL 表来保存所有所需的序列号，然后加载它。然后，在该表上建立一个索引，允许您的 DBMS 在最近导入的序列号和数据库中已有的卡之间进行合并连接。

对这两个表的连接进行查询，并处理查询结果以供显示。

然后您可以删除或截断临时表。

在新表上建立索引需要一些时间，但比 20k 查询要少得多。

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2009-03-11T14:34:50.373

底线：使用临时表进行连接。
1）（一次性）创建一个具有唯一会话 ID 的新“临时”加载表，以区分从给定文件加载的行。
2）（一次性）创建一个新的存储过程，该过程从源表连接到卡序列号上的“临时”表，其中会话 ID 是新参数。
3）在运行查询之前，将文本文件中的数据一次性批量加载到该“临时”表中，在该表中为其分配一个新的会话ID（我会为此使用一个guid）。
4) 运行单个新 SP，将其作为新的单个参数提供 guid。

您现在应该对服务器运行一个查询，而不是数千个小查询。

**编辑**
我不会使用真正的临时表。创建一个包含两个字段（会话（PK、unique_identifier）、卡 ID（您的数据类型））的真实表，然后在这两个字段上创建索引。这样，您不必担心每次都创建/删除表。相反，创建另一个可以调用的 SP 来清理临时行。

* * *

## 回答 #7

> 赞同：0
> 
> 时间：2009-03-11T14:36:43.660

您可以考虑另外两个选项，具体取决于您的 mssql 版本......您可以从导入的序列构建 xml 并将其发送到数据库，在数据库端解析并一次返回所有匹配项。另一个选项是类似的，构造一个由所有导入的序列号组成的长逗号分隔字符串，并将其发送到存储过程中，并将其发送到数据类型为 varchar(max) 的变量中，该变量可以保存 2Gb 的文本。然后在查询中使用“in”子句 - 再次消除对数据库的多次访问。

# java - 关于 Hibernate 使用 Dynamic-Map 实体模式保存

> ID：634687
> 
> 赞同：0
> 
> 时间：2009-03-11T14:16:14.427
> 
> 标签：java, hibernate, hashmap

在下面的例子中，如何在不加载角色的情况下将角色的值保存到 id=1 的角色中？我努力了：

```
Map user = new HashMap<String,Object>();

user.put("address","Address test");
user.put("role",1);

session.save("User",user); 
```

但这会导致：

```
java.lang.ClassCastException: java.lang.Integer cannot be cast to java.util.Map
    at org.hibernate.property.MapAccessor$MapGetter.get(MapAccessor.java:90) 
```

和

```
Map user = new HashMap<String,Object>();

user.put("address","Address test");
user.put("role.id",1);

session.save("User",user); 
```

不保存角色，控制台显示此 SQL： Hibernate: insert into user (ts, address) values (?, ?)

任何帮助将不胜感激。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2009-03-11T14:20:00.110

看起来角色应该是地图

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-03-11T15:01:06.580

在我看来，您需要`Session`在地图模式下工作。我认为是这样的：

```
 SessionFactory sf = ...;
  Session s = sf.openSession();
  Session ds = s.getSession(EntityMode.MAP); 
```

然后`ds`像你已经尝试过的那样工作。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-06-03T19:11:13.030

答案是：

```
Map<String,Object> user = new HashMap<String,Object>();

user.put("address","Address test"); 

user.put("role", session.load("Role",1));

session.save("User",user); 
```

这个句子：

```
session.load("Role",1) 
```

不会使休眠状态命中数据库，并且对 id=1 的角色的引用成功地保留在新用户中。

# c# - Parsing an XML/XHTML document but ignoring errors in C#

> ID：634693
> 
> 赞同：2
> 
> 时间：2009-03-11T14:17:23.613
> 
> 标签：c#, xml

I'm writing some little applications that parse the source of a few web pages, extract some data, and save it into another format. Specifically, some of my banks don't provide downloads of transactions/statements but they do provide access to those statements on their websites.

I've done one fine, but another (HSBC UK) is proving a pain in the arse, since its source is not valid XHTML. For example there is whitespace before the `<?xml?>` tag, and there are places where `==` is used instead of `=` between an attribute name and its value (e.g. `<li class=="lastItem">`).

Of course, when I pass this data into my `XmlDocument`, it throws a wobbly (more accurately an exception).

My question is: is it possible to relax the requirements for XML parsing in C#? I know it's far better to fix these problems at source - that's absolutely my attitude too - but there's roughly zero chance HSBC would change their website which already works in most browsers just for little old me.

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2009-03-11T14:29:56.453

Take a look at the [HTML agility pack](http://www.codeplex.com/htmlagilitypack). It allows you to extract elements of a non-XHTML-compliant web page through XPath, as if it were a well-formed XHTML document.

And for the love of Kleene, don't try to regexp a HTML page with any kind of complexities!

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2009-03-11T14:21:31.840

I don't believe you can relax the parsing, but you could run it through something like [HTML Tidy](http://tidy.sourceforge.net/) first to let *that* deal with the mess.

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-03-11T14:23:17.030

If they are not XHTML compliant, you cannot shove the HTML into an XMLDocument object, no matter how hard you try.

If this is low volume, you can use the WebBrowserControl to create an empty HtmlDocument object and then use the Write() method of HtmlDocument to put the string you retrieved to scrape from.

Another option is mshtml.HTMLDocument, which is a bit of a pain to work with in .NET, as it is interop.

The most common type of screen scrape is using Regex, however. Once you determine the pattern you are loooking for, you can scrape over and over again.

# sql-server - 无法生成邮件报告。执行 Transact-SQL 语句或批处理时发生异常。提供 @id 或 @name

> ID：634712
> 
> 赞同：0
> 
> 时间：2009-03-11T14:21:33.463
> 
> 标签：sql-server, sql-server-2005, alerts

在 SQL Server 2005 中，我设置了一个维护计划来备份数据库。我有一个通知任务。我收到一封空白电子邮件。维护作业历史显示错误：

无法生成邮件报告。执行 Transact-SQL 语句或批处理时发生异常。请提供 @id 或 @name。

我已经设置了数据库邮件，我已经在 SQL Server 代理中启用了警报。我设置了默认配置文件。我已经重新启动了代理。

来自数据库电子邮件的测试电子邮件确实可以正常工作。

我该怎么做才能排除和解决此错误？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-03-16T16:41:48.510

首先要做的是调出 Management Studio，展开管理节点，右键单击 Database Mail 并选择**Send Test E-Mail**

在此功能正常工作之前，尝试其他任何方法都没有意义。

如果您尚未设置**数据库邮件**，请右键单击该节点并选择**配置数据库邮件**

**编辑，（在答案中包含评论）：**

* * *

如果这有效，则可能是您的维护计划的发送警报部分设置不正确。虽然可以编辑失败的计划，但使用向导重新创建整个事情可能更容易，特别注意通知部分 - 特别是当其他维护计划正常工作时。

其他人报告*（感谢 Brent）*当维护计划错误地从服务器复制到服务器或升级 SQL Server 时，他们看到了类似的错误。

# sql-server - 有没有办法使用 SSIS 将 Excel 工作表文件（2.1 版）导入 SQL 2005？

> ID：634718
> 
> 赞同：0
> 
> 时间：2009-03-11T14:22:56.143
> 
> 标签：sql-server, excel, ssis, import

作为每周日期更新的一部分，我从我们的一位客户那里收到了一份 Excel 工作表文件（2.1 版）。我正在尝试将其合并到我们的自动更新过程中，但我无法在 SSIS（或 Sql Management Studio）中导入文件，因为我可以处理的最旧格式是 Excel 3.0。

是否有更新会增加对这种旧格式的支持？或者可能是我可以让 SSIS 执行以将 Excel 工作表转换为 SSIS 可以处理的另一种格式的实用程序？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-03-11T14:27:52.260

2.1是什么版本？那是Excel 2000吗？

在任何情况下，如果客户使用的 Excel 版本太旧以至于没有 ODBC 提供程序，那么他们应该向您发送带有标题的 CSV。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-05-26T16:37:56.507

您使用 SSIS 只是为了导入文件还是这是一些更大的解决方案的一部分，其中一个步骤是导入 excel 文件。如果没有，那么您应该使用 dll 并从某个地方调用它。这个例子可以帮助你[http://www.codeproject.com/Articles/115578/Excel-to-SQL-without-JET-or-OLE-Version-2](http://www.codeproject.com/Articles/115578/Excel-to-SQL-without-JET-or-OLE-Version-2)

如果导入是更大解决方案的一部分，那么您仍然可以将其作为外部 dll 并使用 SSIS 调用它。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-03-11T14:28:11.387

至少就目前而言，我能想到的唯一方法是使用执行流程任务并让该任务使用 Office 位来转换 Excel 文件。我不确定代码到底是什么样子，但是在你完成之后，你会得到一个新格式的文件，它可以被 SSIS 使用。

# ruby - Ruby 中的 GServer 线程问题

> ID：634723
> 
> 赞同：1
> 
> 时间：2009-03-11T14:23:52.270
> 
> 标签：ruby

环顾四周，我发现[http://www.devco.net/archives/2008/06/26/adventures_with_ruby.php](http://www.devco.net/archives/2008/06/26/adventures_with_ruby.php)博客作者抱怨 GServer 破坏线程并达到其最大连接数的错误。这个问题是真的/仍然是真的吗？

谢谢

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2010-07-05T03:57:21.370

在 Ruby 1.9.1 中，我也遇到了 GServer 的两个问题。

1.  它突然停止
2.  它确实存在内存泄漏

[http://tora-japan.com/wiki/GServer_in_Ruby_1.9.1_has_two_problems](http://tora-japan.com/wiki/GServer_in_Ruby_1.9.1_has_two_problems)

然后，我自己为 Ruby 1.9.1 编写了一个预线程 TCP 服务器，链接自上面的 wiki 页面。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-03-12T14:01:52.830

[在使用 GServer 作为简单的 TCP 服务器时，我遇到了类似的问题，但是由于我最初计划使用EventMachine](http://rubyeventmachine.com/)，所以我没有深入研究这个问题。

最后，我只是移植了我的代码以使用该库并很高兴。

抱歉，我不知道真正的答案，但我知道我在使用 GServer 时遇到了问题，并且自从我切换到 EM 后，我对它非常满意——所以你可能想调查一下。一旦我了解了 EM 的工作原理，替换库就不是太难了。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-02-13T19:46:45.533

Eventmachine 很棒：

类服务器

```
module Thread_server

  def receive_data data

    data.chomp
    {.......................}

  end
end 
```

def self.perform

```
 EventMachine::run {

  EventMachine::start_server "xxx.xxx.xxx.xxx", pxoxrxt, Thread_server

  } 
```

结尾

结尾

# java - 如何将 UTF-8 字符转换为 ISO Latin 1？

> ID：634727
> 
> 赞同：6
> 
> 时间：2009-03-11T14:25:28.367
> 
> 标签：java, character-encoding

我需要将 UTF-8 商标符号转换为 ISO Latin 1，并将其保存到数据库中，该数据库也是 ISO Latin 1 编码的。

我怎么能在java中做到这一点？

我试过类似的东西

```
String s2 = new String(s1.getBytes("ISO-8859-1"), "utf-8"); 
```

但它似乎不像我预期的那样工作。

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2009-03-11T14:29:51.913

Java 中的字符串始终采用 Unicode（UTF-16，有效）。仅当您尝试从文本转换为二进制编码时才需要转换，反之亦然。

涉及的角色是什么？你确定它甚至出现在 ISO Latin 1 中吗？如果是这样，我希望您的数据库可以毫无问题地存储该字符。没有“UTF-8 商标标志”之类的东西。您可以使用“表示商标符号 UTF-8 编码的字节”，但这将是一个字节数组，而不是一个字符串。

编辑：如果您的意思是[Unicode 商标字符](http://www.fileformat.info/info/unicode/char/2122/index.htm)U+2122，那超出了 ISO-Latin-1 的范围。有[注册商标字符](http://www.fileformat.info/info/unicode/char/00ae/index.htm)U+00AE，这不是一回事（无论是在外观上还是在法律意义上，IIRC）但总比没有好 - 如果你想使用它，那么只需使用：

```
string replaced = original.replace('\u2122', '\u00ae'); 
```

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2014-02-20T12:42:25.503

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2009-03-11T14:34:03.183

1.  阅读 Jon Skeet 告诉你的内容。您发布的代码是垃圾（它采用您的字符串的 UTF-8 编码形式并将其解释为好像它是 ISO-8859-1，这没有任何用处）。
2.  ISO-8859-1 编码（又名 Latin1）不包含商标字符“™”。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2012-02-22T10:11:24.417

我有一个类似的问题，并通过转换实体中的不可翻译字符来解决它。如果您稍后将信息显示为 html，则无论如何都可以。

如果没有，您可以尝试将它们转换回 unicode。

带有“商标”的python示例：

```
s = u'yellow bananas\u2122'.encode('latin1', 'xmlcharrefreplace')
# s is 'yellow bananas&#8482;' 
```

# sharepoint - 在 Sharepoint 2007 中配置 Outlook Webpart

> ID：634732
> 
> 赞同：1
> 
> 时间：2009-03-11T14:26:26.943
> 
> 标签：sharepoint, sharepoint-2007, outlook, moss, web-parts

我正在探索共享点。我想显示登录用户的电子邮件收件箱和日历。不同用户的登录没有问题。我们正在运行 Exchange 2003，并且正在使用 Web 访问。这也没有任何问题。

我将 OWACalendarPart 添加到 default.aspx 页面。当我将*邮件服务器地址*设置为我们的邮件服务器时。我必须将邮箱设置为某些东西。当我进入我的邮箱时，它会显示我的邮箱，但是对于每个登录的用户。他们必须输入凭据，而我没有。当我输入**“？”** 该控件显示整个 Outlook Web 界面，而不仅仅是日历。在这种情况下，控件适用于每个用户及其数据。

我在这里错过了什么吗？当我必须为每个用户配置它时，这个 webpart 有什么用？如何让日历显示当前共享点用户的数据？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-06-11T12:55:02.173

抱歉，这是默认行为，MS 希望用户仅在其 MySite 上自行添加 webpart。但是可以这样做：

大多数人使用包装器 webpart / 控件来为当前用户显示 OWA webpart，这里是我的代码：

```
protected override void CreateChildControls()
{
  try
  {
    //Create the instance of My Inbox Web Part 
    OWAInboxPart inbox = new OWAInboxPart
    {
       MailboxName = SPContext.Current.Web.CurrentUser.Email,
       OWAServerAddressRoot = ConfigurationManager.AppSettings["MailServer"]
    };

    Controls.Add(inbox);
  }
  catch(Exception)
  {
    Controls.Add(new Literal{Text = "bla"});
  }
} 
```

# asp.net - 您是否混合和匹配 CSS '和' ASP.NET .Skin 文件？

> ID：634735
> 
> 赞同：1
> 
> 时间：2009-03-11T14:27:30.047
> 
> 标签：asp.net, css, skin

是用于 HTML 元素的 CSS 和用于 ASP 控件的 SKINS？还是 CSS 一直认为它似乎需要更长的时间？Specivity SKINS 或 CSS 是什么？

我问是因为我正在创建我的第一个 ASP.NET Web 应用程序（使用一本书），同时阅读另一个关于 CSS 的内容。我现在需要开始考虑我的 ASP 书中的布局，我有点困惑。

根据书： SKINS 让我可以很容易和集中地告诉所有 Web 控件（如 TextBoxes/Labels）在站点范围内具有某种颜色、字体等。

CSS 在管理布局和样式方面也很出色，并且很容易实现（我认为是错误的词，但正确的情绪），

然而，当涉及到 ASP.NET 时，它需要做更多的工作。我需要将 CssControl 属性添加到所有 Web 控件以附加我的样式/类。在考虑 WEB 控件时，这似乎使使用 SKINS 成为更好的选择。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2009-03-11T14:31:03.487

我个人不使用皮肤文件。即使我有主题，我也只使用 CSS。至于皮肤的“为什么”，它们是针对 ASP.NET 控件的，但是您必须确定“混合隐喻”是否有意义，可以这么说。

我想不出皮肤比直接的 CSS 能为我提供什么。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-03-11T14:35:33.380

各有各的。它们不重叠。CSS 是唯一真正改变外观的东西。皮肤与否，最终归结为 CSS 类和样式属性，因为这是浏览器唯一能理解的东西。

然而，皮肤允许您为一种控件全局设置一些属性。它不仅限于外观方面。是的，您可以设置 CssClass 和 Style 属性，但您也可以设置其他属性。它就像一个全局覆盖和默认值存储。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-03-11T14:40:50.827

我同意@Vilx - 它们并没有真正重叠。

我使用 .skin 文件主要用于更改控件属性，例如 Visible（停止整个控件的渲染），而不是仅仅隐藏它。在某些情况下，我会设置 CssClass 属性或 ImageUrl。这可以在代码中完成，但皮肤很好地外部化了它。

# asp.net - ASP.NET 2.0：使用 AutoPostBack=true 从 onChange 调用 javascript 函数

> ID：634736
> 
> 赞同：0
> 
> 时间：2009-03-11T14:27:37.923
> 
> 标签：asp.net, drop-down-menu, onchange, autopostback

当我查看源代码时，我有一个如下所示的 ASP.NET DDL：

```
<select name="testControl" onchange="DoCustomStuff();setTimeout('__doPostBack(\'testControl\',\'\')', 0)" id="testControl"> 
```

在 .cs 页面上看起来像这样：

```
<asp:DropDownList ID="testControl" runat="server" onchange="DoCustomStuff()" OnSelectedIndexChanged="testControl_Changed" AutoPostBack="true" /> 
```

任何人都可以看到在这样的 DDL 上使用 onchange 和 AutoPostBack="true" 的问题吗？我问是因为我们有一些用户似乎没有正确调用 DoCustomStuff()，我想知道是否可以在 DoCustomStuff() 完成其工作之前执行 __doPostBack()。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2009-03-11T15:07:55.677

尝试像这样手动附加回发参考：

```
Page.ClientScript.RegisterClientScriptBlock(
  typeof(_Default), 
  "PageScripts", 
  string.Format("function DoCustomStuff() { /* Your Code Here */ {0} }", Page.ClientScript.GetPostBackEventReference(testControl, string.Empty))
);

testControl.Attributes["onchange"] =  "DoCustomStuff();"; 
```

这为您提供了回发客户端参考：

```
Page.ClientScript.GetPostBackEventReference(testControl, string.Empty)) 
```

# sql-server - 部署后升级 SQL Express 数据库的工具

> ID：634740
> 
> 赞同：2
> 
> 时间：2009-03-11T14:27:52.400
> 
> 标签：sql-server, deployment

我有一个使用 SQL Express 的应用程序，我的客户主要是没有专门的 IT 人员的人，所以不知道如何运行脚本。所以部署和升级必须很容易。部署部分都搞定了。我需要知道的是，该产品的第 2 版何时发布以及更新数据库结构或数据的时间，有没有比传统的脚本方法更好的方法。脚本方法的问题通常是，您有一个开发数据库正在被一群开发人员使用，并且无法跟踪谁进行了哪些更改，以便能够将它们合并到部署数据库中。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-03-11T14:31:04.390

跟踪，或者使用像 Red Gate 的比较工具这样的产品来生成脚本，然后让您的安装程序运行升级脚本。用户只需双击 setup.exe 即可。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-03-11T14:39:32.297

我会推荐使用 SQLCompare。它允许您进行所有更改而不必担心脚本，然后您可以快速将 Dev/Stage 环境与生产环境同步，或者创建一个可以在远程计算机上运行的脚本。

如果您不想掏出 $$$，请将您的所有更改保留在源代码管理中，就像您的代码一样。您可以单独保留每个更改脚本，或者让您的 scc 系统的主干成为 DB 的最终版本并运行每个 DB 对象的版本（我更喜欢更改脚本方法，但已经看到其他工作）。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-03-11T21:35:39.813

您的数据库中还应该有一个表来跟踪当前版本，以免重复相同的更新，或者不按顺序进行 - 假设客户正在应用多个补丁。+1 用于 SQL 比较。

* * *

此外，SQL 比较会将所有内容包装在事务中。你也可以这样做。他们创建一个临时表来保存所有错误，并在其中任何一个失败时回滚（iirc）。帮助您一次查看所有错误。如果数据库更新失败，您也可以存储它，然后让客户将其发送给您进行故障排除。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2014-04-22T12:24:06.430

在 Visual Studio 2012 中，转到 SQL（菜单项）-> 架构比较。单击左侧的 Select Source，然后选择 dev 数据库。选择右侧的生产数据库。

然后单击生成脚本图标（*在更新图标旁边，它看起来或多或少像一个音乐图标*）。这将生成更新脚本。您也可以取消选中您不想包含在脚本中的任何更改。如果您碰巧拥有 Visual Studio 2012，它是...“免费”

# iphone - 如何以编程方式确定 iPhone 界面方向？

> ID：634745
> 
> 赞同：53
> 
> 时间：2009-03-11T14:28:51.680
> 
> 标签：iphone, cocoa-touch

`UIDevice.orientation`include`UIDeviceOrientationFaceUp`和 的可能值`UIDeviceOrientationFaceDown`。虽然知道设备是平面的可能很有用，但这并不能告诉我们它是否是平面的，显示面向纵向或横向模式的界面。在设备返回模糊信息的情况下，有没有办法找到 GUI 的当前方向？我想我可以跟踪方向更改事件以记住最后的纵向/横向方向或检查主 UIView 的边界高度和宽度，但这似乎很麻烦。设备或 UIView 上是否有我缺少的属性？

* * *

## 回答 #1

> 赞同：95
> 
> 时间：2010-10-09T18:06:26.313

您可以通过 3 种方式获得方向：

1.  `UIInterfaceOrientation orientation = self.interfaceOrientation;` 返回 UIInterfaceOrientation，界面的当前方向。它是 UIViewController 中的一个属性，您**只能在 UIViewController 类**中访问它。

2.  `UIInterfaceOrientation orientation = [[UIApplication sharedApplication] statusBarOrientation];` 返回 UIInterfaceOrientation，应用程序状态栏的当前方向。**您可以在应用程序**的任何位置访问该属性。我的经验表明，这是检索真实界面方向***的最有效方法。***

3.  `UIDeviceOrientation orientation = [[UIDevice currentDevice] orientation];`返回**UIDeviceOrientation**，设备方向。**您可以在应用程序**的任何位置访问该属性。但请注意，UIDeviceOrientation 并不总是 UIInterfaceOrientation。例如，当您的设备放在普通桌子上时，您可能会收到意想不到的价值。

* * *

## 回答 #2

> 赞同：92
> 
> 时间：2009-03-11T14:40:32.590

在视图控制器中，您可以简单地使用代码：

```
UIInterfaceOrientation interfaceOrientation = self.interfaceOrientation; 
```

UIInterfaceOrientation 是一个枚举：

```
typedef enum {
  UIInterfaceOrientationPortrait           = UIDeviceOrientationPortrait,
  UIInterfaceOrientationPortraitUpsideDown = UIDeviceOrientationPortraitUpsideDown,
  UIInterfaceOrientationLandscapeLeft      = UIDeviceOrientationLandscapeLeft,
  UIInterfaceOrientationLandscapeRight     = UIDeviceOrientationLandscapeRight
} UIInterfaceOrientation; 
```

* * *

## 回答 #3

> 赞同：14
> 
> 时间：2012-04-23T07:16:18.467

如果您只关心设备是横向还是纵向，则视图控制器上有一些不错的便捷方法：

```
UIDeviceOrientationIsLandscape(self.interfaceOrientation)
UIDeviceOrientationIsPortrait(self.interfaceOrientation) 
```

* * *

## 回答 #4

> 赞同：11
> 
> 时间：2011-10-27T05:09:57.243

**状态栏方向**（statusBarOrientation）**总是返回界面方向**，即使状态栏被隐藏。

您可以在没有视图控制器的情况下使用状态栏方向。它为您提供当前视图方向，而不是设备方向。

```
UIInterfaceOrientation orientation = [[UIApplication sharedApplication] statusBarOrientation]; 
```

* * *

## 回答 #5

> 赞同：5
> 
> 时间：2009-03-11T14:48:28.047

我见过同样的情况。特别是在这个流程中：

*   控制器 1 加载说.. 肖像。
*   将另一个控制器推入堆栈
*   在第二个控制器中，将设备方向旋转为横向。
*   将设备平放在桌子上，然后弹回原来的控制器。

此时，我看到的任何方向检查都会返回无效的方向 5，因此无法直接确定应该使用横向还是纵向布局。（我正在按方向进行自定义布局定位，所以这是重要的信息）

就我而言，视图的边界宽度检查用于确定事物的真实状态，但我很想知道其他人是否有不同的处理方式。

* * *

## 回答 #6

> 赞同：1
> 
> 时间：2013-05-23T12:25:48.700

这是一个您可能会觉得有用的代码片段：

```
UIInterfaceOrientation  orientation = [UIDevice currentDevice].orientation;
NSLog( @" ORIENTATION: %@", UIInterfaceOrientationIsLandscape( orientation ) ? @"LANDSCAPE" : @"PORTRAIT"); 
```

# .net - .NET CLR 的多个版本同时运行

> ID：634750
> 
> 赞同：3
> 
> 时间：2009-03-11T14:30:09.213
> 
> 标签：.net, assemblies, clr

假设我有一个在 Windows 下运行的 .NET 用户应用程序 (.exe)，它是在 .NET Framework 版本 3.0 (VS2008) 中编译的。如果该应用程序加载另一个使用 .NET Framework 版本 2.0 (VS2005) 在不同计算机上编译的 .NET 程序集 (.dll)，加载的程序集是否会使用现有的 3.0 运行时（将以向后兼容模式运行）？或者 .NET Framework 2.0 运行时是否会加载到系统的进程空间中，而我们现在有两个同时运行的 .NET 运行时？

断言：这不是使用 VS2008 多目标。

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2009-03-11T14:32:07.307

没有 .NET 3.0 CLR。.NET 3.0 和 3.5 都使用 .NET 2.0 CLR。

当然，如果您的 .NET 3.0 应用程序使用 .NET 3.0 功能，则需要安装 .NET 3.0。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2009-03-11T14:33:12.997

如果它在同一个进程空间中，正如您所概述的，它将在 3.0.0 下运行。如果您希望启动两个不同的 CLR，则必须创建一个服务边界（Web 服务或 WCF 在这里工作正常 - 显然不是 2.0 的 WCF）并从另一个应用程序调用该服务。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2009-03-11T14:37:10.693

.NET 运行时版本通常是向后兼容的，因此 3.0 运行时将承载 2.0 程序集（更不用说 3.0 与 2.0 基本上是相同的运行时）。无论如何，不​​能将两个版本的 CLR 加载到同一个进程中。

# svn - 带有腻子会话的svn + ssh，在cygwin中不起作用

> ID：634756
> 
> 赞同：1
> 
> 时间：2009-03-11T14:31:03.953
> 
> 标签：svn, ssh, cygwin

所以我使用好的 ol' putty 会话名称技巧访问我的 SVN 存储库。我可以很好地使用 TortoiseSVN 和 Subclipse，URL 格式如下：

svn+ssh://@/data/svn/my-code

示例：svn+ssh://codecraig@dev-server/data/svn/my-code

因此，我已将“my-code”签出到 C:\my-code，现在我正在尝试使用 cygwin 签入一些更改。

我打开 cygwin，导航到 c:\my-code。我运行“svn status”，它显示了我所做的更改。然后我运行：

svn ci -m "做了一些改动"

我回来了：

ssh：无法解析主机名 dev-server：没有与名称关联的地址 svn：提交失败 svn：连接意外关闭

假设这就是问题所在，我如何让 cygwin 了解我的腻子会话。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-03-11T17:29:58.097

由于我在 Windows 中定义了一个环境变量 SVN_SSH，以便 Subclipse（一个 Eclipse SVN 插件）可以与我的 svn+ssh 连接正常工作，我必须在 Cygwin 中修改我的配置文件以显式导出 SVN_SSH 变量。

export SVN_SSH=/cygdrive/c/putty/PLINK.exe svn co svn+ssh://codecraig@dev-server/data/svn/....

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2009-03-11T15:33:11.277

如果您还使用其他 svn 客户端，请使用 Windows svn 客户端，而不是 cygwin 中的客户端。这些**不**兼容。如果你只使用 cygwin 客户端，那很好。但是您决不能与其他客户端共享您与 cygwin 客户端一起使用的工作副本。这会让你陷入大麻烦——也许不是马上，但它会的，相信我。

一个（显而易见的）原因：cygwin svn 客户端使用 LF 行尾（如果 svn:eol-style 设置为“native”）但“普通”Windows svn 客户端使用 CRLF。

还有其他原因会让你遇到大麻烦，但这些更复杂，需要了解 svn 内部结构才能理解。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2009-03-11T14:34:37.440

尝试编辑您的 ssh 配置文件以包含以下内容：

```
ssh=plink.exe 
```

（如果 PuTTY 的 plink.exe 不在您的路径中，您可能必须指定完整路径。）

另请参阅[此博客条目](http://agateau.wordpress.com/2007/07/03/windows-svnssh-and-the-subversion-command-line-client/)以了解更复杂的场景。

# search - using OR and NOT in solr query

> ID：634765
> 
> 赞同：86
> 
> 时间：2009-03-11T14:34:31.543
> 
> 标签：search, lucene, solr

I'm working on a solr query similar to the following:

```
((myField:superneat AND myOtherField:somethingElse) OR NOT myField:superneat) 
```

When running this, no results are returned. Using criteria on either side of the OR NOT returns results that I'd expect - they are just not working well together. In the case that **myField** matches *superneat*, I'm intending to also ensure that **myOtherField** is set to *somethingElse*, but if **myField** is not *superneat*, include it in the results.

Can someone explain why solr is not returning results for this kind of query? Should the query be restructured somehow - or is there a different way in which solr can be used to achieve the desired result?

* * *

## 回答 #1

> 赞同：84
> 
> 时间：2009-03-11T15:41:47.530

I don't know why that doesn't work, but this one is logically equivalent and it **does** work:

```
-(myField:superneat AND -myOtherField:somethingElse) 
```

Maybe it has something to do with defining the same field twice in the query...

Try asking in the [solr-user group](http://mail-archives.apache.org/mod_mbox/lucene-solr-user/), then post back here the final answer!

* * *

## 回答 #2

> 赞同：44
> 
> 时间：2009-08-21T20:20:59.897

```
Instead of "NOT [condition]" use "(*:* NOT [condition])" 
```

* * *

## 回答 #3

> 赞同：35
> 
> 时间：2014-01-28T15:01:17.113

Solr currently checks for a "pure negative" query and inserts `*:*` (which matches all documents) so that it works correctly.

`-foo` is transformed by solr into `(*:* -foo)`

The big caveat is that Solr only checks to see if the top level query is a pure negative query! So this means that a query like `bar OR (-foo)` is not changed since the pure negative query is in a sub-clause of the top level query. You need to transform this query yourself into `bar OR (*:* -foo)`

You may check the solr query explanation to verify the query transformation:

```
?q=-title:foo&debug=query 
```

is transformed to

```
(+(-title:foo +MatchAllDocsQuery(*:*)) 
```

* * *

## 回答 #4

> 赞同：25
> 
> 时间：2014-03-24T17:34:49.910

Putting together comments from a couple different answers here, in the Solr docs and on the other SO question, I found that the following syntax produces the correct result for my use case

(my_field=my_value or my_field is null):

```
(my_field:"my_value" OR (*:* NOT my_field:*)) 
```

This works for solr 4.1.0\. This is slightly different than the use case in the OP; but, I thought that others would find it useful.

* * *

## 回答 #5

> 赞同：10
> 
> 时间：2009-03-13T12:27:55.390

You can find the follow up to the solr-user group on: [solr user mailling list](http://mail-archives.apache.org/mod_mbox/lucene-solr-user/200903.mbox/%3ccf698510903111856w713d683bs8ff731620717e337@mail.gmail.com%3e)

The prevailing thought is that the NOT operator may only be used to remove results from a query - not just exclude things out of the entire dataset. I happen to like the syntax you suggested mausch - thanks!

* * *

## 回答 #6

> 赞同：5
> 
> 时间：2018-10-17T14:26:11.437

Just to add another unexpected case, here is query that wasn't returning expected results:

```
*:* AND ( ( field_a:foo AND field_b:bar ) OR !field_b:bar ) 
```

`field_b` in my case is something I perform faceting on, and needed to target the query term "foo" **only** on that type (bar)

I had to insert *another* `*:*` after the or condition to get this to work, like so:

```
*:* AND ( ( field_a:foo AND field_b:bar ) OR ( *:* AND !field_b:bar ) ) 
```

edit: this is in solr 6.6.3

* * *

## 回答 #7

> 赞同：-1
> 
> 时间：2020-05-01T06:06:33.357

simple do id:("12345") OR id:("7890") .... and so on

# sql - 请帮助我理解 SQL 与 C 之类的编程？

> ID：634775
> 
> 赞同：13
> 
> 时间：2009-03-11T14:35:44.567
> 
> 标签：sql, c

具体来说，我试图掌握 SQL 语句与普通 C 风格编程有何不同，我似乎无法理解如何执行诸如“对于此表中具有另一列数据等于某某的每个用户 ID，运行此存储程序”，这在编程中将是一个 for 循环，你到底是怎么做这样的事情的？

或者像，对于 tableA 中 contentID 为 11 的每一行，向 tableB 添加一个新行，其中包含此数据和 tableA 的行中找到的包含 contentID 为 11 的 userID ...

有人介意写一些关于我应该如何理解 SQL 语句与编程相比的内容吗？我觉得如果我理解我应该如何思考它，我可以更好地使用它......

* * *

## 回答 #1

> 赞同：22
> 
> 时间：2009-03-11T15:00:09.703

他们从不同的角度来看待这个世界。C是关于执行动作。SQL 是关于存储数据和操作数据的。它擅长的唯一“动作”是提取和更改数据。

把你的所有数据想象成一个[维恩图](http://en.wikipedia.org/wiki/Venn_Diagram)——SQL 让你“查看”你想要的那个图的任何部分。

如果您想对这些数据进行实际操作，那么在 C 语言中，您可能会说“转到每个用户并对他们执行此操作”，如

```
//if a customer is late, send them a reminder
for(int i=0;i<USER_COUNT-1;++i){
  if(LATE_ON_PAYMENTS=CustomerType(Customers[i])){
    SendReminder(Customers[i]);
  }  //if cust is late on their payments
}  //for ea customer 
```

在 SQL 中，您可以询问用户列表，如下所示：

```
SELECT *
FROM CUSTOMERS
WHERE LATE_FLAG = 'Y'; 
```

或者您可以更改有关这些客户的数据，例如：

```
UPDATE CUSTOMERS
SET TRUST_LEVEL = TRUST_LEVEL - 1  --trust a little less when they are late
WHERE LATE_FLAG = 'Y'; 
```

请注意，此 UPDATE 可能会影响任意数量的行，但没有循环......您只是说“查找这些记录，并以这种方式更改它们”。

但是，如果您想向他们发送提醒，那就太糟糕了……您必须使用 C 或存储过程来做到这一点。

**当您将**传统语言与 SQL相结合时，您真的可以两全其美。如果您可以用此替换 C 中的早期示例（免责声明：我知道这是伪造的代码，这只是一个示例）：

```
//if a customer is late, send them a reminder

//get all the late customers
sqlCommand = 'SELECT CUSTOMER_ID FROM CUSTOMERS WHERE LATE_FLAG = ''Y''';
dataSet = GetDataSet(sqlCommand);

//now loop through the late customers i just retrieved    
for(int i=0;i<dataSet.RecordCount - 1;++i){
  SendReminder(dataSet[i].Field('CUSTOMER_ID'));
}  //for ea customer 
```

现在代码更具可读性，每个人在运行时都指向同一个数据源。您还可以避免在 C 中可能会涉及构建客户列表的混乱代码 - 现在它只是一个数据集。

正如 SQL 不擅长执行命令式操作一样，C 也不擅长操纵数据集。一起使用，它们可以轻松获取数据、操作数据并对其执行操作。

* * *

## 回答 #2

> 赞同：8
> 
> 时间：2009-03-11T15:04:45.527

让我来看看这个。我在这里走很长的路，所以请耐心等待。

最终，计算机上的所有程序、数据等都由相同的东西组成：一和零。不多也不少。那么计算机如何知道将一组 1 和 0 视为图像，而将另一组视为可执行文件呢？

答案是上下文。这是人类非常擅长的事情，因此它是计算机大部分功能的基础也就不足为奇了。这些机制很复杂，但最终效果相当于一台不断切换视角的计算机，以便用极其有限的数据集做极其灵活的事情。

我提出这个是因为计算机语言是相似的。最后，所有的计算机语言最终都变成了一系列通过处理器运行的操作码。换句话说，它一直是汇编语言。**所有计算机语言都是汇编语言，包括 SQL 的任何实现。**

我们烦恼的原因是：编程语言允许我们创造一种有用的错觉，从新的角度解决问题。它们为我们提供了解决问题并重新构建解决方案的方法。

冒着陈词滥调的风险，当我们不喜欢问题的答案时，不同的编程语言允许我们提出不同的问题。

所以，当你接触一种语言时，无论是查询语言、面向对象语言还是过程语言，你的第一个问题需要是，“这种语言的观点是什么？它对解决问题任务的观点是什么？” 我什至建议一种对自身没有清晰愿景的语言比它的价值更麻烦。

对于 C，我建议的观点是这样的：“即使是非常不同的处理器的最低级别的操作也可以用一种简单的通用语言来描述。” C 被设计成可以坐在任何处理器的驾驶座上，同时仍然具有相同的旧方向盘、踏板和仪表板。

因此，使用 C，您可以做所有事情。这就是为什么它被称为“高级汇编语言”。或者，引用我的一个朋友的话，“C 是计算机语言的拉丁语。汇编语言是树上猿类的咕噜声。”

SQL 是一头完全不同的野兽，有着完全不同的视角……是吗？SQL 的观点是这样的：“即使是非常不同的数据库中最复杂的命令也可以用一种简单的通用语言来描述。”

听起来很熟悉，嗯？*SQL 旨在让您进入任何数据库软件*的驾驶座，并拥有相同的方向盘、踏板等。

因此，总而言之，C 是一种用于向任意 CPU 提供通用命令的语言，而 SQL 是一种用于向任意数据库后端提供通用命令的语言。

现在，他们在哪里交叉路径？这实际上相当简单。

CPU有什么作用？它接收、转换和发送信息。因此，如果您的目标是解释和呈现数据或接受来自最终用户的命令，那么您正在使用 C。C 用于您需要通过计算机自动化的*过程。*

数据库有什么作用？它存储、分组和检索大量信息。因此，如果您的 C 程序在任何时候需要存储、分组或检索大型数据集或大型数据集的子集，那么您很可能会与数据库进行交互。

如何？当然，通过让你的 C 程序向数据库发送 SQL 命令。;)

我希望这能在一定程度上说明问题，否则对于这个冗长、漫不经心的回复，我只会看起来像一个自负的某某某事。:-P

* * *

## 回答 #3

> 赞同：6
> 
> 时间：2009-03-11T15:10:48.493

SQL 是一种查询语言，旨在处理数据集。我注意到一些程序员犯了一个错误，即从 SQL 中检索大型结果集，然后在 C 中循环遍历该集以过滤数据。最佳设计将在 SQL 中执行尽可能多的集合过滤，让数据库将您的集合修剪为执行循环或其他业务逻辑所需的最小数据集。所以基本上你的问题的答案是使用 SQL 来获得最小的数据集，然后使用 C 根据业务逻辑来操作数据集。

* * *

## 回答 #4

> 赞同：3
> 
> 时间：2009-03-11T14:40:59.843

SQL 不会为您做所有这些。您将不得不使用诸如 T-SQL 或 PL/SQL 之类的东西，或者任何您喜欢的数据库。

我发现[这](http://infolab.stanford.edu/~ullman/fcdb/oracle/or-plsql.html)是开始使用 Oracle PL/SQL 的绝佳方式。每次发生 INSERT 或 UPDATE 时，使用触发器来触发您的 proc。

* * *

## 回答 #5

> 赞同：3
> 
> 时间：2009-03-11T15:30:45.637

SQL 操作针对数据集。所以你可以做这样的事情来对所有匹配的记录进行操作。

```
UPDATE table1 SET x = x+1 WHERE y = 1 
```

为了执行 FOR EACH 操作，您需要使用循环机制。在 SQL Server (Transact-SQL) 中，最常见的此类循环称为 CURSOR，它允许您一次对一个结果行进行操作。[这是一个例子。](http://www.mssqltips.com/tip.asp?tip=1599) 请注意，**与 set 操作相比，游标的效率非常低，**因此请谨慎使用。

* * *

## 回答 #6

> 赞同：2
> 
> 时间：2009-03-11T15:00:53.570

SQL 与 C 等语言的主要区别在于：

在 SQL 中，您可以指定结果集应该是什么样子——这使得它非常适合执行查询和集合操作。例子：

“给我所有金额 > 10 的账单” => SQL 计算出如何创建结果集并将其返回给您，

在 C 中，您可以指定程序应该如何检索结果集。例子： ”

1.  项目清单
2.  创建结果列表，
3.  拿到所有账单，
4.  拿最高的账单，
5.  如果数量> 10，则将其放入结果列表中，否则将其删除，
6.  如果有更多账单，转到第 4 步，
7.  返回结果集。”

那么问题是：“我如何在 SQL 中表述我的问题，以便它完全按照我的意愿行事？”，这有点困难。

* * *

## 回答 #7

> 赞同：2
> 
> 时间：2009-03-11T15:05:35.960

从本质上讲，SQL 是一种基于集合的语言。它对数据集进行操作，并且与基于指令的语言的工作方式有很大不同。在诸如 C 之类的语言中，您指定了某些东西应该如何工作的确切步骤。在像 SQL 这样的基于集合的查询语言中，您必须稍微更改一下视图。您不是在尝试完成可以通过简单步骤轻松描述的操作，而是在尝试根据数据集的关联方式构建结果。

* * *

## 回答 #8

> 赞同：1
> 
> 时间：2009-03-11T15:03:36.327

首先，在使用 SQL 时，您要不惜一切代价避免循环。循环在数据库方面是不好的。

您希望处理一组数据并在一个操作中影响所有内容。

“对于此表中具有另一列数据等于某某的每个用户 ID，运行此存储过程”这在 SQl 中是一件坏事。一般来说，您想要的是编写一个基于集合的新过程。例如，假设您的 sp 执行了一个简单的插入操作，其中 @test 和 @test2 是输入变量。

```
insert table1 (field1, field2)
values (@test, @test2) 
```

要应用于一组值，最好将一组值放在临时表或表变量中（或者它们可能并且通常实际上是您可以从现有数据表中提取的值）

你的新插入现在变成了

```
insert table1 (field1, field2)
Select field1, field2 from @temp 
```

您想要这样做的原因是基于集合的操作比逐行操作快得多。

在学习使用 SQL 时，您首先需要熟悉的是联接、基于集合的操作、插入语句、更新语句、延迟语句和选择语句。确保您了解如何在所有操作语句和选择中有效地使用连接。这是一个开始帮助您了解连接的链接 [http://www.tek-tips.com/faqs.cfm?fid=4785](http://www.tek-tips.com/faqs.cfm?fid=4785)

您可以在不使用游标或循环的情况下编写 SQl 多年。

要理解像 C 和 SQL 这样的语言之间的区别在于，基本上 SQL 是一种与数据库操作有关的特殊类型的语言。C 不太关心访问数据，而是关心整个应用程序的工作方式。因此，由于他们有不同的目的，他们处理事情的方式也大不相同。您从 C 中了解的内容很少适用于 SQL。它们是真正的苹果和橘子。

应用程序程序员喜欢抱怨的一件事是 SQL 不是面向对象的。不要试图使它面向对象或认为它是面向对象的术语。这就像给猪涂口红一样。它什么也做不了，而且惹恼了猪（即它使数据库的性能低于最佳状态）。

* * *

## 回答 #9

> 赞同：1
> 
> 时间：2009-03-11T17:36:14.837

两者都是编程语言（图灵完整取决于您的确切 SQL 方言），但是......

C（C++、C#、Java、Visual Basic）是**过程**编程语言。您指定计算机要执行的一系列步骤。计算机不理解目标，它只是按照你说的去做。将此视为一种自下而上的编程方法。

SQL（Haskell，LISP）是**函数**式编程语言。您指定一个目标，计算机会计算出达到目标的最佳事件序列。将此视为一种自上而下的编程方法。

两种方法都有其优点和缺点。

函数式语言的痛苦在于，很难创建一种能够理解所有类型问题的语言——如果可能的话，所有编程语言都将是函数式的，我们只需要描述我们需要做的事情。相反，大多数函数式语言专注于一个小问题集，比如数学，或者在 SQL 的情况下，读取和写入关系数据集。

程序语言受到程序员必须对所有事情进行微观管理这一事实的困扰。虽然编译器可能会处理寄存器分配和其他小的优化，但它不能做更大的事情，比如重组整个程序以更好地适应数据集，或者自动重组它以在多个并行 CPU 上运行。

* * *

## 回答 #10

> 赞同：0
> 
> 时间：2009-03-11T14:39:50.937

诀窍是 SQL 最适合用于集合操作，而不是循环。您可能希望将存储过程设为一个函数，然后使用 Apply 运算符将该函数应用于适当的行集，从而生成该函数的一组输出。

APPLY 运算符记录在这里：[http](http://technet.microsoft.com/en-us/library/ms175156.aspx) ://technet.microsoft.com/en-us/library/ms175156.aspx 。不幸的是，这个例子太复杂了，但这里有一个使用示例：

```
SELECT D.deptid, D.deptname, D.deptmgrid
    ,ST.empid, ST.empname, ST.mgrid
FROM Departments AS D
    CROSS APPLY fn_getsubtree(D.deptmgrid) AS ST; 
```

这会从 Departments 生成列的行集，然后为每一行调用函数，传递 deptmgrid 列。对于每个返回结果的函数调用，该结果将添加到最终结果集中。

请注意，它是所有集合 - 没有循环。

* * *

## 回答 #11

> 赞同：0
> 
> 时间：2009-03-11T14:49:56.000

SQL 不能为所欲为，它是一种根据特定条件获取数据的语言，例如特定时间后的记录或包含特定文本字符串的数据。数据库对 SQL 语言有扩展，允许您在返回结果后对结果进行操作，对于 Oracle，它是 PL/SQL，对于 SQL Server，它是 T-SQL。

* * *

## 回答 #12

> 赞同：0
> 
> 时间：2009-03-11T14:57:38.273

**SQL 是一种用于查询数据库以获取数据集的语言。**尽管您可以将它用于其他操作，但您应该只将它用于处理大量相关数据的繁重操作。尽管它的名称中有 S（标准），但它并不是针对不同 DBMS 的所有功能的标准。用于 MS SQL Server 的实现是 Transact SQL 或 T-SQL。

**C 是一种通用语言。**你可以在其中编写任何你想要的程序，但你不应该用它来做你可以用 SQL 做的事情（尽管你可以）。

事实上，**它们是免费的**。

您可以在 Google 中通过简单的搜索找到很多信息。您可以开始阅读有关它[的 Wikipedia 文章](http://en.wikipedia.org/wiki/SQL)或[一些教程](http://www.functionx.com/sqlserver/)。

* * *

## 回答 #13

> 赞同：0
> 
> 时间：2009-03-11T17:51:01.900

在定义级别，C 是一种**过程**语言，而 SQL 在很大程度上是一种**声明性**语言。你知道过程语言——程序员告诉计算机该做什么。或者换句话说，程序员定义了计算机遵循的程序（希望）执行某种任务。

相反，声明性语言告诉计算机要生成什么。程序员不是定义一个过程，而是定义他们试图达到的结果。语言本身已经过预编程，可以找到合适的程序来产生定义的结果。

有许多声明性计算机语言，其中 SQL 可能是最著名的。通常，它们基于数学，这是一种广义的声明性语言。正如其他人指出的那样，SQL 基于集合论。更具体地说，它基于Edgar Codd 定义的非常强大的[关系模型。](http://en.wikipedia.org/wiki/Relational_model)虽然关于 SQL（以及一般的 RDBMS）背后的理论有很多话要说，但归结为使用表来定义数据之间的关系的简单想法。

* * *

SQL 是一种声明性语言的想法的一个转折是每个语句也有一个过程元素。为了显示：

```
SELECT x FROM table WHERE y = 0; 
```

`SELECT x`是挑选（或选择）子集的过程。 `FROM table`定义要操作的关系（或表）。 `WHERE y = 0`是声明的声明部分。它定义了将要操作的数据子集。

同时C具有一些声明性特征。例如：

```
A = x*y; 
```

在这种情况下，您不会告诉计算机如何将两个数字相乘。相反，您向计算机询问结果，然后 C 编译器定义完成任务的过程。

* * *

## 回答 #14

> 赞同：0
> 
> 时间：2016-08-22T21:05:52.080

如上所述，SQL 是一种声明性语言，C 是过程性语言。SQL 语句声明必须做什么，编译器决定**如何****做**。在像 C 这样的“普通”语言中，函数或方法指定必须执行**什么**以及**如何对数据进行操作。**有些任务类型不能仅使用 SQL 来解决。有些任务可以使用“普通”编程语言更容易地实现，例如递归。现代 DBMS（Oracle、MS SQL、PostgreSQL 等支持递归查询，但与“普通”语言的实现相比，此类解决方案不太直观且通常难以理解。

* * *

## 回答 #15

> 赞同：0
> 
> 时间：2022-02-05T04:56:08.660

我对很多这方面都很陌生，所以如果我错了，请有人纠正我，因为我不想提供错误信息。我的理解是 SQL 查询是对已经编写的 C 代码的指令。编写代码时，几乎总是有多种好方法可以完成相同的任务。您选择哪一个取决于上下文。从磁盘空间访问数据是一组非常需要/特定的任务，开发人员编写算法来计算几乎所有可能的方法来完成这些任务，因此未来的开发人员不必这样做。相反，未来的开发人员可以“声明”任务是什么。然后，该算法根据任务的目标（数据）是什么来选择实现任务的最佳方法并运行它们。这些任务的复杂性差异很大，甚至声明它们最终都会变成它自己的语言：SQL

# c# - C# 扩展方法 - 也接受转义字符的字符串拆分

> ID：634777
> 
> 赞同：7
> 
> 时间：2009-03-11T14:36:39.730
> 
> 标签：c#, .net, parsing, extension-methods, split

我想为 .NET String 类编写一个扩展方法。我希望它是 Split 方法的一个特殊变体——当在分隔符之前使用转义字符时，它采用转义字符来防止拆分字符串。

写这个的最好方法是什么？我很好奇处理它的最佳非正则表达式方法。
有签名的东西，比如...

```
public static string[] Split(this string input, string separator, char escapeCharacter)
{
   // ...
} 
```

**更新：** 因为它出现在一个评论中，转义......

在 C# 中转义非特殊字符时，您会收到错误 - CS1009：无法识别的转义序列。

在 IE JScript 中，转义字符被丢弃。除非你尝试 \u 然后你得到一个“预期的十六进制数字”错误。我测试了 Firefox，它具有相同的行为。

我希望这种方法非常宽容并遵循 JavaScript 模型。如果您在非分隔符上转义，则应该“友好地”删除转义字符。

* * *

## 回答 #1

> 赞同：12
> 
> 时间：2009-03-11T14:44:43.937

怎么样：

```
public static IEnumerable<string> Split(this string input, 
                                        string separator,
                                        char escapeCharacter)
{
    int startOfSegment = 0;
    int index = 0;
    while (index < input.Length)
    {
        index = input.IndexOf(separator, index);
        if (index > 0 && input[index-1] == escapeCharacter)
        {
            index += separator.Length;
            continue;
        }
        if (index == -1)
        {
            break;
        }
        yield return input.Substring(startOfSegment, index-startOfSegment);
        index += separator.Length;
        startOfSegment = index;
    }
    yield return input.Substring(startOfSegment);
} 
```

这似乎有效（使用一些快速测试字符串），但它不会删除转义字符 - 我怀疑这将取决于您的具体情况。

* * *

## 回答 #2

> 赞同：7
> 
> 时间：2009-03-11T14:41:21.760

这将需要清理一下，但本质上就是这样......

```
List<string> output = new List<string>();
for(int i=0; i<input.length; ++i)
{
    if (input[i] == separator && (i==0 || input[i-1] != escapeChar))
    {
        output.Add(input.substring(j, i-j);
        j=i;
    }
}

return output.ToArray(); 
```

* * *

## 回答 #3

> 赞同：4
> 
> 时间：2009-03-11T14:46:21.873

我的第一个观察是分隔符应该是字符而不是字符串，因为使用单个字符转义字符串可能很难——转义字符覆盖了以下字符串的多少？除此之外，@James Curran 的回答几乎就是我将如何处理它 - 不过，正如他所说，它需要一些清理。例如，在循环初始化程序中将 j 初始化为 0。弄清楚如何处理空输入等。

您可能还希望支持 StringSplitOptions 并指定是否应在集合中返回空字符串。

* * *

## 回答 #4

> 赞同：4
> 
> 时间：2009-03-11T15:31:34.463

如果要删除转义字符，这是解决方案。

```
public static IEnumerable<string> Split(this string input, 
                                        string separator, 
                                        char escapeCharacter) {
    string[] splitted = input.Split(new[] { separator });
    StringBuilder sb = null;

    foreach (string subString in splitted) {
        if (subString.EndsWith(escapeCharacter.ToString())) {
            if (sb == null)
                sb = new StringBuilder();
            sb.Append(subString, 0, subString.Length - 1);
        } else {
            if (sb == null)
                yield return subString;
            else {
                sb.Append(subString);
                yield return sb.ToString();
                sb = null;
            }
        }
    }
    if (sb != null)
        yield return sb.ToString();
} 
```

* * *

## 回答 #5

> 赞同：3
> 
> 时间：2009-03-11T14:52:53.403

```
public static string[] Split(this string input, string separator, char escapeCharacter)
{
    Guid g = Guid.NewGuid();
    input = input.Replace(escapeCharacter.ToString() + separator, g.ToString());
    string[] result = input.Split(new string []{separator}, StringSplitOptions.None);
    for (int i = 0; i < result.Length; i++)
    {
        result[i] = result[i].Replace(g.ToString(), escapeCharacter.ToString() + separator);
    }

    return result;
} 
```

可能不是最好的方法，但它是另一种选择。基本上，无论在哪里找到 escape+seperator 的序列，都用 GUID 替换它（你可以在这里使用任何其他随机废话，没关系）。然后使用内置的拆分功能。然后用escape+分隔符替换数组每个元素中的guid。

* * *

## 回答 #6

> 赞同：3
> 
> 时间：2013-08-22T14:04:13.447

你可以尝试这样的事情。虽然，我建议使用不安全的代码来执行性能关键任务。

```
public static class StringExtensions
{
    public static string[] Split(this string text, char escapeChar, params char[] seperator)
    {
        return Split(text, escapeChar, seperator, int.MaxValue, StringSplitOptions.None);
    }

    public static string[] Split(this string text, char escapeChar, char[] seperator, int count)
    {
        return Split(text, escapeChar, seperator, count, StringSplitOptions.None);
    }

    public static string[] Split(this string text, char escapeChar, char[] seperator, StringSplitOptions options)
    {
        return Split(text, escapeChar, seperator, int.MaxValue, options);
    }

    public static string[] Split(this string text, char escapeChar, char[] seperator, int count, StringSplitOptions options)
    {
        if (text == null)
        {
            throw new ArgumentNullException("text");
        }

        if (text.Length == 0)
        {
            return new string[0];
        }

        var segments = new List<string>();

        bool previousCharIsEscape = false;
        var segment = new StringBuilder();

        for (int i = 0; i < text.Length; i++)
        {
            if (previousCharIsEscape)
            {
                previousCharIsEscape = false;

                if (seperator.Contains(text[i]))
                {
                    // Drop the escape character when it escapes a seperator character.
                    segment.Append(text[i]);
                    continue;
                }

                // Retain the escape character when it escapes any other character.
                segment.Append(escapeChar);
                segment.Append(text[i]);
                continue;
            }

            if (text[i] == escapeChar)
            {
                previousCharIsEscape = true;
                continue;
            }

            if (seperator.Contains(text[i]))
            {
                if (options != StringSplitOptions.RemoveEmptyEntries || segment.Length != 0)
                {
                    // Only add empty segments when options allow.
                    segments.Add(segment.ToString());
                }

                segment = new StringBuilder();
                continue;
            }

            segment.Append(text[i]);
        }

        if (options != StringSplitOptions.RemoveEmptyEntries || segment.Length != 0)
        {
            // Only add empty segments when options allow.
            segments.Add(segment.ToString());
        }

        return segments.ToArray();
    }
} 
```

* * *

## 回答 #7

> 赞同：1
> 
> 时间：2009-03-11T14:44:34.717

签名不正确，需要返回一个字符串数组

警告从未使用过扩展，所以请原谅我的一些错误；）

```
public static List<String> Split(this string input, string separator, char escapeCharacter)
{
    String word = "";
    List<String> result = new List<string>();
    for (int i = 0; i < input.Length; i++)
    {
//can also use switch
        if (input[i] == escapeCharacter)
        {
            break;
        }
        else if (input[i] == separator)
        {
            result.Add(word);
            word = "";
        }
        else
        {
            word += input[i];    
        }
    }
    return result;
} 
```

* * *

## 回答 #8

> 赞同：1
> 
> 时间：2009-03-11T14:51:24.403

就我个人而言，我会作弊并看看 string.Split 使用反射器......`InternalSplitOmitEmptyEntries`看起来很有用;-)

* * *

## 回答 #9

> 赞同：1
> 
> 时间：2015-01-22T14:55:57.370

我也遇到了这个问题，没有找到解决办法。所以我自己写了这样一个方法：

```
 public static IEnumerable<string> Split(
        this string text, 
        char separator, 
        char escapeCharacter)
    {
        var builder = new StringBuilder(text.Length);

        bool escaped = false;
        foreach (var ch in text)
        {
            if (separator == ch && !escaped)
            {
                yield return builder.ToString();
                builder.Clear();
            }
            else
            {
                // separator is removed, escape characters are kept
                builder.Append(ch);
            }
            // set escaped for next cycle, 
            // or reset unless escape character is escaped.
            escaped = escapeCharacter == ch && !escaped;
        }
        yield return builder.ToString();
    } 
```

它与 Escape 和 Unescape 结合使用，后者转义分隔符和转义字符并再次删除转义字符：

```
 public static string Escape(this string text, string controlChars, char escapeCharacter)
    {
        var builder = new StringBuilder(text.Length + 3);
        foreach (var ch in text)
        {
            if (controlChars.Contains(ch))
            {
                builder.Append(escapeCharacter);
            }
            builder.Append(ch);
        }
        return builder.ToString();
    }

    public static string Unescape(string text, char escapeCharacter)
    {
        var builder = new StringBuilder(text.Length);
        bool escaped = false;
        foreach (var ch in text)
        {
            escaped = escapeCharacter == ch && !escaped;
            if (!escaped)
            {
                builder.Append(ch);
            }
        }
        return builder.ToString();
    } 
```

逃逸/逃逸的例子

```
separator = ','
escapeCharacter = '\\'
//controlCharacters is always separator + escapeCharacter

@"AB,CD\EF\," <=> @"AB\,CD\\EF\\\," 
```

分裂：

```
@"AB,CD\,EF\\,GH\\\,IJ" => [@"AB", @"CD\,EF\\", @"GH\\\,IJ"] 
```

所以要使用它，Escape before Join 和 Unescape after Split。

* * *

## 回答 #10

> 赞同：0
> 
> 时间：2009-07-28T13:16:58.823

```
public string RemoveMultipleDelimiters(string sSingleLine)
{
    string sMultipleDelimitersLine = "";
    string sMultipleDelimitersLine1 = "";
    int iDelimeterPosition = -1;
    iDelimeterPosition = sSingleLine.IndexOf('>');
    iDelimeterPosition = sSingleLine.IndexOf('>', iDelimeterPosition + 1);
    if (iDelimeterPosition > -1)
    {
        sMultipleDelimitersLine = sSingleLine.Substring(0, iDelimeterPosition - 1);
        sMultipleDelimitersLine1 = sSingleLine.Substring(sSingleLine.IndexOf('>', iDelimeterPosition) - 1);
        sMultipleDelimitersLine1 = sMultipleDelimitersLine1.Replace('>', '*');
        sSingleLine = sMultipleDelimitersLine + sMultipleDelimitersLine1;
    }
    return sSingleLine;
} 
```

# .net - 将快照数据保存到 XML

> ID：634780
> 
> 赞同：0
> 
> 时间：2009-03-11T14:37:46.170
> 
> 标签：.net, xml, serialization, datatable

我有 5 个表属于 2 个不同的数据集，我用它们来填充页面中的一些网格。我想实现一些快照功能，我需要将表中的数据保存在数据库中的 XML 中。我正在考虑使用.Net XmlSerializer（也反序列化）将表简单地序列化为XML，但是有很多额外的数据，基本上是表定义和一些我不需要的列。我的另一个选择是遍历表并手动创建 XML；结构将非常复杂，在页面中我将不得不做相反的事情，遍历 XML 并将数据添加到我的网格绑定到的表中。第二种方法会涉及多少性能损失，更好地说，是否会引起注意（每个表大约 20 个数据行，每个表大约有 4 列）？还，

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-03-11T14:47:46.770

使用 DataSet，您可以创建 XML。根据您的问题，您已经意识到这一点。如果您想稍微删减数据，您可以构建自己的 XML，但您也可以创建一个 XSLT 文件并将 XML 转换为您正在查看的简化 XML。这是一个一步的过程，与创建 XML 或删除创建的 XML 文档所需的循环不同。

# sql - 在同一个表中选择相似的行

> ID：634782
> 
> 赞同：2
> 
> 时间：2009-03-11T14:38:15.513
> 
> 标签：sql, sql-server, sql-server-2005

我正在尝试编写一个查询来查找 USERS 表中相似的所有用户。就像查找所有非不同行但使用 LIKE 语句而不是 equals 语句一样。下面是一个 USERS 表的示例列

```
 USERNAME 
------------
tim.smith
doug.funny
tim.smith1
dan.snyder
tim.smith20
doug.funny2
emily.hunt 
```

查询后的输出应该是这样的。

```
tim.smith
tim.smith1
tim.smith20
doug.funny
doug.funny2 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-03-11T14:52:18.333

如果您的数据与您描述的完全一样，您可以在订购之前将数字从末尾剪掉，但我怀疑您的实际数据比这更复杂。

您可能想查看 sql server [SOUNDEX 和 DIFFERENCE](http://msdn.microsoft.com/en-us/library/aa259235(SQL.80).aspx)函数。它可能不是你所需要的，但它可能会让你接近

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-03-11T15:03:50.910

我一直在寻找使用交叉连接的正当理由

```
Select Distinct u1.UserID 
from username  u1 Cross join username u2
where u1.UserID <> u2.UserID
and 
(PatIndex('%' + u1.UserID  + '%', u2.UserID)  <> 0
 OR
PatIndex('%' + u2.UserID  + '%', u1.UserID)  <> 0)
order by u1.UserID

doug.funny
doug.funny2
tim.smith
tim.smith1
tim.smith20 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-03-11T14:52:44.603

你不能就这样吗

```
select * from USERTABLE order by USERNAME;
```

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2009-03-11T14:57:46.807

如果您准确定义“相似”的含义，将会很有帮助。条目是否总是遵循某种模式，例如“字母、句号、字母、可选数字”？

如果您正在寻找拼写错误或可能的拼写错误，您可以尝试模糊字符串匹配算法，例如 soundex 或 Levenshtein 编辑距离。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2009-03-11T15:00:09.047

基于 Levenshtein 距离的花式 UDF：

```
CREATE FUNCTION edit_distance(@s1 nvarchar(3999), @s2 nvarchar(3999))
RETURNS int
AS
BEGIN
  DECLARE @s1_len int, @s2_len int, @i int, @j int, @s1_char nchar, @c int, @c_temp int,
    @cv0 varbinary(8000), @cv1 varbinary(8000)
  SELECT @s1_len = LEN(@s1), @s2_len = LEN(@s2), @cv1 = 0x0000, @j = 1, @i = 1, @c = 0
  WHILE @j <= @s2_len
    SELECT @cv1 = @cv1 + CAST(@j AS binary(2)), @j = @j + 1
  WHILE @i <= @s1_len
  BEGIN
    SELECT @s1_char = SUBSTRING(@s1, @i, 1), @c = @i, @cv0 = CAST(@i AS binary(2)), @j = 1
    WHILE @j <= @s2_len
    BEGIN
      SET @c = @c + 1
      SET @c_temp = CAST(SUBSTRING(@cv1, @j+@j-1, 2) AS int) +
        CASE WHEN @s1_char = SUBSTRING(@s2, @j, 1) THEN 0 ELSE 1 END
      IF @c > @c_temp SET @c = @c_temp
      SET @c_temp = CAST(SUBSTRING(@cv1, @j+@j+1, 2) AS int)+1
      IF @c > @c_temp SET @c = @c_temp
      SELECT @cv0 = @cv0 + CAST(@c AS binary(2)), @j = @j + 1
    END
    SELECT @cv1 = @cv0, @i = @i + 1
  END
  RETURN @c
END 
```

（抄自 SQLTeam.com 论坛。）

不幸的是，这仅在提供两个字符串时有效，并且在 O(nm) 时间内有效，其中 n 和 m 是两个字符串的长度。但是，您可以通过修改函数以在 @c 大于 3 时将其剪切为“不匹配”来改进这一点。

但是您仍然需要一个光标来遍历表中的每个用户名并将其与其他每个用户进行比较。效率不是很高，这是肯定的。

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2009-03-11T15:01:38.140

或者您可以编写一个计算 levenshtein 距离（[http://de.wikipedia.org/wiki/Levenshtein-Distanz](http://de.wikipedia.org/wiki/Levenshtein-Distanz)）的函数，然后使用如下表达式加入表格

```
levenshtein(a.username, b.username) <=2 
```

如果您认为这些字符是“垃圾”，您可能希望在此之前从名称中删除任何特殊字符

* * *

## 回答 #7

> 赞同：0
> 
> 时间：2009-03-31T04:36:19.147

SSIS 具有为您处理此问题的功能。通过 SSIS 运行表格，它将找出表格和匹配项以及它们的匹配程度。

# .net - .net 中的智能数字格式

> ID：634794
> 
> 赞同：1
> 
> 时间：2009-03-11T14:40:08.473
> 
> 标签：.net, formatting

我正在编写一个“聪明的”数字格式化函数，它的行为方式如下：

```
1500 -> 1.5k
1517 -> 1 517
1234000 -> 1 234k
1200000 -> 1.2M 
```

是否可以使用 double.toString() 或另一个 .net 内置类来做到这一点？

我知道编写代码很容易，但如果功能已经存在，我宁愿重用框架类。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-03-11T14:45:58.723

我不相信 .NET 中有类似的东西。这是我必须为我执行此操作的 PowerShell 脚本的关键部分。

```
$prefixes = @('', 'K', 'M', 'G', 'T', 'P', 'E', 'Z', 'Y')
$base = 1024;

$magnitude = [Math]::Floor([Math]::Log($_, 1024))

Write-Verbose "`$magnitude = $magnitude"

if($magnitude -eq 0)
{
    [string]$mantissa = $_
    [string]$label = 'B';
}
else
{
    [string]$mantissa = [String]::Format("{0:N}", $_ / [Math]::Pow(1024, $magnitude))

    Write-Verbose "`$mantissa = $mantissa"

    [string]$label = $prefixes[$magnitude]

    if ($IEC)
    {
        $label += "i"
    }

    $label += $unit
}

[String]::Format("{0} {1}", $mantissa, $label) 
```

它需要更新才能使用 PowerShell V2 的高级功能。（我没有粘贴的部分是尝试做Advanced Functions做的部分，而且很乱。）

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-03-11T15:52:04.727

.NET 库没有任何与您正在寻找的东西非常相似的东西，但是使用[扩展方法](http://msdn.microsoft.com/en-us/library/bb383977.aspx)您可以向它们添加该功能。请注意，您不能使用扩展覆盖方法，只能添加新方法。

但是，在架构上，我最好使用[多态性](http://msdn.microsoft.com/en-us/library/ms173152.aspx)来扩展您需要的类并[覆盖](http://msdn.microsoft.com/en-us/library/ebca9ah3.aspx)ToSting 方法。这将避免扩展方法的开销，但仍允许您将自定义类传递给期望 .NET 数字类型的方法。

# java - jgoodies 绑定 + 合并频繁更改

> ID：634798
> 
> 赞同：3
> 
> 时间：2009-03-11T14:40:45.803
> 
> 标签：java, binding, jgoodies

我有一个 java 应用程序，它以可变速率更新数据（从我无法控制的相当高速的数据流接收，但最高 120Kbytes/sec），我想显示像接收到的字节数/数据包数这样的统计数据，使用对话框。

我正在研究[JGoodies 绑定](https://binding.dev.java.net/)，并初步处理了以低速率接收的人工数据。

我想做的大致是：

1.  制作一个像这样的bean类：

    ```
    public class Statistics
    {
      private int bytes;
      private int goodPackets;
      private int badPackets;
      private int totalPackets;

      public int getBytes() { return bytes; }
      public int getGoodPackets() { return goodPackets; }
      public int getBadPackets() { return badPackets; }
      public int getTotalPackets() { return totalPackets; }

      public void update(/* TBD */) { /* updates the fields appropriately */ }
      public Statistics() { bytes=goodPackets=badPackets=totalPackets=0; }
    }

    Statistics stats; 
    ```

2.  将 4 个字段绑定到我的 GUI 中的元素

3.  能够`stats.update()`在我的主应用程序线程中以任何必要的速度调用，其中对“更新”的调用是触发 GUI 更改侦听器的原因
4.  让 GUI 以我可以指定的较低速率“自动”更新，大约 5-20Hz，因此它不会被大量触发事件所淹没。

有没有合适的机制让我做我想做的事？我在看 JGoodies DelayedReadValueModel 但我真的不知道如何使用它。

如果我必须自己手动完成，我想我可能会做的是：

1.  有统计的镜像副本，并添加某种更新标志，以及从原始副本到镜像副本的链接，以及计时器超时
2.  调用该`update()`方法时，设置更新标志，然后调用类似的方法`maybePropagate()`
3.  `maybePropagate()`：如果计时器超时，或者镜像副本的链接为空，则什么也不做；否则启动超时并将更新的数据发送到镜像副本，并清除更新标志
4.  当定时器超时时，如果设置了更新标志并且到镜像副本的链接不为空，它会将更新的数据发送到镜像副本并清除更新标志
5.  实现了前面的 4 个元素后，我的镜像副本具有最大的更新速率，因此我可以使用常规 JGoodies BeanAdapter 将 GUI 元素绑定到镜像副本的字段。

有什么建议么？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-06-01T08:44:56.570

尽管 JGoodies Binding 使用 Delayed* 类解决了这个问题，但您可以考虑使用具有标准 Swing 功能的方法。

如果使用 SwingWorker，则可以在后台发布元素并在 EDT 中处理它们。SwingWorker 进程将获取大量已发布数据并减少 EDT 更改的数量。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2011-02-03T20:33:36.813

假设您有统计数据的表示模型，您的绑定代码可能如下所示：

```
ValueModel bytesModel = statsPresentationModel.getModel("bytes");
label = BasicComponentFactory.createLabel(bytesModel); 
```

现在要延迟更新，您可以包装字节字段的值模型：

```
ValueModel bytesModel = new DelayedReadValueModel(statsPresentationModel.getModel("bytes"));
label = BasicComponentFactory.createLabel(bytesModel); 
```

# java - 为什么junit测试在eclipse中失败但从ant通过？

> ID：634801
> 
> 赞同：1
> 
> 时间：2009-03-11T14:40:55.710
> 
> 标签：java, eclipse, junit

我有一个 JUnit 测试，它正在检查以确保自定义的 xml 序列化工作正常。自定义的 xml 序列化只是 Xstream 的一些自定义转换器。反序列化器可以工作，但在 Eclipse 3.x 中由于某种原因，JUnit 无法序列化。在命令行上的 Ant 中，它工作得很好。如果我调试并单步执行测试用例，它在 Eclipse 中也可以正常工作，但如果在失败的测试用例执行后放置一个断点，它仍然会失败。

是什么赋予了？我有类路径问题吗？

一些附加信息：

预期的：

```
<site>
  <name>origin</name>
  <version>0.6.0</version>
  <description>Stuff</description>
  <source>./fake-file.xml</source>
  <location>
    <latitude deg="44" min="26" sec="37.640"/>
    <longitude deg="-57" min="-38" sec="-6.877"/>
    <ellipsoid-height value="-79.256" units="meters"/>
    <geoid-height value="0.000" units="meters"/>
  </location>
</site> 
```

实际的：

```
<site>
  <name>origin</name>
  <version>0.6.0</version>
  <description>Stuff</description>
  <source>./fake-file.xml</source>
  <location>
    <latitude deg="44" min="26" sec="37.640"/>
    <longitude deg="-57" min="-38" sec="-6.877"/>
    <ellipsoid-height value="-79.256" units="meters"/>
    <geoid-height value="-79.256" units="meters"/>
  </location>
</site> 
```

编写位置字段的代码：

```
public void marshal(Object source, 
                    HierarchicalStreamWriter writer,
                    MarshallingContext context)
{
   ILatLonEllipsoidHeightPoint aLoc = (ILatLonEllipsoidHeightPoint) source;
   synchronized(aLoc)
   {
      writer.startNode(LATITUDE);
      writer.addAttribute(DEGREES,
         Integer.toString(
           PointUnitConversions.getLatitudeHours(aLoc.getLatitude())));
      writer.addAttribute(MINUTES,
         Integer.toString(
           PointUnitConversions.getLatitudeMinutes(aLoc.getLatitude())));
      writer.addAttribute(SECONDS,
         String.format("%.3f", 
           PointUnitConversions.getLatitudeSeconds(aLoc.getLatitude())));
      writer.endNode();

      writer.startNode(LONGITUDE);
      writer.addAttribute(DEGREES, 
         Integer.toString(
           PointUnitConversions.getLongitudeHours(aLoc.getLongitude())));
      writer.addAttribute(MINUTES,
         Integer.toString(
           PointUnitConversions.getLongitudeMinutes(aLoc.getLongitude())));
      writer.addAttribute(SECONDS,
         String.format("%.3f", 
           PointUnitConversions.getLongitudeSeconds(aLoc.getLongitude())));      
      writer.endNode();

      writer.startNode(ELLIPSOID_HEIGHT);
      writer.addAttribute(VALUE, 
         String.format("%.3f", aLoc.getEllipsoidHeight()));
      writer.addAttribute(UNITS, METERS);
      writer.endNode();      

      writer.startNode(GEOID_HEIGHT);
      writer.addAttribute(VALUE, 
         String.format("%.3f", aLoc.getGeoidHeight()));
      writer.addAttribute(UNITS, METERS);
      writer.endNode();
   }
} 
```

PointUnitConversions 调用执行明显的数学运算以获取十进制度数并将组件转换为相应的整数或双精度值。

它只是导致失败的最后一个位置属性。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2009-03-11T14:51:48.583

如果你调试它工作正常吗？听起来像是时间问题；并对其进行调试会减慢它的运行速度。你能发布一些代码吗？

编辑：
感谢您添加信息。似乎如果您单步执行它时它没有失败，但如果您只是正常运行它就会失败，我敢打赌它是时间/线程问题。你在某个地方的线程中这样做吗？有争议吗？还是比赛条件？

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2009-03-11T14:52:29.003

有什么不同。

根据您发布的内容无法判断，但我的猜测可能是：

1.  Ant、命令 shell 和 Eclipse 使用的不同 JVM，
2.  Ant 和 Eclipse 的 CLASSPATH 中的不同 JAR，
3.  不同的 XML 编码。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-03-11T15:22:36.233

可能与使用的 XML 库不同。找出使用例如这个小代码片段使用哪个：

```
import org.w3c.dom.Text;
public class TextTest {
    public static void main(String[] args) {
        System.out.println(Text.class.getResource("Text.class"));
    }
} 
```

# html - 如何防止 IE7 中列表项的 3px 额外底部填充

> ID：634802
> 
> 赞同：1
> 
> 时间：2009-03-11T14:40:59.093
> 
> 标签：html, css, layout, internet-explorer-7

我有一个页面，其中臭名昭著的 3px 额外垂直空间（在每个`li`元素下方）在 IE7 中呈现在我的所有列表项上。我有一个特定的情况，我需要绝对定位在 中的文本`li`，以便可以将其容器设置为更小的宽度，并且文本延伸到容器之外。这是我正在使用的代码：

```
<style type="text/css">
 div { width: 160px; font: 8pt arial,helvetica,sans-serif; border: 1px solid #999; }
  div ul { margin: 0; padding: 0; list-style: none; }
   div ul li { width: 30px; height: 20px; margin: 0 0 4px; padding: 0; background-color: #c00; }
    div ul li a { display: block; line-height: 20px; color: #000; text-decoration: none; }
     div ul li a em { position: absolute; margin-left: 5px; }
</style>

<div>
 <ul>
  <li><a href="#"><em>#1: premature brake wear</em></a></li>
  <li><a href="#"><em>#2: squeaky brakes</em></a></li>
  <li><a href="#"><em>#3: bad gas mileage</em></a></li>
 </ul>
</div> 
```

我正在寻找一个不涉及特定于 IE7 的 CSS hack 的解决方案，只是为了 CSS 纯度。我已经读过很多情况下，给包含元素 hasLayout 解决了这些 3px 额外高度问题中的大部分问题，但我无法为这段代码弄清楚。

在我的应用程序中，我最终为 IE7（1px 而不是 4px）应用了不同的 margin-bottom，它工作正常，但似乎不正确......

[测试页面在这里](http://www.carcomplaints.com/widgets/160-graph/test.html)

[现场应用在这里](http://www.carcomplaints.com/widgets/160-graph/index.html)

我已经尝试了[456 Berea St](http://www.456bereastreet.com/archive/200610/closing_the_gap_between_list_items_in_ie/) & [this page](http://www.brunildo.org/test/IEWlispace.php)上描述的一些标准修复，但要么我将它们错误地应用到我的示例中，要么是我的代码结构方式中的其他问题。对修复或完成此布局的其他方法有什么建议吗？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2011-10-24T13:41:52.790

我没有用这段代码尝试过，但我在 li 元素中指定了一个高度，然后添加了垂直对齐：底部，所以代码是：

```
div.test ul li { height: 20px; vertical-align: bottom;} 
```

适用于我，即 6 和 7

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-03-11T15:19:01.000

尝试以下操作：

```
<style type="text/css">
    div.test { width: 160px; font: 8pt arial,helvetica,sans-serif; border: 1px solid #999; overflow:hidden; }
    div.test ul { margin: 0; padding: 0; list-style: none;}
    div.test ul li { margin: 0 0 4px; }
    div.test ul li a { display: inline-block; }
    div.test ul li a { display: block; padding: 0 5px; line-height: 20px; color: #000; text-decoration: none; position: relative; z-index: 2; }
    div.test ul li b {   background-color: #c00; height: 20px; width: 20px; position: absolute; display: block; z-index: 1; }
</style>

<div class="test">
    <ul>
        <li><b></b><a href="#"><em>#1: premature brake wear</em></a></li>
        <li><b></b><a href="#"><em>#2: squeaky brakes</em></a></li>
        <li><b></b><a href="#"><em>#3: bad gas mileage</em></a></li>
    </ul>
</div> 
```

我无法解决您遇到的问题比您已经拥有的更清洁（另一个解决方法是浮动 LI 并清除它们）但是，我为您提供了另一种执行此操作的方法。我承认它是最干净的 HTML，但它确实巧妙地回避了这个问题。

# c++ - C++ 头文件 - 将它们放在一个目录中还是合并到树结构中？

> ID：634816
> 
> 赞同：11
> 
> 时间：2009-03-11T14:44:54.343
> 
> 标签：c++, build-process, cross-platform

我有大量源代码 ( [OOFILE](http://www.oofile.com.au/databasedev.html) )，我*最终*将其放在[Sourceforge 上](http://sourceforge.net/projects/oofile/)。我需要决定是否应该使用整体包含目录或将头文件保留在源代码树中。

我想在推送到 SourceForge 上的 svn 存储库之前做出这个决定。我希望在迁移之后使用它的很多人会直接从 SF 签出工作副本，因此不想改变他们的结构。

完整的源代码树在 25 个文件夹中有大约 262 个文件。由于符合 8.3 字符名称（是的，它可以追溯到 Win3.1），因此类比所建议的要多得多，因此许多类都在一个文件中。正如我过去使用[ObjectMaster](http://www.artima.com/forums/flat.jsp?forum=106&thread=158259)开发的那样，这从不困扰我，但我将把它拆分以符合最近的趋势，以尽量减少每个文件的类数量。快速浏览一下[班级列表](http://www.oofile.com.au/oofile_ref/htmlwin/annotated.html)，大约有 600 个班级。

OOFILE 是一个跨平台产品，预计将在 Mac、Windows 和各种 Unix 平台上构建。当它在 Mac 上开始运行时，编译器指向*包含树*而不是平面*包含目录*，头文件与源代码一起保存。

后来，主要是为了让一些 Visual Studio 用户满意，使用单个*包含*目录重新组织了构建。我正在尝试在这些模型之间进行选择。

整个OOFILE产品涵盖了相当多的领域：

*   数据库前端
*   数据库后端范围
*   适用于 Mac 和 Windows 的简单 2D 图形引擎
*   简单的 html 和文本列表的简单字符模式报告编写器
*   非常丰富的带 Mac 和 Windows 预览和打印以及跨平台生成文本、RTF、HTML 和 XML 报告的报告编写器
*   表单集成引擎，用于轻松绑定到数据库的 CRUD 表单，在 PowerPlant 和 MFC 上实现
*   跨平台实用程序类
    *   文件和目录操作
    *   字符串
    *   数组
    *   XML 和标签生成

许多人只想在单一平台上使用它，其中一些代码区域是纯遗留的（例如：经典 Mac 上的 PowerPlant UI 框架）。因此，似乎人们会喜欢不要将那些不需要的区域的标头转储到他们的整体包含目录中。

我开始考虑将包含目录拆分为上述几个域，然后意识到这听起来更像原始结构。

总而言之，选择似乎是：

1.  保留原始模型，所有标题都与源相邻 - 以项目中一些复杂包含为代价的最大灵活性。
2.  一个包含所有内容的目录
3.  按域拆分包含，因此可能有大约 6 个目录供使用该批次的人使用，但纯数据库用户可能只有一个目录。

从 Unix 构建方面来看，[推荐的结构](https://stackoverflow.com/questions/598167/header-files-in-multiple-directories-best-practices)是 2。我的情况很复杂，需要让 Visual Studio 和 XCode 用户满意（嗅探，CodeWarrior，我多么想念你！）。

**编辑 - 选择的解决方案：**

我在 include 中有[四个子目录。](http://oofile.svn.sourceforge.net/viewvc/oofile/trunk/include/)我开始尝试按平台进一步划分它们，但它很快就变得非常嘈杂。

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2009-03-11T14:53:09.440

就我个人而言，如果真的被推动，我会选择 2 或 3。

但无论您选择哪种方式，请在构建说明中明确说明如何设置包含路径。没有什么比构建一个开源项目更难了——开发人员想要一种快速的开箱即用体验，如果它涉及到许多未记录的环境变量（或其他任何东西），大多数都会消失。

# svn - 什么是SVN？(PHP)

> ID：634820
> 
> 赞同：5
> 
> 时间：2009-03-11T14:45:48.117
> 
> 标签：svn

基本上我对 PHP 很陌生，最近我听说过很多关于 SVN 的事情。在搜索（谷歌搜索）之后，我真正能找到的是 php.net 网站上的 SVN 函数。

有人可以解释一下 SVN 是什么，它的用途是什么，是否值得学习？

谢谢，本

* * *

## 回答 #1

> 赞同：18
> 
> 时间：2009-03-11T15:29:54.903

我想您可能想知道人们如何在 PHP 开发环境中使用 Subversion (SVN)。

在我工作的公司，我们在 Linux 上开发 PHP。我们使用颠覆来跟踪更改并帮助将更改发布到实时服务器。使用颠覆没有文件锁定或签入。每个开发人员都有一个存储库的工作副本，然后他对文件进行更改并将更改提交回存储库。在我们的登台服务器上，所有更改都通过使用颠覆更新与该服务器上的工作副本合并。Subversion 合并每个文件的所有更改，如果发生任何冲突，让您手动解决这些冲突。根据我的经验，冲突是非常罕见的。然后我们在登台服务器上测试应用程序。测试应用程序后，我们使用 subversion 以与登台服务器相同的方式更新实时服务器。使用颠覆的最大好处是能够合并更改，以便多个开发人员可以处理同一个文件。版本控制也是一个很大的好处，因为它允许您使用几个命令将应用程序恢复为已知良好的工作副本，或者从过去的版本中检索已删除的文件。

* * *

## 回答 #2

> 赞同：15
> 
> 时间：2009-03-11T14:48:48.497

SVN 是[Subversion](http://subversion.tigris.org/)的缩写，它是大多数软件项目的[版本控制系统](http://en.wikipedia.org/wiki/Revision_control)。除了 PHP 具有访问存储库的功能（可能有一个 PHP Subversion 存储库，但我认为他们正在使用 CVS）之外，它与 PHP 并没有太大关系。

[在Wikipedia](http://en.wikipedia.org/wiki/Subversion_(software))上查找以获取更多信息。

* * *

## 回答 #3

> 赞同：4
> 
> 时间：2009-03-11T14:52:07.867

SVN，“Subversion”的缩写，是一个版本控制系统。版本控制是......相当复杂，所以我不会在这里解释它......但是这个演示文稿很好地描述了问题（即“为什么需要版本控制”）和解决方案（即，“Subversion（除其他外）做什么来帮助你”）

[http://www-verimag.imag.fr/~moy/slides/bzr/bzr-handout.pdf](http://www-verimag.imag.fr/~moy/slides/bzr/bzr-handout.pdf)

从标题为“大纲”的幻灯片开始，然后到幻灯片“剩余限制”（其余部分也很好，但它并不完全符合您的要求）。

（Nitpicker 警告：这张幻灯片是关于 bzr 而不是 svn...但基本思想是相同的。

* * *

## 回答 #4

> 赞同：3
> 
> 时间：2009-03-11T14:49:17.593

SVN 是 Subversion，它是一个源代码控制系统。如果您当前没有使用其他源代码控制系统，明智的做法是投资一个。与其他一些开源控制系统相比，SVN 相当容易使用，并且在源存储库之上有一些简洁的工具可以让您更轻松地使用。

* * *

## 回答 #5

> 赞同：3
> 
> 时间：2009-03-11T14:49:37.887

SVN 是一个跟踪项目文件更改的系统。它通常用于任何类型的项目，无论是否是 PHP，以及许多并发用户，以允许他们更改文件而不会覆盖彼此的更改。

当然，您也可以将它用于您自己的项目。事实上，我这样做了，因为它还跟踪过去的更改，因此您可以返回到以前的版本，查看您在向文件存储库提交更改时所做的评论等。

它是旧 CVS（并发版本控制系统）的一个更好的版本。

* * *

## 回答 #6

> 赞同：2
> 
> 时间：2009-03-11T14:49:57.637

我相信 SVN 的意思是[Subversion](http://subversion.tigris.org/)，代码存储库。我不是 PHP 开发人员，所以我可能是错的。

* * *

## 回答 #7

> 赞同：0
> 
> 时间：2014-09-11T11:09:36.333

SVN（颠覆）是软件组织中使用的中央存储库，用于以修订的形式跟踪文件中所做的更改。例如，假设我的修订号为 1001 并且想要查看它。此修订版包含已提交的代码和数据。您还可以查看 SVN 中所有修订的历史记录，因为此功能在 CVS（当前版本控制系统）中不可用。

# html - IE7 正在剪切我的文本。如何调整它的态度？

> ID：634824
> 
> 赞同：17
> 
> 时间：2009-03-11T14:46:07.973
> 
> 标签：html, css, internet-explorer-7

几天前，我重新设计了我的网站。这个皮肤的开发主要是使用 safari 完成的，正如预期的那样，使用 firefox 和 opera 都可以很好地渲染。我不得不为 IE7 做一些小的调整，但没什么，除了一个问题......

帖子的日期指示器在 IE 中被截断。这个问题似乎只发生在左浮动 div 内的嵌套跨度标签上。我想我需要浮动 div 才能在屏幕的左侧和右侧布局文本。

你们中有人知道如何阻止 IE7 剪切我的文本吗？

编辑：我已经放弃了这个问题。我的脚本现在检查 IE7 并将其提供给它的有限引擎可以处理的稍微简化的 HTML。它在 IE8 中工作，所以，现在，只需要 IE7 的特殊情况......

* * *

## 回答 #1

> 赞同：19
> 
> 时间：2009-03-17T13:06:53.153

在大多数情况下，IE6 或 7 从文本底部剪辑，只需添加：

```
line-height: normal; 
```

到相关的 CSS 规则。应该很好地修复它，但正如您所理解的，它也扩展了盒子。

* * *

## 回答 #2

> 赞同：11
> 
> 时间：2011-09-19T21:11:26.463

我发现有一个技巧可以解决在 IE 中截断文本的问题。我注意到我的标题中的最后一行是唯一被切断的。

我原来的 CSS 在 IE7 中截断了最后一行，但在其他浏览器中看起来不错：

```
h2 {
   font-size: 22px;
   line-height: 1em;
} 
```

在此处查看问题图片：[https ://skitch.com/pablohart/f4g3i/windows-7-x64](https://skitch.com/pablohart/f4g3i/windows-7-x64)

我所做的修复包括简单地在底部添加填充，然后以负边距取回该填充。像这样：

```
h2 {
   font-size: 22px;
   line-height: 1em;
   padding-bottom: 5px;
   margin-bottom: -5px;
} 
```

请参阅此图片中的修复图片：[https ://skitch.com/pablohart/f4g4h/windows-7-x64](https://skitch.com/pablohart/f4g4h/windows-7-x64)

**行高**的问题：正常；是它采用字体的默认行高，通常为 1.3em。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2009-03-11T14:54:00.467

尝试添加溢出：可见；到您的 .postdate 课程。也许这有帮助。

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2011-11-30T02:00:29.243

我有一个类似的问题。我将跨度更改为 div 并解决了问题。我认为 IE7 可能在跨度上处理 line-height 有问题。尚未确认这是问题所在。还有其他 CSS 元素。（处理别人的代码。）但是从 span 更改为 div （块）解决了这个问题。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2009-03-11T17:43:36.080

为 .title 添加特定高度可以为我修复它（在 IE6 中）：

```
.title {
    PADDING: 0 10px 0 0; MARGIN-top: 0.3em; FLOAT: right; height: 1em; 
```

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2009-03-11T14:50:39.197

对于 .bigdate 类，尝试用填充替换边距；在我看来，这与 IE 的边距处理有关。

* * *

## 回答 #7

> 赞同：0
> 
> 时间：2012-03-13T08:01:47.400

我认为问题在于填充。我尝试删除“填充：3px”样式并且它工作正常。以前它没有显示任何内容。保罗哈特的回答向我展示了这一点。
可能还删除/覆盖边距属性也可能有所帮助。

* * *

## 回答 #8

> 赞同：0
> 
> 时间：2009-03-16T02:26:06.947

尽管无法在我当前的机器上对其进行测试：我怀疑这是一个[hasLayout 错误](http://www.satzansatz.de/cssd/onhavinglayout.html)。处理它的方法列在该链接的“[属性](http://www.satzansatz.de/cssd/onhavinglayout.html#prop)”部分。

* * *

## 回答 #9

> 赞同：0
> 
> 时间：2010-03-18T18:11:46.020

以我的经验，它总是在文本的底部被剪辑，这也基本上是因为重叠的划分。如果您能够确保 div 不重叠，那么问题就会得到解决。除了添加溢出：可见有时确实有帮助。

* * *

## 回答 #10

> 赞同：0
> 
> 时间：2010-03-18T18:17:12.223

尝试添加

```
div.postmeta { height: 100px; }
div.postdate { height: 75px; } 
```

任意高度值......但你会知道你想要的确切高度。这应该可以防止文本容器在 IE7 中被剪切。

# .net - 使用对象的字段作为通用字典键

> ID：634826
> 
> 赞同：128
> 
> 时间：2009-03-11T14:46:39.627
> 
> 标签：.net, generics, dictionary

如果我想使用对象作为 a 的键`Dictionary`，我需要重写哪些方法以使它们以特定方式进行比较？

假设我有一个具有属性的类：

```
class Foo {
    public string Name { get; set; }
    public int FooID { get; set; }

    // elided
} 
```

我想创建一个：

```
Dictionary<Foo, List<Stuff>> 
```

我希望`Foo`具有相同`FooID`的对象被视为同一组。我需要在`Foo`类中重写哪些方法？

总结一下：我想将`Stuff`对象分类为列表，按`Foo`对象分组。`Stuff`对象将有一个`FooID`将它们链接到它们的类别。

* * *

## 回答 #1

> 赞同：162
> 
> 时间：2009-03-11T14:49:16.390

默认情况下，两个重要的方法是`GetHashCode()`和`Equals()`。重要的是，如果两件事相等（`Equals()`返回 true），则它们具有相同的哈希码。例如，您可能会“返回 FooID；” 就`GetHashCode()`好像你想要它作为匹配一样。您也可以实现`IEquatable<Foo>`，但这是可选的：

```
class Foo : IEquatable<Foo> {
    public string Name { get; set;}
    public int FooID {get; set;}

    public override int GetHashCode() {
        return FooID;
    }
    public override bool Equals(object obj) {
        return Equals(obj as Foo);
    }
    public bool Equals(Foo obj) {
        return obj != null && obj.FooID == this.FooID;
    }
} 
```

最后，另一种选择是提供一个`IEqualityComparer<T>`做同样的事情。

* * *

## 回答 #2

> 赞同：33
> 
> 时间：2009-03-11T15:27:33.147

由于您希望`FooID`成为组的标识符，因此您应该将其用作字典中的键，而不是 Foo 对象：

```
Dictionary<int, List<Stuff>> 
```

如果您将`Foo`对象用作键，则只需实现`GetHashCode`and`Equals`方法以仅考虑`FooID`属性。就 而言，该`Name`属性只是自重`Dictionary`，因此您只需将`Foo`其用作`int`.

因此最好`FooID`直接使用该值，然后您不必实现任何东西，因为`Dictionary`已经支持使用 an`int`作为键。

编辑：
如果你想使用`Foo`类作为键，`IEqualityComparer<Foo>`很容易实现：

```
public class FooEqualityComparer : IEqualityComparer<Foo> {
   public int GetHashCode(Foo foo) { return foo.FooID.GetHashCode(); }
   public bool Equals(Foo foo1, Foo foo2) { return foo1.FooID == foo2.FooID; }
} 
```

用法：

```
Dictionary<Foo, List<Stuff>> dict = new Dictionary<Foo, List<Stuff>>(new FooEqualityComparer()); 
```

* * *

## 回答 #3

> 赞同：8
> 
> 时间：2009-03-11T14:48:57.530

对于 Foo 你将需要覆盖 object.GetHashCode() 和 object.Equals()

字典将调用 GetHashCode() 来计算每个值的哈希桶，并调用 Equals 来比较两个 Foo 是否相同。

确保计算出良好的哈希码（避免许多相等的 Foo 对象具有相同的哈希码），但要确保两个相等的 Foo 具有相同的哈希码。您可能希望从 Equals 方法开始，然后（在 GetHashCode() 中）异或在 Equals 中比较的每个成员的哈希码。

```
public class Foo { 
     public string A;
     public string B;

     override bool Equals(object other) {
          var otherFoo = other as Foo;
          if (otherFoo == null)
             return false;
          return A==otherFoo.A && B ==otherFoo.B;
     }

     override int GetHashCode() {
          return 17 * A.GetHashCode() + B.GetHashCode();
     }
} 
```

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2016-04-02T10:51:27.083

上课呢`Hashtable`！

```
Hashtable oMyDic = new Hashtable();
Object oAnyKeyObject = null;
Object oAnyValueObject = null;
oMyDic.Add(oAnyKeyObject, oAnyValueObject);
foreach (DictionaryEntry de in oMyDic)
{
   // Do your job
} 
```

通过上述方式，您可以使用任何对象（您的类对象）作为通用字典键:)

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2017-10-14T06:03:00.900

我有同样的问题。由于覆盖了 Equals 和 GetHashCode，我现在可以使用我尝试过的任何对象作为键。

这是我使用在 Equals(object obj) 和 GetHashCode() 的覆盖中使用的方法构建的类。我决定使用应该能够覆盖大多数对象的泛型和散列算法。如果您在这里看到任何不适用于某些类型的对象并且您有办法改进它，请告诉我。

```
public class Equality<T>
{
    public int GetHashCode(T classInstance)
    {
        List<FieldInfo> fields = GetFields();

        unchecked
        {
            int hash = 17;

            foreach (FieldInfo field in fields)
            {
                hash = hash * 397 + field.GetValue(classInstance).GetHashCode();
            }
            return hash;
        }
    }

    public bool Equals(T classInstance, object obj)
    {
        if (ReferenceEquals(null, obj))
        {
            return false;
        }
        if (ReferenceEquals(this, obj))
        {
            return true;
        }
        if (classInstance.GetType() != obj.GetType())
        {
            return false;
        }

        return Equals(classInstance, (T)obj);
    }

    private bool Equals(T classInstance, T otherInstance)
    {
        List<FieldInfo> fields = GetFields();

        foreach (var field in fields)
        {
            if (!field.GetValue(classInstance).Equals(field.GetValue(otherInstance)))
            {
                return false;
            }
        }

        return true;
    }

    private List<FieldInfo> GetFields()
    {
        Type myType = typeof(T);

        List<FieldInfo> fields = myType.GetTypeInfo().DeclaredFields.ToList();
        return fields;
    }
} 
```

以下是它在课堂上的使用方式：

```
public override bool Equals(object obj)
    {
        return new Equality<ClassName>().Equals(this, obj);
    }

    public override int GetHashCode()
    {
        unchecked
        {
            return new Equality<ClassName>().GetHashCode(this);
        }
    } 
```

# regex - 正则表达式正在切断文件名的最后一个字符

> ID：634827
> 
> 赞同：2
> 
> 时间：2009-03-11T14:47:06.817
> 
> 标签：regex

任何人都知道为什么会这样：

```
Filename:     031\_Lobby.jpg

RegExp:       (\d+)\_(.*)[^\_e|\_i]\.jpg

Replacement:  \1\_\2\_i.jpg 
```

这产生了这个：

```
031\_Lobb\_i.jpg 
```

出于某种原因，它从第二个反向引用（“Lobby”中的“y”）中删除了最后一个字符。当我删除时它*不*会这样做，`[^_e|_i]`所以我必须做一些与此相关的错误。

谢谢！

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2009-03-11T14:56:16.920

你强迫它用你的正则表达式的这部分砍掉最后一个字符：

```
[^_e|_i] 
```

翻译为：除`"_"`, `"e"`, `"|"`,之外的任何单个字符`"i"`。

`"y"`in`"Lobby"`符合此标准。

你的*意思是* `"not _e"`and `"not _i"`，显然，但这不是表达它的方式。这是正确的：

```
(\d+)_(.+)(?<!_[ei])\.jpg 
```

请注意，点需要在正则表达式中进行转义。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-03-11T14:56:46.233

它正在删除“y”，因为 [^_e|_i] 匹配 y，并且`.*`匹配 y 之前的所有内容。

* * *

## 回答 #3

> 赞同：-1
> 
> 时间：2009-03-11T14:55:52.880

你强迫它有一个不同于 _e 和 _i 的最后一个字符。您应该改用它（注意最后一个 *）：

```
(\d+)_(.*)[^_e|_i]*.jpg 
```

# c# - 在 LINQ 中通过子属性对父对象进行排序

> ID：634829
> 
> 赞同：3
> 
> 时间：2009-03-11T14:47:32.743
> 
> 标签：c#, linq

如何在 LINQ 中按子对象排序？

类 A、B 和 C。A 有 B 的集合，B 有 C 的集合。我想通过 C 的 Ordinal (int) 属性对对象 A 进行排序。

```
var query = from a in db.A
        orderby a.Bs.OrderBy(x=> x.C.Ordinal)   <--- ??
        select a; 
```

我似乎无法弄清楚 orderby 声明。

编辑：

对不起，我原来的说法不正确：

A 有一个 B 的集合，B 有一个 C 对象。C 不是一个集合。

每个 A 都应该按 C 的序数属性排序。

另一个编辑/解决方案：

在显示期间，我最终在客户端为 A 中的每个 B 集合执行了 .OrderBy(b=>bCOrdinal) 。无论如何，结果更好，因为我可以让客户按他们需要的任何东西订购，而不是将其嵌入到我的存储库中。

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2009-03-11T14:52:10.440

您需要确定您对*哪个*C 感兴趣。

考虑一下实际情况 - 如果您试图按孩子的年龄对父母进行排序，您会考虑*哪个孩子的年龄？*如果您有一位父母带着 1 岁和 5 岁的孩子，另一位父母带着 2 岁和 4 岁的孩子，应该先到哪一个？

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2009-03-11T14:49:21.977

您正在尝试按集合订购。那是行不通的。您需要从子列表中选择一个元素或聚合单个值。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2009-03-11T15:08:30.120

我将运用我的美国直觉，假设您想按每个 A 的最大 C.Ordinal 排序。

```
IEnumerable<A> result = db.As
  .OrderBy(a => a.Bs
    .Max(b => b.C.Ordinal)
  ); 
```

编辑：更新为“`b.Cs`不是集合”

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2010-07-20T19:21:02.863

这可能不是您正在寻找的确切内容，但它可能会给您一些想法：

.OrderBy( b => bCFirstOrDefault().Ordinal)

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2009-03-18T15:10:00.597

在显示期间，我最终在客户端为 A 中的每个 B 集合执行了 .OrderBy(b=>bCOrdinal) 。无论如何，结果更好，因为我可以让客户按他们需要的任何东西订购，而不是将其嵌入到我的存储库中。

# ruby - 如何实现 Watir 类（例如 PageContainer）？

> ID：634830
> 
> 赞同：2
> 
> 时间：2009-03-11T14:47:35.630
> 
> 标签：ruby, class, watir

我正在用 Watir 编写一个示例测试，在该测试中我使用 IE 类浏览网站，发出查询等。效果很好。

我想继续在我登陆的最后一页上使用[PageContainer的方法。](http://wtr.rubyforge.org/rdoc/classes/Watir/PageContainer.html)例如，在该页面上使用其 HTML 方法。

现在我是 Ruby 的新手，刚开始为 Watir 学习它。

我尝试在 OpenQA 上问这个问题，但由于某种原因，Watir 部分仅限于普通成员。

谢谢你看我的问题。

**编辑：**这是一个简单的例子

```
require "rubygems"
require "watir"

test_site = "http://wiki.openqa.org/"

browser = Watir::IE.new

browser.goto(test_site)

# now if I want to get the HTML source of this page, I can't use the IE class 
# because it doesn't have a method which supports that

# the PageContainer class, does have a method that supports that
# I'll continue what I want to do in pseudo code

Store HTML source in text file

# I know how to write to a file, so that's not a problem;
# retrieving the HTML is the problem.
# more specifically, using another Watir class is the problem.

Close browser

# end 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-03-11T16:35:55.730

目前，获得 Watir 问题答案的最佳位置是[Watir-General](http://groups.google.com/group/watir-genera)电子邮件列表。

对于这个问题，很高兴看到更多代码。正在测试的应用程序 (AUT) 是否打开了您无法访问的新窗口/选项卡，因此想尝试 PageContainer，还是只是导航到第二页？

如果是第一个，你想看[#attach](http://wtr.rubyforge.org/rdoc/classes/Watir/IE.html#M000224)，如果是第二个，那么我建议阅读[快速入门教程](http://wiki.openqa.org/display/WTR/Quick+Start)。

**在上面添加代码后进行编辑：**

我认为您错过的是[Watir::IE](http://wtr.rubyforge.org/rdoc/classes/Watir/IE.html)包含 Watir::PageContainer[模块](http://www.ruby-doc.org/core/classes/Module.html)。因此，您可以调用`browser.html`以获取在您导航到的页面上显示的 html。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-10-30T19:20:35.773

我同意。在我看来，这`browser.html`就是你想要的。

# sql - 可以将另一个表中的值插入到一个表中吗？

> ID：634831
> 
> 赞同：1
> 
> 时间：2009-03-11T14:47:35.817
> 
> 标签：sql, insert

所以说我想...

插入tableA，tableB中的2个变量，但只有tableB中具有1个变量等于某个事物的行...

嗯，让我们看看我是否可以更具体...

我想在tableA中为tableB中courseid为11的每一行的userid和courseid创建一个新行

请指教

* * *

## 回答 #1

> 赞同：17
> 
> 时间：2009-03-11T14:48:59.463

```
INSERT
INTO    tableA (col1, col2)
SELECT  userid, courseid
FROM    tableB
WHERE   courseid = 11 
```

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2009-03-11T14:49:26.390

好吧，不知道您在 tableA 中有哪些列，我会说：

```
insert into tableA
select 
    userid,
    courseid 
from tableB where 
courseid=11 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-03-11T14:50:44.343

```
INSERT INTO TableA (userid, courseid)

SELECT userid, courseid FROM TableB
WHERE courseid = 11 
```

那应该为你做。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2009-03-11T14:52:28.240

你没有提到你正在使用哪个数据库。

对我来说，MS Access 在尝试做这样的事情时被证明是非常错误的。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2009-03-11T14:56:27.230

如果要使用现有数据创建新表，则可以使用[SELECT INTO ：](http://www.w3schools.com/Sql/sql_select_into.asp)

```
SELECT <columns here> INTO tableA FROM tableB WHERE <restrictions here> 
```

如果要将现有数据插入现有表中，则必须使用：

```
INSERT INTO tableA (<destination columns>) SELECT <source columns> FROM tableB WHERE <restrictions here> 
```

如其他答案中所述

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2009-04-16T11:19:06.963

插入 tableA(column1,column2,column3) 从表 B 中选择 column1,column2,column3

# database - 一个视图中的 Oracle 表

> ID：634840
> 
> 赞同：0
> 
> 时间：2009-03-11T14:49:11.023
> 
> 标签：database, oracle

我在 oracle 数据库中有 2 个表，它们具有相同的列名和类型。例如：

表 1：id、名称、评论 表
2：id、名称、评论

如何在一个视图中显示两个表中的所有数据？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-03-11T14:56:18.980

如果您想要 4 个单独的列，只需使用别名，就像您使用任何其他选择一样。

```
create or replace view vw_my_view as
  select t1.id t1_id
        ,t1.comment t1_comment
        ,t2.id t2_id
        ,t2.comment t2_comment
  from table1 t1
    inner join table2 t2 on join condition
  where filter conditions 
```

**编辑**当然，您的表格将以某种方式相互关联，否则您的视图的单行没有任何意义。因此，您将有一个连接条件来连接两个表，例如 t1.id = t2.id

如果您希望它们在两列中，请使用 Union

```
create or replace view vw_my_view as
  select id
        ,comment
  from table1
  union all                -- use ALL unless you want to lose rows
  select id
        ,comment
  from table2; 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-03-11T14:54:42.760

为什么有两个相同的表？“不要重复自己”到底发生了什么？抱歉，对我来说，这听起来像是一种糟糕的设计气味。

无论是何种差异激发了您创建两张表，我敢打赌它确实可能是在一张表中区分两组的另一个属性。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-03-11T14:56:54.750

选择 * 从表 1 联合选择 * 从表 2

（或 UNION ALL 如果你想要重复）

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2009-03-11T14:56:54.780

我同意 duffymo 的说法，但如果有充分的理由，那么 UNION 会为你做这件事。例如

```
SELECT id, name, comment FROM Table1
UNION
SELECT id, name, comment FROM Table2 
```

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2009-03-11T14:57:15.980

```
select * from table1
union
select * from table2; 
```

# excel - 限制 Excel 中的自定形移动

> ID：634853
> 
> 赞同：2
> 
> 时间：2009-03-11T14:50:13.067
> 
> 标签：excel, vba

这是我在这里的第一个问题，所以尽量不要苛刻。

我正在尝试创建一个 excel 表，它执行以下操作：

1.  通过自定义类从数据库中读取信息
2.  使用读取的规范，它创建自动形状并将它们放在第一张纸中

当有人更改自选图形（即调整大小或移动它们）时，有什么方法可以获取信息？我考虑过使用内置事件 - 但它们都不适合我。我可以以任何其他方式限制 autoshape 运动吗？

此表需要在 Microsoft Office 2003 中完成。

如果有任何帮助，我将不胜感激。

最好的问候，迈克。

**[编辑]
我认为我找到了一个部分解决方案 - 我会测试它是否有效，如果是的话 - 我会在这里发布。**

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-03-11T20:26:02.180

No there are no events that apply to shapes. The best you could do is use the existing events - like SheetChange, SheetSelectionChange, WorkbookBeforeSave etc.

Then loop through the Sheet.Shapes collection checking for changes and revert them. You will have to know the original size and locations.

**Have you thought of just locking them and protecting the sheet?**

# python - Django：从 Form clean 方法调用自定义模型方法。“无界法”？

> ID：634857
> 
> 赞同：1
> 
> 时间：2009-03-11T14:51:12.440
> 
> 标签：python, django

我在尝试从我的 Form`clean`方法调用自定义 Model 方法时遇到问题。

这是我的模型的[部分]：http:
[//dpaste.com/hold/12695/](http://dpaste.com/hold/12695/)

这是我的表格：
[http ://dpaste.com/hold/12699/](http://dpaste.com/hold/12699/)

我的表单中的第 11 行特别有问题：
`nzb_data = File.get_nzb_data(nzb_absolute)`

这会引发以下错误：

```
TypeError at /admin/main/file/add/

unbound method get_nzb_data() must be called with File instance as first argument (got str instance instead) 
```

通过这个错误，我可以假设我必须向方法传递一些东西（一个 File 实例），但是我真的不知道这意味着什么以及我该怎么做。

你能让我知道我在这里做错了什么，以及可以做些什么来解决这个问题？

* * *

**通过使用装饰器使`get_nzb_data`方法成为类方法来**解决。**`@classmethod`**

 *** * *

## 回答 #1

> 赞同：3
> 
> 时间：2009-03-11T14:54:39.607

你不能打电话

```
nzb_data = File.get_nzb_data(nzb_absolute) 
```

因为您使用的是类，而不是对象。

你有两个选择。

1.  做`get_nzb_data`一个`@classmethod`. 请参阅[http://docs.python.org/library/functions.html#classmethod](http://docs.python.org/library/functions.html#classmethod)

2.  创建一个 File 实例并使用它。 `temp_f= File(...)`. 然后`temp_f.get_dnb_data`。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-03-11T14:57:20.880

我可能在这里遗漏了一些东西，但我认为你的方法“get_nzb_data”应该有一个@classmethod 装饰器。否则，它需要 File 类型的“self”参数，这会给出错误。

# java - 如何使用任意控件获取 swt 表上的文本内容

> ID：634864
> 
> 赞同：2
> 
> 时间：2009-03-11T14:51:58.037
> 
> 标签：java, swt

我在桌子上放置了不同的控件，使用`TableEditor`.

```
...
TableItem [] items = table.getItems ();
for (int i=0; i<items.length; i++) {
    TableEditor editor = new TableEditor (table);
    final Text text1 = new Text (table, SWT.NONE);
    text1.setText(listSimOnlyComponents.get(i).getName());
    text1.setEditable(false);
    editor.grabHorizontal = true;
    editor.setEditor(text1, items[i], 0);

    editor = new TableEditor (table);
    final CCombo combo1 = new CCombo (table, SWT.NONE);
    combo1.setText("");
    Set<String> comps = mapComponentToPort.keySet();
    for(String comp:comps)
        combo1.add(comp);
    editor.grabHorizontal = true;
    editor.setEditor(combo1, items[i], 1);
} //end of for
... 
```

当我尝试使用 获取表格上的文本时`getItem(i).getText`，我得到空字符串

```
...
TableItem [] items = table.getItems ();
for(int i=0; i<items.length; i++) {
    TableItem item = items[i];
    String col0text = items[i].getText(0);  //this text is empty
    String col1text = items[i].getText(1);  //this text is empty
}
... 
```

为什么即使我有文本出现在表格上，getText 也会返回空字符串？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2014-09-20T20:49:40.090

您可以考虑使用 data 属性，而不是使用 text 属性。

好处：

1.  您可以将数据（例如控件或复杂数据结构）直接附加到表项。
2.  您的表格项目创建需要从表格单元格编辑器中知道的唯一事情是要存储在数据属性中的对象引用。
3.  你不需要那些事件处理的东西（当你真正需要的时候读取控件数据）。

创造：

```
TableItem item = new TableItem(table, SWT.None);
TableEditor editor = new TableEditor(table);
Button checkbox = new Button(table, SWT.CHECK);
checkbox.pack();
editor.setEditor(checkbox,item,0);
item.setData("cb",checkbox);   // using key enables you to add more pieces of complex data 
```

读：

```
for (TableItem item : table) {
  Button checkbox = (Button) item.getData("cb");
  if (checkbox.getSelection()) { /* ... do whatever you want */ }
} 
```

当表格出现时，复选框可见并且可以单击。在透明背景控件的情况下使用 setText 方法会失败 -> 您将在控件下方看到表格项单元格的文本（我试过了）。

无论如何，如果可以扩展表项类以隐藏数据键，那会容易得多。但像往常一样，子类化被拒绝。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-03-11T16:31:55.490

在我添加的控件的事件侦听器中

```
 item.setText call
  ...
  combo1.addSelectionListener(new SelectionAdapter() {
  public void widgetSelected(SelectionEvent evt) {
              String sel = combo2.getText();
      item.setText(ComponentPortToConnectCol, sel);
}});
  ... 
```

这给了我想要的结果。感谢 OTisler 提供线索

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-03-11T15:49:03.033

你是如何布置餐桌的？我复制了您的代码以对其进行调试并如下所示设置表（第一个 for 循环）
我尝试但无法重现您看到的问题。这可能是您向表格添加内容的方式。
[表格编辑器示例](http://www.java2s.com/Code/Java/SWT-JFace-Eclipse/TableEditorexample.htm)

```
Display display = new Display();
        Shell shell = new Shell(display);
        shell.setLayout(new FillLayout());
        final Table table = new Table(shell, SWT.BORDER | SWT.MULTI);
        for (int i = 0; i < 3; i++) {
            TableItem item = new TableItem(table, SWT.NONE);
            item.setText(new String[] { "" + i, "" + i, "" + i });
        }
        TableItem [] items = table.getItems();
        for (int i=0; i<items.length; i++) {
            TableEditor editor = new TableEditor (table);
            final Text text1 = new Text (table, SWT.NONE);
            text1.setText("TEST");
            text1.setEditable(false);
            editor.grabHorizontal = true;
            editor.setEditor(text1, items[i], 0);

            editor = new TableEditor (table);
            final CCombo combo1 = new CCombo (table, SWT.NONE);
            combo1.setText("");
            String[] comps = {"A","B","C"};
            for(String comp:comps)
                combo1.add(comp);
            editor.grabHorizontal = true;
            editor.setEditor(combo1, items[i], 1);
        } //end of for

        TableItem [] items2 = table.getItems ();
        for(int i=0; i<items2.length; i++) {
            TableItem item = items2[i];
            String col0text = items2[i].getText(0);  //returns '0' first for loop
        } 
```

# c# - 如何从服务获取登录用户的活动窗口

> ID：634872
> 
> 赞同：2
> 
> 时间：2009-03-11T14:52:40.313
> 
> 标签：c#, windows-services, pinvoke, user32

我正在编写一个 C# 服务，它必须从当前登录的用户那里检索信息，例如活动窗口或最后一次鼠标移动。我已经了解到我可以使用 user32.dll 来检索这些信息，但这只能在调用方法的用户上下文中工作。

这样，我的服务只能检索有关其自身的信息，而不能检索有关“真实世界”用户的信息。我还听说这应该可以通过使用 WTSEnumerateSessions、OpenWindowStation、EnumDesktops 等来实现，但我还没有找到一个示例来展示如何做到这一点。

有人知道如何实现我的目标（或者可能是一些代码示例）吗？

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2009-03-11T14:58:38.473

这听起来很像在用户会话中运行的应用程序的工作。行为良好的服务不应该像那样窥探用户。*可能*有办法做到这一点（老实说，我不知道），但听起来不太……正确。

请注意，对于最新版本的 Windows，控制台会话（会话 0）仅限于管理目的，用户（通常）不会在那里。您可能有零个、一个或多个非控制台会话。

# javascript - 最快的 DOM 插入

> ID：634878
> 
> 赞同：15
> 
> 时间：2009-03-11T14:53:27.083
> 
> 标签：javascript, dom

进行 DOM 插入的最佳实践是什么？

*   在循环中一次插入大块 html vs element 是否更快？
*   您插入的 html 是否重要，或者只有块有多大？
*   与使用 table hack 仅插入行相比，插入表更快吗？

* * *

## 回答 #1

> 赞同：18
> 
> 时间：2009-03-11T15:07:06.847

设置`innerHTML`通常比插入单独的节点更快。

另一种可能性是[创建一个 DocumentFragment](https://developer.mozilla.org/en/DOM/document.createDocumentFragment)，它允许一次插入所有节点。使用 DocumentFragments 的另一个优点是它们可以很容易地被[克隆](https://developer.mozilla.org/En/DOM/Node.cloneNode)，这可以替代很多用例，`innerHTML`并且由于不涉及解析，因此可能更快。

* * *

## 回答 #2

> 赞同：11
> 
> 时间：2009-03-11T14:59:47.817

innerHTML 插入比 DOM 操作 1:1 稍快一些，并且在您实际插入多个节点和属性等的情况下获得更多收益。但它更容易出错和危险，因为它本质上是一个伪装的 eval 语句。

以我的经验，这些天 JS 是如此之快，以至于 innerHTML 的速度提升并不能证明除了最大的插入/迭代批次之外的任何风险。

长话短说，您希望尽可能少地进行 DOM 操作，因此在创建插入层次结构时的一个技巧是在内存中创建它们，然后在可能的最后时刻将最高元素插入 DOM。这为浏览器留下了最少的渲染更新。当然，我们又在谈论几分之一毫秒......

* * *

## 回答 #3

> 赞同：3
> 
> 时间：2017-05-21T12:06:08.537

在许多情况下， innerHTML 实际上**比**直接 DOM 操作要慢。在 jsperf 上查看这个[基准](https://jsperf.com/insertadjacenthtml-perf/3)

没有“正确答案”，您必须为您的特定用例找到正确、最有效的方法

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2009-03-11T14:58:50.313

对于大块的 html，将文本分配给 innerHTML 肯定更快。尽管所有主流浏览器都支持innerHTML，但innerHTML 不在w3c 标准中，因此有些程序员犹豫使用它。

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2009-03-11T15:00:27.283

一次完成所有操作肯定更快。还可以查看[Steve Souder 的博客](http://stevesouders.com/)和他的[书](https://rads.stackoverflow.com/amzn/click/com/0596529309)。

# c# - 如何在运行时将 Windows 窗体的 AcceptButton 设置为 None

> ID：634887
> 
> 赞同：2
> 
> 时间：2009-03-11T14:55:07.907
> 
> 标签：c#, visual-studio-2003

要在运行时设置表单的 AcceptButton，我这样做：

```
this.AcceptButton = this.btnButtonName; 
```

但是谁能告诉我如何清除表单的 AcceptButton，例如：

```
this.AcceptButton = None; 
```

谢谢。

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2009-03-11T14:56:07.933

试试这个：

```
this.AcceptButton = null; 
```

# asp.net - 多个值绑定到单个标志枚举的 CheckBoxList

> ID：634911
> 
> 赞同：0
> 
> 时间：2009-03-11T14:58:58.833
> 
> 标签：asp.net, .net-3.5, objectdatasource, formview, checkboxlist

我有一个 FormView（绑定到 ObjectDataSource），其中包含一个 CheckBoxList，我想将它绑定到底层对象的单个属性，该属性是一个应用了 FlagsAttribute 的枚举。绑定到 SelectedValue 属性总是给我从列表中选择的第一个值作为属性的值。任何人都知道如何在不覆盖 Inserting 或 Updating 方法并手动获取复选框列表的值并将其填充到数据源的参数中的情况下解决此问题？下面是我正在尝试做的示例代码......

```
<asp:FormView runat="server" ID="MyFormView" DataSourceID="MyDataSource">
   <InsertItemTempate>
      <asp:CheckBoxList runat="server" ID="MyCbl" SelectedValue='<%# Bind("MyProperty") %>'>
         <asp:ListItem Text="Choice 1" Value="ChoiceOne"></asp:ListItem>
         <asp:ListItem Text="Choice 2" Value="ChoiceTwo"></asp:ListItem>
      </asp:CheckBoxList>
   </InsertItemTemplate>
</asp:FormView>
<asp:ObjectDataSource runat="server" ID="MyDataSource" TypeName="MyClass" ...></asp:ObjectDataSource> 
```

在幕后，我的对象是这样声明的......

```
public class MyClass
{
   public MyEnum MyProperty { get; set; }
}

[Flags()]
public Enum MyEnum
{
   ChoiceOne = 1,
   ChoiceTwo = 2
} 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-03-11T15:04:48.663

您将不得不遍历`Items`集合并从那里建立枚举值。

在 Google 上搜索`FlaggedEnumTypeConverter`也应该会有所帮助。

# c# - Direct3D 中的高效线条绘制（Transformation2D？）

> ID：634926
> 
> 赞同：2
> 
> 时间：2009-03-11T15:01:08.373
> 
> 标签：c#, directx, matrix, transform, slimdx

**背景：**我正在使用 DirectX 的 SlimDX C# 包装器，并且正在使用 Sprite 类（传统上来自底层 dll 中的 Direct3DX 扩展）绘制许多 2D 精灵。我一次在屏幕上绘制了数百个精灵，性能非常棒——在我的四核上，它在我的整个游戏中使用了大约 3-6% 的处理器，包括 10,000 多个对象的逻辑，ai第二个线程上的例程等。所以很明显，精灵正在使用全硬件加速进行绘制，一切都应该是这样。

**问题：**当我开始引入对 Line 类的调用时，问题就出现了。一旦我画了 4 条线（用于拖动选择框），处理器使用率就会飙升至 13-19%。这只有四行！

**我尝试过的事情：**

1.  关闭和打开线抗锯齿。
2.  关闭和打开 GLLines。
3.  围绕我的绘图调用手动调用 line.begin 和 line.end。
4.  省略对 line.begin 和 line.end 的所有调用。
5.  确保我对 line.draw 的调用不在 sprite.begin / sprite.end 块内。
6.  在 sprite.begin / sprite.end 块内调用 line.draw。
7.  渲染 4 行，或渲染 300。
8.  关闭所有精灵和文本渲染，只保留 4 行的线渲染（看看这是否是某种模式更改问题）。
9.  以上的大多数组合。

一般来说，这些都不会对性能产生重大影响。#3 将处理器使用率降低了大约 2%，但即便如此，它仍然比应有的水平高出 8% 或更多。最奇怪的是，上面的#7 对性能的影响绝对为零——4 行和 300 行一样慢。我唯一能想到的是，由于某种原因，这是在软件中运行的，和/或它导致图形卡在某种绘图模式之间不断来回切换。

**矩阵法：**

如果有人知道上述问题的任何解决方法，那么我很想听听！

但是我假设这可能只是directx内部的一个问题，所以我一直在追求另一条路线——制作我自己的基于精灵的线。本质上，我有一个 1px 的白色图像，我使用漫反射颜色和变换来绘制线条。这在性能方面很有效——画出 300 条这样的“线”使我处于我在四核上寻找的 3-6% 的处理器利用率性能范围内。

我的像素拉伸线技术有两个问题，我希望对变换更了解的人可以帮助我。这是我当前的水平线代码：

```
 public void DrawLineHorizontal( int X1, int X2, int Y, float HalfHeight, Color Color )
    {
        float width = ( X2 - X1 ) / 2.0f;
        Matrix m = Matrix.Transformation2D( new Vector2( X1 + width, Y ), 0f, new Vector2( width, HalfHeight ),
            Vector2.Zero, 0, Vector2.Zero );
        sprite.Transform = m;

        sprite.Draw( this.tx, Vector3.Zero, new Vector3( X1 + width, Y, 0 ), Color );
    } 
```

这是可行的，因为它在屏幕上大部分正确的位置绘制了大部分正确大小的线条。然而，事情似乎向右移动，这很奇怪。我不太确定我的矩阵方法是否正确：我只想将 1x1 精灵水平缩放一些像素，垂直缩放不同的像素。然后我需要能够定位它们——在中心点很好，我认为这就是我必须做的，但如果我能把它定位在左上角那就更好了。这似乎是一个简单的问题，但我对矩阵的了解很薄弱。

这将使纯水平线和纯垂直线对我有用，这是战斗的大部分内容。我可以忍受这一点，并在我目前使用斜线的位置使用其他类型的图形。但是，如果我有一种方法可以使用这种拉伸像素方法绘制有角度的线条，那就太好了。换句话说，例如，从 1,1 到 7,19 画一条线。使用矩阵旋转等，这似乎是可行的，但除了猜测和检查之外，我什至不知道从哪里开始，这将花费很长时间。

非常感谢任何和所有帮助！

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-03-11T15:16:50.023

听起来像是管道停顿。您正在渲染精灵和渲染线之间切换某种模式，这会强制显卡在开始使用新图元之前清空其管道。

在你添加线条之前，这些精灵是你渲染的，还是屏幕上还有其他元素，已经使用其他模式？

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-03-11T17:56:41.057

好的，经过大量实验，我设法使水平线工作。这在没有我以前看到的奇怪偏移的情况下有效；同样的原理也适用于垂直线。这比*line*类的性能要好得多，所以这就是我将用于水平和垂直线的方法。这是代码：

```
 public void DrawLineHorizontal( int X1, int X2, int Y, float HalfHeight, Color Color )
    {
        float width = ( X2 - X1 );
        Matrix m = Matrix.Transformation2D( new Vector2( X1, Y - HalfHeight ), 0f, new Vector2( width, HalfHeight * 2 ),
            Vector2.Zero, 0, Vector2.Zero );
        sprite.Transform = m;

        sprite.Draw( this.tx, Vector3.Zero, new Vector3( X1, Y - HalfHeight, 0 ), Color );
    } 
```

我想要一个版本，它也适用于角度线（如上所述）。对此有什么建议吗？

# java - 如何检查会话是否无效

> ID：634929
> 
> 赞同：30
> 
> 时间：2009-03-11T15:01:52.210
> 
> 标签：java, session, httpsession

如何检查会话是否无效？[API](http://java.sun.com/products/servlet/2.2/javadoc/javax/servlet/http/HttpSession.html)中没有方法。

是一样的`isNew()`吗？如果不是，有什么区别？

* * *

## 回答 #1

> 赞同：50
> 
> 时间：2009-03-11T19:50:34.717

如果您想根据请求知道它是否有效：

```
request.isRequestedSessionIdValid()

  or

HttpSession sess = request.getSession(false);
if (sess != null) {
   // it's valid
} 
```

如果您存储了对会话的引用并且需要验证我会

```
try {
  long sd = session.getCreationTime();
} catch (IllegalStateException ise) {
  // it's invalid
} 
```

* * *

## 回答 #2

> 赞同：5
> 
> 时间：2009-03-11T20:17:07.273

`isNew()`仅当客户端尚未接受此会话时才为真（即，它刚刚创建，并且尚未发送 JSESSIONID，或者如果已发送，客户端没有将其发回，因此服务器不知道它并创建了另一个会话）

* * *

## 回答 #3

> 赞同：3
> 
> 时间：2009-03-11T15:06:23.447

出于所有意图和目的，是的。但是，如果在同一请求-响应周期中无效的会话上调用，它将抛出 IllegalStateException。

# java - HttpURLConnections 忽略超时并且永不返回

> ID：634931
> 
> 赞同：3
> 
> 时间：2009-03-11T15:02:19.840
> 
> 标签：java, timeout, httpurlconnection

尝试从 HttpURLConnection 打开 InputStream 时，我们从某些服务器随机得到一些意外结果。似乎这些服务器会接受连接并使用“保持活动”标头进行回复，这将使 Socket 保持打开状态，但不允许将数据发送回流。

这种情况使多线程爬虫的尝试有点“复杂”，因为如果某些连接被卡住，运行它的线程将永远不会返回......否认它的池的完成，该池在控制器中派生，认为某些线程是还在工作。

是否有某种方法可以读取连接响应标头以识别“保持活动”的答案并避免尝试打开流？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-03-11T15:15:09.993

除了“连接超时”之外，您是否尝试设置“读取超时”？

请参阅[http://java.sun.com/j2se/1.5.0/docs/api/java/net/URLConnection.html#setReadTimeout%28int%29](http://java.sun.com/j2se/1.5.0/docs/api/java/net/URLConnection.html#setReadTimeout%28int%29)

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-03-12T14:28:14.297

我不确定我在这里缺少什么，但在我看来你只需要[getHeaderField()](http://java.sun.com/javase/6/docs/api/java/net/URLConnection.html#getHeaderField(java.lang.String))？

# visual-studio-2008 - Release 模式下的时间性能：VC++ 2008 和 VC++ 2005 Express Edition 的一个怪异差异

> ID：634937
> 
> 赞同：1
> 
> 时间：2009-03-11T15:03:42.860
> 
> 标签：visual-studio-2008, visual-studio-2005, time, release

我在 VC++ 2008 和 VC++ 2005 Express Edition 中运行了相同的项目（具有相同的配置属性）。我对它们之间的时间性能差异感到惊讶：VC++ 2008 比 VC++ 2005 Express Edition 花费了更多的时间（大约增加了 30% 的时间）。为什么会这样？是因为Express Edition更轻吗？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2009-03-11T15:51:55.430

这么大的差异，一定是因为优化设置。如果您将项目从 2005 年转换为 2008 年，请查看[此问题](https://stackoverflow.com/questions/361730/vs2008-binary-3x-times-slower-than-vs2005)。我做了一些测试来比较 VS 2003 和 VS 2008 之间的性能，我的应用程序的性能大致相同。

**编辑：** 我在 2003 年到 2008 年的转换中遇到了类似的问题。在我玩了优化设置后，试图找到一个更好的设置，在特定的时刻性能“恢复正常”。这是在我意识到上述问题之前。我不明白原因，我仍然不明白，但我对结果很满意......所以我能给出的唯一建议是尝试更改优化设置并再次测试。

# maven-2 - 多模块 Web 项目中的 Maven：如何将兄弟模块输出到 WEB-INF/classes 而不是作为 JAR 放入 WEB-INF/lib？

> ID：634943
> 
> 赞同：4
> 
> 时间：2009-03-11T15:04:19.037
> 
> 标签：maven-2, war

我有一个多模块 Maven 项目。默认情况下，当我构建一个 web 模块时，它所依赖的所有 JAR 类型的兄弟模块都被复制到 WEB-INF/lib 文件夹中。我希望将兄弟模块的输出放在 WEB-INF/classes 文件夹中而不打包到 JAR 中。

更普遍的问题可能是：如何将兄弟模块的配置文件保留在 JAR 之外，以便在部署后可以轻松地对其进行编辑？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-03-11T15:09:37.823

您可以使用[overlay](http://maven.apache.org/plugins/maven-war-plugin/overlays.html)，尽管这要求兄弟姐妹的类型是 war 而不是 jar。也有使用依赖插件解压jar，但它只会解压你本地仓库中的版本，而不是你刚刚打包的那个。

至于您的“更一般”的问题，jar 插件有[excludes](http://maven.apache.org/plugins/maven-jar-plugin/usage.html)标记。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2011-07-13T08:26:01.983

如果有人感兴趣，我找到了这个解决方案。我有完全相同的问题。

```
 <build>
            <plugins>
                <plugin>
                    <groupId>org.apache.maven.plugins</groupId>
                    <artifactId>maven-war-plugin</artifactId>
                    <configuration>
                        <packagingExcludes>WEB-INF/lib/MYPACKAGE_TO_EXCLUDE.jar</packagingExcludes>
                    </configuration>
                </plugin>
                <plugin>
                    <groupId>org.apache.maven.plugins</groupId>
                    <artifactId>maven-dependency-plugin</artifactId>
                    <executions>
                        <execution>
                            <id>unpack-MYPACKAGE_TO_EXCLUDE</id>
                            <phase>compile</phase>
                            <goals>
                                <goal>unpack</goal>
                            </goals>
                            <configuration>
                                <artifactItems>
                                    <artifactItem>
                                        <groupId>${project.groupId}</groupId>
                                        <artifactId>MYPACKAGE_TO_EXCLUDE</artifactId>
                                        <version>${project.version}</version>
                                        <type>jar</type>
                                        <outputDirectory>${project.build.directory}/classes
                                </outputDirectory>
                                    </artifactItem>
                                </artifactItems>
                            </configuration>
                        </execution>
                    </executions>
                </plugin>
            </plugins>
        </build> 
```

# jquery - jQuery手风琴和IE7的分层问题

> ID：634949
> 
> 赞同：1
> 
> 时间：2009-03-11T15:04:50.253
> 
> 标签：jquery, html, css, jquery-plugins, accordion

我对 jQuery 手风琴插件和 IE7 有一个奇怪的问题（也许更早，还没有在那里测试过）。我正在使用使用 ThemeRoller 构建的自定义 jQuery UI 主题。我对其进行了一些调整以调整颜色、边距和边框。手风琴位于 DIV 内，而 DIV 又嵌套在我的主要内容中。简化的标记和 CSS 如下。基本上，内容是一个被边框包围的居中框。菜单在框的顶部下方偏移并浮动在左边缘上。

问题是，在 IE7 中，一旦我将鼠标悬停在菜单上，来自底层`main`DIV 的边框就会通过手风琴显示。这在 FF 或 Safari 中不会发生。问题是为什么，因为默认的手风琴 CSS 将 z-index 设置为 1？不应该所有这些元素都显示在它们后面的 DOM 元素的顶部吗？为什么只在悬停时？

我已经解决了这个问题，并将解决方案作为答案发布。

```
<div id="main" style="position: relative;">
    <div id="main-menu">
        <ul id="navigation" class="ui-accordion">
            <li>
                <div class="ui-accordion-header">
                </div>
                <div class="ui-accordion-content">
                </div>
            </li>
        </ul>
    </div>
</div> 
```

CSS

```
#main
{
    clear: both;
    padding: 30px 30px 30px 30px;
    background-color: #fff;
    border: solid 1px #669933;
    margin-bottom: 30px;
    min-height: 500px;
    height: auto !important;
    height: 500px;
    _height: 1px; /* only IE6 applies CSS properties starting with an underscrore */
}
#main-menu
{
    position: absolute;
    top: 1em;
    left: -1em;
}

#navigation
{
    width: 10em;
}

/*UI accordion*/
.ui-accordion {
    /*resets*/margin: 0; padding: 0; border: 0; outline: 0; line-height: 1.5; text-decoration: none; font-size: 100%; list-style: none;
    font-family: Verdana, Arial, sans-serif;
    font-size: 1.1em;
/* additions from default */
    background-color: #ffffff;
    color: #333333;
    border: solid 1px #336600;
    text-indent: 0.2em;
    z-index: 1;
} 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-03-11T15:07:48.530

在尝试在各种 .ui-accordion 类上显式设置 z-index 之后，我决定备份一个级别。事实证明，在`main-menu`DIV 上设置 z-index（为 1）可以解决 IE7 中的问题。请注意，主 .ui-accordion 类上的 z-index 始终存在。将 ui-accordion 类应用到`main-menu`div 会破坏布局，我认为将 z-index 简单地添加到主菜单也更容易，而不是尝试重新设置它的样式以便与应用的 ui-accordion 类一起使用。

# c++ - 适合初学者的 C++ 开源项目？

> ID：634951
> 
> 赞同：9
> 
> 时间：2009-03-11T15:05:05.103
> 
> 标签：c++, open-source

我是初学者 C++ 程序员。我想在系统和驱动程序编程方面继续我的职业生涯。你能建议我一个开源项目来提高我在低级开发方面的技能吗？

我正在寻找一个具有以下特点的项目：
- 基于 C\C++ 语言
- 一个具有少量代码的小项目，然而
- 设计了基于 UNIX 的系统

你知道这样的事情吗？

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2009-03-11T15:06:42.603

检查代码项目页面的谷歌夏天！这些都是开源的，其中许多是基于 C/C++ 的。每个项目都列出了针对局外人/初学者的想法。

这是去年的页面：[http](http://code.google.com/soc/2008/) ://code.google.com/soc/2008/ Google 尚未决定今年参与的项目，但此信息将在接下来的几周内提供（在2009 年 3 月）以及新的想法列表。

如果您是学院/大学的学生，您会很幸运，甚至可以通过 GSOC 项目获得指导。但即使没有，他们也会非常重视你能做出的任何贡献。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2010-05-10T19:18:12.830

始终致力于您实际使用和关心的开源项目。如果您自己不使用该项目，为什么要做好它？

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2010-05-10T19:15:58.300

Minix 3 怎么样？这是学习低级编程的好方法。

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2010-05-10T19:21:20.477

开始您自己的开源项目。

将其托管在 Google Code 上

让某事做得很棒或让其他事更容易使用

使用它并迭代它

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2010-05-10T19:52:04.640

与 Sourceforge Help Wanted 一样，有一个名为 OpenHatch.org 的网站列出了需要注意的开源项目中的错误以及潜在的指导者。特别是，您可以浏览可能是初学者开始的好地方的一口大小的错误[。](https://openhatch.org/search/?q=&toughness=bitesize&language=C%2B%2B)

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2009-03-11T15:10:00.553

您是否尝试过[sourceforge 的帮助](http://sourceforge.net/people/)？

编辑：作为个人建议，我不确定它是否符合您的要求，但[传输 bittorrent](http://trac.transmissionbt.com/ticket/7)客户端需要在 C 中实现 Kademlia DHT，这是相当低级的网络。

# model-view-controller - 在 MVC 中，放置授权码的正确位置在哪里？

> ID：634954
> 
> 赞同：5
> 
> 时间：2009-03-11T15:06:06.523
> 
> 标签：model-view-controller, oop

在 MVC 中，放置授权码的正确位置在哪里？
控制器？
该模型？
在视图中？

到处都是？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2009-03-11T15:14:46.203

我投票赞成把它放在有意义的地方。我的大部分授权内容都是通过使用 AuthorizeAttribute 装饰控制器操作（甚至是一些控制器）来处理的——或者从它派生的属性。在少数情况下——比如我的菜单——我将授权检查放在视图代码本身中，而不是在每个控制器中计算它并在 ViewData 中传递标志。在某些情况下，模型的某些方面仅适用于特定角色，在这些情况下，我使用可以获取当前用户和角色并在那里进行检查的方法来扩展模型。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-03-11T15:16:37.340

我认为授权是一个跨领域的问题。应该在一个地方 - 可以在需要的地方以声明方式应用的方面。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2009-03-11T15:45:40.453

控制器！

你的视图应该只处理用户界面和显示你的模型应该代表你系统中的数据。您的控制器应该处理系统工作方式的逻辑。

授权用户包括获取视图提供的凭据，根据模型中的某种授权列表检查它们，然后执行检查。

这是在控制器中完成的：从 View 获取用户凭据 if（与模型中的用户列表比较返回匹配）授权用户否则拒绝访问

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2009-03-11T15:09:57.153

如果您必须在 M、V 或 c 之间进行选择，C 是正确的位置。但是，我推荐一种架构，您的应用程序全部包含在库中，而 UI 只是一层薄薄的外衣。您最终从控制器调用堆栈，但代码不在控制器中。

在 MVC 中，Model 只是一个模型，或者是“哑数据对象”，如果你愿意的话。它旨在保持状态，而不应指示行为。View 是供用户交互的，也是“哑”的；视图处理 UI。控制器是行为所在的位置，或者在应用程序逻辑位于库中的情况下是行为的入口点。有道理？

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2009-03-11T15:10:28.353

模型。

控制器只是用于通过不同的方式进行切换。查看只是为了……查看。

所以你应该在模型层制作所有的授权码。理想情况下，一切都会正常工作。如果不是，那么控制器会将用户带到正确的登录框。

# java - 微软团队系统和 Java

> ID：634962
> 
> 赞同：3
> 
> 时间：2009-03-11T15:07:26.440
> 
> 标签：java, tfs

我们正在一家纯粹使用 MS 技术的公司开始一个用 Java 编写的项目。Microsoft Team System 用作源代码控制工具。一个问题是我们是否应该尝试将 Eclipse 与 MTS 集成（这在顶层是有意义的，因为公司仍然有一个单一的存储库）或者我们应该尝试设置另一个源代码控制工具 - 最有可能是 Subversion（这很有意义从开发人员的角度来看）？

有人试图将 Team System 与 Java 项目结合起来吗？这有什么意义吗？

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2009-03-11T15:13:54.880

您可以将 Team Foundation Server 与 Eclipse 与 Teamprise 一起使用。

至于它是否有意义，取决于环境。如果您是众多项目之一，恰好是 Java，那么重新发明轮子并实施 SVN 是没有意义的，除非业务部门在 Java 项目和 MS 项目之间做出了清晰的划分……并意识到他们有获取项目指标的两个地方，这可能很讨厌。

我个人会对 TFS 投票，因为已经有对 TFS 的投资。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-03-11T18:38:05.560

我从事一个使用 eclipse 和 teamprise 将 TFS 与 java 结合使用的项目。虽然体验并不完美，但它确实运作良好。

由于您的公司已经对 TFS 进行了投资，如果您和您的团队对 TFS 作为版本控制系统感到满意，我会坚持下去。但是，如果您对 subversion 而不是 TFS 感到满意，那么我说只需切换到 subverison，您就不会回头。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2009-03-12T02:58:25.170

我的团队处于类似情况...我们公司最近对 TFS 进行了标准化以进行源代码控制，并且我们是一个 Java 团队（我公司中的许多其他团队都是 Microsoft...因此决定使用 TFS）。我们正在从 VSS 迁移，所以我们实际上很高兴获得更现代的系统（尽管我更喜欢 SVN）。

我们使用[IntelliJ IDEA](http://www.jetbrains.com/idea/)，并且在 8.1 版本中，它们现在已经集成了 TFS 支持。到目前为止，它似乎运作良好。我们还将[Hudson](http://hudson-ci.org/)用于我们的持续集成服务器，并且为此也有一个不错的 TFS 插件。从我们的 Ant 脚本中，当我们需要访问 TFS 时，我们正在使用免费的[Teamprise Ant 任务。](http://www.teamprise.com/products/ant/)

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2009-03-13T20:51:51.793

如果您最终使用 tfs（但不是 teamprise）可能会有所帮助的一件事是 Team Foundation Power Tools 2008 添加了 Window Explorer 扩展支持（尽管我希望它具有“获取特定版本”作为菜单选项）

[http://msdn.microsoft.com/en-us/teamsystem/bb980963.aspx](http://msdn.microsoft.com/en-us/teamsystem/bb980963.aspx)

从上面的链接...“Windows Shell 扩展 - 允许在 Windows 资源管理器中进行核心版本控制操作，而无需使用团队资源管理器。”

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2012-07-05T13:45:45.777

它现在是免费的（2012 年 3 月之后）。

[微软.com；下载](http://www.microsoft.com/en-ca/download/details.aspx?id=25125#overview)

# java - 一个很好的 C/C++/Java/C# 递归解决方案库

> ID：634963
> 
> 赞同：11
> 
> 时间：2009-03-11T15:07:31.370
> 
> 标签：java, c++, c, recursion

我看到了[这个问题](https://stackoverflow.com/questions/23860/what-is-the-best-way-to-learn-recursion)，但那里的答案不是很相关。一个朋友需要一组已解决的递归问题来帮助他学习**明天**的考试。

他从理论上了解了这个问题，但在掌握如何实际解决递归问题时遇到了问题。您是否知道网络上可用的已解决递归问题的良好来源（最好是用 C 语言，但也可以是 C 风格的语言）？

注意 - 函数式语言中的示例在这里没有多大帮助。我的朋友正在参加明天通过考试的学习竞赛，我敢肯定，此时切换语言只会让他感到困惑（这可能在其他压力较小的时候具有教育意义）。

* * *

## 回答 #1

> 赞同：9
> 
> 时间：2009-03-11T15:11:55.633

学习递归的最好方法之一是获得一些函数式编程语言的经验，例如 Haskell、Lisp 或 Scheme。

所以寻找递归问题可以简化为寻找一些与函数式编程语言相关的问题和答案。这是一个示例[99 lisp 问题](http://www.ic.unicamp.br/~meidanis/courses/mc336/2006s2/funcional/L-99_Ninety-Nine_Lisp_Problems.html)。

学习 Scheme 或 Lisp 真的只需要 5 分钟，因此您可以立即开始使用示例，以便明天进行您提到的测试。

学习递归的另一个好方法是在涉及归纳的数学证明中进行一些练习。

* * *

**与递归相关的关键概念：**

使用递归，您不需要知道如何解决问题。你只需要知道两件事。1）如何解决问题的最小实例，以及 2）如何将其分解成更小的部分。

同样，您只需要记住您需要：1）基本案例和2）递归案例。

基本案例处理 1 个您想要使用最小输入执行的操作的单个实例。

递归案例将问题分解为子问题。最终，这个子问题将简化为基本情况。

例子：

```
//1+...+n = n*n(+1)/2 = sumAll(n):

int sumAll(int x)
{
  if(x == 0) //base case
    return 0; 
  else
    return sumAll(x-1) + x; //recursive case
} 
```

重要的是要了解基本情况并不难弄清楚。它必须存在。这是 x> 0 的等效解决方案：

```
//1+...+n = n*n(+1)/2 = sumAll(n):
int sumAll(int x)
{
  if(x == 1) //base case
    return 1; 
  else
    return sumAll(x-1) + x; //recursive case
} 
```

* * *

## 回答 #2

> 赞同：5
> 
> 时间：2009-03-11T15:37:18.053

[这篇文章](http://en.wikipedia.org/wiki/Recursion_(computer_science))讲解递归，并有一些简单的 C 例子，用于遍历链表和二叉树

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2009-03-11T15:26:31.090

这听起来像是一个非常蹩脚的答案，但递归是一种范式，对于初学者来说，一开始通常很难掌握。你的朋友需要一天以上的时间思考这个问题才能牢牢掌握这个概念。

您可能想让他仔细阅读[Project Euler](http://projecteuler.net)以了解潜在的研究方向。

* * *

## 回答 #4

> 赞同：2
> 
> 时间：2009-03-11T15:34:15.783

我认为 Haskell 的语法非常适合递归思考，因为模式匹配结构使得基本情况和递归情况如此明显。将其翻译成另一种语言就相当简单了。

```
sumAll [] = 0
sumAll (x:xs) = x + sumAll xs 
```

要理解这一点，您实际上只需要知道

*   [] 表示一个空列表，
*   (x:xs) 将列表拆分为头部 (x) 和尾部 (xs)

你不需要学习所有的 Haskell（让我们面对它，很难）——但是做一些基础知识肯定会帮助你在递归中思考。

* * *

## 回答 #5

> 赞同：2
> 
> 时间：2012-03-27T09:20:26.380

在 c /c++ 语言中，函数可以调用自身，这种情况称为递归。递归主要有两种情况：

1.  基本情况。
2.  递归案例。

我们有一些递归类别，例如...

1.  线性递归
2.  二进制递归
3.  嵌套递归
4.  相互递归
5.  尾递归

这里举个例子来讨论递归......

```
// a recursive program to calculate NcR  //
#include <stdio.h> 
int ncr(int x,int y)
{
    if(y>x)
    {
        printf("!sorry,the operation can't processed.");
        getch();
        exit(1);
    }
    else if(y==0 ||y==x)   //base case
    {
        return(1);
    }
    else
    {
        return(ncr(x-1,y-1)+ncr(x-1,y));  //recursive case
    }
} 
```

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2009-03-11T16:18:02.807

阅读 SICP（计算机程序的结构和解释）

* * *

## 回答 #7

> 赞同：0
> 
> 时间：2010-04-06T10:14:49.140

```
#include<iostream>
using namesspace std;
int E(int x);
int main()
{
    int x;
    cout << E(x) << endl;
    return 0;
}

int E(int x)
{
    return x ? (x % 10 + E(x/10)) : 0;
} 
```

# python - svg图表使用python

> ID：634964
> 
> 赞同：21
> 
> 时间：2009-03-11T15:07:39.093
> 
> 标签：python, svg, diagram

我正在寻找一个在 python 中生成 svg 图的库（我从 sql 数据库中获取数据）。我找到了[python-gd](http://newcenturycomputers.net/projects/gdmodule.html)，但它没有太多文档，最后一次更新是在 2005 年，所以我想知道是否还有其他适用于此目的的库。

我主要考虑简单的折线图，如下[所示](https://edynblog.files.wordpress.com/2007/07/line-graph-days-on-market.jpg)： ![示例折线图](https://edynblog.files.wordpress.com/2007/07/line-graph-days-on-market.jpg "上市天数")

* * *

## 回答 #1

> 赞同：11
> 
> 时间：2009-03-11T15:16:51.410

尝试使用[matplotlib](http://matplotlib.sourceforge.net/)。您可以使用 SVG[后端](http://matplotlib.sourceforge.net/faq/installing_faq.html#what-is-a-backend)对其进行配置。

* * *

## 回答 #2

> 赞同：9
> 
> 时间：2009-03-11T15:16:53.190

[PyChart](https://pypi.org/project/PyChart) *“是一个 Python 库，用于创建高质量的封装 Postscript、PDF、PNG 或**SVG**图表。”*

* * *

## 回答 #3

> 赞同：9
> 
> 时间：2009-03-11T15:36:41.130

[pyCairo](http://cairographics.org/pycairo/)是一个值得一看的选项。

* * *

## 回答 #4

> 赞同：9
> 
> 时间：2009-03-11T15:50:55.573

当您正在寻找简单的线条图形时，[CairoPlot](http://linil.wordpress.com/2008/09/16/cairoplot-11/)可能会满足您的需求，因为它可以生成开箱即用的 svg 输出文件。看看[这个](http://linil.files.wordpress.com/2008/06/cairoplot_dotlineplot.png)。

![CairoPlot - 点线图](https://linil.files.wordpress.com/2008/06/cairoplot_dotlineplot.png?w=450h=300)

此示例图像仅显示了它的一些功能。[使用启动板上](http://launchpad.net/cairoplot)提供的主干版本，您将能够添加图例框并添加轴标题。

除此之外，使用主干版本，可以生成：

*   点线图（我相信你需要的）
*   散点图
*   饼图/甜甜圈图
*   水平/垂直条形图
*   甘特图

* * *

## 回答 #5

> 赞同：7
> 
> 时间：2009-03-11T15:15:47.560

这是 Python 中的通用 SVG 库：[pySVG](http://codeboje.de/pysvg/)。

* * *

## 回答 #6

> 赞同：7
> 
> 时间：2009-03-11T16:16:54.603

您可以使用[Graphviz](http://www.graphviz.org/)生成 SVG 格式的图表。Graphviz 有 Python 绑定，例如[pydot](http://code.google.com/p/pydot/) ——Graphviz 的 Dot 语言的 Python 接口。

* * *

## 回答 #7

> 赞同：4
> 
> 时间：2012-05-19T03:27:07.307

考虑`svgwrite` [https://pypi.org/project/svgwrite](https://pypi.org/project/svgwrite)，一个用于创建 SVG 绘图的 Python 包。

* * *

## 回答 #8

> 赞同：3
> 
> 时间：2010-05-30T01:36:32.133

svgfig 值得一看：

[http://code.google.com/p/svgfig/](http://code.google.com/p/svgfig/)

* * *

## 回答 #9

> 赞同：1
> 
> 时间：2011-09-14T16:36:11.987

与 SVG 绘图不完全相关，但在寻找相同的东西时，我发现了一个很好的来源，收集了仔细收集的有用信息来回答你的问题： [http ://wiki.python.org/moin/NumericAndScientific/Plotting](http://wiki.python.org/moin/NumericAndScientific/Plotting)

* * *

## 回答 #10

> 赞同：0
> 
> 时间：2011-10-20T06:11:43.030

我已尝试整理可用图表库的列表（这是一项正在进行的工作，我不断更新列表）：[http ://blizzardzblogs.blogspot.com/2010/12/data-visualization-charts-and.html](http://blizzardzblogs.blogspot.com/2010/12/data-visualization-charts-and.html)

我觉得 protovis 会为你完成这项工作。它的

*   轻的，
*   生成 svg（可以轻松导出）和
*   是 javascript

所以没什么可学的:)

* * *

## 回答 #11

> 赞同：0
> 
> 时间：2018-11-15T10:29:56.280

**2018 年更新：**

Plotly ( [https://github.com/plotly/plotly.py](https://github.com/plotly/plotly.py) / [https://plot.ly/d3-js-for-python-and-pandas-charts/](https://plot.ly/d3-js-for-python-and-pandas-charts/) ) 可能是最通用的解决方案。它是在 MIT 许可下分发的（免费使用和重用），尽管它包含可能与某些 CMS 不兼容的功能，因为它依赖于 JS，因此具有更严格的安全问题，尽管也可以选择将图表导出为纯 SVG。

Pygal ( [https://github.com/Kozea/pygal](https://github.com/Kozea/pygal) / [http://pygal.org](http://pygal.org) ) 更简单，仅依赖于 svg 标准。因此，它的结果在更受限制的 CMS 系统下更具可重用性。它是在 GNU 许可下分发的。

# sql-server - SQL Server：如何将 CTE 递归限制为刚刚递归添加的行？

> ID：634971
> 
> 赞同：12
> 
> 时间：2009-03-11T15:08:33.787
> 
> 标签：sql-server, common-table-expression

## 更简单的例子

让我们尝试一个更简单的示例，这样人们就可以围绕这些概念进行思考，并有一个可以复制并粘贴到 SQL Query Analizer 中的实际示例：

想象一个具有层次结构的**节点**表：

```
A
 - B
    - C 
```

我们可以在 Query Analizer 中开始测试：

```
CREATE TABLE ##Nodes
(
 NodeID varchar(50) PRIMARY KEY NOT NULL,
 ParentNodeID varchar(50) NULL
)

INSERT INTO ##Nodes (NodeID, ParentNodeID) VALUES ('A', null)
INSERT INTO ##Nodes (NodeID, ParentNodeID) VALUES ('B', 'A')
INSERT INTO ##Nodes (NodeID, ParentNodeID) VALUES ('C', 'B') 
```

**期望的输出：**

```
ParentNodeID    NodeID    GenerationsRemoved
============    ======    ==================
NULL            A         1
NULL            B         2
NULL            C         3
A               B         1
A               C         2
B               C         1 
```

现在建议的 CTE 表达式，它的输出不正确：

```
WITH NodeChildren AS
(
   --initialization
   SELECT ParentNodeID, NodeID, 1 AS GenerationsRemoved
   FROM ##Nodes
   WHERE ParentNodeID IS NULL

   UNION ALL

   --recursive execution
   SELECT P.ParentNodeID, N.NodeID, P.GenerationsRemoved + 1
   FROM NodeChildren AS P
      INNER JOIN ##Nodes AS N
      ON P.NodeID = N.ParentNodeID
)
SELECT ParentNodeID, NodeID, GenerationsRemoved
FROM NodeChildren 
```

**实际输出**：

```
ParentNodeID    NodeID    GenerationsRemoved
============    ======    ==================
NULL            A         1
NULL            B         2
NULL            C         3 
```

**注意：**如果 SQL Server 2005† CTE 无法完成我在 2000 年之前所做的事情‡，那很好，这就是答案。给出“不可能”作为答案的人将赢得赏金。但我会等几天以确保每个人都同意这是不可能的，因为我无法解决我的问题而无法挽回地给予 250 名声望。

**吹毛求疵的角落**

†不是 2008 年

‡无需诉诸 UDF*，这是已有的解决方案

*除非您可以在原始问题中看到提高 UDF 性能的方法

* * *

## 原始问题

我有一个节点表，每个节点都有一个指向另一个节点（或 null）的父节点。

举例说明：

```
1 My Computer
    2 Drive C
         4 Users
         5 Program Files
         7 Windows
             8 System32
    3 Drive D
         6 mp3 
```

我想要一个返回所有父子关系的表，以及它们之间的代数

对于所有直接父关系：

```
ParentNodeID  ChildNodeID  GenerationsRemoved
============  ===========  ===================
(null)        1            1
1             2            1
2             4            1
2             5            1
2             7            1
1             3            1
3             6            1
7             8            1 
```

但是还有祖父母关系：

```
ParentNodeID  ChildNodeID  GenerationsRemoved
============  ===========  ===================
(null)        2            2
(null)        3            2
1             4            2
1             5            2
1             7            2
1             6            2
2             8            2 
```

还有曾祖父母的关系：

```
ParentNodeID  ChildNodeID  GenerationsRemoved
============  ===========  ===================
(null)        4            3
(null)        5            3
(null)        7            3
(null)        6            3
1             8            3 
```

所以我可以弄清楚基本的 CTE 初始化：

```
WITH (NodeChildren) AS
{
   --initialization
   SELECT ParentNodeID, NodeID AS ChildNodeID, 1 AS GenerationsRemoved
   FROM Nodes
} 
```

现在的问题是递归部分。当然，显而易见的答案是行不通的：

```
WITH (NodeChildren) AS
{
   --initialization
   SELECT ParentNodeID, ChildNodeID, 1 AS GenerationsRemoved
   FROM Nodes

   UNION ALL

   --recursive execution
   SELECT parents.ParentNodeID, children.NodeID, parents.Generations+1
   FROM NodeChildren parents
    INNER JOIN NodeParents children
    ON parents.NodeID = children.ParentNodeID
} 

Msg 253, Level 16, State 1, Line 1
Recursive member of a common table expression 'NodeChildren' has multiple recursive references. 
```

生成整个递归列表所需的所有信息都存在于初始 CTE 表中。但如果不允许这样做，我会尝试：

```
WITH (NodeChildren) AS
{
   --initialization
   SELECT ParentNodeID, NodeID, 1 AS GenerationsRemoved
   FROM Nodes

   UNION ALL

   --recursive execution
   SELECT parents.ParentNodeID, Nodes.NodeID, parents.Generations+1
   FROM NodeChildren parents
    INNER JOIN Nodes
    ON parents.NodeID = nodes.ParentNodeID
} 
```

但这失败了，因为它不仅加入了递归元素，而且一遍又一遍地递归地添加相同的行：

```
Msg 530, Level 16, State 1, Line 1
The statement terminated. The maximum recursion 100 has been exhausted before statement completion. 
```

在 SQL Server 2000 中，我使用用户定义函数 (UDF) 模拟了 CTE：

```
CREATE FUNCTION [dbo].[fn_NodeChildren] ()
RETURNS @Result TABLE (
    ParentNodeID int NULL,
    ChildNodeID int NULL,
    Generations int NOT NULL) 
AS  
/*This UDF returns all "ParentNode" - "Child Node" combinations
    ...even multiple levels separated
BEGIN 
    DECLARE @Generations int
    SET @Generations = 1

    --Insert into the Return table all "Self" entries
    INSERT INTO @Result
    SELECT ParentNodeID, NodeID, @Generations
    FROM Nodes
    WHILE @@rowcount > 0 
    BEGIN
        SET @Generations = @Generations + 1
        --Add to the Children table: 
        --  children of all nodes just added 
        -- (i.e. Where @Result.Generation = CurrentGeneration-1)
        INSERT @Result
        SELECT CurrentParents.ParentNodeID, Nodes.NodeID, @Generations
        FROM Nodes
            INNER JOIN @Result CurrentParents
            ON Nodes.ParentNodeID = CurrentParents.ChildNodeID
        WHERE CurrentParents.Generations = @Generations - 1
    END
    RETURN
END 
```

阻止它爆炸的魔法是限制 where 子句：WHERE CurrentParents.Generations - @Generations-1

如何防止递归 CTE 永远递归？

* * *

## 回答 #1

> 赞同：20
> 
> 时间：2009-03-18T21:18:14.687

试试这个：

```
WITH Nodes AS
(
   --initialization
   SELECT ParentNodeID, NodeID, 1 AS GenerationsRemoved
   FROM ##Nodes

   UNION ALL

   ----recursive execution
   SELECT P.ParentNodeID, N.NodeID, P.GenerationsRemoved + 1
   FROM Nodes AS P
      INNER JOIN ##Nodes AS N
      ON P.NodeID = N.ParentNodeID
   WHERE P.GenerationsRemoved <= 10

)
SELECT ParentNodeID, NodeID, GenerationsRemoved
FROM Nodes
ORDER BY ParentNodeID, NodeID, GenerationsRemoved 
```

基本上从初始化查询中删除“只显示绝对父母”；这样，它会生成从它们中的每一个开始并从那里下降的结果。我还在“WHERE P.GenerationsRemoved <= 10”中添加了一个无限递归捕获（将 10 替换为不超过 100 的任何数字以满足您的需要）。然后添加排序，使其看起来像您想要的结果。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-03-11T15:18:02.860

旁白：你有 SQL Server 2008 吗？这可能适合[`hierarchyid`数据类型](http://msdn.microsoft.com/en-us/library/bb677212.aspx)。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-03-12T12:35:08.640

如果我理解您的意图，您可以通过执行以下操作来获得结果：

```
DECLARE @StartID INT;
SET @StartID = 1;
WITH CTE (ChildNodeID, ParentNodeID, [Level]) AS
(
  SELECT  t1.ChildNodeID, 
          t1.ParentNodeID, 
          0
  FROM tblNodes AS t1
  WHERE ChildNodeID = @StartID
  UNION ALL
  SELECT  t1.ChildNodeID, 
          t1.ParentNodeID, 
          t2.[Level]+1
  FROM tblNodes AS t1
    INNER JOIN CTE AS t2 ON t1.ParentNodeID = t2.ChildNodeID    
)
SELECT t1.ChildNodeID, t2.ChildNodeID, t1.[Level]- t2.[Level] AS GenerationsDiff
FROM CTE AS t1
  CROSS APPLY CTE t2 
```

这将返回所有节点之间的代差，您可以根据需要对其进行修改。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2009-03-13T20:39:25.583

好吧，您的答案并不那么明显:-)

```
WITH (NodeChildren) AS
{
   --initialization
   SELECT ParentNodeID, ChildNodeID, 1 AS GenerationsRemoved
   FROM Nodes 
```

这部分被称为递归 CTE 的“锚”部分——但它实际上应该只从你的表中选择一个或几行——这会选择所有内容！

我想您在这里缺少的只是一个合适的 WHERE 子句：

```
WITH (NodeChildren) AS
{
   --initialization
   SELECT ParentNodeID, ChildNodeID, 1 AS GenerationsRemoved
   FROM Nodes
   **WHERE ParentNodeID IS NULL** 
```

但是，恐怕您要求不仅具有“直”层次结构，而且还具有祖父母-孩子行，可能并不容易满足....通常递归CTE只会显示一个级别及其直接下属（当然，在层次结构中）-它通常不会跳过一个，两个甚至更多级别。

希望这个对你有帮助。

马克

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2009-03-25T10:33:35.467

问题在于 Sql Server 默认递归限制 (100)。如果您在顶部尝试您的示例，并删除了锚限制（也添加了 Order By）：

```
WITH NodeChildren AS
(
   --initialization
   SELECT ParentNodeID, NodeID, 1 AS GenerationsRemoved
   FROM Nodes

   UNION ALL

   --recursive execution
   SELECT P.ParentNodeID, N.NodeID, P.GenerationsRemoved + 1
   FROM NodeChildren AS P
      inner JOIN Nodes AS N
      ON P.NodeID = N.ParentNodeID
)
SELECT ParentNodeID, NodeID, GenerationsRemoved
FROM NodeChildren
ORDER BY ParentNodeID ASC 
```

这会产生预期的结果。您面临的问题是您将重复超过 100 次的大量行，这是默认限制。这可以通过`option (max recursion x)`在查询后添加来更改，其中 x 是 1 到 32767 之间的数字。x 也可以设置为 0，这不会设置任何限制，但很快就会对服务器性能产生非常不利的影响。显然，随着 Nodes 中行数的增加，递归数会迅速增加，除非表中的行数已知上限，否则我会避免这种方法。为了完整起见，最终查询应如下所示：

```
 WITH NodeChildren AS
    (
       --initialization
       SELECT ParentNodeID, NodeID, 1 AS GenerationsRemoved
       FROM Nodes

       UNION ALL

       --recursive execution
       SELECT P.ParentNodeID, N.NodeID, P.GenerationsRemoved + 1
       FROM NodeChildren AS P
          inner JOIN Nodes AS N
          ON P.NodeID = N.ParentNodeID
    )
    SELECT * 
    FROM NodeChildren
    ORDER BY ParentNodeID
    OPTION (MAXRECURSION 32767) 
```

可以向下调整 32767 以适应您的情况

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2009-03-25T11:10:02.960

您是否尝试过在 CTE 中构建路径并使用它来识别祖先？

然后，您可以从祖先节点深度中减去后代节点深度来计算 GenerationsRemoved 列，如下所示......

```
DECLARE @Nodes TABLE
(
    NodeId varchar(50) PRIMARY KEY NOT NULL,
    ParentNodeId varchar(50) NULL
)

INSERT INTO @Nodes (NodeId, ParentNodeId) VALUES ('A', NULL)
INSERT INTO @Nodes (NodeId, ParentNodeId) VALUES ('B', 'A')
INSERT INTO @Nodes (NodeId, ParentNodeId) VALUES ('C', 'B')

DECLARE @Hierarchy TABLE
(
    NodeId varchar(50) PRIMARY KEY NOT NULL,
    ParentNodeId varchar(50) NULL,
    Depth int NOT NULL,
    [Path] varchar(2000) NOT NULL
)

WITH Hierarchy AS
(
    --initialization
    SELECT NodeId, ParentNodeId, 0 AS Depth, CONVERT(varchar(2000), NodeId) AS [Path]
    FROM @Nodes
    WHERE ParentNodeId IS NULL

    UNION ALL

    --recursive execution
    SELECT n.NodeId, n.ParentNodeId, p.Depth + 1, CONVERT(varchar(2000), p.[Path] + '/' + n.NodeId)
    FROM Hierarchy AS p
    INNER JOIN @Nodes AS n
    ON p.NodeId = n.ParentNodeId
)
INSERT INTO @Hierarchy
SELECT *
FROM Hierarchy

SELECT parent.NodeId AS AncestorNodeId, child.NodeId AS DescendantNodeId, child.Depth - parent.Depth AS GenerationsRemoved
FROM @Hierarchy AS parent
INNER JOIN @Hierarchy AS child
ON child.[Path] LIKE parent.[Path] + '/%' 
```

* * *

## 回答 #7

> 赞同：0
> 
> 时间：2013-08-28T22:25:33.840

这打破了强加给 Chris Shaffer 答案的递归限制。

我创建一个带循环的表：

```
CREATE TABLE ##Nodes
(
   NodeID varchar(50) PRIMARY KEY NOT NULL,
   ParentNodeID varchar(50) NULL
)

INSERT INTO ##Nodes (NodeID, ParentNodeID) VALUES ('A', 'C');
INSERT INTO ##Nodes (NodeID, ParentNodeID) VALUES ('B', 'A');
INSERT INTO ##Nodes (NodeID, ParentNodeID) VALUES ('C', 'B'); 
```

在存在潜在循环的情况下（即 ParentNodeId IS NOT NULL），删除的生成从 2 开始。然后我们可以通过检查 (P.ParentNodeID == N.NodeID) 来标识循环，我们只是不添加它. 之后，我们附加省略的生成 remove = 1。

```
WITH ParentNodes AS
(
   --initialization
   SELECT ParentNodeID, NodeID, 1 AS GenerationsRemoved
   FROM ##Nodes
   WHERE ParentNodeID IS NULL

   UNION ALL

   SELECT P.ParentNodeID, N.NodeID, 2 AS GenerationsRemoved
   FROM ##Nodes N
   JOIN ##Nodes P ON N.ParentNodeID=P.NodeID
   WHERE P.ParentNodeID IS NOT NULL

   UNION ALL

   ----recursive execution
   SELECT P.ParentNodeID, N.NodeID, P.GenerationsRemoved + 1
   FROM ParentNodes AS P
     INNER JOIN ##Nodes AS N
     ON P.NodeID = N.ParentNodeID
   WHERE P.ParentNodeID IS NULL OR P.ParentNodeID <> N.NodeID

),
Nodes AS (
   SELECT ParentNodeID, NodeID, 1 AS GenerationsRemoved 
   FROM ##Nodes 
   WHERE ParentNodeID IS NOT NULL

   UNION ALL

   SELECT ParentNodeID, NodeID, GenerationsRemoved FROM ParentNodes
)
SELECT ParentNodeID, NodeID, GenerationsRemoved
FROM Nodes
ORDER BY ParentNodeID, NodeID, GenerationsRemoved 
```

* * *

## 回答 #8

> 赞同：0
> 
> 时间：2015-12-04T22:12:45.280

```
with cte as
(
    select a=65, L=1
    union all
    select a+1, L=L+1
    from cte
    where L<=100
)
select 
IsRecursion=Case When L>1 then 'Recursion' else 'Not Recursion' end,
AsciiValue=a,
AsciiCharacter=char(a)
from cte 
```

1.  创建一个包含当前级别的列。
2.  检查级别是否>1

我在这里的示例显示了一个递归 CTE，它在 100 个级别（最大值）后停止递归。作为奖励，它显示了一堆 ASCII 字符和相应的数值。

# .net - 在同一页面中的另一个用户控件引发的事件上填充用户控件

> ID：634974
> 
> 赞同：0
> 
> 时间：2009-03-11T15:09:12.660
> 
> 标签：.net, asp.net, events, user-controls, web-parts

在 webpart 中，我加载了两个用户控件。我希望能够在另一个控件中触发事件时填充其中一个控件，必须在控件之间传递一个参数。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-03-11T15:38:13.450

您可以让您的 Web 部件将这两个控件连接在一起，因此假设您的控件是生产者和消费者。

```
void on_Load()
{
   producer.CustomEvent+=new EventHandler(consumer.HandleCustomEvent);
} 
```

这是更简单的解决方案之一，但它可能很脆弱。

# excel - 用VS2008和Office2007将Excel转PDF

> ID：634990
> 
> 赞同：4
> 
> 时间：2009-03-11T15:13:02.700
> 
> 标签：excel, pdf, interop

我正在尝试使用 Interop.Excell 将 Excel 工作簿另存为 PDF 文件。我正在使用 VS2008 和 Office2007，并且已经从 Microsoft 下载并安装了 SaveAsPDFandXPS.exe。这使我能够使用以下代码将 Word 文档另存为 pdf： object frmt = Microsoft.Office.Interop.Word.WdSaveFormat.wdFormatPDF; wrd.ActiveDocument.SaveAs(ref dest, ref frmt, ref unknown, ref unknown,... 对于整个 Interop 来说非常酷的 excpet。

无论如何，我一直未能在 Interop.Excell 中为 Word.WdSaveFormat.wdFormatPDF 找到一个平行。Workbook.SaveAs 采用 Interop.Excel.XlFileFormat，但没有 pdf 格式的选项。有没有人这样做或在这方面有经验？

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2009-04-23T23:20:55.477

这个问题在这里得到了回答：

[**通过 API 将文件另存为 PDF 所需的 Excel 2007 中 PDF 的 FileType 编号是多少？**](https://stackoverflow.com/questions/738829/what-is-the-filetype-number-for-pdf-in-excel-2007-that-is-needed-to-save-a-file-a)

您需要调用该[`Workbook.ExportAsFixedFormat`](http://msdn.microsoft.com/en-us/library/bb238907.aspx)方法：

```
ActiveWorkbook.ExportAsFixedFormat Type:=xlTypePDF 
    FileName:=“sales.pdf” 
    Quality:=xlQualityStandard 
    DisplayFileAfterPublish:=True 
```

应该优先使用此方法，`SaveAs`因为它还允许指定所有 PDF / XPS 选项。

注意：此方法已添加到 Excel 2007 的 Excel 对象模型中，并且需要安装用于 2007 Microsoft Office 程序（或 SP2）的[另存为 PDF 或 XPS 插件。](http://www.microsoft.com/downloads/details.aspx?FamilyID=4d951911-3e7e-4ae6-b059-a2e79ed87041)

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2011-10-13T20:29:50.343

根据 Microsoft 的说法，与 Workbook.SaveAs 一起使用以另存为 PDF 的常量是 57。

“这里没有列出 pdf 格式。但是它有 57 号。” 来自：http: [//msdn.microsoft.com/en-us/library/bb241279%28office.12%29.aspx](http://msdn.microsoft.com/en-us/library/bb241279%28office.12%29.aspx)

# eclipse - 共享项目时可以让 subclipse 创建文件夹结构吗？

> ID：634992
> 
> 赞同：2
> 
> 时间：2009-03-11T15:13:10.857
> 
> 标签：eclipse, svn, subclipse, directory-structure

当在 Eclipse 中并且您决定使用 subclipse 在 subversion 存储库中共享一个项目时，您能否让它以某种方式自动为该项目创建一个文件夹结构？

我想要的是为每个共享项目添加这种结构：

/Client/Project/branches /Client/Project/tags /Client/Project/trunk/EclipseProject

其中 Client 是客户端的名称，Project 是实际项目的名称，EclipseProject 是项目的名称，因为它存在于 Eclipse 中。在这个结构中可能有多个 EclipseProject，在这种情况下当然不必创建目录。

这可能与子剪辑有关还是我最好编写一个简单的shell脚本来做到这一点？我的第一个想法是做一个 shell 脚本，因为我不介意使用终端，但是我的一些同事真的不喜欢命令行界面，而是挖掘 Subclipse。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-03-12T14:01:32.270

据我所知，您不能轻易地扩展 Subclipse 以使其生成这样的结构。

实际上，Subclipse[对深层结构的 GUI 表示存在](http://subclipse.tigris.org/issues/show_bug.cgi?id=817)问题，仅在最新版本 1.4.7（2008 年 12 月 5 日）中修复，因此尚未提供任何“模板结构”；）他们试图表示*现有的*文件夹树对。

*自动*创建文件夹的唯一功能是“[创建任何缺少的中间文件夹](http://subclipse.tigris.org/issues/show_bug.cgi?id=644)”复选框到“分支/标记”对话框，以便在 mkdir/move/copy 命令期间将任何缺少的和需要的父目录作为事务的一部分。

就是这样。

# mysql - 为 mysql/模糊搜索实现 Levenshtein 距离？

> ID：634995
> 
> 赞同：48
> 
> 时间：2009-03-11T15:15:08.170
> 
> 标签：mysql, database, algorithm, search, levenshtein-distance

我希望能够在如下表中搜索 smith 以获得它在 1 个方差内的所有内容。

数据：

```
奥布莱恩
史密斯
多兰
斯穆斯
黄
斯莫斯
冈瑟
史密斯

```

我已经研究过使用 Levenshtein distance 有人知道如何用它来实现吗？

* * *

## 回答 #1

> 赞同：12
> 
> 时间：2009-03-13T11:17:17.667

为了使用 levenshtein 距离进行高效搜索，您需要一个高效的专用索引，例如[bk-tree](http://blog.notdot.net/2007/4/Damn-Cool-Algorithms-Part-1-BK-Trees)。不幸的是，我所知道的任何数据库系统，包括 MySQL，都没有实现 bk-tree 索引。如果您正在寻找全文搜索，而不是每行只有一个词，这会更加复杂。顺便说一句，我想不出任何方式可以以允许基于 levenshtein 距离进行搜索的方式进行全文索引。

* * *

## 回答 #2

> 赞同：8
> 
> 时间：2013-11-12T03:38:07.207

Levenshtein Distance函数有一个mysql UDF实现

[https://github.com/jmcejuela/Levenshtein-MySQL-UDF](https://github.com/jmcejuela/Levenshtein-MySQL-UDF)

它是用C实现的，比schnaader提到的“MySQL Levenshtein距离查询”有更好的性能

* * *

## 回答 #3

> 赞同：5
> 
> 时间：2009-03-13T11:48:34.707

可以在此处找到 damerau-levenshtein 距离的实现： [Damerau-Levenshtein algorithm: Levenshtein with transpositions](http://blog.lolyco.com/sean/2008/08/27/damerau-levenshtein-algorithm-levenshtein-with-transpositions/) 对纯 Levenshtein 距离的改进是考虑了字符的交换。我在 schnaader 链接的评论中找到了它，谢谢！

* * *

## 回答 #4

> 赞同：5
> 
> 时间：2014-08-03T19:21:33.917

上面为 levenshtein <= 1 给出的函数是不正确的——它给出了不正确的结果，例如“床”和“出价”。

我在第一个答案中修改了上面给出的“MySQL Levenshtein 距离查询”，以接受一个“限制”，这将加快一点速度。基本上，如果您只关心 Levenshtein <= 1，请将限制设置为“2”，如果它是 0 或 1，该函数将返回确切的 Levenshtein 距离；如果确切的 levenshtein 距离为 2 或更大，则为 2。

这个 mod 让它快了 15% 到 50% - 你的搜索词越长，优势就越大（因为算法可以更早地保释。）例如，在搜索 200,000 个词以找到距离 1 内的所有匹配词“咯咯”，原版在我的笔记本电脑上需要 3 分 47 秒，而“限制”版本需要 1 分 39 秒。当然，对于任何实时使用来说，这些都太慢了。

代码：

```
DELIMITER $$
CREATE FUNCTION levenshtein_limit_n( s1 VARCHAR(255), s2 VARCHAR(255), n INT) 
  RETURNS INT 
  DETERMINISTIC 
  BEGIN 
    DECLARE s1_len, s2_len, i, j, c, c_temp, cost, c_min INT; 
    DECLARE s1_char CHAR; 
    -- max strlen=255 
    DECLARE cv0, cv1 VARBINARY(256); 
    SET s1_len = CHAR_LENGTH(s1), s2_len = CHAR_LENGTH(s2), cv1 = 0x00, j = 1, i = 1, c = 0, c_min = 0; 
    IF s1 = s2 THEN 
      RETURN 0; 
    ELSEIF s1_len = 0 THEN 
      RETURN s2_len; 
    ELSEIF s2_len = 0 THEN 
      RETURN s1_len; 
    ELSE 
      WHILE j <= s2_len DO 
        SET cv1 = CONCAT(cv1, UNHEX(HEX(j))), j = j + 1; 
      END WHILE; 
      WHILE i <= s1_len and c_min < n DO -- if actual levenshtein dist >= limit, don't bother computing it
        SET s1_char = SUBSTRING(s1, i, 1), c = i, c_min = i, cv0 = UNHEX(HEX(i)), j = 1; 
        WHILE j <= s2_len DO 
          SET c = c + 1; 
          IF s1_char = SUBSTRING(s2, j, 1) THEN  
            SET cost = 0; ELSE SET cost = 1; 
          END IF; 
          SET c_temp = CONV(HEX(SUBSTRING(cv1, j, 1)), 16, 10) + cost; 
          IF c > c_temp THEN SET c = c_temp; END IF; 
            SET c_temp = CONV(HEX(SUBSTRING(cv1, j+1, 1)), 16, 10) + 1; 
            IF c > c_temp THEN  
              SET c = c_temp;  
            END IF; 
            SET cv0 = CONCAT(cv0, UNHEX(HEX(c))), j = j + 1;
            IF c < c_min THEN
              SET c_min = c;
            END IF; 
        END WHILE; 
        SET cv1 = cv0, i = i + 1; 
      END WHILE; 
    END IF;
    IF i <= s1_len THEN -- we didn't finish, limit exceeded    
      SET c = c_min; -- actual distance is >= c_min (i.e., the smallest value in the last computed row of the matrix) 
    END IF;
    RETURN c;
  END$$ 
```

* * *

## 回答 #5

> 赞同：3
> 
> 时间：2009-05-02T23:43:23.707

根据 Gonzalo Navarro 和 Ricardo Baeza-yates 的论文，我正在设置基于 Levenshtein 或 Damerau-Levenshtein（可能是后者）的搜索，以对索引文本进行多次搜索：[链接文本](http://citeseerx.ist.psu.edu/viewdoc/summary?doi=10.1.1.21.2633)

建立后缀数组后（[见维基百科](http://en.wikipedia.org/wiki/Suffix_array)），如果您对与搜索字符串最多有 k 个不匹配的字符串感兴趣，请将搜索字符串分解为 k+1 个；其中至少有一个必须完好无损。通过对后缀数组的二进制搜索找到子字符串，然后将距离函数应用于每个匹配片段周围的补丁。

* * *

## 回答 #6

> 赞同：3
> 
> 时间：2011-04-29T21:04:31.047

你可以使用这个功能

```
创建函数`levenshtein`（s1文本，s2文本）返回int（11）
    确定性
开始
    声明 s1_len、s2_len、i、j、c、c_temp、成本 INT；
    声明 s1_char CHAR；
    声明 cv0、cv1 文本；
    SET s1_len = CHAR_LENGTH(s1), s2_len = CHAR_LENGTH(s2), cv1 = 0x00, j = 1, i = 1, c = 0;
    如果 s1 = s2 那么
      返回 0；
    ELSEIF s1_len = 0 那么
      返回 s2_len;
    ELSEIF s2_len = 0 那么
      返回 s1_len;
    别的
      当 j <= s2_len 做
        SET cv1 = CONCAT(cv1, UNHEX(HEX(j))), j = j + 1;
      结束；
      当我 <= s1_len 做
        SET s1_char = SUBSTRING(s1, i, 1), c = i, cv0 = UNHEX(HEX(i)), j = 1;
        当 j <= s2_len 做
          设置 c = c + 1;
          如果 s1_char = SUBSTRING(s2, j, 1) 那么  
            设置成本 = 0；其他设置成本 = 1；
          万一;
          SET c_temp = CONV(HEX(SUBSTRING(cv1, j, 1)), 16, 10) + 成本；
          如果 c > c_temp 那么设置 c = c_temp; 万一;
            SET c_temp = CONV(HEX(SUBSTRING(cv1, j+1, 1)), 16, 10) + 1;
            如果 c > c_temp 那么  
              设置 c = c_temp;  
            万一;
            SET cv0 = CONCAT(cv0, UNHEX(HEX(c))), j = j + 1;
        结束；
        设置 cv1 = cv0, i = i + 1;
      结束；
    万一;
    返回 c;
  结尾

```

并将其作为 XX% 使用此功能

```
创建函数`levenshtein_ratio`（s1文本，s2文本）返回int（11）
    确定性
开始
    声明 s1_len、s2_len、max_len INT；
    设置 s1_len = 长度（s1），s2_len = 长度（s2）；
    如果 s1_len > s2_len 那么  
      设置 max_len = s1_len;  
    别的  
      设置 max_len = s2_len;  
    万一;
    返回回合（（1 - LEVENSHTEIN（s1，s2）/ max_len）* 100）；
  结尾

```

* * *

## 回答 #7

> 赞同：2
> 
> 时间：2014-07-01T12:50:23.073

如果只想知道 levenshtein-distance 是否最多为 1，可以使用下面的 MySQL 函数。

```
CREATE FUNCTION `lv_leq_1` (
`s1` VARCHAR( 255 ) ,
`s2` VARCHAR( 255 )
) RETURNS TINYINT( 1 ) DETERMINISTIC
BEGIN
    DECLARE s1_len, s2_len, i INT;
    SET s1_len = CHAR_LENGTH(s1), s2_len = CHAR_LENGTH(s2), i = 1;
    IF s1 = s2 THEN
        RETURN TRUE;
    ELSEIF ABS(s1_len - s2_len) > 1 THEN
        RETURN FALSE;
    ELSE
        WHILE SUBSTRING(s1,s1_len - i,1) = SUBSTRING(s2,s2_len - i,1) DO
            SET i = i + 1;
        END WHILE;
        RETURN SUBSTRING(s1,1,s1_len-i) = SUBSTRING(s2,1,s2_len-i) OR SUBSTRING(s1,1,s1_len-i) = SUBSTRING(s2,1,s2_len-i+1) OR SUBSTRING(s1,1,s1_len-i+1) = SUBSTRING(s2,1,s2_len-i);
    END IF;
END 
```

这基本上是 levenshtein 距离的递归描述中的一个步骤。如果距离最多为 1，则该函数返回 1，否则返回 0。

由于此函数不完全计算 levenshtein 距离，因此它要快得多。

您还可以修改此函数，使其`true`在 levenshtein-distance 最多为 2 或 3 时返回，方法是递归地调用它。如果 MySQL 不支持递归调用，您可以将该函数的稍微修改的版本复制两次并调用它们。但是您不应该使用递归函数来计算精确的 levenshtein 距离。

* * *

## 回答 #8

> 赞同：1
> 
> 时间：2017-05-10T13:15:16.717

根据[Chella 的回答](https://stackoverflow.com/questions/13909885/how-to-add-levenshtein-function-in-mysql)和 Ryan Ginstrom 的[文章](http://ginstrom.com/scribbles/2007/12/01/fuzzy-substring-matching-with-levenshtein-distance-in-python/)，可以这样实现模糊搜索：

```
DELIMITER $$
CREATE FUNCTION fuzzy_substring( s1 VARCHAR(255), s2 VARCHAR(255) )
    RETURNS INT
    DETERMINISTIC
BEGIN
    DECLARE s1_len, s2_len, i, j, c, c_temp, cost INT;
    DECLARE s1_char CHAR;
    -- max strlen=255
    DECLARE cv0, cv1 VARBINARY(256);
    SET s1_len = CHAR_LENGTH(s1), s2_len = CHAR_LENGTH(s2), cv1 = 0x00, j = 1, i = 1, c = 0;
    IF s1 = s2 THEN
        RETURN 0;
    ELSEIF s1_len = 0 THEN
        RETURN s2_len;
    ELSEIF s2_len = 0 THEN
        RETURN s1_len;
    ELSE
        WHILE j <= s2_len DO
            SET cv1 = CONCAT(cv1, UNHEX(HEX(0))), j = j + 1;
        END WHILE;
        WHILE i <= s1_len DO
            SET s1_char = SUBSTRING(s1, i, 1), c = i, cv0 = UNHEX(HEX(i)), j = 1;
            WHILE j <= s2_len DO
                SET c = c + 1;
                IF s1_char = SUBSTRING(s2, j, 1) THEN
                    SET cost = 0; ELSE SET cost = 1;
                END IF;
                SET c_temp = CONV(HEX(SUBSTRING(cv1, j, 1)), 16, 10) + cost;
                IF c > c_temp THEN SET c = c_temp; END IF;
                    SET c_temp = CONV(HEX(SUBSTRING(cv1, j+1, 1)), 16, 10) + 1;
                IF c > c_temp THEN
                    SET c = c_temp;
                END IF;
                SET cv0 = CONCAT(cv0, UNHEX(HEX(c))), j = j + 1;
            END WHILE;
            SET cv1 = cv0, i = i + 1;
        END WHILE;
    END IF;
    SET j = 1;
    WHILE j <= s2_len DO
        SET c_temp = CONV(HEX(SUBSTRING(cv1, j, 1)), 16, 10);
        IF c > c_temp THEN
            SET c = c_temp;
        END IF;
        SET j = j + 1;
    END WHILE;
    RETURN c;
END$$
DELIMITER ; 
```

* * *

## 回答 #9

> 赞同：0
> 
> 时间：2012-04-16T04:39:26.960

I had a specialized case of k-distance searching and after installing the Damerau-Levenshtein UDF in MySQL found that the query was taking too long. I came up with the following solution:

*   I have a very restrictive search space (9 character string limited to numeric values).

Create a new table (or append columns to your target table) with columns for each character position in your target field. ie. My VARCHAR(9) ended up as 9 TINYINT columns + 1 Id column that matches my main table (add indexes for each column). I added triggers to ensure that these new columns always get updated when my main table gets updated.

To perform a k-distance query use the following predicate:

(Column1=s[0]) + (Column2=s[1]) + (Column3=s[2]) + (Column4=s[3]) + ... >= m

where s is your search string and m is the required number of matching characters (or m = 9 - d in my case where d is the maximum distance I want returned).

After testing I found that a query over 1 million rows that was taking 4.6 seconds on average was returning matching ids in less than a second. A second query to return the data for the matching rows in my main table similarly took under a second. (Combining these two queries as a subquery or join resulted in significantly longer execution times and I'm not sure why.)

Though this is not Damerau-Levenshtein (doesn't account for substitution) it suffices for my purposes.

Though this solution probably doesn't scale well for a larger (length) search space it worked for this restrictive case very well.**``***