# StackOverflow 问答 10902000-10902999

# database-design - 企业应用程序的异议版本控制数据库

> ID：10902003
> 
> 赞同：1
> 
> 时间：2012-06-05T17:30:18.333
> 
> 标签：database-design

许多企业应用程序都有关系数据库作为对象的后端存储。有些对象是不可变的，有些则不是。

当不可变对象依赖于可变对象时，它应该提供适当的版本。

请参阅：您有*Order*对象和*Customer*对象。订单取决于客户。但秩序永远不会改变。订单完成并发货后，客户更改地址。我如何知道哪个地址用于发货？我不想按顺序存储所有信息，因为它会使我的数据库不规范化。

答案是版本控制：订单应取决于*具有特定版本*的客户。

这是用于共享库（GAC、SxS、不同的 .so 版本等）的想法。

但是如何在数据库中做到这一点？将“版本”字段添加到所有表和任何关系字段？这将增加我的数据库 X2 并使其纠缠。

分离此信息并将其存储在某个地方？

我相信必须有很好的解决方案。你知道任何？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-06-05T17:48:08.453

正如您已经发现的那样，永远不应该允许不可变数据引用可变数据。答案是**使引用的数据不可变**。使用版本只是这样做的一个例子，但还有其他方法。

在您的 Order-Customer 示例中，订单不依赖于整个客户——更改客户密码或创建新订单不应以任何方式影响原始订单。因此，您可以从客户身上剔除依赖的部分并使其不可变。这意味着地址是不可变的，但您仍然可以更改客户对其当前地址的引用，因为客户仍然是可变的。

这可以使用关系数据库以多种方式实现。两个明显的：

*   您可以使地址表只插入（不更新或删除）。这是最简单的方法，但可能会妨碍您的 ORM，并将所有地址保留在数据库中，即使它们与订单无关。

*   保持地址表可变（允许更新和删除）。然后，每当创建新订单时，您都会创建客户当前地址的副本，并且订单会引用新副本。这应该是对 ORM 最友好的解决方案，但是即使地址永远不会改变，每个订单都会获得自己的地址副本。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-06-05T17:41:59.820

我不太确定我是否理解这个问题。以您的客户和订单为例，您可以

```
CREATE TABLE address (
  address_id NUMBER PRIMARY KEY,
  street     VARCHAR2(100),
  ...
);

CREATE TABLE customer (
  customer_id NUMBER PRIMARY KEY,
  first_name  VARCHAR2(100),
  ...
  address_id  NUMBER REFERENCES address( address_id )
);

CREATE TABLE orders (
  order_id   NUMBER PRIMARY KEY,
  ...
  customer_id NUMBER REFERENCES customer( customer_id ),
  address_id  NUMBER REFERENCES address( address_id )
); 
```

如果`ADDRESS`是一级表，则两者`ORDERS`都`CUSTOMER`可以引用特定的地址。 `CUSTOMER`可以参考客户的当前地址，`ORDERS`可以参考订单被切到的地址，该地址可能是客户当时的当前地址，或者可能是他们为之下订单的人的地址（即我下的鲜花订单是我已经在母亲节寄到我妈妈家）。 `ADDRESS`then 变为不可变的，因此`ADDRESS`您无需更新行，只需`INSERT`使用 new执行`ADDRESS_ID`并更新`CUSTOMER`表中的行以指向 new `ADDRESS`。

如果您想跟踪客户地址的历史记录，您只需将表`address_id`移出`customer`并放入`customer_address`具有某种版本相关信息的新映射表中。通常，您会遇到类似这样的情况，您可以在其中指定映射有效的日期范围。

```
CREATE TABLE customer_address (
  customer_address_id NUMBER PRIMARY KEY,
  customer_id         NUMBER REFERENCES customer( customer_id ),
  address_id          NUMBER REFERENCES address( address_id ),
  valid_from          DATE,
  valid_to            DATE
); 
```

# javascript - jquery菜单幻灯片验证悬停功能

> ID：10902007
> 
> 赞同：0
> 
> 时间：2012-06-05T17:30:28.277
> 
> 标签：javascript, jquery, menu, timeout, settimeout

我一直在尝试调整菜单幻灯片，并在下面显示我的部分代码，我分别为菜单中的 4 个项目中的每一个项目提供了代码。我这样做了，如果您将光标移动到给定的菜单项上，相应的 div 就会显示在显示屏中。我还添加了超时，因此如果您快速从一个菜单项移动到另一个菜单项，它不会很快从一个 div 切换到另一个。我现在必须让它完全按照需要工作的问题是**如何让它检查光标是否在 200 毫秒后仍然悬停在给定的菜单项上，例如在切换到该菜单项之前？**任何意见或帮助表示赞赏。谢谢。

```
$("div#menu .reps").hover(function() {
    window.clearTimeout(timeoutID);
    timeoutID = window.setTimeout(hoverFunctionReps, 280);
});

function hoverFunctionReps(){
    if(current_slide != "reps"){

        $(".arrow").animate({"left":"135px"});

        if(current_slide == "clients"){
            $(".clients_display").stop(true,true).fadeOut().hide();
            $(".reps_display").fadeIn().show();
            current_slide = "reps";
        }
        else if(current_slide == "services"){
            $(".services_display").stop(true,true).fadeOut().hide();
            $(".reps_display").fadeIn().show();
            current_slide = "reps";
        }
        else{
            $(".training_display").stop(true,true).fadeOut().hide();
            $(".reps_display").fadeIn().show();
            current_slide = "reps";
        }
    }
} 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-06-05T18:30:25.703

也许是这样的：

[http://jsfiddle.net/lucuma/ZgNKG/](http://jsfiddle.net/lucuma/ZgNKG/)

var timeoutID;

```
$(document).ready(function() {
$("a").hover(function() {
    window.clearTimeout(timeoutID);
    $(this).data('hashover', '1');
    var that = this;
     timeoutID=window.setTimeout(
        (function() {
        hoverFunctionReps(that); 
        }), 280);

}, function() {
    $('span', this).hide();
   $(this).data('hashover', '0');
});

function hoverFunctionReps(me) {
    if ($(me).data('hashover') == '1') {
        $('span', me).show();
    }
}
});​ 
```

# websub - Pubsubhubbub 保证交付

> ID：10902017
> 
> 赞同：1
> 
> 时间：2012-06-05T17:31:10.250
> 
> 标签：websub

刚开始研究 Pubsubhubbub ，我想知道协议中是否有保证的交付机制，或者它真的取决于集线器如何实现它？

谢谢

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-06-06T08:24:12.193

我是[http://superfeedr.com](http://superfeedr.com)的创始人，我们在这里托管了大多数 PubSubHubbub 集线器。

好吧，我不确定您所说的“保证”交付是什么意思。如果发布者、集线器和订阅者遵守协议，那么，是的，交付是有保证的......

现在，我们知道某些发布者可能并不总是准确地 ping 我们。一些集线器也可能有停机时间。为了防止这种情况发生，我们进行了备份轮询，这意味着我们将轮询每个提要以确保我们没有错过任何内容。

同样，订阅者可能无法处理/处理通知，或者至少集线器可能无法访问它们（尽管重试）。对于这些情况，我们会存储所有过去通知的内容，并允许订阅者方便地检索这些内容。

最后，我们实现了一种“计数器”方法，通过为我们发送给他们的每个通知发送递增的计数器来帮助订阅者知道他们没有错过任何内容。如果他们看到计数器减少了 1 以上，他们就知道他们错过了一些东西。

# ruby-on-rails - Rails 3.2.3 命名空间控制器被同名的全局控制器覆盖

> ID：10902023
> 
> 赞同：7
> 
> 时间：2012-06-05T17:31:27.617
> 
> 标签：ruby-on-rails, ruby, ruby-on-rails-3.2, controllers, nomethoderror

当首先加载全局应用程序控制器时，在该命名空间内加载页面时，命名空间应用程序控制器不会加载。应用程序控制器如下所示：

```
class ApplicationController < ActionController::Base
 protect_from_forgery
end 
```

命名空间的应用程序控制器如下所示：

```
class Admin::ApplicationController < ApplicationController

def authenticate_admin!
 if current_admin.nil?
  redirect_to new_admin_session_url
 end
end

private

 def current_admin
  @current_admin ||= Admin.find(session[:admin_id]) if session[:admin_id]
 end

helper_method :current_admin
end 
```

当我们使用 before_filter "authenticate_admin!" 像这样：

```
class Admin::AssetsController < Admin::ApplicationController
  before_filter :authenticate_admin!
end 
```

抛出“Admin::AssetsController#new 中的 NoMethodError”。这只发生在我们在命名空间路由之前点击全局路由时。如果服务器重新启动并首先加载命名空间路由，则一切正常。

* * *

## 回答 #1

> 赞同：9
> 
> 时间：2012-06-05T18:41:58.300

发生这种情况是因为您也碰巧有一个`Admin`与您的命名空间同名的模型（一个类）。

[这个](https://groups.google.com/group/rubyonrails-core/browse_thread/thread/bab5e87ee10d2ecb?pli=1)谷歌组线程很好地解释了到底发生了什么。

要解决此问题，我会将模型重命名为，`AdminUser`或者如果不可能，重命名命名空间也将解决问题。

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2012-06-05T17:55:00.460

命名空间控制器需要出现在正确的目录结构中。

`app/controllers/admin/application_controller.rb`

`app/controllers/admin/assets_controller.rb`

就个人而言，我建议不要重载`ApplicationController`命名空间基本控制器的名称。这不会导致问题，但这是一个偏好问题 - 只有一个应用程序，并且应该只有一个`ApplicationController`. `ContentManagementController`如果这是命名空间的目的，您可以使用`Admin`。

其次，更好的做法是使用`module`关键字并以这种方式定义控制器：

```
module Admin
  class ContentManagementController < ApplicationController
      # ..
  end
end

# app/controllers/admin/content_management_controller.rb 
```

编辑：我也刚刚看到了具体错误（也许您的问题已更新？）-您需要在`AssetsController`

```
def new
   #
end 
```

# python - 在 python 中处理未知列表结构的更好方法是什么？

> ID：10902030
> 
> 赞同：2
> 
> 时间：2012-06-05T17:31:41.950
> 
> 标签：python

我的 python 程序从 C 库接收 MIDI 数据。有时数据会如下所示：

```
[[[[240,0,1,116]]],[[[3,100,8,1]]],[[[107,247,0,0]]]] 
```

有时它会包括这样的时间戳：

```
[[[[240,0,1,116],26738]],[[[3,100,8,1],26738]],[[[107,247,0,0],26738]]] 
```

我需要字节数组中的数据，并丢弃时间戳值。我为此编写的代码是：

```
 def convertMidiSysex(data):    
            while isinstance(data[0][0], list):
                out = []
                for index, value in enumerate(data):
                    out = out+value
                data = out

            out = array.array('B')
            for i in range(len(data)):
                if isinstance(data[i], list):
                    for j in range(len(data[i])):
                        out.append(data[i][j])
                        if out[-1] == 247:  # 0xF7 is marker to end sysex message
                            return out 
```

我情不自禁地感觉到我正在艰难地做这件事。有更好的方法吗？

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-06-05T17:39:24.700

假设深度始终一致：

```
from itertools import takewhile

def convertMidiSysex(data):
    values = takewhile(lambda v: v != 247,
                       (a for x in data for a in x[0][0]))
    out = array.array('B', values)
    out.append(247)
    return out 
```

例子：

```
>>> convertMidiSysex([[[[240,0,1,116]]],[[[3,100,8,1]]],[[[107,247,0,0]]]])
array('B', [240, 0, 1, 116, 3, 100, 8, 1, 107, 247])
>>> convertMidiSysex([[[[240,0,1,116],26738]],[[[3,100,8,1],26738]],[[[107,247,0,0],26738]]])
array('B', [240, 0, 1, 116, 3, 100, 8, 1, 107, 247]) 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-06-05T18:02:20.830

一种更清洁的方式来获得你现在拥有的东西：

```
# the entry below mixes timestamped and non-timestamped inputs
entry = [[[[240,0,1,116]]],    [[[3,100,8,1]]],
         [[[107,247,0,0]]],    [[[240,0,1,116],26738]],
         [[[3,100,8,1],26738]],[[[107,247,0,0],26738]]]

data = array.array('B')
for sublist in entry:
    for item in sublist[0][0]:
        data.append(item)
        if item == 247:
            break 
```

# delphi - 如果 RLink32 失败，如何链接一个巨大的 Res

> ID：10902031
> 
> 赞同：2
> 
> 时间：2012-06-05T17:31:42.490
> 
> 标签：delphi, embedded-resource, delphi-2007, resource-files

在一个项目中，在编译过程中，资源链接过程失败并出现以下错误：**[DCC Error] E2161 Error: RLINK32: Out of memory！**.

该项目包括一个巨大的 res 文件（约 400 Mb）。如果 res 文件大小不超过 250 Mb，则不会触发该错误。只有一些 RCDATA，我可以将数据保存在外部文件中，但我想知道是否有解决此问题的方法。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-06-05T18:55:24.960

您可以在构建后事件（项目->选项->构建事件）中使用外部资源链接器。下面是“ [ResHacker](http://www.angusj.com/resourcehacker/) ”的示例用法（它几乎可以通过其 GUI 可以执行的命令行执行任何操作）。

```
"C:\...\ResHacker.exe" -addskip "$(OUTPUTPATH)", "$(OUTPUTPATH)", "C:\...\icons.res",,, 
```

该示例将不在可执行文件中的资源添加到 icons.res 并覆盖可执行文件。我不知道它是否会占用您的大量资源，但如果确实如此，您可以尝试使用其他替代方案。

# delphi - MDI 应用程序中的 TActionManager。失败的行动

> ID：10902040
> 
> 赞同：1
> 
> 时间：2012-06-05T17:32:06.733
> 
> 标签：delphi, delphi-xe2, mdi, taction, tactionmanager

我有一个 MDI 应用程序，我正在使用 TActionManager 来管理我的应用程序中的操作，这也意味着它包含我的 MDIChild 表单的操作。

这是一个重新创建我的问题的简单示例：

使用 2 个表单创建一个新的 VCL Forms 应用程序。Form1 & Form2 在 Form1 上放置一个 TButton 和一个 TActionManager。使用 TActionManager 的弹出编辑器创建 2 个 TAction。为 Form1 设置 FormStyle := fsMDIForm。为 Form2 设置 FormStyle := fsMDIChild。

将此代码添加到相应的事件：

```
// Form1   
procedure TForm1.Action1Execute(Sender: TObject);
begin
   ShowMessage('Action1');
end;
procedure TForm1.Action2Execute(Sender: TObject);
begin
   ShowMessage('Action2');
end;
procedure TForm1.Button1Click(Sender: TObject);
var
   oForm2: TForm2;
begin
   oForm2 := TForm2.Create(Application);
end;

// Form 2
procedure TForm2.FormClose(Sender: TObject; var Action: TCloseAction);
begin
   Action := caFree;
end; 
```

将 TActionToolBar 拖放到 Form2 上。使用 TActionManager 弹出编辑器将 Action1 和 Action2 放在此 TActionToolBar 上。保存并运行。单击 Form1 上的按钮以显示 Form2。一切都按预期工作。现在关闭 Form2 并重新打开它。缺少动作...

知道我真的需要使用 TActionManager，有没有办法避免丢失我的操作？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-06-05T18:31:19.333

我将尽我所能解释这个问题。

首先，你的行为是断开的而不是“消失”，它们仍然存在。换句话说，ActionManager1.ActionCount 仍然会返回 2。

话虽如此，您在设计时所做的是将一个表单变量上的操作列表与另一个表单变量上的工具栏连接起来。换句话说。Form1.ActionList 被附加到 Form2.ToolBar。这就是为什么它在您第一次运行时起作用，下次您创建 TForm2 的实例时，它不再是默认创建的 Form2，因此不会连接到变量 Form1。这是我多年来最好的猜测，我在使用 DataModules 时也遇到过类似的问题。

我的回答是，将动作列表放在子表单上。如果您需要在所有子窗体之间共享操作，则操作列表和工具栏属于 MDI 父窗体。这对于 MDI 应用程序来说是相当标准的。

# c# - 在泛型方法中返回一个类的对象

> ID：10902042
> 
> 赞同：2
> 
> 时间：2012-06-05T17:32:11.537
> 
> 标签：c#, generics

我有一个场景，其中有两个类分别使用方法 MethodA 和 MethodB 说 ClassA 和 ClassB。我必须编写泛型方法，该方法根据某个整数变量 x 的条件返回上述类的对象实例。当我尝试下面的代码时，我收到一条错误消息，提示“无法将 ClassA 隐式转换为 T”或“无法将 ClassB 隐式转换为 T”

```
public ClassA
{
    public void MethodA()
    {
        //method implementation
    }
}

public ClassB
{
    public void MethodB()
    {
        //method implementation
    }
} 
```

通用方法为

```
public T MethodGeneric<T>()
{
    int x;
    ClassA objectA = new ClassA();
    ClassB objectB = new ClassB();

    if(x==2)
    {
        return objectA;
    }
    else
    {
        return objectB;
    }
} 
```

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-06-05T17:35:35.870

问题是`T`不是`ClassA`也不是`ClassB`。

您可以尝试通过强制转换来处理这个问题，如下所示：

```
public static T MethodGeneric<T>() where T : class
{
    int x = 2;
    ClassA objectA = new ClassA();
    ClassB objectB = new ClassB();

    if (x == 2)
    {
        return objectA as T;
    }
    else
    {
        return objectB as T;
    }
} 
```

但是，如果有人打电话给您，这不会保护您`MethodGeneric<ClassC>()`，除非在这种情况下返回`null`。

如果您拥有`ClassA`并且`ClassB`两者都派生自相同的基类或接口，则可以使这更安全，因为您可以放置​​一个通用约束来减少出错的机会。但是，这仍然不是一种完全安全的工作方式，因为泛型不合适。最好让两个类都实现一个接口（即`IClassBase`：），然后不使用泛型，而是返回接口：

```
public IClassBase CreateInstance()
{
    //... 
         return objectA; // This will work fine, provided ClassA implements IClassBase
} 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-11-12T07:58:17.687

从你[这个封闭的双柱](https://stackoverflow.com/questions/10918863/generic-method-with-return-type-as-object?rq=1)中，你很接近。您`object`作为类型参数传递，它将再次返回与您的情况相同`T`的参数。`object`这就是为什么你不能使用`ClassA`对象上定义的属性。相反，您应该传递所需的类型，例如`ClassB`or `ClassC`。可能是这样的：

```
public T getObject<T>(int i) where T : ClassA
{
    if(i == 1)
    {
        ClassB objB = new ClassB();
        return objB as T;
    }
    else
    {
        ClassC objC = new ClassC();
        return objC as T;
    }
}

public static void main()
{
    var obj = getObject<ClassB>(5); //which wont work anyway since i == 5 !!
    obj.aValue = 20;
    obj.bValue = 30;
    //obj.cValue = 40; this wont work since obj is of type ClassB

    //or 

    var obj = getObject<ClassC>(5);
    obj.aValue = 20;
    //obj.bValue = 30; this wont work since obj is of type ClassC now
    obj.cValue = 40; 
} 
```

我不确定你为什么要检查变量`int i`来决定应该返回什么类型。这不是对泛型的真正使用。真正使用泛型可能如下所示：

```
public T getObject<T>(int i) where T : ClassA
{
    return new T(); //without the use of int i
} 
```

如果`int i`是什么决定了返回哪个对象，那么为什么要使用泛型呢？你可以这样做：

```
public ClassA getObject(int i)
{
    if(i == 1)
    {
        ClassB objB = new ClassB();
        return objB;
    }
    else
    {
        ClassC objC = new ClassC();
        return objC;
    }
}

public static void main()
{
    var obj = getObject(5);
    if (obj is ClassB)
    {
        obj.aValue = 20;
        obj.bValue = 30;
        //obj.cValue = 40; this wont work since obj is of type ClassB
    }
    //or 

    var obj = getObject(5);
    if (obj is ClassC)
    {
        obj.aValue = 20;
        //obj.bValue = 30; this wont work since obj is of type ClassC
        obj.cValue = 40; 
    }
} 
```

但问题是您必须从调用方（主要）检查类型。

如果你想在和对象上分配属性`bValue`，那么你应该把这些属性写在.`cValue``ClassB``ClassC``ClassA`

此外，您仅使用`get`访问器，还需要`set`分配值。

# ios - UITableViewCell imageView 导致缩进过多

> ID：10902046
> 
> 赞同：0
> 
> 时间：2012-06-05T17:32:23.127
> 
> 标签：ios, cocoa-touch, uitableview, uiimageview

我有一个`UITableViewCell`要设置的子类`imageView`。我想把它保持在 60x60，所以我在我的子类的方法中设置了`frame`and ：`bounds``layoutSubviews`

```
- (void)layoutSubviews {
    [super layoutSubviews];

    self.imageView.bounds = CGRectMake(10,10,60,60);
    self.imageView.frame = CGRectMake(10,10,60,60);
    self.imageView.clipsToBounds = YES;

}//end 
```

这很好用，直到我有一个超出范围的图像`imageView`：

![在此处输入图像描述](../Images/c7174a50d3e97c07e95f6c250d2c70f2.png)

因此，我确保设置`clipsToBounds`为 YES：

![在此处输入图像描述](../Images/f7851592b7e38f432db006509d71c338.png)

但是正如你所看到的，它仍然在缩进`textLabel`and `detailTextLabel`，尽管我认为它不应该是这样。

**我该如何解决这个问题？**

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-06-07T15:32:50.137

我认为我采用的更好的解决方案是不使用内置，`imageView`而是使用我自己的。这工作得更好。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-06-06T09:43:27.883

你可以`textLabel`在你的`-layoutSubviews`实现中设置你的位置：

```
- (void)layoutSubviews {
    [super layoutSubviews];

    self.imageView.bounds = CGRectMake(10,10,60,60);
    self.imageView.frame = CGRectMake(10,10,60,60);
    self.imageView.clipsToBounds = YES;

    CGFloat x = 10.0 + 60.0 + 10.0; // Padding, image width, and padding.

    CGRect frame = self.textLabel.frame;
    frame.origin.x = x;
    self.textLabel.frame = frame;

    frame = self.detailTextLabel.frame;
    frame.origin.x = x;
    self.detailTextLabel.frame = frame;

} //end 
```

您可能想要调整 的值`x`。

希望这可以帮助。

# javascript - 如何从 javascript 文件发送等效的 curl 命令？

> ID：10902055
> 
> 赞同：1
> 
> 时间：2012-06-05T17:32:52.550
> 
> 标签：javascript, json, curl

我一直在看这个 SO 帖子： [JavaScript post request like a form submit](https://stackoverflow.com/questions/133925/javascript-post-request-like-a-form-submit)

我的情况略有不同。有这个有效的 curl 命令：

```
curl -v -X POST -H "application/json" -H "Content-type: application/json" -d 'some json' http://127.0.0.1:9010/api/kpi 
```

但是现在我需要将这种东西放入一个 JavaScript 文件中，它显然会中断。

有人可以帮我用 JavaScript 创建这个吗？

谢谢！

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-06-05T17:38:08.713

javascript 没有 curl，最接近的等价物是 AJAX。但是您不能在 javascript 中向当前页面域以外的域发出 post (ajax) 请求，因为这被认为是跨站点脚本。

# javascript - 有没有办法在 JavaScript 中冻结 document.body.innerHTML？

> ID：10902060
> 
> 赞同：1
> 
> 时间：2012-06-05T17:33:02.020
> 
> 标签：javascript, html

有什么方法可以在 JavaScript 中冻结**document.body.innerHTML**以便攻击者无法执行以下操作：

`<script>document.body.innerHTML = document.body.innerHTML.replace("http://www.example.com/" , "http://abc.org" ); </script>`

另外如何冻结document.location？谢谢！

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-06-05T17:36:22.823

不，您不能从 javascript 中锁定 DOM 元素的内容。我怀疑你在这里问错了问题。您可能需要做的是首先插入攻击者用来运行代码的任何漏洞。

*   清理用户输入以去除标签
*   清理从数据库插入页面的内容
*   禁止在应用程序的任何输入中使用 html 标签

这些将是一个很好的起点。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-06-05T17:36:39.463

不，没有办法“冻结”它。您可以通过在页面上不包含第 3 方脚本来防止这种情况。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-06-05T17:36:33.370

好吧，不是 JavaScript。这根本不可能。您的代码应该如何比其他任何代码都更具排他性？

简单的解决方案是编写一个安全页面，该页面对 XSS 来说不是易读的。解析来自外部的所有内容，您的页面将是安全的。

您还可以尝试防止您的网站加载到带有`X-Frame-Options`标题的框架中。您可以使用包含以下内容的 .htaccess 文件来实现：

```
<IfModule mod_headers.c>
    # Secure frame optione
    Header always append X-Frame-Options SAMEORIGIN
</IfModule> 
```

# jquery - 在 jQuery UI 中切换按钮图标

> ID：10902066
> 
> 赞同：0
> 
> 时间：2012-06-05T17:33:26.640
> 
> 标签：jquery, jquery-ui

我正在使用带有图标的 jquery UI 按钮。我想切换按钮 onclick 的图标，它的工作但图标是压倒一切的：

```
/* initialize the button at document.ready event */
$("#buttonid"). button({ icons: { primary: 'ui-icon-play'} });

/* binding event */
$("#buttonid").toggle(
function () { 
  /* code */ 
  $(this).button({ icons: { primary: 'ui-icon-play'} }); }, 
function () { 
  /* code */ 
  $(this).button({ icons: { primary: 'ui-icon-pause'} }); 
}); 
```

有人可以指出问题吗？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-06-05T17:52:53.440

您可以通过更改与其关联的类来更改图标，无需额外的交互。

请参阅这个[工作小提琴](http://jsfiddle.net/zuul/VZwQV/)示例！

**jQuery**

```
$(function() {
    $("#buttonid").button({
        icons: {
            primary: "ui-icon-play"
        }
    }).hover(function () {
        // hover in
        $(".ui-button-icon-primary", this)
          .toggleClass("ui-icon-pause ui-icon-play");
    }, function () {
        // hover out
        $(".ui-button-icon-primary", this)
          .toggleClass("ui-icon-play ui-icon-pause");
    });
}); 
```

由于您只需要更改图标，并且图标出现在具有特定类的样式表中，因此您只需将类切换到输入/输出，从而更改：

`.ui-icon-play`和`.ui-icon-pause`反之亦然。

**请参阅：** [jQuery 切换类](http://api.jquery.com/toggleClass/)

**参见：** [jQuery UI 图标类](http://jqueryui.com/themeroller/#icons) *（悬停图标查看类名）*

# jquery - Java HttpServlet 发送 gson 字符串，JavaScript 将其作为数组获取

> ID：10902067
> 
> 赞同：0
> 
> 时间：2012-06-05T17:33:33.857
> 
> 标签：jquery, json, servlets, jqgrid

服务器端我有这个Java：

```
public void doGet(HttpServletRequest req, HttpServletResponse resp) throws IOException {

    resp.setContentType("application/json;charset=UTF-8");        
    resp.setHeader("Cache-Control", "no-cache");

    PersistenceManager pm = PMF.get().getPersistenceManager();
    Extent<Video> extent = pm.getExtent(Video.class, false);

    ArrayList<Video> list = new ArrayList<Video>(); 
    for (Video e : extent) {
        list.add(e);
    }

    Gson gson = new Gson();
    String json = gson.toJson(list);
    System.out.println(json); // As expected: [{"id":34,"title":"a title","videoUrl":"an.mp4","imageUrl":"a.jpg" etc.
    resp.getWriter().write(json);

    extent.closeAll();
    pm.close();

} 
```

客户端我有这个使用 jQuery 的 JavaScript：

```
var getAllRequest = $.ajax({ 
 url: "http://localhost:8888/getAll",
 type: "GET",
 dataType: "json"
});
getAllRequest.done(function(response) {         
 alert (response) // THIS IS AN OBJECT ARRAY, i.e., [object Object],[object Object] etc. 
}); 
```

**我的问题**：响应真的是一个 json 对象，还是只是一个 json 对象数组。我正在使用 jq 网格，并且在给出响应时它不会填充网格。（将响应馈送到此处未显示的 jq 网格。）

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-06-05T17:48:54.970

JSON 让您可以将有关对象的信息作为字符串发布。所以没有“json对象”。要么你有字符串，例如像这样的文本

```
var str = '[["a", "b"], ["c", "d"], ["e", "f"]]'; 
```

或者你有一个对象，例如

```
var myObj = [["a", "b"], ["c", "d"], ["e", "f"]]; 
```

JSON 的完整规范在[此处](http://www.json.org/)或[rfc4627](http://www.ietf.org/rfc/rfc4627.txt)中进行了描述。所以你不应该混合初始化语法，它允许你用非常接近的语法创建带有 JSON 字符串的对象。

如果您使用带有参数的[$.ajax](http://api.jquery.com/jQuery.ajax/)`dataType: "json"`并且服务器响应包含 JSON 字符串 jqGrid 在内部将服务器响应转换为对象（请参阅[$.parseJSON](http://api.jquery.com/jQuery.parseJSON/)函数）并且参数`done`将已经是对象。所以你可以使用

```
alert(response.length); 
```

例如在回调函数内部`getAllRequest.done`。无论如何，客户端似乎都正确地获得了服务器响应。

# sql - 如何以其他方式将下一个最近的条目添加到我的查询中？

> ID：10902070
> 
> 赞同：1
> 
> 时间：2012-06-05T17:33:43.077
> 
> 标签：sql, sql-server

我正在尝试根据 ID 和位置获取下一个最新条目的信息，并将其添加到我正在运行的查询中。不是表中第二个最近的条目，只有基于 ID 的上一个条目。

我不确定这是否可能，或者我只是不知道该怎么做，甚至不知道我应该往哪个方向走。

这是以前的程序员是如何做到的：

```
SELECT -- blah blah blah
       , (SELECT TOP 1 CAST(id AS VARCHAR) + '~' + CONVERT(VARCHAR,  creation_date,   120)
          FROM header hdr2 
          WHERE hdr2.id < hdr.id 
                AND hdr2.location = hdr.location 
          ORDER BY hdr2.id DESC) AS "prev_info"
FROM header hdr 
/*blah blah blah*/ 
```

我理解他为什么只想使用单个子查询并试图将所有内容放入该列中，但我正在尝试优化这一点，我想以其他更简单、更有效的方式来做。

我觉得答案正盯着我的脸，但我无法伸手去抓住它。如果我需要进一步解释自己，请不要犹豫。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-06-05T17:44:54.473

如果您想使用 ROW_NUMBER，我认为这会起作用：

```
With rownumbers as 
(
  SELECT
    ROW_NUMBER() OVER (partition by location ORDER BY id ASC) AS rownumber,
    id, location
  FROM header 
)
SELECT id, location from rownumbers
WHERE rownumber = 2 
```

这更容易阅读吗？我会说这取决于读者。这样更有效率吗？我得看看执行计划。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-06-05T17:39:09.787

考虑使用`outer apply`：

```
select  -- blah blah blah
,       prev_info.*
from    header hdr 
outer apply
        (
        select  top 1 id
        ,       creation_date
        from    header hdr2 
        where   hdr2.id < hdr.id 
                and hdr2.location = hdr.location 
        order by
                hdr2.id desc
        ) as prev_info 
```

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-06-05T17:39:16.537

如果我理解正确，您可以使用交叉应用一次获取所有列。

```
SELECT -- blah blah blah
FROM header hdr 
  cross apply(
          SELECT TOP 1
            hdr2.*
          FROM header hdr2 
          WHERE hdr2.id < hdr.id 
                AND hdr2.location = hdr.location 
          ORDER BY hdr2.id DESC
) AS prev_info
/*blah blah blah*/ 
```

与您拥有的选择中的子查询做同样的事情，除了允许返回多于一列，因此您不必从一个连接列中解析出所有内容。

# hibernate - 数据库主键中的多列，映射到休眠，映射类中没有对应的属性

> ID：10902071
> 
> 赞同：0
> 
> 时间：2012-06-05T17:33:48.777
> 
> 标签：hibernate

我有一个类（称为“类 C”），其表有两个外键（另外两个类，“A 类”和“B 类”的 ID），它们构成数据库中的主键。问题是两个外键都不是子类的属性（我们避免使用反向指针，其中使用的类知道谁使用它们）。

我可以映射类似的东西`<id column="CLASS_A_ID" type="long"/>`，但是当我有两个键时这无济于事。任何`<composite-id>`必须有`<key-property>`或`<key-many-to-one>`两者都需要“名称”。

关于如何在不将外国 ID 放入课堂的情况下成功映射此内容的任何想法？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-08-09T14:54:10.220

我最终不得不使用反向指针并更改设计。这有点过于雄心勃勃了。

# .net - DataGridView 和 MySQL 以及 Microsoft Visual Studio 2010 和 Visual Basic .NET

> ID：10902073
> 
> 赞同：0
> 
> 时间：2012-06-05T17:33:54.387
> 
> 标签：.net, mysql, datagridview

到目前为止我有

```
Private dt As New DataTable
DataGridView1.DataSource = dt 
```

一切正常，可以浏览表中的值并对其进行编辑，但是更改不会保存到 MySQL 数据库中的表中。

我尝试阅读有关执行更新的信息，看起来如果 DataTable 正确绑定到 DataGridView 更改应该在 MySQL 内部自动更新，但无法弄清楚如何设置它。有人可以提供一些信息或指出我正确的方向吗？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-06-05T19:55:16.820

你的问题真的很模糊 - 更多细节会有所帮助 - 但你可能想看看这些。TableAdapter 类可能会有所帮助。它的工作是将 DataTable/DataSet 连接到实际的数据库。

保存数据概述 [http://msdn.microsoft.com/en-US/library/y2ad8t9c(v=vs.80)](http://msdn.microsoft.com/en-US/library/y2ad8t9c(v=vs.80))

TableAdapter 概述 [http://msdn.microsoft.com/en-us/library/bz9tthwx(v=vs.80).aspx](http://msdn.microsoft.com/en-us/library/bz9tthwx(v=vs.80).aspx)

（编辑 - 固定链接）

# google-maps - 使用自己的图层打印地图

> ID：10902074
> 
> 赞同：5
> 
> 时间：2012-06-05T17:34:09.523
> 
> 标签：google-maps, printing, openlayers, layer, openstreetmap

给定一个大城市（广场大约*800 km^2*），上面有一些层。该层可能包含*多色特征*，例如：

*   线条
*   积分
*   文本

特征数约为 1000。

地图资源 -*谷歌地图*或*Openstreetmap*（或者其他什么？）。

我的目标是在尺寸（约）5x5 米的纸上打印这样的地图。此外，此文件必须是*高分辨率的*- 在此文件上，我想查看带有编号的建筑物、带有标题的街道等。

生成此类*可打印文件*（图像、文档等）的最佳方法是什么？

* * *

以下是我发现的一些可能的解决方案：

*   我知道 OpenLayers API，所以我可以在 Google Maps 或 Openstreetmap 上绘制图层。但是如何将其转换为可打印格式？

*   我发现 Openstreetmap 上有[导出功能](http://wiki.openstreetmap.org/wiki/Export)。但是使用这个功能我不能导出我自己的图层，也不会是高分辨率的。

*   谷歌地图也有[类似的功能](https://developers.google.com/maps/documentation/staticmaps/?)。使用它我可以创建自己的图层。但是如果我有 1000 个特征，那么 URL 会很大，所以服务器不会加载它。这张地图也不会是高分辨率的。

* * *

谢谢你的帮助。

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-06-19T13:35:23.997

您想要绘制一个 5 米乘 5 米的城市的图形，该城市是 40 公里乘 40 公里。那是 1 / 8000 的比例。

查看开放街道地图图块集，图块集 17 的比例尺为 1 1/2 厘米到 100 米，或 150 厘米到 10,000 米。这是 1 / 6666 的比例，它与您使用开放街道地图图块集达到您想要的比例一样接近。

我已经使用该比例附上了一张图片。我不确定你是否能够看到你想看到的东西。

![打开街道地图第 17 层](../Images/b07921f5a1e6d9b5a578493c3376f6b0.png)

无论如何，要生成您想要的图像，您必须使用您选择的任何编程语言执行以下操作。

*   从 Open Street Map 网站收集您需要的图块。这可能需要一段时间，因为您将收集很多瓷砖，而且它们对您一次可以获得的数量有限制。
*   将拼贴拼接在一起以形成一个或多个更大的图像。
*   创建您自己的透明数据层。
*   在瓦片层上叠加透明数据层。
*   打印组合图层图像。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-06-25T10:01:51.120

也许[这个抓取器](http://www.codeproject.com/Articles/23865/Map-Grabber-on-C)会有所帮助。它只是从某个屏幕区域截取屏幕截图，然后拖动地图（通过模拟鼠标移动），制作另一个截图等。然后将截图拼接成一张图片。因此，它几乎可以抓取任何可以在浏览器中打开并通过鼠标移动的滑动地图（无需使用 API - 清晰的所见即所得）。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-06-25T16:25:02.237

您是否开始使用易滑的地图图块？如果没有，您可以使用更重量级的东西，例如 GIS（地理信息系统）包。[QGIS](http://www.qgis.org/)是一个很好的具有高分辨率打印功能的开源地图查看器/操纵器，但周围还有其他的。

对于这些，您可以[导入代表地图的矢量数据](http://hub.qgis.org/projects/quantum-gis/wiki/Using_OpenStreetMap_data)（可通过 OSM 导出获得），并完全按照您的需要设置样式。然后有几个选项可以导出以进行高分辨率打印。

最终，您可能会在错误的地方问这个问题。您是否知道：[gis.stackexchange.com](http://gis.stackexchange.com)？

# c# - 如何将 jQuery 函数绑定到 C# 代码隐藏中动态创建的控件

> ID：10902075
> 
> 赞同：0
> 
> 时间：2012-06-05T17:34:10.627
> 
> 标签：c#, jquery, dynamic-controls

如果我在代码隐藏中动态创建一个控件，我将如何将 jQuery 内容绑定到该控件？

IE（这显然不起作用） mycontrol.Extend(".animate()");

谢谢！

***让我澄清一下 --- 我想从后面的代码将这些属性绑定到这个控件......所以

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-06-05T17:42:56.847

如果这是针对 WebForms 的，那么控件会使用`.ClientID`. 使用它，你可以有这样的东西......

```
var emailId = '#<%= EmailInput.ClientID %>';

$(function() {
    $(emailId) // ...
}); 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-06-05T17:38:45.543

您必须找出控件的客户端 ID（它使用的 ID）。
根据您使用的 ASP.NET 版本，这可能会发生变化。

如果您使用 DOM 检查器，您可以找到此信息，然后您可以正常使用该元素。

```
// Check if DOM is ready (eg. everything has been rendered)
$(function() {
   // Do stuff with the elements
   $('#myControlsClientID').animate();
}); 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-06-05T17:43:22.027

一种简单的方法是将 CSSClass 属性分配给动态创建的控件并使用 jQuery 定位这些类

# jquery - 如何使用 jQuery 选择子元素但只有一层

> ID：10902077
> 
> 赞同：19
> 
> 时间：2012-06-05T17:34:15.190
> 
> 标签：jquery

鉴于这种：

```
<div id="div1">
    <div id="div2">
        <div id="div200">
            <div id="div3" class="b">       
            </div>
            <div id="div300">
                <div id="div4" class="b">
                     <div id="div5"> 
                        <div id="div6" class="b">
                        </div>            
                     </div>
                </div>
            <div>
        <div>
    <div>
</div> 
```

我需要一种方法来找到属于“b”类的元素的子元素（深），而不是嵌套在匹配元素中的元素。

**测试用例：**

这就是我需要的：

情况1：

```
$("#div1").some_jquery_syntax(".b")
Should return:
div3, div4 
```

案例二：

```
$("#div5").some_jquery_syntax(".b")
Should return:
div6 
```

请注意，困难的部分是我必须从 div1 开始时跳过 div2。所以我不能只使用`$("#div1").find("> .b")`.

**我的尝试：**

我试过这个：

```
$("#div1").find(".b")
[<div id="div3" class="b"></div>, <div id="div4" class="b"></div>, <div id="div5" class="b"></div>] 
```

不好：我不想要 div5，因为它嵌套在 div4 中。

我试过这个：

```
$("#div0").find(".b").not(".b .b")
[<div id="div3" class="b"></div>, <div id="div4" class="b"></div>] 
```

从 div0 开始时可以，但从 div4 开始不起作用：

```
$("#div5").find(".b").not(".b .b")
[] 
```

* * *

## 回答 #1

> 赞同：17
> 
> 时间：2012-06-05T17:35:32.513

查找直系孙子：

```
​$("#div1").children().children(".b"); 
```

小提琴：http: [//jsfiddle.net/jonathansampson/Dy6GJ/](http://jsfiddle.net/jonathansampson/Dy6GJ/)

如果您不知道要走多远，但`.b`不希望所有内容都在 a 内`.b`，请在尊重父母限制的同时使用过滤器。您可以使用以下`.parentsUntil`方法：

```
var parent = "#div1";
$(".b", parent).filter(function(){
    return !$(this).parentsUntil(parent, ".b").length;
}).css("border", "1px solid red");​​​​​​​​​​​​​​​​​ 
```

小提琴：http: [//jsfiddle.net/jonathansampson/Dy6GJ/3/](http://jsfiddle.net/jonathansampson/Dy6GJ/3/)

* * *

## 回答 #2

> 赞同：5
> 
> 时间：2012-10-08T21:12:08.757

一般（当只能保证等级时）：

```
$("#div1").find(".b:not(.b .b)") 
```

如上所述（可能比一般更快，但未经测试）：

```
$("#div1").find("div.b:not(div.b div.b)") 
```

“所有 .b 不是 .b 的后代”

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2019-03-16T12:13:53.557

你离最快的解决方案不远了，问题是

```
$("#div5").find(".b").not(".b .b") 
```

是***`.not`***不是与您的初始选择器无关（例如：）*`#div5`*，并且由于在 DOM 树中有一个*`.b`*父*`#div6`*级，它将被排除在外（父级是*`#div4`*）

然后解决方案是让你的***`.not`***相对于你的选择器

这将正确选择*`#div6`*：

```
$("#div4").find(".b").not("#div4 .b .b") 
```

这将正确选择*`#div3`*和*`#div4`*：

```
$("#div1").find(".b").not("#div1 .b .b") 
```

您可能还对[这个递归迭代器函数感兴趣](http://jsfiddle.net/mpauzt6h/3/)

它将以当前元素和深度作为参数调用回调函数，递归可以使用 asc 参数进行升序或降序，您还可以指定最大递归深度

在 desc 模式下，如果您的回调返回 false，则迭代立即停止

# reflection - Lua - 反射 - 函数参数和文档字符串？

> ID：10902079
> 
> 赞同：2
> 
> 时间：2012-06-05T17:34:18.973
> 
> 标签：reflection, lua

我从 Python 来到 Lua。我正在使用 Lua C API。我想知道是否有一种标准方法可以将一些参数和使用信息与方法捆绑在一起，并将其与标准`help()`或类似的方法联系起来`<method>.__doc__()`。

我的一些想法：

1）以某种方式将文档放入库元表中并让用户使用`pairs()`：

```
static const luaL_Reg lua_mylib_funcs[] = {
    ...
    {NULL, NULL}}; 
```

2) 在无参数调用方法时打印一些使用信息。

3）为库创建一个`.help()`或一个`.docs()`方法。

有人可以指出“Lua-ish”的方向吗？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-06-06T06:03:36.727

> 我想知道是否有**一种标准方法**可以将一些参数和使用信息与方法捆绑在一起

没有。

> 以某种方式将文档放入库元表中并让用户使用pairs()：

您可以建立一个约定，如果方法名称是`foo`您存储文档`foo_docs`或类似的东西。

```
x.foo_docs = "returns the sum of three numbers"
function x:foo(a,b,c)
   return a + b + c
end 
```

> 在没有参数的情况下调用方法时打印一些使用信息。

这将阻止您创建没有参数的方法。

> 有人可以指出“Lua-ish”的方向吗？

如果不知道您为什么需要它以及您希望它如何工作，这很难*说*。要获得类似的东西，`<method>.__doc__`您可以将方法（即函数）转换为可调用表，这样您就可以对其进行索引并存储所需的任何元数据，但这会很丑陋并且需要为每个方法创建一个新表。例如，这将允许您将方法转换为可调用表：

```
local documentMethodMetatable = {}
function documentMethodMetatable.__call(t,...)
  return t.method(...)
end
function documentMethod(method, doc)
  return setmetatable({ method=method, doc=doc}, documentMethodMetatable)
end 
```

然后你可以写这样的东西：

```
local foo = {name="Donut"}
function foo:sum(a,b,c)
  print(self.name .. " says the sum is " .. (a + b + c))
end

foo.sum = documentMethod(foo.sum, "Receives three arguments and prints their sum.")

foo:sum(2,2,3)     --> call sum
print(foo.sum.doc) --> index sum to get docs 
```

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-06-06T06:03:59.783

我[在 lua-users wiki 看到了这个解决方案](http://lua-users.org/wiki/DecoratorsAndDocstrings)，如果这就是你要找的？

# c# - 无法读取最近添加到 SQL Server Compact Edition 的内容

> ID：10902081
> 
> 赞同：0
> 
> 时间：2012-06-05T17:34:23.207
> 
> 标签：c#

我正在尝试实现一个函数来查看最近添加到 SQL Server CE 数据库的项目：

```
private void BackButt_Click(object sender, EventArgs e)
{
   try
   {
       SqlCeDataReader myReader = null;

       SqlCwCommand cm = new SqlCeCommand("SELECT MAX(TS_Process) AS Expr1, MAX(TS_Verify) AS Expr2 FROM TestStep", cn)

       myReader = cm.ExecuteReader();

       while (myReader.Read())
       {
           stepTB.Text = myReader.GetString(0);
           ExpectedTB.Text = myReader.GetString(1);
       }
    }      
    catch (SqlCeException ex)
    {
        MessageBox.Show(ex.Message);
    } 
```

连接在表单加载时打开。

这仅显示最后一个条目，而不显示所有以前的条目。

任何帮助将不胜感激。

谢谢

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-06-05T18:36:12.563

快速简便的修复，下面的代码将按照您的要求进行，尽管这不是您想要使用它的方式。

```
 while (myReader.Read())
         {
          stepTB.Text += myReader.GetString(0) + " ";

          ExpectedTB.Text += myReader.GetString(1) + " ";
         } 
```

如果您想要一个实际的概述，请查找数据控件，例如[repeaters](http://www.netrostar.com/Tutorials-91-ASP.NET%20Tutorial.%20How%20to%20use%20Repeater)和[gridviews](http://asp-net-example.blogspot.be/2008/10/gridview-example-how-to-use-gridview-in.html)。

# java - Android 要求合规级别为 5.0 或 6.0

> ID：10902082
> 
> 赞同：1
> 
> 时间：2012-06-05T17:34:26.460
> 
> 标签：java, android, eclipse

> **可能重复：**
> [Android 要求编译器合规级别为 5.0 或 6.0。而是找到了“1.7”。请使用 Android 工具 > 修复项目属性](https://stackoverflow.com/questions/7637144/android-requires-compiler-compliance-level-5-0-or-6-0-found-1-7-instead-plea)

我已将这行代码添加到我的 android 应用程序中：

```
ArrayList<hashmap<string, string="">> mylist = new ArrayList<hashmap<string, string="">>(); 
```

它已在其他人的应用程序中运行，但在我的应用程序中，它旁边出现了一个红十字，当我将鼠标悬停在它上面时，它会说：

```
Multiple markers at this line
- Syntax error on token ">>", invalid AssignmentOperator
- Syntax error on token ",", TypeArgument2 expected after this token
- Syntax error on tokens, delete these tokens 
```

我在控制台上也显示了一个错误：

```
Android requires compiler compliance level 5.0 or 6.0\. Found '1.7' instead. Please use Android Tools > Fix Project Properties. 
```

我试过了：

项目 -> android 工具 -> 修复项目属性，

项目->清洁，

项目 -> 属性 -> java 编译器 -> 编译器合规级别（当前设置为 1.5，但已尝试 1.6 和 1.7 且未修复）

请帮忙 ：（

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-06-05T17:36:06.890

首先，你应该阅读 [Java 集合和泛型](https://www.google.co.in/#hl=en&output=search&sclient=psy-ab&q=java+collections+and+generics&oq=java+collections+and+generics&aq=f&aqi=g2g-K2&aql=&gs_l=hp.3..0l2j0i30l2.826.826.0.1746.1.1.0.0.0.0.186.186.0j1.1.0...0.0.rR0l6ahF2W8&pbx=1&bav=on.2,or.r_gc.r_pw.r_cp.r_qf.,cf.osb&fp=c4df1154fc64158&biw=1280&bih=923)

```
ArrayList<HashMap<String, String>> mylist = new ArrayList<HashMap<String,String>>(); 
```

并设置 Compliance level `1.6`，因为 1.7 尚不兼容。Java 1.5 给出`@Override`注释错误。因为`@Override`在 1.6 中引入。

```
project -> properties -> java compiler -> compiler compliance level->Set it at 1.6 
```

# android - 为什么我的 ListView/Dialog 不透明？

> ID：10902085
> 
> 赞同：2
> 
> 时间：2012-06-05T17:34:33.567
> 
> 标签：android, android-listview, android-fragments, android-alertdialog

编辑〜找到解决方案并在下面的回复中（现在的最后回复），但直到两天后我才能将其标记为问题的答案。同时，我会在此处保留此编辑，直到我可以将其标记为正确为止。

调用对话框的位置：

```
public OnClickListener fieldListener = new OnClickListener() {
    public void onClick(View v) {
        FragmentManager fm = getSupportFragmentManager();
        switch (v.getId()) {
        case (0) :

        ChooseDialog ageDialog = new ChooseDialog("Age", ageEditText, act);
        ageDialog.show(fm, "fragment_edit_name"); 
```

对话框：

```
public class ChooseDialog extends DialogFragment implements DialogInterface.OnClickListener, OnMultiChoiceClickListener {

public Dialog onCreateDialog(Bundle savedInstanceState) {
        LayoutInflater inflater = (LayoutInflater) activity.getSystemService(Context.LAYOUT_INFLATER_SERVICE);
        View dialogLayout = inflater.inflate(R.layout.dialog, null);

        AlertDialog.Builder builder;
        switch (editText.getId()) {
        case (0) :
            ListView list = (ListView) dialogLayout.findViewById(R.id.listView1);
        list.setAdapter(new ArrayAdapter<String>(activity, R.layout.dialoglist, 
                activity.getResources().getStringArray(R.array.ageArray)));
        list.setBackgroundColor(00000000);
        builder = new AlertDialog.Builder(activity);
        builder.setTitle(type);
        builder.setNegativeButton("Cancel", this);
        builder.setView(dialogLayout);
        /* builder.setAdapter(new ArrayAdapter<String>(activity, R.layout.dialoglist, 
                    activity.getResources().getStringArray(R.array.ageArray)), 
                    new DialogInterface.OnClickListener() {
                public void onClick(DialogInterface dialog, int which) {
                    editText.setText(activity.getResources().getStringArray(R.array.ageArray)[which]);
                }} 
                );*/
        return builder.create(); 
```

对话框.xml：

```
<?xml version="1.0" encoding="UTF-8"?>
<ListView xmlns:android="http://schemas.android.com/apk/res/android"
    android:id="@+id/listView1"
    android:background="#00000000"
    android:cacheColorHint="#00000000"
    android:layout_width="match_parent"
    android:layout_height="wrap_content" >
</ListView> 
```

DialogList.xml（只是适配器的文本视图）：

```
<?xml version="1.0" encoding="utf-8"?>
<TextView xmlns:android="http://schemas.android.com/apk/res/android"
    android:id="@android:id/text1"
    android:layout_width="match_parent"
    android:layout_height="match_parent"
    android:gravity="center_vertical"
    android:minHeight="?android:attr/listPreferredItemHeight"
    android:paddingLeft="6dip"
    android:textColor="@color/androidBlue"
    android:paddingRight="10dip"
    android:layout_weight="1"
    android:textAppearance="?android:attr/textAppearanceLarge" /> 
```

![在此处输入图像描述](../Images/ef08157ed0981e1d076eacc4baebfc34.png)

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-06-05T17:37:33.433

尝试

```
list.setBackgroundColor(Color.TRANSPARENT); 
```

**编辑：**

在浏览几期 ICS 时，我遇到了[这个](http://code.google.com/p/android/issues/detail?id=19510)问题，我认为这可能是 ICS 的问题。认为这个问题与问题*无关*，但它表明开发人员在设置背景时遇到了问题。

随时欢迎指正。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-06-05T20:45:12.827

我的解决方案：更改 AlertDialog.Builder 构造函数以使用带有 Context, Theme 的构造函数：

```
builder = (Integer.parseInt(android.os.Build.VERSION.SDK) < 11)? new AlertDialog.Builder(activity) : 
        new AlertDialog.Builder(activity, android.R.style.Theme_Translucent); 
```

这确保它在 Ginger 上加载透明（通过 XML 中的透明行）；和半透明的 ICS。主要问题是对话框正面和负面按钮与我的 UI 不匹配。在接下来的几天里，我将在那里开发一个解决方案。

另一个问题是使用`builder.setMultiChoiceItems(), null, this);`而不是列表。这使得它在整个对话区域具有全白色背景。我也希望在这里发现一个主题方法，但除此之外，我所有的对话框看起来都是我现在想要的方式：P

在这里找到的解决方案：[https ://stackoverflow.com/a/8687164/1231943](https://stackoverflow.com/a/8687164/1231943)

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-06-05T18:07:08.193

对于 XML：

```
android:background="@android:color/transparent"
android:cacheColorHint="@android:color/transparent" 
```

# ios - 设置 TableView 在屏幕上的位置

> ID：10902091
> 
> 赞同：0
> 
> 时间：2012-06-05T17:35:09.173
> 
> 标签：ios, tableview

我正在尝试在屏幕上设置表格视图的位置，我尝试在 IB 上执行此操作，但它似乎不起作用是否有办法以编程方式执行此操作，或者我在 IB 中遗漏了某些内容我设置了视图部分的 X 和 Y 显示表格视图正在移动，但是当我运行应用程序时它不起作用。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-06-05T18:12:00.223

如果您使用的是 a`UITableViewController`那么您将无法更改 the 的位置，`UITableView`因为您的应用程序的主视图将是`UITableView`

相反，您必须将类更改`UITableViewController`为`UIViewController` 然后在 xib 文件中，`UITableView`在主视图中放置一个，然后更改 x 和 y 这样它应该可以工作

# c++ - C++ 静态成员的多个实例

> ID：10902092
> 
> 赞同：0
> 
> 时间：2012-06-05T17:35:09.920
> 
> 标签：c++, class, static

> **可能重复：**
> [存储此指针以在 WndProc 中使用的最佳方法](https://stackoverflow.com/questions/117792/best-method-for-storing-this-pointer-for-use-in-wndproc)

我正在尝试编写一个处理 Win32 控件的通用类，问题是，WndProc 消息处理函数是静态的，因此我无法从函数访问重要的本地类成员，例如 hWnd，除非我也将它们设为静态并实例化它们全局命名空间。

现在我确实尝试了，但很快发现在我创建控件类的另一个实例的那一刻，之前创建的实例的静态成员值被新的实例覆盖了。有人知道如何实现这个类吗？是否有可能以某种方式拥有一个静态成员的多个实例？

谢谢，

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-06-05T17:51:13.690

使用静态 WndProc 作为代理函数，该函数调用传递给静态 WndProc 的特定对象实例。我通常使用 GetWindowLongPtr 和 SetWindowLongPtr API 来存储指向创建窗口的实例的指针。

# c# - 使用 smtp.gmail.com 时出现 System.Security.SecurityException

> ID：10902095
> 
> 赞同：1
> 
> 时间：2012-06-05T17:35:26.153
> 
> 标签：c#, .net, smtp

使用[这篇读得很好的帖子中的代码时](https://stackoverflow.com/questions/32260/sending-email-in-net-through-gmail)

```
var smtp = new SmtpClient
{
    Host = "smtp.gmail.com",
    Port = 587,
    EnableSsl = true,
    DeliveryMethod = SmtpDeliveryMethod.Network,
    UseDefaultCredentials = false,
    Credentials = new NetworkCredential("my email", "my password")
}; 
```

我经常收到 System.Security.SecurityException: Request for the permission of type 'System.Net.Mail.SmtpPermission.

这段代码是否必须在某些特殊的托管环境中使用，或者我是否遗漏了一些明显的东西？

谢谢！

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-06-05T17:40:56.987

发送电子邮件取决于 SMTP 服务器的配置方式。

```
According to gmail confiruged You need to remove this line of code 
```

`UseDefaultCredentials = false;`

只需评论此行，您的消息就会被发送。

```
 var smtp = new SmtpClient
        {
            Host = "smtp.gmail.com",
            Port = 587,
            EnableSsl = true,
            DeliveryMethod = SmtpDeliveryMethod.Network,
            // do not use this command
           // UseDefaultCredentials = false,
            Credentials = new NetworkCredential("username", fromPassword)
        }; 
```

Microsoft 建议尽可能不要使用 defaultcredentials。请参阅[此](http://msdn.microsoft.com/en-us/library/system.net.webclient.usedefaultcredentials%28v=vs.100%29.aspx)链接以进行说明。

# logging - 当 ColdFusion 最大化 CPU 时，我如何找出它正在咀嚼/窒息的东西？

> ID：10902098
> 
> 赞同：10
> 
> 时间：2012-06-05T17:35:36.183
> 
> 标签：logging, coldfusion, coldfusion-9, ubuntu-11.10, jrun

我在“中”Amazon EC2 实例上的 Ubuntu 上运行 CF 9.0.1。CF 一直在间歇性地占用（每天几次......但特别是不孤立于高峰使用时间）。在这种时候，运行**top**让我得到这个（或类似的东西）：

```
PID     USER    PR  NI  VIRT    RES     SHR S   %CPU    %MEM    TIME+COMMAND
15855   wwwrun  20  0   1762m   730m    20m S   99.3    19.4    13:22.96 coldfusion9 
```

因此，它显然消耗了大部分服务器资源。在每次占用之前，我的 cfserver.log 中都出现了以下错误：

```
java.lang.RuntimeException: Request timed out waiting for an available thread to run. You may want to consider increasing the number of active threads in the thread pool. 
```

如果我运行**/opt/coldfusion9/bin/coldfusion status**，我会得到：

```
Pg/Sec  DB/Sec  CP/Sec  Reqs  Reqs  Reqs  AvgQ   AvgReq AvgDB  Bytes  Bytes 
Now Hi  Now Hi  Now Hi  Q'ed  Run'g TO'ed Time   Time   Time   In/Sec Out/Sec
0   0   0   0   -1  -1  150   25    0     0      -1352560      0      0 
```

在管理员中，在*Server Settings > Request Tuning下，**同时模板请求的最大数量*设置为25。所以到目前为止这是有意义的。我可以增加线程池来覆盖这些负载峰值。我可以做到 200。（我刚才做了测试。）

但是，还有这个文件*/opt/coldfusion9/runtime/servers/coldfusion/SERVER-INF/jrun.xml*。那里的一些设置似乎有冲突。例如，它写道：

```
<service class="jrunx.scheduler.SchedulerService" name="SchedulerService">
  <attribute name="bindToJNDI">true</attribute>
  <attribute name="activeHandlerThreads">25</attribute>
  <attribute name="maxHandlerThreads">1000</attribute>
  <attribute name="minHandlerThreads">20</attribute>
  <attribute name="threadWaitTimeout">180</attribute>
  <attribute name="timeout">600</attribute>
</service> 
```

哪个 a) 具有较少的活动线程（这是什么意思？），和 b) 具有超过管理员中设置的同时请求限制的最大线程。所以，我不确定。这些独立的配置需要手动匹配吗？还是在进行更改时应该由 CF 管理员编写*jrun.xml文件？*唔。但也许这是不同的，因为大概 CF 调度程序应该只使用所有可用线程的一个子集，对吧？...所以我们总是有一些线程供真实用户使用？我们也有这个：

```
<service class="jrun.servlet.http.WebService" name="WebService">
  <attribute name="port">8500</attribute>
  <attribute name="interface">*</attribute>
  <attribute name="deactivated">true</attribute>
  <attribute name="activeHandlerThreads">200</attribute>
  <attribute name="minHandlerThreads">1</attribute>
  <attribute name="maxHandlerThreads">1000</attribute>
  <attribute name="mapCheck">0</attribute>
  <attribute name="threadWaitTimeout">300</attribute>
  <attribute name="backlog">500</attribute>
  <attribute name="timeout">300</attribute>
</service> 
```

当我更改 CF Admin 设置时，这似乎已经改变......也许......但它是与我的新最大同时请求设置匹配的*activeHandlerThreads* ......而不是*maxHandlerThreads*，它再次超过了它。最后，我们有这个：

```
<service class="jrun.servlet.jrpp.JRunProxyService" name="ProxyService">
  <attribute name="activeHandlerThreads">200</attribute>
  <attribute name="minHandlerThreads">1</attribute>
  <attribute name="maxHandlerThreads">1000</attribute>
  <attribute name="mapCheck">0</attribute>
  <attribute name="threadWaitTimeout">300</attribute>
  <attribute name="backlog">500</attribute>
  <attribute name="deactivated">false</attribute>
  <attribute name="interface">*</attribute>
  <attribute name="port">51800</attribute>
  <attribute name="timeout">300</attribute>
  <attribute name="cacheRealPath">true</attribute>
</service> 
```

所以，我不确定我应该更改哪些（如果有的话）以及最大请求和最大线程之间的确切关系。此外，由于其中几个将*maxHandlerThreads*列为 1000，我想知道是否应该将最大同时请求数设置为 1000。必须有一些上限取决于可用的服务器资源......但我不确定是什么它是，我真的不想玩它，因为它是一个生产环境。

我不确定它是否与这个问题有关，但是当我运行**ps aux | grep Coldfusion**我得到以下信息：

```
wwwrun   15853  0.0  0.0   8704    760    pts/1     S   20:22   0:00 /opt/coldfusion9/runtime/bin/coldfusion9 -jar jrun.jar -autorestart -start coldfusion
wwwrun   15855  5.4 18.2   1678552 701932 pts/1     Sl  20:22   1:38 /opt/coldfusion9/runtime/bin/coldfusion9 -jar jrun.jar -start coldfusion 
```

总是有这两个，永远不会超过这两个过程。因此，进程和线程之间似乎没有一对一的关系。我记得在我维护多年的 MX 6.1 安装中，在进程列表中可以看到额外的 CF 进程。当时在我看来，每个线程都有一个进程......所以要么我错了，要么版本 9 中的某些东西完全不同，因为它报告了 25 个正在运行的请求并且只显示这两个进程。如果单个进程可以在后台有多个线程，那么我会想知道为什么我有两个进程而不是一个？...只是好奇。

所以，无论如何，我在撰写这篇文章时一直在尝试。如上所述，我将最大同时请求数调整为 200。我希望这能解决我的问题，但 CF 再次崩溃（相反，它停滞不前并且请求开始超时......所以有效地“崩溃”了）。这一次，top 看起来很相似（仍然消耗超过 99% 的 CPU），但 CF 状态看起来不同：

```
Pg/Sec  DB/Sec  CP/Sec  Reqs  Reqs  Reqs  AvgQ   AvgReq AvgDB  Bytes  Bytes
Now Hi  Now Hi  Now Hi  Q'ed  Run'g TO'ed Time   Time   Time   In/Sec Out/Sec
0   0   0   0   -1  -1  0     150   0     0      0      0      0      0 
```

显然，由于我增加了最大同时请求数，它允许更多请求同时运行……但它仍然使服务器资源最大化。

进一步的实验（重新启动 CF 后）向我表明，在大约 30-35 个“Reqs Run'g”之后，服务器变得无法使用，所有额外的请求都不可避免地超时：

```
Pg/Sec  DB/Sec  CP/Sec  Reqs  Reqs  Reqs  AvgQ   AvgReq AvgDB  Bytes  Bytes
Now Hi  Now Hi  Now Hi  Q'ed  Run'g TO'ed Time   Time   Time   In/Sec Out/Sec
0   0   0   0   -1  -1  0     33    0     0      -492   0      0      0 
```

因此，很明显，增加最大同时请求数并没有帮助。我想归根结底是这样的：它有什么困难？这些尖峰来自哪里？流量爆发？在哪些页面上？在任何给定时间正在运行哪些请求？我想我只需要更多信息来继续故障排除。如果有长时间运行的请求或其他问题，我不会在日志中看到它（尽管我确实在管理员中选中了该选项）。我需要知道哪些请求正是导致这些峰值的那些请求。任何帮助将非常感激。谢谢。

〜日

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-06-06T07:30:14.587

我有许多“生产中的高 CPU”类型的错误，我一直处理它们的方式是这样的：

1.  使用[jstack](http://docs.oracle.com/javase/1.5.0/docs/tooldocs/share/jstack.html) PID >> stack.log 转储 5 个堆栈跟踪，间隔 5 秒。走线数量和时序并不重要。

2.  [在Samurai](http://yusuke.homeip.net/samurai/en/index.html)中打开日志。每次进行转储时，您都会看到线程的视图。处理您的代码的线程启动 web-（用于使用内置服务器的请求）和 jrpp- 用于通过 Apache/IIS 进入的请求。

3.  阅读每个线程的历史。您正在寻找每个转储中非常相似的堆栈。如果一个线程看起来一直在处理同一个请求，那么在顶部附近变化的位将指向发生无限循环的位置。

随意在网上某处转储堆栈跟踪并将我们指向它。

我用来了解发生了什么的另一种技术是修改 apache 的 httpd.conf 以记录所用时间：%D 并记录会话 id：%{jsessionid}，它允许您在启动过程中跟踪单个用户挂起和用数据做一些漂亮的统计/图表（我使用[LogParser](http://www.microsoft.com/en-us/download/details.aspx?id=24659)处理数字并输出到 CSV，然后使用 Excel 来绘制数据）：

```
LogFormat "%h %l %u %t "%r" %>s %b %D %{jsessionid}" customAnalysis
CustomLog logs/analysis_log customAnalysis 
```

我刚刚记得的另一种技术是启用[CF Metrics](http://helpx.adobe.com/coldfusion/kb/enable-metrics-logging-coldfusion-mx.html)，它可以让您了解服务器在挂起时的运行状况。我将其设置为每 10 秒记录一次并将格式更改为 CSV，因此我可以从事件日志中 grep 指标，然后通过 Excel 运行它们以在崩溃前绘制服务器负载图。

巴尼

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-06-06T03:15:21.120

要找出使您的 procs 最大化的原因，需要大量系统“内部”的信息。从外部查看排队请求等内容很难做到这一点。有一件事是肯定的 - 将同时请求设置更改为非常高的数字不会起到作用:)它所要做的就是删除旨在保留的东西CF免于对*过多的*处理器感到沮丧。

这是我列出的最大程度利用 CPU 的事情。

*   注册表中的客户端变量。我有几篇关于为什么这个问题会突然“突然出现”的优秀文章。查看我的博客（coldfusion 缪斯）。
*   连接到数据库的间歇性问题。这实际上在云中有点恶化，其中网络和带宽使用限制可能会“限制”与数据库的连接。大多数 CF 应用程序大量使用数据库。如果某些东西干扰或减慢连接，结果是连接数会上升，直到达到该同时数，然后请求开始排队 - 但这个问题不一定与 CF 本身有关 - 这是一个症状。
*   JVM 问题 - 调整你的 JVM 来处理垃圾收集，有足够的 New 和 Perm gen 空间等是非常重要的......虽然坦率地说，上面的项目通常是第一个出错的。

发生这种情况还有许多其他原因 - 其中（如您所料）在某些脚本运行时出现的代码问题。长时间运行的请求、文件上传、繁重的计划任务、索引 bot 流量生成流量或产生太多会话……不胜枚举。

希望我提供的这份清单上的一些东西会尽可能地打动你。祝你好运。

（是的，FR 甚至 CF 监视器都是帮助您梳理这一切的好工具：）。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-06-05T21:38:15.750

几周前，我有一个服务器在 JRun 进程上不断地最大化 CPU 利用率，并会定期重新启动它，只是让它在 24 小时内恢复到 100%。我也对 JVM 设置等大惊小怪，直到最后发现，令我尴尬的是，我的代码中有一个无限循环。有一个 WHILE 循环，其条件永远不会满足。哎呀。

所以也许你在你的代码中犯了一个简单的错误，它与服务器配置无关，fwiw。

+1 用于 FusionReactor 演示。这至少会给你一些线索。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2012-06-06T12:31:02.393

您将不得不增加活动线程池的大小。请检查以下链接

[http://www.talkingtree.com/blog/index.cfm/2005/11/28/Request-timed-out-waiting-for-an-available-thread-to-run](http://www.talkingtree.com/blog/index.cfm/2005/11/28/Request-timed-out-waiting-for-an-available-thread-to-run)

[http://helpx.adobe.com/coldfusion/kb/coldfusion-mx-6-1-request.html](http://helpx.adobe.com/coldfusion/kb/coldfusion-mx-6-1-request.html)

快乐编码！！！

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2013-12-30T00:59:12.053

您是否尝试过使用 ColdFusion 附带的 ColdFusion Server 监视器？

# jquery - 扩展 jquery ui 对话框（添加更多选项）

> ID：10902099
> 
> 赞同：3
> 
> 时间：2012-06-05T17:35:37.613
> 
> 标签：jquery, dialog, jquery-ui-dialog, add, options

如何为 jQuery 对话框创建和添加新选项？例如：我喜欢通过设置选项可以控制标题栏的显示或关闭按钮的显示。

脚本将是这样的：

```
$("#message").dialog({
  showTitle:false,     //new option (hide Title bar)
  showCloseButton:true //new option (show close button)
  modal:true...        //other options
}) 
```

* * *

## 回答 #1

> 赞同：8
> 
> 时间：2014-01-06T04:13:09.603

从 jQuery UI 1.9 开始，您可以以更好的方式扩展小部件，而无需创建新的小部件。

[http://learn.jquery.com/jquery-ui/widget-factory/extending-widgets/](http://learn.jquery.com/jquery-ui/widget-factory/extending-widgets/)

请参阅 - 重新定义小部件。

```
$.widget( "ui.dialog", $.ui.dialog, {
    open: function() {
        console.log( "open" );
        return this._super();
    }
});

$( "<div>" ).dialog(); 
```

* * *

## 回答 #2

> 赞同：6
> 
> 时间：2012-06-05T18:09:56.213

这比我在评论中表达的要容易一些。

```
// store old method for later use
var oldcr = $.ui.dialog.prototype._create;
// add the two new options with default values
$.ui.dialog.prototype.options.showTitlebar = true;
$.ui.dialog.prototype.options.showClosebutton = true;
// override the original _create method
$.ui.dialog.prototype._create = function(){
    oldcr.apply(this,arguments);
    if (!this.options.showTitlebar) {
       this.uiDialogTitlebar.hide();
    }
    else if (!this.options.showClosebutton) {
       this.uiDialogTitlebar.find(".ui-dialog-titlebar-close").hide();
    }
};

// this is how you use it
$("<div />").dialog({
    showClosebutton: false
});
// or
$("<div />").dialog({
    showTitlebar: false
}); 
```

显然，如果隐藏了标题栏，关闭按钮也将被隐藏，因为它是标题栏的一部分。

# python - __setattr__ 和 self.__dict__ 之间的 Python 交互

> ID：10902107
> 
> 赞同：6
> 
> 时间：2012-06-05T17:36:11.427
> 
> 标签：python

如果我制作这样的类实例

```
class MyClass(object):
    pass
x = MyClass() 
```

然后我可以在 x 上设置属性，如下所示：

`x.myAttr = 1`或者`x.__setattr__('myAttr', 1)`

但是，如果我做一个 dict

```
d = {} 
```

我无法在其上设置属性。例如，如果我这样做

```
d.__setattr__('myAttr', 1) 
```

我得到错误“'dict'对象没有属性'myAttr'”如果我尝试也会发生同样的事情

```
d.myAttr = 1 
```

我注意到在 x.myAttr = 1 的情况下，实际发生的是

```
x.__dict__ 
```

用新密钥更新，所以它必须是

```
d.__setattr__ 
```

不起作用，因为 d 没有

```
d.__dict__ 
```

仅仅因为 d*是*一个字典。如果有人能彻底解释这里发生了什么，我将不胜感激。

所有 python 对象都有`.__dict__`吗？

为什么我尝试调用会`d.__setattr__`导致错误提示该属性不存在？

是否有我应该知道的内置类型的特定层次结构？一个简单的参考将不胜感激。

蟒蛇2.6.4

Windows XP 专业版 x64 SP2

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-06-05T17:51:12.370

`dict`实例没有属性`__dict__`，因此您不能为其分配属性。大多数 Python 的内置类（用 C 语言编写并以不同方式定义属性）没有。如果您 subclass `dict`，则子类将具有一个`__dict__`属性，然后您可以将属性添加到子类的实例中。

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2012-06-05T17:43:40.310

从 docs.python.org 复制粘贴：

> 每个模块的一个特殊属性是 __dict__。这是包含模块符号表的字典。修改这个字典实际上会改变模块的符号表，但是不能直接赋值给__dict__属性（可以写m.__ dict__['a'] = 1，它定义ma为1，但不能写m.__dict__ = {})。不建议直接修改 __dict__。

[http://docs.python.org/library/stdtypes.html](http://docs.python.org/library/stdtypes.html)

方法

两条线都做同样的事情：

```
x.__setattr__('a', b)
x.a = b 
```

像 __ add__ 是：

```
x.__add__(b)
x + b 
```

但是，您可以将 dict.__ setattr__ 函数重新定义为您想要的任何内容

编辑第三条评论：

```
class x(object):
    def __init__(self):
        pass
    def __setattr__(self, a, b):
        print "nope, i will not set the attribute %s = %s" % (a,b)

c = x()
c.a = 4
print c.__dict__ 
```

将打印“不，我不会设置属性 a = 4 并且`c.__dict__`不会有属性 'a'

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-06-05T17:43:30.810

异常说明：

```
>>> class C(object):
...     __slots__ = ('a', 'b')
... 
>>> c = C()
>>> c.a = 1
>>> c.t = 2
Traceback (most recent call last):
  File "<input>", line 1, in <module>
AttributeError: 'C' object has no attribute 't' 
```

[此处](http://docs.python.org/reference/datamodel.html#slots)描述的插槽

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2013-05-02T19:03:19.190

`self.__dict__`是一个`dict`。假设，`dict`也有一个`__dict__`，它的递归定义和事情不会工作:-)

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2015-10-27T15:31:26.623

如果你这样做`x.myAttr = 1`了，你就真的在做`x.__dict__['myAttr'] = 1`。如果你这样做了`x.__dict__.myAttr`，你会得到与`d.myAttr`. 这 。`attribute`赋值是为类定义的，但不是字典 - 字典赋值是 via `d['attribute']`。

# c# - 使用 OptionalField 的反序列化错误

> ID：10902108
> 
> 赞同：1
> 
> 时间：2012-06-05T17:36:12.840
> 
> 标签：c#, .net, mono

在我向类添加新的可选字段后，该类的先前序列化实例不再可反序列化。

假设我使用 BinaryFormatter 保存了一些 MyClass 实例：

```
[Serializable]
public class MyClass
{
    public MyType A;
} 
```

之后，MyClass 的第二次修订：

```
[Serializable]
public class MyClass
{
    public MyType A;

    [OptionalField(VersionAdded = 2)]
    public MyType NewField;
} 
```

现在旧对象不再可反序列化。我在尝试反序列化它们时获得的堆栈跟踪如下（配置文件是 .NET 4.0）：

```
System.ArgumentNullException: Value cannot be null.    
Parameter name: type    
   at System.Reflection.Assembly.GetAssembly(Type type)    
   at System.Runtime.Serialization.Formatters.Binary.BinaryConverter.GetParserBinaryTypeInfo(Type type, Object& typeInformation)    
   at System.Runtime.Serialization.Formatters.Binary.ObjectMap..ctor(String objectName, Type objectType, String[] memberNames, ObjectReader objectReader, Int32 objectId, BinaryAssemblyInfo assemblyInfo)    
   at System.Runtime.Serialization.Formatters.Binary.__BinaryParser.ReadObjectWithMap(BinaryObjectWithMap record)    
   at System.Runtime.Serialization.Formatters.Binary.__BinaryParser.Run()    
   at System.Runtime.Serialization.Formatters.Binary.ObjectReader.Deserialize(HeaderHandler handler, __BinaryParser serParser, Boolean fCheck, Boolean isCrossAppDomain, IMethodCallMessage methodCallMessage)    
   at System.Runtime.Serialization.Formatters.Binary.BinaryFormatter.Deserialize(Stream serializationStream, HeaderHandler handler, Boolean fCheck, Boolean isCrossAppDomain, IMethodCallMessage methodCallMessage)    
   at System.Runtime.Serialization.Formatters.Binary.BinaryFormatter.Deserialize(Stream serializationStream, HeaderHandler handler, Boolean fCheck, IMethodCallMessage methodCallMessage)    
   at System.Runtime.Serialization.Formatters.Binary.BinaryFormatter.Deserialize(Stream serializationStream, HeaderHandler handler, Boolean fCheck) 
```

我在 Internet 上找不到此堆栈跟踪或类似的堆栈跟踪。请注意，使用 Mono 运行软件时，相同的文件是可读的；-)。因此，我认为该问题可能与 .NET 错误有关。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-06-05T17:54:53.547

假设我有以下类类型。

```
[Serializable]
public class MyClass
{
    public MyType A;
}

[Serializable]
public class MyType
{
    public string Name { get; set; }
} 
```

让我们将 MyClass 的一个实例序列化为一个文件。

```
using (var stream = new FileStream(@"c:\temp\test.dat", FileMode.Create, FileAccess.Write))
{
    var formatter = new BinaryFormatter();
    formatter.Serialize(stream, new MyClass { A = new MyType { Name = "Christophe" } });
} 
```

现在我们将它反序列化回 MyClass 的一个实例。

```
using (var stream = new FileStream(@"c:\temp\test.dat", FileMode.Open, FileAccess.Read))
{
    var formatter = new BinaryFormatter();
    var myInstance = (MyClass) formatter.Deserialize(stream);
} 
```

没问题。一切正常。让我们向 MyClass 类型添加一个新字段。我建议您改用属性。

```
[Serializable]
public class MyClass
{
    public MyType A;

    [OptionalField]
    public MyType B;
} 
```

反序列化仍然可以正常工作。在我的情况下，B 的缺失数据被忽略，并将其设置为 null。

# php - 删除几个数组值

> ID：10902110
> 
> 赞同：-1
> 
> 时间：2012-06-05T17:36:23.530
> 
> 标签：php, arrays

我需要帮助来创建跳过规则

我有 15 行的数组，需要从数组中跳过几行。（跳过值由用户提供）

我在数组跳过中遇到问题，如果用户提供 1 个跳过，则只需要删除 1 行，但函数下方的 2 行将被删除

案例：user1 想要跳过 2 行，user2 想要从给定的 15 行中跳过 1 行 2 跳过删除 3 行，1 跳过删除 2 行

```
function array_delete($idx, $array) {
                for ($i = 0; $i <= $idx; $i++) {
                    unset($array[$i]);
                }
                return (is_array($array)) ? array_values($array) : null;
            }
$numberSkip = 1;
$skipnumber = $skipnumber - $numberSkip;
$Arrayvalue = array_delete($skipnumber, $Array); 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-06-05T17:39:50.690

改变

```
for ($i = 0; $i <= $idx; $i++) 
```

进入

```
for ($i = 0; $i < $idx; $i++) 
```

Using`<=`会使你的循环运行一次太多：如果`$idx = 1`然后循环将运行 for `$i = 0`and `$i = 1`。更改`<=`为`<`将解决此问题，并使您的循环运行所需的次数。

# jquery - Firefox 扩展中的 JQuery 错误

> ID：10902111
> 
> 赞同：-1
> 
> 时间：2012-06-05T17:36:26.203
> 
> 标签：jquery, jquery-ui, firefox, jquery-plugins, firefox-addon

```
var $j;
$j = jQuery.noConflict();    
$j(<button id="find" label="AdWords OK"/>).append("#:ne"); 
```

当我在 Firefox 扩展程序中运行它时，我收到错误“i.createDocumentFragment 不是函数”。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-06-05T17:38:53.097

```
$j('<button id="find" label="AdWords OK"/>').append("#:ne"); 
```

需要报价吗？

编辑

哦，在#ne之后添加它，然后

```
$j('#ne').after('<button id="find" label="AdWords OK"/>'); 
```

# facebook - Facebook - 如何为特定帖子点赞？

> ID：10902115
> 
> 赞同：0
> 
> 时间：2012-06-05T17:36:39.750
> 
> 标签：facebook, facebook-opengraph

我有一个类似推特的应用程序，它显示了很多帖子。我希望用户能够喜欢单个帖子，当他这样做时，帖子将显示在他的墙上。我想显示帖子、照片和链接。使用 C#、MVC，我应该从哪里开始？

我使用 Open Graph 协议让用户喜欢我的网站。我如何为单个帖子做到这一点？

谢谢，克鲁维

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-06-05T17:40:17.890

> 我如何为单个帖子做到这一点？

首先，使该帖子可通过特定 URL 访问。

# codeigniter - 在 Codeigniter 中使用多个库

> ID：10902118
> 
> 赞同：0
> 
> 时间：2012-06-05T17:37:03.887
> 
> 标签：codeigniter

我正在尝试在 CI 中加载多个库，但出现错误。这是我的控制器

```
function index()
{                   
    $this->load->library('materials_library/File_Manager');
    $this->load->library('materials_library/Layout');

    $data = array();

    // Send content to template
    $this->layout->view('materials_library/file_manager', $data, 'ml_cms');
} 
```

错误说 view 是一个未定义的属性。如果我注释掉第一个`load->library`，我不会收到错误消息。如何在 CI 中加载多个库？

编辑：

```
class File_manager
{
    private $CI;

    public function __construct()
    {
        $this->CI =& get_instance();
    }
} 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-06-05T17:52:21.823

要加载多个，只需将它们放入一个数组中：

```
$this->load->library( array('materials_library/File_Manager', 'another/library') ); 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2019-04-16T13:19:46.630

在 codeigniter 中，可以通过将库数组传递给 load 方法来同时加载多个库，请参见下面的示例：

```
$this->load->library(['email', 'table']); 
```

参考：[库的 Codeigniter 文档](https://www.codeigniter.com/user_guide/libraries/loader.html)

# objective-c - 如何使用 TWRequest 更改头像

> ID：10902120
> 
> 赞同：1
> 
> 时间：2012-06-05T17:37:06.057
> 
> 标签：objective-c, ios, twitter, twrequest

如何使用 TWRequest 更改个人资料图片，我使用此代码发布到 timeLine

-(IBAction)postToTwitter { ACAccountStore *account = [[ACAccountStore alloc] init]; ACAccountType *accountType = [帐户 accountTypeWithAccountTypeIdentifier:ACAccountTypeIdentifierTwitter];

```
// Request access from the user to access their Twitter account
[account requestAccessToAccountsWithType:accountType withCompletionHandler:^(BOOL granted, NSError *error) 
 {
     // Did user allow us access?
     if (granted == YES)
     {
         // Populate array with all available Twitter accounts
         NSArray *arrayOfAccounts = [account accountsWithAccountType:accountType];

         // Sanity check
         if ([arrayOfAccounts count] > 0) 
         {
             // Keep it simple, use the first account available
             ACAccount *acct = [arrayOfAccounts objectAtIndex:0];

             // Build a twitter request

            //http://api.twitter.com/1/account/update_profile_image.json  
             //https://upload.twitter.com/1/statuses/update_with_media.json

             TWRequest *postRequest = [[TWRequest alloc] initWithURL:[NSURL URLWithString:@"https://upload.twitter.com/1/statuses/update_with_media.json"] parameters:nil requestMethod:TWRequestMethodPOST];

             //NSData *myData = UIImagePNGRepresentation(self.selectedImage);
            NSData *myData =  UIImageJPEGRepresentation(self.selectedImage, 0.5);

             [postRequest addMultiPartData:myData withName:@"media" type:@"image/jpg"];

             [postRequest setAccount:acct];

             // Block handler to manage the response
             /*      
              [postRequest addMultiPartData:[base64 dataUsingEncoding:NSUTF8StringEncoding] // base64 is an NSString of the encoded image

              withName:@"image"

              type:@"multipart/form-data"];

              // Post the request*/

             [postRequest performRequestWithHandler:^(NSData *responseData, NSHTTPURLResponse *urlResponse, NSError *error) 
              {
                  NSLog(@"Twitter response, HTTP response: %i", [urlResponse statusCode]);
              }
              ];

     }
    }
 }]; 
```

}

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-06-10T21:59:18.743

我也为此苦苦挣扎，使用 Apple 的 WWDC11 幻灯片作为指南，但似乎 Twitter 从那时起更改了 API（或者幻灯片有错误）。

解决方案很简单：您需要使用“图像”而不是“媒体”的多部分数据名称。而且我认为类型应该是“image/jpeg”，而不是“image/jpg”。

因此，如下更改该行：

```
[postRequest addMultiPartData:myData withName:@"image" type:@"image/jpeg"]; 
```

# maven - ReplacementDataSet 与 Maven DBUnit 插件

> ID：10902126
> 
> 赞同：0
> 
> 时间：2012-06-05T17:37:37.170
> 
> 标签：maven, junit, dbunit

我想将 ReplacementDataSet 与 DbUnit 一起使用，以便在构建时我可以解析我的 testdata.xml 文件并过滤一些数据值。

例如，能够做这样的事情会很好：

```
ReplacementDataSet rds = new ReplacementDataSet(ds);

rds.addReplacementObject("[NULL]", null);
rds.addReplacementObject("[NOW]", dbUnitDateFormat(DateUtils.addDays(new Date(), 0))); 
```

但是，maven dbunit 插件不允许我覆盖 FlatXmlDataSetBuilder 或插入任何类型的替换数据集类。有什么建议吗？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-06-05T19:12:42.487

Maven dbunit 插件非常基础。dbunit ANT 任务允许一些额外的配置行为，但它也无法访问全部的 dbunit 功能。

最好的建议是在您的单元测试中声明使用此数据集。

# quicktime - 无法在动态创建的 Object 标签中播放 QT

> ID：10902129
> 
> 赞同：0
> 
> 时间：2012-06-05T17:37:55.460
> 
> 标签：quicktime, object-tag

我正在尝试通过动态创建 OBJECT 标记来让 Quicktime 插件播放 rtsp 流。我的页面包含一个带有事件处理程序的网格，用于捕获行单击事件以生成标记。Quicktime 徽标出现，但不播放。然而，当我在表格中对代码段进行硬编码时，流就会播放。有没有办法让 QT 播放流媒体？

```
grid.connect(grid, 'onClick', function(item) {
        var videoTag = '<OBJECT classid="clsid:02BF25D5-8C17-4B23-BC80-D3488ABDDC6B" id="qt"';
        videoTag += ' codebase="http://www.apple.com/qtactivex/qtplugin.cab"';
        videoTag += ' id="qt" width="180" height="196"';
        videoTag += '<param name="src" value="resources/images/ClickToPlay.png"/>';
        videoTag += '<param name="href" value="rtsp://172.21.57.125/archive/43137b8fa05eb1"/>';
        videoTag += '<param name="autohref" value="true"/>';
        videoTag += '<param name="target" value="myself"/>';
        videoTag += '<param name="controller" value="false"/>';
        videoTag += '</OBJECT>';

        dojo.place(videoTag, dojo.byId("player"), "only");
});

<div id="wrapper">
        <table align="center" border="1" spacing="2" style="width:100%; height:200px;">
            <tr><td id="player" align="center">
                Content goes here
            </td></tr>
        </table>
</div> 
```

提前致谢。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-06-11T11:32:41.333

我懂了 ！！我从服务器加载了一个 iframe，其中 src 是动态构建的。加载时的 Iframe 调用此 url，其中服务器创建 OBJECT 元素，流 id 作为 RESTful 参数发送。

第一次调用：@RequestMapping(value="/playback/{id}")

```
PrintWriter out = response.getWriter();
out.println("<iframe id=\"qtiframe\" src=\"resession/stream/" + id + "\" frameborder=\"0\" width=\"1000\" height=\"200\"></iframe>"); 
```

第二次调用：@RequestMapping(value="/stream/{id}")

```
PrintWriter out = response.getWriter();
out.println("<html><body>");
out.println("<div id=\"wrapper\">");
out.println("<table align=\"center\" border=\"0\" spacing=\"0\" style=\"width:100%; height:160px;\">");
out.println("<tr><td id=\"player\" align=\"center\">");
out.println("<OBJECT classid=\"clsid:02BF25D5-8C17-4B23-BC80-D3488ABDDC6B\" id=\"qt\"");
out.println(" codebase=\"http://www.apple.com/qtactivex/qtplugin.cab\"");
out.println(" id=\"qt\" width=\"200\" height=\"156\"");
out.println("<param name=\"src\" value=\"images/ClickToPlay.png\"/>");
out.println("<param name=\"href\" value=\"rtsp://172.21.57.125/archive/" + id + "\"/>");
out.println("<param name=\"autohref\" value=\"true\"/>");
out.println("<param name=\"target\" value=\"myself\"/>");
out.println("<param name=\"controller\" value=\"false\"/>");
out.println("</OBJECT>");
out.println("</td></tr>");
out.println("</table>");
out.println("</div>");
out.println("</body></html>"); 
```

# asp.net-mvc - 如何动态设置属于模型的标签？

> ID：10902130
> 
> 赞同：0
> 
> 时间：2012-06-05T17:37:56.897
> 
> 标签：asp.net-mvc, asp.net-mvc-3

所以假设我有一个注册模型，我有：

`[Display(Name = "")]`
`public string SecretQuestion { get; set; }`

如何`[Display(Name = "")]`动态加载，以便显示名称实际上是秘密问题。我从数据库中收到一个问题，我需要它是动态的。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-06-05T17:47:24.040

我不相信您可以对动态数据使用不显眼的验证属性。您需要将信息发送到视图并手动显示。

这可以通过多种方式完成，具体取决于您生成视图的方式。

一个非常简单的方法是：

控制器：

```
myViewModel.SecretQuestion = GetSecretQuestion(); 
```

看法：

```
@Html.DisplayFor(model => model.SecretQuestion)
@Html.TextBoxFor(model => model.SecretQuestion) 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-06-12T13:29:18.407

将数据加载到 ViewBag 并使用 ViewBag 填充标签。

# javascript - 阻止javascript执行

> ID：10902131
> 
> 赞同：2
> 
> 时间：2012-06-05T17:37:57.920
> 
> 标签：javascript, jquery

```
<div onclick="AutogeneratedMethod()">
<span>SPAN 1 : I require auto method </span>
<span onclick="DesiredMethod()">SPAN 2 : I do not require auto method</span>
</div> 
```

在上面的代码示例中，如何防止`AutogeneratedMethod()`在用户单击时调用`SPAN 2`？`div`我对声明及其各自的`onclick`行为没有任何控制权。该行是从我正在使用的框架自动生成的。

我正在寻找可以在`DesiredMethod()`. 像这样的东西：

```
function DesiredMethod() {
//Do necessary stuff
exit; //Abort any further Javascript
} 
```

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-06-05T17:39:53.937

您想停止[事件传播](https://developer.mozilla.org/en/DOM/event.stopPropagation)。IE 有[cancelBubble](http://msdn.microsoft.com/en-us/library/ie/ms533545%28v=vs.85%29.aspx)。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-06-05T17:52:52.900

你也可以像这样移动一些东西：

```
<div>
   <span onclick="AutogeneratedMethod()">SPAN 1 : I require auto method </span>
   <span onclick="DesiredMethod()">SPAN 2 : I do not require auto method</span>
</div> 
```

然后你就不需要担心事件传播和冒泡了。

您可能还想考虑通过不同的机制使用框架（jQuery 等）或纯 JavaScript 附加您的 JavaScript 事件。由于许多原因，人们不赞成通过 HTML 属性执行此操作。查看[此链接](https://developer.mozilla.org/en/DOM/event)了解更多详情。

# xml - 希望通过 xslt 和 Muenchian 方法将表格 xml 数据转换为类似矩阵的热图

> ID：10902135
> 
> 赞同：1
> 
> 时间：2012-06-05T17:38:09.360
> 
> 标签：xml, xslt, matrix, transformation, muenchian-grouping

我一直在阅读 Muenchian 方法，但我只是不了解如何生成我需要的 html 格式的分组。

这是源xml。

```
<?xml version="1.0" encoding="UTF-8"?>
<env>
<paramCount>4</paramCount>
<param parameter="id" value="1371"/>
<param parameter="xform" value="none"/>
<param parameter="user" value="Administrator"/>
<param parameter="time-stamp" value="Jun 5, 2012 2:29:45 PM"/>
<sql name="Matrix Demo" qid="1371">
    <row num="1">
        <col meta="MATRIX.X_TITLE" grp="0" label="X" type="12" name="X">1-Sample Topic</col>
        <col meta="MATRIX.X_ID" grp="0" label="X_ID" type="2" name="X_ID">3838</col>
        <col meta="MATRIX.Y_TITLE" grp="0" label="Y" type="12" name="Y">DC</col>
        <col meta="MATRIX.Y_ID" grp="0" label="Y_ID" type="2" name="Y_ID">4909</col>
        <col meta="MATRIX.PRIORITY" grp="0" label="Priority" type="2" name="Priority">1740</col>
    </row>
    <row num="2">
        <col meta="MATRIX.X_TITLE" grp="0" label="X" type="12" name="X">1-Sample Topic</col>
        <col meta="MATRIX.X_ID" grp="0" label="X_ID" type="2" name="X_ID">3838</col>
        <col meta="MATRIX.Y_TITLE" grp="0" label="Y" type="12" name="Y">Maryland</col>
        <col meta="MATRIX.Y_ID" grp="0" label="Y_ID" type="2" name="Y_ID">4910</col>
        <col meta="MATRIX.PRIORITY" grp="0" label="Priority" type="2" name="Priority">1740</col>
    </row>
    <row num="3">
        <col meta="MATRIX.X_TITLE" grp="0" label="X" type="12" name="X">1-Sample Topic</col>
        <col meta="MATRIX.X_ID" grp="0" label="X_ID" type="2" name="X_ID">3838</col>
        <col meta="MATRIX.Y_TITLE" grp="0" label="Y" type="12" name="Y">Virginia</col>
        <col meta="MATRIX.Y_ID" grp="0" label="Y_ID" type="2" name="Y_ID">4908</col>
        <col meta="MATRIX.PRIORITY" grp="0" label="Priority" type="2" name="Priority">1740</col>
    </row>
    <row num="4">
        <col meta="MATRIX.X_TITLE" grp="0" label="X" type="12" name="X">2-Sample Topic</col>
        <col meta="MATRIX.X_ID" grp="0" label="X_ID" type="2" name="X_ID">4901</col>
        <col meta="MATRIX.Y_TITLE" grp="0" label="Y" type="12" name="Y">DC</col>
        <col meta="MATRIX.Y_ID" grp="0" label="Y_ID" type="2" name="Y_ID">4909</col>
        <col meta="MATRIX.PRIORITY" grp="0" label="Priority" type="2" name="Priority">1741</col>
    </row>
    <row num="5">
        <col meta="MATRIX.X_TITLE" grp="0" label="X" type="12" name="X">2-Sample Topic</col>
        <col meta="MATRIX.X_ID" grp="0" label="X_ID" type="2" name="X_ID">4901</col>
        <col meta="MATRIX.Y_TITLE" grp="0" label="Y" type="12" name="Y">Maryland</col>
        <col meta="MATRIX.Y_ID" grp="0" label="Y_ID" type="2" name="Y_ID">4910</col>
        <col meta="MATRIX.PRIORITY" grp="0" label="Priority" type="2" name="Priority">1741</col>
    </row>
    <row num="6">
        <col meta="MATRIX.X_TITLE" grp="0" label="X" type="12" name="X">2-Sample Topic</col>
        <col meta="MATRIX.X_ID" grp="0" label="X_ID" type="2" name="X_ID">4901</col>
        <col meta="MATRIX.Y_TITLE" grp="0" label="Y" type="12" name="Y">Virginia</col>
        <col meta="MATRIX.Y_ID" grp="0" label="Y_ID" type="2" name="Y_ID">4908</col>
        <col meta="MATRIX.PRIORITY" grp="0" label="Priority" type="2" name="Priority">1741</col>
    </row>
    ...
</sql>
</env> 
```

这就是我想要达到的目标。

```
<html>
<body>
<table border="1" width="500px">
<thead>
    <tr>
        <th>&#160;</th>
        <th>1-Sample Topic</th>
        <th>2-Sample Topic</th>
        <th>3-Sample Topic</th>
    </tr>
</thead>
<tbody>
    <tr>
        <td>DC</td>
        <td>1740</td>
        <td>1741</td>
        <td>1742</td>
    </tr>
    <tr>
        <td>Maryland</td>
        <td>1740</td>
        <td>1741</td>
        <td>1742</td>
    </tr>
    <tr>
        <td>Virginia</td>
        <td>1740</td>
        <td>1741</td>
        <td>1742</td>
    </tr>
</tbody>
</table>
</body>
</html> 
```

我还没有真正接近获得我需要的输出。我确实从[http://www.jenitennison.com/xslt/grouping/muenchian.html](http://www.jenitennison.com/xslt/grouping/muenchian.html)得到了这个例子，但没有比这更进一步。

我可以控制 col 部分中输出的数据，但我无法更改整体树。任何帮助将不胜感激。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-06-05T20:32:53.397

您没有说哪些`<col>`元素是最可靠的分组元素，但我认为具有`name="X_ID"`和的`name="Y_ID"`元素是合适的。

Muenchian 方法的目的是快速定位具有相同特征的所有元素。所以在这种情况下，我们需要根据行的`X_ID`列值对行进行分组，以在第一行的元素中找到要进入的文本`<th>`，并分别按`Y_ID`列的值来确定在`<td>`后续行的元素中显示哪些行.

此样式表按您指定的方式进行分组。将其应用于您提供的数据时的输出显示在其下方。

```
<?xml version="1.0" encoding="UTF-8"?>
<xsl:stylesheet
  xmlns:xsl="http://www.w3.org/1999/XSL/Transform"
  version="1.0">

  <xsl:output method="html" indent="yes"/>
  <xsl:strip-space elements="*"/>

  <xsl:key name="rows_by_x_id" match="row" use="col[@name='X_ID']" />
  <xsl:key name="rows_by_y_id" match="row" use="col[@name='Y_ID']" />

  <xsl:template match="/env/sql">

    <html>
      <body>

        <table border="1" width="500px">

          <tr>
            <th>&#160;</th>
            <xsl:for-each select="row[generate-id() = generate-id(key('rows_by_x_id', col[@name='X_ID']))]">
              <th>
                <xsl:value-of select="col[@name='X']"/>
              </th>
            </xsl:for-each>
          </tr>

          <xsl:for-each select="row[generate-id() = generate-id(key('rows_by_y_id', col[@name='Y_ID']))]">
            <tr>
              <td>
                <xsl:value-of select="col[@name='Y']"/>
              </td>
              <xsl:for-each select="key('rows_by_y_id', current()/col[@name='Y_ID'])">
                <td>
                  <xsl:value-of select="col[@name='Priority']"/>
                </td>
              </xsl:for-each>
            </tr>
          </xsl:for-each>

        </table>

      </body>
    </html>

  </xsl:template>

</xsl:stylesheet> 
```

**输出**

```
4<html>
   <body>
      <table border="1" width="500px">
         <tr>
            <th>&nbsp;</th>
            <th>1-Sample Topic</th>
            <th>2-Sample Topic</th>
         </tr>
         <tr>
            <td>DC</td>
            <td>1740</td>
            <td>1741</td>
         </tr>
         <tr>
            <td>Maryland</td>
            <td>1740</td>
            <td>1741</td>
         </tr>
         <tr>
            <td>Virginia</td>
            <td>1740</td>
            <td>1741</td>
         </tr>
      </table>
   </body>
</html> 
```

# sql-server-2008 - 为服务器附加数据库失败

> ID：10902139
> 
> 赞同：13
> 
> 时间：2012-06-05T17:38:21.657
> 
> 标签：sql-server-2008

我正在尝试在 SQL Server 2008 中附加一个数据库，并且我有数据库的 .mdf 文件，但我遇到了一个例外

> 服务器“Bilal-PC”的附加数据库失败。(Microsoft.SqlServer.Smo)
> 
> 无法打开物理文件“E:\Intelliscence\Backups\test (2011-07-19)\Database\QBankDB.mdf”。操作系统错误 5：“5（拒绝访问。）”。（Microsoft SQL Server，错误：5120）

我搜索了这个问题的解决方案，找到了一种数据库文件访问权限的解决方案，但是数据库文件已经具有完全控制访问权限。现在我想附加这个数据库或者想得到这个数据库的脚本。但是如何？

我知道这是一个重复的问题，但答案中给出的所有解决方案都不适合我，这就是我发布这个问题的原因。

请帮我。

* * *

## 回答 #1

> 赞同：44
> 
> 时间：2013-06-18T03:00:32.617

尝试以管理员身份运行 Management Studio 并附加数据库。

右键单击 Management Studio 属性并以管理员身份运行。

希望对你有帮助......

* * *

## 回答 #2

> 赞同：8
> 
> 时间：2012-06-05T17:44:22.743

错误消息似乎很简单：访问被拒绝。您需要确保 SQL Server 服务帐户对 E:\Intelliscence\Backups\QBank (2011-07-19)\Database\ 具有足够的权限，或者移动实例的数据/日志文件夹的 MDF/LDF 文件（这不应该是一个问题）。

* * *

## 回答 #3

> 赞同：3
> 
> 时间：2015-12-14T14:38:52.690

你应该编辑 .mdf 和 .ldf 文件的安全性以完全控制像这张图片 [![在此处输入图像描述](../Images/5684aba2de1551327ee1430695f98db6.png)](https://i.stack.imgur.com/9DT8T.png)

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2021-03-03T12:24:52.417

我认为这与权限无关，我完全不知道整个场景，但是例如，如果您尝试将 mdf 从 SQL server 2008 附加到 SQL server 14 或其他东西，只需复制 MDF 和 LDF来自 C:\Program Files (x86)\Microsoft SQL Server\MSSQL10.SQLEXPRESS\MSSQL\DATA 的文件并将它们放在 C:\Program Files\Microsoft SQL Server\MSSQL14.SQLEXPRESS\MSSQL\DATA 中，然后尝试使用常规attach 方法，你应该没问题

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2016-07-18T12:59:11.750

%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%% 附说明数据库到SQL %%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%% %

*   运行“SQL server 2014 管理工作室”。

*   登录到 \SQLEXPRESS。

*   右键单击数据库文件夹并选择“附加”。

*   在打开的 UI 中选择添加。

*   浏览到 .mdf 和 .ldf 文件所在的文件夹。

*   选择 .mdf 文件。注意：您选择的 .mdf 和 .ldf 文件将被删除，因此请确保您事先制作了这些文件的副本。

*   单击“附加为”选项卡并键入新的数据库名称。

*   确保 ldf 和 mdf 文件的“当前文件路径”正确。

*   单击确定。

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2021-07-09T12:51:13.517

可能是因为

*   SQL 数据文件的默认位置已更改
*   数据库分离时 SQL Server 重置文件权限

尝试以下任何方法。

*   将 SQL Server Management Studio 作为`Administrator`. （右键单击-> `run as administrator`）。
*   我使用的帐户对 mdf 和 ldf 文件具有完全控制 NTFS 权限。但是，它通过组成员身份拥有这些权限（本地管理员组拥有权限，而我的帐户是本地管理员的成员）。因此，请授予 *.mdf / *.ldf 文件的完全访问权限。

请参阅[此处](https://www.stellarinfo.com/blog/fix-sql-server-access-denied-error/)了解更多信息。

* * *

## 回答 #7

> 赞同：0
> 
> 时间：2016-10-02T06:40:11.320

以管理员身份运行 Management Studio 并使用 Windows 身份验证连接服务器。

尝试附加数据库。

我已经完成了这个......

# android - 通过意图发送参数值

> ID：10902140
> 
> 赞同：0
> 
> 时间：2012-06-05T17:38:26.557
> 
> 标签：android, android-layout, android-intent

我想根据用户请求的数量访问同一个类。我已经尝试过使用 putExtra 的[本教程](https://stackoverflow.com/questions/9219447/using-intent-to-send-data)，但它是两个不同类的示例，而我需要意图调用同一个类。

这是我的代码：

```
 String dataX="dataX";
   int count;
   while(count >0){
       count--;
       startActivity(M_InsertData.this, M_InsertData.class);
       Intent toAlternative = new Intent(M_InsertData.this, M_InsertData.class);
       toAlternative.putExtra(dataX, count);

   } 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-06-05T17:50:39.857

当您调用时`startActivity(M_InsertData.this, M_InsertData.class);`，您真正在做的是将这两个参数转换为一个意图并在其上调用 start 活动。然后你创建一个意图并向它添加一些额外的数据，但永远不要将它用于任何事情。相反，while 循环中的最后三行应为

```
 Intent toAlternative = new Intent(M_InsertData.this, M_InsertData.class);
       toAlternative.putExtra(dataX, count);
       startActivity(toAlternative); 
```

这应该正确地将额外数据（通过意图）传递给新活动。

# wpf - WPF StringFormat 负值问题

> ID：10902143
> 
> 赞同：2
> 
> 时间：2012-06-05T17:38:46.707
> 
> 标签：wpf, string-formatting

我在 WPF 绑定中使用以下格式字符串：

```
StringFormat={}{0:Gain: 0 dB} 
```

当边界值为负时，我得到：

```
-Gain: 1234 dB 
```

我想要的输出是“增益：-1234 dB”。有人可以告诉我我做错了什么，也许还有一些使用这些格式字符串的经验法则？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-06-05T19:06:02.877

试试这个：

```
StringFormat='Gain: {0} dB' 
```

如果在您的情况下不适用于撇号，您也可以尝试不带撇号。

对于更复杂的情况，您还可以考虑`IValueConverter`在绑定中使用实现类。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-06-05T19:38:04.447

您的参数位于格式字符串的前面。将其移到中间，您将获得所需的结果：

更改：StringFormat={}{0:Gain: 0 dB}

至：StringFormat=增益：{0} dB

因此，假设您的属性称为 MyInt，mode = OneWay，如果您绑定到 TextBlock，这就是完整绑定的样子

```
<TextBlock Text="{Binding Path=MyInt, StringFormat=Gain: {0} dB, Mode=OneWay}" /> 
```

# c - 将字符串直接发送到宏与从数组发送的不同结果

> ID：10902145
> 
> 赞同：1
> 
> 时间：2012-06-05T17:38:56.683
> 
> 标签：c

我认为关于字符串有一些我不理解的基本内容（C 的新手）。基本上我使用的是[uthash](http://uthash.sourceforge.net/)，当我直接发送字符串而不是从循环发送字符串时它可以工作（即从数组中获取它的数据）。

这是一个例子：

```
enum { MAX_ID_LEN = 5 };
struct my_struct {
    char id[MAX_ID_LEN];                    /* key */
    float price;
    UT_hash_handle hh;         /* makes this structure hashable */
};
struct my_struct *users = NULL;

void new_stock(char *user_id, float price) {
    //printf("%c - %f \n", *user_id, price);
    struct my_struct *s;

    s = (struct my_struct*)malloc(sizeof(struct my_struct));
    strcpy(s->id, user_id);
    s->price = price;
    HASH_ADD_STR( users, id, s );  /* id: name of key field */
}
int main() {
    printf("starting.. \n");
    new_stock("IBM", 10.2);
    new_stock("goog", 2.2);
    return 0;
} 
```

那行得通，但是当我尝试从数组中做同样的事情时，它却没有（编译时没有错误）。

```
char *name_all[] =  {"ibm", "goog"};
int name_all_size =sizeof(name_all)/sizeof(char); 
float price_all[] =  {10.2, 2.2};

enum { MAX_ID_LEN = 5 };
struct my_struct {
    char id[MAX_ID_LEN];                    /* key */
    float price;
    UT_hash_handle hh;         /* makes this structure hashable */
};

struct my_struct *users = NULL;

void insert_data() {
    printf("inserting data \n");
    int data_loc;
    for (data_loc=0;data_loc<name_all_size;data_loc++) {
        //printf("%s - %f \n", name_all[data_loc], price_all[data_loc]);
        //new_stock(name_all[data_loc], price_all[data_loc]);
        //new try
        struct my_struct *s;
        s = (struct my_struct*)malloc(sizeof(struct my_struct));
        strcpy(s->id, name_all[data_loc]);
        s->price = price_all[data_loc];
        //printf("%s - %f \n", s->id, s->price); //ahh displays correctly but still fails
        HASH_ADD_STR( users, id, s );  /* id: name of key field */

    }
}

int main() {
    insert_data();
        return 0;
} 
```

我是 C 的新手，所以我可能评估这个错误，但我认为这与我传递变量的方式有关。当我第一次尝试时，我将它发送到`new_stock`函数，但它只显示第一个字符，所以为了解决传递变量的问题，我只是将函数的所有内容移动到我用来添加所有数据的函数中到，但我仍然遇到同样的问题。

知道我做错了什么吗？

也只是出于个人兴趣，是否有任何工具可以警告我代码中的问题？我发现 gcc 很有帮助，但是一旦警告停止，我不知道如何进行故障排除。有什么东西可以帮助我更早地发现这样的问题（比 gcc 更冗长的东西）。不确定它是否可能但想问。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-06-05T17:45:14.460

这是你的错误：

```
char *name_all[] =  {"ibm", "goog"};
int name_all_size =sizeof(name_all)/sizeof(char); 
```

该数组`name_all`是一个`char`指针数组，而不是`char`，因此如果您在具有 32 位指针的 32 位系统上只有 8 个字节，而在具有 64 位指针的 64 位系统上则只有 16 个字节。请记住，指向的字符串文字不存储在数组中，只有指向字符串文字的指针在数组中。你真正想要的是：

```
int name_all_size = sizeof(name_all)/sizeof(char*);
                                            ^^^^^ note the pointer type 
```

这应该给你一个值`2`，它是 中元素的正确数量`name_all`。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-06-05T17:45:21.470

```
char *name_all[] =  {"ibm", "goog"};
int name_all_size =sizeof(name_all)/sizeof(char); 
```

`name_all`是两个 的数组`char*`。`sizeof name_all`也是如此`2*sizeof(char*)`，通常是 8 位或 16 位，具体取决于您使用的是 32 位系统还是 64 位系统。`sizeof(char)`根据定义为 1。所以在

```
for (data_loc=0;data_loc<name_all_size;data_loc++) {
    //printf("%s - %f \n", name_all[data_loc], price_all[data_loc]);
    //new_stock(name_all[data_loc], price_all[data_loc]);
    //new try
    struct my_struct *s;
    s = (struct my_struct*)malloc(sizeof(struct my_struct));
    strcpy(s->id, name_all[data_loc]);
    s->price = price_all[data_loc];
    //printf("%s - %f \n", s->id, s->price); //ahh displays correctly but still fails
    HASH_ADD_STR( users, id, s );  /* id: name of key field */

} 
```

您正在访问数组的末尾`name_all`。

您的意思是除以`sizeof(char*)`in`name_all_size`吗？

# r - 在ggplot2中画线

> ID：10902155
> 
> 赞同：5
> 
> 时间：2012-06-05T17:39:34.620
> 
> 标签：r, ggplot2

我有一个情节，我想用图例从`(0,0)`to 画一条线。`(15,15)`我该如何做到这一点？阴谋：

```
frame <- read.table('pastie_from_web', sep=",", header=TRUE)
colnames(frame) <- c("pos", "word.length")
plot <- ggplot(frame, aes(x=pos, y=word.length)) + scale_x_continuous(limits=c(1,15)) + scale_y_continuous(limits=c(1,15))+ geom_density2d(aes(color=..level..)) + scale_color_gradient(low="black", high="red") + opts(legend.position="none")
png(paste("graphs/", fname, ".png", sep=""), width=600, height=600)
print(plot) 
```

数据：[http](http://sprunge.us/gKiL) ://sprunge.us/gKiL或

```
structure(list(position = c(2, 2, 2, 2, 7, 8, 4, 5, 4, 9, 5, 
2, 7, 9, 9, 6, 5, 6, 9, 2, 6, 5, 5, 7, 7, 5, 6, 5, 5, 3, 2, 4, 
5, 2, 3, 2, 7, 5, 2, 5, 2, 6, 8, 7, 2, 8, 5, 4, 2, 5, 2, 2, 2, 
6, 8, 2, 2, 9, 5, 2, 4, 7, 3, 4, 9, 5, 5, 5, 5, 4, 7, 2, 7, 2, 
4, 4, 3, 2, 5, 6, 5, 5, 5, 5, 4, 4, 8, 7, 5, 7, 4, 3, 4, 5, 2, 
6, 6, 4, 4, 2, 2, 3, 2, 2, 6, 2), word.length = c(5L, 5L, 6L, 
4L, 9L, 11L, 5L, 8L, 8L, 10L, 8L, 9L, 8L, 10L, 10L, 7L, 9L, 10L, 
11L, 10L, 10L, 8L, 13L, 11L, 11L, 13L, 7L, 9L, 6L, 4L, 9L, 8L, 
9L, 6L, 4L, 5L, 11L, 13L, 13L, 13L, 10L, 9L, 11L, 8L, 4L, 10L, 
8L, 16L, 3L, 5L, 4L, 12L, 12L, 15L, 9L, 12L, 12L, 11L, 11L, 8L, 
16L, 9L, 8L, 7L, 10L, 11L, 6L, 13L, 5L, 8L, 8L, 5L, 8L, 5L, 6L, 
6L, 7L, 10L, 13L, 7L, 6L, 13L, 9L, 6L, 7L, 8L, 11L, 8L, 8L, 8L, 
8L, 8L, 7L, 6L, 5L, 9L, 9L, 5L, 5L, 6L, 7L, 8L, 8L, 10L, 8L, 
10L)), .Names = c("position", "word.length"), class = "data.frame", row.names = c(NA, 
-106L)) 
```

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2012-06-05T17:48:26.533

这是一个示例数据集来说明：

```
set.seed(42)
dat <- data.frame(x = runif(20, min = 0, max = 20),
                  y = runif(20, min = 0, max = 20))

p <- ggplot(dat, aes(x = x, y = y)) 
p + geom_point() + 
    geom_line(data = data.frame(x = c(0,15), y = c(0,15)),
              aes = aes(x = x, y = y), colour = "red") 
```

请注意我们如何为 geoms 指定不同的参数，这允许我们在原始调用`data`中定义的相同绘图区域上绘制不同的数据对象。**注意：**如果第二个数据框（在调用中）具有与原始图相同的 x 和 y 轴映射，那么您不需要新的，因为我最初拥有代码（请参阅答案的修订历史）。这可能还不清楚，@Justin 的评论促使我改变了，包括一个新的调用来将数据映射到美学；在我的示例中不需要它，但在实际使用中很可能需要它。`ggplot()`**`geom_line()``aes()``geom_line()``aes()`**

 **以上给出：

![在此处输入图像描述](../Images/cd0490d2bad4d1a09b2bda30a0183bb7.png)

如果您想要不同的任意线，请考虑`geom_abline()`使用给定斜率和截距绘制线。`geom_segment()`是上面`geom_line()`指定开始和结束 x 和 y 坐标的替代方法。请参阅 geoms 的相应帮助页面，以确定您更喜欢使用哪个。**

# android - 如何通过该活动拥有的视图获取活动？

> ID：10902156
> 
> 赞同：0
> 
> 时间：2012-06-05T17:39:36.913
> 
> 标签：android, view, android-activity, activity-finish

我为导航栏编写了一个独立的自定义 OnClickListener 类（不是成员类）。请参阅下面的代码。

```
class MyClickHandler implements OnClickListener {

@Override
public void onClick(View view) {
    Intent intent;
    Context ctx = view.getContext();
    int id = view.getId();
    switch(id){

    case R.id.app_home_id:
        intent = new Intent(ctx, FormEngineMainApp.class);
        ctx.startActivity(intent);
        break;
    case R.id.app_tasklist_id:
        intent = new Intent(ctx, WorkList.class);
        ctx.startActivity(intent);
        break;
    //more cases...

    }

}

} 
```

每个按钮都会导致不同的活动。我倾向于在调用后完成当前活动`startActivity(intent);`，但我需要当前活动实例来调用`finish()`。我不知道如何获取当前的活动实例。唯一可能有帮助的是参数`view`，但我在 Android Developers 中查看了 View 的参考，但没有找到解决方案。有什么建议么？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-06-05T17:49:20.963

当您调用 a`finish()`时，从堆栈中删除该活动的条目，因此我相信您永远无法获得对该旧活动的引用！

在您的情况下，最好的部分是调用 using`startActivityWithResult(..., ...)`然后根据`requestCode`调用完成，然后再获取旧活动的参考。

# django - 从模型显示图像到模板 Django

> ID：10902159
> 
> 赞同：0
> 
> 时间：2012-06-05T17:39:55.990
> 
> 标签：django, image, templates

图片可以上传到位于 mysite 文件中的“upload”文件，这是我的代码 setting.py

```
MEDIA_ROOT = 'C:/Python26/mysite/upload/media/'
MEDIA_URL = '/media/' 
```

在 url.py

```
urlpatterns = patterns('',

   url(r'^media/(?P<path>.*)$', 'django.views.static.serve',
            {'document_root': settings.MEDIA_ROOT,}),
) 
```

在模板中

```
 <img src="{{MEDIA_URL}}/{{pic}}" alt="Profile Picture" width="200"/> 
```

但是，图像仍然没有显示在网站上，但它确实存储在上传文件中。有人可以帮我吗？谢谢

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-06-05T18:44:05.140

鉴于：

```
MEDIA_URL = '/media/' 
```

以及以下模板代码：

```
<img src="{{MEDIA_URL}}/{{pic}}" alt="Profile Picture" width="200"/> 
```

图像`src`不可能是`/upload/Desert.jpg`。路径应该以`/media/`. 很可能`MEDIA_URL`是 undefined 并且值`pic`is `upload/Desert.jpg`。如果是这种情况，那么您可能缺少媒体模板上下文处理器。更改`TEMPLATE_CONTEXT_PROCESSORS`为：

```
TEMPLATE_CONTEXT_PROCESSORS = (
    ...
    'django.core.context_processors.media',
) 
```

这将`MEDIA_URL`在您的模板上下文中可用。然后，您还需要删除它之后的斜线，否则您将得到两个（`MEDIA_URL`以斜线结尾），即：

代替：

```
{{ MEDIA_URL }}/{{ pic }} 
```

利用：

```
{{ MEDIA_URL }}{{ pic }} 
```

**更新**

如果您*仍然*没有获得 的价值`MEDIA_URL`，那么您可能没有使用`RequestContext`. 您必须包装视图的上下文，`RequestContext`以便模板上下文处理器执行其操作。

如果您正在使用`render_to_response`，则：

```
return render_to_response('template.html', { ... context here ... }, context_instance=RequestContext(request)) 
```

如果您使用的是 Django 1.3+，您可以使用该`render`方法，它会自动为您执行此操作：

```
return render('template.html', { ... context here ... }) 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2020-05-06T11:59:22.193

在设置中，这对我不起作用，

```
TEMPLATE_CONTEXT_PROCESSORS = (
    ...
    'django.core.context_processors.media',
) 
```

而不是`django.core....`我用`django.template....`

```
TEMPLATE_CONTEXT_PROCESSORS = (
    ...
    'django.template.context_processors.media',
) 
```

# visual-studio-2010 - 防止输出窗口中的第一次机会异常

> ID：10902166
> 
> 赞同：2
> 
> 时间：2012-06-05T17:40:24.107
> 
> 标签：visual-studio-2010, debugging, tracelistener, first-chance-exception

在 Visual Studio 2010 中，是否可以防止首次机会异常写入输出窗口？我们有一个场景，有很多强制转换设计失败，并且输出窗口在调试时确实减慢了应用程序的速度。写出“System.InvalidCastException”类型的第一次机会异常发生......一遍又一遍只需要很长时间。Visual Studio 中的控制台并不快 :<)

我知道不中断第一次机会异常的选项，但这似乎不会影响输出窗口。也没有把它放在让我们慢下来的领域之前：

```
Debug.Listeners.Clear() 
```

关闭输出窗口也无济于事。虽然它在发布模式下运行得非常快。

任何帮助表示赞赏！

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2015-06-16T07:36:30.863

我可以为 Visual Studio 2013 回答这个问题：

在 VS 2013 中，您可以转到 DEBUG 菜单 - 选项和设置... - 调试 - 输出窗口。在“常规输出设置”下，您可以找到“异常消息”。把它关掉。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-06-05T18:07:08.180

根据@Iridium 的评论，我最终更改为 Try 模式并返回一个 bool 作为成功标志，而不是抛出 InvalidCastException。看起来很像这样：

```
if (!property.CanAssignValue(valueToSet))
{
    Debug.Write(string.Format("The given value {0} could not be assigned to property {1}.", value, property.Name));
    return false;
}
property.SetValue(instance, valueToSet, null);
return true; 
```

“CanAssignValue”变成了三个快速扩展：

```
public static bool CanAssignValue(this PropertyInfo p, object value)
{
    return value == null ? p.IsNullable() : p.PropertyType.IsInstanceOfType(value);
}

public static bool IsNullable(this PropertyInfo p)
{
    return p.PropertyType.IsNullable();
}

public static bool IsNullable(this Type t)
{
    return !t.IsValueType || Nullable.GetUnderlyingType(t) != null;
} 
```

谢谢！

# ember.js - 如何判断 Ember 视图的元素是否在文档中？

> ID：10902171
> 
> 赞同：2
> 
> 时间：2012-06-05T17:40:58.453
> 
> 标签：ember.js

你怎么知道你的 Ember 视图的元素已经插入到文档中？

我目前的方法是：

```
if (this.$().length) {
  // ...
} 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-06-05T22:02:25.107

另一种解决方案是检查视图字典。如果你有这样的看法：

```
var helloView = Em.View.create({
  elementId: 'hello'
}); 
```

你可以做：

```
var myView = Ember.View.views.hello;

// Check if it is in the DOM
myView.get('state') === "inDOM";

// Check if it is visible
myView.get('isVisible'); 
```

# php - PHP序列化和反序列化

> ID：10902177
> 
> 赞同：1
> 
> 时间：2012-06-05T17:41:20.650
> 
> 标签：php

我对 Unserialize 有问题，它在从 $_POST 获取它后什么都不返回。我从表单中发布了一个简单的数组，我可以看到在序列化字符串中添加了双引号。我在序列化和反序列化之前尝试了stripslashes，但结果是一样的，没有输出。我已经在 php.ini 中关闭了 magic_quotes_gpc，但又没有运气。当我通过手动添加“\”对反序列化中的值进行硬编码时，给了我所需的字符串，所以我尝试了添加斜杠，但又一无所获。请帮我解决这个问题。

```
<?php

$tmp = $_POST["strVid"];

$myNewArray = unserialize($trp);
print_r($myNewArray);

$myArray = array('key1'=>'value1', 'key2'=>'value2');
$serialized = serialize($myArray);
?>

<form  onsubmit="return validate(this)" action="test_serialize.php" method="post">
<input type="hidden" name="strVid1" value="this is mega shit"/>
<input type="hidden" name="strVid" value="<?php echo $serialized; ?>">
<input type="Submit" name="next" value="Next"/>

</form> 
```

更新...

序列化后：a:2:{s:4:"key1";s:6:"value1";s:4:"key2";s:6:"value2";}

在序列化的stripslashes之后： a:2:{s:4:"key1";s:6:"value1";s:4:"key2";s:6:"value2";}

当我手动添加\

$myNewArray = unserialize("a:2:{s:4:\"key1\";s:6:\"value1\";s:4:\"key2\";s:6:\"value2\" ;} ");

我将输出作为数组（ [key1] => value1 [key2] => value2 ）

谢谢

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-06-05T18:14:57.837

在您的代码中：

```
<input type="hidden" name="strVid" value="<?php echo $serialized; ?>"> 
```

这肯定是错误的，因为变量将包含双引号；你必须逃避那些：

```
<input type="hidden" name="strVid" value="<?php echo htmlspecialchars($serialized, ENT_QUOTES, 'UTF-8'); ?>"> 
```

顺便说一句，这是假设你这样做是为了反序列化它：

```
$myNewArray = unserialize($_POST["strVid"]); 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-06-05T17:49:19.437

这是一个错字吗？

```
$tmp = $_POST["strVid"];

$myNewArray = unserialize($trp); 
```

`$trp`!=`$tmp`

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-06-05T18:12:24.577

您是否尝试过在序列化输入上使用 urlencode？

[http://php.net/manual/en/function.urlencode.php](http://php.net/manual/en/function.urlencode.php)

# java - Java：System.exit() 参数

> ID：10902181
> 
> 赞同：2
> 
> 时间：2012-06-05T17:41:30.687
> 
> 标签：java, swing, dispose

我有一个简单的问题，但有点可疑。这是这种情况。

在我的应用程序中，您可以通过单击新按钮打开新窗口。当您单击“X”（关闭）按钮时，它首先会询问您是否要保存您的工作。如果没有，它将使用 system.exit(0) 退出。情况是，这会关闭所有打开的“新”窗口。我只想关闭用户选择“不保存”选项的窗口。我怎样才能做到这一点？请帮忙！

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-06-05T17:45:34.707

System.exit(0) 将关闭当前运行您的应用程序的 JVM，并且几乎可以肯定这不是您想要在此处执行的操作。

您几乎肯定希望[在 Swing 中使用更惯用的方式](https://stackoverflow.com/questions/573317/java-swing-close-window-without-exiting-app)来执行此操作。

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2012-06-05T17:45:46.010

对于简单地关闭打开的 JFrame 而不退出应用程序，您必须指定关闭时要执行的操作：

```
frame.setDefaultCloseOperation(JFrame.DISPOSE_ON_CLOSE); 
```

对于窗口关闭事件的高级控制，您必须使用[WindowListener](http://docs.oracle.com/javase/7/docs/api/java/awt/event/WindowListener.html)。官方教程见[这里](http://docs.oracle.com/javase/tutorial/uiswing/events/windowlistener.html)。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-06-06T11:07:41.903

> 它是一个文本编辑器，就像记事本一样。使用“new”打开新的“windows”。

替代方案（所有在这个答案中提到或链接到[The Use of Multiple JFrames, Good/Bad Practice?](https://stackoverflow.com/a/9554657/418556)）：

1.  `JTabbedPane`
2.  `JDesktopPane`包含`JInternalFrame`实例
3.  `CardLayout`
4.  （见链接答案..）

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2012-06-05T17:45:24.723

TUS 中的 WindowUtilities 和 WindowTiler 是解决这个问题的方法

[http://tus.svn.sourceforge.net/viewvc/tus/tjacobs/ui/util/](http://tus.svn.sourceforge.net/viewvc/tus/tjacobs/ui/util/)

# c# - 在 form1 中检测到 form2 已关闭

> ID：10902182
> 
> 赞同：3
> 
> 时间：2012-06-05T17:41:41.580
> 
> 标签：c#, forms

我试图检测到 form2 在 form1 中关闭。到目前为止我有这个

```
 private void AddStageBtn_Click(object sender, EventArgs e)
    {
        Form2 form2 = new Form2();
        form2.ShowDialog();
        if (form2.IsDisposed)
        {
            MessageBox.Show("it was closed!");
        }
    } 
```

有什么建议么？再次感谢！

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-06-05T17:44:50.343

在这种特殊情况下

```
private void AddStageBtn_Click(object sender, EventArgs e)
{
    Form2 form2 = new Form2();
    form2.ShowDialog();
    MessageBox.Show("it was closed!");
} 
```

会正常工作。如果您希望能够在 form2 打开时在 form1 中执行操作，您需要使用 Show 而不是 ShowDialog。然后，您可以为 form1 中关闭的表单创建一个处理程序。

```
form2.FormClosed += new FormClosedEventHandler(form2_FormClosed); 
```

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-06-05T17:45:03.363

坚持`FormClosed`form2的事件。

无论您在哪里创建它：

```
form2.FormClosed += new FormClosedEventHandler(form2_FormClosed); 
```

然后创建方法：

```
void form2_FormClosed(object sender, FormClosedEventArgs e)
{
    // Do whatever you want here
} 
```

如果您希望能够使用任何一种形式，您还需要使用`.Show()`而不是，否则在关闭之前将不可用（我假设这不是您正在寻找的行为）。`.ShowDialog()``form1``form2`

# c# - LINQ 查询以选择损坏序列中的值范围

> ID：10902189
> 
> 赞同：1
> 
> 时间：2012-06-05T17:42:09.107
> 
> 标签：c#, linq

给定一个实体，有两个字段，int? 和字符串：

```
EntityId    Name
--------    -----
    1       Name1
    2       Name2
    3       Name3
    4       Name4
 (null)     Name5
    6       Name6
    7       Name7 
```

使用 LINQ，我如何选择前 4 个实体，直到空值之前？

* * *

## 回答 #1

> 赞同：8
> 
> 时间：2012-06-05T17:45:06.970

似乎是一个案例[`TakeWhile`](http://msdn.microsoft.com/en-us/library/bb534804.aspx)：

```
var query = entities.TakeWhile(x => x.EntityId != null); 
```

（添加`ToList()`或`ToArray()`酌情）。

# mono - Mono：加载我的一个项目文件时出错

> ID：10902190
> 
> 赞同：1
> 
> 时间：2012-06-05T17:42:22.250
> 
> 标签：mono, project

除了这个项目文件之外，其他所有内容都正确加载，我收到此错误

> 尝试加载“/Volumes/FlashDrive/MacFolder/Alain.P1.MacOS/P1.MacOS.csproj”时出错：未知的解决方案项目。

有人知道解决这个问题吗？谢谢。

# jsf - JSF 2.2 @ViewScoped 绑定错误？

> ID：10902193
> 
> 赞同：1
> 
> 时间：2012-06-05T17:42:34.297
> 
> 标签：jsf, binding, view-scope, jsf-2.2

我已经阅读了有关 @ViewScoped ( [BUG REPORT](http://java.net/jira/browse/JAVASERVERFACES-1492) ) 的绑定错误，并且它已在最新版本的 JSF 中修复，因此我使用 3 个最新版本的 JSF 对此进行了测试，并尝试使用

```
 <context-param>
<param-name>javax.faces.PARTIAL_STATE_SAVING</param-name>
<param-value>false</param-value> 
```

修复以解决它，但没有运气。

我有一个 primefaces 数据表，其中每个列标题中都有过滤器。

```
 <p:column id="cpfHeader" sortBy="#{cliente.nrCpf}"
        filterMatchMode="contains">
        <f:facet name="header">
            <h:panelGrid columns="1">
                <h:outputText value="CPF" />
                <p:inputText value="#{cadastroClienteBean.cliente.nrCpf}">

                </p:inputText>
                <p:commandButton
                    actionListener="#{cadastroClienteBean.getClientesBusca}"
                    update="#{form}:tabelaCliente:tblCliente" value="Filtrar"></p:commandButton>
            </h:panelGrid>
        </f:facet>
                #{cliente.nrCpf}                
            </p:column> 
```

在我更改 JSF 版本之前，每次单击“过滤器”按钮时，都会创建一个新的 cadastroClienteBean 实例。现在我已经更改了它，似乎 ManagedBean 不是每次都被实例化，但是 cliente 变量正在变为空，即使我在构造函数上实例化它。

```
 public CadastroClienteBean(){
    cliente = new Cliente();
    init();
} 
```

编辑：在调试了一下之后，我发现过滤器的值被设置在变量上，然后 setCliente() 被调用并将其设置为 null，但我不知道为什么。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-06-05T18:39:50.743

弄清楚发生了什么，`selection="#{cadastroClienteBean.cliente}"`因为没有选择行，所以 dataTable 上的属性将客户端设置为 null。

# algorithm - 平衡多个参与者之间的集体开支

> ID：10902199
> 
> 赞同：4
> 
> 时间：2012-06-05T17:43:02.950
> 
> 标签：algorithm

假设三个人支付了一次旅行的费用：亚当支付了旅馆的费用，150 美元，鲍勃支付了汽油，60 美元，查理提供了食物，120 美元。旅行结束后，他们想平衡开支。

简单的解决方案是，每笔费用由三个人分摊，并由其他参与者单独支付给最初购买商品的人。

自然，如果亚当欠鲍勃 20 美元，而鲍勃欠亚当 50 美元，则相当于鲍勃欠亚当 30 美元。继续这个逻辑，鲍勃欠亚当 30 美元，欠查理 20 美元，查理欠亚当 10 美元。

这里有一个问题：**这个解决方案不是最优**的。可以减少交易的数量。有 10 美元首先从 Bob 支付给 Charlie，然后从 Charlie 支付给 Adam。相反，Bob 可以将这 10 美元加到他已经支付给 Adam 的金额中。

最后，鲍勃向查理支付了 10 美元，向亚当支付了 40 美元。现在每个人都支付了等量的 110 美元的费用。

* * *

我的问题是：

*   当目标是找到费用与绝对最小交易量平衡的方式时，这个问题的一般解决方案是*什么*？从最欠的到最欠的遍历路径可能在计算上变得昂贵，所以它不是微不足道的。

*   NP完全问题可以简化为这个问题吗？

*   这个问题有一个众所周知的名字吗？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-08-03T09:17:41.070

假设`c`人们支付的金额超过了他们的份额（债权人），而`d`人们支付的金额少于他们的份额（债务人）。由于根据您的定义，如果一个解决方案意味着最少的交易数量，则该解决方案是最佳的，理想的情况是每个债务人只需要进行一次转账（他们显然必须至少进行一次转账）。那么问题是，`X1`欠债权人 1 的钱可以通过所欠金额的确切总和来获得吗？可以`X2`通过剩余金额的精确总和获得吗？依此类推，直到`Xc`。从这个意义上说，这个问题与子集和问题有关，正如 nm 所说（有点简洁）。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-06-05T18:47:23.853

是的，这是[子集和问题](http://en.wikipedia.org/wiki/Subset_sum_problem)。

# javascript - 需要一个将信息从一个 div 复制到另一个的按钮

> ID：10902200
> 
> 赞同：-5
> 
> 时间：2012-06-05T17:43:18.220
> 
> 标签：javascript, html, button

我需要一个按钮，它可以获取在第一个 div 中输入的信息，并在您按下按钮时将其复制到第二个 div 中。但是，我不想要任何行，只想要用户输入的信息。感谢所有帮助。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-06-05T18:27:13.863

如果您只想将信息从一个 div 复制到另一个 div，请使用以下代码：

```
<div id = "a1" style="border:1px solid;float:left">Hello this is a dic</div>
<div id = "a2" style="border:1px solid;float:left;width:150px;height:50px;"></div>
<div style='clear:both'></div>
<input type='button' id = 'b1' name = 'click' value='Click'/>

jQuery('#b1').click(function(){
    var content = jQuery('#a1').text();
    jQuery('#a2').text(content);
});​ 
```

这是[演示](http://jsfiddle.net/SN3eU/)。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-06-05T18:05:43.303

我认为这段代码将帮助您仅使用 Javascript ;)

```
function copy()
{

    var fname = document.getElementById('FName').value;

    var lname = document.getElementById('LName').value;

    document.getElementById('results').innerHTML = fname +", "+lname;

    return false;

} 
```

“结果”是显示结果的 DIV 的 ID；）

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-12-12T11:49:34.640

这将搜索所有输入标签并附加值

**HTML**：

```
 <div id = "from"><input type="text" name="fName" id="fName"> .... <input ..... </div><br>
 <div id = "to"></div>
 <input type='button' value="click" onclick="copy()"/> 
```

**JS**：

```
function copy() {
var allDataObject=document.getElementById('from').getElementsByTagName('input');
var inputCount=allDataObject.length;
var allData="";
for(var i=0;i<inputCount;i++) {
   allData + = allDataObject[i].value;
   allData + = "<br>";
}

document.getElementById('to').innerHTML=allData; 
```

# python - 在没有中间体的情况下，如何在 Python 调试器中查看函数的返回值？

> ID：10902203
> 
> 赞同：17
> 
> 时间：2012-06-05T17:43:24.323
> 
> 标签：python, debugging

PDB（和其他 Python 调试器）有一种查看任何当前变量值的简单方法，只需输入即可。但是，有时我使用的库不会将其返回值存储在中间变量中。

这是一个示例函数：

```
def do_stuff(*args, **kwds):
     return f(*args, **kwds) 
```

从f返回后，如何查看返回值？我可以在下载库后重写库以获得中间体：

```
def do_stuff(*args, **kwds):
     r = f(*args, **kwds)
     return r 
```

但似乎应该有更好的方法。

* * *

## 回答 #1

> 赞同：21
> 
> 时间：2013-09-07T13:59:38.793

您可以查看隐藏的**`__return__`**局部变量。

如果我忘记了它的确切名称，我会通过以下方式进行探索：

```
(Pdb) sorted(locals().keys())
['__return__', 'xyz', ...] 
```

**编辑**：稍后的答案与[调试示例相关**`__return__`**](https://stackoverflow.com/a/18674516/448474)

* * *

## 回答 #2

> 赞同：6
> 
> 时间：2012-06-05T18:15:26.703

在 pdb 中，当函数返回时`->'value'`，将在行尾添加返回值的表示形式。

例如：

```
(Pdb) s
--Return--
> test.py(12)do_stuff()->'f'
-> return result
(Pdb) q 
```

意味着`do_stuff()`退回`'f'`

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-06-05T17:52:40.123

你能解释更多吗？

*   通过调试器，您的意思是您正在使用记录器吗？您是否正在逐步使用 IDE？
*   “查看返回值”是什么意思？如果你只是想打印它...

    ```
    def do_stuff(*args, **kwds):
        result = f(*args, **kwds)
        print result
        return result 
    ```

# css - jQuery Mobile 视网膜显示图像选项？

> ID：10902206
> 
> 赞同：0
> 
> 时间：2012-06-05T17:43:34.787
> 
> 标签：css, jquery-mobile

有没有一种简单的方法可以在正确的设备上显示视网膜大小的图像并在其他设备上显示标准？我一直在网上搜索一些人建议使用 jscript。基本上我希望加载 32x32 图像。另外，视网膜图标应该是什么尺寸，32、36 宽或更高？与 16 个标准宽度的图标相比

```
@media only screen and (-webkit-min-device-pixel-ratio:1.5),only screen and (min--moz-device-pixel-ratio:1.5),only screen and (min-resolution:240dpi){
.shopping_icon
{background-image:url(../images/shop_icon.png);-moz-background-size:776px 18px;-o-background-size:776px 18px;-webkit-background-size:776px 18px;background-size:776px 18px;} 
```

像这样的东西会起作用吗？

```
#track .ui-icon{background:url(../simgs/track_icon.png) 50% 50% no-repeat;background-repeat:no-repeat;width:36px !important;height:36px !important;margin:-5px 0 0 -18px;}
@media screen and (-webkit-min-device-pixel-ratio: 1.5),
screen and (max--moz-device-pixel-ratio: 1.5) {
    #track .ui-icon {
    background: url(../simgs/track_icon.png);
    background-size:36px 36px;
    }
} 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-06-05T19:28:56.280

视网膜`device-pixel-ratio`应该是 2。图标图像文件应为 36x36 和 CSS `background-size`18x18 以将其压缩。

请参阅这篇文章的最后一部分：[http ://www.andymatthews.net/read/2011/02/13/Creating-and-using-custom-icons-in-jQuery-Mobile](http://www.andymatthews.net/read/2011/02/13/Creating-and-using-custom-icons-in-jQuery-Mobile)

# kohana - Kohana 3.2 关系 - 加入

> ID：10902208
> 
> 赞同：0
> 
> 时间：2012-06-05T17:43:45.613
> 
> 标签：kohana, kohana-orm, kohana-3.2, kohana-db

我在 mysql 中有当前的设计：

表**文件主题** ![在此处输入图像描述](../Images/1f2f8c711e7d77b9e67ed1248943bcb9.png)

Kohana有没有办法以某种方式建立关系，如果我做出类似的事情

ORM::factory('filesubject')->where('file_id','=',$file->id)->find_all()->as_array());

我从其他表中获得所有连接？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-06-05T20:26:03.183

我不确定你的问题。要自动加入模型，首先设置您的关系（$_belongs_to 等），然后查看：

在您的模型中：

```
ORM property: $_load_with. eg: protected $_load_with= array(model1, model2, etc) 
```

或者在运行时：

```
ORM method: with(). eg: ORM::factory('filesubject')->with('model')->with('model2')->find_all() 
```

我不认为 as_array() 函数会拉入连接的数据。一旦它实际执行连接，您需要覆盖 as_array （或编写您自己的函数）以从连接的属性中输出嵌套的键/对值。

# javascript - 在 PhoneGap Build 上构建 Windows Phone 7 应用程序

> ID：10902210
> 
> 赞同：0
> 
> 时间：2012-06-05T17:43:50.590
> 
> 标签：javascript, jquery, windows-phone-7, mobile, cordova

我正在使用 PhoneGap Build 构建我的应用程序，除了 Windows Phone 7 之外，所有构建都可以。

错误日志：

> “C:\cygwin\tmp\a00dd912-2009-11e1-a9f8-1231390521a2\template\templates\full\GapSolution.sln”（默认目标）（1）->
> 
> “C:\cygwin\tmp\a00dd912-2009-11e1-a9f8-1231390521a2\template\templates\full\GapAppProj.csproj”（默认目标）（2）->

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-06-14T11:00:06.347

编译失败与`config.xml`.

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-06-07T03:39:10.433

您是否在以下位置创建了主题：

[http://getsatisfaction.com/nitobi/products/nitobi_phonegap_build](http://getsatisfaction.com/nitobi/products/nitobi_phonegap_build)

您还应该提供您的 App ID (http://build.phonegap.com/apps/[App ID])，以便他们可以从他们这边查看您的 App 的构建。

# php - 如何为给定任务使用while条件？

> ID：10902213
> 
> 赞同：-3
> 
> 时间：2012-06-05T17:44:07.587
> 
> 标签：php, mysql, sql

我正在使用日期获取用户详细信息

```
if(date("d")==1) {
    $time  = "m";
}
if(date("l")=="Friday") {
    $time  = "w";
}
$time  = "d";

$sql=mysql_query("select user from table_users where $reprt=".$time .");
while($row=mysql_fetch_Array($sql) {
    $sql==mysql_query("select * from table_register where $user="$row[0]");
} 
```

在这里，当`(date("d")==1)`我想同时使用 d 和 m 选择语句时，这怎么可能。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-06-05T17:53:02.510

假设你有一个字符串。将它命名为 S。您还有一个字符串 query = "select * from table_register where "

你要做的是

```
 query = "select * from table_register where "  
  if(date("d")==1){
           s = "$report_frequency  = \"m\" OR $report_frequency  = \"d\" ";
    }
    elseif(date("l")=="Friday"){
         s = "$report_frequency  = \"m\" ";
    }
    else{
    s = "$report_frequency  = \"d\" ";
    }

    query = query.s;

    $sql=mysql_query(query);
    ... 
```

换句话说，使用 Strings 动态构建查询字符串

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-06-05T17:53:11.107

在您的代码中，您在`$time = "d";`IF 之外使用，因此您将始终拥有`$time=d`，因此将代码替换为：

```
if(date("d")==1){
  $time  = "m or $reprt='d'";
}
if(date("l")=="Friday"){
  $time  = "w";
}

$sql=mysql_query("select user from table_users where $reprt=".$time);
while($row=mysql_fetch_Array($sql){
  $sql=mysql_query("select * from table_register where $user='$row[0]'");
} 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-06-05T17:56:30.607

让我们看看我是否正确...如果我理解正确，您应该只在一个查询中执行此操作

select * from table_register where $user in (select user from table_users where $reprt=".$time)

将是一个比你设置的更好的查询......仍然不是最好的，但至少它只有 1 个查询。

对于实际问题，您应该将代码更改为以下

```
if(date("d")==1)
{
 $time  = "m";
}
if(date("l")=="Friday")
{
 $time  = "w";
}

if($time == "m") // this is when you want to also search for d right?
{
  //we do what I suggested earlier with a slight change
  mysql_query("select * from table_register where $user in (select user from table_users where  $reprt=".$time." OR $reprt=d)");
}
else
{
  //we do what I suggested earlier
  mysql_query("select * from table_register where $user in (select user from table_users where  $reprt=".$time.")");
} 
```

希望这可以帮助。

# c++ - 使用 shared_ptr 的开销和实现

> ID：10902227
> 
> 赞同：14
> 
> 时间：2012-06-05T17:45:07.003
> 
> 标签：c++, c++11, shared-ptr

简短介绍：我正在处理多线程代码，我必须在两个线程之间共享动态分配的对象。为了使我的代码更清晰（并且不易出错），我想在每个线程中显式“删除”对象，这就是我想使用`shared_ptr`.

**第一个问题：**

我想知道 in 的实现`-> operator`在运行时`shared_ptr`是否有一些额外的开销（例如大于 then `unique_ptr`）。我正在谈论的对象通常是在创建后仅复制一次的长寿命实例（当我在线程之间分配它们时），然后我只访问这些对象的方法和字段。

我知道，`shared_ptr`这只保护引用计数。

**第二个问题：**

`shared_ptr`libstdc++的优化程度如何？它总是使用互斥锁还是利用原子操作（我专注于 x86 和 ARM 平台）？

* * *

## 回答 #1

> 赞同：14
> 
> 时间：2012-06-05T20:02:37.373

> **第一个问题**：使用`operator->`

我见过的所有实现`T*`在`shared_ptr<T>`类中都有一个本地缓存，因此该字段在堆栈上，`operator->`因此与使用堆栈本地的成本相当`T*`：根本没有开销。

> **第二个问题**：互斥体/原子

我希望 libstdc++ 在 x86 平台上使用原子，无论是通过标准设施还是特定的 g++ 内在函数（在旧版本中）。我相信 Boost 实施已经这样做了。

但是，我不能对 ARM 发表评论。

*注意：C++11 引入移动语义，在使用`shared_ptr`.*

*注意：阅读有关`shared_ptr` [此处](https://stackoverflow.com/questions/3628081/shared-ptr-horrible-speed/3630487#3630487)的正确用法，您可以使用对`shared_ptr`（`const`或不）的引用来避免大多数复制/破坏，因此它们的性能并不太重要。*

* * *

## 回答 #2

> 赞同：13
> 
> 时间：2012-06-06T14:42:46.147

GCC 的 shared_ptr 将在单线程代码中不使用锁定或原子。在多线程代码中，如果 CPU 支持原子比较和交换指令，它将使用原子操作，否则引用计数受互斥体保护。在 i486 和更高版本上它使用原子，i386 不支持 cmpxchg 因此使用基于互斥锁的实现。我相信 ARM 将原子用于 ARMv7 架构及更高版本。

（这同样适用于`std::shared_ptr`和`std::tr1::shared_ptr`。）

# c++ - std::async 变体，适用于集合

> ID：10902230
> 
> 赞同：3
> 
> 时间：2012-06-05T17:45:17.847
> 
> 标签：c++, concurrency, c++11, future

使用`std::async`我想知道是否有可能有一个辅助函数，它`std::future`从集合中创建 s （每个集合元素都有一个未来）。

我经常有以下情况：

```
auto func = []( decltype(collection)::reference value ) {
  //Some async work
};

typedef std::result_of<decltype(func)>::type ResultType;
std::vector<std::future<ResultType>> futures;
futures.reserve(collection.size());

// Create all futures
for( auto& element : collection ) {
  futures.push_back(std::async(func, element));
}

// Wait till futures are done
for( auto& future : futures ) {
  future.wait();
} 
```

为了能够轻松地重用它，我想出了以下部分代码：

```
template< class Function, class CT, class... Args>
std::vector<std::future<typename std::result_of<Function(Args...)>::type>>
async_all( Function&& f, CT& col ) {

    typedef typename std::result_of<Function(Args...)>::type ResultType;
    std::vector<std::future<ResultType>> futures;
    futures.reserve(collection.size());

    for( auto& element : collection ) {
        futures.push_back(std::async(func, element));
    }
}
return futures; 
```

现在我必须解决这个`Args`问题，因为`async_all`,`Args`不能再推导出来了。我目前唯一能想到的是另一个仿函数，它将集合中的元素转换为`Args`. 有没有更优雅的解决方案？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-06-05T18:58:22.900

您快到了。传递给的集合`async_all`包含我们唯一确定函数参数类型所需的所有信息；唯一的问题是如何提取这些信息。使用`auto`函数签名中的关键字，我们可以在函数参数之后写出返回类型。这不仅会产生更清晰的签名，而且还允许我们将参数值本身与`decltype`推导返回类型一起使用。例如：

```
template<typename F, typename CT>
auto reduce(F f, CT coll) -> decltype(f(*begin(coll), *begin(coll)); 
```

当然，还有其他方法可以确定提供的函数的参数类型（使用带有模板的函数签名推导）。但是，对于涉及重载函数和/或模板化函数对象的情况，这些方法可能会失败。

以下代码在 gcc 4.8 下编译并正常运行（打印“x=1”10 次）（早期版本应该可以正常工作）。注意我们甚至不必明确提及`std::future`：我们可以直接在`std::async`语句上使用 decltype 来推断它的类型。

```
#include <future>
#include <vector>
#include <iostream>

template<class Function, class CT>
auto async_all(Function f, CT col)
    -> std::vector<decltype(std::async(f, *std::begin(col)))>
{
    std::vector<decltype(std::async(f, *std::begin(col)))> futures;
    futures.reserve(col.size());

    for (auto& element : col) {
        futures.push_back(std::async(f, element));
    }
    return futures;
}

int main()
{
    using namespace std;
    for (auto& f : async_all([](int x) { cout << "x = " << x << endl; }, 
                             vector<int>(10, 1)))
       f.get();
} 
```

（`async_all`这里只计算一次，因为规范保证基于范围的 for 循环中的范围表达式）

# ruby-on-rails - Rails 3\. 如何从发票的行项目中建立一个表格并且行项目名称不同？

> ID：10902232
> 
> 赞同：-1
> 
> 时间：2012-06-05T17:45:22.850
> 
> 标签：ruby-on-rails, ruby

我已经打破了近两天的头，我找不到解决方案。

我有一张表格，列出发票编号、总额、已付金额和余额；它运作良好。现在我必须将所有行项目添加到表中。

invoices 表有以下列：of_lax、air_rate_customer、pss，所以这部分很简单，我只需要检查那里是否有值。

**棘手的部分**是`fcl_variable_cost_1_amount`属性，我得到了其中的 8 个（fcl_variable_cost_1_amount、fcl_variable_cost_2_amount 等）。

有一个对应的`fcl_variable_cost_1_amount`fcl_variable_cost_1_charge_id 链接到一个 Charge 表。

因此，在一张发票中，fcl_variable_cost_1_id 可能为 34，金额为 100 美元（id 34 对应于“ISF”）。

在另一张发票中，fcl_variable_cost_1_id 可能是 12，金额为 50 美元（id 12 对应于“考试费”）。

**那么如何使变量名称行项目出现在它们应该出现的列中？**

这是我的代码。还有一个截图。![在此处输入图像描述](../Images/cc7341de5a7fec6ac2ee153be76ae5a4.png)

```
<% headings = Hash.new %>
<% @shipments.each do |shipment| %>
<% unless shipment.invoice.nil? %>
  <% unless shipment.invoice.of_customer_amount_for_customer_inv.nil? %>
    <% headings['of_customer_amount_for_customer_inv'] = "Ocean Freight (FCL)" %>
  <% end %>
  <% unless shipment.invoice.of_lax.nil? %>
    <% headings['of_lax'] = "Ocean Freight (LCL)" %>
  <% end %>
  <% unless shipment.invoice.air_rate_customer.nil? %>
    <% headings['air_rate_customer'] = "Air Freight" %>
  <% end %>
  <% unless shipment.invoice.pss.nil? %>
    <% headings['pss'] = "PSS" %>
  <% end %>
  <% unless shipment.invoice.hc_lax.nil? %>
    <% headings['hc_lax'] = "HC LAX" %>
  <% end %>
  <% unless shipment.invoice.fcl_variable_cost_1_amount.nil? %>
    <% headings[(Charge.find(shipment.invoice.fcl_variable_cost_1_charge_id)).name] = Charge.find(shipment.invoice.fcl_variable_cost_1_charge_id).name %>
  <% end %>
  <% unless shipment.invoice.fcl_variable_cost_2_amount.nil? %>
    <% headings[(Charge.find(shipment.invoice.fcl_variable_cost_2_charge_id)).name] = Charge.find(shipment.invoice.fcl_variable_cost_2_charge_id).name %>
  <% end %>
  <% unless shipment.invoice.fcl_variable_cost_3_amount.nil? %>
    <% headings[(Charge.find(shipment.invoice.fcl_variable_cost_3_charge_id)).name] = Charge.find(shipment.invoice.fcl_variable_cost_3_charge_id).name %>
  <% end %>
  <% unless shipment.invoice.fcl_variable_cost_4_amount.nil? %>
    <% headings[(Charge.find(shipment.invoice.fcl_variable_cost_4_charge_id)).name] = Charge.find(shipment.invoice.fcl_variable_cost_4_charge_id).name %>
  <% end %>
  <% unless shipment.invoice.fcl_variable_cost_5_amount.nil? %>
    <% headings[(Charge.find(shipment.invoice.fcl_variable_cost_5_charge_id)).name] = Charge.find(shipment.invoice.fcl_variable_cost_5_charge_id).name %>
  <% end %>
  <% unless shipment.invoice.fcl_variable_cost_6_amount.nil? %>
    <% headings[(Charge.find(shipment.invoice.fcl_variable_cost_6_charge_id)).name] = Charge.find(shipment.invoice.fcl_variable_cost_6_charge_id).name %>
  <% end %>
  <% unless shipment.invoice.fcl_variable_cost_7_amount.nil? %>
    <% headings[(Charge.find(shipment.invoice.fcl_variable_cost_7_charge_id)).name] = Charge.find(shipment.invoice.fcl_variable_cost_7_charge_id).name %>
  <% end %>
  <% unless shipment.invoice.fcl_variable_cost_8_amount.nil? %>
    <% headings[(Charge.find(shipment.invoice.fcl_variable_cost_8_charge_id)).name] = Charge.find(shipment.invoice.fcl_variable_cost_8_charge_id).name %>
  <% end %>
<% end %>
<% end %>

<table>
  <tr>
    <th colspan="9">Customer AR Statement for <%= @customer.company_name %></th>
  </tr>
  <tr>
    <th style="text-align:center;">MTY</th>
    <th>Shipper</th>
    <th>HBL</th>
    <th>Container</th>
    <th>Status</th>
    <th>Age</th>
    <th>Delivered Customer</th>
    <th>Invoice Date</th>
    <% headings.each_pair do |k,v|%>
      <th><%= v %></th>
    <% end %>
    <th>Invoice Total</th>
    <th>Amount Paid</th>
    <th>Balance</th>
  </tr>

<% @shipments.each do |shipment| %>
  <tr>
    <td style="text-align:center;"><%= shipment.file_number %></td>
    <td><%= shipment.shipper.company_name %></td>
    <td><%= shipment.hbl %></td>
    <td><%= shipment.container %></td>
    <td><%= shipment.status %></td>
    <td><%= shipment.age %></td>
    <td><%= shipment.invoice.delivered_customer ? "Yes" : "No" %></td>
    <td><%= shipment.invoice.read_issued_at unless shipment.invoice.nil? %></td>
    <% if shipment.invoice.nil? %>
      <td colspan="<%= headings.count %>"></td>
    <% else %>
      <% headings.each_pair do |k,v| %>        
        <% if k == "of_lax" and !shipment.invoice.of_lax.nil? %>
          <td><%= number_to_currency shipment.invoice.lcl_of_customer_total %>
        <% elsif k == "of_customer_amount_for_customer_inv" and !shipment.invoice.of_customer_amount_for_customer_inv.nil? %>
          <td><%= number_to_currency shipment.invoice.of_customer_amount_for_customer_inv %></td>
        <% elsif k == "air_rate_customer" and !shipment.invoice.air_rate_customer.nil? %>
          <td><%= number_to_currency (shipment.volweight * shipment.invoice.air_rate_customer.to_s.to_d) %></td>
        <% elsif k == "pss" and !shipment.invoice.pss.nil? %>
          <td><%= number_to_currency (shipment.invoice.pss.to_s.to_d * shipment.volweight) %></td>
        <% elsif k == "hc_lax" and !shipment.invoice.hc_lax.nil? %>
          <td><%= number_to_currency (shipment.invoice.hc_lax.to_s.to_d * shipment.volweight) %></td>
        <% else %>
          <td></td>
        <% end %>

    <% end %>
    <% end %>
    <td style="text-align:right;"><%= number_to_currency shipment.invoice.customer_total unless shipment.invoice.nil? %></td>
    <td style="text-align:right;"><%= number_to_currency shipment.invoice.customer_amount_paid unless shipment.invoice.nil? %></td>
    <td style="text-align:right;"><%= number_to_currency shipment.invoice.customer_open_balance unless shipment.invoice.nil? %></td>
  </tr>
<% end %>
  <tr>
    <td colspan="<%= 7 + (headings.count) %>"></td>
    <th>Totals</th>
    <td style="text-align:right;"><%= number_to_currency @totals[:overall] %></td>
    <td style="text-align:right;"><%= number_to_currency @totals[:paid] %></td>
    <td style="text-align:right;"><%= number_to_currency @totals[:balance] %></td>
  </tr>
</table> 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-06-05T20:56:24.170

以备将来参考，以防有人遇到类似任务

```
<% headings = Hash.new %>
<% @shipments.each do |shipment| %>
<% unless shipment.invoice.nil? %>
  <% unless shipment.invoice.of_customer_amount_for_customer_inv.nil? %>
    <% headings['of_customer_amount_for_customer_inv'] = "Ocean Freight (FCL)" %>
  <% end %>
  <% unless shipment.invoice.of_lax.nil? %>
    <% headings['of_lax'] = "Ocean Freight (LCL)" %>
  <% end %>
  <% unless shipment.invoice.air_rate_customer.nil? %>
    <% headings['air_rate_customer'] = "Air Freight" %>
  <% end %>
  <% unless shipment.invoice.pss.nil? %>
    <% headings['pss'] = "PSS" %>
  <% end %>
  <% unless shipment.invoice.hc_lax.nil? %>
    <% headings['hc_lax'] = "HC LAX" %>
  <% end %>
  <% unless shipment.invoice.fcl_variable_cost_1_amount.nil? %>
    <% headings[(Charge.find(shipment.invoice.fcl_variable_cost_1_charge_id)).name] = Charge.find(shipment.invoice.fcl_variable_cost_1_charge_id).name %>
  <% end %>
  <% unless shipment.invoice.fcl_variable_cost_2_amount.nil? %>
    <% headings[(Charge.find(shipment.invoice.fcl_variable_cost_2_charge_id)).name] = Charge.find(shipment.invoice.fcl_variable_cost_2_charge_id).name %>
  <% end %>
  <% unless shipment.invoice.fcl_variable_cost_3_amount.nil? %>
    <% headings[(Charge.find(shipment.invoice.fcl_variable_cost_3_charge_id)).name] = Charge.find(shipment.invoice.fcl_variable_cost_3_charge_id).name %>
  <% end %>
  <% unless shipment.invoice.fcl_variable_cost_4_amount.nil? %>
    <% headings[(Charge.find(shipment.invoice.fcl_variable_cost_4_charge_id)).name] = Charge.find(shipment.invoice.fcl_variable_cost_4_charge_id).name %>
  <% end %>
  <% unless shipment.invoice.fcl_variable_cost_5_amount.nil? %>
    <% headings[(Charge.find(shipment.invoice.fcl_variable_cost_5_charge_id)).name] = Charge.find(shipment.invoice.fcl_variable_cost_5_charge_id).name %>
  <% end %>
  <% unless shipment.invoice.fcl_variable_cost_6_amount.nil? %>
    <% headings[(Charge.find(shipment.invoice.fcl_variable_cost_6_charge_id)).name] = Charge.find(shipment.invoice.fcl_variable_cost_6_charge_id).name %>
  <% end %>
  <% unless shipment.invoice.fcl_variable_cost_7_amount.nil? %>
    <% headings[(Charge.find(shipment.invoice.fcl_variable_cost_7_charge_id)).name] = Charge.find(shipment.invoice.fcl_variable_cost_7_charge_id).name %>
  <% end %>
  <% unless shipment.invoice.fcl_variable_cost_8_amount.nil? %>
    <% headings[(Charge.find(shipment.invoice.fcl_variable_cost_8_charge_id)).name] = Charge.find(shipment.invoice.fcl_variable_cost_8_charge_id).name %>
  <% end %>
<% end %>
<% end %>

<table>
  <tr>
    <th colspan="9">Customer AR Statement for <%= @customer.company_name %></th>
  </tr>
  <tr>
    <th style="text-align:center;">MTY</th>
    <th>Shipper</th>
    <th>HBL</th>
    <th>Container</th>
    <th>Status</th>
    <th>Age</th>
    <th>Delivered Customer</th>
    <th>Invoice Date</th>
    <% headings.each_pair do |k,v|%>
      <th><%= v %></th>
    <% end %>
    <th>Invoice Total</th>
    <th>Amount Paid</th>
    <th>Balance</th>
  </tr>

<% @shipments.each do |shipment| %>
  <tr>
    <td style="text-align:center;"><%= shipment.file_number %></td>
    <td><%= shipment.shipper.company_name %></td>
    <td><%= shipment.hbl %></td>
    <td><%= shipment.container %></td>
    <td><%= shipment.status %></td>
    <td><%= shipment.age %></td>
    <td><%= shipment.invoice.delivered_customer ? "Yes" : "No" %></td>
    <td><%= shipment.invoice.read_issued_at unless shipment.invoice.nil? %></td>
    <% if shipment.invoice.nil? %>
      <td colspan="<%= headings.count %>"></td>
    <% else %>

      <% headings.each_pair do |k,v| %>        
        <% if k == "of_lax" and !shipment.invoice.of_lax.nil? %>
          <td><%= number_to_currency shipment.invoice.lcl_of_customer_total %>
        <% elsif k == "of_customer_amount_for_customer_inv" and !shipment.invoice.of_customer_amount_for_customer_inv.nil? %>
          <td><%= number_to_currency shipment.invoice.of_customer_amount_for_customer_inv %></td>
        <% elsif k == "air_rate_customer" and !shipment.invoice.air_rate_customer.nil? %>
          <td><%= number_to_currency (shipment.volweight * shipment.invoice.air_rate_customer.to_s.to_d) %></td>
        <% elsif k == "pss" and !shipment.invoice.pss.nil? %>
          <td><%= number_to_currency (shipment.invoice.pss.to_s.to_d * shipment.volweight) %></td>
        <% elsif k == "hc_lax" and !shipment.invoice.hc_lax.nil? %>
          <td><%= number_to_currency (shipment.invoice.hc_lax.to_s.to_d * shipment.volweight) %></td>
        <% else %>
          <td>
              <% unless shipment.invoice.fcl_variable_cost_1_amount.nil? %>
                <% if Charge.find(shipment.invoice.fcl_variable_cost_1_charge_id).name == v %>
                  <%= number_to_currency shipment.invoice.fcl_variable_cost_1_amount %>
                <% end %>
              <% end %>
              <% unless shipment.invoice.fcl_variable_cost_2_amount.nil? %>
                <% if Charge.find(shipment.invoice.fcl_variable_cost_2_charge_id).name == v %>
                  <%= number_to_currency shipment.invoice.fcl_variable_cost_2_amount %>
                <% end %>
              <% end %>
              <% unless shipment.invoice.fcl_variable_cost_3_amount.nil? %>
                <% if Charge.find(shipment.invoice.fcl_variable_cost_3_charge_id).name == v %>
                  <%= number_to_currency shipment.invoice.fcl_variable_cost_3_amount %>
                <% end %>
              <% end %>
              <% unless shipment.invoice.fcl_variable_cost_4_amount.nil? %>
                <% if Charge.find(shipment.invoice.fcl_variable_cost_4_charge_id).name == v %>
                  <%= number_to_currency shipment.invoice.fcl_variable_cost_4_amount %>
                <% end %>
              <% end %>
              <% unless shipment.invoice.fcl_variable_cost_5_amount.nil? %>
                <% if Charge.find(shipment.invoice.fcl_variable_cost_5_charge_id).name == v %>
                  <%= number_to_currency shipment.invoice.fcl_variable_cost_5_amount %>
                <% end %>
              <% end %>
              <% unless shipment.invoice.fcl_variable_cost_6_amount.nil? %>
                <% if Charge.find(shipment.invoice.fcl_variable_cost_6_charge_id).name == v %>
                  <%= number_to_currency shipment.invoice.fcl_variable_cost_6_amount %>
                <% end %>
              <% end %>
              <% unless shipment.invoice.fcl_variable_cost_7_amount.nil? %>
                <% if Charge.find(shipment.invoice.fcl_variable_cost_7_charge_id).name == v %>
                  <%= number_to_currency shipment.invoice.fcl_variable_cost_7_amount %>
                <% end %>
              <% end %>
              <% unless shipment.invoice.fcl_variable_cost_8_amount.nil? %>
                <% if Charge.find(shipment.invoice.fcl_variable_cost_8_charge_id).name == v %>
                  <%= number_to_currency shipment.invoice.fcl_variable_cost_8_amount %>
                <% end %>
              <% end %>
          </td>
        <% end %>

    <% end %>
    <% end %>
    <td style="text-align:right;"><%= number_to_currency shipment.invoice.customer_total unless shipment.invoice.nil? %></td>
    <td style="text-align:right;"><%= number_to_currency shipment.invoice.customer_amount_paid unless shipment.invoice.nil? %></td>
    <td style="text-align:right;"><%= number_to_currency shipment.invoice.customer_open_balance unless shipment.invoice.nil? %></td>
  </tr>
<% end %>
  <tr>
    <td colspan="<%= 7 + (headings.count) %>"></td>
    <th>Totals</th>
    <td style="text-align:right;"><%= number_to_currency @totals[:overall] %></td>
    <td style="text-align:right;"><%= number_to_currency @totals[:paid] %></td>
    <td style="text-align:right;"><%= number_to_currency @totals[:balance] %></td>
  </tr>
</table> 
```

# php - PHP 匹配字符串，fnmatch 适合这项工作

> ID：10902237
> 
> 赞同：0
> 
> 时间：2012-06-05T17:45:51.487
> 
> 标签：php, string, comparison

我试图弄清楚如何将数组中的值与特定字符串进行比较。

基本上我的价值观看起来像 chrisx001, chrisx002, chrisx003, chrisx004, bob001

我在看，`fnmatch()`但我不确定这是正确的选择，因为我想做的是保留 chrisx --- 但忽略 bob --- 所以我需要在最后一位通配符，有没有办法做到这一点我可以在哪里

```
if($value == "chrisx%"){/*do something*/} 
```

如果可能的话，是否可以在其他情况下将 % 值仔细检查为 int 或类似？

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-06-05T17:47:23.853

正则表达式可以告诉您字符串是否以 chrisx 开头：

```
if (preg_match('/^chrisx/', $subject)) {
  // Starts with chrisx
} 
```

您还可以在 chrisx 之后捕获该位：

```
preg_match('/^chrisx(.*)/', $subject, $matches);

echo $matches[1]; 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-06-05T17:54:07.500

您可以过滤您的数组以返回仅包含以“chris”开头的条目的第二个数组，然后处理该过滤后的数组：

```
$testData = array ( 'chrisx001', 'chrisx002', 'chrisx003', 'chrisx004', 'bob001');
$testNeedle = 'chris';

$filtered = array_filter( $testData, 
                          function($arrayEntry) use ($testNeedle) { 
                              return (strpos($arrayEntry,$testNeedle) === 0); 
                          }
);

var_dump($filtered); 
```

# c++ - C++ 序列化的良好设计

> ID：10902240
> 
> 赞同：5
> 
> 时间：2012-06-05T17:46:01.530
> 
> 标签：c++, serialization, architecture

我目前正在寻找一个好的 OO 设计来序列化 C++/Qt 应用程序。
想象一下基于树结构组织的应用程序的类，使用复合模式实现，如下图所示。

我想到的两个可能的原则：

1.)
将 save()/load() 函数放在每个必须可序列化的类中。如果多次看到这种情况，通常使用 boost 来实现。在课堂上的某个地方，您会发现类似这样的内容：

```
friend class boost::serialization::access;
template<class Archive>
void serialize(Archive & ar, const unsigned int version)
{
    ar & m_meber1;
} 
```

你也可以把它分成 save() 和 load()。但这种方法的缺点是：
如果你想在两个月后改变序列化（到 XML、HTML 或一些非常奇怪的东西，boost 不支持）你必须采用所有数千个类。在我看来，这不是一个好的 OO 设计。
如果您想同时支持不同的序列化（XML、二进制、ASCII 等等），那么 80% 的 cpp 仅用于序列化函数。

2.)
我知道 boost 还提供了序列化的非侵入式版本

“http://www.boost.org/doc/libs/1_49_0/libs/serialization/doc/tutorial.html”

所以另一种方法是实现一个迭代器，它迭代复合树结构并序列化每个对象（以及一个用于反序列化的迭代器）
（我认为这是 .NET-Framework 的 XmlSerializer-Class 所做的，但我不是非常熟悉 .NET）
这听起来更好，因为单独的 save() 和 load() 并且如果序列化发生更改，只有一个地方可以更改。
所以这听起来更好，但是：
- 您必须为要序列化的每个参数提供一个 setter() 和一个 getter()。（所以，不再有私有数据了。（这是好/坏吗？））
- 您可能有一个长的继承层次结构（超过 5 个类）挂在复合树上。
那么如何调用派生类的setter()/getter()呢？当您只能调用基础 Composite-Component 的接口函数时。

另一种方法是将对象数据序列化为单独的抽象格式。所有可能的后续序列化（XML、TEXT、任何可能的）都从中获取数据。一个想法是将其序列化为 QDomNode。但我认为额外的抽象会降低性能。

所以我的问题是：
有没有人知道用于序列化的好的 OO 设计？
也许来自其他编程语言，如 JAVA、Python、C# 等等......

谢谢你。

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-06-05T19:54:59.483

小心序列化。

序列化是拍摄内存中表示的快照并在以后恢复它。

这一切都很好，除了当您考虑使用较新版本的软件（*向后兼容性*）加载先前存储的快照或（上帝禁止）使用旧版本的软件（*前向兼容性*）。

许多结构可以轻松处理向后兼容性，但是向前兼容性要求您的新格式*非常*接近其先前的迭代：基本上，只需添加/删除一些字段，但保持相同的整体结构。

问题在于，出于性能原因，序列化倾向于将磁盘结构与内存表示联系起来。然后，更改内存中的表示需要弃用旧存档（和/或迁移实用程序）。

另一方面，*消息*系统（这就是 google protobuf 是什么）是关于将交换的消息结构与内存中的表示分离，以便您的应用程序保持灵活性。

因此，您首先需要选择是实现*序列化*还是*消息传递*。

* * *

现在你是对的，你可以在类内或类外编写保存/加载代码。这又是一个权衡：

*   类内代码可以立即访问所有成员，通常更高效和直接，但灵活性较差，因此它与序列化齐头并进
*   类外代码需要间接访问（getter、访问者层次结构），效率较低，但更灵活，因此它与消息传递密切相关

*请注意，隐藏状态*没有缺点。A`class`没有（真正的）隐藏状态：

*   缓存（`mutable`值）就是这样，它们可以放心丢失
*   隐藏类型（think`FILE*`或其他句柄）通常可以通过其他方式恢复（例如，序列化文件名）
*   ...

* * *

我个人使用两者的混合。

*   缓存是为当前版本的程序编写的，并在`v1`. 编写新代码以同时使用`v1`和`v2`，并`v1`默认写入，直到以前的版本消失；然后切换到写作`v2`（假设它很容易）。有时，大规模的重构会使向后兼容性变得太痛苦，我们此时将其放在地板上（并增加主要数字）。
*   另一方面，与其他应用程序/服务的交换和更持久的存储（数据库或文件中的 blob）使用消息传递，因为我不想在未来 10 年内将自己束缚在特定的代码结构上。

*注意：我正在研究服务器应用程序，所以我的建议反映了这种环境的细节。我想客户端应用程序必须永远支持旧版本......*

# sql-server-2008 - SQL Server 2008 本机 SQL 密码恢复

> ID：10902244
> 
> 赞同：0
> 
> 时间：2012-06-05T17:46:34.570
> 
> 标签：sql-server-2008, passwords, password-recovery

我有一种情况，我需要在 SQL Server 2008（不是 R2，只是普通 2008）中确定数据库用户的密码。它是本机 SQL Server 帐户，没有为其分配密码限制/策略。我已经对 SQL Server 拥有完整的系统管理员访问权限；在正常情况下，我只需将此用户（不是`sa`用户）的密码重置为已知值，但是该帐户按原样用于各种进程，并且无法更改；不幸的是，现有的密码没有记录在任何地方，也没有人知道它是什么。

我在 SQL Server 2000 和 SQL Server 2005 中找到了许多不同的方法来执行此操作，但它们似乎都不能在 SQL Server 2008 中工作。请注意，用户确实处于活动状态，实际上它的凭据实际上保存在SQL Server Management Studio，我可以在其中使用我需要获取其密码的 SQL Server 用户登录——因此，我*知道*该帐户是好的。我只需要找出密码是什么！:P

非常感谢！

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-06-05T18:10:35.873

恐怕官方的立场是重置密码，我知道你不想这样做。除此之外，我相信您会被困在尝试声称具有此功能的第 3 方应用程序，但不能保证成功。当然，密码应该很难被发现......

# c# - 以编程方式检查 DevExpress CheckedComboBoxEdit 项

> ID：10902252
> 
> 赞同：4
> 
> 时间：2012-06-05T17:47:15.003
> 
> 标签：c#, winforms, devexpress

我有一个 CheckedComboBoxEdit，它绑定到一个 TableAdapter，它用项目列表填充它。

我有一个单独的查询，它返回一个数据集，其中列出了需要检查的项目。

我需要遍历 CheckedComboBoxEdit 项目以根据需要检查它们。

如何使 CheckedComboBoxEdit 反映查询中的数据，该查询返回需要检查的项目列表？

我在带有 DevExpress 10.2.9 的 Visual Studio 2010 中使用 C#。

对此问题的任何帮助将不胜感激，对此问题的任何其他解决方案也将非常有用。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-06-25T02:27:31.683

CheckedComboBoxEdit 的项目状态与其 EditValue 相关联。您可以通过设置适当的编辑器值来检查项目：用分隔符分隔的值列表（每个项目都有值和显示文本）。分隔符是通过 RepositoryItemCheckedComboBox.SeparatorChar 属性指定的。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2013-08-16T12:58:49.127

这里是如何

```
checkedComboBoxEdit1.Properties.SeparatorChar = ';';
// Set the edit value, assuming you have items named "one",and "two"
checkedComboBoxEdit1.SetEditValue("one; two"); 
```

[这](http://documentation.devexpress.com/#WindowsForms/DevExpressXtraEditorsCheckedComboBoxEdit_SetEditValuetopic)是完整的例子

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2015-06-10T13:57:04.083

短代码片段。

```
string str = "first;second";
string[] array = str.Split(';');
char separator = checkedComboBoxEdit1.Properties.SeparatorChar;
string result = string.Empty; 
foreach (var element in array){
   result += element + separator;
}

checkedComboBoxEdit1.SetEditValue(result); 
```

# drupal-7 - drupal 7 - drupal_goto 参数

> ID：10902254
> 
> 赞同：0
> 
> 时间：2012-06-05T17:47:18.297
> 
> 标签：drupal-7, drupal-views

我用视图模块制作了一个视图：“exampleview”

视图需要一个参数：“myarg”

我可以在“exampleview/myarg”和“exampleview”加载我的页面。

当我调用 drupal_goto('exampleview/myarg'); 目的地只是“exampleview”。

与以下结果相同：

$arr = array('exampleview','myarg'); drupal_goto($arr);

你能帮助我吗？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-06-06T23:17:01.020

这是来自[drupal_goto](http://api.drupal.org/api/drupal/includes!common.inc/function/drupal_goto/7)

> 通常重定向的 URL 是由这个函数的输入参数构造的。但是，您可以通过在 $_REQUEST 数组中设置目标来覆盖该行为（即通过使用 URI 的查询字符串）。这用于在完成表单后将用户引导回正确的页面。例如，在“管理员/内容”页面上编辑帖子后或使用侧边栏中的“用户登录”块登录后。函数 drupal_get_destination() 可用于帮助设置目标 URL。

似乎您的目标参数已设置，因此您必须清除目标参数或使用[标头功能](http://www.php.net/manual/en/function.header.php)

# ruby-on-rails-3 - 在 Rails 3 中强制 HTML 转义

> ID：10902255
> 
> 赞同：12
> 
> 时间：2012-06-05T17:47:19.763
> 
> 标签：ruby-on-rails-3, escaping, html-safe

我遇到了rails自动转义的问题。它目前认为一个字符串是 html_safe （它是），但出于显示目的，我仍然需要它来转义 html。这是字符串正在采取的步骤。

```
my_string = render(:partial => "set_string", :locals => {:item => @item})
<%= my_string %> 
```

部分基本上是

```
<h2>Page Header</h2>
<strong><%= item.name %></strong>
<%= item.body %>
etc 
```

我的理解是，因为我直接在视图中显示文本（h2 等），所以它假定它是安全的，并且它也正确地转义了项目输出，这使得整个 my_string 安全。所以，当我尝试用

```
<%= my_string %> 
```

它不会转义剩余的 html。我尝试添加 h 来强制转义，但这没有用。

所以我的问题是，除了在字符串上调用会使其不安全的东西之外，是否有强制 html 转义安全字符串的方法？

非常感谢你的帮助。

* * *

## 回答 #1

> 赞同：23
> 
> 时间：2012-12-21T00:54:12.510

## 在 Rails 3+ 中逃离 ActiveSupport::SafeBuffer

在这种情况下`<%= my_string.to_str %>`，将根据需要进行双重转义。

### 安全缓冲工作

当一个字符串被 Rails 转义时，你会得到一个`ActiveSupport::SafeBuffer`. 从那时起，将跳过额外的转义，因为`SafeBuffer`is `html_safe?`。这是一个聪明的解决方案！但是，有时我们希望摆脱这种聪明。

### 为什么要双逃？

我需要*重新转义标签助手生成的内容，*以将生成的标记传递给`data-`属性。这对于显示模板生成的代码也很方便。

### 强制`String`逃生`html_safe?`

调用`to_str`，`SafeBuffer`它返回一个`String`。

```
# Example html safe content
content = content_tag :code, 'codez<>'
content.html_safe? # true

# call .to_str
escaped = content.to_str
escaped.html_safe? # false

# The escaped String will now be re-escaped when used in a template 
```

### `to_s`问题_

该`to_s`方法看起来非常像该`to_str`方法。此处不要使用`to_s`，`ActionView::SafeBuffer#to_s`只需返回`self`，在上下文`to_str`上方调用where `SafeBuffer`，自然返回一个 unsafe `String`。

* * *

## 回答 #2

> 赞同：11
> 
> 时间：2012-06-10T12:55:41.497

感谢 Sebastien 的建议，我想在这里得到真正的答案，而不是埋在评论中：

我看起来像这样工作：

```
<%= raw CGI::escapeHTML(my_string) %> 
```

您需要“原始”调用，否则除了转义之外，escapeHTML 会使字符串不安全，因此自动转义双重转义它。

* * *

## 回答 #3

> 赞同：5
> 
> 时间：2012-06-06T09:30:17.557

要解释 html（这是我理解你需要的），你必须使用：

```
<%= raw my_string %> 
```

# javascript - javascript中可能的网络协议

> ID：10902256
> 
> 赞同：7
> 
> 时间：2012-06-05T17:47:21.477
> 
> 标签：javascript, node.js, network-protocols

[`XMLHttpRequest`](http://www.w3.org/TR/XMLHttpRequest/)在 JavaScript 中建立服务器连接时，HTTP (per) 的替代方案是什么？我唯一知道的是[WebSocket 协议](https://www.rfc-editor.org/rfc/rfc6455)（per [`WebSocket`](http://www.w3.org/TR/websockets/)）。包括它们相应的安全变体 https 和 wss。

是否可以使用 JavaScript 选择任意协议？您如何与 NTP、IMAP、UDP 等服务进行通信，例如 Node.js 中的服务？

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-06-05T18:13:42.997

在 Node.js 中，您几乎可以做任何事情。例如直接支持 UDP（ node.js 附带的[dgram](http://nodejs.org/api/dgram.html)模块），npm 有大量的第三方模块用于许多其他协议，例如 SMTP、IMAP、FTP 和 XMPP；请参阅[https://github.com/joyent/node/wiki/Modules](https://github.com/joyent/node/wiki/Modules)以获取一份列表。如果你找不到适合你喜欢的协议的现成模块，你可以自己实现一个。

现在，当涉及到浏览器时，您受到的限制要大得多。你列出的那些是我所知道的（当然不包括浏览器插件）。因此，您需要使用 HTTP(S) 或 ws(s) 连接到代理服务器，并从那里执行实际的协议内容。

# facebook - 使用 fql 获取 Facebook 事件

> ID：10902259
> 
> 赞同：1
> 
> 时间：2012-06-05T17:47:33.670
> 
> 标签：facebook, facebook-graph-api, facebook-fql

尝试使用以下查询通过 fql 检索 facebook 事件。我无法获得除“id”以外的场地详细信息。

fql?q=SELECT name,description,pic_small,pic_big,eid,venue,location from event WHERE eid in (SELECT eid FROM event_member WHERE uid = me())

输出 ：

```
{
  "data": [
    {
      "name": "HappyHour",
      "description": "Let's have fun !!!",
      "pic_small": "http://profile.ak.fbcdn.net/static-ak/rsrc.php/v2/yy/r/XcB-JGXohjk.png",
      "pic_big": "http://profile.ak.fbcdn.net/static-ak/rsrc.php/v2/yn/r/5uwzdFmIMKQ.png",
      "eid": ......,
      "venue": {
        "id": .......
      },
      "location": "The Crab Pot Seattle"
    }
  ]
} 
```

graph api doc说“正在举办被查询事件的地点。包含以下一个或多个字段：街道、城市、州、邮编、国家、纬度和经度。” 但除了场地ID，我没有看到任何这些。

我是否必须再次请求图形 API 才能获取场地位置详细信息？有没有更好的方法在一个查询本身中获取位置详细信息？

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2012-06-05T18:27:10.140

[您可以使用此 FQL Multiquery](https://developers.facebook.com/tools/explorer?method=GET&path=fql%3Fq%3D%7B%22event_info%22%3A%22SELECT%20name%2Cdescription%2C%20pic_small%2Cpic_big%2C%20eid%2Cvenue%2Clocation%20from%20event%20WHERE%20eid%20in%20(SELECT%20eid%20FROM%20event_member%20WHERE%20uid%20%3D%20me())%22%2C%20%22event_venue%22%3A%22SELECT%20name%2C%20username%2C%20page_id%2C%20location%20FROM%20page%20WHERE%20page_id%20IN%20(SELECT%20venue.id%20FROM%20%23event_info)%22%7D)获取事件的位置。

这将获得您的活动和有关其场地的信息。您必须自己编写一个脚本才能将它们组合成可用的东西。

```
fql?q={
 "event_info":
    "SELECT name,description, pic_small,pic_big, eid,venue,location 
      FROM event WHERE eid IN 
         (SELECT eid FROM event_member WHERE uid = me())", 
  "event_venue":
     "SELECT name, username, page_id, location 
        FROM page WHERE page_id IN 
          (SELECT venue.id FROM #event_info)"
 } 
```

Facebook 在 4 月的某个时候更改了事件的默认编码。过去总是返回所有位置数据。从那时起，只`id`返回了该位置的 。

# syntax - 如何制作跨越多行的haml-coffee 封口？

> ID：10902264
> 
> 赞同：5
> 
> 时间：2012-06-05T17:47:54.410
> 
> 标签：syntax, coffeescript, haml, hamlc

我正在尝试向我的一个模板添加少量逻辑（请不要责骂我将逻辑放入视图中的错误）并且很难获得正确的 hamlc 语法。

我正在迭代一个集合并想跳过另一个集合中存在的元素

直接的咖啡脚本看起来像：

```
for artwork in artworks
  unless _.find(cart_items, (ci) ->
    ci.id == artwork.product_code
      alert 'artwork not in cart' 
```

我正在努力：

```
- for artwork in artworks
  - unless _.find(cart_items, (ci) -> | # < multiline, right?
    ci.id == artwork.product_code
    - alert 'artwork not in cart' 
```

我得到了一些关于：

```
Block level too deep in line undefined 
```

有任何想法吗？TIA，比利

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-06-05T20:19:47.303

通过将闭包放在同一行上，我能够使其工作：

```
- for artwork in artworks
  - unless _.find(cart_items, (ci) -> ci.id == artwork.id)
    - alert 'not in the cart' 
```

# batch-file - 批处理日期时间戳比较

> ID：10902272
> 
> 赞同：2
> 
> 时间：2012-06-05T17:48:37.473
> 
> 标签：batch-file, timestamp, compare

嘿，我有这个小批处理文件，它应该比较两个文件的时间戳并返回 errorvlvl 0 或 2，具体取决于源文件是否更新（它作为参数传递了 2 个文件名）但我不认为 gtr 是适合时间戳的工作..我有时会工作而不是其他时间...我如何将时间戳解析为整数来比较它们。顺便说一句，变量 source 和 dest 看起来像这样（我回应他们看到）
05/06/2012 18:46

```
 REM I use the t prefix here to expand the file location parameters passed in, i       into  date/time values
set source=%~t1
echo %dest%
set dest=%~t2
echo %source%

if "%source%" gtr "%dest%" goto overwrite
exit /b 0 
:overwrite
REM if the source file is newer compare.bat will return an errorlevel of 2, this will    then be used in an if statement in the file that called compare.bat to go ahead and overwrite the older file
exit /b 2 
```

提前感谢您的任何建议！！:)

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-06-05T18:44:31.017

行。我明白了..我想！

```
set compsource= %dest:~6,4%%dest:~3,2%%dest:~0,2%%dest:~6,4%%dest:~11,2%%dest:~14,2% 
```

# asp.net-mvc-3 - ASP.NET MVC 3 Razor - 在同一页面/视图上注册和登录表单

> ID：10902273
> 
> 赞同：0
> 
> 时间：2012-06-05T17:48:40.040
> 
> 标签：asp.net-mvc-3, razor

我正在使用 ASP.NET、MVC3、Razor。在我的网站中，我在所有页面（在顶部标题中）都有登录表单，用户可以随时登录。当带有另一个表单的另一个页面出现时，就会出现问题。我无法弄清楚如何实现它。我已经尝试了很多，但我认为我需要一个非常小的例子来解决我的问题。该示例可以像在同一页面上的注册表单和登录表单一样简单，它们分别工作、所有验证和其他内容。登录表单和注册表单可以是部分视图，也可以是任何人可以建议的可重复使用的内容。

这是_Register.cshtml（共享视图）的代码

`@model MVCRnD.Models.RegisterModel`

 ````
@using (Html.BeginForm("Register","Account")) {

} 
````  `放置上述共享视图的 about.cshtml 的代码

 `````
@Html.Partial("_Register") 
```` 

`帐户控制器代码`

 ``[HttpPost]`

 ````
public ActionResult Register(RegisterModel model)
    {
        if (ModelState.IsValid)
        {
            // Attempt to register the user
            MembershipCreateStatus createStatus;
            Membership.CreateUser(model.UserName, model.Password, model.Email, null,   null, true, null, out createStatus);

            if (createStatus == MembershipCreateStatus.Success)
            {
                FormsAuthentication.SetAuthCookie(model.UserName, false /* createPersistentCookie */);
                return RedirectToAction("Index", "Home");
            }
            else
            {
                ModelState.AddModelError("", ErrorCodeToString(createStatus));
            }
        }

        // If we got this far, something failed, redisplay form
        return View(model);
    } 
````  `部分视图，即注册表单呈现良好。但是当我点击提交按钮时，它会发布整个表单，但会将我带到实际上是正确的寄存器 /Account/Register。但我想在同一页上，不去其他形式。你要我发送完整的代码吗？我可以把它上传到某个地方，然后把链接发给你。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-06-05T17:51:30.793

不确定您为什么会遇到问题，但是无论您使用哪种服务器端语言，将两个表单放在同一页面上都是一种非常常见的做法。

```
@using (Html.BeginForm("Logon", "Account")) {
   ...
}

@using (Html.BeginForm("Register", "Account")) {
   ...
} 
```

翻译为：

```
<form action="/Account/Logon" method="post">        
   ...
</form>

<form action="/Account/Register" method="post">        
   ...
</form> 
```````

# iphone - CCLayer 周围的边框

> ID：10902274
> 
> 赞同：1
> 
> 时间：2012-06-05T17:48:42.290
> 
> 标签：iphone, ios, cocos2d-iphone, cclayer

我正在使用 Cocos2d 拖动精灵，并在选择精灵时尝试添加边框。我可以显示我的白色背景，但事实证明我的边框特别困难。我有这个代码：

```
if(self.selectedSprite)
    self.selectedSprite = nil;

CCLayerColor *selectedLayer = [[CCLayerColor alloc] init];
//    CCSprite *backgroundSprite = [CCSprite spriteWithFile:@"white_1x1.gif" rect:CGRectMake(2,2,self.boundingBox.size.width-4,self.boundingBox.size.height-4)];
CCSprite *backgroundSprite = [CCSprite spriteWithFile:@"white_1x1.gif" rect:CGRectMake(0,0,self.boundingBox.size.width,self.boundingBox.size.height)];
[backgroundSprite setContentSize:CGSizeMake(self.contentSize.width-4, self.contentSize.height-4)];
backgroundSprite.anchorPoint = ccp(0,0);

CCRenderTexture* rt = [CCRenderTexture renderTextureWithWidth:backgroundSprite.texture.contentSize.width + 2  height:backgroundSprite.texture.contentSize.height+2];

[backgroundSprite setFlipY:YES];
[backgroundSprite setColor:ccc3(0,0,0)];
ccBlendFunc originalBlendFunc = [backgroundSprite blendFunc];
[backgroundSprite setBlendFunc:(ccBlendFunc) { GL_SRC_ALPHA, GL_ONE }];

CGPoint bottomLeft = ccp(backgroundSprite.texture.contentSize.width * backgroundSprite.anchorPoint.x + 1, backgroundSprite.texture.contentSize.height * backgroundSprite.anchorPoint.y + 1);
CGPoint position = ccpSub([backgroundSprite position], ccp(-backgroundSprite.contentSize.width / 2.0f, -backgroundSprite.contentSize.height / 2.0f));

[rt begin];

for (int i=0; i<360; i++) // you should optimize that for your needs
{
    [backgroundSprite setPosition:ccp(bottomLeft.x + sin(CC_DEGREES_TO_RADIANS(i))*1, bottomLeft.y + cos(CC_DEGREES_TO_RADIANS(i))*1)];
    [backgroundSprite visit];
}

[backgroundSprite setPosition:bottomLeft];
[backgroundSprite setBlendFunc:originalBlendFunc];
[backgroundSprite setColor:ccc3(255,255,255)];
[backgroundSprite visit];

[rt end];

[rt setPosition:position];

[selectedLayer addChild:rt];
[selectedLayer addChild:backgroundSprite];
self.selectedSprite = selectedLayer; 
```

我尝试了各种咒语，但似乎没有任何东西显示边界。我只需要一个矩形黑色边框，在我图层上其他所有内容的后面填充白色。

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-06-05T18:54:56.507

您可以创建自己的类，该类将包含您的精灵并在需要时在其上绘制边框。绘制`draw()`类的边框覆盖方法

```
-(void) draw
{
    if( m_needDrawRect == YES )
    {
        CGSize selfSize = [self contentSize];
        float selfHeight = selfSize.height;
        float selfWidth = selfSize.width;
        CGPoint vertices[4] = {ccp(0.f, 0.f), ccp(0.f, selfHeight), ccp(selfWidth, selfHeight), ccp(selfWidth, 0.f)};
        ccDrawPoly(vertices, 4, YES);
    }

} 
```

您在此方法中绘制的所有内容都将使用 zOrder 0 绘制，因此，要查看您的边框，请使用 zOrder -1 添加您的精灵。

# android - 如何让 ActionBarCompat 显示正常的默认图标（在清单中的 application/intent-filter android:icon 属性中设置）？

> ID：10902275
> 
> 赞同：0
> 
> 时间：2012-06-05T17:48:43.917
> 
> 标签：android

关于如何让 ActionBarCompat 在普通蜂窝/ics 操作栏显示的预蜂窝设备中显示默认图标的任何线索？即清单中`<application>`/属性中设置的图标。`<intent-filter>` `android:icon`

此外，有关如何获取 android:icon 的资源 ID 的信息也会有所帮助。

谢谢

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-06-20T20:15:08.223

那么，对于 pre-Honeycomb，您必须更改`ActionBarHelperBase.java`类中“HOME”ActionBar 元素引用的图标。这应该在`setupActionBar()`方法中的某个地方，如下所示：

```
homeItem.setIcon(R.drawable.ic_home); 
```

只需将其更改为

```
homeItem.setIcon(R.drawable.launcher); 
```

你应该很高兴。要在`android:icon`Honeycomb中进行更改，您需要更改.`values-v11\styles.xml``ActionBar`

希望有帮助。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-06-05T17:56:14.733

> > > 此外，有关如何获取 android:icon 的资源 ID 的信息也会有所帮助。

什么？如果您使用：`android:icon="@drawable/ic_launcher"`则资源 id 为`R.drawable.ic_launcher`.

另外，您提到`ActionBarCompat`...您在使用 ActionBarSherlock 吗？如果是这样，它应该默认显示该图标。你看到了什么？

# objective-c - iOS Facebook SDK SSO Safari 注销

> ID：10902278
> 
> 赞同：2
> 
> 时间：2012-06-05T17:48:55.973
> 
> 标签：objective-c, ios, facebook, single-sign-on

我在我的应用程序中使用最新的`Facebook`SDK `iOS`。

它使用单点登录，所以即使在调用`Facebook`注销方法后，当用户再次登录时，对话框窗口会说他已经登录正常。

在其他`iOS`应用程序中，Safari 网页视图上有一个注销按钮，因此用户可以简单地从应用程序中注销。

我的问题是如何`webView`在我的应用程序中实现这样的？

我知道我可以使用`FBDialog`而不是 Safari 窗口来控制注销过程，但我需要有可能从 Safari 网络视图中完全注销。可能只有旧版本的 SDK 才能访问带有注销按钮的窗口？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-06-05T18:24:11.607

我也面临这个问题，当应用程序正在开发中时，没有默认方法从 safari 上注销，可能是当您的应用程序在应用商店上线时，safari 会显示注销按钮

# asp.net - Jquery 调用 wcf 服务给出 200 Parser Error

> ID：10902280
> 
> 赞同：0
> 
> 时间：2012-06-05T17:48:56.810
> 
> 标签：asp.net, json, wcf, jquery, jsonp

我是 WCF 世界的新手。我有一个包含 Web 应用程序的解决方案（它有对 WCF 服务应用程序的 JQuery Ajax 调用，这是解决方案中的另一个项目。经过 2 天的工作（破解）我处于能够传递请求并获得响应的状态![在此处输入图像描述](../Images/aba93d2cb5255e9b492e34b603e5acb3.png)

但是在尝试显示警报时给了我 200 解析器错误。![在此处输入图像描述](../Images/3ee225713d12cc2577d96fbfc7552d50.png)

任何帮助将不胜感激

进一步参考

```
$.ajax({
                    async: true,
                    type: 'GET', //GET or POST or PUT or DELETE verb
                    url: 'http://localhost:61057/Service1.svc/GetCustomer', // Location of the service
                    dataType: 'jsonp', //Expected data format from server
                    success: function (data) {//On Successfull service call
                        ServiceSucceeded(data);
                    },
                    error: function () { ServiceFailed(Data); } // When Service call fails
                }); 
```

网页配置

```
 <system.serviceModel>
    <services>
      <service name="FIN.Services.Service1" behaviorConfiguration="DefaultBehavior">
        <endpoint address="http://localhost:61057/service1.svc" binding="webHttpBinding" contract="FIN.Services.IService1" behaviorConfiguration="AjaxBehavior">
          <identity>
            <dns value="locahost"/>
          </identity>
        </endpoint>
        <endpoint contract="IMetadataExchange" binding="mexHttpBinding" address="mex"/>
      </service>
    </services>
    <bindings>
      <webHttpBinding>
        <binding name="webBinding">
          <security mode="None">
          </security>
        </binding>
      </webHttpBinding>
    </bindings>
    <behaviors>
      <serviceBehaviors>
        <behavior name="DefaultBehavior">
          <serviceMetadata httpGetEnabled="true"/>
          <serviceDebug includeExceptionDetailInFaults="true"/>
        </behavior>
      </serviceBehaviors>
      <endpointBehaviors>
        <behavior name="AjaxBehavior">
          <enableWebScript/>
        </behavior>

      </endpointBehaviors>

    </behaviors>
  </system.serviceModel> 
```

服务接口：

```
[WebInvoke(ResponseFormat = WebMessageFormat.Json, Method = "GET", BodyStyle = WebMessageBodyStyle.WrappedRequest, RequestFormat = WebMessageFormat.Json)]
        [OperationContract]
        string GetCustomer(); 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-06-05T18:52:12.730

您正在使用 **jsonp**，意味着您要调用跨域服务。对于跨域服务，您的网址应如下所示

**http://localhost:61057/Service1.svc/GetCustomer?callback=?**

你还必须在 web.config 中进行一些更改

查看以下链接以获取完整示例

[在 wcf 中调用跨域服务](http://aspdotnetcodebook.blogspot.in/2012/02/calling-cross-domain-wcf-service-using.html)

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-06-05T18:45:55.967

如果您不需要参数，请在您的 ajax 调用中添加以下内容..

数据： ”{}”，

# php - AJAX 发布到 PHP

> ID：10902285
> 
> 赞同：-3
> 
> 时间：2012-06-05T17:49:07.797
> 
> 标签：php, javascript, jquery, ajax

数据字符串是：

```
{"feedback_type":"000","error_type":"","textarea":"blahblahblahblahblahblahblahblahblahblahblahblahblahblahblahblah"} 
```

我使用以下代码发布到 PHP：

```
// ajax post
$.ajax({
    type: "POST",
    url:  "core/poster.php" ,
    data:  dataString,
    success:function()
    {
        alert("Success!");
    }
});

return false; 
```

和 php 文件：

```
<?php

require 'Class_DBOperation.php';
require 'global.php';

// Establish Database Connection
$dbOperation = new class_DBOperation(DBHOST,DBUSER,DBPWD,DBNAME,DBCHARSET);

// Receive dataString
$content=$_POST['feedback_type'];
$run=mysql_query("insert into reports values (NULL, '".$content."')");

?> 
```

问题是为什么 $content 是空的？我应该怎么办 ？有任何想法吗？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-06-05T17:53:20.647

在你的成功函数中添加一个响应并提醒它

```
$.ajax({
    type: "POST",
    url:  "core/poster.php" ,
    data:  dataString,
    success:function(response)
    {
        alert(response);
    }
}); 
```

并在您的 poster.php 文件中尝试将以下内容添加到 PHP 标记的顶部。

```
ini_set("display_errors", 1);
var_dump($_POST); 
```

这应该为您提供一个开始和调试正在发生的事情的地方。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-06-05T17:56:14.790

删除参数名称的双引号

```
{
   feedback_type: "000",
   error_type: "",
   textarea: "blahblahblahblahblahblahblahblahblahblahblahblahblahblahblahblah"
} 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-06-05T20:56:57.693

您正在发送一个 JSON 字符串作为参数字符串。

参数格式应如下：

`foo=bar,foo2=bar2,foo3=bar3`ETC...

您可以重新格式化字符串以遵循规范：

**JS**：

```
var dataString = "feedback_type=000&error_type=&textarea=blahblahblah"; 
```

**PHP**：

```
echo $_POST['feedback_type']; // 000
echo $_POST['error_type']; // null
echo $_POST['textarea']; // blahblahblah 
```

或者您可以将 JSON 字符串作为 POST 参数传递：

**JS**：

```
var jsonObject = {
    "feedback_type" : "000",
    "error_type" : "", 
    "textarea" : "blahblah"
}

var jsonString = '{"feedback_type":"000","error_type":"","textarea":"blahblahblahblahblahblahblahblahblahblahblahblahblahblahblahblah"}';

// OR

var jsonString = JSON.stringify(jsonObject);

var dataString = "json_string=" + jsonString; 
```

**PHP**：

```
// String - suitable for database input
echo $_POST['json_string']; // String: {"feedback_type":"000","error_type":"","textarea":"blahblahblahblahblahblahblahblahblahblahblahblahblahblahblahblah"}

// Parse into array
$json_array = json_decode($_POST['json_string']); 
```

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2012-06-05T17:52:00.400

这不是一个直接的解决方案，但它可以帮助您找出问题所在。尝试转储 $_POST 超全局的内容，这将通知您数据是如何接收的。尝试类似：

```
print '<pre>';
print_r ($_POST);
print '<pre>'; 
```

# c# - GridView 不显示新插入的行

> ID：10902290
> 
> 赞同：0
> 
> 时间：2012-06-05T17:49:34.257
> 
> 标签：c#, asp.net

我正在使用gridview 和sqldatasource。当我在 gridview 中添加新行时，我需要刷新页面才能看到新行。视图状态已启用。

有什么我可以做的吗？

谢谢

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-06-05T17:58:12.430

GridView的`DataBind()`方法将重新加载数据。当您更改 SqlDataSource 的 selectStatement 时，它也特别有用。在更新 GridView 中包含的任何内容后使用它是一个好习惯。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-06-05T17:59:19.777

`DataBind()`插入新行后调用。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-06-05T17:51:35.397

调用`DataBind()`相关对象（在您的情况下，它可能是 SqlDataSource，否则通常是 GridView）。这样做应该会显示您的新记录，假设记录确实已添加（您应该验证这一点）。

参考：[Control.DataBind 方法](http://msdn.microsoft.com/en-us/library/w5e5992d)

# linux - sed 查找、匹配和替换

> ID：10902292
> 
> 赞同：1
> 
> 时间：2012-06-05T17:49:38.637
> 
> 标签：linux, sed, command

所以我有以下脚本（只是一个测试）

```
 #!/bin/bash
 for file in *
 do
 echo $file 
 done 
```

我正在尝试在文件周围添加括号。我还假装我不知道变量文件的全名。

```
 cat sc.sh | sed 's/fi*/(&)/g'
  #!/bin/bash
  (f)or (fi)le in *
  do
  echo $(fi)le
  done 
```

所以基本上我正在尝试匹配以 fi 开头的单词并在它们周围添加括号。我究竟做错了什么？我尝试了许多变体，但没有奏效。从我可以看到该命令匹配任何 f 或 fi 并在它们周围添加括号，但不是整个单词。为什么？

任何帮助将不胜感激。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-06-05T18:04:20.050

您的正则表达式`fi*`正在寻找一个 f 后跟 0 个或多个 i。你可能想要更像这样的东西：

```
cat tmp | sed 's/\bfi[^ ]*/(&)/g' 
```

`\bfi`查找后跟“fi”的单词边界（即单词的开头）。然后`[^ ]*`匹配单词中剩余的（非空格）字符。

# python - 图片未从表单上传

> ID：10902294
> 
> 赞同：0
> 
> 时间：2012-06-05T17:49:58.080
> 
> 标签：python, django

我想在我的 django 应用程序中保存和过滤用户的对象。输入以下代码后，图像字段没有将任何图像上传到我的数据库，也没有在我的模板中返回任何图像。

楷模

```
class Fin(models.Model):
    user=models.ForeignKey(User)
    title=models.CharField(max_length=250, help_text='3 bedroom flat for lease')
    main_view=models.ImageField(upload_to="photos",blank=True, null=True)
    side_view=models.ImageField(upload_to="photos",blank=True, null=True)
    address=models.CharField(max_length=200)
    city=models.CharField(max_length=200)
    state=models.CharField(max_length=200)
    guideline=models.TextField(max_length=1000)

   def __unicode__(self):
       return self.title

 class FinForm(ModelForm):
   class Meta:
      model=Fin
     fields=('title','main_view','side_view', 'address','city','state','guideline')
     exclude=('user') 
```

意见

```
 def fincrib(request):
          extra_data_context={}
          #if there's nothing in the field do nothing.
          if request. method=="POST":
             form =FinForm(request.POST)
             if form.is_valid():
                data=form.cleaned_data
                newfincribs=Fin(
                   user= request.user,
                   title=data['title'],
                   main_view=data ['main_view'],
                   side_view=data['side_view'],
                   address=data['address'],
                   city=data['city'],
                   state=data['state'],
                   guideline=data['guideline'])
               newfincribs.save()
             extra_data_context.update({'FinForm':form})
      else:
          form = FinForm()
          extra_data_context.update({'FinForm':form})
      extra_data_context.update({'Fins':Fin.objects.filter(user=request.user)})
      return render_to_response('post.html',extra_data_context,context_instance=RequestContext(request)) 
```

模板

```
 {% block content %}
        <form action="." method="POST">
            {% csrf_token %}
    <center> {{FinForm.as_p}}  </center>
       <input type="submit" value="Submit"/>
       </form>

         {% for Fin in Fins %}
             <tr>
            <a href="{% url profiles_edit_profile %}"> {{Fin.user}} </a> </p> </strong>
             <p>{{Fin.title}}</p>
             <p><img src="{{MEDIA_URL}}/{{Fin.main_view}}"/></p>
             <p> <img src="{{MEDIA_URL}}/{{Fin.side_view}}"/></p>
              <p> {{Fin.address}} </p>
              <p> {{Fin.city}}</p>
              <p> {{Fin.state}}</p>
              <p> {{Fin.guideline}}</p>
              {% endfor %}
           {% endblock %} 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-06-05T18:23:59.867

您在模板和视图层上遗漏了许多东西。

阅读：[https ://docs.djangoproject.com/en/1.3/topics/http/file-uploads/#basic-file-uploads](https://docs.djangoproject.com/en/1.3/topics/http/file-uploads/#basic-file-uploads)

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-06-05T18:25:41.133

从 django 官方文档中读取[绑定上传的文件到表单。](https://docs.djangoproject.com/en/dev/ref/forms/api/#binding-uploaded-files-to-a-form)我认为它可以提供帮助。

# clojure - 使用“休息”时抓住序列的头部

> ID：10902296
> 
> 赞同：3
> 
> 时间：2012-06-05T17:50:22.880
> 
> 标签：clojure

我正在解析一个大的 csv 文件，我使用它的第一行作为记录的键。所以对于像这样的csv文件：

```
header1,header2
foo,bar
zoo,zip 
```

我最终得到了一个惰性序列，例如：

```
({:header1 "foo" :header2 "bar"},
 {:header1 "zoo" :header2 "zip"}) 
```

代码工作正常，但我不确定在下面的函数中我是否持有“行”的头部。

```
(defn csv-as-seq [file]
  (let [rdr (clojure.java.io/reader file)]
    (let [lines (line-seq rdr)
         headers (parse-headers (first lines))]
      (map (row-mapper headers) (rest lines))))) 
```

有人可以澄清一下吗？

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2012-06-05T18:25:15.420

是的，这个表达在句法上说要抱头

```
(let [lines (line-seq rdr) 
```

尽管在这种情况下你应该摆脱它，因为它们 在调用 map 之后没有引用，`lines`并且从 1.2.x 开始的 Clojure 编译器包括一个名为**locals clearing**的功能：它将函数调用后未使用的任何 locals 设置为 nil在函数调用的序言中。在这种情况下，它将在函数的本地上下文中将行和标题设置为 nil，并且它们将在使用时被 GCd。这是 clojure 生成无法在 java 中表达的字节码的罕见情况之一。`headers`

# objective-c - 你如何在情节提要中调整 UISplitViewController 的详细视图的大小（视觉上，而不是编程方式）？

> ID：10902297
> 
> 赞同：11
> 
> 时间：2012-06-05T17:50:24.980
> 
> 标签：objective-c, ios, xcode, ios5, uistoryboard

在 IOS5 中，使用故事板，假设您有一个 UISplitViewController，它有一些视图被设置为它的主视图和正常的详细视图。其中一个详细视图被设置为 UISplitViewController 的初始详细视图控制器，因此它在情节提要中的大小是普通详细视图的大小。其他详细视图与此详细视图相接，并且由于接续关系，其大小也与正常详细视图相同。

当然，当您更改设备的方向时，它们都会动态调整大小。到现在为止还挺好。

现在假设您添加另一个 UIViewController，您打算将其用作 UISplitView 的详细视图。但是，在这种情况下，您将以*编程*方式使其成为详细视图，而不是使用“替换”segue。

在情节提要上，这个视图将是全尺寸的，也就是说，它看起来不像是细节视图。这使得在故事板中布置界面成为一个问题。

在随附的屏幕截图中，您可以看到最右侧的视图是全尺寸视图。我想让它在情节提要中调整大小。![最右边的视图应该是细节视图大小](../Images/4e67c3d28c920ffda57c114eb6c644d7.png)

这是怎么做到的？我在属性检查器中尝试了各种大小和选项的组合，但似乎没有什么效果。显而易见的选择是属性检查器的“模拟度量”部分中的“大小：详细信息”，但这似乎无济于事。 ![细节视图尺寸属性似乎什么都不做](../Images/742473e8d70556f86ae91d2a362c16b0.png)

* * *

## 回答 #1

> 赞同：20
> 
> 时间：2012-06-05T18:20:16.937

如果我理解您的问题（调整 viewController 的大小），我已经通过`Freeform`在 Size 框中进行选择来完成它，然后单击视图并通过 Inspector 设置其大小。

fwiw - 我还没有找到调整导航或选项卡控制器等内容的方法。

编辑：选择“自由格式”后，单击`View`，然后在 Identity Inspector 选项卡中设置大小，如下所示（不知道选项卡名称）

![在此处输入图像描述](../Images/d75b55ff38d8bdf7eae73402d5386b8a.png)

# xcode - Xcode Search Navigator _really_ 慢，但仅在特定项目中

> ID：10902300
> 
> 赞同：0
> 
> 时间：2012-06-05T17:50:36.653
> 
> 标签：xcode, search

最近，我的一个项目似乎几乎不可能在 Lion 上的 Xcode 4.3.2 中搜索到。使用搜索导航器在我的项目中查找任何内容基本上都会将我的整个计算机与沙滩球一起锁定 30 秒或更长时间。

我已经尝试删除 project.xcworkspace 文件（无论如何它非常小），但这并没有解决它。我试过点击 Xcode 活动查看器，但一切都被锁定了，所以我看不到任何有用的东西。

使用 Activity Monitor 应用程序，我可以在搜索开始时看到 CPU 峰值，然后恢复正常，然后 Xcode 挂起（显示为 Not Responding）直到它最终超时或其他情况。

其他项目还好。搜索正常进行。这只是在最近几周才开始的。

我真正担心的是硬盘驱动器问题，但这似乎非常本地化，并且磁盘工具认为我的驱动器很好。

我想我可以尝试复制我的项目并搜索副本。

有没有人见过这样的东西？！

[屏幕截图：查找卡住...](http://i.stack.imgur.com/xFUZu.png)

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-06-05T18:14:06.347

重建代码感知索引也不起作用。

我确实解决了这个问题。问题是我的项目中的一个文件 - 它似乎以某种方式损坏或损坏。它无法复制（这就是我发现罪魁祸首的方式）。它也不能“快速查看”或检查。

我所要做的就是删除损坏的文件，然后从我的源代码管理中恢复它。并且问题解决了。

现在，它是如何损坏的？我不知道。

# sql - 如何在不使用联合的情况下将这两个查询组合成一个查询

> ID：10902303
> 
> 赞同：1
> 
> 时间：2012-06-05T17:50:53.317
> 
> 标签：sql, oracle

```
SELECT b.KPCNO
         ,b.KPC_FULL_NAME    

FROM xxkpc_hr_personnel_v2  b
WHERE  b.type(+) = 'KPC Employee'
       AND b.DESIGNATION is null
       AND b.kpcno IS NOT NULL
       AND b.ORGANIZATION_ID=(select g.ORGANIZATION_ID from  xxkpc_fn_web_personnel_v g where g.kpcno = :kpcno)
GROUP BY b.KPCNO
          ,b.kpc_full_name

UNION

SELECT b.KPCNO
         ,b.KPC_FULL_NAME
FROM xxkpc_hr_pos_struct_code_comb   a
     ,xxkpc_hr_personnel_v2  b
WHERE b.position_id(+) = a.child_position_id
       AND b.type(+) = 'KPC Employee'
       AND b.kpcno IS NOT NULL
       AND a.PERANT_POSITION_ID =  (select g.POSITION_ID from  xxkpc_fn_web_personnel_v g where g.kpcno = :kpcno)
GROUP BY b.KPCNO
          ,b.kpc_full_name 
```

请我需要将这 2 个查询合并为一个查询而不使用 UNION

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-06-05T18:03:18.893

我想你可以这样写：

```
select distinct b.kpcno, b.kpc_full_name
  from xxxkpc_hr_personnel_v2 b
 where b.type(+) = 'KPC Employee'
   and b.kpcno is not null
   and (
         (b.designation is null and
          b.organization_id in (select g.organization_id
                                  from xxkpc_fn_web_personnel_v g 
                                 where g.kpcno = :kpcno))
         or
        (b.position_id in (select a.child_position_id
                             from xxkpc_hr_pos_struct_code_comb a
                            where a.parent_position_id = (select g.position_id
                                                            from xxkpc_fn_web_personnel_v g 
                                                           where g.kpcno = :kpcno)))
       ) 
```

据我所知，您正在使用`group by`来制作结果`distinct`，所以我使用了正确的关键字。And `a`and`b`没有左连接，因为在下一个 where `and`ed 子句中你说的是`a.parent_position_id = ....`。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-06-05T18:03:25.267

```
SELECT 
    b.KPCNO,
    b.KPC_FULL_NAME
FROM 
    xxkpc_hr_personnel_v2 b
        LEFT OUTER JOIN xxkpc_hr_pos_struct_code_comb a ON b.position_id = a.child_position_id
        INNER JOIN xxkpc_fn_web_personnel_v g ON g.kpcno = :kpcno
WHERE  
    b.type = 'KPC Employee'
AND b.kpcno IS NOT NULL
AND ((b.DESIGNATION IS NULL AND g.ORGANIZATION_ID = b.ORGANIZATION_ID) 
    OR (a.PERANT_POSITION_ID = g.POSITION_ID)) 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-06-05T17:53:45.067

你有没有[加入](http://docs.oracle.com/cd/B28359_01/server.111/b28286/queries006.htm)这两个表？看起来你可以加入 b.KPCNO 或 b.KPC_FULL_NAME。

# sql - PostgreSQL：如何以表格形式搜索字符串列表？

> ID：10902305
> 
> 赞同：5
> 
> 时间：2012-06-05T17:51:02.740
> 
> 标签：sql, postgresql

自从我不得不做任何数据库工作以来已经有一段时间了，所以我不太确定如何问这个问题，我知道我过去做过。
如何从字符串列表中创建一个临时表（不使用 CREATE TEMPORARY TABLE）？所以，如果你有类似的东西：

*   > '1', 'a', 'A'
    > '2', 'b', 'B'
    > '3', 'c', 'C'

*   ```
    SELECT  field2 
    FROM    { {'1','a','A'}, {'2','b','B'}, {'3','c','C'} } 
            AS fooarray(field1,field2,field3)
    WHERE   field1 = '2'
    -- should return 'b' 
    ```

提示：类似于...

*   ```
    SELECT * FROM unnest(array[...]); 
    ```

* * *

## 回答 #1

> 赞同：13
> 
> 时间：2012-06-05T19:01:22.023

[您根本不需要弄乱数组，您可以使用VALUES](http://www.postgresql.org/docs/current/interactive/queries-values.html)就地构建表：

> **7.7\. 值列表**
> 
> `VALUES`提供了一种生成“常量表”的方法，该表可以在查询中使用，而无需实际创建和填充磁盘上的表。

另请参阅[值](http://www.postgresql.org/docs/current/interactive/sql-values.html)。

所以你可以做这样的事情：

```
=> select *
   from (
       values ('1', 'a', 'A'),
              ('2', 'b', 'B'),
              ('3', 'c', 'C')
    ) as t(id, c1, c2)
    where id = '2';

 id | c1 | c2 
----+----+----
 2  | b  | B
(1 row) 
```

不要忘记为您的 VALUES 提供一个包含列名 ( `t(id, c1, c2)`) 的别名，以便所有内容都有名称。

# sql-server - 如何通过更改 IP 地址连接到 SQL Server Management Studio

> ID：10902306
> 
> 赞同：0
> 
> 时间：2012-06-05T17:51:03.287
> 
> 标签：sql-server, ip, ssms

我需要与另一个团队合作处理我需要连接到远程数据库的项目。我在 ADSL 上，所以我的 IP 地址一直在变化，每次它发生变化时，我都需要让远程人员知道，以便他们可以允许我的新 IP 地址。

有没有办法使用 DYNdns 自动更新该 IP 地址？或者至少设置一个脚本来检查我的 IP 地址，将其发送给他们，然后更新他们的 SQL Server Management Studio？

非常感谢！

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-06-05T18:01:54.010

建议可以使用：[http ://www.no-ip.com/](http://www.no-ip.com/)

例如，您可以使用动态更新客户端在动态 IP 上运行服务器，**以跟踪您的动态 IP 地址**。

[在此处查看有关此免费服务的更多信息](http://www.no-ip.com/services/managed_dns/free_dynamic_dns.html)

希望有帮助

# wix - 使用 WiX 删除应用程序使用 (r) 生成的文件

> ID：10902307
> 
> 赞同：1
> 
> 时间：2012-06-05T17:51:06.153
> 
> 标签：wix, uninstallation, user-data

目前，我们的用户数据层次结构如下所示：

LocalAppDataFolder/公司/产品

这是有道理的，因为用户可能安装了多个产品。但是，WiX 不会让我只删除 Product 文件夹。

```
<Directory Id="LocalAppDataFolder">
    <Directory Id="ManufacturerDir" Name="Company">
        <Directory Id="AppDataDir" Name="Product">
            <Component Id="AppData" Guid="some_guid">
                <RemoveFolder Id="AppDataDir" On="uninstall" />
                <RegistryValue Root="HKCU" Key="Software\Company\Product" Type="string" Value="" />
            </Component>
        </Directory>
    </Directory>
</Directory> 
```

上面的代码片段导致错误“LGHT0204 : ICE64: 公司目录在用户配置文件中，但未列在 RemoveFile 表中。” 显然，我不想擦除其他产品的数据。我发现的几个示例只有一个目录深度，即它们不包括中间目录，在本例中为 Company。

我觉得我在这里误解了一些东西。什么？非常感谢。

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-06-05T18:53:29.207

添加`<RemoveFolder Id="RemoveManufacturerDir" Directory="ManufacturerDir" On="Uninstall"/>`应该可以消除该错误。只有当目录为空时，该文件夹才会被删除。如果那里有其他文件，它不会被删除。

# rspec - 使用 Capybara/RSpec 测试链接的目标属性

> ID：10902308
> 
> 赞同：21
> 
> 时间：2012-06-05T17:51:10.073
> 
> 标签：rspec, capybara

我对 Rails/RSpec/Capybara 有点陌生，所以这可能是一个新手问题，但谷歌并没有像我希望的那样提供帮助。我希望我可以使用

```
it { should have_link('link text', href: 'url', target: '_blank') } 
```

为应该在新窗口中打开的链接编写测试，但这似乎不起作用。我还尝试将选项哈希包装在花括号中：

```
it { should have_link('link text', {href: 'url', target: '_blank'}) } 
```

无论被测试的实际页面和链接中目标属性的存在或值如何，测试都将始终成功。更改 href 属性确实会按预期导致测试失败。我认为 have_link 的选项哈希是要测试的属性列表。显然我错了，但是测试单个链接的目标属性的最佳方法是什么？希望不是使用 XPath 搜索...

* * *

## 回答 #1

> 赞同：27
> 
> 时间：2012-06-20T03:48:50.943

我不确定为什么您的代码不起作用。你有没有试过这个：

```
find_link('link_text')[:href].should == 'url'
find_link('link_text')[:target].should == '_blank' 
```

* * *

## 回答 #2

> 赞同：11
> 
> 时间：2015-09-10T13:31:45.700

使用新的 rspec 3 语法：

```
is_expected.to have_link('link_text', href: 'url')
expect(find_link('link_text')[:target]).to eq('_blank') 
```

* * *

## 回答 #3

> 赞同：6
> 
> 时间：2013-05-22T17:30:08.120

你可以这样做：

```
it { should have_css "a[href~='/somewhere'][target~='_blank']" } 
```

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2016-04-08T18:18:36.610

定义一个自定义匹配器来查找链接并检查其`target`属性是`'_blank'`：

```
RSpec::Matchers.define :have_link_open_in_new_window do |locator, options={}|
  match do |page|
    link = page.find_link(locator, options)
    link && link[:target] == '_blank'
  end
end 
```

使用`have_link_open_in_new_window(locator, options)`你会使用`have_link(locator, options)`：

```
expect(page).to have_link_open_in_new_window('Link text or id', href: '...') 
```

# asp.net - 有没有办法在 IIS 中列出输出缓存条目？

> ID：10902312
> 
> 赞同：0
> 
> 时间：2012-06-05T17:51:25.237
> 
> 标签：asp.net, .net, iis-7, iis-7.5, outputcache

有没有办法列出 IIS 7/7.5 输出缓存中的所有条目？

我知道我们在 PerfMon 中有输出缓存 # 条目，但我想至少看到那里的键。

有可能吗？

谢谢！

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-06-05T18:02:21.007

不确定我理解你的真正意思，但[netsh http show cache](http://msdn.microsoft.com/en-us/library/windows/desktop/cc307240%28v=vs.85%29.aspx)可能是你所追求的。

# fonts - 访问 Mono.Cairo FontMatrix？

> ID：10902316
> 
> 赞同：0
> 
> 时间：2012-06-05T17:51:33.337
> 
> 标签：fonts, mono, osx-lion, cairo

我正在尝试为我正在从事的项目编写字体导出器。为了正常工作，我需要获得每个字形的正确宽度。由于字体位图是按用户指定的比例生成的（例如`CairoContet.SetFontSize(...)`） ，这一点很复杂

当我尝试访问`CairoContext.FontMatrix`以扩展范围时，我得到以下 SIGSEGV：

```
Stacktrace:

Native stacktrace:

    0   mono                                0x000b6ea9 mono + 745129
    1   mono                                0x00006e0e mono + 24078
    2   libsystem_c.dylib                   0x949e259b _sigtramp + 43
    3   ???                                 0xffffffff 0x0 + 4294967295
    4   mono                                0x000b4e32 mono + 736818
    5   mono                                0x000b7ac4 mono + 748228
    6   mono                                0x000b8e18 mono + 753176
    7   mono                                0x00107a02 mono + 1075714
    8   ???                                 0x0035e2c1 0x0 + 3531457
    9   ???                                 0x003d9a18 0x0 + 4037144
    10  ???                                 0x0a20deb0 0x0 + 169926320

Debug info from gdb:

/tmp/mono-gdb-commands.ulVxAb:1: Error in sourced command file:
unable to debug self

=================================================================
Got a SIGSEGV while executing native code. This usually indicates
a fatal error in the mono runtime or one of the native libraries 
used by your application.
================================================================= 
```

这是触发它的代码，尽管通常任何尝试获取 FontMatrix 似乎都会导致相同的错误：

```
cr.FontMatrix.TransformDistance(ref xAdvance,ref yAdvance); 
```

是否有替代/更好的方法来扩大进步？我自己无法进行数学计算，因为由于 SetFontSize 的工作原理（它设置了 em-quad 的大小），我不确切知道 SetFontSize 设置的比例因子。

# windows-phone-7 - 如何使用 SAS 从 WP 应用程序将照片上传到 Azure Blob？

> ID：10902328
> 
> 赞同：0
> 
> 时间：2012-06-05T17:52:19.657
> 
> 标签：windows-phone-7, azure, azure-storage, azure-blob-storage

我可以使用以下代码从 Azure MVC Web 角色使用 SAS 将照片上传到 blob：

```
using (var WS = new HLServiceClient())
{    
     /* Getting a SAS Write URI */
     var sasUri = WS.GetSasUriForBlobWrite(HLServiceReference.BusinessLogicMediaUsage.News, fileName);
     var writeBlob = new CloudBlob(sasUri);
     writeBlob.UploadFromStream(fileData.InputStream);
} 
```

我想从 WP 应用程序做同样的事情。但我不知道该怎么做。我没有很多编程技巧。

你能告诉我如何使用 SAS 从 WP 应用程序将照片上传到 blob 吗？

NuGet 上有一个适用于 Windows Phone 的 Windows Azure 存储客户端库：Phone.Storage，上面写着“Windows Phone 的类库以直接与 Windows Azure 存储服务通信”，我希望找到一个简单的解决方案： [http： //www.nuget.org/packages/Phone.Storage](http://www.nuget.org/packages/Phone.Storage)

我在 Phone.Storage NuGet 上找到了一个视频教程：http: [//channel9.msdn.com/posts/Using-the-Windows-Phone-Storage-NuGets-for-Windows-Azure](http://channel9.msdn.com/posts/Using-the-Windows-Phone-Storage-NuGets-for-Windows-Azure)

还有一个示例应用程序演示了 Phone.Storage NuGet 的用法。 [http://www.nuget.org/packages/Phone.Storage.Sample](http://www.nuget.org/packages/Phone.Storage.Sample)

但是，如果我可以在我的应用程序场景中实现它，它会避开我吗？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-06-06T02:11:46.447

首先，您需要从托管服务生成 SAS。您可以使用 CloudBlob.GetSharedAccessSignature 方法（有关示例，请参阅[http://msdn.microsoft.com/en-us/library/windowsazure/ee772922.aspx](http://msdn.microsoft.com/en-us/library/windowsazure/ee772922.aspx)）。

在 Windows Phone 端，对于小文件，您只需向 SAS URL 发出 HTTP 请求。您可以使用 HttpWebRequest 来做到这一点。尝试在网上搜索，可以找到很多示例，例如[http://blogs.msdn.com/b/devfish/archive/2011/04/07/httpwebrequest-fundamentals-windows-phone-services-consumption -part-2.aspx](http://blogs.msdn.com/b/devfish/archive/2011/04/07/httpwebrequest-fundamentals-windows-phone-services-consumption-part-2.aspx)。

对于大文件（大于 64 MB），您需要将它们分成较小的块，将每个块作为一个块上传，然后提交 blob 列表（PUT 块列表：http: [//msdn.microsoft.com/en-us /图书馆/windowsazure/dd179467](http://msdn.microsoft.com/en-us/library/windowsazure/dd179467)）。这是一项乏味但并不困难的任务。您需要创建相当多的 HTTP 请求。

适用于 Windows Phone 的 Windows Azure 工具包也可能有所帮助：[http](http://watwp.codeplex.com/) ://watwp.codeplex.com/ 。它包含一个类似于 .NET 的 Windows Azure 库的库。

# android - 单击按钮时如何在android中旋转位图？

> ID：10902331
> 
> 赞同：0
> 
> 时间：2012-06-05T17:52:41.857
> 
> 标签：android, image

旋转位图时出现问题。我的要求如下，

1.  通过 Camera 捕获图像并将捕获的图像显示在 ImageView 中。
2.  当我单击/触摸图像时，在图像视图上显示两个按钮。一个按钮用于将图像相对于顺时针（45 度）方向旋转，另一个按钮用于将图像相对于逆时针方向旋转。

    我在这个过程中使用了下面的代码，不幸的是它只工作一次，当我第一次点击按钮时，ti 将旋转对应于 45 度的图像，之后按钮点击没有变化。//点击

    公共无效 onClick（查看 v）{

    ```
     switch (v.getId()) {

        case R.id.right_image_rotate:

            try {
                System.gc();
                Runtime.getRuntime().gc();
                unbindDrawables(findViewById(R.id.image_viewer));
                imageRotate();
            } catch (Exception e) {
                // TODO Auto-generated catch block
                e.printStackTrace();
            }
            break;

        case R.id.left_image_rotate:

            try {
                System.gc();
                Runtime.getRuntime().gc();
                unbindDrawables(findViewById(R.id.image_viewer));
                imageRotate();
            } catch (Exception e) {
                // TODO Auto-generated catch block
                e.printStackTrace();
            }
            break;
        case R.id.image_viewer:
            rotateLayout.setVisibility(View.VISIBLE);
            imageLeft_rotate.setVisibility(View.VISIBLE);
            imageRight_rotate.setVisibility(View.VISIBLE);
            break;
        default:
            break;
        }
    }

        Bitmap bitmapOrg = BitmapFactory.decodeFile(saved_image_file
                .getAbsolutePath());

        int width = bitmapOrg.getWidth();

        int height = bitmapOrg.getHeight();

        int newWidth = 200;

        int newHeight = 200;

        // calculate the scale - in this case = 0.4f

        float scaleWidth = ((float) newWidth) / width;

        float scaleHeight = ((float) newHeight) / height;

        Matrix matrix = new Matrix();

        matrix.postScale(scaleWidth, scaleHeight);
        matrix.postRotate(45);

        Bitmap resizedBitmap = Bitmap.createBitmap(bitmapOrg, 0, 0, width,
                height, matrix, true);

        srcBitmap.setScaleType(ScaleType.CENTER);
        srcBitmap.setImageBitmap(resizedBitmap); 
    ```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-06-05T18:02:30.493

这是因为每次单击按钮时，您仍然引用原始图像，而不是您更改的图像。如果您想继续旋转或修改更改后的图像，则必须引用它；不是原版。

只需创建一个全局变量并将更改的位图存储在其中。然后当按下按钮时，检查它是否为空。如果为null，则使用原来的；否则使用已更改的

# python - 多个文件上传django

> ID：10902340
> 
> 赞同：1
> 
> 时间：2012-06-05T17:53:19.563
> 
> 标签：python, django, django-forms, multifile-uploader

我知道如何在 djnago 中上传多个文件。我用：

```
<form enctype="multipart/form-data" action="" method="post">
    {% csrf_token %}
    <p>Press control to upload more than image at same time</p>
    <input type="file" name="myfiles" multiple>
    <input type="submit" name="upload" value="Upload">
</form> 
```

但我想要的是单个文件上传，但允许用户单击“+”按钮并自动创建新文件上传，允许用户上传多个文件。比如在hotmail中附加一个文件。

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2012-06-05T18:04:03.503

您正在寻找一个`FormSet`- 一组多个表单，以及一些用于填充新表单的 JavaScript。

[https://docs.djangoproject.com/en/dev/topics/forms/formsets/](https://docs.djangoproject.com/en/dev/topics/forms/formsets/)

以下是对 JS 代码的一些参考，它们将有助于为新表单动态构建 HTML：

[使用 Ajax 将表单动态添加到 Django 表单集](https://stackoverflow.com/questions/501719/dynamically-adding-a-form-to-a-django-formset-with-ajax)

* * *

设置表单集很容易（到处都有文档记录），但您可能需要 JS 部分的帮助：

我实际上使用不同的方法来动态添加表单。我设置了一个隐藏的 div，它的属性中`formset.empty_form`带有易于替换`__prefix__`的 es：

```
var form_count = {{ formset.total_form_count }};
$('#add_form').click(function() {
    var form = $("#empty_form").html().replace(/__prefix__/g, form_count);
    $('#forms').append(form);
    form_count++;
    $('#id_form-TOTAL_FORMS').val(form_count);
});

<div id="empty_form" style="display:none;">
    {{ formset.empty_form.as_p }}
</div>
<div id="add_form">Add another form</div>
<form id="forms">
    {{ formset.management_form }}
    {% for form in formset %}
        {{ form.as_p }}
    {% endfor %}
</form> 
```

# mysql - 安装 LAMP 堆栈后运行 MYSQL

> ID：10902342
> 
> 赞同：0
> 
> 时间：2012-06-05T17:53:24.930
> 
> 标签：mysql

当我运行 mysql -u root -p 时，我收到一条消息说

```
bash: mysql: command not found 
```

我不确定为什么会收到此错误。我已经和我的系统管理员谈过了，说已经安装了 LAMP 堆栈。现在我需要运行 mysql 开始创建数据库。

这是他发的邮件：

```
Mysql 5.1.32 is already installed on the vm name@..net.
    [root@name~]# mysql -V
    mysql  Ver 14.14 Distrib 5.1.32, for unknown-linux-gnu (x86_64) using readline 5.1 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-06-05T18:35:19.127

请检查您的 mysql 服务器是否正在运行。如果没有，则使用：

```
/etc/init.d/mysqld start 
```

然后尝试命令：

```
mysql -u root -p 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-06-05T18:45:58.627

检查与

```
service mysql status 
```

或者

```
service mysqld status 
```

# sql - 查询以计算唯一关系的数量

> ID：10902344
> 
> 赞同：3
> 
> 时间：2012-06-05T17:53:34.877
> 
> 标签：sql, oracle

我有 3 个表：
t_user (id, name) t_user_deal (id, user_id, deal_id) t_deal (id, title)

多个用户可以链接到同一个交易。（我正在使用oracle，但应该是相似的，我可以适应它）

我怎样才能获得所有用户（名称）以及他与之交易的唯一用户数。

让我们用一些数据来解释：

```
t_user:
id, name
1, joe
2, mike
3, John

t_deal:
id, title
1, deal number 1
2, deal number 2

t_user_deal:
id, user_id, deal_id
1, 1, 1
2, 2, 1
3, 1, 2
4, 3, 2 
```

我期望的结果：user_name，他与 Joe 达成交易的唯一用户数，2 Mike，1 John，1

我已经尝试过了，但没有得到预期的结果：

```
SELECT tu.name,
    count(tu.id) AS nbRelations
FROM t_user tu
INNER JOIN t_user_deal tud ON tu.id = tud.user_id 
INNER JOIN t_deal td ON tud.deal_id = td.id 
WHERE 
(
    td.id IN 
    (
      SELECT DISTINCT td.id 
      FROM t_user_deal tud2 
      INNER JOIN t_deal td2 ON tud2.deal_id = td2.id 
      WHERE tud.id <> tud2.user_id
    )
) 
GROUP BY tu.id
ORDER BY nbRelations DESC 
```

感谢您的帮助

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-06-05T18:19:08.853

这应该会给你结果

```
 SELECT id1, count(id2),name
     FROM ( 
            SELECT distinct tud1.user_id id1 , tud2.user_id id2
            FROM t_user_deal tud1, t_user_deal tud2 
            WHERE tud1.deal_id = tud2.deal_id
            and tud1.user_id <> tud2.user_id) as tab, t_user tu
     WHERE tu.id = id1 
     GROUP BY id1,name 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-06-05T18:10:26.653

就像是

```
select name, NVL (i.ud, 0) ud from t_user join (
SELECT user_id, count(*) ud from t_user_deal group by user_id) i on on t_user.id = i.user_id
where i.ud > 0 
```

除非我在这里遗漏了一些东西。这实际上听起来像您的问题引用在 t_user_deal 表中有第二个用户。您在此处描述的模型不包括该模型。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-06-05T18:30:44.063

PostgreSQL 示例：

```
create table t_user (id int, name varchar(255)) ;
create table t_deal (id int, title varchar(255)) ;
create table t_user_deal (id int, user_id int, deal_id int) ;

insert into t_user values (1, 'joe'), (2, 'mike'), (3, 'john') ;
insert into t_deal values (1, 'deal 1'), (2, 'deal 2') ;
insert into t_user_deal values (1, 1, 1), (2, 2, 1), (3, 1, 2), (4, 3, 2) ; 
```

和查询......

```
SELECT
  name, COUNT(DISTINCT deal_id)
FROM
  t_user INNER JOIN t_user_deal ON (t_user.id = t_user_deal.user_id)
GROUP BY
  user_id, name ; 
```

DISTINCT 可能不是必需的（即在 COUNT() 中）。取决于您的数据有多干净（例如，没有重复的行！）

这是 PostgreSQL 中的结果：

```
 name | count 
------+-------
 joe  |     2
 mike |     1
 john |     1
(3 rows) 
```

# xcode - OSAScript 中的多行文本框

> ID：10902345
> 
> 赞同：1
> 
> 时间：2012-06-05T17:53:45.210
> 
> 标签：xcode, osascript

我想编辑 TestFlightApp 存档脚本，以便当它提示发布说明时，它将是一个比一行更大的文本框。现在它显示一行的大小，但允许我按 CTRL+J 添加多行。

但是，我的问题是试图查看我输入的内容很痛苦，因为我一次只能查看一行。

这就是我所拥有的。

```
# Bring up an AppleScript dialog in Xcode to enter the Release Notes for this (beta) build:
NOTES=`osascript -e "tell application \"Xcode\"" -e "set notes_dialog to display dialog \"Please provide some release notes:\nHint: use Ctrl-J for New Line.\" default answer \"\" buttons {\"Next\"} default button \"Next\" with icon 1" -e "set notes to text returned of notes_dialog" -e "end tell" -e "return notes"` 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-06-06T18:02:17.803

这是不可能的，**Xcode**或 Automator 中显示对话框的文本字段无法调整大小。但这可以使用 osax "StandardAdditions" 的显示对话框来实现。试试这个。

```
notes=`osascript -e "tell application \"Dock\"" -e "activate" -e "display dialog \"Please provide some release notes.\" default answer \"\r\r\r\r\r\r\r\r\r\" buttons {\"Next\"} default button \"Next\" with title \"Xcode\"" -e "set notes to text returned of the result" -e "end tell" -e "set {tid, text item delimiters} to {text item delimiters, \"\n\"}" -e "set r to (paragraphs of notes) as string" -e "set text item delimiters to tid" -e "activate application \"Xcode\"" -e "return r"` 
```

文本字段显示 9 行。添加一行：按回车键。如果超过 9 行，可以使用（箭头键、翻页键或鼠标）滚动。脚本将**回车**符转换为换行符，它不返回尾随的空行。

# sql - PostgreSQL 约束问题

> ID：10902347
> 
> 赞同：1
> 
> 时间：2012-06-05T17:53:45.403
> 
> 标签：sql, postgresql

我有这两个错误：

错误：引用表“flight”的给定键没有唯一约束匹配

***********错误******* **********

 *****错误：引用表“flight”的给定键没有唯一约束匹配

这是我的代码：

```
CREATE TABLE Staff (
 EmployeeNumber int NOT NULL,
 FirstName char(15) NOT NULL,
 LastName char(15) NOT NULL,
 SocialSecurity int NOT NULL,
 Sex  char(1) NOT NULL,
 Address  char(20) NOT NULL,
 City  char(20) NOT NULL,
 Province char(15) NOT NULL,
 Country  char(20) NOT NULL,
 Primary Key (EmployeeNumber)
 );

CREATE TABLE FlightAttendent (
 FALN  int,
 StaffRole char (20) NOT NULL,
 EmployeeNumber int NOT NULL,
 Foreign Key (EmployeeNumber) References Staff(EmployeeNumber),
 Primary Key (FALN)
 );

Create TABLE AircraftType (
 ACType  char (10),
 Instrument char(1) NOT NULL,
 Engines  int NOT NULL,
 CrewCount int NOT NULL,
 PassengerCount int NOT NULL,
 Primary Key (ACType)
 );

CREATE TABLE Pilot (
 PILN  int,
 MedicalValid date NOT NULL,
 StaffRole char (20) NOT NULL,
 EmployeeNumber  int NOT NULL,
 AircraftType char (10) NOT NULL,
 Foreign Key (EmployeeNumber) references Staff(EmployeeNumber),
 Foreign Key (AircraftType) References AircraftType(ACType),
 Primary Key (PILN)
 );

Create TABLE Aircraft (
 AircraftID  char(6) NOT NULL,
 AircraftManufacturer char(10) NOT NULL,
 AircraftType  char(10) NOT NULL,
 Foreign Key (AircraftType) References AircraftType(ACType),
 Primary Key (AircraftID)
 );

CREATE Table Airport (
 AirportCode char(4) NOT NULL,
 AirportName char(40) NOT NULL,
 City  char(20) NOT NULL,
 Country  char(20) NOT NULL,
 Continent char(20) NOT NULL,
 Primary Key (AirportCode)
 );

Create TABLE Flight (
 FlightID  char (20),
 FlightDate  date,
 AircraftID  char(6) NOT NULL,
 ArrivalAirport  char(4) NOT NULL,
 DepartureAirport char(4) NOT NULL,
 PRIMARY KEY (FlightID, FlightDate),
 FOREIGN Key (ArrivalAirport) references Airport(AirportCode),
 FOREIGN Key (DepartureAirport) references Airport(AirportCode),
 FOREIGN KEY (AircraftID) references Aircraft(AircraftID)
 );

Create TABLE FlightCrew (
 FlightID char (20) REFERENCES Flight(FlightID) ON DELETE CASCADE,
 FlightDate date REFERENCES Flight(FlightDate) ON DELETE CASCADE,
 EmployeeNumber int NOT NULL,
 StaffRole char(20) NOT NULL,
 PRIMARY KEY(FlightID, FlightDate),
 Foreign Key (EmployeeNumber) references Staff(EmployeeNumber)
 );

CREATE Table Passenger (
 PassengerNumber int,
 PassportNumber int NOT NULL,
 Citizenship char (20) NOT NULL,
 FirstName char (20) NOT NULL,
 LastName char (20) NOT NULL,
 Primary Key (PassengerNumber)
 );

CREATE Table PassengerManifest (
 FlightID char(20),
 FlightDate date,
 PassengerNumber int NOT NULL,
 Foreign Key (FlightDate) References Flight(FlightDate),
 Foreign Key (PassengerNumber) References Passenger(PassengerNumber),
 Primary Key (FlightID, FlightDate)
 ); 
```

我做错了什么？谢谢！

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-06-05T18:07:23.753

当主键中有多个值时，需要以不同的方式引用它作为外键。

基本上，当你说

```
FlightID char (20) REFERENCES Flight(FlightID) ON DELETE CASCADE, 
```

PostgreSQL 检查那个不存在的主键（因为该表上的主键是 (flightid, flightdate)）。

所以`REFERENCES`在引用飞行表时删除子句，并添加

```
FOREIGN KEY (FlightID, FlightDate) REFERENCES Flight (FlightID, FlightDate) 
```

以您在其他一些表定义中的方式。*****

# c - 使用 -fomit-frame-pointer -mrtd 编译 c 会在空闲函数指针上创建段错误

> ID：10902348
> 
> 赞同：1
> 
> 时间：2012-06-05T17:53:53.837
> 
> 标签：c, gcc, segmentation-fault

如果我使用 -fomit-frame-pointer 和 -mrtd 使用 GCC 编译，此 c 代码会因分段错误而崩溃。

我的代码在某种程度上是错误的吗？其他函数指针按预期工作，但不是在传递它的自由函数时？编译时收到警告，但我不明白为什么或应该做些什么来修复。（我通常不在 c 中编码，这个错误来自我使用的 3d 零件库）

我需要 rtd/stdcall 因为我在 Windows 上并且需要使用 ctypes 从 python 调用这个库，并且在使用 -O1 与 GCC 编译时默认包含 -fomit-frame-pointer。（GCC 版本是 4.6.1 from TDM/Mingw32） 感觉有点奇怪，默认优化选项会出问题？

c代码：

```
#include <stdlib.h>

// void free ( void * ptr );
void test(void* o, void (*freeFunc)(void*)) {
    freeFunc(o);
}

int main() {
    int *p = (int *)calloc(1, sizeof(int));
    test(p, free);
} 
```

编译：

```
gcc -fomit-frame-pointer -mrtd -c fx.c
gcc -fomit-frame-pointer -mrtd fx.o -o fx.exe 
```

编译警告：

```
fx.c: In function 'main':
fx.c:11:5: warning: passing argument 2 of 'test' from incompatible pointer type[enabled by default]
fx.c:5:6: note: expected 'void (*)(void *)' but argument is of type 'void (*)(void *)' 
```

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-06-05T18:01:19.333

从 GCC 手册页`-mrtd`：

```
Warning: this calling convention is incompatible with the one
normally used on Unix, so you cannot use it if you need to call
libraries compiled with the Unix compiler. 
```

该警告有点奇怪，但我相信它只是试图告诉您您正在传递一个指向使用不兼容调用约定的函数的指针。我想`free`in libc 会是这样的功能；我很惊讶打电话`calloc`完全有效。（或者可能不是，您看到的是延迟失败！）

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-06-05T21:16:55.290

[通过使用cdecl 属性](http://gcc.gnu.org/onlinedocs/gcc-3.2/gcc/Function-Attributes.html)正确声明函数指针，您应该能够解决问题，至少对于这个简单的示例。试试这个：

```
#include <stdlib.h>

void test(void* o, void (__attribute__((cdecl))*freeFunc)(void*)) {
    freeFunc(o);
}

int main() {
    int *p = (int *)calloc(1, sizeof(int));
    test(p, free);
} 
```

# apache - 配置对 XAMPP 的外部访问

> ID：10902349
> 
> 赞同：7
> 
> 时间：2012-06-05T17:54:02.477
> 
> 标签：apache, xampp, localhost

我使用 XAMPP 开发 wordpress 主题，我想使用 ManageWP 来管理/克隆站点到生产服务器。我已经按照我能找到的关于此事的所有教程进行操作，但无法从外部访问我的本地主机！

[这个相关的 SE 答案](https://stackoverflow.com/questions/5802124/remote-xampp-access)似乎很简单！

1.  将 Web 服务器配置为侦听您的外部网络接口（Apache 通常配置为默认仅侦听 localhost）。
2.  在计算机上的防火墙中为入站连接打开端口 80。
3.  如果您希望局域网外的人访问您的服务器，请在您的路由器/网关中启用端口转发，以便将端口 80 转发到您的计算机。
4.  如果您在网络中使用 DHCP，请将 DHCP 服务器配置为每次都为您的计算机提供相同的地址（例如，通过 MAC 地址）。

我很确定我最后三个步骤是正确的，（没有防火墙，端口 80 TCP&UDP > 80，由 MAC 地址分配的服务器 IP）但我不知道如何做第一个（我试过玩在 httpd.conf 中通过将 ServerName 设置为我的外部 IP 地址，但这只是一个狂野的随机失败:)

虽然端口转发处于活动状态，但当我在本地网络上时，我可以在以下位置看到网站：##.###.64.188/mysite.dev（我的外部 IP），但如果我通过我的 3g 移动连接进行连接，我会得到：

```
Not Found
The requested URL http://<snip> was not found on this server
Apache Server at ##.###.64.188 Port 3128 
```

这似乎表明我在附近的某个地方！但不知道从这里去哪里......

有什么建议么？TIA，蒂姆

跑步：

*   XAMPP v1.7.3
*   Mac OSX 10.7.4

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-06-08T19:52:29.787

这里的简单答案：我的 ISP Optus 阻止了端口 80 上的传入连接。所以，我添加了：

`listen 8080`

到 httpd.conf 并相应地调整了我的端口，现在我连接好了！

对于后面的人，我还在我的 ~/Sites 和 httpd.conf 中的 /phpmyadmin 条目中设置了 http auth 指令，以提高安全性。

为了使 WP 站点和链接正常工作，我正在动态设置 WP_SITEURL：

```
// wp-config.php
$host = $_SERVER['SERVER_NAME'];
if($host == 'subdomain.mysite.com')
    $url = 'http://subdomain.mysite.com:8080';
else
     $url = 'http://mysite.dev';

define('WP_HOME', $url);
define('WP_SITEURL', $url); 
```

然后，在我正在配置的站点的虚拟主机中，我设置`<VirtualHost *:8080>`了 .. 工作！任务完成。

（编辑：我不再安装 XAMPP，并且忘记了它的目录结构，但虚拟主机的定义类似于 apache2 默认值：extra/httpd-vhosts.conf，它包含在 httpd.conf 的末尾）

PS manageWP 需要被列入白名单以允许通过 http 基本身份验证的连接。

非常感谢 Garth 和 River 在 FB 上接听了我的电话...

# mutt - 将 mutt 配置为在 auto_view 中以与在附件视图中不同的方式处理相同的附件

> ID：10902350
> 
> 赞同：2
> 
> 时间：2012-06-05T17:54:03.150
> 
> 标签：mutt

我想查看`text/html`与 auto_view 内联的附件。这很容易，只需在和中`w3m -dump`调用即可。`.mailcap``auto_view text/html``.muttrc`

棘手的部分是，当我明确查看附件时，我仍然想调用浏览器会话。好像我对我的mailcap 条目没有任何`-dump`论据。`w3m`

我试图通过两个具有不同标志的邮件封盖条目来获得这种效果，但没有任何运气。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-06-05T18:30:34.053

一些摆弄和来自另一个来源的一些帮助让我得到了这个问题的答案。

在 mailcap 文件中，您可以设置两个条目：

```
text/html; w3m -I %{charset} -T text/html; needsterminal;
text/html; w3m -I %{charset} -dump -T text/html; copiousoutput; 
```

这里有两个重要的部分。首先，`copiousoutput`标志表明 entry 是一个有用的候选`auto_view`。其次，它上面还有另一个条目的事实意味着不`auto_view`使用（例如将其视为附件）将首先尝试。

所以附件视图将使用第一个，`auto_view`将使用第二个。这就是我想要的。

来源： http: [//www.mutt.org/doc/manual/manual-5.html#auto_view](http://www.mutt.org/doc/manual/manual-5.html#auto_view)（见搜索顺序部分）

# php - Facebook在登录后循环连接codeigniter重定向

> ID：10902355
> 
> 赞同：1
> 
> 时间：2012-06-05T17:54:18.447
> 
> 标签：php, facebook, codeigniter

我正在尝试使用 codeigniter 连接 facebook。如果我第一次连接，那么我可以看到权限弹出窗口，但是在我授权权限后，我收到多个重定向循环错误。

如果我已经登录并授权站点，那么为什么它没有获得 uid。

我在 facebook 中提供了网站网址：http: [//mysite.com/](http://mysite.com/)

我的重定向 uri 是[http://mysite.com/facebook/](http://mysite.com/facebook/)

我已将这些文件添加到我的库文件夹中。

```
library/fb_connect.php
library/facebook/facebook.php
library/facebook/base_facebook.php
library/facebook/fb_ca_chain_bundel.crt 
```

facebook 文件夹中的最后 3 个文件是 facebook SDK 文件。

这是我的 fb_connect.php 中的代码

```
<?php
include(APPPATH.'libraries/facebook/facebook.php');

 class Fb_connect {

function connect(){

$facebook = new Facebook(array(
    'appId'  => 'XXXXXXX',
    'secret' => 'XXXXXXXXXXXXXX',
    'cookie' => true,
 ));

    //Get User ID
  $user=$facebook->getUser();

  if(!$user){
   $loginUrl=$facebook->getLoginUrl(array(
    'scope'         => 'email,publish_stream,user_birthday,user_location',
    'redirect_uri'  => 'http://localhost/beta/facebook/',
    'display'=> 'popup'
    ));

    redirect($loginUrl')";
    exit();

 } else {
$user_profile = $facebook->api('/me');

 print_r($user_profile);

}
 ?> 
```

这是我的控制器代码：

```
function  facebook(){

  $this->load->library('fb_connect');
  $user_data=$this->fb_connect->connect();

 } 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-06-05T22:30:44.280

有几件事；

1.你说“我的重定向 uri 是[http://mysite.com/facebook/](http://mysite.com/facebook/) ” - 但在你的代码中：

```
'redirect_uri'  => 'http://localhost/beta/facebook/', 
```

应该：

```
'redirect_uri'  => 'http://mysite.com/facebook/', 
```

2.您说“我在 facebook 中提供了网站网址：http: [//mysite.com/](http://mysite.com/) ” - 您还需要在您的 facebook api 中专门设置返回网址 - 应该是“http://mysite.com/facebook”

3.你说你的重定向是“http://mysite.com/facebook/”——你把它设置为路由了吗？因为通常它应该是“http://mysite.com/mycontroller/facebook/”

4.您有错字（如果这是复制+粘贴）：

```
redirect($loginUrl')"; 
```

应该

```
redirect($loginUrl); 
```

# php - php循环时显示两列html表

> ID：10902356
> 
> 赞同：0
> 
> 时间：2012-06-05T17:54:22.087
> 
> 标签：php, mysql, html, loops

我正在创建一个可以以表格形式显示新闻的新闻通讯模板，但我希望新闻以每行两列的形式显示。请检查这个 url 看看我在说什么[http://www.ipaidabribenaija.com/newsletter.php](http://www.ipaidabribenaija.com/newsletter.php) 谢谢。

```
 <?php
    $conn = mysql_connect("localhost", "rppt", "peep") or die(mysql_error());

    mysql_select_db('news', $conn) or die(mysql_error());

    $query = mysql_query ("Select i.nid, LEFT(i.fulltext, 350), UPPER(i.title), 
LOWER(c.name) from nl i JOIN jos_k2_categories c ON c.id=i.catid ORDER BY i.id LIMIT 0, 16") or die ('Error');

    $href = "http://www.ipaidabribenaija.com/index.php";

?>

<table width="500px" align="center">
    <tbody>
        <tr>
            <td width="400px" height="344px" valign="top">
<table cellspacing="5">
        <tbody>

         <?php
            while(list($id, $fulltext, $title, $name)=mysql_fetch_array($query))
            {
                $i = 0;
         ?>
         <?php
            $replacename = eregi_replace(" ",  "-", $name);
         ?>
        <tr>
            <td height="34">&nbsp;</td>
        </tr>
        <?php
            if($i%2 == 0)
            {
        ?>
        <tr>
            <tr>
                <td height="34">
<font color="#FF0000" size="+2"><strong><?php echo $title; ?></strong></font>&nbsp;</td>
            </tr>
            <tr>
                <td height="34"><p><?php echo $fulltext; ?>...</p>

                    <p><a href="<?php echo $href ."/". $replacename ."/item/". $id; ?>">read more...</a></p>
                </td>
            </tr>
            <?php
                }
                else{
            ?>
                <tr>
                    <td height="34"><font color="#FF0000" size="+2"><strong><?php echo $title; ?></strong></font>&nbsp;</td>
                </tr>
                <tr>
                    <td height="34"><p><?php echo $fulltext; ?>...</p>
                        <p><a href="<?php echo $href ."/". $replacename ."/item/". $id; ?>">read more...</a></p></td>
                </tr>
                <?php
                    }
                        }
                ?>
        </tr>
        </tbody>
     </table>
    </td>
    </tr>
    </tbody>
</table> 
```

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-06-05T17:59:39.467

这将使您大部分时间到达那里：

```
echo '<tr>';
$i = 0;
while(...) {
    if($i > 0 and $i % 2 == 0) {
        echo '</tr><tr>';
    }
    echo '<td>My data</td>';
    $i++;
}
echo '</tr>; 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-06-05T18:01:26.850

使用 rowspan 和 colspan html 属性

```
 <tr>
  <td>A</td>
  <td colspan="2">&nbsp;</td>
 </tr> 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-06-05T18:04:34.887

完成查询后，您可以这样写：

```
<table>
<?php
$rows = 1;
$while($news = @mysql_fetch_array($query)){
  if($rows % 2 != 0){
    echo "<tr><td>" . $news['details'] . "</td>";
  }
  else {
   echo "<td>" . $news['details'] . "</td></tr>";
  }
  $row++;
}

if($rows % 2 != 0){echo "<td>&nbsp;</td></tr>"; }
?>
</table> 
```

使用此代码，您可以创建一个表并使用 1 初始化一个变量，仅用于检查行数。

最后，如果您有 3 条新闻，脚本将完成该行和一个空单元格。

# f# - FsUnit 示例错误

> ID：10902363
> 
> 赞同：3
> 
> 时间：2012-06-05T17:55:27.527
> 
> 标签：f#, fsunit

我从 FsUnit[项目页面](http://fsunit.codeplex.com/Wikipage?ProjectName=fsunit)复制了这个示例：

```
open NUnit.Framework
open FsUnit
let [<Test>] trivial () = 1 |> should not (equal 2) 
```

F# 给我以下错误：

> 错误 2 此表达式应为 bool 类型，但此处为 Constraints.EqualConstraint
> 
> 错误 1 ​​'bool' 类型与 'Constraints.Constraint' 类型不兼容

我究竟做错了什么？

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2012-06-05T21:12:23.180

较新版本的 FsUnit 包含将`FsUnit.not`函数重命名为`FsUnit.not'`. 这应该消除与内置`not`函数的冲突。您可以从[NuGet Gallery](http://nuget.org/packages?q=fsunit)获取最新版本。可以在 FsUnit [GitHub 站点](https://github.com/dmohl/FsUnit/blob/master/Examples/NUnit/BowlingGame.fsx)上找到使用示例。

如果您仍然看到问题，请告诉我。我很乐意与您一起进行更深入的故障排除。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-06-05T20:49:05.717

我认为您引用的方式有问题`FsUnit`。我尝试运行您的代码（只需`FsUnit`从 CodePlex 复制源代码），它运行良好。您仍然需要将测试编写为函数（正如 Joel 所指出的那样），因此请编写类似`let [<Test>] trivial () = ...`.

出于某种原因，我认为您的脚本使用的是内置`not`函数（对`bool`值进行操作）而不是对对象`FsUnit.not`进行操作的函数。如果您明确`Constraint`使用该`not`功能，它是否有效？`FsUnit`

```
let cnot = FsUnit.not
let [<Test>] trivial = 1 |> should cnot (equal 1) 
```

# javascript - 异步 javascript 事件的排序

> ID：10902364
> 
> 赞同：2
> 
> 时间：2012-06-05T17:55:55.693
> 
> 标签：javascript, jquery, ajax

我有以下代码：

```
$("#submit_financials").live('click', function(event){
    event.preventDefault();

    // using serialize here to pass the POST variables to the django view function
    var serialized_data = $("#financials_filter_form").serialize()

    $.post("/ajax/custom_filter/", serialized_data, function(response){
        // create a graph
    });
    $.post("/ajax/force_download/", serialized_data, function(response){
        alert('hello');
    });

}); 
```

但是，当我执行此代码时，我会在图表**之前得到响应“你好”。**为什么会这样？我将如何改变这一点，以便我首先得到图表？

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2012-06-05T17:58:07.243

异步，你永远不知道哪个函数运行\先完成...

想想异步操作，比如告诉一群人跑 1 英里，你知道谁会先跑完吗？（是的，Jon skeet，然后是 Chuck Norris……）

您可以使用 a callack 来运行第二个 ajax：

```
$.post("/ajax/custom_filter/", serialized_data, function(response) {
    // create a graph
    ...
    ...

    $.post("/ajax/force_download/", serialized_data, function(response) {
        alert('hello');
    });
});​ 
```

* * *

## 回答 #2

> 赞同：5
> 
> 时间：2012-06-05T18:03:51.750

您可以尝试使用延迟对象**如果您想在警报之前生成图表但希望两个调用都完成**。

```
$.when (
   $.post("/ajax/custom_filter/", serialized_data),
   $.post("/ajax/force_download/", serialized_data)
).done(function(a1,  a2){
    /* a1 and a2 are arguments resolved for the 
    custom_filter and force_download post requests  */
   var customFilterResponse = a1[2]; 
   /* arguments are [ "success", statusText, jqXHR ] */

   //generate graph.

   alert('hello');
}); 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-06-05T18:01:18.983

选项 1 是嵌套发布请求（gdoron 的响应）。如果这不可能/不切实际，您可以使用相互作用域的变量作为标志（更改响应回调函数中的值，然后使用 setTimeout 和递归（或 setInterval）继续寻找“标志”变量的变化以及何时你看到它改变了，然后弹出下一个 $.post 请求

# android - 微调器上有多个列？

> ID：10902366
> 
> 赞同：0
> 
> 时间：2012-06-05T17:56:09.617
> 
> 标签：android, sqlite, spinner

我多年来一直在尝试让自定义微调器工作，但基本上没有任何工作。

我一直在追求这样的事情：

[http://www.f1-manager.co.uk/Misc/CustomSpinner.png](http://www.f1-manager.co.uk/Misc/CustomSpinner.png)

基本上我想显示数据库中的 3 个项目，名字，姓氏和其他信息位上的其他一些信息，当然还有一张该人的照片。

这甚至可能吗？有人告诉我，使用自定义微调器可以实现这一点，但我找不到足够好的例子来帮助我。

任何帮助都会很棒。:-)

谢谢，克里斯

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-06-05T17:59:25.763

使用[TableLayout](http://developer.android.com/reference/android/widget/TableLayout.html)为微调器中的项目设计 UI。然后在您的适配器中，只需像填写任何其他布局一样填写布局内容。

这是我的意思的布局设计：

```
TableLayout
    TableRow
        TextView -> FirstNameHeader
        TextView -> LastNameHeader
    TableRow
        TextView -> FirstNameData
        TextView -> LastNameData
    TableRow
        TextView -> OtherData 
```

# mysql - PDO，MySQL 将获取的数据插入到数组中

> ID：10902367
> 
> 赞同：0
> 
> 时间：2012-06-05T17:56:12.087
> 
> 标签：mysql, arrays, for-loop, pdo, return

这个问题与上一个问题有关：[PDO, MySQL - How do I return an array from a function?](https://stackoverflow.com/questions/10901583/pdo-mysql-how-do-i-return-an-array-from-a-function/10901705#comment14213382_10901705)

但我觉得不够具体。

我想在数组中以自己的键返回每行变量，以便我可以在调用程序中使用它们。

这是我到目前为止的代码，但不确定它是否正确，甚至是否朝着正确的方向发展：

```
$total = $dbh->prepare("SELECT COUNT(post_id) FROM mjbox_posts");
        $stmt = $dbh->prepare("SELECT * FROM mjbox_images JOIN mjbox_posts USING (post_id) WHERE post_id = ?");
        $stmt->bindParam(1,$post_id);
        $stmt->execute();

        $resultarray = array();

            while($row = $stmt->fetch(PDO::FETCH_ASSOC)) {
            for($i=0;$i<=$total;$i++){

                $resultarray[] = array("id"=>$row['img_id'],"filename"=>$row['img_file_name']);

            }

        }

        return $resultarray; 
```

看起来数据确实被插入到数组中并传递回调用程序，但它似乎在数组中复制了每条数据两次：

```
Array ( [0] => Array ( [0] => Array ( [id] => 5 [filename] => fullsize/8520430289728860armor.jpg ) [1] => Array ( [id] => 5 [filename] => fullsize/8520430289728860armor.jpg ) [2] => Array ( [id] => 6 [filename] => fullsize/5535575154865203bg1.jpg ) [3] => Array ( [id] => 6 [filename] => fullsize/5535575154865203bg1.jpg ) [4] => Array ( [id] => 7 [filename] => fullsize/7598226850012898images.jpg ) [5] => Array ( [id] => 7 [filename] => fullsize/7598226850012898images.jpg ) ) ) 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-06-05T18:02:02.760

那个密码坏了。`$total`将是一个 mysql 准备好的语句句柄，但您在内部`for(...)`循环的整数比较中使用它。

当您只需要保存到数组中的两个字段时，您的另一个查询通过获取表中的所有字段来浪费大量资源。

将混乱简化为：

询问：

```
SELECT img_id AS id, img_file_name AS filename etc.... 
```

php:

```
$resultarray = array();
while($row = $stmt->fetch(PDO::FETCH_ASSOC)) {
   $resultarray[] = $row;
} 
```

# c# - MVC4中的Html.Serialize在哪里

> ID：10902371
> 
> 赞同：4
> 
> 时间：2012-06-05T17:56:24.753
> 
> 标签：c#, asp.net-mvc-3, asp.net-mvc-4

我知道 MVC3 期货 dll Microsoft.Web.MVC 有 Html.Serialize。但是如果我正在使用 mvc4 构建应用程序，我还需要安装 mvc3 期货吗？

* * *

## 回答 #1

> 赞同：12
> 
> 时间：2012-12-14T01:44:43.887

MVC4 的期货于 2012 年 11 月 30 日可用

[https://nuget.org/packages/Mvc4Futures/4.0.20710.0](https://nuget.org/packages/Mvc4Futures/4.0.20710.0)

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-06-05T17:59:46.127

安装 NuGet 包`Mvc3Futures`，这将解决问题。我认为目前还没有纯 Mvc4 版本`Futures`。

# ruby-on-rails - 使用 rails 中的辅助方法向 HAML 标签添加动态属性

> ID：10902377
> 
> 赞同：4
> 
> 时间：2012-06-05T17:56:55.043
> 
> 标签：ruby-on-rails, haml

所以我想出了一种方法来做到这一点，但是有没有更简单的方法呢？如果params [：sort] == sortBy，我想要做的只是在％th标签之后添加.class，我真的需要在辅助方法中包含HAML的其余部分吗？

这是我的 helper.rb 文件中的辅助方法：

```
def yellow?(sortBy,name,id)
  haml_tag :th, class: "#{'hilite' if params[:sort]== sortBy}" do
    haml_concat link_to name, movies_path(sort: sortBy),{:id => id}
  end
end 
```

这是来自我的 HAML 文件：

```
%tr
  - yellow?("title","Movie Title","title_header")
  %th Rating 
```

* * *

## 回答 #1

> 赞同：9
> 
> 时间：2012-06-06T05:44:25.023

您是否尝试过此解决方案：

```
%tr
  %th{ :class => if params[:sort] == 'sortBy' then 'hilite' end }
    = link_to "Movie Title", movies_path(:sort => 'title'), :id => "title_header"
  %th Rating 
```

您可以将此语句：`if params[:sort] == 'sortBy' then 'hilite' end`移至助手。看看我的类似答案：[haml two spaces issue](https://stackoverflow.com/questions/10763308/haml-two-spaces-issue)。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2016-05-08T21:06:09.283

你也可以这样做：

## 应用程序/帮助者/some_helper.rb

```
def hilite
  params[:sort] == 'sortBy' ? { class: 'hilite' } : {}
end 
```

## 应用程序/视图/some.html.haml

```
%tr
  %th{ hilite }
    = link_to "Movie Title", movies_path(:sort => 'title'), :id => "title_header"
  %th Rating 
```

我使用这种方法制作了一个 span_field_opts 助手，通过 Bootstrap 类模拟禁用的字段：

```
def span_field_opts
  { class: "form-control cursor-none", disabled: true }
end 
```

参考：[https ://coderwall.com/p/_jiytg/conditional-html-tag-attribute-in-haml](https://coderwall.com/p/_jiytg/conditional-html-tag-attribute-in-haml)

# ruby - 在运行 MRI 的 Windows 上创建本机线程

> ID：10902378
> 
> 赞同：0
> 
> 时间：2012-06-05T17:57:29.130
> 
> 标签：ruby, windows, multithreading

我可以使用[CreateThread](http://msdn.microsoft.com/en-us/library/windows/desktop/ms682453.aspx) API 调用和[win32-api](https://github.com/djberg96/win32-api)、[windows-api](https://github.com/djberg96/windows-api)和[windows-pr](https://github.com/djberg96/windows-pr) gems 在运行 MRI 的 Windows 上创建本机线程吗？如果是这样，有人可以给我一个例子吗？该线程会正常工作吗？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-06-15T19:10:12.303

似乎是不可能的。我最终使用[eventmachine](https://github.com/eventmachine/eventmachine)在同一个线程上处理多个 I/O 事件。

# mysql - 从 phpMyAdmin 中找出 MySQL 数据库 URL

> ID：10902380
> 
> 赞同：11
> 
> 时间：2012-06-05T17:57:33.567
> 
> 标签：mysql, database, remote-server

我有一个在线 MySQL 数据库。我想弄清楚服务器 URL，以便我可以远程连接到它。

有没有办法可以从 phpMyAdmin 检查我的数据库 URL？

* * *

## 回答 #1

> 赞同：-2
> 
> 时间：2012-06-15T16:24:34.107

默认情况下，远程连接处于关闭状态。

根据 Ashes999 的评论：询问您的网络托管公司。

或者，根据[Here](http://www.phpfreaks.com/forums/index.php?topic=136783.0)，尝试：`echo $_SERVER['SERVER_ADDR'];`。

# oracle - oracle 问题的休眠配置：ORA-12516，TNS:listener 找不到匹配的可用处理程序

> ID：10902381
> 
> 赞同：2
> 
> 时间：2012-06-05T17:57:40.807
> 
> 标签：oracle, hibernate

我设置了连接池，更改了 oracle 的作业流程。但仍然收到此错误：ORA-12516, TNS:listener could not find available handler with matching protocol stack 客户端使用的连接描述符是

除了连接池或 oracle 作业进程设置之外，是否还有任何特定配置需要完成以解决此错误

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-11-22T19:27:36.120

上述解决方案只是掩盖了问题。几乎死后，我找到了一个真正有效的解决方案。出于某种原因，使用休眠 OracleDialect（或 Oracle10gDialect）运行的 Oracle 驱动程序需要额外的参数。

我正在使用 Spring 映射我的 jdbc 连接

```
 <bean id="dataSource" class="org.springframework.jdbc.datasource.DriverManagerDataSource">
    <property name="driverClassName" value="oracle.jdbc.driver.OracleDriver" />
    <property name="url" value="jdbc:oracle:thin:@localhost:1521:mydb" />
    <property name="username" value="mydbuser" />
    <property name="password" value="12345" />
   </bean> 
```

然后，我将其更改为使用 JNDI：

```
<bean id="dataSource" class="org.springframework.jndi.JndiObjectFactoryBean">
    <property name="jndiName" value="java:comp/env/jdbc/mydb" />
</bean> 
```

在我的 context.xml (Tomcat) 中使用此信息：

```
<Resource name="jdbc/mydb"
        type="javax.sql.DataSource"
        auth="Container"
        driverClassName="oracle.jdbc.driver.OracleDriver"
        url="jdbc:oracle:thin:@localhost:1521:mydb"
        username="mydbuser"
        password="12345"
        maxActive="20"
        maxIdle="10"
        maxWait="-1"
        validationQuery="select 1 from dual" /> 
```

这解决了我的问题。可能以下配置**之一 maxActive**、**maxIdle**或**maxWait**向 Oracle 提供了关闭会话并将其返回到池中所需的值。我在我的系统中保持这种方式，因为我有一个待定的任务要迁移到 JNDI，但是，如果您不想使用 JNDI，请尝试在**hibernateProperties**中搜索可能有效的类似值。

Obs.: JNDI 可用于 Jetty 添加**org.eclipse.jetty.plus.jndi.Resource*类的标签到*jetty.xml*。*

 ** * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-07-20T12:05:29.187

我遇到过同样的问题。这解决了我的问题，使用 DBA 运行此查询：

```
ALTER SYSTEM SET PROCESSES=150 SCOPE=SPFILE; 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2016-05-19T21:08:14.067

我遇到了同样的问题，并且还使用了 Spring 的 DriverManagerDataSource 作为 mchamati。但是，我没有使用tomcat或其他中间应用服务器来使用他提出的JNDI解决方案。我解决了将 DriverManagerDataSource 替换为 Oracle 的特定扩展，它是“Spring 数据项目”( [http://projects.spring.io/spring-data-jdbc-ext/](http://projects.spring.io/spring-data-jdbc-ext/) ) 的一部分，现在可以使用。

我解决如下：

```
<beans xmlns="http://www.springframework.org/schema/beans"
       xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance"
       xmlns:context="http://www.springframework.org/schema/context"
       xmlns:orcl="http://www.springframework.org/schema/data/orcl"
       xsi:schemaLocation="http://www.springframework.org/schema/beans
       http://www.springframework.org/schema/beans/spring-beans.xsd
       http://www.springframework.org/schema/context
       http://www.springframework.org/schema/context/spring-context-3.1.xsd
       http://www.springframework.org/schema/data/orcl
       http://www.springframework.org/schema/data/orcl/spring-data-orcl-1.0.xsd">

    <orcl:pooling-datasource id="datasource"
                             url="jdbc:oracle:thin:@localhost:1521/xe"
                             username="myusername"
                             password="mysupersecretpassword"
            connection-caching-enabled="true">
        <orcl:connection-properties>
            v$session.program=MyApplicationName
        </orcl:connection-properties>
    </orcl:pooling-datasource>

</beans> 
```

由于 pom.xml 依赖项中 Spring Framework 的不同版本，存在冲突。所以，我不得不在 may pom.xml 中对依赖进行 decalre，如下所示：

```
<dependency>
    <groupId>org.springframework.data</groupId>
    <artifactId>spring-data-oracle</artifactId>
    <version>1.2.1.RELEASE</version>
    <exclusions>
        <exclusion>
            <groupId>org.springframework</groupId>
            <artifactId>spring-context</artifactId>
        </exclusion>
        <exclusion>
            <groupId>org.springframework</groupId>
            <artifactId>spring-beans</artifactId>
        </exclusion>
        <exclusion>
            <groupId>org.springframework</groupId>
            <artifactId>spring-core</artifactId>
        </exclusion>
        <exclusion>
            <groupId>org.springframework</groupId>
            <artifactId>spring-tx</artifactId>
        </exclusion>
        <exclusion>
            <groupId>org.springframework</groupId>
            <artifactId>spring-test</artifactId>
        </exclusion>
    </exclusions>
</dependency> 
```

完整说明的链接：http: [//docs.spring.io/spring-data/jdbc/docs/current/reference/html/orcl.datasource.html](http://docs.spring.io/spring-data/jdbc/docs/current/reference/html/orcl.datasource.html)*

# c# - 在 Windows 8 Metro 中使用 VirtualizingStackPanel 将项目滚动到中心

> ID：10902382
> 
> 赞同：4
> 
> 时间：2012-06-05T17:57:50.407
> 
> 标签：c#, microsoft-metro, winrt-xaml

我正在开发一个 Windows 8 Metro 应用程序，并有一个 GridView，其中显示了数百个不同宽度的项目。我正在使用 VirtualizingStackPanel 来帮助改善内存消耗。我需要将一个项目滚动到 GridView 的中心。使用 GridView.ScrollIntoView 或 VirtualizingStackPanel.SetHorizo​​ntalOffset 会将项目滚动到屏幕边缘，而不是中心。

[这篇文章](https://stackoverflow.com/questions/2946954/make-listview-scrollintoview-scroll-the-item-into-the-center-of-the-listview-c)讨论了一个类似的问题，但在 WPF 方面。问题在于 a) 由于一些对象不存在，因此无法为 Metro 应用程序编译；b) 逻辑滚动的实现似乎依赖于等宽的项目。

这个问题的最佳解决方案是什么？框架中是否有一些可用的东西可以使这变得简单？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-09-05T10:11:00.563

ScrollIntoView 有效，但您需要这样称呼它：

```
await Dispatcher.RunAsync(CoreDispatcherPriority.Low,
                        () => { this.gridView.ScrollIntoView(yourItem); }); 
```

# android - 上传带有用户评论的图片

> ID：10902388
> 
> 赞同：0
> 
> 时间：2012-06-05T17:58:17.453
> 
> 标签：android, facebook

我正在尝试从我的原生 Android 应用程序将本地图像上传到 Facebook。我还希望用户能够添加评论。我已经这样做了：

```
params.putString("caption", "Caption");
params.putString("description", "Description");
params.putString("picture", Utility.HACK_ICON_URL);
params.putString("name", "name");

String filename = <file_path>
byte[] data = null;
Bitmap bi = BitmapFactory.decodeFile(filename);
ByteArrayOutputStream baos = new ByteArrayOutputStream();
bi.compress(Bitmap.CompressFormat.JPEG, 100, baos);
data = baos.toByteArray();

params.putByteArray("photo", data);

Utility.mFacebook.dialog(ScoreAlertBox.this, "feed", params, new UpdateStatusListener()); 
```

我看到包含所有字段的对话框 - 图标、标题、说明。但是我要上传的图片不存在。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-06-05T18:08:57.013

正如它在 android sdk 对话框[文档](http://developers.facebook.com/docs/reference/androidsdk/dialog/)中所述：

> parameters - 要作为 URL 参数传递的字符串键值对

您不能将本地图像传递给它，它基本上只是一种调用[Feed Dialog](http://developers.facebook.com/docs/reference/dialogs/feed/)的方式，它只接受一个 url 作为图片参数。

您应该做的是使用[请求](http://developers.facebook.com/docs/reference/androidsdk/request/)（或[异步请求](http://developers.facebook.com/docs/reference/androidsdk/ayncrequest/http://developers.facebook.com/docs/reference/androidsdk/ayncrequest/)）将图像与帖子一起上传。
此外，如果您想上传图片，您需要使用`me/photos`：[用户对象照片连接](http://developers.facebook.com/docs/reference/api/user/#photos)。

# c# - 使用正则表达式转换字符串

> ID：10902390
> 
> 赞同：1
> 
> 时间：2012-06-05T17:58:31.360
> 
> 标签：c#, regex, string, parsing

我有一些需要使用 C# 修改的 HTML 内容。它在概念上很简单，但我不确定如何有效地做到这一点。内容包含多次出现的分隔数字，后跟一个空的锚标记。我需要获取分隔数字并将其插入到锚标记中的 JavaScript 函数调用中。例如

源字符串将包含如下内容：

```
%%1%%<a href="#"></a> 
<p>A bunch of HTML markup</p>

%%2%%<a href="#"></a>
<p>Some more HTML markup</p> 
```

我需要将其转换为：

```
<a href="#" onclick="DoSomething('1')></a> 
<p>A bunch of HTML markup</p>

<a href="#" onclick="DoSomething('2')></a>
<p>Some more HTML markup</p> 
```

%%\d+%% 出现的次数没有限制。我尝试编写正则表达式，希望可以使用 Replace 方法，但我不确定这是否可以用于每个组的多个实例。这是我所拥有的：

```
%%(?<LinkID>\d+)%%(?<LinkStart><a[\s\S]*?)(?:(?<LinkEnd>>[\s\S]*?)(?=%%\d+|$))

// %%(?<LinkID>\d+)%%        Match a number surrounded by %% and put the number in a group named LinkID
// (?<LinkStart><a[\s\S]*?)  Match <a followed by any characters until next match (non greedy), in a group named LinkStart
// (?:                       Logical grouping that does not get captured
// (?<LinkEnd>>[\s\S]*?)     Match > followed by any characters until next match, in a group named LinkEnd
// (?=%%\d+%%|$)             Where the former LinkEnd group is followed by another instance of a delimited number or the end of the string. (I don't think this is working as I intended.) 
```

也许可以使用一些正则表达式操作和 String.Format 的组合。我不是正则表达式方面的专家。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-06-05T21:23:32.480

我会说您的正则表达式几乎就是您想要的 - 我已经稍微改变了它。`$`如果仅在字符串末尾匹配，这将起作用：

```
%%(\d+)%%(<a[^>]*)(></a>)(.*?)(?=%%\d|$) 
```

如果您决定使用它，那么对于每个匹配项，您都可以访问组，这样您就可以构造新字符串 - 这可能比替换现有字符串中的内容更容易。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-06-05T18:06:08.660

使用正则表达式解析 HTML 已在 SO 上广泛介绍。 [共识是不应该这样做](https://stackoverflow.com/questions/1732348/regex-match-open-tags-except-xhtml-self-contained-tags)。

如果您需要解析 HTML，我建议您使用[HTML Agility Pack](http://htmlagilitypack.codeplex.com/)之类的东西。这允许您使用类似于 xPath 的东西来识别您想要处理的 HTML。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-06-05T19:43:06.850

我会使用 string.split 这个。

```
string emptyAnchor = "<a href=""#""></a>";
string src = GetData();
string[] splits = src.split(new string[]{"%%"}, StringSplitOptions.None);
StringBuilder sb = new StringBuilder();

//first entry is blank, set to 1
int i = 1;
while(i < splits.length)
{
    string id = splits[i];
    //increment for data string
    i++;
    //prehaps use a StringReplaceFirstOccurrence function instead
    sb.Append(splits[i].Replace(emptyAnchor, GetDataFromID(id)));
    i++;
}
string output = sb.ToString(); 
```

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2012-06-05T21:51:05.153

事实证明 Regex.Replace 已经足够聪明，可以处理多个匹配项。我刚刚修改了我的正则表达式以不使用前瞻。我的想法是我在 %% 分隔符中找到数字并将其添加到组中，在下一个锚标记中找到内容并将其添加到组中，然后将整个匹配替换为包含在两组插入其中。replace 方法似乎可以在没有任何额外帮助的情况下自动正确处理后续匹配项。

```
string originalText = "<h3>%%1%%<a href=\"#\">First Spot</a></h3><p>Lorem ipsum dolor sit amet, consectetur adipiscing elit.</p>" +
                            "<h3>%%2%%<a href=\"#\">Second Spot</a></h3><p>Ut vulputate lobortis feugiat.</p>" +
                            "<p>Ut nunc diam, malesuada iaculis viverra nec, auctor eget velit.</p>";

Regex regex = new Regex(@"%%(\d+)%%[\s]*<a[\s\S]*?>([\s\S]*?)</a>");
string result = regex.Replace(originalText, "<a href=\"#\" onclick=\"DoSomething($1)\">$2</a>");
Debug.WriteLine("Original Text: \"" + originalText + "\"");
Debug.WriteLine("Result Text: \"" + result + "\""); 
```

输出：

```
Original Text: "<h3>%%1%%<a href="#">First Spot</a></h3><p>Lorem ipsum dolor sit amet, consectetur adipiscing elit.</p><h3>%%2%%<a href="#">Second Spot</a></h3><p>Ut vulputate lobortis feugiat.</p><p>Ut nunc diam, malesuada iaculis viverra nec, auctor eget velit.</p>"

Result Text: "<h3><a href="#" onclick="DoSomething(1)">First Spot</a></h3><p>Lorem ipsum dolor sit amet, consectetur adipiscing elit.</p><h3><a href="#" onclick="DoSomething(2)">Second Spot</a></h3><p>Ut vulputate lobortis feugiat.</p><p>Ut nunc diam, malesuada iaculis viverra nec, auctor eget velit.</p>" 
```

# jquery - 在 JQuery Defered 对象（带有backboneJS）上，我怎么知道哪个请求失败了？

> ID：10902391
> 
> 赞同：1
> 
> 时间：2012-06-05T17:58:43.170
> 
> 标签：jquery, backbone.js, jquery-deferred

我试过用backboneJS做这个：

```
$.when(cardsCollection.fetch(),series.fetch())
              .done(function(){
                cardsListView.series = series;
                cardsListView.template = _.template(CardsListTemplate);
                cardsListView.render();
            }).fail(function(){
                cardsListView.series = new Series({seriesID:0,seriesName:""});
                cardsListView.template = _.template(CardsListTemplate);
                cardsListView.render();
                }); 
```

我错过了示例中的失败回调参数。但是，我的意图是检查哪个获取失败，以及是否是该系列继续使用假数据。

JQuery 可以延迟吗？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-06-05T18:38:00.790

你可以使用[deferred.state()](http://api.jquery.com/deferred.state/)

```
 cardsCollectionPromise = cardsCollection.fetch();
 seriesPromise = series.fetch();
 $.when(cardsCollectionPromise, seriesPromise)
          .done(function(){
        // ...
        }).fail(function(){
            if (cardsCollectionPromise.state() === 'rejected') {
               // ...
            },
            else (seriesPromise.state() === 'rejected') {
              // ...
            }
            }); 
```

# php - 在 Class 静态变量上创建闭包时 PHP 解析错误

> ID：10902393
> 
> 赞同：1
> 
> 时间：2012-06-05T17:59:08.010
> 
> 标签：php, closures

我正在使用 5.3.10 并尝试以下列方式创建闭包，但它给出了解析错误。谁能告诉我为什么它会给出解析错误？

```
class ABC {
    public static $funcs = array(
        'world' => function() {
            echo "Hello,";
            echo "World!\n";
        },
        'universe' => function() {
            echo "Hello,";
            echo "Universe!\n";
        },
    ); 
} 
```

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-06-05T19:06:07.650

这不起作用的原因是在 PHP 中不允许将闭包直接分配给（静态）类变量初始化程序。

因此，要使您的代码正常工作，您必须使用以下解决方法：

```
<?php

class ABC {
    public static $funcs;
}

ABC::$funcs  = array(
        'world' => function() {
            echo "Hello,";
            echo "World!\n";
        },
        'universe' => function() {
            echo "Hello,";
            echo "Universe!\n";
        },
);

$func = ABC::$funcs['world'];
$func(); 
```

解决方法取自 Stack Overflow 上这个问题的答案：[PHP: How to initialize static variables](https://stackoverflow.com/questions/693691/php-how-to-initialize-static-variables)

顺便说一句，请注意，也不能直接通过`ABC::$funcs['world']()`. 为此，您必须使用 PHP >= 5.4，它引入了函数数组解引用。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-06-05T19:00:14.287

静态属性只能使用文字或常量进行初始化。[来自http://php.net/manual/en/language.oop5.static.php](http://php.net/manual/en/language.oop5.static.php)的 PHP 手册：

> 与任何其他 PHP 静态变量一样，静态属性只能使用文字或常量进行初始化；不允许表达。因此，虽然您可以将静态属性初始化为整数或数组（例如），但您不能将其初始化为另一个变量、函数返回值或对象。

# ruby-on-rails - Backbone.js 视图未插入模板

> ID：10902394
> 
> 赞同：1
> 
> 时间：2012-06-05T17:59:10.550
> 
> 标签：ruby-on-rails, backbone.js, backbone-views, backbone-routing

我正在为我的 Backbone/rails 应用程序创建用户视图。我正在尝试添加一个新视图：

/views/users/edit.js.coffee

```
class MosaikBackbone.Views.UsersEdit extends Backbone.View

  template: JST['users/edit']

  render: ->
    $(@el).html(@template())
    this 
```

模板位于 /templates/users/edit.jst.eco

```
<h1>edit page</h1> 
```

我的路由器在 /routers/users.js.coffee 中如下所示：

```
class MosaikBackbone.Routers.Users extends Backbone.Router
    routes:
        '': 'index'
        'users/:id': 'show'
        'users/edit/:id': 'update'

    initialize: ->
        @collection = new MosaikBackbone.Collections.Users()
        @collection.fetch()

    index: ->
        view = new MosaikBackbone.Views.UsersIndex(collection: @collection)
        $('#container').html(view.render().el)

    show: (id) ->
        alert "Entry #{id}"

    update: (id) ->
        editView = new MosaikBackbone.Views.UsersEdit()
        $('#container').html(editView.render().el) 
```

索引视图/模板工作正常，视图被插入到容器 div 中。如果我将 UsersEdit 视图的 tagName 更改为“li”，我可以在 DOM 中看到 li 元素，它只是没有被模板填充。我猜这是语法问题，但控制台中没有错误。

更新：为了澄清，视图被附加，`#container`因为我可以看到空元素项，只是渲染模板存在问题。

我`template: JST['users/index']`在我的 UsersIndex 视图中引用，一切正常。出于某种原因`template: JST['users/edit']`，即使两个模板都在同一个文件夹中，它也无法正常工作。此外，我可以在编辑模板中放置无效语法并且不会引发任何错误，因此它甚至没有被检测到我不认为

更新 2：以下视图/模板可以正常工作：

```
class MosaikBackbone.Views.UsersIndex extends Backbone.View

  template: JST['users/index']

  initialize: ->
    @collection.on('reset', @render, this)
    @collection.on('add', @appendUser, this)

  render: ->
    $(@el).html(@template())
    @collection.each(@appendUser)
    this

  appendUser: (user) ->
    view = new MosaikBackbone.Views.User(model: user)
    $('#users').append(view.render().el) 
```

模板/用户/index.jst.eco

```
h1>title here</h1>
<ul id="users"></ul> 
```

# c++ - 选择并行化方案需要考虑什么？

> ID：10902401
> 
> 赞同：4
> 
> 时间：2012-06-05T17:59:28.170
> 
> 标签：c++, parallel-processing, mpi, openmp, tbb

我正在使用 c++ 开发一些代码，用于我在计算动力学方面的研究。我的代码解决了稀疏矩阵和密集矩阵，生成网格，并在最简单的意义上执行类似的操作。我需要并行化我的代码以减少计算时间并为此使用 OpenMP。

但是在仔细查看了商业可用的代码后，例如 ANSYS CFX，我发现该软件中使用的并行化方案是 MPICH2，它是 MPI 的一种实现。

所以你有很多并行化工具/API：

*   开放式MP
*   MPI
*   英特尔线程构建模块
*   线程
*   微软 PPL

我使用了其中一些工具，并设法在我的本地计算机上使用每个工具获得 100% 的 CPU 使用率。

我不知道在选择合适的并行化工具时应该注意哪些标准。什么样的应用需要什么样的工具？以上任何一项都可以用于研究目的吗？其中哪些主要用于商业软件？

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2012-06-05T18:13:39.173

对于许多此类问题，并没有真正确定的答案。你不能说什么更好，因为答案总是“视情况而定”。关于你在做什么，关于你的代码是如何编写的，你的可移植性要求是什么等等。

按照您的清单：

*   [OpenMP](http://openmp.org/wp/about-openmp/)：非常标准，我发现它**非常**易于使用。即使原始代码没有考虑到并行化，这个库也使一步一步的方法非常容易。我认为这是并行计算的一个很好的*切入点*，因为它*可以*让一切变得简单，但很难调试，性能有限，而且它只是使代码并行（它缺乏并行算法、结构、原语，你不能跨越工作一个网络）。
*   [消息传递接口](http://www.dmoz.org/Computers/Parallel_Computing/Programming/Libraries/MPI/)：在我看来，基于此标准的库最适合跨集群进行大型计算。如果您的计算机数量很少，并且想要并行计算，那么这是一个不错的选择，众所周知且稳定。这不是（在我看来）*本地*并行化的解决方案。如果您正在寻找用于网格计算的知名、大型使用标准，那么 MPI 适合您。
*   [英特尔线程构建模块](http://threadingbuildingblocks.org/)：这是一个 C++ 库，用于统一跨不同环境（pthread 或 Windows 的线程模型）的多线程接口。如果您使用这样的库，则可能需要跨编译器和环境进行移植。此外，使用这个库不会限制你，因此它可以很好地与其他东西（例如 MPI）集成。你应该看看这个库，看看你是否*喜欢它*，这是一个很好的选择，设计很好，有据可查并被广泛使用。
*   [Microsoft Parallel Patterns Library](http://msdn.microsoft.com/en-us/library/dd492418.aspx)：这是一个非常大的库。它很新，所以我不觉得建议有人在没有经过良好测试的情况下使用它是不安全的，而且它是 Microsoft 特定的，所以你与它的编译器有关。这就是说我认为这是一个很棒的图书馆。它抽象了很多细节，设计精良，并提供了“并行任务”概念的非常高级的视图。再次使用这个库并不会阻止您使用，例如，用于集群的 MPI（但[并发运行时](http://msdn.microsoft.com/en-us/library/ee207192.aspx)有它自己的库）。

用什么？我没有答案，只是尝试选择你觉得更舒服的东西（也看看[Boost Threads](http://www.boost.org/doc/libs/1_49_0/doc/html/thread.html)）。请注意，您可以以某种方式混合它们，例如 OpenMP+MPI、MPI+TBB 甚至 MPI+PLL）。我的偏好是 PPL，但如果您正在开发一个真实世界的应用程序，您可能需要长时间的测试来决定哪个更好。实际上我喜欢并发运行时（PPL 的基础），因为它是“水平的”，它为并行计算和许多“垂直”包（[代理](http://msdn.microsoft.com/en-us/library/dd492627.aspx)、PPL、[TPL](http://msdn.microsoft.com/en-us/library/dd984036.aspx) ）提供了一个基本框架（带有结构和算法）。

也就是说，当您进行并行计算时，您可能需要提高一些 CPU 密集型例程的性能。您可以*考虑*使用 GPU 来完成这项任务，我认为它会为[短时间](https://stackoverflow.com/questions/497685/how-do-you-get-around-the-maximum-cuda-run-time)的大规模并行计算提供最好的效果（当然，即使 CUDA 性能[可能更高，我也更喜欢](http://ieeexplore.ieee.org/xpl/freeabs_all.jsp?arnumber=6047190&tag=1)[OpenCL](http://www.khronos.org/opencl/)而不是专有的[CUDA](http://www.nvidia.com/object/cuda_home_new.html)）。实际上，如果您对此主题感兴趣，您甚至可以查看[OpenHMPP 。](http://www.openhmpp.org/)

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2012-06-05T21:25:19.290

认为这是对 Adriano 答案的扩展评论（和扩展）。

OpenMP 非常易于掌握和使用，它具有可以从同一个源代码生成串行和并行可执行文件的优点。如果您需要将现有的串行代码转换为并行代码，它还允许您采用渐进并行化路径。不过，OpenMP 有一系列缺点。首先，它只针对严重限制了其可扩展性的共享内存机器，尽管现在可以使用大型 x86 SMP 机器（例如，我们有 QPI 耦合 Xeon 系统，在我们的集群安装中共享高达 2 TiB 的共享 RAM 的 128 个 CPU 内核，专门针对大型 OpenMP 作业）。其次，它的编程模型过于简单，无法实现一些高级概念。但我会说这是该模型的优点而不是缺点，因为它使 OpenMP 保持简洁。

MPI 是*事实上的*现在的标准消息传递 API。它得到广泛支持并在多种并行架构上运行。它的分布式内存模型对底层硬件几乎没有限制（除了具有低延迟和高带宽的网络互连），这允许它扩展到数十万个 CPU 内核。MPI 程序在源代码级别上也非常可移植，尽管算法本身可能不具备可移植的可扩展性（例如，一个 MPI 程序可能在 Blue Gene/P 上运行得非常高效，而在 InfiniBand 集群上运行速度非常慢）。MPI 有一个严重的缺点——它的 SPMD（单程序多数据）模型需要代表程序员进行大量的精神分裂思考，并且比 OpenMP 更难掌握。将串行算法移植到 MPI 从来没有像使用 OpenMP 那样容易，有时需要完全重写才能实现高并行效率。采用渐进式并行化方法并轻松维护可以生成串行和并行可执行文件的代码库也是不可能的。MPI 有一个有趣的特性——因为它完全分离了在不同节点上运行的程序的不同部分，并为网络提供了一个抽象接口，它允许异构计算。几种 MPI 实现（例如 Open MPI）提供了异构支持，它不仅允许混合运行在不同操作系统下的节点，还允许混合具有不同“位”和字节序的 CPU。采用渐进式并行化方法并轻松维护可以生成串行和并行可执行文件的代码库也是不可能的。MPI 有一个有趣的特性——因为它完全分离了在不同节点上运行的程序的不同部分，并为网络提供了一个抽象接口，它允许异构计算。几种 MPI 实现（例如 Open MPI）提供了异构支持，它不仅允许混合运行在不同操作系统下的节点，还允许混合具有不同“位”和字节序的 CPU。采用渐进式并行化方法并轻松维护可以生成串行和并行可执行文件的代码库也是不可能的。MPI 有一个有趣的特性——因为它完全分离了在不同节点上运行的程序的不同部分，并为网络提供了一个抽象接口，它允许异构计算。几种 MPI 实现（例如 Open MPI）提供了异构支持，它不仅允许混合运行在不同操作系统下的节点，还允许混合具有不同“位”和字节序的 CPU。MPI 有一个有趣的特性——因为它完全分离了在不同节点上运行的程序的不同部分，并为网络提供了一个抽象接口，它允许异构计算。几种 MPI 实现（例如 Open MPI）提供了异构支持，它不仅允许混合运行在不同操作系统下的节点，还允许混合具有不同“位”和字节序的 CPU。MPI 有一个有趣的特性——因为它完全分离了在不同节点上运行的程序的不同部分，并为网络提供了一个抽象接口，它允许异构计算。几种 MPI 实现（例如 Open MPI）提供了异构支持，它不仅允许混合运行在不同操作系统下的节点，还允许混合具有不同“位”和字节序的 CPU。

英特尔 TBB 就像打了兴奋剂的 OpenMP。它提供了更丰富的基于内核的编程模型，使其更接近于其他并行编程范式，如 CUDA 或 OpenCL。它在适用性和可扩展性方面大量借鉴了 C++ STL 算法。它也应该是编译器中立的，原则上应该与英特尔 C++ 编译器、GNU g++ 和 MSVC 一起使用。ITBB 还使用任务“窃取”意识形态，如果不采取预防措施，可能会消除先前范式容易出现的计算失衡。

Pthreads 是最现代的类 Unix（例如 FreeBSD、Mac OS X、Linux 等）的可移植线程接口。它只是一个线程库，面向人们可以想象的最常见的用例。它几乎不提供并行结构，并且必须在其之上显式地对它们进行编程，例如，即使是简单的循环迭代分布（如 OpenMP）也必须手动编码。Pthreads 之于 Unix 就像 Win32 线程之于 Windows。

（我会跳过 Microsoft TPP，因为我真的不知道那个库）

随着单个节点逐渐获得越来越多的核心，混合这些概念显然是未来的方式。大多数算法都可以实现多级并行，可以使用 MPI 执行粗粒度并行（在多个集群节点上运行），而 OpenMP 或 ITBB 可用于执行单个节点计算的细粒度划分。共享内存编程通常可以更好地利用内存资源，因为它们都在线程之间共享，并且缓存重用之类的东西可以大大加快计算速度。MPI 也可用于对多核 SMP 或 NUMA 机器进行编程，但每个 MPI 进程都是一个单独的 OS 进程，具有自己的虚拟地址空间，这意味着可能需要复制大量（配置）数据。

我建议选择最接近你的编程背景的那个。如果您是一个狂热的 C++ 程序员并且喜欢抽象，那么选择 Intel TBB（如果您喜欢 .Net，则选择 Microsoft PPL）。OpenMP 真的很容易掌握并提供了良好的性能，但不知何故过于简单。它仍然是在 Fortran 中编写多线程代码的唯一广泛可用和使用的机制。MPI 有一个陡峭的学习曲线，但如果您的程序超出了单个计算节点所能提供的能力，那么以后总是可以使用螺栓。

# objective-c - timeIntervalSinceReferenceDate 或 timeIntervalSince1970

> ID：10902402
> 
> 赞同：6
> 
> 时间：2012-06-05T17:59:33.013
> 
> 标签：objective-c, ios

使用 timeIntervalSinceReferenceDate 与 timeIntervalSince1970 相比是否有优势（除了 ARM 处理器是 32 位的事实）？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-06-11T14:34:07.563

我说只要在使用 timeIntervalSinceReferenceDate 时在服务器端进行转换就可以了。timeIntervalSince1970 也是一个选项，因为 ARM 可能会在 2038 年之前升级到 64 位。

# php - 使用 postres 获取 id 和 name，以 key 作为 id 和 value 作为 name 创建 php 数组

> ID：10902403
> 
> 赞同：0
> 
> 时间：2012-06-05T17:59:39.240
> 
> 标签：php, database, arrays, postgresql

我正在查询我的 postgres 数据库并获得如下名称和 ID：

```
$datesQuery = "SELECT date_ridden, id from dates WHERE user_id=$userId"; //query
$theDates = pg_query($db, $datesQuery); //execute query
$dates=array(); //want to use this array to have the key as id and value as date_ridden 
```

我想让我的 $dates 数组以 id 作为键，以 date_ridden 作为值。

目前我正在做以下事情（这不是我想做的）：

```
while( $date = pg_fetch_row($theDates) ){
        $dates[]['value'] = $date[1]; //date id is value
        $dates[]['label'] = $date[0]; //date (in text form) is the label
} 
```

我觉得这应该是一件非常简单的事情，但由于某种原因无法弄清楚。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-06-05T18:05:04.013

我相信您正在寻找的循环结构是：

```
while( $date = pg_fetch_row($theDates) ){
    $dates[$date[1]] = $date[0];
} 
```

如果我误解了，那么您当前尝试的问题是它将 id 和 label 作为单独的数组索引附加到`$dates`.

而是试试这个：

```
while( $date = pg_fetch_row($theDates) ){
    $dates[] = array('value' => $date[1],
                     'label' => $date[0]);
} 
```

在此示例中，您将访问类似的条目`Value = $dates[0]['value'], Label = $dates[0]['label']`

希望其中之一有所帮助。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-06-05T18:05:31.817

如果我明白你的要求，那么它会是这样的

```
while( $date = pg_fetch_row( $theDates ) ) {
    $dates[][$date[1]] = $date[0];
} 
```

或者如果您想访问 $dates['some id'] 那么

```
while( $date = pg_fetch_row( $theDates ) ) {
    $dates[$date[1]] = $date[0];
} 
```

# performance - 如何在 Haskell 中进行快速数据反序列化

> ID：10902405
> 
> 赞同：21
> 
> 时间：2012-06-05T17:59:41.517
> 
> 标签：performance, haskell, serialization

基准测试表明，`cereal`库反序列化我的数据结构（下文详述）所需的时间比从驱动器读取相同数据所需的时间长 100 倍：

```
benchmarking Read
mean: 465.7050 us, lb 460.9873 us, ub 471.0938 us, ci 0.950
std dev: 25.79706 us, lb 22.19820 us, ub 30.81870 us, ci 0.950
found 4 outliers among 100 samples (4.0%)
  4 (4.0%) high mild
variance introduced by outliers: 53.460%
variance is severely inflated by outliers

benchmarking Read + Decode
collecting 100 samples, 1 iterations each, in estimated 6.356502 s
mean: 68.85135 ms, lb 67.65992 ms, ub 70.05832 ms, ci 0.950
std dev: 6.134430 ms, lb 5.607914 ms, ub 6.755639 ms, ci 0.950
variance introduced by outliers: 74.863%
variance is severely inflated by outliers 
```

在我的一个程序中分析该数据结构的典型反序列化使用情况也支持这一点，其中 98% 的时间用于反序列化数据，1% 是`IO`核心算法：

```
COST CENTRE                    MODULE               %time %alloc

getWord8                       Data.Serialize.Get    30.5   40.4
unGet                          Data.Serialize.Get    29.5   17.9
getWord64be                    Data.Serialize.Get    14.0   10.7
getListOf                      Data.Serialize.Get    10.2   12.8
roll                           Data.Serialize         8.2   11.5
shiftl_w64                     Data.Serialize.Get     3.4    2.9
decode                         Data.Serialize         2.9    3.1
main                           Main                   1.3    0.6 
```

我要反序列化的数据结构是一个`IntMap [Triplet Atom]`，组件类型的定义如下：

```
type Triplet a = (a, a, a)

data Point = Point {
    _x :: {-# UNPACK #-} !Double ,
    _y :: {-# UNPACK #-} !Double ,
    _z :: {-# UNPACK #-} !Double }

data Atom = Atom {
    _serial :: {-# UNPACK #-} !Int    ,
    _r      :: {-# UNPACK #-} !Point  ,
    _n      :: {-# UNPACK #-} !Word64 } 
```

我正在使用 default和提供的实例`IntMap`，以及我的自定义类型的以下类型和实例：`(,,)``[]``cereal`

```
instance Serialize Point where
    put (Point x y z) = do
        put x
        put y
        put z
    get = Point <$> get <*> get <*> get

instance Serialize Atom where
    put (Atom s r n) = do
        put s
        put r
        put n
    get = Atom <$> get <*> get <*> get 
```

所以我的问题是：

1.  为什么反序列化一般这么慢？
2.  有什么方法可以改变我的数据结构（即`IntMap`/ `[]`）以使反序列化更快？
3.  有什么方法可以更改我的数据类型（即`Atom`/ `Point`）以使反序列化更快？
4.  是否有比`cereal`Haskell 更快的替代方案，或者我应该将数据结构存储在 C-land 中以进行更快速的反序列化（即使用`mmap`）？

我正在反序列化的这些文件被用于搜索引擎的子索引，因为完整索引无法放入目标计算机（这是消费级桌面）的内存中，因此我将每个子索引存储在磁盘上并读取 +解码驻留在内存中的初始全局索引指向的子索引。另外，我不关心序列化速度，因为搜索索引是最终用户的瓶颈，而当前的序列化性能`cereal`对于生成和更新索引来说是令人满意的。

编辑：

尝试了 Don 使用节省空间的三元组的建议，这使速度提高了四倍：

```
benchmarking Read
mean: 468.9671 us, lb 464.2564 us, ub 473.8867 us, ci 0.950
std dev: 24.67863 us, lb 21.71392 us, ub 28.39479 us, ci 0.950
found 2 outliers among 100 samples (2.0%)
  2 (2.0%) high mild
variance introduced by outliers: 50.474%
variance is severely inflated by outliers

benchmarking Read + Decode
mean: 15.04670 ms, lb 14.99097 ms, ub 15.10520 ms, ci 0.950
std dev: 292.7815 us, lb 278.8742 us, ub 308.1960 us, ci 0.950
variance introduced by outliers: 12.303%
variance is moderately inflated by outliers 
```

但是，它仍然是使用 25 倍于 IO 的时间的瓶颈。另外，任何人都可以解释为什么唐的建议有效吗？这是否意味着如果我切换到列表以外的其他东西（比如数组？），它也可能会有所改进？

编辑#2：刚刚切换到最新的 Haskell 平台并重新运行谷物分析。信息要详细得多，我已经提供了它的[hpaste](http://hpaste.org/69575)。

* * *

## 回答 #1

> 赞同：9
> 
> 时间：2012-06-07T12:00:02.893

好的。用建议的摘要来回答这个问题。对于数据的快速反序列化：

*   使用`cereal`（严格字节串输出）或`binary`（惰性字节串输出）
*   确保您使用 -O2 进行编译，因为这些库依赖于内联来消除开销
*   使用密集数据类型，例如用未打包的专用形式替换多态元组。
*   避免将数据类型转换为列表以对其进行序列化。如果你有字节串，这会被处理。对于未打包的数组类型，您通常会获得非常快的 IO，但值得仔细检查实例
*   您也许可以使用 mmap'd IO
*   对于双重数据，请考虑更高效的双读。
*   使用针对性能进行了优化的现代阵列和容器类型，以及更新的 GHC 版本。

# python - 递归解压缩档案，将（文件名，提取的内容）存储在字典中

> ID：10902409
> 
> 赞同：5
> 
> 时间：2012-06-05T17:59:50.067
> 
> 标签：python, serialization, dictionary, zip, zipfile

你能帮我写一个函数返回吗：

```
dict("file1.txt": list(<contents of file1>),
     "file2.txt": list(<contents of file2>),
     "file3.txt": list(<contents of file3>),
     "file4.txt": list(<contents of file4>)) 
```

输入时：

```
 file.zip:
        outer\
        outer\inner1.zip:
                file1.txt
                file2.txt
        outer\inner2.zip:
                file3.txt
                file4.txt 
```

我的尝试（以下例外）：

*   [http://ideone.com/s1tyb](http://ideone.com/s1tyb)

    *WindowsError：[错误 32] 进程无法访问该文件，因为它正被另一个进程使用*

*   [http://ideone.com/Y2oTw](http://ideone.com/Y2oTw)

    *“文件不是 zip 文件”*

*   [http://ideone.com/0HoGa](http://ideone.com/0HoGa)

    *“文件不是 zip 文件”*

*   [http://ideone.com/owmdK](http://ideone.com/owmdK)

    *AttributeError：ZipFile 实例没有属性“seek”*

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-06-06T08:00:06.363

终于解决了……在以下方面的帮助下：[将 zipfile 提取到内存？](https://stackoverflow.com/q/10908877);

```
from zipfile import ZipFile, is_zipfile

def extract_zip(input_zip):
    input_zip=ZipFile(input_zip)
    return {name: input_zip.read(name) for name in input_zip.namelist()}

def extract_all(input_zip): 
    return {entry: extract_zip(entry) for entry in ZipFile(input_zip).namelist() if is_zipfile(entry)} 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-06-06T08:46:05.637

修改了您的代码（您应该在删除它之前关闭 ZipFile + 添加内部 zip 文件的提取）：

```
import os
import shutil
import tempfile
from zipfile import ZipFile

def unzip_recursively(parent_archive):
    parent_archive = ZipFile(parent_archive)
    result = {}
    tmpdir = tempfile.mkdtemp()
    try:
        parent_archive.extractall(path=tmpdir)
        namelist=parent_archive.namelist()
        for name in namelist[1:]:
            innerzippath = os.path.join(tmpdir, name)
            inner_zip = ZipFile(innerzippath)
            inner_extract_path = innerzippath+'.content'
            if not os.path.exists(inner_extract_path):
                os.makedirs(inner_extract_path)
            inner_zip.extractall(path=inner_extract_path)

            for inner_file_name in inner_zip.namelist():
                result[inner_file_name] = open(os.path.join(inner_extract_path, inner_file_name)).read()
            inner_zip.close()
    finally:
        shutil.rmtree(tmpdir)
    return result

if __name__ == '__main__':
    print unzip_recursively('file.zip') 
```

# sql - 收集 oracle 使用统计信息（查看了哪些表）

> ID：10902410
> 
> 赞同：1
> 
> 时间：2012-06-05T17:59:53.147
> 
> 标签：sql, oracle

我正在尝试收集大型 Oracle 数据库的使用统计信息。我知道查看 DBA_TAB_MODIFICATIONS 视图以查看 INSERT、UPDATE 和 DELETE 统计信息。但是只选择语句呢？我试图找到从未使用过的表。

SYS.DBA_HIST_SQLTEXT 有一个 SQL_TEXT 字段，用于存储在特定时间段内运行的单个查询，其中 SQL_ID 是 PK。我曾考虑过解析它以挑选表名，但这似乎太乏味了。我正在寻找另一种选择。

有任何想法吗？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-06-05T18:07:44.563

假设您使用的是相当新的 Oracle 版本（我相信 9.2 或更高版本），您可以查看[V$SEGMENT_STATISTICS](http://docs.oracle.com/cd/B10501_01/server.920/a96533/sqlviews.htm#32667)。这会逐段向您显示许多不同的性能计数器。如果您只看`statistic_name='logical reads'`，这将使您对阅读很少的表格有一个很好的了解。当然，即使应用程序从不使用表，也完全有可能会记录一些读取记录，例如备份或递归 SQL（即验证外键）。完全有可能一个表的段很少被读取，但该表上的索引却被频繁读取（即，该索引足以满足应用程序对表数据所需的大多数访问类型）。

# php - 多个用户购买同一商品

> ID：10902414
> 
> 赞同：0
> 
> 时间：2012-06-05T18:00:13.880
> 
> 标签：php, paypal

我正在开发一个 php paypal 应用程序。我有许多用户可以使用贝宝申请和支付的任务。用户需要为此支付特定的费用。**当用户成功申请特定任务时，其他人不应该看到该任务。**

我为此有一个任务表，并且有另一个具有任务-用户关系的表（谁为哪个任务付费）。

我想了解多个用户一次购买的情况。如您所知，当用户完全付款时，应将任务交给用户。（从网站结帐页面到 Paypal 结帐页面）。我该如何管理？

也在这里使用ipn。我是否需要发送带有返回 url 的参数？只需要上层答案而不是代码级别。

谢谢

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-06-05T18:03:39.300

你可以做一个类似于ticketmaster的预订类型系统。因此，当用户参与购买特定任务时，您可以为他们保留该任务 15 分钟或多长时间。确保他们有足够的时间来完成结帐过程。因此，您可以在当前用户签出时将该任务设置为在您的表中不可用，如果 15 分钟后他仍未完成交易，您可以取消它并再次使该任务可用。

# c# - 如何显示从 Tessnet (Tesseract) 获得的 tif 坐标图像

> ID：10902415
> 
> 赞同：3
> 
> 时间：2012-06-05T18:00:26.300
> 
> 标签：c#, ocr, tiff, tesseract

我正在使用 Tessnet 作为 C# 包装器的 tesseract 引擎上运行 OCR。我已经获得了识别单词的图像坐标，我想使用这些坐标仅显示页面的那一部分。我不在乎此页面部分是否保存为单独的图像，或者它只是以某种方式突出显示 tif 图像的部分。

这是我当前的代码：

```
TextWriter tw = new StreamWriter(@"U:\user files\bwalker\ocrTesting.txt");
            Bitmap image = new Bitmap(@"u:\user files\bwalker\2849257.tif");
            tessnet2.Tesseract ocr = new tessnet2.Tesseract();
            ocr.SetVariable("tessedit_char_whitelist", "0123456789ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz.,$-/#&=()\"':?"); // If digit only
            ocr.Init(@"C:\Users\bwalker\Documents\Visual Studio 2010\Projects\tessnetWinForms\tessnetWinForms\bin\Release\", "eng", false); // To use correct tessdata
            List<tessnet2.Word> result = ocr.DoOCR(image, System.Drawing.Rectangle.Empty);
            string Results = "";
            foreach (tessnet2.Word word in result)
            {
                Results += word.Confidence + ", " + word.Text + ", " +word.Top+", "+word.Bottom+", "+word.Left+", "+word.Right+"\n";
            } 
            using (StreamWriter writer = new StreamWriter(@"U:\user files\bwalker\ocrTesting2.txt", true))
            {
                writer.WriteLine(Results);
                writer.Close();
            }
            MessageBox.Show("Completed"); 
```

这是生成的 .txt 文件的一部分：

```
14, Due, 105, 136, 1886, 1962
89, Date, 105, 136, 1978, 2064
50, 06/16/2009, 105, 136, 2298, 2504 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-06-08T21:09:46.003

我已经解决了这个问题。获得单词的坐标后，我这样做是为了显示相关的图像：

```
System.Drawing.Rectangle dueDateRectangle = new System.Drawing.Rectangle(dueDateRect1, dueDateRect2, dueDateRect4 - dueDateRect1, dueDateRect3 - dueDateRect2);
System.Drawing.Imaging.PixelFormat format = image.PixelFormat;
Bitmap cloneBitmap = image.Clone(dueDateRectangle, format);
MemoryStream ms = new MemoryStream();
cloneBitmap.Save(ms, ImageFormat.Png);
ms.Position = 0;
BitmapImage dueDateImage = new BitmapImage();
dueDateImage.BeginInit();
dueDateImage.StreamSource = ms;
dueDateImage.EndInit();
dueDateImageBox.Source = dueDateImage; 
```

# sql-server - 根据每行中的列值复制行

> ID：10902419
> 
> 赞同：10
> 
> 时间：2012-06-05T18:00:36.523
> 
> 标签：sql-server

我的这张表包含以下数据

```
Job    Quantity Status Repeat
1      100      OK     2
2      400      HOLD   0
3      200      HOLD   1
4      450      OK     3 
```

根据每行的重复列中的值，应再次重复该行。例如，对于作业 1，重复值为 2，因此作业 1 应再重复两次。

结果表应如下所示

```
Job    Quantity Status Repeat
1      100      OK     2
1      100      OK     2
1      100      OK     2
2      400      HOLD   0
3      200      HOLD   1
3      200      HOLD   1
4      450      OK     3
4      450      OK     3
4      450      OK     3
4      450      OK     3 
```

有人可以帮我解决这个问题吗？

我正在使用 sql 服务器

* * *

## 回答 #1

> 赞同：13
> 
> 时间：2012-06-05T18:28:37.433

这将支持任何单个作业（在我的系统上）的 7,400 多次重复。如果您需要更多，您可以使用不同的系统表或交叉连接。

```
DECLARE @d TABLE (Job INT, Quantity INT, Status VARCHAR(12), Repeat INT);

INSERT @d SELECT 1, 100, 'OK'  ,2
UNION ALL SELECT 2, 400, 'HOLD',0
UNION ALL SELECT 3, 200, 'HOLD',1
UNION ALL SELECT 4, 450, 'OK'  ,3;

WITH x AS 
(
  SELECT TOP (SELECT MAX(Repeat)+1 FROM @d) rn = ROW_NUMBER() 
  OVER (ORDER BY [object_id]) 
  FROM sys.all_columns 
  ORDER BY [object_id]
)
SELECT * FROM x
CROSS JOIN @d AS d
WHERE x.rn <= d.Repeat + 1
ORDER BY Job; 
```

* * *

## 回答 #2

> 赞同：5
> 
> 时间：2012-06-05T18:06:56.973

```
DECLARE @repeats TABLE
        (
        rn INT NOT NULL PRIMARY KEY
        );

WITH    q (rn, m) AS
        (
        SELECT  1, MAX(repeat) + 1
        FROM    jobs
        UNION ALL
        SELECT  rn + 1, m
        FROM    q
        WHERE   rn < m
        )
INSERT
INTO    @repeats
SELECT  rn
FROM    q

SELECT  j.*
FROM    jobs j
CROSS APPLY
        (
        SELECT  TOP (j.repeat + 1)
                NULL
        FROM    @repeats
        ) q (repeat) 
```

如果你有一个表，它的记录肯定多于 的最大可能值`repeat`，你可以摆脱`@repeats`并改用那个表。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2017-07-13T18:12:54.287

我更喜欢下面的方法，因为它不依赖于外部数据来使查询成功并且相当直接。我使用 Aaron Bertrand 的代码来初始化数据表，但我的方法是如何重复数据 - 这种方法不需要特定表包含比所需递归更多的行/不依赖于外部数据。

```
DECLARE @d TABLE (Job INT, Quantity INT, Status VARCHAR(12), Repeat INT);

INSERT @d SELECT 1, 100, 'OK'  , 2
UNION ALL SELECT 2, 400, 'HOLD', 0
UNION ALL SELECT 3, 200, 'HOLD', 1
UNION ALL SELECT 4, 450, 'OK'  , 3;

DECLARE @maxRecursion INT;
SET @maxRecursion = (SELECT MAX(Repeat) 
                       FROM @d);    

WITH Iterator AS 
(
    SELECT 1 AS Iterations
    UNION ALL
    SELECT Iterations + 1 FROM Iterator WHERE Iterations < @maxRecursion
)

SELECT A.*
  FROM @d AS A
 RIGHT JOIN Iterator ON Iterator.Iterations <= (A.Repeat + 1)
 ORDER BY Job ASC
OPTION (MAXRECURSION 0) 
```

干杯!

* * *

## 回答 #4

> 赞同：-1
> 
> 时间：2012-06-05T18:05:14.680

您可以编写将执行此查询的存储过程（作为游标），然后您可以根据需要填充新的临时表

```
CREATE FUNCTION [dbo].[GetRepeatJobs]()
RETURNS 
@JobsRepeatTable TABLE (JobId int, JobName nchar(10))
AS
BEGIN
DECLARE @i int
DECLARE @j int
DECLARE @JobId int
DECLARE @JobName nchar(10)

DECLARE JobsCursor CURSOR FOR (select JobId, JobName, JobRepeat from jobs)
OPEN JobsCursor
FETCH NEXT FROM JobsCursor INTO @JobId, @JobName, @i

WHILE @@FETCH_STATUS = 0
BEGIN
    SELECT @j = 0
    WHILE @j < @i
    BEGIN
        INSERT INTO @JobsRepeatTable VALUES (@JobId, @JobName)
        SELECT @j = @j+1    
    END
    FETCH NEXT FROM JobsCursor INTO @JobId, @JobName, @i
END 
RETURN 
END 
```

非常适合我。

# css - CSS过渡，具有相同属性的不同持续时间？

> ID：10902426
> 
> 赞同：3
> 
> 时间：2012-06-05T18:01:12.927
> 
> 标签：css, css-transitions

我知道您可以使用 CSS 过渡为不同的属性设置不同的持续时间。但是是否可以为*同一*属性设置不同的持续时间？

***示例：我希望一个框在悬停/鼠标退出时快速***增长/缩小到*长度 A* **，但是当按下按钮时，使用不同的类***缓慢***增长/缩小到*长度 B。***

 ****这是一个例子：

[http://jsfiddle.net/VDyPG/7/](http://jsfiddle.net/VDyPG/7/)

目前，盒子只有在悬停时快速增长，当鼠标退出时它会慢慢收缩。当然这是意料之中的，因为该`.box`课程应用了缓慢的持续时间，但是有没有办法解决这个问题？我已经制定了一种 hacky 方法`setTimeout`和一个额外的“快速”类，但如果有更优雅的方法会很可爱。

**注意：**我知道这可以通过 jQuery 轻松完成。然而，我真的在寻找它与 CSS 一起工作，因为我在这个孤立的例子之外面临的实际问题是 3D 变换。保持简单的例子。:)

**CSS：**

```
.box {
    background: red;
    width: 100px;
    height: 100px;
    margin: 10px;
    -webkit-transition: width 2s; 
}

.lengthA
{   
   width: 300px; 
   -webkit-transition-duration: 0.2s; /* Can this be used when class removed? */
}

.lengthB {
     width: 500px;    
} 
```

**jQuery：**

```
$('.box').on('mouseenter', function() {

    $(this).addClass('lengthA');            

})

$('.box').on('mouseleave', function() {

    $(this).removeClass('lengthA');            

})    

$('.makeBig').on('click', function() {

    $('.box').toggleClass('lengthB');            

}) 
```

​<strong>HTML：

```
<div class="box"></div>
<div class="box"></div>
<div class="box"></div>
<button class="makeBig">Grow!</button>
​ 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-06-05T21:08:16.330

我相信您可以使用这种技术的变体：http: [//css-tricks.com/different-transitions-for-hover-on-hover-off/](http://css-tricks.com/different-transitions-for-hover-on-hover-off/)。我现在在我的 iPad 上，所以这些不是一个例子，但它的要点是你在悬停伪选择器上设置了不同的转换。

如果你想使用jquery，那么你可以绑定到transitioned事件来找出之前的transition是什么时候完成的，值得注意的是命名并不一致——

你会想要使用类似的东西：

```
$("div").bind("webkitTransitionEnd oTransitionEnd msTransitionEnd transitionEnd transitionend", function(){
  //code
}); 
```

似乎 Firefox 使用的是 transitionend，而不是正确的 transitionEnd。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-06-08T08:15:40.907

你的意思是这样吗？：

```
<div class="box"></div>
<div class="box"></div>
<div class="box"></div>
<button class="makeBig">Grow!</button>

<style type="text/css">
    .box {
        width: 100px;
        height: 100px;
        margin: 10px;
        background: red;
        -webkit-transition: width 250ms ease;
    }
    .box:hover {
        width: 500px;
    }
    .box.slow {
        width: 500px;
        -webkit-transition-duration: 2s;
    }
</style>

<script src="http://ajax.googleapis.com/ajax/libs/jquery/1/jquery.min.js"></script>
<script type="text/javascript">
    $(".makeBig").on("click", function() {
        $('.box').addClass("slow");
    })
</script> 
```****

# ruby-on-rails-3 - Rails 3 将数据转换为图表

> ID：10902427
> 
> 赞同：1
> 
> 时间：2012-06-05T18:01:18.713
> 
> 标签：ruby-on-rails-3, html, draw, diagram

我的应用程序有一个锦标赛/竞赛系统，玩家可以在其中对战。我想知道是否存在任何可以将匹配表中的数据转换为图表的解决方案。

例如，如果我的数据库中保存了一个双淘汰赛结构，那么是否有一种方法可以获取原始数据并将其转换为如下内容：

![淘汰赛比赛示意图](../Images/c2804c8a7ef9ab99c0d86870d39060c5.png)

我想我可能不得不为此使用 HTML 5 画布或其他东西，但我希望会有一种更少手动的方法。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-06-05T18:39:47.170

您可以在应用程序中使用 Graphviz (http://www.graphviz.org/) 从存储在数据库中的数据生成图片。它不是 Ruby，但你肯定可以用它调用 3rd 方程序。

您的 Ruby 程序必须在 DOT 文件中描述图形数据，您可以在此处查看其描述：http: [//www.graphviz.org/content/dot-language](http://www.graphviz.org/content/dot-language)

# javascript - 使用下拉列表显示/隐藏

> ID：10902428
> 
> 赞同：0
> 
> 时间：2012-06-05T18:01:18.747
> 
> 标签：javascript, jquery, html

您好，我正在尝试在下面使用此代码。我喜欢该代码，但我希望默认为 DIV 区域 1。我的 HTML 代码在下拉菜单中显示 DIV 区域 1，但我希望 Javascript 默认显示 DIV 区域 1。代码是什么？

```
 <script type="text/javascript">
    $(document).ready(function(){
        $('.box').hide();
        $('#dropdown').change(function() {
            $('.box').hide();
            $('#div' + $('#dropdown').val()).show();
        });
    });
</script>

<form>
    <select id="dropdown" name="dropdown">
     <option value="0">Choose</option>
     <option value="area1" selected="selected">DIV Area 1</option>
     <option value="area2">DIV Area 2</option>
     <option value="area3">DIV Area 3</option>
    </select>
</form>

<div id="divarea1" class="box">DIV Area 1</div>
<div id="divarea2" class="box">DIV Area 2</div>
<div id="divarea3" class="box">DIV Area 3</div> 
```

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-06-05T18:05:15.913

```
$('.box').hide().first().show(); 
```

或者：

```
$('.box').hide().filter("#divarea1").show(); 
```

[**现场演示**](http://jsfiddle.net/2RDyf/)

将上述之一放入 DOM 就绪事件中：

```
$(function(){ /*...*/ }); 
```

或者

```
$(document).ready(function(){ /* ... */ }); 
```

**完整代码：（**它应该回答你下一个关于如何显示所选 div 的问题......）

```
$(document).ready(function() {

    $('.box').hide().filter("#divarea1").show();

    $('#dropdown').change(function() {
        var selectedId= $(this).find(':selected').text().replace(/\s/g, "").toLowerCase();
        console.log(selectedId);
        $('.box').hide().filter('#' + selectedId).show();
    });
});​ 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-06-05T18:08:33.037

可以这样做...

`$('.box').hide().filter(':first').show();`

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-06-05T18:49:16.490

一个简单的问题有很多复杂的答案：

`$('.box:gt(0)').hide();`

我会这样编码：

```
 $(document).ready(function(){
     $('.box:gt(0)').hide();

    $('#dropdown').change(function() {
        $('.box:visible').hide();
        if ($(this).prop('selectedIndex')>0)
            $('.box').eq($(this).prop('selectedIndex')-1).show();        
    });
});​ 
```

[http://jsfiddle.net/lucuma/xNZWY/](http://jsfiddle.net/lucuma/xNZWY/)

如果您从下拉列表中删除第一个选项（因为您正在预选是否有必要？）它会变得更简单，因为我们可以删除`if`

```
$(document).ready(function(){
     $('.box:gt(0)').hide();

    $('#dropdown').change(function() {
        $('.box:visible').hide();
        $('.box').eq($(this).prop('selectedIndex')-1).show();        
    });
});​ 
```

# c - 在 C 中存储颜色的整数，取决于字节序

> ID：10902430
> 
> 赞同：0
> 
> 时间：2012-06-05T18:01:18.957
> 
> 标签：c, colors, endianness

我有一个关于字节顺序的问题，我喜欢以 HTML 格式存储我的颜色（RGB 像 #aabbcc）。

我总是在我的代码中使用 0xaabbcc 来存储颜色，然后提取红色、绿色和蓝色我应用这样的蒙版：

```
int color = 0xaabbcc;
int r = color & 0xff0000;
int g = color & 0x00ff00;
int b = color & 0x0000ff; 
```

这个很好用，但是我没有在大端机器下测试过，结果会一样吗？

我必须看到 SDL 检查字节序以创建表面，如 man SDL_CreateRGBSurface 示例所示：

```
#if SDL_BYTEORDER == SDL_BIG_ENDIAN
   rmask = 0xff000000;
   gmask = 0x00ff0000;
   bmask = 0x0000ff00;
   amask = 0x000000ff;
#else
   rmask = 0x000000ff;
   gmask = 0x0000ff00;
   bmask = 0x00ff0000;
   amask = 0xff000000;
#endif

   surface = SDL_CreateRGBSurface(SDL_SWSURFACE, width, height, 32,
                                  rmask, gmask, bmask, amask); 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-06-05T18:04:46.727

是的。位掩码与字节顺序无关。唯一会出现字节序问题的地方是将其转换为字节数组（或在 c 中为 a `char *`），在这种情况下字节序很重要。

还要确保`sizeof(int) > 3`在使用此代码之前！

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-07-09T20:27:48.547

除非您以某种方式序列化数据（保存到磁盘，通过网络链接发送）或以整数以外的方式访问它（如 Richard J. Ross III 的回答中提到 a `char *`），否则没关系。您的变量和掩码具有相同的字节顺序。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-06-05T18:05:26.600

只要您处理实际的单个位，字节序就无关紧要。在处理位表示的数值时会遇到问题。您只是设置一个值，然后使用掩码将其读回，因此您应该没有任何问题。

# php - 使用 Apache 时在 PHP 中设置用于访问的环境变量

> ID：10902433
> 
> 赞同：120
> 
> 时间：2012-06-05T18:01:27.533
> 
> 标签：php, apache, ubuntu, environment-variables

我有一个 Linux 环境，我有一个 PHP Web 应用程序，它基于`getenv`PHP 中使用的环境变量有条件地运行。我需要知道如何设置这些环境变量以使应用程序正常工作。我不确定如何在 Apache 上进行设置。

此外，我需要能够为每个域分别配置单独的环境变量。

请就如何实现这一目标提出建议。

* * *

## 回答 #1

> 赞同：175
> 
> 时间：2012-06-05T18:05:26.103

类似的东西：

```
<VirtualHost hostname:80>
   ...
   SetEnv VARIABLE_NAME variable_value
   ...
</VirtualHost> 
```

* * *

## 回答 #2

> 赞同：33
> 
> 时间：2012-06-05T18:08:47.373

您也可以在 .htaccess 文件中执行此操作，前提是它们已在网站上启用。

```
SetEnv KOHANA_ENV production 
```

将是您需要添加到 .htaccess 以添加环境变量的全部内容

* * *

## 回答 #3

> 赞同：12
> 
> 时间：2019-05-14T05:14:23.413

如果你的服务器是 Ubuntu 并且 Apache 版本是 2.4

> 服务器版本：Apache/2.4.29 (Ubuntu)

`/etc/apache2/envvars`然后你在位置导出变量。

就像下面的行一样，您需要在`/etc/apache2/envvars`

`export MY_ENV_NAME=myEnvValue`

* * *

## 回答 #4

> 赞同：10
> 
> 时间：2016-04-14T14:33:47.320

令人难以置信，但在 centos 6.4 上的 httpd 2.2 上，这是可行的。

导出环境变量`/etc/sysconfig/httpd`

```
export mydocroot=/var/www/html 
```

然后只需执行此操作...

```
<VirtualHost *:80>
  DocumentRoot ${mydocroot}
</VirtualHost> 
```

然后最后......

```
service httpd restart; 
```

# android - 从通知打开对话框

> ID：10902435
> 
> 赞同：8
> 
> 时间：2012-06-05T18:01:29.573
> 
> 标签：android, dialog, notifications

我显示了一条通知。现在我希望发生这种情况：

当我点击通知时，我想打开一个对话框，我只打印 1 个字符串。

现在，当我创建通知时，我无法解决，在这里做什么：

```
...
Intent notificationIntent = new Intent(context, {how to open dialog}); 
... 
```

然后是 1 个按钮，例如“确定”，它将关闭对话框。

请帮我。

谢谢。

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2012-06-05T18:34:11.283

我在我的一个应用程序中正是这样做的。在通知中，您需要执行以下操作：

```
PendingIntent contentIntent = PendingIntent.getActivity(context, 0,
    new Intent("com.yourcompany.yourapp.MAINACTIVITY").putExtra("fromnotification", true); 
```

在你的主要活动中使用 onResume() 方法来检查这个额外的：

```
@Override
    public void onResume()
    {
            super.onResume();

            if (getActivity().getIntent().getBooleanExtra("fromnotification", false) == true)
            {
                    getActivity().getIntent().removeExtra("fromnotification");
                    startActivityForResult(
                                    new Intent("com.yourcompany.yourapp.DIALOGACTIVITY"), 123);
            }

    } 
```

这段代码显示了一个带有对话框样式的活动，但是它没有理由不能在 if 语句中创建一个对话框。

# sql-server - Oracle 和 SQL Server 的最大表注释长度

> ID：10902436
> 
> 赞同：6
> 
> 时间：2012-06-05T18:01:29.800
> 
> 标签：sql-server, oracle

Oracle 和 SQL Server 中表注释的最大长度是多少？对于 MySQL，这是 60 个字符。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2014-08-06T07:47:33.583

Oracle 对注释大小的限制为 4000 个字符。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-06-05T18:08:18.850

快速谷歌搜索导致评论存储在 user_tab_comments 中，因此只需检查数据库中该列的大小。

# php - Chrome 中的 get_browser() 返回“默认浏览器”

> ID：10902438
> 
> 赞同：5
> 
> 时间：2012-06-05T18:01:43.297
> 
> 标签：php, google-chrome, browser

我有一个 PHP 脚本，用于在向他显示我的页面之前检测用户浏览器。

使用 get_browser() 方法和从 chrome 窗口返回的数组索引 'array['browser']' 返回“默认浏览器”。不知道有没有人遇到过这种情况，或者类似的情况。我确定是这样。

感谢任何人的帮助。

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-06-05T18:05:00.533

```
<?php
function getBrowser() 
{ 
    $u_agent = $_SERVER['HTTP_USER_AGENT']; 
    $bname = 'Unknown';
    $platform = 'Unknown';
    $version= "";

    //First get the platform?
    if (preg_match('/linux/i', $u_agent)) {
        $platform = 'linux';
    }
    elseif (preg_match('/macintosh|mac os x/i', $u_agent)) {
        $platform = 'mac';
    }
    elseif (preg_match('/windows|win32/i', $u_agent)) {
        $platform = 'windows';
    }

    // Next get the name of the useragent yes seperately and for good reason
    if(preg_match('/MSIE/i',$u_agent) && !preg_match('/Opera/i',$u_agent)) 
    { 
        $bname = 'Internet Explorer'; 
        $ub = "MSIE"; 
    } 
    elseif(preg_match('/Firefox/i',$u_agent)) 
    { 
        $bname = 'Mozilla Firefox'; 
        $ub = "Firefox"; 
    } 
    elseif(preg_match('/Chrome/i',$u_agent)) 
    { 
        $bname = 'Google Chrome'; 
        $ub = "Chrome"; 
    } 
    elseif(preg_match('/Safari/i',$u_agent)) 
    { 
        $bname = 'Apple Safari'; 
        $ub = "Safari"; 
    } 
    elseif(preg_match('/Opera/i',$u_agent)) 
    { 
        $bname = 'Opera'; 
        $ub = "Opera"; 
    } 
    elseif(preg_match('/Netscape/i',$u_agent)) 
    { 
        $bname = 'Netscape'; 
        $ub = "Netscape"; 
    } 

    // finally get the correct version number
    $known = array('Version', $ub, 'other');
    $pattern = '#(?<browser>' . join('|', $known) .
    ')[/ ]+(?<version>[0-9.|a-zA-Z.]*)#';
    if (!preg_match_all($pattern, $u_agent, $matches)) {
        // we have no matching number just continue
    }

    // see how many we have
    $i = count($matches['browser']);
    if ($i != 1) {
        //we will have two since we are not using 'other' argument yet
        //see if version is before or after the name
        if (strripos($u_agent,"Version") < strripos($u_agent,$ub)){
            $version= $matches['version'][0];
        }
        else {
            $version= $matches['version'][1];
        }
    }
    else {
        $version= $matches['version'][0];
    }

    // check if we have a number
    if ($version==null || $version=="") {$version="?";}

    return array(
        'userAgent' => $u_agent,
        'name'      => $bname,
        'version'   => $version,
        'platform'  => $platform,
        'pattern'    => $pattern
    );
} 

// now try it
$ua=getBrowser();
$yourbrowser= "Your browser: " . $ua['name'] . " " . $ua['version'] . " on " .$ua['platform'] . " reports: <br >" . $ua['userAgent'];
print_r($yourbrowser);
?> 
```

来源：[http ://www.php.net/manual/en/function.get-browser.php#101125](http://www.php.net/manual/en/function.get-browser.php#101125)

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-06-05T18:04:18.637

请参阅文档中的注释：http: [//us3.php.net/get_browser](http://us3.php.net/get_browser)

> 为了使它工作，您在 php.ini 中的 browscap 配置设置必须指向系统上 browscap.ini 文件的正确位置。
> 
> browscap.ini 不与 PHP 捆绑，但您可以在此处找到最新的 » php_browscap.ini 文件。
> 
> 虽然 browscap.ini 包含许多浏览器的信息，但它依赖于用户更新来保持数据库最新。文件的格式是不言自明的。

# heroku - 捆绑命令的 Gemfile 错误

> ID：10902440
> 
> 赞同：2
> 
> 时间：2012-06-05T18:01:55.390
> 
> 标签：heroku, bundle, nomethoderror, gemfile

我是该应用程序的合作者，我克隆了该应用程序，并且一切都在我的合作者的计算机上运行良好。但是，当我在 Heroku 应用程序的根目录中键入 bundle exec 或 bundle install 时，我收到以下错误：

```
/Users/jacob/furious-ocean-6331/Gemfile:3:in `evaluate': undefined method `ruby' for # <Bundler::Dsl:0x007fcda31048c0> (NoMethodError)
       /Users/jacob/.rvm/gems/ruby-1.9.3-p194/gems/bundler-1.1.4/lib/bundler/dsl.rb:7:in `instance_eval'
       /Users/jacob/.rvm/gems/ruby-1.9.3-p194/gems/bundler1.1.4/lib/bundler/dsl.rb:7:in `evaluate'
       /Users/jacob/.rvm/gems/ruby-1.9.3-p194/gems/bundler-1.1.4/lib/bundler/definition.rb:18:in `build'
       /Users/jacob/.rvm/gems/ruby-1.9.3-p194/gems/bundler-1.1.4/lib/bundler.rb:135:in `definition'
       /Users/jacob/.rvm/gems/ruby-1.9.3-p194/gems/bundler1.1.4/lib/bundler/cli.rb:220:in `install'
       /Users/jacob/.rvm/gems/ruby-1.9.3-p194/gems/bundler1.1.4/lib/bundler/vendor/thor/task.rb:22:in `run'
       /Users/jacob/.rvm/gems/ruby-1.9.3-p194/gems/bundler-1.1.4/lib/bundler/vendor/thor/invocation.rb:118:in `invoke_task'
       /Users/jacob/.rvm/gems/ruby-1.9.3-p194/gems/bundler-1.1.4/lib/bundler/vendor/thor.rb:263:in `dispatch'
       /Users/jacob/.rvm/gems/ruby-1.9.3-p194/gems/bundler-1.1.4/lib/bundler/vendor/thor/base.rb:386:in `start'
       /Users/jacob/.rvm/gems/ruby-1.9.3-p194/gems/bundler-1.1.4/bin/bundle:13:in `<top (required)>'
       /Users/jacob/.rvm/gems/ruby-1.9.3-p194/bin/bundle:19:in `load'
       /Users/jacob/.rvm/gems/ruby-1.9.3-p194/bin/bundle:19:in `<main>'
       /Users/jacob/.rvm/gems/ruby-1.9.3-p194/bin/ruby_noexec_wrapper:14:in `eval'
       /Users/jacob/.rvm/gems/ruby-1.9.3-p194/bin/ruby_noexec_wrapper:14:in `<main>'
There was an error in your Gemfile, and Bundler cannot continue. 
```

这是宝石文件：

```
source 'https://rubygems.org'

ruby '1.9.3'
gem 'rails', '3.2.2'

# Bundle edge Rails instead: 
# gem 'rails', :git => 'git://github.com/rails/rails.git'

gem 'nokogiri'
gem 'bcrypt-ruby', :require => 'bcrypt'
gem "json", "~> 1.7.3"

# Gems used only for assets and not required
# in production environments by default.
group :assets do
  gem 'sass-rails',   '~> 3.2.3'
  gem 'coffee-rails', '~> 3.2.1'

  # See https://github.com/sstephenson/execjs#readme for more supported runtimes
  # gem 'therubyracer'

  gem 'uglifier', '>= 1.0.3'
end

gem 'thin'

gem "heroku"

gem 'jquery-rails'

group :development, :test do
    gem 'sqlite3'
end

group :production do
    gem 'pg'
end

# To use ActiveModel has_secure_password
# gem 'bcrypt-ruby', '~> 3.0.0'

# To use Jbuilder templates for JSON
# gem 'jbuilder'

# Use unicorn as the app server
# gem 'unicorn'

# Deploy with Capistrano
# gem 'capistrano'

# To use debugger
# gem 'ruby-debug19', :require => 'ruby-debug' 
```

* * *

## 回答 #1

> 赞同：9
> 
> 时间：2012-06-05T19:00:52.977

您在 Gemfile 中拥有的`ruby`元素仅适用于 Bundler 的预发布版本，请确保您这样做

`gem install bundler --pre`

确保您在捆绑器的预发布版本上运行，该版本添加了对指定 ruby​​ 版本的支持。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-06-06T05:11:58.303

要解决此问题，请安装 Bundler 1.2.0 的预发布版本。您不能简单地升级到预发布版本。您必须卸载然后安装。

```
$ gem uninstall -ax bundler
$ gem install bundler --pre
$ bundle --version 
```

然后运行

```
 $ bundle install 
```

安装 Gemfile 中指定的 gem

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-10-30T00:28:50.213

这个方法是从 bundle 1.2 开始添加的：

[http://bundler.io/v1.2/gemfile.html](http://bundler.io/v1.2/gemfile.html)

确保你`bundle --version`的足够新。

# javascript - ie8 - 边距和 ajax 错误

> ID：10902443
> 
> 赞同：0
> 
> 时间：2012-06-05T18:02:03.903
> 
> 标签：javascript, css, ajax, internet-explorer-8

任何帮助将不胜感激，谢谢。

错误 1 ​​- [http://perfectgsm.hu](http://perfectgsm.hu)

中间的 Nivo 滑块，在 IE8 中，顶部不对齐（其他一切都正确）。Inline margin-top:-12px 内部，但在 IE8 开发模式下，它看起来被某些东西覆盖了。

（看起来像在 IE8 中的 div 开始，但它的内容是在它上面开始）

* * *

错误 2 - [http://perfectgsm.hu](http://perfectgsm.hu)

顶部的垂直金色菜单，在悬停任何元素时，其按钮都有奇怪的移动

（看起来像这个家伙的问题： [https](https://stackoverflow.com/questions/1470418/ie8-vertical-margin-bug) ://stackoverflow.com/questions/1470418/ie8-vertical-margin-bug ）

* * *

错误 3 - [http://konzolbazis.hu](http://konzolbazis.hu)

ajax 搜索不起作用...在标题中有一个搜索，键入它应该刷新 ID=ajax 的表，在其他浏览器中它就像一个魅力。

（使用 w3schools 的代码作为它的基础，链接如下，它在 ie8 中工作：http: [//www.w3schools.com/php/php_ajax_php.asp](http://www.w3schools.com/php/php_ajax_php.asp) ）

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-06-05T19:01:29.207

搜索 bug 解决：IE8 不支持 js .innerHTML 改变 TR 的内容，所以必须使用 DIV。

其他的还开着。

# c - 用 C 预处理器打印一些东西

> ID：10902446
> 
> 赞同：2
> 
> 时间：2012-06-05T18:02:15.463
> 
> 标签：c, c-preprocessor

> **可能重复：**
> [是否有可移植的方式从 C 预处理器打印消息？](https://stackoverflow.com/questions/3826832/is-there-a-portable-way-to-print-a-message-from-the-c-preprocessor)

在浏览大型代码库时，有时很难猜测定义了什么，没有定义什么。因此，我想在编译时打印一些东西。例如：

```
#ifdef SOME_DEFINE
// I want a preprocessor to print something here so that 
//  I can know whether SOME_DEFINE is defined or not
#endif 
```

这可能与**C**有关吗？我在某处
看到了一个名字。`#error`也许这是我唯一的选择，或者不是？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-06-05T19:02:59.957

该`#error`指令的伟大之处在于，即使它不受支持，它也能正常工作！

如果支持，编译器会告诉你`"error: #error"`，如果不支持，编译器会告诉你`"invalid preprocessing directive"`. 无论哪种方式，这都是一个致命错误，编译停止，编译器会告诉你哪一行是有问题的行。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-06-05T18:13:35.287

对于 MS Visual C++：

```
#define __PRINT(str) __pragma(message(str)) 
```

# sharepoint-2010 - 从列表工作流以编程方式创建子站点

> ID：10902450
> 
> 赞同：0
> 
> 时间：2012-06-05T18:02:26.407
> 
> 标签：sharepoint-2010, workflow

所以我的情况是这样的：用户将用于创建子站点的名称和其他信息添加到共享点列表中。站点管理员可以批准或拒绝子站点的创建。

现在我的问题是，谁能帮助我如何从工作流程创建子网站？任何代码将不胜感激。

非常感谢各位，

问候。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-06-06T14:20:15.963

绝对走创建自定义工作流活动的路径，从长远来看，这将允许更大的可重用性

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-06-05T18:10:22.657

您可以将此操作添加到 SharePoint Designer

[http://www.ilovesharepoint.com/2011/02/create-site-action-sharepoint-designer.html](http://www.ilovesharepoint.com/2011/02/create-site-action-sharepoint-designer.html)

然后创建一个工作流程，在项目批准后将为您创建一个站点。

-p

# html - 用于绘画应用的 HTML5 笔工具

> ID：10902453
> 
> 赞同：0
> 
> 时间：2012-06-05T18:02:37.360
> 
> 标签：html, pen

您好我正在尝试在 HTML5 中创建一个基本的绘图应用程序。有谁知道如何为 HTML5 制作钢笔工具？我已经知道如何创建基本的绘图工具，只是在钢笔工具上寻找一些帮助。任何帮助将不胜感激，谢谢。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-06-05T18:08:20.037

我会看看使用 paper.js

[http://paperjs.org/](http://paperjs.org/)

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2018-11-14T00:04:27.653

是的，喜欢[钢笔工具](https://codepen.io/RoryDuncan/pen/CDHBJ)，由 Rory Duncan 原创

```
var clickState = 0; // keeps track of clicks
var lastClickCoords = {}; // keeps track of position last clicked

this.tool.pen = {

  "mousedown": function(e){

    if (clickState === 0) {

      this.disallowToolChange();
      self.ctx.save();

      currentLine = new Curve(this, e.offsetX, e.offsetY);

      $(self.canvas).on("mousemove", callEvent);
      clickState++;
    }
    else if (clickState === 1) {

      clickState++;
      currentLine.to(e.offsetX, e.offsetY)

    }
    else if (clickState === 2) {

      clickState = 0;
      currentLine.arc(e.offsetX, e.offsetY);
      this.push(currentLine);

      self.ctx.restore();

      $(self.canvas).off("mousemove", callEvent);
      this.allowToolChange();
    }
  },

  "mousemove": function(e){

    if (clickState === 1) {
      currentLine.to(e.offsetX, e.offsetY)
      currentLine.preview();
    }
    else if (clickState === 2) {
      currentLine.arc(e.offsetX, e.offsetY);
      currentLine.preview();

    }
  }
}; 
```

# iphone - 如何去饱和 UIImage？

> ID：10902454
> 
> 赞同：10
> 
> 时间：2012-06-05T18:02:46.400
> 
> 标签：iphone, objective-c, ios, uiimage, core-graphics

iOS 5.x 中是否有一种简单的方法（或内置库）可以使 UIImage 去饱和？这是我目前的做法：

```
CGContextRef context = UIGraphicsGetCurrentContext();
    CGContextSaveGState(context);

    CGContextTranslateCTM(context, 0.0, self.bounds.size.height); // flip image right side up
    CGContextScaleCTM(context, 1.0, -1.0);

    CGContextDrawImage(context, rect, self.image.CGImage);
    CGContextSetBlendMode(context, kCGBlendModeSaturation);
    CGContextClipToMask(context, self.bounds, image.CGImage); // restricts drawing to within alpha channel
    CGContextSetRGBFillColor(context, 0.0, 0.0, 0.0, desaturation);
    CGContextFillRect(context, rect);

    CGContextRestoreGState(context); // restore state to reset blend mode 
```

这似乎比我预期的要复杂一些。还有比这更简单的方法吗？

我在考虑核心图像，但我似乎找不到一个具体的例子来说明如何使用它来去饱和图像。

* * *

## 回答 #1

> 赞同：21
> 
> 时间：2012-06-06T03:45:59.677

您可以使用我的开源[GPUImage](https://github.com/BradLarson/GPUImage)框架使用两三行代码来做到这一点：

```
UIImage *inputImage = [UIImage imageNamed:@"inputimage.png"];    
GPUImageGrayscaleFilter *grayscaleFilter = [[GPUImageGrayscaleFilter alloc] init];
UIImage *grayscaleImage = [grayscaleFilter imageByFilteringImage:inputImage]; 
```

（如果不使用 ARC 构建，请记住释放过滤器）

这会将图像降低到其亮度值，使其去饱和。如果您想要可变饱和度/去饱和度，您可以使用 GPUImageSaturationFilter。正如框架名称所示，此过滤在 GPU 上运行，并且在我从 5.1 开始在 iOS 上进行基准测试的几乎所有情况下都比 Core Image 更快。

# gwt - 在 GWT 中执行事件块后调用函数

> ID：10902455
> 
> 赞同：1
> 
> 时间：2012-06-05T18:02:51.843
> 
> 标签：gwt

我正在使用 GWT 并有一个按钮，单击该按钮应过滤 CellTable 中显示的数据，然后隐藏一些列。

```
filterButton.addClickHandler(new ClickHandler() {
    public void onClick (ClickEvent event) {
        //some working code here to get the minimum and maximum
        filter(min, max);
        hideCols();
    }
}); 
```

我的问题就在这里。我发现（来自[https://developers.google.com/web-toolkit/doc/latest/DevGuideUiCellWidgets#celllist](https://developers.google.com/web-toolkit/doc/latest/DevGuideUiCellWidgets#celllist)） ListDataProvider 将 Celltable 绑定到我的列表，并且对列表的任何更改都将反映在视图中。视图在当前事件块的末尾更新，这导致了我的问题。我在当前事件块中调用 hideCols() 并隐藏列，但据我所知，视图在退出块时更新，并且重新绘制列。ListDataProvider 完全完成后，有什么方法可以让 hideCols() 运行？

```
filter(int min, int max) {
    for (SiteInfo site : displayedList)
        if (site.num_zones >= min && site.num_zones <= max)
            filteredList.add(site);
    dataProvider.getList().clear();
    dataProvider.getList().addAll(filteredList);
    siteTable.setRowCount(filteredList.size());
} 
```

最后是 hideCols() 函数。我知道它可以正常工作，因为我在代码的其他地方成功地调用了它。第一行隐藏列标题，第二行负责相应列的行。

```
private native void hideCols()/*-{
    $wnd.jQuery("span.toHide").parent().hide();
    $wnd.jQuery(".toHide").hide();
}-*/; 
```

任何帮助将非常感激。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-06-05T22:14:11.030

您可以使用 同步重绘[`flush()`](http://google-web-toolkit.googlecode.com/svn/javadoc/latest/com/google/gwt/user/cellview/client/AbstractCellTable.html#flush%28%29)。

但是 IMO 你应该修复你的`hideCols`: 用于[`addColumnStyleName`](http://google-web-toolkit.googlecode.com/svn/javadoc/latest/com/google/gwt/user/cellview/client/AbstractCellTable.html#addColumnStyleName%28int,%20java.lang.String%29)添加一个类，[`visibility: collapse`](http://www.w3.org/TR/CSS21/tables.html#columns)或者[从](http://google-web-toolkit.googlecode.com/svn/javadoc/latest/com/google/gwt/user/cellview/client/AbstractCellTable.html#removeColumn%28int%29).`CellTable`

为了回答你的问题，你可以使用[`Scheduler.get().scheduleFinally`](http://google-web-toolkit.googlecode.com/svn/javadoc/latest/com/google/gwt/core/client/Scheduler.html#scheduleFinally%28com.google.gwt.core.client.Scheduler.ScheduledCommand%29)（或者`scheduleDeferred`如果*finally*还不够晚）。

# vba - 如何使用 VBA 将子报表插入到我的报表中

> ID：10902463
> 
> 赞同：0
> 
> 时间：2012-06-05T18:03:22.680
> 
> 标签：vba, ms-access

好吧，我有 4 个子报表，它们都有一个数据源。

（Sureport | 数据源）

(subreport1 | Query1) (subreport2 | Query2) (subreport3 | Query3) (subreport4 | Query4)

等等...

当我打开报表时，我想检查 Query1、2、3 和 4 是否存在，并在此基础上将正确的子报表添加到我的主报表中。

我很陌生，不知道从哪里开始。哪个是解决我的问题的最佳方法？

谢谢你。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-06-05T18:25:42.600

根据每个子报表的 HasData 属性设置子报表的可见性。

```
Private Sub Detail_Format(Cancel As Integer, FormatCount As Integer)
    If Me.Table_subreport.Report.HasData Then
        Me.Table_subreport.Visible = True
    Else
        Me.Table_subreport.Visible = False
    End If
End Sub 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2019-07-29T03:24:52.873

最简单的方法是：

```
Private Sub Detail_Format(Cancel As Integer, FormatCount As Integer)
    Me.Table_subreport.Visible = Me.Table_subreport.Report.HasData
End Sub 
```

# iphone - 键盘隐藏时的iOS事件

> ID：10902465
> 
> 赞同：25
> 
> 时间：2012-06-05T18:03:26.813
> 
> 标签：iphone, objective-c, ios, xcode, cocoa-touch

我需要控制，在显示键盘并按下完成按钮后，当键盘隐藏时。在 iOS 上隐藏键盘时会触发哪个事件？谢谢

* * *

## 回答 #1

> 赞同：59
> 
> 时间：2012-06-05T18:06:43.950

是 使用以下

```
//UIKeyboardDidHideNotification when keyboard is fully hidden
//name:UIKeyboardWillHideNotification when keyboard is going to be hidden

[[NSNotificationCenter defaultCenter]addObserver:self selector:@selector(onKeyboardHide:) name:UIKeyboardWillHideNotification object:nil]; 
```

和`onKeyboardHide`

```
-(void)onKeyboardHide:(NSNotification *)notification
{
     //keyboard will hide
} 
```

* * *

## 回答 #2

> 赞同：6
> 
> 时间：2017-01-06T19:15:59.120

如果你想知道用户何时按下完成按钮，你必须采用`UITextFieldDelegate`协议，然后在你的视图控制器中实现这个方法：

斯威夫特 3：

```
func textFieldShouldReturn(_ textField: UITextField) -> Bool {
    // this will hide the keyboard
    textField.resignFirstResponder()
    return true
} 
```

如果您想简单地知道键盘何时显示或隐藏，请使用`Notification`：

斯威夫特 3：

```
NotificationCenter.default.addObserver(self, selector: #selector(self.keyboardWillShow(_:)), name: .UIKeyboardWillShow , object: nil)

NotificationCenter.default.addObserver(self, selector: #selector(self.keyboardWillHide(_:)), name: .UIKeyboardWillHide , object: nil)

func keyboardWillShow(_ notification: NSNotification) {
    print("keyboard will show!")

    // To obtain the size of the keyboard:
    let keyboardSize:CGSize = (notification.userInfo![UIKeyboardFrameBeginUserInfoKey] as! NSValue).cgRectValue.size

}

func keyboardWillHide(_ notification: NSNotification) {
    print("Keyboard will hide!")
} 
```

* * *

## 回答 #3

> 赞同：5
> 
> 时间：2012-06-05T18:06:22.283

您可以收听 a `UIKeyboardWillHideNotification`，它会在键盘关闭时发送。

# html - 更改类流体布局css

> ID：10902466
> 
> 赞同：0
> 
> 时间：2012-06-05T18:03:33.803
> 
> 标签：html, css, layout, grid, fluid-layout

我有一个流畅的 CSS 网格（[http://cssgrid.net/](http://cssgrid.net/)）

我目前正在设计一个网站，使用这个网格系统。虽然，当“没有足够的空间”时，我不确定如何更改课程。

例如，我有一个这样的顶栏：

![在此处输入图像描述](../Images/7959877deab5b082980b171e7672cad6.png) 链接：http: [//i47.tinypic.com/2eouv54.png](http://i47.tinypic.com/2eouv54.png)

但是，当我调整浏览器窗口的大小时，我会得到以下结果：

![在此处输入图像描述](../Images/f1b7be6eb0a6444c52d5802533309144.png)

如您所见，它看起来完全一团糟！

我怎样才能充分利用这种流畅的布局。我的意思是，当这些按钮和用户名没有足够的空间时，我怎样才能让它们适合？即通过创建一个新类并将其放置在其他地方。

谢谢！

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-06-08T09:58:54.473

当你有这样的事情时：

```
aside {float: left; width: 50%; padding: 0 50px; box-sizing: border-box; background: #000;} 
```

你可以添加这样的东西：

```
@media only screen
and (min-device-width : 320px)
and (max-device-width : 768px) {
   aside {float: none; width: 100%; padding: 0 20px;}
} 
```

第一条规则将适用于所有屏幕尺寸。第二条规则将应用于宽度从 320px 到 768px 的设备，它将覆盖现有规则。这意味着会改变浮动、宽度和填充，但不会改变例如背景或盒子大小。

# iphone - 如何创建多个图像视图并获取它们的相交框架。？

> ID：10902469
> 
> 赞同：0
> 
> 时间：2012-06-05T18:03:49.220
> 
> 标签：iphone, ios, ipad, uiimageview, cgrect

我正在开发游戏。下面的屏幕截图显示了我的游戏的整个过程。 ![在此处输入图像描述](../Images/b73d5e105c43bb03e813bcc8ca00170d.png)

首先，当我的游戏开始时，在 viewdidload 中，我使用 NStimer 从上到下移动我的红球。当我点击我的 aeroplan 时，它首先是使用 NStimer 的 Missels...首先我检查交叉点然后创建新球。

```
 if ((CGRectIntersectsRect(missels.frame,Ball.frame))
         {
          [self performSelector:@selector(createball) ];
          } 
```

当我的导弹击中球时，它分成两部分，如我在屏幕截图中显示的那样。这是这两个新球的代码。

```
 -(void)createball{
  imageMove1 = [[UIImageView alloc] initWithFrame:CGRectMake(x,y,50 ,50)];        
  UIImage *imag = [UIImage imageNamed:@"ball1.png"];
  [imageMove1 setImage:imag];
  imageMove1.tag=i;
  [self.view addSubview:imageMove1];
  [ballArray addObject:imageMove1];

  imageMove2 = [[UIImageView alloc] initWithFrame:CGRectMake(x,y,50 ,50)];        
  UIImage *imag1 = [UIImage imageNamed:@"ball1.png"];
  [imageMove2 setImage:imag1];
  imageMove2.tag=k;
  [self.view addSubview:imageMove2];
  [ball1Array addObject:imageMove2];
  [self performSelector:@selector(moveball) ];
 } 
```

之后，我使用 CAKeyframeAnimation 将运动赋予这些新球。这里是代码。

```
-(void)moveball{
 for (int i=0; i<[ballArray count]; i++) {
 moveimg=[ballArray objectAtIndex:i];
 CAKeyframeAnimation *pathAnimation = [CAKeyframeAnimation animationWithKeyPath:@"position"];
 pathAnimation.calculationMode = kCAAnimationPaced;
 pathAnimation.fillMode = kCAFillModeForwards;
 pathAnimation.removedOnCompletion = NO;
 pathAnimation.duration = 15.0;
 pathAnimation.repeatCount = 1;
 CGMutablePathRef curvedPath = CGPathCreateMutable();
 CGPathMoveToPoint(curvedPath, NULL, x+15, y);
 CGPathAddQuadCurveToPoint(curvedPath, NULL, 20, 10, 100, 330);
 pathAnimation.path = curvedPath;
 CGPathRelease(curvedPath);
 moveimg.center=CGPointMake(x, y);
 [moveimg.layer addAnimation:pathAnimation forKey:@"moveTheSquare"];
  }

for (int k=0; k<[ball1Array count]; k++) {
        move1img=[ball1Array objectAtIndex:k];
        CAKeyframeAnimation *pathAnimation1 = [CAKeyframeAnimation animationWithKeyPath:@"position"];
        pathAnimation1.calculationMode = kCAAnimationPaced;
        pathAnimation1.fillMode = kCAFillModeForwards;
        pathAnimation1.removedOnCompletion = NO;
        pathAnimation1.duration = 15.0;
        pathAnimation1.repeatCount = 1;
        CGMutablePathRef curvedPath1 = CGPathCreateMutable();
        CGPathMoveToPoint(curvedPath1, NULL, x+40, y);
        CGPathAddQuadCurveToPoint(curvedPath1, NULL, 350, 10, 380, 330);
        pathAnimation1.path = curvedPath1;
        CGPathRelease(curvedPath1);
        move1img.center=CGPointMake(x, y);
        [move1img.layer addAnimation:pathAnimation1 forKey:@"moveTheSquare"];
     }
   } 
```

我的这种方法只对我在missels和球相交后创建前两个球有效。一旦我的球运动后，它不适用于相交。所以简而言之，在这场比赛中我面临两个主要问题。

1.  如何在我的球和 Missels 的每个交叉点上创建两个新球。
2.  创建这些球后，如何在与missel相交的移动过程中获取这些球的帧。就像这样..

    ```
     if ((CGRectIntersectsRect(missels.frame,mynewballs.frame)) 
    ```

    任何人都可以给出解决这个问题的最佳想法。任何帮助都将提前获得。thanx。

# image - 在 Flash AS3 中从网络摄像头拍摄当前图像

> ID：10902472
> 
> 赞同：1
> 
> 时间：2012-06-05T18:03:51.647
> 
> 标签：image, actionscript-3, flash, webcam

因此，我设法使用以下代码在 AS3 应用程序中查看我的网络摄像头：

```
package{
    import flash.display.Sprite;
    import flash.media.Camera;
    import flash.media.Video;

    public class WebCam extends Sprite
    {   
        private var camara:Camera;
        private var video:Video;

        public function WebCam():void {
            setupCamera();
        }

        private function setupCamera():void
        {
            video = new Video(640, 480);
            camara = Camera.getCamera();
            camara.setMode(640, 480, 30);
            video.attachCamera(camara);
            addChild(video);
        }

    }

} 
```

但我想知道是否有办法从网络摄像头拍摄当前图像并将其保存在本地某处？

编辑：

@Sean 这是我当前的代码：

```
var camara;
var video;

//Get the camera reference.
camara = Camera.getCamera();

//Create a video instance
video = new Video(640, 480);

video.attachCamera(camara);

addChild(video);

var bitmapData:BitmapData = new BitmapData(640, 480);
bitmapData.draw(video);

var encoder:JPGEncoder = new JPGEncoder();
var byteArray:ByteArray = encoder.encode(bitmapData);

navnavClick.addEventListener(MouseEvent.CLICK,function(){
var fileReference:FileReference = new FileReference();
fileReference.save(byteArray);
}); 
```

这一切都很好，但输出图像只是一个空白（白色）图像。我也包含了 JPGEncoder 类。有任何想法吗？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-06-05T19:33:37.440

首先，您需要将图像绘制到`BitmapData`.

```
var bitmapData:BitmapData = new BitmapData(640, 480);
bitmapData.draw(video); 
```

然后，您需要对`BitmapData`. 我会推荐使用 Alchemy 的编码器，但 Adob​​e 正在从 Flash Player 中删除它。因此，您应该使用较慢的[as3corelib JPGEncoder](https://github.com/mikechambers/as3corelib/blob/master/src/com/adobe/images/JPGEncoder.as)。

```
var encoder:JPGEncoder = new JPGEncoder();
var byteArray:ByteArray = encoder.encode(bitmapData); 
```

您现在拥有图像文件的原始字节，并且可以将它们写入磁盘。

```
var fileReference:FileReference = new FileReference();
fileReference.save(byteArray); 
```

（这部分必须从用户启动的操作中调用，例如单击）。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-11-17T02:40:56.303

好吧，试试这段代码，我使用它，它工作正常：

```
var cam:Camera = Camera.getCamera();
cam.setMode(stage.stageWidth,stage.stageHeight,30);
var video_es = new Video(cam.width, cam.height);
video_es.attachCamera(cam); 
stage.addEventListener(MouseEvent.CLICK, snapIt); 
var screenS:BitmapData = new BitmapData(cam.width, cam.height); 
addChild(video_es);

function snapIt(e:MouseEvent):void { 
   screenS.draw(video_es) ;

   var jpgEncoder:JPGEncoder = new JPGEncoder();
   var byteArray:ByteArray = jpgEncoder.encode(screenS);

   var fileReference:FileReference=new FileReference();
   fileReference.save(byteArray, "test1.jpg");

} 
```

希望有帮助

# java - Android - 将位图分配给 ImageView 更改大小

> ID：10902478
> 
> 赞同：1
> 
> 时间：2012-06-05T18:04:03.870
> 
> 标签：java, android, android-layout, android-imageview

我的应用程序用智能手机的相机拍照。拍摄照片后，我想将照片分配给 ImageView。但随后 ImageView 的大小发生了变化。

```
protected void onActivityResult(int requestCode, int resultCode, Intent data) {
if (requestCode == CAPTURE_IMAGE_ACTIVITY_REQUEST_CODE
    && resultCode == Activity.RESULT_OK) {

  ContentResolver cr = getContentResolver();
  Bitmap bitmap = null;
  Bitmap scaledBitmap  = null;
  InputStream in = null;
  Image image = this.getActualImage();      

  try {
    in = cr.openInputStream(this.imageUri);
    BitmapFactory.Options o = new BitmapFactory.Options();
    o.inSampleSize = 1;
    bitmap = BitmapFactory.decodeStream(in, null, o);

    ImageView view = null;
    view = (ImageView) findViewById(R.id.img_face1);                  

    int height = view.getHeight();
    int width = view.getWidth();
    Log.i(TAG, "Scale operation dimenions - width: " + width
        + ", height: " + height);

    scaledBitmap = Bitmap.createScaledBitmap(bitmap, width, height, true);
    view.setImageBitmap(scaledBitmap);
    System.gc();
    in.close();
  } catch (Exception e) {
    Log.e("Camera", e.toString());
  } 
```

我的布局 xml 如下所示：

```
 <LinearLayout
    xmlns:android="http://schemas.android.com/apk/res/android"
    android:id="@+id/screen_capture_face2"
    style="@style/linearLayoutVertical"
    android:layout_width="wrap_content"
    android:layout_height="wrap_content"
    android:weightSum="2" >

    <ImageView
        android:id="@+id/img_face1"
        android:layout_width="wrap_content"
        android:layout_height="wrap_content"
        android:layout_weight="1"
        android:adjustViewBounds="true"
        android:contentDescription="@string/desc_dummy_face"
        android:src="@drawable/dummy_face"
         />

    <ImageView
        android:id="@+id/img_face2"
        android:layout_width="wrap_content"
        android:layout_height="wrap_content"
        android:layout_weight="1"
        android:adjustViewBounds="true"
        android:contentDescription="@string/desc_dummy_face"
        android:src="@drawable/dummy_face"
         />

</LinearLayout> 
```

在我将位图分配给 ImageView img_face1 后，大小会发生变化。为什么会这样？我错过了什么？我是 Android 新手，也许这只是一些小错误。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-06-05T18:07:15.047

首先，您设置`adjustViewBounds`为`true`. 它的参考资料说：

> 如果您希望 ImageView 调整其边界以保持其可绘制对象的纵横比，请将其设置为 true。

您可以尝试删除它，并另外添加`scaleType="fitCenter"`选项，以便调整大小的图像而不是图像视图。您还需要更改`wrap_content`其布局属性的值，因为那些说*使该视图足够大以显示其全部内容*。

# wpf - 使用 KeyTime 值作为资源

> ID：10902480
> 
> 赞同：1
> 
> 时间：2012-06-05T18:04:18.530
> 
> 标签：wpf, animation, resources

我有故事板：

```
 <Storyboard x:Key="St1">
        <DoubleAnimationUsingKeyFrames Storyboard.TargetProperty="(UIElement.Opacity)" Storyboard.TargetName="imageBlue">
            <EasingDoubleKeyFrame KeyTime="0:0:0.5" Value="0"/>
        </DoubleAnimationUsingKeyFrames>
    </Storyboard> 
```

我想提取 keyTime 值并将其放置在某处。换句话说，我一直在努力使这项工作：

```
<UserControl.Resources>

    <sys:TimeSpan x:Key="FadeInBeginTime">0:0:2</sys:TimeSpan>
    <Duration x:Key="FadeInDuration">0:0:1</Duration>

    <Storyboard x:Key="St1">
        <DoubleAnimationUsingKeyFrames Storyboard.TargetProperty="(UIElement.Opacity)" Storyboard.TargetName="imageBlue">
            <EasingDoubleKeyFrame KeyTime={StaticResource FadeInDuration}" Value="0"/>
        </DoubleAnimationUsingKeyFrames>
    </Storyboard>
</UserControl.Resources> 
```

注意我正在使用命名空间：

```
xmlns:sys="clr-namespace:System;assembly=mscorlib" 
```

由于某种原因不起作用

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-12-12T12:28:46.157

您应该将 FadeInDuration 指定为 KeyTime 而不是 TimeSpan

IE：

```
<KeyTime x:Key="FadeInBeginTime">0:0:2.0</KeyTime> 
```

# vb.net - 为什么在我的计算机之外无法访问我的服务器？

> ID：10902483
> 
> 赞同：1
> 
> 时间：2012-06-05T18:04:20.437
> 
> 标签：vb.net, httpserver

我在 VB.net 中创建了一个 Http 服务器。对于每个需要 Http Server 的项目（最近不少），我猜你可能会说，我使用了相同的“模板”。问题是，我现在正在使用的这个要求局域网上的计算机能够连接到它。我可以使用以下命令直接从我的计算机访问服务器：`http://127.0.0.1:8002/`. 这是我的源代码（当然是略读）：

```
Imports System.Net
Imports System.IO
Imports System.Web
Imports System.Text
Imports System.Text.RegularExpressions
Imports Microsoft.Win32

Public Class MainWindow

    Private Enum ApplicationSituation
        Idle
        Login
        TrackPage
    End Enum

    Private CurrentApplicationSituation As ApplicationSituation = ApplicationSituation.Idle

    Private listener As New HttpListener
    Private theService As String

    Private Const PORT As Integer = 8002
    Private Const SERVERNAME As String = "Poptimas"

    Private ContentTypes As New Dictionary(Of String, String)

    Private ServerThread As Threading.Thread

    Private Sub WriteContentTypes()
        '(TEXT) Human-readable text and source code
        ContentTypes.Add(".txt", "text/plain")
        ContentTypes.Add(".htm", "text/html")
        ContentTypes.Add(".html", "text/html")
        ContentTypes.Add(".xml", "text/xml")
        ContentTypes.Add(".css", "text/css")
        ContentTypes.Add(".csv", "text/scv")
        ContentTypes.Add(".htc", "text/x-component")
        ContentTypes.Add(".js", "application/javascript")
        '(IMAGE)
        ContentTypes.Add(".png", "image/png")
        ContentTypes.Add(".jpg", "image/jpg")
        ContentTypes.Add(".bmp", "image/bmp")
        ContentTypes.Add(".gif", "image/gif")
        ContentTypes.Add(".tiff", "image/tiff")
        ContentTypes.Add(".ico", "image/vnd.microsoft.icon")
        '(AUDIO)
        ContentTypes.Add(".mp3", "audio/mp3")
        ContentTypes.Add(".wav", "audio/vnd.wav")
        ContentTypes.Add(".ogg", "audio/ogg")
        ContentTypes.Add(".mwa", "audio/x-ms-wma")
        '(VIDEO)
        ContentTypes.Add(".mp4", "video/mp4")
        ContentTypes.Add(".wmv", "video/x-ms-wmv")
        ContentTypes.Add(".mov", "video/quicktime")
        '(APPLICATION) Non-standard
        ContentTypes.Add(".pdf", "application/pds")
        ContentTypes.Add(".swf", "aplication/x-shockwave-flash")
    End Sub

    Private Function ParseQuery(ByVal queryset As String) As Dictionary(Of String, String)
        Dim FinQu As New Dictionary(Of String, String)
        If queryset.Length > 0 Then
            For Each qSet As String In queryset.Substring(1).Split("&")
                Dim sA() As String = qSet.Split("=")
                FinQu.Add(sA(0), sA(1))
            Next
        End If
        Return FinQu
    End Function

    Private Sub StartServer()
        Try
            Dim machineName As String = System.Environment.MachineName
            VariableValues.Add("port", PORT)
            VariableValues.Add("computer", machineName)
            theService = HttpUtility.UrlEncode(SERVERNAME)

            WriteContentTypes()

            With listener
                .Prefixes.Add(String.Format("https://*:{0}/", PORT.ToString))
                .Prefixes.Add("http://127.0.0.1:" & PORT.ToString & "/")
                .Start()
            End With

            Dim context As HttpListenerContext
            Dim path As String

            While listener.IsListening
                context = listener.GetContext
                path = context.Request.Url.AbsolutePath.ToLower
                Dim query As Dictionary(Of String, String) = ParseQuery(context.Request.Url.Query)
                If path = "/" Then
                    Select Case CurrentApplicationSituation
                        Case ApplicationSituation.Idle

                        Case ApplicationSituation.Login
                            SendPage(context.Response, My.Computer.FileSystem.CurrentDirectory & "/MobilePandoraConnection/login.html", ".html")
                        Case ApplicationSituation.TrackPage
                            SendPage(context.Response, My.Computer.FileSystem.CurrentDirectory & "/MobilePandoraConnection/track.html", ".html")
                    End Select
                ElseIf path = "/inject" Then
                    SendPage(context.Response, My.Computer.FileSystem.CurrentDirectory & "/MobilePandoraConnection/PandoraMediaServer.js", ".js")
                Else
                    SendPage(context.Response, My.Computer.FileSystem.CurrentDirectory & "/MobilePandoraConnection" & path, path.Substring(path.IndexOf(".")).ToLower())
                End If
            End While

            With listener
                .Stop()
                .Close()
            End With
        Catch ex As Exception
            MsgBox(ex.ToString())
        End Try
    End Sub

    Private Sub SendPage(ByVal response As HttpListenerResponse, ByVal Location As String, ByVal extension As String)

        With response
            .ContentType = ContentTypes(extension)
            .ContentEncoding = Encoding.UTF8

            Try
                Dim cont() As Byte = System.Text.Encoding.ASCII.GetBytes(page)
                Else
                    cont = My.Computer.FileSystem.ReadAllBytes(Location)
                End If
                .OutputStream.Write(cont, 0, cont.LongLength)
                .OutputStream.Flush()
            Catch ex As Exception
                MsgBox("Server Error: " & ex.ToString)
            Finally
                Try
                    .Close()
                Catch ex As Exception
                End Try
            End Try
        End With

    End Sub

    Private Sub MainWindow_FormClosing(sender As Object, e As System.Windows.Forms.FormClosingEventArgs) Handles Me.FormClosing
        'Stupid Server likes to keep everything running - kill that sucka'
        Process.GetCurrentProcess().Kill()
    End Sub

    Private Sub SystemPanel_Shown(sender As Object, e As System.EventArgs) Handles Me.Shown
        'Start server in new thread to prevent an un-reponsive form
        ServerThread = New Threading.Thread(AddressOf StartServer)
        ServerThread.Start()
    End Sub

End Class 
```

如果有任何事情不起作用（例如，如果您尝试将其复制并直接粘贴到测试中），那么我可能只是在删除一些不重要的代码时犯了一个错误。

**顺便说一句：** - 我的防火墙没有运行

**为STEVEDOG编辑**

我做了这两个前缀：

```
.Prefixes.Add(String.Format("https://*:{0}/", PORT.ToString))
.Prefixes.Add(String.Format("http://*:{0}/", PORT.ToString)) 
```

现在，每次尝试应用前缀时都会出现错误：

> 无法侦听前缀“https://*:8002/”，因为它与机器上的现有注册冲突。

我检查了所有正在侦听的端口，并且 8002 仍然打开...

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-06-05T18:06:46.960

您无法在 IP 地址 127.0.0.1 上监听。您需要实际监听您的真实 IP 地址。监听 127.0.0.1 只会接收专门发送到环回地址的消息。

此外，您不能使用 HttpListener 在同一端口和 IP 地址上同时收听 http 和 https。有关更多信息，请参阅此链接：

[.NET HttpListener：同时注册 HTTP 和 HTTPS 时，我得到“与机器上的现有注册冲突”](https://stackoverflow.com/questions/2619251/net-httplistener-when-registering-both-http-https-i-get-conflicts-with-an-e)

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-06-05T18:21:14.860

在`http://127.0.0.1:8002/`，您的计算机的地址是`127.0.0.1`。

通常有 4 种方法可以访问您的服务器：

*   `127.0.0.1`: 这只能在你自己的电脑上工作。

*   `192.168.1.1`或类似的：这仅适用于您的本地网络。因为 IPV4 地址的数量非常有限，所以您使用的地址仅在您的 LAN 上有效，并且没有对所有人可见的“永久”IP 地址。LAN 上的每台计算机都有不同的本地 IP 地址，但世界上有许多计算机具有相同的本地地址。

*   如果您的 LAN 和 Internet 之间的路由器配置为允许进入来自 Internet 的连接（这对您来说有点危险，尤其是如果您的个人计算机上没有防火墙），那么您有一个您可能知道的 IP，使用很多[http://www.knowmyip.com/](http://www.knowmyip.com/)等在线服务。此地址是临时的，将在您下次连接时更改（因为没有足够的 IPV4 地址）

*   一个名字，使用像[http://dyn.com/dns/](http://dyn.com/dns/)这样的服务，它为每个人提供一个常量名和你的服务器之间的动态链接。这样人们就可以使用类似[http://keods.dyndns.org](http://keods.dyndns.org)的方式访问您的服务器，而不是询问您当前的 IP 地址是什么。

但是，只要您的服务器位于没有固定 IP 地址的专用网络上，您的服务器可能不会像[http://www.ovh.co.uk/](http://www.ovh.co.uk/)（或另一个，这只是一个例子）。在将您的地址提供给您的商业合作伙伴之前，您应该选择众多命名和托管服务之一，其中大多数都非常便宜。

# xml - 任何顺序的 XML 元素，有些是必需的，有些不是

> ID：10902485
> 
> 赞同：6
> 
> 时间：2012-06-05T18:04:44.193
> 
> 标签：xml, xsd

我正在尝试以任何顺序列出允许的元素列表。一些元素是必需的（最小值为 1，最大值为 1），一些是可选的，最多为 1，而一些是可选的，具有任意数量。这就是我所拥有的，并且 XSD 是有效的，但是当我去验证 XML 时，我试图实现的规则没有被强制执行。例如，id 不是必需的。

```
<xsd:complexType name="feedType">
        <xsd:annotation>
            <xsd:documentation>
                The Atom feed construct is defined in section 4.1.1 of the format spec.
            </xsd:documentation>
        </xsd:annotation>
        <xsd:choice minOccurs="3" maxOccurs="unbounded">
            <xsd:element name="author" type="atom:personType" minOccurs="0" maxOccurs="unbounded"/>
            <xsd:element name="category" type="atom:categoryType" minOccurs="0" maxOccurs="unbounded"/>
            <xsd:element name="contributor" type="atom:personType" minOccurs="0" maxOccurs="unbounded"/>
            <xsd:element name="generator" type="atom:generatorType" minOccurs="0" maxOccurs="1"/>
            <xsd:element name="icon" type="atom:iconType" minOccurs="0" maxOccurs="1"/>
            <xsd:element name="id" type="atom:idType" minOccurs="1" maxOccurs="1"/>
            <xsd:element name="link" type="atom:linkType" minOccurs="0" maxOccurs="unbounded"/>
            <xsd:element name="logo" type="atom:logoType" minOccurs="0" maxOccurs="1"/>
            <xsd:element name="rights" type="atom:textType" minOccurs="0" maxOccurs="1"/>
            <xsd:element name="subtitle" type="atom:textType" minOccurs="0" maxOccurs="1"/>
            <xsd:element name="title" type="atom:textType" minOccurs="1" maxOccurs="1"/>
            <xsd:element name="updated" type="atom:dateTimeType" minOccurs="1" maxOccurs="1"/>
            <xsd:element name="entry" type="atom:entryType" minOccurs="0" maxOccurs="unbounded"/>
            <xsd:any namespace="##other" minOccurs="0" maxOccurs="unbounded"/>
        </xsd:choice>
        <xsd:attributeGroup ref="atom:commonAttributes"/>
    </xsd:complexType> 
```

* * *

## 回答 #1

> 赞同：11
> 
> 时间：2013-02-12T22:35:11.500

我刚刚遇到了同样的问题，并查看了他们在[XHTML XSD](http://www.w3.org/2002/08/xhtml/xhtml1-strict.xsd)中做了什么。里面的情况相同`head`:`title`是必需的，是可选的，`base`然后允许任意数量的`script`, `style`,和元素。`meta``link``object`

以下是他们所做的：首先，他们将可能多次出现的可选元素分组：

```
 <xs:group name="head.misc">
    <xs:sequence>
      <xs:choice minOccurs="0" maxOccurs="unbounded">
        <xs:element ref="script"/>
        <xs:element ref="style"/>
        <xs:element ref="meta"/>
        <xs:element ref="link"/>
        <xs:element ref="object"/>
      </xs:choice>
    </xs:sequence>
  </xs:group> 
```

`head`然后他们在实际定义中引用了这个组：

```
 <xs:sequence>
    <xs:group ref="head.misc"/>
    <xs:choice>
      <xs:sequence>
        <xs:element ref="title"/>
        <xs:group ref="head.misc"/>
        <xs:sequence minOccurs="0">
          <xs:element ref="base"/>
          <xs:group ref="head.misc"/>
        </xs:sequence>
      </xs:sequence>
      <xs:sequence>
        <xs:element ref="base"/>
        <xs:group ref="head.misc"/>
        <xs:element ref="title"/>
        <xs:group ref="head.misc"/>
      </xs:sequence>
    </xs:choice>
  </xs:sequence> 
```

这有点棘手。写成类似正则表达式的伪代码，上面看起来像这样：

```
misc=(script|style|meta|link|object)*
head=${misc}(title${misc}(base${misc})?|base${misc}title${misc}) 
```

所以，从技术上讲，它是有效的。

但是，这需要将强制和可选元素的所有可能排列（中间有杂项）放入`choice`. 对于`n`元素，这就是`n!`子节点。因此，对于 XHTML，`n=2`他们最终以`n!=2`. 在你的情况下`n=8`，它将是`n!=40320`。

FWIW，这是生成 XSD 的算法：

```
result = '<xs:group name="misc"><xs:sequence><xs:choice minOccurs="0" maxOccurs="unbounded">'
forall(optionalArbitraryCountElements as element)
    result += '<xs:element ref="' + element.name + '"/>'
result += '</xs:choice></xs:sequence></xs:group>'

result += '<xs:complexType name="feedType"><xs:sequence><xs:group ref="misc"/><xs:choice>'
permutations = getAllPermutations(mandatoryElements + optionalOnceElements)
foreach (permutations as p)
    result += '<xs:sequence>'
    foreach (p as element)
        if (element.isOptional)
            result += '<xs:sequence minOccurs="0">'
        result += '<xs:element ref="' + element.name + '"/><xs:group ref="misc"/>'
        if (element.isOptional)
            result += '</xs:sequence>'
    result += '</xs:sequence>'
result += '</xs:choice></xs:sequence></xs:complexType>'

return result 
```

* * *

## 回答 #2

> 赞同：5
> 
> 时间：2012-06-05T18:16:29.827

`choice`只允许其子元素之一出现在 XML 图中。`sequence`如果您的元素始终处于相同的顺序，您似乎想要使用它。如果顺序是可变的，那么您应该使用`all`并包装`maxOccurs="unbounded"`包含列表元素中的所有元素，因为`all`只允许其子元素出现 1 次或 0 次。

编辑：

您应该从选择元素中删除 minOccurs 和 maxOccurs。这仅允许您强制执行 3 个选项，但不允许您指定它们是什么选项（包括多次重复相同的元素）。我不知道你到底想强制执行什么，但它不会以这种方式有效执行。

编辑2：

您可以按如下方式创建列表包装器（以链接元素为例）：

```
<xs:element name="linkList" minOccurs="0" maxOccurs="1">
<xs:complexType>
  <xs:sequence>
    <xs:element name="link" type="atom:linkType" minOccurs="0" maxOccurs="unbounded" />
  </xs:sequence>
</xs:complexType>
</xs:element> 
```

在 xml 文档中，您将（例如）将链接元素嵌套在链接列表中：

老的：

```
<other elements...>
<id>...</id>
<link>...</link>
<link>...</link>
<logo>...</logo>
<other elements...> 
```

新的：

```
<other elements...>
<id>...</id>
<linkList>
  <link>...</link>
  <link>...</link>
</linkList>
<logo>...</logo>
<other elements...> 
```

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2016-04-06T10:52:11.277

基本上，在使用 XSD 时不要这样做。它不是为这样的用例而设计的。

您可以[改用 RelaxNG](http://relaxng.org/)进行验证，使用其无序操作，或者如果您有需要 XSD 的合作伙伴，则强制执行任意顺序。

出于这个原因， [RFC4287](https://www.rfc-editor.org/rfc/rfc4287#section-4.1.1)中给出的原子提要模式使用了 RelaxNG：

```
 atomFeed =
      element atom:feed {
         atomCommonAttributes,
         (atomAuthor*
          & atomCategory*
          & atomContributor*
          & atomGenerator?
          & atomIcon?
          & atomId
          & atomLink*
          & atomLogo?
          & atomRights?
          & atomSubtitle?
          & atomTitle
          & atomUpdated
          & extensionElement*),
         atomEntry*
      } 
```

有关何时在 XML 中强制执行顺序的进一步讨论，请参阅[XML 设计原则：当 XML 元素的顺序很重要时](https://www.ibm.com/developerworks/library/x-eleord/)

# ruby-on-rails - ActiveRecord 将所有子项移动到另一条记录

> ID：10902497
> 
> 赞同：1
> 
> 时间：2012-06-05T18:06:02.773
> 
> 标签：ruby-on-rails, activerecord, associations, splat

我有一张表，它与其他表有五种不同的多对多关系。在删除一条记录之前，我需要将其所有子项移动到另一条记录。为此，我使用以下代码：

```
self.class.reflect_on_all_associations.select {|assoc| assoc.macro == :has_many }.each do |assoc|
  target.send(assoc.name) << self.send(assoc.name)
end 
```

基本上，这归结为`target.child-association << self.child-association`. 但这不能正常工作，从“self”中删除所有子项，并将一个子项添加到“target”，除关联字段 null 之外的所有字段。我认为这是因为“<<”需要一条记录，而我正在传递一组记录。我看到“<<”也接受参数列表，所以我认为我需要类似`target.send(assoc.name) << *self.send(assoc. name)`的东西（注意 splat 运算符），但我无法找出有效的语法来执行此操作。所以我的问题有两个：

1.  你如何“splat”一个任意数组以输入“<<”？
2.  这是使儿童重新分配正常工作所需要的吗？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-06-05T23:32:38.823

好的，以下是答案：

1) target.send(assoc.name).send(:<<, *(self.send(assoc.name)))

2) 原始技术效率低下，生成“n”条 SQL 更新，每条更新一条子记录。更有效的技术是`self.send(assoc.name).update_all(parent_id: target.id)`。它需要对链接是如何完成的（在我的情况下和大多数情况下，一个单一的外键字段）有内疚的知识，我认为这可以从关联中反映出来）。

# mysql - 检查客户是否在表中出现多次

> ID：10902499
> 
> 赞同：0
> 
> 时间：2012-06-05T18:06:15.547
> 
> 标签：mysql

sso 我无法在标题中准确表达我需要什么。我对 mysql 很陌生首先，这是我目前使用的 sql 表[http://dl.dropbox.com/u/37057843/P2_Scripts.sql](http://dl.dropbox.com/u/37057843/P2_Scripts.sql)

我将简要解释一下：我需要获得不止一次在（该）酒店中的客户，并且在每种类型的房间中至少一次。（检查下表的解释）

这些是表格：

*   reservas (reservations)，其中包含预订的 ID (id)、预订的客户 ID (idCliente) 和房间号 (idHabita)。
*   客户，客户表，其中包含他的 id、他的名字（名词）、他的姓氏（apellido）、他的地址和电话号码（最后两个没有使用）
*   habitaciones (rooms)，其中包含房间号 (id)、以 m2 为单位的大小 (superficie)、一些无关紧要的东西，最后是价格的 id (idPrecio)。
*   precios (prices)，其中包含条目的 id、房间类型 (tipo) 和价格 (precio)。TIPO 的价值可以是“个人”或“双重”。像个人或双人间。

所以基本上，

*   reservas.idCliente = clientes.id
*   reservas.idHabita = habitaciones.id
*   habitaciones.precio = precio.id

正如我之前提到的，我需要让客户在每种类型的房间中至少出现一次，所以基本上在单人房间一次或多次，在双人间一次或多次。

我知道这有点不好解释，但我不知道如何更好地解释它，很抱歉。

我目前正在使用此查询来获取单个房间中的人员（姓名、姓氏和房间编号）

```
SELECT c.nombre, c.apellidos, r.idHabita
FROM  clientes c, reservas r, precios p, habitaciones h
WHERE r.idCliente = c.id
AND r.idHabita = h.id
AND h.idPrecio = p.id
AND p.tipo LIKE 'individual' 
```

而且我知道我必须执行某种类型的子查询来检查 p.tipo 是否也为“double”，但我就是无法正常工作。此查询返回的客户也与双人房中的客户相同。事实上，这些是曾经在一个单独的房间里的唯一的。但我需要一个查询来检查他们是否也在双人间。

提前感谢您的阅读！

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-06-05T18:16:08.023

要获得“*在每种类型的房间中至少出现一次*”的客户，请将客户表与其关联的预订加入并按客户对结果进行分组 - 然后您需要那些具有相同数量的不同房间类型的组房间类型表，可以用一个`HAVING`子句表示：

```
SELECT   c.*
FROM     clientes     c
  JOIN   reservas     r ON r.idCliente = c.id
  JOIN   habitaciones h ON r.idHabita  = h.id
  JOIN   precios      p ON h.idPrecio  = p.id
GROUP BY c.id
HAVING   COUNT(DISTINCT p.tipo) = (
  SELECT COUNT(DISTINCT   tipo) FROM precios
) 
```

在[sqlfiddle](http://sqlfiddle.com/#!2/aa0ee/1)上查看。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-06-05T18:13:39.960

这显示了每个符合条件的房间的行（每人多个房间 - 至少一个人和至少一个双人间） - 正是您要求的输出（顺便说一句，当他们帮助您时接受答案，否则人们将停止帮助您）：

```
SELECT c.nombre, c.apellidos, r.idHabita
FROM clientes c
INNER JOIN reservas r
ON r.idCliente = c.id
INNER JOIN habitaciones h
ON r.idHabita = h.id
WHERE r.idCliente IN
(SELECT r1.idCliente
FROM clientes c1
INNER JOIN reservas r1
ON r1.idCliente = c1.id
INNER JOIN habitaciones h1
ON r1.idHabita = h1.id
INNER JOIN precios p1
ON h1.idPrecio = p1.id
WHERE p1.tipo = 'individual')
AND r.idCliente IN
(SELECT r2.idCliente
FROM clientes c2
INNER JOIN reservas r2
ON r2.idCliente = c2.id
INNER JOIN habitaciones h2
ON r2.idHabita = h2.id
INNER JOIN precios p2
ON h2.idPrecio = p2.id
WHERE p2.tipo = 'doble')
ORDER BY c.nombre, c.apellidos, r.idHabita 
```

**更新：**刚刚添加了排序...

# r - R markdown：从代码块访问变量（变量范围）

> ID：10902504
> 
> 赞同：62
> 
> 时间：2012-06-05T18:06:46.663
> 
> 标签：r, knitr, r-markdown

在 R markdown（knitr 包）中，我可以访问在代码块中计算的文档正文中的变量吗？

* * *

## 回答 #1

> 赞同：95
> 
> 时间：2012-06-05T19:29:29.893

是的。您可以简单地调用任何先前评估的变量内联。

例如，如果您之前`data.frame`在一个块中创建了一个`df <- data.frame(x=1:10)`

```
`r max(df$x)` 
```

应该生产

```
10 
```

* * *

## 回答 #2

> 赞同：13
> 
> 时间：2017-05-28T05:17:13.920

您可以访问以前创建的变量

```
`r variable` 
```

但是，如果变量是数字并且您想添加到 pdf 文档中，则应该将变量转换为字符串，以便

```
`r toString(variable)` 
```

* * *

## 回答 #3

> 赞同：6
> 
> 时间：2016-12-13T23:40:39.323

我想补充一点，对于 R 以外的其他语言，情况并非如此。我知道问题已经解决并且关于 R，但也许其他人觉得这很有用：

> 除了 engine='R' （默认），所有的块都在单独的会话中执行，所以变量不能直接共享。如果我们想利用之前块中创建的对象，我们通常必须将它们写入文件（作为副作用）。对于 bash 引擎，我们可以使用 Sys.setenv() 将变量从 R 导出到 bash（示例）。另一种方法是使用（实验性）runr 包。

[来源](http://yihui.name/knitr/demo/engines/)

R中的示例：

```
x = 4

print(x)

## [1] 4 
```

Python 示例 2a)：

```
x=1
print(x)

## 1 
```

Python 示例 2b)：

```
print(x)

## Traceback (most recent call last):
##   File "<string>", line 1, in <module>
## NameError: name 'x' is not defined 
```

仅供参考。

# android - android 在哪里读取文件 fonts.xml 以正确加载字体？

> ID：10902506
> 
> 赞同：0
> 
> 时间：2012-06-05T18:06:54.337
> 
> 标签：android, fonts, android-firmware

我已经找了很多天了。

我公司的安卓设备（我们制造）使用的是安卓2.1。我们需要为我们的一位客户支持阿拉伯语。我们能够让第三方软件正确加入阿拉伯语并从另一个第三方购买字体以在 2.1 中显示阿拉伯语。

Android 2.1 有一个名为 fonts.xml 的文件，它指定何时使用字体，包括备用字体。

我想知道代码中的哪个组件读取 fonts.xml 文件（当前位于 /frameworks/base/data/fonts），以便我可以将此文件更改到另一个位置并为每个客户动态更改它，而无需重建新的每次系统的图像。

谢谢！

更新：

搜索 fonts.xml 我发现 sdk.atree 包含以下几行：

```
# fonts for layoutlib.
frameworks/base/data/fonts/fonts.xml                 platforms/${PLATFORM_NAME}/data/fonts/fonts.xml
frameworks/base/data/fonts/DroidSans.ttf             platforms/${PLATFORM_NAME}/data/fonts/DroidSans.ttf
frameworks/base/data/fonts/DroidSans-Bold.ttf        platforms/${PLATFORM_NAME}/data/fonts/DroidSans-Bold.ttf
frameworks/base/data/fonts/DroidSansMono.ttf         platforms/${PLATFORM_NAME}/data/fonts/DroidSansMono.ttf
frameworks/base/data/fonts/DroidSerif-Bold.ttf       platforms/${PLATFORM_NAME}/data/fonts/DroidSerif-Bold.ttf
frameworks/base/data/fonts/DroidSerif-BoldItalic.ttf platforms/${PLATFORM_NAME}/data/fonts/DroidSerif-BoldItalic.ttf
frameworks/base/data/fonts/DroidSerif-Italic.ttf     platforms/${PLATFORM_NAME}/data/fonts/DroidSerif-Italic.ttf
frameworks/base/data/fonts/DroidSerif-Regular.ttf    platforms/${PLATFORM_NAME}/data/fonts/DroidSerif-Regular.ttf
frameworks/base/data/fonts/DroidSansFallback.ttf     platforms/${PLATFORM_NAME}/data/fonts/DroidSansFallback.ttf
frameworks/base/data/fonts/DroidSansJapanese.ttf     platforms/${PLATFORM_NAME}/data/fonts/DroidSansJapanese.ttf 
```

但是，我在 /system/fonts/ 中没有看到文件 fonts.xm 和 DroidSansJapanese.ttf

我建议我的工作将阿拉伯字体重命名为 DroidSansJapanese.ttf 以便系统读取它，但这肯定会在未来引起混乱。

我还尝试手动将修改后的 fonts.xml 放入 /sytem/fonts 并重新启动设备，但没有奏效。

此外，FontLoader.java 加载 fonts.xml，但它没有指定整个路径，因为它通过 Bridge.java 传递。Bridge.java 也通过了完整路径。使用的变量是 String fontOsLocation。它在两个类中都是这样命名的，所以我进行了搜索，但没有找到指定源中的确切位置：

```
public static FontLoader create(String fontOsLocation) {} 
```

我的最后一个选择是尝试重新编写 FontLoader，因此即使它需要一个字符串作为 fontOsLocation，我也只是给它一个来自 SD 卡的硬编码路径。但我不知道这可能会对系统产生什么影响。谢谢你。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-06-07T17:42:34.457

好的，所以我找到了一种解决方案。对于遇到此问题的任何人，这里是：

external/skia/src/ports/SkFontHost_android.cpp -> 指定哪些 .ttf 文件用于哪种样式

并且字体文件需要添加到：

frameworks/base/data/fonts/ -> 这里是所有的 .ttf 文件

并且还需要修改 frameworks/base/data/fonts/ 文件夹中的 Android.mk，以便将新字体文件从该文件夹复制到 /system/fonts

希望这可以帮助某人。

# ios - iOS 上的部署自动化？

> ID：10902509
> 
> 赞同：1
> 
> 时间：2012-06-05T18:06:57.587
> 
> 标签：ios, release, continuous-deployment, nolio

有没有人有使用一个统一的工具来处理 Java 服务器端 + iOS 包文件创建部署自动化的经验？必须能够插入到像 Hudson/TeamCity 这样的持续集成引擎中。同样可取的是与 TestFlight 等工具的集成。

我正在寻找与 UrbanDeploy、Nolio 等工具等效的工具。这里有任何可用和使用的开源工具吗？

干杯，萨文德

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-11-28T20:26:02.660

看看[cisimple.com](https://www.cisimple.com)。我没有亲自尝试过，但是根据他们的网站，他们应该可以解决您的问题。而且我很确定，在不久的将来，越来越多的托管持续集成和部署平台也支持移动开发。

# php - 选择要在 php 邮件程序中使用的变量

> ID：10902511
> 
> 赞同：0
> 
> 时间：2012-06-05T18:07:00.853
> 
> 标签：php

我正在为我的网站联系表使用一个简单的 php 邮件程序。我有一个表格，首先询问他们的联系主题，如果他们选择了一个特定的选项，那么收件人选择将淡入，您可以选择要使用的收件人。但。由于垃圾邮件，我不想在代码中写电子邮件地址。所以我试图通过php变量来实现这一点。

我的邮件看起来像这样：

```
<?php
$var1="xxx@gmail.com";
$var2="xxx@gmail.com";
$to = "$_POST[kohde]";
$subject = "$_POST[asia]";
$message = "
$_POST[tiedot]\n
$_POST[nimi]
$_POST[email]
$_POST[puhelin]
IP-osoite: $_POST[ip] ";
$from = "xxx.fi";
$headers = "From:" . $from;
mail($to,$subject,$message,$headers);
?> 
```

但是按原样使用变量名是行不通的。那么，如何在不将电子邮件硬编码为选项值的情况下选择要与该选项一起使用的电子邮件呢？

```
 <select name="kohde" style="width:233px;" >
    <option value="$var1">xxx.fi</option>
    <option value="$var">Sivun tekijälle</option>
    </select> 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-06-05T18:08:41.787

您的第一个代码应该是这样的：

```
<?php
$var1="xxx@gmail.com";
$var2="xxx@gmail.com";

$to = $_POST["kohde"];
$subject = $_POST["asia"];

$message = $_POST["tiedot"] . 
$_POST["nimi"] . 
$_POST["email"] . 
$_POST["puhelin"] . 
"IP-osoite:" . $_POST["ip"];

$from = $_POST["kohde"];
$headers = "From:" . $from;

mail($to, $subject, $message, $headers);
?> 
```

You have to put the quotes around the array selectors, within the brackets, not around the whole variable name. Also, you can add the form value as `$from` using `$_POST["kohde"]`.

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-06-05T18:11:07.620

I would do it this way...

Use this PHP to get the $to address:

```
$goodAddresses = array(1 => 'a@x.com', 2 => 'b@x.com');
$to = 'default@x.com';
if(isset($goodAddresses[$_POST['kohde']])) {
    $to = $goodAddresses[$_POST['kohde']];
} 
```

And change the values of your select options in our html file to match the array keys in the PHP:

```
<select name="kohde" style="width:233px;" >
    <option value="1">xxx.fi</option>
    <option value="2">Sivun tekijälle</option>
</select> 
```

# c++ - 何时使用详细类型说明符

> ID：10902518
> 
> 赞同：8
> 
> 时间：2012-06-05T18:07:35.717
> 
> 标签：c++, coding-style

有没有特别好的理由选择使用详细的类型说明符？例如，在某些情况下，需要使用`template`or`typename`关键字来消除依赖项`template`或类型的歧义。

但我想不出任何例子，比如枚举。以下面的代码示例为例：

```
enum Foo { A,  B };

void bar(Foo foo);
void baz(enum Foo foo); 
```

为什么我会选择使用`baz()`提供的语法`bar()`（反之亦然）？有什么模棱两可的情况吗？

* * *

## 回答 #1

> 赞同：8
> 
> 时间：2012-06-05T18:16:03.247

没有理由使用此类说明符，除非您正在处理名称被不同“种类”的名称隐藏的情况。例如，声明一个以`Foo`枚举声明命名的变量是完全合法的，因为非正式地说，对象名和类型名存在于独立的“命名空间”中（更正式的规范请参见 3.3/4）

```
enum Foo { A, B };

int Foo; 
```

声明后`int Foo`，您的`bar`声明将失效，而更详细的`baz`声明将保持有效。

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2012-06-05T18:16:12.123

声明用户定义的类型需要详细的类型说明符。一种用例是转发声明您的类型。万一您有一个与您在范围内可见的函数同名的函数，`enum`您可能需要在函数声明中使用详细的类型说明符：

```
enum A { A_START = 0 };

void A(enum A a) {}

int main() {
   enum A a;
   A( a );
} 
```

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-12-19T02:06:04.790

选择使用详细类型说明符的一个很好的理由是在头文件中转发声明结构或类。给定一个定义类型的标头

```
// a.h
struct foo {}; 
```

您可以包含该标题来原型您的功能

```
#include "a.h"
void foo(foo * ) ; 
```

或使用详细类型：

```
void foo(struct foo * ) ; 
```

或者，使用详细类型明确转发声明：

```
struct foo ;
void foo( foo * ) ; 
```

最后两种方法中的任何一种都可以帮助避免您的标题逐渐退化为一个完全连接的网络，其中包括任何单个标题都会拉动所有其余部分（我正在开发一个软件产品，可悲的是，这会迫使您在多次您可以想象的各种变化在逻辑上都是孤立的）。

我知道 C++11 也将​​允许对枚举进行这种前向引用，这是 C++01 编译器目前不允许的。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2012-06-05T18:16:58.600

可能出现的一个示例是，当您拥有类型和同名的非类型元素时。通过使用详细的类型说明符，您可以显式请求类型：

```
struct foo {};
void foo(struct foo) {}
int main() {
   struct foo f;
   foo(f);
} 
```

如果没有详细说明的类型说明符，`foo`in`main`指的是`void foo(struct foo)`，而不是 type `struct foo`。现在，我不希望它出现在生产代码中，但您只要求提供一个重要的示例。如果类型和函数（或变量）被定义在不同的命名空间中，在这些命名空间中通过查找更早地找到了非类型，也会发生同样的情况。你可以`struct`用`enum`上面的替换。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2021-08-11T12:12:49.540

下面解释的前向声明是 Elaborated Type Specifier 的一种表现形式。

> 在 C++ 和 Objective-C 等一些面向对象的语言中，有时需要前向声明类。这是在需要知道类的名称是类型但不需要知道结构的情况下完成的。
> 
> 在 C++ 中，类和结构可以像这样前向声明：
> 
> ```
> class MyClass; 
> 
> struct MyStruct; 
> ```
> 
> 在 C++ 中，如果您只需要使用指向该类的指针类型，则可以前向声明类（因为所有对象指针的大小都相同，这是编译器所关心的）。这在类定义中特别有用，例如，如果一个类包含一个成员，该成员是另一个类的指针（或引用）。
> 
> 前向声明用于避免不必要的耦合，这有助于通过减少包含头文件的数量来减少编译时间。这具有三重优势：
> 
> *   减少打开的文件数量`#include`（因此减少操作系统调用的数量）
> *   减少预处理文件的体积（因为不包括标题）
> *   在修改前向声明的类时减少重新编译的影响。
> 
> 如果您需要使用实际的类类型，则类的前向声明是不够的，例如，如果您有一个成员的类型直接是该类（不是指针），或者如果您需要将其用作基类，或者如果您需要在方法中使用类的方法。

这允许您使用指向类型的指针，而不必在头文件中包含相关的头文件（而您只需要在 .cpp 文件中使用它）。

这有助于减少依赖关系，从而提高编译时间。

并不总是需要它，尤其是`Unreal Engine`核心类，因为它们通常都包含在内。但是，如果您没有明确包含头文件，则使用前缀是一种很好的做法。如果你这样做，如果任何包含头文件的文件更改为不包含它，你的代码仍然可以编译。

虽然前向申报很好，但您应该避免使用 ETS。如果你想转发声明你的类型，最好在文件范围内明确地这样做：

## 坏的：

```
class Bad
 {
     void Func(class Y* YParam);
     class Z* ZProp;
 }; 
```

## 好的：

```
 class Y;
 class Z;
 class Good
 {
     void Func(Y* YParam);
     Z* ZProp;
 }; 
```

# java - 使用 SWT.MULTI 获取表的选定行

> ID：10902527
> 
> 赞同：2
> 
> 时间：2012-06-05T18:08:22.957
> 
> 标签：java, swt

我有一个带有 SWT.MULTI 的表。现在我想获取选定的行。到目前为止，我只有一个选择，并通过选择侦听器获得了选定的行。但是如何获取 SWT.Multi 表的选定行？

谁能帮我？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-06-05T18:14:51.510

`table.getSelection()`返回一个数组`TableItems`。

# c# - DBContext 多线程

> ID：10902528
> 
> 赞同：1
> 
> 时间：2012-06-05T18:08:28.683
> 
> 标签：c#, multithreading, visual-studio-2010, loops, dbcontext

我有一个使用 MVC3 (Razor) 在 VS2010 中构建的网站

我使用 DBContexts 访问数据库，我的连接字符串是：

```
<add name="SystemDBContext"
connectionString="Data Source=|DataDirectory|System.sdf"
providerName="System.Data.SqlServerCe.4.0" /> 
```

我想要一个游戏循环，所以我在 Application_Start 中启动了一个新线程，它使用 DBContext 循环和访问数据库。

似乎正在发生的事情是循环使用 DBContext 并锁定 db 文件，然后每当您尝试从网站本身的 DBContext 进行更改时，该文件正在使用中。

这不是在我声明 DBContext 时，而是在我尝试使用 DBContext 执行某种搜索或更新时发生。

这是我的 Global.asax

```
 protected void Application_Start()
    {
        ...
        Manager m = new Manager();
        Thread t = new Thread(m.Start);
        t.Start();
    } 
```

我的一个控制器的一部分：

```
public class myController : Controller
{
    private SystemDBContext db = new SystemDBContext();

    public ViewResult Index()
    {
        var engines = db.Engines.Include(e => e.state);
        return View(engines.ToList());
    }
    ... 
```

我的循环看起来像这样：

```
public class Manager
{
    public void Start()
    {
        while (true)
        {
            SystemDBContext db = new SystemDBContext();
            var query = from ...
        }
        ... 
```

这样做的最佳做法是什么？我一直在考虑 Singletons、Locks 或 Synclocks，调整连接字符串以允许对数据库文件进行多个附加，或者让我的循环请求执行更新的网页。

有任何想法吗？

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-06-05T18:16:41.247

> 似乎正在发生的事情是循环使用 DBContext 并锁定 db 文件，然后每当您尝试从网站本身的 DBContext 进行更改时，该文件正在使用中。

回到阅读文档？它说 WinCE 不是多线程服务器的部分。改用 SQL Server - [Express 是免费的](http://www.microsoft.com/en-us/download/details.aspx?id=26729)。CE 用于有限的可扩展性项目，单线程访问。

> 这样做的最佳做法是什么？

使用合适的数据库服务器。CE 有很大的问题，特别是如果您一直启动/停止数据库引擎，这会导致很多低效的磁盘访问。

SQL Server 正是为此而做的，正如我所说 - Express 很便宜。

# c# - 如何发送键 Control + A + B？（保持控制修饰符“按下”）

> ID：10902536
> 
> 赞同：6
> 
> 时间：2012-06-05T18:09:00.347
> 
> 标签：c#, winapi, coded-ui-tests

当我记录这个序列时它失败了。我知道我可以使用 Keyboard.SendKeys(control, "A",ModifierKeys.Control) 发送 Control + A，但是如何发送一个序列来保持控制并在按下下一个字母之前释放该字母。

注意：我正在寻找的序列类似于用于注释一行 Control + K + C 的默认 Visual Studio 快捷方式

这可能是我只需要使用 WinApi 的东西吗？

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2012-06-05T18:18:18.793

根据我从[SendKeys.Send 文档](http://msdn.microsoft.com/en-us/library/system.windows.forms.sendkeys.send.aspx)中了解到的情况，它将是：

```
SendKeys.Send("^(KC)") 
```

可以在备注中找到以下内容：

> 要指定在按下其他几个键的同时按住 SHIFT、CTRL 和 ALT 的任意组合，请将这些键的代码括在括号中。例如，要指定在按下 E 和 C 时按住 SHIFT，请使用“+(EC)”。要指定在按 E 时按住 SHIFT，然后按 C 而不按 SHIFT，请使用“+EC”。

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2012-06-05T18:15:18.087

[`keybd_event`](http://msdn.microsoft.com/en-us/library/windows/desktop/ms646304(v=vs.85).aspx)为此非常方便（比“替换”更容易使用`SendInput`）。

```
keybd_event(Keys.Control, MapVirtualKey(Keys.Control, 0), 0, 0);
keybd_event(Keys.A, MapVirtualKey(Keys.A, 0), 0, 0);
keybd_event(Keys.A, MapVirtualKey(Keys.A, 0), KEYEVENTF_KEYUP, 0);
keybd_event(Keys.B, MapVirtualKey(Keys.B, 0), 0, 0);
keybd_event(Keys.B, MapVirtualKey(Keys.B, 0), KEYEVENTF_KEYUP, 0);
keybd_event(Keys.Control, MapVirtualKey(Keys.Control, 0), KEYEVENTF_KEYUP, 0); 
```

如果您只需要按住 control、alt 和/或 shift，请查看[TCS 的答案`SendKeys.Send`](https://stackoverflow.com/a/10902636/103167)。 `keybd_event`更强大，可以让你按住任何键，并以任何顺序释放。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-06-05T18:12:52.220

只是使用怎么样

```
Keyboard.SendKeys(control, "A",ModifierKeys.Control); 
Keyboard.SendKeys(control, "B",ModifierKeys.Control); 
```

?

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2017-03-24T10:40:06.423

这对我有用：

```
Keyboard.SendKeys("^(AB)"); 
```

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2015-09-30T12:28:55.727

只需使用如下代码：

```
Keyboard.SendKeys("^AB"); 
```

# java - 使用 ProGuard 混淆后如何保留 jar 依赖项

> ID：10902538
> 
> 赞同：1
> 
> 时间：2012-06-05T18:09:38.543
> 
> 标签：java, jar, obfuscation, proguard

我有一个 jar 文件的集合，这些文件的依赖项呈菱形：

> base.jar
>          /\
> dep1.jar dep2.jar
>          \
>          /dep3.jar

我想用 ProGuard 混淆它们以保留它们的依赖关系，例如，base.jar 和 dep2.jar 的混淆版本可以单独执行，而没有 dep1.jar 和 dep3.jar 的混淆版本（就像他们可以，没有混淆）。*在它们所依赖的 jar 中，分布在具有相同包名称的 jar 中的类，以及调用我想要混淆*的方法（在各种类中）的依赖 jar 中的方法。

当我尝试一次混淆所有 jar 时，ProGuard 不会“理解”它们的依赖关系；并从 base.jar 中的类中获取静态方法，并将其移动到 dep1.jar 中的混淆类中。如果 dep1.jar 不在类路径中，则 dep2.jar 的混淆版本中“预期”base.jar 中的该方法的代码在运行时会失败。

**如何确保保留混淆 jar 中的依赖项？**

该文档建议使用[增量混淆](http://proguard.sourceforge.net/manual/examples.html#incremental)，但`-applymapping`它似乎需要的开关只能接受*一个*参数，告诉依赖方法在调用*它们所依赖的 jar 时*使用的混淆名称，这些名称首先被混淆。dep1.jar 的混淆可以产生一个这样的映射文件参数，而 dep2.jar 的混淆可以产生另一个，但是 dep3.jar 的混淆在它的参数中需要*这两个*映射文件（加上 base.jar？）`-applymapping`。dep1.jar 和 dep2.jar 不能一起混淆（*或者它们可以混淆吗？*），但是，以生成单个映射文件，因为代码可能会从一个重新定位到另一个。**我必须自己合并映射文件吗？**

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-06-05T19:36:49.077

我们已经使用 ProGuard 两三年了，`-repackageclasses`在我们的配置中没有标记，我们的 .jar 文件被混淆了并且仍然正常运行。任何在我们的 .jar 文件中四处寻找的人都可以看到我们的命名空间是 com.[company] ，这是标志可以隐藏的东西，但我们认为这并不是什么大问题。没有它你应该没问题。

`-repackageclasses`（顺便说一句，我想知道您的类名是否在生效之前被混淆了，并且某处存在名称冲突？我们曾经遇到过类似的问题。）

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-06-07T09:37:50.097

最简单（尽管不是最佳）的解决方案是一次处理它们，而不进行优化（-dontoptimize）。

# php - 将图像文件上传到同一文件夹

> ID：10902539
> 
> 赞同：0
> 
> 时间：2012-06-05T18:09:38.647
> 
> 标签：php

我有一个 PHP 脚本文件：

```
<?php
    $error = "";
    $msg = "";
    $fileElementName = 'fileToUpload';
    if(!empty($_FILES[$fileElementName]['error']))
    {
        switch($_FILES[$fileElementName]['error'])
        {

            case '1':
                $error = 'The uploaded file exceeds the upload_max_filesize directive in php.ini';
                break;
            case '2':
                $error = 'The uploaded file exceeds the MAX_FILE_SIZE directive that was specified in the HTML form';
                break;
            case '3':
                $error = 'The uploaded file was only partially uploaded';
                break;
            case '4':
                $error = 'No file was uploaded.';
                break;

            case '6':
                $error = 'Missing a temporary folder';
                break;
            case '7':
                $error = 'Failed to write file to disk';
                break;
            case '8':
                $error = 'File upload stopped by extension';
                break;
            case '999':
            default:
                $error = 'No error code avaiable';
        }
    }elseif(empty($_FILES['fileToUpload']['tmp_name']) || $_FILES['fileToUpload']['tmp_name'] == 'none')
    {
        $error = 'No file was uploaded..';
    }else 
    {
            $msg .= " File Name: " . $_FILES['fileToUpload']['name'] . ", ";
            $msg .= " File Size: " . @filesize($_FILES['fileToUpload']['tmp_name']);
            //for security reason, we force to remove all uploaded file
            @unlink($_FILES['fileToUpload']);       
    }       
    echo "{";
    echo                "error: '" . $error . "',\n";
    echo                "msg: '" . $msg . "'\n";
    echo "}";
?> 
```

使用该脚本文件不确定其上传图像文件的位置，我想更改此脚本，以便它将图像上传到此 doajaxfileupload.php 文件所在的同一目录。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-06-05T18:26:45.173

您没有保存上传的文件，将 $target_path 更改为您想要的文件夹

```
{
        $target_path = "uploads/";
        $target_path = $target_path . basename( $_FILES['fileToUpload']['name']); 
        move_uploaded_file($_FILES['fileToUpload']['tmp_name'], $target_path

        $msg .= " File Name: " . $_FILES['fileToUpload']['name'] . ", ";
        $msg .= " File Size: " . @filesize($_FILES['fileToUpload']['tmp_name']);
        //for security reason, we force to remove all uploaded file
        @unlink($_FILES['fileToUpload']);       
} 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-06-05T18:12:08.600

看这里： [http ://de2.php.net/manual/de/function.move-uploaded-file.php](http://de2.php.net/manual/de/function.move-uploaded-file.php)

```
<?php
    if (move_uploaded_file[$fileElementName]['tmp_name'], "./" . $fileElementName)) {
       echo "Done!";
    } else {
       echo "Fail";
       //Handle fail
       die(); //Stop
    }
?> 
```

# php - 在 PHP 中内联的单元测试 Javascript 代码

> ID：10902544
> 
> 赞同：5
> 
> 时间：2012-06-05T18:10:06.947
> 
> 标签：php, javascript, unit-testing

在工作中，我的任务是对我们的 Javascript 代码进行单元测试。我选择了 Jasmine 单元测试框架并开始学习如何使用它，当我得知我们现在在 PHP 中内联我们的 Javascript 代码并且甚至不再使用 Javascript 文件时。

茉莉花可以解决这个问题吗？还有其他框架可以吗？我应该使用 PHP 单元测试和 Javascript 单元测试吗？我最好的方法是什么？

来自一个相当基本的页面的一些示例代码给你一个想法：

[http://pastebin.com/K3YP33id](http://pastebin.com/K3YP33id)

[http://pastebin.com/QaR8zUh1](http://pastebin.com/QaR8zUh1) <---提交

任何形式的洞察力将不胜感激

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-08-21T19:32:43.327

最佳实践是将所有 PHP 从 javascript 中拆分出来，并分别进行单元测试。从长远来看，维护和测试高度集成的代码将成为一场噩梦。尽可能地尝试模块化。

例如，我会这样做：

```
var exampleVariables = {
    'name' = <?=$name?>,
    'occupation' = <?=$occupation?>
};

unitTestableFunction(exampleVariables); 
```

# tcl - 打印范围内的所有素数

> ID：10902546
> 
> 赞同：-4
> 
> 时间：2012-06-05T18:10:21.220
> 
> 标签：tcl

如何打印给定范围内的所有素数？这是我尝试过的代码，但它没有给出正确的输出：

```
for {set x 2} {$x<100} {incr x} {

    for {set i 2} {$i<$x} {incr i} {

        set y [expr $x % $i]
        set flag 0
        if {$y == 0}  {
            puts "$x:not a prime no"
            incr flag
            break   
        }
    }

    if {$flag ==1} {
        puts "$x: prime no"
    }
} 
```

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-06-06T08:34:41.003

寻找素数在外面已经得到了很好的解释[[1]](http://rosettacode.org/wiki/Primality_by_trial_division#Tcl) [[2]](http://rosettacode.org/wiki/Sieve_of_Eratosthenes#Tcl)，所以我将更多地解释一下你应该如何*思考*以找出解决方案。像这样，我希望你以后能够更好地自己回答这些问题。

首先，这里有两个问题。一个问题是如何发现一个特定的数字是否是素数，另一个问题是如何找到给定范围内的所有素数。这两者确实是联系在一起的：我们可以用一个解决方案来解决另一个问题。让我们从这样做开始。（这是*伪代码*，不是 Tcl！）

```
# Start at 2; 1 is defined to be a non-prime
for every i in 2 up to 100
    if (isPrime i)
        print i, " is prime"
    else
        print i, " is not prime"
    end if
end for 
```

接下来，我们需要一种机制`isPrime`。它最好写成命名子程序（Tcl 中的一个过程）。我们将在这里使用最简单的技术，通过头脑简单的试验师进行素性测试。

```
function isPrime (integer x) : boolean
    # Note, when x is 2, this loop does *zero* steps
    for every i in 2 up to x-1
        if (x mod i = 0)
            # Early exit from function; we know the answer to do more work!
            return false
        end if
    end for
    return true
end function 
```

这效率不高（您可以更早地停止，您可以保留已经找到的较小素数的缓存，并且仅检查这些素数等），但它会起作用。现在您需要做的就是将上面的内容转换为 Tcl。有一个非常直接的一对一转换策略。

但*重要的部分*是将整体挑战分解成更简单的部分，你可以用一种简单到不会出错的方式来解决这些问题。

* * *

^(旁注：您还应该在 Tcl 中支持您的表达式！不这样做*有时*在高级编程中很有用，但它几乎总是只是一个等待发生的错误。它的好处是允许内置编译器将表达式转换为快速代码。)

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-06-06T16:21:53.690

Donal 已经给出了最好的答案，但只是为了让您知道您的代码中有一些小错误。我已经为你整理好了。

```
for {set x 2} {$x<100} {incr x} {
    set flag 1
    for {set i 2} {$i<$x} {incr i} {
        set y [expr $x % $i]
        if {$y == 0}  {
            puts "$x: not a prime no"
            set flag 0
            break   
        }
    }

    if {$flag ==1} {
        puts "$x: prime no"
    }
} 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2015-07-03T15:16:17.340

此代码完美运行。它显示给定范围内的所有素数，还显示该给定范围内存在多少素数。

```
puts "enter your range"
gets stdin x
set z $x
set i 1
set j 0 
while {$i<$z} {
set n [expr $x-1]
set temp 0
while {$n>=2} {
if {[expr $x%$n]==0} {
  set temp 1
  break
  }
  incr n -1
 }
if {$temp==0} {
puts "$x is a prime no"
incr j 1
} 
incr i 1
incr x -1
}
puts "total number of prime no  is $j" 
```

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2020-03-11T11:01:42.510

```
for {set x 1} {$x<100} {incr x} {
    set flag 0
    for {set i 1} {$i<=$x} {incr i} {
        set y [expr $x % $i]
        if {$y == 0}  {
            incr flag
        }
    }

    if {$flag ==2} {
        puts "$x: prime no"
    }
} 
```

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2016-08-26T12:13:38.493

```
for {set x 2} {$x < 100} {incr x} {
    for {set i 2} {$i <= $x} {incr i} {
        set y [expr $x % $i]
        if {$y == 0} {
            if {$i == $x} {
                append prime "$x "
                break;
            } else {
                append notprime "$x "
                break;
            }
        }
    }
}

puts "\nprime : $prime\n"
puts "not prime : $notprime\n"

Output:
-----------

prime : 2 3 5 7 11 13 17 19 23 29 31 37 41 43 47 53 59 61 67 71 73 79 83 89 97 

not prime : 4 6 8 9 10 12 14 15 16 18 20 21 22 24 25 26 27 28 30 32 33 34 35 36 38 39 40 42 44 45 46 48 49 50 51 52 54 55 56 57 58 60 62 63 64 65 66 68 69 70 72 74 75 76 77 78 80 81 82 84 85 86 87 88 90 91 92 93 94 95 96 98 99 
```

* * *

## 回答 #6

> 赞同：-1
> 
> 时间：2014-06-24T08:29:01.820

此代码将为您提供输入的单个数字是否为素数。您可以从 1.. 提供输入并在一些代码上方执行，但我没有得到正确的输出

```
puts "Enter n value : "
gets stdin n
set i 1
set count 0
while {$i <= $n} {
set y [expr $n % $i]
if {$y == 0} {
incr count
incr i
} else {
incr i
}
}
if {$count == 2} {
puts "Given number is prime"
} else {
puts "Given number is not a prime"
} 
```

# git - 使用 git + post-receive 挂钩管理网站：推送更改时出错

> ID：10902551
> 
> 赞同：2
> 
> 时间：2012-06-05T18:10:33.977
> 
> 标签：git, web, push

问题：如果该工作树不是裸露的，我如何将本地提交推送到我的开发服务器？

我的情况：

1.  我在我的开发服务器上设置了 git，这样当我推送本地更改时，它们会被添加到一个分离的工作树中（如此[处所述](http://toroid.org/ams/git-website-howto)，很像[这篇文章](https://stackoverflow.com/questions/3838727/git-post-receive-hook-for-website-staging)）。
2.  然后我在开发服务器上运行 git 时遇到了问题（例如，`git status`），因为 git 找不到工作树。
3.  我询问了 SO 并[得到了](https://stackoverflow.com/questions/10821825/how-to-set-git-dir-git-work-tree-when-maintaining-multiple-repositories)我需要`bare = false`在我的配置文件中设置并指定工作树的提示。甜的。

但是现在当我尝试将我的提交推送到开发服务器时，我收到了这个错误：

```
$ git push origin master
xxxx@xxx.xxx.xxx.xxx's password:
Counting objects: 26, done.
Delta compression using up to 4 threads.
Compressing objects: 100% (18/18), done.
Writing objects: 100% (18/18), 2.56 KiB, done.
Total 18 (delta 8), reused 0 (delta 0)

remote: error: refusing to update checked out branch: refs/heads/master
remote: error: By default, updating the current branch in a non-bare repository
remote: error: is denied, because it will make the index and work tree inconsistent
remote: error: with what you pushed, and will require 'git reset --hard' to match
remote: error: the work tree to HEAD.
remote: error:
remote: error: You can set 'receive.denyCurrentBranch' configuration variable to
remote: error: 'ignore' or 'warn' in the remote repository to allow pushing into
remote: error: its current branch; however, this is not recommended unless you
remote: error: arranged to update its work tree to match what you pushed in some
remote: error: other way.
remote: error:
remote: error: To squelch this message and still keep the default behaviour, set
remote: error: 'receive.denyCurrentBranch' configuration variable to 'refuse'.

To ssh://xxxx@xxx.xxx.xxx.xxx/xxx/xxx/xxxxxx.git
 ! [remote rejected] master -> master (branch is currently checked out)
error: failed to push some refs to 'ssh://xxxx@xxx.xxx.xxx.xxx/xxx/xxx/xxxxxx.git' 
```

我看到[这个其他用户有同样的问题](https://stackoverflow.com/questions/2816369/git-push-error-remote-rejected-master-master-branch-is-currently-checked)。不幸的是，对他有用的解决方案是`bare = true`在他的配置中设置，这将重现我在上面第 3 步中遇到的问题。

错误消息说

> 您可以将“receive.denyCurrentBranch”配置变量设置为远程：错误：“忽略”或“警告”

就我而言，我可以这样做吗？这对我来说听起来不错，但我对 git 还不够熟悉，还没有意识到当它出现时是个坏主意......

**编辑**

为了清楚起见，我已经添加了一个 post-receive 钩子，它工作顺利。问题是我似乎必须在`bare=true`（并且能够推送到开发服务器）和`bare=false`（并且能够在开发服务器上运行 git 命令）之间进行选择。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-06-05T18:54:58.030

为什么不：

*   将您的提交推送到一个裸仓库
*   在该开发存储库上设置一个接收后挂钩，然后将其转到非裸开发存储库并检查正确的分支，从裸存储库中提取新提交？

这就是[您的链接](http://toroid.org/ams/git-website-howto)所描述的（使用分离的工作树），但它在一个裸仓库中设置了钩子：

```
$ mkdir /var/www/www.example.org
$ cat > hooks/post-receive
#!/bin/sh
GIT_WORK_TREE=/var/www/www.example.org git checkout -f
$ chmod +x hooks/post-receive 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-06-05T19:10:21.700

使用存储库不是您想要做的。您需要在您的开发服务器上的裸存储库中有一个接收后挂钩，该挂钩对您的 Web 服务器的目录执行 git checkout-index。这样，它只是文件。您不必担心它是否是一个裸存储库、是否有工作树或其他任何与 git 相关的东西。

类似的东西`git checkout-index -f -a --prefix=/var/www/htdocs/mywebsite/`（注意斜杠 - 这很重要）

-f 标志将强制覆盖任何现有文件，而 -a 标志将包括所有文件。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-06-25T17:31:47.330

你只需要小心你正在尝试做的事情。

`git status`用于告诉您工作树的状态。这在您的情况下应该没有用。

另一方面，`git push`在裸存储库上完全有效。这应该适合你。

如果您想查看更改，可以使用 git diff。您只需要指定两个哈希`git diff $oldref $newref`

如果要列出在特定提交中更改的文件，请使用`git show --pretty="format:" --name-only $newref`.

如果要列出文件的内容，请使用`git show $newref -- $filepath`

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2012-07-13T14:26:35.590

我已经制定了一个可以接受但不太理想的解决方案。基本上，当我需要将开发更改推送到我的实时服务器时，我只是通过编辑我的配置文件来规避这个问题。

允许开发人员将本地更改推送到 dev 的配置文件：

```
[core]
        repositoryformatversion = 0
        filemode = true
        bare = true 
```

将开发更改推送到实时时的配置文件：

```
[core]
        repositoryformatversion = 0
        filemode = true
        bare = false
        worktree = /var/www/example.com/httpd/ 
```

**优点**

1.  作品
2.  一旦我将配置文件更改为推送，repo 将被“锁定”，其他开发人员无法推送更改
3.  这不是一个大问题，因为无论如何我都必须登录到 dev 来处理数据库迁移

**缺点**：基本上，如果我知道如何正确地完成它，我确信它可以自动化。

注意：我喜欢@vonC 的建议，即设置接收后挂钩以有条件地推送到实时服务器。对接收后挂钩进行更改很简单，但我不明白挂钩会响应什么触发器。不过我很想听听建议:)

# mysql - 如何使用 Rails 工具构建 SQL 'OR' 查询？

> ID：10902553
> 
> 赞同：1
> 
> 时间：2012-06-05T18:10:49.443
> 
> 标签：mysql, sql, ruby-on-rails, ruby, ruby-on-rails-3

我正在使用 Ruby on Rails 3.2.2，并且鉴于我已经说明了该问题涉及的所有需要​​的类/模型，我想构建以下 SQL 查询语句（注意 SQL `OR`）“a là Ruby on Rails 方式”：

```
SELECT customers.* FROM customers WHERE (firstname = 'James' OR firstname = 'Paula') AND lastname = 'Brown' 
```

是否可以使用 Rails 设施？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-06-05T18:23:54.037

如果您不想使用像[squeel](http://railscasts.com/episodes/354-squeel)这样的任何外部 gem，一个很好的方法是为此目的构建一个范围：

```
scope :by_first_and_last_name, ->(firsts, last) { 
   where(['firstname in (?) AND lastname = ?', firsts, last])
} 
```

由于它返回一个 Arel，因此您可以将其与其他范围正常链接。

你可以像这样使用它：

```
YourModel.by_first_and_last_name(['Foo','Bar'], 'Baz').first 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-06-05T18:41:30.727

`OR`以下代码将允许您与firstname 字段上的多个 s 具有相同的效果：

```
Customer.where(['firstname IN (?) AND lastname = ?', ['James', 'Paula'], 'Brown']) 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-06-05T19:50:19.047

您并不是真的在寻找 OR。相反，您正在寻找一个 IN。

```
SELECT customers.* FROM customers WHERE firstname IN ('James','Paula') AND lastname = 'Brown' 
```

这在 Rails 中已经得到了很长时间的支持（可能是从一开始）。您可以在查找结果中指定一个值数组而不是单个值。

```
@firstnames = ['James','Paula']
@lastname = 'Brown'
@customers = Customer.find_all_by_firstname_and_lastname(@firstnames,@lastname) 
```

# jquery - JQuery Active Refresh 在服务器端重定向后不起作用

> ID：10902560
> 
> 赞同：0
> 
> 时间：2012-06-05T18:11:09.553
> 
> 标签：jquery, playframework

我有一个页面每 5 秒主动刷新一次。但是，当我从页面中单击一个按钮时，该按钮在服务器端重定向到自身，然后它不会刷新。我能做些什么？

jQuery代码；

```
<script type="text/javascript" charset="${_response_encoding}">

// Reload the whole messages panel
var refresh = function() {

    $('#thread').load('@{room()} #thread', function() {
        $('#thread').trigger('create');
    });

}

var create = function(){
     $('#thread').trigger('create');
}

// Call refresh every 5 seconds
$(document).ready(setInterval(refresh, 5000));

</script> 
```

服务器端代码；

```
public static void served(Long servingID) {
    Serving serv = Serving.findById(servingID);
    serv.isServed = true;
    serv.save();

    index();
} 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-12-04T23:02:34.033

答案在常见问题解答中，我们必须在加载数据后重新绑定事件。 [http://docs.jquery.com/FAQ#Using_event_rebinding](http://docs.jquery.com/FAQ#Using_event_rebinding)

# ruby-on-rails - Rails 错误不适用于控制器？那么如何处理错误呢？

> ID：10902561
> 
> 赞同：1
> 
> 时间：2012-06-05T18:11:23.110
> 
> 标签：ruby-on-rails, ruby-on-rails-3

我有以下操作来确认 PIN 码。

```
def create
  @confirm = User.where(:email => params[:user][:email]).last
  errors[:base] << "Subscription not found" if @confirm.nil?
  respond_with(@confirm)
end 
```

如果对象不存在，我会收到以下错误

```
NameError in ConfirmsController#create

undefined local variable or method `errors' for #<ConfirmsController:0x007f921de173d0> 
```

为什么它不能识别错误，我该如何处理这种情况下的错误？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-06-05T18:19:19.320

使用它们时的错误通常出现在 ActiveRecord 模型上。如果要显示错误消息，请尝试使用 flash 方法。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-06-05T19:13:52.463

```
@confirm.errors[:base] << ... 
```

应该做的伎俩

# php - 大数据记录的分页

> ID：10902562
> 
> 赞同：0
> 
> 时间：2012-06-05T18:11:29.270
> 
> 标签：php, database, memcached, sphinx

需要帮助或建议对大量记录进行分页。

我有 400,000 条记录，每次分页时都会进行分页，并根据限制集获取设置记录。

在 6 万条记录会话值未存储后，我们尝试将所有记录添加到会话中（这不是好的选择）。

需要知道任何其他方法可以帮助对大量数据记录进行分页。

我可以为此使用 sphinx/memcache 吗？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-06-05T18:29:50.810

那么问题是什么？数据库查询应该是命中数据库。有性能问题吗？可以通过适当的索引进行补救。即使您限制为 10-20 个结果，400k 也不是一个庞大的数据集。

`EXPLAIN`将帮助您查看您的 sql 服务器在做什么。

如果分页正在刷新页面，您可能希望实现 AJAX 以获得更流畅的用户体验。

您可以同时使用 sphinx 或 memcached。Memcached 可能更容易实现，因为您可以在访问数据库之前先搜索缓存。我认为一些查询/数据库调整可以走很长的路。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-06-05T18:21:23.477

您可以使用 AJAX 检索记录，例如一次 100 条记录

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-06-05T18:23:29.067

您可以使用 memcache 在内存中执行此操作，这可行，但可能会占用大量内存。

如果您的数据集有一个递增的键，使用时间或主键 auto_increment 字段，您可以执行如下所示的查询。

```
SELECT fieldlists FROM tablename WHERE key > $lastusedkey limit $limit 
```

这将解决限制在执行分页的应用程序中可能导致的瓶颈，并且不需要您将整个数据库放入内存中。

# wpf - XAML - 设置样式后文本未显示在我的文本框中

> ID：10902565
> 
> 赞同：2
> 
> 时间：2012-06-05T18:11:56.403
> 
> 标签：wpf, xaml, text, styles

因此，我在我正在开发的应用程序中设置了我的 TextBoxes 的样式，突然之间我看不到任何绑定到我的 TextBoxes 的文本。我觉得我缺少某种 ContentPresenter。无论如何，这是样式。

```
<Style TargetType="{x:Type TextBox}">
    <Setter Property="Height" Value="26"/>
    <Setter Property="Template">
        <Setter.Value>
            <ControlTemplate TargetType="TextBox">
                <Border BorderThickness="{TemplateBinding BorderThickness}"
                        BorderBrush="{TemplateBinding BorderBrush}"
                        Background="{TemplateBinding Background}">
                </Border>
                <ControlTemplate.Triggers>
                    <Trigger Property="IsEnabled" Value="False">
                        <Setter Value="#FF2F2F2F" Property="Background"/>
                        <Setter Value="White" Property="Foreground"/>
                    </Trigger>
                </ControlTemplate.Triggers>
            </ControlTemplate>
        </Setter.Value>
    </Setter>
</Style> 
```

这是我的文本框的设置方式

```
<TextBox Grid.Row="2" Grid.Column="5" BorderThickness="1" Text="{Binding VariableName}"> 
```

有什么想法吗？

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2012-06-05T18:18:38.463

你的预感是对的，你需要有一个模板部分，[`PART_ContentHost`里面`ControlTemplate`](http://msdn.microsoft.com/en-us/library/ms752068.aspx)有一个名称：

```
<ControlTemplate TargetType="TextBox">
    <Border BorderThickness="{TemplateBinding BorderThickness}"
                    BorderBrush="{TemplateBinding BorderBrush}"
                    Background="{TemplateBinding Background}">
        <ScrollViewer Margin="0"
                    x:Name="PART_ContentHost" />
    <!-- ... --> 
```

这是因为`ControlTemplate`for a`TextBox`需要名称为 的部分`PART_ContentHost`。您可以查看[`ControlTemplate`内置控件的示例，](http://msdn.microsoft.com/en-us/library/aa970773)以了解需要哪些命名模板部件以及每个部件必须能够执行哪些操作才能保留正常功能。

# mono - MonoTouch：允许命名空间

> ID：10902567
> 
> 赞同：2
> 
> 时间：2012-06-05T18:12:00.747
> 
> 标签：mono, xamarin.ios, xamarin.android

我们正在为一个 C# 项目编写规范，该项目将由 a`MonoTouch`和`MonoDroid`UI 使用。程序员对 Mono 知之甚少，`Visual Studio only`因此我们需要让他们知道 .NET 命名空间是什么`off limits`。

在这种情况下有什么指导方针？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-06-05T18:28:42.290

我不认为有一个*完美*的解决方案，但有些事情你可以尝试使它更容易，例如

*   创建一个 Silverlight 4 项目，不要使用`System.Windows.[Web].dll`;

*   创建 Portable Project Library (v1) 项目并避免使用 MEF (System.Composition)；

*   使用一个（有几个）像这样的 Visual Studio[插件](https://github.com/jamiebriant/VsMono)。

这应该可以解决大部分问题。不时使用 MonoTouch 进​​行重建将确保您找到少数丢失的案例。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-06-08T15:46:56.300

对于特定列表，根据您使用的 Mono 版本，这里是关于哪些可以/不能使用的更新。

[http://www.go-mono.com/status/](http://www.go-mono.com/status/)

# c# - 在 HTML Helper 中检索 [Display] 属性名称

> ID：10902571
> 
> 赞同：1
> 
> 时间：2012-06-05T18:12:16.917
> 
> 标签：c#, asp.net-mvc

我们有一个带有以下签名的自定义 HTML 助手。

```
public static MvcHtmlString TextBoxFor<TModel,
    TProperty>(this HtmlHelper<TModel> helper,
    Expression<Func<TModel, TProperty>> property)
{
    var htmlAttributes = new Dictionary<string, object>();

    // ....

    return helper.TextBoxFor(property, htmlAttributes);
} 
```

我想在`placeholder`这里实现属性，应该设置为这个控件的标签。标签可以是字符串常量，也可以是为属性的`[Display]`属性指定的字符串。

我有什么方法可以从这个辅助函数中获取这个标签吗？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-06-05T18:47:14.540

这似乎有效：

```
ModelMetadata metadata = ModelMetadata.FromLambdaExpression(property, helper.ViewData);
string htmlFieldName = ExpressionHelper.GetExpressionText(property);
string labelText = metadata.DisplayName ?? metadata.PropertyName ?? htmlFieldName.Split('.').Last();
if (!String.IsNullOrWhiteSpace(labelText))
    // labelText contains the label 
```

# c++ - 指向同类型的对象

> ID：10902574
> 
> 赞同：2
> 
> 时间：2012-06-05T18:12:51.353
> 
> 标签：c++, visual-c++, pointers, nested-class

我觉得这个问题可能有点琐碎，但我根本无法理解它。我目前有一个类 Node，它试图使用指针 prevNode 指向当前节点之前出现的节点。但是我似乎无法访问 prevNode 中的任何变量。

从以下代码运行 Main.cpp 时，它会打印结果“15340756”。我哪里错了？Appologies 因为我对 C++ 还是有点陌生​​。

节点.h

```
#include "stdafx.h"

class Node
{
public:
    Node();
    void setPrevNode(Node n);
    Node getPrevNode();
    int i;
private:
    Node *prevNode;
}; 
```

节点.cpp

```
#include "stdafx.h"
#include "Node.h"

Node::Node(){
    i = 0;
}

void Node::setPrevNode(Node n){
    prevNode = &n;
}

Node Node::getPrevNode(){
    return *prevNode;
} 
```

主文件

```
#include "stdafx.h"
#include "Node.h"

int _tmain(int argc, _TCHAR* argv[])
{
    Node nodes[] = {Node(), Node()};

    nodes[0].i = 1;
    nodes[1].setPrevNode(nodes[0]);
    printf("%i", nodes[1].getPrevNode().i); 
    while(true){

    }
    return 0;
} 
```

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2012-06-05T18:14:42.467

```
void setPrevNode(Node n); 
```

这里`setPrevNode`声明获取作为参数传递的节点的**副本**，并指向该节点。函数返回后，指向的节点不再存在，你得到的是未定义的行为。

您想要的是将`Node`其作为参考或指针：

```
void setPrevNode(Node& n)
{
    prevNode = &n;
}

void setPrevNode(Node* n)
{
    prevNode = n;
} 
```

在同一行，`getPrevNode`定义为返回前一个节点的**副本**。你当然想在这里返回一个引用，虽然你也可以返回一个指针：

```
Node& getPrevNode()
{
    return *prevNode;
}

Node* getPrevNode()
{
    return prevNode;
} 
```

# javascript - javascript通过insertBefore迭代数组

> ID：10902576
> 
> 赞同：1
> 
> 时间：2012-06-05T18:13:07.830
> 
> 标签：javascript

我正在尝试使我的代码更具可重用性。

目前我正在使用：

```
var top_element = document.getElementById('main');

document.body.insertBefore(lightbox_overlay, top_element);
document.body.insertBefore(lightbox_border, lightbox_overlay);
document.body.insertBefore(lightbox_content, lightbox_border); 
```

我想使用一个数组并遍历这些项目来做到这一点，但是：

```
var lightbox_elements = [];

lightbox_elements.push(lightbox_overlay, lightbox_border, lightbox_content); 
```

任何想法下一步是什么？必须是纯 JS ..

谢谢 ：）

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-06-05T18:22:02.010

我可能会在你的数组上使用`documentFragment`and 。`forEach`

```
var frag = document.createDocumentFragment();

[ lightbox_overlay,
  lightbox_border,
  lightbox_content ].forEach(function(el) { frag.appendChild(el); });

document.body.insertBefore(frag, top_element); 
```

* * *

您可以使用 MDN 提供的补丁来填充旧浏览器。

*   [`.forEach()`来自 MDN 的补丁](https://developer.mozilla.org/en/JavaScript/Reference/Global_Objects/Array/forEach#Compatibility)

* * *

这是另一个使用的解决方案`.reduce()`。

```
[ lightbox_overlay,
  lightbox_border,
  lightbox_content ].reduce(function(prev, curr) { 
                               return document.body.insertBefore(curr, prev); 
                            }, top_element); 
```

由于`prev`始终是最后一个返回值*（或第一次迭代的种子值）*，并且由于`insertBefore`返回`curr`插入的项目，因此对于每次迭代，`prev`始终是最后一个`curr`。

*   [`.reduce()`来自 MDN 的补丁](https://developer.mozilla.org/en/JavaScript/Reference/Global_Objects/Array/reduce#Compatibility)

# objective-c - NSIntegers 的 NSArray 类别的快速枚举

> ID：10902577
> 
> 赞同：7
> 
> 时间：2012-06-05T18:13:10.880
> 
> 标签：objective-c, ios

因为我经常使用 NSInteger 数组，所以我为 NSArray 编写了一个类别（也为 NSMutableArray 编写了一个类别），它添加了诸如 integerAtIndex:、arrayByAddingInteger: 等方法。这些方法负责将 NSInteger 包装/解包到 NSNumber 对象中。

我想知道是否有一种方法可以增强我的类别，以便我可以在 NSIntegers 上进行快速枚举。我希望能够写：

```
NSArray* arrayOfIntegers;
    .
    .
    .

for(NSInteger nextInteger in arrayOfIntegers)
    {
    } 
```

....so that "nextInteger" 在幕后从 NSNumber 对象中提取出来。我可以这样做吗？

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-06-05T18:28:02.427

我怀疑NSFastEnumeration是否有一种*干净*`nextObject`的方法，因为它在很大程度上取决于方法。

但是，您可以通过为它添加一个块方法来以另一种方式做到这一点：

```
@interface NSArray (Integers)
-(void)eachInteger:(void(^)(NSInteger))block;
@end

@implementation NSArray (Integers)
-(void)eachInteger:(void(^)(NSInteger))block {
  for (NSNumber *num in self) {
    block(num.integerValue);
  }
}
@end 
```

这样，您可以以类似的方式在代码中使用它：

```
NSArray *arr = [NSArray arrayWithObjects:[NSNumber numberWithInt:23],
                                         [NSNumber numberWithInt:42],
                                         nil];
...
[arr eachInteger:^(NSInteger i) {
  NSLog(@"The int is %i", i);
}];
// =>
//    The int is 23
//    The int is 42 
```

也许你可能想看看[Lumumba 框架](https://github.com/Tharabas/Lumumba/)上的[NSArray 类别](https://github.com/Tharabas/Lumumba/blob/master/src/tharabas/categories/NSArray+TH.h)，它恰好是我写的：D

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2012-06-05T18:24:44.987

这完全不能做到，但是您可以轻松地将您的 NSNumber 转换为 NSInteger 并在以后使用它。你甚至可以为它写一个宏：

```
#define int_enum(var, arr, block) \
    for(NSNumber *__tmp in arr) { NSInteger var = [__tmp integerValue]; block } 
```

像这样使用它：

```
NSArray *array = // whatever;
int_enum(counter, array, {
    // things you want to do with `counter' as an NSInteger
}); 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-06-05T18:48:30.360

如果你真的喜欢积木，试试这个：

```
@interface NSArray(blockIteration)

@property (copy, nonatomic, readonly) void (^forEachObject)(void (^block)(NSArray *, id));
@property (copy, nonatomic, readonly) void (^forEachInt)(void (^block)(NSArray *, int));
@property (copy, nonatomic, readonly) void (^forEachDouble)(void (^block)(NSArray *, double));

@end

@implementation NSArray(blockIteration)

-(void (^)(void (^)(NSArray *, id))) forEachObject
{
    return [^(void (^block)(NSArray *, id)) {
        block = [block copy];
        for (id obj in self)
        {
            block(self, obj);
        }
    } copy];
}

-(void (^)(void (^)(NSArray *, int))) forEachInt
{
    return [^(void (^block)(NSArray *, int)) {
        block = [block copy];
        for (NSNumber *num in self)
        {
            block(self, [num intValue]);
        }
    } copy];
}

-(void (^)(void (^)(NSArray *, double))) forEachDouble
{
    return [^(void (^block)(NSArray *, double)) {
        block = [block copy];
        for (NSNumber *num in self)
        {
            block(self, [num doubleValue]);
        }
    } copy];
}

@end

int main()
{
    NSArray *array = [NSArray arrayWithObjects:@"Hello", @"World", @"This", @"Is", @"A", @"Test", nil];

    array.forEachObject(^(id arr, id obj) {
        NSLog(@"%@", obj);
    });
} 
```

请注意，此实现依赖于 ARC。

# linked-server - 链接服务器中的不可见 Foxpro 视图

> ID：10902580
> 
> 赞同：1
> 
> 时间：2012-06-05T18:13:25.217
> 
> 标签：linked-server, foxpro, visual-foxpro

我们有一个仍在使用的 foxpro 应用程序。我正在为数据创建新的用户界面，作为尝试从 foxpro 迁移的第一步。我们没有 GUI 的代码——我可以在 VFP IDE 中获得表和视图。

我可以使用 Sql Server 2005 中的链接服务器或 Visual Studio 2010 中的数据集从外部访问数据。我可以看到所有 Foxpro 表，但看不到视图。

有什么方法可以查看和使用链接服务器或数据集中的视图？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-06-06T13:08:13.000

如果视图内置在数据库容器中（即本地视图），您可以通过命令窗口“打开数据库（名称）”、“修改数据库”打开数据库来查看它们，然后您可以查看视图并复制 sql 语句并在您的新应用程序中创建相同的内容。我不认为你可以直接调用视图，但我可能是错的。我已经好几年没有使用内置视图了，它主要是在其他语言中很容易使用的 SQL 选择语句。

或者在 VFP ide 中将数据库添加到项目中，然后从那里查看并获取代码。

# html - 在 chrome 中渲染渐变背景的问题？

> ID：10902586
> 
> 赞同：1
> 
> 时间：2012-06-05T18:13:51.533
> 
> 标签：html, css

```
body
{
background-image: -webkit-linear-gradient(bottom, #FFFFFF 0%, #787878 100%);
} 
```

当然，当我想要一个真正的渐变时，我会得到这种[效果。](http://i.imgur.com/wuM8h.jpg?1)有任何想法吗？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-06-05T18:25:33.527

You make this work properly, you need:

```
body, html {
  background: -webkit-linear-gradient(top, #FFFFFF 0%, #787878 100%);
  margin:0;
  height:100%; 
} 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-06-05T18:23:52.993

试试这个：http: [//jsfiddle.net/3rb2L/2/](http://jsfiddle.net/3rb2L/2/)

```
body
{
   background-image: -webkit-linear-gradient(top, #2F2727, #1a82f7); 
   background-repeat: no-repeat;
   height:200px;
} 
```

`height:200px`仅用于示例和明确的查看目的。

可以用作：http: [//jsfiddle.net/3rb2L/4/](http://jsfiddle.net/3rb2L/4/)

```
html{
  min-height:100%;
}
body
{
   background-image: -webkit-linear-gradient(top, #2F2727, #1a82f7); 
   background-repeat: no-repeat;
} 
```

# javascript - 使用什么来重构 Web 应用程序的 javascript/jQuery 以使用 require.js 和 jasmine

> ID：10902591
> 
> 赞同：4
> 
> 时间：2012-06-05T18:14:32.283
> 
> 标签：javascript, jquery, refactoring, requirejs

我希望这个问题不是太笼统，但我还没有找到任何关于如何从标准 javascript / jQuery 代码过渡到模块化 / 测试代码的好的教程。Mmy 的新任务是对我们的 wordpress 插件的 javascript 进行完全重构。我们当前的代码是标准的 jQuery 代码，全部放入一个文件中，检查 dom 元素的存在以了解我们所在的页面并附加正确的事件处理程序。我的目标只是编写更易于理解和更清晰的代码，并在此过程中引入测试。我的方法是：

*   尝试在单独的文件中模块化代码（每个页面一个文件）并使用 require.js 仅加载所需的代码。
*   用 jasmine/sinon 编写一些测试并尝试调整现有代码以使测试通过

您还有其他建议/最佳做法吗？你能分享一些关于你如何处理类似任务的例子吗？
我正在考虑引入一个 mvc 框架，但如果我能坚持使用标准的 jQuery 代码，我认为这对开发团队来说更容易，因为它不会增加复杂性

# fontforge - Fontforge Scripting 如何为字形添加连字

> ID：10902593
> 
> 赞同：8
> 
> 时间：2012-06-05T18:14:36.137
> 
> 标签：fontforge

我正在使用 Fontforge 上的脚本制作字体。一切顺利，但我有这个问题我不知道如何为选定的字形指定如果同时出现其他两个字形则显示选定的字形。我已经为此制作了 Lookuptable 和子表，但我不知道将为指定字形定义一些连字的函数。这是制作表格和子表格以将连字添加到字形的代码。

```
AddLookup("Ligatures","GSUB_ligature",9,[["rlig",[["arab",["dflt"]]]]])
AddLookupSubtable("Ligatures","Ligatureshi") 
```

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2016-02-17T19:49:48.250

您需要使用现有 Glyph 名称的元组指定连字替换。

一个人为的例子：

```
#!/usr/bin/env python3
import fontforge

# load your font, etc…

ligature_name = 'f_l'
ligature_tuple = ('f', 'l')
font.addLookup('ligatures','gsub_ligature', (),[['rlig',[['arab',['dflt']]]]])
font.addLookupSubtable('ligatures', 'ligatureshi')
glyph = font.createChar(-1, ligature_name)
glyph.addPosSub('ligatureshi', ligature_tuple) 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-01-12T07:48:45.133

添加查找和子表后，执行以下操作：

```
Select("ﬂ")
AddPosSub("LigatureSubtableName", "f l") 
```

上面的 FontForge 脚本将添加一个 fl 连字。

# java - 在junit类中有辅助方法

> ID：10902598
> 
> 赞同：5
> 
> 时间：2012-06-05T18:14:56.570
> 
> 标签：java, unit-testing, session, junit

我想对一个类进行单元测试`Class A`，但它依赖于另一个使用`user session`方法的类。我要测试的方法不涉及`user session`。我可以制作辅助方法`Class A`来复制`Class B`我需要的方法的行为吗？

我知道这不是很清楚，让我们挖掘一些代码以获得清晰的理解......

```
public void testDetails() throws Exception
{
    //Some logic that generates DetailsTOList
    saveDetailsHelper(DetailsTOList);
    int detailsSize = getDetailsSize();
    assertNotNull(detailsSize);
} 
```

现在`getDetailsSize()`从数据库中获取尺寸信息。`Class B`有这个方法，但是我不能创建一个对象`Class B`并测试这个方法，因为`Class B`从用户那里获取会话信息，我可以从 JUnit 类中设置会话信息。

我创建`saveDetailsHelper`了复制方法行为的方法，并在如上所示`Class B - saveDetails()`的方法中调用它。`testDetails()`

我的问题：

1.  我们可以有辅助方法`junit class`吗？
2.  处理这种情况的最佳方法是什么？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-06-05T18:26:20.930

JUnit 类的功能与 java 中的所有其他类一样；欢迎您使用辅助功能。唯一决定是否运行其他函数的是（取决于 junit 的版本）是否有注释指示线束将其作为测试运行。

但是，这个问题正是您应该仔细设计类的原因。如果`Class B`调用数据库获取信息，这是划分该功能的绝佳机会。您没有澄清“依赖关系”（您在扩展吗？），但如果`Class B`是 A 类的一个组件，您可以创建一个完整的存根类，它是 for 的替代品`Class B`，并专门返回硬编码（或其他编码）数据A 类测试。只要`Class B`代理的签名相同，就可以放心 A 类工作。

将这些内部类设置为测试类通常很有用，以防止工作区中的事情变得过于混乱。

```
public class testA {

  @Test
  public void testDetails {
    ClassA a = new ClassA();
    a.setDependency(new StubClassB());
    //run your test
  }

  private class StubClassB() extends ClassB {
    public boolean saveDetails() {
      //return fake information;
    }
  }
} 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-06-05T18:18:41.250

辅助方法将没有 @Testcase 注释。您将像编写任何其他代码一样编写测试代码，但仅包含用于测试的相关方法，并仅验证该测试方法的相关部分。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-06-05T18:28:25.170

您可以将辅助方法放在测试类中，省略 Testcase 注释并在需要的地方调用它（每个方法或在您的设置中，如果所有测试都需要它）。但可能更好的解决方案是使用 JMock 之类的东西来表示 B 类并返回所需的结果。

# python - 使用列表中的字符串进行切片分配

> ID：10902601
> 
> 赞同：10
> 
> 时间：2012-06-05T18:15:10.713
> 
> 标签：python, string, indexing, slice

我做了相当多的阅读，但我对我试图理解的*概念没有明确的答案。*

在 Python 中，如果我取一个列表，例如：

```
L1=['muffins', 'brownies','cookies'] 
```

然后尝试使用以下代码替换指向列表中对象的第一个指针，即“松饼”：

```
L1[0:1] = 'cake' 
```

我会得到一个列表 L1：

```
['c', 'a', 'k', 'e', 'brownies', 'cookies'] 
```

然而，如果我采用相同的列表并执行操作（现在使用字符串 cake 中的 4 个元素）：

```
L1[0:4] = ['cake'] # presumably, it's now passing the string cake within a list? (it passed into the modified list shown above) 
```

我得到了我最初想要的输出：

```
['cake', 'brownies', 'cookies'] 
```

谁能解释一下为什么会这样？我假设当我最初拿蛋糕时没有将它放在“列表”中，它会将字符串分解为单独的字符，以存储为对这些字符的引用，而不是对字符串的单个引用......

但我不完全确定。

* * *

## 回答 #1

> 赞同：15
> 
> 时间：2012-06-05T18:22:38.127

两个重要的点：

1.  切片赋值在右侧接受*一个迭代，并用迭代产生的对象替换切片的元素。*
2.  在 Python 中，字符串是可迭代的：对字符串进行迭代会产生其字符。

因此

```
L1[0:1] = 'cake' 
```

`L1`用*的单个字符*替换的第一个元素`'cake'`。

要用字符串替换第一个元素`'cake'`，只需编写：

```
L1[0] = 'cake' 
```

或者，使用切片赋值语法：

```
L1[0:1] = ['cake'] 
```

* * *

## 回答 #2

> 赞同：7
> 
> 时间：2012-06-05T18:22:30.830

如果您指定一个切片，则假定右侧是一个列表/元组（实际上，任何可迭代的 - 但要注意产生无限数量的值的生成器）。

要替换列表中的项目，请使用：

```
my_list[0] = "cake" 
```

（你也可以这样做

```
my_list[0:1] = ["cake"] 
```

如果您真的想使用列表切片。

以下是其他一些相关的参考： [slice assignment](https://stackoverflow.com/questions/10623302/how-assignment-works-with-python-list-slice) [更多 slice assignment](https://stackoverflow.com/questions/10623302/how-assignment-works-with-python-list-slice)

* * *

## 回答 #3

> 赞同：3
> 
> 时间：2012-06-05T18:56:00.997

将字符串视为存储字符的序列容器。当您尝试以这种方式进行分配时，它会将字符序列中的每个项目添加到列表中。通过首先将“蛋糕”包装在它自己的 1 元素列表中（我们称之为 L2），您将 L2 的每个元素添加到 L1 中——它不会递归地拆分最外层序列之外的序列容器。

```
L1 = ['muffins', 'brownies','cookies']
L2 = ['cake']
L1[0:1] = L2
print L1
['cake', 'brownies', 'cookies'] 
```

对于其他嵌套序列对象也是如此。尝试尝试更多嵌套的序列对象，如下所示：

```
L3 = [['pie', 'eclairs'], ['bacon', 'chocolate']]
L1[0:1] = L3
print L1
[['pie', 'eclairs'], ['bacon', 'chocolate'], 'brownies', 'cookies'] 
```

还值得注意的是，如果您不关心列表中的顺序/定位，您可以使用`append()`而不必担心您的字符串会被拆分：

```
L1 = ['muffins', 'brownies','cookies']
L1.append('cake')
print L1
['muffins', 'brownies', 'cookies', 'cake'] 
```

# jquery - “无限卷轴”之类的。让它在底部之前燃烧

> ID：10902603
> 
> 赞同：5
> 
> 时间：2012-06-05T18:15:19.403
> 
> 标签：jquery

我正在使用这个小脚本来定义用户是否滚动到底部

```
$(window).scroll(function(){

    if($(window).scrollTop() == $(document).height() - $(window).height()){
        if(!taskFired){
            taskFired = true;
            $("#loading_gif").css("display", "block");
            setTimeout(loadMoreMabs, 1500);
        }
    }

}); 
```

*但我不希望它在到达底部之前*触发函数 loadMoreMabs 。我该怎么做？我已经尝试过 + 和 - 高度，但这就像我正在尝试一些我并没有真正得到的东西。

* * *

## 回答 #1

> 赞同：8
> 
> 时间：2012-06-05T18:19:04.523

**你的问题标题表明你想要什么**

从 50 之类的值中减去一个值`$(document).height()`，开始从底部加载 50 个像素。

```
if($(window).scrollTop() <= ($(document).height() - 50) - $(window).height()){ 
```

这是 jsfiddle 中的一个小演示，我制作了一个虚拟函数来实现 loadMoreMabs 函数

[http://jsfiddle.net/sg3s/UwXaw/](http://jsfiddle.net/sg3s/UwXaw/)

每次接近底部并且 1500 毫秒到期时触发。

**现在让它（立即）只有在它到达最底部时才会触发。**

*（因为它实际上暗示了其他东西）*

[http://jsfiddle.net/sg3s/UwXaw/1/](http://jsfiddle.net/sg3s/UwXaw/1/)

诀窍可能是`>=`等式中的，确保它在 scrollTop 与文档减去窗口高度相同或更高时触发......

# actionscript-3 - 在 Flash AS 3.0 中更改嵌套影片剪辑的级别

> ID：10902604
> 
> 赞同：0
> 
> 时间：2012-06-05T18:15:23.470
> 
> 标签：actionscript-3, flash

我正在开发一个缩放方形导航项目（视觉上类似于 Windows Metro，但单击时方形会占据屏幕）。我无法将方块放到顶层（setChildIndex）。这是单击正方形时的代码：

```
function zoom(event:MouseEvent):void {
    // saves location and size of icons
    returnto = event.currentTarget;
    returntoX = event.currentTarget.x;
    returntoY = event.currentTarget.y;
    returntoWidth = event.currentTarget.width;
    returntoHeight = event.currentTarget.height;
    // turn off button behaviours
    event.currentTarget.buttonMode = false;
    event.currentTarget.alpha = 1;
    event.currentTarget.removeEventListener(MouseEvent.MOUSE_OVER, rollover);
    event.currentTarget.removeEventListener(MouseEvent.CLICK, zoom);
    event.currentTarget.removeEventListener(MouseEvent.ROLL_OUT, rollout);
    // put clicked box on top
    setChildIndex(returnto, numChildren-1);
    // fade out icon decor
    TweenLite.to(returnto.decor, .25, {alpha:0});
    // make square take over screen, call finished when done
    TweenLite.to(returnto, 1, {x:stage.x,y:stage.y, width:stage.stageWidth, height:stage.stageHeight, ease:Expo.easeInOut, onComplete:finished});
} 
```

方块都在舞台上的主影片剪辑（命名为导航）内（所以第一个方块是navigation.sq_1）

我不是 Flash 开发人员，所以我真的在为 AS3 苦苦挣扎。希望这是足以帮助某人的信息。谢谢！小号

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-06-05T18:26:37.840

只需尝试使用以下方法添加您的`returnto`剪辑`addChild()`：

```
// put clicked box on top
addChild(returnto); 
```

显示列表的默认行为`addChild()`是将子项置于所有子项之上。重新计算其他儿童指数。

# algorithm - 非常简单的递归函数复杂度分析

> ID：10902606
> 
> 赞同：0
> 
> 时间：2012-06-05T18:15:35.340
> 
> 标签：algorithm, complexity-theory, code-analysis

我需要一些帮助来理解分析递归算法。我很快就完成了这个算法，想知道复杂度是多少：

```
int FunctionExampple( A1, A2, ... An )
{
    product = 1;
    if( n == 2)
    {
        product = multi(A1, A2);
    }
    else 
    {
        product = multi(A1, FunctionExample( A2, A3, ..., An ) );
   }
   return product; 
} 
```

现在假设函数 multi 需要 O(n^1.59) 时间，那么复杂度是多少？它会保持 O(n^1.59) 还是递归调用会使其 O(n^1.59 * n ) 来考虑递归调用的数量？多谢你们。

PS：我只是快速写了这个，语法和所有这些都无关紧要。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-06-05T18:23:35.750

O(n ^(1.59) ) 中的参数“n”测量“multi”参数的大小，而不是参数的数量。因此，至关重要的是“multi”的输出大小与其输入大小的关系。例如，如果 'multi' 的结果是其任何参数大小的两倍，则调用 multi(A, multi(B, C)) 其中 A, B, C 的大小为 n 为 O(n ^(1.59) + (2n ) ^(1.59) )，然后如果您以这种方式将多个调用链接到 multi ，您将获得指数增长。另一方面，如果 'multi' 返回与其输入大小相同的值，则会得到 O(kn ^(1.59) )，其中 k 是 FunctionExample 的参数数量，n 是它们的（最大）大小。

所以这取决于'multi'的行为方式。例如，如果它是有限域内的乘法与乘法，将会有很大的不同，因为后者的结果不会从输入中增长，而对于无限整数，结果的大小会增长。

# android - 从光标获取字符串数组

> ID：10902607
> 
> 赞同：0
> 
> 时间：2012-06-05T18:15:37.867
> 
> 标签：android, sqlite

我有一个包含 45 个不同条目的 SQLite 数据库，每个条目都有：

```
public static final String TABLE = "Table";
public static final String COLUMN_ID = "_id";
public static final String COLUMN_HOUR = "hour";
public static final String COLUMN_WEEK = "week";
public static final String COLUMN_DAY = "day";
public static final String COLUMN_NAME = "name";
public static final String COLUMN_DESCRIPTION = "description";
public static final String COLUMN_COLOUR = "colour";
public static final String COLUMN_ROOM = "room"; 
```

现在我想全部读出来。我通过以下方式执行此操作：

```
public Cursor fetchAllSubject(){
    Cursor mCursor = database.query(true, TABLE, new String[] {
            COLUMN_ID, COLUMN_HOUR, COLUMN_WEEK, COLUMN_DAY, COLUMN_NAME, COLUMN_DESCRIPTION, COLUMN_COLOUR, COLUMN_ROOM},null
            , null, null, null, null, null);
    if (mCursor != null) {
        mCursor.moveToFirst();
    }
    return mCursor;
} 
```

在另一堂课中，我有这段代码要全部读出来：

```
dao = new DAO(this);
Cursor subjectList = dao.fetchAllSubject(); 
```

现在我希望每个条目都有一个 ID、Hour、week、...的数组，但我不知道该怎么做。我的第一次尝试如下：

```
ArrayList<String> mo1h = new ArrayList<String>();
subjectList.moveToFirst();
while(!subjectList.isAfterLast()) {
     mo1h.add(subjectList.getString(subjectList.getColumnIndex(dao.COLUMN_ID)));
     mo1h.add(subjectList.getString(subjectList.getColumnIndex(dao.COLUMN_HOUR)));
     mo1h.add(subjectList.getString(subjectList.getColumnIndex(dao.COLUMN_WEEK)));
     mo1h.add(subjectList.getString(subjectList.getColumnIndex(dao.COLUMN_DAY)));
     mo1h.add(subjectList.getString(subjectList.getColumnIndex(dao.COLUMN_NAME)));
     mo1h.add(subjectList.getString(subjectList.getColumnIndex(dao.COLUMN_DESCRIPTION)));
     mo1h.add(subjectList.getString(subjectList.getColumnIndex(dao.COLUMN_COLOUR)));
     mo1h.add(subjectList.getString(subjectList.getColumnIndex(dao.COLUMN_ROOM)));     
     subjectList.moveToNext();
} 
```

但是一切都在 mo1h 中，我不知道如何划分它。最好的办法是每个都有一个 String[] 。有人有想法吗？谢谢！

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-06-05T18:20:04.123

您可以在**Bean 类**上创建，然后创建一个**ArrayList**（Collection 类）

```
public class Bean
{
   public Bean();
   String id, hour, week, day, name, description, color, room;
} 
```

现在创建 Bean 列表

```
ArrayList<Bean> mo1h = new ArrayList<Bean>();
subjectList.moveToFirst();
while(!subjectList.isAfterLast()) {
Bean b = new Bean();
   b.id = subjectList.getString(subjectList.getColumnIndex(dao.COLUMN_ID));
   b.hour =subjectList.getString(subjectList.getColumnIndex(dao.COLUMN_HOUR));
   ...
   ...
   // all your column
   mo1h.add(b);
} 
```

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-06-05T18:23:48.767

为什么不继续你的策略，而是使用 String[] 的 ArrayList：

```
ArrayList<String[]> mo1h = new ArrayList<String[]>();
subjectList.moveToFirst();
while(!subjectList.isAfterLast()) {
     String[] toUse = new String[8];
     toUse[0] = subjectList.getString(subjectList.getColumnIndex(dao.COLUMN_ID));
     toUse[1] = subjectList.getString(subjectList.getColumnIndex(dao.COLUMN_HOUR));
     toUse[2] = subjectList.getString(subjectList.getColumnIndex(dao.COLUMN_WEEK));
     toUse[3] = subjectList.getString(subjectList.getColumnIndex(dao.COLUMN_DAY));
     toUse[4] = subjectList.getString(subjectList.getColumnIndex(dao.COLUMN_NAME));
     toUse[5] = subjectList.getString(subjectList.getColumnIndex(dao.COLUMN_DESCRIPTION));
     toUse[6] = subjectList.getString(subjectList.getColumnIndex(dao.COLUMN_COLOUR));
     toUse[7] = subjectList.getString(subjectList.getColumnIndex(dao.COLUMN_ROOM)); 
     mo1h.add(toUse);    
     subjectList.moveToNext();
} 
```

# sql - 相对表中的相对值表

> ID：10902608
> 
> 赞同：1
> 
> 时间：2012-06-05T18:15:44.483
> 
> 标签：sql

我很难做出这个决定。我有一个模式，我希望特定类别的产品具有该类别的特定值。

我已经进入了 5 张桌子，我只是想知道这是否是正确的做法。

场景：主表：

```
Element (id, name, category_ID)
Category (id, name)
Characteristic (id, name, unity) 
```

我希望一个类别具有特定数量的特性（即计算机需要具有 cpu、ram、屏幕大小等特性，鼠标需要具有 isCordless、numberOfButtons 等），所以我创建了表Category_has_Characteristic：

```
Category_has_Characteristic(id_category, id_characteristic) 
```

为了将特定元素值设置为类别中的每个特征，我创建了此表：

```
Element_has_Characteristic ( id_element, id_Category_has_Characteristic, value) 
```

这是创建表格以具有每个特征的特定元素值的最佳方法吗？

我错过了什么还是这是唯一/最好的方法？

任何评论将不胜感激。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-06-05T18:41:48.883

This sounds like a classic case of overnormalization. Consider a table:

```
Category
  id
  name varchar(50)
  isCordless bit
  numberOfButtons int
  ... 
```

This leads to way simpler queries. You only need a many-to-many relation if your characteristics are dynamic. For example, if you're planning to write a control panel that your users can use to add characteristics to a category.

# ruby - 将浮点数输入到 Watirs 文本字段中

> ID：10902609
> 
> 赞同：0
> 
> 时间：2012-06-05T18:15:46.340
> 
> 标签：ruby, watir

我正在尝试将数组中的数据输入网站，但是出现错误。我相信错误意味着我不能将浮点数放入文本字​​段，所以我将浮点数更改为字符串。但它又没有用。我只包含了我认为相关的代码部分。

块引用

```
eee = Watir::Browser.new 

    eee.goto(fulllink)
    eee.text_field(:name => "txtAttr").set Headings[j]
    eee.wait
    p = j + 1 
    strings = body.at(0).at(p)
    String (strings)
    eee.text_field(:name => "txtValue").set strings
    eee.wait
    eee.link(:index => 4).click 
    eee.wait
    eee.close
    end 
    i += 1 

C:\Users\Pure.itloaner1-12\Google Drive\ruby>ruby ExST.rb
hello world
Alpha Numeric Unit #
tables filled
200.0
C:/Ruby193/lib/ruby/gems/1.9.1/gems/watir-classic-3.0.0/lib/watir-classic/input_
elements.rb:356:in `characters_in': undefined method `each_char' for 200.0:Float
 (NoMethodError)
        from C:/Ruby193/lib/ruby/gems/1.9.1/gems/watir-classic-3.0.0/lib/watir-c
lassic/input_elements.rb:337:in `type_by_character'
        from C:/Ruby193/lib/ruby/gems/1.9.1/gems/watir-classic-3.0.0/lib/watir-c
lassic/input_elements.rb:299:in `set'
        from ExST.rb:92:in `<main>' 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-06-05T19:19:24.147

尝试是否更改`String(strings)`为`strings = String(strings)`有效。

# java - 听众和他们的对象

> ID：10902611
> 
> 赞同：0
> 
> 时间：2012-06-05T18:15:48.273
> 
> 标签：java, swing, awt, jtextfield, documentlistener

我有一个带有更改文本事件侦听器的 JTextField。

我可以使用这个监听器来影响它正在监听的同一个对象吗？例如，如果它检测到“有问题的”更改，它应该删除同一个 JTextField 对象中的所有文本。

这可能吗？它似乎不起作用...

一个例子如下： .

```
this.txtSearch.getDocument().addDocumentListener(new DocumentListener() {
public void changedUpdate(DocumentEvent e) {
    validate();
}

public void removeUpdate(DocumentEvent e) {
    validate();
}

public void insertUpdate(DocumentEvent e) {
    validate();
}

private void validate(){
    if not_good(txtSearch.getText()) {
        txtSearch.setText("");
    }
} 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-06-05T18:26:51.620

`JTextField`从事件中更改文本`textChanged`可能会导致（可能是无限的）`textChanged`事件循环。不要那样做。

如果您想验证输入到一个`JTextField`相当使用[`InputVerifier`](http://docs.oracle.com/javase/1.4.2/docs/api/javax/swing/InputVerifier.html).

javadoc 包含[一些如何使用它的示例，](http://docs.oracle.com/javase/1.4.2/docs/api/javax/swing/InputVerifier.html)请看一下。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-06-05T18:34:12.360

*   因为`JTextComponent`您必须使用可以访问其的正确方法`Model`

*   `Document`是`Model`为了`JTextComponent`

对于键盘输出，您有两个选择

*   对于从`JTextComponent`外部输出（到 Swing GUI 中的另一个元素），请使用`DocumentListener`

*   for `changes`//里面使用`filtering`_`modify``JTextComponent``DocumentFilter`

# shell - 如何在一行上应用两个不同的 sed 命令？

> ID：10902612
> 
> 赞同：0
> 
> 时间：2012-06-05T18:15:58.023
> 
> 标签：shell, sed

Q1：我想编辑一个包含一组电子邮件 ID 的文件，以便所有域名都变得通用。

```
Example,
peter@yahoo.com
peter@hotmail.co.in
philip@gmail.com

to
peter_yahoo@generic.com
peter_hotmail@generic.com
philip_gmail@generic.com 
```

我使用以下 sed cmd 将 @ 替换为 _

```
sed 's/@/_/' <filename> 
```

有没有办法将另一个 sed cmd 附加到上面提到的 cmd 中，以便我可以用 @generic.com 替换域名的最后一部分？

Q2：如果我的域名末尾有文字，我该如何处理？

```
Example,
peter@yahoo.com,i am peter
peter@hotmail.co.in,i am also peter

To,
peter_yahoo.com@generic.com,i am peter
peter_hotmail.co.in@generic.com,i am also peter 
```

我尝试了 @(,) 而不是 @(.*) 它不起作用，我想不出任何其他解决方案

Q3：假设我的例子是这样的，

```
peter@yahoo.com
peter@hotmail.co.in,i am peter 
```

我希望我的结果如下，

```
peter_yahoo.com@generic.com
peter_hotmail.co.in@generic.com,i am peter,i am peter 
```

如何使用单个 sed cmd 执行此操作？

以下 cmd 将导致，

```
sed -r 's!@(.*)!_\1@generic.com!' FILE

peter_yahoo.com@generic.com
peter_hotmail.co.in,i am peter,i am peter@generic.com 
```

以下 cmd 无法在“peter@yahoo.com”上运行，

```
sed -r 's!@(.*)(,.*)!_\1@generic.com!' FILE 
```

谢谢！！

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-06-05T18:36:20.917

打高尔夫球 =)

```
$ cat FILE
Example,
peter@yahoo.com
peter@hotmail.co.in
philip@gmail.com

$ sed -r 's!@(.*)!_\1@generic.com!' FILE
Example,
peter_yahoo.com@generic.com
peter_hotmail.co.in@generic.com
philip_gmail.com@generic.com 
```

回复 user1428900，这是一些解释：

```
sed -r          # sed in extended regex mode
s               # substitution
!               # my delimiter, pick up anything you want instead !part of regex
@(.*)           # a literal "@" + capture of the rest of the line
!               # middle delimiter
_\1@generic.com # an "_" + the captured group N°1 + "@generic.com"
!               # end delimiter
FILE            # file-name 
```

那里并不真正需要扩展模式，请考虑`BRE`（基本正则表达式）模式中的以下相同片段：

```
 sed 's!@\(.*\)!_\1@generic.com!' FILE 
```

**编辑**以适应您的新需求：

```
$ cat FILE
Example,
peter@yahoo.com,I am peter
peter@hotmail.co.in
philip@gmail.com

$ sed -r 's!@(.*),.*!_\1@generic.com!' FILE
Example,
peter_yahoo.com@generic.com
peter@hotmail.co.in
philip@gmail.com 
```

如果您只想要电子邮件行，您可以执行以下操作：

```
sed -r '/@/s!@(.*),.*!_\1@generic.com!' FILE 
```

该`/@/`部分意味着仅适用于包含该字符的行`@`

**编辑2**：

如果您想像新评论中所说的那样保留结尾行：

```
sed -r 's!@(.*)(,.*)!_\1@generic.com\2!' FILE 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-06-05T18:26:02.473

```
sed 's/\(.*\)@\(.*\)\..*/\1_\2@generic.com/' 
```

带有转义括号`\(.*\)`的表达式用于记住正则表达式的某些部分。“\1”是第一个记住的模式，“\2”是第二个记住的模式。

`\(.*\)`之前的表达式`@`用于记住电子邮件 ID 的开头（peter、peter、philip）。

`\(.*\)\.`后面的表达式`@`用于记住电子邮件 ID 的结尾（yahoo、hotmail、gmail）。换句话说，它说：在和之间取一些`@`东西`.`

末尾的表达式`.*`用于匹配电子邮件 ID（.com、.co.in、.co.in）中的所有尾随符号。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-06-05T18:25:34.457

You can run multiple commands with:

```
sed -e cmd -e cmd 
```

or

```
sed -e cmd;cmd 
```

So, in your case you could do:

```
sed -e 's/@/_/' -e 's/_.*/_generic.com/' filename 
```

but it seems easier to just do

```
sed 's/@.*/_generic.com/' filename 
```

# css - 如何附加 html 文件以便 gmail 的“查看”选项起作用

> ID：10902613
> 
> 赞同：10
> 
> 时间：2012-06-05T18:16:00.847
> 
> 标签：css, google-apps-script, gmail, html-email

我有一个脚本可以发送带有 html 附件的电子邮件。当我在 gmail 中选择“查看”时，我会收到文本......但是当我点击“下载”而不是“查看”时，然后打开它，它会按原样显示。

我认为它与 gmail 相关，因为我从 IE、FireFox(win/linux)、Chrome(win/linux) 观察到完全相同的行为

我在这里制作了一个 youtube 视频： [http ://www.youtube.com/watch?v=WkGyxcFQXS8](http://www.youtube.com/watch?v=WkGyxcFQXS8)

难道我做错了什么？

谢谢

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2014-07-12T16:08:04.663

并非所有电子邮件客户端都支持该`<style>`标签。Gmail就是其中之一；它只尊重内联样式。

如果您的代码正在生成 css 和 html，那么您可以将其更改为使用表格的内联样式。

如果您想要更自动的魔法，请参阅[如何使用 Google Apps 脚本将 CSS 页面更改为具有内联样式的页面？](https://stackoverflow.com/questions/18004225/how-do-i-use-google-apps-script-to-change-a-css-page-to-one-with-inline-styles/20689529#20689529).

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2012-06-05T18:43:15.390

One way around this would be to have your script simply host the HTML file somewhere, and email a link to that file.

I cannot find any documentation from Google or the GMail team, but I would be surprised if they allowed HTML attachments to be opened and viewed (this would be a security risk, since they would essentially allow their email servers to host user-generated web content).

# facebook - 更改认证推荐的redirectUri

> ID：10902617
> 
> 赞同：0
> 
> 时间：2012-06-05T18:16:12.237
> 
> 标签：facebook, authentication, oauth-2.0, referrals

我想知道是否有一种方法可以更改在 Authenticated Referral auth 上单击“取消”的操作。auth 的 url 显示了 redirectUri 参数，但似乎无法更改它。使用经过身份验证的推荐会很好，但仍允许用户试驾该应用程序。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-06-05T18:27:26.717

不，我认为没有——这是核心 FB 功能。

恕我直言，您唯一的选择是*不*使用经过身份验证的推荐，并在用户到达您的画布/页面选项卡时提示用户权限，使用 FB.login 那里 - 如果他们中止，您可以做出相应的反应。

# c# - 想得到像 Fiddler 这样的 http 响应结果

> ID：10902618
> 
> 赞同：2
> 
> 时间：2012-06-05T18:16:17.033
> 
> 标签：c#, asp.net

当我从我的应用程序启动网页时，我试图获得与 Fiddler 相同类型的结果。下面是我正在使用的代码和我得到的结果。我仅以 google.com 为例。

我需要在我的代码中修改什么以获得我想要的结果，还是我需要一种完全不同的方法？

谢谢你的帮助。

我的代码：

```
 // create the HttpWebRequest object
        HttpWebRequest objRequest = (HttpWebRequest)WebRequest.Create("http://www.google.com");

        // get the response object which has the header info, using the GetResponse method
        var objResults = objRequest.GetResponse(); 

        // get the header count
        int intCount = objResults.Headers.Count;

        // loop through the results object
        for (int i = 0; i < intCount; i++)
        {
            string strKey = objResults.Headers.GetKey(i);
            string strValue = objResults.Headers.Get(i);

            lblResults.Text += strKey + "<br />" + strValue + "</br /><br />";
        } 
```

我的结果：

Cache-Control 私有，max-age=0

内容类型文本/html；字符集=ISO-8859-1

日期 2012 年 6 月 5 日星期二 17:40:38 GMT

过期 -1

设置 Cookie PREF=ID=526197b0260fd361:FF=0:TM=1338918038:LM=1338918038:S=gefqgwkuzuPJlO3G; 过期=周四，2014 年 6 月 5 日 17:40:38 GMT；路径=/; 域=.google.com,NID=60=CJbpzMe6uTKf58ty7rysqUFTW6GnsQHZ-Uat_cFf1AuayffFtJoFQSIwT5oSQKqQp5PSIYoYtBf_8oSGh_Xsk1YtE7Z834Qwn0A4Sw3ruVCA9v3f_UDYH4b4fAloFJbW; 到期=格林威治标准时间 2012 年 12 月 5 日星期三 17:40:38；路径=/; 域=.google.com；HttpOnly

P3P CP="这不是 P3P 政策！有关详细信息，请参阅[http://www.google.com/support/accounts/bin/answer.py?hl=en&answer=151657](http://www.google.com/support/accounts/bin/answer.py?hl=en&answer=151657)。"

服务器 gws

X-XSS-保护1；模式=块

X-Frame-Options SAMEORIGIN

传输编码分块

========================== Fiddler 结果：

# 结果 协议 主机 URL 正文 缓存 内容类型 进程 注释 自定义

1 304 HTTP www.rolandgarros.com /images/misc/weather/P8.gif 0 max-age=700 到期时间：2012 年 6 月 5 日星期二 17:53:40 GMT image/gif firefox:5456
2200 HTTP www.google。 com / 23,697 私有，max-age=0 过期：-1 文本/html；charset=UTF-8 chrome:2324
3 304 HTTP www.rolandgarros.com /images/misc/weather/P9.gif 0 max-age=700 Expires: Tue, 05 Jun 2012 17:53:57 GMT image/gif firefox: 5456
4 200 HTTP 隧道到 translate.googleapis.com:443 0 chrome:2324
5 200 HTTP www.google.com

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-06-05T18:21:34.970

不同之处在于 Fiddler 实际上记录的是整个会话，而不仅仅是单个 HTTP 请求。

如果用户加载 Google.com，则响应通常是一个 HTML 文档，其中包含图像、脚本文件、CSS 文件等。然后，您的浏览器将为这些资源中的每一个发起一个新的 HTTP 请求。在 Fiddler 运行时，它会跟踪每个 HTTP 请求并输出结果代码和有关会话的其他信息。

使用上面的 C# 代码，您只启动了一个 HTTP 请求，因此您只有关于单个结果的信息。

你最好写一个浏览器插件。否则，您必须解析 HTML 响应并从该文档加载其他资源。

如果您*确实*需要使用 C# 代码执行此操作，您可以使用[HTML Agility Pack](http://htmlagilitypack.codeplex.com/)解析文档，然后在 HTML 中查找其他资源来模拟浏览器。还有嵌入式浏览器，例如[Awesomium](http://awesomium.com/)，可能会有所帮助。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-06-05T18:38:49.933

您不是在要求 Fiddler 显示的相同信息。Fiddler 显示 HTTP 状态代码、主机和 URI 以及（从您的示例中显示）内容长度、内容类型和缓存状态。

对于其中许多，您将不得不查看响应标头。

# c# - 如何在 RichTextBox 中搜索短语并使用您指定的颜色突出显示该短语的每个实例

> ID：10902620
> 
> 赞同：0
> 
> 时间：2012-06-05T18:16:18.197
> 
> 标签：c#, winforms, richtextbox

如何在 RichTextBox 中搜索一个短语并用所需的任何颜色突出显示该短语的每个实例？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-06-05T18:16:19.210

根据需要替换分配给 ValToSearchFor 的字符串和分配给 RichTextBox 的 SelectionColor 属性的颜色。

```
String richText = richTextBox1.Text;
String ValToSearchFor = "duckbilledPlatypus";
int pos = 0;
pos = richText.IndexOf(ValToSearchFor, 0);
while (pos != -1) {
    richTextBox1.Select(pos, ValToSearchFor.Length);
    richTextBox1.SelectionColor = Color.Red;
    pos = richText.IndexOf(ValToSearchFor, pos + 1);
} 
```

# oauth - 使用 OAuth 授权访问我自己的 REST API

> ID：10902628
> 
> 赞同：2
> 
> 时间：2012-06-05T18:16:59.030
> 
> 标签：oauth, oauth-provider

我对 OAuth 和 API 安全性很陌生。

我正在构建一个将由我自己的移动应用程序访问的 REST API。

我想通过 OAuth 授权和身份验证向其他开发人员公开 API，我将使用我自己的 OAuth 提供程序。

我自己的移动应用程序的身份验证策略是什么？毕竟，我不需要用户授权我的应用程序。我可以在默认情况下对自己的移动应用程序进行预授权的同时使用 OAuth 进行身份验证吗？

我可以使用 OAuth 对我的移动应用程序的用户进行身份验证，还是需要 OpenID 之类的东西？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-06-05T20:35:23.540

如果您希望跳过用户授权步骤，我认为您不需要 oauth。但是，如果您决定使用 oauth，则可以将授权步骤屏蔽为登录对话框或为您的应用程序提供访问令牌。用户授权是 oauth 功能的重要组成部分，因此忽略它可能意味着您应该使用其他接口来访问用户信息。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-06-06T13:40:42.080

`Accessing my own oauth REST API`- OAuth 与 REST apriori 无关：OAuth - 是授权协议，REST - 一种架构风格。

对于 OAuth - 使用 2.0 版 - 已经是 2012 年了。

`What is the authentication strategy for my own mobile app?`- 例如，对于 Android 上的移动应用程序，您可以使用在 GooglePlay 商店/GMAIL 中注册他的手机的用户帐户（然后从您的服务器端生成一次性密码）。如果有人不将它们提供给您的应用程序 - 进行显式身份验证。

现在可能只有计算器不使用显式身份验证 - 那么你为什么要不同呢？您可以将身份验证链接到 FB 或 Google 或任何其他 OAuth 提供程序 - 是什么让您创建合适的 OAuth 提供程序？

您可以同时使用 OAuth 和 OpenID 对用户进行身份验证。

# wpf - 为什么我会收到错误“在“ViewModelLocator”上引发了 ArgumentException：无法创建“ViewModelLocator”的实例

> ID：10902629
> 
> 赞同：1
> 
> 时间：2012-06-05T18:17:21.670
> 
> 标签：wpf, entity-framework, mvvm-light

我已经缩小到一个简单的方法，我试图从实体模型中填充一个 Observable 集合。我不知道我这样做是否正确。

注意：这似乎是设计者错误。我可以构建和运行程序......所以它出现了。

```
 private ObservableCollection<LessonGroup> lessonGroups;
    public ObservableCollection<LessonGroup> LessonGroups
    {
        get { return LessonGroups; }
        set { lessonGroups = value; RaisePropertyChanged("LessonGroups"); }
    }

    private void GetLessonGroups()
    {
        //this using statement causes ArgumentException
        using (MyEntities ae = new MyEntities())
        {
            foreach (LessonGroup lg in ae.LessonGroups)
            {
                LessonGroups.Add(lg);
            }
        }
    } 
```

例外情况如下：

```
The specified named connection is either not found in the configuration, not intended to be used with the EntityClient provider, or not valid.
   at System.Data.EntityClient.EntityConnection.ChangeConnectionString(String newConnectionString)
   at System.Data.EntityClient.EntityConnection..ctor(String connectionString)
   at System.Data.Objects.ObjectContext.CreateEntityConnection(String connectionString)
   at System.Data.Objects.ObjectContext..ctor(String connectionString, String defaultContainerName)
   at IMPACT.ARCTrainer.Model.ARCTrainerEntities..ctor() in C:\Users\Leland\Documents\Visual Studio 2010\Projects\ARCTrainer\Model\ARCTrainer.Designer.cs:line 56
   at IMPACT.ARCTrainer.ViewModel.LessonsViewModel.GetLessonGroups() in C:\Users\Leland\Documents\Visual Studio 2010\Projects\ARCTrainer\ViewModel\LessonsViewModel.cs:line 171
   at IMPACT.ARCTrainer.ViewModel.LessonsViewModel..ctor(ViewModelLocator viewModelLocator) in C:\Users\Leland\Documents\Visual Studio 2010\Projects\ARCTrainer\ViewModel\LessonsViewModel.cs:line 37
   at IMPACT.ARCTrainer.ViewModel.ViewModelLocator..ctor() in C:\Users\Leland\Documents\Visual Studio 2010\Projects\ARCTrainer\ViewModel\ViewModelLocator.cs:line 46 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-06-05T20:52:32.510

GetLessonGroups 似乎是在您的类 LessonsViewModel 的构造函数中调用的。

此方法调用 MyEntities，看起来此实体框架上下文与 GUI 项目不是同一个项目。

要解决您的问题，最好的方法是检查您是否处于设计模式。如果您使用的是 MVVM Light，则可以检查 IsInDesignMode 属性（因此，仅当属性为 false 时才调用 GetLessonGroups 方法）。

# vim - 关于如何创建类似 Vim 的编辑器的任何教程？

> ID：10902630
> 
> 赞同：10
> 
> 时间：2012-06-05T18:17:23.793
> 
> 标签：vim, text-editor, vi

我一直是 Vim 的狂热用户，最近对它的工作原理产生了兴趣。

有谁知道是否有教程介绍了将普通文本编辑器转换为具有 Vi/m 功能的基础知识？编程语言无关紧要；我是一个很有经验的程序员。

到目前为止，我找到了以下资源：

*   [文本编辑工艺](http://www.finseth.com/craft/)
*   [使用 NCURSES 实现 Vi 编辑器](http://www.scribd.com/doc/53680825/Implementation-of-VI-Editor-With-NCURSES)
*   [用 Python 实现的 Vi 编辑器](http://code.google.com/p/pyvi/)
*   [Ruvi：Ruby 中的 Vi(m) 克隆](http://rubyforge.org/projects/ruvi/)

* * *

## 回答 #1

> 赞同：9
> 
> 时间：2012-06-07T07:56:17.647

我想首先你应该知道 VI/VIM 实际上是两个部分。一个是可视化编辑器`vi`，另一个是单行编辑器，称为`ed`.

实际上`vi`被称为**可视化**`ed`编辑器，因为它建立在（编辑器）之上。它是 ex 模式的可视化部分，您可以在其中查看和编辑文本，这就是它从**visual获得名称****vi**的原因。

 ****ex 模式**实际上是编辑器的复制/表示`ed`。只需`ed`在终端上启动并使用默认的 Vi ex 命令即可。**视觉**、**替换**和插入**模式**由`vi`. 例如，有几个命令实际上在做同样的事情，例如：

```
:100 // Go to line 100, ex mode (ed)
100G // Go to line 100, normal mode(vi)

:.,5d // Delete 5 lines, ex mode (ed)
5dd   // Delete 5 lines, normal mode (vi) 
```

等等...

有关这方面的更多信息，我建议阅读O'Reilly的《[学习 vi 和 Vim 编辑器》这本书：](https://rads.stackoverflow.com/amzn/click/com/059652983X)

![替代文字](../Images/27e8db05958220c25b10d3969e589596.png)

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-06-06T21:58:47.787

作为一点灵感，您也许可以看看 Vi 仿真在各种 IDE 中的实现。

*   Visual Studio (F#)：[https ://github.com/jaredpar/VsVim](https://github.com/jaredpar/VsVim)
*   MonoDevelop (C#): [https://github.com/mono/monodevelop/tree/master/main/src/core/Mono.Texteditor/Mono.TextEditor.Vi](https://github.com/mono/monodevelop/tree/master/main/src/core/Mono.Texteditor/Mono.TextEditor.Vi)
*   Eclipse（Java）：[https ://github.com/vrapper/vrapper](https://github.com/vrapper/vrapper)

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-06-06T12:37:40.120

作为经验丰富的 Vi 用户，您将知道使其与其他（可视）编辑器不同的主要有两个关键方面： - 输入模式`Esc`和`:`在它们之间切换的常用方式 - 上下文键盘映射，其中多个按键建立一个命令

我见过很多人将 Vi 键盘映射的子集添加到现有编辑器中，虽然可以合理地映射一些东西，但获得仿真可能需要相当广泛地替换现有编辑器的键盘处理。

当然，键盘映射有很好的文档记录，所以实现起来应该不会太难。

接下来是实现命令模式。这取决于您要修改哪个编辑器来实现这一点，但我想将焦点更改为底部的永久小部件/控件。一旦将焦点放在该控件上，您就可以轻松处理输入，然后在按下返回时解析和处理命令。

命令模式的基本语法继承自 ed/sed 编辑器，因此您可以查找其实现（或论文）。

总而言之，获得一个看起来很像 vi 的肤浅实现并不是一项艰巨的工作。但真正做好是另一回事。我建议你认真考虑只使用优秀的 Vim ( [http://www.vim.org/](http://www.vim.org/) )。**

# c# - 任何用于在 Windows phone 7 中解析 HTML 的库？

> ID：10902633
> 
> 赞同：1
> 
> 时间：2012-06-05T18:17:48.710
> 
> 标签：c#, html, silverlight-4.0, windows-phone-7.1

我正在为 C# 中的 Windows Phone 7 寻找一个好的 HTML 解析器。HTMLAgilityPack 给 Windows Phone 7 带来了一些问题。请回复。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-06-05T18:30:54.740

这里有 2 个用于在 C# 中解析 HTML 的库...

*   [HTMLAgilityPack](http://htmlagilitypack.codeplex.com/)
*   [Majestic-12 HTML 解析器](http://www.majestic12.co.uk/projects/html_parser.php)

# wcf - 无法激活 WCF 服务

> ID：10902643
> 
> 赞同：27
> 
> 时间：2012-06-05T18:19:06.677
> 
> 标签：wcf

我正在使用 WCF，它在 localhost 上运行良好。在我把它放在生产服务器上之后，它抛出了一个异常

> 无法激活请求的服务“ [http://global-kazway.kz/Service1.svc ”。](http://global-kazway.kz/Service1.svc)有关详细信息，请参阅服务器的诊断跟踪日志

我是服务的新手，已经尝试解决这个问题将近 3 个小时。

这是`App.config`客户的；

```
<?xml version="1.0" encoding="utf-8"?>
<configuration>
  <configSections></configSections>
  <connectionStrings>
    <add name="TestProject.Properties.Settings.DBConnectionString" connectionString="Data Source=.\SQLEXPRESS;AttachDbFilename=C:\Users\1\Documents\visual studio 2010\Projects\TestProject\TestProject\AppData\DB.mdf;Integrated Security=True;User Instance=True" providerName="System.Data.SqlClient" /><add name="DBEntities" connectionString="metadata=res://*/DBModel.csdl|res://*/DBModel.ssdl|res://*/DBModel.msl;provider=System.Data.SqlClient;provider connection string=&quot;data source=.\SQLEXPRESS;attachdbfilename=C:\Users\1\Documents\visual studio 2010\Projects\TestProject\TestProject\AppData\DB.mdf;integrated security=True;user instance=True;multipleactiveresultsets=True;App=EntityFramework&quot;" providerName="System.Data.EntityClient" /><add name="DBEntities1" connectionString="metadata=res://*/DBModel.csdl|res://*/DBModel.ssdl|res://*/DBModel.msl;provider=System.Data.SqlClient;provider connection string=&quot;data source=.\SQLEXPRESS;attachdbfilename=|DataDirectory|\AppData\DB.mdf;integrated security=True;user instance=True;multipleactiveresultsets=True;App=EntityFramework&quot;" providerName="System.Data.EntityClient" /></connectionStrings>
  <system.serviceModel>
    <bindings>
      <basicHttpBinding>
        <binding name="BasicHttpBinding_IService1" closeTimeout="00:01:00"
          openTimeout="00:01:00" receiveTimeout="00:10:00" sendTimeout="00:01:00"
          allowCookies="false" bypassProxyOnLocal="false" hostNameComparisonMode="StrongWildcard"
          maxBufferSize="65536" maxBufferPoolSize="524288" maxReceivedMessageSize="65536"
          messageEncoding="Text" textEncoding="utf-8" transferMode="Buffered"
          useDefaultWebProxy="true">
          <readerQuotas maxDepth="32" maxStringContentLength="8192" maxArrayLength="16384"
            maxBytesPerRead="4096" maxNameTableCharCount="16384" />
          <security mode="None">
            <transport clientCredentialType="None" proxyCredentialType="None"
              realm="" />
            <message clientCredentialType="UserName" algorithmSuite="Default" />
          </security>
        </binding>
      </basicHttpBinding>
    </bindings>
    <client>
      <endpoint address="http://global-kazway.kz/Service1.svc" binding="basicHttpBinding"
        bindingConfiguration="BasicHttpBinding_IService1" contract="kazwayServiceReference.IService1"
        name="BasicHttpBinding_IService1" />
    </client>
  </system.serviceModel>
</configuration> 
```

* * *

## 回答 #1

> 赞同：73
> 
> 时间：2012-06-05T18:25:18.687

对 WCF 应用程序进行故障排除的第一步是打开浏览器并输入服务 URI。因此，基于客户端：您将导航到[http://global-kazway.kz/Service1.svc](http://global-kazway.kz/Service1.svc)

现在看看你得到什么样的结果。例外？服务画面？通常你可以从这个屏幕上得到你最好的信息！有时它会指出您的问题是什么，例如缺少行为。

将您的 web.config 与部署的 web.config 条目进行比较。你也可以在那里找到一些东西。最后，您可能只需要管理文件夹的安全性。但是浏览器显示可以非常清楚地为您拼出所有内容。

* * *

## 回答 #2

> 赞同：8
> 
> 时间：2014-05-16T20:17:13.157

我正在做一个项目，我遇到了同样的问题。当我检查事件查看器以跟踪错误时，我发现了问题所在。

事件查看器消息：

```
Sender Information: System.ServiceModel.ServiceHostingEnvironment+HostingManager/7540993
 Exception: System.ServiceModel.ServiceActivationException: The service '/CODWebService/Service1.svc' cannot be activated due to an exception during compilation.  The exception message is: Memory gates checking failed because the free memory (164065280 bytes) is less than 5% of total memory.  As a result, the service will not be available for incoming requests.  To resolve this, either reduce the load on the machine or adjust the value of minFreeMemoryPercentageToActivateService on the serviceHostingEnvironment config element.. ---> System.InsufficientMemoryException: Memory gates checking failed because the free memory (164065280 bytes) is less than 5% of total memory.  As a result, the service will not be available for incoming requests.  To resolve this, either reduce the load on the machine or adjust the value of minFreeMemoryPercentageToActivateService on the serviceHostingEnvironment config element. 
```

然后我将以下代码添加到我的服务的 web.config 文件中。

```
<serviceHostingEnvironment aspNetCompatibilityEnabled="true" multipleSiteBindingsEnabled="true" minFreeMemoryPercentageToActivateService="1" /> 
```

这个元素应该放在`<system.serviceModel>`

* * *

## 回答 #3

> 赞同：6
> 
> 时间：2012-06-05T18:29:53.407

> 我在 WCF 上工作，它在 localhost 上运行良好。在我将它放到生产服务器后，它给我一个异常“请求的服务，'http://global-kazway.kz/Service1.svc' 不能已激活。**有关详细信息，请参阅服务器的诊断跟踪日志**“

[这篇 MSDN 文章介绍了如何在服务器上配置跟踪](http://msdn.microsoft.com/en-us/library/ms733025.aspx)。完成后，您可以查看服务器的诊断跟踪日志，并且很可能会发现问题。

* * *

## 回答 #4

> 赞同：2
> 
> 时间：2012-06-07T08:33:56.603

要更详细地描述错误，请将此代码插入服务的 web.config 文件中：-

```
 <serviceBehaviors>
    <behavior name="MyServiceBehavior">
      <serviceMetadata httpGetEnabled="true" />
      <serviceDebug includeExceptionDetailInFaults="true" />
    </behavior>
  </serviceBehaviors> 
```

然后在您的服务中使用此服务行为，如下所示：-

```
<service name="MyService" behaviorConfiguration="MyServiceBehavior" >
        <endpoint address="" binding="basicHttpBinding"  xxxx="" xxxxx="" xxxxx="" xxxx="" xxxx="" />
        <endpoint contract="IMetadataExchange" binding="mexHttpBinding" address="mex" />
        <host>
          <baseAddresses>
            <add baseAddress="http://ServerAddress:AnyPortIfspecified/VirtualDirname"/>
          </baseAddresses>
        </host>
      </service> 
```

这将为您提供错误的详细说明。

您可以尝试的第二件事是检查：-

```
<host>
        <baseAddresses>
          <add baseAddress="http://ServerAddress:AnyPortIf specified/VirtualDir name"/>
        </baseAddresses>
      </host> 
```

确保您的基地址不是本地主机。TC

* * *

## 回答 #5

> 赞同：2
> 
> 时间：2016-04-07T21:42:29.880

我能够通过使用 Visual Studio 2013 执行以下步骤来解决此问题：

1.  转到您拥有 *.svc 文件的**项目文件夹**
2.  右键单击 *.svc 文件 -->**在浏览器中查看**
3.  验证您是否能够浏览服务

[![在此处输入图像描述](../Images/3c157fef415b0b81db0d022ced1f639b.png)](https://i.stack.imgur.com/gcUvu.png)

1.  转到您拥有 app.config 文件或要使用该服务的项目文件夹。
2.  右键项目-->**添加**-->**服务参考**
3.  单击**发现**-->在服务下选择服务-->为您的服务引用提供所需的名称-->单击**确定**
4.  它将在“Service References”文件夹下创建“ServiceReference1”并自动创建/更新 app.config 文件

[![在此处输入图像描述](../Images/7dc40e1714088950e294e2fbd25b9693.png)](https://i.stack.imgur.com/sfcuk.png)

* * *

## 回答 #6

> 赞同：2
> 
> 时间：2017-04-24T10:06:33.237

首先获取服务 url 地址（例如[http://youservice:808/Area.Service/Service.svc](http://youservice:808/Area.Service/Service.svc)）并将其放入浏览器 url 字段以检查服务是否正在运行。

就我而言，它没有运行。

远程服务器运行了一个使用大量 CPU 和 RAM 的进程（sql 进程）

这阻止了服务。

通过关闭/停止远程服务器上任务管理器中的某些进程恢复了服务。

* * *

## 回答 #7

> 赞同：0
> 
> 时间：2020-05-12T15:44:20.207

除了接受的答案之外，我还访问了`Service.svc`映射中 URL 的确切 URL。

从那里你可以看到详细的问题，在我的情况下，这是错误：

[![在此处输入图像描述](../Images/a581b69ad90297fbee39cdc491567913.png)](https://i.stack.imgur.com/Ufynm.jpg)

查看问题，我的 web.config 文件有正确的配置，但我注意到它正在寻找程序集，从那里，我发现我没有引用服务合同项目，包括服务实施和数据访问层组装。

# linux - perl 脚本中的读写操作

> ID：10902648
> 
> 赞同：2
> 
> 时间：2012-06-05T18:19:27.153
> 
> 标签：linux, perl

我是 Perl 脚本的新手。

我想对文件进行读写操作。我将以读写模式（+<）打开一个文件，然后写入一个文件。现在，我想读取我之前写过的文件。下面是我的代码：

```
#!/usr/bin/perl

`touch file.txt`; #Create a file as opening the file in +< mode
open (OUTFILE, "+<file.txt") or die "Can't open file : $!";

print OUTFILE "Hello, welcome to File handling operations in perl\n"; #write into the file

$line = <OUTFILE>; #read from the file

print "$line\n"; #display the read contents. 
```

当我显示读取的内容时，它显示一个空行。但是文件“file.txt”有数据

```
Hello, welcome to File handling operations in perl 
```

为什么我无法阅读内容。我的代码是错误的还是我遗漏了什么。

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-06-05T18:22:22.650

问题是您的文件句柄位置位于您编写的行之后。在再次阅读之前，使用该[`seek`](http://p3rl.org/seek)功能将“光标”移回顶部。

一个例子，有一些额外的评论：

```
#!/usr/bin/env perl

# use some recommended safeguards
use strict;
use warnings;

my $filename = 'file.txt';
`touch $filename`;

# use indirect filehandle, and 3 argument form of open
open (my $handle, "+<", $filename) or die "Can't open file $filename : $!";
# btw good job on checking open sucess!

print $handle "Hello, welcome to File handling operations in perl\n";

# seek back to the top of the file
seek $handle, 0, 0;

my $line = <$handle>;

print "$line\n"; 
```

如果您要进行大量阅读和写作，您可能想尝试（并不是每个人都建议这样做）使用[`Tie::File`](http://p3rl.org/Tie%3a%3aFile)它可以让您将文件视为数组；按行号访问行（自动写入换行符）。

```
#!/usr/bin/env perl

# use some recommended safeguards
use strict;
use warnings;

use Tie::File;

my $filename = 'file.txt';
tie my @file, 'Tie::File', $filename
  or die "Can't open/tie file $filename : $!";

# note file not emptied if it already exists

push @file, "Hello, welcome to File handling operations in perl";
push @file, "Some more stuff";

print "$file[0]\n"; 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-06-05T18:35:34.973

这是一个看似常见的初学者错误。大多数情况下，您会发现读取和写入同一个文件虽然可能，但并不值得麻烦。正如 Joel Berger 所说，您可以`seek`到文件的开头。您也可以简单地重新打开文件。寻找不像逐行阅读那么简单，会给你带来困难。

另外，您应该注意，不需要事先创建一个空文件。只需这样做：

```
open my $fh, ">", "file.txt" or die $!;
print $fh "Hello\n";
open $fh, "<", "file.txt" or die $!;
print <$fh>; 
```

注意：

*   `open`在同一个文件句柄上使用会自动关闭它。
*   我使用三参数 open 和一个词法（由 定义`my`）文件句柄，这是推荐的方式。
*   打印以逐行模式读取的变量时，您不需要添加换行符，因为它最后已经有了换行符。或文件结束。
*   您可以使用`print <$fh>`，因为 print 语句在列表上下文中，它将从文件句柄中提取所有行（打印整个文件）。

如果你只想打印一行，你可以这样做：

```
print scalar <$fh>;  # put <$fh> in scalar context 
```

# eclipse - Eclipse 中撤消/重做操作的大小

> ID：10902650
> 
> 赞同：1
> 
> 时间：2012-06-05T18:19:30.843
> 
> 标签：eclipse, undo-redo

这可能是一个微不足道的，但我做了一些搜索，什么也没找到。所以我很抱歉，以防它已经得到回答，我只是不知道正确的措辞。

当我在 Eclipse 中并在编辑器中撤消时，编辑器会返回几个步骤，而不是一个。这很烦人，因为我不想撤消所有那些看似“分组”的操作。

有没有人有解决方法？

谢谢

# javascript - javascript中的阶乘。不工作

> ID：10902651
> 
> 赞同：-1
> 
> 时间：2012-06-05T18:19:33.607
> 
> 标签：javascript, math, factorial

这是脚本，我不明白为什么它不起作用...

```
function FirstFactorial(num) {

var lower = num - 1;
var qq = 0;

while (num > 0) {
var qq === num * lower;
num--;
lower--;
}
num === qq;
return num;
}
FirstFactorial(num); 
```

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2012-06-05T18:20:47.193

`=`是赋值运算符，`===`是严格相等运算符

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2012-06-05T19:00:36.137

您对此功能有很多问题，请参阅评论。

```
function FirstFactorial(num) {
    var lower = num - 1;
    var qq = 0;

    while (num > 0) {
        // here you are shadowing the "qq" variable in the outer scope
        // delete the "var" keyword to fix this
        // also === is an identity operator, i think you wanted assignment (=)
        // so this line becomes: qq = num * lower;
        var qq === num * lower;
        num--;
        lower--;
    }

    // assuming that === was supposed to be = again
    // you can rewrite this as just: return qq;
    num === qq;
    return num;
}

FirstFactorial(num); 
```

即使有这些语法修复，您计算阶乘的逻辑也不正确。

编辑：工作示例（因为我很无聊）[http://jsfiddle.net/gU2cz/](http://jsfiddle.net/gU2cz/)

# java - 如何在 smslib 中使用队列消息传递系列方法？

> ID：10902652
> 
> 赞同：0
> 
> 时间：2012-06-05T18:19:38.670
> 
> 标签：java, message-queue, smslib

我不知道如何在 smslib 中实现队列消息传递，我收到一条新的短信并存储在数据库表中，我做了一些逻辑然后我生成了一个新的短信，我已经归档了这种同步方式，但我不知道如何以异步方式进行？有人可以指导我或提示，我看到了文档，但我不知道如何排队，因为我正在接收和发送短信？？？，我需要运行这个应用程序，我希望每个用户都能得到答案，因为例如我使用方法 Service.getInstance().queueMessage(msg); 但它与 Service.getInstance.sendMessage() 的作用相同，所以我的问题是如何在 smslib 中使用队列？

有人可以指导我吗？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-08-31T13:49:56.747

和方法都通过您的调制解调器发送消息`sendMessage()`，`queueMessage()`但有根本的区别；*同步*`sendMessage()`执行并且*异步*执行（正如您自己所说）。*`queueMessage()`*

 **这意味着`sendMessage()`基本上会将消息转发到调制解调器，阻止它直到消息发送，然后返回。但是，如果您使用该`queueMessage()`方法，它会将消息存储在队列中并“在可以时”发送它，而不会阻塞调制解调器。

要从此消息中获取发送状态（无论是否发送，任何错误等），您需要创建一个实现`IOutboundMessageNotification`接口的类。在那里，在`process`方法中，您会收到状态消息，您可以根据自己的实现来处理它。

您将服务设置为“收听”这些通知，使用`Service.getInstance().setOutboundMessageNotification(outboundMessageNotification);`. 如果您想使用 收听传入的消息，这同样适用`IInboundMessageNotification`。

希望它有所帮助

-抢**

# git - 如何使用 git-rm 和文件通配符从某些目录而不是这些目录的子目录中删除文件？

> ID：10902662
> 
> 赞同：2
> 
> 时间：2012-06-05T18:20:44.457
> 
> 标签：git, directory-structure, file-globs

# 场景

我正在尝试从 git 存储库的整个历史记录中删除一些文件。他们都有几个共同的标准：

*   他们在文件名中有“设置”。不过，它们也可能有各种前缀和后缀。
*   它们将位于文件树中某个目录的深处**两层。**二级目录的名称各不相同。文件树中有更深的设置文件，不应删除。

那么，这里是文件树的一个示例：

```
root-directory/
  |-> apples/
  |     |-> bad-settings-alpha.txt
  |     |-> bad-settings-beta.txt
  |
  |-> oranges/
  |     |-> bad-settings-gamma.txt
  |     |-> bad-settings-delta.txt
  |     |-> navels/
  |           |-> good-settings.txt
  |
  |-> good-settings.txt 
```

我需要`bad-settings`在保留文件的同时过滤掉所有`good-settings`文件。

# 我的方法

因此，使用[GitHub 提供的教程](https://help.github.com/articles/remove-sensitive-data)，结合[git-rm 的手册页](http://www.kernel.org/pub/software/scm/git/docs/v1.7.3/git-rm.html)，我制作了这个命令（分成两行）：

```
git filter-branch -f --index-filter 'git rm --dry-run --cached \ 
--ignore-unmatch root-directory/*/*settings*.txt' --prune-empty -- --all 
```

这里需要特别注意的是我使用的文件 glob：`root-directory/*/*settings*.txt`. 如果我将该文件 glob 与 一起使用`ls`，那么我将得到我想要删除的文件列表。所以，它应该工作，对吧？

显然不是。如果我用那个 glob 运行我的命令，它也会删除所有比两级更深的设置文件。在上面的文件树示例中，这意味着它`root-directory/oranges/navels/good-settings.php`会遭到破坏。

* * *

我试图自己解决这个问题，尝试文件 glob 的变体并`--dry-run`使用`git-rm`. 似乎没有任何效果——我所能做的就是改变开始删除设置文件的文件树深度。

我确实发现了一件事似乎与我的问题极为相关。在手册页中`git-rm`，有这个例子：

```
git rm Documentation/\*.txt
  Removes all *.txt files from the index that are under the Documentation
  directory and any of its subdirectories.

  Note that the asterisk * is quoted from the shell in this example; this
  lets git, and not the shell, expand the pathnames of files and
  subdirectories under the Documentation/ directory. 
```

“从...目录及其任何子目录下的索引中删除所有...文件”与实际发生的情况一致。真正有趣的是提到引用的星号。我知道这可以`git-rm`处理文件 glob 扩展，而不是`bash`. 好的。但这留下了这些问题：

*   我为什么要这样做？
*   我*没有*引用我的星号，所以`bash`应该进行扩展。如果这是真的，并且我的文件 glob 可以与 一起使用`ls`，那么为什么它不能与 一起使用`git-rm`呢？

我也看到了上面那个下面的例子，它似乎做了我想做的事情。然而，这不会发生在我身上，否则我不会在这里。不过，它似乎确实证实了我*想*用 进行文件扩展`bash`。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-06-05T18:46:29.943

为什么不使用**`find`**显示两级深度文件：

```
find . -maxdepth 2 -mindepth 2 -type f -name "bad-settings*" 
```

这将为您提供只有两级深度导演的不良设置列表。您可以将它们`git rm`通过管道传送到`xargs`：

```
find . -maxdepth 2 -mindepth 2 -type f -name "bad-settings*" | xargs git rm 
```

# clojure - 如何管理多个连接？

> ID：10902663
> 
> 赞同：4
> 
> 时间：2012-06-05T18:20:45.513
> 
> 标签：clojure

我组装了一个简单的套接字服务器（见下文）。目前，它无法处理多个/并发请求。如何使套接字服务器更高效——即能够处理并发请求？我可以利用任何 clojure 构造吗？到目前为止，我已经考虑过使用 java 的 NIO（而不是 IO）或 netty（如在[此处](https://stackoverflow.com/questions/1735776/server-programming-with-clojure)指出的那样）。

```
(ns server.policy
    (:import 
        (java.net ServerSocket SocketException)
        java.io.PrintWriter))

    (defn create-socket
        "Creates a socket on given port."
        [port]
        (ServerSocket. port))

    (defn get-writer
        "Create a socket file writer."
        [client]
        (PrintWriter. (.getOutputStream client)))

    (defn listen-and-respond
        "Accepts connection and responds."
        [server-socket service]
        (let [client (.accept server-socket)
              socket-writer (get-writer client)]
            (service socket-writer)))

    (defn policy-provider
        "Returns domain policy content."
        [socket-writer]
        (.print socket-writer "<content>This is a test</content>")
        (.flush socket-writer)
        (.close socket-writer))

    (defn run-server
        [port]
        (let [server-socket (create-socket port)]
            (while (not (.isClosed server-socket))
                (listen-and-respond server-socket policy-provider)))) 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-06-05T21:28:25.827

我直接使用 Netty 取得了成功。但是，如果您想要一些更像惯用 Clojure 代码的东西，请查看[aleph](https://github.com/ztellman/aleph)库。它在内部使用 Netty，但生成的代码要简单得多：

```
(use 'lamina.core 'aleph.tcp)

(defn echo-handler [channel client-info]
  (siphon channel channel))

(start-tcp-server echo-handler {:port 1234}) 
```

另外，请记住，除了 aleph 文档之外，[有时](https://stackoverflow.com/questions/10414135/clojure-tcp-server-with-aleph)您还需要参考[lamina文档。](https://github.com/ztellman/lamina)

# ssrs-2008 - 通过链接报表中的返回链接按钮返回原始报表，主报表中带有多选参数

> ID：10902664
> 
> 赞同：4
> 
> 时间：2012-06-05T18:20:45.453
> 
> 标签：ssrs-2008, reporting-services, reportingservices-2005

我正在处理 ssrs 报告。我有一份总结和一份详细的报告。详细报告链接到摘要报告。现在用户希望在详细报告中有一个“返回摘要报告”链接。

我的主要问题是摘要报告中有多项选择参数。如果我有单个选择参数，我知道解决方案。在这种情况下，我可以创建一个文本框，其文本装饰为链接按钮，并在文本框的 Action 属性中选择 Jump to report 并提供从上一个报告中获得的参数。此方法适用于摘要中的单选参数，但我不知道如何处理多选。

此外，我们没有 ssrs 提供的用于返回报告的小按钮。所以那不是我可以使用的选项。

任何想法将不胜感激。

* * *

## 回答 #1

> 赞同：8
> 
> 时间：2012-06-05T21:26:22.117

在 Action 属性中，我必须选择“跳转到 URL”选项并将其放在跳转到 URL 的文本框中：

```
="javascript: history.go(-1)" 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2014-05-14T06:55:28.937

这是您必须放置 javascript:history.back(1) 的地方

*   右键单击报告

*   单击插入-> 文本框

*   创建文本框后

*   右键单击并选择“文本框属性”

*   单击“操作”属性

*   选择转到 URL 选项按钮

复制并过去 javascript:history.back(1)

（注：区分大小写，不用引号”）

然后单击确定，这应该在 IE 中工作

# php - 让用户下载不在 web 目录中的文件？

> ID：10902665
> 
> 赞同：1
> 
> 时间：2012-06-05T18:20:46.203
> 
> 标签：php, download

> **可能重复：**
> [允许用户在 webroot 之外下载文件](https://stackoverflow.com/questions/3884677/allow-users-to-download-files-outside-webroot)

大家好，我想使用 php 来允许用户从我的服务器上不属于我的“网络”文件的目录下载文件......有没有办法做到这一点？

例如

我的网络文件在 /www/bla/bla

但我要下载的文件在 /home/bla/bla

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-06-05T18:24:00.557

你可以做的是这样的：

```
$file = '/home/bla/bla/file.ext';    

header('Content-Description: File Transfer');
header('Content-Type: application/octet-stream');
header('Content-Disposition: attachment; filename='.basename($file));
header('Content-Transfer-Encoding: binary');
header('Expires: 0');
header('Cache-Control: must-revalidate');
header('Pragma: public');
header('Content-Length: ' . filesize($file));
ob_clean();
flush();
readfile($file);
exit; 
```

[readfile()](http://php.net/manual/en/function.readfile.php)只是检索文件的内容并打印出来。其余代码是强制下载。

# java - 服用“new java.util.Date()”并提前 1 个月完成

> ID：10902667
> 
> 赞同：5
> 
> 时间：2012-06-05T18:20:56.770
> 
> 标签：java, jasper-reports, ireport

我正在使用 jaspersoft 的 iReport，我想将`new java.util.Date()`（即当前日期）转换为该日期前 1 个月。我在文本字段表达式中写什么来实现这一点？

* * *

## 回答 #1

> 赞同：13
> 
> 时间：2012-06-05T19:01:17.250

您可以使用 Joda-Time Java API。调用对象的[`minusMonths`](http://www.joda.org/joda-time/apidocs/org/joda/time/DateTime.html#minusMonths%28int%29)方法[`DateTime`](http://www.joda.org/joda-time/apidocs/org/joda/time/DateTime.html)。

jrxml 文件示例：

```
<?xml version="1.0" encoding="UTF-8"?>
<jasperReport xmlns="http://jasperreports.sourceforge.net/jasperreports" xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance" xsi:schemaLocation="http://jasperreports.sourceforge.net/jasperreports http://jasperreports.sourceforge.net/xsd/jasperreport.xsd" name="joda_sample" pageWidth="595" pageHeight="842" whenNoDataType="AllSectionsNoDetail" columnWidth="555" leftMargin="20" rightMargin="20" topMargin="20" bottomMargin="20">
    <import value="org.joda.time.DateTime"/>
    <title>
        <band height="79" splitType="Stretch">
            <textField>
                <reportElement x="109" y="23" width="175" height="20"/>
                <textElement/>
                <textFieldExpression><![CDATA["Current date: " + new SimpleDateFormat("dd.MM.yyyy").format(new Date())]]></textFieldExpression>
            </textField>
            <textField>
                <reportElement x="336" y="23" width="200" height="20"/>
                <textElement/>
                <textFieldExpression><![CDATA["Current date minus one month: " + DateTime.now().minusMonths(1).toString("dd.MM.yyyy")]]></textFieldExpression>
            </textField>
        </band>
    </title>
</jasperReport> 
```

结果将是：

![iReport 中的结果](../Images/651fd664996d13a8560d3c07ba7736d7.png)

***注意：*** 不要忘记将 Joda-Time 库添加到类路径（在我的情况下，我已将库添加到*iReport*的类路径）。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-06-05T19:04:13.057

Java Date API 是出了名的笨拙，有一个有用的第三方替代方案。尝试导入[http://joda-time.sourceforge.net/](http://joda-time.sourceforge.net/)库。

请参阅此帖子： [向 JodaTime Instant 添加天数](https://stackoverflow.com/questions/1058743/adding-a-number-of-days-to-a-jodatime-instant)

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-06-05T18:47:52.027

您可以通过以下方式使用[Calendar](http://docs.oracle.com/javase/1.4.2/docs/api/java/util/Calendar.html)类：

```
Calendar c=Calendar.getInstance();
c.setTime(myDate); //Yes, it is strange!!! But we don't really need this, for the getInstance() results in a current date.
c.add(Calendar.MONTH, -1); 
```

在您发表评论后，我意识到我无法将其更改为单个表达式，因为 add 返回 void 而不是 new Date()。对于那个很抱歉...

# sql - 每天自动删除一次 PostgreSQL 表

> ID：10902669
> 
> 赞同：3
> 
> 时间：2012-06-05T18:21:04.017
> 
> 标签：sql, database, postgresql, slony

我有一个场景，我有一个中央服务器和一个节点。服务器和节点都可以运行 PostgreSQL，但是节点上的存储空间是有限的。节点高速收集数据并将数据写入本地数据库。服务器需要从节点复制数据。我计划用[Slony-I](http://slony.info/)或[Bucardo](http://bucardo.org/wiki/Bucardo)来完成这个。节点需要能够以设定的时间间隔从其表中删除所有记录，以最小化使用的磁盘空间。我是否应该将[pgAgent](http://www.pgadmin.org/docs/1.4/pgagent.html)与由脚本组成的作业一起使用

```
DELETE FROM tablex, tabley, tablez; 
```

运行脚本的实际批处理文件类似于

```
@echo off
C:\Progra~1\PostgreSQL\9.1\bin\psql -d database -h localhost -p 5432 -U postgres -f C:\deleteFrom.sql 
```

?

如果这是完成此任务的最佳方法，或者是否有人知道从远程数据库中提取数据并清除该远程数据库以节省远程节点上的空间的更有效方法，我只是在寻找意见。谢谢你的时间。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-06-05T18:25:05.310

对您来说最有效的命令是[`TRUNCATE`](http://www.postgresql.org/docs/8.4/static/sql-truncate.html)命令。

使用 TRUNCATE，您可以链接表，例如您的示例：

```
TRUNCATE tablex, tabley, tablez; 
```

这是来自 postgres 文档的描述：

> TRUNCATE 从一组表中快速删除所有行。它与每个表上的非限定 DELETE 具有相同的效果，但由于它实际上并不扫描表，因此速度更快。此外，它会立即回收磁盘空间，而不需要后续的 VACUUM 操作。这在大表上最有用。

您还可以添加`CASCADE`作为参数：

> CASCADE 自动截断所有具有对任何命名表或由于 CASCADE 添加到组中的表的外键引用的表。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-06-05T20:15:05.810

根据您的确切需求和工作流程，两个最佳选择是截断，正如@Bohemian 建议的那样，或者创建一个新表，重命名，然后删除。

我们在我们的一个主要项目中使用了类似于后者的创建/重命名/删除方法。这有一个优势，您需要能够非常快速地从表中删除一些数据，但不是所有数据。基本工作流程是：

1.  使用与旧表相同的架构创建一个新表

    CREATE new_table LIKE ...

2.  在事务中，同时重命名旧表和新表：

    开始; 将表重命名为 old_table；重命名 new_table TO 表；犯罪;

3.  [可选] 现在你可以用旧表做一些事情，而新表很乐意接受新的插入。您可以将数据转储到您的集中式服务器，在其上运行查询或其他任何方式。

4.  删除旧表

    删除旧表；

当您想保留 7 天左右的数据并且一次只丢弃第 8 天的数据时，这是一个特别有用的策略。`DELETE`在这种情况下执行 a可能会*非常*慢。通过将数据存储在分区中（每天一个），一次删除一整天的数据很容易。

# javascript - 仅调用一次 onkeyup 函数

> ID：10902670
> 
> 赞同：1
> 
> 时间：2012-06-05T18:21:04.343
> 
> 标签：javascript

我写了一个示例 HTML 页面

```
<html>
<head>
<script>
function validate() {
alert(document.getElementById('newpass').value);
}
</script>
</head>

<body>
<input type="text" id="newpass" onkeyup="validate();" />
</body>
</html> 
```

但是在我按下退格键的情况下，该函数会被多次调用。如何让它只执行一次？

我要做的就是获取事件输入框的当前值，当前 onkeypress 不是给出当前值，而是给出前一个值。onkeyup 提供当前但正在执行多次。

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-06-05T18:40:34.020

It sounds like you want to get the current value of your input field as someone is typing, but want to ignore if they use backspace:

```
<html>
<head>
<script type="text/javascript">
function validate(that,e){
  var eventObject = window.event? event : e;
  var keyCode = eventObject.charCode? eventObject.charCode : eventObject.keyCode;
  if (keyCode != 8) {
    alert(that.value);
  }
}
</script>
</head>

<body>
<input type="text" id="newpass" onkeyup="validate(this,event);" />
</body>
</html> 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-06-05T18:37:41.580

如果您希望函数在用户完成输入后获取值，则使用`onchange`而不是 on key up

注意： `onkeyup`正在正常工作。如果您释放密钥，它会被调用一次。如果您按住退格键然后释放，那么它只会被调用一次。

`onkeypress`没有得到值，因为事件在值被存储之前被踢了。

另一种选择是忽略退格

```
function validate(event) {
    var keynum;
    if (window.event) {
       keynum = window.event.keyCode;
    } else if (event.which) {
       keynum = event.which;
    }

    if (keynum == 8) { // backspace 
      return;
    }
    alert(document.getElementById('newpass').value);
} 
```

或者您可以检查上一个键，如果相同则忽略它

```
var previousKey;
function validate(event) {
    var keynum;
    if (window.event) {
       keynum = window.event.keyCode;
    } else if (event.which) {
       keynum = event.which;
    }

    if (keynum == previousKey) { // backspace 
      return;
    }

    previousKey = keynum;

    alert(document.getElementById('newpass').value);
} 
```

或者如果它的退格再次忽略

# python - 脚本桥 vs PyObjC vs py2app

> ID：10902671
> 
> 赞同：6
> 
> 时间：2012-06-05T18:21:11.617
> 
> 标签：python, cocoa, py2app, scripting-bridge

我刚刚开始学习如何集成 Python 和 Mac OS 应用程序。（我想调用一些从 Cocoa 到 Python 的方法。）我遇到过这些术语——Scripting Bridge、PyObjC 和 py2app。有什么不同？PyObjC 是脚本桥的一个例子吗？什么时候 py2app 开始发挥作用？

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2012-06-05T19:14:52.923

简短版本：PyObjC 是您调用 Mac OS X API 的方式，Scripting Bridge 是您与其他应用程序的脚本接口对话的方式。更详细地说：

PyObjC 是 Python 语言和 Objective C 运行时之间的桥梁（以及在该桥梁之上简单构建的一组 Cocoa 包装器，以及一些不错的便利工具）。如果你想调用 Cocoa 方法，你可以使用 PyObjC，通常是通过导入 Cocoa 或 Foundation。

Scripting Bridge 是 Python 语言和 Apple 基于事件的脚本系统之间的桥梁。如果你想调用另一个应用程序的脚本接口，你可以使用 Scripting Bridge。（在大多数情况下，如果您使用的是 Scripting Bridge，您还需要导入 Foundation，因为 Scripting Bridge 处理诸如 NSArrays 之类的东西。）

因此，PyObjC 不是脚本桥的示例。脚本桥的一个示例是 Scripting Bridge 或 Appscript（更好，但不是来自 Apple，并且不再维护）。

py2app 与这些都没有太大关系；这是一种将 Python 应用程序及其所需的所有扩展模块以及尽可能多的 Python 解释器打包成单个 .app 包的方法，您可以将其分发给用户，以便他们只需双击即可运行。当然，大多数这样的应用程序都会有 GUI，其中许多将使用 PyObjC 直接在 Cocoa 中创建这些 GUI（而不是使用 PyQt 或 wxPython），但除此之外，没有真正的联系。

# web-services - JBoss AS 7 wsconsume：无法编译生成的代码 - @XmlElementRef - 必需

> ID：10902673
> 
> 赞同：0
> 
> 时间：2012-06-05T18:21:21.663
> 
> 标签：web-services, cxf, consuming

我正在尝试 JBoss AS 7 wsconsume.sh，但在生成的源代码上出现编译错误。怎么了？

WSDL 文件来自[https://isir.justice.cz:8443/isir_ws/services/IsirPub001?wsdl](https://isir.justice.cz:8443/isir_ws/services/IsirPub001?wsdl) ，它几乎没有形式错误。

```
$ ./wsconsume.sh -p cz.pohlidame.clientJBoss -o fooOut -s fooSrc -t 2.2 -e ~/proj/pohlidame.cz/wsdl-consumer/IsirPub001.wsdl 
Could not find log4j.xml configuration, logging to console.

TODO! Cheek SOAP 1.2 extension
WSConsume (CXF) does not allow to setup the JAX-WS specification target, using the currently configured JAX-WS version (check your JVM version and/or endorsed libs)
Loading FrontEnd jaxws ...
Loading DataBinding jaxb ...
wsdl2java -compile -exsh false -p cz.pohlidame.clientJBoss -verbose -classdir /home/ondra/work/AS7/ozizka-git/build/target/jboss-as-7.2.0.Alpha1-SNAPSHOT/bin/fooOut  -allowElementReferences file:/home/ondra/proj/pohlidame.cz/wsdl-consumer/IsirPub001.wsdl
wsdl2java - Apache CXF 2.4.6

                                                            ^
./cz/pohlidame/clientJBoss/IsirPub001Data.java:63: cannot find symbol
symbol  : method required()
location: @interface javax.xml.bind.annotation.XmlElementRef
@XmlElementRef(name = "spisZnacka", type = JAXBElement.class, required = false)
                                                              ^
3 errors
Failed to invoke WSDLToJava
org.apache.cxf.tools.common.ToolException: Failed to compile generated code
    at org.apache.cxf.tools.common.ClassUtils.compile(ClassUtils.java:115)
    at org.apache.cxf.tools.wsdlto.WSDLToJavaContainer.processWsdl(WSDLToJavaContainer.java:265)
    at org.apache.cxf.tools.wsdlto.WSDLToJavaContainer.execute(WSDLToJavaContainer.java:138)
    at org.apache.cxf.tools.wsdlto.WSDLToJavaContainer.execute(WSDLToJavaContainer.java:286)
    at org.apache.cxf.tools.common.toolspec.ToolRunner.runTool(ToolRunner.java:103)
    at org.apache.cxf.tools.wsdlto.WSDLToJava.run(WSDLToJava.java:113)
    at org.jboss.wsf.stack.cxf.tools.CXFConsumerImpl.consume(CXFConsumerImpl.java:250)
    at org.jboss.ws.tools.cmd.WSConsume.importServices(WSConsume.java:279)
    at org.jboss.ws.tools.cmd.WSConsume.mainInternal(WSConsume.java:104)
    at org.jboss.ws.tools.cmd.WSConsume.main(WSConsume.java:92)
    at sun.reflect.NativeMethodAccessorImpl.invoke0(Native Method)
    at sun.reflect.NativeMethodAccessorImpl.invoke(NativeMethodAccessorImpl.java:39)
    at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:25)
    at java.lang.reflect.Method.invoke(Method.java:597)
    at org.jboss.modules.Module.run(Module.java:270)
    at org.jboss.modules.Main.main(Main.java:294) 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-06-06T05:55:35.003

该`required`属性已添加到`@XmlElementRef`JAXB 2.2 中。

请参阅此处“必需”元素下的“自 2.2”：http: [//docs.oracle.com/javase/7/docs/api/javax/xml/bind/annotation/XmlElementRef.html#required()](http://docs.oracle.com/javase/7/docs/api/javax/xml/bind/annotation/XmlElementRef.html#required())。

看起来您已经生成了一个 JAXB 2.2 模型并尝试在具有 JAXB 2.1 API 的运行时中使用它。

**注意：** Java SE 6 包含 JAXB 2.0/2.1，Java SE 7 包含 JAXB 2.2。

# java - 从android中的非活动类调用活动的方法

> ID：10902682
> 
> 赞同：0
> 
> 时间：2012-06-05T18:21:48.030
> 
> 标签：java, android, android-asynctask

我正在实现一个类，`extends AsyncTask`我在这个类中执行一个 http 请求。该类不是一个`Activity`并且位于一个单独的 java 文件中，因为我想多次使用这个类。

我在我的 中实例化了这个类的一个对象`Activity`，以在单独的线程中执行 http 请求。当线程执行时，我想调用我的`Activity`.

我该如何实施？我需要http请求的结果，`Activity`但到目前为止我无法处理。

这是线程任务的代码...

```
public class PostRequest extends AsyncTask<String, Void, String> {
public String result = "";

@Override
protected String doInBackground(String... urls) {
    try {
        HttpClient httpclient = new DefaultHttpClient();
        HttpPost httppost = new HttpPost("http://bla/index.php?" + urls[0]);
        // httppost.setEntity(new UrlEncodedFormEntity(nameValuePairs));
        HttpResponse response = httpclient.execute(httppost);
        HttpEntity entity = response.getEntity();
        InputStream is = entity.getContent();

        // convert response to string
        BufferedReader reader = new BufferedReader(new InputStreamReader(is, "iso-8859-1"), 8);
        StringBuilder sb = new StringBuilder();
        String line = null;
        while ((line = reader.readLine()) != null) {
            sb.append(line + "\n");
        }
        is.close();
        result = sb.toString();
    } catch (Exception e) {
        e.printStackTrace();
    }

    return result;
}

@Override
protected void onPostExecute(String result) {

}
} 
```

这是我`Activity`创建线程类的代码的一部分......

```
public class ListActivity extends Activity {
@Override
public void onCreate(Bundle savedInstanceState) {
    super.onCreate(savedInstanceState);
    setContentView(R.layout.list);

    PostRequest task = new PostRequest();
    task.execute(new String[] { "action=getUsers" });
    task.onPostExecute(task.result) {

    }
}

public void Display(String result) {
    try {
        JSONArray jArray = new JSONArray(result);
        JSONObject json_data = jArray.getJSONObject(0);
        String value = json_data.getString("name");
        TextView text = (TextView) findViewById(R.id.value);
        text.setText(value);
    } catch (JSONException e) {
        e.printStackTrace();
    }
}
} 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-06-05T18:24:59.540

在构造函数中传递活动引用......

作为

```
public class PostRequest extends AsyncTask<String, Void, String> {
public String result = "";
private Activity mActivity;

 public PostRequest(Activity activity){
          super();
         mActivity = activity;
}

...... 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-06-05T18:25:21.477

您不必执行此操作，`onPostExecute()`因为这是在流程`doInBackground`完成后调用的，然后您可以使用传递给 AsyncTask 的构造函数的活动的引用来在您的 UI 上运行任何时间的方法。

请记住，该`onPostExecute()`方法在 UI 线程上运行，因此您可以在此方法中根据需要尝试修改您的视图。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-06-05T18:35:47.943

看到这个问题... [can-i-put-asynctask-in-a-separate-class-and-have-a-callback](https://stackoverflow.com/questions/10768449/android-can-i-put-asynctask-in-a-separate-class-and-have-a-callback)和接受的答案。如果您想要一个可重用的`AysncTask`独立类，那么使用侦听器作为所有活动的回调是最好的方法。

# git - 如何使用 git-svn 进行强制提交？

> ID：10902684
> 
> 赞同：1
> 
> 时间：2012-06-05T18:21:54.510
> 
> 标签：git, svn, git-svn, commit

我有一个正在开发的开发分支，并且想要提交它。然而，通过一系列我不会参与的不幸事件，我的 git svn 认为它已经是最新的并且没有什么可以提交的。

基本上现在我想用我的分支的本地版本来破坏我的分支的远程内容。类似于 a `git push --force`，除了 git svn。类似的东西`git svn dcommit --force`。

我意识到还有其他方法，例如检查另一个副本和复制/粘贴回购的内容。但我希望有一个简单的“强制”解决方案，就像纯 git 存在的那样。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-06-05T20:35:46.343

“git-svn dcommit”没有 --force 选项或任何类似的选项。你可以试试 SmartGit 客户端：

1.  使用 SmartGit 打开您的 Git-SVN 存储库
2.  选择远程-> 高级推送。选中“强制”复选框，按 Push。

SmartGit 可能会询问是将分支推送为新分支还是推送到现有分支。如果您选择 New，SmartGit 将从您的 Git 分支名称中选择 SVN 分支名称（例如，对于 refs/heads/XXX，它将选择分支/XXX）。如果您选择 Existing，SmartGit 将查看您当前的分支历史记录，直到满足“git-svn-id:”提交并将您的分支推送到那里指定的 URL。我认为第二种选择更适合您的情况。

# callback - 检查在页面加载中执行了哪个回调

> ID：10902685
> 
> 赞同：0
> 
> 时间：2012-06-05T18:21:54.937
> 
> 标签：callback, devexpress, panel

我有两个带有两个不同回调函数的 aspxcallbackpanel。有没有办法检查 Page_Load 其中一个正在执行？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-06-05T18:56:23.130

分析**ASPxCallbackInstance.IsCallback**属性以确定特定回调控件是否处于回调模式。

# html - 带有绝对位置的 HTML 打印

> ID：10902686
> 
> 赞同：25
> 
> 时间：2012-06-05T18:21:56.237
> 
> 标签：html, css, printing

是否可以将具有真正绝对定位元素的 HTML 页面打印到纸上？似乎所有浏览器都在这里搞得一团糟。很容易用绝对单位（例如厘米）定义一个物体，并`position: absolute`在里面放置元素。然而，每个浏览器似乎都试图让打印这样的页面成为不可能。例如，FF 正在添加打印边距，即使在 linux 上打印到 PDF，尽管页面设置为 0。Chrome 似乎在每种情况下都会缩小页面。那么如何打印具有绝对定位的东西，例如。纸质表单域、标记等？我忽略了什么吗？

* * *

## 回答 #1

> 赞同：29
> 
> 时间：2012-07-31T16:37:54.147

可悲的是，[CSS3 模块：分页媒体](http://www.w3.org/TR/css3-page/)允许这一切发生。这是关于太大页面的规则：

> [3.3.3\. 渲染不适合页面表的页面框](http://www.w3.org/TR/css3-page/#renderingpages)
> 
> 如果页面框与目标页面尺寸不匹配，用户代理可以选择（按优先顺序）：
> 
> *   在较大的页面上以指示的大小呈现页面框。
> *   如果这将使页面框适合页面表，则将页面框旋转 90°。
> *   缩放页面框以适合页面表。（缩放时不需要保持页面或页面上任何元素的纵横比；但是，最好保留纵横比。）[由 Chrome 完成]
> *   重新格式化页面内容，包括“溢出”到其他页面。[由许多其他或更旧的浏览器完成]
> *   剪辑溢出的内容（最不喜欢）。
> 
> 用户代理在执行这些操作之前***应该咨询用户。***
> 
> [3.3.4。将页面框定位在工作表上](http://www.w3.org/TR/css3-page/#positioning-page-box)
> 
> 当页面框小于页面大小时，用户代理***应该***将页面框居中放置在页面上，因为这将对齐双面页面并避免打印在页面边缘附近的信息意外丢失。

这是打破你所有`position`ed 东西的规则：

> 3.7\. [页框外的内容](http://www.w3.org/TR/css3-page/#content-outside-box)
> 
> [...] 此外，当盒子被绝对定位时，它们可能最终会出现在“不方便”的位置。例如，图像可以放置在页面框的边缘。同样，当框使用固定或相对定位时，它们也可能最终出现在页面框之外。
> 
> 此类元素的精确格式规范不在本文档的范围内。但是，我们建议作者和用户代理遵守以下有关页面框外内容的一般原则：
> 
> *   用户代理应该避免生成大量的空白页框来尊重元素的定位（例如，您不想打印 100 个空白页）。但是请注意，可能需要生成少量的空页面框来尊重 'page-break-before' 和 'page-break-after' 的 'left' 和 'right' 值。
> *   作者不应该为了避免渲染它们而将元素放置在不方便的位置。反而：
>     *   要完全抑制框生成，请将“显示”属性设置为“无”。
>     *   要使框不可见，请设置“可见性”属性。
> *   用户代理可以以多种方式处理位于页面框之外的框，包括丢弃它们或在文档末尾为它们创建页面框。

看看第 3.7 节的第二段：*这些元素的确切格式的规范超出了本文档的范围。*由于没有其他文档，也没有其他指南，因此本段遵循的一般原则，每个浏览器都可以为所欲为。

这是目前在这个 CSS3 模块中的缺陷之一。然而，我认为这些缺陷不能通过 CSS4 或修改后的 CSS3 模块来消除，因为可能的样式表和生成的布局的多样性太大而无法涵盖。[还要注意CSS Print Profile 中给出的](http://www.w3.org/TR/css-print/#table_note_pos)一个小脚注：

> ‡ 打印机可以忽略在正常流程中当前元素位置之前放置在页面上的定位元素。

所以基本上不可能在每个浏览器中创建相同的效果。就目前而言，实现便携式文档的唯一可能方法是使用第三方应用程序或通过 PDF 打印机和您最喜欢的浏览器创建 PDF。只要 W3C 的建议不严格或者浏览器供应商实现他们想要的任何东西，其他所有方法都注定会失败。

也可以看看：

*   [CSS3 模块：分页媒体](http://www.w3.org/TR/2006/WD-css3-page-20061010/)（工作草案，2006 年最新修订版）
*   [CSS 打印配置文件](http://www.w3.org/TR/2006/WD-css-print-20061013/)（工作草案，2006 年最新修订版）

### 补充说明

如果您有一堆`position:absolute`需要打印的元素，有时一个很好的问题是元素是否真的需要绝对定位，或者是否可以通过稍微不同或更简单的方式实现相同的效果。另请注意，您应该`display:none`在印刷媒体真正不需要的每个元素上使用，例如广告、导航等...

* * *

## 回答 #2

> 赞同：6
> 
> 时间：2012-07-27T12:43:16.043

正如您所说，网络浏览器在打印时往往会做一些疯狂的事情。面向打印的引擎通常更好。

[WeasyPrint](http://weasyprint.org/)是一个**开源**引擎，可以渲染为 PDF 并支持绝对定位以及[CSS 3 Paged Media](http://dev.w3.org/csswg/css3-page/)来设置页边距：

```
@page { margin: 1cm /* or 0, if you want */ } 
```

* * *

## 回答 #3

> 赞同：4
> 
> 时间：2012-06-05T20:51:22.770

使您的容器具有相对位置。这是在每个屏幕和纸张上将绝对定位元素保持在同一位置的唯一方法。因此，如果您的主 div（所有内容所在的 div）将以下内容添加到您的 CSS：

```
#maindivname{position:relative;} 
```

应该做的伎俩。

* * *

## 回答 #4

> 赞同：3
> 
> 时间：2015-06-05T19:36:20.817

我已经测试了打印“位置：绝对”元素的浏览器状态，结果如下：

*   IE 11：失败。不管什么操作系统，7、8、8.1。
*   IE 10：通过。但是，您无法在 8.1 上恢复到 10，因此使用它的人会被卡住。
*   Firefox 高达 38.05 = 失败。未知是否有任何版本有效。

好消息是，看起来 Blink/WebKit 的人做了他们的功课，而不是使用糟糕的代码。

*   铬：通过
*   歌剧：通过

* * *

## 回答 #5

> 赞同：2
> 
> 时间：2012-07-31T20:41:37.520

媒体查询可以解决问题 - 检查此链接和上一个问题，也许它会有所帮助。 [调试打印样式表的建议？](https://stackoverflow.com/questions/2452713/suggestions-for-debugging-print-stylesheets/5087220#5087220)

媒体查询将 px 转换为英寸/厘米/打印要求所需的任何值。

您提到的边框/边距可能是您的打印机的可打印区域（握把边缘）。大多数打印机需要某种类型的边缘来抓取和进纸。这就是为什么当一个人打印全出血文档（墨水到最边缘）时，它会打印在比所需更大的库存上，然后被裁减。

* * *

## 回答 #6

> 赞同：1
> 
> 时间：2012-07-26T13:00:13.433

使用页面设置设置页边距是打印`HTML`页面或`DIV`.

毕竟不会出现预期的结果，那么您需要在您的`HTML`页面上进行一些挖掘。

使用java脚本制作一个没有标题栏或任何自定义栏的窗口。并将所有原始数据放入该窗口中，`position:relative`并将媒体类型设置为打印。

```
position:relative;
media:print; 
```

希望它会有所帮助。

* * *

## 回答 #7

> 赞同：0
> 
> 时间：2021-07-20T13:20:13.603

在 CSS 中使用这个属性：

```
body{
  -webkit-print-color-adjust:exact;
} 
```

这有助于在表格中定位绝对值和背景。

# xml - 有没有办法使用 Perl 和 XML::Simple 快速验证数据

> ID：10902687
> 
> 赞同：0
> 
> 时间：2012-06-05T18:21:58.193
> 
> 标签：xml, perl, xml-parsing

我的 XML 文件如下所示：

```
<A>
 <file>data1</file>
 <path>data2</path>
</A>

<B>
  <file>data3</file>
  <path>data4</path>
</B> 
```

所以我从日志文件中读取数据，对其进行解析并获取标签，如`A`,和. 现在我使用 for 循环遍历每个外部标记，然后与每个子标记进行比较以查看数据是否存在于 XML 文件中。`B``file``path`

```
$data = $xml->XMLin("xmlfile");

foreach $e ( $data->{$outerTag} ) # outertag could be A, B
{
 if( $e->{file} eq $fname ) { do_something } else { return 0; }
 if( $e->{path} eq $pname ) { do_something } else { return 0; }
} 
```

有没有办法让我不必使用`for`循环。？假设我可以做这样的事情（我正在编造这个）：

```
if( $data->{$outerTag}->{$fname} ) { do_something } else { return 0; } 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-06-05T18:49:10.313

Perl 没有官方的“XML 解析器”；有很多[选项可供选择](https://metacpan.org/search?q=xml+parser+libxml)，根据应用程序，有些选项比其他选项更好。

您可能想阅读有关[使用模式进行 XML 验证](http://www.w3schools.com/schema/default.asp)的信息。简而言之，您需要为您认为有效的 XML 编写一个模式，然后根据它验证 XML 文件。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-06-05T18:50:26.230

只要`XML::Simple`为您的数据建立了合理的结构，您就可以编写

```
if ( $data->{$outerTag}{file} eq $fname ) { ... } 
```

但是，根据您要对数据执行的操作，您最好使用更好的 XML 解析器，例如`XML::LibXML`.

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-06-05T20:00:54.810

现在大多数基于标准的 XML 模式验证器都是基于 Java 或 Python 的:-(

我建议使用 xmllint，您也可以查看[XMLLint perl module](http://cpan.uwinnipeg.ca/htdocs/Meta/Meta/Tool/Xmllint.pm.html)。

# 例子

```
$ xmllint --noout --schema schema.xml data.xml
data.xml validates 
```

## 数据.xml

```
<data>
  <A>
    <file>data1</file>
    <path>data2</path>
  </A>
  <B>
    <file>data3</file>
    <path>data4</path>
  </B>
</data> 
```

## 架构.xml

```
<xsd:schema xmlns:xsd="http://www.w3.org/2001/XMLSchema" attributeFormDefault="unqualified" elementFormDefault="qualified" version="1.0">
  <xsd:element name="data" type="dataType"/>
  <xsd:complexType name="dataType">
    <xsd:sequence>
      <xsd:element name="A" type="AType"/>
      <xsd:element name="B" type="BType"/>
    </xsd:sequence>
  </xsd:complexType>
  <xsd:complexType name="BType">
    <xsd:sequence>
      <xsd:element name="file" type="xsd:string"/>
      <xsd:element name="path" type="xsd:string"/>
    </xsd:sequence>
  </xsd:complexType>
  <xsd:complexType name="AType">
    <xsd:sequence>
      <xsd:element name="file" type="xsd:string"/>
      <xsd:element name="path" type="xsd:string"/>
    </xsd:sequence>
  </xsd:complexType>
</xsd:schema> 
```

**笔记：**

*   使用[此网站](http://www.xmlforasp.net/codebank/system_xml_schema/buildschema/buildxmlschema.aspx)生成架构文件。

# templating - 将客户端模板组织成单个文件的方法？

> ID：10902691
> 
> 赞同：1
> 
> 时间：2012-06-05T18:22:12.253
> 
> 标签：templating, handlebars.js, client-side-templating

我正在使用 Handlebars.js，目前我所有的模板都位于脚本标签中，这些标签位于 .html 文件中，其中包含许多其他模板，也在脚本标签中。

```
<script type="text/template" id="template-1">
  <div>{{variable}}</div>
</script>

<script type="text/template" id="template-2">
  <div>{{variable}}</div>
</script>

<script type="text/template" id="template-3">
  <div>{{variable}}</div>
</script>

... 
```

然后我将此文件作为部分文件包含在服务器端。

这有以下缺点：

1.  一堆模板被塞进 HTML 文件中。
2.  查找给定的模板很乏味。

我正在寻找一种更好的方式来组织我的模板。我希望每个模板都存在于自己的文件中。例如：

```
/public/views/my_controller/my_action/some_template.html
/public/views/my_controller/my_action/some_other_template.html
/public/views/my_controller/my_other_action/another_template.html
/public/views/my_controller/my_other_action/yet_another_template.html
/public/views/shared/my_shared_template.html 
```

然后在我的视图顶部，在后端代码中，我可以在页面加载时包含这些模板，如下所示：

```
SomeTemplateLibrary.require(
    "/public/views/my_controller/my_action/*",
    "/public/views/shared/my_shared_template.html"
) 
```

这将包括 /public/views/my_controller/my_action/ 中的所有模板，还包括 /public/views/shared/my_shared_template.html。

**我的问题**：是否有提供此或类似功能的库？或者，有没有人有任何替代的组织建议？

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-08-17T09:56:58.897

RequireJS 是一个非常好的 AMD 风格依赖管理库。您实际上可以使用 requireJS 的“文本”插件将模板文件加载到您的 UI 组件中。将模板附加到 DOM 后，您可以使用任何 MVVM、MVC 库进行绑定，或者只使用 jQuery 事件作为您的逻辑。

我是 BoilerplateJS 的作者。BoilerplateJS 参考架构使用 requireJS 进行依赖管理。它还提供了一个参考实现来展示如何创建一个自包含的 UI 组件。自包含处理自己的视图模板、代码隐藏、css、本地化文件等。

![BoilerplateJS UI 组件中的文件](../Images/bd4ca4fffcee96ede4a8e9815400f7ce.png)

在boilerplateJS 主页的“UI 组件”下有更多信息可用。

[http://boilerplatejs.org/](http://boilerplatejs.org/)

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-06-07T16:51:47.460

我最终使用了 RequireJS，这几乎让我可以做到这一点。请参阅[http://aaronhardy.com/javascript/javascript-architecture-requirejs-dependency-management/](http://aaronhardy.com/javascript/javascript-architecture-requirejs-dependency-management/)。

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2012-07-17T22:51:01.070

我使用模板加载器，它在第一次需要时使用 ajax 加载模板，并将其缓存在本地以供将来请求。我还使用调试变量来确保在开发时不会缓存模板：

```
var template_loader = {
    templates_cache : {},
    load_template : function load_template (params, callback) {
        var template;
        if (this.templates_cache[params.url]){
            callback(this.templates_cache[params.url]);
        }
        else{
            if (debug){
                params.url = params.url + '?t=' + new Date().getTime(), //add timestamp for dev (avoid caching)
                console.log('avoid caching url in template loader...');
            }
            $.ajax({
                url: params.url,
                success: function(data) {
                    template  = Handlebars.compile(data);
                    if (params.cache){
                        this.templates_cache[params.url] =  template;
                    }
                    callback(template);
                }
            });
        }
    }
}; 
```

模板加载如下：

```
template_loader.load_template({url: '/templates/mytemplate.handlebars'}, function (template){
  var template_data = {}; //get your data
  $('#holder').html(template(template_data)); //render
}) 
```

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2013-03-27T07:31:02.533

我为此目的编写了这个方便的小 jquery 插件。

[https://github.com/cultofmetatron/handlebar-helper](https://github.com/cultofmetatron/handlebar-helper)

# aslr - 使用 ASLR 的校验和生成器

> ID：10902692
> 
> 赞同：2
> 
> 时间：2012-06-05T18:22:19.977
> 
> 标签：aslr

我是这里的新手。我想将 Windows 任务管理器中的 PID 与 Visual Studio 2010 中动态基础 ASLR 生成的校验和/哈希值相匹配？我已经在 Visual Studio 2010 中启用了 ASLR，但没有收到任何数据。知道怎么做吗？

线索：

1.  窗口功能`CreateToolhelp32Snapshot`
2.  `MODULEENTRY32`
3.  窗口功能`OpenProcess`

非常感谢伙计们。

吉格斯

# python - 在python中使用walk函数

> ID：10902695
> 
> 赞同：1
> 
> 时间：2012-06-05T18:22:32.780
> 
> 标签：python

我正在处理如下文件夹层次结构：

```
c:/users/rox/halogen/iodine/(some .txt files)
c:/users/rox/halogen/chlorine/(some .txt files)
c:/users/rox/inert/helium/(some .txt files)
c:/users/rox/inert/argon/(some .txt files) 
```

`os.walk`现在我正在通过使用和处理文件来遍历文件夹。
但问题是，如果我想在分析卤素下的所有子文件夹后生成分析输出到文件夹“卤素”，那么我该怎么办......我正在使用：

```
for root,dirs,files in os.walk(path,'*.txt):
    .....
    .......[processing file]
    out.write(.....)    # writing output in the folder which we are analyzing 
```

但是如何将输出写入位于两步后的文件夹（即卤素或惰性）..

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-06-05T18:27:53.650

在走之前打开您的输出文件。

```
out = open(os.path.join(path, outputfilename), 'w') 
```

然后走上处理输入的路径

```
for root,dirs,files in os.walk(path,'*.txt):
    .....
    out.write(..) 
```

这样你就已经知道根路径了。否则，如果您确定您的路径仅退后两步。

```
os.path.join(current_path, '..', '..') 
```

会给你文件夹路径，后退两步

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-06-05T18:32:28.903

您可以使用正在处理的目录中的相对路径打开输出文件，如下所示：

```
for root, dirs, files in os.walk(path, '*.txt'):
    out = open(os.path.join(root, '..', '..'), 'a')
    out.write(...) 
```

# javascript - 串口不工作？

> ID：10902704
> 
> 赞同：10
> 
> 时间：2012-06-05T18:23:25.610
> 
> 标签：javascript, node.js, socket.io, arduino, node-serialport

我制作了一个程序，向我的 arduino 发送数据，该程序检测发送的内容，然后根据按下的键打开正确的引脚。

在我的 Windows 计算机上使用 arduino 软件时，arduino 草图工作正常，我可以通过发送 WAS 或 D 来打开和关闭每个引脚。

通过节点发送时，arduino 上的 RX 灯闪烁，但没有其他反应。

任何人都可以帮忙吗？

Node.js 程序：

```
var httpServer = require('http').createServer(function(req, response){ /* Serve your static files */ })
httpServer.listen(8080);

var nowjs = require("now");
var everyone = nowjs.initialize(httpServer);

everyone.now.logStuff = function(msg){
    console.log(msg);
}

var SerialPort = require('serialport2').SerialPort;
var assert = require('assert');

var portName;

if (process.platform == 'win32') {
  portName = 'COM4';
} else if (process.platform == 'darwin') {
  portName = '/dev/cu.usbserial-A800eFN5';
} else {
  portName = '/dev/ttyUSB0';
}

var readData = '';
var sp = new SerialPort();

sp.on('close', function (err) {
  console.log('port closed');
});

sp.on('error', function (err) {
  console.error("error", err);
});

sp.on('open', function () {
  console.log('port opened... Press reset on the Arduino.');
});

sp.open(portName, {
  baudRate: 9600,
  dataBits: 8,
  parity: 'none',
  stopBits: 1,
  flowControl: false
});

everyone.now.forward = function() {
sp.write("w");
}

everyone.now.back = function() {
sp.write("s");
}

everyone.now.left = function() {
sp.write("a");
}

everyone.now.right = function() {
sp.write("d");
}

sp.on('data', function(data) {
  console.log(data.toString());
}); 
```

阿杜诺程序：

```
void setup(){
  Serial.begin(9600);
  Serial.write("READY");
  //Set all the pins we need to output pins
  pinMode(8, OUTPUT);
  pinMode(9, OUTPUT);
  pinMode(10, OUTPUT);
  pinMode(11, OUTPUT);
}

void loop (){
  if (Serial.available() > 0) {

    //read serial as a character
    char ser = Serial.read();
    Serial.write(ser);
    //NOTE because the serial is read as "char" and not "int", the read value must be compared to character numbers
    //hence the quotes around the numbers in the case statement
    switch (ser) {
      case 'w':
        move(8);
        break;
      case 's':
        move(9);
        break;
      case 'a':
        move(10);
        break;
      case 'q':
        move(10);
        move(8);        
        break;
      case 'd':
        move(11);
        break;
      case 'e':
        move(11);
        move(8);
        break;
    }
  }
}

void move(int pin){
  Serial.print(pin);  
  digitalWrite(pin, HIGH);
  delay(1);
  digitalWrite(pin, LOW);
} 
```

* * *

## 回答 #1

> 赞同：9
> 
> 时间：2012-06-06T20:39:05.850

我最近涉足这个。当 Arduino 接收到来自 Arduino IDE 以外的大多数设备的串行通信时，它会自动重置。这就是为什么您可以从 IDE 发送但不能从 node.js 发送的原因。

我有一个 Uno，并在 Reset 和 Ground 之间放置了一个电容器。这是一个包含有关该主题的一些很好信息的页面。
祝你好运。 [http://arduino.cc/playground/Main/DisablingAutoResetOnSerialConnection](http://arduino.cc/playground/Main/DisablingAutoResetOnSerialConnection)

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2013-08-21T13:51:58.987

我每天都使用 node 通过 usb 或 bt 向我的 Arduino 发送操作，它在这两种情况下都很好用。我认为你的问题来自于发送信件。您应该使用字母的 ascii 值发送一个缓冲区，就像这样：

```
myPort.write(Buffer([myValueToBeSent])); 
```

另外，为此，我认为您最好使用一些“逻辑”接口，包括数据标题、操作数量等。这对您来说不是必需的，但它将使您的代码更加健壮并且将来更容易修改。

这是我如何做的一个例子。首先，节点：

```
var dataHeader = 0x0f, //beginning of the data stream, very useful if you intend to send a batch of actions
myFirstAction = 0x01,
mySecondAction = 0x02,
myThirdAction = 0x03; 
```

然后你像以前一样打电话给他们：

```
everyone.now.MyBatchOfActions = function() {
    sp.write(Buffer([dataHeader]));

    sp.write(Buffer([0x03])); // this is the number of actions for the Arduino code

    sp.write(Buffer([myFirstAction]));
    sp.write(Buffer([mySecondAction]));
    sp.write(Buffer([myThirdAction]));
} 
```

这样，Arduino 上的 Serial.read() 数据很容易：（请注意，您需要在某处定义数据页眉和数据页脚）

```
void readCommands(){
    while(Serial.available() > 0){

        // Read first byte of stream.
        uint8_t numberOfActions;
        uint8_t recievedByte = Serial.read();

        // If first byte is equal to dataHeader, lets do
        if(recievedByte == DATA_HEADER){
            delay(10);

            // Get the number of actions to execute
            numberOfActions = Serial.read();

            delay(10);

            // Execute each actions
            for (uint8_t i = 0 ; i < numberOfActions ; i++){

                // Get action type
                actionType = Serial.read();

                if(actionType == 0x01){
                    // do you first action
                }
                else if(actionType == 0x02{
                    // do your second action
                }
                else if(actionType == 0x03){
                    // do your third action
                }
            }
        }
    }
} 
```

我希望我很清楚，我希望它有所帮助！干杯!

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2013-01-09T18:34:02.103

关于电容器和复位问题...在串行控制线之一之间有一个小电容器，并在后期型号的 Arduino 上复位。该电容器会在端口打开时使 Arduino 复位，但不会干扰正常的串行操作。

此重置技巧允许代码上传以在上传过程中重置 Arduino。当 Arduino 启动时，代码引导加载程序在加载的代码运行之前首先运行一小段时间。

上传过程是：重启启动boot loader的Arduino，在Arduino IDE中启动上传过程，建立通讯，上传，然后运行加载的代码。当 Arduino 启动时，它会等待上传一小段时间，如果没有收到，它会继续运行代码。

我发现这非常有用，因为它允许我们通过关闭和打开端口来有效地重置 Arduino。在旧的 Arduino 中，没有这个电容器，您必须在正确的时间按下重置按钮才能上传代码。时间安排使得 Arduino 在开始上传代码之前要花更多的时间等待。

在这里描述的问题中，我不相信他因为使用了重置技巧而遇到任何麻烦。在他打开串口的时候应该只有重置Arduino的效果，从他的信息来看，这是一个期望的副作用。

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2018-07-30T13:32:47.717

在我的情况下，问题是重置，但串行端口已打开 - 但在重置完成之前无法写入。在写入端口之前延迟 3 秒解决了这个问题。编写 ASCII 不是问题。

# email - Python mailer-0.7：权限被拒绝错误

> ID：10902705
> 
> 赞同：0
> 
> 时间：2012-06-05T18:23:28.173
> 
> 标签：email, python-2.7

我正在尝试安装 Python mailer-0.7，但出现权限错误。我不是 Mac OS 专家。任何人都可以请给出简单的指示来修复。

谢谢

错误信息如下

```
 error: /Library/Python/2.7/site-packages/mailer.py: Permission denied 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-06-05T18:27:15.723

啊哈 - 我在脚本开头添加了“sudo”并安装了它。

# iphone - 如何使用 CocoaAsyncSocket 读取数据？

> ID：10902710
> 
> 赞同：4
> 
> 时间：2012-06-05T18:23:34.020
> 
> 标签：iphone, ios, sockets, cocoaasyncsocket

我在我的 appDelegate方法中创建了一个*TCP 套接字连接。*`didFinishLaunchingWithOptions`这很容易，我已经成功连接到我的服务器。在我的视图中从服务器读取数据时遇到很大困难。**我一直在浏览有关如何使用CocoaAsyncSocket**适当（逐步）读取数据的教程，但我没有遇到任何有用的东西。

这是我的 appDelegate 中的代码：

```
-(BOOL)application:(UIApplication *)application didFinishLaunchingWithOptions:(NSDictionary *)launchOptions
{
    socket = [[AsyncSocket alloc] initWithDelegate:self];
    [self connect];

    self.window = [[[UIWindow alloc] initWithFrame:[[UIScreen mainScreen] bounds]] autorelease];
    // Override point for customization after application launch.
    self.viewController = [[[tekMatrixViewController alloc] initWithNibName:@"tekMatrixViewController" bundle:nil] autorelease];
    self.window.rootViewController = self.viewController;
    [self.window makeKeyAndVisible];
    return YES;
} 
```

这是我的连接方法，位于 appDelegate 文件的底部：

```
- (void)connect 
{
    [socket connectToHost:@"9.5.3.3" onPort:11005 error:nil];
} 
```

那是容易的部分。我现在需要从服务器读取数据。我知道需要创建某种**NSData**或**NSMutableData对象来获取我从服务器读取的数据的值。**我只是在找到任何指导我正确方向的教程或文档方面非常不成功。有几种不同的读取功能，一些具有不同的参数等。如果有人能指出我深入了解这个的资源*（我是新手，毕竟=P）*我真的很感激 - 或者如果有人知道实现此目标的简单方法，并且不介意在此处提供示例代码：D

这是我正在使用的库： [CocoaAsyncSocket](https://github.com/robbiehanson/CocoaAsyncSocket/tree/master/RunLoop)。我正在使用图书馆`AsyncSocket.h`和`AsyncSocket.m`

我已经坚持了几个小时，所以任何帮助将不胜感激。

谢谢！

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-06-05T18:49:08.800

这应该有效：

```
- (void)onSocket:(AsyncSocket *)sock didReadData:(NSData *)data withTag:(long)tag
{
    NSData *strData = [data subdataWithRange:NSMakeRange(0, [data length])];
    NSString *msg = [[NSString alloc] initWithData:strData encoding:NSUTF8StringEncoding];
    if(msg)
    {
        NSLog(@"RX:%@",msg);
    }
} 
```

您还应该实现一些其他委托方法，例如：

```
- (void)onSocket:(AsyncSocket *)sock willDisconnectWithError:(NSError *)err
{
    NSLog(@"error - disconnecting");
    //you'd probably want to start reconnecting procedure here...
}

- (void)onSocketDidDisconnect:(AsyncSocket *)sock
{
    NSLog(@"disconnected");
}

- (void)onSocket:(AsyncSocket *)sock didConnectToHost:(NSString *)host port:(UInt16)port
{
    NSLog(@"connected");
} 
```

编辑：如果我没记错的话，图书馆有一些文档和一些示例。

# java - RESTful Web Service的返回值，考虑空值

> ID：10902711
> 
> 赞同：4
> 
> 时间：2012-06-05T18:23:34.417
> 
> 标签：java, rest, unmarshalling

我正在为我的 RESTful Web 服务创建一个客户端。在这种情况下，我的服务器不会总是返回预期的对象（例如，在给定参数上找不到任何东西，所以返回为 NULL）。

```
@GET
@Path("/person/{name}")
@Produces("application/xml")
public Person getPerson(@PathParam("name") String name) {
    return people.byName(name);
} 
```

如果未找到给定名称，byName() 方法将返回 NULL。在解组给定对象时，这将引发异常。产生 if/else 语句或以不同方式处理返回的最常见和最干净的方法是什么？

```
JAXBContext jcUnmarshaller = JAXBContext.newInstance(Person.class);
Unmarshaller unmarshaller = jcUnmarshaller.createUnmarshaller();
return (Person) unmarshaller.unmarshal(connection.getInputStream()); 
```

**解决方案**

```
getPerson( ) throws WebApplicationException { 
    throw new WebApplicationException(404);
} 
```

* * *

## 回答 #1

> 赞同：8
> 
> 时间：2012-06-05T18:44:37.160

处理这种情况的惯用方法是返回 404 Not Found 响应代码。使用[jax-rs](/questions/tagged/jax-rs "显示标记为“jax-rs”的问题")你可以抛出[`WebApplicationException`](http://jsr311.java.net/nonav/javadoc/javax/ws/rs/WebApplicationException.html#WebApplicationException(int))：

```
@GET
@Path("/person/{name}")
@Produces("application/xml")
public Person getPerson(@PathParam("name") String name) {
    Person personOrNull = people.byName(name);
    if(personOrNull == null) {
      throw new WebApplicationException(404);
    }   
    return personOrNull;
} 
```

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-06-05T18:38:33.947

如果您正在寻找纯 REST 服务，则应在未找到人员时返回 HTTP 响应代码 404 - Not Found。所以，它看起来像这样：

```
public Person getPerson(@PathParam("name") String name) {
    Person person = people.byName(name);
    if (null != person) {
       return person
    }
    else {
       //return 404 response code (not sure how to do that with what you're using)
    }
} 
```

# ms-access - 控制源 If 语句

> ID：10902712
> 
> 赞同：3
> 
> 时间：2012-06-05T18:23:35.150
> 
> 标签：ms-access, vba, ms-access-2003

如果输入的值> 0，我希望访问自动计算输出。所以我将以下代码放在文本框属性的“控制源”字段中，它给了我一个错误。Number 应从 Text052 中获取，并应在 Text054 中输出。

这是代码：

```
If Text052.value > 0 then
Text054.value = Val([Text052].[Value])/2
end if 
```

错误：“您输入的表达式包含无效语法”。“您已经在没有运算符的情况下输入了操作数”

我不确定如何在文本框属性的控制源字段中编写语法。请指教。

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-06-05T18:32:38.537

在Text054的控制源中，尝试：

```
=IIf([Text052] > 0,[Text052]/2, "N/A") 
```

“N/A”可以是你需要的任何东西，包括 null。

# objective-c - 是否可以在多个对象上取消 PerformSelector？

> ID：10902713
> 
> 赞同：3
> 
> 时间：2012-06-05T18:23:35.427
> 
> 标签：objective-c, ios, cocoa-touch

我有几个类可以调用 performSelector:afterDelay。

在某些情况下，我想取消所有这些。

但是，所有 cancelPerformSelector 类型的方法都采用一个目标，因此似乎没有办法一次性取消所有内容（因为有不同的目标）？

除非指定 nil 作为目标会取消一切吗？

或者可以将目标指定为 [NSRunLoop mainRunLoop] 以取消所有内容，例如

```
[NSObject cancelPreviousPerformRequestsWithTarget:[NSRunLoop mainRunLoop]] 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-06-06T10:29:47.180

Assuming you have a view controller declared similar to the following:

```
@interface CarViewController : UIViewController

@property (strong) id myObject;

@end 
```

Also assuming you've registered the request for perform selector with the `myObject` instance somewhere in your implementation like the code below:

```
[self.myObject performSelector:@selector(someSelector) withObject:nil afterDelay:0.0]; 
```

For sake of argument, you want your view controller to cancel all the previous perform requests before it is unloaded from memory, your `-viewWillUnload` message would look like:

```
- (void)viewWillUnload {
    [NSObject cancelPreviousPerformRequestsWithTarget:self.myObject]
} 
```

This would cancel all the perform requests registered for that particular instance. As Joe pointed out, if you are not keeping a strong reference to your objects by yourself and you're storing those objects in a `NSArray`, you need to iterate that array and call `+cancelPreviousPerformRequestsWithTarget:` for each element of the array, or even `NSArray`'s `-enumerateObjectsUsingBlock:`:

```
- (void)viewWillUnload {
    [myArray enumerateObjectsUsingBlock:^(id obj, NSUInteger idx, BOOL *stop) {
        [NSObject cancelPreviousPerformRequestsWithTarget:obj];
    }];
} 
```

Hope this helps.

# c++ - CloseHandle 调用上的无效句柄异常？

> ID：10902715
> 
> 赞同：0
> 
> 时间：2012-06-05T18:23:40.477
> 
> 标签：c++, windows, shared-memory, handles

在我的应用程序中，我打开了一个共享内存的句柄，我读取/写入/读取。我像这样打开手柄：

```
//Map the shared memory
     d_to_mbx_mem_arr[idx] = reinterpret_cast<Byte*>(MapViewOfFile(to_mem_h,    // handle to map object
                                                       FILE_MAP_ALL_ACCESS, // read/write permission
                                                       0,
                                                       0,
                                                       MAILBOX_SIZE_e)); 
```

此处设置的变量是一个 Byte* 数组（Byte 是 unsigned char 的别名），因此我进行了重新解释转换，因此我可以像使用标准 Byte 指针一样使用句柄。

后来我尝试通过以下方式释放手柄：

```
CloseHandle(d_to_mbx_mem_arr[p_tool_id]);
d_to_mbx_mem_arr[p_tool_id] = NULL; 
```

由于在 CloseHandle 之后值被设置为 NULL 并且调用此方法的代码只是单线程的，我知道我只调用了一次。但是，当我调用它时，会收到以下警告：

“FMLib_Comm_Layer.exe 中 0x7c90e4ff (ntdll.dll) 的第一次机会异常：0xC0000008：指定了无效句柄。”

当我因警告而中断时，我看到它试图关闭的句柄的值为“0x01c90000”，这对我来说对于共享内存指针来说似乎是合理的。有没有人看到这个实现有问题，或者我应该假设我在其他地方搞砸了？

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-06-05T18:34:12.710

您需要调用`CloseHandle()`on `to_mem_h`，而不是 on 的返回值`MapViewOfFile()`（请参见`MapViewOfFile()` [此处](http://msdn.microsoft.com/en-us/library/windows/desktop/aa366551.aspx)的使用示例——该示例调用`UnmapViewOfFile()`的返回值`MapViewOfFile()`并调用`CloseHandle()`的第一个参数`MapViewOfFile()`）

# javascript - 一个 JavaScript 函数调用其他几个函数

> ID：10902716
> 
> 赞同：0
> 
> 时间：2012-06-05T18:23:48.493
> 
> 标签：javascript

我知道 javascript 函数完全能够调用其他函数。我已经使用过几次了。

目前我正在编写一个脚本，该脚本将找到某个标签的 html 元素，并根据它的标签类型添加一些文本。

```
function foo() {
dealWithH1();
dealWithH2();           
dealWithH3();
etc...          
} 
```

我已经对这样的功能进行了一些搜索，但我似乎无法找到一个明确的、一致的答案来确定这是否是一种好的做法。我喜欢这种方式，因为有很多函数调用要进行，而且它保持井井有条。我只是想确保在我深入研究之前确保做这样的事情没有什么明显的问题。该函数`foo()`没有任何用途，只是被调用，`onLoad`然后调用所有这些其他函数。

这可以吗，还是有更受鼓励的方法来完成这项工作？

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-06-05T18:43:48.220

It's perfectly reasonable to create a pseudo-DSL of operations that are composed of functions.

Based on your description of what the `dealWith...` functions do, though, I think you might want to generalize your functions more, something like:

```
function foo() {
    tagInsert('h1', 'Text to append to h1 tag');
    tagInsert('h2', 'Text to append to h2 tag');
    tagInsert('h3', 'Text to append to h3 tag');
} 
```

Now that the *essence* of the function has been distilled (append text to all tags of a specified type), and the variables of the function have been parameterized (the type of tag and the text to append), you could just as easily do something like:

```
var tags = {
    'h1': {
        'en': 'Hello',
        'es': 'Hola',
        'sr@latin': 'Zdravo'
    },
    'h2': {
        'en': 'Goodbye',
        'es': 'Adios',
        'sr@latin': 'Do vidjenja'
    },
    'h3': {
        'en': 'Green',
        'es'; 'Verde',
        'sr@latin': 'Zelena'
    }
};
function foo(locale) {
    for(var tag in tags) {
        tagInsert(tag, tags[tag][locale]);
    }
} 
```

*Composability* of functions is greatly improved when as much about the operation you will perform is deferred until the function is actually called -- you can then use the exact same function to now not just append a fixed set of text to the tags, but to do so in whatever language the user prefers to use.

This flexibility can of course be taken to absurd lengths and you'd never get anything done, but it's good to think of your function as a set operator: what is the input to your function (declared explicitly as a variable or implicitly by accessing a global) and what operation is performed to produce the new output set?

If it doesn't take much extra effort to write the function in the generic way versus the specific case you're dealing with, then write it that way and you can re-use that function whenever you need to do a similar action but with different inputs.

### Remember...

Don't take my `tagInsert` definition at face value, I know barely *anything* about what you're actually trying to do, and maybe that generalization doesn't really make sense. The point is that *you* as the developer should have a better idea of what you're trying to accomplish.

If you follow [Larry Wall's Virtues of a Programmer](http://en.m.wikipedia.org/wiki/Larry_Wall#Virtues_of_a_programmer), you should be trying to minimize the amount of extra work you have to do, and your functions will reach the right degree of composability versus complexity.

Functions calling functions is the whole point of a function -- you avoid the need to rewrite it over and over again; just dividing a massive imperative declaration of actions to perform into a series of functions is *not* the point of a function. What are the repetitive patterns in the imperative code and how can you be as **lazy** as possible?

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2012-06-05T18:37:46.000

假设你写的代码不是完全的伪代码，我绝对不会那样做：你会用很多不同的函数污染全局范围。您可以使用闭包将这些函数包装在本地范围内，或者使它们成为对象的方法。

此外，似乎`dealWithTagH1`，`dealWithTagH2`等等，也有在里面寻找这些特定标签并修改它们的目的。这是你可以推断的逻辑。所以，你应该有一些东西可以得到你感兴趣的所有类型的标签，然后调用这些`dealWith`函数。这样，您只有一个正在寻找标签的代码，以及处理该特定标签的不同功能。你以这种方式解耦了更多的逻辑。如果您想以一种极端的方式进行说明，则可以使用诸如策略模式之类的东西。

我还将修改命名，给每个“策略”一个更好`dealWithTagH1`的名称（它非常通用，阅读该代码的开发人员对实际实施的策略没有任何暗示）。

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2012-06-05T18:33:41.477

在几乎任何主流语言中，函数/方法都很便宜，并且从维护和可读性的角度来看，具有尽可能小的和内聚的函数是一个很好的实践。您不应该害怕创建函数、提取它们、在层次结构中调用它们（一个函数调用另一个函数，而后者又调用第三个函数）。您还应该学习如何使用[递归](/questions/tagged/recursion "显示标记为“递归”的问题")。

函数（包括匿名函数和闭包）是 JavaScript 中的主要构建块，它们无处不在，例如事件处理程序和回调。

避免比屏幕更长的功能（有人说 10 行，一些 5 - 只是保持简短）。还可以使用函数来减少重复。例如，有些事情告诉我，你们所有人`dealWithH*()`都非常相似。关于什么：

```
function foo() {
  dealWithTag('h1');
  dealWithTag('h2');           
  dealWithTag('h3');
  //etc...          
} 
```

当然，在您的情况下，单独的函数可能是一个更好的主意，但只需从抽象的角度考虑并尝试概括问题。

# asp.net - 在 2.0 站点下运行 .Net 4.0 网站

> ID：10902718
> 
> 赞同：1
> 
> 时间：2012-06-05T18:23:52.857
> 
> 标签：asp.net, iis-7, .net-4.0, application-pool

我们在 .Net 2.0 应用程序池中运行我们的默认网站。我们已经在它下面创建了一个新应用程序，在 ASP 4.0（集成）应用程序池中运行。我们一直在收到有关 4.0 应用程序中的 system.web.extensions 部分组的消息，等等。当我们从父应用的 web.config 文件中删除该部分时，这些消息就会消失，但我们宁愿不这样做。我们正在使用 IIS 7。

是否有将 4.0 网站作为应用程序在早期版本的 .Net 下运行的指导或最佳实践？似乎与父母的 web.config 存在相当多的冲突，我不确定如何最好地最小化它们。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-06-15T17:50:43.350

如果您不能（或不想）转换主站点以使所有内容都是相同的 .NET 版本，那么您要做的就是从不同的应用程序池中运行它们。

让 4.0 应用程序用完以 4.0 模式运行的应用程序池。让 2.0 应用程序用尽以 2.0 模式运行的应用程序池。

（注意，您必须小心应用程序之间的任何依赖关系）

# c++ - Safari 和 getaddrinfo 设置

> ID：10902728
> 
> 赞同：1
> 
> 时间：2012-06-05T18:24:15.567
> 
> 标签：c++, macos, safari, getaddrinfo, interposing

我编写了一个小型动态库，它插入对 getaddrinfo 和连接的调用。我在 Firefox 和 Safari 上使用 DYLD_INSERT_LIBRARIES 插入这个库，以劫持对 www.apple.com 的请求并将它们发送到 www.microsoft.com。该代码适用于 Firefox，但是当 Safari 调用我的插入函数时，它忽略了重定向。

我想知道是否有人了解为什么 Safari 会忽略重定向，以及是否有办法（可能通过 addrinfo 标志）让 Safari 像 Firefox 一样运行。我的代码清单如下。

```
// -*- mode: c++ -*-

#include <sys/socket.h>
#include <sys/types.h>
#include <sys/uio.h>
#include <netdb.h>
#include <arpa/inet.h>
#include <unistd.h>
#include <dlfcn.h>
#include <dns_sd.h>
#include <cstdio>
#include <cstdlib>
#include <cstdarg>
#include <cstring>
#include <string>

typedef int (*connect_type) (int, struct sockaddr const*, socklen_t);
typedef int (*getaddrinfo_type)(
        const char*, const char*, struct addrinfo const*, addrinfo**);

connect_type     real_connect     = 0;
getaddrinfo_type real_getaddrinfo = 0;

int
do_getaddrinfo_impl(const char* nodename, const char* servname,
                    struct addrinfo const* hints, struct addrinfo** ppai) 
{
    int result = real_getaddrinfo (nodename, servname, hints, ppai);
    if(result != 0) {
        fprintf(stderr, "! real_getaddrinfo error on %s: %s\n", nodename, gai_strerror(result));
    }

    return result;
}

int
do_getaddrinfo(const char* nodename, const char* servname,
               struct addrinfo const* hints, struct addrinfo** ppai) 
{
    if (0 == nodename) {
        return do_getaddrinfo_impl(nodename, servname, hints, ppai);
    }

    if (hints->ai_family == AF_INET6) {
        printf ("# do_getaddrinfo : IPv6 resolution\n");
        return do_getaddrinfo_impl(nodename, servname, hints, ppai);
    }

    if (   hints->ai_flags & AI_PASSIVE 
        || hints->ai_flags & AI_CANONNAME 
        || hints->ai_flags & AI_NUMERICHOST 
        || hints->ai_flags & AI_NUMERICSERV) {
        printf ("# do_getaddrinfo : unsupported resolution flags\n");
        return do_getaddrinfo_impl (nodename, servname, hints, ppai);
    }

    if ((hints->ai_flags & AI_V4MAPPED) && !(hints->ai_flags & AI_ALL)) {
        printf ("# do_getaddrinfo : unsupported IPv6-mapping\n");
        return do_getaddrinfo_impl (nodename, servname, hints, ppai);
    }

    // redirect requests for www.apple.com to microsoft at 65.55.57.80 (0x41373950)
    if(0 == strcmp(nodename, "www.apple.com")) {
        addrinfo* pai = (addrinfo*)calloc (1, sizeof (addrinfo));

        pai->ai_flags    = hints->ai_flags;
        pai->ai_family   = AF_INET;
        pai->ai_socktype = hints->ai_socktype;
        pai->ai_protocol = IPPROTO_TCP;
        pai->ai_addrlen  = sizeof (sockaddr_in);

        sockaddr* psa = reinterpret_cast< sockaddr* > (
            calloc (1, sizeof (sockaddr)));

        sockaddr_in& sain = reinterpret_cast< sockaddr_in& > (*psa);

#if !defined (POS_NO_SIN_LEN)
        sain.sin_len = sizeof *psa;
#endif // POS_NO_SIN_LEN

        sain.sin_family = AF_INET;
        sain.sin_addr.s_addr = htonl(0x41373950);

        pai->ai_addr = psa;
        pai->ai_canonname = 0;
        pai->ai_next = 0;

        *ppai = pai;

        return 0;
    }
    else {
        return do_getaddrinfo_impl(nodename, servname, hints, ppai);
    }
}

////////////////////////////////////////////////////////////////////////
extern "C" {

int
fake_getaddrinfo(const char* nodename, const char* servname,
                 struct addrinfo const* hints, struct addrinfo** ppai)
{
    if (real_getaddrinfo == 0)
        real_getaddrinfo = &getaddrinfo;

    return do_getaddrinfo (nodename, servname, hints, ppai);
}

int
fake_connect (int s, sockaddr const* ptr, socklen_t len)
{
    if (real_connect == 0)
        real_connect = &connect;

    return do_connect (s, ptr, len);
}

__attribute__((used)) static struct {
    void const *a, *b; 
} arr [] __attribute__ ((section ("__DATA, __interpose"))) = {
    { (void*)fake_connect, (void*)connect },
    { (void*)fake_getaddrinfo, (void*)getaddrinfo }
};

} // extern "C" 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-06-12T14:22:21.290

通过跟进，我发现 Safari 在hints 参数中设置了 AI_NUMERICHOST 标志，因此将该标志作为不受支持的分辨率标志的测试导致我的重定向代码从未被调用。我删除了 AI_NUMERICHOST 的测试并添加了以下位来解决问题。

```
 if (hints->ai_flags & AI_NUMERICHOST) {

    //
    // Safari makes name resolution requests using AI_NUMERICHOST
    //

    in_addr_t addr = inet_addr (nodename);
    if (addr != INADDR_NONE)
        return do_getaddrinfo_impl (nodename, servname, hints, ppai);
} 
```

希望对其他人有所帮助。

# d3.js - d3.js 中的核密度平滑

> ID：10902729
> 
> 赞同：8
> 
> 时间：2012-06-05T18:24:29.243
> 
> 标签：d3.js

抱歉，我既不是统计专家，也不是 d3.js 专家。

我正在尝试叠加两个平滑直方图以显示两个相关分布中的重叠。

我想知道 d3.js 中内核密度或其他平滑的可用性。大约一年前似乎有一些关于该主题的活动，但我无法在主线 d3.js 代码中找到该功能。（关于内核密度估计的维基百科条目建议使用 d3 的“science.stats”函数，这些函数不在我的 d3.v2.js 下载中。）

它是否通过密度选项合并到直方图布局中？还是目前不可用？

* * *

## 回答 #1

> 赞同：11
> 
> 时间：2012-06-06T04:34:32.607

您要查找的示例位于[science.js](https://github.com/jasondavies/science.js) git 存储库的[kde 文件夹](https://github.com/jasondavies/science.js/tree/master/examples/kde)中，其中包括内核估计器。

这是它的样子： ![kde.js 运行中的屏幕截图](../Images/36c05d62af531329b1c52d0a8115667e.png)

# powershell - 方法调用失败的方法命名项

> ID：10902730
> 
> 赞同：1
> 
> 时间：2012-06-05T18:24:42.863
> 
> 标签：powershell

我在使用下面的代码时遇到了一些问题。我试图弄清楚如何让输出适用于所有用户配置文件，而不仅仅是当前用户。如果我使用 $shell.NameSpace(34) 代码有效（两行注释掉）。但是当我尝试覆盖 shell.namespace 并手动添加路径时，我收到一个错误，即方法项不存在。想知道解决或解决此问题的最佳方法是什么。

实际错误消息：方法调用失败，因为 [System.String] 不包含名为“Items”的方法。

感谢您的帮助。

```
$shell = New-Object -ComObject Shell.Application
$colProfiles = Get-ChildItem "C:\Users\" -Name
#$hist = $shell.NameSpace(34)
#Write-Host $hist

foreach ( $userProfile in $colProfiles )
{
    [string]$hist = "C:\Users\$userProfile\AppData\Local\Microsoft\Windows\History"
    $date = ""
    $url = ""

    $hist.Items() | foreach {
        ""; ""; 
        if ($_.IsFolder) 
        {
            $siteFolder = $_.GetFolder
            $siteFolder.Items() | foreach {
                $site = $_
                ""; 
                if ($site.IsFolder) 
                {
                    $pageFolder  = $site.GetFolder
                    Write-Host $pageFolder
                    $pageFolder.Items() | foreach {
                        $url  = $pageFolder.GetDetailsOf($_,0)
                        $date = $pageFolder.GetDetailsOf($_,2)
                        echo "$date $url"
                    }
                }
            }
        }
    }
} 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-06-05T18:53:03.603

您将字符串视为文件夹对象。

改变：

```
[string]$hist = "C:\Users\$userProfile\AppData\Local\Microsoft\Windows\History" 
```

到：

```
$hist = Get-Item "C:\Users\$userProfile\AppData\Local\Microsoft\Windows\History" 
```

这将获取文件夹对象并允许您根据需要对其进行操作。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-06-05T19:02:34.200

根据文档，您可以从路径字符串创建命名空间对象。

[http://msdn.microsoft.com/en-us/library/windows/desktop/bb774085(v=vs.85).aspx](http://msdn.microsoft.com/en-us/library/windows/desktop/bb774085(v=vs.85).aspx)

所以你可以这样做：

```
$shell = New-Object -ComObject Shell.Application
$colProfiles = Get-ChildItem "C:\Users\" -Name

foreach ( $userProfile in $colProfiles )
{
   [string] $histPath = "C:\Users\$userProfile\AppData\Local\Microsoft\Windows\History"
   $hist = $shell.NameSpace($histPath)

    $date = ""
    $url = ""

    $hist.Items() | foreach {
        ""; ""; 
        if ($_.IsFolder) 
        {
            $siteFolder = $_.GetFolder
            $siteFolder.Items() | foreach {
                $site = $_
                ""; 
                if ($site.IsFolder) 
                {
                    $pageFolder  = $site.GetFolder
                    Write-Host $pageFolder
                    $pageFolder.Items() | foreach {
                        $url  = $pageFolder.GetDetailsOf($_,0)
                        $date = $pageFolder.GetDetailsOf($_,2)
                        echo "$date $url"
                    }
                }
            }
        }
    }
} 
```

# c# - C#反射日期时间？

> ID：10902731
> 
> 赞同：3
> 
> 时间：2012-06-05T18:24:43.400
> 
> 标签：c#

我在网上找不到任何可以帮助我解决这个问题的东西，如果有人可以帮助你，那将是一个救命稻草。

我的函数被赋予了一个属性名称和对象。使用反射它返回该属性的值。它工作得很好，但是如果我将它传递给 Nullable DateTime 它会给我 null 并且无论我尝试什么我都无法让它工作。

```
public static string GetPropValue(String name, Object obj)
{
 Type type = obj.GetType();
 System.Reflection.PropertyInfo info = type.GetProperty(name);
 if (info == null) { return null; }
 obj = info.GetValue(obj, null);
 return obj.ToString();
 } 
```

在上述函数中，obj 为空。我如何让它读取日期时间？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-06-05T18:34:05.547

您的代码很好 - 这会打印一天中的时间：

```
class Program
{
    public static string GetPropValue(String name, Object obj)
    {
        Type type = obj.GetType();
        System.Reflection.PropertyInfo info = type.GetProperty(name);
        if (info == null) { return null; }
        obj = info.GetValue(obj, null);
        return obj.ToString();
    }

    static void Main(string[] args)
    {
        var dt = GetPropValue("DtProp", new { DtProp = (DateTime?) DateTime.Now});
        Console.WriteLine(dt);
    }
} 
```

为避免空值异常，请将最后一行更改`GetPropValue`为：

```
return obj == null ? "(null)" : obj.ToString(); 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-06-05T18:48:42.740

这对我来说很好..

您确定您的 PropertyInfo 返回非 null 吗？

```
class Program
{
    static void Main(string[] args)
    {
        MyClass mc = new MyClass();
        mc.CurrentTime = DateTime.Now;
        Type t = typeof(MyClass);
        PropertyInfo pi= t.GetProperty("CurrentTime");
        object temp= pi.GetValue(mc, null);
        Console.WriteLine(temp);
        Console.ReadLine();
    }

}
public class MyClass
{
    private DateTime? currentTime;

    public DateTime? CurrentTime
    {
        get { return currentTime; }
        set { currentTime = value; }
    }
} 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-06-05T18:32:05.980

可空类型属于 类型[`Nullable<T>`](http://msdn.microsoft.com/en-us/library/b3h38hb0%28v=vs.100%29.aspx)，并具有两个属性：`HasValue`和`Value`。您首先需要`HasValue`检查是否`Value`已设置，然后您可以从`Value`.

~~您可以检查给定对象是否为 a`Nullable<T>`并在您的 中进行这些检查`GetPropValue`~~，或者您在此方法之外执行此逻辑并确保使用不可为空的值调用它。

**编辑**从头开始，[根据 MSDN](http://msdn.microsoft.com/en-us/library/ms366789.aspx) `GetType()` ，它总是为您提供底层类型。您确定要传递一个非空对象吗？

# charts - Highcharts 列颜色

> ID：10902733
> 
> 赞同：0
> 
> 时间：2012-06-05T18:24:50.400
> 
> 标签：charts, highcharts

我正在使用 Highcharts 构建一些图表

我的问题是：

我在饼图上的属性“大小”已经是 100%。我的 div 的高度和宽度分别为 234 和 424px，但饼图确实更小，并且这两个属性的大小都不会超过 130px...

有什么我可以使用的属性吗？

谢谢

更新：

好的，伙计们，找到了答案，我得到了一个更新版本的 highcharts 插件，唯一的问题是我的柱形图是黑色的大声笑，有什么想法吗？

更新 2：

我的列图表代码是：

//colorBar 参数只修改条的“悬停”

```
function graficoBarraSimples_init(paramX, paramY, colorBar, container, title)
{
var options = 
{
    chart: {
        renderTo: container,
        defaultSeriesType: 'column'
    },
        title: {
        text: ''
    },
    subtitle: {
        text: ''
    },

    yAxis: {
        min: 0,
        title: {
            text: 'Unidade'
        },
        tickPixelInterval: 50
    },
    tooltip: {
        formatter: function() {
            return '' + this.x +': '+ this.y ;
        }
    },
    xAxis: [],
    series:[]     
}

var i = 0;
var items = paramY.split(',');
var itemX = paramX.split(',');

var series = {
    type: 'column',
    color:[],
    data: []
};
var xAxis = {
    categories: [],
    title: { text:title}
};

$.each(items, function(itemNo, item) {
    series.name = itemX[itemNo];
    series.data.push(parseFloat(item));
    series.color.push(CorValor(colorBar));          

    i++;
});

xAxis.categories=  itemX;
options.xAxis.push(xAxis);
options.series.push(series);
var chart = new Highcharts.Chart(options);

  } 
```

**最后更新**

各位，又发现问题了。显然，Highcharts 不接受对图形颜色的“注入”或“推送”，就像这条线一样：

`series.color.push(CorValor(colorBar));`

所以，我只是直接更改了“系列”属性：

```
 var series = {
    type: 'column',
    color:CorValor(colorBar),
        data: []
}; 
```

并排除`series.color.push(CorValor(colorBar));`线路。

谢谢！

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-06-06T17:25:34.423

正如您所说，最后一个问题是在以下对象中颜色必须是字符串：

```
var series = {
    type: 'column',
    color:[], // change to color:'',
    data: []
}; 
```

然后你必须设置而不是推送：

```
$.each(items, function(itemNo, item) {
    series.name = itemX[itemNo];
    series.data.push(parseFloat(item));
    series.color = CorValor(colorBar);          

    i++;
}); 
```

# css - 在 Firefox 中的 table-cell 元素上定位上下文

> ID：10902743
> 
> 赞同：1
> 
> 时间：2012-06-05T18:25:26.707
> 
> 标签：css, firefox, css-position

通常，我们可以将父元素设置为子元素`absolute`定位的上下文，如下所示：

```
#parent {
    position: relative;
}

#child {
    position: absolute;
    top: 0;
    left: 0;
} 
```

这一切都很好，但是当父级的`display`属性设置为 时`table-cell`，它在 Firefox 中不起作用。子元素的定位上下文将是其父元素上方最近的定位祖先。

值得注意的是，这适用于其他*任何地方*。在 IE8、IE9、Safari、Chrome 和 Opera 中测试。

在这里查看小提琴：http: [//jsfiddle.net/RZ5Vx/](http://jsfiddle.net/RZ5Vx/)

另外，请参阅[this fiddle with parent's `display`set to`inline-block`](http://jsfiddle.net/RZ5Vx/1/)，它在 Firefox 中有效。

* * *

那么，这是一个错误吗？如果是这样，有没有办法解决它？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-06-05T18:31:58.880

A`table-cell`意味着在 a 内`table`，所以：

看到这个[工作小提琴！](http://jsfiddle.net/zuul/RZ5Vx/2/)

```
div {
    display: table;      /* this line */
    line-height: 28px;
    padding: 0 20px;
    background: #ddd;
    position: relative;
} 
```

**注意：** 由于您没有`table`在其中设置它。

您可以看到**显示声明**的这个[quirksmode](http://www.quirksmode.org/css/display.html#table)。

 *** * *

## 已编辑

来自[W3C 推荐 :: Tables](http://www.w3.org/TR/CSS2/tables.html)它读取

> 表格元素上属性 'position'、'float'、'margin-*'、'top'、'right'、'bottom' 和 'left' 的计算值用于表格包装盒而不是表格盒子; 所有其他不可继承属性的值都用于表格盒而不是表格包装盒。（如果表格元素的值不用于表格和表格包装盒，则使用初始值。）

这不是一个错误，更像是一个**状态设计的**东西！请看[这个](http://www.w3.org/TR/CSS2/tables.html#model)！

* * *

## 已编辑

要包括根据问题要求对评论进行的解决方法：

> 那么，~~这是一个错误吗？如果是这样，~~有没有办法解决它？

**可能*的解决*方法是：**

用`div`as `position:relative;` [See Fiddle 包裹元素！](http://jsfiddle.net/zuul/RZ5Vx/6/)

```
#wrapper {
    position: relative;
} 
```

**注意：**最实用的解决方案！

用`div`as `position:relative;` [See Fiddle 包裹内部元素！](http://jsfiddle.net/zuul/RZ5Vx/7/)

```
#innerWrapper {
    position: relative;
} 
```

**注意：**需要在 innerWrapper 上声明原始元素的一些定义！**

# javascript - jquery/underscore/backbone/parse 模块的 Require.js 加载超时

> ID：10902744
> 
> 赞同：3
> 
> 时间：2012-06-05T18:25:28.173
> 
> 标签：javascript, backbone.js, requirejs, router

> 未捕获的错误：模块加载超时：order!libs/jquery/jquery-min order!libs/underscore/underscore-min order!libs/parse/parse-min libs/jquery/jquery-min libs/underscore/underscore-min libs /parse/parse-min 骨干网 [http://requirejs.org/docs/errors.html#timeout](http://requirejs.org/docs/errors.html#timeout)

我在 Chrome 的“网络”选项卡下没有 404 请求，也没有脚本错误，所以我不属于该问题的常见错误/修复（根据 requirejs.org）。

当我查看我的网络时，我看到脚本按以下顺序加载：

```
require.js
main.js
app.js <-- required by main.js
order.js <-- used in main.js to require the next 4 scripts (which aren't AMD)
jquery-min.js <-- required by main.js
underscore-min.js <-- required by main.js
backbone-min.js <-- required by main.js
parse-min.js <-- required by main.js
router.js
login.js
text.js 
```

这对我来说似乎是正确的。下面是我的`main.js`,`app.js`和代码`router.js`。

主.js：

```
// Author: Thomas Davis <thomasalwyndavis@gmail.com>
// Filename: main.js

// Require.js allows us to configure shortcut alias
// Their usage will become more apparent futher along in the tutorial.
require.config( {
    paths : {
        jQuery : 'libs/jquery/jquery-min',
        Underscore : 'libs/underscore/underscore-min',
        Backbone : 'libs/backbone/backbone-min',
        Parse : 'libs/parse/parse-min',
        templates : '../templates'
    }
});

require( [
    // Load our app module and pass it to our definition function
    'app',

    // Some plugins have to be loaded in order due to their non AMD compliance
    // Because these scripts are not "modules" they do not pass any values to the
    // definition function below
    'order!libs/jquery/jquery-min',
    'order!libs/underscore/underscore-min',
    'order!libs/backbone/backbone-min',
    'order!libs/parse/parse-min'
],
function(App) {
    // The "app" dependency is passed in as "App"
    // Again, the other dependencies passed in are not "AMD" therefore
    // don't pass a parameter to this function
    App.initialize();
}); 
```

应用程序.js：

```
// Filename: app.js
define( [ 'jQuery', 'Underscore', 'Parse', 'router' ],
function($, _, Parse, Router) {
    var initialize = function() {

        Parse.$ = $;

        // Initialize Parse with your Parse application javascript keys
        Parse.initialize("HIDDEN", "ALSO HIDDEN");

        // Pass in our Router module and call it's initialize function
        Router.initialize();
    };

    return {
        initialize : initialize
    };
}); 
```

路由器.js：

```
// Filename: router.js
define( [ 'jQuery', 'Underscore', 'Backbone', 'Parse', 'views/home/login', ],
function($, _, Backbone, Parse, loginView) {
    var AppRouter = Backbone.Router.extend( {
        routes : {
            // Default
            '*actions' : 'defaultAction'
        },
        defaultAction : function(actions) {
            // We have no matching route, lets display the home page
            loginView.render();
        }
    });

    var initialize = function() {
        var app_router = new AppRouter;
        Backbone.history.start();
    };
    return {
        initialize : initialize
    };
}); 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-08-29T17:01:58.170

尝试使用 requirejs-jquery。它的 requirejs 版本已准备好与 jquery 一起使用并尝试使用 shim 配置。

请参阅此链接：[https ://github.com/jrburke/require-jquery](https://github.com/jrburke/require-jquery)

垫片配置示例：

```
require.config({
  paths: {
    "jqueryUI": "libs/jquery-ui",
    "jquery": "libs/jquery-1.9.1",
    "underscore": "libs/underscore-min",
    "backbone": "libs/backbone-min"
  },
  shim: {
    jqueryUI:{
         deps: ["jquery"],
         exports:"$"
    },
    underscore: {
      exports: "_"
    },
    backbone: {
      deps: ["underscore", "jquery"],
      exports: "Backbone"
    }
  }

}); 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-02-16T19:49:52.053

我刚刚发布了一个开源工具包，可以帮助解决此类问题。它是许多开源工具的组合，它为您提供了一个开箱即用的 requirejs 主干应用程序。

它提供单个命令来运行：dev web server、jasmine 单浏览器测试运行器、jasmine js-test-driver 多浏览器测试运行器，以及 JavaScript 和 CSS 的连接/缩小。它还输出应用程序的未缩小版本以进行生产调试，预编译您的车把模板，并支持国际化。

无需设置。它只是工作。

[http://github.com/davidjnelson/agilejs](http://github.com/davidjnelson/agilejs)

* * *

## 回答 #3

> 赞同：-8
> 
> 时间：2012-06-06T06:30:24.820

我切换到`main.js`在我的外部和我的内部加载 JS 文件`index.html`：

```
<script type="text/javascript" src="http://cdnjs.cloudflare.com/ajax/libs/underscore.js/1.3.3/underscore-min.js"></script>
<script type="text/javascript" src="http://ajax.googleapis.com/ajax/libs/jquery/1.7.2/jquery.min.js"></script>
<script type="text/javascript" src="http://www.parsecdn.com/js/parse-1.0.0.min.js"></script>
<script type="text/javascript" src="http://cdnjs.cloudflare.com/ajax/libs/backbone.js/0.9.2/backbone-min.js"></script>
<script data-main="js/main" src="js/libs/require/require.js"></script> 
```

# binary-tree - Enforcing horizontal node ordering in a .dot tree

> ID：10902745
> 
> 赞同：21
> 
> 时间：2012-06-05T18:25:28.370
> 
> 标签：binary-tree, graphviz, dot

I am trying to recreate an example diagram for a binary search tree with GraphViz. This is how it should look in the end:

![enter image description here](../Images/3883fafba97fea4dc255d5e7d6e1ab6f.png)

This is my first attempt:

```
digraph G {
    nodesep=0.3;
    ranksep=0.2;
    margin=0.1;
    node [shape=circle];
    edge [arrowsize=0.8];
    6 -> 4;
    6 -> 11;
    4 -> 2;
    4 -> 5;
    2 -> 1;
    2 -> 3;
    11 -> 8;
    11 -> 14;
    8 -> 7;
    8 -> 10;
    10 -> 9;
    14 -> 13;
    14 -> 16;
    13 -> 12;
    16 -> 15;
    16 -> 17;
} 
```

But unfortunately GraphViz doesn't care about the horizontal positions of the tree, so I get:

![enter image description here](../Images/3a58fe01cb44e24f58f6aa64749d9125.png)

How can I add constraints so that the horizontal positions of the vertices reflects their total ordering?

* * *

## 回答 #1

> 赞同：26
> 
> 时间：2012-06-05T22:04:46.843

[您可以按照graphviz 关于平衡树的常见问题解答](http://www.graphviz.org/content/FaqBalanceTree)中提出的添加不可见节点和不可见边的常用方法，以及使用边权重等。在一些[简单的情况下](https://stackoverflow.com/q/3105923/63733)，这就足够了。

但是有一个更好的解决方案：Graphviz 带有一个名为**gvpr**（*图形模式扫描和处理语言*）的工具，它允许

> 将输入图复制到其输出，可能会转换其结构和属性，创建新图或打印任意信息

并且由于[Emden R. Gansner 已经通过创建一个可以很好地布局二叉树的脚本完成了所有工作](https://mailman.research.att.com/pipermail/graphviz-interest/2010q2/007101.html)，下面是如何做到这一点（所有功劳归于 ERG）：

将以下 gvpr 脚本保存到名为 的文件中`tree.gv`：

```
BEGIN {
  double tw[node_t];    // width of tree rooted at node
  double nw[node_t];    // width of node
  double xoff[node_t];  // x offset of root from left side of its tree
  double sp = 36;       // extra space between left and right subtrees
  double wd, w, w1, w2; 
  double x, y, z;
  edge_t e1, e2;
  node_t n;
}
BEG_G {
  $.bb = "";
  $tvtype=TV_postfwd;   // visit root after all children visited
}
N {
  sscanf ($.width, "%f", &w);
  w *= 72;  // convert inches to points
  nw[$] = w;
  if ($.outdegree == 0) {
    tw[$] = w;
    xoff[$] = w/2.0;
  }
  else if ($.outdegree == 1) {
    e1 = fstout($);
    w1 = tw[e1.head];    
    tw[$] = w1 + (sp+w)/2.0;
    if (e1.side == "left")
      xoff[$] = tw[$] - w/2.0;
    else
      xoff[$] = w/2.0;
  }
  else {
    e1 = fstout($);
    w1 = tw[e1.head];    
    e2 = nxtout(e1);
    w2 = tw[e2.head];    
    wd = w1 + w2 + sp;
    if (w > wd)
      wd = w;
    tw[$] = wd;
    xoff[$] = w1 + sp/2.0;
  }
}
BEG_G {
  $tvtype=TV_fwd;   // visit root first, then children
}
N {
  if ($.indegree == 0) {
    sscanf ($.pos, "%f,%f", &x, &y);
    $.pos = sprintf("0,%f", y);
  }
  if ($.outdegree == 0) return;
  sscanf ($.pos, "%f,%f", &x, &y);
  wd = tw[$];
  e1 = fstout($);
  n = e1.head;
  sscanf (n.pos, "%f,%f", &z, &y);
  if ($.outdegree == 1) {
    if (e1.side == "left")
      n.pos = sprintf("%f,%f",  x - tw[n] - sp/2.0 + xoff[n], y);
    else
      n.pos = sprintf("%f,%f", x + sp/2.0 + xoff[n], y);
  }
  else {
    n.pos = sprintf("%f,%f", x - tw[n] - sp/2.0 + xoff[n], y);
    e2 = nxtout(e1);
    n = e2.head;
    sscanf (n.pos, "%f,%f", &z, &y);
    n.pos = sprintf("%f,%f", x + sp/2.0 + xoff[n], y);
  }
} 
```

假设您的包含图形的点文件被称为`binarytree.gv`，您可以执行以下行：

```
dot binarytree.gv | gvpr -c -ftree.gv | neato -n -Tpng -o binarytree.png 
```

结果是：

![多亏了 Emden R. Gansner，二叉树的布局很好，带有 graphiv 和 gvpr 脚本](../Images/46d77e2d8c8d43004e9de4ec845f89df.png)

通过在脚本中切换一两行，您甚至可以让单个子节点转到左侧而不是右侧。

# delphi - 创建复合控件是否明智？

> ID：10902749
> 
> 赞同：3
> 
> 时间：2012-06-05T18:25:37.240
> 
> 标签：delphi, components

我有这个应用程序在许多地方重用了一种成语。有一个 TPanel，上面有一些标签和按钮。目的是允许用户选择日期范围。

![这是运行时这样一个面板的示例](../Images/99938ee429682a080bec9d11c12fc437.png)

“&Dates”标题是一个标签，“All Dates”部分是第二个标签。当用户单击“选择”按钮时，会弹出一个表单，向用户显示一对日期/时间控件和确定/取消按钮。如果用户在选择某些日期后点击确定，则第二个标签将更改为“从 mm/dd/yyyy 到 mm/dd/yyyy”。

创建一个封装这些控件的组件是否合理？我一直在查看组件编写者的各种资源，但它们似乎没有指出我正在考虑的问题，例如处理按钮的 onclick 事件。如果这是一个合理的尝试，我也很感激关于如何制作这种“复合控件”的描述的指针。

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2012-06-05T21:22:57.990

这是合理的，是的。

要创建这样的组件，只需从例如 TCustomPanel 派生一个新类，并将子组件添加为类中的字段。

像这样：

```
TMyDatePicker = class(TCustomPanel)
protected
  FChooseButton: TButton;
  FClearButton: TButton;
public
  constructor Create(Owner: TComponent); override; 
end;

constructor TMyDatePicker.Create(Owner: TComponent)
begin
  // Inherited
  Inherited;

  // Create Choose Button
  FChooseButton := TButton.Create(Self);
  FChooseButton.Parent := Self;
  FChooseButton.Align := alRight;
  FChooseButton.Caption := 'Choose';

  // Create Clear Button
  FClearButton := TButton.Create(Self);
  FClearButton.Parent := Self;
  FClearButton.Align := alRight;
  FClearButton.Caption := 'Clear';
end; 
```

要添加事件处理程序，只需向您的类添加新的受保护过程。

例如：

```
procedure TMyDatePicker.HandleChooseButtonClick(Sender: TObject)
begin
  // Do whatever you want to do when the choose button is clicked
end; 
```

然后将事件处理程序连接到选择按钮的 OnClick 事件（这应该在类的 Create 方法中完成）：

```
FChooseButton.OnClick := HandleChooseButtonClick; 
```

当然，还有比这更多的功能，例如微调按钮的对齐方式和添加图标。您还需要创建自己的事件，例如 OnDateSelected 或 OnDateModified。

但是，除此之外，我认为上面的例子至少应该让你继续前进。:)

* * *

## 回答 #2

> 赞同：5
> 
> 时间：2012-06-05T21:33:13.367

是的，构建这样的组件绝对是明智的，因为它节省了大量的编码。

以下是半可视化创建它们的指南：[How to Build Aggregate/Composite Components in Delphi](http://kb.cnblogs.com/a/455755/ "如何构建聚合组件")

本质上，本文档中概述的过程是：

1.  在 Delphi 中的表单内设计组件的布局，将所有组件放置在 TPanel（或其后代）内。
2.  选择并复制面板并将其粘贴到文本文件中。
3.  将“=”的所有实例替换为“:=”，并在每行的末尾添加一个分号。
4.  将所有 DFM“对象”声明行转换为适当的对象构造函数代码，将所有可视控件的父级设置为容器面板。
5.  清理任何剩余的代码。位图需要放在资源文件中。
6.  将这个新的帕斯卡代码放在组件的创建构造函数中。在构造函数中，将对象部分分组到相应的子组件创建者下。

* * *

我认为文档错误的地方是，例如，示例组件是从 TPanel 继承的，而对我来说，使用 TCustomPanel 并仅公开您想要的方法更有意义。

但它也解释了如何添加 OnClick 处理程序等。

这种方法的优点是您可以直观地完成 Panel 中组件的布局。

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2012-06-06T07:58:38.163

开发复合控件的一种非常实用的方法是使用[TFrame](http://docs.embarcadero.com/products/rad_studio/delphiAndcpp2009/HelpUpdate2/EN/html/delphivclwin32/Forms_TFrame.html)作为它的基础。

这样，您可以直观地设计控件，并使用事件或继承

您需要注意几件事，但总而言之，这比手动编码所有内容要容易得多（就像其他一些答案所暗示的那样）。

需要注意的事项（不是完整列表，但很接近）：

*   [别忘了小枝](http://wiert.me/2009/07/16/delphi-frames-as-visual-components-dont-forget-your-sprig/)
*   在设计时（在 TFrame 中和将复合控件放在设计图面上时），标记为 Visible=True 的子控件仍然可见。解决此问题的两种方法：销毁这些控件，或将它们移动到不可见区域（顶部/左侧为负值或大于父级的宽度/高度的值）
*   将 TFrame 后代注册为组件，其中 TFrame 后代也是项目的一部分，有时会使 IDE 感到困惑。简单的解决方案：调用 TFrame 后代“TMyCustomControl”，从中派生“TMyControl”，并将“TMyControl”注册为组件。

作为奖励，您不必从 TPanel 中删除斜角/边框和标题。

* * *

## 回答 #4

> 赞同：2
> 
> 时间：2012-06-06T12:12:01.617

还有一种方法是使组件组成为[组件模板](http://delphi.about.com/cs/howto/ht/htcomptempl.htm)。

# audio - Portaudio: Importing sound example into my buffer

> ID：10902750
> 
> 赞同：1
> 
> 时间：2012-06-05T18:25:39.570
> 
> 标签：audio, buffer, signal-processing, simulation, portaudio

I am in need of your help once again.

**Short version:** Can you import sound clips into Portaudio? If not, where can I get 'realistic' sound examples, that is converted into discrete values which I can store into my sound buffers?

**Long version:** As a part of a mini-project, I have decided to implement HRTF. For this, I am using PortAudio (http://www.portaudio.com/) which is a C/C++ library for sound manipulation. As a part of that I am trying to simulate ITD (Inneraural Time Difference). For that purpose, PortAudio generates a sinus wave and stores it into a buffer, though the sinus wave is problematic to use for testing. Thats why I am in need of a 'realistic' sound example. The issue is, I can't seem to find any PortAudio function that allows me to import sound clips and store them into my buffer. As a second option I could look up a sound clip which is converted into discrete values and is stored into an array. Then I could copy that array into my own buffer, though I have no clue of where to look for such arrays, and I don't even know if they exist.

So the question is: Do PortAudio allow you to import your own sound clip, and if not, where can I find arrays in which sound clips are stored in discrete values.

If there are any questions regarding to my question, pleas ask. Best regards - Marc Pilgaard

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-06-06T13:25:04.680

PortAudio 只是一个音频播放/录音库。它既不操纵声音，也不带来任何加载/存储声音的设施。它只是实现了缓冲区--> 扬声器和麦克风--> 缓冲区。

如果我理解正确，您正在寻找一个库，可以让您将 wav 或 mp3 文件加载到缓冲区中，而该缓冲区又可以由 portaudio 播放。由于您已经在 C 世界中，因此最好的方法是使用[libsndfile](http://www.mega-nerd.com/libsndfile/)，它基本上模仿标准 C 文件访问接口来加载和编写 pcm 文件，例如 wav。

# c# - 使用正则表达式常量返回两个标签之间的字符串

> ID：10902751
> 
> 赞同：2
> 
> 时间：2012-06-05T18:25:40.687
> 
> 标签：c#, regex

我正在尝试在 C# 中使用

```
 var added = Regex.Match(Text,
 "\[BEGINTAG\](.+?)\[\/ENDTAG\]",RegexOptions.None); 
```

在文本字符串中返回标签 [BEGINTAG] 和 [/ENDTAG] 之间的字符串。我无法弄清楚我的正则表达式常量有什么问题。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-06-05T18:28:29.040

你的正则表达式很好。您只需要提取第 1 组（括号之间匹配的内容）

在 C# 中，这变成

```
Regex regexObj = new Regex(@"\[BEGINTAG\](.+?)\[/ENDTAG\]");
resultString = regexObj.Match(subjectString).Groups[1].Value; 
```

让我知道这个是否奏效

另外，仅供参考，你不需要像你一样逃跑。这也很好：

```
\[BEGINTAG](.+?)\[/ENDTAG] 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-06-05T18:36:41.937

`@`一个可能的问题是您的字符串之前没有 a ，因此 C# 将`\`字符视为 C# 转义而不是正则表达式转义。

Buckley 的回答显示了如何为字符串添加前缀，`@`以便将其`\`作为正则表达式转义处理。在 C# 中将这种格式用于正则表达式几乎总是更好。否则你最终会得到这样的结果。

```
var added = Regex.Match(Text, 
    "\\[BEGINTAG\\](.+?)\\]\\/ENDTAG\\]", RegexOptions.None); 
```

我觉得很难读。

# c++ - boost::asio 错误？销毁 io_service 之前的 task_io_service

> ID：10902761
> 
> 赞同：5
> 
> 时间：2012-06-05T18:26:35.563
> 
> 标签：c++, multithreading, networking, boost, boost-asio

我在我的代码中发现了这个奇怪的错误。这是我设法得到的自包含测试用例。

```
#include <memory>
#include <thread>
#include <stack>
#include <system_error>

#include <boost/asio.hpp>

using boost::asio::io_service;
using std::placeholders::_1;

class async_service
{
public:
    async_service();
    async_service(size_t number_threads);
    ~async_service();

    async_service(const async_service&) = delete;
    void operator=(const async_service&) = delete;

    void spawn();
    void shutdown();

    io_service& get_service();
    const io_service& get_service() const;

private:
    io_service service_;
    io_service::work* work_;
    std::vector<std::thread> threads_;
};

async_service::async_service()
  : work_(nullptr)
{
}

async_service::async_service(size_t number_threads)
  : work_(nullptr)
{
    for (size_t i = 0; i < number_threads; ++i)
        spawn();
}

async_service::~async_service()
{
    std::cout << __PRETTY_FUNCTION__ << std::endl;
    service_.stop();
    for (std::thread& t: threads_)
        t.join();
}

void run_service(io_service* service)
{
    service->run();
}

void async_service::spawn()
{
    if (!work_)
        work_ = new io_service::work(service_);
    threads_.push_back(std::thread(run_service, &service_));
}
void async_service::shutdown()
{
    delete work_;
    work_ = nullptr;
}

io_service& async_service::get_service()
{
    return service_;
}
const io_service& async_service::get_service() const
{
    return service_;
}

// --------------------------------------------------------------

template <typename... Args>
class subscriber
  : public std::enable_shared_from_this<subscriber<Args...>>
{
public:
    typedef std::function<void (Args...)> handler_type;
    typedef std::shared_ptr<subscriber<Args...>> ptr;

    subscriber(async_service& service)
      : strand_(service.get_service())
    {
    }

    void subscribe(handler_type handle)
    {
        strand_.dispatch(
            std::bind(&subscriber<Args...>::do_subscribe,
                this->shared_from_this(), handle));
    }

    void relay(Args... params)
    {
        strand_.dispatch(
            std::bind(&subscriber<Args...>::do_relay,
                this->shared_from_this(), std::forward<Args>(params)...));
    }

private:
    typedef std::stack<handler_type> registry_stack;

    void do_subscribe(handler_type handle)
    {
        registry_.push(handle);
    }

    void do_relay(Args... params)
    {
        registry_stack notify_copy = std::move(registry_);
        registry_ = registry_stack();
        while (!notify_copy.empty())
        {
            notify_copy.top()(params...);
            notify_copy.pop();
        }
        assert(notify_copy.empty());
    }

    io_service::strand strand_;
    registry_stack registry_;
};

// --------------------------------------------------------

class lala_channel_proxy
  : public std::enable_shared_from_this<lala_channel_proxy>
{
public:
    typedef std::function<void (const std::error_code&)> receive_inventory_handler;

    lala_channel_proxy(async_service& service)
      : strand_(service.get_service())
    {
        inventory_subscriber_ =
            std::make_shared<inventory_subscriber_type>(service);
    }

    void start()
    {
        read_header();
    }

    void subscribe_inventory(receive_inventory_handler handle_receive)
    {
        inventory_subscriber_->subscribe(handle_receive);
    }

    typedef subscriber<const std::error_code&> inventory_subscriber_type;

    void read_header()
    {
        strand_.post(
            std::bind(&lala_channel_proxy::handle_read_header,
                shared_from_this(), boost::system::error_code(), 0));
    }

    void handle_read_header(const boost::system::error_code& ec,
        size_t bytes_transferred)
    {
        std::cout << "inventory ----------" << std::endl;
        inventory_subscriber_->relay(std::error_code());
        sleep(1.0);
        read_header();
    }

    io_service::strand strand_;
    inventory_subscriber_type::ptr inventory_subscriber_;
};

typedef std::shared_ptr<lala_channel_proxy> lala_channel_proxy_ptr;

class lala_channel
{
public:
    lala_channel(async_service& service)
    {
        lala_channel_proxy_ptr proxy =
            std::make_shared<lala_channel_proxy>(service);
        proxy->start();
        //weak_proxy_ = proxy;
        strong_proxy_ = proxy;
    }
    void subscribe_inventory(
        lala_channel_proxy::receive_inventory_handler handle_receive)
    {
        lala_channel_proxy_ptr proxy = strong_proxy_;
        proxy->subscribe_inventory(handle_receive);
    }
    lala_channel_proxy_ptr strong_proxy_;
    // Normally this has a weak pointer to the channel pimpl to allow
    // it to die, but whether it uses a weak_ptr or shared_ptr makes
    // no difference.
    //std::weak_ptr<channel_proxy> weak_proxy_;
};

typedef std::shared_ptr<lala_channel> lala_channel_ptr;
//typedef lala_channel_proxy_ptr lala_channel_ptr;

class session
  : public std::enable_shared_from_this<session>
{
public:
    typedef std::function<void (const std::error_code&)> completion_handler;

    session(async_service& service, async_service& mempool_service,
            async_service& disk_service)
      : strand_(service.get_service()),
        txpool_strand_(mempool_service.get_service()),
        chain_strand_(disk_service.get_service()), service_(service)
    {
    }

    void start()
    {
        auto this_ptr = shared_from_this();
        lala_channel_ptr node =
            std::make_shared<lala_channel>(service_);
        node->subscribe_inventory(
            std::bind(&session::inventory, this_ptr, _1, node));
        for (size_t i = 0; i < 500; ++i)
        {
            chain_strand_.post(
                []()
                {
                    std::cout << "HERE!" << std::endl;
                    sleep(2);
                });
        }
    }

private:
    void inventory(const std::error_code& ec, lala_channel_ptr node)
    {
        if (ec)
        {
            std::cerr << ec.message() << std::endl;
            return;
        }
        auto this_ptr = shared_from_this();
        txpool_strand_.post([]() {});
        node->subscribe_inventory(
            std::bind(&session::inventory, this_ptr, _1, node));
    }

    async_service& service_;
    io_service::strand txpool_strand_, strand_, chain_strand_;
};

int main()
{
    // First level
    {
        // Bug only happens for this ordering of async_service's
        // That means it is only triggered when they are destroyed in
        // this reverse order.
        async_service network_service(1), disk_service(1), mempool_service(1);
        //async_service network_service(1), mempool_service(1), disk_service(1);
        //async_service disk_service(1), mempool_service(1), network_service(1);
        //async_service disk_service(1), network_service(1), mempool_service(1);
        //async_service mempool_service(1), disk_service(1), network_service(1);
        //async_service mempool_service(1), network_service(1), disk_service(1);

        // Second level
        {
            // Should be kept alive by io_service
            auto s = std::make_shared<session>(network_service, mempool_service, disk_service);
            s->start();
        }
        //network_service.shutdown();
        //disk_service.shutdown();
        //mempool_service.shutdown();
        sleep(3);
    // Never gets past here
    }
    std::cout << "Exiting..." << std::endl;
    return 0;
} 
```

当我运行它时，我得到了这个：

```
$ g++ -std=c++0x /tmp/ideone_y6OlI.cpp -lboost_system -pthread -ggdb
$ gdb a.out 
GNU gdb (Ubuntu/Linaro 7.4-2012.04-0ubuntu2) 7.4-2012.04
Copyright (C) 2012 Free Software Foundation, Inc.
License GPLv3+: GNU GPL version 3 or later <http://gnu.org/licenses/gpl.html>
This is free software: you are free to change and redistribute it.
There is NO WARRANTY, to the extent permitted by law.  Type "show copying"
and "show warranty" for details.
This GDB was configured as "x86_64-linux-gnu".
For bug reporting instructions, please see:
<http://bugs.launchpad.net/gdb-linaro/>...
Reading symbols from /home/genjix/src/brokenlibbtc/a.out...done.
(gdb) r
Starting program: /home/genjix/src/brokenlibbtc/a.out 
[Thread debugging using libthread_db enabled]
Using host libthread_db library "/lib/x86_64-linux-gnu/libthread_db.so.1".
[New Thread 0x7ffff6deb700 (LWP 28098)]
[New Thread 0x7ffff65ea700 (LWP 28099)]
[New Thread 0x7ffff5de9700 (LWP 28100)]
inventory ----------
HERE!
inventory ----------
HERE!
inventory ----------
async_service::~async_service()
async_service::~async_service()
[Thread 0x7ffff5de9700 (LWP 28100) exited]

Program received signal SIGSEGV, Segmentation fault.
[Switching to Thread 0x7ffff6deb700 (LWP 28098)]
0x0000000000405873 in boost::asio::detail::task_io_service::wake_one_idle_thread_and_unlock (this=0x6255e0, lock=...) at /usr/include/boost/asio/detail/impl/task_io_service.ipp:461
461     first_idle_thread_ = idle_thread->next; 
```

与 boost 1.48 和 1.49 相同。

我想知道为什么会这样。它只发生在这种高度特殊的配置中。如果我更改任何内容，则该错误不会发生。

async_service 是 io_service 的便捷包装器。奇怪的是，如果我将 io_service 更改为 *io_service 并且不删除 io_service 那么错误就不会发生......但肯定没关系吗？

如果您查看 main() 中的源代码，则创建了 3 个 async_service 对象。它们中的每一个都管理单个 io_service 的生命周期。

```
 // Bug only happens for this ordering of async_service's
        // That means it is only triggered when they are destroyed in
        // this reverse order.
        async_service network_service(1), disk_service(1), mempool_service(1);
        //async_service network_service(1), mempool_service(1), disk_service(1);
        //async_service disk_service(1), mempool_service(1), network_service(1);
        //async_service disk_service(1), network_service(1), mempool_service(1);
        //async_service mempool_service(1), disk_service(1), network_service(1);
        //async_service mempool_service(1), network_service(1), disk_service(1); 
```

订阅者类表示特定事件的订阅...调用事物。session 和 channel 的东西是从一个更大的程序改编而来的，所以它们看起来很纠结/令人困惑。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-06-06T13:11:00.737

一个问题是`session::inventory`，当从构造函数的第一个参数下的线程执行时（`network_service`在失败的情况下），尝试访问使用第二个参数 ( `mempool_service`) 初始化的链。

```
void inventory(const std::error_code& ec, lala_channel_ptr node)
{
    if (ec)
    {
        std::cerr << ec.message() << std::endl;
        return;
    }
    auto this_ptr = shared_from_this();
    txpool_strand_.post([]() {}); // <-- one problem is here.
    node->subscribe_inventory(
        std::bind(&session::inventory, this_ptr, _1, node));
} 
```

给定销毁顺序，`mempool_service`已经被销毁，并且在帖子执行期间的某处访问将失败。

# javascript - MongoDB - 无法将 Mongo 对象插入数据库

> ID：10902763
> 
> 赞同：0
> 
> 时间：2012-06-05T18:26:40.073
> 
> 标签：javascript, json, mongodb

我有一个这样的脚本：

```
use first_db;

advertisers = db.agencies.find( 'my query which returns things correctly );

close first_db;
use second_db;

db.advertisers.insert(advertisers); 
```

我得到了这个例外：

```
Tue Jun  5 14:15:07 TypeError: advertisers.toJSON is not a function (shell):1 
```

我应该做些什么？把原来的结果改成json再插入？还是我需要使用一些功能？

谢谢！

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-06-05T18:41:27.520

您的问题是 find() 返回游标，而不是实际数据。您需要遍历游标中的结果并将它们存储在变量中。

试着看看手册中的这些地方：[find()](http://docs.mongodb.org/manual/reference/javascript/#query-and-update-methods)和[cursors](http://docs.mongodb.org/manual/reference/javascript/#cursor-methods)。

# ravendb - 在服务器上保护 RavenDb Management Studio

> ID：10902764
> 
> 赞同：2
> 
> 时间：2012-06-05T18:26:42.263
> 
> 标签：ravendb

我在 IIS 中为我​​的服务器上的 RavenDb 创建了一个网站。我目前可以在 127.0.0.10 上访问 Raven Studio，但我也想让服务器可以在公共 IP 上访问。有什么方法可以保护 Management Studio，以便在我访问之前要求输入用户名/密码？

我已将 Raven/AnonymousAccess 设置为 none，但我似乎无法弄清楚如何设置用户名/密码组合以登录。

**更新**

好的，我已经解决了。它实际上不是在 IIS 中配置的 RavenDb 设置（感谢 Fitzchack）。创建 RavenDb IIS 网站后，我采取了以下步骤：

1.  创建 Windows 用户 (RavenDbAdmin)
2.  禁用网站的匿名身份验证
3.  为网站启用 Windows 身份验证

现在访问公共服务器 IP 上的站点时，它将首先要求输入密码。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-06-06T07:33:22.810

RavenDB 默认使用 windows 帐户（也支持 OAuth），因此您需要创建一个 windows 帐户并使用其凭据才能登录到 RavenDB。

只是为了另一层安全，您还可以限制 IIS 网站本身，这将迫使您在工作室中登录两次。这不是必需的，但这是一个很好的选择。

# git - 找到一个 git 分支路径

> ID：10902769
> 
> 赞同：0
> 
> 时间：2012-06-05T18:27:06.890
> 
> 标签：git, terminal

我正在尝试向某人发送 git 存储库的克隆链接。

所以这将使我能够克隆主人。但是我想给出一个分支克隆路径，我将如何使用终端找到该路径。该分支是一个远程分支。

```
git@git.blobkick.com:mainproject.git 
```

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-06-05T18:30:20.910

我不确定“分支克隆路径”是什么意思，但也许这会有所帮助......

当您克隆远程存储库时，您将获得所有分支。您通常会在`master`分支上结束，之后您可以使用以下`checkout`命令选择您的分支：

```
$ git clone git@git.blobkick.com:mainproject.git
$ cd mainproject
$ git checkout mybranch 
```

如果您想在一个分支上结束，而不是`master`作为`clone`操作的一部分，您可以使用`-b`( `--branch`) 选项：

```
$ git clone -b mybranch git@git.blobkick.com:mainproject.git 
```

`mybranch`这将在完成克隆操作后将本地存储库切换到分支。这与上面的命令序列相同（嗯，除了`cd`命令）。

如果这不能解决您的问题，请告诉我。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-06-05T18:34:43.210

只需寻找远程分支

```
git branch -r 
```

之后通过克隆它

```
git clone git@git.blobkick.com:mainproject.git -b remote_branchh 
```

# java - 在 ApplicationContext 被销毁之前立即触发的 Spring 关闭事件？

> ID：10902775
> 
> 赞同：7
> 
> 时间：2012-06-05T18:27:28.140
> 
> 标签：java, spring, destroy, applicationcontext

我正在寻找一个拦截器或触发器来知道，所有上下文 bean 都被销毁并且 applicationcontext 实例即将自行销毁。所以我可以在应用程序生命周期结束时执行一个进程。

有这个事件类型 ContextClosedEvent，它与我想做的事情很接近，但是它会在销毁 bean*后引发事件。*我认为它带有 applicationcontext 的 close() 方法。所以它不适合我的需要

有任何想法吗？

问候

阿里

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-06-06T03:15:12.657

您可以使用抽象应用程序上下文类的 registerShutDownHook() 方法。有关更多详细信息，请查看[此。](http://static.springsource.org/spring/docs/2.5.x/api/org/springframework/context/support/AbstractApplicationContext.html#registerShutdownHook%28%29)

**更新**

然后，您应该在 spring 上下文即将销毁时在最后要运行某些东西的方法之上尝试 @PreDestroy 注释。

希望这对您有所帮助。干杯。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2019-10-08T12:17:34.093

创建一个实现 SmartLifecycle 的 bean，getPhase 返回 Integer.MAX_VALUE。它的 stop() 方法将在任何其他停止或销毁方法之前执行。您可以在那里对活豆中的所有资源进行清理。

```
 ```
 @Component
    public class Terminator implements SmartLifecycle {

        private boolean started = true;

        @Override
        public void stop() {
            // CLEANUP CODE
        }
        @Override
        public void stop(Runnable callback) {
            stop();
            callback.run();
        }

        @Override
        public int getPhase() {
            return Integer.MAX_VALUE;
        }
        @Override
        public boolean isAutoStartup() {
            return true;
        }
        @Override
        public boolean isRunning() {
            return started;
        }

    } 
``` 
```

# c# - VideoCaptureDevice 帧率

> ID：10902778
> 
> 赞同：2
> 
> 时间：2012-06-05T18:27:37.887
> 
> 标签：c#, stream, frame, aforge, rate

我已经使用 Visual C# 语言创建了一个应用程序表单。我使用 aforge 库来显示来自我的网络摄像机的图像。问题是，如果我尝试处理我的图像，那么视频流处理速度很慢。所以视频延迟3-4秒才能显示。帧速率为 24fps。我认为如果我更改帧速率（例如 4fpm），那么流量会有所改善。那么如何使用 aforge 库更改帧速率。

这是我的代码：

```
MJPEGStream mpeg = new MJPEGStream();
                     AForge.Video.DirectShow.VideoCaptureDevice fcg = new AForge.Video.DirectShow.VideoCaptureDevice();                 
                     mpeg.Login = "xxx";
                     mpeg.Password = "xxx";
                     mpeg.Source = "http://192.168.1.xx:xx/videostream.cgi";
                     AsyncVideoSource asyncSource = new AsyncVideoSource(mpeg);                     
                     mpeg.NewFrame += new NewFrameEventHandler(FinalVideo_NewFrame);               
                     mpeg.Start();

     void FinalVideo_NewFrame(object sender, NewFrameEventArgs eventArgs)
                {
                    video = (Bitmap)eventArgs.Frame.Clone();
                    DisplaypictureBox.Image = video; 
                } 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-06-13T14:48:34.637

你试过这个吗？

```
fcg.DesiredFrameRate=5; 
```

看到这个：

[http://www.aforgenet.com/framework/docs/html/f9b0abf6-be44-6d8f-cac9-1cbf8fbd5a8c.htm](http://www.aforgenet.com/framework/docs/html/f9b0abf6-be44-6d8f-cac9-1cbf8fbd5a8c.htm)

# sql - Case When 条件下的计数函数

> ID：10902780
> 
> 赞同：4
> 
> 时间：2012-06-05T18:27:55.780
> 
> 标签：sql, oracle

谁能向我解释下面的 SQL 语句之间的区别？我可以看到存在差异，但我无法确定可以使它们产生不同结果的确切条件。顺便说一句，我认为该`distinct`子句在该领域没有什么不同，`user.id`因为所有 id 都已经是唯一的。查询的目的是计算唯一（非空）姓氏的数量。如果姓氏为空，则计为唯一。

我想这个问题的一般情况是在 case-when 语句中使用聚合函数。

在 Case-When 内计数：

```
SELECT 
    (case when (substr(u.name,40,40) <> '                                        ')
        then count(distinct(substr(u.name,40,40)))
        else count(u.id) 
    end) as "LAST_NAME",
FROM 
    users u
GROUP BY
    substr(u.name,40,40) 
```

Case-When in Count:

```
SELECT 
    count (distinct case when (substr(u.name,40,40) <> '                                        ')
        then substr(u.name,40,40)
        else to_char(u.id)
    end) as "LAST_NAME",
FROM 
    users u
GROUP BY
    substr(u.name,40,40) 
```

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-06-05T18:36:43.433

如果`user.id`是 a `PRIMARY KEY`，这些查询在语义上是相同的，尽管它们可能会产生不同的执行计划。

它们将返回`1`所有非空姓氏，因为您正在计算其组内的 group-by expession 的不同值，根据定义，这将是一个。

对于空姓氏，第一个查询将本质上返回`COUNT(u.id)`，第二个查询将返回`COUNT(DISTINCT TO_CHAR(u.id))`，鉴于这`u.id`是唯一的，它们是相同的。

我相信您需要`GROUP BY`从第二个查询中删除：

```
SELECT  count (distinct case when (substr(u.name,40,40) <> '                                        ')
        then substr(u.name,40,40)
        else to_char(u.id)
    end) as "LAST_NAME",
FROM 
    users u 
```

# c++ - 你使用什么类型的负面图像进行类似 Haar 的特征训练有关系吗？

> ID：10902784
> 
> 赞同：2
> 
> 时间：2012-06-05T18:28:13.613
> 
> 标签：c++, opencv, object-detection

我正在尝试使用 OpenCV 进行一些对象跟踪，并且我阅读了一些关于 Haar 类功能的信息。它说我需要大约 5000 - 10000 张负片图像才能做到这一点，我使用的图像越多，结果就越准确。但我想知道我使用什么类型的图像有关系吗？

例如，我将在房间内跟踪物体，那么只获取室内环境的负片图像会更好吗？或者它并不重要，因为它只是负面的？

如果这听起来像一个愚蠢的问题，我深表歉意，但我想 100% 确定这一点，以确保我的结果尽可能准确。

谢谢

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-06-05T18:51:07.837

从我读到的内容来看，这些负面图像是室外还是室内并不重要，但我认为你应该同时拥有这两种类型。

顺便说一句，在这个[链接](http://note.sonots.com/SciSoftware/haartraining.html#Kuranov)Naotoshi Seo 说他使用了大约 3000 个负样本，所以如果您计划使用 5000 到 10000 个，您可能可以同时使用室内和室外负样本。只需确保这些负样本中没有您感兴趣的对象。

希望这可以帮助。

# visual-studio-2010 - 开发包含其他文档内容类型的自定义 DocumentSet 内容类型

> ID：10902785
> 
> 赞同：1
> 
> 时间：2012-06-05T18:28:15.003
> 
> 标签：visual-studio-2010, sharepoint, sharepoint-2010, sharepoint-api, document-set

我已经成功地在 Visual Studio 中创建并部署了几个新的内容类型。一种基于文档集，另一种基于文档。我想要做的是指定文档集的“默认内容类型”、“共享列”。我还想将我的添加文档类型指定在文档集的“允许的内容类型”列表中。我知道如何在 SharePoint UI 中做到这一点。我怎样才能通过我的 Visual Studio 项目实现这一点？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-06-07T17:09:00.597

**我找到了解决方案，感谢 Google 将我与比我更聪明的人联系起来。在 Document Set 的 Content Type 中，您需要指定 XMLDocuments 元素。**

```
<XmlDocuments>
  <!-- List of all fields [site columns] shared between all content types and the document set. -->
  <XmlDocument NamespaceURI="http://schemas.microsoft.com/office/documentsets/sharedfields">
    <sf:SharedFields xmlns:sf="http://schemas.microsoft.com/office/documentsets/sharedfields" LastModified="1/1/2010 08:00:00 AM">
      <!-- Add shared fields here using the syntax below-->
      <!--<SharedField id="00000000-0000-0000-0000-000000000000" />-->
    </sf:SharedFields>
  </XmlDocument>
  <!-- List of all content types that are allowed in the document set. -->
  <XmlDocument NamespaceURI="http://schemas.microsoft.com/office/documentsets/allowedcontenttypes">
    <act:AllowedContentTypes xmlns:act="http://schemas.microsoft.com/office/documentsets/allowedcontenttypes" LastModified="1/1/2010 08:00:00 AM">
      <!-- Add content types that will be used in the document set using the syntax below -->
      <!--<AllowedContentType id="00000000-0000-0000-0000-000000000000" />-->
    </act:AllowedContentTypes>
  </XmlDocument>
  <!-- List of all fields [site columns] that should appear on welcome page. -->
  <XmlDocument NamespaceURI="http://schemas.microsoft.com/office/documentsets/welcomepagefields">
    <wpFields:WelcomePageFields xmlns:wpFields="http://schemas.microsoft.com/office/documentsets/welcomepagefields" LastModified="1/1/2010 08:00:00 AM">
      <!-- Add welcome fields here using the syntax below -->
      <!--<WelcomePageField id="00000000-0000-0000-0000-000000000000" />-->
    </wpFields:WelcomePageFields>
  </XmlDocument>
  <!-- List of all default documents associated with the content types. -->
  <XmlDocument NamespaceURI="http://schemas.microsoft.com/office/documentsets/defaultdocuments">
    <dd:DefaultDocuments xmlns:dd="http://schemas.microsoft.com/office/documentsets/defaultdocuments" AddSetName="TRUE" LastModified="1/1/2010 08:00:00 AM">
      <DefaultDocument idContentType="0x010100c462526dfcb94db3ab99dc52649a7f66" name="Template.docx" />
    </dd:DefaultDocuments>
  </XmlDocument>

  <XmlDocument NamespaceURI="http://schemas.microsoft.com/sharepoint/v3/contenttype/forms">
    <FormTemplates  xmlns="http://schemas.microsoft.com/sharepoint/v3/contenttype/forms">
      <Display>ListForm</Display>
      <Edit>ListForm</Edit>
      <New>NewForm</New>
    </FormTemplates>
  </XmlDocument> 
```

# ruby-on-rails - Haml-rails 在 Rails 3 引擎中不起作用

> ID：10902787
> 
> 赞同：1
> 
> 时间：2012-06-05T18:28:16.637
> 
> 标签：ruby-on-rails, ruby-on-rails-3, haml, ruby-on-rails-3.2, rails-engines

我创建了一个 Rails 引擎（根据[Rails Guides](http://edgeguides.rubyonrails.org/engines.html)），使用：

```
rails plugin new address_book --full --mountable 
```

然后我继续按照[这个问题的答案中](https://stackoverflow.com/questions/5015297/best-way-to-require-haml-on-rails3-engines)的说明，尝试了“haml”gem和“haml-rails”gem（我想要后者，因为我也在我的父应用程序中使用它）。

由于某种原因，运行后`bundle`，然后

```
rails g controller pages temp 
```

它仍然创建 .erb 文件而不是 .haml 文件。

任何援助将不胜感激。我的代码如下：

'lib/address_book.rb' 文件：

```
require "address_book/engine"
require "haml-rails"

module AddressBook
end 
```

'address_book.gemspec' 文件：

```
$:.push File.expand_path("../lib", __FILE__)

# Maintain your gem's version:
require "address_book/version"

# Describe your gem and declare its dependencies:
Gem::Specification.new do |s|
  s.name        = "address_book"
  s.version     = AddressBook::VERSION
  s.authors     = ["TODO: Your name"]
  s.email       = ["TODO: Your email"]
  s.homepage    = "TODO"
  s.summary     = "TODO: Summary of AddressBook."
  s.description = "TODO: Description of AddressBook."

  s.files = Dir["{app,config,db,lib}/**/*"] + ["MIT-LICENSE", "Rakefile", "README.md"]
  s.test_files = Dir["test/**/*"]

  s.add_dependency "rails", "~> 3.2.5"
  s.add_dependency "haml-rails"
  # s.add_dependency "jquery-rails"

  s.add_development_dependency "sqlite3"
end 
```

“宝石文件”文件：

```
source "http://rubygems.org"

gemspec

gem "jquery-rails" 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2014-04-09T10:36:26.647

试试这个：

添加到您的宝石规格：

```
s.add_dependency 'haml-rails' 
```

而不是转到您的 engine.rb 文件并添加：

```
config.generators do |g| 
  g.template_engine :haml
end 
```

最后一步：添加到引擎 Gemspec：

```
gem 'haml-rails' 
```

您的生成器现在将生成haml 视图。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-06-05T20:48:18.543

在普通应用程序中，您可以在 application.rb 的 app-config 中进行配置，例如：

```
config.generators do |g|
  g.template_engine :haml
end 
```

我不知道是否可以将这样的文件添加到引擎中。可以通过 railtie-config-hook 对其进行配置。

尽管有这些配置选项，您应该能够直接在命令行中指定模板引擎：

```
rails g controller pages temp -e=haml 
```

# java - AWT KeyListener 反应慢

> ID：10902789
> 
> 赞同：1
> 
> 时间：2012-06-05T18:28:27.840
> 
> 标签：java, swing, awt, keylistener

我正在用 Java Swing 创建一个简单的游戏。我有一个问题 -`KeyListener`似乎反应有点不稳定/缓慢。角色使用以下代码移动：

```
// player control
    public void keyPressed(KeyEvent e) {
        int key = e.getKeyCode();
        switch(key){
        case(KeyEvent.VK_LEFT): dx = -speed; break;
        case(KeyEvent.VK_RIGHT): dx = speed; break;
        case(KeyEvent.VK_UP): dy = -speed; break;
        case(KeyEvent.VK_DOWN): dy = speed; break;
        }
    }

public void keyReleased(KeyEvent e) {
    int key = e.getKeyCode();
    switch(key){
    case(KeyEvent.VK_LEFT): dx = 0; break;
    case(KeyEvent.VK_RIGHT): dx = 0; break;
    case(KeyEvent.VK_UP): dy = 0; break;
    case(KeyEvent.VK_DOWN): dy = 0; break;
    }
}

// this method is performed each time before redrawing the screen
public void step() {
    x += dx;
    y += dy;
} 
```

大多数时候一切都很好，但有时角色会在对键盘做出反应之前停止一段时间。如何让键盘输入更流畅？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-06-05T19:34:47.283

谢谢大家的回答！他们帮助我走上正轨。

正如我在评论中所说，这里发生的情况如下：例如，如果我们按住右键 - 角色向右移动，那么我们按下左键，它开始向左移动。现在，如果我们释放右键，xSpeed 将重置为零，并且`KeyListener`必须等到`keyPressed()`再次触发，因为我们仍然按住左键。“按键重复速度”是默认设置的，据我了解无法调整。

所以解决方案是跟踪当前按下了哪些键，这样如果我们仍然按住左键，释放右键时我们不必将角色的速度降为零。

对不起，有点神秘的例子，只是试图保持代码小：

```
// Define keys: up, right, down, left
// 0 - not pressed, 1 - pressed
private int[] keys = {0, 0, 0, 0};

// player control
public void keyPressed(KeyEvent e) {
    int key = e.getKeyCode();
    // we set the corresponding 'key indicator' to 1 when it is pressed
    switch(key){
        case(KeyEvent.VK_LEFT): dx = -speed; keys[3] = 1; break; 
        case(KeyEvent.VK_RIGHT): dx = speed; keys[1] = 1; break;
        case(KeyEvent.VK_UP): dy = -speed; keys[0] = 1; break;
        case(KeyEvent.VK_DOWN): dy = speed; keys[2] = 1; break;
        case(KeyEvent.VK_SPACE): fireOn = true; break;
    }
}

public void keyReleased(KeyEvent e) {
    int key = e.getKeyCode();
    // now before resetting the speed we check if the opposite key
    // is still pressed
    switch(key){
        case(KeyEvent.VK_LEFT): if(keys[1]==0){dx = 0;} keys[3] = 0; break;
        case(KeyEvent.VK_RIGHT): if(keys[3]==0){dx = 0;} keys[1] = 0; break;
        case(KeyEvent.VK_UP): if(keys[2]==0){dy = 0;} keys[0] = 0; break;
        case(KeyEvent.VK_DOWN): if(keys[0]==0){dy = 0;} keys[2] = 0; break;
        case(KeyEvent.VK_SPACE): fireOn = false; break;
    }
} 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-05-08T23:16:55.283

另一种方法可能会有所帮助：

```
object.addKeyListener(new KeyAdapter() {
    @Override
    public void keyTyped(KeyEvent e) {
        updateOpreation();
    }

    @Override
    public void keyReleased(KeyEvent e) {
        updateOpreation();
    }

    @Override
    public void keyPressed(KeyEvent e) {
        updateOpreation();
    }

} 
```

# c# - 使用 WPF 进行 C# 打印

> ID：10902791
> 
> 赞同：2
> 
> 时间：2012-06-05T18:28:29.150
> 
> 标签：c#, printing, dispatcher

我的应用程序打印（到打印机）屏幕上显示的信息（使用 Canvas 控件）N 次。

过程是

用户单击一个按钮（称为打印）。
用文本更新画布（通常来自数据库，但对于下面的代码，它是硬编码的）
打印到打印机
用新文本更新画布（同样来自数据库，但对于下面的代码，它是硬编码的）打印到打印机

但是，我无法按照上述过程中的说明让它工作 - 打印机只打印最后一次更新。

为了使这个问题可复制，我附上下面的代码

我的 XAML

```
<Window x:Class="WpfApplication4.MainWindow"
    xmlns="http://schemas.microsoft.com/winfx/2006/xaml/presentation"
    xmlns:x="http://schemas.microsoft.com/winfx/2006/xaml"
    Title="MainWindow" Height="350" Width="525">
<Grid>
    <Canvas Margin="0,0,0,88" Name="canvas1">
        <TextBlock Text="Hello World" Name="TextBlock1" />
    </Canvas>
    <Button Content="Button" Height="23" HorizontalAlignment="Left" Margin="0,245,0,0" Name="button1" VerticalAlignment="Top" Width="75" Click="button1_Click" />
</Grid>
</Window> 
```

和我背后的代码

```
using System;
using System.Windows;
using System.Printing;
using System.Windows.Threading;
using System.Windows.Controls;

namespace WpfApplication4
{
/// <summary>
/// Interaction logic for MainWindow.xaml
/// </summary>
public partial class MainWindow : Window
{
    public MainWindow()
    {
        InitializeComponent();
    }

    private void button1_Click(object sender, RoutedEventArgs e)
    {
        PrintDialog dialog = new PrintDialog();
        for (int i = 1; i < 3; i++)
        {
            //showing this message box fixes the issue
            //MessageBox.Show("01");
            updateTextblock(i);

            //use the dispatcher object to ensure all renders and databinding are completed before sending to print   
            DispatcherOperation disO;
            disO = Dispatcher.BeginInvoke(DispatcherPriority.Loaded, new Action(delegate
            {
                print(dialog);
            }
            ));   
            disO.Wait()
        }
    }

    private void print(PrintDialog dialog)
    {
        //select printer auotmatically
        PrintQueue queue = new LocalPrintServer().GetPrintQueue("Canon MG160 series WS");
        //assign the printer  
        dialog.PrintQueue = queue;

        dialog.PrintVisual(canvas1, "");
    }

    private void updateTextblock(int i)
    {
        TextBlock1.Text = "Number " + i.ToString();
    }
}
} 
```

唯一打印的是数字 2

尽管它已经用数字 1 迭代和更新了画布，但它从不打印（打印空白页）。

任何想法我需要做什么才能使每个 Canvas 打印？尽管我可以通过显示消息框来使其工作，但它违背了自动化的目的。

**编辑**：我现在从我的打印机收到一条错误消息 - “另一台计算机正在使用打印机。” 根据其他网站，我必须等到一项工作完成，然后第二项才会自动启动，但遗憾的是，它永远不会。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-06-05T18:34:41.220

> 使用 PrintDialog 对话框 = new PrintDialog(); 在for循环里面使用这个函数

```
 private void button1_Click(object sender, RoutedEventArgs e)
    {

        for (int i = 1; i < 3; i++)
        {
           PrintDialog dialog = new PrintDialog();
            //showing this message box fixes the issue
            //MessageBox.Show("01");
            updateTextblock(i);

            //use the dispatcher object to ensure all renders and databinding are completed before sending to print   
            Dispatcher.BeginInvoke(DispatcherPriority.Loaded, new Action(delegate
            {
                print(dialog);
            }
            ));   
        }
    } 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-06-15T07:50:29.117

答案（对不起，代码与问题不完全相同，但它很简单，应该很容易理解。谢谢大家。

```
using System;
using System.Collections.Generic;
using System.Linq;
using System.Text;
using System.Windows;
using System.Windows.Controls;
using System.Windows.Data;
using System.Windows.Documents;
using System.Windows.Input;
using System.Windows.Media;
using System.Windows.Media.Imaging;
using System.Windows.Navigation;
using System.Windows.Shapes;
using System.Windows.Threading;

namespace WpfApplication1
{
    /// <summary>
    /// Interaction logic for MainWindow.xaml
    /// </summary>
    public partial class MainWindow : Window
    {
        public MainWindow()
        {
            InitializeComponent();
        }

        private void Button_Click(object sender, RoutedEventArgs e)
        {
            for (int i = 0; i < 2; i++)
            {
            result res = null;     
            if (i == 0)
            res = new result { Comments = "First Time Round" };

            if (i == 1)
                res = new result { Comments = "Total hard type" };

            Dispatcher.Invoke(DispatcherPriority.Loaded, new Action(delegate
                {   
                    this.DataContext = res;
                }
            ));

            System.Threading.Thread.Sleep(500);

            Dispatcher.Invoke(DispatcherPriority.Loaded, new Action(delegate
            {
                PrintDialog dialog = new PrintDialog();
                dialog.PrintVisual(this.canvas1, "");
            }
        ));
            System.Threading.Thread.Sleep(500);

            }
        }
    }

    class result
    {
        public string Comments { get; set; }
    }
} 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-06-05T18:31:45.267

您的 UpdateText 方法全错了。每次调用该方法时，都会在文本块中创建一个新字符串。因此，您将看到的只是对例程的最后一次调用。

相反，您应该附加到文本而不是替换文本。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2012-06-05T21:04:39.753

BeginInvoke 返回一个[DispatcherOperation](http://msdn.microsoft.com/en-us/library/system.windows.threading.dispatcheroperation.aspx)。如果在继续 for 循环之前调用 Wait ，文本框将不会更新，直到执行第一次打印。

# ms-access - 访问检查字符串字段是否包含字符，然后再对其进行操作

> ID：10902793
> 
> 赞同：2
> 
> 时间：2012-06-05T18:28:36.090
> 
> 标签：ms-access

我的问题很简单（我认为），但我无法让它发挥作用。我在一个字段中的数字看起来像这样 1;2.3 但有时它们看起来像这样 1;2.3 - 4;5.6 我要做的是：如果有“-”字符，请获取第一部分 (1;2.3 ）。否则得到整件事。我做了一些事情来得到左边的部分

```
Left([age_years];InStr(1;[age_years];" - ")-1)) 
```

但是当只有一个部分时，它会给我一个#Func！结果。所以我尝试了

```
mths: IIf(InStr([age_years]>0;"-");[age_years];Left([age_years];InStr(1;[age_years];" - ")-1)) 
```

但它根本没有用。只给了我一堆#Error！，我看不出我做错了什么。

请帮忙！

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-06-05T18:57:57.457

怎么样：

```
IIf(InStr([age_years];"-")=0;[age_years];Left([age_years];InStr(1;[age_years];" - ")-1)) 
```

你需要在“-”和“-”之间做出选择，我已经离开了，但你应该选择一个。

# php - 无法使用 JsonP 获得希伯来语结果

> ID：10902795
> 
> 赞同：0
> 
> 时间：2012-06-05T18:28:40.263
> 
> 标签：php, mysql, jquery, jsonp

我正在向托管在我拥有的网站上的 php 脚本发出 JsonP 请求。php 脚本从 DB 获取结果并将它们作为 Json 返回。

问题是数据库包含希伯来字符，我把它们当作'??????' 在回应中。

知道如何解决这个问题吗？

这是js代码：

```
$.getJSON("http://flyfish.co.il/appdiet?callback=?",function(data){
$('p').text(data[0].food_name);
}); 
```

和php代码：

```
 <?php
header('Content-type: text/html; charset=UTF-8');
require_once 'config.php';

$mysqli = new mysqli(HOST,USERNAME,PASSWORD,DB_NAME);

$query = "SELECT * from mytable";

if ($result = $mysqli->query($query)) 
{
$data = array();
while ($row = $result->fetch_assoc()) { 
    $data[] = $row;     
}
echo $_GET['callback'].'('.json_encode($data).')';
}  
else {
echo $_GET['callback'].'('.$mysqli->error.')';
} 
$mysqli->close(); 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-06-05T18:30:53.973

尝试`set names 'utf8';`在您的`select`陈述之前添加一个。

# javascript - 如何实现本地存储阵列？

> ID：10902796
> 
> 赞同：0
> 
> 时间：2012-06-05T18:28:40.523
> 
> 标签：javascript

我尝试了有意义的方法：

在下面的模块中`localStorage.foo`有效，但`localStorage.session_array['privacy']`返回未定义。

这是现代浏览器的原型代码。

```
var ISession = ( function () 
{

    localStorage.session_array = 
    {
        privacy:            0
    };

    localStorage.foo = 1; 

    var SessionI = function ( ) 
    {
    };

    SessionI.prototype.get = function( type ) 
    {
        return localStorage.session_array[ type ];
    };

    SessionI.prototype.set = function( type, value ) 
    {
        localStorage.session_array[ type ] = value;
        alert( '|' + localStorage.foo ); // returns 1
        alert( '|' + localStorage.session_array[ 'privacy' ] ); // returns undefined
    };

    return SessionI;

} ) (); 
```

同时，我将使用非数组属性来实现它。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-06-05T18:31:50.363

localStorage only saves data as strings

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-06-05T18:32:45.973

由于并非所有浏览器都支持 localstorage，因此您可能需要查看[store.js](https://github.com/marcuswestin/store.js)。它在可用时支持本地存储，如果不支持，则使用其他一些存储机制（globalStorage 和 UserData）。最好的部分是您还可以存储 JSON 编码的数据。

```
// Store 'marcus' at 'username'
store.set('username', 'marcus')

// Get 'username'
store.get('username')

// Remove 'username'
store.remove('username')

// Clear all keys
store.clear()

// Store an object literal - store.js uses JSON.stringify under the hood
store.set('user', { name: 'marcus', likes: 'javascript' })

// Get the stored object - store.js uses JSON.parse under the hood
var user = store.get('user')
alert(user.name + ' likes ' + user.likes)

store.set('user', { name: 'marcus', likes: 'javascript' })
alert("Hi my name is " + store.get('user').name + "!")

store.set('tags', ['javascript', 'localStorage', 'store.js'])
alert("We've got " + store.get('tags').length + " tags here") 
```

# java - JavaFX 2.1 和线程？- 或 - 优雅地结束 JavaFX 应用程序？

> ID：10902799
> 
> 赞同：5
> 
> 时间：2012-06-05T18:28:48.197
> 
> 标签：java, multithreading, javafx-2, exit

我想要一种非常简单的方法来从 Java 应用程序播放 mp3 文件。经过一番研究，我发现最新版本的 Java 7 SE 是用 JavaFX 打包的，所以我想我会尝试一下。这个问题不是关于播放 mp3 文件，而是关于让 JavaFX 以一种行为良好的方式工作。

因此，在我对 JavaFX 的第一次实验中，我使用了一些在 stackoverflow 帖子中建议的代码（[请参见此处](https://stackoverflow.com/questions/6045384/playing-mp3-and-wav-in-java)），并创建了以下测试程序：

```
import javafx.application.Application;
import javafx.stage.Stage;
import javafx.scene.media.Media;
import javafx.scene.media.MediaPlayer;

public class progtest extends Application
{

    /*---------------------------------------------------------*\
        FUNCTION:  main()
    \*---------------------------------------------------------*/
    public static void main(String args[])
    {

        launch(args);

    } /* END:  main() */

    /*---------------------------------------------------------*\
        FUNCTION:  start()
    \*---------------------------------------------------------*/
    @Override
    public void start(Stage stage)
    {

        Media medMsg 
            = 
            new Media(getClass().getResource("msg.mp3").toExternalForm());
        MediaPlayer medplMsg = new MediaPlayer(medMsg);
        medplMsg.play();

        System.out.println("Here.\n");

    } /* END:  start() */

} 
```

（这比我原来的测试程序稍微复杂一点：这个版本是在jewelsea 提出的建议之后出现的，该建议是为了回应我之前发布的关于让程序运行的问题（[见这里](https://stackoverflow.com/questions/10888367/compiling-and-running-with-javafx-2-1)）。）

为了编译我使用的这段代码：

```
javac -cp "c:\Program Files\Oracle\JavaFX 2.1 Runtime\lib\jfxrt.jar";..\bin -d ..\bin ..\src\progtest.java 
```

而且，为了运行代码，我进入了我的 ..\bin 目录并使用了：

```
java -cp .;"c:\Program Files\Oracle\JavaFX 2.1 Runtime\lib\jfxrt.jar" progtest 
```

该程序运行并播放剪辑播放。但是，除非我按 Ctrl-C，否则程序不会返回到命令提示符。

这种行为似乎是某种线程问题。我已经多次看到这种行为与 Java 线程一起使用（遗憾的是，在允许程序优雅退出时存在真正的问题）。

所以，我想，也许如果我将代码放在它自己的线程中，然后在该线程结束时结束程序的主线程，一切都会好起来的。（我可以看出这并不完全是一个有说服力的想法，但无论如何，我想我会尝试。）所以，我编写了以下第二个版本的代码：

这是主线程：

```
import javafx.application.Application;
import javafx.stage.Stage;
import Msg.*;

public class progtest2 extends Application
{

    /*---------------------------------------------------------*\
        FUNCTION:  main()
    \*---------------------------------------------------------*/
    public static void main(String args[])
    {

        launch(args);

    } /* END:  main() */

    /*---------------------------------------------------------*\
        FUNCTION:  start()
    \*---------------------------------------------------------*/
    @Override
    public void start(Stage stage)
    {

        Msg msgTime = new Msg();
        msgTime.passClass(getClass());
        msgTime.start();

        try
        {
            msgTime.join();
        }
        catch (InterruptedException e)
        {
        }

        System.out.println("Here.\n");

    } /* END:  start() */

} 
```

下面是实际播放 mp3 文件的 Msg 线程的代码：

```
package Msg;

import KeyIO.*;
import javafx.application.Application;
import javafx.scene.media.Media;
import javafx.scene.media.MediaPlayer;

public class Msg extends Thread
{

    private Class classRt = null;

    /*--------------------------------------------------------*\
        FUNCTION:  passClass()
    \*--------------------------------------------------------*/
    public void passClass(Class rt)
    {

        classRt = rt;

    } /* END:  passClass() */

    /*--------------------------------------------------------*\
        FUNCTION:  run()
    \*--------------------------------------------------------*/
    public void run()
    {

        Media medMsg
            = new Media(classRt.getResource("msg.mp3").toExternalForm());
        MediaPlayer medplMsg = new MediaPlayer(medMsg);
        medplMsg.play();

        System.out.println("Leaving Msg thread.\n");

    } /* END:  run() */

} 
```

（我使用与上述相同的命令（比照文件名和类名）构建并运行这些文件。）

该程序运行并播放 mp3 文件。在您听到文件之前，您会看到“Leaving Msg thread”。然后是“Here.”，如您所见，它分别来自 Msg 线程和主线程。但是，同样，程序并没有结束。我必须按 Ctrl-C 才能返回命令提示符。

我在主线程的末尾放了一个 System.exit() 调用，只是为了看看行为会是什么。行为是没有听到剪辑。似乎 System.exit() 调用在播放剪辑之前结束了该过程。

因此，接下来我尝试将以下几行放在 System.out.println("Here.\n"); 之间 和我所做的 System.exit() 调用：

```
System.out.print("Press ENTER to end...");
KeyIO.ReadLine(); 
```

（KeyIO 是我做的一个类，只是为了简单地做键盘输入输出。细节在这里并不相关。）

我认为这只会阻止主线程继续前进，直到播放剪辑。

但不是。相反，该剪辑没有播放。当我按 ENTER 时，程序退出而不播放剪辑。

好的，所以现在我留下了键盘输入阻塞代码，但我取出了 System.exit() 调用。现在播放了音频剪辑，但程序没有再次结束。

啊！

有什么想法可以优雅地让它以一种显而易见的方式工作吗？我只想打电话播放剪辑，然后我希望能够结束程序。

先感谢您！

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2012-06-05T21:51:30.707

在第一个 progtest 类中，您不创建窗口，因此不会调用关闭最后一个窗口时的implicitExit 操作。这意味着程序将继续运行，直到您调用应用程序的退出方法，而您不这样做。

要让程序在您的 mp3 播放完毕后退出，请调用[mediaPlayer.setOnEndOfMedia(runnable)](http://docs.oracle.com/javafx/2/api/javafx/scene/media/MediaPlayer.html#onEndOfMediaProperty)并在可运行回调中调用[Platform.exit()](http://docs.oracle.com/javafx/2/api/javafx/application/Platform.html#exit%28%29)方法。

```
medplMsg.setOnEndOfMedia(new Runnable() {
  @Override public void run() {
    Platform.exit();
  }
}); 
```

不需要您问题中的所有其他线程内容（无论如何也不能解决您的问题......）。我不建议使用自定义线程，除非你真的需要它（你不需要）。

JavaFX 2.2 添加了以下 api：

```
Platform.setImplicitExit(boolean implicitExit) 
```

> 将implicitExit 属性设置为指定值。如果此属性为真，JavaFX 运行时将在最后一个窗口关闭时隐式关闭；JavaFX 启动器将调用 Application.stop() 方法并终止 JavaFX 应用程序线程。如果此属性为 false，则即使在最后一个窗口关闭后，应用程序仍将继续正常运行，直到应用程序调用 exit()。默认值是true。

这应该会给你一些关于你遇到的问题的线索。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-06-05T22:52:13.057

这个对我自己的问题的回答是给出一个最终解决问题的代码的明确示例，该问题来自jewelsea 在该线程中的出色响应以及我在原始帖子中提到的另一个问题。

好的，所以下面的代码起作用了（jewelsea 正确地评论说线程是不必要的并且在这里没有任何意义）：

```
import javafx.application.Application;
import javafx.application.Platform;
import javafx.stage.Stage;
import javafx.scene.media.Media;
import javafx.scene.media.MediaPlayer;

public class progtest6 extends Application
{

    /*---------------------------------------------------------*\
        FUNCTION:  main()
    \*---------------------------------------------------------*/
    public static void main(String args[])
    {

        launch(args);

    } /* END:  main() */

    /*---------------------------------------------------------*\
        FUNCTION:  start()
    \*---------------------------------------------------------*/
    @Override
    public void start(Stage stage)
    {

        Media medMsg 
            = 
            new Media(getClass().getResource("msg.mp3").toExternalForm());
        MediaPlayer medplMsg = new MediaPlayer(medMsg);
        medplMsg.setOnEndOfMedia(new Runnable() {
            @Override
            public void run()
            {
                Platform.exit();
            }
        });
        medplMsg.play();

        System.out.println("Here.\n");

    } /* END:  start() */

} 
```

谢谢珠宝海。

# grails - Grails 插件依赖问题，WAR 文件缺少插件工件

> ID：10902804
> 
> 赞同：1
> 
> 时间：2012-06-05T18:29:14.753
> 
> 标签：grails, groovy, grails-plugin, dependency-management, buildconfiguration

开发 Grails 1.3.7 网络应用程序；它依赖于一个依赖于另一个插件的插件，下图说明了依赖配置。

问题是WAR文件；我使用的是标准`grails war`命令，但是`core-plugin`战争中没有打包的类；`webutil-plugin`但是，存在的工件。我仔细检查了 Artifactory，存储库没有问题。我在 WAR 构建输出中注意到的一件事是...`webutil`首先从 repo 中提取插件，然后打包 WAR，然后`core`提取插件并将其复制到我的本地 grails/ivy repo。不知道为什么会这样，可能是因为网络应用程序隐含地依赖`core`through`webutil`吗？

![在此处输入图像描述](../Images/ebd489f3fa2a58c0dafba7c67180ab1c.png)

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-06-05T19:01:03.793

能够通过将这两个插件添加到 web 应用程序来解决这个问题`BuildConfig`，尽管这并不理想，因为它会导致冗余配置。仍然不确定为什么隐式依赖不起作用。

![在此处输入图像描述](../Images/ddb932a6b4ce032b08782ca51f2e339c.png)

# maven-2 - 无法使用 Maven 中央存储库

> ID：10902805
> 
> 赞同：0
> 
> 时间：2012-06-05T18:29:22.090
> 
> 标签：maven-2

即使使用 ../.m2/setting.xml 文件中的代理设置，也无法访问 maven 中央存储库。被告知必须使用本地存储库。想知道由于这个限制，什么是构建和使用本地存储库的好方法，从而有效地使用 Maven？

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-06-05T18:40:41.453

You (or your admin) can have your local repo mirror the central repo and set your settings.xml file to use your local repo as the mirror for everything (see the [Nexus repo documentation](http://www.sonatype.com/books/nexus-book/reference/maven-sect-single-group.html) for what to put in your settings.xml). When you build, maven will attempt to pull all resources from your local repo; if they're not there, your repo will automatically pull them from central and store them. The next time you build, all artifacts will come from your local repo and not central.

# apache - 无法让虚拟主机在不同的端口上运行

> ID：10902807
> 
> 赞同：1
> 
> 时间：2012-06-05T18:29:23.053
> 
> 标签：apache, virtualhost, ports

我正在尝试在 ubuntu 上设置不同端口上的虚拟主机，但我可以让它工作。我在可用站点中的配置看起来像

```
NameVirtualHost 127.0.0.1:5050
Listen 5050
<VirtualHost 127.0.0.1:5050>
ServerName localhost
DocumentRoot "/var/www/example"
<Directory />
    Options FollowSymLinks
    AllowOverride None
</Directory>
<Directory /var/www/example/>
    Options Indexes FollowSymLinks MultiViews
    AllowOverride None
    Order allow,deny
    allow from all
</Directory>
</VirtualHost> 
```

我添加到主机文件中

```
127.0.0.1:5050 localhost 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-06-05T18:39:15.180

该`hosts`文件将名称映射到 IP 地址。它不能用于对端口做任何事情。您只能将端口指定为 url 的一部分（例如`http://localhost:5050/`）。

您当然可以在 80 以外的端口上运行虚拟主机，但您必须明确引用该端口，正如我所指出的。

# asp.net - 为 IIS 7 经典模式错误配置联合被动依赖方（无法执行 URL）

> ID：10902811
> 
> 赞同：3
> 
> 时间：2012-06-05T18:29:39.370
> 
> 标签：asp.net, iis-7, wif, application-pool, federation

我有一个 ASP.Net 依赖方，它使用 Microsoft 身份模型和 WIF 进行被动联合身份。Web 应用程序在 .Net 4 集成管道应用程序池下的 IIS 7 中运行良好。但是当我将它切换到 .Net 4 经典管道应用程序池时，它失败并给我以下错误。如何解决这个问题？

**异常详细信息：** System.Web.HttpException：无法执行 URL。

**堆栈跟踪：**

[HttpException (0x80004005): 执行 URL 失败。] System.Web.Hosting.ISAPIWorkerRequestInProcForIIS6.BeginExecuteUrl(String url, String method, String childHeaders, Boolean sendHeaders, Boolean addUserIndo, IntPtr token, String name, String authType, Byte[] entity , AsyncCallback cb, Object state) +4040320 System.Web.HttpResponse.BeginExecuteUrlForEntireResponse(String pathOverride, NameValueCollection requestHeaders, AsyncCallback cb, Object state) +590 System.Web.DefaultHttpHandler.BeginProcessRequest(HttpContext context, AsyncCallback callback, Object state) +286 System.Web.CallHandlerExecutionStep.System.Web.HttpApplication.IExecutionStep.Execute() +405 System.Web.HttpApplication.ExecuteStep(IExecutionStep step, Boolean& completedSynchronously) +375

**编辑**

当我在未指定页面的情况下浏览网站时会发生此错误。例子：

1 - *http://www.relyingparty3.com*导致错误

2 - *http://www.relyingparty3.com/Default.aspx*工作正常

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-06-06T20:56:59.343

我在以下 MSDN 论坛帖子中找到了解决方案。归功于用户“paullem”（解释失败的原因）和“Alex Stankiewicz”（用于提供修复代码）：

[http://social.msdn.microsoft.com/Forums/en/Geneva/thread/43392dc5-e764-4027-8de5-1638a4c17540](http://social.msdn.microsoft.com/Forums/en/Geneva/thread/43392dc5-e764-4027-8de5-1638a4c17540)

所以为了解决这个问题，我用以下代码创建了一个新类：

```
using System;
using System.Web;
using System.Security.Principal;
using System.Threading;
using Microsoft.IdentityModel.Claims;
using Microsoft.IdentityModel.Web;

namespace TestApp.Code
{
    public class IIS6SessionAuthenticationModule : SessionAuthenticationModule
    {
        protected override void OnPostAuthenticateRequest(object sender, EventArgs e)
        {
            if (!(HttpContext.Current.User is IClaimsPrincipal))
            {
                IClaimsPrincipal incomingPrincipal = ClaimsPrincipal.CreateFromHttpContext(HttpContext.Current);
                ClaimsAuthenticationManager manager = base.ServiceConfiguration.ClaimsAuthenticationManager;

                if (((manager != null) && (incomingPrincipal != null)) && (incomingPrincipal.Identity != null))
                {
                    incomingPrincipal = manager.Authenticate(HttpContext.Current.Request.Url.AbsoluteUri, incomingPrincipal);
                }

                if (incomingPrincipal.Identity.IsAuthenticated)
                {
                    HttpContext.Current.User = incomingPrincipal;
                    Thread.CurrentPrincipal = incomingPrincipal;
                }
                else
                {
                    HttpContext.Current.User = new GenericPrincipal(new GenericIdentity(string.Empty), new string[] { });
                    Thread.CurrentPrincipal = HttpContext.Current.User;
                }
            }
            else
            {
                if (string.IsNullOrEmpty(HttpContext.Current.User.Identity.Name))
                {
                    HttpContext.Current.User = new GenericPrincipal(new GenericIdentity(string.Empty), new string[] { });
                    Thread.CurrentPrincipal = HttpContext.Current.User;
                }
            }
        }
    }
} 
```

然后，我将以下条目添加到“web.config”中“system.web”的“httpModules”中，在“WSFederationAuthenticationModule”和“SessionAuthenticationModule”之后：

```
<add name="IIS6SessionAuthenticationModule" type="TestApp.Code.IIS6SessionAuthenticationModule, TestApp" /> 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-06-05T22:53:53.960

尾部斜杠存在问题。

如果您键入会发生什么：[http ://www.relyingparty3.com/](http://www.relyingparty3.com/)

（注意尾部斜杠）

# selenium - 窗口的预期条件不可用

> ID：10902812
> 
> 赞同：0
> 
> 时间：2012-06-05T18:29:40.340
> 
> 标签：selenium, selenium-webdriver

是否有一个 api 用于在切换到它之前等待窗口加载或在新窗口中存在窗口标题？我们有 ExpectedConditions.frameToBeAvailableAndSwitchToIt 以使框架可用，但是，如果我们也为窗口也有等效的框架，那将使生活更轻松。任何回应将不胜感激。谢谢。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-10-15T17:50:13.537

我使用这种方法：

```
/**
 * Wait for an emergent windows to be present.
 */
public final void waitForWindowsPresent() {
    WebDriverWait wait = new WebDriverWait(getDriverProvider().get(),
            TIMEOUT);
    wait.until(new Predicate<WebDriver>() {
        public boolean apply(final WebDriver d) {
            return getDriverProvider().get().getWindowHandles().size() > 1;
        }
    });
} 
```

我检查 windowHandles 的数量是否大于 1，但如果您希望打开更多窗口，您可以保存 windowHandles 的状态，然后与之进行比较。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-06-05T21:39:29.820

我在这里发布了类似的内容：

[通过具有超时值的 URL 等待窗口](https://stackoverflow.com/questions/10879206/how-to-switch-between-frames-in-java-using-webdriver/10889500#10889500)

代码是 groovy 的，但是 groovy 的可读性很好，所以用另一种语言重做它应该很容易。我在 FF、IE 和 Chrome 中广泛使用它。

用法类似于：

```
def url = "/page/ContactUs"
if (!selectWindow(serverBaseUrl + url)) {Log.Error("Cannot get to Contact Us")} 
```

如果您需要等待页面上的某些内容：

```
public boolean waitOnXPathDisplayed(String xpath) {
    int tries = 0;
    while (true) {
        try {
            Log.logger.info("Trying to find element " + xpath + ", try = " + tries)
            WebElement el = driver.findElement(By.xpath(xpath))
            if(el.isDisplayed()) {
                Log.logger.info("Found element")
                return true
            } else {
                Log.logger.info("Element not displayed yet")
                tries++
                Thread.sleep(1000)
            }
            if (tries > 20) {
                Log.logger.error("Timeout")
                return false
            }
        } catch (Exception ex) {
            Log.logger.info("Exception while trying to find element")
            tries++
            Thread.sleep(1000)
            if (tries > 20) {
                Log.logger.error("Timeout")
                return false
            }
        }
    }
} 
```

使用如下：

```
waitOnXPathDisplayed("//div[@id='some div id']/ul[1]/li[3]") 
```

# java - Java“引用对象”是否存在？

> ID：10902816
> 
> 赞同：1
> 
> 时间：2012-06-05T18:29:57.057
> 
> 标签：java, object, reference

有时我想将不可变对象传递给方法并在方法内部更改其值，或者我想将另一个对象分配给参数引用（示例 1）。或者我想在匿名内部类内部将另一个对象分配给最终的局部变量（示例 2）。因为所有这些情况都不可能，所以有时我会为此目的使用 Atomic(Integer|Long...) 类或列表（这真的很糟糕，因为列表可以包含多个对象）。或者，我可以创建一个包含对象并允许更改对象的类：

```
public class ReferenceExample {

    public static void main(String[] args) {
        final Reference<String> string = new Reference<>("a");
        // Example 1:
        method(string);

        // Example 2:
        new Thread() {
            @Override
            public void run() {
                string.set("c");
            };
        }.start();
    }

    public static void method(Reference<String> string) {
        string.set("b");
    }

    private static class Reference<T> {
        private T value;

        public Reference() {}

        public Reference(T value) {
            this.value = value;
        }

        public T get() {
            return value;
        }

        public void set(T value) {
            this.value = value;
        }
    }

} 
```

我想知道Java或公共库中是否已经存在这样的类（例如，在apache公共项目中）？如果没有，对于这些问题还有其他好的解决方案吗？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-06-05T18:43:12.887

您已经找到了主要解决方案，但其他两种常见方法是

*   `AtomicReference`, 看起来你已经找到了
*   单元素数组，或多或少充当可变引用

也就是说，您通常可以找到解决需求的方法：

*   从您的方法返回（可能不同的）引用
*   在包含可变引用作为字段的类中实现方法，无论如何这通常更合适

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-06-05T18:34:47.617

纯 java 中没有通用且通常使用的解决方案。使用一个而不是使用 javaish 特定的解决方案可能是不好的做法。

常见解决方案：

*   让调用者进行分配：

    `myVal = anObject.aMethod(myVal);`

*   提供封闭对象

    `anObject.aMethod(this);`

*   提供一个回调，它将为变量分配一个新值。为此，您通常必须定义回调实现的接口：

    anObject.aMethod(new MySetter(){ public void set(int newval) { myVal = newval; }; });

确实，java 有时会强迫您进行更多您想要的封装。这似乎是一件好事，或者可能被视为 java 被认为是一种冗长语言的原因之一。

# c - 三角形不显示在 OpenGL 应用程序中

> ID：10902817
> 
> 赞同：2
> 
> 时间：2012-06-05T18:30:05.450
> 
> 标签：c, winapi, opengl

我正在尝试制作我的第一个多边形。

因为我写了一个代码，编译了它，瞧……三角形没有显示:(

这段代码有什么问题？

```
#pragma once

#include <Windows.h>
#include <stdio.h>
#include <stdlib.h>
#include <gl\GL.h>
#include <gl\glu.h>
#include <gl\glut.h>

HDC         hDC=NULL;
HGLRC       hRC=NULL;

GLvoid GL_ReSizeGLScene(GLsizei width, GLsizei height);
int GL_init( GLvoid );
int GL_drawit( GLvoid );

typedef struct {
    HWND hWnd;
} Glab_t;

static Glab_t glab;

char szClassName[ ] = "GLab";

static LRESULT CALLBACK WindowProcedure (HWND hwnd, UINT message, WPARAM wParam, LPARAM lParam) {
    switch (message) {
        case WM_DESTROY:
            PostQuitMessage (0);
            break;
        case WM_SIZE:
            GL_ReSizeGLScene(LOWORD(lParam),HIWORD(lParam));
            break;
        default:
            return DefWindowProc (hwnd, message, wParam, lParam);
    }
    return 0;
}

int WINAPI WinMain (HINSTANCE hInstance, HINSTANCE hPrevInstance, LPSTR lpCmdLine, int nCmdShow) {
    MSG messages;
    RECT rect;
    WNDCLASSEX wndClass;
    int screenWidth, screenHeight;
    int x, y, w, h;
    GLuint      PixelFormat;

    screenWidth = GetSystemMetrics(SM_CXSCREEN);
    screenHeight = GetSystemMetrics(SM_CYSCREEN);

    rect.left = (screenWidth - 582) / 2;
    rect.top = (screenHeight - 358) / 2;
    rect.right = rect.left + 582;
    rect.bottom = rect.top + 358;

    x = rect.left;
    y = rect.top;
    w = 640;
    h = 480;

    wndClass.hInstance = hInstance;
    wndClass.lpszClassName = szClassName;
    wndClass.lpfnWndProc = WindowProcedure;
    wndClass.style = CS_DBLCLKS;
    wndClass.cbSize = sizeof (WNDCLASSEX);
    wndClass.hIcon = LoadIcon (NULL, IDI_APPLICATION);
    wndClass.hIconSm = LoadIcon (NULL, IDI_APPLICATION);
    wndClass.hCursor = LoadCursor (NULL, IDC_ARROW);
    wndClass.lpszMenuName = NULL;
    wndClass.cbClsExtra = 0;
    wndClass.cbWndExtra = 0;
    wndClass.hbrBackground = (HBRUSH)(COLOR_BTNFACE + 1);

    if (!RegisterClassEx (&wndClass)) {
        return 0;
    }

    glab.hWnd = CreateWindowEx (
           0,
           szClassName,
           "GLab - OpenGL",
           WS_OVERLAPPEDWINDOW,
           x,
           y,
           w,
           h,
           HWND_DESKTOP,
           NULL,
           hInstance,
           NULL 
           );

    static  PIXELFORMATDESCRIPTOR pfd=  {
        sizeof(PIXELFORMATDESCRIPTOR),
        1,
        PFD_DRAW_TO_WINDOW | PFD_SUPPORT_OPENGL | PFD_DOUBLEBUFFER,
        PFD_TYPE_RGBA,
        16, // Can be 32 tough :)
        0, 0, 0, 0, 0, 0,
        0,
        0,
        0,
        0, 0, 0, 0, 
        16, 
        0,
        0,
        PFD_MAIN_PLANE, 
        0,
        0, 0, 0 
    };

    if (!(hDC=GetDC(glab.hWnd))) {
        MessageBox(NULL,"Can't Create A GL Device Context.","ERROR",MB_OK|MB_ICONEXCLAMATION);
        return FALSE;
    }

    if (!(PixelFormat=ChoosePixelFormat(hDC,&pfd))) {
        MessageBox(NULL,"Can't Find A Suitable PixelFormat.","ERROR",MB_OK|MB_ICONEXCLAMATION);
        return FALSE;
    }

    if(!SetPixelFormat(hDC,PixelFormat,&pfd)) {
        MessageBox(NULL,"Can't Set The PixelFormat.","ERROR",MB_OK|MB_ICONEXCLAMATION);
        return FALSE;
    }

    if (!(hRC=wglCreateContext(hDC))) {
        MessageBox(NULL,"Can't Create A GL Rendering Context.","ERROR",MB_OK|MB_ICONEXCLAMATION);
        return FALSE;
    }

    if(!wglMakeCurrent(hDC,hRC)) {
        MessageBox(NULL,"Can't Activate The GL Rendering Context.","ERROR",MB_OK|MB_ICONEXCLAMATION);
        return FALSE;
    }

    ShowWindow (glab.hWnd, nCmdShow);
    SetForegroundWindow(glab.hWnd);
    SetFocus(glab.hWnd);
    GL_ReSizeGLScene( w, h );

    if (!GL_init() ) {
        MessageBox(NULL,"Initialization Failed.","ERROR",MB_OK|MB_ICONEXCLAMATION);
        return false;
    }

    if( !GL_drawit() ) {
        MessageBox(NULL,"Initialization Failed.","ERROR",MB_OK|MB_ICONEXCLAMATION);
        return false;
    }

    while (GetMessage (&messages, NULL, 0, 0)) {
        TranslateMessage(&messages);
        DispatchMessage(&messages);
    }

    return messages.wParam;
}

GLvoid GL_ReSizeGLScene(GLsizei width, GLsizei height) {
    if (height==0) {
        height=1;
    }

    glViewport(0,0,width,height);
    glMatrixMode(GL_PROJECTION);
    glLoadIdentity();
    gluPerspective(45.0f,(GLfloat)width/(GLfloat)height,0.1f,100.0f);
    glMatrixMode(GL_MODELVIEW);
    glLoadIdentity();
}

int GL_init( GLvoid ) {
    glShadeModel(GL_SMOOTH);
    glClearColor(0.0f, 0.0f, 0.0f, 0.5f);
    glClearDepth(1.0f);
    glEnable(GL_DEPTH_TEST);
    glDepthFunc(GL_LEQUAL);
    glHint(GL_PERSPECTIVE_CORRECTION_HINT, GL_NICEST);
    return true;
}

int GL_drawit( GLvoid ) {
    glClear(GL_COLOR_BUFFER_BIT | GL_DEPTH_BUFFER_BIT);
    glLoadIdentity();
    glTranslatef(-1.5f,0.0f,-6.0f);
    glBegin(GL_TRIANGLES);
        glVertex3f( 0.0f, 1.0f, 0.0f);
        glVertex3f(-1.0f,-1.0f, 0.0f);
        glVertex3f( 1.0f,-1.0f, 0.0f);
    glEnd();            
    return true;
} 
```

使用 MC Visual C++ 2010 Express 和 OpenGL 1.4。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-06-05T19:06:14.013

[`SwapBuffers()`](http://msdn.microsoft.com/en-us/library/dd369065%28v=vs.85%29.aspx)渲染场景后，您需要在那里调用：

```
#include <Windows.h>
#include <GL/GL.h>
#include <GL/GLU.h>

HDC         hDC=NULL;
HGLRC       hRC=NULL;

GLvoid GL_ReSizeGLScene(GLsizei width, GLsizei height);
int GL_init( GLvoid );
int GL_drawit( GLvoid );

typedef struct {
    HWND hWnd;
} Glab_t;

static Glab_t glab;

char szClassName[ ] = "GLab";

static LRESULT CALLBACK WindowProcedure (HWND hwnd, UINT message, WPARAM wParam, LPARAM lParam) {
    switch (message) {
        case WM_DESTROY:
            PostQuitMessage (0);
            break;
        case WM_SIZE:
            GL_ReSizeGLScene(LOWORD(lParam),HIWORD(lParam));
            break;
        default:
            return DefWindowProc (hwnd, message, wParam, lParam);
    }
    return 0;
}

int WINAPI WinMain (HINSTANCE hInstance, HINSTANCE hPrevInstance, LPSTR lpCmdLine, int nCmdShow) {
    MSG messages;
    RECT rect;
    WNDCLASSEX wndClass;
    int screenWidth, screenHeight;
    int x, y, w, h;
    GLuint      PixelFormat;

    screenWidth = GetSystemMetrics(SM_CXSCREEN);
    screenHeight = GetSystemMetrics(SM_CYSCREEN);

    rect.left = (screenWidth - 582) / 2;
    rect.top = (screenHeight - 358) / 2;
    rect.right = rect.left + 582;
    rect.bottom = rect.top + 358;

    x = rect.left;
    y = rect.top;
    w = 640;
    h = 480;

    wndClass.hInstance = hInstance;
    wndClass.lpszClassName = szClassName;
    wndClass.lpfnWndProc = WindowProcedure;
    wndClass.style = CS_DBLCLKS;
    wndClass.cbSize = sizeof (WNDCLASSEX);
    wndClass.hIcon = LoadIcon (NULL, IDI_APPLICATION);
    wndClass.hIconSm = LoadIcon (NULL, IDI_APPLICATION);
    wndClass.hCursor = LoadCursor (NULL, IDC_ARROW);
    wndClass.lpszMenuName = NULL;
    wndClass.cbClsExtra = 0;
    wndClass.cbWndExtra = 0;
    wndClass.hbrBackground = (HBRUSH)(COLOR_BTNFACE + 1);

    if (!RegisterClassEx (&wndClass)) {
        return 0;
    }

    glab.hWnd = CreateWindowEx (
           0,
           szClassName,
           "GLab - OpenGL",
           WS_OVERLAPPEDWINDOW,
           x,
           y,
           w,
           h,
           HWND_DESKTOP,
           NULL,
           hInstance,
           NULL 
           );

    static  PIXELFORMATDESCRIPTOR pfd=  {
        sizeof(PIXELFORMATDESCRIPTOR),
        1,
        PFD_DRAW_TO_WINDOW | PFD_SUPPORT_OPENGL | PFD_DOUBLEBUFFER,
        PFD_TYPE_RGBA,
        16, // Can be 32 tough :)
        0, 0, 0, 0, 0, 0,
        0,
        0,
        0,
        0, 0, 0, 0, 
        16, 
        0,
        0,
        PFD_MAIN_PLANE, 
        0,
        0, 0, 0 
    };

    if (!(hDC=GetDC(glab.hWnd))) {
        MessageBox(NULL,"Can't Create A GL Device Context.","ERROR",MB_OK|MB_ICONEXCLAMATION);
        return FALSE;
    }

    if (!(PixelFormat=ChoosePixelFormat(hDC,&pfd))) {
        MessageBox(NULL,"Can't Find A Suitable PixelFormat.","ERROR",MB_OK|MB_ICONEXCLAMATION);
        return FALSE;
    }

    if(!SetPixelFormat(hDC,PixelFormat,&pfd)) {
        MessageBox(NULL,"Can't Set The PixelFormat.","ERROR",MB_OK|MB_ICONEXCLAMATION);
        return FALSE;
    }

    if (!(hRC=wglCreateContext(hDC))) {
        MessageBox(NULL,"Can't Create A GL Rendering Context.","ERROR",MB_OK|MB_ICONEXCLAMATION);
        return FALSE;
    }

    if(!wglMakeCurrent(hDC,hRC)) {
        MessageBox(NULL,"Can't Activate The GL Rendering Context.","ERROR",MB_OK|MB_ICONEXCLAMATION);
        return FALSE;
    }

    ShowWindow (glab.hWnd, nCmdShow);
    SetForegroundWindow(glab.hWnd);
    SetFocus(glab.hWnd);
    GL_ReSizeGLScene( w, h );

    if (!GL_init() ) {
        MessageBox(NULL,"Initialization Failed.","ERROR",MB_OK|MB_ICONEXCLAMATION);
        return false;
    }

    while (GetMessage (&messages, NULL, 0, 0)) {
        TranslateMessage(&messages);
        DispatchMessage(&messages);

        if( !GL_drawit() ) {
            MessageBox(NULL,"Initialization Failed.","ERROR",MB_OK|MB_ICONEXCLAMATION);
            return false;
        }
        SwapBuffers(hDC);
    }

    return messages.wParam;
}

GLvoid GL_ReSizeGLScene(GLsizei width, GLsizei height) {
    if (height==0) {
        height=1;
    }

    glViewport(0,0,width,height);
    glMatrixMode(GL_PROJECTION);
    glLoadIdentity();
    gluPerspective(45.0f,(GLfloat)width/(GLfloat)height,0.1f,100.0f);
    glMatrixMode(GL_MODELVIEW);
    glLoadIdentity();
}

int GL_init( GLvoid ) {
    glShadeModel(GL_SMOOTH);
    glClearColor(0.0f, 0.0f, 0.0f, 0.5f);
    glClearDepth(1.0f);
    glEnable(GL_DEPTH_TEST);
    glDepthFunc(GL_LEQUAL);
    glHint(GL_PERSPECTIVE_CORRECTION_HINT, GL_NICEST);
    return true;
}

int GL_drawit( GLvoid ) {
    glClear(GL_COLOR_BUFFER_BIT | GL_DEPTH_BUFFER_BIT);
    glLoadIdentity();
    glTranslatef(-1.5f,0.0f,-6.0f);
    glBegin(GL_TRIANGLES);
        glVertex3f( 0.0f, 1.0f, 0.0f);
        glVertex3f(-1.0f,-1.0f, 0.0f);
        glVertex3f( 1.0f,-1.0f, 0.0f);
    glEnd();            
    return true;
} 
```

**编辑**：我还将您的`GL_drawit()`调用移至事件循环，以便它重新绘制以响应调整大小事件。好吧，真的是任何事件。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-06-05T18:42:27.113

初始化 OpenGL 窗口很棘手并且依赖于硬件。[建议您首先在GLUT](http://user.xmission.com/~nate/glut.html)构建的窗口中尝试您的 OpenGL 代码。在它在那里工作之后，如果关于 GLUT 的某些内容在您的应用程序中不起作用，您可以了解它的源代码以了解如何初始化您自己的 OpenGL 窗口。

# objective-c - CGRectApplyAffineTransform 什么都不做？

> ID：10902818
> 
> 赞同：2
> 
> 时间：2012-06-05T18:30:13.647
> 
> 标签：objective-c, ios, cgaffinetransform

我是 CGAffine 世界的新手。任何人都知道为什么我的转型不起作用/采取？

1.  我有一个使用 UIGraphicsBeginPDFContextToData 创建的有效 PDFContext 和以下当前矩阵：

    ```
    CGAffineTransform curMat = CGContextGetCTM(context);
    NSLog (@"current context matrix: %f %f %f %f %f %f", curMat.a, curMat.b, curMat.c, curMat.d, curMat.tx, curMat.ty); 
    ```

2.  NSLog 值：

    当前矩阵：1.000000 0.000000 -0.000000 -1.000000 0.000000 792.000000

3.  我使用以下方法创建转换矩阵：

    ```
    CGAffineTransform xform = CGAffineTransformMake(a, b, c, d, tx, ty); 
    ```

4.  NSLog 值：

    变换矩阵：0.062500 0.000000 0.000000 0.062500 0.000000 0.000000

5.  我从以下位置得到我的矩形：

    ```
    CGRect pdfBounds = UIGraphicsGetPDFContextBounds(); 
    ```

6.  NSLog 值：

    pdf边界：0.000000 0.000000 612.000000 792.000000

7.  我将转换矩阵应用于：

    ```
     CGRectApplyAffineTransform (pdfBounds, xform); 
    ```

8.  然后我重新检查当前矩阵值：

    ```
    CGAffineTransform curMat2 = CGContextGetCTM(context);
    NSLog (@"current context matrix after transformation: %f %f %f %f %f %f", curMat2.a, curMat2.b, curMat2.c, curMat2.d, curMat2.tx, curMat2.ty) 
    ```

9.  并且 NSLog 值与开始时相同。

    转换后的当前上下文矩阵：1.000000 0.000000 -0.000000 -1.000000 0.000000 792.000000

我错过了什么？为什么没有发生/发生转变？谢谢你。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-06-05T18:42:15.680

您忽略了应用转换的结果，也没有对上下文应用任何转换。

第 7 步应该是：

```
CGContextConcatCTM(context, xform); 
```

# this - C#：方法声明中的 this

> ID：10902820
> 
> 赞同：0
> 
> 时间：2012-06-05T18:30:22.593
> 
> 标签：this

我遇到了一个代码部分，其中方法声明如下所示；

```
 public MethodName(
        ISessionAwareRepo<MCC_Message> param1,
        ISessionAwareRepo<MCC_User> param2,
        ISessionAwareRepo<MCC_Directory> param3,
        ISessionAwareRepo<MCC_MessageInDirectory> param4,
        ISessionAwareRepo<MCC_Conversation> param5,
        ISessionAwareRepo<MCC_MessageRecipient> param6)
        : this(null, param1, param2, param3,
        param4, param5, param6) 
```

我不明白**:this**在方法声明中代表什么。有人可以帮忙吗？

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-06-05T18:32:00.160

在构造函数声明中，`: this()`在执行当前构造函数的主体之前，调用与给定方法签名匹配的同一类的另一个构造函数。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-06-05T18:32:32.703

这称为构造函数链接。

在同一个类中存在构造函数的重载 - 参数被传递给重载（因此它在声明构造函数的主体之前执行）。

有关更多详细信息，请参阅MSDN 上的[使用构造函数。](http://msdn.microsoft.com/en-us/library/ms173115.aspx)

# javascript - 包含换行符的字符串

> ID：10902826
> 
> 赞同：0
> 
> 时间：2012-06-05T18:30:43.677
> 
> 标签：javascript, string

> **可能重复：**
> [如何创建多行字符串](https://stackoverflow.com/questions/805107/how-to-create-multiline-strings)

我有很多字符串要放入变量中，但是有一些不被接受的换行符。

Firefox 在我写的时候说“未终止的字符串文字”：

```
var a="foo
bar"; 
```

有没有办法在不手动删除换行符的情况下编写我的字符串？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-06-05T18:33:04.620

如果这是不可接受的：

```
var a="foo" +
"bar"; 
```

或者正如@minitech（新模组）所建议的那样：

```
var a="foo \
bar"; 
```

那么答案是否定的。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-06-05T18:33:18.037

这个脚本是由 Web 服务器动态生成的吗？

如果是这样，此 Web 服务器将需要将换行符转换为`\n`转义序列。对于其他保留字符，例如反斜杠和双引号，您也会遇到同样的问题。

某些语言允许您按字面意思编写字符串常量（例如`@`C# 中的前缀），但是 Javascript 没有这样的功能标准，因此必须对某些字符进行转义。

# json - 在 flexjson 中使用 JSONSerialize 时出错

> ID：10902832
> 
> 赞同：0
> 
> 时间：2012-06-05T18:31:00.520
> 
> 标签：json

当我尝试从数据库中检索和序列化数据时，我的程序似乎无法正常工作。我定义了一个具有以下属性的对象：id title content isPublic ...

每次我连接到我的前端 web 应用程序时，它都会尝试加载笔记、序列化它们，然后在前端显示它们。

但是在尝试序列化笔记列表时遇到了问题。每次我在下面调用这个函数时，它只是无处可去，并且永远不会正确执行。

```
public static String manyToJSON(Iterable<Note> col) {
// if a collection is serialized do not include the content
String[] attrs = new String[]{
    "id",
    "title",
    "owner.id",
    "owner.firstName",
    "owner.lastName",
    "contacts.id",
    "contacts.firstName",
    "contacts.lastName",
    "contacts.telNr",
    "resources.id",
    "resources.name",
    "createdAt",
    "updatedAt",
    "isPublic",
    "isShared"
};
return new JSONSerializer().include(attrs).exclude("*").serialize(col);
} 
```

这可能是任何明显的原因吗？任何帮助，将不胜感激。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-06-06T18:11:02.453

由于这些属性是 Note 的一部分，因此它们被忽略，因为您正在移交一个 Iterable。您需要附加“值”。到每个属性上，所以它告诉 Flexjson 这些属性是 Note 的一部分，而不是 Iterable。

# c# - MonoDroid 使用水平滚动条显示数据库字段

> ID：10902841
> 
> 赞同：1
> 
> 时间：2012-06-05T18:31:35.860
> 
> 标签：c#, xamarin.android

我有一个包含大约 20 列和记录数的表，其范围从 5 到 20+ 不等。我想使用水平和垂直滚动条在屏幕上显示所有这些数据。为了做到这一点，我很担心哪种方法最好。我已经开始使用 listview 解决方案，但有点卡住了。以下是我的布局的 XML（我压缩了表格行，但你明白了）..

```
 <?xml version="1.0" encoding="utf-8"?>
<LinearLayout xmlns:android="http://schemas.android.com/apk/res/android"
    android:id="@+id/LinearLayout1"
    android:layout_width="match_parent"
    android:layout_height="match_parent"
    android:orientation="vertical">
    <Button
        android:id="@+id/btnHome"
        style="@style/homeButton"
        android:layout_width="200dp"
        android:layout_height="wrap_content"
        android:layout_marginTop="5dp"
        android:gravity="center"
        android:text="@string/btnHomeText"
        android:textColor="@color/white"
        android:textStyle="bold" />
    <RelativeLayout
        android:id="@+id/InnerRelativeLayout2"
        android:layout_width="fill_parent"
        android:layout_height="wrap_content"
        android:layout_below="@id/btnHome">
        <LinearLayout
            style="@style/stdWindow"
            android:layout_width="fill_parent"
            android:layout_height="fill_parent"
            android:layout_marginBottom="5dp"
            android:layout_marginLeft="5dp"
            android:layout_marginRight="5dp"
            android:baselineAligned="false"
            android:orientation="vertical">
            <TextView
                android:id="@+id/tvDriverReport"
                android:layout_width="fill_parent"
                android:layout_height="wrap_content"
                android:layout_marginLeft="5dp"
                android:layout_marginRight="5dp"
                android:background="@color/VeryDarkGray"
                android:text="@string/futureFeatureText"
                android:textAppearance="?android:attr/textAppearanceLarge"
                android:textColor="@color/OMSGold" />
            <TableLayout
                android:minWidth="25px"
                android:minHeight="25px"
                android:layout_width="fill_parent"
                android:layout_height="wrap_content"
                android:id="@+id/tableLayout1">
                <TableRow
                    android:id="@+id/tableRow1">
                    <TextView
                        android:text="@string/summaryTicketNumber"
                        android:textAppearance="?android:attr/textAppearanceMedium"
                        android:layout_column="0"
                        android:id="@+id/textView10" />
                    <TextView
                        android:text="@string/summaryDate"
                        android:textAppearance="?android:attr/textAppearanceMedium"
                        android:layout_column="1"
                        android:id="@+id/textView11" />
                    <TextView
                        android:text="@string/summaryTruckNumber"
                        android:textAppearance="?android:attr/textAppearanceMedium"
                        android:layout_column="2"
                        android:id="@+id/textView12" />
                    <TextView
                        android:text="@string/summaryBeginOdometer"
                        android:textAppearance="?android:attr/textAppearanceMedium"
                        android:layout_column="3"
                        android:id="@+id/textView21" />
                    <TextView
                        android:text="@string/summaryEndOdometer"
                        android:textAppearance="?android:attr/textAppearanceMedium"
                        android:layout_column="4"
                        android:id="@+id/textView22" />
                </TableRow>
                <TableRow
                    android:id="@+id/tableRow2">
                    <TextView
                        android:textAppearance="?android:attr/textAppearanceMedium"
                        android:layout_column="0"
                        android:id="@+id/tvTicketNumber" />
                    <TextView
                        android:textAppearance="?android:attr/textAppearanceMedium"
                        android:layout_column="1"
                        android:id="@+id/tvSummaryDate" />
                    <TextView
                        android:textAppearance="?android:attr/textAppearanceMedium"
                        android:layout_column="2"
                        android:id="@+id/tvTruckNumber" />
                    <TextView
                        android:textAppearance="?android:attr/textAppearanceMedium"
                        android:layout_column="3"
                        android:id="@+id/tvBeginOdometer" />
                    <TextView
                        android:layout_column="4"
                        android:textAppearance="?android:attr/textAppearanceMedium"
                        android:id="@+id/tvEndOdometer" />
                </TableRow>
            </TableLayout>
        </LinearLayout>
    </RelativeLayout>
</LinearLayout> 
```

所以基本上表第 1 行是静态标题数据，但之后的每一行都会从数据库中动态填充，所以行数是可变的。

我开始使用自定义列表适配器解决方案，但似乎无法使其正常工作。这是我的自定义列表适配器

```
 public class CustomListAdapter : BaseAdapter
    {
        Activity context;

        public List<TicketSummaryMapper> items;

        public CustomListAdapter (Activity context)
            : base()
        {
            this.context = context;
            var db = new SQLiteConnection (db);
            items = db.Query<TicketSummaryMapper> ("select * from mydatabase");

        }

        public override int Count
        {
            get { return items.Count; }
        }

        public override Java.Lang.Object GetItem(int position)
        {
            return position;
        }

        public override long GetItemId(int position)
        {
            return position;
        }

        public override View GetView (int position, View convertView, ViewGroup parent)
        {

            var item = items [position];            

            var view = (convertView ?? 
                context.LayoutInflater.Inflate (
                    Resource.Layout.ticket_summary, 
                    parent, 
                    false)) as LinearLayout;

            //Find references to each subview in the list item's view
            var textTicketNo = view.FindViewById (Resource.Id.tvTicketNumber) as TextView;
            var textSummaryDate = view.FindViewById (Resource.Id.tvSummaryDate) as TextView;
            var textTruckNumber = view.FindViewById (Resource.Id.tvTruckNumber) as TextView;
            var textBeginOdometer = view.FindViewById (Resource.Id.tvBeginOdometer) as TextView;

            //Assign this item's values to the various subviews
            textTicketNo.SetText (item.TicketNumber, TextView.BufferType.Normal);
            textSummaryDate.SetText (item.TransDate, TextView.BufferType.Normal);
            textTruckNumber.SetText (item.EquipmentNo, TextView.BufferType.Normal);
            textBeginOdometer.SetText (item.BeginOdometer, TextView.BufferType.Normal);

            //Finally return the view
            return view;
        }

        public TicketSummaryMapper GetItemAtPosition(int position)
        {
            return items[position];
        }
    } 
```

然后最后我的活动......

```
[Activity (Label = "AdminActivity")]            
public class AdminActivity : Activity
{
    CustomListAdapter listAdapter;
    public AdminActivity() { }
    public AdminActivity(IntPtr handle, JniHandleOwnership transfer) : base(handle,           transfer) { }

    protected override void OnCreate (Bundle bundle)
    {
        base.OnCreate (bundle);

        //Set the Activity's view to our list layout        
        SetContentView (Resource.Layout.customlist);

        //Create our adapter
        listAdapter = new CustomListAdapter (this);

        //Find the listview reference
        var listView = FindViewById<ListView> (Resource.Id.listView);

        //Hook up our adapter to our ListView
        listView.Adapter = listAdapter;
    }
    } 
```

自定义列表布局基本上只有一个线性布局，后跟一个列表视图，仅此而已。感谢您花时间看这个...

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-06-06T07:14:10.417

尝试使用 ScrollView 设置水平和垂直滚动并在主布局内

```
<ScrollView  xmlns:android="http://schemas.android.com/apk/res/android"
      android:layout_width="fill_parent"
      android:layout_height="fill_parent"
      android:scrollbars="horizontal|vertical">

    <LinearLayout
        android:id="@+id/LinearLayout1"
        android:layout_width="match_parent"
        android:layout_height="match_parent"
        android:orientation="vertical">

     .....

</ScrollView> 
```

# element - 使用 SCSS 获取元素的尺寸？

> ID：10902845
> 
> 赞同：12
> 
> 时间：2012-06-05T18:31:53.373
> 
> 标签：element, sass

我最近发现了 scss，以及它能够使用数学运算符的事实。我想知道的是：**有没有办法让我动态检索元素的尺寸以用于设置不同元素的尺寸？

我想做的一个例子如下（用jQuery编写）：

```
$("#myparagraph").height($("#page").height() / 6); 
```

有没有办法使用scss做到这一点？

* * *

## 回答 #1

> 赞同：25
> 
> 时间：2012-06-05T18:44:36.893

**不。**

虽然 SCSS 将允许您使用变量和数学计算值，但它仍然编译为 CSS。CSS 不是一种可以为 DOM 对象提供计算尺寸的动态语言。它也是不可查询的。SCSS 本身并不是一门单独的语言，而是一个预处理器，可以让您更有效地创建 CSS。因此，您可以在 SCSS 中执行的任何操作都可以在纯 CSS 中执行，反之亦然（尽管可能更难跟踪），仅此而已。

# python - Python邮件程序：无法导入名称邮件程序错误

> ID：10902849
> 
> 赞同：0
> 
> 时间：2012-06-05T18:32:01.913
> 
> 标签：python, email

我正在使用这个 Python 脚本以编程方式测试发送电子邮件：

```
from mailer import Mailer
from mailer import Message

message = Message(From="myname@gmail.com",
              To="myname@aol.com",
              charset="utf-8")
 message.Subject = "An HTML Email"
message.Html = """This email uses <strong>HTML</strong>!"""
message.Body = """This is alternate text."""

sender = Mailer('smtp.gmail.com')
sender.send(message) 
```

我相信我已经安装了 Mailer-0.7（但我该如何检查？），并且在这台 iMac 上运行 Python 2.7。问题是我收到此错误消息：

```
Traceback (most recent call last):
File "email.py", line 1, in <module>
from mailer import Mailer
File "/Users/jeremycondie/Desktop/mailer.py", line 31, in <module>
import smtplib
File "/System/Library/Frameworks/Python.framework/Versions/2.7/lib/python2.7/smtplib.py", line 46, in <module>
import email.utils
File "/Users/jeremycondie/Desktop/email.py", line 1, in <module>
from mailer import Mailer
ImportError: cannot import name Mailer 
```

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-06-05T18:43:09.130

The `from mailer import X` statement is importing from `/Users/jeremycondie/Desktop/mailer.py`, try renaming that file.

**Edit:** To get Mailer's version (after fixing the filename):

```
import mailer
print mailer.__version__ 
```

**Edit 2:** If in the future you run into a similar situation, first check the module location and its attributes to discard that a local file is shadowing a module:

```
print mailer.__file__
print dir(mailer) 
```

# objective-c - 使用 xcode 和 facebook API 管理和存储 facebook 好友的数据

> ID：10902854
> 
> 赞同：0
> 
> 时间：2012-06-05T18:32:12.603
> 
> 标签：objective-c, ios, xcode, facebook, mobile

这是上下文。我的项目中有一个代表奖杯的类。Trophies 对象是从 Core Data 加载的，并且是应用程序的本地对象。在视图控制器中，用户可以看到奖杯列表并且可以修改/创建新的。现在我需要在这些奖杯中添加 facebook 功能。理想情况下，在该奖杯列表（这是一个带有一个部分的表格视图）中，您会在登录时看到您朋友的奖杯。在 Map my Run 应用程序的付费版本中进行了类似的操作，您可以在其中看到您的 facebook 朋友计划的轨道。

我对 Xcode 开发相当陌生，从未接触过 facebook API。据我所见，Facebook 应用程序没有任何真正的远程存储（根据我的阅读，有一个数据存储 API 在 2010 年被弃用）。有一个叫做 Open Graph API 的东西，它可以让你创建和管理你在应用程序中使用的对象，但据我了解，它还不支持移动设备，只能在网络应用程序中使用（我不确定是否这就是我正在寻找的）。

所以我的问题是，实现这种功能的应用程序的结构是什么？我搜索了示例、示例和教程，但我没有看到任何有关此规范的内容。我所看到的只是在您的个人资料中发布/分享图像、链接等内容。

我的第一个猜测是创建我自己的数据库（因为现在它们是使用 Core Data 在本地处理的）并上传人们想要分享的奖杯并将 facebook 用户 ID 附加到该奖杯表的列中，然后加载奖杯匹配他们朋友的用户ID。我错过的 API 中有什么东西可以处理这个问题吗？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-06-05T18:41:19.437

如果您的奖杯不是 facebook 图表中的对象，但您自己管理它们，那么在给他们奖杯时保存人们的 facebook id 将是最简单的方法。

然后查询 /me/friends 的图形 api，以获取用户的朋友 FB id - 然后将该列表与通过 FB id 获得的奖杯列表相交。

# visual-studio-2010 - Cuda：错误 C2065：“threadIdx”：未声明的标识符

> ID：10902855
> 
> 赞同：0
> 
> 时间：2012-06-05T18:32:15.003
> 
> 标签：visual-studio-2010, cuda

我正在尝试在 VisualStudio 2010 中创建一个 Cuda 项目。我创建了一个简单的测试 .cu 文件，该文件接受一个数组并将其所有元素添加 1 并将结果发送回主机。

我已将 cudart.lib 文件添加到链接器。

在 .cu 代码中，我包含了`#include cuda_runtime.h`标题。

但是当我试图编译它时，它给出了两个错误。

> 错误 C2065：'threadIdx'：未声明的标识符
> 错误 C2059：语法错误：'<'

安装 Nvidia Nsight Visual Studio 版本并将 .cu 文件的项目类型设置为 CUDA C/C++ 后，它开始给出两个额外的错误：

> 错误 D8003：缺少源文件名
> 
> 错误 MSB3721：命令 ""C:\Program Files\NVIDIA GPU Computing Toolkit\CUDA\v4.2\bin\nvcc.exe" -gencode=arch=compute_10,code=\"sm_10,compute_10\" --use- local-env --cl-version 2010 -ccbin "C:\Program Files (x86)\Microsoft Visual Studio 10.0\VC\bin" -I"C:\ProgramData\NVIDIA Corporation\NVIDIA GPU Computing SDK 4.2\C\common \inc" -I"C:\ProgramData\NVIDIA Corporation\NVIDIA GPU Computing SDK 4.2\shared\inc" -I"C:\Program Files\NVIDIA GPU Computing Toolkit\CUDA\v4.2\include" -G -- keep-dir "Debug" -maxrregcount=0 --machine 32 --compile -g -Xcompiler "/EHsc /nologo /Od /Zi /MDd " -o "Debug\test.cu.obj" "\ucigrad.local\ Users\AGill\My Documents\Visual Studio 2010\Projects\cudatest\cudatest\test.cu"" 以代码 2 退出。

请帮助我如何解决它。我认为 VS2010 中的 nvcc 编译器可能存在一些问题，但我无法弄清楚。

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2013-04-06T19:03:53.810

如果您像我一样对 IDE 错误（仍然让您的代码正常工作）感到恼火，请尝试在 SDK 的包含文件夹中进行纯文本搜索以查找（看似）未定义的符号，您会找到正确的标题立即包括在内。例如，“threadIdx”驻留在“device_launch_parameters.h”头文件中。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-06-06T05:51:11.363

您收到的错误很可能表明您没有使用 NVCC 编译 CUDA 源代码。如果您在安装工具包时安装了 Visual Studio 集成，请通过选择适当的项目类型 (CUDA C/C++) 来确保您是。或者确保您已经为您的源设置了适当的构建规则。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-06-07T06:14:28.353

1.  有 2 种类型的错误 - 构建错误和 IDE 错误。检查构建是否成功（可以忽略 IDE 错误）

2.  尝试 #include "cuda.h" （或使用尖括号）

3.  重建有时可以解决问题

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2022-01-20T06:34:19.370

对于那些即使按照上述步骤也有问题的人，对我有用的解决方案是在 .cu 文件的属性下将“ItemType”更改为“CUDA C/C++”。

# c# - 删除数据集的约束

> ID：10902861
> 
> 赞同：0
> 
> 时间：2012-06-05T18:32:37.837
> 
> 标签：c#, dataset, constraints

我是 ASP.NET 的新手，所以这个问题可能听起来很愚蠢，但我真的需要帮助。我收到错误：

> 无法启用约束。一行或多行包含违反非空、唯一或外键约束的值。

所以我决定选择 Visual Studio 建议的快速方法：在我的数据集中转换约束。根据我在 Internet 上找到的内容，解决方案是添加`photoDataTable.EnforceConstraints = false;`，但随后出现另一个错误：

> “PhotoDataSet.PhotosDataTable”不包含“EnforceConstraints”的定义，并且找不到接受“PhotoDataSet.PhotosDataTable”类型的第一个参数的扩展方法“EnforceConstraints”（您是否缺少 using 指令或程序集引用？）

我想知道是否需要包含任何“使用”，如果需要，我应该包含什么？否则，我该怎么办？请帮忙。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-06-05T18:33:53.920

`EnforceConstraints`是[DataSet](http://msdn.microsoft.com/en-us/library/system.data.dataset.aspx)的属性，而不是[DataTable](http://msdn.microsoft.com/en-us/library/system.data.datatable.aspx)。

# backwards-compatibility - Visual Studio 2012 csproj 是否向后兼容 2010？

> ID：10902865
> 
> 赞同：52
> 
> 时间：2012-06-05T18:32:59.963
> 
> 标签：backwards-compatibility, visual-studio-2012

问题是我是否可以安全地使用 Visual Studio 2012 来编辑项目属性、添加和删除解决方案、引用，所有这些都与 NET 4.0 Framework 相关。

我记得过去有些文件可能“损坏”，而 Visual Studio 2010 更改了一些 Visual Studio 2008 csproj 信息（xml 文件）。

如果在 VS2012 中添加/删除了某些标签，那么 csproj 将与 VS2010 开发人员不兼容。

如果在不损坏文件的情况下使用这个新 IDE 是安全的，有没有人知道一些信息？VS2012 csprojs 是否与 VS2010“向后兼容”？

* * *

## 回答 #1

> 赞同：73
> 
> 时间：2012-06-06T21:31:39.417

VS2012 项目大多*向后兼容 VS2010 **SP1**。这些项目将像所有以前的 VS 版本一样经历转换/迁移过程，但这个对 VS2010 很友好。您应该能够更改您的项目/参考/代码文件并在 VS2010 中再次打开它们而不会出现问题。

我说主要是因为 VS2012 中的一些新功能可能无法向后兼容。最明显的是，如果您将项目升级到 .NET 4.5，它将不再适用于 VS2010。有关此方案的详细信息，请参阅[http://blogs.msdn.com/b/visualstudio/archive/2012/03/28/round-tripping-with-visual-studio-11.aspx 。](http://blogs.msdn.com/b/visualstudio/archive/2012/03/28/round-tripping-with-visual-studio-11.aspx)

# .net - 如何访问父母的绑定？还是更好的方法？

> ID：10902869
> 
> 赞同：0
> 
> 时间：2012-06-05T18:33:18.217
> 
> 标签：.net, wpf, xaml, binding, event-handling

```
<toolkit:HubTile Title="{Binding AppName, Converter={StaticResource AddNewLineConvertor}}" Message="{Binding AppDescription}" Source="{Binding AppIconLocation}" GroupTag="featuredAppHubTiles" Margin="0, 0, 20, 20" Tap="featuredAppTapped">
                                <toolkit:ContextMenuService.ContextMenu>
                                    <toolkit:ContextMenu>
                                        <toolkit:MenuItem Header="Share" Tap="ShareFeaturedAppTapped"/>
                                    </toolkit:ContextMenu>
                                </toolkit:ContextMenuService.ContextMenu>
                            </toolkit:HubTile> 
```

嗨，大家好。

在上面的代码中，我试图在`ShareFeaturedAppTapped`事件处理程序中获取应用程序的名称，但当然，事件参数中提供的唯一项是`MenuItem`，它没有任何我可以真正绑定`AppName`到的属性。

你将如何得到它？

我已经尝试访问父元素（`HubTile`），但这似乎不合适。

谢谢，

丹尼

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-06-05T23:06:57.113

```
‎((sender as FrameworkElement).DataCont​ext as MyClass 
```

其中 MyClass 是您的绑定类

# android - Android：如何从歌曲中排除铃声和通知

> ID：10902871
> 
> 赞同：2
> 
> 时间：2012-06-05T18:33:21.727
> 
> 标签：android, mediastore

我正在开发一个音乐播放器应用程序并通过以下代码查询专辑名称：

```
Cursor mediacur = managedQuery(MediaStore.Audio.Media.EXTERNAL_CONTENT_URI, null, null, null, null);
mediacur.moveToFirst();
do{
        albumindex = mediacur.getColumnIndex(MediaStore.Audio.Media.ALBUM);
        albumname = mediacur.getString(albumindex);
        songs.add(albumname);
  }while(mediacur.moveToNext()); 
```

我也收到了所有专辑名称以及铃声和通知。如何从我的列表中排除铃声和通知？

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-06-05T18:36:53.750

向托管查询调用添加选择。

```
String selection = MediaStore.Audio.Media.IS_MUSIC + " != 0";
Cursor mediacur = managedQuery(MediaStore.Audio.Media.EXTERNAL_CONTENT_URI, null, selection, null, null); 
```

# c++ - cv::goodFeaturesToTrack 不返回任何功能

> ID：10902881
> 
> 赞同：5
> 
> 时间：2012-06-05T18:34:23.957
> 
> 标签：c++, opencv, computer-vision, opticalflow

我正在尝试使用[`cv::calcOpticalFlowPyrLK`](http://opencv.willowgarage.com/documentation/cpp/structural_analysis_and_shape_descriptors.html#cv-pointpolygontest)，但有时该函数中的内部断言会失败。断言是`npoints = prevPtsMat.checkVector(2, CV_32F, true)) >= 0`。我正在使用 OpenCV 2.3.1。此函数的源代码可[在此处](http://code.opencv.org/svn/opencv/branches/2.3/opencv/modules/video/src/lkpyramid.cpp)获得。

我很难理解他们的代码，尤其是因为我在计算机图形方面的经验有限并且他们缺乏评论。为什么会触发此断言，它对我的​​问题有什么看法？

**编辑**：我调用函数如下：

```
cv::calcOpticalFlowPyrLK(curBwFrame, prvFrame, features, newFeatures, trackingStatus, errors); 
```

我发现通过使用看起来足够大和有效图像的非空掩码`features`调用获得的向量`cv::goodFeaturesToTrack(curBwFrame, features, 5, 0.2, 0.5, skinMask);`不包含任何特征。这怎么可能发生？

**curBwFrame**

![curBwFrame](../Images/fd33c94dc297f2b80ea05d375909b385.png)

**皮肤面膜**

![皮肤面膜](../Images/07d6a4e12c2d5adca14e291a1f78e9cc.png)

我可以使用以下代码片段重现该问题：

```
#include <vector>
#include <cassert>
#include <opencv2\opencv.hpp>
using std::vector;
using namespace cv;

int main() {
    vector<Point2f> features;
    cv::Mat curBwFrame = imread("curBwFrame.png");
    cv::cvtColor(curBwFrame, curBwFrame, CV_RGB2GRAY);
    imwrite("test.png", curBwFrame);

    cv::Mat skinMask = imread("skinMask.png");
    cv::cvtColor(skinMask, skinMask, CV_RGB2GRAY);
    imwrite("test.png", skinMask);

    cv::goodFeaturesToTrack(curBwFrame, features, 5, 0.2, 0.5, skinMask);
    assert(features.size() > 0);

    return 0;
} 
```

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-06-11T18:05:46.663

主要问题是您的参数。在[OpenCV 2.3.2 文档](http://www.opencv.org.cn/opencvdoc/2.3.2/html/modules/imgproc/doc/feature_detection.html)中（2.3.1 之间没有兼容性更改）这是方法参数的描述：

```
void goodFeaturesToTrack(InputArray image, OutputArray corners, int maxCorners, double qualityLevel, double minDistance, InputArray mask=noArray(), int blockSize=3, bool useHarrisDetector=false, double k=0.04 ) 
```

参数：

*   image – 输入 8 位或浮点 32 位单通道图像。
*   角 - 检测到的角的输出向量。
*   maxCorners – 要返回的最大角点数。如果角点多于找到的角点，则返回最强的角点。
*   **qualityLevel** – 表征图像角的最低可接受质量的参数。参数值乘以最佳角质量度量，即最小特征值（参见cornerMinEigenVal()）或哈里斯函数响应（参见cornerHarris()）。质量度量低于产品的角将被拒绝。例如，如果最佳角的质量度量 = 1500，并且 qualityLevel=0.01 ，则质量度量小于 15 的所有角都将被拒绝。
*   **minDistance** – 返回的角点之间可能的最小欧几里得距离。
*   掩码——可选的感兴趣区域。如果图像不是空的（它需要具有 CV_8UC1 类型并且与 image 大小相同），它指定检测角的区域。
*   blockSize – 用于计算每个像素邻域的导数协变矩阵的平均块的大小。参见cornerEigenValsAndVecs()。
*   useHarrisDetector – 指示是否使用 Harris 检测器的参数（参见cornerHarris()）或cornerMinEigenVal()。
*   k – Harris 检测器的自由参数。

**我建议您使用 qualityLevel 和 minDistance 来满足您的需求。**

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-06-11T13:43:10.480

您是否尝试过**不带遮罩**的 goodFeaturesToTrack以查看它是否检测到遮罩区域内的特征？可能是因为图像很暗，并且该区域有点无纹理，所以 goodFeaturesToTrack 无法在那里找到特征。

您也可以尝试[ORB 或 FAST](http://docs.opencv.org/modules/features2d/doc/feature_detection_and_description.html)，而不是 goodFeaturesToTrack。我已经成功地将 ORB 与 calcOpticalFlowPyrLK 一起使用（但没有尝试使用掩码）。

或者您可以尝试使图像变亮，甚至增强对比度。不确定这是否会带来改进，因为我认为您的场景中最大的问题是场景中的对象没有足够的纹理或角落，这是这些检测器更适合的特征。我建议你试试ORB，看看你能不能得到更多的积分。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-06-12T17:10:13.377

图像是否以彩色开始？在转换为灰色之前，使用 cv::transform 增强颜色对比度。拍摄从 0 到 255 的全范围灰度。不要担心蒙版外的图像会饱和。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2016-11-22T19:15:52.167

如果您的代码与此类似：

```
 Imgproc.goodFeaturesToTrack(mCurrentFrame, initial, NUMBER_OF_FEATURES, 0.1, 10); 
 //The OpenCV opticalFlow will crash if the feature vector does not include any elements
 if (initial.elemSize() == 0) {
     return;
 }
 initial.convertTo(mPrevPts, CvType.CV_32FC2);

 Video.calcOpticalFlowPyrLK(mPreviousFrame, mCurrentFrame, mPrevPts, mNextPts, status,err); 
```

确保不要忘记检查特征向量大小的语句 (initial.elemSize() == 0)。

如果此向量为空，则不会发生由 initial.convertTo() 行完成的从点矩阵到浮点的转换，并且在调用 calOpticalFlowPyrLK 时将显示断言

# c# - 有一个与类同名的成员是不好的风格吗？

> ID：10902889
> 
> 赞同：3
> 
> 时间：2012-06-05T18:34:47.030
> 
> 标签：c#, .net, coding-style

假设我有`class Foo`并且

```
class FooFrobber
{
   private Foo _foo;

   FooFrobber(Foo foo)
   {
       _foo = foo;
   }

   Frob()
   {
      _foo.FrobCount += 1;
   }
} 
```

这似乎`_foo`是一个`private`字段的好名称，但如果我想将其设为`internal`or`protected`变量怎么办？约定（[http://weblogs.asp.net/lhunt/archive/2004/08/17/CSharpCodingStandardsv113.aspx](http://weblogs.asp.net/lhunt/archive/2004/08/17/CSharpCodingStandardsv113.aspx) via [Style guide for c#?](https://stackoverflow.com/questions/4678178/style-guide-for-c)）似乎是使用没有 m_ 或尾随 _ 的 StudlyCaps，这意味着我会宣布`protected Foo Foo`。这似乎可行，但隐藏类名似乎有点奇怪。样式指南说所有字段都应该是私有的，但这似乎有点过分（但也许这是我内心的 python 说话）。无论如何，如果我们想将 _foo 包装在一个属性中，您似乎也会遇到同样的问题。

我是否应该总是为该字段取一个不同的名称，例如在 MyFoo 中？可以保持原样吗，因为编译器似乎不介意？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-06-05T18:39:07.093

允许和常见的做法是具有与其类型共享相同名称的字段/属性。从 FCL 中想到的第一个例子是[`DispatcherObject.Dispatcher`](http://msdn.microsoft.com/en-us/library/system.windows.threading.dispatcherobject.dispatcher.aspx)，它返回一个 type 的实例[`Dispatcher`](http://msdn.microsoft.com/en-us/library/system.windows.threading.dispatcher.aspx)。

但是，我个人更喜欢避免将字段声明为受保护，而是使用属性。如果您想避免与声明支持字段相关的编码，您可以使用自动实现的属性：

```
protected Foo Foo { get; set; } 
```

使用属性的优点是您可以为 getter 和 setter 应用不同的访问修饰符：

```
protected Foo Foo { get; private set; } 
```

**编辑**：使用受保护属性而不是受保护字段的优点是它们允许您更改它们的实现——例如，引入值验证或更改通知——而不会破坏可能访问它的外部库。

例如，假设您想扩展您的类以实现`INotifyPropertyChanged`. 如果您使用的是受保护的字段，则没有直接的方法可以检测该字段的值何时被消费程序集更改（除非您也更改了外部程序集的实现）。如果您使用的是受保护的属性，则可以简单地更改其实现，而无需对使用程序集进行任何更改：

```
private Foo foo;

protected Foo Foo 
{ 
    get
    {
        return foo;
    }
    set
    {
        if (foo != value)
        {
            foo = value;
            OnPropertyChanged("Foo");
        }
    }
} 
```

**编辑[2]** [： LBushkin 的回答](https://stackoverflow.com/a/1568230/1149773)中给出了在字段上使用属性的更多优点。

将字段更改为属性似乎会破坏 ABI。我还没有在权威来源中找到它（我没有花太多时间寻找）；但是，根据[pst 的评论](https://stackoverflow.com/questions/7641265/public-variables-need-of-properties-c-sharp#comment9281486_7641286)：

> 可以更改属性背后的代码（使用自定义私有支持字段或其他）。但是，将公共成员变量更改为属性是 ABI（应用程序二进制接口）中的一项重大更改。

根据[jstedfast 的回答](https://stackoverflow.com/a/2150533/1149773)：

> 首先要记住的是属性访问器被编译成方法。这意味着它具有与仅读取/写入类成员变量不同的 ABI，即使它在语法上可能看起来相同。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-06-05T18:45:18.107

这是一种常见的做法，主要来自`C++`世界，将字段命名`_`为前面。像这样的命名转换是绝对可以的，直到它们符合开发组的要求。

在理想世界中，或者（比如说）*尽可能多地*命名变量的方向，是不要在其名称中突出显示`type`变量的名称，而是它在这个程序中所代表的**含义。**

所以而不是拥有（说）

`string sName`, 有一个`string userName`, 而不是`Robot robot`, 有`Robot conveyor`, 等等...

希望这可以帮助。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-06-05T18:38:39.570

我认为保持原样是绝对可以的。编译器能够判断您的代码是指类还是属性，以及如果类名足够表达，为什么还要引入另一个术语。

# primefaces - primefaces 数据表 filterBy、sortBy 和分页选项不起作用

> ID：10902898
> 
> 赞同：1
> 
> 时间：2012-06-05T18:35:50.820
> 
> 标签：primefaces

我正在使用 primefaces3.3 版本。我有一个数据表来显示详细信息，并将 CRUD 按钮作为数据表页脚的一部分。在数据表中选择特定行后，单击 CRUD 按钮会显示一个对话框。

当我单击对话框中的“保存”按钮时，将保存数据并刷新数据表。但是， sortBy ，分页选项在此之后不起作用。随着此数据表的选择模式更改为多个。此行为在 IE 8 和 FF 12 中可重现。它在 Google Chrome 19 中运行良好。附加了 xhtml 和 Backing Bean 代码。

帐户.xhtml

```
 <h:head>
   <script type="text/javascript">
      function handleDialogSubmit(xhr, status, args) {
         if (args != null) {
       if (args.validationFailed) {
           accountDialog.show();
           return true;
       } else {
          accountDialog.hide();
      return true;
       }
       }

    }
</script>
</h:head> 
<h:body>
<ui:composition template="/template.xhtml">
  <ui:define name="body"> 
     <h:form id="form" prependId="false">
        <p:contextMenu for="dataTable">
           <p:menuitem value="View" update=":form2:accountDisplay"
              icon="ui-icon-search" oncomplete="accountDialog.show()"
              process="@this">
              <f:setPropertyActionListener value="#{account}"
                 target="#{accountBean.selectedAccount}" />
           </p:menuitem>
           <p:menuitem value="Edit" update=":form2:accountDisplay"
              icon="ui-icon-edit" oncomplete="accountDialog.show()"
              process="@this" immedeate="true">
              <f:setPropertyActionListener value="#{account}"
                 target="#{accountBean.currentAccount}" />
           </p:menuitem>
           <p:menuitem value="Delete" update=":dialogForm:confirmDialog"
              icon="ui-icon-close" oncomplete="confirmation.show()" />
        </p:contextMenu>

        <h:panelGroup id="dataPanel">
           <p:dataTable var="account" value="#{accountBean.accounts}"
              paginator="true" rows="20" rowKey="#{account.accountCode}"
              paginatorTemplate="{CurrentPageReport}  {FirstPageLink} {PreviousPageLink} {PageLinks} {NextPageLink} {LastPageLink} {RowsPerPageDropdown}"
              id="dataTable">
              <p:column
                 headerText="Edit|View|Delete">

                 <p:commandLink id="selectButton1" update=":form2:accountDisplay"
                    title="Edit" process="@this" oncomplete="accountDialog.show()">
                    <h:outputText value="Edit" />
                    <f:setPropertyActionListener value="#{account}"
                       target="#{accountBean.currentAccount}" />
                 </p:commandLink>
                      |
                      <p:commandLink id="detailButton1"
                    update=":form2:accountDisplay" title="View Details"
                    oncomplete="accountDialog.show()" process="@this">
                    <h:outputText value="View" />
                    <f:setPropertyActionListener value="#{account}"
                       target="#{accountBean.selectedAccount}" />
                 </p:commandLink>
                      |
                      <p:commandLink id="showDialogButton1"
                    update=":dialogForm:confirmDialog" title="Delete"
                    oncomplete="confirmation.show()" process="@this">
                    <h:outputText value="Delete" />
                    <f:setPropertyActionListener value="#{account}"
                       target="#{accountBean.selectedAccount}" />
                 </p:commandLink>

              </p:column>
              <p:column id="accountCode" headerText=" Account Code"
                 sortBy="#{account.accountCode}" filterBy="#{account.accountCode}"
                 filterMatchMode="startsWith" footerText="startsWith">
                 <h:outputText value="#{account.accountCode}" />
              </p:column>
              <p:column id="alertCode" headerText=" Alert Code"
                 sortBy="#{account.alertCode}" filterBy="#{account.alertCode}"
                 filterMatchMode="contains" footerText="contains">
                 <h:outputText value="#{account.alertCode}" />
              </p:column>
              <p:column id="clearAgentID" headerText=" Clr Agent#"
                 sortBy="#{account.clearAgentID}"
                 filterBy="#{account.clearAgentID}" filterMatchMode="startsWith"
                 footerText="startsWith">
                 <h:outputText value="#{account.clearAgentID}" />
              </p:column>
              <p:column id="globalAccountNum" headerText=" Global Acct#"
                 sortBy="#{account.globalAccountNum}"
                 filterBy="#{account.globalAccountNum}"
                 filterMatchMode="startsWith" footerText="startsWith">
                 <h:outputText value="#{account.globalAccountNum}" />
              </p:column>
              <p:column id="safeKeepingAccountNum"
                 headerText=" Safekeeping Acct#"
                 sortBy="#{account.safeKeepingAccountNum}"
                 filterBy="#{account.safeKeepingAccountNum}"
                 filterMatchMode="startsWith" footerText="startsWith">
                 <h:outputText value="#{account.safeKeepingAccountNum}" />
              </p:column>
              <p:column id="destinationID" headerText=" Primary Dest ID"
                 sortBy="#{account.destinationID}"
                 filterBy="#{account.destinationID}" filterMatchMode="startsWith"
                 footerText="startsWith">
                 <h:outputText value="#{account.destinationID}" />
              </p:column>
              <p:column id="addlDestinationID1" headerText=" Addl Dest ID1"
                 sortBy="#{account.addlDestinationID1}"
                 filterBy="#{account.addlDestinationID1}"
                 filterMatchMode="startsWith" footerText="startsWith">
                 <h:outputText value="#{account.addlDestinationID1}" />
              </p:column>
              <p:column id="addlDestinationID2" headerText=" Addl Dest ID2"
                 sortBy="#{account.addlDestinationID2}"
                 filterBy="#{account.addlDestinationID2}"
                 filterMatchMode="startsWith" footerText="startsWith">
                 <h:outputText value="#{account.addlDestinationID2}" />
              </p:column>
              <p:column id="addlDestinationID3" headerText=" Addl Dest ID3"
                 sortBy="#{account.addlDestinationID3}"
                 filterBy="#{account.addlDestinationID3}"
                 filterMatchMode="startsWith" footerText="startsWith">
                 <h:outputText value="#{account.addlDestinationID3}" />
              </p:column>
              <p:column id="destinationName" headerText=" Primary Dest Name"
                 sortBy="#{account.destinationName}"
                 filterBy="#{account.destinationName}"
                 filterMatchMode="startsWith" footerText="startsWith">
                 <h:outputText value="#{account.destinationName}" />
              </p:column>
              <p:column id="conBIC" headerText=" Cont BIC"
                 sortBy="#{account.conBIC}" filterBy="#{account.conBIC}"
                 filterMatchMode="startsWith" footerText="startsWith">
                 <h:outputText value="#{account.conBIC}" />
              </p:column>
              <p:column id="accountStatus" headerText=" Status"
                 sortBy="#{account.accountStatus}"
                 filterOptions="#{account.accountStatus}" filterMatchMode="exact"
                 footerText="exact">
                 <h:outputText value="#{account.accountStatus}" />
              </p:column>
              <p:column id="comments"
                 headerText="Comments"
                 sortBy="#{account.comments}" filterBy="#{account.comments}"
                 filterMatchMode="startsWith" footerText="startsWith">
                 <h:outputText value="#{account.comments}" />
              </p:column>
              <p:column id="createdBy" headerText=" Created By"
                 sortBy="#{account.createdBy}" filterBy="#{account.createdBy}"
                 filterMatchMode="startsWith" footerText="startsWith">
                 <h:outputText value="#{account.createdBy}" />
              </p:column>
              <p:column id="createdDate" headerText=" Created Date"
                 sortBy="#{account.createdDate}" filterBy="#{account.createdDate}"
                 filterMatchMode="startsWith" footerText="startsWith">
                 <h:outputText value="#{account.createdDate}" />
              </p:column>
              <p:column id="modifiedBy" headerText=" Modified By"
                 sortBy="#{account.modifiedBy}" filterBy="#{account.modifiedBy}"
                 filterMatchMode="startsWith" footerText="startsWith">
                 <h:outputText value="#{account.modifiedBy}" />
              </p:column>
              <p:column id="modifiedDate" headerText=" Modified Date"
                 sortBy="#{account.modifiedDate}"
                 filterBy="#{account.modifiedDate}" filterMatchMode="startsWith"
                 footerText="startsWith">
                 <h:outputText value="#{account.modifiedDate}" />
              </p:column>
              <!--          <f:facet name="footer">
              <p:toolbar>
                 <p:toolbarGroup align="left">

                 <p:tooltip for="btnAdd" value="Add New Account" />
                 <p:commandButton id="btnRefresh" styleClass="refreshButton"
                    title="Refresh Account Information" value="Refresh"
                    icon="ui-icon-refresh"
                    actionListener="#{accountBean.populateAccounts}"
                    update=":form:dataTable,:form2:display" immediate="true"/>
                 <p:tooltip for="btnRefresh" value="Refresh Account Details" />
                 <p:commandButton id="selectButton" update=":form2:accountDisplay"
                    icon="ui-icon-edit" title="Edit Account Details" value="Edit"
                    process="@this" oncomplete="accountDialog.show()" immediate="true">
                    <f:setPropertyActionListener value="#{account}"
                       target="#{accountBean.currentAccount}" /> 
                 </p:commandButton>
                 <p:commandButton id="detailButton" value="View"
                    icon="ui-icon-view" update=":form2:accountDisplay"
                    title="View Account Details" oncomplete="detailDialog.show()"
                    process="@this" immediate="true">
                     <f:setPropertyActionListener value="#{account}"
                       target="#{accountBean.selectedAccount}" />
                 </p:commandButton>
                 <p:commandButton id="showDialogButton" icon="ui-icon-delete"
                    value="Delete" update=":dialogForm:confirmDialog"
                    title="Delete Account Details" oncomplete="confirmation.show()"
                    process="@this" immediate="true">
                     <f:setPropertyActionListener value="#{account}"
                       target="#{accountBean.selectedAccount}" /> 
                 </p:commandButton>
                 </p:toolbarGroup>
              </p:toolbar>

           </f:facet> -->
              <f:facet name="footer">
              <p:toolbar>
              <p:toolbarGroup align="left">
                          <p:commandButton id="btnAdd" value="Add" title="Add New Account"
                    icon="ui-icon-add"
                    oncomplete="accountDialog.show()" />                  
                 <p:commandButton id="editButton" value="Edit" icon="ui-icon-edit"
                    update=":form2:accountDisplay" oncomplete="accountDialog.show()">

                 </p:commandButton>
                 <p:commandButton id="showDialogButton" icon="ui-icon-delete"
                    value="Delete"
                    title="Delete Account Details" oncomplete="confirmation.show()">
                 </p:commandButton>
                 <p:commandButton id="viewButton" value="View"
                    icon="ui-icon-search" update=":form2:display"
                    oncomplete="accountDialog.show()" />
                 <p:commandButton id="btnRefresh" styleClass="refreshButton"
                    title="Refresh Account Information" value="Refresh"
                    icon="ui-icon-refresh"
                    actionListener="#{accountBean.populateAccounts}"
                    update=":form:dataTable"/>                     
              </p:toolbarGroup>
              </p:toolbar>   
              </f:facet>
           </p:dataTable>

        </h:panelGroup>
     </h:form>
     <h:form id="form2" >
        <!--  <p:growl id="growl" showDetail="true" sticky="true" /> -->   
        <p:dialog id="basicDialog" header="Account Details"
           widgetVar="detailDialog" resizable="false">

           <h:panelGrid id="display" columns="2">
              <h:outputText value="#{bundle.AccountLabel_accountCode}" />
              <h:outputText value="#{accountBean.selectedAccount.accountCode}"
                 title="#{bundle.AccountTitle_accountCode}" />

              <h:outputText value="#{bundle.AccountLabel_alertCode}" />
              <h:outputText value="#{accountBean.selectedAccount.alertCode}"
                 title="#{bundle.AccountTitle_alertCode}" />

              <h:outputText value="#{bundle.AccountLabel_clearAgentID}" />
              <h:outputText value="#{accountBean.selectedAccount.clearAgentID}"
                 title="#{bundle.AccountTitle_clearAgentID}" />

              <h:outputText value="#{bundle.AccountLabel_globalAccountNum}" />
              <h:outputText
                 value="#{accountBean.selectedAccount.globalAccountNum}"
                 title="#{bundle.AccountTitle_globalAccountNum}" />

              <h:outputText value="#{bundle.AccountLabel_safeKeepingAccountNum}" />
              <h:outputText
                 value="#{accountBean.selectedAccount.safeKeepingAccountNum}"
                 title="#{bundle.AccountTitle_safeKeepingAccountNum}" />

              <h:outputText value="#{bundle.AccountLabel_destinationID}" />
              <h:outputText value="#{accountBean.selectedAccount.destinationID}"
                 title="#{bundle.AccountTitle_destinationID}" />

              <h:outputText value="#{bundle.AccountLabel_addlDestinationID1}" />
              <h:outputText
                 value="#{accountBean.selectedAccount.addlDestinationID1}"
                 title="#{bundle.AccountTitle_addlDestinationID1}" />

              <h:outputText value="#{bundle.AccountLabel_addlDestinationID2}" />
              <h:outputText
                 value="#{accountBean.selectedAccount.addlDestinationID2}"
                 title="#{bundle.AccountTitle_addlDestinationID2}" />

              <h:outputText value="#{bundle.AccountLabel_addlDestinationID3}" />
              <h:outputText
                 value="#{accountBean.selectedAccount.addlDestinationID3}"
                 title="#{bundle.AccountTitle_addlDestinationID3}" />

              <h:outputText value="#{bundle.AccountLabel_destinationName}" />
              <h:outputText
                 value="#{accountBean.selectedAccount.destinationName}"
                 title="#{bundle.AccountTitle_destinationName}" />

              <h:outputText value="#{bundle.AccountLabel_conBIC}" />
              <h:outputText value="#{accountBean.selectedAccount.conBIC}"
                 title="#{bundle.AccountTitle_conBIC}" />

              <h:outputText value="#{bundle.AccountLabel_accountStatus}" />
              <h:outputText value="#{accountBean.selectedAccount.accountStatus}"
                 title="#{bundle.AccountTitle_accountStatus}" />

              <h:outputText value="#{bundle.AccountLabel_comments}" />
              <h:outputText value="#{accountBean.selectedAccount.comments}"
                 title="#{bundle.AccountTitle_comments}" />

              <h:outputText value="#{bundle.AccountLabel_createdBy}" />
              <h:outputText value="#{accountBean.selectedAccount.createdBy}"
                 title="#{bundle.AccountTitle_createdBy}" />

              <h:outputText value="#{bundle.AccountLabel_createdDate}" />
              <h:outputText value="#{accountBean.selectedAccount.createdDate}"
                 title="#{bundle.AccountTitle_createdDate}" />

              <h:outputText value="#{bundle.AccountLabel_modifiedBy}" />
              <h:outputText value="#{accountBean.selectedAccount.modifiedBy}"
                 title="#{bundle.AccountTitle_modifiedBy}" />

              <h:outputText value="#{bundle.AccountLabel_modifiedDate}" />
              <h:outputText value="#{accountBean.selectedAccount.modifiedDate}"
                 title="#{bundle.AccountTitle_modifiedDate}" />
           </h:panelGrid>
        </p:dialog>
         <p:dialog header="Account Detail" widgetVar="accountDialog"
           resizable="false" height="600" width="600" showEffect="clip"
           hideEffect="fold" id="accountDialog" >
           <p:messages id="messages" autoUpdate="true" />
           <h:panelGrid id="accountDisplay" columns="2" cellpadding="4">

              <h:outputLabel value="Account Code:" for="accountCode" />
              <p:inputText label="Account Code" id="accountCode"
                 value="#{accountBean.currentAccount.accountCode}"
                 title="Account Code" required="true"
                 validatorMessage="#{bundle.AccountValidationAccountCode}" requiredMessage="#{bundle.AccountRequiredMessage_accountCode}">

              </p:inputText>
              <h:outputLabel value="Alert Code:" for="alertCode" />
              <p:inputText label="Alert Code" id="alertCode"
                 value="#{accountBean.currentAccount.alertCode}"
                 title="Alert Code" required="true"
                 validatorMessage="#{bundle.AccountValidationAlertCode}" requiredMessage="#{bundle.AccountRequiredMessage_alertCode}">

              </p:inputText>
              <h:outputLabel value="Clr Agent#:" for="clearAgentID" />
              <p:inputText label="Clr Agent#" id="clrAgent"
                 value="#{accountBean.currentAccount.clearAgentID}"
                 title="Clr Agent#" required="true"
                 requiredMessage="#{bundle.AccountRequiredMessage_clearAgentID}">

              </p:inputText>
              <h:outputLabel value="Global Acct#:" for="globalAccountNum" />
              <p:inputText label="Global Acct#" id="globalAccountNum"
                 value="#{accountBean.currentAccount.globalAccountNum}"
                 title="Global Acct#" required="true"
                 requiredMessage="#{bundle.AccountRequiredMessage_globalAccountNum}">

              </p:inputText>

              <h:outputLabel value="SafeKeeping Acct#:"
                 for="safeKeepingAccountNum" />
              <p:inputText label="Safekeeping Account Number"
                 id="safeKeepingAccountNum"
                 value="#{accountBean.currentAccount.safeKeepingAccountNum}"
                 title="Safekeeping Account Number" required="true"
                 validatorMessage="#{bundle.AccountValidationSafeKeepingAccountNum}" requiredMessage="#{bundle.AccountRequiredMessage_safeKeepingAccountNum}">

              </p:inputText>

              <h:outputLabel value="Primary Dest ID:" for="destinationID" />
              <p:inputText label="Primary Dest ID" id="destinationID"
                 value="#{accountBean.currentAccount.destinationID}"
                 title="Primary Dest ID" required="true"
                 requiredMessage="#{bundle.AccountRequiredMessage_destinationID}">

              </p:inputText>

              <h:outputLabel value="Addl Dest ID1:" for="addlDestinationID1" />
              <p:inputText label="Addl Dest ID1" id="addlDestinationID1"
                 value="#{accountBean.currentAccount.addlDestinationID1}"
                 title="Addl Dest ID1" required="true"
                 requiredMessage="#{bundle.AccountRequiredMessage_addlDestinationID1}">

              </p:inputText>

              <h:outputLabel value="Addl Dest ID2:" for="addlDestinationID2" />
              <p:inputText label="Addl Dest ID2" id="addlDestinationID2"
                 value="#{accountBean.currentAccount.addlDestinationID2}"
                 title="Addl Dest ID2" required="true"
                 requiredMessage="#{bundle.AccountRequiredMessage_addlDestinationID2}">

              </p:inputText>

              <h:outputLabel value="Addl Dest ID3:" for="addlDestinationID3" />
              <p:inputText label="Addl Dest ID3" id="addlDestinationID3"
                 value="#{accountBean.currentAccount.addlDestinationID3}"
                 title="Addl Dest ID3" required="true"
                 requiredMessage="#{bundle.AccountRequiredMessage_addlDestinationID3}">

              </p:inputText>

              <h:outputLabel value="Primary Dest Name:" for="destinationName" />
              <p:inputText label="Primary Dest Name" id="destinationName"
                 value="#{accountBean.currentAccount.destinationName}"
                 title="Primary Dest Name" required="true"
                 requiredMessage="#{bundle.AccountRequiredMessage_destinationName}">

              </p:inputText>

              <h:outputLabel value="Cont BIC:" for="conBIC" />
              <p:inputText label="Cont BIC" id="conBICText"
                 value="#{accountBean.currentAccount.conBIC}" title="Cont BIC"
                 required="true"
                 requiredMessage="#{bundle.AccountRequiredMessage_conBIC}">
              </p:inputText>

              <h:outputLabel value="Status:" for="accountStatus" />
              <p:inputText label="Status" id="conBIC"
                 value="#{accountBean.currentAccount.accountStatus}"
                 title="Status" required="true"
                 requiredMessage="#{bundle.AccountRequiredMessage_accountStatus}">
              </p:inputText>

              <h:outputLabel value="Comments:" for="comments" />
              <p:inputTextarea id="comments" rows="5" cols="30" maxlength="10" value="#{accountBean.currentAccount.comments}"      
                  autoResize="false"   required="true"   requiredMessage="#{bundle.AccountRequiredMessage_comments}"/>

              <h:outputLabel />
              <h:outputLabel />
           <!--    <p:separator id="customSeparator" style="width:500px;height:1px" /> --> 
              <f:facet name="footer">
                 <!-- <p:commandButton value="New" icon="ui-icon-check"/> -->
                 <h:outputLabel />
                 <p:commandButton id="save" styleClass="saveButton" value="Save"
                    icon="ui-icon-check" 
                    actionListener="#{accountBean.createOrUpdate}"
                    oncomplete="handleDialogSubmit(xhr,status,args);"/>
                    <!--   update=":form:dataTable,:form2:display" onsuccess="accountDialog.hide()" ajax="false"/> -->

                 <p:commandButton id="cancel" actionListener="#{accountBean.cancel}" styleClass="cancelButton" value="Cancel"
                    icon="ui-icon-cancel" oncomplete="accountDialog.hide()" process="@this"/>

                 <p:commandButton id="btnRefresh" styleClass="refreshButton1"
                    title="Refresh Account Information" value="Refresh"
                    icon="ui-icon-refresh"
                    actionListener="#{accountBean.populateAccounts}"
                    update=":form:dataTable"/>                           

              </f:facet>
           </h:panelGrid>
        </p:dialog>

     </h:form>

     <h:form id="dialogForm">
        <p:confirmDialog id="confirmDialog" header="Confirm Delete Account"
           severity="alert" widgetVar="confirmation">
           <f:facet name="message">
              <h:outputText
                 value="Delete #{accountBean.selectedAccount.accountCode}?" />
           </f:facet>

           <p:commandButton id="confirm" value="Yes"
              oncomplete="confirmation.hide()" update=":form:dataTable"
              actionListener="#{accountBean.remove}" ajax="false"/>
           <p:commandButton id="decline" value="No"
              onclick="confirmation.hide()" type="button" ajax="false"/>
           </p:confirmDialog>
       </h:form>
    </ui:define>
   </ui:composition>
 </h:body>
</html> 
```

AccountBean.java

```
package com.cba.web.beans;

import java.io.Serializable;
import java.util.List;

import javax.faces.bean.ManagedBean;
import javax.faces.bean.ViewScoped;
import javax.faces.component.UIComponent;
import javax.faces.component.UIViewRoot;
import javax.faces.context.FacesContext;
import javax.faces.event.ActionEvent;

import org.primefaces.context.RequestContext;

import com.cba.services.AccountService;
import com.cba.utils.JsfUtils;
import com.cba.utils.ServiceLocator;
import com.cba.web.model.Account;

@ManagedBean(name = "accountBean")
@ViewScoped
public class AccountBean implements Serializable {

private transient AccountService accountService;

private List<Account> accounts;

private Account selectedAccount = new Account();

private Account currentAccount = new Account();

public Account getSelectedAccount() {
    return selectedAccount;
 }

public void setSelectedAccount(Account selectedAccount) {
    this.selectedAccount = selectedAccount;
}

public Account getCurrentAccount() {
   return currentAccount;
}

public void setCurrentAccount(Account currentAccount) {
   this.currentAccount = currentAccount;
}

public AccountBean() {

   populateAccounts();
}

public AccountService getAccountService() {
   return accountService;
}

public void setAccountService(AccountService accountService) {
   this.accountService = accountService;
}

public List<Account> getAccounts() {
   return accounts;
}

public void populateAccounts() {
   accountService = (AccountService) ServiceLocator.getInstance().getBean(
         "accountService");
   accounts = accountService.getAccountDetails();
}

public void createOrUpdate(ActionEvent e) {
   try {

      System.out.println("entering createOrUpdate in AccountBean");
      accountService = (AccountService) ServiceLocator.getInstance()
            .getBean("accountService");
      accountService.updateAccountDetails(currentAccount);
       currentAccount = new Account();
   } catch (Exception ex) {
     ex.printStackTrace();
   }
}

 public void cancel(ActionEvent e) {
   clear();
 }
 public void remove(ActionEvent e) {
  try {
     accountService = (AccountService) ServiceLocator.getInstance()
           .getBean("accountService");
     accountService.deleteAccountDetails(selectedAccount);
     selectedAccount = new Account();
     populateAccounts();

  } catch (Exception ex) {
     ex.printStackTrace();
  }
 }

 public void clear() {
     currentAccount = new Account();
     UIViewRoot viewRoot =
     FacesContext.getCurrentInstance().getViewRoot();
     UIComponent component1 = viewRoot.findComponent("form2");
      JsfUtils.clearComponentHierarchy(component1);
 }

 } 
```

对此的任何输入都会有很大帮助。

# python - 在 Win 7 Wamp 上设置 Django

> ID：10902899
> 
> 赞同：0
> 
> 时间：2012-06-05T18:35:56.973
> 
> 标签：python, django, 64-bit, wamp

我在这里关注并尝试了许多不同的东西，但我一直坚持让我`settings.py`加载。此外，在我寻找答案的过程中，我了解了“嵌入式”和“守护程序”设置，我担心我要走的设置路径将需要我每次更新代码时都重新启动 Apache。有什么方法可以修复以下设置，以便我可以开始开发 Django 站点？并且不需要每次都重新启动 Apache？

我收到的错误是：

```
ImportError: Could not import settings 'brett.app.settings' (Is it on sys.path?): No module named brett.app.settings 
```

我知道 python 正在工作，因为我有一个响应“Hello World！”的 test.py 脚本。我相信 Django 正在工作并且 python 可以找到它，因为上述错误发生在 Django 调用堆栈 ( `\django\conf\__init__.py`) 中。此外，我尝试了正斜杠、反斜杠以及`sys.path.append`语句中的每个目录变体。

**安装了什么：**

```
Windows 7 Ultimate x64
WAMP 2.2 x64
Apache 2.2.21
Python 2.7.3 AMD64
mod_wsgi 3.3 AMD64 py2.7 (from http://www.lfd.uci.edu/~gohlke/pythonlibs/) 
```

**它是如何配置的：**

*C:\Windows\System32\drivers\etc\hosts*

```
127.0.0.1       brett.local 
```

*C:\wamp\bin\apache\Apache2.2.21\conf\httpd.conf*

```
LoadModule wsgi_module modules/mod_wsgi.so
AddHandler wsgi-script .wsgi .py
Options Indexes FollowSymLinks ExecCGI
<VirtualHost 127.0.0.1>
    ServerName brett.local
    DocumentRoot "c:/wamp/www/brett"
    <Directory "c:/wamp/www/brett">
        Order Allow,Deny
        Allow from all
    </Directory>

    WSGIScriptAlias / "c:/wamp/www/brett/apache/apache.wsgi"    
    <Directory "c:/wamp/www/brett/apache">
        Allow from all
    </Directory>
</VirtualHost> 
```

*C:\wamp\brett\apache\apache.wsgi*

```
import os, sys
sys.path.append('c:\\wamp\\www')
os.environ['DJANGO_SETTINGS_MODULE'] = 'brett.app.settings'
import django.core.handlers.wsgi
application = django.core.handlers.wsgi.WSGIHandler() 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-06-05T18:41:24.820

1.  This has nothing to do with Embedded vs Demon mode.

2.  If you're just starting out developing a site, why are you mucking around with Apache? Use the development server via `manage.py runserver`, that's what it's for.

3.  You haven't shown your project layout, but the error message is showing you that it can't find the Python path brett.app.settings. Do you have a `settings.py` in `c:\wamp\www\brett\app\`?

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-06-05T18:40:18.557

要查看您是否安装了 django，您可以执行 python（如果它不在您的环境中，它应该是 somwehere 之类的：）`C:/pythonXX/python.exe`并输入：

`import django`

此外，对于 python 开发，最好在 django 服务器中使用 build。这可以通过 启动`python manage.py runserver`。它只会让您少做一件事情来进行配置。它是轻量级的，自动重启和单线程。

# pdf - It.Document 中的 Itextsharp PdfDocument 或 PdfDocument

> ID：10902903
> 
> 赞同：1
> 
> 时间：2012-06-05T18:36:25.650
> 
> 标签：pdf, itextsharp, page-numbering

我正在使用 ITextSharp 在 pdf 文档的底部添加页码问题是，它由 4 或 5 个不同的 PDF 组成，它们通过该过程组合在一起，并且有一些动态添加的页面，因此 PDF 的大小可能会有所不同。我不能调用 document.PageCount 因为它“缺少 get 访问器”。

我做了一个计数器来跟踪我在哪个页面上，并且可以让最后一页说“第 9 页，共 9 页”，但其余的只说“第 7 页”。我在想我可以通过 PdfReader 运行整个文档来调用 reader.NumberOfPages 并重新运行每一页并在底部添加最终数字但我不知道如何从 iTextSharp.text.Document 类型中创建一个，也不知道如何事后去做。

这是别人开始的一个项目，我之前几乎没有接触过iTextSharp，我无法重新制作课程，因为它太大了。

有谁知道我能做什么？或者如何将 1 个数字添加到 iTextSharp.text.Document 的每一页？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-06-12T16:10:41.527

找到了伙计们：D

因此，每当您制作作家时：

```
using (MemoryStream MS = new MemoryStream())
        {
            PdfWriter writer = PdfWriter.GetInstance(doc, MS);
            writer.ViewerPreferences = PdfWriter.PageModeUseOutlines;
            PdfFooter eventHandler = new PdfFooter();
            writer.PageEvent = eventHandler;

ect.
} 
```

对于 PdfFooter：

```
using System;
using System.Collections.Generic;
using System.Linq;
using System.Web;
using iTextSharp.text.pdf;
using iTextSharp.text;

public class PdfFooter : PdfPageEventHelper
{
    // This is the contentbyte object of the writer
    PdfContentByte cb;

// we will put the final number of pages in a template
PdfTemplate template;

// this is the BaseFont we are going to use for the header / footer
BaseFont bf = null;

// This keeps track of the creation time
DateTime PrintTime = DateTime.Now;

#region Properties
private string _Title;
public string Title
{
    get { return _Title; }
    set { _Title = value; }
}

private string _HeaderLeft;
public string HeaderLeft
{
    get { return _HeaderLeft; }
    set { _HeaderLeft = value; }
}

private string _HeaderRight;
public string HeaderRight
{
    get { return _HeaderRight; }
    set { _HeaderRight = value; }
}

private Font _HeaderFont;
public Font HeaderFont
{
    get { return _HeaderFont; }
    set { _HeaderFont = value; }
}

private Font _FooterFont;
public Font FooterFont
{
    get { return _FooterFont; }
    set { _FooterFont = value; }
}
#endregion

// we override the onOpenDocument method
public override void OnOpenDocument(PdfWriter writer, Document document)
{
    try
    {
        PrintTime = DateTime.Now;
        bf = BaseFont.CreateFont(BaseFont.HELVETICA, BaseFont.CP1252, BaseFont.NOT_EMBEDDED);
        cb = writer.DirectContent;
        template = cb.CreateTemplate(50, 50);
    }
    catch (DocumentException de)
    {
    }
    catch (System.IO.IOException ioe)
    {
    }
}

public override void OnEndPage(PdfWriter writer, Document document)
{
    base.OnEndPage(writer, document);

    int pageN = writer.PageNumber;
    String text = "Page " + pageN + " of ";
    float len = bf.GetWidthPoint(text, 8);

    Rectangle pageSize = document.PageSize;

    cb.SetRGBColorFill(100, 100, 100);

    cb.BeginText();
    cb.SetFontAndSize(bf, 8);
    cb.SetTextMatrix(pageSize.GetRight(70), pageSize.GetBottom(15));
    cb.ShowText(text);
    cb.EndText();

    cb.AddTemplate(template, pageSize.GetRight(70) + len, pageSize.GetBottom(15));
}

public override void OnCloseDocument(PdfWriter writer, Document document)
{
    base.OnCloseDocument(writer, document);

    template.BeginText();
    template.SetFontAndSize(bf, 8);
    template.SetTextMatrix(0, 0);
    template.ShowText("" + (writer.PageNumber - 1));
    template.EndText();
} 
```

}

希望这对将来的某人有所帮助:)

# php - 如何使用 ob_start 追加到文件

> ID：10902905
> 
> 赞同：5
> 
> 时间：2012-06-05T18:36:41.853
> 
> 标签：php, file, append

我已经寻找了很长一段时间，看看如果使用带有 PHP 的 ob_start 是否可以“附加”到文件中。

我尝试了以下但没有奏效。有什么方法可以做到这一点？

```
<?php

$cacheFile = 'file.txt';

if ( (file_exists($cacheFile)) && ((fileatime($cacheFile) + 600) > time()) )
{
$content = file_get_contents($cacheFile);
echo $content;
} else
{
ob_start();
// write content
echo '<h1>Hello world</h1>';
$content = ob_get_contents();
ob_end_clean();
file_put_contents($cacheFile,$content,'a+'); // I added the a+
echo $content;
}
?> 
```

我从另一篇关于 SO 的帖子中借用了上面的例子

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2012-06-05T18:40:22.307

要追加使用[`file_put_contents()`](http://php.net/file_put_contents)，您可以简单地`FILE_APPEND`作为第三个参数传递：

```
file_put_contents($cacheFile, $content, FILE_APPEND); 
```

它还可以用于使用二进制 OR 运算符应用文件锁定，例如`FILE_APPEND | LOCK_EX`.

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2012-06-05T18:38:48.190

[`file_put_contents`](http://php.net/file_put_contents)不能那样工作。要追加，您需要使用[`fopen`](http://php.net/fopen),[`fwrite`](http://php.net/fwrite)和[`fclose`](http://php.net/fclose)手动。

```
$file = fopen($cacheFile, 'a+');
fwrite($file, $content);
fclose($file); 
```

# c# - 为什么 XmlDocument Validate 事件处理程序没有被命中？

> ID：10902908
> 
> 赞同：2
> 
> 时间：2012-06-05T18:36:44.343
> 
> 标签：c#, .net, xml, xsd, .net-2.0

我有这个代码：

```
 // Load the document
  XmlDocument xmlDocument = new XmlDocument();

  // use the stream and have it close when it is finished
  using ( argInputStream )
  {
    xmlDocument.Load( argInputStream );
    xmlDocument.Schemas.Add( XmlSchema.Read( argSchemaStream, null ) );
    xmlDocument.Validate( ValidationEventHandler );
  }

// this is not getting hit
void ValidationEventHandler( object sender, ValidationEventArgs e )
{
  switch ( e.Severity )
  {
    case XmlSeverityType.Error:
      Console.WriteLine( "Error: {0}", e.Message );
      break;
    case XmlSeverityType.Warning:
      Console.WriteLine( "Warning {0}", e.Message );
      break;
  }
} 
```

我的 XSD 的第一行：

```
<xs:schema attributeFormDefault="unqualified" elementFormDefault="qualified" 
xmlns:xs="http://www.w3.org/2001/XMLSchema"> 
```

有任何想法吗？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-06-05T19:07:24.793

我有一些使用这种结构验证 xml 的代码。

```
var schemaReader = new XmlTextReader(argSchemaStream);
var schema = new XmlSchemaSet();
schema.Add(null, schemaReader);

var settings = new XmlReaderSettings();
settings.ValidationType = ValidationType.Schema;
settings.Schemas.Add(schema);
settings.ValidationFlags |= XmlSchemaValidationFlags.ReportValidationWarnings;
settings.ValidationEventHandler += new ValidationEventHandler(ValidationEventHandler);

var doc = new XmlDocument();
doc.Load(XmlReader.Create(argInputStream, settings)); 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-06-05T19:03:13.033

我认为这不是正确的验证方式；试试这个[MSDN 链接](http://msdn.microsoft.com/en-us/library/ms162371.aspx)。基本上，架构似乎与 XmlReaderSettings 一起使用。

```
XmlReaderSettings settings = new XmlReaderSettings();
settings.Schemas.Add(...);
settings.ValidationType = ValidationType.Schema;

XmlReader reader = XmlReader.Create(..., settings);
XmlDocument document = new XmlDocument();
document.Load(reader);

document.Validate(eventHandler); 
```

# jetty - 在码头上部署axis2

> ID：10902909
> 
> 赞同：0
> 
> 时间：2012-06-05T18:36:46.820
> 
> 标签：jetty, axis2, war

请帮助我在码头上部署axis2。我能够部署axis2 war文件，但我实际上需要将axis2部署为exploded war文件，以便我可以使用axis2的热部署功能。

请告诉过程或指向我的文章。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-07-07T00:58:41.213

解决了。

获取二进制发行版并运行它附带的 ant 脚本。

运行 Ant 脚本给了我一个战争文件。

我使用jar xvf 解压了war 文件，然后将解压war 文件得到的所有内容放到jetty 的webapps 目录中。

它就像一个魅力......

# java - Java检测字符串中的特殊字符

> ID：10902911
> 
> 赞同：4
> 
> 时间：2012-06-05T18:36:56.383
> 
> 标签：java, regex, special-characters

我使用正则表达式

```
r="[^A-Za-z0-9]+"; 
```

检测字符串是否包含一个或多个字符，而不是字母和数字；

然后我尝试了以下方法：

```
Pattern.compile(r).matcher(p).find(); 
```

我测试过：

```
! @ # $ % ^ & * ( ) +  =- [ ] \ ' ; , . / { } | " : < > ? ~ _ ` 
```

大多数情况下，除了后挡板 \ 和插入符号 ^ 之外，它都有效。

例如

```
String p = "abcAsd10^"    (return false)
String p = "abcAsd10\\"   (return false) 
```

有什么我想念的吗？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-06-05T18:51:42.883

当我编译并运行以下代码时，它会打印“Found：true”：

```
class T
{
    public static void main (String [] args)
    {
        String thePattern = "[^A-Za-z0-9]+"; 
        String theInput = "abskKel35^";
        boolean isFound = Pattern.compile(thePattern).matcher(theInput).find();
        System.out.println("Found: " + isFound);
    }
} 
```

不知道为什么你会看到不同的结果......

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-06-05T18:43:14.880

You could also change only:

```
[\w&&^_]+ 
```

Where:

*   `\w` A word character with underscore: `[a-zA-Z_0-9]`
*   `\W` A non-word character: `[^\w]`

See more in class [`Pattern`](http://docs.oracle.com/javase/7/docs/api/java/util/regex/Pattern.html)

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-06-05T18:37:43.807

那不应该是：

```
r="[^A-Za-z0-9]+"; 
```

在你的问题中你写 a_z （下划线）

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2012-06-05T18:53:50.207

当我在我的机器上运行此代码时，它会打印 true..

```
 String r="[^A-Za-z0-9]+"; 
        String p = "abcAsd10\\" ;
        Matcher m = Pattern.compile(r).matcher(p);
        System.out.println(m.find()); 
```

> 真的

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2012-06-05T18:50:07.723

尝试将您的输入引用到匹配器中。

```
Pattern.quote(p) 
```

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2012-06-05T19:09:14.073

只需这样做：

```
p.matches(".*\\W.*"); //return true if contains one or more special character 
```

* * *

## 回答 #7

> 赞同：0
> 
> 时间：2012-06-05T19:04:30.863

对不起，我有

```
r="[^A-za-z0-9]+"; (with little "z", i.e. A-z). 
```

这会导致返回“false”。但是为什么它可以与除后挡板 \ 和插入符号 ^ 之外的其他特殊字符一起使用？

# c# - 序列化是否流式传输

> ID：10902912
> 
> 赞同：1
> 
> 时间：2012-06-05T18:37:07.693
> 
> 标签：c#

我发现了两个如何序列化数据的不同示例。一个使用流，另一个不使用？

```
stream1.Position = 0;
StreamReader sr = new StreamReader(stream1);
Console.Write("JSON form of Person object: ");
Console.WriteLine(sr.ReadToEnd()); 
```

[来自 MSDN](http://msdn.microsoft.com/en-us/library/bb412179.aspx)

```
 public static string ToJson(this object obj, int recursionDepth = 100)  
    { 
        JavaScriptSerializer serializer = new JavaScriptSerializer(); 
        serializer.RecursionLimit = recursionDepth; 
        return serializer.Serialize(obj); 
    } 

    public static List<T> ToListObject<T>(this string obj, int recursionDepth = 100) 
    { 
        JavaScriptSerializer serializer = new JavaScriptSerializer(); 
        serializer.RecursionLimit = recursionDepth; 
        List<T> returnList = serializer.Deserialize<List<T>>(obj); 
        return returnList; 
    } 
```

[来自 StackOverflow](https://stackoverflow.com/questions/6145906/serialize-deserialize-listt-to-json)

为什么要使用 Stream 作为附加步骤？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-06-05T19:30:04.353

如果您实际上正在与诸如文件或网络套接字之类的支持进行通信，并且数据很大（即您不想加载大量`string`内存），则使用 Stream 或读取器/写入器 API 可能会很方便。

`string`在处理少量数据时，基于 -的 API 更方便，这在大多数 AJAX/HTTP 场景中都很常见。请注意，大多数序列化程序**没有**直接公开`string`为输入/输出的 API，但这是 JSON 的常见场景，因此对您来说很容易。

一个基本上是另一个的便利包装。哪种方式是实现细节，尽管我希望主要的内部代码是基于流或读取器/写入器的（以允许没有开销的大型文档）。

使用对您的目的最方便的。

# django - Django MPTT 因 auth.view.login 视图而失败

> ID：10902913
> 
> 赞同：0
> 
> 时间：2012-06-05T18:37:16.167
> 
> 标签：django, django-mptt

我在使用 django.contrib.auth.view.login 视图时遇到 Django MPTT 问题，

在 urls.py 中有

```
 (r'^accounts/login/$', django.contrib.auth.view.login), 
```

我的模板注册/login.html 扩展了基本模板-login.html：

```
{% extends "base.html" %} 
```

现在，我在 base.html 中使用 MPTT，如下所示：

```
{% load mptt_tags %}    
            <ul>
           {% recursetree nodes %}
            <li>
                <a href="{% url someview node.id %}">{{ node.name }}</a>
                {% if not node.is_leaf_node %}
                    <ul>
                        {{ children }}
                    </ul>
                {% endif %}
            </li>
        {% endrecursetree %} 
```

但是，当我访问帐户/登录时，django 抱怨：

```
TemplateSyntaxError at /accounts/login/

Caught VariableDoesNotExist while rendering: Failed lookup for key [nodes] in u"[{}

Template error

In template /home/user/djcode/project/templates/base.html, error at line 58 
```

而在第 58 行实际上是这段代码 `{% recursetree nodes %}`

我不知道如何解决这个问题。我的其他视图没有问题，只有这个通用的。但是在其他视图中，我也发送数据以在字典中导航到模板，但不知道该怎么做有一般意见。有什么建议吗？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-06-05T18:46:12.307

您应该使用[上下文处理器](https://docs.djangoproject.com/en/1.4/ref/templates/api/#subclassing-context-requestcontext)将导航树发送到所有视图，包括通用视图，而不是从每个视图手动传递。

# wpf - 简化非标准按钮的绑定

> ID：10902915
> 
> 赞同：2
> 
> 时间：2012-06-05T18:37:21.297
> 
> 标签：wpf, binding, wpf-controls, caliburn.micro

我们使用的是[Caliburn Micro](http://caliburnmicro.codeplex.com/documentation)，它非常好，但现在我们使用的是新的[Ribbon](http://msdn.microsoft.com/en-us/library/ff799534.aspx)控件（.NET 4.5 附带）。此控件具有[RibbonButton](http://msdn.microsoft.com/en-us/library/microsoft.windows.controls.ribbon.ribbonbutton.aspx)并且此按钮具有单击事件并且它是一个按钮，但似乎 Caliburn 在其名称与视图模型方法一匹配时不会自动触发该操作。

现在，我们可以通过使用来解决这个问题，`cal:Message.Attach="ViewHelp"`但是考虑到功能区栏中的大量控件，我想知道是否有一种简单的方法可以使自动绑定在`RibbonButton`和`ViewModel`方法之间工作。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-06-05T19:17:19.600

您可以使用 ConventionManager。从此开始：

```
ConventionManager.AddElementConvention<RibbonButton>(
    RibbonButton.ContentProperty, "DataContext", "Click"); 
```

将此代码放在您的引导程序中。像这样：

```
public class AppBootstrapper : Bootstrapper
{
    protected override void Configure()
    {
        ConventionManager.AddElementConvention<RibbonButton>(
            RibbonButton.ContentProperty, "DataContext", "Click");
    }
} 
```

这绝不是您在引导程序中应该做的所有事情。只是为了显示正确的位置。

# javascript - 姜戈；在自定义小部件中向媒体文件添加变量

> ID：10902916
> 
> 赞同：0
> 
> 时间：2012-06-05T18:37:31.147
> 
> 标签：javascript, jquery, django, forms, django-widget

我想制作一个包含一些媒体文件的小部件，并且我希望能够传入媒体文件可以访问的参数。

```
# in forms.py
class aCustomWidget(forms.TextInput):
    class Media:
        css = {
            'all': ('pretty.css',)
        }
        js = ('animations.js',) 
```

例如，在 animation.js 中我有 {{ my_variable }}。我的问题是，如何以如下方式在“animation.js”中填充 {{ my_variable }}：

```
# in forms.py
class myForm(forms.Form):
    a_field = aCustomWidget(my_variable="#_a_string_variable") 
```

谢谢您，请随时要求澄清。

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-06-05T19:00:35.570

您实际上无法将变量添加到 JS 文件中，因为 JS 不像模板那样被解析。它是静态的。传递变量的唯一方法是将其包含在模板代码的内联脚本中：

```
<script type="text/javascript">
    var my_variable = '{{ my_variable }}`;
</script> 
```

然而，Django 甚至没有在小部件代码上使用模板解析器。默认的渲染方法直接返回现成的 HTML。这不是一个真正的问题。你只需要以不同的方式处理它。

因此，首先，您实际上需要能够在小部件的实例化中接受变量。你可以这样做：

```
class aCustomWidget(forms.TextInput):
    def __init__(self, *args, **kwargs):
        self.my_variable = kwargs.pop('my_variable')
        super(aCustomWidget, self).__init__(*args, **kwargs) 
```

然后，在您的`render`方法中，您可以访问该实例变量以将其添加到您的输出中：

```
from django.utils.safestring import mark_safe

...

def render(self, name, value, attrs):
    output = super(aCustomWidget, self).render(name, value, attrs)
    if self.my_variable is not None:
        output += u'<script type="text/javascript">var my_variable = "%s";</script>' % self.my_variable
    return mark_safe(output) 
```

最后，在您的 JS 中，只需使用该全局变量。您显然需要确保您的代码在页面完成渲染后运行，以便变量可用。此外，由于您在这里处理的是全局变量，因此您应该注意您的名称。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2021-08-28T10:03:40.417

这肯定会奏效：

```
$('#search-form .term').bind('input', function(){
 console.log('this actually works');
});

<form id="search-form">
 <input type="text" class="term" name="Search" value="Search" 
     autocomplete="off" />
 <input type="submit" name="Search" value="Search" />
</form> 
```

# icecast - Icecast 文件不再记录

> ID：10902917
> 
> 赞同：0
> 
> 时间：2012-06-05T18:37:33.713
> 
> 标签：icecast, logrotate

我在使用以下 logrotate 和 icecast access.log 时遇到以下问题：

*   文件 access.log 随机停留在 0ko 并且不记录任何内容
*   存档文件 access.log-20120601.gz 为空

这是我的 /etc/logrotate.d/icecast

```
/home/log/icecast/access.log{
# Les logs sont compréssé avant rotation
compress
# Fréquence de rotation par défaut :
monthly
# Par défaut, une rotation par jour est effectuée. 365,25 Jours par ans, nous concervons     donc
# une profondeur de 366 jours.
rotate 366
# En parallèle, si une archive est agée de plus de 366 jours, elle est détruite :
maxage 366
# Insertion de la date dans l'archivage des journaux.
dateext
# Lors d'une rotation, un fichier de remplacement est créé avec les droits 0640      appartenant 
# root et au groupe root.
create 777 root root
# Toutes les archives sont stockées dans /var/log/icecast.
olddir /var/log/icecast

} 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-12-02T15:05:11.107

我不知道你是否已经解决了这个问题，但是查看我的 Icecast 2 的 logrotate 文件（由 Icecast 自己安装），唯一有意义的区别似乎是这些行：

```
postrotate
    if pgrep icecast2 >/dev/null; then
        invoke-rc.d --quiet icecast2 reload > /dev/null
    fi
endscript 
```

它向Icecast 进程发送**SIGHUP信号。**

查看[Icecast Documentation](http://icecast.org/docs/icecast-2.3.1/icecast2_config_file.html#log)，有一段解释说：

> 请注意，在非 win32 平台上，可以向 icecast 发送 HUP 信号，在该信号中重新打开日志文件以添加移动/删除日志文件的能力。

# python - Python 的 time.sleep() 挂起

> ID：10902925
> 
> 赞同：3
> 
> 时间：2012-06-05T18:38:08.613
> 
> 标签：python, sleep

我有一个测试脚本可以随机休眠 1 到 180 秒之间的秒数。测试程序将挂起超过 3 分钟。

所以我更改了代码，让它休眠 60 秒（1 分钟）并运行脚本。20 小时后（！！！），代码仍然挂在 time.sleep() 上。

代码是

```
downtime = 60
time.sleep(downtime) 
```

为什么 Python 在 time.sleep(60) 上永远挂起？

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-06-05T18:42:04.440

You use 2 different variables *downtime* and *downTime*. Probably, *downTime* greater than 60

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2012-06-05T18:41:48.337

Even though `time.sleep()` is permitted to suspend your thread for an interval that is shorter, or longer, than what you ask, `time.sleep(60)` would not suspend your thread for 20 hours.

I can see several possible explanations:

1.  You are calling `time.sleep()` multiple times (e.g. in a loop).
2.  You are calling `time.sleep()` with an argument that is much higher than 60 (note the two different ways you're spelling `downtime`/`downTime` in your code).
3.  The problem has nothing to do with `time.sleep()`.

* * *

## 回答 #3

> 赞同：4
> 
> 时间：2017-09-21T05:18:58.123

灯下一片漆黑。原因可能很荒谬。

检查您是否曾经单击过 shell 屏幕。

[在 Powershell 上运行的进程随机冻结](https://stackoverflow.com/questions/39676635/processes-running-on-powershell-freezes-randomly/39676636#39676636)

# javascript - node.js、require() 和原型继承

> ID：10902926
> 
> 赞同：2
> 
> 时间：2012-06-05T18:38:12.087
> 
> 标签：javascript, node.js, require, prototypal-inheritance

我对 node.js 很陌生，可能也是 javascript，所以请随时指出任何看起来很尴尬的地方。我是来学习的。

这是我正在尝试做的事情：

*   “John”对象应该继承“Client”对象的所有内容，包括函数
*   在实例化新对象和继承时使用 Object.create() 而不是“new”关键字

这是一个有效的单个文件测试：

```
var sys=require('sys');
var Client = {
  ip: null,
  stream : null,
  state: "Connecting",
  eyes: 2,
  legs: 4,
  name: null,
  toString: function () {
      return this.name + " with " +
      this.eyes + " eyes and " +
      this.legs + " legs, " + this.state + ".";
  }
}
var john = Object.create(Client, {
  name: {value: "John", writable: true},
  state :  {value: "Sleeping", writable: true}
}); 
sys.puts(john); // John with 2 eyes and 4 legs, Sleeping 
```

以下是我将其拆分为不同文件时发生的情况：

---- 客户端.js ----

```
module.exports = function (instream, inip){
    return  {
         ip: inip,
          stream : instream,
          state: "Connecting",
          eyes: 2,
          legs: 4,
          name: null,
          toString: function () {
            return this.name + " with " +
              this.eyes + " eyes and " +
              this.legs + " legs, " + this.state + ".";
          },
    };

}; 
```

---- 约翰.js ----

```
var Client = require("./client");
module.exports = function (inname, instate){
    return Object.create(Client, {
      state : {value: inname, enumerable: false, writable: true},
      name: {value: instate, enumerable: true, writable: true},
    });

}; 
```

---- main.js ----

```
var sys = require("util");
var Client = require("./client")("stream","168.192.0.1");
sys.puts(Client); // null with 2 eyes and 4 legs, Connecting

var john = require("./john")("John","Sleeping");
sys.puts(john); //Function.prototype.toString no generic 
sys.puts(sys.inspect(john)); // { name: 'Sleeping' }
sys.puts(sys.inspect(john, true)); // {name: 'Sleeping', [state]: 'John'} 
```

问题：

1.  我在拆分文件和使用导致问题的 require() 时做错了什么？
2.  为什么 john 对象的名称为“Sleeping”，状态为“John”？我知道这是我放置线条的顺序，但它不应该遵循我在构造函数中放置的参数吗？
3.  有没有更好的方法来做到这一点？我倾向于学习 Object.create() 而不是依赖“new”关键字。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-06-05T19:33:16.090

在＃2：

```
return Object.create(Client, {
  state : {value: inname, enumerable: false, writable: true},
  name: {value: instate, enumerable: true, writable: true},
}); 
```

这是您在交换`inname`和`instate`.

在＃1：

我怀疑原始单文件代码和新的 3 文件代码之间的另一个细微差别有问题。[在MDN 的页面上`Object.create`](https://developer.mozilla.org/en/JavaScript/Reference/Global_Objects/Object/create)，一个特别的评论引起了我的注意，具体来说，

> 当然，如果Constructor函数中有实际的初始化代码，Object.create就无法体现出来

您的`client.js`文件正在生成一个构造函数。你要写的`john.js`是（结合#1和#2）：

```
return Object.create(Client(), {
  state : {value: instate, enumerable: false, writable: true},
  name: {value: inname, enumerable: true, writable: true},
}); 
```

*调用*Client 函数，使其返回一个对象而不是函数，然后在此基础上创建一个新对象。

在＃3：

我不明白你为什么不能使用这种模式，但你刚刚证明它是：

1.  与当今大多数 Javascript 对象的创建方式不同（尽管毫无疑问是一种更快的构造机制）。
2.  使用较新的语法（删除`new`），因此语法错误不会像使用旧的 Java 样式语法那样“跳出”。

要时刻铭记在心。不过，我很高兴你问了这个问题，因为现在我知道`Object.create`. :)

# xml - XSLT 使用 for 循环类型操作扩展输入 XML

> ID：10902927
> 
> 赞同：2
> 
> 时间：2012-06-05T18:38:13.323
> 
> 标签：xml, xslt, xslt-2.0

我是 XSLT 的新手，请原谅我的无知，如果我输入了这样的 XML：

```
<Doc>
 <stuff>
   <for var="i" from="1" to="2">
      <item>$(i)></item>
      <for var="j" from="2" to="4">
        <innerItem>$(j)</innerItem>
      </for>
    </for>    
  </stuff>
</Doc> 
```

我想使用转换来扩展输出 XML，如下所示：

```
<Doc>
 <stuff>
   <item>1</item>
     <innerItem>2</innerItem>
     <innerItem>3</innerItem>
     <innerItem>4</innerItem>
   <item>2</item>
     <innerItem>2</innerItem>
     <innerItem>3</innerItem>
     <innerItem>4</innerItem>
 </stuff>
</Doc> 
```

我所拥有的只是：下一步该做什么？

```
<?xml version="1.0" encoding="utf-8"?>
<xsl:stylesheet version="1.0" xmlns:xsl="http://www.w3.org/1999/XSL/Transform"
    xmlns:msxsl="urn:schemas-microsoft-com:xslt" exclude-result-prefixes="msxsl"
>
    <xsl:output method="xml" indent="yes"/>

    <xsl:template match="@* | node()">
        <xsl:copy>         
            <xsl:apply-templates select="@* | node()"/>
        </xsl:copy>
    </xsl:template>

  <xsl:template match="for">
    <xsl:variable name="from" select="@from" />
    <xsl:variable name="to" select="@to" />
    <xsl:copy>
      <xsl:apply-templates select="@* | node()"/>
    </xsl:copy>    
  </xsl:template>
</xsl:stylesheet> 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-06-06T02:41:03.500

**这是一个更简单（没有明确的条件指令，没有用户定义的函数，没有模式）和更短的*工作*转换**：

```
<xsl:stylesheet version="2.0"
 xmlns:xsl="http://www.w3.org/1999/XSL/Transform">
 <xsl:output omit-xml-declaration="yes" indent="yes"/>
 <xsl:strip-space elements="*"/>

 <xsl:template match="node()|@*">
  <xsl:param name="pVars" as="element()*"/>
  <xsl:copy>
   <xsl:apply-templates select="node()|@*">
     <xsl:with-param name="pVars" select="$pVars"/>
   </xsl:apply-templates>
  </xsl:copy>
 </xsl:template>

 <xsl:template match="for">
  <xsl:param name="pVars" as="element()*"/>

  <xsl:variable name="vCurrentFor" select="."/>

  <xsl:for-each select="@from to @to">
      <xsl:variable name="vnewVars">
        <xsl:sequence select="$pVars"/>
        <var name="{$vCurrentFor/@var}" value="{current()}"/>
      </xsl:variable>

    <xsl:apply-templates select="$vCurrentFor/node()">
      <xsl:with-param name="pVars" select="$vnewVars/*"/>
    </xsl:apply-templates>
  </xsl:for-each>
 </xsl:template>

 <xsl:template match="text()[contains(., '$(')]">
  <xsl:param name="pVars" as="element()*"/>

  <xsl:analyze-string select="."
    regex="\$\((.+?)\)">
     <xsl:non-matching-substring>
       <xsl:value-of select="."/>
     </xsl:non-matching-substring>
     <xsl:matching-substring>
       <xsl:variable name="vName" select="regex-group(1)"/>

       <xsl:variable name="vReplacement" select=
        "$pVars[@name eq $vName][last()]/@value"/>
       <xsl:sequence select="string($vReplacement)"/>
     </xsl:matching-substring>
  </xsl:analyze-string>
 </xsl:template>
</xsl:stylesheet> 
```

**当此转换应用于提供的 XML 文档时：**

```
<Doc>
    <stuff>
        <for var="i" from="1" to="2">
            <item>$(i)</item>
            <for var="j" from="2" to="4">
                <innerItem>$(j)</innerItem>
            </for>
        </for>
    </stuff>
</Doc> 
```

**产生了想要的正确结果：**

```
<Doc>
   <stuff>
      <item>1</item>
      <innerItem>2</innerItem>
      <innerItem>3</innerItem>
      <innerItem>4</innerItem>
      <item>2</item>
      <innerItem>2</innerItem>
      <innerItem>3</innerItem>
      <innerItem>4</innerItem>
   </stuff>
</Doc> 
```

**可以执行更复杂的处理**：

**一起使用来自不同级别的变量**：

```
<Doc>
    <stuff>
        <for var="x" from="1" to="2">
            <item>$(x)</item>
            <for var="y" from="2" to="4">
                <innerItem>$(x).$(y)</innerItem>
            </for>
        </for>
    </stuff>
</Doc> 
```

**本文档的结果是：**

```
<Doc>
   <stuff>
      <item>1</item>
      <innerItem>1.2</innerItem>
      <innerItem>1.3</innerItem>
      <innerItem>1.4</innerItem>
      <item>2</item>
      <innerItem>2.2</innerItem>
      <innerItem>2.3</innerItem>
      <innerItem>2.4</innerItem>
   </stuff>
</Doc> 
```

**或使用此 XML 文档**：

```
<Doc>
    <stuff>
        <for var="x" from="1" to="2">
          <item>
             <value>$(x)</value>
                <for var="y" from="2" to="4">
                    <innerItem>
                      <value>$(x).$(y)</value>
                        <for var="z" from="3" to="5">
                          <inner-most-Item>$(x).$(y).$(z)</inner-most-Item>
                        </for>
                    </innerItem>
                </for>
          </item>
        </for>
    </stuff>
</Doc> 
```

**结果是**：

```
<Doc>
   <stuff>
      <item>
         <value>1</value>
         <innerItem>
            <value>1.2</value>
            <inner-most-Item>1.2.3</inner-most-Item>
            <inner-most-Item>1.2.4</inner-most-Item>
            <inner-most-Item>1.2.5</inner-most-Item>
         </innerItem>
         <innerItem>
            <value>1.3</value>
            <inner-most-Item>1.3.3</inner-most-Item>
            <inner-most-Item>1.3.4</inner-most-Item>
            <inner-most-Item>1.3.5</inner-most-Item>
         </innerItem>
         <innerItem>
            <value>1.4</value>
            <inner-most-Item>1.4.3</inner-most-Item>
            <inner-most-Item>1.4.4</inner-most-Item>
            <inner-most-Item>1.4.5</inner-most-Item>
         </innerItem>
      </item>
      <item>
         <value>2</value>
         <innerItem>
            <value>2.2</value>
            <inner-most-Item>2.2.3</inner-most-Item>
            <inner-most-Item>2.2.4</inner-most-Item>
            <inner-most-Item>2.2.5</inner-most-Item>
         </innerItem>
         <innerItem>
            <value>2.3</value>
            <inner-most-Item>2.3.3</inner-most-Item>
            <inner-most-Item>2.3.4</inner-most-Item>
            <inner-most-Item>2.3.5</inner-most-Item>
         </innerItem>
         <innerItem>
            <value>2.4</value>
            <inner-most-Item>2.4.3</inner-most-Item>
            <inner-most-Item>2.4.4</inner-most-Item>
            <inner-most-Item>2.4.5</inner-most-Item>
         </innerItem>
      </item>
   </stuff>
</Doc> 
```

我会在这里停下来，但是考虑到这种语言的良好设计，可能性是无限的。

**更新**： OP 要求：

> “有没有办法也允许扩展内部属性？例如：`<inner-most-Item id="$(i)">`”

**是的，这很容易——只需添加一个新的模板匹配属性并重构代码**：

```
<xsl:stylesheet version="2.0"
     xmlns:xsl="http://www.w3.org/1999/XSL/Transform"
     xmlns:my="my:my">
     <xsl:output omit-xml-declaration="yes" indent="yes"/>
     <xsl:strip-space elements="*"/>

     <xsl:template match="node()|@*">
      <xsl:param name="pVars" as="element()*"/>
      <xsl:copy>
       <xsl:apply-templates select="node()|@*">
         <xsl:with-param name="pVars" select="$pVars"/>
       </xsl:apply-templates>
      </xsl:copy>
     </xsl:template>

     <xsl:template match="for">
      <xsl:param name="pVars" as="element()*"/>

      <xsl:variable name="vCurrentFor" select="."/>

      <xsl:for-each select="@from to @to">
          <xsl:variable name="vnewVars">
            <xsl:sequence select="$pVars"/>
            <var name="{$vCurrentFor/@var}" value="{current()}"/>
          </xsl:variable>

        <xsl:apply-templates select="$vCurrentFor/node()">
          <xsl:with-param name="pVars" select="$vnewVars/*"/>
        </xsl:apply-templates>
      </xsl:for-each>
     </xsl:template>

     <xsl:template match="text()[contains(., '$(')]">
      <xsl:param name="pVars" as="element()*"/>

      <xsl:value-of select="my:evalText($pVars, .)"/>
     </xsl:template>

     <xsl:template match="@*[contains(., '$(')]">
      <xsl:param name="pVars" as="element()*"/>

      <xsl:attribute name="{name()}">
        <xsl:value-of select="my:evalText($pVars, .)"/>
      </xsl:attribute> 
     </xsl:template>

     <xsl:function name="my:evalText">
      <xsl:param name="pVars" as="element()*"/>
       <xsl:param name="pText"/>

          <xsl:analyze-string select="$pText"
            regex="\$\((.+?)\)">
             <xsl:non-matching-substring>
               <xsl:value-of select="."/>
             </xsl:non-matching-substring>
             <xsl:matching-substring>
               <xsl:variable name="vName" select="regex-group(1)"/>

               <xsl:variable name="vReplacement" select=
                "$pVars[@name eq $vName][last()]/@value"/>
               <xsl:value-of select="string($vReplacement)"/>
             </xsl:matching-substring>
          </xsl:analyze-string>
     </xsl:function>
</xsl:stylesheet> 
```

**现在，此转换应用于以下 XML 文档：**

```
<Doc>
    <stuff>
        <for var="i" from="1" to="2">
            <item name="X$(i)">$(i)</item>
            <for var="j" from="2" to="4">
                <innerItem name="X$(i).$(j)">$(j)</innerItem>
            </for>
        </for>
    </stuff>
</Doc> 
```

**产生了想要的正确结果：**

```
<Doc>
   <stuff>
      <item name="X1">1</item>
      <innerItem name="X1.2">2</innerItem>
      <innerItem name="X1.3">3</innerItem>
      <innerItem name="X1.4">4</innerItem>
      <item name="X2">2</item>
      <innerItem name="X2.2">2</innerItem>
      <innerItem name="X2.3">3</innerItem>
      <innerItem name="X2.4">4</innerItem>
   </stuff>
</Doc> 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-06-05T20:56:37.480

这适用于提供的输入 XML。我不得不使用模式。字符串替换功能基于这个问题的答案：[XSLT 字符串替换](https://stackoverflow.com/questions/3067113/xslt-string-replace)

```
<?xml version="1.0" encoding="UTF-8"?>
<xsl:stylesheet version="2.0" xmlns:xsl="http://www.w3.org/1999/XSL/Transform" xmlns:xs="http://www.w3.org/2001/XMLSchema" xmlns:fun="http://www.nothing.org">
    <xsl:output method="xml" indent="yes"/>
    <xsl:template match="/">
        <xsl:apply-templates mode="parse"/>
    </xsl:template>
    <xsl:template name="forImpl">
        <xsl:param name="counter" select="@from"/>
        <xsl:param name="to" select="@to"/>
        <xsl:param name="varName" select="@var"/>
        <xsl:param name="nodes"/>
        <xsl:apply-templates select="$nodes" mode="parse">
            <xsl:with-param name="varName" select="concat('$(', $varName, ')')"/>
            <xsl:with-param name="counter" select="$counter"/>
        </xsl:apply-templates>
        <xsl:if test="$counter != $to">
            <xsl:call-template name="forImpl">
                <xsl:with-param name="counter" select="$counter + 1"/>
                <xsl:with-param name="to" select="$to"/>
                <xsl:with-param name="varName" select="$varName"/>
                <xsl:with-param name="nodes" select="$nodes"/>
            </xsl:call-template>
        </xsl:if>
    </xsl:template>
    <xsl:template match="@* | node()" mode="parse">
        <xsl:param name="varName"/>
        <xsl:param name="counter"/>
        <xsl:copy>
            <xsl:apply-templates select="@* | node()" mode="parse">
                <xsl:with-param name="varName" select="$varName"/>
                <xsl:with-param name="counter" select="$counter"/>
            </xsl:apply-templates>
        </xsl:copy>
    </xsl:template>
    <xsl:template match="for" mode="parse">
        <xsl:param name="varName"/>
        <xsl:param name="counter"/>
        <xsl:call-template name="forImpl">
            <xsl:with-param name="counter" select="@from"/>
            <xsl:with-param name="to" select="@to"/>
            <xsl:with-param name="varName" select="@var"/>
            <xsl:with-param name="nodes">
                <xsl:copy-of select="./*"/>
            </xsl:with-param>
        </xsl:call-template>
    </xsl:template>
    <xsl:template match="text()" mode="parse">
        <xsl:param name="varName"/>
        <xsl:param name="counter"/>
        <xsl:value-of select="if (contains(., $varName)) then fun:string-replace-all(., $varName, $counter) else ."/>
    </xsl:template>
    <xsl:function name="fun:string-replace-all">
        <xsl:param name="text"/>
        <xsl:param name="replace"/>
        <xsl:param name="by"/>
        <xsl:choose>
            <xsl:when test="contains($text, $replace)">
                <xsl:value-of select="substring-before($text,$replace)"/>
                <xsl:value-of select="$by"/>
                <xsl:value-of select="fun:string-replace-all(substring-after($text,$replace), $replace, $by)"/>
            </xsl:when>
            <xsl:otherwise>
                <xsl:value-of select="$text"/>
            </xsl:otherwise>
        </xsl:choose>
    </xsl:function>
</xsl:stylesheet> 
```

# c# - 更改可枚举集合中的对象

> ID：10902930
> 
> 赞同：0
> 
> 时间：2012-06-05T18:38:24.037
> 
> 标签：c#, collections, ienumerable

我有一个无法迭代的集合（通过索引），但它确实实现了`IEnumerable`.

枚举时有没有办法替换该集合中的对象？我知道这在循环中是不可能的`foreach`，但这似乎是一件合理的事情。

我什至考虑使用 C# 的指针，但这些指针不适用于托管类型。

我知道我可以用所有数据填充一个数组，然后以这种方式编辑它，但是

1.  看起来很浪费
2.  更重要的是，它失去了整个结构。

例如目的：

```
public void Example(object a,object b, object c)
{
    object[] ex = {a,b,c};
    object d = new MyCustomType();
} 
```

在不使用任何索引器的情况下，我该如何`ex`保持`{a,d,c}`？假设我可以访问的唯一方法`ex`是通过枚举器。类型中没有`Add`or`AddAt`方法（此处由 . 扮演`object[]`。假设底层结构未知/高度复杂。

我怎样才能做到这一点？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-06-05T18:51:02.403

正如payo所说，您的陈述相互冲突。您无法遍历 IEnumerable，但您处于 foreach 循环中，即迭代。并且 IEnumerable 几乎说您可以枚举集合。但这是我对你的问题的意见：

枚举集合时，您只能尝试更改正在枚举的数据。你绝对不能删除任何东西。这部分是由于改变枚举的潜力。

一种可能的方法是创建一个项目列表，枚举列表并将您想要的内容放入列表中。然后重新加载 IEnumerable，假设它们公开 .Add(IEnumerable list)。

在一种情况下，我有想要从 IEnumerable 中删除的项目，所以我做了一个 foreach，跟踪我想要删除的每个对象，然后在枚举之后我对我保存的每个对象进行了删除。

如今，使用 linq，您可以更轻松地执行删除对象之类的操作，前提是您可以对所需内容进行明确定义的查询（省略您不想要的内容），然后针对 IQueriable 结果集进行处理。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-06-05T19:19:15.697

你描述它的方式，我想不出可以轻松更换物品。
您声称：

*   没有添加/删除方法 - 没有简单的更改方法
*   底层集合的格式未知 - 使反射选项更难使用
*   你只有枚举器暴露给你——这意味着你只能 foreach

可能的解决方案是：

*   反映底层类型，学习它的格式并通过反射来改变你想要的任何东西
*   如果可能的话，使用深拷贝，正如我已经建议的那样。深拷贝，如果您不熟悉该术语，意味着您将在递归中更新要替换的对象及其属性，根据需要使用您要放置的对象的并行值而不是被替换的对象. 当然，如果您关心*引用*而不关心每个对象的数据/值，则此解决方案将不起作用。有几十个线程解释了如何在 SO 上使用深拷贝，所以找到一个样本应该没有问题

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-06-05T19:15:40.113

一句话：**链表**。

您还没有说是否*需要*实现`IEnumerable`（例如与 LINQ 一起使用），或者您对所引用的神秘集合有多少控制权。但是，如果您的问题从根本上说是“我如何在 C# 中迭代​​某种集合时修改它？”......嗯，这就是链表实际上很好（并且非常有效）的地方。例如：

```
var intList = new LinkedList<int>(new []{ 1, 4, 5, 7, 12 });
var node = intList.First;
do {
    // do stuff with node
    if (node.Value < 3){
        node.List.AddAfter(node, node.Value + 1);
    } else if(node.Value == 7) {
        var prevNode = node.Previous;
        node.List.Remove(node);
        node = prevNode;
    }

    // Get the next node
    node = node.Next;
} while (node != null); 
```

我并不是说您应该将您的来源收集复制到一个链接列表中，因为我们没有从您那里获得足够的信息。但也许这可以向您和未来的读者展示链表的用途——即在没有索引访问器的情况下在枚举时进行修改。

请注意，如果您引用的这个集合是完全假设的，那么您提供的信息没有答案：`IEnumerable`不需要任何方法来修改“基础集合”。事实上，`IEnumerable`甚至不需要有一个基础集合。例如，这是一个返回`IEnumerable<int>`没有基础集合的方法：

```
public static IEnumerable<int> Range(int minValue, int maxValue) {
    int current = minValue;
    while (current <= maxValue) {
        yield return current;
        current++;
    }
} 
```

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2012-06-05T21:15:30.253

原始集合有哪些变异方法？如果它支持删除或替换项目，它通过什么方式识别要删除或替换的项目？

一些实现`IEnumerable`或`IEnumerable<T>`将允许枚举工作的类即使在修改了基础集合时也能正常工作（在整个枚举中都在集合中的项目将完全返回，在枚举的一部分集合中的项目将最多返回一次，而那些在枚举过程中根本不是集合的将根本不返回）。如果您正在使用的类的行为方式如此，那就太好了。

否则，您最好的选择可能是在枚举类时构建“编辑”列表，然后在枚举完成后应用这些编辑。

# c# - 具有登录控制的单页网站

> ID：10902934
> 
> 赞同：-1
> 
> 时间：2012-06-05T18:38:42.793
> 
> 标签：c#, asp.net

我有一个单页网站（使用 c# 的 asp.net），当没有用户登录时显示一些网格数据。当用户按下登录时，弹出控件打开并且他们可以登录。登录时，该页面上提供了额外的功能。然后在一段时间不活动（即没有回发）后，我希望在该页面上自动禁用该功能，并显示一条消息，说明您已注销。

典型页面使用单独的登录页面，但这不是我想要的。以上可能吗？如何？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-06-05T18:48:50.073

简单来说，如果未登录，您可以添加条件，显示登录字段，否则，显示页面内容。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-06-05T19:20:09.807

您的“最简单”的路线是在您的页面中进行元刷新，重定向到注销页面，然后将您重定向回来。

将以下内容添加到页面头部：

```
<meta http-equiv="refresh" content="60; url=yourlogoutpage.aspx"> 
```

60 秒后，您将自动转到 yourlogoutpage.aspx，您将在此处终止会话，然后将它们重定向回此页面。

# jquery - 摆脱jQuery循环幻灯片上的水平滚动条

> ID：10902935
> 
> 赞同：1
> 
> 时间：2012-06-05T18:38:44.210
> 
> 标签：jquery, css, slider, scrollbar, jquery-cycle

我希望摆脱浏览器窗口小于 1900 像素时出现的水平滚动条 [http://focalpoint.wpconsult.net/](http://focalpoint.wpconsult.net/)

图像为 1900 像素，但可以在浏览器较小时截断，只要幻灯片保持居中且图像不缩放，因此固定宽度。

我在容器上设置了溢出隐藏，但这无济于事。在其他页面上，标题具有相同宽度的普通背景图像，但溢出隐藏工作正常，没有滚动条。

许多解决方案建议在 body 元素上添加隐藏的溢出，但这会导致无法左右滚动以阅读最小化浏览器窗口上的内容。我只是希望幻灯片区域被切断，感谢您的任何建议！

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-06-05T18:44:27.207

您的`#header-bg-img` `div`元素的宽度为`1900px`并且导致滚动

我相信你需要的是在元素上添加`min-width:980px;`和`overflow:hidden``#wrap`

这`min-width`将允许元素扩展到更大的宽度，但如果它小于 980（*页面其余部分的设计目的*），它将允许滚动..

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-06-05T18:54:46.687

添加`overflow:hidden`到您的`#wrap`样式将删除水平滚动条。

# playframework - @Constraints.Required 和 @Formats.NonEmpty 有什么区别？

> ID：10902943
> 
> 赞同：2
> 
> 时间：2012-06-05T18:39:41.607
> 
> 标签：playframework, playframework-2.0

在 Play 中创建模型时！2.x，您可以使用`@Constraints.Required`和`@Formats.NonEmpty`。据我了解，它们是相同的，但[ZenTasks 示例](https://github.com/playframework/Play20/blob/master/samples/java/zentasks/app/models/User.java)在同一领域使用它们，所以我可能错了。但为什么？

```
public class User extends Model {

    @Id
    @Constraints.Required
    @Formats.NonEmpty
    public String email;

    ...
} 
```

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2012-06-06T15:05:59.697

约束和格式具有完全不同的目标。一次用于格式化，另一个用于验证，所以

*   `@Constraints.Required`是一个验证，它确保值不为空。
*   `@Formats.NonEmpty`是一个格式化程序，它修剪输入，如果字符串的长度为 0 ( `text.trim().isEmpty()`)，则返回 null。所以该值设置为null。之后，Required-annotation 就可以完成这项工作。

因此，两者都使用通常很有用，但并非在所有情况下都使用。

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2012-06-05T20:09:33.220

*   `@Constraints.Required`检查是否发送了属性，因此您可以只发送空`space`字符，它将是有效的
*   `@Formats.NonEmpty`另外检查修剪的值是否不为空

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2013-01-21T03:46:03.483

`@Formats.NonEmpty`转换结果首先`@Constraints.Required`检查转换的结果。

例如：字符串`" "`将通过，因此，`@Constraints.Required`添加`@Formats.NonEmpty`将首先修剪`" "`并可能引发错误。`null``@Contraints.Required`

# jquery - 着色 asp:button - 似乎无法让它工作

> ID：10902948
> 
> 赞同：0
> 
> 时间：2012-06-05T18:39:58.750
> 
> 标签：jquery, asp.net, jquery-ui, button, user-interface

```
<asp:Button ID="btnOK" runat="server" Text="Send" Width="80px" CssClass="ButtonClass" style="color:Red;"/> 
```

我试过添加一个类，样式标签似乎没有任何影响。难道我做错了什么？

也试过：

```
$("input[id$=btnOK]").button();
$('input[id$=btnOK]').removeClass('defaultClass ui-state-default').addClass('ButtonClass'); 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-06-05T18:44:32.683

如果您使用的是 asp.net 4.0，您可以设置`ClientIdMode="Static"`按钮上的 ，然后将其引用为：

`$('#btnOK')`

有关 ClientIDMode 的更多信息。 [http://weblogs.asp.net/asptest/archive/2009/01/06/asp-net-4-0-clientid-overview.aspx](http://weblogs.asp.net/asptest/archive/2009/01/06/asp-net-4-0-clientid-overview.aspx)

否则你可以这样引用它：

`$('#<%=btnOK.ClientID%>')`

# c - 扫描文件以搜索预定义的 c 关键字并在控制台上打印它们

> ID：10902950
> 
> 赞同：-1
> 
> 时间：2012-06-05T18:40:05.550
> 
> 标签：c

如何扫描文件中的单词，然后在 C 编程中打印包含该单词的行？

我正在尝试找到一种方法来扫描文件以查找关键字，然后仅打印包含该单词的行。我的开始很艰难。这是我所拥有的：

```
#include <stdio.h>

void getDsk (void);

void getDsk ()
{
FILE* fp;
char result [1000];
fp = popen("diskutil list","r");
fread(result,1,sizeof(result),fp);
fclose (fp);

while(!feof(fp)) {
        if(//line contains "Test".)
        {
            //show line.
        }
    }
}

int main(int argc, const char * argv[])
{
    getDsk();
    return 0;
} 
```

**编辑：**这做了我需要的。

```
#include <stdio.h>

void getDsk (void);

void getDsk ()
{
    printf("Your available Windows installations are:\n");
    FILE* fp = popen("diskutil list","r");
    char line[1024];
    while(fgets(line, sizeof(line), fp)) 
    {
        if (strstr(line,"Microsoft")) 
        {
            printf("%s", line);
        }
        // if line contains the text, print it
    }
}

int main(int argc, const char * argv[])
{
    getDsk();
    return 0;
} 
```

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-06-05T18:44:36.557

在您当前的代码中，看起来您正在一次将整个文件读入`result`，因此没有“行”的概念。

我建议更改循环，以便一次读取一行文件。
调查[fgets](http://www.cplusplus.com/reference/clibrary/cstdio/fgets/)。
在每一行上，检查该行的关键字（[strstr](http://www.cplusplus.com/reference/clibrary/cstring/strstr/)）。

```
while(fgets(line, sizeof(line), fp)) {
    if (strstr(line, keyword) != NULL) {
        puts(line);   // if line contains the text, print it
    }
} 
```

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-06-05T18:45:16.007

一些东西：

1）你几乎不应该写`while(!feof(fp)) { ... }`它是一个**损坏**的模式，因为它`feof`只会在读取尝试**后返回 true。**因此，您很容易因一个错误而关闭。

2）你为什么要这样做？

```
fp = popen("diskutil list","r");
fread(result,1,sizeof(result),fp);
fclose (fp); 
```

您正在读取`1000`文件的字符然后将其**关闭**，然后您的存根代码就像它计划再读取文件一样......没有任何意义。

3）这是一个合理的方法：

```
char line[1024];
while(fgets(line, sizeof(line), fp)) {
    // if line contains the text, print it
} 
```

这里发生的事情是`fgets`读取一行并返回 non-`NULL`如果它成功。（在测试中使用时`NULL`被视为“假”，非`NULL`是“真”）。

所以它说“虽然我们可以成功读取一行，但请执行以下操作”，这确实是您想要的。另外，我假设没有行会超过`1024`字符，这通常是一个合理的假设，如果不是这种情况，那么您将需要相应地进行调整。

# tfs - 具有多个 Visual Studio 解决方案的 TFS 项目

> ID：10902951
> 
> 赞同：29
> 
> 时间：2012-06-05T18:40:11.293
> 
> 标签：tfs

我们的团队正在考虑使用 Team Foundation Server v.11 (2012) 来管理我们的项目。我们目前在电子表格中进行项目管理。我们的团队只为内部客户开发软件，项目之间有很多 dll 共享。我们还使用 SVN 进行源代码版本控制。

我们为应用程序的不同部分提供解决方案：通用库、应用程序库（业务规则等）、内联网网站、互联网网站、Windows 窗体。这是我们的 SVN 结构的样子

```
SVN
    -CommonLibrary (VS Solution)
        -Source
            -CommonLibrary.Core (VS Project)
            -CommonLibrary.Security (VS Project)
            -CommonLibrary.Web (VS Project)
    -OurCompanyLibrary (VS Solution)
        -Libraries (Projects within this solution reference these)
            -CommonLibrary.Core.dll
            -CommonLibrary.Security.dll
        -Source
            -OurCompanyLibrary.Application1 (VS Project)
            -...
            -OurCompanyLibrary.ApplicationN (VS Project)
    -OurCompanyIntranet (VS Solution) (MVC framework)
        -Libraries (Projects within this solution reference these)
            -CommonLibrary.Core.dll
            -CommonLibrary.Security.dll
            -CommonLibrary.Web.dll
            -OurCompanyLibrary.Application1.dll
        -Source
            -OurCompanyIntranet.Application1 (VS Class Library Project)
            -...
            -OurCompanyIntranet.ApplicationN (VS Class Library Project)
            OurCompanyIntranet.UI (VS Web Project)
    -OurCompanyInternet (VS Solution) (MVC framework)
        -Libraries (Projects within this solution reference these)
            -CommonLibrary.Core.dll
            -CommonLibrary.Security.dll
            -CommonLibrary.Web.dll
            -OurCompanyLibrary.Application1.dll
        -Source
            -OurCompanyInternet.Application1 (VS Class Library Project)
            -...
            -OurCompanyInternet.ApplicationN (VS Class Library Project)
            -OurCompanyInternet.UI (VS Web Project) 
```

将代码拆分为多个解决方案的原因是因为我们可以在不同的情况下重用应用程序库（Intranet 应用程序、Internet 应用程序、Winform 应用程序）。此外，Intranet 和 Internet 解决方案包含多个应用程序。这是我们目前的结构。我不确定这是最好的组织结构，但它对我们有用。

切换到 TFS 的问题是一个团队项目不能在多个 VS 解决方案中包含部分。例如，我们将为 Application1 设置一个 TFS 团队项目，以便我们可以为该应用程序创建一个产品 backlog。Application1 需要更改 OurCompanyLibrary、OurCompanyIntranet 和 OurCompanyInternet 以完成应用程序，但使用 TFS，Application1 将只有一个 VS 解决方案。

这是我们如何开发应用程序的示例。我们存储在 OurCompanyLibrary VS 解决方案中的所有领域模型和业务规则。当我们开发一个应用程序时，称之为Application1，我们首先开始在OurCompanyLibrary VS Solution下的OurCompanyLibrary.Application1 VS项目中创建领域模型和业务规则。一旦开发了域模型，我们就开始在 OurCompanyIntranet 和 OurCompanyInternet VS Solutions 中对事物的 UI 端进行编程。这些解决方案是一个 MVC 风格的网站。OurCompanyIntranet 包含一个 VS Web 项目 OurCompanyIntranet.UI，其中包含所有视图（.aspx 文件）、css、javasciprt 等。OurCompanyIntranet 还包含由应用程序分隔的所有模型和控制器（在本例中为 OurCompanyIntranet.Application1）。在 TFS 中组织这个成为一个问题，

你会如何在 TFS 中组织这个？有没有另一种方式我们应该组织我们的代码结构更有意义？任何能引导我们走向正确方向的文章或网站都会有很大帮助。

* * *

## 回答 #1

> 赞同：44
> 
> 时间：2012-06-12T08:33:55.427

首先，不要使用多个团队项目，这是每个人一开始都会犯的一个巨大错误。对于您的团队规模和您开发的内容：您需要一个团队项目。

当有两个完全不同的人组成的团队，使用完全不同的方法/过程从事一个完全不同的项目时，你会使用两个团队项目。

通过一个团队项目，您仍然可以：

*   有许多分支（相关或不相关）。
*   在您需要的最小级别上进行源代码控制管理
*   使用工作项的区域路径（节点树）将您的项目分成子类别（功能、技术、任何您需要的）。这样你就可以拥有一个大的产品待办事项或专门的待办事项。
*   关于整个项目或特定区域的总体报告（仍在使用区域路径，但在 Reporting Services 中）
*   相信我，这是最好的方法，很多人（包括我第一次）犯了使用多个团队项目的错误，之后不得不付出代价。你需要的是一个好的源代码控制层次结构和一个好的区域路径树。

关于解决方案：

每个项目的主要组件都有一个解决方案并不是一件坏事，开发人员可以在项目的专用子集上工作，以最大限度地提高生产力并减少组件之间的耦合。

但是您仍然可以拥有一个引用所有项目的全局解决方案，并且在您需要进行影响所有项目的更改时使用该解决方案。拥有一个全球解决方案也是一种轻松构建整个项目的简单方法。

这里的问题是**关于跨组件引用**，如果您开发的一个组件（例如 Application1）需要您开发的另一个组件（例如 OurCompanyLibrary），那么它会在两者之间创建依赖关系，并且 Application1 必须引用 OurCompanyLibrary 的“构建程序集”。

这意味着：

1.  您必须在源代码管理中的某个位置创建一个位置，以存储将被其他人引用的所有组件的构建程序集。维护一个构建周期以按照正确的顺序发布所有内容。

2.  利用新标准[Nuget](http://nuget.org)并设置内部 Nuget 服务器（非常容易做到）并为其他人引用的组件构建自己的 Nuget 包。

3.  最简单的方法是将所有内部开发的依赖项包含在解决方案中，以确保在需要时构建它们。这很容易做到，但您的 Application1 项目将包含您的大部分 VS 项目。我没有说这是一个好或坏的方式，这是你的电话。有时简单的方法是最好的方法。

每种方式都有其优点/缺点，只有您可以决定哪种方式最好。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-06-07T01:21:52.483

如果这是一个在生产中运行的应用程序，我将对文件夹/解决方案结构进行最小的更改。在构建定义中的 TFS 中，您可以选择多个项目，也可以将多个解决方案放入构建脚本中，如下例所示

[如何从单个 TFS 团队构建定义构建 2 个解决方案](https://stackoverflow.com/questions/6431177/how-to-build-2-solutions-from-a-single-tfs-team-build-definition)

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-06-05T21:08:06.710

正如您所预测的那样：-

OurCompanyLibrary 将是一个 VS 解决方案。

OurCompanyLibrary.Application1 ... OurCompanyLibrary.ApplicationN 将是该解决方案中的 VS 项目。

OurCompanyLibrary.ApplicationX.dlls 将是 OurCompanyIntranet 和 OurCompanyInternet VS Solutions 中的引用。

我不确定我是否理解你的问题。

OurCompanyLibrary 中的应用程序 VS 项目可以单独构建，生成自己的 dll，然后可以在其他两个解决方案中引用。如果问题是所有应用程序都在一个 VS 团队项目（OurCompanyLibrary）下，那么答案是为每个应用程序创建一个单独的 VS 团队项目 - OurCompanyLibrary1 用于 Application1，OurCompanyLibrary2 用于 Application2 等。然后每个应用程序的开发完全自给自足，与其他人分开。

如果问题是您希望源的不同部分在不同的解决方案中，那么可以通过将项目添加到解决方案来实现。这确实意味着所有这些解决方案都具有所有源代码。我们在我工作的地方有类似的东西：- 我们有一个包含 2 个项目的解决方案 - 我们的通用业务逻辑层和我们的通用数据访问层。我们的每个其他解决方案都包含这些项目。这意味着我们可以编辑任何解决方案的源代码。

我不知道这些对你有没有帮助，但祝你好运！

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2012-06-12T08:54:12.183

如果您想对整个代码库进行集中报告，您应该探索使用**一个**TeamProject 来托管所有内容的可能性。
然后为了区分不同的组件/部分，您可以在此 TeamProject 中使用单独的区域。
查看[这篇](http://blog.hinshelwood.com/when-should-i-use-areas-in-tfs-instead-of-team-projects-in-team-foundation-server-2010/)非常有趣的文章，尤其是“优点/缺点”部分。

# google-apps-script - 通过 getActiveSheet() 访问电子表格时遇到错误——任何其他方式都可以正常工作

> ID：10902952
> 
> 赞同：2
> 
> 时间：2012-06-05T18:40:16.013
> 
> 标签：google-apps-script

一个多月以来，我一直在 Google Apps Script 中编写一组脚本（特别是在一组电子表格上），突然之间，每当我尝试通过`SpreadsheetApp.getActiveSheet()`.

我以为我在某个函数中丢掉了一些东西，直到我编写了一个不依赖于我自己的任何代码的测试函数：

```
function basicFunctionality() {
  var sheet = SpreadsheetApp.getActiveSheet();
  var range = sheet.getRange('b2');
  var vals = range.getValues();
  Browser.msgBox(vals[0][0]);
} 
```

运行此函数会返回此错误...

```
Unknown sheet name (line 5) 
```

...这似乎暗示“getValues”行存在问题，除了当我通过`getActiveSpreadsheet()`（例如`getSheetByName()`，`getSheets()[0]`）以外的任何方式访问工作表时，函数运行到最后并返回预期结果。

现在，我仍然假设这是我的代码文件中的一个问题，而不是谷歌的错误——但我已经没有想法了。我什至尝试将我所有的脚本文件复制到一个新的电子表格文档/项目中——如果它是我唯一移植的东西，这个测试功能就可以工作，但是一旦项目的其余部分进入那里，问题就会再次出现（即使我完全注释掉所有其他文件，这是最奇怪的部分）。

有什么办法可以让我想象“破碎” `getActiveSheet()`？还是我错误地识别了问题？

提前感谢您的任何见解！

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-07-14T18:32:40.273

你的代码对我来说很好。我将该函数附加到我放入电子表格的绘图中，运行它，它从该表中的单元格 B2 返回数据。

你能再试一次，看看它对你来说还是坏了吗？

脚本是否有可能在 GAS 不知道活动工作表是什么的情况下运行？当我在调试器中运行代码时，它似乎选择了第一个工作表作为活动工作表，而不管哪个工作表最后有输入。

# r - 以不同的比例绘制

> ID：10902953
> 
> 赞同：-2
> 
> 时间：2012-06-05T18:40:17.080
> 
> 标签：r, plot

我对如何绘制具有不同轴比例的图形有疑问，伪代码如下：

```
plot(data1,data2,xlim=c(0,10,100,1000),ylim=c(0,1000)) 
```

这意味着x轴的间隔不是均匀的，而是具有不同的尺度。

谢谢德温！你给了我另一种情节。我要绘制的就是这个图，你知道怎么绘制吗？ ![在此处输入图像描述](../Images/0afa2df2a6490eb4b010c5abc52c64f5.png)

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-06-05T19:16:02.160

```
options(scipen=8); plot(10^(1:5),1:5, log="x") 
```

一个常见的问题是如何处理对数刻度上 0 的位置，但请尝试`log(0)`在控制台输入以查看为什么它不会出现。

# python-2.7 - Strange syntax error in Python 2.7.3

> ID：10902956
> 
> 赞同：1
> 
> 时间：2012-06-05T18:40:25.400
> 
> 标签：python-2.7, syntax-error, primes

I have recently decided to learn basic programming, and am using an MIT OpenCourseware class to learn in Python. One of the assignments is to create a program that generates the 1000th prime number starting from 0\. One of my first solutions is as follows:

```
oddList = []
for odd in range(3, 10000):
if odd % 2 != 0:
    oddList.append(odd)
else:
    continue

primeCount = 3
loopHolder = True
while loopHolder == True:

for possiblePrime in oddList:
    if primeCount == 1000:
        print possiblePrime
        loopHolder = False
    from math import *
    limit = int(math.sqrt(possiblePrime)

    for primeTest in range(2, limit):
            testCount = 0
            if possiblePrime % primeTest == 0:
                testCount = testCount + 1
                primeCount = primeCount                
            else:
                continue
            if testCount > 0:
                primeCount = primeCount
                break
            else:
                primeCount = primeCount + 1
                break 
```

However, when I run it, I get a syntax error at "for primeTest in range(2, limit):" and python is highlighting the colon specifically. I realize the error is probably a result of a syntax error somewhere else, but I can't find it. Could someone point out where my error is?

PS: Help with the semantics of the code is not needed, though appreciated.

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-06-05T18:47:37.540

空白对 python 来说非常非常重要。当您编写代码然后将其复制到 stackoverflow 时，您需要更加注意这一点。现在，如果我要复制和粘贴它，您的代码将无法像您编写的那样工作。

对于您的问题，请查看上面的两行，看看您是否缺少右括号。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-06-05T18:45:21.333

您有“while loopHolder == True:”，后面没有缩进块。您可能应该将其写为“while loopHolder:”，因为不需要 == True 部分。我也会避免在循环中进行导入。导入语句通常位于文件的顶部，除非您需要将它放在其他位置。在“limit = int(math.sqrt(possiblePrime)”之后也没有右括号。

# c# - 如何隐藏或显示 div

> ID：10902959
> 
> 赞同：5
> 
> 时间：2012-06-05T18:40:42.397
> 
> 标签：c#, javascript, asp.net

我在我的 Page_Load 上注册了这个

```
 Page.ClientScript.RegisterStartupScript(this.GetType(), "clientscript", "document.getElementById('showdiv').style.visibility = 'hidden';", true); 
```

但它并没有被隐藏......我的div如下所示

```
<div id="showdiv">
   <input class="button" type="button" value="OK" name="success_button" id="my button"  onclick="javascript:window.close();" />
   </div> 
```

我究竟做错了什么？。感谢您的帮助

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2012-06-05T19:38:53.873

我强烈建议使用 JavaScript 或使用 .js 库（如 jQuery）更轻松地进行这种简单的客户端操作（显示/隐藏行控件等）。在您的应用程序中包含 jQuery 脚本后，您需要做的就是在页面完成初始化后隐藏该 DIV。

将此脚本部分包含在页面顶部或引用的 .js 文件中（如果您已经有一个）：

```
<script type="text/javascript">

 //$(document).ready is used to define a function that is guaranteed to be called only after the DOM has been initialized.
 $(document).ready(function () {
    //Hide the div
    $('#showdiv').hide();
    //conversely do the following to show it again if needed later
    //$('#showdiv').show();
 });

</script> 
```

此方法的 jQuery API 文档：http:
[//api.jquery.com/hide/](http://api.jquery.com/hide/)

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2012-06-05T18:58:04.220

为什么不使用`asp:Panel`服务器标签？

前端：

```
<asp:Panel runat="server" ID="ShowDiv">
...
</asp:Panel> 
```

后端：

```
ShowDiv.Visible = false; 
```

该`Panel`控件将`<div>`在运行时呈现为 a。这对我来说似乎比注册客户端脚本更干净。

* * *

## 回答 #3

> 赞同：4
> 
> 时间：2014-05-20T09:09:08.387

HTML

```
 <div id="div1" runat="server"></div> 
```

C＃

```
div1.Visible=false; 
```

我认为这会奏效...

* * *

## 回答 #4

> 赞同：2
> 
> 时间：2012-06-06T10:31:25.917

你有两个选择

1-将“runat = server”属性添加到您的div，然后从后面的代码访问它并使可见性为false或添加样式以使其不可见。

```
myDiv.Style.Add("display","none"); 
```

2-添加javascript函数来隐藏它，你可以使用jquery来做到这一点。

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2012-06-06T11:06:13.987

Javascript：

```
$(document).ready(function(){

    $(".slidingDiv").hide();
    $(".show_hide").show();

$('.show_hide').click(function(){
$(".slidingDiv").slideToggle();
});

}); 
```

HTML

```
<a href="#" class="show_hide">Show/hide</a>
<div class="slidingDiv">
Fill this space with really interesting content. 
<a href="#" class="show_hide">hide</a>
</div> 
```

CSS

```
.slidingDiv {
height:300px;
background-color: #99CCFF;
padding:20px;
margin-top:10px;
border-bottom:5px solid #3399FF;
}

.show_hide {
display:none;
} 
```

* * *

## 回答 #6

> 赞同：1
> 
> 时间：2013-11-01T18:45:41.663

我来这里寻找解决方案并最终将“runat = server”添加到我的div中，然后将其隐藏在代码隐藏中

myDivID.Visible = false;

* * *

## 回答 #7

> 赞同：0
> 
> 时间：2012-06-05T20:42:56.050

我认为这是另一个加载顺序问题。

您的脚本在加载后立即运行。如果它试图隐藏的页面元素在脚本运行时没有加载到 DOM 中，那么就没有什么可隐藏的了。我相信注册的脚本都进入页面顶部，在 HTML 内容之前，所以这种情况总是会发生。

为了让它工作，你必须把它放在一个加载事件监听器中。请参阅：[在页面加载时运行 javascript 代码，而不使用 onload 标记](https://stackoverflow.com/questions/4722687/running-javascript-code-on-page-load-without-using-the-onload-tag)

也就是说，由于您试图无条件隐藏页面元素，您可能会很高兴在服务器端关闭此页面元素，方法是向您的 CSS 隐藏的元素添加一个类，或者直接从服务器代码操作其样式/可见性。

如果应该对 Div 是否可见存在某种条件，那么在客户端 javascript 中完成这一切可能会更好，这样您就不必为了控制可见性而进行服务器访问。

* * *

## 回答 #8

> 赞同：0
> 
> 时间：2017-07-31T11:10:19.627

我们创建链接调用 javascript

```
 <p><a href="#" class="show_hide" onclick="recoverDiv();">Mot de passe oublié</a></p> 
```

要显示和隐藏的 div

```
<div id="divdiv"  runat="server" class="HideMe">
</div> 
```

并在javascript中添加：

```
<script type="text/javascript">

    function recoverDiv() {
        $('#divdiv').attr('class', 'ShowMeForced');
    }
</script> 
```

在 CSS 中：

```
<style type="text/css">
    .HideMe { display:none; }
    .ShowMe { display:block; }
    .HideMeForced { display:none !important; }
    .ShowMeForced { display:block !important; }
</style> 
```

# php - 向手机发送短信 - 删除 ( ) 的 php 表单和 - 从提交的电话号码中

> ID：10902961
> 
> 赞同：1
> 
> 时间：2012-06-05T18:41:09.477
> 
> 标签：php, sms, character

我有一个在网上找到的脚本，它试图获取 10 位数的电话号码，然后添加移动提供商以向 SMS 发送电子邮件。

有用。但...

我的前端表单会自动输入“(”、“)”和“-”**括号**和**破折号**，使其看起来更像电话号码。php 脚本不起作用，因为您必须发送电子邮件而没有这些，只有 0,1,2,3,4,5,6,7,8,9 有效。

您可以在此处查看前端表单。 [http://busetopizza.com/demo/index.php](http://busetopizza.com/demo/index.php) 点击“发送到电话”

您注意到它将发送 (516)-233-2333 作为提交。

我需要帮助重写代码以去除字符，然后将其重新评估为某种东西，以便将其发送为 5162332333。

附上php代码..这个可以吗？？？

```
<?php
if (!isset($_POST['submit'])){error("Must use form to get here!");}
$ph = $_POST['10digit'];
$carrier = $_POST['carrier'];
switch ($carrier){
    case 'att':
        $to = $ph . '@txt.att.net';
        break;
    case 'metropcs':
        $to = $ph . '@mymetropcs.com';
        break;
    case 'nextel':
        $to = $ph . '@messaging.nextel.com';
        break;
    case 'sprint':
        $to = $ph . '@messaging.sprintpcs.com';
        break;
    case 'tmobile':
        $to = $ph . '@tmomail.net';
        break;
    case 'verizon':
        $to = $ph . '@vtext.com';
        break;
    case 'virgin':
        $to = $ph . '@vmobl.com';
        break;      
    default:
        error("No carrier selected, message not sent!");
}
$message = "http://www.busetopizza.com/";
$subject = "Send To Phone App";
$from = "admin@messtudios.com";
mail($to, $subject, $message, $from);
echo "Your message has been sent!";
exit();
function error($msg){
    echo "An error has occurred: ".$msg;
    exit();
}
?> 
```

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-06-05T18:44:31.307

编辑以下行以使用[正则表达式](http://php.net/preg_replace)来查找和替换输入中的所有非数字字符。

```
$ph = preg_replace('/[^[:digit:]]/', '', $_POST['10digit']); 
```

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-06-05T18:44:07.553

您可以使用正则表达式从输入中删除非数字数字。

```
$pattern = '/[^0-9]*/';
$ph =  preg_replace($pattern,'', $_POST['10digit']); 
```

# vb.net - 使用 LINQ 查询具有 varbinary 字段的实体

> ID：10902962
> 
> 赞同：0
> 
> 时间：2012-06-05T18:41:12.043
> 
> 标签：vb.net, asp.net-mvc-3, linq, entity-framework-4.1

当我尝试查询其中包含 varbinary 字段的实体时，出现错误：

“LINQ to Entities 不支持 LINQ 表达式节点类型 'ArrayIndex'。”

这是我的查询：

```
Dim query = From entity In db.Entity
        Where entity.Id= Id          
        Select entity.VarBinaryField

 If query.FirstOrDefault IsNot Nothing Then

     bytes = query.First.ToArray

     Return File(bytes, System.Net.Mime.MediaTypeNames.Application.Octet, "test")

 End If 
```

当我检查查询不是空的时，会生成错误。

任何建议将不胜感激！

谢谢！

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-06-06T15:48:28.273

我在我的 linq 查询中还有一些其他参数，我没有包括在内...参数是从引发错误的数组中提取的，而不是 varbinary 字段...

# javascript - 任意运行时脚本元素和 DOM 元素之间的连接

> ID：10902965
> 
> 赞同：2
> 
> 时间：2012-06-05T18:41:18.267
> 
> 标签：javascript, jquery, dom

这是最近困扰我的事情，我发现了相关的问题（比如[这里](https://stackoverflow.com/questions/6932679/get-dom-element-where-script-tag-is)和[这里](https://stackoverflow.com/questions/8177283/how-to-run-a-script-embedded-as-an-attribute-in-a-dom-element)），但它们并不是我要找的东西，而且似乎应该有，所以我担心我错过了某物。

AJAX 请求返回一段 HTML 以及一些旨在以某种方式操作（或初始化）HTML 的 JavaScript 是一种相当常见的模式（至少是我的）。我想做的是能够引用直接从 JavaScript 插入的 HTML，例如：

```
<div class="fancy_div">
  <select></select>
</div>
<script type="text/javascript">
  myAlreadyLoadedLibraryFunction(justInsertedDivAbove);
</script> 
```

但相反，我的理解是脚本块几乎不知道它在页面上的位置，不能直接引用元素，而是相对。

我在这里看到的建议是：

1.  将 id 应用于 div 并以这种方式引用它
2.  使用 jQuery，使用该类来遍历该类的所有 div

对于#1，我想为一个可能只需要相对向前引用的元素生成一个唯一的 id 似乎有点矫枉过正。

对于＃2，迭代该类页面中的所有元素似乎是巨大的矫枉过正

我目前正在从 Prototype 转向更多的 jQuery，所以我对 jQuery 风格并不完全熟悉（但我很感兴趣）。

我可能想太多了，或者遗漏了一些东西，或者我的模式被误导了，或者只是需要一个轻推——谢谢你的时间！

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-06-05T19:01:48.880

除非您打算这样做数十万次，否则创建用于抓取元素的新唯一 ID 不会真正对性能产生重大影响。事实上，它几乎可以肯定是最快的方法。

# spring - IoC 容器属性继承

> ID：10902972
> 
> 赞同：1
> 
> 时间：2012-06-05T18:41:31.920
> 
> 标签：spring, inversion-of-control

我有许多依赖于其他文件中的属性占位符的 Spring 文件。本质上，我有 3 个 XML 文件，如下所示：

**一个.xml**：

```
<?xml version="1.0"?>
<beans ...>

    <import resource="two.xml"/>

    <bean class="org.springframework.beans.factory.config.PropertyPlaceholderConfigurer">
        <property name="locations">
            <list>
                <value>/WEB-INF/your.properties</value>
            </list>
        </property>
    </bean>

    <bean id="clasher" class="whatever.Clash">
        <property name="name" value="${route.one}"/>
    </bean>
</beans> 
```

**二.xml**：

```
<?xml version="1.0"?>
<beans ...>

    <bean class="org.springframework.beans.factory.config.PropertyPlaceholderConfigurer">
        <property name="locations">
            <list>
                <value>/WEB-INF/my.properties</value>
            </list>
        </property>
    </bean>
</beans> 
```

**我的属性**：

```
route.one = Why Not? 
```

**你的属性**：

```
entirely.unrelated = true 
```

我收到一个基本上看起来像这样的错误：

```
Exception in thread "Launcher:/serverling" org.springframework.beans.factory.BeanDefinitionStoreException: Invalid bean definition with name 'clasher' defined in ServletContext resource [/WEB-INF/one.xml]: Could not resolve placeholder 'route.one'
    at org.springframework.beans.factory.config.PropertyPlaceholderConfigurer.processProperties(PropertyPlaceholderConfigurer.java:287)
    at org.springframework.beans.factory.config.PropertyResourceConfigurer.postProcessBeanFactory(PropertyResourceConfigurer.java:75)
    at org.springframework.context.support.AbstractApplicationContext.invokeBeanFactoryPostProcessors(AbstractApplicationContext.java:663)
    at org.springframework.context.support.AbstractApplicationContext.invokeBeanFactoryPostProcessors(AbstractApplicationContext.java:638)
    at org.springframework.context.support.AbstractApplicationContext.refresh(AbstractApplicationContext.java:407)
    at org.red5.server.tomcat.TomcatLoader$1.run(TomcatLoader.java:594) 
```

有没有办法让属性占位符在整个容器中继承？

我最初的假设是，由于容器并不真正关心 bean 所在的文件，它会简单地配置所有 bean，然后运行容器中所有定义的 bean，并使用多个属性占位符配置器来填充它们。

为什么这个例子不起作用L

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-06-05T21:26:29.040

将此标志设置为`PropertyPlaceHolderConfigurer`：

```
<property name="ignoreUnresolvablePlaceholders" value="true"/> 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-06-05T20:45:18.583

只需给每个 bean`PropertyPlaceholderConfigurer`一个 ID（或至少其中一个）就可以了。我的猜测是，当没有声明 Bean ID 时，一个会覆盖另一个，这就是您丢失一些属性值的原因。如果您在基于注释的文本上下文中使用它，请考虑[这个问题](https://jira.springsource.org/browse/SPR-5456)。[这里](http://www.cwinters.com/blog/2005/07/26/multiple_separate_propertyplaceholderconfigurers_in_spring.html)还演示了属性配置器的多个实例的更精细的用法。

# c# - 格式化VS2010中的每个C#代码文件？

> ID：10902979
> 
> 赞同：1
> 
> 时间：2012-06-05T18:41:51.347
> 
> 标签：c#, visual-studio-2010, visual-studio

> **可能重复：**
> [格式化 - 一次 - Visual Studio 项目中的所有文件](https://stackoverflow.com/questions/931406/formatting-at-once-all-the-files-in-a-visual-studio-project)

我知道`Ctrl`+ `E`, `Ctrl`+`D`将格式化整个文档。

我的项目中有 100 多页，解决方案中有几个项目。

有没有简单的方法来格式化项目中的所有文档？

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-06-05T18:45:04.873

你有[ReSharper](http://jetbrains.com/resharper)吗？这使您可以对解决方案中的所有文件应用多种代码清理，包括代码重新格式化、排序`using`指令和删除未使用的指令等。

当然，它还有许多其他功能 - 强烈推荐。不过，我不知道没有任何 VS 插件的方法。当然，也有可能有一个免费的插件也有这个功能。

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2012-06-05T19:01:25.690

以下是一些用于在 Visual Studio 中格式化整个解决方案的宏：[macro1](http://www.kodefuguru.com/post/Format-Solution.aspx)、[macro2](http://timwise.blogspot.com/2009/01/format-all-document-in-visual-studio.html)。

选一个。

# javascript - javascript数组未正确打印到控制台

> ID：10902981
> 
> 赞同：1
> 
> 时间：2012-06-05T18:42:00.480
> 
> 标签：javascript

我将一些日期放入一个数组中，并希望该数组中的第二个“层”保存与该日期关联的订单号。它似乎工作正常，但是当我在 chrome 控制台中打印出数组时，我只看到第一个日期数组。如果我手动访问`console.log(dateArray[1]['order_number']);`，我会看到预期的信息。我没有正确构建这个数组吗？

谢谢！

```
 for ( var u in valuesArr ) {

        //store the text seperator between the information and the order it is associated with
        var sep = "?order_num=";

        //store the string from which the information and order number will be extracted
        var str = valuesArr[u];

        //location of seperator
        var start = str.indexOf("?order_num=");

        var order_number = str.substring(start+sep.length);

        var current_date = valuesArr[u].substring(0, start);

        //date goes into "current_date" array
        current_date = current_date.split(" / ");

        //fashion it into a javascript date
        //month needs one subtracted
        dateArray[u] = new Date ( current_date[2], current_date[0]-1, current_date[1]);

        /*
        *to identify from which order this date derives, an order_number slot is created
        *underneath the sorted date slot
        *this is done so that when the html is reformatted to re-order the dates
        *the content associated with this date can be 'brought along with' it
        *as the its parent div's id contains the order number
        */
        dateArray[u]['order_number'] = order_number;

    }
    console.log(dateArray)//only outputs the array of dates
    console.log(dateArray[1]['order_number']);//outputs the order number 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-06-05T18:49:14.007

您正在做的`dateArray[u]['order_number'] = order_number;`是向 Date 对象添加一个属性，而不是向数组添加一个元素。

要将元素添加到数组中，请使用：

```
dateArray[u][1] = order_number; 
```

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-06-05T18:49:34.400

不要暗中信任开发者控制台。没有“正确”的印刷，因为没有标准。

如果 Chrome 决定不在对象上显示自定义属性，则由 Chrome 决定。只要通过显式测试证明您的价值就在那里，这就是最重要的。

* * *

FWIW，您可能会得到更理想的结果......

```
console.dir(dateArray) 
```

该`console.dir`方法将为您提供可扩展的对象，以便您可以向下钻取并查看您的自定义属性。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-06-05T18:46:10.887

如果`valuesArr`是一个数组，那么 using`for (... in ...)`将失败，因为这会进行*对象*迭代，因此会抓取数组的许多其他元素，例如`length`,`indexOf`等。

尝试改用传统`for`循环：

```
for (var i = 0; i < valuesArr.length; i++) {
  // ...
} 
```

# python - Return a sorted iterator of dictionaries based on the keys used for obtaining these dictionaries

> ID：10902987
> 
> 赞同：1
> 
> 时间：2012-06-05T18:42:23.673
> 
> 标签：python, dictionary

I wonder if it is possible to achieve the following in Python:

I have a nested dictionary `nested_dict`, which maps each three-element tuple `(a, b, c)` to a sub-dictionary `sub_dict`, and I have another list `list_b` containing all the elements corresponding to the second element (i.e. the one denoted by `b`) in the tuple keys above.

Given `nested_dict` and `list_b`, as well as a fixed pair of `a` and `c` (i.e. the first and the third element of a tuple key, respectively), I want to obtain a **sorted iterator** over the sub-dictionaries **based on the elements in `list_b` that forms a part of the tuple keys**, in other words, by using this iterator, I can iterate through the returned sub-dictionaries like this:

`nested_dict[(a, b_1, c)], nested_dict[(a, b_2, c)], nested_dict[(a, b_3, c)], ...`

where, `b_1 < b_2 < b_3 ...` and each `b_i` is in `list_b`

I am thinking along this line:

```
def sorted_dict_itr (nested_dict, list_b, a, c):
    return (nested_dict[(a, b, c)] for b in sorted(list_b)) 
```

But would this always return an iterator over `nested_dict[(a, b, c)]` by the order of `b`? If so, is there any more efficient way (meaning speedier code) to achieve the same?

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-06-05T18:49:52.980

是的，它应该，假设您想要默认强加的`b`元素的顺序。`sorted()`

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-06-05T21:53:17.547

是的，它有效。

保留一个排序的集合代替保留 list_b 并动态排序将提高效率——但当然它可能会降低其他更重要的地方的效率。

没有其他方法可以提高算法的复杂性——dict 查找是恒定时间的，迭代列表的速度与迭代任何可能的速度一样快。

通过避免需要以各种不同的方式散列每个 (a, b, c) 元组，您可能可以通过一个小的常数因子来加快速度，但我怀疑这会产生很大的不同。

您可以通过与变量范围相关的各种微优化以及是否产生值或返回生成器来通过一些操作码来加快速度，但很难想象这会很重要。

# c# - WPF NotifyIcon - ContextMenu Position

> ID：10902989
> 
> 赞同：3
> 
> 时间：2012-06-05T18:42:36.233
> 
> 标签：c#, .net, wpf, contextmenu, notifyicon

Im using the WPF NotifyIcon from [CodeProject](http://www.codeproject.com/Articles/36468/WPF-NotifyIcon). It works fine but what I noticed is that when compiling with .NET 4.0 the ContextMenu is always positioned above the taskbar, it's fine with .NET 3.5:

.NET 3.5

![.NET 3.5](../Images/c50754b20cdb30857feb903a81345d69.png)

.NET 4.0

![.NET 4.0](../Images/6f3da39fa751c7995d09aabd406c08fd.png)

I played around with the position values inside the TaskbarIcon Class but the ContextMenu just doesn't want to get in front of the taskbar:

```
 ContextMenu.Placement = PlacementMode.AbsolutePoint;
    ContextMenu.HorizontalOffset = cursorPosition.X;
    ContextMenu.VerticalOffset = cursorPosition.Y; 
```

I already asked about this in the [comment section on CodePlex](http://www.codeproject.com/Articles/36468/WPF-NotifyIcon?msg=4249280#xx4249280xx) Page a few weeks ago but didn't receive an answer.

Does anyone have a solution or workaround for this?

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2014-03-07T19:22:05.910

我使用的是这个类来确定任务栏的位置，然后根据它放置上下文菜单而不是光标位置。

[如何以编程方式确定 Windows 任务栏是否隐藏？](https://stackoverflow.com/questions/2032461/how-can-i-determine-programmatically-whether-the-windows-taskbar-is-hidden-or-no#answer-2032557)

# php - Symfony2 Fatal Error every time I change a twig file

> ID：10902991
> 
> 赞同：0
> 
> 时间：2012-06-05T18:42:46.273
> 
> 标签：php, symfony, twig

Every time I change a view file of type .twig I get this error:

> Fatal error: Call to a member function getContent() on a non-object in /pathto/myappbundle/vendor/bundles/Symfony/Bundle/AsseticBundle/Factory/Resource/FileResource.php on line 54

I can resolve this error by doing:

```
php app/console cache:clear --env=prod; php app/console cache:clear --env=dev 
```

But because of this I have to clear cache every time I change something, even in dev.

If I do the command:

```
php app/console router:debug 
```

It gives the same error.

I found online someone saying he had the same error and his solution was that one of his html.twig files was actually saved as html.twig.twig. I looked through all my twig files and none were saved like that.

Has anybody ever experienced this or solved this problem, or has any suggestions where I can look to solve this? There is no more specific trace on where this is happening in my code.

# android - 跨不同活动的静态视图

> ID：10902992
> 
> 赞同：0
> 
> 时间：2012-06-05T18:42:47.030
> 
> 标签：android, animation, view, fragment

我有两个不同的活动，它们在标题中具有相同的视图。有没有办法在这两个活动之间转换而不会导致屏幕闪烁，所以相同的视图看起来是静态的？

该应用程序的当前实现只有一个带有一堆片段的 Activity。遵循所有内容有点困难，因此创建不同的活动将真正有助于遵循流程。

有什么建议吗？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-06-05T18:51:14.650

> 有没有办法在这两个活动之间转换而不会导致屏幕闪烁，所以相同的视图看起来是静态的？

不，对不起。

> 该应用程序的当前实现只有一个带有一堆片段的 Activity。遵循所有内容有点困难，因此创建不同的活动将真正有助于遵循流程。

然后放松您的“不会导致屏幕闪烁，因此相同的视图看起来是静态的”要求。

用 Web 术语来说，你是在说“哎呀，将所有这些东西放在一个网页中真的很复杂，但我需要它在一个网页中，因为我们不希望页面标题在用户时“闪烁”单击链接以加载下一个网页”。活动大致类似于网页——它们之间会有一个可见的过渡，它们占据了整个渲染空间。您可以使用片段获得所需的视觉效果——就像在 Web 上使用 DOM 重写等一样——以复杂性为代价。

# iphone - SBJson Parsing：如何向下钻取？

> ID：10902998
> 
> 赞同：0
> 
> 时间：2012-06-05T18:43:14.290
> 
> 标签：iphone

我想我需要澄清一下在使用 SBJson 时如何深入到 JSON 值。

这是我需要解析的一些示例 JSON 的链接。 [https://api.foursquare.com/v2/venues/search?ll=40.7,-74&client_id=5EN0WTZZXNLZ3ONGVYBJFVPNPACK21B0NWS4C2R02MRFJOGG&client_secret=UHD0NEHNQMQZZWRJ4X51DBQNWENP0D0YHG3WFVWJ24VJHAOZ&radius=40128&v=2012](https://api.foursquare.com/v2/venues/search?ll=40.7,-74&client_id=5EN0WTZZXNLZ3ONGVYBJFVPNPACK21B0NWS4C2R02MRFJOGG&client_secret=UHD0NEHNQMQZZWRJ4X51DBQNWENP0D0YHG3WFVWJ24VJHAOZ&radius=4828&v=20120601)

如果我查看解析的 JSON，我正在寻找位置记录。我的问题是什么都没有带进来。所以，我的问题是我怎样才能获得位置记录？

代码如下。

```
- (NSString *)stringWithUrl:(NSURL *)url
{
    NSURLRequest *urlRequest = [NSURLRequest requestWithURL:url
                                                cachePolicy:NSURLRequestReloadIgnoringLocalCacheData
                                            timeoutInterval:30];
    // Fetch the JSON response
    NSData *urlData;
    NSURLResponse *response;
    NSError *error;

    // Make synchronous request
    urlData = [NSURLConnection sendSynchronousRequest:urlRequest
                                    returningResponse:&response
                                                error:&error];

    // Construct a String around the Data from the response
    return [[NSString alloc] initWithData:urlData encoding:NSUTF8StringEncoding];
}

- (id) objectWithUrl:(NSURL *)url
{

    SBJsonParser *jsonParser = [[SBJsonParser new] autorelease];
    NSString *jsonString = [self stringWithUrl:url];

    // Parse the JSON into an Object
    return [jsonParser objectWithString:jsonString error:NULL];

}

- (void) downloadJSONFeed 
{

    //set up query
    NSString *lat  = [NSString stringWithFormat:@"%f", ad.locationManager.location.coordinate.latitude]; 
    NSString *lon = [NSString stringWithFormat:@"%f", ad.locationManager.location.coordinate.longitude];
    NSString *postValues = [NSString stringWithFormat:@"https://api.foursquare.com/v2/venues/search?ll=%@,%@&client_id=%@&client_secret=%@&radius=4828&v=20120601",lat, lon, @"5EN0WTZZXNLZ3ONGVYBJFVPNPACK21B0NWS4C2R02MRFJOGG", @"EHNQMQZZWRJ4X51DBQNWENP0D0YHG3WFVWJ24VJHAOZ"];

    //get server response
    id response = [self objectWithUrl:[NSURL URLWithString:postValues]];
    NSDictionary *location = [response objectForKey:@"location"];

    //array for json data
    NSMutableArray *jsonData = [[NSMutableArray alloc] init];

    for (NSDictionary *dict in location)
    {
        Bathroom *bathroom = [[[Bathroom alloc] init] autorelease];
        bathroom.name = [dict objectForKey:@"name"];
        bathroom.street = [dict objectForKey:@"address"];
        bathroom.city = [dict objectForKey:@"city"];
        bathroom.state = [dict objectForKey:@"state"];
        bathroom.postal = [dict objectForKey:@"postalCode"];        
        bathroom.country = [dict objectForKey:@"country"];        
        [jsonData addObject:bathroom];
    } 

    //release dictionary
    //[dictionary release];

    //now sort array by distance
    NSSortDescriptor *sortDescriptor;
    sortDescriptor = [[[NSSortDescriptor alloc] initWithKey:@"name"                                                  ascending:YES] autorelease];
    NSArray *sortDescriptors = [NSArray arrayWithObject:sortDescriptor];
    NSArray *sortedArray;
    sortedArray = [jsonData sortedArrayUsingDescriptors:sortDescriptors];
    //dataArray = [[NSMutableArray alloc] init];

    //add objects to data array
    [dataArray addObjectsFromArray:sortedArray];

    //release json data
    [jsonData release];

} 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-06-05T19:30:49.920

以下代码部分是您的问题所在：

```
//get server response
id response = [self objectWithUrl:[NSURL URLWithString:postValues]];
NSDictionary *location = [response objectForKey:@"location"];

//array for json data
NSMutableArray *jsonData = [[NSMutableArray alloc] init];

for (NSDictionary *dict in location)
{
    Bathroom *bathroom = [[[Bathroom alloc] init] autorelease];
    bathroom.name = [dict objectForKey:@"name"];
    bathroom.street = [dict objectForKey:@"address"];
    bathroom.city = [dict objectForKey:@"city"];
    bathroom.state = [dict objectForKey:@"state"];
    bathroom.postal = [dict objectForKey:@"postalCode"];        
    bathroom.country = [dict objectForKey:@"country"];        
    [jsonData addObject:bathroom];
} 
```

尝试将其更新为以下内容：

```
//get server response
id response = [self objectWithUrl:[NSURL URLWithString:postValues]];
NSArray *venues = [[response objectForKey:@"response"] objectForKey:@"venues"];

//array for json data
NSMutableArray *jsonData = [[NSMutableArray alloc] init];

for (NSDictionary *dict in venues)
{
    Bathroom *bathroom = [[[Bathroom alloc] init] autorelease];
    NSDictionary *location = [dict objectForKey:@"location"];
    bathroom.name = [location objectForKey:@"name"];
    bathroom.street = [location objectForKey:@"address"];
    bathroom.city = [location objectForKey:@"city"];
    bathroom.state = [location objectForKey:@"state"];
    bathroom.postal = [location objectForKey:@"postalCode"];        
    bathroom.country = [location objectForKey:@"country"];        
    [jsonData addObject:bathroom];
} 
```