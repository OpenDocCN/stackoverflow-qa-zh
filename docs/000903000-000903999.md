# StackOverflow 问答 000903000-000903999

# asp.net - 如何在 ASP.NET 中设置嵌套面板控件的样式

> ID：903002
> 
> 赞同：0
> 
> 时间：2009-05-24T03:19:45.960
> 
> 标签：asp.net, css, vb.net, panel

我有一个面板位于 div 中，我想将该面板用作容器来添加更多面板！为什么要向面板添加面板？因为我添加到现有面板的面板也包含对象，但仅包含图像和标签。

现有的主容器面板是在设计时创建的，名称为“toolboxpanel”。在运行时，我有一个 for/next 循环，它动态创建图像、标签，将它们都添加到面板中，然后将该面板添加到工具箱面板中，如下所示：

```
For i = 0 To imageholder.Count - 1 'create a control
        insertpanel = New Panel 'these object types have been DIM'd up above
        insertimage = New Image
        inserttext = New Label
        inserttext.ID = "text" + partnumberholder(i) + i.ToString 'the "holder" arrays hold the goodies from my db
        inserttext.Text = brandholder(i) + " " + partnumberholder(i)
        insertimage.ID = "image" + partnumberholder(i) + i.ToString
        insertimage.ImageUrl = ".\Images\Display\" + imageholder(i) + ".jpg"
        insertpanel.CssClass = "drag" 'this allows the panel to be dragged around using a JQuery script elsewhere
        'insertpanel.BackImageUrl = "~\Images\Display\" + imageholder(i) + ".jpg" 'commented out because this method looks awful
        insertpanel.ID = "panel" + partnumberholder(i) + i.ToString

        insertpanel.Controls.Add(insertimage)
        insertpanel.Controls.Add(inserttext)
        toolboxpanel.Controls.Add(insertpanel)
    Next 
```

问题是，我添加到面板的每个面板都被塞进 1 列，完全违反了工具箱面板的 CSS 规则，即最大高度仅为 700 像素。它似乎将面板和它所在的 div 拉伸到比它应该的要高得多！

我的主要问题是：

1) 我如何获得它，以便我可以将面板对象（带有我的图像/标签内容）添加到主面板，使其显示为 3 列、固定的可视高度和整洁的滚动条？

2）有没有更好的方法来做到这一点？必须有:(

您可以在以下主页上看到当前的混乱：[http ://www.mobiuspc.com](http://www.mobiuspc.com)

我很感激任何帮助！账单

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-05-24T06:46:39.130

你需要两件事：

1.  一个[clearfix 样式表](http://www.webtoolkit.info/css-clearfix.html)
2.  浮动你的内部面板

浮动很简单，但起初有时会有点令人生畏。 [阅读这些关于花车的教程](http://css.maxdesign.com.au/floatutorial/)以了解有关它们的所有信息。

本质上，您需要做的就是将以下样式添加到内部面板的样式中：

```
float: left; 
```

浮动将自动使 div 及其所有内容尽可能窄，因此请务必**指定一个 width**，就像您已经拥有的一样。

接下来，您需要将 clearfix 样式应用于外部面板，以便其中的所有浮动内容都不会受到“断头台效应”的影响。因为浮动块没有“布局”，它们不是正常文档流的一部分，因此被它们的父容器忽略。clearfix 通过强制容器将浮动识别为具有布局来解决此问题。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-05-24T03:29:51.150

面板通常（但并非总是）应呈现为 div 标签，ID 会被命名容器破坏，因此更容易添加 cssclass 属性..相应地设置您的 css。

如果您希望溢出允许滚动，您需要设置您的定位和高度以允许滚动。

```
.myContainter {
    position: relative; /* or absolute, or a float */
    height: 700px;
    overflow: auto;
} 
```

应该这样做。:)

# java - 远程截屏和控制

> ID：903005
> 
> 赞同：1
> 
> 时间：2009-05-24T03:27:12.343
> 
> 标签：java

我正在做一个关于“远程屏幕捕获和控制”的项目......在java中它是桌面应用程序......这是客户端 - 服务器架构......这里服务器可以捕获客户端并在客户端上进行操作但是，那就是客户不知道有人在看他/她....

在捕获客户端后，服务器还可以从捕获的数据中控制客户端.....它在客户端完成......自动......由服务器控制......所以我需要你的帮助.. .请给我建议....

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-05-24T03:41:46.010

查看“java.awt.Robot”类：

[http://java.sun.com/javase/6/docs/api/java/awt/Robot.html](http://java.sun.com/javase/6/docs/api/java/awt/Robot.html)

这些方法应该可以帮助您：

```
BufferedImage createScreenCapture(Rectangle screenRect);
void keyPress(int keycode) 
void keyRelease(int keycode) 
void mouseMove(int x, int y) 
void mousePress(int buttons) 
void mouseRelease(int buttons) 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-05-24T09:48:18.293

您在[本文](http://weblogs.java.net/blog/evanx/archive/2007/03/screen_capture_1.html)中了解了使用机器人进行屏幕捕获的基础知识（如 brd6644 的回答所建议的那样）

> 我们可以捕获整个桌面，并将其保存为 PNG 文件，如下所示。

```
public void captureScreen(String fileName) throws Exception {
    Dimension screenSize = Toolkit.getDefaultToolkit().getScreenSize();
    BufferedImage image = new Robot().createScreenCapture(new Rectangle(screenSize));
    ImageIO.write(image, "png", new File(fileName));
} 
```

> 或者，我们可以捕获我们的 JFrame，包括它的窗口装饰，如下所示。

```
public void captureFrame(JFrame frame, String fileName) throws Exception {
    BufferedImage image = new Robot().createScreenCapture(frame.getBounds());
    ImageIO.write(image, "png", new File(fileName));
} 
```

旧的 (2003) [**jxta-remote-desktop**项目](https://jxta-remote-desktop.dev.java.net/)也可以给你一些指点

# language-agnostic - 让客户或经理对软件估算进行现实检查的“正确”方式

> ID：903011
> 
> 赞同：2
> 
> 时间：2009-05-24T03:30:14.147
> 
> 标签：language-agnostic

回顾我过去的项目，我经常遇到这个：

一位客户或经理向我提出了一项任务并要求进行估算。我估计说 24 小时。他们还询问了业务分析师，据我所知，他们的经验大多是非技术性的。他们估计说 16 小时。最后，他们会考虑分析师给出的价值，尽管除了在我方面提供估计之外，我已经向他们解释了技术方面任务的可行性。他们将分析师的估计视为“生活中的事实”，即使它只是一个估计，而真正的价值在于实际任务本身。更糟糕的是，我看到一种模式，即与任务的可行性相比，他们倾向于选择较低的价值（比如我提出的价值估计低于分析师，他们很快就会考虑）。如果你读过 Peopleware，

您是否有以前使用过的特定谈判技巧和策略来避免这种情况？

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2009-05-24T03:39:06.213

如果我能帮上忙，我几乎不会给出像“24 小时”这样的数字。这样做会产生几个隐含的假设：

1.  估计精确到一个小时内。
2.  数字中的所有数字均为**[有效数字](http://en.wikipedia.org/wiki/Significant_figures)**。
3.  估算对您给出估算时间和工作完成时间之间可能出现的条件不敏感。

在大多数情况下，这些显然是错误的。为避免陷入 (1) 的陷阱，请引用范围以反映您对估算准确性的不确定程度：“3 周，正负 3 天”。这也照顾（2）。

要弥补 (3) 的漏洞，请明确说明您的假设：“3 周，加或分 3 天，假设 Alice 和 Bob 完成了 Frozzbozz 组件”。

IMO，以这种方式明确您的假设将显示出比分析师的 POV 更深入的思想。我更愿意关注那些思考得更深入的人，而不是那些刚刚从空中提出一个数字的人，这肯定会为你的谈判加分。

* * *

## 回答 #2

> 赞同：6
> 
> 时间：2009-05-24T03:52:02.357

你没有一个工作分解结构来验证你的估计吗？

如果您的经理/客户不信任您的估计，您应该能够轻松地证明它超出了分析师的能力。

除了表明它是真实的细分之外，没有什么比他的估计更能从本质上使您的估计更好了。例如这样的事情：

```
Gather Feature Requirements      (2 hours)
Design Feature                   (4 hours)
Build Feature
  1 easy form                    (4 hours)
  1 easy business component      (4 hours)
  1 easy stored procedure        (2 hours)
Test Feature
  3 easy unit tests              (4 hours)
  1 regression test              (4 hours)
Deploy Feature
  1 easy deployment              (4 hours)
                                ==========
                                (28 hours) 
```

然后你说“好吧，我想出了 28 小时，告诉我我哪里错了。告诉我你如何在 16 小时内做到这一点。”

* * *

## 回答 #3

> 赞同：4
> 
> 时间：2009-05-24T08:54:56.047

可悲的是，斯科特亚当斯为这场辩论做出了很多贡献

Dilbert：“在理想情况下，该项目需要 8 个月。但根据这家公司过去的项目，我应用了 1.5 的无能乘数。然后我应用了 6.3 的 LWF。” 尖头老大：“LWF？” 爱丽丝：“说谎的鼬鼠因素。”

* * *

## 回答 #4

> 赞同：2
> 
> 时间：2009-05-24T03:44:33.903

您可以比经理更轻松地“控制”客户，因为他们真正拥有的唯一权力就是不将工作交给您（这可以很快解决您的错误估计问题）。

但你只需要指出，做工作的不是分析师，而是*你*。没有人比你更擅长判断你的时代。

为工作付费的人（包括经理）将关注较低的数字，这是一个不争的事实。很多时候，我提交了正确的估算，包括下限（例如，10,000 美元）和上限（例如，11,000 美元），并收到电子邮件回复说客户很高兴我为这项工作报价 10,000 美元。

然后，由于某种原因，当我向他们开出 10,500 美元的账单时，他们会感到不悦。您必须事先明确估计是*估计*，而不是保证。否则，他们不会支付时间和材料，而是支付固定价格（固定价格会高得多，以涵盖风险现在是你的，而不是他们的）。

此外，您应该在您提供的任何报价中包含所有假设和风险。这将涵盖您并证明您的估计比一些粗略的计算要更加认真。

* * *

## 回答 #5

> 赞同：2
> 
> 时间：2009-05-24T04:54:12.173

你可以做的一件事是尝试随着时间的推移解决这个问题，并提高你的估计技能，那就是跟踪你所做的所有估计，并将它们与实际花费的时间相匹配。如果您可以将您和业务分析师的最后 20 个估算值以及每个实际花费的时间列表返回给您的老板，那么您应该信任谁的估算值就很明显了。

* * *

## 回答 #6

> 赞同：1
> 
> 时间：2009-05-25T08:38:08.660

在任何情况下都不要给出一个单一的数字，给出最好的、最差的和最可能的。如果您回答正确，那么下一个问题应该是“我如何获得更准确的数字”，答案应该是更详细的要求和/或设计，具体取决于您在生命周期中所处的位置。

然后你给出另一个更精确的范围最好..最有可能和最坏。这一直持续到您完成为止。

这就是所谓[的不确定锥，](http://www.construx.com/Page.aspx?hid=1648)当我与客户讨论估算时，我已经记不清我在白板上画的次数了。

* * *

## 回答 #7

> 赞同：0
> 
> 时间：2009-05-24T04:02:05.383

*您是否有以前使用过的特定谈判技巧和策略来避免这种情况？*

不要为这样的人工作。

严重地。

改变他们的行为是你无法控制的。

# javascript - 等待延迟加载的对象没有锁定？

> ID：903012
> 
> 赞同：1
> 
> 时间：2009-05-24T03:30:46.110
> 
> 标签：javascript, lazy-loading

我已经有代码可以根据请求延迟加载脚本。我现在的问题是等待执行某些代码，直到对象可用。我不能使用 setTimeout() 因为它不会阻止执行。

那么在不锁定浏览器的情况下“等待”加载的好方法是什么？

同样，不能使用原始 setTimeout()。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2009-05-24T03:41:38.457

假设您控制脚本的内容，您可以在延迟加载脚本的底部放置一些要执行的代码，以向主页指示脚本已加载。例如，在您的页面中，您可以执行以下操作：

```
var loadingScripts = 0;
var loadScript = function() {
    // Do what you need to do to load the script...

    loadingScripts++;
}

var loadedScript = function() {
    loadingScripts--;
    if (loadingScripts == 0) {
        // Kick off execution of code that requires the lazy loaded scripts.
    }
} 
```

然后在您的脚本中，将此代码添加到底部：

```
loadedScript(); 
```

您可以使用数组而不是整数来为这个示例增添趣味（以跟踪已加载的特定脚本）。您也可以使用对象来将特定函数调用与特定脚本的完成相关联。我的例子很简单，但问你是否想让我展示如何扩展代码。

* * *

这是在加载脚本时如何使用回调继续执行特定代码的方法（同样，假设您控制脚本本身）。

```
var scriptCallbacks = {}
var loadScript = function(scriptname, callback) {
    // Do what you need to load scriptname

    scriptCallbacks[scriptname] = callback;
}

var loadedScript = function(scriptname) {
    (scriptCallbacks[scriptname])();
} 
```

然后，当您想加载脚本时，您可以执行以下操作...

```
var callback = function() {
    // Write exactly what you want executed once your script is loaded
}

loadScript("MyScript.js", callback); 
```

同样，在你的延迟加载脚本中，只需将此代码添加到底部以通知你的回调触发：

```
loadedScript("MyScript.js"); 
```

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2009-05-24T04:41:16.917

实际上，我的做法与丹尼尔提到的不同。所有元素在加载后都会触发 load 事件，并在评估内容后加载 Javascript 文件。因此，您可以设置一个事件处理程序以在它们可用后继续执行：

```
var loadScript = function(fileName, callback) {
    var head = document.getElementsByTagName('head')[0];
    var script = document.createElement('script');
    script.type = 'text/javascript';
    script.src = fileName;

    script.onload = callback;
    script.onreadystatechange = function() {
        if(this.readyState == 'complete') {
            callback();
        }
    };
    head.appendChild(script);
}; 
```

以及一个示例用法：

```
var bar = function() {
    Foo.baz();
};
if(!window.Foo) {
    loadScript('Foo.js',bar);
} else {
    bar();
} 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2019-10-31T11:11:17.073

根据 seanmonstar 的回答，我发现这个 async/await 解决方案运行良好。如果之前已经加载了脚本，它会立即解析，或者在下载脚本后稍后异步解析。

```
static async loadScript(url){

    return new Promise( resolve => {

        const element = document.getElementById(url);

        if(element){
            resolve();
        }else{
            const script = document.createElement("script");

            script.id = url;

            script.onload = () => {
                resolve();
            };
            script.src = url;

            document.body.appendChild(script);
        }
    });

} 
```

它是这样使用的：

```
await loadScript("../libs/geopackage/geopackage.js"); 
```

# function - cffunction 访问=

> ID：903037
> 
> 赞同：4
> 
> 时间：2009-05-24T03:55:15.383
> 
> 标签：function, coldfusion, constructor

如果我使用 access="remote" 将 cfselect 绑定到 cfc，那么我将失去拥有 Init() 构造函数的能力。

```
<cfselect name="CityID" bind="cfc:Components.City.View1({StateID})" value="CityID" display="CityName" bindonload="yes" /> 
```

当我实例化一个组件时，我习惯于将数据源名称传递给 Init 函数，如下所示：

```
<cfcomponent>
<cffunction name="Init">
<cfargument name="DS">

<cfset Variables.Instance.DS = arguments.DS>
<cfreturn This>
</cffunction>

<cffunction name="View1">
<cfset var qry = "">

<cfquery name="qry" datasource="#Variables.Instance.DS.Datasource#">
SELECT *
FROM Table
</cfquery>
<cfreturn qry>
</cffunction>
</cfcomponent> 
```

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2009-05-24T12:44:02.450

菲利普，我通常在这种情况下做的是：

1.  在 onApplicationStart 中创建对象，并将其存储到 Application 范围内。这是您将使用数据源其他设置初始化的地方。
2.  创建一个远程代理 CFC，它基本上是真实事物的存根，并将您的选择字段绑定到该 CFC。

onApplicationStart：

```
<cffunction name="onApplicationStart">
  <cfset application.dsn = "myDSN" />
  <cfset application.cityFinder = createObject("component", "Components.City").init(application.dsn) />
</cffunction> 
```

和远程代理 CFC：

```
<cfcomponent displayName="CityFinderProxy">
  <cffunction name="View1">
    <cfargument name="StateId" />
    <cfreturn application.cityFinder.View1(argumentCollection=arguments) />
  </cffunction>
</cfcomponent> 
```

请注意，为简洁起见，我省略了很多最佳实践（即指定参数类型、必需等）...所以不要只是复制和粘贴此示例。我只是想说明这个想法。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2009-05-24T05:29:23.003

究竟是什么问题？

将 CFC 设置为远程基本上是使其成为 Web 服务，所以我想这就是为什么您没有 init() 构造函数的原因。

您可以轻松地在 application.cfc 文件的 onApplicationStart 部分中创建的应用程序/会话变量中设置数据源名称。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2009-05-24T05:52:42.840

您是否有理由不想创建自己的远程初始化函数来调用您无法联系到的函数？

这样做可能会很痛苦……只是值得深思。

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2009-06-01T19:33:12.803

我们所做的：制定了一个软件开发标准，该标准禁止我们内部开发的组件中的任何构造函数代码，除了对 init() 方法的单个（可选）调用。当对象被实例化时，所谓的构造函数代码（cfcomponent 标记内的任何内容，而不是 cffunction 标记内的任何内容）仍将运行，因此在实际调用您的方法之前。

```
<cfcomponent>

  <cfset init() />

  <cffunction name="init">
    <cfset variables.message = "Hello, World" />
    <cfreturn this />
  </cffunction>

  <cffunction name="remoteMethod" access="remote">
    <cfreturn variables.message />
  </cffunction>

</cfcomponent> 
```

# cookies - 跨域“cookie-ing”主站点不是我自己的

> ID：903047
> 
> 赞同：0
> 
> 时间：2009-05-24T04:05:12.653
> 
> 标签：cookies, cross-domain, master

我目前有一个我为“ [http://www.apartmentdata.com/?SITEID=38207](http://www.apartmentdata.com/?SITEID=38207) ”付费的公寓数据库网站，这是搜索过程的开始。我正在制作自己的自定义网站，我希望它具有直接指向公寓的链接，或初始搜索页面之后的任何页面。除非首先打开初始搜索页面，否则这些都不会打开。我注意到一旦打开这个页面，我的电脑上就会有一个特定的 cookie，没有它，其他页面都不会打开。我可以从我的新网站以某种方式使用此 cookie 来解锁所有页面 fpr 客户吗？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-05-24T04:13:05.537

出于相当明显的安全原因，您通常不能为不受您控制的站点设置 cookie。您将有更多的运气联系您的供应商并要求他们允许直接链接到列表。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-05-24T10:05:59.147

尝试制作一个加载搜索页面的小框架。如果失败，请使用弹出窗口加载搜索页面。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-05-24T10:20:43.923

如果直接链接的站点正在检查并查找站点必须的 cookie，除非我完全弄错了，否则它们都在同一个域上？

您知道 cookie 中保存了哪些数据吗？当访问者通过直接链接访问网站时，可能值得设置或尝试设置 cookie。

# language-agnostic - 抽象基类何时可以拥有（非静态）数据成员？

> ID：903054
> 
> 赞同：3
> 
> 时间：2009-05-24T04:11:54.710
> 
> 标签：language-agnostic, oop, abstract-class

我想问题标题总结了它。是否有一段时间认为 ABC 拥有数据成员是好的设计？我一直想知道是否存在这样的情况。我唯一能想到的都是静态的，即使这样也有点牵强。

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2009-05-24T04:20:47.363

我不明白为什么 ABC 不能正确地拥有每个实例（也称为非静态）数据成员，因为需要支持它提供给子类的方法。以 ABC 存在以提供模板方法 DP（钩子方法是抽象的）的常见情况为例——如果组织方法的部分功能是更新一些实例变量（例如，计数多少次方法被调用），那么显然这些变量也应该由 ABC 提供。你能更好地解释为什么你认为这是糟糕的设计吗？！

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-05-24T04:29:22.307

一个抽象类可以有它需要的任何成员来支持它提供给从它继承的类的功能。这并不是说这些子类可以直接访问它们：它们只能通过子类或其客户端进行的方法调用来读取和更改。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-05-24T04:13:29.047

我在插件架构中看到了这一点，比如 Paint.NET。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2009-05-24T04:23:35.583

控制反转可能需要这样做。例如，您有一堆采用 Logger 实例的类，它们所基于的抽象类可能有一个构造函数将其存储在成员变量或私有属性中（当然假设您记得调用基本构造函数*grin*）

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2009-05-24T04:51:53.267

没关系，当您的抽象类中的数据成员包含继承类的基本代码**时**

当数据成员只是为了描述你的类时，我会考虑使用接口

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2009-05-24T05:13:15.160

是的，它可以在抽象基类中提供成员变量，目的是它的子类将使用这些成员来进行具体实现。

这是一个具体的例子，使用我们都喜欢的汽车类比。

假设我们创建`Car`了一个抽象基类，它有轮子、底盘和引擎的占位符，供其子类使用：

```
abstract class Car {
    Wheels wheels
    Chassis chassis
    Engine engine

    abstract void accelerate();
    abstract void decelerate();
} 
```

现在，对于 extends 的类，`Car`成员已经可以使用，因此子类的职责是填充这些成员变量：

```
class NiceCar extends Car {
    Decoration decoration;

    public NiceCar() {
        wheels = new ChromeWheels();
        chassis = new LightweightCompositeChassis();
        engine = new LotsOfHorsepowerEngine();
        decoration = new CoolRacingStripes();
    }

    void accelerate() {
        engine.feedFuel();
    }

    void decelerate() {
        wheels.applyBrakes();
    }
} 
```

可以看出，抽象基类可以作为一个蓝图，应该填写组件（成员变量）以获得类的完整功能。在这种情况下，`Car`提供了在具体实现中使用的汽车的基本部件。`NiceCar`使用这些成员字段并为其自身的功能添加一些字段，例如装饰性油漆作业。

* * *

## 回答 #7

> 赞同：0
> 
> 时间：2009-05-24T05:45:23.807

我怀疑您在抽象基类的概念周围画得太紧了。

抽象基类（与纯接口相反）是一个旨在让子类使用其某些功能的类。因此，它将具有一些功能以及旨在被覆盖的方法（接口部分）。这个功能没有任何理由不应该有与之关联的成员变量。

许多框架都基于继承。这些几乎不可避免地会有带有成员变量的抽象类。例如，DirectShow 是 Windows 中的多媒体流框架。源、编码器、解码器等都在所谓的“过滤器”中实现。各种类型的过滤器都有基类。它们中的每一个都将具有用于上游和下游过滤器、协商的媒体类型等的成员变量。

* * *

## 回答 #8

> 赞同：0
> 
> 时间：2009-05-24T09:50:00.443

如果它是所有继承类都使用的状态，我认为**必须**将其移至基类。即使基础是抽象的。我认为大多数**重构**的人都会同意我的观点。

某些州应该在基地中可能有几个原因。减少代码重复是一个很好的理由。

干杯！

编辑：请告诉我你为什么投反对票，这样我才能改进。谢谢！

* * *

## 回答 #9

> 赞同：0
> 
> 时间：2009-05-24T09:58:57.337

正如其他人所提到的，当需要存储状态时，将实例字段添加到任何类型的类中。这适用于抽象类或具体类——没有区别。

为什么要有所作为？毕竟抽象类就像任何类一样，只是它不能被实例化，需要子类化等来完成这个类。

# vim - 如何在 VIM 中执行基于文件扩展名的操作？

> ID：903057
> 
> 赞同：8
> 
> 时间：2009-05-24T04:16:54.227
> 
> 标签：vim

如果文件扩展名为 .rb，我想在按 F5 时在 VIM 中执行 ruby​​f 操作。现在我只有

```
map <F5> :rubyf % <CR>. 
```

但我也想解释方案文件，如果它的 .scm 或使用相同的 F5 编译 tex 等。如何检查文件扩展名并执行正确的绑定？你们如何在 G/VIM 中编译不同的文件？

* * *

## 回答 #1

> 赞同：13
> 
> 时间：2009-05-24T04:40:08.913

您可以为每个文件扩展名创建不同的 autocmd。例如：

```
au BufEnter,BufNew *.rb map <F5> :rubyf % <CR>. 
```

`:help autocmd`有关 autocmds 的信息，请参阅。

针对您的特定问题的更好方法是映射`<F5>`到始终调用`:make %`，然后使用 autocmd`makeprg`为每种文件类型设置选项（`setlocal`在执行此操作以获得最佳结果时使用）。这不是用于将 ruby​​ 加载到 Vim 中（正如您似乎正在做的那样），而是用于调用外部编译器/解释器/linter。这基本上就是我所做的。这样做的好处是 Vim 可以解释错误和警告并自动跳转到代码中的问题。您还可以调出错误/警告列表。有关`:help quickfix`这方面的信息，以及 、 和 的帮助主题，请`'makeprg'`参见。`:make``:copen``'errorformat'`

对此的一个细微变化是根本不使用 autocmds，而是有一个外部脚本，当给定源文件名时，它会确定要运行的内容（ruby、你的方案编译器、pychecker、你的 C 编译器等等）。然后只需设置`makeprg`为始终运行该脚本。

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2009-05-24T04:51:01.787

使用`filetype`插件。

创建文件`~/.vim/ftplugin/ruby/custom.vim`

在该文件中，仅当当前缓冲区的文件类型为 ruby​​ 时才放置您想要包含的任何命令。他们将得到适当的采购。

如果你想从方案中做同样的事情，创建另一个文件 ~/.vim/ftplugin/scheme/custom.vim`` 并做同样的事情。

每次你在 vim 中加载文件时，它都会检测文件类型，并加载与你的文件类型对应的所有插件。

* * *

## 回答 #3

> 赞同：4
> 
> 时间：2009-05-25T10:55:53.563

自动命令是你的朋友。
定义如下：
`:au[tocmd] [group] {event} {pat} [nested] {cmd}`

在您的情况下， .vimrc 中的以下行将执行您想要的操作。
`autocmd BufRead,BufNewFile *.rb map &lt;F5&gt; :rubyf % &lt;CR&gt;.`

欲了解更多信息，请参阅：
[http ://www.ph.unimelb.edu.au/~ssk/vim/autocmd.html](http://www.ph.unimelb.edu.au/~ssk/vim/autocmd.html)

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2009-05-24T04:27:26.317

[这在这个问题](https://stackoverflow.com/questions/891805/how-do-i-set-up-different-tab-settings-for-different-languages-in-vim/891819#891819)的答案中得到了很好的回答。

# c++ - 编译器错误：使用可能不安全的参数调用函数

> ID：903064
> 
> 赞同：15
> 
> 时间：2009-05-24T04:23:02.340
> 
> 标签：c++, windows, visual-studio-2005, warnings

得到了一些不是我的代码并且它产生了这个警告atm：

```
iehtmlwin.cpp(264) : warning C4996: 'std::basic_string<_Elem,_Traits,_Ax>::copy': Function call with parameters that may be unsafe - this call relies on the caller to check that the passed values are correct. To disable this warning, use -D_SCL_SECURE_NO_WARNINGS. See documentation on how to use Visual C++ 'Checked Iterators'
        with
        [
            _Elem=char,
            _Traits=std::char_traits<char>,
            _Ax=std::allocator<char>
        ]
        c:\program files (x86)\microsoft visual studio 8\vc\include\xstring(1680) : see declaration of 'std::basic_string<_Elem,_Traits,_Ax>::copy'
        with
        [
            _Elem=char,
            _Traits=std::char_traits<char>,
            _Ax=std::allocator<char>
        ] 
```

这是有问题的代码：

```
HRESULT STDMETHODCALLTYPE Read(void __RPC_FAR *pv, ULONG cb, ULONG __RPC_FAR *pcbRead)
    {
        if (prepend.size() > 0)
        {
            int n = min(prepend.size(), cb);
            prepend.copy((char *) pv, n);
            prepend = prepend.substr(n);
            if (pcbRead)
                *pcbRead = n;

            return S_OK;
        };

        int rc = Read((char *) pv, cb);
        if (pcbRead)
            *pcbRead = rc;

        return S_OK;
    }; 
```

警告指的是 prepend.copy 行。我试过用谷歌搜索警告，但无法弄清楚它是关于什么的。有人可以帮我解决这个问题吗？

视觉工作室 2005 SP1 Windows 7 RC1

.

编辑： prepend 是一个类型定义的字符串

```
typedef basic_string<char, char_traits<char>, allocator<char> > string; 
```

* * *

## 回答 #1

> 赞同：13
> 
> 时间：2009-05-24T04:31:59.843

警告告诉您，如果`n`太大，您将面临缓冲区溢出的风险——您知道这不会发生，因为您刚刚使用 a 计算的方式`min`，但糟糕的编译器不会。我建议你接受编译器自己的建议，并`use -D_SCL_SECURE_NO_WARNINGS`为这个源文件...

* * *

## 回答 #2

> 赞同：8
> 
> 时间：2009-05-24T04:30:32.620

查看此 MSDN 页面以获取有关警告的文档

*   [http://msdn.microsoft.com/en-us/library/ttcz0bys.aspx](http://msdn.microsoft.com/en-us/library/ttcz0bys.aspx)

MS C++ 编译器决定弃用 std::string::copy 方法，因为它使用起来可能不安全并且可能导致缓冲区溢出。此弃用是 Microsoft 特定的，您可能不会在其他编译器平台上看到它。

# ruby-on-rails - 为什么在 Ruby on Rails 上，http://localhost:3000/stories/newnew 会查找记录 id=newnew？

> ID：903067
> 
> 赞同：-1
> 
> 时间：2009-05-24T04:23:44.773
> 
> 标签：ruby-on-rails

使用 Ruby on Rails 2.3.2，因为我已经为 Story 创建了 Scaffold，所以我没有尝试和创建一个名为“new”的新操作（脚手架中已经存在“new”），而是在控制器文件中使用了“newnew”并且在视图文件中，希望

> [http://localhost:3000/stories/newnew](http://localhost:3000/stories/newnew)

将是另一种创建新记录的方式。但事实证明，RoR 会将“newnew”视为记录 id 而不是操作，据报道：

> 找不到 ID=newnew 的故事

有没有办法让newnew也作为一种行动？

route.rb 有

```
map.resources :stories

map.connect ':controller/:action/:id'
map.connect ':controller/:action/:id.:format' 
```

它是 Rails 2.3.2

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-05-24T04:27:29.560

问题的根源可能在您的 routes.rb 中，您可以将其内容发布到您的问题中吗？

根据 Rails 的版本以及您是否使用 RESTful 资源，行为会有所不同。无论哪种方式，routes.rb 都应该有答案。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2009-05-25T11:45:23.433

```
map.resources :stories, :collection => {:newnew => :get} 
```

... 将`newnew`映射添加到故事集合中。这将知道这`/stories/newnew`并不意味着引用故事的实例。

从[这里](http://api.rubyonrails.org/classes/ActionController/Resources.html#M000501)。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-05-24T04:26:43.167

默认操作是列出带有类似 URL 的内容。你可以在你的故事控制器中实现 newnew，但是为什么呢？

# macos - 如何在 MacOS 中杀死进程？

> ID：903076
> 
> 赞同：89
> 
> 时间：2009-05-24T04:32:20.433
> 
> 标签：macos

我试过`kill -9 698`了，但过程没有死。

```
$ ps -ef | grep chromium
  502   698   811   0   0:01.24 ??         0:07.28 /Users/lucius/chromium/src/xcodebuild/Debug/Chromium.app/Contents/MacOS/Chromium
  502   854   732   0   0:00.00 ttys001    0:00.00 grep chromium
$ kill -9 698

$ ps -ef | grep chromium
  502   698   811   0   0:01.24 ??         0:07.28 /Users/lucius/chromium/src/xcodebuild/Debug/Chromium.app/Contents/MacOS/Chromium
  502   854   732   0   0:00.00 ttys001    0:00.00 grep chromium 
```

* * *

## 回答 #1

> 赞同：146
> 
> 时间：2009-05-24T04:38:40.430

如果你试图杀死 -9 它，你有正确的 PID，并且没有任何反应，那么你没有权限杀死该进程。

**解决方案：**

```
$ sudo kill -9 PID 
```

* * *

好的，Mac OS/X 确实针对这种情况给出了错误消息：

```
$ kill -9 196
-bash: kill: (196) - Operation not permitted 
```

因此，如果您没有收到错误消息，那么您不知何故没有获得正确的 PID。

* * *

## 回答 #2

> 赞同：20
> 
> 时间：2016-04-28T14:35:40.597

在某些情况下，您可能希望终止在特定端口中运行的所有进程。例如，如果我在 3000 端口上运行一个节点应用程序，我想杀死它并启动一个新的；然后我发现这个命令很有用。

找到在 TCP 端口 3000 上运行的进程 ID 并杀死它

```
kill -9 `lsof -i TCP:3000 | awk '/LISTEN/{print $2}'` 
```

* * *

## 回答 #3

> 赞同：6
> 
> 时间：2009-05-24T04:35:57.860

如果您知道可以使用的进程名称：

```
killall Dock 
```

如果你不这样做，你可以打开活动监视器并找到它。

* * *

## 回答 #4

> 赞同：4
> 
> 时间：2014-08-27T02:58:47.253

我刚刚搜索了这个，因为我处于类似的情况，而不是`kill -9 698`我尝试`sudo kill 428`428 是我试图杀死的进程的 pid 。在没有连字符“-”字符的情况下，它对我来说很干净。我希望它有帮助！

* * *

## 回答 #5

> 赞同：3
> 
> 时间：2009-05-24T04:40:12.923

如果`kill -9`不起作用，那么也不会`killall`（或者甚至`killall -9`会更“强烈”）。显然，铬进程被困在一个不可中断的系统调用中（即，在内核中，而不是在用户空间中）——不认为 MacOSX 有任何剩下的，但我想总会有一个:-(。如果那样的话进程有一个控制终端，您可能可以在后台运行它并在后台运行时将其杀死；否则（或者如果即使进程停止运行，强烈的杀戮也不起作用）我没有想法，我想您可能需要重新启动:-(。

* * *

## 回答 #6

> 赞同：3
> 
> 时间：2009-05-24T16:42:53.617

给定程序的路径，我假设您当前正在 Xcode 下运行它，并且可能处于调试断点处。由于断点的底层实现，进程不能在这种状态下被杀死。

第一步是转到您的 Xcode 进程并停止调试。如果由于某种奇怪的原因您无法访问 Xcode（也许 Xcode 无法访问其 gdb 子进程），那么解决方案是终止 gdb 进程。更一般地说，这里的解决方案是杀死父进程。在您的情况下，这是 PID 811（第三列）。

在这种情况下不需要使用 -9。

* * *

## 回答 #7

> 赞同：2
> 
> 时间：2013-05-08T22:31:48.937

我经历过，如果`kill -9 PID`不起作用并且您拥有该过程，您可以使用`kill -s kill PID`这有点令人惊讶，因为手册页说您可以`kill -signal_number PID`。

* * *

## 回答 #8

> 赞同：0
> 
> 时间：2019-05-02T02:21:30.290

我最近遇到了类似的问题，原子编辑器不会关闭。两人都没有回应。Kill / kill -9 / 强制退出活动监视器 - 不起作用。最后不得不重新启动我的mac来关闭应用程序。

* * *

## 回答 #9

> 赞同：0
> 
> 时间：2020-01-03T03:13:38.580

在聚光灯下，搜索活动监视器。您可以从此处强制完全删除任何应用程序。

[![在此处输入图像描述](https://i.stack.imgur.com/BI2ig.png)](https://i.stack.imgur.com/BI2ig.png)

* * *

## 回答 #10

> 赞同：0
> 
> 时间：2022-01-11T13:11:04.207

您是否可以使用带有命令的端口列出进程`lsof`，例如：

```
lsof -i tcp:PORT_NUMBER_HERE 
```

将单词替换为`PORT_NUMBER_HERE`您正在使用的端口号，然后将列出在该端口上运行的进程。然后你只需要杀死这样创建的进程 ID：

```
kill PID_NUMBER 
```

`PID_NUMBER`端口上运行的进程 ID 在哪里。

# actionscript-3 - 如何在 Adob e AIR 中获取文件的全名？

> ID：903080
> 
> 赞同：0
> 
> 时间：2009-05-24T04:37:06.920
> 
> 标签：actionscript-3, adobe, air, flash-cs3

我正在使用类似的东西来浏览 AIR 中的文件。我可以得到文件名，但我需要的是文件的全名。有没有办法做到这一点？

```
var file:FileReference = new FileReference(); 
file.addEventListener(Event.SELECT, selectHandler); 
file.browse();

private function selectHandler(e:Event):void{ 
file.removeEventListener(Event.SELECT, selectHandler); 
var name = file.name; 
} 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-05-24T05:12:18.907

我不确定是否`FileReference`可以为您提供所选文件的绝对路径。所以我建议你使用而不是`nativePath`的属性。`File``FileReference`

```
var file:File = File.userDirectory;
file.addEventListener(Event.SELECT, selectHandler);
file.browse();

private function selectHandler(e:Event):void{
file.removeEventListener(Event.SELECT, selectHandler);
var filePath:String= file.nativePath;
} 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-05-24T04:51:18.587

您在使用 Flex Builder 吗？我会在处理程序中休息一下，看看有什么可用的。“名称”属性适用于获取磁盘上的文件名，所以我不知道你的情况是什么问题。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-05-24T04:54:42.517

我不是航空专家，但是 file.nativePath 怎么样？

# javascript - 使用 file:// 在网页中打开本地文件

> ID：903082
> 
> 赞同：2
> 
> 时间：2009-05-24T04:37:44.970
> 
> 标签：javascript, internet-explorer

我有一个用户填写的表单（jsp 页面）。输入之一是“文件”类型。有一个预览按钮，它将弹出一个新窗口并使用 javascript 来布局已填写的表单以进行显示。“文件”输入将显示为超链接，当用户单击超链接时，它应该打开附件。所以如果你附上了pdf，我希望当我点击超链接时，福昕阅读器会打开。如果是文本文件，记事本会打开。

我尝试使用`file://`，但似乎什么也没发生。它似乎是 MSIE 中的一项安全功能，其中`file://`协议被锁定。

如果没有（ActiveX，ajax），您将如何实现此功能？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2009-05-24T04:52:32.970

`file://`仅指向用户计算机上的本地文件系统，并且通常会受到更多锁定的安全措施。它根本不能依赖浏览器甚至允许`file://`协议访问。

安全地做你想做的事情的唯一方法是完全提交带有文件的表单并使用服务器端语言（PHP、ASP.NET、Rails、Django，任你选择）呈现具有“漂亮”布局的页面表单数据以及文档预览。论坛就是这样做的，你点击“预览”按钮，你的帖子被提交到服务器，服务器呈现它供你批准，你批准它，它被保存到数据库并发布。如果您不批准它，它将被丢弃并且永远不会进入数据库。

如果您不希望用户离开页面，您可以将其滚动到您的验证中并执行 AJAX 回发。有 javascript 库专门用于像这样静默地序列化和传输表单，然后返回结果。 [JQuery Forms](http://malsup.com/jquery/form/)就是一个很好的例子（注意：需要[JQuery](http://www.jquery.com)）。

# javascript - .droppable 似乎没有触发任何东西？jQuery + ASP

> ID：903084
> 
> 赞同：1
> 
> 时间：2009-05-24T04:39:39.087
> 
> 标签：javascript, jquery, asp.net, drag-and-drop

在 stackoverflow 社区的帮助下，我可以使用 JQuery 完美地进行拖动。现在，我已经分配了一个 .drop 类（并使其成为 .droppable），但是每当我将 .draggable 放到 .droppable 上时……什么都没有发生！javascript中有错误吗？

```
<script type="text/javascript">  
  $(document).ready(function() {  
doReady();  

var prm = Sys.WebForms.PageRequestManager.getInstance();  
prm.add_endRequest(function(s, e) {  
    doReady();  
});  
});  

function doReady() {
$('.drag').draggable({ revert: true,helper: 'clone' });}
$('.drop').droppable({ 
tolerance: touch,
drop: function() { alert('dropped'); }
});
</script> 
```

脚本的顶部允许拖放功能在部分回发后继续工作。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2009-05-24T07:31:54.497

这里应该是一个字符串

```
tolerance: "touch", 
```

我格式化你的代码

```
 $(document).ready(function() {  

     doReady();  

     var prm = Sys.WebForms.PageRequestManager.getInstance();  
     prm.add_endRequest(function(s, e) {  
         doReady();  
     });  

  }); // End of document ready

  function doReady() {

    $('.drag').draggable({ revert: true,helper: 'clone' });

  } // End of do ready

  $('.drop').droppable({ 
     tolerance: "touch", // Here should be a string
     drop: function() { alert('dropped'); }
  }); 
```

你能看到 $('.drop') 不在 doReady 函数中。

固定的。

```
function doReady() {

   $('.drag').draggable({ revert: true,helper: 'clone' });
   $('.drop').droppable({ 
      tolerance: "touch", // Here should be a string
      drop: function() { alert('dropped'); }
   });

 } // End of do ready 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-05-24T04:46:29.123

您是否错过了 doReady() 函数末尾的 } ？

# algorithm - 查找集合中的下一个最小和最大数字的快速算法

> ID：903091
> 
> 赞同：3
> 
> 时间：2009-05-24T04:47:58.000
> 
> 标签：algorithm, language-agnostic, datetime, hash, dataset

我有一组正数。给定一个不在集合中的数字，我想找到集合中的下一个最小和下一个最大*的*数字。我现在能想到的唯一方法是通过减少 1 来找到下一个最小的，直到我在集合中找到一个数字，然后做同样的事情来找到下一个最大的。

动机：我在哈希图中有一堆数据，按日期键入。我没有每个日期的数据点。如果我有数据，例如 10/01/2000 为 60，10/05/2000 为 68，并且我要求 10/02/2000，我想进行线性插值。我应该得到62。

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2009-05-24T04:58:54.647

这取决于您的集合是否已排序。

如果你的集合是未排序的，那么找到最接近的（更高和更低）是一个 O(n) 操作和一个相当简单的算法。

如果您的集合已排序，那么您可以使用修改后的二分搜索在 O(log n) 中找到答案，这显然要好得多，尤其是在较大的集合上。

如果您重复执行此操作，则可能值得对集合进行排序，这会产生 O(n log n) 成本，该成本可能一次关闭或不关闭，具体取决于集合更改的频率。随着新项目的添加，某种树排序可能有助于改进未来的排序。

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2009-05-24T04:56:58.473

所有这一切都归结为[二分搜索](http://en.wikipedia.org/wiki/Binary_search)，前提是您可以对数据进行排序。有两种选择。

1.  **分类容器**
    如果您将号码保存在分类容器中，这很容易。而不是使用 HashMap，将数据放在 a 中[`TreeMap`](http://java.sun.com/javase/6/docs/api/java/util/TreeMap.html)，然后您可以有效地找到下一个较低或下一个较高的元素。Java 甚至有方法来做你想做的事：

    *   [`higherKey(K)`](http://java.sun.com/javase/6/docs/api/java/util/TreeMap.html#higherKey(K))
    *   [`lowerKey(K)`](http://java.sun.com/javase/6/docs/api/java/util/TreeMap.html#lowerKey(K))

    这是有效的，因为在内部`TreeMap`使用了[红黑树](http://en.wikipedia.org/wiki/Red-black_tree)（一种[平衡二叉搜索树](http://en.wikipedia.org/wiki/Self-balancing_binary_search_tree)）。 `higherKey`并`lowerKey`简单地从根开始并遍历树以找到您的元素应该去的地方。

    我不确定你使用的是什么语言，但在 C++ 中你会使用[`std::map`](http://www.sgi.com/tech/stl/Map.html)，类似的方法是：

    *   `iterator lower_bound(const key_type& k)`
    *   `iterator upper_bound(const key_type& k)`
2.  **数组 + 排序**
    如果您不想一直保持数据排序，您可以随时将数据转储到数组（或任何随机访问容器）中，使用[`sort`](http://www.sgi.com/tech/stl/sort.html)，然后在数组上使用 STL 的二进制搜索例程：

    *   [`lower_bound`](http://www.sgi.com/tech/stl/lower_bound.html)
    *   [`upper_bound`](http://www.sgi.com/tech/stl/upper_bound.html)

    在 Java 中，类似的是将东西转储到 中[`ArrayList`](http://java.sun.com/j2se/1.4.2/docs/api/java/util/ArrayList.html)，调用 Java 的[`sort()`](http://java.sun.com/j2se/1.4.2/docs/api/java/util/Collections.html#sort(java.util.List,%20java.util.Comparator))，然后使用[binarySearch()](http://java.sun.com/j2se/1.4.2/docs/api/java/util/Collections.html#binarySearch(java.util.List,%20java.lang.Object,%20java.util.Comparator))。

这里所有的搜索例程都是**O(logn)**时间。使用排序容器或数组保持数据排序的成本是**O(nlogn) 。**使用排序容器，成本分摊到**n**次插入；使用数组，您可以在调用时一次性支付所有费用`sort()`。

如果你根本不想排序，你总是可以使用[线性搜索](http://en.wikipedia.org/wiki/Linear_search)，但如果你经常使用它，你会付出代价，因为它是一个**O(n)**算法。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2009-05-24T04:50:57.123

将数据项放入树中，例如[AVL](http://en.wikipedia.org/wiki/AVL_tree)树、[红黑树](http://en.wikipedia.org/wiki/Red-black_tree)或 B+/B- 树。然后您可以搜索有序值。

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2009-05-24T04:53:05.793

对数字进行排序，然后对每个键执行二进制搜索以平分集合。然后，您可以找到丢失的钥匙两侧的数字。

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2009-05-24T04:55:10.190

将集合转换为列表并对其进行排序，然后对不在集合中的数字运行二进制搜索。结果将是插入点，即如果数字在那里，数字将出现的位置。如果调用它`n`，则`n`排序列表索引处的元素是下一个最小数字，`n+1`排序列表索引处的元素是下一个最大数字。

您也可以通过在构造它时保持集合的排序顺序来做到这一点，然后搜索插入点就变得很容易了。这种方法被Java 的[floorEntry()](http://java.sun.com/javase/6/docs/api/java/util/TreeMap.html#floorEntry%28K%29)和[ceilingEntry()](http://java.sun.com/javase/6/docs/api/java/util/TreeMap.html#ceilingEntry%28K%29)`TreeMap`方法使用。

* * *

## 回答 #6

> 赞同：1
> 
> 时间：2009-05-24T04:55:48.053

将您的集合保留为排序列表/数组并执行二分搜索：例如，在 Python 中，`bisect`标准 Python 库中的排序列表和模块完全符合您的需求。

* * *

## 回答 #7

> 赞同：0
> 
> 时间：2009-05-24T04:52:11.350

如果获取数组中的键，则可以对数组进行排序并找到小于所需元素的最后一个元素的索引。然后你就知道你想要的点之前的键的索引，之后的下一个元素就是紧接着的那个。

这应该给你足够的插值。

（使用的数据结构不必是数组，任何可以排序的东西都可以。平衡二叉树，正如其他人所建议的，将是理想的，特别是如果您打算稍后重用数据）。

* * *

## 回答 #8

> 赞同：0
> 
> 时间：2009-05-24T05:02:15.330

在未排序的集合中找到第 n 个元素是 O(n)。（[选择算法](http://en.wikipedia.org/wiki/Selection_algorithm)）虽然在这里你可以把它归结为一个更简单、不太通用的算法，如果你总是想要最小和次小的元素。*但一般来说，在未排序的列表*中找到最小的、第二小的等元素是 O(n)。（你应该在你的算法课上学过这个......）

排序一个集合，然后索引元素是 O(n log n)

在有序集合中查找元素是 O(log n)（二分查找）

* * *

## 回答 #9

> 赞同：0
> 
> 时间：2009-05-24T10:08:31.123

如果您知道每周都会有一个数据点，那么请保持`HashMap`原样并按照您的建议进行操作...这将是一个恒定的时间操作，因为您将进行 14 次哈希表查找（探测搜索日期两边各 7 天），每个都采用**O(1)**原始操作。

如果您不知道数据的密集程度并且可以将其保存在 RAM 中，那么请按照许多其他人的建议将其放入平衡的树结构中。但是，如果您有很多日期并且必须通过网络从数据库加载数据，这可能会很昂贵。

# c - 为什么 NSError 需要双重间接？（指向指针的指针）

> ID：903103
> 
> 赞同：46
> 
> 时间：2009-05-24T04:53:33.670
> 
> 标签：c, objective-c, cocoa, pointers

这个概念似乎困扰着我。为什么 NSError 对象需要将其指针传递给正在修改对象的方法？例如，不只是传递对错误的引用会做同样的事情吗？

```
NSError *anError;
[myObjc doStuff:withAnotherObj error:error]; 
```

然后在doStuff中：

```
 - (void)doStuff:(id)withAnotherObjc error:(NSError *)error 
 {
    // something went bad!
    [error doSomethingToTheObject];
 } 
```

为什么上述工作不像大多数其他对象消息传递模式那样工作？为什么我们必须使用error:(NSError **)error？

* * *

## 回答 #1

> 赞同：96
> 
> 时间：2009-05-24T06:02:09.890

很简单：

如果将指向对象的指针传递给函数，则函数只能修改指针指向的内容。

如果您将指针传递给指向对象的指针，则该函数可以修改指针以指向另一个对象。

在 NSError 的情况下，该函数可能想要创建一个新的 NSError 对象并将一个指向该 NSError 对象的指针传回给你。因此，您需要双重间接，以便可以修改指针。

* * *

## 回答 #2

> 赞同：79
> 
> 时间：2009-05-24T05:07:25.980

`NSError**`当方法通常返回某个值但`NSError*`如果失败时可能需要返回错误对象（类型为 ）时，使用该模式。在 Objective-C 中，一个方法只能返回一种类型的对象，但这是您想要返回两种的情况。在类 C 语言中，当您需要返回一个额外的值时，您需要一个指向该类型值的指针，因此要返回一个`NSError*`您需要一个`NSError**`参数。一个更现实的例子是：

```
// The method should return something, because otherwise it could just return
// NSError* directly and the error argument wouldn't be necessary
- (NSArray *)doStuffWithObject:(id)obj error:(NSError **)error
{
  NSArray *result = ...;  // Do some work that might fail
  if (result != nil) {
    return result;
  } else {
    // Something went bad!
    // The caller might pass NULL for `error` if they don't care about
    // the result, so check for NULL before dereferencing it
    if (error != NULL) {
      *error = [NSError errorWithDomain:...];
    }
    return nil;  // The caller knows to check error if I return nil
  }
} 
```

如果您只有一个`NSError*`参数而不是一个`NSError**`then`doStuff`将永远无法将错误对象传递回其调用者。

* * *

## 回答 #3

> 赞同：11
> 
> 时间：2014-01-28T06:16:13.160

一个老问题，但我仍然认为值得把它放在这里 -

真正的罪魁祸首是[NSError](https://developer.apple.com/library/mac/documentation/Cocoa/Reference/Foundation/Classes/NSError_Class/Reference/Reference.html)。如果您查看它的类引用，就会发现它的任何属性（即域、代码或用户信息）都没有设置方法。所以没有办法，你可以只分配和初始化一个 NSError，将它传递给方法，然后在传递的 NSError 对象上填充信息。（如果有一个 setter 方法，我们可以只传递一个 NSError * 并在方法中执行类似 error.code = 1 的操作。）

因此，如果出现错误，您必须在方法中生成一个新的 NSError 对象，如果这样做，将其传递回调用者的唯一方法是使用 NSError ** 参数。（出于上述答案中解释的原因。）

* * *

## 回答 #4

> 赞同：7
> 
> 时间：2009-05-24T05:52:28.847

n8gray 所说的替代声明：

因为您没有收到要向其发送消息的对象；您正在创建对象并返回它。您通常需要指向变量的指针`NSError *`参数，因为您一次只能`return`对一件事使用该语句，并且您已经将它与`NO`.

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2016-08-12T06:35:38.577

通过阅读上面的所有答案，我仍然没有得到全貌。我在下面做的外行练习，终于帮助我理解了正在发生的事情。只是把它放在那里以防它帮助其他初学者。

假设您有以下

```
@interface Class X
-(void) methodX:(NSMutableArray *)array;
@end 
```

在代码的其他部分中，您具有以下序列

```
ClassX *objectX = [[ClassX alloc] init];
NSMutableArray *arrayXX = [@[@(1), @(2)] mutableCopy]; 
//What is stored in arrayXX is the address in the heap at which the NSMutableArray object starts, lets call this address ZZZ
//array starting at address ZZZ in the heap now contains NSNUmbers @1,@2
[objectX methodX:array] 
```

当您调用`[objectX methodX:array]`时，该方法收到*的*是`array`. 由于数组包含一个地址（即是一个指针），因此*副本*的特殊之处在于接收的是另一个带有地址 ZZZ 的变量。

因此，如果 methodX 这样做`[array removeObjectAtIndex:0]`了，那么从地址 ZZZ 开始的对象就会受到影响（现在只包含一个 NSNUmber @(2)）。因此，当方法返回时，原始数组也会受到影响。

假设相反，methodX 不会`array = [@[@(2)] mutableCopy];`影响原始数组。这是因为您没有进入地址 ZZZ 并进行更改。*相反，您将方法接收到的副本*中的 ZZZ 覆盖到不同的地址 YYY。YYY 地址是一个 NSMUtableArray 对象的开始，它具有一个元素 NSNUmber @(2)。原来的 ZZZ 地址仍然包含一个带有两个元素的 NSMUtableArray。@(1) 和@(2)。因此，当方法返回时，原始数组不受影响。

# javascript - 如何在网页中嵌入投票

> ID：903104
> 
> 赞同：1
> 
> 时间：2009-05-24T04:53:43.453
> 
> 标签：javascript, python, cross-domain

我想创建一个简单的在线投票应用程序。我在 python 中创建了一个后端来处理投票跟踪、投票显示、结果显示和管理设置。但是，如果我希望第三方能够将民意调查嵌入他们的网站，那么推荐的做法是什么？我希望能够提供一些 javascript 来放入第三方网页，但我不能使用 javascript，因为它需要跨域访问。什么方法可以为第三方提供简单的通用解决方案？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-05-24T04:57:23.883

将您的应用程序变成 Google 小工具、Open Social 小工具或其他类型的小工具——这些都旨在尽可能轻松地嵌入到第三方页面中。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-05-24T05:17:18.773

如果您想允许回发，IFrame 是最简单的无忧无虑的解决方案。

或者，这有点左派和老派，但您可以使用 1x1 透明 gif 作为您的投票提交吗？他们单击链接（收音机/跨度/其他），您将图像的 src 设置为服务器上的内容。就像是

```
document.getElementById('voteImage').src='http://your.server/vote.html?pollidentifier=123&vote=4' 
```

其中 vote.html 是处理投票的服务器端代码，投票标识符是告诉投票是什么投票的方式，投票是他们选择的投票。所有 vote.html 所要做的就是返回一些闻起来像图像的东西，浏览器就会很高兴。显然，您需要准备好*一些东西*来阻止人们伪造选票，但是在新的方方正正的 xhr 出现之前，旧计时器曾经使用过图像 + cookie。

# java - 在 Java HashMap 中保留一对原语

> ID：903107
> 
> 赞同：6
> 
> 时间：2009-05-24T04:54:53.187
> 
> 标签：java, hashmap, primitive, keyvaluepair

我有一个文件列表。我想扫描并计算相同大小的文件数量。问题在于文件大小很长，正如我们所知，hashmap 将只接收一个对象而不是一个原语。所以使用`new Long(filesize)`，我将其放入哈希图中。由于每个 Long obj 都是唯一的，我没有得到一对 (filesize, count)，而是得到了 (filesize, 1) 的列表。

我该如何构建这个蓄能器？

1.4.2的任何解决方案？

* * *

## 回答 #1

> 赞同：15
> 
> 时间：2009-05-24T05:03:52.147

您只需这样做：

```
Map<Long, Integer> count = new HashMap<Long, Integer>();
for (File file : files) {
  long size = file.getTotalSpace();
  Integer n = count.get(size);
  if (n == null) {
    count.put(size, 1);
  } else {
    count.put(size, n + 1);
  }
} 
```

这里有一些[自动装箱](http://java.sun.com/j2se/1.5.0/docs/guide/language/autoboxing.html)和拆箱。

* * *

## 回答 #2

> 赞同：6
> 
> 时间：2009-05-24T09:02:23.690

而不是使用`new Long(size)`，你应该使用`Long.valueOf(size)`。这将返回内部缓存的相同 Long 引用，并且还应该提高性能（除非您执行数百万次这样的操作，否则它将不可见`new Long()`）。

附言。仅适用于 java 1.5 或更高版本

* * *

## 回答 #3

> 赞同：4
> 
> 时间：2009-05-25T00:30:34.010

您可以使用[Trove](http://trove4j.sourceforge.net/)存储对 (long,int) - [TLongIntHashMap](http://trove4j.sourceforge.net/javadocs/index.html?gnu/trove/TLongIntHashMap.html)

* * *

## 回答 #4

> 赞同：3
> 
> 时间：2009-05-24T08:59:20.297

或者您可以使用 AtomicInteger 作为可变整数。

```
Map<Long, AtomicInteger> count = new HashMap<Long, AtomicInteger>();
for (File file : files) {
  long size = file.length(); // getTotalSpace() get the space consumed (e.g. a multiple of 8K) rather the actual file size.
  AtomicInteger n = count.get(size);
  if (n == null) {
    count.put(size, new AtomicInteger(1));
  } else {
    n.getAndIncrement();
  }
} 
```

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2009-05-24T09:08:13.930

扩展 cletus 写的内容。

他的解决方案很好，除了它只存储您遇到的每个文件大小以及具有此大小的文件的数量。如果您想知道哪些文件是这种数据结构，那么这些文件对您来说毫无用处，所以我认为 cletus 解决方案不是很完整。相反，我会做

```
Map<Long, Collection<File>> count = new HashMap<Long, Collection<File>>();
for (File file : files) {
long size = file.getTotalSpace();
Collection<File> c = count.get(size);
if (c == null) {
    c = new ArrayList<File>(); //or whatever collection you feel comfortable with
    count.put(size, c);
}
    c.add(file);
} 
```

然后您可以使用 c.size() 获取文件的数量，并且您可以轻松地遍历具有该数量的所有文件，而无需再次运行此过程。

* * *

## 回答 #6

> 赞同：1
> 
> 时间：2009-05-24T10:11:21.557

我认为还有更多内容，我们需要您提供更多详细信息。我假设您知道给定大小的文件肯定不止一个，否则我会先检查一下是否是这种情况。就您所知，您只是拥有许多具有独特文件大小的文件。

你提到：

> ...因为每个 Long 对象都是独一无二的。

我不认为这是问题所在。虽然这可能取决于您如何实例化 Long，但它不应该阻止 HashMaps 以您想要的方式运行。只要两个键对象返回相同的 hashCode() 值，并且 equals() 方法说它们相等，你的 HashMap 就不会为它创建另一个条目。实际上，您应该不可能看到具有相同文件大小值的“(filesize, 1) 列表”（除非您编写了自己的 Long 并且未能正确实现 hashCode()/equals()）。

也就是说，如果您使用的是 Java 5 或更高版本，Cletus 的代码应该可以工作，如果您使用的是 Java 1.4 或更低版本，您需要手动进行自己的装箱/拆箱，或者查看[Apache Commons Collections](http://commons.apache.org/collections/)。这是 Cletus 示例的 Java 5 之前的版本：

```
Map count = new HashMap();
for (Iterator filesIter = files.iterator(); filesIter.hasNext();) {
  File file = (File)filesIter.next();
  long size = file.getTotalSpace();
  Integer n = count.get(size);
  if (n == null) {
    count.put(size, Integer.valueOf(1));
  } else {
    count.put(size, Integer.valueOf(n.intValue() + 1));
  }
} 
```

# c# - WebService 可以并行工作还是只能列式工作？

> ID：903113
> 
> 赞同：0
> 
> 时间：2009-05-24T04:58:01.933
> 
> 标签：c#, web-services

来自多个客户端对 web 服务的调用是并行执行还是一个接一个执行（即只有在第一次调用完成后才考虑第二次调用）？

提前致谢。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-05-24T05:43:56.773

对 Web 服务的调用本质上是对服务器上网页的调用。服务器通常维护一个线程池，从中检索线程以服务传入调用。因此，如果多台计算机同时调用同一个 Web 服务方法，只要线程池中有可用的线程，它们就会并行执行。如果所有线程都已经很忙，方法调用将开始被搁置（服务器甚至可能报告它太忙而无法处理请求）。5台电脑应该不会有问题。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-05-24T05:10:10.093

Web 服务可以响应请求。因此，您需要做的是拥有一个所有 5 台计算机都调用的函数，以从每台计算机提交您需要的数据。然后，创建每台计算机调用的函数以检查响应是否准备好。一旦收集了来自每台计算机的数据，Web 服务就会以正确的数据进行响应。

Web 服务响应必须由客户端而不是服务器发起。

例如，

1.  `SubmitData(data)`返回 bool -> 每台计算机提交数据，成功与否返回。服务器将响应存储在数据库中。
2.  `GetResponse()`返回数据或 FALSE -> 服务器检查是否所有 5 台计算机都已响应。如果不是，则返回 FALSE。如果为真，则处理并返回数据。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-05-24T05:30:28.117

几乎所有的 Web 服务框架都支持异步。如果您使用的是 C#，那么您可能会从以下文章中受益：

[http://www.codeguru.com/csharp/csharp/cs_webservices/security/article.php/c9179](http://www.codeguru.com/csharp/csharp/cs_webservices/security/article.php/c9179)

# iphone - 在按住的情况下使 UIButton 连续触发的方法？

> ID：903114
> 
> 赞同：19
> 
> 时间：2009-05-24T04:58:04.243
> 
> 标签：iphone, cocoa-touch, uibutton, multi-touch

你知道当你按住方向键上的右键时马里奥是如何一直向右跑的吗？以同样的方式，我希望我的 UIButton 在它被按住的时间内持续触发它的动作。这对 UIButton 可行吗？如果不是，这是否可以通过以某种方式覆盖触摸处理方法来处理 UIImageView ？实际上，在尝试使用 UIButton 完成此操作之前，我有一些 UIImageViews（被安排用作 D-Pad），它们通过触摸处理方法进行检查，但事情开始变得混乱，所以我认为使用 UIButton 可以更轻松地完成此操作，因此切换了。任何知道如何识别连续、静止（不移动）向下触摸的人，请分享。

* * *

## 回答 #1

> 赞同：42
> 
> 时间：2009-06-15T18:01:25.910

您也可以执行与上一个答案中显示的类似的操作，并且仍然使用 UIButton。

只需在“Touch Down”上启动计时器，然后在“Touch Up Inside”或“Touch Up Outside”上停止计时器。

就个人而言，我喜欢使用 UIButtons，因为它们提供了一些内置的视觉增强功能，您不必自己编写代码。

* * *

## 回答 #2

> 赞同：32
> 
> 时间：2009-05-24T05:08:16.430

不要使用按钮，使用多点触控和 NSTimer：

在您的界面中创建一个视图本地 NSTimer 对象，然后使用它来启动/取消计时器

```
-(void)movePlayer:(id)sender {
   <Code to move player>
}

-(void)touchesBegan:(NSSet*)touches  withEvent:(UIEvent*)event {
    timer = [NSTimer scheduledTimerWithTimeInterval:0.3 target:self selector:@selector(movePlayer:) userInfo:nil repeats:YES];
}

-(void)touchesEnded:(NSSet*)touches  withEvent:(UIEvent*)event {
   if (timer != nil) 
      [timer invalidate];
      timer = nil;
}

-(void)touchesMoved:(NSSet*)touches  withEvent:(UIEvent*)event {
    if (timer != nil) {
       [timer invalidate];
       timer = nil;
    }
} 
```

这样，您可以以预定义的时间间隔重复事件，而不必依赖按钮，并获得您正在寻找的重复行为。注意 touchesMoved 触发器 - 如果他们移动手指，这将取消计时器，并且玩家停止移动。

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2015-11-26T08:35:19.113

对我来说，以下作品：

1.  创建一个按钮。
2.  在视图控制器或子类中创建 2 个方法（停止触摸并开始触摸）。
3.  添加**3 个**控制事件。**Touch Up Inside**和**Touch Drag Exit**两者都采用停止触摸方法，**Touch Down**采用开始触摸方法。
4.  当开始触摸方法调用时，我们应该以大约 0.2 的间隔启动一个 NSTimer（取决于您希望被调用的速度），重复 true 并作为选择器作为您想要调用的方法（拥有您想要的实际内容当用户点击按钮时执行）。
5.  当停止触摸方法调用时，我们应该使计时器（`.invalidate()`）无效并将计时器分配为零。

就这样！

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2017-08-02T23:47:13.640

现在来点完全不同的东西：
**ReactiveCocoa 6**。

```
self.button.reactive
    .controlEvents([.touchDown])
    .observeValues { button in
        SignalProducer.timer(interval: .milliseconds(500), on: QueueScheduler.main)
            .take(until: button.reactive.controlEvents([.touchDragOutside, .touchDragExit, .touchUpInside, .touchUpOutside, .touchCancel]).map { _ in return })
            .prefix(value: Date())
            .startWithValues { date in
                NSLog("\(date)")
            }
        } 
```

# javascript - 我应该总是给我的函数一个返回值吗？

> ID：903120
> 
> 赞同：13
> 
> 时间：2009-05-24T05:04:20.570
> 
> 标签：javascript, functional-programming, return-value, methodology

我编写 JavaScript 代码并尝试使用它的函数式语言特性。

在其他函数式语言中（甚至在 Ruby 中），如果我没有显式设置函数的返回值，它将返回最后一个计算表达式的值。JavaScript 不遵循这种模式。（准确地说，JavaScript 也总是返回一个值。如果没有设置，则`undefined`.）

我的问题如下：我有一个不需要（也不需要）返回值的函数。在函数式编程上下文中，有一个没有显式返回值的函数是否有意义？或者如果我在这种情况下发现自己在某个地方失败了？

例如，我有以下功能。它会定期检查位置哈希是否已更改，如果是，则调用给定函数。

```
LIB_hashManager = function(f, context) {
    var prev = '';
    var pollHash = function() {
        if (prev !== window.location.hash) {
            prev = window.location.hash;
            f.apply(context);
        }
    };
    window.setInterval(pollHash, 100);
}; 
```

我应该回到这里吗？

**更新**

同时我想到，如果将来我需要扩展 的知识`LIB_hashManager`，遵循函数式构造函数模式，我可以简单地向对象添加方法并`LIB_hashManager`返回生成的对象。

```
LIB_hashManager = function(f, context) {
    // inside logic
    // ...
}; 
```

后来我可能会写：

```
LIB_hashManager = function(f, context) {
    // inside logic
    // ...

    // return public methods
    return {
        // ...
    }
}; 
```

那么在第一种情况下返回一个空对象没有意义吗？

* * *

## 回答 #1

> 赞同：20
> 
> 时间：2009-05-24T05:10:00.563

“纯”函数式编程环境不会产生副作用——每个函数的工作将*完全*是计算其返回值；这在 Javascript 的典型使用中并不真正可行，因此，当函数通过副作用完成其工作时，让它不返回任何内容，即成为“过程”而不是函数，这是完全可以接受的。

* * *

## 回答 #2

> 赞同：5
> 
> 时间：2009-05-24T05:37:11.060

> 我的问题如下：我有一个不需要（也不需要）返回值的函数。在函数式编程上下文中，有一个没有显式返回值的函数是否有意义？或者如果我在这种情况下发现自己在某个地方失败了？

根据函数的学术描述：给定输入，函数必须给出相同的输出。没有任何输出的函数是绝对没用的，因为函数不应该有任何副作用。

但是，由于函数式编程语言通常需要至少 1 个副作用，因此不返回任何内容的约定是返回一个单位或“()”。由于 Javascript 中不存在此概念，因此对您来说应该无关紧要，因为 Javascript 无论如何都不是强类型的。

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2009-05-24T05:08:18.410

拥有一个不返回任何内容的函数是非常好的。事实上，强制一个自然不会有返回值的函数有一个很尴尬而且*闻起来很糟糕*。

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2009-05-24T10:58:12.897

只产生副作用的函数可以简单地认为是一个孤立的程序块，与程序块相同。由于 JS 没有过程，所以将函数用作过程块并没有错。JS 中的函数也是对象的唯一例外，因此在广泛使用此类“函数”时要小心。

在这种情况下，它只会增加程序的可读性。

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2013-12-16T15:48:14.463

*这个问题已经在 4 年前回答了，但我相信，接受的答案是**错误的***

* * *

在给出的代码中，作者设置了间隔，然后 - 他没有提供任何方法来阻止它。

所以答案应该是： **是的，你应该从这个函数返回一个值，这个**值应该是一个允许你停止间隔的对象，间隔是在它内部开始的。

讨论*如何*实施的细节超出了范围。// 你可以通过返回间隔处理程序来实现它，因此你可以手动取消它（参见示例 1），或者通过返回一个具有在幕后执行此操作的方法的对象（smth like或`.pause`）。或者，该对象还可以允许哈希管理器的运行时重新配置（例如更改间隔频率）。`.stop``.cancel`

示例 1（简单）：

```
LIB_hashManager = function(f, context) {
    var prev = '';
    var pollHash = function() {
        if (prev !== window.location.hash) {
            prev = window.location.hash;
            f.apply(context);
        }
    };
    return window.setInterval(pollHash, 100);
}; 
```

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2009-05-24T06:45:31.470

如果你不应该使用`LIB_hashManager`我认为你应该明确地返回的结果`undefined`（即，根本没有返回语句）。

如果您忘记了这一点并尝试使用函数的结果，您可能只会得到一个错误（这很好，因为那将是一个编程错误，一个错误！）

# asp.net - 在服务器端测试 Flash 功能

> ID：903122
> 
> 赞同：2
> 
> 时间：2009-05-24T05:04:55.327
> 
> 标签：asp.net, flash, testing, browser

我正在开发一个需要支持非 Flash 用户的 ASP.NET 网站。

如果用户的浏览器不支持 Flash，或者他们禁用了 Flash，我想下载一个大的启动图像到浏览器。

*但是，如果*Flash正确渲染，我不想浪费带宽下载它。

那么是否可以从服务器端使用 .NET 代码测试浏览器是否支持 Flash？我查看了“Request.Browser”对象，但找不到与 Flash 相关的任何内容。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2009-05-24T06:38:36.087

您不应该在服务器端处理这个问题。大多数 Flash 检测/嵌入脚本默认执行这种行为。我强烈推荐[SWFObject](http://code.google.com/p/swfobject/)。

*   `<div>`在其中使用您的图像（或您真正想要的任何 html）创建一个
*   给它一个 ID 例如：`<div id="flash">`
*   告诉 SWFObject 用 Flash 播放器覆盖该 div 块

如果他们已禁用，他们会看到未更改的 html。如果他们启用了 javascript 但没有 Flash 插件，他们也会看到 html。基本上，只有当他们有 javascript 和 Flash 插件时，他们才会看到 Flash。

这几乎是最好的。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-05-24T05:21:36.273

您可以尝试使用一些服务器变量：

'HTTP_ACCEPT' 针对 'application/x-shockwave-flash'

不确定.NET，但它大部分时间都在 php 中工作。这在 Safari 中不起作用，但对于您正在做的事情应该没问题。您将在 95% 的时间内为自己节省一些带宽。PHP 示例（不是 .NET，但你明白了）：

```
if (strstr($_SERVER['HTTP_ACCEPT'], 'application/x-shockwave-flash')){
    $hasFlash = true;
} 
```

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2009-05-24T05:42:33.657

鉴于您的要求，我最好使用 Flash 检测脚本，该脚本将检测客户端上的 Flash 功能并将用户重定向到另一个页面，而不是下载 SWF 文件。[您可以在Kirupa](http://www.kirupa.com/developer/mx/detection.htm)上找到许多脚本，也可以使用在 Flash 发布选项对话框中生成的脚本

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2009-05-24T05:49:31.163

客户端闪存检测可能是更好的方法。但是，请记住，您可能有禁用 JavaScript 的用户，例如使用[NoScript](http://noscript.net/)插件的用户。我可以看到，你有三个基本的选择来处理这个问题。

1.  忽略它。也许你觉得没有足够的人会在这种情况下值得担心。

2.  检查它，并出现一个指示符，要求用户启用 JS 以获得更好的网站体验。这通常通过在页面中呈现通知并让 JS 代码禁用或隐藏该元素的呈现来完成。

3.  尝试在没有 JavaScript 的情况下支持相当好的站点操作。这可能涉及默认加载大图像，并在加载开始之前停止该加载。这可能很棘手。

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2010-09-16T07:32:56.393

您肯定有一些原因要在服务器端检测闪存。如果闪存不可用，我们需要将某些部分完全替换或遗漏在页面上。它不像在闪光灯所在的确切位置显示替代内容那么简单。我们需要进一步替换html结构。即使 Javascript 不可用，我们也需要这样做。如果 Flash 可用并且我们不能仅仅重定向到另一个页面，那么让 javascript 重写页面并不是一个真正的选项。

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2013-04-27T18:29:58.920

浏览器似乎没有发送

```
application/x-shockwave-flash 
```

在接受标头中。他们只是发送`*/*`

IE似乎发送

```
x-flash-version 
```

出于某种愚蠢的原因，提出了 Flash 请求……

# python - hasattr() 与 try-except 块处理不存在的属性

> ID：903130
> 
> 赞同：93
> 
> 时间：2009-05-24T05:11:59.843
> 
> 标签：python, exception, exception-handling, attributes, hasattr

```
if hasattr(obj, 'attribute'):
    # do somthing 
```

对比

```
try:
    # access obj.attribute
except AttributeError, e:
    # deal with AttributeError 
```

哪个应该是首选，为什么？

* * *

## 回答 #1

> 赞同：93
> 
> 时间：2009-05-24T06:41:27.237

*有没有说明性能差异的长凳？*

时间它是你的朋友

```
$ python -mtimeit -s 'class C(object): a = 4
c = C()' 'hasattr(c, "nonexistent")'
1000000 loops, best of 3: 1.87 usec per loop
$ python -mtimeit -s 'class C(object): a = 4
c = C()' 'hasattr(c, "a")'
1000000 loops, best of 3: 0.446 usec per loop
$ python -mtimeit -s 'class C(object): a = 4
c = C()' 'try:
 c.a
except:
 pass'
1000000 loops, best of 3: 0.247 usec per loop
$ python -mtimeit -s 'class C(object): a = 4
c = C()' 'try:
 c.nonexistent
except:
 pass'
100000 loops, best of 3: 3.13 usec per loop
$

       |positive|negative
hasattr|  0.446 |  1.87 
try    |  0.247 |  3.13 
```

* * *

## 回答 #2

> 赞同：88
> 
> 时间：2009-05-24T05:17:15.250

`hasattr`在内部快速执行与块相同的任务`try/except`：它是一个非常具体、优化的单任务工具，因此在适用时，应优先于非常通用的替代方案。

* * *

## 回答 #3

> 赞同：30
> 
> 时间：2013-05-24T03:18:35.717

还有第三种，通常是更好的选择：

```
attr = getattr(obj, 'attribute', None)
if attr is not None:
     print attr 
```

好处：

1.  `getattr`没有[Martin Geiser 指出的糟糕的异常吞咽行为](https://stackoverflow.com/a/16186050/243712)——在旧 Python 中，`hasattr`甚至会吞下`KeyboardInterrupt`.

2.  您检查对象是否具有属性的正常原因是您可以使用该属性，这自然会导致它。

3.  该属性以原子方式读取，并且不受其他线程更改对象的影响。（不过，如果这是一个主要问题，您可能需要考虑在访问对象之前锁定它。）

4.  它比 更短，`try/finally`而且通常比 更短`hasattr`。

5.  一个宽泛的`except AttributeError`块可能会捕获`AttributeErrors`您所期望的之外的块，这可能会导致令人困惑的行为。

6.  访问一个属性比访问一个局部变量要慢（特别是如果它不是一个普通的实例属性）。（不过，老实说，Python 中的微优化通常是徒劳的。）

需要注意的一件事是，如果您关心`obj.attribute`设置为 None 的情况，则需要使用不同的哨兵值。

* * *

## 回答 #4

> 赞同：19
> 
> 时间：2013-04-24T07:32:57.523

我几乎总是使用`hasattr`: 这是大多数情况下的正确选择。

有问题的情况是当一个类覆盖`__getattr__`:`hasattr`将**捕获所有异常**而不是`AttributeError`像您期望的那样捕获。换句话说，`b: False`即使看到`ValueError`异常更合适，也会打印下面的代码：

```
class X(object):
    def __getattr__(self, attr):
        if attr == 'a':
            return 123
        if attr == 'b':
            raise ValueError('important error from your database')
        raise AttributeError

x = X()
print 'a:', hasattr(x, 'a')
print 'b:', hasattr(x, 'b')
print 'c:', hasattr(x, 'c') 
```

重要的错误就这样消失了。这已[在 Python 3.2](http://docs.python.org/3/whatsnew/3.2.html) ( [issue9666](http://bugs.python.org/issue9666) ) 中得到修复，`hasattr`现在只能捕获`AttributeError`。

一个简单的解决方法是编写这样的实用程序函数：

```
_notset = object()

def safehasattr(thing, attr):
    return getattr(thing, attr, _notset) is not _notset 
```

这让我们`getattr`处理这种情况，然后它可以引发适当的异常。

* * *

## 回答 #5

> 赞同：13
> 
> 时间：2009-05-24T05:37:42.993

我想说这取决于您的函数是否可以接受没有**设计属性的**对象，例如，如果您有两个函数调用者，一个提供具有属性的对象，另一个提供没有属性的对象。

如果你得到一个没有属性的对象的唯一情况是由于一些错误，我建议使用异常机制，即使它可能会更慢，因为我相信它是一个更简洁的设计。

底线：我认为这是一个设计和可读性问题，而不是效率问题。

* * *

## 回答 #6

> 赞同：5
> 
> 时间：2009-06-30T10:52:28.280

如果没有属性**不是**错误条件，则异常处理变体有一个问题：它还会捕获访问 obj.attribute 时可能在*内部*出现的 AttributeErrors（例如，因为属性是一个属性，因此访问它会调用一些代码）。

* * *

## 回答 #7

> 赞同：5
> 
> 时间：2018-03-16T19:12:00.807

这个主题在Sebastian Witowski的 EuroPython 2016 演讲*[编写更快的 Python中有所涉及。](https://youtu.be/YjHsOrOOSuI?t=766)*这是他的幻灯片和性能摘要的复制品。*他还使用了您在此讨论中跳跃之前*的术语外观，值得一提的是在这里标记该关键字。

> 如果该属性实际上缺失，那么请求宽恕将比请求权限慢。因此，根据经验，如果知道该属性很可能会丢失或您可以预测的其他问题，您可以使用请求许可方式。否则，如果您期望代码将导致大多数时间可读代码

# 3 许可还是宽恕？

```
# CASE 1 -- Attribute Exists
class Foo(object):
    hello = 'world'
foo = Foo()

if hasatter(foo, 'hello'):
    foo.hello
## 149ns ##

try:
    foo.hello
except AttributeError:
    pass
## 43.1 ns ##
## 3.5 times faster

# CASE 2 -- Attribute Absent
class Bar(object):
    pass
bar = Bar()

if hasattr(bar, 'hello'):
    bar.hello
## 428 ns ##

try:
    bar.hello
except AttributeError :
    pass
## 536 ns ##
## 25% slower 
```

* * *

## 回答 #8

> 赞同：4
> 
> 时间：2009-05-24T05:32:01.377

如果它只是您正在测试的一个属性，我会说 use `hasattr`。但是，如果您正在对可能存在或不存在的属性进行*多次*`try`访问，那么使用块可能会为您节省一些输入。

* * *

## 回答 #9

> 赞同：3
> 
> 时间：2009-05-24T08:00:38.027

我建议选项 2。如果其他线程正在添加或删除该属性，则选项 1 具有竞争条件。

python也有一个[成语](http://jaynes.colorado.edu/PythonIdioms.html)，即EAFP（'比许可更容易请求宽恕'）比LBYL（'在你跳跃之前看看'）更好。

* * *

## 回答 #10

> 赞同：2
> 
> 时间：2009-05-24T05:44:44.980

从实际的角度来看，在大多数语言中，使用条件总是比处理异常快得多。

如果您想处理当前函数之外某处不存在属性的情况，则例外是更好的方法。您可能希望使用异常而不是条件的一个指标是，条件仅设置一个标志并中止当前操作，其他地方检查该标志并根据该标志采取行动。

也就是说，正如 Rax Olgud 所指出的，与他人交流是代码的一个重要属性，你想说“这是一种特殊情况”而不是“这是我期望发生的事情”可能更重要.

* * *

## 回答 #11

> 赞同：0
> 
> 时间：2009-05-24T05:14:59.073

首先。

越短越好。例外应该是例外。

* * *

## 回答 #12

> 赞同：0
> 
> 时间：2012-10-12T08:29:57.803

至少当它取决于程序中发生的事情时，忽略了可读性等人为部分（实际上大多数时候这比性能更重要（至少在这种情况下 - 具有那个性能跨度），正如 Roee Adler 和其他人指出的那样）。

尽管如此，从这个角度来看，它就变成了在两者之间进行选择的问题

```
try: getattr(obj, attr)
except: ... 
```

和

```
try: obj.attr
except: ... 
```

因为`hasattr`只使用第一种情况来确定结果。值得深思 ;-)

# c++ - 根据某些特定规则对文本进行标记。C++ 中的算法

> ID：903133
> 
> 赞同：2
> 
> 时间：2009-05-24T05:13:06.377
> 
> 标签：c++, algorithm, tokenize

我正在编写一个程序，它将根据某些特定规则对输入文本进行标记。我为此使用 C++。

**规则**

```
Letter 'a' should be converted to token 'V-A'
Letter 'p' should be converted to token 'C-PA'
Letter 'pp' should be converted to token 'C-PPA'
Letter 'u' should be converted to token 'V-U' 
```

这只是一个示例，实时我有大约 500 多个这样的规则。如果我将输入作为“ *appu* ”提供，它应该像“ *VA + C-PPA + VU* ”一样标记化。我已经实现了一个算法来做到这一点，并想确保我做的是正确的事情。

**算法**

所有规则都将保存在一个 XML 文件中，并具有到令牌的相应映射。就像是

```
<rules>
  <rule pattern="a" token="V-A" />
  <rule pattern="p" token="C-PA" />
  <rule pattern="pp" token="C-PPA" />
  <rule pattern="u" token="V-U" />
</rules> 
```

1 - 应用程序启动时，读取此 xml 文件并将值保存在“ *std::map* ”中。这将在应用程序结束之前可用（单例模式实现）。

2 - 迭代输入的文本字符。对于每个字符，查找匹配项。如果找到，变得更加贪婪并通过从输入文本中获取下一个字符来寻找更多匹配项。这样做，直到我们得到一个不匹配。因此，对于输入文本“ *appu ”，首先查找“* *a* ”的匹配项。如果找到，请尝试通过从输入文本中获取下一个字符来获得更多匹配。所以它会尝试匹配 ' *ap* ' 并没有找到匹配项。所以它只是返回。

3 - 替换输入文本中的字母“a”，因为我们得到了它的标记。

4 - 对输入文本中的剩余字符重复步骤 2 和 3。

下面是更简单的步骤说明

```
input-text = 'appu'
tokens-generated=''

// First iteration
character-to-match = 'a'
pattern-found = true

// since pattern found, going recursive and check for more matches
character-to-match = 'ap'
pattern-found = false

tokens-generated = 'V-A'

// since no match found for 'ap', taking the first success and replacing it from input text
input-text = 'ppu'

// second iteration
character-to-match = 'p'
pattern-found = true

// since pattern found, going recursive and check for more matches
character-to-match = 'pp'
pattern-found = true

// since pattern found, going recursive and check for more matches
character-to-match = 'ppu'
pattern-found = false

tokens-generated = 'V-A + C-PPA'

// since no match found for 'ppu', taking the first success and replacing it from input text
input-text = 'u'

// third iteration
character-to-match = 'u'
pattern-found = true

tokens-generated = 'V-A + C-PPA + V-U'  // we'r done! 
```

**问题**

1 - 这个算法看起来很好解决这个问题还是有更好的方法来解决这个问题？

2 - 如果这是正确的方法，std::map 是一个不错的选择吗？还是我需要创建自己的键/值容器？

3 - 是否有可以像上面一样标记字符串的库？

任何帮助，将不胜感激

:)

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2009-05-24T05:40:37.683

所以你要遍历地图中的所有标记来寻找匹配项？您不妨在那里使用列表或数组；无论如何，这将是一个低效的搜索。

找到适合开始或继续比赛的标记的一种更有效的方法是将它们存储为[trie](http://en.wikipedia.org/wiki/Trie)。在那里查找一个字母会给你一个子树，它只包含以那个字母作为第一个字母的标记，然后你就可以继续向下搜索。

* * *

编辑：让我进一步解释一下。

首先，我应该解释一下，除了名称之外，我对这些 C++ 并不熟悉`std::map`，这使得这是一个完美的例子，说明为什么人们要学习这些东西的理论以及特定编程语言中特定库的细节：除非库严重滥用了“map”这个名字（这不太可能），这个名字本身告诉了我很多关于数据结构特征的信息。例如，我知道会有一个函数，给定一个键和映射，将非常有效地搜索并返回与该键关联的值，并且可能还有一个函数会给你一个列表/array/whatever 所有键，您可以使用自己的代码自行搜索。

我对您的数据结构的解释是您有一个映射，其中键是您所谓的模式，那些是字符列表（或数组，或类似性质的东西），而值是标记。因此，给定一个完整的模式，您可以快速找到与其关联的令牌。

不幸的是，虽然这样的映射非常适合将您的 XML 输入格式转换为内部数据结构，但它并不适合您需要执行的搜索。请注意，您不是查找整个模式，而是查找模式的第一个字符，生成一组可能的标记，然后*从第一次查找生成的模式集中查找*模式的第二个字符，并且很快。

所以你真正需要的不是一个单一的地图，而是地图的地图，每个地图都由一个字符键控。在顶层查找“p”应该会为您提供一个新地图，其中包含两个键：`p`生成`C-PPA`令牌和“其他任何东西”，生成`C-PA`令牌。这实际上是一个 trie 数据结构。

这有意义吗？

如果您首先以这种方式编写解析代码，这可能会有所帮助：想象其他人将编写函数来执行您需要的查找，他是一个非常优秀的程序员，几乎可以做任何您想要的魔术。编写解析代码，专注于使其尽可能简单和干净，使用您需要的这些任意函数创建任何接口（同时不要变得微不足道，并用一个函数替换整个事情！）。现在您可以查看最终使用的查找函数，它会告诉您需要如何访问数据结构，这将引导您找到所需的数据结构类型。一旦你弄清楚了，你就可以弄清楚如何加载它。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-05-24T05:43:58.693

1.  这种方法会奏效 - 我不确定它是否有效，但它应该有效。

2.  我会使用标准的 std::map 而不是你自己的系统。

3.  有像`lex`（或`flex`）这样的工具可以用于此。问题在于您是否可以重新生成当 XML 规范更改时它将构建的词法分析器。如果 XML 规范不经常更改，您可以使用诸如扫描和映射之类的工具`lex`来更轻松地进行扫描和映射。如果 XML 规范可以随使用程序的人的心血来潮而改变，那么`lex`可能不太合适。

有一些警告——特别是两者都`lex`生成`flex`C 代码，而不是 C++。

我还会考虑研究模式匹配技术——特别使用的那种东西`egrep`。这具有可以在运行时处理的优点（因为`egrep`它一直在处理）。或者你可以选择一种脚本语言——Perl、Python……或者你可以考虑像 PCRE（Perl 兼容正则表达式）库之类的东西。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2009-05-24T05:46:59.687

您可以使用正则表达式（也许是 boost::regex 库）。如果所有模式都只是字母串，那么像“(a|p|pp|u)”这样的正则表达式会找到一个贪婪匹配。所以：

1.  使用上述模式运行 regex_search 以找到下一个匹配项
2.  将匹配文本插入您的 std::map 以获取替换文本。
3.  将不匹配的消耗输入和替换文本打印到输出，然后在剩余输入上重复 1。

并做了。

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2009-05-24T05:55:45.410

更好的是，如果你要使用 boost 库，总是有 Boost 标记器库 -> [http://www.boost.org/doc/libs/1_39_0/libs/tokenizer/index.html](http://www.boost.org/doc/libs/1_39_0/libs/tokenizer/index.html)

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2009-05-24T21:09:13.417

它可能看起来有点复杂，但最有效的方法是使用图形来表示状态图。起初，我认为[boost.statechart](http://www.boost.org/doc/libs/1_39_0/libs/statechart/doc/index.html)会有所帮助，但我认为这并不合适。这种方法比使用简单的 std::map 更有效，如果有很多规则，可能的字符数是有限的，并且要读取的文本长度相当长。

所以无论如何，使用一个简单的图表：

0）创建带有“开始”顶点的图形

1）读取xml配置文件并在需要时创建顶点（从一个“字符集”（例如“pp”）转换为另外一个（例如“ppa”））。在每个顶点内，存储到下一个顶点的转换表。如果“关键文本”完整，则将顶点标记为最终文本并存储结果文本

2) 现在阅读文本并使用图表进行解释。从“开始”顶点开始。( * ) 使用表格来解释一个字符并跳转到新的顶点。如果没有选择新的顶点，则会发出错误。否则，如果新顶点是最终的，则打印结果文本并跳回开始顶点。返回 (*) 直到没有更多文本需要解释。

您可以使用[boost.graph](http://www.boost.org/doc/libs/1_39_0/libs/graph/doc/index.html)来表示图形，但我认为它对于您的需要来说过于复杂。制作您自己的自定义表示。

# asp.net-mvc - 是否可以有一个强类型的 GetVirtualPath 方法？

> ID：903136
> 
> 赞同：0
> 
> 时间：2009-05-24T05:15:03.287
> 
> 标签：asp.net-mvc, routes

基于[this SO post](https://stackoverflow.com/questions/363234/url-form-action-without-viewcontext)的答案，我正在尝试对其进行一些调整，以便我不需要对路由和路由参数进行硬编码，而是（如果可能）使用强类型控制器操作方法：-

```
string path = RouteTable.Routes.GetVirtualPath(
    new RequestContext(HttpContext,
                       RouteTable.Routes.GetRouteData(HttpContext)),    
                       new RouteValueDictionary(         
                           new 
                           { 
                               controller = "Foo",
                               action = "Bar"
                           })).VirtualPath; 
```

MVC Futures 命名空间（Microsoft.Web.MVC）具有强类型 ActionLink 的能力......所以我想知道这是否可以在这里做类似的事情。

强类型 GetVirtualpath ???

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-05-24T09:09:19.747

简短的回答 - 是的，你可以。我知道这是因为`ActionLink`您所说的 (Futures) 有一个重载，该重载接受一个强类型`Action`委托，该委托将其转换`RouteValueDictionary`为`RouteLink`. 我不确定你是否可以只使用`ExpressionHelper`。我想你可以。让我试着找到一个例子......

**编辑**这可能有效：

```
string path = RouteTable.Routes.GetVirtualPath(
    new RequestContext(HttpContext,
                   RouteTable.Routes.GetRouteData(HttpContext)),    
                   Microsoft.Web.Mvc.Internal.ExpressionHelper.GetRouteValuesFromExpression<YourController>(c=>c.YourAction())).VirtualPath; 
```

# ruby - 使用线程和红宝石机械化安全吗？

> ID：903143
> 
> 赞同：2
> 
> 时间：2009-05-24T05:20:24.637
> 
> 标签：ruby, multithreading, mechanize

有没有人见过很多这样的错误：

```
Exception `Net::HTTPBadResponse' at /usr/lib/ruby/1.8/net/http.rb:2022
- wrong status line: _SOME HTML CODE HERE_ 
```

何时使用螺纹和机械化？我相对确定这是线程和`net/http`库之间的一些不良行为，但是对于您在使用 mechanize/nethttp 时想要一次运行的线程上限有什么建议吗？我怎么能捕捉到这种异常，因为`rescue Net::HTTPBadResponse`它不起作用？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-05-24T05:33:35.383

这在 Mechanize 中可能是非线程安全的，但我可以想到其他可能导致相同问题的错误。如果您正在使用它们，我将首先禁用持久连接。接下来要做的是查看您的代码，并确保您小心处理您处理的对象。如果您的应用程序有多个线程处理公共对象，则可能会破坏一个本来是线程安全的库。

如果某处存在线程问题，那么您可以安全使用的线程上限为 1。再多的，您只是在权衡您希望问题发生的频率，而不是问题是否发生.

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2010-12-02T03:45:23.127

根据我今晚的艰苦经验，试图让两个基于 Mechanize 的任务在 Event Machine 和[这个有点古老的交换](http://rubyforge.org/pipermail/mechanize-users/2007-July/000193.html)中串联运行，不，它似乎不是线程安全的。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2016-03-15T20:11:05.857

根据[Aaron Patterson 本人的这封电子邮件](http://rubyforge.org/pipermail/mechanize-users/2009-September/000449.html)，如果您不在线程之间共享代理，则应该没问题。

恕我直言，这意味着 Mechanize 不是线程安全的。

# python - 如何在 Google App Engine 中实现防盗链

> ID：903144
> 
> 赞同：5
> 
> 时间：2009-05-24T05:21:29.330
> 
> 标签：python, google-app-engine, hotlinking

我的应用程序在 GAE 上，我试图弄清楚如何防止在 Python 中动态提供图像（例如 /image?id=E23432E）的热链接。请指教。

* * *

## 回答 #1

> 赞同：11
> 
> 时间：2009-05-24T08:02:20.503

[在 Google webapp 框架中，您可以从Request 类](http://code.google.com/appengine/docs/python/tools/webapp/requestclass.html)中提取引用者：

```
def get(self):
    referer = self.request.headers.get("Referer")
    # Will be None if no referer given in header. 
```

请注意`referer`，不是`referrer`（请参阅[此字典条目](http://dictionary.reference.com/browse/referer)）。

# javascript - 如何通过 Javascript 获取 html List 值？

> ID：903150
> 
> 赞同：1
> 
> 时间：2009-05-24T05:29:09.023
> 
> 标签：javascript, html, javascript-events

我正在尝试从 html list 获取值`<li>`。

```
<ul>
    <li><a>Main Menu</a>
        <ul class="leftbutton" >
            <li value="List1"><a>Sampe 1</a></li>
            <li value="List2"><a>Sample 2</a></li>
            <li value="List3"><a>Sample 3</a></li>
            <li value="List4"><a>Sample 4</a></li>
            <li value="List5"><a>Sample 5</a></li>
        </ul>
    </li>
</ul> 

<iframe id="iframeid" width="100%" height="100%" align="middle"></iframe> 

function changeList()
{
    var iframe = document.getElementById("iframeid");  
    var url = document.getElementById("selectedlist").value + ".html"; 
    iframe.src = url;
} 
```

我会在哪里放置 onClick="changeList()" 以从列表中获取值？

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2009-05-24T07:12:44.630

你在这里弄错了几件事。

1.  HTML 列表项 ( `<li>`) 没有值
2.  HTML 列表没有“选定项目”
3.  您无法通过调用获得任何“选定”项目`getElementById()`

这是我的替代建议：

```
<ul>
  <li><a>Main Menu</a>
    <ul class="leftbutton" >
      <li><a href="List1.html" onclick="return changeList(this);">Sample 1</a></li>
      <li><a href="List2.html" onclick="return changeList(this);">Sample 2</a></li>
      <li><a href="List3.html" onclick="return changeList(this);">Sample 3</a></li>
      <li><a href="List4.html" onclick="return changeList(this);">Sample 4</a></li>
      <li><a href="List5.html" onclick="return changeList(this);">Sample 5</a></li>
    </ul>
  </li>
</ul> 

<iframe id="iframeid" width="100%" height="100%" align="middle"></iframe> 

<script type="text/javascript">
function changeList(a)
{
  var iframe = document.getElementById("iframeid");
  iframe.src = a.href;
  return false;
}
</script> 
```

想法：如果 JavaScript 被停用，它仍然可以工作（初步）。该函数返回`false`，因此当启用 JavaScript 时，单击链接会取消 href 导航。

请注意，直到 HTML 4.01 Transitional 也可以完全不使用 JavaScript。具有框架名称的`target`属性就足够了：

```
<ul>
  <li><a>Main Menu</a>
    <ul class="leftbutton" >
      <li><a href="List1.html" target="iframename">Sample 1</a></li>
      <li><a href="List2.html" target="iframename">Sample 2</a></li>
      <li><a href="List3.html" target="iframename">Sample 3</a></li>
      <li><a href="List4.html" target="iframename">Sample 4</a></li>
      <li><a href="List5.html" target="iframename">Sample 5</a></li>
    </ul>
  </li>
</ul> 

<iframe id="iframeid" name="iframename" width="100%" height="100%" align="middle"></iframe> 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-05-24T06:56:11.777

我不是 100% 确定内联 iframe，但你可以简单地使用

```
<li><a href="/path/to/html" target="myIframeId">Value</a></li> 
```

这不是有效的 html 4 strict 但对过渡有效并且无论如何都适用于所有浏览器。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2011-06-25T09:04:52.853

`li`有属性值，但值应该是整数，这就是重点：

```
 <li value="1"><a>Sampe 1</a></li>
            <li value="2"><a>Sample 2</a></li>
            <li value="3"><a>Sample 3</a></li>
            <li value="4"><a>Sample 4</a></li>
            <li value="5"><a>Sample 5</a></li> 
```

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2009-05-24T06:33:54.817

你可以把它放在锚标签上，因为我认为这是你点击的。

# ios - 获取info.plist的fileSize，防止盗版

> ID：903157
> 
> 赞同：8
> 
> 时间：2009-05-24T05:34:00.343
> 
> 标签：ios, iphone, plist, nsbundle, piracy-protection

我正在尝试将反盗版代码放入我的应用程序中。之前的答案（由于我的会员身份而无法链接到 - 糟透了）可以很容易地反驳，因为可以使用十六进制编辑器在二进制文件中查找和替换“SignerIdentity”字符串。

相反，检查 info.plist 文件的 fileSize 并将其与参考值进行比较听起来更可靠（因为在破解应用程序时 info.plist 会到处修改）。我该怎么做？我尝试了以下方法，但它记录了 0。

```
NSBundle *bundle = [NSBundle mainBundle];
NSDictionary *mainDictionary = [bundle infoDictionary];
NSLog(@"%d", [mainDictionary fileSize]); 
```

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2009-05-24T13:46:57.830

您可以通过应用 ROT13 或类似的简单模糊算法 [http://en.wikipedia.org/wiki/ROT13来防止 noobish 破解者在您的代码中找到对“SignerIdentity”的引用](http://en.wikipedia.org/wiki/ROT13)

应用 ROT13 后，“SignerIdentity”将变为“FvtareVqragvgl”。

无论如何，您的问题的答案（如何获得 Info.plist 文件的大小）：

```
NSBundle *bundle = [NSBundle mainBundle];
NSString* bundlePath = [bundle bundlePath];

NSFileManager *fileManager = [NSFileManager defaultManager];

NSString* path = [NSString stringWithFormat:@"%@/Info.plist", bundlePath ];

NSDictionary *fileAttributes = [fileManager attributesOfItemAtPath:path 
                                                             error:NULL];

if (fileAttributes != nil) {
    NSNumber *fileSize;

    if (fileSize = [fileAttributes objectForKey:NSFileSize]) {
        NSLog(@"File size: %qi\n", [fileSize unsignedLongLongValue]);
    }           
} 
```

还要记住，`Info.plist`Xcode 项目目录和`Info.plist`包内部的大小（以字节为单位）可能不同。您可能希望构建一次游戏，然后查看大小，`<your app bundle.app>/Info.plist`然后更新您的反盗版代码。

* * *

## 回答 #2

> 赞同：5
> 
> 时间：2009-05-24T13:52:02.297

我从来没有为 iPhone 编程过，但你不能只取那个文件的哈希值并将其与参考值进行比较，可能会加盐哈希值以防止有人将参考哈希值更改为新的吗？

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2009-09-19T22:47:29.313

该代码仍然有很多赠品：

字符串 Info.plist 很容易找到。NSFileSize 也很可疑....

* * *

## 回答 #4

> 赞同：2
> 
> 时间：2010-01-11T10:21:48.267

如这里所说，[以编程方式确定 iPhone 是否](https://stackoverflow.com/questions/1140856/determining-if-an-iphone-is-jail-broken-programatically/2040767#2040767)越狱，看起来通过 install0us 安装的一些最新破解的应用程序没有修改其 info.plist。（至少 info.plist 不包含任何签名者身份密钥）。在这种情况下，我们如何检测到裂缝？

# ruby-on-rails - 在 Ruby on Rails 2.3.2 中，如何在创建操作期间打印出参数？

> ID：903160
> 
> 赞同：12
> 
> 时间：2009-05-24T05:37:13.350
> 
> 标签：ruby-on-rails

有一个脚手架创建的故事......在创建动作中，有

```
@story = Story.new(params[:story]) 
```

我很好奇参数中有什么...所以我想转储参数...但是没有与创建操作相关的视图...有没有办法转储其内容？有没有办法在我的代码中转储 POST 变量？（看看低层发生了什么）

* * *

## 回答 #1

> 赞同：21
> 
> 时间：2009-05-24T05:41:02.800

最简单的做法是将参数转储到日志中：

```
Rails.logger.info("PARAMS: #{params.inspect}") 
```

如果您处于开发模式，只需查看您的 development.log，该行就会出现。

params 范围是 URL/FORM (GET/POST) 字段的组合，它将作为正常输出处理的一部分打印在日志中，因此您可能不需要自己转储它 - 任何开发或生产日志包含日志行顶部的参数转储，例如

```
Processing Clients::ClientsController#show (for x.x.x. at 2009-05-24 00:34:26) [GET]
  Parameters: {"id"=>"303", "user_id"=>"2"} 
```

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2011-04-05T16:31:17.160

现在我更了解 Rails，你也可以简单地使用

```
p params 
```

在您的代码中并查看控制台的输出（控制台上显示的日志）

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2009-05-24T06:24:16.507

如果您使用的是 Mac，[Spike](http://github.com/mmower/spike/tree/master)是一个很棒的小应用程序，它可以分析日志文件，并且可以让您检查请求的参数等。

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2009-05-24T07:01:02.843

在 Windows 上使用 Fiddler，显示

HTTP 行 #1 是：

```
POST /stories HTTP/1.1 
```

这是 POST 内容：

> authenticity_token=62iw%2BrsxlCFsbnxsS7FXKRn6CcvJfjottrsBPlM5lZo%3D&story%5Bname%5D=Google+Main+Site&story%5Blink%5D=www.google.com&commit=创建

列于表中：

```
authenticity_token  62iw+rsxlCFsbnxsS7FXKRn6CcvJfjottrsBPlM5lZo=
story[name]         Google Main Site
story[link]         www.google.com
commit              Create 
```

服务器日志是：

> 参数：{"commit"=>"Create", "story"=>{"name"=>"Google Main Site", "link"=>"www.google.com"}, "authenticity_token"=>"62iw +rsxlCFsbnxsS7FXKRn6CcvJfjottrsBPlM5lZo="}

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2009-05-24T17:05:48.193

`/log`除了查看您的日志（他们住在）之外，您不需要做任何事情。除非您在摆弄某些东西，否则默认情况下所有日志中的参数记录都是打开的。

```
Processing PostsController#create (for 127.0.0.1 at 2009-05-24 13:03:24) [POST]
  Parameters: {"commit"=>"Create", "authenticity_token"=>"2G6BKOs8xNAaXiToVf4r1ko8QZzP9QAomi2PHVQC5Oc=", "story"=>{"something"=>"asdfafd"}} 
```

`Parameters`列出所有参数，下面的哈希`"story"`等价于`params[:story]`（所有内容都以字符串形式到达服务器，Rails 将其转换为 a`HashWithIndifferentAccess`以便您可以使用符号访问它）。

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2009-09-12T00:05:58.350

如果您使用的是 *NIX 系统（包括 OS X），请打开一个新的终端窗口/选项卡并键入以下命令：

尾 -f 日志/development.log

您将收到源源不断的请求流——包括参数——以及由此产生的数据库操作。对开发/调试非常宝贵，IMO。

# editor - 在哪里可以找到 SourceInsight 的配置文件？

> ID：903169
> 
> 赞同：2
> 
> 时间：2009-05-24T05:43:27.260
> 
> 标签：editor, source-insight

在哪里可以找到 SourceInsight 的配置文件？

该软件的默认配置使代码甚至不可读。

谢谢。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-11-15T14:41:30.677

下面是一些我认为 Source Insight 没有附带的编程语言的 Source Insight 配置文件 (.clf)。

添加我想我忘记的链接：

[请参阅http://www.sourceinsight.com/public/](http://www.sourceinsight.com/public/)上的“语言” 。我现在无法访问它，但也许这只是我。

# java - Richfaces 建议框将附加值传递给支持 bean

> ID：903172
> 
> 赞同：5
> 
> 时间：2009-05-24T05:44:32.407
> 
> 标签：java, jsf, richfaces

使用 RichFaces 时，`suggestionBox`如何将多个 id 或值从带有文本输入的页面传递到`suggestionBox`支持 bean。即：显示所选州内的建议城市列表？这是我的`autoComplete`方法。

```
public List< Suburb > autocomplete(Object suggest)
{
    String pref = (String) suggest;
    ArrayList< Suburb > result = new ArrayList< Suburb >();

    Iterator< Suburb > iterator = getSuburbs().iterator();
    while( iterator.hasNext() )
    {
        Suburb elem = ((Suburb) iterator.next());
        if( (elem.getName() != null && elem.getName().toLowerCase().indexOf( pref.toLowerCase() ) == 0) || "".equals( pref ) )
        {
            result.add( elem );
        }
    }
    return result;
} 
```

如您所见，从页面传递了一个值，`Object`建议，它是`h:inputText`（在 faceLets 中`m:textFormRow`）的文本

```
<m:textFormRow id="suburb" label="#{msgs.suburbPrompt}" 
    property="#{bean[dto].addressDTO.suburb}"
    required="true" maxlength="100" size="30" />

<rich:suggestionbox height="200" width="200" usingSuggestObjects="true"
    suggestionAction="#{suburbsMBean.autocomplete}" var="suburb" for="suburb"
    fetchValue="#{suburb.name}" id="suggestion">
    <h:column>
        <h:outputText value="#{suburb.name}" />
    </h:column>
</rich:suggestionbox> 
```

在页面的前面，您可以选择我想用来减少建议框显示的郊区列表的州。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2010-04-28T15:19:42.057

（免责声明：我知道这个问题是很久以前提出的，但也许这会帮助有类似问题的人......）

查看此博客文章，其中涉及类似的内容：**[RichFaces - SuggestionBox and hidden field](http://workflow.imixs.org/roller/ralphsjavablog/entry/richfaces_suggestionbox_and_hidden_field)**。 

关键是要使用`<f:setPropertyActionListener value="#{...}" target="#{...}">`wrapped inside `<a4j:support event="onselect" ajaxSingle="true">`。`onselect`当为 SuggestionBox 触发时，这可用于设置支持 bean 的附加值。

通过这种方法，我设法创建了一个 SuggestionBox，它显示（并自动完成）客户的*姓名*，但在选择时为 bean 设置了一个完整的*客户对象*（具有多个属性；由 id 标识）。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-07-28T23:29:29.537

`<f:parameter`在`<rich:suggestionbox`作品中使用标签吗？

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-05-28T12:19:10.653

你看过这个 RichFaces 建议框[演示](http://livedemo.exadel.com/richfaces-demo/richfaces/suggestionBox.jsf?c=suggestionBox&tab=usage)了吗？示例下方有链接可以查看源代码。

编辑：

听起来您需要在用户输入建议框之前，您的 bean 中的状态值。我将使用 RichFaces ajax 支持将 state 的值传递给 bean，因此当调用 autocomplete 方法时，用户在页面上选择的状态是填充郊区列表。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2016-04-22T19:49:52.787

您可以`<f:parameter`使用`rich:suggestionbox`. 我的任务是根据列表元素的某些属性过滤列表，有时该属性可能会被忽略。就像，有时我想要一个只有柑橘类水果的列表，有时我想要整个可用水果的列表。

在页面中：

```
<rich:suggestionbox usingSuggestObjects="true"
        suggestionAction="#{listBuilder.autocompleteFilterFruit('')}" var="ind"
        for="fruitInput" fetchValue="#{fruit.name}" id="suggestion" >
    <f:param name="constrainInd" value="#{basket.isConstrainedToCitrus}" />

    ...

</rich:suggestionbox> 
```

我有一个类 ( `Basket`) 知道列表是否必须经过特殊过滤，另一个类 ( `ListBuilder`) 构建列表。

在`Basket`：

```
public Boolean getIsConstrainedToCitrus ()
{
    return new Boolean ( logic that answers "is this basket for citrus only" );
} 
```

在 ListBuilder 中：

```
public List<Fruit> autocompleteFilterFruit (Object arg)
{
    List<Fruit> rtnList = new ArrayList<Fruit> ();

    String suggestion = (String) arg;

    // get the filter control that the page retrieved from the Basket
    //
    Map<String,String> params = FacesContext.getCurrentInstance().getExternalContext ().getRequestParameterMap();
    boolean isConstrainedToCitrus = "true".equals (params.get ("constrainInd"));

    // allFruit is a pre-initialized list of all the available fruit. use it to populate the return list according 
    // to the filter rules and matches to the auto-complete suggestions
    for (Fruit item : allFruit)
    {
        if ((!isConstrainedToCitrus || item.isCitrus())  &&  item.name.startsWith(suggestion))
        {
            rtnList.add (item);
        }
    }
    return rtnList;
} 
```

# c# - 如何找出创建回文的最少字符数？

> ID：903176
> 
> 赞同：15
> 
> 时间：2009-05-24T05:45:48.440
> 
> 标签：c#, string, algorithm

给定一个字符串，找出最少需要多少个字符才能使这个词成为回文。例子：

```
ABBA：0（已经是回文）
ABB：1
FAE：2
福：1

```

* * *

## 回答 #1

> 赞同：48
> 
> 时间：2009-05-24T06:18:36.830

仅算法，因为这可能是家庭作业[向雷蒙德道歉，这是一个面试问题而不是家庭作业，因为他的编辑/评论清楚地表明了这一点。但是，算法和添加的伪代码仍然适用于此目的，我在最后添加了一些 C 代码]。

您需要在字符串的末尾找到最长的回文。可以通过简单地从字符串的开头运行一个指针，从字符串的末尾运行一个指针，检查它们引用的字符是否相同，直到它们在中间相遇，就可以创建一种算法来查看字符串是否是回文。就像是：

```
function isPalindrome(s):
    i1 = 0
    i2 = s.length() - 1
    while i2 > i1:
        if s.char_at(i1) not equal to s.char_at(i2):
            return false
        increment i1
        decrement i2
    return true 
```

尝试使用完整的字符串。如果这不起作用，将第一个字符保存在堆栈中，然后查看剩余的字符是否形成回文。如果这不起作用，请同时保存第二个字符并从第三个字符开始再次检查。

最终你会得到一系列保存的字符和剩余的回文字符串。

最好的情况是原始字符串*是*回文，在这种情况下堆栈将为空。最坏的情况是剩下一个字符（一个字符的字符串自动成为回文），而所有其他字符都在堆栈中。

您需要添加到原始字符串末尾的字符数是堆栈上的字符数。

要实际制作回文，请将字符一个接一个地从堆栈中弹出，并将它们放在回文字符串的开头和结尾。

例子：

```
String      Palindrome  Stack  Notes
------      ----------  -----  -----
ABBA            Y       -      no characters needed.

String      Palindrome  Stack  Notes
------      ----------  -----  -----
ABB             N       -
BB              Y       A      one character needed.
ABBA            Y       -      start popping, finished.

String      Palindrome  Stack  Notes
------      ----------  -----  -----
FAE             N       -
AE              N       F
E               Y       AF     two characters needed.
AEA             Y       F      start popping.
FAEAF           Y       -      finished.

String      Palindrome  Stack  Notes
------      ----------  -----  -----
FOO             N       -
OO              Y       F      one character needed.
FOOF            Y       -      start popping, finished.

String      Palindrome  Stack  Notes
------      ----------  -----  -----
HAVANNA         N       -
AVANNA          N       H
VANNA           N       AH
ANNA            Y       VAH    three characters needed.
VANNAV          Y       AH     start popping.
AVANNAVA        Y       H
HAVANNAVAH      Y       -      finished. 
```

```
String          Palindrome   Stack      Notes
------          ----------   --------   -----
deoxyribo           N        -
eoxyribo            N        d
oxyribo             N        ed
:                   :        :
bo                  N        iryxoed
o                   Y        biryxoed   eight chars needed.
bob                 Y        iryxoed    start popping.
ibobi               Y        ryxoed
:                   :        :
oxyribobiryxo       Y        ed
eoxyribobiryxoe     Y        d
deoxyribobiryxoed   Y        -          finished. 
```

将此方法转换为“代码”：

```
function evalString(s):
    stack = ""
    while not isPalindrome(s):
        stack = s.char_at(0) + stack
        s = s.substring(1)
    print "Need " + s.length() + " character(s) to make palindrome."
    while stack not equal to "":
        s = stack.char_at(0) + s + stack.char_at(0)
        stack = stack.substring(1)
    print "Palindrome is " + s + "." 
```

对于那些对伪代码不太感兴趣的人，这里有一个 C 语言的测试程序可以解决问题。

```
#include <stdio.h>
#include <string.h>

static char *chkMem (char *chkStr) {
    if (chkStr == NULL) {
        fprintf (stderr, "Out of memory.\n");
        exit (1);
    }
    return chkStr;
}

static char *makeStr (char *oldStr) {
    char *newStr = chkMem (malloc (strlen (oldStr) + 1));
    return strcpy (newStr, oldStr);
}

static char *stripFirst (char *oldStr) {
    char *newStr = chkMem (malloc (strlen (oldStr)));
    strcpy (newStr, &(oldStr[1]));
    free (oldStr);
    return newStr;
}

static char *addFront (char *oldStr, char addChr) {
    char *newStr = chkMem (malloc (strlen (oldStr) + 2));
    sprintf (newStr, "%c%s", addChr, oldStr);
    free (oldStr);
    return newStr;
} 
```

```
static char *addBoth (char *oldStr, char addChr) {
    char *newStr = chkMem (malloc (strlen (oldStr) + 3));
    sprintf (newStr, "%c%s%c", addChr, oldStr, addChr);
    free (oldStr);
    return newStr;
}

static int isPalindrome (char *chkStr) {
    int i1 = 0;
    int i2 = strlen (chkStr) - 1;
    while (i2 > i1)
        if (chkStr[i1++] != chkStr[i2--])
            return 0;
    return 1;
} 
```

```
static void evalString (char *chkStr) {
    char * stack = makeStr ("");
    char * word = makeStr (chkStr);

    while (!isPalindrome (word)) {
        printf ("%s: no, ", word);
        stack = addFront (stack, *word);
        word = stripFirst (word);
        printf ("stack <- %s, word <- %s\n", stack, word);
    }
    printf ("%s: yes, need %d character(s)\n", word, strlen (stack));

    printf ("----------------------------------------\n");
    printf ("Adjusting to make palindrome:\n");
    while (strlen (stack) > 0) {
        printf ("   %s, stack <- %s\n", word, stack);
    word = addBoth (word, *stack);
    stack = stripFirst (stack);
    }
    printf ("   %s\n", word);
    printf ("========================================\n");

    free (word);
    free (stack);
}

int main (int argc, char *argv[]) {
    int i;
    for (i = 1; i < argc; i++) evalString (argv[i]);
    return 0;
} 
```

运行这个：

```
mkpalin abb abba fae foo deoxyribo 
```

给出输出：

```
abb: no, stack <- a, word <- bb
bb: yes, need 1 character(s)
----------------------------------------
Adjusting to make palindrome:
   bb, stack <- a
   abba
======================================== 
```

```
abba: yes, need 0 character(s)
----------------------------------------
Adjusting to make palindrome:
   abba
======================================== 
```

```
fae: no, stack <- f, word <- ae
ae: no, stack <- af, word <- e
e: yes, need 2 character(s)
----------------------------------------
Adjusting to make palindrome:
   e, stack <- af
   aea, stack <- f
   faeaf
======================================== 
```

```
foo: no, stack <- f, word <- oo
oo: yes, need 1 character(s)
----------------------------------------
Adjusting to make palindrome:
   oo, stack <- f
   foof
======================================== 
```

```
deoxyribo: no, stack <- d, word <- eoxyribo
eoxyribo: no, stack <- ed, word <- oxyribo
oxyribo: no, stack <- oed, word <- xyribo
xyribo: no, stack <- xoed, word <- yribo
yribo: no, stack <- yxoed, word <- ribo
ribo: no, stack <- ryxoed, word <- ibo
ibo: no, stack <- iryxoed, word <- bo
bo: no, stack <- biryxoed, word <- o
o: yes, need 8 character(s)
----------------------------------------
Adjusting to make palindrome:
   o, stack <- biryxoed
   bob, stack <- iryxoed
   ibobi, stack <- ryxoed
   ribobir, stack <- yxoed
   yribobiry, stack <- xoed
   xyribobiryx, stack <- oed
   oxyribobiryxo, stack <- ed
   eoxyribobiryxoe, stack <- d
   deoxyribobiryxoed
======================================== 
```

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2011-08-21T16:24:59.033

我曾经在一次比赛中看到过这个问题。那时我被难住了。

但我想我是在和朋友讨论之后才知道的。问题是要找到要插入字符串的最少字符，您需要找到以它为中心的最长回文。

取字符串“accaz”

想象一下字符串 accaz 是在末尾插入 z 的回文 acca。所以我们需要在开头添加另一个z。另一个字符串：“mykma”

想象这是 mym，其中插入了两个字符 k 和 a。所以我们需要再增加两个字符来使它成为回文。（回文将是 amkykma）。

我已经用 Java 编写了一个程序来实现这一点。

```
import java.util.*;
import java.io.*;
public class MinPalin{

//Function to check if a string is palindrome
public boolean isPaindrome(String s){
    int beg=0;
    int end=s.length()-1;

    while(beg<end){
        if(s.charAt(beg)!=s.charAt(end)){
            return false;

        }
        beg++;
        end--;
    }

    return true;

}

public int MinInsert(String s){
    int min=0;
    if(isPaindrome(s)){
        return min;
    }

    min++;

    while(true){
        ArrayList<String> temp=comboes(s,min);
        if(hasPalindrome(temp)){
            return min;
        }
        else
            min++;
    }

}

/*
 * Returns an arraylist of strings, in which n characters are removed
* 
*/

public ArrayList<String> comboes(String s,int n){

    ArrayList<String> results=new ArrayList<String>();

    if(n==1){

        for(int i=0;i<s.length();i++){
            String text="";
            for(int j=0;j<s.length();j++){
                if(i!=j){

                    text=text+""+s.charAt(j);
                }

            }
            results.add(text);

        }

    }
    else{
        ArrayList<String> temp=new ArrayList<String>();

        for(int i=0;i<s.length();i++){
            String tempString="";
            for(int j=0;j<s.length();j++){
                if(i!=j){
                    tempString=tempString+s.charAt(j);
                }
            }
            temp=comboes(tempString, n-1);

            for(int j=0;j<temp.size();j++){
                results.add(""+temp.get(j));
            }
        }
    }

    return results;

}

public boolean hasPalindrome(ArrayList<String> text){
    for(String temp:text){
        if(isPaindrome(temp)){
            return true;
        }
    }

    return false;
}

public static void main(String[] args)throws IOException
 {
     System.out.println("Enter the word :");
     MinPalin obj=new MinPalin();
     BufferedReader r=new BufferedReader(new InputStreamReader(System.in));
     int n=obj.MinInsert(r.readLine());
     System.out.println("Characters needed : "+n);
    }
} 
```

希望这可以帮助。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2009-05-24T07:47:59.783

简单地

```
static int GetNumForPalindrome(string str)
    {
        int count = 0;
        for (int start = 0, end = str.Length - 1; start < end; ++start)
        {
            if (str[start] != str[end])
                ++count;
            else --end;
        }
        return count;
    }
    static void Main(string[] args)
    {
        while (true)
        {
            Console.WriteLine(GetNumForPalindrome(Console.ReadLine()).ToString());

        }

    } 
```

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2009-05-24T17:24:02.193

这就像找到两个字符串之间的编辑距离，这是一个标准的动态规划问题。您知道字符串的长度，因此将字符串分成两半。您需要找到要添加的最少字符数才能将一个字符串转换为另一个字符串。修改后的[编辑距离算法](http://en.wikipedia.org/wiki/Edit_distance)现在可用。

使用此算法，您可以解决**O(n^2)**中的问题。

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2009-05-25T00:25:54.063

除了 Pax 的回应。您可以使用“弦学珠宝”中描述的线性时间 Manacher 算法来计算文本中回文的半径。使用它，您可以轻松地以线性时间计算文本结尾处最长回文的长度。我认为这将 Pax 的算法加速到线性时间。

编辑：

Pax 的算法假设您只能在字符串末尾添加字符。用 BAAAABAAB 试试，你会得到 BAAABAABAAAB，但是如果你只能在末尾或开头添加，你可以通过一次插入或 BAABAAABAAB 将它变成 BAABAAABAAB。

* * *

## 回答 #6

> 赞同：1
> 
> 时间：2012-03-28T08:42:49.727

蟒蛇解决方案：

```
import math

def isPalindrome(s):
    return s[:len(s)/2] == s[int(math.ceil(len(s)/2.0)):][::-1]

def numPalindrome(s):
    for i in range(len(s)):
        if isPalindrome(s[:len(s) - i]) or isPalindrome(s[i:]):
            return i 
```

* * *

## 回答 #7

> 赞同：1
> 
> 时间：2012-04-14T06:45:37.113

我认为一个更简单的解决方案是在字符串中找到子回文的开头，逐个字符移动。

```
void makePalindrome(const char* str)
{
    int len = strlen(str);
    int fp=0, bp=len-1, begin=0, end=bp;
    // fp and bp are used to look for matches.
    // begin and end represent the begin and end of a possible sub palindrome
    while(fp < bp)
    {
        if(str[fp] == str[bp])
        {
            fp++;             //move back and front pointers.
            bp--;
        }
        else{
            if(bp == end)     //If no match found yet, just move forward.
            {
                fp++;
                begin++;
            }
            else 
            {
                begin++;      //Since begin isn't feasible, move begin forward
                fp = begin;   //Reset fp and bp to their respective positions.
                bp = end;
            }
        }
    }
    int minLenPal = len + begin; //Minimum Length of Palindrome
    char a[minLenPal+1];        

    {   //Build the Palindrome a
        strcpy(a,str);
        for(int i = 0; i< begin; i++) 
            a[minLenPal-i-1] = str[i];
        a[minLenPal] ='\0';
    }

    cout<<"For String "<<str<<", minimum characters to be added is "
        <<begin<<". Palindrome is "<<a<<endl;
} 
```

这是我的第一篇文章，所以请编辑任何格式错误。

* * *

## 回答 #8

> 赞同：0
> 
> 时间：2009-05-24T06:12:53.127

制作一个接受字符串和数字 n 的函数，然后尝试通过添加 n 个附加字符将字符串变为回文......
对于 n = 0 ..
对于 n = 1 不执行任何操作.. 附加第一个字符 .. 等等在
从 n=0 到初始字符串的长度运行此函数时。
它返回成功的第一个数字 n ..这就是你的答案

* * *

## 回答 #9

> 赞同：0
> 
> 时间：2011-08-22T16:35:48.683

这是我的 2 美分。可能不是最快的，但如果您喜欢 Lambdas，它会简洁明了。

```
 static void Main(string[] args)
    {
        string pal = "ABB";
        Console.WriteLine(minPallyChars(pal).ToString());
    }

    static int minPallyChars(string pal)
    {
        return Enumerable.Range(0, pal.Length).First(x => IsPally(pal + ReverseStr(pal.Substring(0, x))));
    }

    static bool IsPally(string value)
    {
        return value == ReverseStr(value);
    }
    public static string ReverseStr(string value)
    {
        return new string(value.Reverse().ToArray());
    } 
```

* * *

## 回答 #10

> 赞同：0
> 
> 时间：2013-08-07T13:10:57.037

```
#include <iostream>
#include<string.h>
    using namespace std;
    int f(char t[],int i,int j)
    {
        int c1=0,c2=0,c3=0;
        int r;
        if(i<j)
        {
            if(t[i]==t[j])
            {
                c3=f(t,i+1,j-1);
                cout<<"3 "<<c3<<"\n";
                return c3;
            }
            else
            {
                c1=f(t,i+1,j);
                cout<<"c1 "<<c1<<"\n";
                c2=f(t,i,j-1);
            cout<<"c2 "<<c2<<"\n";
            if(c1<c2)
            {
                c1++;
                cout<<"1 "<<c1<<"\n";
                return c1;
            }
            if(c2<c1)
            {
                c2++;
                cout<<"2 "<<c2<<"\n";
                return c2;
            }
            if(c1==c2)
            {
                c1++;
                c2++;
                cout<<"4 "<<c1<<"\n";
                return c1;
            }
        }
    }
    if(i>=j)
    {
        cout<<"5 "<<c1<<"\n";
        return c1;
    }
}
int main()
{
    int i,j,c=0,n=0;
    char s[10];
    cout<<"enter the string";
    cin>>s;
    for(i=0;s[i]!='\0';i++)
        n++;
    i=0;
    j=n-1;
    c=f(s,i,j);
    cout<<c;
    return 0;
} 
```

# java - EJB3 bean 中的可选注入或运行时依赖项检查

> ID：903177
> 
> 赞同：3
> 
> 时间：2009-05-24T05:46:08.347
> 
> 标签：java, jakarta-ee, dependency-injection, annotations, ejb-3.0

我想定义注入，以便只有注入的接口具有 EJB 才会被注入。它用作主 EJB 的插件。这该怎么做？对此有一些注释吗？

我可以使用@PostConstruct 手动“注入”变量。但是我必须自己处理依赖关系。知道其中一个是可选的，我如何处理依赖项？如何处理不同依赖模块的部署顺序。

**更新：** 我看到谷歌有一个带有`optional`参数的注入注释：

```
import com.google.inject.Inject;
@Inject(optional = true) 
```

**更新 2：** JBoss 有一些我正在寻找的东西：

```
import org.jboss.annotation.IgnoreDependency;
@IgnoreDependency @EJB OtherBean otherBean; 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2010-09-01T09:23:30.193

在这种特殊情况下，解决方案是使用 JNDI 而不是注入。这样我就可以完全控制依赖关系。

# delphi - 如何在 Delphi 中进行屏幕保护程序预览？

> ID：903180
> 
> 赞同：5
> 
> 时间：2009-05-24T05:48:16.390
> 
> 标签：delphi, screensaver

我希望我的屏幕保护程序出现在屏幕保护程序预览框中？

* * *

## 回答 #1

> 赞同：10
> 
> 时间：2009-05-24T06:22:28.070

当您制作屏幕保护程序时，您需要支持命令行参数 (/p [HWND])，它会告诉您在哪些窗口中显示屏幕保护程序。命令行将通过屏幕保护程序控制面板传递给您。[这是完整规范的链接](http://support.microsoft.com/kb/182383)。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-05-25T10:13:26.333

您可以启动屏幕保护程序，获取它的窗口句柄，然后将其父级更改为您的表单句柄或面板的句柄或您想要的任何位置。

# membership - 会员提供者

> ID：903187
> 
> 赞同：3
> 
> 时间：2009-05-24T05:56:09.323
> 
> 标签：membership, provider

如何设置我的 web.config 以使用表单身份验证，将成员资格提供程序设置为 ActiveDirectoryMembershipProvider 并使用内置登录控件。这样我就可以使用有效的活动目录用户名和密码登录我的 Web 应用程序？？？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-05-24T06:05:41.613

查看[ActiveDirectoryMembershipProvider](http://msdn.microsoft.com/en-us/library/ms998347.aspx)的演练。

# java - 在 Java 和 C++ 之间同步日期

> ID：903191
> 
> 赞同：1
> 
> 时间：2009-05-24T05:58:52.767
> 
> 标签：java, c++, dst

我有一个在未连接到互联网的设备上运行的应用程序。操作系统是 Windows XP。有 C++ 模块和 Java 模块通过套接字进行交互。Java 部分需要根据其日期和时间从 C++ 部分获取文件。当 DST 开关到达时，他们停止工作。似乎 C++ 忽略了 DST，因为 Windows 没有下载每年的 DST 更新，而 Java 根据它拥有的一些内部表来处理 DST。我正在编程的设备必须能够连续运行，与网络断开连接并在不同的国家/地区运行。我的问题是：如何让 Java 和 C++ 都忽略外部更新并根据一些预定义的 DST 表进行操作。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-05-24T14:04:45.953

将日期编码为包含时区信息的字符串（[ISO 8601](http://en.wikipedia.org/wiki/ISO_8601)是最完整的标准）。使用一个好的框架来解析每一侧的格式。Boost (C++) 和 Joda (Java) 对此提供了极好的支持。

纪元时间对您不起作用，因为它不代表时区。

如果您需要调整时区以使用它进行集中工作，那么请在 UTC 上标准化，并允许客户端将日期/时间调整到其区域设置以用于显示目的或用于本地操作。否则，如果所有操作和显示都在本地时区完成，则只需在本地时区存储/检索日期/时间。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-05-24T11:18:00.483

我建议您使用 GMT+0 记录所有日期，并仅在显示时调整时间。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-05-24T06:24:36.083

您是否必须使用对 DST 敏感的时间表示？您可以使用 Unix 时间（这可能是我会使用的时间）、TAI 或任何其他时间 - [某个时代] 系统，而不必担心夏令时或闰秒之类的事情。

# php - 如何在 Eclipse PDT 中打开新的浏览器选项卡？

> ID：903197
> 
> 赞同：1
> 
> 时间：2009-05-24T06:03:09.403
> 
> 标签：php, eclipse, eclipse-pdt

当我在 Eclipse 环境中运行 PHP 脚本时，我可以选择不同的浏览器来呈现我的页面，并且可以得到不同的结果。

但是结果仍然全部显示在eclipse本身的浏览器输出窗口中。

如何提示 eclipse 在浏览器本身中使用 php 页面实际打开一个新选项卡。我知道它可以通过“外部工具”来完成，只是不知道如何配置它。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-05-24T07:49:09.253

从主菜单 -> Windows -> 首选项 -> 常规 -> 浏览器 -> 选择外部浏览器单选按钮和您的首选浏览器。

享受 ;) 罗伊

# ruby - 机械化html抓取问题

> ID：903202
> 
> 赞同：3
> 
> 时间：2009-05-24T06:09:30.450
> 
> 标签：ruby, screen-scraping, mechanize

所以我正在尝试使用 ruby​​ mechanize 和 hpricot 提取我网站的电子邮件。我试图在我的管理方面的所有页面上进行循环并使用 hpricot.so 解析页面到目前为止一切都很好。然后我得到：

```
Exception `Net::HTTPBadResponse' at /usr/lib/ruby/1.8/net/http.rb:2022 - wrong status line: *SOME HTML CODE HERE* 
```

当它解析一堆页面时，它以超时开始，然后打印页面的 html 代码。不明白为什么？我该如何调试呢？似乎机械化可以连续获得超过10页？？是否可以？？谢谢

```
 require 'logger'
require 'rubygems'
require 'mechanize'
require 'hpricot'
require 'open-uri'

class Harvester

def initialize(page)
    @page=page
    @agent = WWW::Mechanize.new{|a| a.log = Logger.new("logs.log") }
    @agent.keep_alive=false
    @agent.read_timeout=15

end

def login
    f = @agent.get( "http://****.com/admin/index.asp") .forms.first
    f.set_fields(:username => "user", :password =>"pass")
        f.submit

  end

def harvest(s)
    pageNumber=1
    #@agent.read_timeout = 
    s.upto(@page) do |pagenb|

```
 puts "*************************** page= #{pagenb}/#{@page}***************************************"      
    begin
        #time=Time.now
        #search=@agent.get( "http://****.com/admin/members.asp?action=search&term=&state_id=&r=500&p=#{page}")          
        extract(pagenb)

    rescue => e
        puts  "unknown #{e.to_s}"
        #puts  "url:http://****.com/admin/members.asp?action=search&term=&state_id=&r=500&p=#{page}"
        #sleep(2)
        extract(pagenb)

    rescue Net::HTTPBadResponse => e
        puts "net exception"+ e.to_s
    rescue WWW::Mechanize::ResponseCodeError => ex
        puts "mechanize error: "+ex.response_code   
    rescue Timeout::Error => e
        puts "timeout: "+e.to_s
    end

end 
```

end

def extract(page)
      #puts search.body
            search=@agent.get( "http://***.com/admin/members.asp?action=search&term=&state_id=&r=500&p=#{page}")
            doc = Hpricot(search.body)

```
 #remove titles
        #~ doc.search("/html/body/div/table[2]/tr/td[2]/table[3]/tr[1]").remove 

        (doc/"/html/body/div/table[2]/tr/td[2]/table[3]//tr").each do |tr|              
            #delete the phone number from the html
            temp = tr.search("/td[2]").inner_html
            index = temp.index('<')
            email = temp[0..index-1]
            puts  email
            f=File.open("./emails", 'a')
            f.puts(email)
            f.close     
        end 
```

end

end

puts "starting extacting emails ... "

start =ARGV[0].to_i

h=Harvester.new(186)
h.login
h.harvest(start) 
            回答 #1

赞同：3

时间：2009-08-27T14:12:22.287

Mechanize 将页面的全部内容放入历史记录中，这可能会在浏览多个页面时导致问题。要限制历史的大小，请尝试

```
@mech = WWW::Mechanize.new do |agent|
  agent.history.max_size = 1
end 
```

        php - 如何使用 PHP 将日期显示为 iso 8601 格式

ID：903203

赞同：72

时间：2009-05-24T06:12:15.970

标签：php, mysql, date, date-format, time-format

我正在尝试使用 PHP 将我的 MySQL 数据库中的日期时间显示为 iso 8601 格式的字符串，但它出现了错误。

2008 年 10 月 17 日发布为：1969-12-31T18:33:28-06:00，这显然是不正确的（年份应该是 2008 年而不是 1969 年）

这是我正在使用的代码：

```
<?= date("c", $post[3]) ?> 
```

`$post[3] is the datetime (CURRENT_TIMESTAMP)`来自我的 MySQL 数据库。

任何想法出了什么问题？

            回答 #1

赞同：93

时间：2009-05-24T06:15:50.127

的第二个参数[`date`](http://www.php.net/date)是 UNIX 时间戳，而不是数据库时间戳字符串。

您需要使用[strtotime](http://www.php.net/strtotime)转换数据库时间戳。

```
<?= date("c", strtotime($post[3])) ?> 
```

            回答 #2

赞同：41

时间：2013-01-29T19:48:06.013

使用 PHP 5.2 版中提供的[DateTime 类](http://www.php.net/manual/en/book.datetime.php)，可以这样完成：

```
$datetime = new DateTime('17 Oct 2008');
echo $datetime->format('c'); 
```

从 PHP 5.4 开始，您可以将其作为单行来执行：

```
echo (new DateTime('17 Oct 2008'))->format('c'); 
```

            回答 #3

赞同：20

时间：2016-02-20T13:19:55.337

程序风格：

```
echo date_format(date_create('17 Oct 2008'), 'c');
// Output : 2008-10-17T00:00:00+02:00 
```

面向对象风格：

```
$formatteddate = new DateTime('17 Oct 2008');
echo $datetime->format('c');
// Output : 2008-10-17T00:00:00+02:00 
```

混合 1：

```
echo date_format(new DateTime('17 Oct 2008'), 'c');
// Output : 2008-10-17T00:00:00+02:00 
```

混合 2：

```
echo date_create('17 Oct 2008')->format('c');
// Output : 2008-10-17T00:00:00+02:00 
```

备注：

1）您也可以用作格式`'Y-m-d\TH:i:sP'`的替代品。`'c'`

2）您输入的默认时区是您的服务器的时区。如果您希望输入用于不同的时区，则需要明确设置您的时区。但是，这也会影响您的输出：

```
echo date_format(date_create('17 Oct 2008 +0800'), 'c');
// Output : 2008-10-17T00:00:00+08:00 
```

3) 如果您希望输出的时区与输入的时区不同，您可以明确设置您的时区：

```
echo date_format(date_create('17 Oct 2008')->setTimezone(new DateTimeZone('America/New_York')), 'c');
// Output : 2008-10-16T18:00:00-04:00 
```

            回答 #4

赞同：8

时间：2010-04-08T14:32:18.377

对于 PHP 5 之前的版本：

```
function iso8601($time=false) {
    if(!$time) $time=time();
    return date("Y-m-d", $time) . 'T' . date("H:i:s", $time) .'+00:00';
} 
```

            回答 #5

赞同：8

时间：2010-11-04T14:02:27.363

这是 PHP 5 之前的好功能：我在最后添加了 GMT 差异，它不是硬编码的。

```
function iso8601($time=false) {
    if ($time === false) $time = time();
    $date = date('Y-m-d\TH:i:sO', $time);
    return (substr($date, 0, strlen($date)-2).':'.substr($date, -2));
} 
```

            回答 #6

赞同：7

时间：2020-05-14T11:53:06.733

问题多次出现在**4 或 8**决赛中的毫秒和最终微秒。要将**DATE 转换为 ISO 8601 ** **“date(DATE_ISO8601)”**，这些是适合我的解决方案之一：

```
// In this form it leaves the date as it is without taking the current date as a reference
$dt = new DateTime();
echo $dt->format('Y-m-d\TH:i:s.').substr($dt->format('u'),0,3).'Z';
// return-> 2020-05-14T13:35:55.191Z

// In this form it takes the reference of the current date
echo date('Y-m-d\TH:i:s'.substr((string)microtime(), 1, 4).'\Z');
return-> 2020-05-14T13:35:55.191Z

// Various examples:
$date_in = '2020-05-25 22:12 03.056';
$dt = new DateTime($date_in);
echo $dt->format('Y-m-d\TH:i:s.').substr($dt->format('u'),0,3).'Z';
// return-> 2020-05-25T22:12:03.056Z

//In this form it takes the reference of the current date
echo date('Y-m-d\TH:i:s'.substr((string)microtime(), 1, 4).'\Z',strtotime($date_in));
// return-> 2020-05-25T14:22:05.188Z 
```

        c - 流行语言内部如何实现哈希表？

ID：903207

赞同：26

时间：2009-05-24T06:16:22.887

标签：c, hashtable

有人可以解释一下 Python、Ruby 等流行语言如何在内部实现哈希表以进行符号查找吗？他们是使用经典的“带有链表的数组”方法，还是使用平衡树？

我需要一种简单（更少的 LOC）和快速的方法来索引用 C 编写的 DSL 中的符号。想知道其他人发现什么最有效和实用。

            回答 #1

赞同：17

时间：2009-05-24T07:29:39.433

您提到的经典“哈希桶数组”在我见过的每个实现中都使用过。

最具教育意义的版本之一是 Tcl 语言中的哈希实现，位于文件[tcl/generic/tclHash.c](http://tcl.cvs.sourceforge.net/viewvc/tcl/tcl/generic/tclHash.c?revision=1.38&view=markup "tclHash.c")中。文件中超过一半的行是详细解释*所有内容*的注释：分配、搜索、不同的哈希表类型、策略等。旁注：实现 Tcl 语言的代码*确实*可读。

            回答 #2

赞同：12

时间：2009-05-24T07:51:21.823

Perl 使用带有链表的数组来保存冲突。它有一个简单的启发式方法，可以根据需要自动将数组的大小加倍。还有一些代码可以在哈希之间共享密钥以节省一点内存。您可以在“HV”下的过时但仍然相关的[Perl Illustrated Guts中阅读有关它的内容。](http://www.perl.org/tpc/1998/Perl_Language_and_Modules/Perl%20Illustrated/)如果你真的很喜欢冒险，你可以深入[研究 hv.c](http://github.com/github/perl/blob/e69c155ade49d196491f1d9c96c161b71bb34010/hv.c)。

散列算法过去非常简单，但现在使用 Unicode 可能要复杂得多。因为算法是可预测的，所以存在 DoS 攻击，攻击者生成的数据会导致哈希冲突。例如，作为 POST 数据发送到网站的大量密钥列表。Perl 程序可能会将其拆分并将其转储到一个散列中，然后将其全部推入一个桶中。结果哈希是 O(​​n) 而不是 O(1)。向服务器抛出大量 POST 请求，您可能会阻塞 CPU。结果，Perl 现在用一些随机数据扰乱了散列函数。

您可能还想看看[Parrot 如何实现基本哈希](http://repo.or.cz/w/parrot.git?a=blob;f=src/hash.c;h=6d5dc0d11fc3d196de964b04696a992bc0dd3248;hb=HEAD)，这比 Perl 5 实现要可怕得多。

至于“最高效实用”，就用别人的hash库吧。看在上帝的份上，不要自己写一个用于生产用途。那里已经有一个强大而高效的工具。

            回答 #3

赞同：8

时间：2009-05-26T03:39:12.773

[Lua](http://www.lua.org)表使用了一种[非常巧妙的实现](http://www.tecgraf.puc-rio.br/~lhf/ftp/doc/jucs05.pdf)，对于任意键，它的行为类似于“桶数组”，但是如果您使用连续整数作为键，它具有与数组相同的表示和空间开销。在实现中，每个表都有一个*散列部分*和一个*数组部分*。

我认为这很酷:-)

            回答 #4

赞同：4

时间：2009-05-24T06:22:15.230

平衡树有点违背哈希表的目的，因为哈希表可以在（摊销的）恒定时间内提供查找，而平衡树上的平均查找是 O(log(n))。

如果您有足够的存储桶，单独的链接（带有链表的数组）确实可以很好地工作，并且您的链表实现使用池分配器而不是 malloc() 单独从堆中处理每个节点。我发现它在适当调整后与任何其他技术一样具有性能，并且编写起来非常容易和快速。尝试从源数据的 1/8 开始。

您还可以[像 Python 那样](http://svn.python.org/view/python/trunk/Objects/dictobject.c?view=markup)使用具有二次或多项式探测的[开放寻址](http://en.wikipedia.org/wiki/Open_addressing)。

            回答 #5

赞同：4

时间：2009-05-24T07:24:02.003

[Attractive Chaos](http://attractivechaos.wordpress.com/)有一个[Hash Table Libraries 的比较](http://attractivechaos.wordpress.com/2008/08/28/comparison-of-hash-table-libraries/)和一个[更新](http://attractivechaos.wordpress.com/2008/10/07/another-look-at-my-old-benchmark/)。源代码是可用的，它是 C 和 C++

            回答 #6

赞同：2

时间：2009-05-24T14:26:36.673

如果您可以阅读`Java`，您可能想查看其各种地图实现的源代码，特别`HashMap`是`TreeMap`和`ConcurrentSkipListMap`。后两者保持键有序。

Java`HashMap`使用您提到的在每个存储桶位置链接的标准技术。它使用相当弱的 32 位哈希码并将键存储在表中。Numerical Recipes 作者还给出了一个哈希表的示例（用 C 语言），其结构基本上类似于 Java，但其中 (a) 您从数组中分配桶列表的节点，并且 (b) 您使用更强大的 64 位哈希编码并省去在表中存储密钥。

            回答 #7

赞同：1

时间：2009-05-24T07:24:34.183

Crashworks 的意思是……

哈希表的目的是恒定时间查找、添加和删除。就算法而言，所有操作的操作都是 O(1) 摊销的。而如果您使用树...对于平衡树，最坏情况下的操作时间将是 O(log n)。N 是节点数。但是，我们真的将哈希实现为树吗？

        grails - 多对多不存在于 gorm/grails 应用程序中

ID：903214

赞同：2

时间：2009-05-24T06:23:09.643

标签：grails, many-to-many, grails-orm

我的 grails 1.1 应用程序中大致有以下内容

```
class AppCategory {
    static belongsTo = App
    static hasMany   = [ apps: App ]
    String name
}

class App {
    static hasMany = [ categories: AppCategory]
    String name
}

App app = new App()
AppCategory appCat = AppCategory.findByName('blah')
app.addToCategories(appCat)
app.save() 
```

创建了正确的表（app、app_category 和 app_categories）并且列看起来都很好，但我最终没有在关联表中得到任何记录，也没有错误。app_category 表和 app 表已正确填充。

我是否需要手动管理关联表的域对象？或者更好的是，我只是错过了一些完全明显的东西吗？

            回答 #1

赞同：6

时间：2009-05-24T22:52:22.520

好吧，上面的示例中没有表示的一件事是，您没有为 App 实例命名，即使它是必填字段（grails 字段默认为 nullable:false，除非您另有明确说明）。我敢打赌，如果你检查

```
app.hasErrors() 
```

在你的 app.save() 之后，你会看到它确实有你可以在 app.errors 集合中列出的错误。

否则，您所拥有的一切都很好，并且这段代码对我来说与您上面拥有的域对象一起工作得很好：

```
AppCategory appCat = new AppCategory(name: "blah")    
appCat.save()    
assert !appCat.hasErrors()

App app = new App(name: "testApp")
app.addToCategories(appCat)    
app.save()    
assert !app.hasErrors() 
```

        c++ - 按 Enter 继续

ID：903221

赞同：40

时间：2009-05-24T06:32:05.007

标签：c++, string, newline, cin

这不起作用：

```
string temp;
cout << "Press Enter to Continue";
cin >> temp; 
```

            回答 #1

赞同：82

时间：2009-05-24T06:36:06.873

```
cout << "Press Enter to Continue";
cin.ignore(); 
```

或更好：

```
#include <limits>
cout << "Press Enter to Continue";
cin.ignore(std::numeric_limits<streamsize>::max(),'\n'); 
```

            回答 #2

赞同：9

时间：2009-05-24T06:36:01.647

尝试：

```
char temp;
cin.get(temp); 
```

或者，更好的是：

```
char temp = 'x';
while (temp != '\n')
    cin.get(temp); 
```

我认为字符串输入会等到您输入真实字符，而不仅仅是换行符。

            回答 #3

赞同：8

时间：2009-05-24T06:38:38.740

将您的替换`cin >> temp`为：

```
temp = cin.get(); 
```

[http://www.cplusplus.com/reference/iostream/istream/get/](http://www.cplusplus.com/reference/iostream/istream/get/)

`cin >>`将等待 EndOfFile。默认情况下， cin 将设置*[skipws](http://www.cplusplus.com/reference/iostream/manipulators/ws/)*标志，这意味着它在提取并放入字符串之前会“跳过”任何空格。

            回答 #4

赞同：2

时间：2015-05-19T23:02:45.230

尝试：

```
cout << "Press Enter to Continue";
getchar(); 
```

成功时，返回读取的字符（提升为`int`值，`int getchar ( void );`），可用于测试块（`while`等）。

            回答 #5

赞同：2

时间：2017-01-15T11:01:11.790

你需要包含 conio.h 所以试试这个，很简单。

```
#include <iostream>
#include <conio.h>

int main() {

  //some code like
  cout << "Press Enter to Continue";
  getch();

  return 0;
} 
```

有了它，您就不需要字符串或 int 了`getch();`

            回答 #6

赞同：1

时间：2017-12-13T13:43:58.747

函数[std::getline](http://en.cppreference.com/w/cpp/string/basic_string/getline)（已经在 C++98 中引入）提供了一种可移植的方式来实现它：

```
#include <iostream>
#include <string>

void press_any_key()
{
    std::cout << "Press Enter to Continue";
    std::string temp;
    std::getline(std::cin, temp);
} 
```

在我观察到没有返回空输入后，我发现了这个[问题](https://stackoverflow.com/q/33686108/2932052)和[答案。](https://stackoverflow.com/a/33686134/2932052)`std::cin >> temp;`所以我想知道如何处理可选的用户输入（这对于字符串变量当然可以为空是有意义的）。

            回答 #7

赞同：0

时间：2020-01-31T23:06:54.487

还有另一种解决方案，但适用于 C。需要 Linux。

```
#include <stdio.h>
#include <stdlib.h>

int main(void) {
    printf("Press any key to continue...");
    system("/bin/stty raw"); //No Enter
    getchar();
    system("/bin/stty cooked"); //Yes Enter
    return 0;
} 
```

        c++ - 为什么使用预编译头文件 (C/C++)？

ID：903228

赞同：52

时间：2009-05-24T06:35:24.347

标签：c++, precompiled-headers

为什么要使用预编译头文件？

阅读回复，我怀疑我对他们所做的事情有点愚蠢：

```
#pragma once

// Defines used for production versions

#ifndef PRODUCTION
#define eMsg(x) (x) // Show error messages
#define eAsciiMsg(x) (x)
#else
#define eMsg(x) (L"") // Don't show error messages
#define eAsciiMsg(x) ("")
#endif // PRODUCTION

#include "targetver.h"
#include "version.h"

// Enable "unsafe", but much faster string functions
#define _CRT_SECURE_NO_WARNINGS
#define _SCL_SECURE_NO_WARNINGS

// Standard includes
#include <stdio.h>
#include <tchar.h>
#include <iostream>
#include <direct.h>
#include <cstring>
#ifdef _DEBUG
#include <cstdlib>
#endif

// Standard Template Library
#include <bitset>
#include <vector>
#include <list>
#include <algorithm>
#include <iterator>
#include <string>
#include <numeric>

// Boost libraries
#include <boost/algorithm/string.hpp>
#include <boost/lexical_cast.hpp>
#include <boost/scoped_array.hpp>

//Windows includes
#define WIN32_LEAN_AND_MEAN
#include <windows.h>
#include "FILETIME_Comparisons.h"
#include <shlwapi.h>
#include <Shellapi.h>
#include <psapi.h>
#include <imagehlp.h>
#include <mscat.h>
#include <Softpub.h>
#include <sfc.h>
#pragma comment(lib, "wintrust.lib")
#pragma comment(lib,"kernel32.lib")
#pragma comment(lib,"Psapi.lib")
#pragma comment(lib,"shlwapi.lib")
#pragma comment(lib,"imagehlp.lib")
#pragma comment(lib,"Advapi32.lib")
#pragma comment(lib,"Shell32.lib")
#pragma comment(lib,"Sfc.lib")
#pragma comment(lib,"Version.lib")

// Crypto ++ libraries
#ifdef _DEBUG
#pragma comment(lib,"cryptlibd.lib")
#else
#pragma comment(lib,"cryptlib.lib")
#endif
#define CRYPTOPP_ENABLE_NAMESPACE_WEAK 1
#include <md5.h>
#include <sha.h>

// String libraries
#include "stringUnicodeConversions.h"
#include "expandEnvStrings.h"
#include "randomString.h"
#include "getShortPathName.h"

// Regular Expression Libraries
#include "fpattern.h"

// File Result Record
#include "unixTimeToFileTime.h"
#include "fileData.h"

// Writer
#include "writeFileData.h"

// Criteria Structure System
#include "priorities.h"
#include "criterion.H"
#include "OPSTRUCT.H"
#include "regexClass.H"
#include "FILTER.h"

// Sub Programs Root Class
#include "subProgramClass.h"

// Global data
#include "globalOptions.h"

// Logger
#include "logger.h"

// Console parser
#include "consoleParser.h"

// Timeout handler
#include "timeoutThread.h"

// Zip library
#include "zip.h"
#include "unzip.h"
#include "zipIt.h"

// Scanner
#include "mainScanner.h"
#include "filesScanner.h"

// Sub Programs
#include "volumeEnumerate.h"
#include "clsidCompressor.h"
#include "times.h"
#include "exec.h"
#include "uZip.h"

// 64 bit support
#include "disable64.h" 
```

            回答 #1

赞同：69

时间：2009-05-24T06:45:01.223

在 C/C++ 中，#include 机制是指定到当前文件的文件的文本副本。标头包括其他标头（其中还包括其他标头），因此当您执行 a 时`#include`，可能会在每个 cpp 文件（或 cxx、c 等）中添加数万行 C++，所有这些都需要分别编译时间。对于大型项目来说，这可能是一个严重的瓶颈。
预编译的头文件通过将每个头文件编译一次，然后将编译后的状态包含在它们所在的 cpp 中来加快速度。

            回答 #2

赞同：43

时间：2009-05-24T06:37:24.560

它编译得*更快*。没有它们，C++ 编译需要数年时间。尝试在大型项目中比较一些时间！

            回答 #3

赞同：12

时间：2009-05-24T06:50:20.963

回复：您当前的使用情况，如果您有一个包含大量文件的目标，那么以这种方式使用 PCH 可能仍然更快 - 尝试关闭它们以找出答案。这取决于：如果您有很多自己的标头，并且您很少更改它们，并且您有大量源文件并且您更频繁地更改，那么您的 PCH 使用将减少重建时间。

但通常的建议是只将永远不会改变的东西放在 PCH 中，因为生成 PCH 本身会产生一定的开销。如果你在每次重建时触发它（通过不断调整你的一个标题），使用 PCH 可能会使重建速度变慢。

            回答 #4

赞同：7

时间：2009-05-24T06:37:03.873

因此，您不必每次构建项目时都编译它们。它们用于不会更改的系统标头。

            回答 #5

赞同：7

时间：2009-05-24T06:41:11.543

它加快了编译速度。

当您包含来自其他项目的标头时，您不希望更改它们。如果您将它们放入预编译的头文件中，那么当您对源代码进行更改时，就不必重新编译该代码。这减少了未更改代码的重复编译，加快了编译时间。

        python - 如何在 Mac OS X 上安装 Python Imaging Library？

ID：903242

赞同：6

时间：2009-05-24T06:47:30.327

标签：python, macos, module

我是一个非常业余的程序员；我做过一些休闲算法编程，但老实说，我不知道库和编程语言是如何真正结合在一起的。我应该在一个需要一些图像处理的项目上工作，所以我一直在尝试安装 PIL 一段时间，但我一直没能。

我去了[http://www.pythonware.com/products/pil/](http://www.pythonware.com/products/pil/)并下载了“Python Imaging Library 1.1.6 Source Kit（所有平台）（440k TAR GZ）（2006 年 12 月 3 日）”。然后我在命令提示符下打开文件夹并运行

```
$ python setup.py build_ext -i . 
```

这是我得到的输出：

```
running build_ext

--- using frameworks at /System/Library/Frameworks

building '_imaging' extension

gcc -fno-strict-aliasing -Wno-long-double -no-cpp-precomp -mno-fused-madd -fno-common -dynamic -DNDEBUG -g -Os -Wall -Wstrict-prototypes -DMACOSX -I/usr/include/ffi -DENABLE_DTRACE -arch i386 -arch ppc -pipe -DHAVE_LIBZ -IlibImaging -I/opt/local/include -I/System/Library/Frameworks/Python.framework/Versions/2.5/include -I/usr/local/include -I/usr/include -I/System/Library/Frameworks/Python.framework/Versions/2.5/include/python2.5 -c _imaging.c -o build/temp.macosx-10.5-i386-2.5/_imaging.o

unable to execute gcc: No such file or directory

error: command 'gcc' failed with exit status 1 
```

“导入图像”在我尝试时产生了错误。

你们知道发生了什么吗？我正在使用带有 Core 2 Duo 的 MacBook Pro。

如果这是荒谬的愚蠢，我真的很抱歉。

            回答 #1

赞同：4

时间：2009-05-24T07:00:48.117

实际上，假设您仍在使用 OS X 附带的默认 2.5.x Python（至少从 10.5.6 开始），它有一个[预构建的安装程序包](http://pythonmac.org/packages/py25-fat/index.html)（下载[PIL 的 dmg](http://pythonmac.org/packages/py25-fat/dmg/PIL-1.1.6-py2.5-macosx10.4-2007-05-18.dmg)）。

否则，您需要从源代码构建它——这确实需要 mac 开发工具——或者使用[MacPorts](http://www.macports.org/)或[fink安装它](http://www.finkproject.org/)

**编辑：**  单声道说得很好，除非您使用预构建的安装程序，否则您仍然需要开发工具。

            回答 #2

赞同：3

时间：2009-05-24T06:52:13.003

您需要安装 Mac OS X 安装 DVD 上的开发者工具。

            回答 #3

赞同：0

时间：2009-05-24T06:52:10.927

GCC 是 GNU 编译器。拥有它是一件非常有用的事情。您只需要以任何对 Mac 友好的方式安装它。

[http://www.tech-recipes.com/rx/726/mac-os-x-install-gcc-compiler/](http://www.tech-recipes.com/rx/726/mac-os-x-install-gcc-compiler/)

            回答 #4

赞同：0

时间：2011-05-04T06:53:10.027

所以这是不久前的，但我刚刚遇到了问题。

问题在于->     

```
/System/Library/Frameworks/Python.framework/Versions/2.6/lib/python2.6/distutils/sysconfig.py 
```

或者你的 python 安装在哪里。

有一行设置编译标志：

```
archflags = '-arch i386 -arch ppc -arch x86_64' 
```

我只是把它从那条线上取下来，然后继续我的快乐之路。现在显然有一种方法可以从上面的行中配置它：

```
os.environ['ARCHFLAGS'] 
```

但我不知道，也不想惹它。

        eclipse - 关系索引器（macosx-leopard）问题

ID：903247

赞同：0

时间：2009-05-24T06:52:49.583

标签：eclipse, macos, maven-2, nexus, indexer

我一直在尝试添加 org.nakedobjects.prototyping ：应用程序，nexus 索引器找不到任何东西。我意识到在 url 文本框中不包含 http;//repo1.maven.org/maven2/ 地址，有什么线索吗？

我正在使用最新版本的 eclipse 3.4.2

            回答 #1

赞同：0

时间：2009-05-24T07:34:59.810

您使用的是 Maven 2.1.0 对吗？我在我的 Ubuntu 盒子里遇到了同样的问题，我猜是一个错误。我使用 Maven 2.0.10 解决了它

        wpf - 关于 MVVM 模式和 GUI 中 XAML 动态加载的困惑

ID：903249

赞同：4

时间：2009-05-24T06:54:33.527

标签：wpf, mvvm

好吧，这个问题与 MVVM 模式有关，我可以在这个论坛上快速给出很好的答案，所以我想问一下并清除我对模式的困惑。

我对 MVVM 方法很陌生。我很欣赏这种模式并理解它背后的原理。也许我没有对这种模式进行太多工作，这就是为什么会有一些混淆。

如果有一种情况，我想使用 XAML 动态加载我的 WPF 页面的几个部分，并且仍然希望符合 MVVM 方法。

困惑是：  

1.  使用 XAML 动态加载视图的逻辑所在的位置。
2.  我是否应该为我的 WPF 页面设置一个 ViewModel，或者每个单独的部分都有自己的 viewmodel，并与其他 viewmodel 类进行交互。
3.  如果我必须使用代码隐藏本身中的 C# 代码构建显示在 GUI 上的控制树怎么办。对于使用代码创建的控件，我应该在视图本身的代码隐藏中执行命令绑定。

            回答 #1

赞同：1

时间：2009-05-29T17:32:53.703

加载逻辑的去向并不是模式本身真正解决的问题。Ward Bell 有一篇关于此的有趣[博客文章。](http://neverindoubtnet.blogspot.com/2009/05/birth-and-death-of-m-v-vm-triads.html)有很多方法可以给这只猫剥皮，而且它们都与 MVVM 兼容。我知道，这不是您正在寻找的答案，但它是诚实的:)。查看 Ward 的博客文章...您将获得关于该主题的更深入的讨论。

至于是否为页面设置一个虚拟机，还是为每个控件设置一个虚拟机，这取决于。一般来说，我有一个页面。如果有一些部分可以在其他地方重用，我将其分解为具有自己 VM 的用户控件，这意味着我们在 VM 中有一个 VM。我不同意rockeye对此的看法。V-VM-M 之间没有一对一的关系。You're Models 是根据业务需求设计的，完全不考虑演示。您的 ViewModel 是根据您的演示需求设计的，并且可以封装多个模型。事实上，他们封装许多模型是很常见的。

像rockeye一样，我不明白你的最后一个问题。

            回答 #2

赞同：0

时间：2009-05-25T16:13:01.767

我对 mvvm 也很陌生，但我会尝试回答：

1.  使用 XAML 动态加载视图的逻辑所在的位置

如果您的意思是“我如何显示与我的业务对象关联的视图？”，恕我直言，您不必关心这一点。通常，您的 VM 具有相应的视图。使用 dataTemplate，您在代码中仅使用 VM，但视图会自动显示。

2 我是否应该为我的 WPF 页面使用一个 ViewModel，或者每个单独的部分都有自己的 viewmodel，并与其他 viewmodel 类交互

看来你有一个自上而下的方法。我认为 mvvm 更像是自下而上的：模型（业务对象）-> ViewModels-> Views。每个模型都应该有自己的 ViewModel 和视图。因此，除非您的模型代表一个页面，否则您不能在 viewModel 中拥有整个 WPF 页面。

3 如果我必须在代码隐藏本身中使用 C# 代码构建显示在 GUI 上的控制树怎么办。对于使用代码创建的控件，我应该在视图本身的代码隐藏中执行命令绑定。

不明白。我想你可以看看 dataTemplate，它可能会有所帮助。

        html - 在 HTML/CSS 中组织列表

ID：903251

赞同：1

时间：2009-05-24T06:57:52.413

标签：html, css, width, html-lists

我有一个列表，每个项目都需要两个部分。我还需要第一部分的宽度是固定的。我应该如何编码？

我试过使用定义列表：

```
 <dl>
      <dt style="width: 2em;">foo</dt><dd>bar</dd>
    ...

    </dl> 
```

...和具有跨度的用户列表：

```
 <ul>
      <li><span style="width: 2em;">foo<span>bar</li>
    ...

    </ul> 
```

都没有奏效。有什么规范的方法可以做到这一点吗？

            回答 #1

赞同：2

时间：2009-05-24T07:16:20.940

就像 Alan 说的，但如果你只是放一个 div 它不会按照你想要的方式工作，试试这个：

```
<ul>
  <li><div style="width: 200px; display: inline-block;">foo</div>bar</li>
  <li><div style="width: 200px; display: inline-block;">foo12</div>bar</li>
  <li><div style="width: 200px; display: inline-block;">foo12345</div>bar</li>
  <li><div style="width: 200px; display: inline-block;">foo12345678</div>bar</li>
</ul> 
```

（也许您想使用一个类而不是重复每个列表项的样式属性）

            回答 #2

赞同：1

时间：2009-05-24T07:04:45.270

宽度不适用于`<span>`标签，因为它们是内联的。尝试用`<div>`or`<p>`或任何其他块元素替换标签。

            回答 #3

赞同：1

时间：2009-05-24T10:53:10.927

使用 dl 并将 dt 浮动到左侧。

```
<style type="text/css">
dt {clear:left; float:left; width: 8em;}
</style>

<dl>
     <dt>foo<dt>
     <dd>bar</dd>
     <dt>foo1<dt>
     <dd>bar1</dd>
     <dt>foo12345<dt>
     <dd>bar</dd>
 </dl> 
```

            回答 #4

赞同：1

时间：2009-05-24T11:38:14.483

我想出的方法也许不是规范的（但只是因为我不相信有一种“规范”的方式来实现它），但它确实有效：

```
 <style type="text/css" media="screen">

        #container
            {width: 50%;
            margin: 0 auto;
            }

        ol,
        ul  {border: 1px solid #ccc;
            width: 90%;
            padding: 1.4em 0;
            }

        ol li,
        ul li   {background-color: #ccc;
            margin-left: 20%;
            }

        ol li span.list-head,
        ul li span.list-head
            {background-color: #ffa;
            float: left;
            display: block;
            width: 6em;
            }

        dl  {border: 1px solid #ccc;
            line-height: 1.4em;
            padding: 1.4em 0 0 0;
            }

        dl dt   {background-color: #ffa;
            display: block;
            margin: 0;
            width: 10%;
            }

        dl dd   {background-color: #fc0;
            display: block;
            margin: 0;
            width: 88%;
            margin-left: 11%;
            position: relative;
            top: -1.4em;
            }       

    </style>
...
    <div id="container">

        <ol>

            <li><span class="list-head">Foo:</span> bar.</li>

            <li><span class="list-head">Bar:</span> baz.</li>

            <li><span class="list-head">Baz:</span> foo.</li>

        </ol>

        <ul>

            <li><span class="list-head">Foo:</span> bar.</li>

            <li><span class="list-head">Bar:</span> baz.</li>

            <li><span class="list-head">Baz:</span> foo.</li>

        </ul>

        <dl>

            <dt>Foo:</dt>
            <dd>bar.</dd>

            <dt>Bar:</dt>
            <dd>baz.</dd>

            <dt>Baz:</dt>
            <dd>foo.</dd>

        </dl>

    </div> 
```

有一个工作演示：[http://www.davidrhysthomas.co.uk/so/lists.html](http://www.davidrhysthomas.co.uk/so/lists.html)。

            回答 #5

赞同：0

时间：2009-05-24T07:16:50.283

尝试第一部分的标签或内联 div

            回答 #6

赞同：0

时间：2009-05-24T12:03:02.593

我想问：这是用于表示表格数据吗？我们一直被灌输认为 HTML 表格是邪恶的，但是对于显示数据表格来说，它们是完美的。我见过不止一位程序员尝试使用s 和 CSS来复制`<table>`标签的功能。`<div>`

当然，如果不是，那么请继续。:-)

        iphone - 叠加视图和定位

ID：903252

赞同：3

时间：2009-05-24T06:59:00.477

标签：iphone

我有一个标签栏视图和另一个 UIView，其中包含一个按钮，该按钮需要在标签栏上方可见。

我添加了另一个视图，它始终位于当前选择选项卡的视图上方，但无法弄清楚如何使它位于选项卡栏的上方[屏幕截图 http://img.skitch.com/20090524-jq6ufyiwp6c2uu1x5tkrrsd97m.jpg](http://img.skitch.com/20090524-jq6ufyiwp6c2uu1x5tkrrsd97m.jpg)

            回答 #1

赞同：2

时间：2009-05-24T08:51:57.347

我建议对标签栏进行子分类以包含新视图。这样您就不必担心选项卡会覆盖视图。您所有的大小调整都应该自动完成，您永远不会意外隐藏组件。

您还可以让控制器同时处理您添加的按钮和视图。您只需要将 tabbarviewcontroller 中的 tabbar 替换为您的。

            回答 #2

赞同：1

时间：2009-05-24T08:01:48.323

在标签栏视图中使用按钮添加视图并使用其中之一

– 带来SubviewToFront：

– insertSubview:aboveSubview:

把它放在最重要的位置，检查你需要多少像素来定位你的按钮，这样它就不会超过选项卡。

            回答 #3

赞同：0

时间：2009-05-26T16:58:57.653

您也可以在窗口级别添加它。

        vmware - 是否有可能从 GUEST 工作站获取 VMWARE HOST 计算机名称而不更改 HOST 上的内容？

ID：903253

赞同：7

时间：2009-05-24T07:00:08.757

标签：vmware, vmware-workstation

假设我有 VMWARE 工作站（来宾 Windows 并由 Windows 托管）。有没有可能的方法来接收主机的主机名？[并且无需像此链接](http://communities.vmware.com/thread/131180)中那样更改主机上的内容。

            回答 #1

赞同：9

时间：2010-08-04T15:46:50.963

我通过 machine.id 将字符串从主机传递给来宾来做到这一点。它确实需要在主机上进行更改（也在每个 VM 的 .vmx 文件中），并且它不会自动发现主机的主机名，但它可以工作。在主机上，关闭相关 VM 的电源，编辑 VM 的 .vmx 文件。查找或添加如下所示的行：

```
machine.id = "<string>"
```

设置`<string>`等于某个标识字符串，它将告诉您服务器的名称。这可以是主机名，也可以是它的缩短版本，或者如果您愿意，甚至可以是一些难以理解的代码，只要您知道它的含义。但是，如果 .vmx 文件有一行设置

```
isolation.tools.machine.id.get.disable = TRUE
```

传递字符串不起作用，因此如果存在此行，您可能需要删除/注释它或将值设置为`FALSE`.

在来宾操作系统上，如果您安装了 VMware Tools，则可以执行以下操作（对于 Linux 来宾）：

```
vmware-guestd --cmd 'machine.id.get'
```

或（对于 Windows 客人，我没有尝试过）：

```
VMwareService --cmd machine.id.get
```

            回答 #2

赞同：4

时间：2015-07-25T20:21:12.723

我知道这是一个旧线程，但是如果有人仍然对“thomas lee”的回答感兴趣，上面的答案适用于**VMWare 工作站**和**VMWare fusion**的最新版本。检索值的新命令是

```
rpctool machine.id.get 
```

在为 Fusion 部署托管 VM 时使用它，以便在首次启动时自动设置机器名称。谢谢托马斯……

            回答 #3

赞同：3

时间：2014-09-08T23:02:54.887

如果您能够在客户机操作系统上安装[PowerCLI ，则可以通过查找运行脚本的 VM 来访问一些 ESX 主机信息：](https://www.vmware.com/support/developer/PowerCLI/)

```
Connect-VIServer -Server <myvcenterserver>

$myVM = Get-VM -Name $(dir env:COMPUTERNAME).Value

$myVM.Host.Name 
```

注意：这假设您的来宾与 vCenter 中的 VM 名称具有相同的主机名。

对于 Linux 来宾（OP 声明为 Windows），我使用[pyVmomi](http://pypi.python.org/pypi/pyvmomi) Python 模块执行类似的查找。

            回答 #4

赞同：2

时间：2009-05-24T14:21:02.457

原则上 - 不。  

但是，可能存在（或将存在）某些允许恶意客户操作系统绕过 VM 沙箱的漏洞。例如，阅读[Blue Pill](http://en.wikipedia.org/wiki/Blue_Pill_(malware))。您还可以在研究人员自己的博客[Invisible Things by Joanna Rutkowska](http://theinvisiblethings.blogspot.com/2006/06/introducing-blue-pill.html)上阅读更多详细信息。

当然，这些只是概念证明，但在软件中实现的任何安全性都会受到软件错误的影响......

            回答 #5

赞同：2

时间：2010-10-22T07:47:47.040

我认为可能有很多方法可以做到这一点，并且可以想到两种方法：一种是在客户机中安装 ViX，连接到主机而不指定主机名，（谷歌“ViX 参考”然后看到“常见任务”）然后用于`Vix_CopyFileFromHostToGuest()`复制文件`/etc/vmware/esx.conf`。另一种方法是创建从访客到主机的某种网络连接（我使用过`ssh`，但如果您不知道主机名或 IP，您仍然可以像上面那样进行 ViX 连接并调度需要一段时间的工作）和然后`netstat -a`在客人说。输出将`netstat`包含主机名，如果它是可解析的。

            回答 #6

赞同：1

时间：2009-09-02T09:13:39.013

您实际上在网络上有两台计算机。如果您为虚拟 NIC 使用专用网络/NAT 样式设置之一，则主机具有相当可预测的 IP 地址，因此您可以使用许多远程管理方法中的任何一种来询问它，就像您使用其他任何方法一样.

如果只有一个来宾操作系统，那么只需尝试使用与来宾 IP 地址相同的前 24 位的每个 IP 地址，就可以避免猜测地址。

            回答 #7

赞同：1

时间：2015-04-03T13:51:02.987

在 vSphere 中

1.  点击你的主机
2.  单击配置选项卡
3.  在软件部分单击 DNS 和路由

![VMware|vCenter|vSphere 主机配置](https://i.stack.imgur.com/wh2J6.jpg)

        php - PHP 正则表达式难度

ID：903257

赞同：1

时间：2009-05-24T07:07:05.373

标签：php, regex

当文本之间有空格和回车时，我很难做正则表达式。

例如在下面的这种情况下，我怎样才能让正则表达式得到“ `<div id="contentleft">`”？

```
<div id="content"> 

<div id="contentleft">  <SCRIPT language=JavaScript> 
```

我试过

```
id="content">(.*?)<SCRIPT 
```

但它不起作用。

            回答 #1

赞同：2

时间：2009-05-24T09:02:45.063

```
$s = '<div id="content">

<div id="contentleft">  <SCRIPT language=JavaScript>';

if( preg_match('/id="content">(.*?)<SCRIPT/s', $s, $matches) )
    print $matches[1]."\n"; 
```

默认情况下，点匹配除换行符以外的所有内容。  `/s`使它匹配一切。

但实际上，使用 DOM 解析器。您可以遍历树，也可以使用 XPath 查询。把它想象成 XML 的正则表达式。

```
$s = '<div id="content">

<div id="contentleft">  <SCRIPT language=JavaScript>';

// Load the HTML
$doc = new DOMDocument();
$doc->loadHTML($s);

// Use XPath to find the <div id="content"> tag's descendants.
$xpath = new DOMXPath($doc);
$entries = $xpath->query("//div[@id='content']/descendant::*");

foreach( $nodes as $node ) {
    // Stop when we see <script ...>
    if( $node->nodeName == "script" )
        break;

    // do what you want with the content
} 
```

XPath 非常强大。  [这里有一些例子。](http://www.zvon.org/xxl/XPathTutorial/Output/examples.html)

PS我敢肯定（我希望）上面的代码可以收紧一些。

            回答 #2

赞同：1

时间：2009-05-24T07:13:24.753

看看 PCRE 修饰符：[http ://ar2.php.net/manual/en/reference.pcre.pattern.modifiers.php](http://ar2.php.net/manual/en/reference.pcre.pattern.modifiers.php)

您可以应用 s 修饰符，例如`'/id="content">(.*?)<SCRIPT/s'`（不过，请注意，因为它也会改变方式`^`和`$`工作方式。

否则，你可以做`'/id="content">((.|\n)*?)<SCRIPT/'`

编辑：哎呀，错误的修饰符...

            回答 #3

赞同：0

时间：2009-05-24T08:10:18.540

尝试

```
id="content">((?:.|\n)*?)<SCRIPT 
```

不使用正则表达式解析 HTML 的常见警告适用，但您似乎已经知道这一点。

或者：

```
(?<=id="content">)(?:.|\n)*?(?=<SCRIPT) 
```

默认情况下，点不匹配换行符。解决这个问题的一种方法是明确允许它们。即使您碰巧使用的正则表达式风格不支持“dotall”修饰符，这也会起作用。

第一个正则表达式等于您的方法，通过 allow 扩展`\n`。你的比赛将在第 1 组，你只需要修剪它。

第二个正则表达式使用零宽度断言（look-ahead/look-behind）来标记匹配的开始和结束。匹配不会包含您不想要的任何内容，也不需要分组。

            回答 #4

赞同：0

时间：2009-05-24T08:33:30.253

没有正则表达式的另一种解决方案：

```
$start = 'id="content">';
$end = '<SCRIPT';
if (($startPos = strpos($str, $start)) !== false &&
    ($endPos = strpos($str, $end, $startPos+1)) !== false) {
    $substr = substr($str, $startPos, $endPost-$startPos);
} 
```

            回答 #5

赞同：0

时间：2009-05-24T08:50:49.283

好吧，这是一个多行问题，所以看看模式修饰符：

**m (PCRE_MULTILINE)**默认情况下，PCRE 将主题字符串视为由单个“行”字符组成（即使它实际上包含多个换行符）。“行首”元字符 (^) 仅匹配字符串的开头，而“行尾”元字符 ($) 仅匹配字符串末尾或终止换行符之前（除非设置了 D 修饰符）。这与 Perl 相同。

设置此修饰符时，“行首”和“行尾”构造分别匹配主题字符串中任何换行符之后或之前的任何换行符，以及开头和结尾处。这相当于 Perl 的 /m 修饰符。如果主题字符串中没有“\n”字符，或者模式中没有出现 ^ 或 $，则设置此修饰符无效。

s **(PCRE_DOTALL)**如果设置了此修饰符，则模式中的点元字符匹配所有字符，包括换行符。没有它，换行符被排除在外。这个修饰符等价于 Perl 的 /s 修饰符。诸如 [^a] 之类的否定类始终匹配换行符，与此修饰符的设置无关。

来自[http://www.php.net/manual/en/reference.pcre.pattern.modifiers.php](http://www.php.net/manual/en/reference.pcre.pattern.modifiers.php)

            回答 #6

赞同：0

时间：2009-05-24T12:46:27.000

```
$dom = new DOMDocument();
$dom->strictErrorChecking = false;
$dom->loadHTML($html_str);

$xpath = new DOMXPath($dom);
$div = $xpath->query('div[@id="content"]')->item(0); 
```

请更正我的 xpath 表达式 - 不确定它是否会起作用......

        ruby-on-rails - 在控制器中找不到命名空间内的 Ruby on Rails 模型

ID：903258

赞同：11

时间：2009-05-24T07:11:49.077

标签：ruby-on-rails, ruby, model, namespaces

我是rails新手，无法弄清楚这个问题......

我有一个控制器

```
Admin::Blog::EntriesController 
```

在 app/controllers/admin/blog/entries_controller.rb 中定义

我有一个模型叫

```
Blog::Entry 
```

在 app/model/blog/entry.rb 中定义

当我尝试从控制器访问我的模型时，我`"uninitialized constant Admin::Blog::EntriesController::Blog"`从这一行得到一个：

```
@blog_entries = Blog::Entry.find(:all) 
```

显然，它没有正确找到命名空间，这很奇怪，因为根据我所阅读的内容，我已使用正确的语法将模型放置在正确的文件夹中。

关于如何解决这个问题的任何想法？

谢谢

            回答 #1

赞同：33

时间：2009-05-24T07:55:55.463

尝试：

```
@blog_entries = ::Blog::Entry.find(:all) 
```

它目前正在寻找错误的课程。使用`::`before`Blog`将强制它从顶层查看。

            回答 #2

赞同：3

时间：2011-09-27T00:18:51.013

现在是 2011 年，我们处于 Rails 3.1 领域，但这个问题仍然存在。我刚刚使用引用非命名空间模型的命名空间控制器遇到了它，*但只有当数据库中没有该模型的行时！*

使用 :: 为模型名称添加前缀可以解决问题。

            回答 #3

赞同：1

时间：2009-05-24T08:56:25.700

您可以通过使用实现自定义表名

```
set_table_name('foo') 
```

在模型的顶部。

至于多个名称空间，您也许可以使用 using

```
polymorphic_path(@the_object) 
```

生成您的网址，因为它可以进行更基本的推理（至少根据我的经验，也许 form_for 在后台使用它）。

            回答 #4

赞同：0

时间：2010-01-19T01:33:47.210

是的，通过查看代码 form_for 在引擎盖下使用 polymorphic_path 。

        objective-c - 如何使大纲视图像表格视图一样可重新排序？

ID：903262

赞同：1

时间：2009-05-24T07:14:27.543

标签：objective-c, cocoa

您如何使大纲视图能够像表格视图一样重新排序（拖动以移动行的位置）。在我尝试拖动一行时，它只会选择其他行。我怎样才能让它重新订购？

            回答 #1

赞同：6

时间：2009-05-24T15:58:53.680

你必须实现[拖放的东西](http://developer.apple.com/documentation/Cocoa/Conceptual/DragandDrop/DragandDrop.html)。

这些是您必须在 NSOutlineView 数据源中实现的方法。

```
- (NSDragOperation)outlineView:(NSOutlineView *)outlineView validateDrop:(id <NSDraggingInfo>)info proposedItem:(id)item proposedChildIndex:(int)index;
- (BOOL)outlineView:(NSOutlineView *)outlineView acceptDrop:(id <NSDraggingInfo>)info item:(id)item childIndex:(int)index; 
```

查看[NSOutlineViewDataSource 协议参考](http://developer.apple.com/documentation/Cocoa/Reference/ApplicationKit/Protocols/NSOutlineViewDataSource_Protocol/Reference/Reference.html)以获取详细信息。

您还需要为您的大纲视图注册拖动类型

```
[outlineView registerForDraggedTypes: [NSArray arrayWithObjects: NSStringPboardType, NSURLPboardType, NSFilenamesPboardType,NSFileContentsPboardType, nil]]; 
```

            回答 #2

赞同：1

时间：2009-05-28T16:19:12.510

如果您发现 Apple 文档很困难，请尝试阅读[Jonathan](http://espresso-served-here.com/2008/05/13/nstreecontroller-and-core-data-sorted/)关于重新排序的帖子。

好的，如果这有点多，请尝试来自 Apple ADC 站点的[AbstractTree示例代码。](http://developer.apple.com/samplecode/AbstractTree/)拖放方法在 AppDelegate 文件中突出显示。

我不想听起来粗鲁，但您是在学习教程还是在查看参考资料？我之所以问，是因为仅请求可以粘贴的代码对您没有帮助：没有可以直接插入的通用代码。它需要针对您的特定情况编写。在不了解这些的情况下，我们不能只为您编写方法。

尝试并实现 AbstractTree 中的示例拖放方法，如果您仍然遇到问题，请尝试发布您编写的不起作用的代码。

        php - 多种形式的通用php函数

ID：903275

赞同：3

时间：2009-05-24T07:31:41.363

标签：php, mysql, database, forms

我有一个小型应用程序，其中有 9 种不同的表单，每个表单至少有 40 多个字段，用户必须在其中输入一些数据。

我已经在一个 php 文件中编写了每个表单，并制作了一个主 PHP 文件，我只在页面中间添加了表单。

我的问题是：

我不想为每个表单编写 9 个不同的函数，因为它会太长而且我认为这不是最佳实践，所以有没有一种方法或想法可以帮助我制作一个我可以通过的通用函数一些变量并将数据添加到数据库中。

我可以遍历 $_POST 数组并提取数据并以某种方式重新格式化吗？但话又说回来，每个字段都有不同的名称，我似乎这是不可能的。

            回答 #1

赞同：2

时间：2009-05-24T12:37:09.560

试试这个方法：

```
<?php

abstract class FormData
{
    const BOOLEAN = 'bool';
    const INTEGER = 'int';
    const FLOAT = 'float';
    const STRING = 'string';
    protected $_types = array();

    public static function create($data)
    {
        $action = isset($data['action']) ? $data['action'] : '';
        switch ($action)
        {
            case 'form1': return new MyForm1($data);
            default: return null;
        }
        return null;
    }

    protected function loadPostVars($data)
    {
        foreach ($data AS $var=>$value)
        {
            $value = $this->convertVar($var, $value);
            if (!is_null($value) && property_exists($this, $var))
            {
                $this->$var = $value;
            }
        }
    }
    protected function convertVar($var, $value)
    {
        if (array_key_exists($var, $this->_types))
        {
            $type = $this->_types[$var];
            switch ($type)
            {
                case FormData::BOOLEAN: return (bool)(int)$value;
                case FormData::INTEGER: return (int)$value;
                case FormData::FLOAT: return (float)$value;
                case FormData::STRING: // drop down
                default:
                    return myEscapeString($value);
            }
        }
        return null;
    }
}

class MyForm1 extends FormData 
{
    public $fld1;
    public $fld2;
    public $fld3;
    // etc...

    public function __construct($data)
    {
        $this->_types = array(
            'fld1' => FormData::INTEGER,
            'fld2' => FormData::STRING,
            'fld3' => FormData::BOOLEAN,
        );
        $this->loadPostVars($data);
    }
}

// And finally process your form data
// You should add hidden input 'action' to each form to identify the form
if ($form = FormData::create($_POST))
{
    echo $form->fld1, $form->fld2, $form->fld3;
}
else 
{
    exit('error: unknown action provided');
}

?> 
```

这个解决方案必须改进——我写得很快。但我希望你能抓住主要思想。希望这会有所帮助。当然，在每个表单类中，您都可以添加特定的方法来处理请求等。

            回答 #2

赞同：1

时间：2009-05-24T11:39:56.697

我在我的一个项目中使用了类似的东西。基本上，我定义了所有字段，包括如何显示它们、它们具有什么数据类型（数字、日期等），以及在回发后如何处理它们。然后将该信息传递给一个生成 HTML 表单的函数。提交该表单时，您将相同的信息传递给执行必要任务的不同功能。

在我的具体情况下，它只是用于创建搜索表单，因此处理涉及创建 SELECT sql 语句。以下是其中一个字段定义的示例：

```
$criteria = array(
    array("label" => "Search clients",
          "type"  => "radio",
          "values"=> array("1" => "Just " . $client->getName(),
                           "2" => "All clients"),
          "where" => array("1" => "c.`clientId` = " . $client->getId(),
                           "2" => "1"), // always true
          "default" => "1"),
    array("label" => "Last Name",
          "type"  => "text",
          "where" => "s.`lastName` LIKE '%s'"),
    array("label" => "First Name",
          "type"  => "text",
          "where" => "s.`firstName` LIKE '%s'")
    // etc... 
```

            回答 #3

赞同：1

时间：2009-05-24T08:12:56.163

您可能对[Zend_Form](http://framework.zend.com/manual/en/zend.form.html)之类的东西感兴趣。

            回答 #4

赞同：0

时间：2009-05-24T11:17:42.483

您可以使用 foreach 对 $_POST 数组进行迭代。

```
 foreach($_POST as $name => $value) {
      echo $name, ' ', $value, '<br />';
   } 
```

            回答 #5

赞同：0

时间：2009-05-24T10:53:12.487

只是2个小想法..

1) 你是否在一页中显示所有 9 个表格？如果是的话 - 我真的不认为这是一个好主意。

2) 为什么不将表单分成不同的页面，并在可能的情况下为表单上的字段赋予相同的名称？

            回答 #6

赞同：0

时间：2009-05-25T05:39:11.693

正如 SleepyCod 所说，您的乳房赌注正在运行 a `foreach`，但需要扩展答案：

*   表单域是否等同于表格？
*   每个表格是否被用于`UPDATE`或`INSERT`用于更多表格？

我问的原因是因为这是我为我的网页所做的事情。我创建了一个动态表单结构，其中查询有问题的表，检索架构并使用`foreach`+`switch()`来确定要使用的字段。

但这不是你要问的。

所以，相反，我给你：

```
// 假设一个表：一个表格，并且每个输入名称 = 列名称。

//将数组 $_POST 剥离为它的键和值。
foreach($_POST as $key => $val) {
 $vals .= "'$val', ";
 $keys .= "`$key`, ";
}

// 为了避免产生错误，去掉结尾的逗号和空格。
$keys_strip = substr($keys, 0, -2);
$vals_strip = substr($vals, 0, -2);
$sql = mysql_query("插入到 t1 ($keys_strip) 值 ($vals_strip)");

```

对于多个表，它变得有点棘手。我会选择在每个表单的开头使用快速标识，因此我们可以执行以下操作：

```
// 假设两个+ table:一个表格，对于每个输入，name='t1:column_name'; 假设表格在每个表格中定义为一个数组，以便于参考。

// 将数组 $_POST 剥离为 key 和 value，然后将 key 分成两个单独的字段。这仅适用于 t1:column-name 设置；可以放入 if 语句来处理剩余的信息。
foreach ($_POST as $key as val) {
// 这将导致 keys_t1 = key 和 vals_t1 = val。
 if (preg_match('/^(\w.+):(\w.+)$/', $key, $t_key)) {
  ${"keys_".$t_key[1]} = "$t_key[2], ";
  ${"vals_".$t_key[1]} = "$var, ";
 }
}

// 假设 $tables 数组，包含此插入的表。
foreach ($tables AS $table) {
 $keys_strip = substr(${"keys_".$table}, 0, -2);
 $vals_strip = substr(${"vals_".$table}, 0, -2);
 $sql = mysql_query("插入表 ($keys_strip) 值 ($vals_strip)");
}

```

可能需要一些工具才能使其正常工作，但它应该能让你到达你需要去的地方。请注意，这只会`INSERT`基于表单的信息。如果您需要任何东西......好吧......我强烈建议使用隐藏输入类型。

        c# - 将大型项目从 VB.Net 迁移到 C# 的提示？

ID：903284

赞同：5

时间：2009-05-24T07:38:11.630

标签：c#, vb.net, translation

我的任务是将一个相当大的项目从 VB.Net 转移到 C#。有没有转换器，如果有，我应该注意什么？在这样的转换过程中，是否存在已知为问题区域的代码区域（数据访问层等）

            回答 #1

赞同：4

时间：2009-05-24T07:43:13.617

请参阅这些 SO 帖子：

*   [将 VB.Net 转换为 C# 的好方法？](https://stackoverflow.com/questions/756590/good-way-to-convert-vb-net-to-c)

*   [转换 VB.NET —> C# 项目](https://stackoverflow.com/questions/355340/convert-vb-net-c-projects)

*   [什么是最好的 C# 到 VB.net 转换器？](https://stackoverflow.com/questions/88359/what-is-the-best-c-to-vb-net-converter)

*   [将 vb.net 转换为 c# 提示](https://stackoverflow.com/questions/57473/converting-vb-net-to-c-tips)

*   [VB.NET 泛型到 C# 语法](https://stackoverflow.com/questions/189954/vb-net-generics-to-c-syntax)

            回答 #2

赞同：2

时间：2009-05-24T08:19:54.620

有一个名为 SharpDevelop 的开源 C#/VB.net IDE，它有一个转换器，可以从 VB.net 转换为 C#，以及从 C# 转换为 VB.net。

            回答 #3

赞同：1

时间：2009-05-24T07:45:20.103

所需的耐心与项目的规模成正比。

        ruby-on-rails - 计数器缓存不更新，但我可以保存到父母和孩子

ID：903294

赞同：3

时间：2009-05-24T07:49:12.653

标签：ruby-on-rails, counter-cache

我添加了一个计数器缓存，但无法更新。但是我可以通过添加新的博客文章来更新父级 - 博客文章模型 - 我可以通过添加新评论来更新子级 - 评论模型。计数器缓存应该通过自动更新 blog_posts.comments_count 字段来跟踪每篇博客文章的评论总数。我将概述我经历的一些步骤，希望有人会注意到我做错了什么。模式转储在最后。

我有一个博客帖子模型：

```
class Post < ActiveRecord::Base
  set_table_name("blog_posts")
  belongs_to :author, :class_name => "User", :foreign_key => 'author_id'
  has_many :comments, :class_name => "Comment",
    :foreign_key => 'post_id', :order => "created_at desc", :dependent => :destroy
  has_many :categorizations
  has_many :categories, :through => :categorizations
  named_scope :recent, :order => "created_at desc", :limit => 5

end 
```

和一个将 counter_cache 设置为 post 模型的 Comments 模型：

```
class Comment < ActiveRecord::Base
  belongs_to :post, :class_name => "Post", :foreign_key => "post_id", :counter_cache => true
  belongs_to :author, :class_name => "User", :foreign_key => "author_id"
end 
```

我创建了一个迁移以将 counter_cache 列添加到 blog_posts 表中：

```
class AddCommentCounter < ActiveRecord::Migration
  def self.up
    add_column :blog_posts, :comments_count, :integer, :limit => 4, :default => 0, :null => false
    Post.find(:all).each do |post|
      current_count = post.comments.size
      post.update_attribute(:comments_count, current_count)
    end
  end

  def self.down
    remove_column :blog_posts, :comments_count
  end
end 
```

但是迁移无法使用 current_count 更新博客文章。它始终为零。

我打开 Rails 控制台尝试手动更新属性：

```
Loading development environment (Rails 2.3.2)

>> p = Post.find 1
p = Post.find 1

=> #<Post id: 1, title: "test", content: "test", author_id: 1, status: "ok", created_at: "2009-05-21 19:27:14", updated_at: "2009-05-24 07:02:35", comments_count: 0>

>> p.comments
p.comments

=> [#<Comment id: 5, post_id: 1, author_id: 1, content: "Fifth Comment", status: "ok", created_at: "2009-05-24 07:08:56", updated_at: "2009-05-24 07:08:56">, #<Comment id: 4, post_id: 1, author_id: 1, content: "Fourth Comment", status: "ok", created_at: "2009-05-24 07:05:32", updated_at: "2009-05-24 07:05:32">, #<Comment id: 3, post_id: 1, author_id: 1, content: "Third Comment", status: "ok", created_at: "2009-05-24 06:34:59", updated_at: "2009-05-24 06:34:59">, #<Comment id: 2, post_id: 1, author_id: 1, content: "Second Comment", status: "ok", created_at: "2009-05-24 05:20:43", updated_at: "2009-05-24 05:20:43">, #<Comment id: 1, post_id: 1, author_id: 1, content: "First Comment", status: "ok", created_at: "2009-05-21 19:27:14", updated_at: "2009-05-21 19:27:14">]

>> p.comments.size
p.comments.size

=> 5

>> p.comments_count
p.comments_count

=> 0

>> p.update_attribute(:comments_count, 5)
p.update_attribute(:comments_count, 5)

=> true

>> p.comments_count
p.comments_count

=> 5

>> p.save
p.save

=> true 
```

但是当我查看数据库时，comments_count = 0。

任何想法都将不胜感激。

我的 schema.db 看起来像这样：

```
ActiveRecord::Schema.define(:version => 20090524055907) do

  create_table "blog_posts", :force => true do |t|
    t.string   "title",          :limit => 100, :default => "", :null => false
    t.text     "content",                                       :null => false
    t.integer  "author_id",                     :default => 0,  :null => false
    t.string   "status",         :limit => 20,  :default => "", :null => false
    t.datetime "created_at"
    t.datetime "updated_at"
    t.integer  "comments_count",                :default => 0,  :null => false
  end

  add_index "blog_posts", ["author_id"], :name => "index_blog_posts_on_author_id"

  create_table "categories", :force => true do |t|
    t.string   "name",        :limit => 50, :default => "", :null => false
    t.string   "short_name",  :limit => 30, :default => "", :null => false
    t.string   "description",               :default => "", :null => false
    t.datetime "created_at"
    t.datetime "updated_at"
  end

  create_table "categories_posts", :force => true do |t|
    t.integer "category_id", :null => false
    t.integer "post_id",     :null => false
  end

  add_index "categories_posts", ["category_id"], :name => "index_categories_posts_on_category_id"
  add_index "categories_posts", ["post_id"], :name => "index_categories_posts_on_post_id"

  create_table "comments", :force => true do |t|
    t.integer  "post_id",                  :default => 0,  :null => false
    t.integer  "author_id",                :default => 0,  :null => false
    t.text     "content",                                  :null => false
    t.string   "status",     :limit => 25, :default => "", :null => false
    t.datetime "created_at"
    t.datetime "updated_at"
  end

  create_table "sessions", :force => true do |t|
    t.string   "session_id", :default => "", :null => false
    t.text     "data"
    t.datetime "created_at"
    t.datetime "updated_at"
  end

  add_index "sessions", ["session_id"], :name => "index_sessions_on_session_id"
  add_index "sessions", ["updated_at"], :name => "index_sessions_on_updated_at"

  create_table "users", :force => true do |t|
    t.string   "username",        :limit => 25, :default => "", :null => false
    t.string   "hashed_password", :limit => 40, :default => "", :null => false
    t.string   "first_name",      :limit => 25, :default => "", :null => false
    t.string   "last_name",       :limit => 40, :default => "", :null => false
    t.string   "email",           :limit => 50, :default => "", :null => false
    t.string   "display_name",    :limit => 25, :default => "", :null => false
    t.integer  "user_level",      :limit => 3,  :default => 0,  :null => false
    t.datetime "created_at"
    t.datetime "updated_at"
  end

end 
```

            回答 #1

赞同：5

时间：2009-05-24T09:13:52.590

看看counter_cache 上[railscasts 第 23 集](http://railscasts.com/episodes/23-counter-cache-column)的更新代码。

计数器属性是`attr_readonly`。也许[更新计数器](http://api.rubyonrails.org/classes/ActiveRecord/Base.html#M002222)是您需要在迁移中代替更新属性的东西？

        html - 检测页面上是否加载了图像

ID：903297

赞同：1

时间：2009-05-24T07:51:51.103

标签：html, image, client-side

我的问题不是这样的：[Browser-independent way to detect when image has been loaded](https://stackoverflow.com/questions/821516/browser-independent-way-to-detect-when-image-has-been-loaded)

我的网站上有广告，每次展示我都会获得报酬，现在最近我看到每个广告的展示次数急剧下降，但我每月平均点击次数增加了。我是否可以检测是否已加载图像，或者是否已加载类似 404（常见于廉价广告拦截器）的内容？

            回答 #1

赞同：2

时间：2009-05-24T13:02:46.060

你现在怎么数？从您的问题来看，我怀疑您正在解析服务器日志或图像是通过动态 url 提供的。如果是这种情况，那么丢弃可能是由客户端或代理缓存引起的。用户正在查看广告，但请求从未到达您的服务器。

显而易见的解决方案是禁用缓存，但这对您的访问者非常粗鲁。现在常用的方法是使用 1px GIF 作为信标来计算广告。JS 也可以工作，但是当 JS 被禁用时你会失去命中。

```
<div id="ad">
  <img src="/real.gif?ad_id=3435">
  <img src="/beacon.php?ad_id=3435&random=6354377">
</div> 
```

顺便说一句：如果计数是由广告提供商完成的，那么他们总是有可能在撒谎。营销人员通常不是最诚实或最有原则的人。

            回答 #2

赞同：0

时间：2009-05-24T08:58:38.847

通常广告拦截器不是“急剧下降”的原因......

您可以添加将“ping”您的广告图片服务器的 javascript，或者您可以检查要加载的图片...两者都非常容易实现，但如果失败，它将扰乱合法用户。例如，我讨厌页面在关闭时挂起，因为有人收集统计数据并在 onunload 事件中向服务器发送请求......

            回答 #3

赞同：0

时间：2009-05-24T11:10:45.680

加载图像时，IE 上的图像标记中添加了一个“完整”属性。您还可以侦听图像上的“加载”和“错误”事件。

            回答 #4

赞同：0

时间：2009-05-24T14:52:30.567

一种方法是使用图像的 onload 事件使用 Ajax 记录图像加载。如果您以相同的方式记录页面加载，则可以将页面加载与成功加载图像的页面加载进行比较。

```
<img src="..." onload="logMe(this)" />

function logMe(img) {
   now = new Date()
   src = this.src

   ....your Ajax code that writes to the server log.

} 
```

            回答 #5

赞同：0

时间：2009-05-24T14:54:05.807

1.）图像有一个 onload 事件......你可以看到它何时/是否被触发。

2.) 您可以使用 DOM/JS 来查看图像上的属性是否存在并符合您的预期。

3.) 请注意，如果图像没有唯一路径，或者被提供缓存，浏览器将不会重新获取图像（因此重复访问不会重新加载图像）

作为记录，如果您按/展示获得报酬，那您就很幸运了。大多数系统只关心命中。因此，如果加载了图像，则没有任何意义……但是如果用户单击它，则有补偿。

        sql - 索引一个“不可猜测”的键以便快速检索？

ID：903300

赞同：1

时间：2009-05-24T07:58:28.610

标签：sql, performance

我没有完全从谷歌分析中得到我想要的一切，所以我正在制作自己的简单跟踪系统来填补一些空白。
我有一个会话密钥，我将它作为 cookie 发送给客户端。这是一个 GUID。我还有一个代理 IDENTITY int 列。
在客户端的生命周期中，我将经常需要访问会话行以对其进行更新。找到这个会话行进行更新是我关心的地方。
我只将 GUID 发送到客户端浏览器：

a) 我不希望我的技术“黑客”用户能够判断他们是什么“用户 ID”——即知道我们总共有多少访问者访问该网站

b) 我想确保没有人恶意弄乱数据 - 没有人能猜出 GUID

我知道 GUID 索引效率低下，但我不确定到底有多低效。我也不清楚如何最大限度地提高同一行的多次更新效率。
我不知道我应该做以下哪一项：

*   索引 GUID 列并始终使用它来查找行
*   执行表扫描以根据 GUID 查找行（假设最近的会话很容易找到）。通过反向日期顺序执行此操作（如果可能的话！）
*   避免使用 GUID 索引并在我的活动会话的应用程序层中保留哈希表：`IDictionary<GUID, int>`允许从“非秘密”GUID 密钥中找到“秘密”IDENTITY 代理密钥。

一天可能有几千个会话。
PS。我只是想更好地理解这一点的 SQL 方面。我知道我可以做其他聪明的事情，比如只在会话到期时写入表等，但请保留与 SQL/索引相关的答案。

            回答 #1

赞同：4

时间：2009-05-24T08:01:00.587

在这种情况下，我只需在 GUID 上创建一个索引。对于现代数据库来说，每天数千个会话是完全微不足道的负载。

一些注意事项：

*   如果将 GUID 索引创建为非聚集索引，则该索引会很小并且可能会缓存在内存中。默认情况下，大多数数据库集群在主键上。
*   GUID 列大于整数。但这在当今已经不是什么大问题了。并且您需要应用程序的 GUID。
*   GUID 上的索引就像字符串上的索引一样，例如姓氏。这很有效。
*   GUID 上的索引的 B 树比标识列上的索引更难平衡。（但并不比姓氏索引难。）可以通过从低填充因子开始并在每周作业中重新组织索引来抵消这种影响。这是针对每小时或更多处理一百万次插入的数据库的微优化。

            回答 #2

赞同：2

时间：2009-05-24T10:03:43.583

假设您使用的是 SQL Server 2005 或更高版本，您的方案可能会受益于 NEWSEQUENTIALID()，该函数为您提供有序的 GUID。

考虑文章[性能比较 - Identity() x NewId() x NewSequentialId 中的引用](http://www.codeproject.com/KB/database/AgileWareNewGuid.aspx)

*“NEWSEQUENTIALID 系统功能是对 SQL Server 2005 的补充。它旨在将 SQL Server 2000 中过去存在的冲突要求结合在一起；即身份级别的插入性能和全局唯一值。”*

将您的表声明为

```
create table MyTable( 
   id uniqueidentifier default newsequentialid() not null primary key clustered
  ); 
```

但是，请记住，正如 Andomar 所指出的，生成的 GUID 的顺序性也使它们易于预测。有一些方法可以让这变得更难，但不会比将相同的技术应用于顺序整数键更好。

与其他作者一样，我严重怀疑使用直接 newid() GUID 的开销是否足以让您的应用程序注意到。与实现自定义缓存方案（例如您建议的字典）相比，您最好专注于最小化与数据库的往返。

            回答 #3

赞同：1

时间：2009-05-24T09:19:07.480

如果我理解您的问题，您是否担心通过哈希 GUID 索引和查找用户可能会减慢您的应用程序速度？我和 Andomar 在一起，除非您插入行的速度如此之快以至于更新索引会减慢速度，否则这不太重要。只有在像日志表这样的东西上才可能发生这种情况，而且只针对复杂的索引。

更重要的是，您**是否首先对其进行了分析**？您不必猜测为什么您的程序很慢，您可以使用分析器找出哪些位很慢。否则，您将浪费数小时优化 A) 从未使用过或 B) 已经足够快的代码。

        regex - 多个分隔字符的正则表达式匹配

ID：903308

赞同：4

时间：2009-05-24T08:03:27.850

标签：regex

在这个字符串中：

“<0> <<1>> <2>> <3> <4>”

我想匹配“<\d{1,2}>”的所有实例，除了那些我用一组额外的三角括号转义的实例，例如，我想匹配 0,2,3,4 但不是 1，例如：

" **<0>** <<1>> **<2>** >   **<3> **  **<4>** "

我想在一个正则表达式中做到这一点，但我能得到的最好的是：

(^|[^\<])\<(?<1>\d{1,2})>([^>]|$)

这将匹配 0,3,4 但不匹配 2，例如：

" **<0>** <<1>> <2>>   **<3> **  **<4>** "

有谁知道如何用一个正则表达式来做到这一点？

            回答 #1

赞同：5

时间：2009-05-24T08:25:33.530

您也可以尝试[条件](http://www.regular-expressions.info/conditional.html)：
`(?(?<=<)(<\d{1,2}>(?!>))|(<\d{1,2}>))`

            回答 #2

赞同：2

时间：2009-05-24T08:18:47.040

你可以看一个[消极的后视零宽度断言](http://www.regular-expressions.info/lookaround.html)：

```
(?<!<)<\d{1,2}> 
```

            回答 #3

赞同：1

时间：2009-05-24T08:54:21.790

假设与输入集

```
 "<0> <<1>> <2>> <3> <4><<5>" 
```

我们要匹配 0、2、3、4 和 5。

问题是你需要使用零宽度look-ahead**和**零宽度look-behind，但是有三种情况要匹配，'<'，'>'和''，还有一种不匹配'<>' . 此外，如果您希望能够提取标记的表达式以便将匹配项分配给数组，则需要避免标记不需要的东西。所以我最终选择了不优雅的

```
use Data::Dumper;

my $a = "<0> <<1>> <2>> <3> <4><<5>";

my $brace_pair = qr/<[^<>]+>/;
my @matches = $a =~ /(?:(?<!<)$brace_pair(?!>))|(?:$brace_pair(?!>))|(?:(?<!<)$brace_pair)/g;

print Dumper(\@a); 
```

如果你想把它塞进一个表达式中——你可以。

            回答 #4

赞同：0

时间：2009-05-24T09:34:51.223

这是单个正则表达式的替代方法。将其拆分为`><`边界处的列表，然后仅排除`<...>`。

```
#!/usr/bin/perl -lw

$s = "<0> <<1>> <2>> <3> <4>";

print join " ",
      map { /(\d+)/; $1 }
      grep !/^<.*>$/,
      split />\s*</, $s; 
```

            回答 #5

赞同：0

时间：2009-05-25T01:05:25.013

如果您使用支持环视但不支持条件的正则表达式风格（如 Java），这是另一种方法：

```
(?=(<\d{1,2}>))(?!(?<=<)\1(?=>))\1 
```

第一次前瞻确保您位于标签的开头并捕获它以供以后使用。第二个前瞻中的子表达式再次匹配标记，但前提是它前面有 a`<`并且后面有 a `>`。将其设为*负*前瞻可实现您正在寻找的 NOT(x AND y) 语义。最后，第二个`\1`再次匹配标签，这次是真实的（即，不是在环顾中）。

顺便说一句，我本可以使用`>`而不是`(?=>)`在第二次前瞻中使用，但我认为这种方式更容易阅读并更好地表达我的意图。

            回答 #6

赞同：0

时间：2009-05-26T18:22:17.533

这是使用`Perl`.

```
use strict;
use warnings;

my $str = "<0> <<1>> <2>> <3> <4>";
my @array = grep {defined $_} $str =~ /<<\d+>>|<(\d+)>/g;

print join( ', ', @array ), "\n"; 
```

        sql-server - 禁用 Sql 2008 缓存？

ID：903309

赞同：4

时间：2009-05-24T08:03:31.627

标签：sql-server, sql-server-2008, disable-caching

我有一个应用程序可以使用不同的结果进行不同的查询，因此在我的情况下缓存是有害的。

这意味着没有公共数据可以让 sql 从中受益，直接从内存中获取结果而不是访问硬盘。

            回答 #1

赞同：2

时间：2009-05-24T08:55:34.907

从您的评论看来，您不希望 SQL 使用太多内存，因为您觉得这毫无意义，因为您运行的任何查询实际上都是随机的。

首先，这个内存可能被用来存储索引和查询计划，而不是你想要返回的实际数据，因此你可能会发现这个缓存比你想象的要有用得多。

其次，使用这种内存量的 sql 不太可能导致真正随机的不可见查询的性能降低。如果 SQL Server 需要去磁盘获取任何信息，那么它使用的内存量几乎没有关系。

但是，可以减少 SQL Server 使用的内存量。（我不知道该选项在 SQL 2008 中的位置，但我认为它非常相似） 在 Management Studio 中，右键单击服务器并执行属性。在那里，您将有一个内存页面。在这里，您可以选择 SQL 将使用的最小值和最大值。这将有效地限制任何基于您的值的缓存 sql，而不是物理服务器的限制。

我真的不认为你会看到任何性能提升。以我的经验，SQL 总是最好的做它自己的事情。

            回答 #2

赞同：1

时间：2009-05-24T08:14:13.727

您的问题是错误的：缓存意味着数据在内存中，并且避免了磁盘访问。

无论如何，SQL Server 缓存是无害的。对于书呆子来说，总是有例外，但你必须在它之前认真搞砸代码和配置。

            回答 #3

赞同：0

时间：2009-05-24T08:20:56.957

关闭（或尝试关闭）SQL Server 缓存是完全错误地考虑问题。如果数据缓存在您的数据层层中，您应该在那里刷新它。SQL Server 永远不会提供过时的数据。

        database - “大”数据集有多少？

ID：903313

赞同：0

时间：2009-05-24T08:07:59.743

标签：database, large-data-volumes

假设无限存储，其中大小/体积/物理（指标、千兆字节/太字节）仅与元素数量及其标签无关，统计模式应该已经出现在 30 个子集上，但您是否同意少于 1000 个子集太少进行测试，至少 10000 个不同的子集/“元素”、“条目”/实体是“一个大型数据集”。还是更大？谢谢

            回答 #1

赞同：3

时间：2009-05-24T09:15:09.657

我不确定我是否理解您的问题，但听起来您正试图询问您需要采样多少数据集元素以确保一定程度的准确性（30 是来自中心极限定理的幻数经常进来玩）。

如果是这种情况，您需要的样本量取决于置信水平和置信区间。如果您想要 95% 的置信水平和 5% 的置信区间（即，您希望从样本中确定的比例在整个数据集中的比例的 5% 范围内有 95% 的置信度），您最终需要一个样本大小不超过 385 个元素。置信水平越大，您想要生成的置信区间越小，您需要的样本量就越大。

如果您只想计算数字，这里有一个关于[确定样本量的数学](http://edis.ifas.ufl.edu/PD006)
和一个方便的[样本量计算器](http://www.surveysystem.com/sscalc.htm)的很好的讨论。

        java - 将聊天服务器实现为 WebService

ID：903322

赞同：7

时间：2009-05-24T08:19:00.393

标签：java, web-services, chat

我有一个学校项目，我必须在其中实现一个聊天应用程序，其服务器将是一个 java web 服务。

问题是我一直认为 Web 服务是一种调用远程函数的方式，我不知道如何在 Web 服务上保持“会话”处于活动状态，也不知道如何跟踪当前在聊天室等

            回答 #1

赞同：7

时间：2009-05-24T08:47:55.047

据我所知，聊天服务器应该在初始连接后了解其客户端，并将每条客户端消息发送给所有客户端。这肯定需要某种会话维护。我认为正确的方法如下：

1.  客户端调用 Web 服务“握手”并提供一些最低限度的识别细节。
2.  服务器返回包含唯一客户端标识符的确认。
3.  客户端调用 Web 服务“消息”并发送一条新消息及其标识符。
4.  服务器通过标识符识别客户端，将消息分发给所有客户端。

我不太确定消息分发应该如何工作，因为 Web 服务本质上是一种拉式服务，而不是推送。也许客户端应该公开自己的 Web 服务以供服务器调用。

希望这可以帮助，

尤瓦尔=8-)

            回答 #2

赞同：1

时间：2009-05-24T11:59:42.537

您可以考虑实施[COMET](http://en.wikipedia.org/wiki/Comet_(programming))解决方案。这将有效地为您提供推送通信，从而消除延迟，这是聊天应用程序的一个非常好的功能。

如果您想获得金牌，请考虑实施更高级的功能：

*   拼写检查
*   URL/电子邮件地址自动转换为链接
*   独立的聊天室
*   主持人功能（终止聊天，踢用户）
*   诸如“用户正在输入...”之类的事件信息
*   状态（可用、忙碌、离开……）
*   头像
*   ...

            回答 #3

赞同：0

时间：2009-05-24T08:34:27.320

我不知道 Java，所以这个答案与语言无关。

在我看来，不在服务器上运行进程的最简单方法是将所有数据存储在数据库中。

以下是需要完成的基本事项的简短列表：

1.  需要一个包含用户和密码列表的表以进行身份​​验证
2.  需要当前登录使用的表

    A. 需要最后一个联系人的时间戳字段
3.  当用户执行某项操作时，将最后一个联系人字段更新为当前时间
4.  如果用户的最后联系时间 > 当前时间 + 2 分钟，则他们将被注销
5.  客户端应用程序需要定期向服务器发送消息以说“我还在这里”
6.  您需要找到一种方法来确定何时发送消息以及何时更新客户端显示已收到消息，我将留给您。

如果您仍然需要一些帮助，这里有一个 AJAX/ASP.Net 聊天应用程序，它应该（我没有查看它的源代码）以几乎相同的方式工作。

            回答 #4

赞同：0

时间：2009-05-24T11:21:26.953

我编写了一个聊天引擎，它在后台有一个服务，所有内容都存储在数据库中，一个输入表单框架和一个接收 html 流的输出框架。

如果您想跳过服务部分并仅通过 Web 服务实现，您需要实现至少两个操作：发布输入和 GetLatestChanges 接收聊天输出，使用一些 Javascript 魔法将其转换为 HTML。

当然，您需要跟踪房间、用户、消息、哪个用户收到哪些文本等，正如 Unknwntech 所描绘的那样。

        binding - JavaFX 1：bind 和 var 访问修饰符

ID：903325

赞同：2

时间：2009-05-24T08:21:08.393

标签：binding, javafx, access-modifiers, javafx-1

```
 var width = 400;
 var height = 400;

Stage {
    style: StageStyle.TRANSPARENT

    onClose: function():Void {
       System.exit(0);
    }

    scene: Scene {
        content: Scribble {}
        width: width
        height: bind height
    }
} 
```

为什么宽度有效，但高度无效？而且，我能做些什么来解决这个问题？Netbeans 说：

height 在 javafx.scene.Scene 中只有脚本（默认）绑定访问

            回答 #1

赞同：2

时间：2009-05-24T22:24:25.760

好的，我想通了：

```
var width : Number = 400;
var height : Number = 400;

var stage:Stage = Stage {
    width: bind width with inverse
    height: bind width with inverse
    scene: Scene {
      content: Scribble {
                 canvasWidth: bind stage.scene.width
                 canvasHeight: bind stage.scene.height
               }
    }
} 
```

虽然，我真的不需要在这里指定宽度和高度，因为我可以通过舞台变量访问它们。场景宽度和高度会随着舞台宽度和高度的变化而更新。我发现 canvasWidth 在绑定到场景宽度和高度时会更新得更好，而不是绑定到 var 宽度和高度（只有在调整大小完成后才会更新）

            回答 #2

赞同：1

时间：2009-08-27T14:00:41.007

更准确地说，场景的宽度和高度被声明为“public-init”。这意味着它们只能在初始化时设置。场景对象文字中的高度绑定意味着高度将被更新，因此会出现错误。舞台的宽度和高度被声明为“公共”，这意味着它们可以更新。

            回答 #3

赞同：0

时间：2009-05-24T09:36:30.800

您不应该将场景尺寸绑定到任何东西。主要是因为当用户尝试调整包含窗口的大小时，场景尺寸不会更新。

        installation - 如何确保我的 MSI 项目内置到与特定 msiexec 版本兼容的包中？

ID：903326

赞同：0

时间：2009-05-24T08:22:17.157

标签：installation, windows-installer

我有一个 Windows 安装程序 (MSI) 项目。我想确保当我构建它时，它将与 msiexec 4.5 版兼容。

            回答 #1

赞同：1

时间：2009-05-24T08:39:42.660

通常，兼容性是较低版本的问题。Windows Installer 4.5 是最新版本的 Windows 安装程序，我希望它能够向后兼容。因此，最有可能您正在使用的东西将得到支持。

您应该担心的是与旧版本的 Windows Installer 的兼容性。大多数用于创建安装程序的 IDE 都会让您知道您是否正在使用仅在某些版本的 Windows Installer 之后才可用的东西。

如果您的 IDE 不提供此功能，那么您应该了解您在 MSI 中使用的所有内容，并确保它在您打算使用安装程序定位的 Windows Installer 版本中可用。

            回答 #2

赞同：1

时间：2009-05-24T08:55:08.340

这取决于您用于构建 MSI 的工具，您应该能够在那里指定所需的安装程序版本。

例如，我经常使用的[WIX](http://wix.sourceforge.net/)在其[“Package” XML Element](http://wix.sourceforge.net/manual-wix3/wix_xsd_package.htm)中有一个“InstallerVersion”属性。在那里我可以指定需要哪个 Windows 安装程序版本。

（目前我不需要安装程序 4.5，因为它还没有部署到任何地方，我不想要求客户在 XP 上安装新的安装程序。）

**更新：**

重新阅读您的问题，我觉得您使用的是 Visual Studio 安装程序项目。我相信你不能在那里配置 Windows Installer 版本，但它默认为 Windows Installer 3.whatever（我不确定具体的次要版本）。用它创建的安装程序以任何方式与 Windows XP 兼容。

我不相信您在使用 Visual Studio 安装项目时需要更新版本的 Windows Installer，因为安装项目的功能非常有限。因此，如果您需要更新版本的安装程序，您可能需要考虑特定的功能（例如 Vista 上的提升）。要使用该功能，您无论如何都需要一个更好的工具来构建安装程序（如 WIX、Installshield 或 Wise 或......）

        windows - Windows（或其他操作系统）如何更新客户端的后台区域？

ID：903327

赞同：2

时间：2009-05-24T08:22:53.613

标签：windows, algorithm, drawing, custom-component

或者换一种方式问，OnEraseBkgnd() 是如何工作的？

我正在构建一个自定义控件，我遇到了这个问题。

像往常一样，孩子是矩形。我不得不*禁用*OnEraseBkgnd() 并且只使用 OnPaint()。
我需要的是**有效地清除孩子们背后的区域**并且不闪烁。

使用*后台缓冲区*之类的技术不是一种选择。

**编辑**：我对 OnEraseBkgnd() 底层的算法非常感兴趣。但任何有用的答案也将被接受。

            回答 #1

赞同：3

时间：2009-05-24T08:33:23.657

通常在 Windows 中，减少闪烁的最简单（但不是最有效）的方法是关闭`WM_ERASEBKGND`通知处理。这是因为如果您在通知处理程序中擦除背景，然后在`WM_PAINT`处理程序中绘制窗口，两者之间会有一个短暂的延迟 - 这种延迟被视为闪烁。

相反，如果您在`WM_PAINT`处理程序中执行所有擦除和绘图，您将看到的闪烁会少很多。这是因为减少了两者之间的延迟。您仍然会看到一些闪烁，尤其是在调整大小时，因为这两个操作之间仍有一小段延迟，并且您不能总是在下一次出现监视器垂直消隐中断之前获得所有绘图。如果您不能使用双缓冲，那么这可能是您能够使用的最有效的方法。

您可以通过遵循大多数关于客户区失效的常见建议来获得更好的绘图性能 - 除非您确实需要，否则不要使整个窗口失效。尝试仅使已更改的区域无效。`BeginDeferWindowPos`此外，如果您同时更新一组子窗口的位置，则应该使用这些函数。

        java - Get the field value with a Cursor

ID：903343

赞同：33

时间：2009-05-24T08:39:05.173

标签：java, android, android-sqlite

I'm creating an application and I have problems with `Cursor`. I have an `SQLiteDatabase` that returns me a `Cursor` when I try to fetch the values with this function:

```
public Cursor fetchOption(long rowId) throws SQLException {

    Cursor mCursor = mDb.query(true, DATABASE_TABLE, new String[] {KEY_ROWID,
        KEY_TITLE, KEY_BODY}, KEY_ROWID + "=" + rowId, null,
        null, null, null, null);
    if (mCursor != null) {
        mCursor.moveToFirst();
    }
    return mCursor;

} 
```

I don't know how to obtain the value of the field in the `Cursor`. If I do that like so:

```
String a = mOptionDb.fetchOption(0).getColumnName(0).toString();
String b = mOptionDb.fetchOption(0).getColumnName(1).toString();
String c = mOptionDb.fetchOption(0).getColumnName(2).toString(); 
```

I only obtain the name of the columns (`_id, title, body`) but not the values. Any suggestions on how to achieve this?

            回答 #1

赞同：94

时间：2009-05-24T14:13:54.843

I think you can forget about checking for null. 

Instead check if there is data and then access the columns using the cursor:

```
Cursor cursor = fetchOption(0);

if (cursor.moveToFirst()) // data?
   System.out.println(cursor.getString(cursor.getColumnIndex("title")); 

cursor.close(); // that's important too, otherwise you're gonna leak cursors 
```

It might also make sense to read an Android tutorial. The notepad tutorial seems to fit the bill: [http://developer.android.com/guide/tutorials/notepad/index.html](http://developer.android.com/guide/tutorials/notepad/index.html)

            回答 #2

赞同：17

时间：2009-05-24T09:44:43.887

You can use the `Cursor`'s `get*` methods to retrieve values from the result:

```
long id = cursor.getLong(cursor.getColumnIndex("_id"));
long title = cursor.getString(cursor.getColumnIndex("title"));
... 
```

Better practice is obviously to use constants (often provided by ContentProviders) instead of calls to `getColumnIndex` with hardcoded strings.

            回答 #3

赞同：7

时间：2012-09-26T05:31:06.300

You can use this mechanism.

```
Cursor record=db.test(finalDate);     
if(record.getCount()!=0){
    if(record.moveToFirst()){
        do{               
            Imgid1=record.getString(record.getColumnIndex(Database.PHOTO));                
        }while(record.moveToNext());                          
    } 
    record.close();        
} 
```

        gwt - GWT/GXT 的调试控制台

ID：903345

赞同：4

时间：2009-05-24T08:41:33.623

标签：gwt, debugging, gxt

我需要查看 GWT 应用程序的组件树。DOM 树也是可以接受的。不幸的是，GWT 托管浏览器不提供对 devToolbar 的访问。

我发现的唯一方法是编译为 javascript，然后使用常规浏览器。但是编译需要大量的时间。

ExtJS 有[Debug Console](http://extjs.com/deploy/ext-3.0-rc1.1/examples/debug/debug-console.html)，但我无法为 GXT 找到类似的东西。

请建议您调试可视化 GWT 应用程序的方式。

            回答 #1

赞同：4

时间：2009-05-24T21:51:31.130

是的，我今天只是想要这个 FireBug + GWT。如果您喜欢冒险，您可以查看 GWT 2.0 的构建，其中将提供进程外托管模式，让您在 FireFox 或其他浏览器中进行调试。设计：进程外托管模式

GWT 的来源在这里[http://google-web-toolkit.googlecode.com/svn/branches/](http://google-web-toolkit.googlecode.com/svn/branches/)

我个人还没有达到构建这个的痛苦阈值，因为我一直听到 2.0 是“接近”的

            回答 #2

赞同：2

时间：2009-07-07T13:30:28.520

它不是与 Firebug 处于同一模式的调试器，但 GWT Log 控制台非常非常方便地找出 JavaScript 中发生的事情。

请参阅：[http ://code.google.com/p/gwt-log/](http://code.google.com/p/gwt-log/)

            回答 #3

赞同：1

时间：2009-05-24T08:47:23.783

通常人们会使用 IDE 调试器来单步调试 GWT 代码。但是如果问题是 CSS/样式问题（从问题的声音来看，似乎是），那么这可能并没有真正的帮助。

我想编译它并使用 firebug 是解决 css 问题的唯一尝试和真实的方法。

            回答 #4

赞同：0

时间：2009-05-24T14:18:49.137

一种想法是通过减少开发过程中的排列（每个浏览器的不同版本）来最小化编译时间。

在您的 module.gwt.xml 中强制使用用户代理，例如 gecko1_8 (Firefox 2)。

```
<!-- User Agent -->
<set-property name="user.agent" value="gecko1_8" /> 
```

如果您使用的是 i18n，您还可以限制开发期间使用的语言环境。

            回答 #5

赞同：0

时间：2009-05-24T08:47:46.013

为什么编译成（漂亮的）JavaScript 需要这么多时间？我认为不应该。也许您应该禁用不相关浏览器的编译（与调试目的无关），从而显着减少编译时间。

        jmeter - JMeter - 保存结果+配置“图形结果”时间跨度

ID：903348

赞同：8

时间：2009-05-24T08:42:25.883

标签：jmeter

我正在使用 JMeter 并有 2 个问题（我已阅读 FAQ + Wiki 等）：

1.  我使用[Graph Results 监听器](http://jakarta.apache.org/jmeter/usermanual/component_reference.html#Graph_Results)。它似乎有一个固定的跨度，例如 2 小时（只是猜测 - 这在任何地方都没有指示 AFAIK），之后它会环绕并再次从左侧开始在同一画布上绘制。因此，在长周末运行后，它只显示最后 2 小时的结果。我可以配置该跨度或其他属性（除了我在 Graph Results 侦听器本身上看到的复选框之外）？

2.  我可以保存运行结果然后再打开它们吗？我知道我可以保存测试计划或其中的一部分。我不清楚我是否可以单独保存测试结果数据，然后打开它们并进行比较等。此外，即使它们不是原始测试的一部分，我也可以用不同的听众打开它们（即我认为测试是积累数据，稍后我想使用不同的“查看器”查看和解释数据）。

谢谢，

-- 绍尔

            回答 #1

赞同：9

时间：2009-05-24T10:01:12.497

不知道1。关于2：侦听器通常有一个“将所有数据写入文件”的配置字段，它可以让您指定文件名。您可以使用[简单数据编写](http://jakarta.apache.org/jmeter/usermanual/component%5Freference.html#Simple_Data_Writer)器有效地存储结果以供以后分析。

您可以通过选择“将所有数据写入文件”并浏览要加载的文件来将先前测试的结果加载到可视化工具中。有点违反直觉，选择要写入的文件也会将该文件加载到可视化器中并显示结果。只需确保在选择该文件时不要再次运行测试，否则您将丢失保存的测试数据。:-)

            回答 #2

赞同：8

时间：2009-05-24T10:39:58.033

好吧，我后来找到了一个 JMeter 小组，该小组正在[讨论我在第一个问题中提出的问题](http://www.nabble.com/Graph-Results-overlap-td23477206.html#a23477206)，B.Ramann 给了我一个很好的建议，可以使用[这里](http://rubenlaguna.com/wp/better-jmeter-graphs/)找到的更好的图表。

-- 绍尔

        java - 如何按集合中对象的属性对列表进行排序？

ID：903357

赞同：3

时间：2009-05-24T08:47:34.593

标签：java, hibernate, list, sorting

所以我让自己无法可靠地使用 List 的顺序，因为 hibernate 反转它并且每个人都说不要这样做，所以我在我的类中添加了一个字段作为位置。我有：

```
@Entity
class Procedure {
...
int procedureId;
List<Task> tasks;
...
}

@Entity
class Task {
...
int taskId;
int position;
} 
```

现在我不知道如何处理与列表的交互。当我第一次从数据库中获取它并开始使用它时，我是否应该按位置对其进行排序，然后我可以保留我已经编写的所有用户重新排列代码，然后只需将保存时的所有位置重置为订单清单，以便我回来时可以求助？

在这里跳到实际问题：

这似乎是最好的方法，但是如何按集合中对象的属性对列表进行排序？

            回答 #1

赞同：6

时间：2009-05-24T08:59:09.890

例如，要按位置排序，您可以使用

```
java.util.Collections.sort(tasks, new Comparator<Task>() {
@Override
public int compare(Task t1, Task t2) {
    return t1.getPosition() - t2.getPosition();
}); 
```

尤瓦尔=8-)

            回答 #2

赞同：3

时间：2009-05-24T09:08:37.283

如果您希望 Hibernate 保留列表顺序，您可能应该使用`<list-index>`映射索引列，如[6.2.3 索引集合](http://docs.jboss.org/hibernate/stable/core/reference/en/html/collections-mapping.html#collections-indexed)中所述，而不是将其添加为任务字段并自行排序。

这样，您的 Java 代码根本不必担心索引值。当 Hibernate 返回时，该列表将被正确排序，并且当列表被修改时，Hibernate 将负责更新索引。

        c++ - 静态成员和继承

ID：903363

赞同：3

时间：2009-05-24T08:49:26.150

标签：c++, inheritance, static

我有一个带有成员的类`m_preferences`（一个包含单词和特征之间关联的向量）。

在此类中，`m_preferences`不是静态的，因此该类的任何实例都有其特定的`m_preferences`.

```
class Base{

private:

    Preferences m_preferences;

public:
...

} 
```

然后我创建了一个派生类，它`m_preferences`变成静态的，因为我希望这个类的每个新实例无论发生什么都共享相同的首选项数据。

```
class Derived: public Base{

private:

    static Preferences m_preferences;

public:
...

} 
```

我有一个链接错误。

是否可以做我想做的事情（通过继承将非静态成员转换为静态成员）？

如果不是，这种不可能背后的哲学是什么？是计划好的吗？

谢谢，

真挚地，

罗南

            回答 #1

赞同：7

时间：2009-05-24T09:26:30.943

您不能阻止每个实例`Base`- 包括每个实例`Derived`- 都具有每个实例的 Preferences 成员变量，因为这是由 Base 类的定义保证的。

您所做的是向类中添加了一个新的静态`Preferences`成员`Derived`，这意味着除了`Preferences`与基类关联的每个实例成员之外，您还有一个`Preferences`在所有实例之间共享的全局`Derived`实例。

因为您为这两个成员使用了相同的名称，所以在`Parent`成员函数的上下文中，使用标识符`m_preferences`将引用全局共享实例，除非您将其限定为 in `Base::m_preferences`。

您的链接错误可能是因为您需要`Derived::m_preferences`在其中一个翻译单元中提供定义。

例如在 some.cpp 中，在任何函数体之外：

```
Preferences Derived::m_preferences; 
```

            回答 #2

赞同：4

时间：2009-05-24T09:41:48.200

如果我没看错，您想定义一个对象层次结构，该层次结构将具有静态或单独的实例变量 Preferences。尝试这个？

```
class Base
{
  virtual ~Base();
  virtual Preferences& MyPreferences() =0;
};

class DerivedA: public Base
{
public:
  virtual ~DerivedA();
  virtual Preferences& MyPreferences() { return m_preferences; }

private:
  Preferences m_preferences;
};

class DerivedB: public Base
{
public:
  virtual ~DerivedB();
  virtual Preferences& MyPreferences() { return preferences; }

private:
  static Preferences preferences;
};

Preferences DerivedB::preferences; 
```

“转型”，正如[阿里沙费](https://stackoverflow.com/users/24351/ali-shafai)所说，是不可能的。这里的问题是“静态”成员是类本身的属性，而不是单个对象的属性，而虚拟声明和继承是关于在更高抽象级别统一处理可能不属于同一类的单个对象。

            回答 #3

赞同：4

时间：2009-05-24T09:43:15.700

简短的回答：您没有正确使用继承。

长答案：您将 Base 定义为具有单独首选项的类型。如果 Derived 不符合“is-a”条件（Derived 是一种也具有每个实例首选项的类型），那么它不应该从 Base 继承。

也许更好的设计（？）：

```
class NotDerivedAnymore
{

private:

    static Base m_base;

public:
...

} 
```

            回答 #4

赞同：1

时间：2009-05-24T20:17:20.713

您正在打破**[is-a](http://en.wikipedia.org/wiki/Is-a)**继承规则。

你说那`Base`是一个有自己的`Preferences`成员的类型，你说那`Derived` **是一个** `Base`.

看起来你`Base`和`Derived`对象有一些共同点，但不是直接继承

我相信这很好得到你想要的结果

```
class TrueBase{ 
    // Put data and functionality here that really is common for both types.
  private:

    virtual Preferences& get_preferences() = 0;
};

class Base : public TrueBase{
  private:

    virtual Preferences& get_preferences()
    {
        return m_preferences;
    }

    Preferences m_preferences;
};

class Derived: public TrueBase{  
  private:

    virtual Preferences& get_preferences()
    {
        return m_preferences;
    }

    static Preferences m_preferences;   
}; 
```

            回答 #5

赞同：1

时间：2009-05-24T08:55:28.853

是的，**根据设计**，您不能在继承成员时更改成员的**签名**。

        algorithm - 霍夫曼压缩算法

ID：903375

赞同：3

时间：2009-05-24T08:55:38.307

标签：algorithm, compression, huffman-code

我已经使用霍夫曼算法实现了文件压缩，但我遇到的问题是要启用压缩文件的解压缩，使用的编码树或代码本身也应该写入文件。问题是：我该怎么做？在压缩文件的开头编写编码树的最佳方法是什么？

            回答 #1

赞同：5

时间：2009-05-24T09:11:54.530

[在Basic Compression Library (BCL)](http://bcl.comli.eu/)中有一个非常标准的 Huffman 编码实现，包括一个将树写入文件的递归函数。看看霍夫曼.C。它只是按顺序写出叶子，以便解码器可以重建同一棵树。

BCL 也很好，因为其中还有一些其他非常简单的压缩算法。如果您需要推出自己的算法，这非常方便。

            回答 #2

赞同：3

时间：2009-05-24T09:05:40.610

首先，您是否考虑过使用标准压缩流（如 .net 中的 GZipStream）？

关于如何/在何处写入数据，您可以使用 Seek 操作 Streams 位置（甚至以这种方式保留空间）。如果您提前知道 Tree 的大小，则可以在该位置之后开始编写。但是您可能希望将编码树放置在实际数据之后，并确保您知道从哪里开始。即前面预留一点空间，写压缩数据，记录位置，写树，走到最前面写出位置。

            回答 #3

赞同：2

时间：2009-05-24T09:13:44.947

假设您压缩 8 位符号（即字节）并且算法是非自适应的，最简单的方法不是存储树，而是存储值的分布。例如，通过存储您找到字节 0 的频率、字节 1 的频率、...、字节 255 的频率。然后在读回文件时，您可以重新组装树。这是最简单的解决方案，但需要最多的存储空间（例如，要覆盖大文件，每个值需要 4 个字节，即 1kb）。

~~您可以通过不准确存储在文件中找到每个字节的频率来优化这一点，而是将值标准化为 0..255（0 = 找到最少，...），在这种情况下，您只需要保存 256 个字节. 基于这些值重新组装树将产生相同的树。~~[（正如 Edmund 和问题759707](https://stackoverflow.com/questions/759707/efficient-way-of-storing-huffman-tree)所指出的那样，这不会起作用- 请参阅那里以获取更多链接和问题的答案）

PS：正如 Henk 所说，使用 seek() 可以让您在文件开头保留空间以便稍后存储值。

            回答 #4

赞同：2

时间：2009-06-14T19:53:00.897

大多数实现都使用规范的霍夫曼编码。您只需以紧凑的方式存储符号长度。更进一步的实现：[shcodec](http://webcenter.ru/~xander/)。另一种方法是使用半静态霍夫曼编码（定期重新缩放），然后您不必存储任何树。

            回答 #5

赞同：1

时间：2009-05-24T09:28:20.597

由于霍夫曼树中的每个节点要么是一个有两个孩子的分支，要么是一个叶子，因此您可以使用单个位来明确表示每个节点。对于叶子，紧跟该节点的 8 位。

例如对于这棵树：

```
 /\
   /\ A
  B /\
   C  D 
```

您可以存储 001[B]01[C]1[D]1[A]

（事实证明这正是前面发布的 huffman.c 示例中发生的情况，但不是上面描述的方式）。

            回答 #6

赞同：1

时间：2009-05-24T09:07:58.873

不要将代码树写入文件，而是写入每个字符被发现的频率，以便解压缩程序可以生成相同的树。

            回答 #7

赞同：1

时间：2009-05-24T09:13:28.740

最天真的解决方案是预先解析压缩树并将 256 个值写入文件的标题中。

            回答 #8

赞同：0

时间：2011-12-07T17:19:07.943

您是否尝试过自适应霍夫曼编码？乍一看，似乎根本不需要发送树，但需要做更多工作来优化和同步树。

            回答 #9

赞同：0

时间：2011-12-07T17:07:00.400

最好发送字符的频率并在接收端构建树。对于固定字母表，此数据将具有恒定大小。我想这必须是可序列化的并放入文件中。发送树取决于它的实现，对于我所尝试的，基于数组的方法会导致更多的内存未用于树，因为大多数时候树可能不是平衡树。如果树是平衡的，那么数组表示将生成最佳选项。

[Harisankar Krishna 斯瓦米](http://harisankar-krishnaswamy.blogspot.com/2011/12/take-on-huffman-coding-algorithm-how-to.html)

        ide - 具有良好 fortran 支持的编辑器

ID：903386

赞同：6

时间：2009-05-24T09:01:46.343

标签：ide, fortran

谁能推荐一个对 fortran 有良好支持的编辑器（或 IDE）？我发现和尝试的大多数新编辑器都缺乏对它的语言支持。

            回答 #1

赞同：4

时间：2009-05-24T09:20:36.603

GNU Emacs 有一个主要模式用于`FORTRAN`. 用于`M-x fortran-mode`切换到此主要模式。

这种模式我用过很多次，可以推荐一下。我主要用它来编写`FORTRAN`仍然需要打孔卡格式的方言。`FORTRAN`支持打孔卡输入是我最关心的问题，我对这种模式的其他特定功能了解不多。

            回答 #2

赞同：4

时间：2009-05-24T09:06:00.500

[Slickedit](http://slickedit.com/)具有 Fortran 支持。我不知道它有多好，但鉴于对其他语言的良好支持，你应该试一试。

            回答 #3

赞同：3

时间：2009-05-24T09:45:00.547

[Vim](http://www.vim.org)有相对较好的 fortran 支持。语法高亮可能有点古怪，但除此之外还可以。

            回答 #4

赞同：3

时间：2009-06-11T03:13:13.130

如果您熟悉 Eclipse，那么[Photran](http://www.eclipse.org/photran/)插件可能就是您想要的。

*   优点：它是免费的、跨平台的和多功能的，并且您可以获得 Eclipse（SVN 等）存在的所有有趣的插件
*   缺点：如果您不熟悉 Eclipse，那么整理构建环境可能会很痛苦。另外 Eclipse 是基于 Java 的，这意味着它臃肿、缓慢，并且有大量的选项使配置和设置成为真正的苦差事。

也就是说，它比从头开始学习 vi 或 emacs 要好得多。一旦你找到了让它编译 Fortran 的魔法咒语，Eclipse/Photran 似乎工作正常。如果您已经在使用 make，这不是问题；在 Windows 下，前景更复杂但可行。

            回答 #5

赞同：1

时间：2009-08-09T03:46:53.753

如果您使用 Mac，BBedit 非常好。

            回答 #6

赞同：0

时间：2009-08-26T20:32:45.013

我每天都使用[Ultraedit](http://www.ultraedit.com)（IDM.com、ultraedit.com）进行多种编程（F90、javascript、DCL、HTML 等）。效果很好。具有良好的 FTP 支持和出色的语法突出显示。没有将它与任何 Windows 或 Linux 编译器一起使用。我的操作系统是 OpenVMS。

赎金惠誉

        algorithm - 需要一种高效的算法来检查字符串是否包含英语语音

ID：903406

赞同：3

时间：2009-05-24T09:18:10.803

标签：algorithm

我有很多字符串。它们都只包含字符。字符和单词之间没有空格分隔。一些字符形成英文单词，而其他字符只是 bufflegab。字符串可能不包含整个句子。

我需要找出其中哪些是用有效的英语演讲写成的。我的意思是，可以通过连接写得很好的英文单词来构建字符串。我知道我可以用单词表做点什么。但是这些词并没有相互分离。因此，测试每个可能的单词组合可能非常耗时。

我正在寻找一种高性能算法或方法来检查字符串是否由英语单词或英语语音构成。也许有些东西让我有机会字符串包含英语语音。

您知道对我有帮助的方法或算法吗？[像Sphinx](http://cmusphinx.sourceforge.net/html/cmusphinx.php)这样的东西对我有帮助吗？

            回答 #1

赞同：2

时间：2009-05-24T09:23:13.587

这称为[分割](http://en.wikipedia.org/wiki/Speech_segment)问题。

没有简单的方法可以解决这个问题。根据我对您的知识水平的猜测，我可以向您建议的是，从您的字典中构建一个[trie](http://en.wikipedia.org/wiki/Trie)，并在您第一次检测到可能的单词时，尝试假设它是该单词。

如果稍后，您发现单词的最后一部分是乱码，那么您将回溯到最后一次确定字母序列是单词的时间，并忽略该单词。

            回答 #2

赞同：2

时间：2009-05-25T15:56:06.090

如果你的字符串足够长或者你的 bufflegab 足够奇怪，那么[字母频率](http://en.wikipedia.org/wiki/Letter_frequencies)——可能还有二元组频率、三元组频率等——可能就足够了（而不是更一般的 N-gram）。例如，一些浏览器使用它来猜测代码页。

            回答 #3

赞同：1

时间：2009-05-24T09:26:56.030

检查 N-gram 语言模型。

见[http://en.wikipedia.org/wiki/N-gram](http://en.wikipedia.org/wiki/N-gram)

            回答 #4

赞同：0

时间：2009-05-24T09:25:59.853

狮身人面像可能不会帮助你。尝试[Rabin-Karp](http://en.wikipedia.org/wiki/Rabin-Karp_string_search_algorithm)算法。这对于标准搜索来说很糟糕，但对于这个特定问题应该可以很好地工作。基本上，您会想要一本英语单词词典，并希望使用它进行搜索。过大的字典仍然会很慢，但是如果你用一个小的字典来处理常用词，并且只有在遇到常用词时才切换到一个大字典，你可能仍然不会得到太多的漏报。

            回答 #5

赞同：0

时间：2009-05-24T09:26:12.863

为什么不将您的单词表存储在[Trie](http://en.wikipedia.org/wiki/Trie)中。然后你遍历输入在 Trie 中寻找匹配的单词——这可以非常有效地完成。如果你找到一个，前进到单词的末尾并继续。

            回答 #6

赞同：0

时间：2009-05-25T16:25:08.910

It depends on what accuracy you want, how efficient you need it to be, and what kind of text you are processing.

        visual-studio-2010 - C# v4.0 有哪些新特性？

ID：903420

赞同：1

时间：2009-05-24T09:30:17.037

标签：visual-studio-2010, c#-4.0

**可能重复：**

  [C# 4.0 的新酷特性](https://stackoverflow.com/questions/292265/new-cool-features-of-c-4-0)  

你好，

SO上有几个（很多）关于“你在C# v4.0中想要什么？”的问题。这个问题是不同的，我不是问你想在新版本的微软宝贝中看到什么，而是因为微软 Visual Studio 2010 Beta 1 已经发布了。

我自己发现只有在 VS2010 中实现的可选参数。

```
void foo(int a,int b = 10)
{
    if(b != 10) throw new Exception();
}

void Main(string[] args)
{
    foo(5);
    foo(5,6);
} 
```

我很难用那种庞大的语言找到每一件事，因为我不知道计划实现什么。我所看到的只是那些“你想要 C# 4 中的什么？” 问题，这对我的成长没有帮助。

您在 VS2010 Beta1 中发现了哪些新功能？

            回答 #1

赞同：4

时间：2009-05-24T09:34:59.180

在[C# Future 页面@MSDN](http://code.msdn.microsoft.com/csharpfuture/Release/ProjectReleases.aspx?ReleaseId=1686)中，您将找到添加到 C# 4.0 的 Beta1 版本的新功能的文档以及示例。

            回答 #2

赞同：1

时间：2009-05-24T09:36:34.777

你真的在问两个不同的问题：

您在 Vs2010 Beta1 中发现了哪些新功能？

这将是新的 IDE 功能，而不是语言功能。我对这些了解不多，但我知道 IDE 已经用 WPF 重写，并且对多显示器有更好的支持。这里有一篇关于其他新功能的[文章](http://www.codeguru.com/vb/vbnet30/article.php/c15645/)。如果您正在使用 XML/XSLT，那么新的 XSLT 调试功能就很不错了。

C# 4.0 中有哪些新功能？

最大的新功能可能是通过[“动态”关键字](http://blogs.msdn.com/cburrows/archive/2008/10/27/c-dynamic.aspx)进行动态编程。还有一些可选参数，您自己提到。

除此之外，最重要的新特性可能是泛型中的逆变和协变。我不会在这里解释它，因为它会很长，但请参阅[Eric Lippert 的博客以获得详尽的解释](http://blogs.msdn.com/ericlippert/archive/2007/10/16/covariance-and-contravariance-in-c-part-one.aspx)。他有一个关于这个主题的完整系列，并且得到了详细的解释。

        string - 寻找改进我的刽子手代码的方法

ID：903422

赞同：2

时间：2009-05-24T09:30:50.793

标签：string, file-io, python-3.x

刚接触python，所以我决定做一个刽子手游戏。效果很好，但我想知道是否可以进行任何优化或清理代码的方法。另外，如果有人可以推荐一个我接下来可以做的项目，那就太好了。

```
import sys
import codecs
import random

def printInterface(lst, attempts):
    """ Prints user interface which includes:
            - hangman drawing
            - word updater """

    for update in lst:
        print (update, end = '')

    if attempts == 1:
        print ("\n\n\n\n\n\n\n\n\n\n\n\t\t    _____________")
    elif attempts == 2:
        print ("""          
                          |
                          | 
                          |
                          |
                          |
                          |
                          |
                          |
                          |
                    ______|______""")
    elif attempts == 3:
        print ("""
            ______          
                  |
                  | 
                  |
                  |
                  |
                  |
                  |
                  |
                  |
            ______|______""")
    elif attempts == 4:
        print ("""
            ______
           |      |
           |      | 
         (x_X)    |
                  |
                  |
                  |
                  |
                  |
                  |
            ______|______""")
    elif attempts == 5:
        print ("""
            ______
           |      |
           |      | 
         (x_X)    |
           |      |
           |      |
           |      |
                  |
                  |
                  |
            ______|______""")
    elif attempts == 6:
        print ("""
            ______
           |      |
           |      | 
         (x_X)    |
           |      |
          /|      |
           |      |
                  |
                  |
                  |
            ______|______""")
    elif attempts == 7:
        print ("""
            ______
           |      |
           |      | 
         (x_X)    |
           |      |
          /|\     |
           |      |
                  |
                  |
                  |
            ______|______""")
    elif attempts == 8:
        print ("""
            ______
           |      |
           |      | 
         (x_X)    |
           |      |
          /|\     |
           |      |
          /       |
                  |
                  |
            ______|______""")
    elif attempts == 9:
        print ("""
            ______
           |      |
           |      | 
         (x_X)    |
           |      |
          /|\     |
           |      |
          / \     |
                  |
                  |
            ______|______""")

def main():
    try:
        wordlist = codecs.open("words.txt", "r")
    except Exception as ex:
        print (ex)
        print ("\n**Could not open file!**\n")
        sys.exit(0)

    rand = random.randint(1,5)
    i = 0

    for word in wordlist:
        i+=1
        if i == rand:
            break
    word = word.strip()
    wordlist.close()

    lst = []
    for h in word:
        lst.append('_ ')

    attempts = 0    
    printInterface(lst,attempts) 

    while True:
        guess = input("Guess a letter: ").strip()

        i = 0
        for letters in lst:
            if guess not in word:
                print ("No '{0}' in the word, try again!".format(guess))
                attempts += 1
                break
            if guess in word[i] and lst[i] == "_ ":
                lst[i] = (guess + ' ')
            i+=1

        printInterface(lst,attempts)

        x = lst.count('_ ')
        if x == 0:
            print ("You win!")
            break
        elif attempts == 9:
            print ("You suck! You iz ded!")
            break

if __name__ == '__main__':
    while True:
        main()
        again = input("Would you like to play again? (y/n):  ").strip()
        if again.lower() == "n":
            sys.exit(1)
        print ('\n') 
```

            回答 #1

赞同：5

时间：2009-05-24T09:52:12.017

我没有尝试代码，但这里有一些随机提示：

*   尝试根据[PEP 8](http://www.python.org/dev/peps/pep-0008/)格式化您的代码（使用`i += 1`而不是`i+=1`）。PEP 8 是 Python 的标准样式指南。

*   采用

    ```
    lst = ['_ '] * len(word) 
    ```

    而不是 for 循环。

*   使用[枚举](http://docs.python.org/3.0/library/functions.html#enumerate)，如：

    ```
    for i, word in enumerate(wordlist) 
    ```

    `i`而不是在循环中手动跟踪。

*   打开文件的默认模式是`'r'`，无需指定。您是否使用`codecs.open`而不是内置`open`来获取 Unicode 字符串？此外，尝试捕获一个更具体的异常`Exception`——可能是`IOError`.

            回答 #2

赞同：2

时间：2009-05-24T09:56:27.640

我会在 printInterface 中使用 list 而不是 if .. else 语句。

            回答 #3

赞同：2

时间：2009-06-10T02:25:17.660

第一个想法：ASCII艺术

Python 的特殊之处在于正则表达式语法和`range()`函数，以及`[xxx for yyy in zzz]`数组填充。

```
 import re

    def ascii_art(attempt):
        return re.sub(r'\d', '', re.sub('[0{0}].' \
            .format(''.join([str(e) for e in range(attempt + 1, 10)])), ' ', """
                3_3_3_3_3_3_
               4|      2|
               4|      2| 
             4(4x4_4X4)    2|
               5|      2|
              6/5|7\     2|
               5|      2|
              8/ 9\     2|
                      2|
                      2|
                1_1_1_1_1_1_1|1_1_1_1_1_1_
    """))

    for i in range(1, 10): 
        print(ascii_art(i)) 
```

第二个想法：循环

用于`enumerate`单词阅读循环。采用

```
for attempt in range(1, 10):
    # inside main loop
    ...
print ('you suck!') 
```

作为主循环。操作员`break`应小心使用，而不是替代`for`！

除非我错过了什么，否则结构

```
 for letters in lst:
        if guess not in word:
            ...
            break
        if guess in word[i]:
            ... 
```

将更加透明

```
 if guess not in word:
             ...
    else:
         index = word.find (guess)
         ... 
```

        configuration - 是用户设置的依赖注入参数吗？

ID：903423

赞同：2

时间：2009-05-24T09:30:57.113

标签：configuration, dependency-injection

大多数依赖注入框架支持使用各种参数初始化被注入的组件，这些参数通常从 XML 配置文件中读取。

这似乎是一个非常方便的地方来存储设置（比如服务器名称，或者组件需要的文件路径）。但这是正确的方法吗，还是有一个单独的设置配置文件更有意义？在您看来，用户是否应该能够通过 UI 更改设置是否重要？

            回答 #1

赞同：2

时间：2009-05-24T09:44:45.213

我可能会将设置存储在单独的文件中，以便更清楚地了解在不同环境中可能需要修改哪些设置。这也使不熟悉您的依赖注入框架的人（例如，系统管理员、最终用户）更容易修改设置。

如果这是一个非常小的应用程序，并且设置只能由开发人员更改，我可能会将设置保留在 DI 配置中。

            回答 #2

赞同：2

时间：2009-05-26T10:46:35.317

恕我直言，这是常识问题。通常，我将所有内容保存在同一个配置文件中，但在不同的部分中。例如，如果您使用太多配置文件，团队中的新人将更难理解您的代码。但是如果文件变得太大，我认为可以将它们分开。

关于 UI 设置，我认为开发者应该做出大部分选择，但要留出一些配置空间。我现在没有链接，但是有一个有趣的故事，关于一家曾经卖果酱的商店。他们会让顾客品尝带有吐司的果酱，从而大大增加了销售额（因为顾客会知道他们所购买的东西的质量）。一开始，他们没有太多的果酱选择（只有 3 个），而且很成功。When there were too many options (like 20), they noticed customers got a little confused with so many options.

降低可配置性的另一个原因是减少开发时间。如果你读过《[变得真实](http://gettingreal.37signals.com/)》这本书（我推荐这本），他们会说需要大量时间来减少构建。在第 10 章中，他们说：

```
* Less software is easier to manage.
* Less software reduces your codebase and that means
* Less maintenance busywork (and a happier staff).
* Less software lowers your cost of change so you can adapt quickly. You can change your mind without having to change boatloads of code. Less software results in fewer bugs.
* Less software means less support. 
```

因此，恕我直言，尝试找出用户最想更改的设置，并使其可配置。另外，如果您的系统已经投入生产，并且增长缓慢，我认为随着时间的推移，您可以打开更多的配置空间。例如，Gmail 没有太多配置选项，但随着用户习惯了该工具，他们开始为用户创建选项，例如更改主题和谷歌实验室的其他功能。这样，学习曲线“不会伤害”用户:)。

希望我有所帮助。

        ruby-on-rails - 在 Rails 中为什么我们使用 form_for @story do |f| 什么时候没有循环？

ID：903425

赞同：0

时间：2009-05-24T09:33:51.553

标签：ruby-on-rails

我们用

```
(1..10).each do |i|
  p i
end 
```

这样一个值就是块中的 i 的“屈服”...

但是关于

```
<% form_for @story do |f| %>
  <%= f.text_field :name %>
<% end %> 
```

根本没有循环......为什么我们需要让它看起来像一个循环？我们不能让它看起来像一个循环吗？（换一种方式写）？

另外，这里必须使用 Story 实例吗？我们不能只使用 :story 并获得相同的结果吗？@story 实例是新创建的，根本没有数据——它真的有助于创建表单吗？:story 还不够吗？谢谢。

**更新：**

这个想法类似于：（只是伪代码）

```
with_model_give_form (@story) do |f|
  f.begin_form
  f.text_field :name
  f.end_form
end 
```

所以我认为 block 方法将保存 begin_form 和 end_form 因为它会在调用块之前和之后自动添加开始和结束。这是主要的好处吗？

            回答 #1

赞同：6

时间：2009-05-24T09:50:47.087

我认为您误解了 Ruby 在这种情况下的工作方式。

确实，您将所有内容都放在一个块中，但这与循环无关。

你实际上在做什么

```
(1..10).each do |i|
  p i
end 
```

正在创建块`{|i| p(i); }`并将其发送到函数`Range.each()`

与`form_for`. 您实际上所做的是创建块`{|f| puts( f.text_field(:name)); }`并将其传递给 form_for 函数。（现在它不使用 puts，而是一些字符串连接，但你明白了）。

所以它基本上不是一个循环，而是一个在循环中调用时会被多次调用的 lambda 函数。

[这是有关块的更多信息](http://eli.thegreenplace.net/2006/04/18/understanding-ruby-blocks-procs-and-methods/)

**更新：**
关于您的更新。在某种程度上，是的，这是主要的好处。这并不完全正确，但你明白了。该块（以及许多其他）的目的是使代码更易于阅读和理解。也为了加快发展。

把代码分块一直是求之不得的，只要看看函数、类等语句的概念。

例如，`form_for`主要是为了加快开发速度。是的，它创建了开始和结束标签，但这还不是全部。

```
<% form_for @story do |f| %>
  <%= f.text_field :name -%>
<% end %> 
```

实际上可以写成：

```
<form action="<%= polymorphic_edit_path(@story) -%>" 
      id="<%= @story.class_name.underscore -%>">
   <%= text_field :story, :name -%>
</form> 
```

当然，它不会完全是那样，这已经简化了很多，`form_for`功能可以做的远不止这些，但至少你应该得到图片。

            回答 #2

赞同：0

时间：2009-05-24T09:50:28.697

“产量”并不总是意味着一个循环——它更像是一个“块”概念，它只是碰巧在更多的迭代/循环上下文中表现出来。您越是认为 yield 是一个循环结构，您就越会自己陷入困境并阻止自己真正了解积木的美妙之处。

至于：故事，是的，有点蹩脚。你会认为 Rails 只是将它固定化并从那里推断出它的模型。你也可以只在你的视图中使用 Story.new，而不是在你的控制器中这样做，但是，是的，这是一回事。

        sql-server - 在 SQL Server 2008 中保护 DBA 的敏感信息

ID：903432

赞同：3

时间：2009-05-24T09:37:07.037

标签：sql-server, database, tde

我们的客户需要对 MOSS 内容数据库进行加密，因此如果没有正确的加密密钥，DBA 或未经授权的人将无法查看内容数据库。似乎 SQL Server 2008 中的透明数据加密 (TDE) 无法保护敏感信息免受 DBA 的侵害，因为 TDE 旨在保护“静止”数据。这里有人遇到过这个问题吗？

            回答 #1

赞同：6

时间：2009-05-24T09:42:15.170

在我看来，在数据库中拥有敏感数据的要求是信任数据库管理员。

即使您可以以 dba 无法看到的方式加密数据，他也可以嗅探您传递密钥（或数据！）的连接或设置触发器以在加密之前捕获数据以防方案会允许的。

简而言之，获得一个值得信赖的 DBA 是一种更简单、更好的解决方案。

            回答 #2

赞同：2

时间：2009-05-24T09:58:01.363

如果你不能信任 DBA，你就不能信任数据库本身。您的应用程序应该只将加密数据传送到数据库服务器。

话虽如此，还有运行您的应用程序的服务器的管理员。加密你的信任他的方式几乎是不可能的。

在这里同意 Vinko，找一个你可以信任的 DBA，或者谁可以通过筛选。

            回答 #3

赞同：2

时间：2009-06-03T17:32:36.350

这里同样的问题...

我们是一家 mssql 数据库托管公司，我可以说对我们来说这不是问题，是否相信 DBA。我们的客户是银行和保险公司，他们的要求是：“DBA 不能读取数据库”，因为它包含非常敏感的数据。

目前我们正在寻找解决方案。

            回答 #4

赞同：1

时间：2009-05-24T10:00:21.313

没有办法让数据在数据库中仍然可用。

您*可以*这样做，以便数据在 DB 之外可用。只需在 CRUD 操作之前使用某种方法对其进行加密。

有一些方法可以让 DBA 更“合理”地访问数据，f.ex。您可以将密钥作为内联数据存储在 sqlclr 函数中，但 DBA 仍然可以访问它们的二进制代码。然而，这意味着复制密钥、同步，这几乎会阻碍有效的安全性。

            回答 #5

赞同：0

时间：2009-05-24T10:14:52.377

相信 DBA？！从技术上讲，如果我们允许 DBA 不受任何限制地控制安全性，整个系统就会变得脆弱，因为如果 DBA 受到威胁，整个系统的安全性就会受到损害，这将是一场灾难。

            回答 #6

赞同：0

时间：2013-09-11T19:36:40.317

在应用程序级别加密数据是可行的。您需要将密钥存储在 DBA 无法访问的地方。

这是久经考验的解决方案，没什么新意。

        silverlight - Silverlight 应用程序的 WCF

ID：903433

赞同：0

时间：2009-05-24T09:37:10.220

标签：silverlight, silverlight-2.0

我创建了一个使用 WCF 服务的 Silverlight 2 应用程序。该服务位于本地文件夹（不是 IIS）中，并且可以在 Winforms 测试中正常工作。当我尝试调用该服务时，它返回一个错误：“没有跨域策略”。

我尝试将 clientaccesspolicy.xml 和 crossdomain.xml 添加到： wcf 项目文件夹 iis wwwroot 本地驱动器根 E:\

但没有任何影响我应该把它们放在哪里？

            回答 #1

赞同：1

时间：2009-05-25T13:10:59.767

正如您所说，您没有在 IIS 下运行该服务，我将做出一些假设

*   您的 silverlight 应用程序托管在您通过双击加载的 html 页面中，在浏览器位置栏中提供 file:// URI，或者您将其发布到本地 IIS。
*   您的 WCF 服务正在某个自托管进程中运行，例如命令行应用程序、Windows 服务或 Winforms 应用程序。无论通过它托管什么，它都不会与您的 silverlight 应用程序位于同一个 URL 上。

silverlight 应用程序和 wcf 服务托管在单独的 url 中，如果您已将其发布到 IIS ，则应用程序位于 file://example.html 或[http://localhost上，wcf 服务位于](http://localhost)[http://localhost:1234](http://localhost:1234)上。这会引发跨域访问问题，因为端口号不同，或者您正在从 file:// URI 加载 silverlight 应用程序并且您正在自托管 WCF 服务。如果您自托管 WCF 服务，则无法解决此问题，因为它们需要 clientaccesspolicy.xml 文件或 crossdomain.xml 文件，允许从您的 silverlight URL 访问服务，但是无法从根目录提供 XML自托管 WCF 服务器。

            回答 #2

赞同：1

时间：2009-05-26T07:06:22.437

If you're going from an http://... context to a file://... context, it's not a cross-domain issue, actually.  Instead, it's a cross-context issue, which is not allowed in Silverlight 2 (this also happens with http:// and https://) for security reasons.  I'm not sure what the state of this will be in Silverlight 3.

            回答 #3

赞同：0

时间：2009-05-24T09:42:00.663

也许您在那之后没有重新启动 IIS？

编辑：这是一个详尽的教程，请确保您没有完成每一步来使其工作：[Silverlight 2.0 和 WCF](http://weblogs.asp.net/tolgakoseoglu/archive/2008/03/18/silverlight-2-0-and-wcf.aspx)。

            回答 #4

赞同：0

时间：2009-05-25T12:58:44.877

嗯...如果发送了 clientaccesspolicy.xml 请求，请使用 fiddler 检查。

另一方面，用于检查连接是否正常工作的虚拟客户端访问策略：

```
<?xml version="1.0" encoding="utf-8" ?>
<access-policy>
    <cross-domain-access>
        <policy>
            <allow-from http-request-headers="SOAPAction" >
                <domain uri="*"/>
            </allow-from>
            <grant-to>
                <resource include-subpaths="true" path="/"/>
            </grant-to>
        </policy>
    </cross-domain-access>
</access-policy> 
```

但是，您应该尝试在同一个域上工作（如果您需要呼叫安全性更好）。

        ruby-on-rails - 用于谷歌地图集成的 Ruby on rails gem

ID：903457

赞同：25

时间：2009-05-24T10:02:07.597

标签：ruby-on-rails, ruby, ruby-on-rails-3, google-maps, gmaps4rails

我想问一下哪个是将谷歌地图集成到 ruby​​ on rails 应用程序的最佳解决方案。一个特定的宝石值得还是我们应该为它写下自己的观点？

感谢您的任何意见。

            回答 #1

赞同：32

时间：2011-02-18T17:28:02.960

仅供参考，我已经完成了 gmaps4rails 的稳定版本。

请参阅：[https ://github.com/apneadiving/Google-Maps-for-Rails](https://github.com/apneadiving/Google-Maps-for-Rails)

            回答 #2

赞同：11

时间：2011-02-18T18:28:08.767

如果您的要求只是显示特定区域的谷歌地图，可能带有一些标记，您可以使用谷歌地图静态图像 API，例如：

```
<img src="http://maps.google.com/maps/api/staticmap?size=255x255&maptype=roadmap&sensor=false&markers=color:blue|label:A|Chicago,IL&markers=color:purple|label:B|Hammond,IN" alt="Static, Marked Map of Chicago, Illinois and Hammond, Indiana with no Center and Zoom"></img> 
```

结果是：

![伊利诺伊州芝加哥和印第安纳州哈蒙德的静态标记地图，没有中心和缩放](https://i.stack.imgur.com/IJ6UY.png)

这是一篇关于主题的好[文章](http://www.lateralcode.com/new-google-maps-api/)。也可以在标记上用纬度和经度指定地理位置：

```
markers=color:pink|label:A|55.783041, -137.500994 
```

因此，在 Rails 中，您可以使用例如`image_tag`google map image path helper：

```
= image_tag google_map_image_path, :alt => "Google Map" 
```

            回答 #3

赞同：7

时间：2009-05-31T03:22:41.090

我之前使用过 YM4R、Geruby 和空间适配器 gem，效果很好。看到这个[描述](http://ym4r.rubyforge.org/tutorial_ym4r_georuby.html)。

            回答 #4

赞同：3

时间：2012-11-22T09:51:55.257

截至 2012 年 11 月，我发现的谷歌地图集成的最佳宝石是[geocoder](https://github.com/alexreisner/geocoder)
它提供对象地理编码（按街道或 IP 地址）、反向地理编码（与街道地址的坐标）、ActiveRecord 和 Mongoid 的距离查询、结果缓存和更多的。专为 Rails 设计，但也适用于 Sinatra 和其他 Rack 框架。

你也可以得到一个[railscasts](http://railscasts.com/episodes/273-geocoder)。

            回答 #5

赞同：0

时间：2016-09-01T11:11:18.633

[GoogleMaps](https://github.com/9peso/google_maps) gem 是一个不错的选择。它添加了所有基本的 JS 脚本，但无论如何，如果没有 JS 编码，就无法完成功能齐全的动态地图。

还有 JS 插件，其中最吸引人的是 gmap3、Mapplace.Js 和 gmaps.js。

宝石和插件可以节省基本的时间，但使用它们会带来一些限制。例如，如果 Google 对其 Maps API 进行了更改，您必须等待 gem 或插件的更新版本或手动集成。

事实上，将谷歌地图集成到 Rails 应用程序中并没有什么大的困难，恕我直言，在没有宝石的情况下这样做是有道理的。

有关将 Google 地图集成到 Ruby on Rails 应用程序中的详细演练，请参阅这篇文章：[如何将 Google 地图集成到 Ruby on Rails 应用程序](https://anadea.info/blog/how-to-integrate-google-maps-into-ruby-on-rails-app)中。

            回答 #6

赞同：0

时间：2021-12-26T05:51:28.080

截至 2021 年 12 月，我推荐使用 Stimulus.js的这种方法[https://www.driftingruby.com/episodes/google-maps-api-with-stimulusjs](https://www.driftingruby.com/episodes/google-maps-api-with-stimulusjs)
必须为 Rails 7 更新一些位。

1.  您不需要这样做`rails webpacker:install:stimulus`，它已经通过 Hotwire 包含在内
2.  将 turbolink 重命名为 turbo
3.  packs/application.js 不再存在，我还没有找到最好的位置。现在我把它放在 app/javascripts/controllers/index.js
4.  `import { Controller} from "stimulus"`已经成为`import { Controller } from "@hotwired/stimulus"`

就是这样

        language-agnostic - 维护接近软件腐烂的代码

ID：903467

赞同：2

时间：2009-05-24T10:07:57.333

标签：language-agnostic

假设您是一位幸运的程序员，他继承了接近软件腐烂的代码。Pragmatic Programmer 中定义的软件腐烂是太丑陋的代码（在这种情况下，是未重构的代码），它被比作没有人愿意修复的破窗户，反过来可能会损坏房屋，并可能导致犯罪分子在其中茁壮成长城市。

但它与 Joel OnSoftware 中的 Joel Spolsky 所重视的代码相同，它包含有价值的补丁，这些补丁在其整个生命周期中都经过调试（可能看起来非结构化且丑陋）。

你会如何维护这个？

            回答 #1

赞同：6

时间：2009-05-24T10:11:53.503

看看Michael Feathers的[《有效地使用遗留代码》 。](https://rads.stackoverflow.com/amzn/click/com/0131177052)那里有很多好的建议。

            回答 #2

赞同：2

时间：2009-05-24T10:20:09.883

[韦尔奇](https://rads.stackoverflow.com/amzn/click/com/0131177052)是一本好书。你当然应该检查一下。如果你不想等书到了，我可以总结一下我认为重要的部分

1.  你需要了解你的系统。做一些一次性编码以了解您需要处理的部分。例如，根据您可能会破坏系统的知识，准备好尝试并做一些工作以使系统处于测试状态。（了解出了什么问题）
2.  寻找可以打破依赖关系的领域。迈克尔·费瑟斯称这些接缝。它们是您可以借鉴遗留系统并对其进行重构以使其可测试的地方。
3.  当你在系统上工作时，你可以随时添加测试。

            回答 #3

赞同：1

时间：2009-05-24T10:15:30.470

你可以做几件事：

*   重构代码以使其更易于维护。如果代码也用于功能开发，那么重构将是有意义的。
*   如果代码是遗留代码并且仅用于错误修复，那么我建议您仅在需要时修复尽可能多的内容。
*   通常，人们从这些遗留代码中得到的第一印象是它的混乱。给它一些时间并适应它。您可能会看到一些正当的理由来解释为什么随着时间的推移代码看起来会这样......

            回答 #4

赞同：0

时间：2009-05-24T10:17:12.137

首先，确保您有一个强大的测试程序，并且实际上将由几个人（您，QA，...）再次深入测试它。

然后，日复一日地花一些时间来改进你必须修改的小部件。关键是要有一个理解“为什么需要更长的时间”的管理层。说明您必须进行重构，这对短期和长期都很重要，请其他开发人员审查现有代码并确认您的论点。

        c# - 使用 ASP.NET 的简单文件下载计数器？

ID：903471

赞同：1

时间：2009-05-24T10:10:15.893

标签：c#, asp.net

O 如何在 C# 中使用 ASP.NET 制作一个简单的文件下载计数器？例如，当用户单击并下载文件时，我想用 +1 更新它并将其文件名保存到 DB。当用户在链接上鼠标时，我想显示一个带有文件下载时间的工具提示。但如果用户取消下载状态，它不会更新它。

            回答 #1

赞同：0

时间：2009-05-24T10:50:08.170

如果在文件完全下载之前不想更新，则必须编写自己的[通用处理程序](http://dotnetperls.com/Content/ASHX-Handler.aspx)，在处理结束时更新数据库。

对于数据库，我建议您使用一个表来存储每个下载事件，以及一个存储有关每个文件的信息的表，例如

```
tblDownloads
************
DlID (GUID, not nullable, primary key)
Date (datetime, not nullable)
FileID (GUID, not nullable)

tblFiles
********
FileID (GUID, not nullable, primary key)
Url (nvarchar(255), not nullable)
Title (nvarchar(255), not nullable)
Description (nvarchar(max)) 
```

（示例数据类型等的命名与它们在 MSSQL 中的名称相同......）

要获取特定文件的下载计数，您只需在数据库中查询

```
SELECT COUNT(DlID) FROM tblDownloads WHERE FileID = @FileID 
```

where`@FileID`是带有您感兴趣的文件 ID 的参数。如果您想循环出所有文件的 url，您可以例如查询

```
SELECT 
    f.FileID, f.Url, f.Title, f.Description, COUNT(d.DlID) AS DownloadCount 
FROM tblFiles f INNER JOIN tblDownloads d ON f.FileID = d.FileID 
GROUP BY f.FileID, f.Url, f.Title, f.Description 
```

        mysql - 在数据库中记录对网站的所有请求

ID：903472

赞同：0

时间：2009-05-24T10:10:24.333

标签：mysql, database, performance, optimization

我需要在数据库中记录所有帖子并获取网站上的请求。将有两个表：

*   带有时间戳、用户 ID 和请求的 URI 的请求
*   带有名称、值和请求 ID 的请求参数

我只会将它用于每月一次的分析报告。没有经常使用这些数据。

我每天大约有 100 万个请求，请求参数表会非常庞大​​。我可以在 MySQL 中毫无问题地处理这么大的表吗？

            回答 #1

赞同：1

时间：2009-05-24T10:52:22.067

我会避免在每个请求上写入数据库，否则您将容易受到斜线效应的影响。在安静的时间解析您的网络日志以更新数据库。

            回答 #2

赞同：0

时间：2009-05-24T10:46:36.117

是的，mysql 将正常处理数百万行，但取决于您以后想要对数据执行的操作以及这些表上的索引，性能可能不是很高。

PS。在我的项目中，我们有一个巨大的价目表，其中包含数百万种产品，并且它可以正常工作。

            回答 #3

赞同：0

时间：2009-05-24T19:10:34.747

此类问题的通常解决方案是编写一个程序来解析整个月的日志。如果您不需要复杂的 MySQL 功能，您应该考虑这种方法。

如果你真的需要数据库，那么考虑离线解析日志。否则，如果您的数据库出现故障，您将丢失数据。众所周知，日志非常安全。

表索引不是免费的。您拥有的索引越多，查询运行的速度就越快，但是您拥有的索引越多，插入数据的速度就越慢。

        java - Maven 码头在 Eclipse 中没有正确关闭

ID：903480

赞同：2

时间：2009-05-24T10:16:32.277

标签：java, eclipse

我目前正在从 eclipse 作为外部 java 程序运行码头。问题是当我终止码头并尝试重新启动它时，由于端口仍在使用中，它不能。

我要做的是打开 Windows 任务管理器并手动终止 java 进程。你如何让码头很好地关闭/终止/结束？

以下是我的 maven jetty 应用程序设置

参数：jetty:run-war

MAVEN_OPTS：-Xdebug -Xnoagent -Djava.compiler=NONE -Xrunjdwp:transport=dt_socket，地址=8080，服务器=y，挂起=y

设置 suspend=n 似乎也不能解决问题。

            回答 #1

赞同：1

时间：2009-05-28T10:45:12.903

如果一个 java 应用程序没有关闭，那是因为一个活动的非守护线程。尝试获取正在运行的 maven 进程的线程转储，例如使用[VisualVM](https://visualvm.dev.java.net/)并查看是什么使应用程序保持活动状态。

            回答 #2

赞同：0

时间：2009-05-24T18:59:51.820

您可以通过 'Run Jetty Run' Eclipse 插件而不是 Maven jetty 插件来运行应用程序。那时 Eclipse 对新的 JVM 有更直接的控制。

            回答 #3

赞同：0

时间：2009-05-27T21:33:32.750

我不熟悉 maven 插件，但是当使用 start.jar 启动码头时，您可以使用 stop.jar 让它优雅地关闭（从版本 4.something 开始）。

```
停止码头

使用 start.jar 机制启动的程序可以使用
停止.jar：

```
   java -jar stop.jar

```

这通过本地端口连接以停止服务器。可以设置默认端口
 带有 STOP.PORT 系统属性
```

[来源](http://jetty.mortbay.org/jetty5/tut/GettingStarted.html)

或者，也许更符合您的喜好，您可以在 eclipse 中通过编写这样的类并运行 main 方法来实现：

```
 package mypackage;  

   import java.io.OutputStream;  
   import java.net.InetAddress;  
   import java.net.Socket;  

   public class Stop {  
       public static final int PORT = 8079; //Change to whatever your port is, 8079 is default

       public static void main(String[] args) throws Exception {  
          Socket s = new Socket(InetAddress.getByName("127.0.0.1"), PORT);  
          OutputStream out = s.getOutputStream();  
          System.out.println("*** sending jetty stop request");  
          out.write(("\r\n").getBytes());  
          out.flush();  
          s.close();  
      }  

  } 
```

[来源](http://ptrthomas.wordpress.com/2009/01/24/how-to-start-and-stop-jetty-revisited/)

            回答 #4

赞同：0

时间：2009-06-02T14:28:55.060

似乎我忘了勾选“允许终止远程虚拟机”。奇怪的是它以前似乎不起作用。

        java - JDBC的奇怪问题，select返回null

ID：903488

赞同：0

时间：2009-05-24T10:24:34.913

标签：java, jsp, jdbc

我正在尝试使用 JDBC，而我的查询在某些情况下有效，但在其他情况下无效。我真的很感激任何帮助。

我的一些代码：

```
public Result getSpecificTopic()
    {
        String query = "Select msg_body, msg_author from lawers_topic_msg";// where msg_id=2 order by msg_id desc";
         try
        {
            con = mysql.getConnection();
            //Statement stmt = con.createStatement();
            PreparedStatement stmt = con.prepareStatement(query);
            //stmt.setInt(1, topicId);
            ResultSet rs = stmt.executeQuery(query);
            int rowCount = rs.getRow();
            specificTopic = ResultSupport.toResult(rs);

            con.close();
            stmt.close();
        }
        catch(Exception e)
        {
        }
        return this.specificTopic;
    }

    public void setTopicId(String num)
    {
        this.topicId = Integer.parseInt(num);
    }

    public int getTopicId()
    {
        return this.topicId;
    } 
```

但是，如果我改变

```
String query = "Select msg_body, msg_author from lawers_topic_msg"; 
```

到

```
String query = "Select msg_body, msg_author from lawers_topic_msg where msg_id = " + topicId; 
```

然后结果集什么都没有返回......我在这里打破了我的头，仍然无法弄清楚问题是什么

            回答 #1

赞同：6

时间：2009-05-24T12:09:35.250

您仍然没有正确关闭资源。这应该在 finally 块中完成：

[http://www.java-blog.com/correct-closing-jdbc-resources](http://www.java-blog.com/correct-closing-jdbc-resources)

            回答 #2

赞同：3

时间：2009-05-24T10:36:29.820

作为第一步，确保没有抛出异常是值得的——至少在你的 catch() 块中记录一些东西。

还值得记录生成的 SQL，并确保在直接运行它时实际返回您对数据库的期望。

如果您有多个数据库，那么值得确认您正在与您认为的数据库竞争 - 我很尴尬地承认我以前曾被这种方式发现过。

            回答 #3

赞同：2

时间：2009-05-24T10:37:57.803

您的代码有几个问题，我会保持简短：

不要在这一层用 try / catch 封装，特别是因为你没有进行错误管理。this.specificTopic 看起来是全局的，因此如果您的查询失败，它将返回存储在 this.specificTopic 中的任何内容。

也试试 BobbyShaftoe 说的。在控制台中打印或使用您的调试器。这应该可以很好地指示您出了什么问题。

            回答 #4

赞同：2

时间：2009-05-24T10:54:22.607

我的第一个猜测是 Integer.parseInt(num) 可能会引发异常。如果是这样，sql语句将被破坏。

其次，正如 Makach 指出的，存在几个问题。首先是包罗万象的

你不应该使用字符串连接，比如

```
 ....where msg_id = " + topicId; 
```

反而

```
 ....where msg_id = ?"
         stmt.set Int(1,topicId) 
```

编辑：无论如何，这似乎就是你正在尝试的，所以有些角色很糟糕。

        text - 在批处理文件中显示 .txt 文件中的文本

ID：903491

赞同：19

时间：2009-05-24T10:31:32.730

标签：text, batch-file, text-files

我正在编写一个大批处理文件。

它将日期记录到 log.txt 文件中：

```
@echo off
echo %date%, %time% >> log.txt
echo Current date/time is %date%, %time%.
@pause
exit 
```

它可以在几行上记录多次。现在我想做的是批处理文件显示 log.txt 文件中最后记录的日期/时间。

如何？

            回答 #1

赞同：34

时间：2009-05-24T10:34:31.867

```
type log.txt 
```

但这会给你整个文件。您可以将其更改为：

```
echo %date%, %time% >> log.txt
echo %date%, %time% > log_last.txt
...
type log_last.txt 
```

只得到最后一个。

            回答 #2

赞同：7

时间：2009-05-24T11:28:11.837

嗯..刚刚找到答案。这比我想的要容易。它只需要更多的东西：

```
@echo off
if not exist log.txt GOTO :write
echo Date/Time last login:
type log.txt
del log.txt
:write
echo %date%, %time%. >> log.txt
@pause
exit 
```

所以它首先读取 log.txt 文件并将其删除。之后它只会得到一个带有日期和时间的新文件（log.txt）！

我希望这对其他人有帮助！

（唯一的问题是第一次它不起作用，然后在log.txt中输入随机值。）（这个问题已解决并编辑。）

            回答 #3

赞同：3

时间：2009-05-24T10:41:35.550

使用[Windows 2003 资源工具包中的 tail.exe](http://commandwindows.com/server2003tools.htm "Windows 2003 资源工具包")

            回答 #4

赞同：1

时间：2009-05-24T10:58:09.603

试试这个：使用 Find 遍历具有“当前日期/时间”的所有行，并将每一行写入同一个文件：

```
for /f "usebackq delims==" %i in (`find "Current date" log.txt`) do (echo %i > log-time.txt)
type log-time.txt 
```

将 delims= 设置为与日期/时间行不相关的字符。在批处理文件中使用 %%i。

说明（*更新*）：

Find 从 log.txt 中提取包含搜索字符串的所有行。

For /f 循环遍历 ( ) 内的命令生成的每一行`...`。

由于 echo > log-time.txt (single > !) 每次执行时都会覆盖 log-time.txt，因此 log-time.txt 中只保留最后一个匹配行

            回答 #5

赞同：1

时间：2009-05-24T12:12:16.773

`log.txt`这是一个如果丢失也不会失败的版本：

```
 @echo off
  if not exist log.txt goto firstlogin
  echo Date/Time last login:
  type log.txt
  goto end

:firstlogin
  echo No last login found.

:end
  echo %date%, %time%. > log.txt
  pause 
```

            回答 #6

赞同：1

时间：2009-08-28T12:08:24.240

好的，我想知道什么时候使用，但是，这里有两个你可以使用的片段：  

**最后的日志.cmd**  

```
@echo off
for /f "delims=" %%l in (log.txt) do set TimeStamp=%%l
echo %TimeStamp% 
```

更改“echo..”行，但最后的日志时间在**%TimeStamp%**之内。没有使用临时文件，没有混乱和可重复使用，因为它在变量中。

另一方面，如果您需要在您的代码中而不是从另一个批次中知道这一点，请更改您的日志记录：  

```
set TimeStamp=%date%, %time%
echo %TimeStamp% >> log.txt 
```

以便以后需要时可以使用变量**%TimeStamp% 。**

            回答 #7

赞同：1

时间：2009-09-24T12:54:15.597

一种方便的时间戳格式：

```
%date:~3,2%/%date:~0,2%/%date:~6,2%-%time:~0,8% 
```

            回答 #8

赞同：1

时间：2013-12-29T04:34:19.370

只需将时间和日期设置为变量，如果它将处于循环中然后

```
:top
set T=%time%
set D=%Date%

echo %T%>>log.txt
echo %d%>>log.txt
echo time:%T%
echo date:%D%
pause
goto top 
```

我建议通过放置：

```
@echo off 
```

在每件事之前，它都摆脱了垃圾 C:/users/example/...

并把

```
cls 
```

在`:top`将新的日期和时间添加到显示之前清除屏幕

            回答 #9

赞同：0

时间：2009-09-27T07:08:56.507

这是一个很好的日期和时间代码：

```
@echo off
if %date:~4,2%==01 set month=January
if %date:~4,2%==02 set month=February
if %date:~4,2%==03 set month=March
if %date:~4,2%==04 set month=April
if %date:~4,2%==05 set month=May
if %date:~4,2%==06 set month=June
if %date:~4,2%==07 set month=July
if %date:~4,2%==08 set month=August
if %date:~4,2%==09 set month=September
if %date:~4,2%==10 set month=October
if %date:~4,2%==11 set month=November
if %date:~4,2%==12 set month=December

if %date:~0,3%==Mon set day=Monday
if %date:~0,3%==Tue set day=Tuesday
if %date:~0,3%==Wed set day=Wednesday
if %date:~0,3%==Thu set day=Thursday
if %date:~0,3%==Fri set day=Friday
if %date:~0,3%==Sat set day=Saturday
if %date:~0,3%==Sun set day=Sunday
echo.
echo The Date is %day%, %month% %date:~7,2%, %date:~10,4% the current time is: %time:~0,5%
pause 
```

输出：日期是 2009 年 9 月 27 日星期日，当前时间是：3:07

            回答 #10

赞同：0

时间：2011-11-22T18:17:31.617

```
@echo off
set log=%time% %date%
echo %log% 
```

那是将日期和时间保存为临时变量并显示它的批处理。赶时间，没时间写脚本打开一个txt，可能以后再说吧。

        sql-server - Visual Web Developer 2008 Express 想要 SQL Server 2005 而不是 2008？

ID：903494

赞同：0

时间：2009-05-24T10:33:26.567

标签：sql-server, visual-studio-express, visual-web-developer

当我双击 Visual Web Developer 2008 (NerdDinner.mdf) 上的 mdf 文件时，它显示：

与 SQL Server 文件 (*.mdf) 的连接需要 SQL Server Express 2005 才能正常运行。请验证组件的安装或从 URL 下载：http://go.microsoft.com/fwlink/?LinkId=49251

URL 当然指向 SQL Server Express 2008。我已经安装并运行了那个。任何想法为什么我会收到该消息？

            回答 #1

赞同：0

时间：2009-05-24T10:38:49.783

您可能安装了带有自定义设置的 Visual Web Developer 2008 Express 并跳过了数据库部分。

Visual Web Developer 2008 Express 最初与 SQL Server Express 2005 一起提供。当时，SQL Server Express 2008 还没有准备好。

不要担心错误消息，只需安装 SQL Server Express 2008。

            回答 #2

赞同：0

时间：2009-05-24T10:54:47.927

据我所知，对 SQL Server 2008 的支持已添加到 Visual Studio 的 Service Pack 1 中。

你可以[在这里](http://www.microsoft.com/express/vwd/)下载。

        xml - XBMC 中的快进和快退音乐

ID：903496

赞同：0

时间：2009-05-24T10:34:35.970

标签：xml, customization, xbox, xbmc

当我在我的 XBOX 上收听 XBMC 中的 Stack Overflow Podcast #54 时，我想往回跳一下，再听一遍。

令我懊恼的是，视频应用程序中的搜索控件不起作用。然后我尝试使用音乐 OSD 中的搜索按钮。没有成功。接下来我尝试进入可视化模式并在此处使用搜索控件（如视频中所示）。没有。作为最后的手段，我尝试了网络控制界面，但这也不起作用。

XBMC 论坛在这个话题上一团糟。有太多重复的帖子，除了查​​看 Keymappings.txt 和 Keymappings.xml 文件之外，我找不到任何有用的信息。这些看起来都很好。

我正在使用 XBMC 9.04r19856 (T3CH_20090521)。如果有人能帮助我，将不胜感激！

            回答 #1

赞同：1

时间：2009-07-29T07:28:47.887

找到了解决方案。

事实证明这不是编程问题。问题在于我通过 Microsoft 的 UPnP 协议进行流式传输。

通过 SMB 共享进行流式传输时，跳过命令（通过游戏手柄、OSD 和 Web）确实有效。

        python - Python - 获取静态信息

ID：903497

赞同：1

时间：2009-05-24T10:35:43.957

标签：python, variables, static

我必须从一个“模块”获取静态信息到另一个。我正在尝试编写记录器，其中包含有关我们记录的代码位置的信息。例如，在某个文件中：

```
LogObject.Log('Describe error', STATIC_INFORMATION) 
```

静态信息是类名、文件名和函数名。我从这个得到它：

```
__file__ 
self.__class__.__name__ 
sys._getframe().f_code.co_name 
```

但我不想在记录期间写这个变量。我可以创建一些函数并调用它吗？例如：

```
LogObject.Log('Describe error', someFunction()) 
```

我如何使用它来获取静态信息？

            回答 #1

赞同：3

时间：2009-05-24T11:33:37.100

我不认为“静态”是您正在寻找的世界。如果我理解正确，您想编写一个函数来返回调用者的文件名、类名和方法名。

基本上，您应该使用 sys._getframe(1) 访问前一帧，然后从那里开始工作。

例子：

```
def codeinfo():
    import sys
    f = sys._getframe(1)

    filename = f.f_code.co_filename
    classname = ''

    if 'self' in f.f_locals:
        classname = f.f_locals['self'].__class__.__name__

    funcname = f.f_code.co_name

    return "filename: %s\nclass: %s\nfunc: %s" % (filename, classname, funcname) 
```

然后从某个地方你可以写的方法

```
logger.info("Some message \n %s" % codeinfo()) 
```

            回答 #2

赞同：2

时间：2009-05-24T11:13:18.590

首先，请使用小写的对象和方法名称。仅对类定义使用大写名称。  

更重要的是，你希望在每个类中都有一个聪明的内省函数，它出现了。  

```
class Loggable( object ):
    def identification( self ):
        return self.__class__.__module__, self.__class__.__name__, sys._getframe().f_code.co_name

class ARealClass( Loggable ):
    def someFunction( self ):
        logger.info( "Some Message from %r", self. identification() ) 
```

如果您的所有类都是 Loggable 的子类，那么您将在所有类中继承此标识功能。

        parallel-processing - 通过并行最大程度地提高处理速度

ID：903506

赞同：1

时间：2009-05-24T10:45:41.940

标签：parallel-processing, big-o

在任何情况下，并行化算法带来的不仅仅是线性速度的增加吗？

            回答 #1

赞同：5

时间：2009-05-24T10:56:34.490

从理论的角度来看，你可以达到的最大值是线性加速。[在实践中，超线性加速](http://en.wikipedia.org/wiki/Speedup)是可能的。如果您可以将问题分散到可以利用处理器缓存的影响的范围内，例如因为它不适合单核的缓存，那么您的问题可以比线性更好地扩展。

            回答 #2

赞同：1

时间：2009-05-24T10:56:47.563

从理论上讲，不会 - 但实际上可能是这种情况（取决于底层硬件和您的具体问题）。比较并行和顺序代码并非易事（您必须将*最快*的顺序实现与并行实现进行比较，而不仅仅是在单个处理器/线程上运行的并行实现）。

但是，当有人谈到超线性加速时，我总是会怀疑。他们要么没有正确测量它（见上文），要么测量了一个工件（取决于硬件/操作系统）并且应该相应地记录它，或者这只适用于问题/实现/硬件的特定组合。

        language-agnostic - 如何说服团队其他部分对软件开发很重要？

ID：903513

赞同：1

时间：2009-05-24T10:49:39.840

标签：language-agnostic

有时，当我向某些人展示软件开发过程的一部分时，说他们没有经验的主管或经理说

1.  自动化单元测试和集成测试与他们的手动功能测试。
2.  使用代码生成器和脚本执行重复性任务。

我有时会遇到阻力。部分原因如下：

1.  他们说这就是我们在这里做事的方式。我们的系统可以正常工作，无需在我们的流程中添加。
2.  他们忙着忙着。他们说他们的工作是为我们提供项目，而我们的工作是让他们满意。如果它是手动系统，重复但准时，他们会感到满意。
3.  他们对代码生成器非常保守。我给他们一个估计，第一个项目使用它需要大量的时间开销，并且需要时间来训练我的队友，因为这种方法对他们来说相对较新。从长远来看，第一个项目的开销对他们来说掩盖了好处，但我解释了它对我们开发人员的便利，但他们总是坚持以旧方式做事。

您对此有何策略？

            回答 #1

赞同：2

时间：2009-05-24T11:04:17.877

等待问题出现**，然后**采取*行动*。

            回答 #2

赞同：1

时间：2009-05-24T11:13:00.993

归根结底，你必须成为一名推销员。你必须告诉人们为什么你的提议会让**他们的**生活更轻松。

如果您可以使用某种花费时间/节省时间的数据来支持您的声明，那么您就是赢家。另一件事是通过同意分阶段实施更改来逐渐获得声誉。对项目的一小部分进行简单的更改，并证明它对他们产生了影响。然后再推出一点，然后继续下一步，比如单元测试或代码生成。有时间它会自己解决的。

我不相信你不能强迫人们读书，他们会搁置它们并认为你很讨厌。最好的办法是获得小的结果，并将其用作踏脚石，以便人们可以瞄准更高的目标，因为人们意识到也许毕竟**有**更好的做事方式。

If you're really passionate about it, you can always invest a little of your own time, and prepare a short demo (30 mins tops) that shows them how quickly you can create a tiny app without code gen, then the same app with a couple of bits code-genned.  The proof of the pudding is in the eating.

            回答 #3

赞同：0

时间：2009-05-24T10:54:33.933

*“你可以带着微笑和枪走得更远，而不是仅仅带着微笑。”* 

- 铝卡波恩

开个玩笑，但这是我想到的第一件事:)

枪是一个隐喻（呃），就像一个虫子花了几天时间弄清楚，通过一个好的过程，他可以以更有趣的方式度过。  

            回答 #4

赞同：0

时间：2009-05-24T10:57:51.243

我认为说服某人相信某事的唯一方法是揭示它提供的好处。

            回答 #5

赞同：0

时间：2009-05-24T11:06:43.847

请求宽恕比获得许可更容易。

对于“改进”软件开发过程，没有客观的投资回报风格测量。软件开发本质上是困难的——它是知识的获取——必须有未知数。如果一切都知道，那么您已经掌握了该软件。

因此，您永远无法预先说服经理任何事情。

你只能证明你能够做得更好、更便宜或更快。当他们问你提高生产力的秘诀是什么时，你可以向他们展示你的工具、方法或方法。

在他们问之前，你真的没有足够的证据来改变任何人的想法。当他们最终提出要求时，您无需改变他们的想法，您需要向他们展示您的解决方案。

由于他们不想破坏他们的“手工完成”计划来投资您的工具，因此您必须逐步构建您的工具，一次一个项目。

        struts2 - '#'、'%' 和 '$' 之间的区别

ID：903514

赞同：3

时间：2009-05-24T10:49:54.520

标签：struts2, jstl, ognl

我是 struts2 的新手，对 '#'、'%' 和 '$' 元素感到困惑。有一些用法，例如：

```
${user.name}
%{user.name}
<s:radio list="#{key1:value1,key2:value2}" /> 
```

谁能给我一个解释和例子？

            回答 #1

赞同：4

时间：2009-05-24T11:03:08.317

简而言之

如果在 jsp 页面中 ${user.name} 是一个 EL 表达式。如果struts.xml 中的${user.name}，它是一个OGNL 表达式。

如果在 jsp 页面中使用 %{user.name}，则它是一个 OGNL 表达式。

最后，#{key1:value1,key2:value2} 是一个 OGNL 表达式，这意味着创建一个映射，将 key1 映射到 value1 并将 key2 映射到 value2。

顺便说一句：#{key1:value1,key2:value2} 应该包含在 %{} 中，例如 %{#{key1:value1,key2:value2}}，但是，struts2 标签中的某些属性会假定它是 OGNL 表达式，即表示没有 %{} 是可以的。

        java - 我应该如何为 JNI 加载本机库以避免 UnsatisfiedLinkError？

ID：903530

赞同：17

时间：2009-05-24T10:58:02.117

标签：java, c, java-native-interface

我想在 Ubuntu 8.10 上使用 JNI，使用 Eclipse 和 gcc（如果有的话，这是 Ubuntu 的标准）。

尽管 make 文件成功创建它，但我似乎无法加载我的库。

主要的Java类如下：

```
class Hello {
    public native void sayHello();

    static {
        System.loadLibrary("hello.so");
    }

    public static void main(String[] args) {
        Hello h = new Hello();
        h.sayHello();
    }
} 
```

我的make文件就是这样；

```
 all : hello.so

hello.so : Hello.o
    gcc -shared -o hello.so Hello.o

Hello.o : Hello.c Hello.h
    gcc -I/usr/lib/jvm/java-6-sun/include -I/usr/lib/jvm/java-6-sun/include/linux -c Hello.c -o Hello.o

Hello.h : Hello.class
    javah -jni Hello

clean :
    -del Hello.h
    -del Hello.o 
```

其余代码 (Hello.c) 看起来像人们想的那样。

我得到的错误如下；

```
Exception in thread "main" java.lang.UnsatisfiedLinkError: no hello.so in java.library.path 
```

如果我使用显式路径：

```
System.loadLibrary("/home/gavin/Work/workspace/JNI/hello.so"); 
```

然后它可以工作，但如果可能的话，我宁愿不使用显式路径。

            回答 #1

赞同：23

时间：2009-05-24T15:21:18.310

根据 Pax，您应该将库路径设置为 Java 应该查找该库的位置。您的库名称应该是 libhello.so。加载库的调用应该是：

```
System.loadLibrary("hello"); 
```

Linux 库由约定的 lib**名称**.so 引用，并根据名称加载。这是 SWIG 文档中有关 Java 中动态链接问题的[链接](http://www.swig.org/Doc1.3/Java.html#dynamic_linking_problems)，尽管您没有使用 SWIG，但此部分仍然相关。

            回答 #2

赞同：17

时间：2009-05-24T11:19:59.827

你打电话`System.loadLibrary()`不正确。该`loadLibrary`方法采用库名称，例如“hello”，并尝试加载相应的共享对象。在 Unix 上，它将尝试加载“libhello.so”，而在 Windows 上，它将尝试加载“hello.dll”。它将期望文件可以在`java.library.path`.

您可能打算调用的方法是`System.load()`采用完全限定的文件名并加载它。这个方法应该接受一个`File`作为参数，但它需要一个字符串。如果使用`load`，则必须手动处理本地命名约定，但不必依赖于`java.library.path`进行设置。

            回答 #3

赞同：6

时间：2010-07-26T16:53:33.717

请执行下列操作：

1.  将您的 Java 类更改为：

    ```
    class Hello {

        public native void sayHello();

        static {
            System.loadLibrary("hello");
        }

        public static void main(String[] args) {
            Hello h = new Hello();
            h.sayHello();
        }
    } 
    ```

2.  将 hello.so 重命名为 libhello.so：
     `cp hello.so libhello.so`或`mv hello.so libhello.so`

3.  运行为：`java -Djava.library.path=/home/gavin/Work/workspace/JNI/ Hello`

            回答 #4

赞同：5

时间：2009-05-24T11:05:25.393

您是否使用以下方式运行它：

```
java -Djava.library.path=/home/gavin/Work/workspace/JNI Hello 
```

您需要确保共享对象*位于*您的库路径中。

            回答 #5

赞同：3

时间：2017-06-16T08:20:19.167

操作系统：CentOS6.5。JNIHello.java：

```
public class JNIHello {
                static {
                                System.loadLibrary("JNIHello");
                }
                private native void sayHello();
                public static void main(String args[]) {
                                JNIHello jniHello = new JNIHello();
                                jniHello.sayHello();
                }
} 
```

导出 java 主页：导出 JAVA_HOME=/usr/java/jdk1.7.0_67-cloudera/

编译java类：

```
javac JNIHello.java 
```

生成 JNIHello.h：

```
javah JNIHello 
```

在 JNIHello.c 中实现 sayHello：

```
#include <jni.h>
#include <stdio.h>
#include "JNIHello.h"
/*
 * Class:     JNIHello
 * Method:    sayHello
 * Signature: ()V
 */
JNIEXPORT void JNICALL Java_JNIHello_sayHello
  (JNIEnv *env, jobject obj) {
        printf("Hello world!\n");
        return;
} 
```

编译库：

```
gcc -I"$JAVA_HOME/include" -I"$JAVA_HOME/include/linux" JNIHello.c -fPIC -shared -o JNIHello.so 
```

运行 JNIHello：

```
java -Djava.library.path=/home/ldp/caffe/test/ JNIHello
Hello world! 
```

库名称格式参考：

```
3.1.1\. Shared Library Names 
```

每个共享库都有一个特殊的名称，称为“soname”。soname 有**前缀 'lib'**，库的名称，**短语 '.so'**，

[参考链接](http://tldp.org/HOWTO/Program-Library-HOWTO/shared-libraries.html)

        asp.net-mvc - 处理 MVC 中的无效 URL

ID：903537

赞同：7

时间：2009-05-24T11:02:04.387

标签：asp.net-mvc, model-view-controller, asp.net-mvc-routing, invalid-url

如何处理 MVC 中的无效 URL？

例如：当用户输入[http://localhost/User/MyProfile](http://localhost/User/MyProfile)而不是
[http://localhost/User/Profile](http://localhost/User/Profile)时，它​​会抛出异常。

如何处理这个请求？

            回答 #1

赞同：12

时间：2009-05-24T11:46:18.290

您需要首先在 web.config 中添加自定义错误页面 url：

```
<customErrors mode="On" defaultRedirect="~/Error/404" /> 
```

并添加一个控制器来处理无效的 url：  

```
public class ErrorController:Controller
    {
        [ActionName("404")]
        public ActionResult Error404()
        {
            return View("Error");
        }
    } 
```

如果您想将用户重定向到主页，那么您不需要错误控制器，只需修改自定义错误标签：  

```
<customErrors mode="On" defaultRedirect="~/Home/Index" /> 
```

            回答 #2

赞同：1

时间：2009-05-24T11:11:59.733

你是这个意思吗？

```
// Show a 404 error page for anything else.
    routes.MapRoute("Error", "{*url}",
    new { controller = "Error", action = "404" }
); 
```

            回答 #3

赞同：0

时间：2009-05-24T11:05:56.670

我认为每个请求都应该重定向到前端控制器，因此将您的代码包装在将拦截异常的 try/catch 块中，也许您可​​以在 catch 块中重定向到主页，或者简单地使用异常处理程序引发 404 错误.

你的服务器语言是什么？

        .net - 水晶报表怎么能用文字显示数量！

ID：903538

赞同：1

时间：2009-05-24T11:02:16.930

标签：.net, crystal-reports

我正在开发 Windows 窗体应用程序。我需要在水晶报表中用文字显示金额。如何在水晶报表中以文字显示金额？

            回答 #1

赞同：2

时间：2009-05-27T01:04:33.430

在报表中创建一个公式字段并使用 ToWords 内置函数

            回答 #2

赞同：2

时间：2012-11-07T05:54:05.667

尝试使用这个

```
IF {#TOTAL}<100 OR Remainder ({#TOTAL},100 )=0 then
''& ProperCase (towords ({#TOTAL},0))& 'Only ' 
ELSE
'' & ProperCase (towords ({#TOTAL}-Remainder ({#TOTAL},100 ),0)) & ' & ' & ProperCase(ToWords (Remainder ({#TOTAL},100 ),0))&' Only' 
```

            回答 #3

赞同：1

时间：2009-05-24T11:08:36.650

您可以在类对象中编写自定义属性（如果您将其绑定到对象数据源），该属性返回单词中的数量值。

如果要将其绑定到表或存储过程的输出，则需要在结果集中的表中添加一列，并用单词中的数量值填充它。

现在您可以将标签绑定到列/属性以显示单词数量。

编辑：代码示例（希望对您有所帮助）

```
class Program
{
    static void Main(string[] args)
    {
        Expenses e = new Expenses();
        e.Total = 137313959;
        Console.WriteLine(e.TotalInWords);
        Console.ReadLine();
    }

    public class Expenses
    {
        public int Total
        {
            get;
            set;
        }

        public string TotalInWords
        {
            get
            {
                return ConvertToWords(Total);
            }
        }

        private static string ConvertToWords(int amount)
        {
            string s = amount + "";
            int g = (s.Length / 3);//groups of three digits
            int a = (s.Length % 3);
            StringBuilder sb = new StringBuilder();

            if (g == 0) //only three or less digits
            {
                sb.Append(ConvertToHunderds(s, false));
            }
            else
            {
                if (a > 0)
                {
                    sb.AppendFormat("{0} {1} ", ConvertToHunderds(s.Substring(0, a),
                             false), groups[g]);
                }

                int idx = a;

                while (g > 0)
                {
                    sb.AppendFormat(" {0} {1} ", ConvertToHunderds(s.Substring(a, 3), 
                                     g == 1), groups[--g]);
                    a += 3;
                }
            }

            return sb.ToString();
        }

        private static string ConvertToHunderds(string s,bool useAnd)
        {
            char[] c =new char[s.Length];

            for (int i = s.Length-1,j=0; i >=0 && j<c.Length; j++, i--)
            {
                c[j] = s[i];
            }

            if (c.Length == 3)
            {
                if (c[2] == '0')
                    return string.Format("{0}{1}", (useAnd ? "and " : ""), GetTens(c[1], 
                             c[0]));
                else
                    return string.Format("{0} hundred {1} {2}", digits[((int)c[2]) -
                                       48],
                        (useAnd ? "and" : ""),
                        GetTens(c[1], c[0]));
            }
            else if(c.Length==2)
            {
                return useAnd ? "and " : "" + GetTens(c[1], c[0]);
            }
            else
            {
                return digits[((int)c[0]) - 48];
            }
        }

        private static string GetTens(char ten, char one)
        {
            if (one == '0')
                if (ten == '1')
                    return eleven2nineteen[((int)ten) - 49];
                else
                    return tens[((int)ten) - 49];

            if(ten=='1')
                return  eleven2nineteen[((int)one) - 49];

            return tens[((int)ten) - 49] //because tens[0] = 10 so subtract 49 (ascii 1)
                + " " 
                + digits[((int)one) - 48];
        }

        private static string[] groups = new[] { ""/*hundreds group*/, "thousand", 
                             "million", "billion", "trilliion" };
        private static string[] digits = new[] { "zero", "one", "two", "three", "four",
                  "five", "six", "seven", "eight", "nine" };
        private static string[] eleven2nineteen = new[] { "eleven", "twelve", 
                  "thirteen", "fourteen", "fifteen", "sixteen", "seventeen", 
                   "eighteen", "nineteen" };
        private static string[] tens = new[] { "ten", "twenty", "thirty", "fourty", 
              "fifty", "sixty", "seventy", "eighty", "ninety" };
    } 
```

这输出：

```
one hunderd  thirty seven million  three hunderd  thirteen thousand  nine 
hundred and fifty nine 
```

PS：- 这仅用于说明目的。如果（曾经）您使用它，请使用适当的异常处理等。

        c# - 为什么 BitVector 32 结构比 BitArray 更高效？

ID：903548

赞同：16

时间：2009-05-24T11:10:53.837

标签：c#, collections, bitvector

BitArray 和 BitVector 32 结构有什么区别，BitVector 32 结构相对于 BitArray 有什么优势？为什么 BitVector 32 结构比 BitArray 更高效？

提前致谢。

杰...

            回答 #1

赞同：17

时间：2009-05-24T11:27:20.123

对于内部使用的布尔值和小整数，BitVector32 比 BitArray 更有效。BitArray 可以根据需要无限增长，但它具有类实例所需的内存和性能开销。相比之下，BitVector32 仅使用 32 位。

[http://msdn.microsoft.com/en-us/library/system.collections.specialized.bitvector32.aspx](http://msdn.microsoft.com/en-us/library/system.collections.specialized.bitvector32.aspx)

BitVector32 是一个结构体，只占用 4 个字节。BitArray 是一个具有相关开销的类，因此效率较低 - BitArray 将需要至少 8 个字节，然后才能将任何对象添加到它，因为它位于堆上。[更多关于栈和堆的信息在这里](https://stackoverflow.com/questions/477101/heap-versus-stack-allocation-implications-net)。

            回答 #2

赞同：8

时间：2009-05-24T11:20:36.860

以下是[Microsoft 的 BitVector32 文档](http://msdn.microsoft.com/en-us/library/system.collections.specialized.bitvector32.aspx)所述：

`BitVector32`比`BitArray`内部使用的布尔值和小整数更有效。A`BitArray`可以根据需要无限增长，但它具有类实例所需的内存和性能开销。相反，a`BitVector32`只使用 32 位。

的容量`BitVector32`限制为 32 位，即`int`. 因此，索引和屏蔽可以是单个操作。将此与 734 位的位数组进行比较，您想了解是否设置了位 197。想想你将如何做到这一点（从类设计者的角度来看）。

            回答 #3

赞同：4

时间：2013-02-13T20:14:02.383

A[`BitVector32`](http://msdn.microsoft.com/en-us/library/system.collections.specialized.bitvector32.aspx)得到了提升，[`BitArray`](http://msdn.microsoft.com/en-us/library/system.collections.bitarray.aspx)因为它只是一个 32 位整数并且没有与类相关的开销（主要是内存开销）。

这意味着如果您需要存储超过 32 个布尔值，那么您将需要使用`BitArray`或多个`BitVector32`. 由于多个`BitVector32`可能是繁琐的，您可能希望将它们放入一个数组或一个类中，这将消除性能提升。

简而言之，如果您需要存储 32 个或更少的布尔值，请使用`BitVector32`. 如果您需要存储更多，然后在盲目选择之前评估您的需求和编码条件`BitVector32`，否则您可能会为自己重新发明做更多的工作`BitArray`而看不到任何性能优势。

注意：在大多数情况下，我更喜欢使用[标记的枚举](http://msdn.microsoft.com/en-us/library/vstudio/system.flagsattribute.aspx)而不是`BitVectore32`. 请参阅[此问题](https://stackoverflow.com/questions/8447/enum-flags-attribute)以获取解释和一些好技巧。

        javascript - 正确禁用提交按钮

ID：903550

赞同：1

时间：2009-05-24T11:12:58.217

标签：javascript, jquery, html

这是我用来禁用按钮的代码

```
 $("#btnSubmit").attr('disabled', 'disabled')
            $("#btnSubmit").disabled = true; 
```

这是我的提交按钮

```
<input id="btnSubmit" class="grayButtonBlueText" type="submit" value="Submit" /> 
```

该按钮虽然看起来已禁用，但您仍然可以单击它.. 这是用 FF 3.0 和 IE6 测试的

我在这里做错了吗？

            回答 #1

赞同：4

时间：2009-05-24T11:18:54.307

如果它是一个*真实的*形式，即**不是 javascript 事件处理**，这应该工作。

如果您使用 onClick 事件处理按钮，您会发现它可能仍会触发。如果你这样做，你最好在你的JS中设置一个变量，比如buttonDisabled，并在你处理onClick事件时检查那个var。

否则试试

```
$(yourButton).attr("disabled", "true"); 
```

如果在所有这些之后，你仍然无处可去，你可以使用 jquery 手动“打破”按钮（现在这变得越来越严重了）：

```
$(submitButton).click(function(ev) {
    ev.stopPropagation();
    ev.preventDefault();
}); 
```

这应该会阻止按钮像按钮一样工作。

            回答 #2

赞同：1

时间：2009-05-24T11:23:32.610

根据表单提交的处理方式，您可能还需要删除任何单击处理程序和/或添加一个中止提交的处理程序。

```
$('#btnSubmit').unbind('click').click( function() { return false; } ); 
```

当（如果）您重新启用按钮时，您必须再次添加点击处理程序。

            回答 #3

赞同：0

时间：2009-05-24T11:35:31.557

您需要将 Back/Prev 按钮处理到浏览器中。示例如下

1）创建form.js：

```
(function($) {
    $.enhanceFormsBehaviour = function() {
        $('form').enhanceBehaviour();
    }

    $.fn.enhanceBehaviour = function() {
        return this.each(function() {
            var submits = $(this).find(':submit');
            submits.click(function() {
                var hidden = document.createElement('input');
                hidden.type = 'hidden';
                hidden.name = this.name;
                hidden.value = this.value;
                this.parentNode.insertBefore(hidden, this)
            });
            $(this).submit(function() {
                submits.attr("disabled", "disabled");
            });         
            $(window).unload(function() {
                submits.removeAttr("disabled");
            })
         }); 
    }
})(jQuery); 
```

2) 添加到您的 HTML：

```
<script type="text/javascript">
    $(document).ready(function(){
        $('#contact_frm ).enhanceBehaviour();
    });
</script>

<form id="contact_frm" method="post" action="/contact">
   <input type="submit" value="Send" name="doSend" />
</form> 
```

完毕 ：）

        c++ - C 或 C++：用于分解整数的库？

ID：903555

赞同：9

时间：2009-05-24T11:13:49.807

标签：c++, c, algorithm, prime-factoring

似乎有几种非常快速的素数分解算法（看起来理想的一种是二次筛选）。但是，为了简单起见，我不想自己制作（可能很差）实现，而是使用现成的库。

我需要能够有效地分解最多 15 位的整数。正因为如此，我不是在寻找必须渐近最佳缩放的算法，因为我们可以假设被分解的数字小于 10 ^(15)。

我已经查看了[Wikipedia 的 Quadratic Sieve 页面](http://en.wikipedia.org/wiki/Quadratic_sieve#Implementations)上列出的一些实现。然而，一些实现似乎并没有得到很好的维护。有些没有文件；等等！我检查了一些著名的库，例如 Boost，是否有分解方法，但它们似乎没有。

谁能推荐一个符合上述标准的图书馆？

            回答 #1

赞同：1

时间：2009-05-24T12:15:25.953

查看Jason Papadopoulos 的[MSIEVE](https://github.com/radii/msieve)库以分解大整数。

Msieve 是我努力理解和优化如何使用最强大的现代算法分解整数的结果。

本文档对应于 Msieve 库的 1.46 版。不要期望仅仅通过阅读它就能成为保理专家。我已经包含了一个相对完整的参考列表，如果您想将代码视为不仅仅是一个黑盒来解决您的因式分解问题，您可以并且应该查找这些参考列表。

            回答 #2

赞同：-1

时间：2009-05-24T11:21:52.270

[GMP-ECM](http://gforge.inria.fr/projects/ecm/)怎么样？

        oop - 单例模式——Head First Design Patterns 一书中的疑问

ID：903556

赞同：6

时间：2009-05-24T11:17:04.403

标签：oop, singleton

在第 175 页，有一个 Chocolate Boiler 类的示例。像这样的东西：

```
public class ChocolateBoiler {  

  private boolean empty;  
  private boolean boiled;  

  public ChocolateBoiler {  
    empty = true;  
    boiled = false;  
  }  
 // and then three methods to fill, drain and boil which changes the  
 // status of these two flag depending of situation
} 
```

在“脑力”一节中，他们提出了一个问题“如果在应用程序中创建了多个 ChocolateBoiler 实例，事情会如何出错？”

我不确定这门课有什么问题。为什么我们在这里引入单例模式？这两个标志不是静态的，因此每个实例一个。那么如何创建多个实例会搞砸呢？

            回答 #1

赞同：2

时间：2009-05-24T11:20:15.287

问题不在于制作对象的实例。

这是关于由对象的两个实例引起的混乱，这两个实例都声称具有 ChocolateBoiler 的状态。

如果某个 Object（例如 Cooker）认为它具有 ChocolateBoiler 的状态，而某些其他 Object（例如 Recipe）事物具有 ChocolateBoiler 的状态，那么现在会发生什么？

由于变量*是*实例变量，ChocolateBoiler 对象不会同意 ChocolateBoiler 的状态。现在会发生什么？

            回答 #2

赞同：2

时间：2009-05-24T11:26:49.547

只有一个 ChocolateBoiler 才有问题，如果只有一个，它应该是一个单例。

            回答 #3

赞同：1

时间：2009-06-07T22:07:50.873

当我阅读它时，单例中的巧克力锅炉的整个例子让我很困扰。  

在一个非常基本的层面上，我不明白为什么当你只有一个物理东西时有必要在软件中强制执行这一事实。如果你得到另一个会发生什么？你打算做什么，将第二个添加到同一个单例中？制作2个不同的单身人士？一个简单的全局变量就可以完成这项工作。

IMO，它不是锅炉本身，您只能拥有一件事，它*可以访问*该特定锅炉的控件。你不能让第二个人开始为其他人制作新批次的巧克力，或者甚至允许同一个人在第一批完成之前制作第二批。从这个角度来看，一个简单的排队或批处理系统就可以完成这项工作。使用书中的另一种模式，命令模式将是一种更好的处理方式，因为只有一个女服务员，所有新订单都会排队，直到厨师完成当前的食物订单。（呃，如果你没有看过这本书，我刚才说的可能没有多大意义，对不起）

也许我只是不明白这一点。我以前没有做过太多的 OOP 或任何设计模式的事情，因此我正在失去工作机会，所以我正在阅读它。  

            回答 #4

赞同：1

时间：2009-05-24T11:35:25.847

我相信在那个例子中你只有一个巧克力锅炉。因此，您应该只能创建代表它的对象的一个​​实例。如果您被允许创建多个实例，那么您可能会`if (boiler.hotEnough()) boiler.stop()`在系统中的某个位置发出命令，并且会惊讶于尽管锅炉已经太热了，但它并没有停止，因为您正在与锅炉的一些“死”实例交谈，它返回`hotEnough()`：假。

使用单例模式，您可以确保无论您在代码中的哪个位置使用 Boiler.getInstance()，您都将获得唯一的锅炉对象，并且当您与它交谈时，它会按照您的预期进行.

        python - Python 的 'with' 语句与 'with .. as'

ID：903557

赞同：16

时间：2009-05-24T11:17:24.107

标签：python, syntax

由于不同，我刚刚脱掉了头发，我想知道Python 2.5 中的*真正区别是什么。*

我有两个代码块（`dbao.getConnection()`返回一个 MySQLdb 连接）。

```
conn = dbao.getConnection()
with conn:
    # Do stuff 
```

和

```
with dbao.getConnection() as conn:
    # Do stuff 
```

我认为这些会产生相同的效果，但显然不是因为`conn`后一个版本的对象是`Cursor`. 游标是从哪里来的，*有*没有办法以某种方式将变量初始化和 with 语句结合起来？

            回答 #1

赞同：35

时间：2009-05-24T20:34:40.910

乍一看可能有点混乱，但是

```
with babby() as b:
    ... 
```

不等于*_*

```
b = babby()
with b:
    ... 
```

To see why, here's how the context manager would be implemented:

```
class babby(object):
    def __enter__(self):
        return 'frigth'

    def __exit__(self, type, value, tb):
        pass 
```

In the first case, the name `b` will be bound to whatever is returned from the `__enter__` method of the context manager. This is often the context manager itself (for example for file objects), but it doesn't have to be; in this case it's the string `'frigth'`, and in your case it's the database cursor.

In the second case, `b` is the context manager object itself.

            回答 #2

赞同：21

时间：2009-05-24T18:18:37.397

一般来说，语句`as`部分分配的值将[是上下文管理器的方法](http://docs.python.org/library/stdtypes.html#contextmanager.__enter__)返回的值。`with`[`__enter__`](http://docs.python.org/library/stdtypes.html#contextmanager.__enter__)

            回答 #3

赞同：1

时间：2009-05-24T11:36:54.767

with 语句允许例如确保事务正确启动和停止。

在 python 中的数据库连接的情况下，我认为很自然的事情是在 with 语句的开头创建一个游标，然后在它的结尾提交或回滚事务。

从 with 语句的角度来看，您给出的两个块是相同的。您也可以将 as 添加到第一个并获取光标。

您需要检查 with 支持是如何在您使用的对象中实现的。

请参阅[http://docs.python.org/whatsnew/2.5.html#pep-343-the-with-statement](http://docs.python.org/whatsnew/2.5.html#pep-343-the-with-statement)

        c# - Expression.Lambda() 的参数问题

ID：903558

赞同：2

时间：2009-05-24T11:17:37.180

标签：c#, lambda

**更新：这确实有效，我很愚蠢:(**

我有以下扩展方法

```
public static string ExtMethod(this object self, object myparameter); 
```

在运行时，这可以通过多种方式调用，我认为这些都是可能性：

```
Expression<Func<T, string>> expr = x => x.property.ExtMethod(5);
Expression<Func<T, string>> expr = x => x.property.ExtMethod(new object());
Expression<Func<T, string>> expr = x => x.property.ExtMethod(someMethod());
Expression<Func<T, string>> expr = x => x.property.ExtMethod(x.someMethod());
Expression<Func<T, string>> expr = x => x.property.ExtMethod(x.OtherProperty); 
```

我需要做的是评估“ `myparameter`”，给定“ `expr`”和“ `T`”

`x`由于在中使用的两种情况`myparameter`，我认为我需要创建表单的委托：

```
Expression<Func<T, object>> expr = x => [myparameter expression here] 
```

我认为这会起作用：

```
var extMethodExpr = expr.Body as MethodCallExpression;
var myparameterExpr = extMethodExpr.Arguments[1];

var myparam = Expression.Lambda(myparameterExpr, expr.Parameters).Compile().Invoke(someT) 
```

但是对于不涉及的表达式`x`，~~我得到`TargetParameterCountException`:(~~

在这些情况下，如果我这样做：

```
var myparam = Expression.Lambda(myparameterExpr).Compile().Invoke(someT) 
```

它工作正常。

我该如何解决这个问题？

谢谢

            回答 #1

赞同：6

时间：2009-05-24T11:42:12.357

好的; 到了它的底部；在行中：

```
var myparam = Expression.Lambda(myparameterExpr).Compile().Invoke(someT); 
```

如果您不尝试传入 a `someT`，这将适用于那些不涉及`x`参数的表达式；对于那些这样做的人，您需要告诉 lambda 包含参数（与原始 lambda 相同的参数） - 只需：

```
var myparam = Expression.Lambda(myparameterExpr,
             outerLambda.Parameters[0]).Compile().Invoke(someT); 
```

这是一些评估内部参数的工作代码（给定参数类型的实例）；请注意，即使参数*不*涉及`x`- 我也会使用该参数，否则，它将如何处理实例？

```
using System;
using System.Linq.Expressions;
using System.Reflection;
class Foo {
    public string Bar {get;set;}
    public int someMethod() { return 4; }
    public int OtherProperty { get { return 3; } }
}
static class Program
{
    static int someMethod() { return 3; }
    static void Main()
    {
        Foo foo = new Foo();
        Test<Foo>(x => x.Bar.ExtMethod(5), foo);
        Test<Foo>(x => x.Bar.ExtMethod(new object()), foo);
        Test<Foo>(x => x.Bar.ExtMethod(someMethod()), foo);
        Test<Foo>(x => x.Bar.ExtMethod(x.someMethod()), foo);
        Test<Foo>(x => x.Bar.ExtMethod(x.OtherProperty), foo);
    }
    static void Test<T>(Expression<Func<T, string>> expr, T instance)
    {
        if (expr.Body.NodeType != ExpressionType.Call)
        {
            throw new InvalidOperationException("Call expected");
        }
        var call = ((MethodCallExpression)expr.Body);
        if (call.Method != typeof(Program).GetMethod(
            "ExtMethod", BindingFlags.Static | BindingFlags.NonPublic))
        {
            throw new InvalidOperationException("ExtMethod expected");
        }
        // we know that ExtMethod has 2 args; pick myParameter (the 2nd);
        // then build an expression over arg, re-using our outer param
        var newLambda = Expression.Lambda<Func<T, object>>(
            call.Arguments[1], expr.Parameters[0]);

        // evaluate it and show the argument value
        object value = newLambda.Compile()(instance);
        Console.WriteLine(value);
    }
    static string ExtMethod(this object self, object myParameter) {
        return self.ToString();
    }
} 
```

            回答 #2

赞同：0

时间：2009-05-24T11:32:54.603

如果您检查 expr.Parameters.Count 并且如果它为 0，那么在没有参数的情况下调用会怎样？

        python - python、正则表达式、命名组和“逻辑或”运算符

ID：903562

赞同：5

时间：2009-05-24T11:18:20.717

标签：python, regex

在 python 正则表达式中，命名组和未命名组都用 '(' 和 ')' 定义。这会导致一种奇怪的行为。正则表达式

```
"(?P<a>1)=(?P<b>2)" 
```

与文本“1=2”一起使用将找到值为“1”的命名组“a”和值为“2”的命名组“b”。但是，如果我想使用“逻辑或”运算符并连接多个规则，请使用以下正则表达式：

```
"((?P<a>1)=(?P<b>2))|(?P<c>3)" 
```

与相同的文本“1=2”一起使用将找到一个值为“1=2”的**未命名组。**我知道正则表达式引擎将包含组“a”和“b”的“（”和“）”视为未命名组并报告它已找到。但我不想报告未命名的组，我只想使用“|” 为了将多个正则表达式“粘合”在一起。无需创建任何寄生的未命名组。这是在python中这样做的一种方法吗？

            回答 #1

赞同：14

时间：2009-05-24T11:21:18.187

用于`(?:)`摆脱未命名的组：

```
r"(?:(?P<a>1)=(?P<b>2))|(?P<c>3)" 
```

从[re](http://docs.python.org/library/re.html)的文档中：

(?:...) 正则括号的非分组版本。匹配括号内的任何正则表达式，但组匹配的子字符串在执行匹配后无法检索或稍后在模式中引用。

顺便说一句，交替运算符的`|`优先级很低，以便在像您这样的情况下不需要括号。您可以在正则表达式中删除额外的括号，它将继续按预期工作：

```
r"(?P<a>1)=(?P<b>2)|(?P<c>3)" 
```

        language-agnostic - 做“足够好”的软件的后果

ID：903572

赞同：11

时间：2009-05-24T11:22:51.550

标签：language-agnostic

做“足够好”的软件对你作为程序员有什么好处吗？

以下是我对此的看法：

好吧，来自 JoelOnSoftware 的 Joel Spolsky 说，程序员感到无聊是因为他们做得“足够好”（即使没有经过优化也能满足要求的软件）。我同意，因为人们喜欢做正确的事情。在光谱的一侧，我想做到：

1.  以这样一种方式优化软件，使我可以尽可能地应用我在大学获得的所有数学和计算机科学知识。
2.  是否所有可能的软件开发过程都说：从存储库获取规范、生成代码、构建、测试、部署，并在单个自动化构建步骤中完成手册。

另一方面，我们人类的一个特征是我们喜欢多样性。为了让我们保持吸引力（热爱编程），我们需要从一个项目或技术跳到另一个项目或技术，以免我们感到无聊并获得“乐趣”。

我想听听你的意见，如果对作为程序员或人类的你做“足够好”的软件有什么好的或坏的副作用？

            回答 #1

赞同：21

时间：2009-05-24T11:43:14.663

实际上，我认为足够优秀的程序员比那些蓝天确保一切都完美的程序员更好。

那是因为，虽然我是一名程序员，但我也是一名商人，我意识到程序*不是*为了满足程序员的需求，而是为了满足特定的业务需求。

实际上，我在另一个问题中争论过关于检测赢得井字游戏/noughts-and-crosses 游戏的最佳方法（面试问题）。

我收到的最佳解决方案来自一位候选人，他简单地用`if`陈述检查了所有 8 种可能性。有一些给出了一个通用的解决方案，虽然可行，但完全没有必要，因为规格非常明确，它仅适用于 3x3 板。

许多人认为我的限制太大，“成功”的解决方案是垃圾，但我认为编写完美的、可扩展的完美软件不是程序员的工作。满足业务需求是他们的工作。

如果业务需求允许他们自由地做超出必要的事情，那很好，但大多数软件和修复程序都是在时间和成本限制下交付的。程序员（或任何职业）不会在真空中工作。

            回答 #2

赞同：16

时间：2009-05-24T11:40:16.727

作为一名程序员，我想编写没有缺陷的优秀软件。我对*镀金*并不特别感兴趣，即添加不必要的功能以“改进”软件的行为，尽管我们都在一定程度上这样做了。从这个意义上说，我对“足够好”的软件感到满意，如果你所说的“足够好”是指我已经完成了客​​户要求的工作，同时，还精心制作并确保了它的高质量。

困扰我的是当我走捷径并编写蹩脚的、未经测试的代码时。我讨厌编写有缺陷的代码，或者我一直未能将其重构为更好的设计。当我让大量的技术债务潜入 - 忙于编写新功能而不是在添加新功能时不断改进旧功能时 - 然后我知道最终我会拥有一些东西，而客户可能会开心就好，我不会。

幸运的是，在我的工作场所，管理层知道保持代码整洁的价值，我也知道不执着于难以捉摸的完美目标的价值。没有代码是完美的，但“足够好”必须意味着代码是精心设计的。我已经并且仍在学习，对满足客户要求的代码感到满意，并且最好的功能是不需要实现的功能。幸运的是，我有足够的工作来做因为不需要它们而删除功能是一件好事。

            回答 #3

赞同：8

时间：2009-05-24T12:38:23.223

根据我的经验，“足够好”总是包括 hack、草率、糟糕的评论和意大利面条地狱，从而导致缺乏可扩展性、错误、滞后，并阻止其他人能够有效地在你的工作上进行构建。

Pax，虽然我承认您关于业务需求和实用主义的观点，但“按部就班”做事是*为了*业务方面的。“现在已经足够好了”和“让事情快点好起来”总是会导致更多的工作时间在以后修复所有事情上，或者在涉及到的时候彻底重做，而不是第一次做正确的事情。写“书”是有原因的。

            回答 #4

赞同：4

时间：2009-05-24T11:52:35.750

IMO“足够好”和蹩脚的代码之间有很大的区别。对我来说，“足够好”就是满足需求（功能性和非功能性）。我认为人们认为“足够好”意味着走捷径或不优化代码是危险的。如果非功能性要求需要优化代码，那么这就是我对“足够好”的定义的一部分。

            回答 #5

赞同：4

时间：2009-05-24T11:58:56.783

您问题的关键是如何定义“好”。对于业务人员来说，“好”软件是解决业务需求的软件。在这种情况下，更多的是确保规范被充分理解和正确实施。业务人员很可能不在乎程序是否没有它可能的速度或内存效率。

想想你使用的商业软件，它完美吗？我真的不认识任何人，包括我在微软的朋友，谁会争辩说 Windows 中的代码是“完美的”或任何接近它的东西。但不可否认的是，Windows 已经（并且一直是）“足够好”，可以让数百万人每天使用它。

这个问题可以追溯到编程之前很久。我相信你一定听过“如果它没有坏，就不要修理它”或法语的原版“Le mieux est l'ennemi du bien”。可能是伏尔泰写过“善是伟大的敌人”。

并且考虑一下如果招聘经理决定停止招聘“优秀”程序员并坚持要求每个申请人在大学里的平均成绩都是完美的 4.0 会发生什么，我永远不会得到程序员的工作;-)

所以对我来说，在时间和预算限制的情况下，尽你所能做到最好。有了更多的时间或更多的钱，我总是可以做得更好。

            回答 #6

赞同：4

时间：2009-05-24T12:14:09.543

“足够好”在旁观者的眼中。很多时候，“足够好”是不称职的人的避难所，他们写的东西给人一种满足工作要求的印象。我的“足够好”不太可能与他们的“足够好”相同。

归根结底，我们所做的一切都必须权衡取舍。有些人会做出错误的权衡并交付糟糕的软件，而有些人会做出错误的权衡并无法交付。很少有人能够做出正确的权衡并提供真正足够好的软件。

            回答 #7

赞同：1

时间：2009-05-24T12:25:22.673

我们至少要考虑质量的两个方面：

*   软件质量：软件是否满足预期的目标/要求？我们是否提供具有严重错误的构建？终端用户操作方便吗？
*   代码质量：维护代码有多难？实现新功能容易吗？

如果您正在构建产品化软件，我认为最好假设它在两个方面都不够好。每一个小功能都很重要，如果用户找不到他们需要的东西或者产品不够稳定，他们就会看看竞争对手。您还希望尽快实施新功能，以便在市场上拥有竞争优势。

如果您正在构建定制业务软件，最终用户和决策者通常不是同一个人，情况就会变得有趣，那么功能/质量/金钱权衡就成为谈判过程的一部分。我们通常做的是在这三个方面设置“足够好”的约束：我们有一组要求要满足，一个质量要保持，而且通常没有足够的时间来保持两者。

在这个过程中通常被遗忘的是第二点：代码质量或可维护性。我们程序员明白，烂代码迟早会报复并导致严重的错误或维护成本。决策者不会。问题是，责任和风险由您（您的公司、您的部门等）承担，如果出现问题，您将首先受到责备。

我的观点是：为了软件质量，按照客户告诉你的去做，他们最清楚哪些特性对他们很重要，软件可能有多少错误等等。对于代码质量和可维护性：尽你所能，学会做更多并教别人做同样的事情。这就是我从中获得乐趣的地方。

            回答 #8

赞同：0

时间：2009-05-24T12:16:13.533

取决于您所说的“足够好”是什么意思。我可以在设计级别看到一些风险，如果你做得足够好，你可能会发现维护和扩展你的应用程序很痛苦。

            回答 #9

赞同：0

时间：2009-05-24T14:31:58.923

我认为编程是一门艺术。一门需要效率的艺术。高效的代码与漂亮的代码不兼容吗？我不信。事实上，我认为当你创造性地解决问题时，它可能意味着成倍的表现。我认为编程不应该只是针对每个新需求学习一个新库，也不应该是关于错误跟踪和修复。我觉得应该是关于美的。当然，代码并不总是艺术，有时对遇到的问题应该务实。

        design-patterns - 过分关注测试的好处总体上是一件坏事吗？

ID：903573

赞同：11

时间：2009-05-24T11:23:04.080

标签：design-patterns, testing, tdd

我的意思是，有时架构师希望以牺牲其他重要力量为代价来简化和提高可测试性。   

例如，我正在审查一个非常复杂的应用程序，它是通过广泛使用过度支持测试的设计模式来实现的，例如 IoC、DI、AOP 等……

现在，通常我喜欢这些东西，但这个系统**应该**是简单得多 - 虽然不仅仅是数据库上 CRUD 的简单 Web 前端，但它仍然没有比这复杂得多（即使考虑到一些内部工作流程、流程等）。另一方面，仅仅审查代码就成为了一个主要的痛苦，几乎不可读（即使它写得很好），并且编码它一定是一种痛苦。   

实现的复杂性明显违反了 KISS（原则，而不是乐队）......并且“唯一”的好处是提高了可测试性，使用测试框架和模拟......

现在，在你们 TDD 粉丝跳我之前，我并不是在贬低可测试性的重要性，而是在质疑考虑这种特定力量的至高无上（相对于所有其他力量）。

还是我错过了什么？

我想补充一点——在我看来，所有关于“可测试性”的讨论都专门针对**单元测试**，这与整体系统测试不同，并且当各个单元集成在一起时可能会导致错过测试. 至少，这似乎是 IoC/DI 测试的重点……

另外，我要指出，这个系统（以及我见过的其他系统）每个接口只有一个具体的对象，而 IoC/DI仅用于-您猜对了-用测试模型替换具体对象仅用于测试。  

我觉得有必要[在 IoC 上添加来自 Wikipedia 的](http://en.wikipedia.org/wiki/Inversion_of_Control#Advantages_and_disadvantages_of_inversion_of_control)这句话：

过程式编程的危险以意大利面条代码结束，而使用控制反转的危险以**通心粉代码结束**

是的，这正好表达了我的感受：D

            回答 #1

赞同：13

时间：2009-05-24T12:39:32.473

TDD 做得好可以提高可读性。TDD 做得不好，即没有考虑其他重要原则，会降低可读性。

我在 90 年代中期共事过的一个人会说：“你总是可以通过添加一层间接来使系统更灵活。你总是可以通过移除一层间接来使系统更简单。” 灵活性和简单性都是系统的重要品质。这两个原则通常可以和谐共存，但往往相互矛盾。如果你在一个极端或另一个极端上走得太远，你就会远离平衡这两个原则的理想。

TDD 部分是关于测试，部分是关于设计。做得不好的 TDD 可能过于倾向于灵活性或简单性。它可以推动太多的灵活性。对象变得更可测试，并且通常更简单，但是域问题的固有复杂性随后被从对象中推出到对象的交互中。我们获得了灵活性，在天真的眼中，它看起来好像我们获得了简单性，因为我们的对象更简单了。然而，复杂性仍然存在。它从对象中移出，进入对象交互，在那里更难控制。这里有一些代码异味可以作为危险信号 - 具有数百个小对象但没有更大对象的系统是一个，只有一行方法的许多对象是另一个。

做得不好的 TDD 也会朝着另一个方向发展，即过于简单。因此，我们通过先编写测试来进行 TDD，但这对我们的设计影响不大。我们仍然有很长的方法和巨大的对象，而这些代码异味可能会警告这个问题。

现在，只要应用得当，TDD 本质上不会让您在任何一个方向上失去平衡。使用其他做法让您保持正轨。例如，在你做之前画出你正在做的事情。显然，并非总是如此。有些事情太简单了。有些图片值得保存，有些只是帮助我们形象化问题的草图，而且我们在不同程度上主要是视觉学习者。如果你不能画出问题的图景，你就不理解它。

这对 TDD 有什么帮助？这将有助于防止系统在灵活性方面走得太远，远离简单方面。如果你画的画很丑，那就是危险信号。有时它是必要的，但通常当你画图时，你的大脑会很快看到可以简化的东西。该解决方案变得更加优雅和简化，更易于维护，并且工作起来更愉快。如果您不能或不会为您的系统绘制图片，那么您将失去这个让您的软件更可靠、更优雅、更美观且更易于维护的机会。

应用这一点需要经验，一些编码人员永远不会理解良好平衡所提供的价值。没有可以运行的指标告诉您您来对了地方。如果有人给你一个规定的方法来达到那个和谐点，他就是在骗你。更重要的是，他很可能在不知不觉中自欺欺人。

所以，我对你的问题的回答是“是”：在不忘记其他好的原则的情况下测试一切。

如果与其他良好做法不平衡，任何好的做法都会让你偏离正轨。

            回答 #2

赞同：6

时间：2009-05-24T11:30:03.567

要回答您的一般性问题，我会说“一切都适度”。强调可测试性当然是一件好事。但当它以排除可读代码或逻辑 API 为代价时，则不然。

            回答 #3

赞同：6

时间：2009-05-24T11:36:51.943

“我错过了什么？”

是的。

这东西行得通，不是吗？  

而且，更重要的是，您可以证明它有效。  

与它实际工作并且您可以证明它确实工作的事实相比，为可测试性增加的相对复杂程度并不是很有趣。此外，您可以进行更改并证明您没有破坏它。

替代方案（可能有效，也可能无效，不可能证明它是否有效，不能在不破坏它的情况下进行更改）将软件的价值降低到零。

**编辑**

“复杂性”是一个很模糊的概念。复杂性有客观的衡量标准。更重要的是复杂性增加所创造的价值。不断增加的复杂性为您提供可测试性、可配置性、后期绑定、灵活性和适应性。  

此外，复杂性的客观测量通常侧重于方法内的编码，而不是类和对象之间关系的更大复杂性。复杂性似乎是客观的，但它并没有在软件架构的所有层中定义。

“可测试性”也很滑。可测试性可能有客观的衡量标准。然而，大多数情况下，这些都转移到了测试覆盖率上。测试覆盖率并不是一个非常有意义的指标。生产崩溃的可能性如何随测试覆盖率而变化？它没有。

您可以将复杂性归咎于对可测试性的关注。您可以将复杂性归咎于很多事情。如果您仔细观察高度可测试的代码，您会发现它还具有高度的灵活性、可配置性和适应性。

将“可测试性”单独作为“复杂性”的根本原因没有抓住重点。

关键是有许多相互关联的质量因素。“It Works”是总结最重要内容的一种方式。其他不太重要的，包括适应性、灵活性、可维护性。这些额外的因素通常与可测试性相关，它们也可以被负面地描述为“复杂性”。

            回答 #4

赞同：4

时间：2009-05-25T13:20:15.020

我亲眼目睹了通过所有单元测试、通过所有自动化接口测试、通过负载测试、几乎通过所有测试的第一手网站，但很明显，在人类查看时存在问题。

这导致代码分析，发现内存泄漏、缓存问题、错误代码和设计缺陷。当遵循不止一种测试方法并且所有测试都通过时，这是如何发生的？没有一个“单元”有内存泄漏或缓存问题，只有整个系统。

我个人认为这是因为一切都是为了通过测试而编写和设计的，而不是为了优雅、简单和灵活的设计。测试有很多价值。但仅仅因为代码通过了测试，并不意味着它就是好代码。这意味着它是“图书智能”代码，而不是“街头智能”代码。

            回答 #5

赞同：3

时间：2009-05-24T12:00:05.877

在我看来，给定一个足够大或足够重要的软件，增加一些复杂性来提高可测试性是值得的。此外，根据我的经验，复杂性难以理解的地方是添加抽象层以包裹一段本身无法测试的代码（如密封的框架类）。当从可测试性的角度作为第一原则编写代码时，我发现代码实际上很容易阅读，并且没有必要的复杂性。

我实际上非常抗拒在我可以避免的地方增加复杂性。例如，我还没有转向 DI/IoC 框架，我更喜欢仅在需要测试的地方手动注入依赖项。另一方面，我最终采用了一种“增加”复杂性的实践——比如模拟框架——我发现复杂性实际上比我担心的要少，而好处比我想象的要多。也许，我最终会发现这对于 DI/IoC 框架也是如此，但我可能不会去那里，直到我有一个足够小的项目来进行实验，而不会通过学习新东西来不合理地延迟它。

            回答 #6

赞同：3

时间：2009-05-24T21:43:55.717

*“还是我错过了什么？”*

代码的可测试性与代码的复杂性之间存在隐含的直接关系。如果这是你的经历，我会说[你做错了](http://www.doingitwrong.com/)。

代码不必为了更可测试而变得更复杂。将代码重构为更具可测试性确实倾向于使代码更灵活且更小。这并不一定意味着更复杂（这已经是一个已加载的术语）或需要远距离行动。

不了解细节，只能给出笼统的建议。检查您不只是使用每周模式。如果您有一个需要大量设置或复杂方法来覆盖其行为的方法，通常会有一系列更简单、确定性的方法在里面。提取这些方法，然后您可以更轻松地对它们进行单元测试。

测试不必像测试的代码那样干净和精心设计。通常，最好在测试中做一些通常会令人讨厌的黑客攻击，而不是对代码进行大量的重新设计。这对于故障测试特别有用。需要模拟数据库连接失败？用总是失败的方法简单地替换 connect() 方法。需要知道磁盘填满时会发生什么？将文件打开方法替换为失败的方法。一些语言很好地支持这种技术（Ruby、Perl），而另一些则不然。通常可怕的风格变成了一种强大的测试技术，它对你的生产代码是透明的。

我要明确说的一件事是永远不要将仅对测试有用的代码投入生产。任何类似的东西`if( TESTING ) { .... }`都是正确的。它只会使代码混乱。

            回答 #7

赞同：3

时间：2009-05-26T15:43:35.340

可测试的产品是提供机会回答有关它的问题的产品。与质量一样，可测试性是多维和主观的。当我们将产品评估为（不可）可测试时，重要的是要认识到可能会增加对某些人的可测试性或对其他人的不必要的复杂性。

具有大量单元测试的产品可能非常适合程序员测试，但如果没有自动化钩子，那么测试工具匠可能很难测试该产品。然而，同样的产品，如果它有一个干净的工作流程、一个优雅的用户界面和日志记录，它可能会被交互式黑盒测试器很好地测试。没有任何单元测试的产品可能写得如此干净和清晰，以至于它非常易于检查和审查，这是另一种形式的测试。

[我在这里](http://adam.goucher.ca/?p=141)谈论可测试性。[詹姆斯巴赫在这里](http://www.satisfice.com/tools/testable.pdf)谈到它。

---迈克尔 B.

            回答 #8

赞同：2

时间：2009-05-26T13:51:48.640

（这完全是从程序员的角度编写的。对于更面向客户的答案，我推荐 Michael Bolton 的回复。）

如果您正在编写的应用程序少于 10 行代码，那么是的，添加测试会大大增加复杂性。你可以看看它并手动测试它，你可能会没事的。在 100 行，不多，1,000 行，不多，10,000 行，100,000 行……等等。

第二个轴是变化。这个海湾基地/永远/会改变吗？多少？代码更改得越多，测试就越有价值。

所以，是的，对于一个 150 行代码的应用程序，它是一个 edi-format-to-edi-format 转换脚本，它以永远不会改变的批处理模式运行，繁重的单元测试可能会过度杀戮。

通常，对于大型应用程序，我发现将代码更改为可测试可以提高设计和 API 的质量。因此，如果您正在编写更大的东西或将迭代开发的东西并且认为（自动化）单元测试具有高成本/低价值，我会认真研究为什么您认为是这种情况。

一种解释是你的老板有模式成瘾。另一个可能是您将模式和测试视为是/否全有或全无的讨论。第三个是代码已经写好了，而你害怕重写可测试的代码。如果有任何一种情况，我会建议手术方法——专注于一些快速增加价值的高性价比测试。随着代码的进展，慢慢地增加你的测试套件。当您看到价值和简单性而不是复杂性时，重构模式。

            回答 #9

赞同：1

时间：2009-05-24T11:31:44.887

这种方法的好处会回来，**如果**应用程序会变得足够大。否则 - 这只是浪费时间。有时甚至拖放“编码”并遵循 SmartUI 模式也足够令人满意。

            回答 #10

赞同：1

时间：2009-05-24T12:30:49.980

从描述中，听起来该项目失去了 YANGI 的踪迹，开发了大型结构，以便在需要时进行测试。

在 TDD 中，一切都是通过测试来证明的，因此拥有所有这些 IoC、DI、AOP 的事实要么是使现有测试通过的最简单的解决方案，要么是（更有可能）一个过度设计的解决方案来保持代码可测试。

我见过的导致这种复杂性的一个错误是希望让测试遵循设计，而不是相反。可能发生的情况是，保持某种难以测试的设计的愿望导致引入各种变通方法来打开 API，而不是开发更简单、更容易测试的 API。

            回答 #11

赞同：1

时间：2009-05-24T14:35:26.670

无论好坏，TDD 帮助我将我的应用程序分解为更易于管理的组件，在这些组件中，我独立测试项目的能力迫使我保持​​简洁。当我向其他人介绍我的代码时，这些测试也可以作为很好的文档来源。通过测试可以很好地检查应用程序的工作原理，其中事物被充分隔离，因此您可以将头绕在功能部分上。另一个不错的产品是，当您在应用程序中采用设计模式时，测试与您使用该模式的其他应用程序有相似之处。

综上所述，如果你知道应用程序只会执行两个功能，那么实现命令模式并且只有两个命令真的很愚蠢。现在你已经为编写一堆测试而背负了沉重的负担。得到了什么？您始终可以测试公共方法，但是使用适当的模式您需要处理复杂性，并且由于您必须维护所有额外的测试而产生了技术债务。  

另一个需要考虑的因素是您的团队可以支持什么级别的架构。是否所有团队成员对 TDD 的理解程度都相同，还是会有少数人能够理解测试？看到模拟对象会不会让人目瞪口呆，仅此一项就成为不能及时完成维护的阻碍因素吗？

最后，应用范围也需要驱动设计。为了“纯粹”而复杂化并不是好的判断。TDD 不会导致这种情况；相反，缺乏经验可以。

            回答 #12

赞同：0

时间：2009-05-24T14:38:35.917

我不知道你说它几乎不可读是什么意思，因为即使使用 AOP 和 DI，每个部分也应该很容易理解。由于这些技术，理解整体可能会更复杂，但这更多的是能够用模型或文本来解释应用程序的工作原理。

我目前正在开发一个没有单个单元测试的应用程序，所以，现在我开始引入 DI 来帮助简化测试，但是，它会使其他开发人员更难理解系统，因为不同的具体类是可以插入的，在查看 app.config 文件之前你不会知道是哪一个。

这可能会导致他们认为代码不可读，因为他们不能轻易地从一个功能级别流向另一个功能级别，而是必须绕道而行以查看要使用的具体类。

但是，从长远来看，这将是一个更加灵活和稳定的系统，所以我认为值得进行一些培训。:)

您可能只需要了解如何为应用程序获取更好的系统模型，了解所有内容是如何联系在一起的。

            回答 #13

赞同：0

时间：2009-05-25T13:02:41.060

我正在审查一个非常复杂的应用程序，它是通过广泛使用过度支持测试的设计模式来实现的，例如 IoC、DI、AOP 等...

在这种情况下，测试不是问题，而是设计模式和整体架构出了问题，这是[Joel](http://www.joelonsoftware.com/articles/fog0000000018.html) *和* [Jeff](http://www.codinghorror.com/blog/archives/000165.html)在针对建筑宇航员的讨论中普遍批评的问题。在这里，我们已经根据“哇酷架构”决定了一些东西，如果 1 种设计模式很好，那么 2 种一定很棒，3 种一定很棒——让我们看看我们可以用多少种模式来创建这个应用程序。

如果测试对于使这些模式可靠地工作可能是必不可少的（嗯，确实说明了它们），但是您不应该将测试的好与某些架构设计的差混为一谈。

所以，不，你可以放心地专注于测试——例如极限编程是一种非常简单的开发方法，它专注于测试，如果你以这样一种自由形式的方式编写你的应用程序，你可能不会陷入混乱，你have 不是测试驱动开发的错，而是做出的设计选择。

如果您可以开始报废它，那就这样做 - 可维护性是软件中最重要的因素，如果它不容易修改，那么您可以密封它并重新开始，因为维护它可能会花费您更多。

        javascript - 将数组传递给 jQuery 插件

ID：903575

赞同：3

时间：2009-05-24T11:24:02.533

标签：javascript, jquery, plugins

我正在考虑修改一个 jQuery 插件以满足我需要的额外要求。

抱歉，这不是一个编程问题，但是您能否将一个数组从 javascript 传递到一个 jQuery 插件，这将保留它的所有信息，或者我会丢失 javascript 和 jQuery 插件之间的数组内容吗？

谢谢。TT。

            回答 #1

赞同：3

时间：2009-05-24T11:36:49.090

jQuery 完全用 javascript 编写。jQuery 扩展（实际上是 jQuery 本身）只是普通函数。它没有什么特别或不同的地方，所以要回答你的问题，是的，你可以传递数组。

            回答 #2

赞同：3

时间：2009-05-24T11:42:01.887

这是一个将数组作为参数的示例插件。

```
// plugin definition
$.fn.myPlugin = function(arrArg) {
    // the plugin implementation code goes here
    // do something with arrArg, which is an array
}; 
```

然后用数组调用插件：

```
$('.class').myPlugin([1, 2, 3]); 
```

            回答 #3

赞同：1

时间：2009-05-24T11:37:49.103

您的数组应该具有与传递它时相同的所有数据。jQuery 是用 javascript 编写的，只是一个让您的生活更轻松的框架。

        javascript - 在 IE 中使用 JQuery UI 的切换时列调整大小

ID：903576

赞同：0

时间：2009-05-24T11:24:55.090

标签：javascript, jquery, internet-explorer, jquery-ui, html-table

示例代码：

```
<html>
  <head>
    <script src="jquery-1.3.2.min.js" type="text/javascript"></script>
    <script src="jquery-ui-1.7.1.custom.min.js" type="text/javascript"></script>
  </head>
  <body>

    <table border="1" style="width:100%">
        <tr>
            <th>1</th>
            <th>2</th>
            <th>3</th>
            <th>4</th>
        </tr>
        <tr>
            <td>a</td>
            <td>b</td>
            <td>c</td>
            <td>d</td>
        </tr>
        <tr>
            <td colspan="4" >
                <div id="target">TOGGLE TEXT!!</div>
            </td>
        </tr>
    </table>

    <input type="button" value="show/hide" onclick="toggleHidden();" />

    <script type="text/javascript">

        function toggleHidden() { 

            $('#target').toggle("blind", {}, 200, null);
        }

    </script>

  </body>
</html> 
```

此代码使用 JQuery UI 的切换功能（与 show 和 hide 功能相同的结果）隐藏和显示 td 中的 div。

在 FireFox 中这很好用，但在 IE 中，所有列都会在“切换效果”期间调整大小。有谁知道为什么 IE 会这样？如果我可以在这段代码中做些什么来防止它发生？

            回答 #1

赞同：4

时间：2009-05-24T13:01:12.943

使用[slideToggle](http://docs.jquery.com/Effects/slideToggle)而不是切换或隐藏/显示实际上解决了问题！

            回答 #2

赞同：1

时间：2009-05-24T11:31:37.010

我也遇到过类似的问题。尝试两件事：

1) 给表格一个以像素为单位的绝对宽度，例如 500px

2）尝试在包含目标 div 的 TD 中放置一个不间断的空格`&nbsp;`，在 div 之后，以防止浏览器在其中没有内容时折叠单元格：

`<div id="target">TOGGLE TEXT!!</div>&nbsp;`

        python - 如何在 Mac 上使用 Python 中的点绘制自动图形？

ID：903582

赞同：0

时间：2009-05-24T11:28:35.877

标签：python, macos, graphviz, dot, dyld

我在 Python 程序中生成图表，现在我需要将它们可视化。

我使用 Tkinter 作为 GUI 来可视化所有其他数据，并且我想在里面有一个带有数据图的小子窗口。目前，我将数据表示在 .dot 文件中。然后我保持 graphviz 打开，它显示了图表。但这当然不是最理想的。我需要在 tk 窗口中获取图表。

我考虑过从命令行使用graphviz，但我总是遇到同样众所周知的错误：

```
Desktop ibook$ dot -Tpng -O 1.dot
dyld: lazy symbol binding failed: Symbol not found: _pixman_image_create_bits
  Referenced from: /usr/local/lib/graphviz/libgvplugin_pango.5.dylib
  Expected in: flat namespace

dyld: Symbol not found: _pixman_image_create_bits
  Referenced from: /usr/local/lib/graphviz/libgvplugin_pango.5.dylib
  Expected in: flat namespace

Trace/BPT trap 
```

该错误似乎在 Graphviz 社区中众所周知：

[http://www.graphviz.org/bugs/b1479.html](http://www.graphviz.org/bugs/b1479.html)

[http://www.graphviz.org/bugs/b1488.html](http://www.graphviz.org/bugs/b1488.html)

[http://www.graphviz.org/bugs/b1498.html](http://www.graphviz.org/bugs/b1498.html)

因此，由于我似乎无法使用命令行实用程序，所以我想知道是否有人知道在 Python 中绘制点图的直接方法，而不使用命令行，或者做一些会导致相同错误的事情？

我在 Mac Leopard，python 2.5.2 上编程

            回答 #1

赞同：2

时间：2009-05-24T14:10:54.270

我没有 Mac 来测试它，但[NetworkX](http://networkx.lanl.gov/index.html)包包含[读取 .dot 文件](http://networkx.lanl.gov/reference/generated/networkx.read_dot.html)和使用[matplotlib](http://matplotlib.sourceforge.net/)[绘制图形](http://networkx.lanl.gov/reference/generated/networkx.draw.html)的方法。您可以在 Tk 中嵌入 matplotlib 图（[示例 1](http://matplotlib.sourceforge.net/examples/user_interfaces/embedding_in_tk.html)、[示例 2](http://matplotlib.sourceforge.net/examples/user_interfaces/embedding_in_tk2.html)）。

            回答 #2

赞同：1

时间：2009-05-25T04:28:13.540

快速[谷歌](http://www.google.com/search?q=python+graphviz)拉起[http://code.google.com/p/pydot/](http://code.google.com/p/pydot/)。我还没有尝试过，但它看起来很有希望。

        visual-studio-2008 - 使用框架 3.5 单击一次部署（当 Mb 的大小很重要时）

ID：903586

赞同：0

时间：2009-05-24T11:32:19.223

标签：visual-studio-2008, frameworks, clickonce

目前我正在使用 clickonce 和 V2.0 框架发布我的应用程序。

未安装框架的用户，应下载额外的 20Mb 框架。

如果我决定切换到 3.5 框架会发生什么？

用户应该首先为框架下载 50-60Mb，然后安装我的应用程序？

            回答 #1

赞同：2

时间：2009-05-24T18:30:52.650

只需让用户使用[.Net 3.5 SP1 Bootstrapper](http://www.microsoft.com/downloads/details.aspx?FamilyId=AB99342F-5D1A-413D-8319-81DA479AB0D7&displaylang=en)安装即可。这是一个 2.8 MB 的下载文件，可以确定用户需要哪些位，并且只下载和安装这些位。这样，下载大小就可以根据每个人的实际需要进行定制。

        layout - 在 2D 空间中为对象排列标签而不重叠

ID：903589

赞同：3

时间：2009-05-24T11:35:13.337

标签：layout, geometry, 2d, overlap

我需要将文本标签附加到随机分布在屏幕上并保持移动的对象上。

标签的默认和理想位置位于它所指对象的右侧。我需要一种动态重新排列（或可能合并）标签的方法，以使它们永远不会相互重叠或与其他对象重叠。

它们仍应尽可能靠近物体，并且不应在物体本身平稳移动的情况下表现出任何突然的抖动运动。

我不知道该怎么做，有这样的算法吗？

            回答 #1

赞同：3

时间：2009-05-24T11:44:59.977

我建议使用物理学。用弹簧将标签贴在物体上，并对每个标签施加排斥力，以免它们靠近其他物体（及其标签），不包括他们描述的物体。

            回答 #2

赞同：0

时间：2009-05-24T11:47:06.323

放置标签：您可以找出闭合物体的最紧的正方形，然后从正方形的右侧垂下垂线到物体上。将标签放置在此交点处。

检测碰撞：存储标签的坐标，在显示最终缓冲区之前，您可以使用坐标检测标签的碰撞。

避免突然移动：这是困难的部分，因为如果您仅在检测到碰撞时更改标签的位置，那么就会出现抖动。简单的方法是在检测到碰撞时合并它们，只要存在碰撞。更难的方法是移动标签。为了使这一过程顺利进行，您必须事先检测可能出现在前面几帧的任何碰撞，并开始在一些可以避免任何碰撞的轨迹上移动标签。

            回答 #3

赞同：0

时间：2009-07-20T22:20:19.260

我用蛮力解决了这个问题

```
for each object as a
    for each colliding object as c
        if should_swallow(a, c)
            swallow(a, c) 
```

并在一个循环中执行多次，因为对象在吞下其他对象时会增长，因此必须再次进行碰撞检查（新的重叠可能会在循环中出现）。不过，根据我正在处理的对象数量，不要超过 3 个周期。

should_swallow() 函数根据大小、位置和之前帧中发生的情况来确定是吞下对象还是被它吞下更好，以防止闪烁。

        visual-studio-2005 - 如何从 Web 部署项目的复制过程中排除特定文件夹？

ID：903595

赞同：0

时间：2009-05-24T11:37:04.580

标签：visual-studio-2005, web-deployment-project

我正在起诉 VS 2005 和一个 Web 部署项目。问题是构建过程需要很长时间，因为部署过程会将我的图像文件夹复制到部署目录。图像文件夹很小，但有数千个文件。我想将图像保留在我的开发文件夹中，以便查看 HTML 中图像的链接是否有效。但是我从不上传图片，因为它们已经在那里了。因此，理想情况下，我希望将该文件夹从部署过程中排除。

有没有简单的方法可以做到这一点？

            回答 #1

赞同：1

时间：2009-05-24T13:19:25.513

这篇[SO](https://stackoverflow.com/questions/50318/how-do-i-stop-visual-studios-publish-web-site-from-publishing-my-resharper-fo)帖子提到了一个插件（[Web 部署插件](http://www.codedigest.com/Articles/VisualStudio/126_Web_Deployment_Project_for_Visual_Studio_2005_and_2008.aspx)），它应该允许您从构建过程中排除项目。

您还可以通过手动编辑 Web 部署项目文件来排除项目​​。在此处的“**自定义 Web 部署项目**”标题下查看...

[http://msdn.microsoft.com/en-us/library/aa479568.aspx](http://msdn.microsoft.com/en-us/library/aa479568.aspx)

        python - 是否可以从 C 程序调用 python 方法？

ID：903596

赞同：0

时间：2009-05-24T11:37:32.943

标签：python, c, embedding

我记得在某处看到你可以使用从 C 内部调用 python 方法

```
#include "python.h" 
```

但我似乎找不到这个或任何例子的来源。

如何从 C 程序内部调用 python 方法？

            回答 #1

赞同：5

时间：2009-05-24T11:40:03.047

[这是](http://www.python.org/doc/2.5.2/ext/callingPython.html)来自 python 站点的关于使用 python 功能扩展 C 的文档项

[这是](http://www.python.org/doc/2.5.2/ext/simpleExample.html)文档的开头（它指的是 python.h），您可以在其中使用 C 功能扩展 Python。

            回答 #2

赞同：2

时间：2009-05-24T11:41:58.503

查看[http://docs.python.org/c-api](http://docs.python.org/c-api/)

        login - 要求用户名/密码+注册的批处理文件

ID：903607

赞同：3

时间：2009-05-24T11:42:14.400

标签：login, batch-file

我想要一个可以将用户注册到自身的批处理文件。就像是：

```
@echo off
echo Choose an option:
echo     1:Register
echo     2:Login
Set option=
set /p option=Your option: 
if %option%==1 goto reg
if %option%==2 goto login
...
:reg
--The registration script--
goto login
...
:login
Set usr=
set /p usr=Username: 
if %usr%== goto pass
echo False username!
@pause
goto login
...
:pass
Set passw=
set /p passw=Password: 
if %passw%== goto success
echo False password!
@pause
goto login 
```

所以……类似的东西。'if %passw%== "" and if %usr%== ""' === 它应该在注册时自动进行。

如果超过 1 人可以注册，那就太好了。

            回答 #1

赞同：1

时间：2009-05-24T13:19:43.267

要测试空字符串，请在两边加上引号：

```
if "%usr%"=="" 
```

要附加到文本文件，请使用 >>

```
echo %usr%:%pass% >> passwd.txt 
```

要遍历文件的内容，请使用 for /f：

```
for /f "delims=: tokens=1,2" %%x in (passwd.txt) do (
  if "%%x"=="%usr%" then (
    set usrfound=true
  )
)
if "%usrfound%"=="" then (
  rem Register user
) else (
  rem Check password and succeed/fail
) 
```

在测试或调试期间，请确保 echo 已打开。如果要在 for 循环或其他多行语句中设置和测试变量，请将其放在文件开头附近：

```
setlocal enabledelayedexpansion 
```

并且任何时候您需要读取块内可能已更改的变量，请使用！var！而不是 %var%。

            回答 #2

赞同：1

时间：2009-05-27T16:45:04.563

嗯。这是我通过一些帮助发现的：

```
@echo off
title REGISTERANDLOGIN
if exist programbase.dll goto login
if not exist programbase.dll goto register

:register
title Register
echo Register
echo.
echo Please fill in the blanks.
echo.
Set usrname=
set /p usrname=Username: 
Set passw=
set /p passw=Password: 
echo %usrname%>> programdata.dll
echo %passw%>> programbase.dll
goto login

:login
:begin
set usr=
set /p usr=Enter your username: 
if {%usr%}=={} goto :begin
set authenticated=
for /f "tokens=*" %%a in (programdata.dll) do (
    if {%%a}=={%usr%} set authenticated=true
)

if not defined authenticated (echo Invalid Username & goto :begin)

:passwo
set pass=
set /p pass=Enter your password: 
if {%pass%}=={} goto :begin
set authenticated=
for /f "tokens=*" %%a in (programbase.dll) do (
    if {%%a}=={%pass%} set authenticated=true
)
if not defined authenticated (echo Invalid password & goto :begin)

:loggedin
cls
echo Welcome.
@pause
exit /b 0 
```

            回答 #3

赞同：1

时间：2012-10-11T05:37:36.677

我想知道这是否可行：

```
 @ echo off 
 goto username
 :username
 echo Hello, please log in with your user ID or type "reg" to register.
 echo Username: 
 set /p user
 if %user%== username(s)here goto password
 if %user%==reg goto register
 if not defined user (
 cls
 echo Bad username!
 pause
 exit
 ) 
```

然后执行程序的其余部分。我会试试这个，如果它不起作用，请告诉我！

            回答 #4

赞同：1

时间：2012-10-18T13:49:23.637

你可以试试这个。. . 我写了一个包含登录和注册模块的批处理文件。它创建一个文件，其中存储创建的帐户。登录后，包括“换色器”和“井字游戏”等特殊功能。TicTacToe 不是我的，我是从 www.screwthelotofyou.webs.com/files/ 获得的。这个文件和换色器是我的。“复制、编辑和分发你想要的一切。好像我可以阻止你一样。” -ScrewTheLotofYou

我这里不能贴代码，太长了。. . 链接：[http](http://www.mediafire.com/?kwzzvk24nuze8fq) ://www.mediafire.com/? 
kwzzvk24nuze8fq 希望它有效。:D ~ meilviruz99

            回答 #5

赞同：0

时间：2009-05-24T11:55:03.530

[在这个网站](http://www.robvanderwoude.com/userinput.php)上发现了一些非常邪恶的技巧，包括：

```
ECHO Enter some input, and press Enter when ready . . .
ECHO ←[13;0;64;13p
COPY CON USRINPUT.TMP
ECHO ←[13;13p
CLS
ECHO You typed:
TYPE USRINPUT.TMP 
```

它使用 ANSI 键转换将 Enter 更改为 CTRL-Z。

            回答 #6

赞同：0

时间：2009-05-24T12:18:24.827

我不能说我完全理解你的问题，但是如果对与批处理脚本相关的任何事情有疑问，我可以建议你查看这个网站[这个网站](http://www.allenware.com/icsw/icswidx.htm)。

该教程非常详尽，易于理解，并且以前帮助过我很多次。

            回答 #7

赞同：0

时间：2009-06-04T21:55:51.233

```
@echo off

if exist "%userprofile%\documents\Login\Accounts" goto start0

if not exist "%userprofile%\documents\Login\Accounts" md "%userprofile%\documents\Login\Accounts"

 :start0

title Login

color 02

cls

echo ---------------------------------

echo              Login.

echo ---------------------------------

echo.

echo.

echo.

echo 1.Create New Username.

echo 2.Log in.

echo.

echo.

echo.

set /p A=Choice:

IF '%A%' == '1' GOTO NewUser0

IF '%A%' == '2' GOTO Login0

IF NOT '%A%' == '1' GOTO start0

:NewUser0

cls

color 02

cd "%userprofile%\documents\Login\Accounts"

set /p newuser=New Username:

IF EXIST %newuser%.bat GOTO inval0

set /p newpass=New Password:

echo set realusername=%newuser% >> %newuser%.bat

echo set password=%newpass% >> %newuser%.bat

IF EXIST %newuser%.bat GOTO NewUser1

IF NOT EXIST %newuser%.bat GOTO NewUser2

:NewUser1

echo Your Account Has Been Created Successfully. Press An Key To Continue.

pause >nul

GOTO start0

:NewUser2

cls

color 0c

del /f /q %newuser%.bat

echo ERROR!Account Could Not Be Created For Unknown Reasons.Press Any Key To Continue

pause >nul

GOTO start0

:Login0

cls

color 02

cd "%userprofile%\documents\Login\Accounts"

echo Login.

echo.

echo.

echo.

echo.

set /p loguser=Username:

IF NOT EXIST %loguser%.bat GOTO inval1

:Login1

set /p logpass=Password:

call %loguser%.bat

if %logpass% == %password% goto success0

goto invalid2

:inval0

cls

color 0c 

echo Desired Username Already Exists. Press Any Key To Continue.

pause >nul

GOTO start0

:inval1

cls

color 0c 

echo Desired Username Does NOT Exist. Press Any Key To Continue.

pause >nul

GOTO start0

:invalid2

cls

color 0c 

echo Invalid Password. Press Any Key To Continue.

pause >nul

cls

color 02

echo Login.

echo.

echo.

echo.

echo.

echo Username:%loguser%

GOTO Login1

:Success0

cls

color 02

title End Of My Script

echo You Successfully Logged In.

echo Here Is Where You Continue The Script.

ping localhost -n 3 >nul

echo.

echo.

echo.

echo Press Any Key To Exit.

pause >nul 

exit 
```

            回答 #8

赞同：0

时间：2012-06-01T03:30:32.150

看看这个非常简单的聊天程序：

```
@echo off
cls
echo @prompt set date=$d$_set time=$t$h$h$h > {a}.bat
%comspec% /e:2048 /c {a}.bat > {b}.bat
for %%v in ({b}.bat del) do call %%v {?}.bat
:LoGINSCR
ECHO Euronet MessageBoard
ECHO v1.0 [BETA]
goto LOGIN
:LOGIN
ECHO.
set/p user=Login As:
if %user%==Eugene goto PASSWORD
if %user%==Toxic goto PASSWORD
if %user%==Plague goto PASSWORD
if %user%==Jason goto PASSWORD
goto LOGIN
:PASSWORD
set/p pass=Password:
if %pass%==$euronet$ goto SYSTEM
goto LOGIN
:SYSTEM
ECHO Welcome to Euronet MessageBoard, %user%.
goto INPUTMAIN
:INPUTMAIN
ECHO.
set/p main=%user%/chat:
if %main%==help goto HELP
if %main%==join goto JOIN
if %main%==quit goto EXIT
if %main%==ic goto IC
goto ERROR
:IC
ping google.com
PAUSE
ping wikipedia.org
PAUSE
ping facebook.com
PAUSE
ipconfig
PAUSE
goto INPUTMAIN
:ERROR
ECHO [ERROR] No command found ("%main%")
goto INPUTMAIN
:HELP
ECHO Type help to show the help page.
ECHO Type join to join board
ECHO Type quit to exit MessageBoard
ECHO Type ic for internet check
ECHO After you joined the board, you can update
ECHO your screen by pressing "Shift & 6".
goto INPUTMAIN

:JOIN
ECHO.
set/p mesgc=Enter your message:
ECHO %user% [%time%] - %mesgc% >> messg1
goto TRAFFIC
:TRAFFIC
cls
TYPE messg1
goto JOIN
:CLS
cls
goto TRAFFIC
:EXIT
exit 
```

它使用一个文件，但多个用户可以运行 bat 文件并连接到该文件。它通过重复循环 TYPE 和 set/p 命令来工作。虽然它不能自行更新聊天列表，但您可以通过按 Shift 和 6 并按 Enter 来更新它。

            回答 #9

赞同：0

时间：2013-03-06T00:29:15.007

为什么不将输入与用户文件进行比较？为每个用户制作一个文件，并且可能会获得一个加密和解密程序以自动运行以实现最大安全性。Batch 是一个非常简单的语言。只是把它弄乱了一段时间。

            回答 #10

赞同：0

时间：2013-05-31T04:09:36.023

我对此感到非常自豪:) 这有两个不同的文件：处理登录的 login.bat 和处理注册的 login2.bat。登录.bat：

```
@echo off
choice /c:RL /m "Choose an option: Register (R) or Login (L).:
if errorlevel 2 goto login
if errorlevel 1 goto register
:register
start /wait C:\[path]\login2.bat
cls
goto login
:in
cls
echo Welcome %u%
echo.
echo Bla Bla Bla or start "a program"
pause
exit
:login
set /p u=Username
set /p p=Password 
```

和 login2.bat：

```
@echo off
:a
set /p a="Choose a Username"
set /p b="Choose a Password"
echo.
choice /m "Are you sure you would like your Username to be %a% and your Password to be %b%?"
if errorlevel 2 goto a
set q="if %%u%% equ %a% if %%p%% equ %b% goto in"
for /f "tokens=*" %%I in (%q%) do set m=%%I
echo %m% >>C:\[path]\login.bat
exit 
```

:in，处理成功登录后发生的事情的标签必须在中间而不是在 login.bat 的末尾的原因是，用户名/密码组合可以附加到 :login 标签。显然，您可以添加其他装饰并更改文件的名称，但这是我的基本设计。我喜欢这些简短易懂的内容。他们在 100% 的时间里都像魅力一样工作。希望这可以帮助！

            回答 #11

赞同：0

时间：2014-06-14T13:03:20.407

我没有提供完整的源代码，因为你们可能都知道如何做到这一点。

一个非常简单的方法来做你所要求的就是只有一个注册和一个检测文件的登录页面。只需创建几个目录，例如 userSaves 或 passSaves。然后你让系统检测登录时文件是否存在：

```
:page
set /p usr=Username:
if exist mydir\LoginProgram\saves\userSaves\%usr% (
echo Valid Username.
pause
goto passentry
cls
 ) else (
echo Invalid Username.
pause
goto page
cls
)
:passentry
cls
set /p pass=Password:
 if exist mydir\LoginProgram\saves\passSaves\%pass% (
echo Valid Password. Welcome!
pause
goto whateverpage
cls
 ) else (
echo Invalid Password. Login failed.
pause
goto page
cls
) 
```

超级简单的代码。只需为注册做同样的事情。

        c# - 监控传出的互联网流量

ID：903612

赞同：2

时间：2009-05-24T11:47:05.043

标签：c#, .net, networking, network-programming

有没有办法以编程方式监控互联网流量？我想记录用户在 Internet 上访问的页面。这可以通过 .NET 代码实现吗，是否存在可用于检索数据的第 3 方 .NET 组件。

有关 Internet 流量的信息必须存储到数据库中，因此我不能为 IE 使用插件或其他东西。我们还希望将此代码包含到我们现有的产品中，这样我们就不能使用无法重新分发的第 3 方产品。

如果这个东西可以监控所有浏览器的流量，那就太酷了，但监控 IE 流量也可能就足够了。

            回答 #1

赞同：6

时间：2009-05-24T11:54:39.850

[可以通过WinPCap](http://www.winpcap.org/)库设置嗅探器，该库有几个将其包装到 .NET 的项目：

*   [http://geekswithblogs.net/dotnetnomad/archive/2008/01/31/119140.aspx](http://geekswithblogs.net/dotnetnomad/archive/2008/01/31/119140.aspx)
*   [http://www.codeproject.com/KB/IP/dotnetwinpcap.aspx](http://www.codeproject.com/KB/IP/dotnetwinpcap.aspx)
*   [http://coolthingoftheday.blogspot.com/2006/02/sharppcap-net-winpcap-wrapper.html](http://coolthingoftheday.blogspot.com/2006/02/sharppcap-net-winpcap-wrapper.html)

可能还有其他一些，只是谷歌搜索的问题。

            回答 #2

赞同：1

时间：2009-05-24T11:55:49.393

您需要构建一些充当代理的软件。您应该从查看“Fiddler”之类的程序开始，以了解这些概念以及您需要实现的内容。

如果你想要我的专业意见，你应该去服务器故障并询问低成本互联网代理解决方案的意见。在充满挑战和乐趣的同时自己写这个东西不会有很好的商业意义。

            回答 #3

赞同：1

时间：2009-05-24T12:07:48.247

如果您想监控网络上每个人的所有流量，请考虑使用 Microsoft 的[Internet 安全和加速 (ISA) 服务器等产品](http://www.microsoft.com/forefront/edgesecurity/isaserver/en/us/overview.aspx) 

虽然这对于您想要的东西来说可能是多余的，但关键是您需要一种方法让所有流量都通过可以记录流量的单个点（代理服务器）。由于所有流量都经过这一点，因此用户无法通过使用备用浏览器等来避免检测。

            回答 #4

赞同：0

时间：2010-04-19T14:41:06.087

就像[JD](https://stackoverflow.com/questions/903612/monitoring-outgoing-internet-traffic/903619#903619)已经提到的那样，您应该看看[Fiddler](http://www.fiddler2.com/fiddler2/)。使用此代理，您可以监控所有网络流量（如果您的浏览器配置为使用 fiddler 作为代理）。

如果您不希望 fiddler 作为一个独立的应用程序并且在您自己的应用程序中需要它的功能，您应该查看[FiddlerCore](http://fiddler.wikidot.com/fiddlercore)。它是一个封装了 Fiddler 核心功能的 .Net 程序集。

如果您需要一种更原始​​的方式来嗅探数据（也许您不想[或不能]配置客户端的代理），[Vinko](https://stackoverflow.com/questions/903612/monitoring-outgoing-internet-traffic/903617#903617)的答案将进一步帮助您。

            回答 #5

赞同：0

时间：2010-04-19T14:16:19.330

您还可以尝试[Pcap.Net](http://pcapdotnet.codeplex.com)在 .NET 中轻松使用 WinPcap。它是用 C++/CLI 和 C# 编写的 WinPcap 包装器，包括一个数据包解释和创建框架。

        wcf - 从 Silverlight 应用程序同时调用 WCF 服务时出现 TimeoutException

ID：903615

赞同：1

时间：2009-05-24T11:50:04.930

标签：wcf, silverlight, timeout, timeoutexception, simultaneous-calls

分析日志文件我注意到大约 1% 的服务调用在 Silverlight 客户端以 TimeoutException 结束。服务 (wcf) 非常简单，不会执行长时间的计算。根据日志，所有对服务的调用总是在不到 1 秒的时间内处理（即使客户端发生了 TimeoutException！），所以它不是服务器超时。

那么有什么问题呢？可能是配置问题还是网络问题？我怎样才能避免它？哪些额外的日志信息有助于本地化此问题？

我想到的唯一一种解决方法是在超时后重试服务调用。

我将不胜感激在这个问题上的任何帮助！

**更新：**启动时，应用程序执行 17 个服务调用，其中 12 个同时执行（可能是失败的原因？）。

**更新：** WCF 日志未包含有关此问题的有用信息。似乎有些服务调用没有到达服务器端。

            回答 #1

赞同：6

时间：2009-06-03T22:37:37.450

问题在于 Internet Explorer 7/6 中单个服务器的最大并发连接数。只有2个！[http://msdn.microsoft.com/en-us/library/cc304129(VS.85).aspx](http://msdn.microsoft.com/en-us/library/cc304129(VS.85).aspx)

如果我们有 3 个（例如）并发服务调用，其中两个将立即发送到服务器，但第三个将在队列中等待。`sendTimeout`当请求在队列中时，发送计时器（对应于 ）也在运行。如果前两个服务请求将运行很长时间，那么第三个服务请求将生成 TimeoutException，尽管它没有发送到服务器（我们不会在服务器端看到有关此请求的任何信息，也无法使用 Fiddler 捕获它...）。

在更实际的情况下，如果我们有大约 12 个并发调用和默认 1 分钟发送超时，并且如果服务调用平均处理超过 10 秒，那么我们很容易在最后两个调用中获得超时异常（12 / 2 * 10 秒 = 60 秒) 因为他们会等待所有其他人。

解决方案是：

1.  最小化并发服务调用的数量。
2.  增加**客户端**配置`sendTimeout`的价值。 ***   为关键服务实施自动重试功能。
*   实施请求队列来管理它们。**  就我而言，我已经做了 1-3 件事，这就足够了。

这是我对自动重试功能的实现：

```
public static class ClientBaseExtender
{
    /// <summary>
    /// Tries to execute async service call. If <see cref="TimeoutException"/> occured retries again.
    /// </summary>
    /// <typeparam name="TChannel">ServiceClient class.</typeparam>
    /// <typeparam name="TArgs">Type of service client method return argument.</typeparam>
    /// <param name="client">ServiceClient instance.</param>
    /// <param name="tryExecute">Delegate that execute starting of service call.</param>
    /// <param name="onCompletedSubcribe">Delegate that subcribes an event handler to the OnCompleted event of the service client method.</param>
    /// <param name="onCompleted">Delegate that executes when service call is succeeded.</param>
    /// <param name="onError">Delegate that executes when service call fails.</param>
    /// <param name="maxAttempts">Maximum attempts to execute service call before error if <see cref="TimeoutException"/> occured (by default 5).</param>
    public static void ExecuteAsyncRepeatedly<TChannel, TArgs>(this ClientBase<TChannel> client, Action tryExecute,
                                                               Action<EventHandler<TArgs>> onCompletedSubcribe, EventHandler<TArgs> onCompleted,
                                                               EventHandler<TArgs> onError, int maxAttempts)
        where TChannel : class
        where TArgs : AsyncCompletedEventArgs
    {
        int attempts = 0;
        var serviceName = client.GetType().Name;

        onCompletedSubcribe((s, e) =>
                                {
                                    if (e.Error == null) // Everything is OK
                                    {
                                        if (onCompleted != null)
                                            onCompleted(s, e);

                                        ((ICommunicationObject)client).Close();
                                        Debug.WriteLine("[{1}] Service '{0}' closed.", serviceName, DateTime.Now);
                                    }
                                    else if (e.Error is TimeoutException)
                                    {
                                        attempts++;

                                        if (attempts >= maxAttempts) // Final timeout after n attempts
                                        {
                                            Debug.WriteLine("[{2}], Final Timeout occured in '{0}' service after {1} attempts.", serviceName, attempts, DateTime.Now);

                                            if (onError != null)
                                                onError(s, e);
                                            client.Abort();

                                            Debug.WriteLine("[{1}] Service '{0}' aborted.", serviceName, DateTime.Now);
                                            return;
                                        }

                                        // Local timeout
                                        Debug.WriteLine("[{2}] Timeout occured in '{0}' service (attempt #{1}).", serviceName, attempts, DateTime.Now);

                                        Debug.WriteLine("[{2}] Attempt #{0} to execute call to '{1}' service.", attempts + 1, serviceName, DateTime.Now);
                                        tryExecute(); // Try again.
                                    }
                                    else
                                    {
                                        if (onError != null)
                                            onError(s, e);
                                        client.Abort();
                                        Debug.WriteLine("[{1}] Service '{0}' aborted.", serviceName, DateTime.Now);
                                    }
                                });

        Debug.WriteLine("[{2}] Attempt #{0} to execute call to '{1}' service.", attempts + 1, serviceName, DateTime.Now);
        tryExecute(); // First attempt to execute
    }
} 
```

这是一个用法：

```
var client = new MyServiceClient();
client.ExecuteAsyncRepeatedly(() => client.MyOperationAsync(...),
    (EventHandler<MyOperationCompletedEventArgs> handler) => client.MyOperationCompleted += handler,
    (s, e) => // OnCompleted
        {
            Do(e.Result);
        },
    (s, e) => // OnError
        {
            HandleError(e.Error);
        }
); 
```

希望这会有所帮助。

* * *

## 回答 #2

> 赞同：0
> 
>             
> 
> 时间：2009-05-25T12:51:23.830

嗯......请求/响应是否有可能超过 64 K 或序列化的对象过多？

您可以尝试使用控制台应用程序模拟命中服务器（只是检查它是否是网络，SL ...）？

* * *

## 回答 #3

> 赞同：0
> 
>             
> 
> 时间：2009-06-03T21:27:22.493

你还有这个问题吗？

如果是这样，那么也许您应该使用 Fiddler 或 Microsoft Network Monitor 或其他东西来观察网络？

# cocoa - Cocoa 框架是如何得名的？

> ID：903621
> 
>         
> 
> 赞同：3
> 
>         
> 
> 时间：2009-05-24T11:56:25.057
> 
>         
> 
> 标签：cocoa

我想知道 Cocoa 框架是如何得名的。我知道这个名字来自可可豆，但我需要了解更多关于我正在编写的小教程的细节。这是一个非常不寻常的框架名称，我想知道为什么选择这个名称。

* * *

## 回答 #1

> 赞同：9
> 
>             
> 
> 时间：2009-05-24T12:14:20.667

根据[维基百科](http://en.wikipedia.org/wiki/Cocoa_(API))：

> 在当前使用之前，“Cocoa”商标是允许儿童创建多媒体项目的应用程序的名称。它最初被称为 KidSim，现在已授权给第三方并作为 Stagecast Creator 销售。该计划在史蒂夫乔布斯重返苹果公司后的合理化之一中终止。该名称被重新使用以避免注册新商标时的延迟，Stagecast 同意以新名称销售旧的 Cocoa。

* * *

## 回答 #2

> 赞同：2
> 
>             
> 
> 时间：2009-05-24T12:09:35.780

我猜这是对 Java 的双关语，当时 (1998-'99) 非常流行/大肆宣传。

# unix - 没有 .zshrc 无法获取 .profile

> ID：903623
> 
>         
> 
> 赞同：1
> 
>         
> 
> 时间：2009-05-24T11:58:19.500
> 
>         
> 
> 标签：unix, .profile

我的 .zshrc 中有以下几行

```
source /etc/profile    
source $HOME/.profile 
```

我的 .profile 没有它们就不会加载，尽管 .profile 应该在 Unix 系统中默认加载。

**如果不从 .zshrc 获取它，如何加载 .profile？**

* * *

## 回答 #1

> 赞同：2
> 
>             
> 
> 时间：2009-05-24T12:07:50.057

在[Zsh 手册](http://zsh.dotsrc.org/Doc/Release/zsh_4.html)中查看它说使用`~/.zprofile`而不是`~/.profile`.

* * *

## 回答 #2

> 赞同：2
> 
>             
> 
> 时间：2009-05-24T12:07:57.420

除了 Martin 所说的 zprofile vs profile 之外，还要注意 /etc/zprofile 和 ~/.zprofile 仅在 zsh 作为登录 shell 启动时才被读取。如果它“只是”一个交互式 shell，它只会读取 .zshrc。所以问题是你如何启动zsh。如果您使用 Gnome Terminal 之类的东西，您可以在 Profile Preferences 中设置 shell 应该作为登录 shell 启动。

更多信息：[Z-Shell 用户指南](http://zsh.dotsrc.org/Guide/zshguide02.html#l7)

# jquery-ui - JQuery UI DatePicker - 它可以处理多个日期吗？

> ID：903628
> 
>         
> 
> 赞同：14
> 
>         
> 
> 时间：2009-05-24T12:01:39.087
> 
>         
> 
> 标签：jquery-ui, datepicker

我需要显示一个内联日历，允许单击 1 个或多个日期进行选择。JQuery UI datepicker 1.7.1 可以做到这一点吗？

* * *

## 回答 #1

> 赞同：16
> 
>             
> 
> 时间：2010-09-25T13:33:20.213

目前，jQuery UI 中的 Datepicker 不允许选择多个日期。我为该插件创建了一个扩展，使其成为可能：[MultiDatesPicker](http://dubrox.github.io/Multiple-Dates-Picker-for-jQuery-UI/)

# c# - 使用 C# 在位图上锐化

> ID：903632
> 
>         
> 
> 赞同：15
> 
>         
> 
> 时间：2009-05-24T12:04:50.547
> 
>         
> 
> 标签：c#, image, image-processing, bitmap

我想在图像上放置一个锐化滤镜。我找到了一个[简短教程](http://www.student.kuleuven.be/~m0216922/CG/filtering.html)的网站。我试图在 C# 中做到这一点，所以这是我的代码。无论如何，我试图找出它为什么不起作用。我不知道我是否做错了什么，如果是，请告诉我该怎么做才能使其正常工作。谢谢

```
 public static Bitmap sharpen(Bitmap image)
    {
        Bitmap sharpenImage = new Bitmap(image.Width, image.Height);

        int filterWidth = 3;
        int filterHeight = 3;
        int w = image.Width;
        int h = image.Height;

        double[,] filter = new double[filterWidth, filterHeight];

        filter[0, 0] = filter[0, 1] = filter[0, 2] = filter[1, 0] = filter[1, 2] = filter[2, 0] = filter[2, 1] = filter[2, 2] = -1;
        filter[1, 1] = 9;

        double factor = 1.0;
        double bias = 0.0;

        Color[,] result = new Color[image.Width, image.Height];

        for (int x = 0; x < w; ++x)
        {
            for (int y = 0; y < h; ++y)
            {
                double red = 0.0, green = 0.0, blue = 0.0;
                Color imageColor = image.GetPixel(x, y);

                for (int filterX = 0; filterX < filterWidth; filterX++)
                {
                    for (int filterY = 0; filterY < filterHeight; filterY++)
                    {
                        int imageX = (x - filterWidth / 2 + filterX + w) % w;
                        int imageY = (y - filterHeight / 2 + filterY + h) % h;
                        red += imageColor.R * filter[filterX, filterY];
                        green += imageColor.G * filter[filterX, filterY];
                        blue += imageColor.B * filter[filterX, filterY];
                    }
                    int r = Math.Min(Math.Max((int)(factor * red + bias), 0), 255);
                    int g = Math.Min(Math.Max((int)(factor * green + bias), 0), 255);
                    int b = Math.Min(Math.Max((int)(factor * blue + bias), 0), 255);

                    result[x, y] = Color.FromArgb(r, g, b);
                }
            }
        }
        for (int i = 0; i < w; ++i)
        {
            for (int j = 0; j < h; ++j)
            {
                sharpenImage.SetPixel(i, j, result[i, j]);
            }
        }
        return sharpenImage;
    } 
```

* * *

## 回答 #1

> 赞同：26
> 
>             
> 
> 时间：2009-05-24T13:14:25.383

```
public static Bitmap sharpen(Bitmap image)
{
    Bitmap sharpenImage = new Bitmap(image.Width, image.Height);

    int filterWidth = 3;
    int filterHeight = 3;
    int w = image.Width;
    int h = image.Height;

    double[,] filter = new double[filterWidth, filterHeight];

    filter[0, 0] = filter[0, 1] = filter[0, 2] = filter[1, 0] = filter[1, 2] = filter[2, 0] = filter[2, 1] = filter[2, 2] = -1;
    filter[1, 1] = 9;

    double factor = 1.0;
    double bias = 0.0;

    Color[,] result = new Color[image.Width, image.Height];

    for (int x = 0; x < w; ++x)
    {
        for (int y = 0; y < h; ++y)
        {
            double red = 0.0, green = 0.0, blue = 0.0;

//=====[REMOVE LINES]========================================================
// Color must be read per filter entry, not per image pixel.
            Color imageColor = image.GetPixel(x, y);
//===========================================================================

            for (int filterX = 0; filterX < filterWidth; filterX++)
            {
                for (int filterY = 0; filterY < filterHeight; filterY++)
                {
                    int imageX = (x - filterWidth / 2 + filterX + w) % w;
                    int imageY = (y - filterHeight / 2 + filterY + h) % h;

//=====[INSERT LINES]========================================================
// Get the color here - once per fiter entry and image pixel.
                    Color imageColor = image.GetPixel(imageX, imageY);
//===========================================================================

                    red += imageColor.R * filter[filterX, filterY];
                    green += imageColor.G * filter[filterX, filterY];
                    blue += imageColor.B * filter[filterX, filterY];
                }
                int r = Math.Min(Math.Max((int)(factor * red + bias), 0), 255);
                int g = Math.Min(Math.Max((int)(factor * green + bias), 0), 255);
                int b = Math.Min(Math.Max((int)(factor * blue + bias), 0), 255);

                result[x, y] = Color.FromArgb(r, g, b);
            }
        }
    }
    for (int i = 0; i < w; ++i)
    {
        for (int j = 0; j < h; ++j)
        {
            sharpenImage.SetPixel(i, j, result[i, j]);
        }
    }
    return sharpenImage;
} 
```

* * *

## 回答 #2

> 赞同：26
> 
>             
> 
> 时间：2009-08-24T00:41:10.430

我采用了 Daniel 的答案并通过使用 BitmapData 类对其进行了修改以提高性能，因为使用 GetPixel/SetPixel 非常昂贵且不适合需要性能的系统。它的工作原理与之前的解决方案完全相同，可以替代使用。

```
 public static Bitmap Sharpen(Bitmap image)
    {
        Bitmap sharpenImage = (Bitmap)image.Clone();

        int filterWidth = 3;
        int filterHeight = 3;
        int width = image.Width;
        int height = image.Height;

        // Create sharpening filter.
        double[,] filter = new double[filterWidth, filterHeight];
        filter[0, 0] = filter[0, 1] = filter[0, 2] = filter[1, 0] = filter[1, 2] = filter[2, 0] = filter[2, 1] = filter[2, 2] = -1;
        filter[1, 1] = 9;

        double factor = 1.0;
        double bias = 0.0;

        Color[,] result = new Color[image.Width, image.Height];

        // Lock image bits for read/write.
        BitmapData pbits = sharpenImage.LockBits(new Rectangle(0, 0, width, height), ImageLockMode.ReadWrite, PixelFormat.Format24bppRgb);

        // Declare an array to hold the bytes of the bitmap.
        int bytes = pbits.Stride * height;
        byte[] rgbValues = new byte[bytes];

        // Copy the RGB values into the array.
        System.Runtime.InteropServices.Marshal.Copy(pbits.Scan0, rgbValues, 0, bytes);

        int rgb;
        // Fill the color array with the new sharpened color values.
        for (int x = 0; x < width; ++x)
        {
            for (int y = 0; y < height; ++y)
            {
                double red = 0.0, green = 0.0, blue = 0.0;

                for (int filterX = 0; filterX < filterWidth; filterX++)
                {
                    for (int filterY = 0; filterY < filterHeight; filterY++)
                    {
                        int imageX = (x - filterWidth / 2 + filterX + width) % width;
                        int imageY = (y - filterHeight / 2 + filterY + height) % height;

                        rgb = imageY * pbits.Stride + 3 * imageX;

                        red += rgbValues[rgb + 2] * filter[filterX, filterY];
                        green += rgbValues[rgb + 1] * filter[filterX, filterY];
                        blue += rgbValues[rgb + 0] * filter[filterX, filterY];
                    }
                    int r = Math.Min(Math.Max((int)(factor * red + bias), 0), 255);
                    int g = Math.Min(Math.Max((int)(factor * green + bias), 0), 255);
                    int b = Math.Min(Math.Max((int)(factor * blue + bias), 0), 255);

                    result[x, y] = Color.FromArgb(r, g, b);
                }
            }
        }

        // Update the image with the sharpened pixels.
        for (int x = 0; x < width; ++x)
        {
            for (int y = 0; y < height; ++y)
            {
                rgb = y * pbits.Stride + 3 * x;

                rgbValues[rgb + 2] = result[x, y].R;
                rgbValues[rgb + 1] = result[x, y].G;
                rgbValues[rgb + 0] = result[x, y].B;
            }
        }

        // Copy the RGB values back to the bitmap.
        System.Runtime.InteropServices.Marshal.Copy(rgbValues, 0, pbits.Scan0, bytes);
        // Release image bits.
        sharpenImage.UnlockBits(pbits);

        return sharpenImage;
    } 
```

* * *

## 回答 #3

> 赞同：7
> 
>             
> 
> 时间：2011-02-01T02:33:54.750

这将产生更柔和的锐化效果。如果需要，您可以扩展过滤器阵列，或者将 16 更改为更大的，但我发现这不像您拥有的那样苛刻。

```
const int filterWidth = 5;
const int filterHeight = 5;

double[,] filter = new double[filterWidth,filterHeight] {
    { -1, -1, -1, -1, -1 },
    { -1,  2,  2,  2, -1 },
    { -1,  2,  16,  2, -1 },
    { -1,  2,  2,  2, -1 },
    { -1, -1, -1, -1, -1 }
};

double factor = 1.0 / 16.0; 
```

* * *

## 回答 #4

> 赞同：3
> 
>             
> 
> 时间：2013-07-11T10:26:56.863

我结合了 niaher 和 David 的答案并修复了“偏见”属性。现在您可以将 0.0 到 1.0 之间的“强度”传递给 Sharpen() 函数。

```
/// <summary>
///     Sharpens the specified image.
/// </summary>
/// <param name="image">The image.</param>
/// <param name="strength">The strength between 0.0 and 1.0.</param>
/// <returns></returns>
public static Bitmap Sharpen(Image image, double strength)
{
    using (var bitmap = image as Bitmap)
    {
        if (bitmap != null)
        {
            var sharpenImage = bitmap.Clone() as Bitmap;

            int width = image.Width;
            int height = image.Height;

            // Create sharpening filter.
            const int filterWidth = 5;
            const int filterHeight = 5;

            var filter = new double[,]
                {
                    {-1, -1, -1, -1, -1},
                    {-1,  2,  2,  2, -1},
                    {-1,  2, 16,  2, -1},
                    {-1,  2,  2,  2, -1},
                    {-1, -1, -1, -1, -1}
                };

            double bias = 1.0 - strength;
            double factor = strength/16.0;

            var result = new Color[image.Width,image.Height];

            // Lock image bits for read/write.
            if (sharpenImage != null)
            {
                BitmapData pbits = sharpenImage.LockBits(new Rectangle(0, 0, width, height),
                                                            ImageLockMode.ReadWrite,
                                                            PixelFormat.Format24bppRgb);

                // Declare an array to hold the bytes of the bitmap.
                int bytes = pbits.Stride*height;
                var rgbValues = new byte[bytes];

                // Copy the RGB values into the array.
                Marshal.Copy(pbits.Scan0, rgbValues, 0, bytes);

                int rgb;
                // Fill the color array with the new sharpened color values.
                for (int x = 0; x < width; ++x)
                {
                    for (int y = 0; y < height; ++y)
                    {
                        double red = 0.0, green = 0.0, blue = 0.0;

                        for (int filterX = 0; filterX < filterWidth; filterX++)
                        {
                            for (int filterY = 0; filterY < filterHeight; filterY++)
                            {
                                int imageX = (x - filterWidth/2 + filterX + width)%width;
                                int imageY = (y - filterHeight/2 + filterY + height)%height;

                                rgb = imageY*pbits.Stride + 3*imageX;

                                red += rgbValues[rgb + 2]*filter[filterX, filterY];
                                green += rgbValues[rgb + 1]*filter[filterX, filterY];
                                blue += rgbValues[rgb + 0]*filter[filterX, filterY];
                            }

                            rgb = y*pbits.Stride + 3*x;

                            int r = Math.Min(Math.Max((int) (factor*red + (bias*rgbValues[rgb + 2])), 0), 255);
                            int g = Math.Min(Math.Max((int) (factor*green + (bias*rgbValues[rgb + 1])), 0), 255);
                            int b = Math.Min(Math.Max((int) (factor*blue + (bias*rgbValues[rgb + 0])), 0), 255);

                            result[x, y] = Color.FromArgb(r, g, b);
                        }
                    }
                }

                // Update the image with the sharpened pixels.
                for (int x = 0; x < width; ++x)
                {
                    for (int y = 0; y < height; ++y)
                    {
                        rgb = y*pbits.Stride + 3*x;

                        rgbValues[rgb + 2] = result[x, y].R;
                        rgbValues[rgb + 1] = result[x, y].G;
                        rgbValues[rgb + 0] = result[x, y].B;
                    }
                }

                // Copy the RGB values back to the bitmap.
                Marshal.Copy(rgbValues, 0, pbits.Scan0, bytes);
                // Release image bits.
                sharpenImage.UnlockBits(pbits);
            }

            return sharpenImage;
        }
    }
    return null;
} 
```

* * *

## 回答 #5

> 赞同：3
> 
>             
> 
> 时间：2013-07-11T14:37:19.743

好的，解决了边缘变形的问题。这是更新的：

```
/// <summary>
/// Sharpens the specified image.
/// </summary>
/// <param name="image">The image.</param>
/// <param name="strength">The strength.</param>
/// <returns></returns>
public static Bitmap Sharpen(Image image, double strength)
{
    using (var bitmap = image as Bitmap)
    {
        if (bitmap != null)
        {
            var sharpenImage = bitmap.Clone() as Bitmap;

            int width = image.Width;
            int height = image.Height;

            // Create sharpening filter.
            const int filterSize = 5;

            var filter = new double[,]
                {
                    {-1, -1, -1, -1, -1},
                    {-1,  2,  2,  2, -1},
                    {-1,  2, 16,  2, -1},
                    {-1,  2,  2,  2, -1},
                    {-1, -1, -1, -1, -1}
                };

            double bias = 1.0 - strength;
            double factor = strength/16.0;

            const int s = filterSize/2;

            var result = new Color[image.Width,image.Height];

            // Lock image bits for read/write.
            if (sharpenImage != null)
            {
                BitmapData pbits = sharpenImage.LockBits(new Rectangle(0, 0, width, height),
                                                            ImageLockMode.ReadWrite,
                                                            PixelFormat.Format24bppRgb);

                // Declare an array to hold the bytes of the bitmap.
                int bytes = pbits.Stride*height;
                var rgbValues = new byte[bytes];

                // Copy the RGB values into the array.
                Marshal.Copy(pbits.Scan0, rgbValues, 0, bytes);

                int rgb;
                // Fill the color array with the new sharpened color values.
                for (int x = s; x < width - s; x++)
                {
                    for (int y = s; y < height - s; y++)
                    {
                        double red = 0.0, green = 0.0, blue = 0.0;

                        for (int filterX = 0; filterX < filterSize; filterX++)
                        {
                            for (int filterY = 0; filterY < filterSize; filterY++)
                            {
                                int imageX = (x - s + filterX + width)%width;
                                int imageY = (y - s + filterY + height)%height;

                                rgb = imageY*pbits.Stride + 3*imageX;

                                red += rgbValues[rgb + 2]*filter[filterX, filterY];
                                green += rgbValues[rgb + 1]*filter[filterX, filterY];
                                blue += rgbValues[rgb + 0]*filter[filterX, filterY];
                            }

                            rgb = y * pbits.Stride + 3 * x;

                            int r = Math.Min(Math.Max((int)(factor * red + (bias * rgbValues[rgb + 2])), 0), 255);
                            int g = Math.Min(Math.Max((int)(factor * green + (bias * rgbValues[rgb + 1])), 0), 255);
                            int b = Math.Min(Math.Max((int)(factor * blue + (bias * rgbValues[rgb + 0])), 0), 255);

                            result[x, y] = Color.FromArgb(r, g, b);
                        }
                    }
                }

                // Update the image with the sharpened pixels.
                for (int x = s; x < width - s; x++)
                {
                    for (int y = s; y < height - s; y++)
                    {
                        rgb = y*pbits.Stride + 3*x;

                        rgbValues[rgb + 2] = result[x, y].R;
                        rgbValues[rgb + 1] = result[x, y].G;
                        rgbValues[rgb + 0] = result[x, y].B;
                    }
                }

                // Copy the RGB values back to the bitmap.
                Marshal.Copy(rgbValues, 0, pbits.Scan0, bytes);
                // Release image bits.
                sharpenImage.UnlockBits(pbits);
            }

            return sharpenImage;
        }
    }
    return null;
} 
```

* * *

## 回答 #6

> 赞同：1
> 
>             
> 
> 时间：2015-12-29T13:46:54.630

嗨，我稍微编辑了代码并为我添加了另外两个矩阵，现在完美了

```
/// <summary>
    /// Sharpens the specified image.
    /// </summary>
    /// <param name="image">The image.</param>
    /// <param name="strength">strength erwartet werte zwische 0 - 99</param>
    /// <returns></returns>
    public Bitmap Sharpen(Image image, whichMatrix welcheMatrix , double strength)
    {
        double FaktorKorrekturWert = 0;

        //strenght muß für den jeweiligen filter angepasst werden
        switch (welcheMatrix)
        {
            case whichMatrix.Gaussian3x3:
                //diese Matrix benötigt einen strenght Wert von 0 bis -9.9 default ist -2.5
                //und einen korekturwert von 16
                strength = (strength * -1) / 10;
                FaktorKorrekturWert = 16;
                break;

            case whichMatrix.Mean3x3:
                //diese Matrix benötigt einen strenght Wert von 0 bis -9 default ist -2.25
                //und einen Korrekturwert von 10
                strength = strength * -9 / 100;
                FaktorKorrekturWert = 10;
                break;

            case whichMatrix.Gaussian5x5Type1:
                //diese Matrix benötigt einen strenght Wert von 0 bis 2.5 default ist 1.25
                //und einen Korrekturwert von 12
                strength = strength * 2.5 / 100;
                FaktorKorrekturWert = 12;
                break;

            default:
                break;
        }

        using (var bitmap = image as Bitmap)
        {
            if (bitmap != null)
            {
                var sharpenImage = bitmap.Clone() as Bitmap;

                int width = image.Width;
                int height = image.Height;

                // Create sharpening filter.
                var filter = Matrix(welcheMatrix);

                //const int filterSize = 3; // wenn die Matrix 3 Zeilen und 3 Spalten besitzt dann 3 bei 4 = 4 usw.                    
                int filterSize = filter.GetLength(0);                   

                double bias = 1.0 - strength;
                double factor = strength / FaktorKorrekturWert;

                //const int s = filterSize / 2;
                int s = filterSize / 2; // Filtersize ist keine Constante mehr darum wurde der befehl const entfernt

                var result = new Color[image.Width, image.Height];

                // Lock image bits for read/write.
                if (sharpenImage != null)
                {
                    BitmapData pbits = sharpenImage.LockBits(new Rectangle(0, 0, width, height), ImageLockMode.ReadWrite, PixelFormat.Format24bppRgb);

                    // Declare an array to hold the bytes of the bitmap.
                    int bytes = pbits.Stride * height;
                    var rgbValues = new byte[bytes];

                    // Copy the RGB values into the array.
                    Marshal.Copy(pbits.Scan0, rgbValues, 0, bytes);

                    int rgb;
                    // Fill the color array with the new sharpened color values.
                    for (int x = s; x < width - s; x++)
                    {
                        for (int y = s; y < height - s; y++)
                        {
                            double red = 0.0, green = 0.0, blue = 0.0;

                            for (int filterX = 0; filterX < filterSize; filterX++)
                            {
                                for (int filterY = 0; filterY < filterSize; filterY++)
                                {
                                    int imageX = (x - s + filterX + width) % width;
                                    int imageY = (y - s + filterY + height) % height;

                                    rgb = imageY * pbits.Stride + 3 * imageX;

                                    red += rgbValues[rgb + 2] * filter[filterX, filterY];
                                    green += rgbValues[rgb + 1] * filter[filterX, filterY];
                                    blue += rgbValues[rgb + 0] * filter[filterX, filterY];
                                }

                                rgb = y * pbits.Stride + 3 * x;

                                int r = Math.Min(Math.Max((int)(factor * red + (bias * rgbValues[rgb + 2])), 0), 255);
                                int g = Math.Min(Math.Max((int)(factor * green + (bias * rgbValues[rgb + 1])), 0), 255);
                                int b = Math.Min(Math.Max((int)(factor * blue + (bias * rgbValues[rgb + 0])), 0), 255);

                                result[x, y] = System.Drawing.Color.FromArgb(r, g, b);
                            }
                        }
                    }

                    // Update the image with the sharpened pixels.
                    for (int x = s; x < width - s; x++)
                    {
                        for (int y = s; y < height - s; y++)
                        {
                            rgb = y * pbits.Stride + 3 * x;

                            rgbValues[rgb + 2] = result[x, y].R;
                            rgbValues[rgb + 1] = result[x, y].G;
                            rgbValues[rgb + 0] = result[x, y].B;
                        }
                    }

                    // Copy the RGB values back to the bitmap.
                    Marshal.Copy(rgbValues, 0, pbits.Scan0, bytes);
                    // Release image bits.
                    sharpenImage.UnlockBits(pbits);
                }

                return sharpenImage;
            }
        }
        return null;
    }

    public enum whichMatrix
    {
        Gaussian3x3,
        Mean3x3,
        Gaussian5x5Type1
    }

    private double[,] Matrix(whichMatrix welcheMatrix)
    {
        double[,] selectedMatrix = null;

        switch (welcheMatrix)
        {
            case whichMatrix.Gaussian3x3:
                selectedMatrix = new double[,]
                { 
                    { 1, 2, 1, }, 
                    { 2, 4, 2, }, 
                    { 1, 2, 1, }, 
                };
                break;

            case whichMatrix.Gaussian5x5Type1:
                selectedMatrix = new double[,]
                { 
                    {-1, -1, -1, -1, -1},
                    {-1,  2,  2,  2, -1},
                    {-1,  2,  16, 2, -1},
                    {-1,  2, -1,  2, -1},
                    {-1, -1, -1, -1, -1} 
                };
                break;

            case whichMatrix.Mean3x3:
                selectedMatrix =new double[,]
                { 
                    { 1, 1, 1, }, 
                    { 1, 1, 1, }, 
                    { 1, 1, 1, }, 
                };
                break;
        }

        return selectedMatrix;
    } 
```

# jquery - 单击图像时如何使用 JQUERY 选择第二个元素？

> ID：903637
> 
>         
> 
> 赞同：2
> 
>         
> 
> 时间：2009-05-24T12:08:03.410
> 
>         
> 
> 标签：jquery

下面的代码仅适用于第一个 div。当我单击其他“img”时，我无法显示其他 div。你知道到达第二个（下一个）元素的方法吗？

```
$(document).ready(function() {

        $('.imgOpenClose').click(function() {
            if ($(this).attr("src") == "images/openTree.gif") {
                $(this).attr("src", "images/closeTree.gif");
                $(this).parent().find('div').eq(0).show();
            }
            else {
                $(this).attr("src", "images/openTree.gif");
                $(this).parent().find('div').eq(0).hide();
            }
        });
}); 
```

![当我点击加图片时想要打开表格](https://content.screencast.com/users/uzay95/folders/Jing/media/f055b873-714e-4d29-a605-05dabddd1cee/2009-05-24_1455.png)

![想看看这个div里面的表格](https://content.screencast.com/users/uzay95/folders/Jing/media/289bd853-26e0-43fc-bc2a-c3a21f5837c3/2009-05-24_1457.png)

* * *

## 回答 #1

> 赞同：2
> 
>             
> 
> 时间：2009-05-24T12:13:47.080

由于图像后面有一个中断元素，因此您需要使用 nextAll 并选择第一个 DIV，而不是`next`像我原来的答案那样简单地使用过滤器。

```
$('.imgOpenClose').click( function() {
    $(this).nextAll('div:first').toggle();
}); 
```

* * *

## 回答 #2

> 赞同：1
> 
>             
> 
> 时间：2009-05-24T12:15:24.660

如果您有多个具有相同类标签的图像，您仍然可以这样做而无需附加唯一的 id：

```
$(function() {
    $('.imgOpenClose').click(function() {
        $(this).next('div').children('table').toggle();
    });
}); 
```

# opengl - 为什么此代码中的堆栈溢出？

> ID：903642
> 
>         
> 
> 赞同：0
> 
>         
> 
> 时间：2009-05-24T12:12:10.033
> 
>         
> 
> 标签：opengl

我编写了这个函数来填充闭环，*pixvali*被全局声明以存储将完成第一次点击的像素的颜色值（在闭环内）。

但问题是这个递归在它的第一个 *fill(..,..)* 结束时并没有终止，它说堆栈溢出......

```
void fill(int x,int y)
{
    GLfloat pixval[3];
    glReadPixels(x,y,1,1,GL_RGB,GL_FLOAT,pixval);
    if(pixval[0]==pixvali[0] && pixval[1]==pixvali[1] && pixval[2]== pixvali[2])
    {
        glBegin(GL_POINTS);
            glVertex2i(x,y);
        glEnd();
        glFlush();
        fill(x-1,y);
        fill(x+1,y);
        fill(x,y-1);
        fill(x,y+1);
    }   
} 
```

* * *

## 回答 #1

> 赞同：4
> 
>             
> 
> 时间：2009-05-24T12:21:58.093

堆栈溢出是因为您正在使用递归，并且递归的深度与您正在填充的形状中的像素数成线性关系。

也可能是您试图用与它已经相同的颜色填充形状。即当前gl颜色与pixvali相同。在这种情况下，您将获得无限递归。

* * *

## 回答 #2

> 赞同：3
> 
>             
> 
> 时间：2009-05-24T12:28:44.930

从这个问题中很难看出，但我的猜测是，你开始进入一个像素循环。

例如，假设您只有 4 个像素需要为 (0,0)、(0,1)、(1,0)、(1,1) 着色。

您开始着色 (0,0)。然后你的递归将输入 (1,0) 因为(-1,0) 不需要着色。然后是 (0,0) ，因为像素是 (x-1, y) ，依此类推。

您需要添加一些方法来标记已经着色的像素。但这只是一个猜测，因为您无法真正看到该函数之外发生了什么。

* * *

## 回答 #3

> 赞同：1
> 
>             
> 
> 时间：2009-05-24T12:59:11.763

不确定实现细节，但如果 12 字节本地数组分配在堆栈上（3 个浮点数，每个 4 字节），那么 x 和 y 参数各有 4 个字节，返回地址可能有 4 个字节。每次递归时至少给出 24 个。这意味着你只需要超过 40'000 次调用就可以通过 1MB 的堆栈空间，如果上面没有其他内容的话，这是不正确的。

换个角度来看，43'690 像素仅为 800x600 显示器的 10% 左右。

* * *

## 回答 #4

> 赞同：1
> 
>             
> 
> 时间：2009-05-24T13:00:15.163

您需要检查正在编辑的像素。

例如，如果您有一个从 0,0 到 10,10 的图像并且您编辑 11,10，您将超出内存。

所以你需要检查 x,y 是否在图像的边界之间。

```
x>=left&&x<=right&&y>=top&&y<=bottom 
```

* * *

## 回答 #5

> 赞同：0
> 
>             
> 
> 时间：2009-05-24T12:47:39.960

实现您自己的堆栈，除非您正在填充具有相对较小的像素表面积的形状，否则不要使用递归进行洪水填充。

一个典型的实现是：

```
Stack stack; 
stack.push(firstPoint);

while(!stack.isEmpty()){
   Point currentPoint= stack.pop();
   //do what ever you want to do here, namely paint.
   //boundary check ur surrounding points and push them in the stack if they are inbounds
} 
```

* * *

## 回答 #6

> 赞同：0
> 
>             
> 
> 时间：2009-05-24T17:33:23.603

乍一看，该算法看起来不错。我有点担心“==”，因为它们不能很好地处理浮点值。我建议使用

```
abs(val1 - val2) < limit 
```

取而代之（`limit`例如，< 1 和 > 0。尝试 0.0001）。

为了追踪这个错误，我建议`printf()`在函数的开头添加一个。当您看到函数试图填充的内容时，这将有所帮助。也许它被卡在某个地方并以相同的坐标一次又一次地调用自己？

此外，对于您尝试填充的区域，堆栈可能太小了。首先尝试一个小区域，比如一个只有 4 x 3 像素的小矩形。不要尝试用鼠标单击它，而是从内部已知的好点开始（只需在代码中调用 fill()）。

打印颜色的值也会有所帮助。

* * *

## 回答 #7

> 赞同：0
> 
>             
> 
> 时间：2011-04-06T15:16:08.777

你为什么要为此滥用 OpenGL？你在那里做的事情很不稳定。例如，如果使用精心选择的投影和模型视图矩阵的组合，则 glReadPixels 读取的像素将仅对应于顶点位置。此外，每次填充迭代都会进行一次完整的往返。仅仅因为您使用的是 OpenGL，它并不会变得异常快。

如果要对帧缓冲区中的某个区域进行泛洪填充，请读出整个帧缓冲区，对其进行泛洪填充并将结果推回 OpenGL。此外，如果帧缓冲区的某些部分被遮挡（被窗口或类似的），这些部分将不会

现在要了解为什么您最终会陷入无限递归。考虑一下：

`fill(4, 4)`会打电话`fill(5, 4)`会打电话`fill(5, 5)`会打电话`fill(4, 5)`会打电话`fill(4, 4)` ***繁荣***

现在你已经有了那个测试：

```
if( pixval[0] == pixvali[0] && 
    pixval[1] == pixvali[1] && 
    pixval[2] == pixvali[2] ) 
```

请注意，如果要设置的像素已经具有目标颜色，则计算结果为 true，再次以无限递归结束。你应该测试*不等式*。

最后但同样重要的是：一张图片可能很容易包含数百万像素。通常的堆栈大小只允许最多 1000 个函数嵌套级别，因此您必须将尾递归转换为迭代。

TL;DR：不要为此使用 OpenGL，在本地缓冲区上操作，使用适当的迭代条件测试并使用迭代而不是递归（或使用函数式语言，然后编译器将处理尾递归）。

[http://en.wikipedia.org/wiki/Flood_fill](http://en.wikipedia.org/wiki/Flood_fill)

# batch-file - 用 .txt 文件中的文本检查输入文本的批处理文件

> ID：903650
> 
>         
> 
> 赞同：2
> 
>         
> 
> 时间：2009-05-24T12:15:39.713
> 
>         
> 
> 标签：batch-file, passwords, text-files

我喜欢有一个批处理文件来检查 .txt 文件中输入的文本是否相同。

像这样的东西：

```
@echo off
Set pass=
set /p pass=Enter your password:
......
...... 
```

.txt 文件是 pass.txt，它应该看起来像这样：

> p2342ddd3

所以我想要它做的是，用户必须输入 pass.txt 文件中的文本（显然不看它），并且批处理文件检查它是否与 pass.txt 文件中的文本相似。

* * *

## 回答 #1

> 赞同：2
> 
>             
> 
> 时间：2009-05-27T04:12:23.290

这将需要一个 for 循环和简单 if 的组合：

```
@echo off
:begin
set pass=
set /p pass=Enter your password: 
if {%pass%}=={} goto :begin
set authenticated=
for /f "tokens=*" %%a in (pass.txt) do (
    if {%%a}=={%pass%} set authenticated=true
)

if not defined authenticated (echo Invalid password & goto :begin)
exit /b 0 
```

* * *

## 回答 #2

> 赞同：0
> 
>             
> 
> 时间：2009-08-22T00:17:06.627

您可以使用内置命令[FINDSTR](http://ss64.com/nt/findstr.html)来匹配密码文件中的密码：

```
@echo off
set pass=
set /p pass=Enter your password:

findstr /B /E /M %pass% pass.txt > nul
If %ERRORLEVEL% EQU 0 echo Password matched! 
```

选项 /B 和 /E 用于确保匹配整个密码并且不会发生部分匹配。例如 42 包含在 p2342ddd3 中，但不应导致匹配。

选项 /M 和重定向到 nul 是为了确保密码不会泄漏。

如果找到项目（密码匹配），则 FINDSTR 将变量 ERRORLEVEL 设置为 0，如果未找到项目，则将其设置为大于 0 的值。

# sql - ADO.NET 中 SQL 参数的默认大小

> ID：903651
> 
>         
> 
> 赞同：4
> 
>         
> 
> 时间：2009-05-24T12:15:56.687
> 
>         
> 
> 标签：sql, ado.net, parameters, size

sqlcommand.Parameters.Add(...) 函数有多个重载。他们中的一些人不采取大小，有些人。默认设置什么尺寸？不设置参数大小是否安全？会影响性能吗？

* * *

## 回答 #1

> 赞同：4
> 
>             
> 
> 时间：2009-05-24T12:32:03.177

从[SqlParameter.Size 属性](http://msdn.microsoft.com/en-us/library/system.data.sqlclient.sqlparameter.size.aspx)文档

> 如果未显式设置，则从指定参数值的实际大小推断大小。

Peter Wone 在[293315](https://stackoverflow.com/questions/293311/whats-the-best-method-to-pass-parameters-to-sqlcommand/293315)上有一个很棒的回复，它更详细地描述了这实际上意味着什么

* * *

## 回答 #2

> 赞同：1
> 
>             
> 
> 时间：2009-05-24T12:32:49.367

可以将对于数据库数据类型而言太大的参数从 .Net 代码发送到 SQL Server。如果您在 .Net 代码中创建参数时设置了大小，如果发送的值太大，则会引发异常。所以你会更快知道并且不会浪费数据库调用。

或者，您可能希望为某些文本字段设置最大字符数。数据库可能允许 400 个字符的姓氏，但您只需要 varchar 100。

参数 Nullable 属性类似。它是可选的，但如果参数在 sproc 调用中不能为空，则在您的 .Net 代码中使其不可为空将更快地突出问题。

# asp.net-mvc - 在会话检查的某些条件下重定向到登录页面

> ID：903655
> 
>         
> 
> 赞同：1
> 
>         
> 
> 时间：2009-05-24T12:20:09.533
> 
>         
> 
> 标签：asp.net-mvc, session

在带有 MVC 的 C# 中，我想编写一个通用实用程序或类，如果特定条件失败需要重定向到登录页面。

例如：当用户登录网站时，会在 session 中添加 userid。要访问“ManageUsers”页面，用户应该以管理员身份登录，否则我需要重定向到登录页面。我还需要在其他一些类似页面中检查这种情况。我不想在登录时检查用户是管理员还是普通用户。我需要在普通课上检查这个。

有什么建议吗？

* * *

## 回答 #1

> 赞同：1
> 
>             
> 
> 时间：2009-05-24T12:26:24.573

这已经存在于带有授权属性的 ASP.NET MVC 中：  

```
[Authorize(Roles="Administrators")]
public AcitonResult ManageUsers() {

 return View();

} 
```

或者  

```
[Authorize(Users="Admin,SomeUser")]
public AcitonResult ManageUsers() {

   return View();

} 
```

更多信息：

[http ://www.asp.net/learn/mvc/tutorial-17-vb.aspx](http://www.asp.net/learn/mvc/tutorial-17-vb.aspx)

* * *

## 回答 #2

> 赞同：1
> 
>             
> 
> 时间：2009-05-24T12:32:15.203

```
[Authorize(Roles = "Admin")]
public ActionResult ManageUsersController()
{
    ...
} 
```

在您的 web.config 检查：

```
...
<forms loginUrl="~/your_login_page" defaultUrl="~/">
... 
```

此外，您应该在 web.config 中同时设置 MembershipProvider 和 RoleProvider

* * *

## 回答 #3

> 赞同：1
> 
>             
> 
> 时间：2009-05-24T12:38:03.600

实际上，我认为这对于应用程序来说并不是特别好的行为。我认为您应该禁用（或隐藏）用户无法执行的任何操作。在用户手动输入 URL 或使用他们拥有权限时的书签的情况下，显示错误消息而不是重定向到登录页面。

假设您是登录到您的应用程序的用户。您单击一个用户界面元素，看起来您已被注销。你无法知道你不应该使用它。禁用/隐藏元素可防止大多数用户出现这种情况。重定向到错误为用户提供了有价值的反馈，说明他们采取的行动为什么没有达到他们的预期。

我使用从 AuthorizeAttribute 派生的自定义属性来实现此效果。如果用户没有登录，它会重定向到登录页面。如果他们已登录，但没有足够的权限，它会显示一个合适的错误视图。

# c# - 加载程序集后执行的 C# 方法

> ID：903657
> 
>         
> 
> 赞同：5
> 
>         
> 
> 时间：2009-05-24T12:20:41.093
> 
>         
> 
> 标签：c#, class, ninject

我编写了一些 C# 类库，我想使用 Ninject 为我的类提供依赖注入。类库是否可以声明一些代码（方法），这些代码（方法）将在每次加载类库时执行。我需要这个来定义 Ninject 的绑定。

* * *

## 回答 #1

> 赞同：6
> 
>             
> 
> 时间：2009-05-24T12:37:21.480

听起来您正在寻找相当于 C++ 的 DllMain。在 C# 中没有办法做到这一点。  

你能给我们更多关于你的场景的信息，以及为什么你需要在 DllMain 风格的函数中执行代码吗？

在类型上定义静态构造函数并不能解决这个问题。静态类型构造函数只保证在以任何方式使用类型本身之前运行。您可以定义一个静态构造函数，在 Dll 中使用其他不访问该类型的代码，并且它的构造函数将永远不会运行。

* * *

## 回答 #2

> 赞同：1
> 
>             
> 
> 时间：2009-05-27T03:20:07.790

在过去的 9 个月里，我使用了很多 Ninject。听起来您需要做的是将库中存在的模块“加载”到 Ninject 内核中以注册绑定。  

我不确定您使用的是 Ninject 1.x 还是 2.0 beta。这两个版本的执行方式略有不同，尽管在概念上它们是相同的。在此讨论中，我将坚持使用 1.x 版本。我不知道的另一条信息是您的主程序是否正在实例化 Ninject 内核，而您的库是否只是向该内核添加绑定，或者您的库本身是否包含内核和绑定。我假设您需要将库中的绑定添加到主程序集中的现有 Ninject 内核。最后，我将假设您正在动态加载这个库，并且它没有静态链接到主程序。

首先要做的是在您的库中定义一个 ninject 模块，您可以在其中注册所有绑定——您可能已经这样做了，但值得一提。例如：

```
public class MyLibraryModule : StandardModule {
  public override void Load() {
    Bind<IMyService>()
      .To<ServiceImpl>();
    // ... more bindings ...
  }
} 
```

现在您的绑定包含在 Ninject 模块中，您可以在加载程序集时轻松注册它们。这个想法是，一旦加载了程序集，就可以扫描它以查找从 StandardModule 派生的所有类型。一旦有了这些类型，就可以将它们加载到内核中。

```
// Somewhere, you define the kernel...
var kernel = new StandardKernel();

// ... then elsewhere, load your library and load the modules in it ...

var myLib = Assembly.Load("MyLibrary");
var stdModuleTypes = myLib
                       .GetExportedTypes()
                       .Where(t => typeof(StandardModule).IsAssignableFrom(t));

foreach (Type type in stdModuleTypes) {
  kernel.Load((StandardModule)Activator.CreateInstance(type));
} 
```

需要注意的一点是，您可以进一步概括上述代码以加载多个库并注册多种类型。此外，正如我上面提到的，Ninject 2 内置了这种功能——它实际上具有扫描目录、加载程序集和注册模块的能力。很酷。

如果您的情况与我所概述的略有不同，则可能会采用类似的原则。

* * *

## 回答 #3

> 赞同：1
> 
>             
> 
> 时间：2009-05-24T13:06:50.967

你试过这个`AppDomain.AssemblyLoad`活动吗？它在程序集加载后触发。

```
AppDomain.CurrentDomain.AssemblyLoad += (s, e) =>
{
    Assembly justLoaded = e.LoadedAssembly;
    // ... etc.
}; 
```

* * *

## 回答 #4

> 赞同：0
> 
>             
> 
> 时间：2009-05-24T12:46:57.123

你能控制客户端代码吗？如果是的话，我不会在加载程序集时尝试做魔术，而是去实现一个像 Registry 这样的类来进行绑定，实现一个接口 IRegistry。然后在加载期间，您可以在程序集中查找 IRegistry 的实现并触发必要的方法。

你也可以在你的类上有属性：

```
[Component(Implements=typeof(IMyDependency)] 
```

查找这些属性并将它们加载到客户端的容器中。

或者您可以查看[MEF](http://www.codeplex.com/MEF)，它是针对此类情况的库。

* * *

## 回答 #5

> 赞同：-1
> 
>             
> 
> 时间：2009-05-24T12:39:33.050

据我所知，答案是否定的。据我所知，您想在您的类库中配置您的 IoC 容器，如果是这种情况，那么这样做不是一个好主意。如果您在类库中定义绑定，那么什么是使用依赖注入？我们使用依赖注入，这样我们就可以在运行时注入依赖，然后我们可以在不同的场景中注入不同的对象。虽然配置 IoC 容器的最佳位置是应用程序的启动（因为 IoC 容器就像应用程序的骨干一样） :) ) 但它应该放在负责启动应用程序的引导程序中。在简单的应用程序中，它可以是 Main 方法。

# css - 为什么我不能同时使用背景图像和颜色？

> ID：903659
> 
>         
> 
> 赞同：189
> 
>         
> 
> 时间：2009-05-24T12:21:07.160
> 
>         
> 
> 标签：css

我要做的是同时显示`background-color`和`background-image`，这样我的一半`div`将覆盖右侧阴影背景图像，而另一半将覆盖背景颜色。

但是当我使用时`background-image`，颜色消失了。

* * *

## 回答 #1

> 赞同：315
> 
>             
> 
> 时间：2009-05-24T13:30:13.387

完全可以同时使用颜色和图像作为元素的背景。

您设置`background-color`和`background-image`样式。如果图像小于元素，则需要使用`background-position`样式将其放置在右侧，并防止其重复并覆盖您使用`background-repeat`样式的整个背景：

```
background-color: green;
background-image: url(images/shadow.gif);
background-position: right;
background-repeat: no-repeat; 
```

或使用复合样式`background`：

```
background: green url(images/shadow.gif) right no-repeat; 
```

如果您使用复合样式`background`分别设置两者，则只会使用最后一个，这可能是您的颜色不可见的原因之一：

```
background: green; /* will be ignored */
background: url(images/shadow.gif) right no-repeat; 
```

没有办法专门限制背景图像仅覆盖元素的一部分，因此您必须确保图像小于元素，或者它具有任何透明区域，以便背景颜色可见。

* * *

## 回答 #2

> 赞同：35
> 
>             
> 
> 时间：2014-01-27T12:04:40.807

要为图像着色，您可以使用 CSS3`background`堆叠图像和`linear-gradient`. 在下面的示例中，我使用`linear-gradient`没有实际渐变的 a。浏览器将渐变视为图像（我认为它实际上会生成位图并覆盖它），因此实际上是堆叠多个图像。

```
background: linear-gradient(0deg, rgba(2,173,231,0.5), rgba(2,173,231,0.5)), url(images/mba-grid-5px-bg.png) repeat; 
```

如果您有 png，将生成带有浅蓝色色调的方格纸。请注意，堆叠顺序可能与您的心智模型相反，第一项位于顶部。

Mozilla 的优秀文档，在这里：

[https://developer.mozilla.org/en-US/docs/Web/Guide/CSS/Using_multiple_backgrounds](https://developer.mozilla.org/en-US/docs/Web/Guide/CSS/Using_multiple_backgrounds)

构建渐变的工具：

[http://www.colorzilla.com/gradient-editor/](http://www.colorzilla.com/gradient-editor/)

注意 - 在 IE11 中不起作用！当我找出原因时，我会发布更新，因为它应该是。

* * *

## 回答 #3

> 赞同：29
> 
>             
> 
> 时间：2009-05-24T12:23:48.153

利用

```
background:red url(../images/samle.jpg) no-repeat left top; 
```

* * *

## 回答 #4

> 赞同：14
> 
>             
> 
> 时间：2009-05-24T12:36:14.320

要添加[到此](https://stackoverflow.com/questions/903659/why-i-cant-use-background-image-and-color-together/903665#903665)答案，请确保图像本身具有透明背景。

* * *

## 回答 #5

> 赞同：4
> 
>             
> 
> 时间：2018-10-22T12:37:20.293

实际上有一种方法可以将背景颜色与背景图像一起使用。在这种情况下，背景部分将填充指定的颜色，而不是白色/透明的。

为了实现这一点，您需要`background`像这样设置属性：

```
.bg-image-with-color {
    background: url("example.png") no-repeat, #ff0000;
} 
```

`no-repeat`注意;后面的逗号和颜色代码 这会设置您想要的背景颜色。

我在[这个 YouTube 视频](https://www.youtube.com/watch?v=bJ9NIGX4zRM)中发现了这一点，但我与该频道或视频没有任何关联。

* * *

## 回答 #6

> 赞同：2
> 
>             
> 
> 时间：2017-08-17T17:37:56.007

`background-image`这是一起使用and的示例`background-color`：

```
.box {
  background-image: repeating-linear-gradient( -45deg, rgba(255, 255, 255, .2), rgba(255, 255, 255, .2) 15px, transparent 15px, transparent 30px);
  width: 100px;
  height: 100px;
  margin: 10px 0 0 10px;
  display: inline-block;
}
```

```
<div class="box" style="background-color:orange"></div>
<div class="box" style="background-color:green"></div>
<div class="box" style="background-color:blue"></div>
```

* * *

## 回答 #7

> 赞同：0
> 
>             
> 
> 时间：2009-05-24T13:05:17.320

使图像的一半透明，以便通过它看到背景颜色。

否则只需添加另一个占容器 div 50% 的 div 并将其向左或向右浮动。然后将图像或颜色应用到它。

* * *

## 回答 #8

> 赞同：0
> 
>             
> 
> 时间：2014-07-30T14:50:00.757

Gecko 有一个奇怪的错误，即设置`background-color`选择器的`html`选项会掩盖`background-image`body 元素的，即使`body`元素*实际上*具有更大的 z-index，并且您*应该*能够看到 body`background-image`以及`html` `background-color`完全基于简单逻辑的 body 元素。

**壁虎虫**

避免以下...

```
html {background-color: #fff;}
body {background-image: url(example.png);} 
```

**解决问题**

```
body {background-color: #fff; background-image: url(example.png);} 
```

* * *

## 回答 #9

> 赞同：0
> 
>             
> 
> 时间：2017-12-20T19:08:57.320

大家好，我尝试了另一种将背景图像和背景颜色组合在一起的方法：

HTML

```
<article><canvas id="color"></canvas></article> 
```

CSS

```
article {
  height: 490px;
  background: url("Your IMAGE") no-repeat center cover;
  opacity:1;
} 

canvas{
  width: 100%; 
  height: 490px; 
  opacity: 0.9;
} 
```

JAVASCRIPT

```
window.onload = init();

var canvas, ctx;

function init(){
  canvas = document.getElementeById('color'); 
  ctx = canvas.getContext('2d'); 
  ctx.save();  
  ctx.fillstyle = '#00833d'; 
  ctx.fillRect(0,0,490,490);ctx.restore();
} 
```

请让我知道它是否对您有用 谢谢

* * *

## 回答 #10

> 赞同：-3
> 
>             
> 
> 时间：2014-08-09T12:59:19.240

```
background:url(directoryName/imageName.extention) bottom left no-repeat; 
background-color: red; 
```

# c# - 可重用的 C#、Java 和/或 Flex 组件

> ID：903663
> 
>         
> 
> 赞同：0
> 
>         
> 
> 时间：2009-05-24T12:23:46.327
> 
>         
> 
> 标签：c#, java, apache-flex

我正在寻找可重用的开源组件。我正在寻找的深度、广度和质量水平与[此](http://software.topcoder.com/catalog/c_showroom.jsp?a=all)类似。

虽然我在编程语言 C#、Java 和 Flex（我经常在我的项目中使用）中需要它们，但欢迎使用其他语言，如 PHP、Perl、Python、Ruby 等。我认为这对于像我这样有类似需求的其他程序员来说是一个很大的帮助。

我计划在构建大规模（就代码大小而言）项目时使用这些组件来消除代码重复，并更多地关注它的业务逻辑。

是否有我不知道的开源 (Java) 或 Codeplex (Microsoft) 组件实现可以做到这一点？

编辑：

对于这个问题，我想解决的主要问题是避免开发人员之间的重复。在 Pragmatic Programmer 中发现的有趣案例：对政府计算机系统进行的审计表明，有 10,000 个不同的程序具有自己的社会安全号码验证版本。

* * *

## 回答 #1

> 赞同：1
> 
>             
> 
> 时间：2009-05-25T01:25:32.900

如果我理解您的问题，这就是[Apache Commons](http://commons.apache.org/)的全部意义所在。

我要指出的是，虽然这些事情是好的，但它们并不全是有利的。如果所有这 10,000 名程序员都必须协调进行 SSN 验证，那么完成任何事情都是相当官僚的。

同样，一般来说，apache commons 的问题之一是您可能将代码集成到使用同一组件的旧（或新）版本的东西中。

此外，任何代码更改都必须在庞大的代码库上进行验证，有时还会以重用的名义做出丑陋的变通方法。

重用和 DRY 是很棒的东西，但就像其他一切一样，随着规模的扩大，也需要权衡取舍。

* * *

## 回答 #2

> 赞同：0
> 
>             
> 
> 时间：2009-05-24T12:34:24.810

不太确定问题的上下文，如果您想要基于 Web 的 Java 应用程序的 UI 组件，可能是带有组件库的 JSF 框架，例如具有多个组件库的[Apache MyFaces或](http://myfaces.apache.org/)[ICEfaces](http://component-showcase.icefaces.org/component-showcase/showcase.iface)。

* * *

## 回答 #3

> 赞同：0
> 
>             
> 
> 时间：2009-05-25T10:10:55.510

好吧，如果您正在使用一些 flex 组件，您可以尝试以下一些方法，对不起，我无法发布超链接我是新用户，所以只需复制粘贴文本（这很糟糕 - 给我一些声誉，以便我至少可以回答一个问题！）

链接 - code.google.com/p/flexlib/

链接 - www.adobe.com/devnet/flex/tourdeflex/ （这里有 adobe 产品以外的组件的示例和源代码）

链接 - flexbox.mrinalwadhwa.com/

链接 - www.adobe.com/cfusion/exchange/index.cfm?event=productHome&exc=15（这有免费和付费的组件）

那里有更多的开源 flex 组件。只需检查谷歌。

# c++ - 使用单例初始化程序

> ID：903676
> 
>         
> 
> 赞同：1
> 
>         
> 
> 时间：2009-05-24T12:29:16.410
> 
>         
> 
> 标签：c++, design-patterns, singleton

我已经阅读了多篇关于为什么单身人士不好的文章。

我知道它几乎没有像日志记录这样的用途，但是初始化和取消初始化呢？

这样做有什么问题吗？

我有一个脚本引擎，我需要在启动时绑定到一个库。

库没有 main() 那么我应该使用什么？

常规函数或单例。

可以以某种方式复制此对象：  

```
class
{
public:
   static void initialize();
   static void deinitialize();

}  bootstrap; 
```

如果不是，为什么人们要隐藏复制 ctor、赋值运算符和 ctor？

* * *

## 回答 #1

> 赞同：4
> 
>             
> 
> 时间：2009-05-24T13:29:28.160

C++ 中的库有一种更简单的方法来执行初始化和清理。这与您为其他任何事情做的方式完全相同。RAII。

将需要初始化的所有东西都包装在一个类中，并在构造函数中执行它的初始化。瞧，问题解决了。

单身人士的所有常见问题仍然适用：

*   即使您没有计划，您*将*需要多个实例。如果没有别的，你会在单元测试时需要它。每个测试都应该从头开始初始化库，以便它在干净的环境中运行。单例方法很难做到这一点。

*   一旦这些单身人士开始相互引用，你就完蛋了。因为实际的初始化顺序是不可见的，你很快就会得到一堆循环引用，从而导致访问未初始化的单例或堆栈溢出或死锁或其他有趣的错误*，如果你没有痴迷，这些错误可能在编译时被捕获让一切变得全球化*。

*   多线程。强制所有线程共享一个类的同一个实例通常是一个坏主意，因为它会强制该类锁定和同步**所有内容**，这会消耗大量性能，并且可能导致死锁。

*   意大利面条代码。每次使用单例或全局时，您都在隐藏代码的依赖项。不再清楚函数依赖于哪些对象，因为并非所有对象都作为参数可见。而且由于您不需要将它们作为参数添加，因此您很容易最终添加了比必要更多的依赖项。这就是为什么单例一旦拥有它们就几乎不可能删除。

* * *

## 回答 #2

> 赞同：1
> 
>             
> 
> 时间：2009-05-24T12:41:20.300

单例的目的是在您的系统中只有一个特定类的实例。C'tor、D'tor 和 CC'tor 是隐藏的，以便有一个单一的访问点来接收唯一的现有实例。

通常实例是静态的（也可以在堆上分配）并且是私有的，并且有一个静态方法（通常称为 GetInstance）返回对该实例的引用。

在决定是否拥有单例时，您应该问自己的问题是：我真的需要强制拥有此类的一个对象吗？

还有继承问题 - 如果您打算从单例继承，它会使事情变得复杂。

另一个问题是[如何杀死一个单身人士](http://sourcemaking.com/design_patterns/to_kill_a_singleton)（网上到处都是关于这个问题的文章）

在某些情况下，最好静态保存您的私有数据而不是单例，这一切都取决于域。

但请注意，如果您是多线程的，静态变量可能会给您带来 XXX 的痛苦……

因此，在决定要使用的设计模式之前，您应该仔细分析您的问题......   

在您的情况下，我认为您不需要单例，因为您希望在开始时初始化库，但这与强制只有一个类实例无关。如果您只想确保初始化一次，则可以只保留一个静态标志（静态布尔初始化）。

调用一次方法不足以成为单例。

* * *

## 回答 #3

> 赞同：0
> 
>             
> 
> 时间：2009-05-30T19:15:35.550

计算设计中的单例数，并将此数字称为“s”

计算设计中的线程数，并将此数字称为“t”

现在，将 t 提高到 s 次方；这大致是您在调试生成的代码时可能失去的头发数量。

（我个人曾与超过 50 个单例和 10 个不同线程的代码发生冲突，所有线程都争先恐后地到达 .getInstance()）

* * *

## 回答 #4

> 赞同：0
> 
>             
> 
> 时间：2009-05-24T12:43:28.923

为您的库提供接口是一个很好的做法，以便多个模块（或线程）可以同时使用它们。如果你真的需要在加载模块时运行一些代码，那么使用单例来初始化必须**初始化**一次的*部分。*

 **# c# - C# 中的时间延迟

> ID：903688
> 
>         
> 
> 赞同：6
> 
>         
> 
> 时间：2009-05-24T12:35:39.050
> 
>         
> 
> 标签：c#, .net

以下函数 System.Threading.Thread.Sleep(); 以毫秒为单位延迟线程，并将整数值作为参数。有没有微秒级线程延迟的方法。或者 sleep 函数可以采用浮点值吗？谢谢

* * *

## 回答 #1

> 赞同：17
> 
>             
> 
> 时间：2009-05-24T12:40:53.673

没有。从[85122引用 Will Dean](https://stackoverflow.com/questions/85122/sleep-less-than-one-millisecond)

> 你不能在这么短的时间内有意义地“睡觉”（即放弃你预定的 CPU）。如果您想延迟一小段时间，那么您需要旋转，反复检查适当的高分辨率计时器（例如“性能计时器”），并希望高优先级的东西无论如何都不会抢占您。

* * *

## 回答 #2

> 赞同：10
> 
>             
> 
> 时间：2009-05-24T12:43:35.273

睡眠首先不能精确到毫秒。我认为它的分辨率取决于硬件，你可以睡觉的最短时间通常是 20 毫秒左右。这与 Sleep 实际上释放当前线程的时间片可能剩余的内容有关。并允许另一个线程运行。您的线程能够再次运行的最早时间是在一个线程调度程序时间片过去之后。因此分辨率约为 20 毫秒（假设您系统上的时间片为 20 毫秒）。

由于 Windows 不是实时操作系统；睡眠和其他等待功能永远不可能完全确定。

根据您的应用程序，您可能大部分时间都可以进行睡眠，然后在时间至关重要的情况下进行忙碌的等待。或者重写结构，以便准确测量经过的时间（使用 System.Diagnostics.Stopwatch）；但不要依赖于能够在毫秒范围内的准确时间段内睡眠。

MSDN上这个线程的[第一个答案](http://social.msdn.microsoft.com/Forums/en-US/clr/thread/facc2b57-9a27-4049-bb32-ef093fbf4c29)也很好地解释了它。

* * *

## 回答 #3

> 赞同：1
> 
>             
> 
> 时间：2009-05-24T12:38:37.967

您会发现 Thread.Sleep 的最佳粒度是使用 TimeSpan 类。不幸的是，它支持的最小粒度是毫秒。没有办法在微秒范围内休眠。

* * *

## 回答 #4

> 赞同：1
> 
>             
> 
> 时间：2009-05-24T14:45:28.180

我必须编写一个音乐程序，其中音符必须精确地以正确的持续时间开始/停止，所以我使用 DirectX 中的高分辨率计时器来执行此操作，但是，我的应用程序也会保持在顶部并占用 CPU，因此它可以继续检查何时执行下一个操作。

由于无法确切知道操作系统何时将控制权返回给您的应用程序，因此 Thread.Sleep 将是一个非常糟糕的选择，并且如前所述，根据我的经验，最小的时间增量可以在 10 到 50 毫秒之间变化。

# ruby-on-rails - rake 规范不使用 rails 环境

> ID：903689
> 
>         
> 
> 赞同：6
> 
>         
> 
> 时间：2009-05-24T12:35:47.503
> 
>         
> 
> 标签：ruby-on-rails, ruby, rspec, rake

我正在尝试在我刚刚升级到 rails 2.3.2 的 rails 项目中使用 rspec。我已经在应用程序中安装了 rspec 1.2.6 和 rspec-rails 1.2.6 作为插件。

我的问题是规范无法访问我的应用程序类或任何 rails 标准库。

首先，我必须使用 RAILS_ROOT 的完整路径指定要测试的模型类，但现在加载类时，我得到以下信息

```
/app/models/person.rb:1: 未初始化的常量 ActiveRecord (NameError)
        来自 ./spec/models/person_spec.rb:1:in `require'
    来自 ./spec/models/person_spec.rb:1
    来自 /Users/law/Projects/roster/vendor/plugins/rspec/lib/spec/runner/example_group_runner.rb:15:in `load'
    来自 /Users/law/Projects/roster/vendor/plugins/rspec/lib/spec/runner/example_group_runner.rb:15:in `load_files'
    来自 /Users/law/Projects/roster/vendor/plugins/rspec/lib/spec/runner/example_group_runner.rb:14:in `each'
    来自 /Users/law/Projects/roster/vendor/plugins/rspec/lib/spec/runner/example_group_runner.rb:14:in `load_files'
    来自 /Users/law/Projects/roster/vendor/plugins/rspec/lib/spec/runner/options.rb:99:in `run_examples'
    来自 /Users/law/Projects/roster/vendor/plugins/rspec/lib/spec/runner/command_line.rb:9:in `run'
    来自 /Users/law/Projects/roster/vendor/plugins/rspec/bin/spec:4
耙中止！

```

我通过从应用程序的根目录调用 rake spec 来启动 rspec。

关于在这种情况下可能缺少什么的任何想法？

* * *

## 回答 #1

> 赞同：6
> 
>             
> 
> 时间：2009-05-30T19:08:12.007

您确实需要`spec_helper.rb`在您编写的每个规范文件中包含...

您可以通过这种方式运行单个规范：

```
$ spec specs/models/person_spec.rb 
```

而不是总是运行整个规范套件

* * *

## 回答 #2

> 赞同：0
> 
>             
> 
> 时间：2009-05-24T15:32:24.653

我没有使用规范，所以这可能无法解决您的问题，但是如果您正在编写自己的 rake 任务并需要您的 rails 环境，则必须提出要求。

```
task(:task_name => :environment) do
    # Task Implementation Here
end 
```

# c# - 在 C# 中读取 mbox 文件

> ID：903711
> 
>         
> 
> 赞同：4
> 
>         
> 
> 时间：2009-05-24T12:47:17.387
> 
>         
> 
> 标签：c#, email, mime, mbox

我们的一位员工丢失了他的邮箱，但幸运的是他的电子邮件以 mbox 格式转储。我需要以某种方式获取 mbox 文件中的所有消息并将它们喷射到我们的技术支持数据库中（因为它是一个自定义工具，所以没有可用的导入工具）。

我发现[SharpMimeTools](http://anmar.eu.org/projects/sharpmimetools/)可以分解消息，但不允许您遍历 mbox 文件中的一堆消息。

有谁知道无需学习 RFC 就可以打开的体面解析器？

* * *

## 回答 #1

> 赞同：19
> 
>             
> 
> 时间：2013-09-13T13:11:07.393

我正在使用 C# 开发一个名为[MimeKit](http://github.com/jstedfast/MimeKit)的 MIME 和 mbox 解析器。

它基于我编写的早期 MIME 和 mbox 解析器（例如[GMime](http://spruce.sourceforge.net/gmime)），速度非常快（可以在大约 1 秒内解析 1.2GB mbox 文件中的每条消息）。

我还没有测试 MimeKit 的性能，但是我在 C# 中使用了许多与我在 C 中使用的相同的技术。我怀疑它会比我的 C 实现慢，但是因为瓶颈是 I/O 而 MimeKit 是像 GMime 那样写来做最佳（4k）读取，它们应该非常接近。

您发现当前方法很慢（StreamReader.ReadLine()，组合文本，然后将其传递给 SharpMimeTools）的原因是由于以下原因：

1.  StreamReader.ReadLine() 不是从文件中读取数据的最佳方式。虽然我确定 StreamReader() 会进行内部缓冲，但它需要执行以下步骤：

    A) 将从文件中读取的字节块转换为 unicode（这需要遍历从磁盘读取的 byte[] 中的字节，以将从流中读取的字节转换为 unicode char[]）。

    B) 然后它需要遍历其内部的 char[]，将每个 char 复制到 StringBuilder 中，直到找到一个 '\n'。

    所以就在那里，只需读取行，您就可以通过 mbox 输入流至少 2 次。更不用说正在进行的所有内存分配......

2.  然后你把你读过的所有行合并成一个大字符串。这需要对您的输入进行另一次传递（大概将从 ReadLine() 读取的每个字符串中的每个字符复制到 StringBuilder 中？）。

    我们现在对输入文本进行了多达 3 次迭代，甚至还没有进行任何解析。

3.  现在你将你的巨型字符串交给 SharpMimeTools，它使用一个 SharpMimeMessageStream... (/facepalm) 是一个基于 ReadLine() 的解析器，它位于另一个进行字符集转换的 StreamReader 之上。在解析任何内容之前进行 5 次迭代。如果 SharpMimeMessageStream 发现它读得太远，它还有一种方法可以“撤消” ReadLine()。因此可以合理地假设他至少扫描了*其中一些行两次。*更不用说正在进行的所有字符串分配......呃。

4.  对于每个标题，一旦 SharpMimeTools 拥有其行缓冲区，它就会拆分为字段和值。那是另一个关卡。到目前为止，我们最多可以通过 6 次。

5.  然后 SharpMimeTools 使用 string.Split()（这很好地表明这个 mime 解析器不符合标准）通过拆分来标记地址头，并通过拆分参数化头（例如 Content-Type 和 Content-Disposition）在 ';'。那是另一个关卡。（我们现在最多 7 次传球。）

6.  一旦它拆分它们，它就会对从 string.Split() 返回的每个字符串运行正则表达式匹配，然后每个 rfc2047 编码词令牌传递更多的正则表达式，然后最终对编码词字符集和有效负载组件进行另一次传递。到目前为止，我们正在谈论至少 9 或 10 次通过大部分输入。

我放弃了进一步的考试，因为它已经是 GMime 和 MimeKit 所需的 2 倍多，而且我*知道*我的解析器可以优化为至少比它们少 1 次通过。

此外，作为旁注，任何解析字符串而不是 byte[]（或 sbyte[]）的 MIME 解析器都不会很好。电子邮件的问题在于，如此多的邮件客户端/脚本/等会在标题和消息正文中发送未声明的 8 位文本。*unicode 字符串解析器*如何处理这个问题？提示：不能。

```
using (var stream = File.OpenRead ("Inbox.mbox")) {
    var parser = new MimeParser (stream, MimeFormat.Mbox);
    while (!parser.IsEndOfStream) {
        var message = parser.ParseMessage ();

        // At this point, you can do whatever you want with the message.
        // As an example, you could save it to a separate file based on
        // the message subject:
        message.WriteTo (message.Subject + ".eml");

        // You also have the ability to get access to the mbox marker:
        var marker = parser.MboxMarker;

        // You can also get the exact byte offset in the stream where the
        // mbox marker was found:
        var offset = parser.MboxMarkerOffset;
    }
} 
```

**2013-09-18 更新：**我已经让 MimeKit 可以用于解析 mbox 文件并成功地解决了问题，但它的速度不如我的 C 库快。这是在 iMac 上测试的，因此 I/O 性能不如我的旧 Linux 机器（这是 GMime 能够在 ~1s 内解析类似大小的 mbox 文件的地方）：

```
[fejj@localhost MimeKit]$ mono ./mbox-parser.exe larger.mbox 
Parsed 14896 messages in 6.16 seconds.
[fejj@localhost MimeKit]$ ./gmime-mbox-parser larger.mbox 
Parsed 14896 messages in 3.78 seconds.
[fejj@localhost MimeKit]$ ls -l larger.mbox 
-rw-r--r--  1 fejj  staff  1032555628 Sep 18 12:43 larger.mbox 
```

正如你所看到的，GMime 仍然相当快，但我对如何提高 MimeKit 解析器的性能有一些想法。事实证明，C# 的`fixed`语句非常昂贵，所以我需要重新使用它们。例如，我昨天做[的一个简单优化](https://github.com/jstedfast/MimeKit/commit/a6384b0defe509198616573f03557d33c9b9feac)将总时间缩短了大约 2-3 秒（如果我没记错的话）。

**优化更新：**通过替换将性能提高了 20%：

```
while (*inptr != (byte) '\n')
    inptr++; 
```

和：

```
do {
    mask = *dword++ ^ 0x0A0A0A0A;
    mask = ((mask - 0x01010101) & (~mask & 0x80808080));
} while (mask == 0);

inptr = (byte*) (dword - 1);
while (*inptr != (byte) '\n')
    inptr++; 
```

**优化更新：**通过放弃使用 Enum.HasFlag() 并改用直接位掩码，我终于能够使 MimeKit 与 GMime 一样快。

MimeKit 现在可以在 3.78 秒内解析相同的 mbox 流。

作为比较，SharpMimeTools 需要 20 多*分钟*（为了测试这一点，我不得不将电子邮件分成单独的文件，因为 SharpMimeTools 无法解析 mbox 文件）。

**另一个更新：**通过整个代码中的各种其他调整，我已经把它降到了 3.00 秒。

* * *

## 回答 #2

> 赞同：2
> 
>             
> 
> 时间：2009-05-24T13:05:38.317

我不知道任何解析器，但 mbox 确实是一种非常简单的格式。一封新电子邮件以“发件人”（发件人+空格）开头的行开始，每封邮件的末尾都附有一个空行。如果在电子邮件本身的行首出现任何“From”，则将其引用（通过在前面添加“>”）。

另请参阅[Wikipedia 关于该主题的条目](http://en.wikipedia.org/wiki/Mbox#Family)。

* * *

## 回答 #3

> 赞同：0
> 
>             
> 
> 时间：2009-05-24T13:05:40.160

如果您可以使用 Python，标准库中有[一个](http://docs.python.org/library/mailbox.html#mailbox.mbox)。遗憾的是，我无法为 .NET 找到任何内容。

* * *

## 回答 #4

> 赞同：0
> 
>             
> 
> 时间：2019-11-01T17:08:42.640

要阅读 .mbox 文件，您可以使用第三方库[Aspose.Email](https://products.aspose.com/email/net?utm_source=https://stackoverflow.com/questions/903711/reading-an-mbox-file-in-c-sharp/58663160#58663160&utm_medium=email&utm_campaign=reading-an-mbox-file-in-c-sharp)。该库是一套完整的电子邮件处理 API，用于构建跨平台应用程序，能够在不使用 Microsoft Outlook 的情况下创建、操作、转换和传输电子邮件。

请看一下我在下面提供的示例。

```
using(FileStream stream = new FileStream("ExampleMbox.mbox", FileMode.Open, FileAccess.Read))
{
    using(MboxrdStorageReader reader = new MboxrdStorageReader(stream, false))
    {
        // Start reading messages
        MailMessage message = reader.ReadNextMessage();

        // Read all messages in a loop
        while (message != null)
        {
            // Manipulate message - show contents
            Console.WriteLine("Subject: " + message.Subject);
            // Save this message in EML or MSG format
            message.Save(message.Subject + ".eml", SaveOptions.DefaultEml);
            message.Save(message.Subject + ".msg", SaveOptions.DefaultMsgUnicode);

            // Get the next message
            message = reader.ReadNextMessage();
        }
    }
} 
```

它很容易使用。我希望这种方法能让您和其他搜索者满意。

我在 Aspose 担任开发人员布道师。

# compiler-construction - 当前硬件上编译器性能的已知限制是多少？

> ID：903715
> 
>         
> 
> 赞同：-2
> 
>         
> 
> 时间：2009-05-24T12:50:32.717
> 
>         
> 
> 标签：compiler-construction

现在有真正的理由使用动态链接和二进制分发吗？

对于二进制发行版，在源代码中分发所有内容并让平台选择是否编译二进制文件是另一种选择。但它是否可用取决于今天的计算机从源代码编译的能力如何。

动态链接属于这个问题，因为它也允许在二进制文件中分发库。

那么，一个编译器能展示出多好的性能呢？有没有优化？可以做些什么来从编译器中获得更好的性能？

* * *

## 回答 #1

> 赞同：4
> 
>             
> 
> 时间：2009-05-24T12:56:49.147

您的问题有点不清楚，但似乎与两个不相关的项目有关。在许多情况下，将组件分解为动态和静态链接库确实可以加快编译速度。然而，动态和静态库并不是为此目的而发明的。发明它们是为了在功能和程序之间提供可重用的组件。不是为了让编译更快。  

* * *

## 回答 #2

> 赞同：2
> 
>             
> 
> 时间：2009-05-24T13:26:38.323

提供软件的二进制分发是有**真正的理由的。**撇开通过编译混淆软件的业务问题，因此没有以非常清晰的方式提供专有逻辑，它使**用户的**事情变得更简单，这就是软件的用途。

**我真的不喜欢**以源代码格式获得 GCC、Gnome、PHP 等大型软件包，**除非我正在开发**该软件。即使在我的四核机器上，编译也需要时间。我宁愿只是移动一些二进制 blob。

还要记住（至少在 Linux 系统上）创建二进制发行版允许经过测试的**一致且稳定**的系统。创建二进制发行版是向用户最好的直接翻译测试软件配置。

鉴于许多 JIT/Interpreted 语言的运行速度大约是 C 语言的 1/2（粗略地说，我肯定有些做得更好），我宁愿拥有软件的机器代码分发，也不愿看到用 Java/C# 编写的所有内容。特别是当我不需要查看代码时。没关系下载源代码分发和按需编译。作为用户（和开发人员），RPM/.debs 要简单得多。

所以这种回答“现在人们有真正的理由使用动态链接和二进制分布吗？”。动态库的问题并不是真正的问题。运行时符号解析不会过多降低性能。否则，像 Apache 和无数其他项目将如何处理模块架构？（嘿，他们总是可以有一个内置的编译器/解释器、链接器、加载器并手动完成！*颤抖*）

**软件编译一次，用了很多**

至于使编译器更快，这取决于正在编译的语言的语义以及分析的繁重工作。您可以编写一个非常快的 C 编译器，但代码可能不是最优的，因此运行速度会变慢并且内存占用会更大。考虑到软件只编译一次并经常运行，我宁愿软件多花 1 个小时来编译，但以后可以节省我的时间。但这并不重要，因为我们有二进制分布。

* * *

## 回答 #3

> 赞同：2
> 
>             
> 
> 时间：2009-05-24T17:19:58.283

[gentoo Linux 发行版](http://www.gentoo.org/)就是这样做的。我们已经接近分发源代码而不是二进制文件变得更便宜的地步了。目前，有几个问题需要解决：

1.  首先，您需要一个编译器。这总是必须以二进制形式提供，因此 100% 的源系统将永远无法工作。但这是一个次要问题，真的。

2.  即使在今天，编译也很慢。编译器越来越好，CPU 越来越快，并且`make`允许并行编译代码之类的工具。但它仍然比将文件从安装介质复制到磁盘要慢。慢了很多。

3.  现代语言（又名脚本语言）通常即时编译。这以运行时速度为代价解决了这个问题。但他们正在变得更好。再过几年，他们就会赶上。最后，您可以在脚本语言中运行多少优化只是 CPU 能力的限制。

4.  公司不想分发源代码。

5.  要从源代码编译某些东西，你需要它所依赖的所有东西，所以你也需要编译它们，即使你并不真的需要它们。想象一个图像处理程序。它可以读取许多不同的文件格式。在开始安装程序本身之前，您真的想为每种奇异的图像格式编译所有库吗？

OSS 解决了问题 #3。gentoo 解决了#4。现在，我们只是停留在#2，真的。今天的 CPU 太慢了，无法从源代码运行游戏或 MS Office 之类的东西。

* * *

## 回答 #4

> 赞同：1
> 
>             
> 
> 时间：2009-05-24T13:00:41.260

阅读您的问题时会想到三件事：

1.  动态链接与二进制分发无关。

2.  如果您希望编译尽可能快，您就不能在编译时使用良好的优化。（即，要制作一个快速编译器，删除所有优化）

3.  JIT 编译器似乎能够在执行速度和编译速度之间取得很好的折衷，但它们运行的​​代码是以二进制形式部署和分发的，因为仍有一些优化可以在第一次编译时运行（最昂贵的），并且因为您真的不想在每台计算机上都有一个完整的工具链来分发源代码。

* * *

## 回答 #5

> 赞同：1
> 
>             
> 
> 时间：2009-05-24T13:02:30.227

动态链接还允许在运行时发现已安装的组件，这至少在两种情况下很有用：

1.  应用程序支持在产品的给定安装中可能存在或不存在的许可功能。

2.  应用程序支持插件架构，第三方可以为其创建组件。

* * *

## 回答 #6

> 赞同：0
> 
>             
> 
> 时间：2009-05-24T13:09:31.040

当使用单个二进制目标重新编译项目时，通常只有自上次编译以来更改的文件在链接之前重新编译，因此具有单独的二进制目标应该会改善整体编译时间，但只会略微改善。

* * *

## 回答 #7

> 赞同：0
> 
>             
> 
> 时间：2009-05-24T17:22:03.163

这取决于您正在构建的项目类型。

一些等待输入比计算多 100 倍的文字编辑器不需要二进制，但实时游戏肯定需要最后一点速度，尤其是那些有 AI 玩家的游戏。

And there are more cases: operating systems, graphics editors (you don't want to wait 5 min for an effect to be processed), simulators, research things. So most of the interesting things that can be made with a computer need speed at runtime and not so much compile time speed.

# django - django 事件应用程序哪个更好？

> ID：903720
> 
>         
> 
> 赞同：12
> 
>         
> 
> 时间：2009-05-24T12:58:07.147
> 
>         
> 
> 标签：django, calendar, scheduling

我一直在看[django-swingtime](http://code.google.com/p/django-swingtime/)、[django-schedule](http://thauber.com/blog/post/django-schedule/)和[django-agenda](http://github.com/dokterbob/django-agenda)。

有哪些更容易使用的建议，如果有的话，有什么实用的代码示例吗？在相应的项目中找不到有用的文档或示例。

我的要求是有许多事件并跟踪它们的发生，但这些事件是自定义的东西，例如，一个项目管理系统，其中定期花费在每个项目上的时间，其中一个事件是一项任务，而事件是定期花在每项任务上的时间。

* * *

## 回答 #1

> 赞同：13
> 
>             
> 
> 时间：2011-06-06T08:07:00.897

我不知道你是否已经检查过 django-packages 但它有一个关于这些的小网格：http: [//www.djangopackages.com/grids/g/calendar/](http://www.djangopackages.com/grids/g/calendar/)

* * *

## 回答 #2

> 赞同：3
> 
>             
> 
> 时间：2009-05-25T07:23:40.433

如果您的要求只是在数据库中的某些数据上显示日历，那么我建议在 python2.5 中使用易于使用的内置 HTMLcalendar。

您可以在
[http://journal.uggedal.com/creating-a-flexible-monthly-calendar-in-django找到更多详细信息](http://journal.uggedal.com/creating-a-flexible-monthly-calendar-in-django)

* * *

## 回答 #3

> 赞同：0
> 
>             
> 
> 时间：2016-06-07T08:29:17.477

基于@Maccesch 的回答并考虑到我是 Django 的初学者，我只能让 Django Happenings 工作：[https](https://github.com/wreckage/django-happenings) ://github.com/wreckage/django-happenings  我希望这个项目将继续存在.

# javascript - 如何从html中获取选定的标签? 获取输入选择的选定值的 HTML Javascript 问题我可以使用 <select id="gender" name="gender" class="style12"> <option selected="selected">ALL</option> <option>仅限男性</option> <option>仅限女性</option> </select>

> ID：903741
> 
>         
> 
> 赞同：37
> 
>         
> 
> 时间：2009-05-24T13:14:40.810
> 
>         
> 
> 标签：javascript, html

* * *

## 回答 #1

> 赞同：64
> 
>             
> 
> 时间：2009-05-24T13:18:07.637

```
var el = document.getElementById('gender');
var text = el.options[el.selectedIndex].innerHTML; 
```

* * *

## 回答 #2

> 赞同：17
> 
>             
> 
> 时间：2012-08-06T08:26:29.747

建议的 jQuery 版本：

```
jQuery("#gender").find("option[value='" + jQuery("#gender").val() + "']").text() 
```

* * *

## 回答 #3

> 赞同：5
> 
>             
> 
> 时间：2009-05-24T13:19:38.803

这应该有效：

```
var label = document.getElementById('gender')[document.getElementById('gender').selectedIndex].innerHTML; 
```

# winforms - 是否有可以从 .Net WinForms 应用程序中动态生成 DAL 的 ORM？

> ID：903742
> 
>         
> 
> 赞同：0
> 
>         
> 
> 时间：2009-05-24T13:15:01.840
> 
>         
> 
> 标签：winforms, orm, code-generation

我非常感谢您对奇怪规范的建议。  

我们需要创建一个应用程序，用户可以将字段类型拖放到表单上，以便他们可以创建自己的“应用程序”。我有前端设置，但后端是个大问题。

有正向映射 ORM 和反向映射 ORM，但我还没有找到一个可以嵌入到应用程序中并在用户启动应用程序时生成表、关系等。当然，如果表、字段或其他实体已经存在，它不会覆盖它们（并覆盖底层数据）。  

ActiveRecord 是我找到的最接近的，但它是基于 Web 的，并没有扩展到 WinForm 环境。我不希望我们的工作人员编写我们自己的 DAL，调试它等等，因为那里可能有一个 ORM 可以做到这一点。  

有谁知道可以做到这一点的ORM？如果没有，你将如何解决这个正在酝酿的噩梦？  

非常感谢你的帮助。

* * *

## 回答 #1

> 赞同：0
> 
>             
> 
> 时间：2009-05-24T13:50:21.783

这是一个不幸的应用程序——如果您的用户想要这样做，他们只会购买 Visual Studio！

这不是一个好位置，因为不，我不知道有什么合适的方法可以用 ORM 做到这一点。可悲的是，如果您因为进度压力而寻找这个，您的项目可能会遇到麻烦。

* * *

## 回答 #2

> 赞同：0
> 
>             
> 
> 时间：2009-05-24T13:23:02.683

虽然你可以想出一个用 ORM 构建的解决这个问题的方法，但我认为这不是一个好主意：这些工具旨在解决另一类问题。唯一的方法是自己构建应用程序。

* * *

## 回答 #3

> 赞同：0
> 
>             
> 
> 时间：2009-05-25T13:25:40.703

理论上你可以使用任何可以自动生成数据库模式的 ORM。例如参见 DataObjects.Net，它通常基于持久类和其他自定义定义使用持久模型生成和升级数据库模式。但是我很难想象在这种情况下你的整个应用程序将如何工作......有很多潜在的问题。

# php - SimpleTest 模拟问题

> ID：903743
> 
>         
> 
> 赞同：1
> 
>         
> 
> 时间：2009-05-24T13:15:15.070
> 
>         
> 
> 标签：php, testing, simpletest

我正在编写一些测试用例，并且我有一个使用 Mock 对象的测试用例。我需要检查是否从另一个类方法调用了两个类方法。这是我所做的：

首先，我生成了 Mock：

```
Mock::generate('Parser'); 
```

然后，在我的测试中，我调用了：

```
$P = new MockParser();

$P->expectOnce('loadUrl', array('http://url'));
$P->expectOnce('parse');

$P->fetchAndParse('http://url'); 
```

我的实现代码如下所示：

```
public function fetchAndParse($url) {
    $this->loadUrl($url);
    $this->parse();
} 
```

并且 loadUrl 和 parse() 方法肯定存在。我的测试失败了两次，都告诉我“[loadUrl] 的预期调用计数是 [1] 得到 [0]”。我不知道发生了什么 - 正在从该函数调用方法！

谢谢，

杰米

* * *

## 回答 #1

> 赞同：4
> 
>             
> 
> 时间：2009-05-24T13:33:37.730

虽然我的经验是在 .NET 世界中使用模拟框架，但我认为您尝试做的事情是不正确的。

当被要求为一个类创建一个模拟时，任何模拟框架都会为该类中的所有方法生成“存根”。这包括方法 fetchAndParse。因此，当您在模拟对象 $P 上调用 fetchAndParse 时，不会调用方法 loadUrl 和 parse。您真正在做的是调用“存根” fetchAndParse 方法。

我在 PHP 方面并没有真正的经验，所以我不想尝试修复您的测试。希望其他人可以做到这一点。

* * *

## 回答 #2

> 赞同：1
> 
>             
> 
> 时间：2012-03-14T02:22:15.040

您误解了模拟的工作原理。如果你使用依赖注入在你的类中设置一个辅助对象，那么你可以模拟你注入的对象。之后，您可以模拟原始对象的行为（界面）。更好的方法是模拟接口，因为您可以在不创建任何实现当前接口的类的情况下进行开发。

以你的例子：

```
interface UrlLoaderInterface {

    public function load($url);
}

class YourParser {

    protected $urlLoader;
    protected $source;

    public function setUrlLoader(UrlLoaderInterface $urlLoader) {
        $this->urlLoader = $urlLoader;
    }

    public function fetchAndParse($url) {
        $this->loadUrl($url);
        $this->parse();
    }

    public function loadUrl($url) {
        $this->source = $this->urlLoader->load($url);
    }

    public function parse() {

    }

}

Mock::generate('UrlLoaderInterface', 'MockUrlLoader');

class TestYourParser extends UnitTestCase {

    public function testShouldCallUrlLoaderByFetchAndParse() {
        $testUrl = 'http://url';

        $urlLoader = new MockUrlLoader();
        $urlLoader->expectOnce('load', array($testUrl));
        $urlLoader->returns('load', 'source', array($testUrl));

        $parser = new YourParser();
        $parser->setUrlLoader($urlLoader);
        $parser->fetchAndParse($testUrl);
    }

} 
```

顺便提一句。你的例子是失败的，因为方法名称不能包含像'and'，'or'，'if'等词......一个方法只允许做一件事。如果您使用这些词，那么您可以确定您的代码设计不佳。

# web-crawler - 如何下载谷歌搜索结果？

> ID：903747
> 
>         
> 
> 赞同：1
> 
>         
> 
> 时间：2009-05-24T13:17:48.107
> 
>         
> 
> 标签：web-crawler

抱歉，如果这是一个太无知的问题或以前曾被问过。粗略一看，并没有找到任何与此完全匹配的东西。问题是：如何下载 Google 已索引的所有 Word 文档？手工完成确实是一项艰巨的任务......感谢所有指示。

* * *

## 回答 #1

> 赞同：2
> 
>             
> 
> 时间：2009-05-24T14:32:03.120

恐怕，没有合法的方法可以做到这一点。以前 Google 为他们的网络搜索提供了一个 SOAP API，但[它已被弃用，并将于今年夏天关闭](http://googleajaxsearchapi.blogspot.com/2009/03/google-code-labs-and-soap-search-api.html)。它每天有 1000 个查询的限制。

目前谷歌提供了一个[Ajax 搜索 API](http://code.google.com/apis/ajaxsearch/)，但它没有为您提供解决方案，因为最大的结果集包含 8 个结果。

最后，[google.com](http://www.google.com)上的标准网络表单禁止以编程方式查询。（还有一个限制，谷歌只返回前一千个结果，你不能看到更多。）

如果您想在此基础上构建服务，可以联系 Google 并与他们建立合作伙伴关系。

# video - openCV cvCreateVideoWriter 总是返回 null

> ID：903753
> 
>         
> 
> 赞同：1
> 
>         
> 
> 时间：2009-05-24T13:22:40.717
> 
>         
> 
> 标签：video, opencv, avi

我正在尝试在 Mandriva Linux 2009.1 下使用 openCV 保存视频文件。不幸的是 cvCreateVideoWriter 总是返回 null 尽管我可以看到和修改 mpeg 文件，换句话说 cvCaptureFromCam、cvCaptureFromAvi、cvRetrieveFrame 正在工作。

我尝试了本[教程](http://www.cs.iit.edu/~agam/cs512/lect-notes/opencv-intro/opencv-intro.html)和此编解码器[页面](http://opencv.willowgarage.com/wiki/VideoCodecs)中所有可能的编解码器。我还尝试将 0 用于未压缩的 avi，将 -1 用于fourcc 参数中的选择框，但没有弹出任何选择，也没有任何反应。我还将 isColor 修改为 0。

我在工作目录中也有写权限。

这是相关的代码片段：

```
 CvVideoWriter *writer = 0;
    int isColor = 1;
    int fps = 25;
    int frameW = 640;
    int frameH = 480;

    if( argc == 1 || (argc == 2 && strlen(argv[1]) == 1 && isdigit(argv[1][0])))
        capture = cvCaptureFromCAM( argc == 2 ? argv[1][0] - '0' : 0 );
    else if( argc == 2 ) {
        printf("argc == 2 :%s:\n", argv[1] );
        capture = cvCaptureFromFile( argv[1] );
    }

    cvInitSystem(argc,argv);

 writer = cvCreateVideoWriter("out.avi",CV_FOURCC('I','Y','U','V'),fps,cvSize(frameW,frameH),isColor); 
```

可能是什么问题呢？

* * *

## 回答 #1

> 赞同：1
> 
>             
> 
> 时间：2009-05-24T14:53:23.983

这将取决于您的 OpenCV 库是如何配置的。特别是我认为`HAVE_FFMPEG`必须定义才能处理“IYUV”FOURCC 值。你的库是用`HAVE_FFMPEG`定义的吗？

默认 writer 对象（在fourcc 为零时创建，或者fourcc 值未被可用的处理程序之一处理）每帧创建一个图像文件。在这种情况下，文件名需要类似于“file%04d.foo”或“file0001.foo”，否则编写器创建失败。您可以尝试为文件名参数传递类似“test0001.png”的内容作为实验，以验证默认图像编写器是否已成功创建（这不会直接帮助，但可能是确认您的fourcc值不是由可用的作家识别。）

根据文档，当fourcc等于-1时打开选择对话框的选项是Windows特定的。

* * *

## 回答 #2

> 赞同：1
> 
>             
> 
> 时间：2012-06-29T11:28:32.373

我阅读了您的帖子、Lance 的回复和您对它的评论，然后终于为自己找到了解决方法，并决定为每个在这个问题上苦苦挣扎的人添加一些注释。

首先要检查的是 CMake 是否使用 FFmpeg 构建了 OpenCV。我快速而可怕的方法就是`cmake`使用标志和参数运行，就像你在安装过程中编写的那样。在输出的最后会有关于将安装哪些组件的日志。如果您的参数复制了实际安装期间使用的参数，您将获得有关*已*安装内容的信息。

接下来，您可能想要检查 linux 系统上编解码器的可用编码器和解码器。我通过使用`ffmpeg -codecs`.

第三个注释是为 设置的可靠和原始参数`cvCreateVideoWriter`：

> “a0000.png”，0，fps，大小，0

`fps`这里是分别包含 fps和`size`frame_size 字段值的变量。你会得到很多图片——Lance Richardson 和 rics 已经注意到了。

最后，对于使用 FFmpeg 构建 OpenCV 并安装 XVID 编码器的系统，我将这些参数插入`cvCreateVideoWriter`：

> "/home/me/openCVOut/a.avi", CV_FOURCC('X','V','I','D'), fps, 大小

最后得到我想要的。

希望我的回答有点用！

# c# - 使用 Linq 在 NHibernate 中检索对象和子集合

> ID：903756
> 
>         
> 
> 赞同：1
> 
>         
> 
> 时间：2009-05-24T13:23:09.127
> 
>         
> 
> 标签：c#, linq, nhibernate, linq-to-nhibernate

我在使用 Linq to NHibernate 加载对象并急切加载子集合时遇到问题。对象如下所示：

```
public class Order
{
    public Guid Id {get; set; }
    public IList<OrderLine> OrderLines {get;set;}
}
public class OrderLine
{
    public Guid Id {get;set;}
    public string Item {get;set;}
} 
```

我正在尝试使用 Linq 加载具有特定 ID 和（急切地）所有子 OrderLines 的订单。我的查询如下所示：

```
using (var s = _sessionFactory.OpenSession())
using (var tx = s.BeginTransaction())
{
    var order = from o in s.Linq<Order>().Expand("OrderLines")
                where o.Id == id
                select o;
    return order.First();
} 
```

但是，当我显示订单时，该`OrderLines`属性只包含一个对象——数据库肯定有 3 个。奇怪的是，如果我在返回之前执行一次 foreach，`order`我确实得到了所有 3 个子项——但这会命中数据库两次。

我已经尝试修改查询以使用`Single()`，但这也不起作用。

我对 linq 做错了吗？还是我的用法`Expand`不正确？

在此先感谢，

西蒙。

注意：我使用 FluentNHibernate Automapping 来创建我的 NH Mapping，我的数据库是一个 Sqlite 数据库（一个文件，不在内存中）。

* * *

## 回答 #1

> 赞同：2
> 
>             
> 
> 时间：2009-05-24T13:42:58.150

看来这个功能有一个bug：

[FirstOrDefault() 打破 FetchType=join 与 Linq 到 NHibernate](https://stackoverflow.com/questions/880061/firstordefault-breaks-fetchtypejoin-with-linq-to-nhibernate)

看一下生成的数据库查询，如果它有 TOP 1 子句，这可能是问题所在。

请记住，Linq to NHibernate 还远未准备好生产，因此可能会出现这种错误。

# java - java - 如何在java NIO中创建不同的选择器以接受新连接

> ID：903757
> 
>         
> 
> 赞同：0
> 
>         
> 
> 时间：2009-05-24T13:23:16.240
> 
>         
> 
> 标签：java, nio

我想使用 java NIO 编写 java tcp socket 编程。它工作正常。但是我使用相同的选择器来接受客户端的读取和写入。

如何创建不同的选择器来接受 java NIO 中的新连接、读取和写入。有没有在线帮助。

实际上，当我忙于阅读或编写时，我的选择器会使用更多迭代器。因此，如果连接的客户端数量更多，那么接受新连接的性能就会变慢。但我不希望接受客户变慢

// 创建一个选择器并注册两个套接字通道 Selector selector = null; try { // 创建选择器 selector = Selector.open();

```
 // Create two non-blocking sockets. This method is implemented in
    // e173 Creating a Non-Blocking Socket.
    SocketChannel sChannel1 = createSocketChannel("hostname.com", 80);
    SocketChannel sChannel2 = createSocketChannel("hostname.com", 80);

    // Register the channel with selector, listening for all events
    sChannel1.register(selector, sChannel1.validOps());
    sChannel2.register(selector, sChannel1.validOps());
} catch (IOException e) {
}

// Wait for events
while (true) {
    try {
        // Wait for an event
        selector.select();
    } catch (IOException e) {
        // Handle error with selector
        break;
    }

    // Get list of selection keys with pending events
    Iterator it = selector.selectedKeys().iterator();

    // Process each key at a time
    while (it.hasNext()) {
        // Get the selection key
        SelectionKey selKey = (SelectionKey)it.next();

        // Remove it from the list to indicate that it is being processed
        it.remove();

        try {
            processSelectionKey(selKey);
        } catch (IOException e) {
            // Handle error with channel and unregister
            selKey.cancel();
        }
    }
}

public void processSelectionKey(SelectionKey selKey) throws IOException {
    // Since the ready operations are cumulative,
    // need to check readiness for each operation
    if (selKey.isValid() && selKey.isConnectable()) {
        // Get channel with connection request
        SocketChannel sChannel = (SocketChannel)selKey.channel();

        boolean success = sChannel.finishConnect();
        if (!success) {
            // An error occurred; handle it

            // Unregister the channel with this selector
            selKey.cancel();
        }
    }
    if (selKey.isValid() && selKey.isReadable()) {
        // Get channel with bytes to read
        SocketChannel sChannel = (SocketChannel)selKey.channel();

        // See e174 Reading from a SocketChannel
    }
    if (selKey.isValid() && selKey.isWritable()) {
        // Get channel that's ready for more bytes
        SocketChannel sChannel = (SocketChannel)selKey.channel();
        }
} 
```

谢谢迪帕克

* * *

## 回答 #1

> 赞同：0
> 
>             
> 
> 时间：2009-05-24T13:43:57.007

有很多[在线帮助](http://java.sun.com/javase/6/docs/api/)。

如果您想创建一个新的选择器，请继续创建另一个（与您复制的示例代码中的操作相同）。如果需要，您可以使用它为连接操作注册通道（文档涵盖了这一点，但操作是 OP_ACCEPT）。您可能需要一个线程池来处理客户端处理的工作 - 这样您的主线程可以将工作项排队并立即重新接受侦听套接字上的新连接。

* * *

## 回答 #2

> 赞同：0
> 
>             
> 
> 时间：2009-05-24T14:15:29.893

每个选择器都需要自己的线程。

*如果你想要多个*选择器，为什么不使用阻塞 NIO，那会简单得多。非阻塞 IO 仅在您想要连接以共享线程时才有意义。

# java - 用于基于图块的游戏的 Java 2D 游戏引擎

> ID：903760
> 
>         
> 
> 赞同：11
> 
>         
> 
> 时间：2009-05-24T13:25:51.943
> 
>         
> 
> 标签：java, frameworks, 2d

谁能推荐一个好的Java游戏引擎来开发简单的基于瓷砖的游戏？我正在寻找一个引擎，它允许我使用 Tiled www.mapeditor.org 之类的东西来构建地图

Slick 正是我正在寻找的东西，slick.cokeandcode.com，但我无法让它在 Vista-64 上运行。我能做到的最好的是：无法在 AMD 64 位平台上加载 IA 32 位 .dll（在下载最新的 LWJGL 版本之后）。  

谁能建议类似的东西可以在 64 位 vista 上运行？

* * *

## 回答 #1

> 赞同：4
> 
>             
> 
> 时间：2009-05-24T15:41:24.040

我建议购买 David Brackeen 的“用 Java 开发游戏”一书，它包含一个基于 tile 的游戏框架，看起来很棒（不过我还没有用它实现任何东西）。

[链接到亚马逊](https://rads.stackoverflow.com/amzn/click/com/1592730051)

你也可以在不买书的情况下下载代码，但我推荐这本书。

* * *

## 回答 #2

> 赞同：3
> 
>             
> 
> 时间：2009-05-24T14:28:22.830

结帐这个[http://www.interactivepulp.com/pulpcore/](http://www.interactivepulp.com/pulpcore/)

* * *

## 回答 #3

> 赞同：3
> 
>             
> 
> 时间：2010-06-27T10:22:38.890

[PulpCore](http://www.interactivepulp.com/pulpcore/)非常酷，支持平铺，但使用软件渲染器，不能作为桌面应用程序运行。它的开发范式与 Flash 非常非常相似，除了它具有 Java 的优点 ;)。

[Slick](http://slick.cokeandcode.com/)还支持平铺，是硬件加速的（通过 LWJGL 的 OpenGL），并且可以作为小程序、桌面或 webstart (JNLP) 运行，但在易于编码方面，它不如 Pulpcore 干净。

如果你需要严肃的屏幕动作（如动作/街机），那就去 Slick，否则我推荐 PulpCore。如果我的游戏不需要硬件支持，我马上就会使用 PulpCore。

* * *

## 回答 #4

> 赞同：2
> 
>             
> 
> 时间：2009-11-16T11:31:48.027

我不了解 Java 游戏引擎，但是您的*“无法在 AMD 64 位平台上加载 IA 32 位 .dll”*问题可以通过卸载 64 位版本的 Java 并安装 32-位版本。（有可能同时运行 32 位和 64 位版本，但如果您不进行 64 位编程，那么您最好只坚持一个版本）。

32 位版本是“Windows”版本，而不是“Windows x64”版本。请注意，32 位版本的 Java 将存在于*Program Files (x86)*而不是*Program Files* - 如果您已经配置了 Slick 和/或 IDE，您可能需要更新一些路径。

* * *

## 回答 #5

> 赞同：2
> 
>             
> 
> 时间：2012-02-05T20:55:41.600

只是为了解决您的次要问题，您可以在 64 位架构上运行 Slick，而无需卸载 64 位 java...

您需要做的就是获取最新的[LWGJL jar](http://lwjgl.org/download.php)文件并将其导入到您的项目中。然后，您需要从 LWGJL jar 加载原生库（包括 win64 dll）。这将允许您在 Win64 中运行 Slick2D 而不会弄乱您的 Java 版本。

* * *

## 回答 #6

> 赞同：2
> 
>             
> 
> 时间：2012-07-30T08:34:29.140

有 Slick、JGame、GLib（非常新，相当有缺陷）和 XNA（C#，类似于 Java）。任你选。

-Slick: [http://goo.gl/CXsp](http://goo.gl/CXsp)

-JGame: [http://goo.gl/Kdjrj](http://goo.gl/Kdjrj)

-GLib: [http://goo.gl/LGFAw](http://goo.gl/LGFAw)

-XNA: [http://goo.gl/n4X1A](http://goo.gl/n4X1A)

* * *

## 回答 #7

> 赞同：1
> 
>             
> 
> 时间：2015-12-26T15:37:56.743

Libgdx is brilliant and includes support for TMX such as tiled. [https://libgdx.badlogicgames.com/](https://libgdx.badlogicgames.com/)
You can also combine this with box2d fairly easily.

# ruby-on-rails - 如何从字符串转换为对象属性名称？

> ID：903763
> 
>         
> 
> 赞同：21
> 
>         
> 
> 时间：2009-05-24T13:27:36.043
> 
>         
> 
> 标签：ruby-on-rails, ruby, attributes

我正在尝试将字符串值转换为属于对象的属性的名称。例如，在下面的代码中，我需要将字符串中的所有值`column_array`转换为属性名称。names `"student_identification"`,`"email"`等是我的`Student`表的实际列名。在实际场景中，`column_array`将由用户设置（通过勾选复选框）。并将`new_array`替换为`csv`，因为我希望数据进入 csv 文件。

目前，我真的在以下方面苦苦挣扎：

```
 new_array << r."#{column_array[i]}" 
```

我想`"#{column_array[i]}"`变成属性名，这样我就可以访问数据了。

```
def exp_tst

  @records =  Student.find(:all, :conditions=> session[:selection_scope],
                                 :order => sort_order('laboratory_id'))

  column_array = ["student_identification", "laboratory_id", "email", "current_status"]

  new_array = Array.new()

  @records.each do |r|

    (0..(column_array.size-1)).each do |i|
       new_array << r."#{column_array[i]}"
    end
  end

end 
```

* * *

## 回答 #1

> 赞同：44
> 
>             
> 
> 时间：2009-05-24T13:33:25.470

比方说`column_array[i] = "foo"`，举个例子。

如果要调用该*方法* `r.foo`，请使用`Object#send`：

```
 r.send(column_array[i], arg1, arg2, arg3, ...) 
```

如果要访问`r`的实例变量`@foo`，请使用`Object#instance_variable_get`and `Object#instance_variable_set`：

```
 r.instance_variable_get('@'+column_array[i])
 r.instance_variable_set('@'+column_array[i], new_value) 
```

在这种情况下，我们必须在给定名称前面加上一个`@`印记，因为这是所有实例变量名称的开头所必需的。

`ActiveRecord`由于这是 rails，并且您的模型（我猜`Student`是 的子类）有很多魔法，`ActiveRecord::Base`您可能想要使用前者，因为`ActiveRecord`创建了访问数据库的方法，以及存储在实例中的值变量可能不是您想要或期望的。

我将使用我得到的一些测试数据中的一个示例：

```
% script/console
Loading development environment (Rails 2.3.2)
irb> Customer
#=> Customer(id: integer, date_subscribed: datetime, rental_plan_id: integer, name: string, address: string, phone_number: string, credit_limit: decimal, last_bill_end_date: datetime, balance: decimal)
irb> example_customer = Customer.find(:all)[0]
#=> #<Customer id: 6, date_subscribed: "2007-12-24 05:00:00", rental_plan_id: 3, name: "Evagation Governessy", address: "803 Asbestous St, Uneradicated Stannous MP 37441", phone_number: "(433) 462-3416", credit_limit: #<BigDecimal:191edc0,'0.732E3',4(12)>, last_bill_end_date: "2009-05-15 04:00:00", balance: #<BigDecimal:191e870,'0.743E3',4(12)>>
irb> example_customer.name
#=> "Evagation Governessy"
irb> field = 'name'
#=> "name"
irb> example_customer.instance_variable_get(field)
NameError: `name` is not allowed as an instance variable name
from (irb):8:in `instance_variable_get`
from (irb):8
irb> example_customer.instance_variable_get('@'+field)
#=> nil
irb> example_customer.send(field)
#=> "Evagation Governessy"
irb> example_customer.send(field+'=', "Evagation Governessy Jr.")
#=> "Evagation Governessy Jr."
irb> example_customer.send(field)
#=> "Evagation Governessy Jr."
irb> example_customer.name
#=> "Evagation Governessy Jr." 
```

因此，您可以看到如何`#send(field)`访问记录信息，而尝试访问属性则不会。另外，我们可以`#send(field+'=')`用来改变记录信息。

* * *

## 回答 #2

> 赞同：6
> 
>             
> 
> 时间：2013-10-07T21:20:37.540

看看 instance_eval 方法...

如果你有“属性”并且需要做

```
 object.attribute = 'ololo' 
```

你可以做：

```
object.instance_eval('attribute') = 'ololo' 
```

# eclipse - 如何将 PHP 框架添加到 Eclipse PDT 中的代码完成/辅助，并且可以将框架添加为所有项目的默认框架吗？

> ID：903769
> 
>         
> 
> 赞同：5
> 
>         
> 
> 时间：2009-05-24T13:30:13.870
> 
>         
> 
> 标签：eclipse, eclipse-pdt

如何在 Eclipse PDT 中添加 PHP 框架来代码辅助/完成？

是否可以将该框架添加为所有项目的默认框架？

* * *

## 回答 #1

> 赞同：10
> 
>             
> 
> 时间：2009-05-24T13:41:13.347

一般来说，在 Eclipse 中，您可以通过以下方式将库或框架添加到代码辅助/完成：

1.  进入项目>属性

2.  在 PHP 包含路径下，选择“库”选项卡。

3.  添加一个带有框架所在路径的“外部文件夹”。

这也可以在项目创建时完成。我不确定以这种方式自动附加库的方法。

该功能本身比这更灵活一些，允许您执行诸如为数据库连接设置变量之类的操作，而不必将冗长的配置文件复制到本地安装。

# memory - 内存 INI 文件编写器

> ID：903770
> 
>         
> 
> 赞同：0
> 
>         
> 
> 时间：2009-05-24T13:30:16.850
> 
>         
> 
> 标签：memory, mfc, security, wizard, ini

我有一个基于向导的 MFC 应用程序。该应用程序向用户询问可变数量的问题，然后将这些问题写入 INI 文件，该文件随后在用户单击完成时被加密。

到目前为止，我看到的所有 INI 文件解析器都可以读取或写入磁盘上的物理文件。我不想这样做，因为 INI 文件包含机密信息。相反，我希望 INI 文件仅基于内存，并且永远不会以未加密的形式写入磁盘。  

由于该应用程序允许用户返回并更改答案，我突然想到我可以为此目的使用内存数据库，但我再次不想将任何内容写入磁盘并且不想在我的应用程序中发送数据库这是可以避免的。

我必须使用 INI 文件，因为未加密的文件将由第 3 方处理。    

欢迎任何建议。

谢谢..

* * *

## 回答 #1

> 赞同：3
> 
>             
> 
> 时间：2009-05-24T14:09:27.940

我有一个 IniFile C++ 类，它允许您使用内存中的 Ini 文件：http:
 [//www.lemonteam.com/downloads/inifile.h](http://www.lemonteam.com/downloads/inifile.h)

这是一个简短的、有据可查的单个 .h 文件。示例用法：

```
IniFile if ( "myinifile.ini" );

if.SetString( "mykey", "myvalue" );

// Nothing gets actually written to disk until you call Flush(), Close() or the object is deleted
if.Flush();
if.Close(); 
```

您应该能够修改 Flush() 方法，以便它对保存的数据应用某种加密。

* * *

## 回答 #2

> 赞同：0
> 
>             
> 
> 时间：2009-05-24T14:11:13.957

听起来像是内存映射文件的一个很好的应用程序，因为您可以控制何时将内存中的视图刷新回磁盘上的文件。

* * *

## 回答 #3

> 赞同：0
> 
>             
> 
> 时间：2009-05-24T14:12:36.123

如果它从不存储到磁盘中，为什么还需要它为 ini 文件格式？

为什么不将它作为数据结构保存在内存中，并在需要时使用普通的 ini 文件方法将其写入磁盘。

* * *

## 回答 #4

> 赞同：0
> 
>             
> 
> 时间：2009-05-24T14:15:53.887

如果您不想保存到文件中，那么使用 INI 文件有什么意义呢？INI API 基本上是一个基于磁盘文件的属性包或键值对。如果你不想使用文件，我建议你使用自己的哈希或字典数据结构来存储键值parirs

# ruby-on-rails - 在 Ruby on Rails 中，map.resources :stories 是否立即使 Story 成为 RESTful？

> ID：903781
> 
>         
> 
> 赞同：1
> 
>         
> 
> 时间：2009-05-24T13:34:26.917
> 
>         
> 
> 标签：ruby-on-rails, rest, url-routing

我正在阅读 Patrick Lenz 的《Simply Rails》……也许我错过了什么，似乎每当我们把

```
map.resources :stories 
```

在路线.rb

那么立即，控制器将有特殊的约定，现在 Story 是一个 RESTful 资源？也许作者使用了资源这个词，但没有提到它是 RESTful 但它们是同一个东西？

* * *

## 回答 #1

> 赞同：4
> 
>             
> 
> 时间：2009-05-24T14:07:34.153

在路由中包含它意味着您会自动获得一些标准路由来帮助您构建一个宁静的应用程序。例如：

```
 new_story GET     /story/new(.:format)  {:action=>"new", :controller=>"stories"}
edit_story GET     /story/edit(.:format) {:action=>"edit", :controller=>"stories"}
     story GET     /story(.:format)      {:action=>"show", :controller=>"stories"}
           PUT     /story(.:format)      {:action=>"update", :controller=>"stories"}
           DELETE  /story(.:format)      {:action=>"destroy", :controller=>"stories"}
           POST    /story(.:format)      {:action=>"create", :controller=>"stories"} 
```

只需在您的路线文件中包含这一行，即可为您提供所有这些使用路径。您只需要确保在新、编辑、显示、更新、销毁和创建您的故事控制器的操作中提供正确的功能，您将拥有一个宁静的设计。

为了查看可用的路由，您可以转到您的应用程序文件夹并给出命令：

```
rake routes 
```

这将根据您在路由文件中输入的内容输出所有可用的路径。

* * *

## 回答 #2

> 赞同：2
> 
>             
> 
> 时间：2009-09-09T02:27:50.123

但！！！如果您的控制器中有其他操作，除非您在 .resources 行上方引入其他路由，否则不会找到它们！

因此，如果您在 stories 控制器中有一个名为 turn_page 的操作，您需要在 map.resources 行之前包含一个 map.connect 行 - 就像在这个片段中一样：

```
map.connect 'stories/turn_page', :controller => 'stories', :action => 'turn_page'
map.resources :stories 
```

希望对某人有所帮助！我在这个问题上工作了好几个小时，因为所有示例都是“常规”路由或通过 .resources 语句定义的 REST 集！

* * *

## 回答 #3

> 赞同：1
> 
>             
> 
> 时间：2009-05-24T14:07:36.290

是的。一旦你将它添加到你的路由中，你的 Story 控制器就会以预期的方式响应常见的 REST 动词。

# c# - 是否有 System.Text.StringBuilder 的二进制等效项？

> ID：903782
> 
>         
> 
> 赞同：11
> 
>         
> 
> 时间：2009-05-24T13:35:39.897
> 
>         
> 
> 标签：c#, .net, binary

我在 C# 中连接大量 byte[] 数组。如果我对字符串执行此操作，我会使用 StringBuilder——是否有一个等效的类可以用于 byte[] 数组中的二进制数据？

* * *

## 回答 #1

> 赞同：22
> 
>             
> 
> 时间：2009-05-24T13:39:25.910

我不认为有一个确切的等价物，但你可以用 BinaryWriter 完成它：

[http://msdn2.microsoft.com/en-us/library/system.io.binarywriter.aspx](http://msdn2.microsoft.com/en-us/library/system.io.binarywriter.aspx)

```
MemoryStream m = new MemoryStream();
BinaryWriter writer = new BinaryWriter(m);
writer.Write(true);
writer.Write("hello");
writer.Write(12345);
writer.Flush();
return m.ToArray(); 
```

* * *

## 回答 #2

> 赞同：1
> 
>             
> 
> 时间：2009-05-24T13:42:10.723

将它们写入 MemoryStream，可能使用 StreamWriter/BinaryWriter。如果字节序是一个问题，[这里](http://www.yoda.arachsys.com/csharp/miscutil/)的一些类可能会有所帮助

# delphi - 变体内容类型的字符串表示？

> ID：903791
> 
>         
> 
> 赞同：6
> 
>         
> 
> 时间：2009-05-24T13:42:56.137
> 
>         
> 
> 标签：delphi, delphi-2009, rtti, typeinfo

首先，为我的英语道歉，我希望我在这里写的东西有意义。现在到我的问题。

如何使用 TypInfo.GetEnumName() 获取 Variant内容**类型的字符串表示形式。**我尝试了以下方法，但没有运气，我得到了一个数字表示。

```
myString := GetEnumName( TypeInfo(TVarType), TVarData(myVar).VType ); 
```

谢谢你。

* * *

## 回答 #1

> 赞同：13
> 
>             
> 
> 时间：2009-05-25T12:01:36.817

只需使用内置的 Delphi 函数来获取 Variant 类型的字符串表示。

```
var
  MyVariantType: string;
  MyVariant: Variant;
begin
  MyVariant := 'Hello World';
  MyVariantType := VarTypeAsText(VarType(MyVariant));
  ShowMessage(MyVariantType); //displays: String

  MyVariant := 2;
  MyVariantType := VarTypeAsText(VarType(MyVariant));
  ShowMessage(MyVariantType); //displays: Byte
end; 
```

* * *

## 回答 #2

> 赞同：3
> 
>             
> 
> 时间：2009-05-24T14:01:46.223

引用 Delphi 2007 帮助：

> 使用 GetEnumName 将 Delphi 枚举值转换为在代码中表示它的符号名称。

这意味着您不能将它用于此目的，因为*TVarData.VType*不是枚举值，而是一个整数，它设置为 System.pas 中从 Windows SDK *wtypes.h*文件中获取的常量之一。查看*GetEnumName()*的来源，它会立即返回一个包含整数值的字符串。

**编辑：**

> 有没有其他方法可以获取 TVarData.VType 的字符串表示形式

您可以手动确定字符串表示。首先，您需要知道在该整数中编码了几位信息，因此简单的 case 语句或数组查找将不起作用。低 12 位是类型掩码，高位编码有关它是向量还是数组类型以及是否通过引用给出的信息。重要的部分是：

```
const
  varTypeMask = $0FFF;
  varArray    = $2000;
  varByRef    = $4000; 
```

因此，您可以执行以下操作：

```
function VariantTypeName(const AValue: TVarData): string;
begin
  case AValue.VType and varTypeMask of
    vtInteger: Result := 'integer';
    // ...
  end;

  if AValue.VType and varArray <> 0 then
    Result := 'array of ' + Result;
  if AValue.VType and varByRef <> 0 then
    Result := Result + ' by ref';
end; 
```

* * *

## 回答 #3

> 赞同：1
> 
>             
> 
> 时间：2009-05-24T16:35:10.227

由于它不是枚举，因此您必须手动进行。写这样的东西：

```
function VariantTypeName(const value: TVarData): string;
begin
  case value.VType of
    vtInteger: result := 'integer';
    //and so on
end; 
```

或者，由于 System.pas 中的值是按顺序列出的，您可以尝试声明一个 const 字符串数组，并让您的 VariantTypeName 函数返回该数组的适当成员。

* * *

## 回答 #4

> 赞同：0
> 
>             
> 
> 时间：2010-01-18T11:04:13.777

这是不支持 VarTypeAsText 的 Delphi 版本的一个想法：您可以自己定义一个遵循 VType 值的枚举类型：

```
type
  {$TYPEINFO ON}
  TMyVarType = (
    varEmpty = System.varEmpty, 
    varNull = System.varNull,
    // etc...
    ); 
```

（也填充未使用的枚举槽 - 请参阅[为什么我会收到带有枚举类型](https://stackoverflow.com/questions/1420562/why-do-i-get-type-has-no-typeinfo-error-with-an-enum-type)的“类型没有类型信息”错误，以了解其背后的原因）。

接下来，使用这些函数将 Variants 的类型读取为您自己的枚举类型：

```
function MyVarType(VType: TVarType): TMyVarType; overload;
begin
  Result := TMyVarType(VType);
end;

function MyVarType(V: Variant): TMyVarType; overload;
begin
  Result := TMyVarType(TVarData(V).VType);
end; 
```

然后你可以把它转换成这样的字符串：

```
function VarTypeToString(aValue: TMyVarType): string;
begin
  Result := GetEnumName(TypeInfo(TMyVarType), Ord(aValue));
end; 
```

# iphone - 将滑动事件授予其他控件

> ID：903794
> 
>         
> 
> 赞同：0
> 
>         
> 
> 时间：2009-05-24T13:43:42.080
> 
>         
> 
> 标签：iphone, cocoa-touch, uiview, uitextview

我在 UIView 之上有一个 UITextView。它们在 PageScrollView 中。用户可以在 UITextView 之外的任何地方滑动并轻扫下一页（视图）。我希望用户在 UITextView 上滑动并轻扫下一个视图。  

当文本过多时，UITextView 会垂直滚动，用户可以滑动并查看其余文本。视图分页水平滚动。我需要 UITextView 将其水平滑动到 UIView。我怎样才能做到这一点？

* * *

## 回答 #1

> 赞同：1
> 
>             
> 
> 时间：2009-05-24T14:07:35.650

如果您继承`UITextView`并覆盖它的每个触摸事件：

*   touchesBegan:withEvent:

*   touchesMoved:withEvent:

*   touchesEnded:withEvent:

*   touchesCancelled:withEvent:

有了这个：

```
- (void) touchesXXX:(NSSet *)touches withEvent:(UIEvent *)event {
    [super touchesXXX:touches withEvent:event];
    [[self nextResponder] touchesXXX:touches withEvent:event];
} 
```

这将允许处理所有的触摸`UITextView`及其父视图。由于您的`UITextView`卷轴仅垂直滚动，而您的`UIScrollView`滚动仅水平滚动，因此效果很好。

# html - 如何使文本在 IE 和 Mozilla 中看起来一样？

> ID：903797
> 
>         
> 
> 赞同：1
> 
>         
> 
> 时间：2009-05-24T13:46:40.433
> 
>         
> 
> 标签：html, internet-explorer

所以，这里有两个问题：

1.  为什么它看起来不同（在 IE 上它更大胆，更抗锯齿）

2.  如何使 Mozilla 渲染看起来像 IE 渲染以及此解决方案有什么影响（我正在寻找最小的更改，因此解决方案，例如 - flash、silverlight 或使用图像是不可能的）

* * *

## 回答 #1

> 赞同：3
> 
>             
> 
> 时间：2009-05-24T14:03:34.723

IE 看起来不同，因为它使用“清除类型”来呈现字体，即使它在 Windows 中未在系统范围内启用。这不是您作为网页服务器可以控制的，而是取决于客户端机器和浏览器。

如果您希望 Firefox 在 Windows 上看起来相似，请转到显示设置 -> 外观 -> 效果 -> “使用以下方法平滑屏幕字体边缘”，然后选择“清除类型”。这应该对 Firefox 应用相同的字体平滑效果。但正如我所说，这取决于最终用户，而不是网页服务器。

[该站点](http://css-tricks.com/font-rendering-differences-firefox-vs-ie-vs-safari/)对不同浏览器上的字体渲染进行了很好的比较。

* * *

## 回答 #2

> 赞同：1
> 
>             
> 
> 时间：2009-05-24T13:49:55.140

除非你能说服微软使用 Mozilla 的渲染引擎，否则你不能这样做。因此，除非您使用“不可能”的解决方案，否则它不会发生。字体渲染不受网页设计师的控制。

* * *

## 回答 #3

> 赞同：1
> 
>             
> 
> 时间：2009-05-24T15:01:20.520

不完全是“最小的变化”，但某些字体和大小看起来比其他字体和大小更好/更一致。我无法说出我脑海中的哪些组合，但我注意到有些字体在 16 像素时比在 15 像素时*更*粗体。尝试一下，您可能会找到可以忍受的东西。或者尝试使用条件注释向 IE 提供不同的字体粗细。

* * *

## 回答 #4

> 赞同：0
> 
>             
> 
> 时间：2009-05-24T14:12:21.023

我知道您提到 Flash 是不可能的，但您是否考虑过[sIFR](http://en.wikipedia.org/wiki/Scalable_Inman_Flash_Replacement)。

对于非 Flash 浏览器，它的降级很好，在支持的浏览器上看起来也一样。

# c# - 在 StructureMap 中，如何在运行时更改 InstanceScope？

> ID：903803
> 
>         
> 
> 赞同：1
> 
>         
> 
> 时间：2009-05-24T13:50:59.927
> 
>         
> 
> 标签：c#, dependency-injection, inversion-of-control, structuremap

在我的 DefaultRegistry 我有这个配置：

```
ForRequestedType<INHUnitOfWork>().CacheBy(InstanceScope.HttpContext)
        .TheDefault.Is.OfConcreteType<NHibernateUnitOfWork>(); 
```

在 Web 应用程序流程的某个时刻，我想将 InstanceScope 更改为 HttpSession 以获得长时间的对话，所以我这样做：

```
PluginTypeConfiguration config = ObjectFactory.Model.PluginTypes.FirstOrDefault(p => p.PluginType.FullName.Contains("INHUnitOfWork"));
config.Lifecycle.EjectAll();
config.Lifecycle = StructureMap.Pipeline.Lifecycles.GetLifecycle(InstanceScope.HttpSession); 
```

这似乎取代了最初的 InstanceScope，不幸的是它只持续当前请求。当下一个请求到达时，初始配置再次处于活动状态，会话信息丢失。

后来我还希望能够通过以下方式恢复更改：

```
PluginTypeConfiguration config = ObjectFactory.Model.PluginTypes.FirstOrDefault(p => p.PluginType.FullName.Contains("INHUnitOfWork"));
config.Lifecycle.EjectAll();
config.Lifecycle = StructureMap.Pipeline.Lifecycles.GetLifecycle(InstanceScope.HttpContext); 
```

但如果我让它在一个方向上工作，它可能会同时在两个方向上工作。

是否可以在运行时永久替换初始 InstanceScope？这应该如何实施？另外，您认为这是获得长时间对话的好方法，还是使用 StructureMap 和 NHibernate 有更好/更简单的方法？

* * *

## 回答 #1

> 赞同：1
> 
>             
> 
> 时间：2009-05-24T14:17:27.160

看看 Ayende 关于如何启用长时间对话和 UnitOfWork 的详细说明：

[http://ayende.com/Wiki/Default.aspx?Page=HttpModules&AspxAutoDetectCookieSupport=1](http://ayende.com/Wiki/Default.aspx?Page=HttpModules)

我建议创建一个 UnitOfWorkApplication 模块，并让它负责创建一个 UnitOfWork 实例并将其添加到容器中，然后再执行代码（在处理请求之前，如示例中所示）。通过这种方式，您可以更灵活地控制工作单元的创建方式。

* * *

## 回答 #2

> 赞同：0
> 
>             
> 
> 时间：2009-05-24T17:01:09.150

你想做什么对我来说听起来有点奇怪。我会尝试的路线是

*   在 StructureMap 中配置一个命名实例，该实例也实现了所述接口，但范围不同。您可以为不同的接口使用者注入不同的依赖项，也许这有帮助？

*   编写您自己的 CacheInterceptor 来有效地实现您的特定生命周期。

后者在例如 WCF 生命周期中完成：http: [//blogs.rpionline.com/post/2009/02/How-to-use-NHibernate-and-StructureMap-in-a-WCF-application.aspx](http://blogs.rpionline.com/post/2009/02/How-to-use-NHibernate-and-StructureMap-in-a-WCF-application.aspx)

# iphone - 如何通过从屏幕上删除 UIImageViews 来安全地释放内存？

> ID：903808
> 
>         
> 
> 赞同：3
> 
>         
> 
> 时间：2009-05-24T13:55:23.320
> 
>         
> 
> 标签：iphone, cocoa-touch, memory-management, uikit

我有一些嵌套在 UIViews 中的 UIImageViews，它们将它们组合在一起。它们归视图控制器所有。一旦调用 -viewWillDisappear 方法，我想将这些 UIImageViews 连同它们的 UIViews 一起删除，以便释放内存。

我在包含 UIImageViews 作为子视图的 UIViews 上调用 -release。没有其他人拥有 UIImageViews。我所拥有的只是 UIView 的一个实例变量，它将 UIImageViews 组合在一起。

因此，当我向它发送 -release 时，保留计数应该变为 0。但这并不能保证我获得更多可用内存，对吧？所以，我也设置了 myUIView = nil。这有帮助/有用吗？如何安全地释放内存？

* * *

## 回答 #1

> 赞同：3
> 
>             
> 
> 时间：2009-05-24T14:40:57.643

`-viewDidDisappear`在这种情况下（不是`-viewWillDisappear`；您当时仍在屏幕上）最好的做法是调用`self.view = nil`. 这将转储整个视图控制器的视图，下次需要时会自动为您重新加载。

如果您在这些视图上有任何 IBOutlets，您也需要将它们设置为 nil，否则它们将不会释放。假设您有这样的设置：

```
@interface MyViewController : UIViewController
{
   UIImageView *_imageView;
}
@property (readwrite, retain) IBOutlet UIImageView *imageView;

@implementation MyViewController
@synthesize imageView = _imageView; 
```

然后你需要调用`self.imageView = nil`你的`-viewWillDisappear。

`-release`除了访问器和`-dealloc`. 释放它们的正确方法是使用访问器将它们设置为 nil。

当retainCount`-release`为1 时调用会立即调用`free()`，这将恢复内存。但是请记住，其他事物可能会保留对象，包括自动释放池，因此您可能无法确定在任何给定时间保留计数是多少。

我强烈建议人们在释放变量时立即将其设置为零。这不会影响变量；它只是保护您免于追逐已释放的指针，因此现在可能指向未分配的内存。所以在 中`-dealloc`，我的行看起来像这样：

```
[_stuff release]; _stuff = nil;
[_otherStuff release]; _otherStuff = nil; 
```

# icons - 图标资源？

> ID：903814
> 
>         
> 
> 赞同：6
> 
>         
> 
> 时间：2009-05-24T14:00:52.793
> 
>         
> 
> 标签：icons

小伙子们不是技术问题，但我一直在为我正在处理的房间预订事情寻找一组图标。网络上有大量的图标资源，但是有没有合适的地方去购买一些任何人都可以推荐的优质免费图标？

* * *

## 回答 #1

> 赞同：5
> 
>             
> 
> 时间：2009-05-24T14:18:41.260

当我在寻找一些小的时，我通常会去[IconArchive](http://www.iconarchive.com/)或[famfamfam 。](http://www.famfamfam.com/)这两个网站都有大量免费使用的图标集。

* * *

## 回答 #2

> 赞同：4
> 
>             
> 
> 时间：2011-04-20T16:12:42.650

我通常使用众所周知的可重复使用的图标集，或定制的搜索引擎来查找特定的图标（最好是它们所属的整个图标集及其许可证）

# 图标集

*   亲亲

*   赋格

*   釉

*   探戈

*   打开图标库

*   ...

# 搜索引擎

*   [http://images.google.com ](http://images.google.com) *（总是很方便，如果需要，可以设置“图标”和“商业重用”）*

*   [http://www.iconfinder.com/ ](http://www.iconfinder.com/) *（非常好，有直接链接到集合和作者主页）*

*   [http://www.iconarchive.com/ ](http://www.iconarchive.com/) *（也不错）*

*   [http://www.findicons.com/ ](http://www.findicons.com/) *（不太好，但值得一试）*

* * *

## 回答 #3

> 赞同：2
> 
>             
> 
> 时间：2009-05-24T14:09:01.187

最简单的方法是使用谷歌搜索一些相关术语，例如“没有狗”或“有线电视”。你明白了。

然后只需获取与您的主题相关的所有图标。

* * *

## 回答 #4

> 赞同：1
> 
>             
> 
> 时间：2009-05-24T14:42:49.883

我喜欢[Smashing Magazine](http://www.smashingmagazine.com)作为图标资源。他们有文章链接到图标的高质量资源，例如这个[图标集](http://www.smashingmagazine.com/2008/05/21/40-professional-icon-sets-for-free-download/)。

* * *

## 回答 #5

> 赞同：0
> 
>             
> 
> 时间：2009-05-24T14:13:01.723

搜索知识共享图标集，这些可以免费使用并注明出处。

* * *

## 回答 #6

> 赞同：0
> 
>             
> 
> 时间：2013-12-07T10:29:40.173

[Seanau 图标](http://www.seanau.com)s 很棒！

想要免费图标，我推荐[Iconsfind.com](http://www.iconsfind.com)

# vim - 哪个默认设置会使 Vim 在 Mac 的屏幕上运行缓慢？

> ID：903816
> 
>         
> 
> 赞同：3
> 
>         
> 
> 时间：2009-05-24T14:02:46.440
> 
>         
> 
> 标签：vim, gnu-screen

**尽管我接受了一个答案，但问题并没有解决。**

**问题：尽管**[lazyredraw 和showcmd 关闭](http://macvim.org/OSX/index.php#Bugs)，Vim 在Mac 的Screen 中更新屏幕非常缓慢。

* * *

行号在 foldColumn 上如下所示，例如，当我有行号
[alt text http://dl.getdropbox.com/u/175564/vimScreenFold.png](http://dl.getdropbox.com/u/175564/vimScreenFold.png)

当我的 .vimrc 中没有任何内容时，可以通过将注释行叠加在一起看到问题：
 [alt text http://dl.getdropbox.com/u/175564/vimScatteredBug.png](http://dl.getdropbox.com/u/175564/vimScatteredBug.png)

我没有在左侧多次输入以下评论

```
"set list... 
```

**观察**

1.  似乎只出现在[注释行和空行](https://stackoverflow.com/questions/903816/unable-to-get-vim-work-properly-inside-screen/915980#915980)中。然而，我得到的证据[（2）](https://stackoverflow.com/questions/903816/unable-to-get-vim-work-properly-inside-screen/928182#928182)表明情况并非如此。

2.  分散主要发生在左侧窗口中。它们也出现在单个窗口中。然而，它更难用它来检测。

3.  当我在 .vimrc 中没有任何内容时，该错误的发生略有不同。然而，“停滞”发生在两种情况下：空的 .vimrc 和非空的 .vimrc。

**错误识别**

**因变量**

1.  **依赖于[Vim 自动放置的注释符号](https://stackoverflow.com/questions/903816/unable-to-get-vim-work-properly-inside-screen/929638#929638)**。当 Vim 无法显示整个文件时，我注意到当 Vim 将 Python 的注释符号 # 自动添加到我的文件时，像素消失了。

2.  **至少**依赖于OS/X Leopard。****

 ****自变量**

1.  **文件无关**: 出现在 Vim 编辑的所有文件中

2.  **[行无关](https://stackoverflow.com/questions/903816/unable-to-get-vim-work-properly-inside-screen/929638#929638)**：出现在没有注释和空行的 Python 代码中

3.  **.vimrc 独立**：与空 .vimrc 一起发生

4.  **.screenrc 独立**：出现空 .screenrc

5.  **shell 独立**：与 Bash 和 Zsh 一起发生

6.  **[屏幕版本独立](https://stackoverflow.com/questions/903816/unable-to-get-vim-work-properly-inside-screen/928182#928182)**：出现在 Leopard 的默认屏幕和屏幕 4.0.3 中

7.  **独立于不同的注释字符**：向下滚动时发生，例如 .zshrc、.vimrc 和 .screenrc

**如何禁用 Vim 的[默认设置](https://stackoverflow.com/questions/903816/unable-to-disable-vims-default-setting-which-causes-it-upset-in-screen/929638#929638)？**

* * *

## 回答 #1

> 赞同：3
> 
>             
> 
> 时间：2009-05-25T04:50:14.440

我猜问题可能出在您的 termcap 和 terminfo 设置上。尝试从您的 screenrc 中将它们注释掉，然后重新启动屏幕。

另外，您使用的是什么（非虚拟）终端？

啊，[看起来](http://dl.getdropbox.com/u/175564/terminalMode.png)你正在使用 OSX 的 Terminal.app，这正是我使用的（带有`screen/zsh/vim`）。  默认情况下`/usr/bin/screen`应该与`/usr/bin/vim`空`.screenrc`一起使用。`.vimrc`

```
% touch empty_screenrc
% cat empty_screerc
% /usr/bin/screen -c empty_screenrc
#...and within screen
% /usr/bin/vim -u NONE 
```

如果问题仍然存在，则问题可能出在您的 shell 中。但是，如果这可以解决问题，我建议您发布`~/.vimrc`以帮助进一步诊断。

* * *

## 回答 #2

> 赞同：2
> 
>             
> 
> 时间：2009-05-27T14:21:05.663

我没有插件，.vimrc 和 .screenrc 中也没有任何内容。问题仍然存在。

**错误识别**

1.  **文件无关**: 出现在 Vim 编辑的所有文件中

“停滞”似乎主要发生在注释行和空行中。但是，该错误也发生在没有注释和空行的情况下，但它的影响似乎要小得多。

**观察图片 2**
[替代文字 http://dl.getdropbox.com/u/175564/cruxMoveInVimScattered.png](http://dl.getdropbox.com/u/175564/cruxMoveInVimScattered.png)

* * *

## 回答 #3

> 赞同：2
> 
>             
> 
> 时间：2009-05-29T21:13:01.123

我认为 OS X 默认版本的屏幕不支持 256 色。您可以将 vim 设置为在 .vimrc 文件中使用较少数量的颜色：

```
set t_Co=16 
```

在 Mac OS X 上，您可以重建屏幕以使用 256 色，请参见此处： http: [//pjkh.com/articles/2008/07/09/osx-iterm-screen-vim-256-colors](http://pjkh.com/articles/2008/07/09/osx-iterm-screen-vim-256-colors)。

这是说明的简短版本：

重建屏幕确保包括 256 色选项：

```
./configure --enable-colors256 
```

然后您需要将以下内容添加到您的 ~/.screenrc：

```
# terminfo and termcap for nice 256 color terminal
# allow bold colors - necessary for some reason
attrcolor b ".I"
# tell screen how to set colors. AB = background, AF=foreground
termcapinfo xterm 'Co#256:AB=\E[48;5;%dm:AF=\E[38;5;%dm'
# erase background with current bg color
defbce "on" 
```

[来源](http://frexx.de/xterm-256-notes/)

* * *

## 回答 #4

> 赞同：2
> 
>             
> 
> 时间：2011-01-21T03:45:47.000

我遇到了这个问题（只是非常缓慢），它最终成为了我在 Terminal.App 和 ITerm 中使用的 Consolas 字体。在我的情况下，切换到摩纳哥大大加快了速度。

* * *

## 回答 #5

> 赞同：1
> 
>             
> 
> 时间：2009-05-30T12:08:07.630

**症结之举：**这个bug的出现似乎是因为Vim的一些默认选项导致了这个问题

我现在在 .vimrc 和 .screenrc 中使用我的默认配置，因为我观察到它们不会导致错误。

该错误似乎与**注释和空行**有关。我得到了它的证据。

我的 Python 代码中没有注释，也没有空行。但是，我注意到当 Vim 无法显示完整的行时，它会在我的代码中添加注释标记。例如，注意 Vim 放在那里的三个 # 标记。

这导致了消失的像素。

[替代文字 http://dl.getdropbox.com/u/175564/pythonBug.png](http://dl.getdropbox.com/u/175564/pythonBug.png)

* * *

当我看不到 Vim 自动放置的注释符号时，该错误似乎发生在同一个文件中。

[替代文字 http://dl.getdropbox.com/u/175564/counterExample.png](http://dl.getdropbox.com/u/175564/counterExample.png)

我故意复制了图片的代码，以便您可以清楚地看到消失的像素。

当我在玩 Python 代码时，我注意到在我将一个空行放入代码后，“停滞”发生得很大。但是，我没有设法复制该事件。

* * *

**通过 .vimrc 解决错误的尝试失败**

1.  禁用 Vim 自动设置的注释符号

    设置格式选项-=c

* * *

## 回答 #6

> 赞同：1
> 
>             
> 
> 时间：2009-06-02T19:18:51.523

看起来有一些与 OS X 的换行模式相关的已知问题，请参见第 1[点](http://macvim.org/OSX/index.php#Bugs)。它提出了一种解决方法。

* * *

## 回答 #7

> 赞同：1
> 
>             
> 
> 时间：2009-07-05T18:47:43.330

我在 irssi 和 bash 上遇到过类似的问题，这是由颜色代码未正确关闭引起的。

您是否尝试过不同的 vim 主题（特别是默认主题）或正在运行`:syntax off`？

* * *

## 回答 #8

> 赞同：0
> 
>             
> 
> 时间：2009-06-11T20:03:58.290

**调试：**

有人建议我通过以下方式冻结我的终端免受其他应用程序的更改

```
ttyctl -f 
```

但是，它似乎并没有解决问题。尽管如此，它可能会帮助我们找到错误，因为我们现在没有其他应用程序可以改变这种情况。

# python - 如何判断何时调用了另一个类中的函数

> ID：903818
> 
>         
> 
> 赞同：2
> 
>         
> 
> 时间：2009-05-24T14:03:45.813
> 
>         
> 
> 标签：python, class

我有两个 Python 类，分别称为“C1”和“C2”。C1 内部是一个名为“F1”的函数，C2 内部是一个名为“F2”的函数。有没有办法在每次运行 F1 时执行 F2 而无需从 F1 内直接调用 F2？是否有其他机制可以知道何时调用了另一个类内部的函数？

我欢迎任何建议，但想知道一些方法来实现这一点，而无需在 C1 中创建 C2 的实例。

* * *

## 回答 #1

> 赞同：3
> 
>             
> 
> 时间：2009-05-24T14:37:29.553

您可以编写一个小助手装饰器来为您调用。优点是通过查看代码很容易判断谁将调用什么。您可以根据需要添加任意数量的函数调用。它的工作方式类似于注册回调函数：

```
from functools import wraps

def oncall(call):
    def helper(fun):
        @wraps(fun)
        def wrapper(*args, **kwargs):
            result = fun(*args, **kwargs)
            call()
            return result
        return wrapper
    return helper

class c1:
   @classmethod
   def f1(cls):
      print 'f1'

class c2:
   @classmethod
   @oncall(c1.f1)
   def f2(cls):
      print 'f2'

>>> c2.f2()
f2
f1
>>> c1.f1()
f1 
```

* * *

## 回答 #2

> 赞同：2
> 
>             
> 
> 时间：2009-05-24T14:10:13.540

我相信您正在尝试做的事情将适合[Aspect Oriented Programming](http://en.wikipedia.org/wiki/Aspect-oriented_programming)的领域。但是我从未使用过这种方法，甚至不知道它是否可以/已经在 Python 中实现。

**编辑**我刚刚查看了我提供的链接，发现提到了[8 个 Python 实现](http://en.wikipedia.org/wiki/Aspect-oriented_programming#Implementations)。因此，已经为您完成了艰苦的工作:-)

* * *

## 回答 #3

> 赞同：2
> 
>             
> 
> 时间：2009-05-24T14:20:28.150

从 Python 2.2 开始，您可以使用函数和方法装饰器进行面向方面的编程：

```
@decorator(decorator_args)
def functionToBeDecorated(function_args) :
    pass 
```

* * *

## 回答 #4

> 赞同：2
> 
>             
> 
> 时间：2009-05-24T14:21:31.037

这实际上取决于您为什么不想直接从 F1 中调用 F2。您总是可以创建一个封装 C1 和 C2 的第三个类 (C3)。当调用 F3 时，它将同时调用 F1 和 F2。这被称为中介者模式 - [http://en.wikipedia.org/wiki/Mediator_pattern](http://en.wikipedia.org/wiki/Mediator_pattern)

* * *

## 回答 #5

> 赞同：1
> 
>             
> 
> 时间：2009-05-24T19:25:44.263

不知道您要实现什么目标，我建议您看一下 pydispatcher。它允许您实现观察者模式

基本上，您向调度程序注册 F2 以便在发出特定“信号”时调用它。您的 F1 会“发出一个信号”，上面写着“我已被叫到”。然后调度程序调用 F2（或任何数量的已向该特定信号注册自身的函数）。它实际上比听起来简单，易于使用，并且可以解耦您的代码（F1 不需要了解 F2）。

（啊……我是新用户，不允许包含超链接，但 pydispatcher 很容易用谷歌搜索）

* * *

## 回答 #6

> 赞同：0
> 
>             
> 
> 时间：2009-05-24T14:25:27.033

您可以使用 捕获对 F1 的所有访问`__getattr__`。这将允许您进行额外的处理或返回您自己的函数来代替 F1

```
class C1:
  def __getattr__(self,name):
    if name == 'F1': C2.F2()
    return self[name] 
```

我应该警告您，即使 F1 仅被访问（未运行），这也会调用 C2.F2。出于其他目的（例如`f = myC1.F1`. 要仅在调用 F1 时运行 F2，您需要扩展此示例以将 F2 与返回的函数对象结合起来。换句话说：

```
def F1F2():
   self.F1()
   C2.F2()
return F1F2 
```

# batch-file - 删除最后一次修改不是今天的文件的批处理文件

> ID：903820
> 
>         
> 
> 赞同：1
> 
>         
> 
> 时间：2009-05-24T14:06:52.470
> 
>         
> 
> 标签：batch-file, text-files, delete-file

我只是想知道：

如果上次修改不是今天，我如何删除“log.txt”？

带有批处理文件。

我只是在这里谈论 1 个文件！

* * *

## 回答 #1

> 赞同：2
> 
>             
> 
> 时间：2009-05-24T14:19:38.153

PowerShell 必须替换批处理。

```
if ((dir log.txt).LastWriteTime -lt [datetime]::today) { del log.txt }

```

* * *

## 回答 #2

> 赞同：1
> 
>             
> 
> 时间：2009-05-24T14:38:28.910

不幸的是，您不能以稳健和通用的方式 (*) 执行此操作。

Powershell、Cygwin、Unix 工具是非常好的解决方案，如果您可以确定它们会安装在目标机器上。  

我编写了一个小实用程序，它采用带有通配符和天数的路径，并删除与该路径匹配且早于指定天数的所有文件。在我的环境中，这比安装 3rd 方包更方便。

(*) 只要您的区域设置中的短日期格式包括世纪（即 10 个字符长），以下将适用于您的特定情况（修改日期不是今天）。但这并不能概括N天，而且我不喜欢依靠计算机的区域设置来进行这种事情：

```
for %%i in (log.txt) do SET FILETIME=%%~ti
IF NOT "%FILETIME:~0,10%" == "%DATE%" DEL /f log.txt 
```

* * *

## 回答 #3

> 赞同：1
> 
>             
> 
> 时间：2009-05-24T15:24:57.740

您可以使用[`forfiles`](http://technet.microsoft.com/en-us/library/cc753551.aspx)：

```
forfiles /D -1 /M log.txt /C "cmd /c del @file" 
```

* * *

## 回答 #4

> 赞同：0
> 
>             
> 
> 时间：2009-05-24T14:27:12.723

Batch 使简单的事情变得非常复杂。如果您可以使用 Cygwin 或安装 Unix 工具，请考虑执行以下操作：

```
find log.txt -mtime +1 -exec rm {} \; 
```

**更新**发现使用纯批处理

可能对您[有用的东西。](http://www.computing.net/answers/programming/batch-file-deleting-files-by-date/13717.html)您应该能够修改它并使其适应您的需求。

* * *

## 回答 #5

> 赞同：0
> 
>             
> 
> 时间：2009-05-24T17:59:21.500

对于它的价值，您可以使用 jscript 或 vbscript。自 90 年代中期以来，这两种脚本语言都已安装在 MS 平台上

# visual-studio - 是否有 Visual Studio 项目的主索引？

> ID：903824
> 
>         
> 
> 赞同：0
> 
>         
> 
> 时间：2009-05-24T14:07:55.370
> 
>         
> 
> 标签：visual-studio, templates, projects-and-solutions, tracking

我有许多小的“测试项目”，我将足够的代码放在一起来证明或反驳我正在研究的一些想法。一段时间（有时几个月）后，我需要使用其中的一些代码。搜索名称不佳的文件夹可能需要数小时才能找到我正在寻找的代码宝石。

仅仅值得一个博客或维基条目是不够的。我只想有一些包含描述的东西，可能是屏幕截图和项目的 zip 文件（或指向版本控制的指针）

我在 Visual Studio 中是否缺少用于跟踪项目的功能？是否有可用于根据项目评论等进行搜索的模板？

有没有人遇到过这样的事情？

这个问题要多久才能结束？

* * *

## 回答 #1

> 赞同：1
> 
>             
> 
> 时间：2009-05-24T14:30:34.027

是的，有这样一个功能：它在“新建项目”对话框中，它被称为“名称”。这将允许您给您的项目一个有意义的名称，这将有助于您以后找到它。

有一个从操作系统借来的相关功能，称为“文件夹”。这使您可以对概念上相关的各种项目进行分组，并将它们放在一个“文件夹”中，您可以给该文件夹起一个与概念分组相关的有意义的名称。

这两者的结合将满足您的所有需求。诀窍是避免导致“命名不佳的文件夹”的心态。良好的工作习惯会在未来节省大量的时间，而且想出一个有意义的名字，而不是 TestProject426 真的不需要那么长的时间

* * *

## 回答 #2

> 赞同：0
> 
>             
> 
> 时间：2009-05-24T14:20:40.583

为什么不为此目的使用版本控制系统（如[subversion ）？](http://subversion.tigris.org/)

您可以将您的测试项目置于版本控制之下，并且通过使用日志消息，您可以稍后搜索关键字并签出项目以备不时之需。一旦你将一个项目置于版本控制之下，你就可以将它从你的本地磁盘中删除（这样你的东西就更少了）。

* * *

## 回答 #3

> 赞同：0
> 
>             
> 
> 时间：2009-05-24T17:28:08.820

如果 wiki 真的很麻烦，为什么不使用类似的东西搜索项目文件夹的根目录

```
findstr /I /S "nifty comment" *.cs 
```

这只需要您在代码中留下带有一些关键字的评论。

# mysql - 如何将数据导入内存数据库？

> ID：903832
> 
>         
> 
> 赞同：2
> 
>         
> 
> 时间：2009-05-24T14:10:48.157
> 
>         
> 
> 标签：mysql, sql-server, database, import, hsqldb

有什么方法可以将 MS SQL、MySQL 等数据库中的数据导入 HSQLDB、H2 等内存数据库？

* * *

## 回答 #1

> 赞同：2
> 
>             
> 
> 时间：2011-05-02T12:10:26.263

[H2 支持从 SQL 脚本文件初始化数据库](http://h2database.com/html/features.html#execute_sql_on_connection)的特殊数据库 URL ：

```
"jdbc:h2:mem;INIT=RUNSCRIPT FROM '~/create.sql'" 
```

据我所知，HSQLDB 和 Apache Derby 不支持这样的功能。

* * *

## 回答 #2

> 赞同：1
> 
>             
> 
> 时间：2009-05-24T14:19:55.190

我认为你需要做

1.  从 MS SQL 中查询数据

2.  使用 API 将数据导入内存数据库

SQL 表达式或 DB 相关 API

* * *

## 回答 #3

> 赞同：1
> 
>             
> 
> 时间：2011-05-01T17:18:58.920

在 Hibernate 中：将 import.sql 添加到类路径效果很好，hbm2dll 检查文件是否存在并执行它。唯一的细节是每个sql命令最多在一行，否则会执行失败

* * *

## 回答 #4

> 赞同：0
> 
>             
> 
> 时间：2009-05-24T14:21:13.737

您可以将数据转储为 SQL INSERT 语句，然后将其读回。

您可以读取临时对象（如结构），然后写回内部数据库。

* * *

## 回答 #5

> 赞同：0
> 
>             
> 
> 时间：2011-06-16T13:46:03.493

最新版本的 HSQLDB 允许您在 HSQLDB 中将 CSV（逗号分隔值）或其他分隔符分隔的数据文件作为 TEXT TABLE 打开，即使使用 mem: 数据库，也可以将其复制到其他表中。

正如其他人所指出的，为此目的也有功能强大且维护良好的第三方工具。

* * *

## 回答 #6

> 赞同：0
> 
>             
> 
> 时间：2009-05-24T15:55:36.597

查看免费的“通用数据库转换器” [http://eva-3-universal-database-converter-udc.optadat-com.qarchive.org/——](http://eva-3-universal-database-converter-udc.optadat-com.qarchive.org/)它确实声称支持 MySQL、MS-SQL 和 HSQLDB，其中其他。

* * *

## 回答 #7

> 赞同：0
> 
>             
> 
> 时间：2009-05-24T16:08:56.080

这真的取决于你的想法。是否有无需编程即可自动完成的工具？也许。

你想开发它吗？然后找出您最喜欢的语言是否同时支持数据库引擎（标准和内存），如果支持，只需编写一个脚本即可。分块处理所有内容（一次获取**n**行然后插入它们；重复）。块大小有多大？这取决于你，尝试不同的尺寸（比如 100、500、1k 等）看看哪一个在你的硬件上表现更好，微调到最佳位置。

另一方面，如果您最喜欢的语言不支持这两种语言，请尝试使用支持的语言。

* * *

## 回答 #8

> 赞同：0
> 
>             
> 
> 时间：2009-05-25T14:54:04.597

您可以使用[dbunit](http://www.dbunit.org/ "数据库单元")将数据库转储到 xml 文件并将其导入回另一个 rdbms。

# python - 在 Vim 中使用 pythoncomplete 时防止拆分窗口

> ID：903847
> 
>         
> 
> 赞同：5
> 
>         
> 
> 时间：2009-05-24T14:17:20.933
> 
>         
> 
> 标签：python, autocomplete, vim

我正在使用带有 pythoncomplete 的 VIM。当我完成时，当前窗口会被拆分，并且调用提示会显示在上部窗格中。我讨厌那个！有没有办法防止这种行为或至少自动限制上窗格的大小？

* * *

## 回答 #1

> 赞同：5
> 
>             
> 
> 时间：2009-05-24T14:29:10.083

您需要执行以下操作：

```
set completeopt-=preview 
```

这将阻止打开预览窗口。

# python - 如何从多维数组中提取一列？

> ID：903853
> 
>         
> 
> 赞同：292
> 
>         
> 
> 时间：2009-05-24T14:19:47.590
> 
>         
> 
> 标签：python, arrays, multidimensional-array, extraction

有人知道如何从 Python 中的多维数组中提取一列吗？

* * *

## 回答 #1

> 赞同：268
> 
>             
> 
> 时间：2011-09-28T03:55:53.467

```
>>> import numpy as np
>>> A = np.array([[1,2,3,4],[5,6,7,8]])

>>> A
array([[1, 2, 3, 4],
    [5, 6, 7, 8]])

>>> A[:,2] # returns the third columm
array([3, 7]) 
```

另见：“numpy.arange”和“reshape”分配内存

示例：（分配矩阵形状为 (3x4) 的数组）

```
nrows = 3
ncols = 4
my_array = numpy.arange(nrows*ncols, dtype='double')
my_array = my_array.reshape(nrows, ncols) 
```

* * *

## 回答 #2

> 赞同：221
> 
>             
> 
> 时间：2009-05-24T14:24:23.010

可能是您使用的是[NumPy 数组](http://docs.scipy.org/doc/numpy/user/basics.indexing.html#indexing-multi-dimensional-arrays)吗？Python 有[数组](http://docs.python.org/library/array.html)模块，但不支持多维数组。普通的 Python 列表也是一维的。

但是，如果您有一个像这样的简单二维列表：

```
A = [[1,2,3,4],
     [5,6,7,8]] 
```

然后你可以像这样提取一列：

```
def column(matrix, i):
    return [row[i] for row in matrix] 
```

提取第二列（索引 1）：

```
>>> column(A, 1)
[2, 6] 
```

或者，简单地说：

```
>>> [row[1] for row in A]
[2, 6] 
```

* * *

## 回答 #3

> 赞同：97
> 
>             
> 
> 时间：2011-10-14T10:21:58.720

如果你有一个像

```
a = [[1, 2], [2, 3], [3, 4]] 
```

然后你像这样提取第一列：

```
[row[0] for row in a] 
```

所以结果看起来像这样：

```
[1, 2, 3] 
```

* * *

## 回答 #4

> 赞同：47
> 
>             
> 
> 时间：2012-11-22T18:25:45.953

一探究竟！

```
a = [[1, 2], [2, 3], [3, 4]]
a2 = zip(*a)
a2[0] 
```

它与上面的相同，只是 zip 更简洁，但需要单个数组作为参数，*a 语法将多维数组解包为单个数组参数

* * *

## 回答 #5

> 赞同：17
> 
>             
> 
> 时间：2018-05-02T20:47:49.720

```
>>> x = arange(20).reshape(4,5)
>>> x array([[ 0,  1,  2,  3,  4],
        [ 5,  6,  7,  8,  9],
        [10, 11, 12, 13, 14],
        [15, 16, 17, 18, 19]]) 
```

如果你想要第二列，你可以使用

```
>>> x[:, 1]
array([ 1,  6, 11, 16]) 
```

* * *

## 回答 #6

> 赞同：15
> 
>             
> 
> 时间：2017-10-21T21:26:30.487

```
def get_col(arr, col):
    return map(lambda x : x[col], arr)

a = [[1,2,3,4], [5,6,7,8], [9,10,11,12],[13,14,15,16]]

print get_col(a, 3) 
```

Python 中的 map 函数是另一种方法。

* * *

## 回答 #7

> 赞同：14
> 
>             
> 
> 时间：2020-01-16T17:16:56.700

如果你在 Python 中有一个二维数组（不是 numpy），你可以像这样提取所有列，

```
data = [
['a', 1, 2], 
['b', 3, 4], 
['c', 5, 6]
]

columns = list(zip(*data))

print("column[0] = {}".format(columns[0]))
print("column[1] = {}".format(columns[1]))
print("column[2] = {}".format(columns[2])) 
```

执行此代码将产生，

```
>>> print("column[0] = {}".format(columns[0]))
column[0] = ('a', 'b', 'c')

>>> print("column[1] = {}".format(columns[1]))
column[1] = (1, 3, 5)

>>> print("column[2] = {}".format(columns[2]))
column[2] = (2, 4, 6) 
```

当然，您可以按索引提取单个列（例如`columns[0]`）

* * *

## 回答 #8

> 赞同：12
> 
>             
> 
> 时间：2019-10-30T02:32:00.527

```
array = [[1,2,3,4],[5,6,7,8],[9,10,11,12],[13,14,15,16]]

col1 = [val[1] for val in array]
col2 = [val[2] for val in array]
col3 = [val[3] for val in array]
col4 = [val[4] for val in array]
print(col1)
print(col2)
print(col3)
print(col4)

Output:
[1, 5, 9, 13]
[2, 6, 10, 14]
[3, 7, 11, 15]
[4, 8, 12, 16] 
```

* * *

## 回答 #9

> 赞同：11
> 
>             
> 
> 时间：2014-04-22T23:31:11.197

```
[matrix[i][column] for i in range(len(matrix))] 
```

* * *

## 回答 #10

> 赞同：9
> 
>             
> 
> 时间：2009-05-24T19:57:39.753

itemgetter 运算符也可以提供帮助，如果您喜欢 map-reduce 样式的 python，而不是列表推导式，则可以提供一些帮助！

```
# tested in 2.4
from operator import itemgetter
def column(matrix,i):
    f = itemgetter(i)
    return map(f,matrix)

M = [range(x,x+5) for x in range(10)]
assert column(M,1) == range(1,11) 
```

* * *

## 回答 #11

> 赞同：7
> 
>             
> 
> 时间：2015-02-06T11:18:11.057

您也可以使用它：

```
values = np.array([[1,2,3],[4,5,6]])
values[...,0] # first column
#[1,4] 
```

注意：这不适用于内置数组且未对齐（例如 np.array([[1,2,3],[4,5,6,7]]) ）

* * *

## 回答 #12

> 赞同：6
> 
>             
> 
> 时间：2015-03-20T11:18:47.417

我认为您想从数组中提取一列，例如下面的数组

```
import numpy as np
A = np.array([[1,2,3,4],[5,6,7,8],[9,10,11,12]]) 
```

现在，如果您想获取格式的第三列

```
D=array[[3],
[7],
[11]] 
```

然后你需要首先使数组成为矩阵

```
B=np.asmatrix(A)
C=B[:,2]
D=asarray(C) 
```

现在您可以像在 excel 中一样进行元素计算。

* * *

## 回答 #13

> 赞同：5
> 
>             
> 
> 时间：2013-10-25T14:47:27.550

使用矩阵的另一种方法

```
>>> from numpy import matrix
>>> a = [ [1,2,3],[4,5,6],[7,8,9] ]
>>> matrix(a).transpose()[1].getA()[0]
array([2, 5, 8])
>>> matrix(a).transpose()[0].getA()[0]
array([1, 4, 7]) 
```

* * *

## 回答 #14

> 赞同：5
> 
>             
> 
> 时间：2016-11-20T19:59:57.443

假设我们有`n X m`矩阵（`n`行和`m`列）说 5 行和 4 列

```
matrix = [[1,2,3,4],[5,6,7,8],[9,10,11,12],[13,14,15,16],[17,18,19,20]] 
```

要在 python 中提取列，我们可以像这样使用列表推导

```
[ [row[i] for row in matrix] for in range(4) ] 
```

您可以将 4 替换为矩阵具有的任意数量的列。结果是

`[ [1,5,9,13,17],[2,10,14,18],[3,7,11,15,19],[4,8,12,16,20] ]`

* * *

## 回答 #15

> 赞同：4
> 
>             
> 
> 时间：2019-10-30T02:18:32.260

只需使用 transpose()，就可以像获取行一样简单地获取列

```
matrix=np.array(originalMatrix).transpose()
print matrix[NumberOfColumns] 
```

* * *

## 回答 #16

> 赞同：3
> 
>             
> 
> 时间：2013-09-03T14:33:28.307

好吧，有点晚了……

如果性能很重要并且您的数据呈矩形，您也可以将其存储在一维中并通过常规切片访问列，例如...

```
A = [[1,2,3,4],[5,6,7,8]]     #< assume this 4x2-matrix
B = reduce( operator.add, A ) #< get it one-dimensional

def column1d( matrix, dimX, colIdx ):
  return matrix[colIdx::dimX]

def row1d( matrix, dimX, rowIdx ):
  return matrix[rowIdx:rowIdx+dimX] 

>>> column1d( B, 4, 1 )
[2, 6]
>>> row1d( B, 4, 1 )
[2, 3, 4, 5] 
```

整洁的事情是这真的很快。**但是**，负索引在这里不起作用！所以你不能通过索引-1访问最后一列或最后一行。

如果您需要负索引，您可以稍微调整访问器功能，例如

```
def column1d( matrix, dimX, colIdx ):
  return matrix[colIdx % dimX::dimX]

def row1d( matrix, dimX, dimY, rowIdx ):
  rowIdx = (rowIdx % dimY) * dimX
  return matrix[rowIdx:rowIdx+dimX] 
```

* * *

## 回答 #17

> 赞同：3
> 
>             
> 
> 时间：2018-01-29T17:42:00.747

如果您想获取的不仅仅是一列，只需使用 slice：   

```
 a = np.array([[1, 2, 3],[4, 5, 6],[7, 8, 9]])
    print(a[:, [1, 2]])
[[2 3]
[5 6]
[8 9]] 
```

* * *

## 回答 #18

> 赞同：2
> 
>             
> 
> 时间：2013-08-31T06:30:42.683

尽管`zip(*iterable)`用于转置嵌套列表，但如果嵌套列表的长度不同，您也可以使用以下内容：

```
map(None, *[(1,2,3,), (4,5,), (6,)]) 
```

结果是：

```
[(1, 4, 6), (2, 5, None), (3, None, None)] 
```

因此，第一列是：

```
map(None, *[(1,2,3,), (4,5,), (6,)])[0]
#>(1, 4, 6) 
```

* * *

## 回答 #19

> 赞同：2
> 
>             
> 
> 时间：2018-03-28T07:13:33.417

我更喜欢下一个提示：将矩阵命名为`matrix_a`并使用`column_number`，例如：

```
import numpy as np
matrix_a = np.array([[1,2,3,4],[5,6,7,8],[9,10,11,12]])
column_number=2

# you can get the row from transposed matrix - it will be a column:
col=matrix_a.transpose()[column_number] 
```

* * *

## 回答 #20

> 赞同：0
> 
>             
> 
> 时间：2014-04-28T17:57:50.923

矩阵中的所有列到一个新列表中：

```
N = len(matrix) 
column_list = [ [matrix[row][column] for row in range(N)] for column in range(N) ] 
```

# optimization - 文件到 4.8GB 块的最佳组合

> ID：903859
> 
>         
> 
> 赞同：1
> 
>         
> 
> 时间：2009-05-24T14:21:04.827
> 
>         
> 
> 标签：optimization, math, backup

我的驱动器有 DMG 块。它们的大小之和严格低于 47GB。我有 11 张 DVD，每张 4.7GB。我想尽可能少地使用 DVD，而不使用压缩（这个问题可能是多余的，因为它考虑了 DMG 文件方面的最佳组合。如果你愿意，你可以根据压缩文件来考虑它。 ）。

您可以看到 DMG 文件具有任意大小。有很多解决方案是可能的。

```
find . -iname "*.dmg" -exec du '{}' \; 3&> /dev/null

1026064 ./Desktop/Desktop2.dmg
5078336 ./Desktop/Desktop_2/CS_pdfs.dmg
2097456 ./Desktop/Desktop_2/Signal.dmg
205104  ./Dev/things.dmg
205040  ./Dev/work.dmg
1026064 ./DISKS/fun.dmg
1026064 ./DISKS/school.dmg
1026064 ./DISKS/misc.dmg
5078336 ./something.dmg 
```

DVD 中的文件可以有任意顺序。例如，CS_pdfs.dmg 和 Signal.dmg 不需要在某个磁盘上。

> 那么如何才能找到使用尽可能少的 DVD 的方法呢？

* * *

## 回答 #1

> 赞同：3
> 
>             
> 
> 时间：2009-05-24T14:37:17.633

您的问题在数学上称为[装箱问题](http://en.wikipedia.org/wiki/Bin_packing)（与[背包问题](http://en.wikipedia.org/wiki/Knapsack_problem)有关。）

由于它是*np-hard*，因此**很难**有效地解决这个问题！有一个递归解决方案（动态编程+回溯），但即使这样也可能需要大量的空间和计算时间。

最直接的解决方案是[贪心算法](http://en.wikipedia.org/wiki/Knapsack_problem#Greedy_approximation_algorithm)（参见 Blindy 的帖子），但这可能会产生不好的结果。

这取决于您要打包多少个项目 (n) 以及解决方案必须*有多精确（更精确会增加运行时间！）。*对于小的 n 递归/蛮力或回溯解决方案就足够了，对于更大的问题，我建议使用一些[元启发式](http://en.wikipedia.org/wiki/Metaheuristics)- 特别是[遗传算法](http://en.wikipedia.org/wiki/Genetic_algorithms)工作得很好，并在可接受的时间跨度内产生良好的近似值。

* * *

## 回答 #2

> 赞同：2
> 
>             
> 
> 时间：2009-05-24T15:23:03.470

完全替代的解决方案：使用*拆分*并将边界切割到多张 DVD 上。除了最后一个磁盘，您将获得每个磁盘 100% 的利用率。[http://unixhelp.ed.ac.uk/CGI/man-cgi?split](http://unixhelp.ed.ac.uk/CGI/man-cgi?split)

* * *

## 回答 #3

> 赞同：1
> 
>             
> 
> 时间：2009-05-24T14:46:26.353

您可能应该先尝试贪心算法 - 也就是说，每次都选择可以容纳剩余 DVD 的最大项目。虽然不能保证这能很好地工作，但这个问题是 NP 完全的，因此不存在有效的解决方案。我最近遇到了类似的问题，贪心算法在我的情况下运行得很好——也许它在你的情况下也足够好。

* * *

## 回答 #4

> 赞同：0
> 
>             
> 
> 时间：2009-05-24T14:28:12.737

最通用的解决方案将涉及实现一个简单的回溯算法，但我相当肯定，在这种特殊情况下，您可以按大小对它们进行排序，然后一遍又一遍地选择适合您的磁盘的最大文件，直到它满了，然后继续剩下的文件到下一个。

# asp.net - 删除子应用程序中的 codeSubDirectories 元素时出现问题

> ID：903862
> 
>         
> 
> 赞同：3
> 
>         
> 
> 时间：2009-05-24T14:21:43.423
> 
>         
> 
> 标签：asp.net, web-config

我在 web.config 中有一个带有 <codeSubDirectories> 部分的 ASP.NET 应用程序。我的主要项目在 VB.NET 中，但我在用 C# 编写的 App_Code 下有一个 CSCode 子目录。现在，对于我创建的每个新子应用程序，我必须在 App_Code 下创建一个 CSCode 文件夹。Microsoft 的文档说有一个 <clear /> 元素，但是当我将它添加到子应用程序的 web.config 文件时出现错误。这是怎么回事？

* * *

## 回答 #1

> 赞同：5
> 
>             
> 
> 时间：2009-05-24T14:26:23.490

找到了。显然，微软从来没有绕过为 <codeSubDirectories> 实际编码 <clear /> 元素。在线[MSDN 文档](http://msdn.microsoft.com/en-us/library/ms228265(VS.85).aspx#ctl00_WikiContent_headerTitle)在社区内容部分提到了这一点。  

作为一种解决方法，我将把 CSCode 移到一个单独的 DLL 中。

* * *

## 回答 #2

> 赞同：0
> 
>             
> 
> 时间：2012-08-03T20:33:01.463

如果您没有源代码，您可以在 App_Code 子应用程序中创建所有子目录，即使没有内容。在大多数情况下，代码效果很好。

参考：

[http://systemscenter.ru/avicodeenterprisedotnetmp2007manual.en/appendix-knowledgebase.htm](http://systemscenter.ru/avicodeenterprisedotnetmp2007manual.en/appendix-knowledgebase.htm)

# iphone - 无法在不崩溃的情况下设置 ABPeoplePickerNavigationController 的 addressBook 属性

> ID：903863
> 
>         
> 
> 赞同：0
> 
>         
> 
> 时间：2009-05-24T14:22:05.513
> 
>         
> 
> 标签：iphone, cocoa-touch

我想显示一个 ABPeoplePicker，其中只有定义了地理地址的人。

所以我创建了一个地址簿并删除了没有地址的人：

```
addressBook = ABAddressBookCreate();
NSArray *peopleList = (NSArray *)ABAddressBookCopyArrayOfAllPeople( addressBook );
NSLog(@"There are %d people in addressBook", ABAddressBookGetPersonCount(addressBook));
for (id peopleRecord in peopleList) {
  ABMultiValueRef mv = ABRecordCopyValue((ABRecordRef)peopleRecord, kABPersonAddressProperty);
  CFIndex numberOfAddresses = ABMultiValueGetCount(mv);
  if( numberOfAddresses == 0 ) {
    CFErrorRef err;
    ABAddressBookRemoveRecord( addressBook, (ABRecordRef)peopleRecord, &err);
  }
}
[peopleList release];
NSLog(@"There are now %d people in addressBook", ABAddressBookGetPersonCount(addressBook));
ABPeoplePickerNavigationController *peoplePicker = [[ABPeoplePickerNavigationController alloc] init];
NSNumber* addressProp = [NSNumber numberWithInt:kABPersonAddressProperty];
[peoplePicker setAddressBook:addressBook];
peoplePicker.displayedProperties = [NSArray arrayWithObject:addressProp];
[peoplePicker setPeoplePickerDelegate:self];
[self presentModalViewController:peoplePicker animated:YES]; 
```

对于信息，过滤前我有 125 条记录，过滤后我有 93 条记录。

当我显示 peoplePicker 并滚动浏览它时，它会崩溃：

```
*** Terminating app due to uncaught exception 'NSRangeException', reason: '*** -[NSCFArray objectAtIndex:]: index (49) beyond bounds (49)' 
```

知道有什么问题吗？

* * *

## 回答 #1

> 赞同：0
> 
>             
> 
> 时间：2009-05-24T14:30:24.153

NSRangeException 的值为 49（而不是 93 到 125 之间的某个数字）这一事实，我最初怀疑它与此通讯簿没有直接关系。为 .添加断点`objc_exception_throw`。这将导致您在异常点进入调试器，让您看到实际上是谁在抛出它。

# c - 如何退出子进程并从 execvp() 返回其状态？

> ID：903864
> 
>         
> 
> 赞同：19
> 
>         
> 
> 时间：2009-05-24T14:22:24.433
> 
>         
> 
> 标签：c, exec, fork, exit

在我的简单自定义 shell 中，我从标准输入读取命令并使用 execvp() 执行它们。在此之前，我创建当前进程的一个分支，并在该子进程中调用 execvp()，之后，我调用 exit(0)。

像这样的东西：

```
pid = fork();

if(pid == -1) {
    perror("fork");
    exit(1);
}

if(pid == 0) {
    // CHILD PROCESS CODE GOES HERE...
    execvp(pArgs[0], pArgs);
    exit(0);
} else {
    // PARENT PROCESS CODE GOES HERE...
} 
```

现在，使用 execvp() 运行的命令可以返回错误，对吧？我想正确处理这个问题，现在我总是调用 exit(0)，这意味着子进程将始终处于“OK”状态。

如何从 execvp() 调用中返回正确的状态并将其放入 exit() 调用中？我是否应该只获取 execvp() 返回的 int 值并将其作为 exit() 参数而不是 0 传递。这是否足够且正确？

* * *

## 回答 #1

> 赞同：18
> 
>             
> 
> 时间：2009-05-24T14:26:20.293

您需要在父代码中使用`waitpid(3)`或`wait(1)`等待子退出并获取错误消息。

语法是：

```
pid_t waitpid(pid_t pid, int *status, int options); 
```

或者

```
pid_t wait(int *status); 
```

`status`包含退出状态。查看[手册页](http://linux.die.net/man/2/waitpid)以了解如何解析它。

* * *

请注意，您不能从子进程中执行此操作。一旦您调用`execvp`子进程就***死***了（出于所有实际目的）并被'd 进程*替换。*`exec`你可以到达那里的唯一方法`exit(0)`是如果`execvp`它本身失败了，但失败不是因为新程序结束了。这是因为它从一开始就没有跑过。

**编辑：**子进程并没有*真正*死掉。PID 和环境保持不变，但整个代码和数据都被`exec`'d 进程替换。您可以指望*不*返回原始子进程，除非`exec`失败。

* * *

## 回答 #2

> 赞同：3
> 
>             
> 
> 时间：2009-05-24T14:48:25.863

从你的问题很难弄清楚你在问什么。因此，我将尝试讨论几个相关问题：

*   `execvp()`要么不返回（成功时），要么返回错误。这意味着您的子代码只需要处理错误情况。您的子代码应按照您的建议捕获`execvp()`并使用该值的结果。`exit()`您的子代码永远不应该返回 0，因为唯一的成功意味着`execvp`工作和进程*将*返回 0（或不返回）。

*   父母可以从`waitpid()`有关其退出状态的信息中获取子信息。定义了几个宏来从返回的`status`参数中提取信息。值得注意的是`WIFEXITED`，告诉您孩子是否“正常”退出，并将`WEXITSTATUS`孩子的状态传递给`exit()`. 有关其他宏，请参见`waitpid`手册页。

* * *

## 回答 #3

> 赞同：3
> 
>             
> 
> 时间：2009-05-24T16:05:08.047

在父进程中使用`wait()`或。`waitpid()`这里的一个例子：[当操作系统杀死你的进程时返回代码](https://stackoverflow.com/questions/742413/return-code-when-os-kills-your-process/747819#747819)。

此外，当子进程死亡时，`SIGCHLD`信号会发送到父进程。

# c# - FormView 绑定中的 DropDownList

> ID：903869
> 
>         
> 
> 赞同：12
> 
>         
> 
> 时间：2009-05-24T14:25:47.627
> 
>         
> 
> 标签：c#, asp.net, .net, drop-down-menu, formview

我想`List<MyIem>`在后面的代码中将下拉列表绑定到 , 。

```
 <asp:DropDownList ID="listCategories"  runat="server" Height="20px"   CssClass="CategoryDropList" SelectedValue='<%# Bind("ParentId") %>' AutoPostBack="false" Width="300px"> 
```

不使用 ObjectDataSource ！

如何将其绑定到下拉列表？在什么情况下？

也`SelectedValue='<%# Bind("ParentId") %>'`应该工作！（我的意思是下拉列表绑定应该在此之前发生！）

* * *

## 回答 #1

> 赞同：5
> 
>             
> 
> 时间：2009-05-24T16:19:25.347

做了一个例子，它将在 DataBound 事件中设置下拉菜单。

这是标记

使用ddl的方法，是在DataBound事件期间使用findcontrol()找到它。

当您在 DataBound 事件中拥有控件时，您还可以将下拉列表绑定到您的 List<>

希望这会有所帮助。

```
<%@ Page Language="C#" AutoEventWireup="true" CodeBehind="Default.aspx.cs" Inherits="WebApplication1._Default" %>

    <!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">

    <html xmlns="http://www.w3.org/1999/xhtml" >
    <head runat="server">
        <title>Untitled Page</title>
    </head>
    <body>
        <form id="form1" runat="server">
        <div>

        </div>
        <asp:FormView ID="FormView1" runat="server" ondatabound="FormView1_DataBound">
            <ItemTemplate>
                <asp:DropDownList ID="DropDownList1" runat="server">
                    <asp:ListItem>One</asp:ListItem>
                    <asp:ListItem>Two</asp:ListItem>
                    <asp:ListItem>Three</asp:ListItem>
                </asp:DropDownList>

            </ItemTemplate>
        </asp:FormView>
        </form>
    </body>
    </html> 
```

这是后面的代码：

```
namespace WebApplication1
{
    public partial class _Default : System.Web.UI.Page
    {
        protected void Page_Load(object sender, EventArgs e)
        {
            List<string> list = new List<string>();
            list.Add("Some");
            list.Add("Other");

            FormView1.DataSource = list; //just to get the formview going

            FormView1.DataBind(); 

        }

        protected void FormView1_DataBound(object sender, EventArgs e)
        {
            DropDownList ddl = null;
            if(FormView1.Row != null)
                ddl = (DropDownList) FormView1.Row.FindControl("DropDownList1");
            ddl.SelectedIndex = ddl.Items.IndexOf(ddl.Items.FindByValue("Two"));
        }
    }
} 
```

* * *

## 回答 #2

> 赞同：4
> 
>             
> 
> 时间：2010-08-23T09:15:18.573

假设有效值在数据库中，您可以使用另一个 DataSource 填充 DropDownList。看看这个视频：

[http://msdn.microsoft.com/en-us/data/cc546554.aspx](http://msdn.microsoft.com/en-us/data/cc546554.aspx)

它使用的是 EntityDataSource 而不是 ObjectDataSource，但原理应该仍然有效。

如果您想要 null 的“（无）”类型选项，请参阅此页面上的“在模板字段中转换 Null”部分：

[http://msdn.microsoft.com/en-us/library/ms366709.aspx](http://msdn.microsoft.com/en-us/library/ms366709.aspx)

具体来说：

```
<asp:DropDownList ID="DropDownList2" runat="server" DataSourceID="SqlDataSource2"
    DataTextField="Name" DataValueField="EmployeeID"
    SelectedValue='<%# Bind("ReportsTo") %>' AppendDataBoundItems="True">
        <asp:ListItem Selected="True" Value="">(none)</asp:ListItem>
</asp:DropDownList> 
```

注意“AppendDataBoundItems”属性和“asp:ListItem”元素。

* * *

## 回答 #3

> 赞同：1
> 
>             
> 
> 时间：2013-11-22T05:33:21.467

好吧，我面临着类似的问题。我注意到您正在尝试将其添加到其中，而这可能是您没有看到它的主要原因。

但是，我已经研究了上面提供的两种解决方案，发现这对我有用：-

```
<EditItemTemplate>
<asp:DropDownList ID="ddlStream" runat="server" SelectedValue='<%# Bind("Stream") %>'>
                    <asp:ListItem>Common</asp:ListItem>
                    <asp:ListItem>Mechanical</asp:ListItem>
                    <asp:ListItem>Electronics</asp:ListItem>
                    </asp:DropDownList>
</EditItemTemplate>

<ItemTemplate>
<asp:Label runat="server" id="something" text='<%# Eval("Stream")%>'/>
</ItemTemplate> 
```

希望这可以帮助你。

# ruby-on-rails - 在 Ruby on Rails 中，为什么“form_for @story”必须将 Story 作为 RESTful

> ID：903876
> 
>         
> 
> 赞同：2
> 
>         
> 
> 时间：2009-05-24T14:27:17.670
> 
>         
> 
> 标签：ruby-on-rails, rest

似乎当我们使用

```
form_for @story do |f| 
```

那么 Story 必须是一个 RESTful 资源，而且它必须是

```
map.resources :stories 
```

在 routes.rb 中。

Story 可以不是 RESTful 的吗？它可以是非 RESTful 数据的形式吗？

* * *

## 回答 #1

> 赞同：6
> 
>             
> 
> 时间：2009-05-24T14:53:33.827

查看[form_for 的 rails 文档](http://api.rubyonrails.org/classes/ActionView/Helpers/FormHelper.html#M001572)。

您可以修改`form_for @story`并传入一些其他选项以满足您的需要。

如果这对您不起作用，您可以使用[form_tag](http://api.rubyonrails.org/classes/ActionView/Helpers/FormTagHelper.html#M001697)代替。

# ruby-on-rails - 在 Ruby 中按布尔值对对象进行排序

> ID：903877
> 
>         
> 
> 赞同：3
> 
>         
> 
> 时间：2009-05-24T14:27:32.943
> 
>         
> 
> 标签：ruby-on-rails, ruby, sorting, boolean, enumerable

如果之前已经回答过或者很明显，我深表歉意......在这里和 Goog 上进行了一些搜索，但找不到答案。

我正在寻找按价格对提供者数组进行排序，以及它们是否是首选提供者？（对或错）

例如在`array p of Providers`...

```
p1.price == 1, p1.preferred_provider? == false
p2.price == 2, p2.preferred_provider? == true
p2.price == 3, p3.preferred_provider? == true 
```

我想 p.sort_by 并得到：

```
[p2 p3 p1] 
```

国际妇女联合会    

```
p.sort_by {|x| x.preferred_provider?, x.price } 
```

不起作用并得到...

```
undefined method `<=>' for false:FalseClass 
```

有关解决此问题的更好方法的任何建议？

* * *

## 回答 #1

> 赞同：8
> 
>             
> 
> 时间：2009-05-24T15:03:07.707

[大多数语言都提供了接受比较器](http://en.wikipedia.org/wiki/Comparator)的排序函数。在 Ruby 中，这只是 array.sort：

```
p.sort {|a, b| if (a.preferred_provider? == b.preferred_provider?
               then a.price <=> b.price
               elsif a.preferred_provider?
                    1
               else -1
       } 
```

* * *

## 回答 #2

> 赞同：3
> 
>             
> 
> 时间：2009-05-24T15:03:06.240

`<=>`您可以在类上定义 a`Provider`来执行您想要的操作，然后使用该`Array.sort`方法（而不是`Enumerable.sort_by`）进行排序。这是`<=>`我掀起的定义：

```
class Provider
  def <=>(other)
    if preferred_provider?
      if other.preferred_provider?
        @price <=> other.price
      else
        1
      end
    else
      if other.preferred_provider?
        -1
      else
        @price <=> other.price
      end
    end
  end
end 
```

然后，如果你有你的数组`p`，你可以做`p_sorted = p.sort`.

（请注意，我没有测试过这段代码，所以可能会有一些错误，但我认为它可以证明这个想法。）

# python - Python：将大字典发送到服务器

> ID：903885
> 
>         
> 
> 赞同：0
> 
>         
> 
> 时间：2009-05-24T14:30:59.083
> 
>         
> 
> 标签：python, turbogears

我有一个应该将状态信息传递给服务器的应用程序。此信息实际上是一个带有字符串键的大型字典。

服务器将运行基于 Turbogears 的 Web 应用程序，因此调用的服务器端方法接受任意数量的关键字参数。

除了实际数据之外，还应传输一些与身份验证相关的数据（id、密码..）。一种方法是简单地对包含所有这些内容的大型字典进行 urlencode 编码，然后将其发送到服务器的请求中。

```
urllib2.urlencode(dataPlusId) 
```

但实际上，进行身份验证和接受数据集的方法不必对数据了解太多。数据可以透明地传输和接受，并交给另一个处理数据的方法。

所以我的问题是：一般来说，将大型数据字典传输到服务器的最佳方式是什么？而且，在这种特定情况下，这里处理身份验证的最佳方法是什么？

* * *

## 回答 #1

> 赞同：4
> 
>             
> 
> 时间：2009-05-24T15:35:24.600

如果安全是一个问题，我同意所有关于避免腌制的答案（如果发件人在数据未被腌制之前获得身份验证，则可能不是 - 但是，当安全存在问题时，两层防御可能比一层更好）；在这种情况下，JSON 通常会有所帮助（或者，XML，如果没有别的办法......！-）。

正如 SpliFF 建议的那样，理想情况下，身份验证应该留给网络服务器，而 SSL（即 HTTPS）通常对此很有用。如果这不可行，但让客户端和服务器共享一个“秘密”是可行的，那么以加密形式发送序列化字符串可能是最好的。

* * *

## 回答 #2

> 赞同：3
> 
>             
> 
> 时间：2009-05-24T14:58:50.180

我认为最好的方法是以适当的传输格式对您的数据进行编码（您不应该使用 pickle，因为它不是保存的，但它可以是二进制的）并将其作为[多部分发布请求传输](http://code.activestate.com/recipes/146306/)

我不知道你是否可以让它与 repoze.who 一起工作。如果它不支持一步登录和函数调用，您可能必须自己验证凭据。

如果您可以将数据包装在 xml 中，您也可以使用[XML-RPC](http://turbogears.org/2.0/docs/modules/pylons/controllers_xmlrpc.html)。

* * *

## 回答 #3

> 赞同：2
> 
>             
> 
> 时间：2009-05-24T14:59:06.047

为什么不将字典序列化为文件，然后上传文件？这样，服务器可以将对象读回字典。

* * *

## 回答 #4

> 赞同：2
> 
>             
> 
> 时间：2009-05-24T15:09:32.890

对您的 python 数据进行 POST（使用其他答案中建议的二进制文件）并使用您的网络服务器处理安全性。Apache 和 Microsoft 服务器都可以使用多种方法（SSL 客户端证书、密码、系统帐户等）进行身份验证

如果您只是想再次将其转回字典，则对文本或 XML 进行序列化/反序列化可能是矫枉过正）。

* * *

## 回答 #5

> 赞同：2
> 
>             
> 
> 时间：2009-05-24T17:52:59.827

我个人会在两端使用 SimpleJSON，然后将“文件”（它实际上只是一个流）作为多部分数据发布。

但这就是我。还有其他选择。

* * *

## 回答 #6

> 赞同：1
> 
>             
> 
> 时间：2009-05-24T15:02:18.473

您是否尝试过在数据上使用 pickle ？

# delphi - 不正确的循环引用错误

> ID：903886
> 
>         
> 
> 赞同：8
> 
>         
> 
> 时间：2009-05-24T14:31:11.157
> 
>         
> 
> 标签：delphi

我们的团队已经使用 Delphi 6 多年，然后在 2006 年前切换到 Delphi。对于这两个版本，我们都有以下问题：**编译器经常抱怨一个应该被递归使用的单元**。该单元是一个 40k LOC 单元，是一个拥有近 100 万 LOC（包括第三方）的项目的核心。

错误消息不正确：**项目的完整构建始终有效**。不幸的是，错误消息没有告诉我们假定的循环引用在哪里，只是该单元的名称。有时甚至会出现有效的错误消息被列出 2-4 次，直到“找到”循环引用问题。很明显，编译器在这里循环运行。由于该项目的规模，很难手动找到问题。因此，我制作了一个工具来*证明*确实没有循环引用（该工具创建单元的有向依赖图并确定该图中的连贯性组件 - 除非我故意放入一些组件，否则没有）。

这不仅会影响 F9 编译，还会影响大部分时间不起作用的代码完成/洞察力。有时当我第二次按 ctrl-space 时它会起作用......

有什么想法可以隔离甚至解决问题吗？请注意，将 40k LOC 单元拆分成更小的单元是非常困难的，因为它包含大约 15 个在接口部分相互依赖的大类（我知道这很糟糕，但无论如何应该可以工作）。

**更新**

我们一直在重构，但这是一个难以重构的单元，因为几乎一切都取决于一切。一直试图通过接口解决它，但我们正在谈论一些具有 100 多个方法和属性的类。而且会慢一些。

升级到 D2009 可能是一个选择，但现在我们被 D2006 困住了（unicode 的东西和价格标签是这里的两个障碍）。无论如何，问题是它是否会有所帮助，因为至少从 D6 开始就存在问题。  

关于修剪使用条款，我们一直在使用 Icarus 进行此操作。但到目前为止，这并没有帮助。我们现在在界面部分减少了 90 个自定义单元。但是，对于真正的循环引用，问题可能出现在任何单元中。还尝试将所有单位添加到 dpr。

该项目与其他项目共享大量代码，并且有一些 IFDEF。但是，定义不是在项目选项中设置的，而是通过一个通用的包含文件设置的。因此所有模块都应该看到相同的定义。此外，在没有切换到另一个项目的情况下完全重建后不久，该问题再次出现。

* * *

## 回答 #1

> 赞同：4
> 
>             
> 
> 时间：2009-05-24T21:30:45.773

我可能会因此而被否决。在 D2005 中，我有一个 10k loc 单元（数据模块）完全停止编译。不得不将一些数据集/代码分离到另一个数据模块。那个 10k 单位过去和现在都是一团糟。你真的应该考虑将一些代码重构到其他单元。自 D2005 以来，我的模块 / 分离变得更糟，但它仍然在 D2007 中编译。所以我的答案是 a) 重构 b) 升级到 D2009。

* * *

## 回答 #2

> 赞同：2
> 
>             
> 
> 时间：2009-05-25T11:28:56.570

您写道，完整构建总是成功，但在增量构建失败后不久并出现此错误。假设您在 IDE 中遇到过这种情况，您是否尝试过使用命令行编译器 dcc32 进行增量构建？

如果你不给它提供“-Q”开关（可能大多数 Makefile 或命令行构建的脚本都会这样做），它将输出大量信息它以什么顺序编译哪些文件。您可以在 IDE 中出现错误后尝试进行增量构建，或者您可以在 IDE 旁边打开一个命令行并使用 Alt+Tab 进行编译，完全跳过 IDE 中的编译。

我只是假设您有一种使用 dcc32 构建的方法，一种或另一种方式-您的项目的大小我无法想象。

* * *

## 回答 #3

> 赞同：2
> 
>             
> 
> 时间：2009-05-25T14:30:39.153

我们经常遇到类似的问题，而且我们从来没有设法（或打扰足够长的时间）找到确切的原因。Delphi在按下Ctrl-F9时选择编译单元的顺序似乎有问题，这与单元的实际依赖顺序不兼容。

*   您是否尝试过在按下 Ctrl-F9 之前删除“MyBigFatUnit.dcu”？

*   您是否尝试过重新排序 dpr/dpk 文件中的单位声明，以便单位以正确的编译顺序显示？（即：如果单元 B 依赖于单元 A，则单元 A 应首先出现在 dpr/dpk 中）

* * *

## 回答 #4

> 赞同：2
> 
>             
> 
> 时间：2009-05-24T16:01:54.020

很明显，这是由于后台编译器和真实编译器之间的细微差别造成的。您可以查看 (QualityCentral) 关于该主题的已知信息。

此外，由于您没有明确说明这一点，因此您应该删除不必要的单元并尽可能将使用语句移至实现。也许你的工具可以帮助解决这个问题。

并且只是为了确保您应该检查单位别名和路径设置。

* * *

## 回答 #5

> 赞同：0
> 
>             
> 
> 时间：2011-02-10T04:56:02.983

我被告知处理此问题的一种方法是在项目中打开另一个任意文件，更改该文件，保存它，然后尝试再次运行增量编译。令人惊讶的是，这通常有效。

我们有一个 4 MLOC 项目，它不时出现，这个“解决方案”对我有用。

* * *

## 回答 #6

> 赞同：0
> 
>             
> 
> 时间：2011-02-10T05:10:28.923

我以前曾与此作过斗争，以我的经验，该错误是准合法的。已经有一段时间了（错误与版本无关），但我对这种情况的记忆是它涉及一个循环，其中循环的一部分在实现中。

单元 A 在实现中使用 B。B单元在接口中使用A。如果您首先编译 B 它会调用 A 但由于对 B 的调用在实现中它会成功。如果你先编译A，它会调用B，B转身在界面中调用A，boom。只有当两个交叉引用都在实现中时，这样的循环才是安全的。

解决方案是设计一些东西，以便界面中使用最少的东西，并确保这些单元中没有类似循环的东西。只要您将类型定义与带有代码的单元分开，这很容易做到。

取决于你在做什么的错误来来去去是这个问题的一个标志，因为它归结为你如何进入循环。当您进行完整构建时，顺序是一致的，并且您可以得到 100% 或 0%，这不是随机的。

* * *

## 回答 #7

> 赞同：0
> 
>             
> 
> 时间：2009-05-24T15:30:22.130

您是否有任何其他项目使用相同代码库的一部分？如果您在不同的编译器设置或 IFDEF 下编译其中一个，它可能会更改某些 DCU 中的某些内容，从而导致循环依赖。完整构建会重建所有 DCU，然后问题就会消失。

* * *

## 回答 #8

> 赞同：0
> 
>             
> 
> 时间：2009-05-24T15:55:23.633

试试Peganza 的[Icarus](http://www.peganza.com/products_icarus.htm)（免费）。如果这不能告诉您问题所在，请尝试他们的 Pascal Analyzer。

* * *

## 回答 #9

> 赞同：0
> 
>             
> 
> 时间：2009-05-26T21:53:11.633

我们也有这个问题，代码库也相当大。

我们目前使用的是 D2009，但在所有以前的 Delphi 版本中都遇到过这个问题。

它最常发生在从源代码管理进行更新后立即发生，因此我怀疑 Delphi 构建过程中存在一些时间戳问题。

在我们的例子中，如果 Ctrl-F9 失败并报告循环引用，第二个 Ctrl-F9 通常会起作用

# c# - 从单独的类访问母版页控件

> ID：903891
> 
>         
> 
> 赞同：1
> 
>         
> 
> 时间：2009-05-24T14:34:17.343
> 
>         
> 
> 标签：c#, master-pages

我一直在阅读处理母版页的其他问题，但我没有看到任何完全有我正在寻找的答案的问题，所以......

我有一个母版页。我在母版页上有一个控件（控件 A）。我有一个特定的内容页面，我想禁用（控制 A）和启用（控制 B）。

我不想在内容页面上执行此操作，而是想在站点中使用的静态实用程序类中执行此操作。原因是我们在网站上有 4 个不同的部分，它们使用 4 个不同的母版页。我正在尝试创建一个静态方法来接收母版页和控件的名称，然后交换控件。

我不太清楚如何从单独的类中引用母版页。

* * *

## 回答 #1

> 赞同：2
> 
>             
> 
> 时间：2009-05-24T14:56:41.917

我不认为你能做到这一点......大概你想要类似的东西

```
public static void DoWork (string masterPageName)
{
   //Code to find instance of masterpage...
} 
```

由于没有实例，您将无法从静态类中执行此操作。您需要在外面找到它并将实际的母版页对象传递给您的静态方法。

我真的不明白为什么有必要在实用程序类中执行此操作，但如果它特定于您的一个内容页面。如果它对您的许多内容页面都是通用的，那么请考虑创建一个您的内容页面可以扩展的 basePage 类......例如

```
public class BasePage : System.Web.UI.Page
{
    protected void Page_Load(object sender, EventArgs e)
    {
       if(this.Master != null)
          if(this.Master.FindControl("Control A") != null)
              //Disable Control A
              //Enabled Control B
    }
} 
```

# javascript - 数据是如何传递给 JavaScript 中的匿名函数的？

> ID：903904
> 
>         
> 
> 赞同：5
> 
>         
> 
> 时间：2009-05-24T14:40:16.083
> 
>         
> 
> 标签：javascript, closures

当我将“this”传递给这样的匿名函数时：

```
MyClass.prototype.trigger = function(){
    window.setTimeout(function(){this.onTimeout();},1000);
} 
```

我收到“this.onTimeout 不是函数”错误。我猜想在匿名函数执行时“this”不再可用？所以我一直在这样做：

```
MyClass.prototype.trigger = function(){
    var me = this
    window.setTimeout(function(){me.onTimeout();},1000);
} 
```

这真的是你应该做的事情吗？它有点工作，但感觉很奇怪。

然后我们有这个例子：

```
$(function(){
    function MyClass(){
        this.queue = new Array();
    }
    MyClass.prototype.gotAnswer = function(count){
        $('body').append("count:"+count+"<br/>");
    }
    MyClass.prototype.loadAll = function(){
        var count = 0;
        var item;
        while(item = this.queue.pop()){
            count++;
            var me = this;
            $.getJSON("answer.html",{},function(data){me.gotAnswer(count);});
        }
    }

    var o = new MyClass();
    o.queue.push(1);
    o.queue.push(2);
    o.loadAll();

}); 
```

这输出：

```
2
2 
```

它不应该输出：

```
1
2 
```

反而？然后我发现将 $.getJSON-statement 放在另一个函数中可以使它全部工作：

```
MyClass.prototype.loadAll = function(){
    var count = 0;
    var item;
    while(item = this.queue.pop()){
        count++;
        this.newRequest(count);
    }
}
MyClass.prototype.newRequest = function(count){
    var me = this;
    $.getJSON("answer.html",null,function(data){ me.gotAnswer(count); });
} 
```

这输出：

```
1
2 
```

（或相反。）这里发生了什么？将变量传递给匿名函数的正确方法是什么？

很抱歉这篇令人困惑和冗长的帖子。

* * *

## 回答 #1

> 赞同：5
> 
>             
> 
> 时间：2009-05-24T15:06:31.943

你正在经历的是正确的行为——这不是一个好的行为，但它是语言的一部分。“this”的值在**每个**函数定义中被重置。有四种方法可以调用具有不同设置“this”的函数。

1.  常规函数调用

    ```
    我的函数（参数 1，参数 2）；
    ```

    这种调用函数的方式总是会将“this”重置为全局对象。这就是你的情况。

2.  将其称为方法

    ```
    myObj.myFunc(param1, param2);
    ```

    这毫不奇怪将“this”设置为调用该方法的任何对象。在这里，“this”==“myObj”。

3.  应用方法调用

    ```
    myFunc.apply(myObj, [param1, param2])
    ```

    这是一个有趣的 - 这里“this”设置为您作为第一个参数传递给 apply 方法的对象 - 这就像在没有该方法的对象上调用一个方法（注意该函数被编写为这样称呼）。默认情况下，所有函数都有 apply 方法。

4.  作为构造函数（带有“new”）

    ```
    myNewObj = new MyConstructor(param1, param2);
    ```

    当您以这种方式调用函数时，“this”被初始化为一个新对象，该对象从函数的原型属性继承方法和属性。在这种情况下，新对象将继承自 MyConstructor.prototype。此外，如果您没有显式返回值，则会返回“this”。

您使用的解决方案是推荐的解决方案 - 将“this”的外部值分配给另一个变量，该变量在您的函数中仍然可见。我唯一要改变的就是像 Török Gábor 所说的那样将变量称为“那个”——这是事实上的标准，可能会让你的代码更容易被其他程序员阅读。

* * *

## 回答 #2

> 赞同：3
> 
>             
> 
> 时间：2009-05-24T14:46:52.903

您对关闭感到困惑。

对于第一个问题，是的，你是对的，这是可以做到的。唯一的区别是有一个约定来命名`that`持有的变量`this`。

```
MyClass.prototype.trigger = function(){
    var that = this;
    window.setTimeout(function(){that.onTimeout();},1000);
} 
```

在 StackOverflow 上已经有一个很好的线程。检查问题的答案 [javascript 闭包如何工作？](https://stackoverflow.com/questions/111102/how-does-a-javascript-closure-work).

[您的第二个问题是循环内的 Javascript 闭包](https://stackoverflow.com/questions/750486/javascript-closure-inside-loops-simple-practical-example)的完全重复- 简单实用的示例。

* * *

## 回答 #3

> 赞同：0
> 
>             
> 
> 时间：2013-12-05T09:04:23.743

如果在您的新方法中，您将遇到同样的问题：newRequest 您必须使用“for”或“while”语句。另一种解决方案可能是创建一个闭包：

像那样：

```
$.getJSON("answer.html",{},(function(me){return function(data){me.gotAnswer(count);}})(this)); 
```

# objective-c - 如何向 NSDictionary 添加布尔值？

> ID：903906
> 
>         
> 
> 赞同：114
> 
>         
> 
> 时间：2009-05-24T14:41:21.137
> 
>         
> 
> 标签：objective-c, iphone, cocoa-touch, uikit

好吧，对于我会使用的整数`NSNumber`。但 YES 和 NO 不是对象，我猜。Afaik 我只能将对象添加到`NSDictionary`，对吗？

我找不到布尔值的任何包装类。有没有？

* * *

## 回答 #1

> 赞同：160
> 
>             
> 
> 时间：2009-05-24T14:44:47.930

**您使用 NSNumber。**

它有 init... 和 number... 采用布尔值的方法，就像它处理整数等一样。

从[NSNumber 类参考](http://developer.apple.com/DOCUMENTATION/Cocoa/Reference/Foundation/Classes/NSNumber_Class/Reference/Reference.html)：

```
// Creates and returns an NSNumber object containing a 
// given value, treating it as a BOOL.
+ (NSNumber *)numberWithBool:(BOOL)value 
```

和：

```
// Returns an NSNumber object initialized to contain a
// given value, treated as a BOOL.
- (id)initWithBool:(BOOL)value 
```

和：

```
// Returns the receiver’s value as a BOOL.
- (BOOL)boolValue 
```

* * *

## 回答 #2

> 赞同：55
> 
>             
> 
> 时间：2014-01-28T04:09:15.913

新语法`Apple LLVM Compiler 4.0`

```
dictionary[@"key1"] = @(boolValue);
dictionary[@"key2"] = @YES; 
```

语法转换`BOOL`为`NSNumber`，这是可以接受的`NSDictionary`。

* * *

## 回答 #3

> 赞同：16
> 
>             
> 
> 时间：2013-01-24T10:21:56.230

如果您将其声明为文字并且您使用的是 clang v3.1 或更高版本，则如果您将其声明为文字，则应使用 @NO / @YES。例如

```
NSMutableDictionary* foo = [@{ @"key": @NO } mutableCopy];
foo[@"bar"] = @YES; 
```

有关这方面的更多信息：

[http://clang.llvm.org/docs/ObjectiveCLiterals.html](http://clang.llvm.org/docs/ObjectiveCLiterals.html)

* * *

## 回答 #4

> 赞同：3
> 
>             
> 
> 时间：2015-05-27T12:57:29.957

正如[jcampbell1 所](https://stackoverflow.com/users/20512/jcampbell1)指出的，现在您可以对 NSNumbers 使用文字语法：

```
NSDictionary *data = @{
                      // when you always pass same value
                      @"someKey" : @YES
                      // if you want to pass some boolean variable
                      @"anotherKey" : @(someVariable)
                      }; 
```

* * *

## 回答 #5

> 赞同：-2
> 
>             
> 
> 时间：2015-07-31T09:00:18.580

试试这个：

```
NSMutableDictionary *dic = [[NSMutableDictionary alloc] init];
[dic setObject:[NSNumber numberWithBool:TRUE]  forKey:@"Pratik"];
[dic setObject:[NSNumber numberWithBool:FALSE] forKey:@"Sachin"];

if ([dic[@"Pratik"] boolValue])
{
    NSLog(@"Boolean is TRUE for 'Pratik'");
}
else
{
    NSLog(@"Boolean is FALSE for 'Pratik'");
}

if ([dic[@"Sachin"] boolValue])
{
    NSLog(@"Boolean is TRUE for 'Sachin'");
}
else
{
    NSLog(@"Boolean is FALSE for 'Sachin'");
} 
```

*输出将如下所示：*

' **Pratik** ' 的布尔值是**TRUE**

 **' **Sachin** ' 的布尔值是**FALSE**

 **# .net - 将 DBML 导出到 SQL 脚本

> ID：903922
> 
>         
> 
> 赞同：2
> 
>         
> 
> 时间：2009-05-24T14:48:46.003
> 
>         
> 
> 标签：.net, sql, sql-server, linq, linq-to-sql

由于硬盘崩溃，我丢失了我正在创建的项目的 SQL Server 数据库文件。

我仍然有我在 .NET 项目中使用的 DBML 文件，所以我的文件中仍然有数据库结构。

是否可以以某种方式将我的 DBML 导出到 SQL 服务器脚本，以在 SQL 服务器中重新创建我的数据库。

* * *

## 回答 #1

> 赞同：6
> 
>             
> 
> 时间：2009-05-24T15:11:48.563

如何：动态创建数据库 (LINQ to SQL)

[http://msdn.microsoft.com/en-us/library/bb399420.aspx](http://msdn.microsoft.com/en-us/library/bb399420.aspx)

# c# - c#中来自db的随机值

> ID：903924
> 
>         
> 
> 赞同：0
> 
>         
> 
> 时间：2009-05-24T14:52:19.523
> 
>         
> 
> 标签：c#, sql, sql-server, random

如何从 ItemID 列 intge db 中的现有 ItemID 列表中检索随机随机 ItemID，下面给出的是我使用的 sqlcommand。

```
(SqlCommand RetrieveComm =new SqlCommand("SELECT * FROM item_k WHERE ItemID='" +intGetRequest+ "'", searchCon)) 
```

谢谢，

* * *

## 回答 #1

> 赞同：2
> 
>             
> 
> 时间：2009-05-24T15:01:03.157

数据库中的`itemID`列是连续的数字列表吗？

如果是这样，您可以这样做...

```
Random r = new Random();
int x = r.Next(1, MAX_ID_FROM_DB); 
```

* * *

## 回答 #2

> 赞同：1
> 
>             
> 
> 时间：2009-05-24T15:02:02.873

您尚未指定正在使用的 RDBMS。

如果您使用的是 SQL Server，这将返回 N 个随机行：

```
SELECT TOP N    
    SomeColumn 
FROM     
    SomeTable
ORDER BY     
    CHECKSUM(NEWID()) 
```

# c# - 为我的应用程序制作帮助文件

> ID：903925
> 
>         
> 
> 赞同：2
> 
>         
> 
> 时间：2009-05-24T14:52:20.270
> 
>         
> 
> 标签：c#

我正在开发一个遗留应用程序，我实际上是在 C#.NET 中从头开始重写它。它曾经为使用 WinHelp 的用户提供某种帮助，但 Vista（我正在开发的系统）说它不支持 WinHelp。所以我要问的是：

如何从 C#.NET 制作类似的系统？我希望在 Vista、XP 和以前的 Windows 版本中使用新功能。

* * *

## 回答 #1

> 赞同：3
> 
>             
> 
> 时间：2009-05-24T14:55:11.933

使用 CHM 文件而不是几乎已弃用的 WinHelp 文件。您可以使用[HTML Help Workshop](http://www.microsoft.com/downloads/details.aspx?familyid=00535334-c8a6-452f-9aa0-d597d16580cc&displaylang=en)创建这些文件。

* * *

## 回答 #2

> 赞同：3
> 
>             
> 
> 时间：2009-05-24T15:01:49.287

您可以尝试[帮助和手册](http://www.ec-software.com/)。这是一个很棒的工具。

* * *

## 回答 #3

> 赞同：1
> 
>             
> 
> 时间：2009-05-24T14:57:57.063

您现在真的很想研究使用[Microsoft Sandcastle](http://www.codeplex.com/Sandcastle)文档生成器。它完全能够生成 HTML 帮助 v1.0/1.1 文件 (CHM) 或 v2.0（用于集成到 Visual Studio 帮助中）。实际的 .NET Framework 开发团队使用它（或其变体）为 BCL 创建 API 文档，因此您应该了解它的功能。当然，我不确定您想要的文档的确切性质，但 Sandcastle 可*用于生成 API 文档*和随附的帮助页面（指南、教程、示例、白皮书、词汇表等），使用其自定义 MAML -like) 标记语言，它本质上是在代码中的 XML 注释中使用的。

[这](http://www.codeplex.com/Sandcastle)是开始使用 Sandcastle 的基本指南，但我怀疑您只需要尝试一下就可以理解它。学习曲线也不是特别陡峭，除非您坚持从命令行学习它。到目前为止，最简单的选择是使用[Sandcastle Help File Builder GUI](http://shfb.codeplex.com/)，它是一款极好的工具，完全不会限制您。

另一个有用的资源是[这个 C# XML 文档指南](http://thoughtpad.net/alan-dean/cs-xml-documentation.html#seealso)，它向您展示了如何使用可以转换为 CHM 文档和 IntelliSense 的 XML 注释正确记录您的 API。

# asp.net-mvc - 如何将部分视图之外的值发布到 ASP.NET MVC 中的控制器？

> ID：903927
> 
>         
> 
> 赞同：1
> 
>         
> 
> 时间：2009-05-24T14:52:38.273
> 
>         
> 
> 标签：asp.net-mvc

我正在使用像 NerdDinner 示例中的分页列表。

我正在尝试显示前进和后退的导航按钮。我希望在单击它们时有一个表单帖子，以便仍然传递搜索文本。问题是，搜索文本存储在分页列表所在的部分视图之外的表单中，因此控制器永远找不到它。

关于我所缺少的任何想法？

* * *

## 回答 #1

> 赞同：1
> 
>             
> 
> 时间：2009-05-25T04:06:59.580

您可以考虑通过[视图模型](http://stephenwalther.com/blog/archive/2009/04/13/asp.net-mvc-tip-50-ndash-create-view-models.aspx)将查询结果和搜索文本传递给部分视图。

* * *

## 回答 #2

> 赞同：0
> 
>             
> 
> 时间：2009-05-24T15:55:39.217

你可以包括

```
<input type="hidden" id="search" /> 
```

在带有导航按钮的表单中并使用 jQuery 在 POST 上填写：

```
$(document).ready(function() {
    $('.yourNavButtonsClass').click(function () {
        var searchText = $('input#yourSearchTextBoxId').val();
        $('input#search').val(searchText);
    });
}); 
```

不幸的是，我的解决方案需要 Javascript/jQuery。

* * *

## 回答 #3

> 赞同：0
> 
>             
> 
> 时间：2009-05-25T04:52:22.753

google 也将搜索文本附加到 url、yahoo 和 msn。我相信你也可以这样做，这是更好的方法:)

# c# - Container.DataItem 适用于 C# 而不是 VB.NET

> ID：903928
> 
>         
> 
> 赞同：2
> 
>         
> 
> 时间：2009-05-24T14:53:02.830
> 
>         
> 
> 标签：c#, asp.net, vb.net

这行代码

```
((Matches)Container.DataItem).MatchID 
```

在 C# 中工作，但在 VB.NET 中，当在中继器中使用时，我收到错误

'Matches' 是一种类型，不能用作表达式。    

建议？

* * *

## 回答 #1

> 赞同：2
> 
>             
> 
> 时间：2009-05-24T14:56:29.217

尝试以下

```
DirectCast(Container.DataItem,Matches).MatchID 
```

* * *

## 回答 #2

> 赞同：1
> 
>             
> 
> 时间：2009-05-24T14:56:03.417

那是因为它是 C# 而不是 VB.NET。

我认为 VB.NET 的强制转换语法看起来像：

```
CType(Container.DataItem, Matches).EmpID 
```

但毫无疑问，如果这是错误的，VB.NET 专家会插话。

# vim - 无法通过 .vimrc 制作灰色 eol 字符

> ID：903934
> 
>         
> 
> 赞同：22
> 
>         
> 
> 时间：2009-05-24T14:55:38.377
> 
>         
> 
> 标签：vim, colors

我想要一个灰色的 eol 字符集

```
set list listchars=tab:>>,trail:$ 
```

字符“：”旁边没有空格

如果我在“：”旁边不使用空格，则上述代码**没有 eol 字符。**

如果我使用一个空格，我会得到一个绿色的尾随字符

```
- - tab:[space]>> -- 
```

虽然我没有明确设置

这样

[替代文本 http://dl.getdropbox.com/u/175564/trailingCharacter.png](http://dl.getdropbox.com/u/175564/trailingCharacter.png) 
*（终端中的旧代码）*

**如何在 Vim 中使 eol 字符变为灰色，**并使其再次工作？

* * *

## 回答 #1

> 赞同：36
> 
>             
> 
> 时间：2009-05-26T20:22:51.220

有两个突出显示组：SpecialKey 和 NonText。您提到的尾随字符属于非文本字符。

尝试这样的事情（y/paste）：

```
set list
set listchars=eol:$,tab:>-,trail:~,extends:>,precedes:<
hi NonText ctermfg=7 guifg=gray 
```

这对你有用吗，还是我理解错了这个问题（很可能）。

* * *

## 回答 #2

> 赞同：8
> 
>             
> 
> 时间：2009-05-24T15:20:22.757

和listchars 使用高亮组`trail`，`tab`因此您可以使用：`nbsp``SpecialKey`

```
highlight SpecialKey ctermfg=8 
```

使`$`符号变为灰色。如果您启用了 256 种颜色，则可以使用不同的灰色阴影，例如 243 等。

* * *

## 回答 #3

> 赞同：4
> 
>             
> 
> 时间：2009-05-28T20:45:17.747

如果您希望*eol*为灰色，请指定*eol*子选项`listchars`而不是*trail*：

```
set list listchars=tab:>>,eol:$ 
```

*trail*在行尾显示不必要的空白字符，而不是行尾本身。

如果要设置*eol*的颜色，则必须设置组的突出显示`NonText`：

```
highlight NonText ctermfg=8 guifg=gray 
```

如果同时指定`ctermfg`和`guifg`，突出显示将在 GUI 和终端中都起作用。

我必须指出一些缺点：

*   The highlighting of the tilde characters after the end of the buffer are the
    same as the highlighting of the eol-signs. I think it is not possible to
    separate those; their highlightings are both determined by the highlighting
    of `NonText`. So if you set gray eols, you will be gray tildes.

*   On my terminal, `ctermfg=8` makes red and not gray text.

# memory-management - 在不泄漏内存的情况下进行 NSMutableString 转换？

> ID：903936
> 
>         
> 
> 赞同：0
> 
>         
> 
> 时间：2009-05-24T14:56:16.393
> 
>         
> 
> 标签：memory-management, nsstring

我在 iPhone 项目的 Objective C 类中有这个功能。

虽然它在所需功能方面是正确的，但在几次调用后，它会崩溃到调试器中。

所以我认为这是一个糟糕的内存管理案例，但我不确定在哪里。

```
- (NSString *)stripHtml:(NSString *)originalText {
// remove all html tags (<.*>) from the originalText string
NSMutableString *strippedText = [[NSMutableString alloc] init];

BOOL appendFlag = YES;
for( int i=0; i<[originalText length]; i++ ) {
    NSString *current = [originalText substringWithRange:NSMakeRange(i, 1)];
    if( [current isEqualTo:@"<"] )
        appendFlag = NO;
    if( appendFlag ) 
        [strippedText appendString:current];
    if( [current isEqualTo:@">"] )
        appendFlag = YES;
}

NSString *newText = [NSString stringWithString:strippedText];
[strippedText release];
return newText; 
```

}

* * *

## 回答 #1

> 赞同：0
> 
>             
> 
> 时间：2009-07-10T03:03:52.010

每次遍历 for 循环时，都会分配一个新的 NSString。虽然这些 NSStrings 是自动释放的，但在您最后一个输入的所有处理完成之前，它们实际上不会被释放。同时，您将分配可能无限量的内存。解决方案是创建您自己的自动释放池，并在每次通过 for 循环时将其排空。它看起来像这样：

```
BOOL appendFlag = YES;
for( int i=0; i<[originalText length]; i++ ) {    
NSAutoreleasePool *pool = [NSAutoreleasePool new];
// rest of for loop body
[pool drain];
} 
```

这将立即释放当前指针使用的内存。

# .net - .NET Framework 线程“祖先”

> ID：903956
> 
>         
> 
> 赞同：1
> 
>         
> 
> 时间：2009-05-24T15:07:48.057
> 
>         
> 
> 标签：.net, multithreading

我正在寻找一种方法来确定它最初是在哪个其他线程上产生的线程。我不知道是否存在执行此操作的机制，类似于 .NET 4 的新任务并行库中任务的“父”属性

编辑：进一步的调查实际上似乎表明没有存储这些信息的位置，所以没有真正丑陋的黑客，这似乎不可能透明地实施。

因此，我认为我会接受下面的示例代码作为解决问题的最可行（不透明）的答案，即使我必须自己寻找替代设计。谢谢 ：）

* * *

## 回答 #1

> 赞同：2
> 
>             
> 
> 时间：2009-05-24T15:10:42.513

系统内部不提供此类功能。您可以很容易地将父线程的线程 ID 传递给线程启动函数：

```
static class ThreadSpawner
{
    [ThreadStatic]
    private static int parentThreadId;
    public static int ParentThreadId
    {
        get { return parentThreadId; }
    }

    private class ThreadInfo
    {
        public int ParentId;
        public Action Method;
    }

    private static void StartThread(object parameter)
    {
        var threadInfo = (ThreadInfo)parameter;
        parentThreadId = threadInfo.ParentId;
        threadInfo.Method();
    }

    public static void Spawn(Action start)
    {
        new Thread(StartThread).Start(
            new ThreadInfo { 
                 Method = start, 
                 ParentId = Thread.CurrentThread.ManagedThreadId 
            });
    }
}

// Usage:
ThreadSpawner.Spawn(MyMethod);

static void MyMethod() { 
    Console.WriteLine(ThreadSpawner.ParentThreadId);
} 
```

* * *

## 回答 #2

> 赞同：2
> 
>             
> 
> 时间：2009-05-24T15:39:04.833

更糟糕的是，创建 .NET 线程并不能保证获得本机线程，因此您也不能依赖于能够使用 P/Invoke 遍历线程父信息。

我知道如果您编写测试代码，您会看到本机线程，但不需要生成它，并且在某些难以猜测的情况下不会。

编辑：无论如何都无法通过 P/Invoke 获取线程父级。

# php - 页面加载后如何触发 Javascript 函数？

> ID：903959
> 
>         
> 
> 赞同：1
> 
>         
> 
> 时间：2009-05-24T15:09:58.333
> 
>         
> 
> 标签：php, javascript, html, events, onload

** 编辑 **

恐怕我的方向不对——问题不是我问的。Javascript 可以正常工作，它是 PHP 在第一次“运行”时没有显示我想要的内容 - 我仍然不确定为什么。抱歉有点浪费您的时间...

**

我有一个表单，它的字段中可能已经包含也可能不包含数据。如果用户到达表单并且他已经在系统中有一些数据，例如，他的 ID 号将出现在 ID 字段中 - 并且运行 onLoad 的 JavaScript 函数将禁用输入字段并更改其样式：

```
<body onload="runFunction()"> 
```

问题是它似乎在 PHP 完成它的部分之前运行，并且只有当我刷新页面时，JS 函数才会执行我想要它做的所有事情（它禁用并设置一些其他依赖于 PHP 条件的表单字段）。

有没有办法让这个 JS 函数在页面渲染后运行？我在关闭页面之前尝试运行它：

```
<body>
...
...
<script>
runFunction();
</script>
</body>
</html> 
```

但无济于事。

有任何想法吗？谢谢！

一些相关的 PHP 代码：[我删除了 id 属性以使阅读更容易]

```
<?php if ($h_phone != '' && $h_phone_pre != '') {  
echo "<td class=\"input\"><input type=\"text\" id=\"new_user_home_tel\" value=\"$h_phone\" size=\"8\" maxlength=\"7\" disabled=\"disabled\" /> -  
<select id=\"new_user_home_tel_pre\" disabled=\"disabled\">  
  <option value=\"$h_phone_pre\" selected=\"selected\"></option>";

     } else {

echo '<td class="input"><input type="text" id="new_user_home_tel" size="8" maxlength="7" /> -  
 <select id="new_user_home_tel_pre">  
   <option value=" " selected="selected"></option>';
    }?>  <option value="02">02</option>
     <option value="03">03</option>
     <option value="04">04</option>
     <option value="08">08</option>
     <option value="09">09</option>
</select> 
</td> 
```

如果字段不为空并且有效，则 Javascript 代码只会更改样式，但 PHP 仅在刷新后才有效。

* * *

## 回答 #1

> 赞同：5
> 
>             
> 
> 时间：2009-05-24T15:17:07.537

您的 Javascript 确实在页面加载后运行，问题出在其他地方。

一定是您的服务器在刷新前后发送了不同的 HTML。我建议，如果您保存第一次获得的页面来源，并将其与刷新后获得的来源进行比较。我敢打赌，您会发现其中的差异，并且会告诉您哪里出了问题。

* * *

## 回答 #2

> 赞同：2
> 
>             
> 
> 时间：2009-05-24T15:18:14.477

JQuery 做到了这一点。页面呈现后，以下内容中的任何内容都将执行：

```
$(document).ready(function() {
  //Call your function here
}); 
```

* * *

## 回答 #3

> 赞同：0
> 
>             
> 
> 时间：2009-05-24T15:19:23.773

尝试“延迟”属性。

* * *

## 回答 #4

> 赞同：0
> 
>             
> 
> 时间：2009-05-24T15:27:24.070

一种方法是在 PHP 中输​​出缓冲页面。这意味着生成的所有内容都会进入内存，直到脚本完成运行，然后立即全部发送出去。

看看[http://uk.php.net/ob_start](http://uk.php.net/ob_start)

* * *

## 回答 #5

> 赞同：0
> 
>             
> 
> 时间：2009-05-24T15:29:16.000

非 JS 库的答案是：

```
<script>
window.onload = function(){
 /* do stuff */
}
</script> 
```

然而，使用像 JQuery 这样的 JS 库将处理所有那些棘手的跨浏览器错误/问题。

您将`<script>`积木放在身体末端的权利。这提高了页面加载性能，因为浏览器在遇到阻塞时会`<script>`阻塞。

* * *

## 回答 #6

> 赞同：0
> 
>             
> 
> 时间：2009-05-24T16:21:06.733

绝对是 hacky，但您总是可以在表单下方放置一个 2x2 透明图像并使用它的 onLoad 运行该函数。我对有条件包含的文件做了类似的事情，因此在不包含文件的情况下没有错误。

* * *

## 回答 #7

> 赞同：0
> 
>             
> 
> 时间：2009-05-24T16:35:09.867

我建议您将内容添加到输出变量中，然后在文件末尾回显它。前任：

```
...
$output .= '<body onload="runFunction();">';
while(...)
{
   $output .= '...';
}
$output .= '</body>';
...
echo $output; 
```

* * *

## 回答 #8

> 赞同：0
> 
>             
> 
> 时间：2009-05-25T13:35:27.000

恐怕我的方向不对——问题不是我问的。Javascript 可以正常工作，它是 PHP 在第一次“运行”时没有显示我想要的内容 - 我仍然不确定为什么。抱歉有点浪费您的时间...

* * *

## 回答 #9

> 赞同：0
> 
>             
> 
> 时间：2015-02-04T07:30:28.423

I know this is really late for this post, but the reason this isn't working is that PHP renders HTML and then you can't interact with it again (unless you can do some snazzy AJAX stuff). Point being that the JS works fine bc it is client side, PHP doesn't work bc it is server side. Hope that helps anyone else who comes here!

# ios - 如何判断 Cocoa Touch 设备是否可以拨打电话？

> ID：903961
> 
>         
> 
> 赞同：7
> 
>         
> 
> 时间：2009-05-24T15:10:30.767
> 
>         
> 
> 标签：ios, objective-c, cocoa-touch, url-scheme, ipod-touch

> **可能重复：**
> 
>   [iOS - 检测设备是否支持电话？](https://stackoverflow.com/questions/5094928/ios-detecting-whether-or-not-device-support-phone-calls)

我正在编写一个 iPhone 应用程序，它提供一个按钮来拨打电话号码。我正在使用如下代码以`tel:`通常的方式使用 URL 拨打号码：

```
NSURL* contactTelURL = [NSURL
                        URLWithString:[NSString
                                       stringWithFormat:@"tel:%@",
                                       contactTel]];
[[UIApplication sharedApplication] openURL:contactTelURL]; 
```

它在真正的 iPhone 上运行良好，但我只是在模拟器中收到“不支持的 URL”警报。可能这也会发生在 iPod Touch 上，尽管我还没有测试过。在不会拨打电话的设备上运行时删除按钮会很好。

有没有办法以编程方式检测 Cocoa Touch 设备是否可以拨打电话？

* * *

## 回答 #1

> 赞同：40
> 
>             
> 
> 时间：2010-08-27T09:35:21.950

[从我的 iPhone 应用程序拨打电话的](https://stackoverflow.com/questions/3282778/make-a-call-from-my-iphone-application)诺亚威瑟斯彭

> 模拟器不支持很多 iOS 的 URL 方案，包括用于电话、地图、Youtube 和 SMS 应用程序的 URL 方案。iPod touch 和 iPad 等不具备电话功能的设备也是如此。在通过 -openURL: 使用任何 URL 方案之前，您应该使用 -canOpenURL: 检查对该方案的支持，这将根据当前设备是否支持您正在使用的 URL 方案返回 YES 或 NO

因此查询`[[UIApplication sharedApplication] canOpenURL:[NSURL URLWithString:@"tel://"]]`
以了解设备是否可以拨打电话。

* * *

## 回答 #2

> 赞同：7
> 
>             
> 
> 时间：2009-05-24T21:10:31.680

来自[iphonedevelopment.blogspot.com](http://iphonedevelopment.blogspot.com/2009/05/device-detection.html)

```
#import <sys/utsname.h>

enum {
    MODEL_IPHONE_SIMULATOR,
    MODEL_IPOD_TOUCH,
    MODEL_IPHONE,
    MODEL_IPHONE_3G
};

@interface DeviceDetection : NSObject

+ (uint) detectDevice;
+ (NSString *) returnDeviceName:(BOOL)ignoreSimulator;

@end

@implementation DeviceDetection

+ (uint) detectDevice {
    NSString *model= [[UIDevice currentDevice] model];

    // Some iPod Touch return "iPod Touch", others just "iPod"

    NSString *iPodTouch = @"iPod Touch";
    NSString *iPodTouchLowerCase = @"iPod touch";
    NSString *iPodTouchShort = @"iPod";

    NSString *iPhoneSimulator = @"iPhone Simulator";

    uint detected;

    if ([model compare:iPhoneSimulator] == NSOrderedSame) {
        // iPhone simulator
        detected = MODEL_IPHONE_SIMULATOR;
    } else if ([model compare:iPodTouch] == NSOrderedSame) {
        // iPod Touch
        detected = MODEL_IPOD_TOUCH;
    } else if ([model compare:iPodTouchLowerCase] == NSOrderedSame) {
        // iPod Touch
        detected = MODEL_IPOD_TOUCH;
    } else if ([model compare:iPodTouchShort] == NSOrderedSame) {
        // iPod Touch
        detected = MODEL_IPOD_TOUCH;
    } else {
        // Could be an iPhone V1 or iPhone 3G (model should be "iPhone")
        struct utsname u;

        // u.machine could be "i386" for the simulator, "iPod1,1" on iPod Touch, "iPhone1,1" on iPhone V1 & "iPhone1,2" on iPhone3G

        uname(&u);

        if (!strcmp(u.machine, "iPhone1,1")) {
            detected = MODEL_IPHONE;
        } else {
            detected = MODEL_IPHONE_3G;
        }
    }
    return detected;
}

+ (NSString *) returnDeviceName:(BOOL)ignoreSimulator {
    NSString *returnValue = @"Unknown";

    switch ([DeviceDetection detectDevice]) {
        case MODEL_IPHONE_SIMULATOR:
            if (ignoreSimulator) {
                returnValue = @"iPhone 3G";
            } else {
                returnValue = @"iPhone Simulator";
            }
            break;
        case MODEL_IPOD_TOUCH:
            returnValue = @"iPod Touch";
            break;
        case MODEL_IPHONE:
            returnValue = @"iPhone";
            break;
        case MODEL_IPHONE_3G:
            returnValue = @"iPhone 3G";
            break;
        default:
            break;
    }        
    return returnValue;
}

@end 
```

* * *

## 回答 #3

> 赞同：0
> 
>             
> 
> 时间：2011-04-12T04:56:10.920

这是我用来检查设备型号是手机而不是模拟器的简单代码片段，以确保它可以拨打电话。

```
if ([[[UIDevice currentDevice] model] rangeOfString:@"Phone"].location != NSNotFound &&
    [[[UIDevice currentDevice] model] rangeOfString:@"Simulator"].location == NSNotFound ) {
            [[UIApplication sharedApplication] openURL:[NSURL URLWithString:[NSString stringWithFormat:@"tel:%@", number]  ] ];
} 
```

* * *

## 回答 #4

> 赞同：-1
> 
>             
> 
> 时间：2009-05-24T15:32:09.443

您可以查询`[[UIDevice currentDevice] model]`，并检查它是否是 iPhone。

# git - 如果 current = base = other，为什么“git-merge-file current base other”会创建一个空的“current”文件？

> ID：903966
> 
>         
> 
> 赞同：2
> 
>         
> 
> 时间：2009-05-24T15:12:48.297
> 
>         
> 
> 标签：git, merge

好吧，想象一下 current.txt 文件：

```
asdf 
```

base.txt 文件：

```
asdf 
```

其他.txt 文件：

```
asdf 
```

当我进行三向合并时

```
git merge-file current.txt base.txt other.txt 
```

current.txt 文件变空，为什么？在其他情况下 current.txt 文件成为 3 个文件的合并

* * *

## 回答 #1

> 赞同：3
> 
>             
> 
> 时间：2009-05-24T23:41:29.910

这可能是 中的一个错误`git merge-file`，但在实践中并不是每个都会触发的。

`git merge-file`不是针对最终用户使用的命令，而是由 git 在内部用作合并或变基活动的一部分。它只会在实际发生更改的文件上调用，因此`git merge-file`在实践中不会发生将三个文件传递给所有具有相同内容的文件。

编辑：我提出了一个补丁来解决这个问题，虽然它需要专家审查：[gmane 链接](http://thread.gmane.org/gmane.comp.version-control.git/119879/focus=119880)

编辑：这个错误将在 v1.6.3.2 和更高版本的 git 中修复。

* * *

## 回答 #2

> 赞同：0
> 
>             
> 
> 时间：2009-05-24T19:19:24.353

对我来说，这听起来像是 git-merge-file 中的错误。你应该在 git 邮件列表上问这个问题。我认为您可能会在那里得到更好的答案。监视该列表的人非常敏锐，并且会知道这是否是预期的行为。

# c - 如何正确使我的 makefile 编译和运行？

> ID：903967
> 
>         
> 
> 赞同：20
> 
>         
> 
> 时间：2009-05-24T15:12:55.923
> 
>         
> 
> 标签：c, makefile, signals

这个问题可能不是描述我的问题的最佳问题，但我想不出更好的问题。我的makefile是这样的：

```
PROGRAM_NAME = prog

OBJECT_FILES = $(PROGRAM_NAME).o
CFLAGS = -O2 -Wall -g

$(PROGRAM_NAME) : $(OBJECT_FILES)
    gcc $(CFLAGS) -o $@ $(OBJECT_FILES)

$(PROGRAM_NAME).o : $(PROGRAM_NAME).c data.h
    gcc $(CFLAGS) -c $<

clean :
    $(RM) $(PROGRAM_NAME)
    $(RM) $(OBJECT_FILES)
    $(RM) *~ *.bak

run :
    @$(MAKE) && ./$(PROGRAM_NAME) $(ARGS) 
```

当我想编译和运行时，我只需要“make run”。问题是我的程序处理由 Ctrl+Z 产生的信号，如果我用“make run”启动程序，信号将被发送到“make run”而不是我的程序本身。

基本上，调用“make run”与直接调用“make && ./prog”不同，因为在第一种情况下，“make run”不会终止，除非“prog”首先终止。

有没有解决的办法？

* * *

## 回答 #1

> 赞同：19
> 
>             
> 
> 时间：2009-05-24T16:37:03.657

你可以简化你的“运行”目标，让它取决于你的程序是否是最新的，然后简单地运行程序：

```
run:    ${PROGRAM_NAME}
        ./${PROGRAM} ${ARGS} 
```

`make`当你已经在跑步时，跑步没有多大意义`make`——至少在这种情况下不是这样。也许对于递归操作（在不同的目录中），但请参阅' [Recursive Make Considered Harmful](http://miller.emu.id.au/pmiller/books/rmch/) '。

此外，您的 makefile 通常应该提供一个目标 ' `all`'，它通常应该是第一个目标，因此是默认目标。

* * *

## 回答 #2

> 赞同：17
> 
>             
> 
> 时间：2009-05-24T15:36:05.413

从 makefile 运行有点不寻常。您是否正在尝试复制某些 IDE 提供的“编译并运行”菜单项？Make 不具备这样做的能力。

目标命令中发生的所有事情都发生在不直接连接到终端的子进程中，这就是 make 接收您的击键的原因。

另一件要注意的事情：通常目标文件到可执行阶段（链接）使用一组不同的标志（`LDFLAGS`和`LIBS`）然后是编译阶段。在这个简单的示例中，您可以侥幸成功，但是如果您复制此 makefile 以用于更复杂的情况，您将遇到麻烦。

* * *

## 回答 #3

> 赞同：4
> 
>             
> 
> 时间：2013-03-08T04:14:10.087

If you're going to build and run over and over, You can use the `history` command to help with this:

```
# Run this once
make && ./foo

# Repeat last command
!! 
```

* * *

## 回答 #4

> 赞同：3
> 
>             
> 
> 时间：2009-05-24T16:04:47.530

正如 dmckee 的回答所说， make(1) 正在制作一些东西，而不是用于编译和运行。

当然，没有什么能阻止你创建一个**shell**别名*make-run*来执行预期的 ' *make && ./prog args* '。

* * *

## 回答 #5

> 赞同：2
> 
>             
> 
> 时间：2019-08-06T08:02:25.887

你可以这样尝试：

```
APP      = olupxtest

SRCS     = $(wildcard *.cpp)
OBJS     = $(SRCS:.cpp=.o)

CXXFLAGS = -g -fPIC -c
LDFLAGS  =
LIBS     =

.PHONY: all clean

all: clean $(APP) run

$(APP): $(OBJS)
        $(CXX) $(LDFLAGS) $^ $(LIBS) -o $@

clean:
        $(RM) $(OBJS) $(APP)

run:    ${APP}
        ./${APP} ${ARGS} 
```

在这里，您为目标调用了多个规则：`all: clean $(APP) run`

# scheme - 如何使用 MIT-Scheme 执行 .scm 脚本（在 REPL 之外）？

> ID：903968
> 
>         
> 
> 赞同：51
> 
>         
> 
> 时间：2009-05-24T15:13:12.413
> 
>         
> 
> 标签：scheme, mit-scheme

我想输入类似“scheme file.scm”之类的东西并让它解释文件，然后带我回到我的 shell，而不是在 REPL 中加载它。

编辑：我尝试了scheme < test.scm，它仍然使用REPL，唯一的区别是当流结束时scheme退出。  

* * *

## 回答 #1

> 赞同：45
> 
>             
> 
> 时间：2009-05-24T15:20:22.837

`scheme < file.scm`应该可以工作（只要您不指定`--interactive`并且 stdin 不是终端，方案以非交互方式工作）。

* * *

## 回答 #2

> 赞同：17
> 
>             
> 
> 时间：2017-12-09T02:54:37.303

要使用 MIT 方案运行方案程序：

```
scheme --quiet < program.scm 
```

该`--quiet`选项确保程序的输出是唯一显示的内容（即，根据您的要求，您不会看到 REPL）。

**警告**：如果您的程序提示用户使用输入过程（例如`read`、`read-char`、`read-line`等）进行输入，这将不起作用。这是因为 shell 输入重定向 ( `<`)（请参阅：[相关问题](https://stackoverflow.com/questions/57837383/how-to-use-read-correctly-in-mit-scheme)）。不幸的是，当使用输入过程时，目前没有从命令行执行 MIT Scheme 脚本的正确方法。最好的选择可能是`mit-scheme --quiet --load 'myscript'`，但是当脚本完成时您必须手动退出 MIT 方案。相关邮件列表线程：[[MIT-Scheme-devel] 如何运行脚本并退出？](https://lists.gnu.org/archive/html/mit-scheme-devel/2019-09/msg00000.html)

编辑：由于您可能会误输入`<`as `>`，从而导致源代码被覆盖，我建议将上述命令封装在 shell 脚本或 shell 函数中。例如：

```
runscheme () {
    scheme --quiet < "$1"
} 
```

然后你就可以运行`runscheme program.scm`而不必担心你的源代码会被覆盖。（特别感谢[Paul Rooney](https://stackoverflow.com/users/1540468/)让我注意到这个潜在的错误）。

### 参考

`scheme --help`：

> --batch-mode, --quiet, --silent
> 
>   
>   
> 
> 抑制版本和版权的启动报告，以及告别。

这个命令行选项似乎被错误地从[文档中的命令行选项列表中](https://www.gnu.org/software/mit-scheme/documentation/mit-scheme-user/Command_002dLine-Options.html)省略了，但我认为这是一个合法的命令行选项，因为`scheme --help`它显示了它，并且因为`--batch-mode`在参考手册的其他部分中使用（例如[这里](https://www.gnu.org/software/mit-scheme/documentation/mit-scheme-ffi/Compiling-and-Linking.html)） .

* * *

## 回答 #3

> 赞同：7
> 
>             
> 
> 时间：2011-04-13T09:21:23.930

我想你想要的是单片机。您可以像这样执行 .scm 脚本：

`$ scm -f foo.scm arg1 arg2 arg3`

有关详细信息，请参阅[http://people.csail.mit.edu/jaffer/scm_3.html#SEC28 。](http://people.csail.mit.edu/jaffer/scm_3.html#SEC28)

SCM 主页： http: [//people.csail.mit.edu/jaffer/SCM](http://people.csail.mit.edu/jaffer/SCM)

* * *

## 回答 #4

> 赞同：0
> 
>             
> 
> 时间：2017-12-21T19:57:31.103

检查`chez --help`，然后我发现了这个（假设我使用的是 chez 方案）：

```
chez --script ./temp.scm 
```

另外，`--verbose`非常有用：

```
chez --verbose --script ./temp.scm 
```

# c# - 从 WCF 中的通用合同继承

> ID：903977
> 
>         
> 
> 赞同：7
> 
>         
> 
> 时间：2009-05-24T15:18:34.213
> 
>         
> 
> 标签：c#, wcf, generics

更多 WCF 问题... :)

我所有的工作流程都实现了相同的 3 种方法。经过大量的复制和粘贴，我决定让它们继承同一个接口：

```
[ServiceContract(Namespace = "http://schema.company.com/messages/")]
public interface IBasicContract<TRequest, TResponse>
  where TRequest : class
  where TResponse : class
{
  [OperationContract(Name = "GetReport",
    Action = "http://schema.company.com/messages/GetReport",
    ReplyAction = "http://schema.company.com/messages/GetReportResponse")]
  TResponse GetReport(TRequest inquiry);

  [OperationContract(Name = "GetRawReport",
    Action = "http://schema.company.com/messages/GetRawReport",
    ReplyAction = "http://schema.company.com/messages/GetRawReportResponse")]
  string GetRawReport(string guid);

  [OperationContract(Name = "GetArchiveReport",
    Action = "http://schema.company.com/messages/GetArchiveReport",
    ReplyAction = "http://schema.company.com/messages/GetArchiveReportResponse")]
  TResponse GetArchiveReport(string guid);
} 
```

我还决定创建服务客户端的通用实现：

```
public class BasicSvcClient<TRequest, TResponse> : ClientBase<IBasicContract<TRequest, TResponse>>, IBasicContract<TRequest, TResponse>
  where TRequest : class
  where TResponse : class
{
  public BasicSvcClient()
  {
  }

  public BasicSvcClient(string endpointConfigurationName) :
    base(endpointConfigurationName)
  {
  }

  public BasicSvcClient(string endpointConfigurationName, string remoteAddress) :
    base(endpointConfigurationName, remoteAddress)
  {
  }

  public BasicSvcClient(string endpointConfigurationName, EndpointAddress remoteAddress) :
    base(endpointConfigurationName, remoteAddress)
  {
  }

  public BasicSvcClient(Binding binding, EndpointAddress remoteAddress) :
    base(binding, remoteAddress)
  {
  }

  public TResponse GetReport(TRequest inquiry)
  {
    return Channel.GetReport(inquiry);
  }

  public string GetRawReport(string guid)
  {
    return Channel.GetRawReport(guid);
  }

  public TResponse GetArchiveReport(string guid)
  {
    return Channel.GetArchiveReport(guid);
  }
} 
```

问题是当我尝试使用它时：

```
using (var client = new BasicSvcClient<TRequest, TResponse>())
{
  var response = client.GetReport(inquiry);

  context.Response.ContentType = "text/xml";
  context.Response.Write(response.AsXML());
} 
```

我总是收到一个错误，说它找不到合同 IBasicContract 的配置，在 .NET 使用的奇怪语法中：

> 找不到引用合同“BasicWorkflow.IBasicContract”2 的默认端点元素...

我试过这样做：

```
using (var client = new BasicSvcClient<TRequest, TResponse>("myConfig")) 
```

它没有帮助 - 它仍在寻找那个特定的合同。

我知道 ServiceContract 属性有一个 ConfigurationName 参数，但我不能在编译时使用它，因为我有*许多*从同一个程序调用的工作流（因此有许多配置条目）。有没有办法在运行时设置 ConfigurationName？我认为这是 ClientBase 构造函数应该做的，但显然不是。

[编辑] 这是 .config 文件中的端点，我认为在这种情况下它不是很有帮助：

```
<endpoint address="https://localhost/services/Contract.svc"
    binding="basicHttpBinding"
    bindingConfiguration="httpsDataEndpoint"
    contract="IContract" name="IContractSvc" /> 
```

[Edit2] 好的...我找到了一种可行的方法，尽管我仍然对此并不完全满意：

```
using (var wf = new BasicSvcClient<TRequest, TResponse>(
  new BasicHttpBinding("httpsDataEndpoint"),
  new EndpointAddress("https://localhost/services/Contract.svc"))) 
```

我现在唯一的问题是我更愿意从 .config 文件中检索端点地址（使用实际的合同名称，如 IContract）。有谁能帮我完成那部分吗？

[Edit3] 终于找到了完整的解决方案 :) Reflector 万岁！

```
var cf = (ClientSection) ConfigurationManager.GetSection("system.serviceModel/client");
foreach (ChannelEndpointElement endpoint in cf.Endpoints)
{
  if (endpoint.Name != "ContractSvc")
    continue;

  using (var wf = new BasicSvcClient<TRequest, TResponse>(
    new BasicHttpBinding("httpsDataEndpoint"),
    new EndpointAddress(endpoint.Address.ToString())))
  {
      //... call wf.GetReport()
  }
  break;
} 
```

* * *

## 回答 #1

> 赞同：3
> 
>             
> 
> 时间：2009-05-24T16:53:30.953

“.NET 使用的那种奇怪的语法”实际上是绑定到特定类型的泛型类型在运行时的类型名称。Typename`n[[Type],...] 其中 n 表示泛型类型中包含的类型参数的数量。

您的端点配置如何？

* * *

## 回答 #2

> 赞同：1
> 
>             
> 
> 时间：2009-05-24T20:57:24.813

为什么不在 ServiceContract 属性中为合同指定名称：

```
[
ServiceContract
   (
    Namespace = "http://schema.company.com/messages/", 
    Name="MyBasicContract"
    )
] 
```

如果您没有明确指定名称，它将默认为“.NET 使用的奇怪语法”中接口的限定名称。

* * *

## 回答 #3

> 赞同：0
> 
>             
> 
> 时间：2009-05-26T19:24:15.130

如果要使用 IBasicContract 之类的服务合同，则必须使用在配置文件中定义泛型类型的标准方法

它是这样写在配置文件中的：IBasicContract`2[TRequest,TResponse]

我也在我的博客 (www.lybecker.com/blog/) 上回复了你的问题。

:-) 安德斯·莱贝克尔

# ruby-on-rails - RESTful 身份验证：尝试对基于 cookie 的身份验证进行简单重定向时遇到困难

> ID：903984
> 
>         
> 
> 赞同：3
> 
>         
> 
> 时间：2009-05-24T15:21:38.013
> 
>         
> 
> 标签：ruby-on-rails, cookies, routing, restful-authentication

我有一个使用 RESTful 身份验证插件的 RoR 应用程序。一切都很好。我最近启用了基于 cookie 的身份验证，并且效果也很好。问题是当用户使用 cookie 进行身份验证时，我想更改默认登录页面。我希望将经过 cookie 身份验证的用户重定向到从登录表单成功登录后重定向到的同一页面。它们始终被定向到原始请求 URL。我正在为此绞尽脑汁，因为我认为我理解它是如何工作的，而且我所做的每一个改变似乎都没有影响。

我怀疑这很简单，但我显然错过了它。如果您提供任何反馈、指导或建议，我将不胜感激。

* * *

## 回答 #1

> 赞同：1
> 
>             
> 
> 时间：2009-05-24T17:44:11.620

我解决了这个问题，但在我看来它有点难看。这就是我所做的。

在 cookie 身份验证方法中，我设置了一个会话变量，指示使用了 cookie 登录方法。

```
def login_from_cookie
  user = cookies[:auth_token] && User.find_by_remember_token(cookies[:auth_token])
  if user && user.remember_token?
    session[:cookie_login] = true   **# this is my addition**
    self.current_user = user
    handle_remember_cookie! false # freshen cookie token (keeping date)
    self.current_user
  end
end 
```

然后在 :`before_filter set_current_user`我只是检查该变量并重定向是否已设置确保将变量设置为 nil。

```
def set_current_user
  Authorization.current_user = current_user
  if session[:cookie_login] 
    redirect_to :controller => :users, :action => :search
    session[:cookie_login] = false
  end
end 
```

它不漂亮，但它确实有效。我绝对愿意接受有关如何清理它的任何建议。

* * *

## 回答 #2

> 赞同：0
> 
>             
> 
> 时间：2009-11-20T13:26:38.267

你不能只设置你的路线，这样

```
map.root :controller => :users, :action => :search 
```

然后有一个 before_filter 来检查以确保设置了一些“登录”参数？只需在用户登录时设置此参数，无论是通过 cookie 还是通过正常方式。然后，无论是cookie认证还是普通认证，都会转到默认页面。也许我误解了这个问题。

* * *

## 回答 #3

> 赞同：0
> 
>             
> 
> 时间：2009-05-24T15:30:36.823

您可以在成功登录后将此行添加到会话控制器：

```
redirect_to :controller => 'dashboard', :action => 'index' 
```

* * *

## 回答 #4

> 赞同：0
> 
>             
> 
> 时间：2009-05-24T16:31:14.457

我正在使用 Bort，所以也许这不是它`Restful_Authentication`本身的一部分，但是会话控制器中有一个`successful_login`方法使用这个 restful_auth 方法：

```
redirect_back_or_default( root_path ) 
```

这是在定义`authenticated_system.rb`

```
 def redirect_back_or_default(default)
      redirect_to(session[:return_to] || default)
      session[:return_to] = nil
    end 
```

* * *

## 回答 #5

> 赞同：0
> 
>             
> 
> 时间：2009-11-25T21:05:23.557

Restful Authentication 存储发出请求时尝试访问的原始 URL。您所要做的就是阻止它存储该值或在执行 cookie 身份验证时清除该值，然后用户将被重定向回您的默认页面。

我可能会在 authenticated_system.rb 中这样做

```
 def login_from_cookie
  user = cookies[:auth_token] && User.find_by_remember_token(cookies[:auth_token])
  if user && user.remember_token?
    self.current_user = user
    session[:return_to] = nil # This clears out the return value so the user will get redirected to the default path
    handle_remember_cookie! false # freshen cookie token (keeping date)
    self.current_user
  end
end 
```

是 session[:return_to] = nil

然后只需确保您已在会话控制器中设置了默认路径，您就应该一切就绪。会话控制器中的代码应该是这样的：

```
redirect_back_or_default(the_path_you_want_to_send_them_to) 
```

# html - html/css 中奇怪的边框间距

> ID：903990
> 
>         
> 
> 赞同：2
> 
>         
> 
> 时间：2009-05-24T15:25:02.170
> 
>         
> 
> 标签：html, css, spacing

我正在尝试创建一个带有粗边框的水平菜单，该菜单显示在悬停的项目上。但是，由于某种原因，在 Firefox 和 Chrome 中，栏的右端有一个小间隙。奇怪的是，IE 没有间隙地显示它。Firebug 没有说明造成这种差距的任何原因。

我尝试使用简单的 div，但它仍然出现。我将它提炼成一个 HTML 示例，仅包含 div。

谁能解释一下并告诉我如何摆脱这个差距？

```
<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Strict//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml" >
<head>
    <title>Weird border spacing</title>
    <style type="text/css">
    div.outer
    {
        border-top: dotted 1px lime;
        margin: 10px;
    }

    div.outer div
    {
        display: inline;
        margin: 0;
        padding: 0 12px;
        border-left: solid 1px silver;
        border-top: solid 3px red;
    }        
    </style>
</head>
<body>
    <div class="outer">
        <div>First</div>
        <div>Second</div>
        <div>Third</div>
    </div>
</body>
</html> 
```

* * *

## 回答 #1

> 赞同：2
> 
>             
> 
> 时间：2009-05-24T15:51:57.627

我将内部 div 向左浮动，它固定了奇怪的间距，而外部 div 向左浮动，迫使内部 div 位于其中。您可以更多地调整样式以满足您的需求。

```
div.outer{border-top: 1px dotted lime;margin: 10px;float:left;}
div.outer div
{
    float:left;
    margin: 0;
    padding: 0 12px;
    border-left: 1px solid silver;
    border-top: 3px solid red;
} 
```

您还可以删除 div 之间的新行以仅修复空格。

* * *

## 回答 #2

> 赞同：1
> 
>             
> 
> 时间：2009-05-24T15:30:12.737

`display:inline`很少能很好地工作。考虑`float:left`改用。

* * *

## 回答 #3

> 赞同：0
> 
>             
> 
> 时间：2009-05-24T15:30:53.297

尝试添加：

```
body {
    margin: 0;
    padding: 0;
} 
```

浏览器对这些 CSS 属性有不同的默认值。

* * *

## 回答 #4

> 赞同：0
> 
>             
> 
> 时间：2009-05-24T15:36:21.373

`display: inline-block`选择器的声明`div.outer div`可能是您想要的。

* * *

## 回答 #5

> 赞同：0
> 
>             
> 
> 时间：2009-05-24T15:49:46.457

间隙是由`<div>`. 要解决此问题，请将所有`<div>`内容放在同一行上，它们之间没有空格。但是我建议重新考虑css，可能使用列表`<ul>`

* * *

## 回答 #6

> 赞同：0
> 
>             
> 
> 时间：2009-05-24T15:59:59.700

您获得空间的原因是由于内联元素将空间解释为要渲染的东西。这让您可以：

你好世界

并且仍然有2个单独的单词。要删除空间，您必须......好吧，删除空间。如前所述，当您尝试将元素齐平地放在一起进行布局时，使用 float: left 是首选选项。

# mysql - Delphi 2009、MyDAC 和关系数据库

> ID：903993
> 
>         
> 
> 赞同：2
> 
>         
> 
> 时间：2009-05-24T15:26:02.433
> 
>         
> 
> 标签：mysql, database, delphi, delphi-2009, mydac

关于在 Delphi 2009 和 MyDAC 中使用关系数据库概念，我有一个相当大的问题。

我有一个看起来像下面这样的数据库结构：

* * *

## 物品

*   ID   

*   姓名

* * *

## 贮存

*   ID

*   姓名

* * *

## 存储物品

*   ID

*   item_id

*   storage_id

*   地方

* * *

现在，当我有一个来自“项目”的活动数据集时，如何在例如 DBGrid 中显示所有关联的存储？

顺便说一句：最好不要在每个表中使用“id”，而是更改它并使用例如“id_item”或“id_storage”之类的东西？

先感谢您 ：）

* * *

## 回答 #1

> 赞同：2
> 
>             
> 
> 时间：2009-05-24T16:33:30.167

*   使用 StorageItem，您创建了

    多对多关系。如果您

    只需要一对多（许多存储与一个项目相关，但您

    不需要反之亦然），那么您可以将另一个字段添加到存储表 (item_id) 中，该字段将作为外键用于物品表。然后在 Storage 表中的 item_id 上创建索引，并以

    主从关系连接两个表。

*   如果您确实需要多对多，那么您可以使用 SQL 添加一个查询组件

    （从 StorageItem 中选择 *，其中

    item_id := :current_storage_id），而 current_storage_id 是您的查询

    参数。

* * *

## 回答 #2

> 赞同：1
> 
>             
> 
> 时间：2009-05-24T16:30:38.170

我个人对 MyDAC 并不熟悉，但大多数数据集组件都有某种方式来建立主从关系。检查您的数据集上是否有 MasterSource 属性，或以某种类似方式将详细数据集链接到主数据集。如果没有，您可以使用 TDatasetField 建立链接，并过滤嵌套数据集以仅显示正确的记录。

至于 ID 列名称，最好为每个字段指定一个描述性名称，这样您就可以通过查看代码来判断您的链接是否正确。如果您将 id 列称为“id”，那可能是任何 id 列，如果您开始传递对数据集的引用，这可能会让人感到困惑。但是，如果`item_id`每次都调用它（不是`item_id`有时和`id_item`有时），那么你总是知道你在看什么。它也使您更容易知道您的代码是正确的。显示“”的过滤器`master.item_id = detail.item_id`更容易阅读“master.id = detail.item_id”。`master`例如，如果分配给错误的数据集，这可能是错误的并且静默失败。

* * *

## 回答 #3

> 赞同：1
> 
>             
> 
> 时间：2009-05-24T16:41:21.403

```
Select a.ID, b.Name, a.Place
from StorageItem a
inner join Storage b
on (a.id = b.id) 
```

上面的查询将返回 StorageItem 表中的所有项目及其名称，现在如果您想过滤它以仅返回特定项目的项目添加 where 子句就像

```
Select a.ID, b.Name, a.Place
from StorageItem a
inner join Storage b
on (a.id = b.id)
where a.item_id = 1 -- place the item id here 
```

您可以将 where 与参数一起使用，例如：

```
MyQuery.Sql.Text := ' Select a.ID, b.Name, a.Place from StorageItem a
+ ' inner join Storage b on (a.id = b.id) '
+ ' where a.item_id = :ItemNo ';
MyQuery.ParamByName('ItemNo').asInteger := 1;
MyQuery.Open; 
```

并将上面的查询分配给 dbGrid

您也可以使用 MasterSource 属性来建立关系而不使用“where”部分

# sharepoint - sharepoint 的功能是什么？

> ID：903994
> 
>         
> 
> 赞同：7
> 
>         
> 
> 时间：2009-05-24T15:26:38.017
> 
>         
> 
> 标签：sharepoint

...“功能”的基本组件（所需的文件）是什么...任何人都可以指出任何有关创建功能的最佳实践教程（使用“12 hive”）...

sharepoint dev 对我来说是新的，我只是在寻找最佳实践开发。教程/截屏将是一个奖励

谢谢

* * *

## 回答 #1

> 赞同：13
> 
>             
> 
> 时间：2009-05-24T16:33:21.133

严重的头痛，离婚的理由，谋杀的合理借口等......

但实际上答案要复杂得多。快速的回答是它是一个部署单元，通常包括诸如 .aspx 应用程序页面、列表模式、以 CAML 表示的自定义内容（可能是没有太多文档的巨大 XML 文件）等内容。

JD 对 Ted Pattison 的书的建议是一本好书，但我建议选择几本书，因为您通常会在一本书中找到一些在另一本书中找不到的东西，它会帮助您了解惯例要求什么以及什么是只是特定作者的偏好。

在熟悉这些概念之前，您确实需要梳理大量不同的来源并计划在 SharePoint 上花费大量时间。

* * *

## 回答 #2

> 赞同：3
> 
>             
> 
> 时间：2009-05-24T16:28:54.393

[在此处](http://www.codeplex.com/spg)  和[此处](http://msdn.microsoft.com/en-us/library/dd203468.aspx)查看 SharePoint 模式和实践信息

我还强烈推荐阅读 Ted Pattisons 的《[Inside SharePoint Windows Services 3.0 》一书](https://rads.stackoverflow.com/amzn/click/com/0735623201)

这些应该是新手 SharePoint 开发人员必读的内容。祝您的 SharePoint 之旅好运。

* * *

## 回答 #3

> 赞同：1
> 
>             
> 
> 时间：2009-05-24T16:13:29.450

这个关于如何向 Sharepoint 添加社交网络功能的网络广播可能会有所帮助[。](http://www.asp.net/learn/webcasts/webcast-327.aspx)

[这里](http://www.sharepoint-videos.com/)有很多视频，有些是免费的，有些不是。

* * *

## 回答 #4

> 赞同：0
> 
>             
> 
> 时间：2009-05-26T04:30:38.420

如果您希望该功能实际执行某些操作，则您需要的最低限度是 feature.xml 和 elements.xml。我推荐 WSPBuilder 的模板作为起点。

# sql - 高级（？）SQL 连接？

> ID：903996
> 
>         
> 
> 赞同：1
> 
>         
> 
> 时间：2009-05-24T15:28:32.350
> 
>         
> 
> 标签：sql, sql-server, tsql, join

我对如何解释这一点有点迷茫，所以我将尝试给出一些表（+数据）的示例，然后是我所追求的结果（我的所有表列都不是 NULL）：

```
Table: Customers

Id int primary key
Name varchar(250)

Table: Stats (Date, CustomerId is the primary key)

Date (date)
CustomerId (int) - foreign key to Customers table
Earning (money)

Table: Bonus

Id int primary key
CustomerId int - foreign key to Customers table
Date date
Amount money

Table: Payments

Id int primary key
DateFrom date,
DateTo date,
CustomerId bigint - foreign key to Customers table

Table: CampaignPayment

Id int primary key
PaymentId int - foreign key to payments table
Quantity int
UnitPrice money

Table: BonusPayment

Id int primary key
PaymentId int - foreign key to payments table
Amount money 
```

这里的想法是，每当客户做一些应该为他们赚钱的事情时，它都会进入统计表。客户还可以获得进入奖金表的不同类型的奖金。每隔一段时间，我需要为客户创建一张发票（付款表），它将在指定时间段内列出统计表 + 奖金表中的内容，并将生成发票（即付款表定义发票的人是为，哪个时期和活动支付和奖金支付表定义了支付的内容和原因）。

现在 - 我需要能够将所有这些表连接起来才能获得以下输出：

```
CustomerId | CustomerName | PaymentId | Amount | BonusAmount | DateFrom | DateTo 
```

Amount 是 CampaignPayment 表中的总金额 ( SUM(Quantity * UnitPrice) )，BonusAmount 是 BonusPayment 表中的总金额 ( SUM(Amount) )。DateFrom 和 DateTo 来自 Payments 表。

诀窍是，对于给定月份内的每个客户，如果该月的每一天都没有被覆盖，我想要一行包含以下数据：

```
CustomerId | CustomerName | NULL | (Stats.Earning - Amount Earned from possible payments within the month) | (Bonus.Amount - Amount Earned possible bonuses that is in payments within the month) | First day of month | Last day of month 
```

关于如何计算这些“空”行中的金额和奖金金额，我可能需要更多复杂的逻辑，但就目前而言，这就是我需要开始的。

我该怎么办？我知道如何完成“初始”位，但我将如何添加这些“空”行？我希望我足够详细地解释了这个问题，并且你可以在这里看到这个想法 - 如果没有让我知道，我会尝试进一步解释。

数据库是 MS SQL Server 2008。

编辑：另外，每个客户每月的“空”行也是可接受的解决方案。

* * *

## 回答 #1

> 赞同：1
> 
>             
> 
> 时间：2009-05-24T15:42:26.160

I'd make an auxiliary table with "every single day of that month" to ease identifying if "every single day of the month is not covered" (a somewhat ambiguous spec, but the aux table should help whether you mean "no day is covered" or "some days are not covered" and whether a day is considered "covered" if it has *either* a bonus or stats, or if it needs to have *both* to be considered "covered" -- these ambiguities are why I'm not going to even try and sketch the SQL using this aux table;-).  Then I'd `UNION` the "empty rows" to the "initial bit" that you already know how to get done -- seems a perfect task for UNION!-)******** 
```