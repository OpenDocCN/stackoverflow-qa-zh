# StackOverflow 问答 000259000-000259999

# c# - 电话号码规范化：任何预先存在的库？

> ID：259000
> 
> 赞同：20
> 
> 时间：2008-11-03T15:34:20.993
> 
> 标签：c#, .net, .net-2.0, normalization, phone-number

我有一个使用电话号码作为唯一标识符的系统。出于这个原因，我想在所有电话号码使用标准化格式时对其进行格式化。因为我无法控制我的源数据，所以我需要自己解析这些数字并格式化它们，然后再将它们添加到我的数据库中。

我即将编写一个可以读取电话号码并输出标准化电话格式的解析器，但在我这样做之前，我想知道是否有人知道我可以用来格式化电话号码的任何预先存在的库。

如果那里没有预先存在的库，那么在创建这个可能不明显的功能时我应该记住哪些事情？

虽然我的系统现在只处理美国号码，但我计划尝试包括对国际号码的支持以防万一，因为有可能需要它。

**编辑**我忘了提到我正在使用 C#.NET 2.0。

* * *

## 回答 #1

> 赞同：25
> 
> 时间：2012-02-04T02:08:24.270

你可以`libphonenumber`从谷歌使用。这是一篇博文：

[http://blog.appharbor.com/2012/02/03/net-phone-number-validation-with-google-libphonenumber](http://blog.appharbor.com/2012/02/03/net-phone-number-validation-with-google-libphonenumber)

解析数字就像安装[NuGet 包](http://nuget.org/packages/libphonenumber-csharp)然后执行以下操作一样简单：

```
var util = PhoneNumberUtil.GetInstance();
var number = util.Parse("555-555-5555", "US"); 
```

然后，您可以像这样格式化数字：

```
util.Format(number, PhoneNumberFormat.E164); 
```

`libphonenumber`支持 E.164 以外的多种格式。

* * *

## 回答 #2

> 赞同：5
> 
> 时间：2008-11-03T15:55:54.023

我目前参与了[OpenMoko](http://openmoko.org)项目，该项目正在开发一款完全开源的手机（包括硬件）。在规范电话号码方面遇到了很多麻烦。我不知道是否有人提出了一个好的解决方案。最大的问题似乎与美国电话号码有关，因为有时它们的前面带有 1，有时则没有。根据您在联系人列表中存储的内容，它可能会或可能不会正确显示来电显示信息。我建议去掉电话号码上的 1（尽管我希望大多数人一开始不会输入它）。您可能还需要在国际号码前面查找加号或国家代码。

您可以查看 OpenMoko 网站、邮件列表和源代码管理，看看他们是否已经解决了这个错误。

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2008-11-03T16:45:00.633

perl 和 rails 示例

* * *

[http://validates-as-phone.googlecode.com/svn/trunk/README](http://validates-as-phone.googlecode.com/svn/trunk/README)

[http://www.perlmonks.org/?node_id=159645](http://www.perlmonks.org/?node_id=159645)

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2008-11-03T15:40:16.083

只需去掉任何非数字，可能使用正则表达式：`[^\d]`

唯一的例外可能是如果您想处理分机号，以区分没有区号但具有 3 位分机号的号码，或者您需要处理国际号码。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2016-08-28T22:23:35.340

您需要的是所有国家/地区代码的列表，并开始将您的字符串前几个字符与国家/地区代码列表进行匹配，以确保它是正确的，然后对于其余的数字，确保它是所有数字和适当的长度，通常从 5 变化 - 10 位数。

要实现对国家代码的检查，请安装[NGeoNames nuget](https://github.com/RobThree/NGeoNames)，它使用网站[www.geonames.org](http://www.geonames.org)来获取所有国家代码列表以用于匹配它们。

# c# - 处理 DateTime 对象的 WCF 反序列化

> ID：259005
> 
> 赞同：6
> 
> 时间：2008-11-03T15:35:54.937
> 
> 标签：c#, wcf, datetime

我们有一个调度应用程序正在运行，它调用 WCF 服务来运行夜间作业。其中大量包括有关当前营业日期的信息。出于业务原因，调度服务器设置为 GMT，但我们的服务在设置为纽约时间的服务器上运行。

这带来了一个问题；日期将通过明确的时区信息传递给我们的 .NET 服务。因此，当服务告诉应用程序以“2008-11-03 00:00:00 +0:00”的日期运行时，服务会将其解释为“2008-11-02 19:00:00 -5:00” “而且事情的日期是错误的。

调度器行为是第三方硬编码的，所以我们不能告诉调度器忽略时区偏移。我们不想总是将日期转换为格林威治标准时间，因为我们的亚洲办事处很有可能会调用相同的服务，而我们将再次遇到同样的问题。

有没有办法标记 DataContract，甚至将其控制在足够低的级别以确保 DateTime Kind 是未指定的？或者有没有办法使用 DateTime 来确定用于创建它的原始信息是什么，并在后处理步骤中将其转换回原始值？

如果它有帮助，现在我们的合同相当简单。方法采用一个参数，该参数是从下面的类派生的类。

```
[DataContract]
public class BaseTimeSensitiveParameters
{
    [DataMember] public DateTime? BusinessDate;
} 
```

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2008-11-05T15:51:08.570

如果我正确理解了这个问题，您可以通过简单地`DateTime.ToUniversalTime()`在服务端使用来解决这个问题。对于您的示例，这应该为您提供一个值为“2008-11-03 00:00:00”且 Kind=DateTimeKind.Utc 的 DateTime。现在，如果您需要相同的值，但作为 Local 或 Unspecified，您可以`DateTime.SpecifyKind(DateTime, DateTimeKind)`在不更改值的情况下设置 Kind。

# event-driven-design - 对于 Windows 服务，这是一种不错的事件驱动方法吗？

> ID：259014
> 
> 赞同：3
> 
> 时间：2008-11-03T15:39:10.750
> 
> 标签：event-driven-design

我正在阅读事件驱动设计。在实践中，我很难理解其中的一些内容。我正在考虑将其用于监视、解析和处理来自第 3 方 TCP 流的信息的 Windows 服务。以下是一种体面的方法，还是我错过了什么？

我的计划是让主要服务成为事件的容器：

```
public class MyService
{                      

    public void RegisterAgent(ServiceAgent agent)
    {
        Log("Initializing agent " + agent);
        agent.Initialize(this);
        Log("Done intializing agent " + agent);
    }

    public void Log(string messageText)
    {
        OnSimpleLogEventLogged(this, new SimpleLogEventArgs(messageText));
    }

    protected void Raise<T>(EventHandler<T> eventHandler, object sender, T args) where T : EventArgs
    {
        var handler = eventHandler;
        if (handler == null) return;                       
        handler(sender, args);

    }

    public event EventHandler<SimpleLogEventArgs> SimpleLogEventLogged;
    protected void OnSimpleLogEventLogged(object sender, SimpleLogEventArgs args)
    {
        Raise(SimpleLogEventLogged, sender, args);
    }

    public event EventHandler<TextRecievedEventArgs > TextRecieved;
    public void OnTextRecieved(object sender, TextRecievedEventArgs args)
    {
        Raise(TextRecieved, sender, args);            
    }

    public event EventHandler<TextParsedEventArgs> TextParsed;
    public void OnTextParsed(object sender, TextParsedEventArgs args)
    {
        Raise(TextParsed, sender, args);            
    }

    ...
} 
```

然后，使用 MEF 或类似方法，我将注册“ServiceAgent”实例，这些实例仅处理和/或引发事件，可选择在后台线程上执行此操作。例如：

```
public class TextParsingAgent : ServiceAgent
{

    public override void Initialize(MyService service)
    {
        service.TextRecieved += TextRecieved;
        base.Initialize(service);
    }

    void TextRecieved(object sender, TextRecievedEventArgs e)
    {
        ThreadPool.QueueUserWorkItem(TextRecievedAsync, e);
    }

    private void TextRecieved(object state)
    {
        var e = (TextRecievedEventArgs)state;
        //TODO:Parse text into something meaningful and store in textParseEventArgs
        service.OnTextParsed(textParseEventArgs);
    }
} 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2008-11-06T14:20:22.077

如果该`Raise()`方法只是为了简化空值检查，您可能希望将事件处理程序初始化为非空值，而不是使用 lambda 表达式，如下所示：

```
public event EventHandler<TextParsedEventArgs> TextParsed = (sender, e) => { }; 
```

然后你可以`TextParsed(...)`在没有空检查的情况下调用，这可能会使代码更容易理解。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2008-11-03T16:14:41.427

我个人认为它对您的代码来说是一个相当不错的整体结构，它可以轻松地将逻辑单元分离到它们自己的操作中，并且通过通知服务之外，如果您以后需要设置不同的服务代理，它可以让您在未来具有良好的可扩展性。

# java - 每个浮点数都可以精确地表示为双精度数吗？

> ID：259015
> 
> 赞同：19
> 
> 时间：2008-11-03T15:39:40.747
> 
> 标签：java, floating-point

变量的每个可能值都可以在`float`变量中精确表示`double`吗？

换句话说，对于所有可能的值`X`，以下将是成功的：

```
float f1 = X;
double d = f1;
float f2 = (float)d;

if(f1 == f2)
  System.out.println("Success!");
else
  System.out.println("Failure!"); 
```

我的怀疑是没有例外，或者如果有它只是一个边缘情况（如 +/- 无穷大或 NaN）。

**编辑**：问题的原始措辞令人困惑（陈述了两种方式，一种会回答“否”，另一种会回答“是”以获得相同的答案）。我已对其进行了改写，使其与问题标题相匹配。

* * *

## 回答 #1

> 赞同：26
> 
> 时间：2008-11-03T18:27:44.590

是的。

通过列举所有可能的情况来证明：

```
public class TestDoubleFloat  {
    public static void main(String[] args) {
        for (long i = Integer.MIN_VALUE; i <= Integer.MAX_VALUE; i++) {
            float f1 = Float.intBitsToFloat((int) i);
            double d = (double) f1;
            float f2 = (float) d;
            if (f1 != f2) {
                if (Float.isNaN(f1) && Float.isNaN(f2)) {
                    continue; // ok, NaN
                }
                fail("oops: " + f1 + " != " + f2);
            }
        }
    }
} 
```

在我的机器上在 12 秒内完成。32 位*很小*。

* * *

## 回答 #2

> 赞同：5
> 
> 时间：2008-11-03T15:42:59.273

理论上，没有这样的值，所以“是的”，每个浮点数都应该可以表示为双精度浮点数。从浮点数转换为双精度数应该只涉及最后添加四个字节的 00——它们使用相同的格式，只是具有不同大小的字段。

* * *

## 回答 #3

> 赞同：5
> 
> 时间：2008-11-03T15:43:01.647

是的，浮点数是双精度数的子集。浮点数和双精度数都具有 (sign * a * 2^b) 形式。浮点数和双精度数的区别在于 a 和 b 中的位数。由于双精度数有更多可用位，因此将浮点值分配给双精度数实际上意味着插入额外的 0 位。

* * *

## 回答 #4

> 赞同：3
> 
> 时间：2008-11-03T15:45:49.970

正如每个人都已经说过的那样，“不”。但这实际上是对问题本身的“是”，即每个浮点数**都**可以精确地表示为双精度数。令人困惑。:)

* * *

## 回答 #5

> 赞同：3
> 
> 时间：2008-11-03T15:50:39.430

如果我正确阅读了[语言规范](http://java.sun.com/docs/books/jls/third_edition/html/typesValues.html#4.2.3)（并且其他所有人都在确认），那么就没有这样的价值。

也就是说，每个都声称只保留 IEEE 754 标准值，因此两者之间的转换应该不会引起任何变化，除非在给定的内存中。

（澄清：只要该值小到可以保存在浮点数中，就不会发生变化；显然，如果该值的位数太多而无法保存在浮点数中，那么从双精度数转换为浮点数会导致精度损失。）

* * *

## 回答 #6

> 赞同：1
> 
> 时间：2008-11-03T17:28:31.823

@KenG：这段代码：

```
float a = 0.1F
println "a=${a}"
double d = a
println "d=${d}" 
```

失败不是因为 0.1f 不能准确表示。问题是“是否有一个不能表示为双精度的浮点值”，这段代码没有证明这一点。虽然 0.1f 不能精确存储，但给定的值（不完全是 0.1f）可以存储为双精度（也不完全是 0.1f）。假设一个 Intel FPU，a 的位模式是：

> 0 01111011 10011001100110011001101

d 的位模式是：

> 0 01111111011 100110011001100110011010 （后跟更多的零）

它具有相同的符号、指数（两种情况下均为-4）和相同的小数部分（上面用空格分隔）。输出的差异是由于数字中第二个非零数字的位置（第一个是点之后的 1）只能用双精度表示。输出字符串格式的代码将中间值存储在内存中，并且特定于浮点数和双精度数（即有一个函数双精度字符串和另一个浮点数字符串）。如果 to-string 函数被优化为使用 FPU 堆栈来存储 to-string 过程的中间结果，那么 float 和 double 的输出将是相同的，因为 FPU 对 float 使用相同的更大格式（80 位）和双。

没有浮点值不能相同地存储在双精度值中，即浮点值集是双精度值集的子集。

* * *

## 回答 #7

> 赞同：0
> 
> 时间：2008-11-03T16:10:20.063

**Snark:** `NaN` s 在转换之后（或实际上之前）会进行不同的比较。

然而，这并不会使已经给出的答案无效。

* * *

## 回答 #8

> 赞同：0
> 
> 时间：2008-11-03T16:15:19.833

我采用了您列出的代码并决定在 C++ 中尝试它，因为我认为它可能会执行得更快一些，并且执行不安全的强制转换要容易得多。:-D

我发现对于有效数字，转换是有效的，并且在转换后你会得到精确的按位表示。但是，对于非数字，例如 1.#QNAN0 等，结果将使用非数字的简化表示，而不是源的确切位。例如：

> **** 失败**** 2140188725 | 1.#QNAN0 -- 0xa0000000 0x7ffa1606

我将一个无符号整数转换为浮点数，然后加倍并返回浮点数。数字 2140188725 (0x7F90B035) 产生 NAN，转换为 double 和 back 仍然是 NAN，但不是*完全相同的*NAN。

这是简单的 C++ 代码：

```
typedef unsigned int uint;
for (uint i = 0; i < 0xFFFFFFFF; ++i)
{
    float f1 = *(float *)&i;
    double d = f1;
    float f2 = (float)d;
    if(f1 != f2)
        printf("**** FAILURE **** %u | %f -- 0x%08x 0x%08x\n", i, f1, f1, f2);
    if ((i % 1000000) == 0)
        printf("Iteration: %d\n", i);
} 
```

* * *

## 回答 #9

> 赞同：0
> 
> 时间：2008-11-04T00:36:42.100

第一个问题的答案是肯定的，“换句话说”的答案是否定的。如果您将代码中的测试更改为`if (!(f1 != f2))`第二个问题的答案变为“是”——它将为所有浮点值打印“成功”。

* * *

## 回答 #10

> 赞同：0
> 
> 时间：2008-11-04T15:48:13.227

理论上，每个普通单曲都可以填充指数和尾数以创建双精度，然后删除填充，然后返回原始单曲。

当你从理论走向现实时，你就会遇到问题。我不知道您是否对理论或实现感兴趣。如果是实施，那么您很快就会遇到麻烦。

IEEE 是一种可怕的格式，我的理解是，它被故意设计得如此艰难，以至于没有人能够满足它，并让市场赶上英特尔（这是不久前的），从而允许更多的竞争。如果这是真的，它失败了，无论哪种方式，我们都被这个可怕的规范所困扰。像 TI 格式这样的东西在很多方面都比现实世界优越得多。我与任何一家公司或任何这些格式都没有联系。

多亏了这个规范，实际上满足它的 fpus 很少（在硬件中，甚至在硬件和操作系统中），而且那些在下一代经常失败的 fpus。（谷歌：TestFloat）。这些天的问题往往在于 int 浮动和浮动到 int，而不是像您上面指定的那样单到双和双到单。当然，fpu 将执行什么操作来进行转换？加0？乘以 1？取决于 fpu 和编译器。

与上述问题相关的 IEEE 的问题是，数字的方式不止一种，不是每个数字都可以表示，而是可以表示许多数字。如果我想破坏您的代码，我将从负零开始，希望两个操作之一将其转换为正零。然后我会尝试非规范化。它应该失败并带有信号 nan，但是您将其称为已知异常。

问题是等号，这里是关于浮点的第一条规则，永远不要使用等号。等于是位比较而不是值比较，如果您有两个以不同方式表示的值（例如加零和负零），即使它的数字相同，位比较也会失败。大于和小于在 fpu 中完成，等于在整数 alu 中完成。

我意识到您可能使用等于来解释问题，而不一定是您想要成功或失败的代码。

* * *

## 回答 #11

> 赞同：0
> 
> 时间：2012-08-28T03:49:53.433

如果将浮点类型视为表示精确值，那么正如其他发布者所指出的那样，每个`float`值都可以表示为 a `double`，但只有少数 的值`double`可以表示为`float`。另一方面，如果认识到浮点值是近似值，就会意识到实际情况正好相反。如果使用非常精确的仪器来测量 3.437 毫米的东西，那么可以正确地描述为 3.4 毫米。如果用尺子将物体测量为 3.4mm，则将其大小描述为 3.400mm 是不正确的。

范围的顶部存在更大的问题。有一个`float`值表示：“计算值超出 2^127 未知量”，但没有`double`值表示这种情况。将“无穷大”从单数转换为双数将产生一个值“计算值超出 2^1023 未知数量”，该值相差超过一个 googol。

# c# - C# NullReference 异常和 ReSharper 建议

> ID：259018
> 
> 赞同：4
> 
> 时间：2008-11-03T15:40:28.593
> 
> 标签：c#, .net, .net-2.0, resharper

这是我写的：

```
if ((lstProperty[i].PropertyIdentifier as string).CompareTo("Name") == 0) 
```

Resharper 给我一个错误（我是 ReSharper 的新手......我正在尝试）它建议我：

```
 if (((string) lstProperty[i].PropertyIdentifier).CompareTo("Name") == 0) 
```

为什么第二个 NullException 是安全的？对我来说，如果出现空值，两者都会崩溃？

* * *

## 回答 #1

> 赞同：8
> 
> 时间：2008-11-03T15:54:00.127

如果无法执行强制转换，'as' 运算符将返回 null，而如果无法强制转换，C 风格的强制转换将引发异常。

我建议将其分解为多个语句：

```
string propertyIdentifier = lstProperty[u].PropertyIdentifier as string;
if(propertyIdentifier != null && propertyIdentifier.CompareTo("Name") == 0)
{
    ... your if statement ...
} 
```

Resharper 不应该抱怨这一点，如果 PropertyIdentifier 为 null 或不是字符串，您也不会得到 NullReferenceException。

* * *

## 回答 #2

> 赞同：5
> 
> 时间：2008-11-03T16:10:24.117

这两个示例在相同的情况下将成功或失败，并且当它们成功时，行为将相同。

当它们失败时，结果会略有不同：第二个示例稍早失败（在演员表中），并且有一个更具体的异常（`InvalidCastException`vs. `NullReferenceException`）。

主要的好处是调试：当它们失败时，您可以在第二个示例中比第一个示例中获得更多关于失败原因的信息。具体来说，如果 PropertyIdentifier 是`null`vs. non- `string`，您可以在第二种情况下判断，但不能在第一种情况下判断。

此外，如果您在 a 中，则可以在与case 不同的代码路径中`try/catch`处理 non- case。但是，您可能不应该这样编码：如果是这样，那么您做错了其他事情。`string``null`

如果您在各种情况下逐步执行以下代码，它可能有助于阐明情况：

```
var propertyI = lstProperty[i];
var propertyIdentifier = propertyI.PropertyIdentifier;

// pick one of these:
var propertyIdentifierAsString = propertyIdentifier as string;
var propertyIdentifierAsString = (string)propertyIdentifier;

if (propertyIdentifierAsString.CompareTo("Name") == 0) 
```

# powershell - 为什么我会选择 Powershell 而不是 WMI 来开发管理界面？

> ID：259020
> 
> 赞同：11
> 
> 时间：2008-11-03T15:40:44.723
> 
> 标签：powershell, wmi, systemmanagement

我们正在讨论为我们的分布式系统开发改进的管理基础架构。我们使用 COM、Web 服务和 .NET 组件。由于我们基于 Microsoft Windows Server XP/2003，我想，我们基本上有两种选择：

1.  Powershell cmdlet
2.  使用 System.Management 的 WMI 类和本机代码（类、实例、方法、事件）的 WMI 提供程序

为什么我们会选择 Powershell 而不是 WMI？

* * *

## 回答 #1

> 赞同：10
> 
> 时间：2008-11-03T19:16:23.790

出于以下原因，我会选择 PowerShell 而不是 WMI：

1.  编写 cmdlet 只是添加一个 .NET 类。
2.  PowerShell 运行时提供内置的命令行解析。
3.  在 PowerShell 中编写管理界面使管理员能够将应用程序的管理与其他应用程序和服务（如 Exchange、Active Directory 或 SQL Server）的管理集成在一起。
4.  PowerShell 环境使管理员可以使用管道，从而更有效地完成应用程序的管理任务。
5.  可发现性。PowerShell 通过 Get-Command、Get-Member 和 Get-Help 为管理员提供了一个非常容易发现的工作环境，从而缩短了维护应用程序的学习曲线。

即使您采用 WMI 路线，PowerShell 也支持使用 WMI（尽管存在一些小故障）。

**对我来说，PowerShell 是向应用程序展示面向任务的**界面的最佳方式。借助 Microsoft 一直提供的 PowerShell 支持，它现在是并将成为管理整个企业的应用程序和服务的一致界面。

我的日常工作是管理员，我正在推动与我合作的所有供应商开发 PowerShell 管理 API，因为这使得管理应用程序的学习曲线和上下文切换要低得多。在开发方面，我已经为我使用的一个开源产品编写了（并且仍在研究）一系列 PowerShell cmdlet，并且正在为单独的应用程序开发另一组。

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2008-11-03T19:35:25.640

[Jeffrey Snover 在此处](http://blogs.msdn.com/powershell/archive/2008/08/30/powershell-vs-tsql-why-learn-powershell.aspx)回答“为什么使用 PowerShell” 。这篇文章是在 SQL 的上下文中，但在这里非常适用。

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2008-11-24T21:54:29.743

我不确定我会做出决定。这不完全是非此即彼的……您可以选择两者兼而有之。

WMI 可以被许多不同的东西使用，而不仅仅是 PowerShell。为什么不在 PowerShell 中编写您的管理工具，然后将该 WMI 包装在一些面向任务的 cmdlet 中以使管理员更轻松？这就是一些 MS 产品团队选择做的事情，尤其是当他们有其他 WMI 消费者想要继续支持时。

如果您已经拥有合适的 .NET 代码，将其转换为 cmdlet 可能比将其转换为 WMI 提供程序更快。如果是这种情况，并且速度是一个问题，那就选择更容易的。但无论您做什么，您始终可以将其包装在 PowerShell cmdlet 中供管理员使用，这绝对是推荐的方法。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2008-11-03T17:04:56.940

不确定您到目前为止提供的信息是否可以回答这个问题。我的直觉是你应该使用 powershell，因为听起来你可能已经有一些 .Net 代码。但这确实取决于您要做什么。

# vbscript - 如何使用 WScript.Shell SendKeys 发送数字键盘击键？

> ID：259024
> 
> 赞同：3
> 
> 时间：2008-11-03T15:41:43.257
> 
> 标签：vbscript, automated-tests, qtp, wsh

我正在尝试使用 WScript.Shell SendKeys 方法来模拟从数字键盘发送按键。

我有一个应用程序，我正在编写使用 QTP 的自动化测试。它是一个基于 Web 浏览器的应用程序，输入内容是网页内的 Java 应用程序。输入仅接受来自数字键盘和 Enter 键的按键。

到目前为止，我正在使用此代码：

```
Dim strInputKey
strInputKey = "{ENTER}"
Set objWsh = CreateObject("WScript.Shell")
Browser("Launch Browser").Page("Test Application").WebElement("Item ID").Click
objWsh.SendKeys strInputKey 
```

这适用于发送 Enter 键，但我不太清楚是否有发送数字键的方法。任何帮助将不胜感激。

我不确定是否有任何未记录的方法可以实现这一目标。我已阅读[http://msdn.microsoft.com/en-us/library/8c6yea83(VS.85).aspx](http://msdn.microsoft.com/en-us/library/8c6yea83(VS.85).aspx)，但没有详细说明。

提前致谢，

*   布伦特

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2008-11-04T16:20:53.067

您需要使用数字键盘的键码。

以下是它们的列表： [http ://www.empirisoft.com/directrt/help/_helpcontents.htm?directrt_key_codes.htm](http://www.empirisoft.com/directrt/help/_helpcontents.htm?directrt_key_codes.htm)

因此，要发送“123”，您需要执行以下操作：

```
objWsh.SendKeys chr(79) & chr(80) & chr(81) 
```

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2010-07-08T08:48:06.903

我没有代表评论上面说 objWsh.SendKeys chr(79) & chr(80) & chr(81) 的答案

但我不认为这是正确的

objWsh.SendKeys chr(79) & chr(80) & chr(81)
首先，它发送字母 O,P,Q 他想要数字，比如 1234567890

并且链接转到键盘扫描代码。我认为这些是为了知道按下了键盘上的哪个键。它们与 ascii 代码不同。
79,80,81是数字键盘/小键盘上某些数字的键盘扫描码。

但是，Chr 使用 ascii 代码。不是键盘扫描码。

此外，这里只是指定一个数字，因为它不是通过按键来完成的，所以它没有指定也不需要指定使用哪个键，因为没有使用键。

发送一些数字（从数字键盘），与从第一行发送密钥相同。你只是想发送一些号码。

如果他只想知道如何使用 sendkeys 发送数字，那么显然。

objWsh.SendKeys 12345 或 str="12345" objWsh.SendKeys str

但是，如果提问者没有意识到 objWsh.SendKeys 12345 会这样做，那么提问者可能只是感到困惑。我猜从绿色勾号中，他投了一个类似于 objWsh.SendKeys "OPQ" 的答案。

我知道这是一个老问题，但为了得到正确的问题和答案..

# sql-server - 从应用程序获取 SQL Server 连接信息而不进行调试？

> ID：259025
> 
> 赞同：0
> 
> 时间：2008-11-03T15:41:58.467
> 
> 标签：sql-server, diagnostics

我们正在对闭源第三方 ASP.NET 应用程序上的 SQL Server 2005 连接问题进行故障排除。该应用程序是一个 .NET 应用程序，开发公司正在使用存储 SQL Server 身份验证信息的自定义格式配置文件。

尝试连接到我们的 SQL Server 框时的应用程序收到“无法打开数据库 'databasename'。用户 'username' 登录失败”错误。我们已经测试了使用 SQL Server Management Studio 和提供给他们的应用程序的登录信息从 Web 服务器连接到 SQL Server 框，它运行良好。

有没有什么简单的方法可以让我们嗅探/确定他们试图在 SqlCommand 中使用的 SQL Server 连接信息？调试他们的代码不是一种选择，因为它是在发布模式下编译的，而且我们没有源代码。我们只需要一些东西来确定他们的应用程序无法连接的原因。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2008-11-03T17:34:29.173

运行分析器并选择安全审计：审计登录、审计登录失败和审计注销事件。选择所有列。从中您将获得应用程序名称，以及尝试从登录失败事件中登录的用户。一旦你得到检查哪个数据库是 SQL Server 用户中该用户的默认数据库。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2008-11-03T16:12:56.157

我刚刚问了这里的一些人，他们都建议尝试反射器。如果你在库中有一些硬编码的值，你应该能够在那里看到一些东西。

# c# - 为什么 C# 不允许静态方法实现接口？

> ID：259026
> 
> 赞同：465
> 
> 时间：2008-11-03T15:42:00.260
> 
> 标签：c#, oop, language-features

为什么 C# 是这样设计的？

据我了解，接口仅描述行为，并用于描述实现特定行为的接口的类的合同义务。

如果类希望在共享方法中实现这种行为，为什么不呢？

这是我想到的一个例子：

```
// These items will be displayed in a list on the screen.
public interface IListItem {
  string ScreenName();
  ...
}

public class Animal: IListItem {
    // All animals will be called "Animal".
    public static string ScreenName() {
        return "Animal";
    }
....
}

public class Person: IListItem {

    private string name;

    // All persons will be called by their individual names.
    public string ScreenName() {
        return name;
    }

    ....

 } 
```

* * *

## 回答 #1

> 赞同：227
> 
> 时间：2008-11-03T15:57:41.350

假设您要问为什么不能这样做：

```
public interface IFoo {
    void Bar();
}

public class Foo: IFoo {
    public static void Bar() {}
} 
```

从语义上讲，这对我来说没有意义。接口上指定的方法应该在那里指定与对象交互的合同。静态方法不允许您与对象交互 - 如果您发现自己处于可以将实现设为静态的位置，您可能需要问自己该方法是否真的属于接口。

* * *

为了实现您的示例，我会给 Animal 一个 const 属性，它仍然允许从静态上下文访问它，并在实现中返回该值。

```
public class Animal: IListItem {
    /* Can be tough to come up with a different, yet meaningful name!
     * A different casing convention, like Java has, would help here.
     */
    public const string AnimalScreenName = "Animal";
    public string ScreenName(){ return AnimalScreenName; }
} 
```

对于更复杂的情况，您总是可以声明另一个静态方法并委托给它。在尝试举个例子时，我想不出任何理由你会在静态和实例上下文中做一些不平凡的事情，所以我会为你省掉一个 FooBar blob，并把它作为一个指示它可能不是一个好主意。

* * *

## 回答 #2

> 赞同：179
> 
> 时间：2008-11-03T17:37:31.947

我的（简化的）技术原因是静态方法不在[vtable](http://en.wikipedia.org/wiki/Virtual_table)中，并且在编译时选择了调用站点。这与您不能拥有覆盖或虚拟静态成员的原因相同。有关更多详细信息，您需要 CS 毕业生或编译器专家——我都不是。

出于政治原因，我将[引用 Eric Lippert](https://docs.microsoft.com/en-us/archive/blogs/ericlippert/calling-static-methods-on-type-parameters-is-illegal-part-one)（他是一名编译器专家，拥有滑铁卢大学的数学、计算机科学和应用数学学士学位（来源：[LinkedIn](https://www.linkedin.com/pub/eric-lippert/85/934/a38)）：

> ...静态方法的核心设计原则，给它们命名的原则...[是]...它总是可以准确地确定，在编译时，将调用什么方法。也就是说，该方法可以仅通过代码的静态分析来解决。

请注意，Lippert 确实为所谓的类型方法留出了空间：

> 也就是说，一种与类型（如静态）相关联的方法，它不采用不可为空的“this”参数（与实例或虚拟不同），但调用的方法将取决于 T 的构造类型（不像静态的，它必须在编译时确定）。

但尚未确信其有用性。

* * *

## 回答 #3

> 赞同：103
> 
> 时间：2011-10-30T13:35:25.200

这里的大多数答案似乎都没有抓住重点。多态不仅可以在实例之间使用，也可以在类型之间使用。当我们使用泛型时，这通常是需要的。

假设我们在泛型方法中有类型参数，我们需要对其进行一些操作。我们不想实例化，因为我们不知道构造函数。

例如：

```
Repository GetRepository<T>()
{
  //need to call T.IsQueryable, but can't!!!
  //need to call T.RowCount
  //need to call T.DoSomeStaticMath(int param)
}

...
var r = GetRepository<Customer>() 
```

不幸的是，我只能提出“丑陋”的替代方案：

*   **使用反射** Ugly 并击败接口和多态的想法。

*   **创建完全独立的工厂类**

    这可能会大大增加代码的复杂性。例如，如果我们试图对域对象建模，每个对象都需要另一个存储库类。

*   **实例化然后调用所需的接口方法**

    即使我们控制类的源，用作泛型参数，这也很难实现。原因是，例如，我们可能需要实例仅处于众所周知的“连接到数据库”状态。

例子：

```
public class Customer 
{
  //create new customer
  public Customer(Transaction t) { ... }

  //open existing customer
  public Customer(Transaction t, int id) { ... }

  void SomeOtherMethod() 
  { 
    //do work...
  }
} 
```

为了使用实例化来解决静态接口问题，我们需要做以下事情：

```
public class Customer: IDoSomeStaticMath
{
  //create new customer
  public Customer(Transaction t) { ... }

  //open existing customer
  public Customer(Transaction t, int id) { ... }

  //dummy instance
  public Customer() { IsDummy = true; }

  int DoSomeStaticMath(int a) { }

  void SomeOtherMethod() 
  { 
    if(!IsDummy) 
    {
      //do work...
    }
  }
} 
```

这显然是丑陋的，也不必要地使所有其他方法的代码复杂化。显然，这也不是一个优雅的解决方案！

* * *

## 回答 #4

> 赞同：20
> 
> 时间：2011-11-17T17:05:45.480

我知道这是一个老问题，但很有趣。这个例子不是最好的。我认为如果你展示一个用例会更清楚：

```
字符串 DoSomething<T>() 其中 T:ISomeFunction
{
  if (T.someFunction())
    ...
}

```

仅仅能够让静态方法*实现*接口并不能实现您想要的；所需要的是将静态成员作为接口的*一部分*。我当然可以想象很多用例，尤其是在能够创造事物的时候。我可以提供两种可能有用的方法：

1.  创建一个静态泛型类，其类型参数将是您在上面传递给 DoSomething 的类型。此类的每个变体都将有一个或多个静态成员保存与该类型相关的内容。可以通过让每个感兴趣的类调用“注册信息”例程来提供此信息，或者通过在运行类变体的静态构造函数时使用反射来获取信息。我相信后一种方法被诸如 Comparer<T>.Default() 之类的东西使用。
2.  对于每个感兴趣的类 T，定义一个实现 IGetWhateverClassInfo<T> 并满足“新”约束的类或结构。该类实际上不包含任何字段，但将具有一个静态属性，该属性返回一个带有类型信息的静态字段。将该类或结构的类型传递给有问题的通用例程，该例程将能够创建一个实例并使用它来获取有关另一个类的信息。如果您为此目的使用一个类，您可能应该如上所述定义一个静态泛型类，以避免每次都必须构造一个新的描述符对象实例。如果使用结构，实例化成本应该为零，但每种不同的结构类型都需要对 DoSomething 例程进行不同的扩展。

这些方法都没有真正吸引人的地方。另一方面，我希望如果 CLR 中存在干净地提供这种功能的机制，.net 将允许指定参数化的“新”约束（因为知道一个类是否具有具有特定签名的构造函数似乎很难与知道它是否具有具有特定签名的静态方法相比）。

* * *

## 回答 #5

> 赞同：16
> 
> 时间：2008-11-03T15:46:44.743

我猜是短视。

最初设计时，接口仅用于类的实例

```
IMyInterface val = GetObjectImplementingIMyInterface();
val.SomeThingDefinedinInterface(); 
```

只有引入接口作为泛型的约束后，向接口添加静态方法才有实际用途。

（回应评论：）我认为现在更改它需要更改 CLR，这将导致与现有程序集不兼容。

* * *

## 回答 #6

> 赞同：15
> 
> 时间：2012-08-22T03:47:47.043

就接口代表“契约”的程度而言，静态类实现接口似乎是合理的。

上述论点似乎都忽略了关于合同的这一点。

* * *

## 回答 #7

> 赞同：14
> 
> 时间：2008-11-03T15:47:57.643

接口指定对象的行为。

静态方法不指定对象的行为，而是以某种方式影响对象的行为。

* * *

## 回答 #8

> 赞同：10
> 
> 时间：2008-11-03T17:51:07.987

因为接口的目的是允许多态性，能够传递已定义的任意数量的已定义类的实例以实现已定义的接口......保证在您的多态调用中，代码将能够找到您正在调用的方法。允许静态方法实现接口是没有意义的，

你会怎么称呼它？

* * *

```
public interface MyInterface { void MyMethod(); }
public class MyClass: MyInterface
{
    public static void MyMethod() { //Do Something; }
}

 // inside of some other class ...  
 // How would you call the method on the interface ???
    MyClass.MyMethod();  // this calls the method normally 
                         // not through the interface...

    // This next fails you can't cast a classname to a different type... 
    // Only instances can be Cast to a different type...
    MyInterface myItf = MyClass as MyInterface; 
```

* * *

## 回答 #9

> 赞同：4
> 
> 时间：2013-08-13T17:26:04.293

关于在非泛型上下文中使用的静态方法，我同意在接口中允许它们没有多大意义，因为如果你有对接口的引用，你将无法调用它们。然而，在语言设计中存在一个基本漏洞，它不是在多态上下文中而是在通用上下文中使用接口创建的。在这种情况下，接口根本不是接口，而是约束。因为 C# 在接口之外没有约束的概念，所以它缺少实质性的功能。一个例子：

```
T SumElements<T>(T initVal, T[] values)
{
    foreach (var v in values)
    {
        initVal += v;
    }
} 
```

这里没有多态性，泛型使用对象的实际类型并调用 += 运算符，但这失败了，因为它不能确定该运算符存在。简单的解决方案是在约束中指定它；简单的解决方案是不可能的，因为运算符是静态的，静态方法不能在接口中，并且（这里是问题）约束被表示为接口。

C# 需要的是真正的约束类型，所有接口也都是约束，但并非所有约束都是接口，那么您可以这样做：

```
constraint CHasPlusEquals
{
    static CHasPlusEquals operator + (CHasPlusEquals a, CHasPlusEquals b);
}

T SumElements<T>(T initVal, T[] values) where T : CHasPlusEquals
{
    foreach (var v in values)
    {
        initVal += v;
    }
} 
```

已经有很多关于为所有数字类型实现 IArithmetic 的讨论，但人们担心效率，因为约束不是多态构造，所以创建 CArithmetic 约束将解决这个问题。

* * *

## 回答 #10

> 赞同：3
> 
> 时间：2008-11-03T15:43:44.220

因为接口是继承结构，而静态方法不能很好地继承。

* * *

## 回答 #11

> 赞同：3
> 
> 时间：2008-11-03T16:33:18.050

您似乎想要的是允许通过 Type 或该类型的任何实例调用静态方法。这至少会导致模棱两可，这不是一个理想的特征。

关于它是否重要、哪种是最佳实践以及以这种方式或另一种方式是否存在性能问题，将会有无休止的争论。通过简单地不支持它，C# 让我们不必担心它。

符合这种愿望的编译器也可能会失去一些优化，这些优化可能伴随着实例和静态方法之间更严格的分离。

* * *

## 回答 #12

> 赞同：3
> 
> 时间：2008-11-03T16:49:06.147

您可以将类的静态方法和非静态方法视为不同的接口。调用时，静态方法解析为单例静态类对象，非静态方法解析为您处理的类的实例。因此，如果您在接口中使用静态和非静态方法，那么当我们真的希望接口用于访问一个有凝聚力的事物时，您实际上是在声明两个接口。

* * *

## 回答 #13

> 赞同：3
> 
> 时间：2009-02-26T07:16:06.917

举一个例子，我缺少接口方法的静态实现或 Mark Brackett 引入的“所谓的类型方法”：

从数据库存储中读取时，我们有一个通用的 DataTable 类来处理从任何结构的表中读取。所有表特定信息都放在每个表的一个类中，该类还保存数据库中一行的数据，并且必须实现 IDataRow 接口。IDataRow 中包含对要从数据库中读取的表结构的描述。DataTable 必须在从 DB 读取之前从 IDataRow 请求数据结构。目前这看起来像：

```
interface IDataRow {
  string GetDataSTructre();  // How to read data from the DB
  void Read(IDBDataRow);     // How to populate this datarow from DB data
}

public class DataTable<T> : List<T> where T : IDataRow {

  public string GetDataStructure()
    // Desired: Static or Type method:
    // return (T.GetDataStructure());
    // Required: Instantiate a new class:
    return (new T().GetDataStructure());
  }

} 
```

每个表只需要读取一次 GetDataStructure，实例化一个更多实例的开销是最小的。但是，在这种情况下会很好。

* * *

## 回答 #14

> 赞同：1
> 
> 时间：2008-11-03T16:34:26.380

接口是定义的可用功能的抽象集合。

**该接口中的方法是否表现为静态方法是应该隐藏在接口后面的实现细节**。将接口方法定义为静态是错误的，因为您将不必要地强制该方法以某种方式实现。

如果方法被定义为静态的，那么实现接口的类就不会被尽可能地封装。在面向对象的设计中，封装是一件好事（我不会解释为什么，你可以在这里阅读：[http](http://en.wikipedia.org/wiki/Object-oriented) ://en.wikipedia.org/wiki/Object-oriented ）。因此，接口中不允许使用静态方法。

* * *

## 回答 #15

> 赞同：1
> 
> 时间：2008-11-03T16:46:39.583

仅供参考：您可以通过为接口创建扩展方法来获得与您想要的类似的行为。扩展方法将是一个共享的、不可覆盖的静态行为。然而，不幸的是，这种静态方法不会成为合同的一部分。

* * *

## 回答 #16

> 赞同：1
> 
> 时间：2011-01-19T17:18:36.203

静态类应该能够做到这一点，因此它们可以被普遍使用。我不得不实现一个 Singleton 来实现预期的结果。

我有一堆静态业务层类，它们为每个实体类型（如“用户”、“团队”等）实现了诸如“创建”、“读取”、“更新”、“删除”等 CRUD 方法。然后我创建了一个基础具有实现 CRUD 方法的业务层类的抽象属性的控件。这使我能够自动化基类中的“创建”、“读取”、“更新”、“删除”操作。由于静态限制，我不得不使用单例。

* * *

## 回答 #17

> 赞同：1
> 
> 时间：2013-07-15T18:55:42.133

大多数人似乎忘记了在 OOP 中类也是对象，因此它们有消息，出于某种原因，c# 将其称为“静态方法”。实例对象和类对象之间存在差异这一事实仅表明该语言存在缺陷或缺点。虽然对 c# 持乐观态度...

* * *

## 回答 #18

> 赞同：1
> 
> 时间：2013-07-29T13:20:01.833

好的，这是需要“类型方法”的示例。我正在创建基于某些源 XML 的一组类中的一个。所以我有一个

```
 static public bool IsHandled(XElement xml) 
```

在每个类上依次调用的函数。

该函数应该是静态的，否则我们会浪费时间创建不合适的对象。正如@Ian Boyde 指出的那样，它可以在工厂类中完成，但这只会增加复杂性。

将它添加到接口以强制类实现者实现它会很好。这不会导致显着的开销——它只是编译/链接时间检查，不会影响 vtable。

但是，这也将是一个相当小的改进。由于该方法是静态的，因此我作为调用者必须显式调用它，因此如果未实现，则会立即出现编译错误。允许在接口上指定它意味着此错误在开发周期的早期出现，但与其他损坏的接口问题相比，这是微不足道的。

因此，这是一个潜在的小功能，总的来说最好不要考虑。

* * *

## 回答 #19

> 赞同：1
> 
> 时间：2015-07-26T00:22:33.547

静态类是由微软在 C# 中实现的，它使用静态元素创建了一个类的特殊实例，这只是静态功能实现方式的一个奇怪之处。这不是理论上的观点。

接口应该是类接口的描述符 - 或者它是如何与之交互的，并且应该包括静态交互。界面的一般定义（来自 Meriam-Webster）：不同事物相遇并相互交流或相互影响的地方或区域。当您完全忽略一个类或静态类的静态组件时，我们将忽略这些坏男孩如何交互的大部分内容。

这是一个非常清楚的示例，说明能够将接口与静态类一起使用会非常有用：

```
public interface ICrudModel<T, Tk>
{
    Boolean Create(T obj);
    T Retrieve(Tk key);
    Boolean Update(T obj);
    Boolean Delete(T obj);
} 
```

目前，我编写了包含这些方法的静态类，没有进行任何检查以确保我没有忘记任何东西。就像在 OOP 之前编程的糟糕时光。

* * *

## 回答 #20

> 赞同：1
> 
> 时间：2016-01-18T22:33:03.703

C# 和 CLR 应该像 Java 一样支持接口中的静态方法。static 修饰符是合约定义的一部分并且确实有意义，特别是行为和返回值不会因实例而异，尽管它可能仍因调用而异。

也就是说，我建议当您想在接口中使用静态方法而不能使用时，请改用注解。您将获得您正在寻找的功能。

* * *

## 回答 #21

> 赞同：1
> 
> 时间：2021-07-14T08:46:04.283

从 c# 9 开始允许接口中的静态方法（请参阅[https://www.dotnetcurry.com/csharp/simpler-code-with-csharp-9](https://www.dotnetcurry.com/csharp/simpler-code-with-csharp-9)）。

* * *

## 回答 #22

> 赞同：0
> 
> 时间：2008-11-03T17:29:33.320

我认为简短的回答是“因为它的用处为零”。要调用接口方法，您需要该类型的实例。从实例方法中，您可以调用任何您想要的静态方法。

* * *

## 回答 #23

> 赞同：0
> 
> 时间：2015-03-19T16:25:00.390

我认为问题在于 C# 需要另一个关键字，正是这种情况。您需要一个返回值仅取决于调用它的类型的方法。如果所述类型未知，则不能将其称为“静态”。但是一旦类型变得已知，它就会变成静态的。“未解决的静态”是一个想法——它还不是静态的，但是一旦我们知道接收类型，它就会是。这是一个非常好的概念，这就是程序员不断要求它的原因。但它并不完全符合设计师对语言的看法。

由于它不可用，我已采用如下所示的方式使用非静态方法。不完全理想，但我看不出任何更有意义的方法，至少对我来说不是。

```
public interface IZeroWrapper<TNumber> {
  TNumber Zero {get;}
}

public class DoubleWrapper: IZeroWrapper<double> {
  public double Zero { get { return 0; } }
} 
```

* * *

## 回答 #24

> 赞同：0
> 
> 时间：2017-07-02T13:31:49.717

> 根据由类实现的面向对象的概念接口，并具有使用对象访问这些实现的功能（或方法）的合同。

所以如果你想访问接口契约方法，你必须创建对象。在静态方法的情况下，总是不允许的。静态类、方法和变量永远不需要对象并在不创建该区域（或类）的对象的情况下加载到内存中，或者您可以说不需要创建对象。

* * *

## 回答 #25

> 赞同：0
> 
> 时间：2019-05-14T19:07:02.693

***从概念上讲***，接口没有理由不能定义包含静态方法的协定。

对于当前的 C# 语言实现，限制是由于允许继承基类和接口。如果“class SomeBaseClass”实现了“interface ISomeInterface”并且“class SomeDerivedClass : SomeBaseClass, ISomeInterface”也实现了该接口，实现接口方法的静态方法将无法编译，因为静态方法不能具有与实例方法相同的签名（这将存在于基类中以实现接口）。

静态类在功能上与单例相同，并且具有与具有更简洁语法的单例相同的目的。由于单例可以实现接口，因此静态接口实现在概念上是有效的。

因此，它简单地归结为 C# 名称冲突的限制，例如跨继承的同名静态方法和实例方法。没有理由不能“升级”C# 以支持静态方法协定（接口）。

* * *

## 回答 #26

> 赞同：0
> 
> 时间：2022-01-30T09:23:54.200

# 实际上，它确实*（或至少，它会）*。

自 2022 年 1 月起，即将推出的 C# 和 .NET 版本将全面支持所谓的`static abstract`成员：

```
interface INumber<T>
{
    static abstract T Zero { get; }
}

struct Fraction : INumber<Fraction>
{
    public static Fraction Zero { get; } = new Fraction();

    public long Numerator;
    public ulong Denominator;

    ....
} 
```

* * *

## 回答 #27

> 赞同：-1
> 
> 时间：2018-06-05T12:47:41.053

当一个类实现一个接口时，它正在为接口成员创建实例。虽然静态类型没有实例，但在接口中具有静态签名没有意义。

# sql - SQL Server 锁定在这种情况下如何工作？

> ID：259031
> 
> 赞同：4
> 
> 时间：2008-11-03T15:43:25.483
> 
> 标签：sql, sql-server, locking

考虑到我有一笔交易：

```
BEGIN TRANSACTION
DECLARE MONEY @amount
SELECT Amount AS @amount
  FROM Deposits
  WHERE UserId = 123
UPDATE Deposits
  SET Amount = @amount + 100.0
  WHERE UserId = 123
COMMIT 
```

它在 2 个线程上执行，顺序为：

1.  线程 1 - 选择
2.  线程 2 - 选择
3.  线程 1 - 更新
4.  线程 2 - 更新

假设执行前Amount为0。

在这种情况下，在 SQL Server 的不同设置（未提交读取、已提交读取、可重复读取、可序列化）下会发生什么情况，最后会发生什么数量，会不会出现死锁？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2008-11-03T17:59:15.083

其他人已经解决了使用 REPEATABLE READ 的问题。

所以我会提出不同的建议......

为什么要使用两个语句而不是像下面这样的一个语句？

```
UPDATE Deposits
SET Amount = Amount + 100.0
WHERE UserId = 123 
```

此外，您的真实交易发生的不仅仅是用户 ID，对吗？如果没有，您将面临使用比最初预期更多的记录的风险。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2008-11-03T18:25:01.880

很好的陈述场景。我决定测试一下。

这是我的设置脚本：

```
CREATE TABLE Deposits(Amount Money, UserID int)
INSERT INTO Deposits (Amount, UserID)
SELECT 0.0, 123
--Reset
UPDATE Deposits
SET Amount = 0.00
WHERE UserID = 123 
```

这是我的测试脚本。

```
SET TRANSACTION ISOLATION LEVEL Serializable
----------------------------------------
-- Part 1
----------------------------------------
BEGIN TRANSACTION
DECLARE @amount MONEY
SET @amount =
(
SELECT Amount
FROM Deposits
WHERE UserId = 123
)
SELECT @amount as Amount
----------------------------------------
-- Part 2
----------------------------------------
DECLARE @amount MONEY
SET @amount =  *value from step 1*
UPDATE Deposits
SET Amount = @amount + 100.0
WHERE UserId = 123
COMMIT
SELECT *
FROM Deposits
WHERE UserID = 123 
```

我在两个查询分析器窗口中加载了这个测试脚本，并按照问题的描述运行了每个部分。

所有读取都发生在任何写入之前，因此所有线程/场景都会将 0 的值读入@amount。

结果如下：

读已提交

```
1 T1.@Amount = 0.00
2 T1.@Amount = 0.00
3 Deposits.Amount = 100.00
4 Deposits.Amount = 100.00 
```

读取未提交

```
1 T1.@Amount = 0.00
2 T1.@Amount = 0.00
3 Deposits.Amount = 100.00
4 Deposits.Amount = 100.00 
```

可重复读取

```
1 T1.@Amount = 0.00 (locks out changes by others on Deposit.UserID = 123)
2 T1.@Amount = 0.00 (locks out changes by others on Deposit.UserID = 123)
3 Hangs until step 4\. (due to lock in step 2)
4 Deadlock!
Final result: Deposits.Amount = 100.00 
```

可序列化

```
1 T1.@Amount = 0.00 (locks out changes by others on Deposit)
2 T1.@Amount = 0.00 (locks out changes by others on Deposit)
3 Hangs until step 4\. (due to lock in step 2)
4 Deadlock!
Final result: Deposits.Amount = 100.00 
```

以下是每种类型的解释，可用于通过思维模拟来达到这些结果。

**Read Committed**和**Read Uncommited**都不会锁定已读取的数据以防止其他用户修改。不同之处在于，未提交的读取将允许您查看尚未提交的数据（不利），并且如果有数据被其他人锁定以防止读取（有利），则不会阻止您的读取，这实际上是在说两次相同的事情。

**Repeatable Read**和**Serializable**，两者都表现得像 read commited for reading。对于锁定，两者都锁定已读取的数据以防止其他用户修改。不同之处在于可序列化的阻塞比已读取的行多，它还阻塞会引入以前不存在的记录的插入。

因此，通过可重复读取，您可以在以后的读取中看到新记录（称为：幻像记录）。使用可序列化，您可以阻止这些记录的创建，直到您提交为止。

以上解释来自我对这篇[msdn](http://msdn.microsoft.com/en-us/library/aa259216(SQL.80).aspx)文章的解读。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2008-11-03T17:45:10.963

是的，您可能想要可重复阅读。

我可能会通过乐观锁定来处理这个问题，其中只有在现有值与您读取时的值相同时才更新（测试和设置）。如果值不同，则引发错误。这允许您以未提交的方式运行，没有死锁，也没有数据损坏。

```
BEGIN TRANSACTION
DECLARE MONEY @amount
SELECT Amount AS @amount
  FROM Deposits
  WHERE UserId = 123
UPDATE Deposits
  SET Amount = @amount + 100.0
  WHERE UserId = 123 AND Amount = @amount
IF @@ROWCOUNT <> 1 BEGIN ROLLBACK; RAISERROR(...) END
ELSE COMMIT END 
```

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2008-11-03T18:31:00.323

否则，您可以使用锁定提示来避免死锁（如果您的服务器处于读取提交模式）：

```
BEGIN TRANSACTION
DECLARE MONEY @amount
SELECT Amount AS @amount
  FROM Deposits WITH(UPDLOCK)
  WHERE UserId = 123
UPDATE Deposits
  SET Amount = @amount + 100.0
  WHERE UserId = 123
COMMIT 
```

当然，在这个特定的过程中，单个语句（如 Kevin Fairchild 发布的）是首选并且不会引起副作用，但在更复杂的情况下，UPDLOCK 提示可能会变得很方便。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2008-11-03T16:03:19.547

我相信你会想要使用可重复读取，它会锁定记录，第一个选择会获取值，然后它会更新阻塞线程二，直到它完成。因此，在您的示例中，最终结果为 200

未提交读取将导致两条记录都将值设置为 100。

已提交的读取可能会产生一些有趣的结果，具体取决于两个线程的时间......

这是我发现的一篇关于可[重复读取](http://blogs.msdn.com/craigfr/archive/2007/05/09/repeatable-read-isolation-level.aspx)的好文章，它提供了一个很好的例子

# visual-studio-2008 - 将应用程序部署到 Windows Mobile Pocket PC

> ID：259032
> 
> 赞同：4
> 
> 时间：2008-11-03T15:43:38.227
> 
> 标签：visual-studio-2008, deployment, windows-mobile

在将我的应用程序部署到袖珍电脑模拟器时，我遇到了磁盘空间问题。

所以我所做的是在我的电脑上设置一个共享目录来模拟 SD 卡，我手动将程序复制到那里，然后从模拟器中运行它，使用这种方法我仍然需要进行 Visual Studio 部署以便这样.net 紧凑框架被复制过来。

如何使 Visual Studio 部署到共享目录？“输出文件夹”显示为灰色，我只能从预定义位置列表中进行选择。

* * *

抱歉，也许我想不清楚，当我说“我只能从预定义的位置列表中选择”时，我指的是 [..] 菜单中的选项。我需要某种自由文本输入。我想要 d:\MyShare 之类的东西。

我在想的最好的方法是手动编辑解决方案 xml，但这似乎是一种糟糕的方法？

* * *

## 回答 #1

> 赞同：9
> 
> 时间：2008-11-03T16:12:38.873

Properties->Devices 下的“Output File Folder”是灰色的，但是它右边的 [...] 按钮不是。在那里调整它。

注意：为了澄清，您单击 [...] 按钮，您会看到一个对话框，允许您从设备中选择一个文件夹（“设备上的输出位置”）并输入一个额外的子文件夹（“子目录”）。现在您似乎被迫在此处使用特定文件夹，但下拉选项之一是“根文件夹”，即“\”。然后，您可以添加您的文件夹，例如“存储卡”作为子目录，并获得“\存储卡”的部署文件夹。直觉的？不，但是您可以构建任何您想要的输出文件夹。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2008-11-03T19:15:30.267

您应该从模拟器的角度而不是硬盘驱动器的角度思考。您的共享文件夹模拟 SD 卡，模拟器和 Visual Studio 对此一无所知。上一个答案是正确的，使用“输出文件夹”并放置路径“\存储卡\”。并在 Visual Studio 中运行您的应用程序 - 应用程序将部署到仿真器“存储卡”，其背后是您的共享文件夹。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2008-11-27T17:14:38.857

选择“根文件夹”和“输出文件夹”="\Storage Card\YourApp"

# asp.net - 为什么在运行 asp.net 时出现“无法在 Web 服务器上开始调试”？

> ID：259036
> 
> 赞同：3
> 
> 时间：2008-11-03T15:43:54.250
> 
> 标签：asp.net, debugging

我正在尝试通过具有 localhost 以外的虚拟目录的 IIS 调试 Web 应用程序。它编译得很好，但在我尝试开始调试的任何时候都会收到上述消息。我有编译调试 =“真”。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2008-11-03T19:42:47.433

右键单击您的“网络”项目并选择“属性页”。然后将“开始选项”更改为“不打开页面”。等待来自外部应用程序的请求。对于服务器，选择“使用自定义服务器”和基本 URL：“ [http://localhost/your_virtual_dir/](http://localhost/your_virtual_dir/) ”

然后打开指向您设置的 IIS 位置（和虚拟目录）的 Web 浏览器，这两者应该可以协同工作。

希望有帮助。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2008-11-04T13:50:05.133

[错误：无法在 Web 服务器上开始调试](http://msdn.microsoft.com/en-us/library/dwesw3ee.aspx)

检查上面 MSDN 文章中的要点。IME，它通常是这些东西之一：

1.  应用程序目录是否已在 IIS 中创建为应用程序？在目录选项卡上的应用程序设置下，您将在应用程序名称旁边看到创建按钮。点击这个！

2.  在 IIS 的 ASP.NET 选项卡上，是否选择了正确版本的框架？

3.  重新注册 ASP.NET：在命令提示符窗口中，运行以下命令：systemroot\Microsoft.NET\Framework\ versionNumber \aspnet_regiis -i

# c# - 获取 .Net 字体信息？

> ID：259037
> 
> 赞同：3
> 
> 时间：2008-11-03T15:44:27.993
> 
> 标签：c#, .net, fonts, system.drawing

是否有围绕 Win32 API 的包装器，用于在不实际实例化 .NET Font 类的实例的情况下获取字体信息？

例如，某些字体没有常规样式，因此我需要确定哪些样式对字体有效，而无需实际创建它的实例。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2008-11-03T15:48:56.877

FontFamily.IsStyleAvailable 怎么样？不过，您仍然必须实例化 FontFamily 类，我不知道其中究竟涉及什么，但也许它比 Font 更轻量级。

# http - rtsp over http 通过代理

> ID：259038
> 
> 赞同：6
> 
> 时间：2008-11-03T15:45:11.063
> 
> 标签：http, networking, proxy, streaming, rtsp

我正在尝试使用代理通过 HTTP 获取 RTSP 流。Real 客户端的行为似乎有点忙：它一次尝试所有可能的端口、方法和协议。唯一应该工作的是通过端口 80 的 HTTP GET。确实发出了这样的请求，并在服务器上接收到。以下是代理将请求发送到服务器时的外观：

```
GET /SmpDsBhgRl83c52ef2-d0f4-41ac-bada-93e5350f67d1?1="1" HTTP/1.0\r\n
Connection: Keep-Alive\r\n
Host: 10.194.5.162:80\r\n
Pragma: no-cache\r\n
User-Agent: RealPlayer G2\r\n
Expires: Mon, 18 May 1974 00:00:00 GMT\r\n
Accept: application/x-rtsp-tunnelled, */*\r\n
ClientID: WinNT_5.1_6.0.14.806_RealPlayer_R41UKD_en-GB_686\r\n
X-Actual-URL: rtsp://10.194.5.162:554/01.mp3\r\n
\r\n 
```

这是服务器的响应：

```
HTTP/1.0 200 OK\r\n
Server: RMServer 1.0\r\n
Expires: Mon, 18 May 1974 00:00:00 GMT\r\n
Pragma: no-cache\r\n
x-server-ipaddress: 10.194.5.162\r\n
Content-type: audio/x-pn-realaudio\r\n
\r\n 
```

此时服务器又收到了 4 个字节（它们的值为 48 02 02 00）——仅此而已。服务器在这一点上是否期望客户端提供任何东西，如果是的话 - 什么？这种操作模式是否有效？

关于这个问题的更多信息：显然，RealPlayer 内置的通过 HTTP 使用 RTSP 的预期机制如下：

1.  尝试连接到以下端口：80、8080、554、7070。（也可以通过在端口 80 上发出 GET [http://hostname:port/mediafilename](http://hostname:port/mediafilename)来直接下载文件）
2.  对于上述每个端口，创建 2 个连接。
3.  [向 URL http://hostname:port/SmpDsBhgRl](http://hostname:port/SmpDsBhgRl)`<guid>` ?1="1"的连接之一发送 GET 请求，`<guid>`是的，这里是新创建的 GUID。向此请求添加一个名为 X-Actual-URL 的标头，其中包含原始 RTSP URL。
4.  在另一个连接上向 URL [http://hostname:port/SmpDsBhgRl](http://hostname:port/SmpDsBhgRl)发送一个 POST 请求，并将上面的 GUID 作为请求正文的一部分。发送 32767 字节的 Content-Length 标头，以防止代理过早关闭连接。
5.  开始通过 POST 请求向服务器发出命令，并获取相应的 RTSP 流作为 GET 响应的一部分。

奇怪的东西（如果上面还不够奇怪的话）是，例如，它可以与 Squid 一起使用，但如果您使用端口 3128 或 8080 中的任何一个，则不能！不知何故，客户端使用它连接的端口来决定请求的顺序或何时取消请求，但无论如何，尽管难以置信，它可以使用代理端口 9090、3129、8081，但是不是 3128 或 8080。

更新 #2：[这](https://helixcommunity.org/viewcvs/protocol/common/util/hxcloakedsocket.cpp?view=markup)是 RealPlayer 的源代码以及对上述行为的解释。虽然仍然没有解决方案。

更新#3：好的，根据上述，48 02 02 00 的魔法值很清楚： 48 == 'h' 是 for `HTTP_RESPONSE`，下一个 02 是后面数据的长度，下一个 02 被称为`POST_NOT_RECEIVED`(意味着 POST 请求在相应的 GET 请求后一秒钟内没有到达服务器）。

更新#4：这种行为（即具有巨大 Content-Length 的 POST 请求）也是 WebEx 使用的 ActiveX 的特征（可能还有许多其他需要与服务器建立开放通道的 Web 应用程序）。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2008-11-05T17:11:42.073

首先，您可能想阅读以下内容：

[http://developer.apple.com/quicktime/icefloe/dispatch028.html](http://developer.apple.com/quicktime/icefloe/dispatch028.html)

其次，需要对 HTTP 请求（GET 和 POST）进行格式化，以便它们能够正确代理。我见过坚持缓存太多 POST 请求的代理，以防止它到达服务器。那些代理有问题，但你对此无能为力，而且我无法解决这个问题。大多数情况下，我在防病毒软件中看到了这一点，该软件试图对来自浏览器的 POST 请求进行透明代理，以扫描它们以获取诸如社会安全号码之类的私人信息。你可能会遇到同样的问题。

您是否有机会使用 McAfee 的防病毒软件？

此外，Real 似乎发明了自己的方式来做同样的事情，但基本设计非常相似 - GET 用于下游链接，POST 用于上游，使用一些魔术 cookie（在本例中为 GUID）来绑定两个一起在服务器上。无论哪种方式， POST 都应该到达服务器，而在您的情况下，它似乎没有。

顺便说一句，由于问题似乎与 POST 请求不通过代理有关，那么除了 GET 之外，发布该请求怎么样？

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2008-11-03T22:41:45.000

1.  查看发出相同请求但绕过代理（例如，使用 Netcat 重放您在上面发布的请求）是否会导致响应正文中流式传输超过四个字节。
2.  查看代理正在接收哪些 TCP 数据包，例如，通过窃听运行代理的机器上的 TCP 流量，例如，使用 Wireshark。

# sql - 获取分页 SQL 搜索存储过程的计数

> ID：259039
> 
> 赞同：2
> 
> 时间：2008-11-03T15:45:11.657
> 
> 标签：sql, tsql, search, stored-procedures, paging

我使用 SQL Server 2005 编写了一个分页搜索存储过程。它需要许多参数并且搜索条件比较复杂。

由于前端架构，我需要能够返回将返回的结果数量，**而无需**实际返回结果。然后前端将再次调用存储过程以获取实际结果。

一方面，我可以编写两个存储过程——一个处理计数，一个处理实际数据，但是我需要在至少两个不同的地方维护搜索逻辑。或者，我可以编写存储过程，以便它接受一个位参数，并在此基础上返回数据或仅返回一个计数。也许用数据填充一个临时表，如果它只是计数，则从中进行计数，否则从中进行选择。这里的问题是可以优化计数过程，因此看起来有很多额外的开销（必须获得不需要的列等）。此外，在存储过程中使用这种逻辑可能会导致错误的查询计划，因为它在两种用途之间来回切换。

系统中的数据量并不太高（即使是更大的表也只有几百万行）。但是可能有很多并发用户。

人们对这些方法有何看法？以前有没有人以我没有想到的方式解决了这个问题？

他们**不能**从单个呼叫中同时获取结果和计数。

谢谢！

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2008-11-03T15:53:33.670

我个人使用两个查询方法，是的，您必须在两个地方维护搜索逻辑，但我发现性能优化的好处和代码的整体清洁度最终得到了回报。

使用传递给单个过程的标志是一种潜在的解决方案，但我发现这很难维护，尤其是对于复杂的搜索逻辑。

使用临时表等的路线，只会增加比所需更多的开销。

因此，为什么我用两种查询方法登陆。我在网上找到的所有内容也都推荐这种方法。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2008-11-03T15:52:50.487

这不是一个正常的问题，您通常希望在获得页面的同时获得总计数。

也就是说，使用两种不同的程序。原因是你有两个非常不同的动作，它们只是表面上相似。

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2009-11-10T16:32:46.373

我确定您已经考虑过这一点：如果数据正在更改 COUNT 并且任何后续的实际分页可能会有所不同（如果添加/删除了行）

你可以有一个用户定义的函数，它返回匹配行的 PK，相对容易做

```
从 dbo.MyQueryFunction（@Param1，@Param2）中选择计数（*）

```

得到计数，然后

```
选择 Col1, Col2, ...
FROM dbo.MyQueryFunction(@Param1, @Param2) AS FN
     加入 dbo.MyTable 作为 T
         ON T.ID = FN.ID
     ... 更多 JOIN ...

```

获取数据。

不知道这与 Row_Number 在后续分页中的效果如何，但它会保留 MyQueryFunction 中包含的实际“查询逻辑” - 您仍然将在 Sproc 中检索到重复的任何列的所有 JOIN 和功能。

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2008-11-03T15:55:39.797

可能对您的具体问题没有帮助，但 SQL 2005 引入了 Row_Number 函数，该函数便于分页检查

[行号示例](http://www.davidhayden.com/blog/dave/archive/2005/12/30/2652.aspx)

比临时表容易得多。

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2009-11-10T16:05:26.623

我发现这个线程正在研究其他东西，并认为我会提到可以通过一个查询返回结果集和记录数。你只需要一个'out'参数来携带这个值。下面是 Oracle 示例的复制/粘贴，但该技术与 SQL Server 非常相似（我无权访问 SQL Server atm）。

SQL Server 最重要的一点是您可能需要使用 row_number() 与 rownum。

```
procedure get_sample_results (
    startrow in number default 1,
    numberofrows in number default 10,
    whereclause in varchar2,
    matchingrows out number,
    rc  out sys_refcursor
)
is
    stmnt varchar2(5000);
    endrow number;
begin

    stmnt := stmnt || 'select * from table t where 1=1';
    if whereclause is not null then
        stmnt := stmnt || ' and ' || whereclause;
    end if;

    execute immediate 'select count(*) from (' || stmnt || ')' into matchingrows;

    stmnt := 'select * from (' || stmnt || ') where rownum between :1 and :2';        

    -- must subtract one to compenstate for the inclusive between clause
    endrow := startrow + numberofrows - 1;
    open rc for stmnt using startrow, endrow;

end get_sample_results; 
```

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2010-11-15T13:17:10.977

我知道这是一个老问题（已经被标记），但是您可以返回一个记录集（也就是结果）并拥有一个 OUTPUT（或多个输出）值，这意味着您只需要一次往返数据库。

这是我正在大声思考的事情（而且已经过了我睡觉的时间......）

```
CREATE PROCEDURE WhatEver
(
   @SomeParam1 NVARCHAR(200),
   ....
   @SomeParam_X INT,
   @NumberOfResults INTEGER OUTPUT
)
BEGIN
    SET NOCOUNT ON

    -- Do your search stuff.
    -- ....
    SELECT Whatever
    FROM WhatWhat
    ...

    -- Ok, the results/recordset has been sent prepared.
    -- Now the rowcount
    SET @NumberOfResults = @@ROWCOUNT
END 
```

HTH。

# wpf - WPF HiercharchicalDataTemplate.DataType：如何对接口做出反应？

> ID：259063
> 
> 赞同：3
> 
> 时间：2008-11-03T15:54:10.453
> 
> 标签：wpf, interface, templates, types

### 问题

我有一个`IThing`s 的集合，我想`HierarchicalDataTemplate`为 a 创建一个`TreeView`。直截了当`DataType={x:Type local:IThing}`当然行不通，可能是因为 WPF 创建者不想处理可能的歧义。

由于这应该同时处理`IThing`来自不同来源的 s，所以引用实现类是没有问题的。

### 当前解决方案

现在我正在使用通过具体实现代理 IThing 的 ViewModel：

```
public interface IThing {
    string SomeString { get; }
    ObservableCollection<IThing> SomeThings { get; }
    // many more stuff
}

public class IThingViewModel
{
     public IThing Thing { get; }
     public IThingViewModel(IThing it) { this.Thing = it; }
}

<!-- is never applied -->
<HierarchicalDataTemplate DataType="{x:Type local:IThing}">

<!-- is applied, but looks strange -->
<HierarchicalDataTemplate
    DataType="{x:Type local:IThingViewModel}"
    ItemsSource="{Binding Thing.SomeThings}">
    <TextBox Text="{Binding Thing.SomeString}"/>
</HierarchicalDataTemplate> 
```

### 问题

有没有更好的（即没有代理）方式？

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-03-21T11:56:45.307

另一种选择（类似于jing的解决方案）：如果您只有一种类型的项目，您可以直接设置ItemTemplate。然后您不需要设置键或数据类型。

在您的视图模型中：

```
public ObservableCollection<IThing> Thingies { get; private set; } 
```

在视图中：

```
<TreeView ItemsSource="{Binding Thingies}">
    <TreeView.ItemTemplate>
        <HierarchicalDataTemplate ItemsSource="{Binding SomeThings}">
            <TextBox Text="{Binding SomeString}" />    
        </HierarchicalDataTemplate>
    </TreeView.ItemTemplate>
</TreeView> 
```

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2008-12-16T17:02:26.050

原因是默认模板选择器只支持具体类型，不支持接口。您需要创建一个自定义 DataTemplateSelector 并将其应用于 TreeView 的 ItemTemplateSelector 属性。我找不到找到它的示例的 URL，但希望有了这些信息，你可以谷歌它。

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2010-04-02T08:09:58.157

另一种解决方案是你给 HierarchicalDataTemplate 一个键并将它放在 Windows.Resources 中，然后在 TreeView 中手动引用它。 `<TreeView ItemDataTemplate={StaticResource templateKey}/>`

但这限制了根据 WPF TreeView 提供的数据类型自动选择数据模板。

# php - PHP 在 PHP 中处理/更容易处理哪个更快；XML 或 JSON，以及 file_get_contents 或 cURL？

> ID：259072
> 
> 赞同：3
> 
> 时间：2008-11-03T15:55:54.037
> 
> 标签：php, json, xml

有什么理由我应该选择 JSON 而不是 XML，或者如果两者都可用，反之亦然？在处理数据馈送时优化性能的提示也值得赞赏！

* * *

## 回答 #1

> 赞同：9
> 
> 时间：2008-11-03T16:09:12.420

谈到 PHP，我选择 XML 而不是 JSON 的一个原因是，即使在 PHP 5 中，也没有官方支持的用于遍历的 API。你可以编码，你可以解码，就是这样。没有验证，没有有效的方法来遍历键/值对，总而言之，对它的支持很少。不要误会我的意思，你可以只使用一个foreach循环结构，但它确实很麻烦。JSON 被吹捧为一种出色的数据交换格式，因为 JavaScript 很容易理解词法结构。所以当你从 PHP 转到 JavaScript 时，它很棒，但是当你从 JavaScript 转到 PHP，或者从 PHP 转到 PHP 时，JSON 并不是数据交换的最佳选择。

* * *

## 回答 #2

> 赞同：5
> 
> 时间：2008-11-03T16:31:12.657

我自己会使用 JSON，只是因为 XML 非常臃肿且难以解析。JSON 小而整洁，因此可以节省带宽，并且还应该加快响应时间，因为它更容易生成、传输更快、解码更快。

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2008-11-03T17:51:06.990

无论你选择哪种方式，当你选择为 IO 序列化数据时，序列化机制应该是透明的、可替换的。如果您发现 JSON 不适合您，您应该能够交换您在正面和背面使用的序列化程序，并且您的数据结构保持不变。

也就是说，我传输的大多数数据数组只是大键值树。我发现当我的数据结构未包装在 XML 序列化中时，它们更容易阅读原始数据结构。

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2008-11-19T17:15:42.197

关于 file_get_contents() 与 cURL 的性能，我相信 cURL 会稍微快一些。对于您的应用程序，您可以运行一些快速基准测试来比较这两种方法。

更重要的是，我更喜欢 cURL，因为 file_get_contents() 不能在实现了更高级别安全性的 PHP 环境中工作（例如，*allow_url_fopen*设置通常被禁用）。如果您的应用程序只能在您自己的环境（由您控制​​）上运行，那么 file_get_contents() 就可以了，否则我会使用 cURL 以实现可移植性。

# c# - 如何将搜索词解析为各种问题类型？

> ID：259074
> 
> 赞同：4
> 
> 时间：2008-11-03T15:56:09.513
> 
> 标签：c#, regex, parsing

我正在编写一个内部应用程序，我们让用户可以执行几种不同类型的查询。

该应用程序允许用户通过以下任一键搜索数据库：

*   员工ID
*   姓名（名字或姓氏）
*   公司编号
*   状态（workingFullTime、sickLeave、maternityLeave 等）

蛮力方法是为每种类型的查询简单地制作一个 web 表单，并有一个菜单，用户可以在其中选择要执行的查询类型（这是 ASP.NET）

但我想要的是有一个简单的文本框，用户在其中输入查询，然后应用程序应该解析查询并自动选择要向后端发出的查询类型。

例如，employeeId 是一个精确格式的数字。所以我可以做一个正则表达式来匹配它。status、companyId 等也是如此。

所以我的问题是，这里是否有人可以就如何最好地编写 C# 中的方法提供一些建议，该方法将采用字符串并将其与许多不同的正则表达式进行匹配。

干杯，乔金

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2008-11-03T16:07:59.723

直接的方法是让一系列`if`语句依次测试每个正则表达式：

```
if (Regex.Match(query, regex1)) {
    HandleFirstCase(query);
} else if(Regex.Match(query, regex2)) {
    HandleSecondCase(query);
} ... 
else {
    HandleFullTextSearch();
} 
```

更复杂的方法是数据驱动方法，您将正则表达式和操作存储在表中并循环它们：

```
public class RegexAction {
    public Regex Pattern { get; private set; }
    public Action<string> Handler { get; private set; }
    public RegexAction(Regex pattern, Action<string> handler) {
        this.Pattern = pattern;
        this.Handler = handler;
    }
}

public static RegexAction[] HandlerTable = new RegexAction[] {
    new RegexAction(regex1, HandleFirstCase),
    new RegexAction(regex2, HandleSecondCase),
    new RegexAction(regex3, HandleThirdCase),
    // ...
}

foreach(RegexAction action in HandlerTable) {
    if (action.Match(query)) {
        action.Handler(query);
        break;
    }
} 
```

这有助于将重要的数据、模式和操作与测试和调用的实现分开。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2008-11-03T16:13:49.977

我要做的只是一个 OR 查询：

```
select * from employee where employeeId = search OR name like "%search%" OR status = "search" 
```

# dictionary - 我在哪里可以获得用于检查拼写的字典文件？

> ID：259085
> 
> 赞同：3
> 
> 时间：2008-11-03T15:58:47.090
> 
> 标签：dictionary

我以为以前有人问过这个问题，但是在 Google 上搜索了 15 分钟，站点搜索并没有出现任何结果……所以：

我在哪里可以获得免费的（如啤酒和/或语音）字典文件？我主要对英语感兴趣，但如果您知道任何字典文件，请指出。

注意：这个问题没有正确/错误的答案，所以我把它做成了社区维基。但是，我觉得它可能不仅对我自己有价值，而且对任何希望实现或使用带有各种字典文件的拼写检查器的人都很有价值。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2008-11-03T16:01:42.887

我找到了一个[名为 Word List 的 SourceForge 项目](http://wordlist.sourceforge.net/)，它似乎有许多词典。我已经下载了几个，目前正在检查它们。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2008-11-03T16:35:32.163

在 Linux 上，您可以查看以下位置`/usr/share/dict/words`

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2008-11-03T16:15:00.600

我假设 OpenOffice 包含多种语言的字典。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2008-11-03T16:33:27.707

我不知道您的目标平台是什么，但这里有一个适用于 VB.NET 的解决方案。它使用 Office 本身不是免费的 Office 库，但如果您的用户都是内部用户并且拥有 Office，那么您可以利用这些库。您也可以下载一个包含示例源代码的 zip 文件。

[检查拼写和语法](http://www.devcity.net/PrintArticle.aspx?ArticleID=89 "DevCity 拼写检查")

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2010-01-09T14:45:35.047

[CodeProject.com 上](http://www.codeproject.com/KB/recipes/spellchecker_pp.aspx)似乎免费提供了一本还不错的字典（不幸的是，需要注册）。

# asp.net - 有谁知道“共享”数据源而不会导致多次回发的方法？

> ID：259087
> 
> 赞同：2
> 
> 时间：2008-11-03T15:58:56.340
> 
> 标签：asp.net, data-binding, sqldatasource

例如，我有一个加载项目列表的 SqlDataSource。在我的表单上，我有 3 个下拉框，它们都应该包含相同的值列表，然后用户可以为每个下拉框选择不同的值并保存。

通过将每个下拉列表连接到同一个 SqlDataSource，数据库会被命中 3 次 - 每个将其列为数据源的对象一次。如果我删除您在 SmartTag 界面中找到的“自动”链接，我仍然需要在每个组合框上调用 DataBind 的代码隐藏，这将再次导致对数据库的三个调用。

我想我可以将这些值拉回到我存储在 ViewState 中的字符串列表中，但是有更好的方法吗？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2008-11-03T16:25:11.670

为什么不为数据源启用缓存？

* * *

## 回答 #2

> 赞同：-1
> 
> 时间：2008-11-03T16:13:27.840

您应该放弃对表单元素的直接数据绑定的依赖，只需构建一个可复制或克隆的列表或数组。然后将您的单独列表绑定到表单元素并“编写代码”以处理您希望它对您的数据源执行的操作。

# screen-scraping - 如何将 HTML 表格抓取到 CSV？

> ID：259091
> 
> 赞同：43
> 
> 时间：2008-11-03T16:00:26.540
> 
> 标签：screen-scraping

# 问题

我在工作中使用了一个工具，它可以让我进行查询并取回 HTML 信息表。我没有任何形式的后端访问它。

如果我可以将这些信息放入电子表格中进行排序、平均等，那么这些信息会更加有用。**如何将这些数据截屏到 CSV 文件中？**

## 我的第一个想法

因为我知道 jQuery，我想我可以用它来去除屏幕上的表格格式，插入逗号和换行符，然后将整个混乱复制到记事本中并保存为 CSV。**有更好的想法吗？**

# 解决方案

是的，伙计们，这真的就像复制和粘贴一样简单。我不觉得很傻吗。

具体来说，当我粘贴到电子表格中时，我必须选择“选择性粘贴”并选择“文本”格式。否则，即使我突出显示了整个电子表格，它也会尝试将所有内容粘贴到单个单元格中。

* * *

## 回答 #1

> 赞同：34
> 
> 时间：2008-11-03T16:03:57.343

*   在工具的 UI 中选择 HTML 表格并将其复制到剪贴板（如果可能的话
*   将其粘贴到 Excel 中。
*   另存为 CSV 文件

但是，这是一种手动解决方案，而不是自动化解决方案。

* * *

## 回答 #2

> 赞同：13
> 
> 时间：2008-11-11T01:17:11.267

使用蟒蛇：

例如，假设您想从某个站点以 csv 格式抓取外汇报价，例如：[fxquotes](http://www.oanda.com/convert/fxhistory?date_fmt=us&date=11/10/08&date1=01/01/08&exch=USD&exch2=USD&expr=AUD&expr2=AUD&lang=en&margin_fixed=0&format=CSV&redirected=1)

然后...

```
from BeautifulSoup import BeautifulSoup
import urllib,string,csv,sys,os
from string import replace

date_s = '&date1=01/01/08'
date_f = '&date=11/10/08'
fx_url = 'http://www.oanda.com/convert/fxhistory?date_fmt=us'
fx_url_end = '&lang=en&margin_fixed=0&format=CSV&redirected=1'
cur1,cur2 = 'USD','AUD'
fx_url = fx_url + date_f + date_s + '&exch=' + cur1 +'&exch2=' + cur1
fx_url = fx_url +'&expr=' + cur2 +  '&expr2=' + cur2 + fx_url_end
data = urllib.urlopen(fx_url).read()
soup = BeautifulSoup(data)
data = str(soup.findAll('pre', limit=1))
data = replace(data,'[<pre>','')
data = replace(data,'</pre>]','')
file_location = '/Users/location_edit_this'
file_name = file_location + 'usd_aus.csv'
file = open(file_name,"w")
file.write(data)
file.close() 
```

* * *

编辑：从表中获取值：示例来自：[palewire](http://www.palewire.com/tag/python-beautifulsoup-table-parse/)

```
from mechanize import Browser
from BeautifulSoup import BeautifulSoup

mech = Browser()

url = "http://www.palewire.com/scrape/albums/2007.html"
page = mech.open(url)

html = page.read()
soup = BeautifulSoup(html)

table = soup.find("table", border=1)

for row in table.findAll('tr')[1:]:
    col = row.findAll('td')

    rank = col[0].string
    artist = col[1].string
    album = col[2].string
    cover_link = col[3].img['src']

    record = (rank, artist, album, cover_link)
    print "|".join(record) 
```

* * *

## 回答 #3

> 赞同：11
> 
> 时间：2013-05-22T17:11:10.133

这是我使用（当前）最新版本的 BeautifulSoup 的 python 版本，可以使用例如，

```
$ sudo easy_install beautifulsoup4 
```

该脚本从标准输入读取 HTML，并以正确的 CSV 格式输出在所有表中找到的文本。

```
#!/usr/bin/python
from bs4 import BeautifulSoup
import sys
import re
import csv

def cell_text(cell):
    return " ".join(cell.stripped_strings)

soup = BeautifulSoup(sys.stdin.read())
output = csv.writer(sys.stdout)

for table in soup.find_all('table'):
    for row in table.find_all('tr'):
        col = map(cell_text, row.find_all(re.compile('t[dh]')))
        output.writerow(col)
    output.writerow([]) 
```

* * *

## 回答 #4

> 赞同：5
> 
> 时间：2008-11-11T03:04:50.817

更容易（因为它会为您保存下次使用）...

在 Excel 中

数据/导入外部数据/新建网页查询

将带您进入 url 提示。输入您的网址，它将在页面上分隔要导入的可用表。瞧。

* * *

## 回答 #5

> 赞同：5
> 
> 时间：2015-01-22T07:37:25.260

我想到了两种方法（尤其是对于我们这些没有 Excel 的人）：

*   谷歌电子表格有[一个出色的`importHTML`功能](https://support.google.com/docs/answer/3093342)：
    *   `=importHTML("http://example.com/page/with/table", "table", index`
    *   索引从 1 开始
    *   我建议在导入`copy`后`paste values`不久
    *   文件 -> 下载为 -> CSV
*   Python 超棒的Pandas [库](http://pandas.pydata.org/)，好用又[`read_html`](http://pandas.pydata.org/pandas-docs/version/0.15.1/generated/pandas.io.html.read_html.html?highlight=read_html#pandas.io.html.read_html)好用[`to_csv`](http://pandas.pydata.org/pandas-docs/version/0.15.1/generated/pandas.DataFrame.to_csv.html?highlight=to_csv#pandas.DataFrame.to_csv)
    *   这是[一个基本的 Python3 脚本](https://gist.github.com/n8henrie/08a31f02fd1282d12b75)，它提示输入 URL、该 URL 的哪个表以及 CSV 的文件名。

* * *

## 回答 #6

> 赞同：2
> 
> 时间：2008-11-03T16:09:00.377

又快又脏：

从浏览器复制到 Excel，另存为 CSV。

更好的解决方案（长期使用）：

用您选择的语言编写一些代码，将 html 内容拉下来，并刮出您想要的部分。您可能会在数据检索之上投入所有数据操作（排序、平均等）。这样，您只需运行您的代码并获得您想要的实际报告。

这完全取决于您执行此特定任务的频率。

* * *

## 回答 #7

> 赞同：2
> 
> 时间：2008-11-11T01:25:57.287

Excel可以打开一个http页面。

例如：

1.  点击文件，打开

2.  在文件名下，粘贴 URL，即：[如何将 HTML 表格抓取到 CSV？](https://stackoverflow.com/questions/259091/how-can-i-scrape-an-html-table-to-csv)

3.  点击确定

Excel 尽最大努力将 html 转换为表格。

它不是最优雅的解决方案，但确实有效！

* * *

## 回答 #8

> 赞同：2
> 
> 时间：2015-03-26T10:34:00.617

使用 BeautifulSoup 的基本 Python 实现，同时考虑 rowspan 和 colspan：

```
from BeautifulSoup import BeautifulSoup

def table2csv(html_txt):
   csvs = []
   soup = BeautifulSoup(html_txt)
   tables = soup.findAll('table')

   for table in tables:
       csv = ''
       rows = table.findAll('tr')
       row_spans = []
       do_ident = False

       for tr in rows:
           cols = tr.findAll(['th','td'])

           for cell in cols:
               colspan = int(cell.get('colspan',1))
               rowspan = int(cell.get('rowspan',1))

               if do_ident:
                   do_ident = False
                   csv += ','*(len(row_spans))

               if rowspan > 1: row_spans.append(rowspan)

               csv += '"{text}"'.format(text=cell.text) + ','*(colspan)

           if row_spans:
               for i in xrange(len(row_spans)-1,-1,-1):
                   row_spans[i] -= 1
                   if row_spans[i] < 1: row_spans.pop()

           do_ident = True if row_spans else False

           csv += '\n'

       csvs.append(csv)
       #print csv

   return '\n\n'.join(csvs) 
```

* * *

## 回答 #9

> 赞同：1
> 
> 时间：2017-04-12T22:47:57.350

这是一个**经过测试**的示例，它结合了 grequest 和 soup 从结构化网站下载大量页面：

```
#!/usr/bin/python

from bs4 import BeautifulSoup
import sys
import re
import csv
import grequests
import time

def cell_text(cell):
    return " ".join(cell.stripped_strings)

def parse_table(body_html):
    soup = BeautifulSoup(body_html)
    for table in soup.find_all('table'):
        for row in table.find_all('tr'):
            col = map(cell_text, row.find_all(re.compile('t[dh]')))
            print(col)

def process_a_page(response, *args, **kwargs): 
    parse_table(response.content)

def download_a_chunk(k):
    chunk_size = 10 #number of html pages
    x = "http://www.blahblah....com/inclusiones.php?p="
    x2 = "&name=..."
    URLS = [x+str(i)+x2 for i in range(k*chunk_size, k*(chunk_size+1)) ]
    reqs = [grequests.get(url, hooks={'response': process_a_page}) for url in URLS]
    resp = grequests.map(reqs, size=10)

# download slowly so the server does not block you
for k in range(0,500):
    print("downloading chunk ",str(k))
    download_a_chunk(k)
    time.sleep(11) 
```

* * *

## 回答 #10

> 赞同：0
> 
> 时间：2008-11-03T16:09:18.660

你试过用excel打开吗？如果您将 excel 中的电子表格另存为 html，您将看到 excel 使用的格式。从我编写的一个网络应用程序中，我吐出了这种 html 格式，以便用户可以导出到 excel。

* * *

## 回答 #11

> 赞同：0
> 
> 时间：2008-11-03T17:09:22.110

如果您正在屏幕抓取并且您尝试转换的表格具有给定的 ID，您总是可以对 html 进行正则表达式解析以及一些脚本来生成 CSV。

# wpf - WPF ListBox 绑定到项目的索引

> ID：259092
> 
> 赞同：7
> 
> 时间：2008-11-03T16:01:25.277
> 
> 标签：wpf, data-binding, datatemplate

将某些内容绑定到 ListBox 的 SelectedIndex 很容易，但我希望 ListBox 中的每个项目都能够绑定到它在列表中的索引。

可能听起来很奇怪，所以这就是我想要做的：

```
<DataTemplate x:Key="ScenarioItemTemplate">
<Border
    Margin="8,2,8,2"
    Background="#FF3C3B3B"
    BorderBrush="#FF797878"
    BorderThickness="2"
    CornerRadius="5">
    <DockPanel>
        <DockPanel DockPanel.Dock="Top" Margin="0,2,0,0">
            <Label HorizontalAlignment="Left"
                   DockPanel.Dock="Left"
                   FontWeight="Heavy"
                   Foreground="White"
                   Content="{Binding Path=Position}"
                   MinWidth="50"/>

            <Label
                   Content="{Binding Path=Name}"
                   DockPanel.Dock="Left"
                   FontWeight="Heavy"
                   Foreground="white"/>
            <Label 
                   Content="{Binding Path=Header}"
                   Foreground="white"
                   DockPanel.Dock="Left"/>

            <TextBlock HorizontalAlignment="Right" 
                       Background="#FF3C3B3B" 
                       DockPanel.Dock="Left" Foreground="White" FontWeight="Heavy">
                <Hyperlink Click="CloseHyperlink_Click" Tag="">X</Hyperlink>
            </TextBlock> 
```

我想将超链接的 TAG 属性绑定到相关项目的索引。这样当用户单击超链接时，我可以使用该超链接的 TAG 属性确定是什么项目导致了事件。

```
var hyperlink = (Hyperlink)sender;
var index = Convert.ToInt32(hyperlink.Tag); 
```

建议？

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2008-11-03T16:17:02.810

据我所知，实际上并没有一个属性可以指示您的项目的索引。如果您有权访问 ListBox 绑定到的项目的原始列表，则可以访问超链接的 DataContext 以确定项目的索引，如下所示：

```
var hyperlink = (Hyperlink)sender;
var item = (SourceType)hyperlink.DataContext;
int index = sourceList.IndexOf(item); 
```

或者，您可以在超链接上调用 ItemsControl.ContainerFromElement 以获取与超链接关联的 ListBoxItem，然后在 ListBox 中找到 ListBoxItem 的位置，但它并不能真正为您提供您尚未拥有的任何东西。

# axapta - 如何使页脚 axapta 报告工具打印在页面底部？

> ID：259095
> 
> 赞同：0
> 
> 时间：2008-11-03T16:02:18.660
> 
> 标签：axapta, microsoft-dynamics

我正在尝试在报告底部打印一些内容。我正在使用一个部分`Pagefooter`。
我想如果你使用`Pagefooter`它，它会打印在报告的底部。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-05-09T11:09:49.670

我认为您需要打印列中字段的总和，`sum all`在属性节点中使用属性。在页脚中显示的缺点是如果报表超过一页，报表上的每一页都会被打印。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2008-11-20T09:51:59.313

是的，您可以使用 Pagefooter 部分在页面末尾显示页脚。

# asp.net - 将表单数据从母版页传递到其他页面 ASP.NET

> ID：259099
> 
> 赞同：0
> 
> 时间：2008-11-03T16:03:57.297
> 
> 标签：asp.net, search, master-pages

我以前也问过类似的问题，但我并没有牢牢把握我遇到的问题是什么。我的问题是当页面更改时，我无法从驻留在主控上的 TextBox 获取数据。这是发生的事情：

1.  带有文本框和按钮的 MasterPage。
2.  将数据输入到文本框并单击按钮。
3.  表单的操作设置为 search.aspx，webapp 在那里导航。
4.  此函数获取 TextBox 的内容：

* * *

```
Public Function oSearchString(ByVal oTextBoxName As String) As String  
    If Master IsNot Nothing Then  
        Dim txtBoxSrc As New TextBox  
        txtBoxSrc = CType(Master.FindControl(oTextBoxName), TextBox)  
        If txtBoxSrc IsNot Nothing Then  
            Return txtBoxSrc.Text  
        End If  
    End If  
    Return Nothing  
End Function 
```

当此代码执行时，它会返回`""`，即使在框中输入了文本。我尝试将默认值放入框中，并且可以很好地通过（即`<asp:TextBox ID="searchbox" runat="server" text="searchbox"></asp:TextBox>`yield `"searchbox"`）。

现在我已经从主页提交了搜索表单，我在搜索页面 (search.aspx) 上。如果我再次输入搜索字符串，代码将返回我在文本框中输入的任何内容。我尝试将上面的代码从**`Master`**to修改，**`PreviousPage`**但这根本不起作用，因为文本框控件位于母版页上。

希望我对背景信息的布局足够好，如果需要进一步澄清，请告诉我。

* * *

**编辑**：使用`Request.Form("searchbox")`产量`Nothing`。我检查了`Request.Form()`对象，发现我的文本框的 ID 实际上是`ctl00$searchbox`. 使用它作为 ID 或其索引（在本例中为 3）会给我正确的结果。最好重写该函数以检查包含 的键中`Request.Form()`的所有键`searchbox`，还是有一种方法可以获得文本框的实际 ID？对于前一个选项，这是我想出的：

```
Public Function oSearchString(ByVal oTextBoxName As String) As String
    For Each oKey As String In Request.Form.AllKeys
        If oKey.Contains(oTextBoxName) Then
            Return Request.Form(oKey)
        End If
    Next
    Return ""
End Function 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2008-11-03T16:37:18.090

对于要加载到控件内页面的值，您必须在回发中，这就是它在从搜索页面发布时起作用的原因。

要在输入来自其他区域时获取值，您需要使用 Request.Form("Element") 从发布的表单中获取值。如果这是你需要走的路，只要确保你知道搜索框的 id 就可以了。

# wpf - WPF中的环境光遮蔽着色器效果？

> ID：259104
> 
> 赞同：3
> 
> 时间：2008-11-03T16:06:44.327
> 
> 标签：wpf, 3d, directx, xna, pixelsense

我想这是一个多部分的问题。

我可以将 3D 模型导入到我的 WPF 应用程序中，但是如何将环境光遮蔽着色器效果应用到它？我知道使用 .NET 3.5 SP1 你可以做自定义效果，但这仅限于像素着色器，不包括顶点着色器。

我想我可以用 XNA 应用程序做到这一点，但我不熟悉 XNA，所以第二个问题是：WPF 和 XNA 有多大不同？我似乎在 XNA 中没有任何关于 XAML 的概念。从 WPF 迁移到 XNA 需要多少提升？

谢谢，克里斯

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2008-11-03T17:26:46.880

回答你的第二个问题：

WPF 和 XNA 完全不同。他们确实共享以下内容：

*   建立在 .net 上
*   使用 DirectX
*   可以访问显卡的硬件加速

XNA 没有内置任何 GUI 支持，并且真正针对游戏（用于 PC 和 XBOX-360），而 WPF 可用于商业风格的应用程序。正如您发现的那样，XNA 没有任何 XAML 支持，实际上它主要是 DirectX 的抽象 .net 包装器。

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2008-11-05T19:36:28.460

如果您了解诸如“[环境光遮蔽](http://www-viz.tamu.edu/students/bmoyer/617/ambocc/)”之类的术语，那么您可能应该使用 XNA。XNA 作为一个 API 并不难学，但如前所述，它是为游戏开发而设计的。那里有很多很棒的[XNA 教程](http://creators.xna.com/en-US/education/)。

**您可以同时使用 WPF 和 XNA ，请**[在此处](https://stackoverflow.com/questions/43596/how-well-does-wpf-blend-with-xna-in-real-life)阅读更多相关信息。

你能告诉我们更多关于你正在尝试做的事情吗？

# asp.net - 用于实时监控 ASP.NET Web 应用程序的工具和方法？

> ID：259105
> 
> 赞同：21
> 
> 时间：2008-11-03T16:07:42.610
> 
> 标签：asp.net, performance, monitoring, production

我认为许多开发人员都知道当用户告诉他们*“应用程序很慢（再次）”时那种不舒服的感觉。*

在复杂的 Web 应用程序中，（感知的）性能下降可能有**许多可能的原因**：数据库响应缓慢、带宽问题、缓存不良等。当然，在开发或暂存环境中永远不会出现一些问题。

现在我的问题：

是否有一组工具和/或方法可以直观地**在 IIS/ASP.NET/SQL Server 生产系统上提供全面的“实时”状态**（不仅仅是性能计数器）：

*   当前的 HTTP 请求（比如最后 n 分钟）
*   异常/超时
*   带宽数据
*   打开的数据库连接/数据库调用数
*   ...

主要目标是一目了然（或仔细观察后）是什么问题导致了性能问题。

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2008-11-03T16:48:40.873

我认为您正在寻找的软件类别是“.net profiler”或“.net tracer”。您可能会考虑使用 JetBrains 的[dotTrace](http://www.jetbrains.com/profiler/)工具。它为您提供运行时堆栈跟踪和指示可能瓶颈的计数器数组。

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2008-11-03T17:43:47.550

前面提到的工具肯定会起作用。在我们的商店，我们需要更详细的信息并构建了自己的解决方案（长话短说：编码比争论工具和可检索数据更容易）。

我使用[LogParser](http://www.iis.net/downloads/default.aspx?tabid=34&g=6&i=1287)翻阅 IIS 日志并创建这些日志的输出报告（例如结果代码故障等）。

我使用了性能计数器和 WMI 值的组合来获取其余部分 - 您可以使用一些非常简单的 C# 来阅读这些 - 这使您可以完全控制，然后您可以转储到 .csv 等以便在 excel 中查看/处理，或者如果您正在更新一个页面作为控制中心。

我可能还会将[IIS.net](http://www.iis.net/)视为 IIS 工具的绝佳资源，包括调试、安全等。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2008-11-03T17:17:32.750

我按照[urig 的建议](https://stackoverflow.com/questions/259105/tools-and-methods-for-live-monitoring-aspnet-web-applications#259242)找到[了这个名为 SmartInspect 的软件](http://www.gurock.com/products/smartinspect/)。

有人知道这个日志/监控工具吗？它似乎是实时控制台和开发人员库的组合。

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2011-09-23T19:34:10.273

CLR 4.5 将具有一些新功能，可帮助您实时监控 ASP.NET 性能 - 无需重新启动您的应用程序。基本上，您可以重新 JIT 代码以在其中包含一些监控钩子，然后检查在类/方法等中花费的时间。

我确信 dotTrace 和其他分析工具会自动利用这一点，但值得一试：[C9 - David Broman 的 Inside Re-JIT](http://channel9.msdn.com/Shows/Going+Deep/CLR-45-David-Broman-Inside-Re-JIT)

# ruby-on-rails - drb 和“被回收对象”异常

> ID：259111
> 
> 赞同：7
> 
> 时间：2008-11-03T16:10:00.453
> 
> 标签：ruby-on-rails, ruby, drb

我遇到了一个奇怪的问题。我的控制器调用了一个 drb 对象

```
@request_handler = DRbObject.new(nil, url)
availability_result = @request_handler.fetch_availability(request, @reservation_search, params[:selected_room_rates]) 
```

这个 Drb 对象正在做一些搜索。

但有时，在 linux 环境中，我通过这个堆栈跟踪得到一个“0xdba87b30 是回收对象”

```
--- 
- (druby://10.254.143.159:9001) /usr/lib/ruby/1.8/drb/drb.rb:375:in `_id2ref'
- (druby://10.254.143.159:9001) /usr/lib/ruby/1.8/drb/drb.rb:375:in `to_obj'
- (druby://10.254.143.159:9001) /usr/lib/ruby/1.8/drb/drb.rb:1402:in `to_obj'
- (druby://10.254.143.159:9001) /usr/lib/ruby/1.8/drb/drb.rb:1704:in `to_obj'
- (druby://10.254.143.159:9001) /usr/lib/ruby/1.8/drb/drb.rb:613:in `recv_request'
- (druby://10.254.143.159:9001) /usr/lib/ruby/1.8/drb/drb.rb:911:in `recv_request'
- (druby://10.254.143.159:9001) /usr/lib/ruby/1.8/drb/drb.rb:1530:in `init_with_client'
- (druby://10.254.143.159:9001) /usr/lib/ruby/1.8/drb/drb.rb:1542:in `setup_message'
- (druby://10.254.143.159:9001) /usr/lib/ruby/1.8/drb/drb.rb:1494:in `perform'
- (druby://10.254.143.159:9001) /usr/lib/ruby/1.8/drb/drb.rb:1589:in `main_loop'
- (druby://10.254.143.159:9001) /usr/lib/ruby/1.8/drb/drb.rb:1585:in `loop'
- (druby://10.254.143.159:9001) /usr/lib/ruby/1.8/drb/drb.rb:1585:in `main_loop'
- (druby://10.254.143.159:9001) /usr/lib/ruby/1.8/drb/drb.rb:1581:in `start'
- (druby://10.254.143.159:9001) /usr/lib/ruby/1.8/drb/drb.rb:1581:in `main_loop'
- (druby://10.254.143.159:9001) /usr/lib/ruby/1.8/drb/drb.rb:1430:in `run'
- (druby://10.254.143.159:9001) /usr/lib/ruby/1.8/drb/drb.rb:1427:in `start'
- (druby://10.254.143.159:9001) /usr/lib/ruby/1.8/drb/drb.rb:1427:in `run'
- (druby://10.254.143.159:9001) /usr/lib/ruby/1.8/drb/drb.rb:1347:in `initialize'
- (druby://10.254.143.159:9001) /usr/lib/ruby/1.8/drb/drb.rb:1627:in `new'
- (druby://10.254.143.159:9001) /usr/lib/ruby/1.8/drb/drb.rb:1627:in `start_service'
- (druby://10.254.143.159:9001) ./core/request_handler.rb:244
- (druby://10.254.143.159:9001) /usr/local/lib/site_ruby/1.8/rubygems/custom_require.rb:27:in `gem_original_require'
- (druby://10.254.143.159:9001) /usr/local/lib/site_ruby/1.8/rubygems/custom_require.rb:27:in `require'
- (druby://10.254.143.159:9001) /usr/lib/ruby/gems/1.8/gems/activesupport-2.1.1/lib/active_support/dependencies.rb:510:in `require'
- (druby://10.254.143.159:9001) /usr/lib/ruby/gems/1.8/gems/activesupport-2.1.1/lib/active_support/dependencies.rb:355:in `new_constants_in'
- (druby://10.254.143.159:9001) /usr/lib/ruby/gems/1.8/gems/activesupport-2.1.1/lib/active_support/dependencies.rb:510:in `require'
- (druby://10.254.143.159:9001) core/request_handler.rb:31
- (druby://10.254.143.159:9001) core/request_handler.rb:29:in `each'
- (druby://10.254.143.159:9001) core/request_handler.rb:29
- app/drops/room_drop.rb:18:in `room_rates'
- lib/liquid/liquid_templates.rb:47:in `parse_template'
- lib/liquid/liquid_templates.rb:21:in `render_liquid_template_without_layout'
- app/helpers/skins_helper.rb:6:in `render_respond_by_format'
- app/helpers/skins_helper.rb:4:in `render_respond_by_format'
- app/helpers/skins_helper.rb:25:in `render_availability_action'
- app/controllers/web_reservations_controller.rb:109:in `availability_simplified'
- /usr/bin/mongrel_rails:19:in `load'
- /usr/bin/mongrel_rails:19 
```

奇怪的是，我无法在我的（Windows）开发机器中重现该错误，但我只能在我的 linux 测试服务器中得到它（我的机器中有 2 个杂种而不是一个）。

怎么了？我认为这是一个垃圾收集器问题（在重用之前收集了对象），但我不明白我在哪里做错了。我只是在我的控制器中创建对象并在其上调用一个方法。

任何的想法？

谢谢！罗伯托

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2008-12-15T03:16:21.070

该错误意味着您正在尝试为已被垃圾回收的对象提供服务，这通常是因为该对象超出了**服务器**的范围。

您最安全的赌注是首先弄清楚为什么该对象过早地被垃圾收集。或者，您可以通过调用 来禁用服务器的 GC `GC.disable`，这通常是个坏主意，尤其是在您的服务器长时间运行的情况下。

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2019-01-28T13:42:41.877

有一种方法可以延迟服务器上传递给**客户端的对象的**垃圾收集：

```
 DRb.install_id_conv TimerIdConv.new 60 # one minute 
```

见[https://ruby-doc.org/stdlib-2.5.3/libdoc/drb/rdoc/DRb/TimerIdConv.html](https://ruby-doc.org/stdlib-2.5.3/libdoc/drb/rdoc/DRb/TimerIdConv.html)

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2008-11-18T16:24:56.510

您是否有可能在服务器中多次调用 DRb.start_service ？

# c# - 如何在多线程应用程序中安全地填充数据和 Refresh() DataGridView？

> ID：259123
> 
> 赞同：4
> 
> 时间：2008-11-03T16:13:47.667
> 
> 标签：c#, .net, multithreading, datagridview, delegates

我的应用程序有一个 DataGridView 对象和一个 MousePos 类型的列表。MousePos 是一个自定义类，它保存鼠标 X、Y 坐标（类型为“Point”）和该位置的运行计数。我有一个线程（System.Timers.Timer）每秒引发一次事件，检查鼠标位置，添加和/或更新此列表上的鼠标位置计数。

我想有一个类似的运行线程（再次，我认为 System.Timers.Timer 是一个不错的选择），它会再次引发一个事件，以自动 Refresh() DataGridView 以便用户可以看到数据屏幕更新。（就像 TaskManager 一样。）

不幸的是，调用 DataGridView.Refresh() 方法会导致 VS2005 停止执行并注意到我遇到了跨线程情况。

如果我理解正确，我现在有 3 个线程：

*   主 UI 线程
*   MousePos 列表线程（定时器）
*   DataGridView 刷新线程（定时器）

为了查看是否可以 Refresh() 主线程上的 DataGridView，我向名为 DataGridView.Refresh() 的表单添加了一个按钮，但这（奇怪的是）没有做任何事情。我发现一个主题似乎表明如果我设置 DataGridView.DataSource = null 并返回到我的列表，它将刷新数据网格。确实这有效，但只能通过按钮（在主线程上处理。）

* * *

所以这个问题变成了一个两部分：

1.  将 DataGridView.DataSource 设置为 null 并返回到我的 List 是一种可接受的刷新数据网格的方式吗？（对我来说似乎效率低下......）
2.  如何在多线程环境中安全地执行此操作？

* * *

这是我到目前为止编写的代码（C#/.Net 2.0）

```
public partial class Form1 : Form
{
    private static List<MousePos> mousePositionList = new List<MousePos>();
    private static System.Timers.Timer mouseCheck = new System.Timers.Timer(1000);
    private static System.Timers.Timer refreshWindow = new System.Timers.Timer(1000);

    public Form1()
    {
        InitializeComponent();
        mousePositionList.Add(new MousePos());  // ANSWER! Must have at least 1 entry before binding to DataSource
        dataGridView1.DataSource = mousePositionList;
        mouseCheck.Elapsed += new System.Timers.ElapsedEventHandler(mouseCheck_Elapsed);
        mouseCheck.Start();
        refreshWindow.Elapsed += new System.Timers.ElapsedEventHandler(refreshWindow_Elapsed);
        refreshWindow.Start();
    }

    public void mouseCheck_Elapsed(object source, EventArgs e)
    {
        Point mPnt = Control.MousePosition;
        MousePos mPos = mousePositionList.Find(ByPoint(mPnt));
        if (mPos == null) { mousePositionList.Add(new MousePos(mPnt)); }
        else { mPos.Count++; }
    }

    public void refreshWindow_Elapsed(object source, EventArgs e)
    {
        //dataGridView1.DataSource = null;               // Old way
        //dataGridView1.DataSource = mousePositionList;  // Old way
        dataGridView1.Invalidate();                      // <= ANSWER!!
    }

    private static Predicate<MousePos> ByPoint(Point pnt)
    {
        return delegate(MousePos mPos) { return (mPos.Pnt == pnt); };
    }
}

public class MousePos
{
    private Point position = new Point();
    private int count = 1;

    public Point Pnt { get { return position; } }
    public int X { get { return position.X; } set { position.X = value; } }
    public int Y { get { return position.Y; } set { position.Y = value; } }
    public int Count { get { return count; } set { count = value; } }

    public MousePos() { }
    public MousePos(Point mouse) { position = mouse; }
} 
```

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2008-11-03T16:15:57.070

您必须像所有其他控件一样更新主 UI 线程上的网格。请参见 control.Invoke 或 Control.BeginInvoke。

* * *

## 回答 #2

> 赞同：5
> 
> 时间：2008-11-03T18:17:08.527

**更新！**-- 我在“Pro .NET 2.0 Windows Forms and Customer Controls in C#”一书中*部分找到了***第 1 部分**的答案

我原本以为**Refresh()**没有做任何事情，我需要调用**Invalidate()**方法，告诉 Windows 在空闲时重新绘制我的控件。（这通常是立即的，但如果您需要保证*现在*重新绘制它，那么立即调用 Update() 方法跟进。）

```
 dataGridView1.Invalidate(); 
```

但是，事实证明**Refresh()**方法只是以下的别名：

```
 dataGridView1.Invalidate(true);
    dataGridView1.Update();             // <== forces immediate redraw 
```

我发现的唯一故障是，如果 dataGridView 中没有数据，则任何无效化都不会刷新控件。我不得不重新分配数据源。然后它在那之后工作得很好。但仅针对行数（或我的列表中的项目）——如果添加了新项目，dataGridView 将不知道还有更多行要显示。

因此，似乎在将数据源（列表或表）绑定到数据源时，dataGridView 会计算项目（行），然后在内部进行设置，并且从不检查是否有新的行/项目或行/项目被删除。这就是为什么重复重新绑定数据源之前工作的原因。

现在要弄清楚如何更新要在 dataGridView 中显示的行数，而无需重新绑定数据源……有趣，有趣，有趣！:-)

* * *

在做了一些挖掘之后，我想我对我的问题的**第 2 部分**有了答案（又名安全多线程）：

我发现我应该使用**System.Windows.Forms.Timer**而不是使用*System.Timers.Timer*。

 **该事件的发生使得回调中使用的方法自动发生在主线程上。没有跨线程问题！

声明如下所示：

```
private static System.Windows.Forms.Timer refreshWindow2;
refreshWindow2 = new Timer();
refreshWindow2.Interval = 1000;
refreshWindow2.Tick += new EventHandler(refreshWindow2_Tick);
refreshWindow2.Start(); 
```

方法是这样的：

```
private void refreshWindow2_Tick(object sender, EventArgs e)
{
    dataGridView1.Invalidate();
} 
```

* * *

## 回答 #3

> 赞同：3
> 
> 时间：2009-04-20T12:58:52.077

看起来你的答案就在那里！只是在cawse你很好奇如何跨线程调用回ui：所有控件都有一个Invoke（）方法（或BEginInvoke（） - 如果你想异步做事），这用于调用任何方法主 UI 线程上下文中的控件。因此，如果您要从另一个线程调用您的 datagridview，您需要执行以下操作：

```
public void refreshWindow_Elapsed(object source, EventArgs e)
{

   // we use anonymous delgate here as it saves us declaring a named delegate in our class
   // however, as c# type inference sometimes need  a bit of 'help' we need to cast it 
   // to an instance of MethodInvoker
   dataGridView1.Invoke((MethodInvoker)delegate() { dataGridView1.Invalidate(); });
} 
```

# html - 你能改变IE7中滚动条（滚动DIV）的宽度吗

> ID：259126
> 
> 赞同：5
> 
> 时间：2008-11-03T16:14:44.123
> 
> 标签：html, css, internet-explorer

有没有办法改变滚动 div 上水平滚动条的整个宽度（包括微调箭头和手柄）。

编辑：我只需要一个 IE7 解决方案 - 它用于触摸屏终端上的滚动 DIV

谢谢

马特

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2008-11-03T16:56:49.873

实际上，我修改了我的声明...**在 IE7 中**，您可以**进行**一些缩放。

```
<div style="zoom:5;font-size:20%;overflow-x:auto;">
  Hello World!       Hello World!       Hello World!       Hello World!       Hello World!       Hello World!       Hello World!
</div> 
```

zoom 告诉 IE 将内容放大 500%，并且我将 font-size 设置为正常的 1/5（因此保持不变）......这会缩放滚动条（但看起来有点难看）缩放，因为图像是基于光栅的，而不是基于矢量的。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2008-11-03T17:03:46.227

有一种方法，但 JS 或 CSS 无法实现 IMO。

如果您可以访问相关终端，则可以将主题属性设置为具有更大的滚动条。它位于控制面板->显示->选项卡外观->高级->项目滚动条->根据需要调整大小（[截图](http://i33.tinypic.com/idt7x1.png)）

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2008-11-03T17:19:50.827

您可能想要滚动自己的滚动条 - 使用 Javascript 操作正在滚动的 div 的位置。我以前在触摸屏应用程序上看到过用大的“向上”和“向下”箭头来完成它。使用这种方法，您可以设置滚动控件的样式，但您更喜欢与您的设计相匹配。

这是一个[最近的例子](http://blog.paranoidferret.com/index.php/2008/10/24/using-jquery-slider-to-scroll-a-div/ "最近的例子")，它使用 jQuery 的滑块来控制一个 div。

# linux - 从 linux 主机捕获远程控制会话

> ID：259139
> 
> 赞同：1
> 
> 时间：2008-11-03T16:17:17.800
> 
> 标签：linux, remote-desktop, vnc

用例：

1.  A 在他的盒子上做了什么，然后卡住了。他向 B（远程）寻求支持。
2.  B 登录到 A 的会话，看到所有窗口，A 正在看到并且能够操作 GUI。

如果 A 使用 Windows，登录到正在运行的会话（例如通过 VNC）非常方便。但是如果 A 使用 Linux，AFAIK，这是不可能的。使用 VNC 需要一个“vncserver”会话，它是一个单独的会话。您可以通过查询 X-server 从远程获取屏幕截图，但您不能按屏幕上的按钮。

有一些解决方法吗？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2008-11-03T16:22:27.650

有[x11vnc](http://www.karlrunge.com/x11vnc/)：“x11vnc 允许人们使用任何 VNC 查看器远程查看并与真实的 X 显示器（即对应于物理显示器、键盘和鼠标的显示器）交互。它具有内置的 SSL 加密和身份验证、UNIX 帐户和密码支持、服务器端扩展、单端口 HTTPS 和 VNC、mDNS 服务广告以及 TightVNC 和 UltraVNC 文件传输”。

它可以与现有的 X11 会话一起使用，而无需在“xvncserver”下启动一个。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2008-11-03T16:46:41.783

除了 x11vnc（确实非常好）和 krfb（我没有经验）之外，最近的 Gnome 桌面还内置了 Vino VNC 服务器。IIRC 它可以在系统->设置->桌面共享下启用。它有一个漂亮的 GUI，并且与 Gnome 和系统很好地集成，但是 AFAIK 它比 x11vnc 使用更多的 CPU 时间。

# java - 在运行时扫描 Java 注释

> ID：259140
> 
> 赞同：282
> 
> 时间：2008-11-03T16:17:18.253
> 
> 标签：java, annotations, classloader

如何在整个类路径中搜索带注释的类？

我正在做一个库，我想让用户注释他们的类，所以当 Web 应用程序启动时，我需要扫描整个类路径以获取某些注释。

我正在考虑类似 Java EE 5 Web 服务或 EJB 的新功能。`@WebService`您使用or注释您的类，`@EJB`系统会在加载时找到这些类，以便可以远程访问它们。

* * *

## 回答 #1

> 赞同：234
> 
> 时间：2009-09-12T15:11:38.583

使用[org.springframework.context.annotation.ClassPathScanningCandidateComponentProvider](http://static.springsource.org/spring/docs/2.5.x/api/org/springframework/context/annotation/ClassPathScanningCandidateComponentProvider.html)

API

> 从基础包扫描类路径的组件提供程序。然后它将排除和包含过滤器应用于结果类以查找候选者。

```
ClassPathScanningCandidateComponentProvider scanner =
new ClassPathScanningCandidateComponentProvider(<DO_YOU_WANT_TO_USE_DEFALT_FILTER>);

scanner.addIncludeFilter(new AnnotationTypeFilter(<TYPE_YOUR_ANNOTATION_HERE>.class));

for (BeanDefinition bd : scanner.findCandidateComponents(<TYPE_YOUR_BASE_PACKAGE_HERE>))
    System.out.println(bd.getBeanClassName()); 
```

* * *

## 回答 #2

> 赞同：155
> 
> 时间：2010-08-02T21:08:47.923

另一个解决方案是[ronmamo 的](https://github.com/ronmamo) [Reflections](https://github.com/ronmamo/reflections)。

快速复审：

*   如果您使用的是 Spring，那么 Spring 解决方案就是您要走的路。否则这是一个很大的依赖。
*   直接使用 ASM 有点麻烦。
*   直接使用 Java Assist 也很笨拙。
*   Annovention 超轻巧且方便。还没有 Maven 集成。
*   反射索引所有内容，然后超级快。

* * *

## 回答 #3

> 赞同：44
> 
> 时间：2014-08-17T22:53:25.263

[您可以使用ClassGraph](https://github.com/classgraph/classgraph)查找具有任何给定注释的类，以及搜索其他感兴趣的标准，例如实现给定接口的类。（免责声明，我是 ClassGraph 的作者。）ClassGraph 可以为整个类图（所有类、注解、方法、方法参数和字段）在内存中，为类路径上的所有类，或在列入白名单的包，您可以根据需要查询该类图。ClassGraph 支持比任何其他扫描器[更多的类路径规范机制和类加载器](https://github.com/classgraph/classgraph/wiki/Classpath-Specification-Mechanisms)，并且还可以与新的 JPMS 模块系统无缝协作，因此如果您的代码基于 ClassGraph，您的代码将具有最大的可移植性。[请参阅此处的 API。](https://github.com/classgraph/classgraph/wiki/ClassGraph-API)

* * *

## 回答 #4

> 赞同：27
> 
> 时间：2011-11-21T09:05:47.840

如果您想要一个真正**轻量级**（无依赖项、简单 API、15 kb jar 文件）和**非常快速**`annotation-detector`的解决方案，请查看[https://github.com/rmuller/infomas-asl](https://github.com/rmuller/infomas-asl)

免责声明：我是作者。

* * *

## 回答 #5

> 赞同：20
> 
> 时间：2011-12-27T08:31:28.297

您可以使用 Java Pluggable Annotation Processing API 编写注释处理器，该处理器将在编译过程中执行，并收集所有带注释的类并构建索引文件以供运行时使用。

这是进行带注释的类发现的最快方法，因为您不需要在运行时扫描类路径，这通常是非常慢的操作。此外，这种方法适用于任何类加载器，而不仅仅是运行时扫描程序通常支持的 URLClassLoaders。

上述机制已经在[ClassIndex](https://github.com/atteo/classindex)库中实现。

要使用它，请使用[@IndexAnnotated](http://www.atteo.org/static/classindex/apidocs/org/atteo/evo/classindex/IndexAnnotated.html)元注释来注释您的自定义注释。这将在编译时创建一个索引文件： META-INF/annotations/com/test/YourCustomAnnotation 列出所有带注释的类。您可以通过执行以下命令在运行时访问索引：

```
ClassIndex.getAnnotated(com.test.YourCustomAnnotation.class) 
```

* * *

## 回答 #6

> 赞同：8
> 
> 时间：2019-12-08T19:38:49.010

[zapp](https://stackoverflow.com/users/1424321/zapp)有一个精彩的评论，包含在所有这些答案中：

```
new Reflections("my.package").getTypesAnnotatedWith(MyAnnotation.class) 
```

* * *

## 回答 #7

> 赞同：6
> 
> 时间：2019-05-28T09:58:47.190

Spring有一个叫做`AnnotatedTypeScanner`类的东西。
这个类内部使用

```
ClassPathScanningCandidateComponentProvider 
```

此类具有用于实际扫描**类路径**资源的代码。它通过使用运行时可用的类元数据来做到这一点。

可以简单地扩展此类或使用相同的类进行扫描。下面是构造函数定义。

```
/**
     * Creates a new {@link AnnotatedTypeScanner} for the given annotation types.
     * 
     * @param considerInterfaces whether to consider interfaces as well.
     * @param annotationTypes the annotations to scan for.
     */
    public AnnotatedTypeScanner(boolean considerInterfaces, Class<? extends Annotation>... annotationTypes) {

        this.annotationTypess = Arrays.asList(annotationTypes);
        this.considerInterfaces = considerInterfaces;
    } 
```

* * *

## 回答 #8

> 赞同：5
> 
> 时间：2017-11-22T06:53:43.923

是不是回答太晚了。我会说，最好通过[ClassPathScanningCandidateComponentProvider](https://docs.spring.io/spring/docs/2.5.x/javadoc-api/org/springframework/context/annotation/ClassPathScanningCandidateComponentProvider.html)或[Scannotations 之类的库](http://scannotation.sourceforge.net/)

但即使有人想用 classLoader 尝试一下，我自己也写了一些来打印包中类的注释：

```
public class ElementScanner {

public void scanElements(){
    try {
    //Get the package name from configuration file
    String packageName = readConfig();

    //Load the classLoader which loads this class.
    ClassLoader classLoader = getClass().getClassLoader();

    //Change the package structure to directory structure
    String packagePath  = packageName.replace('.', '/');
    URL urls = classLoader.getResource(packagePath);

    //Get all the class files in the specified URL Path.
    File folder = new File(urls.getPath());
    File[] classes = folder.listFiles();

    int size = classes.length;
    List<Class<?>> classList = new ArrayList<Class<?>>();

    for(int i=0;i<size;i++){
        int index = classes[i].getName().indexOf(".");
        String className = classes[i].getName().substring(0, index);
        String classNamePath = packageName+"."+className;
        Class<?> repoClass;
        repoClass = Class.forName(classNamePath);
        Annotation[] annotations = repoClass.getAnnotations();
        for(int j =0;j<annotations.length;j++){
            System.out.println("Annotation in class "+repoClass.getName()+ " is "+annotations[j].annotationType().getName());
        }
        classList.add(repoClass);
    }
    } catch (ClassNotFoundException e) {
        e.printStackTrace();
    }
}

/**
 * Unmarshall the configuration file
 * @return
 */
public String readConfig(){
    try{
        URL url = getClass().getClassLoader().getResource("WEB-INF/config.xml");
        JAXBContext jContext = JAXBContext.newInstance(RepositoryConfig.class);
         Unmarshaller um =  jContext.createUnmarshaller();
         RepositoryConfig rc = (RepositoryConfig) um.unmarshal(new File(url.getFile()));
         return rc.getRepository().getPackageName();
        }catch(Exception e){
            e.printStackTrace();
        }
    return null;

}
} 
```

在配置文件中，您输入包名并将其解组为一个类。

* * *

## 回答 #9

> 赞同：2
> 
> 时间：2008-11-03T17:24:19.180

Classloader API 没有“枚举”方法，因为类加载是一种“按需”活动——您的类路径中通常有数千个类，其中只有一小部分是需要的（rt.jar如今，仅此一项就是 48MB！）。

因此，即使您*可以*枚举所有类，这也将非常耗费时间和内存。

简单的方法是在安装文件（xml 或任何适合您的文件）中列出相关类；如果您想自动执行此操作，请将自己限制在一个 JAR 或一个类目录中。

* * *

## 回答 #10

> 赞同：2
> 
> 时间：2015-10-12T23:41:55.623

使用 Spring，您也可以使用 AnnotationUtils 类编写以下内容。IE：

```
Class<?> clazz = AnnotationUtils.findAnnotationDeclaringClass(Target.class, null); 
```

有关更多详细信息和所有不同方法，请查看官方文档： [https ://docs.spring.io/spring/docs/current/javadoc-api/org/springframework/core/annotation/AnnotationUtils.html](https://docs.spring.io/spring/docs/current/javadoc-api/org/springframework/core/annotation/AnnotationUtils.html)

* * *

## 回答 #11

> 赞同：2
> 
> 时间：2018-12-29T19:13:24.703

如果您也想发现接口，请使用[Google Reflection 。](https://github.com/ronmamo/reflections)

Spring`ClassPathScanningCandidateComponentProvider`没有发现接口。

* * *

## 回答 #12

> 赞同：1
> 
> 时间：2012-07-14T18:37:20.040

Google [Reflections](http://code.google.com/p/reflections/)似乎比 Spring 快得多。找到解决此差异的此功能请求：[http ://www.opensaga.org/jira/browse/OS-738](http://www.opensaga.org/jira/browse/OS-738)

这是使用反射的原因，因为我的应用程序的启动时间在开发过程中非常重要。对于我的用例，反射似乎也很容易使用（查找接口的所有实现者）。

* * *

## 回答 #13

> 赞同：1
> 
> 时间：2018-08-14T13:02:16.637

如果您正在寻找[反射](https://github.com/ronmamo/reflections)的替代方法，我想推荐[Panda Utilities - AnnotationsScanner](https://github.com/Panda-Programming-Language/Panda/wiki/Panda-Utilities:-AnnotationsScanner)。这是一个基于反射库源代码的无 Guava（Guava 有 ~3MB，Panda Utilities 有 ~200kb）扫描仪。

它还专门用于基于未来的搜索。如果您想多次扫描包含的源，甚至提供一个 API，它允许某人扫描当前的类路径，`AnnotationsScannerProcess`缓存所有 fetched `ClassFiles`，所以它真的很快。

简单的`AnnotationsScanner`使用示例：

```
AnnotationsScanner scanner = AnnotationsScanner.createScanner()
        .includeSources(ExampleApplication.class)
        .build();

AnnotationsScannerProcess process = scanner.createWorker()
        .addDefaultProjectFilters("net.dzikoysk")
        .fetch();

Set<Class<?>> classes = process.createSelector()
        .selectTypesAnnotatedWith(AnnotationTest.class); 
```

# asp.net - ASP.NET 中的 <%# Bind("") %> 和 <%# Eval("") %> 有什么区别？

> ID：259141
> 
> 赞同：36
> 
> 时间：2008-11-03T16:17:19.767
> 
> 标签：asp.net, data-binding

我已经看到 bind 和 eval 可以互换使用，尤其是在 ASP.NET GridViews 中。有什么不同？

* * *

## 回答 #1

> 赞同：51
> 
> 时间：2008-11-03T16:19:46.673

Eval 是单向的、只读的数据绑定。

绑定是双向的，读/写数据绑定。

见[这里](http://weblogs.asp.net/leftslipper/archive/2007/06/29/how-asp-net-databinding-deals-with-eval-and-bind-statements.aspx)和[这里](http://msdn.microsoft.com/en-us/library/ms178366.aspx)。

* * *

## 回答 #2

> 赞同：9
> 
> 时间：2008-11-03T16:20:27.763

Bind() 用于双向数据绑定。因此，当与正确类型的数据源一起使用时，它将从 GridView 或其他控件中提取更改的值，并将它们保存回数据库。

Eval() 是一种单向的“只读”方式来绑定值。

# asp.net - 如何确定 asp.net url 是否已“重写”？

> ID：259147
> 
> 赞同：3
> 
> 时间：2008-11-03T16:21:19.743
> 
> 标签：asp.net, seo, url-rewriting

我正在使用[http://urlrewriter.net/](http://urlrewriter.net/)在我的网站上重写 url。例如，我正在重写：

> [http://www.example.com/schedule.aspx?state=ca](http://www.example.com/schedule.aspx?state=ca)

到

> [http://www.example.com/california.aspx](http://www.example.com/california.aspx)

我正在尝试做的（出于 SEO 目的）动态添加元标记：

```
<meta name="robots" content="noindex,follow" /> 
```

*只*到没有被重写的页面。这是因为我希望两个 URL 都可以工作，但只有重写的 URL 才能被搜索引擎索引。

如何确定请求了哪个版本的页面？

**编辑**

下面的答案建议使用 301 重定向而不是使用元标记。也许我会这样做，但我仍然想知道潜在问题的答案......我如何知道页面是否已被重写？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2008-11-03T16:29:36.560

如果您需要这样做，您可能可以执行以下操作：

```
<add header="X-WasRewritten" value="true" /> 
```

如果需要，您可以检查视图中的标题并添加机器人元标记。

这也会返回给客户端，所以如果你想隐藏它，你可以编写一个 CustomAction ( [http://urlrewriter.net/index.php/support/reference/actions/custom-action](http://urlrewriter.net/index.php/support/reference/actions/custom-action) ) 来设置某种在您的请求中声明值。

但是，我不建议为同一资源使用两个 URI。我建议你只保留一个表示。如果您担心旧书签无效，可以将旧书签设置为重定向到新书签。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2008-11-03T16:33:15.040

就个人而言，我会 301 从未重写的重定向到重写的，并且只使用页面的单个副本。这对用户来说更容易，从 SEO 的角度来看，您拥有 1 个内容副本。

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2008-11-17T03:29:38.777

除了 chakrit 的回答，看起来 UrlRewriter.NET 将原始 URL 存储在 HttpContext 中，在一个名为**UrlRewriter.NET.RawUrl**的键中。因此，您可以尝试以下方法：

```
bool isPageRewritten = 
   !string.IsNullOrEmpty(HttpContext.Current.Items["UrlRewriter.NET.RawUrl"]); 
```

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2008-11-03T16:30:01.053

最明显的方法是使用页面中的 Request.Url 对象来获取有关 URL 和查询字符串的信息。例如：

```
if (Path.GetFileName(Request.Url.FilePath) == "schedule.aspx")
   //Not rewritten
else
   //rewritten 
```

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2008-11-08T14:52:31.670

我认为这是[HttpContext.Current.Items](http://msdn.microsoft.com/en-us/library/system.web.httpcontext.items.aspx)的工作。

您可以将“重定向”保存在 HttpContext.Current.Items 中，然后在您的页面中，您可以检查它是否具有一定的附加值。

我相信您可以向 urlrewriter.net 添加可以做到这一点的钩子，例如：

```
HttpContext.Current.Items["Redirected_From"] = currentUrlHere; 
```

然后在您的网页中，您可以通过以下方式进行检查：

```
if (!string.IsNullOrEmpty(HttpContext.Current.Items["Redirected_From"]))
    // the page's been redirected, do something!
else
    // no it's visited normally. 
```

我早就把它留给 .NET 3.5 SP1 中的 ASP.NET 路由框架，它比 urlrewriter.net IMO 更好。

# delphi - Delphi7如何从流中截取一部分

> ID：259150
> 
> 赞同：1
> 
> 时间：2008-11-03T16:22:07.013
> 
> 标签：delphi, stream

我有一个传入的soap消息，其形式是TStream（Delphi7），发送这个soap的服务器处于开发模式，并在消息中添加一个html标头以进行调试。现在我需要从它中删除 html 标头部分，然后才能将其传递给肥皂转换器。它以“pre”标签开头，以“/pre”标签结束。我认为这应该很容易，但我以前在 Delphi7 中没有做过，所以有人可以帮助我吗？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2008-11-06T00:27:33.707

另一个解决方案，更符合 Lars 的建议，并且以某种方式更有效。
它更快，尤其是当 Stream 的大小超过 100 时，甚至在非常大的情况下更是如此。它避免了复制到中间字符串。
**FilterBeginStream**更简单，并遵循“规范”删除所有内容，直到标题结束。
**FilterMiddleStream**的作用与 DepreStream 相同，只保留标题之前和之后的内容。

**警告**：此代码适用于 D2007 以上的 Delphi，而不是 D2009。

```
// returns position of a string token (its 1st char) into a Stream. 0 if not found
function StreamPos(Token: string; AStream: TStream): Int64;
var
  TokenLength: Integer;
  StringToMatch: string;
begin
  Result := 0;
  TokenLength := Length(Token);
  if TokenLength > 0 then
  begin
    SetLength(StringToMatch, TokenLength);
    while AStream.Read(StringToMatch[1], 1) > 0 do
    begin
      if (StringToMatch[1] = Token[1]) and
         ((TokenLength = 1) or
          ((AStream.Read(StringToMatch[2], Length(Token)-1) = Length(Token)-1) and
           (Token = StringToMatch))) then
      begin
        Result := AStream.Seek(0, soCurrent) - (Length(Token) - 1); // i.e. AStream.Position - (Length(Token) - 1);
        Break;
      end;
    end;
  end;
end;

// Returns portion of a stream after the end of a tag delimited header. Works for 1st header.
// Everything preceding the header is removed too. Returns same stream if no valid header detected.
// Result is True if valid header found and stream has been filtered.
function FilterBeginStream(const AStartTag, AEndTag: string; const AStreamIn, AStreamOut: TStream): Boolean;
begin
  AStreamIn.Seek(0, soBeginning); // i.e. AStreamIn.Position := 0;
  Result := (StreamPos(AStartTag, TStream(AStreamIn)) > 0) and (StreamPos(AEndTag, AStreamIn) > 0);
  if Result then
    AStreamOut.CopyFrom(AStreamIn, AStreamIn.Size - AStreamIn.Position)
  else
    AStreamOut.CopyFrom(AStreamIn, 0);
end;

// Returns a stream after removal of a tag delimited portion. Works for 1st encountered tag.
// Returns same stream if no valid tag detected.
// Result is True if valid tag found and stream has been filtered.
function FilterMiddleStream(const AStartTag, AEndTag: string; const AStreamIn, AStreamOut: TStream): Boolean;
var
  StartPos, EndPos: Int64;
begin
  Result := False;
  AStreamIn.Seek(0, soBeginning); // i.e. AStreamIn.Position := 0;
  StartPos := StreamPos(AStartTag, TStream(AStreamIn));
  if StartPos > 0 then
  begin
    EndPos := StreamPos(AEndTag, AStreamIn);
    Result := EndPos > 0;
  end;
  if Result then
  begin
    if StartPos > 1 then
    begin
      AStreamIn.Seek(0, soBeginning); // i.e. AStreamIn.Position := 0;
      AStreamOut.CopyFrom(AStreamIn, StartPos - 1);
      AStreamIn.Seek(EndPos - StartPos + Length(AEndTag), soCurrent);
    end;
    AStreamOut.CopyFrom(AStreamIn, AStreamIn.Size - AStreamIn.Position);
  end
  else
    AStreamOut.CopyFrom(AStreamIn, 0);
end; 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2008-11-03T16:41:00.593

创建一个新的 TStream（使用 TMemoryStream）并使用 TStream.CopyFrom 或 TStream.ReadBuffer/WriteBuffer 方法将您想要保留的任何内容从一个流移动到另一个流。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2008-11-03T19:43:19.617

我认为以下代码可以满足您的需求，假设您的文档中只有一个 <pre> 块。

```
function DepreStream(Stm : tStream):tStream;
var
  sTemp : String;
  oStrStm : tStringStream;
  i : integer;
begin
  oStrStm := tStringStream.create('');
  try
    Stm.Seek(0,soFromBeginning);
    oStrStm.copyfrom(Stm,Stm.Size);
    sTemp := oStrStm.DataString;
    if (Pos('<pre>',sTemp) > 0) and (Pos('</pre>',sTemp) > 0) then
      begin
        delete(sTemp,Pos('<pre>',sTemp),(Pos('</pre>',sTemp)-Pos('<pre>',sTemp))+6);
        oStrStm.free;
        oStrStm := tStringStream.Create(sTemp);
      end;
    Result := tMemoryStream.create;
    oStrStm.Seek(0,soFromBeginning);
    Result.CopyFrom(oStrStm,oStrStm.Size);
    Result.Seek(0,soFromBeginning);
  finally
    oStrStm.free;
  end;
end; 
```

我相信的另一个选择是使用 xml 转换来删除不需要的标签，但我在转换的方式上做的不多，所以如果其他人想要那个火炬......

**编辑：**更正代码以使其正常工作。教我直接编码到 SO 而不是先编码到 IDE。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2008-11-04T07:50:04.470

" " 的 XPath 表达式`//pre[1][1]`将拖出 XML 消息中第一个 <pre> 标记的第一个节点：根据您的描述，它应该包含您想要的 SOAP 消息。

我上次使用它已经很多年了，但我认为 Dieter Koehler 的[OpenXML 库](http://www.philo.de/xml/)支持 XPath。

# iphone - 使用 Core Animation 的图像序列动画

> ID：259153
> 
> 赞同：3
> 
> 时间：2008-11-03T16:23:06.697
> 
> 标签：iphone, cocoa-touch, core-animation

我目前正在使用带有图像数组的 UIImageView 来创建一个小的循环动画序列，其中包含大约 20 个图像（320x480）。虽然这适用于 20 - 30 张图像，但应用程序在 iphone 上退出。目前我的测试应用程序中没有其他内容，所以我知道这只是动画图像序列。

有没有人遇到过通过 Core Animation 进行此类事情的任何示例，以实现更好的性能并允许更多图像？从我读过的内容来看，听起来可以设置大量的 CALayers 并在每个 CALayers 中放置一个图像，然后通过按顺序打开和关闭图层来创建动画。这是一个好方法吗？

或者，或者，因为我基本上是在循环电影的效果之后，有没有办法使用电影控制器来实现效果而不会在开始和结束时淡入淡出？

我会很感激任何指示。非常感谢。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2008-11-03T16:36:26.390

这可能是一个简单的内存问题。20 张图像 (320x480) 大约是 3 MB 内存，假设为 8bpp（如果它们的颜色更高，显然更多）。您可以根据需要尝试加载和卸载（当然，这意味着滚动您自己的动画，而不是使用 UIImageView）。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2008-11-03T19:38:57.787

听起来像一个简单的内存问题。

您可以一次加载一两帧，或者实际播放一部电影。

# c# - 如何在 Sharepoint 2007 Web 部件中托管 Silverlight 应用程序

> ID：259161
> 
> 赞同：8
> 
> 时间：2008-11-03T16:26:09.577
> 
> 标签：c#, silverlight, sharepoint

在过去的几个月里，微软的 Silverlight 发布了一系列更新（Silverlight 2 beta 2 运行时 + 开发工具，RC0 + 破坏 beta 2 应用程序的开发工具），最近微软发布了 RTM。

我一直在尝试（未成功）集成 Sharepoint 2007 和 Silverlight。我读过的许多 sharepoint/silverlight 博客都已过时，这意味着它们针对的是 SL Beta 2。

所以，我的问题是...

**为了在 Sharepoint Server 2007 上的 Web 部件中托管 Silverlight 2.0 (RTM) 应用程序，需要执行哪些步骤？**

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2008-11-03T17:22:19.153

我还没有尝试过，但这似乎是一个好的开始：

[适用于 SharePoint 的 Silverlight 蓝图](http://www.codeplex.com/SL4SP)

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2008-11-05T23:00:24.210

这并不太难做到。您需要遵循几个步骤：

1.  [使用 xap mime 类型更新 IIS](http://blogs.conchango.com/howardvanrooijen/archive/2008/03/10/configure-mime-type-for-silverlight-2-0-in-iis.aspx)。

2.  将您的文件放入 SharePoint 可以获取的文件中。在我们的案例中，我们开发了一项功能，将 silverlight javascript 文件和我们的 xap 部署到 ISAPI 文件夹中的文件夹 (%Program Files%\Common Files\Microsoft Shared\web server extensions\12\ISAPI)。我们创建了一个名为 _xaps 的文件夹来托管这些文件。

3.  将 Silverlight 对象代码放在页面本身或内容 Web 部件中。

[编辑：出于某种原因，我的目标代码没有出现。所以[这里是一个](http://msdn.microsoft.com/en-us/library/cc189089(VS.95).aspx)示例的链接]

这里的所有都是它的。您可能最好创建一个功能来复制文件并更新您在其中托管控件的任何页面。但是要在 SharePoint 中粘贴 silverlight，上面应该可以工作。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2008-11-03T19:21:57.493

这可能会有所帮助：[http ://www.u2u.info/Blogs/Karine/Lists/Posts/Post.aspx?ID=40](http://www.u2u.info/Blogs/Karine/Lists/Posts/Post.aspx?ID=40)

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2008-11-03T19:40:06.613

如果您打算使用用户控件 [即 Web 部件]，那么我强烈建议您查看 SmartPart。您仍然需要执行上述博客中的操作以使程序集得到识别、信任等，但这可能有助于您更快地部署用户控件。

# c++ - 好的免费 FTP 客户端库（适用于 Windows C++ 商业应用程序）？

> ID：259166
> 
> 赞同：9
> 
> 时间：2008-11-03T16:27:54.240
> 
> 标签：c++, windows, ftp

我正在寻找具有公共域或 BSD 类型许可证的良好开源 Windows FTP 客户端库。我可以访问源代码的东西，我可以从 C++ 中将它用于商业应用程序中的 Windows 应用程序。

我们已经使用 Wininet 多年了，它有问题而且很可怕。最后一根稻草是 IE8 beta 2 在 InternetGetLastResponseInfo() 中包含一个新错误。当我们的用户可以安装最新版本的 IE 并破坏我们的应用程序时，我再也无法证明使用 Wininet 是合理的。

我看过 libcurl，但它对我们的需求来说太重了。我唯一需要的是 FTP 支持。我可以花一天时间去掉 libcurl 中我不需要的所有代码，但如果可能的话，我宁愿从一个简单的 FTP 客户端库开始。

我查看了 ftplib ( [http://nbpfaus.net/~pfau/ftplib/](http://nbpfaus.net/~pfau/ftplib/) )，但它是 GPL，我需要它用于闭源商业应用程序。

我以前写过 FTP 客户端代码，没那么难（可惜那是 15 年前的事了，我已经没有源代码了）。必须有一个不错的简单免费客户端库，除了 FTP 什么都不做，并且有一个可以在闭源商业应用程序中使用的许可证。

（如果您很好奇，错误在于，如果您尝试使用无法建立被动模式连接的 FTP 站点使用 FtpFindFirstFile()，InternetGetLastResponseInfo() 不会返回完整响应。这只是其中之一这些年来我发现的错误。另一个是 Wininet 的 FTP 支持忽略所有超时值。这个特定的错误已经存在多年。）

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2008-11-03T17:02:50.410

我使用[libCurl](http://curl.haxx.se/)效果非常好。唯一的缺点是，据我所知，不支持解析从 FTP 服务器返回的目录信息（显然，没有标准的目录格式）。

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2008-11-03T20:35:01.667

您需要现在免费的 Ultimate TCP/IP！

[http://www.codeproject.com/KB/MFC/UltimateTCPIP.aspx](http://www.codeproject.com/KB/MFC/UltimateTCPIP.aspx)

你得到 FTP。HTTP、SMTP、POP 等。

你不会后悔的。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2008-11-03T16:40:51.950

签出适用于 Windows 的[filezilla 服务器](http://filezilla-project.org/download.php?type=server)。

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2008-11-03T16:41:19.843

您在寻找命令行界面还是 API？您可能能够根据`wget`您的需要调整功能丰富的功能。否则，请查看[http://www.sourceforge.net](http://www.sourceforge.net)以获得许多选项。

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2011-01-16T15:14:07.200

这是我知道的最好的 FTP 库：Kira 的 FTP 库，您可以在以下位置下载：http: [//kirarelease.altervista.org/Home/index.html](http://kirarelease.altervista.org/Home/index.html)

用鼠标在框上方通过，你就会明白我为什么这么喜欢它：代码是我迄今为止找到的最简单的代码：)

# asp.net - 包装 Web 登录页面

> ID：259173
> 
> 赞同：0
> 
> 时间：2008-11-03T16:28:59.120
> 
> 标签：asp.net, login, wrapper

我有一个带有标准用户名密码和登录按钮控件的 Web 登录页面。我想编写一个包装页面，该页面将呈现并使用常量自动填充用户名和登录表单文本框，并强制登录按钮的 onclick 事件。任何建议如何做到这一点？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2008-11-03T16:43:25.207

如果您希望这种功能减少整体测试时间，您还应该看看：

[等待](http://watin.sourceforge.net/)

或者

[IEUnit](http://code.google.com/p/ieunit/downloads/list)

如果您将此作为系统的生产功能，您应该考虑使用基于浏览器的 cookie 实现某种“记住我”选项 - 您可能永远不会想要这样一个功能，即自动向您的用户验证任何匿名用户的身份。系统在野外。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2008-11-03T17:06:13.477

根据具体的表单及其完成方式，您可以制作一个将表单嵌入 iFrame 的包装页面。然后您可以使用 JS 设置 iFrame 内部的值，并调用正确的提交。

这将需要测试和一些研究，但我已经看到它完成了。

注意：由于明显的安全隐患，我也强烈警告不要这样做……但您比我们更了解您的情况/使用情况。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2008-11-03T16:30:23.627

从安全角度来看，这听起来是个糟糕的主意。不要这样做。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2009-07-01T12:19:52.713

如果您正在寻找默认登录名，因为许多网站显示带有“用户名”和“密码”的文本框，那么它们就是`input`标签的属性。

如果您想为演示目的自动登录，就像许多 FLOSS 项目所做的那样，您可以预填充`demo/demo`（或类似）的组合，也可以作为`input`标签的属性。

# java - 为什么 tomcat 寻找 JSF 类？

> ID：259180
> 
> 赞同：2
> 
> 时间：2008-11-03T16:30:37.183
> 
> 标签：java, tomcat, jsf

我正在尝试启动并运行我的开发环境，但由于某种原因，Tomcat 尝试加载 JSF 类时遇到问题。我的应用程序不使用 JSF；事实上，我什至还没有将我的应用程序部署到 tomcat。我在启动日志中获得了许多堆栈跟踪，当我尝试打开[http://localhost:8080](http://localhost:8080)时无法加载默认的 tomcat 主页（我只是得到 tomcat 404 页面）。

这是第一个堆栈跟踪的内容：

```
SEVERE: Error configuring application listener of class com.sun.faces.util.ReflectionUtils$ReflectionUtilsListener
java.lang.ClassNotFoundException: com.sun.faces.util.ReflectionUtils$ReflectionUtilsListener
    at org.apache.catalina.loader.WebappClassLoader.loadClass(WebappClassLoader.java:1386)
    at org.apache.catalina.loader.WebappClassLoader.loadClass(WebappClassLoader.java:1232)
    at org.apache.catalina.core.StandardContext.listenerStart(StandardContext.java:3712)
    at org.apache.catalina.core.StandardContext.start(StandardContext.java:4216)
    at org.apache.catalina.core.ContainerBase.addChildInternal(ContainerBase.java:760)
    at org.apache.catalina.core.ContainerBase.addChild(ContainerBase.java:740)
    at org.apache.catalina.core.StandardHost.addChild(StandardHost.java:544)
    at org.apache.catalina.startup.HostConfig.deployDescriptor(HostConfig.java:626)
    at org.apache.catalina.startup.HostConfig.deployDescriptors(HostConfig.java:553)
    at org.apache.catalina.startup.HostConfig.deployApps(HostConfig.java:488)
    at org.apache.catalina.startup.HostConfig.start(HostConfig.java:1150)
    at org.apache.catalina.startup.HostConfig.lifecycleEvent(HostConfig.java:311)
    at org.apache.catalina.util.LifecycleSupport.fireLifecycleEvent(LifecycleSupport.java:120)
    at org.apache.catalina.core.ContainerBase.start(ContainerBase.java:1022)
    at org.apache.catalina.core.StandardHost.start(StandardHost.java:736)
    at org.apache.catalina.core.ContainerBase.start(ContainerBase.java:1014)
    at org.apache.catalina.core.StandardEngine.start(StandardEngine.java:443)
    at org.apache.catalina.core.StandardService.start(StandardService.java:448)
    at org.apache.catalina.core.StandardServer.start(StandardServer.java:700)
    at org.apache.catalina.startup.Catalina.start(Catalina.java:552)
    at sun.reflect.NativeMethodAccessorImpl.invoke0(Native Method)
    at sun.reflect.NativeMethodAccessorImpl.invoke(NativeMethodAccessorImpl.java:39)
    at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:25)
    at java.lang.reflect.Method.invoke(Method.java:324)
    at org.apache.catalina.startup.Bootstrap.start(Bootstrap.java:295)
    at org.apache.catalina.startup.Bootstrap.main(Bootstrap.java:433) 
```

我还获得了以下其他类的类似堆栈跟踪：

```
com.sun.faces.config.ConfigureListener
com.sun.faces.application.WebappLifecycleListener 
```

我不确定这是否相关，但我在 Mas OS 10.5 上运行安装了 1.4 兼容包和 Java 1.4.2 的 Tomcat 5.5.27。

感谢您的任何想法！

**编辑：**似乎 Tomcat 附带的每个默认应用程序（主机管理器、平衡器、tomcat-docs、jsp-examples 等）都依赖于这些 JSF 类。我删除了这些默认应用程序，一切似乎都在工作。

所以，我现在的问题是： **为什么 tomcat 附带不包含其依赖项的应用程序，我需要做什么才能使这些默认应用程序正常工作？**

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2008-11-03T16:51:14.253

你的tomcat安装是完全干净的，还是你继承的？

检查 webapps 是否包含可能引用 JSF 类的现有战争/目录？

更新：啊——我看到你发现是这样的:-)

不知道为什么 tomcat 不包含它的所有依赖项。也许您下载了开发人员版本而不是稳定版本？

* * *

## 回答 #2

> 赞同：-2
> 
> 时间：2009-01-26T19:40:54.247

您可能需要清理 Tomcat 工作目录。

# iphone - 触摸事件延迟

> ID：259183
> 
> 赞同：2
> 
> 时间：2008-11-03T16:31:39.800
> 
> 标签：iphone, cocoa-touch, core-animation

我们在 AppStore [Bust~A~Spook](http://phobos.apple.com/WebObjects/MZStore.woa/wa/viewSoftware?id=292436957)中有一个应用程序，我们遇到了问题。当您点击屏幕时，我们使用 CALayer 在动画期间查找所有视图的位置，如果您点击其中一个，我们将启动一个骰子序列。但是，有一个明显的延迟，看起来好像触摸被缓冲了，我们收到事件的时间很晚。有没有办法轮询或任何更好的方法来响应触摸以避免这种滞后时间？

这是在 UIView 而不是 UIScrollView

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2008-11-03T16:38:05.810

您是否使用 UIScrollView 来托管所有这些？有一个称为 delaysContentTouches 的属性。这默认为 YES，这意味着视图在传递之前尝试确定触摸是否是滚动手势。您可以尝试将其设置为 NO 并查看是否有帮助。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-05-12T12:48:59.407

*这是一篇关于季节性应用程序的相当老的帖子，所以 OP 可能还没有解决这个问题，但以防其他人遇到同样的问题并发现这很有用。*

我同意 Kriem 的观点，即 CPU 过载是触摸处理显着延迟的一个常见原因，尽管在不得不退出 OpenGL 之前可以进行很多优化。CALayer 针对您在此处描述的各种问题进行了很好的优化。

我们应该首先检查基础知识：

*   CALayers 添加到主视图的`layer`
*   `touchesBegan:withEvent:`在主视图中实现
*   当相位为`UITouchPhaseBegan`时，您调用`hitTest:`主视图`layer`以找到适当的子层
*   芯片序列从相关模型对象开始，更新层。

然后，我们可以使用 Instruments 来检查性能。确保您的 CPU 没有过载。模拟器中的一切都运行良好但在设备上是否有问题？

您尝试解决的问题非常普遍，因此您不应期望需要复杂或棘手的解决方案。设计或实现很可能存在基本缺陷，只需要进行故障排除。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-05-08T14:11:06.880

延迟触摸通常表示 CPU 过载。使用 NSTimer 进行基于帧到帧的操作很容易干扰触摸处理。

如果您的应用程序是这种情况，那么我的建议很简单：OpenGL。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2009-05-28T00:33:36.520

如果您在进行`CALayer`命中测试的同时对 s 进行任何类型的核心动画动画，则必须`presentationLayer`在调用之前获取`hitTest:`，因为模型层的位置不会反映屏幕上可能出现的内容，但是图层动画的位置。

希望有帮助。

# algorithm - 计数，反转位模式

> ID：259212
> 
> 赞同：7
> 
> 时间：2008-11-03T16:39:47.087
> 
> 标签：algorithm, bit-manipulation

我正在尝试找到一种从 0 计数到 2 ^n -1 的算法，但它们的位模式颠倒了。我只关心一个词的 n LSB。你可能已经猜到我失败了。

对于 n=3：

```
000 -> 0
100 -> 4
010 -> 2
110 -> 6
001 -> 1
101 -> 5
011 -> 3
111 -> 7 
```

你明白了。

伪代码的答案很棒。欢迎使用任何语言的代码片段，首选没有位操作的答案。

请不要只发布一个片段，甚至没有简短的解释或指向源的指针。

编辑：我忘了补充，我已经有一个简单的实现，它只是对计数变量进行位反转。从某种意义上说，这种方法并不算数。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2008-11-03T16:53:50.007

这是，我认为最简单的位操作，即使你说这不是首选

假设是 32 位整数，这里有一段漂亮的代码可以反转*所有*位，而无需分 32 步完成：

```
 unsigned int i;
 i = (i & 0x55555555) <<  1 | (i & 0xaaaaaaaa) >>  1;
 i = (i & 0x33333333) <<  2 | (i & 0xcccccccc) >>  2;
 i = (i & 0x0f0f0f0f) <<  4 | (i & 0xf0f0f0f0) >>  4;
 i = (i & 0x00ff00ff) <<  8 | (i & 0xff00ff00) >>  8;
 i = (i & 0x0000ffff) << 16 | (i & 0xffff0000) >> 16;
 i >>= (32 - n); 
```

本质上，这会对所有位进行交错洗牌。每次值中大约一半的位与另一半交换。

最后一行是重新对齐位所必需的，以便 bin“n”是最高有效位。

如果“n”<= 16 或 <= 8，则可以使用更短的版本

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2008-11-03T16:49:27.300

该解决方案最初是二进制的，并按照请求者的指定转换为常规数学。

作为二进制更有意义，至少乘以 2 和除以 2 应该是 << 1 和 >> 1 以提高速度，加法和减法可能无关紧要。

如果您传入掩码而不是 nBits，并使用位移而不是乘法或除法，并将尾递归更改为循环，这可能是您会发现的最高效的解决方案，因为其他所有调用都只是一个添加，它只会像 Alnitak 的解决方案一样慢，每 4 次，甚至 8 次调用一次。

```
int incrementBizarre(int initial, int nBits)
    // in the 3 bit example, this should create 100
    mask=2^(nBits-1)
    // This should only return true if the first (least significant) bit is not set
    // if initial is 011 and mask is 100
    //                3               4, bit is not set
    if(initial < mask)
        // If it was not, just set it and bail.
        return initial+ mask // 011 (3) + 100 (4) = 111 (7)
    else
        // it was set, are we at the most significant bit yet?
        // mask 100 (4) / 2 = 010 (2), 001/2 = 0 indicating overflow
        if(mask / 2) > 0
            // No, we were't, so unset it (initial-mask) and increment the next bit
            return incrementBizarre(initial - mask, mask/2)
        else
            // Whoops we were at the most significant bit.  Error condition
            throw new OverflowedMyBitsException() 
```

哇，结果有点酷。直到最后一秒，我才想到递归。

感觉不对 - 就像有些操作不应该工作，但它们确实是因为你正在做的事情的性质（就像当你在左边的一些位和一些位上操作时感觉你应该遇到麻烦是非零的，但事实证明，除非左边的所有位都为零，否则您永远无法对位进行操作——这是一个非常奇怪的情况，但确实如此。

从 110 到 001 的流程示例（向后 3 到向后 4）：

```
mask 100 (4), initial 110 (6); initial < mask=false; initial-mask = 010 (2), now try on the next bit
mask 010 (2), initial 010 (2); initial < mask=false; initial-mask = 000 (0), now inc the next bit
mask 001 (1), initial 000 (0); initial < mask=true;  initial + mask = 001--correct answer 
```

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2008-11-03T17:09:26.200

在每一步，找到你的值的最左边的 0 位。设置它，并清除它左边的所有数字。如果你没有找到 0 位，那么你已经溢出：返回 0，或者停止，或者崩溃，或者任何你想要的。

这是在正常二进制增量上发生的情况（我的意思是它是效果，而不是它在硬件中的实现方式），但我们是在左侧而不是右侧进行。

是否使用位操作、字符串或其他方式执行此操作取决于您。如果您在 bitops 中执行此操作，则 clz （或调用等效的 hibit 样式函数）`~value`可能是最有效的方法： __builtin_clz 如果可用。但这是一个实现细节。

* * *

## 回答 #4

> 赞同：2
> 
> 时间：2017-08-06T11:54:48.810

这是我[对另一个问题的回答](https://stackoverflow.com/questions/932079/in-place-bit-reversed-shuffle-on-an-array/40533543#40533543)的解决方案，该问题计算下一个位反转索引而不循环。不过，它在很大程度上依赖于位操作。

关键思想是增加一个数字只是翻转一系列最低有效位，例如 from`nnnn0111`到`nnnn1000`。因此，为了计算下一个位反转索引，您必须翻转一系列最高有效位。如果您的目标平台有 CTZ（“计数尾随零”）指令，这可以有效地完成。

使用 GCC 的 C 语言示例`__builtin_ctz`：

```
void iter_reversed(unsigned bits) {
    unsigned n = 1 << bits;

    for (unsigned i = 0, j = 0; i < n; i++) {
        printf("%x\n", j);

        // Compute a mask of LSBs.
        unsigned mask = i ^ (i + 1);
        // Length of the mask.
        unsigned len = __builtin_ctz(~mask);
        // Align the mask to MSB of n.
        mask <<= bits - len;
        // XOR with mask.
        j ^= mask;
    }
} 
```

如果没有 CTZ 指令，您也可以使用整数除法：

```
void iter_reversed(unsigned bits) {
    unsigned n = 1 << bits;

    for (unsigned i = 0, j = 0; i < n; i++) {
        printf("%x\n", j);

        // Find least significant zero bit.
        unsigned bit = ~i & (i + 1);
        // Using division to bit-reverse a single bit.
        unsigned rev = (n / 2) / bit;
        // XOR with mask.
        j ^= (n - 1) & ~(rev - 1);
    }
} 
```

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2008-11-03T16:52:33.753

```
void reverse(int nMaxVal, int nBits)
{
   int thisVal, bit, out;

   // Calculate for each value from 0 to nMaxVal.
   for (thisVal=0; thisVal<=nMaxVal; ++thisVal)
   {
      out = 0;

      // Shift each bit from thisVal into out, in reverse order.
      for (bit=0; bit<nBits; ++bit)
         out = (out<<1) + ((thisVal>>bit) & 1)

   }
   printf("%d -> %d\n", thisVal, out);
} 
```

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2008-11-03T17:12:48.017

也许从 0 增加到 N（“通常”的方式“）并为每次迭代执行 ReverseBitOrder()。你可以[在这里](http://www-graphics.stanford.edu/~seander/bithacks.html#BitReverseObvious)找到几个实现（我最喜欢 LUT）。应该很快。

* * *

## 回答 #7

> 赞同：0
> 
> 时间：2008-11-03T19:27:25.093

这是 Perl 的答案。你没有说全1模式之后会发生什么，所以我只返回零。我去掉了按位运算，这样应该很容易翻译成另一种语言。

```
sub reverse_increment {
  my($n, $bits) = @_;

  my $carry = 2**$bits;
  while($carry > 1) {
    $carry /= 2;
    if($carry > $n) {
      return $carry + $n;
    } else {
      $n -= $carry;
    }
  }
  return 0;
} 
```

* * *

## 回答 #8

> 赞同：0
> 
> 时间：2008-11-03T19:32:55.050

使用 n 作为 2 的幂， x 是要步进的变量：

```
(defun inv-step (x n)       ; the following is a function declaration
  "returns a bit-inverse step of x, bounded by 2^n"    ; documentation
  (do ((i (expt 2 (- n 1))  ; loop, init of i
          (/ i 2))          ; stepping of i
       (s x))               ; init of s as x
      ((not (integerp i))   ; breaking condition
       s)                   ; returned value if all bits are 1 (is 0 then)
    (if (< s i)                         ; the loop's body: if s < i
        (return-from inv-step (+ s i))  ;     -> add i to s and return the result
        (decf s i))))                   ;     else: reduce s by i 
```

我对它进行了彻底的评论，因为您可能不熟悉这种语法。

*编辑*：这是尾递归版本。如果你有一个带有尾调用优化的编译器，它似乎会快一点。

```
(defun inv-step (x n)
  (let ((i (expt 2 (- n 1))))
    (cond ((= n 1)
           (if (zerop x) 1 0))         ; this is really (logxor x 1)                                                 
          ((< x i)
           (+ x i))
          (t
           (inv-step (- x i) (- n 1)))))) 
```

* * *

## 回答 #9

> 赞同：0
> 
> 时间：2008-11-03T19:57:11.243

这是一个解决方案，它实际上并没有尝试做任何添加，而是利用序列的开/关模式（大多数 sig 位每次交替，下一个大多数 sig 位每隔一段时间交替一次，等等），根据需要调整 n：

```
#define FLIP(x, i) do { (x) ^= (1 << (i)); } while(0)

int main() {
    int n   = 3;
    int max = (1 << n);
    int x   = 0;

    for(int i = 1; i <= max; ++i) {
        std::cout << x << std::endl;
        /* if n == 3, this next part is functionally equivalent to this:
         *
         * if((i % 1) == 0) FLIP(x, n - 1);
         * if((i % 2) == 0) FLIP(x, n - 2);
         * if((i % 4) == 0) FLIP(x, n - 3);
         */
        for(int j = 0; j < n; ++j) {
            if((i % (1 << j)) == 0) FLIP(x, n - (j + 1));
        }                       
    }
} 
```

* * *

## 回答 #10

> 赞同：0
> 
> 时间：2008-11-03T21:42:41.280

如有必要，如何将最高有效位加 1，然后传送到下一个（次重要）位。您可以通过对字节进行操作来加快速度：

1.  预先计算一个查找表，用于从 0 到 256 (00000000 -> 10000000, 10000000 -> 01000000, ..., 11111111 -> 00000000) 的位反转计数。
2.  将多字节数中的所有字节设置为零。
3.  使用查找表增加最高有效字节。如果字节为 0，则使用查找表递增下一个字节。如果字节为 0，则递增下一个字节...
4.  转到第 3 步。

* * *

## 回答 #11

> 赞同：0
> 
> 时间：2013-01-19T16:09:02.907

当您反转`0 to 2^n-1`但它们的位模式反转时，您几乎涵盖了整个`0-2^n-1`序列

```
Sum = 2^n * (2^n+1)/2 
```

`O(1)`手术。无需进行位反转

* * *

## 回答 #12

> 赞同：0
> 
> 时间：2017-08-06T11:11:13.820

编辑：当然原始发帖人的问题是要增加（反转）一个，这使得事情比添加两个随机值更简单。所以 nwellnhof 的[答案](https://stackoverflow.com/questions/259212/counting-reversed-bit-pattern/45531781#45531781)已经包含了算法。

* * *

### 将两个位反转值相加

这是php中的一种解决方案：

```
function RevSum ($a,$b) {

    // loop until our adder, $b, is zero
    while ($b) {

        // get carry (aka overflow) bit for every bit-location by AND-operation
        // 0 + 0 --> 00   no overflow, carry is "0"
        // 0 + 1 --> 01   no overflow, carry is "0"
        // 1 + 0 --> 01   no overflow, carry is "0"
        // 1 + 1 --> 10   overflow! carry is "1"

        $c = $a & $b;

        // do 1-bit addition for every bit location at once by XOR-operation
        // 0 + 0 --> 00   result = 0
        // 0 + 1 --> 01   result = 1
        // 1 + 0 --> 01   result = 1
        // 1 + 1 --> 10   result = 0 (ignored that "1", already taken care above)

        $a ^= $b;

        // now: shift carry bits to the next bit-locations to be added to $a in
        // next iteration.
        // PHP_INT_MAX here is used to ensure that the most-significant bit of the
        // $b will be cleared after shifting. see link in the side note below.

        $b = ($c >> 1) & PHP_INT_MAX;

    }

    return $a;
} 
```

旁注：请参阅有关转移负值的[问题。](https://stackoverflow.com/questions/26821728/why-does-right-shifting-1-always-gives-1-in-php)

至于测试；从零开始并按 8 位反转一 (10000000) 递增值：

```
$value = 0;
$add = 0x80;    // 10000000 <-- "one" as bit reversed

for ($count = 20; $count--;) {      // loop 20 times
    printf("%08b\n", $value);       // show value as 8-bit binary
    $value = RevSum($value, $add);  // do addition
} 
```

...将输出：

```
 00000000
 10000000
 01000000
 11000000
 00100000
 10100000
 01100000
 11100000
 00010000
 10010000
 01010000
 11010000
 00110000
 10110000
 01110000
 11110000
 00001000
 10001000
 01001000
 11001000 
```

* * *

## 回答 #13

> 赞同：0
> 
> 时间：2019-12-06T17:21:40.197

假设编号为 1110101，我们的任务是找到下一个。

1）在最高位置找到零并将位置标记为*索引*。

111 **0** 1010（第 4 位，所以*索引*= 4）

2) 将位置高于*index*的所有位设置为零。

**000** 01010

3) 将步骤 1) 中的建立零更改为“1”

000 **1** 1010

就是这样。这是迄今为止最快的算法，因为大多数 cpu 都有指令可以非常有效地实现这一点。这是一个 C++ 实现，它以反向模式递增 64 位数字。

```
#include <intrin.h>
unsigned __int64 reversed_increment(unsigned __int64 number) 
{
  unsigned long index, result;
  _BitScanReverse64(&index, ~number); // returns index of the highest '1' on bit-reverse number (trick to find the highest '0')
  result = _bzhi_u64(number, index); // set to '0' all bits at number higher than index position
  result |= (unsigned __int64) 1 << index; // changes to '1' bit on index position
  return result;
} 
```

它没有达到您对“无位”操作的要求，但是我担心现在有办法在没有它们的情况下实现类似的东西。

# c# - 用户定义的表单创建

> ID：259218
> 
> 赞同：2
> 
> 时间：2008-11-03T16:41:14.087
> 
> 标签：c#

我们有一个定制的书面在线工作申请......申请。HR 正在请求将“技能表”添加到应用程序中。虽然我们尚未与他们合作确定这一切可能带来的后果，但我正在开始研究这是否可行。

在这一点上，我正在设想类似于其中一些民意调查网站的东西，您可以在其中提出多项选择问题，提出“论文”问题以及可能的其他几个“定义标准”。

我最初的问题归结为：

1.  您如何定义和存储这些问题？
2.  你如何在屏幕上显示这些表格？
3.  您如何存储这些答案以便将其显示在报告中？我们需要看到个人的答案。

我们使用 C#.NET。

更新：是否有更多涵盖该主题的示例代码或文章？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2008-11-03T17:03:40.827

有很多方法可以做到这一点，但通常我会做一些有 4 个表来存储信息的事情。

问题类型

*   类型 ID
*   描述
*   其他东西<-你决定

问题

*   问题 ID
*   问题类型 ID
*   问题文本
*   其他东西<-你决定

问题解答

*   答案编号
*   问题 ID
*   问题文本
*   排序
*   其他项目 <- 你决定

用户问题解答

*   用户答案 ID
*   问题 ID
*   答案编号
*   约会时间
*   细节

当然，您需要为您的实现做一些工作，但我之前使用过类似的模型并取得了巨大的成功。

# linq - 如何拒绝 Linq 中对 SQL 的 DataContext 的所有更改？

> ID：259219
> 
> 赞同：47
> 
> 时间：2008-11-03T16:41:14.180
> 
> 标签：linq, linq-to-sql

在 Linq to SQL 的 DataContext 上，我可以调用 SubmitChanges() 来提交所有更改。

我想要的是以某种方式拒绝数据上下文中的所有更改并回滚所有更改（最好不进入数据库）。

这可能吗？

* * *

## 回答 #1

> 赞同：30
> 
> 时间：2008-11-03T16:47:47.787

为什么不丢弃数据上下文并简单地将其替换为新实例？

* * *

## 回答 #2

> 赞同：20
> 
> 时间：2013-09-26T04:50:29.723

```
public static class DataContextExtensions
{
    /// <summary>
    ///     Discard all pending changes of current DataContext.
    ///     All un-submitted changes, including insert/delete/modify will lost.
    /// </summary>
    /// <param name="context"></param>
    public static void DiscardPendingChanges(this DataContext context)
    {
        context.RefreshPendingChanges(RefreshMode.OverwriteCurrentValues);
        ChangeSet changeSet = context.GetChangeSet();
        if (changeSet != null)
        {
            //Undo inserts
            foreach (object objToInsert in changeSet.Inserts)
            {
                context.GetTable(objToInsert.GetType()).DeleteOnSubmit(objToInsert);
            }
            //Undo deletes
            foreach (object objToDelete in changeSet.Deletes)
            {
                context.GetTable(objToDelete.GetType()).InsertOnSubmit(objToDelete);
            }
        }
    }

    /// <summary>
    ///     Refreshes all pending Delete/Update entity objects of current DataContext according to the specified mode.
    ///     Nothing will do on Pending Insert entity objects.
    /// </summary>
    /// <param name="context"></param>
    /// <param name="refreshMode">A value that specifies how optimistic concurrency conflicts are handled.</param>
    public static void RefreshPendingChanges(this DataContext context, RefreshMode refreshMode)
    {
        ChangeSet changeSet = context.GetChangeSet();
        if (changeSet != null)
        {
            context.Refresh(refreshMode, changeSet.Deletes);
            context.Refresh(refreshMode, changeSet.Updates);
        }
    }
} 
```

请参阅[Linq to SQL - 放弃挂起的更改](http://www.cnblogs.com/hiteddy/p/Linq_to_SQL_Discard_Cancel_Clear_Pending_Changes.html)

* * *

## 回答 #3

> 赞同：11
> 
> 时间：2009-08-06T15:22:43.970

在 .net 3.0 中，`db.GetChangeSet().Updates.Clear()`用于更新的、`db.GetChangeSet().Inserts.Clear()`新的或`db.GetChangeSet().Deletes.Clear()`已删除的项目。

在 .net 3.5 及更高版本中，GetChangeSet() 的结果现在是只读的，在 for 或 foreach 中循环集合并刷新每个 ChangeSet 表，就像 macias 在他的评论中所写的那样。

* * *

## 回答 #4

> 赞同：9
> 
> 时间：2008-11-06T11:03:09.430

正如 Haacked 所说，只需删除数据上下文。

您可能不应该长时间保持数据上下文处于活动状态。它们被设计为以事务方式使用（即每个原子工作单元一个数据上下文）。如果您长时间保持数据上下文处于活动状态，则在更新陈旧实体时会产生更大的并发异常风险。

* * *

## 回答 #5

> 赞同：9
> 
> 时间：2010-01-26T17:13:13.093

对 Updates、Delete 和 Inserts 集合调用 Clear() 不起作用。

GetOriginalEntityState() 可能很有用，但它只提供外键关系的 ID，而不是实际的实体，因此您只剩下一个分离的对象。

这是一篇解释如何从数据上下文中丢弃更改的文章：http: [//graemehill.ca/discard-changes-in-linq-to-sql-datacontext](http://graemehill.ca/discard-changes-in-linq-to-sql-datacontext)

编辑：调用 Refresh() 将撤消更新，但不会删除和插入。

* * *

## 回答 #6

> 赞同：4
> 
> 时间：2008-11-03T17:06:12.570

刷新将起作用，但是您必须提供要重置的实体。

例如

```
dataContext.Refresh(RefreshMode.OverwriteCurrentValues, someObject); 
```

* * *

## 回答 #7

> 赞同：3
> 
> 时间：2010-01-26T14:36:40.590

您可以使用**GetOriginalEntityState(..)**获取对象的原始值，例如使用旧缓存值的客户。

您还可以迭代更改，例如仅更新和刷新特定对象而不是整个表，因为性能损失会很高。

```
foreach (Customer c in MyDBContext.GetChangeSet().Updates)
        {
            MyDBContext.Refresh(System.Data.Linq.RefreshMode.OverwriteCurrentValues, c);
        } 
```

这将使用数据库中的持久数据恢复更改。

另一种解决方案是使用 Dispose() 转储您使用的数据上下文。

在任何情况下，最好在您使用的客户集合中覆盖 Insert 和 Remove 方法，并添加例如 InsertOnSubmit() 调用。这将解决您的待处理插入和删除问题。

* * *

## 回答 #8

> 赞同：1
> 
> 时间：2012-10-24T20:50:01.880

[在这里](http://graemehill.ca/discard-changes-in-linq-to-sql-datacontext)写得很好，但这里是所用代码的复制和粘贴。

```
Public Sub DiscardInsertsAndDeletes(ByVal data As DataContext)
    ' Get the changes
    Dim changes = data.GetChangeSet()

    ' Delete the insertions
    For Each insertion In changes.Inserts
        data.GetTable(insertion.GetType).DeleteOnSubmit(insertion)
    Next

    ' Insert the deletions
    For Each deletion In changes.Deletes
        data.GetTable(deletion.GetType).InsertOnSubmit(deletion)
    Next
End Sub

Public Sub DiscardUpdates(ByVal data As DataContext)
    ' Get the changes
    Dim changes = data.GetChangeSet()

    ' Refresh the tables with updates
    Dim updatedTables As New List(Of ITable)
    For Each update In changes.Updates
        Dim tbl = data.GetTable(update.GetType)
        ' Make sure not to refresh the same table twice
        If updatedTables.Contains(tbl) Then
            Continue For
        Else
            updatedTables.Add(tbl)
            data.Refresh(RefreshMode.OverwriteCurrentValues, tbl)
        End If
    Next
End Sub 
```

* * *

## 回答 #9

> 赞同：1
> 
> 时间：2013-12-06T15:26:40.333

我的应用程序是带有图标以选择活动表单（列表框）的 Outlook 样式。在允许用户更改其上下文之前，他们必须接受更改或丢弃它们。

```
var changes = db.GetChangeSet();
if ((changes.Updates.Count > 0) || (changes.Inserts.Count > 0) || (changes.Deletes.Count > 0))
{
    if (MessageBox.Show("Would you like to save changes?", "Save Changes", MessageBoxButton.YesNo)  == MessageBoxResult.Yes)
    {
        db.SubmitChanges();
    } else
    {
        //Rollback Changes
        foreach (object objToInsert in changes.Inserts)
        {
            db.GetTable(objToInsert.GetType()).DeleteOnSubmit(objToInsert);
        }
        foreach (object objToDelete in changes.Deletes)
        {
            db.GetTable(objToDelete.GetType()).InsertOnSubmit(objToDelete);
        }
        foreach (object objToUpdate in changes.Updates)
        {
            db.Refresh(RefreshMode.OverwriteCurrentValues, objToUpdate);
        }
        CurrentForm.SetObject(null); //Application Code to Clear active form
        RefreshList(); //Application Code to Refresh active list
    }
} 
```

* * *

## 回答 #10

> 赞同：0
> 
> 时间：2016-09-15T15:49:46.530

这是我的做法。我只是按照上面泰迪的例子进行了简化。不过我有一个问题，为什么还要在 DELETES 上进行刷新？

```
 public static bool UndoPendingChanges(this NtsSuiteDataContext dbContext)
  {
     if (dbContext.ChangesPending())
     {
        ChangeSet dbChangeSet = dbContext.GetChangeSet();

        dbContext.Refresh(RefreshMode.OverwriteCurrentValues, dbChangeSet.Deletes);
        dbContext.Refresh(RefreshMode.OverwriteCurrentValues, dbChangeSet.Updates);

        //Undo Inserts
        foreach (object objToInsert in dbChangeSet.Inserts)
        {
           dbContext.GetTable(objToInsert.GetType()).DeleteOnSubmit(objToInsert);
        }

        //Undo deletes
        foreach (object objToDelete in dbChangeSet.Deletes)
        {
           dbContext.GetTable(objToDelete.GetType()).InsertOnSubmit(objToDelete);
        }
     }

     return true;
  } 
```

# mail-server - Windows服务器的电子邮件服务器？

> ID：259229
> 
> 赞同：0
> 
> 时间：2008-11-03T16:45:03.283
> 
> 标签：mail-server

目前我只看到 smartertools 的产品，用于在 windows 盒子上运行的电子邮件服务器。

你们在跑什么？还有其他选择吗？

当您有多个需要其软件的服务器时，它会变得昂贵。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2008-11-03T16:48:27.363

Imail 服务器适用于小型组织。 [http://www.imailserver.com/](http://www.imailserver.com/)

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2008-11-03T16:47:50.487

我们使用[Kerio 电子邮件服务器](http://www.kerio.com/kms_home.html)。它对我们很有效。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2008-11-03T16:48:51.483

邮件服务器。免费和开源。

[http://www.hmailserver.com](http://www.hmailserver.com)

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2008-11-03T16:59:20.337

我已经运行 SmarterMail 很长时间了，对它的性能和功能非常满意。

# python - python，从列表运行并通过函数添加到列表的函数

> ID：259234
> 
> 赞同：0
> 
> 时间：2008-11-03T16:46:57.570
> 
> 标签：python, function, list

如何在循环上运行一个函数，以便所有结果直接进入一个列表，有没有办法运行一个作用于列表中所有值的函数？

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2008-11-03T16:55:55.477

有几种方法可以在这样的循环上运行函数 - 您可以使用列表推导

```
test = list('asdf')
[function(x) for x in test] 
```

并使用该结果

或者你可以使用地图功能

```
test = list('asdf')
map(function, test) 
```

第一个答案更“pythonic”，而第二个答案更实用。

编辑：第二种方式也快得多，因为它不是运行任意代码来调用函数，而是直接调用函数 using `map`，这是用 C 实现的。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2008-11-03T16:54:38.100

你的问题需要澄清。

### 在循环上运行函数

```
new_list= [yourfunction(item) for item in a_sequence] 
```

### 运行作用于列表中所有值的函数

您的函数应该在其代码中具有某种形式的迭代来处理序列的所有项目，例如：

```
def yourfunction(sequence):
    for item in sequence:
        … 
```

然后你只需用一个序列（即一个列表、一个字符串、一个迭代器等）调用它

```
yourfunction(range(10))
yourfunction("a string") 
```

YMMV。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2008-11-03T16:54:04.920

这个例子展示了如何做（在解释器中运行它）

```
>>> def square(x):
...  return x*x
...
>>> a = [1,2,3,4,5,6,7,8,9]

>>> map(square,a)
[1, 4, 9, 16, 25, 36, 49, 64, 81] 
```

# c++ - 迭代器适配器仅迭代地图中的值？

> ID：259240
> 
> 赞同：18
> 
> 时间：2008-11-03T16:48:10.313
> 
> 标签：c++, maps, iterator, adapter

在做了很多 C# 和最近的 Objective C 几年后，我才回到 C++。

我之前做过的一件事是为 std::map 滚动我自己的迭代器适配器，它将只引用值部分，而不是键值对。这是很常见和很自然的事情。C# 为这个工具提供了它的 Dictionary 类的 Keys 和 Values 属性。Objective-C 的 NSDictionary 同样具有 allKeys 和 allValues。

自从我“离开”以来，Boost 已经获得了 Range 和 ForEach 库，我现在正在广泛使用它们。我想知道两者之间是否有一些设施可以做同样的事情，但我找不到任何东西。

我正在考虑使用 Boost 的迭代器适配器来解决问题，但在我走这条路之前，我想我想在这里问一下是否有人知道 Boost 中的这种设施，或者其他现成的地方？

* * *

## 回答 #1

> 赞同：24
> 
> 时间：2011-02-28T22:09:09.360

替换以前的答案，以防其他人像我一样发现这个。从 boost 1.43 开始，提供了一些常用的范围适配器。在这种情况下，您需要 boost::adaptors::map_values。相关示例： http: [//www.boost.org/doc/libs/1_46_0/libs/range/doc/html/range/reference/adaptors/reference/map_values.html#range.reference.adaptors.reference.map_values。 map_values_example](http://www.boost.org/doc/libs/1_46_0/libs/range/doc/html/range/reference/adaptors/reference/map_values.html#range.reference.adaptors.reference.map_values.map_values_example)

* * *

## 回答 #2

> 赞同：14
> 
> 时间：2008-11-03T17:36:49.357

我不认为有什么开箱即用的。您可以使用 boost::make_transform。

```
template<typename T1, typename T2> T2& take_second(const std::pair<T1, T2> &a_pair) 
{
  return a_pair.second;
}

void run_map_value()
{
  map<int,string> a_map;
  a_map[0] = "zero";
  a_map[1] = "one";
  a_map[2] = "two";
  copy( boost::make_transform_iterator(a_map.begin(), take_second<int, string>),
    boost::make_transform_iterator(a_map.end(), take_second<int, string>),
    ostream_iterator<string>(cout, "\n")
    );
} 
```

* * *

## 回答 #3

> 赞同：8
> 
> 时间：2013-02-28T19:17:09.263

为此目的，有一个升压范围适配器。请参阅[http://www.boost.org/doc/libs/1_53_0/libs/range/doc/html/range/reference/adaptors/reference/map_values.html](http://www.boost.org/doc/libs/1_53_0/libs/range/doc/html/range/reference/adaptors/reference/map_values.html)

（这个例子从那里抄袭）

```
int main(int argc, const char* argv[])
{
    using namespace boost::assign;
    using namespace boost::adaptors;

    std::map<int,int> input;
    for (int i = 0; i < 10; ++i)
    input.insert(std::make_pair(i, i * 10));

    boost::copy(
        input | map_values,
        std::ostream_iterator<int>(std::cout, ","));

    return 0;
} 
```

* * *

## 回答 #4

> 赞同：7
> 
> 时间：2010-02-23T08:17:07.037

继续大卫的回答，通过从 boost::transform_iterator 创建派生类，还有另一种可能性。我在我的项目中使用这个解决方案：

```
namespace detail
{

template<bool IsConst, bool IsVolatile, typename T>
struct add_cv_if_c
{
    typedef T type;
};
template<typename T>
struct add_cv_if_c<true, false, T>
{
    typedef const T type;
};
template<typename T>
struct add_cv_if_c<false, true, T>
{
    typedef volatile T type;
};
template<typename T>
struct add_cv_if_c<true, true, T>
{
    typedef const volatile T type;
};

template<typename TestConst, typename TestVolatile, typename T>
struct add_cv_if: public add_cv_if_c<TestConst::value, TestVolatile::value, T>
{};

}   // namespace detail

/** An unary function that accesses the member of class T specified in the MemberPtr template parameter.

    The cv-qualification of T is preserved for MemberType
 */
template<typename T, typename MemberType, MemberType T::*MemberPtr>
struct access_member_f
{
    // preserve cv-qualification of T for T::second_type
    typedef typename detail::add_cv_if<
        std::tr1::is_const<T>, 
        std::tr1::is_volatile<T>, 
        MemberType
    >::type& result_type;

    result_type operator ()(T& t) const
    {
        return t.*MemberPtr;
    }
};

/** @short  An iterator adaptor accessing the member called 'second' of the class the 
    iterator is pointing to.
 */
template<typename Iterator>
class accessing_second_iterator: public 
    boost::transform_iterator<
        access_member_f<
            // note: we use the Iterator's reference because this type 
            // is the cv-qualified iterated type (as opposed to value_type).
            // We want to preserve the cv-qualification because the iterator 
            // might be a const_iterator e.g. iterating a const 
            // std::pair<> but std::pair<>::second_type isn't automatically 
            // const just because the pair is const - access_member_f is 
            // preserving the cv-qualification, otherwise compiler errors will 
            // be the result
            typename std::tr1::remove_reference<
                typename std::iterator_traits<Iterator>::reference
            >::type, 
            typename std::iterator_traits<Iterator>::value_type::second_type, 
            &std::iterator_traits<Iterator>::value_type::second
        >, 
        Iterator
    >
{
    typedef boost::transform_iterator<
        access_member_f<
            typename std::tr1::remove_reference<
                typename std::iterator_traits<Iterator>::reference
            >::type, 
            typename std::iterator_traits<Iterator>::value_type::second_type, 
            &std::iterator_traits<Iterator>::value_type::second
        >, 
        Iterator
    > baseclass;

public:
    accessing_second_iterator(): 
        baseclass()
    {}

    // note: allow implicit conversion from Iterator
    accessing_second_iterator(Iterator it): 
        baseclass(it)
    {}
}; 
```

这导致更干净的代码：

```
void run_map_value()
{
  typedef map<int, string> a_map_t;
  a_map_t a_map;
  a_map[0] = "zero";
  a_map[1] = "one";
  a_map[2] = "two";

  typedef accessing_second_iterator<a_map_t::const_iterator> ia_t;
  // note: specify the iterator adaptor type explicitly as template type, enabling 
  // implicit conversion from begin()/end()
  copy<ia_t>(a_map.begin(), a_map.end(),
    ostream_iterator<string>(cout, "\n")
  );
} 
```

# c++ - 如何在编译时测试当前版本的 GCC？

> ID：259248
> 
> 赞同：36
> 
> 时间：2008-11-03T16:50:16.393
> 
> 标签：c++, c, gcc, versions

我想根据 GCC 的版本包含不同的文件。更准确地说，我想写：

```
#if GCC_VERSION >= 4.2
#  include <unordered_map>
#  define EXT std
#elif GCC_VERSION >= 4
#  include <tr1/unordered_map>
#  define EXT std
#else
#  include <ext/hash_map>
#  define unordered_map __gnu_cxx::hash_map
#  define EXT __gnu_cxx
#endif 
```

我不在乎 3.2 之前的 gcc。

我很确定在预处理时为此定义了一个变量，但我再也找不到它了。

* * *

## 回答 #1

> 赞同：53
> 
> 时间：2008-11-03T16:59:20.383

应该根据您的需要定义许多宏：

```
__GNUC__              // major
__GNUC_MINOR__        // minor
__GNUC_PATCHLEVEL__   // patch 
```

版本格式为major.minor.patch，例如4.0.2

这些文档可以在[这里](http://gcc.gnu.org/onlinedocs/cpp/Common-Predefined-Macros.html)找到。

* * *

## 回答 #2

> 赞同：29
> 
> 时间：2008-11-03T16:59:48.497

`__GNUC_PREREQ`好的，经过更多搜索，一种可能的方法是使用`features.h`.

```
#ifdef __GNUC__
#  include <features.h>
#  if __GNUC_PREREQ(4,0)
//      If  gcc_version >= 4.0
#  elif __GNUC_PREREQ(3,2)
//       If gcc_version >= 3.2
#  else
//       Else
#  endif
#else
//    If not gcc
#endif 
```

* * *

## 回答 #3

> 赞同：20
> 
> 时间：2008-11-03T17:40:40.957

作为旁注：

要查找所有预定义的宏：

*   创建空文件 t.cpp
*   `g++ -E -dM t.cpp`

# .net - How do I copy a file or folder that is locked under windows programmatically?

> ID：259253
> 
> 赞同：13
> 
> 时间：2008-11-03T16:52:30.930
> 
> 标签：.net, winapi, file, locking

What are the API calls to copy a file that is currently locked. I'm hoping to be able to use .Net, but Win32 calls would be fine as well.

Please feel free to chime in about the same functionality on Unix, or any other OS.

* * *

## 回答 #1

> 赞同：17
> 
> 时间：2008-11-03T17:17:09.053

You can use the VSS (Volume Shadow Copy Service, not Visual SourceSafe) API for this purpose. While powerful, this isn't exactly an easy-to-use API: the [Overview of Processing a Backup Under VSS](http://msdn.microsoft.com/en-us/library/aa384589.aspx) should give you an idea what's involved.

Even though it's a relatively recent API, .NET support for VSS is pretty much (and inexcusably) nonexistent. You can't call most of the API through Interop, and the Framework file functions won't work with the kernel namespace VSS uses to expose the snapshotted files. As a bonus, there are horrendous 32/64-bit and XP-vs-Vista issues, making deployment exciting as well (the responsible team at Microsoft should be really proud!)

Anyway, the [AlphaVSS](http://www.alphaleonis.com/2008/08/alphavss-bringing-windows-shadow-copy-service-vss-to-net/) project intends to bring full VSS functionality to .NET, and looks extremely promising, even though it's still in pre-beta stage. It might just do the trick for you, though, and it's open source (Managed C++).

For a good example of how to do things using Win32, see [HoboCopy](http://alt.pluralsight.com/wiki/default.aspx/Craig/HoboCopy.html). The utility is quite useful on its own, and full C++ source is available from the [SourceForge project page](http://sourceforge.net/projects/wangdera) as well.

* * *

## 回答 #2

> 赞同：5
> 
> 时间：2008-11-03T16:55:28.753

Almost the same as my answer to [another question](https://stackoverflow.com/questions/215461/delete-locked-files#215466):

If you are on Win32, the official way to do it is to mark it to be moved on reboot, and ask the user to reboot. To mark the file to be moved on reboot, use `MoveFileEx` with the `MOVEFILE_DELAY_UNTIL_REBOOT` flag.

It's the same function, only this time you don't pass NULL as the destination.

* * *

## 回答 #3

> 赞同：4
> 
> 时间：2008-11-03T17:23:30.023

Depending upon what exactly has locked your file, you can either do System.IO.File.Copy(), or create a System.IO.BinaryReader and a System.IO.BinaryWriter and manually create a copy of the file by reading chunks of the locked file and writing them to a new file. I have seen situations where one method was possible but the other wasn't, based on why the file was locked.

This is the "all .NET" answer.

# c++ - std::getline() 返回

> ID：259269
> 
> 赞同：25
> 
> 时间：2008-11-03T16:56:33.713
> 
> 标签：c++, getline

我有一个循环，它使用以下命令读取文件中的每一行`getline()`：

```
istream is;
string line;
while (!getline(is, line).eof())
{
    // ...
} 
```

我注意到这样的调用`getline()`似乎也有效：

```
while (getline(is, line)) 
```

这里发生了什么？`getline()`返回一个流引用。它是否以某种方式转换为指针？这实际上是一个好习惯还是我应该坚持第一种形式？

* * *

## 回答 #1

> 赞同：27
> 
> 时间：2008-11-03T17:02:45.743

`istream`返回的方法`getline()`是隐式调用其运算符`void*()`方法，该方法返回流是否遇到错误。因此，它进行的检查比调用`eof()`.

* * *

## 回答 #2

> 赞同：8
> 
> 时间：2008-11-03T17:02:04.980

**更新：**

我错误地指出了 basic_istream::sentry 类上 operator bool() 方法的[basic_istream 文档](http://www.unc.edu/depts/case/pgi/pgC++_lib/stdlibcr/bas_3074.htm#Sentry%20Classbool())，但正如已经指出的那样，这实际上并不是正在发生的事情。我投票赞成查尔斯和卢克的正确答案。它实际上是被调用的操作符 void*()。[C++ 常见问题解答](http://parashift.com/c++-faq-lite/input-output.html#faq-15.4)中对此的更多信息。

* * *

## 回答 #3

> 赞同：5
> 
> 时间：2008-11-03T18:01:33.613

查尔斯确实给出了[正确答案](https://stackoverflow.com/questions/259269/stdgetline-returns#259286)。

所谓的确实是`std::basic_ios::operator void*()`，而不是，这与返回 a （因此， a ）而不是哨兵`sentry::operator bool()`的事实一致。`std::getline()``std::basic_istream``std::basic_ios`

对于非信徒，请参阅：

*   cppreference 网站上的[std::basic_ios::operator void *() 文档，](http://en.cppreference.com/w/cpp/io/basic_ios/operator_bool)
*   关于 artima的[*The Safe Bool Idiom*](http://www.artima.com/cppsource/safebool.html)文章，
*   [C++ FAQ 精简版§15.4](http://parashift.com/c++-faq-lite/input-output.html#faq-15.4)，
*   标准， ...

否则，正如其他人已经说过的，更喜欢规范的第二种形式。如果`fail()`你真的想要一个冗长的代码，就不要使用——我不记得是否`xxx.good()`可以用来代替`!xxx.fail()`

* * *

## 回答 #4

> 赞同：-3
> 
> 时间：2008-11-03T17:06:37.093

我会坚持第一种形式。虽然第二种形式可能有效，但它几乎不明确。您的原始代码清楚地描述了正在执行的操作以及预期的行为方式。

# c# - 新的 vb.net 增强功能？

> ID：259273
> 
> 赞同：2
> 
> 时间：2008-11-03T16:57:59.967
> 
> 标签：c#, vb.net

我已经听到/阅读了很多关于 C# 4 新语言增强功能的信息。我有点好奇这些相同的增强功能是否也将应用于 VB，或者什么。有谁知道我可以在这里获得一些见解吗？随着 C# 发生的所有新变化，除非您碰巧喜欢该语法，否则似乎几乎没有理由使用 VB。是否有 MS 这次没有对 VB 进行的增强功能包含在 C# 中，反之亦然？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2008-11-03T17:11:58.550

实际上，我会忽略 Lou Franco 对 VB.Net 的解雇。结帐 Panopticon Central：

*   [http://www.panopticoncentral.net/archive/2008/10/31/24803.aspx](http://www.panopticoncentral.net/archive/2008/10/31/24803.aspx)
*   [http://www.panopticoncentral.net/archive/2008/10/29/24764.aspx](http://www.panopticoncentral.net/archive/2008/10/29/24764.aspx)

例如：

> 然后 Lucian 做了一个非常精彩的 VB 10.0 演示，该演示在 Visual Studio 2010 中发布。他展示了（IIRC）本博客读者应该熟悉的以下特性：数组字面量、集合初始化器、自动属性、隐式续行、语句 lambdas、泛型变体以及将主要互操作程序集类型嵌入到程序集中的功能，因此您不必部署 PIA。我可能错过了一些，所以请在发布视频时查看！

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2008-11-03T17:03:01.673

对 C# 的一些更改（例如命名可选参数）已经在 VB 中。VB.NET 优于 C# 的主要优势在于 Office/COM 集成，而新的 C# 正在解决这个问题。

如果您需要以较旧的 .NET 版本为目标，如果您需要这些功能，VB.NET 仍然可以使用。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2008-11-03T17:05:58.467

C# 中仍然缺少 vb.net 有一段时间的东西：xml 文字。但这并不完全是新的。

# css - 消失的要点

> ID：259290
> 
> 赞同：4
> 
> 时间：2008-11-03T17:03:07.210
> 
> 标签：css, html-lists, css-float

[http://biochrom.fivesite.co.uk/catalogue4.asp](http://biochrom.fivesite.co.uk/catalogue4.asp)

在上面的页面上，有一个图像漂浮在左边。它的右侧是一个列表，标题为“功能”。列表项有一个背景图像，但是，它没有出现。清单 2 显示了背景图像的外观。

有谁知道我怎样才能使子弹可见？

* * *

## 回答 #1

> 赞同：9
> 
> 时间：2009-12-15T14:54:10.157

我知道这是一年前的帖子，但其他人可能想知道...

如果您使用的是内容管理系统并且有些页面有图像而有些页面不希望您的列表项在内容中为 200 像素，会发生什么情况？

您可以将此 CSS 添加到您的 UL/OL 元素中：

```
overflow:hidden; 
```

我希望这会有所帮助。

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2008-11-03T17:07:08.107

您的图像有一个 float:left 属性。因此，列表项呈现在图像“后面”。

```
margin-left:200px; 
```

上 UL 元素将解决您的问题。

或者，您可以在 UL 元素上应用 float:left。这将使其浮动到图像的右侧，但会使以下内容出现在同一行。[您可以通过清除 UL-element](http://www.positioniseverything.net/easyclearing.html)或在 UL-element 之后添加元素来防止这种情况...

```
clear:both 
```

...适用于它。

有关此行为的更多信息，[请访问 http://www.positioniseverything.net/easyclearing.html](http://www.positioniseverything.net/easyclearing.html)。

* * *

## 回答 #3

> 赞同：3
> 
> 时间：2011-05-08T14:31:11.793

这个线程确实很旧，但总是相关的......

另一种替代解决方案：

```
display: inline-block; 
```

把这个**放在 UL 上**。它强制整个 ul 出现在浮动之后。这样您就可以拥有一个带有或不带有图像的页面，并且它始终会正确显示（在 FF4、IE7 和 8、Chrome 11 上进行了检查）。

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2008-11-03T17:11:26.990

或者，您可以使用 list-style-image 属性而不是 background-image。前几天我遇到了这个问题：浮动在其“邻居”上展示的文本换行行为仅适用于“内容”，而不适用于背景图像（例如）。

# wpf - 我应该将业务对象与 WPF 中的 UI 分开吗？

> ID：259293
> 
> 赞同：2
> 
> 时间：2008-11-03T17:03:33.060
> 
> 标签：wpf, mvvm

WPF 的面向视图模型的处理方式使得仅在 UI 中使用业务对象非常诱人。你见过这方面的问题吗？为什么或为什么不这样做？

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2008-11-03T17:48:05.293

Microsoft 产品团队的指导（例如 Blend 团队正在使用的）是 Model-View-ViewModel 架构，它是流行的 MVC 模式的一种变体。一个好的起点是[http://blogs.msdn.com/johngossman/archive/2005/10/08/478683.aspx](http://blogs.msdn.com/johngossman/archive/2005/10/08/478683.aspx)。WPF 博士也有关于这个主题的好文章。

本质上，他们提倡创建一个 ViewModel 层，该层使用绑定友好的业务对象，例如 ObservableCollection 等。

此外，如果您最终可能会迁移到 Silverlight 2，您可能希望将业务对象保留在 UI 层之外，以便您可以更换 UI 技术（直到 WPF 和 Silverlight 成为源代码兼容）。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2008-11-03T17:13:17.393

我想我从不同的角度看待它。我尽量远离 UI，这样我就可以使用我需要的任何 UI 演示文稿（即 web、WPF、WinForms）。表示层中的业务逻辑越多，如果您迁移到不同的 UI，您以后可能需要重写的越多。

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2008-11-03T17:47:27.667

在 UI 中拥有业务对象不是问题，只要您所做的只是**查看**它们。换句话说，如果你想改变一个的属性，或者删除一个，或者创建一个新的，你应该发送一个消息给控制器、演示者，或者其他的东西；然后结果应该在视图中更新。

您**不应该**做的是使用`ToString`对象的方法（或对象上的任何其他方法或属性）来影响它们在视图中的显示方式。您应该使用`DataTemplate`s 来表示对象的视图。如果您需要更复杂的表示，可以使用 an`IValueConverter`将对象更改为其可视表示。

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2008-11-03T17:10:44.387

我不是 WPF 大师，我不能确定，但​​分离 M、V 和 C 的通常原因是，您可以独立于视图测试控制器，反之亦然。

当然，没有什么能阻止你，但如果它是独立的，它应该更易于测试（即单元测试）。MVP 模式，通常是 MS 提倡的模式，更适合拥有更多控制权的演示者（即您的 WPF 表单），这也很好......

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2008-11-03T18:45:30.967

根据您的应用程序体系结构或您计划重用组件和对象的方式，您可以选择与用户界面（在本例中为 WPF）有一定程度的独立性。

以下是我的经验示例：

> 我在一个相对较小的项目中使用过 WPF，其中已经定义了业务层，我们只需要创建一个用户界面。当然，接口已经定义了它自己的规则和它正在使用的对象，并且因为应用程序是为 UX 定义的，所以我们选择创建我们自己的特定对象，主要是通过扩展 `DependencyObject`（主要是为了`Data Binding`目的）。
> 
> 有些人可能会争辩说，使用依赖对象是不好的，因为它们不是可序列化的（实际上它们对于 XAML 是可序列化的），它们为 WPF（ `System.Windows`命名空间）带来了依赖关系，以及其他一些参数。此外，还 `DependencyObjects`支持其他选项，例如[附加属性](http://msdn.microsoft.com/en-us/library/ms749011.aspx) 和[依赖属性](http://msdn.microsoft.com/en-us/library/ms752914.aspx)。例如 [`INotifyPropertyChanged`](http://msdn.microsoft.com/en-us/library/system.componentmodel.inotifypropertychanged.aspx)，如果有意义，其他人可能会喜欢使用，其他人可能会说所有这些模式不属于 UI 之外的其他层。（如果您想了解更多信息，可以在 MSDN 库中找到一些优秀的 WPF[数据绑定文章](http://msdn.microsoft.com/en-us/library/ms750612.aspx)，包括性能和用户界面的最佳实践）

微软选择将一些好东西添加到`System.Windows`命名空间，而不是例如，`System.ComponentModel`在我认为它们可能更有用的地方（通过提供所有这些重要的模式，不仅为 WPF，而且为.NET 框架）。

当然，这只是开始，我们中的许多人都知道事情最终会朝着正确的方向发展。（有跑题的风险：以 silverlight 2.0 框架为例。这是一个匆忙发布的版本，WPF 模型中的一些对象丢失了，一些对象不在其自然位置。）

> 最后，一切都取决于您、您的编程风格、您的架构决策以及您对技术的了解。
> 
> 如果以某种方式做这件事似乎比书本上的更自然，那么在做出任何决定之前，请三思`why you should`而后行`why should you not`！

# c++ - 如何在不循环的情况下将数组的内容复制到 C++ 中的 std::vector？

> ID：259297
> 
> 赞同：140
> 
> 时间：2008-11-03T17:03:46.273
> 
> 标签：c++, stl, vector, copy

我有一个值数组，这些值从程序的不同部分传递给我的函数，我需要存储这些值以供以后处理。由于我不知道在处理数据之前我的函数会被调用多少次，所以我需要一个动态存储结构，所以我选择了一个`std::vector`. 我不想对`push_back`所有值单独执行标准循环，如果我可以使用类似于`memcpy`.

* * *

## 回答 #1

> 赞同：238
> 
> 时间：2008-11-04T11:42:17.700

这里有很多答案，几乎所有人都能完成工作。

但是有一些误导性的建议！

以下是选项：

```
vector<int> dataVec;

int dataArray[] = { 1, 2, 3, 4, 5, 6, 7, 8, 9, 10 };
unsigned dataArraySize = sizeof(dataArray) / sizeof(int);

// Method 1: Copy the array to the vector using back_inserter.
{
    copy(&dataArray[0], &dataArray[dataArraySize], back_inserter(dataVec));
}

// Method 2: Same as 1 but pre-extend the vector by the size of the array using reserve
{
    dataVec.reserve(dataVec.size() + dataArraySize);
    copy(&dataArray[0], &dataArray[dataArraySize], back_inserter(dataVec));
}

// Method 3: Memcpy
{
    dataVec.resize(dataVec.size() + dataArraySize);
    memcpy(&dataVec[dataVec.size() - dataArraySize], &dataArray[0], dataArraySize * sizeof(int));
}

// Method 4: vector::insert
{
    dataVec.insert(dataVec.end(), &dataArray[0], &dataArray[dataArraySize]);
}

// Method 5: vector + vector
{
    vector<int> dataVec2(&dataArray[0], &dataArray[dataArraySize]);
    dataVec.insert(dataVec.end(), dataVec2.begin(), dataVec2.end());
} 
```

**长话短说，方法 4 使用 vector::insert 是 bsruth 场景的最佳选择。**

以下是一些血腥的细节：

*方法 1*可能是最容易理解的。只需从数组中复制每个元素并将其推入向量的后面。唉，它很慢。因为有一个循环（隐含在复制功能中），所以每个元素都必须单独处理；基于我们知道数组和向量是连续块的事实，无法进行性能改进。

*方法 2*是对方法 1 的建议性能改进；只需在添加之前预先保留数组的大小。对于大型阵列，这*可能会*有所帮助。然而，这里最好的建议是永远不要使用保留，除非分析表明您可以得到改进（或者您需要确保您的迭代器不会失效）。 [Bjarne 同意](http://www.research.att.com/~bs/bs_faq2.html#slow-containers)。顺便说一句，我发现这种方法在大多数情况下执行得*最慢*，尽管我正在努力全面解释为什么它通常比方法 1 慢*得多*......

*方法 3*是老派的解决方案——在问题上扔一些 C！对 POD 类型运行良好且快速。在这种情况下，需要调用 resize ，因为 memcpy 在向量的范围之外工作，并且没有办法告诉向量它的大小已经改变。除了是一个丑陋的解决方案（字节复制！）之外，请记住这*只能用于 POD 类型*。我永远不会使用这个解决方案。

*方法4*是最好的方法。它的含义很明确，它（通常）是最快的，并且适用于任何对象。将此方法用于此应用程序没有任何缺点。

*方法 5*是对方法 4 的调整 - 将数组复制到向量中，然后附加它。不错的选择 - 通常快速且清晰。

最后，您知道可以使用向量代替数组，对吗？即使函数需要 c 样式的数组，您也可以使用向量：

```
vector<char> v(50); // Ensure there's enough space
strcpy(&v[0], "prefer vectors to c arrays"); 
```

希望能帮助那里的人！

* * *

## 回答 #2

> 赞同：134
> 
> 时间：2008-11-03T17:38:36.653

如果你可以在得到数组和数组大小后构造向量，你可以说：

```
std::vector<ValueType> vec(a, a + n); 
```

...假设`a`是您的数组，并且`n`是它包含的元素数。否则，`std::copy()`w/`resize()`会成功的。

`memcpy()`除非您可以确定这些值是普通旧数据 (POD) 类型，否则我会远离。

此外，值得注意的是，这些都没有真正避免 for 循环——这只是你是否必须在代码中看到它的问题。O(n) 运行时性能对于复制值是不可避免的。

最后，请注意，对于大多数 STL 算法来说，C 风格的数组是完全有效的容器——原始指针等价于`begin()`，并且 ( `ptr + n`) 等价于`end()`.

* * *

## 回答 #3

> 赞同：45
> 
> 时间：2008-11-03T17:39:26.433

如果您所做的只是替换现有数据，那么您可以这样做

```
std::vector<int> data; // evil global :)

void CopyData(int *newData, size_t count)
{
   data.assign(newData, newData + count);
} 
```

* * *

## 回答 #4

> 赞同：12
> 
> 时间：2008-11-03T17:07:34.283

[std::copy](http://www.cppreference.com/wiki/stl/algorithm/copy)是您正在寻找的。

* * *

## 回答 #5

> 赞同：12
> 
> 时间：2008-11-03T17:08:18.573

由于我只能编辑自己的答案，因此我将根据我的问题的其他答案做出综合答案。感谢所有回答的人。

使用[std::copy](http://www.cppreference.com/wiki/stl/algorithm/copy)，这仍然在后台迭代，但您不必输入代码。

```
int foo(int* data, int size)
{
   static std::vector<int> my_data; //normally a class variable
   std::copy(data, data + size, std::back_inserter(my_data));
   return 0;
} 
```

使用常规[memcpy](http://www.cppreference.com/wiki/c/string/memcpy?s[]=memcpy)。这可能最适合用于基本数据类型（即 int），但不适用于更复杂的结构或类数组。

```
vector<int> x(size);
memcpy(&x[0], source, size*sizeof(int)); 
```

* * *

## 回答 #6

> 赞同：4
> 
> 时间：2017-03-01T14:56:57.513

```
int dataArray[] = { 1, 2, 3, 4, 5, 6, 7, 8, 9, 10 };//source

unsigned dataArraySize = sizeof(dataArray) / sizeof(int);

std::vector<int> myvector (dataArraySize );//target

std::copy ( myints, myints+dataArraySize , myvector.begin() );

//myvector now has 1,2,3,...10 :-) 
```

* * *

## 回答 #7

> 赞同：2
> 
> 时间：2008-11-03T17:17:55.543

避免 memcpy，我说。除非你真的必须这样做，否则没有理由搞乱指针操作。此外，它仅适用于 POD 类型（如 int），但如果您正在处理需要构造的类型，它将失败。

* * *

## 回答 #8

> 赞同：2
> 
> 时间：2008-11-03T18:56:15.047

另一个答案，因为那个人说“我不知道我的函数会被调用多少次”，你可以像这样使用向量插入方法将值数组附加到向量的末尾：

```
vector<int> x;

void AddValues(int* values, size_t size)
{
   x.insert(x.end(), values, values+size);
} 
```

我喜欢这种方式，因为向量的实现应该能够根据迭代器类型和类型本身优化插入值的最佳方式。您对 stl 的实现有些回复。

如果您需要保证最快的速度并且您知道您的类型是 POD 类型，那么我会推荐 Thomas 回答中的 resize 方法：

```
vector<int> x;

void AddValues(int* values, size_t size)
{
   size_t old_size(x.size());
   x.resize(old_size + size, 0);
   memcpy(&x[old_size], values, size * sizeof(int));
} 
```

* * *

## 回答 #9

> 赞同：1
> 
> 时间：2008-11-03T17:29:02.663

除了上面介绍的方法之外，您还需要确保使用 std::Vector.reserve()、std::Vector.resize() 或根据大小构造向量，以确保向量中有足够的元素它来保存你的数据。否则，您将破坏内存。对于 std::copy() 或 memcpy() 都是如此。

这就是使用vector.push_back() 的原因，你不能写超出向量的末尾。

* * *

## 回答 #10

> 赞同：0
> 
> 时间：2008-11-03T17:09:15.077

假设您知道向量中的项目有多大：

```
std::vector<int> myArray;
myArray.resize (item_count, 0);
memcpy (&myArray.front(), source, item_count * sizeof(int)); 
```

[http://www.cppreference.com/wiki/stl/vector/start](http://www.cppreference.com/wiki/stl/vector/start)

# jsf - 在 JSF 中的单个标题下对列进行分组

> ID：259309
> 
> 赞同：3
> 
> 时间：2008-11-03T17:07:41.617
> 
> 标签：jsf, hxdatatableex

有没有办法使用 JSF 将两个或多个列分组到 JSF 中的单个父列下？我有一个 dataTableEx，里面有 hx:columnEx 列。我想要的是这样的：

```
 [MAIN HEADER FOR COL1+2   ][Header for Col 3+4]

 [ COL1 Header][COL2 Header][COL3    ][COL 4   ] 

 Data          Data             Data     Data

 Data          Data             Data     Data

 Data          Data             Data     Data

 Data          Data             Data     Data 
```

数据 数据 数据 数据

谢谢

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2008-11-05T17:31:05.280

您可能可以使用表格标题、panelGrid 和一点 CSS 来实现您想要的。

```
<style type="text/css">
.colstyle {
    width: 25%
}
</style>
</head>
<body>

<f:view>
    <h:dataTable border="1" value="#{columnsBean.rows}" var="row"
        columnClasses="colstyle">
        <f:facet name="header">
            <h:panelGrid columns="2" border="1" style="width: 100%">
                <h:outputLabel style="width: 100%" value="MAIN HEADER FOR COL1+2" />
                <h:outputLabel style="width: 100%" value="MAIN HEADER FOR COL3+4" />
            </h:panelGrid>
        </f:facet>
        <h:column>
            <f:facet name="header">
                <h:outputText value="COL1 Header" />
            </f:facet>
            <h:outputLabel value="#{row.col1}" />
        </h:column>
        <h:column>
            <f:facet name="header">
                <h:outputText value="COL2 Header" />
            </f:facet>
            <h:outputLabel value="#{row.col2}" />
        </h:column>
        <h:column>
            <f:facet name="header">
                <h:outputText value="COL3 Header" />
            </f:facet>
            <h:outputLabel value="#{row.col3}" />
        </h:column>
        <h:column>
            <f:facet name="header">
                <h:outputText value="COL4 Header" />
            </f:facet>
            <h:outputLabel value="#{row.col4}" />
        </h:column>
    </h:dataTable>
</f:view> 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2008-11-03T17:22:39.043

您最好的选择可能是对第一个标题（外部表中的第一个标题，嵌套表中的第二个标题和数据）使用嵌套表，使其看起来像两个标题。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2008-11-04T07:47:44.943

也许您可以看看高级组件库，例如为数据表提供更复杂结构的 RichFaces，就像在这个[示例](http://livedemo.exadel.com/richfaces-demo/richfaces/dataTable.jsf)中一样。

# visual-studio - 配置管理器仅显示调试

> ID：259311
> 
> 赞同：19
> 
> 时间：2008-11-03T17:07:57.277
> 
> 标签：visual-studio, visual-studio-2008, configuration, build-environment

我在 Visual Studio 2008 中的 ASP.NET 应用程序上工作，该应用程序已部署到测试服务器。我想在没有调试信息的情况下进行构建以投入生产，但配置管理器仅在我的项目的配置下拉列表中显示“调试”。

我的其他 Visual Studio 项目显示“调试”、“发布”、“新建...”和“编辑...”。

为什么我看不到发布选项或新命令和编辑命令？

* * *

## 回答 #1

> 赞同：25
> 
> 时间：2008-12-02T17:19:24.930

ASP.NET 网站不使用配置管理器来确定调试信息是否包含在编译中。您必须在`web.config`文件中设置它。据我所知，Visual Studio 永远不会自动将调试更改为“false”。

在您的文件中找到此部分`web.config`并将其更改为“false”：

```
<!--
    Set compilation debug="true" to insert debugging
    symbols into the compiled page. Because this
    affects performance, set this value to true only
    during development.
-->

<compilation debug="true"> 
```

如果您在 IDE 中运行您的网站，Visual Studio 会询问您是否希望将其从 false 更改为 true，但不幸的是，它不会对发布进行相反的操作（这对我来说似乎更重要）。

如果您的解决方案中有多个项目，并且其中至少一个支持发布配置（例如 DLL） - 它会出现在配置下拉列表中。但是，选择 Release 进行构建仍然不会影响网站。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2016-02-04T00:32:01.593

在查看了最佳答案并与这个问题搏斗了几个小时后，我遇到了这个答案。我的解决方案是添加一个完整的应用程序：通常使用一个空网站，但同样的问题是发布不显示。我向解决方案添加了一个完整的应用程序，然后它允许我在解决方案中部署我的项目，因为添加完整的应用程序还在下拉列表中添加了“发布”选项。我非常感谢这些建议，但不确定为什么这个工具如此古怪。再次感谢您的建议。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2008-11-04T04:51:30.773

解决方案的配置管理器允许您删除这些默认构建配置中的一个（或两个）（通过上面提到的编辑...选项）。我敢打赌，有人删除了 Release 配置。

您可以通过重新创建它来取回它，或者从您从头开始快速制作的解决方案中复制适当的行。文件差异显示以下内容：

默认解决方案文件：

```
GlobalSection(SolutionConfigurationPlatforms) = preSolution
    Debug|Any CPU = Debug|Any CPU
    Release|Any CPU = Release|Any CPU
EndGlobalSection
GlobalSection(ProjectConfigurationPlatforms) = postSolution
    {EDD50911-B94E-49A4-A08B-A2E91228A04B}.Debug|Any CPU.ActiveCfg = Debug|Any CPU
    {EDD50911-B94E-49A4-A08B-A2E91228A04B}.Debug|Any CPU.Build.0 = Debug|Any CPU
    {EDD50911-B94E-49A4-A08B-A2E91228A04B}.Release|Any CPU.ActiveCfg = Release|Any CPU
    {EDD50911-B94E-49A4-A08B-A2E91228A04B}.Release|Any CPU.Build.0 = Release|Any CPU
EndGlobalSection 
```

手动删除Release配置后的解决方法：

```
GlobalSection(SolutionConfigurationPlatforms) = preSolution
    Debug|Any CPU = Debug|Any CPU
EndGlobalSection
GlobalSection(ProjectConfigurationPlatforms) = postSolution
    {EDD50911-B94E-49A4-A08B-A2E91228A04B}.Debug|Any CPU.ActiveCfg = Debug|Any CPU
    {EDD50911-B94E-49A4-A08B-A2E91228A04B}.Debug|Any CPU.Build.0 = Debug|Any CPU
EndGlobalSection 
```

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2017-03-02T12:51:06.040

过程已更改，您只需在发布过程的设置部分选中底部的 2 个复选框，如图所示。在 bin 文件夹中，您将找到 dll。

![图片](https://i.imgur.com/vCHgcrz.png)

希望有帮助

永然

# python - python smtplib

> ID：259314
> 
> 赞同：0
> 
> 时间：2008-11-03T17:09:05.997
> 
> 标签：python, smtp, smtplib, python-2.1

嘿，我有一个运行 python CGI 脚本的 Windows 服务器，但我在使用 smtplib 时遇到了一些问题。服务器正在运行 python 2.1（不幸的是，我无法升级它）。无论如何，我有以下代码：

```
 `session = smtplib.SMTP("smtp-auth.ourhosting.com", 587)
    session.login(smtpuser, smtppass)` 
```

`它给了我这个错误：`

 ````
exceptions.AttributeError：SMTP 实例没有属性“登录”：  
```

我假设这是因为 login() 方法是在 python 2.1 之后添加的。那么我该如何解决呢？

我必须通过将文件上传到与 cgi 脚本相同的目录来添加模块（尽管我相信 smtplib 是用 C 编写的并且需要编译，我们无法在此服务器上进行编译）

或者

以 python 2.1 中的 libsmtp 所期望的任何方式进行操作

非常感谢！

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2008-11-03T18:01:51.757

login() 是在 Python 2.2 中引入的，对你来说很不幸！在 Python 2.1 自己的 smtplib 中执行此操作的唯一方法是手动发出 AUTH 命令，这不会很有趣。

我还没有完全测试它，但如果你按照你的描述复制它，Python 2.2 的 smtplib 似乎应该或多或少地在 2.1 上工作（也许称之为 smtplib2.py）。它只是一个 Python 模块，不需要 C 编译。但是，您至少还需要从 2.2 的库中复制它所依赖的 hmac.py 库。如果您使用更高版本的 Python 来窃取它，也开始需要电子邮件包，这可能需要更多的工作。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2008-11-03T17:10:47.647

> 以 python 2.1 中的 libsmtp 所期望的任何方式进行操作

# image - 如何在 grails GSP 中显示图像？

> ID：259320
> 
> 赞同：9
> 
> 时间：2008-11-03T17:10:02.140
> 
> 标签：image, grails, groovy

我仍在学习 Grails，似乎遇到了绊脚石。

**以下是 2 个域类：**

```
class Photo {
    byte[] file 

    static belongsTo = Profile
}

class Profile {
    String fullName
    Set photos

    static hasMany = [photos:Photo]     
} 
```

**相关的控制器片段：**

```
class PhotoController {

    def viewImage = {

      def photo = Photo.get( params.id )
      byte[] image = photo.file 
      response.outputStream << image

    } 
} 
```

**最后是 GSP 片段：**

```
<img class="Photo" src="${createLink(controller:'photo', action:'viewImage', id:'profileInstance.photos.get(1).id')}" /> 
```

现在我如何访问照片以使其显示在 GSP 上？我很确定这 `profileInstance.photos.get(1).id`是不正确的。

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2008-11-09T12:37:47.573

如果您有图像的 url，您只需确保在控制器中返回适当的分析器：

```
 def viewImage= {
    //retrieve photo code here
    response.setHeader("Content-disposition", "attachment; filename=${photo.name}")
    response.contentType = photo.fileType //'image/jpeg' will do too
    response.outputStream << photo.file //'myphoto.jpg' will do too
    response.outputStream.flush()
    return;
  } 
```

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2008-11-03T17:29:43.023

因为它是一个集合，如果你想要第一个元素，你将不得不去：

```
profileInstance.photos.toArray()[0].id 
```

或者

```
profileInstance.photos.iterator().next() 
```

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2008-11-06T13:28:35.160

现在，我实际上认为将照片作为二进制 blob 存储在数据库中并不是最好的解决方案——尽管您可能有理由需要这样做。

如何存储照片的名称（和/或路径）呢？如果可能出现名称冲突问题，请使用照片的 md5 校验和作为名称。那么照片就变成了一个静态资源，一个简单的文件，而不是更复杂更慢的 MVC 请求。

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2012-03-28T04:38:17.460

我也在学习 grails，正在寻找一个像这样的例子。GSP snipplet 对我不起作用。我通过替换 profileInstance.photos.get(1).id 周围的单引号来解决

```
<img class="Photo" src="${createLink(controller:'photo', action:'viewImage', id:'profileInstance.photos.get(1).id')}" /> 
```

带双引号：

```
<img class="Photo" src="${createLink(controller:'photo', action:'viewImage', id:"profileInstance.photos.get(1).id")}" /> 
```

现在 grails 解析双引号周围的表达式。否则它将它作为字符串。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2008-11-03T21:27:16.163

我的猜测是您需要设置响应流的内容类型。就像是：

```
response.ContentType = "image/jpeg" 
```

在您流式传输到响应流之前，这可能需要也可能不需要（无法想象这很重要）。我只是把它放在上面代码中的 outputStream 行之前。

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2010-03-14T03:08:53.883

id:'profileInstance.photos.get(1).id' 应该是 id:profileInstance.photos.get(1).id。没有配额

# nhibernate - 有没有办法在 NHibernate 中伪造一个 ID 列？

> ID：259326
> 
> 赞同：3
> 
> 时间：2008-11-03T17:11:07.177
> 
> 标签：nhibernate, nhibernate-mapping

假设我将一个简单对象映射到包含重复记录的表，并且我想在我的代码中允许重复。我不需要在这个表上更新/插入/删除，只显示记录。

有没有办法可以在我的映射文件中放置一个假的（生成的）ID 列来欺骗 NHibernate 认为这些行是唯一的？创建复合键将不起作用，因为所有列中可能存在重复项。

如果这不可能，解决此问题的最佳方法是什么？

谢谢！

编辑：查询似乎是要走的路

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2008-11-04T08:17:05.960

NHibernate 映射假设您将要保存更改，因此需要某种 ID。

如果您被允许修改表，您可以添加一个标识列（SQL Server 命名 - 您的数据库可能不同）来自动生成唯一 ID - 现有代码应该不受影响。

如果您被允许添加到数据库中，但不允许添加到表中，您可以尝试定义一个包含 RowNumber 合成（计算）列的视图，并将其用作要从中加载的数据源。根据您的数据库供应商（以及处理视图和索引的产品），这*可能会*面临一些性能问题。

我没有尝试过的另一种选择是将您的类映射到 SQL 查询而不是表。IIRC，NHibernate 支持在映射文件中命名 SQL 查询，您可以将它们用作“数据源”而不是表或视图。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-04-15T05:07:29.837

如果您的数据是只读的，我们发现一种简单的方法是将查询包装在视图中并在视图之外构建实体，并添加一个 newguid() 列，结果类似于

选择 NEWGUID() 作为 ID，* 从表中

然后 ID 将成为您唯一的主键。如上所述，这仅对只读视图有用。由于查询后ID没有相关性。

# html - 你用什么来测试你网站上的手持 CSS？

> ID：259330
> 
> 赞同：11
> 
> 时间：2008-11-03T17:12:19.483
> 
> 标签：html, css, testing, media, handheld

我一直在为我的网站添加对**手持设备**的 css 支持，但一直找不到一个好的测试工具。

我尝试使用 Firefox 的 webdeveloper 插件，但它对我不起作用。也许那是因为我所有的 css 都在 html 中，而不是单独的 css 文件中。

除了外出购买手持设备外，还有其他可用的测试工具吗？

* * *

## 回答 #1

> 赞同：8
> 
> 时间：2008-11-03T18:06:10.267

经过一番打猎，我找到了我想要的东西，感谢领导者。

如果您从“视图”菜单中选择“小屏幕”，Opera 将显示**手持CSS。**

* * *

## 回答 #2

> 赞同：6
> 
> 时间：2009-06-15T15:39:32.177

我不确定复活旧问题是否是个好主意，但我希望有人能找到它:)

有一种使用[媒体查询](http://www.w3.org/TR/css3-mediaqueries/)测试手持 CSS 的简单方法：

```
 @media handheld, screen and (max-width: 500px) { /* your css */ } 
```

之后，您可以通过将窗口大小调整为小于 500 像素来测试实现媒体查询的浏览器。

* * *

## 回答 #3

> 赞同：3
> 
> 时间：2008-11-03T17:22:29.450

如果你有 Visual Studio，应该有可以让你测试移动 IE 的设备模拟器，或者可以在 Microsoft 的网站上独立找到它们。 [以下是 WM 5 的一些内容](http://www.microsoft.com/downloads/details.aspx?FamilyId=C62D54A5-183A-4A1E-A7E2-CC500ED1F19A&displaylang=en)。有一个[OpenWave 模拟器](http://developer.openwave.com/dvl/tools_and_sdk/phone_simulator/)可用于测试该浏览器。 [黑莓模拟器](http://na.blackberry.com/eng/developers/browserdev/devtoolsdownloads.jsp)也可用于测试黑莓浏览器。尽管您无法验证视口元标记，但您可以（在某种程度上）使用 Safari 测试 iPhone 支持。这里有一个[Opera Mini 模拟器](http://www.operamini.com/demo/)。

另外，从 HTML 中获取 CSS :)

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2011-06-14T13:23:24.127

我发现在开发环境中切换媒体类型最适合我。

例如，如果您正在测试“手持”css，那么只需将媒体类型“screen”添加到媒体 atrib 并注释掉您的默认 css。

此步骤完成后，您通常需要在真实的手持设备上进行测试。

```
<!-- <link rel="stylesheet" type="text/css" media="screen" href="screen.css" /> -->
<link rel="stylesheet" type="text/css" media="screen,handheld" href="handheld.css" /> 
```

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2008-11-03T18:03:23.127

要测试 iPhone，您可以在[此处](http://developer.apple.com/iphone/program/download.html)获取 iPhone SDK 但您需要 OS X / Apple 计算机才能使其以官方方式运行。

非官方/黑客：

*   [有一些方法可以让 OS X 在像这里](http://wiki.osx86project.org/wiki/index.php/Main_Page)这样的标准 PC 硬件上运行。
*   [或者让 SDK 在此处](http://www.phranker.com/2008/01/update-iphone-application-development/)描述的 Linux/vmware 中运行。

快乐黑客！

惠伯特·吉尔

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2011-06-16T15:34:03.720

大多数智能手机（如 iPhone）和一些 Android 设备都无法识别`handheld.css`. 他们采用了，`mediatype="screen"`因此您需要包含这个[JavaScript 的简短片段](http://www.smashingninja.com/webdesign/optimize-website-for-mobile-devices/)。

# java - Any way to "reboot" the JVM?

> ID：259343
> 
> 赞同：35
> 
> 时间：2008-11-03T17:20:05.477
> 
> 标签：java, jvm

Is there any way to reboot the JVM? As in don't actually exit, but close and reload all classes, and run main from the top?

* * *

## 回答 #1

> 赞同：17
> 
> 时间：2008-11-03T18:12:20.830

Your best bet is probably to run the java interpreter within a loop, and just exit. For example:

```
#!/bin/sh
while true
do
    java MainClass
done 
```

If you want the ability to reboot or shutdown entirely, you could test the exit status:

```
#!/bin/sh
STATUS=0
while [ $STATUS -eq 0 ]
do
    java MainClass
    STATUS=$?
done 
```

Within the java program, you can use System.exit(0) to indicate that you want to "reboot," and System.exit(1) to indicate that you want to stop and stay stopped.

* * *

## 回答 #2

> 赞同：7
> 
> 时间：2008-11-03T18:08:56.547

IBM's JVM has a feature called "resettable" which allows you to effectively do what you are asking.

[http://publib.boulder.ibm.com/infocenter/cicsts/v3r1/index.jsp?topic=/com.ibm.cics.ts31.doc/dfhpj/topics/dfhpje9.htm](http://publib.boulder.ibm.com/infocenter/cicsts/v3r1/index.jsp?topic=/com.ibm.cics.ts31.doc/dfhpj/topics/dfhpje9.htm)

Other than the IBM JVM, I don't think it is possible.

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2008-11-04T05:41:46.493

Not a real "reboot" but:

You can build your own class loader and load all your classes (except a bootstrap) with it. Then, when you want to "reboot", make sure you do the following:

1.  End any threads that you've opened and are using your classes.
2.  Dispose any Window / Dialog / Applet you've created (UI application).
3.  Close / dispose any other GC root / OS resources hungry peered resource (database connections, etc).
4.  Throw away your customized class loader, create another instance of it and reload all the classes. You can probably optimize this step by pre-processing the classes from files so you won't have to access the codebase again.
5.  Call your main point of entry.

This procedure is used (to some extent) while "hot-swapping" webapps in web servers.

Note though, static class members and JVM "global" objects (ones that are accessed by a GC root that isn't under your control) will stay. For example, Locale.setLocale() effects a static member on Locale. Since the Locale class is loaded by the system class loader, it will not be "restarted". That means that the old Locale object that was used in Locale.setLocale() will be available afterward if not explicitly cleaned.

Yet another route to take is instrumentation of classes. However, since I know little of it, I'm hesitant to offer advice.

[Explanation about hot deploy with some examples](http://www.pabrantes.net/blog/comments/start/2007-07-23/1 "Java Programming: Hot Deploy")

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2008-11-03T18:12:16.617

If you're working in an application server, they typically come with built-in hot deployment mechanisms that'll reload all classes in your application (web app, enterprise app) when you redeploy it.

Otherwise, you'll have to look into commercial solutions. Java Rebel ([http://www.zeroturnaround.com/javarebel/](http://www.zeroturnaround.com/javarebel/)) is one such option.

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2008-11-03T18:07:09.203

AFAIK there is no such way.

Notice that if there were a way to do that, it would highly depend on the current loaded code to properly release all held resources in order to provide a graceful restart (think about files, socket/tcp/http/database connections, threads, etc).

Some applications, like Jboss AS, capture Ctrl+C on the console and provide a graceful shutdown, closing all resources, but this is application-specific code and not a JVM feature.

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2008-11-03T20:28:20.853

I do something similar using JMX, I will 'unload' a module using JMX and then 'reload' it. Behind the scenes I am sure they are using a different class loader.

* * *

## 回答 #7

> 赞同：0
> 
> 时间：2014-06-01T13:45:36.313

Well, I currently have this, it works perfectly, and completely OS-independent. The only thing that must work: executing the java process without any path/etc, but I think this can also be fixed.

The little code pieces are all from stackoverflow except RunnableWithObject and restartMinecraft() :)

You need to call it like this:

```
restartMinecraft(getCommandLineArgs()); 
```

So what it basically does, is:

1.  Spawns a new Process and stores it in the p variable
2.  Makes two RunnableWithObject instances and fills the process object into their data value, then starts two threads, they just print the inputStream and errorStream when it has available data until the process is exited
3.  Waits for the process to exit
4.  prints debug message about process exit
5.  Terminates with the exit value of the process(not necessary)

And yes it is directly pulled from my minecraft project:)

The code:

Tools.isProcessExited() method:

```
public static boolean isProcessExited(Process p) {
    try {
        p.exitValue();
    } catch (IllegalThreadStateException e) {
        return false;
    }
    return true;
} 
```

Tools.restartMinecraft() method:

```
 public static void restartMinecraft(String args) throws IOException, InterruptedException {
//Here you can do shutdown code etc
        Process p = Runtime.getRuntime().exec(args);
        RunnableWithObject<Process> inputStreamPrinter = new RunnableWithObject<Process>() {

            @Override
            public void run() {
                // TODO Auto-generated method stub
                while (!Tools.isProcessExited(data)) {
                    try {
                        while (data.getInputStream().available() > 0) {
                            System.out.print((char) data.getInputStream().read());
                        }
                    } catch (IOException e) {
                    }
                }
            }
        };
        RunnableWithObject<Process> errorStreamPrinter = new RunnableWithObject<Process>() {

            @Override
            public void run() {
                // TODO Auto-generated method stub
                while (!Tools.isProcessExited(data)) {
                    try {
                        while (data.getErrorStream().available() > 0) {
                            System.err.print((char) data.getErrorStream().read());
                        }
                    } catch (IOException e) {
                    }
                }
            }
        };

        inputStreamPrinter.data = p;
        errorStreamPrinter.data = p;

        new Thread(inputStreamPrinter).start();
        new Thread(errorStreamPrinter).start();
        p.waitFor();
        System.out.println("Minecraft exited. (" + p.exitValue() + ")");
        System.exit(p.exitValue());
    } 
```

Tools.getCommandLineArgs() method:

```
public static String getCommandLineArgs() {
    String cmdline = "";
    List<String> l = ManagementFactory.getRuntimeMXBean().getInputArguments();
    cmdline += "java ";
    for (int i = 0; i < l.size(); i++) {
        cmdline += l.get(i) + " ";
    }
    cmdline += "-cp " + System.getProperty("java.class.path") + " " + System.getProperty("sun.java.command");

    return cmdline;
} 
```

Aaaaand finally the RunnableWithObject class:

```
package generic.minecraft.infinityclient;

public abstract class RunnableWithObject<T> implements Runnable {
    public T data;
} 
```

Good luck :)

* * *

## 回答 #8

> 赞同：0
> 
> 时间：2016-08-02T15:58:06.237

It's easy in JavaX: You can use the standard functions [nohupJavax()](http://tinybrain.de/1001372) or [restart()](http://tinybrain.de/1003781).

# emacs - Emacs 中的 goto 文件

> ID：259354
> 
> 赞同：53
> 
> 时间：2008-11-03T17:27:20.140
> 
> 标签：emacs

在 emacs 中是否有 vi "gf" 命令的替代品？意思是如果实际文件名确实存在，则尝试立即打开光标下的文件。

谢谢

* * *

## 回答 #1

> 赞同：76
> 
> 时间：2008-11-03T17:36:16.533

您想要该`find-file-at-point`功能（也称为`ffap`）。默认情况下它没有绑定到键，但您可以使用

```
M-x ffap 
```

或者，您可以放入您的`.emacs`文件：

```
(ffap-bindings) 
```

这将用基于 - 的版本替换许多正常的`find-file`键绑定（如`C-x C-f`） 。`ffap`有关详细信息，请参阅中的评论`ffap.el`。

* * *

## 回答 #2

> 赞同：8
> 
> 时间：2008-11-04T08:35:19.043

谢谢，它工作得很好，但不知何故 vi (gf) 版本仍然有点聪明。我认为它着眼于搜索路径的一些路径变量。

我做了一些不必要的复杂但对我有用的东西（仅在 linux 中）。它使用“定位”命令来搜索光标下的路径。我想它可以通过首先搜索当前文件的相对路径来变得更智能。对不起我糟糕的 elisp 技能......它可能可以以更好的方式实现。

放入您的 .emacs，然后与 Mx goto-file 一起使用

```
(defun shell-command-to-string (command)
  "Execute shell command COMMAND and return its output as a string."
  (with-output-to-string
    (with-current-buffer standard-output
      (call-process shell-file-name nil t nil shell-command-switch command))))

(defun goto-file ()
  "open file under cursor"
  (interactive)
  (find-file (shell-command-to-string (concat "locate " (current-word) "|head -c -1" )) )) 
```

# c - 如何使用文件描述符刷新写入？

> ID：259355
> 
> 赞同：44
> 
> 时间：2008-11-03T17:27:41.777
> 
> 标签：c, linux, stdio, i2c

> 事实证明，对 open() 与 fopen() 的整个误解源于 ARM 上的 Linux 2.6.14 内核中存在错误的 I2C 驱动程序。向后移植一个工作位 bashed 驱动程序解决了我试图在这里解决的问题的根本原因。

我试图找出 Linux (I2C) 中串行设备驱动程序的问题。看来，通过在设备上的写入和读取之间添加定时操作系统暂停（睡眠），事情会工作......（好多了）。

> 旁白：*I2C 的本质是主机读取或写入的每个字节都由线路另一端（从机）上的设备确认 - 改善事情的暂停鼓励我将驱动程序视为异步工作 - 我无法与公共汽车的工作方式相协调。随便...*

我想确保**刷新**写入（而不是使用固定持续时间的暂停），***或者***以某种方式测试写入/读取事务是否以多线程友好的方式 **完成。**

使用的问题`fflush(fd);`是它需要'fd'作为流指针（不是文件描述符），即

```
FILE * fd = fopen("filename","r+");
... // do read and writes
fflush(fd); 
```

我的问题是我需要使用`ioctl()`不使用流指针的 。IE

```
int fd = open("filename",O_RDWR);
ioctl(fd,...); 
```

建议？

* * *

## 回答 #1

> 赞同：40
> 
> 时间：2010-07-03T23:08:11.707

我想你正在寻找的可能是

```
int fsync(int fd); 
```

或者

```
int fdatasync(int fd); 
```

`fsync`会将文件从内核缓冲区刷新到磁盘。`fdatasync`除了元数据之外也可以。

* * *

## 回答 #2

> 赞同：29
> 
> 时间：2008-11-03T17:34:23.217

你有两个选择：

1.  用于获取与流指针`fileno()`关联的文件描述符`stdio`

2.  根本不要使用`<stdio.h>`，这样你也不需要担心刷新 - 所有写入都会立即转到设备，对于字符设备，`write()`调用甚至不会返回，直到低级 IO 完成（在理论）。

对于设备级 IO，我会说使用`stdio`. 我强烈建议使用较低级别的`open()`,`read()`和`write()`函数（根据您以后的回复）：

```
int fd = open("/dev/i2c", O_RDWR);
ioctl(fd, IOCTL_COMMAND, args);
write(fd, buf, length); 
```

* * *

## 回答 #3

> 赞同：12
> 
> 时间：2008-11-04T07:32:32.477

`fflush()`仅刷新由对象`fopen()`管理的 stdio 层添加的缓冲。`FILE *`如内核所见，底层文件本身并未在此级别缓冲。这意味着使用和 raw绕过`FILE *`层的写入也不会以刷新的方式进行缓冲。`fileno()``write()``fflush()`

正如其他人指出的那样，尽量**不要**将两者混为一谈。如果你需要使用“原始”I/O 函数如`ioctl()`, 则`open()`直接自己创建文件，**无需**使用`fopen<()`stdio 的和朋友。

* * *

## 回答 #4

> 赞同：4
> 
> 时间：2016-08-03T20:19:44.183

您是否尝试过禁用缓冲？

```
setvbuf(fd, NULL, _IONBF, 0); 
```

* * *

## 回答 #5

> 赞同：2
> 
> 时间：2008-11-04T14:14:12.200

如果您想反过来（将 FILE* 与现有文件描述符相关联），请使用 fdopen() ：

```
 FDOPEN(P)

NAME

       fdopen - associate a stream with a file descriptor

SYNOPSIS

       #include <stdio.h>

       FILE *fdopen(int fildes, const char *mode); 
```

* * *

## 回答 #6

> 赞同：2
> 
> 时间：2009-11-08T14:33:42.423

听起来您正在寻找的是 fsync() 函数（或 fdatasync()？），或者您可以在 open() 调用中使用 O_SYNC 标志。

# c# - 如何为 C# 模式配置 Emacs speedbar？

> ID：259364
> 
> 赞同：7
> 
> 时间：2008-11-03T17:31:04.220
> 
> 标签：c#, emacs

我在[C# 模式下](http://mfgames.com/linux/csharp-mode)使用 Emacs ，当我打开速度栏时，默认情况下不显示任何文件。我可以在速度条模式下选择“显示所有文件”，但随后每个 .cs 文件的名称旁边都会显示一个“[？]”。如何正确配置 speedbar，使其默认显示为 .cs 文件？如何在每个文件旁边显示“[+]”，以便在文件内导航？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2008-11-04T08:49:47.313

我之前使用了speedbar，非常恼火。我现在使用[欧洲央行](http://ecb.sourceforge.net/)。[ECB](http://ecb.sourceforge.net/)为树使用自己的缓冲区，并且可以选择在单独的缓冲区中显示 CS 文件的轮廓。它们都安装在同一个框架中，而 Speedbar 有自己的框架。

我为欧洲央行设置了一些[自定义的东西。](http://lisp.pastebin.com/m2a590520)你可以在这里看到它。

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2009-01-08T20:46:03.043

我认为带有 CEDET 的欧洲央行实在是太臃肿了。我将 speedbar 单独与 emacs 一起使用，并将原始解析器用于 C/C++。只需将此行添加到您的 .emacs 中，就可以了：

```
 (speedbar-add-supported-extension ".cs")
   (add-to-list 'speedbar-fetch-etags-parse-list
            '("\\.cs" . speedbar-parse-c-or-c++tag)) 
```

这可以毫无问题地完美处理 C#。希望这可以帮助。

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2010-05-07T17:42:07.940

这个对我有用。

我用了

```
(speedbar-add-supported-extension ".cs") 
```

得到了这个：

![替代文字](https://i.imgur.com/d1vMA.png)

# apache - Apache modrewrite .htaccess

> ID：259369
> 
> 赞同：0
> 
> 时间：2008-11-03T17:33:35.213
> 
> 标签：apache, .htaccess, mod-rewrite, url-rewriting

我希望能够从以下位置重写 URL：

```
// examples

http://example.com/location/New York, NY  -->
http://example.com/location/index.html?location=New York, NY

http://example.com/location/90210  -->
http://example.com/location/index.html?location=90210

http://example.com/location/Texas -->
http://example.com/location/index.html?location=Texas

http://example.com/location/ANYTHING....  -->  
http://example.com/location/index.html?location=ANYTHING... 
```

使用`.htaccess`和 mod_rewrite。

有人知道怎么做吗？

我努力了：

```
RewriteEngine on
RewriteCond %{REQUEST_URI} !location/index.html
RewriteRule ^location/(.*)$ /location/index.html?location=$1 
```

[但是，当您使用“漂亮的 url”（例如http://example.com/location/90210](http://example.com/location/90210)）时，它不会将 GET 位置变量传递给 /location/index.html 页面。

我知道这个 b/c 当我在屏幕上回显时（**使用 javascript**）位置 GET 变量在使用长 url 时已设置，但当使用漂亮（短）url 时，位置 GET 变量未定义。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2008-11-03T17:47:49.257

你的最后一个例子应该有效；我还要检查条件是否区分大小写（以避免 /LoCation/indeX.htmL 被解析），用 [L] 终止重写（以防止无限循环）并添加 QSA（用于附加查询）：

```
RewriteEngine on
RewriteCond %{REQUEST_URI} !location/index.html [NC]
RewriteRule ^location/(.*)$ /location/index.html?location=$1 [L,QSA] 
```

您如何读出（并回显）位置 GET 变量？“我正在使用 JavaScript 来回显一个打印“位置”变量的警报。”

JavaScript 在您的浏览器中运行（“客户端”），因此它与您的浏览器看到的相同数据一起工作。即，如果您将浏览器指向`http://www.example.com/foo/bar/`，那么无论您在服务器上使用什么重写，Javascript 仍然会将“ `http://www.example.com/foo/bar/`”视为位置。

要访问 GET 变量，您需要一些代码在页面生成（“服务器端”）时访问它们，然后再将其发送到浏览器。例如，当您有一个支持 PHP 的服务器时，[http://www.example.com/location/index.php](http://www.example.com/location/index.php)上的以下脚本并通过类似上述代码的方式重定向到它，它将能够访问和使用 GET 变量：

```
<?php
echo 'The location you entered is ' . $_GET['location'] . '.';
?> 
```

当与重写结合使用时，对于 URL `http://www.example.com/location/Houston,TX`，它将打印出以下内容：

```
The location you entered is Austin,TX. 
```

（当然，服务器端语言有很多，我以我最熟悉的PHP为例）

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2008-11-03T19:07:38.380

重申一下，Piskvor 发布的解决方案确实按预期工作。根据对此的评论，您正在使用 javascript 来获取查询字符串，这就是问题所在。就 javascript 而言，原始 URL 就是它看到的那个。您可以自己快速确认这一点：

```
alert(document.location.href); 
```

如果您需要在 javascript 中获取值，我建议使用类似的东西：

```
var regex = /location\/(.*)$/;
var query = document.location.href.match(regex);
alert(query[1]);

// query[1] will contain "90210" in your example
// http://example.com/location/90210 
```

# apache - Apache/.htaccess - 对域进行密码保护，但将其中的某些 URI 列入白名单

> ID：259372
> 
> 赞同：0
> 
> 时间：2008-11-03T17:35:14.883
> 
> 标签：apache, .htaccess, passwords, http-authentication

所以这就是我想做的事情：

访问[http://example.com/](http://example.com/) * 需要用户输入用户名/密码，除非他们访问特定的 URI（例如[http://example.com/contact/](http://example.com/contact/)、[http://example.com /blog/](http://example.com/blog/)等）他们不应该进行身份验证。[http://example.com](http://example.com)（根）也应该打开。

我知道我必须设置一些特殊的 .htaccess 指令，但我不知道该怎么做。有谁知道我怎么能做到这一点？

任何帮助将非常感激。谢谢！

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2008-11-03T18:27:13.000

对于子目录，只需关闭基本身份验证。似乎没有直接的方法可以做到这一点（例如通过“require none”指令），但您可以说您接受基于主机的访问控制，并且任何主机都可以访问。以下对我有用：

```
 <Location /foo>
            AuthType Basic
            AuthName Foo
            AuthUserFile /tmp/passwd
            require valid-user
    </Location>
    <Location /foo/bar>
            Allow from all
            Satisfy any
    </Location> 
```

# c# - 在 Medium Trust 中调用内部方法

> ID：259380
> 
> 赞同：3
> 
> 时间：2008-11-03T17:39:19.977
> 
> 标签：c#, asp.net, medium-trust

我需要调用第 3 方对象的内部方法（例如，我不能将其公开）。我可以通过反思来做到这一点。不幸的是，由于权限不足，这在 ASP.NET 中等信任中不起作用：

```
<IPermission class="ReflectionPermission" version="1" Flags="RestrictedMemberAccess"/></PermissionSet> 
```

在这种情况下，我有什么办法可以使用内部方法吗？我听说 LINQ 表达式可用于调用私有/内部方法。表达式方法会以某种方式覆盖 ReflectionPermission 吗？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2008-11-05T14:21:22.527

我没有办法调用它。.NET 安全/信任模型旨在防止此类事情发生。如果您能以某种方式规避它，您将不得不向 Microsoft 提交一个安全错误，然后（希望）将其修复并使您的解决方案再次无用 ;-)

您不能与解决方案的部署者/操作者协商更高的信任级别吗？

# model-view-controller - 如何使用 MVC 在同一页面上显示多个小部件

> ID：259382
> 
> 赞同：10
> 
> 时间：2008-11-03T17:40:19.723
> 
> 标签：model-view-controller

我对 MVC 的工作原理有点困惑，除了基本的例子我什么也找不到。

我想做一种基于小部件的设计；您可以选择各种小部件进入您的页面。每个小部件都应该对自己负责——它应该有一个控制器和一个视图。但是主页呢？突然间，我有了一个页面，上面有很多控制器！

显而易见的事情是以某种方式将控制器嵌入到视图中......`This is my widget {SomeWidget}`但我读过“打破了 MVC 范式”。

有些小部件需要 POST 到不同的 url（比如搜索框转到结果页面），有些需要 POST 回相同的 URL（比如在文章中添加评论将您带回文章）。

最重要的是，用户应该能够编辑小部件周围的 HTML - 例如，如果他们想要右侧的搜索框，他们可以输入`<div style="float: right;">{SearchController}</div>`（在我的打破范式的世界中）

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2008-11-03T17:56:12.000

我不太擅长网络编程，但我相信，从你描述的例子来看，整个页面应该有一个模型、一个视图和一个控制器。现在视图本身应该包含页面中每个小部件的视图（页面控制器也是如此），它将接收到的消息分派到这些小部件。

从概念上讲，存在较低级别的 MVC（用于小部件）和较高级别的 MVC（用于页面）。而且 MVC 范式不会被打破。现在您可以编辑小部件周围的 HTML，它会更改页面模型（而不是任何小部件模型）。

希望这可以帮助 ！

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2008-11-03T18:13:20.937

要添加到@Benoît 的评论：

Symfony 框架通过组件来处理这个问题。每个组件都是一个独立的 MVC 实例，可以嵌入到另一个视图中。它不能像普通的 MVC 实例（模块/动作对）那样被实例化以直接响应 Web 请求。它只能嵌入到另一个 MVC 视图中。

附带说明：Symfony 还将插件视为它们自己的完整 MVC 实例，具有自己的模式、模型、控制器、配置文件、视图等。

在您的情况下，每个组件都是它自己的 MVC 实例，应用程序会将这些组件拼接在一起。每个组件都将负责它如何响应表单提交。

MVC 并不意味着只有一个视图和一个控制器。这只是意味着应用程序逻辑存储在模型中，控制器将事物粘合在一起，视图构建显示。这是逻辑和表示的形式和逻辑分离。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2008-11-03T19:38:54.227

我在 MVC 上找到的最好的、简短的和简单的书之一是上周在 PDC 2008 博览会上分发的：

[http://www.apress.com/book/view/1430216468](http://www.apress.com/book/view/1430216468)

它不仅涵盖了 MVC 的概念，还涵盖了它与其他概念的比较，例如 Ruby on Rails 和 MVP 方法。

此外，它通过描述 MVC*的关注点分离来了解*MVC 存在的全部原因，以及为什么它不仅应该在 UI 级别，还应该深入到业务对象和 DAL 的实际层或 IoC 结构。

我强烈推荐这本书，因为他仅在 110 页左右就涵盖了最佳实践。

不，我根本不为 FirstPress 工作或与他们有关。我只是喜欢这本书，终于有人同意了。

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2009-02-19T02:58:48.493

我发现的关于在 ASP.NET MVC 中做小部件的最佳信息是在 Steve Sanderson 的博客上。他解释了他的部分请求的概念，这是一种与子控制器不同的技术。

[http://blog.codeville.net/2008/10/14/partial-requests-in-aspnet-mvc/](http://blog.codeville.net/2008/10/14/partial-requests-in-aspnet-mvc/)

> **部分请求很容易**你听说过部分视图，那么部分请求呢？在任何 MVC 请求中，您都可以设置内部部分请求的集合，每个请求都可以设置自己的内部部分请求等。每个部分请求都会在您的任何普通常规控制器中呈现一个普通的旧操作方法，并且每个请求都可以生成一个独立的小部件。我称它们为部分“请求”而不是“控制器”，因为它们运行适当的 MVC 请求处理管道，该管道与您的路由系统和控制器工厂兼容。尽管如此，与子控制器一样，所有控制都保留在控制器中，并且视图可能是无知的。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2008-11-06T05:57:15.460

ASP.NET MVC 非常适合小部件仪表板混搭类型页面。

看看PDC 2008 上的[这个](http://channel9.msdn.com/pdc2008/PC21/)会话。

您可能希望使用 Ajax 帮助程序来更新每个小部件中的数据孤岛。以下是如何在任何页面上放置计算器但保持代码独立的片段。

**查看片段：**

```
<script type="text/javascript">
    function OnFailure(error) {
        alert("We have encounterd an error " + error);
    }
</script>
<% using (Ajax.BeginForm("Add", new AjaxOptions{UpdateTargetId="sum", OnFailure="OnFailure"})){ %>
    <%= Html.TextBox("x") %>&nbsp;+&nbsp;
    <%= Html.TextBox("y") %>&nbsp;=&nbsp;
    <span id="sum">?</span>
    <input type="submit" value="AddEm" />
<% } %> 
```

**控制器片段：**

```
[AcceptVerbs(HttpVerbs.Post)]
public ActionResult Add(string x, string y)
{
    int sum = int.Parse(x) + int.Parse(y);       
    return Content(sum.ToString());
} 
```

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2009-02-19T03:21:19.220

我认为 JarrettV 和 jcoby 的答案最接近。

我已经将子控制器称为 Hierarchical MCV ( **HMVC** )。这个想法是您从父视图模板“拉”内容（由子控制器填充的视图），而不是从控制器“推送”数据到模板。因此，您无需同时编辑控制器和视图来添加小部件，只需从视图中调用小部件即可。在 php 框架 CodeIgniter（模块化扩展）和 Kohana（调度和组件）中有库可以完成此任务。

* * *

## 回答 #7

> 赞同：0
> 
> 时间：2008-11-03T18:14:03.120

MVC 主题有很多变化，在得出特定系统设计的结论之前需要考虑很多。大多数最新、流行的基于 Web 的系统都将[IoC](http://martinfowler.com/articles/injection.html)视为指导原则。通常，某种框架组件是控制器，它使用某种配置来调用适当的模板作为视图，并将其与适当的对象层次结构耦合为模型。这些系统中的大多数都包含模板使用的可扩展 GUI 小部件库。您可以添加自己的小部件，但将小部件硬编码到特定的对象层次结构并不是最佳做法。该 IoC 链接还讨论了组件和服务，它们应该为您提供一些关于如何避免硬编码的指导。

# xmpp - 哪些 XMPP 客户端当前支持 PubSub (XEP-0060)？

> ID：259385
> 
> 赞同：8
> 
> 时间：2008-11-03T17:40:47.290
> 
> 标签：xmpp

哪些最终用户客户端（不是库）现在向用户公开[XMPP](http://en.wikipedia.org/wiki/Extensible_Messaging_and_Presence_Protocol) [XEP-0060 ？](http://en.wikipedia.org/wiki/Publish/subscribe#See_also)

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-04-15T11:43:43.767

我不确定 Tkabber，但有各种客户端可以让你玩 PubSub。它们都没有公开利用 PubSub 独特概念的创新用户界面：它们主要是服务发现节点树中基本 CRUD 的开发人员工具。但也许这正是你所需要的......

具有 PubSub 服务发现的即时消息客户端：

*   [米兰达](http://www.flickr.com/photos/pip/2548390542/)
*   [磅/平方英寸](http://www.process-one.net/images/uploads/xmpp_app_server1.jpg)

专业的 PubSub 管理客户：

*   [发布订阅客户端](http://seriously-this-is-not-worth-reading.blogspot.com/2009/01/pubsubclient-back-in-development.html)
*   [x60br](http://x60br.berlios.de/)

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2008-11-03T18:38:45.800

[tkabber](http://tkabber.jabber.ru)

# ms-access - 更改“选项卡控件”颜色

> ID：259386
> 
> 赞同：16
> 
> 时间：2008-11-03T17:41:07.897
> 
> 标签：ms-access, forms

如何更改**Tab Control**的**背景颜色**。我更改了表单颜色，但选项卡保持不变。

 **谢谢。

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2008-11-03T18:05:11.203

检查选项卡控件的返回样式。如果是正常的。你会得到一个灰色的背景（使用正常的 Windows 设置）。如果它是透明的，那么它将继承表单的背景颜色。

如果您希望它是完全不同的颜色，您可能必须在表单中添加一个矩形（使背景不透明），在选项卡中最大化它，然后设置矩形的颜色。

至于他们自己的标签，我看不到独立设置颜色的方法。

* * *

## 回答 #2

> 赞同：7
> 
> 时间：2008-11-03T18:23:34.113

据我所知，在 Access 2000/2002/2003 中，既不能更改背景色，也​​不能更改选项卡的前景色。

所以，如果你想改变**整个**选项卡控件的外观，我认为你不走运。

但是，如果您的真正目标是实现选项卡控件页面的某种颜色编码，那么当我遇到此问题时，我会这样做：

*   我在选项卡控件的每一页上放置了一个彩色矩形，为不同的页面提供不同的背景颜色。

*   至于标签本身。幸运的是它们可以包含图像，所以我创建了一些简单的图像文件，每个文件都是一个小的彩色项目符号（正方形、矩形、圆形 - 任何你觉得更好看的东西）并将它们放在选项卡上，靠近文本标签。

因此，整个控件仍然保持灰色（或 Windows 当前主题中的当前“按钮颜色”），但每个选项卡和每个页面都与我需要它们具有的任何颜色相关联。

* * *

## 回答 #3

> 赞同：5
> 
> 时间：2013-02-12T16:19:42.177

使用 Access 2010，在选项卡控件对象中设置“Pressed Color”属性的颜色允许您设置选项卡页的背景颜色。

对于 Access 2013，还需要设置选项卡控件的“背景颜色”属性的颜色（与“按下的颜色”相同）。

* * *

## 回答 #4

> 赞同：2
> 
> 时间：2008-11-07T04:54:10.610

CodeSlave 提出了非常好的建议：

> 如果您希望它是完全不同的颜色，您可能必须在表单中添加一个矩形（使背景不透明），在选项卡中最大化它，然后设置矩形的颜色。

如果您想要一个相对于选项卡尺寸大于选项卡允许的背景（有一个不能超过的硬边框），还有另一种解决方案（尽管它有点复杂——这通常是当您调整外观以使其无法按照默认环境的设计方式工作时会发生这种情况）。

将选项卡控件设置为透明。在选项卡后面，放置一个不透明的框。然后在选项卡的 OnChange 事件中，更改选项卡后面的框的背景颜色。

有点乱，是的，但它允许您拥有与整个选项卡一样大的背景（或者更大，以防您可能希望在相同颜色字段内的选项卡中关闭项目）。

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2008-11-03T19:23:24.463

你可以用一些代码来模拟它。将选项卡控件的 Style 属性设置为 None 并使用任何其他具有单击事件的控件来创建您自己的彩色选项卡（您甚至可以拥有图像）。您的代码可以更改选项卡或更改子表单的内容。

更改选项卡：

```
 Me.NameOfTabControlPage.SetFocus 
```

更改子窗体控件内容：

```
 Me.NameOfSubformControl.SourceObject = "NameOfSuitableForm" 
```

* * *

## 回答 #6

> 赞同：1
> 
> 时间：2012-11-05T17:46:35.420

我开发了一个子程序来将选项卡右侧的小矩形设置为透明。我用 Access 2003 和 2007 对其进行了测试。

```
Private Const GWL_EXSTYLE = -20
Private Const WS_EX_TRANSPARENT = &H20&

Private Declare Function GetWindowLong Lib "user32" Alias "GetWindowLongA" (ByVal hwnd As Long, ByVal nIndex As Long) As Long
Private Declare Function SetWindowLong Lib "user32" Alias "SetWindowLongA" (ByVal hwnd As Long, ByVal nIndex As Long, ByVal dwNewLong As Long) As Long
Private Declare Function FindWindowEx Lib "user32" Alias "FindWindowExA" (ByVal hWnd1 As Long, ByVal hWnd2 As Long, ByVal lpsz1 As String, ByVal lpsz2 As String) As Long

Public Sub PatchTabControl(ByVal f As Form)
   Dim hwnd As Long
   hwnd = FindWindowEx(f.hwnd, 0, "OFormSub", vbNullString)
   If hwnd = 0 Then Exit Sub
   hwnd = FindWindowEx(f.hwnd, hwnd, "OFormSub", vbNullString)
   If hwnd = 0 Then Exit Sub
   hwnd = FindWindowEx(hwnd, 0, "OTabControl", vbNullString)
   If hwnd = 0 Then Exit Sub
   SetWindowLong hwnd, GWL_EXSTYLE, GetWindowLong(hwnd, GWL_EXSTYLE) Or WS_EX_TRANSPARENT
   End Sub 
```

* * *

## 回答 #7

> 赞同：0
> 
> 时间：2015-08-10T22:16:31.070

扩展 Duane Rochelle 对 Access 2010 的有用答案：

问题似乎是微软赋予控制标签颜色的属性的名称是违反直觉的。

基本上，可以使用*Pressed Color*属性控制选项卡的颜色。在整个选项卡对象的属性中查找它，而不是在单个选项卡的属性中。

这意味着，将*Pressed Color*设置为 - 例如 - 某种蓝色（例如，#8EA3BD）会使所有选项卡变为蓝色。由于“按下”实际上意味着“选项卡区域位于其他选项卡的顶部”，因此这或多或少等同于为选项卡区域着色。

（就我个人而言，“按下的颜色”是一个误导性的名称。在选项卡对象中的所有选项卡中，默认情况下一个是可见的，即使没有任何人“按下”选项卡。更好的名称是“可见选项卡的背景颜色” .)

对于要绘制的选项卡对象的其他元素：

对于**选项卡头部**（单击以选择选项卡）上的文本颜色，请使用*Pressed Fore Color*属性。

对于**不可见**（或“隐藏在当前打开的选项卡后面”）的选项卡的背景颜色，请使用*Back Color*属性。

对于**隐藏选项卡头部的文本**，请使用*Fore Color*属性。

因此，我会发现以下名称更直观：

*   可见选项卡的背景颜色（现在为“按下颜色”）

*   可见选项卡的文本颜色（现在为“Pressed Fore Color”）

*   隐藏标签的背景颜色（现在是“背景颜色”）

*   隐藏选项卡的文本颜色（现在为“前景色”）

# linux - 从接口名称中查找 IP 地址

> ID：259389
> 
> 赞同：5
> 
> 时间：2008-11-03T17:41:20.270
> 
> 标签：linux, network-programming

在 Linux 机器上，常见的接口名称类似于 eth0、eth1 等。我知道如何使用或类似功能找到至少一个 IP 地址`gethostbyname`，但我不知道如何指定我想要 IP 地址的命名接口的。我可以使用 ifconfig 并解析输出，但是为这些信息而炮轰似乎......不优雅。

有没有办法，比如说，将所有接口及其 IP 地址（可能还有 MAC 地址）枚举到一个集合中？或者至少是类似的东西`gethostbyinterface("eth0")`？

* * *

## 回答 #1

> 赞同：10
> 
> 时间：2008-11-03T17:59:19.390

```
// Originally from http://www.tlug.org.za/wiki/index.php/Obtaining_your_own_IP_address

#include <sys/types.h>
#include <sys/socket.h>
#include <sys/ioctl.h>
#include <net/if.h>
#include <netinet/in.h>
#include <arpa/inet.h>
#include <string.h>
#include <stdio.h>
#include <unistd.h>

/**
 * getIPv4()
 *
 * This function takes a network identifier such as "eth0" or "eth0:0" and
 * a pointer to a buffer of at least 16 bytes and then stores the IP of that
 * device gets stored in that buffer.
 *
 * it return 0 on success or -1 on failure.
 *
 * Author:  Jaco Kroon <jaco@kroon.co.za>
 */
int getIPv4(const char * dev, char * ipv4) {
    struct ifreq ifc;
    int res;
    int sockfd = socket(AF_INET, SOCK_DGRAM, 0);

    if(sockfd < 0)
        return -1;
    strcpy(ifc.ifr_name, dev);
    res = ioctl(sockfd, SIOCGIFADDR, &ifc);
    close(sockfd);
    if(res < 0)
        return -1;     
    strcpy(ipv4, inet_ntoa(((struct sockaddr_in*)&ifc.ifr_addr)->sin_addr));
    return 0;
}

int main() {
    char ip[16];
    if(getIPv4("eth0", ip) == 0)
        printf("IPv4: %s\n", ip);
    else
        printf("No IP\n");
    return 0;
 } 
```

**更新**：将死链接移至评论（供后代使用）（感谢@obayhan），并添加了语法突出显示。

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2008-11-03T17:59:02.807

**编辑：**我看到你不喜欢炮击。然后你可以看看 ifconfig 是如何工作的（它至少从 /proc 中提取一些信息）。

当你有接口名称时，你可以这样做（在你的 shell 中）：

```
ifconfig eth0 | grep 'inet addr' | sed -e 's/:/ /' | awk '{print $3}' 
```

要枚举接口，您可以使用以下命令：

```
ifconfig | egrep '^[^ ]' | awk '{print $1}' 
```

结合：

```
for x in `ifconfig | egrep '^[^ ]' | awk '{print $1}'`; do
  echo -n "${x}"
  echo -n "    "
  ifconfig "${x}" | grep 'inet addr' | sed -e 's/:/ /' | awk '{print $3}'
done 
```

# reporting-services - 如何在 SQL Server Reporting Services 中最好地显示复选框？

> ID：259390
> 
> 赞同：33
> 
> 时间：2008-11-03T17:41:27.913
> 
> 标签：reporting-services, reportingservices-2005

我们遇到的 Reporting Services 的许多怪癖之一是完全没有 CheckBox 控件，甚至没有类似的东西。

我们有一个表单，它应该根据从数据库中提取的信息自动填写。我们有几个位数据类型字段。打印出“True”或“False”看起来很傻，因为这应该看起来像一个自动填写的表格，所以我们希望有一系列选中或未选中的复选框和标签。

我们正在运行 SSRS 2005，但我不知道 SSRS 2008 添加了 CheckBox 控件。即使是这样，我们也需要暂时有一个替代方案。到目前为止，我们发现的最好的是：

1.  使用 Wingdings
2.  使用图像
3.  使用带边框的文本框并打印空白/空格或大写 X

所有这三种方法都需要`IIF`表达恶作剧。

Wingdings 的方法似乎可以接受，并且在美学上是最令人愉悦的，只是出于某种原因它并不总是能正确打印。更重要的是，无论出于何种原因，PDF 导出都将所有字体（通常）转换为 Arial，因此我们得到了时髦的字母而不是 Windings dingbats。

图像作为基于像素的光栅，在与文本等侧面矢量内容一起打印时效果不佳。除非小心处理，否则它们往往会拉伸、像素化和做其他看起来不专业的事情。

虽然这些方法确实有效（有些有上面提到的限制），但它们都不是特别优雅。

**我们是否遗漏了一些明显的东西？** 不是很明显吗？Microsoft 的某个人是否有充分的理由说明 SSRS 2000 中没有提供这样的控件，更不用说 8 年后的 2 个版本了？这个问题应该不是第一次出现了……

* * *

## 回答 #1

> 赞同：20
> 
> 时间：2008-11-03T18:24:50.057

我和我店里的其他人一起使用图像，根据字段值（真或假）切换隐藏属性。我们在模糊或缩放方面没有任何问题，除非我们试图将图像的比例明显增加到 100% 以上。

我使用的另一个选项类似于wingdings 的想法，但我只使用了一个普通的旧“X”。至少在我们的表格中，有人在框中使用 X 而不是复选标记的情况并不少见，因此看起来完全可以接受。此外，您不必担心打印时出现奇怪的字符。

至于为什么微软不包含复选框控件，我无法回答，因为我自己很长时间以来一直在想同样的事情。

* * *

## 回答 #2

> 赞同：17
> 
> 时间：2010-03-31T22:26:15.510

我用来显示复选框（或投票框）的方法：
1- 创建文本框（这将成为您的复选框）
2- 将字体更改为 Arial Unicode MS
3- 在表达式窗口中使用：
ChrW(&H2611) 填充-in checkbox
ChrW(&H2610) 用于空复选框

* * *

## 回答 #3

> 赞同：15
> 
> 时间：2015-07-29T06:25:16.323

我只是想在这个博客上分享这个想法。[SSRS：如何在报告中显示复选框](https://kkryczka.wordpress.com/2010/12/09/how-to-display-checkbox-on-report/)

1.  首先创建一个文本框
2.  然后将字体系列更改为 Wingdings
3.  在文本框中插入一个表达式并写下这个表达式。

    ```
    =IIF(Fields!Active.Value,chr(254),"o") 
    ```

    Fields!Active.Value 可以是查询中应返回布尔值 1 或 0 的任何内容。

4.  然后单击预览并查看复选框；）

更多样式可以在我上面分享的博客上选择。

这是我的输出示例[![在此处输入图像描述](https://i.stack.imgur.com/QgquR.png)](https://i.stack.imgur.com/QgquR.png)

* * *

## 回答 #4

> 赞同：12
> 
> 时间：2012-10-13T12:16:44.700

除了已经介绍的不同方法之外，从 SQL Server 2008 R2 开始，还有一个内置控件可用于类似于复选框的功能：**Indicator**！

在这里查看有关如何使用它的详细信息：[https ://web.archive.org/web/20190916105459/http://blog.hoegaerden.be/2012/08/04/displaying-checkboxes-in-an- ssrs报告/](https://web.archive.org/web/20190916105459/http://blog.hoegaerden.be/2012/08/04/displaying-checkboxes-in-an-ssrs-report/)

为了能够使用*bit*类型的字段，您必须先将其转换为*int*。这可以在数据集查询中完成，也可以通过向数据集中添加计算字段来完成。

如果您希望 NULL 显示为黄色，那么您需要以这种方式构建表达式，以便它也考虑该要求。

这是计算字段的可能表达式：

```
=Switch(
    IsNothing(Fields!YourBoolean.Value), 50,
    Fields!YourBoolean.Value = False, 0,
    Fields!YourBoolean.Value = True, 100) 
```

根据您的字段的含义 - 是假好还是坏 - 您可能需要交换零和 100。

* * *

## 回答 #5

> 赞同：4
> 
> 时间：2017-09-06T17:19:29.337

另一种方法是转到 TextBox 的“占位符属性”并检查`Html - Interpret HTML tag as styles`

然后在`Value`-`Expression`把这行代码进行检查：

```
="<font face=""Wingdings 2"" color=""green"">" & Chr(81) &"</font>" & "some other text" 
```

或此代码示例未选中：

```
="<font face=""Wingdings 2"" color=""red"">" & Chr(163) &"</font>" & "some other text" 
```

这样您就可以在同一个文本框中拥有复选框和文本。

[![占位符属性](https://i.stack.imgur.com/J9mA4.png)](https://i.stack.imgur.com/J9mA4.png)

`Later edit:`

如果`Wingdings 2`在 Azure 上显示时遇到问题，请使用`Wingdings`.

显然它有效。

```
="<font face=""Wingdings"" color=""green"">" & Chr(253) &"</font>" & "some other text" 
```

或此代码示例未选中：

```
="<font face=""Wingdings"" color=""red"">" & Chr(168) &"</font>" & "some other text" 
```

* * *

## 回答 #6

> 赞同：3
> 
> 时间：2013-02-19T12:33:54.277

您还可以使用字符串计算字段，如“[X]”或“[]”。它不如带边框的文本框漂亮，但您不必为该值放置特定控件，您可以用它填充表格或矩阵。

至少该复选框有一些解决方案。我仍在为我的文字寻找完整的理由（事实上，我正在寻找 SSRS 不知道的另一种解决方案）。

ACCESS 97 可以做这种事情，但 SQL SERVER 2012 不能。

* * *

## 回答 #7

> 赞同：2
> 
> 时间：2009-06-01T14:15:26.550

我认为 SSRS 和嵌入 128 以上的字体字符存在错误（与 ANSI 编码有关）。基本上你可以使用 1-128 罚款，其余的显示为高矩形块。

我喜欢 NY 对带有边框和可选 X 的文本框的想法——这听起来简单而有效。

* * *

## 回答 #8

> 赞同：2
> 
> 时间：2019-07-11T17:35:58.563

这是建立在 Dragos Durlut 的答案之上的。我没有足够高的声誉来发表评论，但我可以回答......

我需要一个复选框作为作为参数传递的文本的一部分。该参数包含 HTML 并用于占位符设置，就像 Dragos 建议的那样： HTML - 将 HTML 标记解释为样式。

不必在 HTML 和字符串之间切换，您可以使用 HTML 转义码 (& + # + CharCode + ; --> ¨)

> ="<font face='Wingdings'>¨</font> 空复选框"

由于我的是一个参数，它只是传入字符串：

> <font face='Wingdings'>¨</font> 空复选框

如果您需要选中复选框，则可以传入 ý 或 þ 反而：

```
<font face='Wingdings'>ý</font> 用 x 填充
<font face='Wingdings'>þ</font> 用复选标记填充
```

# performance - 减少 IBM Websphere Application Server 的重新启动时间

> ID：259391
> 
> 赞同：1
> 
> 时间：2008-11-03T17:41:30.143
> 
> 标签：performance, websphere

我正在处理的 Java Web 应用程序需要我经常重新启动服务器才能看到我的代码更改的效果。我的机器上有一个本地版本的 WAS 6.0，用于运行该应用程序。服务器重新启动大约需要 5-10 分钟。我的机器相当不错，具有双核 proc 和 3 GB 的 RAM，但服务器仍然需要相当长的时间。

我想知道是否有人致力于减少 WAS 服务器的启动时间。我正在寻找提示、技巧、调整或其他任何东西。

在此先感谢您的帮助。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2008-11-03T17:45:11.633

您的应用程序是否正在使用 WebSphere 的任何特定功能，或者它是一个非常标准的 Java EE 应用程序？

我将应用程序部署到 WebSphere，但使用 Tomcat 进行所有开发。我通常可以让它在大约 20 秒左右重新启动。但是我的应用程序通常不使用任何特定于 WebSphere 的东西（MQ、JNDI、安全性等），所以不确定这是否对您有帮助。

除了 Tomcat，您还可以尝试其他轻量级 Java EE 服务器，例如 Jetty 或 Geronimo。

# visual-studio - Visual Studio“查找”导致“找不到要查找的文件。查找已停止进度。”

> ID：259398
> 
> 赞同：101
> 
> 时间：2008-11-03T17:45:01.337
> 
> 标签：visual-studio

有时在 Visual Studio IDE 中开发时，当您使用“在文件中查找”对话框查找内容时，搜索失败，您将在“查找结果”窗口中看到以下消息。

> 没有找到要查找的文件。查找已停止的进度

一旦显示此消息，所有后续搜索都将产生相同的消息。除了按`Ctrl`+之外，没有任何方法可以解决问题，包括重新启动计算机`ScrLk`。

是什么导致 Visual Studio 进入此状态，是否有设置永久阻止它发生？

* * *

## 回答 #1

> 赞同：85
> 
> 时间：2010-04-12T23:05:42.703

根据[~~这个线程~~](http://connect.microsoft.com/VisualStudio/feedback/details/105511/find-in-files-says-no-files-were-found-to-look-in-find-was-stopped)：

> Microsoft 于 2009 年 10 月 13 日下午 4:33 发布
> 
> 大家好，
> 
> 感谢您对这个错误的持续关注。我们已经能够在多个版本的 Windows 上运行的多个 Visual Studio 版本中间歇性地重现该问题，并且已将**根本原因确定为 VS 外部**。遗憾的是，Windows 团队没有时间为他们当前的版本修复此问题，但我们正在与他们合作，希望为未来版本的 Windows 修复此错误。目前，**解决方法（正如你们中的许多人所指出的）是单独按 Ctrl+Scroll Lock、Ctrl+Break 或 Break 键。**
> 
> 再次感谢您提供有关此错误的所有详细信息。如果您还有任何问题或意见，请随时在此处再次发布；虽然这个问题很久以前就关闭了，但我会确保它留在我们的雷达上。
> 
> 谢谢，布列塔尼贝伦斯项目经理，VS 平台 - 编辑

这个错误至少从 2004 年就已经存在，并且截至 2009 年的上述帖子尚未修复。

* * *

## 回答 #2

> 赞同：19
> 
> 时间：2009-12-03T18:54:02.117

有时`Ctrl`+`Break`有效，有时`Alt`+ `Break`，有时`Ctrl`+ `Scroll Lock`，有时`Alt`+ `Scroll Lock`。

现在，没有任何效果。这对我来说是个大问题。为微软在过去九年没有修复这个错误而感到羞耻。

* * *

## 回答 #3

> 赞同：17
> 
> 时间：2010-06-02T13:36:13.920

Apparently, for those for who the key combinations don't work (like me at the moment), deleting the following registry key brings salvation:

```
MyComputer\HKEY_CURRENT_USER\Software\Microsoft\VisualStudio\[VS VERSION NUMBER]\Find 
```

Of course, [VS VERSION NUMBER] should be internal version number of the IDE. Don't forget to restart your computer.

Mind you, deleting stuff in the registry is dangerous. Like anyone on SO cares but anyway...

* * *

## 回答 #4

> 赞同：11
> 
> 时间：2008-11-03T19:11:04.113

我认为您无法采取任何措施来阻止它。它似乎发生在我用 CTRL+Break 停止构建之后......也许我在那段时间按下了 CTRL+Scroll Lock ？？？

我只发生过2-3次，相隔几个月。

他的意思是，偶尔在 Visual Studio 中执行搜索时，您会收到上述错误消息。即使你知道有东西要找。Visual Studio 进入了一些奇怪的状态。如果您按下 (CTRL+Scroll Lock)，它将“修复”该问题。

* * *

## 回答 #5

> 赞同：6
> 
> 时间：2012-01-12T15:26:10.977

目前在 Connect 站点上有九个与此相关的错误并标记为*不可重现*。

我为 Visual Studio 2010 SP1 创建了另一个：*[在 Visual Studio 中执行搜索时“查找已停止”](https://connect.microsoft.com/VisualStudio/feedback/details/718217/find-was-stopped-in-progress-while-performing-search-in-visual-studio)*

如果您无法执行搜索，请为它投票。

PS：微软声称他们在 Visual Studio 2012 中修复了它。

* * *

## 回答 #6

> 赞同：3
> 
> 时间：2011-09-23T10:22:59.160

我遇到了这个问题，并看到了人们关于多个`Ctrl`+`Break/Pause` `Scroll Lock`组合的答案。

我考虑过这一点，但我认为这是一个糟糕的解决方法（特别是当我使用 Mac 键盘时，这些键不容易使用）。

所以我找到的解决方案是这样做：

1.  菜单：*工具*→*选项*→*环境*→*查找和替换*

2.  取消选中前三个复选框（在我的设置中默认选中）。

3.  重新选中前三个复选框。

瞧，一切都应该正常工作。

好吧，无论如何它对我有用，这让我松了一口气，因为我无法相信微软会允许一个奇怪的组合键来解决这样的错误。

我提交这个希望它可以帮助！

* * *

## 回答 #7

> 赞同：3
> 
> 时间：2012-08-30T13:23:36.370

看看这个 Stack Overflow 问题是否有帮助：

*[“整个解决方案”的搜索停止工作](https://stackoverflow.com/questions/892126/visual-studio-search-stops-working-for-entire-solution/892751#892751)*

解决方案的简短版本：

您应该尝试在“查找结果”窗口内单击，一旦闪烁的文本光标可见，请按`Ctrl`+`Break`四到五次。这应该够了吧。

* * *

## 回答 #8

> 赞同：2
> 
> 时间：2013-07-25T05:29:34.567

我对这个问题的经验：

### 重现步骤

我刚刚使用 Windows Server 2008 R2 Standard 和 Visual Studio 2010 SP1 体验了这一点。

我通过 Citrix Receiver（从我的计算机 A 到 B）和 Windows 远程桌面（从 B 到 C）远程访问 Visual Studio。在这个设置中（链接两个远程会话），我有时会卡住修饰键。

在 B 中，我按`Windows`+`Pause`来访问系统属性窗口。（这可能是相关的，也可能不是相关的；我怀疑可能是按键被卡住了。）

后来，当我在 C 上打开 Visual Studio 时，我遇到了这个问题。请注意，我总是使用`Ctrl`++`Shift`来`F`访问*Find All*窗口。

### 解决方案

我按照其他答案中的建议按`Ctrl`+解决了这个问题。`Scroll Lock`

### 原因

至于为什么会发生这种情况，我确实注意到，如果我在文本光标位于“*查找结果*`Ctrl`”窗口中但在找到任何结果之前按+ ，则搜索会以相同的消息停止。这向我表明它与键盘问题有关。`Break`

 *正如其他人所报告的那样，显然这是一个 Windows 错误。[这是关于此的讨论](https://connect.microsoft.com/VisualStudio/feedback/details/718217/find-was-stopped-in-progress-while-performing-search-in-visual-studio)。

* * *

## 回答 #9

> 赞同：2
> 
> 时间：2017-09-26T19:50:45.510

我遇到了一个非常相似的问题。我正在为我的解决方案中的所有 .cs 文件中的所有文件搜索一个短语的文件夹。Visual Studio 一直说“没有找到要查找的文件”。（它没有消息的“查找停止的进度”部分。）

我搜索了消息，发现了这个问题。其他答案中建议的键盘命令不起作用。

我喜欢用键盘导航。我不小心按了 Alt+B 和空格键。Alt+B 是跳转到“查找和替换”表单上的“包含子文件夹”复选框的快捷**方式**。空格键清除了复选框，然后 Alt+A 执行了 Find **All**操作。因为它没有搜索子文件夹，所以没有找到文件。消息是正确的。

选中“包括子文件夹”框后，搜索会在子文件夹中找到匹配的文件。因此，如果您收到消息“未找到要查找的文件”*而没有*消息“查找停止的进度”，请确保搜索正在查找子文件夹！

* * *

## 回答 #10

> 赞同：1
> 
> 时间：2015-05-13T08:20:32.630

这不是 Visual Studio 错误或 Windows 错误。这是一个键盘错误。请在重复问题*[https://stackoverflow.com/a/28219093/147805](https://stackoverflow.com/a/28219093/147805)*中查看答案。

* * *

## 回答 #11

> 赞同：1
> 
> 时间：2016-11-09T06:20:49.600

我昨天在 Visual Studio 2015 中有这个。

在*Find in Files*中，在文本字段*Look in: 中*，我输入了

> *.*

而不是*Entire Solution*，这也导致*No files were found to look in*。

* * *

## 回答 #12

> 赞同：1
> 
> 时间：2017-11-08T20:06:51.917

我发现了另一个原因：当 CMake 是构建过程的一部分时，将解决方案文件夹移动到新位置。

我正在使用 Chromium Embedded Framework，并将主 CEF 文件夹从 e:\ 移动到 c:\ 。这似乎破坏了包括 Find 在内的所有内容，因为它使用的 CMake 构建脚本将磁盘卷和完整路径 (E:\folder) 硬编码到源路径中。

* * *

## 回答 #13

> 赞同：1
> 
> 时间：2017-01-16T08:41:58.927

我可以重现你的问题。

您可以尝试以下一些步骤：

1.  检查设置查找和替换（菜单*工具*→*环境*→*查找*和替换）。
2.  打开“VS2013 的开发人员命令提示符”并粘贴“devenv.exe /resetsettings”

3.  使用 Visual Studio 安装向导（通过控制面板）修复 Visual Studio。您还可以阅读有关在文件中查找的参考：

    [http://msdn.microsoft.com/en-us/library/dechx2tz.aspx](http://msdn.microsoft.com/en-us/library/dechx2tz.aspx)

* * *

## 回答 #14

> 赞同：1
> 
> 时间：2015-08-12T17:02:34.403

我以为我看到了这个问题，但是在寻找解决方案两天后，我发现“查看这些文件类型”选择器已更改并且不包含我需要的文件扩展名。

* * *

## 回答 #15

> 赞同：0
> 
> 时间：2021-03-05T14:22:56.333

为清楚起见，请在“搜索窗口”打开的情况下按`Ctrl`+ 。`ScrlLck`这也为我解决了。

# .net - 中小型 .NET 应用程序的数据库（和 ORM）选择

> ID：259409
> 
> 赞同：3
> 
> 时间：2008-11-03T17:49:26.897
> 
> 标签：.net, orm

我需要开发一个基于 .NET 的应用程序，其数据要求可能会超过 SQL 2005 Express Edition 的 4 gig 限制。

由于内部 DBA 的专业知识，同一应用程序的其他客户（将来）可能需要使用特定的 DB 平台（例如 Oracle 或 SQL Server）。

### 问题

1.  你们会推荐什么 RDBMS？从外观上看，主要的选择是 PostGreSQL、MySQL 或 FireBird。我只从这些中获得了 MYSQL 的经验。

2.  您会推荐使用哪种 ORM 工具（如果有的话）——理想情况下，可以轻松地在 DB 平台之间进行交换？我喜欢实体框架的外观，但不确定支持 SQL Server 以外的平台的程度。如果有帮助，我们将使用 3.5 版本的框架。我对使用 NHibernate 之类的工具持开放态度。另一方面，如果它变得更容易，我很乐意编写自己的存储过程/DAL 代码——不会有那么多表（可能是 30-35 个）。

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2008-11-03T18:11:49.037

我建议将 NHibernate 与 postgres 一起使用。

您可以在 sqlite 上进行所有测试和开发，因此您不需要在开发机器上运行 postgres 实例。

如果您不确定是否要使用 mysql 或 postgres，我建议您都尝试一下。Postgres 更合规，但如果您对 mysql 感到满意（并且您使用的是 ORM），您可能应该使用它。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2008-11-03T18:44:28.627

我使用带有[NHibernate的](http://www.hibernate.org/343.html)[MyGenerationSoftware](http://www.mygenerationsoftware.com/portal/default.aspx)来为 mySQL 数据库自动生成 Classes/OR 细节。MyGenerationSoftware 的好处是它可以查看您的数据库并从中构建您的类。

MySQL（在我看来）是一个生产质量数据库，许多商业网站都使用 mySQL，包括[Slashdot](http://slashdot.org)。

对于 NHibernate，一旦设置好，就可以轻松地编辑 XML 以指向不同的数据库，这就是切换数据库所需的全部内容。

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2008-11-03T18:28:59.673

我最近评估了很多可能的 .NET ORM 解决方案。如果我是你，我不会在使用 MS SQL 以外的任何东西时使用实体框架路线——除了概念实体模型问题（它是通用的，但没有办法用这个模型捕捉类似序列的东西）您强烈依赖第三方数据库驱动程序提供商开发人员 - 对我来说，这个等式中肯定有很多变量。

另一方面，NHibernate 允许在代码中既通用又特定于所选的 DB 方言。例如。您可以将此类属性用于 Id 属性：

```
[Generator( Class = "native")]
//...
public virtual int CustomerId {get; set; } 
```

在 SQL Server NH 中看到“本机”生成器选项将假定它是一个标识字段（自动增量），而对于 Oracle，它将假定此属性使用同名的序列（如果需要，您可以更改序列名称）。

此外，就在几天前，MS 完全放弃了 LINQ 到 SQL 入门级 ORM。您永远无法确定他们是否不会对 Entity Framework 做同样的事情。开源 NHibernate 没有这样的问题。

我不能提出任何不了解您的具体需求的数据库，但是如果您想使用免费软件（不包括 Oracle）并且您还没有使用 MySql 的经验，您应该尝试 Postgres，它比 MySql 更强大。

无论如何，使用 NHibernate，您可以稍后轻松切换数据库。

以下是 NHibernate 支持的数据库方言列表： [http ://www.hibernate.org/361.html](http://www.hibernate.org/361.html)

编辑：注意到您已经了解 MySQL - 因为您不会在 NHibernate 中直接使用 DB正在使用数据库。

但是您应该知道，NHibernate 让您首先编写数据类并自动生成 DB 模式 - 如果您遵循这条路线（从 DDD 的角度来看这是一个很好的想法），DB 层对您来说真的变得透明了。

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2009-06-20T23:45:26.543

Why not Firebird? Firebird has more features than the other free databases. And its supported by NHibernate and Entity Framework. And Firebird could be embedded in you application and the licensing model is less restrictive than MySQL one.

It's only my humble opinion.

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2008-11-03T18:37:10.313

[Llbgen](http://www.llblgen.com)非常适合您的 ORM 映射器。起初有相当多的学习曲线，但一旦你掌握了它的窍门，它就非常好。它支持您在此处提到的数据库以及更多数据库。

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2009-06-26T14:36:08.023

EntityORM - [http://entityorm.uuuq.com](http://entityorm.uuuq.com)满足您的需求，而不仅仅是。

# .net - .NET 上服务层的扩展策略

> ID：259411
> 
> 赞同：6
> 
> 时间：2008-11-03T17:50:57.240
> 
> 标签：.net, scaling, service-tier

我正在开发一个由许多模块化 Web 应用程序组成的 Web 产品。对最终用户来说，它似乎是一个单一的应用程序，尽管各种组件被分解成它们自己的应用程序。

这样做的部分原因是它可以轻松地跨多个应用程序服务器进行水平扩展。

为了便于数据层的水平扩展，我们计划在数据库前面使用 Web 服务层。该层可以扩展到 N 台机器，并且它的每个实例都将单独处理缓存。

这个想法是应用程序将调用服务层负载均衡器，它将调用分配给服务实例，然后使用其缓存返回数据，或连接到数据库并查询数据。看起来这将是无需大量修改应用程序代码即可扩展的最简单的前瞻性解决方案。

```
[N Amount of Databases]
         |
         \/
[Service Tier X N amount of Machines]
         |
         \/
[Application Tier X n amount of Machines] 
```

但是出现了一些问题，我想在服务级别保留用户会话，以便每个应用程序只使用令牌进行身份验证，但是我不确定如何在所有服务机器上维护会话数据而没有单点故障。

关于如何解决这个问题的任何想法？关于建筑的任何其他想法？有没有其他人有过设计一个每天可以处理数百万次点击的网站的项目？

编辑：甚至没有想法？:(

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2008-11-03T19:59:04.407

您已经描述了分布式缓存机制的完美用例，例如 memcached ( [http://www.danga.com/memcached](http://www.danga.com/memcached) ) 或即将推出的 MS Velocity 项目 ( [http://code.msdn.microsoft.com/velocity](http://code.msdn.microsoft.com/velocity) ) .

在您描述的情况下，您有越来越多的服务层实例，每个实例都进行自己的本地缓存，缓存的有用性随着每个新框的增加而降低，因为每个单独的实例必须从数据库中检索相同的数据以填充其本地缓存，即使如果另一个服务层实例刚刚访问了相同的数据。使用 memcached 或 Velocity，缓存机制将智能地将所有服务器上未使用的 RAM 合并到一个缓存中，供所有服务层安装共享。这样，只有第一个访问数据的服务层实例需要使用数据库，其他服务层实例的后续访问将从缓存中提取相同的数据。

这样做也回答了用户会话问题，因为您可以轻松地使用相同的缓存来存储用户会话的状态值，并且您的所有服务层实例都可以访问相同的信息。

希望这可以帮助！

亚当

# graphviz - 在graphviz中记录节点和rankdir

> ID：259415
> 
> 赞同：12
> 
> 时间：2008-11-03T17:52:48.170
> 
> 标签：graphviz

当我将图表的 rankdir 从 LR 更改为 TD 时，我的记录节点也更改了它们的布局方向，因此它们不再看起来像“记录”。我尝试将单独的 rankdir 应用于节点，但这没有效果。

如何保持记录节点的布局正确？

```
digraph sample { 
  graph [rankdir=TD];
  node [shape=record];

  A [label="ShouldBeTop | ShouldBeBottom"];
  B [label="Top | Bottom"];
  A -> B;
} 
```

* * *

## 回答 #1

> 赞同：12
> 
> 时间：2008-11-03T18:37:45.180

考虑到 rankdir 有效地替换了给定图的“顶部”和“底部”的概念，这并不奇怪。

恐怕没有简单的补救措施，除了破解源代码（这根本不容易）。您可以使用某种大规模搜索替换解决方案将您的标签包围在“{}”中，以获得所需的效果：

```
digraph sample { graph [rankdir=TD]; node [shape=record];

A [label="{ShouldBeTop | ShouldBeBottom}"]; 
B [label="{Top | Bottom}"]; A -> B; 
} 
```

* * *

## 回答 #2

> 赞同：5
> 
> 时间：2011-06-12T01:20:42.957

您可以使用类似标签的 html 表格来代替记录。IIRC 基于表格的标签不随等级方向旋转。见[http://www.graphviz.org/doc/info/shapes.html#html](http://www.graphviz.org/doc/info/shapes.html#html)

# ruby - Ruby 是否有类似于 Perl 的“perl -d”的逐步调试器？

> ID：259416
> 
> 赞同：5
> 
> 时间：2008-11-03T17:52:52.507
> 
> 标签：ruby, debugging

Ruby 是否有类似于 Perl 的“perl -d”的逐步调试器？

* * *

## 回答 #1

> 赞同：9
> 
> 时间：2008-11-03T18:03:00.443

[ruby-debug](https://rubygems.org/gems/ruby-debug) ( for ruby​​ 1.8), [debugger](https://rubygems.org/gems/debugger) (for ruby​​ 1.9), [byebug](https://rubygems.org/gems/byebug) (for ruby​​ 2.0) 以及[trepanning](https://rubygems.org/gems/trepanning)系列都有`-x`or`--trace`选项。在调试器内部，该命令`set linetrace`将打开或关闭行跟踪。这是[ruby-debug的手册](http://bashdb.sourceforge.net/ruby-debug.html)

*原来的答案已被修改，因为到 datanoise 文章的链接，唉，不再有效。还添加了 ruby​​-debug 的继任者*

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-08-28T03:10:28.153

从命令行（如果您有`debug`可用的模块）：

```
ruby -r debug /path/to/ruby_script.rb 
```

# msbuild - msbuild 中动态生成的 C# 文件的问题

> ID：259428
> 
> 赞同：0
> 
> 时间：2008-11-03T18:00:31.103
> 
> 标签：msbuild, .net-2.0, c#-2.0

我有一个源 XML 文件，用于创建 C# 文件，然后将其编译为项目的一部分。
目前我有一个 BeforeBuild 目标，它运行我的 XML 到 C# 转换器。
问题是，在运行 BeforeBuild 步骤时，旧文件似乎已被构建系统存储，因此新文件被忽略了。

我怎样才能解决这个问题？似乎转换将是一种方式，但它们的功能有限。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-05-18T20:22:14.117

我猜您的“由构建系统存储”可以翻译为包含您希望编译的 .cs 文件的 ItemGroup 是在读取 msbuild 文件时生成的，而不是在执行编译目标时生成的。你有几个选择：

1.  `<CreateItem>`请参阅[CreateItem 任务](http://msdn.microsoft.com/en-us/library/s2y3e43x.aspx)
2.  `<Output>`见[输出元素](http://msdn.microsoft.com/en-us/library/ms164287.aspx)

我希望这有帮助。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2008-11-03T18:11:38.897

好吧，我们这里有类似的东西。我们使用 .tt 从 xml 文件中生成 .cs。这两个文件都是特定 csproj 的一部分。在 csproj 上执行 properties->BuildEvents 在 Pre-build event 命令行中给出了这个小片段：

```
del "$(ProjectDir)MyCsFile.cs"
copy /b /y "$(ProjectDir)\MyXmlFile.xml" "$(TargetDir)"
"$(ProjectDir)tt.bat" "$(ProjectDir)MyTemplateFile.tt" 
```

不知道这对您是否有用，我希望它可能足以作为最后的解决方法。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2008-11-03T20:37:43.843

我认为您需要向我们展示一些您的规则/构建文件。您应该有一个以 xml 作为依赖项的 cs 文件的规则/依赖项。

我不确定“由构建系统存储”是什么意思

仔细检查您的规则是否有错误/遗漏。

# richtextbox - 如何向网站添加富文本编辑支持？

> ID：259429
> 
> 赞同：2
> 
> 时间：2008-11-03T18:01:29.713
> 
> 标签：richtextbox, richedit, richtextediting

我需要一些带有富文本编辑的基本 CMS 功能。在堆栈溢出时，有一个常规的 textarea 编辑控件，支持 Markdown 样式语法格式。这超出了我的用户的范围，所以我想要一个可以在网站上输入的富编辑控件之类的东西。我知道这是可能的，因为很多网站都这样做，但我不知道从哪里开始。

* * *

## 回答 #1

> 赞同：8
> 
> 时间：2008-11-03T18:02:29.710

[TinyMCE](http://tinymce.moxiecode.com/)可能是此类事物中较受欢迎的版本之一。您可以根据您希望为观众提供的功能对其进行自定义以满足您的需求。一些替代方案（往往比完整的 TinyMCE 安装更轻）：

*   [FCK编辑器](http://www.fckeditor.net/)
*   [新哈](http://trac.xinha.org/)

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2008-11-03T18:04:33.250

[fckeditor](http://www.fckeditor.net/)非常强大且可配置。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2008-11-04T09:55:28.523

雅虎的[YUI 富文本编辑器](http://developer.yahoo.com/yui/editor/)现已结束测试版，并被证明在浏览器中得到很好的支持。

# php - 带有 JSON 数据的 jqGrid 将表呈现为空

> ID：259435
> 
> 赞同：13
> 
> 时间：2008-11-03T18:02:19.947
> 
> 标签：php, javascript, jquery, json, jqgrid

我正在尝试创建一个 jqgrid，但表是空的。表格呈现，但数据不显示。

我从 php 调用中得到的数据是：

```
{
"page":"1",
"total":1,
"records":"10",
"rows":[
{"id":"2:1","cell":["1","image","Chief Scout","Highest Award test","0"]},
{"id":"2:2","cell":["2","image","Link Badge","When you are invested as a Scout, you may be eligible to receive a Link Badge. (See page 45)","0"]},
{"id":"2:3","cell":["3","image","Pioneer Scout","Upon completion of requirements, the youth is invested as a Pioneer Scout","0"]},
{"id":"2:4","cell":["4","image","Voyageur Scout Award","Voyageur Scout Award is the right after Pioneer Scout.","0"]},
{"id":"2:5","cell":["5","image","Voyageur Citizenship","Learning about and caring for your community.","0"]},
{"id":"2:6","cell":["6","image","Fish and Wildlife","Demonstrate your knowledge and involvement in fish and wildlife management.","0"]},
{"id":"2:7","cell":["7","image","Photography","To recognize photography knowledge and skills","0"]},
{"id":"2:8","cell":["8","image","Recycling","Demonstrate your knowledge and involvement in Recycling","0"]},
{"id":"2:10","cell":["10","image","Voyageur Leadership ","Show leadership ability","0"]},
{"id":"2:11","cell":["11","image","World Conservation","World Conservation Badge","0"]}
]} 
```

javascript 配置如下所示：

```
$("#"+tableId).jqGrid ({
    url:'getAwards.php?id='+classId,
    dataType : 'json',
    mtype:'POST',
    colNames:['Id','Badge','Name','Description',''],
    colModel : [
        {name:'awardId', width:30, sortable:true, align:'center'},
        {name:'badge', width:40, sortable:false, align:'center'},
        {name:'name', width:180, sortable:true, align:'left'},
        {name:'description', width:380, sortable:true, align:'left'},
        {name:'selected', width:0, sortable:false, align:'center'}
        ],
    sortname: "awardId",
    sortorder: "asc",
    pager: $('#'+tableId+'_pager'),
    rowNum:15,
    rowList:[15,30,50],
    caption: 'Awards',
    viewrecords:true,
    imgpath: 'scripts/jqGrid/themes/green/images',
    jsonReader : { 
        root: "rows", 
        page: "page", 
        total: "total", 
        records: "records", 
        repeatitems: true, 
        cell: "cell", 
        id: "id",
        userdata: "userdata", 
        subgrid: {root:"rows", repeatitems: true, cell:"cell" } 
    },
    width: 700,
    height: 200
}); 
```

HTML 看起来像：

```
<table class="awardsList" id="awardsList2" class="scroll" name="awardsList" />
<div id="awardsList2_pager" class="scroll"></div> 
```

我不确定我是否需要定义 jsonReader，因为我试图保持默认值。如果 php 代码有帮助，我也可以发布它。

* * *

## 回答 #1

> 赞同：20
> 
> 时间：2008-11-03T21:40:51.970

我让它工作了！

dataType**字段**应该是**datatype**。它区分大小写。

* * *

## 回答 #2

> 赞同：5
> 
> 时间：2010-06-07T09:41:15.570

当您在*grid.locale-en.js*之前包含脚本*jquery.jqGrid.min.js*时，也会出现此问题。如果控制器的方法调用有任何问题，请检查此项。

 ** * *

## 回答 #3

> 赞同：3
> 
> 时间：2010-09-15T05:24:14.127

从 jqGrid 3.6 迁移到 jqGrid 3.7.2 时，我遇到了同样的问题。问题是我的 JSON 没有正确双引号（按照 JSON 规范的要求）。jqGrid 3.6 容忍了我的无效 JSON，但 jqGrid 3.7 更严格。

参考这里：[http ://simonwillison.net/2006/Oct/11/json/](http://simonwillison.net/2006/Oct/11/json/)

**无效**：

```
{
page:"1",
total:1,
records:"10",
rows:[
    {"id":"2:1","cell":["1","image","Chief Scout","Highest Award test","0"]},
    {"id":"2:2","cell":["2","image","Link Badge","When you are invested as a Scout, you may be eligible to receive a Link Badge. (See page 45)","0"]},
    {"id":"2:3","cell":["3","image","Pioneer Scout","Upon completion of requirements, the youth is invested as a Pioneer Scout","0"]}
]} 
```

**有效**：

```
{
"page":"1",
"total":1,
"records":"10",
"rows":[
    {"id":"2:1","cell":["1","image","Chief Scout","Highest Award test","0"]},
    {"id":"2:2","cell":["2","image","Link Badge","When you are invested as a Scout, you may be eligible to receive a Link Badge. (See page 45)","0"]},
    {"id":"2:3","cell":["3","image","Pioneer Scout","Upon completion of requirements, the youth is invested as a Pioneer Scout","0"]}
]} 
```

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2010-04-14T16:37:21.430

我也让它工作：数据类型是正确的拼写 - 它在示例中以这种方式显示，但它与库中的其他*所有*内容不一致，因此很容易出错

我已经厌倦了追逐这个稀疏的文档，我真的觉得在 JavaScript 中使用它是正确和适当的 JSON 确实被简短地介绍了支持 XML。通过 JSON 将 Python 和 JavaScript 结合在一起是一个非常强大的组合，但是对于这个特定的库来说，它是一个持续不断的斗争。

任何有替代方案的人：

1> 正确支持 jQuery UI 主题（包括圆角！）（[http://datatables.net](http://datatables.net)对主题有更好的支持）

2> 允许调整列的大小（[http://datatables.net](http://datatables.net)不支持此功能）

3> 允许子网格（[http://datatables.net](http://datatables.net)让你在这里做任何你想做的事，通过一个事件）

请告诉我。我在界面的这一部分上花费的时间比在整个其余部分上的总和还要多，而且我一直花在寻找工作示例和“尝试一些东西”上，这变得越来越烦人。

小号

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2011-02-18T05:12:58.550

这可能是一个较旧的帖子，但我会发布我的成功只是为了帮助他人。

您的 JSON 需要采用以下格式：

```
{
"rows": [
    {
        "id": 1,
        "cell": [
            1,
           "lname",
            "fname",
            "mi",
            phone,
            "cell1",
            "cell2",
            "address",
            "email"
        ]
    },
    {
        "id": 2,
        "cell": [
            2,
            "lname",
            "fname",
            "mi",
            phone,
            "cell1",
            "cell2",
            "address",
            "email"
        ]
    }
] 
```

}

我在 Zend 中编写了这个模型，所以如果你愿意，可以使用它。随心所欲地操纵它。

```
public function fetchall ($sid, $sord)
{
    $select = $this->getDbTable()->select(Zend_Db_Table::SELECT_WITH_FROM_PART);
    $select->setIntegrityCheck(false)
           ->join('Subdiv', 'Subdiv.SID = Contacts.SID', array("RepLastName" => "LastName", 
                                                                "Subdivision" => "Subdivision",
                                                                "RepFirstName" => "FirstName"))
           ->order($sid . " ". $sord);

    $resultset = $this->getDbTable()->fetchAll($select);
    $i=0;
    foreach ($resultset as $row) {
        $entry  = new Application_Model_Contacts();

        $entry->setId($row->id);
        $entry->setLastName($row->LastName);
        $entry->setFirstName1($row->FirstName1);
        $entry->setFirstName2($row->FirstName2);
        $entry->setHomePhone($row->HomePhone);
        $entry->setCell1($row->Cell1);
        $entry->setCell2($row->Cell2);
        $entry->setAddress($row->Address);
        $entry->setSubdivision($row->Subdivision);
        $entry->setRepName($row->RepFirstName . " " . $row->RepLastName);
        $entry->setEmail1($row->Email1); 
        $entry->setEmail2($row->Email2);

        $response['rows'][$i]['id'] = $entry->getId(); //id
        $response['rows'][$i]['cell'] = array (
                                                $entry->getId(),
                                                $entry->getLastName(),
                                                $entry->getFirstName1(),
                                                $entry->getFirstName2(),
                                                $entry->getHomePhone(),
                                                $entry->getCell1(),
                                                $entry->getCell2(),
                                                $entry->getAddress(),
                                                $entry->getSubdivision(),
                                                $entry->getRepName(),
                                                $entry->getEmail1(),
                                                $entry->getEmail2()
                                            );
        $i++;

    }
    return $response;
} 
```

* * *

## 回答 #6

> 赞同：1
> 
> 时间：2011-11-30T12:17:30.727

伙计们只是想在这方面帮助你。我得到了以下工作：

**JSON**

```
var mydata1 = { "page": "1", "total": 1, "records": "4","rows": [{ "id": 1, "cell": ["1", "cell11", "values1" ] },
    { "id": 2, "cell": ["2", "cell21", "values1"] },
    { "id": 3, "cell": ["3", "cell21", "values1"] },
    { "id": 4, "cell": ["4", "cell21", "values1"] }
]}; 
```

**//在重要行下方标记。数据类型“jsonstring”对我有用，而不是“json”。**

```
datatype: "jsonstring",

contentType: "application/json; charset=utf-8",

datastr: mydata1,

colNames: ['Id1', 'Name1', 'Values1'],

colModel: [
      { name: 'id1', index: 'id1', width: 55 },
      { name: 'name1', index: 'name1', width: 80, align: 'right', sorttype: 'string' },
      { name: 'values1', index: 'values1', width: 80, align: 'right', sorttype: 'string'}], 
```

问候，

* * *

## 回答 #7

> 赞同：1
> 
> 时间：2012-01-03T22:59:34.233

就我而言，问题是由以下 PHP 代码行引起的（取自 jqGrid 演示）：

```
$responce->page = $page; 
```

这里的问题是：我正在访问对象的属性页而`$responce`没有先创建它。这导致 Apache 显示以下错误消息：

```
Strict Standards: Creating default object from empty value in /home/mariusz/public_html/rezerwacja/apps/frontend/modules/service/actions/actions.class.php on line 35 
```

最后，错误消息用于在脚本中发送到 json 阅读器。

我通过创建空对象解决了这个问题：

```
$responce = new stdClass(); 
```

* * *

## 回答 #8

> 赞同：0
> 
> 时间：2009-04-02T20:54:09.663

我不认为你的 ID 是正确的类型，我认为它应该是一个 int。

对于给定的 json，你真的不需要 jsonreader 设置。无论如何，您列出的都是默认值，而且您的 json 中没有子网格。

试试这个：

```
{
"page":"1",
"total":1,
"records":"10",
"rows":[
{"id":1 ,"cell":["1","image","Chief Scout","Highest Award test","0"]},
{"id":2,"cell":["2","image","Link Badge","When you are invested as a Scout, you maybe eligible to receive a Link Badge. (See page 45)","0"]},
{"id":3,"cell":["3","image","Pioneer Scout","Upon completion of requirements, the youth is invested as a Pioneer Scout","0"]},
{"id":4,"cell":["4","image","Voyageur Scout Award","Voyageur Scout Award is the right after Pioneer Scout.","0"]},
{"id":5,"cell":["5","image","Voyageur Citizenship","Learning about and caring for your community.","0"]},
{"id":6,"cell":["6","image","Fish and Wildlife","Demonstrate your knowledge and involvement in fish and wildlife management.","0"]},
{"id":7,"cell":["7","image","Photography","To recognize photography knowledge and skills","0"]},
{"id":8,"cell":["8","image","Recycling","Demonstrate your knowledge and involvement in Recycling","0"]},
{"id":9,"cell":["10","image","Voyageur Leadership ","Show leadership ability","0"]},
{"id":10,"cell":["11","image","World Conservation","World Conservation Badge","0"]}
]} 
```

* * *

## 回答 #9

> 赞同：0
> 
> 时间：2013-12-08T22:43:38.187

我正在使用 WAMP 2.4，我对这个问题很着迷，我尝试了很多东西，比如安装以前版本的 PHP 和 5.2，我在 Windows XP 中尝试过，还有很多 jqGrid 选项。最后感谢 Oleg 和 Mariusz，我找到了唯一的一行：

```
$responce = new stdClass(); 
```

在使用 $responce 可以解决所有问题之前，现在我的网格可以正常工作了！

谢谢我的朋友。

# windows - 当队列本身为空时，为什么 MSMQ 的存储已满？

> ID：259447
> 
> 赞同：2
> 
> 时间：2008-11-03T18:06:16.707
> 
> 标签：windows, windows-server-2003, msmq

我的一个 QA 服务器有一段时间没有给我任何错误，因为它们无法写入队列，所以开始给我的应用程序错误。MSMQ 特地抛出了一条消息，说“资源不足，无法执行操作”。

对队列本身的检查表明它们是空的，每个都有零消息。

检查限制表明我们将它们限制为每个 1GB 的存储空间。

检查存储发生的目录说是的，那里有 1GB 的文件，因此没有更多资源是有道理的。

但是，队列本身是空的。为什么它不清除旧文件？我在这里缺少什么设置？我认为他们会在重新启动时清空自己，但这也没有解决它。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2008-11-03T18:19:40.567

您是否在队列**上启用了日记功能**，如果是，您也限制它们的大小？它位于队列的“常规”选项卡的底部。这些不会在重新启动时被删除。如果您有大量队列，则日志的默认 1 mb 限制可能会吸引您。

# python - 如何从输入音频流中提取频率信息（使用 PortAudio）？

> ID：259451
> 
> 赞同：2
> 
> 时间：2008-11-03T18:07:45.473
> 
> 标签：python, voice, frequency, portaudio

我想使用PortAudio（PyAudio）录制声音（语音）并在屏幕上输出相应的声波。像我一样绝望，我无法从音频流中提取频率信息，以便我可以以赫兹/时间的形式绘制它。

* * *

这是一个示例代码片段，它记录和播放录制的音频五秒钟，以防它有帮助：

```
p = pyaudio.PyAudio()

chunk = 1024
seconds = 5

stream = p.open(format=pyaudio.paInt16,
                channels=1,
                rate=44100,
                input=True,
                output=True)

for i in range(0, 44100 / chunk * seconds):
    data = stream.read(chunk)
    stream.write(data, chunk) 
```

我希望从上述变量“数据”中提取所需的信息。（或者使用 PortAudio 或其他带有 Python 绑定的库的其他高级方法。）

* * *

我将非常感谢任何帮助！即使是模糊相关的音频分析智慧的花絮也受到赞赏。:)

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2008-11-03T18:31:46.533

您想要的可能是音频数据的傅立叶变换。有几个软件包可以为您计算。`scipy`并且`numpy`是其中两个。它通常被命名为“快速傅立叶变换”（FFT），但这只是算法的名称。

这是它的用法示例：[https ://svn.enthought.com/enthought/browser/Chaco/trunk/examples/advanced/spectrum.py](https://svn.enthought.com/enthought/browser/Chaco/trunk/examples/advanced/spectrum.py)

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-02-20T11:52:06.677

如果您希望在频域和时域中进行分析，傅立叶变换对您的帮助不大。您可能想看看“小波变换”。有一个包叫 pywavelets... [http://www.pybytes.com/pywavelets/#discrete-wavelet-transform-dwt](http://www.pybytes.com/pywavelets/#discrete-wavelet-transform-dwt)

# html - 有问题和 width</h1> <div id="body"><p>In the following code, both the INPUT and TEXTAREA elements render wider than they should. How can I limit them to 100% of the usable area within the div?</p> <pre

> ID：259455
> 
> 赞同：9
> 
> 时间：2008-11-03T18:09:49.447
> 
> 标签：html, css

* * *

## 回答 #1

> 赞同：13
> 
> 时间：2010-07-22T13:24:40.477

我有同样的问题。我使用了这里提到的 box-sizing 属性：

[当 CSS 中存在填充时，如何使 TextArea 的宽度为 100% 而不会溢出？](https://stackoverflow.com/questions/271067/how-can-i-make-a-textarea-100-width-without-overflowing-when-padding-is-present#answer-2515439)

这对我来说是这样的：

```
<style>
   .mywidth{ 
     width:100%;
     -moz-box-sizing: border-box;
     -ms-box-sizing: border-box;
     -webkit-box-sizing: border-box;
     box-sizing: border-box;
    } 
</style> 
```

* * *

## 回答 #2

> 赞同：7
> 
> 时间：2008-11-03T18:19:15.683

默认情况下，输入和文本区域都有边框

```
<style>
   .mywidth{ 
     width:100%;
     border:0;
    } 
</style> 
```

将渲染容器中的所有元素。

**更新**

IE 在每个元素上也有左右填充，以下 css 适合 FF3、FF2、Safari 3、IE6 和 IE7 中容器内的所有元素。

```
<style>
   .mywidth{ width:100%; border:0; padding-left:0; padding-right:0; }
</style> 
```

但是，不要忘记您可能需要一个边框，也许还需要填充，以使这些字段在用户看来是正常的。如果您自己设置该边框和填充，那么您将知道跨浏览器的容器宽度与您需要赋予 input/textarea 元素的宽度之间的区别是什么。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2008-11-03T18:23:40.403

@Phil 上面有答案。

顺便说一句，使用[Firebug](http://getfirebug.com/)确实会在 textarea 和 input 元素上显示默认边框。因此，使用 Firebug 可能会有所帮助。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2008-11-03T18:17:48.947

您可以尝试改用此 DOCTYPE

```
<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01//EN" "http://www.w3.org/TR/html4/strict.dtd"> 
```

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2008-11-03T18:23:08.420

添加“padding-right:3px;” 到 div 所以它读为：

```
<div style="border: 3px solid green;padding-right:3px; width: 100px;"> 
```

因为您已经为 div 添加了一个边框，该边框也算作 div 的内部空间。

它在没有 doc 声明的情况下工作的原因是浏览器不会将页面呈现为过渡 XHTML，而是普通的旧 html，它对 div 等具有不同的呈现方法。

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2009-07-18T15:03:20.307

xhtml 严格的代码似乎用表单来做到这一点。我只是让输入和文本区域拉伸到 99%，这似乎有效。试试看。

# php - 如何在 Zend Framework 的不同模块中使用相同的模型？

> ID：259456
> 
> 赞同：8
> 
> 时间：2008-11-03T18:09:57.887
> 
> 标签：php, model-view-controller, zend-framework, module

我正在一个现有项目中实施 Zend 框架，该项目有一个公共营销区域、一个私人成员区域、一个管理站点和一个营销活动管理站点。目前，这些都组织得很差，营销区域的控制器脚本和成员区域都位于站点的根目录下，然后是一个单独的文件夹用于管理员，另一个文件夹用于营销活动站点。

在实现 Zend 框架时，我想创建能够将控制器和视图拆分为模块（一个用于成员区域，一个用于公共营销区域，一个用于管理站点，一个用于营销活动管理站点）但我需要能够将每个模块指向同一个模型，因为所有三个组件都在同一个数据库和同一个业务对象上工作。

但是，我无法在文档中找到有关如何执行此操作的任何信息。任何人都可以提供有关如何执行此操作的链接或有关如何完成此操作的一些简单说明的帮助吗？

* * *

## 回答 #1

> 赞同：9
> 
> 时间：2008-11-03T18:22:00.327

我所做的是将公共类保存在模块层次结构之外的“库”目录中。然后设置我`INCLUDE_PATH`使用相应模块的“models”目录，加上公共的“library”目录。

```
docroot/
    index.php
application/
    library/    <-- common classes go here
    default/
        controllers/
        models/
        views/
    members/
        controllers/
        models/
        views/
    admin/
        controllers/
        models/
        views/
. . . 
```

在我的引导脚本中，我会`application/library/`在`INCLUDE_PATH`. 然后在每个控制器的`init()`函数中，我将该模块的“ `models/`”目录添加到`INCLUDE_PATH`.

**编辑：** 函数喜欢`setControllerDirectory()`并且`setModuleDirectory()`不将各自的模型目录添加到`INCLUDE_PATH`. 在任何情况下，您都必须自己执行此操作。这是如何做到这一点的一个例子：

```
$app = APPLICATION_HOME; // you should define this in your bootstrap
$d = DIRECTORY_SEPARATOR;
$module = $this->_request->getModuleName(); // available after routing
set_include_path(
  join(PATH_SEPARATOR,
    array(
      "$app{$d}library",
      "$app{$d}$module{$d}models",
      get_include_path()
    )
  )
); 
```

您可以在引导程序中将“ `library`”添加到您的路径中，但您不能在`models`引导程序中为正确的模块添加“”目录，因为该模块依赖于路由。有些人在`init()`他们的控制器的方法中这样做，有些人为 ActionController 的 preDispatch 钩子编写一个插件来设置`INCLUDE_PATH`.

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2008-11-16T04:14:39.013

这也可以通过遵循的命名约定来完成`Zend_Loader`。将模型文件保存在模块文件夹下的模型文件夹中。将它们命名为`Module_Models_ModelName`并将它们保存在该模块的模型文件夹中的文件名 ModelName.php 中。确保应用程序文件夹在您的包含路径中，并假设您正在使用`Zend_Loader`自动加载，然后您可以通过它们的类名引用模型。

这样做的好处是可以将您的模型代码与它所针对的实际模块组合在一起。这使模块包含在单个文件夹结构中，这有助于鼓励封装。如果您需要将模块移植到另一个项目，这也将在未来有所帮助。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2009-06-02T23:19:09.667

我刚刚为您描述的问题构建了这个自定义操作助手：

```
<?php

class My_Controller_Action_Helper_GetModel extends Zend_Controller_Action_Helper_Abstract
{
  /**
   * @var Zend_Loader_PluginLoader
   */
  protected $_loader;

  /**
   * Initialize plugin loader for models
   * 
   * @return void
   */
  public function __construct()
  {
    // Get all models across all modules
    $front = Zend_Controller_Front::getInstance();
    $curModule = $front->getRequest()->getModuleName();

    // Get all module names, move default and current module to
    //  back of the list so their models get precedence
    $modules = array_diff(
      array_keys($front->getDispatcher()->getControllerDirectory()),
      array('default', $curModule)
    );
    $modules[] = 'default';
    if ($curModule != 'default') {
      $modules[] = $curModule;
    }

    // Generate namespaces and paths for plugin loader
    $pluginPaths = array();
    foreach($modules as $module) {
      $pluginPaths[ucwords($module)] = $front->getModuleDirectory($module) . '/models';
    }

    // Load paths
    $this->_loader = new Zend_Loader_PluginLoader($pluginPaths);
  }

  /**
   * Load a model class and return an object instance
   * 
   * @param  string $model 
   * @return object
   */
  public function getModel($model)
  {
    $class = $this->_loader->load($model);
    return new $class;
  }

  /**
   * Proxy to getModel()
   * 
   * @param  string $model 
   * @return object
   */
  public function direct($model)
  {
    return $this->getModel($model);
  }
} 
```

所以在你的 Bootstrap.php 中：

```
Zend_Controller_Action_HelperBroker::addPrefix('My_Controller_Action_Helper'); 
```

在您的任何控制器中：

```
<?php

class IndexController extends Zend_Controller_Action 
{
  public function indexAction() 
  {
    $model = $this->_helper->getModel('SomeModel');
  }
} 
```

这将允许您跨所有模块访问任何控制器中的模型。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2009-05-20T22:45:43.230

我有同样的问题。比尔的回答不适合我——因为我倾向于划分我的模块，不是按“谁在看它们”，而是按“他们做了什么”。例如，“论坛模块”可能由管理员和公众共同管理。我正在尝试使用前端模块，例如 admin、members、public - 但这些模块随后会使用其他模块，例如“forum/validatepost”、“forum/show users personal info”。如果有人能阐明他们如何保护后端模块不受公众的影响，那将很方便。我猜 ACL 可能是关键，但它仍然让我紧张由对象控制访问，而不是“文件系统/.htaccess”等。

回答 PHPoet 的问题：（i）模块控制器目录的路径可以通过调用前端控制器来指定：例如，参见：“12.11.2\. 指定模块控制器目录”（Zend Framework Docs）

(ii) 可以使用 ViewRenderer (Controller Action Helper) 设置视图的路径，例如：'Example 12.12\. 选择不同的视图脚本'（Zend Framework Docs）

通过尝试改变视图和控制器的默认路径，从而释放自动加载器以正常运行。

（我没有研究过自动加载器的工作方式，但是拥有一些映射器系统来解决这类问题是有意义的。）

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2013-10-03T05:42:29.517

```
<?php
return array(
'modules' => array(
    'Application',
    'DoctrineModule',
    'DoctrineORMModule',
    'Merchant',
),
'module_listener_options' => array(
    'config_glob_paths'    => array(
        'config/autoload/{,*.}{global,local}.php',
    ),
    'module_paths' => array(
        './module',
        '../vendor',
//            'here we can load module'
        'comomonmodule'   

    ),
),
); 
```

# php - PHP array_intersect() - 它如何处理不同的类型？

> ID：259457
> 
> 赞同：1
> 
> 时间：2008-11-03T18:11:14.843
> 
> 标签：php, arrays, casting, types, array-intersect

如果我有一个值数组，这些值基本上是各种数字的零填充字符串表示形式和另一个整数数组，`array_intersect()`仍然会匹配不同类型的元素吗？

例如，这是否可行：

```
$arrayOne = array('0003', '0004', '0005');
$arrayTwo = array(4, 5, 6);

$intersect = array_intersect($arrayOne, $arrayTwo);

// $intersect would then be = "array(4, 5)" 
```

如果没有，实现这一目标的最有效方法是什么？只是循环并比较，或者循环并将所有内容转换为整数然后运行`array_intersect()`？

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2008-11-03T18:14:24.553

从[http://it2.php.net/manual/en/function.array-intersect.php](http://it2.php.net/manual/en/function.array-intersect.php)：

> ```
> Note:  Two elements are considered equal if and only if
> (string) $elem1 === (string) $elem2.
> In words: when the string representation is the same. 
> ```

在您的示例中， $intersect 将是一个空数组，因为 5 !== "005" 和 4 !== "004"

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2008-11-03T18:13:49.877

$ 猫 > 测试.php

```
<?php
$arrayOne = array('0003', '0004', '0005');
$arrayTwo = array(4, 5, 6);

$intersect = array_intersect($arrayOne, $arrayTwo);

print_r($intersect );

?> 
```

$ php 测试.php

大批 （ ）

$

所以不，它不会。但是如果你添加

```
foreach($arrayOne as $key => $value)
{
   $arrayOne[$key] = intval($value);
} 
```

你会得到

$ php 测试.php

数组（ [1] => 4 [2] => 5 ）

# php - 将对象从应用服务器序列化到 Web 服务器而不重复代码的方法

> ID：259461
> 
> 赞同：1
> 
> 时间：2008-11-03T18:11:49.707
> 
> 标签：php, serialization

我有一个 web-app-database 3 层服务器设置。Web 向 app 请求数据，app 从 db 中获取数据，然后处理并返回给 Web 显示。标准。

目前，我从应用程序到 Web 序列化的所有数据都被放入自定义定义的数据结构中，然后 Web 端解析以供显示。换句话说，假设我有一个要检索并发送到网络的订单。我不会序列化整个对象，而是在应用服务器上使用适当的数据元素构建一个数组，然后将该数组序列化到 Web 服务器。

现在，我正在研究将整个订单对象序列化到 Web 服务器。

你们发现在保持应用服务器和网络服务器代码分离的同时序列化对象的最佳方法是什么？我不希望我的网络服务器有任何访问数据库的代码，但我希望他们尽可能重用封装我的订单和其他数据的类。

为了进一步完善我的问题（感谢 Glenn 的回答），我不希望我的网络服务器也有任何业务逻辑，比如订单类，只有应用服务器需要知道。这些对象已经使用单独的序列化到/从数据库，以及到/从网络服务器。

使用订单示例，在应用服务器上，订单应该能够取消：即

$订单->取消（）；

但在网络服务器上，甚至不应该找到该方法。它不应该简单地（直接）代理回应用服务器订单的取消方法，因为用户操作请求应该流经应用程序的授权和权限检查层。

那么如何在我的网络服务器上获得一个订单对象，该对象在我的应用服务器上具有该对象的一些（但不是全部）方法和属性，几乎没有代码重复。我一直在考虑的一件事是创建一个具有一组有限属性和方法的基类。它将使用一个内部类来保存它的属性，并且我需要所有数据访问来传入和传出 getter 和 setter。这些将依次调用内部类的 getter 和 setter。

然后，Web 和应用服务器可以独立扩展基类，并使用自定义内部类来保存属性。然后在应用程序端，例如，内部类可以是一个 ORM 类扩展，可以将数据持久化到 DB，而在 Web 端，内部类可以是一个简单的属性持有者类。

但是整个内部类的东西似乎有点笨拙，所以我仍在寻找更好的解决方案。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2008-11-03T18:49:56.543

*   [使用适配器模式](http://en.wikipedia.org/wiki/Adapter_pattern)将特定格式的序列化代码分解为单独的类。您的问题域类变得中立。
*   在应用层上使用关系数据库特定的适配器类来序列化与数据层之间的对象。
*   在 Web 层上使用 HTML 特定的适配器类来序列化与 Web 浏览器之间的对象。
*   在 Web 层和应用层上使用 XML（或任何您认为最合适的有线协议友好格式）特定的适配器类来序列化 Web 层和应用层之间的对象。
*   如果您足够聪明地弄清楚如何使这些适配器类足够通用，以至于您不需要每个问题域类的一组不同的适配器类，您将获得加分。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2008-11-03T21:03:12.343

如果我正确理解您的问题，您想序列化对象的数据，但是当它们重新水合时，它们应该变成不同类型的对象（具有有限和/或不同的功能）？

You can do this in different ways, depending on what protocol you prefer. For example, you could use SOAP. You should then hydrate the objects into a different class on the client-side, than on the server-side. You could also use PHP's native [serialization](http://docs.php.net/manual/en/function.serialize.php) and either a) Have a different code base on the client (Could get confusing) or b) mock a bit around with the serialized string (Eg. replace the class-name). [A crude example](http://docs.php.net/manual/en/function.serialize.php#79226) can be found in the comments for the PHP manual.

# objective-c - 无法在 UILabel 上设置文本字段

> ID：259471
> 
> 赞同：3
> 
> 时间：2008-11-03T18:15:08.360
> 
> 标签：objective-c, cocoa-touch, uilabel

我创建了`UITableCellView`一个名为`NoteCell`. 标头定义以下内容：

```
#import <UIKit/UIKit.h>
#import "Note.h"

@interface NoteCell : UITableViewCell {
    Note *note;
    UILabel *noteTextLabel;  
}

@property (nonatomic, retain) UILabel *noteTextLabel;

- (Note *)note;
- (void)setNote:(Note *)newNote; 

@end 
```

在实现中，我对该`setNote:`方法有以下代码：

```
- (void)setNote:(Note *)newNote {
    note = newNote;
    NSLog(@"Text Value of Note = %@", newNote.noteText);
    self.noteTextLabel.text = newNote.noteText;
    NSLog(@"Text Value of Note Text Label = %@", self.noteTextLabel.text);
    [self setNeedsDisplay];
} 
```

这无法设置的文本字段`UILabel`和日志消息的输出是：

```
2008-11-03 18:09:05.611 VisualNotes[5959:20b] Text Value of Note = Test Note 1  
2008-11-03 18:09:05.619 VisualNotes[5959:20b] Text Value of Note Text Label = (null) 
```

我还尝试设置`UILabel`使用以下语法的文本字段：

```
[self.noteTextLabel setText:newNote.noteText]; 
```

这似乎没有什么不同。

任何帮助将非常感激。

* * *

## 回答 #1

> 赞同：10
> 
> 时间：2008-11-03T18:27:42.407

你有没有在任何地方设置你的noteTextLabel？在我看来，您正在向 nil 对象发送消息。创建单元格时，noteTextLabel 为 nil。如果您从未设置它，那么您基本上是在执行以下操作：

```
[nil setText: newNote.noteText]; 
```

当您稍后尝试访问它时，您正在这样做：

```
[nil text]; 
```

这将返回零。

在您的`-initWithFrame:reuseIdentifier:`方法中，您需要显式创建 noteTextLabel，并将其作为子视图添加到单元格的内容视图中：

```
self.noteTextLabel = [[[UILabel alloc] initWithFrame: CGRectMake(0, 0, 200, 20)] autorelease];
[self.contentView addSubview: self.noteTextLabel]; 
```

那么这应该工作。

此外，作为文体说明，我会将`property`for noteTextLabel 设为只读，因为您只想从课堂外访问它，而不要设置它。

# unit-testing - 软件测试真的应该成为学术层面的一流概念吗？

> ID：259478
> 
> 赞同：6
> 
> 时间：2008-11-03T18:17:19.823
> 
> 标签：unit-testing

软件测试真的在学术层面得到重视吗？

我相信提供软件工程（甚至可能是计算机科学）的大学需要将**软件测试**本身视为一门单独的课程和主题，而不是软件工程一般主题的一部分。无论使用何种测试方法和技术，这都是软件专业人员生活中的一部分，就像编写代码一样。

我不确定这是否在大多数大学中发生——它仍然被视为次要的。当一个应届毕业生从大学毕业时，他只关心编程和创造事物，而不是如何测试它们。

软件测试真的应该成为学术层面的一流概念（或至少被视为一个概念）吗？

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2008-11-03T18:22:41.713

是的，可能应该给予更多考虑，在某些地方确实如此。作为大学新课程的一部分，我参加的所有编程项目都必须包含测试用例。没有办法强制执行特定的方法，例如 TDD，但我认为这是朝着正确方向迈出的一步。

甚至还有一些可用的工具，比如[Web-CAT](http://portal.acm.org/citation.cfm?id=1384371)，可以自动评估测试覆盖率。学生提交他们的代码和他们的测试，系统会告诉他们他们在一组教师接受的测试中的得分情况。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2008-11-03T18:21:58.797

是的，一点没错。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2008-11-03T18:22:34.430

在我的大学里，它被赋予了与软件需求和软件开发同等的理论覆盖面。所有 3 人都有 SE 必修课和 CS 选修课的第三级课程。尽管许多课程需要编程，但大多数课程实际上并不是*关于*编程的。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2009-01-20T06:03:40.383

我认为应该在学术层面教授单元测试，而不是一般的测试。软件测试人员不必担心与开发人员相同级别的技术细节，这意味着更广泛的理解可能就足够了。

# c# - 在 C# 中使用可为空的类型

> ID：259480
> 
> 赞同：9
> 
> 时间：2008-11-03T18:19:07.400
> 
> 标签：c#, nullable

我只是对人们的意见感兴趣。在 C# 中使用可为空的类型时，测试 null 的最佳实践方法是什么：

```
bool isNull = (i == null); 
```

或者

```
bool isNull = !i.HasValue; 
```

此外，当分配给非空类型时：

```
long? i = 1;
long j = (long)i; 
```

优于：

```
long? i = 1;
long j = i.Value; 
```

* * *

## 回答 #1

> 赞同：15
> 
> 时间：2008-11-03T18:23:49.403

我会用这个：

```
long? i = 1;
...some code...
long j = i ?? 0; 
```

这意味着，如果*i*为**null**，则将分配比 0 。

* * *

## 回答 #2

> 赞同：12
> 
> 时间：2008-11-03T19:09:58.093

使用 C# 团队专门为您实现的表单。如果有人反对，告诉他们安德斯说没关系。

我想说的是，为了给你一个良好的编程体验，很多工作都在将可空类型集成到 c# 中。

请注意，在性能方面，两种形式都编译为相同的 IL，即：

```
int? i = 1;
bool isINull = i == null;
int j = (int)i; 
```

在 C# 编译器处理完之后会这样结束：

```
int? i = 1;
bool isINull = !i.HasValue;
int j = i.Value; 
```

* * *

## 回答 #3

> 赞同：8
> 
> 时间：2008-11-03T18:22:07.410

我总是使用 (i==null) 形式。它表达了你在做什么。

WRT第二个问题，我认为任何一种形式都可以。但是，我总是先检查它是否为 null 并采取适当的措施——也许将检查和操作包装在一个辅助方法中（通常它只是设置一个默认值）。

* * *

## 回答 #4

> 赞同：4
> 
> 时间：2008-11-03T18:25:35.077

在实践中我没有使用过 Nullable Types，但是对于第二个，我实际上建议使用 j.GetValueOrDefault()。文档表明后者实际上会在出现空值时抛出 InvalidOperationException。根据显式转换运算符的内部实现 long? ，前者也可能。我会坚持使用 GetValueOrDefault 并适当地处理 null/default 情况。

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2008-11-03T19:46:41.123

我倾向于在两者上都使用第一个，因为它需要在其生命周期的后期得到支持，这些似乎更容易理解原作者的意图。

* * *

## 回答 #6

> 赞同：1
> 
> 时间：2008-11-03T20:08:51.390

打开反射器。HasValue 是对值更改时设置的布尔标志的查找。因此，就周期而言，查找会比比较更快。

```
public Nullable(T value)
{
    this.value = value;
    this.hasValue = true;
}

private bool hasValue;

internal T value;

public bool HasValue
{
    get
    {
        return this.hasValue;
    }
} 
```

* * *

## 回答 #7

> 赞同：0
> 
> 时间：2008-11-03T18:22:47.893

它们都是相同的，但我会在两者上使用前一个版本，因为它在语言中更常见：与 null 比较并强制转换为类型。

* * *

## 回答 #8

> 赞同：0
> 
> 时间：2008-11-03T18:23:15.690

在这两种情况下，我通常倾向于倾向于第一个选项，因为它更“原始”面向而不是面向对象（这确实是我们想要的），但这真的没那么重要

# .net - WCF 生命周期事件

> ID：259482
> 
> 赞同：5
> 
> 时间：2008-11-03T18:19:19.257
> 
> 标签：.net, wcf

WCF 服务启动或关闭时是否会触发事件？希望独立于它是自托管还是托管在 IIS 中？

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2008-11-03T20:50:57.000

ServiceHost 暴露了很多事件：

[http://msdn.microsoft.com/en-us/library/system.servicemodel.servicehost_events.aspx](http://msdn.microsoft.com/en-us/library/system.servicemodel.servicehost_events.aspx)

您可以通过使用自定义服务行为来挂钩这些事件：

[http://msdn.microsoft.com/en-us/library/system.servicemodel.description.iservicebehavior.aspx](http://msdn.microsoft.com/en-us/library/system.servicemodel.description.iservicebehavior.aspx)

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2008-11-03T20:00:07.167

当然，您的对象的构造函数（尤其是如果您使用的是单例样式）。请原谅无耻的自我推销，但我已经写了两篇关于如何开始使用 WCF (Net.Tcp) 客户端/服务器系统的文章... 第一篇是非 IIS（服务根据您自己的条件启动） )，后者是如何修改第一个托管在 IIS 中的，我的第一个句子适用：

1)[使用 WCF 进行客户端服务器编程](http://www.singingeels.com/Articles/Client_Server_Programming_with_WCF.aspx)

2)[使用 Net.Tcp 在 IIS 中托管的双工 WCF 服务](http://www.singingeels.com/Articles/Duplex_WCF_Services_Hosted_in_IIS_Using_NetTcp.aspx)

# c# - 是否可以在 ASPX、C# 和 JavaScript 之间共享一个带有字符串的文件？

> ID：259484
> 
> 赞同：2
> 
> 时间：2008-11-03T18:20:09.503
> 
> 标签：c#, asp.net, javascript

我想将项目中使用的所有字符串外部化到一个文件中，并能够在 JavaScript 中的 aspx、C# 代码后面和客户端使用它。
我想这样做的原因是因为许多字符串是共享的，即在两个地方相同。

是否可以？有没有更好的办法？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2008-11-03T18:46:00.357

[JSON](http://www.json.org/)非常适合 - 一个类似的问题：[How do you share configuration information or business rules between languages](https://stackoverflow.com/questions/239832/how-do-you-share-configuration-information-or-business-rules-between-languages)

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2008-11-03T18:49:11.863

一位回答者建议使用 XML，但这对于交付给客户来说将是非常重要的。

考虑做一些类似于 JavaScript 的缩小过程。获取您在服务器/C# 端使用的字符串，并使用 Perl/Python/Ruby 之类的东西处理您的 JavaScript 文件，用字符串本身替换字符串的 id。

所以，如果你的 javascript 说：

```
alert($MY_TEXT$) 
```

它变成了

```
alert("The string associated with $MY_TEXT$") 
```

Perl/Python/Ruby 过程发生在 JavaScript 文件的“构建”中，然后部署到生产服务器。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2008-11-03T18:32:31.443

听起来就像是在 XML 的小巷里......

# sql-server-2005 - 如何查询与其约束不匹配的外键？

> ID：259486
> 
> 赞同：6
> 
> 时间：2008-11-03T18:21:21.343
> 
> 标签：sql-server-2005, tsql, foreign-keys, foreign-key-relationship

SQL 服务器 2005。

我正在将外键约束添加到据称不需要它们的应用程序的数据库中。自然地，数据变得不可靠，并且外键字段中存在孤立条目。

设置：
两个表，TableUser 和 TableOrder。TableUser 具有主键“UserID”，TableOrder 具有外键“UserID”。

如何找到 TableOrder.UserID 在 TableUser.UserID 中没有匹配条目的行？

例如，TableOrder.UserID 的值为 250，但没有与 250 匹配的 TableUser.UserID 键。

* * *

## 回答 #1

> 赞同：10
> 
> 时间：2008-11-03T18:23:35.643

这是一种方法：

```
select * from TableOrder where UserID not in (select UserID from TableUser); 
```

有许多不同的方法来编写这种查询。

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2008-11-03T18:59:51.313

另一种常见的方法是左外连接：

```
SELECT * FROM TableOrder o
LEFT OUTER JOIN TableUser u ON o.UserID = u.UserID
WHERE u.UserID is NULL 
```

此查询在没有 where 子句的情况下也很有用，可以浏览并查看相应的值（如果它们存在），并查看哪些值不匹配。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2008-11-04T14:13:25.727

表中一开始就没有 FK 约束。它们像 FK 和 PK 一样使用，但没有编码——相信它们是不必要的开销。所以我们有所有的列，但没有编码约束。当我去把它们放进去执行它们时，我发现有很多违规行为。

你的问题突出了问题。它们不是不必要的开销，它们可以防止人们对一般数据库进行破坏。

格雷格和布拉德的回答都帮助了我。

# python - Google App Engine 上的信用卡付款和通知

> ID：259491
> 
> 赞同：13
> 
> 时间：2008-11-03T18:22:17.923
> 
> 标签：python, google-app-engine, web2py

我将 gchecky 移植到了谷歌应用引擎。你可以[在这里试试](http://web2py.appspot.com/plugin_checkout)

它同时实现了 1 级（购物车提交）和 2 级（来自 google 结帐的通知）。

是否有任何其他付款选项适用于谷歌应用引擎（例如贝宝）并支持 2 级（通知）？

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2010-09-02T15:03:41.737

我认为您可以从 PayPal 的 X 平台 [http://code.google.com/p/paypalx-gae-toolkit/查看官方工具包](http://code.google.com/p/paypalx-gae-toolkit/)

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2009-01-10T18:17:17.593

Paypal 有一个[SOAP 接口](https://cms.paypal.com/us/cgi-bin/?cmd=_render-content&content_ID=developer/e_howto_api_soap_PayPalSOAPAPIArchitecture)。您当然可以从 GAE 中访问它——尽管在等待响应时您可能会遇到超时问题。

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2009-07-16T09:09:14.643

这是一个[链接](http://blog.awarelabs.com/2008/paypal-ipn-python-code/)，其中包含有关使用 Django 从 AppEngine 使用 PayPal IPN 的信息。

# c# - 如何避免在两个相似的 WinForms 上重复逻辑？

> ID：259508
> 
> 赞同：4
> 
> 时间：2008-11-03T18:25:15.280
> 
> 标签：c#, .net, coding-style

我有两种表格，表格A和表格B。这些表格在外观上肯定不同，但它们共享很多逻辑。问题在于此逻辑与外观相关（验证按钮单击、触发事件等）。例如，我有一个名称字段，当按下保存按钮时，我需要触发一个事件，该事件导致父表单验证记录名称以避免重复。两种形式都需要这个逻辑，但是它们的保存按钮在不同的地方，并且发生错误时显示的工具提示也需要出现在不同的地方。这只是一个例子，但有人知道我可以避免在这里复制和粘贴代码的方法吗？也许我错过了一些明显的东西......

* * *

## 回答 #1

> 赞同：12
> 
> 时间：2008-11-03T18:27:45.277

您可以使用以两种形式表示的数据创建一个对象，并将验证逻辑放入该对象中。表示层应该使用输入的数据填充该对象，要求对象验证自身，然后以特定于表单的方式处理验证错误。

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2008-11-03T18:30:03.570

如果通用逻辑与 UI 相关，则需要使用所需的逻辑创建自己的自定义表单类（继承自 Form 类）。那么您需要做的就是在您的表单中继承该类。

如果公共逻辑与 UI 相关性较低，请创建一个封装公共逻辑的内部类并从两种表单中调用它。

* * *

## 回答 #3

> 赞同：3
> 
> 时间：2008-11-03T18:30:03.820

您需要在 2 个视图和共享模型之间添加一个控制器。这样你只需要这样做： myController.save(); 而是必须调用您的模型对象以将它们保存在两个 winform 中。

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2008-11-03T18:35:53.123

我能想到的重构这些表单以共享逻辑的方法很少。您可以结合使用其中的一种或多种：

1.  创建 UI 特定的“bean”对象来包装您的业务对象并添加在表单之间共享的附加功能。这个 bean 可以做一些事情，比如创建工具提示、协助验证、事件等。
2.  创建一个具有常用功能的辅助类。概括这两种形式的逻辑，调用这个帮助类来实现常用功能。
3.  增强您的业务对象以进行验证。我并不是说您的 BO 应该了解任何 UI，但他们可以/应该执行业务规则。这可能会将一些验证逻辑从您的表单中拉出并放到一个公共位置。
4.  创建特定于您正在使用的数据类型的自定义控件，并在两个表单上使用这些控件。

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2008-11-04T00:09:20.533

您可能还想看看[CSLA 框架](http://www.lhotka.net/cslanet/)，我在过去的项目中非常成功地使用它来帮助减少不同 UI 之间重复代码的数量。它利用了 .NET 的数据绑定功能，但我认为不必为了充分利用框架而使用数据绑定。

# c# - 使用 LINQ to SQL 时出现问题，每个原子操作都有一个 DataContext

> ID：259524
> 
> 赞同：2
> 
> 时间：2008-11-03T18:32:18.810
> 
> 标签：c#, linq-to-sql, persistence, ddd-repositories

我已经开始在一个（有点像 DDD 的）系统中使用 Linq to SQL，它看起来（过于简化）如下所示：

```
public class SomeEntity // Imagine this is a fully mapped linq2sql class.
{
    public Guid SomeEntityId { get; set; }
    public AnotherEntity Relation { get; set; }
}

public class AnotherEntity // Imagine this is a fully mapped linq2sql class.
{
    public Guid AnotherEntityId { get; set; }
}

public interface IRepository<TId, TEntity>
{
    Entity Get(TId id);
}

public class SomeEntityRepository : IRepository<Guid, SomeEntity>
{
    public SomeEntity Get(Guid id)
    {
        SomeEntity someEntity = null;
        using (DataContext context = new DataContext())
        {
            someEntity = (
                from e in context.SomeEntity
                where e.SomeEntityId == id
                select e).SingleOrDefault<SomeEntity>();
        }

        return someEntity;
    }
} 
```

现在，我遇到了一个问题。当我尝试像这样使用 SomeEntityRepository

```
public static class Program
{
    public static void Main(string[] args)
    {
        IRepository<Guid, SomeEntity> someEntityRepository = new SomeEntityRepository();
        SomeEntity someEntity = someEntityRepository.Get(new Guid("98011F24-6A3D-4f42-8567-4BEF07117F59"));
        Console.WriteLine(someEntity.SomeEntityId);
        Console.WriteLine(someEntity.Relation.AnotherEntityId);
    }
 } 
```

一切正常，直到程序到达最后一个 WriteLine，因为它抛出一个`ObjectDisposedException`，因为 DataContext 不再存在。

我确实看到了实际问题，但是我该如何解决呢？我想有几种解决方案，但迄今为止我所想到的没有一个适合我的情况。

*   摆脱存储库模式，并为工作的每个原子部分使用新的 DataContext。
    *   我真的不想这样做。一个原因是我不想让应用程序知道存储库。另一个是我不认为让 linq2sql 的东西 COM 可见会很好。
    *   另外，我认为这样做`context.SubmitChanges()`可能会比我预期的要多得多。
*   指定 DataLoadOptions 以获取相关元素。
    *   因为我希望我的业务逻辑层在某些情况下只回复一些实体，所以我不知道他们需要使用哪些子属性。
*   禁用所有属性的延迟加载/延迟加载。
    *   不是一个选择，因为有很多表，而且它们的链接很紧密。这可能会导致大量不必要的流量和数据库负载。
*   互联网上的一些帖子说使用 .Single() 应该会有所帮助。
    *   显然它不...

有什么办法可以解决这个痛苦吗？

顺便说一句：我们决定使用 Linq t0 SQL，因为它是一个相对轻量级的 ORM 解决方案，并且包含在 .NET 框架和 Visual Studio 中。如果 .NET 实体框架更适合这种模式，则可以选择切换到它。（我们在实施方面还没有那么远。）

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2008-11-03T19:10:09.887

Rick Strahl 在这里有一篇关于 DataContext 生命周期管理的好文章：[http](http://www.west-wind.com/weblog/posts/246222.aspx) ://www.west-wind.com/weblog/posts/246222.aspx 。

基本上，原子操作方法在理论上很好，但您需要保留 DataContext 以便能够跟踪数据对象中的更改（并获取子对象）。

另请参阅： Linq to SQL DataContext和LINQ to SQL[的多个/单个实例](https://stackoverflow.com/questions/226127/multiplesingle-instance-of-linq-to-sql-datacontext)[- 您的 DataContext 位于何处？](https://stackoverflow.com/questions/196253/linq-to-sql-where-does-your-datacontext-live).

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2008-11-03T19:53:16.070

您必须：

1) 让上下文保持打开状态，因为您还没有完全决定将使用哪些数据（也称为延迟加载）。

或 2) 如果您知道需要其他属性，则在初始加载时提取更多数据。

后者的解释：[这里](http://www.singingeels.com/Blogs/Nullable/2008/10/27/EntityFramework_Include_Equivalent_in_LINQ_to_SQL.aspx)

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2008-11-03T20:09:43.340

如果您使用原子工作单元，我不确定您是否必须放弃存储库。我同时使用这两种方法，尽管我承认放弃了乐观并发检查，因为它们无论如何都不能分层工作（不使用时间戳或其他一些必需的约定）。我最终得到的是一个使用 DataContext 并在完成后将其丢弃的存储库。

这是一个不相关的 Silverlight 示例的一部分，但前三部分显示了我如何使用带有一次性 LINQ to SQL 上下文的存储库模式，FWIW：[http ://www.dimebrain.com/2008/09/linq-wcf -silver.html](http://www.dimebrain.com/2008/09/linq-wcf-silver.html)

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2008-11-03T18:49:28.900

> 指定 DataLoadOptions 以获取相关元素。因为我希望我的业务逻辑层在某些情况下只回复一些实体，所以我不知道他们需要使用哪些子属性。

如果调用者被授予使用 .Relation 属性所需的耦合，那么调用者也可以指定 DataLoadOptions。

```
DataLoadOptions loadOptions = new DataLoadOptions();
loadOptions.LoadWith<Entity>(e => e.Relation);
SomeEntity someEntity = someEntityRepository
  .Get(new Guid("98011F24-6A3D-4f42-8567-4BEF07117F59"),
  loadOptions); 
```

//

```
using (DataContext context = new DataContext())
{
  context.LoadOptions = loadOptions; 
```

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2009-09-03T23:28:18.503

这就是我所做的，到目前为止它工作得非常好。

1) 使 DataContext 成为存储库中的成员变量。是的，这意味着您的存储库现在应该实现 IDisposable 并且不要保持打开状态......也许您想避免必须做的事情，但我没有发现它不方便。

2）像这样向您的存储库添加一些方法：

```
public SomeEntityRepository WithSomethingElseTheCallerMightNeed()
{
 dlo.LoadWith<SomeEntity>(se => se.RelatedEntities);
 return this; //so you can do method chaining
} 
```

然后，你的调用者看起来像这样：

```
SomeEntity someEntity = someEntityRepository.WithSomethingElseTheCallerMightNeed().Get(new Guid("98011F24-6A3D-4f42-8567-4BEF07117F59")); 
```

您只需要确保当您的存储库访问数据库时，它会使用这些辅助方法中指定的数据加载选项......在我的情况下，“dlo”被保留为成员变量，然后在访问数据库之前进行设置。

# ruby-on-rails - 如何找到模型的关系？

> ID：259529
> 
> 赞同：24
> 
> 时间：2008-11-03T18:33:41.520
> 
> 标签：ruby-on-rails, ruby, activerecord

我想在给定特定模型时返回与之关联的所有相关模型。例如：

```
class Dog < ActiveRecord::Base
  has_many :bones
  belongs_to :master
end

d = Dog.first
d.associations #<== should return [Bone, Master] 
```

有没有办法做到这一点而不必自己动手？如果做不到这一点，有什么建议最好的方法吗？

* * *

## 回答 #1

> 赞同：41
> 
> 时间：2008-11-03T18:38:18.610

```
Dog.reflect_on_all_associations 
```

[http://api.rubyonrails.org/classes/ActiveRecord/Reflection/ClassMethods.html#M001405](http://api.rubyonrails.org/classes/ActiveRecord/Reflection/ClassMethods.html#M001405)

您不会在实例上执行此操作，而是在模型本身上执行此操作。

# .net - 第二次查看时 IDataReader 清空

> ID：259532
> 
> 赞同：2
> 
> 时间：2008-11-03T18:36:55.837
> 
> 标签：.net, mysql-connector

尝试使用 MySql .net 连接器读取一些数据时，我遇到了一些非常奇怪的事情。这是代码：

```
IDataReader reader = null;

using (MySqlConnection connection = new MySqlConnection(this.ConnectionString))
{
    String getSearch = "select * from organization";
    MySqlCommand cmd = new MySqlCommand(getSearch, connection);
    cmd.CommandType = CommandType.Text;

    connection.Open();
    reader = cmd.ExecuteReader();

    while (reader.Read())
    {
        // response write some stuff to the screen (snipped for brevity)
    }
} 
```

如果我在 ExecuteReader 之后放置一个断点并在 Visual Studio 中展开结果视图（将鼠标悬停在阅读器上并展开），我可以看到查询返回的行。如果我然后让它关闭并再次展开结果视图，我会收到消息“枚举未产生结果”。

似乎阅读器的内容在被查看后立即被重置。

至于我们所尝试
的： - SQL 直接在 DB 上运行良好
- 将查询结果直接绑定到数据网格只返回一个空的数据网格
- 获得最新版本的 .net 连接器
- 在两台不同的机器上尝试排除任何本地错误

到目前为止，没有任何工作。

如果有人能提供任何想法或建议，他们将不胜感激。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2008-11-03T18:45:46.440

据我了解，SqlDataReader 旨在用于一次性枚举您返回的数据。一旦您对结果进行了一次循环，该对象就完成了它的职责。以下是解决此问题的一些想法，其中一个或另一个可以根据您的需要为您解决这个问题：

1.  需要时重新执行查询以生成另一个 SqlDataReader

2.  不要使用 SqlDataReader，而是将原始查询的结果存储到 System.Data.DataTable 中，然后您可以根据需要重新读取和操作数据。

希望这可以帮助！

亚当

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2008-11-03T18:43:07.897

由于数据读取器读取信息，因此您的 using 块在将其值分配给变量后立即关闭与读取器的连接。 [这是一篇文章](http://www.simple-talk.com/dotnet/.net-framework/should-you-use-ado.net-datareader-or-dataset/)，向您展示了一些代码示例，这些示例可能会让您到达您需要的地方。

关键是连接必须打开，当尝试从阅读器读取时。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2008-11-03T19:06:28.350

这是解释：

这是因为，您已经在调试器中循环了一次阅读器（第一次展开视图时）。这是阅读器的工作方式，据我所知，除了重新执行选项外，没有办法重置阅读器以从头开始再次阅读：

> 您只需再次运行该 `cmd.ExecuteReader();`行（通过右键单击源并使用“设置下一条语句”菜单选项）。

这是数据读取器的行为。如果您已经循环通过它，则无法返回。您必须再次执行该命令并检索一个新命令。

如果您需要在关闭阅读器后使用您的数据，您可以选择使用 a`Typed DataSet`或Adam's [answer](https://stackoverflow.com/questions/259532/idatareader-empties-when-viewing-for-a-second-time#259556)`DataSet`中指定的 untyped 。

顺便说一句，这里有一些`optimizations`你可以做的：

*   将阅读器移动到 `Connection`using 块内，使其在完成使用后超出范围（一旦您离开 using 块，连接将被关闭，您将无法使用它，所以它不会感觉把它放在外面）
*   `ExecuteReader`在另一个`using`块中运行（因为它实现`IDisposable`）并使用 Sql 做同样的事情`Command`（相同的`IDisposable`接口）
*   不要从数据库中检索所有字段

# asp.net - 使用登录控件登录到应用程序后重定向到 default.aspx 而不是“xxx.aspx”

> ID：259534
> 
> 赞同：3
> 
> 时间：2008-11-03T18:37:36.100
> 
> 标签：asp.net, security, redirect

谢谢你回答我的问题。我有以下几页。

*   登录.aspx
*   默认.aspx
*   xxx.aspx

登录应用程序后将显示 default.aspx。现在，如果用户试图通过直接在浏览器中指定其 URL 来打开[http:](http://server/) **//server/xxx.aspx** ?Id=1234，则会显示登录屏幕，成功登录后，系统会重定向到“default.aspx”而不是到“ [http:](http://server/) **//server/xxx.aspx** ?Id=1234”。实际上有一个外部应用程序会这样调用我的系统。所以请让我知道为什么会这样。.Net 登录控件用于登录应用程序。请帮我解决这个问题。

谢谢，
安文

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2008-11-03T18:55:25.017

您是使用表单身份验证还是直接在应用程序中执行此操作？如果您在 web.config 中执行此类操作，它将为您处理所有重定向。

```
<authentication mode="Forms">
            <forms name="FwLoginCookie" loginUrl="Login.aspx"
        protection="All" 
        path="/" >
            </forms>
        </authentication>
        <authorization>
            <deny users="?"/>
        </authorization> 
```

URL 中是否有任何内容说明 ReturnURL？使用上述设置，如果用户尝试访问 xxx.aspx，我希望登录对话框的 URL 看起来像“Login.aspx?ReturnUrl=xxx.aspx”

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2008-11-03T19:10:53.520

检查您没有在登录控件中设置 DestinationPageUrl 属性：

```
<asp:Login 
  ID="Login1" 
  runat="server" 
  DestinationPageUrl="~/Default.aspx">
</asp:Login> 
```

我假设您拥有此属性，因为此属性会覆盖您实际寻找的默认行为。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2008-11-03T18:40:35.530

```
Response.Redirect(Request.UrlReferrer.ToString()); 
```

# c# - __FUNCTION__ 宏的 C# 版本

> ID：259536
> 
> 赞同：17
> 
> 时间：2008-11-03T18:38:10.670
> 
> 标签：c#, .net, macros

有人对 C++ __FUNCTION__ 宏的 C# 版本有很好的解决方案吗？编译器似乎不喜欢它。

* * *

## 回答 #1

> 赞同：23
> 
> 时间：2008-11-03T18:41:58.837

尝试改用它。

```
System.Reflection.MethodBase.GetCurrentMethod().Name 
```

C# 没有`__LINE__`或没有`__FUNCTION__`像 C++ 这样的宏，但有等价物

* * *

## 回答 #2

> 赞同：8
> 
> 时间：2008-12-02T15:08:05.710

我目前使用的是这样的功能：

```
using System.Diagnostics;

public string __Function() {
    StackTrace stackTrace = new StackTrace();
    return stackTrace.GetFrame(1).GetMethod().Name;
} 
```

当我需要 __FUNCTION__ 时，我只需调用 __Function() 即可。例如：

```
Debug.Assert(false, __Function() + ": Unhandled option"); 
```

当然，这个解决方案也使用反射，但它是我能找到的最佳选择。因为我只将它用于调试（而不是在发布版本中跟踪），所以性能影响并不重要。

我想我应该做的是创建调试函数并用

```
[ Conditional("Debug") ] 
```

相反，但我还没有解决这个问题。

感谢 Jeff Mastry 对此的[解决方案](http://discuss.fogcreek.com/dotnetquestions/default.asp?cmd=show&ixPost=6163)。

* * *

## 回答 #3

> 赞同：6
> 
> 时间：2008-11-03T18:42:16.807

不幸的是，在 C# 中没有该宏的等效版本。我不认为 GetCurrentMethodName() 解决方案等同于 C++ __FUNCTION__ 宏。即因为 C++ 版本是名称的编译时计算。对于 C#，这是一个运行时计算，会导致性能下降。

我没有对成本的严重性做出任何假设，但有一个

* * *

## 回答 #4

> 赞同：5
> 
> 时间：2008-11-03T18:42:15.857

以下应该可以工作，尽管它将在运行时而不是在编译期间进行评估。

```
System.Reflection.MethodBase.GetCurrentMethod().Name 
```

* * *

## 回答 #5

> 赞同：3
> 
> 时间：2015-06-30T07:46:43.900

我用这个：

```
public static string CallerName([CallerMemberName] string callerName = "")
{
    return callerName;
} 
```

使用示例：

```
s_log.DebugFormat("{0}", CallerName()); 
```

使用它的缺点是每次要打印调用者姓名时，都需要跳转到函数 ==> 耗时 & 性能下降！因此，我将它用于调试目的，如果我还需要在生产代码中打印，我通常将函数名称内联到 log.Debug 中，例如：

```
s_log.Debug("CallerName"); 
```

HTH..

* * *

## 回答 #6

> 赞同：2
> 
> 时间：2015-09-02T00:19:59.007

这是在 .NET 4.5 中添加的。

在此处查看@roken 的答案：

[C# 中是否存在 __LINE__ __FILE__ 等价物？](https://stackoverflow.com/questions/696218/do-line-file-equivalents-exist-in-c)

# .net - 不适用于 IE7

> ID：259540
> 
> 赞同：0
> 
> 时间：2008-11-03T18:40:12.647
> 
> 标签：.net, asp.net, html, internet-explorer

似乎在 IE7 中忽略了以下 HTML，但在 IE6/FF 中可以正常工作。它应该覆盖要在所需框架中打开的所有 html 链接

```
<HEAD>   
 <title>LeftPane</title>   
 <base target="rightFrame">  
</HEAD> 
```

上面的代码是左框架的标题，其中包含不支持 TargetFrame 属性的 Infragistics UltraWebTree（树形菜单）。

是否有另一种方法可以将目标属性添加到所需页面上的所有链接元素。

任何服务器或客户端代码解决方法？

该站点建立在 ASP.Net 1.1 和 Infragistics V 2.0 之上

**更新** 网页是 aspx 一个 doctype 是

```
<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.0 Transitional//EN" > 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2008-11-03T18:43:12.407

基本标签上的`href=""`属性是[强制性的](http://www.w3schools.com/TAGS/tag_base.asp)- 这是一种可能的解释。你没有说你正在使用什么文档类型，但是[target 在严格的 XHTML 中是不允许的](http://www.devguru.com/Technologies/xhtml/quickref/xhtml_base.html)。

编辑：在没有href的情况下对其进行了测试，它工作正常……留下了doctype或其他东西。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-12-12T16:23:23.363

IE 不再允许文档`BASE`之外的标签。`HEAD`

该标准规定基本元素必须出现在`head`文档中，*在任何*引用外部源的元素之前。

因此，如果您将代码放在`</head>`它工作之后！

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2008-11-03T19:05:16.497

老实说，我知道这不是你要问的，但**请**不要使用框架。它们已经在摆脱 HTML/XHTML DTD 的过程中了，它们很丑陋并且会导致浏览器到浏览器的各种问题。

如果您正在寻找一个易于管理的模板系统，那么我建议您只使用简单的[PHP 包含](http://ca.php.net/include/)，这听起来可能令人生畏，但实际上非常简单。如果你有一个便宜的网络服务器 PHP 已经安装了。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2008-11-03T22:11:58.663

我不知道是什么问题，因为我在纯 HTML 中测试了基本目标并且它可以工作，想知道 ASP.net 是否必须对其进行处理。但这是一段 javascript 代码，它将目标属性添加到所有没有的链接元素

```
<script language="javascript">

    var tags=document.getElementsByTagName("a");
    for (i=0;i<tags.length;i++)
     { 
         if(!tags[i].getAttribute('target'))
             {
              tags[i].setAttribute('target',"right")
        }
     }

    </script> 
```

# ruby-on-rails - Apache 无法初始化乘客。连接到应用程序池时损坏的管道 (32)

> ID：259542
> 
> 赞同：0
> 
> 时间：2008-11-03T18:40:59.180
> 
> 标签：ruby-on-rails, passenger, phusion

我在 Centos 2.6.18-92.el5 #1 SMP 上的 Apache 2.2.3 上安装了 Phusion Passenger 2.0.3，我在 httpd 错误日志中得到以下信息

```
Cannot initialize Passenger in an Apache child process: Could not connect to the ApplicationPool server: Broken pipe (32) 
```

根据[文档](http://www.modrails.com/documentation/Users%20guide.html#conflicting_apache_modules)，我已经删除了与乘客冲突的模块。

想法？

最好的，

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2010-05-31T10:04:14.213

请查看以下教程以正确设置乘客： [部署到虚拟主机](http://www.modrails.com/documentation/Users%20guide%20Apache.html#_deploying_to_a_virtual_host_8217_s_root)

我对 Enterprise Ruby 和 Passenger 有同样的问题

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2010-06-21T01:00:58.697

我有同样的问题。问题是因为意外安装了本机软件包（在我的情况下为 debian）以及 gem。因此，由于某种原因，它导致了冲突。我删除了软件包并重新启动了 Apache，它工作正常。希望有帮助。

# mysql - MySQL 如何存储枚举？

> ID：259547
> 
> 赞同：23
> 
> 时间：2008-11-03T18:43:04.560
> 
> 标签：mysql, enums, types

如果我有这样的表：

```
CREATE TABLE sizes (
    name ENUM('small', 'medium', 'large')
); 
```

MySQL 会在每一行中存储这些字符串，还是在内部使用更小的整数（如整数）来知道要引用哪个枚举值？

我想在表格中使用枚举，但我担心它是否像在每一行中存储一个字符串一样浪费。

* * *

## 回答 #1

> 赞同：32
> 
> 时间：2008-11-03T18:47:06.097

它在 INSERT / UPDATE 上将它们转换为整数，然后在 SELECT 上转换回字符串，因此内部存储是整数，但您不会接触到它。

您可以检索整数，如`SELECT mycolumn + 0`.

请参阅[MySQL 5 中的 ENUM](http://dev.mysql.com/doc/refman/5.0/en/enum.html)

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2008-11-03T18:49:07.463

[如此处](http://dev.mysql.com/doc/refman/5.0/en/enum.html)所述，枚举存储为与枚举索引关联的 0（无有效值集）和 65,535 之间的值。存储在表中的值是 2 字节值，而不是字符串。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2008-11-03T18:48:07.700

首先，在决定是否使用枚举时，我不会担心空间消耗。磁盘空间既充足又便宜。

其次，它将字符串存储在列定义中，然后在每条记录中存储适当的枚举。根据[这一点](http://www.making-the-web.com/2008/03/24/saving-bytes-efficient-data-storage-mysql-part-1/)，与每条记录一起存储的值是枚举中值位置的数字表示。

# c# - 消除 Windows 窗体刷新工件

> ID：259552
> 
> 赞同：2
> 
> 时间：2008-11-03T18:44:58.457
> 
> 标签：c#, winforms

我们在使用 C# 和 .Net 2.0 的 Windows 窗体中有一个相当复杂的 GUI。我的问题是，每当我在 GUI 上拖动任何窗口时，都会在表单上留下伪影。我一辈子都想不出如何消除它。我试过启用双缓冲，但它只会有帮助，并不能消除问题。其他应用程序似乎没有这个问题，我想知道我们做错了什么。

**更新以响应答案**

大多数应用程序只是使用一组布置在面板上的第三方控件（Infragistics）。据我所知，除了基本（非 CPU 密集型）鼠标单击处理之外，GUI 线程中没有任何操作。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2008-11-03T19:11:45.173

您可能在 GUI 线程上做了太多工作。将一些工作卸载到后台线程将释放 GUI 以更快地处理 Windows 消息。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2008-11-03T20:24:46.540

与 Jon B 的回答相关，如果您的应用程序使用 .NET 中的 Graphics 对象进行大量绘图，则这些方法相对于 Windows API 调用相当慢。

另一种可能性是您的 GUI 可能不会在 OnPaint 事件中更新自身。有时，自定义图形代码通过计时器事件更新绘图表面，或者仅在需要显示的内容发生变化时更新绘图表面。像这样编写的代码在大多数情况下似乎都可以工作，但是当另一个窗口在您的窗口上移动时会产生您所描述的问题。

# networking - TCP是否可以通过多个连接实现更高的传输速率？

> ID：259553
> 
> 赞同：14
> 
> 时间：2008-11-03T18:45:18.330
> 
> 标签：networking, tcp

是否有可能在高延迟环境中通过多个并行 TCP 连接实现更好的数据传输速率（具有大地理距离的公共互联网，假设每个连接没有流量整形或类似的东西），还是 TCP 可以通过单个连接利用整个带宽？

* * *

如果接收方没有报告 0 窗口大小的缓冲区拥塞，TCP 是否会尽可能快地发送数据？因此，如果 RTT 是例如 60 秒，它根本不会影响速率吗？是否有一些最大窗口大小或其他限制速率的东西？

* * *

## 回答 #1

> 赞同：18
> 
> 时间：2008-11-03T21:00:58.587

多个并发连接*可能*给您带来的一个好处（受制于 dove 和 Brian 提到的相同警告）是您将能够更好地克服 TCP 接收窗口太小的问题。

这涉及的原理是[带宽延迟积](http://en.wikipedia.org/wiki/Bandwidth-delay_product)。[（这里](http://www.psc.edu/networking/projects/tcptune/)有更详细的解释）。

一个简短的总结：在高延迟、高带宽的环境中，可靠的通信（如 TCP）通常受到任何给定时间传输的数据量的限制。多个连接是解决此问题的一种方法，因为带宽延迟产品单独应用于每个连接。

更详细地考虑以下几点：您有 10^8 位每秒（10 兆位/秒）的端到端带宽，以及 100 毫秒（0.1 秒）的往返延迟。因此，在第一个数据位的确认返回给发送者之前，最多可以发送 10^7 位（10 兆位 = ~1.25 兆字节）的数据。

这取决于操作系统的 TCP 堆栈，但 TCP 接收窗口大小的一个不常见的值是 64Kbytes。这显然太小了，无法让您充分利用端到端带宽；一旦发送了 64kbytes (512kbits) 的数据，您的发送进程将等待来自接收器的窗口更新，表明已经消耗了一些数据，然后再将更多数据放到网络上。

打开多个 TCP 会话可以解决这个问题，因为每个 TCP 会话都有自己的发送/接收缓冲区。

当然，由于 TCP 窗口大小、争用等原因，在 Internet 上很难确定真正可用的端到端带宽。如果您能够提供一些示例数据，我们或许可以提供更多帮助。

您应该考虑的另一个选项是在创建套接字时设置更大的接收窗口，或者使用操作系统设置全局设置，或者使用套接字选项在每个套接字的基础上设置。

* * *

## 回答 #2

> 赞同：7
> 
> 时间：2008-11-03T19:02:48.590

如果您是链接上唯一的人，则会增加开销并降低速度。然而，当与其他人共享一个完全饱和的链接时，这是一种游戏系统并提高整体速度的方式（每个连接将比单个连接慢，但聚合会更快，因为您现在拥有更大比例的分配给您的“时隙”（技术术语是什么？现在我忘记了）。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2008-11-03T18:48:28.247

是的，但不一定容易实现。诸如 akamai 之类的 CDN 通过压缩比通常发送的更大的数据包来声称其部分性能，因为它们具有专用的可靠管道。在不了解您的应用程序的情况下很难提供更好的细节。

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2008-11-03T21:53:45.033

[Muz 对这个问题的描述是正确的](https://stackoverflow.com/questions/259553/tcp-is-it-possible-to-achieve-higher-transfer-rate-with-multiple-connections#259944)。

请记住，利用它可能取决于您的操作系统中 TCP 的实现。特别是，为了获得最佳结果，您需要一个支持[RFC 1323](http://www.ietf.org/rfc/rfc1323.txt)中的 Window Scale 选项的 TCP 堆栈。

此外，您可能需要调整一些操作系统设置才能使其正常工作。在 Windows 上，您可能需要调整一个名为[TcpWindowSize的注册表设置。](http://technet.microsoft.com/en-us/library/cc757802.aspx)有一个 Microsoft 知识库文章[224829：Windows 2000 和 Windows Server 2003 TCP 功能](http://support.microsoft.com/kb/224829)的描述，它描述了如何做到这一点。

# c++ - 在 Windows CE 5 中的可见应用程序之间切换，Lang: C++

> ID：259562
> 
> 赞同：1
> 
> 时间：2008-11-03T18:47:06.110
> 
> 标签：c++, embedded, windows-ce

我是嵌入式编程的老手，但对 CE 很陌生，在做相当简单的事情时遇到了很多麻烦，因为我不熟悉 API 并且难以理解晦涩难懂的 MSDN 文档。

我要做的就是最小化和最大化从其中一个应用程序运行的两个单独的应用程序。

例如，应用程序 A 决定现在是它出现的时候了，然后最小化应用程序 B（应用程序 B 是第三方应用程序，例如记事本，无法访问源代码等），然后在稍后阶段最大化 B 并最小化自身。

应用程序 A 将由我自己编写。

我敢肯定这一定很简单，但是在哪里可以找到答案.. :)

提前致谢。意向书

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2008-11-03T18:58:48.007

首先，您需要使用[FindWindow](http://msdn.microsoft.com/en-us/library/aa453070.aspx) API 函数或其他方法来定位窗口句柄 (hwnd)。接下来使用[ShowWindow](http://msdn.microsoft.com/en-us/library/aa453731.aspx) API 函数指定**SW_HIDE**或**SW_SHOW**来分别隐藏或显示窗口。请注意，Windows CE 5.0 在技术上不支持 Win32 窗口状态，如 SW_MINIMIZE、SW_MAXIMIZE 等。

一个简单的例子是：

```
HWND hWnd = ::FindWindow( _T("Notepad"), NULL); 
::ShowWindow(hWnd, SW_HIDE); 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2008-11-06T10:54:11.180

您可能还会发现 SetForegroundWindow 和 SetWindowPos 很有用。

这就是我使用它们来显示和隐藏应用程序的方式：

```
SetWindowPos(windowToHide, 0, 0, 0, 0, 0, SWP_HIDEWINDOW);
SetWindowPos(windowToShowInFullScreen, HWND_TOP, 0, 0, 240, 320, SWP_SHOWWINDOW);
SetForegroundWindow(windowToShow); 
```

# java - XmlBlaster 的优点和缺点

> ID：259563
> 
> 赞同：0
> 
> 时间：2008-11-03T18:47:37.403
> 
> 标签：java, xml, message-queue, messaging, xmlblaster

您是否正在使用 XmlBlaster？你怎么看待这件事？它的弱点和优势是什么？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2008-11-04T08:53:53.843

你有什么要求？在没有具体要求的情况下讨论中间件有点像比较苹果和橘子。

# c# - .NET 文本编辑器，接受 HTML 和带有拼写检查的输入/输出

> ID：259569
> 
> 赞同：7
> 
> 时间：2008-11-03T18:49:23.097
> 
> 标签：c#, .net, html, text-editor, spell-checking

我一直在寻找可以做到这一点的东西，但还没有运气……我们有一个内部应用程序，它以 HTML 格式存储/使用文本。现在我正在寻找一个新的控件来编辑它。

我**不需要**功能齐全的 HTML 编辑器，只需要可以处理简单格式的东西。它还需要拼写检查功能。一开始，我们使用嵌入了 Microsoft 的 DSO 成帧器控件的 Word。这导致了工作站上的 COM 问题和性能问题。最近我们一直在编辑模式下使用 IE。这解决了性能问题，但没有解决 COM 问题。

我想找到没有外部依赖的东西，或者至少那是所有托管代码。我不介意围绕richtextbox 构建我自己的控件，但我担心HTML-> RTF-> HTML 转换。由于我们必须处理传入的电子邮件，我们不能太自信地只使用 HTML 的子集。如果它符合我们的需求，我们也会考虑购买一个组件。我更喜欢轻量级的东西。我们不需要重新嵌入 Word！

有没有其他人遇到同样的问题？你是怎么解决的？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2008-11-03T21:10:04.090

以下是用于处理语法高亮的基于 .NET 的开源文本编辑器的几个选项

*   [SharpDevelop](http://www.icsharpcode.net/OpenSource/SD/Download/) C# IDE的 ICSharpCode.TextEditor 组件
*   [点网火球](http://www.codeplex.com/dotnetfireball)

为 HTML 设置这些应该相对容易，或者为 HTML 找到现有的语法定义。

我不太确定是否将拼写检查嵌入其中，但这篇文章可能很有趣：

[SpellCheck.net 使用 C# 进行拼写检查解析](http://www.codeproject.com/KB/recipes/spellcheckparser.aspx)

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2008-11-03T22:15:51.447

看看[XStandard](http://www.xstandard.com/ "X标准")。它是一个功能齐全的 XHTML 编辑器，但您可以根据自己的要求对其进行自定义。我在 Windows 和 Web 应用程序中都使用了它，效果很好，您可以获得 Lite（免费）版本或 Pro（合理的成本并允许完全自定义编辑器）。他们的技术支持也很好。我们遇到的唯一“问题”是它会生成有效/兼容的 XHTML，因此如果您要在其中导入非 XHTML 内容，则必须首先通过 HTMLTidy 或类似方法运行它。

哦，是的 - 它也包括一个拼写检查器。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2008-11-09T22:44:35.943

我刚刚遇到[Text Control](http://www.textcontrol.com/)。我不能说个人使用，但它看起来是纯 .net 中功能非常丰富的编辑器。似乎有广泛的格式支持，以及您需要的拼写检查。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2008-11-06T21:30:07.327

由于我太小气了，无法为我们的内部应用程序购买拼写检查控件（这完全是矫枉过正），我拼凑了一个 IExtenderProvider，它可以对文本框进行波浪形红线拼写检查。我已经坐在代码上一段时间了，但我只是[在博客上写了它](http://nicholas.piasecki.name/blog/2008/11/free-spell-checking-in-windows-forms)；那里有一个示例应用程序。

一些警告：

*   它会认为 HTML 拼写错误，但您可以修改它以使其适合您。
*   哎呀，它甚至认为数字拼写错误。一个简单的修复，但我一直懒得修复它。
*   如果字典丢失了，它就会彻底崩溃。

但是，希望它能给你一些想法，即使你不能直接使用它。

您可能会考虑的另一件事是，我知道一些 WPF 文本控件内置了拼写检查。但我不确定它们如何处理 HTML。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2008-11-06T21:00:44.047

我和你在同一条船上。

在 MSHTML com 控件周围使用托管包装器（不记得是哪一个，有几个，例如有这个[）](http://postxing.net:8080/PostXING/tags/v1.1/PostXING.HtmlComponent/Html/HtmlControl.cs)。据我了解，我们公司已经检查了一些此类控件，目前我们决定坚持使用 MSHTML。

我们还需要一个拼写检查器，我们正在使用[RapidSpell](http://www.keyoti.com/products/rapidspell/dotnet/)。但是有很多开源/免费的拼写检查器。

我们将纯文本从 MSHTML 中提取出来，并允许拼写检查器对其进行处理。hen 收集无效单词列表及其修复并将其注入 html 流。

这不是很多工作，大约一周时间将它们粘合在一起。

关于使用 RTF 控件，我们也研究了这种可能性，并决定不使用它，因为过去我们在 HTML > RTF > HTML 时遇到了很多痛苦。

MSHTML 控件相对于其他 3rd 方控件的一个优点是它支持从大多数应用程序复制和粘贴到控件中，您可以从 word 或其他格式的文本中复制，并且粘贴的文本将保留格式，有些东西大多数其他控件不支持此功能。

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2008-11-04T13:47:45.373

我用这个[HTML 文本框](http://www.codeplex.com/WinformHtmlTextbox)解决了它？它封装了 IE 并将其用于 HTML 编辑，就像您所做的一样。没有拼写检查器。

* * *

## 回答 #7

> 赞同：0
> 
> 时间：2009-11-27T18:36:08.840

> 我实际上正在寻找 .NET 2.0 winforms 控件

几年前我找了一个，没有找到。

所以，我开发了一个：见[http://www.modeltext.com/html/](http://www.modeltext.com/html/)

它是一个所见即所得的 XHTML 编辑器，用 C# 编写，带有 .Net-native（即非 COM）API。它支持一些（不是全部）CSS 属性，派生自 System.Windows.Forms.Control，并且依赖于 .Net 框架的第 2 版（仅依赖于其他）。

它不包括拼写检查器，但它的 API 允许您在 DOM 中行走和交互，因此您可以自己开发拼写检查器功能，如果需要的话。

* * *

## 回答 #8

> 赞同：0
> 
> 时间：2009-11-27T18:44:47.340

CKEditor（以前的 fckEditor）。包括厨房水槽在内的一切，但您可以配置工具栏，因此如果您只需要基本的 HTML 功能，您可以这样做。它有各种网络编程语言的示例，包括 ASP.NET，请参阅[http://ckeditor.com/demo](http://ckeditor.com/demo)。此外，它是开源的。

# java - 嵌入在 JPanel 中的 JFileChooser

> ID：259575
> 
> 赞同：8
> 
> 时间：2008-11-03T18:51:16.900
> 
> 标签：java, jpanel, jfilechooser, fileopendialog

我正在编写一个需要打开文件对话框的 java 程序。文件打开对话框并不难，我希望使用`JFileChooser`. 我的问题是我想要一个双窗格`JFrame`（由 2 组成`JPanels`）。左侧面板将有一个`JList`，右侧面板将有一个文件打开对话框。

当我使用`JFileChooser.showOpenDialog()`它时，会打开所有其他窗口上方的对话框，这不是我想要的。有没有办法让`JFileChooser`（或者可能是另一个文件选择对话框）显示在里面`JPanel`而不是在它上面弹出？

这是我尝试过的代码，此时它非常简化。我只是想让`JFileChooser`嵌入在`JPanel`这一点上。

```
public class JFC extends JFrame{
    public JFC()
    {
        setSize(800,600);

        JPanel panel= new JPanel();

        JFileChooser chooser = new JFileChooser();
        panel.add(chooser);

        setVisible(true);

        chooser.showOpenDialog(null);
    }

    public static void main(String[] args)
    {
        JFC blah = new JFC();
    }
} 
```

我也试过`chooser.showOpenDialog`用`this`and打电话`panel`，但无济于事。另外，我尝试将其`JFileChooser`直接添加到框架中。上面列出的两种尝试仍然`JFileChooser`在框架或面板前面弹出（取决于我添加`JFileChooser`到哪个）。

* * *

## 回答 #1

> 赞同：11
> 
> 时间：2008-11-03T18:58:57.273

JFileChooser 扩展了 JComponent 和 Component，因此您应该能够将它直接添加到您的框架中。

```
JFileChooser fc = ...
JPanel panel ...
panel.add(fc); 
```

* * *

## 回答 #2

> 赞同：5
> 
> 时间：2008-11-05T09:41:44.697

要访问文件选择器中的“按钮”，您必须向其中添加一个 ActionListener：

```
fileChooser.addActionListener(this);
[...]

public void actionPerformed(ActionEvent action)
{
    if (action.getActionCommand().equals("CancelSelection"))
    {
        System.out.printf("CancelSelection\n");
        this.setVisible(false);
        this.dispose();
    }
    if (action.getActionCommand().equals("ApproveSelection"))
    {
        System.out.printf("ApproveSelection\n");
        this.setVisible(false);
        this.dispose();
    }
} 
```

* * *

## 回答 #3

> 赞同：3
> 
> 时间：2008-11-03T19:18:00.870

如果您要即时添加 JFileChooser，则需要调用 revalidate()。

史蒂夫的回答是正确的。您可以将 JFileChooser 添加到其他容器。

* * *

## 回答 #4

> 赞同：2
> 
> 时间：2009-09-10T16:34:15.780

致约翰内斯：感谢您的有用片段。

而不是“ApproveSelection”和“CancelSelection”我使用定义的常量`JFileChooser.APPROVE_SELECTION`和`JFileChooser.CANCEL_SELECTION`

# c# - 如何将控件绑定到 DataGridView

> ID：259576
> 
> 赞同：3
> 
> 时间：2008-11-03T18:51:50.190
> 
> 标签：c#, winforms, data-binding

我是 .NET 的新手，所以请耐心等待我 ;)

在我的 Windows 窗体上，我有一个绑定到数据源的 DataGridView。由于我的网格是只读的，因此我在网格之外有一组控件（文本框、复选框等），用于编辑数据。

我希望控件绑定到网格中当前选定的行。目前，如果我将控件的 DataBindings 设置为与网格相同的数据源，即使我在网格中移动记录指针，也只会显示第一条记录。

我错过了什么？

环境：Windows 窗体、C#、Visual Studio 2008。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2008-11-03T19:04:19.913

要将其完全保留在 Visual Studio 的数据绑定环境中，您可以使用两个 BindingSource，一个用于 DataGridView，另一个用于细节控件。这与此处的示例非常相似：

[http://msdn.microsoft.com/en-us/library/y8c0cxey.aspx](http://msdn.microsoft.com/en-us/library/y8c0cxey.aspx)

But, instead of using a detail table you're using your own controls to show the details. These controls can still be databound to the 2nd BindingSource.

Alternatively, just handle the SelectionChanged event on your DataGridView and write code to manually update the values of your controls. This 2nd approach is a little more lightweight and will probably perform slightly better.

Hope this helps!

Adam

* * *

## 回答 #2

> 赞同：-1
> 
> 时间：2008-11-03T18:58:25.603

您想查看 datagridview 可用的自定义 datagridviewcolumn 类型。添加特殊列，然后将业务对象列表绑定到网格（或数据集）。

我认为您甚至可以要求网格根据您提供的对象自动生成合理的列。

我不建议尝试将普通控件填充到数据网格本身，有一个基于单元格、列和编辑控件的网格列框架来处理这些东西。根据这些词（例如 DataBinding/DataGridViewEditingControl）对 Google 进行一些搜索，恐怕我现在手头没有我的 DataGridView 资源。

* * *

哦，等等，对不起，我重新阅读了。您需要查看 BindingContext 对象。

# python - 使用多重继承将旧式类变成新式类是否安全？

> ID：259578
> 
> 赞同：7
> 
> 时间：2008-11-03T18:54:04.413
> 
> 标签：python, oop

在我正在编写的程序中，我想制作一个只读的 ConfigParser，以便可以安全地在全球范围内使用。我没有意识到这一点，但显然 SafeConfigParser 是一个老式类，因此我必须像这样子类化它：

```
class ConstParser(SafeConfigParser, object):
     """This is a implementation of the SafeConfigParser that can't
        write any values.  This is to ensure that it can only be filled
        once and won't get messy with multiple modules writing to it."""
    def __init__(self, files, defaults={}):
        super(ConstParser, self).__init__(defaults)
        self.read(files)
    def set(self, *args, **argd):
        raise NotImplementedError()
    def write(self, *args, **argd):
        raise NotImplementedError()
    def remove_option(self, *args, **argd):
        raise NotImplementedError()
    def remove_section(self, *args, **argd):
        raise NotImplementedError() 
```

如果我不使用 object 作为 mixin，那么对 SafeConfigParser 的`__init__`方法的调用将不起作用。现在，我确信有更好的方法来做我想做的事，但现在我很好奇：这一般可以吗？

我的意思是，我想不出任何理由为什么这会是一件坏事，但它仍然给我带来不好的感觉。他们是有道理的，还是我只是偏执？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2008-11-03T19:57:22.007

替换调用：

```
super(ConstParser, self).__init__(defaults) 
```

和：

```
SafeConfigParser.__init__(self, defaults) 
```

并且它在没有多重继承的情况下工作得很好。

# spring - spring beans 和 sessionFactory 在不同的 xml 文件中

> ID：259587
> 
> 赞同：0
> 
> 时间：2008-11-03T19:02:42.663
> 
> 标签：spring, configuration

我们有 3 个应用程序使用 3 个不同的 spring 配置文件。但是我们有一个数据库和一个数据源，所以有一个会话工厂。我们如何将会话工厂 bean 导入到 3 个不同的 spring 配置文件中？

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2008-11-03T20:13:26.093

在单个 XML 文件中配置您的 SessionFactory 并将此配置导入到任何需要它的应用程序的 Spring 上下文中。

如果您像这样使用基于类路径的导入：

```
<beans>
    <import resource="classpath:path/to/session-factory-beans.xml"/>
    <... other bean definitions.../>
</beans> 
```

那么你的分发机制就非常灵活了，因为类加载器会为你解析资源。你可以

*   将 session-factory-beans.xml 复制到每个需要它的项目中，或者
*   将其添加到 jarfile 并在应用程序之间共享，或者
*   如果应用程序都在同一个应用程序服务器中运行，则将其添加到 shared/classes 中。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2008-11-03T19:08:19.313

如果您使用 XML 配置：

将您的数据库设置放在名为“database-config.xml”的 Spring 配置中，并将其导入其他配置文件中。

```
<import resource="database-config.xml"/> 
```

至于如何在三个应用程序之间共享它更多的是配置管理问题。您可以使用 ant / maven 将其从存储库中检出并将其移动到正确的位置。

# asp.net - 页面浏览计数器 - 数据库设置和技术/策略

> ID：259589
> 
> 赞同：3
> 
> 时间：2008-11-03T19:03:37.497
> 
> 标签：asp.net, sql-server, database

我正在开发一个页面浏览计数器来跟踪页面在我们网站上的浏览量并将其显示给用户。（我之前问过一个介绍性问题：[Page View Counter like on StackOverFlow](https://stackoverflow.com/questions/246919/page-view-counter-like-on-stackoverflow)）。

使用这些建议，我开发了一个 httpHandler，它将在触发时处理请求：

```
<link rel="stylesheet" href="cn.axd?t=1&id=232" type="text/css" /> 
```

1.  只是想知道最终用户是否需要等待请求完成处理才能查看/与页面交互。

2.  更好的选择是实现一个异步队列，其中信息被记录到 MS 队列并最终通过（异常策略）记录到数据库中

3.  检查某个记录是否存在（PageID）并增加一个计数器或将记录插入数据库并稍后在需要时聚合会更慢吗？我们只需要在周末运行一次聚合，即可查看特定页面在一周内获得的总浏览量。

谢谢大家。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2008-11-04T14:24:29.387

在我以前的公司，我们还维护了一个页面查看计数器，随着点击次数的增加，数据库表也随之增加，这使网站瘫痪了。

无论您采用哪种方法，我都推荐以下方法：

1.  一直插入（它们比更新快）。
2.  将它们异步执行，这样它就不会阻塞主线程，也不会阻塞未来的请求。
3.  有一个夜间流程来汇总数据并清除第 1 点中的表格。
4.  根据汇总数据进行选择。

我们发现这是最有效和可扩展的解决方案，尽管您不会拥有实时数据。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2008-11-03T19:15:58.550

有趣的问题！像许多其他性能调整问题一样，有一些权衡。

1.  可能。将这个处理程序加载到 IMG href="" 中可能是一个更好的主意，将大小设置为 0，这样它对用户不可见。

2.  在负载较重的情况下，这将是可取的，这样您的处理程序可以在排队操作后立即返回。然而，对于大多数负载，运行一个简单的 T-SQL 查询来增加一个计数器可能同样快。

3.  直接在 T-SQL 查询中为值添加 +1 可能是最好的，“count = count + 1”等。这将很快运行，并且会导致后续检索数据而不进行聚合。

希望这可以帮助！

亚当

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2008-11-03T19:14:47.413

我会使用其他页面中引用的日志记录方法，除非您需要跟踪查看的特定时间/日期。我的推理仅仅是因为当你的应用程序开始扩大规模时你可能会得到大量的项目。

作为 CSS 样式链接到处理程序，应该不会真正停止加载时间，但它可能会产生一些影响。

使用简单的插入/更新脚本，我无法想象执行语句的性能开销值得尝试执行队列样式系统......

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2008-11-03T19:16:31.323

开发仅用于跟踪页面浏览量/点击量的 MQ 听起来有点过于复杂。

如果您担心用户感知到的任何延迟，为什么不直接将 JavaScript 中的 XmlHttpRequest 发送到您的 URL？这将被异步处理。

# svn - 这是创建具有多个项目和供应商的 SVN 存储库的正确分步和组织吗？

> ID：259600
> 
> 赞同：4
> 
> 时间：2008-11-03T19:08:45.210
> 
> 标签：svn, repository, organization

我已经阅读了相当多的 Red Bean Software SVN Book，以及一些关于 SO 的问题，但我想确保我第一次以正确的方式一步一步地解决这个问题我开始使用它。它是否正确？

1.  安装SVN。
2.  在 /usr/local/svn 创建 SVN 存储库。目录结构如下所示：

    ```
    -- conf
    -- db
    -- format
    -- hooks
    -- locks
    -- README.txt 
    ```

3.  通过命令行为存储库组织（包括项目和供应商）创建文件夹。

    ```
    -- conf
    -- db
    -- format
    -- hooks
    -- locks
    -- projects
       -- project_name
          -- vendor
          -- trunk
          -- branches
          -- tags
       -- project_name
          -- vendor
          -- trunk
          -- branches
          -- tags
    -- README.txt 
    ```

4.  将供应商代码签出到正确项目名称下的供应商文件夹中。

5.  以正确的项目名称将供应商代码导出到主干（无需合并，因为我还没有项目主干文件）。
6.  在 /svnroot/conf/passwd 和 /svnroot/conf/svnserve.conf 中创建用户/权限。
7.  确保 svnserve 正在运行，并在我的本地 SVN 客户端 (TortoiseSVN) 上检查我需要的项目的主干。

我不需要通过公共 URL 提供此服务，因此我没有为 Apache 进行配置。服务器不在我们的网络中，而是我们租用的专用 CentOS 盒子。感谢您的任何想法和建议。

**编辑：**

我想我很困惑，因为我没有代码或项目开始，所以我从供应商的代码开始。我是否需要在服务器上的某处创建一个目录结构，其中包括我的 project_name w/ vendor、trunk、branches 和 tags 子文件夹，将其导入我的 repo，然后将供应商的代码导入 vendor 文件夹？我的想法是我可以从供应商那里获得更新，然后将这些更新与我对我的主干所做的任何更改合并。

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2008-11-03T19:17:06.207

> 通过命令行为存储库组织（包括项目和供应商）创建文件夹。

您的意思是通过在 subversion intallation 目录中创建目录来创建存储库结构吗？这是非常错误的。

您必须通过`svn mkdir`命令而不是通过文件系统创建必要的文件夹。

在`/usr/local/svn`您拥有 Subversion 存储库的物理实现中，您必须只能通过客户端访问它，并且永远不要“手动”触摸它。

例如，使用 file:// URL 方案

```
svn mkdir file:///usr/local/svn/projects -m "Parent dir for projects created" 
```

* * *

## 回答 #2

> 赞同：5
> 
> 时间：2008-11-03T19:50:56.887

你似乎有正确的想法，但你的术语有点错误。这真的会让 SVN 的人感到困惑，因为您使用的词在 SVN 的上下文中具有特定含义。扩展Davide所说的：

2）通过执行类似的操作来创建您的存储库`svnadmin create /usr/local/svn`。

3）创建你的文件夹。您不需要（或不想要）列表中不在下面的部分`projects/`。这些其他目录是 SVN 用来跟踪修订的，它们实际上并不在存储库中。如果您在系统的某处创建包含`project_name/`子树的目录层次结构，则可以`svn import`在其上运行任意多次，每个项目一次（每次为目标指定不同的名称）。这将创建您的目录结构。

4）我认为您的意思不是“结帐”，而是“导入”或“签入”（在SVN用语中通常称为“提交”，但可以理解“签入”）。导入会将供应商文件添加到存储库中。Checkout 的意思是“创建这个版本化目录的本地副本供我使用”，称为工作副本。团队中的每个开发人员都应该有自己的工作副本。在开发人员对其工作副本进行更改后，他们`svn commit`会将更改发送到存储库。团队中的其他开发人员将运行`svn update`以将这些更改从存储库中获取到他们自己的工作副本中。

5）我最近没看SVN的书，但我认为它指导你将供应商分支的版本复制到主干，而不是导出它。以 SVN 术语导出意味着取消目录树的版本，这显然不是您想要的。

如果您在第 2 步之后立即执行第 6 步和第 7 步，您可能会发现事情更容易，因为那时您可以使用`svn://`协议访问您的存储库以完成剩余的步骤，而不是`file://`Davide 建议的那样，后者仅适用于本地计算机。

# .net - 各种 CLR 运行时有多大？

> ID：259613
> 
> 赞同：2
> 
> 时间：2008-11-03T19:12:06.247
> 
> 标签：.net, clr, size

我正在考虑将一个项目迁移到托管代码，但我听说 .NET 运行时非常庞大——实际上比我的可执行二进制文件大几倍。在我看来，这就像尾巴在摇狗。但我也被告知，一些 CLR 实现，例如 Mono，是模块化的，您可以为它们创建一个自定义分发，只包含您实际需要的部分。

问题是，我在谷歌上找到关于这个应该非常简单的问题的答案非常困难。各种实现的完整 CLR 包有多大，哪些支持这种模块化分发能力，以及运行时对于不使用大量 .NET 铃声的标准 Windows 样式（基于表单）应用程序最终会有多大和口哨？（我最感兴趣的是组装系统固有的轻松创建插件的能力，以及通过 JIT 编译将脚本构建到我的程序中的能力。）

编辑：我对安装程序大小或下载时间不感兴趣。我想知道实际框架的大小，未压缩并准备好运行，因为它将在最终用户的系统上。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2008-11-03T19:15:42.543

你可能会觉得这个网站很有趣。

[http://www.hanselman.com/smallestdotnet/](http://www.hanselman.com/smallestdotnet/)

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2008-11-03T19:27:06.717

通常，您不必担心大小，因为大多数具有正版 Microsoft Windows 并设置为检索自动更新的 Internet 连接计算机都应该安装框架。可以肯定的是，我会向您推荐 2.0 版，因为它似乎是最受欢迎的。另外，请记住，.net 框架有一个较小的版本（子集），称为“[客户端配置文件](http://blogs.msdn.com/brada/archive/2008/05/21/net-framework-client-profile.aspx)”。

还要考虑一下：如果您使用任何外部库（即 MFC/ATL/VB 运行时）？如果你是，包含这些依赖项，你的应用程序可能会达到与 .net 框架相同的大小，如果不是更大的话。

确实，旧系统（2000 SP4 之前）会出现问题，但这取决于您的目标客户，最后取决于您的目标。

稍后编辑：您可以将应用程序的安装程序设置为自动下载所需的依赖项（您的应用程序所需的版本），并且您可以使用该`ClickOnce`技术从网站上相对容易地部署和维护您的应用程序（通过提供更新）。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2008-11-03T20:39:11.720

我看到您想要“安装时使用的磁盘”而不是“下载大小”。这不是一个特别有用的衡量标准，答案是“你基本上看不出来”，但为了感兴趣，这是我的数据：

查看我的 windows 目录，在`Microsoft.NET\Framework`我的 windows vista PC 上的目录（这是所有框架所在的位置）中，我有以下目录：

*   v1.0.3705：400 k
*   v1.1.4322：493 字节

但是请注意，我实际上并没有安装这些框架。为了兼容性，Vista 可能只是有一些别名。无论如何，您永远都不会使用这些版本进行开发，因为它们已经过时（与较新的东西相比，它们是废话）

现在这就是有趣的地方。

*   “框架”目录本身有 356 k 的文件
*   v2.0.50727：152 MB
*   v3.0：10.5 MB
*   v3.5：24.7 MB

中还有“全局程序集缓存” `C:\Windows\assembly`，在我的 PC 上运行到 530 MB，但*其中一些*文件硬链接到其他目录，所以它们不计算在内。

然而，这具有误导性，因为 3.0 和 3.5 “在” 2.0 之上运行，您不能单独拥有它们。

那是原始数据，但并不像只看数字那么简单。

1.  我安装了 Visual Studio 2005 和 2008。这让我获得了数百 MB 的调试 dll。

2.  这也是`Microsoft Visual J# 2.0 Redistributable Package`安装 Visual Studio 的一部分，在客户端 PC 上不需要，除非您使用没有人使用过的 J#。那是 7 MB

3.  除了所有 dll 的调试副本外，还有 XML 文档文件，在 framework\v2.0 目录中总共有 69 MB

4.  任何拥有Vista 的人都已经拥有v2.0 和v3.0 目录，而且他们的v2.0 目录会小很多，除非他们还安装了.NET 3.5。除非您专门针对 .NET 3.5，否则 Vista 上的“部署成本”因此为零。

对于一些更真实的“客户端”数据，我有一台 Windows XP SP2 PC，只安装了基本的 .NET 2.0。这是上面的数字：

*   Windows\Microsoft.NET\Framework\v2.0.50727：64 MB
*   Windows\assembly：92 MB（注意，由于硬链接，它并没有这么大）

我记得前段时间在 winXP 上看到 .NET 2.0 需要 130 兆字节，这听起来很对。

现在，这听起来很多，但这里有一些数据可以与之对比：

VC++ 2008 基础 dll（vc、mfc、atl）为 10 meg，它们提供的功能很少。当您构建具有任何不错的功能集的 C++ 应用程序时，根据我的经验，您正在查看大约 4 到 5 兆的可执行文件和 dll 的交付。相比之下，我不久前构建的一个功能相当的 .NET 应用程序有 800k 的 dll 和可执行文件，其中大部分被嵌入的图标和位图占用。

如今，在 .NET 运行时开始大获全胜之前，它不需要那么多应用程序。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2008-11-03T19:16:55.287

Scott Hanselman 有一篇关于各种 .NET 发行版的大小以及这些对软件发行版的影响的有用[博客文章。](http://www.hanselman.com/blog/SmallestDotNetOnTheSizeOfTheNETFramework.aspx)

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2008-11-03T19:19:24.003

安装框架时会安装 CLR 运行时。如果我没记错的话，.NET 2.o 的安装程序大小约为 35-40Mb。我不确定 3.0 和 3.5，您可以查看 Microsoft 下载来了解一下。

已经安装框架变得越来越普遍，并且由于它是其他应用程序使用的服务，因此许多人通常不认为它是您的应用程序足迹的一部分。

我不知道 Microsoft 版本有什么方法可以使其“模块化”

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2008-11-03T19:24:59.093

您必须意识到，每种语言都需要某种 CLR。即使它是 C/C++，它也取决于操作系统内置的那个。Java 的版本是 JVM，当然还有 .NET 版本。如果您真的担心大小，有人链接了最小的 .NET，这是一个好的开始。

请记住，大多数人至少已经安装了 .NET1.0，除非可移植性对您来说非常重要，否则最好只说明 .NET 框架是一个依赖项。

* * *

## 回答 #7

> 赞同：0
> 
> 时间：2008-11-03T19:30:00.003

您可以查看的路线是转换为 C++ 的工具，例如[http://www.codeplex.com/crossnet](http://www.codeplex.com/crossnet)。功能本身并不完整或完美，但可以让您进行更高级别的编程，然后可以自由地成为 .Net 自由。

# javascript - 带有 jquery 的不显眼的 javascript - 10 分钟的好教程？

> ID：259614
> 
> 赞同：13
> 
> 时间：2008-11-03T19:12:08.090
> 
> 标签：javascript, jquery, html, unobtrusive-javascript

我正在寻找一个很好的 10 分钟介绍使用 JQuery 的 Unobtrusive Javascript。我对这个概念完全陌生，我想看看事件绑定等是如何工作的。

作为一些背景，我正在寻找一个类似于我们在 SO 上的“删除这个标签”系统。看源码，没看到什么js，就是一个img标签。这让我认为必须有外部 js 绑定到 click 事件。我想知道怎么做，我想要一个教我怎么做的教程！

* * *

## 回答 #1

> 赞同：11
> 
> 时间：2008-11-03T19:22:29.330

我想 jQuery 主页上的[教程](http://docs.jquery.com/Tutorials)页面将是一个很好的起点:)

删除您单击的链接的简单示例如下：

```
<html>

<head>
<script type="text/javascript"
  src="http://ajax.googleapis.com/ajax/libs/jquery/1.2.6/jquery.min.js"></script>
<script type="text/javascript">
    // execute script only when DOM has finished loading
    $(document).ready(function() {
        $('#removeme').click(function() {
            // remove element that has been target of the event
            $(this).remove();
            // stop browser from following the link
            return false;
        });
    });
</script>
</head>

<body>
  <p>
    <a id="removeme" href="http://example.org">Remove me</a>
  </p>
</body>
</html> 
```

# php - 如何使用从 PHP 中获取的内容将 HTML 文件附加到电子邮件？

> ID：259622
> 
> 赞同：2
> 
> 时间：2008-11-03T19:15:49.173
> 
> 标签：php, html, database, email, attachment

如何通过 PHP 发送带有 HTML 文件附件的邮件？-> HTML 文件（代码）的内容在 DB 中的字符串中。有一些简单的方法或免费脚本可以做到这一点吗？我不想将文件存储在本地，我需要从数据库中读取它并将其作为附件直接发送（不包含在正文中）。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2008-11-03T19:37:57.117

如果你很难获得正确的标题，你总是可以使用[PHP Mailer](https://github.com/PHPMailer/PHPMailer)之类的东西，而不是重新发明轮子。

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2008-11-03T19:40:32.807

我喜欢梨。

```
<?
include('Mail.php');
include('Mail/mime.php');
$text = 'Text version of email';
$html = '<html><body>HTML version of email</body></html>';
$file = './files/example.zip';
$crlf = "rn";
$hdrs = array(
              'From'    => 'someone@domain.pl',
              'To'      => 'someone@domain.pl',
              'Subject' => 'Test mime message'
              );
$mime = new Mail_mime($crlf);
$mime->setTXTBody($text);
$mime->setHTMLBody($html);
$mime->addAttachment($file,'application/octet-stream');
$body = $mime->get();
$hdrs = $mime->headers($hdrs);
$mail =& Mail::factory('mail', $params);
$mail->send('mail@domain.pl', $hdrs, $body); 
?> 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2008-11-03T19:18:39.323

您应该能够按照[这些说明](http://www.webcheatsheet.com/PHP/send_email_text_html_attachment.php#attachment)发送电子邮件附件。您只需调整代码以从数据库中读取字符串，而不是读取文件的内容。

# python - 将一个人的名字拆分为名字和姓氏

> ID：259634
> 
> 赞同：24
> 
> 时间：2008-11-03T19:19:09.167
> 
> 标签：python, split

好的，所以基本上我在问他们名字的问题，我希望这是一个输入，而不是名字和姓氏。

现在有什么方法可以拆分这个名字吗？并从“句子”中取出最后一个词，例如

```
name = "Thomas Winter"
print name.split() 
```

输出的只是“冬天”

* * *

## 回答 #1

> 赞同：65
> 
> 时间：2008-11-03T19:42:02.833

您会发现这种方法的关键问题不是技术问题，而是人类问题 - 不同的人以不同的方式书写他们的名字。

事实上，“姓”和“姓”的用语本身就有缺陷。

虽然许多混合家庭使用连字符的姓氏，例如 Smith-Jones，但有些人只是分别使用这两个名字，“Smith Jones”，其中两个名字都是姓氏。

许多欧洲姓氏有多个部分，例如“de Vere”和“van den Neiulaar”。有时这些临时演员有​​重要的家族历史——例如，几百年前国王授予的前缀。

附带问题：我已经为我所引用的人正确地大写了这些 - “de”和“van den”对于某些家庭没有大写字母，但对于其他家庭却有。

相反，许多亚洲文化将姓氏放在首位，因为家庭被认为比个人更重要。

最后一点 - 有些人非常重视“初级”或“高级”或“III” - 你的代码不应该将它们视为姓氏。

还注意到有相当多的人使用的名字不是他们父母赋予的名字，我使用了以下方案并取得了一些成功：

全名（通常用于寻址邮件）；姓; Known As（谈话中常用的名称）。

例如：

全名：威廉·盖茨三世；姓氏：盖茨；别名：比尔

全名：宋丽；姓氏：宋；别名：丽莎

* * *

## 回答 #2

> 赞同：15
> 
> 时间：2008-11-03T19:23:04.697

尝试从单个输入中拆分姓名的问题在于，您将无法获得姓氏中有空格的人的完整姓氏，而且我不相信您将能够编写代码来完全管理它。

如果可能的话，我建议您单独询问姓名。

* * *

## 回答 #3

> 赞同：15
> 
> 时间：2010-05-19T03:05:27.777

这是一个相当老的问题，但我发现它正在寻找一种解决方案来从一个全局名称中解析出片段。

[http://code.google.com/p/python-nameparser/](http://code.google.com/p/python-nameparser/)

* * *

## 回答 #4

> 赞同：8
> 
> 时间：2008-11-03T20:20:52.553

一个简单的方法来完全按照你在 python 中的要求是

```
name = "Thomas Winter"
LastName = name.split()[1] 
```

（注意函数调用 split 的括号。）

split() 创建一个列表，其中每个元素都来自您的原始字符串，由空格分隔。您现在可以使用 name.split()[1] 获取第二个元素或使用 name.split()[-1] 获取最后一个元素

然而，正如其他人所说，除非你确定你只是得到一个像“First_Name Last_Name”这样的字符串，否则会涉及更多的问题。

* * *

## 回答 #5

> 赞同：6
> 
> 时间：2008-11-03T20:18:25.910

数据的黄金法则 - 不要太早聚合 - 将字段粘合在一起比将它们分开要容易得多。大多数人还有一个中间名，它应该是一个可选字段。有些人有过多的中间名。有些人只有[一个名字](https://stilgherrian.com/category/only-one-name/)，一个字。一些文化通常有一本中间名词典，向 Golgafrincham Ark 登陆的家谱致敬。

您在这里不需要代码解决方案 - 您需要一个业务规则。

* * *

## 回答 #6

> 赞同：4
> 
> 时间：2012-02-16T03:45:20.910

这就是我在我的应用程序中的做法：

```
def get_first_name(fullname):
    firstname = ''
    try:
        firstname = fullname.split()[0] 
    except Exception as e:
        print str(e)
    return firstname

def get_last_name(fullname):
    lastname = ''
    try:
        index=0
        for part in fullname.split():
            if index > 0:
                if index > 1:
                    lastname += ' ' 
                lastname +=  part
            index += 1
    except Exception as e:
            print str(e)
    return lastname

def get_last_word(string):
    return string.split()[-1]

print get_first_name('Jim Van Loon')
print get_last_name('Jim Van Loon')
print get_last_word('Jim Van Loon') 
```

* * *

## 回答 #7

> 赞同：4
> 
> 时间：2008-11-03T19:20:27.480

像这样：

```
print name.split()[-1] 
```

* * *

## 回答 #8

> 赞同：4
> 
> 时间：2009-11-01T02:45:02.357

如果您尝试在 PHP 中解析人名，我推荐[Keith Beckman 的 nameparse.php 脚本](http://jonathonhill.net/2009-10-31/human-name-parsing-in-php/)。

* * *

## 回答 #9

> 赞同：3
> 
> 时间：2008-11-04T20:35:29.323

由于人们写名字的方式有很多不同的变化，但这里是通过正则表达式获取名字/姓氏的基本方法。

```
import re
p = re.compile(r'^(\s+)?(Mr(\.)?|Mrs(\.)?)?(?P<FIRST_NAME>.+)(\s+)(?P<LAST_NAME>.+)$', re.IGNORECASE)
m = p.match('Mr. Dingo Bat')
if(m != None):
  first_name = m.group('FIRST_NAME')
  last_name = m.group('LAST_NAME') 
```

* * *

## 回答 #10

> 赞同：2
> 
> 时间：2008-11-03T19:30:06.243

拆分名称比看起来更难。有些名字有两个姓氏；有些人会输入名字、中间名和姓氏；有些名字有两个工作名字。处理姓名的更可靠（或最不可靠）的方法是始终在单独的字段中捕获名字和姓氏。当然，这会引发它自己的问题，比如如何处理只有一个名字的人，确保它适用于名字部分顺序不同的用户。

名字很难，小心处理。

* * *

## 回答 #11

> 赞同：1
> 
> 时间：2010-09-10T22:28:26.353

这绝对是一项比表面上看起来更复杂的任务。我在博客上写了一些挑战以及解决它的算法。如果您想要 PHP 的最新版本，请务必查看我的 Google 代码项目：

[http://www.onlineaspect.com/2009/08/17/splitting-names/](http://www.onlineaspect.com/2009/08/17/splitting-names/)

* * *

## 回答 #12

> 赞同：0
> 
> 时间：2008-11-03T19:21:27.617

您可能希望为此使用 rsplit：

```
rsplit([sep [,maxsplit]]) 
```

返回字符串中的单词列表，`sep`用作分隔符字符串。如果`maxsplit`给出，最多`maxsplit`拆分完成，最右边的拆分。如果`sep`未指定 or `None`，则任何空白字符串都是分隔符。除了从右侧拆分外，`rsplit()`其行为如下文`split()`详细描述。2.4 版中的新功能。

* * *

## 回答 #13

> 赞同：0
> 
> 时间：2008-11-03T19:30:41.780

[这是在 SQL 中执行此操作的方法](https://stackoverflow.com/questions/159567/how-can-i-parse-the-first-middle-and-last-name-from-a-full-name-field-in-sql#159760)。但是用这种东西进行数据归一化真的很麻烦。我同意 Dave DuPlantis 关于要求单独输入的观点。

* * *

## 回答 #14

> 赞同：0
> 
> 时间：2008-11-03T19:59:30.847

我会指定一种标准格式（某些表格使用它们），例如“请以*名字，姓氏*形式写下您的名字”。

它使您更容易，因为名称通常不包含逗号。它还验证您的用户是否实际输入了名字和姓氏。

* * *

## 回答 #15

> 赞同：0
> 
> 时间：2019-05-15T13:12:30.687

```
name = "Thomas Winter"
first, last = name.split()
print("First = {first}".format(first=first))
#First = Thomas
print("Last = {last}".format(last=" ".join(last)))
#Last = Winter 
```

* * *

## 回答 #16

> 赞同：0
> 
> 时间：2019-12-10T17:01:25.637

你可以用`str.find()`这个。

```
x=input("enter your name ")
l=x.find(" ")
print("your first name is",x[:l])
print("your last name is",x[l:]) 
```

# sql - 使用 SQL Server 2005 Management Studio 时是否存在 SQL Server 2000 数据库损坏的危险？

> ID：259650
> 
> 赞同：4
> 
> 时间：2008-11-03T19:25:32.040
> 
> 标签：sql, sql-server, ssms

在不久前的一次 SQL DBA 职位面试中，我提到我更喜欢 SQL 2005 Management Studio 应用程序而不是旧的 2000 版本的企业管理器/查询分析器。采访我的 DBA 说，他们在从 2005 MS 进行更改时，在他们的 2000 数据库中经历了某种数据库损坏，所以他们现在总是使用 Enterprise Manager。

他有点含糊，但我的印象是他在谈论在进行服务器范围或数据库级别的设置更改时所经历的某种损坏，而不仅仅是例行的 SQL 更新之类的。

有人听说过这样的事吗？我最终没有担任那个职位，所以我无法跟进以获取更多信息。

* * *

## 回答 #1

> 赞同：9
> 
> 时间：2008-11-03T19:34:29.917

听起来他只是以此作为缺乏 SQL 2005 Management Studio 经验的借口。DBA 讨厌改变。

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2008-11-03T19:49:40.883

在使用 SQL Management Studio 2005 管理 SQL 2000 数据库将近三年的时间里，我从未遇到过这种情况。有一些任务我仍然会重新回到 EntMan 中执行，但我从未遇到过数据库，即使是最细微的损坏。（和背景：作为一名顾问，我为客户和内部项目管理大约 45 个不同的数据库；大多数受到严重影响，只有大约十几个是 SQL2005 数据库。）

# xml - 选择祖先的属性；“../..” 作品，“祖先:: “不

> ID：259656
> 
> 赞同：0
> 
> 时间：2008-11-03T19:29:36.400
> 
> 标签：xml, xslt, xslt-1.0

我正在运行一个 XML 文档，选择所有元素，并基于祖先创建链接，该祖先通常是树中的两个节点，但偶尔也会有 3 或 4 个节点。对于大多数元素， using`<xsl:value-of select="translate(../../@name,$uc,$lc)" />`工作得很好，但对于祖先是 3 个左右节点的情况，我想使用`<xsl:value-of select="translate(ancestor::package/@name,$uc,$lc)" />`，但这不起作用。

我正在使用 Ruby 中的 xsltproc 来进行 XSL 转换。

示例树（是的，它有 XSLT，不，我不想处理它）：

```
<package name="blork!" xmlns="http://xml.snapin.com/XBL">
  <xsl:template name="doSomething">
    <tokens>
      <token name="text-from-resource" export="public" />
    </tokens>
  </xsl:template>
</package> 
```

我正在使用的 XSL：

```
<xsl:stylesheet version="1.0" xmlns:xsl="http://www.w3.org/1999/XSL/Transform" xmlns:s4="http://xml.snapin.com/XBL">
  <xsl:template match="/">
    <xsl:if test="count(//s4:token) >0">
      <xsl:text>Tokens!</xsl:text>
      <xsl:for-each select="//s4:token">
        <xsl:choose>
          <xsl:when test="@export='global'" />
          <xsl:otherwise>
            <xsl:value-of select="translate(ancestor::s4:package/@name,$uc,$lc)" />
          </xsl:otherwise>
        </xsl:choose>
      </xsl:for-each>
    </xsl:if>
  </xsl:template>
</xsl:stylesheet> 
```

*编辑：*啊，对，忘记了选择的名称空间。在大多数情况下，解析器正确地找到了那个祖先，但是当那里有一个 xsl: 节点时它仍然找不到它，并且目标文件没有 xsl 的命名空间。我不想修改目标文件，因为它是生产代码——我只是在编写一个自动文档工具。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2008-11-03T19:31:59.843

您的问题可能与命名空间有关。您还没有将那些包含在示例树中 - 您可以更精确地粘贴您粘贴的内容吗？假设包节点与令牌节点位于同一命名空间中，请尝试：

```
<xsl:value-of select="translate(ancestor::s4:package/@name,$uc,$lc)" /> 
```

您也可以只测试不合格的名称，尽管它会更慢：

```
<xsl:value-of select="translate(ancestor::*[local-name()='package']/@name,$uc,$lc)" /> 
```

W3C local-name() 规范[在这里](http://www.w3.org/TR/xpath#function-local-name)。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2008-11-03T22:17:22.397

我认为，只要您使用命名空间感知 XML 处理器，就无法在目标文档中为“xsl”前缀声明命名空间。当您尝试使用 xsltproc 和给定样式表转换目标文档时，您没有看到任何错误吗？

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2008-11-03T22:36:30.127

您可能会仔细检查您的工具使用的 XSLT 版本。我相信 XSLT 1.0 不支持“ancestor::<tag>...”

# algorithm - 无痛的“算法分析”培训？

> ID：259660
> 
> 赞同：17
> 
> 时间：2008-11-03T19:30:19.707
> 
> 标签：algorithm

我在大学的“算法分析”课程上有过痛苦的经历，但最近发现在*现实世界*中需要它。-- 无论如何，我正在寻找一个简单而有效的速成课程。有任何想法吗？

*相关旁注：* 如果有 Dilbert 教授的“算法分析卡通指南”肯定会很好。

**更新：** 可以在以下位置找到一个非常相似的问题：[如何开始使用算法？](https://stackoverflow.com/questions/366418/how-to-get-started-on-algorithms)

* * *

## 回答 #1

> 赞同：22
> 
> 时间：2008-11-03T19:34:29.837

有很多关于这个主题的好书。我喜欢[An Introduction to the Analysis of Algorithms](https://rads.stackoverflow.com/amzn/click/com/020140009X)。还可以查看[MIT OpenCourseWare](http://ocw.mit.edu/OcwWeb/Electrical-Engineering-and-Computer-Science/6-046JFall-2005/CourseHome/)上的算法课程（使用[CLRS](https://rads.stackoverflow.com/amzn/click/com/0262032937)作为课程文本）。它有点深，但是在线上可以让您按照自己的节奏进行。

我最近开始阅读的其他几本书是[Algorithms in a Nutshell](http://oreilly.com/catalog/9780596516246/)和[Algorithm Design Manual](https://rads.stackoverflow.com/amzn/click/com/0387948600)。与大多数算法书籍相比，它们都采用了更轻松的方法。这些书不是繁重的数学和形式证明，而是为您提供现实的问题陈述，并向您展示改进算法所采取的步骤。它们还向您展示了如何*估计*和*衡量*解决方案的复杂性。我强烈推荐这两本书。

* * *

## 回答 #2

> 赞同：5
> 
> 时间：2008-11-03T19:38:25.180

同样，加州大学伯克利分校有无数的播客，您可能会觉得有帮助。

[http://webcast.berkeley.edu/course_feeds.php](http://webcast.berkeley.edu/course_feeds.php)

* * *

## 回答 #3

> 赞同：4
> 
> 时间：2008-11-03T20:54:07.417

[谷歌代码大学](http://code.google.com/edu/)提供[了一个关于算法的页面，该页面](http://code.google.com/edu/algorithms/index.html)指向[斯坦福](http://code.google.com/edu/submissions/stanford/index.html)和[普林斯顿](http://code.google.com/edu/submissions/SedgewickWayne/index.html)提供的一些幻灯片。

* * *

## 回答 #4

> 赞同：4
> 
> 时间：2009-03-01T19:15:48.813

[Erik Öjebo](https://stackoverflow.com/users/276/erik-214jebo)对[一个几乎相同的问题](https://stackoverflow.com/questions/366418/how-to-get-started-on-algorithms)发表了一个[很好的答案](https://stackoverflow.com/questions/366418/how-to-get-started-on-algorithms/366443#366443)，在你的问题之后不久就被问到了。

引用他的回答：

> 麻省理工学院在他们的[开放课件项目](http://ocw.mit.edu/OcwWeb/web/about/about/index.htm)中有一个算法课程，包括视频、音频和 PDF 讲座。
> 
> *   [演讲笔记](http://ocw.mit.edu/OcwWeb/Electrical-Engineering-and-Computer-Science/6-006Spring-2008/LectureNotes/index.htm)
> *   [课程主页](http://ocw.mit.edu/OcwWeb/Electrical-Engineering-and-Computer-Science/6-006Spring-2008/CourseHome/index.htm)
> 
> [ArsDigita 大学](http://www.aduni.org/)还有一个在线课程，也有视频讲座。
> 
> *   [讲座](http://www.aduni.org/courses/algorithms/index.php?view=cw)
> *   [课程主页](http://www.aduni.org/courses/algorithms/)
> 
> 在[佛罗里达大学](http://www.ufl.edu)有 Java 中的数据结构和算法课程，就像上面一样，它有在线视频讲座。
> 
> *   [讲座](http://www.cise.ufl.edu/~sahni/cop3530/lectures.htm)
> *   [课程主页](http://www.cise.ufl.edu/~sahni/cop3530/)
> 
> 在[freescienceonline.blogspot.com 上](http://freescienceonline.blogspot.com)，您可以找到大量关于算法的视频讲座，以及许多其他有趣的视频。

* * *

## 回答 #5

> 赞同：3
> 
> 时间：2008-11-03T19:37:54.777

我喜欢Cormen、Leiserson、Rivest 和 Stein[的《算法导论》 。](https://rads.stackoverflow.com/amzn/click/com/0072970545)它有点重，但我发现它是一个不错的参考文本。

* * *

## 回答 #6

> 赞同：3
> 
> 时间：2009-02-28T18:34:34.243

你没有说很多关于你背景的其余部分。对于算法的直接分析，您评估算法以找到其顺序统计和行为的方法，如果您对一般数学感到满意 - 假设您已经学习了两年微积分，或者一个很好的抽象代数课程——那么你真的不能比阅读[Knuth Volume One](http://en.wikipedia.org/wiki/The_Art_of_Computer_Programming)做得更好了。

通常的“算法分析”课程也是一门数据结构课程，所以如果您还需要了解列表、树等，数据结构文本可能会更好。我在研究生院最喜欢的是[Aho、Hopcroft 和 Ullman](https://rads.stackoverflow.com/amzn/click/com/0201000237)。

我喜欢 Cormen 作为参考；它还可以用作令人赞叹的门挡，用于执行大型 icky 虫子，用于夹紧小胶接缝（光滑的封面会释放大多数木胶），还可以用作书尾，因为它可以将书挡固定到位。不推荐它作为介绍文本。

* * *

## 回答 #7

> 赞同：3
> 
> 时间：2009-03-02T18:59:30.890

有一个简单的捷径可以理解搜索和排序算法的性能，如果那是您正在寻找的。

首先，排序基本上是重复搜索。对于 N 项中的每一项，您都在搜索将其插入到列表中的哪个位置，然后将其插入，因此需要 N 倍于搜索过程的 big-O。

要理解搜索的大 O，一种简单的方法是将其视为一系列决策（通常是二元决策），每个分支都有一定的概率。

假设您的表有 N = 1024 个条目。这意味着索引表需要 10 位，因为 log(1024) = 10 (base 2)。搜索是学习这 10 位的过程。

如果一个决策点走任一方向的概率大致相等，那么它的熵为 -0.5 log(0.5) - 0.5 log(0.5)（以 2 为底），即 1 位，因此它在每个决策中学习 1 位信息. 瞧！它大约需要 10 个决策，或 log(N)。所以排序是O(N log(N))。所有 NlogN 排序算法都基于具有大致相同可能性结果的二元决策。

假设您正在进行线性搜索（如冒泡排序）。在第一个决定中，正确的机会是 1/1024 对 1023/1024。熵是 1/1024 * log(1024/1) + 1023/1024 * log(1024/1023) 或大约 10/1024 + 0（即大约 0.01）。因此，在第一个决定中，您只了解 0.01 位，因为结果是如此倾斜。这就是线性搜索效率低下的原因。它采用 N 次操作的顺序，因此排序需要 O(N*N)。

*（顺便说一句：线性搜索实际上是指数的。如果您将问题的信息内容定义为 n = log(N)，那么线性搜索需要 O(2^n) 步。这就是为什么像无指导的博弈树搜索这样的事情是指数的移动次数。）*

另一方面，假设您不是做出二元决策，而是编制索引。您获取您正在查找的单词的部分或全部位，并将它们用作数组的索引，您已在其中预先存储了答案。如果该索引操作有 1024 个同样可能的结果，那么它会学习 10 位，因此只需要大约 1 次操作即可得到答案。这就是哈希编码背后的基本思想。如果您的哈希函数恰好保持顺序，则可以使用它来制作 O(N) 排序算法。

有很多花哨的方法来分析算法，也许这就是你所需要的，但是将它们看作是学习信息的一部分可以满足我 99% 的需求。

* * *

## 回答 #8

> 赞同：2
> 
> 时间：2009-03-02T18:28:36.813

我对算法最有用的工具是[Introduction to Algorithms](https://rads.stackoverflow.com/amzn/click/com/0262032937)。

这是我所知道的关于算法的最佳资源。它深入地涵盖了如此多的主题，并在整个过程中都有示例。我仍然经常提到它。

如果没有那本书，我的算法分析课会很痛苦。

* * *

## 回答 #9

> 赞同：1
> 
> 时间：2009-02-28T17:45:32.003

大多数大学的算法分析课程只对高年级本科生和研究生开放。为什么你会期望这个主题很容易学习？有些算法很容易分析，维基百科关于[Big O 表示法](http://en.wikipedia.org/wiki/Big_O_notation)的文章可能足以理解如何对它们进行分析，但是对任何相当复杂的算法进行分析都不是微不足道的。Cormen 的书可能是使用最广泛的算法书籍，但我不会考虑从它或任何其他书籍中轻松学习算法分析。

* * *

## 回答 #10

> 赞同：1
> 
> 时间：2011-04-17T20:51:51.397

如果您喜欢看和听而不是阅读，我可以推荐 MIT 课程“算法简介”。你可以在这里免费观看：http: [//academicearth.org/courses/introduction-to-algorithms](http://academicearth.org/courses/introduction-to-algorithms)

尽管我对所涉及的数学知识不够了解，但我发现它非常好并且很有教学意义。

* * *

## 回答 #11

> 赞同：1
> 
> 时间：2012-08-29T04:32:01.847

我推荐Adam Drozdek 所著的[Data Structures and Algorithms在 Java 和 C++ 版本中可用。](https://rads.stackoverflow.com/amzn/click/com/0534491820)

* * *

## 回答 #12

> 赞同：0
> 
> 时间：2011-03-20T16:03:02.183

大约一年前，我参加了为期 1 天（9 小时）的算法培训。先决条件要么是 Comp Sci 的本科学位，要么是至少 2 年的编程经验。我发现培训非常有帮助，尤其是我得到的物理书签值得我花时间（和金钱，无论公司支付什么费用）。如果有机会，我会参加另一个这样的会议，即使它基本上是一样的。显然，很大程度上取决于教练。我们的程序员很棒——有趣、实用且活跃的程序员，尽管他有丰富的教学经验。

# vba - VBA 密码保护：它是如何工作的？它安全吗？有其他选择吗？

> ID：259663
> 
> 赞同：1
> 
> 时间：2008-11-03T19:30:47.427
> 
> 标签：vba, security, excel, password-protection

如果想要保护 VBA 应用程序以制作试用（演示）版本而不是公开脚本，那么内置密码保护的安全性如何？有没有其他选择？

编辑：我在这里询问 Excel VBA。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2008-11-03T19:51:46.027

您的密码安全性在很大程度上取决于所使用的办公室版本。可以破解 2007 之前的所有其他 Office 解决方案。Office 2007 需要暴力破解密码。默认加密机制是 128 位 AES。

这意味着密码的复杂性越高，越难破解。IE - 数字、特殊字符、混合大小写等。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2008-11-03T19:52:24.047

它不是很安全，很容易用工具破解。

[这段视频](http://www.youtube.com/watch?v=DCMeZf6g4Cw)展示了它是如何完成的。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2010-01-20T16:26:33.860

It is not secure. Anyone opening your document in [OpenOffice](http://www.openoffice.org/) will get immediate access to the code. Open office basically ignores any password protection.

The OO folks have a very good document describing [the Excel file format](http://sc.openoffice.org/excelfileformat.pdf). Section 4.18 (pg. 114) starts the discussion on how protection is handled. Onorio's suggestion on using an add-in will slow someone down, but will not stop a determined hacker.

It's sort of like locking the door to your house. It won't keep out someone determined to get in, but does 'keep honest people honest'.

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2008-11-03T20:16:27.990

如果您真的想保护源代码，[这](http://msdn.microsoft.com/en-us/library/aa730920.aspx)可能是您的最佳选择。对于那些可能不想关注该链接的人，这是一篇关于为 Excel 2007 开发 XLL 加载项的文章。Xll 是用于 MS Excel 的专用 dll。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2014-01-16T12:48:19.470

完全同意 DaveParillo，即使在 2010/13 版本中，安全性也很差。保护文件的唯一方法是使用真正的加密（AES 128 位）输入打开密码，选项“加密文档”给出相同的结果。所有其他人：

*   工作簿/工作表保护：使用任何密码的 15 位 HASH，因此您应该只尝试 32768 个密码（提供唯一的 HASH）来删除此保护。这是一个很好的算法[Excel的工作表密码保护如何工作](https://stackoverflow.com/questions/12852095/how-does-excels-worksheet-password-protection-work)
*   VBA 项目锁定：您需要更改 vbaProject.bin 文件中的 DBP 值。[如何从 VBA 项目中删除密码？](https://stackoverflow.com/questions/272503/how-do-i-remove-the-password-from-a-vba-project)

# delphi - 在项目之间共享 Delphi 源文件的最佳方式是什么？

> ID：259673
> 
> 赞同：14
> 
> 时间：2008-11-03T19:37:49.410
> 
> 标签：delphi, msbuild, build-process

**在项目之间共享 Delphi 源文件的最佳方式是什么？**

*澄清：我们想在多个 Delphi 项目中使用单个源文件。我们一直在使用我们的 SCM 工具将同一个文件放入多个文件夹，但这并不是一种超级优雅的体验，我们也在考虑迁移到不支持此功能的工具。*

当我一直在调查这个问题时，我考虑了几种不同的方法，但我想知道你在做什么以及你是如何找到你的方法的。

**重要场景​​：**

*   代码时间
    *   添加新的共享依赖项应该需要显式声明，以便管理共享。
    *   添加一个新的共享依赖应该还是比较简单的；它不应该需要一个复杂的过程。
        *   一个列出所有项目“导入”文件（从外部）的文件会很好。
*   编译时
    *   所有项目都应始终使用一个当前版本（源同步状态的当前版本加上本地编辑）构建。
        *   （在不同位置维护不同版本应该使用文件分支，这里不做主题。）
    *   每个项目是否应该能够使用不同的编译器设置（包括标志）影响共享文件的编译是有争议的。
        *   可以说维护（即长期）始终一致构建的源代码更容易。
        *   如果可以轻松地将所述更改的范围限制在一个项目中，那么进行维护修复（即短期）可能会更容易。
*   调试时
    *   在进入例程或设置断点时，应自动打开正确版本的源代码。
    *   编辑显示的源应该会影响下一个构建。
        *   我们不想针对源的临时副本进行调试：我们可能会在混乱中丢失代码。

**注意事项：**

*   短期：
    *   什么方法最容易实施？
*   长期：
    *   哪种方法最易于使用和维护？

提前感谢您的反馈！

马蒂亚斯

* * *

**- - 更新 - -**

感谢您通过回答、评论和投票提供反馈！

我已经开始了将共享文件放入一个“生产者”项目并将已编译文件列表导入每个“消费者”项目的路径。这些项目正在与 MSBuild 链接在一起。一旦事情更加明确，我将编辑这个问题和“图书馆项目”的答案，分享我学到的东西。

敬请关注！（但不要屏住呼吸；你会在几分钟内窒息！：P）

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2008-11-03T19:39:03.650

**使用源代码管理系统的文件共享功能**

*   优点：如果 SCM 系统支持，设置快速且容易。
*   Pro/Con：每个消费者项目都可以独立影响编译时间。
*   缺点：在本地工作副本中没有官方位置。
    *   这可能会导致混乱。
*   缺点：在签入和重新检索之前，源更改不会反映在其他位置。
    *   在签入之前正确验证其他项目是可能的，但非常麻烦。
*   缺点：并非所有 SCM 系统都支持共享文件。
    *   Subversion 最接近的特性是文件夹级别的 svn:externals。

（编辑：重命名以避免混淆。 *当然*，每个人都应该*使用*源代码管理！:-)）

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2008-11-03T19:42:58.883

**使用图书馆项目**

*   优点：每个文件只有一个副本可以编辑。
*   Pro：每个源文件只有一个编译。
    *   编译时间更短。
    *   依赖项目之间的一致编译。
    *   自然增量构建。
*   优点：调试器自然链接到正确的源。
    *   待办事项：确认。
*   优缺点：消费者项目不能独立影响编译时间。
*   缺点：可能难以管理逐个文件级别的共享。
    *   待办事项：调查。
*   缺点：可能需要花费大量精力来设置。
    *   MSBuild 项目的设置。
    *   必须集中所需的项目设置，并且必须验证这些更改。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2008-11-04T09:27:34.633

我认为不需要特殊的解决方案。在我们的项目（共享大量代码的几个应用程序）中，我们使用以下方法：

1.  将源代码拆分到文件夹。
2.  为共享代码的逻辑单元创建包。
3.  支持单体（不使用包）和分块构建。
4.  Monolith 构建用于编码和调试。每个应用程序都有自己的 Unit 输出目录，因此它们都是独立构建的。
5.  依赖限制由项目的搜索路径强制执行。
6.  Parted 构建是自动创建的（我们使用 CruiseControl 服务器和 MSBuild 项目）。自动构建会在构建之前清除所有临时文件夹，因此连续构建之间没有依赖关系。

在我们的例子中，我们无法控制导入文件的列表。但是，我们可以在分部构建中控制导入包的列表。更小的包意味着更好的粒度。如果有人正在向该单元添加依赖项，该单元位于搜索路径中不可用的文件夹中，并且包含该单元的包不在使用列表中，则 parted 构建失败。因此，需要显式操作（修改为 parted 构建生成 CFG 文件的 MSBuild 脚本）来添加依赖项。

PS 我们使用包不是为了控制依赖关系，而是因为 Windows 非 NT 版本运行大型应用程序的问题。所以，依赖控制是一个副作用。分开的构建被认为是“发布”，而单体——作为“调试”配置。Monolith 应用程序仅用于编码和调试。开发人员使用单体应用程序，并在项目配置中引入他们自己的更改，例如附加 VCL 调试信息、开关范围检查错误、优化等。然而，在提交到 SVN 后，CC 尝试进行部分构建。它忽略存储库中的 CFG 文件并使用 MSBuild 项目的特殊任务重新创建它们。因此，我们可以确定没有引入依赖项问题（并执行其他检查）。

就我们不需要同时构建单体和分块构建而言，我们每个应用程序只有一个项目。如果您想在 MSBuild 脚本中构建这两个版本，您可以简单地再添加一个目标，再重新创建一次 CFG，然后再指定一个 Unit 输出目录。当然，如果开发者都需要这两个版本，项目多一些会更方便。

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2008-11-17T11:02:41.730

我不确定我是否正确理解了问题。无论如何，在构建应用程序套件（几个项目但有很多通用代码）时，我们会创建如下文件夹结构：

```
\Main
   \Project1
   \Project2
   ...
   \CommonUnits 
```

我们将常用单元添加到相关项目中（不管它与项目文件不在同一个文件夹中）。此外，有时更容易使用项目级别的条件定义（项目|选项|目录/条件）来处理小的代码差异。例如，Project1 将定义类似“APP_PROJECT1”的内容，然后您可以在通用单元中使用 $IFDEF 来编写特定代码。

重要的是：在这种情况下，最好为整个套件拥有一个源代码控制存储库（当然，根目录是 \Main）。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2008-11-03T19:40:30.980

**编译时复制**

*   优点：文件共享可以逐个文件进行管理。
*   Pro/Con：每个消费者项目都可以独立影响编译时间。
*   缺点：调试器将链接到临时副本，而不是正式版本。
    *   TODO：看看是否有办法改变这一点。
*   缺点：可能需要一些工作来设置 MSBuild 项目。
*   缺点：增量构建共享文件可能很困难。
    *   可能涉及重写一些 Delphi 的 MSBuild 规则。

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2008-11-03T19:41:36.297

**复制-编译-删除**

*   亲：每个文件只有一份正式副本，可以编辑。
*   优点：调试器不会链接到临时副本，因为它已被调试时删除。
    *   TODO：验证调试器是否会找到原始源，如果我们将它放在“浏览路径”中。
*   优点：文件共享可以逐个文件进行管理。
*   Pro/Con：每个消费者项目都可以独立影响编译时间。
*   缺点：可能需要一些工作来设置 MSBuild 项目。
*   缺点：增量构建共享文件可能很困难/不可能。
    *   可能涉及重写一些 Delphi 的 MSBuild 规则。

# c# - 停止在winform按钮上执行的功能单击

> ID：259676
> 
> 赞同：2
> 
> 时间：2008-11-03T19:37:57.757
> 
> 标签：c#, winforms, multithreading

1.  在一个简单的 winform 应用程序中，我调用了一个函数，该函数在按钮单击事件上无休止地创建文件。我将 Application.DoEvents() 添加到循环中。

2.  我按下红色 X 关闭表单。

3.  表单关闭，但文件继续创建......

我认为它在按钮线程上，但它不应该是背景线程吗？尝试在循环函数上将 Thread.CurrentThread.IsBackGround 更改为 True 没有帮助。

想法？

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2008-11-03T19:42:22.223

您正在使用的事实`Application.DoEvents`是问题的第一个迹象：它表明您在 UI 线程中做的太多了。它几乎不适合结构良好的程序。UI 线程并不意味着有任何长时间运行的任务。（诚​​然，如果绘制 UI 需要很长时间，那么您别无选择 - 但这表明您应该简化 UI ......我怀疑它不适用于这种情况。）

相反，您应该在单独的线程中执行长时间运行的任务（创建文件）。[BackgroundWorker](http://msdn.microsoft.com/en-us/library/system.componentmodel.backgroundworker.aspx)非常适合这一点 - 您可以使用它向 UI 报告进度，并且 UI 可以调用[`CancelAsync`](http://msdn.microsoft.com/en-us/library/system.componentmodel.backgroundworker.cancelasync.aspx)方法来请求它停止。您需要[`CancellationPending`](http://msdn.microsoft.com/en-us/library/system.componentmodel.backgroundworker.cancellationpending.aspx)从工作线程中检查属性，查看是否已请求取消，并适当停止。

编辑：只是为了澄清我认为正在发生的事情-我怀疑您的表单正在关闭，但是在事件循环完成之前程序不会终止。您使事件循环与文件创建循环一起进行，因此出现了问题。

请注意，按钮没有线程 - 您的整个 UI 只有一个线程。（在某些情况下，您可能需要多个 UI 线程，但这种情况很少见——如果您这样做了，您就会知道。）

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2008-11-03T20:03:40.997

将此表单级变量添加到表单代码中：

```
private bool _StillOpen = true; 
```

然后将无限循环代码包装在您的按钮单击中，如下所示：

```
while (_StillOpen)
{
    // do whatever your method does
    Application.DoEvents();
} 
```

最后，将此代码添加到表单的 FormClosing 事件中：

```
_StillOpen = false; 
```

当您单击关闭按钮时，这将允许您的表单关闭。理想情况下，您希望在后台线程上执行类似的操作，但这种标志方法可能是您当前问题的快速修复。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2008-11-03T19:48:52.210

按钮单击处理程序在 UI 线程上执行。

当您调用 Application.DoEvents 时，您让 UI 线程处理窗口消息。这样做的一个效果是，每次您的用户单击该按钮时，单击处理程序方法的新“实例”（堆栈帧）以及许多其他堆栈帧都会添加到堆栈中。像这样：

```
{windows forms methods incl. message pump}
  **ClickHandler**
    Application.DoEvents
     {windows forms methods incl. message pump}
      **ClickHandler**
       Application.DoEvents
        {windows forms methods incl. message pump}
          etc. 
```

这一切都非常可怕。

如果你想在后台运行代码，更好的选择是使用

*   BackgroundWorker 组件。
*   用于在线程池中运行代码的标准 .NET 基于委托的机制（BeginInvoke、EndInvoke、IAsyncResult 等）。
*   如果您想实现一个长时间运行的后台线程，而不是将“工作块”分配到池中，您可以创建并启动一个线程，将其设置为后台线程。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2008-11-03T19:44:18.163

您是否专门为该 ButtonClick 代码创建了一个新线程？如果不是，那么它与表单在同一个线程上，所以“X”按钮*应该*停止它。

在任何一种情况下，您都可以设置一个标志 (isClosing)，并在“while true”循环中检查该标志。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2008-11-03T19:45:52.233

你试过打电话`Thread.CurrentThread.Abort()`吗？这不是推荐的方式，但如果您无法`s source code it might help (even though you say you are calling`从函数访问函数 DoEvents`）。

如果您确实可以访问源代码，那么您可以在那里进行检查，让循环知道它必须停止。

此外，您可以使用该`background worker`组件，或创建一个不同的线程，并从外部（即从表单）控制它

# .net - 如何在多个 .NET 应用程序之间共享 DAL 和 BLL？

> ID：259678
> 
> 赞同：6
> 
> 时间：2008-11-03T19:38:20.407
> 
> 标签：.net, wcf, web-services, entity-framework, architecture

我需要创建几个共享 Microsoft SQL Server 数据库的应用程序。其中包括 ASP.NET Web 应用程序、WPF 桌面应用程序，以及可能时不时出现的奇怪的控制台应用程序。

我想使用 ADO.NET Entity Framework 进行数据访问，为我的业务逻辑扩展它的对象，并将这些对象绑定到我的 UI 中的控件。

我怎样才能在我的每个应用程序中做到这一点而不会重复自己太多？如果数据库架构或我的业务逻辑发生变化，那么我想要一种简单（或自动）的方式来更新我的所有应用程序。

我应该如何构建这个系统？

* * *

更新：我已经问了后续问题......

*   [如何在 Visual Basic 中使用 LINQ to Entities？](https://stackoverflow.com/questions/260179/how-do-i-use-linq-to-entities-in-visual-basic)
*   [如何使用部分类扩展 ADO.NET Entity Framework 对象？](https://stackoverflow.com/questions/260233/how-do-i-extend-adonet-entity-framework-objects-with-partial-classes)

* * *

## 回答 #1

> 赞同：9
> 
> 时间：2008-11-03T19:42:28.543

为此，我建议创建一个包含多个项目的 Visual Studio 解决方案。您的 DAL 将包含在其自己的项目中，然后对于需要使用该功能的其他项目，创建一个指向 DAL 项目的项目引用。

希望这可以帮助！

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2008-11-03T20:11:03.710

adamalex 的想法是合理的。根据您的设置，另一种受欢迎的方法是将公共项目分开，编译，然后让您的其他项目引用此编译后的 dll。如果他们引用此 dll 的最新版本或它的特定版本，则由您决定。也许您不希望某些项目必须一直跟上。

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2008-11-03T23:17:12.167

也许您可以使用网络服务来集中数据库访问/逻辑......

从[链接](https://stackoverflow.com/questions/260265/desktop-software-development-options)（[SOA](http://en.wikipedia.org/wiki/Service-oriented_architecture) / [WebServices](http://en.wikipedia.org/wiki/Web_service) / [Remoting](http://en.wikipedia.org/wiki/.NET_Remoting)）的答案中可以看出

* * *

## 回答 #4

> 赞同：2
> 
> 时间：2008-11-10T02:52:37.567

我建议你看看 CSLA.Net。它允许您构建轻松支持多个接口（asp.net、wpf、silverlight 等）的业务对象。我不知道您在构建什么，但 CSLA 非常支持这一点。

我有一个幻灯片幻灯片，可以帮助你了解 CSLA。

[CSLA 滑梯](http://keithelder.net/Presentations/IntroToCSLANet/IntroToCSLA-NetFramework.pptx)

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2008-11-03T23:20:47.150

我建议创建一个包含多个项目的新 Visual Studio 解决方案。对于 DAL/BLL 分离，我建议使用类库。进行此抽象化后，您可以将其包装在其他项目中，例如 WCF Web 服务，并将其公开地公开给 .NET 系统，以及可能的其他系统。

创建这些类库项目后，您可以在其他项目中添加对它们的引用并使用它们。这将有助于保持关注点的清晰分离。

# javascript - 为 HTML 元素实现鼠标悬停背景颜色更改的最简单方法是什么？

> ID：259709
> 
> 赞同：1
> 
> 时间：2008-11-03T19:47:03.510
> 
> 标签：javascript, html

我有以下样式：

```
a.button {
    background-color: orange;
    margin: .2cm;
    padding: .2cm;
    color: black;
    font-family: sans-serif;
    text-decoration: none;
    font-weight: bold;
    border: solid #000000;
}

a.buttonMouseover {
    background-color: darkGoldenRod;
    margin: .2cm;
    padding: .2cm;
    color: black;
    font-family: sans-serif;
    text-decoration: none;
    font-weight: bold;
    border: solid #000000;
} 
```

以及以下 javascript 代码（我的第一个顺便说一句）：

```
function backgroundChangeIn(element){
    if (element.className = "a.button"){element.className = "buttonMouseover";}
}
function backgroundChangeOut(element){
    if (element.className = "a.buttonMouseover"){element.className = "button";}
} 
```

并且，以下元素应在鼠标悬停时更改背景：

```
<a class="button" href="" onmouseover="backgroundChangeIn(this)" onmouseout="backgroundChangeOut(this)">A Button</a> 
```

到目前为止，它对我有用。但我想知道是否有更好的方法。

（对不起所有的代码）

* * *

## 回答 #1

> 赞同：10
> 
> 时间：2008-11-03T19:49:59.400

根据您的目标浏览器，您可以使用`hover`伪标签。

```
a.button {
    background-color: orange;
    margin: .2cm;
    padding: .2cm;
    color: black;
    font-family: sans-serif;
    text-decoration: none;
    font-weight: bold;
    border: solid #000000;
}

a.button:hover {
    background-color: darkGoldenRod;
} 
```

这是[w3schools](http://www.w3schools.com/css/pr_pseudo_hover.asp)上的一些文档。看起来它在所有远程现代浏览器上都得到了很好的支持。

请注意，正常和悬停样式规则都适用，悬停优先。所以你只需要在悬停规则中放入什么变化。

* * *

## 回答 #2

> 赞同：5
> 
> 时间：2008-11-03T20:00:19.893

sblundy 有基本的权利。除此之外，所有现代浏览器都允许您在 <a> 上使用 hover 伪元素，但是 IE6 不会在任何其他元素上识别它。

在 IE6 中，当您悬停时，您需要某种 JavaScript 来添加类名。我喜欢使用 jQuery，我会这样做的方式如下：

```
$(function(){
  $('.hoverable').hover(function(){
    $(this).addClass('hover');
  },
  function(){
    $(this).removeClass('hover');
  })
}) 
```

这将使所有具有“可悬停”类的元素在悬停时都具有悬停类。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2008-11-03T19:50:31.897

```
a.button, a.button:hover {
    margin: .2cm;
    padding: .2cm;
    color: black;
    font-family: sans-serif;
    text-decoration: none;
    font-weight: bold;
    border: solid #000000;
}

a.button {
    background-color: orange;
}

a.button:hover {
    background-color: darkGoldenRod;
} 
```

和：

```
<a class="button" href="">A Button</a> 
```

* * *

## 回答 #4

> 赞同：-1
> 
> 时间：2008-11-03T19:50:55.110

您可以使用[jQuery 之](http://jquery.com/ "jQuery")类的库来简化操作。

# php - 关闭 SimpleXML for PHP 中的自闭合标签？

> ID：259719
> 
> 赞同：4
> 
> 时间：2008-11-03T19:53:33.857
> 
> 标签：php, xml, simplexml

我正在使用 PHP 的 SimpleXML 扩展构建一个 XML 文档，并且我正在向文件中添加一个令牌：

```
$doc->addChild('myToken'); 
```

这会生成（我所知道的）一个自关闭或单个标签：

```
<myToken/> 
```

但是，我正在与之通信的老化的 Web 服务正在绊倒自闭标签，所以我需要有一个单独的开始和结束标签：

```
<myToken></myToken> 
```

**问题是，除了通过preg_replace**运行生成的 XML 之外，我该怎么做？

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2008-11-03T20:06:43.500

从[SimpleXMLElement->__construct](http://www.php.net/manual/en/function.simplexml-element-construct.php)和[LibXML Predefined Constants](http://cz2.php.net/manual/en/libxml.constants.php)的文档中，我认为这应该有效：

```
<?php
$sxe = new SimpleXMLElement($someData, LIBXML_NOEMPTYTAG);

// some processing here

$out = $sxe->asXML();
?> 
```

试试看它是否有效。否则，恐怕是 preg_replace-land。

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2015-04-11T17:43:51.400

如果您将值设置为空值（即 null、空字符串），它将使用开/关括号。

```
$tag = '<SomeTagName/>';

echo "Tag: '$tag'\n\n";

$x = new SimpleXMLElement($tag);
echo "Autoclosed: {$x->asXML()}\n";

$x = new SimpleXMLElement($tag);
$x[0] = null;
echo "Null: {$x->asXML()}\n";

$x = new SimpleXMLElement($tag);
$x[0] = '';
echo "Empty: {$x->asXML()}\n"; 
```

参见示例：[http ://sandbox.onlinephpfunctions.com/code/10642a84dca5a50eba882a347f152fc480bc47b5](http://sandbox.onlinephpfunctions.com/code/10642a84dca5a50eba882a347f152fc480bc47b5)

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2014-07-30T12:07:41.660

目前，无法避免使用 LibXML 的自闭合标签。@Piskvor 提出的解决方案之一将不起作用：

[LIBXML_NOEMPTYTAG](http://us2.php.net/manual/en/libxml.constants.php)不适用于 simplexml，如下所述：

```
This option is currently just available in the DOMDocument::save and DOMDocument::saveXML functions. 
```

一个解决方法是使用[这个问题的答案](https://stackoverflow.com/questions/19629379/how-to-prevent-self-closing-tag-in-php-simplexml#answer-19630648)

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2015-06-24T13:46:44.563

可能不是最好的解决方案，但遇到了同样的问题，并通过使用 pre_replace 将所有自闭合标签更改为完整形式来解决它......

```
$xml_reader = new XMLReader;
$xml_reader->open($xml_file);

$data = preg_replace('/\<(\w+)\s*\/\s*\>/i', '<$1></$1>', $xml_reader->readOuterXML()); 
```

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2019-05-29T08:50:04.280

`LIBXML_NOEMPTYTAG`有效，但前提是您使用`DOMDocument::save`或`DOMDocument::saveXML`

```
$dom = dom_import_simplexml(SimpleXMLElement)->ownerDocument;
$dom->formatOutput = true;
$dom->save($save_path, LIBXML_NOEMPTYTAG); 
```

# c# - 如果找不到元素，我能否在 C# 中使用 XmlSerializer 反序列化失败？

> ID：259726
> 
> 赞同：15
> 
> 时间：2008-11-03T19:56:10.497
> 
> 标签：c#, xml, xml-serialization, .net-attributes

我正在使用 XmlSerializer 在 C# 中将对象写入和读取到 xml。我目前使用属性`XmlElement`并`XmlIgnore`操作对象的序列化。

如果我的 xml 文件缺少我需要的 xml 元素，我的对象仍然可以反序列化（xml -> 对象）。我如何指示（最好通过属性）某个字段是“必需的”？

这是我目前使用的示例方法：

```
[XmlElement(ElementName="numberOfWidgets")]
public int NumberThatIsRequired {
    set ...;
    get ...;
} 
```

我理想的解决方案是添加类似`XmlRequired`属性的东西。

此外，对于哪些属性可用于操纵 XmlSerializer 的行为，是否有很好的参考？

* * *

## 回答 #1

> 赞同：16
> 
> 时间：2008-11-03T21:10:23.327

我发现这样做的唯一方法是通过 XSD。您可以做的是在反序列化时进行验证：

```
static T Deserialize<T>(string xml, XmlSchemaSet schemas)
{
    //List<XmlSchemaException> exceptions = new List<XmlSchemaException>();
    ValidationEventHandler validationHandler = (s, e) =>
    {
        //you could alternatively catch all the exceptions
        //exceptions.Add(e.Exception);
        throw e.Exception;
    };

    XmlReaderSettings settings = new XmlReaderSettings();
    settings.Schemas.Add(schemas);
    settings.ValidationType = ValidationType.Schema;
    settings.ValidationEventHandler += validationHandler;

    XmlSerializer serializer = new XmlSerializer(typeof(T));
    using (StringReader sr = new StringReader(xml))
        using (XmlReader books = XmlReader.Create(sr, settings))
           return (T)serializer.Deserialize(books);
} 
```

* * *

## 回答 #2

> 赞同：5
> 
> 时间：2008-11-03T19:58:49.227

我得到了第二部分的答案：[“控制 XML 序列化的属性”](http://msdn.microsoft.com/en-us/library/83y7df3e(VS.71).aspx)。

还在研究第一部分...

编辑：我强烈怀疑你不能通过 XML 反序列化本身来做到这一点。我刚刚在包含必需属性的示例架构上运行 xsd.exe - 如果该属性被标记为可选，则它完全相同。如果有一种方法需要设置属性，我希望在这种情况下实现它。

我怀疑你基本上必须在反序列化之后验证你的对象树。对于那个很抱歉...

* * *

## 回答 #3

> 赞同：4
> 
> 时间：2008-11-04T05:10:25.183

出于可扩展性的原因，`XmlSerializer`在反序列化方面非常宽容；和之类`[DefaultValue]`的东西主要在*序列化*期间使用（例外是*，*在反序列化期间设置以及在序列化期间查询）。`ShouldSerialize{Foo}``{Foo}Specified`**`{Foo}Specified`**

 **像这样; 没有一种简单的方法可以做到这一点，除非您`IXmlSerializable`自己实施和做。Richard 展示了一个 xsd 选项，这也是一个选项。

# vb.net - 公开 COM vb.net 类的继承成员

> ID：259730
> 
> 赞同：0
> 
> 时间：2008-11-03T19:57:36.857
> 
> 标签：vb.net, inheritance, com

我有两个 vb.net 类：

```
Public MustInherit Class Class1
    Private m_sProperty1 As String = ""
    Public Property sProperty1() As String
        Get
            Return m_sProperty1
        End Get
        Set(ByVal value As String)
            m_sProperty1 = value
        End Set
    End Property
End Class

<ComClass("classid","interfaceid","eventid")> _
Public Class Class2
    Inherits Class1

    Private m_sProperty2 As String = ""
    Public Property sProperty2() As String
        Get
            Return m_sProperty2
        End Get
        Set(ByVal value As String)
            m_sProperty2 = value
        End Set
    End Property
End Class 
```

当我通过VB6引用编译好的DLL时，Class2只暴露了sProperty2。如何通过 COM 访问基类 (sProperty1) 的继承属性？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-02-13T16:26:05.060

这似乎回答了你的问题：

**导出继承层次结构**

托管类层次结构在作为 COM 对象公开时会变平。例如，如果您定义一个带有成员的基类，然后在作为 COM 对象公开的派生类中继承该基类，则在 COM 对象中使用派生类的客户端将无法使用继承的成员. 基类成员只能作为基类的实例从 COM 对象访问，并且仅当基类也被创建为 COM 对象时。

取自此处： [互操作性故障排除](http://msdn.microsoft.com/en-us/library/8877bdk6(VS.80).aspx)

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-02-13T16:05:33.923

我会猜测一下，因为我在 .NET 上的速度不够快

我想您的声明正在使用您的 Class2 的公共方法并从中创建一个 COM 接口。它只会采用 Class2 上的方法（和属性）而不是继承的方法（否则您将获得所有公共方法一直到您的基类）。

解决方案可能是将 Class1 也声明为 COM 类（可以将其标记为私有），然后指定 Class2 的 COM interfaceid 来自 Class1 的 COM interfaceid。

像这样的东西应该可以解决问题。

# javascript - 仅匹配 Google 网址的 JavaScript 函数

> ID：259751
> 
> 赞同：2
> 
> 时间：2008-11-03T20:04:52.023
> 
> 标签：javascript, greasemonkey

需要这样的功能：

```
function isGoogleURL(url) { ... } 
```

返回真 iff URL 属于 Google。没有误报；没有假阴性。

幸运的是有[这个](http://www.google.com/supported_domains)作为参考：

> .google.com .google.ad .google.ae .google.com.af .google.com.ag .google.com.ai .google.am .google.it.ao .google.com.ar .google.as .google.at .google.com.au .google.az .google.ba .google.com.bd .google.be .google.bg .google.com.bh .google.bi .google.com.bn .google .com.bo .google.com.br .google.bs .google.co.bw .google.com.by .google.com.bz .google.ca .google.cd .google.cg .google.ch .google .ci .google.co.ck .google.cl .google.cn .google.com.co .google.co.cr .google.com.cu .google.cz .google.de .google.dj .google.dk .google.dm .google.com.do .google.dz .google.com.ec .google.ee .google.com.eg .google.es .google.com.et .google.fi .google.com.fj .google.fm .google.fr .google.ge .google.gg .google.com.gh .google.com.gi .google.gl .google.gm .google.gp .google.gr .google.com.gt .google.gy .google.com.hk .google.hn .google.hr .google.ht .google.hu .google.co.id .google.ie .google.co.il .google.im .google.co.in .google.is .google.it .google.je .google.com.jm .google.jo .google。 co.jp .google.co.ke .google.com.kh .google.ki .google.kg .google.co.kr .google.kz .google.la .google.li .google.lk .google.co. ls .google.lt .google.lu .google.lv .google.com.ly .google.co.ma .google.md .google.mn .google.ms .google.com.mt .google.mu .google。 mv .google.mw .google.com.mx .google.com.my .google.co.mz .google.com.na .google.com.nf .google.com.ng .google.com.ni .google. nl .google.no .google.com.np .google.nr .google.nu .google.co.nz .google.com.om .google.com.pa .google.com.pe .google.com.ph . google.com.pk .google.pl .google.pn .google.com.pr .google.pt .google.com.py .google.com.qa .google.ro .google.ru .google.rw .google。 com.sa .google.com.sb .google.sc .google.se .google.com.sg .google.sh .google.si 。google.sk .google.sn .google.sm .google.st .google.com.sv .google.co.th .google.com.tj .google.tk .google.tl .google.tm .google.to . google.com.tr .google.tt .google.com.tw .google.co.tz .google.com.ua .google.co.ug .google.co.uk .google.com.uy .google.co. uz .google.com.vc .google.co.ve .google.vg .google.co.vi .google.com.vn .google.vu .google.ws .google.rs .google.co.za .google. co.zm .google.co.zw .google.cat

任何想法如何优雅地做到这一点？

**一些说明：**

*   我需要这个用于我编写的目前仅适用于 google.com（并且也应该适用于所有其他 TLD）的greasemonkey 脚本。[这](http://userscripts.org/scripts/show/6415)是脚本（它修改了 Google Reader 以更好地在宽屏幕上工作）。
*   它应该适用于属于上述域（而不是 blogger.com 等）的 URL。

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2008-11-16T18:36:04.547

这是 Prestaul 答案的更新版本，它解决了我在评论中提到的两个问题。

```
var GOOGLE_DOMAINS = ([
    '.google.com',
    '.google.ad',
    '.google.ae',
    '.google.com.af',
    '.google.com.ag',
    '.google.com.ai',
    '.google.am',
    '.google.it.ao',
    '.google.com.ar',
    '.google.as',
    '.google.at',
    '.google.com.au',
    '.google.az',
    '.google.ba',
    '.google.com.bd'
]).join('\n');

function isGoogleUrl(url) {
    // get the 2nd level domain from the url
    var domain = /^https?:\/\/[^\///]*(google\.[^\/\\]+)\//i.exec(url);
    if(!domain) return false;

    domain = '.'+domain[1];
    // create a regex to check to see if the domain is supported
    var re = new RegExp('^' + domain.replace(/\./g, '\\.') + '$', 'mi');
    return re.test(GOOGLE_DOMAINS);
}

alert(isGoogleUrl('http://www.google.ba/the/page.html')); // true
alert(isGoogleUrl('http://some_mal_site.com/http://www.google.ba/')); // false
alert(isGoogleUrl('https://google.com.au/')); // true
alert(isGoogleUrl('http://www.google.com.some_mal_site.com/')); // false
alert(isGoogleUrl('http://yahoo.com/')); // false 
```

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2008-11-16T19:30:53.267

除了“google.it.ao”和“google.com”之外，所有域都以“google.xx”、“google.co.xx”或“google.com.xx”结尾，所以如果你只看一下域，这个正则表达式应该适用于大多数情况（它并不完美，但它接受所有列出的域，并拒绝大多数其他恰好包含“google”的有效域）：

```
/^(\w+\.)*google\.((com\.|co\.|it\.)?([a-z]{2})|com)$/i 
```

作为一个函数，你可以做这样的事情：

```
function isGoogleUrl(url) {
    url = url.replace(/^https?:\/\//i, ''); // Strip "http://" from the beginning
    url = url.replace(/\/.*/, ''); // Strip off the path
    return /^(\w+\.)*google\.((com\.|co\.|it\.)?([a-z]{2})|com)$/i.test(url);
} 
```

如果您使用，您可以简化它`window.location.hostname`：

```
function isGoogleUrl() {
    return /^(\w+\.)*google\.((com\.|co\.|it\.)?([a-z]{2})|com)$/i.test(window.location.hostname);
} 
```

这应该允许误报的唯一方法是如果有“google.（一些其他 TLD）”。例如，“google.tv”不在列表中（它重定向到 google.com），但它会通过。

**编辑：**就像 Wimmel 指出的那样，它也接受未列出的无效域，如“google.com.fr”。它基本上会接受任何“google.whatever”域名。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2008-11-03T20:11:06.143

您是否将其他 Google 资产视为“属于 Google”？FeedBurner、Blogger 等？

能问一下这样做的目的是什么吗？可能有更好的方法来做你想做的事……如果合理的话，我可以在内部为你询问。

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2008-11-03T20:27:53.770

如果您不需要 100% 准确的测试，这个简单的正则表达式将适用于您在上面发布的所有域：

```
"(http://)?([\w]+)?\.google\.([\w]{2,3})" 
```

只是测试“.google”的存在。在大多数情况下就足够了，尽管在 url 中添加“google”域很容易被愚弄（虽然不是那么容易，也不是很快完成）。

或者只是等待谷歌购买自己的谷歌TLD。

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2008-11-03T20:52:56.263

我同意您可能不应该这样做...但是，如果您要这样做（并且您不满足于先前提供的仅检查类似 google 的模式的解决方案），那么这就是我的方式接近它：

```
var GOOGLE_DOMAINS = ([
    '.google.com',
    '.google.ad',
    '.google.ae',
    '.google.com.af',
    '.google.com.ag',
    '.google.com.ai',
    '.google.am',
    '.google.it.ao',
    '.google.com.ar',
    '.google.as',
    '.google.at',
    '.google.com.au',
    '.google.az',
    '.google.ba',
    '.google.com.bd'
]).join('\n');

function isGoogleUrl(url) {
    var url = 'http://www.google.ba/the/page.html';

    // get the domain from the url
    var domain = /\.google\.[^\/\\]+/i.exec(url) + '';
    if(!domain) return false;

    // create a regex to check to see if the domain is supported
    var re = new RegExp('^' + domain.replace(/\./g, '\\.') + '$', 'mi');
    return re.test(GOOGLE_DOMAINS);
} 
```

这会根据您的 url 的域创建一个正则表达式，并使用它来测试域列表。

注意：该`GOOGLE_DOMAINS`变量只是一个字符串，其中包含从您发布的 url 返回的内容。您无法通过 AJAX 或 iframe 检索该字符串，因为您无法跨域发出此类请求。您必须对其进行硬编码或在服务器端发出请求以检索该列表。

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2008-11-03T20:12:11.040

我不会做这个客户端。

Google 域列表不会经常更改，因此您可以在服务器端存储一个列表，然后动态生成 .js 来检查它。

* * *

## 回答 #7

> 赞同：0
> 
> 时间：2008-11-03T20:15:12.143

正则表达式可能是您需要的。一个例子是：

```
<script>
var elem = document.getElementById("a");
var regex = new RegExp("(http://)?(www\\.)?google\\.com");

elem.innerHTML = regex.test(elem.innerHTML);
</script> 
```

这将获取 span 元素“a”的内容，如果 google.com 将其更改为“true”，否则将其更改为“false”。请注意，它不考虑所有其他 URL（尽管可以很容易地修改正则表达式来这样做），例如，“pages.google.com”将不匹配。

此外，您的网址都有一个“。” 在他们之前（“.google.com”而不是“google.com”）。这有什么原因还是只是一个错误？

* * *

## 回答 #8

> 赞同：0
> 
> 时间：2008-11-03T20:45:37.293

您可以使用正则表达式，例如....

```
^https?://[-A-Za-z0-9\.]+(\.google\.com|\.google\.ad|\.google\.ae|\.google\.com\.af|\.google\.com\.ag|\.google\.com\.ai|\.google\.am|\.google\.it\.ao|\.google\.com\.ar|\.google\.as|\.google\.at|\.google\.com\.au|\.google\.az|\.google\.ba|\.google\.com\.bd|\.google\.be|\.google\.bg|\.google\.com\.bh|\.google\.bi|\.google\.com\.bn|\.google\.com\.bo|\.google\.com\.br|\.google\.bs|\.google\.co\.bw|\.google\.com\.by|\.google\.com\.bz|\.google\.ca|\.google\.cd|\.google\.cg|\.google\.ch|\.google\.ci|\.google\.co\.ck|\.google\.cl|\.google\.cn|\.google\.com\.co|\.google\.co\.cr|\.google\.com\.cu|\.google\.cz|\.google\.de|\.google\.dj|\.google\.dk|\.google\.dm|\.google\.com\.do|\.google\.dz|\.google\.com\.ec|\.google\.ee|\.google\.com\.eg|\.google\.es|\.google\.com\.et|\.google\.fi|\.google\.com\.fj|\.google\.fm|\.google\.fr|\.google\.ge|\.google\.gg|\.google\.com\.gh|\.google\.com\.gi|\.google\.gl|\.google\.gm|\.google\.gp|\.google\.gr|\.google\.com\.gt|\.google\.gy|\.google\.com\.hk|\.google\.hn|\.google\.hr|\.google\.ht|\.google\.hu|\.google\.co\.id|\.google\.ie|\.google\.co\.il|\.google\.im|\.google\.co\.in|\.google\.is|\.google\.it|\.google\.je|\.google\.com\.jm|\.google\.jo|\.google\.co\.jp|\.google\.co\.ke|\.google\.com\.kh|\.google\.ki|\.google\.kg|\.google\.co\.kr|\.google\.kz|\.google\.la|\.google\.li|\.google\.lk|\.google\.co\.ls|\.google\.lt|\.google\.lu|\.google\.lv|\.google\.com\.ly|\.google\.co\.ma|\.google\.md|\.google\.mn|\.google\.ms|\.google\.com\.mt|\.google\.mu|\.google\.mv|\.google\.mw|\.google\.com\.mx|\.google\.com\.my|\.google\.co\.mz|\.google\.com\.na|\.google\.com\.nf|\.google\.com\.ng|\.google\.com\.ni|\.google\.nl|\.google\.no|\.google\.com\.np|\.google\.nr|\.google\.nu|\.google\.co\.nz|\.google\.com\.om|\.google\.com\.pa|\.google\.com\.pe|\.google\.com\.ph|\.google\.com\.pk|\.google\.pl|\.google\.pn|\.google\.com\.pr|\.google\.pt|\.google\.com\.py|\.google\.com\.qa|\.google\.ro|\.google\.ru|\.google\.rw|\.google\.com\.sa|\.google\.com\.sb|\.google\.sc|\.google\.se|\.google\.com\.sg|\.google\.sh|\.google\.si|\.google\.sk|\.google\.sn|\.google\.sm|\.google\.st|\.google\.com\.sv|\.google\.co\.th|\.google\.com\.tj|\.google\.tk|\.google\.tl|\.google\.tm|\.google\.to|\.google\.com\.tr|\.google\.tt|\.google\.com\.tw|\.google\.co\.tz|\.google\.com\.ua|\.google\.co\.ug|\.google\.co\.uk|\.google\.com\.uy|\.google\.co\.uz|\.google\.com\.vc|\.google\.co\.ve|\.google\.vg|\.google\.co\.vi|\.google\.com\.vn|\.google\.vu|\.google\.ws|\.google\.rs|\.google\.co\.za|\.google\.co\.zm|\.google\.co\.zw|\.google\.cat) 
```

我想用 JavaScript（或您选择的任何语言）从数组或其他数据集中生成它会相对容易。

* * *

## 回答 #9

> 赞同：-1
> 
> 时间：2008-11-03T20:13:59.697

如果没有正则表达式来单独匹配每个 TLD，就没有真正的“优雅的方式”。

# html - 内部 div 超出外部 div 边界

> ID：259753
> 
> 赞同：7
> 
> 时间：2008-11-03T20:05:16.797
> 
> 标签：html, css

[在此代码示例（也在http://www.toad-software.com/test.html](http://www.toad-software.com/test.html) ）中，我无法让内部 div（带有 Hello World）适合“盒子”div 。

尽管 body 设置为 100%，但不会包含内部 div！这是一个较大项目的测试用例，其中可变宽度表超出了其容器的边界。表格将位于内部 div 中，容器将位于“盒子”中。

```
<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN" "http://www.w3.org/TR/html4/loose.dtd">
<html>
<head>
    <style type="text/css">
        /*html { width: 100%; height: 100%; position: relative; background: #c0c0c0; }
        body { position: absolute; width: 100%; height: 100%; background: #f9f9f9; }*/

        body,
        html 
        { 
            margin: 0;
            padding: 0;
        }

        body
        {
            width: 100%;
        }

        div.box
        {
            padding: 10px;
            background: #ff33ff;
        }

    </style>
</head>
<body>
    <div class="box">
        <div style="width: 1500px; height: 900px; background: #f12;">Hello World</div>
    </div>
</body>
</html> 
```

* * *

## 回答 #1

> 赞同：10
> 
> 时间：2008-11-03T20:09:44.540

添加`overflow:hidden;`到容器中`<div>`

* * *

## 回答 #2

> 赞同：8
> 
> 时间：2008-11-04T03:39:28.453

body 元素上的 100% 宽度与视口有关，这就是为什么滚动时背景颜色会被剪切的原因。将您的身体宽度设置为 1520px 以包含包含的 div 或添加另一个 div 并执行以下操作：

```
div.box { width: 100px; overflow: auto; } 
```

然而，作为一个警告，沿着水平滚动的道路前进对于 css 和用户体验中的第一个项目来说是一个坏主意。

# javascript - AJAX - 我需要在服务器端返回一个完整的 HTML 文档吗？

> ID：259759
> 
> 赞同：3
> 
> 时间：2008-11-03T20:09:23.073
> 
> 标签：javascript, jquery, ajax, asp-classic

我正在使用 JQuery 将 AJAX 发布到另一个 ASP 页面。我需要这个 ASP 页面来返回一个完整的 html 页面吗？或者我可以让它发回一个值（我只需要一个状态）。这是我的功能。

```
 $.ajax({
      url: "X.asp",
      cache: false,
      type:  "POST",
      data:  queryString,
      success: function(html){
        $('#x_'+Num).append(html);
      }
    }); 
```

* * *

## 回答 #1

> 赞同：14
> 
> 时间：2008-11-03T20:15:30.973

如果它只是您需要的一个简单值，我会简单地使用 Json（JQuery 有一个专门的方法：[$.getJSON()](http://docs.jquery.com/Ajax/jQuery.getJSON)）。

所以不，你不需要你的 ASP 页面来返回一个完整的 html 页面，只需要简单的 JSON 表示法中的值。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2008-11-03T20:21:09.090

您可以返回任何您想要的内容（甚至是单个字符），但如果您不想返回 HTML，请记住将页面 X.asp 的内容类型更改为 ContentType="text/plain"。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2008-11-03T21:08:25.873

好吧，AJAX 的重点是恕我直言，您不需要返回整个页面。服务器只发送您需要的简单答案。

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2008-11-07T20:52:27.980

您可以从后端返回任何内容，我个人更喜欢 JSON，但您必须在 $.ajax 选项中指定 dataType 属性

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2008-11-10T22:08:23.207

使用 AJAX，您可以返回任何内容，甚至是二进制数据。尽管它是为 XML 设计的，但您可以将它用于任何可以通过 Web 服务器传输的内容。但是，HTTP 请求很昂贵，所以不要滥用它们！

# c# - 在另一个线程中更改 DataGridViewRow 属性

> ID：259763
> 
> 赞同：1
> 
> 时间：2008-11-03T20:10:20.717
> 
> 标签：c#, multithreading, datagridview

好的，所以我在后台线程中将 DataGridView 绑定到 BindingSource，而“请稍候”模型窗口让用户感到愉悦。没问题。

但是，我需要根据行的 databounditem 类型更改一些行的背景颜色。像这样：

```
for (int i = 0; i < dgItemMaster.Rows.Count; i++)
{
  if (dgItemMaster.Rows[i].DataBoundItem.GetType().Name == "Package")
  {
   dgItemMaster.Rows[i].DefaultCellStyle.BackColor = Color.PowderBlue;                    
  }
} 
```

以编程方式我可以做到这一点，但它有足够的行，它会在迭代行时锁定 GUI。我正在寻找处理这种情况的最佳方法的想法。

这就是我现在正在做的事情：

```
void worker_RunWorkerCompleted(object sender, RunWorkerCompletedEventArgs e)
        {
            dgItemMaster.DataSource = products;
            dgItemMaster.BeginInvoke((Action)(() =>
            {
                for (int i = 0; i < dgItemMaster.Rows.Count; i++)
                {
                    if (dgItemMaster.Rows[i].DataBoundItem.GetType().Name == "Package")
                    {
                        dgItemMaster.Rows[i].DefaultCellStyle.BackColor = Color.PowderBlue;
                    }
                    else if (dgItemMaster.Rows[i].DataBoundItem.GetType().Name == "PackageKit")
                    {
                        dgItemMaster.Rows[i].DefaultCellStyle.BackColor = Color.Pink;
                    }
                }
            }));
        } 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2008-11-03T21:12:07.877

我会尝试运行更改 RowAdded 事件中的背景颜色的代码，这将在每一行添加到网格时触发，无需再次遍历整个列表。

[http://msdn.microsoft.com/en-us/library/system.windows.forms.datagridview.rowsadded.aspx](http://msdn.microsoft.com/en-us/library/system.windows.forms.datagridview.rowsadded.aspx)

祝你好运。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2008-11-04T05:04:29.627

这里的数据量是多少？要让它挂起 UI，它必须是非常重要的。一个极端的答案是切换到[虚拟模式](http://msdn.microsoft.com/en-us/library/2b177d6d.aspx)——但这是很多工作。

如果您只是不想挂起 UI，也许只需立即执行前*x* (20?50?) 行，然后分批执行其余的 - 本质上是 emulating ，只是没有...`DoEvents`的代码气味`DoEvents`

（未经测试）

```
 int startIndex = 0;
        Action action = null;
        action = () =>
        {   // only processes a batch of 50 rows, then calls BeginInvoke
            // to schedule the next batch
            int endIndex = startIndex + 50;
            if (endIndex > dgItemMaster.Rows.Count) endIndex = dgItemMaster.Rows.Count;

            if (startIndex > endIndex)
            {
                for (int i = startIndex; i < endIndex; i++)
                {
                    // process row i
                }

                startIndex = endIndex;
                this.BeginInvoke(action); // next iteration
            }                
        };

        // kick it off
        this.BeginInvoke(action); 
```

# asp.net - 使用 ASP.Net 进行客户端图像缓存

> ID：259769
> 
> 赞同：6
> 
> 时间：2008-11-03T20:11:12.697
> 
> 标签：asp.net, caching, image

这真的是两个问题，第一，浏览器是默认在客户端缓存图片还是服务器必须表明可以缓存？

其次，鉴于我无法访问 IIS，我可以在 ASP 应用程序中做些什么来改进客户端的图像缓存。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2008-11-03T20:14:20.770

我没有用过这个，但你可能有兴趣看看[在 asp.net 中缓存图像](http://www.codeproject.com/KB/aspnet/CachingImagesInASPNET.aspx)

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2008-11-03T20:32:13.950

编写良好的浏览器将使用与图像关联的 HTTP 标头来确定是否应缓存图像以及应缓存多长时间。

[查看HTTP 1.1 规范](http://www.w3.org/Protocols/rfc2616/rfc2616-sec14.html)中的 Cache-Control、Pragma 和 Expires 标头。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2008-11-03T20:22:04.860

[这](http://www.codeproject.com/KB/aspnet/CachingImagesInASPNET.aspx)是一个有用的链接

您是自己生成图像，还是它们是静态文件

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2008-11-03T20:32:33.433

> 这真的是两个问题，第一，浏览器是默认在客户端缓存图片还是服务器必须表明可以缓存？

浏览器缓存他们被允许的内容。您可以在 IIS 中全局设置这些标头，但您几乎总是可以从应用程序中覆盖它们。除非某些 ssl 加速器或防火墙覆盖它们..

> 其次，鉴于我无法访问 IIS，我可以在 ASP 应用程序中做些什么来改进客户端的图像缓存。

看看 System.Web.HttpContext.Current.Response.Cache

# python - Python 2.5 是否包含一个用于本地转换 XML 文档的包？

> ID：259782
> 
> 赞同：3
> 
> 时间：2008-11-03T20:14:00.443
> 
> 标签：python, xml, xslt, elementtree

在我的 Python 应用程序中，我有一个 XML 文档，我想使用我的 XSL 文件对其进行转换。我目前正在使用 xml.etree 来生成 XML 文档，但是我在 Python 2.5 中没有找到任何可以让我本地转换我的 XML 文档的东西。

我已经找到了一个可以执行转换的库 ( [libxslt](http://xmlsoft.org/XSLT/) )，但我认为 Python 会有一个可以达到预期结果的本机库。

有什么想法吗？

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2008-11-03T22:03:08.913

如果您安装了 libxml2 和 libxslt，那么还要安装[lxml](http://codespeak.net/lxml/)。它为 libxml2 和 libxslt 提供了一个很好的、易于使用的绑定，并且它还实现了 ElementTree API。

libxml2/libxslt 也带有它们自己的、低级别的 Python 绑定，但 lxml 更直接和 Python 化，而且它似乎也有很好的性能。

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2008-11-03T20:22:57.180

Python 2.5 中没有 XSLT 处理器。

# linux - timer_create、timer_settime等定时器相关函数需要链接哪些库

> ID：259784
> 
> 赞同：19
> 
> 时间：2008-11-03T20:14:17.840
> 
> 标签：linux, timer, posix

在 Linux 上编译调用 POSIX 计时器函数（例如：timer_create、timer_settime）的程序会返回如下错误：

```
在函数“foo”中：
timer.c:(.text+0xbb): undefined reference to `timer_create'
timer.c:(.text+0x187): undefined reference to `timer_settime'
collect2: ld 返回 1 个退出状态

```

我需要链接哪个库？

* * *

## 回答 #1

> 赞同：29
> 
> 时间：2009-02-16T08:49:53.263

`-lrt`用选项编译它。它将被编译。

* * *

## 回答 #2

> 赞同：7
> 
> 时间：2016-05-20T14:27:31.083

你可以试试`gcc -o mytemer mytimer.c -lrt` 它对我有用，但不是按这个顺序 `gcc -lrt mytimer.c -o mytimer`

* * *

## 回答 #3

> 赞同：4
> 
> 时间：2012-11-24T14:17:14.997

-lrt 强制链接，但您必须先安装实时库，然后才能链接到它。大多数时候它是自动包含的，但如果没有，您需要使用 apt-get 安装实时库。然后，您将能够在以下（或类似）位置链接到它：

`/lib/i386-linux-gnu/librt.so.1`

如果您正在使用代码块并且由于某种原因 -lrt 不包含它，您可以使用以下菜单序列添加上述库路径和文件名：

`Project->Build Options->Linker Settings->Link Libraries->Add`

* * *

## 回答 #4

> 赞同：3
> 
> 时间：2008-11-03T20:15:25.107

这应该记录在手册页中。鉴于它不是 add `-lrt`。

* * *

## 回答 #5

> 赞同：2
> 
> 时间：2009-03-23T11:31:39.323

请尝试以下方法：

```
gcc -lrt 
```

# sql - 参数化的 CREATE VIEW 可能吗？

> ID：259798
> 
> 赞同：0
> 
> 时间：2008-11-03T20:17:00.640
> 
> 标签：sql, sql-server-2005, parameters, views

我有一个（SQL Server 2005）数据库，我想在其中动态创建视图。在我的代码中，我正在构建一个 CREATE VIEW 语句，但我可以让它工作的唯一方法是构建整个查询字符串并运行它。我想使用参数，但是这个：

```
SqlCommand cmd = new SqlCommand("CREATE VIEW @name AS SELECT @body");
cmd.Parameters.AddWithValue("@name", "foo");
cmd.Parameters.AddWithValue("@body", "* from bar"); 
```

告诉我“在关键字 VIEW 附近”（大概是“@name”）有一个错误——不用说`"CREATE VIEW foo AS SELECT * FROM bar"`像冠军一样工作。

这是不可能的吗？如果没有，是否有更好的方法在运行 CREATE 语句之前清理输入？在某些情况下，查询正文可能有用户输入，如果有某种方式我可以说“将其视为单个 select 语句的正文”，我会感觉更安全。也许我的要求太奇怪了？

* * *

跟进 11 月 4 日：好的，是的，我想要的有点像 SQL 注入，但我想至少最小化（如果不是完全删除）运行此命令并删除表或其他东西的选项. 当然，正在运行的用户首先没有删除任何表的权限，但我想你明白了。我很想有一种说法，实际上，`"This statement will not alter any existing data in any way{ ... }"`。

**它现在的编码方式是像friol**的答案那样进行字符串连接，但这根本没有净化。如果我至少可以清除可疑字符，我会感觉更好，例如；或者——或者你有什么。我希望可能有一个库函数来为我做擦洗，或者类似的东西。

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2008-11-03T20:37:03.283

参数不仅仅是字符串替换。这就是为什么您的代码不起作用的原因。

就像你做不到

sql = "select * from orders where orders_id in (?)"

并将“1,2,3,5”作为参数传递。

参数经过类型检查，只能包含标量值 IIRC。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2008-11-03T20:20:27.623

也许我没有正确理解它，但是阻止你做的是什么：

```
viewname="foo";
viewwhere="* from bar";

SqlCommand cmd = new SqlCommand("CREATE VIEW "+viewname+" AS SELECT "+viewwhere); 
```

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2008-11-03T20:44:39.993

SQL注入。你想要它，这就是重点。你应该连接这些东西。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2008-11-03T20:41:51.777

在我看来，您正在尝试使用参数创建动态查询，这不是参数化查询的工作方式。它们不会简单地连接到字符串中。

如果您要阻止的是 SQL 注入，那么我要做的是验证视图名称是否仅包含字母数字且不包含 T-SQL 关键字。我也会非常小心地动态创建身体。

# c# - 是否存在指示非法对象状态的内置 .NET 异常？

> ID：259800
> 
> 赞同：62
> 
> 时间：2008-11-03T20:17:55.693
> 
> 标签：c#, .net, exception

如果遇到非法状态，我应该抛出什么异常——例如，一个只应该被调用一次的初始化方法被第二次调用？我真的没有看到任何有意义的内置异常。这似乎应该在框架中 - 我没有在正确的位置戳吗？

* * *

## 回答 #1

> 赞同：74
> 
> 时间：2008-11-03T20:19:29.777

[InvalidOperationException](http://msdn.microsoft.com/en-us/library/system.invalidoperationexception.aspx)也许？

> 当方法调用对于对象的当前状态无效时引发的异常。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2018-07-27T10:38:58.573

一般来说，您应该以*不会达到无效状态的方式对*您的对象进行编程。如果您发现您的对象处于无效状态，那么您应该抛出一个`SystemException`或*直接*从`SystemException`. *这是标题*中问题的答案。

但是，您在问题文本中*提到*的例外情况是*您的对象的用户*将其推入非法状态。在这种情况下`InvalidOperationException`，抛出正确的异常，如[前面的答案](https://stackoverflow.com/a/259805/589259)所示。这将避免您的对象*进入*非法状态。

不用说，您需要*记录*您的对象应该如何使用。如果您的对象具有较长的预期寿命，或者如果它在不同对象之间使用/共享，那么用户能够请求当前状态并实现`ToString`以文本形式检索当前状态是很好的，例如在调试中环境/日志。

* * *

## 回答 #3

> 赞同：-3
> 
> 时间：2008-11-03T20:26:33.617

如果我会说 System.InvalidProgramException 最接近你想要的。抛出自定义异常有什么问题？

# c# - 跨 java 和 .net 进行通信的最佳消息传递服务器是什么？

> ID：259801
> 
> 赞同：0
> 
> 时间：2008-11-03T20:17:56.037
> 
> 标签：c#, jboss

我们一直在使用[jbossmq](http://www.jboss.org/community/docs/DOC-10525)和[csil](http://csil.sourceforge.net)。该实施已在生产中成功实施了 6 年，但我想知道是否有更好的东西可用。

一个问题是每个客户端模型的 jbossmq 线程，以及预定的生命周期结束。另一个是 csil 缺乏对 JBossMessaging 的支持，这是 JBoss 的最新 JMS 实现。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2008-11-03T20:27:15.177

您应该查看带有 NMS 客户端的 ActiveMQ 后端。我没有任何问题。我不能保证它，因为我使用它的生产系统不是高容量的。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-01-04T07:20:33.827

我建议你看看[IKVM](http://www.ikvm.net/ "IKVM")。它是一个从 java 字节码 (jars) 生成 .NET 程序集的编译器。我们使用由 IKVM 创建的本机 JBoss 程序集取得了良好的成功、稳定性和性能，并且我们实现了通常的客户端协议（RMI、JMS、EJB），但实际上并不是新的 JBossMessaging。无论如何，实施这种方法，您可以选择最适合您的远程协议，而不用担心兼容性，

//尼古拉斯

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2009-06-22T23:20:45.100

用于从 Java 编译 .NET 的 IKVM 看起来很有趣。

对于 .NET 消息传递，请查看[RabbitMQ](http://www.rabbitmq.com/)。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2009-10-31T19:21:34.127

我是[jni4net](http://jni4net.sf.net/)的作者，它是 JVM 和 CLR 之间的开源进程内桥梁。它建立在 JNI 和 PInvoke 之上。无需 C/C++ 代码。我希望它会帮助你。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2012-09-04T14:18:09.677

我建议你看看爱思华宝。您可以下载免费试用版，看看它是如何为您工作的。

# sql-server-2005 - T-SQL 存储过程执行是“原子的”吗？

> ID：259803
> 
> 赞同：18
> 
> 时间：2008-11-03T20:18:24.477
> 
> 标签：sql-server-2005, tsql, sql-server-2008, stored-procedures

假设我有一个看起来像这样的简单存储过程（注意：这只是一个示例，不是实际过程）：

```
CREATE PROCEDURE incrementCounter AS

DECLARE @current int
SET @current = (select CounterColumn from MyTable) + 1

UPDATE
    MyTable
SET
    CounterColumn = current
GO 
```

我们假设我有一个名为“myTable”的表，其中包含一行，“CounterColumn”包含我们当前的计数。

这个存储过程可以同时执行多次吗？

即这可能吗：

我两次调用'incrementCounter'。调用 A 到达设置“当前”变量的位置（假设它是 5）。调用 B 到达设置“当前”变量（也为 5）的位置。调用 A 完成执行，然后调用 B 完成。最后，表应该包含值 6，但由于执行重叠，反而包含 5

* * *

## 回答 #1

> 赞同：13
> 
> 时间：2008-11-03T20:27:07.843

这是针对 SQL Server 的。

每个语句都是原子的，但如果您希望存储过程是原子的（或一般的任何语句序列），则需要用显式包围语句

BEGIN TRANSACTION
语句 ...
语句 ...
COMMIT TRANSACTION

（通常简称为 BEGIN TRAN 和 END TRAN。）

当然，根据同时发生的其他情况，有很多方法可以解决锁定问题，因此您可能需要一种处理失败事务的策略。（对所有可能导致锁定的情况的完整讨论，无论您如何设计这个特定的 SP，都超出了问题的范围。）但是由于原子性，它们仍然可以重新提交。根据我的经验，您可能会没事，而无需了解您的交易量和数据库上的其他活动。请原谅我说的很明显。

与流行的误解相反，这将在您使用默认事务级别设置的情况下起作用。

* * *

## 回答 #2

> 赞同：12
> 
> 时间：2008-11-03T20:58:19.090

除了将代码放在 a`BEGIN TRANSACTION`和之间之外`END TRANSACTION`，您还需要确保正确设置了事务隔离级别。

例如，`SERIALIZABLE`隔离级别将防止代码并发运行时丢失更新，但`READ COMMITTED`（SQL Server Management Studio 中的默认设置）不会。

```
SET TRANSACTION ISOLATION LEVEL SERIALIZABLE 
```

正如其他人已经提到的，在确保一致性的同时，这可能会导致阻塞和死锁，因此在实践中可能不是最佳解决方案。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2013-09-15T04:59:00.233

我用这个方法

```
CREATE PROCEDURE incrementCounter
AS

DECLARE @current int

UPDATE MyTable
SET
  @current = CounterColumn = CounterColumn + 1

Return @current 
```

此过程一次执行所有两个命令，并且与其他事务隔离。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2010-01-19T03:52:15.337

也许我对你的例子读得太多了（你的实际情况可能要复杂得多），但你为什么不在一个语句中这样做呢？

```
CREATE PROCEDURE incrementCounter AS

UPDATE
    MyTable
SET
    CounterColumn = CounterColumn + 1

GO 
```

这样，它是自动原子的，如果同时执行两个更新，它们将始终由 SQL Server 排序，以避免您描述的冲突。但是，如果您的实际情况要复杂得多，那么将其包装在事务中是最好的方法。

但是，如果另一个进程启用了“不太安全”的隔离级别（例如允许脏读或不可重复读的隔离级别），那么我认为事务不会对此进行保护，因为另一个进程可以看到部分更新选择允许不安全读取的数据。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2015-02-08T10:02:24.453

对您的问题的简短回答是肯定的，它可以而且会很短。如果要阻止存储过程的并发执行，请启动事务并在存储过程的每次执行中更新相同的数据，然后再继续在过程中执行任何工作。

```
CREATE PROCEDURE ..
BEGIN TRANSACTION
UPDATE mylock SET ref = ref + 1
... 
```

这将迫使其他并发执行等待轮到它们，因为在其他事务完成并解除关联的更新锁之前，它们将无法更改“ref”值。

一般来说，假设任何和所有 SELECT 查询的结果在执行**之前**都是陈旧的，这是一个好主意。使用“重”隔离级别来解决这个不幸的现实严重限制了可伸缩性。以一种对您期望在更新期间存在的系统状态做出乐观假设的方式来构建更改要好得多，因此当您的假设失败时，您可以稍后再试并希望获得更好的结果。例如：

```
UPDATE
    MyTable
SET
    CounterColumn = current 
WHERE CounterColumn = current - 1 
```

使用添加了 WHERE 子句的示例，如果对其当前状态的假设失败，则此更新不会影响任何行。检查@@ROWCOUNT 以测试行数和回滚或其他一些适当的操作，但它与预期结果不同。

# sql-server-ce - 媒体支持上的 ASP.NET 3.5 Web 应用程序 (CD-ROM)

> ID：259817
> 
> 赞同：0
> 
> 时间：2008-11-03T20:22:06.217
> 
> 标签：sql-server-ce, cassini

我们有一个相当复杂的 Web 应用程序 (.NET 3.5)，需要从 CD-ROM（或 DVD，或 USB 密钥）启动。

我正在考虑将 Cassini 和 SqlCe 用于数据库（我们使用 LinqToSql 进行数据访问，所以我认为这是不重写整个数据访问类的唯一选择）。有没有人做过这样的事情？

注释： http: [//www.microsoft.com/belux/msdn/nl/community/columns/desmet/hostaspnet2.mspx](http://www.microsoft.com/belux/msdn/nl/community/columns/desmet/hostaspnet2.mspx) 有点像我想要的。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2008-11-03T20:28:43.737

您打算在哪里获取 Web 服务器来为 ASP.NET 页面提供服务？您可以直接在浏览器中打开 HTML、Flash 或 Silverlight 等内容，但除非我遗漏了什么，否则您需要 IIS 来执行服务器端 ASP.NET。

我不知道您的要求，但您可能需要考虑使用 WinForms 应用程序甚至 MFC（如果您不能保证在目标计算机上安装了 .NET）。

不过，这并不能回答您的数据库问题。SqlCE 应该可以工作，因为所需的程序集可以与您的应用程序一起分发。另一个选项是 SQLite 以及用于数据层的 Subversion。不过我对卡西尼没有经验。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2008-11-06T15:03:21.693

我发现[UtilDev Cassini](http://irwan-online.com/web/downloads/39-development-tools/46-utildev-cassini-web-server.html)做得非常好。至于数据库，使用 SqlCe 和 LinqToSql 进行了测试。

# ios - 如何在 UITextView 中默认显示键盘？

> ID：259819
> 
> 赞同：37
> 
> 时间：2008-11-03T20:23:12.393
> 
> 标签：ios, iphone, cocoa-touch, uitextfield

我想创建一个仅由`UITextView`. 当视图首次显示时，默认情况下，我希望键盘可见并准备好输入文本。这样，用户不必`UITextView`为了开始编辑而触摸第一个。

这可能吗？我看到班级有一个通知，`UITextViewTextDidBeginEditingNotification`但我不确定如何发送，或者这是否是正确的方法。

* * *

## 回答 #1

> 赞同：69
> 
> 时间：2008-11-03T20:29:56.747

要做到这一点，只需将 becomeFirstResponder 消息发送到您的 UITextField，如下所示（假设您有一个名为 textField 的插座，指向相关字段）：

```
- (void)viewWillAppear:(BOOL)animated {
    [super viewWillAppear:animated];
    [textField becomeFirstResponder];
} 
```

* * *

## 回答 #2

> 赞同：17
> 
> 时间：2016-05-07T09:31:19.850

# 在斯威夫特

要自动显示键盘，请执行以下操作：

```
override func viewDidLoad() {
    super.viewDidLoad()

    // show keyboard
    textView.becomeFirstResponder()
} 
```

**笔记**

*   这假定文本视图是可编辑的。
*   适用于两者`UITextView`和`UITextField`
*   隐藏键盘使用`textView.resignFirstResponder()`

* * *

## 回答 #3

> 赞同：6
> 
> 时间：2016-09-05T19:39:13.917

以下使用 Swift 对我来说效果很好

```
override func viewDidAppear(animated: Bool) {
    super.viewDidAppear(animated)

    // Show keyboard by default
    billField.becomeFirstResponder()
} 
```

关键是使用 viewDidAppear 函数。

# delphi - 将 TBytes (UTF-16) 转换为字符串的最佳方法是什么？

> ID：259836
> 
> 赞同：9
> 
> 时间：2008-11-03T20:28:42.943
> 
> 标签：delphi, unicode

在 Delphi 2009 中将声明为 TBytes 的字节数组转换为 unicode 字符串的最佳方法是什么？在我的特定情况下，TBytes 数组已经具有 UTF-16 编码数据（每个字符 2 个字节）。

由于 TBytes 不存储空终止符，因此仅当数组恰好在与其相邻的内存中具有 #0 时，以下操作才有效。

```
MyString := string( myBytes ); 
```

如果不是，则字符串结果将在末尾包含随机数据（它也可能导致读取冲突，具体取决于在内存中遇到 #0 所需的时间）。

如果我使用 ToBytes 函数，它会返回 't'#0'e'#0's'#0't'#0，这不是我想要的。

* * *

## 回答 #1

> 赞同：18
> 
> 时间：2008-11-03T21:10:50.953

我最终使用

```
TEncoding.Unicode.GetString( MyByteArray ); 
```

* * *

## 回答 #2

> 赞同：12
> 
> 时间：2008-11-03T20:47:37.333

[StringOf](http://docwiki.embarcadero.com/Libraries/Rio/en/System.SysUtils.StringOf)将 TBytes 转换为 UnicodeString。 [BytesOf](http://docwiki.embarcadero.com/Libraries/Rio/en/System.SysUtils.BytesOf)将 UnicodeString转换为 TBytes。

* * *

## 回答 #3

> 赞同：4
> 
> 时间：2008-11-03T21:09:25.030

如果您的 TBytes 包含 UTF-16 字符，请查看 WideStringOf 和 WideBytesOf。

# project-management - 有这么多方法来编写一件事，决定什么是最好的？

> ID：259838
> 
> 赞同：4
> 
> 时间：2008-11-03T20:29:05.033
> 
> 标签：project-management

你有没有遇到过这样的情况：你编写了一些代码，然后发现自己想知道你是否以最好的方式做到了？所以你最终以另一种方式编码，然后发现自己再次询问是否可以做得更好。你如何确定什么时候该停下来继续下一个问题，这样你就可以避免陷入困境？

* * *

## 回答 #1

> 赞同：14
> 
> 时间：2008-11-03T20:30:36.667

做最简单的事情。

* * *

## 回答 #2

> 赞同：13
> 
> 时间：2008-11-03T20:32:17.023

定义“最佳”。

如果是这样的话：

1.  可读
2.  良好的表现
3.  可维护
4.  尊重项目的时间安排

那么这就是编码它的“最佳”方式。

* * *

## 回答 #3

> 赞同：9
> 
> 时间：2008-11-03T20:33:16.147

如果它有效、足够快、可读且可维护，那么是时候继续前进了，否则你将永远无法完成你的项目（或保住你的工作）。我们都可以永远花在重构代码上。

* * *

## 回答 #4

> 赞同：5
> 
> 时间：2008-11-03T20:31:31.033

尝试测试驱动开发。预先编写好的测试。当实现代码通过测试时，您就完成了。即使您对实现不满意，您也可以返回并编写另一个实现，并且您将进行测试以确保其正常工作。此时，您可以分析各种解决方案。

* * *

## 回答 #5

> 赞同：2
> 
> 时间：2008-11-03T20:36:32.647

如果它没有坏，就不要修理它。你不需要不断地重写你的代码。一旦你让它按照规范（包括性能要求）工作，你就必须权衡重写它的成本，以及可能引入新错误的成本，以及不去管它的成本。只要确保当你决定完成时，它有据可查。

* * *

## 回答 #6

> 赞同：1
> 
> 时间：2008-11-03T20:33:11.980

当前的实施是否有效（足够好）？如果是这样，那就把它放在床上并做其他事情。
我发现每当我学习一种新的做事方式时，我很想重写很多旧代码来使用这种技术，这会浪费时间。将您学到的知识用于新项目，并让旧项目保持平静。

* * *

## 回答 #7

> 赞同：1
> 
> 时间：2008-11-03T20:34:35.693

当其他人可以立即阅读它时，因为我已经 a) 很好地评论了它，并且 b) 使用“正常”操作来实现我的目标。

我经常想在它“工作”后立即离开。但在“作品”之后，“可读性”更为重要。

* * *

## 回答 #8

> 赞同：1
> 
> 时间：2008-11-03T20:35:29.683

正确编码的唯一方法将仅基于您的要求。你必须确保你没有过度设计你的代码。

只需确保您的代码是可测试的，并且基于“更改原因”将复杂性保持在最低限度。如果您主要在电子商务网站上进行交易，例如，您可能希望有一个可扩展的定价解决方案。但是，您不想让系统的其他部分像定价一样具有可扩展性，原因很简单，因为它们几乎没有理由改变。一个很好的例子是税收制度。您可以构建它，使其仅以有效的方式与美国打交道，然后在业务发生变化以与其他国家打交道时重构代码。

过早编码不使用的东西是编码永远不会使用的垃圾的可靠方法。

* * *

## 回答 #9

> 赞同：1
> 
> 时间：2008-11-03T20:37:24.173

我真的很喜欢问自己我刚刚创建的解决方案是否真的是*最好*的解决方案。我怀疑这个问题是否有明确的答案。

解决方案的决定应该简单地基于约束（可用时间、设计、可维护性），因此您可能只需要问自己，手头的解决方案是否满足您的约束。

但永远不要停止问自己，因为它是产生更好解决方案的动力。

* * *

## 回答 #10

> 赞同：1
> 
> 时间：2008-11-03T20:58:55.800

我一直在问自己。但是，一遍又一遍地重新实现相同的东西是没有目的的。如果你认为你做错了，但它有效，接受你的失败并继续前进。你已经为未来学到了一些东西。下一次，下一个项目，你会做得更好（总是，因为你几乎不会以人们可能称之为完美的方式做到这一点）。再次触摸（坏）代码的唯一原因是

*   其他人尝试使用您的代码，但失败了，因为它太可怕了。是时候接手他的工作了（你应该知道代码，你已经写好了），在这个过程中尝试修复它，让它更明显，添加更好的文档，更好的变量/函数/方法命名（“说话的名字”），更多评论，等等。

*   它可以工作，但是速度太慢或占用了太多 RAM。是时候剖析它了！CPU时间花在了哪里？为什么要使用这么多内存？找到最薄弱的地方并修复它们。

*   事实证明，它并没有真正起作用，它在某些条件下或某些情况下会失败，再次，是时候修复你的代码了。

但是，请记住以下说法（已更改为适合程序员）：“程序员永远不会再犯同样的错误，他们总会找到新的错误！”。我多久说过一次，下次我会做得更好，有时我有机会（例如，需要添加新功能并且代码采用起来非常糟糕，重写它以从头开始根据这些新功能的需要工作结果比更换旧的更快）当然，我从来没有两次犯过同样的错误；但是下次您再次编写相同的代码时，您会遇到新的（尽管更聪明）实现引起的新问题，而旧实现甚至没有（因此它还有很多其他问题）。达到你可以真正说“我不能做得更好，这是可以做到的最好”的地步 是我仍在等待的体验。我想知道地球上是否有任何代码在简单性、性能或灵活性方面无法进一步优化。

大多数程序员不喜欢听到的硬道理是“有时好就足够好”。代码可能并不完美，它可能有缺陷。你也许能做得比这更好……但编程并不是一场能创造出最好代码的比赛，而是让事情顺利进行（通常是为了客户），当我告诉我的老板“嘿，我可以改进这个代码只使用一半的 CPU 时间，四分之一的内存，它会非常灵活，添加新功能将是几个小时而不是几周的问题”，他可能会说“没有客户抱怨它太慢. 没有客户抱怨它使用了太多内存。它现在的工作方式正是我们希望它工作的方式，

* * *

## 回答 #11

> 赞同：1
> 
> 时间：2008-11-03T21:04:33.430

当然，您不是在问 Perl，但我认为这适用于大多数情况下的大多数语言，即使它不是明确的设计意图：

> Perl 旨在为您提供几种做任何事情的方法，因此请考虑选择最易读的一种。
> 
> -- perl 手册页中的 Larry Wall

* * *

## 回答 #12

> 赞同：1
> 
> 时间：2008-11-04T03:52:26.197

听起来是版本控制如此重要的另一个原因。随心所欲地重构和改进代码，无论您认为需要改进的地方，但请继续检查并评论每一个更改。日志，加上同伴压力，应该可以帮助你了解你在哪里没有明显的原因强迫症，以及你在哪里以有意义的方式改进了代码库。

* * *

## 回答 #13

> 赞同：0
> 
> 时间：2008-11-03T20:39:35.917

最好的：

满足今天、明天、下周和明年的规范，无论您是否在这些时间范围内维护它。

* * *

## 回答 #14

> 赞同：0
> 
> 时间：2008-11-03T20:59:18.870

最好！=完美。对于普通的程序员来说，完美的代码可能是不可能的。编写好的代码是为了支持未来的维护。你不会第一次就做到完美。

# deployment - 确保部署正确版本的文件的最佳方法？

> ID：259841
> 
> 赞同：1
> 
> 时间：2008-11-03T20:29:35.857
> 
> 标签：deployment, cvs, versioning

我工作的公司编写了很多小的 Perl 和 Bash 脚本来将数据处理成可用于我们软件的东西。像任何代码一样，这些脚本可以更改。我为他们提供 CVS 是因为文件版本控制而不是存储库版本控制。无论如何，我正在考虑一个部署工具来让脚本从开发到生产。生产服务器将拥有自己的简单版本控制系统，如果其中一个脚本的 md5 总和与数据库中的不匹配，它将不会运行该脚本并向相关方发送电子邮件。

我想强制程序员部署脚本的最新 CVS 版本。如果它不是最新的，它应该死掉一条消息，告诉他们必须先检查他们的版本。我意识到在某些情况下您可能需要部署旧文件。这些将是例外，可以这样处理。

最好的方法是什么？它就像做'cvs diff'一样简单吗？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2008-11-03T20:46:39.787

如果您要编写某种分发脚本，它应该相对简单

1) 脚本应提交到您的 cvs 存储库中

2）我建议从您的makefile（或您使用的任何构建系统）中调用脚本，如下所示

```
make dist 
```

dist 规则将调用您的脚本。
3) 脚本将执行

```
 cvs up -An 
```

例如，通过将输出重定向到 grep 来分析输出以查找 M 或 C 或 A 或 R 状态。

```
grep -c ^[MCAR] 
```

如果 count > 0 你有问题。

4）如果发现上述之一失败，则构建脚本

5）如果不创建 tar 或您正在使用的任何其他形式的分发

要部署旧版本，您可以将 -A 作为参数默认设置为 -A 并被覆盖，例如被 shell 变量覆盖为 -r tag-3.14.4 。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2008-11-03T21:03:17.710

我研究了一个进行部署的内部工具。它是为企业设计的（并符合 SOX 法规），因此它依赖于批准来部署代码。

因此，我们部署了开发人员在请求中指定的代码版本，而不是最新版本。原因是开发人员可能需要进行更改，进行测试，同时进行其他更改。这些较新的更改尚未经过测试 (QA) 阶段，但开发人员的原始版本已完成，因此我们将部署该版本。

综上所述，我会以可以指定版本号的方式设计它，如果没有版本号，则推送最新的。

# tagging - 可以做哪些事情来改进网站上的标记功能？

> ID：259849
> 
> 赞同：4
> 
> 时间：2008-11-03T20:31:53.123
> 
> 标签：tagging

我有粗略的想法——比如处理单数/复数、两个或多个意思相同的单词/短语、拼写错误等。但我不确定以编程方式和自动处理这些的任何模式或经验法则或者通过将它们呈现给管理员甚至用户进行清理。

有什么想法或建议吗？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2008-11-03T20:34:12.557

正如 SO 所做的那样，在您键入时建议现有标签是一件非常好的事情。它将（希望，几乎）处理复数/单数事物和拼写错误，因为人们将更多地重用现有标签。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-01-05T13:20:44.317

你应该有一个标签**格式**的策略（例如标签应该是单数的）。根据标签的多样性，不仅可以在您键入标签时自动完成，还可以**建议相似的标签**，以便人们轻松使用标签系统。此外，**清理过程**可以更正常见的拼写错误并根据翻译表替换不推荐使用的标签。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2008-11-03T20:36:20.773

使用**ajax 驱动的**建议表单，例如 StackOverflow :)

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2008-11-03T20:43:04.677

假设设置与 SO 不同：如何允许版主将较小的投票标签合并到更常见的标签中，例如 VS9 可以合并到 VisualStudio2008 但不允许较大的使用标签合并到较小的标签组中。添加徽章激励或与此类似。

# javascript - Javascript - 对同一事件的多个客户端验证

> ID：259850
> 
> 赞同：0
> 
> 时间：2008-11-03T20:32:07.100
> 
> 标签：javascript, html, validation

我在客户端对 samve 事件执行两个验证。我已经定义了我的验证，如下所示

```
btnSearch.Attributes["OnClick"] = "javascript:return prepareSave(); return prepareSearch();" 
```

伪代码

```
prepareSave():
{
  if (bPendingchanges)
    {
     return confirm('Need to save pending changes first, click OK and loose changes or cancel to save them first')
    }
  else
   {return true}
} 
```

伪代码

```
prepareSearch():
{
  if (bNoSearchText)
    {
      alert('Please specify search criteria before proceeding')
      return false;
   }
  else
   {return true;}
} 
```

什么时候`bPendingchanges=false`，我从来没有运行过第二次验证。谁能快速发现我在这里忽略的内容？请？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2008-11-03T20:38:42.610

`return`，顾名思义，将控制权返回给相关代码。因此，return 语句之后的任何内容

```
return prepareSave(); return prepareSearch();
//                    ^^^^^^^^^^^^^^^^^^^^^^^ e.g. this part 
```

从不执行。尝试`return (prepareSave() && prepareSearch());`

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2008-11-03T20:36:28.777

你的第二个`return`声明永远不会达成。之后执行停止`javascript:return prepareSave()`。

如果两个函数都返回 true，您似乎想要返回 true - 因此，请执行以下操作：

```
btnSearch.Attributes["OnClick"] = javascript: return prepareSave() && prepareSearch(); 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2008-11-03T20:36:47.183

那是因为返回阻止了第二次验证的运行。试试这个

```
btnSearch.Attributes["OnClick"] = "javascript:return prepareSave() && prepareSearch();" 
```

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2008-11-03T20:38:17.090

`"javascript:return prepareSave(); return prepareSearch();"`

1）你不应该有“javascript：”
2）`return prepareSearch();`永远不会被执行，因为`"return prepareSave();`退出你的事件处理程序

尝试`"return (prepareSave() && prepareSearch());"`

# c++ - C++ 中 clone() 的最佳签名是什么？

> ID：259853
> 
> 赞同：25
> 
> 时间：2008-11-03T20:32:24.730
> 
> 标签：c++, clone, smart-pointers, covariant-return-types

正如 Scott Myers 所写，您可以利用 C++ 类型系统中的放松来声明 clone() 以返回指向正在声明的实际类型的指针：

```
class Base
{
    virtual Base* clone() const = 0;
};

class Derived : public Base
{
    virtual Derived* clone() const
}; 
```

编译器检测到 clone() 返回一个指向对象类型的指针，并允许 Derived 覆盖它以返回一个指向derived 的指针。

最好让 clone() 返回一个暗示所有权语义转移的智能指针，如下所示：

```
class Base
{
   virtual std::auto_ptr<Base> clone() const = 0;
};

class Derived : public Base
{
    virtual std::auto_ptr<Derived> clone() const;
}; 
```

不幸的是，约定的放宽不适用于模板化智能指针，并且编译器将不允许覆盖。

所以，看来我有两个选择：

1.  让 clone() 返回一个“哑”指针，并记录客户负责处理它的文件。
2.  让 clone() 返回一个智能基指针，并让客户端在需要时使用 dynamic_cast 将它们保存到派生指针。

这些方法之一是首选吗？或者有没有办法让我吃掉我的所有权语义转移并拥有我强大的类型安全性？

* * *

## 回答 #1

> 赞同：29
> 
> 时间：2008-11-04T08:48:31.420

使用公共非虚拟/私有虚拟模式：

```
class Base {
    public:
    std::auto_ptr<Base> clone () { return doClone(); }
    private:
    virtual Base* doClone() { return new (*this); }
};
class Derived : public Base {
    public:
    std::auto_ptr<Derived> clone () { return doClone(); }
    private:
    virtual Derived* doClone() { return new (*this); }
}; 
```

* * *

## 回答 #2

> 赞同：19
> 
> 时间：2008-11-03T21:39:06.153

语法不是很好，但是如果你把它添加到上面的代码中，它不是解决了你所有的问题吗？

```
template <typename T>
std::auto_ptr<T> clone(T const* t)
{
    return t->clone();
} 
```

* * *

## 回答 #3

> 赞同：7
> 
> 时间：2008-11-03T21:28:33.103

我认为在这种情况下函数语义非常清晰，几乎没有混淆的空间。所以我认为你可以放心地使用协变版本（返回一个指向真实类型的哑指针），你的调用者会知道他们正在获得一个新对象，其属性已转移给他们。

* * *

## 回答 #4

> 赞同：5
> 
> 时间：2008-11-03T21:02:57.867

这取决于您的用例。如果你认为你需要调用`clone`一个你知道动态类型的派生对象（记住，重点`clone`是允许在*不*知道动态类型的情况下进行复制），那么你可能应该返回一个哑指针并将它加载到一个智能指针中调用代码中的指针。如果没有，那么您只需要返回一个 smart_ptr，因此您可以随意在所有覆盖中返回它。

* * *

## 回答 #5

> 赞同：2
> 
> 时间：2008-11-03T22:41:42.907

`Tr1::shared_ptr<>`可以像原始指针一样投射。

我认为让 clone() 返回一个`shared_ptr<Base>`指针是一个非常干净的解决方案。您可以`shared_ptr<Derived>`通过**`tr1::static_pointer_cast<Derived>`**或**`tr1::dynamic_pointer_cast<Derived>`**在编译时无法确定克隆对象的种类的情况下将指针转换为。

为了确保对象的类型是可预测的，您可以对 shared_ptr 使用多态转换，如下所示：

```
template <typename R, typename T>
inline std::tr1::shared_ptr<R> polymorphic_pointer_downcast(T &p)
{
    assert( std::tr1::dynamic_pointer_cast<R>(p) );
    return std::tr1::static_pointer_cast<R>(p);
} 
```

断言添加的开销将在发布版本中丢弃。

* * *

## 回答 #6

> 赞同：1
> 
> 时间：2008-11-03T21:41:22.890

这是使用`boost::intrusive_ptr`而不是`shared_ptr`or的原因之一`auto/unique_ptr`。原始指针包含引用计数，可以在这种情况下更无缝地使用。

* * *

## 回答 #7

> 赞同：1
> 
> 时间：2016-08-01T22:53:30.757

更新C++14 的[MSalters 答案：](https://stackoverflow.com/a/261278)

```
#include <memory>

class Base
{
public:
    std::unique_ptr<Base> clone() const
    {
        return do_clone();
    }
private:
    virtual std::unique_ptr<Base> do_clone() const
    {
        return std::make_unique<Base>(*this);
    }
};

class Derived : public Base
{
private:
    virtual std::unique_ptr<Base> do_clone() const override
    {
        return std::make_unique<Derived>(*this);
    }
} 
```

* * *

## 回答 #8

> 赞同：0
> 
> 时间：2008-11-03T21:22:52.613

您可以有两种方法，一个返回基类型的智能指针包装器的虚拟 clone()，以及返回正确类型的智能指针的非虚拟 clone2()。

clone2 显然会根据克隆和封装演员来实现。

这样可以得到你在编译时知道的最衍生的智能指针。它可能不是总体上派生最多的类型，但它使用了编译器可用的所有信息。

另一种选择是创建一个模板版本的克隆，它接受您期望的类型，但这会给调用者增加更多负担。

# oracle - Oracle 单表常量使用 JDBC 与 CLOB 合并

> ID：259860
> 
> 赞同：0
> 
> 时间：2008-11-03T20:34:02.340
> 
> 标签：oracle, jdbc, merge, clob, ora-01461

[作为这个问题](https://stackoverflow.com/questions/167471/)的后续行动，我需要以下情况的帮助：

在 Oracle 中，给定一个简单的数据表：

```
create table data (
    id       VARCHAR2(255),
    key      VARCHAR2(255),
    value    CLOB); 
```

我正在使用以下合并命令：

```
merge into data
using (
    select
        ? id,
        ? key,
        ? value
    from
        dual
) val on (
    data.id=val.id
    and data.key=val.key
)
when matched then 
    update set data.value = val.value 
when not matched then 
    insert (id, key, value) values (val.id, val.key, val.value); 
```

我正在通过 Java 应用程序中的 JDBC 调用查询。

当 "value" 字符串很大时，上面的查询会导致以下 Oracle 错误：

```
ORA-01461: cannot bind a LONG value for insert into a long column 
```

[我什至设置了此处](http://www.oracle.com/technology/sample_code/tech/java/codesnippet/jdbc/clob10g/handlingclobsinoraclejdbc10g.html)记录的“SetBigStringTryClob”属性，结果相同。

鉴于“价值”是 CLOB，是否有可能实现我想要的行为？

编辑：客户端环境是 Java

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2008-11-04T03:44:45.603

你没有在你的帖子中特别提到，但从问题的标签来看，我假设你是从 Java 做的。

我在刚刚完成的项目中使用这样的代码取得了成功。此应用程序使用 Unicode，因此如果您的问题域仅限于标准 ASCII 字符集，可能会有更简单的解决方案。

您当前是否使用 OracleStatement.setCLOB() 方法？这是一件非常尴尬的事情，但我们无法以其他任何方式解决它。您必须实际创建一个临时 CLOB，然后在 setCLOB() 方法调用中使用该临时 CLOB。

现在，我已经从一个工作系统中删除了这个，并且不得不进行一些临时调整，所以如果这在你的情况下似乎不起作用，请告诉我，我会回去看看是否可以得到一个更小的工作示例。

这当然假设您使用的是 Oracle Corp. JDBC 驱动程序（ojdbc14.jar 或 ojdbc5.jar），这些驱动程序位于 $ORACLE_HOME/jdbc/lib

```
CLOB tempClob = CLOB.createTemporary(conn, true, CLOB.DURATION_SESSION);

// Open the temporary CLOB in readwrite mode to enable writing
tempClob.open(CLOB.MODE_READWRITE);

// Get the output stream to write
Writer tempClobWriter = tempClob.getCharacterOutputStream();

// Write the data into the temporary CLOB
tempClobWriter.write(stringData);

// Flush and close the stream
tempClobWriter.flush();
tempClobWriter.close();

// Close the temporary CLOB
tempClob.close();

myStatement.setCLOB(column.order, tempClob); 
```

问候， 道恩·金

# c# - 从 XML 中去除标签出现

> ID：259883
> 
> 赞同：2
> 
> 时间：2008-11-03T20:41:28.440
> 
> 标签：c#, .net, xml, linq

我想去掉特定标记的出现，保持内部 XML 完好无损。我想一次性完成（而不是重新搜索、替换和从头开始）。例如，从来源：

```
<element>
    <RemovalTarget Attribute="Something">
      Content Here
    </RemovalTarget>
</element>
<element>
  More Here
</element> 
```

我希望结果是：

```
<element>
  Content Here
</element>
<element>
  More Here
</element> 
```

我已经尝试过这样的事情（请原谅我，我是 Linq 的新手）：

```
var elements = from element in doc.Descendants()
               where element.Name.LocalName == "RemovalTarget"
               select element;

foreach (var element in elements) {
    element.AddAfterSelf(element.Value);
    element.Remove();
} 
```

但是在第二次通过循环时，我得到了一个空引用，大概是因为通过更改集合使其无效。在可能很大的文档上删除这些标签的有效方法是什么？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2008-11-03T20:45:53.063

您是否考虑过使用 XSLT？似乎是完美的解决方案，因为您所做的正是 XSLT 的用途，将一个 XML 文档转换为另一个。模板系统将毫无问题地为您深入研究嵌套的讨厌。

[这](http://www.w3schools.com/xsl/xsl_transformation.asp)是一个基本示例

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2008-11-03T21:14:29.497

您必须通过调用 ToList 来跳过延迟执行，这可能不会损害您在大型文档中的性能，因为您将在比原始搜索低得多的 big-O 处进行迭代和替换。正如@jacob_c 指出的那样，我应该使用 element.Nodes() 正确替换它，并且正如@Panos 指出的那样，我应该反转列表以准确处理嵌套替换。

此外，使用[XElement.ReplaceWith](http://msdn.microsoft.com/en-us/library/system.xml.linq.xelement.replacewith.aspx)，比您当前在大型文档中的方法快得多：

```
var elements = doc.Descendants("RemovalTarget").ToList().Reverse();
/* reverse on the IList<T> may be faster than Reverse on the IEnumerable<T>,
 * needs benchmarking, but can't be any slower
 */

foreach (var element in elements) {
    element.ReplaceWith(element.Nodes());
} 
```

最后一点，在审查这可能用于什么时，我倾向于同意@Trull 的观点，即 XSLT 可能是您真正想要的，如果说您要从文档中删除所有 say <b> 标记。否则，请享受这个相当不错且性能相当好的 LINQ to XML 实现。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2008-11-03T20:55:10.360

我建议按照 Trull 推荐的最佳解决方案执行 XSLT。

或者您可能会考虑使用字符串生成器和正则表达式匹配来删除项目。

您可以查看遍历文档，并使用节点和父节点有效地将代码从节点内部移动到父节点，但这将是乏味的，并且对于那里的其他潜在解决方案非常不必要。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2008-11-03T21:06:03.040

一个轻量级的解决方案是使用 XmlReader 来处理输入文档和 XmlWriter 来写入输出。

注意：XmlReader 和 XmlWriter 类是抽象的，请使用适合您情况的派生类。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2008-11-03T22:34:00.007

根据您管理 XML 的方式，您可以使用正则表达式来删除标签。

这是一个简单的控制台应用程序，演示了正则表达式的使用：

```
 static void Main(string[] args)
    {
        string content = File.ReadAllText(args[0]);

        Regex openTag = new Regex("<([/]?)RemovalTarget([^>]*)>", RegexOptions.Multiline);

        string cleanContent = openTag.Replace(content, string.Empty);
        File.WriteAllText(args[1], cleanContent);
    } 
```

这会在文件中留下换行符，但增加正则表达式应该不会太难。

# asp.net - 如何将gridview中的标签绑定到另一个表？

> ID：259884
> 
> 赞同：2
> 
> 时间：2008-11-03T20:41:50.950
> 
> 标签：asp.net, gridview, datatable

我有一个非常标准的`Gridview`，自动生成的编辑和删除按钮。它绑定到`tableadapter`链接到我的`RelationshipTypes`表的一个。

```
dbo.RelationshipTypes:
ID, Name, OriginConfigTypeID, DestinationConfigTypeID 
```

我希望使用一个标签来从`ConfigTypes`表中提取名称，使用`OriginConfigTypeID`and`DestinationTypeID`作为链接。

```
dbo.ConfigTypes:
ID, Name 
```

我的问题是，我无法使用`Inner Join`数据集中的 an 自动生成编辑和删除按钮。或者我可以吗？

这是我的代码：

```
<asp:GridView ID="GridView1" runat="server" AutoGenerateColumns="False"
        AutoGenerateDeleteButton="True" AutoGenerateEditButton="True" CssClass="TableList"
        DataKeyNames="ID" DataSourceID="dsRelationShipTypes1">
        <Columns>
            <asp:BoundField DataField="ID" HeaderText="ID" InsertVisible="False" ReadOnly="True"
                SortExpression="ID" Visible=False/>
            <asp:TemplateField HeaderText="Origin" SortExpression="OriginCIType_ID">
                <EditItemTemplate>
                    &nbsp;<asp:DropDownList Enabled=true ID="DropDownList2" runat="server" DataSourceID="dsCIType1"
                        DataTextField="Name" DataValueField="ID" SelectedValue='<%# Bind("OriginCIType_ID") %>'>
                    </asp:DropDownList>
                </EditItemTemplate>
                <ItemTemplate>
                    &nbsp;
                    <asp:Label ID="Label2" runat="server" Text='<%# Bind("OriginCIType_ID") %>'></asp:Label>
                </ItemTemplate>
            </asp:TemplateField>
            <asp:TemplateField HeaderText="Name" SortExpression="Name">
                <EditItemTemplate>
                    <asp:TextBox ID="TextBox3" runat="server" Text='<%# Bind("Name") %>'></asp:TextBox>
                </EditItemTemplate>
                <ItemTemplate>
                    <asp:Label ID="Label3" runat="server" Text='<%# Bind("Name") %>'></asp:Label>
                </ItemTemplate>
            </asp:TemplateField>
            <asp:TemplateField HeaderText="Destination" SortExpression="DestinationCIType_ID">
                <EditItemTemplate>
                    <asp:DropDownList ID="DropDownList3" runat="server" DataSourceID="dsCIType1" DataTextField="Name"
                        DataValueField="ID" SelectedValue='<%# Bind("DestinationCIType_ID") %>'>
                    </asp:DropDownList>
                </EditItemTemplate>
                <ItemTemplate>
                    <asp:Label ID="Label1" runat="server" Text='<%# Bind("DestinationCIType_ID") %>'></asp:Label>
                </ItemTemplate>
            </asp:TemplateField>
        </Columns>
</asp:GridView> 
```

所以我确实尝试创建自己的编辑和删除按钮，但一直收到错误

> “找不到更新方法”

或类似的东西。我是否必须在我的代码隐藏中手动编写删除和更新方法？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2008-11-04T16:30:16.947

您必须告诉 ObjectDataSource 要使用什么对象或 SQLDataSource 要使用什么存储过程。使用“更新方法”属性。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2014-11-19T15:11:57.897

您可以使用技术背后的代码来提及可以处理更新和删除功能的方法。这是执行此操作的标准方法。您可以使用Sqldatasorce来描述来源。您可以提及所有用于内连接的表，也可以使用sql查询。

# wpf - 如何在 xaml 中复制 WPF 资源？

> ID：259886
> 
> 赞同：5
> 
> 时间：2008-11-03T20:42:52.290
> 
> 标签：wpf, user-interface, xaml, resources

我想分配一个我已经有第二个名称的资源，类似于使用 Styles 的 BasedOn 属性。具体来说，我有一个画笔，用于一组名为 ForegroundColor 的元素，我想在一个名为 MouseOverBackgroundBrush 的控件模板（ComboBox）中使用它。我想做这样的事情：

```
<ResourceCopy x:key="MouseOverBackgroundBrush" Value="{StaticResource ForegroundColor}" /> 
```

有没有办法做到这一点，或者在 Xaml 中有没有更好的方法来解决这个问题？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2008-11-03T21:11:30.640

这是一个在 XAML 中没有很好支持的功能。我相信您要么需要重复自己（并在需要更改画笔时随时更改两个位置）*，要么*如果您不介意后面的代码，您可以像这样完成复制：

```
Resources["MouseOverBackgroundBrush"] = Resources["ForegroundColor"]; 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2008-11-03T21:17:36.777

我不知道如何在 xaml 中复制资源（甚至可以完成吗？）就像你问的那样......但这是完成你想要做的事情的一种方法：

```
<Color x:Key="firstColor">#FFD97A7A</Color>
<Color x:Key="secondColor">#FFF4BFBF</Color>
<LinearGradientBrush x:Key="firstGradientBrush" EndPoint="0.5,1" StartPoint="0.5,0">
    <GradientStop Color="{DynamicResource firstColor}" Offset="0"/>
    <GradientStop Color="{DynamicResource secondColor}" Offset="1"/>
</LinearGradientBrush>
<LinearGradientBrush x:Key="secondGradientBrush" EndPoint="0.5,1" StartPoint="0.5,0">
    <GradientStop Color="{DynamicResource firstColor}" Offset="0"/>
    <GradientStop Color="{DynamicResource secondColor}" Offset="1"/>
</LinearGradientBrush> 
```

基本上，根据一些常见的颜色创建两个不同的画笔。

# c# - 您对异常消息使用什么样式？

> ID：259887
> 
> 赞同：5
> 
> 时间：2008-11-03T20:42:52.337
> 
> 标签：c#, .net, exception, logging, throw

在编写引发我在[这里](https://stackoverflow.com/questions/259800/is-there-a-built-in-net-exception-that-indicates-an-illegal-object-state)询问的异常的代码时，我来到了我的信息的结尾，并在标点符号处停了下来。我意识到几乎我曾经抛出的每条异常消息都可能有一个！某处。

```
throw new InvalidOperationException("I'm not configured correctly!");
throw new ArgumentNullException("You passed a null!");
throw new StupidUserException("You can't divide by 0!  What the hell were you THINKING???  DUMMY!!!!!"); 
```

你在写异常信息时用什么语气？浏览日志时，您是否发现某种特定风格的消息实际上比另一种更有帮助？

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2008-11-03T20:46:03.673

就当事实吧。包括调试时可能需要的所有信息，但仅此而已。

我唯一会在异常消息中包含感叹号的情况是它表明发生了非常非常奇怪的事情。大多数错误*并不*奇怪，只是不正确的环境、用户错误或简单的编程错误的产物。

* * *

## 回答 #2

> 赞同：6
> 
> 时间：2008-11-03T20:46:37.057

我试图反映我正在编码的框架的语气、语法和标点符号风格。您永远不知道其中一条消息何时会真正出现在客户或用户面前，因此我保持一切专业、非判断性和足够具体的内容以进行故障排除 - 并没有具体到泄露任何安全问题代码。

我避免在所有字符串（UI 和异常）中出现感叹号，比如瘟疫，除了（偶尔）在我的单元测试中。

* * *

## 回答 #3

> 赞同：6
> 
> 时间：2008-11-03T20:52:59.803

系统消息中的对话音使软件看起来不专业和草率。感叹号、侮辱和俚语在优美的异常消息中并没有真正的位置。

另外，我倾向于在 Java 中对运行时异常和检查异常使用不同的样式，因为运行时异常是针对犯错误的程序员的。由于运行时异常可能会显示给最终用户，所以我仍然“保持干净”，但它们可能更简洁和神秘。检查的异常消息应该更有帮助，因为如果您描述它，用户可能会修复问题（例如，找不到文件、磁盘已满、没有到主机的路由等）。

在信息异常没有特定字段的情况下，有帮助的一件事是违规数据：

```
throw new IndexOutOfBoundsException("offset < 0: " + off); 
```

* * *

## 回答 #4

> 赞同：3
> 
> 时间：2008-11-03T20:45:52.597

承担责任，即使确实是用户的错，也是我见过的最佳选择。

类似于“我找不到你想要的文件，你能检查一下我是否有正确的文件吗？”这样的事情。或“出了点问题。不知道怎么回事，但我能解决的唯一方法就是停下来。请重新启动我。”

* * *

## 回答 #5

> 赞同：2
> 
> 时间：2008-11-03T20:49:23.633

简洁、详细且很少冗余信息（即 ArgumentNullException 显然涉及 null）。

但这是我读过的最好的，第一个[答案](https://stackoverflow.com/questions/140376/what-easter-eggs-have-you-placed-in-code)。

* * *

## 回答 #6

> 赞同：2
> 
> 时间：2008-11-03T20:52:12.847

我不会过多地使用感叹号。他们表达的太多了，想想“驱动器中没有磁盘！”的事实。可以读作“疯狂的用户在驱动器中没有磁盘”。;)

我认为抛出包含国际化文本的异常是明智的。你永远不知道谁会使用你的代码，捕捉你的异常并向用户显示文本。所以那将是：

```
throw new MagicalException(getText("magical.exception.text")); 
```

我还建议在抛出它时包装底层异常（如果有的话）。它确实有助于调试。

不要以为用户不会看到运行时异常。如果您正在登录文件附加程序，一些好奇的用户可能会打开日志并查看您的*肮脏*秘密。

* * *

## 回答 #7

> 赞同：2
> 
> 时间：2008-11-05T00:25:18.610

我发现最有用的消息提供：

*   一种*一致的格式*，可以很容易地理解他们告诉你的内容。
*   *时间戳，*因此您可以了解程序的动态。
*   错误的*简要总结*。如果您提供技术支持，请添加*错误代码*以便快速识别。
*   *对出错原因*的解释，区分*无效的用户输入*和*编码错误。*
*   *详细信息*，包括所涉及*的代码行*或*值*。

最重要的是：

*   **他们告诉用户如何解决问题。**

例子：

```
commit.c 第 42 行中的错误 203（超时）：
无法将用户“Linus”的工资数据保存到“10.10.1.21”的数据库中
1500 毫秒后。验证数据库地址和登录凭据。
```

最难学习的一课是，用户对代码内部的兴趣远不如对完成工作的兴趣*。* 让他们尽可能轻松地完成工作，您为您的软件增加了巨大的价值。

* * *

## 回答 #8

> 赞同：1
> 
> 时间：2008-11-03T20:54:41.300

我倾向于将我的异常消息放入异常本身。例如，file_not_found 应该说“找不到文件”。仅当用户无法弄清楚时才应包含特定数据；在这种情况下，用户知道文件名，所以我不添加该数据。如有必要，可以通过任何输出信息来完成格式化，所以我尽量让它们对重新格式化尽可能友好。

* * *

## 回答 #9

> 赞同：1
> 
> 时间：2008-11-04T22:43:32.327

礼貌、简洁、简单、具体。通常，在消息中包含状态值是有帮助的。

# java - Swing 组件：垂直文本问题

> ID：259889
> 
> 赞同：3
> 
> 时间：2008-11-03T20:43:24.847
> 
> 标签：java, swing, customization, jcomponent

如果我有一个像这张图片中的按钮：

**[http://www.freeimagehosting.net/image.php?4cd775814c.png](http://www.freeimagehosting.net/image.php?4cd775814c.png)**

如何使文本垂直显示？如在

```
j
乙
你
吨
吨
○
n
1

```

我想知道如何为 JLabel 做同样的事情。我确信必须有比创建与字符串中的字符一样多的标签更好的方法。对 ？

**编辑：**如何在我的帖子中插入图片？图像按钮在预览部分显示图像，但是当我实际发布数据时，我只得到一些文本，就像标签被弄乱了一样。

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2008-11-03T21:49:50.297

我不知道这对您是否有用，但[此示例](http://www.codeguru.com/java/articles/199.shtml)显示了如何制作垂直标签。不同之处在于它会旋转所有文本（和/或图标）而不是堆叠字母。我不知道修改它以完成您的要求有多困难。

这样做的好处是您的标签可以在运行时更改；与简单的相比，生成大的 HTML 字符串可能会很痛苦`label.setUI(new VerticalLabelUI(true));`（而且您不必担心标签文本中的 <>）。

* * *

## 回答 #2

> 赞同：5
> 
> 时间：2008-11-03T20:55:52.607

您可以将 HTML 用于 JButton 或 JLabel。所以

```
button = new JButton("<html>J<br>b<br>u<br>t<br>t<br>o<br>n<br>1</html>"); 
```

应该做的伎俩。

# c++ - 动态 3D 数组上的 OpenGL glDrawPixels

> ID：259890
> 
> 赞同：1
> 
> 时间：2008-11-03T20:44:19.777
> 
> 标签：c++, arrays, opengl, graphics

如何使用 OpenGL **glDrawPixels()绘制以下动态****3D**数组？您可以在此处找到文档：http: [//opengl.org/documentation/specs/man_pages/hardcopy/GL/html/gl/drawpixels.html](http://opengl.org/documentation/specs/man_pages/hardcopy/GL/html/gl/drawpixels.html)

 **```
float ***array3d;

void InitScreenArray()
{
    int i, j;

    int screenX = scene.camera.vres;
    int screenY = scene.camera.hres;

    array3d = (float ***)malloc(sizeof(float **) * screenX);

    for (i = 0 ;  i < screenX; i++) {
        array3d[i] = (float **)malloc(sizeof(float *) * screenY);

        for (j = 0; j < screenY; j++)
          array3d[i][j] = (float *)malloc(sizeof(float) * /*Z_SIZE*/ 3);
    }
} 
```

我只能使用以下头文件：

```
#include <math.h>
#include <stdlib.h>
#include <windows.h>     

#include <GL/gl.h>
#include <GL/glu.h>
#include <GL/glut.h> 
```

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2008-11-04T12:44:28.870

呃......由于您使用单独的 分配*每个单个像素*`malloc()`，因此您也必须通过单独调用来绘制每个像素`glDrawPixels()`。这（显然）很疯狂；位图图形的想法是像素以相邻的紧凑格式存储，因此从一个像素移动到另一个像素快速且快速（ *O（1） ）。*这对我来说看起来很困惑。

一种更明智的方法是分配“3D 数组”（通常称为 2D 像素数组，其中每个像素恰好由红色、绿色和蓝色分量组成），只需调用一次`malloc()`，就像这样 (在 C) 中：

```
float *array3d;
array3d = malloc(scene.camera.hres * scene.camera.vres * 3 * sizeof *array3d); 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2008-11-04T15:17:33.537

谢谢放松。[我在gamedev.net](http://www.gamedev.net/community/forums/topic.asp?topic_id=513674)上得到了同样的建议，所以我实现了以下算法：

```
typedef struct
{
    GLfloat R, G, B;
} color_t;

color_t *array1d;

void InitScreenArray()
{   
        long screenX = scene.camera.vres;
    long screenY = scene.camera.hres;
        array1d = (color_t *)malloc(screenX * screenY * sizeof(color_t));
}

void SetScreenColor(int x, int y, float red, float green, float blue)
{
    int screenX = scene.camera.vres;
    int screenY = scene.camera.hres;

    array1d[x + y*screenY].R = red;
    array1d[x + y*screenY].G = green;
    array1d[x + y*screenY].B = blue;
}

void onDisplay( ) 
{
    glClearColor(0.1f, 0.2f, 0.3f, 1.0f);
    glClear(GL_COLOR_BUFFER_BIT | GL_DEPTH_BUFFER_BIT);

    glRasterPos2i(0,0); 
    glDrawPixels(scene.camera.hres, scene.camera.vres, GL_RGB, GL_FLOAT, array1d);

    glFinish();
    glutSwapBuffers();
} 
```

我的应用程序还没有工作（屏幕上什么都没有出现），但我认为这是我的错，这段代码可以工作。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-12-27T00:52:47.730

你不想用 glTexImage2D() 代替吗：见[这里](https://stackoverflow.com/questions/1080545/how-to-display-a-raw-yuv-frame-in-a-cocoa-opengl-program)

# security - Excel VBA 代码的密码保护如何工作？

> ID：259897
> 
> 赞同：8
> 
> 时间：2008-11-03T20:46:15.310
> 
> 标签：security, vba, excel, password-protection

这个问题与[我之前](https://stackoverflow.com/questions/259663/vba-password-protection-how-it-works-is-it-secure-are-there-any-alternatives)的问题有关。

您能否解释或提供解释 Excel VBA 代码密码保护在 2007 年之前的版本中如何实际工作的链接？Excel 2007 和以前的版本在密码保护方面有什么区别？

Excel的密码保护是否真的加密了代码？如果代码被加密，Excel如何执行代码？

最后，excel密码删除软件是如何工作的？

* * *

## 回答 #1

> 赞同：14
> 
> 时间：2008-11-04T02:26:03.783

VBA 的安全性被广泛认为是很差的。VBA 代码未编译，源代码在 excel 文件中可用。密码保护很容易绕过。

据我了解，Office 2003 及更早版本将 vba 代码保存为工作表（或文档/演示文稿）的二进制格式的一部分。当您启动 VBA IDE 时，它只是查看 VBA 代码是否已被“保护”。这并不意味着它已加密 - 只是无法查看。理论上，这可以阻止您的用户干预您的代码，但核心编码人员将能够绕过密码。

所以 Excel 不需要解密任何代码——它只需要阻止人们查看它。

Office 2007*确实*加密了宏（不要问我如何或什么算法）。这可能是必要的，因为 XLSM 文件（或任何 Office 2007 文件）只是具有不同扩展名的 zip 文件。任何人都可以进入这些文件并四处寻找。

要回答您的最后一个问题 - 旧版 Office 格式的密码删除如何工作，我不完全确定。不同的供应商可能会以不同的方式解决问题，但我怀疑最常见的方法是对密码进行暴力攻击，直到找到匹配项。

Excel VBProject 对象有一个 Protection 属性，它将根据宏的保护状态返回不同的枚举（`vbext_pp_locked`例如，如果宏受保护）。如果您继续以编程方式尝试密码，直到`vbext_pp_locked`评估为假，您就会找到您的密码。

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2010-01-20T16:45:32.787

Phil 是正确的 - 密码阻止您查看模块，它们本身没有加密。我知道在 excel 2007 中，文件本质上是 XML 和其他文件的压缩集合，但我不知道如何处理加密的细节。对于早期版本 - excel 2、3、4、5、95、97、2000、XP 和 2003，有 [Microsoft Excel 文件格式的综合 OpenOffice.org 文档](http://sc.openoffice.org/excelfileformat.pdf)：

> Excel 文件格式被命名为 BIFF（二进制交换文件格式）。它用于存储所有类型的文档：工作表文档、工作簿文档和工作区文档。此文件格式有不同版本，具体取决于写入文件的 Excel 版本以及文档类型。
> 
> 多张工作簿文档（BIFF5-BIFF8）通常使用复合文档文件格式（也称为“OLE2 存储文件格式”或“Microsoft Office 兼容存储文件格式”）进行存储。它包含用于不同类型数据的多个流。可以在[此处](http://sc.openoffice.org/compdocfileformat.pdf)找到复合文档文件格式的完整文档。
> 
> 在大多数 BIFF 流中，工作簿保护块紧接在 DEFINEDNAME 块（即命名范围）之后，尽管 BIFF8 与该模式有很大不同。记录保护块 Biff5 - Biff8 中工作簿保护块的结构：

*   WINDOWPROTECT 窗口设置：1 = 受保护
*   PROTECT 工作簿内容：1 = 受保护
*   PASSWORD 密码的哈希值；0 = 无密码
*   PROT4REV 共享工作簿：1 = 受保护
*   PROT4REVPASS 共享密码的哈希值；0 = 无密码

密码块存储一个 16 位哈希值，根据工作表或工作簿保护密码计算得出。

* * *

## 回答 #3

> 赞同：-1
> 
> 时间：2014-03-28T21:44:11.677

有人制作了一个有效的 vba 代码，将所有 excel 文件的 vba 保护密码更改为“宏”，包括 .xlsm（2007+ 版本）。你可以通过浏览他的代码来了解它是如何工作的。

这是这个家伙的博客： http: [//lbeliarl.blogspot.com/2014/03/excel-removing-password-from-vba.html](http://lbeliarl.blogspot.com/2014/03/excel-removing-password-from-vba.html) 这是工作的文件：[https ://docs.google.com/file/ d/0B6sFi5sSqEKbLUIwUTVhY3lWZE0/编辑](https://docs.google.com/file/d/0B6sFi5sSqEKbLUIwUTVhY3lWZE0/edit)

从他的博客上的一篇文章中粘贴：

对于 Excel 2007/2010 (.xlsm) 文件，请执行以下步骤：

1.  创建一个新的 .xlsm 文件。
2.  在 VBA 部分，设置一个简单的密码（例如“宏”）。
3.  保存文件并退出。
4.  将文件扩展名更改为“.zip”，由任何存档程序打开它。
5.  找到文件：“vbaProject.bin”（在“xl”文件夹中）。
6.  从存档中提取它。
7.  使用十六进制编辑器打开刚刚提取的文件。
8.  从参数 DPB 中查找并复制值（引号中的值），例如：DPB="282A84CBA1CBA1345FCCB154E20721DE77F7D2378D0EAC90427A22021A46E9CE6F17188A"。（此值是为“宏”密码生成的。您可以使用此 DPB 值跳过步骤 1-8）

9.  对密码未知的文件（要解锁的文件）执行步骤 4-7。

10.  根据您在步骤 8 中复制的值更改此文件中的 DBP 值。

    > > 如果复制的值比加密文件中的短，您应该用 0（零）填充缺失的字符。如果值更长 - 这不是问题（按原样粘贴）。

11.  保存“vbaProject.bin”文件并退出十六进制编辑器。

12.  用修改后的文件替换现有的“vbaProject.bin”文件。
13.  将扩展名从“.zip”改回“.xlsm”
14.  现在，打开您需要在其中查看 VBA 代码的 excel 文件。VBA 代码的密码将只是宏（如我在此处显示的示例中所示）。

# .net - 将浮点数转换为整数时的.NET 错误？

> ID：259900
> 
> 赞同：1
> 
> 时间：2008-11-03T20:46:53.453
> 
> 标签：.net, floating-point

检查一下：这个小的 .NET 控制台程序产生了有趣的结果......请注意我如何以两种不同的方式将浮点数转换为整数：

```
using System;
using System.Collections.Generic;
using System.Linq;
using System.Text;

namespace CastVsConvert
{
    class Program
    {
        static void Main(string[] args)
        {
            int newWidth = 0;
            CalculateResizeSizes(600, 500, out newWidth);
        }

        static void CalculateResizeSizes(int originalWidth, int maxWidth, out int newWidth)
        {
            float percentage = 1.0F;
            percentage = maxWidth / (float)originalWidth;

            newWidth = (int)((float)originalWidth * percentage);
            int newWidthConvert = Convert.ToInt32((float)originalWidth * percentage);

            Console.Write("Percentage: {0}\n", percentage.ToString());
            Console.Write("Cast: {0}\n", newWidth.ToString());
            Console.Write("Convert: {0}\n", newWidthConvert.ToString());
        }
    }
} 
```

我希望“Cast”和“Convert”的输出是相同的，但它们不是......这是输出：

```
C:\Documents and Settings\Scott\My Documents\Visual Studio 2008\Projects\CastVsC
onvert\CastVsConvert\bin\Debug>CastVsConvert.exe
Percentage: 0.8333333
Cast: 499
Convert: 500 
```

有人知道为什么.NET 在这里返回不同的值吗？

* * *

## 回答 #1

> 赞同：14
> 
> 时间：2008-11-03T20:49:20.857

它不是错误，`cast`截断，`convert`回合。

看到[这个](https://stackoverflow.com/questions/104063/systemconverttoint-vs-int)

* * *

## 回答 #2

> 赞同：5
> 
> 时间：2008-11-03T20:48:59.720

转换是四舍五入时，演员会切掉小数点后的数字部分。

* * *

## 回答 #3

> 赞同：5
> 
> 时间：2008-11-03T20:49:42.963

[来自Convert.ToInt32](http://msdn.microsoft.com/en-us/library/303w38b8.aspx)返回值的文档：

> *值*四舍五入到最接近的 32 位有符号整数。如果 value 在两个整数的中间，则返回偶数；即4.5转换为4，5.5转换为6。

铸造不会四舍五入 - 它只是截断。乘法的结果略低于 500，因此强制转换会将其截断为 499，而 Convert.ToInt32 会将其四舍五入为 500。

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2008-11-03T20:59:04.457

有一个额外的隐藏演员可能导致了这种情况。例如，如果您使用它而不是重新计算：

```
int newWidthConvert = Convert.ToInt32(newWidth); 
```

你会得到同样的结果。当您使用 Reflector 查看时，发生的事情会变得更加清晰`Convert.ToInt32(float)`：

```
public static int ToInt32(float value)
{
    return ToInt32((double) value);
} 
```

有一个隐藏的演员表`Double`。

如果您添加几行进行调查，然后使用调试器进行查看，您将看到会发生什么：

```
float newWidth1 = ((float)originalWidth * percentage);
double newWidth2 = ((float)originalWidth * percentage); 
```

`double`更精确，并将值保存为 499.999999 和更多的十进制数字。 `float`不太精确并存储 500.0。整数转换会截断小数部分，因此根据中间转换得到 500 或 499。当你调用`Convert.ToInt32()`时，结果已经被转换为 a `float`，所以你得到`Double`500.0 的表示。就我个人而言，我更喜欢总是尽可能地使用`double`。

# nhibernate - NHibernate 在单独的程序集中加入了子类

> ID：259902
> 
> 赞同：8
> 
> 时间：2008-11-03T20:47:04.323
> 
> 标签：nhibernate, orm, fluent-nhibernate

我有以下解决方案项目结构：

> 应用程序核心实体
> 
> Application.Xtend.CustomerName.Entities

在核心项目中，我有一个实体**客户**拒绝。在 XTend 项目中，我定义了一个名为**xCustomer**的子类 Customer 的实体（因为此时缺少更好的名称......）。

这里的想法是我们的​​应用程序中有一个核心域模型。然后，客户可以创建一个新组件，其中包含对我们核心模型的扩展。当扩展程序集存在时，智能[IRepository](http://martinfowler.com/eaaCatalog/repository.html)类将返回核心类的子类。

我试图在[NHibernate](http://nhforge.org/)中映射这种关系。使用[Fluent NHibernate](http://code.google.com/p/fluent-nhibernate/)我能够生成这个映射：

```
<?xml version="1.0" encoding="utf-8"?>
<hibernate-mapping xmlns="urn:nhibernate-mapping-2.2"
                   default-lazy="false"
                   assembly="NHibernate.Core.Entites"
                   namespace="NHibernate.Entites"
                   default-access="field.camelcase-underscore">
  <!-- Customer is located in assembly Application.Core.Entities -->
  <class name="Customer" table="Customers" xmlns="urn:nhibernate-mapping-2.2">
    <id name="Id" column="Id" type="Int64">
      <generator class="native" />
    </id>
    <component name="Name" insert="true" update="true">
      <property name="LastName" column="LastName" length="255" type="String" not-null="true">
        <column name="LastName" />
      </property>
      <property name="FirstName" column="FirstName" length="255" type="String" not-null="true">
        <column name="FirstName" />
      </property>
    </component>
    <!-- xCustomer is located in assembly Application.XTend.CustomerName.Entities -->
    <joined-subclass name="xCustomer" table="xCustomer">
      <key column="CustomerId" />
      <property name="CustomerType" column="CustomerType" length="255" type="String" not-null="true">
        <column name="CustomerType" />
      </property>
    </joined-subclass>
  </class>
</hibernate-mapping> 
```

但是 NHib 抛出以下错误：

> NHibernate.MappingException：持久类 Application.Entites.xCustomer，找不到 Application.Core.Entites ---> System.TypeLoadException：无法从程序集“Application.Core.Entites”中加载类型“Application.Entites.xCustomer”，版本 = 1.0 .0.0，文化=中性，PublicKeyToken=null'..

这很有意义 xCustomer 没有在核心库中定义。

是否可以像这样跨越不同的程序集？我是不是错误地解决了这个问题？

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2008-11-04T16:45:12.580

我在 NHibernate 用户邮件列表上问了同样的问题，解决方案非常明显，以至于我有点尴尬，我看不到它。

hibernate-mapping 属性程序集和命名空间是方便的捷径，使您不必完全限定您的类名。这使您可以很好地标记，但是 class 和joined-subclass 元素的 name 属性也可以采用完全限定的程序集名称。

所以上面损坏的映射文件可以像这样修复：

```
<joined-subclass name="Application.XTend.CustomerName.Entities.xCustomer, 
                 Application.XTend.CustomerName.Entities, Version=1.0.0.0, 
                 Culture=neutral, PublicKeyToken=null" 
                 table="xCustomer">
  <key column="CustomerId" />
  <property name="CustomerType" column="CustomerType" length="255" 
            type="String" not-null="true">
    <column name="CustomerType" />
  </property>
</joined-subclass> 
```

这按我的预期工作。因此，我查看了 Fluent-NHibernate 源并创建了一个完整的补丁，其中包含工作单元测试来解决问题并将[其提交给项目](http://code.google.com/p/fluent-nhibernate/issues/detail?id=70)。

感谢您的帮助@David Kemp

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2008-11-04T13:04:30.063

您需要使用元素的`extends`属性进行映射`<class>`（AFAIK，这是 NHibernate 2.0 中的新功能）。然后您可以`.hbm.xml`在 XTend 程序集中拥有您的子类映射 ( )。

您可能必须使用 AddAttribute/AddProperty（不记得它叫什么）才能使用 Fluent NHibernate 执行此操作。（或提交补丁）。

# dynamic - C#4.0 动态对象是否有一些鸭子类型的功能？

> ID：259929
> 
> 赞同：5
> 
> 时间：2008-11-03T20:56:11.607
> 
> 标签：dynamic, c#-4.0, duck-typing

根据 Anders 的说法，在 C#4.0 中，我们将获得动态类型，或“静态类型为动态”的对象。这将允许在运行时而不是编译时发生任何方法调用解析。但是是否有工具将动态对象绑定到某种合约（从而也获得完整的智能感知），而不是允许对其进行任何调用，即使你知道这不太可能是有效的。

即，而不仅仅是

```
dynamic foo = GetSomeDynamicObject(); 
```

有能力对其进行转换或转换以将其限制为已知的合同，例如

```
IFoo foo2 = foo.To<IFoo>; 
```

甚至只是

```
IFoo foo2 = foo as IFoo; 
```

在 C#4.0 的现有材料中找不到类似的东西，但它似乎是动态范式的逻辑扩展。有更多信息的人吗？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2008-11-03T21:14:01.807

恐怕我不知道有什么真正类似于鸭子打字的东西。我已经[在博客上介绍了这个想法](http://msmvps.com/blogs/jon_skeet/archive/2008/10/30/c-4-0-dynamic-lt-t-gt.aspx)，但我不希望得到任何支持。使用 Reflection.Emit 来创建一个类可能不会太难，该类将生成任何给定接口的实现，在构造函数中获取一个动态对象，并将每个调用代理到它。不理想，但它可能是一个权宜之计。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2008-11-03T21:44:21.120

这是一个很酷的主意。如果我理解你，你是在描述/提出 CLR 的功能，因此，当你尝试将动态对象强制转换为接口时，它应该查看动态对象支持的方法/属性，并查看它是否具有有效地实现该接口。然后 CLR 将负责在对象上“实现 IFoo”，因此您可以将动态对象强制转换为 IFoo。几乎可以肯定这不会得到支持，但这是一个有趣的想法。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2008-11-04T08:29:46.653

[Tobias Hertkorn在这里](https://stackoverflow.com/questions/245975/how-do-you-implement-c4s-idynamicobject-interface#260440)回答了我的问题，他的[博客文章](http://saftsack.fs.uni-bayreuth.de/~dun3/archives/first-look-ducktyping-c-4-0-idynamicobject-metaobject/202.html)链接显示了如何在 MetaObject 上使用 Convert() 方法返回动态代理的示例。它看起来*很有*希望。

# desktop - 用于开发桌面小部件的 UI 和平台选择

> ID：259934
> 
> 赞同：0
> 
> 时间：2008-11-03T20:58:48.357
> 
> 标签：desktop, widget

我被要求构建“小部件”，让 Web 应用程序的用户安装桌面或基于 Web 的小部件，这些小部件将提供：

*   新内容的通知。
*   对关键绩效指标的个性化访问

我正在寻找一些信息来告知我们的要求和设计讨论。

在桌面上，您可以定位 Vista 侧边栏，或者在 OS X 上，有仪表板，以及其他。从网络角度来看，您可以定位 iGoogle 和其他人。如果我要从开发拥有最多用户的小部件框架开始，我会选择哪个？有没有人提供用户数量的统计数据？

客户更愿意为最终用户提供更丰富的体验，我认为这可以使用桌面小部件框架来实现。但是，对于我们可以使用任何单个框架（例如侧边栏）访问的用户数量，会有一些问题。我可以针对什么技术或框架来实现跨平台兼容性？我们应该嵌入 Flash 吗？

我将建议创建一个独立的应用程序，而不是生活在一个小部件框架中。是否有任何框架可以帮助创建类似小部件的应用程序？

目标平台：

*   Windows（Windows XP 和更新版本）
*   苹果（OS X 10.4 及更新版本）
*   Linux（很高兴拥有）

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2008-11-20T15:12:31.757

您可以浏览一下[Adob​​e Air](http://www.adobe.com/go/air/)。

它允许在 Flash/Flex 或 HTML/JS 中进行跨平台开发。

# visual-studio - Visual Studio 2008，右键单击不再看到刷新项

> ID：259938
> 
> 赞同：0
> 
> 时间：2008-11-03T20:59:08.933
> 
> 标签：visual-studio, visual-studio-2008, ide

我以前可以右键单击项目中的文件夹并单击“刷新”以刷新其中的文件，但我看不到执行此操作的选项，我该如何解决？工作和家里也发生过同样的事情……一直都是这样吗？我疯了吗？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2008-11-03T21:35:14.367

我还有选择。您可以通过[自定义上下文菜单](http://blogs.msdn.com/saraford/archive/2008/01/30/did-you-know-you-can-customize-the-commands-on-the-context-menus.aspx)来取回它。刷新位于“自定义”对话框中的“命令”>“视图”下。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2008-11-03T21:31:58.133

刷新图标对我来说位于解决方案资源管理器的顶部，可以完成工作

# .net - n 层对象映射帮助

> ID：259941
> 
> 赞同：1
> 
> 时间：2008-11-03T21:00:07.123
> 
> 标签：.net, orm, n-tier-architecture, oop

想知道我的方法是否可行或可以改进：

```
Public Class Company  
  private _id as Integer
  private _name as String
  private _location as String

  Public Function LoadMultipleByLocation(Byval searchStr as String) as List(Of Company)
     'sql etc here to build the list
  End Function
End Classs 
```

有这样的对象映射的想法吗？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2008-11-03T21:09:53.407

在这种情况下，您将创建一个 Company 实例，然后使用它返回一个公司列表？

有些人这样做，但我更喜欢将我的数据对象分离到一个哑数据容器中：

```
public class Company : EntityBase
{
     private int _id;
     private string _name;
     private string _location;
} 
```

我使用一个基类 (EntityBase)，它包含将哑实体转换回 SQLParameters 集合（用于持久化）的常用方法，以及从传入的 SQLReader 实例化它（这在每个具体类中被覆盖，以映射阅读器到私有变量）。

然后我更喜欢使用一个“服务”类来实际进行数据库调用，创建适当的实体对象并返回它，我可以在这里利用多态性来大量减少代码重复。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2008-11-03T22:06:35.227

@担

EntityBase 将是每个实体对象将继承的基类，例如：

```
public class EntityBase
{
     public virtual string SaveSproc { get; }

     public virtual void LoadFromReader(SqlReader reader)
     {
     }

     public virtual void Save()
     {
         List<SqlParameters> paramList = = this.CreateParamsList();
         DoSqlStuff(this.SaveSproc, paramList);
     }

     public virtual List<SqlParamenter> CreateParamsList()
     { 
          return new List<SqlParameter>
     }
}

public Company : EntityBase
{

    private string _data;

public override string SaveSproc { get { return "SprocThatSaves"; } }

    public override List<SqlParameter> CreateParamList()
{   
    List<SqlParameter> param = new List<SqlParameter>
    param.Add(new SqlParameter("Data",_data);

    return param;   
}

public override void LoadFromReader(SqlReader reader)
{
    // PsuedoCode
    _data = reader["data"];
}
} 
```

现在，您的数据库层可以让阅读器了解公司数据，并执行以下操作：

```
Company = new Company();
Company.LoadFromReader(reader); 
```

在其他地方，要保存您的数据：

```
Company.Save(); 
```

# performance - 如何最小化 Oracle 中的事务开销？

> ID：259943
> 
> 赞同：1
> 
> 时间：2008-11-03T21:00:45.093
> 
> 标签：performance, oracle, transactions

我必须同时将数据加载到表中并对其运行查询。由于数据性质，我可以用完整性换取性能。我怎样才能最大限度地减少交易的开销？

不幸的是，不能使用 MySQL 之类的替代方案（由于非技术原因）。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2008-11-03T21:06:13.257

您希望事务隔离读取未提交。我不推荐它，但这就是你要求的:)

这将允许您破坏事务隔离并读取未提交的插入数据。

请阅读这篇 Ask Tom 文章：[http](http://www.oracle.com/technology/oramag/oracle/05-nov/o65asktom.html) ://www.oracle.com/technology/oramag/oracle/05-nov/o65asktom.html 。

更新：我实际上弄错了，Oracle 并不真正支持读取未提交的隔离级别，他们只是提到它:)。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2008-11-03T21:14:59.353

也许我遗漏了一些东西，但是由于在 Oracle 中，读者不会阻止作者，而作者不会阻止读者，那么您要解决的问题到底是什么？

从正在读取数据的会话的角度来看，正在执行插入的会话并没有真正增加任何开销（更新可能会增加一些开销，因为读者必须查看 UNDO 表空间中的数据才能重建一个数据的读取一致性视图）。从插入数据的会话的角度来看，正在读取的会话并没有真正增加任何开销。当然，您的系统作为一个整体可能存在瓶颈，导致各种会话争用资源（即，如果您的插入使用了 100% 的可用 I/O 带宽，这将减慢必须执行的查询物理 I/O），但那不是

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2008-11-04T15:16:00.217

除了适用于所有数据库的一般优化实践（例如消除全表扫描、删除未使用或低效的索引等）之外，您还可以做一些事情。

1.  在[`No Archive Log`](http://www.adp-gmbh.ch/ora/admin/backup_recovery/archive_vs_noarchive_log.html)模式下运行。这牺牲了速度的可恢复性。
2.  对于插入使用[`/*+ APPEND */`提示](http://www.psoug.org/reference/hints.html)。这会将数据放入不会创建 UNDO 的高水位线上方的表中。缺点是没有使用现有的可用空间。
3.  在硬件方面，[`RAID 0`](http://www.acnc.com/04_01_00.html)大量较小的磁盘将为您提供最佳的插入性能，但根据您的使用情况[`RAID 10`](http://www.acnc.com/04_01_10.html)，其更好的读取性能可能会提供更好的适合性。

这就是说，我认为您不会从任何这些更改中获得太多收益。

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2011-06-29T15:23:33.030

您如何尝试禁用表中的所有约束，然后插入所有数据，然后再次启用它们？

即改变会话集约束=延迟；

但是，如果您在表创建期间没有将表中的约束设置为可延迟，则可能会出现一个小问题。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2008-11-12T18:07:20.167

你在看什么样的性能量？刀片是成批的还是许多小的？

在尝试思考获得良好性能的巧妙方法之前，您是否创建了任何简单的原型，可以让您更好地了解开箱即用的性能？很容易证明你不需要做任何特别的事情来实现目标。

# c# - HttpWebRequest，取消请求的已知问题？

> ID：259950
> 
> 赞同：0
> 
> 时间：2008-11-03T21:03:37.693
> 
> 标签：c#, .net, http, httpwebrequest

取消 HttpWebRequest HTTP 请求是否存在任何已知问题？我们发现当我们取消 4-5 个请求时，下一个请求会无限期挂起。

如果没有已知问题，那么我可能做错了什么......哪里有一个很好的资源示例来展示它是如何工作的（一个完整的解决方案，而不是几个代码片段）？

如果存在已知问题，我可以做些什么来解决它们，以便有效地取消我需要的尽可能多的请求？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2008-11-03T21:07:50.337

取消请求后，请注意关闭响应流，否则会有泄漏。

我通常在从 web 请求中获取响应时使用“using”来确保响应关闭：

```
WebRequest request = WebRequest.Create("http://google.com");

using (WebResponse response = request.GetResponse())
{
   //do my job
} 
```

这样，即使您取消请求，或者它在响应读取期间抛出异常，resposne 及其流也将被关闭。

# objective-c - Objective-C 中的 NSString 标记化

> ID：259956
> 
> 赞同：146
> 
> 时间：2008-11-03T21:06:35.423
> 
> 标签：objective-c, cocoa, tokenize

在 Objective-C 中标记/拆分 NSString 的最佳方法是什么？

* * *

## 回答 #1

> 赞同：277
> 
> 时间：2008-11-03T21:10:11.050

[在这里](http://borkware.com/quickies/one?topic=NSString)找到答案：

```
NSString *string = @"oop:ack:bork:greeble:ponies";
NSArray *chunks = [string componentsSeparatedByString: @":"]; 
```

* * *

## 回答 #2

> 赞同：32
> 
> 时间：2009-01-11T11:54:44.620

每个人都提到过`componentsSeparatedByString:`，但您也可以使用`CFStringTokenizer`（记住 an`NSString`和`CFString`是可互换的）这也将标记自然语言（例如不会在空格上分割单词的中文/日文）。

* * *

## 回答 #3

> 赞同：21
> 
> 时间：2008-11-04T06:55:01.180

如果您只想拆分字符串，请使用`-[NSString componentsSeparatedByString:]`. 对于更复杂的标记化，使用 NSScanner 类。

* * *

## 回答 #4

> 赞同：7
> 
> 时间：2008-11-06T02:33:35.590

如果您的标记化需求更复杂，请查看我的开源 Cocoa String 标记/解析工具包：ParseKit：

[http://parsekit.com](http://parsekit.com)

对于使用分隔符字符（如':'）的简单字符串拆分，ParseKit 肯定是矫枉过正。但同样，对于复杂的标记化需求，ParseKit 非常强大/灵活。

另请参阅[ParseKit 标记化文档](http://parsekit.com/tokenization.html)。

* * *

## 回答 #5

> 赞同：6
> 
> 时间：2012-08-28T00:00:33.287

如果要标记多个字符，可以使用 NSString 的`componentsSeparatedByCharactersInSet`. NSCharacterSet 有一些方便的预制集合，例如`whitespaceCharacterSet`和`illegalCharacterSet`. 它有 Unicode 范围的初始化器。

您还可以组合字符集并使用它们进行标记，如下所示：

```
// Tokenize sSourceEntityName on both whitespace and punctuation.
NSMutableCharacterSet *mcharsetWhitePunc = [[NSCharacterSet whitespaceAndNewlineCharacterSet] mutableCopy];
[mcharsetWhitePunc formUnionWithCharacterSet:[NSCharacterSet punctuationCharacterSet]];
NSArray *sarrTokenizedName = [self.sSourceEntityName componentsSeparatedByCharactersInSet:mcharsetWhitePunc];
[mcharsetWhitePunc release]; 
```

请注意，`componentsSeparatedByCharactersInSet`如果连续遇到多个 charSet 成员，则会生成空白字符串，因此您可能需要测试长度小于 1。

* * *

## 回答 #6

> 赞同：5
> 
> 时间：2014-03-31T12:08:54.007

* * *

## 回答 #7

> 赞同：2
> 
> 时间：2014-08-03T15:07:39.830

If you are looking for splitting linguistic feature's of a string (Words, paragraphs, characters, sentences and lines), use string enumeration:

```
NSString * string = @" \n word1!    word2,%$?'/word3.word4   ";

[string enumerateSubstringsInRange:NSMakeRange(0, string.length)
                           options:NSStringEnumerationByWords
                        usingBlock:
 ^(NSString *substring, NSRange substringRange, NSRange enclosingRange, BOOL *stop) {
     NSLog(@"Substring: '%@'", substring);
 }];

 // Logs:
 // Substring: 'word1'
 // Substring: 'word2'
 // Substring: 'word3'
 // Substring: 'word4' 
```

This api works with other languages where spaces are not always the delimiter (e.g. Japanese). Also using `NSStringEnumerationByComposedCharacterSequences` is the proper way to enumerate over characters, since many non-western characters are more than one byte long.

* * *

## 回答 #8

> 赞同：0
> 
> 时间：2013-05-01T15:33:16.150

我有一个案例，我必须在使用 ldapsearch 进行 LDAP 查询后拆分控制台输出。首先设置并执行 NSTask（我在这里找到了一个很好的代码示例：[Execute a terminal command from a Cocoa app](https://stackoverflow.com/questions/412562/execute-a-terminal-command-from-a-cocoa-app)）。但后来我不得不拆分和解析输出，以便仅从 Ldap-query-output 中提取打印服务器名称。不幸的是，这是相当乏味的字符串操作，如果我们用简单的 C 数组操作来操作 C 字符串/数组，这根本就没有问题。所以这是我使用可可对象的代码。如果您有更好的建议，请告诉我。

```
//as the ldap query has to be done when the user selects one of our Active Directory Domains
//(an according comboBox should be populated with print-server names we discover from AD)
//my code is placed in the onSelectDomain event code

//the following variables are declared in the interface .h file as globals
@protected NSArray* aDomains;//domain combo list array
@protected NSMutableArray* aPrinters;//printer combo list array
@protected NSMutableArray* aPrintServers;//print server combo list array

@protected NSString* sLdapQueryCommand;//for LDAP Queries
@protected NSArray* aLdapQueryArgs;
@protected NSTask* tskLdapTask;
@protected NSPipe* pipeLdapTask;
@protected NSFileHandle* fhLdapTask;
@protected NSMutableData* mdLdapTask;

IBOutlet NSComboBox* comboDomain;
IBOutlet NSComboBox* comboPrinter;
IBOutlet NSComboBox* comboPrintServer;
//end of interface globals

//after collecting the print-server names they are displayed in an according drop-down comboBox
//as soon as the user selects one of the print-servers, we should start a new query to find all the
//print-queues on that server and display them in the comboPrinter drop-down list
//to find the shares/print queues of a windows print-server you need samba and the net -S command like this:
// net -S yourPrintServerName.yourBaseDomain.com -U yourLdapUser%yourLdapUserPassWord -W adm rpc share -l
//which dispalays a long list of the shares

- (IBAction)onSelectDomain:(id)sender
{
    static int indexOfLastItem = 0; //unfortunately we need to compare this because we are called also if the selection did not change!

    if ([comboDomain indexOfSelectedItem] != indexOfLastItem && ([comboDomain indexOfSelectedItem] != 0))
    {

        indexOfLastItem = [comboDomain indexOfSelectedItem]; //retain this index for next call

    //the print-servers-list has to be loaded on a per univeristy or domain basis from a file dynamically or from AN LDAP-QUERY

    //initialize an LDAP-Query-Task or console-command like this one with console output
    /*

     ldapsearch -LLL -s sub -D "cn=yourLdapUser,ou=yourOuWithLdapUserAccount,dc=yourDomain,dc=com" -h "yourLdapServer.com" -p 3268 -w "yourLdapUserPassWord" -b "dc=yourBaseDomainToSearchIn,dc=com" "(&(objectcategory=computer)(cn=ps*))" "dn"

//our print-server names start with ps* and we want the dn as result, wich comes like this:

     dn: CN=PSyourPrintServerName,CN=Computers,DC=yourBaseDomainToSearchIn,DC=com

     */

    sLdapQueryCommand = [[NSString alloc] initWithString: @"/usr/bin/ldapsearch"];

    if ([[comboDomain stringValue] compare: @"firstDomain"] == NSOrderedSame) {

      aLdapQueryArgs = [NSArray arrayWithObjects: @"-LLL",@"-s", @"sub",@"-D", @"cn=yourLdapUser,ou=yourOuWithLdapUserAccount,dc=yourDomain,dc=com",@"-h", @"yourLdapServer.com",@"-p",@"3268",@"-w",@"yourLdapUserPassWord",@"-b",@"dc=yourFirstDomainToSearchIn,dc=com",@"(&(objectcategory=computer)(cn=ps*))",@"dn",nil];
    }
    else {
      aLdapQueryArgs = [NSArray arrayWithObjects: @"-LLL",@"-s", @"sub",@"-D", @"cn=yourLdapUser,ou=yourOuWithLdapUserAccount,dc=yourDomain,dc=com",@"-h", @"yourLdapServer.com",@"-p",@"3268",@"-w",@"yourLdapUserPassWord",@"-b",@"dc=yourSecondDomainToSearchIn,dc=com",@"(&(objectcategory=computer)(cn=ps*))",@"dn",nil];

    }

    //prepare and execute ldap-query task

    tskLdapTask = [[NSTask alloc] init];
    pipeLdapTask = [[NSPipe alloc] init];//instead of [NSPipe pipe]
    [tskLdapTask setStandardOutput: pipeLdapTask];//hope to get the tasks output in this file/pipe

    //The magic line that keeps your log where it belongs, has to do with NSLog (see https://stackoverflow.com/questions/412562/execute-a-terminal-command-from-a-cocoa-app and here http://www.cocoadev.com/index.pl?NSTask )
    [tskLdapTask setStandardInput:[NSPipe pipe]];

    //fhLdapTask  = [[NSFileHandle alloc] init];//would be redundand here, next line seems to do the trick also
    fhLdapTask = [pipeLdapTask fileHandleForReading];
    mdLdapTask  = [NSMutableData dataWithCapacity:512];//prepare capturing the pipe buffer which is flushed on read and can overflow, start with 512 Bytes but it is mutable, so grows dynamically later
    [tskLdapTask setLaunchPath: sLdapQueryCommand];
    [tskLdapTask setArguments: aLdapQueryArgs];

#ifdef bDoDebug
    NSLog (@"sLdapQueryCommand: %@\n", sLdapQueryCommand);
    NSLog (@"aLdapQueryArgs: %@\n", aLdapQueryArgs );
    NSLog (@"tskLdapTask: %@\n", [tskLdapTask arguments]);
#endif

    [tskLdapTask launch];

    while ([tskLdapTask isRunning]) {
      [mdLdapTask appendData: [fhLdapTask readDataToEndOfFile]];
    }
    [tskLdapTask waitUntilExit];//might be redundant here.

    [mdLdapTask appendData: [fhLdapTask readDataToEndOfFile]];//add another read for safety after process/command stops

    NSString* sLdapOutput = [[NSString alloc] initWithData: mdLdapTask encoding: NSUTF8StringEncoding];//convert output to something readable, as NSData and NSMutableData are mere byte buffers

#ifdef bDoDebug
    NSLog(@"LdapQueryOutput: %@\n", sLdapOutput);
#endif

    //Ok now we have the printservers from Active Directory, lets parse the output and show the list to the user in its combo box
    //output is formatted as this, one printserver per line
    //dn: CN=PSyourPrintServer,OU=Computers,DC=yourBaseDomainToSearchIn,DC=com

    //so we have to search for "dn: CN=" to retrieve each printserver's name
    //unfortunately splitting this up will give us a first line containing only "" empty string, which we can replace with the word "choose"
    //appearing as first entry in the comboBox

    aPrintServers = (NSMutableArray*)[sLdapOutput componentsSeparatedByString:@"dn: CN="];//split output into single lines and store it in the NSMutableArray aPrintServers

#ifdef bDoDebug
    NSLog(@"aPrintServers: %@\n", aPrintServers);
#endif

    if ([[aPrintServers objectAtIndex: 0 ] compare: @"" options: NSLiteralSearch] == NSOrderedSame){
      [aPrintServers replaceObjectAtIndex: 0 withObject: slChoose];//replace with localized string "choose"

#ifdef bDoDebug
      NSLog(@"aPrintServers: %@\n", aPrintServers);
#endif

    }

//Now comes the tedious part to extract only the print-server-names from the single lines
    NSRange r;
    NSString* sTemp;

    for (int i = 1; i < [aPrintServers count]; i++) {//skip first line with "choose". To get rid of the rest of the line, we must isolate/preserve the print server's name to the delimiting comma and remove all the remaining characters
      sTemp = [aPrintServers objectAtIndex: i];
      sTemp = [sTemp stringByTrimmingCharactersInSet: [NSCharacterSet whitespaceAndNewlineCharacterSet]];//remove newlines and line feeds

#ifdef bDoDebug
      NSLog(@"sTemp: %@\n", sTemp);
#endif
      r = [sTemp rangeOfString: @","];//now find first comma to remove the whole rest of the line
      //r.length = [sTemp lengthOfBytesUsingEncoding:NSUTF8StringEncoding];
      r.length = [sTemp length] - r.location;//calculate number of chars between first comma found and lenght of string
#ifdef bDoDebug
      NSLog(@"range: %i, %i\n", r.location, r.length);
#endif

      sTemp = [sTemp stringByReplacingCharactersInRange:r withString: @"" ];//remove rest of line
#ifdef bDoDebug
      NSLog(@"sTemp after replace: %@\n", sTemp);
#endif

      [aPrintServers replaceObjectAtIndex: i withObject: sTemp];//put back string into array for display in comboBox

#ifdef bDoDebug
      NSLog(@"aPrintServer: %@\n", [aPrintServers objectAtIndex: i]);
#endif

    }

    [comboPrintServer removeAllItems];//reset combo box
    [comboPrintServer addItemsWithObjectValues:aPrintServers];
    [comboPrintServer setNumberOfVisibleItems:aPrintServers.count];
    [comboPrintServer selectItemAtIndex:0];

#ifdef bDoDebug
    NSLog(@"comboPrintServer reloaded with new values.");
#endif

//release memory we used for LdapTask
    [sLdapQueryCommand release];
    [aLdapQueryArgs release];
    [sLdapOutput release];

    [fhLdapTask release];

    [pipeLdapTask release];
//    [tskLdapTask release];//strangely can not be explicitely released, might be autorelease anyway
//    [mdLdapTask release];//strangely can not be explicitely released, might be autorelease anyway

    [sTemp release];

    }
} 
```

* * *

## 回答 #9

> 赞同：0
> 
> 时间：2014-01-15T12:45:48.403

我自己遇到过这样的例子，其中仅按组件分隔字符串是不够的，许多任务，例如
1）将令牌分类为类型
2）添加新令牌
3）在自定义闭包之间分隔字符串，如“{”和“} 之间的所有单词“
对于任何此类要求，我发现[Parse Kit](http://parsekit.com/)是救生员。

我用它成功地解析了 .PGN（prtable 游戏符号）文件，它非常快速且精简。

# unit-testing - 单元测试对你意味着什么？

> ID：259957
> 
> 赞同：6
> 
> 时间：2008-11-03T21:07:16.857
> 
> 标签：unit-testing, testing, integration-testing

天，

我正在与一群离岸开发人员一起工作，他们一直在非常松散地使用术语单元测试。

他们的 QA 文档讨论了编写单元测试然后执行系统的单元测试。

这根本不符合我对单元测试的解释。

我习惯于将单元测试作为一个测试或一组测试，用于练习单个类，通常作为一个黑盒。被测类可能需要实现包含其他类，但通常它是由单元测试执行的单个类。

然后是系统功能测试、集成测试、验收测试等。

我想知道这对我来说是不是有点迂腐？或者这就是您在提到单元测试和单元测试时所想到的？

编辑：罗布·威尔斯。我需要澄清的是，从黑盒的角度进行此类测试只是一方面。当使用模拟对象来验证内部行为时，您实际上是从白盒的角度进行测试，因为您知道要在盒子内发生什么。

* * *

## 回答 #1

> 赞同：10
> 
> 时间：2008-11-03T21:13:36.410

开发人员通常使用单元测试来测试独立的代码段。它们涵盖边界情况、错误情况和正常情况。它们旨在证明有限代码段的正确性。如果你所有的单元测试都通过了，那么你已经证明你的独立代码段做了它们应该做的事情。

当您进行集成测试时，您正在查看端到端案例，以查看所有通过单元测试的段是否一起工作。功能测试检查代码是否满足指定的要求。验收测试由最终用户完成，以查看他们是否批准最终产品。

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2008-11-03T21:18:56.680

没有理由单元测试不能跨越多个类，甚至子模块，只要测试只处理一个一致的业务操作。想想“calculateWage”，BO 的一种方法，它使用不同的策略来计算一个人的薪水。在我看来，这是一个单元测试。

* * *

## 回答 #3

> 赞同：4
> 
> 时间：2008-11-03T22:18:47.120

我尝试实施单元测试来只测试一个方法。我努力为我正在测试的方法所使用的依赖类和方法创建“模拟”类......以便在该方法中执行代码实际上不会调用单元中其他方法中的代码测试不应该是“测试”（这些方法还有其他单元测试）这样，单元测试的失败可靠地表明单元测试正在测试的方法失败......

模拟类旨在“模拟”依赖类的接口和行为，以便我正在测试的方法可以调用它们，并且它们将根据系统要求以标准、明确定义的方式运行。为了使这种方法有效，对此类依赖类及其方法的调用必须在定义良好的接口上进行，以便“测试器”进程可以将依赖类的 Mock 版本“注入”到正在测试的类中的实际生产版本...... 这有点像一种常见的设计模式，称为“依赖注入”或“控制反转”（IOC）

市场上有几种第三方工具可以帮助您实现这种模式。我听说过一种叫做“Rhino-Mock”或类似的东西......

编辑：罗布·威尔斯。@查尔斯。谢谢你。我忘记了使用模拟对象来完全替换使用除了被测对象之外的其他类。

在您提到模拟对象后，我还记得的其他几件事是：

*   它们可用于模拟包含的类返回的错误。
*   它们可用于引发特定异常以检查被测类中的异常处理。
*   它们可用于模拟设置成本高的项目，例如大型 SQL DB 后端。
*   它们可用于验证传入请求的内容。

有关更多信息，请查看 Martin Fowler 的论文“ [Mocks Aren't Stubs](http://martinfowler.com/articles/mocksArentStubs.html) ”和 The Pragmatic Programmers 的文章“ [Mock Objects](http://media.pragprog.com/articles/may_02_mock.pdf) ”

* * *

## 回答 #4

> 赞同：3
> 
> 时间：2008-11-03T21:14:39.620

我听说过许多单元测试首先完成的技术，然后围绕它们进行开发。刚刚有人评论说这是“测试驱动开发”——TDD（感谢 Elie）。

但是，如果这是一个离岸业务，可能会因为他们花时间进行这些单元测试而向您收取更多费用 - 那么我会小心。从具有单元测试经验的人那里获得第二意见，他们将验证他们实际上正在按照他们所说的那样做。

据我了解，单元测试将为任何开发项目增加一点时间，但当然可以提供一些质量控制。尽管如此，这是我想要的内部项目的质量控制类型。这可能只是离岸公司扔在那里给你一个温暖的模糊的东西。

* * *

## 回答 #5

> 赞同：3
> 
> 时间：2008-11-03T21:24:37.963

您用于测试的过程与用于支持它的技术之间存在差异。用于单元测试的各种框架通常都非常灵活，可以用于测试小代码单元、大单元甚至整个流程。这种灵活性会导致混乱。

我的建议是，无论您采用何种特定方法或流程，都将各种单元测试分成不同的程序集或模块。确切的安排取决于您的代码和您公司的组织。

使用单元测试框架的累积效应是代码的大部分测试都是自动化的。正确采用的开发人员可以更好地评估对代码的更改，而无需经过完整的问答过程。至于问答流程本身，它使他们的时间更有效率，因为开发出来的代码质量应该更高。

理解它不是所有质量问题的答案，它只是一个有用的工具，就像您使用的其他工具一样。

* * *

## 回答 #6

> 赞同：2
> 
> 时间：2008-11-03T21:15:02.583

[维基百科](http://en.wikipedia.org/wiki/Unit_test)似乎暗示单元测试是关于测试最少量的代码，在面向对象编程的情况下，这将是类上的一种方法。

有些人可能对单元测试的含义有更笼统的术语，有些人可能认为某些集成测试是单元测试，其中单元是组件的混合。

* * *

## 回答 #7

> 赞同：2
> 
> 时间：2008-11-03T21:34:32.887

传统观点认为[http://en.wikipedia.org/wiki/Software_testing是](http://en.wikipedia.org/wiki/Software_engineering)[http://en.wikipedia.org/wiki/Software_engineering](http://en.wikipedia.org/wiki/Software_testing)的一部分。*但我喜欢敏捷单元测试的想法：如果测试足够快，程序员总是*运行它，那么它就是敏捷单元测试。

 ** * *

## 回答 #8

> 赞同：2
> 
> 时间：2008-11-03T21:53:12.693

单元测试是你可以让自己在完成的路上最小的也是唯一的信心。这才是重要的，迭代地构建一个防止回归和规范偏差的屏障，而不是你如何将它实际集成到你的面向对象架构中。

* * *

## 回答 #9

> 赞同：1
> 
> 时间：2008-11-03T21:17:59.800

这几乎是“[什么是‘单位’？](https://stackoverflow.com/questions/239863/what-is-a-unit) ”问题的重复。

“单位”可以灵活定义。如果他们的文档没有“单位”的定义，您需要澄清这一点。

可能是他们将单元视为一大堆代码。这不是最理想的定义。

虽然我同意您有几层测试（单元、模块、包、应用程序），但我也认为其中大部分可以使用单元测试工具来完成。导致“什么是单位？” 问题一直在出现。

单位取决于上下文。对于个人开发者，单位必须是类。有时，它也意味着模块或包。

然而，对于一个团队来说，他们的单元可能是一个包或一个完整的应用程序。

* * *

## 回答 #10

> 赞同：0
> 
> 时间：2008-11-03T21:18:21.343

我们怎么想有什么关系？这里的问题是您对他们在文档中使用的术语不满意。你为什么不和他们讨论呢？

* * *

## 回答 #11

> 赞同：0
> 
> 时间：2008-11-03T21:36:24.210

十年前，在当前使用“单元测试”作为用代码编写的测试之前，同样的名称被应用于手动测试。我在一家软件开发公司工作，软件开发过程非常正式。在编写任何代码之前，我们必须编写“单元测试”。在那个时代，单元测试是在文本文档中编写的（例如 Word）。他们描述了用户在使用该应用程序时要遵循的确切步骤。例如，他们描述了在页面上键入以设置新客户的确切输入。或者，用户要搜索特定产品，并查看显示的信息与测试文档匹配。因此，测试是测试人员遵循的脚本，他们还记录了结果。当单元测试的新化身出现时，

* * *

## 回答 #12

> 赞同：0
> 
> 时间：2008-11-03T23:26:01.913

我也带领着一群离岸团队。假设我们有一组单元测试......但这并不意味着什么。:) 所以我们更多地依赖功能和测试人员的质量。单元测试的继承问题是您对函数有完美的了解，并且您信任开发人员。在现实世界中，这很难假设..

# feed - 在 atom 提要中公开数据

> ID：259959
> 
> 赞同：8
> 
> 时间：2008-11-03T21:08:11.473
> 
> 标签：feed, atom-feed

如何将额外数据添加到未映射到标准条目节点（标题、链接、id、更新、摘要）的 atom 提要中？是否可以在这里添加我自己的自定义 xml 并且仍然符合规范？

* * *

## 回答 #1

> 赞同：8
> 
> 时间：2008-11-03T21:17:28.133

[http://www.atomenabled.org/developers/syndication/atom-format-spec.php#extending_atom](http://www.atomenabled.org/developers/syndication/atom-format-spec.php#extending_atom)记录了几种不同的方法。

[您可以在atom:entry](http://www.atomenabled.org/developers/syndication/atom-format-spec.php#element.entry)的末尾添加[扩展元素](http://www.atomenabled.org/developers/syndication/atom-format-spec.php#extension)。

```
<atom:entry>
   <!--- all the normal stuff --->
   <mything:Thing xmlns:mything="http://example.com/example.xsd">
      <!--- whatever --->
   </mything:Thing>
</atom:entry> 
```

# matlab - 将文本值从 ASCII 文件读入 matlab 变量

> ID：259968
> 
> 赞同：7
> 
> 时间：2008-11-03T21:10:15.463
> 
> 标签：matlab, text, file-io, text-files, text-processing

考虑以下文件

```
var1 var2 variable3
1     2    3
11    22   33 
```

我想将数字加载到矩阵中，并将列标题加载到一个变量中，该变量相当于：

```
variable_names = char('var1', 'var2', 'variable3'); 
```

我不介意将名称和数字拆分为两个文件，但是准备 matlab 代码文件并对其进行评估不是一种选择。

请注意，可以有任意数量的变量（列）

* * *

## 回答 #1

> 赞同：9
> 
> 时间：2008-11-05T00:01:43.247

我建议对这样的操作使用**importdata**：

```
d = importdata('filename.txt'); 
```

返回是一个结构体，其数字字段位于名为“data”的成员中，列标题位于名为“colheaders”的字段中。

另一个用于导入此类操作数据的有用界面是统计工具箱中可用的“数据集”类。

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2008-11-03T21:48:40.393

如果标题在第一行，那么

```
A = dlmread(filename,delimString,2,1); 
```

将数值数据读入矩阵 A。

然后你可以使用

```
fid = fopen(filename)
headerString = fscanf(fid,'%s/n') % reads header data into a string
fclose(fid) 
```

然后，您可以使用*strtok*将 headerString 拆分为一个元胞数组。我能想到的一种方法是处理未知数量的列

编辑

修复 fscanf 函数调用

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2008-11-03T21:25:19.647

只需使用带有不同格式说明符的 textscan 即可。

```
fid = fopen(filename,'r');
heading = textscan(fid,'%s %s %s',1);
fgetl(fid); %advance the file pointer one line
data = textscan(fid,'%n %n %n');%read the rest of the data
fclose(fid); 
```

在这种情况下，“标题”将是一个单元格数组，其中包含每个列标题的单元格，因此您必须将它们更改为字符串的单元格数组或您想要的任何内容。'data' 将是一个元胞数组，其中包含您读取的每一列的数值数组，因此您必须将它们组合在一起以构成一个矩阵。

# com - CLSIDFromProgID 成功但 CreateInstace 失败！为什么？

> ID：259972
> 
> 赞同：2
> 
> 时间：2008-11-03T21:10:40.220
> 
> 标签：com, registry, createinstance, clsid, clsidfromprogid

我正在尝试创建一个 COM 对象的实例。我有实现接口的类名，并通过使用 CLSIDFromProgID() 获得 CLSID。因此，由于我获得了 CLSID，我认为从现在开始一切都会好起来的。但是，当我调用 CreateInstance 并传入 CLSID 时，我收到一条错误消息，提示“类未注册”。我也只在某些计算机上收到此错误。它在多台计算机上运行无错误。我不明白问题可能出在哪里。我的注册表脏了吗？有谁知道这里发生了什么？谢谢你的帮助！

我只想补充一点，这是一个 .NET COM 类。相应的条目位于注册表中，DLL 位于 GAC 中。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2008-11-03T21:32:10.193

CLSIDFromProgId 只是在注册表中查找 ProgId 的名称并将其转换为 CLSID，它不必查看注册表之外的任何内容，甚至无需检查是否有某些东西实际上正在实现该 CLSID。

当您在 CLSID 上调用 CreateInstance 时，Windows 将在注册表中查找对象应如何实例化（通常是 exe 或 dll）。然后它将尝试加载 dll（或启动 exe）并从中创建对象。

MSDN 中有很多关于所涉及过程的文档，例如参见“ [COM 类对象和 CLSID](http://msdn.microsoft.com/en-us/library/ms678406(VS.85).aspx) ”，如果你做了很多 COM 工作，那么值得从第一任负责人那里学习该过程，因为它可以节省大量时间调试此类问题时很麻烦。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2008-11-03T21:31:22.537

这是注册表中的两步过程。您使用 ProgID 来获取 CLSID。然后，当您调用 CreateInstance 时，COM 会使用 CLSID 查找 dll 的路径。您可以自己使用 regedit 来查找 CLSID 并查看该条目的外观。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2008-11-05T19:55:54.880

感谢您的回答。.Net 程序集已正确注册并存在于 GAC 中。一个绝对证实了这一点的应用程序是 Process Explorer。您可以查看每个应用程序加载的 dll。所以从这里我可以看到实例化 COM 对象的应用程序是否真的能够加载 DLL。我发现这确实发生了。问题是由于不同的区域设置。我们发现当地区没有设置为美国时，应用程序抛出了异常。此问题已修复。错误消息“类未注册”不是很有帮助。谢天谢地，这是一个快速修复。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2009-11-16T14:18:55.167

以 shell32 为例，您可以像这样创建一个新实例；

```
var shl = (Shell) Activator.CreateInstance(Type.GetTypeFromProgID("Shell.Application")); 
```

这将获得对现有组件的引用；

```
var shl2 = (Shell) Marshal.GetActiveObject("Shell.Application"); 
```

这是有关如何在[IronPython](http://www.ironpython.info/index.php/Interop_introduction)中执行相同操作的参考。

** 注意，这使用了 progid，clsid 几乎相同，只需使用 Type.GetTypeFromCLSID({GUID})。

# .net - Windows 窗体的验证控件？

> ID：259983
> 
> 赞同：4
> 
> 时间：2008-11-03T21:13:41.620
> 
> 标签：.net, winforms, .net-2.0

用于 Windows 窗体的 Visual Studio 2005 中的验证控件是否与用于 Web 窗体的一样？我没有看到他们。

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2008-11-03T21:17:44.310

这可以通过 ErrorProvider 类来实现：

[http://msdn.microsoft.com/en-us/library/system.windows.forms.errorprovider.aspx](http://msdn.microsoft.com/en-us/library/system.windows.forms.errorprovider.aspx)

希望这可以帮助！

亚当*********`**