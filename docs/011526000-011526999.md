# StackOverflow 问答 11526000-11526999

# android - 带有嵌套 textview 的 CustomView 无法正确恢复状态

> ID：11526001
> 
> 赞同：1
> 
> 时间：2012-07-17T15:38:48.120
> 
> 标签：android

我有一个带有嵌套 TextView 的自定义视图。我在“仪表板活动”上有两个自定义视图实例。不用说：文本视图都具有相同的 ID（相同的自定义视图）。我从自定义视图中定义的属性为 TextView 设置文本。

到目前为止一切正常。如果我将`android:freezesText`应用程序主题中的属性设置为`true`，那么奇怪的事情就会开始发生。

我的自定义视图在方向更改后重新创建，并按预期从属性中正确设置文本值。但是，当在文本视图上调用 TextView 的状态时 `void onRestoreInstanceState(Parcelable state)`，两个保存的状态都是相同的文本。

我在 Android 3.2（在真实设备上）以及 Android 4.0.3 模拟器上看到了这种行为。

这是一个重现该问题的小示例的[链接。](http://dl.dropbox.com/u/22456079/CustomViewFreezeText.zip)要查看它的实际效果，只需更改方向即可。

有人见过这样的吗？你们会说什么是使用`android:freezesText`或应该避免的最佳做法？

# d3.js - 如何使用自定义子节点创建 D3.js 树布局？

> ID：11526002
> 
> 赞同：2
> 
> 时间：2012-07-17T15:38:47.697
> 
> 标签：d3.js

我想可视化一系列分层的子弹图。具体来说，我希望能够单击我的顶级类别项目符号图，并将它们扩展到子主题细分，每个子主题都有一个项目符号图。

所以基本上，我想重新创建这个 D3 树示例： http: [//mbostock.github.com/d3/talk/20111018/tree.html](http://mbostock.github.com/d3/talk/20111018/tree.html)

但是让每个节点都是一个子弹图，而不仅仅是一个圆圈： http: [//mbostock.github.com/d3/ex/bullet.html](http://mbostock.github.com/d3/ex/bullet.html)

我是 D3 的新手，所以即使查看示例源代码，我也不知道从哪里开始。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-07-29T14:14:21.877

关键是画布就像一个真正的二维绘图画布。作为可视化控件的作者，您可以在画布上放置任何对象。您需要担心两件事...... 1）确保您拥有在画布上的特定点实现可视化所需的所有数据，以及 2）了解如何以您想要的方式绘制可视化渲染它，你想在画布上渲染它。

在将图表与树的节点混合的情况下，节点充当图表放置的参考点。您会很快注意到，您拥有的节点越多，由于画布混乱，渲染图表就越困难。换句话说，您将在树元素（节点和分支）上动态绘制图表。您可能需要考虑在与树可视化不竞争的画布的另一个区域（例如画布的左上角或左下角）中呈现与节点相关的图表。因此，例如，如果您将鼠标悬停在某个节点上，该节点会更改大小和/或颜色和/或形状以显示它当前“在上下文中”，同时，

无论如何，我希望这会有所帮助。

我最好的，

坦率

# bluetooth - 建立模拟蓝牙连接

> ID：11526007
> 
> 赞同：1
> 
> 时间：2012-07-17T15:39:04.193
> 
> 标签：bluetooth, emulation, bluecove

我想在同一台机器上运行的两个 Java 程序之间建立模拟蓝牙连接。我正在编写使用 BlueCove 的 BT 库连接到硬件设备的程序；我将蓝牙地址（例如“btspp://1C659DF6B5AC:1;master=false;encrypt=false;authenticate=false”，其中包含设备的 mac 地址）传递给我的程序进行连接。

我想编写另一个模拟硬件设备的 java 程序，以便我可以进行测试（我的硬件当前不工作）。有没有办法用mac地址或其他类型的蓝牙地址模拟蓝牙设备，可以将数据发送到我的程序？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-07-17T15:44:07.447

通过模拟硬件，您可能会做比需要更多的工作，是否可以在调用 BT 库“之前”创建模拟连接（或者让您暂时删除它）？

通过这样做，您可以制作一些行为类似于连接的代码，但不需要您编写设备驱动程序。

# android - 在布局中添加两个 webview 并获取事件点击到 webview

> ID：11526008
> 
> 赞同：1
> 
> 时间：2012-07-17T15:39:05.390
> 
> 标签：android, webview

我想创建一个具有如下 UI 的应用程序..我在屏幕中添加了两个 webview..我想当点击 webview2 时，webview1 将隐藏并且 webview2 将填充全屏......如果两个 webview 加载 url 是“http：/ /www.google.com" ，它将分别显示两个 webview 但如果我将不同的 URL 加载为 "http://www.google.com" 作为 "http://www.youtube.com" 它只显示 1 webview youtube全屏..我必须怎么做..谢谢

这是文件 XML：

```
<?xml version="1.0" encoding="utf-8"?>
<LinearLayout xmlns:android="http://schemas.android.com/apk/res/android"
android:layout_width="fill_parent"
android:layout_height="fill_parent"
android:orientation="horizontal" >      
    <LinearLayout
        android:layout_height="wrap_content"
        android:layout_width="wrap_content"
        android:id="@+id/layout1" 
        android:layout_weight="1"
    >
    <WebView
        android:layout_width="fill_parent"
        android:layout_height="fill_parent"
        android:id="@+id/webview1"
    />
    </LinearLayout>     
    <LinearLayout
    android:layout_weight="4"                   
        android:layout_height="wrap_content"
        android:layout_width="wrap_content"
        android:id="@+id/layout2" 
        android:layout_marginLeft="10dip"           
    >
    <WebView
        android:layout_width="fill_parent"
        android:layout_height="fill_parent"
        android:id="@+id/webview2"          
    />
    </LinearLayout> 
```

这是活动中的代码：

```
 DisplayMetrics displaymetrics = new DisplayMetrics();
    getWindowManager().getDefaultDisplay().getMetrics(displaymetrics);
    height = displaymetrics.heightPixels;
    width = displaymetrics.widthPixels;        
    layout1=(LinearLayout)findViewById(R.id.layout1);
    layout2=(LinearLayout)findViewById(R.id.layout2);
    webview1=(WebView)findViewById(R.id.webview1);        
    webview1.loadUrl("http://www.google.com");
    webview2=(WebView)findViewById(R.id.webview2);
    webview2.loadUrl("http://www.google.com");
    final LayoutParams lp=webview1.getLayoutParams();
    final LayoutParams lp1=webview2.getLayoutParams();                        
    lp.height=height;        
    lp1.height=height;

    webview1.setLayoutParams(lp);
    webview2.setLayoutParams(lp1);

    webview2.setOnClickListener(new OnClickListener() {

        public void onClick(View arg0) {
            // TODO Auto-generated method stub
            webview1.setVisibility(View.GONE);
            lp.height=height; 
            lp.width=width;
            webview2.setLayoutParams(lp);
        }
    }); 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-07-17T22:21:41.507

我建议创建 2 个自定义 WebView。

> WebView wv1 = findViewById(ID_WEBVIEW_1);
> 
> WebView wv2 = findViewById(ID_WEBVIEW_2);
> 
> if (wv1.getUrl() != "http://google.com" || wv2.getUrl() != "http://google.com") {
> 
> ```
>  ((ViewManager)entry.getParent()).removeView(entry); 
> ```
> 
> }

[http://developer.android.com/reference/android/view/ViewManager.html](http://developer.android.com/reference/android/view/ViewManager.html)

# java - 在 Java 编组中使用 @XmlAnyElement

> ID：11526009
> 
> 赞同：1
> 
> 时间：2012-07-17T15:39:08.040
> 
> 标签：java, jaxb, jax-ws, cxf

我有这门课

```
public class Header {

    @XmlAnyElement(lax = true)
    protected List<Object> any;

    // getters/setters omitted

} 
```

我如何（在 JAX-WS WebMethod 中）在标题中创建一个看起来像这样的元素 ID？

```
<Header>
    <ID>value</ID>
</Header> 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-07-17T17:44:43.490

您可以有一个如下所示的类并将其实例添加到`any`属性中，或者您可以将`org.w3c.dom.Element`表示`ID`元素的实例添加到集合中。

```
@XmlRootElement(name="ID")
@XmlAccessorType(XmlAccessType.FIELD)
public class ID {

    @XmlValue
    private String value;

} 
```

# python - Python：如何在返回有效的字符串变量后使脚本继续

> ID：11526019
> 
> 赞同：0
> 
> 时间：2012-07-17T15:39:55.030
> 
> 标签：python

我有一个关于 python 定义流程的问题：

```
def testCommandA () :
  waitForResult = testCommandB ()
  if result != '' :
     print 'yay' 
```

有没有办法让 waitForResult 等待 testCommandB 返回一些东西（不仅仅是一个空字符串）？有时 testCommandB 什么都不会产生（空字符串），我不想传递空字符串，但是一旦我在 waitForResult 中得到一个字符串，那么 testCommandA 将继续运行。可能吗？

提前致谢

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-07-17T15:42:44.780

```
# Start with an empty string so we run this next section at least once
result = ''
# Repeat this section until we get a non-empty string
while result == '':
    result = testCommandB()
print("result is: " + result) 
```

请注意，如果`testCommandB()`不阻塞，这将导致 100% 的 CPU 利用率，直到它完成。另一种选择是在检查之间[休眠。](http://docs.python.org/library/time.html#time.sleep)此版本每十分之一秒检查一次：

```
import time

result = ''
while result == '':
    time.sleep(0.1)
    result = testCommandB()
print("result is: " + result) 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-07-17T15:42:33.010

只从`testCommandB`它不是空字符串的地方返回。即，`testCommandB`阻塞直到它具有有意义的值。

# ios - 如何在 ASP.NET MVC 3 中使用 ios 工具，如滑动

> ID：11526021
> 
> 赞同：0
> 
> 时间：2012-07-17T15:40:02.627
> 
> 标签：ios, asp.net-mvc-3

我正在尝试修改 iPad 上的 ASP MVC 3 应用程序行为。例如，我想使用 iPad 很棒的滑动效果，而不是简单的分页。但是当我做了一些研究时，我发现在其他地方使用 IOS api 是不可能的本地应用程序。

那么有一些解决方法可以做到这一点吗？

谢谢

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-07-19T10:56:36.340

我设法使用 jQuery mobile 做到了这一点，实际上这很容易。这是一个例子

```
<div id="listitem">Swipe Right and left</div>
<javascript type="text/javascript">

  $("#listitem").live("swiperight", function () {
    alert('right');
  });

  $("#listitem").live("swipeleft",function () {
    alert('left');
  });

</javascript> 
```

# android - Android ViewPager 内存泄漏

> ID：11526022
> 
> 赞同：5
> 
> 时间：2012-07-17T15:40:07.457
> 
> 标签：android, memory-leaks, bitmap, android-viewpager

我需要用 5 张幻灯片在 Android 中创建 ViewPager，每张都由图像和文本组成。我有一个包含图像资源的数组：

```
 private static final int[] images = {R.drawable.tutorial_step_01, R.drawable.tutorial_step_02, R.drawable.tutorial_step_03, R.drawable.tutorial_step_04, R.drawable.tutorial_step_05, R.drawable.tutorial_step_06}; 
```

然后我创建适配器：

```
@Override
    public Object instantiateItem(ViewGroup container, int position) {

        LinearLayout tv = (LinearLayout) inflater.inflate(R.layout.tut_slide, null);
        TextView title = (TextView) tv.findViewById(R.id.tut_title);
        title.setText(getResources().getText(titles[position]));
        TextView content = (TextView) tv.findViewById(R.id.tut_content);
        ImageView image = (ImageView) tv.findViewById(R.id.tut_image);

        slide_image = BitmapFactory.decodeResource(getResources(), images[position]);
        image.setImageBitmap(slide_image);
        content.setText(getResources().getText(contents[position]));
        ((ViewPager) container).addView(tv, 0);
        return tv;
    }

    @Override
    public void destroyItem(ViewGroup container, int position, Object object) {
        ((ViewPager) container).removeView((LinearLayout) object); 
```

//
}

麻烦的是，在我选择另一个页面后，android 不想收集图像。因此，经过 10-15 次更改后，它会出现 OutOfMemory 异常。然后我添加到初始化行

```
if (slide_image!= null) {
            slide_image.recycle();
            System.gc();
        } 
```

而且效果很好！但除了一件事：我有黑屏而不是第一张图像，经过几次翻转后被真实图像取代。所以我不知道如何处理这种内存泄漏

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2015-05-05T00:54:27.360

好吧，我终于解决了这个问题。我遇到了一个非常相似的案例，因为我已经看到了很多与同一问题相关的问题，所以我选择了这个问题，因为它还没有得到回答。不仅应该在超过时`PagerAdapter`调用该方法，而且在发生屏幕旋转时也应该调用该方法，但它不会，因此必须强制这样做......要实现它，您只需将适配器设置为空关于活动的或方法。`destroyItem``offLimitScreenPageLimit``onStop``onDestroy`

```
@Override protected void onDestroy(){
    pager.setAdapter(null);
} 
```

干杯!

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-05-15T07:25:46.677

目前尚不清楚您使用的是什么，但我遇到了类似的问题。

我假设您正在使用 FragmentPagerAdapter。

当您使用该适配器滚动时，它不会破坏视图和缓存之外的页面。如果 FragmentPageAdapter 使用的 Fragment 中存在 ImageView，OOM 是不可避免的

只需将适配器的扩展更改为

FragmentStatePagerAdapter

这将销毁未使用的片段，并为新片段留出更多可用内存。

它仍然不完美，我发现有时我可以滚动比垃圾收集器拾取被破坏的位图更快，但它非常接近。

如果我想改进它，我会覆盖destroyItem，然后从imageview 中获取正在使用的位图并回收位图。

[回收 ImageView 的 Bitmap](https://stackoverflow.com/questions/7009086/recycle-imageviews-bitmap)

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-11-13T17:31:45.027

这种行为不应该与内存泄漏有关。看起来它与您在 viewpager 更新生命周期内何时以及如何回收位图有关。尝试在初始化时手动调用 onPageSelected() 或 notifyDatasetChanged()。

此解决方案可能无法完全解决问题，但请尝试一下。你的解释很难说清楚。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2020-11-13T11:18:01.973

在我的情况下，我在 ViewPager 中有 31 页。我用这个：

```
 @Override
    public void destroyItem(@NonNull ViewGroup container, int position, @NonNull Object object) {

        if(dbCon!=null)
            dbCon.close();

        ViewPager viewPager = (ViewPager)container;
        View view = (View) object;
        viewPager.removeView(view);
    } 
```

一切正常。阿罕杜里拉。

# interface-builder - Interface Builder Library 中没有复选框对象

> ID：11526024
> 
> 赞同：-2
> 
> 时间：2012-07-17T15:40:17.260
> 
> 标签：interface-builder

所以我在我的对象库中找不到复选框。我只有一个名为 Objects 的文件夹。如何将文件夹添加到复选框所在的对象库中？

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-07-17T15:50:49.877

iOS 不提供标准的复选框控件。它提供了一个开关 ( `UISwitch`)，它的作用与复选框大致相同，但看起来不同。那是你要的吗？

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-07-17T15:56:53.867

以下是如何从按钮制作复选框（您需要将操作连接到此方法并连接名为 的属性`checkboxout`）。搜索其他示例，我只是从我的一个程序中复制了这个。如果这没有意义，那么您应该做一些基本的objective-c/xcode 教程。（我听说 Ray Wenderlich 做得很好[http://www.raywenderlich.com/](http://www.raywenderlich.com/)）

正如您所知，如果您可以让自己使用开关，乔纳森的回答是一种更好的做事方式。

```
- (IBAction)checkbox:(id)sender 
    {
        UIButton *b = checkboxout;
        if (!boxChecked)
        {
            boxChecked = YES;
            [b setImage:isCheck forState:UIControlStateNormal];
            checkboxState = [NSNumber numberWithBool:boxChecked];
            return;
        }
        if (boxChecked)
        {
            boxChecked = NO;
            [b setImage:notCheck forState:UIControlStateNormal];
            checkboxState = [NSNumber numberWithBool:boxChecked];
            return;
        }
    }

//whatever your init method is for your view
{
    isCheck = [UIImage imageNamed:@"checkbox_checked.png"];
    notCheck = [UIImage imageNamed:@"checkbox_unchecked.png"];
    //probably other stuff
} 
```

# javascript - javascript：将脚本添加到 .js 文件的麻烦

> ID：11526035
> 
> 赞同：1
> 
> 时间：2012-07-17T15:40:38.087
> 
> 标签：javascript, jquery, asp.net-mvc

因此，对于分页，我有这个 url，当用户按下链接时，它会转到下一页（链接部分在部分视图中），为此，我使用 javascript 获取 dropdowbox 值并传递给 url

```
 @Html.ActionLink("|Siguiente >", "Index", new { pagina = Model.PageNumber + 1, ordenacion = ViewBag.Ordenacion, filtro = ViewBag.Filtro , empresa = "param-empresa" }, new { id = "mylinkSig" })

<script type="text/javascript">
     $(function () {
            $('#mylinkSig').click(function () {
                var empresa = $("#empresa").val();
                this.href = this.href.replace("param-empresa", encodeURIComponent(empresa));
            });
        });
</script> 
```

当我在几乎所有页面中使用该脚本时，我想将此脚本放入 js 文件中，因此我不必将其写入所有视图（页面）中您尝试复制/粘贴并放入 js 文件中，但它不起作用（是的，我的页面中有 .js 文件引用）

所以我是 javascript 的新手，所以我不知道是否必须更改函数，因为它可以在 .js 文件中工作并在我的所有页面中使用

编辑：

我的 Helper.js

```
$(function () {
    $('#mylinkSig').click(function () {
        var empresa = $("#empresa").val();
        this.href = this.href.replace("param-empresa", encodeURIComponent(empresa));
    });
});

function deleteConfirmation(response, status, data) {

    // remove the row from the table
    var rowId = "#widget-id-" + response.id;
    $('.widgets').find(rowId).remove();

    // display a status message with highlight
    $('#actionMessage').text(response.message);
    $('#actionMessage').effect("highlight", {}, 3000);
    if (response.message == null) {
        alert('No se pudo eliminar el registro');
    }
    else {
        alert(response.message);
    }

} 
```

我的观点

```
<script src="@Url.Content("~/Scripts/Helper.js")" type="text/javascript"></script>

&nbsp;
@*navigation << < >>>*@
<div>

    Pagina @(Model.PageCount < Model.PageNumber ? 0 : Model.PageNumber)
    de @Model.PageCount
    &nbsp;
    @if (Model.HasPreviousPage)
    {
        @Html.ActionLink("<<|", "Index", new { pagina = 1, ordenacion = ViewBag.Ordenacion, filtro = ViewBag.Filtro, empresa = "param-empresa" }, new { id = "mylinkFirst" })
        @Html.Raw("&nbsp;");
        @Html.ActionLink("< Anterior|", "Index", new { pagina = Model.PageNumber - 1, ordenacion = ViewBag.Ordenacion, filtro = ViewBag.Filtro, empresa = "param-empresa" }, new { id = "mylinkAnt" })
    }
    &nbsp;
    @if (Model.HasNextPage)
    {
        @Html.ActionLink("|Siguiente >", "Index", new { pagina = Model.PageNumber + 1, ordenacion = ViewBag.Ordenacion, filtro = ViewBag.Filtro , empresa = "param-empresa" }, new { id = "mylinkSig" })
        @Html.Raw("&nbsp;");
        @Html.ActionLink("|>>", "Index", new { pagina = Model.PageCount, ordenacion = ViewBag.Ordenacion, filtro = ViewBag.Filtro , empresa = "param-empresa"}, new { id = "mylinkLast" })
    }

</div>

&nbsp; 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-07-17T15:44:48.503

如果您有对该文件的引用，那么我最好的猜测是您也将`script`-tag 复制到 JS 文件中，这是您不应该的。

试着复制这部分：

```
$(function () {
    $('#mylinkSig').click(function () {
        var empresa = $("#empresa").val();
        this.href = this.href.replace("param-empresa", encodeURIComponent(empresa));
    });
}); 
```

如果这样做，则将代码放在页面中与将代码放在单独的文件中相比应该没有区别。

# json - 返回 RHEL/Apache 上 .json 文件的 application/json 内容类型

> ID：11526036
> 
> 赞同：7
> 
> 时间：2012-07-17T15:40:47.510
> 
> 标签：json, apache, mime, rhel

操作系统是专门运行 Apache2 的 RHEL6。

所以在我的 Apache 配置中，我有：

```
LoadModule mime_module modules/mod_mime.so 
```

在 中`/etc/mime.types`，我有以下内容：

```
application/json                                json 
```

然而，当请求具有`.json`扩展名（并包含有效 JSON）的文件时，内容类型设置为`text/html`. 知道如何为这种文件类型强制使用正确的标题吗？

* * *

## 回答 #1

> 赞同：15
> 
> 时间：2012-07-17T15:45:37.917

`AddType`在 apache 配置中使用指令：

> AddType 应用程序/json .json

# r - R中的临界t值

> ID：11526041
> 
> 赞同：18
> 
> 时间：2012-07-17T15:40:56.060
> 
> 标签：r

对于 40 个自由度，我需要确定 75% 和 99% 的一侧尾部的临界 t 值。

以下是双边 99% 临界 t 值的代码：

```
qt(0.01, 40) 
```

但我如何确定单边临界 t 值？

* * *

## 回答 #1

> 赞同：36
> 
> 时间：2012-07-17T15:53:15.443

您发布的代码为单面测试提供了临界值（因此您的问题的答案很简单：

```
abs(qt(0.25, 40)) # 75% confidence, 1 sided (same as qt(0.75, 40))
abs(qt(0.01, 40)) # 99% confidence, 1 sided (same as qt(0.99, 40)) 
```

请注意，t 分布是对称的。对于 2 面测试（比如 99% 的置信度），您可以使用临界值

```
abs(qt(0.01/2, 40)) # 99% confidence, 2 sided 
```

* * *

## 回答 #2

> 赞同：5
> 
> 时间：2012-07-17T15:55:42.933

乔希的评论很到位。如果您对临界值不太熟悉，我建议您使用 qt，阅读手册 ( `?qt`) 并查看查找表 ( [LINK](http://3.bp.blogspot.com/_5u1UHojRiJk/TEdJJc6of2I/AAAAAAAAAIE/Ai0MW5VgIhg/s1600/t-table.jpg) )。当我第一次从 SPSS 转移到 RI 时，我创建了一个函数，使关键 t 值看起来很容易（我现在永远不会使用它，因为它需要太多时间，而且输出中通常提供的 p 值是一个有争议的点）。这是代码：

```
critical.t <- function(){
    cat("\n","\bEnter Alpha Level","\n")
    alpha<-scan(n=1,what = double(0),quiet=T)
    cat("\n","\b1 Tailed or 2 Tailed:\nEnter either 1 or 2","\n")
    tt <- scan(n=1,what = double(0),quiet=T)
    cat("\n","\bEnter Number of Observations","\n")
    n <- scan(n=1,what = double(0),quiet=T)
    cat("\n\nCritical Value =",qt(1-(alpha/tt), n-2), "\n")
}

critical.t() 
```

* * *

## 回答 #3

> 赞同：3
> 
> 时间：2015-05-02T01:08:28.363

扩展上面的@Ryogi 答案，您可以像这样利用`lower.tail`参数：

`qt(0.25/2, 40, lower.tail = FALSE)`# 75% 的信心

`qt(0.01/2, 40, lower.tail = FALSE)`# 99% 的信心

# sql - Codeigniter ORM active_record 示例生成器 sql WHERE id ='1' AND ( c1 like '%3%' OR c2 like '%3%' )

> ID：11526047
> 
> 赞同：1
> 
> 时间：2012-07-17T15:41:01.870
> 
> 标签：sql, codeigniter, activerecord, orm, codeigniter-datamapper

使用 CodeIgniter ORM active_record，例如我可以生成 SQL ..？

示例生成器 SQL：**... AND( LIKE ... OR LIKE ...)**

```
SELECT id, c1, c2 FORM t1 WHERE id ='1' AND ( c1 LIKE '%3%' OR c2 LIKE '%3%' ) 
```

Enccontre 不是以组合 ORM 函数的形式来生成类似于我在 SQL 实例中显示的内容。

这是什么，但最灭亡的不是我想要的。

```
$this->db->select('id, c1, c2')
                ->from('t1')
                ->where('id', '1111')
                ->like('c1',$sSearch)
                ->or_like('c2',$sSearch)
                ->get(); 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-07-17T16:59:10.810

当混合`AND`和时`OR`，括号是你的朋友。CodeIgniter 的活动记录不支持混音`AND`，`OR`随心所欲。

CodeIgniter 将输出以下查询：

```
SELECT id, c1, c2 FORM t1 WHERE id ='1' AND c1 LIKE '%3%' OR c2 LIKE '%3%' 
```

显然，这不是你想要的。您可以做的是：传递一个自定义字符串以`WHERE`将其用作子句。

```
// Since we are using a custom string, we need to escape manually
$sSearch = $this->db->escape_like_str($sSearch);
$this->db->select('id, c1, c2')
            ->from('t1')
            ->where('id', '1')
            // this will add the clause like you want
            ->where("(`c1` LIKE '%$sSearch%' OR `c2` LIKE '%$sSearch%')", NULL, FALSE)
            ->get(); 
```

这将输出您想要的查询：

```
SELECT id, c1, c2 FORM t1 WHERE id ='1' AND (c1 LIKE '%3%' OR c2 LIKE '%3%') 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-07-17T16:47:29.163

由于您的英语很难理解，因此我正在尝试这样做...

我假设您尝试`%`在关键字之前或之后使用带有通配符的 LIKE ..

您可以通过在 like 或 or_like 中使用 before、after、both(default) 来做到这一点。

```
<?php
$this->db
     ->select('id, c1, c2')
     ->from('t1')
     ->where('id', '1111')
      //$this->db->like('title', 'match', 'before'); 
      //Produces: WHERE title LIKE '%match'  
      //$this->db->like('title', 'match', 'after'); 
      //Produces: WHERE title LIKE 'match%' 
      //$this->db->like('title', 'match', 'both'); 
      //Produces: WHERE title LIKE '%match%'
     ->like('c1', $sSearch)
     ->or_like('c2', $sSearch)
     ->get(); 
```

* * *

或者您可以使用原始 sql 执行 - [http://codeigniter.com/user_guide/database/queries.html](http://codeigniter.com/user_guide/database/queries.html)

```
<?php $this->db->query("YOUR SEQUEL STATEMENT HERE"); 
```

# r - 如何为多元概率模型组织数据？

> ID：11526051
> 
> 赞同：2
> 
> 时间：2012-07-17T15:41:10.080
> 
> 标签：r

我对一些科目进行了心理测试，我正在尝试创建一个多元概率模型。

测试如下：

受试者1在11种不同条件下给予一定刺激，每种条件10次。答案 ( `correct=1`, `uncorrect=0`) 已注册。所以对于主题 1，我有以下结果表：

```
# Subj 1
      correct
cnt    1  0

  1    0 10
  2    0 10
  3    1  9
  4    5  5
  5    7  3
  6   10  0
  7   10  0
  8   10  0
  9    9  1
  10  10  0
  11  10  0 
```

这意味着 Subj1 在条件 1 和 2 下答错了 10 次，在条件 10 和 11 下答对了 10 次。对于其他条件，响应从条件 3 增加到条件 9。我希望我很清楚。

我通常使用以下代码分析数据：

```
prob.glm <- glm(resp.mat1 ~ cnt, family = binomial(link = "probit")) 
```

这`resp.mat1`是响应表，而`cnt`对比表是`c(1,11)`。所以我可以使用该`predict()`函数绘制 sigmoid 曲线。主题 1 的图表如下。

![在此处输入图像描述](../Images/7575b8d0fa77581744756fada9397049.png)

现在假设我对 20 个科目进行了相同的测试。我现在有 20 张桌子，像第一个一样组织。

我想要做的是比较子组，例如`male vs. female`：`young vs. older`等等。但我想保持个体间的可变性，所以简单地“添加”20 个表是错误的。

如何组织数据以使用该`glm()`功能？

我希望能够编写如下命令：

```
prob.glm <- glm(resp.matTOT ~ cnt + sex, family = binomial(link = "probit")) 
```

然后绘制`sex=M`, 和的曲线`sex=F`。

我尝试使用该`rbind()`函数创建一个唯一的表，然后为`Subj (1 to 20)`、`Sex`、 . 添加列`Age`。但它看起来我是一个糟糕的解决方案，所以任何替代解决方案都将不胜感激。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-07-17T17:50:47.533

看起来您使用了错误的功能来完成这项工作。检查`glmer`in package的第一个示例`lme4`；它非常接近你想要的。`herd`应该由主题编号替换，但请确保您执行类似的操作

```
mydata$subject = as.factor(mydata$subject) 
```

当您有数字主题编号时。

```
# Stolen from lme4
library(lattice)
library(
xyplot(incidence/size ~ period|herd, cbpp, type=c('g','p','l'),
       layout=c(3,5), index.cond = function(x,y)max(y))
(gm1 <- glmer(cbind(incidence, size - incidence) ~ period + (1 | herd),
              data = cbpp, family = binomial)) 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-07-18T10:48:15.883

`mlogit`在所有事物的库中有一个多元概率命令。您可以在此处查看所需数据结构的示例：

[https://stats.stackexchange.com/questions/28776/multinomial-probit-for-varying-choice-set](https://stats.stackexchange.com/questions/28776/multinomial-probit-for-varying-choice-set)

# c++ - ofstream::open 创建文件，但随后崩溃（locale::getloc() 中的指针错误？）

> ID：11526054
> 
> 赞同：1
> 
> 时间：2012-07-17T15:41:32.157
> 
> 标签：c++, file, crash, ofstream

所以我有一些看起来像这样的代码，用 Visual Studio 2010 编写和编译：

```
if ( outputFile.is_open() )
{
    outputFile.close();
}
if ( !outputFile.is_open() ) // condition for sanity-checking
{
    outputFile.open("errorOut.txt", ios::out);
} 
```

这会在访问冲突时崩溃。附加调试器显示第一个条件为假（`outputFile`未打开），第二个条件为真（`outputFile`已关闭，这很好，因为我刚刚检查过）。然后`open()`被调用，并最终`locale::getloc()`尝试取消引用空指针，但我不知道为什么会发生这种情况（因为现在标准库中有三个类）。

有趣的是，文件“errorOut.txt”*确实*被创建了，即使`open`调用崩溃了。

我已经在调试器中看了几个小时，但老实说，我不知道发生了什么。任何人都有任何想法甚至试图确定代码有什么问题？完全有可能其他地方的某些代码导致了这种情况（继承代码），但是有很多，我什至不知道去哪里找。到目前为止，一切似乎都很好。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-07-24T21:57:56.063

好的，我不确定这是否是处理此问题的最佳方法，但由于这涉及一些真正奇怪的行为（在 STL 函数中间崩溃，以及其他一些奇怪的事情，如挂断`exit(1);`等），我'以后会在这里留下一个解释。

在我们的例子中，错误似乎源于我们继承的一些真正糟糕的代码中发生的一些内存损坏。清理代码通常可以消除程序显示的这种崩溃和其他奇怪行为。

我不知道这是否对任何人有用；也许简单地删除问题会更好。如果有人想发表评论，我实际上有点好奇我是否应该这样做。

# algorithm - 有没有办法在 A* 中保持方向优先级？（即生成与广度优先相同的路径）

> ID：11526055
> 
> 赞同：10
> 
> 时间：2012-07-17T15:41:34.683
> 
> 标签：algorithm, graph, path-finding, a-star

我有一个可以从使用 A* 中受益的应用程序；但是，由于遗留原因，当有多个最佳路径可供选择时，我*需要*它继续生成与之前**完全相同的路径。**

例如，考虑这个迷宫

```
...X
FX.S
……

S = 开始
F = 完成
X = 墙
. = 空白空间

```

方向优先级**向上；对; 向下; 左**。使用广度优先，我们将找到路径 DLLLU；但是，使用 A*，我们立即向左走，最终找到路径 LULLD。

我尝试过确保在打破关系时始终朝着正确的方向扩展；并在从更重要的方向移动时覆盖`PreviousNode`指针，但在该示例中均无效。有没有办法做到这一点？

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-07-20T01:58:30.387

如果原始算法是 BFS，您正在寻找最短路径中的最小路径，其中“最小”是根据`Ord`边缘上的某些总顺序引起的词典顺序（当然“最短”是根据路径长度）。

amit 建议的调整权重的想法是很自然的，但我认为这不是很实用，因为权重需要具有与路径长度相当的位数以避免丢弃信息，这会使算法慢几个数量级。

值得庆幸的是，这仍然可以通过对 A* 进行两个简单且廉价的修改来完成：

1.  一旦我们到达目标，我们应该继续访问节点直到路径长度增加，而不是返回一个任意的最短路径到目标，这样我们就访问了所有属于最短路径的节点。
2.  在重建路径时，我们构建了有助于最短路径的节点集。在考虑所有最短路径边时，该集合具有 DAG 结构，现在很容易在该 DAG 中找到词典编纂的最小路径`start`，`goal`这是所需的解决方案。

从示意图上看，经典的 A* 是：

```
path_length = infinity for every node
path_length[start] = 0

while score(goal) > minimal score of unvisited nodes:
    x := any unvisited node with minimal score
    mark x as visited
    for y in unvisited neighbors of x:
        path_length_through_x = path_length[x] + d(x,y)
        if path_length[y] > path_length_through_x:
            path_length[y] = path_length_through_x
            ancestor[y] = x

return [..., ancestor[ancestor[goal]], ancestor[goal], goal] 
```

哪里`score(x)`代表`path_length[x] + heuristic(x, goal)`。

我们简单地将严格的`while`循环不等式变成非严格的不等式，并添加路径重建阶段：

```
path_length = infinity for every node
path_length[start] = 0

while score(goal) >= minimal score of unvisited nodes:
    x := any unvisited node with minimal score
    mark x as visited
    for y in unvisited neighbors of x:
        path_length_through_x = path_length[x] + d(x,y)
        if path_length[y] > path_length_through_x:
            path_length[y] = path_length_through_x

optimal_nodes = [goal]
for every x in optimal_nodes:  // note: we dynamically add nodes in the loop
    for y in neighbors of x not in optimal_nodes:
        if path_length[x] == path_length[y] + d(x,y):
            add y to optimal_nodes

path = [start]
x = start
while x != goal:
    z = undefined
    for y in neighbors of x that are in optimal_nodes:
        if path_length[y] == path_length[x] + d(x,y):
            z = y if (x,y) is smaller than (x,z) according to Ord
    x = z
    append x to path

return path 
```

警告：引用 Knuth 的话，我只是证明它是正确的，没有尝试过。

至于性能影响，应该是最小的：搜索循环只访问得分比经典 A* 高 1 个单位的节点，并且重建阶段在属于最短路径的节点数量上是准线性的。如果正如您所暗示的那样，在大多数情况下只有一条最短路径，则影响较小。您甚至可以针对这种特殊情况进行优化，例如通过`ancestor`在经典情况中记住一个节点，当有多个祖先时（即 when `path_length[y] == path_length_through_x`），您将其设置为一个特殊的错误值。`ancestor`搜索循环结束后，您将尝试像经典 A* 中那样检索路径；如果在构建路径时遇到错误值，您只需要执行完整路径重建。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-07-20T15:59:37.393

我会将路径顺序的偏好直接构建到启发式函数中

我会先看看面包优先算法

为面包优先算法选择的每条路径定义一个函数：

考虑我们正在运行一个深度优先算法，并且它在第 n 个深度上由算法先前完成的决定： x_i \in {U,R,D,L} assign U=0,R=1,D=2, L=3

然后定义：

```
g(x_1,..,x_n) = sum_{i=1}^n x_i * (1/4)^i 
```

当算法访问比这一个更深的节点时，让我们在每一步将这一步的 g 值固定为 g'，g() 函数会更大。

在未来的每一步中，当 {1..n} x_i 的 on 发生变化时，它会更大，因此 g 函数确实在运行深度优先时总是会升高。

注意：如果深度优先算法成功，它会选择 g() 值最小的路径

注意：g() < 1 因为 max(L,R,U,D)=3

将 g 添加到 A* 的启发式函数不会干扰最短路径长度，因为 min edge length>=1

像这样修改的 A* 将找到的第一个解决方案将是深度优先找到的解决方案

为你举例：

```
h_bread=g(DLLLU) = (23330)_4 * c
h_astar=g(LULLD) = (30332)_4 * c 
```

()_4 是 base4 c 是一个常数 (4^{-5})

例如：h_bread < h_astar

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-07-26T15:44:06.003

我想出了两种方法来做到这一点。两者都需要继续算法，而队列顶部的距离到开始 g-value <= g(end-node)。由于 A* 中使用的启发式是[admissable](http://en.wikipedia.org/wiki/Admissible_heuristic)，这保证了属于*某个*最佳路径的每个节点最终都会被扩展。

* * *

第一种方法是，当我们遇到冲突时*（即，我们发现两个具有相同 f 值的节点可能都是沿最佳路径的某个节点的父节点）*，我们通过回溯到第一个点来解决它沿着他们相遇的路径*（我们可以在 中轻松做到这一点`O(path-length)`）*。然后，我们只需检查两条路径的方向优先级，然后选择在 BFS 搜索中具有更高优先级的路径。

* * *

第二种方法仅适用于每个节点接触水平和垂直（可能对角）相邻节点*的网格（即 4 连接网格图）*。我们做和以前一样的事情，但不是回溯来解决冲突，我们从一开始就比较沿路径的节点，并找到它们不同的第一个地方。它们的第一个不同之处将是与以前相同的关键节点，我们可以从中检查方向优先级。

我们通过为每个节点存储迄今为止的最佳路径来做到这一点。通常这会很麻烦，但由于我们有一个 4 连通图，我们可以通过存储沿路径采取的每个方向来非常有效地做到这一点。这将只需要每个节点 2 位。因此，我们基本上可以使用整数对路径进行编码——使用 32 位寄存器，我们可以一次比较 16 个节点；32个节点，64位寄存器；和 64 个（！）节点一次使用 128 位寄存器（如 x86 和 x64 处理器中的 SSE 寄存器），即使对于具有 100 个节点的路径，这种搜索也非常便宜。

* * *

我实现了这两个，以及@generic human 的算法，以测试速度。在一个有 400 个塔的 50x50 网格上，

*   @generic 人类算法的运行速度比普通 A* 慢 120%
*   我的回溯算法比普通 A* 慢了大约 55%
*   整数编码算法的运行速度仅比 A* 慢不到 10%

因此，由于我的应用程序使用 4 连通图，因此整数编码算法似乎最适合我。

* * *

我已经复制了一封写给[这里](http://www.blueraja.com/files/pathfinding%20proof.txt)教授的电子邮件。它包括对算法的更详细描述，以及它们工作的证明草图。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2012-07-19T17:29:18.920

一般来说，没有重要的方法可以做到这一点：

广度优先搜索找到由考虑顶点的顺序确定的最低顺序的最短路径。在断开等长路径之间的联系时，此顺序必须**优先于任何其他因素。**

示例：如果按照 A、B、C 的顺序考虑节点，则`Node A < Node C`. 因此，如果在以 A 开头的最短路径和以 C 开头的最短路径之间存在联系，则将找到以 A 开头的最短路径。

另一方面，A* 搜索将找到由节点的启发式值确定的最低阶最短路径。因此，启发式必须考虑到每个节点的最低词典路径。找到它的唯一方法是 BFS。

# c# - HttpWebResponse 在 Google Places API 调用上超时

> ID：11526056
> 
> 赞同：0
> 
> 时间：2012-07-17T15:41:36.183
> 
> 标签：c#, google-maps

我正在开发一个应用程序来遍历邮政编码和业务类型列表，然后通过我为这些参数构造的 url 创建对 Google Places API（文本搜索）的调用。

网址看起来像这样

[https://maps.googleapis.com/maps/api/place/textsearch/json?key=MY_API_KEY_HERE&sensor=false&query=57783+dentist](https://maps.googleapis.com/maps/api/place/textsearch/json?key=MY_API_KEY_HERE&sensor=false&query=57783+dentist)

为每个请求调用以下函数：

```
 private static StreamReader MakeWebRequest(string sURL)
    {
        HttpWebRequest request = (HttpWebRequest)WebRequest.Create(sURL);
        HttpWebResponse response = (HttpWebResponse)request.GetResponse();
        Stream responseStream = response.GetResponseStream();
        StreamReader objReader = new StreamReader(responseStream);
        return objReader;
    } 
```

我遇到的问题是，在 3 到 5 次迭代后，响应对象超时（System.Net.WebException = "The operation has timed out"）。我的第一个想法是请求被快速发送，所以我在循环中插入了一个 Sleep(2000) ，但这似乎没有效果。我检查了失败的 url 并将它们粘贴到浏览器中，它们**确实**返回了正确的数据。

据我了解，此 api 调用的唯一限制是我使用未经验证的帐户每天获得 1000 次。我错过了什么？

编辑：这是程序块的其余部分：

```
using System;
using System.Collections.Generic;
using System.Linq;
using System.Text;
using System.Net;
using System.IO;
using System.Web;
using Newtonsoft.Json;
using Newtonsoft.Json.Linq;
using GooglePlacesJSONGenerator.Models;

namespace GooglePlacesJSONGenerator
{
class Program
{
    static void Main(string[] args)
    {
        //set up a list of zips
        List<string> zipcodeList = new List<string>();
        zipcodeList.Add("57754");
        zipcodeList.Add("57783");
        zipcodeList.Add("57785");

        //setup a list of business types
        List<string> businessTypeList = new List<string>();
        businessTypeList.Add("restaurants");
        businessTypeList.Add("dentist");
        businessTypeList.Add("gym");

        //main data set
        GooglePlaceDataSet places = new GooglePlaceDataSet();

        //base url
        string urlBase = "https://maps.googleapis.com/maps/api/place/textsearch/json?key=MY_API_KEY_HERE&sensor=false&query=";
        string nextUrlBase = urlBase + "&pagetoken=";
        Stream objStream;
        //loop on zip codes
        foreach (string zip in zipcodeList)
        {
            Console.WriteLine("looping on zip " + zip);

            //loop on business type
            foreach (string type in businessTypeList)
            {
                Console.WriteLine("loop on type " + type);

                string sURL;
                string query = HttpUtility.UrlEncode(zip + " " + type);
                sURL = urlBase + query;
                Console.WriteLine("Query String: " + query);
                while (sURL != "")
                {

                    Console.WriteLine("Our URL:  " + sURL);
                    Console.WriteLine("");

                    StreamReader objReader = MakeWebRequest(sURL);

                    JsonTextReader reader = new JsonTextReader(objReader);

                    JsonSerializer se = new JsonSerializer();
                    string parsedData = se.Deserialize(reader).ToString();
                    GooglePlaceDataSet gSet = JsonConvert.DeserializeObject<GooglePlaceDataSet>(parsedData);

                    foreach (GooglePlaceData place in gSet.results)
                    {
                        places.results.Add(place);
                    }

                    if (gSet.next_page_token != null)
                        sURL = nextUrlBase + gSet.next_page_token;
                    else
                    sURL = "";

                    System.Threading.Thread.Sleep(2000);
                }
            }
        }
        Console.ReadLine();
    } 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-07-23T14:02:14.490

答案是“不要忘记显而易见的事情”。StreamReader 对象需要关闭。一旦我关闭它，上面的代码就起作用了。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-07-17T18:37:57.317

这可能是超出服务提供商允许的来自同一源地址的最大同时连接数的阈值的结果。您必须通过 using 或 try/finally 正确 Dispose() 资源，否则连接将保持打开状态，直到垃圾收集器处理资源。请参阅[C# .NET 中的 Web 响应不工作超过几次](https://stackoverflow.com/questions/10559430/web-response-in-c-sharp-net-doesnt-work-more-than-a-couple-of-times)和[C# https 登录和下载文件](https://stackoverflow.com/questions/9841344/c-sharp-https-login-and-download-file)，其中有相关内容。

# java - IF 语句不起作用

> ID：11526059
> 
> 赞同：9
> 
> 时间：2012-07-17T15:41:44.937
> 
> 标签：java, android, return

我正在编写一个可以做很多事情的android应用程序。我最近重构了我的代码以获得更好的结构，但突然我遇到了一个非常奇怪的问题。

```
handleRequest(String str)
{
    boolean foo = executeCommand(str);
    this.publishProgress("FOO1: " + foo);

    if (foo == false);
    {
        this.publishProgress("FOO2: " + foo);
        sendString("Failed to execute: " + str);
    }

    this.publishProgress("FOO3: " + foo);
    sendEOM();
} 
```

上面的代码应该执行一个命令，如果命令执行正确，则存储“foo”。此代码位于 Android AsyncTask（线程）内，因此我使用“publishProgress”来显示祝酒词。

我一直在浏览调试器，FOO 是真的！祝酒词也表明 FOO 在整个过程中都是真实的。但是，它继续前进并跳转到 IF 块内并执行它。我以前从未见过这种情况，我认为这是 Java 的问题。我正在单步执行函数“executeCommand”，看起来它也在跳过返回语句。

我已经在虚拟设备和真实设备上运行了代码，他们都这样做了。

有任何想法吗？我在这里完全不知所措。

* * *

## 回答 #1

> 赞同：22
> 
> 时间：2012-07-17T15:42:52.190

你说

```
 if (foo == false); 
```

去掉分号，应该是

```
 if (foo == false) {//your code} 
```

* * *

## 回答 #2

> 赞同：9
> 
> 时间：2012-07-17T15:43:18.427

去掉分号：`if (foo == false);`->`if (foo == false)`

* * *

## 回答 #3

> 赞同：9
> 
> 时间：2012-07-17T15:43:48.360

你在`if`语句后加一个分号。

这样，您的`if`语句就可以独立存在，并且以下代码块始终在运行。

像这样修改你的代码：

```
handleRequest(String str) {
    boolean foo = executeCommand(str);
    this.publishProgress("FOO1: " + foo);

    if (foo == false) {
        this.publishProgress("FOO2: " + foo);
        sendString("Failed to execute: " + str);
    }

    this.publishProgress("FOO3: " + foo);
    sendEOM();
} 
```

NB
保持你的块打开大括号与函数定义/循环条件在同一行可以减少这类错误的频率，IMO。

* * *

## 回答 #4

> 赞同：4
> 
> 时间：2012-07-17T15:55:53.770

将没有 ”;” if 语句后的分号。

所以而不是如果`(foo == false);` 它应该是如果`(foo == false){}`

* * *

## 回答 #5

> 赞同：4
> 
> 时间：2013-08-20T21:08:05.910

如果你在 if 语句之后写分号 (;)，它会在那里结束 if 条件！您需要在编写 if 条件后开始一段代码，即

```
if(foo == false){

// block of Code

} //end of if condition 
```

* * *

## 回答 #6

> 赞同：1
> 
> 时间：2012-09-02T19:06:17.960

我不知道这条线是如何编译`if (foo == false);`的，但显然它确实如此。正如其他人所提到的，您需要删除行尾的分号。与 ; 如果 foo 为假，则意味着什么也不做。然后程序进入两个大括号之间的下一个块。您需要安装 findbugs 或 PMD 来警告这种错别字。

# c# - System.StackOverflowException 从 XP 机器到 7.0 机器

> ID：11526061
> 
> 赞同：0
> 
> 时间：2012-07-17T15:41:52.907
> 
> 标签：c#

我有我曾经在 XP 机器上运行的 ac# 应用程序。我最近切换到 Windows 7.0 机器。

在调试器中时出现以下错误消息：“System.StackOverflowException”。还是有XP的机器，这台没问题。

它在递归算法的中间溢出。有谁熟悉这个问题？是与此有关的操作系统还是机器本身？

非常感谢您的帮助，

迈克尔

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-07-17T17:14:48.830

在达到基本情况之前了解递归在 XP 中的深度以及在 Win7 中出错的位置会很有帮助。

从理论上讲，Windows 7 进程应该比 WinXP 进程拥有更多的可用堆栈空间；至少，它们应该是相同的。但是，这里还有其他因素在起作用。查看这篇博文：http: [//blogs.technet.com/b/markrussinovich/archive/2009/07/08/3261309.aspx](http://blogs.technet.com/b/markrussinovich/archive/2009/07/08/3261309.aspx)

简而言之，限制因素通常是“常驻可用内存”；这是物理 RAM（不是页面文件空间），可用于必须保存在那里且不能交换到页面文件的数据。很多东西必须“常驻”在普通计算机上，不能换出到页面文件中；最重要的是，任何必须在“内核模式”（需要直接访问核心系统）下运行的东西都必须保存在 RAM 中以避免页面错误，即使当时该进程没有活动线程也是如此。

Windows 7 有更多这样的“内核模式”进程。例如，Windows Aero（不是 WinXP 的一部分）使用您的显卡来加速桌面的渲染，因此它必须在内核模式下运行。Windows 7 内核本身更大，因为它包括额外的安全性和额外的内置硬件支持。Windows 7 还具有在内核模式下运行的其他后台进程等，这些进程不在 WinXP 中。

因此，在所有其他条件相同（包括 RAM）的情况下，Windows 7 机器实际上将有更少的常驻内存可用于提交您的递归算法，这意味着该算法将无法在调用之前进行足够深的递归以达到基本情况由于 Windows 没有足够的常驻内存来满足新调用所需的“提交”，触发 StackOverflowException。

此外，Windows 7 在内存中的排列方式有所不同。较早的 Windows 版本（XP 和更早版本）以大致顺序的方式为每个新进程保留内存空间；第 N+1 个进程（或线程）在为第 N 个进程/线程保留的最后一个块之后的一个块被赋予一个内存地址。从 Windows Vista 开始，内存以更“随机”的方式分配；Windows 将在内存中选择一个位置，该位置可能与任何其他保留块相邻，也可能不相邻（仅保证不属于任何其他保留块）。这是一项安全功能，旨在混淆恶意软件并防止其成功窥探其他进程的内存。但是，空间效率较低的分配方案意味着操作系统将更快地用完 1MB 的连续 RAM 块来分配给每个新线程。此时，它开始分配间隙。因此，根据您的 Windows 7 机器的特定内存使用量，递归函数的线程可能会请求通常的 1MB 堆栈空间，并由操作系统提供一个实际上只有 128K 连续空间的指针。您的程序将无法区分，直到它实际上无法提交它认为已保留的所有空间。这可能会产生 Heisenbugs，它会在一次工作但下一次失败，因为 Windows 每次为线程保留的确切内存空间存在不确定性差异。并由操作系统给出一个实际上只有 128K 连续空间的指针。您的程序将无法区分，直到它实际上无法提交它认为已保留的所有空间。这可能会产生 Heisenbugs，它会在一次工作但下一次失败，因为 Windows 每次为线程保留的确切内存空间存在不确定性差异。并由操作系统给出一个实际上只有 128K 连续空间的指针。您的程序将无法区分，直到它实际上无法提交它认为已保留的所有空间。这可能会产生 Heisenbugs，它会在一次工作但下一次失败，因为 Windows 每次为线程保留的确切内存空间存在不确定性差异。

所有这一切的答案是“更多的 RAM”。核心内核模式进程所需的数量是相对静态的，因此您可以添加的每 GB 额外 RAM 是仅可用于用户程序进程和线程的 GB。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-07-17T16:09:34.050

我*不*相信这与您 PC 上的物理 RAM 有任何关系。我怀疑你没有碰巧在 XP 上看到它的原因仅仅是 Windows 7 可能有一个（稍微？）不同版本的 .Net。

显然，您需要以某种方式限制递归的深度（或替换非递归循环）。

但是您*可以*潜在地配置您的 .Net 堆栈。请查看以下链接：

*   [http://www.atalasoft.com/cs/blogs/rickm/archive/2008/04/22/increasing-the-size-of-your-stack-net-memory-management-part-3.aspx](http://www.atalasoft.com/cs/blogs/rickm/archive/2008/04/22/increasing-the-size-of-your-stack-net-memory-management-part-3.aspx)

*   [http://msdn.microsoft.com/en-us/library/5cykbwz4.aspx](http://msdn.microsoft.com/en-us/library/5cykbwz4.aspx)

*   [.NET IL .maxstack 指令如何工作？](https://stackoverflow.com/questions/1241308/how-does-the-net-il-maxstack-directive-work)

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-07-17T16:04:52.933

递归有多递归？

任何[深于十左右的东西都可能有风险](https://stackoverflow.com/a/610767/14357)。

如果您正在用尽堆栈并且确定这不是错误，则可以管理自己的堆栈...

例如：

```
void Process(SomeType foo)
{
    DoWork(foo); //work on foo
    foreach(var child in foo.Children)
    {
        Process(child);
    }
} 
```

可能成为

```
void Process(SomeType foo)
{
    Stack<SomeType> bar=new Stack<SomeType>();
    bar.Push(foo);
    while(bar.Any())
    {
        var item=bar.Pop();
        DoWork(item);//work on item
        foreach(var child in item.Children)
        {
            bar.Push(child);
        }
    }
} 
```

从而消除任何 CLR 调用堆栈问题。

当然，这不会修复无限递归。

# ios - 混合 ARM 和 THUMB 指令

> ID：11526062
> 
> 赞同：3
> 
> 时间：2012-07-17T15:41:55.090
> 
> 标签：ios, assembly, arm, thumb

我正在尝试在我的汇编代码中混合使用 ARM 和 THUMB 指令。例如，在下面的代码中，我尝试使用这两种模式：

```
.thumb  @ .code 16
.section __TEXT,__text
.globl mySymbol1
mySymbol1:
 ....
.arm   @ .code 32
.section __TEXT,__text
.globl mySymbol2
mySymbol2:
... 
```

现在，根据我的理解，当我将此代码编译到库中并通过 nm 运行时，`mysymbol1`应该显示为 arm 并且`mysymbol2`应该显示为 thumb，即

```
0000xxxx (__TEXT,__text) external mySymbol1
0000yyyy (__TEXT,__text) external [Thumb] mySymbol2 
```

但两者都显示为手臂。我在这里想念什么？我的汇编命令是：

```
as -arch armv7 -o a.o a.s 
```

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-07-17T17:01:45.333

您需要 .thumb_func 在拇指标签之前将它们作为拇指目标，否则 gnu 工具会将其视为手臂目标。（是的，对于要用作拇指目标的每个标签，您都需要 .thumb 一次和 .thumb_func）。许多例子[http://github.com/dwelch67](http://github.com/dwelch67)

# objective-c - tableView:heightForRowAtIndexPath: UITableViewController 不调用分类

> ID：11526066
> 
> 赞同：0
> 
> 时间：2012-07-17T15:42:05.323
> 
> 标签：objective-c, ios, uitableview, ios5, objective-c-category

我有一个`UITableViewController`

```
@interface GenderSelectController : UITableViewController

- (id)initWithPreviousGender:(NSString*)prevGender;

@end

@implementation GenderSelectController

- (id)initWithPreviousGender:(NSString *)_prevGender
{
    // It's not loaded from nib but created in code
    if ((self = [super initWithStyle:UITableViewStyleGrouped])) {
        prevGender = _prevGender;
    }
    return self;
} 
```

我有一个类别方法

```
@interface UITableViewController (RowHeight)

@end

@implementation UITableViewController (RowHeight) 

- (CGFloat)tableView:(UITableView *)tableView heightForRowAtIndexPath:(NSIndexPath *)indexPath
{
    return (indexPath.row) ? tableView.rowHeight : tableView.rowHeight - 1;
}

@end 
```

直到我明确地做它才被调用

```
- (CGFloat)tableView:(UITableView *)tableView heightForRowAtIndexPath:(NSIndexPath *)indexPath
{
    return [super tableView:tableView heightForRowAtIndexPath:indexPath];
} 
```

但是另一个类别，`UIViewController`它实现了`UITableViewDelegate`方法，它工作得很好。怎么了？

# ios - 使用平移手势为 GCRect 调整大小设置动画

> ID：11526068
> 
> 赞同：0
> 
> 时间：2012-07-17T15:42:10.997
> 
> 标签：ios, core-animation, core-graphics

我画了几个圆圈，每个圆圈都填满了一个图像。当用户平移时，我想缩放/调整圆圈的大小。所以我一次又一次地调用drawRect，重新绘制每个GCRect，直到手势完成——当然动画很不稳定。在我的情况下， UIScrollView 不适合需要，因为我不想滚动，而是在用户平移时缩放圆圈。

除了使用 OpenGL ES 来实现这个功能外，还有什么办法吗？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-07-17T16:17:05.573

你真的需要为此定制绘图吗？您可以在没有 drawRect 的情况下轻松地将图像裁剪为圆形。

## 没有`-drawRect:`

使用 Core Animation，您可以设置图层的角半径。如果您只想在圆圈内显示图像，那么您可以将图像放在带有方形框架的图像视图中，并将图像视图层的角半径设置为框架宽度的一半。

现在，每次用户拖动时，您都可以更改图像视图层的边界和角半径。这将使它看起来像圆圈变大/变小。

## 如果您需要自定义绘图

也许您正在做一些只能使用 Core Graphics 才能完成的自定义阴影或混合。如果是这样，您可以在用户拖动手指时应用缩放变换并拉伸图像，并且仅在手指从屏幕上抬起时才重新绘制。这会便宜得多，而且也很容易实施。只需创建一个比例变换`CGAffineTransformMakeScale(xScale, yScale);`（

*注意：*如果您需要额外的性能，如果您使用圆角半径方法，您仍然可以使用相同的技巧（拖动时缩放然后重绘）。

# java - 无法绕过 ClassCastException

> ID：11526069
> 
> 赞同：0
> 
> 时间：2012-07-17T15:42:20.813
> 
> 标签：java, sap, enterprise-portal

在尝试`context.lookup()`在我的门户应用程序中投射调用结果时，我`ClassCastException`在投射不同结果的三分之二的尝试中得到了一个。

经过一些研究，我认为：[http](http://wiki.sdn.sap.com/wiki/display/TechTSG/%28AS+Java%29+ClassCastException+Occurs+After+Lookup+Operation) ://wiki.sdn.sap.com/wiki/display/TechTSG/%28AS+Java%29+ClassCastException+Occurs+After+Lookup+Operation拥有答案，但事实并非如此真正解释如何执行这两个步骤。

此代码用于从存储在以下位置的路径中获取 iView 的详细信息`list`：

```
IiView transView1 = (IiView) context.lookup(list.get(i).toString()); 
```

但是当获取这样的工作集的详细信息时：

```
IPcdContext attrSet = (IPcdContext) context.lookup(list.get(i).toString()); 
```

我得到一个`ClassCastException`. 任何有关我为什么会收到此错误的帮助或解释将不胜感激！

编辑：这是代码的基础：[http ://www.sdn.sap.com/irj/scn/go/portal/prtroot/docs/library/uuid/6112ecb7-0a01-0010-ef90-941c70c9e401?overridelayout =真](http://www.sdn.sap.com/irj/scn/go/portal/prtroot/docs/library/uuid/6112ecb7-0a01-0010-ef90-941c70c9e401?overridelayout=true)

edit2：我从 context.lookup 得到的对象是`com.sapportals.portal.pcd.pcm.roles.PortalWorkset`我找不到文档的。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-07-17T16:05:16.673

如果`context.lookup`返回 a `PortalWorkset`，则无法“绕过” ClassCastException。

强制转换不会*将*对象转换为不同的类 - 它只是告诉编译器您确定它是比其当前声明的类型更具体的类的一种方式。在这种情况下，您是在说“我意识到该`lookup()`方法被声明为 return `Object`，但是当我在这个特定的上下文中调用它时，我确信它总是会专门返回一个`IPcdContext`对象。” 您在这里的假设结果不成立，并且程序通过抛出异常正确地发出信号。

您的问题可能有两个原因：

1.  您的假设通常是正确的，但是由于逻辑错误，您没有将您期望的字符串传递给该`lookup`方法，因此完全得到了错误的东西。在这种情况下，请确保传递给方法的参数始终正确。
2.  你的假设是不正确的，你可能*并不*总是得到`IPcdContext`回报。在这种情况下，您需要决定如何处理返回的其他对象，并适当地处理它们（您可以使用`instanceof`运算符检查返回对象的类）。

在任何情况下，无论何时进行强制转换，检查它是否会首先成功通常是有益的，使用如下成语：

```
IPcdContext context;
Object obj = context.lookup("foo");
if (obj instanceof IPcdContext) {
    context = (IPcdContext)obj;
}
else {
    // You got back something else.  What to do?
} 
```

# vb.net - 为什么我的表格出现在一切的后面？

> ID：11526081
> 
> 赞同：0
> 
> 时间：2012-07-17T15:42:45.467
> 
> 标签：vb.net, winforms

我有一个程序，在调用表单之前我需要做一些初始工作，所以我禁用了应用程序框架设置并编写了我自己的 Main 函数，并在运行表单时调用 Application.Run(myForm)。

一切正常，没有问题，但现在在打开表单之前我需要一些其他服务。与其将所有代码都添加到该程序中，不如将其全部移至其自己的可执行文件中。第二个程序可以编辑第一个程序将使用的文件，所以我需要第一个程序等待，以便它会读取这些更改（如果他们做出）。我想可以很容易地使用 Shell 函数，但是由于各种原因，我正在创建自己的 Process 对象并通过它调用它/等待它。

无论如何，我在 Application.Run 调用之前的某个时间调用了第二个程序。第一个程序等待，我可以成功与第二个程序交互，完全没有麻烦。但完成后，第一个程序的窗口隐藏在屏幕上的任何其他窗口后面。这不会在 XP 中发生，仅在 Vista 中（可能是 7，但我尚未确认）。我已经尝试过手动强制表单出现在前面，最小化然后最大化，获得焦点等，但是除非用户用鼠标手动单击它，否则没有任何东西将它带到前面。

我究竟做错了什么？为什么会出现这种行为？我知道这与等待可执行文件完成有关，因为如果我不强制第一个程序等待一切都很好（除了它不等待）。我可以通过在表单的 Load 事件中调用第二个程序来规避这个问题，但是我必须再次读取文件以捕获更改而不是读取一次，而且它看起来也很糟糕，因为正在绘制表单当第二个程序坐在那里时，真的很慢。

如果有人有任何意见，我将不胜感激。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-07-17T16:11:30.193

这并不是您遇到这种行为的真正答案，但一个简单的解决方法是在加载事件中临时设置表单的`TopMost`属性。`True`然后，根据您希望它的侵入性，您可以在较短的计时器下重置它或等待`MouseEnter`事件触发。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2014-01-08T19:33:50.813

这个网站上有另一个关于这个的话题，但我没有得到链接。这个问题似乎是 .NET 框架中的一个错误。下面的 API（VB.NET 示例）适用于 Windows XP 和 8.1。请勿在其他版本的 Windows 中进行测试。

```
<Runtime.InteropServices.DllImport("user32")> _
Public Shared Function SetForegroundWindow(hwnd As IntPtr) As Integer
End Function

Private Sub Form_Load(sender As Object, e As EventArgs) Handles Me.Load
    SetForegroundWindow(Handle)
End Sub 
```

# sql - 如何在不显示结果的情况下执行查询？

> ID：11526082
> 
> 赞同：1
> 
> 时间：2012-07-17T15:42:46.283
> 
> 标签：sql, sql-server, sql-server-2008-r2, sqlperformance

我想通过在 SQL Server Management Studio 中多次执行并比较统计信息来测试某些查询的性能。我的问题是这种方法不准确，因为在显示每个查询结果并且 Management Studio 的内存使用量增加之后。对我来说重要的是不要增加内存消耗，因为返回集很大（所以我不能把它放到临时表中）

我发现了这个问题： [How to Execute SQL Query without Displaying results](https://stackoverflow.com/questions/6386587/how-to-execute-sql-query-without-displaying-results) ，但它不符合我的需要。

那么，有没有什么方法可以在 SQL Manageement Studio 中执行查询而不显示返回数据呢？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-07-17T15:50:21.743

在选项部分（在工具--> 选项下），转到查询结果--> SQL Server 和“结果到网格”或“结果到文本”。

“执行后丢弃结果”有一个选项框。单击该框。

现在，打开另一个查询窗口，没有结果。我想结果仍然是从服务器返回的，所以你有网络延迟。不过，这应该可以解决内存问题。

您可以通过在与引擎相同的服务器上运行 SSMS 来解决网络延迟问题。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-07-17T15:50:31.807

顶部有一个启用客户端统计的图标。这为您提供了执行的查询的详细信息，处理时间行计数。如果您按顺序多次运行相同的查询，它还会自动为您聚合这些数据，是的，这些统计信息与渲染时间无关。

![“包括客户统计信息”图标的图像](../Images/17f1ccb5cd3e223a6938f60d1f1f7597.png)

# python - 如何从文件创建字典？

> ID：11526084
> 
> 赞同：0
> 
> 时间：2012-07-17T15:42:47.947
> 
> 标签：python, dictionary, python-2.7

我想用文件中的值创建一个字典。

问题是它必须逐行读取才能添加到字典中，因为我认为我没有足够的内存来加载要附加到字典的所有信息。

键可以是默认值，但值将从文件中的每一行中选择一个。该文件不是 csv，但我总是拆分行，因此我可以从中选择一个值。

```
 import sys

 def prod_check(dirname):
    dict1 = {}
    k = 0
    with open('select_sha_sub_hashes.out') as inf:
       for line in inf:
        pline = line.split('|')
        value = pline[3]
        dict1[line] = dict1[k]
        k += 1
        print dict1

 if __name__ =="__main__":
    dirname=sys.argv[1]
    prod_check(dirname) 
```

这是我正在使用的代码，我设置为值的变量是我从中提取数据的文件中的行中的索引。当我尝试调用字典来打印值时，我似乎遇到了问题，但我认为这可能是我的语法问题或者我所做的分配。我希望将值添加到键中，但键保持为常规数字，例如 0-100

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-07-17T16:23:55.660

看看像“东京内阁”@ [http://fallabs.com/tokyocabinet/](http://fallabs.com/tokyocabinet/)这样的东西，它具有 Python 绑定并且相当有效。还有京都内阁，但许可有点限制。

另请查看之前的 S/O 帖子：[Reliable and Effective key-value database for Linux？](https://stackoverflow.com/questions/1690605/reliable-and-efficient-key-value-database-for-linux)

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-07-17T16:16:10.667

如果您没有足够的内存一次将整个字典存储在 RAM 中，请尝试使用 anydbm、bsddb 和/或 gdbm。这些是类似字典的对象，将键值对保存在磁盘上的单表键字符串值字符串数据库中。

或者，考虑： [http](http://stromberg.dnsalias.org/~strombrg/cachedb.html) ://stromberg.dnsalias.org/~strombrg/cachedb.html ...这将允许您在序列化和非序列化表示之间进行透明转换，非常透明。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-07-17T15:44:23.243

所以听起来好像主要问题是逐行读取文件。要逐行读取文件，您可以这样做：

```
with open('data.txt') as inf:
   for line in inf:
       # do your rest of processing 
```

使用的好处`with`是当你完成或发生异常时，文件会自动为你关闭。

--

请注意，原始帖子不包含任何代码，现在似乎已包含此代码的副本以帮助进一步解释问题。

# c++ - 定义一个常量/声明一个数组

> ID：11526087
> 
> 赞同：1
> 
> 时间：2012-07-17T15:42:59.490
> 
> 标签：c++

我正在尝试声明两个数组，一个 2D 和一个 1D。我知道尺寸需要是 const 值。所以 const 值是从函数调用的返回值中分配的。这很顺利，但是当我使用派生值声明数组时，编译错误！为什么？？？

这是我的代码：

```
int populateMatrixFromFile(string fname) {
std::ifstream fileIn;
int s = determineDimensions(fname);  // return value  (CONST INT)
const int size = s;                  // assign to const

cout << "Value returned from determineDimensions(): " << size << endl;

if (size > 10){
    cout << "Maximum dimensions for array is 10 rows and 10 columns. Exiting" << endl;
    return 1;
}

fileIn.open(fname.c_str(), ios::in); //opened for reading only.

float aMatrix[size][size];  // ERROR
float bMatrix[size];        // ERROR 
```

但它在这里工作：

```
 // assign the pth row of aMatrix to temp

    const int alen = sizeof (aMatrix[p]) / sizeof (float);
    float temp[alen];                                    // WORKS!!!

    for (size_t i = 0; i < alen; i++) {
        temp[i] = aMatrix[p][i];
    } 
```

感谢所有帮助。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-07-17T15:45:11.467

任何数组中第二维、第三维等的大小始终是恒定的。时期。标准对此非常明确。

如果您在堆上以 new 数组形式分配变量，则第一个维度（实际上是最后一个索引）可以是变量，如下所示：

```
int size = 50;
float *p = new float[size];

.... do stuffs

delete[] p; 
```

一些编译器允许在堆栈上使用可变大小的数组，但最好不要使用它。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-07-17T15:54:27.620

编译器对数组的恒定大小强制执行此规则，因为它在编译时分配所需的内存。换句话说，计算数组大小所需的所有值必须在编译时已知。在您的第一个示例中，情况并非如此，因此编译器会抱怨。

如果你真的需要动态大小的数组，你应该使用指针和 new[] 操作符来分配数组。您还需要记住使用 delete[] 运算符将内存返回给系统并避免任何内存泄漏。

# sharepoint - 我需要知道如何使用 sharepoint 2007 中的 1 个公共列将指定列的数据从一个列表复制到另一个列表

> ID：11526094
> 
> 赞同：0
> 
> 时间：2012-07-17T15:43:19.250
> 
> 标签：sharepoint, moss2007enterprisesearch

我需要知道如何使用 sharepoint 2007 中的 1 个通用列将指定列的数据从一个列表复制到另一个列表。例如，在一个列表中，我有员工编号、联系电话和邮件地址。我想根据员工编号将联系电话和邮件地址复制到另一个列表。请让我知道如何做到这一点，因为我是 sharepoint 的新手。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-08-20T09:57:14.863

我们可以通过多种方式做到这一点，让我以不同的形式讲述相同的场景。

**案例 1：您在同一站点网站中有列表**

*   获取网络对象
*   制作 2 个 spList 对象
*   使用 2 foreach 遍历列表集合
*   赋值。

**案例 2：您在不同的网站上有列表**

*   获取网络对象
*   获取源列表对象
*   获取目标 Web 对象
*   获取目的地列表对象
*   使用 2 foreach 遍历列表集合
*   赋值。

# crystal-reports - 下标必须介于 1 和数组大小之间 ERROR (Crystal Reports)

> ID：11526095
> 
> 赞同：1
> 
> 时间：2012-07-17T15:43:20.860
> 
> 标签：crystal-reports, report

这段代码可能有什么问题？

```
**WhilePrintingRecords;
Shared NumberVar Array myTotal;
myTotal[UBound(myTotal)];** 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-07-20T15:01:36.657

在 Crystal Reports 中，数组索引从 1 开始。因此，您需要使用`UBound(myTotal) + 1`

# javascript - 如何将图像和文本都放入 jqgrid 的单元格中

> ID：11526096
> 
> 赞同：-1
> 
> 时间：2012-07-17T15:43:22.610
> 
> 标签：javascript, jquery, jqgrid

我正在做一个项目，我们希望将图像和文本都放入一个单元格中。而且，我们希望能够在单击（或双击）图像时更改图像。基本上，图像部分代表 1 位（ON/OFF）信息。同时，我们还希望能够在单击（或双击）文本部分时编辑文本。稍后，我们可能在一个单元格中有更多的图像项。

有人可以给我一个建议吗？我目前正在尝试在单元格内放置一个 1x2 的小表格，它看起来不太好。提前致谢。

![包含图像和文本的单元格](../Images/3de8c1528bdab5257c760ff59a37e0fe.png)

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-07-19T20:22:34.583

最后我在前面放了一个按钮。这不漂亮，但它的工作原理。

# java - 从命令提示符编译 java 应用程序时出错

> ID：11526100
> 
> 赞同：1
> 
> 时间：2012-07-17T15:43:32.883
> 
> 标签：java

最近，当尝试从命令提示符编译 java 程序时，我收到此错误：

```
Error: Cannot find or load main class com.sun.tools.javac.Main 
```

我有最新版本的 JDK 和 JRE，但仍然出现错误。这是我在命令行中输入的内容：

```
C:\Java_Source_Codes>javac hi.java 
```

任何人都可以帮忙吗？

（这是我的java代码）

```
public class hi{
  public static void main(String[] args){
    System.out.println("hello, world!");
  }
} 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-07-17T15:46:37.877

您需要为 PATH 变量设置编译所需的 Java 工具的路径。

您需要在 Path 系统变量中包含这些文件夹。

```
D:\Program Files\Java\jdk1.6.0_32\jre;D:\Program Files\Java\jdk1.6.0_32\bin 
```

只需替换`D:\Program Files\Java`为您在计算机上安装 Java 的文件夹即可。此外，如果您使用的是任何其他版本的 JDK，请替换`jdk1.6.0_32`为您自己的版本。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-07-17T15:52:24.007

你有很多问题，Kumar 提到了编译问题，但这并不是阻止你的直接问题。

您已`JAVA_HOME`设置为 Java 运行时环境，但正在`javac`系统上查找`PATH`。发生这种情况时，您可以`javac`从命令行调用，但是当`javac`检测到`JAVA_HOME`环境变量时，它会从不包含“java 工具”的目录加载其库，`tools.jar`. “java工具”的内容包括实现编译器的类。

您可能已经`JAVA_HOME`设置为类似`/some/path/here/jre`. 假设该`jre`目录是 JDK 附带的嵌入式 JRE，您可能应该`JAVA_HOME`将`/some/path/here`.

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-07-17T15:46:26.713

将路径设置为系统中jdk的bin目录..

尝试`java -version`在 cmd 上键入以查看您的 Java 路径是否设置正确。

我的是..

```
C:\Program Files\Java\jdk1.7.0\bin 
```

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2012-07-17T15:46:47.580

这是由于您的 PATH 存在一些问题。

快速猜测你的 PATH 上有多个版本的 java

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2014-02-14T19:38:43.053

我遇到了类似的问题，但找到了一个简单的解决方案，也可能适用于您的情况。

我的问题是我只是在 c 目录中创建了一个新文件夹来保存我的 *.java 文件（如测试文件夹）并将我的 PATH 设置为 ...jdk\bin 文件夹。

当我尝试在 cmd 中编译时，我得到了相同的错误 main class not found。

所以我去了环境变量和用户变量，在那里我看到我的 CLASSPATH 指向同一个文件夹。所以我将我的 CLASSPATH 更改为在我的案例 C:\test 中包含我的文件的文件夹，问题就解决了。

希望这可以帮助。

# jquery - Jquery：将查询字符串附加到所有链接

> ID：11526102
> 
> 赞同：20
> 
> 时间：2012-07-17T15:43:38.753
> 
> 标签：jquery, jquery-mobile

我想将查询字符串附加到页面内的所有动态链接上 - 以修复旧版本中的错误 - 这可能吗？

有任何想法吗？

* * *

## 回答 #1

> 赞同：48
> 
> 时间：2012-07-17T15:46:57.783

像这样的东西？

```
var querystring = 'myquerystringtoadd';

$('a').each(function() {
    var href = $(this).attr('href');

    if (href) {
        href += (href.match(/\?/) ? '&' : '?') + querystring;
        $(this).attr('href', href);
    }
}); 
```

[工作示例。](http://jsfiddle.net/xQ8hA/4/)

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2015-04-02T11:52:45.697

This solution with native javascript :

```
var querystring = 'yourQueryStringHere=;-)';

document.addEventListener('click', function (e) {

    var x = e.originalTarget;
    if (x.nodeName === 'A') {

        var href = x.getAttribute('href');

        if(href) {
            href += (/\?/.test(href) ? '&' : '?') + querystring;
            x.setAttribute('href', href);
        }
    }

}, false); 
```

# javascript - simplecarousel：将数组元素添加到分页 ul

> ID：11526104
> 
> 赞同：0
> 
> 时间：2012-07-17T15:43:41.487
> 
> 标签：javascript, loops, carousel

我有一个二维数组——“dbArray”——这是 Tobias Zeising 的“simplecarousel”的数据。dbArray 中的每个数组都是由 2 个字符串组成的数组。我想使用每个字符串的第一个字符串并将其放在轮播的分页按钮内。但是如果不在分页代码中再次执行相同的循环，我不知道该怎么做。谁能给我一个线索？！

这是我的 ajax 构建数组并初始化轮播：

```
//--------------------------------------    
// COLLECT from db / build carousel
//--------------------------------------
$ajax_load.insertBefore('#content');
$.ajax({
    url: 'func/load-words.php',
    dataType: 'json',
    success: function(dbArray) {
        var items = '<ul id="carousel" class="carousel">';
        for (var i in dbArray) {
            items += '<li><h2>' + dbArray[i][0] + '</h2><p>' + dbArray[i][1] + '</p></li>';
        }
        items += "</ul>";                   
        $ajax_load.fadeOut('slow', function() {
            $(this).remove();
        });

        $("#content").html(items).fadeIn('slow', function() {
        }); 

        $("#carousel").simplecarousel({
            fade: 100,
            pagination: true
        });

    }
}); 
```

这是 simplecarousel 的分页部分：

```
// include pagination
if(config.pagination != false) {
    container.after('<ul class="carousel-pagination"></ul>');
    var pagination = container.next('.carousel-pagination');
    for(var i=0;i<config.items;i++) {
        if(i==0)
            pagination.append('<li class="carousel-pagination-active">button</li>');
        else
            pagination.append('<li>button</li>');
    }

    pagination.find('li').each(function(index, item) {
        $(this).click(function() {
            slide(index,true);
        });
    });
} 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-07-17T16:10:34.273

我似乎最初是通过声明一个全局 paginationWords 变量并在 ajax 循环中将 dbArray 传递给它来使其工作的：

```
 success: function(dbArray) {
        var items = '<ul id="carousel" class="carousel">';
        paginationWords = dbArray;
        // etc... 
```

然后在轮播分页代码中，我再次退出循环：

```
// include pagination    
if(config.pagination != false) {
    container.after('<ul class="carousel-pagination"></ul>');
    var pagination = container.next('.carousel-pagination');

    for(var i=0;i<config.items;i++) {
        if(i==0) 
            for (var n in paginationWords) {
                pagination.append('<li>'+paginationWords[n][0]+'</li>');
            }

            //pagination.append('<li class="carousel-pagination-active">button</li>');
        // else
            //pagination.append('<li></li>');
    }

    pagination.find('li').each(function(index, item) {
        $(this).click(function() {
            slide(index,true);
        });
    });
} 
```

# javascript - 为什么 IE 实现 console.log() 与 Safari、Chrome 和 Firefox 不同

> ID：11526105
> 
> 赞同：0
> 
> 时间：2012-07-17T15:43:44.073
> 
> 标签：javascript, internet-explorer, console

如果您使用 console.log() 而不检查它的存在，它会破坏 IE 中的代码。一旦您使用调试器对其进行调试......它就会开始掩盖实际问题。

由于这个 Catch-22，您永远不会看到实际的失败。

这在 Safari、Chrome 和 Firefox 中不是问题。

我在哪里可以将它作为一个错误（一个非常模棱两可的错误）提交，为什么 IE 会这样做？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-07-17T15:48:07.037

我没有遇到这个问题。`console.log`即使控制台从未打开过也能正常工作。

但是，在旧版本的浏览器中，没有控制台，您始终可以对其进行填充：

```
console = console || {log:function() {
    var l = arguments.length, i, arr = [];
    for( i=0; i<l; i++) arr[i] = arguments[i];
    alert(arr.join("\n"));
}}; 
```

# powershell - PowerShell：将工作 AD 比较代码转换为函数 - 错误

> ID：11526106
> 
> 赞同：1
> 
> 时间：2012-07-17T15:43:45.357
> 
> 标签：powershell

我正在尝试编写一个脚本，该脚本将根据 OU 的成员更新 AD 中的组成员资格。当我指定组名和 OU 名称然后进行比较时，这个小**脚本工作正常：**

```
$Group = "GroupA"
$OU = "OU=ContainerA,DC=DC1,DC=ccompany,DC=com"

$users = $(get-aduser -filter "*" -SearchBase $OU)
$groupmembers = Get-ADGroupMember -Identity $Group
switch (Compare-Object -ReferenceObject $groupmembers -DifferenceObject $users -property samaccountname){
{$_.SideIndicator -eq "=>"} {add-adgroupmember -identity $group -member $_.samaccountname}
{$_.SideIndicator -eq "<="} {remove-adgroupmember -identity $group -member $_.samaccountname -confirm:$false} } 
} 
```

当然，这对于单个组和 OU 来说很好，但是，我需要为大约 10 个组和 OU 执行此操作，所以与其复制粘贴整个内容 10 次，我认为聪明的方法是创建一个函数然后调用它10次。我将代码更改为函数：

```
Function Build ([String]$Group, [String]$OU){
$users = $(get-aduser -filter "*" -SearchBase $OU)
$groupmembers = Get-ADGroupMember -Identity $Group
switch (Compare-Object -ReferenceObject $groupmembers -DifferenceObject $users -property samaccountname){
{$_.SideIndicator -eq "=>"} {add-adgroupmember -identity $group -member $_.samaccountname}
{$_.SideIndicator -eq "<="} {remove-adgroupmember -identity $group -member $_.samaccountname -confirm:$false} } 
}

Build ("GroupA", "OU=ContainerA,DC=DC1,DC=ccompany,DC=com")
Build ('GroupB", "OU=ContainerB,DC=DC1,DC=ccompany,DC=com") 
```

但是，当我运行上述脚本时，我不断收到以下错误：

```
Get-ADUser : An empty SearchBase is only supported while connected to a GlobalCatalog. 
```

您能否指出我在尝试将第一个代码转换为函数时做错了什么？

谢谢

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-07-17T20:16:54.940

你的麻烦在于你调用函数的方式`Build`只是尝试：

```
Build "GroupA" "OU=ContainerA,DC=DC1,DC=ccompany,DC=com"
Build 'GroupB" "OU=ContainerB,DC=DC1,DC=ccompany,DC=com" 
```

或者

```
Build -Group "GroupA" -ou "OU=ContainerA,DC=DC1,DC=ccompany,DC=com" 
```

`()`当你调用一个函数时，你也不需要`,`. 注意`,`是数组分隔符

# java - 如何最小化（图标化）FXML 应用程序？

> ID：11526107
> 
> 赞同：0
> 
> 时间：2012-07-17T15:43:45.700
> 
> 标签：java, events, user-interface, javafx

如何从 Controller 的方法中将处理程序分配给最小化（图标化）应用程序到`@FXML private HBox minBtn;`（使用 Shape 制作的自定义按钮）按钮`public void initialize(URL, ResourceBundle)`？`setIconified(boolean)`方法在 Stage 类中，我无法让他进入我的 Controller 类。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-07-17T16:24:16.063

您可以通过以下方式访问舞台

```
minBtn.setOnMouseClicked(new EventHandler<MouseEvent>() {

    @Override
    public void handle(MouseEvent arg0) {
        ((Stage) ((Node) arg0.getSource()).getScene().getWindow()).setIconified(true);
        // OR
        ((Stage) minBtn.getScene().getWindow()).setIconified(true);
    }
}); 
```

# wordpress - 使用 add_action / add_filter 更改搜索结果页面中的元描述

> ID：11526112
> 
> 赞同：0
> 
> 时间：2012-07-17T15:44:04.400
> 
> 标签：wordpress, meta-tags

我试图更改单个模板和页面模板上的元描述，它可以工作。

我使用 add_action 触发更改元描述。但是当我尝试更改搜索结果页面上的元描述时，使用 add_action 不起作用。

还有其他方法吗？我需要使用 add_action 或 add_filter 因为我将从页面底部触发元描述。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-07-17T19:17:49.787

如果您将其添加到 header.php 会更容易

```
<?php if (is_search())
{
//ADD SUM META DESCRIPTIONS
}
?> 
```

# objective-c - 对于多个视图，使用 Mediator 是一个好主意吗？

> ID：11526120
> 
> 赞同：1
> 
> 时间：2012-07-17T15:44:34.153
> 
> 标签：objective-c, design-patterns

我有一个项目，我有很多意见，我想使用中介模式。这是个好主意吗 ？另外，你有什么想法吗？

谢谢你 :) 对不起我的英语。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-07-17T18:43:49.000

如果您使用大量视图，则可能需要使用中介。这样做的主要原因是如果您的类经常相互引用/相互调用方法/共享数据。调解器防止类变得过于相互依赖，并为您提供一种简单的方法来定义以何种形式传递的信息。从本质上讲，您可以知道调解员将始终以您想要的形式返回您想要的信息，而不必担心一个类的变化会影响另一个类。

我发现调解员有点痛苦，只有当你有大量需要不断交流的课程并且你计划保留这个程序一段时间并编辑/扩展/等时，你才应该真正这样做。如果您一次只呈现一个或两个视图，并且这些视图只需要彼此交谈或很少与其他视图进行交流，那可能就有点过分了。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-07-17T18:57:22.573

在我看来，如果在实施时牢记以下几点，这可能是一个好主意。

1.  中介类应该在视图控制器的协议上工作。每个视图控制器都应确认该协议。
2.  视图控制器应该共享一个公共数据源。
3.  视图中的更新应该传递给数据源/数据源控制器。例如选定的项目。
4.  数据源更新应该只传递给活动/选定的视图控制器。
5.  当视图控制器更改为其他视图控制器时，在呈现新视图之前，应该只要求数据源提供新的数据集。

如果中介类负责此类事情，这可能是实现此类事情的最佳方式。您也可以使用此模式实现良好的可扩展性。

祝你好运。

# iphone - 自定义 UIButton 框架未正确绘制

> ID：11526130
> 
> 赞同：0
> 
> 时间：2012-07-17T15:44:47.860
> 
> 标签：iphone, objective-c, quartz-core

我正在通过其图层构建自己的自定义按钮，如下所示：

```
[self.layer setBorderColor:[UIColor colorWithWhite:.94 alpha:1].CGColor];
[self.layer setBorderWidth:1];
[self setBackgroundColor:[UIColor colorWithWhite:.86 alpha:1]];
[self.titleLabel setFont:[UIFont fontWithName:@"AdelleBasic-Bold" size:18]];
[self setContentVerticalAlignment:UIControlContentVerticalAlignmentCenter];

[self.layer setShadowRadius:4];
[self.layer setShadowOpacity:.4];
[self.layer setShadowColor:[UIColor colorWithWhite:.5 alpha:1].CGColor];
[self.layer setCornerRadius:5]; 
```

结果是这样的：![在此处输入图像描述](../Images/0cd4abc7f728942dc4d9d2531ef952f6.png)

看起来字体比它应该的高，但如果你仔细观察，实际上是按钮的框架被绘制得太低：字体和阴影是它们应该在的位置。

有谁知道我该如何解决这个问题？

# sql - 为什么在 UDF 中使用 INSERT - EXEC [存储过程] 语句会引发副作用？

> ID：11526133
> 
> 赞同：3
> 
> 时间：2012-07-17T15:44:55.667
> 
> 标签：sql, sql-server-2005, exec, user-defined-functions, table-variable

我正在开发一个函数，该函数需要调用一个返回 N 行的存储过程，然后将结果插入临时表作为其处理的一部分。

在存储过程上调用 EXEC 就可以了： [http ://sqlfiddle.com/#!3/ed11a/16](http://sqlfiddle.com/#!3/ed11a/16)

那么为什么将 EXEC 的结果插入到表变量中会引发错误： [http ://sqlfiddle.com/#!3/ed11a/18](http://sqlfiddle.com/#!3/ed11a/18)

我得到的错误是：`Invalid use of side-effecting or time-dependent operator in 'INSERT EXEC' within a function.`

我知道这个错误通常是在试图操作不是函数本地的值时产生的，但是插入是在一个表变量上，所以这不应该是一个问题。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-07-17T15:49:09.060

虽然您只是插入到表变量中，但不能保证您调用的存储过程不会产生副作用。没有办法阻止从函数调用的存储过程插入/更新/删除任意数据，甚至修改模式。您可能可以使用表值函数而不是存储过程调用来实现您想要做的事情。

```
Alter function dbo.MyTable() 
RETURNS  @table TABLE 
(
    -- columns returned by the function
    Col1 int null, 
    Col2 int null, 
    Col3 int null,
    Col4 int null,
    Col5 int null, 
    Col6 int null

)
as
Begin
INSERT INTO @table Values( null, null, 5, null, 63, null)

return 
End 
```

# ios - ARC 释放我的视图控制器视图可见

> ID：11526137
> 
> 赞同：0
> 
> 时间：2012-07-17T15:45:15.350
> 
> 标签：ios, objective-c, automatic-ref-counting, selector, free

我有一个带有单个视图的简单应用程序，上面有一个按钮。单击按钮时，它会添加第二个视图。这第二个视图有一个简单的工具栏，上面有一个`UIBarButtonItem`。它已注册以触发我的视图控制器的消息。

但是，只要我单击按钮，应用程序就会崩溃。启用僵尸，我看到我的视图控制器被解雇了。添加一个`dealloc`函数，通过调用`NSLog()`，我看到只要我的视图可见，我的视图控制器就会被解雇！

也没有`shouldAutorotateToInterfaceOrientation`触发类似的消息。

我的视图控制器 .h ：

```
#import <UIKit/UIKit.h>

@interface IssueViewController : UIViewController
{
    IBOutlet UIBarButtonItem *button;
}

@property (nonatomic, readonly) UIBarButtonItem *button;

- (IBAction)buttonTapped:(id)sender;

+ (void)showSelfInView:(UIView *)view;

@end 
```

它的 .m ：

```
#import "IssueViewController.h"

@interface IssueViewController ()

@end

@implementation IssueViewController

@synthesize button;

- (id)initWithNibName:(NSString *)nibNameOrNil bundle:(NSBundle *)nibBundleOrNil
{
    self = [super initWithNibName:nibNameOrNil bundle:nibBundleOrNil];
    if (self) {
        // Custom initialization
    }
    return self;
}

- (void)viewDidLoad
{
    [super viewDidLoad];
    // Do any additional setup after loading the view from its nib.
    self.button.target = self;
    self.button.action = @selector(buttonTapped:);

}

- (void)viewDidUnload
{
    NSLog(@"unloaded");
    [super viewDidUnload];
    // Release any retained subviews of the main view.
    // e.g. self.myOutlet = nil;
}

- (BOOL)shouldAutorotateToInterfaceOrientation:(UIInterfaceOrientation)interfaceOrientation
{
    return (interfaceOrientation == UIInterfaceOrientationPortrait);
}

- (void)dealloc
{
    NSLog(@"Got dealloc");
}

+ (void)showSelfInView:(UIView *)view
{
    IssueViewController *ivc = [[IssueViewController alloc] init];
    [view addSubview:ivc.view];
}

- (IBAction)buttonTapped:(id)sender
{
    [self.view removeFromSuperview];
}

@end 
```

用于触发显示第二个视图的代码：

```
[IssueViewController showSelfInView:self.view]; 
```

有人知道我在做什么错吗？为什么`UIViewController`至少在视图被删除之前我不会被保留？

**编辑**

我知道 ARC，强引用和弱引用......在非 ARC 代码中，在`showSelfInView`：我会保留视图控制器，我会在`buttonTapped`.

对我来说，这是实现这一目标的好方法。而且我想知道我是否遗漏了 ARC，或者我使用视图/视图控制器的方式。由于视图仍然可见，对我来说，它的 viewController 不应该被释放。除了创建我自己对视图控制器的强引用之外，还有什么方法可以防止这种情况发生？

**改写**

是否有任何非补丁非肮脏方式让视图控制器保持分配状态，直到其视图从显示中删除。我认为从视图控制器到自身的任何指针都是脏的，尽管这是我目前使用的方式。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-07-17T15:57:13.947

如果您不希望 arc 立即释放它（在定义实例的范围的末尾），则必须保持对 IssueViewController 实例的强引用。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-07-18T01:25:15.890

答案是：将视图控制器的视图添加为另一个视图控制器的视图的子视图是一种不好的做法，应该避免。

# python - python代码布局

> ID：11526150
> 
> 赞同：0
> 
> 时间：2012-07-17T15:46:02.417
> 
> 标签：python, format

我正在尝试学习安排/定义代码的最佳方式。以下面为例，我必须编写两次 tkMessageBox 命令。我确实尝试在 getText() 中创建一个 def 并引用它，但它没有用。

因此请提问

1）我如何安排代码，以便我可以将 tkMessageBox 命令放在 def 或其他东西中，甚至在 getText() 中也可以引用它

2）考虑到最佳实践，这段代码是否应该以不同的方式布局？如果是这样，如何/为什么？

先感谢您

```
import Tkinter as tk
import tkMessageBox
import base64

myText = 'empty'

def getText():
    global myText
    myText = inputBox.get()
    entered = "You entered: " + myText
    encoded = "We encoded: " + base64.encodestring(myText)
    Button1 = tk.Button(root, command = tkMessageBox.showinfo("Press me", entered))
    Button1.pack()
    Button2 = tk.Button(root, command = tkMessageBox.showinfo("Press me", encoded))
    Button2.pack()
    root.destroy()

root = tk.Tk()

# Text label
simpleTitle = tk.Label(root)
simpleTitle['text'] = 'Please enter your input here'
simpleTitle.pack()

# The entry box widget
inputBox = tk.Entry(root)
inputBox.pack()

# The button widget
button = tk.Button(root, text='Submit', command=getText)
button.pack()

tk.mainloop() 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-07-17T15:48:40.887

我不确定您是否在询问是否[重构](http://en.wikipedia.org/wiki/Code_refactoring)代码，但用于布局/格式化 Python 代码的最终样式指南是[**PEP 8 -- Python 代码样式指南**](http://www.python.org/dev/peps/pep-0008/)。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-07-17T16:15:28.273

还值得注意的是，有一个 pep8 命令行实用程序可以扫描您的源代码以查找（大多数）pep8 违规

```
pip install pep8
pep8 source_code_to_check 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-07-17T15:51:37.153

您不能将 tkMessageBox 命令分配给一个变量，然后引用该变量两次吗？该变量可以放在您的函数中。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2012-07-17T15:58:16.567

删除任何重复的代码是一个很好的做法，这是软件设计过程中的一个步骤，称为重构，在另一个答案中提到。

在您的 tkMessageBox 示例的特定情况下，您将执行类似的操作。

```
command = tkMessageBox.showinfo("Press me", entered)
Button1 = tk.Button(root, command)
Button1.pack()
Button2 = tk.Button(root, command)
Button2.pack() 
```

这会将您的命令合并到一个位置，以便以后轻松维护。虽然这很可能对您的代码示例来说不是问题，但这是一个好习惯，因为它会减少必要的调用次数，从而在将来优化您的代码。

# android - Android Listview SetItemChecked by _id

> ID：11526151
> 
> 赞同：0
> 
> 时间：2012-07-17T15:46:03.413
> 
> 标签：android, android-listview, simplecursoradapter

我`ListView`填充了 a `SimpleCursorAdapter`（填充了`_id`and `personName`）。我知道`_id`我想选择哪个，但该函数`setItemChecked(pos, boolean)`使用`position`而不是`_id`.

例如，我如何知道 3 中的`Cursor`位置`_id`？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-07-17T15:50:36.720

获取`position`具有`_id`您正在寻找的项目的 。然后`position`在你的电话中使用它来`setItemChecked(pos, boolean)`.

# python - 如何清除 pySNMP 超时？

> ID：11526154
> 
> 赞同：0
> 
> 时间：2012-07-17T15:46:11.653
> 
> 标签：python, pysnmp

我想检查树系统的状态，我正在使用以下代码，但是我遇到了超时问题，例如，当其中一个系统关闭而不是下一个系统时，我也会超时。

```
try:
    snmp = pySNMPCom( ip="192.168.0.1", 23434, 30 )
    """It's hangig 30 seconds that is the timeout"""            
    data = snmp.emite_command( command )
    snmp.destroye()                
except:  
    """Smtp timeout"""
    snmp.destroye()  

try:
    snmp = pySNMPCom( ip="192.168.0.2", 23434, 30 )
    """It's going to the exception immediately, it suppose to hung 30 seconds...""" 
    data = snmp.emite_command( command )
    snmp.destroye()                
except:  
    """Smtp timeout"""
    snmp.destroye() 
```

班上：

```
# -*- coding: utf-8 -*-
from pysnmp.carrier.asynsock.dispatch import AsynsockDispatcher
from pysnmp.carrier.asynsock.dgram import udp
from pyasn1.codec.ber import encoder, decoder
from pysnmp.proto import api
from time import time

class pySNMPCom():

    def __init__( self, ip, port, timeout ):
        self.__host = ip
        self.__port = port
        self.__timeout = timeout

    def set_cmd( self, cmd ):
        self.cmd = cmd

    def __set_message( self ):
        self.__pMod = api.protoModules[api.protoVersion1]

        self.__reqPDU = self.__pMod.GetRequestPDU()
        self.__pMod.apiPDU.setDefaults( self.__reqPDU )
        self.__pMod.apiPDU.setVarBinds( 
            self.__reqPDU, ( ( self.cmd, self.__pMod.Null( '' ) ),
                )
            )
        # Build message
        self.__reqMsg = self.__pMod.Message()
        self.__pMod.apiMessage.setDefaults( self.__reqMsg )
        self.__pMod.apiMessage.setCommunity( self.__reqMsg, 'public' )
        self.__pMod.apiMessage.setPDU( self.__reqMsg, self.__reqPDU )

    def __cbTimerFun( self, timeNow, startedAt = time() ):
        if timeNow - startedAt > self.__timeout:
            raise "Request timed out"

    def __cbRecvFun( self, transportDispatcher, transportDomain, transportAddress, wholeMsg, reqPDU = '' ):
        if not reqPDU:
            reqPDU = self.__reqPDU
        self.ret = ''
        while wholeMsg:
            rspMsg, wholeMsg = decoder.decode( wholeMsg, asn1Spec = self.__pMod.Message() )
            rspPDU = self.__pMod.apiMessage.getPDU( rspMsg )
            # Match response to request
            if self.__pMod.apiPDU.getRequestID( reqPDU ) == self.__pMod.apiPDU.getRequestID( rspPDU ):
                # Check for SNMP errors reported
                errorStatus = self.__pMod.apiPDU.getErrorStatus( rspPDU )
                if errorStatus:
                    print errorStatus.prettyPrint()
                else:
                    for oid, val in self.__pMod.apiPDU.getVarBinds( rspPDU ):                        
                        self.ret = val

                transportDispatcher.jobFinished( 1 )

    def emite_command( self, cmd = '' ):
        if not cmd:
            cmd = self.cmd
        self.set_cmd( cmd )
        self.__set_message()        

        transportDispatcher = AsynsockDispatcher()
        transportDispatcher.registerTransport( 
            udp.domainName, udp.UdpSocketTransport().openClientMode()
            )
        transportDispatcher.registerRecvCbFun( self.__cbRecvFun )
        transportDispatcher.registerTimerCbFun( self.__cbTimerFun )
        transportDispatcher.sendMessage( 
            encoder.encode( self.__reqMsg ), udp.domainName, ( self.__host, self.__port )
            )
        transportDispatcher.jobStarted( 1 )
        transportDispatcher.runDispatcher()
        transportDispatcher.closeDispatcher()

        return self.ret

    def destroye( self ):
        del self 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-07-17T21:10:44.230

您将 startedAt 变量初始化为默认方法参数。这只会在模块运行时发生一次，并且不会在类重新实例化时重复。因此，您的所有查询时间都是根据初始的 staredAt 值来衡量的。因此，在startedAt + 30 之后发生的所有查询都将立即超时。

# sql - Access 或 T-SQL 查询以计算基于运行总计返回的值

> ID：11526159
> 
> 赞同：1
> 
> 时间：2012-07-17T15:46:19.143
> 
> 标签：sql, sql-server, database, ms-access

我正在使用作为报告/视图存储在我们数据库中的库存分类帐。导出时，它看起来像这样：

```
Tran Type         Txn Date     Item     Quantity
Opening Balance   6/30/12      Item1     4
Opening Balance   6/30/12      Item2     7
Shipping          7/14/12      Item2    -1
Opening Balance   6/30/12      Item3     3
Shipping          7/2/12       Item3    -1
Opening Balance   6/30/12      Item4     5
Shipping          7/3/12       Item4    -1
Shipping          7/3/12       Item4    -1
Shipping          7/3/12       Item4    -1
Shipping          7/5/12       Item4    -1
Shipping          7/5/12       Item4    -1
Receiving         7/9/12       Item4    10 
```

在导出之前，它不包含那些基于导出期间生成的“期初余额”条目。

我们正在尝试跟踪在给定期间内每件商品缺货的天数。第一步是按项目创建运行总计，这是我之前通过 Excel 中的数据透视表所做的。从那里开始，我需要灵活、动态地计算每个项目的库存天数为 0 数量（基于月、季度或年）。最初，我也希望通过数据透视表来考虑这个计数，为此我[求助于超级用户。](https://superuser.com/questions/449532/counting-0-stock-values-generated-by-pivot-table) 不幸的是，通过 excel 完成这类工作似乎违反直觉，所以我将我的问题带到这里。

我在 Access 和 SQL Server 方面只有新手经验。我在 Oracle 和 PL/SQL 方面接受过一些简单的正式培训，但那是几年前的事了。可能会为此添加另一个复杂性，我无法将任何内容写入或永久保存到我们的系统后端（即使我有权限）。

到目前为止，我只想出了一个 T-SQL 语句来按项目创建运行总计：

```
Select 
 TxnDate,
    Quantity,
        Item,
    (SELECT Sum(Quantity)
    FROM DATABASE.dbo.InventoryLedger as D1
    WHERE D1.TxnDate <= D0.TxnDate AND D1.Item = D0.Item) as balance
    FROM DATABASE.dbo.InventoryLedger as D0
    where Item = 'Item4' and TxnDate >= 2012-07-01 
```

在这之后我迷路了。我不知道我是否应该进行某种计数，或者找到一种方法来减去数量达到 0 的项目之间的日期，然后稍后再收到。我不确定如何根据已计算的余额列添加另一个聚合或计算列，我什至不确定如何翻译此查询，以便它将与我的相同数据的 Access 文件一起使用。我会接受 Access 或 T-SQL 格式的解决方案；我渴望真正学习 T-SQL，同时能够在 Access 中执行计数可以让我链接数据库并让我更容易生成直接报告。

我也很好奇是否有一种简单的方法可以查询每天每件商品的库存水平？我想这只是使用相同的确切数据来计算，所以这可能只是浪费时间和空间，对吧？

我很感激任何帮助，伙计们。几个月来，我一直在尝试提出一种解决方案来衡量缺货情况，这是我最接近的一次。谢谢。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-07-17T16:14:50.117

使用正确的窗口/分析功能集会容易得多。但我有一个想法，可能会奏效。

首先，您可以使用自联接获得累积总和。

然后，还对此进行自我加入以获得下一个非零 cum，并使用 group by 来获得下一条记录的最小日期：

```
with tcum as (
     select t.txnDate, t.Item, t.quantity, sum(tprev.quantity) as cumq
     from t left outer join
          t tprev
          on t.item = tprev.item and
             t.txnDate >= tprev.txnDate
     group by t.txnDate, t.Item, t.quantity
    )
 select tcum.item, tcum.txndate, MIN(tcumnext.txndate) as nextfilldate
 from tcum left outer join
      tcum tcumnext
      on tcum.item = tcumnext.item and
         tcum.date < tcumnext.date and
         tcumnext.cumq > 0 and
         tcum.cumq = 0
group by tcum.item, tcum.txndate 
```

# jquery - 仅在页面刷新时出现错误

> ID：11526165
> 
> 赞同：0
> 
> 时间：2012-07-17T15:46:31.883
> 
> 标签：jquery, html, asp.net-mvc, browser-cache

现在我的一个页面上有一个 JavaScript 错误，只有在我刷新页面后才会出现。如果我单击链接转到该页面，则该错误永远不会出现。我认为这个问题与浏览器缓存有关，所以我把它放在视图`<meta http-equiv="PRAGMA" content="NO-CACHE">`的头部`_layout.cshtml`。还是没有骰子。

我只是希望使用尽可能少的工作量来解决问题，那么如何确保页面刷新（使用 F5 或浏览器按钮）就像页面加载一样？

编辑：

因此，在评论中提出建议在不进行缓存的情况下重新加载后，显然这是浏览器缓存问题。所以我的问题的参数已经改变。我希望能够只为一个视图禁用缓存。我该怎么做才能做到这一点？

# java - 为我的扩展窗格（键）制作一个映射到框架标题（值）

> ID：11526167
> 
> 赞同：0
> 
> 时间：2012-07-17T15:46:41.417
> 
> 标签：java, swing, map, jpanel

我希望我的框架在更改窗格时更改标题：

```
public void changePane(JPanel myNewPane){
    myGui.getContentPane().removeAll();
    myGui.getContentPane().add(myNewPane);
--->myGui.setTitle("Blah");
    myGui.pack();
} 
```

除了我想更改`"Blah"`使用输入`myNewPane`作为映射中值的键的值，因此我有：

```
 private Map<? extends JPanel,String> PanelNames = new HashMap<? extends JPanel, String>(); 
```

除了，在 Eclipse 中，`HashMap`红色下划线带有错误*“无法实例化类型 HashMap”*

我尝试将窗格和字符串添加为键和值的地方，如下所示：

```
public void setPanelNames(Map<? extends JPanel,String> panelNames) {
    PanelNames.put(myTopManagerPane, "Main Manager Page");
    PanelNames.put(myPlayerManagerPane, "Player Manager Page");
    PanelNames.put(myGameManagerPane, "Game Manager Page");
} 
```

这里`put`是红色下划线；我的错误是*“类型 Map 中的 put(capture#2-of ? extends JPanel, String) 方法不适用于参数 (TopManagerPane, String)”*

我究竟做错了什么？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-07-17T15:52:45.877

您无法创建`HashMap`使用泛型通配符。您需要指定具体类型。

`? extends`从您的定义中删除它应该可以工作：

```
private Map<JPanel,String> PanelNames = new HashMap<JPanel, String>();

public void setPanelNames(Map<JPanel,String> panelNames) {
  ...
} 
```

请注意，这`Map<? extends JPanel, String>`意味着您接受任何使用类型`JPanel`或子类键的映射（例如`MyPanel`，如果它 extends `JPanel`）。但是，您在调用时创建的实际实例`new HashMap<...>()`需要知道是否允许任何`JPanel`或仅`MyPanel`允许实例，因此您需要在`new HashMap<JPanel, String>()`此处使用。然后地图知道键是`JPanels`并且不能更多地了解类型（在这种情况下无关紧要）。

在方法参数中， using`? extends JPanel`意味着您可以传递 a`Map<JPanel, String>`或 a`Map<MyPanel, String>`但编译器不会让您将面板添加到地图中，因为它不知道是否允许这样做 - 添加`JPanels`到 a`Map<MyPanel, String>`是非法的。

# three.js - Three.JS 对通过 ColladaLoader 导入的模型适用什么类型的 Shader？

> ID：11526168
> 
> 赞同：0
> 
> 时间：2012-07-17T15:46:43.683
> 
> 标签：three.js

我正在尝试确定将哪种类型的着色器应用于通过 Collada Loader 导入的模型的材质。

输出比我一直在尝试创建的所有材质/着色器组合看起来要好得多！

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-07-17T17:56:47.687

这是您所追求的功能： [https ://github.com/mrdoob/three.js/blob/master/examples/js/loaders/ColladaLoader.js#L3059](https://github.com/mrdoob/three.js/blob/master/examples/js/loaders/ColladaLoader.js#L3059)

# vb.net - Windows 窗体设计器由于其生成的代码错误而无法加载：我是“忽略并继续”还是编辑标记为“请勿修改”的代码？

> ID：11526170
> 
> 赞同：2
> 
> 时间：2012-07-17T15:46:50.710
> 
> 标签：vb.net, winforms, visual-studio-2010, windows-forms-designer

这是我的第一个 Windows 窗体项目，我对如何使用 Windows 窗体设计器工具修复错误感到有点困惑。我希望有人可以帮助我了解修复设计器错误所涉及的工作流程。

我已经在 VB.NET 中获得了一个模板应用程序来修改。我已经多次经历了类似以下工作流程：演示应用程序包含一个下拉列表选择器，我需要一个数字向上/向下条目。应该不难改吧？在 Visual Studio 中进行零培训后，我单击该对象并搜索“属性”，希望在那里进行更改。没运气。按照[这个流程图](http://xkcd.com/627/)，我然后右键单击下拉菜单并选择“转换”，选择一个数字向上/向下对象，然后 - 你瞧 - 一个数字向上/向下条目出现在表单上。

我切换到 Project.vb 文件来修改对象的事件处理程序，添加`MessageBox.Show`调用以确保一切正常，并构建项目。

我收到两个错误：

```
Error   2   Type 'MyCorp.ProcessControl.ControlLibrary.ToolStripNumericUpDown' is not defined.  C:\HMI\HMI.Designer.vb  192
Error   3   Type 'Mycorp.ProcessControl.ControlLibrary.ToolStripNumericUpDown' is not defined.  C:\HMI\HMI.Designer.vb  1978 
```

相关的源代码行读取（分别）

```
192:  Me.tscb_PartNumberSelector = New Mycorp.ProcessControl.ControlLibrary.ToolStripNumericUpDown()
1978: Friend WithEvents tscb_PartNumberSelector As MyCorp.ProcessControl.ControlLibrary.ToolStripNumericUpDown 
```

显然，我使用的是自定义 ControlLibrary，它没有数字上/下工具。看起来我必须去编写那个库的人添加一个，使用系统标准 NumericUpDown，将其转换回 DropDownList 并在该列表中输入可能的数字，或者使用普通的旧文本条目。任何事情都可以保持发展！

所以，我点击了“HMI [设计]”选项卡，它在我面前抛出了一个大警告页面：

> **为了防止在加载设计器之前可能丢失数据，必须解决以下错误：**
> 
> 设计者无法处理第 191 行的代码：
> 
> ```
> Me.tscb_PartNumberSelector = New Gentex.ProcessControl.ControlLibrary.ToolStripNumericUpDown() 
> ```
> 
> “InitializeComponent”方法中的代码由设计者生成，不应手动修改。请删除所有更改并尝试再次打开设计器。
> 
> *此错误的实例（一）*
> 1\. HMI HMI.Designer.vb Line:191 Column:1
> Show Call Stack
> 
>  *解决此错误的帮助 找不到*与此错误相关的帮助主题。*检查 Windows 窗体设计时错误列表*
> 
>  **有关此错误的论坛帖子*
> 在 MSDN 论坛中搜索与此错误相关的帖子*

 *幸运的是，我将 Hmi.Designer.vb 文件置于版本控制之下，并且可以在必要时还原所有内容，但是要还原的更改位于严厉警告不应修改它们的函数中。

这里的预期工作流程是什么？

1.  还原对项目的所有更改，然后重试。
    这使得用户在没有版本控制的情况下操作很困难（不得不重做整个项目，而不是按几次'ctrl-z'），并且它丢失了我所做的一些其他更改（大概是没有损坏）。
2.  在标记为“请勿修改”的代码中还原 Designer.vb 文件中的逐行更改
    这很容易出错，因为有多个位置可以更改代码 - 在 HMI.vb 中，以及 HMI.Designer.vb 中的多个位置.
3.  忽略并继续，并尝试使用设计器还原更改。
    这似乎加剧了我遇到的问题并生成了重复的代码。

我最终选择了 1，因为我无法让其他人工作，但我希望再次遇到这个问题。我应该如何处理？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-09-18T20:36:47.077

设计器中的代码就像任何其他代码一样，除非您知道旧代码的作用和更改的作用，否则您不应该更改它，但如果您确实知道，那么它可以安全地完成。

需要牢记的主要警告是，代码会被读取然后重新生成——如果你在里面放了一些东西让它工作，但设计者不理解它，你就不能使用设计器进行进一步的更改. 你会想要避免这种情况。

在任何特定时间最好做的事情会根据情况而变化，经常还原将是最简单和最直接的方法，但如果有必要，可以安全地编辑生成的代码。*

# javascript - javascript json不显示所有条目

> ID：11526174
> 
> 赞同：0
> 
> 时间：2012-07-17T15:46:59.737
> 
> 标签：javascript, jquery, json

我有一个非常基本的 json 文件，我正在使用 jquery / javascript 加载它。现在我只是想提醒我的一些数据。我遇到的问题是我的 JSON 文件中有 3 个主要项目（称为“类别”），但由于某种原因，您只能阅读最后一个。

我的 JSON 文件如下所示：

```
{
"category":{
    "name":"Caribbean Travel",
    "article":{
        "id": "1",
        "title": "",
        "teaser": "",
        "image": "",
        "date": "",
        "map": "",
        "body": ""
    }
},
"category":{
    "name":"European Travel",
    "article":{
        "id": "2",
        "title": "",
        "teaser": "",
        "image": "",
        "date": "",
        "map": "",
        "body": ""
    }
},
"category":{
    "name":"U.S. Travel",
    "article":{
        "id": "3",
        "title": "",
        "teaser": "",
        "image": "",
        "date": "",
        "map": "",
        "body": ""
    }
} 
```

}

我调用 json 文件并提醒一些信息，如下所示：

```
$(document).ready(function(){
$.getJSON("news.json",
    function(data){
        alert(JSON.stringify(data));
        //alert(data.category.article.id);
    }); 
```

});

所以当我查看数据时，我看到的只是最后的类别信息（美国旅游）。它根本没有显示前2名。而且我不能使用 data.category[1] 或类似的东西来引用它们。

有谁知道我在这里做错了什么？

谢谢

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-07-17T15:50:16.460

您的 json 文件应如下所示：

```
[{
    "name": "Caribbean Travel",
    "articles": [{
        "id": "1",
        "title": "",
        "teaser": "",
        "image": "",
        "date": "",
        "map": "",
        "body": ""
    }]
}, {
    "name": "European Travel",
    "articles": [{
        "id": "2",
        "title": "",
        "teaser": "",
        "image": "",
        "date": "",
        "map": "",
        "body": ""
    }]
}, {
    "name": "U.S. Travel",
    "articles": [{
        "id": "3",
        "title": "",
        "teaser": "",
        "image": "",
        "date": "",
        "map": "",
        "body": ""
    }, {
        "id": "4",
        "title": "",
        "teaser": "",
        "image": "",
        "date": "",
        "map": "",
        "body": ""
    }]
}] 
```

`data[0]`将是第一类，`data[1]`第二类，依此类推。

```
alert(data[0].articles[0].id) //alert first category's first article's id
alert(data[2].name) //alert third category's name
alert(data[1].articles[0].body) //alert second category's first article's body
alert(data[2].articles[1].body) //alert third category's second article's body 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-07-17T15:52:47.813

```
{"category":[
{
    "name":"Caribbean Travel",
    "article":{
        "id": "1",
        "title": "",
        "teaser": "",
        "image": "",
        "date": "",
        "map": "",
        "body": ""
    }
},
{
    "name":"European Travel",
    "article":{
        "id": "2",
        "title": "",
        "teaser": "",
        "image": "",
        "date": "",
        "map": "",
        "body": ""
    }
},
{
    "name":"U.S. Travel",
    "article":{
        "id": "3",
        "title": "",
        "teaser": "",
        "image": "",
        "date": "",
        "map": "",
        "body": ""
    }
}
]
} 
```

# grails - findOrCreateBy 是否适用于其他域实例？

> ID：11526179
> 
> 赞同：5
> 
> 时间：2012-07-17T15:47:16.633
> 
> 标签：grails, grails-orm, dynamic-finders

[`findOrCreateBy`](http://grails.org/doc/latest/ref/Domain%20Classes/findOrCreateBy.html)如果找不到匹配的对象，我正在尝试使用它来搜索对象或实例化一个对象，但它没有按预期工作。

这就是我所拥有的：

```
String myBaz = "some unique string"
FooType myFooType = FooType.findByName("Large")

// The Foo table is empty, so this should give me a new Foo
Foo myFoo = Foo.findOrCreateByBazAndFooType(myBaz, myFooType)

assert myFoo.baz == myBaz 
assert myFoo.fooType == myFooType // Fails because myFoo.fooType is null, 
// but should be set to myFooType 
```

我究竟做错了什么？为什么`fooType`没有正确设置？这是预期的行为还是 Grails 中的错误？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-07-17T18:31:32.217

我不确定，但看起来您正在尝试将其作为测试。（根据您的断言）

Grails 框架添加的动态方法在单元测试中不可用，除非您模拟域类。现在这是从另一个[问题站点](http://www.coderanch.com/t/441561/Groovy/Grails-persisting-domain-classes-unit)获取的旧 grails 代码，但它可能会有所帮助

```
import grails.test.GrailsUnitTestCase   

class MessageControllerTests extends GrailsUnitTestCase {   

    def savedMessages   

    void setUp() {   
        super.setUp()   
        savedMessages = []   
        mockDomain(Message, savedMessages) //mocking the domain class   
        mockController(MessageController) //mocking the controller   
    }   

    void testMessageCanBeCreated() {   
        def messageController = new MessageController()   
        messageController.params.title = 'detail'  
        messageController.params.detail = 'some detail'  

        messageController.save() // executing the save action on the MessageController   

        assertEquals('list', messageController.redirectArgs.action)   
        assertEquals(1, savedMessages.size()) //assert the message has been saved   
    }   
} 
```

# symfony - Symfony2 包管理

> ID：11526181
> 
> 赞同：1
> 
> 时间：2012-07-17T15:47:18.283
> 
> 标签：symfony, bundle, code-organization

我被 Symfony 2 所吸引的原因有很多，但我特别喜欢 Bundles 来组织和模块化代码的想法。

但是，我不确定单个捆绑包应该有多具体的最佳实践。

例如，如果我想构建一个日历应用程序，那么我将不得不处理用户日历以及与这些日历相关的事件。

拥有一个日历包和一个单独的事件包是否被认为是最佳实践，或者我应该拥有一个具有事件控制器和日历控制器的包？

当然有人可能会再次提出不同的方法！

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-07-17T16:34:53.927

我认为答案取决于几个不同的事情。当我用 Symfony2 构建一个应用程序时，我通常喜欢我的包有点小。对于您的问题，我最初的看法是事件应该与日历放在同一个包中。但是，我将这个答案建立在一些假设之上。

例如，我假设事件 100% 取决于日历。通常，如果一个实体可以完全独立于另一个实体生活，我喜欢将它们放在单独的包中。可以在不接触/不需要日历的情况下创建或管理事件吗？如果事件有自己的页面、自己的管理门户并且只是附加到日历（例如，当有人订阅事件时），那么我将有一个单独的捆绑包。

当然这些是我的意见......我认为这是一个灰色地带。

希望这可以帮助。

# c# - 需要帮助在中继器中进行调节

> ID：11526189
> 
> 赞同：2
> 
> 时间：2012-07-17T15:47:49.280
> 
> 标签：c#, asp.net, repeater

我正在开发在线测验模块。所以我定义了两种类型的问题。

1.  多项选择单选项（单选按钮）
2.  多项选择多项选项（复选框）
3.  其他 Naswer（文本框）

我使用了嵌套中继器。第一个中继器绑定了问题。子中继器绑定可用于问题的选项。

所以我想要的是我想检查条件，

就像我的 QuestionType 是 MS（Multiple Choice Single Option）一样，我会将 4 个选项与单选按钮绑定。

如果它的 MM（Multiple Choice Multiple Option）那么我会将 Options 与 Checkbox 绑定。

那么我怎样才能在 aspx 文件中检查这样的条件和代码呢？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-07-17T16:25:18.003

这是一种方法：

## 输出

![在此处输入图像描述](../Images/1eda8a35cd1cc99e427ade8f78bd71c8.png)

## ASPX

```
 <asp:Repeater runat="server" ID="repeater" DataSourceID="ods" 
        onitemdatabound="repeater_ItemDataBound">
        <ItemTemplate>
            <asp:Label Text='<%# Eval("QuestionText") %>' runat="server" />
            <br />
            <asp:Panel runat="server" ID="panel">
            </asp:Panel>
        </ItemTemplate>
    </asp:Repeater>
    <asp:ObjectDataSource ID="ods" runat="server" 
        SelectMethod="GetQuestions" 
        TypeName="WebApplication1.Questions.QuestionsContext">
    </asp:ObjectDataSource> 
```

## 背后的代码

```
 protected void repeater_ItemDataBound(object sender, RepeaterItemEventArgs e)
    {
        var q = e.Item.DataItem as Question;

        if (q == null)
            throw new InvalidOperationException();

        var panel = e.Item.FindControl("panel");

        if (q.MultipleAnswers)
        {
            var checks = new CheckBoxList { DataSource = q.Answers, DataTextField = "AnswerText", DataValueField = "ID" };
            checks.DataBind();

            panel.Controls.Add(checks);
        }
        else
        {
            var radios = new RadioButtonList { DataSource = q.Answers, DataTextField = "AnswerText", DataValueField = "ID" };
            radios.DataBind();

            panel.Controls.Add(radios);
        }
    } 
```

## 数据组件

这只是为了测试，用你的数据源替换它

```
public class QuestionsContext
{
    public IEnumerable<Question> GetQuestions()
    {
        var q = Builder<Question>.CreateListOfSize(5).Build().ToList();
        q.ForEach(x =>
        {
            x.ID = Guid.NewGuid();
            x.Answers = Builder<Answer>.CreateListOfSize(4)
                .All().With(y => y.Question, x)
                .Build().ToList();
        });

        return q;
    }
} 
```

## 模型

```
public class Answer
{
    public Guid ID { get; set; }
    public Question Question { get; set; }
    public string AnswerText { get; set; }
    public bool IsCorrect { get; set; }
}
public class Question
{
    public Guid ID { get; set; }
    public string QuestionText { get; set; }
    public IEnumerable<Answer> Answers { get; set; }
    public bool MultipleAnswers { get; set; }

    public Question()
    {
        this.Answers = Enumerable.Empty<Answer>();
    }
} 
```

# linux - 在 Linux 上正确链接 boost 多线程库

> ID：11526193
> 
> 赞同：0
> 
> 时间：2012-07-17T15:47:53.993
> 
> 标签：linux, multithreading, boost

我对是否链接 libboot_*-mt 变体以及它们的实际用途有点困惑。

我在 Centos 6 上使用 boost 1.46.0 的自定义反向移植。该构建生成 /usr/lib64/libboost_thread-mt.so.7 以及 -mt 和其他库的标准版本。

我编写了一个单元测试程序，它使用线程将计算存储在 boost::future 中。要链接该测试，我必须添加 -lboost_thread-mt。但是我不需要更改其他 boost -l args 来使用 -mt 版本。

我已经阅读了boost 站点上的[Library Naming](http://www.boost.org/doc/libs/1_41_0/more/getting_started/windows.html#library-naming) 部分，但我不清楚“表明该库是在启用多线程支持的情况下构建的。没有多线程支持的库可以通过缺少 -mt 来识别”实际上是什么意思。

1.  如果我与 -lboost_thread-mt 链接，是否需要切换到其他库的多线程感知版本？如果没有，我什么时候需要链接 -mt 变体？

2.  是否有建议仅在需要时才选择性地链接到 -mt 变体？该项目使用 GNU Make 进行构建。

3.  总是链接到 -mt 变体是否有性能或功能损失？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-07-18T08:59:59.970

当您`threading=multi`在 bjam 行中设置时，将构建“mt”变体。“mt”选项的后果之一`BOOST_HAS_THREADS`是定义。

当然，您链接的所有 boost 库都应该是相同的变体，这与您的应用程序的线程匹配。否则，您最终可能会违反 ODR：想象一个`shared_ptr`在没有 . 的库 A中编译`BOOST_HAS_THREADS`，而在没有 . 的库 B中编译`BOOST_HAS_THREADS`。两者`shared_ptr`的自旋锁类实现完全不同。因此，如果您`shared_ptr`从库 A 获取并将其传递给库 B，您的程序就会崩溃。此外，mt 和非 mt 变体可能使用不同的堆。

（也就是说，值得一提的是 BOOST_HAS_THREADS 依赖于其他一些宏，甚至可以在非 mt 变体中定义，因此将 mt 与非 mt 混合有时会起作用——但不要依赖于此。）

至于性能损失 - 显然，mt 变体可能会慢一些。

**更新**：我的假设`BOOST_HAS_THREADS` [似乎是错误](http://boost.2283326.n4.nabble.com/config-policy-for-setting-BOOST-HAS-THREADS-td2583662.html)的。尽管如此，混合 mt/非 mt 变体还是个坏主意，因为这`threading=multi`会影响 Boost ABI。

# switch-statement - 切换内容jquery

> ID：11526200
> 
> 赞同：0
> 
> 时间：2012-07-17T15:48:25.010
> 
> 标签：switch-statement

当我点击不同的按钮时，我希望能够显示同一段落的不同语言版本。如果我单击“英语”，它将显示它后面的段落，但不会显示法国之后的段落。同样，当我单击“法国”时，只会显示后面的段落。我有下面的代码，但是当我点击时没有任何段落出现。知道有什么问题吗？

```
<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.1//EN"
    "http://www.w3.org/TR/xhtml11/DTD/xhtml11.dtd">

<html class="no-js" lang="en">

<!--<![endif]-->

<head>

  <meta charset="utf-8" />

  <!-- Always force latest IE rendering engine & Chrome Frame -->

  <meta http-equiv="X-UA-Compatible" content="IE=edge,chrome=1">

  <title></title>

  <!-- CSS Styles -->

  <link rel="stylesheet" href="style.css" />
<style>
 .panels { display: none; }
    </style>
</head>

<body>

  <div class="text">

    <img src="closed.png" alt="Under Maintenance" />
<div class="links">
   <a href="#Eng">English</a>
   <a href="#Fra">France</a>
</div>
    <p id="Eng" class="panels">

      Site is currently down for maintenance.</p>

    <p id="Fra" class="panels">

      French version goes here.</p>

  </div>

<script>
$(".links a").click(function() {
    $(".panels").hide();
    $(this.hash).fadeIn();
});
</script>

</body>

</html> 
```

# sql - sql server 合并两个不同结构的表

> ID：11526202
> 
> 赞同：0
> 
> 时间：2012-07-17T15:48:28.410
> 
> 标签：sql, sql-server

我有一种情况，我必须在不丢失任何数据的情况下合并两个表。这两个表具有不同的结构。以下是我的表的结构

```
TABLE A 
ID_NO INT,
Ship_Date DATE,
Status varchar(10),
total decimal(12,2)

TABLE B
ID_NO INT,
Status varchar(10),
total decimal(12,2) 
```

我尝试通过在表 B 中包含一个虚拟列来使用 UNION ALL，如下所示

```
TABLE B
ID_NO INT,
'',
Status varchar(10),
total decimal(12,2) 
```

但在结果集中，我得到 1900-01-01 作为 Ship_Date 而不是“”。如何消除这种情况？

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-07-17T15:51:50.147

使用 NULL 值而不是空字符串。如果您不介意将 Ship_Date 结果作为字符串，则可以将 UNION 包装在另一个 select 语句中。

```
SELECT U._ID_NO, 
       CASE WHEN U.Ship_Date IS NULL 
               THEN ''
               ELSE CONVERT(NVARCHAR(50), U.Ship_Date,101) END AS Ship_Date,
       U.Status, 
       U.total 
FROM
(
  SELECT A.ID_NO, A.Ship_Date, A.Status, A.total 
  FROM TableA

  UNION ALL

  SELECT B.ID_NO, NULL AS Ship_Date, B.Status, B.total 
  FROM TableB
) AS U 
```

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-07-17T15:51:28.280

`Ship_Date`是一种`date`数据类型，为什么不用`NULL`作虚拟占位符呢？

```
TABLE B
ID_NO INT,
NULL,
Status varchar(10),
total decimal(12,2) 
```

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2012-07-17T15:51:28.090

你得到`1900-01-01`是因为该列类型是 DATETIME。如果您希望它是“空的”，请使用`NULL`而不是。`''`

尝试：

```
select 
    ID_NO,
    case
        when Ship_Date is NULL then ''
       else Ship_Date
    end as Ship_Date,
    Status,
    total
from
(
    select
        ID_NO,
        Ship_Date,
        Status,
        total
    from
        table_a

    union all

    select
        ID_NO,
        NULL as Ship_Date,
        Status,
        total
    from
        table_b 
) combined 
```

# wpf - WPF 窗口 IsClosing 布尔值

> ID：11526203
> 
> 赞同：1
> 
> 时间：2012-07-17T15:48:29.523
> 
> 标签：wpf, window

当我单击“取消”按钮或关闭窗口（ALT+F4 或单击 x）时，我希望使用相同的命令。问题是该命令最终将关闭处于“关闭”模式的窗口，该模式被拒绝 - 我无法关闭正在关闭的窗口。如何区分窗口中的“IsClosing”模式？它没有这个布尔属性......

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-07-18T13:37:50.243

想象一下，我在一个窗口中有 2 种不同的行为。

*   删除数据 - 当我取消或 ALT+F3 时。
*   保留数据 - 当我单击确定按钮时。

我必须抓住 ALT+F4 动作的唯一方法是关闭事件。我的解决方案是只有当我使用 te OK 命令进入窗口时才有一个标志。我测试该标志，如果为真则保留数据，否则删除数据。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-07-17T16:18:12.173

我不完全确定你在问什么。如果您提供一些代码来显示您现在正在尝试做什么，我可能会为您提供更好的帮助。

与此同时，这个问题似乎在问与你类似的问题。你为什么不检查一下，看看它是否有帮助？

[关闭 WPF 窗口](https://stackoverflow.com/questions/2411828/wpf-window-on-closing)

# python - 我启动了 15 个 Python 线程，但是为什么 top 命令说只有 1 个正在运行？

> ID：11526206
> 
> 赞同：0
> 
> 时间：2012-07-17T15:48:32.520
> 
> 标签：python, multithreading

我启动了 15 个 Python 线程，但 top 命令说只有 1 个正在运行：

*top -p 4176，然后输入 H*

```
top - 23:46:56 up 46 days,  5:43,  1 user,  load average: 1.16, 1.07, 1.01
Tasks:  16 total,   **1 running**,  15 sleeping,   0 stopped,   0 zombie
Cpu(s): 29.8%us,  0.8%sy,  0.0%ni, 68.4%id,  0.9%wa,  0.0%hi,  0.0%si,  0.0%st
Mem:   8085788k total,  7944132k used,   141656k free,   140756k buffers
Swap:  7811068k total,        0k used,  7811068k free,  6902536k cached

  PID USER      PR  NI  VIRT  RES  SHR S %CPU %MEM    TIME+  COMMAND
29771 scraping  20   0  341m 148m 3460 S 16.6  1.9  27:46.68 python
29760 scraping  20   0  341m 148m 3460 S 16.3  1.9  27:45.82 python
29768 scraping  20   0  341m 148m 3460 S  9.0  1.9  28:15.11 python
29767 scraping  20   0  341m 148m 3460 S  8.7  1.9  27:47.97 python
29770 scraping  20   0  341m 148m 3460 R  8.0  1.9  28:05.83 python
29758 scraping  20   0  341m 148m 3460 S  7.7  1.9  28:02.30 python
29761 scraping  20   0  341m 148m 3460 S  7.0  1.9  27:40.68 python
29759 scraping  20   0  341m 148m 3460 S  6.7  1.9  28:21.71 python
29763 scraping  20   0  341m 148m 3460 S  5.7  1.9  28:11.03 python
29769 scraping  20   0  341m 148m 3460 S  5.7  1.9  27:59.36 python
29757 scraping  20   0  341m 148m 3460 S  4.3  1.9  28:01.46 python
29762 scraping  20   0  341m 148m 3460 S  4.0  1.9  28:03.70 python
29765 scraping  20   0  341m 148m 3460 S  4.0  1.9  27:37.34 python
29766 scraping  20   0  341m 148m 3460 S  1.0  1.9  28:05.28 python
29764 scraping  20   0  341m 148m 3460 S  0.3  1.9  27:44.07 python
 4761 scraping  20   0  341m 148m 3460 S  0.0  1.9   0:00.61 python 
```

我想知道为什么只有 1 个正在运行的任务而不是 15/16？

非常感谢。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-07-17T15:49:38.830

因为它们是线程，而不是进程。一个进程归操作系统所有，一个进程可以有多个线程。 [http://www.cafeaulait.org/course/week11/02.html](http://www.cafeaulait.org/course/week11/02.html)

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2012-07-17T15:57:21.730

在 *nix 上的 CPython 线程是使用 pthread 实现的，并且在使用 top/htop 等时它们显示为单独的进程，即使它们不是（运行 15 个 python 进程和运行 15 个 python 线程和`top`输出之间存在很大差异在这里可能会产生误导）。

There is only one running due to [GIL](http://wiki.python.org/moin/GlobalInterpreterLock) - in CPython there's always only one instruction executing at a time in each interpreter.

# c# - 从 MySQL 数据库中读取 BLOB 图像

> ID：11526209
> 
> 赞同：6
> 
> 时间：2012-07-17T15:48:45.770
> 
> 标签：c#, .net, mysql, blob

我在从 MySQL 数据库中读取 blob 时遇到了一些问题。我已经让它成功插入数据库，但似乎无法让它读回。我知道你们中的一些人可能会想“为什么他要使用数据库来存储图像的 blob，而不仅仅是文件路径/文件名”，但我希望具有灵活性，因为很多这些图像将存储在服务器而不是本地，这可以优化效率，并允许我在需要时将图像移动到本地。我遵循了一个（简短的）教程，并编写了以下用于接收 blob 的方法；

```
public void getBlob(string query, string fileOut)
    {
        if (this.OpenConnection() == true)
        {
            MySqlCommand cmd = new MySqlCommand(query, mConnection);

            //the index number to write bytes to
            long CurrentIndex = 0;

            //the number of bytes to store in the array
            int BufferSize = 100;

            //The Number of bytes returned from GetBytes() method
            long BytesReturned;

            //A byte array to hold the buffer
            byte[] Blob = new byte[BufferSize];

            //We set the CommandBehavior to SequentialAccess
            //so we can use the SqlDataReader.GerBytes() method.

            MySqlDataReader reader = cmd.ExecuteReader(CommandBehavior.SequentialAccess);

            while (reader.Read())
            {
                FileStream fs = new FileStream(DeviceManager.picPath + "\\" + reader["siteBlobFileName"].ToString(), FileMode.OpenOrCreate, FileAccess.Write);
                BinaryWriter writer = new BinaryWriter(fs);
                CurrentIndex = 0;
                BytesReturned = reader.GetBytes(1, CurrentIndex, Blob, 0,BufferSize);  

                while (BytesReturned == BufferSize)
                {
                    writer.Write(Blob);
                    writer.Flush();
                    CurrentIndex += BufferSize;
                    BytesReturned = reader.GetBytes(1, CurrentIndex, Blob, 0, BufferSize);
                }

                writer.Write(Blob, 0, (int)BytesReturned);
                writer.Flush();
                writer.Close();
                fs.Close();
            }
            reader.Close();

            this.CloseConnection();
        }
    } 
```

我这样称呼它..

```
 mDBConnector.getBlob("SELECT siteMapPicture, siteBlobFilename FROM sites WHERE siteID = '" + DeviceManager.lastSite + "'", DeviceManager.picPath + "mappicsite" + DeviceManager.lastSite);

PBSite.BackgroundImage = Image.FromFile(DeviceManager.picPath + "mappicsite" + DeviceManager.lastSite); 
```

但是它在 BytesReturned = reader.GetBytes(1, CurrentIndex, Blob, 0,BufferSize); 上出错了 出现错误“GetBytes 只能在二进制或 guid 列上调用”。我假设这与我的数据库中的字段类型有关，但是将列更改为二进制类型意味着我必须将其存储为 blob 类型，但我想将文件名保留为常规字符串。有什么我想念的吗？或另一种方法？

edit1：我认为 bytesreturned 的第一个参数与读取器中的列有关，将其设置为 0 会给出错误“使用 SequentialAccess 读取先前列的尝试无效”，请对此进行研究。

edit2：删除顺序访问给了我一个大小为 13 字节的文件，（这可能只是第一行，这就是顺序访问读取所有行的原因？）所以也许我正在以错误的顺序读取列..

编辑3：我相信这个错误的原因是由于我输入数据库的方式。更改此方法后，我的 saveBlob 现在看起来像这样：

```
public void saveBlob(string filePath, string fileName, string siteID)
    {
        if (this.OpenConnection() == true)
        {

            //A stream of bytes that represnts the binary file
            FileStream fs = new FileStream(filePath, FileMode.Open, FileAccess.Read);

            //The reader reads the binary data from the file stream
            BinaryReader reader = new BinaryReader(fs);

            //Bytes from the binary reader stored in BlobValue array
            byte[] BlobValue = reader.ReadBytes((int)fs.Length);

            fs.Close();
            reader.Close();

            MySqlCommand cmd = new MySqlCommand();
            cmd.Connection = mConnection;
            cmd.CommandType = CommandType.Text;
            cmd.CommandText = "INSERT INTO x (y, z) VALUES (@BlobFile, @BlobFileName)";

            MySqlParameter BlobFileNameParam = new MySqlParameter("@BlobFileName", SqlDbType.NChar);
            MySqlParameter BlobFileParam = new MySqlParameter("@BlobFile", SqlDbType.Binary);
            cmd.Parameters.Add(BlobFileNameParam);
            cmd.Parameters.Add(BlobFileParam);
            BlobFileNameParam.Value = fileName;
            BlobFileParam.Value = BlobValue;

                cmd.ExecuteNonQuery();

            this.CloseConnection();
        }
    } 
```

我已经运行了调试器，并且 blobvalue 和 blobfileparam(@blobfile) 都具有完整大小（大约 150k ），但是在执行查询时出错，出现以下错误；

```
"unable to cast object of type 'system.byte[]' to type 'system.iconvertible" 
```

我查看了代码并尝试将类型二进制更改为图像，以允许更大的文件，但给出了相同的错误。有人知道这个新信息吗？

编辑4：修复一切。注意到在我的代码中我使用的是：

```
 ("@BlobFile", SqlDbType.Binary); 
```

将这些更改为“MySqlDbType”（derp）类型，它允许我选择 blob 的类型。事情终于按预期工作了:)

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-07-25T09:26:56.410

您是否尝试过先简化？不要一次读取 100 个字节的 BLOB，而是尝试简化代码以将所有字节读取到文件中。这样您就可以轻松排除数据层问题。

以下文档还建议您将文件大小存储为另一列：[使用连接器/NET 处理 BLOB 数据](https://dev.mysql.com/doc/connector-net/en/connector-net-programming-blob.html)

# c - 编写一个程序，以有限数量的文件定位步骤反转二进制文件中的字节顺序

> ID：11526211
> 
> 赞同：1
> 
> 时间：2012-07-17T15:48:47.127
> 
> 标签：c, file, binary

我需要编写一个程序来反转给定二进制文件中字节的顺序。它接受命令行中的文件名。此外，它可以使用 fseek 等文件定位功能不超过固定次数。

这是我编写的代码，它没有使用固定次数：

```
#include <stdio.h>
#include <string.h>
#include <stdlib.h>

int main(int argc, char** argv) {

    if (argc>2) {
        printf("Please enter a valid file name");
        return 1;
    } else {
        FILE* file;
        file=fopen(argv[1], "r");
        if (file==NULL) {
            printf("Please enter a valid file name");
            return 1;
        } else {
            FILE* fileBackUp;
            fileBackUp=fopen("c:\backupFile.txt", "w+");
            fseek(file, 0, SEEK_END);
            fseek(file, -1, SEEK_CUR);
            while (ftell(file)>=0) {
                int c= fgetc(file);
                fputc(c, fileBackUp);
                fseek(file, -2, SEEK_CUR);
            }

            fseek(fileBackUp, 0, SEEK_SET);

            int c;
            while (!feof(fileBackUp)) {
                c=fgetc(fileBackUp)
                fputc(c,file);
            }

            fclose(fileBackUp);
            fclose(file);
        }
    }
    return 1;
} 
```

它为此使用了一个额外的文件。我当然相信有一种更短的优雅方法可以按照要求减少步骤。有什么建议么？

另一件事：似乎第一个条件总是被满足，怎么会？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-07-17T16:13:57.183

```
#include <stdio.h>

long max(long v1, long v2) { return v1 >= v2 ? v1 : v2; }
long min(long v1, long v2) { return v1 >= v2 ? v2 : v1; }
void invert_bits(char *arr, size_t size);

int main(int argc, char *argv[]) {
  size_t  read_sz;
  FILE * infile = fopen(argv[1], "r");
  fseek(infile, 0, SEEK_END);
  long file_sz = ftell(infile);
  long offset  = file_sz;
  long total_read = 0;
  long num_seeks  = 10;
  size_t  buffer_sz = (file_sz + num_seeks - 1) / num_seeks;
  char    buffer[buffer_sz];
  while (file_sz > total_read) {
    if ((offset + num_seeks - 1) / num_seeks < buffer_sz) {
      buffer_sz = offset / num_seeks;
    }
    offset = max(0, offset - buffer_sz);
    fseek(infile, offset, SEEK_SET);
    read_sz = fread(buffer, 1,
        min(buffer_sz, file_sz - total_read), infile);
    total_read += read_sz;
    invert_bits(buffer, read_sz); 
    num_seeks--;
  }
  fclose(infile);
}

void invert_bits(char *arr, size_t size) {
  size_t i;
  int j;
  for (i = size; i > 0; i--) {
    char v = arr[i - 1];
    char o = 0;
    for (j = 0; j < 8; j++) {
      o |= v & 1;
      v >>= 1;
      o <<= 1;
    }
    printf("%c", o);
  }
} 
```

# javascript - 从元素属性值初始化 Knockout observable

> ID：11526216
> 
> 赞同：14
> 
> 时间：2012-07-17T15:49:01.053
> 
> 标签：javascript, knockout.js, knockout-2.0

我有一个元素，该元素拥有一个属性，其值绑定到可观察到的淘汰赛：

`<text transform='matrix(1 0 0 1 1 1)' data-bind='attr:{transform:textTransform}'></text>`

当元素加载时，我希望 observable 包含在 dom 元素上定义的值，但是它加载为 undefined 并且该属性从 dom 元素中全部删除：

`<text data-bind='attr:{transform:textTransform}'></text>`

是否可以从 dom 元素属性初始化可观察到的淘汰赛的值并保持 dom 元素属性的值？

更新：http: [//jsfiddle.net/5Z2SC/10/](http://jsfiddle.net/5Z2SC/10/)

* * *

## 回答 #1

> 赞同：19
> 
> 时间：2012-07-17T16:23:34.257

另一种选择是使用自定义绑定，并在 init 函数中收集元素的当前值。在我看来，这更可重用。

```
ko.bindingHandlers.transform = {
    init: function(element, valueAccessor) {
        valueAccessor()(element.getAttribute('transform'));
    },
    update: function(element, valueAccessor) {
        var value = valueAccessor();
        element.setAttribute('transform', ko.utils.unwrapObservable(value))
    }
}; 
```

当然，你的会更复杂，因为你必须用这个转换属性*做一些事情。*该逻辑可能需要进入该`update`部分。

* * *

## 回答 #2

> 赞同：5
> 
> 时间：2012-07-17T16:02:46.533

在调用 ko.applyBindings() 之前，不会解析数据绑定属性。因此，如果您需要从元素中获取属性数据，您可以这样做。

```
function MyModel(){
    this.textTransform = ko.observable($('#myElement').attr('transform'));
}

ko.applyBindings(new MyModel()); 
```

基本上，您正在获取属性的值并将其设置为可观察对象的初始值。data-bind 属性是一个模板，因此应在 ViewModel 中指定初始值或默认值。

另一种选择是编写一个自定义活页夹，如果 observable 返回 null 则可以存储默认值...

# algorithm - 最近点对算法的一种变体

> ID：11526220
> 
> 赞同：3
> 
> 时间：2012-07-17T15:49:12.880
> 
> 标签：algorithm, geometry

最近点对问题在计算几何中是众所周知的：给定一个点列表 (x, y) 找到具有最小欧几里得距离的点对。现在我要问这个问题的一个变体：给定一个包含 n 个点 (xi,yi) (n+1>i>0) 的列表，找到每个点 (xi,yi) 的最近欧几里得距离，然后计算所有点的平均最近欧几里得距离。我知道蛮力方法：

```
all_distance = [];
for i= 1 to n
    p = (xi,yi);
    dis = [];
    for j= 1 to n
      if j==i
          continue;
      else
          q = (xj,yj);
          pt_dis = distance(p,q);
      end 
      dis = [dis; pt_dis];
    end
    all_distance = [all_distance; nearest(dis)]

end
mean_distance = all_distance/n; 
```

这种方法很简单，但计算起来很慢。我想知道是否有一些快速算法可以解决这个问题。谢谢！

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-07-17T16:20:00.937

这个问题通常最好通过[kd-tree](http://en.wikipedia.org/wiki/K-d_tree)或[quadtree](http://en.wikipedia.org/wiki/Quadtree)来解决，但如果你想要一些快速而肮脏的东西，那么你应该尝试以某种方式存储你的点。也就是说，假设您的点大致均匀分布在 (0,0) 到 (10,10) 的范围内，您可以制作 1 个单位平方的桶，在这种情况下为 100 个桶。现在，您通过在其存储桶和所有八个相邻存储桶中查找其最近点来处理一个点。如果您发现任何距离为 1 个单位或更小的点，那么您知道它是最近的点，因为更近的点必须不在相邻的桶之一中，这意味着它必须超过 1 个单位。如果您没有找到这么近的点，那么您将需要检查所有点，或者您可以扩展到下一个桶环。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-07-17T16:32:42.367

您可以在 O(n log n) 时间内计算[Delaunay 三角剖分](http://en.wikipedia.org/wiki/Delaunay_triangulation)，并且对于每个顶点，最近的点将是三角剖分上的相邻点之一。将要检查的总边数为 O(n)，因此它由 O(n log n) 三角剖分成本控制。

# python - 如何设置python环境变量？

> ID：11526228
> 
> 赞同：1
> 
> 时间：2012-07-17T15:49:45.203
> 
> 标签：python, environment-variables

我想阻止 python 自动创建 __pycache__ 目录。通过一些搜索，我了解到我需要设置`PYTHONDONTWRITEBYTECODE`python 环境变量。

在 Windows 环境中，此设置是否与我设置任何其他系统环境变量（例如 PATH）的方式完全相同？如果没有，我该如何设置这个变量，以便在我运行 python 时设置这个变量？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-07-17T15:51:12.457

错误，尝试使这至少 30 个字符时的简单答案是 - 是的。（设置为什么并不重要，只要设置为 - 尽管 1 可能是合理的）。

如果您不想在系统级别/用户级别的基础上执行此操作，那么您始终可以使用该`-B`选项运行 python。

# c - 更改函数内的指针

> ID：11526233
> 
> 赞同：0
> 
> 时间：2012-07-17T15:49:55.317
> 
> 标签：c, pointers, pass-by-reference, message-queue

我正在用 C 语言制作消息队列 API，但接收方法有问题。我将 char* 消息（“BOB”）发送到消息队列并成功存储。然后我尝试接收消息，但失败了。

在 mq_receive() 中，正确的消息被出列并且 ret_val->buf 指向 0x012f5754 ("BOB")。接下来，msg_ptr（原来是 0x00000000）被赋值为 0x012f5754。在程序返回 main() 之前，一切都按预期工作。在 main() 中，receive_message 仍然为 NULL。我期待它指向 BOB 的第一个字符，即 0x012f5754。我究竟做错了什么？谢谢。

```
//main.c
main(){
    char* receive_message = NULL;
    //message queue init ...
    mq_send(msq_id, "BOB"); //this works correctly
    mq_receive(msq_id, receive_message);      
    printf("return value: %p\n", receive_message); 
}

//message_queue.c
mqd_t mq_receive(mqd_t mqdes, char *msg_ptr)
{
    queue_t* ret_val;
    q_attr* attr_ptr = (q_attr*)mqdes;
    ret_val = dequeue(attr_ptr);
    //all this works ret_val->buf points to BOB
    msg_ptr = ret_val->buf;
    return mqdes;
} 
```

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-07-17T15:52:38.837

参数在 C 中按值传递，您需要传递 to 的`receive_message`地址`mq_receive()`：

```
mqd_t mq_receive(mqd_t mqdes, char **msg_ptr)
{
    queue_t* ret_val;
    q_attr* attr_ptr = (q_attr*)mqdes;
    ret_val = dequeue(attr_ptr);
    //all this works ret_val->buf points to BOB
    *msg_ptr = ret_val->buf;
    return mqdes;
} 
```

并调用它：

```
mq_receive(msq_id, &receive_message); 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-07-17T17:43:06.653

回答您针对 hmjd 发布的问题。有一种方法可以在不改变签名的情况下做你想做的事。

如果你改变这个：

```
char* receive_message = NULL; 
```

类似于：

```
char receive_message[1000]; 
```

然后，您可以在不更改函数原型的情况下存储收到的消息的*副本。*`strcpy`但是正如hmjd所说，如果不传入双指针，真的没有办法修改指针本身。

# c# - ListBox 垂直滚动条在菜单中不起作用

> ID：11526238
> 
> 赞同：0
> 
> 时间：2012-07-17T15:50:12.027
> 
> 标签：c#, .net, wpf

我有一个菜单，我必须在其中显示几种项目类型。这是我现在拥有的代码示例：

```
 <Menu Height="23" HorizontalAlignment="Left" Margin="84,40,0,0" Name="menu1" VerticalAlignment="Top">
                    <MenuItem Header="(None)" IsTextSearchCaseSensitive="False" IsTextSearchEnabled="False">
                        <MenuItem Header="Aggregation">
                            <MenuItem Header="Sum"/>
                            <MenuItem Header="Average"/>
                        </MenuItem>
                        <Separator/>
                        <ListBox ScrollViewer.VerticalScrollBarVisibility="Visible" >
                            <MenuItem Header="Test0" IsCheckable="True"/>
                            <MenuItem Header="Test1" IsCheckable="True"/>
                            <MenuItem Header="Test2" IsCheckable="True"/>
                            <MenuItem Header="Test3" IsCheckable="True"/>
                            <MenuItem Header="Test4" IsCheckable="True"/>
                        </ListBox>
                        <Separator/>
                        <MenuItem Header="Test5" />
                    </MenuItem>
                </Menu> 
```

如果您注意到，那里有一个 ListBox。我将垂直滚动查看器设置为可见，无论我添加多少项目，它都不会激活。如果您想知道，是的，我尝试使用 ListBoxItem 而不是 MenuItems 并没有产生任何影响。有不同的方法可以做到这一点吗？我该怎么做？谢谢

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-07-17T15:56:31.957

您需要设置 a ，`MaxHeight`否则 ListBox 将根据需要拉伸以显示其所有元素。

```
<ListBox ScrollViewer.VerticalScrollBarVisibility="Visible" MaxHeight="250" /> 
```

也就是说，就像 AkselK 评论的那样，这看起来不像是好的设计。
您可以简单地继续创建子菜单。

# c# - 类型推断和继承

> ID：11526242
> 
> 赞同：4
> 
> 时间：2012-07-17T15:50:21.027
> 
> 标签：c#, generics, inheritance, type-inference

我有一个基类，它具有一些使用类型推断的功能......

```
public abstract class Processor<T>
{
    ...
    public IProcessBuilder<T, TResult> Process<TResult>(Expression<Func<T, TResult>> propertyOfT)
    {
    }

    public abstract void SetProcessors();
} 
```

然后我有两个类：

```
public class EntityBase
{
    public string Name { get; set; }
}

public class EntityChild : EntityBase
{
    public string Description { get; set; }
} 
```

在这两个之上，我还有两个配置这两个类的处理器：

```
public class EntityBaseProcessor : Processor<EntityBase>
{
    public override void SetProcessors()
    {
        base.SetProcessors();
        this.Process(entity => entity.Name)
            .DoSomething();
    }
} 
```

现在的问题是我想为子类重用基实体类的配置过程，以避免代码重复：

```
public class EntityChildProcessor: EntityBaseProcessor
{
    public override void SetProcessors()
    {
        base.SetProcessor();
        this.Process(entity => /* entity.Description is of course missing */)
            .DoSomething();
    }
} 
```

## 问题

我显然很累，因为我似乎找不到一种可行的方法来重用处理器类，因为继承的处理器类也应该使用继承的实体类进行处理。

我当然可以重复代码并将我的其他处理器编写为：

```
public class EntityChildProcessor: Processor<EntityChild>
{
    public override void SetProcessors()
    {
        base.SetProcessor();
        // repeated code for inherited property
        this.Process(entity => entity.Name)
            .DoSomething();
        this.Process(entity => entity.Description)
            .DoSomething();
    }
} 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-07-17T15:58:17.203

使 EntityBaseProcessor 也通用：

```
public class EntityBaseProcessor<T> : Processor<T> where T : EntityBase

public class EntityChildProcessor<T> : EntityBaseProcessor<T> where T : EntityChild 
```

或者：（您可以将非泛型的简单性`EntityChildProcessor`换成永久设置`T`类型的缺点）

```
public sealed class EntityChildProcessor : EntityBaseProcessor<EntityChild> 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-07-17T16:04:55.283

`EntityBaseProcessor`声明为泛型类对您来说如何合理？像这样的东西：

```
public class EntityBaseProcessor<TEntityBase> : Processor<TEntityBase>
    where TEntityBase : EntityBase
{
    public override void SetProcessors()
    {
        base.SetProcessors();
        this.Process(entity => entity.Name)
            .DoSomething();
    }
}

public class EntityChildProcessor : EntityBaseProcessor<EntityChild>
{
    public override void SetProcessors()
    {
        base.SetProcessors();
        this.Process(entity => entity.Description)
            .DoSomething();
    }
} 
```

# jquery - Flowplayer，无限执行提示点

> ID：11526250
> 
> 赞同：2
> 
> 时间：2012-07-17T15:50:42.550
> 
> 标签：jquery, flowplayer

我需要为电子学习应用程序制定以下工作流程：

1.  暂停播放器
2.  隐藏播放器
3.  显示一个问题（挑战）
4.  得到用户回答

5.  如果答案是真的

    1.  隐藏问题 div
    2.  显示播放器
    3.  继续播放
6.  如果答案错误，请重新加载页面并从头开始播放视频

我需要在播放视频时禁用手动搜索。这是我的代码

```
flowplayer_settings.clip.onCuepoint = [config.de, function(clip, point) {
   this.pause();
   this.hide();

   $("#question").show();

   $.ajax({
     url: config.qp,
     success: function(data) {
       $("#question").html(data);
       $('#advance').click(function() {
         $f().show();                                                                                                                                                                                                                  
         $f().resume();
       });
     },
     dataType: 'html'
   });
 }]; 
```

在代码中，当我单击#advance 按钮时，在我正确回答一个问题后显示，我得到另一个问题，似乎提示点被调用了无数次。我无法理解。有什么建议吗？非常感谢。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-07-18T09:27:15.770

我解决了一个肮脏的解决方案，我并不为此感到自豪，但我还没有找到更好的方法来解决这个问题。我只是放了一个标志来检查提示点是否已经被执行，如果是，我跳过提示点代码。

```
flowplayer_settings.clip.onCuepoint = [config.de, function(clip, point) {
if (flag == 1) {
  this.pause();

  if (this.isFullscreen()) {
    this.toggleFullscreen();
  }

  $.blockUI({ message: $("#question"), css: { top: '30%' } });

  $.ajax({
    url: config.qp,
    success: function(data) {
      $("#question").html(data);
      flag = 0;

      $('#advance').click( function () {
        $.unblockUI();
      });

      $('#failure > button').click( function () {
        $.unblockUI();
        location.reload();
      });

    },
    dataType: 'html'
  });
} 
```

# bash - Bash：在 shell 脚本中使用进程 ID

> ID：11526253
> 
> 赞同：0
> 
> 时间：2012-07-17T15:50:45.803
> 
> 标签：bash, parent-child, pid

我对 PID 和父/子进程的使用有点困惑。我一直在阅读它们，并且据我所知，当程序启动时，它会复制自己（孩子）的精确副本，并且每个程序都有唯一的 PID。但我不确定是否可以在 shell 中使用它来告诉我该 shell 程序的某些方面何时完成。

举一个更好的例子（伪代码）：

```
 for ((i = 0; i < 10; i++))
  for a_name in "${anArray[@]}";do
     a series of math equations that allow the values associated with a_name to run in the background simultaneously using '&' earlier in the code         
  done
wait

  for a_name in "${anArray[@]}";do
     same as above but diff equations
  done
wait
done 
```

我希望能够看到命令中任何给定值何时完成，以便该特定值可以移动到下一个 for 循环和命令。

我已经看到 wait 可以将作业标识符作为参数（wait%1 或 wait $PPID），但我不确定这些将如何实现。

有没有人有关于如何使用 PID 的建议和/或有一个超级好的教程的链接？（我的意思是*超级*好，我需要一些外行的术语）

谢谢！

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-07-17T16:15:30.477

您可以等待一个进程：

```
command ${array[0]} &
waiton=$!
# Do some more stuff which might finish before process $waiton
wait $waiton 
```

您可以等待所有子进程：

```
someLongRunningCommand &
(
    for value in "${array[@]}"; do
        command "$value" &
    done
    wait
)
# wait with no arguments waits on all children processes of the current
# process. That doesn't include `someLongRunningCommand`, as it is not
# a child of the process running the subshell. 
```

其他情况比较棘手，可以通过 , 或其他方法更好地`xargs`处理`parallel`。

# java - 使用 Hibernate 延迟获取单列（类属性）

> ID：11526255
> 
> 赞同：20
> 
> 时间：2012-07-17T15:50:50.773
> 
> 标签：java, mysql, sql, hibernate, lazy-loading

我有一张正在使用的旧表，如下所示：

```
+------------------+--------------+------+-----+---------+-------+
| Field            | Type         | Null | Key | Default | Extra |
+------------------+--------------+------+-----+---------+-------+
| BINARY_DATA_ID   | varchar(255) | NO   | PRI |         |       |
| BINARY_DATA      | longblob     | YES  |     | NULL    |       |
| BINARY_DATA_NAME | varchar(255) | YES  |     | NULL    |       |
+------------------+--------------+------+-----+---------+-------+ 
```

这样做的主要问题是`BinaryData`Java 类会加载`BINARY_DATA`列，即使我只需要`BINARY_DATA_NAME`. 我知道构建此架构的最佳方法是将数据从元数据（如文件名）中拆分出来，以便它们存在于单独的表中。从那里开始，使数据延迟加载是微不足道的。这就是它应该首先完成的方式。

不幸的是，由于组织限制，我可能无法执行上述操作。作为一种解决方法，是否可以使用一些注释使该列延迟加载，而不是将内容拆分到单独的表中？我已经修改了这个`BinaryData`类，使它有一个内部静态`BinaryDataData`类，它`@Embedded`的属性是`@Basic(fetch=FetchType.LAZY)`：

```
@Entity
@Table
@Proxy(lazy=false)
@Inheritance(strategy=InheritanceType.JOINED)
public class BinaryData implements Serializable, Persistable<BinaryData>, Cloneable {

    private static final long serialVersionUID = /** blah */;

    @Id @Column @GeneratedValue(generator="uuid") @GenericGenerator(name="uuid", strategy="uuid")
    private String id;

    @Column
    private String binaryDataName;

    @Embedded
    @Basic(fetch = FetchType.LAZY)
    private BinaryDataData binaryData;

    @Transient
    private String cacheId;

    /**
     * Hibernate constructor
     */
    public BinaryData() { /* Creates a new instance of Attachment. */}

    public BinaryData(byte[] binaryData, String binaryDataName) {
        this.binaryData = new BinaryDataData(ArrayUtils.clone(binaryData));
        this.binaryDataName = binaryDataName;
    }

    /**
     * Returns the BinaryData byte stream.
     *
     * @return binaryData byte stream
     */
    @Embedded
    @Basic(fetch = FetchType.LAZY)
    public byte[] getBinaryData() {
        if (this.binaryData == null) {
            return new byte[0];
        }
        return binaryData.getActualData();
    }

    @Embeddable
    public static class BinaryDataData implements Serializable {
        @Column(length=32*1024*1024, columnDefinition="longblob", name="BINARY_DATA") @Lob
        private byte[] actualData;

        public BinaryDataData() { }

        public BinaryDataData(byte[] data) {
            this.actualData = data;
        }

        public byte[] getActualData() {
            if (this.actualData == null) {
                return new byte[0];
            }
            return this.actualData;
        }

        public void setBinaryData(byte[] newData) {
            this.actualData = newData;
        }

        @Override public boolean equals(Object obj) {
            if (this == obj) {
                return true;
            }
            if (obj == null) {
                return false;
            }
            if (!(obj instanceof BinaryDataData)) {
                return false;
            }
            final BinaryDataData other = (BinaryDataData) obj;
            if (!Arrays.equals(actualData, other.actualData)) {
                return false;
            }
            return true;
        }
    }

    /** onwards... */ 
```

不幸的是，这不起作用。即使未请求二进制数据，我看到的 SQL 仍然显示对象的完整获取：

```
select ideaattach0_.BINARY_DATA_ID as BINARY1_9_, ideaattach0_1_.BINARY_DATA as BINARY2_9_, ideaattach0_1_.BINARY_DATA_NAME as BINARY3_9_, ideaattach0_.IDEA_BUCKET_ID as IDEA2_136_ from IDEA_ATTACHMENT ideaattach0_ inner join BINARY_DATA ideaattach0_1_ on ideaattach0_.BINARY_DATA_ID=ideaattach0_1_.BINARY_DATA_ID where ideaattach0_.BINARY_DATA_ID=? 
```

有任何想法吗？谢谢你。

* * *

## 回答 #1

> 赞同：14
> 
> 时间：2012-07-17T16:00:29.370

来自[Hibernate，第 19 章。提高性能](http://docs.jboss.org/hibernate/orm/3.3/reference/en/html/performance.html#performance-fetching-lazyproperties)：

> 惰性属性获取：访问实例变量时获取属性或单值关联。**这种方法需要构建时字节码检测**，并且很少需要。

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2017-10-30T12:05:58.063

对于 maven 项目，需要在 pom.xml 中添加以下插件依赖项：

```
<plugin>
    <groupId>org.hibernate.orm.tooling</groupId>
    <artifactId>hibernate-enhance-maven-plugin</artifactId>
    <version>${hibernate.version}</version>
    <executions>
        <execution>
            <configuration>
                <failOnError>true</failOnError>
                <enableLazyInitialization>true</enableLazyInitialization>
            </configuration>
            <goals>
                <goal>enhance</goal>
            </goals>
        </execution>
    </executions>
</plugin> 
```

我已经在我的项目中检查了它并且它有效，实体示例：

```
@Entity(name = "processing_record")
public class ProcessingRecord {

/**
 * Why uuid: https://www.clever-cloud.com/blog/engineering/2015/05/20/why-auto-increment-is-a-terrible-idea/
 */
@Id
@Column(name = "record_id")
@org.hibernate.annotations.Type(type = "pg-uuid")
private UUID id;

...

/**
 * Processing result.
 */
@Column(name = "result")
@Basic(fetch = FetchType.LAZY)
private String result;
... 
```

有关更多详细信息，请查看以下文章：[LINK](https://vladmihalcea.com/the-best-way-to-lazy-load-entity-attributes-using-jpa-and-hibernate/)

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2016-03-13T00:56:11.217

我知道此查询的日期，但是，我也会尝试使用映射为列子集的投影值类，并将该投影与指定的命名查询一起使用，该查询实例化该投影值对象，而不是此处引用的基础对象。

我正在研究使用此方法的解决方案，因此我目前没有完整的示例。但是，基本思想是您将创建一个使用“select NEW Projection_Object_Target”语法的 JPA 查询，其中字段在“Projection_Object_Target”的构造函数中直接引用。

IE 使用构造函数表达式如下：

```
SELECT NEW fully.qualified.package.name.ProjectionObject(baseObject.column_target_0,baseObject.column_target_1,...,baseObject.column_target_n) FROM BaseObjectMappedInDBTable AS baseObject 
```

通用示例用例：

```
String queryStr =
  "SELECT NEW fully.qualified.package.name.ProjectionObject(baseObject.column_target_0) " +
  "FROM BaseObjectMappedInTable AS baseObject";
TypedQuery<ProjectionObject> query =
  em.createQuery(queryStr, ProjectionObject.class);
List<ProjectionObject> results = query.getResultList(); 
```

# asp.net-mvc-3 - 直接从 MVC Web 应用程序中调用 Membership 数据库 Stored Proc

> ID：11526259
> 
> 赞同：0
> 
> 时间：2012-07-17T15:50:54.383
> 
> 标签：asp.net-mvc-3, entity-framework, stored-procedures, asp.net-membership

我有一个使用实体框架访问项目数据库的 MVC 3 Web 应用程序。但是，该项目还使用第二个成员数据库，称为 ApplicationServices。MvcMembership 包使用此数据库进行身份验证。现在，我在我想从我的应用程序调用的 ApplicationServices 数据库中添加了一个自定义存储过程。我怎样才能做到这一点？

我想我可以通过使用 Membership Provider 来做到这一点，但我不知道该怎么做。

这是它在我的 Web.config 文件中的定义方式：

```
 <add name="ApplicationServices" connectionString="Data Source=.\SQLEXPRESS;Persist Security Info=false; Initial Catalog=ApplicationServices; User ID=******; Password=******" />
...

    <membership defaultProvider="AspNetSqlMembershipProvider">
      <providers>
        <clear />
        <add name="AspNetSqlMembershipProvider" type="System.Web.Security.SqlMembershipProvider" connectionStringName="ApplicationServices" ... applicationName="/" />
      </providers>
    </membership> 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-07-17T15:58:16.483

不，您不能从默认值调用它，`SqlMembershipProvider`因为这是一个自定义存储过程，**而成员资格提供者对此一无所知**。

无论如何，您仍然可以像往常一样访问此存储过程。或者您可以自定义`MembershipProvider`并在其中使用此 StoredProcedure。这取决于您使用此 StoredProcedure 的内容和原因

# c# - 从 Selenium webdriver 的当前窗口 GUID 获取窗口句柄 (IntPtr)

> ID：11526260
> 
> 赞同：10
> 
> 时间：2012-07-17T15:50:55.847
> 
> 标签：c#, .net, winapi, selenium, guid

我正在尝试捕获整个浏览器屏幕的屏幕截图（例如，使用任何工具栏、面板等），而不仅仅是整个页面，所以我得到了以下代码：

```
using (FirefoxDriver driver = new FirefoxDriver())
{ 
    driver.Navigate().GoToUrl(url);                

    ScreenCapture sc = new ScreenCapture();

    // How can I find natural IntPtr handle of window here, using GUID-like identifier returning by driver.currentWindowHandle?
    Image img = sc.CaptureWindow(...);
    MemoryStream ms = new MemoryStream();
    img.Save(ms, ImageFormat.Jpeg);
    return new FileStreamResult(ms, "image/jpeg");
} 
```

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-07-20T09:20:44.763

您可以使用以下方法获取窗口句柄[`Process.GetProcesses`](http://msdn.microsoft.com/en-us/library/1f3ys1f9.aspx)：

```
using (FirefoxDriver driver = new FirefoxDriver())
{
    driver.Navigate().GoToUrl(url);

    string title = String.Format("{0} - Mozilla Firefox", driver.Title);
    var process = Process.GetProcesses()
        .FirstOrDefault(x => x.MainWindowTitle == title);

    if (process != null)
    {
        var screenCapture = new ScreenCapture();
        var image = screenCapture.CaptureWindow(process.MainWindowHandle);
        // ...
    }
} 
```

这当然假设您有一个具有该特定标题的浏览器实例。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-07-26T10:10:22.387

只是和黑客的想法。您可以使用反射方法来获取 firefox 实例的进程。首先声明从 FirefoxDriver 继承的 FirefoxDriverEx 类 - 以访问封装 Process 实例的受保护的 Binary 属性：

```
 class FirefoxDriverEx : FirefoxDriver {
        public Process GetFirefoxProcess() {
            var fi = typeof(FirefoxBinary).GetField("process", BindingFlags.NonPublic | BindingFlags.Instance);
            return fi.GetValue(this.Binary) as Process;
        }
    } 
```

比您可能获得访问 MainWindowHandle 属性的流程实例

```
using (var driver = new FirefoxDriverEx()) {
            driver.Navigate().GoToUrl(url);

            var process = driver.GetFirefoxProcess();
            if (process != null) {
                var screenCapture = new ScreenCapture();
                var image = screenCapture.CaptureWindow(process.MainWindowHandle);
                // ...
            }
        } 
```

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2016-09-09T00:29:37.003

开箱即用，selenium 不会公开驱动程序进程 ID 或浏览器 hwnd，但它是可能的。以下是获取 hwnd 的逻辑

*   初始化驱动程序时，获取集线器的 url 并提取端口号
*   从端口号中，找到正在使用该端口进行侦听的进程ID，即。驱动程序PID
*   导航后，从所有 iexplore 实例中找到父 PID 匹配驱动程序的 pid，即浏览器 pid。
*   找到浏览器 hwnd 后获取浏览器 pid 的 Hwnd，您可以使用 win32 api 将 selenium 带到前台。

不可能在这里发布完整的代码，将浏览器放在前面的完整工作解决方案（C#）在我的博客上

[http://www.pixytech.com/rajnish/2016/09/selenium-webdriver-get-browser-hwnd/](http://www.pixytech.com/rajnish/2016/09/selenium-webdriver-get-browser-hwnd/)

# css - 如何在css中使用浮动创建表格布局

> ID：11526261
> 
> 赞同：1
> 
> 时间：2012-07-17T15:50:55.860
> 
> 标签：css

我想在外部 div 中创建 3 个 div。外部 div 是 72%。**第一、第二、第三**类的三个内部跨度应该是 24%。

```
 <div id="outer">
   <div id="inner">
      <div class="content">
      <span class="first">
      HELLO
      </span>
      </div>

    <div class="content">
      <span class="second">
      pRERNA
          </span>
      </div>

   <div class="content">
      <span class="third">
      gOLANI
       </span>
    </div> 
```

css

```
#inner
   {
      width:72%;   
   }

    div.content span.first
    {
        display:block;
        float:left;
        width:33%;

    }
    div.content span.second
    {
        clear:left;
        display:block;
        float:right;
        width:33%;

    } 
```

我想借助css的**float属性来做到这一点**

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-07-17T15:56:13.487

我会摆脱跨度，给第一个第二个和第三个 div 一个“内容”类，然后在你的 css put:`.content { float: left; }`中。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-07-17T16:05:06.670

废弃`span`，改为为所有 3 个 div 分配一个类，然后`float:`在该类上使用。如果这不起作用，您可能会更轻松地使用`display: table-`.

[http://www.w3schools.com/cssref/pr_class_display.asp](http://www.w3schools.com/cssref/pr_class_display.asp)

# c++ - 初始化的奇怪优化

> ID：11526263
> 
> 赞同：-1
> 
> 时间：2012-07-17T15:51:08.603
> 
> 标签：c++, c, volatile

我意识到我的例子一般不正确。但有趣的是找出它是如何工作的。

```
/* C/C++ (gcc-4.3.4) */
#include <stdio.h>
int main() {

        /*volatile*/ int i = 5;
        int j = 500;

        int *p = &j;

        printf( "%d %x\n", *p, p );

        p++;

        printf( "%d %x\n", *p, p  ); // works correct with volatile (*p is 5)
        //printf( "%d %x\n", *p, &i  ); //  works correct without volatile

        return 0;
} 
```

是某种优化吗？

**UPDT** 好的，我了解了 UB。我不会寄希望于其他人。

但是，如果我有 2 个彼此相邻放置的 int 变量（请参阅地址），为什么此代码不起作用？

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-07-17T15:55:11.880

```
p++; 
```

代码具有未定义的行为。指针指向一些垃圾位置。取消引用它会导致无法预测的结果。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-07-17T17:07:19.100

这两个变量在内存中不一定相邻。您可以使用数组来执行此操作。

```
#define PRINT(p) (printf("%i %p\n", *(p), (void *)(p)))

int t[2];
int *a = &t[0];
int *b = &t[1];

*a = 5;
*b = 6;

int *p = a;
PRINT(p);

++p;
PRINT(p); 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-07-17T15:55:49.100

你叫`corerct`什么？不保证，变量将如何存储，所以`ANY`结果是正确的

# php - 从我的手机呼叫我的网站

> ID：11526264
> 
> 赞同：0
> 
> 时间：2012-07-17T15:51:10.433
> 
> 标签：php, apache, phone-call

有没有办法打电话给我的网站来接收一些关于它的数据？例如：我将手机连接到我的电脑并从另一部手机呼叫它，然后我按 1，它会告诉我有多少用户在线或类似的东西？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-07-17T15:54:35.830

简短的答案是否定的，长的答案是肯定的，这是可能的，但是对于此功能，您需要安装一个非常昂贵的呼叫系统来与您的站点连接。

# php - extjs 在登录时显示确认表单

> ID：11526270
> 
> 赞同：0
> 
> 时间：2012-07-17T15:51:26.960
> 
> 标签：php, extjs3

我正在尝试修改别人的 extjs 代码，我真的需要一些帮助。

基本上，当验证用户名/密码时，会调用包含在 index.php 中的dashboard.js。现在我需要做的是在验证用户名/密码后，我需要另一个表单来弹出询问确认号码。这不需要验证（只需检查空字符串），只需在表单中输入，我需要将其保存在会话中。

```
 //index.php
    <script>
            Ext.onReady( function() {

                Web.ip = '<?php print $_SERVER["REMOTE_ADDR"]; ?>';

                var sessionInfo = Web.getCookieInfo();
                if( sessionInfo ) {
                    Web.Dashboard.init();
                    Web.user = sessionInfo;

                    Web.Dashboard.loadDefault();
                } else {
                    Web.Login.init();
                    Web.Dashboard.init();
                }
            });
        </script>

//dashboard.js
Web.Dashboard = function() {

    var contentPanel = new Ext.Panel({
        region: 'center',
        layout: 'fit',
        margins: '0 5 5 0',
        border: true,
        html: ''
    });

    return {

        init: function() {
        ........
        }
    }
}(); 
```

这是我在 onsubmit 函数中调用的成功函数：

```
success: function( result, request ) {

    try {
        var obj = Ext.decode( result.responseText );
        if( obj.success ) {
            var permissions = obj.USER[0].VALUES;
            var p = {};
            for( var i=0 ; i<permissions.length ; i++ ) {
                p[permissions[i].PERMISSION] = true;
            }

            Web.Dashboard.loadDefault();
        } else {
        //alert ('got here');
            if (obj.ErrorCode == 20410 ) {
                th.changePasswordWindow.show();
                return;
            }
            th.loginPanel.form.reset();
            th.loginWindow.displayInfo( 'Invalid username/password' );
        }
    } catch( ex ) {
        th.loginWindow.el.unmask();
        th.loginPanel.focusUsername();
        th.loginPanel.form.reset();
        th.loginWindow.displayInfo( 'Error: ' + ex );

} 
```

},

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-07-17T16:32:29.543

好的，使用包含另一个表单的简单 ActionSheet 进行编辑，它将是一个带有单个输入字段的单独表单 - 更改`textfield.name`并`formpanel.url`使其与您的服务器端匹配。

登录成功后，创建工作表（或另一个模式面板弹出窗口）。渲染并显示，然后向服务器发送另一个请求，`formpanel.getForm().submit()`你应该很高兴。

此示例 ActionSheet 具有按钮处理程序，可根据您的需要调整该功能（成功后重定向等）

```
function loginDone() {
...
 if(success) {
 var pincodeSheet = Ext.create("Ext.ActionSheet", {
    items: [{
        xtype: 'toolbar',
        cls: 'actionSheetToolbar',
        itemId: 'id_title',
        docked: 'top',
        title: ''
    }, {
        xtype: 'spacer',
        height: 10
    }, {
        xtype: 'formpanel',
        padding: 10,
        url: 'set_session_variable_serverside.asp', // adapt this
        items: [{
            title: 'Please enter PIN',
            cls: 'loginTbarTop',
            xtype: 'toolbar',
            docked: 'top'
        }, {
            xtype: 'toolbar',
            docked: 'bottom',
            cls: 'loginTbarBottom',
            items: [{
                xtype: 'spacer'
            }, {
                xtype: 'button',
                text: 'OK',
                ui: 'action',
                handler: function(btn,evt) {
                    // perform any validation here
                    pincodeSheet.down('formpanel').getForm().submit();
                }
            }]
        }, {   /* end docked */
            cls: 'loginFormFieldset',
            xtype: 'fieldset',
            defaults: {
                labelAlign: 'left',
                labelWidth: '35%',
                clearIcon: false
            },
            /* form field declarations */
            items: [{
                tabIndex: 1,
                xtype: 'textfield',
                name: 'session_variable', /// name of input field
                label: 'PIN CODE'
            }] /* end form fields */
        }] /* end form panel items */
    }] /* end sheet items */
 });
 pincodeSheet.render(document.body);

 }

...
} 
```

# javascript - 如何在指南针上显示风向

> ID：11526277
> 
> 赞同：5
> 
> 时间：2012-07-17T15:51:38.697
> 
> 标签：javascript, jquery, jquery-ui, compass-geolocation

我正在开发一个 Web 应用程序，我必须在其中显示温度、湿度、风速、风向等。我正在使用 google.visualization.Gauge() 来显示其他内容，但我想在指南针上显示风向。有谁知道我可以用于网站/webapp 的任何（jQuery/javascript/etc）指南针？谢谢

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-07-17T16:11:44.067

这是我只使用 CSS 的方法。使用变换来旋转针。[**DEMO**](http://jsfiddle.net/adb2A/)你也可以使用[jQuery Rotate](http://code.google.com/p/jqueryrotate/)插件。

HTML

```
<div id="compass">
  <div id="arrow"></div>
</div>​ 
```

CSS

```
#compass {
  width: 380px;
  height: 380px;
  background-image:url('http://i.imgur.com/44nyA.jpg');
  position: relative;
}
#arrow {
  width: 360px;
  height: 20px;
  background-color:#F00;
  position: absolute;
  top: 180px;
  left: 10px;
  -webkit-transform:rotate(120deg);
  -moz-transform:rotate(120deg);
  -o-transform:rotate(120deg);
  -ms-transform:rotate(120deg);

  -moz-transition: all 1s ease;
  -webkit-transition: all 1s ease;
  -o-transition: all 1s ease;
  transition: all 1s ease;
}

#compass:hover #arrow {
  -webkit-transform:rotate(0deg);
  -moz-transform:rotate(0deg);
  -o-transform:rotate(0deg);
  -ms-transform:rotate(0deg);
}​ 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-07-17T16:02:25.160

HTML5 和它的 Canvas 将很快完成这项工作。

[http://www.tutorialspoint.com/html5/canvas_drawing_lines.htm](http://www.tutorialspoint.com/html5/canvas_drawing_lines.htm)

我只是为了完整起见将其发布在这里，我个人仍然会坚持使用 javascript 库。

# ios - iOS 在更大的图像中查找子图像

> ID：11526283
> 
> 赞同：0
> 
> 时间：2012-07-17T15:52:21.910
> 
> 标签：ios, uiimage, cgimage

在较大图像中查找子图像坐标的最佳方法是什么。Subimage 非常简单，而且总是一样的。例如，如何在下图中找到所有黑色方块的坐标： ![查找正方形的坐标](../Images/39bb01481f12697a1011a9ef78e654cd.png)

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-07-17T15:59:27.490

我认为这里最好的方法可能是编写一个函数/UIImage 类别来检查图像中像素的颜色。然后（如果您知道图像是正方形的事实），您可以检查对角线向下移动的每个像素的颜色，直到您的颜色不同（然后您就知道了正方形的位置和大小）。

我发现用于检查像素颜色的一种工作实现是在开源组件[OBShapedButton](https://github.com/ole/OBShapedButton)中。

它是一个[UIImage 类别](https://github.com/ole/OBShapedButton/blob/master/UIImage%2BColorAtPixel/UIImage%2BColorAtPixel.m)。

代码：

```
- (UIColor *)colorAtPixel:(CGPoint)point {
    // Cancel if point is outside image coordinates
    if (!CGRectContainsPoint(CGRectMake(0.0f, 0.0f, self.size.width, self.size.height), point)) {
        return nil;
    }

    // Create a 1x1 pixel byte array and bitmap context to draw the pixel into.
    // Reference: http://stackoverflow.com/questions/1042830/retrieving-a-pixel-alpha-value-for-a-uiimage
    NSInteger pointX = trunc(point.x);
    NSInteger pointY = trunc(point.y);
    CGImageRef cgImage = self.CGImage;
    NSUInteger width = self.size.width;
    NSUInteger height = self.size.height;
    CGColorSpaceRef colorSpace = CGColorSpaceCreateDeviceRGB();
    int bytesPerPixel = 4;
    int bytesPerRow = bytesPerPixel * 1;
    NSUInteger bitsPerComponent = 8;
    unsigned char pixelData[4] = { 0, 0, 0, 0 };
    CGContextRef context = CGBitmapContextCreate(pixelData,
                                                 1,
                                                 1,
                                                 bitsPerComponent,
                                                 bytesPerRow,
                                                 colorSpace,
                                                 kCGImageAlphaPremultipliedLast | kCGBitmapByteOrder32Big);
    CGColorSpaceRelease(colorSpace);
    CGContextSetBlendMode(context, kCGBlendModeCopy);

    // Draw the pixel we are interested in onto the bitmap context
    CGContextTranslateCTM(context, -pointX, pointY-(CGFloat)height);
    CGContextDrawImage(context, CGRectMake(0.0f, 0.0f, (CGFloat)width, (CGFloat)height), cgImage);
    CGContextRelease(context);

    // Convert color values [0..255] to floats [0.0..1.0]
    CGFloat red = (CGFloat)pixelData[0] / 255.0f;
    CGFloat green = (CGFloat)pixelData[1] / 255.0f;
    CGFloat blue = (CGFloat)pixelData[2] / 255.0f;
    CGFloat alpha = (CGFloat)pixelData[3] / 255.0f;
    return [UIColor colorWithRed:red green:green blue:blue alpha:alpha];
} 
```

# powershell - 如何计算 PowerShell 中的对象？

> ID：11526285
> 
> 赞同：167
> 
> 时间：2012-07-17T15:52:28.267
> 
> 标签：powershell, scripting

正如我在 PowerShell 用户指南中所读到的，PowerShell 的核心概念之一是命令接受和返回*对象*而不是文本。例如，运行`get-alias`会返回一些`System.Management.Automation.AliasInfo`对象：

```
PS Z:\> 获取别名

命令类型名称定义
------------ ---- ----------
别名 % ForEach-Object
别名？Where-对象
别名 ac 添加内容
别名 asnp Add-PSSnapIn
别名 cat 获取内容
Alias cd Set-Location
别名 chdir Set-Location
...

```

现在，**我如何获得这些对象的数量？**

* * *

## 回答 #1

> 赞同：234
> 
> 时间：2012-07-17T15:54:29.593

这会让你数数：

```
get-alias | measure 
```

您可以像处理对象一样处理结果：

```
$m = get-alias | measure
$m.Count 
```

如果你想在某个变量中也有别名，你可以使用 Tee-Object：

```
$m = get-alias | tee -Variable aliases | measure
$m.Count
$aliases 
```

[Technet](http://technet.microsoft.com/en-us/library/ee176900.aspx)上提供了有关 Measure-Object cmdlet 的更多信息。

不要将它与用于时间测量的 Measure-Command cmdlet 混淆。（再次在[Technet](http://technet.microsoft.com/library/ee176899.aspx)上）

* * *

## 回答 #2

> 赞同：124
> 
> 时间：2012-07-18T20:57:10.237

就像@jumbo 的回答一样简短:-) 你可以做得更简洁。这只是返回`Count`由前面的子表达式返回的数组的属性：

```
@(Get-Alias).Count 
```

有几点需要注意：

1.  您可以使用任意复杂的表达式代替`Get-Alias`，例如：

    ```
    @(Get-Process | ? { $_.ProcessName -eq "svchost" }).Count 
    ```

2.  对于稳健的解决方案，初始 at 符号 (@) 是**必需的。**只要答案是 2 或更大，您将得到带有或不带有 @ 的等效答案，但是当答案是 0 或 1 时，除非您有 @ 符号，否则您将不会得到**任何输出！**（它`Count`通过强制输出为数组来强制属性存在。）

**2012.01.30 更新**

以上适用于 PowerShell V2。PowerShell V3 的新功能之一是`Count`即使对于单例，您也确实有一个属性，因此在这种情况下 at 符号变得不重要。

* * *

## 回答 #3

> 赞同：24
> 
> 时间：2014-03-26T11:17:54.590

只需使用括号和“计数”。这适用于 Powershell v3

```
(get-alias).count 
```

* * *

## 回答 #4

> 赞同：6
> 
> 时间：2015-07-21T14:44:45.067

`@($output).Count`并不总是产生正确的结果。我用的`($output | Measure).Count`方法。

我通过 VMware Get-VmQuestion cmdlet 找到了这个：

```
$output = Get-VmQuestion -VM vm1
@($output).Count 
```

它给出的答案是一个，而

```
$output 
```

没有产生任何输出（正确答案是 0 与该`Measure`方法产生的结果相同）。

这似乎只是 0 和 1 的情况。任何高于 1 的东西在有限的测试中都是正确的。

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2020-09-09T20:57:57.670

在我的交流中，你提供的 cmd-let 不起作用，答案是空的，所以我不得不做一些更正并且对我来说很好：

```
@(get-transportservice | get-messagetrackinglog -Resultsize unlimited -Start "MM/DD/AAAA HH:MM" -End "MM/DD/AAAA HH:MM" -recipients "user@domain.com" | where {$_.Event
ID -eq "DELIVER"}).count 
```

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2021-12-04T21:56:12.087

```
Get-Alias|ForEach-Object {$myCount++};$myCount 
```

> 158

# ember.js - emberjs - 属性触发两次

> ID：11526286
> 
> 赞同：2
> 
> 时间：2012-07-17T15:52:32.737
> 
> 标签：ember.js

为什么这段代码中的“fullName”函数会执行两次？

```
Person = Ember.Object.extend({
  // these will be supplied by `create`
  firstName: null,
  lastName: null,
  fullName: function() {
    console.log('Full name function...');
    var firstName = this.get('firstName');
    var lastName = this.get('lastName');
    return firstName + ' ' + lastName;
  }.property('firstName', 'lastName')
});

App.tom = Person.create({
  firstName: "Tom",
  lastName: "Dale"
});

App.UsersView = Ember.View.create({
    templateName: 'users',
    users: [App.tom]
}); 
```

稍后在 google-chrome 控制台中：

```
App.tom.set('firstName', 'John') 
```

这输出记录两次。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-07-17T16:20:52.093

确实像一个错误（添加了一个 JSFiddle 来说明：http: [//jsfiddle.net/MikeAski/GRvgt/](http://jsfiddle.net/MikeAski/GRvgt/)）...

视图被重新渲染，计算的属性还没有被缓存。:-(

# c - lua_dump 意外（有时）将用户数据推送到堆栈

> ID：11526292
> 
> 赞同：1
> 
> 时间：2012-07-17T15:52:42.113
> 
> 标签：c, api, lua

当试图将函数的字节码转储到缓冲区时，我惊讶地发现 Lua 堆栈的大小发生了变化。 [文档说 lua_dump 不应该推送或弹出堆栈](http://www.lua.org/manual/5.2/manual.html#lua_dump)。有些功能可以，有些不可以。

这样做：

```
function f() print "x" end 
```

这不会：

```
function f() return "x" end 
```

lua_dump 在这两种情况下都返回 0（没有错误）。

我认为它与`print`函数的使用有关，但我找不到任何描述正在发生的事情或用户数据中可能包含的内容的文档。..或者如果没有它，该字节码是否可以使用。

示例代码：

```
static int base64_write(lua_State* L, unsigned char* str, size_t len, 
        struct luaL_Buffer *buf)
{
    unsigned int idx;
    char code[5];
    for (idx=0; idx<len; idx++){
        sprintf(code, "\\%03d", (unsigned int) str[idx]);
        //printf(code);
        luaL_addlstring(buf, code, 4);
    }
    //printf("\n");
    return 0;
}

void dump_function(lua_State* L){
    int stack_sz;
    int res;
    luaL_Buffer buf;

    luaL_buffinit(L, &buf);

    // ** test 1 - works as expected
    lua_settop(L,0);
    luaL_dostring(L, "function f() return 'x' end");
    lua_getglobal(L, "f");
    printf("stack sz: %i\n", lua_gettop(L));
    res = lua_dump(L, (lua_Writer)base64_write, &buf);
    printf("stack sz: %i\n", lua_gettop(L));

    // ** test 2 - not as expected
    lua_settop(L,0);
    luaL_dostring(L, "function f() print 'x' end");
    lua_getglobal(L, "f");
    printf("stack sz: %i\n", lua_gettop(L));
    res = lua_dump(L, (lua_Writer)base64_write, &buf);
    printf("stack sz: %i\n", lua_gettop(L));  // why is this 2?
    printf("type:%s\n", lua_typename(L, lua_type(L, -1))); // why userdata?
}

/* ----- Registration array ----- */
static const luaL_Reg R[] = {
    {"test",    dump_function},
    {NULL,      NULL} /* sentinel */
};

/* ----- Registration function ----- */

LUALIB_API int register_lua_tserialize(lua_State *L)
{
    lua_newtable(L); 
    lua_setglobal(L, "test"); 
    lua_getglobal(L, "test"); 
    luaL_setfuncs(L, R, 0); 
    lua_settop(L, 0);
    return 1;
} 
```

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-07-17T18:14:10.140

这是因为缓冲区对象的使用。[请参阅http://pgl.yoyo.org/luai/i/luaL_Buffer](http://pgl.yoyo.org/luai/i/luaL_Buffer)上的文档

您需要调用 luaL_pushresult 以摆脱中间缓冲区堆栈项。

# c++ - 基于 C++ 组件的类

> ID：11526297
> 
> 赞同：4
> 
> 时间：2012-07-17T15:53:10.523
> 
> 标签：c++

你好，

我正在编写一个带有容器的基于组件的类，但是在考虑了许多不同的方法之后，我找不到真正符合我想要的方法。

这是一般想法的示例：

![http://imageshack.us/photo/my-images/713/38394964.png/](../Images/2744cd29804a8f42d82aed37fcb99f58.png)

而我已经写的代码：

```
// Abstract class Component
class Component
{
public :
    virtual ~Component() = 0;
    virtual int GetResult() = 0;
};

class AddComponent : Component
{
public :
    int GetResult() { return input1->GetResult() + input2->GetResult(); }

    void SetInput1(Component* c) { input1 = c; }
    void SetInput2(Component* c) { input2 = c; }

private :
    Component* input1;
    Component* input2;
};

class ConstComponent : Component
{
public :
    int GetResult() { return value; }

    void SetValue(int x) { value = x; }

private :
    int value;
};

class SignComponent : Component
{
public :
    int GetResult() { return sign(input->GetResult()); }

    void SetInput(Component* c) { input = c; }

private :
    Component* input;
};

class Container
{
public :
    Container();
    ~Container();

    void SetRootComponent(Component* c) { rootComponent = c; }

    int GetResult() { return rootComponent->GetResult(); }

    AddComponent* AddComponentAdd();
    ConstComponent* ConstComponentAdd();
    SignComponent* SignComponentAdd();

private :
    Component* rootComponent;
    std::vector<Component*> components;
};

void main(void)
{
    // Create container
    Container container = Container();

    // Create components
    SignComponent*    cSign = container.AddComponentSign();
    AddComponent*      cAdd = container.AddComponentAdd();
    ConstComponent* cConst1 = container.AddComponentConst();
    ConstComponent* cConst2 = container.AddComponentConst();

    // Link components
    cSign->SetInput(cAdd);
    cAdd->SetInput1(cConst1);
    cAdd->SetInput2(cConst2);
    cConst1->SetValue(-5);
    cConst2->SetValue(3);

    // Set root component for container
    container.SetRootComponent(cSign);

    // Compute
    int result = container.GetResult();
} 
```

这甚至无法编译，因为“XComponent”转换为“Component”，这是抽象的。我很确定无论如何都有更好（更简单？）的方法来做到这一点，但我没有想法。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-07-17T16:00:51.997

的默认继承`class`是`private`：

```
class ConstComponent : Component 
```

对于`Component`您需要`public`继承的所有子类：

```
class ConstComponent : public Component 
```

如果您试图将`new`子类的实例插入`std::vector<Component*>`（我*认为*您是）。 `private`继承不是`is-a`关系，而是`has-a`关系。请参阅[“私有继承”和“组合”有何相似之处？](http://www.parashift.com/c++-faq/priv-inherit-like-compos.html).

# android - 在原生 Android 日历上添加事件导致 NullPointerException

> ID：11526298
> 
> 赞同：1
> 
> 时间：2012-07-17T15:53:14.000
> 
> 标签：android, date, calendar

我曾尝试使用此代码（正如我在教程中看到的那样）

```
Calendar cal = Calendar.getInstance();  
Intent intent = new Intent(Intent.ACTION_EDIT);
intent.setType("vnd.android.cursor.item/event");
intent.putExtra("beginTime", dateStart.getTime());
intent.putExtra("allDay", false);
intent.putExtra("rrule", "FREQ=DAILY");
intent.putExtra("endTime", dateEnd.getTime());
intent.putExtra("hasAlarm", 1);
startActivity(intent); 
```

在 android 中的集成日历上添加事件

但是正如我所写的那样，就行了一个 NullPointerException 错误

```
startActivity(intent); 
```

有了这个堆栈

```
07-17 19:12:05.469: W/System.err(30939): java.lang.NullPointerException
07-17 19:12:05.469: W/System.err(30939):    at android.app.Activity.startActivityForResult(Activity.java:2827)
07-17 19:12:05.469: W/System.err(30939):    at android.app.Activity.startActivity(Activity.java:2933)
07-17 19:12:05.469: W/System.err(30939):    at myapplication.beachparty.utility.MyUtility.addEventToCalendar(MyUtility.java:44)
07-17 19:12:05.469: W/System.err(30939):    at myapplication.beachparty.it.PartyDetails$2.onClick(PartyDetails.java:114)
07-17 19:12:05.469: W/System.err(30939):    at android.view.View.performClick(View.java:2485)
07-17 19:12:05.479: W/System.err(30939):    at android.view.View$PerformClick.run(View.java:9080)
07-17 19:12:05.479: W/System.err(30939):    at android.os.Handler.handleCallback(Handler.java:587)
07-17 19:12:05.499: W/System.err(30939):    at android.os.Handler.dispatchMessage(Handler.java:92)
07-17 19:12:05.499: W/System.err(30939):    at android.os.Looper.loop(Looper.java:130)
07-17 19:12:05.499: W/System.err(30939):    at android.app.ActivityThread.main(ActivityThread.java:3687)
07-17 19:12:05.499: W/System.err(30939):    at java.lang.reflect.Method.invokeNative(Native Method)
07-17 19:12:05.499: W/System.err(30939):    at java.lang.reflect.Method.invoke(Method.java:507)
07-17 19:12:05.499: W/System.err(30939):    at com.android.internal.os.ZygoteInit$MethodAndArgsCaller.run(ZygoteInit.java:867)
07-17 19:12:05.499: W/System.err(30939):    at com.android.internal.os.ZygoteInit.main(ZygoteInit.java:625)
07-17 19:12:05.499: W/System.err(30939):    at dalvik.system.NativeStart.main(Native Method)
07-17 19:12:07.069: W/System.err(30939): java.lang.NullPointerException
07-17 19:12:07.069: W/System.err(30939):    at android.app.Activity.startActivityForResult(Activity.java:2827)
07-17 19:12:07.069: W/System.err(30939):    at android.app.Activity.startActivity(Activity.java:2933)
07-17 19:12:07.069: W/System.err(30939):    at myapplication.beachparty.utility.MyUtility.addEventToCalendar(MyUtility.java:44)
07-17 19:12:07.069: W/System.err(30939):    at myapplication.beachparty.it.PartyDetails$3.onClick(PartyDetails.java:128)
07-17 19:12:07.069: W/System.err(30939):    at android.view.View.performClick(View.java:2485)
07-17 19:12:07.069: W/System.err(30939):    at android.view.View$PerformClick.run(View.java:9080)
07-17 19:12:07.069: W/System.err(30939):    at android.os.Handler.handleCallback(Handler.java:587)
07-17 19:12:07.069: W/System.err(30939):    at android.os.Handler.dispatchMessage(Handler.java:92)
07-17 19:12:07.069: W/System.err(30939):    at android.os.Looper.loop(Looper.java:130)
07-17 19:12:07.069: W/System.err(30939):    at android.app.ActivityThread.main(ActivityThread.java:3687)
07-17 19:12:07.069: W/System.err(30939):    at java.lang.reflect.Method.invokeNative(Native Method)
07-17 19:12:07.069: W/System.err(30939):    at java.lang.reflect.Method.invoke(Method.java:507)
07-17 19:12:07.069: W/System.err(30939):    at com.android.internal.os.ZygoteInit$MethodAndArgsCaller.run(ZygoteInit.java:867)
07-17 19:12:07.079: W/System.err(30939):    at com.android.internal.os.ZygoteInit.main(ZygoteInit.java:625)
07-17 19:12:07.079: W/System.err(30939):    at dalvik.system.NativeStart.main(Native Method)

dateStart 
```

广告 `dateEnd`是 `Date`指示事件的日期、嘴巴、年份和时间的对象

我也尝试过改变这些行

```
intent.putExtra("beginTime", cal.getTimeInMillis()); 
```

和

```
intent.putExtra("endTime", cal.getTimeInMillis()+60*60*1000); 
```

怎么了？

注意我已经在模拟器和三星 Galaxy 上尝试过代码。并使用 API 级别 10 (GingerBread)

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-07-17T18:00:17.447

您不能从另一个类简单地调用该方法来启动此活动，

线

```
startActivity(intent); 
```

导致*NullPointerException* **因为没有上下文**

你应该通过`Context`方法并写

```
mycontext.startActivity(intent); 
```

这种方式应该有效。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-07-17T16:37:41.437

检查 dateStart 和 dateEnd 对象。它们可能为空。我建议在将它们添加到意图的行中放置一个断点，并检查这些变量是否为空。

# python - TransactionManagementError：尝试测试时，此代码不在事务管理之下

> ID：11526301
> 
> 赞同：1
> 
> 时间：2012-07-17T15:53:20.217
> 
> 标签：python, django

我有一个`model`和一个`manager`as

```
class PlaylistManager(models.Manager):
    def add_playlist(self, name):
        playlist = self.model(name)
        playlist.save()
        return playlist

class Playlist(models.Model):
    name = models.CharField(max_length=30)
    date_created = models.DateTimeField(auto_now_add=True)
    date_modified = models.DateTimeField(auto_now=True)
    deleted = models.BooleanField(default=False)
    objects = PlaylistManager() # is a customer manager

    class Meta:
        db_table = 'playlists' 
```

然后我写一个`test`以确保它有效

```
from django.test import TestCase
from models import Playlist

"""
The idea is that each call to create playlist will make a new playlist

"""

PLAYLIST = 'playlist'
class PlaylistTest(TestCase):
    def insert_playlist(playlist=PLAYLIST):
        Playlist.objects.add_playlist(playlist)

    def test_add_one_video_to_playlist(self):
        self.insert_playlist()
        self.assertEqual(Playlist.objects.count(), 0, msg='playlist count is not 1, it is ' + str(Playlist.objects.count())) 
```

当我从命令行运行此测试时，我看到以下错误

```
$ python manage.py test playlists --settings=myApp.settings.dev
Creating test database for alias 'default'...
EE
======================================================================
ERROR: test_add_one_video_to_playlist (myApp.apps.playlists.tests.PlaylistTest)
----------------------------------------------------------------------
Traceback (most recent call last):
  File "/Users/me/code/p/myApp/myApp/apps/playlists/tests.py", line 15, in test_add_one_video_to_playlist
    self.insert_playlist()
  File "/Users/me/code/p/myApp/myApp/apps/playlists/tests.py", line 12, in insert_playlist
    Playlist.objects.add_playlist(playlist)
  File "/Users/me/code/p/myApp/myApp/apps/playlists/models.py", line 8, in add_playlist
    playlist.save()
  File "/Users/me/code/p/virtualenv/myApp/lib/python2.7/site-packages/django/db/models/base.py", line 463, in save
    self.save_base(using=using, force_insert=force_insert, force_update=force_update)
  File "/Users/me/code/p/virtualenv/myApp/lib/python2.7/site-packages/django/db/models/base.py", line 524, in save_base
    manager.using(using).filter(pk=pk_val).exists())):
  File "/Users/me/code/p/virtualenv/myApp/lib/python2.7/site-packages/django/db/models/query.py", line 621, in filter
    return self._filter_or_exclude(False, *args, **kwargs)
  File "/Users/me/code/p/virtualenv/myApp/lib/python2.7/site-packages/django/db/models/query.py", line 639, in _filter_or_exclude
    clone.query.add_q(Q(*args, **kwargs))
  File "/Users/me/code/p/virtualenv/myApp/lib/python2.7/site-packages/django/db/models/sql/query.py", line 1250, in add_q
    can_reuse=used_aliases, force_having=force_having)
  File "/Users/me/code/p/virtualenv/myApp/lib/python2.7/site-packages/django/db/models/sql/query.py", line 1099, in add_filter
    value = value()
  File "/Users/me/code/p/virtualenv/myApp/lib/python2.7/site-packages/django/test/testcases.py", line 512, in __call__
    result.addError(self, sys.exc_info())
AttributeError: 'NoneType' object has no attribute 'addError'

======================================================================
ERROR: test_add_one_video_to_playlist (myApp.apps.playlists.tests.PlaylistTest)
----------------------------------------------------------------------
Traceback (most recent call last):
  File "/Users/me/code/p/virtualenv/myApp/lib/python2.7/site-packages/django/test/testcases.py", line 508, in __call__
    self._post_teardown()
  File "/Users/me/code/p/virtualenv/myApp/lib/python2.7/site-packages/django/test/testcases.py", line 522, in _post_teardown
    self._fixture_teardown()
  File "/Users/me/code/p/virtualenv/myApp/lib/python2.7/site-packages/django/test/testcases.py", line 847, in _fixture_teardown
    transaction.leave_transaction_management(using=db)
  File "/Users/me/code/p/virtualenv/myApp/lib/python2.7/site-packages/django/db/transaction.py", line 52, in leave_transaction_management
    connection.leave_transaction_management()
  File "/Users/me/code/p/virtualenv/myApp/lib/python2.7/site-packages/django/db/backends/__init__.py", line 115, in leave_transaction_management
    raise TransactionManagementError("This code isn't under transaction "
TransactionManagementError: This code isn't under transaction management

----------------------------------------------------------------------
Ran 1 test in 0.102s

FAILED (errors=2)
Destroying test database for alias 'default'... 
```

我不知道这里发生了什么。我只知道我有一个`Transaction Management Middleware` as

```
MIDDLEWARE_CLASSES = (
    'django.middleware.common.CommonMiddleware',
    'django.contrib.sessions.middleware.SessionMiddleware',
    'django.middleware.csrf.CsrfViewMiddleware',
    'django.contrib.auth.middleware.AuthenticationMiddleware',
    'django.contrib.messages.middleware.MessageMiddleware',
    # -- db transaction management -- #
    'django.middleware.cache.UpdateCacheMiddleware',
    'django.contrib.sessions.middleware.SessionMiddleware',
    'django.middleware.common.CommonMiddleware',
    'django.middleware.transaction.TransactionMiddleware',
    'django.middleware.cache.FetchFromCacheMiddleware',
    # Uncomment the next line for simple clickjacking protection:
    # 'django.middleware.clickjacking.XFrameOptionsMiddleware',
) 
```

我**计划**在我的`views.py`功能中 使用它

```
@transaction.commit_on_success
def addPlaylist(name):
    """
    adds playlist
    """
    pass 
```

但目前没有调用任何视图函数

请帮助我这里发生了什么

谢谢

**更新**

我正在使用 Django 1.4

```
09:28:21  $ python
Python 2.7.1 (r271:86832, Jul 31 2011, 19:30:53) 
[GCC 4.2.1 (Based on Apple Inc. build 5658) (LLVM build 2335.15.00)] on darwin
Type "help", "copyright", "credits" or "license" for more information.
>>> import django
>>> django.VERSION
(1, 4, 0, 'final', 0)
>>> 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-07-18T16:36:51.720

将我更改`PlaylistManager`为关注后，事情开始起作用

```
class PlaylistManager(models.Manager):
    def add_playlist(self, name):
        playlist = Playlist(name=name) # this line changed
        playlist.save()
        return playlist 
```

# uiview - viewWithTag 返回自己

> ID：11526304
> 
> 赞同：3
> 
> 时间：2012-07-17T15:53:44.833
> 
> 标签：uiview, uiscrollview

我对函数 viewWithTag 有一个奇怪的行为。我的故事板看起来像这样：

```
-viewController
--UIScrollView1（应该是一个 UIView 但还没有改变）
---标签为1到11的对象
---带有标签0的其他对象
--UIScrollView2（应该是 UIView 但还没有改变）
---标签为1到11的对象
---带有标签0的其他对象

```

我的代码，我做 [UIScrollView1 wiewWithTag:(1 to 11)] （每次都转换为好的对象，它工作得很好。我对 UIScrollView2 做同样的事情，但每次 UIScrollView2 都返回 viewWithTag，所以我从不匹配任何标记的对象。

仅出于调试目的，我不进行 UIScrollView2 更新并尝试使用其他值 UIScrollView1 进行更新，并且它仅为一个对象返回 UIScrollView1，即 UIImageView（唯一的一个）。但是所有的 UILabel 又可以正常工作了。

有人有一些线索可以帮助我吗？

PS：标签对象被检查了 10 次，我使用如下函数：-(void) updateWithScroll:(UIScrollView*)myScroll 所以它与 1 或 2 相同 :(

在此先感谢，
达米安

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2014-04-07T16:08:46.583

尝试自己浏览子视图，快速枚举`subviews`或使用另一个循环。

我遇到了同样的问题，但我没想到会出现这种行为，但我可以选择不保留根视图标记并将其设置为 -1，这是一个从未使用过的值。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-12-20T09:53:28.777

我假设 UIScrollView2 的标签是 0，所以标签 0 的第一个视图就是你的 UIScrollView2 本身。

您可能应该为 UIScrollView2 的每个子视图提供不同的标签，并且始终与 UIScrollView2 的标签不同。

例如，您可以为滚动视图的标签保留 0，为它的子视图保留 1,2,3...。

# vba - VBA 项目可以从 Office 2007 访问哪些表单控件？

> ID：11526305
> 
> 赞同：5
> 
> 时间：2012-07-17T15:53:47.717
> 
> 标签：vba, ms-office, office-2007, userform

在 VBA 项目中，您可以创建用户窗体并使用工具箱窗口向其添加控件。默认情况下，工具箱窗口包含简单的表单控件，如Label、TextBox、ListBox等。

如果您的机器上安装了其他控件，您可以添加它们：右键单击工具箱上的“附加控件”会显示一整套控件。然而，这并没有说明他们来自哪里。

我很想知道在安装了 Office 2007 的机器上*保证*可以使用哪些控件。它只是标准的，还是某些“附加控件”也保证可用（或者因为它们随 Office 2007 一起提供，或者因为它们存在于 Office 2007 将运行的所有 Windows 版本上）？

例如，我很惊讶即使在 Office 2007 中也没有树视图控件。在我的“附加控件”列表中，我看到了“Microsoft TreeView 控件 v6”，但我不知道我是否可以依赖它存在于所有人我的 Office 2007 用户。

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2012-07-25T14:59:51.143

您看到的控件是[FM20.DLL](http://support.microsoft.com/kb/224305)的一部分；这是 Office 安装的一部分。

通过查看“附加控件”框的“位置”部分，您可以看到它们都是同一个 DLL 的一部分。

![在此处输入图像描述](../Images/eba825248b11c0fd8d5af760be127dcb.png)

AFAIK，这些是大多数 Office 安装保证可用的唯一控件。

话虽如此，让我们看看可以针对您在评论中询问的每个控件专门执行哪些操作：

1.  “网格”功能列表
2.  层次树视图
3.  日历控件

* * *

## 网格

这将取决于您的要求，但您也许可以使用列表框。VBA 中的列表框有一些属性可以使它像网格一样。

例如，假设 Excel 中的工作表如下所示：

```
ID001   Value 1 Description 1
ID002   Value 2 Description 2
ID003   Value 3 Description 3 
```

列表框支持多列，因此您可以通过将列表框属性**ColumnCount**设置为*3*并编写以下代码来显示这些值：

```
 Me.ListBox1.ColumnWidths = "50;100;200"
    Me.ListBox1.RowSource = Sheet1.Range("A1:C3").Address 
```

你会得到这样的东西： ![在此处输入图像描述](../Images/23e0e5323a1d5c617cf4de28bd2fda23.png)

想要隐藏一列？没问题，将*ColumnWidths*属性的宽度更改为零以使要隐藏的列：

```
Me.ListBox1.ColumnWidths = "50;0;200" 'Hide column 2 
```

![在此处输入图像描述](../Images/a86aa4d4261fb902455d106c98c416d1.png)

如果您不能从中选择东西，那么网格有什么用，对吧？

在列表框上，将**ListStyle**属性更改为*frmListStyleOption*，然后将**MultiSelect**更改为*frmMultiSelect*。

这将为您提供一个看起来更像网格的列表框：

![在此处输入图像描述](../Images/a88161e23d2971ea2397cf31fd00eaac.png)

* * *

## 日历

2012 年 8 月 17 日更新：阅读[这篇文章](https://stackoverflow.com/questions/12012206/formatting-mm-dd-yyyy-dates-in-textbox-in-vba)。 [其中](https://stackoverflow.com/users/1140579/siddharth-rout)一位回答的人创建了自己的日历控件。

Office (mscal.ocx) 存在日历控件：

![在此处输入图像描述](../Images/8bdc3cc526c1ec96ac3b763e730439b4.png)

但是，必须满足正确的条件：

1.  必须在客户端计算机上安装 Access
2.  Office 版本不能是[Office 2010](http://en.wikipedia.org/wiki/Microsoft_Office_2010)，因为它已与此版本一起删除（请参阅*从 Microsoft Access 中删除的功能*）

您仍然可以让日历控件与 2010 和/或非 Access Office 安装一起使用，但它需要在客户端计算机上执行额外步骤。

1.  下载[mscal.ocx](http://www.fontstuff.com/mailbag/qvba01.htm)
2.  解压到 windows/system32 目录
3.  注册它

* * *

## 树视图

如果您的客户可以接受安装一些 EXE，您可以让他们安装[Microsoft Visual Basic 6.0 Common Controls](http://www.microsoft.com/en-us/download/details.aspx?id=10019)。这将为您提供 TreeView 控件。

![在此处输入图像描述](../Images/1d91f030948a6d168f88a7cf7b6d71bc.png)

我敢打赌大多数机器（尤其是 Windows XP 上的旧机器）已经安装了这些 OCX；因此可能不需要安装。

最大的问题是您在客户端机器上部署 OCX，从支持的角度来看，这令人沮丧。

# javascript - dojox.form.Uploader 从未收到 onComplete 事件，并且行为异常

> ID：11526310
> 
> 赞同：1
> 
> 时间：2012-07-17T15:54:02.197
> 
> 标签：javascript, dojo

我正在使用 dojo 1.7.2 我一直在尝试让文件上传器与 PHP 中的 REST 服务一起使用。这是我的功能：

```
dojo.connect(dijit.byId("CNCFileUploader"), "onComplete", function(dataArray){
alert("onComplete Fired!");
dojo.forEach(dojo.isArray(dataArray) ? dataArray : [dataArray], function(resp){
    console.log("display:", resp.file, resp.duplicates);

});
}); 
```

这是我的标记：

```
<div data-dojo-type="dijit.Dialog" id="addCncIdsFileDialg" >
  <form method="post" data-dojo-type="dijit.form.Form" id="addCncIdsFileFrm"       enctype="multipart/form-data" action="CartService.php/cart/156568/cncidfiles">
<fieldset>
<legend>Upload File(s) with CNC_IDs</legend>
  <div align="center">
  <input type="file" multiple="true" name="CNCFileUploader" id="CNCFileUploader" data-dojo-type="dojox.form.Uploader" uploadOnSelect="false" /> <br/>
      <button data-dojo-type="dijit.form.Button" type="submit" data-dojo-props="onClick:function(){dijit.byId('addCncIdsFileDialg').hide();}" id="cncIdsFSubmitBttn">OK</button>&nbsp;&nbsp;
      <button data-dojo-type="dijit.form.Button" type="button" data-dojo-props="onClick:function(){dijit.byId('addCncIdsFileDialg').hide();}" id="cncIdsFCancelBttn" >Cancel</button>     
  </div>
       <div id="CNC_IDfiles" dojoType="dojox.form.uploader.FileList" uploaderId="CNCFileUploader"></div>
</fieldset> 
```

我从来没有看到警报。对于 IE9，我看到文件已上传和处理。有趣的是，当我选择一个文件时，日志显示第二个文件的名称为空且错误=4。此外，虽然 onComplete 永远不会发生，但 IE9 会提示我是否要从本地主机保存 cncidfiles。上传只会在第一次工作之后它什么都不做，之后就再也不会了。

当我将多个标志更改为 false 时，上传器完全停止工作。将以下内容写入 JavaScript 控制台：

```
TypeError: Unable to get value of the property 'value': object is null or undefined 
TypeError: Unable to get value of the property 'value': object is null or undefined 
```

第二个问题是，当我使用 Google Chrome 时，每次都会发送文件，但我在服务器上看到的与 dojo 在其 Uploadfile.php 中记录的内容大不相同。

我相信 dojox.form.Uploader 在 1.7.2 中在几个重要方面被严重破坏！

出于沮丧，我尝试使用 dojo.io.iframe.send，但 Chrome 工作正常，IE9 仍然像它想要下载 cncidfiles 一样，也只能在第一次工作。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-07-20T13:33:58.637

啊...可怜的上传器小部件... :)

好吧，看看[http://clubajax.org/the-new-dojo-html5-multi-file-uploader/](http://clubajax.org/the-new-dojo-html5-multi-file-uploader/)看看这里是否有评论（关于 html5 上传者作者的帖子）。

您的问题没有说明您是如何做到这一点的，但是您需要扩展您的上传器插件，`IFrame`/`HTML5`或`Flash`onComplete 不是 API 钩子。换句话说，它没有在 dojox/form/Uploader 中定义。您应该使用嗅探方法，确定它是 IE 还是“其他”。对于 IE 扩展它`Flash`和任何其他，使用 HTML5（它有 IFrame 作为后备）

### 例如;

```
// this must be BeFore dojo.ready (and before parser runs)!
if(dojo.isIE) dojo.require("dojox.form.uploader.Flash");
else dojo.require("dojox.form.uploader.HTML5"); 
```

# django - Django 导入任务

> ID：11526312
> 
> 赞同：0
> 
> 时间：2012-07-17T15:54:20.070
> 
> 标签：django, import, task, djcelery

我有一个 tasks.py 文件，其中定义了 3 个方法。在我的views.py 文件中，我试图导入这些要从视图中调用的方法。

```
from app.tasks import generate_standalone_view, generate_primary_investment_management_view, generate_funds_administration_view 
```

当我调用调用这些任务的视图时，django 返回

```
cannot import name generate_standalone_view 
```

我的项目结构如下

```
app-(dir)
    views-(dir)
        ajax-(dir)
            views.py

    tasks.py 
```

我不确定为什么在导入这些方法时遇到问题。如果有人可以提供一些关于我做错了什么的见解，将不胜感激。

先谢谢了！

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-07-17T23:09:59.200

`from project.app.tasks import ...`

# iphone - 代码符号错误 XCode 4.2

> ID：11526325
> 
> 赞同：0
> 
> 时间：2012-07-17T15:54:57.503
> 
> 标签：iphone, xcode, i386

```
i386: No such file or directory
Command /usr/bin/codesign failed with exit code 1 
```

我收到此错误，无法弄清楚原因。我的有效架构设置为 armv6 armv7 i386。该项目在 iPad 和 iPhone 模拟器上构建并运行良好，但是当我使用设备构建存档/运行时它失败了。我也尝试在多个设备上运行该项目，但在所有设备上都有相同的问题。

任何人都知道为什么我可能会遇到这个问题？谢谢

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-07-17T16:51:19.990

在 Build Settings Architecture 中，在项目以及 targer 和 clean 中进行如下设置并使用设备构建

![目标构建设置](../Images/c5a084b9d9d798c0885e348160625ebd.png)

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-07-26T09:26:15.747

我设法通过将我的架构和有效架构保留到 armv6 armv7 来解决问题，我只需要清除项目和目标的代码签名构建设置下的“其他代码签名标志”。

# iphone - 禁用背景视图的手势识别器

> ID：11526330
> 
> 赞同：1
> 
> 时间：2012-07-17T15:55:19.110
> 
> 标签：iphone, ipad, uiview, uigesturerecognizer

我添加了一些小视图作为单个视图的子视图。其中一些小视图响应双击。

在某些情况下，此视图中的一个可能会被放大，它会覆盖大部分其他视图。

可以通过双击来缩小缩放视图。

问题是用于缩小视图的双击也会被对其做出反应的背景视图接收到。

如何在不逐一禁用每个视图的识别器的情况下避免双击传播到背景视图？

谢谢

# java - 在 XML（WSDL）文件中交换元素属性值？

> ID：11526334
> 
> 赞同：3
> 
> 时间：2012-07-17T15:55:29.243
> 
> 标签：java, xml, xslt, xpath, xquery

考虑一下我有任何标准 WSDL 文件（以 XML 表示）：

```
<wsdl:definitions>

      <wsdl:types>
        ...
      </wsdl:types>

      <wsdl:message>
        ...
      </wsdl:message>

      <wsdl:portType name="countrySoap”&gt;
         <wsdl:operation name="GetCountryByCountryCode">
             <wsdl:documentation>Get country name by country code</wsdl:documentation>
             <wsdl:input message="tns:GetCountryByCountryCodeSoapIn" />
             <wsdl:output message="tns:GetCountryByCountryCodeSoapOut" />
         </wsdl:operation>
        <wsdl:operation name="GetISD">
            <wsdl:documentation>Get International Dialing Code </wsdl:documentation>
            <wsdl:input message="tns:GetISDSoapIn" />
            <wsdl:output message="tns:GetISDSoapOut" />
        </wsdl:operation>
        ...
      <wsdl:portType name="countrySoap”&gt;

  ....
</wsdl:definitions> 
```

我想做的是有一种简单/有效的方法来交换每条消息的输入和输出消息。

例如，我想要：

```
 <wsdl:operation name="GetCountryByCountryCode">
             <wsdl:documentation>Get country name by country code</wsdl:documentation>
             <wsdl:input message="tns:GetCountryByCountryCodeSoapOut" />
             <wsdl:output message="tns:GetCountryByCountryCodeSoapIn" />
         </wsdl:operation> 
```

我一直在使用的示例 wsdl 文件可以在这里找到： [http ://www.webservicex.net/country.asmx?WSDL](http://www.webservicex.net/country.asmx?WSDL)

**进一步说明：**

*   我可能正在寻找基于 XSLT 的解决方案，因为在我看来这似乎更有效。例如，我当前的解决方案是基于 Java 的，但它似乎没有我想要的那么高效。
*   如果解决方案能够忽略任何命名空间，那就太好了，例如：一些 wsdl 文件显示为：`wsdl:definitions`, `wsdl:portType`, `wsdl:operation`- 而其他可能只是`definitions`, `portType`,`operation`等。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-07-17T16:44:36.120

您无需担心命名空间前缀，只要命名空间 uri 匹配，这并不重要。

XSLT 和 XQuery 都可以为您提供紧凑的解决方案。不过，在 XSLT 中调整输出缩进可能更容易一些。

这里有一个 XSLT 2.0 解决方案：

```
<xsl:stylesheet version="2.0"
    xmlns:xsl="http://www.w3.org/1999/XSL/Transform"
    xmlns:wsdl="http://schemas.xmlsoap.org/wsdl/">

    <xsl:template match="@*|node()">
        <xsl:copy>
            <xsl:apply-templates select="@*"/>
            <xsl:apply-templates select="node()"/>
        </xsl:copy>
    </xsl:template>

    <xsl:template match="wsdl:input">
        <xsl:copy>
            <xsl:apply-templates select="../wsdl:output/(@*|node())"/>
        </xsl:copy>
    </xsl:template>

    <xsl:template match="wsdl:output">
        <xsl:copy>
            <xsl:apply-templates select="../wsdl:input/(@*|node())"/>
        </xsl:copy>
    </xsl:template>

</xsl:stylesheet> 
```

这里有一个 XQuery 1.0 解决方案：

```
xquery version "1.0";

declare namespace wsdl = "http://schemas.xmlsoap.org/wsdl/";

declare function local:recurse-nodes($nodes) {
    for $node in $nodes
    return typeswitch ($node)
        case $node as element (wsdl:input) return
            element { node-name($node) } { $node/../wsdl:output/local:recurse-nodes(@*|node()) }
        case $node as element (wsdl:output) return
            element { node-name($node) } { $node/../wsdl:input/local:recurse-nodes(@*|node()) }
        case $node as element () return
            element { node-name($node) } { $node/local:recurse-nodes(@*|node()) }
        case $node as document-node () return
            document { local:recurse-nodes($node/node()) }
        default return $node
};

local:recurse-nodes(doc("country.xml")) 
```

！

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-07-18T02:36:39.177

**此 XSLT（1.0 和 2.0）转换**：

```
<xsl:stylesheet version="1.0" xmlns:xsl="http://www.w3.org/1999/XSL/Transform"
 xmlns:x="some:wsdl">
 <xsl:output omit-xml-declaration="yes" indent="yes"/>
 <xsl:strip-space elements="*"/>

 <xsl:template match="node()|@*">
  <xsl:copy>
   <xsl:apply-templates select="node()|@*"/>
  </xsl:copy>
 </xsl:template>

 <xsl:template match="x:input/@message">
  <xsl:attribute name="message">
    <xsl:value-of select="../../x:output/@message"/>
  </xsl:attribute>
 </xsl:template>

 <xsl:template match="x:output/@message">
  <xsl:attribute name="message">
    <xsl:value-of select="../../x:input/@message"/>
  </xsl:attribute>
 </xsl:template>
</xsl:stylesheet> 
```

**当应用于以下 XML 文档时**（从提供的、严重格式错误的文档中获得）：

```
<wsdl:definitions xmlns:wsdl="some:wsdl">

          <wsdl:types>
            ...
          </wsdl:types>

          <wsdl:message>
            ...
          </wsdl:message>

          <wsdl:portType name="countrySoap">
             <wsdl:operation name="GetCountryByCountryCode">
                 <wsdl:documentation>Get country name by country code</wsdl:documentation>
                 <wsdl:input message="tns:GetCountryByCountryCodeSoapIn" />
                 <wsdl:output message="tns:GetCountryByCountryCodeSoapOut" />
             </wsdl:operation>
            <wsdl:operation name="GetISD">
                <wsdl:documentation>Get International Dialing Code </wsdl:documentation>
                <wsdl:input message="tns:GetISDSoapIn" />
                <wsdl:output message="tns:GetISDSoapOut" />
            </wsdl:operation>
            ...
          </wsdl:portType>

      ....
</wsdl:definitions> 
```

**产生想要的正确结果**：

```
<wsdl:definitions xmlns:wsdl="some:wsdl">
   <wsdl:types>
            ...
          </wsdl:types>
   <wsdl:message>
            ...
          </wsdl:message>
   <wsdl:portType name="countrySoap">
      <wsdl:operation name="GetCountryByCountryCode">
         <wsdl:documentation>Get country name by country code</wsdl:documentation>
         <wsdl:input message="tns:GetCountryByCountryCodeSoapOut"/>
         <wsdl:output message="tns:GetCountryByCountryCodeSoapIn"/>
      </wsdl:operation>
      <wsdl:operation name="GetISD">
         <wsdl:documentation>Get International Dialing Code </wsdl:documentation>
         <wsdl:input message="tns:GetISDSoapOut"/>
         <wsdl:output message="tns:GetISDSoapIn"/>
      </wsdl:operation>
            ...
          </wsdl:portType>

      ....
</wsdl:definitions> 
```

# php - 在 MySQL 中将 ISO-8859-1 数据转换为 UTF-8 的建议

> ID：11526337
> 
> 赞同：1
> 
> 时间：2012-07-17T15:55:35.460
> 
> 标签：php, mysql, unicode, utf-8, character-encoding

我们有一个非常大的 InnoDB MySQL 5.1 数据库，所有表都使用`latin1_swedish_ci`排序规则。我们想要将所有*应该*在 ISO-8859-1 中的数据转换为 UTF-8。如果有的话，更改排序规则的效果如何`utf8_general_ci`？

我们最好编写一个脚本来转换数据并插入到一个新表中吗？显然，我们的目标是最大程度地减少重新编码时丢失任何数据的风险。

**编辑：**我们确实有重音字符，£符号等。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-07-17T16:03:06.113

如果数据当前仅使用拉丁字符，而您只是想将字符集和排序规则更改为 UTF8 以启用将来添加 UTF-8 数据，那么只需更改字符集和排序规则应该没有问题。当然，我会先在表格的副本中执行此操作。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-07-17T16:01:22.740

大约一周前，我不得不做同样的任务（问题`ö, ä, å`）

1.  创建了一个`dump.sql`.
2.  搜索并全部替换`CHARSET=latin1` **为** `CHARSET=utf8`（在 中`dump.sql`）。
3.  搜索并全部替换`COLLATE=latin1_swedish_ci` **为** `COLLATE=utf8_unicode_ci`（在 中`dump.sql`）。
4.  使用排序规则创建了一个新数据库`utf8_unicode_ci`。
5.  导入了`dump.sql`.
6.  改变了数据库`charset`的`alter database MY_DB charset=utf8;`

它工作得很好

注意：在迈克布兰特的评论之后，我认为最好对您特别想要的字段进行手动搜索和替换。或者您可以简单地使用`ALTER`每个字段而不需要`dump.sql`. 在我的情况下并没有太大变化，因为我的大部分字段都需要进行 utf 编码

# url - 检测客户输入的哪个地址登陆网站

> ID：11526342
> 
> 赞同：1
> 
> 时间：2012-07-17T15:55:54.257
> 
> 标签：url, redirect, dns

既然可以将不同的域名链接到同一个webserver上，那么是否可以检测出客户端访问网站时输入了哪个地址【可以是ip地址】，那么是否可以根据这个值来实现条件呢？

我对多个域名可能完全错误。我对dns和域了解不多。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-07-20T01:22:35.333

您可以在 HTTP`Host:`标头中看到它。例如，如果您正在运行一个 PHP 脚本，您可以在`$_SERVER['HTTP_HOST']`.

# apache - 需要帮助将此 htaccess 重写规则转换为 Nginx

> ID：11526346
> 
> 赞同：0
> 
> 时间：2012-07-17T15:56:13.440
> 
> 标签：apache, .htaccess, cakephp, mod-rewrite, nginx

嗨 - 我已经为此苦苦挣扎了好几天。这看起来很简单，但我就是做不到。

我有一个用 CakePHP 开发的网站。有一个响应的脚本`/css/profiles/g/whatever.css`（“whatever”是什么，它实际上是一个传递给动作的参数），它回显生成的 CSS 并将其保存到`/css/profiles/whatever.css`.

我在 Apache 中有一条规则，它接受请求`/css/profiles/whatever.css`，如果它不存在，则重写请求`/css/profiles/g/whatever.css`而不重定向，因此客户端永远不会注意到它是由脚本响应并且文件不存在。

这就是我在 Apache 中所拥有的：

```
# Profile CSS rules
RewriteCond %{REQUEST_URI} ^/css/profiles/
RewriteCond %{REQUEST_URI} !/css/profiles/g/
RewriteCond %{REQUEST_FILENAME} !-f
RewriteRule ^css/profiles/(.*)$ /css/profiles/g/$1 [L]

# CakePHP's default rules
RewriteCond %{REQUEST_FILENAME} !-d
RewriteCond %{REQUEST_FILENAME} !-f
RewriteRule ^(.*)$ index.php/$1 [QSA,L] 
```

现在我将站点移动到带有 Nginx 的服务器上，到目前为止，我得到了这个：

```
# Profile CSS rules
location ~ ^/css/profiles/(?!g/)(.*)$ {
    if (!-f $request_filename) {
      rewrite ^/css/profiles/(.*)$ /css/profiles/g/$1 last;
      break;
    } 
```

 }

```
# CakePHP's default rules
location / { 
```

    try_files $uri $uri/ /index.php?$uri&$args; }

条件似乎有效，因为如果我去`/css/profiles/whatever.css`打印 PHP 的`$_SERVER`变量，它会给我

```
[QUERY_STRING] => /css/profiles/g/whatever.css& 
```

注意`&`. 这意味着它到达了该`try_files`部分并将 . 添加`$uri`到查询字符串中，并且它具有正确的`$uri`.

~~但...~~

 ~~```
[REQUEST_URI] => /css/profiles/whatever.css 
```~~ 

~~这就是故障。似乎它并没有真正改变`$request_uri`CakePHP 需要控制什么控制器参与什么。~~

**更新**：`REQUEST_URI`值是正确的......这里的问题是Cake 寻找不同服务器变量的值来决定哪个控制器将响应。按此顺序：`$_SERVER['PATH_INFO']`, , and和 finally`$_SERVER['REQUEST_URI']`的组合。这就是它失败的原因。`$_SERVER['PHP_SELF']``$_SERVER['SCRIPT_NAME']``$_SERVER['HTTP_X_REWRITE_URL']`

任何帮助将不胜感激。

谢谢。

**注意**：我昨天[在 Serverfult 上发布了这个问题，](https://serverfault.com/questions/408324/need-help-translating-this-htaccess-rewrite-rule-to-nginx)因为我认为它更适合那里但没有得到答案，这就是我在这里发布它的原因。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-07-18T01:54:37.653

所以我终于让它工作了：

```
location ~ ^/css/profiles/(?!g/)(.*)$ {
  set $new_uri /css/profiles/g/$1;
  if (!-f $request_filename) {
    rewrite ^/css/profiles/(.*)$ /css/profiles/g/$1 last;
  }
} 
```

...最后：

```
location ~ \.php$ {
  fastcgi_split_path_info ^(.+\.php)(/.+)$;
  fastcgi_pass 127.0.0.1:9000;
  fastcgi_index index.php;
  include fastcgi_params;

  ... some other stuff were here related to fastcgi
  fastcgi_param PATH_INFO $new_uri; # <--- I added this
} 
```

# javascript - 从 .ascx 文件调用 Javascript 函数时出错

> ID：11526347
> 
> 赞同：1
> 
> 时间：2012-07-17T15:56:19.480
> 
> 标签：javascript, asp.net

我将 VS 2003 应用程序迁移到 VS 2010。该应用程序具有在 default.aspx 中引用的 side_menu.ascx。在 side_menu.ascx 中，调用了一个存在于 side_menu.js 中的 javascript 函数**菜单。**

但是，当调用功能**菜单**时，它会在运行时出错 - **'找不到功能菜单'**这在 VS 2003 中工作正常

这是我收到此错误的地方-此代码位于 side_menu.ascx

```
 new menu (SIDE_MENU_ITEMS, SIDE_MENU_POS, SIDE_MENU_STYLES) 
```

这是 default.aspx 中的代码

```
 <!-- Side Menu -->
     <td valign="top" class="page_side_menu">
        <mycontrols:sidemenu id="SideMenu1" runat="server"/>
        </td> 
```

这是 side_menu.ascx 中的代码

```
<%@ Control Language="vb" AutoEventWireup="false" Codebehind="side_menu.ascx.vb" Inherits="TOrders.UI.Controls.SideMenu" TargetSchema="http://schemas.microsoft.com/intellisense/ie5" %>
<table cellPadding="0" width="100%">
<tr>
    <td vAlign="top" align="left" width="100%">
        <table cellSpacing="10" cellPadding="0" width="100%">
            <tr>
                <td align="left">
                    <asp:Literal ID="litError" Runat="server" Text="<font color=#E0E0E0 size=1>*&nbsp;</font>" Visible="False"></asp:Literal><asp:label id="lblJump" runat="server" ForeColor="#E0E0E0" Font-Size="XX-Small">Jump to Telex/Order:</asp:label>
                    <br>
                    <asp:textbox id="txtJumpTo" runat="server" Width="125px" CssClass="textbox"></asp:textbox>&nbsp;<input type="button" value="Go" runat="server" id="btnGo" class="TabOut-Button">
                </td>
            </tr>
        </table>
    </td>
</tr>
</table>
<script language="JavaScript" src="~/library/scripts/side_menu.js"     type="text/javascript"></script>
<script language="JavaScript" src="~/library/scripts/side_menu_items.js" type="text/javascript"></script>
<script language="JavaScript" src="~/library/scripts/side_menu_tpl.js" type="text/javascript"></script>
<script language="JavaScript" type="text/javascript">
<!--
new menu (SIDE_MENU_ITEMS, SIDE_MENU_POS, SIDE_MENU_STYLES);
// -->
</script> 
```

这是javascript函数side_menu.js

```
var menus = [];

function menu (item_struct, pos, styles) {
// browser check
this.item_struct = item_struct;
this.pos = pos;
this.styles = styles;
this.id = menus.length;
this.items = [];
this.children = [];

this.add_item = menu_add_item;
this.hide = menu_hide;

this.onclick = menu_onclick;
this.onmouseout = menu_onmouseout;
this.onmouseover = menu_onmouseover;
this.onmousedown = menu_onmousedown;

var i;
for (i = 0; i < this.item_struct.length; i++)
    new menu_item(i, this, this);
for (i = 0; i < this.children.length; i++)
    this.children[i].visibility(true);
menus[this.id] = this;
} 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-07-17T16:16:15.750

尝试从 javascript src 路径中删除波浪号 (~) 并确保路径实际上是正确的

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-07-17T16:24:37.613

对我来说是一样的，所以解决方案是：更改相对路径并让它们带走根〜/

**前**

```
<%@ Control Language="VB" AutoEventWireup="false" CodeFile="wucDTmisc1.ascx.vb"      Inherits="wucDTmisc1" %>
<%@ Register Src="wucBeneficiarios.ascx" TagName="wucBeneficiarios" TagPrefix="uc1" %>
<%@ Register Assembly="Coolite.Ext.Web" Namespace="Coolite.Ext.Web" TagPrefix="ext" %>
<%@ Register Src="Controles/wucMoneda.ascx" TagName="wucMoneda" TagPrefix="uc1" %>
<link href="~/css/content.css" rel="stylesheet" type="text/css" />
<link href="~/css/Blue.css" rel="stylesheet" type="text/css" />
<script src="~/js/siscli.js" type="text/javascript"></script>
<script src="~/js/json2.js" type="text/javascript"></script>
<script src="~/js/date.js" type="text/javascript"></script> 
```

**后**

```
<%@ Control Language="VB" AutoEventWireup="false" CodeFile="wucDTmisc1.ascx.vb"      Inherits="wucDTmisc1" %>
<%@ Register Src="wucBeneficiarios.ascx" TagName="wucBeneficiarios" TagPrefix="uc1" %>
<%@ Register Assembly="Coolite.Ext.Web" Namespace="Coolite.Ext.Web" TagPrefix="ext" %>
<%@ Register Src="Controles/wucMoneda.ascx" TagName="wucMoneda" TagPrefix="uc1" %>
<link href="/css/content.css" rel="stylesheet" type="text/css" />
<link href="/css/Blue.css" rel="stylesheet" type="text/css" />
<script src="/js/siscli.js" type="text/javascript"></script>
<script src="/js/json2.js" type="text/javascript"></script>
<script src="/js/date.js" type="text/javascript"></script> 
```

同样在寻找解决方案时，我意识到在控件中最好保留 JS 代码。

它对我有用，我希望你也一样。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-07-17T17:32:10.793

你需要的可能是[这里](https://stackoverflow.com/a/10046033/144701)解释的东西。您必须将“~”替换为跟随用户控件的东西，即他现在所在的位置，而不是他在应用程序中实际登陆的位置。

```
<script language="javascript" type="text/javascript" src="<%=Page.ResolveUrl("~/JS/VerticalMenu.js")%>"></script>
<script language="javascript" type="text/javascript" src="<%=Page.ResolveUrl("~/library/scripts/side_menu_items.js")%>"></script>
<script language="javascript" type="text/javascript" src="<%=Page.ResolveUrl("~/library/scripts/side_menu_tpl.js")%>"></script> 
```

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2012-07-19T13:54:37.630

**解决**

我终于找到了解决问题的方法。它带有**脚本**标签

我把它改写为

```
<script src="../library/scripts/side_menu.js" type="text/javascript" /> 
```

代替

```
<script src="../library/scripts/side_menu.js" type="text/javascript"></script> 
```

# sql-server-2008 - Crystal Report 数据字段类型与数据集数据类型不同

> ID：11526348
> 
> 赞同：0
> 
> 时间：2012-07-17T15:56:20.637
> 
> 标签：sql-server-2008, stored-procedures, types, crystal-reports, dataset

我有一个绑定到数据集的水晶报表，该数据集是使用存储过程填充的。我的一些数字列神秘地变成了水晶报表中的字符串。我检查了数据集中的列，它们都是 system.decimal。

因为我必须在报告中进行计算和分组，所以我有公式可以将所有字符串转换为双精度。它有效，但我已经有一排公式，它会变得更长。

我不知道是什么问题，如果您怀疑有什么可能导致此问题，请帮忙。

谢谢你。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-07-17T16:27:42.727

确保您的数据类型`decimal`在您的存储过程中被强制转换。我已经看到 Crystal Reports 提出了自己的数据类型，如果它无法弄清楚它拥有自己的数据类型。

# c# - 如何调用具有数据绑定的通用方法？

> ID：11526349
> 
> 赞同：1
> 
> 时间：2012-07-17T15:56:22.370
> 
> 标签：c#, .net, data-binding, mvvm

我想了解当我们使用许多属性时如何正确使用 MVVM 和数据绑定。

```
<Window x:Class="WpfApplication1.MainWindow"
    xmlns="http://schemas.microsoft.com/winfx/2006/xaml/presentation"
    xmlns:x="http://schemas.microsoft.com/winfx/2006/xaml"
    Title="MainWindow" Height="350" Width="525">
<Grid>
    <TextBox Height="23" HorizontalAlignment="Left" Margin="12,12,0,0" Name="textBox1" VerticalAlignment="Top" Width="463" Text="{Binding OriginalText, UpdateSourceTrigger=PropertyChanged}" />
    <Label Height="28" HorizontalAlignment="Left" Margin="12,242,0,0" Name="label1" VerticalAlignment="Top" Width="463" Content="{Binding ModifiedText}"/>
    <CheckBox Content="Upper" Height="16" HorizontalAlignment="Left" Margin="12,41,0,0" Name="checkBox1" VerticalAlignment="Top" />
    <CheckBox Content="Underline" Height="16" HorizontalAlignment="Left" Margin="12,63,0,0" Name="checkBox2" VerticalAlignment="Top" />
    <CheckBox Content="Bold" Height="16" HorizontalAlignment="Left" Margin="12,85,0,0" Name="checkBox3" VerticalAlignment="Top" />
    <CheckBox Content="Shadow" Height="16" HorizontalAlignment="Left" Margin="12,107,0,0" Name="checkBox4" VerticalAlignment="Top" />
    <CheckBox Content="Red" Height="16" HorizontalAlignment="Left" Margin="12,129,0,0" Name="checkBox5" VerticalAlignment="Top" />
    <CheckBox Content="Scary" Height="16" HorizontalAlignment="Left" Margin="12,151,0,0" Name="checkBox6" VerticalAlignment="Top" />
    <CheckBox Content="Remove first letter" Height="16" HorizontalAlignment="Left" Margin="12,173,0,0" Name="checkBox7" VerticalAlignment="Top" />
    <CheckBox Content="Remove last letter" Height="16" HorizontalAlignment="Left" Margin="12,195,0,0" Name="checkBox8" VerticalAlignment="Top" />
</Grid> 
```

我有一个 OriginalText 文本框和一个 ModifiedText 标签。当我选中一个框时，我想直接应用修改而无需单击按钮。我该怎么做？

在我的 ViewModel 中，我创建了绑定到 XAML CheckBox 的所有属性。

```
 private string _originalText = string.Empty;
    public string OriginalText
    {
        get { return _originalText; }
        set
        {
            _originalText = value;
            NotifyPropertyChanged("OriginalText");
        }
    }

    private string _modifiedText;
    public string ModifiedText
    {
        get { return _originalText; }
        set
        {
            _originalText = value;
            NotifyPropertyChanged("ModifiedText");
        }
    }

    private bool upper;
    public bool Upper
    {
        get { return upper; }
        set
        {
            upper = value;
            NotifyPropertyChanged("Upper");
            // Should I notify something else here or call a refresh method?
        }
    }

    private bool removeFirstLetter;
    public bool RemoveFirstLetter
    {
        get { return removeFirstLetter; }
        set
        {
            removeFirstLetter = value;
            NotifyPropertyChanged("RemoveFirstLetter");
            // Should I notify something else here or call a refresh method?
        }
    }

    // ... 
```

然后我此时在同一个 ViewModel 类中创建了一个 Work 方法。稍后我会将此方法应用到业务中。

```
private void Work()
{ 
    string result = _originalText;
    if (Upper)
        result = result.ToUpper();
    if (removeFirstLetter)
        result = result.Substring(1, result.Length);
    // if ...
    ModifiedText = result; 
} 
```

我的问题是我应该在什么时候、在哪里调用工作方法？我应该在每个 setter 或 getter 中调用它吗？我不喜欢这个主意。我做错了什么...

谢谢你。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-07-18T13:54:56.113

在您的特定情况下，您应该使用 INotifyPropertyChanged 接口创建一个布尔属性。现在将此属性绑定到您的“IsChecked”复选框属性。通过在 setter 中调用 Work() 方法，每次“勾选”复选框时，setter 都会触发。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-07-17T16:11:38.950

您的问题的答案很简单：使用`Commands`.

命令是 MVVM 实现与 ViewModel 中方法的绑定的方式。命令的实现遵循一个非常标准的模式。您会在 Internet 上找到大量信息，这里只是一个简短的草图：

在 ViewModel 中实现的命令必须是类型的`ICommand`，并且每个命令都必须与代码中的方法一起出现，一个负责执行实际方法，另一个负责检查当前是否可以执行。

这些方法必须`CanExecute`分别命名`Execute`。通常情况下，通过一个名为的小帮助类来促进多个命令的使用，该类`DelegateCommand`为前面提到的方法提供委托。

照原样使用此类，无需任何修改：

```
public class DelegateCommand<T> : ICommand {

    private Predicate<T> canExecute;
    private Action<T> execute;

    public event EventHandler CanExecuteChanged;

    public DelegateCommand (Predicate<T> canExecute, Action<T> execute) {

        this.canExecute = canExecute;
        this.execute = execute;
    }

    public bool CanExecute (object param) {

        return canExecute((T)param);
    }

    public void Execute (object param) {

        execute((T)param);
    }

    public void CanExecuteChangedRaised () {

        CanExecuteChanged(this, new EventArgs());
    }
} 
```

那么你的 Command 声明是 type`DelegateCommand`而不是 type `ICommand`。看下面的例子来说明，你会明白的：

假设您的 ViewModel 中有一个方法 foo() ，您希望通过单击按钮来调用它：

```
class ViewModel {

    // ...

    public DelegateCommand<object> FooCommand { get; set; }

    public ViewModel () {

        FooCommand = new DelegateCommand<object>(CanExecuteFooCommand, ExecuteFooCommand);
    }

    public bool CanExecuteFooCommand (object param) {

        return true;
    }

    public void ExecuteFooCommand (object param) {

        foo();
    }

    // ...
} 
```

假设您已`DataContext`通过其`DataContext`属性将 ViewModel 设置为控件，那么剩下要做的就是将 绑定`FooCommand`到您的按钮，如下所示：

就是这样！

**附录（参考评论）：**

为了在不实际点击按钮的情况下执行某些操作，您只需使用 ViewModel 跟踪 UI 中的任何更改并做出相应反应 - 这就是 MVVM 的意义所在：跟踪来自 UI 的数据修改或处理它们并填充它们回到用户界面。

要对 TextBox 文本更改做出反应，请在 ViewModel 中创建相应的字符串属性，并跟踪来自视图的新离子值是否与当前文本框文本不同：

```
private string _text;

public string Text {
   get { return _text; }
   set {          
       // the text in the TextBox is about to change.
       if (!_text.Equals(value)) 
       {
        doSomething();
       }

       _text = value;
       FirePropertyChanged("Text");
   }
} 
```

为了对 CheckBox 执行相同的操作，您可以如上所述应用 ICommand，因为 CheckBox 是从 Button 派生的，因此提供了 Command 属性。

# javascript - JavaScript“不是函数”问题

> ID：11526350
> 
> 赞同：2
> 
> 时间：2012-07-17T15:56:25.380
> 
> 标签：javascript, jquery, function

我要做的是断开选择，并取消一些热键（例如`Ctrl`+ `a`，`Ctrl`+`c`和`Ctrl`+ `s`）

我的代码看起来像这样。

```
(function($){

    $.fn.ctrl = function(key, callback) {
        if(typeof key != 'object') key = [key];
        callback = callback || function(){
            return false;
        }
        return $(this).keydown(function(e) {
            var ret = true;
            $.each(key,function(i,k){
                if(e.keyCode == k.toUpperCase().charCodeAt(0) && e.ctrlKey) {
                    ret = callback(e);
                }
            });
            return ret;
        });
    };

    $.fn.disableSelection = function() {
        $(window).ctrl(['a','s','c']);
        return this.each(function() {           
            $(this).attr('unselectable', 'on')
            .css({
                '-moz-user-select':'none',
                '-o-user-select':'none',
                '-khtml-user-select':'none',
                '-webkit-user-select':'none',
                '-ms-user-select':'none',
                'user-select':'none'
            })
            .each(function() {
                $(this).attr('unselectable','on')
                .bind('selectstart',function(){
                    return false;
                });
            });
        });
    }
});
$(document).ready(function() {
    $(':not(input,select,textarea)').disableSelection(); <== ERROOR
    $("#navigation").treeview({
        persist: "location",
        collapsed: true,
        unique: true
    });
}); 
```

问题是，当我在 Firefox 上打开页面时，在 firebug 上收到以下错误消息

```
$(":not(input,select,textarea)").disableSelection is not a function 
```

我错过了什么？有什么建议么？提前谢谢

* * *

## 回答 #1

> 赞同：11
> 
> 时间：2012-07-17T15:58:14.943

您忘记将 jQuery 传递给您的函数（为了执行它！）：

```
(function($){

    $.fn.ctrl = function(key, callback) { ... }

    $.fn.disableSelection = function() { ... }

})(jQuery); // <--- you forgot this! 
```

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2012-07-17T15:58:40.637

```
(function($){
   ...
}); 
```

很好，从未执行过[IEFE 闭包](http://benalman.com/news/2010/11/immediately-invoked-function-expression/)（应该称为 NEFE :-)）。通过附加括号来调用它，并将它们之间的参数（例如`...(jQuery)`）传递给[函数](https://developer.mozilla.org/en/JavaScript/Reference/Functions_and_function_scope)。或者离开整个函数，在你的情况下你根本不需要闭包。

顺便说一句，您永远不应该尝试使您的页面无法使用 - 用户会逃避它。并且不要忘记尝试使内容不可复制永远不会阻止内容被复制。

# c# - 更改自定义光标的热点

> ID：11526351
> 
> 赞同：0
> 
> 时间：2012-07-17T15:56:27.743
> 
> 标签：c#, winforms, cursor

我正在使用以这种方式加载的自定义光标：

```
Bitmap bit = new Bitmap(path);
cur = new Cursor(bit.GetHicon());
Cursor.current = cur; 
```

我的位图是 44x58 png，鼠标热点不是我想要的位置。我寻找了一个属性来更改鼠标热点，但我发现的唯一一个是只读的（`cur.Hotspot`）。我需要做什么来改变它的坐标？

谢谢

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-07-17T16:01:51.290

在 Visual Studio 中，在图像编辑器中打开光标文件或资源，然后从工具栏中选择热点工具。然后单击新热点并保存文件。AFAIK 无法通过 .NET API 设置热点，但有通过 WIN32 API 的选项，如其他评论中的链接所示。

* * *

## 回答 #2

> 赞同：-2
> 
> 时间：2012-07-17T20:49:51.187

最后，我只是决定隐藏鼠标光标并在热点坐标处绘制位图。建议的解决方案太复杂了。

```
cursor = new Bitmap(path); 
```

在 MouseMove 事件中：

```
ex = e.X - offx //the x offset of the hotspot
ex = e.X - offy //the y offset of the hotspot 
```

然后将 (ex,ey) 坐标处的位图绘制为最后一个绘图元素。

# javascript - 上传图像并在浏览器窗口中显示

> ID：11526362
> 
> 赞同：0
> 
> 时间：2012-07-17T15:56:56.263
> 
> 标签：javascript, html, file-upload

我已经实现了一个代码，其中图像被上传到浏览器并显示为缩略图。然后它也可以被拖到画布区域中。但是当我在 chrome 中运行它时，它没有打开窗口来上传文件。首先上传图像，然后创建其缩略图。但它不适用于 chrome。

这是我的代码，

```
<!DOCTYPE HTML>
<html>
<head>
<meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
<title>Drag Demo</title>
<link href="copy.css" rel="stylesheet" type="text/css" />
</head>
<body>
<div class="container">
<div style = "border:2px  solid black;">
<canvas id = "canvas" style = "position:relative;width:300px;height:300px;top:0px;left:500px; border:2px  solid black;" ondrop="dropIt(event);" ondragover="event.preventDefault();"> </canvas>    
</div>
<div>
    <input type="file" id="fileElem" accept="image/*" style="display:none" >
    <div id="fileSelect" class="drop-area">Select some files</div>
</div>
    <div id="thumbnail"></div>
</div>

<script type="text/javascript">
function dragIt(event) {
event.dataTransfer.setData("Text", event.target.id)
};

function dropIt(event) {
  var theData = event.dataTransfer.getData("Text");
  dt = document.getElementById(theData);
  event.preventDefault();
  var c = document.getElementById("canvas");
  var ctx = c.getContext('2d');
  ctx.drawImage(dt, 100, 0,dt.width,dt.height);      
};

var count = 0;
var fileSelect = document.getElementById("fileSelect"),
fileElem = document.getElementById("fileElem");

fileElem.addEventListener("click",function(e){
  var files = this.files
  handleFiles(files)
},false)  

fileSelect.addEventListener("click", function (e) {
    fileElem.click();
  e.preventDefault(); 
}, false);

function handleFiles(files) {  
  for (var i = 0; i < files.length; i++) {  
    var file = files[i];  
    var imageType = /image.*/; 

    if(!file.type.match(imageType)){
      console.log("Not an Image");
      continue;
    }
    var image = document.createElement("img");
    var thumbnail = document.getElementById("thumbnail");
    image.file = file;
    thumbnail.appendChild(image)
    var reader = new FileReader()
    reader.onload = (function(aImg){
      return function(e){
        aImg.src = e.target.result;
      };
    }(image))
    image.id = count;
    count++;
    image.draggable = true;
    image.ondragstart = dragIt;
    var ret = reader.readAsDataURL(file); 
  }
}

</script>

</body>
</html> 
```

* * *

## 回答 #1

> 赞同：-1
> 
> 时间：2012-09-10T15:06:13.037

只需在服务器上运行代码即可！

# jquery - 在 phonegap 上使用 jquery 刷新下拉菜单。“不是 jQuery 手机”

> ID：11526366
> 
> 赞同：0
> 
> 时间：2012-07-17T15:57:21.463
> 
> 标签：jquery, jquery-mobile, cordova, drop-down-menu

我想更改下拉列表中代码选择的选项

```
$('#ddd option[value="1"]').prop('selected', true); 
```

但它不适用于带有 jquery 的 mobile phonegap 应用程序。
我想我需要刷新#ddd 控件，但我无法使用 jquery 成功。
我尝试将 jquery 和 jquery mobile 一起使用，但我无法解决。
如何使用 jquery（不是 jquery mobile）刷新#ddd 控件？
谢谢...

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-07-17T16:01:17.567

你可以试试这个：

```
$('#ddd').val('1'); 
```

上面将设置选定的值`<option value="1"></option>`。

您还可以触发更改事件：

```
$('#ddd').val('1').change(); 
```

# c# - 在 WPF DataGridView 中触发“OnCellSeperatorDoubleClick”？

> ID：11526367
> 
> 赞同：0
> 
> 时间：2012-07-17T15:57:27.507
> 
> 标签：c#, wpf, datagridview, resize

我只是想知道是否有一种方法可以触发当您双击 DGV 中两列之间的线时发生的相同事件。我希望我的 2 列在设置所有列的宽度后，自动调整到其文本的宽度以占用额外的空间。

那可能吗？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-07-17T23:34:05.597

如果您指的是 .NET 4.0 中的 WPF“DataGrid”，快速查看 ILSpy 中的 PresentationFramework，看起来所有双击调整大小的抓手所做的都是将列的宽度设置为 DataGridLength.Auto。

因此，您可以执行以下操作以获得与双击相同的结果：

```
someGrid.Columns[0].Width = DataGridLength.Auto; 
```

如果您希望该列填充可用空间（使用 wpf 星形加权），那么您可以使用以下内容：

```
someGrid.Columns[0].Width = new DataGridLength(1, DataGridLengthUnitType.Star); 
```

# mysql - 使用 C 连接器执行选择和多个插入作为事务？

> ID：11526369
> 
> 赞同：3
> 
> 时间：2012-07-17T15:57:28.557
> 
> 标签：mysql, c, transactions

我正在使用 MySQL。我有一个 select 语句，后面跟着一些使用 C 连接器完成的 insert 语句。我想知道如何将它们全部放在一个事务下并最终提交。

我看过 MySQL 5.0 Reference Manual 和[C API Function Overview](http://dev.mysql.com/doc/refman/5.0/en/c-api-function-overview.html)它有这个功能`mysql_commit()`吗？我必须有一个开始事务（如何通过关闭来设置它`autocommit()`），最后只提交对吗？

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-07-17T16:07:44.970

据我了解，没有 mysql_starttransaction() 或类似的东西；所以你会遇到类似的事情：

```
mysql_autocommit(conn, 0); 
//Do stuff here
mysql_commit(conn); //...or mysql_rollback(conn); 
```

我宁愿对所有这些调用使用“查询”方法：

```
mysql_query(conn, "START TRANSACTION");
//Do stuff here
mysql_query(conn, "COMMIT"); //...or mysql_query(conn, "ROLLBACK"); 
```

另[请参阅此文档](http://dev.mysql.com/tech-resources/articles/mysql-connector-cpp.html#trx)。

# java - 如何在 Java 中使用 wait()/notify()

> ID：11526374
> 
> 赞同：4
> 
> 时间：2012-07-17T15:57:57.920
> 
> 标签：java, wait, notify

我知道关于这个主题有几个线程打开，但我只是在寻找一个关于如何在 Java 中使用 wait() 和 notify() 的非常基本的例子。“非常初级”是指简单地打印一些东西。谢谢。

编辑：这是我迄今为止尝试过的，我得到了一个 IllegalMonitorStateException：

 `````
public void waiting() {
        for(int i = 0; i < 10; i++) {
            if(i == 5)
                try {
                    this.wait();
                } catch (InterruptedException e) {

                }
            else
                System.out.println(i);
        }
        System.out.println("notify me now");    
        this.notify();
} 
````  `* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-07-17T16:05:18.047

**wait 和 notify 用于同步块中**，同时使用线程在中断处暂停和恢复。

**Wait 会立即释放锁，而 Nofity 只有在遇到结束括号时才会离开锁。**

```
public class Mythread implements Runnable{

public synchronized void goo(){

System.out.println("Before Wait");

wait();

System.out.println("After Wait");

}

public synchronized void foo(){

System.out.println("Before Notify");

notify();

System.out.println("After Notify");

}

public class Test{

public static  void main(String[] args){

Thread t = new Thread(new Mythread);

t.start();

 }
} 
```

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-07-17T16:40:47.170

您的 IllegalMonitorStateException 是由于您必须在调用等待或通知之前对对象进行同步。所以

`this.wait`

需要是

```
 synchronized(this) {
      this.wait();
    } 
```

您的示例将无法运行，因为您将永远无法`notify`拨打电话……一旦您的线程等待，它将暂停并且不再前进。为了等待/通知工作，你必须有两个线程。一个线程在调用该方法时挂起`wait`，最终，第二个线程调用`synchronized(this) { this.notify() }`以使第一个线程唤醒并在等待调用之后继续执行。

同步是必需的，因为您通常会在等待之前检查一些条件，即

```
 synchronized(this) { 
      if(! this.isReady) {
         this.wait(); 
      }
   } 
```

您需要同步以确保没有其他线程在您检查变量的行和您等待的行之间更改 isReady 标志的状态。所以你的通知代码会

```
 synchronized(this) {
      isReady = true;
      this.notify();
   } 
```

现在方法调用的顺序无关紧要。如果您先通知，则不会唤醒任何线程，但这没关系，因为您不会睡觉，因为 isReady = true。如果你先去睡觉，isReady = true 什么都不做，但是 notify 调用会唤醒线程。最后，同步确保您不检查线程 A 中的变量，然后让线程 B 设置变量并通知（什么都不做），然后让线程 A 进入睡眠状态并且永远不会醒来。

希望有帮助。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-07-17T16:00:02.803

`wait()`和`notify()`用于同步线程：一个线程可以被告知，并且在收到调用`wait()`之前不会继续做任何事情。`notify()`

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2012-07-17T16:00:25.503

这些函数的基本思想是`wait()`挂起一个线程（使其进入睡眠状态），`notify()`并使一个线程在它进入睡眠状态时从它离开的地方拾取。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2012-07-17T16:02:51.670

看看：[这个](http://docs.oracle.com/javase/tutorial/essential/concurrency/guardmeth.html)或只是在谷歌上查找`simple prodcuer consumer problem java`。我相信你会找到适合你需要的东西。

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2012-07-17T16:03:04.350

请参阅oracle java 站点的受保护块上的[这个示例](http://docs.oracle.com/javase/tutorial/essential/concurrency/guardmeth.html)- 它包括[一个简单的生产者-消费者问题](https://www.google.com/search?q=wait%20notify%20java%20simple%20producer%20consumer)的工作示例。``

# android - Android 创建 JSON 对象的 JSON 数组

> ID：11526376
> 
> 赞同：1
> 
> 时间：2012-07-17T15:58:01.173
> 
> 标签：android, json

嗨，有谁知道如何创建一个包含每个对象中包含多个对象的对象的数组？我似乎无法理解它

结构应该是这样的

```
Array{[object]{subobject,subobject}
      [object]{subobject,subobject}
     } 
```

这是我到目前为止所拥有的

```
JSONObject obj = new JSONObject(json2);    
            JSONObject objData = obj.getJSONObject("data");
            fixturesArray = objData.getJSONArray("fixtures");

            JSONArray FixArray = new JSONArray();

            for(int t = 0; t < fixturesArray.length(); t++){
            JSONObject fixObj = fixturesArray.getJSONObject(t);
            String Matchdate = fixObj.getString("matchdate");
            JSONObject DateObj = DateObj.put(Matchdate, DateObj); 
```

继承人我的 JSON 基本上是我所拥有的，如果是我需要将它们订购到日期数组中的固定装置的馈送

```
{
    "code":200,
    "error":null,
    "data":{
        "fixtures":[
            {
                "kickoff":"15:00:00",
                "matchdate":"2012-07-28",
                "homescore":null,
                "awayscore":null,
                "attendance":null,
                "homepens":null,
                "awaypens":null,
                "division_id":"5059",
                "division":"Testing 1",
                "comp":"LGE",
                "location":null,
                "fixture_note":null,
                "hometeam_id":"64930",
                "hometeam":"Team 1",
                "awayteam_id":"64931",
                "awayteam":"Team 2"
            }, {
                "kickoff":"15:00:00",
                "matchdate":"2012-07-28",
                "homescore":null,
                "awayscore":null,
                "attendance":null,
                "homepens":null,
                "awaypens":null,
                "division_id":"5059",
                "division":"Testing 1",
                "comp":"LGE",
                "location":null,
                "fixture_note":null,
                "hometeam_id":"64930",
                "hometeam":"Team 1",
                "awayteam_id":"64931",
                "awayteam":"Team 2"
            }
        ]
    }
} 
```

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-07-17T16:07:17.500

你是这个意思吗：

```
JSONObject obj = new JSONObject();
obj.put("x", "1");
JSONObject parent_object = new JSONObject();
parent_object.put("child", obj);
JSONArray array = new JSONArray(parent_object.toString()); 
```

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-07-18T06:10:15.737

JSON字符串

```
{
"result": "success",
"countryCodeList":
[
  {"countryCode":"00","countryName":"World Wide"},
  {"countryCode":"kr","countryName":"Korea"}
] 
} 
```

下面我正在获取国家/地区详细信息

```
JSONObject json = new JSONObject(jsonstring);
JSONArray nameArray = json.names();
JSONArray valArray = json.toJSONArray(nameArray);

JSONArray valArray1 = valArray.getJSONArray(1);

valArray1.toString().replace("[", "");
valArray1.toString().replace("]", "");

int len = valArray1.length();

for (int i = 0; i < valArray1.length(); i++) {

 Country country = new Country();
 JSONObject arr = valArray1.getJSONObject(i);
 country.setCountryCode(arr.getString("countryCode"));                        
 country.setCountryName(arr.getString("countryName"));
 arrCountries.add(country);
} 
```

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-07-17T16:41:04.943

我建议做的是使用 JackSON JSON Parser 库[http://jackson.codehaus.org/](http://jackson.codehaus.org/) 然后您可以创建一个具有与 JSON 子相同字段的类，从 JSON 到类的映射将是直接的。因此，一旦您将 JSON 中的所有项目放入类列表中，您就可以按日期排序或根据需要操作数据。假设 src 是一个包含 JSON 文本的字符串。使用 JackSON lib，您只需要这样做。

`ObjectMapper mapper = new ObjectMapper();`

`List<Fixture> result = mapper.readValue(src, new TypeReference<List<Fixture>>() { });`

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2012-07-17T16:15:27.353

这是符合您描述的两段 JSON，即“包含对象的数组，每个对象中包含多个对象”。第一种方法使用对象内部的数组。另一个使用对象中的对象。

**方法一**

```
[ { "name" : "first object in array" , "inner array" : [ { <object> } , { <object> } ] }
 , { "name" : "second object in array" , "inner array" : [ { <object> } , { <object> } ] } ] 
```

要解析上述内容，您需要两个嵌套`for`循环（或递归）。

**方法二**

```
[ { "name" : "first object in array" , "first inner object" : { <object> } , "second inner object" : { <object> } } , <etc.> ] } ] 
```

第二种方法可以用一个`for`循环解析，因为您事先知道预期的内部对象的数量。

# c# - 如何在 Linq-to-SQL 实体类中创建自定义属性？

> ID：11526377
> 
> 赞同：2
> 
> 时间：2012-07-17T15:58:04.117
> 
> 标签：c#, linq-to-sql

我有两张表研究和系列。系列是 FK'd back to Studies，因此一项研究包含可变数量的系列。每个系列项目都有一个`Deleted`列，表明它已从数据库中逻辑删除。

我正在尝试`Deleted`在 Study 类中实现一个属性，该属性仅在删除所有包含的系列时才返回 true。我正在使用 O/R Designer 生成的类，因此我将以下内容添加到 Study 类型的用户可修改部分类中：

```
public bool Deleted
{
    get
    {
        var nonDeletedSeries = from s in Series
                               where !s.Deleted
                               select s;
        return nonDeletedSeries.Count() == 0;
    }
    set
    {
        foreach (var series in Series)
        {
            series.Deleted = value;
        }
    }
} 
```

这给出了一个异常“成员 'PiccoloDatabase.Study.Deleted' 没有支持的 SQL 转换。” 当执行这个调用 get 的简单查询时：

```
IQueryable<Study> dataQuery = dbCtxt.Studies;
dataQuery = dataQuery.Where((s) => !s.Deleted);
foreach (var study in dataQuery)
{
   ...
} 
```

基于此[http://www.foliotek.com/devblog/using-custom-properties-inside-linq-to-sql-queries/](http://www.foliotek.com/devblog/using-custom-properties-inside-linq-to-sql-queries/)，我尝试了以下方法：

```
static Expression<Func<Study, bool>> DeletedExpr = t => false;
public bool Deleted
{
    get
    {
        var nameFunc = DeletedExpr.Compile();
        return nameFunc(this);
    }
    set
    {  ... same as before
    }
} 
```

运行不支持对 SQL 的转换的查询时，我得到相同的异常。（ lambda 表达式的逻辑还无关紧要 - 只是试图通过异常。）

我是否缺少一些基本属性或允许转换为 SQL 的东西？我已经阅读了关于这个异常的大部分帖子，但似乎没有什么完全适合我的情况。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-07-26T17:21:51.983

我相信 LINQ-to-SQL 的重点是您的实体是为您映射的，并且必须在数据库中具有相关性。您似乎正在尝试混合使用 LINQ-to-Objects 和 LINQ-to-SQL。

如果 Series 表在数据库中有一个 Deleted 字段，而 Study 表没有，但您想将逻辑 Study.Deleted 转换为 SQL，那么扩展将是一种方法。

```
public static class StudyExtensions
{
    public static IQueryable<study> AllDeleted(this IQueryable<study> studies)
    {
        return studies.Where(study => !study.series.Any(series => !series.deleted));
    }
}

class Program
{
    public static void Main()
    {
        DBDataContext db = new DBDataContext();
        db.Log = Console.Out;

        var deletedStudies = 
            from study in db.studies.AllDeleted()
            select study;

        foreach (var study in deletedStudies)
        {
            Console.WriteLine(study.name);
        }
    }
} 
```

这会将您的“已删除研究”表达式映射到 SQL：

```
SELECT t0.study_id, t0.name
FROM study AS t0
WHERE NOT EXISTS(
    SELECT NULL AS EMPTY
    FROM series AS t1
    WHERE (NOT (t1.deleted = 1)) AND (t1.fk_study_id = t0.study_id)
) 
```

或者，您可以构建实际表达式并将它们注入到您的查询中，但这是一种矫枉过正的做法。

但是，如果 Series 和 Study 在数据库中都没有 Deleted 字段，而只是在内存中，那么您需要先将查询转换为 IEnumerable，然后才能访问 Deleted 属性。但是，这样做会在应用谓词之前将记录传输到内存中，并且可能会很昂贵。IE

```
var deletedStudies = 
    from study in db.studies.ToList()
    where study.Deleted
    select study;

foreach (var study in deletedStudies)
{
    Console.WriteLine(study.name);
} 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2014-03-12T21:11:37.077

当您进行查询时，您将希望使用静态定义`Expression`的，而不是属性。

实际上，而不是：

```
dataQuery = dataQuery.Where((s) => !s.Deleted); 
```

每当您进行 Linq to SQL 查询时，您将希望使用：

```
dataQuery = dataQuery.Where(DeletedExpr); 
```

请注意，这将要求您可以`DeletedExpr`从中查看`dataQuery`，因此您需要将其移出您的类，或者将其公开（即 make 它`public`，在这种情况下，您将通过类定义访问它：）`Series.DeletedExpr`。

此外，an`Expression`的局限性在于它不能具有函数体。所以，`DeletedExpr`可能看起来像：

```
public static Expression<Func<Study, bool>> DeletedExpr = s => s.Series.Any(se => se.Deleted); 
```

该属性只是为了方便而添加的，因此您也*可以*将其用作代码对象的一部分而无需复制代码，即

```
var s = new Study();
if (s.Deleted)
    ... 
```

# php - 在 PHP 中按摩 Smarty 数组并将其发送回 Smarty。. .?

> ID：11526388
> 
> 赞同：0
> 
> 时间：2012-07-17T15:58:49.743
> 
> 标签：php, smarty

**您将如何 a) 在 PHP 中修复 Smarty 数组并 b) 将结果粘贴回 Smarty 数组变量中？**

您是否曾经解决过一个问题，并且您认为您已经非常接近解决它，但目标却越来越远？我花了半天时间，查找文档，搜索示例……但我一定遗漏了一些非常基本的东西。

**前提：**我有一个包含重复条目的 Smarty 数组（现在我无法更改它的创建方式，因为 Smarty 代码是在模板中编码的）。这会导致问题，因为现在我在购物车中获得了同一产品的多个条目。现在，老实说，我无法改变组合方式的逻辑。

这是我得到的：

```
Smarty:
         {$products} 
```

在我的场景中，{$products} 包含四个条目，如下所示：

```
array(1) { [0]=> array(12) { ["pid"]=> string(2) "13" ["domain"]=> NULL
["billingcycle"]=> string(4) "free" ["configoptions"]=> string(0) "" 
["customfields"]=> array(0) { } ["addons"]=> array(0) { } ["server"]=> string(0) ""
["productinfo"]=> array(9) { ["pid"]=> string(2) "13" ["gid"]=> string(1) "2" 
["type"]=> string(5) "other" ["groupname"]=> string(13) "Beta Products" ["name"]=>
string(44) "BetterStuff "Free Until 2014" Beta" ["description"]=> string(21) 
"BetterStuff installer" ["freedomain"]=> string(0) "" ["freedomainpaymentterms"]=> 
array(1) { [0]=> string(0) "" } ["freedomaintlds"]=> array(1) {[0]=> string(0) ""}}
["allowqty"]=> string(1) "0" ["qty"]=> int(1) ["pricing"]=> array(4) { ["baseprice"]=>
string(9) "$0.00 USD" ["setup"]=> string(9) "$0.00 USD" ["recurring"]=> array(0){}
["totaltoday"]=> string(9) "$0.00 USD" } ["pricingtext"]=> string(5) "FREE!" } } 
```

在 PHP 中，我可以轻松地使用 array-unique 来删除该数组中的 3 个精确副本，而只留下一个（如我刚刚在上面展示的那个）。

```
{php}
    $var = $this->get_template_vars('products');
    $var = array_unique($var);
    $smarty = new Smarty();
    $smarty->assign('newproducts', $var = array_unique($var));
    var_dump($var);
{/php} 
```

这在 PHP 中完美运行，并且 var_dump($var) 包含一个数组项（就像我在上面展示的一样）。在 PHP 中，当我用 is_array 检查 $var 时，结果为真。

然而，回到 Smarty，{$newproducts} 为 NULL。

*   当我尝试重新分配原始 Smarty 数组 {$products} 时，我收到一条关于不允许将字符串值添加到数组的错误消息。

*   当我尝试打印 {$newproducts|@count} 时，我得到 0。这对我来说有点混乱，因为我相信智能数组从 1 开始，而 PHP 数组是从零开始的。

*   因此，尽管 PHP 将我分配的变量视为数组的新变量的值，但它不会作为数组进入 Smarty。

**我在这里做错了什么？**我是否需要以某种方式分解或拆分我的 PHP 数组，以便将其转换为 Smarty 变量？

以及如何将 Smarty 中的原始 {$products} 数组“重置”为新的唯一数组值？

任何人？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2015-05-07T17:00:36.220

由于没有真正的答案，而且我遇到了同样的问题，也就是说，由于我无法访问生成它的代码，因此无法从 php 端调用 array_unique。

这是在 Smarty 中对我有用的代码：

```
 {foreach from=$items item=item}
        {if !in_array($item, $array)} 
            <li>{$item}</li>
            {append var='array' value=$item}                       
        {/if}
    {/foreach} 
```

它使用 smarty [**append**](http://www.smarty.net/docs/en/language.function.append.tpl)命令，将项目添加到数组中。此外，我还使用了[**in_array**](http://www.smarty.net/docs/en/advanced.features.tpl)（向下滚动到关于*php_functions*的项目符号），这是 Smarty 中可用的其他一些 php 函数之一。

我希望这可以帮助别人！

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-07-17T16:28:18.440

```
{php}
    // read data from CURRENT INSTANCE
    $var = $this->get_template_vars('products');
    $var = array_unique($var);
    // create NEW INSTANCE
    $smarty = new Smarty();
    // assign to NEW INSTANCE
    $smarty->assign('newproducts', $var = array_unique($var));
    var_dump($var);
{/php} 
```

因此，您正在创建一个新的 smarty 实例并为其分配数据。*您是否有理由相信上述数据在当前*情况下可用？

尝试这个：

```
{php}
    // read data from CURRENT INSTANCE
    $var = $this->get_template_vars('products');
    $var = array_unique($var);
    // assign to CURRENT INSTANCE
    $this->assign('newproducts', $var = array_unique($var));
{/php} 
```

并且 {php} 已被弃用。您可能想查看[使用插件扩展 Smarty](http://www.smarty.net/docs/en/plugins.tpl)

# linux - 以用户 apache 身份运行 bash 脚本时找不到命令

> ID：11526391
> 
> 赞同：0
> 
> 时间：2012-07-17T15:59:10.713
> 
> 标签：linux, apache, bash

我正在尝试以用户 apache 的身份运行 bash 脚本。它抛出了以下内容

```
[apache@denison public]$ ll
total 32
drwxr-xr-x 2 apache apache 4096 Jul 17 08:14 css
-rw-r--r-- 1 apache apache 4820 Jul 17 10:04 h3111142_58_2012-07-17_16-03-58.php
-rwxrwxrwx 1 apache apache   95 Jul 17 10:04 h31111.bash
drwxr-xr-x 2 apache apache 4096 Jul 17 08:14 images
-rw-r--r-- 1 apache apache  754 Jul 17 08:13 index.php
drwxr-xr-x 2 apache apache 4096 Jul 17 08:14 javascript
drwxr-xr-x 5 apache apache 4096 Jul 17 08:14 jquery-ui-1.8.21.custom
[apache@denison public]$ bash h31111.bash
: command not found : 
```

该文件的内容是：

```
#!/bin/bash

/usr/bin/php /opt/eposdatatransfer/public/h3111142_58_2012-07-17_16-03-58.php 
```

php脚本运行良好下面是结果

```
[apache@denison public]$ /bin/bash h31111.bash
: command not found:
[apache@denison public]$ chmod +x h31111.bash
[apache@denison public]$ ./h31111.bash
./h31111.bash: Command not found.
[apache@denison public]$ php h3111142_58_2012-07-17_16-03-58.php 
```

创建文件：

```
$batchFile = $this->session->username . "_" . $index . "_" . $date . ".sh";
            $handle = fopen($batchFile, 'w');
            $data = "#!/bin/bash
/usr/bin/php /opt/eposdatatransfer/public/$file 
";
            /*
rm -rf /opt/eposdatatransfer/public/$file
rm -rf /opt/eposdatatransfer/public/$batchFile*";*/
            fwrite($handle, $data);
            fclose($handle); 
```

batchfile 是 bash 脚本，file 是 php 文件。这些会根据 webapp 中的用户输入自动创建。我的 webapp 在 linux 上运行。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-07-17T17:06:27.010

我猜你是从 Windows 机器上传脚本的，并且没有从行尾删除回车符。这会导致 #! 机制（大多数脚本的第一行）失败，因为它搜索很少存在的#!/some/interpreter^M。

如果有回车符，您可能可以使用 fromdos 或：

```
tr -d '\015' < /path/to/script > /tmp/script; chmod 755 /tmp/script; mv /tmp/script /path/to/script 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-07-17T16:00:53.350

如果您尝试运行脚本会发生什么

```
 $ /bin/bash h31111.bash 
```

试试这个（假设你的脚本文件名为“h31111.bash”）：

```
 $ chmod +x h31111.bash 
```

然后运行它

```
 $ ./h31111.bash 
```

另外，您确定您的`php`命令有正确的路径吗？报告什么`which php`？

--

正如@jordanm 根据`file`我建议您运行的命令的输出正确建议的那样，您需要`dos2unix`在文件上运行该命令。如果您没有安装它，这`tr -d '\r'`也可以。IE，

```
 $ tr -d '\r' h31111.bash > tmp.bash
 $ mv tmp.bash h31111.bash 
```

你应该准备好了。

在某些版本的 Ubuntu 下，这些实用程序（例如，dos2unix）没有安装，有关此信息，请参阅[此页面](http://www.virtualhelp.me/linux/164-dos2unix-missing-ubuntu-1004)。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-07-17T16:10:19.647

既然你不确定它在哪里失败，让我们试着找出答案。

首先，你能执行程序吗？

```
./h31111.bash 
```

这应该相当于调用它：

```
/bin/bash h31111.bash 
```

如果上面给出的错误信息相同，则可能是脚本内容有问题。要找出 bash 脚本中哪里出了问题，可以使用`set -x`and `set -v`。

`set -x`将向您显示扩展 `set -v`将向您显示阅读之前的行

因此，您可以将脚本内容更改为以下内容：

```
#!/bin/bash
set -x
set -v
/usr/bin/php /opt/eposdatatransfer/public/h3111142_58_2012-07-17_16-03-58.php 
```

另一种可能，您可能只能通过经验了解到，该文件处于 MSDOS 模式（即，具有 CR LF，而不仅仅是 LF）。如果您仍在使用 FTP（而不是 SFTP）并处于 ASCII 模式，这通常会发生。您可以将传输模式设置为二进制并让一切顺利进行。如果没有，您有几个选择。**以下任何**一行都应该起作用：

```
dos2unix /path/to/your/file
sed -i 's/\r//g' /path/to/your/file
tr -d '\r' < /path/to/your/file > /path/to/temp/file && mv /path/to/temp/file /path/to/your/file 
```

在 Vim 中，您也可以执行`:set ff=unix`并保存文件以更改格式。

让我们来看看你在 PHP 中拥有什么：

```
$handle = fopen($batchFile, 'w');
$data = "#!/bin/bash
/usr/bin/php /opt/eposdatatransfer/public/$file 
"; 
```

由于您有一个多行字符串，因此嵌入的 CR LF 字符将取决于您的 PHP 文件是 Windows 还是 Unix 格式。您可以将该文件切换为 Windows 格式，就可以了。但这似乎在未来很容易被打破，所以我会选择一些不那么不稳定的东西：

```
$handle = fopen($batchFile, 'w');
fwrite($handle, "#!/bin/bash\n");
fwrite($handle, "/usr/bin/php /opt/eposdatatransfer/public/$file\n");
fclose($handle); 
```

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2012-07-17T17:13:34.143

在我看来，问题出在你的 $PATH 上。系统上的一些用户将拥有**.** （当前目录）在他们的 $PATH 和其他人不会。如果输入 ./h31111.bash 有效，那么这就是你的问题。您可以使用相对或绝对路径指定文件，也可以添加 . 到该用户的 $PATH ，**但永远不要为 root 这样做**。

# java - Tomcat 7 部署问题

> ID：11526392
> 
> 赞同：0
> 
> 时间：2012-07-17T15:59:20.197
> 
> 标签：java, spring, tomcat, maven

我正在从书中弹簧食谱中制作一个示例，并且我似乎无法将示例部署到 tomcat 中。我正在尝试打开 messageList.htm 页面，但我总是收到 HTTP 状态 404 错误。

有人可以帮助我吗？

提前谢谢

这是代码：

web.xml

```
<?xml version="1.0" encoding="UTF-8"?>
<:web-app version="2.4" xmlns:="http://java.sun.com/xml/ns/j2ee"
    xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance"
    xsi:schemaLocation="http://java.sun.com/xml/ns/j2ee http://java.sun.com/xml/ns/j2ee/web-app_2_4.xsd ">
    <:context-param>
        <:param-name>contextConfigLocation</:param-name>
        <:param-value>/WEB-INF/board-service.xml</:param-value>
    </:context-param>

    <:listener>
    <:listener-class>org.springframework.web.context.ContextLoaderListener</:listener-class>
    </:listener>

    <:servlet>
    <:servlet-name>Chapter5Security</:servlet-name>
    <:servlet-class>org.springframework.web.servlet.DispatcherServlet</:servlet-class>
    </:servlet>

    <:servlet-mapping>
    <:servlet-name>Chapter5Security</:servlet-name>
    <:url-pattern>/*</:url-pattern>
    </:servlet-mapping>
</:web-app> 
```

板服务.xml

```
<?xml version="1.0" encoding="UTF-8"?>
<beans xmlns="http://www.springframework.org/schema/beans"
    xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance"
    xsi:schemaLocation="http://www.springframework.org/schema/beans http://www.springframework.org/schema/beans/spring-beans-3.1.xsd">
    <bean id="messageBoardService" class="service.MessageBoardServiceImpl" />

</beans> 
```

板-servlet.xml

```
<?xml version="1.0" encoding="UTF-8"?>
<beans xmlns="http://www.springframework.org/schema/beans"
    xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance"
    xmlns:context="http://www.springframework.org/schema/context"
    xsi:schemaLocation="http://www.springframework.org/schema/beans http://www.springframework.org/schema/beans/spring-beans-3.1.xsd
        http://www.springframework.org/schema/context http://www.springframework.org/schema/context/spring-context-3.1.xsd">
<context:component-scan base-package="web"></context:component-scan>

<bean class="org.springframework.web.servlet.view.InternalResourceViewResolver">
<property name="prefix" value="/WEB-INF/jsp/"/>
<property name="suffix" value=".jsp"/>
</bean>
</beans> 
```

消息列表控制器

```
@Controller
@RequestMapping("/messageList*")
public class MessageListController {

    private MessageBoardService messageBoardService;

    @Autowired
    public MessageListController(MessageBoardService messageBoardService)
    {
        this.messageBoardService=messageBoardService;
    }

    @RequestMapping(method= RequestMethod.GET)
    public String generateList(Model model)
    {
        List<Message>messages=java.util.Collections.emptyList();
        messages=messageBoardService.ListMessages();
        model.addAttribute("messages",messages);
        return "messageList";
    }
} 
```

pom.xml

```
<project xmlns="http://maven.apache.org/POM/4.0.0" xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance"
  xsi:schemaLocation="http://maven.apache.org/POM/4.0.0 http://maven.apache.org/xsd/maven-4.0.0.xsd">
  <modelVersion>4.0.0</modelVersion>

  <groupId>be.glennvdv.BookSpring</groupId>
  <artifactId>Chapter5Security</artifactId>
  <packaging>war</packaging>
  <version>0.0.1-SNAPSHOT</version>
  <name>Chapter5Security Maven Webapp</name>
  <url>http://maven.apache.org</url>

  <properties>
    <project.build.sourceEncoding>UTF-8</project.build.sourceEncoding>
  </properties>

  <dependencies>
    <dependency>
    <groupId>junit</groupId>
    <artifactId>junit</artifactId>
    <version>4.10</version>
          <scope>test</scope>
</dependency>
<dependency>
    <groupId>org.springframework</groupId>
    <artifactId>spring-aop</artifactId>
    <version>3.1.2.RELEASE</version>
</dependency>
            <dependency>
    <groupId>org.springframework</groupId>
    <artifactId>spring-web</artifactId>
    <version>3.1.2.RELEASE</version>
</dependency>
            <dependency>
    <groupId>org.springframework</groupId>
    <artifactId>spring-context-support</artifactId>
    <version>3.1.2.RELEASE</version>
</dependency>
<dependency>
    <groupId>org.springframework</groupId>
    <artifactId>spring-beans</artifactId>
    <version>3.1.2.RELEASE</version>
</dependency>

        <dependency>
    <groupId>org.springframework</groupId>
    <artifactId>spring-context</artifactId>
    <version>3.1.2.RELEASE</version>
</dependency>

    <dependency>
    <groupId>org.springframework</groupId>
    <artifactId>spring-core</artifactId>
        <version>3.1.2.RELEASE</version>
</dependency>
<dependency>
    <groupId>org.springframework.security</groupId>
    <artifactId>spring-security-core</artifactId>
    <version>3.1.1.RELEASE</version>
</dependency>
            <dependency>
    <groupId>org.springframework.security</groupId>
    <artifactId>spring-security-ldap</artifactId>
    <version>3.1.1.RELEASE</version>
</dependency>
            <dependency>
    <groupId>org.springframework.security</groupId>
    <artifactId>spring-security-config</artifactId>
    <version>3.1.1.RELEASE</version>
</dependency>
            <dependency>
    <groupId>org.springframework.security</groupId>
    <artifactId>spring-security-web</artifactId>
    <version>3.1.1.RELEASE</version>
</dependency>
            <dependency>
    <groupId>org.springframework.security</groupId>
    <artifactId>spring-security-taglibs</artifactId>
    <version>3.1.1.RELEASE</version>
</dependency>
            <dependency>
    <groupId>org.springframework.security</groupId>
    <artifactId>spring-security-acl</artifactId>
    <version>3.1.1.RELEASE</version>
</dependency>
<dependency>
    <groupId>org.springframework</groupId>
    <artifactId>spring-webmvc</artifactId>
    <version>3.1.2.RELEASE</version>
</dependency>

  </dependencies>
    <build>
    <finalName>Chapter5Security</finalName>
    <plugins>
        <plugin>

            <groupId>org.apache.tomcat.maven</groupId>
            <artifactId>tomcat7-maven-plugin</artifactId>
            <configuration>
            <server>myserver</server>

            </configuration>
        </plugin>
    </plugins>
  </build>
</project> 
```

消息列表.jsp

```
<%@ taglib prefix="c" uri="http://java.sun.com/jsp/jstl/core" %>

<html>
<head>
<title>Message List</title>
</head>

<body>

<c:forEach items="${messages}" var="message">
<table>
  <tr>
    <td>Author</td>
    <td>${message.author}</td>
  </tr>
  <tr>
    <td>Title</td>
    <td>${message.title}</td>
  </tr>
  <tr>
    <td>Body</td>
    <td>${message.body}</td>
  </tr>
  <tr>
    <td colspan="2">
      <a href="messageDelete?messageId=${message.id}">Delete</a>
    </td>
  </tr>
</table>
<hr />
</c:forEach>
<a href="messagePost">Post</a>
</body>
</html> 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-07-17T16:03:09.763

HTTP 404 意味着您在浏览器中提供的 URL 没有映射到您希望的页面。

如果您将应用程序作为名为 foo.war 的 WAR 文件部署到 Tomcat，我希望 URL 如下所示：

```
http://localhost:8080/foo/messageList.html 
```

使用该语法，直到正确为止。

如果 Maven 对您来说是一个黑匣子，我建议您手动创建和部署一个 WAR 文件，直到您弄明白为止。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-07-18T10:22:48.423

得到它的工作。1：web.xml 格式不正确 2：Needet jstldependency

# asp.net - 如何在 IIS7.5 上进行 Response.Write？

> ID：11526396
> 
> 赞同：1
> 
> 时间：2012-07-17T15:59:28.123
> 
> 标签：asp.net, iis-7.5

我正在尝试写出对客户的回复：

```
response.StatusCode = (int)HttpStatusCode.BadRequest;
response.ClearContent();
response.Write(String.Format(
      "<!doctype html>"+CRLF+
      "<html>" + CRLF +
      "<head><title>{0}</title></head>" + CRLF +
      "<body><h1>{0}</h1>"+CRLF+
      "{1}"+CRLF+
      "</body>" + CRLF +
      "</html>", 
      response.Status, "The grob must be in the frobber."));
response.Flush();
response.End(); 
```

该代码在 localhost (Visual Studio (2010 (Windows 7 (Professional (64-bit)))) 开发 Cassini web-server 上运行时运行良好：

```
HTTP/1.1 400 Bad Request
Server: ASP.NET Development Server/10.0.0.0
Date: Tue, 17 Jul 2012 15:56:42 GMT
X-AspNet-Version: 4.0.30319
Cache-Control: private
Content-Type: text/html
Connection: Close

<!doctype html>
<html>
<head><title>400 Bad Request</title></head>
<body><h1>400 Bad Request</h1>
The grob must be in the frobber.
</body>
</html> 
```

但是当我将网站部署到运行 IIS7.5 的 Windows Server 2008 R2 时，相同的代码不起作用：

```
HTTP/1.1 400 Bad Request
Cache-Control: private
Content-Type: text/html
Server: Microsoft-IIS/7.5
X-AspNet-Version: 4.0.30319
X-Powered-By: ASP.NET
Date: Tue, 17 Jul 2012 15:57:44 GMT
Content-Length: 11

Bad Request 
```

我如何`Response.Write`从 IIS 执行？

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-07-17T16:59:34.553

默认情况下，如果代码 >= 400，IIS 7 将更改响应 [http://msdn.microsoft.com/en-us/library/ms690497(v=vs.90).aspx](http://msdn.microsoft.com/en-us/library/ms690497(v=vs.90).aspx)

但是你可以在 的`httpErrors`元素中改变它`system.webServer`。

```
<httpErrors existingResponse="PassThrough" /> 
```

编辑：这将打破`CustomErrors`，如果你正在使用它。您最好在没有响应的情况下返回 400，然后设置 web.config 以重定向到 400 错误的自定义页面。

```
<customErrors mode="On">
    <error statusCode="400" redirect="Frobber.htm" />
</customErrors> 
```

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2012-12-12T06:38:27.007

我遇到了这个确切的问题，今天花了几个令人沮丧的时间来研究它。就我而言，我通过 Response.Write 将可能非常大的 CSV 数据直接发送到客户端，并每隔 3k 条左右的记录刷新一次。它在我的本地环境中运行良好，但在 Windows 2008 服务器上部署到 IIS 7.5 时失败。没有例外，在客户端只有一个空的 CSV。

原来我的应用程序启用了动态压缩。它可以通过 web.config 直接禁用，也可以在 IIS MMC 界面中禁用。您可以使用浏览器的工具检查您收到的响应的标头来验证这一点。

```
Content-Encoding:gzip 
```

禁用动态压缩（不确定最初启用它的方式/原因），它工作正常。这可能不是你的问题，但它是我的。我花了一天的大部分时间在这个上钓鱼，并没有看到它直接回答，所以我想我会把它扔在那里。此外，结果集的大小无关紧要。5kb 文件和 3Gb 文件有同样的问题。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-07-17T16:44:29.977

您是否检查过服务器上是否启用了 asp.net？您需要使用 Windows 服务器管理器检查功能是否已安装。

我刚刚在我的服务器上尝试了您的代码，尽管我认为它的大小写错误`response`，但它按预期工作。

# regex - 限制键值对内容所需的正则表达式模式帮助

> ID：11526399
> 
> 赞同：0
> 
> 时间：2012-07-17T15:59:54.583
> 
> 标签：regex, xsd

我正在尝试使用模式中的正则表达式模式来限制 xml 元素的内容，但我无法让它工作，而且我添加的越多，它似乎变得越糟。

要求如下：

*   元素字符串不能超过 512 个字符（这一点很简单，但为了完整性而添加）
*   该字符串由多个键值对组成。
*   键值对将由 '^' 分隔
*   每个键值对由一个 3 个字符的键组成，后跟任意数量的值字符。
*   键将通过“|”与值分开

XML 的一个示例是：

```
<myElement>
    ABC|This is some value text for key ABC^DEF|This is some value text for key DEF^GHI|This is some value text for key GHI^JKL|This is some value text for key JKL^
</myElement> 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-07-17T19:19:20.087

在您说“键/值对将由'^'分隔”的问题中，但该示例显示了以'^'终止的键/值对，所以我假设这就是你想要的。

键匹配`\w{3}`（3 个字母或数字）。

该值匹配`[^^<]*`（除 之外的任意数量的任意字符`^`）。

完整的正则表达式是`(\w{3}\|[^^]*\^)*`.

# iphone - 使用情节提要的双 UITabViewControllers

> ID：11526402
> 
> 赞同：0
> 
> 时间：2012-07-17T16:00:03.287
> 
> 标签：iphone, ios, xcode, ios5, storyboard

目前我有一个设置，firstTabViewController 托管 5 个按钮，每个按钮加载一个表格视图。当用户选择其中一个表格单元格时，它会打开一个带有一组 4 个不同选项卡按钮的 secondTabViewController。我还嵌入了一个导航控制器。

我已经通过情节提要进行了设置，并提出了一些问题。首先，当它加载 secondTabViewController 时，它会将其加载到 firstTabViewController 中，因此我有 2 组选项卡按钮在彼此之上。如果我将 segue 更改为模态，它会正确加载 secondTabViewController，但不允许我使用导航控制器返回。

是否有解决方案，或者我是否应该停止浪费时间使用故事板，而只是以编程方式进行设置？

截图：[故事板](http://i.imgur.com/YvKts.png)

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-07-17T16:09:20.293

当我想隐藏标签栏时，我使用此代码：我忘记了我从哪里偷来的，但我很确定它在 SO 上。

```
- (void) hideTabBar:(UITabBarController *) tabbarcontroller {

[UIView beginAnimations:nil context:NULL];
[UIView setAnimationDuration:0.5];
for(UIView *view in tabbarcontroller.view.subviews)
{
    if([view isKindOfClass:[UITabBar class]])
    {
        [view setFrame:CGRectMake(view.frame.origin.x, 480, view.frame.size.width, view.frame.size.height)];
    } 
    else 
    {
        [view setFrame:CGRectMake(view.frame.origin.x, view.frame.origin.y, view.frame.size.width, 480)];
    }

}

[UIView commitAnimations];

}

- (void) showTabBar:(UITabBarController *) tabbarcontroller {

[UIView beginAnimations:nil context:NULL];
[UIView setAnimationDuration:0.5];
for(UIView *view in tabbarcontroller.view.subviews)
{

    if([view isKindOfClass:[UITabBar class]])
    {
        [view setFrame:CGRectMake(view.frame.origin.x, 431, view.frame.size.width, view.frame.size.height)];

    } 
    else 
    {
        [view setFrame:CGRectMake(view.frame.origin.x, view.frame.origin.y, view.frame.size.width, 431)];
    }

}

[UIView commitAnimations]; 
} 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-07-17T16:17:57.530

使用您的原始策略，然后在打开第二个选项卡栏视图时隐藏第一个选项卡视图控制器的选项卡栏。

# charts4j - 如何在charts4j中缩放饼图？

> ID：11526408
> 
> 赞同：1
> 
> 时间：2012-07-17T16:00:26.470
> 
> 标签：charts4j

我一直在用charts4j 做一些工作。他们有很多很棒的代码示例（https://code.google.com/p/charts4j/）。但是我似乎无法弄清楚如何缩放饼图。我可以使用 .setSize 调用重新调整图表的大小，但这不会改变实际饼图的大小。它只是给了我更多的空白。有什么办法可以让馅饼变大/变小？你怎么做呢？谢谢。

```
Slice s1 = Slice.newSlice(30, Color.newColor("951800"), "Featured", "Featured");
Slice s2 = Slice.newSlice(70, Color.newColor("01A1DB"), "Not-Featured", "Not-Featured");

PieChart refChart = GCharts.newPieChart(s1, s2);
refChart.setSize(650, 200);
refChart.setThreeD(true);
String refURL = refChart.toURLString(); 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-07-26T14:28:52.763

Charts4j 会向您发送一个您可以使用的图片的链接。它不完全相同，但您可以在 css 中缩放图片。它足以满足我的目的。

# php - Twitter Bootstrap 是否适用于 PHP？

> ID：11526419
> 
> 赞同：0
> 
> 时间：2012-07-17T16:01:05.283
> 
> 标签：php, twitter-bootstrap

我是 Twitter Bootstrap 的新手，我包含了一些简单的 PHP 脚本来测试，我的浏览器（Chrome）不会读取 php 代码。我已经保存了文件 .html、.php，并尝试了 .html.php。Twitter Bootstrap 是否仅适用于客户端，而不适用于服务器端应用程序，或者是否有技巧让它与 PHP 一起使用？谢谢

* * *

## 回答 #1

> 赞同：10
> 
> 时间：2012-07-17T16:04:37.203

> Twitter Bootstrap 是否适用于 PHP？

是和不是。

Bootstrap 完全是客户端。它可以由 PHP 输出（就像任何其他客户端代码一样），但没有与之交互的特殊功能。

> 我的浏览器（Chrome）不会读取 php 代码

PHP 是一种*服务器*端语言。没有浏览器解析 PHP 代码。您需要通过将执行 PHP 并将输出返回给浏览器的 Web 服务器来访问它。另请参阅[安装 PHP](http://php.net/manual/en/install.php)。

* * *

## 回答 #2

> 赞同：5
> 
> 时间：2012-07-17T16:04:14.800

Bootstrap 只是一些 css 和 javascript。您可以将它与 PHP 应用程序一起使用就可以了。我们的确是。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-12-25T20:39:31.853

使用 Microsoft WebMatrix 3（*安装 php 和 Wamp 服务器真的很烦人*）

使用 Webmatrix IDE，然后 php 和 bootstrap 就可以正常工作了。

# django - Django模板：如何访问等于变量值的表单字段？

> ID：11526420
> 
> 赞同：4
> 
> 时间：2012-07-17T16:01:05.603
> 
> 标签：django, django-templates

想象以下用例：我有一个报告模板字典。每个报告模板都有一个 ID 和一个名称。它或多或少看起来像这样：

```
reports = [ { 'ID' : 'A1',
              'NAME' : 'special report 1 for department A',
              ... (other fields irrelevant to the question's matter)
            },
            { 'ID' : 'X9',
              'NAME' : 'special report 9 for department X',
              ... (other fields irrelevant to the question's matter)
            },
          ] 
```

报告的访问和可见性将存储在数据库中。
我创建了一个字段名称等于报告 ID 的表单。一切都很好，直到我必须在模板中显示表单。我不知道如何访问正确的表单字段。此语法不起作用：

```
{% for report in reports %}
<tr>
    <td>{{ report.ID }}</td>
    <td>{{ report.NAME }}</td>

    <td>{{ form.report.ID }}</td>

</tr>
{% endfor %} 
```

还：

```
{% for report in reports %}
<tr>
    <td>{{ report.ID }}</td>
    <td>{{ report.NAME }}</td>
    {% with report.ID as key %}     
    <td>{{ form.key }}</td>
    {% endwith %}
</tr>
{% endfor %} 
```

不起作用。

语法应该如何？应该在下面的代码中放置什么而不是问号？

```
{% for report in reports %}
<tr>
    <td>{{ report.ID }}</td>
    <td>{{ report.NAME }}</td>

    <td>{{ form.??? }}</td>

</tr>
{% endfor %} 
```

我遇到了这个解决方案：[Django Templates: Form field name as variable?](https://stackoverflow.com/questions/4993625/django-templates-form-field-name-as-variable) 我想如果没有其他方法可以解决我的问题，我将不得不使用它。

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-09-06T20:16:17.753

不鼓励这样做，因为模板应该尽可能没有逻辑。但是，在实践中，这一直出现。您可以制作一个模板过滤器来执行此操作：

```
@register.filter(name='get')
def get(o, index):
    try:
        return o[index]
    except:
        return settings.TEMPLATE_STRING_IF_INVALID 
```

然后，在模板中，适当加载 templatetags 库后：

```
{% for report in reports %}
<tr>
    ...
    <td>{{ form|get:report.ID }}</td>
</tr>
{% endfor %} 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-07-17T16:09:10.337

试试这个：

```
{{ form.fields.key }} 
```

# linux - 为 arm 编译 libcurl 应用程序时出错

> ID：11526421
> 
> 赞同：0
> 
> 时间：2012-07-17T16:01:11.400
> 
> 标签：linux, arm

我正在尝试为 arm ( [am-1808 ) 编译](http://www.ti.com/product/am1808)[libcurl](http://curl.haxx.se/)，编译工作正常，但是当我尝试使用 libcurl 构建应用程序时，我遇到了一些错误，这是我遵循的步骤：

**1.**

```
 ./configure --host=arm-none-linux --build=i686-linux CFLAGS='-Os' --disable-ftp --disable-tftp --disable-ldap --disable-telnet --disable-dict --disable-ipv6 --disable-ares --disable-sspi --disable-cookies --disable-crypto-auth --without-libidn --without-ssl --without-zlib --without-libssh2 --without-gnutls --without-nss --without-ca-bundle --enable-smtp 
```

**2.**

```
make 
```

**3.**

```
sudo make install 
```

到这一步为止一切正常，但现在在编译[示例应用程序](http://curl.haxx.se/libcurl/c/smtp-multi.html)时出现以下错误：

```
usama@ubuntu:~/Desktop/smtp$ arm-none-linux-gnueabi-gcc -o email smtp-multi.c -lcurl
smtp-multi.c:27:23: error: curl/curl.h: No such file or directory
smtp-multi.c:77: error: return type is an incomplete type
smtp-multi.c: In function 'tvnow':
smtp-multi.c:81: error: storage size of 'now' isn't known
smtp-multi.c:84: warning: 'return' with a value, in function returning void
smtp-multi.c: At top level:
smtp-multi.c:87: error: parameter 1 ('newer') has incomplete type
smtp-multi.c:87: error: parameter 2 ('older') has incomplete type
smtp-multi.c: In function 'main':
smtp-multi.c:95: error: 'CURL' undeclared (first use in this function)
smtp-multi.c:95: error: (Each undeclared identifier is reported only once
smtp-multi.c:95: error: for each function it appears in.)
smtp-multi.c:95: error: 'curl' undeclared (first use in this function)
smtp-multi.c:96: error: 'CURLM' undeclared (first use in this function)
smtp-multi.c:96: error: 'mcurl' undeclared (first use in this function)
smtp-multi.c:98: error: storage size of 'mp_start' isn't known
smtp-multi.c:105: error: 'CURL_GLOBAL_DEFAULT' undeclared (first use in this function)
smtp-multi.c:115: warning: assignment makes pointer from integer without a cast
smtp-multi.c:120: error: 'CURLOPT_URL' undeclared (first use in this function)
smtp-multi.c:121: error: 'CURLOPT_USERNAME' undeclared (first use in this function)
smtp-multi.c:122: error: 'CURLOPT_PASSWORD' undeclared (first use in this function)
smtp-multi.c:123: error: 'CURLOPT_READFUNCTION' undeclared (first use in this function)
smtp-multi.c:124: error: 'CURLOPT_MAIL_FROM' undeclared (first use in this function)
smtp-multi.c:125: error: 'CURLOPT_MAIL_RCPT' undeclared (first use in this function)
smtp-multi.c:126: error: 'CURLOPT_USE_SSL' undeclared (first use in this function)
smtp-multi.c:126: error: 'CURLUSESSL_ALL' undeclared (first use in this function)
smtp-multi.c:127: error: 'CURLOPT_SSL_VERIFYPEER' undeclared (first use in this function)
smtp-multi.c:128: error: 'CURLOPT_SSL_VERIFYHOST' undeclared (first use in this     function)
smtp-multi.c:129: error: 'CURLOPT_READDATA' undeclared (first use in this function)
smtp-multi.c:130: error: 'CURLOPT_VERBOSE' undeclared (first use in this function)
smtp-multi.c:131: error: 'CURLOPT_SSLVERSION' undeclared (first use in this function)
smtp-multi.c:132: error: 'CURLOPT_SSL_SESSIONID_CACHE' undeclared (first use in this function)
smtp-multi.c:142: error: storage size of 'timeout' isn't known
smtp-multi.c:145: error: 'fd_set' undeclared (first use in this function)
smtp-multi.c:145: error: expected ';' before 'fdread'
smtp-multi.c:146: error: expected ';' before 'fdwrite'
smtp-multi.c:147: error: expected ';' before 'fdexcep'
smtp-multi.c:152: error: 'fdread' undeclared (first use in this function)
smtp-multi.c:153: error: 'fdwrite' undeclared (first use in this function)
smtp-multi.c:154: error: 'fdexcep' undeclared (first use in this function)
smtp-multi.c:180: error: invalid use of void expression
smtp-multi.c:180: error: type of formal parameter 1 is incomplete
smtp-multi.c:180: error: type of formal parameter 2 is incomplete
smtp-multi.c:181: warning: incompatible implicit declaration of built-in function    'fprintf'
smtp-multi.c:181: error: 'stderr' undeclared (first use in this function) 
```

可能是我在设置 ./configure 时在配置中做错了什么，知道如何摆脱这些错误吗？

问候

乌萨马

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-07-18T10:37:18.673

配置选项有问题，--host 选项不正确，--host 的正确参数是 arm-none-linux-gnueabi，所以正确的配置命令是（最好启用 SSL）。

```
 ./configure --host=arm-none-linux-gnueabi --build=i686-linux CFLAGS='-Os' --disable-ftp --disable-tftp --disable-ldap --disable-telnet --disable-dict --disable-ipv6 --disable-ares --disable-sspi --disable-cookies --disable-crypto-auth --without-libidn --without-zlib --without-libssh2 --without-gnutls --without-nss --without-ca-bundle --with-ssl=PATH --enable-smtp 
```

**注意：** 在 --with-ssl 中给出 OpenSSL 的路径代替 PATH

# nhibernate - NHibernate 会根据月份中的某天改变它创建基于 DateTime 的查询的方式

> ID：11526422
> 
> 赞同：0
> 
> 时间：2012-07-17T16:01:13.740
> 
> 标签：nhibernate, datetime

关于 NHibernate 如何在 DateTimeOffset 字段上向数据库发送查询，我得到了一些奇怪的行为。给定以下示例：

```
DateTimeOffset? myDate = new DateTimeOffset(2012, 3, 17, 0, 0, 0, new TimeSpan(1, 0, 0));
var test = HibernateSession.Query<ExampleEntity>().Where(c => c.DateTimeOffsetField > myDate).ToList();
DateTimeOffset? myDate2 = new DateTimeOffset(2012, 3, 1, 0, 0, 0, new TimeSpan(1, 0, 0));
var test2 = HibernateSession.Query<ExampleEntity>().Where(c => c.DateTimeOffsetField > myDate2).ToList(); 
```

使用 NHibernate Profiler 查看生成的 SQL，第一个查询显示为

```
exampleentity0_.[DateTimeOffsetField] > '17/03/2012 00:00:00 +01:00' /* @p0 */ 
```

第二个作为

```
exampleentity0_.[DateTimeOffsetField] > '2012-01-02T23:00:00.00' /* @p0 */ 
```

注意到日期的不同格式了吗？如果月份的日期大于 12，则使用第一种格式，如果小于 12，则使用第二种格式。当我们有第一种格式的日期时，这会导致错误，因为 SQL 服务器无法将字符串转换为有效的日期，因为它正在寻找第 17 个月（如本例）。这让我发疯了！！

有没有人见过这种行为？是否可以告诉 NHibernate 始终使用 yyyy-MM-dd 格式？

谢谢汤姆

ps 使用 FluentNHibernate 进行映射和配置。映射的一个例子是

```
Map(a => a.DateTimeOffsetField).Not.Nullable(); 
```

...即没有什么不寻常的..

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-07-17T21:22:00.467

我已经通过更改 sql server 实例以使用英国时间文化“修复”了这个问题，这样它就接受了 NHibernate 创建的两个值......仍然有兴趣知道为什么会出现这些差异。

# windows - 我如何与 xcopy 的速度相媲美？

> ID：11526423
> 
> 赞同：7
> 
> 时间：2012-07-17T16:01:14.213
> 
> 标签：windows, file-io, smb

是否有开源项目或最佳实践指南显示了在本地机器、lan、san 和 wan 周围复制文件的最快方法，可以与 windows7（或 8）或 windows 的内置 xcopy 的速度相媲美探险家副本？

说白了，并不是所有的文件 IO 都是一样的。在某些协议和技术中有不同的开销。一些库没有利用异步操作或利用硬件的线速度。

我正在盘点我们使用的大量数据传输，并尝试评估我们的客户端应用程序和来自外部供应商的应用程序的有效性。某些服务器应用程序是最严重的违规者（基于 java 的应用程序是最糟糕的）。

我将这项研究的范围限制在 SMB 2 和 3（windows7 和 8 上的 cifs）。

*   使用 POSIX 库的速度是否存在劣势。（fread、fopen、fseek 等）
*   使用 win32 调用（CopyFile2、ReadFileEx）有什么好处吗？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-08-09T03:38:24.513

`xcopy`实际上不是复制文件的最快方式，尤其是跨磁盘或跨本地网络。有一种名为[TeraCopy](http://codesector.com/teracopy/)的商业产品速度要快得多。它是闭源的，所以我不完全知道它是如何工作的，但主要区别之一是它不是使用单个循环将一大块数据读取到内存缓冲区然后将该缓冲区写入新位置，而是使用两个线程和一个生产者/消费者队列。

生产者读取源文件的块并将它们放入队列中。消费者从队列中读取并写入目标。这里的优点是可以同时进行读取和写入。您确实需要小心并让生产者密切关注队列大小，并且不要让队列太大而无法占用太多内存 - 通常读取会比写入快，但这也取决于源和目标地点。

# tridion - 获取用户组信息需要什么属性或方法？

> ID：11526424
> 
> 赞同：3
> 
> 时间：2012-07-17T16:01:15.720
> 
> 标签：tridion, tridion-2011

创建新用户对象后，如何获取特定用户的组名？我必须使用哪个属性？我检查了`userdata`课程，我没有在那里找到任何分组的详细信息。

```
UserData user = (UserData)csClient.Read(usertcmid, readoption); 
```

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-07-17T16:18:16.833

使用来自 Arjen 的信息更新了代码

```
UserData user = (UserData)csClient.Read(usertcmid, readoption);
user.GroupMemberships() // returns GroupMembershipData enumeration 
```

# shell - 在屏幕中启动游戏服务器的 Shell 脚本

> ID：11526427
> 
> 赞同：0
> 
> 时间：2012-07-17T16:01:26.267
> 
> 标签：shell

我正在尝试修改我编写的这个非常简单的 shell 脚本，以检查屏幕是否已经处于活动状态，如果是，则不要创建它们。例如，如果我使用`start`参数调用此脚本两次，将进行四个屏幕会话。我想阻止这种情况。

```
#! /bin/sh
# /etc/init.d/css-server
#

case "$1" in
  start)
    echo "Starting Nullus Imprimis war server..."
    screen -A -m -d -S css-war-server /home/css-servers/war-server/css/srcds_run -game cstrike +map de_dust2 +maxplayers 16 -autoupdate -port 2555
    echo "Nullus Imprimis war server started"
    echo "Starting Nullus Imprimis pub server #1..."
    screen -A -m -d -S css-pub-server-1 /home/css-servers/pub-server-1/css/srcds_run -game cstrike +map de_dust2 +maxplayers 32 -autoupdate -port 2666
    echo "Nullus Imprimis pub server #1 started"
    ;;
  stop)
    echo "Stopping Nullus Imprimis war server..."
    screen -S css-war-server -X quit
    echo "Nullus Imprimis war server stopped"
    echo "Stopping Nullus Imprimis pub server #1..."
    screen -S css-pub-server-1 -X quit
    echo "Nullus Imprimis pub server #1 stopped"
    ;;
  *)
    echo "Usage: service css-servers {start|stop}"
    exit 1
    ;;
esac

exit 0 
```

另外，我想让服务器在他们自己的用户名下运行，在这种情况下`css-servers`。我怎样才能做到这一点？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-07-17T17:13:14.563

要检查屏幕是否已经在运行，我通常只是从以下位置对其进行 grep `screen -ls`：

```
screen -ls | grep -q NAME || ...do something if server is not running... 
```

或者：

```
if ! screen -ls | grep -q NAME; then
  ...do something if server is not running...
fi 
```

为了以不同的用户身份运行它，我建议使用 运行启动脚本`sudo -u`，如下所示：

```
sudo -u css-servers STARTUP_SCRIPT 
```

# python - grep：破管错误python 2.2

> ID：11526428
> 
> 赞同：0
> 
> 时间：2012-07-17T16:01:33.823
> 
> 标签：python, bash, csh, broken-pipe

我正在接受一堆脚本，并在 python 中为它们创建一个包装器。我没有创建给我的脚本。目前我正在使用 python 2.2，我使用的 shell 是 csh shell。

当我以以下方式运行脚本时：

```
>> setenv some_var '/some/path/'
>> <some more setenv>
>> ./script -flag >& log.txt < /dev/null & 
```

它运行得非常好。

当我使用 bash 包装器调用我的 python 包装器时，就会出现问题。我的 bash 脚本（analysis.sh）如下：

```
#!/bin/bash
#environment variables
ENV1='/path/for/env1'
ENV2='/path/for/env2'

export ENV1
export ENV2

./run_analysis.py $@
exit 
```

在我的python文件中，我基本上所做的就是执行

```
....
os.system(script_path + script_name + script_flag)
.... 
```

每当我在 csh shell 上以以下方式运行脚本时：

```
./analysis.sh -flag script_name >& log.txt < /dev/null & 
```

该脚本突然给了我一堆损坏的管道错误（“grep：写入输出：损坏的管道”）。我知道该脚本确实使用了很多 grep。我只是不明白为什么在执行重定向时会弹出这些错误。在 python 2.2 中，只有 'os' 和 'commands' 模块存在。我被迫使用这些约束。

谢谢你。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-07-17T16:12:50.147

一旦您的脚本写入数据并退出，看起来 grep （某处）仍然希望能够从管道中读取，由于您的脚本已经兴奋，管道不再存在 - 因此管道损坏。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-07-19T19:48:52.690

弄清楚了。

我必须在 os.system() 调用中运行重定向命令。如果我在外面运行它就不起作用。

我的最后一行是：

```
os.system(script_dir + script + script_flag + " >> log.txt 2>&1 < /dev/null &") 
```

不过感谢您的帮助。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-07-18T06:20:45.110

我认为问题在于 bash 脚本设置的环境变量没有传递给 python 脚本的 os.system() 调用。考虑从 python 脚本中设置这些 envars。本身。

# vb.net - vb.net 有没有更快的方法从另一个字符串列表中减去一个字符串列表

> ID：11526430
> 
> 赞同：1
> 
> 时间：2012-07-17T16:01:35.517
> 
> 标签：vb.net, string, list

```
Public done As New List(Of String)
Public thinkingofdoing As New List(Of String)
Public todo As New List(Of String)

done.AddRange(System.IO.File.ReadAllLines("C:\Users\Work\Desktop\done.txt"))
thinkingofdoing.AddRange(System.IO.File.ReadAllLines("C:\Users\Work\Desktop\thinkingofdoing.txt"))

For i = 0 To thinkingofdoing.Count - 1
    ThreadPool.QueueUserWorkItem(AddressOf caldiff, thinkingofdoing(i))
Next

Public Sub caldiff(ByVal tobedone)
    If done.Contains(tobedone) = False Then
        todo.Add(tobedone)
    End If
End Sub 
```

**done.txt**和**thinkingofdoing.txt**有 500 万到 800 万行

这需要很长时间 :(，即使四核 AMD 965 超频到 4.2 GHZ。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-07-17T16:11:39.197

首先，上面的代码无效。 `List(Of T)`不是线程安全的，因此从多个线程执行此操作实际上会在没有同步的情况下导致重大问题，因为从多个线程调用的调用`Add`本身`Contains`并不安全。

更好的选择是选择更好的集合，例如`HashSet(Of T)`，这将导致检查速度更快。我会推荐类似的东西：

```
public Done as New HashSet(Of String)
public ThinkingOfDoing as IList(Of String) 
public Todo as New List(Of String)

ThinkingOfDoing = System.IO.File.ReadAllLines("C:\Users\Work\Desktop\thinkingofdoing.txt")
Done.AddRange(System.IO.File.ReadAllLines("C:\Users\Work\Desktop\done.txt"))

ToDo = ThinkingOfDoing.Where(Function(i) Done.Contains(i) = False).ToList() 
```

通过使用 a `HashSet(Of T)`，`Contains()`检查将变得更快（`O(1)`而不是`O(n)`），这将导致它运行得*更快*，甚至是单线程。

如果您不需要*存储*Done，则可以保留数组并`Enumerable.Except`直接使用（在内部使用 Set）：

```
ThinkingOfDoing = System.IO.File.ReadAllLines("C:\Users\Work\Desktop\thinkingofdoing.txt")
Dim done = System.IO.File.ReadAllLines("C:\Users\Work\Desktop\done.txt")

Dim Todo = ThinkingOfDoing.Except(done).ToList(); 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-07-17T16:11:44.427

您可以使用[`Enumerable.Except`](http://msdn.microsoft.com/en-us/library/bb300779.aspx)which 应该更有效，因为它实现为`HashSet<T>`：

```
IEnumerable(Of String) newLines = thinkingofdoing.Except(done) 
```

您还应该使用`File.ReadLines`而不是，`File.ReadAllLines`因为前者使用流，而后者一次将所有内容加载到内存中。

我会在不`ThreadPool`先使用的情况下测试性能。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-07-17T16:27:55.077

这个怎么样 ...

```
Public done As ISet(Of String) 
Public toDo As New List(Of String)(); 

done = New HashSet(Of String) _
    (System.IO.File.ReadAllLine("C:\Users\Work\Desktop\done.txt")

Using reader As New StreamReader(New FileStream _
        ("C:\Users\Work\Desktop\thinkingofdoing.txt"), FileMode.Open)
    Do While reader.Peek() >= 0
        Dim line = reader.ReadLine()
        If Not done.Contains(line) Then
            toDo.Add(line)
        EndIf
    Loop
End Using 
```

这会将所有已完成的行加载到具有出色查找性能的 HashSet 中，然后不是将执行文件的整个想法加载到内存中，而是逐行解析，并且仅在尚未完成时才添加到 todo 中。

如果 VB.Net 有一个收益回报，我会把它放在一个函数中并在 IEnumerable 上完成 ToList，但是嘿嘿。

# testing - 从普通的 Groovy 迁移到 Gradle

> ID：11526431
> 
> 赞同：2
> 
> 时间：2012-07-17T16:01:38.107
> 
> 标签：testing, groovy, jenkins, gradle

我有一个用 Groovy 制作的小应用程序。目前我可以在命令行上对其进行测试，但我需要将它与 Jenkins 服务器集成。因此，我考虑将它与 Gradle 集成，以生成 Jenkins 可以读取的标准格式的测试输出。（请考虑到我是 Groovy、Gradle、Jenkins 和一般 JVM 环境的新手）。

目前，我所有的测试都在一个`MyTest`扩展的类中`GroovyTestCase`。我可以用一个小 bash 脚本来运行它，比如

```
#! /bin/bash

DIR=$( cd "$( dirname "$0" )" && pwd )
LIBS="$DIR/lib/*"

groovy -cp "$LIBS" path/to/MyTest.groovy 
```

在这个布局中有很多我不喜欢的东西：

*   首先，我想将测试分成多个类并将它们加入一个测试套件，但是测试用例的优点是它可以在 Groovy 中自动运行
*   其次，正如我所说，我希望能够获得一份测试报告，供 Jenkins 使用
*   第三，我不知道将所有必需的 jar 放入一个`lib`目录是否是一种好习惯 - 可能不是。

Gradle 似乎正是我需要的工具。但是我找到的所有文档都假设以前对 Java、Ant、Maven 和整个生态系统有了解。

> 创建一个工作的 Gradle 项目的基本步骤是什么？

我已经按照[这里](http://www.gradle.org/docs/current/userguide/tutorial_groovy_projects.html)的建议重新组织了目录结构，但我不明白如何声明依赖项。例如这个 build.gradle

```
apply plugin: 'groovy'

repositories {
  mavenCentral()
}

dependencies {
  groovy group: 'org.codehaus.groovy', name: 'groovy', version: '1.8.0'
  runtime group: 'org.apache.log4j', name: 'log4j', version: '1.2.0'
} 
```

我得到错误

```
unable to resolve class org.apache.log4j.Level
 @ line 5, column 1.
   import org.apache.log4j.Level
   ^ 
```

如果我将存储库更改为

```
repositories {
  mavenCentral()
  flatDir { dirs 'lib' }
} 
```

`log4j`从我的`lib`目录中获取，我得到

```
A problem occurred evaluating root project 'alfred'.
Cause: Could not find method flatDir() for arguments [build_3urmo05tgpv3e97u7h8ij47i3$_run_closure1_closure3@64c7f7c4] on root project 'alfred'. 
```

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2012-07-17T16:30:48.427

直接的问题是您需要将 log4j 作为编译时依赖项导入。

解决方法是改变

```
runtime group: 'org.apache.log4j', name: 'log4j', version: '1.2.0' 
```

到

```
compile group: 'org.apache.log4j', name: 'log4j', version: '1.2.0' 
```

基本上，运行时依赖使代码在运行时可用（用于反射、传递依赖等），但在编译时不可用。如果您针对 log4j 进行编译，则需要编译时间。

编译时可用的一切在运行时自动可用。

您要做的下一件事是为您的 maven 样式的依赖项使用更简洁的语法。

```
group: 'org.apache.log4j', name: 'log4j', version: '1.2.0' 
```

可以表示为`'org.apache.log4j:log4j:1.2.0'`

和

```
group: 'org.codehaus.groovy', name: 'groovy', version: '1.8.0' 
```

可以表示为`'org.codehaus.groovy:groovy:1.8.0'`

把它们放在一起，你的 build.gradle 文件应该是这样的：

```
apply plugin: 'groovy'

repositories {
  mavenCentral()
}

dependencies {
  groovy 'org.codehaus.groovy:groovy:1.8.0'
  compile 'org.apache.log4j:log4j:1.2.0'
} 
```

# java - Java在Java中实例化Short对象

> ID：11526432
> 
> 赞同：18
> 
> 时间：2012-07-17T16:01:49.527
> 
> 标签：java, short

我想知道为什么我们可以这样做：

```
Long l = 2L;
Float f = 2f;
Double d = 2d; 
```

甚至

```
Double d = new Double(2); 
```

并不是

```
Short s = 2s; //or whatever letter it could be 
```

也不

```
Short s = new Short(2); //I know in this case 2 is an int but couldn't it be casted internally or something? 
```

为什么我们需要使用 String 或 short 构造函数。

* * *

## 回答 #1

> 赞同：13
> 
> 时间：2012-07-17T16:18:24.427

但是你*可以*这样做：

```
Short s = 2; 
```

或这个：

```
Short s = new Short((short)2); 
```

或这个：

```
Short s = new Short("2"); 
```

只要数字在 [-2^15, 2^15-1] 范围内，上述任何一项都将起作用

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2012-07-17T16:12:47.977

Java 的主要规则之一是任何数学运算的结果都将存储在一个大变量中以避免截断。例如，如果您将 int 与 long 相加，则结果将很长。因此，对 byte、char 或 short 的任何操作都会产生 int，即使您将 1 添加到一个字节。有 2 种方法可以将结果存储在相同的数据类型中：

a）您进行显式转换：

```
short s=10;  
s=(short)(s+1); 
```

b）您可以使用速记操作的自动增量来要求 JVM 进行隐式转换：

```
short s=10;  
s+=21; 
```

或者

```
short s=10;  
s++; 
```

* * *

如果您需要短文字或字节文字，则必须对它们进行强制转换，因为没有类似`S`or`s`的后缀`short`：

```
byte foo = (byte)100000;
short bar = (short)100000; 
```

# sql - 使用vba建表时如何指定主键

> ID：11526435
> 
> 赞同：3
> 
> 时间：2012-07-17T16:01:51.017
> 
> 标签：sql, ms-access, vba, recordset

我已经使用下面给出的建议更新了代码，我已经对其进行了测试并且效果很好，供未来用户快速参考。

* * *

我正在使用以下代码创建链接表，而无需为每个用户设置 DSN，我如何指定主键，因为如果手动连接会询问您：

```
Dim sConnect    As String
Dim db          As DAO.Database
Dim tdf         As DAO.TableDef

Set db = CurrentDb

Set tdf = db.CreateTableDef
tdf.Name = "dbo_vwFeedback" ' - -- --- This is the Label that you see in Access...
tdf.Connect = "ODBC;DRIVER=SQL Server;SERVER=server01\serverinstance;DATABASE=db_name;Trusted_Connection=Yes"
tdf.SourceTableName = "vwFeedback" ' - -- --- This is the actual name in SQL Server, minus the owner.
db.TableDefs.Append tdf
CurrentDb.Execute "CREATE UNIQUE INDEX PK_dbo_vwFeedback_PrimaryKey ON dbo_vwFeedback (DataSetID, FeedbackRef) WITH PRIMARY" 
```

注意：以上是针对 SQL Server VIEW 的，对于 SQL Server TABLE 是相同的，但您不需要该`CurrentDB.Execute`行（如果您的主键在服务器上正确设置）。

该代码代替了链接表并手动指定主键。

如果您未手动或使用上述方法指定为 SQL Server 视图创建索引，您将只能获得只读视图，并且您可能会遇到返回错误数据，请参阅下面的注释以获取示例。

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2012-07-17T18:59:04.370

将表格与问题中的代码链接后，您需要执行以下操作：

```
CurrentDb.Execute "CREATE UNIQUE INDEX SomeIndex ON SomeTable (PrimaryKeyColumn) WITH PRIMARY" 
```

有关完整示例，请参阅[添加带有主键的链接表的 VBA 代码。](https://stackoverflow.com/questions/9602687)

请注意，如果您链​​接**表，则****无需**执行此操作- Access 将自动检测主键（正如 Remou 在下面的评论中明确指出的那样）。

 **但是，当您在 Access 中链接 SQL Server**视图**时，为 Access中的视图指定正确的主键**非常重要。**
如果您指定了错误的键（= 您选择了不标识唯一记录的列）或根本没有键，Access 会将视图链接为只读表（正如您已经注意到的那样）。

另外，它会搞砸显示的行 - 请参阅[为什么链接视图会给出与 MS Access 和 SQL Manager 不同的结果？](https://stackoverflow.com/questions/7350928)更多解释。
*（阅读我的答案，**以及**我在另一个答案下的评论）***

# android - Android：HttpGet 中的 IllegalStateException

> ID：11526437
> 
> 赞同：1
> 
> 时间：2012-07-17T16:02:07.833
> 
> 标签：android, apache-httpclient-4.x

我正在尝试使用 发送`GET`请求`HttpClient`，但我不断收到`IllegalStateException`. 知道是什么原因造成的吗？我一直在寻找解决方案，但我不明白`"host=null"`日志中的含义。如何设置主机，它与路径有何不同？这是我的日志：

```
07-17 11:54:18.002: W/System.err(15422): java.lang.IllegalStateException: Target host must not be null, or set in parameters. scheme=null, host=null, path=google.com
07-17 11:54:18.002: W/System.err(15422):    at org.apache.http.impl.client.DefaultRequestDirector.determineRoute(DefaultRequestDirector.java:591)
07-17 11:54:18.002: W/System.err(15422):    at org.apache.http.impl.client.DefaultRequestDirector.execute(DefaultRequestDirector.java:293)
07-17 11:54:18.002: W/System.err(15422):    at org.apache.http.impl.client.AbstractHttpClient$1.executeRequestSending(AbstractHttpClient.java:609)
07-17 11:54:18.002: W/System.err(15422):    at org.apache.http.impl.client.naf.redirect.NafRequestExecutorWrapperRedirectionHandler.executeRequestSendingUsual(NafRequestExecutorWrapperRedirectionHandler.java:96)
07-17 11:54:18.002: W/System.err(15422):    at org.apache.http.impl.client.naf.redirect.NafRequestExecutorWrapperRedirectionHandler.executeRequestSending(NafRequestExecutorWrapperRedirectionHandler.java:73)
07-17 11:54:18.002: W/System.err(15422):    at org.apache.http.impl.client.naf.auth.NafHttpAuthStrategyDefault.sendFirstRequest(NafHttpAuthStrategyDefault.java:487)
07-17 11:54:18.002: W/System.err(15422):    at org.apache.http.impl.client.naf.auth.NafHttpAuthStrategyDefault.performAuthExecutionUnsafe(NafHttpAuthStrategyDefault.java:388)
07-17 11:54:18.002: W/System.err(15422):    at org.apache.http.impl.client.naf.auth.NafHttpAuthStrategyDefault.performAuthExecution(NafHttpAuthStrategyDefault.java:200)
07-17 11:54:18.002: W/System.err(15422):    at org.apache.http.impl.client.AbstractHttpClient.execute(AbstractHttpClient.java:558)
07-17 11:54:18.002: W/System.err(15422):    at org.apache.http.impl.client.AbstractHttpClient.execute(AbstractHttpClient.java:508)
07-17 11:54:18.002: W/System.err(15422):    at org.apache.http.impl.client.AbstractHttpClient.execute(AbstractHttpClient.java:486)
07-17 11:54:18.002: W/System.err(15422):    at myapp.httprequest.free.GETActivity$1sendRequestTask.doInBackground(GETActivity.java:102)
07-17 11:54:18.002: W/System.err(15422):    at myapp.httprequest.free.GETActivity$1sendRequestTask.doInBackground(GETActivity.java:1)
07-17 11:54:18.002: W/System.err(15422):    at android.os.AsyncTask$2.call(AsyncTask.java:264)
07-17 11:54:18.002: W/System.err(15422):    at java.util.concurrent.FutureTask$Sync.innerRun(FutureTask.java:305)
07-17 11:54:18.002: W/System.err(15422):    at java.util.concurrent.FutureTask.run(FutureTask.java:137)
07-17 11:54:18.002: W/System.err(15422):    at java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1076)
07-17 11:54:18.002: W/System.err(15422):    at java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:569)
07-17 11:54:18.002: W/System.err(15422):    at java.lang.Thread.run(Thread.java:856) 
```

和来源：

```
HttpClient getClient = new DefaultHttpClient();
HttpGet getData = new HttpGet(this.address);
try {
    HttpResponse gameResponse = getClient.execute(getData);
    return EntityUtils.toString(gameResponse.getEntity());
} catch (ClientProtocolException e) {
    e.printStackTrace();
} catch (IOException e) {
    e.printStackTrace();
} catch (IllegalStateException e) {
    e.printStackTrace();
} 
```

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-07-17T16:10:54.813

您必须添加`http://`到地址才能使其正常工作。如果您这样做，请避免使用[URLEncoder 。](http://docs.oracle.com/javase/1.4.2/docs/api/java/net/URLEncoder.html)

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-07-17T16:09:31.553

当你这样做时：

```
HttpGet getData = new HttpGet(this.address); 
```

究竟是`this.address`什么？我假设它是一个`String`，如果是这样，它需要看起来像这样：

```
String address = "http://www.google.com/path/to/document"; 
```

你可能已经这样做了：

```
String address = "google.com"; 
```

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-07-17T16:18:31.407

我认为您需要将 .addHeader 用于 HttpGet，例如以 Json 格式传输数据：

```
public class Client {

    private String server;

    public Client(String server) {
        this.server = server;
    }

    private String getBase() {
        return server;
    }

    public String getBaseURI(String str) {
        String result = "";
        try {
            DefaultHttpClient httpClient = new DefaultHttpClient();
            HttpGet getRequest = new HttpGet(getBase() + str);
            getRequest.addHeader("accept", "application/json");
            HttpResponse response = httpClient.execute(getRequest);
            result = getResult(response).toString();
            httpClient.getConnectionManager().shutdown();
        } catch (ClientProtocolException e) {
            e.printStackTrace();
        } catch (IOException e) {
            e.printStackTrace();
        }
        return result;
    }

    private StringBuilder getResult(HttpResponse response) throws IllegalStateException, IOException {

        StringBuilder result = new StringBuilder();
        BufferedReader br = new BufferedReader(new InputStreamReader((response.getEntity().getContent())), 1024);
        String output;
        while ((output = br.readLine()) != null) 
            result.append(output);
        return result;
    }
} 
```

我还建议您使用 timeoutConnection（直到建立连接）和 timeoutSocket（等待数据的超时。）有关更多信息，请查看：[Java jersey RESTful webservice requests](https://stackoverflow.com/questions/11479746/java-jersey-restful-webservice-requests/11479884#11479884)

另请注意，您需要在 API 级别 11 或更高级别的单独线程上实现网络连接。

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2014-11-07T05:56:43.393

这是您的主机错误您正在传递“www.host.com”而不是您必须通过“ [http://www.w3schools.com](http://www.w3schools.com) ”

参考帖在[这里](http://h3x.no/2010/11/22/httpclient-target-host-must-not-be-null-or-set-in-parameters)

# c# - 在多个进程之间拆分工作队列

> ID：11526443
> 
> 赞同：1
> 
> 时间：2012-07-17T16:02:37.410
> 
> 标签：c#, sql-server-2008, service-broker, sqldependency

我有一种情况，我认为工作队列和 SqlDependency 会很合适，但是我无法将它们拼凑在一起。

假设我有 1000 个实体，每个实体必须以不同的时间间隔（即 15、30 或 45 分钟）“处理”。我想在多个进程之间拆分工作，而不必每分钟轮询 SQL Server 以寻找更多工作。我已经阅读了很多与 SqlDependency / Query 通知相关的文章，但无法弄清楚如何对工作进行排队以及如何将每个进程限制为一组工作项。

我编写了一个 SqlDependency 查询，如下所示：

```
select f1, f2, etc from dbo.entity where LastRunDt < datediff(minute, 15, @dt) 
```

查询以 0 个结果运行，但是当 15 分钟过去了，这将导致此记录集发生更改（其中有更多项目），不会触发通知。我猜它不会以这种方式工作，所以我坚持如何让工作项排队。

另外..当我将 2 个进程附加到同一个工作队列时，每个进程都会收到通知（当我运行`select * from dbo.entity`SqlDependency 查询并更改记录时），但它们都收到相同的工作项。我需要在可用进程之间划分工作项，而不知道有多少个侦听器，可能是 2 个或 12 个，具体取决于哪些服务器在线以及哪些服务器离线以进行维护。

客户端将用 C# 编写。

任何已知的模式、想法或方向将不胜感激。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-07-17T19:02:06.913

听起来你需要某种消息队列。有一些常见的中间件包，如 NServiceBus。

您还可以使用 ServiceBroker，它以事务和快速的方式与 SQL Server 完美集成。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-07-17T19:27:25.317

您不需要在此处涉及查询通知。直接使用服务代理。

让您的 C# 应用程序发布[`WAITFOR(RECEIVE ...)`](http://msdn.microsoft.com/en-us/library/ms186963.aspx)语句以获取工作任务。当工作可用时，使用[`SEND`](http://msdn.microsoft.com/en-us/library/ms188407). 以安排将来使用的工作[`BEGIN CONVERSATION TIMER`](http://msdn.microsoft.com/en-us/library/ms187804)。

此外，Service Broker 可以帮助您实际激活您的 C# 代码，无论是作为内部托管存储过程（请参阅[Service Broker 激活](http://msdn.microsoft.com/en-us/library/ms171617%28v=sql.105%29.aspx)）还是作为外部独立应用程序（请参阅[Service Broker 外部激活](http://social.msdn.microsoft.com/Forums/en-US/sqlservicebroker/thread/36a58004-dbef-46ad-85a2-93563f3f8f0e)器）。

# java - 设置内容视图错误

> ID：11526444
> 
> 赞同：0
> 
> 时间：2012-07-17T16:02:38.357
> 
> 标签：java, android, android-linearlayout

我创建了名为 splash.xml 的新布局，如下所示并放入布局文件夹中。 ![在此处输入图像描述](../Images/cf3decd353b7ec7f875bf7453cc139e7.png)
然后我创建一个名为 Splash.java 的类，如下所示

```
 package com.example.buttonproj;
    import android.R;
    import android.app.Activity;
    import android.os.Bundle;

    public class Splash extends Activity {

    @Override
    protected void onCreate(Bundle savedInstanceState) {
        // TODO Auto-generated method stub
        super.onCreate(savedInstanceState);
        setContentView(R.layout.splash); //ERROR HERE

    }

} 
```

上有错误`setContentView(R.layout.splash)`。你能告诉我有什么问题吗？

* * *

## 回答 #1

> 赞同：14
> 
> 时间：2012-07-17T16:08:08.323

删除行：

```
import android.R; 
```

并验证您的 XML 文件没有任何错误。

Eclipse 有时会在资源文件出现编译错误并且您自动更新依赖项（例如使用`Ctrl`++ `Shift`）时导入它`O`。然后 Eclipse 尝试读取错误的 R 文件，该文件会在您引用的*任何地方造成严重破坏*`R.*`

找到根本原因（在 Package Explorer 窗口中，查找文件`res/`夹中带有红色*x*的所有文件）并清理您的项目（Project -> Clean）。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-07-17T16:11:00.320

您可以尝试删除

```
import android.R; 
```

并尝试从您的项目中导入 R。希望这可以帮助。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-07-17T16:20:34.963

感谢您的回答。

我将答案总结如下：

1.  有时 eclipse 拒绝识别你的 R。尝试完整的包名 - com.example.nuttonproj.R.layout.splash – mihail

或者

1.  删除

导入android.R；

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2012-07-17T16:10:00.917

1.  永远不要导入**android.R；**它将包括系统 R 组件而不是用户定义的。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2012-07-17T16:06:20.433

问题可能出在布局背景中：@drawable/abc。它是否存在于可绘制文件夹中？

# c# - 使用 ASP.NET 生成与 Visio 兼容的 XML (VDX)

> ID：11526453
> 
> 赞同：3
> 
> 时间：2012-07-17T16:03:04.053
> 
> 标签：c#, asp.net, visio

我需要创建一个网页 ( `.aspx`)，根据我的应用程序数据创建一个 Visio 兼容的 XML (VDX) 文件，并将其发送给用户。

我想：

*   使用 Visio 创建一次 .VDX 模板（将存储在`App_Data`文件夹中）
*   以编程方式加载模板，编辑 XML，将副本保存到`Public`文件夹中，为用户提供下载此文件的链接。

**我无法在网络服务器上安装 Visio，因此我必须使用 XML 并且无法使用 Visio Primary Interop Assembly。**

谷歌搜索，我找不到

*   **有关 Visio 使用的 XML 规则的**规范****
***   **适用于 VDX xml 的**示例代码*******   **可以帮助开发的**第 3 方 DLL********

 ****有人可以帮忙吗？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-07-18T11:19:58.697

还可以在 GitHub 上查看 Saveen Reddy 的 VisioAutomation 项目，它允许您在不需要 Visio 的情况下生成 VDX 文件：

[https://github.com/saveenr/VisioAutomation](https://github.com/saveenr/VisioAutomation)

更新 - 另一个资源是 Visio MVP，Al Edlund 的“xmlVisio”项目，也在 CodePlex 上：

[http://xmlvisio.codeplex.com/](http://xmlvisio.codeplex.com/)

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-07-17T16:35:23.823

我想这就是你一直在寻找的。

[http://msdn.microsoft.com/en-us/library/ff768724.aspx](http://msdn.microsoft.com/en-us/library/ff768724.aspx)

由于它是标准 XML，因此您可以使用其中的类`System.Xml`来修改从模板加载的 XML。您应该不需要使用 Visio 自动化，因此无需在 Web 服务器上安装 Visio。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-07-18T17:13:19.573

来自 Simon Halsey 和 JohnoGldsmith 的非常有趣的链接。
我发现 [Visio Guy](http://www.visguy.com/2006/11/30/visio-and-xml-conference-resources/)也很有趣。****

# jquery - Colorbox 似乎不适用于内联 div

> ID：11526455
> 
> 赞同：1
> 
> 时间：2012-07-17T16:03:11.653
> 
> 标签：jquery, model-view-controller, html, inline, colorbox

我有一个关于 Colorbox 的问题。

我正在尝试在颜色框中加载内联 div。我已经从随附的示例页面中复制粘贴了代码，但它根本不起作用——我不知道为什么；页面加载正确，颜色框打开，但里面没有内容。我将 MVC 与页眉、索引和页脚视图一起使用，脚本在页眉视图上，内联在索引视图上（调用颜色框的链接在页眉视图上）。知道为什么它不能工作吗？

（另外，我尝试了一些其他代码，使颜色框在页面加载时打开并且按预期工作。）

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-07-23T13:24:46.987

你的html应该是这样的。注意：div 先显示 none

然后是你的内容 div

```
    <div style="display: none"><div id="contentDiv">测试内容</div></div>

```

# symfony - SonataMediaBundle - 如何上传图片？

> ID：11526457
> 
> 赞同：16
> 
> 时间：2012-07-17T16:03:23.770
> 
> 标签：symfony, symfony-sonata, sonata-admin

可能应该标题为：“SonataMediaBundle - 缺少的方法在哪里？”。

我已经使用 sonataAdminBundle 和 sonataDoctrineORMAdminBundle（以及其他一些）创建了一些管理后端，大多数事情都按预期工作，但我将文件上传和处理留到以后，因为我想“这可能有多难？”。

长话短说 - 是否有任何关于最简单事物的文档 - 即将图像附加到帖子或条目，如何配置奏鸣曲管理类，如何以编辑形式显示图像缩略图等？

[文档](http://sonata-project.org/bundles/media/master/doc/reference/installation.html "文件")的第一页以“您可以访问您的管理仪表板”结尾，好像我可以期待那里有一些相关的变化，可能是媒体管理器启动并运行，或者其他什么。但这种情况并非如此。

下一页简要介绍了 heplers，然后是另一页，介绍了相当复杂的 vimeo 提供者案例研究。

我已经在整个网络上进行了搜索，我能想到的最好的方法是带有 ajax 弹出窗口的上传字段和上传文件的列表。

在我的管理课上，我有：

```
protected function configureFormFields(FormMapper $formMapper)
{
    $formMapper
    ->with('general')
        ->add('title')
        ->add('body')
        ->add('categories')
        ->end()
    ->with('media')
        ->add('images', 'sonata_type_model') 
```

在我的新闻课上：

```
/**
 * @ORM\ManyToMany(targetEntity="Application\Sonata\MediaBundle\Entity\Media")
 */
public $images; 
```

并且实现了所有 yaml 配置和路由。

结果是：`Fatal error: Call to a member function add() on a non-object in [some-entity].php`当尝试上传图像时，图像ID的可选列表带有“加号”（我猜是sonata_type_model字段）。

我被困住了。我能够在一两个小时内在普通的 sf2 中创建媒体“管理器”，但这是另一个项目，将当前项目重写为这种模式意味着“从头开始”。那么 - 为了使sonataMediaBundle 与sonataAdminBundle 一起按预期工作，该怎么做？

* * *

编辑：这就是我所做的：

我的新闻类（或任何其他需要上传图片的）：

```
<?php

namespace Some\SiteBundle\Entity;

use Doctrine\ORM\Mapping as ORM;
use Doctrine\Common\Collections\ArrayCollection;
use Symfony\Component\Validator\Constraints as Assert;

/**
 * Some\SiteBundle\Entity\News
 *
 * @ORM\Table(name="news")
 */
class News
{
    /**
     * @var integer $id
     *
     * @ORM\Column(name="id", type="integer")
     * @ORM\Id
     * @ORM\GeneratedValue(strategy="AUTO")
     */
    protected $id;      

    //some stuff...

  /**
    * @var Document documents
     * @ORM\ManyToMany(targetEntity="Document", cascade={"persist", "remove", "delete"} )
     **/
    protected $documents;

    public function __construct()
  {
    $this->documents = new ArrayCollection();

  }

[...]

    /**
     * Add documents
     *
     * @param Festus\SiteBundle\Entity\Document $documents
     */
    public function addDocument(\Festus\SiteBundle\Entity\Document $document)
    {
        $this->documents[] = $document;
    }

    /**
     * set document
     *
     * @param Festus\SiteBundle\Entity\Document $documents
     */
    public function setDocument(\Festus\SiteBundle\Entity\Document $document)
    {
        foreach ($this->documents as $doc) {
            $this->documents->removeElement($doc);
        }
        $this->documents[] = $document;
    }

    /**
     * Get documents
     *
     * @return Doctrine\Common\Collections\Collection 
     */
    public function getDocuments()
    {
        return $this->documents;
    }

    // setters, getters... 
```

我的文档类（需要更改表的名称，因为我在某些服务器上遇到了保留字的问题）：

```
<?php  

namespace Some\SiteBundle\Entity;

use Doctrine\ORM\Mapping as ORM;
use Doctrine\Common\Collections\ArrayCollection;
use Symfony\Component\Validator\Constraints as Assert;

/**
 * Some\SiteBundle\Entity\Document
 *
 * @ORM\Table(name="docs")
 * @ORM\Entity
 * @ORM\HasLifecycleCallbacks
 */
class Document
{
    /**
     * @ORM\Id
     * @ORM\Column(type="integer")
     * @ORM\GeneratedValue(strategy="AUTO")
     */
    private $id;

    /**
     * @ORM\Column(type="string", length=255)
     * @Assert\NotBlank
     */
    private $name;

    /**
     * @ORM\Column(type="string", length=255, nullable=true)
     */
    private $path;

    /**
     * @Assert\File(maxSize="6000000")
     */
    private $theFile;

    /**
     * @ORM\Column(type="datetime", name="created_at")
     * 
     * @var DateTime $createdAt
     */
    protected $createdAt;

    /**
     * @ORM\Column(type="integer")
     */
    private $type = 1;

    public function __construct()
      {
        $this->createdAt = new \DateTime();
      }

    public function getAbsolutePath()
    {
        return null === $this->path ? null : $this->getUploadRootDir().'/'.$this->path;
    }

    public function getWebPath()
    {
        return null === $this->path ? null : $this->getUploadDir().'/'.$this->path;
    }

    protected function getUploadRootDir()
    {
        // the absolute directory path where uploaded documents should be saved
        return __DIR__.'/../../../../web/'.$this->getUploadDir();
    }

    protected function getUploadDir()
    {
        // get rid of the __DIR__ so it doesn't screw when displaying uploaded doc/image in the view.
        return 'uploads/documents';
    }   

    /**
     * @ORM\PrePersist()
     * @ORM\PreUpdate()
     */
    public function preUpload()
    {
        if (null !== $this->theFile) {
            //var_dump($this);
            // do whatever you want to generate a unique name
            $this->path = uniqid().'.'.$this->theFile->guessExtension();
        }
    }

    /**
     * @ORM\PostPersist()
     * @ORM\PostUpdate()
     */
    public function upload()
    {
        if (null === $this->theFile) {
            return;
        }

        // if there is an error when moving the file, an exception will
        // be automatically thrown by move(). This will properly prevent
        // the entity from being persisted to the database on error
        $this->theFile->move($this->getUploadRootDir(), $this->path);

        unset($this->theFile);
    }

    /**
     * @ORM\PostRemove()
     */
    public function removeUpload()
    {
        if ($file = $this->getAbsolutePath()) {
            unlink($file);
        }
    }

    public function __toString()
      {
        return 'Document';
      }

    /**
     * Get id
     *
     * @return integer 
     */
    public function getId()
    {
        return $this->id;
    }

    /**
     * Set name
     *
     * @param string $name
     */
    public function setName($name)
    {
        $this->name = $name;
    }

    /**
     * Get name
     *
     * @return string 
     */
    public function getName()
    {
        return $this->name;
    }

    /**
     * Set file
     *
     * @param string $file
     */
    public function setTheFile($file)
    {
        $this->theFile = $file;
    }

        /**
     * Get file
     *
     * @return string 
     */
    public function getTheFile()
    {
        return $this->theFile;
    }

    /**
     * Set path
     *
     * @param string $path
     */
    public function setPath($path)
    {
        $this->path = $path;
    }

    /**
     * Get path
     *
     * @return string 
     */
    public function getPath()
    {
        return $this->path;
    }

    /**
     * Set type
     *
     * @param string $type
     */
    public function setType($type)
    {
        $this->type = $type;
    }

    /**
     * Get type
     *
     * @return string 
     */
    public function getType()
    {
        return $this->type;
    }

    /**
     * Gets an object representing the date and time the user was created.
     * 
     * @return DateTime A DateTime object
     */
    public function getCreatedAt()
    {
        return $this->createdAt;
    }

     /**
     * Gets an object representing the date and time the user was created.
     * 
     * @return DateTime A DateTime object
     */
    public function getCreatedAtString()
    {
        return date_format($this->createdAt, "Y-m-d");
    }

    /**
     * Set createdAt
     *
     * @param datetime $createdAt
     */
    public function setCreatedAt($createdAt)
    {
        $this->createdAt = $createdAt;
    }

} 
```

如您所见，大部分内容是从 symfony2 教程中复制而来的。

现在，对于控制器：

```
<?php 

namespace Some\SiteBundle;

use Some\SiteBundle\Form\Type\ImageShowType;
use Some\SiteBundle\Entity\Document;
use Sonata\AdminBundle\Admin\Admin;
use Sonata\AdminBundle\Datagrid\ListMapper;
use Sonata\AdminBundle\Datagrid\DatagridMapper;
use Sonata\AdminBundle\Validator\ErrorElement;
use Sonata\AdminBundle\Form\FormMapper;
use Sonata\AdminBundle\Show\ShowMapper;
use Symfony\Component\HttpFoundation\File\File;
use Symfony\Component\HttpFoundation\Request;

class NewsAdmin extends Admin
{

    public function __construct($code, $class, $baseControllerName) {
        parent::__construct($code, $class, $baseControllerName);

        $this->setFormTheme(array_merge($this->getFormTheme(),
            array('FestusSiteBundle:Form:image_form.html.twig')
        ));
    }

    protected function configureFormFields(FormMapper $formMapper)
    {
        $formMapper
        ->with('ogólne')
            ->add('title', NULL, array('label' => 'tytuł:'))
                ->add('body', NULL, array('label' => 'treść:', 'attr' => array(
                    'class' => 'tinymce', 'data-theme' => 'simple')))
                ->add('categories', NULL, array('label' => 'kategorie:'))
        ->end()
        ->with('media')
            ->add('fileName', 'text', array(
                    "label" => 'tytuł obrazka:',
                    'property_path' => false,
                        'required' => false
                ))
            ->add('theFile', 'file', array(
                    "label" => 'wybierz plik',
                    'property_path' => false,
                        'required' => false
                ))
            ->end()
        ;
    }

    protected function configureDatagridFilters(DatagridMapper $datagridMapper)
    {
        $datagridMapper
            ->add('title')
            ->add('body')
        ;
    }

    protected function configureListFields(ListMapper $listMapper)
    {
        $listMapper
            ->addIdentifier('title')
            ->add('categories')

            ->add('_action', 'actions', array(
                'actions' => array(
                    'view' => array(),
                    'edit' => array(),
                )
            ))
        ;
    }

    protected function configureShowFields(ShowMapper $showMapper)
    {
        $showMapper->add('title')
            ->add('body');

    }

    public function validate(ErrorElement $errorElement, $object)
    {
        $errorElement
            ->with('title')
                ->assertMinLength(array('limit' => 2))
            ->end()
        ;
    }

    public function prePersist($news) {
        $this->saveFile($news);
      }

      public function preUpdate($news) {
        $this->saveFile($news);
      }

      public function saveFile($news) {
        $request = Request::createFromGlobals();
        $requestData = current($request->request->all());
        $filesData = current($request->files->all());
        $document = new Document();
        $theFile = $filesData['theFile'];
        $name = $requestData['fileName'];

        if($theFile != NULL){
            $document->setName($name);
            $document->setTheFile($theFile);
            $news->setDocument($document);
        }
      }
} 
```

我的基础包类扩展了管理包类，我可以覆盖模板：

```
<?php

namespace Some\SiteBundle;

use Symfony\Component\HttpKernel\Bundle\Bundle;

class SomeSiteBundle extends Bundle
{

    public function getParent()
    {
        return 'SonataAdminBundle';
    }

} 
```

在`SomeSiteBundle/resources/views/CRUD/base_edit.html.twig`我稍微更改了模板以让用户看到当前设置的图片：

```
<div class="sonata-ba-collapsed-fields">                    
                    {% for field_name in form_group.fields %}
                        {% if admin.formfielddescriptions[field_name] is defined %}
                            {% if field_name == 'fileName' %}

                            <h5 style="margin-left: 40px">Obecny obrazek:</h5>
                            {% if object.documents[0] is defined %}
                                <img style="margin: 0 0 0 40px; border: 1px dotted #ccc" src="{{ asset(object.documents[0].webPath) }}" />
                                {% else %}
                                <div style="margin-left: 40px">brak</div>
                                {% endif %}
                                <hr><h5 style="margin-left: 40px">Wczytaj nowy:</h5>
                            {% endif %}
                            {{ form_row(form[field_name])}}
                        {% endif %}
                    {% endfor %}
                </div> 
```

现在我每条新闻只使用一张图片（“特色图片”），无论如何这有点矫枉过正，因为我使用的是带有 jbimages 插件的 tinyMCE，所以无论如何我都可以将图像放入新闻正文中。要使 jbimages 插件正常工作，您必须设置一些 tinyMCE 选项：

------ 这部分处理 tinymce 和 tinymce 包和 tinymce 插件： ---------

`$config['img_path'] = '/web/uploads/documents';`（或任何其他适合您的路径）在`web/bundles/stfalcontinymce/vendor/tiny_mce/plugins/jbimages/config.php`. （当然，您需要先安装 stfalcon tinymce bundle）。然后我进行了一些编辑以允许读取`web/bundles/stfalcontinymce/js/init.jquery.js`更多选项：`config.yml`

```
themeOptions.script_url = options.jquery_script_url;
            //mine:
            themeOptions.convert_urls = options.convert_urls;
            themeOptions.relative_urls = options.relative_urls;
            themeOptions.remove_script_host = options.remove_script_host;
            themeOptions.document_base_url = options.document_base_url; 
```

最后在`config.yml`：

```
[...]
stfalcon_tinymce:
    include_jquery: true
    tinymce_jquery: true
    textarea_class: "tinymce"
    relative_urls : false
    convert_urls : false
    remove_script_host : false
    document_base_url : "http://somesite.home.pl/web/"
    theme:
[...] 
```

这就是全部，AFAIR。希望这可以帮助 ;-）

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-11-27T12:25:18.517

也许您可以在以下位置找到您问题的答案：/admin/sonata/media/media/create?provider=sonata.media.provider.image&context=default

我对您的其他解决方案感兴趣，请发布代码。谢谢

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2015-10-28T10:04:10.520

考虑在单独的服务器上实施文件存储的最佳实践。它会发送什么文件或文件链接，您可以使用 Symfony byundle [https://packagist.org/packages/avtonom/media-storage-client-bundle](https://packagist.org/packages/avtonom/media-storage-client-bundle)

```
if($file instanceof UploadedFile){
    $this->get('avtonom.media_storage_client.manager')->sendFile($file, $clientName, $context);
} 
```

# html - MVC3 回发抛出“潜在危险的 Request.Form 值”HTML 错误

> ID：11526458
> 
> 赞同：0
> 
> 时间：2012-07-17T16:03:25.317
> 
> 标签：html, asp.net-mvc-2, save, ckeditor

我有一个 MVC3 C# .Net Web 应用程序。我们正在使用 CKEditor。我们将 CKEditor HTML 保存到数据库中的字段。插入时我们正在转义 HTML。IE

```
<strong> Effort estimated for the subtask elements</strong> 
```

变成

```
&lt;strong&gt; Effort estimated for the subtask elements &lt;/strong&gt; 
```

这工作正常。但是，在加载视图后在下拉 onchange 事件上重新发布视图时，我收到以下错误。

```
System.Web.HttpRequestValidationException: A potentially dangerous Request.Form value was detected from the client (TextBoeSbTkDescription="<p>
<strong>Exampl..."). 
```

加载页面时，文本框中的值从转义的 HTML 转换为非转义的。我在我的控制器动作中设置了一个断点，但在上述错误在 IE 中被删除之前它没有被执行。有什么想法可以解决这个问题吗？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-07-17T16:21:56.093

好的...我找到了答案，但我不知道它*为什么*有效。我在视图中有一些在下拉列表的 onchange 事件上运行的 javaScript。

```
function DDWkProdsOnChange(thisObj, selectedIndex) 
{
    document.getElementById('WkProdSeldTxt').value=thisObj.options[selectedIndex].text; 
    document.getElementById('pgSender').value='WkProdDD'; 
    thisObj.form.submit();
} 
```

我将表单提交更改为使用 jQuery：

```
function DDWkProdsOnChange(thisObj, selectedIndex) 
{
    document.getElementById('WkProdSeldTxt').value=thisObj.options[selectedIndex].text; 
    document.getElementById('pgSender').value='WkProdDD'; 
   $('form').submit();
} 
```

这解决了这个问题。我很想知道*为什么*。我看看是不是找不到答案

# java - Java，具有同步方法的多线程

> ID：11526460
> 
> 赞同：5
> 
> 时间：2012-07-17T16:03:34.620
> 
> 标签：java, multithreading

我有时无法让我的程序不死锁。我想我需要添加第三个同步方法释放，它可以用于在调用 ping 后释放另一个线程。代码如下。

```
// Attempt at a simple handshake.  Girl pings Boy, gets confirmation.
// Then Boy pings girl, get confirmation.
class Monitor {
    String name;

    public Monitor (String name) { this.name = name; }

    public String getName() {  return this.name; }

     // Girl thread invokes ping, asks Boy to confirm.  But Boy invokes ping,
    // and asks Girl to confirm.  Neither Boy nor Girl can give time to their
    // confirm call because they are stuck in ping.  Hence the handshake 
    // cannot be completed.
    public synchronized void ping (Monitor p) {
      System.out.println(this.name + " (ping): pinging " + p.getName());
      p.confirm(this);
      System.out.println(this.name + " (ping): got confirmation");
    }

    public synchronized void confirm (Monitor p) {
       System.out.println(this.name+" (confirm): confirm to "+p.getName());
     }
}

class Runner extends Thread {
    Monitor m1, m2;

    public Runner (Monitor m1, Monitor m2) { 
      this.m1 = m1; 
      this.m2 = m2; 
    }

    public void run () {  m1.ping(m2);  }
}

public class DeadLock {
    public static void main (String args[]) {
      int i=1;
      System.out.println("Starting..."+(i++));
      Monitor a = new Monitor("Girl");
      Monitor b = new Monitor("Boy");
      (new Runner(a, b)).start();
      (new Runner(b, a)).start();
    }
} 
```

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2012-07-17T16:17:53.450

当某些操作需要获得两个不同的锁时，确保没有死锁的唯一方法是确保尝试执行这些操作的每个线程都以相同的顺序获取多个对象上的锁。

要修复死锁，您需要像这样修改代码 - 不漂亮，但它有效。

```
 public void ping (Monitor p) {
  Monitor one = this;
  Monitor two = p;
  // use some criteria to get a consistent order
  if (System.identityHashCode(one) > System.identityHashCode(two)) {
    //swap
    Monitor temp = one;
    one = two;
    two = one;
  }
  synchronized(one) {
       synchronized(two) {
           System.out.println(this.name + " (ping): pinging " + p.getName());
           p.confirm(this);
           System.out.println(this.name + " (ping): got confirmation");
        }
  }
} 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-07-17T17:47:45.663

这是棘手的事情。我会制作 Monitor.name `volatile`，或将其与自己的锁定对象同步。或者最好的：让它`final`。然后`synchronized`从您的两种方法中删除关键字。除了“名称”之外，没有任何东西不是线程安全的。

否则，在需要之前不要同步。使用同步块，而不是方法。除非需要，否则不要将任何内容放入同步块中。如果可以，在单独的锁定对象上单独同步字段。不要嵌套同步块，但如果您必须始终以相同的顺序嵌套它们；具有同步对象的层次结构。

同步所有方法是保持线程安全的一种简单、方便的技术。但是，当您的线程开始交互时，很容易死锁或只是减慢速度。然后它变得有趣。

# php - 如何响应api调用然后在php中执行代码

> ID：11526461
> 
> 赞同：-1
> 
> 时间：2012-07-17T16:03:34.767
> 
> 标签：php, api, codeigniter, response

我必须连接说明：

> 我们的系统将事件发送到您的应用程序，它以期望立即回复但不等待所有处理发生的方式这样做。收到事件后，系统会立即回复我们的系统，说明已收到消息。确认事件调用随后表明该事件已由第三方处理。我们的系统每天必须处理数百万个事件，等待第三方完成事件处理，而分发事件会导致不必要的延迟。

现在我遇到了一个问题，因为我不明白如果我在第一行使用 return 关键字，我如何立即响应他们的服务器，我已经获取了他们的数据，那么它将不会执行它之后的代码，在其他情况下他们必须等待让我的过程完成。

我尝试过使用 echo 1。但它不起作用。

注意：为了成功响应，我必须将 1 作为整数发送，让他们知道我已经获得了他们的数据

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-07-17T16:13:24.903

```
<?php
header('This');
header('That');
echo 1;
flush();

//all your other code....

?> 
```

# sql - 2个以上表之间的SQL关系

> ID：11526467
> 
> 赞同：0
> 
> 时间：2012-07-17T16:04:14.073
> 
> 标签：sql, where

假设我有一张客户表 ( `tblClients`) 和一张报价表 ( `tblQuotes`)。

为了从我们现有的客户那里获得所有报价，我做了以下事情：

```
SELECT q.quoteId, c.contact, q.job, 
FROM tblQuotes AS q 
INNER JOIN tblClients AS c ON q.user = c.user 
```

对于每个报价，我们得到了报价的创建日期。那个日期在`tblDate`. 我发现显示该日期的唯一方法是当我显示我的记录时，我做了一个像这样的其他请求：

```
SELECT Date 
FROM tblDate 
WHERE id = %1  =>  %1 is q.quoteId 
```

一切正常，但我决定添加交替 SQL 请求的输入。例如，`c.Contact`可以是“约翰”

```
WHERE c.Contact = 'John' 
```

怎么样`Date`？我可以很容易地得到`q.quoteId`，但我不知道如何让它与 Date 一起工作`c.Contact`。`q.Job`

```
WHERE c.Contact = 'John' AND ... 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-07-17T16:07:54.363

只需添加另一个联接（使用 INNER JOIN 假设每个报价都有一个日期值）：

```
SELECT 
    q.quoteId, c.contact, q.job, d.Date
FROM 
    tblQuotes AS q INNER JOIN 
        tblClients AS c ON q.user = c.user INNER JOIN
            tblDate AS d on d.id = q.quoteId 
```

然后，您可以使用该`WHERE`子句进行相应修改以指定任何附加条件：

```
SELECT 
    q.quoteId, c.contact, q.job, d.Date
FROM 
    tblQuotes AS q INNER JOIN 
        tblClients AS c ON q.user = c.user INNER JOIN
            tblDate AS d on d.id = q.quoteId
WHERE
    d.Contact = 'John' 
```

# android - Android 上的 XmlPullParser XML

> ID：11526469
> 
> 赞同：2
> 
> 时间：2012-07-17T16:04:19.450
> 
> 标签：android, xml, parsing

我正在尝试从 Android 解析一些 XML。下面是 XML 的一些示例：

```
<updates at="1342481821" found="616" sorting="latest_updates" showing="Last 4D">
<show>
    <id>
        3039
    </id>
    <last>
        -14508
    </last>
    <lastepisode>
        -14508
    </lastepisode>
</show>
<show>
    <id>
        30612
    </id>
    <last>
        -13484
    </last>
    <lastepisode>
        163275
    </lastepisode>
</show> 
```

等等....

这是实际的代码：

```
try {
    XmlPullParserFactory factory = XmlPullParserFactory.newInstance();
    factory.setNamespaceAware(true);
    XmlPullParser xpp = factory.newPullParser();
    URL url = new URL("http://services.tvrage.com/feeds/last_updates.php?hours=" + hours);
    InputStream stream = url.openStream();
    xpp.setInput(stream, null);
    int eventType = xpp.getEventType();

    while (eventType != XmlPullParser.END_DOCUMENT) {
        if (eventType == XmlPullParser.START_DOCUMENT) {
        } 
        else if (eventType == XmlPullParser.END_DOCUMENT) {
        } 
        else if (eventType == XmlPullParser.START_TAG) {
            if (xpp.getName().equalsIgnoreCase("id")) {
                showIds.add(Integer.parseInt(xpp.nextText()));
            } 
            else if (eventType == XmlPullParser.END_TAG) {
            } 
            else if (eventType == XmlPullParser.TEXT) {
            }
            eventType = xpp.next();
        }
    }
} catch 
```

... 等等

这没有结果，并且`eventType`始终`0`在调试器中。示例 URL 在浏览器中运行良好。有任何想法吗？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-07-17T16:15:03.797

你只`xpp.next()`在 `eventType == XmlPullParser.START_TAG`. 将`xpp.next`其向下移动一行，以便它始终执行。

```
while (eventType != XmlPullParser.END_DOCUMENT) {
        if (eventType == XmlPullParser.START_DOCUMENT) {
        } 
        else if (eventType == XmlPullParser.END_DOCUMENT) {
        } 
        else if (eventType == XmlPullParser.START_TAG) {
            if (xpp.getName().equalsIgnoreCase("id")) {
                showIds.add(Integer.parseInt(xpp.nextText()));
            } 
            else if (eventType == XmlPullParser.END_TAG) {
            } 
            else if (eventType == XmlPullParser.TEXT) {
            }
            // eventType = xpp.next(); <-- remove it
        }
        eventType = xpp.next(); // <-- move here
    }
} catch 
```

# asp.net - asp.net vb 中的全局函数

> ID：11526471
> 
> 赞同：0
> 
> 时间：2012-07-17T16:04:25.050
> 
> 标签：asp.net, vb.net

我需要在我的 asp.net 4 VB 网站的每个页面中导入一些全局函数。

global.asax 是否适合编写这些函数？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-07-17T16:05:45.203

诺普斯

在 App_code 文件夹中创建类文件，并在该创建函数中创建应用程序中的所有页面都可用。

如果您想直接访问该函数而不创建在您的类文件中创建静态函数的类对象，它将为您完成工作。

或者

创建类库并在其中创建类/函数，并在项目中使用该库，这也将允许您在所有页面类文件中访问该类库函数。

# java - 带有 x11forwarding 的 Jsch shell 命令 - 重用通道并运行新命令

> ID：11526478
> 
> 赞同：1
> 
> 时间：2012-07-17T16:04:42.367
> 
> 标签：java, ssh, jsch

我需要运行 ssh 命令来打开 GUI 应用程序。我能够让 Jsch 运行命令，并且 GUI 显示在客户端计算机上。我的问题是我似乎无法超过 20 个 Jsch 频道。我意识到服务器有一个设置来控制用户可以建立的 ssh 连接数，这里似乎是 20。我不明白的是如何重用现有连接但运行不同的命令....

我尝试以两种不同的方式运行命令：

```
EXAMPLE Command:  

String command = "cd /home/test;xterm ";
String command = "cd /home/test;nedit myfile.txt "; 
```

"1 way") 每个运行命令都会创建一个新的 Jsch 通道：

```
private void connect (String command) {    
    Channel channel = session.getChannel("shell");
    channel.setXForwarding(true);
    StringBufferInputStream reader = new StringBufferInputStream(command + " \n");
    channel.setInputStream(reader);
    channel.connect();
} 
```

[ 此代码为每个新命令创建一个新通道。有效，但达到 20 ssh 连接限制。]

或者

“另一种方式”）试图重用通道来运行一个新命令，其中通道是一个全局变量：

```
int numruns =0;
private void connect (String command, int channelId)    {
    String cmd = command + " \n";
    if (channel == null) {
        numruns = 0;
        channel = session.openChannel("shell");
        channel.setXForwarding(true);
        channel.connect();
        stdIn = channel.getOutputStream();
        stdOut = channel.getInputStream();
    } else {
        channel.connect(channelId);
    }
    ((OutputStream)stdIn).write(cmd.getBytes());
    stdIn.flush();
    numruns++;
} 
```

[“其他方式”打开应用程序，但它似乎创建了新的 ssh 连接。所以我仍然有 20 个 ssh 连接限制。]

所以看起来服务器只允许最多 20 个 ssh 连接。但是为什么它不能与“其他方式”一起使用？

所以当我关闭我的 GUI 应用程序时，它似乎并没有释放 ssh 连接，因为它仍然认为我已经用尽了，所以我在 channel.connect(); 上得到了 JschException；

我的问题是所有命令都会打开 GUI 应用程序，所以我不知道该应用程序何时关闭以关闭通道连接。

我编写了“其他方式”方法，认为它不会创建新的 ssh 连接，但应该允许我使用现有连接但发送新命令。显然它不是那样工作的。

调用 connect(command) 时，如何使用一个 ssh 连接运行不同的命令？Jsch有可能吗？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-07-18T17:21:10.963

未解决！以下工作到一定程度。它隐藏了一个事实，即一旦 Jsch 通道连接关闭，任何“xterm”都不再具有显示信息。

======================================

为了防止在通道断开连接时 GUI 消失，需要在命令之前使用“nohup”或“xterm -hold -e”来启动命令

所以...

示例命令：

```
String command = "cd /home/test;xterm";
String command = "cd /home/test;nohup nedit myfile.txt";  // this will only keep the GUI opened
String command = "cd /home/test;xterm -hold -e gedit myfile.txt";  // this one keeps the xterm window that kick off the program opened 
```

因此，在对命令进行更改后，添加了 Thread.sleep(1000)，因此在断开通道之前给应用程序时间来启动。

这似乎有效！

```
private void connect (String command) {    
    Channel channel = session.getChannel("shell");
    channel.setXForwarding(true);
    StringBufferInputStream reader = new StringBufferInputStream(command + " \n");
    // or use
    // ByteArrayInputStream reader = new ByteArrayInputStream((command + " \n").getBytes());
    channel.setInputStream(reader);
    channel.setOuputStream(System.out);
    channel.connect();
    try {
        Thread.sleep(1000); // give GUI time to come up
    } catch (InterruptedException ex) {
        // print message
    }
    channel.disconnect();
} 
```

# java - Windows服务中的无限循环

> ID：11526482
> 
> 赞同：2
> 
> 时间：2012-07-17T16:05:04.363
> 
> 标签：java, windows-services

我有一个奇怪的问题，我的麦克风时不时会自动静音。所以我决定编写一个 Windows 服务，如果它被静音，它将取消静音。这是所有代码：

```
import javax.sound.sampled.*;

public class Unmute
{
    public static void main(String[] args)
    {
        unmute();
    }

    public static void unmute() {
        Line.Info[] thisLineArr;
        Line.Info thisLineInfo;
        Line thisLine;
        BooleanControl mute;
        Mixer.Info[] infos = AudioSystem.getMixerInfo();
        try {
            while (true) {          
                for (Mixer.Info info: infos)  
                {  
                    Mixer mixer = AudioSystem.getMixer(info);
                    if (mixer.isLineSupported(Port.Info.MICROPHONE))  
                    {  
                        thisLineArr = mixer.getTargetLineInfo();              
                        thisLineInfo = thisLineArr[0];
                        thisLine = mixer.getLine(thisLineInfo);
                        thisLine.open();
                        for (Control thisControl : thisLine.getControls()) {
                            if (thisControl.getType().equals(BooleanControl.Type.MUTE)) {
                                mute = (BooleanControl)thisLine.getControl(BooleanControl.Type.MUTE); 
                                if(mute.getValue()) {
                                    mute.setValue(false);
                                }
                            }
                        }
                        thisLine.close();
                    }  
                }
                Thread.sleep(1 * 1000);
            }
        } catch (Exception e) {
            System.out.println(e);
        }

    }

} 
```

我使用 Java Service Wrapper 并将此代码作为服务安装。一切正常，但困扰我的是我在主函数中的无限循环。有一个无限循环是否可以，或者有更好的解决方案来解决我的问题？

# c# - 对象列表，获取带分隔符的属性

> ID：11526484
> 
> 赞同：4
> 
> 时间：2012-07-17T16:05:09.137
> 
> 标签：c#, list

```
public class Person
{
    public int Id { get; set; }
    public string FirstName { get; set; }
    public string LastName { get; set; }
} 
```

我有一个清单：

```
List<Person> list = new List<Person>(); 
```

我想用逗号分隔列表中所有条目的 Id 值，如下所示：*id1、id2、id3*

* * *

## 回答 #1

> 赞同：12
> 
> 时间：2012-07-17T16:06:06.333

使用[string.Join](http://msdn.microsoft.com/en-us/library/dd783876.aspx)连接值并使用[Enumerable.Select](http://msdn.microsoft.com/en-us/library/system.linq.enumerable.select.aspx)连接到选定的所需值：

```
string allIds = string.Join(", ", list.Select(i => i.Id.ToString())); 
```

# wordpress - Wordpress - 使用 postname 时防止图像文件重写

> ID：11526488
> 
> 赞同：1
> 
> 时间：2012-07-17T16:05:17.717
> 
> 标签：wordpress, .htaccess

我在管理员永久链接设置中将Wordpress 设置为按**帖子名重写。**

我对画廊中的图像使用根路径，例如，

```
/wp-content/themes/bones/images/portfolio/house.jpg 
```

但是图像正在被重写以从帖子名称开始，例如，

```
http://mysite.dev/design/wp-content/themes/bones/images/portfolio/house.jpg 
```

...因此得到 404 响应。

如何更改我的访问文件以阻止这种情况发生？这是访问文件：

```
# BEGIN WordPress
<IfModule mod_rewrite.c>
RewriteEngine On
RewriteBase /
RewriteRule ^index\.php$ - [L]
RewriteCond %{REQUEST_FILENAME} !-f
RewriteCond %{REQUEST_FILENAME} !-d
RewriteRule . /index.php [L]
</IfModule>
# END WordPress 
```

我不想使用图像的完整 URL，这就是我想要一个 htaccess 文件解决方案的原因。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-07-22T23:33:34.917

永久链接设置仅适用于您的页面/博客等 - 不适用于您在帖子或模板中使用的链接。

如果您在帖子中使用 /images/portfolio/house.jpg，它们肯定会**添加**到您所在位置的当前 URL，例如，如果您在[http://mysite.dev/design/](http://mysite.dev/design/)上，它将是[http://mysite.dev/design/wp-content/themes/bones/images/portfolio/house.jpg](http://mysite.dev/design/wp-content/themes/bones/images/portfolio/house.jpg)。

因此，在您的帖子中，您可以尝试：

```
<img src="../wp-content/themes/bones/images/portfolio/house.jpg"> 
```

（这不是很漂亮）或使用**完整的 URL**（这是 wordpress 默认的）

在您的模板中使用：

```
<?php echo get_bloginfo('template_url'); ?>/images/portfolio/house.jpg 
```

# google-analytics - 如何将同一目的地但路径不同的漏斗分开

> ID：11526490
> 
> 赞同：0
> 
> 时间：2012-07-17T16:05:28.530
> 
> 标签：google-analytics

我在 Google Analytics 中设置了两个目标渠道。一个跟踪用户从礼品登记到结账的过程，看起来像这样：

1.  第 1 步：/gift-registry.aspx
2.  第 2 步：/Checkout/Basket.aspx
3.  第 3 步：/Checkout/Details.aspx
4.  第 3 步：/Checkout/Confirm.aspx

另一种是非礼品注册表或定期结帐，类似于：

1.  第 1 步：/Checkout/Basket.aspx
2.  第 2 步：/Checkout/Details.aspx
3.  第 3 步：/Checkout/Confirm.aspx

麻烦的是，我看到两者的交易和转化率完全相同。我猜这是因为最后 3 个步骤在两者中都是相同的。有没有办法区分来​​自礼品注册表的转换与常规购买？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-07-18T09:27:41.480

您可以将目标漏斗中的某些步骤设置为“强制”。您单击 GA 中步骤旁边的小框。这能解决吗？

# php - symfony2 中作为服务使用的 sphinx php api 类出错

> ID：11526491
> 
> 赞同：1
> 
> 时间：2012-07-17T16:05:31.213
> 
> 标签：php, symfony, sphinx

我在 symfony2 项目中使用 sphinx php api 作为服务，当我想在索引中搜索一个词时，我收到了这个警告

**警告：在 /var/www/domain.com/Symfony2/src/project/myBundle/services/SphinxClient.php 第 997 行中为 foreach() 提供的参数无效**

这是第 997 行

```
foreach ( $this->_weights as $weight ) 
```

所以我在 foreach() 之前添加了一个测试 if(!empty($this->_weights))

每个 foreach 都会出现相同的错误，所以我添加了相同的测试。

然后出现另一个错误

**注意：未定义的属性：prject\MyBundle\services\SphinxClient::$_socket 在 /var/www/domain.com/Symfony2/src/project/myBundle/services/SphinxClient.php 行 563**

我花了几个小时寻找问题的根源。

提前感谢您的帮助。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-02-07T07:33:37.480

在 sphinxapi.php 文件中使用了旧的构造函数。

```
Delete string ( near 430 )

function SphinxClient() 
```

和写：

```
public function __construct() 
```

一切都很好。

不要忘记在文件中设置命名空间（我将 sphinxapi.php 重命名为 SphinxClient.php）并在 begin 中写入：

```
namespace Acme\MyBundle\Sphinx; 
```

你的路径可能是别的东西。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-07-23T13:37:48.567

没有看到文件的来源，没有太多的帮助。

在 sphinx 附带的标准 sphinxapi.php 类中，变量都是类变量，所以 $this->_weigths 是一个数组。也许当它被安装到 Symfony 时错过了

# c# - 需要检查委托方法的值

> ID：11526495
> 
> 赞同：1
> 
> 时间：2012-07-17T16:06:14.537
> 
> 标签：c#, .net, httpruntime

我需要将具有不同数量和类型的参数的委托方法传递给另一个方法。我希望能够检查调用中参数的值。

这是我的通用缓存类。

```
public T Get<T>(Expression<Func<T>> getItemCallback) where T : class
{

    T item = HttpRuntime.Cache.Get(hashRepresentationOfValues) as T;
    if (item == null)
    {
        item = getItemCallback.Compile()();
        HttpRuntime.Cache.Insert(
            hashRepresentationOfValues,
            item,
            null,
            DateTime.Now.AddMinutes(5),
            TimeSpan.Zero);
    }
    return item;
 } 
```

我的电话如下所示：

```
private DataContext db;
return cache.Get<List<SomeDBObject>>(
    () => db.SomeDBObjectCall(param1, param2, param3)); 
```

如您所见，如果我可以动态确定委托调用的值，那将非常有帮助，因为它们可以用作缓存键。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-07-17T16:15:44.057

所以基本上，你有一个带有未知签名的方法，你想包装它以进行缓存。如果是这样的话，你肯定会想研究一种叫做**记忆的技术**

[维基百科上](http://en.wikipedia.org/wiki/Memoization) 的记忆 在计算中，记忆是一种优化技术，主要用于通过函数调用避免重复计算先前处理的输入的结果来加速计算机程序。

C# 中这样一个函数的一个例子是这样的：

```
static Func<A, R> Memoize(this Func<A, R> f)
{
    var dict = new Dictionary<A, R>();
    return (A arg)=>
    {
        R result;
        if (!dict.TryGetValue(arg, out result))
        {
             result = f(arg);
             dict.Add(arg, result);
        }
        return result;
    };
} 
```

请注意，该方法采用泛型 Func 并返回具有相同签名的泛型 Func。这样，您可以有效地包装您的方法，而不会阻塞其余代码。真是天衣无缝！

更多示例[在这里](http://explodingcoder.com/blog/content/painless-caching-memoization-net)和[这里](http://rogeralsing.com/2008/06/04/net-stateful-delegates-and-memoization/)

# entity-framework - 文字或常量首先作为 EF 代码中的复合键的一部分

> ID：11526497
> 
> 赞同：8
> 
> 时间：2012-07-17T16:06:21.073
> 
> 标签：entity-framework, entity-framework-4.1, ef-code-first

我对实体框架的代码优先方法相对较新。我使用 Database First 方法已有一段时间了，但 Code First 似乎更适合我目前正在开发的应用程序。我正在使用现有的 MS SQL 数据库，并且不允许对数据库进行任何更改。我使用 Code First 的原因是因为 Fluent API 允许我为类动态分配表名。

也就是说，我有一个困境，我需要在 2 个表之间分配关系。一个表 ArCodes 有一个由 CodeType 和 Code（都是字符串）组成的复合键。CodeType 列确定代码的类型，Code 列是代码类型的唯一标识符。

```
public class ArCode {

    [Column("cod_typ", Order = 0), Key]
    public string CodeType { get; set; }

    [Column("ar_cod", Order = 1), Key]
    public string Code { get; set; }

    [Column("desc")]
    public string Description { get; set; }

} 
```

另一个表 Invoices 需要与 ArCodes 表的“ship via”代码和“terms”代码都有关系。

```
public class Invoice {
    [Column("pi_hist_hdr_invc_no"), Key]
    public int InvoiceNumber { get; set; }

    [Column("shp_via_cod")]
    public string ShipViaCode { get; set; }

    public ArCode ShipVia { get; set; }

    [Column("terms_cod")]
    public string TermsCode { get; set; }

    public ArCode Terms { get; set; }

} 
```

我想为“ShipVia”属性和“Terms”属性设置关系。但是，我不确定如何针对复合键的 CodeType 部分执行此操作。对于“ship via”代码，代码类型应为“S”，代码“terms”代码，代码类型应为“T”。

我在 DB Context 中尝试了以下操作，但没有成功：

```
 protected override void OnModelCreating(DbModelBuilder modelBuilder) {
        // setup the table names
        modelBuilder.Entity<ArCode>().ToTable("ARCODS" + CompanyCode);
        modelBuilder.Entity<Invoice>().ToTable("IHSHDR" + CompanyCode);

        //
        // setup the relationships
        //

        // 1 Invoice <--> 0-1 Ship Via AR Codes
        modelBuilder.Entity<Invoice>()
            .HasOptional(invoice => invoice.ShipVia)
            .WithMany()
            .HasForeignKey(invoice => new { TheType = "S", invoice.ShipViaCode })
            ;

        base.OnModelCreating(modelBuilder);
    } 
```

任何帮助，将不胜感激。

## 更新#1

好的，我将代码简化为最简单的形式，并遵循@GertArnold 提供的解决方案。

```
public abstract class ArCode {

    [Column("cod_typ")]
    public string CodeType { get; set; }

    [Column("ar_cod")]
    public string Code { get; set; }

    [Column("terms_desc")]
    public string TermsDescription { get; set; }

    [Column("terms_typ")]
    public string TermsType { get; set; }

    [Column("shp_via_desc")]
    public string ShipViaDescription { get; set; }

    [Column("tax_desc")]
    public string TaxDescription { get; set; }

}

public class TermsCode : ArCode { }
public class ShipViaCode : ArCode { }

public class Invoice {
    [Column("pi_hist_hdr_invc_no"), Key]
    public int InvoiceNumber { get; set; }

    [Column("hdr_invc_dat")]
    public DateTime InvoiceDate { get; set; }

    [Column("shp_via_cod")]
    public string ShipViaCode { get; set; }

    public ShipViaCode ShipVia { get; set; }

    [Column("terms_cod")]
    public string TermsCode { get; set; }

    public TermsCode Terms { get; set; }

    public Invoice() {
    }

}

public class PbsContext : DbContext {

    public DbSet<Invoice> Invoices { get; set; }

    protected override void OnModelCreating(DbModelBuilder modelBuilder) {

        modelBuilder.Entity<Invoice>().ToTable("IHSHDR");

        modelBuilder.Entity<ArCode>().HasKey(r => r.Code).ToTable("ARCODS");

        modelBuilder.Entity<TermsCode>().Map(m => m.Requires("CodeType")
               .HasValue("T").HasColumnType("varchar").HasMaxLength(1).IsRequired())
               .ToTable("ARCODS");
        modelBuilder.Entity<ShipViaCode>().Map(m => m.Requires("CodeType")
               .HasValue("S").HasColumnType("varchar").HasMaxLength(1).IsRequired())
               .ToTable("ARCODS");

        base.OnModelCreating(modelBuilder);
    }

    public PbsContext()
        : base("name=PbsDatabase") {
    }
} 
```

但是，以下代码返回错误：

```
PbsContext context = new PbsContext();
var invoice = context.Invoices.OrderByDescending(r => r.InvoiceDate).FirstOrDefault(); 
```

> 错误 3032：从第 28 行开始映射片段时出现问题：条件成员 'ArCode.cod_typ' 的条件不是 'IsNull=False' 被映射。删除 ArCode.cod_typ 上的条件或将其从映射中删除。

如果我从 ArCode 类中删除“CodeType”列，并在 OnModelCreating 事件中将所有“CodeType”引用更改为“cod_typ”的数据库列名，那么上面的语句将毫无错误地执行。然而，invoice.ShipVia 和 invoice.Terms 都将是空事件，尽管数据库中有匹配的记录。

## 更新#2

```
public abstract class ArCode {

    [Column("ar_cod")]
    public string Code { get; set; }

    [Column("terms_desc")]
    public string TermsDescription { get; set; }

    [Column("terms_typ")]
    public string TermsType { get; set; }

    [Column("shp_via_desc")]
    public string ShipViaDescription { get; set; }

    [Column("tax_desc")]
    public string TaxDescription { get; set; }

}

public class TermsCode : ArCode { }
public class ShipViaCode : ArCode { }

public class Invoice {
    [Column("pi_hist_hdr_invc_no"), Key]
    public int InvoiceNumber { get; set; }

    [Column("hdr_invc_dat")]
    public DateTime InvoiceDate { get; set; }

    [Column("shp_via_cod")]
    public ShipViaCode ShipVia { get; set; }

    [Column("terms_cod")]
    public TermsCode Terms { get; set; }

    public Invoice() {
    }

}

public class PbsContext : DbContext {

    public DbSet<Invoice> Invoices { get; set; }

    protected override void OnModelCreating(DbModelBuilder modelBuilder) {

        modelBuilder.Entity<Invoice>().ToTable("IHSHDR");

        modelBuilder.Entity<ArCode>().HasKey(r => r.Code).ToTable("ARCODS");

        modelBuilder.Entity<TermsCode>().Map(m => m.Requires("CodeType")
               .HasValue("T").HasColumnType("varchar").HasMaxLength(1).IsRequired())
               .ToTable("ARCODS");
        modelBuilder.Entity<ShipViaCode>().Map(m => m.Requires("CodeType")
               .HasValue("S").HasColumnType("varchar").HasMaxLength(1).IsRequired())
               .ToTable("ARCODS");

        base.OnModelCreating(modelBuilder);
    }

    public PbsContext()
        : base("name=PbsDatabase") {
    }
} 
```

现在，以下代码返回错误：

```
PbsContext context = new PbsContext();
var invoice = context.Invoices.OrderByDescending(r => r.InvoiceDate).FirstOrDefault(); 
```

> EntityCommandExecutionException - 列名“ShipVia_Code”无效。列名“Terms_Code”无效。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-07-18T07:30:38.977

你想要的对EF来说是不可能的。`ArCode`有一个复合键，因此与它的任何关联都必须使用两个属性。这意味着`Invoice`您需要四个属性（两对）来引用这两个`ArCode`对象。但是其中两个属性（那些 for `CodeType`）没有由数据库中的列备份，因此 EF 无法映射它们。

但是......有一种方法可以帮助你。您可以创建两个派生类，`ArCode`并`Invoice`通过单属性关联引用这些派生类。但是你必须从模型中转移出来，并通过定义一个键来愚弄 EF：

```
public abstract class ArCode { ... } // abstract!

public class TermsCode : ArCode { }

public class ShipViaCode : ArCode { }

protected override void OnModelCreating(DbModelBuilder modelBuilder)
{
    modelBuilder.Entity<Invoice>().ToTable("IHSHDR");

    modelBuilder.Entity<Invoice>().HasOptional(i => i.Terms).WithOptionalDependent().Map(m => m.MapKey("terms_cod"));
    modelBuilder.Entity<Invoice>().HasOptional(i => i.ShipVia).WithOptionalDependent().Map(m => m.MapKey("shp_via_cod"));

    modelBuilder.Entity<ArCode>().HasKey(a => a.Code).ToTable("ARCODS");
    modelBuilder.Entity<TermsCode>().Map(m => m.Requires("CodeType")
        .HasValue("T").HasColumnType("varchar").HasMaxLength(1).IsRequired())
        .ToTable("ARCODS");
    modelBuilder.Entity<ShipViaCode>().Map(m => m.Requires("CodeType")
        .HasValue("S").HasColumnType("varchar").HasMaxLength(1).IsRequired())
        .ToTable("ARCODS");

    base.OnModelCreating(modelBuilder);
}

public class Invoice
{
    [Column("pi_hist_hdr_invc_no"), Key]
    public int InvoiceNumber { get; set; }

    public ShipViaCode ShipVia { get; set; }

    public TermsCode Terms { get; set; }
} 
```

如果您不必`ARCODS`通过 EF 插入记录，这可能对您有用。`Code`尽管数据库允许，但它不允许您插入具有相同 s 的记录。但我希望 的内容`ARCODS`相当稳定，也许用脚本填充它就足够了。

# python - 如何在 Python 中共享没有 is-a 关系的属性？

> ID：11526499
> 
> 赞同：3
> 
> 时间：2012-07-17T16:06:29.903
> 
> 标签：python, properties

我有许多描述层次结构的 Python 类型，因为它们在属性方面越来越具体。与其试图用语言来描述它，不如举一个例子：

```
class A:
    @property
    def prop1(self):
        return self._prop1

class B:
    @property
    def prop1(self):
        return self._prop1

    @property
    def prop2(self):
        return self._prop2

class C:
    @property
    def prop1(self):
        return self._prop1

    @property
    def prop2(self):
        return self._prop2

    @property
    def prop3(self):
        return self._prop3 
```

因此，当您查看类列表时，`B`具有的所有属性`A`以及一些额外的属性。`C`具有的所有属性，`B`然后是一些额外的属性，依此类推。如果可能的话，我想尽量减少上述定义的重复。

一个明显的解决方案是使用继承，创建`B`一个子类`A`等等。但是，这些类型的语义不遵循 is-a 关系；我不想`isinstance(bObject, A)`成为`True`。Python中是否有另一种方法可以直接允许这种属性共享而不使用子类？

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2012-07-17T16:10:07.030

您可以使用装饰器：

```
def has_prop1(cls):
    @property
    def prop1(self):
        return self._prop1

    cls.prop1 = prop1

    return cls

@has_prop1
class A(object):
    pass 
```

合成会是这样的：

```
@has_prop1
@has_prop2
class B(object):
    pass 
```

甚至像这样：

```
def has_many_properties(cls):
    return has_prop1(has_prop2(has_prop3(cls)))

@has_many_properties
class C(object):
    pass 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-07-17T18:47:40.047

你说“我不想撒谎说 C 是 A 而实际上不是。类型的特征不符合子类化的语义。” 对于您的模糊示例，尚不清楚要走哪条路。

如果您之所以这么说是因为其中有`class A`不适用于的附加功能`class C`，那么我将组合地取出该类的属性部分，因此您分别拥有`A`, `B`,`C`包含`AProps`,`BProps`和`CProps`, 并为属性类提供适当的继承关系。

如果没有这样的附加功能，并且属性以您显示的方式构建不仅仅是巧合，那么请在脑海中重命名`class A`为`class ProvidesProp1`，注意`class C`is-a 提供的类`prop1`，并因此接受`class C`is-a `class A`。

# objective-c - “合并”核心数据模型

> ID：11526502
> 
> 赞同：2
> 
> 时间：2012-07-17T16:06:34.723
> 
> 标签：objective-c, ios, core-data

由于它有点难以解释，我将举例说明：

假设 Model V1 有一个名为 Names 的实体，在它的第一个版本中只有一个名为 name 的属性；在模型的第二个版本中，现在是 Model V2，它还具有 lastName 属性。由于新模型架构中同时具有 name 和 lastName 属性，因此它不会接受任何没有这些属性的 SQLite(?) 或 Model。所以我想要的是尝试根据 MappingModels 或任何其他类型的迁移将 Model V1 合并到 Model V2 匹配字段中。

所以我的问题是，我可以做我刚才解释的事情，还是需要遍历所有 Model V1 属性并手动将它们与当前模型的最新属性匹配？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-07-17T17:05:32.533

[您可以通过轻量级迁移](http://developer.apple.com/library/ios/#documentation/Cocoa/Conceptual/CoreDataVersioning/Articles/vmLightweightMigration.html#//apple_ref/doc/uid/TP40004399-CH4-SW1)轻松做到这一点。非常简单，无需代码。

另一个问题是您将如何处理已经存在的数据。我认为它是一个包含名字和姓氏的字符串。您必须设计一种算法，将第一个与最后一个分开并修改新字段。在这种情况下，您确实必须遍历数据。但是这个细节将适合另一个问题。

# c# - NHibernate 隐式保存？

> ID：11526503
> 
> 赞同：0
> 
> 时间：2012-07-17T16:06:38.697
> 
> 标签：c#, nhibernate

我在使用 NHibernate 时遇到了一些奇怪的行为，我不知道我是否只是误解了会话和事务的工作方式。

行为是我正在打开一个会话，为该会话启动一个事务。然后我使用会话检索对象集合，以某种方式操作对象，然后提交事务。在这个过程中，我没有在会话上调用 Save 或 Update，但它隐式地保存了会话中对象的状态。

这是适当的行为吗？我正在为我的会话使用包装器，这就是它总是打开并提交事务的原因。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-07-17T16:15:49.973

看看 Flush、FlushMode 和 IsDirty。这在您操作集合时很常见。

如果您更改集合中的项目或将指针从一个集合更改为新集合，则 Nhibernate 会在刷新时通过 IsDirty 进行扫描。

# javascript - 最小和最大日期

> ID：11526504
> 
> 赞同：165
> 
> 时间：2012-07-17T16:07:02.163
> 
> 标签：javascript, datetime, max

`Date`我想知道 Javascript对象允许的最小日期和最大日期是哪个。我发现最小日期大约是公元前 200000 年，但我找不到任何关于它的参考资料。

有人知道答案吗？我只是希望它不依赖于浏览器。

“纪元时间”（= 1970-01-01 00:00:00 UTC+00 的毫秒数）的答案是最好的。

* * *

## 回答 #1

> 赞同：202
> 
> 时间：2012-07-17T16:10:35.160

根据[规范，§15.9.1.1](http://ecma-international.org/ecma-262/5.1/#sec-15.9.1.1)：

> Date 对象包含一个数字，该数字指示特定的瞬间，精确到毫秒。这样的数字称为时间值。时间值也可能是 NaN，表示 Date 对象不代表特定的时间瞬间。
> 
> 自 1970 年 1 月 1 日 UTC 以来，时间在 ECMAScript 中以毫秒为单位进行测量。在时间值中，闰秒被忽略。假设每天正好有 86,400,000 毫秒。ECMAScript Number 值可以表示从 –9,007,199,254,740,992 到 9,007,199,254,740,992 的所有整数；该范围足以测量从 1970 年 1 月 1 日 UTC 起大约 285,616 年（向前或向后）内的任何时刻的毫秒精度。
> 
> ECMAScript Date 对象支持的实际时间范围略小：相对于 1970 年 1 月 1 日 UTC 开始时的午夜，精确地测量 –100,000,000 天到 100,000,000 天。这为 1970 年 1 月 1 日 UTC 的任一侧提供了 8,640,000,000,000,000 毫秒的范围。
> 
> UTC 时间 1970 年 1 月 1 日开始的午夜的确切时刻由值 +0 表示。

第三段是最相关的。根据该段，我们可以从 获得每个规范的准确最早日期`new Date(-8640000000000000)`，即公元前 271,821 年 4 月 20 日星期二（BCE =[共同时代](https://en.wikipedia.org/wiki/Common_Era)之前，例如，-271,821 年）。

* * *

## 回答 #2

> 赞同：74
> 
> 时间：2017-05-05T00:24:02.160

为了增加 TJ 的答案，超过最小/最大值会生成一个无效日期。

```
let maxDate = new Date(8640000000000000);
let minDate = new Date(-8640000000000000);

console.log(new Date(maxDate.getTime()).toString());
console.log(new Date(maxDate.getTime() - 1).toString());
console.log(new Date(maxDate.getTime() + 1).toString()); // Invalid Date

console.log(new Date(minDate.getTime()).toString());
console.log(new Date(minDate.getTime() + 1).toString());
console.log(new Date(minDate.getTime() - 1).toString()); // Invalid Date
```

* * *

## 回答 #3

> 赞同：8
> 
> 时间：2021-06-02T16:20:51.983

对已接受答案的小修正；最小日期的年份实际上是 271,82 **2** BCE，正如您在运行以下代码段时看到的那样：

```
console.log(new Date(-8640000000000000).toLocaleString("en", {"year": "numeric", "era": "short"}))
```

事实上，-271,821 年实际上是公元前 271,822 年，因为 JavaScript `Date`（连同[ISO 8601](https://en.wikipedia.org/wiki/ISO_8601)）使用[天文年份编号](https://en.wikipedia.org/wiki/Astronomical_year_numbering)，它使用零年。因此，第 1 年是公元 1 年，第 0 年是公元前 1 年，-1 年是公元前 2 年，等等。

* * *

## 回答 #4

> 赞同：-11
> 
> 时间：2018-07-30T09:57:20.910

如您所见，01/01/1970 返回 0，这意味着它是可能的最低日期。

```
new Date('1970-01-01Z00:00:00:000') //returns Thu Jan 01 1970 01:00:00 GMT+0100 (Central European Standard Time)
new Date('1970-01-01Z00:00:00:000').getTime() //returns 0
new Date('1970-01-01Z00:00:00:001').getTime() //returns 1 
```

# ssh-tunnel - 通过 ssh 转发网络连接，以便我的出站 IP 更改

> ID：11526508
> 
> 赞同：1
> 
> 时间：2012-07-17T16:07:12.603
> 
> 标签：ssh-tunnel

服务，例如 FTP 服务器，只接受来自特定网络的连接，所有用户都将拥有相同的外部 IP 地址。

我想连接到此服务，但我目前不在允许的网络内。

我可以通过 ssh 访问网络内的服务器。

如何使用 ssh 将某个端口从我的本地机器通过内部网络上的机器传送到最终服务，以便任何打开正确端口的客户端都不会注意到任何差异？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-07-19T07:49:24.563

您可以使用以下命令创建到特定网络的 SSH 隧道。例如，假设您想访问计算机“mywebserver”（端口 80）上的 Web 服务。

*   在 Linux 或 BSD 下，使用 OpenSSH，您可以使用以下命令行：

ssh -f mysshserver -L 1234:mywebserver:80 -N

*   在 Windows 下，您可以使用[MobaXterm](http://mobaxterm.mobatek.net)，它包含一个简单的图形化 ssh 隧道构建器

这将在本地端口 1234 和端口 80 上的远程 Web 服务器之间打开一个 SSH 隧道。然后您可以打开 Web 浏览器并通过在地址栏中键入“http://localhost:1234”直接连接到您的 Web 服务器。

# ajax - 基于 ajax 的应用程序没有活动访问令牌

> ID：11526509
> 
> 赞同：0
> 
> 时间：2012-07-17T16:07:16.190
> 
> 标签：ajax, facebook-graph-api, facebook-iframe, facebook-access-token, facebook-authorization

我正在开发一个包含 2 个文件的应用程序：

1.  index.php（应用程序容器）
2.  process.php（在 ajax 中调用）

索引.php

```
<?php
    include 'config.php';
    include 'lib/functions.php';
    require_once 'lib/sdk/facebook.php';

    $facebook = new Facebook(array(
        'appId'  => APP_ID,
        'secret' => SECRET
    ));

    $userID = $facebook->getUser();

    if (!$userID)
    {
         $scope = 'read_stream, publish_stream, user_likes, user_photos, user_status, friends_hometown, friends_location, friends_likes, photo_upload';

         $params = array(
             'scope'        => $scope,
             'redirect_uri' => "https://apps.facebook.com/".APP_NAME."/"
         );

         $loginUrl = $facebook->getLoginUrl($params);
    }
    else 
    {
        $access_token = $facebook->getAccessToken();
    }
?>
<!doctype html>
<html xmlns:fb="http://www.facebook.com/2008/fbml">
    <head>
        <title>Facebook App</title>
        <meta http-equiv="Content-Type" content="text/html;charset=utf-8" />
        <link href="/css/style.css" rel="stylesheet" type="text/css" media="screen" />
        <script type="text/javascript" src="/js/jquery.js"></script>
    </head>

    <body style="margin:0 !important; padding: 0 !important;">

        { SOME HTML }

        <script type="text/javascript">
             function loadData()
             {
                  $.ajax({
                      url: "process.php",
                      type: 'POST',
                      cache: false,
                      data: {
                          id_sessione: function(){return $("#id_sessione").val();}
                      },
                      dataType: "json",
                      success: function(data) {
                          if (data.status == "FAILURE")
                              alert('failure');
                          else
                              console.log(data);
                      }
                  });
             }

             /********* INIT ********/
             $(document).ready(function(){
                 if ($("#userID").val() != "0")
                     loadData();
                 else
                     top.location = '<?php echo $loginUrl; ?>';
             });
         </script>

         <input id="id_sessione" type="hidden" value="<?php echo session_id(); ?>" />
         <input id="userID" type="hidden" value="<?php echo $userID; ?>" />

         <div id="fb-root"></div>
         <script type="text/javascript">
             window.fbAsyncInit = function() {
                 FB.init({
                      appId: '<?php echo APP_ID; ?>',
                      frictionlessRequests: true
                 });

                 FB.Canvas.setAutoResize(7);
             };

             (function() {
                 var e = document.createElement('script');
                 e.async = true;
                 e.src = document.location.protocol +
                     '//connect.facebook.net/it_IT/all.js';
                     document.getElementById('fb-root').appendChild(e);             
             }());
          </script>
      </body>
 </html> 
```

和 process.php

```
<?php
    session_id($_POST['id_sessione']);
    session_start();

    include 'config.php';
    include 'lib/functions.php';
    require_once 'lib/sdk/facebook.php';

    set_time_limit(120);
    $memory_limit = ini_set('memory_limit', '512M');

    try
    {
        $facebook = new Facebook(array(
            'appId'  => APP_ID,
            'secret' => SECRET
        ));

        $userID = $facebook->getUser();

        $user_profile = $facebook->api('/me');

        { SOME FQL QUERIES AND DATA PROCESSING }

        echo json_encode(array(
            'status' => 'SUCCESS',
            .... other info
        ));
     } catch (Exception $e) {

         $handle = fopen(ROOT_PATH.'/log/'.$userID.'_'.uniqid().'.txt', 'a+') or die('Cannot open file');
         fwrite($handle, $e->getMessage()."\n");
         fwrite($handle, $e->getTraceAsString()."\n");
         fclose($handle);

         echo json_encode(array(
             'status'   => 'FAILURE'
         ));
      } 
```

在 95% 的情况下，应用程序运行良好，但有时 $facebook->api('/me'); 引发异常“**必须使用活动访问令牌来查询有关当前用户的信息。** ”并且 $userID 等于 0。

为了在所有文件中拥有相同的会话 ID，我必须使用 POST 中 index.php 传递的 session_id 手动启动会话。这是因为某些浏览器（IE、safari）不会在 iframe 中传递第三方页面的 cookie。（http://stackoverflow.com/questions/9930671/safari-3rd-party-cookie-iframe-trick-no-longer-working）

有什么建议么？谢谢

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-07-18T22:46:51.060

检查会话值是否正确传递？

# geocoding - 将地理空间数据从 SQL Server 导出到 ArcGIS？

> ID：11526512
> 
> 赞同：1
> 
> 时间：2012-07-17T16:07:19.013
> 
> 标签：geocoding, arcgis

我对 ArcGIS 不太熟悉，但是是否可以从 SQL Server 中以 ArcGIS 可以轻松导入的格式导出地理空间数据？ArcGIS 是否有专有格式？

我对购买 ArcServer 不感兴趣（我不认为），我只想让我的数据（通过 Web 服务）暴露给使用 Arc 的客户端。

谢谢

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-07-18T08:36:11.087

如果您使用的是 ArcMap 10.0 版本，则使用查询图层功能将 SQL Server 空间表数据添加到 ArcMap 10 中。使用“文件->添加数据->添加查询图层..”界面。使用它您可以连接到 SQL Server 空间表并将它们添加到 ArcMap 中。添加到 ArcMap 后，您可以将这些数据转换为 Shape 文件格式（ESRI ArcGIS 工具常用的 GIS 数据文件）。这种方法有一定的局限性。

另一种方法是使用 ogr2ogr 工具查看链接了解更多详情

[http://alastaira.wordpress.com/2011/09/29/exporting-spatial-data-from-sql-server-to-esri-shapefile/](http://alastaira.wordpress.com/2011/09/29/exporting-spatial-data-from-sql-server-to-esri-shapefile/)

# apache - 如何保护 cakephp 网站的一部分以进行阶段部署？

> ID：11526514
> 
> 赞同：1
> 
> 时间：2012-07-17T16:07:40.413
> 
> 标签：apache, .htaccess, cakephp, basic-authentication

我有一个由网站 URL 和 API 的 URL 组成的 cakephp 项目，比如：

*   [http://myproject.com/controller1/someaction](http://myproject.com/controller1/someaction)
*   [http://myproject.com/controller2/someotheraction](http://myproject.com/controller2/someotheraction)
*   [http://myproject.com/api/controller1/someapiaction](http://myproject.com/api/controller1/someapiaction)

对于生产部署，网站和 API 都使用 cakephp 的方法处理身份验证和授权。

我想将整个项目部署在临时服务器上。在那里，网站应该受到 HTTP 身份验证保护，而 API 应该不受保护（因为我不想将身份验证添加到 API 使用者）。我不想更改项目的源代码或配置，而是通过 Apache 配置解决它。

我尝试了几种 vhost 配置，基本上遵循这个方案：

```
 <LocationMatch "/api/.*">
           Order allow,deny
           Allow from all
           Satisfy any
   </LocationMatch>

   <Location />
           Order allow,deny
           Allow from all
           AllowOverride all

           AuthType Basic
           AuthName "myproject"
           AuthUserFile /path/to/.htpasswd
           AuthGroupFile /path/to/.htgroup
           Require group mytesters
   </Location> 
```

我还尝试混合位置和目录指令，对两个部分使用 Location 或 LocationMatch，对 LocationMatch 使用否定正则表达式，对两个部分使用单独的虚拟主机，...... - 这些都不起作用：整个站点都受到保护，或者什么都没有。

我是不是真的错了，还是不可能（由于 Apache 或 cakephp 处理重写的方式）？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-07-17T21:11:21.060

尝试以下配置：

```
<Directory /path/to/your/htdocs>
    AuthType Basic
    AuthName "myproject"
    AuthUserFile /path/to/.htpasswd
    AuthGroupFile /path/to/.htgroup
    Require valid-user

    AllowOverride AuthConfig
</Directory>

<Location "/api">
    Satisfy any
</Location> 
```

# perl - 您是否应该检查 Getopt::Long::GetOptions 的返回码？

> ID：11526517
> 
> 赞同：8
> 
> 时间：2012-07-17T16:07:52.757
> 
> 标签：perl, getopt, getopt-long

我刚刚在代码审查中第一次被要求检查对Perl 模块`GetOptions()`函数的调用的返回代码。`Getopt::Long`

我不记得曾经见过这样的`GetOptions()`功能测试。

那么人们通常不检查此函数的返回码是否有特定的原因？

* * *

## 回答 #1

> 赞同：11
> 
> 时间：2012-07-17T16:18:29.890

人们不检查`GetOptions`函数返回值的一个原因是他们想在不使用[Getopt::Long](http://perldoc.perl.org/Getopt/Long.html)的情况下处理未指定的选项（通过在调用`@ARGV`后直接 解析）。`GetOptions`或者，也许他们只是想忽略未指定的选项。或者，也许他们没有意识到该`GetOptions`功能可能会失败。

我总是检查返回值，因为我喜欢在命令行中发现拼写错误。检查的标准方法是使用[Pod::Usage](http://perldoc.perl.org/Pod/Usage.html) Core 模块（参见 POD 示例代码）。另请参阅：[动态二重奏 -- 或 -- Holy Getopt::Long、Pod::UsageMan！](http://www.perlmonks.org/?node_id=155288)

# bash - 在 bash shell 脚本中检查目录的问题

> ID：11526523
> 
> 赞同：0
> 
> 时间：2012-07-17T16:08:04.427
> 
> 标签：bash, shell, ubuntu, batch-file

我正在编写一个批处理脚本 bash，它需要首先检查文件夹是否存在以了解是否运行将创建和填充文件夹的某个 python 脚本。之前我做过类似的事情，可以很好地更改目录并从存储的变量中查找目录，但由于某种原因，我只是在这里遗漏了一些东西。

以下是脚本的大致工作方式。

```
if [ -d "$net_output" ]
then
    echo "directory exists"
else
    echo "directory does not exist"
fi 
```

当我运行这个脚本时，我通常会在前面的行中回显 $net_output 以查看它将评估为什么。当脚本运行时，我得到我的 else 代码块，说“目录不存在”，但是当我将之前回显的 $net_output 目录路径复制并粘贴到 shell 终端时，它改变了目录就好了，证明目录事实上确实存在。我在戴尔机器上使用 Ubuntu 12.04。

预先感谢您提供的任何帮助。让我知道我可以提供哪些其他信息。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-07-17T18:43:02.523

当有人发布这样的问题时，我遇到的最常见的情况如下：

**1.**变量包含文字引号。Bash 不会递归解析引号，它只解析命令行上给出的“外部”引号。

```
$ mkdir "/tmp/dir with spaces"
$ var='"/tmp/dir with spaces"'
$ echo "$var"
"/tmp/dir with spaces"
$ [ -d "/tmp/dir with spaces" ]; echo $?
0
$ [ -d "$var" ]; echo $?  # equivalent to [ -d '"/tmp/dir with spaces"' ]
1 
```

**2.**变量包含相对路径，当前目录不是你所期望的。检查`echo "$PWD"`输出的值是否符合您的预期。

**3.**变量是从带有 dos 行结尾的文件中读取的，CRLF (\r\n)。Unix 和类 unix 系统仅使用 LF (\n) 作为行尾。如果是这种情况，路径将在末尾包含一个 CR (\r)。行尾的 CR 在终端中将是“不可见的”。`printf '%q\n' "$var"`在调试脚本时检查。请参阅[BashFAQ 52](http://mywiki.wooledge.org/BashFAQ/052)以了解如何摆脱它们。

# c++ - 如何将static_assert与sizeof和stringify结合起来？

> ID：11526526
> 
> 赞同：23
> 
> 时间：2012-07-17T16:08:20.163
> 
> 标签：c++, visual-studio-2010, c++11, stringify, static-assert

内存使用在我的应用程序中非常关键。因此，我有特定的断言，在编译时检查内存大小，如果大小与我们之前认为正确的大小不同，则给出一个 static_assert 。

我已经定义了一个这样的宏：

```
#define CHECKMEM(mytype, size) static_assert((sizeof(objectType) == size)), "Size incorrect for " #mytype "!"); 
```

这个宏使得写这个很容易：

```
CHECKMEM(Book,144);
CHECKMEM(Library,80); 
```

问题是，当这个 static_assert 关闭时，可能很难找出新的大小应该是多少（例如，通过使用隐藏的编译器选项“/d1 reportAllClassLayout”）。如果我可以包括实际尺寸会更方便，所以而不是：

> 书的尺寸不正确！

它会显示

> 书的尺寸不正确！（预期 144，大小为 152）

我试着写这样的东西：

```
#define CHECKMEM(mytype, size) static_assert((sizeof(objectType) == size)), "Size incorrect for " #mytype "! (expected" #size ", size is " #sizeof(mytype) ")"); 
```

但是您不能在函数调用中使用字符串化 (#) 运算符。

我还尝试添加双字符串化技巧，如下所示：

```
#define STR1(x) #x 
#define STR2(x) STR1(x) 
#define CHECKMEM(mytype, size) static_assert((sizeof(objectType) == size)), "Size incorrect for " #mytype "! (expected" #size ", size is " STR2(sizeof(mytype)) ")"); 
```

但不是打印`size is 152`，而是打印`size is sizeof(Book)`.

有没有办法在 static_assert 中对 sizeof 的结果进行字符串化？

* * *

## 回答 #1

> 赞同：26
> 
> 时间：2012-07-17T16:49:32.553

我会在函数模板上使用调度来进行检查：

```
#include <cstddef>

template <typename ToCheck, std::size_t ExpectedSize, std::size_t RealSize = sizeof(ToCheck)>
void check_size() {
  static_assert(ExpectedSize == RealSize, "Size is off!");
}

struct foo
{
  char bla[16];
};

int main()
{
  check_size<foo, 8>();
  return 0;
} 
```

结果是：

```
In instantiation of ‘void check_size() [with ToCheck = foo; long unsigned int ExpectedSize = 8ul; long unsigned int RealSize = 16ul]’:
bla.cpp:15:22:   required from here
bla.cpp:5:1: error: static assertion failed: Size is off! 
```

调试信息在回溯的模板参数中。

如果这真的更好，您将不得不做出决定，这也取决于编译器。它还使您能够使用模板图隐藏预期的大小，总结为最大大小和其他花哨的东西。

* * *

## 回答 #2

> 赞同：5
> 
> 时间：2012-07-17T16:21:56.890

根据您的编译器，模板可能会有所帮助：

```
template<int s, int t> struct check_size {
  static_assert(s == t, "wrong size");
};
check_size<2+2, 5> doubleplusungood; 
```

gcc 输出：

```
prog.cpp: In instantiation of 'check_size<4, 5>':
prog.cpp:5:20:   instantiated from here
prog.cpp:2:3: error: static assertion failed: "wrong size" 
```

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2012-07-17T16:35:41.600

正如您所发现的，问题就在这里（另见这个[非常相似的问题](https://stackoverflow.com/q/11233596/476681)）：

```
#define CHECKMEM(mytype, size)  #sizeof(mytype) 
```

这是不可能的，因为字符串化是由预处理器完成的，并且 sizeof 在编译期间被评估。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2019-12-31T20:02:12.243

如果您可以稍微修改结构的定义并且不介意一些丑陋，这是一个替代的仅标头解决方案。

```
template <int RealSize = 0, int ExpectedSize = 0>
struct _MyStruct {
    static_assert(RealSize == ExpectedSize, "size is invalid");

    int x;
};

typedef _MyStruct<sizeof(_MyStruct<>), 4> MyStruct; 
```

铿锵输出：

```
prog.cpp:4:5: error: static_assert failed "size is invalid"
    static_assert(RealSize == ExpectedSize, "size is invalid");
    ^             ~~~~~~~~~~~~~~~~~~~~~~~~
prog.cpp:12:14: note: in instantiation of template class '_MyStruct<4, 8>' requested here
    MyStruct m; 
```

这里需要注意的是，只有在某处实例化类型时才会进行检查——仅使用指针不会触发错误，因此绝对不适合所有情况！

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2021-01-26T20:45:28.640

一个简单实用的解决方案是使用 2 `static_assert`-s：

```
#define CHECKMEM(mytype, size) \
static_assert( sizeof(mytype) <= (size), "Size of " #mytype " is greater than " #size "!" ); \
static_assert( sizeof(mytype) >= (size), "Size of " #mytype " is less than "    #size "!" ) 
```

# java - 在 Android 中使用 WebView

> ID：11526528
> 
> 赞同：0
> 
> 时间：2012-07-17T16:08:24.287
> 
> 标签：java, android, webview

我有以下代码，但是当我运行它时，它告诉我“http://www.google.com”不可用，这完全是垃圾。如果我在没有`HelloWebViewClient`全班的情况下运行代码，它会正确打开 google，但在预装的 Android 浏览器中除外。我想在应用程序中打开它。谢谢。

我的代码：

```
public class MainActivity extends Activity {    
    Button btnGo;
    Editable guiNumber;
    WebView webView;

    @Override
    public void onCreate(Bundle savedInstanceState) {
        super.onCreate(savedInstanceState);
        setContentView(R.layout.activity_main);

        btnGo = (Button) findViewById(R.id.btnGo);
        webView = (WebView) findViewById(R.id.viewWeb);

        webView.setVisibility(View.GONE);
        webView.setWebViewClient(new HelloWebViewClient());
        webView.getSettings().setJavaScriptEnabled(true);

        btnGo.setOnClickListener(new OnClickListener() {
            public void onClick(View v) {
                guiNumber = enterGUI.getText();

                if (guiNumber.length() == 8) {
                    guiNumber.replace(4, 8, "");
                    gui = Integer.parseInt(enterGUI.getText().toString());
                    System.out.println(gui);

                    InputMethodManager imm = (InputMethodManager) getSystemService(Activity.INPUT_METHOD_SERVICE);
                    imm.toggleSoftInput(InputMethodManager.HIDE_IMPLICIT_ONLY, 0);

                    webView.setVisibility(View.VISIBLE);
                    webView.requestFocus();
                    webView.loadUrl("http://google.com");
                }
                else {
                    enterGUI.setError("Your GUI/ILGU number must be 8 digits long");
                }
            }
        });
    }

    private class HelloWebViewClient extends WebViewClient {

          public boolean shouldOverrideUrlLoading(WebView view, String url) {
           view.loadUrl(url);
           return true;
          }
    }
} 
```

和清单：

```
<manifest xmlns:android="http://schemas.android.com/apk/res/android" package="com.frostplant.clublink" android:versionCode="1" android:versionName="1.0">
<uses-sdk android:minSdkVersion="6" android:targetSdkVersion="15"/>
<uses-permisssion android:name="android.permission.INTERNET"/>
<application android:icon="@drawable/ic_launcher" android:label="@string/app_name" android:theme="@style/AppTheme">
<activity android:name=".MainActivity" android:label="@string/title_activity_main">
<intent-filter>
<action android:name="android.intent.action.MAIN"/>
<category android:name="android.intent.category.LAUNCHER"/>
</intent-filter>
</activity>
</application>
</manifest> 
```

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-07-17T16:11:29.417

授予您的应用程序访问 Internet 的权限：`android.permission.INTERNET`这将允许您的应用程序使用网络。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-07-17T18:22:04.840

You have mistakenly typed 3 "s"s in your permission line:

```
<uses-permisssion android:name="android.permission.INTERNET"/> 
```

This should be:

```
<uses-permission android:name="android.permission.INTERNET"/> 
```

# c++ - 如何同时在 C++ 中设置向量及其所有数据？

> ID：11526532
> 
> 赞同：2
> 
> 时间：2012-07-17T16:08:33.097
> 
> 标签：c++, vector

我写了一些 JavaScript 代码，但现在我想将它翻译成 C++，因为性能原因，但我对 C++ 的了解很少。

在 JavaScript 中，我可以这样做：

```
var arr=[[['à','á'],['è','é'],['ì','í'],['ò','ó'],['ù','ú']],['a','e','i','o','u']]; 
```

我怎样才能在 C++ 中做类似的事情？我必须做

```
vector<vector<char>> arr; 
```

然后手动设置每个元素？

```
arr[0][0]='à';
arr[0][1]='á';
... 
```

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2012-07-17T16:12:17.450

是的，除非你有 C++11，否则至少需要做更多的工作，这增加了构造函数采用初始化列表的可能性：

```
std::vector<std::vector<char>> arr {{'a', 'b'}, {'c', 'd', 'e'}, {'f'}}; 
```

您也可以考虑替换`std::vector<char>`为`std::string`.

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-07-17T16:18:02.437

这适用于 C++11

```
std::vector<std::vector<char>> var arr={{'à','á'},{'è','é'},{'ì','í'},{'ò','ó'},{'ù','ú'},{'a','e','i','o','u'}};
// Note it is changed from the original I removed one level of nesting from part of the array. 
```

如果您使用的是 C++03。
然后你需要稍微改变一下。

```
std::string var[] = {"àá'", "èé", "ìí", "òó", "ùú", "aeiou"}; 
```

类型发生了变化，但具有相同的影响，并且对对象`var`的访问没有改变。

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2012-07-17T16:21:37.453

或者，您可以使用`std::vector< std::pair< char, char > >`.

请注意，您不能使用`operator[]`（即调用`arr[0]`或`arr[0][0]`在空向量上使用（由于请求的元素不存在，您访问无效内存，这（希望）会使您的程序崩溃）。将元素添加到具有以下内容的向量`push_back(...)`：

```
vector< pair< char, char > > arr;
arr.push_back( make_pair( 'à','á' ) );
arr.push_back( make_pair( 'è','é' ) );
arr.push_back( make_pair( 'ì','í' ) );
arr.push_back( make_pair( 'ò','ó' ) );
arr.push_back( make_pair( 'ò','ó' ) );
arr.push_back( make_pair( 'ù','ú' ) ); 
```

根据您想做什么，`std::map< char, char >`可能对您也有用。它将允许您使用第一种类型作为键来访问元素，例如。

```
std::map<char, char > mymap;
mymap['à'] = 'á';
// will print "Element à = à"
cout << "Element à = " <<  mymap['à']  << endl; 
```

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2012-07-17T16:12:06.520

不幸的是，您不能将向量初始化为数组。*但是，您可以使用*数组初始化向量。对于单个向量：

```
static const int arr[] = {1,2,3,4};
vector<int> vec (arr, arr + sizeof(arr) / sizeof(arr[0]) ); 
```

初始化向量的向量有点棘手，但是您可以像上面那样在一个循环中完成它，或者像这样：（伪代码）：

```
for( int i =0; i < something; i++ )//the outer vector
{
    vector.pushBack( std::vector<int> );
    for( int j =0; j < somethingElse; j++)
        vector[i].push_back(j);
} 
```

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2012-07-17T16:15:54.933

这是使用 c++0x 的代码片段：

```
#include <vector>
#include <iostream>
using namespace std;

int main(){
    vector< vector<char> > v = { {'a','b','c'}, {'d','e','f'} };
    for (unsigned i=0; i<v.size(); i++){
        cout <<"Subvector: ";
        for (unsigned j=0; j<v[i].size(); j++)
            cout << v[i][j];
        cout << endl;
    }

    return 0;
} 
```

用 g++ -std=c++0x 编译

# sql - ODBC 连接中的多个 JOIN 问题

> ID：11526541
> 
> 赞同：0
> 
> 时间：2012-07-17T16:09:14.253
> 
> 标签：sql, join, odbc, netsuite

我正在通过 ODBC 连接到 NetSuite 数据库，并为数据库创建了一个相当大的查询来运行报告。我已将代码放在这篇文章的末尾。我的问题是，查询排​​除了“A_T_PROJECTS”表中“TRADING_PARTNER_ID”字段中具有 NULL 的行。我知道我可以在这里使用 RIGHT OUTER JOIN，但由于我要加入其他几个表，我似乎无法让它工作。关于我可以尝试什么的任何建议？

该连接是只读的，因此没有临时表 - 我希望它可以在单个查询中工作。谢谢你的时间！

```
SELECT
    [A_T_CUSTOMERS].[COMPANYNAME] AS [Company Name],
    [A_T_MILESTONES].[PROJECT_MILESTONE_NAME] AS [Name],
    [A_T_PROJECTS].[COMPANYNAME] AS [Project Name],
    [A_T_STATUS].[LIST_ITEM_NAME] AS [Status],
    [A_T_MILESTONES].[DUE_DATE] AS [Milestone Due],
    [A_T_ACTIONREQ].[LIST_ITEM_NAME] AS [Action Required By],
    [A_T_PARTNERS].[COMPANYNAME] AS [Trading Partner],
    [A_T_EMPLOYEES].[FULL_NAME] AS [Assigned To],
    [A_T_CUSTOMERS].[ESTIMATED_DELIVERY_DATE] AS [Est Del Date],
    CASE
            WHEN [A_T_MILESTONES].[PROJECT_MILESTONE_NAME] = 'Project Complete/Move to Production'
                    THEN [A_T_MILESTONES].[DUE_DATE]
            ELSE NULL
    END AS [Est Move to Prod]

FROM
    [CUSTOMERS] AS [A_T_CUSTOMERS],
    [CUSTOMERS] AS [A_T_PROJECTS],
    [PROJECT_MILESTONE] AS [A_T_MILESTONES],
    [PARTNERS] AS [A_T_PARTNERS],
    [STATUS] AS [A_T_STATUS],
    [ACTION_REQUIRED] AS [A_T_ACTIONREQ],
    [EMPLOYEES] AS [A_T_EMPLOYEES]
    --RIGHT OUTER JOIN [PARTNERS] ON ([A_T_PARTNERS].[PARTNER_ID] = [A_T_PROJECTS].[TRADING_PARTNER_ID])

WHERE
    -- JOIN CLAUSES --
    [A_T_PROJECTS].[CUSTOMER_ID] = [A_T_MILESTONES].[PROJECT_NAME_ID]
    AND [A_T_CUSTOMERS].[CUSTOMER_ID] = [A_T_MILESTONES].[CUSTOMER_MILESTONE_NAME_ID]
    AND [A_T_PARTNERS].[PARTNER_ID] = [A_T_PROJECTS].[TRADING_PARTNER_ID]
    AND [A_T_EMPLOYEES].[EMPLOYEE_ID] = [A_T_MILESTONES].[ASSIGNED_TO_ID]
    AND [A_T_STATUS].[LIST_ID] = [A_T_MILESTONES].[STATUS_ID]
    AND [A_T_ACTIONREQ].[LIST_ID] = [A_T_MILESTONES].[ACTION_REQUIRED_BY_ID]

    -- FILTER CLAUSES --
    AND [A_T_CUSTOMERS].[CUSTOMER_SINCE] > '2011-12-10 00:00:00'
    AND ([A_T_MILESTONES].[STATUS_ID] = 1
            OR [A_T_MILESTONES].[STATUS_ID] = 2
            OR [A_T_MILESTONES].[STATUS_ID] = 3
            OR [A_T_MILESTONES].[STATUS_ID] = 5)
    AND ([A_T_PROJECTS].[STATUS] = 'Assigned'
            OR [A_T_PROJECTS].[STATUS] = 'Delayed - per Customer'
            OR [A_T_PROJECTS].[STATUS] = 'Delayed - per Internal'
            OR [A_T_PROJECTS].[STATUS] = 'Delayed - per TP/VAN'
            OR [A_T_PROJECTS].[STATUS] = 'In Progress'
            OR [A_T_PROJECTS].[STATUS] = 'Production'
            OR [A_T_PROJECTS].[STATUS] = 'On-Hold')
    AND [A_T_CUSTOMERS].[TRANSLATOR_ID] != 4
    AND [A_T_CUSTOMERS].[IN_PRODUCTION] = 'F'
    AND ([A_T_PROJECTS].[JOB_TYPE_ID] IS NOT NULL
            OR [A_T_PROJECTS].[JOB_TYPE_ID] != 8
            OR [A_T_PROJECTS].[JOB_TYPE_ID] != 11) 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-07-17T16:24:55.463

您应该考虑使用`JOIN`for 每个表而不是使用 WHERE 子句来链接它们。如果两个表都需要包含相同的“Id”，则使用`TableA INNER JOIN TableB ON TableA.Id=TableB.Id`. 如果您想要所有 TableA 记录，即使 TableB 中缺少一些记录，请使用`TableA LEFT JOIN TableB ON TableA.Id=TableB.Id`. TableB 中没有匹配项的任何字段都将显示为`NULL`。

您可以嵌套所有`JOIN`子句。我不确定**netsuite**是如何处理事情的，但您可能需要`()`绕过 join 子句。

```
FROM (TableA AS A INNER JOIN TableB AS B ON A.id=B.id)
                  LEFT JOIN TableC AS C ON A.id=C.id 
```

祝你好运。

# ant - Ant：根据目标调用深度缩进回显输出

> ID：11526543
> 
> 赞同：4
> 
> 时间：2012-07-17T16:09:18.327
> 
> 标签：ant, echo, callstack, auto-indent

对于较大的 ant 构建结构和相当复杂的项目，我想根据目标调用深度缩进信息输出（回显），例如：

```
[echo] running build from project/build.xml
    [echo] running build from project/sub1/build.xml
    [echo] running build from project/sub2/build.xml
        [echo] running build from project/sub2/sub21/build.xml
        [echo] running build from project/sub2/sub22/build.xml
    [echo] running build from project/sub3/build.xml

BUILD SUCCESSFUL
Total time: x seconds 
```

是否有这样的调整，记录属性或其他什么？...也许是 xslt/css 或事件监听器？

缩进不是重点，而是查看调用层次结构：避免搜索 build.xml 文件或在所有目标和宏定义中添加自己的 echo 函数。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2014-10-07T00:18:40.747

见[https://ant.apache.org/manual/listeners.html](https://ant.apache.org/manual/listeners.html)

XmlLogger 在那里似乎很有帮助，如果有点过于冗长 - 您可以通过一些脚本提取调用层次结构（也带有回声）：

ant -logger org.apache.tools.ant.XmlLogger 构建

Log4j 也取得了一些成功：

ant -listener org.apache.tools.ant.listener.Log4jListener -lib ..../logging-log4j-1.2.17/dist/lib/ -lib 。建造

为此，我使用上面第一个链接中的示例内容在当前目录中放置了一个 log4j.properties 文件。这会生成一个包含以下内容的 build.log：

```
[     0]  Project : Build started.
[   908]  Taskdef : Could not load definitions from resource checkstyletask.properties. It could not be found.
[   995]   Target : Target "build" started.
[  4312]     Echo : com.ohmy: ivy.sorted.modules=thirdparty-plugins#com.sun.jaxb
[  4529]  Taskdef : Could not load definitions from resource checkstyletask.properties. It could not be found.
[  4588]   Target : Target "build_empty_unittests_jar_to_fulfill_dependencies" started.
[  4590]   Target : Target "build_empty_unittests_jar_to_fulfill_dependencies" finished.
[  4591]   Target : Target "build_nodeps" started.
[  4591]     Echo : Calling target 'build' for module com.sun.jaxb
[  4770]  Taskdef : Could not load definitions from resource checkstyletask.properties. It could not be found.
[  4846]   Target : Target "check_module_targets_file_exists" started.
[  4847]   Target : Target "check_module_targets_file_exists" finished.
[  4847]   Target : Target "check_module_target_exists" started.
[  4847]   Target : Target "check_module_target_exists" finished. 
```

现在我只是将它输入到小红宝石中，以缩进它：

```
ruby -pe 'BEGIN {$i=0};$i-=1 if /finished\.$/;print " " * $i;$i+=1 if /started\.$/' build.log 
```

产生

```
[     0]  Project : Build started.
 [   908]  Taskdef : Could not load definitions from resource checkstyletask.properties. It could not be found.
 [   995]   Target : Target "build" started.
  [  4312]     Echo : com.ohmy: ivy.sorted.modules=thirdparty-plugins#com.sun.jaxb, com.ohmy
  [  4529]  Taskdef : Could not load definitions from resource checkstyletask.properties. It could not be found.
  [  4588]   Target : Target "build_empty_unittests_jar_to_fulfill_dependencies" started.
  [  4590]   Target : Target "build_empty_unittests_jar_to_fulfill_dependencies" finished.
  [  4591]   Target : Target "build_nodeps" started.
   [  4591]     Echo : Calling target 'build' for module com.sun.jaxb
   [  4770]  Taskdef : Could not load definitions from resource checkstyletask.properties. It could not be found.
   [  4846]   Target : Target "check_module_targets_file_exists" started.
   [  4847]   Target : Target "check_module_targets_file_exists" finished.
   [  4847]   Target : Target "check_module_target_exists" started.
   [  4847]   Target : Target "check_module_target_exists" finished.
   [  4847]   Target : Target "module_target" started.
   [  4847]   Target : Target "module_target" finished.
   [  4847]   Target : Target "default_target" started.
    [  4849]   Target : Target "init" started.
     [  4850]   Target : Target "check_module_ivy_file_uptodate" started.
     [  4858]   Target : Target "check_module_ivy_file_uptodate" finished.
     [  4858]   Target : Target "create_module_ivy_file" started.
     [  4858]   Target : Target "create_module_ivy_file" finished.
     [  4859]   Target : Target "check_build_file_uptodate" started.
     [  4862]   Target : Target "check_build_file_uptodate" finished.
     [  4864]   Target : Target "generate_module_build_file" started.
     [  4864]   Target : Target "generate_module_build_file" finished.
     [  4865]   Target : Target "update_module_build_file" started.
      [  4866]   Target : Target "check_module_name" started.
      [  4868]   Target : Target "check_module_name" finished.
      [  4869]   Target : Target "check_manifest_version" started.
       [  4869]     Echo : Calling target 'check_manifest' for module com.sun.jaxb
       [  5041]  Taskdef : Could not load definitions from resource checkstyletask.properties. It could not be found.
       [  5065]   Target : Target "check_module_targets_file_exists" started.
       [  5065]   Target : Target "check_module_targets_file_exists" finished.
       [  5065]   Target : Target "check_module_target_exists" started.
       [  5065]   Target : Target "check_module_target_exists" finished.
       [  5065]   Target : Target "module_target" started.
       [  5065]   Target : Target "module_target" finished.
       [  5066]   Target : Target "default_target" started.
        [  5066]   Target : Target "default_check_manifest" started.
        [  5067]   Target : Target "default_check_manifest" finished.
       [  5067]   Target : Target "default_target" finished.
       [  5067]   Target : Target "module_specific_target" started.
       [  5067]   Target : Target "module_specific_target" finished.
      [  5068]   Target : Target "check_manifest_version" finished.
     [  5068]   Target : Target "update_module_build_file" finished.
     [  5069]   Target : Target "ivy_retrieve" started.
      [  5069]     Echo : Skipping 'ivy_retrieve' as everything is uptodate for com.sun.jaxb
.... 
```

当然这可以改进，但现在对我来说已经足够了:)

# ubuntu - /usr/bin/ld: 找不到 -llibboost_filesystem

> ID：11526546
> 
> 赞同：0
> 
> 时间：2012-07-17T16:09:26.643
> 
> 标签：ubuntu, makefile, gnu-make

所以我正在尝试编译我的应用程序（注意：我的第一个 makefile）并且我已经验证了这些库在 /usr/lib 中，所以我真的不确定为什么在运行 make 时会出现这个错误：

```
Linking bin/Pathing...
/usr/bin/ld: cannot find -llibboost_filesystem
/usr/bin/ld: cannot find -llibboost_thread-mt
/usr/bin/ld: cannot find -llibboost_system
collect2: ld returned 1 exit status
make: *** [bin/Pathing] Error 1 
```

相关行：LDFLAGS = -L/usr/lib -llibboost_filesystem -llibboost_thread-mt -llibboost_system

你觉得这里有什么明显的错误吗？（如果重要的话，尝试在 64 位 Ubuntu 11.10 上编译......）

那些好奇的人的整个makefile：

```
# this variable is used to set the executable name
APP      = Pathing

# this  variable is used to set the extension of files to be compiled
SRCEXT   = cpp

#this variable sets to top files hierarchy
SRCDIR   = Pathing

# intermediate object files will be organized under this directory (value of OBJDIR)
OBJDIR   = obj

#Executable file will be under $BINDIR
BINDIR   = bin

#This command will look for all source files to be compiled
SRCS    := $(shell find $(SRCDIR) -name '*.$(SRCEXT)')

#this command is used to determine the subdiretories tree
SRCDIRS := $(shell find . -name '*.$(SRCEXT)' -exec dirname {} \; | uniq)

OBJS    := $(patsubst %.$(SRCEXT),$(OBJDIR)/%.o,$(SRCS))

DEBUG    = -g
INCLUDES = -I./libs/PlistCpp/src -I/usr/local/include/thrift -I./thrift/gen-cpp  -I./Pathing  -I./libs/Detour -I./libs/DetourCrowd -I./libs/DetourTileCache
CFLAGS   = -DHAVE_NETINET_IN_H -Wall -pedantic -ansi -c $(DEBUG) $(INCLUDES)
LDFLAGS  = -L/usr/lib -llibboost_filesystem -llibboost_thread-mt -llibboost_system         

ifeq ($(SRCEXT), cpp)
CC       = $(CXX)
else
CFLAGS  += -std=gnu99
endif

.PHONY: all clean distclean

all: $(BINDIR)/$(APP)

$(BINDIR)/$(APP): buildrepo $(OBJS)
        @mkdir -p `dirname $@`
        @echo "Linking $@..."
        @$(CC) $(OBJS) $(LDFLAGS) -o $@

$(OBJDIR)/%.o: %.$(SRCEXT)
        @echo "Generating dependencies for $<..."
        @$(call make-depend,$<,$@,$(subst .o,.d,$@))
        @echo "Compiling $<..."
        @$(CC) $(CFLAGS) $< -o $@

clean:
        $(RM) -r $(OBJDIR)

distclean: clean
        $(RM) -r $(BINDIR)

buildrepo:
        @$(call make-repo)

define make-repo
   for dir in $(SRCDIRS); \
   do \
        mkdir -p $(OBJDIR)/$$dir; \
   done
endef

# usage: $(call make-depend,source-file,object-file,depend-file)
define make-depend
  $(CC) -MM       \
        -MF $3    \
        -MP       \
        -MT $2    \
        $(CFLAGS) \
        $1
endef 
```

这是一个显示 /usr/lib 中的文件的示例：

```
-rw-r--r--  1 root root   48666 2011-06-03 16:30 libboost_system.a
lrwxrwxrwx  1 root root      17 2011-06-03 16:30 libboost_system-mt.a -> libboost_system.a
lrwxrwxrwx  1 root root      25 2011-06-03 16:30 libboost_system-mt.so -> libboost_system.so.1.46.1
lrwxrwxrwx  1 root root      25 2011-06-03 16:30 libboost_system.so -> libboost_system.so.1.46.1
-rw-r--r--  1 root root   14568 2011-06-03 16:30 libboost_system.so.1.46.1 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-07-17T16:14:03.947

想通了，从库名中删除“lib”...

# asp.net - DragPanelExtender 不工作

> ID：11526547
> 
> 赞同：0
> 
> 时间：2012-07-17T16:09:28.993
> 
> 标签：asp.net, ajax

我有一个简单的 ASP.NET 表单，我用它来学习一些 AJAX 控件。

我的代码是：

```
<form id="form1" runat="server">
<ajaxToolkit:ToolkitScriptManager ID="ToolkitScriptManager1" runat="server">
</ajaxToolkit:ToolkitScriptManager>
<div>
    <div style="height: 300px; width: 250px; float: left; padding: 5px;">
        <asp:Panel ID="Panel1" runat="server" Width="250px">
            <asp:Panel ID="Panel2" runat="server" Width="40%" Height="20%" BorderWidth="1px"
                BorderStyle="Solid" BorderColor="black">
                Drag This Panel
            </asp:Panel>
        </asp:Panel>
    </div>
</div>
<ajaxToolkit:DragPanelExtender ID="Panel1_DragPanelExtender" BehaviorID="DragP1"
    DragHandleID="Panel1" TargetControlID="Panel1" runat="server">
</ajaxToolkit:DragPanelExtender>
</form> 
```

我的问题是，当我拖动面板时，它不会停留在我离开它的地方。它立即向后移动。它不应该留在我离开的地方吗？我很感激如果我回发它会退回，但我会留在页面上，不会产生新的事件。

这是正确的吗？

麦克风

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-07-17T16:37:49.113

我从未使用过拖动面板，但我认为您的标记有问题。`DragHandleID`和都`TargetControlID`设置为 Panel1 这是错误的。

```
DragHandleID="Panel1" TargetControlID="Panel1" 
```

根据 Ajax 站点上的示例，它的标记是[http://www.asp.net/ajaxLibrary/AjaxControlToolkitSampleSite/DragPanel/DragPanel.aspx](http://www.asp.net/ajaxLibrary/AjaxControlToolkitSampleSite/DragPanel/DragPanel.aspx)

```
<ajaxToolkit:DragPanelExtender ID="DPE1" runat="server"
TargetControlID="Panel3"
DragHandleID="Panel4" /> 
```

在上面的标记中，他们为 targetControlID 和 DragHandleID 使用了不同的面板，因此您应该将标记更新为

```
<ajaxToolkit:DragPanelExtender ID="Panel1_DragPanelExtender" BehaviorID="DragP1"
   DragHandleID="Panel1" TargetControlID="Panel2" runat="server">
</ajaxToolkit:DragPanelExtender> 
```

# visual-studio - MSBuild 日志的默认位置是什么？

> ID：11526552
> 
> 赞同：105
> 
> 时间：2012-07-17T16:09:35.940
> 
> 标签：visual-studio, msbuild, visual-studio-2012

我正在使用 Visual Studio Express 2012。日志文件的位置在哪里？我在存储我的解决方案和项目的文件夹中进行了搜索，但找不到任何 .log 文件。

这是日志记录的配置：

![在此处输入图像描述](../Images/731d5fc09592c22da804cd7cb0eca447.png)

* * *

## 回答 #1

> 赞同：110
> 
> 时间：2012-07-17T19:22:15.613

**仅 C++ 项目支持来自 Visual Studio 的日志文件。**您只需要使用**其他人的输出窗口即可。**

看到这个类似的线程：[VS2010: minimum build log in output and detail log in log file](https://stackoverflow.com/questions/3422428/vs2010-minimal-build-log-in-output-and-detailed-log-in-log-file)

如果您碰巧为 C++ 项目执行此操作，[文件位于](https://msdn.microsoft.com/en-us/library/b0bktkzs.aspx)：

> ... 中间文件目录中的构建日志 ... 构建日志的路径和名称由 MSBuild 宏表达式表示，`$(IntDir)\$(MSBuildProjectName).log`.

* * *

## 回答 #2

> 赞同：28
> 
> 时间：2018-05-24T08:54:55.610

使用构建输出而不是记录到文件。无需复制/粘贴，只需单击输出中的某处并按 CTRL + S 即可保存。Visual Studio 将提示您输入位置（使用 Visual Studio 2017 测试，但我假设这在早期版本中也适用）。

[![在此处输入图像描述](../Images/fda233cc2e04082af07b29a11fd7307b.png)](https://i.stack.imgur.com/BFUOF.png)

* * *

## 回答 #3

> 赞同：24
> 
> 时间：2016-10-06T18:16:09.020

msdn 文档对此非常清楚（而且您不会喜欢它！）：

[https://msdn.microsoft.com/en-us/library/jj651643.aspx](https://msdn.microsoft.com/en-us/library/jj651643.aspx)

它在哪里说：

> 为托管代码项目创建构建日志文件 在菜单栏上，选择“构建”、“构建解决方案”。
> 
> 在“输出”窗口中，突出显示构建中的信息，然后将其复制到剪贴板。
> 
> 打开文本编辑器，例如记事本，将信息粘贴到文件中，然后保存。

* * *

## 回答 #4

> 赞同：2
> 
> 时间：2017-07-16T21:22:56.483

虽然 VS 确实不允许直接这样做，但仍然可以使用“内部”VS2015 的 MSBuild 进行构建，并获取构建窗口输出和日志文件，如下所示：（可以说这是一个 hack。）

1.  在您的 VS 托管解决方案中，添加一个新项目（我们称之为“制作”）。一种。您想要的项目类型是 Visual C++/NMake 项目。
2.  在命令行上定义您需要的 MSBuild 命令（见下文）。
3.  更改解决方案配置以构建 NMake 项目，而不是正常的托管项目。

这将创建一个具有 Build、Rebuild 和 Clean 命令行的项目，您可以在其中直接执行 MSBuild。例如：

重建：`MSBuild.exe /ds /v:diag /property:Configuration=Debug ..\BuildTest\BuildTest.csproj /t:Clean,Build`

建造：`MSBuild.exe /ds /v:diag /property:Configuration=Debug ..\BuildTest\BuildTest.csproj /t:Build`

干净的：`MSBuild.exe /ds /v:diag /property:Configuration=Debug ..\BuildTest\BuildTest.csproj /t:Clean`

您还可以指定多个 MSBuild.EXE 命令行以构建多个项目。对于通常构建整个解决方案的结果，您可以仅针对最终的最终组件并让依赖关系图生成各个目标。

这将生成一个 .log 文件，其中 NAME 是您使用的 NMake 项目的名称。在上面的示例中，日志将是 make.log。

GitHub 上提供了一个工作示例： [https](https://github.com/bitblitz/VS_MsbuildExample) ://github.com/bitblitz/VS_MsbuildExample （使用 VS2015 测试）

请注意，直接构建单个项目仍将使用正常的 VS 行为进行构建，但您可以在 VS 中构建完整的解决方案并获取构建日志。

# c# - 使用 Html Agility Pack 获取 html 页面上的所有 div id

> ID：11526554
> 
> 赞同：3
> 
> 时间：2012-07-17T16:09:45.047
> 
> 标签：c#, html-agility-pack

如何使用 Html Agility Pack 获取 html 页面上的所有 div id。我正在尝试获取所有 id 并将它们放入一个集合中。

```
<p>
    <div class='myclass1'>
        <div id='f'>
        </div>  
        <div id="myclass2">
            <div id="my"><div id="h"></div><div id="b"></div></div>
        </div>
    </div>
</p> 
```

代码：

```
HtmlAgilityPack.HtmlDocument htmlDoc = new HtmlAgilityPack.HtmlDocument(); 
htmlDoc.OptionFixNestedTags=true;
htmlDoc.Load(filePath);    
HtmlNode bodyNode = htmlDoc.DocumentNode.SelectSingleNode("div"); 
```

如何获取所有 div id 的集合？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-07-17T16:35:06.743

如果您只需要 ID，则可以获取这些`id`属性节点的集合，而不是获取`div`元素节点的集合。例如：

```
List<string> ids = new List<string>();
foreach(XmlNode node in doc.SelectNodes("//div/@id"))
{
    ids.Add(node.InnerText);
} 
```

这将跳过`div`没有 ID 的`<div class='myclass1'>`元素，例如您的示例中的元素。

`"//div/@id"`是一个 XPath 字符串。XPath 是一种很容易学习的技术，如果您处理大量 XML，或者在这种情况下，通过敏捷包库处理 HTML，则可以很方便地学习。XPath 是一种行业标准，允许您在 XML 文档中选择匹配的节点。

*   `//`表示您希望它选择以下节点作为当前节点的子节点，或其任何后代。由于当前节点是文档的根节点，这将在文档中的任何位置找到匹配的节点。
*   `div`是我们要匹配的元素名称。因此，在这种情况下，我们告诉它`div`在文档中的任何位置查找所有元素。
*   `/`表示您想要一个子节点。在这种情况下，`id`属性是元素的子节点`div`，所以首先我们说我们想要`div`元素，然后我们需要正斜杠来表示我们想要`div`元素的子节点之一。
*   `@id`意味着我们想要找到所有的`id`属性。该`@`符号表示它是属性名称而不是元素名称。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-07-17T16:23:44.993

哟可以通过传递xpath语法得到div的集合

像这样

```
HtmlAgilityPack.HtmlDocument htmlDoc = new HtmlAgilityPack.HtmlDocument();

    htmlDoc.OptionFixNestedTags=true;

    htmlDoc.Load(filePath);

 foreach(HtmlNode div doc.DocumentElement.SelectNodes("//div"))
 {
///.. code here
 } 
```

# spring - Spring Data NEO4J：关系具有空值

> ID：11526557
> 
> 赞同：5
> 
> 时间：2012-07-17T16:09:54.393
> 
> 标签：spring, graph, neo4j, spring-data-neo4j

我有一个 spring 3.1 (Milestone) 和 Spring Data Neo4J 2.1 RC 项目正在运行。一切正常启动，neo4j 数据库正在根据需要填充，在 neoclipse 中也可见。

现在我通过 id 获取一个实体（让我们称之为 Container.java）并拥有关系“事件”。

Container.java 中的关系建模如下：

```
@RelatedTo(type="HAS_EVENTS", direction = Direction.BOTH)
Set<Event> events = new HashSet<Event>(); 
```

当我访问 container.getEvents() 并对其进行迭代时，我可以看到单个事件有一个 id，但所有其他属性都是 null :( 使用 neoclipse 查看时，所有属性都按应有的方式保存。

是否存在某种“急切”或“懒惰”的加载？我不使用@RelationshipType。

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2012-07-18T06:59:30.547

度过了一晚：我必须添加@Fetch 实体。从我的角度来看是有道理的，好像启用了热切加载一样，我可以轻松生成循环:)

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2014-10-13T13:49:42.973

@Fetch 实体用于急切加载

对于延迟加载，您可以使用`neo4jTemplate.fetch`方法`template.fetch(Event.getEvents())`

# javascript - JavaScript 对象在使用原型时被覆盖

> ID：11526560
> 
> 赞同：2
> 
> 时间：2012-07-17T16:10:07.200
> 
> 标签：javascript, object, prototype

我有一个 Pers(on) 和一个从 Pers 派生的 Employee。

```
Pers = function(options){
  this.Name;
  this.ID;
  this.init = function(options){
    this.Name=options.Name;
    this.ID=options.ID;
  }
}

Employee = function(options){
  this.Sal;
  this.init = function(options){
    this.Sal=options.Sal;
    this.__proto__.init(options);
  }
  this.init(options);
}

Employee.prototype=new Pers(); 
```

现在当我创建新对象时......

```
var o=new Employee({Name:"Nik",ID:"1",Sal:100});
var p=new Employee({Name:"Tanja",ID:"2",Sal:200}); 
```

并提醒他们的名字，我会得到两次“Tanja”。

有人有想法吗？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-07-17T16:23:53.607

```
this.__proto__.init(options); 
```

将调用`init`原型上的方法，原型本身为`this`，导致您修改原型。尝试

```
this.__proto__.init.apply(this, [options]); 
```

*编辑*

为避免`__proto__`您可以在隐藏它之前保存对原型初始化函数的引用：

```
Employee = function(options){
  this.Sal;
  var protoInit = this.init;
  this.init = function(options){
    this.Sal=options.Sal;
    protoInit.apply(this, [options]);
  }
  this.init(options);
} 
```

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-07-17T16:28:38.777

你`init`在错误的范围内调用。尝试这样的事情。

```
function Person(opt) {
    this.name = opt.name;
    this.id = opt.id;
}

function Employee(opt) {
    Person.call(this, opt);
    this.sal = opt.sal;
}

Employee.prototype = Object.create(Person.prototype, {}); 
```

您现在可以设置 和 的属性，`Person.prototype`它们的`Employee.prototype`行为应该符合预期。

这避免了使用 hacky 已弃用的属性 ( `__proto__`) 并且应该更清晰。`Object.create`用于使用超级构造函数的原型创建实例，而无需实际调用超级构造函数（无需`init`调用）。您可以包含半标准的属性定义，例如`super`在`constructor`您执行此操作时，正如许多库的`inherits`实现所做的那样。

# jquery - 内容滑动

> ID：11526562
> 
> 赞同：-1
> 
> 时间：2012-07-17T16:10:20.197
> 
> 标签：jquery

我有这个标记。

```
<ul>
  <li><a href="#">Home</a></li>
  <li><a href="#">About</a></li>
  <li><a href="#">Page</a></li>
</ul>

<section id="home">...</section>
<section id="about">...</section>
<section id="page">...</section> 
```

如何为我的内容制作动画？单击关于链接时，主页部分向左移动并消失，然后关于部分来自右侧，并且关于页面部分此动画继续。考虑到我也想要反向动画，即当某人再次单击主页时，动画反转并再次显示主页部分..

提前致谢

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-07-17T16:15:16.927

您正在寻找所谓的[Coda Slider Effect](http://jqueryfordesigners.com/demo/coda-slider.html)，Remy Sharp 在[jQuery for Designers](http://jqueryfordesigners.com/coda-slider-effect/)上有一个教程。

# java - JTextPane - 获取显示行的起始位置

> ID：11526563
> 
> 赞同：4
> 
> 时间：2012-07-17T16:10:21.613
> 
> 标签：java, swing, jtextpane

我有一个用于显示文本文件的 JTextPane。文字显示如下
`Line 1`
`Line 2`
`Line 3`

我想要得到的是插入符号当前所在行的起始索引。JTextPane 中是否有一个简单的方法可以帮助我实现这一目标？

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-07-17T16:19:48.943

尝试这样的事情：

```
JTextComponent testingArea = new JTextPane();
....
int caretPos = testingArea.getCaretPosition();
int rowNum = (caretPos == 0) ? 1 : 0;
for (int offset = caretPos; offset > 0;) {
    offset = Utilities.getRowStart(textArea, offset) - 1;
    rowNum++;
}
System.out.println("Row: " + rowNum); 
```

# ios - 通过终端批量构建和归档 iOS 应用程序

> ID：11526567
> 
> 赞同：8
> 
> 时间：2012-07-17T16:10:33.103
> 
> 标签：ios, bash, shell, xcode4.2, .bash-profile

我正在尝试简化 iOS 应用程序发布的构建->存档->提交过程。我们有 50 多个移动应用程序，它们具有几乎相同的框架，但具有不同的艺术作品和配置设置。

我通常会在 xcode 4.2 中加载每个项目，然后使用 xcode GUI 以通常的方式构建->存档->提交，但是我们现在有超过 50 个应用程序，每当我们推出更新时，这个过程都非常令人厌烦。

话虽如此，我正在尝试使用 shell 函数来加速这个过程。我进行了大量研究，发现[xcodebuild](https://stackoverflow.com/questions/2664885/xcode-build-and-archive-from-command-line)（参见 Reid 的答案）应该可以工作，但是存档选项不起作用，因为我收到以下错误：

```
unsupported build action 'archive' 
```

所以我写了以下内容：

```
# $1 should be a date like: 2012-07-17
# $2 should be a time like: 10.31AM
# $mybase will be the current directory at the time the function was called
# so make sure to cd into the folder containing the xcode project folders first

function xcodeArchive {
    mkdir ~/Library/Developer/Xcode/Archives/$1
    mybase=$PWD
    for x in `ls`
    do
        mkdir ~/Library/Developer/Xcode/Archives/$1/$x
        mkdir ~/Library/Developer/Xcode/Archives/$1/$x/dSYMs
        mkdir ~/Library/Developer/Xcode/Archives/$1/$x/Products
        mkdir ~/Library/Developer/Xcode/Archives/$1/$x/Products/Applications
        cd $mybase/$x
        xcodebuild
        #read -p "Press [Enter] to continue"
        cd $mybase/$x
        cp $x/$x-Info.plist ~/Library/Developer/Xcode/Archives/$1/$x/Info.plist
        cp -r build/Release-iphoneos/$x.app.dSYM ~/Library/Developer/Xcode/Archives/$1/$x/dSYMs/$x.app.dSYM
        cp -r build/Release-iphoneos/$x.app ~/Library/Developer/Xcode/Archives/$1/$x/Products/Applications/$x.app
        cd ~/Library/Developer/Xcode/Archives/$1/
        mv $x $x\ $1\ $2.xcarchive
        cd $mybase
    done
}
export -f xcodeArchive 
```

我把它放在我的 .bash_profile 中，一切正常运行，除了我没有复制正确的“Info.plist”，我不知道从哪里复制它或如何生成它。所以现在我被卡住了。

Xcode 将识别档案，但它会将它们列在管理器中的“未知架构”和“未命名档案”下。

**非常感谢有关现在获得正确 Info.plist 的任何帮助。**

我也欢迎有关如何改进脚本和/或更有效地批量构建+归档这些 iOS 应用程序的建议。

***笔记：***

*   我无法升级到 Xcode 4.2 以上，因为这需要（据我了解）我还无法获得的 OS X 10.7+（公司计算机）。

*   我仍然是一个 bash/shell 新手，所以我为上面的任何丑陋的代码/实践道歉。

*   此外，这是用于官方应用程序提交，而不是临时或类似的东西。

再次感谢您的帮助。

* * *

## 回答 #1

> 赞同：13
> 
> 时间：2012-10-24T21:21:00.037

我对归档命令有同样的问题，并通过谷歌找到了这个问题。使用此构建命令会失败：

```
xcodebuild -verbose -project $ProductName.xcodeproj -target $ProductName -configuration Release -sdk $SDK clean archive CONFIGURATION_BUILD_DIR="$PROJECT_PATH/build" PROVISIONING_PROFILE="${DIST_PROVISONING_PROFILE}" 
```

然而，它会通过这个构建命令成功：

```
xcodebuild -verbose -project $ProductName.xcodeproj -scheme $ProductName -configuration Release -sdk $SDK clean archive CONFIGURATION_BUILD_DIR="$PROJECT_PATH/build" PROVISIONING_PROFILE="${DIST_PROVISONING_PROFILE}" 
```

唯一的区别是指定方案来代替要构建的目标。如果这种行为有合理的理由，我会很高兴听到它。

我在 Mac OS X 10.7.5 上运行 XCode 4.5.1

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-07-20T15:14:18.807

好的，我找到了一个可行的解决方案。在做了更多的搜索和大量的猜测和检查之后，我发现我仍然可以使用 xcodebuild 的“归档”选项，我只需要指定一个工作区和方案，显然我以前没有正确地这样做，因为它现在作品。

因此，对于正在寻找类似解决方案（批量归档 xcode 项目）的任何人，这是我的功能：

```
# $mybase will be the current directory at the time the function was called
# so make sure to cd into the folder containing the xcode project folders first

function xcodeArchive {
    mybase=$PWD
    for x in `ls`
    do
        cd $mybase/$x
        xcodebuild -workspace $x.xcodeproj/project.xcworkspace -scheme $x archive
        cd $mybase
    done
}
export -f xcodeArchive 
```

# sql - 我怎样才能使这个 SQL 更新语句更有效？

> ID：11526571
> 
> 赞同：1
> 
> 时间：2012-07-17T16:10:47.403
> 
> 标签：sql, postgresql, aggregate-functions

我正在尝试将一个表中的计数、总和和平均值添加到另一个表中，但我最终为每个值查询相同的数据。我正在使用 PostgreSQL。我将把它交给专家来学习如何使这个更新声明更有效。这里是：

```
update "table1" set 
"col1" = (SELECT COUNT(*) FROM "table2" WHERE "table2Id" = "table1"."table1Id"), 
"col2" = (SELECT AVG("someCol") FROM "table2" WHERE "table2Id" = "table1"."table1Id"),
"col3" = (SELECT SUM("someCol") FROM "table2" WHERE "table2Id" = "table1"."table1Id"); 
```

我应该能够像这样运行一次子查询并访问更新的返回值，对吗？

```
SELECT COUNT(*), AVG("someCol"), SUM("someCol") FROM "table2" WHERE "table2Id" = "table1"."table1Id"; 
```

任何帮助深表感谢。

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-07-17T16:16:03.157

尝试子查询：

```
UPDATE table1 
SET col1 = YourCount, col2 = YourAverage, col3 = YourSum
FROM table1 t1
INNER JOIN (
    SELECT table2Id, COUNT(*) AS YourCount, AVG(someCol1) YourAverage, 
        SUM(someCol2) YourSum
    FROM table2
    GROUP BY table2Id
) t2 ON t1.table1Id = t2.table2Id 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-07-17T18:57:06.013

我相信在 Postgresql 的最新（9.0+）版本中，可以使用 CTE 进行更清晰的查询。

```
WITH calculations AS 
   (SELECT table2ID, COUNT(*) AS n, SUM(someCol) AS s, AVG(someCol) AS a
    FROM table2
    GROUP BY table2ID)
UPDATE table1
SET col1=n, col2=s, col3=a
FROM calculations WHERE calculations.table2ID=table1.table1ID; 
```

# c# - OpenSSL 和 C# 之间的不同 S/MIME 签名

> ID：11526572
> 
> 赞同：3
> 
> 时间：2012-07-17T16:10:47.993
> 
> 标签：c#, openssl, x509certificate2, smime

我正在尝试在我的 .Net 程序中使用 OpenSSL 代码。这是代码：

```
openssl pkcs12 -in "My PassKit Cert.p12" -clcerts -nokeys -out certificate.pem
openssl pkcs12 -in "My PassKit Cert.p12" -nocerts -out key.pem
smime -binary -sign -signer certificate.pem -inkey key.pem -in manifest.json -out signature -outform DER 
```

我尝试使用 .Net OpenSSL，但我完全不知道如何使用它，也找不到合适的文档。我决定使用 .Net 来执行相同的签名过程，代码如下：

```
var dataToSign = System.IO.File.ReadAllBytes(filePathToSign);
ContentInfo contentInfo = new ContentInfo(dataToSign);

X509Certificate2 signerCert = new X509Certificate2(System.IO.File.ReadAllBytes(signerPfxCertPath), signerPfxCertPassword);

var signedCms = new SignedCms(contentInfo, true);
var signer = new CmsSigner(SubjectIdentifierType.IssuerAndSerialNumber, signerCert);

signer.IncludeOption = X509IncludeOption.EndCertOnly;
signedCms.ComputeSignature(signer);

var myCmsMessage = signedCms.Encode();

var buf = Encoding.Convert(Encoding.UTF7, Encoding.UTF8, myCmsMessage);

return Encoding.UTF8.GetString(buf, 0, buf.Length); 
```

但是 C# 和 OpenSSL 之间的结果并不相同。有人可以帮我吗？

提前致谢！

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-07-26T14:47:34.863

我最终得到了这个工作！

首先，你必须到这里，安装苹果ROOT证书：

[http://www.apple.com/certificateauthority/](http://www.apple.com/certificateauthority/)

（这是第一个）。将其安装到您信任的根权限中。Mac 已经具备此功能。

其次，将开发者证书安装为受信任的根权限，它位于开发者门户中，您可以在其中添加设备，制作 passkit 密钥，所有这些

[https://developer.apple.com/ios/manage/certificates/team/index.action](https://developer.apple.com/ios/manage/certificates/team/index.action)

（您需要为此登录）

然后您需要在开发门户中生成您的 passkit 密钥，下载它，将其安装在您的 Mac 上，然后将其与私钥一起导出为 .p12 文件。

然后，您可以将此文件移动到 Windows 机器并使用它。在生成清单后，我使用了这段代码：

```
var cert = new X509Certificate2(@"path-to-your.p12", "password");

var buffer = File.ReadAllBytes(Path.Combine(basePath, "manifest.json"));

ContentInfo cont = new ContentInfo(buffer);
var cms = new SignedCms(cont, true);
var signer = new CmsSigner(SubjectIdentifierType.SubjectKeyIdentifier, cert);

signer.IncludeOption = X509IncludeOption.ExcludeRoot;

cms.ComputeSignature(signer);

var myCmsMessage = cms.Encode();

File.WriteAllBytes(Path.Combine(basePath, "signature"), myCmsMessage); 
```

抱歉，这是相当混乱的代码，但它可以工作:)

不要忘记设置

“passTypeIdentifier”：“pass.com.yourcompany.NameOfYourPass”，“teamIdentifier”：“您的团队 ID”，

在 pass.json 中！

# vba - 遍历目录中的所有 Word 文件

> ID：11526577
> 
> 赞同：6
> 
> 时间：2012-07-17T16:11:16.470
> 
> 标签：vba, ms-word

我有以下代码：

```
Sub WordtoTxtwLB()
'
' WordtoTxtwLB Macro
'
'
Dim fileName As String
myFileName = ActiveDocument.Name

ActiveDocument.SaveAs2 fileName:= _
"\\FILE\" & myFileName & ".txt", FileFormat:= _
wdFormatText, LockComments:=False, Password:="", AddToRecentFiles:=True, _
WritePassword:="", ReadOnlyRecommended:=False, EmbedTrueTypeFonts:=False, _
SaveNativePictureFormat:=False, SaveFormsData:=False, SaveAsAOCELetter:= _
False, Encoding:=1252, InsertLineBreaks:=True, AllowSubstitutions:=False, _
LineEnding:=wdCRLF, CompatibilityMode:=0

End Sub 
```

我想通过目录中的所有单词（.doc）文件循环这个子。我有以下代码：

```
Sub LoopDirectory()

vDirectory = "C:\programs2\test"

vFile = Dir(vDirectory & "\" & "*.*")

Do While vFile <> ""

Documents.Open fileName:=vDirectory & "\" & vFile

ActiveDocument.WordtoTxtwLB

vFile = Dir
Loop

End Sub 
```

但它不起作用。如何通过更改当前代码或使用新代码来使其正常工作？

* * *

## 回答 #1

> 赞同：14
> 
> 时间：2012-07-17T21:34:46.870

您实际上并不需要 WordtoTxtwLB 宏。您可以结合这两个代码。看这个例子

```
Sub LoopDirectory()
    Dim vDirectory As String
    Dim oDoc As Document

    vDirectory = "C:\programs2\test\"

    vFile = Dir(vDirectory & "*.*")

    Do While vFile <> ""
        Set oDoc = Documents.Open(fileName:=vDirectory & vFile)

        ActiveDocument.SaveAs2 fileName:="\\FILE\" & oDoc.Name & ".txt", _
                               FileFormat:=wdFormatText, _
                               LockComments:=False, _
                               Password:="", _
                               AddToRecentFiles:=True, _
                               WritePassword:="", _
                               ReadOnlyRecommended:=False, _
                               EmbedTrueTypeFonts:=False, _
                               SaveNativePictureFormat:=False, _
                               SaveFormsData:=False, _
                               SaveAsAOCELetter:=False, _
                               Encoding:=1252, _
                               InsertLineBreaks:=True, _
                               AllowSubstitutions:=False, _
                               LineEnding:=wdCRLF, _
                               CompatibilityMode:=0

        oDoc.Close SaveChanges:=False
        vFile = Dir
    Loop
End Sub 
```

顺便说一句，您确定要使用`*.*`通配符吗？如果文件夹中有 Autocad 文件怎么办？还将`ActiveDocument.Name`为您提供带有扩展名的文件名。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2016-03-22T01:06:07.720

为了编辑目录中的所有 word 文档，我构建了这个简单的子程序。

subRoutine 循环遍历目录并打开它找到的每个 *.doc 文件。然后在打开的文档文件上调用第二个子例程。在第二个子例程完成后，文档被保存然后关闭。

```
Sub DoVBRoutineNow()
Dim file
Dim path As String

path = "C:\Documents and Settings\userName\My Documents\myWorkFolder\"

file = Dir(path & "*.doc")
Do While file <> ""
Documents.Open FileName:=path & file

Call secondSubRoutine

ActiveDocument.Save
ActiveDocument.Close

file = Dir()
Loop
End Sub 
```

~~~~~~

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2018-08-14T12:38:44.717

这是我的解决方案。我认为对于像我这样的新手来说很容易理解和直接，我将在这里发布我的代码。因为我四处搜索，我看到的代码有点复杂。我们走吧。

```
Sub loopDocxs()
Dim wApp As Word.Application 
Dim wDoc As Word.Document 
Dim mySource As Object
Set obj = CreateObject("Scripting.FileSystemObject")
Set mySource = obj.GetFolder("D:\docxs\")

For Each file In mySource.Files 'loop through the directory
  If Len(file.Name) > 0 And InStr(1, file.Name, "$") = 0 Then '$ is temp file mask

    Set wApp = CreateObject("Word.Application")
    wApp.Visible = True
    'Word.Application doesn't recognize file here event if it's a word file.
    'fortunately we have the file name which we can use.
    Set wDoc = wApp.Documents.Open(mySource & "\" & file.Name, , ReadOnly)

    'Do your things here which will be a lot of code

    wApp.Quit
    Set wApp = Nothing

  End If
Next file 
```

# java - Java：将 bool 数组转换为单个 int

> ID：11526582
> 
> 赞同：0
> 
> 时间：2012-07-17T16:11:41.287
> 
> 标签：java, integer, boolean, bit-manipulation

我有一个布尔数组（长度 = 2），我想将其连接并转换为整数，以便整数内的各个位表示布尔数组中的值：

```
[false, false] = 0
[false, true] = 1
[true, false] = 2
[true, true] = 3 
```

* * *

## 回答 #1

> 赞同：15
> 
> 时间：2012-07-17T16:14:46.797

这将起作用：

```
int n = (a[0] ? 2 : 0) + (a[1] ? 1 : 0); 
```

如果您想要更通用的解决方案：

```
int n = 0, l = a.length;
for (int i = 0; i < l; ++i) {
    n = (n << 1) + (a[i] ? 1 : 0);
} 
```

* * *

## 回答 #2

> 赞同：9
> 
> 时间：2012-07-17T16:27:57.833

任意长度数组的通用方式（尽管只有最后 32 个元素有所不同，因为 int 是 32 位）：

```
int booleansToInt(boolean[] arr){
    int n = 0;
    for (boolean b : arr)
        n = (n << 1) | (b ? 1 : 0);
    return n;
} 
```

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-07-17T16:14:29.777

```
int i = (array[0] ? 2 : 0) +  (array[1] ? 1 : 0); 
```

长度的一般解决方案！= 2：

```
public static void main(String[] args) {
    boolean[] array = {true, true, false};
    int number = 0;
    int j = array.length - 1;
    for (int i = 0; i < array.length; i++) {
        if (array[i])
            number += 1 << j--;
    }
} 
```

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2012-07-17T16:15:26.893

```
int number = 0;
for(int i = array.length - 1; i >= 0; i--)
{
  if(array[i])
  {  
    int exponent = (array.length - 1 - i)
    number += Math.pow( 2, exponent );
  }
} 
```

# javascript - 如何在 Jquery Mobile 中对齐居中的两张图片

> ID：11526587
> 
> 赞同：1
> 
> 时间：2012-07-17T16:11:57.120
> 
> 标签：javascript, jquery-mobile, image, alignment

使用 JqueryMobile 时如何对齐两张图片，使它们位于 div 的中心并且远离两侧？--p--p--

```
<div class="ui-grid-a" style="margin: 10px;"">
            <div class="ui-block-a" id="pic"   align="center">
                <img src="images/image1_100x100.jpg" data-theme="c" id="pictureId"/>
            </div>
            <div class="ui-block-b">
                <label>&nbsp</label>
            </div>
            <div class="ui-block-c" id="pic"   align="center">
                <img src="images/image2_100x100.jpg" data-theme="c" id="pictureId2"/>
            </div>
        </div>

<style>

  div#pic { color:red; border:4px solid grey; border-radius: 15px; width:130px; height:130px 
         text-align:center; background-color: white; margin: 0 auto;}
</style> 
```

第二个问题是，在 div 之间建立间隙的正确方法是什么？我现在正在使用空 div，但我认为可能有更好的东西？

干杯，萨米

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-07-17T18:23:27.957

当您在 JQM css 链接*之后插入 css 时，您始终可以添加 css 并覆盖 JQM 内容。*我拿了你的代码并稍微修改了一下，所以它应该给你一个起始点。我不知道您或 JQM css 是否会干扰它，因为我现在无法尝试。

由于所有兼容性 css（前缀属性），在我的情况下 CSS 绝不会更小。但优点是盒子布局更加灵活，它还允许在 2 个方向上居中内容，还允许排序和对齐。

[http://www.w3.org/TR/css3-flexbox/](http://www.w3.org/TR/css3-flexbox/)

这只是一个替代方案。

[http://dabblet.com/gist/3132163](http://dabblet.com/gist/3132163)

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-07-17T20:22:52.357

我让它工作了。我想这不是那么复杂的解决方案，但它正在工作。

```
.pics {
  background-color: white;
  border-radius: 15px;
  border: 4px solid grey;
  height: 130px;
  padding: 0px;
  text-align: center;
  width: 130px !important;
}
.picLeft {
  float:left;
  margin-left: 10px !important;

}

.picRight {
  float:right;
  margin-right: 10px !important;

} 
```

我愿意接受任何更好的解决方案，并感谢 Torsten！萨米人

# python - Python调用doskey宏

> ID：11526591
> 
> 赞同：1
> 
> 时间：2012-07-17T16:12:09.963
> 
> 标签：python, windows, shell, macros

我不完全确定这个脚本发生了什么，但基本上这就是我想要做的：

我有一个 Windows 批处理脚本，它使用 doskey 命令定义一些宏。在 Python 中，我希望调用这些宏之一。在一个系统上，我能够做到这一点，但在另一个系统上，它告诉我这不是一个有效的命令。然而，在这两个系统上，如果我调用“doskey /macros”，我会看到正确定义的所有宏。

通过python，我尝试使用 subprocess call 命令简单地调用宏：

```
from subprocess import call
call( "some_macro", shell=True ) 
```

如前所述，这在一个系统上运行良好，但在另一个系统上运行良好（均运行 Windows 7 64 位）。

我知道我可以通过直接在 Python 中调用而不是尝试调用宏来解决这个问题，但我想了解为什么即使 shell 上下文 python 获取的宏似乎正确定义了宏（通过运行 doskey /macro 命令观察到）。

有什么想法吗？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-10-01T21:36:08.807

答案是接受 Windows shell 的劣势，而只是将我的命令嵌入 Python 中。

不完全是我所希望的。

# python - mongoengine ListField(ReferenceField()) 和自定义primary_key

> ID：11526593
> 
> 赞同：6
> 
> 时间：2012-07-17T16:12:24.663
> 
> 标签：python, mongodb, mongoengine

我有一些非常简单的代码：

```
from mongoengine import *

class Comment(Document):
    id = IntField(primary_key=True)
    text = StringField()

class Message(Document):
    id = IntField(primary_key=True)
    comments = ListField(ReferenceField(Comment))

connect('test_db')

c1 = Comment(id=1)
c1.text = 'message_one'
c1.save()

c2 = Comment(id=2)
c2.text = 'message_two'
c2.save()

m = Message(id=1)
m.comments = [c1, c2]
m.save()

msg = Message.objects.get(id=1)
for comment in msg.comments:
    print comment.id, comment.text 
```

我预计它会打印

> 1 条消息_一个
> 
> 2 message_two

但我有

> 1 条消息_一个
> 
> 1 条消息_一个

当我使用任何 mongodb 管理 UI 来查看数据库时，一切似乎都很好：

> {“_cls”：“消息”，“_id”：1，“_types”：[“消息”]，
> 
> “评论”：[{“$ref”：“评论”，“$id”：1}，{“$ref”：“评论”，“$id”：2}]}

我尝试在代码中交换 c1 和 c2（例如使用 m.comments = [c2, c1]），但出乎意料的是，我得到了正确的输出：

> 2 message_two
> 
> 1 条消息_一个

此外，我尝试不使用自定义主键“id”，并且在这两种情况下一切正常。

我对这个错误感到非常困惑，似乎 mongoengine 有问题，或者我没有以正确的方式使用它。请问，有什么想法吗？

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-07-20T08:18:20.077

取消引用中有一个错误，此错误已在 0.6.15 中修复 - 请升级！

# jquery - Twitter Bootstrap 是否包含 jQuery？

> ID：11526594
> 
> 赞同：75
> 
> 时间：2012-07-17T16:12:26.263
> 
> 标签：jquery, twitter-bootstrap

[Twitter Bootstrap](http://getbootstrap.com) v3是否包含[jQuery](http://jquery.com/)或者我是否需要单独包含 jQuery？如果确实包含 jQuery，包含的 jQuery 版本（编号），以及使用 Bootstrap 时是否所有 jQuery 功能都可用？

* * *

## 回答 #1

> 赞同：55
> 
> 时间：2012-07-17T16:16:53.593

> 小心！所有 javascript 插件都需要最新版本的 jQuery。

[就在文档中](http://twitter.github.com/bootstrap/javascript.html)

[这是 jQuery 的当前发布链接](http://docs.jquery.com/Downloading_jQuery#Current_Release)

Bootstrap“产品”有许多元素——其中之一是 JavaScript 插件——只有这些需要 jQuery——它们扩展了 jQuery 功能，所以是的，所有 jQuery 方法/函数都可用。其余部分（CSS、脚手架、组件等）需要 HTML 和 CSS（或组合）

jQuery 不包含在 Twitter Bootstrap 下载中 - 您必须下载它/链接到它的 CDN 版本

**编辑：**

```
2.X requires atleast 1.7 
```

* * *

## 回答 #2

> 赞同：30
> 
> 时间：2012-07-17T16:19:27.647

> Twitter Bootstrap 是否使用 jQuery？

是的，jQuery 插件需要 jQuery。正如迈克所指出的，网站上明确提到了这一点。

> 如果是这样，使用什么版本（编号）的 jQuery

正如迈克所提到的，最新版本

> 所有 jQuery 函数都可用吗？

jQuery 函数可通过 jQuery 获得，它们与 Bootstrap 无关。如果包含 jQuery 库，则可以使用任何所需的 jQuery 功能。

* * *

## 回答 #3

> 赞同：6
> 
> 时间：2012-07-17T16:20:38.637

Bootstrap jQuery 插件就像任何其他 jQuery 插件一样，它们需要 jQuery 才能工作。您下载 jQuery 并将其包含在您的页面中，然后包含 Boostrap 插件。

它不使用特定版本的 jQuery，只需从[jQuery 站点](http://jquery.com/)获取最新版本。

所有 jQuery 函数都在 jQuery 中可用（还有什么方法？），Bootstrap 与它无关……它只是为您提供了一些额外的插件。

# django - Heroku 上的 Django——找不到静态文件

> ID：11526598
> 
> 赞同：5
> 
> 时间：2012-07-17T16:12:38.060
> 
> 标签：django, heroku, django-staticfiles

我在 Heroku 上运行 Django。我可以成功运行 collectstatic，但是当我访问该站点时，很明显 Django 无法找到我的静态文件。这是我的设置中的一个片段——我认为这主要是标准的东西：

```
STATIC_ROOT = ''

# URL prefix for static files.
# Example: "http://media.lawrence.com/static/"
STATIC_URL = '/static/'

PROJECT_DIR = os.path.abspath(os.path.dirname(__file__))

# Additional locations of static files
STATICFILES_DIRS = (
    # Put strings here, like "/home/html/static" or "C:/www/django/static".
    # Always use forward slashes, even on Windows.
    # Don't forget to use absolute paths, not relative paths.
    os.path.join(PROJECT_DIR, 'static'),
)

# List of finder classes that know how to find static files in
# various locations.
if CLAYS_ENV == 'dev':
    STATICFILES_FINDERS = (
        'django.contrib.staticfiles.finders.FileSystemFinder',
        'django.contrib.staticfiles.finders.AppDirectoriesFinder',
        'django.contrib.staticfiles.finders.DefaultStorageFinder',
    ) 
```

在我的情况下，CLAYS_ENV 变量将设置为“dev”。关于为什么 Django 可以成功运行 collectstatic，但之后找不到文件的任何想法？

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-07-17T17:46:17.000

收集静态媒体和提供静态媒体是两个不同的东西。Collectstatic 只是将您的静态媒体放入您的`STATIC_DIRS`

提供静态文件是服务器的过程，而不是`collectstatic`命令。我以前从未部署到heroku，但你有一个url来将你的静态资产映射到它们的位置吗？

```
if not settings.DEBUG:
    urlpatterns += patterns('',
        (r'^static/(?P<path>.*)$', 'django.views.static.serve', {'document_root': settings.STATIC_ROOT}),
    ) 
```

您使用的是哪个服务器？但是，通常您希望服务器提供静态媒体，而不是 django。在 apache 中，这是通过设置一个`Alias`

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2012-07-18T12:52:21.137

使用 Heroku 时，建议通过 CDN（如 Amazon S3）提供静态文件。虽然您仍然可以设法直接从 Heroku 提供服务，但处理动态请求的同一进程也在提供静态数据，浪费处理时间。此外，对于媒体文件，CDN 的使用是强制性的，因为 Heroku 的文件系统是“短暂的”：每次部署新代码时，都会从头开始重新创建 Cedar 堆栈的新映像，并检查新代码制作。在部署之间创建的每个不是 Git 跟踪的文件都会丢失。

# ruby-on-rails - 将应用程序部署到 Heroku

> ID：11526603
> 
> 赞同：0
> 
> 时间：2012-07-17T16:12:58.710
> 
> 标签：ruby-on-rails, git, deployment, heroku

当我想将我的应用程序部署到 heroku（使用 git push heroku master）时，它给了我一个错误并告诉我安装 sqlite3 -v '1.3.6'。因此，在成功安装该 gem 后，我尝试再次将其部署到 heroku，但它仍然给我同样的错误！但是，我已经安装了它。现在我什至无法在本地运行我的 rails 项目（rails 服务器）。我可以知道这可能是什么原因吗？

这是我在 database.yml 文件中的内容：

```
# SQLite version 3.x
#   gem install sqlite3
#
#   Ensure the SQLite 3 gem is defined in your Gemfile
#   gem 'sqlite3'
development:
  adapter: sqlite3
  database: db/development.sqlite3
  pool: 5
  timeout: 5000

# Warning: The database defined as "test" will be erased and
# re-generated from your development database when you run "rake".
# Do not set this db to the same as development or production.
test:
  adapter: sqlite3
  database: db/test.sqlite3
  pool: 5
  timeout: 5000

production:
  adapter: sqlite3
  database: db/production.sqlite3
  pool: 5
  timeout: 5000 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-07-17T16:35:43.263

让你的 gemfile 看起来像这样

```
 group :production do
         gem 'pg'
      end
      group :development, :test do
         gem 'sqlite3-ruby', :require => 'sqlite3'
      end 
```

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-07-17T16:35:47.797

Heroku 不适用于`SQLite3`

打开您的 Gemfile 并替换以下行：

```
gem 'sqlite3' 
```

为了

```
group :production do
  gem 'pg'
end

group :development, :test do
  gem 'sqlite3'
end 
```

我还建议您阅读 heroku 说明：[https ://devcenter.heroku.com/articles/rails3](https://devcenter.heroku.com/articles/rails3)

# c# - 通过反射获取所有继承类的单例

> ID：11526617
> 
> 赞同：1
> 
> 时间：2012-07-17T16:13:57.393
> 
> 标签：c#, .net, reflection

我有以下情况：

```
class Cow : Animal
{
   public int animalID;
   private static Cow instance;
   public static Cow Instance
   {
      get 
      {  
          if (instance == null) instance = new Cow();
          return instance;     
      }
    }
   private Cow() { }
} 
```

`Cow`是一个继承自 的普通单例`Animal`。我需要的是：a`Dictionary<int, Animal>`包含从 type 继承的所有单例`Animal`，这样，a）列表首先填充所有现有的单例 [已经实例化]，以及 b）添加到我的字典中尚未实例化的项的方法。

对于已实现的 Cow、Goat 和 Zebra 类，我想要这种行为：

```
public class Cow : Animal { ... }
public class Goat : Animal { ... }
public class Zebra : Animal { ... }

public static class AnimalManagement
{
   static Dictionary<int, Animal> zoo = new Dictionary<int, Animal>();
   static void FillDictionary();
   static Animal GetAnimalID(int animalID);    
}

public Main()
{
   var a1 = Cow.Instance;
   var a2 = Goat.Instance;

   AnimalManagement.FillDictionary();
   // Now, zoo.Count() == 2

   // Suppose I seeking for Zebra, with animalID  == 5:
   Animal zebra = AnimalManagement.GetAnimalID(5);
   // Thus, zoo.Count() == 3 and zeebra singleton was 
   // instantiated and added to internal dic of AnimalManagement.
} 
```

所以我想通过反射在运行时填写字典。我的朋友可以吗？

提前致谢！

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-07-17T16:26:13.103

本质上：

```
var types = myAssembly.GetTypes(t => typeof(Animal).IsAssignableFrom(t) && !t.IsAbstract);
var instances = types.Select(t => t.GetProperty("Instance", B.Static).GetValue(null, null)); 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-07-17T16:27:17.317

尽管可以，但反射通常很慢，在进行汇编搜索时甚至更慢。您能否使用元数据（一些 DSL，如 XML）来实现您正在寻找的这种配置？

如果您仍然想要反射，它将归结为以下步骤（伪代码）：

*   获取执行程序集
*   从您的程序集中获取模块
*   从 type.BaseType == typeof(Animal) 的模块中获取类型
*   拥有这些类型后，您需要创建它们。您可以在类型上调用`Instance`方法，*或者*如果您删除单例部分，您可以使用 Activator ( [activator API](http://msdn.microsoft.com/en-us/library/system.activator.aspx) ) 创建类型。无论哪种方式，你都会得到你的`Animal`.

# ruby-on-rails - 单击带有水豚的元素

> ID：11526620
> 
> 赞同：0
> 
> 时间：2012-07-17T16:14:03.453
> 
> 标签：ruby-on-rails, ruby, capybara

我需要与之交互的网页上有一个是/否滑块。我需要单击其中一个元素，以便值从 true 变为 false 或 false 变为 true。使用 id 我可以得到元素的值

```
find_field('passcode_policies__allow_simple').find('option[selected]').value 
```

但是我一遍又一遍地尝试模拟单击此对象以更改值并且没有成功。

```
<div class="control-group">
  <select class="toggle" id="passcode_policies__allow_simple" name="passcode_policies[][allow_simple]" style="display: none; " tabindex="-1">
    <option value="true" selected="selected">Yes</option>
    <option value="false">No</option>
  </select>
  <div class="ui-switch off" tabindex="0">                                 
    <div class="ui-switch-mask">                          
      <div class="ui-switch-master" style="left: -38px; ">                      
        <div class="ui-switch-upper">                     
          <span class="ui-switch-handle" style="left: 33px; "></span>          
        </div>                                            
        <div class="ui-switch-lower">                     
          <div class="ui-switch-labels">                  
            <a href="#" class="ui-switch-on" style="width: 17px; " tabindex="-1">Yes</a>   
            <a href="#" class="ui-switch-off" style="width: 17px; " tabindex="-1">No</a> 
          </div>                                          
        </div>                                            
      </div>                                              
    </div>                                                
    <div class="ui-switch-middle" style="width: 60px; ">
    </div>                  
  </div>
  <label class="inline">Allow simple value</label>
  <span class="help-block">Permit the use of repeating, ascending, and descending character sequences</span>
</div> 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-07-17T18:32:34.700

工作解决方案：

```
within(:css, '#passcode_policies__allow_simple + .ui-switch') do
  click_link 'No'
end 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-07-17T16:42:56.327

如果您使用 Selenium、headless webkit 或 phantomjs (poltergeist gem)，您应该能够调用简单的

```
click_link 'Yes' 
```

但是如果您只是直接使用 capybara，您将不得不与 select 元素进行交互，例如

```
select('Yes', :from => 'passcode_policies__allow_simple') 
```

你可以用这个水豚检查可见性和诸如此类[：page.should have_no_content does not work correct for display:none element](https://stackoverflow.com/questions/5453729/capybara-page-should-have-no-content-doesnt-work-correctly-for-displaynone-el)

# c# - 从数据集中获取 SQL Server 标量值函数结果

> ID：11526621
> 
> 赞同：1
> 
> 时间：2012-07-17T16:14:07.523
> 
> 标签：c#, sql-server, ado.net

我有一个 DataSet，其 TableAdapter 映射到 SQL Server 中的标量值函数。

如何获取 SQL Server 函数返回的结果？

我试过使用

```
fnGetWorkersCountTableAdapter wc = new fnGetWorkersCountTableAdapter();
wc.Fill(myDataSet1); 
```

就像我想获取存储过程返回的行时一样，但在函数的情况下，Fill 方法返回 0。

为什么会这样？

# zend-studio - Zend Studio 9：如何创建快捷方式？

> ID：11526625
> 
> 赞同：1
> 
> 时间：2012-07-17T16:14:24.730
> 
> 标签：zend-studio

我想在 Zend Studio 9 中为我在代码库中创建的代码片段创建一个快捷方式。如何创建快捷方式。我在用户指南和在线都没有看到任何内容。

非常感谢！

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-12-17T09:12:25.763

ZS 不适用于代码片段/模板的键盘快捷键。相反，您可以定义模板，当您开始输入该模板的前几个字母时，工作室会建议“自动完成”整个模板。

供参考：[http ://forums.zend.com/viewtopic.php?f=59&t=76228](http://forums.zend.com/viewtopic.php?f=59&t=76228)

# algorithm - n个字形的边界框，给定单独的bboxes和advanced

> ID：11526627
> 
> 赞同：2
> 
> 时间：2012-07-17T16:14:30.193
> 
> 标签：algorithm, graphics, fonts, 2d

出于特定原因，我正在实现自己的字体渲染，并且需要一种算法来通过使用单个字形的边界框以及相应的高级来计算文本的边界框。有关说明，请参见此[图](http://www.freetype.org/freetype2/docs/glyphs/Image3.png)：

![在此处输入图像描述](../Images/1899373b10eec9e58400f396324285c4.png)

对于这*N*个字形中的每一个，都给出了相对于原点（xmin、xmax、ymin、ymax）和前进（伪代码）的相对 bbox：

```
int xmin[N], xmax[N], ymin[N], ymax[N], adv[N]; 
```

如果没人咬，我会自己给出答案。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-07-17T16:36:31.173

对于一般情况，由于提示、字距调整和连字，您将无法仅使用字形边界框和提前宽度来准确测量字符串，这将显着修改字形的大小及其间距，具体取决于它们在字符串以及选择的字体大小。

通过迭代字形并添加提前宽度和 xMin 来计算字符串长度的幼稚方法仅适用于某些大小的某些字体，并且尽可能不使用。

获取字体度量的最简单方法是使用已建立的字体渲染引擎直接获取文本的长度（如果 API 公开该长度）或将文本渲染到表面并找到 X/Y 中的最小/最大像素方向。

# sql - 是否有按范围分组的 SQL 查询的既定模式？

> ID：11526630
> 
> 赞同：9
> 
> 时间：2012-07-17T16:14:35.247
> 
> 标签：sql, sql-server, design-patterns, group-by

我在 SO 上看到了[很多](https://stackoverflow.com/search?q=group%20by%20a%20range%20in%20sql)关于如何在 SQL 查询中按范围对数据进行分组的问题。

确切的场景各不相同，但每个场景中的一般潜在问题是按一系列值而不是`GROUP BY`列中的每个离散值进行分组。换句话说，按比您存储在数据库表中的精度更低的粒度进行分组。

在生成直方图、日历表示、数据透视表和其他定制报告输出等内容时，这种情况经常出现在现实世界中。

一些示例数据（不相关的表格）：

```
|      OrderHistory       |       |         Staff        |                
---------------------------       ------------------------
|    Date    |  Quantity  |       |   Age     |   Name   |
---------------------------       ------------------------       
|01-Jul-2012 |     2      |       |    19     |   Barry  |
|02-Jul-2012 |     5      |       |    53     |   Nigel  |
|08-Jul-2012 |     1      |       |    29     |   Donna  |
|10-Jul-2012 |     3      |       |    26     |   James  |
|14-Jul-2012 |     4      |       |    44     |   Helen  |
|17-Jul-2012 |     2      |       |    49     |   Wendy  |
|28-Jul-2012 |     6      |       |    62     |   Terry  |
---------------------------       ------------------------ 
```

现在假设我们要使用表格的`Date`列`OrderHistory`按周分组，即 7 天的范围。或者也许将其分组`Staff`为 10 岁的年龄范围：

```
|       Week      |  QtyCount  |        |  AgeGroup | NameCount |         
--------------------------------        -------------------------
|01-Jul to 07-Jul |     7      |        |   10-19   |    1      |
|08-Jul to 14-Jul |     8      |        |   20-29   |    2      | 
|15-Jul to 21-Jul |     2      |        |   30-39   |    0      |
|22-Jul to 28-Jul |     6      |        |   40-49   |    2      |
--------------------------------        |   50-59   |    1      |
                                        |   60-69   |    1      |
                                        ------------------------- 
```

`GROUP BY Date`而`GROUP BY Age`他们自己不会这样做。

我看到的最常见的答案（没有一个始终被评为“正确”）是使用以下一个或多个：

*   一堆`CASE`语句，每个分组一个
*   一堆`UNION`查询，`WHERE`每个分组有不同的子句
*   因为我正在使用 SQL Server，[`PIVOT()`并且`UNPIVOT()`](http://msdn.microsoft.com/en-us/library/ms177410%28v=sql.105%29.aspx)
*   使用子选择、临时表或视图构造的两阶段查询

是否有处理此类查询的既定通用模式？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-07-17T19:56:26.433

您可以使用一些维度建模技术，例如[事实表](http://en.wikipedia.org/wiki/Fact_table)和[维度表](http://en.wikipedia.org/wiki/Dimension_table)。订单历史记录可以充当与 DateKey 外键关系到 Date 维度的事实表。日期维度可以具有如下模式：

![日期维度](../Images/6b95dbe4fffff86ba0e27ff0009ed4ee.png)

请注意，日期表预先填充了最多 N 年的数据。

使用上面的示例，以下是获取结果的示例查询：

```
select CalendarWeek, sum(Quantity)
from OrderHistory a
join DimDate b
    on a.DateKey = b.DateKey
group by CalendarWeek 
```

对于员工表，您可以存储生日键而不是年龄，并让查询计算年龄和范围。

这是[SQL 小提琴](http://sqlfiddle.com/#!3/deb80/3)

日期维度人口脚本取自[此处](http://jsimonbi.wordpress.com/2011/10/09/populating-your-date-dimension/)。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-07-17T17:19:39.060

通常情况下，此 SQL 问题需要在组合中使用多个模式。

在这种情况下，您可以使用的两个是

*   NTILE
*   数字表

您可以使用[NTITLE](http://msdn.microsoft.com/en-us/library/ms175126.aspx)创建一定数量的组。但是，由于您没有代表组中的每个成员，因此您还需要使用**数字表**由于您使用的是 SQL Server，因此您不必进行模拟就很容易。

这是员工问题的示例

```
WITH g as (
SELECT 
     NTILE(6) OVER (ORDER BY number) grp, 
     NUMBER
FROM 
    master..spt_values
WHERE 
    TYPE = 'P'
and number >=10 and number <=69
)
SELECT 
      CAST(min(g.number) as varchar) + ' - ' + 
      CAST(max(g.number) as varchar) AgeGroup ,
      COUNT(s.age) NameCount
FROM 
     g
     LEFT JOIN Staff s
     ON g.NUMBER = s.Age
GROUP BY 
    grp 
```

[演示](http://sqlfiddle.com/#!3/ff1f0/14)

您也可以将其应用于日期，它只需要一些日期操作

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-07-17T16:38:48.247

在这种类型中，我最喜欢的情况是交易必须按财政季度或财政年度分组。各种企业的财政季度或财政年度界限可能近乎离奇。

我最喜欢的实现方式是为日期的属性创建一个单独的表。让我们称表为“年历”。此表中的一列是会计季度，另一列是会计年度。这张表的关键当然是日期。十年的数据填充了 3,650 行，加上一些闰年。然后，您需要一个可以从头开始填充此表的程序。所有企业日历规则都内置在这个程序中。

当您需要按会计季度对交易数据进行分组时，您只需将这个表加入日期，然后按会计季度分组。

我认为这种模式可以扩展到其他类型的范围分组，但我自己从来没有这样做过。

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2012-07-17T16:48:53.017

在您的第一个示例中，您的间隔是有规律的，因此您只需使用函数即可获得所需的结果。下面是一个根据需要获取数据的示例。第一个查询将第一列保持为日期格式（我最好如何处理它在 SQL 之外进行任何格式化），第二个查询为您进行字符串转换。

```
DECLARE @OrderHistory TABLE (Date DATE, Quantity INT)
INSERT @OrderHistory VALUES 
    ('20120701', 2), ('20120702', 5), ('20120708', 1), ('20120710', 3), 
    ('20120714', 4), ('20120717', 2), ('20120728', 6)

SET DATEFIRST 7

SELECT  DATEADD(DAY, 1 - DATEPART(WEEKDAY, Date), Date) AS WeekStart,
        SUM(Quantity) AS Quantity
FROM    @OrderHistory
GROUP BY DATEADD(DAY, 1 - DATEPART(WEEKDAY, Date), Date)

SELECT  WeekStart,
        SUM(Quantity) AS Quantity
FROM    @OrderHistory
        CROSS APPLY 
        (   SELECT  CONVERT(VARCHAR(6), DATEADD(DAY, 1 - DATEPART(WEEKDAY, Date), Date), 6) + ' to ' + 
                    CONVERT(VARCHAR(6), DATEADD(DAY, 7 - DATEPART(WEEKDAY, Date), Date), 6) AS WeekStart
        ) ws
GROUP BY WeekStart 
```

可以使用以下方法对您的年龄分组进行类似的操作：

```
SELECT  CAST(FLOOR(Age / 10.0) * 10 AS INT) 
```

然而，这对于 30-39 失败，因为没有该组的数据。

我对此事的立场是，如果您一次性执行查询，则使用临时表、cte 或 case 语句应该可以正常工作，这也应该扩展到在小数据集上重用相同的查询。

但是，如果您可能重用该组，或者您指的是大量数据，则创建一个永久表，其中定义了范围并将索引应用于所需的任何列。这是在 OLAP 中创建维度的基础。

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2012-07-17T16:23:50.670

您不能将年龄（或日期）视为一个新的小表中的外键，该表只是年龄（或日期）及其相应的范围？连接语句可以为新表提供包含 AgeGroups 的列。使用新表，您可以使用标准分组方法。

为分组创建一个新表似乎很鲁莽，但以编程方式制作很容易，我认为它比 case 语句或 where 子句更容易维护（或删除和重新创建）。如果这个查询的结果是一次性的，一次性的 sql 语句可能效果最好，但我认为我的方法最适合长期使用。

* * *

## 回答 #6

> 赞同：1
> 
> 时间：2012-07-17T16:38:41.773

好吧，几年前，我们使用 Oracle DB 的方式如下：

1.  我们有两个表：Sessions 和 Ranges。范围具有引用 Session 的外键。
2.  当我们需要执行 SQL 时，我们在 Sessions 中创建了一条新记录，并在 Ranges 中创建了几条引用该会话的新记录。
3.  我们的 SQL 通过 Session 过滤加入 Ranges：

```
    选择总和（t.Value），r.Name
    从数据表 t
    加入 Ranges r on (r.Session = ? and r.Start t.MyDate)
    按 r.Name 分组

```

1.  得到结果后，我们从 Sessions 中删除了该记录，并从 Ranges 中删除了由级联删除的记录。
2.  我们有守护进程从垃圾记录中清除会话，这些记录在特殊情况下泄露（杀死进程等）。

这非常有效。从那时起，Oracle 添加了新的 SQL 子句，也许可以使用它们。但在其他 RDBMS 上，这仍然是一种有效的方式。

另一种方法是创建许多函数，例如 GET_YEAR_BY_DATE 或 GET_QUARTER_BY_DATE 或 GET_WEEK_BY_DATE（它们将返回相应期间的开始日期，例如，对于任何日期返回一年中的开始日期）。然后按他们分组：

```
select sum(Value), GET_YEAR_BY_DATE(MyDate) from DataTable
group by GET_YEAR_BY_DATE(MyDate) 
```

* * *

## 回答 #7

> 赞同：1
> 
> 时间：2012-07-17T16:25:06.203

看一下[OVER 子句](http://msdn.microsoft.com/en-us/library/ms189461.aspx)及其相关子句：PARTITION BY、ROW、RANGE...

> 在应用关联的窗口函数之前确定行集的分区和排序。也就是说，OVER 子句在查询结果集中定义了一个窗口或用户指定的一组行。然后窗口函数为窗口中的每一行计算一个值。您可以将 OVER 子句与函数一起使用来计算聚合值，例如移动平均值、累积聚合、运行总计或每组结果的前 N ​​个。

# javascript - 文本框中的数字需要工作

> ID：11526631
> 
> 赞同：0
> 
> 时间：2012-07-17T16:14:37.913
> 
> 标签：javascript, jquery

> **可能重复：**
> [代码在不应该生效时生效](https://stackoverflow.com/questions/11491177/code-is-taking-effect-when-it-shouldnt-be)

我有一个函数，如果用户单击一个按钮，它将在文本框中显示一个值，并在单击“#btn”按钮后触发另一个函数：

```
function addwindow(numberAnswer, gridValues, btn) { 
    $('#mainNumberAnswerTxt').val(numberAnswer).data('data-ignore',true);
    $('#btn'+gridValues).trigger('click');       
 } 
```

现在我想做的是：

1.  如果用户单击“添加”按钮，则将“答案数量”列中的数字显示到文本框中，或者换句话说，从`addwindow()`函数中执行此操作：

    `$('#mainNumberAnswerTxt').val(numberAnswer).data('data-ignore',true);`

2.  如果用户单击了一个`#btn+gridValues`按钮，则在文本框中显示当前打开的按钮数量的数字，或者换句话说，执行以下代码：

    `if ($('#mainNumberAnswerTxt').data('data-ignore') != true) { $('.answertxt', context).val(context.find('.answerBtnsOn').length > 0 ? context.find('.answerBtnsOn').length : 0); }`

问题是第 1 步工作正常，它确实在用户单击“添加”按钮后显示文本框中“答案数量”列中的数字。

问题是第 2 步，在用户单击按钮后，它没有显示当前打开多少个按钮的正确数字。它`#btn+gridValues`只是不会更改文本框中的数字。

有谁知道为什么会发生这种情况以及如何解决？

演示：

这是该应用程序的[演示](http://helios.hud.ac.uk/u0867587/Mobile_app/Text14.php)。请按照以下步骤操作：

第 1 步：在左侧，您会看到一个绿色的加号按钮，单击它会打开一个模式窗口。第2步：在模态窗口有一个搜索栏，输入“AAA”并提交搜索，你会看到一堆行出现。第 3 步：在最后一行中，您会在“答案数量”列下看到它包含数字 4，单击该行中的“添加”按钮，模式窗口将关闭。

您将看到文本框在文本框中显示数字 4，这很好，因为这是添加行时“答案数”列下的行中的数字。

但问题如下：

第 4 步：如果单击“Open Grid”链接并选择按钮 3，您将看到下面的字母按钮变为 AC，仅打开字母“B”。

在文本框中它应该显示数字 1，因为只有 1 个按钮被打开，但它不显示这个数字，这就是我遇到的问题。

如何解决这个问题？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-07-17T16:39:06.670

您正在使用：

```
$('#mainNumberAnswerTxt').data('data-ignore') 
```

有了[`.data()`](http://api.jquery.com/jQuery.data/)你就不需要提到前缀了`data-`。这应该改为：

```
$('#mainNumberAnswerTxt').data('ignore') 
```

# android - 创建对 Context 的静态引用，到处使用它，最后让 Garbage Collected

> ID：11526632
> 
> 赞同：1
> 
> 时间：2012-07-17T16:14:38.770
> 
> 标签：android, memory-management, android-activity

我对到处都需要**活动/应用程序**有一点问题......
更准确地说，我有这样定义的类：

```
public class MyApp extends Application {

     private static Activity currentActivity;
     private static MyApp instance;

     @Override
     public void onCreate() {
         super.onCreate();
         instance = this;
     }

     public static void setCurrentActivity(Activity activity) {
         currentActivity = activity;
     }
} 
```

我有一个这样的扩展活动：

```
public class MyActivity extends Activity {

       ....

       @Override
       public void onResume() {
          super.onResume();
          MyApp.setCurrentActivity(this);
       }

       ....

       @Override
       public void onDestroy() {
          super.onDestroy();   
          MyApp.setCurrentActivity(null);  // for nullifying static reference

       }
 } 
```

我的问题是：

1.  上面的代码片段公平吗？
2.  我应该`super.onDestroy();`在之后使用`MyApp.setCurrentActivity(null);`来验证活动没有成功引用和销毁吗？
3.  最重要的是，**静态**引用*实例*呢？我在哪里可以取消它以不阻止 GC ？

谢谢。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-07-17T16:34:29.613

> 1.  上面的代码片段公平吗？

没有。最大的问题在`MyActivity.onDestroy()`. 这可以在活动不再使用时（即：**完成后）****随时**调用。如果您取消，您将**不会**清除对 的引用，您将清除对当前当前处于活动状态的任何活动的引用。我你真的想指出当前的活动，你能做的最好的事情是这样的：@Override public void onPause() { super.onPause(); if (MyApp.getCurrentActivity() == this) { MyApp.setCurrentActivity(null); } }**`currentActivity``onDestroy()`**`MyActivity``currentActivity`****

 ****`onPause()`另外，请注意，活动和下一个活动之间有一个小窗口，因此在此期间`onResume()`可能会为空。`currentActivity`小心那个！

> 我应该使用 super.onDestroy(); 在 MyApp.setCurrentActivity(null); 之后 验证活动没有成功引用和销毁？

请参阅我上面的评论。您不能在 中取消此引用`onDestroy()`。

> 最重要的是，静态引用实例呢？我在哪里可以取消它以不阻止 GC ？

你不需要。created只有一个实例，`MyApp`只要您的进程存在，它就会一直存在。当 Android 不再需要您的进程时，它只会终止该进程，这将自动清理所有内容。****

# git - 设置 git 以推送到另一个用户的 Github 存储库？

> ID：11526634
> 
> 赞同：6
> 
> 时间：2012-07-17T16:14:48.680
> 
> 标签：git, github

假设我`user1`和我有一个 Github 帐户`http://github.com/user1`。自然，我会在本地设置 git，如下所示：

```
origin git@github.com:user1/repo.git (fetch)
origin git@github.com:user1/repo.git (push) 
```

如果我有获取和推送权限到其他人的仓库（比方说`user2`），其仓库位于 ，我会怎么做`http://github.com/user2/user2srepo.git`？

编辑：对不起，每个人的答案都是正确的。我应该澄清一下，我曾经将其设置为，`origin http://github.com/user2/user2srepo.git`但我想避免每次推送时都被要求提供用户凭据。

* * *

## 回答 #1

> 赞同：8
> 
> 时间：2012-07-17T16:21:20.347

假设您的 github 存储库都用于相同的代码库，您可以将它们都作为遥控器添加到本地存储库：

```
git remote add otherusersorigin http://github.com/user2/user2srepo.git 
```

然后在需要时使用该别名：

```
git fetch otherusersorigin
git push otherusersorigin 
```

要在没有身份验证提示的情况下执行此操作，请根据标准 GitHub 说明为您自己设置 SSH 密钥，并让其他人将您添加为该存储库的协作者。

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2012-07-17T16:32:06.597

事实证明这比我想象的要容易。感谢@MattGibson 和@eykanal 在评论中的帮助，我意识到我可以按如下方式设置遥控器：

```
origin git@github.com:user2/user2srepo.git (fetch)
origin git@github.com:user2/user2srepo.git (push) 
```

这里的区别是用户被设置为`user2`而不是我自己的用户名。我错误地认为我需要输入`user2`的凭据，但如果我被设置为`user2srepo`.

对于那些感兴趣的人，如果您已经拥有远程设置，则设置此命令的命令如下：

```
git remote set-url origin git@github.com:user2/user2srepo.git 
```

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-07-17T16:21:33.527

如果您对该存储库具有写入权限，只需克隆该存储库并直接提交到它。你不需要经历分叉过程。

# c# - 使用 Html Agility Pack 抓取 H3 的 InnerText

> ID：11526636
> 
> 赞同：2
> 
> 时间：2012-07-17T16:14:52.353
> 
> 标签：c#, html-agility-pack

我将如何仅选择此 h3 中的周数而不选择其中的跨度标签？

仅选择包含跨度的 H3 会导致将一些 ascii 文本添加到结果消息框中。

结果：

```
Â WeekÂ 1 
```

源文件：

```
<h3>
<span> </span>Week 1</h3> 
```

代码：

```
private void getWeekNumber(string url)
{
    HtmlAgilityPack.HtmlDocument htmlDoc = new HtmlAgilityPack.HtmlDocument();

    htmlDoc.Load(new System.IO.StringReader(url));

    foreach (HtmlAgilityPack.HtmlNode h3 in htmlDoc.DocumentNode.SelectNodes("//h3"))
    {
        MessageBox.Show(h3.InnerText);
    }
} 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-07-17T16:23:33.993

`RemoveChild(...)`在显示消息框之前尝试使用删除跨度节点。

欲了解更多信息：

[html 敏捷包删除子项](https://stackoverflow.com/questions/1444922/html-agility-pack-remove-children?rq=1)

# jquery-mobile - Jquery移动显示/隐藏div点击

> ID：11526641
> 
> 赞同：0
> 
> 时间：2012-07-17T16:15:06.807
> 
> 标签：jquery-mobile

我有一个 jquery 移动页面，其中包含一个按钮，点击该按钮时应该显示/隐藏一个 div。我似乎错过了什么。我已经解决了关于 SO 的类似问题，但没有成功，有人能建议我哪里出错了吗？

HTML：

```
<a href="#" id="moreFilters" class="moreFilters" data-role="button">View more filters</a>
<div id="filters"> Blah </div> 
```

CSS：

```
div#filters {
    display: none;
} 
```

JQ:

```
$('#myPage').live('pageinit', function(event) {
    $("#moreFilters").bind('tap',function(event, ui){
        $('#filters').toggle('fast', function() {});
    })
}); 
```

我也试过：

```
$('#moreFilters').live('tap',function(event) {
    $("#filters").toggle(); //  toggles the visibility/display of the element.
}); 
```

谁能指出我正确的方向？

提前谢谢了

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-07-17T21:52:25.373

你能做这样的事情吗

```
<script>
    var isMenuVisible = true

    function showHideMenu() {
        isMenuVisible = !isMenuVisible;
        var menuPrin= document.getElementById("divMenu");

        if(isMenuVisible) {
            menuPrin.style.visibility = "visible";
            menuPrin.style.width = "30%";
        } else {
            menuPrin.style.visibility = "hidden";
            menuPrin.style.width = "0%";
        }
    }
</script> 
```

这`script`可以你把它放在你的页面的末尾。

现在，将您指向您`id="divMenu"`想要`div`隐藏、确定和`onclick="showHideMenu();"`在触发事件的元素上运行的内容。

所有这些都模拟它`tap`和`toggle`事件。

我希望这有帮助。:)

# javascript - 会话丢失 window.location.href

> ID：11526643
> 
> 赞同：1
> 
> 时间：2012-07-17T16:15:11.657
> 
> 标签：javascript, html, session

我正在尝试将用户重定向到另一个页面宽度：

```
window.location.href = "url here" //relative link 
```

但是当我这样做时，它会清除我的`sessvars.keyPageArray`变量。任何人都知道如何在重定向后保留会话变量？

这是我正在使用的 sessvars 库： [http ://www.thomasfrank.se/sessionvars.html](http://www.thomasfrank.se/sessionvars.html)

更新：我使用了谷歌浏览器调试器，我的脚本确实有效。出于某种疯狂的原因，它仅在我通过变量监视它时才有效，但在我只是在没有调试器的情况下正常运行时无效？为什么会这样？

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-07-17T16:21:46.820

仅仅因为您命名了一个变量`sessvars`并不能使它如此。根据您的需要使用[`localStorage`](https://developer.mozilla.org/en/DOM/Storage#localStorage)或cookie。[`sessionStorage`](https://developer.mozilla.org/en/DOM/Storage#sessionStorage)

当浏览器导航到另一个页面时，所有 javascript 上下文都会被卸载并丢失。

使用示例`localStorage`：

```
window.onbeforeunload = function() {
    localStorage.setItem( "session", JSON.stringify( window.sessvars) );
};

window.onload = function() {
    window.sessvars = JSON.parse( localStorage.getItem( "session") || "{}" );;
}; 
```

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-07-17T16:17:14.607

会话在**服务器端**。

与浏览器无关。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-07-17T16:19:52.560

JavaScript 在页面关闭、打开另一个页面或刷新时不保留数据。最终，您可以将数据存储在 cookie 中。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2015-03-06T12:59:07.537

导致问题的一件重要事情是服务器 /phptmp 目录不存在或没有写入权限时。

# c++ - 使用“？”有什么缺点吗？而不是 L'?' 与 wchar_t？

> ID：11526650
> 
> 赞同：5
> 
> 时间：2012-07-17T16:15:33.047
> 
> 标签：c++, c, character, wchar-t

`'?'`使用-style 字符文字来比较或分配给已知为 type 的值`wchar_t`，而不是使用-style 文字是否有任何缺点`L'?'`？

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2012-07-17T16:20:11.513

他们有错误的数据类型和编码，所以这是个坏主意。编译器将使用标准整数转换（例如符号扩展）默默地扩展字符文字（对于字符串，您会得到类型不匹配的编译错误）。但值可能不匹配。

例如，字符 0x80 到 0xff 经常映射到不同的 Unicode 代码点，而确切的映射因编译器的代码页而异。

显然，Unicode 不可能使用身份转换来映射所有不同的代码页。 **如果仅仅扩大就足够了，就不需要像`mbtowcs`.**

WRT 你关于`'\xAB'`vs的具体问题`L'\xAB'`，它们可能不相等。见[http://ideone.com/b1E39](http://ideone.com/b1E39)

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2012-07-17T16:27:03.223

正如我所提到的，标准说

> char 数组（无论是普通`char`的`signed char`、 还是`unsigned char`）、`char16_t`数组、`char32_t`数组或`wchar_t`数组都可以由窄字符字面量初始化...

但是，在`__STDC_MB_MIGHT_NEQ_WC__`预处理器定义部分中，它说

> 整数常量 1，旨在表明，在 的编码中`wchar_t`，基本字符集的成员在用作普通字符文字中的唯一字符时，其代码值不需要等于其值。

对于`__STDC_ISO_10646__`：

> yyyymmL 形式的整数常量（例如，199712L）。如果定义了此符号，则 Unicode 所需集中的每个字符在存储在类型对象中时`wchar_t`，都具有与该字符的短标识符相同的值。

我不完全是解释标准的专业人士，但我认为这意味着您的问题的答案是它们可能有不同的表示，您应该始终使用`L`.

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-07-18T01:17:50.273

The only downside is that your program might fail on stone-age systems using EBCDIC. On any real world system worth consideration, `char` and `wchar_t` values for the portable character set are all ASCII, and on increasingly many (but not all), `wchar_t` is a Unicode codepoint number.

# jpa - 如何将 Apache-Commons DBCP 与 EclipseLink JPA 和 Tomcat 7.x 一起使用

> ID：11526654
> 
> 赞同：2
> 
> 时间：2012-07-17T16:15:53.873
> 
> 标签：jpa, eclipselink, apache-commons-dbcp

我一直在开发一个部署在 Tomcat 7 上的 Web 应用程序，它使用 EclipseLink JPA 来处理持久层。

在测试环境中一切正常，但由于防火墙切断了非活动连接，我们在生产环境中遇到了严重问题。基本上，如果连接在一段时间内处于非活动状态，则位于 Tomcat 服务器和 DB 服务器之间的防火墙会杀死它，结果是在池中留下“陈旧”的连接。

下次使用该连接时，代码永远不会返回，直到它收到“连接超时”SQLException（下面的完整 ex.getMessage()）。

> EL Fine]: 2012-07-13 18:24:39.479--ServerSession(309463268)--Connection(69352859)--Thread(Thread[http-bio-8080-exec-5,5,main])--我的已替换查询以将其发布到 SO [EL 配置]：2012-07-13 18:40:10.229--ServerSession(309463268)--Connection(69352859)--Thread(Thread[http-bio-8080-exec-5, 5,main])--断开[EL Info]: 2012-07-13 18:40:10.23--UnitOfWork(1062365884)--Thread(Thread[http-bio-8080-exec-5,5,main]) --尝试在事务之外执行读取查询时检测到通信失败。正在尝试重试查询。错误为：异常 [EclipseLink-4002] (Eclipse Persistence Services - 2.3.0.v20110604-r9504)：org.eclipse.persistence.exceptions.DatabaseException 内部异常：java.sql.SQLException：Eccezione IO：连接超时

我已经在persistence.xml 中尝试了几种配置，但是由于我无法访问防火墙配置，所以我对这些方法没有运气。我也尝试使用 setCheckConnections()

```
ConnectionPool cp = ((JpaEntityManager)em).getServerSession().getDefaultConnectionPool();
        cp.setCheckConnections();
        cp.releaseConnection(cp.acquireConnection()); 
```

我设法使用 testOnBorrow、testWhileIdle 和 DBCP Apache Commons 提供的其他功能在测试脚本中解决了这个问题。我想知道如何覆盖 EclipseLink 内部连接池以使用自定义连接池，以便我可以提供基于 DBCP 的已配置池，而不仅仅是使用 persistence.xml 配置内部连接池。

我知道我应该提供一个 SessionCustomizer，我不确定哪一个是正确的模式。基本上我想以类似 JPA 的方式保留 DBCP 的性能。

我在 Tomcat 7 上进行部署，我知道如果我切换到 GF，我不会遇到这个问题，但是为了与同一服务器上的其他 webapp 保持一致，我更愿意留在 Tomcat 上。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-07-20T15:20:21.757

你想要的绝对是可能的，但你可能会达到“自己动手”方法的极限。

这是比较难解释的事情之一，但实际上有两种方法可以配置您的`EntityManagerFactory`. “自己动手”方法和“容器”方法。

当你调用它时，它最终会委托给EclipseLink 实现`Persistence.createEntityManagerFactory`的接口的这个方法：`PersistenceProvider`

```
EntityManagerFactory    createEntityManagerFactory(String emName, Map map) 
```

这里的交易是 EclipseLink 将自行完成所有工作，包括它自己的连接创建和处理。这是“自己动手”的方法。我不太了解 EclipseLink，不知道是否有办法使用这种方法为其提供连接。在 Stackoverflow 上呆了两天后，似乎其他人也没有这些信息。

所以这就是为什么这“在 GF 中有效”。当您让容器`EntityManagerFactory`通过注入或查找它来为您创建时，容器在`PersistenceProvider`EclipseLink 实现的接口上使用不同的方法：

```
EntityManagerFactory createContainerEntityManagerFactory(PersistenceUnitInfo info, Map map) 
```

总而言之，这`PersistenceUnitInfo`是一个容器实现的接口，上面有这两个非常关键的方法：

```
public DataSource getJtaDataSource();
public DataSource getNonJtaDataSource(); 
```

在这种模式下，EclipseLink 不会尝试进行自己的连接处理，而是简单地调用这些方法`DataSource`从容器中获取连接。这确实是您所需要的。

您可以采取两种可能的方法来解决此问题：

*   您可以尝试自己实例化 EclipseLink`PersistenceProvider`实现，并调用`createContainerEntityManagerFactory`传递您自己的`PersistenceUnitInfo`接口实现的方法，并以这种方式将 DBCP 配置的`DataSource`实例提供给 EclipseLink。您需要自己解析`persistence.xml`文件并通过`PersistenceUnitInfo`. EclipseLink 也可能期望一个`TransactionManager`，在这种情况下，除非您找到可以添加到 Tomcat 的 TransactionManager，否则您将被卡住。

*   您可以使用 Tomcat 的 Java EE 6 认证版本[TomEE](http://tomee.apache.org)。数据源在 中配置`tomee.xml`，使用 DBCP 创建并完全支持您需要的所有选项，并`PersistenceProvider`使用所描述的`createContainerEntityManagerFactory`调用传递给。然后，您`EntityManagerFactory`通过注入`@PersistenceUnit`或查找它。

如果您确实尝试使用 TomEE，请确保您`persistence.xml`已更新为显式设置`transaction-type="RESOURCE_LOCAL"`，因为默认值为`JTA`. 即使使用`JTA`该`Persistence.createEntityManagerFactory`方法不合规，也没有任何持久性提供者会抱怨并让您知道您做错了什么，他们将其视为`RESOURCE_LOCAL`忽略模式。因此，当您将应用程序移植到实际经过认证的服务器时，它会崩溃。

关于 TomEE 的另一个注意事项是，在当前版本中，您必须将 EclipseLink 库放在`<tomcat>/lib/`目录中。这是在主干中修复的，只是尚未发布。

如果没有随附的解释，我不确定这些幻灯片会有多大用处，但本演示文稿的第二部分深入探讨[了容器管理的 EntityManager 的工作方式，特别是关于连接处理和事务](http://svn.apache.org/repos/asf/openejb/trunk/presentations/2012_JAXConf_Tomcat_to_JavaEE_with_TomEE.pdf)。您可以忽略事务部分，因为您没有使用它们并且已经在生产中，您不太可能进行显着更改，但它可能对未来的开发很有趣。

祝你好运！

# python - 使用字符串在 ndb 中定义字段

> ID：11526661
> 
> 赞同：0
> 
> 时间：2012-07-17T16:16:25.630
> 
> 标签：python, google-app-engine, introspection

这是我的代码：

```
class SocialNodeSubscription(model.Model):
  def __init__(self, *args, **kwargs):
    permissions=["post","read","reply","admin"]
    for p in permissions:
      self.__dict__["can_"+p]=model.BooleanProperty(default=True) 
```

我需要在我的模型中动态定义字段，但这似乎不起作用，因为**dict**不是放置我的字段的正确位置。

对于不了解 ndb 的人来说，这就是它看起来更简单的方式。

```
class SocialNodeSubscription(model.Model):
  def __init__(self, *args, **kwargs):
    self.can_write=model.BooleanProperty(default=True)
    self.can_read=model.BooleanProperty(default=True)
      ... 
```

编辑：

现在我的代码如下所示：

```
def __init__(self, *args, **kwargs):
    permissions=["post","read","reply","admin"]

    for p in permissions:
        self._properties["can_"+p]=model.BooleanProperty(default=True)        
     self._fix_up_properties() 
```

但我仍然收到此错误。

> _store_value entity._values[self._name] = value TypeError: 'NoneType' object 中的文件“C:\Program Files (x86)\Google\google_appengine\google\appengine\ext\ndb\model.py”，第 972 行不支持项目分配

这是什么意思？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-07-17T16:25:12.687

它是_properties，看看它的元类MetaModel和类方法_fix_up_properties。

_properties 的定义：

```
 # Class variables updated by _fix_up_properties()
 _properties = None 
```

方法：

```
 @classmethod
  def _fix_up_properties(cls):
  """Fix up the properties by calling their _fix_up() method.

  Note: This is called by MetaModel, but may also be called manually
  after dynamically updating a model class.
  """ 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-07-17T17:48:18.933

对具有动态属性的模型使用[expando 模型](https://developers.google.com/appengine/docs/python/ndb/entities#expando)。

# ruby - 在 Ubuntu Server 11.10 上安装 mysql2 gem 时出错：/usr/bin/ld: 找不到 -lmysqlclient_r

> ID：11526664
> 
> 赞同：3
> 
> 时间：2012-07-17T16:16:32.453
> 
> 标签：ruby, ubuntu, gem, mysql2

我在其他一些帖子中提到的 Ubuntu Server 11.10 x64 上遇到了同样的错误： [帖子 #1](https://stackoverflow.com/questions/10634949/rails-3-2-3-mysql-5-5-1-mysql2-gem-install-fails-with-ld-incompatibilities) [帖子 #2](https://stackoverflow.com/questions/8475902/error-installing-mysql2-gem-on-debian-squeeze)

由于“找不到 -lmysqlclient_r”，无法编译 mysql2 gem

我在用着：

*   红宝石 v1.8.7
*   MySQL v5.5.25-1
*   导轨 3.2.3
*   宝石 1.8.24

我安装了软件包 libmysqlclient-dev ，它仍然无法正常工作。

文件 - libmysqlclient_r.a - libmysqlclient_r.so - libmysqlclient_r.so.18 - libmysqlclient_r.so.18.0.0 位于 /usr/lib/x86_64-linux-gnu/

所以我在 /usr/lib/ 中创建了符号链接 Ii 仍然不起作用:(

任何想法？？

```
$ sudo gem install mysql2
Building native extensions.  This could take a while...
ERROR:  Error installing mysql2:
        ERROR: Failed to build gem native extension.

        /usr/bin/ruby1.8 extconf.rb
checking for rb_thread_blocking_region()... no
checking for rb_wait_for_single_fd()... no
checking for mysql.h... yes
checking for errmsg.h... yes
checking for mysqld_error.h... yes
creating Makefile

make
gcc -I. -I. -I/usr/lib/ruby/1.8/x86_64-linux -I. -DHAVE_MYSQL_H -DHAVE_ERRMSG_H -DHAVE_MYSQLD_ERROR_H    -I/usr/include/mysql -DBIG_JOINS=1  -fno-strict-aliasing  -g -fPIC -fno-strict-aliasing -g -g -O2  -fPIC  -Wall -funroll-loops  -c mysql2_ext.c
./client.h:16:1: warning: ârb_thread_blocking_regionâ defined but not used [-Wunused-function]
gcc -I. -I. -I/usr/lib/ruby/1.8/x86_64-linux -I. -DHAVE_MYSQL_H -DHAVE_ERRMSG_H -DHAVE_MYSQLD_ERROR_H    -I/usr/include/mysql -DBIG_JOINS=1  -fno-strict-aliasing  -g -fPIC -fno-strict-aliasing -g -g -O2  -fPIC  -Wall -funroll-loops  -c result.c
result.c: In function ârb_mysql_result_fetch_rowâ:
result.c:258:31: warning: variable âtokensâ set but not used [-Wunused-but-set-variable]
result.c:272:58: warning: variable âtokensâ set but not used [-Wunused-but-set-variable]
result.c:315:33: warning: variable âtokensâ set but not used [-Wunused-but-set-variable]
gcc -I. -I. -I/usr/lib/ruby/1.8/x86_64-linux -I. -DHAVE_MYSQL_H -DHAVE_ERRMSG_H -DHAVE_MYSQLD_ERROR_H    -I/usr/include/mysql -DBIG_JOINS=1  -fno-strict-aliasing  -g -fPIC -fno-strict-aliasing -g -g -O2  -fPIC  -Wall -funroll-loops  -c client.c
client.c: In function ârb_mysql_client_infoâ:
client.c:539:3: warning: variable âwrapperâ set but not used [-Wunused-but-set-variable]
gcc -shared -o mysql2.so mysql2_ext.o result.o client.o -L. -L/usr/lib -L. -Wl,-Bsymbolic-functions -rdynamic -Wl,-export-dynamic -Wl,-rpath,/usr/lib/x86_64-linux-gnu    -lruby1.8 -L/usr/lib/x86_64-linux-gnu -lmysqlclient_r -lpthread -lz -lm -lrt -ldl  -lpthread -lrt -ldl -lcrypt -lm   -lc
/usr/bin/ld: cannot find -lmysqlclient_r
collect2: ld returned 1 exit status
make: *** [mysql2.so] Error 1 
```

# php - 在 php 中定义路径目录以用于页面标题（从 ColdFusion 迁移）

> ID：11526668
> 
> 赞同：0
> 
> 时间：2012-07-17T16:17:10.737
> 
> 标签：php, html, variables, coldfusion

我知道如何在 ColdFusion 中执行此操作，我正在尝试使用相同的语法来根据需要定义根目录、子目录和文件名（目标是当客户端单击任何页面时，它的标题将由部分或目录定义它位于）。

这是我为 CF 编写的代码（抱歉有很多）：

```
<cfset REQUEST.directory_path = listDeleteAt(CGI.script_name, listLen(CGI.script_name, "/"), "/")>
<cfset REQUEST.directory_top = listFirst(CGI.script_name, "/")>
<cfset REQUEST.filename = listFirst(listLast(CGI.script_name, "/"), ".")>

<!--- Array of directory names --->
<cfset REQUEST.directory_array = ListToArray(REQUEST.directory_path,"/")>
<cfif ArrayLen(REQUEST.directory_array) GTE 1>
<cfset REQUEST.directory_parent = REQUEST.directory_array[ArrayLen(REQUEST.directory_array)]>
<cfelse>
    <cfset REQUEST.directory_parent = REQUEST.filename>
</cfif>

<cfset VARIABLES.filename = REQUEST.filename>
<cfset VARIABLES.directory = REQUEST.directory_parent>
<cfset VARIABLES.primarydir = REQUEST.directory_top>
<cfset VARIABLES.secondarydir = GetToken(REQUEST.directory_path,  2 ,  "/")>
<cfset VARIABLES.tertiarydir = GetToken(REQUEST.directory_path,  3 ,  "/")>
<cfset VARIABLES.quaternarydir = GetToken(REQUEST.directory_path,  4 ,  "/")>
<cfif VARIABLES.primarydir EQ "index.cfm">
    <cfset VARIABLES.primarydir = "index">
</cfif> 
```

然后我有一个简单的 switch 语句来定义我的各个部分：

```
<cfswitch expression="#VARIABLES.PrimaryDir#">
<cfcase value="photography">
    <cfset VARIABLES.page_title_section = "Home">
    <cfset VARIABLES.PrimaryDir EQ 'photography'>
</cfcase>
<cfcase value="clients">
    <cfset VARIABLES.page_title_section = " Clients">
    <cfset VARIABLES.PrimaryDir EQ 'clients'>
    </cfcase> 
```

等等等等

我想我可以在 PHP 中创建 switch 语句，但是如何定义上面的目录结构？我确实看过这里： http: [//php.net/manual/en/function.pathinfo.php](http://php.net/manual/en/function.pathinfo.php)但我不是 100% 确定我传递给 php 以使其正常工作。

希望有人可以提供帮助。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-07-17T16:22:43.480

我对 ColdFusion 几乎一无所知，但如果我理解正确，您可以通过检查`$_SERVER['REQUEST_URI']`属性获得相同的效果：

```
// Use substring to ignore first forward slash
$requestArray = explode('/', substr($_SERVER['REQUEST_URI'],1)); 
```

这将为您提供一个等于当前请求的一维数组。例如，如果用户请求以下 URL：

```
http://www.domain.com/dir1/dir2/dir3/page.php 
```

然后`$requestArray`将是：

```
Array( 0 => 'dir1', 1 => 'dir2', 2 => 'dir3', 3 => 'page.php') 
```

如果用户请求主页（http://www.domain.com），那么请求数组将为空。

有关更多信息，请查看手册条目[`$_SERVER`](http://php.net/manual/en/reserved.variables.server.php)

# html - 粘性 CSS 页脚

> ID：11526671
> 
> 赞同：1
> 
> 时间：2012-07-17T16:17:25.387
> 
> 标签：html, css

有人可以帮我从 HTML5 Boilerplate Initializser 制作原始代码，让页脚贴在浏览器的底部，我已经尝试了 Web 示例中的所有代码庄园，但不幸的是，我认为像往常一样，样板预定义的 CSS 会影响定位和页脚的“粘贴”。

这是我的CSS：

```
 /* =============================================================================
   HTML5 Boilerplate CSS: h5bp.com/css
   ========================================================================== */
article, aside, details, figcaption, figure, footer, header, hgroup, nav, section { display: block; }
audio, canvas, video { display: inline-block; *display: inline; *zoom: 1; }
audio:not([controls]) { display: none; }
[hidden] { display: none; }

html { font-size: 100%; -webkit-text-size-adjust: 100%; -ms-text-size-adjust: 100%; height: 100%;}
html, button, input, select, textarea { font-family: sans-serif; color: #222; }
body { margin: 0; font-size: 0.9em; line-height: 1.4; height: 100%;}

::-moz-selection { background: #fe57a1; color: #fff; text-shadow: none; }
::selection { background: #fe57a1; color: #fff; text-shadow: none; }

a { color: #00e; }
a:visited { color: #551a8b; }
a:hover { color: #06e; }
a:focus { outline: thin dotted; }
a:hover, a:active { outline: 0; }

abbr[title] { border-bottom: 1px dotted; }
b, strong { font-weight: bold; }
blockquote { margin: 1em 40px; }
dfn { font-style: italic; }
hr { display: block; height: 1px; border: 0; border-top: 1px solid #ccc; margin: 1em 0; padding: 0; }
ins { background: #ff9; color: #000; text-decoration: none; }
mark { background: #ff0; color: #000; font-style: italic; font-weight: bold; }
pre, code, kbd, samp { font-family: monospace, serif; _font-family: 'courier new', monospace; font-size: 0.9em; }
pre { white-space: pre; white-space: pre-wrap; word-wrap: break-word; }
q { quotes: none; }
q:before, q:after { content: ""; content: none; }
small { font-size: 85%; }

sub, sup { font-size: 75%; line-height: 0; position: relative; vertical-align: baseline; }
sup { top: -0.5em; }
sub { bottom: -0.25em; }

ul, ol { margin: 1em 0; padding: 0 0 0 40px; }
dd { margin: 0 0 0 40px; }
nav ul, nav ol { list-style: none; list-style-image: none; margin: 0; padding: 0; }

img { border: 0; -ms-interpolation-mode: bicubic; vertical-align: middle; }

svg:not(:root) { overflow: hidden; }

figure { margin: 0; }

form { margin: 0; }
fieldset { border: 0; margin: 0; padding: 0; }
label { cursor: pointer; }
legend { border: 0; *margin-left: -7px; padding: 0; white-space: normal; }
button, input, select, textarea { font-size: 100%; margin: 0; vertical-align: baseline; *vertical-align: middle; }
button, input { line-height: normal; }
button, input[type="button"], input[type="reset"], input[type="submit"] { cursor: pointer; -webkit-appearance: button; *overflow: visible; }
button[disabled], input[disabled] { cursor: default; }
input[type="checkbox"], input[type="radio"] { box-sizing: border-box; padding: 0; *width: 13px; *height: 13px; }
input[type="search"] { -webkit-appearance: textfield; -moz-box-sizing: content-box; -webkit-box-sizing: content-box; box-sizing: content-box; }
input[type="search"]::-webkit-search-decoration, input[type="search"]::-webkit-search-cancel-button { -webkit-appearance: none; }
button::-moz-focus-inner, input::-moz-focus-inner { border: 0; padding: 0; }
textarea { overflow: auto; vertical-align: top; resize: vertical; }
input:valid, textarea:valid {  }
input:invalid, textarea:invalid { background-color: #f0dddd; }

table { border-collapse: collapse; border-spacing: 0; }
td { vertical-align: top; }

.chromeframe { margin: 0.2em 0; background: #ccc; color: black; padding: 0.2em 0; }

/* ===== Initializr Styles =====================================================
   Author: Jonathan Verrecchia - verekia.com/initializr/responsive-tfont-sizeplate
   ========================================================================== */

body{ font:16px/26px Helvetica, Helvetica Neue, Arial; }

.wrapper{
    width:90%;
    margin:0 5%;
    min-height: 100%;
}

/* ===================
    ALL: Blue Theme 
   =================== */

#header-container{ border-bottom: 20px solid #22558b; width:100% }
#footer-container{ border-top:    20px solid #22558b; width:100%}
#main aside      { border-top:    20px solid #22558b; }

#header-container,
#footer-container,
#main aside{
    background:#2c6cb1;
}

#title{color:white; }

::-moz-selection { background: #2c6cb1; color: #fff; text-shadow: none; }
::selection      { background: #2c6cb1; color: #fff; text-shadow: none; }

/* ==============
    MOBILE: Menu
   ============== */

nav a{
    display:block;
    margin-bottom:10px;
    padding:15px 0;

    background:#22558b;
    color:white;

    text-align:center;
    text-decoration:none;
    font-weight:bold;
}

nav a:hover, nav a:visited{
    color:white;
}

nav a:hover{
    text-decoration:underline;
}

/* ==============
    MOBILE: Main
   ============== */

#main{
    padding:30px 0;
}

#main article h1{
    font-size:2em;
}

#main aside{
    color:white;
    padding:0px 5% 10px;
}

#footer-container footer{
    color:white;
    padding:20px 0;
    clear:both;
    }

/* ===============
    ALL: IE Fixes
   =============== */

.ie7 #title{ padding-top:20px; }

/* ===== Primary Styles ========================================================
   Author: Christopher Leah of Happy Webs LTD - 07/2012
   ========================================================================== */
 .btn{clear:left;float:left; width:79px; margin-left:5px; margin-bottom:2px;}
.ColHead{float:left; width:50px; margin-left:5px; background-color:#22558B;color:#ffffff;margin-bottom:2px;}
.RowHead{clear:left;float:left; width:75px; margin-left:5px;background-color:#2C6CB1;color:#ffffff;margin-bottom:2px;}
.gridBoxes{float:left; width:50px; margin-left:5px; margin-bottom:2px;}
.graph{margin-top:10px;float:left;}
h3.left {float: left; width:49%;}
h3.right {float: right; width:49%; text-align:right;}
#footer-container a { color:#fff; text-decoration:none; }
#footer-container a:hover { text-shadow: 1px 1px 1px #000; }
.txtSmall {width:50px;}
#title a{color:#fff; text-shadow: 1px 1px 1px #000; text-decoration:none;}
.disclaimer { font-size:0.8em;}
.disclaimer a{ color:#22558B;}

/* =============================================================================
   Media Queries
   ========================================================================== */

@media only screen and (min-width: 480px) {

/* ====================
    INTERMEDIATE: Menu
   ==================== */  
    nav a{
        float:left;
        width:27%;
        margin:0 1.7%;
        padding:25px 2%;
        margin-bottom:0;
    }   
    nav li:first-child a{ margin-left:0;  }
    nav li:last-child  a{ margin-right:0; } 
/* ========================
    INTERMEDIATE: IE Fixes
   ======================== */

    nav ul li{
        display:inline;
    }   
    .oldie nav a{
        margin:0 0.7%;      
    }
}

@media only screen and (min-width: 768px) {

/* ====================
    WIDE: CSS3 Effects
   ==================== */

    #header-container,
    #main aside{
        -webkit-box-shadow:0 5px 10px #aaa;
           -moz-box-shadow:0 5px 10px #aaa;
                box-shadow:0 5px 10px #aaa;
    }

/* ============
    WIDE: Menu
   ============ */

    #title{
        float:left;
        text-shadow: 1px 1px 1px #000;
    }

    nav{
        float:right;
        width:38%;
    }

/* ============
    WIDE: Main
   ============ */

    #main article{
        float:left;
        width:57%;
    }

    #main aside{
        float:right;
        width:28%;
    }
}

@media only screen and (min-width: 1140px) {

/* ===============
    Maximal Width
   =============== */

    .wrapper{
        width:1026px; /* 1140px - 10% for margins */
        margin:0 auto;
    }
}

/* =============================================================================
   Non-Semantic Helper Classes
   ========================================================================== */

.ir { display: block; border: 0; text-indent: -999em; overflow: hidden; background-color: transparent; background-repeat: no-repeat; text-align: left; direction: ltr; *line-height: 0; }
.ir br { display: none; }
.hidden { display: none !important; visibility: hidden; }
.visuallyhidden { border: 0; clip: rect(0 0 0 0); height: 1px; margin: -1px; overflow: hidden; padding: 0; position: absolute; width: 1px; }
.visuallyhidden.focusable:active, .visuallyhidden.focusable:focus { clip: auto; height: auto; margin: 0; overflow: visible; position: static; width: auto; }
.invisible { visibility: hidden; }
.clearfix:before, .clearfix:after { content: ""; display: table; }
.clearfix:after { clear: both; }
.clearfix { *zoom: 1; }

/* =============================================================================
   Print Styles
   ========================================================================== */

@media print {
  * { background: transparent !important; color: black !important; box-shadow:none !important; text-shadow: none !important; filter:none !important; -ms-filter: none !important; } /* Black prints faster: h5bp.com/s */
  a, a:visited { text-decoration: underline; }
  a[href]:after { content: " (" attr(href) ")"; }
  abbr[title]:after { content: " (" attr(title) ")"; }
  .ir a:after, a[href^="javascript:"]:after, a[href^="#"]:after { content: ""; }  /* Don't show links for images, or javascript/internal links */
  pre, blockquote { border: 1px solid #999; page-break-inside: avoid; }
  thead { display: table-header-group; } /* h5bp.com/t */
  tr, img { page-break-inside: avoid; }
  img { max-width: 100% !important; }
  @page { margin: 0.5cm; }
  p, h2, h3 { orphans: 3; widows: 3; }
  h2, h3 { page-break-after: avoid; }
} 
```

这是我的 HTML：

```
<!doctype html>

<!--[if lt IE 7]> <html class="no-js lt-ie9 lt-ie8 lt-ie7" lang="en"> <![endif]-->

<!--[if IE 7]>    <html class="no-js lt-ie9 lt-ie8" lang="en"> <![endif]-->

<!--[if IE 8]>    <html class="no-js lt-ie9" lang="en"> <![endif]-->

<!--[if gt IE 8]><!--> <html class="no-js" lang="en"> <!--<![endif]-->

<head id="Head1"><meta charset="utf-8" /><meta http-equiv="X-UA-Compatible" content="IE=edge,chrome=1" /><title>

    Home - Upper Control Limit

</title><meta name="description" /><meta name="author" /><meta name="viewport" content="width=device-width" /><link rel="stylesheet" href="css/style.css" />

    <script src="js/libs/modernizr-2.5.3-respond-1.1.0.min.js"></script>

</head>

<body>

    <div id="header-container">

        <header class="wrapper clearfix">

            <h1 id="title"><a href="default.aspx" title="Upper Control Limit Homepage">Upper Control Limit</a></h1>

            <nav>

                <ul>

                    <li><a href="default.aspx">Home</a></li>

                    <li><a href="contact.aspx">Contact</a></li>

                </ul>

            </nav>

        </header>

    </div>

    <div id="main-container">

            <form method="post" action="default.aspx" id="Form1" enctype="multipart/form-data">

<div class="aspNetHidden">

<input type="hidden" name="__VIEWSTATE" id="__VIEWSTATE" value="/wEPDwUIMzI4MjE1NjZkZO1bVtBx0KanNtHBuPKe20ZygwvsWgeEn3cRtL/CrOHU" />

</div>

<div class="aspNetHidden">

    <input type="hidden" name="__EVENTVALIDATION" id="__EVENTVALIDATION" value="/wEWBQK3heD7DwLHyoqxBgLHyuK8AQKDw8wMAt3oqtEMt6vvVJr549pcOORe6AIL/bfdHDA/UvYWb5jzHlW8pc0=" />

</div>

    <div id="main" class="wrapper clearfix">

            <article>

                <section>

                    <h2>Manual Data Entry</h2>

                    <label>Rows:&nbsp;</label><input name="ctl00$MainContent$txtRows" type="text" id="MainContent_txtRows" class="txtSmall" />

                    <label>Cols:&nbsp;</label><input name="ctl00$MainContent$txtCols" type="text" id="MainContent_txtCols" class="txtSmall" />

                    <p><em>*Maximum of 10 rows and/or 30 columns for this trial version.</em></p>

                    <p><input type="submit" name="ctl00$MainContent$btnGo" value="Go" id="MainContent_btnGo" /></p>

                    <br />

                 </section> 

                <section>

                    <h2>File Uploader</h2>

                    <p><input type="file" name="ctl00$MainContent$flUp" id="MainContent_flUp" />&nbsp;</p>

                    <p>(Maximum File Size: 3KB)<br /><em>*Do not include any column headers or text in your CSV.</em></p>

                    <p><input type="submit" name="ctl00$MainContent$btnUpload" value="Upload" id="MainContent_btnUpload" /></p>

                    <br />

                </section>  

                <section>

                    <h3>Disclaimer</h3>

                    <p class="disclaimer">Data uploaded or manually entered, is deleted immediately 

                        after processing. If you have concerns over your data or privacy, please read our <a href="disclaimer.aspx" title="UCL Disclaimer">disclaimer</a>.<br />If your data contains sensitive information, you should consider 

                        integrating the UCL engine within your system.  Please <a href="contact.aspx" title="Contact us">contact us</a> for more information. <br /></p>

                </section>              

            </article>                          

            <aside>

                <h3>About UCL</h3>

                <p>Control Charts have multiple applications in a wide variety of industries. They 

                    can help measure the effectiveness of manufacturing processes or the quality of 

                    service based industry.</p>

                <p>The UCL calculator has been developed by Data-Exchange Ltd as a side project 

                which was driven by the need to integrate this magic formula within various 

                business applications.</p>

                <h4>Upper Control Limit Formula</h4>

                <p><img src="img/ucl-formula.png" title="Upper Control Limit Formula" alt="Upper Control Limit Formula: X + 2.66* MR" /></p>

                <h4>Lower Control Limit Formula</h4>

                <p><img src="img/lcl-formula.png" title="Lower Control Limit Formula" alt="Lower Control Limit Formula: X - 2.66* MR" /></p>

            </aside>

    </div>

            </form>

    </div> <!-- #main-container -->

    <div id="footer-container">

        <footer class="wrapper clearfix">

            <h3 class="left">Copyright © 2012 <a href="http://www.data-exchange.co.uk/" title="Data Exchange Ltd">Data Exchange Ltd</a></h3>

            <h3 class="right"><a href="http://www.perfect-flow.com/" title="PerfectFlow Ltd" ><img alt="PerfectFlow" border="0" src="img/perfectflow.gif" /></a></h3>

        </footer>

    </div>

<script src="//ajax.googleapis.com/ajax/libs/jquery/1.7.2/jquery.min.js"></script>

<script>    window.jQuery || document.write('<script src="js/libs/jquery-1.7.2.min.js"><\/script>')</script>

<script src="js/script.js"></script>

<script type="text/javascript">

    var _gaq = _gaq || [];

    _gaq.push(['_setAccount', 'UA-17073042-4']);

    _gaq.push(['_trackPageview']);

    (function () {

        var ga = document.createElement('script'); ga.type = 'text/javascript'; ga.async = true;

        ga.src = ('https:' == document.location.protocol ? 'https://ssl' : 'http://www') + '.google-analytics.com/ga.js';

        var s = document.getElementsByTagName('script')[0]; s.parentNode.insertBefore(ga, s);

    })();

</script>

</body>

</html> 
```

感谢您的帮助！

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2012-07-17T16:20:20.940

如果您的样式来自 Boilerplate 的 CSS 之后，那应该适用。这是 CASCADING 样式表的美妙之处。尝试使用`position:fixed`和`bottom:0px`作为您的页脚。

```
#footer-container {
  position:fixed;
  bottom:0px;
  width:100%;
} 
```

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-07-17T16:22:33.850

尝试做一些事情来达到这个效果......

```
#footer-container {
  position:fixed;
  bottom:0px;
} 
```

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2012-07-17T17:00:27.300

以 BP 为例，然后添加此页面上所述的附加标记：[http](http://www.cssstickyfooter.com/html-code.html) ://www.cssstickyfooter.com/html-code.html 。然后，添加适当的 CSS。如果您通过 Firebug 在树模式下查看它，它会有所帮助。在您开始使用附加标记后，看看您是否可以重新调整现有标记的用途以稍微清理一下。

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2012-12-17T11:09:17.300

在没有任何解决方法的情况下以优雅的方式拥有粘性页脚的最佳方法应该使用这个 css 代码：

```
#footer{
position:fixed;
clear:both;
} 
```

# jenkins - 根据詹金斯，我如何访问最后构建的修订版？

> ID：11526672
> 
> 赞同：8
> 
> 时间：2012-07-17T16:17:29.580
> 
> 标签：jenkins, gradle

在我的构建控制台顶部附近，我看到一个“上次构建的修订版：”，带有修订号。如何在我的构建脚本中访问这个最后构建的 rev #？我正在使用 Gradle，但我认为这并不重要。Jenkins 是否在系统属性中提供最后构建的 rev #？当然，从我的构建脚本访问这必须是微不足道的......

* * *

## 回答 #1

> 赞同：12
> 
> 时间：2012-07-18T01:51:51.437

您可以直接访问 Jenkins`BUILD_NUMBER`作为系统环境变量。

```
task getBuildNumber << {
    ext.env = System.getenv()
    ext.buildNumber = env.BUILD_NUMBER?.toInteger()
    println "Build Number: $buildNumber"
} 
```

* * *

## 回答 #2

> 赞同：10
> 
> 时间：2014-03-12T19:23:21.927

事实证明，Git 插件确实将最后一个构建版本导出为环境变量。因此，不要使用公认的答案：

```
curl -sf "$BUILD_URL/api/xml?xpath=//lastBuiltRevision/SHA1/text()" 
```

你可以改用这个：

```
GIT_PREVIOUS_COMMIT 
```

准确查看构建脚本可用内容的一种防故障方法是选择`Add Build Step > Execute Shell`然后简单地添加以下内容：

```
export 
```

查看您的控制台（用于构建），您应该会看到许多可用的出色环境变量。我可以使用的与 git 相关的变量（使用 git 插件）是：

```
GIT_AUTHOR_EMAIL
GIT_AUTHOR_NAME
GIT_BRANCH
GIT_COMMIT
GIT_COMMITTER_EMAIL
GIT_COMMITTER_NAME
GIT_PREVIOUS_COMMIT
GIT_URL 
```

最后，要查看不太全面的可用环境变量列表，您也可以访问以下网址：`http://[your-jenkins-domain-and-port]/env-vars.html`

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2012-07-17T21:34:16.067

我认为 git 插件不会将最后构建的修订版导出为环境变量，但使用简单的 shell 命令可以轻松获得信息，例如：

```
curl -sf "$BUILD_URL/api/xml?xpath=//lastBuiltRevision/SHA1/text()" 
```

BUILD_URL 始终指向构建自己的页面，其余信息似乎可以使用 xml api 获得。

* * *

## 回答 #4

> 赞同：2
> 
> 时间：2012-07-17T20:04:57.610

当前内部版本号作为 Jenkins 变量**BUILD_NUMBER提供**

*   在 Unix 中，它为您设置为**${BUILD_NUMBER}**
*   在 Windows 中，它以**%BUILD_NUMBER%的形式提供**

您的 Jenkins 服务器上提供了完整的变量列表，网址为：
http://[your-jenkins-server] **/env-vars.html**

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2020-11-19T16:11:14.280

Git 插件从`checkout()`命令返回信息。在 Pipeline 脚本中，这可用于获取先前的提交：

```
def scmVars = checkout scm

scmVars.GIT_PREVIOUS_COMMIT 
```

# backbone.js - Backbone.js、IE 8 和 Win 7

> ID：11526673
> 
> 赞同：0
> 
> 时间：2012-07-17T16:17:31.157
> 
> 标签：backbone.js

刚开始在`backbone.js`和asp.net工作。该代码在 Firefox 中运行良好，而相同的代码在 IE 8 中无法运行。我是否需要配置一些东西才能使其在 IE 8 中运行？

Console.log 仅适用于 Firefox，不确定在 IE8 中的何处查看记录的消息（已使用 IE 8 的开发人员工具）。

谢谢

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-07-17T16:29:00.260

在 IE 8 中，您可以转到“脚本”选项卡（您会在左侧看到 HTML、CSS、脚本和 Profiler 选项卡），控制台位于该选项卡的右侧。

第一个问题的答案是否定的，Backbone.js 和 IE 没有什么特别之处，你可能有一些完全符合标准的 JavaScript，当然，IE 8 不喜欢它。

例如，不要以逗号结尾的列表：

```
{
  "something" : "value",
  "other" : "different value",
} 
```

在 Firefox 中会很好，在 IE 中则不然。

祝你好运。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-07-17T20:35:34.783

我在上一个项目中遇到了这个问题。可以通过 jslint 运行代码来标记像 John 提到的项目。尾随逗号是我最大的冒犯者

您可以使用[http://www.jslint.com/](http://www.jslint.com/)并减少一些与在 IE 中运行无关的错误和警告。

# facebook - nginx大头响应

> ID：11526674
> 
> 赞同：5
> 
> 时间：2012-07-17T16:17:33.230
> 
> 标签：facebook, nginx, header

“从上游读取响应标头时，上游发送的标头太大”

当我尝试从 Facebook 进行身份验证时，我不断收到此信息。我增加了缓冲区：

```
proxy_buffer_size   256k;
proxy_buffers   8 256k;
proxy_busy_buffers_size   512k;
fastcgi_buffers 8 256k;
fastcgi_buffer_size 128k; 
```

但这似乎没有帮助。关于为什么会发生这种情况的任何想法？

nginx.conf 文件：

```
user www-data;
worker_processes  1;

error_log  /var/log/nginx/error.log;
pid        /var/run/nginx.pid;

events {
    worker_connections  1024;
    # multi_accept on;
}

http {
    include       /etc/nginx/mime.types;

proxy_buffer_size   256k;
proxy_buffers   8 256k;
proxy_busy_buffers_size   512k;
fastcgi_buffers 8 256k;
fastcgi_buffer_size 128k;

    access_log  /var/log/nginx/access.log;

    sendfile        on;
    #tcp_nopush     on;

    #keepalive_timeout  0;
    keepalive_timeout  65;
    tcp_nodelay        on;

    gzip  on;
    gzip_disable "MSIE [1-6]\.(?!.*SV1)";

    include /etc/nginx/conf.d/*.conf;
    include /etc/nginx/sites-enabled/*;
} 
```

/etc/nginx/sites-enabled/default

```
server {
    listen   80 default;
    server_name  localhost;

    access_log  /var/log/nginx/localhost.access.log;

    location / {
        root   /var/www/nginx-default;
        index  index.html index.htm;
    }

    location /doc {
        root   /usr/share;
        autoindex on;
        allow 127.0.0.1;
        deny all;
            }

    location /images {
        root   /usr/share;
        autoindex on;
    }
} 
```

* * *

## 回答 #1

> 赞同：12
> 
> 时间：2012-09-16T11:50:32.883

在codeigniter中我有同样的错误。这对我有用：

[http://forum.nginx.org/read.php?2,192785,196003#msg-196003](http://forum.nginx.org/read.php?2,192785,196003#msg-196003)

在 .conf 中

```
location ~* \.php$ {
    fastcgi_pass 127.0.0.1:9001;
    fastcgi_index index.php;
    fastcgi_split_path_info ^(.+\.php)(.*)$;
    include fastcgi_params;
    fastcgi_param SCRIPT_FILENAME $document_root$fastcgi_script_name;

    # 16-sept-2012 parametros para evitar el 502
    fastcgi_temp_file_write_size 10m;
    fastcgi_busy_buffers_size 512k;
    fastcgi_buffer_size 512k;
    fastcgi_buffers 16 512k;
    fastcgi_connect_timeout 300;
    fastcgi_send_timeout 300;
    fastcgi_read_timeout 300;
    fastcgi_intercept_errors on;
    fastcgi_next_upstream error invalid_header timeout http_500;
} 
```

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-07-19T22:54:48.683

今天早上我遇到了同样的问题。但是，增加缓冲区大小对我有用。这是我使用的设置：

```
 proxy_buffer_size    128k;
   proxy_buffers     4 256k;
   proxy_busy_buffers_size 256k;
   proxy_temp_file_write_size 256k; 
```

我在您的配置中没有看到的唯一设置是

```
 proxy_temp_file_write_size 256k; 
```

此外，我仅为该虚拟主机添加了这些值。我认为这不重要，但可能值得一试。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-07-27T01:50:49.327

原来 Codeigniter 设置了自己的最大大小。我还没有想出如何限制它，但不幸的是改变 nginx 不会改变任何东西。感谢 VBart 和 gsharma 的所有帮助。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2013-09-18T14:33:22.370

我在一个 800 字节长、4 个标题的页面上收到此错误。这是一个删除 cookie 的登出页面。为了使 cookie 过期，我将它们设置回我的生日。这在 nginx 中不起作用，它们必须在不到一个月的时间内过期才能通过验证以删除 cookie。

我检查了更多不同但无效的标题并得到了相同的结果。如果 nginx 无法验证它抛出的标头：upstream sent too big header while reading response header from upstream

2015：来自经验的更多信息： `upstream sent too big header while reading response header from upstream`是 nginx 表达“我不喜欢我所看到的”的通用方式

1.  您的上游服务器线程崩溃了
2.  上游服务器发回了无效的标头
3.  从 STDERR 发回的通知/警告打破了他们的缓冲区，它和 STDOUT 都被关闭了

3：查看消息上方的错误日志，是否在消息之前记录了行？ `PHP message: PHP Notice: Undefined index:` 来自循环我的日志文件的示例片段：

```
2015/11/23 10:30:02 [error] 32451#0: *580927 FastCGI sent in stderr: "PHP message: PHP Notice:  Undefined index: Firstname in /srv/www/classes/data_convert.php on line 1090
PHP message: PHP Notice:  Undefined index: Lastname in /srv/www/classes/data_convert.php on line 1090
... // 20 lines of same
PHP message: PHP Notice:  Undefined index: Firstname in /srv/www/classes/data_convert.php on line 1090
PHP message: PHP Notice:  Undefined index: Lastname in /srv/www/classes/data_convert.php on line 1090
PHP message: PHP Notice:
2015/11/23 10:30:02 [error] 32451#0: *580927 FastCGI sent in stderr: "ta_convert.php on line 1090
PHP message: PHP Notice:  Undefined index: Firstname 
```

您可以在第 3 行（从之前的 20 个错误中）看到缓冲区限制被击中、破坏，并且下一个线程写入了它。Nginx 然后关闭连接并向客户端返回 502。

2：记录每个请求发送的所有标头，查看它们并确保它们符合标准（nginx 不允许超过 24 小时的任何内容删除/过期 cookie，发送无效的内容长度，因为错误消息在内容计数之前被缓冲。 ..)

例子包括：

```
<?php
//expire cookie
setcookie ( 'bookmark', '', strtotime('2012-01-01 00:00:00') );
// nginx will refuse this header response, too far past to accept
....
?> 
```

还有这个：

```
<?php
header('Content-type: image/jpg');
?>

<?php   //a space was injected into the output above this line
header('Content-length: ' . filesize('image.jpg') );
echo file_get_contents('image.jpg');
// error! the response is now 1-byte longer than header!!
?> 
```

1：验证或制作脚本日志，以确保您的线程到达正确的终点并且在完成之前不退出。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2013-09-19T09:50:49.983

我们正在移动我们的生产环境，旧的环境没有问题，并且有相同的“上游发送过大的标头，同时从上游读取响应标头”问题。这是一个 Codeigniter 2.x 应用程序。

就像@gsharma 所说，在更改服务器配置后，错误日志消失了。

```
 fastcgi_buffers 256 4k;
    fastcgi_buffer_size 8k; 
```

但是，仍然存在一些问题：登录不再起作用。问题出在 $config['sess_encrypt_cookie']=TRUE;

使用 sess_encrypt_cookie 时，Codeigniter 会尝试使用 mcrypt 库，但如果它不存在，则使用名为“_xor_encode”的方法。好的，我认为这种方法有问题。

安装 php-mcrypt 后一切正常。

（对不起我的英语不好）

# php - 如何在 PHP 中获取值 contentEditable

> ID：11526675
> 
> 赞同：2
> 
> 时间：2012-07-17T16:17:36.197
> 
> 标签：php, email, contenteditable

我们如何在 PHP 中以 html 格式获取 contentEditable 中存在的内容

例如，我有这段代码并想在 PHP 中的变量中获取它的值：

```
<div contentEditable="true"> type here
<img src="http://t2.gstatic.com/images?q=tbn:ANd9GcQCze-mfukcuvzKk7Ilj2zQ0CS6PbOkq7ZhRInnNd1Yz3TQzU4e&t=1" /></div> 
```

因为我想将其用作电子邮件的 html 正文。

事实上，我想获取 contentEditable 的值并将其保存到一个变量中，然后将该变量用作我的电子邮件的正文。知道如何执行此任务。

* * *

## 回答 #1

> 赞同：8
> 
> 时间：2012-07-17T16:24:49.730

您需要将元素的内容存储在表单元素中，以便可以将其提交到您的 PHP 页面。

我假设你想要`contenteditable`而不是`textarea`富文本......考虑看看像[TinyMCE](http://www.tinymce.com/)这样的所见即所得编辑器。

如果您仍想坚持当前的方法，则需要一些 JS 在页面提交之前将 div 的值复制到隐藏的表单元素中。

HTML

```
<div id="emailcontent" contenteditable>asdf</div>
<form>
  <input type="text" id="a" name="a"/>
  <input type="submit" name="submit" id="submit" />
</form> 
```

[jQuery](http://jquery.com/)

```
$("#submit").click(function() {
  $("#a").val($("#emailcontent").html());
}); 
```

[**演示**](http://jsbin.com/ororof)

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2012-07-17T16:27:27.933

你可以尝试这样的事情：

```
var form = document.createElement("form");
form.setAttribute('action','some.php');
form.setAttribute('method','POST');
form.setAttribute('target','_self');
form.setAttribute('enctype','application/x-www-form-urlencoded');
form.innerHTML = '<input type="hidden" name="emailData" value="'+
                     document.getElementById('yourdivid').innerHTML+'" />';
form.submit(); 
```

然后在您的 php 中检索`POST`数据：

```
$data = $_POST['emailData']; 
```

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2012-07-17T16:29:13.443

如果您想使用 PHP，也许您可​​以尝试使用 php DomDocument 这是一些示例，可能与您想要的相同

[如何在 php 中获取 div 内容](https://stackoverflow.com/questions/6491598/how-can-i-get-a-div-content-in-php)

[如何通过 PHP 获取 div？](https://stackoverflow.com/questions/2567975/how-to-get-a-div-via-php)

或者你可以使用 javascript 和 jquery 来做到这一点

# android - 禁用 webview Android 中的单击链接或按钮

> ID：11526676
> 
> 赞同：3
> 
> 时间：2012-07-17T16:17:38.537
> 
> 标签：android, webview

我有一个 webview 加载 URL“http://www.google.com”..当我们单击该 webview 中的链接或按钮时，我想禁用事件..我设置 clickable="false" 但不起作用..

* * *

## 回答 #1

> 赞同：8
> 
> 时间：2012-07-17T16:22:33.667

创建一个自定义`WebViewClient`并覆盖 `shouldOverrideUrlLoading`& `shouldOverrideKeyEvent`。例如：

```
public class MyWebViewClient extends WebViewClient {
    @Override
    public boolean shouldOverrideKeyEvent (WebView view, KeyEvent event) {
         // Do something with the event here
         return true;
    }

    @Override
    public boolean shouldOverrideUrlLoading (WebView view, String url) {
        if (Uri.parse(url).getHost().equals("www.google.com")) {
             // This is my web site, so do not override; let my WebView load the page
             return false;
        }

        // reject anything other
        return true;
    }
} 
```

* * *

## 回答 #2

> 赞同：6
> 
> 时间：2015-06-27T09:00:45.683

```
mWebView.setOnTouchListener(new View.OnTouchListener() {
    @Override
    public boolean onTouch(View v, MotionEvent event) {
       return true;
    }  
}); 
```

* * *

## 回答 #3

> 赞同：3
> 
> 时间：2012-07-17T16:23:11.540

不知道在 webview 中禁用 HTML Native 按钮，但您可以禁用链接

```
public class formatHTML {
    public static String changeHTMLFormat(String htmlObject){
        String result = "", CSSCoding = "";

        CSSCoding = htmlObject;
        CSSCoding = CSSCoding.replaceAll("<[aA].*?>", "<u>");
        CSSCoding = CSSCoding.replaceAll("</[aA]>", "</u>");
        return CSSCoding;
    }     
} 
```

# c++ - 是否可以让doxygen合并成员组

> ID：11526679
> 
> 赞同：3
> 
> 时间：2012-07-17T16:17:50.800
> 
> 标签：c++, doxygen

我正在使用 doxygen 来记录 C++ 代码。假设我有两个类：Base 类和派生自 Base 的类 Derived。我在 Base 和 Derived 中有一个名为 Foo 的成员组。是否可以让 doxygen 在类 Derived 的文档中显示一个名为 Foo 的单个组，而不是像我现在观察到的那样有两个同名的组？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-05-15T15:31:03.493

我修补了 doxygen 的结帐来做到这一点。补丁如下。我没有注意到生成的文档中有任何不良影响。该实现的缺点是它是一个 O(n^2) 算法，其中 n 是成员组的数量。在我的情况下，成员组的数量足够少，复杂性不会打扰我。

```
Index: src/util.cpp
===================================================================
--- src/util.cpp    (revision 848)
+++ src/util.cpp    (working copy)
@@ -5759,6 +5759,24 @@
           (*ppMemberGroupSDict)->setAutoDelete(TRUE);
         }
         MemberGroup *mg = (*ppMemberGroupSDict)->find(groupId);
+
+        uint ngrps = (*ppMemberGroupSDict)->count();
+        const char * ghs = info->header;
+        int          gid = groupId;
+        for (uint i=0; i != ngrps; ++i)
+        {
+          MemberGroup *tg = (*ppMemberGroupSDict)->at(i);
+          MemberListIterator oli(*(tg->members()));
+          MemberDef *omd = oli.current();
+          const char * ohs = Doxygen::memGrpInfoDict[omd->getMemberGroupId()]->header;
+          int          oid = tg->groupId();
+          if ( ghs && ohs && strcmp(ghs, ohs) == 0)
+          {
+            mg = tg;
+            break;
+          }
+        }
+
         if (mg==0)
         {
           mg = new MemberGroup( 
```

该代码通过扫描成员组字典中已有的组来查找具有相同名称（即标题）的组。如果找到这样的组，则将该组用作要插入的成员的成员组。

# sql-server - 在 SQL 查询中使用列表将数据导入 Excel

> ID：11526684
> 
> 赞同：0
> 
> 时间：2012-07-17T16:18:09.203
> 
> 标签：sql-server, excel, csv, import

我正在尝试在 Excel 中运行从 MSSQL Server 导入信息的选择查询。我还有一个 .csv 文件中的客户列表。目标是仅导入 .csv 列表中的客户记录，但我无法让 Excel 查看列表（它已导入到 Sheet2）。我不断收到无效的对象名称错误。

我不敢相信没有 VB 就无法做到这一点，但尝试了 MS 和其他线程的示例，但没有运气。

我正在使用的基本查询是：

```
SELECT 
"Clients"."cltCode", "Clients"."cltClientName"
FROM   "dbo"."Clients" "Clients"   
WHERE cltClientName IN ( SELECT * FROM [Sheet2!A:A]) 
```

谢谢。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-07-18T15:22:14.797

你不能那样做。您必须自己在 VBA 中构建包含列表（“IN”部分），构建查询并刷新数据连接（或构建命令，运行查询，遍历结果并填充目标范围/工作表）

* * *

## 回答 #2

> 赞同：-1
> 
> 时间：2012-07-17T16:28:12.973

```
SELECT 
"Clients"."cltCode", "Clients"."cltClientName"
FROM   "dbo"."Clients" "Clients"   
WHERE cltClientName IN ( SELECT * FROM [Sheet2!A:A]) 
```

指定数据的确切位置。

```
FROM [Sheets2!A2:C4] 
```

# c++ - 将字符输出随机化到文本文件

> ID：11526685
> 
> 赞同：-2
> 
> 时间：2012-07-17T16:18:10.610
> 
> 标签：c++, out

我对 C++ 编程很陌生，我想展示

如何显示产生这种格式的 output.txt 文件。

> ABCDEFGHIJKLMNOPQRSTU VWX YZ
> 
> TWGXZRLLNHAIAFLEWGQHV RNVDU

在文本文件中，但我不确定为什么它们显示为垃圾。

```
#include <iostream>
#include <cstdlib>
#include <ctime>
#include <fstream> 
using namespace std;

void random (std::ostream& output)
{
     int letter[26];
     int i,j,temp;

    srand(time(NULL));

        for(i=0; i<26; i++)
            {
                 letter[i] = i+1;
                 output<<(char)(letter[i]+'A'-1)<<" "; 
//by ending endl here i am able to display but the letter will display in horizontal which is not what i wanted     

            }    

        for(i=0; i<26; i++)
        {
            j=(rand()%25)+1; 
            temp = letter[i];
            letter[i] = letter[j];
            letter[j] = temp;
             output<<((char) (letter[i]+'A'-1))<<" ";
        }

} 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-07-17T16:30:51.190

```
void random (std::ostream& output)
{
     int letter[26];
     int i,j,temp;

    srand(time(NULL));

        for(i=0; i<26; i++)
        {
             letter[i] = i+1;
             output<<(char)(letter[i]+'A'-1)<<" ";      

        }    
        output << "\n";        //that's all what you need
        for(i=0; i<26; i++)
        {
            j=(rand()%25)+1; 
            temp = letter[i];
            letter[i] = letter[j];
            letter[j] = temp;
             output<<((char) (letter[i]+'A'-1))<<" ";
        }

} 
```

对于未来 - 不要使用 std::endl 因为它也会刷新流缓冲区，这可能是不需要的。请改用“\n”。但整个功能可以简单得多：

```
void random (std::ostream& output)
{
    srand(time(NULL));

        for(int i = 65; i < 91; ++i)            // i == 65, because it's A in ASCII
            output << (char)i << " ";
        output << "\n";        //that's all what you need

        for(int i=0; i<26; i++)
        {
             output <<((char)(rand()%26 + 65))<<" ";
        }
} 
```

# iphone - iPhone - 在滑动手势上加载 .xib 文件

> ID：11526688
> 
> 赞同：0
> 
> 时间：2012-07-17T16:18:24.167
> 
> 标签：iphone, xib, swipe

我正在尝试检测滑动手势以在两个 .xib 文件之间切换。现在主文件完美加载，但我如何让它在向右滑动时加载第二个 .xib 文件？它们都是我项目的一部分，并且是使用 Interface Builder 创建的。例如，您可以将它们称为 Page1 和 Page2。

这是我到目前为止所拥有的：

```
- (void)createGestureRecognizers {
  UISwipeGestureRecognizer *swipe = [[UISwipeGestureRecognizer alloc]
    initWithTarget:self action:@selector(handleSwipe:)];
  [self.theView addGestureRecognizer:swipe];
  [swipe release];
}
- (IBAction)handleSwipe:(UIGestureRecognizer *)sender {
  //What to put here?
} 
```

我相信这应该处理任何滑动手势并将选择器传递给我的`handleSwipe`方法，这应该以某种方式改变 viewController xib。我是否正确地解决了这个问题，如果是这样，我如何在我的`handleSwipe`方法中切换 xib 文件？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-07-17T16:27:00.750

您是否考虑过[UIPageViewController](http://developer.apple.com/library/ios/#documentation/WindowsViews/Conceptual/ViewControllerCatalog/Chapters/PageViewControllers.html)？或者，您可以在侧滑时将 UIViewController(Page 2) 推送到导航堆栈并为其设置动画（默认从右到左进行动画处理）。这可以通过使用`UINavigationViewController`

# google-app-engine - Appengine 部署检查是否成功不起作用

> ID：11526691
> 
> 赞同：0
> 
> 时间：2012-07-17T16:18:27.347
> 
> 标签：google-app-engine

应用程序引擎（python 2.7，Mac OS X，截至今天的最新版本）部署似乎进展顺利（编译完成），但部署被卡住，每 60 秒重复一次“将在 60 秒内再次检查”，直到它最终失败，说：

```
 File "/Applications/GoogleAppEngineLauncher.app/Contents/Resources/GoogleAppEngine-default.bundle/Contents/Resources/google_appengine/google/appengine/tools/appcfg.py", line 2025, in Commit
    raise Exception('Version not ready.')
Exception: Version not ready. 
```

我在 code.google.com 上检查了 appengine 状态，似乎没有任何问题。

知道回滚是否是强制性的吗？几个小时前我遇到了同样的问题，但经过几次尝试后它成功了。这次似乎更严重了，因为我已经被困在那个状态几个小时了。有什么建议吗？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-07-18T04:41:34.553

正如评论中提到的，这些类型的问题最好在邮件列表或问题跟踪器中提供。但是，对于您提到的特定问题，已提交并解决了[生产问题。](http://code.google.com/p/googleappengine/issues/detail?id=7861)你应该不会再看到这个问题了。

# cucumber - Cucumber/Ruby - 场景大纲 - 小数，连字符被视为多个参数

> ID：11526696
> 
> 赞同：1
> 
> 时间：2012-07-17T16:18:54.310
> 
> 标签：cucumber, qa

我有使用十进制值的基本黄瓜场景大纲：

```
Given I have clicked the Search Button
When I select <MinEngineSize> and <MaxEngineSize> dropdown fields from the Engine size filter
And I click the Show results button 
Then the search results are displayed 
```

例子：

```
|MinEngineSize|MaxEngineSize|
|1.1 Litres|1.6 Litres| 
```

出于某种原因，ruby 似乎将小数点前后的数字拆分为单独的 args 当 /^I 从引擎大小过滤器中选择 (\d+).(\d+) 升和 (\d+).(\d+) 升下拉字段时$/ 做 |arg1, arg2, arg3, arg4|

当我执行 .rb 文件时，出现以下错误：

在选择列表中找不到“1”（Watir::Exception::NoValueFoundException）

如何让红宝石将十进制值视为一个参数？可能是新手的错误，但那是我的水平。

谢谢！

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-07-17T20:41:43.697

I assume you are using the suggested step definition by Cucumber? These are not always correct for the data you are using, so you sometimes need to tweak the step definition's regex.

You want:

```
When /^I select (.+) Litres and (.+) Litres dropdown fields from the Engine size filter$/ do |arg1, arg2| 
```

If you need a regex tutorial, I have found this one to be pretty good - [http://www.regular-expressions.info/tutorial.html](http://www.regular-expressions.info/tutorial.html).

Note that arg1 and arg2 will be strings. If you want them as decimals, you will need to convert them using `to_f()`. For example:

```
When /^I select (.+) Litres and (.+) Litres dropdown fields from the Engine size filter$/ do |arg1, arg2|
  numeric_arg1 = arg1.to_f
  numeric_arg2 = arg2.to_f 
```

**Update**

It looks like you are trying to select the value from a dropdown using Watir. In that case, I am guessing you actually want arg1 to actually be "1.1 Litres" not "1.1". If so, you will want to include Litres in the brackets:

```
When /^I select (.+ Litres) and (.+ Litres) dropdown fields from the Engine size filter$/ do |arg1, arg2| 
```

# haskell - hackage.haskell.org 文档约定的含义

> ID：11526701
> 
> 赞同：19
> 
> 时间：2012-07-17T16:19:27.647
> 
> 标签：haskell, haskell-platform

我目前正在阅读[http://hackage.haskell.org/packages/archive/containers/latest/doc/html/Data-Set.html#t:Set](http://hackage.haskell.org/packages/archive/containers/latest/doc/html/Data-Set.html#t%3aSet)

以下细节传达了什么（对于绝对的haskell初学者）？

可移植性：可移植性（还有哪些是可移植性价值？）
稳定性：临时性（还有哪些是稳定性价值？）
维护者：libraries@haskell.org
安全 Haskell：安全（有什么不安全的吗？）

* * *

## 回答 #1

> 赞同：19
> 
> 时间：2012-07-17T17:07:38.483

这些字段来自包的`.cabal`文件，其中列出了包的一些元数据。许多字段可以具有自由格式的值，以便开发人员自己决定在该字段中写入什么，并且对于每个字段不得包含的内容没有固定的“规则”。

**可移植性：**描述包在 Haskell 编译器之间的可移植性，有时也在操作系统之间。我见过的唯一值是“便携”和“不可移植”。不可移植包是可能依赖于仅存在于[GHC](http://www.haskell.org/ghc/)编译器中的 Haskell 语言扩展的包，并且不适用于任何其他 Haskell 编译器（如[UHC](http://www.cs.uu.nl/wiki/UHC/)），或者可能依赖于某些仅存在于 UNIX 中且不存在的系统库不能在 Windows 中工作。

**稳定：**指定库的稳定性，包括其可靠性（例如崩溃的频率），但最重要的是其 API 更改的频率。我已经看到了“实验”、“临时”和“稳定”的值，但在某个地方可能会有更多的列表（Cabal 文档中的内容有时无法找到）。当一个包是实验性的，这意味着它的接口可能会在每个版本之间发生变化，因为开发人员还没有决定应该如何实现它，或者因为开发人员只是从某处的论文中实现了一些理论功能，并且没有打算维护包；他/她只是想实现该功能以查看是否可行，并且正在发布包作为演示。当包裹是临时的，这意味着通用 API 是稳定的，因此可能会对包进行更新，仅修复内部错误，而不会添加或删除任何功能。但是，因为它是临时的，所以当开发人员决定添加新功能或重组库时，它可能会在未来发生变化。使用稳定的库，这基本上不会发生；API可能永远不会改变，并且实现是“坚如磐石”或API的参考实现或其他东西。

包的**维护者**是负责包的人或一组人。该电子邮件指定了如何联系这些维护人员。

“ **Safe Haskell** ”字段是指 GHC 扩展，您可以在[此处](http://www.haskell.org/ghc/docs/7.2.2/html/users_guide/safe-haskell.html)阅读更多信息。*不安全*的模块使用的函数`unsafePerformIO`破坏了 Haskell 的一些基本“规则”，如引用透明性。*不安全*的模块也可能使用不安全的语言扩展。*安全*模块是不使用任何不安全功能等的模块，也不导入任何其他不安全模块。受*信任*的模块使用不安全的功能（直接受*信任*，间接受*信任*)，但作者已确保模块的公共 API 安全地隐藏了这一事实，因此从外部看来，该模块对于所有意图和目的都是安全的。这些是“Safe Haskell”字段的选项。

# scala - Akka Actor 设置：在 Main 方法中还是在“Manager”类中？

> ID：11526702
> 
> 赞同：2
> 
> 时间：2012-07-17T16:19:31.063
> 
> 标签：scala, akka

有人对如何管理大量 akka 演员的创建有任何建议吗？

我的新中间件项目目前包含大约 10 个参与者，但随着时间的推移，这将不可避免地增长到很高的数量。我正在我的`main`函数中创建我的所有演员，但是随着系统的增长，这可能会失去控制，函数跨越整个屏幕。

我当然可以将所有的演员创建​​移动到一个单独的类中的一个函数中，尽管这并不能真正解决问题。

我不确定是否有任何模式可用于帮助管理此设置过程？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-07-17T18:32:22.310

通常应该只有几个顶级Actor（即使用system.actorOf 创建的那些）。这是因为如果所有 Actor 都为其他 Actor 破坏事物的可能性相同，那么您的容错能力就会非常差。所以你应该做的是考虑你希望如何将失败包含在你的应用程序中，然后使用 context.actorOf 将actor创建为其他actor的子级。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-07-17T16:27:17.523

这真的取决于演员的关系。如果他们彼此之间没有父/子关系，那么您从哪里开始并不重要。如果他们有这样的关系，你应该在他们的父母中开始你的演员，因为你必须使用`context`父母演员的 创造另一个演员作为它的孩子。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-07-17T17:21:22.500

如果不了解您正在创建的演员的性质，很难回答您的问题。例如，如果你可以对你的演员进行逻辑分组，我会做这样的事情：

```
def initialize() = {

    // Initialize Misc actors
    val foo = FooActor()
    val bar = BarActor()

    initializeActorsThatDoStuff()
    initializeActorsThatDoOtherStuff()

} 
```

如果他们有父/子关系，您应该按照@drexin 的建议进行操作。

* * *

**编辑：**几乎忘记了：我正在创建具有不同参数的多个相同类型的演员，我当然会使用循环而不是复制和粘贴，例如

```
def initializeLotsOfActors(num:Int) =
    for(i <- 0 to num) new ActorThatTakesAnInt(i); 
```

（因为没有人喜欢复制和粘贴：D）

# php - 使用 Postfix 管道电子邮件

> ID：11526706
> 
> 赞同：5
> 
> 时间：2012-07-17T16:19:40.753
> 
> 标签：php, email, pipe, postfix-mta

我正在尝试为特定的电子邮件地址设置管道。我正在关注我[在这里](http://support.deskpro.com/manual.php?p=166)看到的内容，但是在`newaliases`我得到以下信息之后：

```
postalias: warning: /etc/postfix/aliases, line 1: name must be local 
```

我的`/etc/postfix/aliases`：

```
pipe@example.com: "| /usr/bin/php -q /home/path/to/file/pipe.php" 
```

当我尝试发送电子邮件时，它会返回可交付成果。我究竟做错了什么？

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-07-17T17:01:29.170

从 Postfix [aliases(5) 手册页](http://www.postfix.org/aliases.5.html)：

> ```
>  o    An alias definition has the form
>             name: value1, value2, ... 
> ```
> 
> 该名称是本地地址（**没有域部分**）。当名称包含任何特殊字符（例如空格、`#',`:' 或 `@'）时，请使用双引号。名称折叠为小写，以使数据库查找不区分大小写。

要转发任意域地址的电子邮件，请阅读有关[virtual(5)](http://www.postfix.org/virtual.5.html)的信息。

# animation - 如何为视频中的图像设置动画

> ID：11526708
> 
> 赞同：0
> 
> 时间：2012-07-17T16:19:43.373
> 
> 标签：animation, opencv, video-processing, javacv

有人愿意创建一个显示动画图像的视频序列吗？动画我的意思是：

*   在 z 秒内从角度 x 旋转到角度 y 的图像
*   在 z 秒内放大/缩小 x 倍的图像

像这样：[使用 Opencv 和 C++ 测试缩放](http://youtu.be/N3n4oF5PXVA) 结果将保存为硬盘上的视频文件（创建时不显示）

在最坏的情况下，我可以逐步转换每个图像......但是......

问候

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-07-17T16:50:27.213

> 在 z 秒内从角度 x 旋转到角度 y 的图像

[仿射变换](http://opencv.itseez.com/doc/tutorials/imgproc/imgtrans/warp_affine/warp_affine.html)应该可以帮助您。

> 在 z 秒内放大/缩小 x 倍的图像

设置投资回报率和调整大小应该可以帮助您。

> 在最坏的情况下，我可以逐步转换每个图像......但是......

但是什么？这是使用 OpenCV 的唯一解决方案。或者，您可以使用视频和图像编辑器。

# url - 子目录无法使用 Joomla 新版本 URL？

> ID：11526715
> 
> 赞同：0
> 
> 时间：2012-07-17T16:20:00.687
> 
> 标签：url, joomla, subdirectory, slash

在我旧版本的 joomla 中，我使用了“menu-link”并将子目录命名为 /xxx/ 所有 URL 都在该子目录中，谷歌也知道这一点。所以 ：

```
/xxx/jantje
/xxx/pietje
/xxx/enverder
etc. 
```

现在......一个新版本的Joomla（只有“菜单别名”可用）和一个新网站，不可能将该子目录放在所有菜单项的前面...... :(
而且我不希望网址更改。Joomla 由`/xxx/`带有破折号的名称组成 -->`xxx-` 所以：

```
xxx-jantje
xxx-pietje
xxx-enverder 
```

有谁知道如何解决这个问题？我真的很喜欢 URLS 保留在其中的子目录名中。

提前谢谢！

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-08-14T11:17:57.553

问题通过以下方式解决：

注释掉第 95 行： `./libraries/joomla/filter/output.php`

```
//$str = trim(JString::strtolower($str)); 
```

并更改为：

```
$str = trim($str); 
```

从以下位置注释掉第 370 行：./libraries/joomla/filter/language.php

```
//$string = JString::strtolower($string)); 
```

现在您也可以在别名中使用`/`.

# excel - 数据连接和 MSN

> ID：11526717
> 
> 赞同：0
> 
> 时间：2012-07-17T16:20:01.523
> 
> 标签：excel, vba

我正在尝试填充 Excel 拥有的 MSN 数据连接。我想从另一张表中复制符号列表并在数据馈送中使用它，就像我用逗号分隔一样，以获取最新价格。

这是数据馈送宏，但我不知道如何输入符号。

```
 With ActiveSheet.QueryTables.Add(Connection:= _
    "FINDER;C:\Program Files\Microsoft Office\Office14\QUERIES\MSN MoneyCentral   Investor Stock Quotes.iqy" _
    , Destination:=Range("$A$1"))
    .Name = "MSN MoneyCentral Investor Stock Quotes"
    .FieldNames = True
    .RowNumbers = False
    .FillAdjacentFormulas = False
    .PreserveFormatting = False
    .RefreshOnFileOpen = False
    .BackgroundQuery = True
    .RefreshStyle = xlInsertDeleteCells
    .SavePassword = False
    .SaveData = True
    .AdjustColumnWidth = True
    .RefreshPeriod = 1
    .WebSelectionType = xlEntirePage
    .WebFormatting = xlWebFormattingAll
    .WebPreFormattedTextToColumns = True
    .WebConsecutiveDelimitersAsOne = True
    .WebSingleBlockTextImport = False
    .WebDisableDateRecognition = False
    .WebDisableRedirections = True
    .Refresh BackgroundQuery:=False
End With
End Sub 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-07-17T18:55:08.083

如果您从 Sheet1 运行它并且股票代码的范围在 Sheet2 您在问题中引用的文件，

"C:\Program Files\Microsoft Office\Office14\QUERIES\MSN MoneyCentral Investor Stock Quotes.iqy"

如果你打开它，无论如何都要引用这个底层 URL，所以只需在本地跳过引用并使用它，它也应该适用于不同的版本。

```
Sub getQuotes()
Dim quotStr
For Each cell In Sheets("Sheet2").Range("A1:A5") 'whatever range you want
quotStr = cell + ", " + quotStr
Next
quotStr = Left(quotStr, (Len(quotStr) - 2))

    With ActiveSheet.QueryTables.Add(Connection:= _
        "URL;http://moneycentral.msn.com/investor/external/excel/quotes.asp?SYMBOL=" & quotStr _
        , Destination:=Range("$A$1"))
        .Name = "MSN MoneyCentral Investor Stock Quotes" 
```

- -ETC

# c++ - 如何让 2 个 c++ 类知道彼此的数据成员？

> ID：11526728
> 
> 赞同：1
> 
> 时间：2012-07-17T16:20:57.147
> 
> 标签：c++, class, iterator, datamember

我的任务是创建一个像标准库一样的类`List`。我无法让迭代器正常工作，因为它必须在从末尾递减时访问链表的尾部。这是我的头文件的一部分：

```
typedef int T;//for now; eventually will be templated
class list;//**forward declaration, doesn't let other classes know about _tail.**
class Node
{
    //this works fine; class definition removed to make post shorter
};
class list_iterator
{
    private:
        Node* _node;
        list* _list;
    public:
        //constructor
        list_iterator& operator--(){_node=_node?(_node->_prev):(_list->_tail);return *this;}
        //some other declarations
};
class list
{
    friend class list_iterator;
    private:
        Node/*<T>*/ *_head,***_tail**;
        int _size;
    public:
        typedef list_iterator iterator;
        //some constructors and other method declarations
        iterator begin() const {iterator it(_head);return it;}
        iterator end() const {iterator it(0);return it;}
        //more method declarations
}; 
```

我试图将重要部分加粗，但它只是用星号包围它们。注意：大部分成员函数都定义在 cpp 文件中；他们都碰巧被删除了一个简短的帖子。

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-07-17T16:29:08.933

您只需要将方法定义`operator--`移出类并将其放在列表之后（或在源文件中（可能是一个更好的主意。将头文件留作声明））。

> 注意：将声明保留在 list_iterator 中

```
class list_iterator
{
    /* STUFF */
    list_iterator& operator--();
 };
class list
{ 
     /*  STUFF */ 
};

// Now list_iterator::operator-- can see all the members of list.
list_iterator& list_iterator::operator--()
{
    _node=_node?(_node->_prev):(_list->_tail);
    return *this;
} 
```

与其他一些答案所暗示的不同。[友谊不会**打破**封装](https://softwareengineering.stackexchange.com/a/99595/12917)。事实上，通过使友元成为类接口的一部分来增加封装（正确完成时）。然而，它确实将朋友与班级紧密地联系在一起。

这正是您想要的迭代器。为了使迭代器有效地工作，它需要知道类的内部结构，因此它通常是一个朋友（或内部类）。它增加了类的可用性而不暴露类的内部工作，代价是它将迭代器与类紧密耦合（因此，如果您更改类，您将需要更改迭代器的实现（但这并不意外））。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-07-17T16:22:56.523

到目前为止，最简单的方法是将迭代器嵌套在列表类中：

```
class list { 
    Node *head, *tail;

    class iterator {
        Node *node;
        list *list;
    // ...
    };
}; 
```

如果您不想这样做，则需要将两者的实现拆分`list`为`list_iterator`两部分：首先是仅声明成员函数的类定义，然后是成员函数的实现：

```
class list;

class list_iterator { 
    // ...
    Node *n;
    list *l;
};

class list {
    // ...
    friend class list_iterator;
};

inline list_iterator& list_iterator::operator--(){
    _node=_node?(_node->_prev):(_list->_tail);
    return *this;
} 
```

这样，`list`在您`list *`定义`list_iterator`. 然后`_tail`已经在里面定义了`list`，那么你就有了`list_iterator::operator--`实际需要用到的代码`list::_tail`..

# php - 使用 VisualBasic 发布到 PHP？

> ID：11526729
> 
> 赞同：1
> 
> 时间：2012-07-17T16:20:58.893
> 
> 标签：php, vb.net, post

我正在为我编写的一些 PHP 代码编写 GUI。我收到关于 POST 不成功的错误。

我从一个在线示例中获取了 PHP 函数代码，当它编译和运行时，它对我不起作用，因为我收到关于帖子不起作用的错误。

```
Imports System.Text
Imports System.IO
Imports System.Net

Public Class Form1

    Private Sub btnIP_Click(ByVal sender As System.Object, ByVal e As System.EventArgs) Handles btnIP.Click
        Dim ip, firstBit, secondBit, completeCall As String

        firstBit = "apikey=eb4a84&method=risk&ip="
        secondBit = "&categories=&options=url_detail"
        ip = txtIP.Text

        completeCall = firstBit + ip + secondBit

        txtCall.Text = completeCall

        Dim url, method As String

        method = "POST"
        url = "http://localhost/myfiles/WorkingVersionVQuickLookXML.php"

        txtCall.Text = PHP(url, method, ip)

    End Sub

    Public Function PHP(ByVal url As String, ByVal method As String, ByVal data As String)
        Try

            Dim request As System.Net.WebRequest = System.Net.WebRequest.Create(url)
            request.Method = method
            Dim postData = data
            Dim byteArray As Byte() = Encoding.UTF8.GetBytes(postData)
            request.ContentType = "application/x-www-form-urlencoded"
            request.ContentLength = byteArray.Length
            Dim dataStream As Stream = request.GetRequestStream()
            dataStream.Write(byteArray, 0, byteArray.Length)
            dataStream.Close()
            Dim response As WebResponse = request.GetResponse()
            dataStream = response.GetResponseStream()
            Dim reader As New StreamReader(dataStream)
            Dim responseFromServer As String = reader.ReadToEnd()
            reader.Close()
            dataStream.Close()
            response.Close()
            Return (responseFromServer)
        Catch ex As Exception
            Dim error1 As String = ErrorToString()
            If error1 = "Invalid URI: The format of the URI could not be determined." Then
                MsgBox("ERROR! Must have HTTP:// before the URL.")
            Else
                MsgBox(error1)
            End If
            Return ("ERROR")
        End Try
    End Function
End Class 
```

我已经使用 html 页面运行相同的文件以发布到 php 并且它运行良好。

这是错误：

这是我的 php，应该将 ip 变量发布到：

```
require("IPQFunctionworkingversionVXML.php");
$ipaddress = $_POST["ipaddress"];

$results = array();

$results = getScore($ipaddress);

echo $results; 
```

一旦它具有正确的 ipaddress 字段，其他字段应该可以工作。

我的想法是该帖子没有发布到我的 php 文件中的“ipaddress”字段。

如果有人能在代码中发现任何东西？或有发布到 php 的替代解决方案，请告诉我！

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-07-18T18:50:15.450

替换这个

```
$_POST["ipaddress"]; 
```

有了这个

```
$_POST["ip"]; 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-07-17T17:48:34.900

一个主要问题似乎是您在以下行中设置表单数据，但从未将该数据传递给您的 PHP 调用例程。

调用应如下所示：

```
txtCall.Text = PHP(url, method, completeCall) 
```

# javascript - 如何强制弹出窗口以我想要的大小加载？

> ID：11526730
> 
> 赞同：0
> 
> 时间：2012-07-17T16:21:01.047
> 
> 标签：javascript, facebook, popup

我正在使用此代码

```
<SCRIPT language="JavaScript">
 <!--
 function popup_window(url,w,h)
 {
  var width=w;
  var height=h;
  var from_top=350;
  var from_left=500;
  var toolbar='no';
  var location='no';
  var directories='no';
  var status='no';
  var menubar='no';
  var scrollbars='yes';
  var resizable='yes';
  var atts='width='+width+'show,height='+height+',top='+from_top+',screenY=';
  atts+= from_top+',left='+from_left+',screenX='+from_left+',toolbar='+toolbar;
  atts+=',location='+location+',directories='+directories+',status='+status;
  atts+=',menubar='+menubar+',scrollbars='+scrollbars+',resizable='+resizable;
  window.open(url,'win_name',atts);
 }
 </SCRIPT>

<a href="javascript: popup_window('http://www.facebook.com/sharer/sharer.php?u=http://www.google.com/',300,200)">Click to see a demo popup window</a> 
```

但是在facebook将弹出窗口调整为默认大小后，我需要强制弹出窗口以我想要的大小加载并保持该大小

有什么办法可以做到这一点吗？

谢谢

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-07-17T16:32:57.633

你需要有一些东西：

```
function popup_window(url,w,h)
{
    .......
    var popupWin = window.open(url,'win_name',atts);
    popupWin.onload = function(){
       popupWin.document.height = w;
       popupWin.document.width = h;   
    }
} 
```

您需要在弹出窗口中添加该代码。

# mysql - 为什么我的桌子尺寸比预期的大 4 倍以上？（行*字节/行）

> ID：11526734
> 
> 赞同：6
> 
> 时间：2012-07-17T16:21:12.653
> 
> 标签：mysql, storage, innodb

我正在查看 MySQL 中的一个简单表，它有 4 列，大小如下，

```
unsigned bigint (8 bytes)
unsigned bigint (8 bytes)
unsigned smallint (2 bytes)
unsigned tinyint (1 byte) 
```

所以我希望 19 字节/行。

此表中有 1,654,150 行，因此数据大小应为 31,428,850 字节（或大约 30 兆字节）。

但我可以通过 phpMyAdmin 看到数据占用了 136.3 MiB（不包括索引的大小`bigint 1, smallint, tinyint`为 79 MiB）。

存储引擎是 InnoDB，主键是`bigint 1, bigint 2`（用户 ID 和唯一项目 ID）。

* * *

**编辑：**根据评论中的要求，这是一个结果`SHOW CREATE TABLE storage`

```
CREATE TABLE `storage` (
 `fbid` bigint(20) unsigned NOT NULL,
 `unique_id` bigint(20) unsigned NOT NULL,
 `collection_id` smallint(5) unsigned NOT NULL,
 `egg_id` tinyint(3) unsigned NOT NULL,
 PRIMARY KEY (`fbid`,`unique_id`),
 KEY `fbid` (`fbid`,`collection_id`,`egg_id`)
) ENGINE=InnoDB DEFAULT CHARSET=utf8 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-07-17T16:28:03.597

您的索引在磁盘上有自己的表（尽管您不能直接“看到”它们）。您的数据库的总大小是您的表和索引表的大小。

跑

```
show create table <tablename>; 
```

您可以看到定义的任何索引。想象一下，将表的总大小和由主键中的两列组成的表相加。添加的那些会让你得到你所看到的大小。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-07-17T16:38:37.437

如果表经常进行插入/删除/更新，您可能想尝试运行`OPTIMIZE TABLE`查询以查看表可以缩小多少。数据文件中可能存在碎片整理和未使用的空间。

phpmyadmin 向您显示的数据大小不会是您在这里所期望的。你会看到当你第一次创建表时，它不会显示数据使用情况：0。它将是 16KB 或 32KB 之类的。插入记录时大小不会改变。这就是 innoDB 控制表文件的方式，就像它认为的那样高效。

检查`SHOW TABLE STATUS FROM {db_name}`并查看表中每行的 Avg_row_length 是多少。它也不会是 19 个字节

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2017-03-21T01:16:34.207

磁盘上 InnoDB 的数据大小通常是您计算的 2-3 倍。这是因为

*   每列的开销（长度，记录的偏移量）
*   每行开销（tx id 等）
*   每块开销（16KB）（链接到下一个块——B+Tree）
*   BTree 平均 69% 满
*   MVCC——多版本并发控制。这意味着在事务期间可以同时存在任何行的旧副本*和新副本*
*   等等。

一件事会有所帮助：几乎没有应用程序需要`BIGINT`（8 个字节）的 id。考虑`INT UNSIGNED`（4 字节，4B 限制）或`MEDIUMINT UNSIGNED`（3 字节，16M 限制）等。您有 2 个 Bigint，但它们有 4 个副本——辅助键隐含包含 PK 列。

与`PRIMARY KEY`数据一起存储，因此产生的开销非常小。二级键实际上是 4 列，是一个具有类似开销集的 BTree。

即使在 MyISAM 中，也有开销：

*   每行至少 1 个字节。（在您的情况下为 1）
*   每 8`NULLable`列 1 个字节（在您的情况下没有）
*   `DELETEd`在行是或之后丢失了一些空间`UPDATEd`。`FIXED`（由于记录大小，在您的情况下更新不会成为问题。）
*   `PRIMARY KEY`就像任何其他索引一样
*   所有键都有 69% 的问题；块为 1KB

（既然你没有`VARCHAR`or `TEXT`，我就不需要讨论 `CHARACTER SET 问题了。）

在 InnoDB 中，行数的*估计值*`SHOW TABLE STATUS`通常相差 2 倍。Avg_row_length 计算为 Data_length / Rows，因此它通常是关闭的。

 *我*不*推荐`OPTIMIZE TABLE`InnoDB 表；这几乎总是不值得付出努力。

这样做时`ALTER TABLE .. ADD INDEX ..`，旧版本的 MySQL 将重建整个表和索引。这样做，你得到的效果`OPTIMIZE`。（数据大小增加的可能性不大，但并非不可能。）较新的版本仅添加新索引。你运行的是什么版本？

每个`INDEX`都是一个单独的 BTree（除了 InnoDB 中的 PK）（除了`FULLTEXT`and `SPATIAL`）。*

# python - 我可以在python中故意导致异常吗？

> ID：11526740
> 
> 赞同：5
> 
> 时间：2012-07-17T16:21:43.853
> 
> 标签：python, exception, testing

所以这是一个有点奇怪的问题，但它可能很有趣！

我需要以某种方式可靠地导致python中的异常。我希望它是人为触发的，但我也愿意在我的代码中嵌入一些总是会导致异常的东西。（我已经设置了一些异常处理并想测试它）

我一直在环顾四周，有些想法似乎是被零除或类似的东西总是会导致异常——有更好的方法吗？最理想的是在程序运行时模拟互联网连接的丢失......任何想法都会很棒！

玩得开心！

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-07-17T16:23:33.397

是的，有：您可以明确提出自己的异常。

```
raise Exception("A custom message as to why you raised this.") 
```

您可能希望针对网络连接丢失提出适当的异常/错误。

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2012-07-17T16:40:58.120

您可以在 Python 中定义自己的异常，因此您可以创建自定义错误以满足您的需求。您可以测试某些条件是否存在，并使用该测试的真实性来决定是否提出您闪亮的自定义异常：

```
class MyFancyException(Exception): pass

def do_something():
    if sometestFunction() is True:
        raise MyFancyException
    carry_on_theres_nothing_to_see()    

try:
    do_something()
except MyFancyException:
    # This is entirely up to you! 
    # What needs to happen if the exception is caught? 
```

该[文档](http://docs.python.org/release/2.7.2/tutorial/errors.html#tut-userexceptions)有一些有用的示例。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-07-17T16:26:33.830

是的，你可以扑通一声

```
 1 / 0 
```

代码中的任何位置都会发生运行时错误，特别是在这种情况下 a `ZeroDivisionError: integer division or modulo by zero`.

这是通过在您的代码中嵌入一些东西来获得异常的最简单方法（正如您在帖子中提到的那样）。您当然也可以提出自己的例外情况.. 取决于您的具体需求。

# netty - 配置 Netty 服务器接收 HTTP 响应

> ID：11526744
> 
> 赞同：0
> 
> 时间：2012-07-17T16:21:47.413
> 
> 标签：netty

我有一个设置为接收 http 请求和发送 http 响应的 netty 服务器。但是，服务器无法接收 http 响应。

最初，我在管道中有以下 2 个处理程序，它作为常规服务器运行良好。

org.jboss.netty.handler.codec.http.HttpRequestDecoder org.jboss.netty.handler.codec.http.HttpResponseEncoder

为了收到回复，我添加了

org.jboss.netty.handler.codec.http.HttpResponseDecoder

到管道。但这并没有帮助。

我需要如何配置服务器以便能够接收 http 响应？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-10-10T10:18:10.643

猜你想做一个代理！

使用不同的管道和 ClientBootstrap 转发消息并添加两个处理程序：

```
pipeline.addLast("decoder", new HttpResponseDecoder());
pipeline.addLast("encoder", new HttpRequestEncoder()); 
```

高温高压

# git - Using annotated tags for NEWS file

> ID：11526748
> 
> 赞同：0
> 
> 时间：2012-07-17T16:22:03.900
> 
> 标签：git

The GNU coding standard requires every conforming source distribution to ship a `NEWS` file containing a summary of changes. I think this is a good idea (but that does not matter here) and since I am using git I thought it would be great to autogenerate that file. My idea was to use the message of annotated tags (when I create a tag I also write a summary of changes) and put them into this file. However, I did not find a way to access the message in an easy way. I used the following code:

```
git tag -l -n100 <tag-name> 
```

Which gives me

```
<tag-name>           Message-Header 1

    - foo
    - bar
    - bla
    - blup 
```

I would like to get the message without `<tag-name>` and those spaces. For commit messages I can use

```
git --format='%s %b' <id> # %s = subject, %b = body of commit message 
```

Is there a similar command for the messages of annotated commit tags or is it not meant for such purposes?

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-07-23T14:10:23.430

I finally found out how to do this myself, `git for-each-ref --format='...' refs/tags` is what I was looking for:

```
git for-each-ref --sort='-*committerdate' --format \
    'News for %(refname:short):%0a===============%0a%0a%(body)' \
    refs/tags > NEWS 
```

This adds an entry for each git tag into the NEWS file in the following format:

```
News for <git-tag-name>:
========================

Annotation for the tag 
```

The entries are inversely sorted so that the topmost one is also the most recent.

# c# - 在非开发机器上使用 C# 类库

> ID：11526749
> 
> 赞同：1
> 
> 时间：2012-07-17T16:22:08.020
> 
> 标签：c#, installation

我有一个 C# 类库，它是 COM 可见的，可以从 Visual C++ 6 调用。它工作正常。

可能是一个愚蠢的问题，但即使在谷歌搜索后我也找不到答案。如何在另一台非开发机器上复制和注册它？我的机器`gacutil`上`regasm`有我正在使用的。但是，这些不在另一台机器上。我似乎能够在 Google 上找到的唯一答案是关于创建安装应用程序，但这对于只能在内部使用的东西来说太过分了。

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-07-17T16:24:51.873

`Regasm`并且`Gacutil`都与 .NET Framework 一起安装（`C:\WINDOWS\Microsoft.NET\Framework\v2.0.50727`例如，默认情况下在 3.5sp1 中）。

由于无论如何您都需要安装框架，因此它应该存在于每个系统上。

# android-layout - Android：如何在添加focusable=true和focusableInTouchMode=true后给TextView一个可聚焦的样式？

> ID：11526756
> 
> 赞同：0
> 
> 时间：2012-07-17T16:22:30.077
> 
> 标签：android-layout, android-widget, textview, android-styles, android

我有一个简单的 TextView，它在触摸/聚焦时执行一个功能，

我已将其设置为可聚焦，如下所示：

```
<TextView
  android:id="@+id/post_interests"
  style="@style/InterestsEditText"
  android:layout_width="fill_parent"
  android:layout_height="wrap_content"
  android:hint="Select Interest(s)"
  android:focusable="true"
  android:focusableInTouchMode="true">
</TextView> 
```

并将此样式添加到其中：

```
<style parent="@android:style/Widget.TextView" name="InterestsEditText">
    <item name="android:background">@android:drawable/edit_text</item>
    <item name="android:textSize">18dp</item>       
</style> 
```

我现在需要的是让它在获得焦点时看起来像一个**编辑文本**，因为它当前的外观在获得焦点时不会改变。**但是会触发焦点事件。**

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-04-22T04:18:19.787

为什么不使用 EditText 并为其提供背景以获得所需的外观？您打算使用 TextView 的任何特定功能吗？

# .net - Windows Azure 和 Web API 部署

> ID：11526760
> 
> 赞同：2
> 
> 时间：2012-07-17T16:22:34.727
> 
> 标签：.net, azure, asp.net-web-api

我已将一个非常简单的 WEB Api 项目部署到 Windows Azure 并收到以下错误：

```
 Method not found: 'System.Web.Http.Services.DefaultServices System.Web.Http.HttpConfiguration.get_Services()'. 
```

当我查看 bin 目录时，它似乎拥有与我的本地项目相同的所有 dll。那么我缺少什么二进制文件？

以下是 bin 中的文件：

```
Newtonsoft.Json.dll
System.Json.dll
System.Net.Http.dll
System.Net.Http.Formatting.dll
System.Net.Http.WebRequest.dll
System.Net.Http.xml
System.Web.Http.Common.dll
System.Web.Http.dll
System.Web.Http.WebHost.dll
MyApp.dll 
```

触发它的代码在 Global.asax 中：

```
protected void Application_Start(object sender, EventArgs e)
{
    GlobalConfiguration.Configuration.Routes.MapHttpRoute(name: "api", routeTemplate: "api/{controller}", defaults: new { controller = "MyApp" });
} 
```

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-07-18T07:59:27.687

此错误表明存在 Web API Beta dll。

由于 Beta 位于 GAC 中，要摆脱它并不容易，最简单的方法是卸载 MVC4 并重新安装，确保获得 RC 版本。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-07-17T22:58:25.170

我一定有旧版本的 MVC 4 捆绑包。我卸载、重新下载、重新安装、重新部署，现在一切正常。

# python - Django将ManyToManyField添加到ModelForm

> ID：11526767
> 
> 赞同：1
> 
> 时间：2012-07-17T16:23:00.017
> 
> 标签：python, django, django-forms

抱歉，这就像这个问题的第千个问题，但我仍然看不到隧道尽头的光。

假设我有两个模型：

```
class Video(models.Model):
title = models.CharField(u"Titel",max_length=200)
slug = AutoSlugField(populate_from='title',unique=True)
date = models.DateField("Datum")
description = models.TextField(u"Beschreibung")
user = models.OneToOneField(User, blank=True, null=True)

class Channel(models.Model):
name = models.CharField(u"Name",max_length=30)
slug = AutoSlugField(populate_from='name',unique=True)
videos = models.ManyToManyField('videoportal.Video',related_name="contained_videos",blank=True,null=True)
created = models.DateTimeField(auto_now_add=True)
modified = models.DateTimeField(auto_now=True) 
```

如您所见，我想要一个包含视频的频道。因此，如果我使用这样的 ModelForm 为视频做广告

```
class VideoForm(ModelForm):
    class Meta:
        model = Video 
```

我得到的表格将不包含选择频道的输入字段（当然不是）。那么我该怎么做呢？如何在我的表单中有一个输入字段来选择一个带有下拉菜单的频道？

谢谢，菲利普

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-07-17T17:37:09.607

如果视频只属于一个频道，只需将您的`Video`模型提供`ForeignKey`给您的`Channel`模型。如果它应该属于多个频道，我会`ManyToManyField`在`Video`模型中使用 a，正如已经建议的那样。

我认为这符合上传视频并将其添加到频道的想法，这比反过来做要好得多。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-07-17T16:28:37.967

使用自定义表单而不是 Django ModelForm。

大概是这样的，

```
class VideoForm(forms.Form):
    title = forms.CharField()
    description = forms.TextField()
    channel = forms.ModelChoiceField(queryset= Channel.objects.all(), empty_label=None) 
```

在视图中进行验证。使用`Model save()`方法来保存包含在您的 POSTed 表单中的信息。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-07-17T16:48:42.457

尝试将 ManyToMany 字段放在`Video`模型中并从模型中省略它`Channel`：

```
 class Video(model.Model):
    ...
    channels = model.ManyToManyField('videoportal.Channel', related_name='videos')
    ... 
```

如果你想要一个简单的下拉菜单来选择单个频道，为什么视频和频道之间是多对多的关系？

# vba - 如何将带有代码的表格样式分配给word文档

> ID：11526778
> 
> 赞同：0
> 
> 时间：2012-07-17T16:23:35.907
> 
> 标签：vba, ms-word, word-style

我正在使用我为我的工作创建的 Visual Basic 2010 软件中的数据创建一个 word 文档，该软件包含在一份报告中......我被要求生成一个 Microsoft word 文档，所以现在我正在创建一个表格并填写它有数据的表，像这样

```
oTable = oDoc.Tables.Add(oDoc.Bookmarks.Item("\endofdoc").Range, 8, 4)
oTable.Range.ParagraphFormat.SpaceAfter = 6
oTable.Range.Font.Size = 10

oTable.Rows.Item(1).Range.Font.Bold = True
oTable.Rows.Item(1).Range.Font.Italic = True
oTable.Cell(1, 1).Range.Text = "Datos de Facturación:"
oTable.Cell(1, 3).Range.Text = "            Enviar a:"
oTable.Cell(2, 1).Range.Text = rs.Text
oTable.Cell(2, 1).Width = 75
oTable.Cell(3, 1).Range.Text = dirfa.Text
oTable.Cell(3, 1).Width = 75 ..... etc.. 
```

Microsoft Word 有一些表格设计样式，例如“DARK LIST - ACCENT 5”。“DARK LIST - ACCENT 6”等，我不知道如何将这种样式设置到表格中，这可能吗？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-07-19T11:57:15.107

要创建样式，您可以使用文档对象：

```
Set doc = wd.Documents.Add(NewTemplate:=True)

With doc.Styles("Certificate")
    With .Font
        .Name = "Arial"
        .Size = 12
        .Italic = True
        .Bold = True
    End With

    With .ParagraphFormat
        ''wdAlignParagraphCenter = 1
        .Alignment = 1
        .SpaceAfter = 0
        .SpaceBefore = 0
    End With
End With 
```

指定样式：

```
Set r = doc.Shapes("Course1").TextFrame.TextRange
r.Style = "Certificate" 
```

对于这种特殊情况，您可以使用：

```
 oTable.Range.Style = "ANewStyle" 
```

或者，如果您可以使用内置样式：

```
 oTable.Rows.Item(1).Range.Style = WdBuiltinStyle.wdStyleHeading1 
```

# android - Android C2DM 如何提高带宽使用率？

> ID：11526779
> 
> 赞同：1
> 
> 时间：2012-07-17T16:23:40.000
> 
> 标签：android, android-c2dm

我一直在读到，使用 Android C2DM 是最有效的解决方案，就带宽而言，用于跟踪更新。但是，我完全错过了 C2DM 是如何更高效的，即每 5 分钟轮询一次的解决方案。

我的理解是：C2DM 通过维护持久的 TCP/IP 连接来工作。保持所述连接意味着保持收音机开启（我认为这是我错的地方？） [http://developer.android.com/training/efficient-downloads/efficient-network-access.html](http://developer.android.com/training/efficient-downloads/efficient-network-access.html)

那么，即使处于低功耗模式，保持 TCP/IP 连接打开是否也不会一直保持无线电开启？

每 5 分钟轮询一次，即使延迟宽度是无线电打开/关闭，将持续 3 秒下载，将无线电保持在高功率模式 5 秒和低功率模式 12 秒（延迟关闭）。

感谢您帮助解决这个问题。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-07-17T16:35:28.490

服务器不会轮询使用 bw 和数据的更改，而是会在发生更改时通知您，只有这样您才能检索更改。

# c# - 无法通过对象引用访问类的成员

> ID：11526786
> 
> 赞同：2
> 
> 时间：2012-07-17T16:23:59.080
> 
> 标签：c#, reflection

下面的代码执行没有错误并打印“ *In some* ”，这意味着该语句

```
m[0].Invoke(o, args); 
```

在对象上调用作为类`some`成员的函数并影响其公共变量。但是当我们取消注释最后一行代码并尝试编译它时，它会产生错误。为什么？？`foo``o``i`

```
using System;
using System.Reflection;

class foo
{
    public int i;
    public foo(int ii = 0)
    {
        i = ii;
    }
    public void some(int ii)
    {
        i = ii;
        Console.WriteLine("In some ");
    }
}

class main
{
    static public void Main()
    {
        foo f = new foo();
        object o = new foo();

        Type t = typeof(foo);

        object[] args = new object[1];
        args[0] = 9;
        MethodInfo[] m = t.GetMethods();
        m[0].Invoke(o, args);
        //Console.WriteLine(o.i);
    }
} 
```

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-07-17T16:26:20.373

> 但是当我们取消注释最后一行代码并尝试编译它时，它会产生错误。为什么？？

因为您已声明`o`为，就编译器而言`System.Object`，它没有定义变量。`i`您需要将其转换为已知类型，或使用反射来检索此值。

例如：

```
// You can cast here, since you know the type
foo oAsFoo = o as foo;
Console.WriteLine(oAsFoo.i); 
```

或者，使用反射来获取值：

```
FieldInfo field = t.GetField("i");
Console.WriteLine(field.GetValue(o)); 
```

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-07-17T16:26:42.233

您还需要强制`o`转换`foo`才能执行它。

```
Console.WriteLine(((foo)o).i) 
```

> C# 是一种静态类型（类型安全）语言，仅允许类型安全操作，并且由于没有类 `public`成员，因此编译器不允许使用。`i``object`

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-07-17T16:27:14.227

`o`是可以保存`object`任何类型的对象类型，但对象的实例不能访问`assigned`类对象的属性。

类型转换为其各自的类使公共成员可以像这样访问。

```
Console.WriteLine(((foo)o).i) 
```

# java - dto 是否应该实现关联的接口？

> ID：11526788
> 
> 赞同：1
> 
> 时间：2012-07-17T16:24:11.777
> 
> 标签：java, jackson, dto

bean dto 是否应该始终具有关联的接口？

杰克逊使用下面的 dto 通过网络发送 json ：

```
public class Bean {

    private String date;

    public Bean(String date)
    {
        this.link = date;
    }

    public String getDate() {
        return date;
    }

} 
```

这个类是否应该总是实现一个接口来匹配它的结构？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-07-17T16:46:42.770

除非您使用需要接口的 API 或框架，或者自己编写 API，否则我不会。

旧版本的 J2EE（在成为 Java EE 之前）需要企业 bean 的接口，而其他一些框架使用接口来生成代理；然而，这主要被合成代理的运行时生成所取代。如果您从定义良好的类开始，您可以稍后添加一个您发现需要的接口。

目前，我的一项任务是维护现有的 Web 应用程序。本质上，其中的所有内容都具有接口 + 类模式，但没有真正的原因，因为它完全是自包含的。接口的额外文件只会使工作空间变得混乱，并且在每种情况下都需要多花几秒钟的时间来追踪实际代码的源代码（不能在 Eclipse 中仅突出显示并按 F3）。

# sql - sql，自动完成，带过滤的全文搜索

> ID：11526793
> 
> 赞同：0
> 
> 时间：2012-07-17T16:24:16.070
> 
> 标签：sql, sql-server, autocomplete, full-text-search

我正在建立一个小型社交网站。我正在使用 SQL 服务器和 linq 2 实体。我的用户可以在消息中写下他们的朋友姓名，我想自动完成用户姓名，但只能使用他们朋友的用户姓名。我可以通过全文搜索做到这一点吗？因为我没有看到将 where 子句与 FTS 结合使用的方法。非常感谢您的帮助！

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-07-18T15:19:38.323

在应用程序的服务器端缓存来自 DB 的所有朋友，然后使用 Jquery/your_favorite_ajax_library 获取自动完成列表。在从客户端输入的每个字母之后查询 DB 是完全扼杀任何性能的好方法。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-07-18T07:05:28.517

将所有朋友的名字发送给客户端并在客户端进行自动完成搜索可以更有效。

# .net - DNN、iFinity 和 404？

> ID：11526794
> 
> 赞同：0
> 
> 时间：2012-07-17T16:24:23.917
> 
> 标签：.net, iis-7, dotnetnuke

DotNetNuke (DNN) 站点中的错误日志充满了如下所示的错误。这些重要吗？它们似乎与 404 相关，但为什么它们会导致一般异常，因为 iFinity Url Master 正在处理 404。DNN 中有没有办法停止报告它们？

**一般异常** AssemblyVersion：6.2.0 UserID：-1 UserName：ActiveTabID：678 ActiveTabName：404 RawURL：/Portals/Portals/0/favicon.ico AbsoluteURL：/404.aspx AbsoluteURLReferrer：UserAgent：Mozilla/5.0（兼容；MSIE 9.0； Windows NT 6.1；WOW64；Trident/5.0) DefaultDataProvider：DotNetNuke.Data.SqlDataProvider，DotNetNuke.SqlDataProvider ExceptionGUID：b546f73a-6e44-48d2-9c6e-6bddc70c9ff4 InnerException：未处理的错误：FileName：FileLineNumber：0 FileColumnNumber：0 方法：StackTrace：消息：System.Exception：未处理的错误：

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-07-20T04:11:25.570

如果不对 DotNetNuke 核心进行修改，就无法避免这些错误。

基本上发生的情况是 Url Master 模块处理 404 错误并将其清除，但 DNN 异常处理仍会选择错误并将其记录下来。

这已记录在 DotNetNuke Gemini 错误跟踪系统中，但尚未修复。Url Master 安装的发行说明部分中提到了它。

只要您的 404 错误过程运行正常，就没有什么可担心的。

[如果错误已被清除，异常模块仍会记录错误](http://support.dotnetnuke.com/issue/ViewIssue.aspx?id=14021&PROJID=2)

# java - 如何将资源映射到枚举常量？

> ID：11526796
> 
> 赞同：1
> 
> 时间：2012-07-17T16:24:32.350
> 
> 标签：java, spring, spring-mvc, dependency-injection, enums

我目前正在重构 Spring-MVC 控制器中方法的（前）怪物。该方法基本上做了以下事情：

1.  从请求中挖掘出一些标识符
2.  从缓存中获取由它们标识的产品的 XML 表示
3.  使用 XSL 样式表生成 PDF（然后将其存储到缓存中并将可以找到的键添加到`Model`.

`Product`通过创建一个包含所有其他产品特定内容的枚举，我已经能够删除几乎所有重复的逻辑，但是 XSL 样式表的位置是有问题的。以前它们被配置为`org.springframework.core.io.Resource`控制器 bean 的 -type 属性，但现在产品特定的东西在枚举中，我要么需要以某种方式将它们映射到枚举常量，要么找到另一个解决方案来定位它们。

我认为最好将 XSL 作为枚举的一部分，因为它们之间存在一对一的关系，但是没有办法在那里注入资源。使用类加载器手动将资源加载到枚举中可以在测试中工作，但在生产环境中会出现问题，因为样式表文件不在类路径中。另外，我不想让枚举依赖于任何 Spring 的东西。

关于如何在不使枚举和控制器过于紧密耦合的情况下解决这个问题的任何想法？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-07-26T14:36:40.710

最后，我将枚举设置为控制器的内部类，并添加了一个调用`getXsl`它的抽象方法。实现枚举常量现在`Resource`直接返回相关的。`Resource`由于bean 已经是静态的，因此我无需更改任何其他内容。

# python - HMAC签名和直接散列有什么区别？

> ID：11526799
> 
> 赞同：5
> 
> 时间：2012-07-17T16:24:40.097
> 
> 标签：python, hash, cryptography, hmac

只是出于好奇，真的......例如，在python中，

```
hashlib.sha1("key" + "data").hexdigest() != hmac.new("key", "data", hashlib.sha1) 
```

这两个动作之间是否存在一些逻辑上的区别？

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-07-17T16:44:24.360

hashlib.sha1 为您提供作为参数提供的内容“keydata”的简单 sha1 哈希（请注意，您只是连接两个字符串）。hmac 调用为您提供字符串“data”的键控散列，使用字符串“key”作为键，sha1 作为散列函数。这两个调用之间的根本区别在于，只有在您知道密钥的情况下才能复制 HMAC，因此您也可以知道是谁生成了 hmac。SHA1 只能用于检测内容没有改变。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-07-18T13:45:52.040

我在手册中找到了答案。

[https://en.wikipedia.org/wiki/Hmac#Design_principles](https://en.wikipedia.org/wiki/Hmac#Design_principles)

# c# - C# 委托事件处理程序不起作用？

> ID：11526808
> 
> 赞同：3
> 
> 时间：2012-07-17T16:25:21.697
> 
> 标签：c#, events, delegates, event-handling, anonymous-function

我正在为我的应用程序编写一些测试功能。
在这段测试代码中，我从本地 Json 文件创建了一个文件流，并使用我自己的包装`JsonDeserializer`类对其进行反序列化。

```
 using (FileStream fs = new FileStream(pathSource, FileMode.Open, FileAccess.Read))
        {
            JsonDeserializer<People>.DeserializeStream(fs);
            JsonDeserializer<People>.DeserializeEvent += new EventHandler<DeserializeEventArgs<People>>(
                delegate(object sender, DeserializeEventArgs<People> e) 
                {
                    id = e.DeserializeResult.Id;
                });
        } 
```

在我的 JsonDeseralizer 类中，它会在反序列化完成时引发一个事件，如下所示：

```
 using (Stream readyToDeserializeStream = new MemoryStream(readyToDeserializeByteArray))
        {

            DataContractJsonSerializer jsonSerializer = new DataContractJsonSerializer(typeof(T));

            T resultObject = (T)jsonSerializer.ReadObject(readyToDeserializeStream);

            if (DeserializeEvent != null) <-----this is null
            {
                DeserializeEvent(null, new DeserializeEventArgs<T>(resultObject));
            }
        } 
```

但是问题出在第一个代码段中，即使我将处理程序添加到事件中，结果仍然是事件为空（在第二个代码段中）。所以我想知道我是否在第一部分中做错了委托事件处理程序和匿名函数？

请分享您对此的想法，谢谢。

=================更新======================

JsonDeserializer 类中 DeserializeEvent 的定义

```
 public static event EventHandler<DeserializeEventArgs<T>> DeserializeEvent; 
```

# vba - VBA XMLHTTP 清除身份验证？

> ID：11526810
> 
> 赞同：3
> 
> 时间：2012-07-17T16:25:40.790
> 
> 标签：vba, xmlhttprequest

我正在编写一组 VBA 宏，其中它使用 XMLHTTP 对象向服务器发送异步请求。我正在发送基本身份验证：

```
XMLHttpReq.setRequestHeader "Authorization","Basic " & Base64EncodedUserPass 
```

这第一次效果很好。但是，如果用户更改了他们的用户 ID/密码，即使代码创建了一个全新的 XMLHttpReq 对象并将此标头设置为新信息，它也会作为第一个用户登录服务器，可能是从缓存的凭据中登录的。

如何使代码“忘记”我以前登录过并重新授权？

**根据要求编辑**代码的相关部分；它真的不是很复杂：

```
myURL = "http://my.domain.com/myscript.cgi"
Dim oHttp As New MSXML2.XMLHTTP
oHttp.Open "POST", myURL, False
oHttp.setRequestHeader "Content-Type", "application/x-www-form-urlencoded'"
oHttp.setRequestHeader "Authorization","Basic " & Base64EncodedUsernamePassword
oHttp.send "PostArg1=PostArg1Value"
Result = oHttp.responseText 
```

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-07-23T15:17:12.300

由于主要浏览器缓存方法的不同实现，这些问题已经以多种方式进行了讨论。

我会给你什么对我有用，然后是我在这个*特性*上找到的资源。

我能遇到的唯一解决方案是强制浏览器不缓存请求。

```
myURL = "http://my.domain.com/myscript.cgi"
Dim oHttp As New MSXML2.XMLHTTP
oHttp.Open "POST", myURL, False
oHttp.setRequestHeader "Content-Type", "application/x-www-form-urlencoded'"
oHttp.setRequestHeader("Cache-Control", "no-cache");
oHttp.setRequestHeader("Pragma", "no-cache");
oHttp.setRequestHeader("If-Modified-Since", "Sat, 1 Jan 2000 00:00:00 GMT");
oHttp.setRequestHeader "Authorization","Basic " & Base64EncodedUsernamePassword
oHttp.send "PostArg1=PostArg1Value"
Result = oHttp.responseText 
```

似乎`Cache-Control`适用于大多数浏览器，并且`Pragma`仅适用于 Firefox 而不是 IE（不知道为什么......）

`If-Modified-Since`用于 IE，因为 IE 在他自己的算法中使用不同的设置来确定是否应该缓存请求。XMLHttpRequest 似乎与 HTTP 响应不同。

**小心**：使用此代码，您将**需要** `username`并且`password`每次创建一个新对象。也许您应该创建一个新对象，将其实例化一次，然后在使用后将其销毁。在这两者之间，您将在不同的功能中处理您的所有请求，只需一次身份验证。

* * *

## 来源

[MSDN setRequestHeader 方法](http://msdn.microsoft.com/en-us/library/windows/desktop/ms766589(v=vs.85).aspx)

[MSDN IXMLHTTPRequest](http://msdn.microsoft.com/en-us/library/windows/desktop/ms759148(v=vs.85).aspx)

[XMLHTTPREQUEST 缓存测试](http://www.mnot.net/javascript/xmlhttprequest/cache.html)

[XMLHttpRequest 和缓存](http://www.subbu.org/blog/2005/10/xmlhttprequest-and-caching)

# vb.net - 如何在visual basic 2008中为下一个循环使用计时器

> ID：11526811
> 
> 赞同：2
> 
> 时间：2012-07-17T16:25:45.570
> 
> 标签：vb.net

我有一个案例，我需要生成数百万个唯一代码。为此，我创建了一个生成函数，其中生成随机数。我从 for 循环调用此函数并将生成的数字添加到列表框中。我的代码如下

```
 for i=1 to val(txtnumber.txt)
       mynum=generate()
  next 
```

我在表单上创建了一个标签，我想在其中显示处理循环时经过的秒数。我使用定时器控制作为

```
 timer1.start()
     for i=1 to val(txtnumber.text)
        mynum=generate()
        listbox1.items.add(mynum)
     next
     timer1.stop 
```

和 timer1_tick 功能

```
 Private Sub Timer1_Tick(ByVal sender As System.Object, ByVal e As System.EventArgs) Handles Timer1.Tick
    Label1.Text = Val(Label1.Text) + 1
     End Sub 
```

但是当我单击生成按钮时，会生成所有数字，但计时器不显示经过的时间。

我可能错过了一些东西，所以请帮帮我

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-07-17T16:58:05.570

这可能最好在 BackgroundWorker 中处理。将一个放在表单上并设置其`WorkerReportsProgress=True`. 此外，在 ListBox 中放置一百万个数字可能不是一个好主意，所以我省略了这一点。

```
Private Sub Button1_Click(ByVal sender As Object, ByVal e As EventArgs) Handles Button1.Click
  Button1.Enabled = False
  BackgroundWorker1.RunWorkerAsync()
End Sub

Private Sub BackgroundWorker1_DoWork(ByVal sender As Object, ByVal e As DoWorkEventArgs) Handles BackgroundWorker1.DoWork
  Dim started As DateTime = Now
  For i As Integer = 1 To val(txtnumber.txt)
    mynum=generate()
    BackgroundWorker1.ReportProgress(i, Nothing)
  Next
  Dim ended As TimeSpan = Now.Subtract(started)
  BackgroundWorker1.ReportProgress(0, ended.TotalSeconds.ToString)
End Sub

Private Sub BackgroundWorker1_ProgressChanged(ByVal sender As Object, ByVal e As ProgressChangedEventArgs) Handles BackgroundWorker1.ProgressChanged
  If e.UserState IsNot Nothing Then
    Label1.Text = e.UserState.ToString()
  Else
    Label1.Text = e.ProgressPercentage.ToString
  End If
End Sub

Private Sub BackgroundWorker1_RunWorkerCompleted(ByVal sender As Object, ByVal e As RunWorkerCompletedEventArgs) Handles BackgroundWorker1.RunWorkerCompleted
  Button1.Enabled = True
End Sub 
```

`ProgressChanged`当工作人员报告事件时，您的标签应该会正确更新。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-07-17T16:39:12.760

您遇到的是线程问题。您为生成数字所做的工作正在由 UI 线程执行，因此它永远没有机会更新屏幕。看看这里： [如何防止 UI 在漫长的过程中冻结？](https://stackoverflow.com/q/2447123/475820)

这也可能对您有很好的信息： [从另一个线程更新 UI](https://stackoverflow.com/q/8498937/475820)

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-07-17T16:44:20.617

试试这个：

```
Private _Counter As Integer = 0
Private _StartTime As Date = Now

Private Sub Button1_Click(sender As System.Object, e As System.EventArgs) Handles Button1.Click
    _StartTime = Now
    _Counter = CInt(Val(txtnumber.Text))
    ListBox1.Items.Clear()
    Label1.Text = "0"
    Timer1.Interval = 50
    Timer1.Start()
End Sub

Private Sub Timer1_Tick(sender As System.Object, e As System.EventArgs) Handles Timer1.Tick
    ListBox1.Items.Add(generate())
    Label1.Text = New Date((Now - _StartTime).Ticks).ToString("HH:mm:ss.ff")
    _Counter -= 1
    If (_Counter <= 0) Then
        Timer1.Stop()
    End If
End Sub 
```

或者您可以研究实际的[Threading](http://msdn.microsoft.com/en-us/library/6kac2kdh.aspx)。

# php - 组 , 订单 , 限价

> ID：11526812
> 
> 赞同：0
> 
> 时间：2012-07-17T16:25:53.513
> 
> 标签：php, mysql, sql

我有这个脚本：

```
 $limit1=10; 
 $MySQL=mysql_connect($myhost,$myuser,$mypass);
    mysql_select_db($sitedb);
    $rank = mysql_query('SELECT usrid,num FROM 7stat '.' GROUP BY usrid ORDER BY num desc LIMIT '.$limit1.''); 
    $i=1;
    while ($row = mysql_fetch_array($rank)) 
    {
    echo '<tr>
       <td align="center">'.$row['usrid'].'</td><br>
      <td align="center">'.$row['num'].'</td>
    </tr> ';
    $i++;
    } 
```

基本上应该向我展示前 10 名冲浪者，但事实并非如此。在这个页面可以找到结果：http: [//123autotraffic.com/12.php](http://123autotraffic.com/12.php)

检查最后一张桌子。

我的用户名：1

我今天获得了 840 个学分 (num)，从一开始就超过 30000，但脚本显示为 52。

请帮忙 。

* * *

```
CREATE TABLE IF NOT EXISTS `7stat` (
  `usrid` int(10) unsigned NOT NULL DEFAULT '0',
  `date` date NOT NULL DEFAULT '0000-00-00',
  `num` float unsigned NOT NULL DEFAULT '0',
  PRIMARY KEY (`usrid`,`date`),
  KEY `date` (`date`)
) ENGINE=MyISAM DEFAULT CHARSET=latin1; 
```

我必须使用组，因为它是每月统计信息，如果未分组将多次显示相同的用户 ID。

固定的 。非常感谢大家。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-07-17T16:43:53.133

更新脚本中的查询：

```
$rank = mysql_query('SELECT `usrid`, SUM(`num`) AS mysum FROM `7stat`
                       GROUP BY `usrid` ORDER BY mysum DESC LIMIT '.$limit1); 
```

并替换代码中的所有位置：

```
$row['num'] 
```

和：

```
$row['mysum'] 
```

# r - 使用 rbind() 函数在 R 中绘制条形图

> ID：11526816
> 
> 赞同：0
> 
> 时间：2012-07-17T16:25:58.090
> 
> 标签：r

我有一个这样的数据集：

```
Date Tank Time Female.in.Middle Female.in.R.assoc Female.in.L.assoc R.side.of.divider
96  16-May   I3 1045           0.6080            0.0646            0.2561            0.0000
97  16-May   I3  215           0.5583            0.4210            0.0058            0.0000
100 17-May   I3  115           0.5190            0.3346            0.1381            0.0000
102 21-May   I3 1030           0.2184            0.3120            0.1335            0.3256
104 30-May   I3 1045           0.0092            0.0520            0.2067            0.0000
106 31-May   I3 1045           0.0000            0.0000            0.0000            0.0000
    L.side.of.Divider Tank.1 Date.Entered M.L.name Male.L.Length Male.L.Weight M.R.name
96             0.0655     I3       15-May  green 2           7.8         16.67   pink 1
97             0.0000     I3       15-May  green 2           7.8         16.67   pink 1
100            0.0000     I3       15-May  green 2           7.8         16.67   pink 1
102            0.0000     I3       15-May  green 2           7.8         16.67   pink 1
104            0.6652     I3       15-May  green 2           7.8         16.67   pink 1
106            0.9767     I3       15-May  green 2           7.8         16.67   pink 1
    Male.R.Length Male.R.Weight Side.of.Spawn F.Length F.Weight F.name last.female.spawn.date
96            7.8         20.99             L      4.3     2.84     1c                  5-May
97            7.8         20.99             L      4.3     2.84     1c                  5-May
100           7.8         20.99             L      4.3     2.84     1c                  5-May
102           7.8         20.99             L      4.3     2.84     1c                  5-May
104           7.8         20.99             L      4.3     2.84     1c                  5-May
106           7.8         20.99             L      4.3     2.84     1c                  5-May
    spawn.date.in.paradigm X d.in.p dbs X.1 X.2 X.3
96                  29-May        1  13  NA  NA  NA
97                  29-May        1  13  NA  NA  NA
100                 29-May        2  12  NA  NA  NA
102                 29-May        6   8  NA  NA  NA
104                 29-May       15  -1  NA  NA  NA
106                 29-May       16  -2  NA  NA  NA 
```

使用 cbind() 函数创建边合计后：

```
rside1c<-cbind(jd1c$Female.in.R.assoc + jd1c$R.side.of.divider)
lside1c<-cbind(jd1c$Female.in.L.assoc + jd1c$L.side.of.Divider) 
```

我想使用 rbind() 创建一个表，但它只是将它们像一个列表一样放在一起。如果我使用 rside1c 和 lside1c 的值创建向量，那么它工作得很好。我想跳过这一步虽然..如何更改此数据以正常工作？

而不是这个：

```
 [,1]
 [1,] 0.0646
 [2,] 0.4210
 [3,] 0.3346
 [4,] 0.6376
 [5,] 0.0520
 [6,] 0.0000
 [7,] 0.3216
 [8,] 0.0058
 [9,] 0.1381
[10,] 0.1335
[11,] 0.8719
[12,] 0.9767 
```

我想要这个：

```
 [,1]   [,2]   [,3]   [,4]   [,5]   [,6]
vr 0.0646 0.4210 0.3346 0.6376 0.0520 0.0000
vl 0.3216 0.0058 0.1381 0.1335 0.8719 0.9767 
```

不这样做：

```
vr<-c(.0646, .4210, .3346, .6376, .0520, .0)

vl<-c(.3216, .0058, .1381, .1335, .8719, .9767)

tab1<-rbind(vr, vl) 
```

谢谢

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-07-17T16:37:08.083

你可以简单地用`t`函数转置它

```
dat <- data.frame(vr, vl)
dat
#      vr     vl
#1 0.0646 0.3216
#2 0.4210 0.0058
#3 0.3346 0.1381
#4 0.6376 0.1335
#5 0.0520 0.8719
#6 0.0000 0.9767
t(dat)
#     [,1]   [,2]   [,3]   [,4]   [,5]   [,6]
#vr 0.0646 0.4210 0.3346 0.6376 0.0520 0.0000
#vl 0.3216 0.0058 0.1381 0.1335 0.8719 0.9767 
```

# sql - 构造一个返回表（或其他替代方案）的用户定义函数，以使查询更具可读性

> ID：11526817
> 
> 赞同：0
> 
> 时间：2012-07-17T16:26:02.823
> 
> 标签：sql, union, sybase, readability, user-defined-functions

我目前的查询中有一个部分与此类似

```
, T3 AS (
          select 'FSA'            as tType, b.fsacd  as tBefore, c.fsacd  as tAfter from T1 as a , T2 as b,T2 as c where a.beforeID = b.tID and a.afterID =c.tID 
    union select 'Scale'          as tType, b.scd    as tBefore, c.scd    as tAfter from T1 as a , T2 as b,T2 as c where a.beforeID = b.tID and a.afterID =c.tID 
    union select 'Retail Source'  as tType, b.rsc    as tBefore, c.rsc    as tAfter from T1 as a , T2 as b,T2 as c where a.beforeID = b.tID and a.afterID =c.tID 
    union select 'Mix Match'      as tType, b.mmcd   as tBefore, c.mmcd   as tAfter from T1 as a , T2 as b,T2 as c where a.beforeID = b.tID and a.afterID =c.tID 
    union select 'Price Entry'    as tType, b.pecd   as tBefore, c.pecd   as tAfter from T1 as a , T2 as b,T2 as c where a.beforeID = b.tID and a.afterID =c.tID 
    union select 'Qntty Entry'    as tType, b.qecd   as tBefore, c.qecd   as tAfter from T1 as a , T2 as b,T2 as c where a.beforeID = b.tID and a.afterID =c.tID    
    union select 'Price 3 Decs'   as tType, b.p3d    as tBefore, c.p3d    as tAfter from T1 as a , T2 as b,T2 as c where a.beforeID = b.tID and a.afterID =c.tID    
    union select 'Tare Entry'     as tType, b.tecd   as tBefore, c.tecd   as tAfter from T1 as a , T2 as b,T2 as c where a.beforeID = b.tID and a.afterID =c.tID    
    union select 'Undiscountable' as tType, b.undsc  as tBefore, c.undsc  as tAfter from T1 as a , T2 as b,T2 as c where a.beforeID = b.tID and a.afterID =c.tID    
    union select 'Foodstamp'      as tType, b.fds    as tBefore, c.fds    as tAfter from T1 as a , T2 as b,T2 as c where a.beforeID = b.tID and a.afterID =c.tID    
    union select 'WIC'            as tType, b.wic    as tBefore, c.wic    as tAfter from T1 as a , T2 as b,T2 as c where a.beforeID = b.tID and a.afterID =c.tID    
) 
```

它工作正常，但我想让它看起来更紧凑。有没有办法构造一个函数`foo`，这样我就可以通过做一些看起来像这样的事情来完成相同的结果

```
, T3 AS (
          foo('FSA'             ,fsacd  ,T1, T2 ) 
    union foo('Scale'           ,scd    ,T1, T2 ) 
    union foo('Retail Source'   ,rsc    ,T1, T2 ) 
    union foo('Mix Match'       ,mmcd   ,T1, T2 ) 
    union foo('Price Entry'     ,pecd   ,T1, T2 ) 
    union foo('Qntty Entry'     ,qecd   ,T1, T2 )   
    union foo('Price 3 Decs'    ,p3d    ,T1, T2 )   
    union foo('Tare Entry'      ,tecd   ,T1, T2 )   
    union foo('Undiscountable'  ,undsc  ,T1, T2 )   
    union foo('Foodstamp'       ,fds    ,T1, T2 )   
    union foo('WIC'             ,wic    ,T1, T2 )   
) 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-07-17T17:50:45.540

这是另一种选择，但不确定它是否使问题变得更糟。这增加了 with 子句中的别名数量。但是请注意，当使用 UNION 或 UNION ALL 时，您只需在第一个子查询中指定新的列名。

```
tbefore as (select *
            from T1 a join
                 T2 b
                 on a.beforeID = b.tID
             ),
 tafter as (select *
            from T1 a join
                 T2 c
                 on a.afterID = b.tID
             ),
 t3b as (select 'FSA' as tType, fsacd as tBefore from tbefore union all
         select 'Scale'as tType, scd from tbefore union all
         ...
        ),
 t3a as (select 'FSA' as tType, fsacd as tAfter from tafter union all
         select 'Scale'as tType, scd from tafter union all
         ...
        ),
 t3 as (select t3b.ttype, t3b.tbefore, t3a.tafter
        from t3b join t3a on t3b.ttype = t3a.ttype
       ) 
```

# excel - 将多个范围和工作表打印到一个 PDF 文件

> ID：11526818
> 
> 赞同：0
> 
> 时间：2012-07-17T16:26:04.070
> 
> 标签：excel, vba, excel-2010

我有一个工作表，通常需要按工作表和范围的特定顺序打印。我想做的是

1.  打印出特定的工作表和范围以生成单个 PDF 文件。
2.  将 PDF 文件作为特定日期保存到特定文件夹。

我遇到的障碍是将大量工作表和范围打印到一个 PDF 文件中，因为目前每个工作表或范围都打印到自己的单个 PDF 文件中。

我假设有一种方法可以将所有必要的工作表和范围放入数组之类的东西中，然后对该变量执行 .PrintOut ，但是我还没有让它工作。

我使用的是 Excel 2010，所以我只使用“Adobe PDF”打印机。

如何将多个范围和工作表打印到单个 .pdf？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-07-17T19:41:25.303

要打印多个工作表，您可以将工作表名称放在这样的数组中

```
Sub PrintArrayOfWorksheets()

    Dim vaWorksheets As Variant

    vaWorksheets = Array("Sheet1", "Sheet2", "Sheet3")

    ThisWorkbook.Worksheets(vaWorksheets).PrintOut

End Sub 
```

打印到 PDF 有特殊问题。如果您使用“官方”插件来创建 PDF，它可能会像上面一样工作（抱歉，我现在不能尝试）。过去，当我使用其他打印为 PDF 的打印机驱动程序时，我发现所有（或至少大部分）PageSetup 属性在工作表上必须相同，否则它将在多个作业中打印。这意味着没有收缩以适应，所有边距都必须相同。我不记得所有引起问题的属性，只是那两个肯定有，而方向肯定没有。

要限制打印范围，您需要在每张纸上设置打印区域。您可以使用 PageSetup.PrintArea 属性在代码中执行此操作。但是，如果不更改，则手动执行一次可能也不错，并且会持续存在。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2015-10-08T20:22:28.383

请参阅下面的代码。这用于使用 VBA 按钮以自定义顺序打印多张纸。它打印到单击按钮之前选择的任何打印机。

本质上，它所做的是选择您想要的工作表并在工作簿的末尾重新排列它们，然后打印它们。打印后将它们重新排序为原始顺序。

```
Option Explicit
Private Sub Print_Sheets_InOrder_Click()
    Dim ary
    Dim orig() As String
    Dim a As Variant, fp As String, i As Variant
    ary = Array("Sheet1", "Sheet4", "Sheet3")
    fp = ActiveWorkbook.Path
    ReDim orig(1 To Sheets.Count)
    For i = 1 To Sheets.Count
        orig(i) = Sheets(i).Name
    Next i
    For Each a In ary
        Sheets(a).Move after:=Sheets(Sheets.Count)
    Next a
    ThisWorkbook.Worksheets(ary).PrintOut
    For Each a In orig
        Sheets(a).Move after:=Sheets(Sheets.Count)
    Next a
End Sub 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-09-04T13:10:15.310

这是我尝试过的一种方法……我将工作表打印到 PS 文件中，然后双击 PS 文件以生成 PDF。我知道这是一种解决方法，但打印到 PS 速度很快。它要求您在 PC 上安装 Adob​​e Acrobat。

```
Dim GetPath, SavePath, ReportSuffix
GetPath = ActiveWorkbook.Path & "\"
ReportSuffix = Range("ReportName").Text & ".ps"
SavePath = GetPath & ReportSuffix

Dim PrintSheets

PrintSheets = Array("Exec1", "Intro1", "Intro2", "Intro3", "Intro4", "Intro5")

Sheets(PrintSheets).PrintOut Copies:=1, PrintTofile:=True, PrToFileName:=SavePath 
```

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2013-07-02T18:13:02.317

Excel 2010 具有打印到 pdf 的功能。如果您的每个工作表都设置为打印您想要的信息，然后突出显示要打印到一个 pdf 文件的各种工作表，然后转到“文件”和“另存为”并选择另存为类型“pdf” . 它应该打印您突出显示的工作表，因为您为每个工作表设置了打印。

# android - 逐步完成 Android 中的发布版本

> ID：11526819
> 
> 赞同：0
> 
> 时间：2012-07-17T16:26:08.520
> 
> 标签：android, debugging

是否可以在无法修改的商业 Android 设备上调试应用程序的签名版本？一个没有可调试的=“真”。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-07-17T16:47:48.510

是的，有可能。但是，应用程序必须`android:debuggable="true"`在其清单文件中有。

这是一个[类似的问题](https://stackoverflow.com/questions/9081877/how-to-debug-apk-signed-for-release)，可以为您提供更多详细信息。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-07-17T16:31:23.970

如果您可以使用调试器连接到设备，那么一旦应用程序运行，无论它是否来自已签名的 apk，您都可以尝试将调试器附加到应用程序进程。

# mongodb - 学说 odm mongo 和存储过程

> ID：11526820
> 
> 赞同：1
> 
> 时间：2012-07-17T16:26:08.967
> 
> 标签：mongodb, stored-procedures, doctrine-odm

我已经将一个 js 函数保存到集合 db.system.js 中，该集合重新调整了一个 sequenceId，我想用它来设置实体中的 id 值。

我正在尝试在 Doctrine odm for MongoDB 中使用此存储过程，如下所示：

```
$data=new Application\Entities\Data;
$data->setId("getSequence('campagne')");
$dm->persist($data); 
```

但是该函数没有被评估，并且实体 Data 中的注释 @Id 会覆盖我设置的值。

有可能在 Doctrine odm 中使用存储过程，如何使用？

提前致谢

吉塞拉

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-07-18T02:21:54.923

MongoDB 的[服务器端 JavaScript 执行](http://www.mongodb.org/display/DOCS/Server-side+Code+Execution)与存储过程不同。您只能从在服务器上执行的 JavaScript 上下文中调用它（例如 db.eval、$where、map/reduce）。

更典型的模式是使用计数器文档和原子`$inc`函数来递增和获取 ID。请参阅：[如何制作自动递增字段](http://www.mongodb.org/display/DOCS/How+to+Make+an+Auto+Incrementing+Field)。

# xml - 不能在 XMLElement 中使用 varchar2 变量？

> ID：11526824
> 
> 赞同：1
> 
> 时间：2012-07-17T16:26:27.093
> 
> 标签：xml, plsql

我需要对 Oracle 数据库中的一些数据进行一些处理，然后将其打印为 XML。我正在使用 XMLElement 及其附带的方法。但是，我发现如果我将 varchar 传递给 PL/SQL 函数，然后将该变量传递给 XMLElement，它会打印变量名称而不是其内容，如下所示：

```
create or replace function gen_elem_tmp(label1 varchar2, value1 varchar2)
  return XMLType
is
  result_xml XMLType;
begin
  select XMLElement(label1,value1) into result_xml from dual;
  return result_xml;
end;

> select gen_elem_tmp('myname','myvalue') from dual;

GEN_ELEM_TMP('MYNAME','MYVALUE')
------------------------------------------------
<LABEL1>myvalue</LABEL1> 
```

我猜这是 XMLElement 将我的变量名解释为数据库列的“有用”。有没有办法让它使用我的变量的内容呢？

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-07-17T18:06:26.620

尝试这个：

```
 select XMLElement(evalname label1,value1) into result_xml from dual; 
```

这似乎是[设计使然](http://docs.oracle.com/cd/E11882_01/server.112/e26088/functions242.htm#i1129193)。没有`EVALNAME`,`label1`用作文字而不是变量。

（在普通的 SQL 或 PL/SQL 编程中，这似乎是一个非常糟糕的想法。也许在 XML 上下文中有意义？）

# iphone - 为什么我的 iPhone 的 iCal 不显示我在本地来源中创建的日历？

> ID：11526828
> 
> 赞同：0
> 
> 时间：2012-07-17T16:26:32.437
> 
> 标签：iphone, xcode4, icalendar

这是我用来创建名为 BART 的本地日历的方法：

```
- (void)createCalendar
{
    [self setEventStore: [[EKEventStore alloc] init]];

    EKSource *local = nil;

    for (EKSource *source in eventStore.sources){
        if (source.sourceType == EKSourceTypeLocal){
            local = source;
            break;
        }
    }

    NSSet *cals = [local calendars];
    NSLog(@"%@\n",cals);

    [self setBart: [EKCalendar calendarWithEventStore: eventStore]];
    bart.source = local;
    bart.title = @"BART";
    [eventStore saveCalendar:bart commit:YES error:nil];

} 
```

当我在我的 iPhone 上测试运行该程序时，日历没有出现在我的 iCal 中，但我在 Xcode 中的输出窗口显示存在本地源并且它包含我创建的日历。如何让 iCal 显示日历？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-07-17T19:28:19.717

iOS Event Kit (Calendar API) 允许应用程序访问用户日历数据库中的事件信息。

如果你想在你的应用中显示这些事件，你必须创建你自己的 UIView。

要使用内置的“cal 应用程序”显示事件，用户必须选择自己查看他的日历。您无法从您的应用程序启动它。

看看以下内容： [iOS 日历是否支持 URL 方案？](https://stackoverflow.com/questions/4820762/does-ios-calendar-support-a-url-scheme) [是否有用于日历的 iPhone URL 快捷方式？](https://stackoverflow.com/questions/1341627/is-there-an-iphone-url-shortcut-for-calendar)

# java - CXF Rest Client - 为 POJO (JAXBElement) 设置 ResponseReader

> ID：11526833
> 
> 赞同：0
> 
> 时间：2012-07-17T16:26:51.100
> 
> 标签：java, rest, serialization, jaxb, cxf

我想用我的 CXF Rest Client 传输 POJO 对象。它已经适用于 JAXB 注释对象。所以我做了很多尝试。

我试过了

```
 reader.setEntityClass(ObjectPOJO.class); 
```

和类似的东西

```
 reader.setEntityClass(JAXBElement<ObjectPOJO>.class); 
```

两者都不起作用。对于第二次尝试，代码是错误的。我没有得到它来将实体类设置为 jaxbelement。也许它适用于它。

发送对象后：

```
 Response response = client.path(PATH).post(new JAXBElement<ObjectPOJO>(new QName("pojo"), ObjectPOJO.class, pojoObject)); 
```

我试图通过不同的尝试来获得我的实体。就像是：

```
 ObjectPOJO pojo = ((JAXBElement<TenantPOJO>) res.getEntity()).getValue(); 
```

1.  有人知道我是否必须注册 ObjectPOJO.class 或 JAXBElement.class。如果第二次尝试是正确的，它在代码中的外观如何？
2.  什么是让实体脱离响应的正确代码？

我的服务如下所示：

```
 @POST
@Consumes({MediaType.APPLICATION_XML, MediaType.APPLICATION_JSON})
public Response postPojo(JAXBElement<ObjectPOJO> pojo); 
```

编辑：

错误

```
 ERROR org.apache.cxf.jaxrs.client.AbstractClient - .Problem with reading the response message, class : class javax.ws.rs.core.Response, ContentType : application/xml. 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-07-17T16:45:12.800

要在 rest 客户端和 rest 服务之间传输对象 (PoJos)，不需要使用显式 JAXB 转换来传输它。如果传输对象是 JAXB 注释对象，则 Jersey 容器负责必要的转换。

```
Response response = client.path(PATH).post(postObject);
@XmlRootElement
public class PostObject
{
////
} 
```

# sharepoint-2010 - 在sharepoint 2010中查找图片库的图片名称

> ID：11526841
> 
> 赞同：0
> 
> 时间：2012-07-17T16:27:19.703
> 
> 标签：sharepoint-2010, image, lookupfield

我有一个图片库，我想在另一个通用列表中查找图片的名称。我试过了：

```
lookupField.LookupField = "Name"; 
```

然后，当我创建此通用列表的新项目时，图片查找列正确显示图片的列表名称，但在保存项目后，此列变为空白。我在这里做错什么了吗？我必须使用其他内部字段名称而不是“名称”吗？请帮忙...

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-07-18T04:35:43.887

好的，我找到了另一个解决方案。因为我无法查找图片库的默认名称，所以我为图片库创建了一个隐藏文本字段。这个隐藏字段将在 ItemUpdated 事件中获取名称值（不需要 ItemAdded，因为当我上传新图片时，它也称为 ItemUpdated <--不知道为什么......）

```
public override void ItemUpdated(SPItemEventProperties properties) {
    properties.ListItem["HiddenImageName"] = properties.ListItem["Name"].ToString();
    properties.ListItem.Update();
} 
```

通用列表将查找此隐藏字段而不是图片库的默认名称字段

# matlab - MATLAB 中的图像翻译

> ID：11526842
> 
> 赞同：1
> 
> 时间：2012-07-17T16:27:23.463
> 
> 标签：matlab, image-processing

在[MATLAB](http://en.wikipedia.org/wiki/MATLAB) (R2010a) 中注册两个图像（Image1 和 Image2）后，我似乎无法弄清楚如何正确翻译。该算法已经过测试并可以与其他程序一起使用。以下是一些相关的片段。

```
TForm = maketform('affine', Transform);

info = imfinfo('Image1.bmp');

Reg = imtransform(Image1, TForm,...
           'XData', [1 (size(Image1,2)+Transform(3,1))],...
           'YData', [1 (size(Image1,1)+Transform(3,2))],...
           'FillValues', 255);

figure('Name', 'Reg'),...
imshow(Reg, 'InitialMagnification', 250);

imwrite(Reg, 'Reg.bmp', 'bmp');

hold on

H = imshow(Image2, gray(256));
set(H, 'AlphaData', 0.6) 
```

当我将 Image1 注册到 Image1 时，不会发生这种情况，只有当我尝试将 Image1 注册到 Image2 时（或相反）。我用 C 编写的相同代码似乎工作正常。我相信这与我的`imtransform`功能有关。

好吧，我相信它必须与应用转换的方式有关。我用 Image1 直接注册到 Image1 （绕[质心](http://en.wikipedia.org/wiki/Center_of_mass)旋转 15 度），它没有做正确的转换。转换输出为：

```
Transform =

0.9676   -0.2557         0
0.2596    0.9694         0
32.7217  -25.5110    1.0000 
```

如果我将它输入到图像注册程序中，它就可以正常工作。这是我刚刚做的示例图像，

![奇怪的MATLAB注册示例](../Images/5769fe8e9bcdf6cd74f09a6b08ef973b.png)

A = 原始图像，B = 旋转的原始图像，C = 变换的原始图像。

再次转换是正确的（使用 FMRIB's-FLIRT 注册软件测试）。MATLAB 在将其应用于图像时必须做一些不同的事情。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-07-20T19:00:25.257

旋转矩阵的符号相反。

# linux - 在第三个字段中打印一个数字重复 n 次的行

> ID：11526846
> 
> 赞同：1
> 
> 时间：2012-07-17T16:27:32.113
> 
> 标签：linux, shell, unix

我有一个包含内容的文件：

```
20120619112139,3,22222288100597,01,503352786544597,,W,ROAMER,,,,0,mme2
20120703112557,3,00000000000000,,503352786544021,,B,,8,2505,,U,
20120611171517,3,22222288100620,,503352786544620,11917676228846,B,ROAMER,8,2505,,U,
20120703112557,3,00000000000000,,503352786544021,,B,,8,2505,,U,
20120703112557,3,00000000000000,,503352786544021,,B,,8,2505,,U,
20120611171003,3,22222288100618,02,503352786544618,,W,ROAMER,8,2505,,0,
20120611171046,3,00000000000000,02,503352786544618,11917676228846,W,ROAMER,8,2505,,0,
20120611171101,3,22222288100618,02,503352786544618,11917676228846,W,ROAMER,8,2505,,0,
20120611171101,3,22222222222222,02,503352786544618,11917676228846,W,ROAMER,8,2505,,0, 
```

我需要检查任何行的第三个字段是否有一个数字重复 14 次，例如：00000000000000 并将这些行打印到另一个文件

我试过这段代码：

```
 awk '$3 ~ /[0-9]{14}/' myfile > output.txt 
```

但这也会打印具有“22222288100618”等值的行。

我也试过：

```
for i in `cat myfile`
do 
if [ `echo $i | cut -d"," -f 3 | egrep "^[0-9]{14}$"` ];
then echo $i >> output.txt;
fi
done 
```

这也无济于事。这也会打印所有行。

但我只需要输出文件中的这些行。

```
20120703112557,3,00000000000000,,503352786544021,,B,,8,2505,,U,
20120703112557,3,00000000000000,,503352786544021,,B,,8,2505,,U,
20120703112557,3,00000000000000,,503352786544021,,B,,8,2505,,U,
20120611171046,3,00000000000000,02,503352786544618,11917676228846,W,ROAMER,8,2505,,0,
20120611171101,3,22222222222222,02,503352786544618,11917676228846,W,ROAMER,8,2505,,0, 
```

提前感谢您的任何即时帮助

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-07-17T16:43:30.507

不知道这是否可以用 awk 完成，但这应该可以：

```
perl -aF, -nle '$F[2]=~/(\d)\1{13}/&& print' 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-07-17T16:47:15.220

您可以使用类似的表达式`0{14}|1{14}...`。尝试这个：

```
$ for i in 0 1 2 3 4 5 6 7 8 9; do re=$re${re:+|}$i{14}; done
$ awk -F, --posix \$3~/$re/ myfile 
```

（`gawk`需要 --posix 来识别区间表达式`{14}`。这可能不是所有都需要的`awk`。）

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-07-18T08:46:17.503

使用**grep**：

```
grep -E "[0-9]+,[0-9]+,([0-9])\1{13}" myfile 
```

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2012-07-18T10:25:13.380

sed -n '/^[^,]+,[^,]+,([0-9])\1{13}/p' 输入文件

# mysql - Left Join with Where 子句返回空结果

> ID：11526849
> 
> 赞同：4
> 
> 时间：2012-07-17T16:27:45.257
> 
> 标签：mysql, sql, doctrine-orm, dql

我有一张`post`桌子，它的架构是这样的：

```
CREATE TABLE IF NOT EXISTS `post` (
  `id` bigint(20) NOT NULL AUTO_INCREMENT,
  `user_id` bigint(20) DEFAULT NULL,
  `site_id` bigint(20) DEFAULT NULL,
  `parent_id` bigint(20) DEFAULT NULL,
  `title` longtext COLLATE utf8_turkish_ci NOT NULL,
  `status` varchar(20) COLLATE utf8_turkish_ci NOT NULL,
  PRIMARY KEY (`id`),
  KEY `IDX_5A8A6C8DA76ED395` (`user_id`),
  KEY `IDX_5A8A6C8DF6BD1646` (`site_id`),
  KEY `IDX_5A8A6C8D727ACA70` (`parent_id`),
) ENGINE=InnoDB  DEFAULT CHARSET=utf8 COLLATE=utf8_turkish_ci AUTO_INCREMENT=16620 ; 
```

我正在使用这个 DQL 来获取一个帖子，它是孩子：

```
$post = $this->_diContainer->wordy_app_doctrine->fetch(
           "SELECT p,c FROM Wordy\Entity\Post p LEFT JOIN p.children c WHERE p.site = :site AND p.id = :id AND p.language = :language AND p.status != 'trashed'  AND c.status != 'trashed' ORDER BY c.title",
           array(
               'params' => array(
               'id' => $id,
               'site' => $this->_currentSite['id'],
               'language' => $this->_currentLanguage->code,
           )
       )
   ); 
```

我想做的是：获取一个帖子和所有的孩子。标准是，不包括已删除的帖子或已删除的孩子。

但是当我用一个甚至没有孩子的帖子运行这个查询时，返回的结果集是空的。

当我`c.status != 'trashed'`从查询中删除部分时，一切正常，但我也会收到垃圾帖子。

提前致谢。

编辑：这是给定 DQL 的 SQL 输出：

```
SELECT p0_.id AS id0, p0_.title AS title5, p0_.status AS status8, p0_.parent_id AS parent_id9, p1_.id AS id15, p1_.title AS title20, p1_.status AS status23, p1_.parent_id AS parent_id24 FROM post p0_ LEFT JOIN post p1_ ON p0_.id = p1_.parent_id WHERE p0_.site_id = ? AND p0_.id = ? AND p0_.language = ? AND p0_.status <> 'trashed' ORDER BY p1_.title ASC 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-07-17T16:33:14.263

加入后，您的长条件 WHERE 将被“与”在一起，并且没有通过所有检查。将连接内容移到 ON 子句中，并将 c.trashed 检查留在 WHERE 子句中。尝试这样的事情：

```
SELECT p,c FROM Wordy\Entity\Post p LEFT JOIN children c ON p.site = :site AND p.id = :id AND p.language = :language AND p.status != 'trashed' AND p.id = c.parent_id  WHERE   c.status != 'trashed' ORDER BY c.title 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-07-17T16:34:53.767

您忘记了[左连接语法](http://dev.mysql.com/doc/refman/5.0/en/join.html)`ON`的子句。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-07-17T16:46:29.600

我想我解决了我自己的问题。

只需`with`在字段上使用子句`join`而不是`where`子句，如下所示：

```
"SELECT p,c FROM Wordy\Entity\Post p LEFT JOIN p.children c WITH c.status != 'trashed' WHERE p.site = :site........." 
```

# php - INSERT FROM 2 个表复制表 1 中 1 列的所有行，仅复制表 3 中 1 列的最后一行

> ID：11526851
> 
> 赞同：1
> 
> 时间：2012-07-17T16:27:54.930
> 
> 标签：php, mysql, insert

正如标题所说，我想插入表 3（list_mail_usr）中表 1 （temp_urs）列中的所有行，以及表 2 中 1 列的最后一行，你可以看到，列 1 中的所有行具有相同的 ID，即 list_mail_nom 表的 list_id 列的最后一行。

```
$tmp_usr = "INSERT INTO list_mail_usr (id_usuario,list_id)
SELECT temp_urs.id_usuario
JOIN list_mail_nom.list_id
WHERE MAX(ID) FROM list_mail_nom.list_id
"; 
```

这就是我到目前为止所拥有的。它显然不起作用；（有什么建议吗？

这几乎可以工作，但从 temp_usr 插入每一行 65 次

```
$tmp_usr = "INSERT INTO list_mail_usr (id_usuario,list_id)
            SELECT temp_usr.id_usuario,list_mail_nom.list_id
            FROM temp_usr,list_mail_nom";
$insert = $asies -> query($tmp_usr) or die (mysqli_error($asies)); 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-07-17T18:42:26.947

您没有正确使用聚合函数。要做你想做的事，你需要 GROUP BY 并使用 HAVING。一个更简单的查询将是这样的：

```
INSERT INTO new_table (new_a, new_b)
SELECT x.col, y.col
FROM x, y
WHERE y.id = (SELECT MAX(id) FROM y) 
```

对于大表，MySQL 优化子查询的困难会变得很明显。如果您可以单独找到最大 ID 并将其作为常数传递，则针对大型表的性能会好得多（x 比 y 大，因为假设您的 ID 上有一个索引）。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-07-17T16:41:49.057

您需要告诉 MySQL VALUES 来自您的子查询：

```
$tmp_usr = "INSERT INTO list_mail_usr (id_usuario,list_id)
VALUES(
SELECT temp_urs.id_usuario, some_other_field_name
JOIN list_mail_nom.list_id
WHERE MAX(ID) FROM list_mail_nom.list_id)
"; 
```

此外，您的选择应该输出与您输入到 list_mail_usr 中相同数量的字段。我在上面的查询中表示了另一个字段名称`some_other_field_name`

# sql - 存储过程的 WHERE 子句中 DATEADD 的神秘行为

> ID：11526852
> 
> 赞同：1
> 
> 时间：2012-07-17T16:27:56.380
> 
> 标签：sql, performance, datetime, stored-procedures, sql-server-2000

这是我遇到的问题。我正在查询的表有 1.7 亿行。我编写了一个存储过程来对表中的最新条目进行简单查询。当我`WHERE`用这样的硬编码字符串编写子句时：

```
SELECT top 500 a.field1 , a.field2, a.field3
FROM database..hugeTable a( nolock )
WHERE a.StartTime > '2012-07-17 10:10:35.477' 
```

它非常快。不到一秒。`StartTime`位于非聚集索引中。

但是，我真正想要的是：

```
DECLARE @fifteenMinutesAgo datetime;
SET @fifteenMinutesAgo = DATEADD(n , -15 , GETDATE());

SELECT top 500 a.field1 , a.field2, a.field3
FROM database..hugeTable a( nolock )
WHERE a.StartTime > @fifteenMinutesAgo 
```

问题是当我运行第二个查询时，几乎需要 3 分钟！

于是我开始胡闹，疯狂地寻找。我认为这可能是一个数据类型问题，所以我尝试了各种 CAST 和 CONVERT，但没有成功。我尝试使用`OPTIMIZE FOR`但意识到它不适用于此版本的 SQL。我检查了数据类型`StartTime`；它是类型`datetime`。

我尝试的另一件事很奇怪，是这样的：

```
DECLARE @fifteenDaysAgo datetime;
SET @fifteenDaysAgo = DATEADD(d , -15 , GETDATE());

SELECT top 500 a.field1 , a.field2, a.field3
FROM database..hugeTable a( nolock )
WHERE a.StartTime > @fifteenDaysAgo 
```

我将它从搜索最后 15 分钟更改为最后 15 天。神奇的是，它又超快了！不到一秒。

这让我相信 SQL 很难比较时间？它不需要查看 的`TIME`部分`datetime`来查看它是否适合比较语句？我不知道。在这里，我抓住了稻草。

所以我的问题是，我怎样才能使这个速度相当快并且仍然保持我的`@fifteenMinutesAgo`活力？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-07-17T16:44:58.043

看起来您的程序存在“[参数嗅探](http://www.simple-talk.com/sql/t-sql-programming/parameter-sniffing/)”问题。`WITH RECOMPILE`选项应该有帮助

# c# - 写入文件需要针对大流量进行优化第 3 部分

> ID：11526856
> 
> 赞同：1
> 
> 时间：2012-07-17T16:28:09.487
> 
> 标签：c#, multithreading, performance, io

这个问题是前2部分的延续，任何有兴趣了解我来自哪里的人可以参考第1部分和第2部分，但这不是必需的。

[写入文件需要针对大流量进行优化](https://stackoverflow.com/questions/10828372/write-file-need-to-optimised-for-heavy-traffic)

[写入文件需要针对大流量进行优化第 2 部分](https://stackoverflow.com/questions/10884106/write-file-need-to-optimised-for-heavy-traffic-part-2)

现在我有一个工作片段，相关部分如下：

```
 public static class memoryStreamClass
    {
        static MemoryStream ms1 = new MemoryStream();

        public static void fillBuffer(string outputString)
        {
            byte[] outputByte = Encoding.ASCII.GetBytes(outputString);

            ms1.Write(outputByte, 0, outputByte.Length);

            if (ms1.Length > 8100)
            {
                emptyBuffer(ms1);
                ms1.SetLength(0);
                ms1.Position = 0;
            }
        }

        static void emptyBuffer(MemoryStream ms)
        {
            FileStream outStream = new FileStream("c:\\output.txt", FileMode.Append);

            ms.WriteTo(outStream);
            outStream.Flush();
            outStream.Close();
        } 
```

上面的代码片段工作正常，并且没有错误。它每次写入输出大约 8KB 的数据。

现在我尝试对上述代码进行多线程处理，以提高 IO 写入瓶颈的性能，并出现了问题。下面的片段是我试图尝试的。

基本上我有 2 个相同的 memoryStream，如果说 ms1 已满，它将 ms1 写入文件并在 ms1 写入时切换到 ms2，反之亦然。

```
 public static class memoryStreamClass
    {
        static MemoryStream ms1 = new MemoryStream();
        static MemoryStream ms2 = new MemoryStream();
        static int c = 1;

        public static void fillBuffer(string outputString)
        {
            byte[] outputByte = Encoding.ASCII.GetBytes(outputString);

            if (c == 1)
            {
                ms1.Write(outputByte, 0, outputByte.Length);

                if (ms1.Length > 8100)
                {
                    c = 2;

                    Thread thread1 = new Thread( () => emptyBuffer(ms1));
                    thread1.Start();

                    ms1.SetLength(0);
                    ms1.Position = 0;
                }
            }
            else
            {
                ms2.Write(outputByte, 0, outputByte.Length);

                if (ms2.Length > 8100)
                {
                    c = 1;

                    Thread thread2 = new Thread(() => emptyBuffer(ms2));
                    thread2.Start();

                    ms2.SetLength(0);
                    ms2.Position = 0;

                }
            }
        } 
```

上面的代码可以编译运行，但是输出写入并不总是8KB，而且写入的频率太高了（比我的单线程程序）。有人可以启发我并指出我的程序有什么问题吗？非常感谢你

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-07-17T16:58:42.310

您的代码严重损坏，您使用两个缓冲区来提高性能的想法几乎可以肯定是过度优化。但是，这段代码有一个明显的问题：

```
Thread thread1 = new Thread( () => emptyBuffer(ms1));
thread1.Start();

ms1.SetLength(0);
ms1.Position = 0; 
```

这段代码的作用是：

*   启动一个线程来处理一个缓冲区
*   立即清除该缓冲区

问题是您的“清晰”代码*几乎肯定会*在您的线程有机会启动之前执行（因为一般来说，执行方法将在线程上下文更改之前完成）。所以，当你打电话的时候`emptyBuffer`，你`MemoryStream`的已经是空的了。

你的静态是个坏主意；如果您要将非静态实例传递给该`emptyBuffer`方法，然后 set `ms1 = new MemoryStream()`，您可能会有*更好*的功能代码。但最终，此代码在概念上存在缺陷，您应该考虑重新设计。

# ruby-on-rails - HomeController 中的 SystemStackError #index

> ID：11526859
> 
> 赞同：0
> 
> 时间：2012-07-17T16:28:14.570
> 
> 标签：ruby-on-rails

你可以在这里看到错误： [http ://www.petralian.com/ffcrm/](http://www.petralian.com/ffcrm/)

我尝试安装 fatfree crm，这是它抛出的错误。我找不到任何解决方案。

```
SystemStackError in HomeController#index

stack level too deep

Rails.root: /webapps/ffcrm
Application Trace | Framework Trace | Full Trace

activesupport (3.2.6) lib/active_support/callbacks.rb:409 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-07-31T15:49:54.777

实际上，我最终删除了 Ruby 1.9.3，将我的服务器从 CentOS 5.8 升级到 6.3，并从 rvm 重新安装了 Ruby 1.9.2。现在它起作用了！

# ios - dispatch_async 和 [NSURLConnection sendSynchronousRequest]

> ID：11526862
> 
> 赞同：6
> 
> 时间：2012-07-17T16:28:24.063
> 
> 标签：ios, nsurlconnection, grand-central-dispatch

关于这个主题有很多问题，很多建议说不要在 dispatch_async 中使用 sendSynchronousRequest，因为它会阻塞线程，并且 GCD 将产生许多新的工作线程来服务所有同步 URL 请求。

似乎没有人对 iOS 5 [NSURLConnection sendAsynchronousRequest:queue:completionHandler:] 在幕后所做的事情有明确的答案。

我读过的一篇文章指出它“可能”进行了优化，并且“可能”使用了运行循环——但肯定不会为每个请求创建一个新线程。

当我在使用 sendAsynchronousRequest:queue:completionHandler 时暂停调试器时，堆栈跟踪如下所示：

![截屏](../Images/9f05b3a0085bfcccbbee789c2300181e.png)

..现在看来 sendAsynchronousRequest:queue:completionHandler 实际上正在调用 sendSynchronousRequest，当我使用异步方法而不是同步方法时，我仍然创建了大量线程。

是的，使用异步调用还有其他好处，我不想在这篇文章中讨论。

我感兴趣的是性能/线程/系统使用，如果我更糟的是使用 dispatch_async 内部的同步调用而不是使用异步调用。

我也不需要关于使用 ios4 异步调用的建议，这纯粹是出于教育目的。

有没有人对此有任何有见地的答案？

谢谢

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-09-26T02:32:04.297

正如前面的答案所述，GCD (libdispatch) 和 libblocksruntime 都是[开源](http://mark.heily.com/project/libblocksruntime)的。在内部，iOS/OS X 管理一个全局 pthread 池，以及您在用户代码中创建的任何特定于应用程序的池。由于 OS 线程和调度任务之间存在 1:N 映射，因此您不必（也不应该）担心线程的创建和处理。为此，GCD 任务在调用后不会在应用程序的运行循环中使用任何时间，因为它被踢到后台线程。

大多数类型的 NSURL 操作都是 I/O 绑定的；没有多少并发巫术可以掩盖这一点，但如果 Apple 自己的异步实现在后台使用其同步对应物，它可能表明它已经高度优化。与前面的答案相反，libdispatch*确实*在内部使用了可扩展的 I/O（`kqueue`在 OS X/iOS/BSD 上），如果您自己手动滚动某些东西，则必须自己处理文件描述符准备情况以产生类似的性能.

虽然可能，但投入时间的回报可能是微不足道的。坚持 Apple 的实现，不再担心线程！

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-07-23T18:56:36.303

这实际上是开源的。[http://libdispatch.macosforge.org/](http://libdispatch.macosforge.org/)

您不太可能比 Apple 的实现更有效地管理工作线程。在这种情况下，“异步”并不意味着选择/轮询，它只是意味着调用将立即返回。因此，实现产生线程也就不足为奇了。

# php - Zend 文件路径验证

> ID：11526864
> 
> 赞同：0
> 
> 时间：2012-07-17T16:28:34.267
> 
> 标签：php, zend-framework, zend-form

在 zend 框架应用程序中，我想验证图像文件的路径。该文件可能是先前上传的文件，位于服务器机器内的文件夹中或通过 url 访问。我想检查天气文件路径是否有效。我不想使用 zend 文件元素并上传文件。我搜索了很多次，都没有成功。谁能告诉我该怎么做？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-07-17T16:41:07.653

您可能正在寻找 PHP [file_exists](http://www.php.net/file_exists)函数。

> 如果 filename 指定的文件或目录存在，则返回 TRUE；否则为假。

您可能可以围绕它构建一个验证器，或者直接使用该函数。

对于远程服务器上的文件，您可能需要使用类似[file_get_contents](http://www.php.net/file_get_contents)的东西，如果文件不存在，它也会返回 false。

# php - PHP 两次获取数据

> ID：11526867
> 
> 赞同：3
> 
> 时间：2012-07-17T16:28:41.007
> 
> 标签：php, mysql, mysqli, prepared-statement, fetch

我的功能看起来像这样。

```
 private function generateTree($courseID) {
        $q = "SELECT l.id, l.name AS lesson_name, c.name AS course_name FROM lessons AS l, courses AS c WHERE l.course_id=c.id AND c.id=?";
        $stmt = $this->db->prepare($q);
        $stmt->bind_param("i", $courseID);
        $stmt->execute();
        $stmt->store_result();
        if ($stmt->num_rows > 0) {
            $stmt->bind_result($id, $lName, $cName);
            echo "<li> <a href='#'>$cName</a> <ul>";
            while ($stmt->fetch()) <====HERE!!!
                echo "<li> <a href='?course=$courseID&lesson=$id'> $lName </a></li>";
            echo "</ul> </li>";
        }
    } 
```

问题是我开始在一段时间内获取数据，但在一段时间之前我也需要它。我可以获取两次数据吗？还有其他建议吗？

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2016-11-26T23:38:07.367

已经四年了，但如果有人像我一样偶然发现这个问题：

```
while ($stmt->fetch()) {
  // do your thing
}

$stmt->data_seek(0);

while ($stmt->fetch()) {
  // do something other
} 
```

您可以[在此处阅读文档](http://php.net/manual/en/mysqli-result.data-seek.php)

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2012-07-17T16:31:40.460

您可以使用[fetchAll()](http://us3.php.net/manual/en/pdostatement.fetchall.php)获取所有数据并根据需要对其进行多次迭代。

```
$result = $stmt->fetchAll(); // PDO
$result = $stmt->fetch_all(); // MySQLi

foreach($result as $row) { print $row['lesson_name']; }
foreach($result as $row) { print $row['lesson_name']; }
foreach($result as $row) { print $row['lesson_name']; }
etc... 
```

更新：我不完全确定您在做什么，因为您的代码中似乎有几个想法。也许你想要这样的东西？

```
$q = "SELECT l.id, l.name AS lesson_name, c.name AS course_name FROM lessons AS l, courses AS c WHERE l.course_id=c.id AND c.id=?";
$stmt = $this->db->prepare($q);
$stmt->bind_param("i", $courseID);
$stmt->execute();

if ($stmt->num_rows > 0)
{
    $results = $stmt->fetch_all();

    foreach($results as $row)
    {
        print_r($row);
    }
} 
```

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2012-07-17T16:33:02.897

我认为你可以让你的数据库查询类返回一个数据库结果数组。您可以根据需要多次使用数据。

您可以像这样创建一个数据库结果集的数组：

```
while($row = mysql_fetch_assoc($result))
{
   $results[] = $row;
} 
```

# ios - 强制 genstrings 按出现顺序而不是按字母顺序构建 Localizable.strings 文件

> ID：11526868
> 
> 赞同：8
> 
> 时间：2012-07-17T16:28:59.380
> 
> 标签：ios, cocoa-touch, localization, nslocalizedstring, genstrings

我是 iOS 国际化和本地化的新手。我正在运行 genstrings: `find . -name \*.m | xargs genstrings -o en.lproj`来生成我的 Localizable.strings 文件。它按字母顺序（按键）构建文件。

为了便于翻译，我希望键和值按照它们在 .m 文件中的出现顺序进行排序。这可能与 genstrings 吗？`man`我在其页面上找不到相关信息。

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-07-23T16:12:23.870

您可以执行以下操作：

```
find . -name '*.m' -print | xargs -n1 genstrings -a 
```

我敢肯定还有更优雅的方式。也许只是使用`ls *.m`而不是查找。字符串由带有开关的文件保存在一起，`-a`但它们仍然在每个文件中排序。

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2012-07-23T05:23:18.017

除了手册中指定的参数允许的行为外，无法更改 genstrings 的行为：

[https://developer.apple.com/library/mac/#documentation/Darwin/Reference/Manpages/man1/genstrings.1.html](https://developer.apple.com/library/mac/#documentation/Darwin/Reference/Manpages/man1/genstrings.1.html)

但是如果你想简化翻译你可以使用Linguan

[http://www.cocoanetics.com/apps/linguan/](http://www.cocoanetics.com/apps/linguan/)

如果你想坚持使用 genstrings 并且遇到了一些问题，你可以试试这个页面，它提供了一个很好的解释：

[http://spritebandits.wordpress.com/2012/01/25/ios-iphone-app-localization-genstrings-tips/](http://spritebandits.wordpress.com/2012/01/25/ios-iphone-app-localization-genstrings-tips/)

但是，是的，回到主要问题，据我所知，这是不可能的。

# java - 字段上的 @JsonProperty 注释以及 getter/setter

> ID：11526874
> 
> 赞同：56
> 
> 时间：2012-07-17T16:29:37.773
> 
> 标签：java, json, serialization, jackson

我继承了某个位代码，该代码在 getter/setter 上有 @JsonProperty 注释。目的是当使用 Jackson 库序列化对象时，字段具有该特定名称。

当前代码：

```
private String fileName;

@JsonProperty("FILENAME")
public String getFileName()
{
    return fileName;
}

@JsonProperty("FILENAME")
public void setFileName(String fileName)
{
    this.fileName = fileName;
} 
```

现在对于另一个工具，我还需要使用 JsonProperty 注释该字段。所以这将是我更改的代码：

```
@JsonProperty("FILENAME")
private String fileName;

@JsonProperty("FILENAME")
public String getFileName()
{
    return fileName;
}

@JsonProperty("FILENAME")
public void setFileName(String fileName)
{
    this.fileName = fileName;
} 
```

有没有人在字段和 getter/setter 上都使用过相同的注释？我在网上四处张望，但什么也没看到。

我已经编译并运行了代码，但我不确定这是否会导致任何问题。对此有什么想法吗？

* * *

## 回答 #1

> 赞同：54
> 
> 时间：2012-07-17T18:45:37.297

我基于一些测试的观察结果是，与属性名称不同的名称都是生效的名称：

例如。考虑对您的情况稍作修改：

```
@JsonProperty("fileName")
private String fileName;

@JsonProperty("fileName")
public String getFileName()
{
    return fileName;
}

@JsonProperty("fileName1")
public void setFileName(String fileName)
{
    this.fileName = fileName;
} 
```

`fileName`field 和 method都`getFileName`具有正确的属性名称`fileName`和`setFileName`不同的属性名称`fileName1`，在这种情况下，Jackson 将在反序列化`fileName1`时在 json 中查找属性，并在序列化时创建一个名为的属性`fileName1`。

现在，针对您的情况，所有三个 @JsonProperty 都与默认属性名不同`fileName`，它只会选择其中一个作为属性（`FILENAME`），并且三个中的任何一个不同，它都会引发异常：

```
java.lang.IllegalStateException: Conflicting property name definitions 
```

* * *

## 回答 #2

> 赞同：11
> 
> 时间：2012-07-18T19:02:25.987

除了现有的好答案，请注意杰克逊 1.9 通过添加“属性统一”改进了处理，这意味着来自逻辑属性不同部分的所有注释都使用（希望）直观的优先级进行组合。

在 Jackson 1.8 和之前的版本中，在确定序列化的内容和方式（编写 JSON）时，只使用了字段和 getter 注释；并且只有和 setter 注释用于反序列化（读取 JSON）。这有时需要添加“额外”注释，例如同时注释 getter 和 setter。

对于 Jackson 1.9 及更高版本，不需要这些额外的注释。仍然可以添加这些；如果使用不同的名称，可以创建“拆分”属性（使用一个名称进行序列化，使用另一个名称进行反序列化）：这有时对某种重命名很有用。

# c++ - 停止 Qt QGraphicsView 在重新调整大小时滚动

> ID：11526876
> 
> 赞同：1
> 
> 时间：2012-07-17T16:29:44.890
> 
> 标签：c++, qt, user-interface, horizontal-scrolling, qgraphicsview

我有两个宽度相等的 QGraphicsView，一个在垂直布局中位于另一个之上。

当我重新调整我的应用程序窗口的大小时，底部的 QGraphicsView 符合我的预期，它保持在它开始的确切位置，但是顶视图开始将场景移动到低于 x=0(本质上是视图左边缘的空白填充），这是我不想要的，我需要两者的行为相同，因为它们彼此对应。

我一定错过了什么，因为这些视图的行为应该完全相同吗？我需要它们对齐，因为顶视图隐藏了滚动条并且水平滚动了多少底视图滚动。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-07-17T18:07:57.377

确保您的[resizeAnchor](http://qt-project.org/doc/qt-4.8/qgraphicsview.html#resizeAnchor-prop)设置为`NoAnchor`并且[对齐方式](http://qt-project.org/doc/qt-4.8/qgraphicsview.html#alignment-prop)为`Qt::AlignLeft | Qt::AlignTop`. 您可能需要尝试其他一些组合来适应您的情况。

# html - 内联样式导致错误

> ID：11526877
> 
> 赞同：2
> 
> 时间：2012-07-17T16:29:47.153
> 
> 标签：html, css

为什么这种内联样式会导致错误？我使用 intelij 作为我的 IDA，它说的值无效`style="background-image:url(../images/email-bg.jpg);"`

```
<table border="0" cellpadding="0" cellspacing="0" height="489" width="639" align="left" style="background-image:url(../images/email-bg.jpg);"> 
```

我使用内联样式的原因是因为我正在做一个 HTML 电子邮件。

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2012-07-17T16:44:37.403

当您将这封电子邮件发送给人们时，会`../images/email-bg.jpg`指向哪里？

您需要使用绝对路径。无论`http://yoursite.com/images/email-bg.jpg`您从哪里看，它都会指向您的图像。

# javascript - 显示 Jasmine 运行的测试/期望总数

> ID：11526880
> 
> 赞同：5
> 
> 时间：2012-07-17T16:30:43.530
> 
> 标签：javascript, unit-testing, jasmine

我正在将大量 QUnit 测试转换为 Jasmine。在 QUnit 中，我习惯于查看所有测试模块的测试总数，显示在顶部。例如：

> 测试在 157 毫秒内完成。
> 
> 528 次测试中的 528 次通过，0 次失败。

我认为测试的数量是重要的信息。但是，Jasmine 的示例测试运行程序不显示测试总数。相反，你会得到类似的东西：

> 通过 106 个规格

这些规范中的每一个都可能包含任意数量的单独测试。是否可以确定已运行的测试总数，以便我可以在我的测试运行器中显示它？我在网上和 Jasmine 文档中查找了信息，但到目前为止还没有找到任何信息。

* * *

## 解决方案

根据@ggozad 的回复，我提出了以下解决方案，该解决方案会打印到控制台。欢迎提出有关如何改进它或如何将结果干净地添加到 Jasmine 的 HTML 输出的建议。

```
var jasmineEnv = jasmine.getEnv();
var htmlReporter = new jasmine.HtmlReporter();
var reportRunnerResults = htmlReporter.reportRunnerResults;

htmlReporter.reportRunnerResults = function(runner) {
    reportRunnerResults(runner);

    var specs = runner.specs();
    var specResults;
    var assertionCount = {total: 0, passed: 0, failed: 0};

    for (var i = 0; i < specs.length; ++i) {
        if (this.specFilter(specs[i])) {
            specResults = specs[i].results();
            assertionCount.total += specResults.totalCount;
            assertionCount.passed += specResults.passedCount;
            assertionCount.failed += specResults.failedCount;
        }
    }

    if (console && console.log) {
        console.log('Total: ' + assertionCount.total);
        console.log('Passed: ' + assertionCount.passed);
        console.log('Failed: ' + assertionCount.failed);
    }
};

jasmineEnv.addReporter(htmlReporter);
jasmineEnv.specFilter = function(spec) {
    return htmlReporter.specFilter(spec);
};

window.onload = function() {
    jasmineEnv.execute();
}; 
```

控制台输出示例：

```
Total: 67
Passed: 67
Failed: 0 
```

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-07-17T18:38:21.913

*规范*是Jasmine 中的*测试*。在其中，您可以有类似于 其他测试框架中的*断言的**期望。*因此，您看到报告的规格数量是每个调用的总数：*`it`*

 *```
it('passes some expectations', function () {
  ...
}); 
```

通常，您会将几个类似单元的测试组合在一个`it`.

现在，如果您*坚持*想了解规范中失败/成功的期望，您总是可以从您的记者那里获得这些信息。例如，如果您设置一个 实例`htmlReporter`，您可以这样做：

```
htmlReporter.reportRunnerResults = function (runner) {
...
}; 
```

在你的函数中，你可以检查各种各样的东西，这里有一些提示：

*   `runner.specs()`为您提供所有规格
*   对于其中的每一个`spec`，`results = spec.results()`都会为您提供有关您的期望的信息。
*   `results.totalCount`, `results.failedCount`,`results.passedCount`是你正在寻找的;)

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-09-16T17:07:47.817

非常有用的信息。您可能希望将其附加到页面而不是将其写入控制台。您可以将控制台脚本替换为...

```
var d1 = document.createElement("span");
$(d1).css('font-size', '10pt');
$(d1).html(' (Total Expectations: ' + assertionCount.total);
$(d1).append(', Total Expectations Passed: ' + assertionCount.passed);
$(d1).append(', Total Expectations Failed: ' + assertionCount.failed);
$(d1).append(')');
$(".passingAlert").append(d1);
$(".resultsMenu").append(d1); 
```*

# macos - 插入 OS X 系统调用

> ID：11526882
> 
> 赞同：4
> 
> 时间：2012-07-17T16:30:46.967
> 
> 标签：macos, dtrace, function-interposition, interposing, library-interposition

我需要插入*（调用我的函数而不是原始函数）*一些 OS X 系统调用来克服一个闭源软件中的缺陷。

最好，得到的解决方案可以在 10.5（Leopard）和更新版本下工作，但如果论点足够强，我*可能*需要 10.6（Snow Leopard）。

最好是生成的解决方案是一个可执行文件，但我可能会选择一个脚本。

最好，即使在目标应用程序运行之后，所得到的解决方案也能够插入*（“窃取向量”） ，但我可以接受一种必须在应用程序加载时注入自身的技术。*

最好用 C 或 C++ 开发最终的解决方案，但我可以满足于 Objective-C 或其他东西。

到目前为止，我已经尝试过：

1) **DTrace**脚本，它教会了我很多东西，但是 D 语言的局限性*（有限的流量控制等）*使它成为我正在做的事情的主要痛苦，更不用说结果将是一个脚本，这不像我所追求的那样整洁和独立。

2) **DYLD_INSERT_LIBRARIES**插入，这在很多方面都很巧妙，但可能是由于命名空间扁平化*（我不会假装深入理解这意味着什么）*，它可以很好地处理更简单的可执行文件，但是即使我构建了目标应用程序也会让我的目标应用程序窒息一个什么都不做的库，实际上不插入任何调用。

我最新的想法是尝试**mach_star** ( [https://github.com/rentzsch/mach_star](https://github.com/rentzsch/mach_star/) )，但我先在这里停下来，询问 Stack Overflow 社区，它总是比我知道的更多......

...接下来我应该看看除了 mach_star 之外的东西吗？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-07-17T20:54:32.367

我认为你在 mach_star 上做出了正确的选择。

如果您真的想了解 darwin 链接加载器的工作原理等，我会花更多时间来解决您的 DYLD 插入问题。但显然您正在寻找一种快速的解决方案，而不是一种深入的学习体验。而且我怀疑任何人都能够在无法访问您的项目的情况下找出您遇到的问题。所以，这很可能是一个死胡同。此外，无论如何，马赫覆盖和注入更有趣。

Mach 注入的基础知识实际上并没有那么难，但是有很多事情你必须做对，其中大部分都没有很好的记录。在你得到可以在你的系统上运行的东西之前，你会出错 11 件事，然后它不会在你尝试的下一个函数上运行，然后它不会在 10.5 或 10.8 上运行，并且…… mach_star 库为你包装了所有这些东西。那么，为什么不使用它呢？

我应该提一下，自从英特尔之前的日子以来，我就没有使用过 mach_star。但看起来它仍在定期更新，x86_64 和 10.7 以及 Xcode 4 等都有变化。

# android - 删除充气器布局内的两个 LinearLayout

> ID：11526888
> 
> 赞同：0
> 
> 时间：2012-07-17T16:31:11.463
> 
> 标签：android, parent, android-linearlayout, removechild, layout-inflater

我有一个名为 social_form_organization.xml 的 xml 文件，它有两个布局。这个 xml 文件在名为 content 的布局中膨胀，我们可以通过下面的代码看到

**social_form_organization.xml**

```
 <LinearLayout     
    xmlns:android="http://schemas.android.com/apk/res/android"
    android:id="@+id/sfo_layout"
    android:layout_width="wrap_content"
    android:layout_height="wrap_content"
    android:background="@drawable/background_tile"
    android:orientation="vertical" >

  <LinearLayout
      xmlns:android="http://schemas.android.com/apk/res/android"
      android:id="@+id/sfo_layout2"
      android:layout_width="wrap_content"
      android:layout_height="51dp"
      android:background="@drawable/background_tile"
      android:baselineAligned="true"
      android:orientation="horizontal">

      <Button
          android:id="@+id/sfo_btOrganization"
          android:layout_width="wrap_content"
          android:layout_height="wrap_content"
          android:layout_marginBottom="2dp"
          android:layout_marginLeft="5dp"
          android:layout_marginRight="5dp"
          android:layout_marginTop="2dp"
          android:hint="@string/sfo_btOrganization" />

      <EditText
          android:id="@+id/sfo_etEmpresa"
          android:layout_width="fill_parent"
          android:layout_height="wrap_content"
          android:layout_marginBottom="2dp"
          android:layout_marginTop="2dp"
          android:layout_weight="0.14"
          android:hint="@string/sfo_etEmpresa"
          android:inputType="textMultiLine"
          android:scrollHorizontally="false" />

      <ImageButton
          android:id="@+id/sfo_ivRemove"
          style="?android:attr/buttonStyleSmall"
          android:layout_height="60dp"
          android:layout_width="50dp"
          android:layout_marginTop="2dp"
          android:layout_marginBottom="2dp"
          android:layout_marginRight="5dp"
          android:onClick="onClick"
          android:background="@android:color/transparent"
          android:src="@drawable/tb_no_delete" />

  </LinearLayout>

    <EditText
        android:id="@+id/sfo_etTitulo"
        android:layout_width="fill_parent"
        android:layout_height="wrap_content"
        android:layout_marginBottom="2dp"
        android:layout_marginLeft="65dp"
        android:layout_marginRight="55dp"
        android:layout_marginTop="2dp"
        android:layout_weight="0.14"
        android:hint="@string/sfo_etTitulo"
        android:inputType="textMultiLine"
        android:scrollHorizontally="false"  />

</LinearLayout> 
```

**social_form_organization.xml**膨胀的布局

 **```
 <LinearLayout
        xmlns:android="http://schemas.android.com/apk/res/android"
        android:id="@+id/se_contentOrganization"
        android:layout_width="wrap_content"
        android:layout_height="wrap_content"
        android:layout_marginBottom="2dp"
        android:background="@drawable/background_tile"
        android:orientation="vertical" >

        <include
            xmlns:android="http://schemas.android.com/apk/res/android"
            android:layout_width="match_parent"
            android:layout_height="70dp"
            layout="@layout/socio_form_organization" /> 
```

在我的课上，我做通货膨胀

```
 LayoutInflater inflaterOrganization=
    (LayoutInflater)getSystemService(Context.LAYOUT_INFLATER_SERVICE);
    LinearLayout organization =    
    (LinearLayout)inflaterOrganization.inflate(R.layout.socio_form_organization, null);
    LinearLayout lLayoutOrganization;
    lLayoutOrganization = (LinearLayout)findViewById(R.id.se_contentOrganization);
    lLayoutOrganization.addView(organization); 
```

但是现在当我单击 ImageButton 时需要删除内容内的两个布局，但我不能。

我尝试

```
 View toRemove = (View) view.getParent();
    ViewGroup vg = (ViewGroup)findViewById(R.id.se_content);
    vg.removeView(toRemove); 
```

但只有当我有一个布局时才有效。在这种情况下，我有两个布局并且不起作用。

我不知道我是否能让你明白。任何人都可以帮助我吗？谢谢

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-07-17T16:41:31.900

您正在引用您提供的布局中不存在的两个 id：

```
lLayoutOrganization = (LinearLayout)findViewById(R.id.se_contentOrganization); 
```

在哪里`se_contentOrganization`？你的意思是`se_contentEmail`？

当您尝试删除视图时：

```
ViewGroup vg = (ViewGroup)findViewById(R.id.se_content); 
```

在哪里`se_content`？还是你的意思`se_contentEmail`？或者`sfo_layout`？

**添加**

试试这个：

```
LinearLayout parent = (LinearLayout) findViewById(R.id.se_contentOrganization);
LinearLayout child = (LinearLayout) findViewById(R.id.sfo_layout);
parent.removeView(child); 
```

如果您多次使用 social_form_organization.xml，请尝试：

```
LinearLayout child = (LinearLayout) view.getParent().getParent(); 
LinearLayout parent = (LinearLayout) child.getParent(); 
parent.removeView(child); 
```**

# jqgrid - jqGrid columnChooser - 按字母顺序右侧未选择的列

> ID：11526893
> 
> 赞同：1
> 
> 时间：2012-07-17T16:31:47.533
> 
> 标签：jqgrid

我一直在使用 jqGrid 并且一切正常（排序、重新排序列、添加/删除 columnChooser 中的列、重新排序 columnChooser 中的列……）。然而，还有一件小事。

看来，我传递给网格的 colModel 的初始列表包含按显示顺序排列的列，包括可能隐藏列的列表，例如列：

Id、名称、日期（隐藏）、AValue、BValue、CValue（隐藏）

现在，当我打开 columnChooser 时，可见列以预期的顺序显示在左侧，因为它们出现在网格中。不可见的列在右侧显示为：Date、CValue。如果我从网格中删除所有列，则列选择器对话框右侧未选择列的顺序与 colModel 中定义的相同：Id、Name、Date、...

我希望看到所选列在屏幕上出现的顺序以进行重新排序，但我希望右侧未选择的列始终按字母顺序显示 - 这有可能吗？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-07-03T14:57:41.417

我很难让它工作，但最终决定将我自己的事件处理程序添加到对话框中以手动对右侧进行排序。

```
//Add the button to the jqGrid toolbar
$('#MyGridId').jqGrid('navButtonAdd', '#MyGridToolbar', {
    buttonicon: 'ui-icon-transferthick-e-w',
    caption: 'Select Columns',
    title: 'Select Columns',
    onClickButton: function () {
        $(this).jqGrid('columnChooser', {
            done: function (perm) {
                if (perm) {
                    this.jqGrid('remapColumns', perm, true);
                }
            }
        });

        //Setup custom event bindings and give the right side an initial sort
        BindColPickerActions($.jgrid.jqID(this.id));
        SortColPickerAvailable($.jgrid.jqID(this.id));
    }
});

//function to add click event bindings to the dialog actions
function BindColPickerActions(gridId) {
    var colpickerId = 'colchooser_' + gridId;

    //When moving an item from selected to available (Hiding)
    $('#' + colpickerId + ' .selected a:not(.SortModifier)').bind('click', function(){
        SortColPickerAvailable(gridId);
        BindColPickerActions(gridId);
    });

    //When moving an item from available to selected (Showing)
    $('#' + colpickerId + ' .available a:not(.SortModifier)').bind('click', function(){
        BindColPickerActions(gridId);
    });

    //add a class to the actions that have been modified to keep track
    $('#colchooser_' + colpickerId + ' .available a:not(.SortModifier), #' + colpickerId + ' .available a:not(.SortModifier)').addClass('SortModifier');
}

//function to sort the available list
function SortColPickerAvailable(gridId) {
    //get the list of li items
    var colpickerId = 'colchooser_' + gridId;
    var available = $('#' + colpickerId + ' .available .connected-list');
    var li = available.children('.ui-element');

    //detatch and sort the li items
    li.detach().sort(function(a, b) {
        return $(a).attr('title').toUpperCase().localeCompare($(b).attr('title').toUpperCase());
    }); 

    //re-attach the li items           
    available.append(li);
} 
```

# javascript - Java Script Regex - 查找脚本中是否只有允许的字符

> ID：11526897
> 
> 赞同：0
> 
> 时间：2012-07-17T16:32:10.363
> 
> 标签：javascript, regex

如果字符串仅包含以下方式允许的字符，我正在尝试编写一个 Java Script 正则表达式来匹配 -

1.  字符串中只能包含 0、1、x 或逗号 (,)。
2.  每个数字（0、1 或“x”）应以逗号 (,) 分隔
3.  应至少有一个逗号分隔值（即“0,1”或“0,x,1”）
4.  逗号应始终由数字或“x”包围（即“，”或“,0”无效）

是否可以为这种情况编写正则表达式？我可以使用 java script string split 来做到这一点，但这对我来说并不优雅。希望有人可以帮助提出上述条件的正则表达式。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-07-17T16:39:19.500

尽管我同意@SomeKittens 的观点，即您应该展示您尝试过的内容，但您至少提供了一个相当详细的规范。根据我对它的理解，你可以使用这样的东西：

`var isValid = /^(?:[01x],)+[01x]$/.test(str);`

符合以下任何一项：

*   0,1
*   0,1,1
*   0,x,0,0

这些都不是：

*   0
*   ,
*   0,
*   0,1,
*   ,1
*   0,,1
*   0,X（大写 X）

如果您希望除了小写之外还允许匹配大写 X，请将`/i`标志添加到正则表达式以进行不区分大小写的匹配。

# sql-server - 使用 jQuery Mobile 在移动设备中查看 SSRS 报告

> ID：11526901
> 
> 赞同：0
> 
> 时间：2012-07-17T16:32:18.780
> 
> 标签：sql-server, jquery-mobile, reporting-services

我需要开发一个移动应用程序，该应用程序可以显示来自服务器中已经可用的 SQL Server Reporting Services (SSRS) 的报告。这是如何使用 jQuery Mobile 完成的？我需要额外的组件来实现这一点吗？

# c# - C# WinForms 应用程序显示许多托盘图标

> ID：11526902
> 
> 赞同：1
> 
> 时间：2012-07-17T16:32:24.687
> 
> 标签：c#, winforms

我对 C# 非常陌生，这是我在这里提出的第三个问题。

我正在制作一个可以最小化到系统托盘的应用程序。我有两个名为`Form1`和的表格`Form2`。到目前为止我所做的是：

在`Form1`中，我有一个显示`Form2`使用此代码的按钮：

```
this.Hide();
Form2 form2 = new Form2();
form2.Show(); 
```

`Form2`有一个隐藏它的按钮，使用以下代码：

```
this.Hide(); 
```

现在，我在任务栏上有托盘图标。托盘图标有一个`ContexMenuStrip`，并且有一个名为*show*的选项使用以下代码：

```
Form1 form1 = new Form1();
form1.Show(); 
```

问题是当我单击它时，任务栏上会出现第二个托盘图标。两个托盘图标都有相同的菜单，并且都在工作。如果我再次单击*显示*另一个带有*Form1*的窗口弹出，并且有三个托盘图标，依此类推....

有人能帮我吗？

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-07-17T16:35:21.330

这是因为您每次都在创建一个新的 Form1。

```
Form1 form1 = new Form1(); 
```

您不想创建*新*的Form1，而是想显示旧的。为 Form2 提供对您的*第一个*form1 的引用（例如，将其称为 theMainform1）。然后代替

```
Form1 form1 = new Form1();
form1.Show(); 
```

你想做

```
theMainform1.Show(); 
```

所以你会有：

```
 this.Hide();
 Form2 form2 = new Form2();
 form2.theMainform1 = this;
 form2.Show(); 
```

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2012-07-17T16:35:27.407

问题是您正在创建 Form1 的新实例。这将创建一个全新的窗口，而不是恢复您的旧窗口。

```
Form1 form1 = new Form1();
    form1.Show(); 
```

您需要让 Form2 引用 Form1 的原始实例。您可以创建一个构造函数来传递一个看起来像的自引用

```
Form2 form2 = new Form2(this); 
```

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-07-17T16:44:04.860

您可以通过在表单上将 ShowInTaskbar 设置为 false 来防止窗口在任务栏中显示图标。但是，当他们说您一遍又一遍地创建新表单时，其他答案是正确的。

为什么要同时显示两个表单？它们是否应该同时出现在屏幕上并同时处于活动状态？如果是这样，您可以尝试 MDI 界面。 [http://en.wikipedia.org/wiki/Multiple_document_interface](http://en.wikipedia.org/wiki/Multiple_document_interface)

在 WinForms 中是可能的，但我认为微软正在 WPF 中远离它们。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2012-07-21T11:16:10.713

这是一个工作代码，以防有人正在寻找它：

**表格1：**

```
/* Hiding Form1 and showing Form2 */    
private void btnHideForm1_Click(object sender, EventArgs e)
             {
                     Form mod = new Form2();
                     mod.Owner = this;
                     mod.Show();
                     this.Hide();
         } 
```

**表格2：**

```
 /* Hiding Form2 and showing Form1 */
private void btnHideForm2_Click(object sender, EventArgs e)
         {
                 this.Owner.Show();
                 this.Close();
         } 
```

谢谢你们的帮助！！！

我爱你！！！

# visual-studio-2008 - 获取 LINK2019（未解决的导出），即使存在 lib 并且它具有正确的功能

> ID：11526904
> 
> 赞同：0
> 
> 时间：2012-07-17T16:32:34.003
> 
> 标签：visual-studio-2008, dll, linker, export, .lib

我正在尝试使用 Visual Studio 2008 使用第三方库编译我的项目。现在问题是我将 lib 文件添加到 LINKER 输入，更新了其他库位置 - 确保确实读取了 lib 文件（已删除额外的位置和编译失败，尖叫着找不到lib文件）。我使用 dumpbin 检查了 lib 中存在的导出，并且该功能存在。

然而，从该库调用函数时，我仍然收到错误 LINK2019 unresolved bla bla bla。有人遇到过类似的事情/有任何想法吗？也许值得一提的是，我尝试使用的库似乎是使用 VS2003 编译的。

**更新：** 库标题中出现的定义：

```
#ifndef X
#define X

#ifdef _cplusplus
extern "C" {
#endif

_XFUNC int X_Open(int C);

#ifdef _cplusplus
}
#endif
#endif 
```

以及导出的定义：（在库头中包含的另一个头中）

```
#ifdef _BUILDXDLL
    #define _XFUNC __declspec (dllexport)
#else
    #ifdef WIN32
        #define _XFUNC __declspec (dllimport)
    #else
        #define _XFUNC
    #endif
#endif 
```

完整的错误信息：

```
error LNK2019: unresolved external symbol _X_Open referenced in function "public virtual bool __thiscall MyClass::initialise(class QDomElement*)"(?initialise@MyClass@@UAE_NPAV QDomElement @@@Z) 
```

我不确定它是否相关，但声明是***X_Open***并且在错误消息中它显示为***_X_Open*** 提前致谢，Anorflame

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-07-19T15:39:28.967

**突破！** 问题在于调用约定。我的项目设置为 __cdecl(/Gd)，而第 3 方库是使用 __stdcall(/Gz) 编译的（这解释了为什么链接器将 _ 连接到 X_Open）。

这把我带到了另一个问题——但这已经是另一个问题了。

# jquery - jquery弹出窗口中的不显眼验证

> ID：11526906
> 
> 赞同：2
> 
> 时间：2012-07-17T16:32:39.040
> 
> 标签：jquery, asp.net-mvc-3, jquery-ui, validation, unobtrusive-validation

我试图在我的 ASP.net MVC 3 应用程序中验证一个弹出窗口。我在网上搜索了一个解决方案，但还没有让它们中的任何一个起作用。

我有以下非常简单的模型：

```
public class Player
{
    public int playerId { get; set; }

    [Required]
    [Range(0, 99)]
    public int number { get; set; }

    [DisplayName("First Name")]
    [Required]
    [StringLength(15)]
    public string firstName { get; set; }

    [DisplayName("Last Name")]
    [Required]
    [StringLength(15)]
    public string lastName { get; set; }

    [Required]
    public float battingAverage { get; set; }
} 
```

然后我有以下视图，其中包含玩家列表。在这里，我使用 Jquery 弹出窗口来创建或编辑播放器。然后播放器被附加到此视图中的列表中。

```
 @model IEnumerable<PlayingWithJSON.Models.Player>

@{
    ViewBag.Title = "Index";
    Layout = "~/Views/Shared/_Layout.cshtml";
}

<h2>Index</h2>
  <div id="PlayerListBlock"></div>
  <span class="AddLink ButtonLink">Add New Player</span>
  <div id="PlayerDialog" title="" class="Hidden"></div>

<script type="text/javascript">
    $(function () {
      $("#PlayerDialog").dialog(
      {
          autoOpen: false, width: 400, height: 500, modal: true,
          buttons:
              {
                  "Save": function () {
                      if ($("#PlayerForm").valid()) {
                          $.post("/Player/Save",
                                  $("#PlayerForm").serialize(),
                                  function (data) {
                                      $("#PlayerDialog").dialog("close");
                                      $("#PlayerListBlock").html(data);
                                  }
                                );
                      }
                  },
                  Cancel: function () { $(this).dialog("close"); }
              }
    });
    $(".EditLink").live("click", function () {
        var id = $(this).attr("playerid");
        $("#PlayerDialog").html("")
            .dialog("option", "title", "Edit Player")
            .load("/Player/Edit/" + id, function () { $("#PlayerDialog").dialog("open"); });
    });
    $(".AddLink").click(function () {
        $("#PlayerDialog").html("")
            .dialog("option", "title", "Add Player")
            .load("/Player/Create", function () { $("#PlayerDialog").dialog("open"); });
    });
    LoadList();
});
function LoadList() {
    $("#PlayerListBlock").load("/Player/List");
}
</script> 
```

下面是与允许我创建和编辑播放器的弹出窗口相对应的部分视图。

```
@model PlayingWithJSON.Models.Player

@using(Html.BeginForm("Save", "Player", FormMethod.Post, new { id = "PlayerForm" })) 
{
    @Html.ValidationSummary(true)
    @Html.Hidden("playerId")
    <label class="Number">
        <span>Number</span><br />
        @Html.TextBoxFor(x => x.number)<br />
        @Html.ValidationMessageFor(x => x.number)
    </label>
    <label class="FirstName">
        <span>First Name</span><br />
        @Html.TextBoxFor(x => x.firstName)
        @Html.ValidationMessageFor( x => x.firstName )
    </label>
    <label class="LastName">
        <span>Last Name</span>
        @Html.TextBoxFor(x => x.lastName)
        @Html.ValidationMessageFor( x => x.lastName )
    </label>
    <label class="BattingAverage">
        <span>Batting Average</span>
        @Html.TextBoxFor(x => x.battingAverage)
        @Html.ValidationMessageFor( x => x.battingAverage )
    </label>
}
    <script type="text/javascript">
        $(function () {
            $.validator.unobtrusive.parse("PlayerForm");
        });
    </script> 
```

在此表单的底部，我添加了对 validator.unobtrusive.parse 的调用，但尚未使其正常工作。

这是控制器中的保存方法：

```
[HttpPost]
public ActionResult Save(Player player)
{
    if (ModelState.IsValid)
    {
        //Save Stuff
        baseBall.Players.Add(player);
        baseBall.SaveChanges();
        return PartialView("List", baseBall.Players.ToList());
    }
    else
        return PartialView("PlayerForm", player);
} 
```

当我点击弹出窗口上的“保存”按钮时，不会发生任何客户端验证。到目前为止我编写的 jquery 工作正常，但是如何包含验证？我读过验证属于部分，但我也读过验证属于“主视图”。我希望有人能做的是向我展示如何正确验证弹出窗口中的内容。

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2012-07-17T17:01:02.277

You need to add the `$.validator.unobtrusive.parse("PlayerForm");` to a function that you call on successful display of the dialog box. You are currently putting it in `document.ready`, which isn't called at the point because the page has already been loaded. In my application I am opening the dialogs from `Ajax.ActionLink`, so I put it in the `OnSuccess` callback of the link. I am not 100% sure where you need to put it in your application, but I hope this gives you enough to go on to resolve the issue.

# java - >>> 运算符如何在 Java 中工作

> ID：11526912
> 
> 赞同：3
> 
> 时间：2012-07-17T16:32:57.960
> 
> 标签：java, binary, bitwise-operators, bit-shift

我正在了解如何`>>>`工作。为此，我有这个程序：

```
public class Main {
    public static void main(String[] args) 
    {
        short i = 130;
        byte b = (byte)i;
        String a = Integer.toBinaryString(256 + (int) b);
        System.out.println(Integer.toBinaryString(i));
        System.out.println(a.substring(a.length() -8));
        System.out.println(b);

        byte c = (byte) (b >>> 2);
        String x = Integer.toBinaryString(256 + (int) c);

        System.out.println(x.substring(x.length() -8));
        System.out.println(c);
    }
} 
```

我得到这个输出：

```
10000010
10000010
-126
11100000
-32 
```

为了显示为二进制，我在[这里](https://forums.oracle.com/forums/thread.jspa?threadID=2089318)找到了如何将字节显示为二进制字符串。

运算符`>>>`将添加零，但我明白了：

```
-126
11100000
-63 
```

代替：

```
-126
10100000
-32 
```

它添加了 1 而不是 0：

```
11100000
10100000 
```

我究竟做错了什么？也许我什么都不懂。

* * *

## 回答 #1

> 赞同：9
> 
> 时间：2012-07-17T16:37:35.803

问题是`b >>> 2`首先提升`b`为值为-126的int，即

```
11111111 11111111 11111111 10000010 
```

当您使用零扩展将其右移 2 时，您会得到：

```
00111111 11111111 11111111 11100000 
```

然后将其转换回一个字节时，它只会删除前三个单词，给出 11100000，这就是您所看到的。

有关位移的更多详细信息，请参阅JLS 的[第 15.19 节。](http://docs.oracle.com/javase/specs/jls/se7/html/jls-15.html#jls-15.19)

# google-bigquery - 我可以使用浏览器工具将数据附加到 Google Big 查询中的现有表吗？

> ID：11526919
> 
> 赞同：0
> 
> 时间：2012-07-17T16:33:27.233
> 
> 标签：google-bigquery

我正在尝试将数据附加到 Google Bigquery 中的现有表中。我可以使用浏览器工具，还是只能使用带有 API 的 Python 命令行？请告诉我。

提前致谢.....

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-07-17T17:17:07.410

不幸的是，这在 UI 中不受支持。我已提交功能请求以添加此支持。您应该能够通过使用 bq 命令行客户端或直接发出 api 请求来进行追加。

# python - 在 Python 中对列表列表进行唯一排序

> ID：11526922
> 
> 赞同：0
> 
> 时间：2012-07-17T16:33:41.820
> 
> 标签：python, list, sorting, large-data

我有一个列表列表-

```
super_list = [seconds, self.flowdata, key] 
```

其中 seconds 是一个十位数字，self。flowdata 是一个包含 160 个整数的列表，而 key 是一个标识字符串。打印 super_list 将产生以下结构的多次迭代，所有迭代都具有不同的值，

例子：

```
"[[1509321600], 
  ['1', '-1', '4', '7', '7', '1', '-8', '-14', '-24', '-29', '-25', '-24', '-9', '-4', '0', '0', '-5', '-10', '-6', '-5', '7', '-4', '-4', '-11', '5', '3', '9', '5', '3', '3', '6', '-6', '-8', '-6', '-6', '25', '23', '30', '22', '13', '-7', '0', '-1', '-18', '-24', '-28', '-24', '-24', '-18', '-14', '-14', '-12', '-13', '-11', '-15', '-16', '-8', '-3', '-4', '-2', '11', '29', '38', '40', '41', '29', '34', '25', '20', '15', '31', '22', '16', '2', '8', '21', '39', '43', '45', '38', '39', '37', '38', '41', '43', '42', '38', '34', '34', '25', '25', '29', '18', '23', '27', '26', '18', '15', '15', '11', '17', '10', '11', '4', '-3', '-12', '-17', '-14', '6', '5', '13', '4', '-21', '-22', '-16', '-12', '-6', '4', '16', '9', '17', '16', '16', '16', '15', '12', '12', '7', '-2', '-12', '-13', '-5', '-7', '-8', '-12', '-15', '-14', '-11', '-8', '-1', '-1', '-3', '-12', '-7', '-6', '-7', '5', '4', '2', '3', '1', '0', '-12', '-12', '-13', '-17', '-18', '-18', '-15', '-13', '-13', '-16', '-17', '-18', '-18', '-19', '-16', '-13'], 
  '1441-4731-1-10/30/2017'] 
```

每组（或您喜欢的行，如上所示）秒、流数据和键都是相关的。

我想对 super_list 进行排序，以便秒数从最小到最大排序，而且还与 super_list 中相同的数字“行”中的相关流数据和键。

即说上面的例子是排序列表中的第一个（1509321600是秒列表中的最小秒数），上面的flowdata也将是flowdata中的第一个，上面的键“1441-4731-1-10 /30/2017" 将是第一个键。

帮助？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-07-17T16:38:08.357

假设您的列表如下所示`[[seconds1, flowdata1, key1], [seconds2, flowdata2, key2], ...]`：

只需使用`super_list.sort()`.

这将按字典（从左到右）顺序对字段进行排序。由于`seconds`是最左边的字段，所有条目都将按它排序。

`key`您还可以使用参数 to按特定字段排序`sort`，例如：

```
super_list.sort(key=lambda row: row[0]) #sort by seconds field 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-07-17T17:29:15.990

您可以将列表压缩成一个元组，然后对元组列表进行排序，然后使用列表推导解包元组，如下所示：

```
super_list = [seconds, flowdata, key for zipped_tuple in sorted(zip(super_list[0], super_list[1], super_list[2]))] 
```

其中 seconds、flowdata、key 和 zipped_tuple 是任意名称，没有超出列表理解范围的名称。

# json - Monotouch Dialog Json, EntryElement 使用 EntryEnded 事件

> ID：11526926
> 
> 赞同：0
> 
> 时间：2012-07-17T16:33:52.437
> 
> 标签：json, events, xamarin.ios, monotouch.dialog

我需要使用 MTD 和 Json 来动态创建表单，但我还需要检查用户输入：

一些字段可能只接受数字，而另一些字段具有固定长度等。
这可以通过根据指定条件检查每个 EntryElement 值的操作来完成，然后使用一些消息来告诉用户必要的更正。

如果我们的字段数量很少，这没关系，但是当一个字段超过 50 个时，这在可用性方面会变得非常尴尬。理想的解决方案是在用户结束输入 EntryElement 时通知用户更正

现在 MTD 提供了某种机制来做到这一点：

```
JsonElement jsonElement;
jsonElement = JsonObject.Load("file.json");
((EntryElement) jsonElement["field_1"]).EntryEnded = delegate { doSomething();}; 
```

假设“field_1”是一个带有“field_1”值的id 属性标记的EntryElement
上面的代码按预期工作，即：当我将焦点更改为另一部分时，EntryEnded 事件激活。现在对于百万美元的问题：

我如何知道 Event 对应于哪个 EntryElement？或者换句话说。
调用事件时如何获取 EntryElement 的 ID？

如果以上都不是可能的，那将是合适的解决方案？

提前感谢任何线索，

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-07-26T20:32:01.357

找到了一种方法：

```
((EntryElement)jsonElement ["field_1"]).EntryEnded += (object sender, EventArgs e ) =>
{
  NSIndexPath pt = ((EntryElement)sender).IndexPath;
  Console.WriteLine("section: "+pt.Section+" row: "+pt.Row);
}; 
```

这个小东西会打印出收到EntryEnded事件的EntryElement的Section和Row。这与获取 id 不完全一样，但至少现在我有关于它的位置的信息，并且从中我可以获得更多信息（特别是如果我小心地将它保存在其他地方）

这可能是一个基本技巧，但我在其他任何地方都没有找到它！

# linux - 如何在Linux上使用gdb调试同时加载.so库的可执行文件？

> ID：11526932
> 
> 赞同：0
> 
> 时间：2012-07-17T16:34:21.167
> 
> 标签：linux, debugging, gdb

可执行文件和库都是用 -g 标志构建的，但是当我用 gdb 调试它时，它给了我错误：0x8b0cec83 in ?? () 来自回溯的最后一行。我猜这是我刚刚构建的.so库的错误，共享库只是在可执行文件中填充了一些函数指针。如何在gdb中同时调试它们？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-07-17T16:44:02.113

调试库不需要额外的步骤。您最终到达的地址 (0x8b0cec83) 可能不是应用程序或库的一部分，因为您在某处使用了未初始化（或损坏）的函数指针。

# ms-access - 限制受 Access 查询影响的记录数

> ID：11526935
> 
> 赞同：3
> 
> 时间：2012-07-17T16:34:36.157
> 
> 标签：ms-access

是否可以在 MS-Access 数据库表中检索有限制的记录？

我必须使用更新查询；使用它时出现语法错误。

例子：

```
Update Report Set Status='Processing' where Status='No' LIMIT 10 
```

谁可以帮我这个事？

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-07-17T16:41:31.123

MS Access 没有`LIMIT`字段，但您可以使用它：

```
Update Report 
Set Status='Processing' 
where ID IN (
    SELECT TOP 10 ID 
    FROM Report WHERE Status='No' 
    ORDER BY ID
) 
```

只需替换`ID`为您的主键，这将更新前 10 条记录。

现在，如果你想得到等价的东西`LIMIT(10,20)`，它会变得有点复杂......

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-07-17T19:05:43.277

除了[LittleBobbyTables 的回答](https://stackoverflow.com/a/11527052/6884)（这是正确的），这里有一个如何`LIMIT(10,20)`在 Access SQL 中执行的示例：

[MS Access数据库分页+搜索怎么做？](https://stackoverflow.com/questions/6914637/how-to-do-ms-access-database-paging-search/6916791#6916791)

# java - Java：证书自签名 jar

> ID：11526936
> 
> 赞同：2
> 
> 时间：2012-07-17T16:34:41.820
> 
> 标签：java, security, certificate

我有一段时间没有做证书的事情了，我正在寻找一些帮助。

理想情况下，我想实现这一目标。

*   创建罐子。
*   用证书签名。
*   让该 jar 中的代码验证它是否使用该证书进行了签名。

我创建了一个自签名证书。

```
keytool -genkey -keyalg RSA -alias selfsigned -keystore keystore.jks -storepass password -validity 360 -keysize 2048 
```

导出其公共证书

```
keytool -storepass password -alias selfsigned -export -rfc -file outfile.txt.cer -keystore keystore.jks 
```

在罐子上签名

```
jarsigner -keystore keystore.jks -signedjar signedX.jar x.jar selfsigned
Enter Passphrase for keystore: password 
```

然后我在 Jar 中有一个类，它加载 outfile.cer 并验证这个 jar 是针对它签名的。

这听起来合理吗？

我正在使用我的私有证书对 jar 进行签名，然后在 jar 中包含公共证书并确保其使用相同的证书进行签名。

对我来说，最大的漏洞似乎是我可以解开罐子，更改代码，使用 NEW-Private-Cert 签名，将 NEW-Public-Cert 包含在 jar 中，这将是有效的。

我认为这个问题的解决方案是有一些外部密钥存储来验证，而不是我的 jar 中的证书。这听起来合理吗？

我很欣赏这是一个开放的问题，更像是一个设计问题，而不是一个正确答案的问题。

任何建议都会很棒。

* * *

编辑...

想了一夜之间，我意识到我的过程中的错误。

我需要将 PUBLIC 证书导入客户端上的 Keystore。然后，当我用私钥签署我的 jar 时，客户端 jvm 将对其进行验证。我不需要在内部做任何检查。

我会对此进行测试，然后写下我的发现。

# linux - cmake fortran undefined reference to MAIN__ on linux

> ID：11526939
> 
> 赞同：0
> 
> 时间：2012-07-17T16:34:47.180
> 
> 标签：linux, cmake, fortran, gfortran

我试图让一个 cmake 构建系统在 linux 上运行。该项目包含一堆可执行文件和两个库。其中一个可执行文件首先构建为库，然后将该库与包含 man 子例程的目标文件链接。这样做是因为其余的可执行文件依赖于该库。棘手的部分是主子例程是在其余源依赖的模块中定义的，因此需要在其余源之前编译它。效果是将主子例程添加到生成的库中。这似乎在 Mac OS X 上运行良好，但在 Linux 上链接状态失败。

失败部分的 cmake 文件看起来像

```
cmake_minimum_required (VERSION 2.8)

# Create an empty variable to hold all the source files.
set (vmec_sources "")

# Add subdirectory for all the sources.
add_subdirectory (Sources)

add_library (vmec STATIC ${vmec_sources})
add_dependencies (vmec stell)

# Define an executable and link all libraries.
add_executable (xvmec ${CMAKE_CURRENT_SOURCE_DIR}/Sources/General/vmec_main.f)
add_dependencies (xvmec vmec)
target_link_libraries (xvmec vmec stell)

if ((NOT ${NETCDF_C} STREQUAL "") AND (NOT ${NETCDF_F} STREQUAL ""))
    target_link_libraries (xvmec ${NETCDF_C} ${NETCDF_F})
endif () 
```

运行 cmake 时，一切都配置良好，并在我运行 make Mac OS X 时生成一个 make 文件，一切正常。当我在 Linux 上运行 make 时，它​​失败了。

`make VERBOSE=1`On Linux的输出产生

```
Linking Fortran executable ../build/bin/xvmec
cd /home/user/reconstruction/VMEC2000 && /usr/bin/cmake -E cmake_link_script CMakeFiles/xvmec.dir/link.txt --verbose=1
/usr/bin/gfortran      -cpp -D NETCDF -I /usr/include CMakeFiles/xvmec.dir/Sources/General/vmec_main.f.o  -o ../build/bin/xvmec -rdynamic ../build/lib/libvmec.a ../build/lib/libstell.a /usr/lib/libnetcdf.so /usr/lib/libnetcdff.so 
/usr/lib/gcc/x86_64-linux-gnu/4.4.3/libgfortranbegin.a(fmain.o): In function `main':
(.text+0x26): undefined reference to `MAIN__'
collect2: ld returned 1 exit status
make[2]: *** [build/bin/xvmec] Error 1
make[2]: Leaving directory `/home/user/reconstruction'
make[1]: *** [VMEC2000/CMakeFiles/xvmec.dir/all] Error 2
make[1]: Leaving directory `/home/user/reconstruction'
make: *** [all] Error 2 
```

在 Mac OS X 上，我得到

```
Linking Fortran executable ../build/bin/xvmec
cd /Users/user/repo/trunk/VMEC2000 && "/Applications/CMake 2.8-8.app/Contents/bin/cmake" -E cmake_link_script CMakeFiles/xvmec.dir/link.txt --verbose=1
/usr/local/bin/gfortran     -framework Accelerate   -cpp -D DARWIN -D NETCDF -I /Users/user/NetCDF/include -O3 -ftree-vectorize -m64 -march=native -fomit-frame-pointer -falign-functions -mfpmath=sse CMakeFiles/xvmec.dir/Sources/General/vmec_main.f.o  -o ../build/bin/xvmec  ../build/lib/libvmec.a ../build/lib/libstell.a /Users/user/NetCDF/lib/libnetcdf.dylib /Users/user/NetCDF/lib/libnetcdff.dylib 
"/Applications/CMake 2.8-8.app/Contents/bin/cmake" -E cmake_progress_report /Users/user/repo/trunk/CMakeFiles  100
[100%] Built target xvmec 
```

链接行看起来像是以正确的顺序链接所有相同的东西，所以我不明白为什么这在 Linux 上会失败。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-07-18T21:46:23.137

原来我列出了包含主要方法的错误文件。似乎更高版本的 gfortran 可以从库内部链接“MAIN__”，而 gfortran-4.4 不能。

# java - 什么时候递归回溯合适？

> ID：11526945
> 
> 赞同：11
> 
> 时间：2012-07-17T16:35:14.130
> 
> 标签：java, recursion, backtracking

我正在为一个班级制作一个 SudokuSolver，但我在解决方法时遇到了问题。我目前的解决方案使用递归回溯（我认为）。

# 作业要求

> int solve() -- 尝试使用上述策略解决难题。返回解决方案的数量。

（上述策略）

> 为点分配数字时，切勿分配在那个时刻与点的行、列或正方形发生冲突的数字。我们预先小心地为一个点分配合法数字，而不是分配任何数字 1..9 并在递归后期发现问题。假设初始网格都是合法的，之后只进行合法的点分配。

# 伪代码思想

我可以迭代地遵循这个小输入。例如，假设我必须解决未解决的单元格 #1 和单元格 #2。#1 有可能性 {1, 3 }，#2 有可能性 {2, 3}。那时我会

```
set 1 to 1
    set 2 to 2
        hasConflicts? 0 : 1
    set 2 to 3
        hasConflicts? 0 : 1
set 1 to 3
    set 2 to 2
        hasConflicts? 0 : 1
    set 2 to 3
        hasConflicts? 0 : 1 
```

# 实际代码

```
public int solve() {
    long startTime = System.currentTimeMillis();
    int result = 0;

    if (!hasConflicts()) {
        Queue<VariableCell> unsolved = getUnsolved();
        reduceUnsolvedPossibilities(unsolved);  // Gets the possibilities down from all of 1-9

        if (!hasConflicts()) {
            result = solveRec(unsolved);
        }
    }

    mElapsedTime = System.currentTimeMillis() - startTime;
    return result;
}

protected int solveRec(Queue<VariableCell> unsolved) {
    if (unsolved.isEmpty()) {
        return (hasConflicts()) ? 0 : 1;
    }

    int result = 0;
    VariableCell cell = unsolved.remove();
    Iterator<String> possibilityIt = cell.getPossibilities().iterator();

    while (possibilityIt.hasNext()) {
        cell.setSymbol(possibilityIt.next());

        if (hasConflicts()) {
            possibilityIt.remove();
        } else {
            ++result;
        }
    }

    return result + solveRec(unsolved);
} 
```

# 试验结果

```
testSolveSingleSolution
    expected 1, actual 1

testSolveSolved
    expected 1, actual 1

testSolveUnsolvable
    expected 0, actual 0

testSolveMultiSolutions
    expected 2, actual 7  // MAJOR PROBLEM! 
```

# 递归回溯的一些很好的解释

*   [StackOverflow 的这个答案](https://stackoverflow.com/a/9959374/830988)- 数独生成器的递归解决方案
*   StackOverflow 的[这个答案- 迷宫中的回溯](https://stackoverflow.com/a/9014537/830988)
*   [StackOverflow的这个答案](https://stackoverflow.com/a/10098729/830988)- 素数序列的回溯算法
*   [StackOverflow 的这个答案](https://stackoverflow.com/a/9042357/830988)- 如何仅通过此回溯找到第一个解决方案
*   维基百科关于[回溯的文章](http://en.wikipedia.org/wiki/Backtracking)
*   [递归回溯解释](http://www.cs.utexas.edu/~scottm/cs307/handouts/recursiveBacktrackingExplanation.htm)

# 问题

我以前做过递归回溯，我已经查看了上面的所有链接等等，但我仍然遇到问题。我认为问题在于我在思考如何解决这个问题。（请参阅伪代码理念。）使用递归回溯进行穷举搜索是否合适？回溯是正确的，但执行是错误的吗？有没有比递归回溯更好的算法？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-07-17T16:49:18.683

这看起来像是一个实现问题。检查要增加结果的块。您真的要为该单元格的每个有效值递增吗？如果有几个有效值，那么覆盖旧的有效值？

# java - 我的java代码有什么问题

> ID：11526948
> 
> 赞同：-4
> 
> 时间：2012-07-17T16:35:25.300
> 
> 标签：java

我正在学习java。我的示例目录如下：

> ./src
> ./src/yxy
> ./src/yxy/pack
> ./src/yxy/pack/testf
> ./src/yxy/pack/testf/Person.java
> ./Hello.java
> ./Hello.class
> 
> ./testpack
> ./testpack/yxy
> ./testpack/yxy/pack
> ./testpack/yxy/pack/testf
> ./testpack/yxy/pack/testf/Person.class
> ./testpack.jar

src 目录用作库。它提供了 Person 类。
src 的输出位于 testpack 目录中。
我根据 testpack 目录生成了一个 testpack.jar。
Hello.java 是主要的 java 文件。它使用 Person 类。

**Person.java**源代码如下：

```
package yxy.pack.testf;

public class Person {
  private String name;

  public Person(String name) {
    this.name = name;
  }

  public String getName() {
    return name;
  }
} 
```

Hello.java源代码如下**：**

```
import java.io.*; //IOException
import java.util.*; //Enumeration

import yxy.pack.testf.Person;

public class Hello{

    public static void main(String[] args)throws IOException  {
        Person p=new Person("abc");
        Class cls=Person.class;
        ClassLoader clsLoader=cls.getClassLoader();
        String clsFile=cls.getName();
        System.out.println("end");
    }
} 
```

我使用下面的方法在当前目录下生成testpack.jar。

> javac -verbose -d testpack src\yxy\pack\testf\Person.java
> cd testpack
> jar -cvf testpack.jar ./yxy
> move testpack.jar ./../testpack.jar
> cd ..

我使用以下方法来构建和运行应用程序：

> javac -classpath .\testpack.jar Hello.java
> java -classpath .\testpack.jar 你好

这是我得到的错误：

```
    线程“主”java.lang.NoClassDefFoundError 中的异常：你好  
    引起：java.lang.ClassNotFoundException：你好  
            在 java.net.URLClassLoader$1.run（未知来源）  
            在 java.security.AccessController.doPrivileged（本机方法）  
            在 java.net.URLClassLoader.findClass（未知来源）  
            在 java.lang.ClassLoader.loadClass（未知来源）   
            在 sun.misc.Launcher$AppClassLoader.loadClass（未知来源）  
            在 java.lang.ClassLoader.loadClass（未知来源）  
    找不到主类：你好。程序将会退出。
```

我不明白为什么会这样。我该如何解决？

> 你好

```
    线程“main”中的异常 java.lang.NoClassDefFoundError: yxy/pack/testf/Person

            在 Hello.main(Hello.java:10)
    引起：java.lang.ClassNotFoundException：yxy.pack.testf.Person
            在 java.net.URLClassLoader$1.run（未知来源）
            在 java.security.AccessController.doPrivileged（本机方法）
            在 java.net.URLClassLoader.findClass（未知来源）
            在 java.lang.ClassLoader.loadClass（未知来源）
            在 sun.misc.Launcher$AppClassLoader.loadClass（未知来源）
            在 java.lang.ClassLoader.loadClass（未知来源）
            ... 1 更多
```

我怎样才能解决这个问题？

=== 无论如何，我找到了解决方法。只需在cmd中使用以下内容。

```
>java -classpath testpack.jar;. Hello 
```

我必须添加 testpack.jar 和 current path 。到类路径。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-07-17T17:07:12.960

好吧，这可能是很多事情，如果您是 Java 的初学者，我建议您从 IDE 开始，但是如果您不想要这个，那么这里有一个关于[解决 Java 中 NoClassDefFoundError 的 3 种方法的链接](http://javarevisited.blogspot.com/2011/06/noclassdeffounderror-exception-in.html)

这也是另一个用户的摘录，他解释了为什么会发生此错误：

> 当我在包中创建类文件然后尝试从包中运行程序时，我总是会收到该错误。解决方案是在文件系统中上一层，这样您就处于包的级别，而不是包内容的级别。
> 
> 例如，如果你的包名是 greetings，你的类文件名是 HelloWorld，你的程序包含以下行：
> 
> 包裹问候语；
> 
> 包名对应于文件系统中的一个目录，例如 C:\Java\greetings。您的类文件位于该目录中，即其文件名为 C:\Java\greetings\HelloWorld.class。
> 
> 如果定位到 c:\Java\greetings 然后执行：
> 
> java HelloWorld
> 
> 你得到一个 NoClassDefFound 错误。如果您上一个目录，在本例中是 C:\Java，而不是 C:\Java\greetings，然后执行以下操作：
> 
> java问候.HelloWorld
> 
> 你的程序应该适合你。

# php - 如何显示正确的页码？

> ID：11526949
> 
> 赞同：-1
> 
> 时间：2012-07-17T16:35:25.220
> 
> 标签：php

> **可能重复：**
> [为什么这段代码不能正确增加计数器？](https://stackoverflow.com/questions/11331702/why-does-this-code-not-increment-a-counter-properly)

我在显示正确的页码时遇到了问题。

我有一个[演示](http://helios.hud.ac.uk/u0867587/Mobile_app/Text4.php)，您可以使用它来查看发生了什么：

*   第 1 步：打开应用程序时，在文本框中输入数字 8，然后提交。
*   第 2 步：您将在页面顶部看到“创建问题和答案：第 1 次，共 8 次”这是正确的，因为您目前位于 8 次中的第一页。
*   第 3 步：现在单击底部的“提交详细信息”按钮，您会看到它现在显示“创建问题和答案：第 2 次，共 8 次”。同样，这很好，因为您现在位于 8 页中的第二页。

下面是问题：

*   第4步：如果你点击“添加问题”按钮两次，你会看到下面出现2行，这两行都包含自己的图像文件上传表单。

*   第 5 步：单击“提交详细信息”按钮，您将意识到您不在第 3 页，因为它没有说明“创建问题和答案：第 3 节，共 8 节”，而是说明“创建问题和答案：第 5 节，共 8 节

我相信它这样做的原因是因为当您单击“提交详细信息”按钮时，它会提交整个表单，而且还有几个图像文件上传表单附加到一行中，它也在计算它们在提交中，这就是为什么它说我们在第 5 页而不是第 3 页。

所以我的问题是，为了能够显示正确的页码，我需要在代码中进行哪些更改？每次用户单击“提交详细信息”按钮时，它应该每次只计算页码+1。

以下是它当前如何计算页码以及如何将其显示在顶部的代码：

```
 <?php

session_start();

if(isset($_POST['sessionNum'])){
            //Declare my counter for the first time

            $_SESSION['initial_count'] = $_POST['sessionNum'];
            $_SESSION['sessionNum'] = intval($_POST['sessionNum']);
            $_SESSION['sessionCount'] = 1;

    }

else if ($_SESSION['sessionCount'] < $_SESSION['sessionNum']) {
    $_SESSION['sessionCount']++;
}

$sessionMinus =  $_SESSION['sessionCount'];

?> 
```

...

```
<h1>CREATING QUESTIONS AND ANSWERS: SESSION <?php echo $sessionMinus ?> OF <?php echo $_SESSION['initial_count'] ?></h1> 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-07-17T16:39:28.247

在`create_session2.php`中，您需要区分添加和提交详细信息的问题。例如，尝试使用`isset($_POST['submitDetails'])`. `submitDetails`只有当您的用户单击您的按钮进入表单时，才会设置此变量。

**示例**：

```
...
if (isset($_POST['submitDetails'])) {
    session++;
}
... 
```

这样，您将知道是否因此增加会话数量。

# ruby-on-rails - 嵌套形式质量分配错误具有多个直通关系

> ID：11526961
> 
> 赞同：0
> 
> 时间：2012-07-17T16:36:22.677
> 
> 标签：ruby-on-rails, ruby-on-rails-3, mass-assignment

我目前正在尝试使用嵌套表单在您创建歌曲时将类别标签添加到歌曲中。目前，每次我提交表单时它都会引发大量分配错误，尽管我已经输入了我认为正确的属性可访问特性。显然我在某个地方出错了，所以如果有人能为我指出这一点，那就太好了。表格是：

```
<%= nested_form_for(@song) do |f| %>
         ...
      <%= f.fields_for(@song.categorizations.build) do |cat| %>
        <%= cat.label :category_id, "TAG" %>
        <%= cat.select :category_id, options_for_select(Category.all.collect {|c| [ c.tag, c.id ] }, 
        { :include_blank => true }), prompt: "" %>
      <%end%>
      <%= f.submit "Save" %>
    <% end %> 
```

这里的相关模型是：

```
class Song < ActiveRecord::Base
  attr_accessible :artist, :title, :categorizations_attributes
  has_many :categorizations, dependent: :destroy
  has_many :categories, through: :categorizations

  accepts_nested_attributes_for :categorizations 
```

歌曲控制器如下所示：

```
 def create
    @song = Song.new(params[:song])
    if @song.save
        flash[:success] = "Song successfully added to library"
        redirect_to @song
    else
        #FAIL!
        render 'new'
    end
  end 
```

最后引发的错误是：

```
ActiveModel::MassAssignmentSecurity::Error in SongsController#create

Can't mass-assign protected attributes: categorization 
```

预先感谢您的任何帮助！

# vs-unit-testing-framework - 有没有办法跳过基类中的测试？

> ID：11526962
> 
> 赞同：1
> 
> 时间：2012-07-17T16:36:24.357
> 
> 标签：vs-unit-testing-framework

我正在使用 C# 4.0、Visual Studio 2010 并使用命名空间中的属性注释我的方法/类`Microsoft.VisualStudio.TestTools.UnitTesting`。

我想在我的测试类中使用继承，其中每个额外的继承都代表正在更改或正在创建的东西。如果我能让它不从基类运行测试，那么一切都会好起来的。这是一个粗略的例子：

```
public class Person
{
    public int Energy { get; private set; }

    public int AppleCount { get; private set; }

    public Person()
    {
        this.Energy = 10;
        this.AppleCount = 5;
    }

    public void EatApple()
    {
        this.Energy += 5;
        this.AppleCount--;
    }
}

[TestClass]
public class PersonTest
{
    protected Person _person;

    [TestInitialize]
    public virtual void Initialize()
    {
        this._person = new Person();
    }

    [TestMethod]
    public void PersonTestEnergy()
    {
        Assert.AreEqual(10, this._person.Energy);
    }

    [TestMethod]
    public void PersonTestAppleCount()
    {
        Assert.AreEqual(5, this._person.AppleCount);
    }
}

[TestClass]
public class PersonEatAppleTest : PersonTest
{
    [TestInitialize]
    public override void Initialize()
    {
        base.Initialize();

        this._person.EatApple();
    }

    [TestMethod]
    public void PersonEatAppleTestEnergy()
    {
        Assert.AreEqual(15, this._person.Energy);
    }

    [TestMethod]
    public void PersonEatAppleTestAppleCount()
    {
        Assert.AreEqual(4, this._person.AppleCount);
    }
} 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-07-17T17:15:52.637

我问了一位同事，他建议将初始化代码与测试分开。继承所有设置代码，然后将特定设置的所有测试放在从所述设置代码继承的类中。所以上面会变成：

```
public class Person
{
    public int Energy { get; private set; }

    public int AppleCount { get; private set; }

    public Person()
    {
        this.Energy = 10;
        this.AppleCount = 5;
    }

    public void EatApple()
    {
        this.Energy += 5;
        this.AppleCount--;
    }
}

[TestClass]
public class PersonSetup
{
    protected Person _person;

    [TestInitialize]
    public virtual void Initialize()
    {
        this._person = new Person();
    }
}

[TestClass]
public class PersonTest : PersonSetup
{
    [TestMethod]
    public void PersonTestEnergy()
    {
        Assert.AreEqual(10, this._person.Energy);
    }

    [TestMethod]
    public void PersonTestAppleCount()
    {
        Assert.AreEqual(5, this._person.AppleCount);
    }
}

[TestClass]
public class PersonEatAppleSetup : PersonSetup
{
    [TestInitialize]
    public override void Initialize()
    {
        base.Initialize();

        this._person.EatApple();
    }
}

[TestClass]
public class PersonEatAppleTest : PersonEatAppleSetup
{
    [TestMethod]
    public void PersonEatAppleTestEnergy()
    {
        Assert.AreEqual(15, this._person.Energy);
    }

    [TestMethod]
    public void PersonEatAppleTestAppleCount()
    {
        Assert.AreEqual(4, this._person.AppleCount);
    }
} 
```

如果其他人知道如何像我最初询问的那样跳过继承的方法，那么我会接受。如果不是，那么最终我会接受这个答案。

# .net - 如何使 Web 应用程序使用最新的 .net 框架？

> ID：11526963
> 
> 赞同：0
> 
> 时间：2012-07-17T16:36:25.683
> 
> 标签：.net, frameworks

我在 Windows 7 的本地主机上运行 Web 应用程序。我希望我的应用程序使用 .Net 3.5 版，但它使用的是 2.0.50727.4971 版。我使用命令“Environment.Version”通过代码确认了它。我检查了 C:\Windows\Microsoft.NET\Framework 文件夹，还有 3.0 版和 3.5 版的文件夹。我还在 Visual Studio 2008 中配置了我的项目属性以使用 3.5 版。请告诉我为什么我的应用程序使用版本 2.0.50727.4971？如何更改它以使用最新版本 3.5？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-07-17T16:38:05.137

在您的项目**设置中**，您可以将目标框架更改为 .NET 4.0（或您机器上可用的最新版本）

> 在项目菜单上，单击项目名称属性。
> 
> 单击编译选项卡。
> 
> 单击高级编译选项。
> 
> 在目标框架（所有配置）列表中，选择 .NET Framework 2.0、.NET Framework 3.0 或 .NET Framework 3.5。

[在此处](http://msdn.microsoft.com/en-us/library/bb772098%28v=vs.90%29.aspx)查看全文

对于**IIS7**，您需要更改应用程序或应用程序池设置。

1.  [为应用程序池指定 .NET Framework 版本 (IIS 7)](http://technet.microsoft.com/en-us/library/cc754523%28v=ws.10%29)
2.  [如何设置 IIS 应用程序或 AppPool 以使用 ASP.NET 3.5 而不是 2.0](http://www.hanselman.com/blog/HowToSetAnIISApplicationOrAppPoolToUseASPNET35RatherThan20.aspx)

# eclipse - 如何在 Eclipse Juno 中将文件加载到我当前的分离编辑器中？

> ID：11526965
> 
> 赞同：2
> 
> 时间：2012-07-17T16:36:28.643
> 
> 标签：eclipse, eclipse-juno

所以在哪个视图中打开一个新文件似乎很随机。我希望能够选择像“主视图”这样的东西，这将是我正在使用的当前分离编辑器，并在该视图中打开我的所有文件. 有谁知道如何做到这一点？

# ios - 提交给苹果的版本号错误

> ID：11526971
> 
> 赞同：5
> 
> 时间：2012-07-17T16:36:47.100
> 
> 标签：ios, app-store, version, app-store-connect

我一直在尝试向应用商店提交 1.7.1 版的应用更新。当我这样做时，我在验证时收到此错误

> 此捆绑包无效。Info.plist 文件中的键 CFBundleShortVersionString 必须包含比之前上传的版本更高的版本。

在组织者中删除我失败的尝试时，我注意到 1.7 更新已作为版本 17 提交！

答对了！

所以问题是这样的。

有没有办法解决这个问题？还是我现在卡在使用大于 17 的版本？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-07-20T14:48:20.763

现在您应该使用大于 17 的版本。您不应该就该问题联系 Apple。

# c# - 日期转换：从 LINQ 到 JSON 到 Javascript

> ID：11526974
> 
> 赞同：1
> 
> 时间：2012-07-17T16:36:57.420
> 
> 标签：c#, javascript, json, datetime, formatting

简而言之，在我的 API 控制器和使用结果的 Javascript 之间，一个 Date 被转换成一个可爱的`NaN`

我的问题是，有人建议我在哪里修复这条长链，也许如何修复。

**第 1 步：使用 LINQ 从数据库中检索对象**

```
return _dbContext.Points.Where(
    point => point.AccountId == account.AccountId)
    .OrderBy(point => point.EarnedOn).ToList(); 
```

在这里进行任何更改似乎都是不合理的。该模型指定了一个 DateTime 字段，因此我们在这里实际上没有与字符串进行任何交互。

**第 2 步：API 控制器发送响应**

```
var points = _pointRepository.GetByUserName(userName);
return Request.CreateResponse(HttpStatusCode.OK, points); 
```

我可以在这里指定如何解析日期吗？即使在服务器端处理也有意义吗？我想我可以遍历所有对象并手动设置它们，如下所示：

```
 for (var i = 0; i < points.Count(); i++ )
 {
     points.ElementAt(i).EarnedOn =  points.ElementAt(i).EarnedOn.ToUniversalTime();
 } 
```

但是谈论多个枚举！

**第三步：客户端将JSON数据解析为JS Object，然后将字符串中的Date解析为int** *，为了可读性大大缩短*

```
var points = JSON.parse(response);
for(i = 0; i < points.length; i++){
    var date = Date.parse(points[i].EarnedOn); 
```

在这一点上，我能做的只有这么多。我已经在第 2 步结束时将日期转换为字符串，而我所针对的浏览器根本不知道如何使用 C# 的默认`DateTime.toString`格式（我假设这是正在发送的内容）。在某些浏览器中它可以工作，在其他浏览器中我得到`NaN`.

对于冗长的解释感到抱歉，但如果有人能指出他们将在何处以及如何应用修复程序，我将不胜感激。

====更新====

有问题的浏览器是 Android 的股票浏览器。我已经在我的手机和 BlueStacks 模拟器上对此进行了测试。两者都是最新的，并且两者都不起作用。它确实在 Chrome 中工作。

当时的 JSON 输出（剔除所有其他数据）如下所示：

```
"EarnedOn":"2012-05-10T00:00:00" 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-07-17T17:14:04.000

如何将 .Net 中的 DateTime 转换为时间戳/秒。JavaScript 到日期对象的转换。但是，我还没有在移动浏览器上对其进行过测试，因此不能 100% 使用它。

```
DateTime myDateTime = new DateTime(2012, 01, 17, 9, 30, 0);

long ticks = (myDateTime - DateTime.Parse("01/01/1970 00:00:00")).Ticks;
ticks /= 10000000; //Convert ticks to seconds
var timestamp = ticks.ToString(); 
```

然后在 JavaScript 中，类似

```
secsToTime = function(theSecs)
{
    var date = new Date(theSecs*1000);
    // hours part from the timestamp

    var hours = date.getHours();
    // minutes part from the timestamp
    var minutes = date.getMinutes();
    // seconds part from the timestamp
    var seconds = date.getSeconds();

    // will display time in 10:30:23 format
    var formattedTime = hours + ':' + minutes + ':' + seconds;
    alert(formattedTime);
}

secsToTime(1326792600); 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-07-17T19:37:22.543

我最初说我会使用 Date.js，但谷歌搜索表明它自 2007 年以来就没有提交过，并且充满了错误。此外，它只是不太正常。

截至目前，我厌倦了寻找合适的解决方案，并在**Step 3**中使用以下 Javascript 代码。

```
function parseDate(date){
    var year = parseInt(date.substring(0,4));
    var month = parseInt(date.substring(5,7));
    var day = parseInt(date.substring(8,10));
    var hour = parseInt(date.substring(11,13));
    var minute = parseInt(date.substring(14,16));
    var second = parseInt(date.substring(17,19));
    return new Date(year, month, day, hour, minute, second);
}

for(i = 0; i < points.length; i++){
    var date = Date.parse(points[i].EarnedOn);
    ... 
```

这真的很丑陋，但它*是一个答案*，所以我把它放在这里。我真的希望有人能找到比这更优雅的东西。

# python - 在python中设置程序范围内的随机种子

> ID：11526975
> 
> 赞同：98
> 
> 时间：2012-07-17T16:36:58.823
> 
> 标签：python, random, seed

我有一个相当大的程序，我`random`在不同文件中使用模块中的函数。我希望能够在一个地方设置一次随机种子，以使程序始终返回相同的结果。这甚至可以实现`python`吗？

* * *

## 回答 #1

> 赞同：140
> 
> 时间：2012-07-17T16:38:43.820

运行的主要 python 模块应该`import random`和调用-只要其他地方不重置种子，`random.seed(n)`它就会在所有其他导入之间共享。`random`

* * *

## 回答 #2

> 赞同：48
> 
> 时间：2018-01-02T05:42:40.483

[zss](https://stackoverflow.com/a/11539965/2202107)的评论应突出显示为实际答案：

> 人们需要注意的另一件事：如果您正在使用 `numpy.random`，那么您需要使用`numpy.random.seed()`来设置种子。使用`random.seed()`不会为从 生成的随机数设置种子`numpy.random`。这让我困惑了一段时间。-zss

* * *

## 回答 #3

> 赞同：9
> 
> 时间：2012-07-17T16:44:32.723

在您的应用程序调用`random.seed(x)`开始时确保 x 始终相同。这将确保伪随机数的序列在应用程序的每次运行期间都是相同的。

* * *

## 回答 #4

> 赞同：4
> 
> 时间：2012-07-18T11:11:08.640

Jon Clements 几乎回答了我的问题。然而这不是真正的问题：事实证明，我的代码随机性的原因是 numpy.linalg SVD，因为它并不总是对条件差的矩阵产生相同的结果！

因此，如果您有同样的问题，请务必在您的代码中检查它！

* * *

## 回答 #5

> 赞同：3
> 
> 时间：2020-04-18T14:06:00.713

基于先前的答案：请注意，即使所有种子都受到控制，许多构造也可能会产生不同的执行路径。

我在想“*好吧，我设置了我的种子，所以它们总是相同的，并且我没有更改/外部依赖项，因此我的代码的执行路径应该总是相同的*”，但这是错误的。

咬我的例子是 `list(set(...))`，结果顺序可能不同。

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2020-11-30T10:10:43.237

一个重要的警告是，对于 3.7 之前的 python 版本，字典键不是确定性的。这可能导致程序中的随机性，甚至导致随机数生成的顺序不同，因此产生不确定的随机数。结论更新python。

* * *

## 回答 #7

> 赞同：0
> 
> 时间：2021-08-27T08:19:57.010

在复现一个深度学习项目的时候，我也对这个问题感到困惑。所以我做了一个玩具实验，把结果分享给大家。

我在一个项目中创建了两个文件，分别命名为`test1.py`和`test2.py`。在`test1`中，我`random.seed(10)`为`random`模块设置并多次打印 10 个随机数。正如您可以验证的那样，结果总是相同的。

怎么样`test2`？除了为模块设置种子外，我采用相同的方式`random`。每次显示的结果都不同。但是，只要我 import `test1`———即使不使用它，结果看起来与`test1`.

所以实验得出的结论是，如果要为项目中的所有文件设置种子，则需要导入定义和设置种子的文件/模块。

* * *

## 回答 #8

> 赞同：0
> 
> 时间：2021-12-23T07:50:22.893

根据乔恩的[回答](https://stackoverflow.com/a/11527011/14299805)`random.seed(n)`，在主程序的开头设置, 将全局设置种子。之后设置导入库的种子，可以使用`random.random()`. 例如，

```
rng = np.random.default_rng(int(abs(math.log(random.random()))))

tf.random.set_seed(int(abs(math.log(random.random())))) 
```

* * *

## 回答 #9

> 赞同：-15
> 
> 时间：2012-07-17T17:20:11.847

您可以使用自己的随机数生成器轻松保证这一点。

只需选择三个较大的素数（假设这不是密码学应用程序），并将它们插入 a、b 和 c： a = ((a * b) % c) 这给出了一个产生相当随机数据的反馈系统。请注意，并非所有素数都同样有效，但如果您只是在进行模拟，那应该没关系 - 大多数模拟真正需要的只是一堆具有足够复杂模式（伪随机，请记住）的数字它在某种程度上与您的应用程序不匹配。

Knuth 谈到了这一点。

# jquery - jquery“新功能”等效

> ID：11526978
> 
> 赞同：0
> 
> 时间：2012-07-17T16:37:11.383
> 
> 标签：jquery

是否有与此等效的jquery：

```
document.getElementById(cbxFieldID).onclick = new Function("hideUnhideRows('" + cbxFieldID + "','" + txtFieldID + "')"); 
```

基本上，我想为一个元素配置一个点击事件，并在运行时将 2 个参数传递给函数。
问题是无论单击的对象如何，都会传递相同的变量值。这是我正在使用的：

```
$(cbxFieldID).change(function () { 
   var $cbxField = $("#" + cbxFieldID);
   var $txtField = $("#" + txtFieldID);
   hideUnhideRows($cbxField,$txtField);
}); 
```

提前致谢，

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-07-17T16:39:37.327

传递给回调函数的参数是事件对象，包含有关事件或目标的任意信息。您可以通过以下方式访问目标`evt.target`：

```
$("#" + cbxFieldID).change(function (evt) { 
   alert(evt.target);
}); 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-07-17T16:40:00.647

```
 $('#cbxFieldID').click(function () { 
    var $cbxField = $("#" + cbxFieldID);
    var $txtField = $("#" + txtFieldID);
    hideUnhideRows($cbxField,$txtField);
 }); 
```

除非我错过了什么，否则这应该可以解决问题。在 jQuery 中，click 是一个可以绑定到任何元素的函数。在这里，我们对 ID 进行操作：`$('#cbxFieldID')`

# hibernate - 使用和/或一起休眠标准

> ID：11526979
> 
> 赞同：0
> 
> 时间：2012-07-17T16:37:15.360
> 
> 标签：hibernate, criteria

我需要为此 SQL 编写一个休眠条件：

```
select distinct USER_ID from USER_ROLE  
where USER_TERM_DT is null 
and ((ROLE_ID in (101,102) 
and STATE_ID in ('MD')) or ROLE_ID = 150) 
```

role_ids将具有**值**的组合 (101,102,150,151) OR 部分仅在 Role_Id 为 150 或 151 时才需要存在。

**USER_ROLE**表具有**Role_id**和**state_id**。只有角色 101 和 102 与 state_ids 相关联。

如果所有 4 个 role_id 值都存在，则 SQL 将类似于：

```
select distinct USER_ID from USER_ROLE  
where USER_TERM_DT is null 
and ((ROLE_ID in (101,102) 
and STATE_ID in ('MD')) or ROLE_ID in (150,151)) 
```

请帮助解决这个问题。我正在阅读我需要同时使用合取和析取，但只是无法提出正确的代码。希望很清楚，我的 SQL 是正确的。

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-07-17T16:50:14.480

像这样的东西应该可以工作 - 用相应的限制替换“is null”和“in”表达式

```
criteria.conjuction()
        .add(USER_TERM_DT is null )
        .add(criteria.disjuction().
                 add(
                   criteria.conjuction()
                            .add(ROLE_ID in (101,102) )
                            .add(STATE_ID in ('MD'))
                 )
                 .add(ROLE_ID in (150,151))
         ) 
```

# sql - 如何使用插入值更新表中的外键 - 同时在多行中

> ID：11526981
> 
> 赞同：0
> 
> 时间：2012-07-17T16:37:27.373
> 
> 标签：sql, postgresql

我想将表中的外键更新为来自新插入的值，其中该键当前为空。这里需要注意的是，INSERT 中的信息与表相关。

考虑这个例子：

1.  汽车有一个car_part
2.  car 和 car_part 都与 version_control 有关联（version_control 有一个 id，from_version，to_version，active）
3.  一些汽车目前有一个空版本控制。
4.  由于汽车有一个带有 version_control 的 car_part，我们本质上想为汽车创建一个新的 version_control，并使用与 car_part 的 version_control 相同的信息填充它

例如：

```
CAR
|id|car_part_id|version_control_id|
|1 |10         |                  |

CAR_PART
|id|version_control_id|
|10|100               |

VERSION_CONTROL
|id |from    |to         |
|100|1990    |2012       | 
```

对于上面的例子，我们想要：

1.  更新汽车1，
2.  添加与 version_control #100 具有相同信息的新 version_control

在实际示例中，有数百辆汽车，其中数十辆汽车的 version_control_id 为空，因此我们需要在单个查询中完成。

我们如何将下面的 PSEUDO 代码更改为解决此问题的有效 SQL？

```
UPDATE car
WITH inserted_version as (
    INSERT INTO version_control(
            id, active, from_version_id, to_version_id)
    WITH vc_to_create as (
        select c.id as car_id,vc.* from car c
        inner join car_part cp on cp.id = c.car_part_id 
        inner join version_control vc on cp.version_control_id=vc.id
        where c.version_control_id IS NULL
        )
    SELECT nextval('pk_entities'),vctc.active, vctc.from_version_id, vctc.to_version_id)
    FROM vc_to_create vctc
    RETURNING id
    )
SET version_control_id=(SELECT i_vc.id  FROM inserted_vc i_vc)
WHERE id=vc_to_create.car_id -->vc_to_create Not available here 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-07-17T18:12:35.933

听起来您想对事务块中的不同表进行两次修改。

这是一个开始。[http://www.postgresql.org/docs/9.1/static/tutorial-transactions.html](http://www.postgresql.org/docs/9.1/static/tutorial-transactions.html)

~~在进入事务之前，~~您*可能*还需要将事务隔离级别设置为 SERIALIZABLE 。请参阅[http://www.postgresql.org/docs/9.1/static/sql-set-transaction.html](http://www.postgresql.org/docs/9.1/static/sql-set-transaction.html)以了解我在说什么。

 ~~*如果我们不需要那么严格的隔离级别，请有人纠正我。不幸的是，我对哪些场景严格要求这种隔离级别的细节感到模糊。严格来说，这可能不需要那种隔离级别，尤其是取决于编写的 SQL，但是这听起来**可能**是那种情况。只是一个可能不必要的预警。*

编辑：

好的，您仍然不需要“在单个查询中”完成所有这些操作。严格来说，您只需要识别或跟踪刚刚插入的行。您应该可以为此使用临时表。那是：

1.  开始交易。
2.  将事务隔离级别设置为 SERIALIZABLE。（再次，*如果需要*，但坦率地说，如果我没有设置它，我会担心，除非另有证明。还要注意使用 SERIALIZABLE 你可能需要重试：[http ://www.postgresql.org/docs/9.1/interactive /transaction-iso.html#XACT-SERIALIZABLE](http://www.postgresql.org/docs/9.1/interactive/transaction-iso.html#XACT-SERIALIZABLE) )
3.  创建临时表作为（使用查询）您将插入到 version_control 的行以及与每个版本控制行相关的汽车的 ID。也就是说，每一行都会有版本控制信息和 id 信息。我们只需要抓住`nextval('pk_entities')`这里。
4.  将临时表中的数据插入到版本控制中（如前所述，我们已经生成了密钥）。
5.  使用临时表中的数据更新汽车。
6.  提交/删除表。（这显然可以在事务提交时通过在临时表的创建语句中声明它来完成。）

这是对我如何计划它的高/中级描述，由于我还没有明确地为此编写代码，我可能错过了一些东西。~~

# nservicebus - NServiceBus 与 Windows ServiceBus

> ID：11526982
> 
> 赞同：48
> 
> 时间：2012-07-17T16:37:33.327
> 
> 标签：nservicebus, servicebus, nservicebus3

有人能够阐明新发布的 Windows ServiceBus（内部部署，而不是 Azure）和 NServiceBus 之间的区别吗？

寻找 Windows SB 可能缺少的详细答案，因为我熟悉 NSERviceBus 可以做什么：

1.  它是真正的服务总线，而不仅仅是使用队列的消息代理吗？
2.  能支持消息多态吗？（消息子类化其他消息和支持此层次结构的处理程序
3.  长时间运行的进程和相关性
4.  向外扩展

* * *

## 回答 #1

> 赞同：39
> 
> 时间：2012-07-19T07:23:08.350

我负责 NServicebus 中的 Windows Azure ServiceBus 支持。在我看来，这个新的 Windows Server Servicebus 提供了与 Azure ServiceBus 完全相同的功能。所以在我看来，它将与 NServiceBus 而不是竞争对手（就像 Windows Azure ServiceBus 一样）很好地匹配，并且可以用来代替 msmq。

回答您的问题

1.  新的服务总线是使用队列的代理
2.  服务总线上的消息最终只是字符串，服务总线本身没有对消息类型、层次结构、处理程序等的额外支持。通常你会为此使用 WCF 或 NServiceBus。
3.  不支持长时间运行的进程或关联。它确实与 NServiceBus 有一些功能重叠，尽管它可以做订阅/主题，它也可以延迟消息和过滤器。
4.  它旨在向外扩展。

希望这可以帮助？

亲切的问候，伊夫

# java - 如何在 JTextPane 中实现要点？

> ID：11526992
> 
> 赞同：3
> 
> 时间：2012-07-17T16:38:00.473
> 
> 标签：java, swing, jtextpane, bulletedlist

我有`JTextPane`一个`StyledDocument`并`RTFEditorKit`实施了。

如何将项目符号（最好是多层次的）添加到`JTextPane`？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-07-17T16:43:38.540

好吧，它没有内置对此的支持，但是这里有一个很好的链接，其中包含有关在`JTextPane`and `JEditorPane`s 中创建项目符号和编号列表的教程：

*   [JEdi​​torPane/JTextPane 中的项目符号和编号。](http://java-sl.com/bullets_numberings.html)

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-07-17T19:41:53.133

想通了这样做：

```
HTMLEditorKit.InsertHTMLTextAction bulletAction = new HTMLEditorKit.InsertHTMLTextAction("Bullet", "<li> </li>", HTML.Tag.BODY, HTML.Tag.UL); 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2017-07-19T11:55:02.313

我知道这是一个老问题，但我所做的是：

```
private final Action ORDERED_LIST_ACTION = new HTMLEditorKit.InsertHTMLTextAction("ORDERED-LIST", "<ol> </ol>", HTML.Tag.BODY, HTML.Tag.OL);
private final Action UNORDERED_LIST_ACTION = new HTMLEditorKit.InsertHTMLTextAction("UNORDERED-LIST", "<ul> </ul>", HTML.Tag.BODY, HTML.Tag.UL);
private final Action LIST_ITEM_ACTION = new HTMLEditorKit.InsertHTMLTextAction("BULLET", "<li> </li>", HTML.Tag.UL, HTML.Tag.LI, HTML.Tag.OL, HTML.Tag.LI); 
```

当我将列表创建和项目符号创建作为单独的操作时，交互似乎工作得更好。

# python - 强制python http请求刷新

> ID：11526994
> 
> 赞同：2
> 
> 时间：2012-07-17T16:38:05.640
> 
> 标签：python, http, caching, web-scraping

我是 python 新手，还没有发现任何表明这可能很容易的东西。

我要报废的页面相当简单，但它每 2 分钟完全更新一次。我设法废弃了所有数据，但问题是即使程序每 2 分钟运行一次（我已经尝试通过 taskeng.exe 并在脚本中循环），它从网站中提取的 html 似乎每 12 分钟刷新一次分钟。为了清楚起见，我要报废的网站在更新时有一个时间戳。我的程序提取该标记（连同其他数据）并写入 csv 文件。但是它提取相同的数据 12 分钟，然后突然数据到达。所以输出看起来像：

```
16:30, Data1, Data2, Data3
16:30, Data1, Data2, Data3
...
16:30, Data1, Data2, Data3
16:42, Data1, Data2, Data3
16:42, Data1, Data2, Data3 
```

应该在哪里：

```
16:30, Data1, Data2, Data3
16:32, Data1, Data2, Data3
16:34, Data1, Data2, Data3
16:36, Data1, Data2, Data3
16:38, Data1, Data2, Data3
16:40, Data1, Data2, Data3
16:42, Data1, Data2, Data3 
```

我认为这与我这边的缓存有关。如何强制我的 http 请求完全刷新或强制 python 不将其存储在缓存中？

我正在使用 BeautifulSoup 和 Mechanize。我的http请求代码如下：

```
mech = Browser()

url = "http://myurl.com"

page = mech.open(url)

html = page.read()
soup = BeautifulSoup(html) 
```

如果它有助于发布我的所有代码，我可以这样做。提前感谢您的任何建议

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-07-17T16:52:27.600

您可以使用更简单的工具，例如[`requests`](http://docs.python-requests.org/en/latest/index.html).

```
import requests
response = requests.get(url)
html = response.text 
```

但是如果你真的想坚持使用 mechanize 你也可以跳过 Browser() 的东西（这可能会在你的请求中引入 cookie）。查看[机械化文档](http://wwwsearch.sourceforge.net/old/mechanize/doc.html)以获取更多详细信息。

```
response = mechanize.urlopen("http://foo.bar.com/")
html = response.read() # or readlines 
```

# c# - WCF 服务主机何时销毁自定义 IDispatchMessageInspector？

> ID：11526996
> 
> 赞同：2
> 
> 时间：2012-07-17T16:38:12.497
> 
> 标签：c#, wcf

我已经创建了 IDispatchMessageInspector 接口的自定义实现，并且我的代码运行良好 99%。

我的问题是，当 WCF 服务主机被杀死和/或释放我的类的实例时，我需要释放一些托管对象。我要释放的对象实现 IDisposable 但它们没有被处置。我已经浏览了 MSDN 库（更加困惑）和 SO 档案，但没有找到任何可以解决“WCF 服务主机何时/何处销毁 MessageInspectors？”这个问题的东西。

我需要在某个地方挂钩事件吗？我是否需要从 ServiceModel 命名空间实现更神秘的东西？

谁能给我一个正确方向的指针？

**编辑 1：澄清**

目前，我正在使用自动网络服务器在 IDE 中运行。一旦投入生产，我最终无法控制主机，可能是任何有效的服务器主机选择。

MyCore.My 和 MyCore.MyProperties 对象是我试图在 WCF 服务器主机被杀死/退回时处理的对象。

即使我杀死了网络服务器进程（任务栏中的那些东西），也永远不会调用 Dispose()。

**编辑 2：添加了代码片段。**

```
using /* snip */
using MyCore = Acme.My;

namespace My.SOAP
{
    public class MyMessageInspector : IDispatchMessageInspector
    {
        protected static MyCore.My _My;
        protected static MyCore.MyProperties _MyProps;
        protected static ConcurrentDictionary<string, MyCore.AnotherSecretThing> _anotherSecretThings = new ConcurrentDictionary<string, MyCore.AnotherSecretThing>();

        protected static void InitMy()
        {
            if (_My != null) return;

            _MyProps = new MyCore.MyProperties();
            MyCore.MySqlDatabaseLogger logger = new MyCore.MySqlDatabaseLogger(_MyProps);
            _My = new MyCore.My(logger);
        }

        public MyMessageInspector()
        {
            InitMy();
        }

        public object AfterReceiveRequest(ref System.ServiceModel.Channels.Message request,    System.ServiceModel.IClientChannel channel, System.ServiceModel.InstanceContext instanceContext)
        {
            MyMessageHeader header = null;
            try
            {
                // find My header
                Int32 headerPosition = request.Headers.FindHeader(MyMessageHeaderKey.MyHeaderElementName, MyMessageHeaderKey.MyNamespace);
                // get reader
                XmlDictionaryReader reader = request.Headers.GetReaderAtHeader(headerPosition);
                // get My header object
                header = MyMessageHeader.ReadHeader(reader);
                // add to incoming messages properties dictionary
                OperationContext.Current.IncomingMessageProperties.Add(MyMessageHeaderKey.MyHeaderElementName, header);
            }
            catch (Exception ex)
            {
                // log via ExceptionHandlingBlock
            }

            MyCore.SecretThings SecretThings = CreateSecretThings(/* snip */);
            return SecretThings.Id;
        }

        public void BeforeSendReply(ref System.ServiceModel.Channels.Message reply, object  correlationState)
        {
             MyCore.SecretThings req = _My.GetSecretThingsOnThread();
            // if we didn't find the SecretThings, there is nothing to stop() and no data to put in the MessageHeaders
            if (req == null) return;

            MessageBuffer buffer = reply.CreateBufferedCopy(Int32.MaxValue);
            reply = buffer.CreateMessage();

            var MyHeader = new MyMessageHeader(/* snip */);
            reply.Headers.Add(MyHeader);
            req.Stop(MyCore.Status.SUCCESS);
        }

        protected MyCore.SecretThings CreateSecretThings(string key, Dictionary<string, string> ids)
        {
            /* snip */
            return _My.GetSecretThings(/* snip */);
        }
    }
} 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-07-17T21:09:16.477

我一直在查看 DispatchMessageInspector 以及它是如何实现的。

您可能知道您使用 IEndpointBehavior 注册 MessageInspectors（通过配置或代码添加端点行为）。您在 EndpointBehaviour 中创建 DispatchMessageInspector 的实例。

```
 public class MyBehaviour : IEndpointBehavior
{     

    public void AddBindingParameters(ServiceEndpoint endpoint,
       System.ServiceModel.Channels.BindingParameterCollection
                                            bindingParameters)
    {
    }

    public void ApplyClientBehavior(ServiceEndpoint endpoint, ClientRuntime clientRuntime)
    {

    }

    public void ApplyDispatchBehavior(ServiceEndpoint endpoint, EndpointDispatcher endpointDispatcher)
    {
        var inspector = new SampleMessageInspector(); //register
        endpointDispatcher.DispatchRuntime.MessageInspectors.Add(inspector);
    }

    public void Validate(ServiceEndpoint endpoint)
    {
    }

} 
```

根据[http://msdn.microsoft.com/en-us/magazine/cc163302.aspx](http://msdn.microsoft.com/en-us/magazine/cc163302.aspx)端点行为由服务主机注册

> 这些行为集合会在 ServiceHost 和 ChannelFactory 构建过程中自动填充代码中（通过属性）或配置文件中的任何行为（稍后会详细介绍）。您还可以在构建后手动将行为添加到这些集合中。以下示例显示如何将 ConsoleMessageTracing 作为服务行为添加到主机：
> 
> ServiceHost host = new ServiceHost(typeof(ZipCodeService)); host.Description.Behaviors.Add(new ConsoleMessageTracing());

并进一步规定 ServiceHost 的生命周期与服务一样长...

> ServiceHost 扩展对象在 ServiceHost 的生命周期内保留在内存中，而 InstanceContext 和 OperationContext 扩展对象仅在服务实例或操作调用的生命周期内保留在内存中。您的自定义调度程序/代理扩展可以使用这些集合在整个管道中存储（和查找）用户定义的状态。

我假设这就是为什么您的 MessageInspectors 中的对象永远不会被破坏的原因。

有些人会认为它是一种反模式，但我可能会推荐一个 ServiceLocator，您的 MessageInspector 可以使用它来检索对象。然后你可以看看设置他们的生命周期，只要它的父母使用？

```
 public class SampleMessageInspector : IDispatchMessageInspector
{             

    public object AfterReceiveRequest(ref System.ServiceModel.Channels.Message request, IClientChannel channel, InstanceContext instanceContext)
    {
        var objectToDispose = ServiceLocator.Current.GetInstance<ObjectToDispose>();

        //do your work
        return null;
    }

    public void BeforeSendReply(ref System.ServiceModel.Channels.Message reply, object correlationState)
    {
        //do some other work
    }
} 
```

**继续我提到的...**

作为示例，这篇文章提到使用 Ninject 作为 IoC 容器，并将对象的生命周期设置为 WCF 服务的生命周期

> 绑定(...).To(...).InScope(() => OperationContext.Current)

[存储库上的 Ninject WCF 垃圾收集](https://stackoverflow.com/questions/7094896/ninject-wcf-garbage-collection-on-repositories#answers-header)

然后，您可以通过 ServiceLocator 访问 Ninject 内核，并且对象（_MyProperties 等...）将被处理掉

# javascript - 使用这个。在 javascript 对象定义中

> ID：11526997
> 
> 赞同：1
> 
> 时间：2012-07-17T16:38:14.860
> 
> 标签：javascript, object, properties, this, definition

因此，我对 Javascript 中的对象定义不熟悉，并且正在尝试编写一个将对象作为练习的程序。我的问题是，当我尝试定义对象时，某些对象属性依赖于对象的其他部分。我不确定这是否被允许，因为在我所有的搜索中我都找不到它的任何例子。

我的问题基本上是这样的：我可以使用先前定义的对象属性来定义该对象。最基本的例子是这样的：

```
var alfred = {
    dogs: 1,
    cats:this.dogs+1,
} 
```

这是允许的吗？如果是这样，这是正确的语法吗？我需要使用“this”的原因。是因为我将新创建的对象推送到对象数组中。我的代码不起作用如下：

```
obj.push({
    canvas:document.getElementById(canvasName),

    canvasName:"canvas"+objNum,
    image: img,
    width:objWidth,
    height:objHeight,
    centerX:posX,
    centerY:posY,
    speed:speeds,
    hypSquare:Math.sqrt((this.width*this.width)+(this.height*this.height)),
    angleInSquare:Math.atan(this.height/this.width),
    angle:startAngle,
    angleTotal:this.angle+this.angleInSquare,
    offX:(this.hypSquare* Math.cos(this.anglesTotal))/2,
    offY:(this.hypSquare* Math.sin(this.anglesTotal))/2,
    centeredX:this.centerX-this.offX,
    centeredY:this.centerY-this.offY,
}) 
```

当我打电话给

```
console.log(obj[objNum].hypSquare); 
```

（其中 objNum 只是数组中对象的索引）即使我调用，我也会得到 NaN

```
 console.log(obj[objNum].width); 
```

我将得到 objWidth 的值。仅仅是语法问题，还是我对对象的理解存在根本缺陷......

提前感谢您的宝贵时间！

艾萨克

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-07-17T16:40:36.997

不，你不能那样做。您必须关闭[对象初始化程序](http://ecma-international.org/ecma-262/5.1/#sec-11.1.5)，然后添加其他属性，例如：

```
var alfred = {
    dogs: 1
};
alfred.cats = alfred.dogs + 1; 
```

因此，对于您的`obj.push`调用，您必须使用临时变量（`alfred`如上），而不能只使用内联对象初始化程序。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-07-17T16:47:18.460

你不能这样做。但是，您可以使用对象构造函数。

```
function Person(canvasName, objNum) {
  this.canvas = document.getElementById(canvasName);

  this.canvasName = "canvas" + objNum;
  ...
  this.centeredY = this.centerY - this.offY;
}

obj.push(new Person("alfred", 3)); 
```

# perl - DBIx::Class 包装/重载列访问器

> ID：11526999
> 
> 赞同：3
> 
> 时间：2012-07-17T16:38:22.253
> 
> 标签：perl, accessor, catalyst, dbix-class

使用 DBIx::Class 我试图在更新或检索列的数据时对其进行操作。例如，在它进入数据库之前，我想对其进行加密，而每当它被访问时，我想对其进行解密。我在[DBIx::Class::Manual::Cookbook](https://metacpan.org/module/DBIx::Class::Manual::Cookbook#Wrapping-overloading-a-column-accessor)中关注这个例子，但是我似乎无法让它工作。我在我的用户模式中放置了以下内容。对于测试我只是使用名称列，我知道这没有意义：

```
__PACKAGE__->add_columns("name" => { accessor => '_name' });

sub name {
    my $self = shift;

    # If there is an update to the column, we'll let the original accessor
    # deal with it.
    if(@_) {
        return $self->_name('test 1');
    }

    # Fetch the column value.
    my $name = $self->_name;
    $name = 'test 2';
    return $name;
} 
```

我看不出我在做什么与食谱上说的有什么不同。谁能帮助我理解我做错了什么？谢谢！

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-08-10T12:18:00.317

DBIx::Class 有一个名为[FilterColumn](https://metacpan.org/module/DBIx%3a%3aClass%3a%3aFilterColumn)的组件。

CPAN 上有各种模块使用该组件，例如[DBIx::Class::EncodedColumn](https://metacpan.org/module/DBIx%3a%3aClass%3a%3aEncodedColumn)和[PassphraseColumn](https://metacpan.org/module/DBIx%3a%3aClass%3a%3aPassphraseColumn)。

如果您告诉我们您的用例是什么，我们可能会给您更多/更好的建议。