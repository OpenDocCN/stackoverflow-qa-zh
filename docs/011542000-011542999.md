# StackOverflow 问答 11542000-11542999

# java - 将服务器端 Java 连接到 iOS 应用程序的前端 Javascript

> ID：11542001
> 
> 赞同：0
> 
> 时间：2012-07-18T13:00:03.007
> 
> 标签：java, javascript, ios, sencha-touch-2, server-side

我正在使用 Sencha Touch 2.0 为 iOS 编写一个 Web 应用程序，并且主要在前端使用 Javascript，但是我计划使用 Sencha 将应用程序“打包”到几乎是本机应用程序中。

我需要访问服务器上的 java 代码 - 一些函数用于查询数据库，另一个用于运行条形码扫描仪。对于车码扫描仪，我还需要向服务器传递一张从 iOS 库中获取的图片。

我对这两种语言都很陌生，需要在基本层面上具体说明如何连接数据库，然后运行这些 java 函数，将图片发送到数据库，并将结果（字母数字）返回到 javascript。非常感谢！

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-07-18T14:35:06.547

对于 java 到数据库，您可以考虑使用 JDBC、JPA 或 ORM，如 Hibernate。您不一定需要将图形存储在数据库中 - 您可以将其保存在文件系统中并通过数据库简单地指向它。java 服务器可以通过 AJAX（使用 JSON 格式）与 javascript UI/前端进行通信 - 您可以考虑使用 socket.io 之类的东西（使用 Web 套接字并退回到 Flash 套接字/长轮询）从 UI - 你可以也可以调用 getJSON 来调用服务器上的 Java 代码。

使用 JQuery 的示例调用（您不需要使用 Jquery - 这仅供参考）。在这种情况下，表单提交（可以是任何其他操作）在服务器端对“登录”进行后调用 - 可以在服务器端解析序列化数组（JSON 格式）。这仅供参考 - 您可以从任何客户端进行 JSON 调用并在服务器上处理它（注册一个成功回调，当服务器响应消息时将调用该回调）。

```
var v = jQuery("#login").validate({
    submitHandler: function(form) {
var data =  $.toJSON(jQuery('#login').serializeArray()); {
var ajaxResponse = $.ajax({
type: "post",
url: "login",
contentType: "application/json",
data: data,
timeout: 5000,
  success: function(data) {
if ($.parseJSON(data).indexOf("Invalid") == -1) {
jQuery('#displayResponse').html($.parseJSON(data));
} 
```

# java - Eclipse 安卓配置问题

> ID：11542003
> 
> 赞同：2
> 
> 时间：2012-07-18T13:00:10.997
> 
> 标签：java, android, xml, eclipse

我今天早上一直在 Eclipse 中设置`Android SDK`和设置，我`ADT Plugin`在构建 android 应用程序时的前几个测试运行良好。

但是现在我开始每次点击某些内容时都会弹出一个窗口`AN ERROR HAS OCCURED - JAVA.NULLPOINTER.EXCEPTION`。

我了解 Java 中的空指针异常是在创建某些内容但我什至没有输入任何代码但它只是当您单击新项目时由应用程序创建向导创建的标准 mainactivity 类。

当我运行该程序时，问题就开始了，它似乎有问题`Activity_mainlayout.out.xml`或任何问题。

任何人都知道为什么会发生这种情况，而且我还没有开始编写我的应用程序。

一些细节：Eclipse 使用 Android ADT 插件和带有 Android 虚拟设备的 Android SDK 进行测试。

多谢你们。

Ps 我在 Windows 资源管理器和 Eclipse 中删除了该项目，因此完全摆脱了它，现在任何新项目都会产生相同的弹出错误。

* * *

这是 MainActivity 的代码

```
package wag.cymal.libraryportal.welshlibraries;

import android.os.Bundle;
import android.app.Activity;
import android.view.Menu;
import android.widget.LinearLayout;
import android.graphics.*;
import android.graphics.drawable.Drawable;

@SuppressWarnings("unused")
public class MainActivity extends Activity {

@Override
public void onCreate(Bundle savedInstanceState) {
    super.onCreate(savedInstanceState);
    setContentView(R.layout.activity_main);

    LinearLayout ll = new LinearLayout(this);
    ll.setBackgroundResource(R.drawable.natlib); // background image
    this.setContentView(ll);
}

@Override
public boolean onCreateOptionsMenu(Menu menu) {
    getMenuInflater().inflate(R.menu.activity_main, menu);
    return true;
} 
```

}

以及 activity_main XML 文件：

```
<RelativeLayout xmlns:android="http://schemas.android.com/apk/res/android"
xmlns:tools="http://schemas.android.com/tools"
android:layout_width="match_parent"
android:layout_height="match_parent" >

<TextView
    android:layout_width="wrap_content"
    android:layout_height="wrap_content"
    android:layout_centerHorizontal="true"
    android:layout_centerVertical="true"
    android:padding="@dimen/padding_medium"
    android:text="@string/hello_world"
    tools:context=".MainActivity" /> 
```

有任何想法吗？：/

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-07-18T13:45:46.000

当您在 xml 文件中尝试运行应用程序时，会创建“sctivity_mainlayout.out.xml”。据我了解，编译器尝试编译 xml 文件，这会生成 .out.xml 文件，该文件不是有效的 xml，这会导致错误。

解决方案：删除 .out.xml 文件，并且始终在运行时注意编辑器的焦点在 java 文件中（或没有）...

现在，如果由于某种原因您的 Eclipse 被搞砸了，请尝试使用选项 --clean 运行它（使用命令行，或者在 Windows 的情况下，也可以使用“执行”选项 ->“ `c:\mypathtoeclipse\eclipse.exe --clean`”）。这使得 eclipse 本身被重建。就我而言，它已经修复了几次我在工作区加载期间遇到的一些无法解释的意外异常。

# extjs - extjs中的编辑位置问题

> ID：11542007
> 
> 赞同：1
> 
> 时间：2012-07-18T13:00:21.450
> 
> 标签：extjs, extjs4, extjs4.1

我正在尝试为面板提供 Ext.Editor 以内联编辑面板的标题。

```
 var editor = new Ext.Editor({
            updateEl: true,
            ignoreNoChange: true,
            revertInvalid: true,
            width: 235,
            field: {
                xtype: 'textfield',
                allowBlank: false
            }
        });

        editor.startEdit(myPanel,myData.value); 
```

但编辑器显示为 0,0 位置，而不是我预期的面板上。如何解决这个编辑职位问题？

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-11-20T23:04:08.317

隐藏绑定元素似乎存在问题，导致位置回落到 0,0。设置`hideEl: false`来解决这个问题。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-12-13T15:09:03.090

我的面板嵌套在其他一些面板中，并且也存在一些布局问题。更正布局问题后，它工作正常。

# c - scanf() 中的 %*c - 这是什么意思？

> ID：11542010
> 
> 赞同：9
> 
> 时间：2012-07-18T13:00:23.830
> 
> 标签：c, scanf

我试图在 Turbo C 中运行这个程序，但无法破译输出。这是什么`%*c`意思？任何帮助，将不胜感激。

```
int dd,mm,yy;
printf("\n\tEnter day,month and year");
scanf("%d %*c %d %*c %d",&dd,&mm,&yy);  // what does %*c mean ?
printf("\n\tThe date is : %d %d %d",dd,mm,yy); 
```

**输出**

```
Enter day, month and year 23
2
1991
3
5
The date is: 23 1991 5 
```

* * *

## 回答 #1

> 赞同：11
> 
> 时间：2012-07-18T13:02:56.983

`*`格式中的意思`scanf()`是“读取数据但不将其分配给参数列表中的变量”。在上下文中，这意味着您可以键入：

```
18/07/2012 
```

并正确解释日 (18)、月 (7) 和年 (2012)。格式字符串中的空格很重要，也很复杂。通常，`%c`读取下一个字符，甚至是空格，但`%*c`转换说明符周围的空格处理空格，因此代码需要使用非空白字符。

因此，当您键入时观察到的行为：

```
23 2 1991 3 5 
```

2（单独）被第一个消耗，`%*c`3（单独）被第二个消耗。

这是标准 C，而不是 Turbo C 的特殊功能（问题的第一版已指定，但自从我第一次写这个答案以来，该问题已被编辑以删除对 Turbo C 的引用）。

* * *

## 回答 #2

> 赞同：5
> 
> 时间：2012-07-18T13:03:38.997

格式字符串中的`*`after`%`表示与格式匹配的输入将被忽略（因此无需传递指向变量的指针来存储您不会使用的匹配值）。

* * *

## 回答 #3

> 赞同：3
> 
> 时间：2012-07-18T13:03:48.860

这意味着忽略下一个字符，例如空格、`/`或`-`书面日期中常见的 a。

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2012-07-18T13:14:14.473

使用`*`with`scanf`抑制分配。随后的转换结果将被丢弃。

# javascript - 如何通过 Firebreath 在 XUL 中调用 javascript？

> ID：11542012
> 
> 赞同：2
> 
> 时间：2012-07-18T13:00:39.767
> 
> 标签：javascript, firefox-addon, npapi, firebreath

我在 XUL 中为我的 firefox 扩展编写了一些 javascript。这个覆盖有一些清理功能，我希望能够通过我通过 Firebreath 创建的 NPAPI dll 调用该函数。

我知道 Firebreath 有一个通过执行以下操作调用“警报”功能的示例：

```
// Retrieve a reference to the DOM Window
    FB::DOM::WindowPtr window = m_host->getDOMWindow();

    // Check if the DOM Window has an alert peroperty
    if (window && window->getJSObject()->HasProperty("window")) {
        // Create a reference to alert
        FB::JSObjectPtr obj = window->getProperty<FB::JSObjectPtr>("window");

        // Invoke alert with some text
        obj->Invoke("alert", FB::variant_list_of("This is a test alert invoked from an NPAPI Plugin"));
    } 
```

上面的代码有效，所以我修改了 Invoke 来调用我的 javascript 函数。

```
obj->Invoke("cleanupCode", FB::variant_list_of("0")); 
```

这不起作用，并且让我对应该如何调用我的 javascript 函数感到困惑。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-07-19T09:55:54.353

您的 DOM 外观如何？window 是否包含名为 cleanupCode 的函数？也许你可以用萤火虫检查它。

# jquery - jQuery 中的 fn 代表什么？

> ID：11542017
> 
> 赞同：0
> 
> 时间：2012-07-18T13:00:57.190
> 
> 标签：jquery

我知道 jQuery.fn 只是 jQuery.prototype 的别名，但“fn”代表什么？它有全名吗？

例如，“正式名称”？“正式命名空间”？我不知道。

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-07-18T13:11:52.083

`fn`如**功能**。_ **_**

它也是需要函数的形式参数的名称：

```
// Bind a function to a context, optionally partially applying any
// arguments.
proxy: function( fn, context ) { 
```

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-07-18T13:03:47.623

`jQuery.fn`只是 jQuery.prototype 的别名（这样可以节省我们编写此类代码`jQuery.fn.init.prototype = jQuery.fn = $.fn`的时间）。

如果您还记得`prototypes`JavaScript 对象中的函数，那么这将是完全有意义的。

记住，`JQuery`它本身就是一个对象。
这篇[文章](http://www.jquery4u.com/jquery-functions/5-ways-declare-functions-jquery/#.UAa2zaPNkao)可以帮助你更好地理解。

# asp.net - .net - 更改模板列的可见性

> ID：11542020
> 
> 赞同：0
> 
> 时间：2012-07-18T13:01:08.153
> 
> 标签：asp.net, datagridtemplatecolumn

我正在使用 VS2010 中的 Web 应用程序。我想根据网页上按下的按钮来更改模板列的可见性。这就是我目前正在做的事情：

```
<asp:TemplateColumn >
    <ItemTemplate>
        <asp:LinkButton id="hlArchive" runat="server" ToolTip="ARCHIVE" 
                        Text="A" CommandName="Archive" CausesValidation="false" 
                        Visible="False">
            </asp:LinkButton>
   </ItemTemplate>
</asp:TemplateColumn> 
```

但是，这会在屏幕上留下一个小桌子。这样做可以摆脱空表：

```
<asp:TemplateColumn Visible="False"> 
```

但由于没有 ID 字段，我无法弄清楚如何在适当的时候更改代码中的可见性。有没有类似的东西可以让我这样做？

```
hlArchive.Visible=true; 
```

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-07-18T13:14:20.593

你试试这个

```
 // mn is your datagrid ID and set the Index of the column
  mn.Columns[0].Visible = true; 
```

我尝试了上面的代码，它可以工作。

# php - 如何更新将+1添加到所有ActiveRecord选定行中的字段

> ID：11542022
> 
> 赞同：0
> 
> 时间：2012-07-18T13:01:12.673
> 
> 标签：php, mysql, activerecord, phpactiverecord

我有这样的代码：

```
 $ads = Ad::find('all', array('order' => 'select_visits desc', 'limit' => 20, 'conditions'=>array('active = 1'))); 
```

我想将所有 $ads、select_visits 字段更新为 select_visits+1，我该怎么做？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-07-18T15:04:35.540

一种简单的方法（activerecord 方法）是查看查找器的结果，更改并保存它们，但这是非常低效的。

我会使用直接的 SQL 语句，使用 Connection 类，如下所示：

```
Ad::connection()->query('UPDATE ads SET select_visits=select_visits+1 WHERE active=1;'); 
```

# objective-c - Ocunit - 创建单例测试类以在类之间共享代码

> ID：11542026
> 
> 赞同：2
> 
> 时间：2012-07-18T13:01:35.910
> 
> 标签：objective-c, unit-testing, singleton, ocunit

我刚开始为我的代码编写单元测试用例。在写作时，我只是吸收了许多测试用例类正在使用一些公共代码，并且它需要在类之间有一个公共变量。

所以我决定创建一个单例类来保存所有这些值。在其中这个单例类将通过 sentesting 继承。

所以在这里我的问题是可以创建一个单例测试类。?

注意：我创建了一个单例，但它根本不起作用。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-07-20T01:14:38.147

OCUnit 与其他 xUnit 框架共享相同的架构。要运行测试用例，它

1.  实例化一个测试用例对象。（它通常被称为“测试夹具”，其中夹具具有在多个测试中有用的其他对象的 ivars。）
2.  调用设置
3.  运行一种特定的测试方法
4.  调用tearDown

对于您想要的公共变量，将其定义为 ivar。然后在`-setUp`. 如果之后需要显式清理，请在`-tearDown`.

避免在测试之间共享对象非常重要，因为每个测试都应该有自己一致的通过/失败行为。共享对象会污染这一点，从而在您的测试之间创建潜在的依赖关系。由于单例是共享对象的常用方式，因此它们通常与单元测试策略相悖。

有关使用 Objective-C 或 Swift 在 Xcode 中进行单元测试（特别是测试驱动开发）的分步示例，请参阅[https://qualitycoding.org/tdd-kata/](https://qualitycoding.org/tdd-kata/)

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-07-19T07:03:24.717

是的，在这里我发现我们**无法**创建一个继承 sentesting 的单例类。

我们只能创建继承自 NSObject 的单例。

# c++ - 如何在 C++ 中设置 WMI？

> ID：11542029
> 
> 赞同：-2
> 
> 时间：2012-07-18T13:01:45.413
> 
> 标签：c++, winapi, visual-c++, wmi, wmi-service

我正在尝试使用 WMI 获取正在运行的服务的进程。但我对如何使用 WMI 感到困惑。

我认为使用这种方法可以工作 [http://msdn.microsoft.com/en-us/library/system.serviceprocess.servicecontroller.servicename%28v=vs.71%29](http://msdn.microsoft.com/en-us/library/system.serviceprocess.servicecontroller.servicename%28v=vs.71%29)

但是我不知道如何设置 WMI 才能使用它

我知道我需要这样做，但不知道从那里去哪里

```
 HRESULT hres(CoInitializeEx(NULL, COINIT_MULTITHREADED));
     // Set general COM security levels
hres = CoInitializeSecurity(
    NULL,
    -1,                             // COM authentication
    NULL,                           // Authentication services
    NULL,                           // Reserved
    RPC_C_AUTHN_LEVEL_DEFAULT,      // Default authentication
    RPC_C_IMP_LEVEL_IMPERSONATE,    // Default Impersonation
    NULL,                           // Authentication Info
    EOAC_NONE,                      // Additional capabiliteis
    NULL                            // Reserved
    ); 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-07-18T23:28:28.880

[EnumServicesStatusEx](http://msdn.microsoft.com/en-us/library/windows/desktop/ms682640.aspx)将为您（除其他外）提供所有活动服务的 ProcessId。将其与当前进程的 ID 进行比较以找到匹配的 ID。除了 ProcessID，您还将获得每个服务的两个名称：服务名称和显示名称。我不确定你想要*哪*一个，但大概是两者之一。

# android - 在服务器 web 服务调用不工作

> ID：11542036
> 
> 赞同：3
> 
> 时间：2012-07-18T13:02:09.663
> 
> 标签：android, web-services, cordova

我正在使用**android-phonegap**开发应用程序。
当我调用托管在我的电脑上的 web 服务时，它工作正常。
但是当我将它部署在 ssl 服务器上时，我没有得到任何输出。
我的代码是：

```
function CallService() {

        $.ajax({
            type: "GET",
            url: "http://devpc4:5566/Service1.asmx/GetItems",
    dataType: "json",
    data: "{}",
            contentType: "application/json; charset=utf-8",
            success: OnSuccess,
            error: OnError
        });
    } 
```

谁能帮我？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-07-18T13:07:31.317

检查日志。在设备和您的服务器上

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2015-02-28T18:03:02.057

您必须在您的服务器上添加一些标头，这将允许您从其他服务器调用 Web 服务。

我的意思是说，当您的网络服务托管在一台服务器上并且您从另一台服务器调用它时，您的服务器可能不允许这样做。

所以你必须在你的服务器上添加一些“标题权限”

# jakarta-ee - 寻找 xalan TransformerFactoryImpl 的选项

> ID：11542038
> 
> 赞同：2
> 
> 时间：2012-07-18T13:02:15.863
> 
> 标签：jakarta-ee, xml-parsing, sax, saxparser, xalan

我正在使用基于 SAX 的 xml 解析器，一切正常，但我在日志中收到以下警告消息

 `````
com.sun.org.apache.xalan.internal.xsltc.trax.TransformerFactoryImpl is Sun proprietary API and may be removed in a future release 
                            transformerFactory = new TransformerFactoryImpl(); 
                                                      ^ 
````  `我想摆脱这个，有人可以建议我 TransformerFactoryImpl 的其他选择吗？

提前致谢，

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-07-18T17:45:59.283

您可以改用 TransformerFactory.newInstance() ：

```
javax.xml.transform.TransformerFactory tf =       
        javax.xml.transform.TransformerFactory.newInstance(); 
```

[Javadocs](http://docs.oracle.com/javase/6/docs/api/javax/xml/transform/TransformerFactory.html#newInstance%28%29)中说明了它如何确定要加载的实现。

如果重要的是要注意在您当前使用的幕后实现完全相同，只需在获取 TransformerFactory 实例之前设置以下系统属性。我假设使用相同的实现很方便，只要您摆脱错误消息。

```
System.setProperty("javax.xml.transform.TransformerFactory",          
                   "com.sun.org.apache.xalan.internal.xsltc.trax.TransformerFactoryImpl"); 
`````

# java - 比较 Calendar 和 java.util.date 日期

> ID：11542039
> 
> 赞同：2
> 
> 时间：2012-07-18T13:02:26.547
> 
> 标签：java, date

嗨，我正在使用以下方法创建日历实例：

```
Calendar calendarDate=Calendar.getInstance();
            calendarDate.set(2012, 6, 1,0,0,0);
                Date date1=calendar.getTime(); 
```

之后，我使用以下方法创建 java.util.date 的实例：

```
Date date2=new Date(2012 - 1900,7-1, 01); 
```

现在，当我尝试使用以下代码比较日期时：

```
System.out.println(date2.compareTo(date1));
System.out.println(date1.compareTo(date2)); 
```

它打印 -1 和 1 而不是 0（零）。
**谁能帮我找出问题所在？**

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-07-18T13:07:24.377

尝试在设置新日历之前清除日历的值。这将解决您的问题。

```
Calendar calendarDate=Calendar.getInstance();
calendarDate.clear();
calendarDate.set(2012, 6, 1,0,0,0); 
```

测试它：

```
import java.util.Calendar;
import java.util.Date;

import org.junit.Assert;

public class DateTest {

    @org.junit.Test
    public void test() {
        Calendar calendarDate=Calendar.getInstance();
        calendarDate.clear();
        calendarDate.set(2012, 6, 1,0,0,0);
        Assert.assertEquals(0, calendarDate.getTime().compareTo(new Date(2012 - 1900,7-1, 01)));
    }

} 
```

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-07-18T13:32:22.447

日期和日历类是不同的。java.util.Date 的大多数方法都已弃用。因此最好使用 Calender 类。有关方法的更多信息，请查看以下网址。 [http://docs.oracle.com/javase/1.5.0/docs/api/java/util/Calendar.html](http://docs.oracle.com/javase/1.5.0/docs/api/java/util/Calendar.html)

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-07-18T13:05:42.417

[http://docs.oracle.com/javase/1.4.2/docs/api/java/util/Date.html#compareTo(java.lang.Object](http://docs.oracle.com/javase/1.4.2/docs/api/java/util/Date.html#compareTo(java.lang.Object) )

相比于

返回： 如果参数是与此日期相等的日期，则值为 0；如果参数是此日期之后的日期，则值小于 0；如果参数是此日期之前的日期，则值大于 0。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2012-07-18T13:05:31.303

日期为 GMT，除非使用不推荐使用的构造函数。这里会有区别，因为您还需要将毫秒设置为 0。

```
Calendar calendarDate=Calendar.getInstance(TimeZone.getTimeZone("GMT"));
calendarDate.set(2012, Calendar.JULY, 1,0,0,0);
calendarDate.set(Calendar.MILLISECOND, 0);
Date date1 = calendarDate.getTime();
Date date2=new Date(2012 - 1900,7-1, 1, 1, 0, 0);
System.out.println(date1);
System.out.println(date2);
System.out.println(date2.compareTo(date1));
System.out.println(date1.compareTo(date2)); 
```

印刷

```
Sun Jul 01 01:00:00 BST 2012
Sun Jul 01 01:00:00 BST 2012
0
0 
```

注意：日历将保留您未设置的任何字段，因此第一个 set() 将保持毫秒不变。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2012-07-18T13:06:26.267

date1 在哪里创建？您似乎认为 Calendar 和 Date 是相关的。他们不是。

# delphi - Delphi：（Indy）发送一个标题记录，后跟一个文件

> ID：11542040
> 
> 赞同：1
> 
> 时间：2012-07-18T13:02:28.750
> 
> 标签：delphi, tcp, stream, record, indy

我目前正在尝试使用 Indy 在 TCP 之上编写自定义更高级别的协议。本质上，我想通过（使用流）发送一条记录，但这条记录可以表明要遵循的 x 字节将是一个图像文件。

因此，当服务器接收到记录时，如果它的内容表明它后面有图像，则需要将记录和图像数据分开。

```
var
Segment: TDPPSegment;
Segment2: TDPPSegment;
Buffer: TIdBytes;
Buffer2: TIdBytes;
Mem: TMemoryStream;
begin
if (Client.Connected) then begin

Segment.NameStr := 'Adrian';
Segment2.NameStr := 'Jon';

Mem := TMemoryStream.Create;
Mem.Write(Segment, SizeOf(Segment));
Mem.Write(Segment2, SizeOf(Segment2));

//The Size of the stream is 8 bytes here!
Client.IOHandler.Write(Mem, 0, False); 
```

结尾;

为了模拟“图像文件”，我只想连续发送两条记录；这就是目标。请注意，我一次发送整个内存流（！），而不是逐条记录。但有趣的是，服务器运行了两次 OnExecute 事件！

```
var
Buffer: TIdBytes;
Segment: TDPPSegment;
Mem: TMemoryStream;
begin
Mem := TMemoryStream.Create;
AContext.Connection.IOHandler.ReadStream(Mem, SizeOf(TDPPSegment), False);

//Incoming stream size is FOUR bytes but TWICE!
Mem.Position := 0;
Mem.Read(Segment, SizeOf(TDPPSegment));
Showmessage(Segment.NameStr); 
```

我希望它执行一次，所以将来我可以先读取标题记录（已知大小），然后查看要遵循的内容/是否有任何内容并采取相应的行动..

帮助将不胜感激！

感谢阅读，阿德里安

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-07-18T17:16:31.440

您的记录中包含非 ShortString 字符串，这一点从字符数据占用的字节数大于写入流中的字节数就可以看出——这意味着指针值 (2 x SizeOf(Pointer))正在写入流而不是实际字符。因此，您必须手动序列化您的字符串，例如发送字符串长度后跟实际字符。如果您计划支持 Delphi 2009+，则必须考虑 Unicode，因此您应该在传输之前对字符串进行编码，然后在接收端对其进行解码。

记录对于组织内存中的数据很有用，但对于通过网络传输数据通常不是很有用，除非记录仅包含 POD 类型（并且字符串不符合此条件）。

试试这个：

```
procedure WriteStrToIO(IO: TIdIOHandler; const S: String);
var
  Buf: TIdBytes;
  Len: Integer;
begin
  Buf := ToBytes(S, IndyUTF8Encoding);
  Len := Length(Buf);
  IO.Write(Len); 
  if Len > 0 then IO.Write(Buf); 
end;

var 
  Len: Integer;
  Buf: TIdBytes; // or whatever you want to use...
begin 
  if Client.Connected then
  begin 
    WriteStrToIO(Client.IOHandler, 'Adrian');

    Buf := ...; // secondary data
    Len := Length(Buf);
    Client.IOHandler.Write(Len);
    if Len > 0 then
      Client.IOHandler.Write(Buf);

    ...
  end;
end; 
```

.

```
var 
  NameStr: String; 
  Buf: TIdBytes;
begin   
  with AContext.Connection.IOHandler do
  begin
    NameStr := ReadString(ReadInteger, IndyUTF8Encoding); 

    // read secondary data ...
    ReadBytes(Buf, ReadInteger);
  end;

  // ShowMessage() is not thread-safe!
  Windows.MessageBox(0, PChar(NameStr), 'NameStr', MB_OK); 
end; 
```

至于`OnExecute`事件被多次触发，那是正常的行为。该事件根本与数据传输无关。它在连接的生命周期内连续循环调用。退出事件处理程序后，如果客户端仍处于连接状态，则会立即再次触发它。这对于像您这样的基于消息的协议很有用，其中事件被触发，读取一条消息等待数据到达，退出，再次触发以读取下一条消息等待数据到达，等等。

# c# - 只需一次启动应用程序 C#

> ID：11542045
> 
> 赞同：-1
> 
> 时间：2012-07-18T13:02:36.943
> 
> 标签：c#, forms, single-instance

我只是在 C# 中制作了一个应用程序，但我不喜欢。我想让应用程序只运行一次。现在，如果我的应用程序正在运行，当我再次运行该应用程序时，将启动另一个应用程序。我想让应用程序只能运行一次，如果你想再次运行应用程序，不是创建另一个应用程序，而是启动正在运行的应用程序。

谢谢。

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-07-18T13:06:44.010

请检查这个问题：[Run single instance of an application using Mutex](https://stackoverflow.com/questions/819773/run-single-instance-of-an-application-using-mutex)

您正在寻找`Mutex`检查您的应用程序是否正在运行。然后找到您正在运行的应用程序`Process`并将其向前推进。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-07-18T13:07:08.653

我实现这一目标的方法是使用`Mutex`. 应用程序的每个实例都尝试在启动时锁定互斥锁。如果他们成功了，他们就可以跑；如果他们失败了，他们不会。

无法运行的应用程序也会恢复并激活正在运行的实例。这取决于它是 WPF 还是 WinForms 应用程序，实现方式不同。

互斥体方法的优点是它比使用 FindWindow 更不容易出现竞争条件。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-07-18T13:05:54.713

当您的应用程序启动时，您必须查看您的应用程序实例是否已经运行的进程，然后根据它做出决定。

可能的重复：

[使用 C# .net 检测进程已在 Windows 中运行](https://stackoverflow.com/questions/187915/detecting-a-process-is-already-running-in-windows-using-c-sharp-net)

[如何在 c#.net 中检查已经运行的 exe？](https://stackoverflow.com/questions/2182385/how-to-check-already-running-exe-in-c-net)

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2012-07-18T13:06:37.240

您所指的概念是“单实例应用程序”。这通常是通过命名的等待对象来实现的，看看[这篇文章](http://blogs.microsoft.co.il/blogs/maxim/archive/2010/02/13/single-instance-application-manager.aspx)，或者[这篇](http://iridescence.no/post/creatingasingleinstanceapplicationinc.aspx)文章。

# javascript - 使用 JQuery / JavaScript 检索单元格/列值

> ID：11542046
> 
> 赞同：1
> 
> 时间：2012-07-18T13:02:48.213
> 
> 标签：javascript, jquery, html

我有以下表格，它利用了 Google Visualization API：

```
<html>
  <head>
    <script type='text/javascript' src='https://www.google.com/jsapi'></script>
    <script type='text/javascript'>
      google.load('visualization', '1', {packages:['table']});
      google.setOnLoadCallback(drawTable);
      function drawTable() {
        var data = new google.visualization.DataTable();
        data.addColumn('string', 'Name');
        data.addColumn('number', 'Salary');
        data.addColumn('boolean', 'Full Time Employee');
        data.addRows([
          ['Mike',  {v: 10000, f: '$10,000'}, true],
          ['Jim',   {v:8000,   f: '$8,000'},  false],
          ['Alice', {v: 12500, f: '$12,500'}, true],
          ['Bob',   {v: 7000,  f: '$7,000'},  true]
        ]);

        var table = new google.visualization.Table(document.getElementById('table_div'));
        table.draw(data, {showRowNumber: true});
      }
    </script>
  </head>

  <body>
    <div id='table_div'></div>
  </body>
</html> 
```

我想知道的是，当我单击一个单元格时如何：

1.  返回该单元格所在的列索引？
2.  返回列标题的名称 ?
3.  如何返回该特定单元格的值？

如果我弄清楚如何做其中至少一项，那么我的问题就会得到解决。它已经避开了我很多。谢谢

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-07-18T13:26:12.417

证明：http: [//jsfiddle.net/iambriansreed/43yAy/](http://jsfiddle.net/iambriansreed/43yAy/)

通过行/列检索：

```
var r = 1; // second row (zero based index)
var c = 2; // third column (zero based index)

$('#table_div tr:eq('+r+') td:eq('+c+')').text(); 
```

点击TD：

```
$('#table_div').on('click', 'td', function(){    
    $(this).text();
}); 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-07-18T13:23:33.543

这是一种获取单击单元格值的方法（使用 jQuery）。

```
<body>
<div id='table_div'></div>
<script>
function getTD() {
  $('#table_div td').click(function(){
    var val = $(this).html();
    alert(val);
  });
}
setTimeout('getTD()', 2000);
</script>
</body> 
```

使用 setTimeout() 来确保在执行 jQuery 代码时添加表。

# asp.net - 在谷歌地图上使用标记制作不同的组/层

> ID：11542047
> 
> 赞同：0
> 
> 时间：2012-07-18T13:02:51.620
> 
> 标签：asp.net, google-maps

我刚开始使用 Google Maps API，但我通过 asp.net 控件使用它[http://googlemap.codeplex.com/](http://googlemap.codeplex.com/)

但我有点怀疑，我是否可以创建可以放置标记的类别/图层（某种集合），然后为每个类别设置一个复选框来显示/隐藏它，或者我应该在代码中这样做在后面

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-07-18T13:19:21.317

当然，一切皆有可能！:-) 这个混搭有按品牌分组的快餐店：

[http://gis5.com/pois_along_route/gm_pois_along_route.php](http://gis5.com/pois_along_route/gm_pois_along_route.php)

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-07-18T13:35:32.133

是的，这是可能的。

您可以在 JavaScript 中创建包含特定“层”所需的所有点的不同数组，然后根据按下的单选按钮添加数组。

看看这个[天鹰](http://robinsone.com/skyhawk)

# ios - iOS 上的原生闹钟通知

> ID：11542048
> 
> 赞同：1
> 
> 时间：2012-07-18T13:02:52.210
> 
> 标签：ios, native, clock, alarm

我目前正在为 iPhone 部署一个应用程序，我想知道当本机时钟的闹钟响起时，该应用程序是否可以收到通知（当它在后台暂停时），以便可以将应用程序触发到前台。如果这不可能，是否有任何方法可以检索有关本地闹钟的预定时间和日期的信息。我一直在互联网上搜索这个问题，但我找不到关于这个问题的任何答案。感谢您的帮助！

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-07-18T14:41:35.287

您绝对无法访问本机时钟，因此这是不可能的。

您可以开发自己的时钟应用程序并触发*UILocalNotification*。当用户当前正在做一些其他事情（不运行您的应用程序）时，他有机会滑动并进入您的应用程序，您可以在其中放置您的特定信息。

# javascript - 使用 Jasmine 测试主干模型

> ID：11542051
> 
> 赞同：4
> 
> 时间：2012-07-18T13:02:56.560
> 
> 标签：javascript, backbone.js, jasmine

这是我第一次为 Backbone 模型编写 JavaScript 测试。
在网络资源中查看有关此主题的项目并不多。
我发现了这个，[Testing Backbone applications with Jasmine and Sinon](http://tinnedfruit.com/2011/03/25/testing-backbone-apps-with-jasmine-sinon-2.html)，它很老了（mars 2001）。

无论如何我想知道：
1）关于这个主题还有其他资源更多更新
2）我写的文字（1）很好或可以改进。

* * *

(1)

```
describe('User model', function () {
    beforeEach(function () {
        this.model = new User();
        this.collection = new UserCollection();
    });

    describe('When creating models', function () {
        it('the url should be equal at corresponding api_get_users value', function () {
            expect(this.model.url()).toEqual(backendRouter.generate('api_get_users'));
        });

        describe('when no id is set', function () {
            it('should return the collection URL', function () {
                expect(this.model.url()).toEqual(this.collection.url);
            });

        });
        describe('when id is set', function () {
            it('should return the collection URL and id', function () {
                this.model.set({id: 1});
                expect(this.model.url()).toEqual(this.collection.url + '/' + this.model.get('id'));
            });
        });

    });

    describe('when fetching model from server', function () {
        beforeEach(function () {
            this.model.set({id: 1});
            this.fixture = this.fixtures.Users.valid;
            this.fixtureResponse = this.fixture.response.users[0];
            this.server = sinon.fakeServer.create();
            this.server.respondWith(
                'GET',
                backendRouter.generate('api_get_users') + '/' + this.model.get('id'),
                JSON.stringify(this.fixtureResponse)
            );
        });

        afterEach(function () {
            this.server.restore();
        });

        it('should make the correct request', function () {
            this.model.fetch();
            expect(this.server.requests.length).toEqual(1);
            expect(this.server.requests[0].method).toEqual('GET');
            expect(this.server.requests[0].url).toEqual(this.model.url());
        });

        it('should the response not change', function () {
            this.model.fetch();
            this.server.respond();
            expect(this.fixtureResponse).toEqual(this.model.attributes);
        });

        it('should exhibit mandatory attributes', function () {
            expect(this.model.get('id')).toBeGreaterThan(0);
        });
    });

}); 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-07-18T19:22:00.853

也许 SO 不适合进行代码审查，请查看[https://codereview.stackexchange.com/](https://codereview.stackexchange.com/)。一些注意事项：

```
describe('when id is set', function () {
    it('should return the collection URL and id', function () {
        this.model.set({id: 1});
        expect(this.model.url()).toEqual(this.collection.url + '/' + this.model.get('id'));
    });
}); 
```

您应该测试`this.collection.url + '/' + 1`，因为这是您要发送到服务器的内容。也许你以后会改变`get`你的模型的功能，测试会通过，但结果不是你所期望的。

```
it('should make the correct request', function () {
        this.model.fetch();
        expect(this.server.requests.length).toEqual(1);
        expect(this.server.requests[0].method).toEqual('GET');
        expect(this.server.requests[0].url).toEqual(this.model.url());
    }); 
```

这个测试毫无意义，因为您只是测试 Backbone 功能，希望由 Backbone 人员进行测试。其他 2 个测试相同。只要您不在模型中使用魔法，测试默认的 Backbone 功能就没有任何意义。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-07-18T13:27:16.663

没有人比[Justin Searls](https://stackoverflow.com/users/108159/justin-searls)更好地涵盖茉莉花测试：

[https://speakerdeck.com/u/searls/p/confidencejs](https://speakerdeck.com/u/searls/p/confidencejs)

是一个例子，但请查看他的其他演示文稿以及他的 github repo for [jasmine-given](https://github.com/searls/jasmine-given)

# git - Ubuntu 上的 Gitolite：没有给出管理员密钥

> ID：11542053
> 
> 赞同：9
> 
> 时间：2012-07-18T13:03:03.333
> 
> 标签：git, ubuntu, gitolite

我在 Hyper-V 上的 Ubuntu Server 12.04LTS（15 日下载并安装）上安装了我称之为“香草”的东西。

Ubuntu 似乎一切正常。合成网卡很棒。未检测到问题。

我的计划是使用 Gitolite 将其用作中央 GIT 存储库。

我正确安装了 SSh（至少我认为这是因为我可以“ `ssh myaccount@mydomain.com`”。

密钥是在我的 Mac 终端上生成并复制的。那工作得很好。

我的问题是，当我尝试安装 Gitolite 时，出现以下错误：

```
 No adminkey given - not setting up gitolite. 
```

这些是我用来执行安装的命令：

```
sudo apt-get install git-core
sudo apt-get install gitolite 
```

我也试过这个：

```
sudo apt-get install git-core

sudo adduser \
  --system \
  --shell /bin/bash \
  --gecos 'git version control' \
  --group \
  --disabled-password \
  --home /home/git \
git

sudo apt-get install gitolite 
```

...相同的结果

一些版本信息：

```
Git core: 1:1.7.9.5-1
Gitolite: 2.2-1
Ubuntu: 12.04 
```

有任何想法吗？
Gitolite 真的可以在 Ubuntu 12.04 上运行吗？

* * *

## 回答 #1

> 赞同：57
> 
> 时间：2012-07-19T17:48:56.670

是的，当您第一次通过 apt-get 安装 gitolite 时，将显示错误，因为安装程序没有要求您提供 gitolite 管理员公钥。然后，设置完成后，您可以运行该命令`sudo dpkg-reconfigure gitolite`，它会提示您提供：

1.  gitolite 将使用的用户
2.  该用户用于存储其所有文件的目录（gitolite 配置、gitolite 托管存储库等）
3.  （也是最重要的）用户的公钥，该用户将成为 gitolite 中的第一个管理员，您可以输入公钥（只需一行开头`ssh-rsa`或包含公钥的文件的路径）

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-07-18T13:05:48.057

您需要在安装中提供您的个人公钥（用于连接到盒子本身的那个）。我不知道使用 apt 时它是如何工作的，但是 gitolite 文档很广泛，应该包含您需要的信息。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-07-18T16:06:18.230

如果您使用帐户 ' ' 安装 gitolite，您能够使用您的帐户进行 ssh 与 gitolite 无关`git`。

如果你`/home/git`用来管理 git，那么你需要在那里生成一个公钥/私钥（`/home/git/.ssh`），并希望 apt-get 进程完成`gitolite setup -pk "${H}/.ssh/id_rsa.pub"`gitolite 安装的一部分。

...或者您可以手动将其安装在您选择的目录中：[这就是我所做](https://github.com/VonC/compileEverything/blob/master/gitolite/install_or_update_gitolite.sh)的。

同样，对 Git 服务器的所有 ssh 访问都将以用户 ' `git`' 的身份完成（并使用之前在 Gitolite 中注册的用户的公钥）。

是的，gitolite 在 Ubuntu12.04 上运行得很好。

* * *

## 回答 #4

> 赞同：-6
> 
> 时间：2012-07-18T13:06:15.203

我觉得包裹可能坏了。

您最好从源代码安装它。

尝试遵循本教程： http: [//www.bigfastblog.com/install-gitolite-to-manage-your-git-repositories](http://www.bigfastblog.com/install-gitolite-to-manage-your-git-repositories)

repo 本身的官方文档也建议从源代码安装： [https ://github.com/sitaramc/gitolite](https://github.com/sitaramc/gitolite)

# php - 如何将字符串引用转换为变量

> ID：11542056
> 
> 赞同：1
> 
> 时间：2012-07-18T13:03:19.657
> 
> 标签：php, mysql

我想`$masking_x`充当`$masking_y`（即动态插入`$radiovalue`但仍充当变量）。

我的代码是

```
while($field_radio = mysql_fetch_assoc($result_radio)) {
    $radiovalue = $field_radio[radiovalue];
    echo "Radio value: ".$radiovalue."</br>";   
    $masking = "field_masking[checkbox_1001_".$radiovalue."]";
    $masking_x = '$'.$masking;
    $masking_y = "$field_masking[checkbox_1001_2]";
    echo "Masking: ".$masking."</br>";
    echo "Masking_x: ".$masking_x."</br>";
    echo "Masking_y: ".$masking_y."</br>";
    die; 
```

我得到以下输出：

```
Radio value: 2
Masking: field_masking[checkbox_1001_2]
Masking_x: $field_masking[checkbox_1001_2]
Masking_y: 2 
```

任何指导将不胜感激。提前致谢。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-07-18T13:09:34.597

您使用的[变量变量](http://php.net/manual/en/language.variables.variable.php)略有错误。试试这个：

```
$radiovalue = $field_radio['radiovalue'];
echo "Radio value: ".$radiovalue."</br>";   
$masking_x = "field_masking['checkbox_1001_".$radiovalue."']";
$masking_y = "field_masking['checkbox_1001_2']";
echo "Masking_x: ".$$masking_x."</br>";
echo "Masking_y: ".$$masking_y."</br>"; 
```

双美元符号必须在代码中，而不是在字符串中。

也可以这样做：

```
$radiovalue = $field_radio['radiovalue'];
echo "Radio value: ".$radiovalue."</br>";   
echo "Masking_x: ".${"field_masking['checkbox_1001_".$radiovalue."']"}."</br>";
echo "Masking_y: ".${"field_masking['checkbox_1001_2']"}."</br>"; 
```

另请注意，我在您的字符串中添加了单引号以正确引用用于数组键的字符串，关联数组键这些是常规字符串，应该这样引用。

**然而**，重要的是要注意变量变量很少是给定问题的正确解决方案。通常可以使用[数组](http://php.net/manual/en/language.types.array.php)或[引用](http://php.net/manual/en/language.references.php)来提出更好的东西。

**编辑**

在玩弄它之后，当键定义在字符串中时，您似乎不能使用变量变量来引用数组键。这是一件非常可怕的事情，我从来没有遇到过这个限制，我并不感到惊讶。

总而言之，你不能完全按照你想做的事情去做，对你来说最好的解决方案可能是使用引用来代替：

```
$radiovalue = $field_radio['radiovalue'];
echo "Radio value: ".$radiovalue."</br>";   
$masking = &$field_masking['checkbox_1001_'.$radiovalue];
echo "Masking: ".$masking."</br>";
$masking = "A different value";
echo "Masking: ".$masking."</br>";
// Original value has been updated as well
echo "\$field_masking['checkbox_1001_'.\$radiovalue]: ".$field_masking['checkbox_1001_'.$radiovalue]."</br>"; 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-07-18T13:27:05.117

如果要动态访问数组变量，请将其分成两部分，单个变量将不起作用。

```
$name = 'field_masking';
$key = 'checkbox_1001_'.$radiovalue;

echo $$name[$key]; 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-07-18T13:11:50.887

看看[变量变量](http://php.net/manual/en/language.variables.variable.php)。请注意，如果您使用用户输入，这是一个潜在的安全风险。

在你的情况下：`$masking_x = $$masking;`

# jquery - Django + jQuery：为什么 CSRF 验证在多个同时请求时失败

> ID：11542059
> 
> 赞同：4
> 
> 时间：2012-07-18T13:03:26.547
> 
> 标签：jquery, django, csrf, django-csrf

我遇到了以下我想了解的情况（使用 Django1.4 和 jQuery 1.7.1）：我通过 jQuery 'ajax' 函数提交了一个表单，在此请求完成之前，我单击了另一个提交相同表单的元素，但是使用 jQuery 的“提交”功能。我得到的响应 - 403，CSRF 验证失败。现在，当然，为了防止这个错误，禁用多个同时提交就足够了（它们自己工作正常），但这无助于理解特定错误的来源。

谁能解释一下？每个会话生成一次 csrf 令牌，因此对于后一个请求，它不会是某种 csrf 不匹配。这与 jQuery 处理请求的方式有关吗？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-07-23T21:36:39.237

我认为你的代码有问题。只需阅读 django 代码

* * *

在此块中捕获错误。

```
if not constant_time_compare(request_csrf_token, csrf_token):
            logger.warning('Forbidden (%s): %s',
                           REASON_BAD_TOKEN, request.path,
                extra={
                    'status_code': 403,
                    'request': request,
                }
            )
            return self._reject(request, REASON_BAD_TOKEN) 
```

所以你前端脚本发送 csrf_token 和 cookie（发送浏览器）不相等

* * *

下一个代码工作

tpl

```
<!DOCTYPE html>
<html>
<head>
    <meta charset="utf-8">
</head>
<body>

<a href="javascript:" class="req1">req1</a>
<a href="javascript:" class="req2">req2</a>
<br>

<form id="foo" action="" method="POST">{% csrf_token %}
    {{ form.as_p }}
    <input type="submit">
</form>
<script type="text/javascript" src="//ajax.googleapis.com/ajax/libs/jquery/1.7.2/jquery.min.js"></script>
<script type="text/javascript">
    $(document).ready(function(){

        $('.req2').click(function(){
            var form1 = $.post( '', $('#foo').serialize(), function(data){console.log(data)} );
        })

        $('.req1').click(function(){
            var form1 = $.post( '', $('#foo').serialize(), function(data){console.log(data)} );
        })
    })
</script>
</body>
</html> 
```

看法

```
from django import forms
from django.http import HttpResponse

from django.shortcuts import render
from django.views.decorators.csrf import csrf_protect

class TestForm(forms.Form):
    test_field = forms.CharField()

@csrf_protect
def home(request):
    if request.method == 'POST':
        form = TestForm(request.POST)
        if form.is_valid():
            return HttpResponse('all ok')
    else: form = TestForm()

    return render(request,
        'page.html',
            {
            'form': form,
             },
    ) 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-08-27T12:56:11.087

问题已解决 - 我错过了负责 ajax 调用的 js 脚本在 beforeSend 函数中的表单输入（包括 csrf 令牌）上设置了“禁用”属性的事实 - 这种禁用的属性不会在 POST 中发送。

# rest - 用于查询和命令操作的 REST URI 模板

> ID：11542064
> 
> 赞同：6
> 
> 时间：2012-07-18T13:03:37.203
> 
> 标签：rest, asp.net-web-api

我们有一个应用程序，它分为两部分：

1.  管理员 - 更改数据的位置
2.  公共 - 读取数据的位置

我正在考虑创建一个 REST API 来提供此功能。很容易看出如何表示 CRUD 操作，但我不确定单个资源上的特定操作（命令）。例如，`Project`我们发送一个“PublishCommand”来“发布”。我们不会将`Project`其`Published`属性设置为`true`.

同样，我有点困惑，我们应该如何表示更高级的资源查询操作而不被归类为 RPC 类型服务。

下面我列出了我的`Project`资源的 URI 模板。我是否走上了创建真正 RESTful API 的正确轨道？

```
ADMIN API
---------

// Project Resources
GET /projects -- get all projects
POST /projects -- create a new project

// Project Resource
GET /projects/10 -- get project with id 10
PUT /projects/10 -- update project with id 10
DELETE /projects/10 -- delete project with id 10

// Project Resource Operations
POST: /projects/10/publish -- publish project with id 10
POST: /projects/10/unpublish -- unpublish project with id 10
POST: /projects/10/setposition/2 -- move to position 2 in projects list

// Project Sub resources (identity is local to project)
POST: /projects/10/media -- adds media to project with id 10
PUT: /projects/10/media/5 -- updates media id 5 for project id 10
DELETE: /projects/10/media/5 -- deletes media id 5 from project id 10

PUBLIC API
----------

GET: /projects -- gets all projects (with default limit e.g. first 10)
GET: /projects?skip=10&take=10 -- gets projects 11 to 20
GET: /projects/tagged/rest OR /taggedprojects/rest -- gets projects tagged with "REST"
GET: /projects?orderbydesc=publishdate OR /latestprojects -- gets latest projects

GET: /projects/10 -- gets project with id 10 
```

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-07-18T13:59:24.103

我不认为 REST 旨在仅代表 CRUD 操作。您的界面对我来说看起来不错，我相信您走在正确的轨道上。

网上有个关于 DDD 和 REST 的讨论：[RESTful SOA 还是领域驱动设计 - 妥协？](http://www.infoq.com/presentations/RESTful-SOA-DDD)通过沃恩弗农。

**更新**以包括我在下面发表的评论：

您可以使用 GET 查询您的读取模型。要改变您的域，您可以 PUT 或 POST 到表示命令的资源。这将提供超越 CRUD 的域模型的丰富性，并且仍然使用 HTTP 的固有语义。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-07-18T13:15:09.647

如果您将发布视为一种资源，那么您可以使用 CRUD (POST/GET/PUT/DELETE)：

*   POST 创建发布，传递项目 id
*   删除以取消发布
*   GET 检索

这并不意味着该过程必须与数据库中记录的物理创建相关联。重要的是**基于资源的方法**。

# java - Skype 开始拨号并在 2 秒后挂断 - Android

> ID：11542070
> 
> 赞同：6
> 
> 时间：2012-07-18T13:03:47.723
> 
> 标签：java, android, android-intent, skype

我在两台设备上安装了`Skype`( )。第一个设备带有 Android 2.2，第二个带有 4.04。`2.8.0.920``Android`

当我通过执行以下代码发起呼叫时...

```
Intent skype_intent = new Intent("android.intent.action.CALL_PRIVILEGED"); 
skype_intent.setClassName("com.skype.raider", "com.skype.raider.Main");   
skype_intent.addFlags(Intent.FLAG_ACTIVITY_NEW_TASK);                  
skype_intent.setData(Uri.parse("tel:PassportCard"));                 
act.startActivity(skype_intent); 
```

...Skype 开始拨号*并*在 2 秒后挂断。

但是，如果我将当前 ( `2.8.0.920`) Skype 版本替换为*以前*的.

为什么是这样？有什么帮助吗？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-07-30T06:37:30.353

这是我找到的解决方案；

```
In Java file:
Intent iskype = new Intent("android.intent.action.VIEW"); 
iskype.setData(Uri.parse("skype:PassportCard")); 
act.startActivity(iskype);

In AndroidManifast.xml
<intent-filter> 
      <category android:name="android.intent.category.DEFAULT" />
      <action android:name="android.intent.action.VIEW" />                     
      <data android:scheme="skype" /> 
</intent-filter> 
```

# android - 从布局中心向左对齐 ImageView 10dp

> ID：11542073
> 
> 赞同：1
> 
> 时间：2012-07-18T13:03:50.157
> 
> 标签：android, android-layout, android-imageview

嗨，我想定位一个距布局中心 10dp 的 ImageView。请建议我这样做。我正在使用相对布局。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-07-18T13:12:37.323

尝试以下：

```
<RelativeLayout xmlns:android="http://schemas.android.com/apk/res/android"
        android:layout_width="fill_parent"
        android:layout_height="fill_parent" >

        <ImageView
            android:id="@+id/imageView1"
            android:layout_width="wrap_content"
            android:layout_height="wrap_content"
            android:layout_centerHorizontal="true"  //   <--Sets to Horizontally center 
            android:layout_centerVertical="true"    //   <--Sets to Vertically center
            android:paddingRight="10dp"    //   <---  Sets space of 10dp at rigth, so displays to left
            android:src="@drawable/ic_launcher" />

</RelativeLayout> 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-07-18T13:08:38.083

你有没有试过这个：

```
 android: marginLeft="10dp" 
```

此外，您应该阅读以下内容：

[相对布局 - Developer.android.com](http://developer.android.com/guide/topics/ui/layout/relative.html)

# java - sun.org.mozilla.javascript.internal.NativeJavaObject 不能转换为 java.lang.String

> ID：11542075
> 
> 赞同：0
> 
> 时间：2012-07-18T13:03:52.410
> 
> 标签：java, javascript, rhino, javax.script

我正在使用 java 6 javax.script 功能，但我有一个问题：

在调用 ScriptEngine.eval() 方法之前，我将一些属性添加到 ScriptContext：

```
scriptContext.setAttribute("Utils", utils, ScriptContext.ENGINE_SCOPE); 
```

在我调用的脚本中：

```
var s = utils.getMyString() 
```

Java getMyString() 方法返回一个字符串 (java.lang.String)。

scriptContext 中“s”的类型是 sun.org.mozilla.javascript.internal.NativeJavaObject ，它包装了 Java String 实例。

当我尝试从 Java 的上下文中获取属性时：

```
(String) scriptContext.getAttribute("s"); 
```

我有

```
 java.lang.ClassCastException:
 sun.org.mozilla.javascript.internal.NativeJavaObject cannot be cast to java.lang.String 
```

当我在脚本中写：

```
var s = "hello world" 
```

或者

```
var s = "" + utils.getMyString() 
```

或者

```
var s = String(utils.getMyString()) 
```

一切都很好，因为这些是 JavaScript 字符串，可以通过内部转换从 scriptContext 中获取。

我认为 NativeJavaObjects 从 scriptContext 释放时应该被解包（参见 sun.org.mozilla.javascript.internal.Wrapper.unwrap()）。

那么，这是一个错误吗？我对 java7u5 有同样的问题。

我不相信我必须这样做：

```
var s = String(utils.getMyString()) 
```

将 Java 字符串转换为 JavaScript 字符串，以便能够将其作为 Java 字符串返回...

谢谢你的观点。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-09-06T23:01:14.957

问题似乎类似于：[https](https://stackoverflow.com/questions/11814010/javascript-rhino-java-float-method-returns-number-or-object) ://stackoverflow.com/questions/11814010/javascript-rhino-java-float-method-returns-number-or-object 和 [Rhino Javascript：如何将 Object 转换为 Javascript 原语？](https://stackoverflow.com/questions/1579777/rhino-javascript-how-to-convert-object-to-a-javascript-primitive)

但在你的情况下，我相信：

```
Context.enter().getWrapFactory().setJavaPrimitiveWrap(false); 
```

将抛出 NullPointerException。您使用 JDK javax.script 中的 Rhino，而 ScriptEngine.eval 方法包装了所有处理上下文（进入、退出上下文等）的操作，因此如果您在 eval 之前调用上述代码，可能无法初始化 rhino 上下文（进入方法将上下文分配给当前线程）。

解决方案可能是直接从org.mozilla中使用Rhino并直接处理上下文： 在进入上下文时[链接并调用上面的代码。](https://developer.mozilla.org/en-US/docs/Rhino/Embedding_tutorial)

当我使用 JDKs ScriptEngine 并使用 Rhino 形式的 mozilla 解决它时，我遇到了类似的问题（以及其他问题）。

# erlang - 尝试 - 在 Erlang 中使用 spawn_link 捕获

> ID：11542078
> 
> 赞同：2
> 
> 时间：2012-07-18T13:04:02.363
> 
> 标签：erlang, spawn, erlang-shell

我是二郎的新手。现在，我正在学习流程的链接。在接下来的实验之后我有点困惑：

```
3> process_flag( trap_exit, true ).
false
4> try 1+1, spawn_link( unknown_module, unknown_function, [] ) of
4> Pid -> Pid
4> catch
4> _:_ -> err
4> end.
<0.37.0>
5> 
=ERROR REPORT==== 18-Jul-2012::16:01:32 ===
Error in process <0.37.0> with exit value: {undef,[{unknown_module,unknown_function,[],[]}]}

5> 
5> flush().
Shell got {'EXIT',<0.37.0>,{undef,[{unknown_module,unknown_function,[],[]}]}}
ok 
```

正如我所料，我从创建的进程中获得了 Pid，并且该进程失败了 - 因为未知的模块和功能 - 所以我收到了关于它的消息。

之后我尝试了下一个：

```
6> try spawn_link( unknown_module, unknown_function, [] ) of     
6> Pid -> Pid
6> catch
6> _:_ -> err
6> end.
** exception error: no try clause matching <0.40.0> 
```

而且我不明白为什么解释器进程无法提取 Pid 并失败

谢谢

附言

简而言之：为什么下一个代码会破坏解释器进程（** 异常错误：没有匹配 <0.40.0> 的 try 子句）

```
try spawn_link( unknown_module, unknown_function, [] ) of     
   Pid -> Pid
catch
   _:_ -> err
end. 
```

以及为什么这段代码不会破坏解释器进程（返回 <0.37.0>）

```
try 1+1, spawn_link( unknown_module, unknown_function, [] ) of     
   Pid -> Pid
catch
   _:_ -> err
end. 
```

？？？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-07-18T13:38:31.477

哦...我忘记了变量 Pid 已经与值绑定（在调用第一个 try-catch 块之后）。所以我需要的只是解除绑定变量 Pid。调用口译员`f(Pid).`- 解决了我的问题

# iphone - ios从字节数组创建pdf

> ID：11542079
> 
> 赞同：0
> 
> 时间：2012-07-18T13:04:03.770
> 
> 标签：iphone, ios, ipad, pdf

我想从字节流（我从 wsdl 接收）创建一个 pdf，我已经在 NSArray 上插入了这个字节流，但我不知道如何编写 pdf。（这个字节流是pdf）谢谢！

```
 //to convert NSData to pdf
                NSData *data = [NSKeyedArchiver archivedDataWithRootObject:arrayOfByte];

                CFDataRef myPDFData  = (__bridge_retained CFDataRef)data;
                CGDataProviderRef provider = CGDataProviderCreateWithCFData(myPDFData);
                CGPDFDocumentRef pdf   = CGPDFDocumentCreateWithProvider(provider);

                NSArray *docDirectories = NSSearchPathForDirectoriesInDomains(NSDocumentDirectory, NSUserDomainMask, YES);
                NSString *docDirectory = [docDirectories objectAtIndex:0];
                NSString *fileName = [docDirectory stringByAppendingPathComponent:@"abcd.pdf"];

                [data writeToFile:fileName atomically:NO]; 
```

但我收到：未能找到 PDF 标题：找不到“%PDF”。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-07-18T13:43:28.387

要从有符号的 8 位字符数组中获取数据字节，您可以执行以下操作：

```
NSArray *bytes = ...;

NSMutableData *data = [[NSMutableArray alloc] initWithCapacity:bytes.count];
for (NSNumber *byteVal in bytes) {
    Byte b = (Byte)(byteVal.intValue);
    [data appendBytes:&b length:1];
} 
```

这应该可以，但是如果`data`在解析 JSON 时直接填充对象，效率会更高。

然后您可以使用以下命令将字节写入文件：

```
NSArray *docDirectories = NSSearchPathForDirectoriesInDomains(NSDocumentDirectory, NSUserDomainMask, YES);
NSString *docDirectory = [docDirectories objectAtIndex:0];
NSString *fileName = [docDirectory stringByAppendingPathComponent:@"abcd.pdf"];

[data writeToFile:fileName atomically:NO]; 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-07-18T13:30:55.667

如果真的是字节数组，要么编码成字符串转成`NSData`对象，要么直接存入`NSData`对象。从那里开始，CoreGraphics 包含用于创建和操作 PDF 文件的本机函数。

```
//to convert NSData to pdf
NSData *data     = [NSData dataWithBytes:(void)wdslBytes length:sizeOf(wdslBytes)];
CFDataRef myPDFData  = (CFDataRef)data;
CGDataProviderRef provider = CGDataProviderCreateWithCFData(myPDFData);
CGPDFDocumentRef pdf   = CGPDFDocumentCreateWithProvider(provider); 
```

# asp.net - 在 ASP .NET 中托管时，如何在 WCF 中设置网络命名管道的名称？

> ID：11542080
> 
> 赞同：1
> 
> 时间：2012-07-18T13:04:05.113
> 
> 标签：asp.net, .net, wcf, iis, named-pipes

首先介绍一下背景：

我有一个 Web 服务器，它运行相同 ASP .NET 应用程序的 4 个实例，每个实例都在不同的文化中（在 web.config 中设置）。这些文化是英国人 (GBR)、澳大利亚人 (AUS)、爱尔兰人 (IRL) 和新西兰人 (NZL)。他们每个人都有一个网络方法“DoWork”，我想通过一个计划任务调用它。我有一个简单的 exe，它在四种文化中的每一种上调用此方法，简化代码：

```
Dim AUSclient As New AUSAutomated.AUSAutomatedClient()
AUSclient.DoWork
Dim GBRclient As New GBRAutomated.GBRAutomatedClient()
GBRclient.DoWork
Dim IRLclient As New IRLAutomated.IRLAutomatedClient()
IRLclient.DoWork
Dim NZLclient As New NZLAutomated.NZLAutomatedClient()
NZLclient.DoWork 
```

在使用方法的任务中，app.config 如下所示：

```
 <endpoint address="net.pipe://localhost/Services/GBR/GBRAutomated.svc"
            binding="netNamedPipeBinding" bindingConfiguration="NetNamedPipeBinding_IGBRAutomated"
            contract="GBRAutomated.IGBRAutomated" name="NetNamedPipeBinding_IGBRAutomated">
                </endpoint>

        <endpoint address="net.pipe://localhost/Services/IRL/IRLAutomated.svc"
 binding="netNamedPipeBinding" bindingConfiguration="NetNamedPipeBinding_IIRLAutomated"
 contract="IRLAutomated.IIRLAutomated" name="NetNamedPipeBinding_IIRLAutomated">
                    </endpoint>

        <endpoint address="net.pipe://localhost/Services/NZL/NZLAutomated.svc"
            binding="netNamedPipeBinding" bindingConfiguration="NetNamedPipeBinding_INZLAutomated"
            contract="NZLAutomated.INZLAutomated" name="NetNamedPipeBinding_INZLAutomated">
                    </endpoint> 
```

应用程序使用网络命名管道绑定通过 WCF 公开 Web 方法。每种文化在 web.config 中都有一个条目以指向正确的服务。例如爱尔兰是：

```
<service name="Web.IRLAutomated">
            <endpoint address="net.pipe://localhost/Services/IRL/IRLAutomated.svc" binding="netNamedPipeBinding" contract="Web.IIRLAutomated" />
        </service> 
```

因此，每种文化的公开方法都有不同的合同和地址。

当任务运行时，它会调用澳大利亚方法 4 次。它似乎忽略了 web.configs 中的设置，并在第一个应用程序上使用正确的合同调用该方法。所以我的问题是：

**如何为每种文化中的方法设置唯一的管道名称？**

我尝试在绑定上设置 hostNameComparisonMode="Exact" 但这似乎没有任何区别。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-07-20T15:25:37.017

**你不能**

经过一番搜索，我在这里发现了一个关于 StackOverflow 的类似问题：

[在 IIS 中托管 WCF net.pipe 绑定时控制命名管道的名称](https://stackoverflow.com/questions/1806430/controlling-the-name-of-a-named-pipe-when-hosting-wcf-net-pipe-binding-in-iis)

由于 2 年内没有人回答上述问题，我假设我想要做的事情是不可能的。

如果其他人正在努力解决此类问题，我发现此博客条目对帮助我理解非常有帮助：

[http://blogs.charteris.com/blogs/chrisdi/archive/2008/05/19/exploring-the-wcf-named-pipe-binding-part-1.aspx](http://blogs.charteris.com/blogs/chrisdi/archive/2008/05/19/exploring-the-wcf-named-pipe-binding-part-1.aspx)

我要将绑定更改为 http，这将解决我的问题。

# c# - ASP.Net - 引发事件时更新更新面板内的控件

> ID：11542084
> 
> 赞同：0
> 
> 时间：2012-07-18T13:04:22.693
> 
> 标签：c#, asp.net, ajax, multithreading

ASP.Net noob 在这里尝试在订阅事件的方法中更新 UpdatePanel 内的控件，但没有运气。

一些背景知识，我编写了一个与标准 POTS 电话接口的 DLL，并且我已经将电话端的各种事件（电话被拿起、电话响铃等）映射到 .Net 事件。

在我的 ASP.Net 解决方案中，我添加了我的 DLL，实例化了我的手机，并且在订阅我的事件的方法中，我想更新 UpdatePanel 内的各种标签，其中 EventArgs 对象内的信息被传递到我的方法中。

使用断点，我可以看到我的 Phone 对象按预期运行，事件在它们应该出现的时候被引发，并且 EventArgs 包含它们应该出现的信息。

但是 UpdatePanel 中的标签永远不会更新。我将应用程序的早期版本编写为 Windows 窗体，我记得每当从另一个线程更新 UI 时，我必须先检查是否`InvokeRequired`为真，如果是，则调用该`Invoke`方法，但我不知道相当于这是在 ASP.Net 中（如果有的话）。

标记如下（这只是我创建的一个示例项目，以了解基础知识）：

```
<%@ Page Language="C#" AutoEventWireup="true" CodeBehind="WebForm1.aspx.cs" Inherits="WebApplication2.WebForm1" %>

<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">

<html xmlns="http://www.w3.org/1999/xhtml">
<head runat="server">
    <title></title>
    <style type="text/css">
        #form1
        {
            text-align: center;
        }
    </style>
</head>
<body>
    <form id="form1" runat="server">
    <asp:ScriptManager ID="ScriptManager1" runat="server">
    </asp:ScriptManager>
    <asp:UpdatePanel ID="UpdatePanel1" runat="server" UpdateMode="Conditional">
        <ContentTemplate>
            <asp:Label ID="Label1" runat="server" style="text-align: center" Text="Label"></asp:Label>
            <br />
            <br />
            <asp:Button ID="Button1" runat="server" Text="Button" />

        </ContentTemplate>
        <Triggers>
            <asp:AsyncPostBackTrigger ControlID="ScriptManager1" EventName="Load" />
        </Triggers>
    </asp:UpdatePanel>
    </form>
</body>
</html> 
```

现在看代码：

```
using System;

//My DLL
using Maximiser;

namespace WebApplication2
{
    public partial class WebForm1 : System.Web.UI.Page
    {
        //My Phone Object
        private Phone _ThisPhone { get; set; }

        protected void Page_Load(object sender, EventArgs e)
        {
            //Instantiating Phone Object with IP Address and Port
            _ThisPhone = new Phone("8.8.8.8", 8888);

            //Hookstate event indicates phone is off/on the hook
            _ThisPhone.HookState += new EventHandler<Maximiser.Events.Hookstate>(thisPhone_HookState);
        }

        void thisPhone_HookState(object sender, Maximiser.Events.Hookstate e)
        {
            //I want to update my Label with the phones current HookState
            Label1.Text = e.State;

            //Now I want to refresh the UpdatePanel but not reload the page
            UpdatePanel1.Update();
        }
    }
} 
```

该方法肯定正在运行，如下所示：

![断点](../Images/173439d86c8ed504dc3ea4550b7d788c.png)

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-07-18T13:17:54.390

我将您的更新面板和`thisPhone_HookState`方法导入到我制作的测试项目中，并且效果很好。我开始怀疑是否没有调用您的方法。你能尝试在你的方法中设置一个断点来测试它吗？

我想你会这样调用方法

```
thisPhone_HookState(_ThisPhone.HookState, new EventHandler<Maximiser.Events.Hookstate>); 
```

# java - 为 Java 桌面应用程序实施盗版预防系统

> ID：11542093
> 
> 赞同：2
> 
> 时间：2012-07-18T13:04:55.657
> 
> 标签：java, encryption, privacy, piracy-prevention

我正在尝试用 Java 创建一个桌面应用程序，

1.  它不应该在我喜欢的另一台机器上运行。
2.  它不应该在特定过期数据之后运行。

有什么好主意吗。请帮我。提前致谢。

* * *

**据我所知（很少），我有一些建议：**

**对于Point1：**通过对我的应用程序的启动进行硬编码来检查ProcessorId（因为它是唯一的）如果它是有效的，它应该执行否则显示“过期”警报。但是为此，我应该为每个我不介意的用户提供一个单独的 jar setUp。

**对于 Point2：**应该维护一个将存储当前日期的加密文件。在应用程序的每次启动期间。如果当前日期大于文件中的日期，我将更新文件中的日期字段。如果没有，我将显示“过期”警报。

这可能看起来很有趣，但这是我能想到的。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-07-18T13:09:12.113

无论您做什么，您都需要（至少）混淆您的代码并加密/破坏您使用的任何字符串文字。如果您阅读 processorId，您会收到来自客户的愤怒电话，他们的笔记本电脑刚刚从维修中心更换了整个主板（今天很常见）。

任何加密文件都可以由搭便车的用户轻松删除。你必须把它藏在好地方。在 Windows 上，人们喜欢在注册表中玩这种捉迷藏游戏，尤其是它的经典部分。

只是一些随机的想法...

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-07-18T14:02:40.887

对于要求 1：

您可以维护一个数据库，其中填充了为您的用户生成的密钥。在您的应用程序启动时，它可以请求一个密钥，然后调用数据库以更改要使用的密钥。您可以给每个用户一个唯一的密钥，以便在启动时输入。该系统需要在线访问才能使用您的应用程序，以便可以对数据库进行检查。

对于要求 2：

您可以维护密钥和与之关联的日期，并在启动时检查正确的日期。如果日期已过，用户将收到过期通知。

用户只需要输入一次密钥……在那之后，您的软件会记住该密钥，并且仅在旧密钥过期后才要求新密钥。

这里与 Marko 想法的权衡是，这种系统需要访问 Internet 才能检查数据库。

* * *

编辑：

如上所述的这种方法不会阻止某人简单地复制 JAR 并将其移动到不同的机器上。您可以根据机器的 MAC 地址生成密钥，然后在启动时检查系统地址，这将导致与上述 Marko 相同的问题，即更换主板会更改 MAC 地址。

编辑2：

我对这个问题思考得越多，我就越清楚您需要拥有并维护服务器端连接以满足您的要求。此外，我不认为 Java 是您的最佳选择，因为有人可以反编译您的 JAR。

# python - 提取字典键并将其分配给python中的变量

> ID：11542097
> 
> 赞同：1
> 
> 时间：2012-07-18T13:05:05.753
> 
> 标签：python

文件名.dat 看起来完全像这样：

```
Fry, Philip J.;999 111-1111;999 222-2222  
Rodriguez, Bender B.;999 333-3333;999 444-4444  
Farnsworth, Professor;999 555-5555;999 666-6666  
Leela, Turanga;999 777-7777;999 888-8888  
Wong, Amy;999 999-9999;999 101-1010 
```

下面的代码在底部给出了打印结果。我想做的是制作一个菜单驱动程序，允许用户按数字选择他们想要修改的记录。在伪代码中，它看起来像这样：

*   第一个带有编号电话列表的代码块在这里
*   按编号输入要修改的记录
*   用户输入 3
*   对于 Rodriguez，Bender B 输入 ac 修改手机或输入 h 修改家庭电话
*   用户输入 h
*   输入不带空格的 10 位电话号码
*   用户输入 7771234567
*   记录被改变
*   输入 p 以查看修改后的电话簿（这将显示所有记录，但 Bender 使用不同的电话
*   你想再做一次修改吗？y 表示是，n 表示否

我的问题是我找不到将主键绑定到输入的用户号码的方法。由于 python 字典没有顺序，我发现这很难做到。有人可以帮忙吗？我只需要这个，剩下的我自己做。

```
pBook = {}  
fp = open('names.dat')  

# populate pBook  
while 1:  
    line = fp.readline()  
    if not line:  
        break  
x = line[:-1]  
data = x.split(';')  
pBook[data[0]] = {'home': data[1], 'cell': data[2]}  
fp.close()  

# optional if you want to see the dictionary structure   
# print pBook  

i = 1  
print '\nPhone listings:\n'  
for record in pBook:  
    key = str(i)  
    i += 1  
    print key + ')', record + ':', 'Home', pBook[record]['home'] + ',', 'Cell', pBook[record]['cell']  
print '' 
```

> 电话清单：
> 
> 1.  Farnsworth，教授：家庭 999 555-5555，细胞 999 666-6666
> 2.  Fry, Philip J.：家庭 999 111-1111，牢房 999 222-2222
> 3.  Rodriguez, Bender B.：家庭 999 333-3333，牢房 999 444-4444
> 4.  黄，艾米：家庭 999 999-9999，牢房 999 101-1010
> 5.  Leela，Turanga：家庭 999 777-7777，细胞 999 888-8888

填充后打印 pBook 的结果，为这篇文章格式化，以便更容易理解它的结构。主键是人名，值是另一个字典，其中“cell”和“home”是键，电话号码是各自的值。

```
{  
'Farnsworth, Professor': {'cell': '999 666-6666', 'home': '999 555-5555'},  
'Fry, Philip J.': {'cell ': '999 222-2222', 'home': '999 111-1111'},  
'Rodriguez, Bender B.': {'cell': '999 444-4444', 'home': '999 333-3333'},  
'Wong, Amy' : {'cell': '999 101-1010', 'home': '999 999-9999'},  
'Leela, Turanga': {'cell': '999 888-8888', 'home': '999 777-7777'}  
} 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-07-18T13:15:52.947

虽然我认为整个设计是错误的，因为一旦你将拥有一个巨大的电话簿，我认为打印它并让用户选择没有任何意义。

但是，如果您想绑定名称和用户选择（数字），您可以在将其打印给用户时创建一个字典：

```
user_choices = {}
i = 1  
print '\nPhone listings:\n'  
for record in pBook:  
    key = i
    user_choices[key] = record 
    i += 1  
    print str(key) + ')', record + ':', 'Home', pBook[record]['home'] + ',', 'Cell', pBook[record]['cell']  
print '' 
```

然后获取Wong的手机号，Amy就可以了`print pBook[user_choices[4]]['cell']`

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-07-18T13:09:26.733

如果您只需要一个有序的字典，请使用`collections.OrderedDict`

在 Python2.7 中，您可以使用或通过索引访问键或`my_dict.keys()[index]`值`my_dict.values()[index]`。

正如@mgilson 所指出的，这在 3.0 中不起作用，因为它返回一个不支持索引的 ValuesView 对象，但您仍然可以将其强制转换为如下列表：

`list(my_dict.keys())[index]`.

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-07-18T13:15:08.737

较新的（python 2.7+）版本的 python 有一个有序的字典类型 in `collections.OrderedDict`，但是（据我所知），您仍然无法通过索引访问该字典。我建议在字典旁边保留一个有序的数据类型（如列表）。然后，当您想通过索引获取值时，您只需执行`mydict[mylist[i]]`. 您可能可以通过子类化 dict 使它更漂亮一些，但本质上就是这样。

真的，如果你想通过索引获取数据，你可能最好还是使用 a`list`作为你的数据结构......这有一个优势，你可以对它进行排序（例如按字母顺序）并保持它的顺序。

# javascript - JSON的Javascript表单序列化

> ID：11542098
> 
> 赞同：1
> 
> 时间：2012-07-18T13:05:12.600
> 
> 标签：javascript, jquery, ajax, json, serialization

我正在尝试将表单序列化为 JSON 对象，以便我可以通过 AJAX 发送数据。我正在使用以下功能：

```
$.fn.serializeObject = function() {
var arrayData, objectData;
arrayData = this.serializeArray();
objectData = {};
$.each(arrayData, function() {
    var value;
    if (this.value != null && this.value != '') {
        value = this.value;
    } else {
        value = null;
    }
    if (objectData[this.name] != null) {
        if (!objectData[this.name].push) {
            objectData[this.name] = [ objectData[this.name] ];
        }

        objectData[this.name].push(value);
    } else {
        objectData[this.name] = value;
    }
});
return objectData; 
```

};

问题是我的序列化没有考虑循环数据结构。例如我有我的表格

```
<form:input path="discipline.cnfpDisciplineCode" class="required" /> 
```

这被序列化为

```
{
    ...
    discipline.cnfpDisciplineCode : someValue
    ...
} 
```

是否有一种优雅的解决方案来序列化表单以使其看起来像

```
{
    ...
    discipline : 
        {
            cnfpDisciplineCode : someValue
        }
    ...
} 
```

还是我必须自己实现整个解析算法？

谢谢你。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-08-07T21:00:30.420

不确定我是否得到了您想要做的事情，这是我在这种情况下会使用的东西。

**首先，您可以构建一个函数来创建一个对象并使用jQuery.ajax**将其发送到服务器

 **```
$.ajax({
        url: "servletAdress",
        type: "POST",
        accepts: "application/json",
        data: {obj: JSON.stringify(object) }, //it can be an array
        dataType: "json",
        beforeSend: function(x) {
            if (x && x.overrideMimeType) {
                x.overrideMimeType("application/json;charset=UTF-8");
            }
        }
}); 
```

他们将在参数“obj”中寻址的 servlet 中将 JSON 作为字符串接收。

您可能希望使用[com.google.gson在 servlet 中解析它](http://code.google.com/p/google-gson/)

*或者直接获取表单并将其提交给 servlet。*

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2014-09-17T15:59:25.840

我认为没有现成的函数可以将 abc 之类的路径转换为嵌套对象。以下线程中介绍了路径设置和获取问题的几种解决方案：

[将点符号的 JavaScript 字符串转换为对象引用](https://stackoverflow.com/questions/6393943/convert-javascript-string-in-dot-notation-into-an-object-reference)

由于您已经在使用 Spring（至少看起来像，因为标签库），您可以自动将输入参数转换为对象，如果这是您想要做的。这个想法是在服务器端有一个代表某种状态的对象，你像往常一样把这个对象解析成一个表单，Spring 自己处理从输入参数到 POJO 的反向转换。在这种情况下，请查看 Springs @ModelAttribute 注释的一些示例。**

# database - 如何安全地更改 Django 模型中主键字段的值？

> ID：11542110
> 
> 赞同：3
> 
> 时间：2012-07-18T13:05:48.950
> 
> 标签：database, django, django-models, django-orm

我有一个带有自定义指定主键的 Django 模型：

```
class ModelA(models.Model):
    my_primary_key = models.CharField(primary_key=True, ...)
    ... 
```

我还有其他模型对此模型有 ForeignKey 引用：

```
class ModelB(models.Model):
    ref_to_A = models.ForeignKey('ModelA', ...)
    ...

class ModelC(models.Model):
    ref_to_A = models.ForeignKey('ModelA', ...)
    ...

... 
```

我有一些 ModelA 实例，需要为这些实例更改 my_primary_key 的值。

这样做的最佳方法是什么？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-08-07T11:21:54.050

不知道你是否还在寻找这个，但也许这个片段会有所帮助：[http](http://djangosnippets.org/snippets/2915/) ://djangosnippets.org/snippets/2915/ 。

但是，这不是一个很好的数据库设计，因为正是这种问题。通常最好使用 django 的隐式主键并将其创建`my_primary_key`为唯一字段。

# java - java星号直角三角形

> ID：11542113
> 
> 赞同：1
> 
> 时间：2012-07-18T13:05:55.657
> 
> 标签：java

我想试试直角三角形星号。但我只得到了这个 **输出：（**我不能在这里放星号）

```
@ 
@@
@@@ 
```

我想要的是这个：

```
 @
 @@
@@@ 
```

这是我编写的代码：

```
 public class triangles {
public static void main( String[] args ) {

    for( int i = 1; i <= 10; i++ ){
        for( int j = 0; j < i; j++ ){
            System.out.print("*");

        }
        System.out.println();
    }

}
  } 
```

非常感谢您分享任何想法。我是一个java新手。谢谢。

* * *

## 回答 #1

> 赞同：8
> 
> 时间：2012-07-18T13:12:09.223

您的代码从不打印任何空格，这应该是个问题。

您可以使用这种简单的方法：

```
for (int i = 0; i < 3; i++) System.out.println("  @@@".substring(i, i+3)); 
```

逻辑很简单：你的字符串有两个空格和三个 at 符号。输出的第一行需要是两个空格和一个 at 符号，所以这是字符串的前三个字符。第二行应该是一个空格和两个 at 符号——这是跳过第一行后字符串的三个字符；依此类推：您只需在字符串中滑动，每次从头开始再跳过一个并获取接下来的三个字符。

## [演示](http://ideone.com/ozVGH)

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2012-07-18T13:16:25.900

```
for(int i = 0; i < 9; i++) {
    for(int j = 9; j > 0; j--)
        System.out.print(i < j ? " " : "*");

    System.out.println();
} 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-07-18T13:11:17.287

您的问题是您没有输出任何空白。先计算每行需要多少空格，输出这个空格，然后输出你的*

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2014-06-25T11:14:47.937

尝试以下操作：

```
import java.io.*;
public class Star2 {

    public static void main(String[] args)throws IOException {

        InputStreamReader read = new InputStreamReader(System.in);
        BufferedReader in = new BufferedReader(read);
        int i,j,n=0,k;
        System.out.print("How many stars you want to print in first row ? ");
        n=Integer.parseInt(in.readLine());
        for (i = 0; i<n; i=i+2)
        {
            for (j=i; j<n;j++)
            System.out.print ("*");
            System.out.println();
        }
    }

} 
```

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2014-06-25T11:24:32.053

试试这个 ：

```
public class PrintPyramidStar {  

   public static void main(String args[]) {  

    int c = 1;  
    for (int i = 1; i <= 5; i++) {  
        for (int j = i; j < 5; j++) {  
            System.out.print(" ");
        }  
        for (int k = 1; k <= c; k++) {  
            if (k % 2 == 0)  
                System.out.print(" ");  
            else  
                System.out.print("*");  
        }  
        System.out.println();  
        c += 2;  
    }  
  }  
} 
```

# wpf - 工具提示内的元素可见性

> ID：11542114
> 
> 赞同：0
> 
> 时间：2012-07-18T13:06:02.860
> 
> 标签：wpf, tooltip

我有一个包含杂项文本块的工具提示，我想动态隐藏或显示它们。我已经对工具提示之外的其他标签进行了动态可见性，并且效果很好（当然使用了适当的转换器），但在内部没有人愿意工作。

用户控制：

```
<ToolTip x:Key="directoriesTooltip">
         ...
         <TextBlock Grid.Row="1" Text="{x:Static Internationalization:Resources.PROPERTY_NAME}" HorizontalAlignment="Left" FontWeight="Bold"
                   Visibility="{Binding Path=IsMyTooltipVariableVisible, Source=myUC, Converter={StaticResource booleanToVisibilityCollapsedConverter}}"/>
         <TextBlock Grid.Row="1" Grid.Column="1" HorizontalAlignment="Right" Text="{Binding Nom}"
                   Visibility="{Binding Path=IsMyTooltipVariableVisible, Source=myUC, Converter={StaticResource booleanToVisibilityCollapsedConverter}}"/>
 </Tooltip> 
```

主窗口：

```
<MyUserControl:myUC
       IsMyTooltipVariableVisible="{Binding Application.IsMyTooltipVariableVisible, ElementName=Window}"
/> 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-07-18T13:54:40.077

原因之一可能是工具提示不是可视树的一部分，因此无法正常工作。

# java - 使用 Xerces 忽略奇怪的解析错误

> ID：11542116
> 
> 赞同：2
> 
> 时间：2012-07-18T13:06:07.237
> 
> 标签：java, xml, xml-parsing, xerces

我正在尝试将以下 url 解析为 Java 中的 DOM 文档：[http](http://www.op.org/en/rss-category-home/8) ://www.op.org/en/rss-category-home/8 。

但是，当我这样做时，我收到以下错误：

```
13:51:38,470 ERROR ~ Error processing site Site 1
org.xml.sax.SAXParseException: The entity "acirc" was referenced, but not declared.
    at org.apache.xerces.parsers.DOMParser.parse(Unknown Source)
    at org.apache.xerces.jaxp.DocumentBuilderImpl.parse(Unknown Source)
    at javax.xml.parsers.DocumentBuilder.parse(DocumentBuilder.java:124)
    at logic.server.RssReader.readRss(RssReader.java:44)
    at logic.server.GatherData.doJobWithResult(GatherData.java:49)
    at logic.server.GatherData.doJobWithResult(GatherData.java:1) 
```

我在某处读到当前 JRE 中的 Xerces 解析器存在与此相关的错误，因此下载了 Xerces2 2.11.0，但仍然有同样的问题。

我怎样才能解决这个问题。我无法控制 RSS 提要本身，但需要解析 XML 来处理文章。

我的代码是： DocumentBuilderFactory dbf = DocumentBuilderFactory.newInstance();

```
 DocumentBuilder builder = dbf.newDocumentBuilder();
    Document dom = builder.parse(rssUrl.openStream());
    NodeList nodes = dom.getElementsByTagName("item");
    etc. etc. 
```

非常感谢解决此问题的任何帮助！

**编辑：** 如果我会尝试下面的解决方案并添加 DTD，我会在哪里做呢？当前的 RSS 元素是：

```
<rss version="2.0" xml:base="http://www.op.org/en/rss-category-home/8" xmlns:dc="http://purl.org/dc/elements/1.1/" content="http://purl.org/rss/1.0/modules/content/" dc="http://purl.org/dc/terms/" foaf="http://xmlns.com/foaf/0.1/" og="http://ogp.me/ns#" rdfs="http://www.w3.org/2000/01/rdf-schema#" sioc="http://rdfs.org/sioc/ns#" sioct="http://rdfs.org/sioc/types#" skos="http://www.w3.org/2004/02/skos/core#" xsd="http://www.w3.org/2001/XMLSchema#"> 
```

或者我会将它添加到每个包含 XHTML 代码的“描述”元素中，就像这样？我后来尝试了这个解决方案，但它仍然给出了同样的错误。

```
<description xmlns="http://www.w3.org/1999/xhtml"> 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-07-18T13:58:50.303

如果 XML 中有错误，为什么要忽略它？XML 解析器旨在拒绝错误的 XML。

看起来此 XML 包含一个实体引用`&acirc;`，但不包含定义此实体的 DTD。这是标准的 XHTML 实体之一，因此您可以通过添加对来自 XHTML 的相关实体声明 DTD 模块的引用来修复 XML。

# c++ - 寻找图像轮廓质心

> ID：11542121
> 
> 赞同：1
> 
> 时间：2012-07-18T13:06:18.060
> 
> 标签：c++, c, image-processing, centroid

我正在尝试像这样计算图像质心：

```
// Calculate centroid
    double signedArea = 0.0;
    sskp_point centroid;
    for(int i=0;i<numPoints;i++)
    {
        double a = (points[i].x*points[(i+1)%numPoints].y)-(points[(i+1)%numPoints].x*points[i].y);
        signedArea += a;
        centroid.x += (points[i].x*points[(i+1)%numPoints].x)*a;
        centroid.y += (points[i].y*points[(i+1)%numPoints].y)*a;
        printf("points[%d] = { %f, %f }\n",i,points[i].x,points[i].y);
    }
    signedArea /= 2.0;
    centroid.x /= (6*signedArea);
    centroid.y /= (6*signedArea);
    printf("centroid = { %f, %f }\n",centroid.x,centroid.y); 
```

我已经从[这里](https://stackoverflow.com/questions/2792443/finding-the-centroid-of-a-polygon)的算法中改编了这个，但是它给了我错误的[结果](http://pastebin.com/WVyQ0erP)，谁能告诉我这个改编有什么问题？

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2012-07-18T13:23:15.450

你已经写`centroid.x += (points[i].x*points[(i+1)%numPoints].x)*a;` 了，应该是`centroid.x += (points[i].x+points[(i+1)%numPoints].x)*a;` 你必须在这里`*`替换`+`。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-07-18T13:24:48.237

我看了一点你拿这个样本的线程，我认为你应该有 centroid.x += (points[i].x + points[(i+1)%numPoints].x)*a; centroid.y += (points[i].y + points[(i+1)%numPoints].y)*a;

# ruby-on-rails - 设计中的自定义变量重置密码说明？

> ID：11542137
> 
> 赞同：7
> 
> 时间：2012-07-18T13:06:56.253
> 
> 标签：ruby-on-rails, devise, mailer, password-recovery

我需要能够自定义 Rails 设计邮件程序视图以获取重置密码说明。

为此，我需要做两件事。

1.  为链接指定自定义 URL，使其成为基于特定业务逻辑的主机/域。这个主机和域来自浏览器中的URL，即用户点击忘记密码时的请求对象。所以我在delayed_job 中没有请求对象来根据需要处理它，因此我需要能够在发送电子邮件的delayed_job 中的某个时间点执行此操作。

2.  将自定义变量传递给邮件视图，以便我可以为视图添加各种其他逻辑，根据需要隐藏和显示位。

任何人都可以帮忙吗？我可以看到您可以为设计生成邮件视图，但我还需要能够将各种项目传递给它。例如，我是否需要以某种方式自己覆盖用户模型和密码控制器中的功能？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2019-09-12T17:36:55.007

覆盖整个控制器方法并在`send_reset_password_instructions`opts 参数中添加参数将修复它。

```
@resource.send_reset_password_instructions(
    email: @email,
    provider: 'email',
    redirect_url: @redirect_url,
    client_config: params[:config_name],
    parameter_passed: params[:parameter_passed],
  ) 
```

您可以访问视图中的参数为`message['parameter_passed']`

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-07-20T14:45:06.793

所以，经过一番折腾、搜索和破解……这是不可能的。所以我最终编写了自己的邮件程序并绕过控制器中的设计重置密码方法，生成我自己的重置令牌，设置我需要的变量，调用我的 usermailer....并将设计 URL 嵌入到我的邮件中以获取它单击密码重置链接后，返回调用设计，然后一切都很好....

我讨厌不得不重写逻辑，但最终它是最快和最干净的解决方案。

一种几乎奏效的方法是在我的用户模型上使用非 activerecord 属性来存储我需要的位并将其“破解”到设计视图中的@resource 中，但它在设计时造成了一些悲伤，结果，我选择了上面的选项...

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2014-03-21T15:02:25.143

我需要添加一个`source`以包含在重置密码视图中，这是我实现的：

```
class User < ActiveRecord::Base
  prepend ResetPasswordWithSource

  devise :recoverable

  ....
end

module User::ResetPasswordWithSource
  def send_reset_password_instructions(source=nil)
    @source = source
    super()
  end

  def send_devise_notification(notification, *args)
    args.last.merge!({ source: @source })
    super
  end
end 
```

从这里你可以打电话`user.send_reset_password_instructions('special_source')`

并且可以通过在视图中访问`@options[:source] = 'special_source'`

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2017-02-10T23:16:19.380

在我意识到在调用 super 之前声明自定义变量会起作用之前，我也为此苦苦挣扎。

```
 def reset_password_instructions(record, token, opts={})
   @custom_variable = "Greetings, world"

    # your gorgeous code

   mailer_object = super

   mailer_object
  end 
```

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2021-09-08T12:55:52.830

您只需要添加一个`flag`以显示在视图邮件程序中。从这里你可以调用一个方法并传递参数。

```
@user.send_reset_password_instructions("true") 
```

现在覆盖方法 send_reset_password_instructions

```
def send_reset_password_instructions(option = nil)
  token = set_reset_password_token
  send_reset_password_instructions_notification(token, option)
  token 
end

def send_reset_password_instructions_notification(token, option = nil)
  send_devise_notification(:reset_password_instructions, token, :option => option)
end 
```

然后您可以使用以下方法访问参数：

```
message[:option] 
```

# java - Java 的 mkdir 失败

> ID：11542138
> 
> 赞同：0
> 
> 时间：2012-07-18T13:06:57.103
> 
> 标签：java, tomcat, mkdir

我正在尝试通过 java 的 mkdir 方法创建一个目录。

它失败的问题，我认为是因为访问限制。Tomcat 在 tomcat7 用户下运行，文件夹的所有者也是 tomcat7 用户。每个子文件夹都有相同的所有者。但是这种方法仍然失败（路径有效）。

有人熟悉这样的问题吗？谢谢

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-07-18T13:29:28.667

```
public class TestClass6 {
        public static void main(String[] args)
    {
        String path = "c:/folder1/folder2";    // path of the folder you want to create
        File folder=new File(path);
        boolean exist=folder.exists();
        if(!exist){
            folder.mkdirs();
        }else{
            System.out.println("folder already exist");
        }
    }
} 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-07-18T13:12:17.030

您应该事先检查该目录是否存在。`mkdir`如果目录已经存在，则返回 false。所以，一个伪代码是：

```
if exists(dir):
   move on and do other things
else:
   File f = new File(dir);
   f.mkdir(); 
```

此外，请确保您`w`在用作基本目录的目录中具有（写入）权限。

# algorithm - 查找名称/字符之间比较的算法

> ID：11542142
> 
> 赞同：0
> 
> 时间：2012-07-18T13:07:15.453
> 
> 标签：algorithm, math, comparison, compare

我想请大家注意一下这个挑战。

我的目的是在系统内找到一些解决方案来开发。

在我公司的业务（土木工程）中，我有以下场景：

我们在我们的数据库中注册了元素/材料，但我们成千上万的供应商拥有相同的元素/材料，但名称不同但相似。

所以我有一个通过 XML 来自发票的元素列表（例如水泥）。

另一方面，我在我的数据库中注册了相同类型的元素，但名称不同（在大多数情况下它们几乎相等），我想在发票列表中找出更像是比较它们的名称。

是否有任何类似于贝叶斯算法的方法，我可以在其中比较名称并具有介于“0”和“1”之间的值？其中“1”将是 100% 相同的字符。

示例（我将更改水果元素的类型）：

如果我必须比较：**覆盆子**

```
Invoice List - Values of Algortim
---------------------------------
 strawberry ........ 0,89
 blueberry ......... 0,77
 cherry ............ 0,46
 grape ............. 0,11
 raspberry ......... 1,00
 pineapple ......... 0,13 
```

重要的是在我没有完美组合时找出最接近的名字。

还有其他技巧吗？

很高兴看到你们的想法！

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2012-07-18T13:09:33.130

我不确定我是否完全遵循 - 但如果您正在寻找一种方法来计算两个字符串彼此之间的相似程度，您可以尝试[Levenshtein Distance](http://en.wikipedia.org/wiki/Levenshtein_distance)，它通常用于这些目的。

您可以稍后对结果进行标准化以使其在您想要的范围内，例如一个简单的标准化将是：

```
 distance(u,v)
normalized_distance(u,v) =               ----------------
                              max{distance(x,v) | for each x in the collection } 
```

# json.net - 如何在 JSON 序列化期间删除 $id

> ID：11542144
> 
> 赞同：35
> 
> 时间：2012-07-18T13:07:17.250
> 
> 标签：json.net

我正在使用 NewtonSoft.JSON。跑步时

```
JsonConvert.SerializeObject(myObject) 
```

它正在`$id`为我的 JSON 添加一个值 - 如下所示：

```
 "$id": "1",
  "BookingId": 0,
  "CompanyId": 0,
  "IsCashBooking": false,
  "PaymentMethod": 0,
  "IsReferral": false,
  "IsReferralPercent": false,
  "ReferralPaymentType": 0,
  "ReferralDues": 0,
  "PassengerId": 0,
  "DepartmentID": 0,
  "CostCenterID": 0,
  "DeadMiles": 0 
```

我们可以`$id`使用一些 JsonSerializerSettings 或任何其他方法删除它吗？

如果是 - 那么如何...

* * *

## 回答 #1

> 赞同：53
> 
> 时间：2012-10-05T14:56:01.813

我将此代码添加到我的 WebApiConfig 注册方法中，并删除了 JSON 中的所有 $id。

```
var json = config.Formatters.JsonFormatter;
json.SerializerSettings.PreserveReferencesHandling = Newtonsoft.Json.PreserveReferencesHandling.None; 
```

* * *

## 回答 #2

> 赞同：9
> 
> 时间：2013-10-14T17:36:57.067

如果由于某种原因您正在使用自定义 ContractResolver，请查看其他堆栈溢出；

[尽管将 PreserveReferencesHandling 设置为“无”，Json.Net 仍将 $id 添加到 EF 对象](https://stackoverflow.com/questions/18128689/json-net-adding-id-to-ef-objects-despite-setting-preservereferenceshandling-to)

* * *

## 回答 #3

> 赞同：5
> 
> 时间：2017-09-05T05:17:40.690

为我的 Web API 删除 JSON 中的 $id。我为我的类对象添加了 [JsonObject(IsReference = false)]，为我的对象类型的属性添加了 [JsonProperty(IsReference = false)]。在我的情况下，RespObj 属性是通用类型 T 并且可以采用我传递给它的任何对象类型，包括集合，所以我不得不使用 [JsonProperty(IsReference = false)] 来摆脱序列化 JSON 字符串中的 $id。

我没有更改我的 WebApiConfig，因为我使用的是 WEB API 的 MVC 帮助页面，并且它要求我在我的 webApiconfig 中进行此配置：

```
var json = GlobalConfiguration.Configuration.Formatters.JsonFormatter;
        json.SerializerSettings.PreserveReferencesHandling = Newtonsoft.Json.PreserveReferencesHandling.All;
        json.SerializerSettings.ReferenceLoopHandling = Newtonsoft.Json.ReferenceLoopHandling.Serialize; 
```

类对象

```
[DataContract(IsReference = true)]
[JsonObject(IsReference = false)]
public class QMResponse<T> where T : new()
{
    public QMResponse()
    {

    }

    /// <summary>
    /// The response code
    /// </summary> 
    public string RespCode { get; set; }

    /// <summary>
    /// The response message
    /// </summary> 
    public string RespMxg { get; set; }

    /// <summary>
    /// The exception message
    /// </summary> 
    public string exception { get; set; }

    /// <summary>
    /// The object type returned
    /// </summary>         
    [JsonProperty(IsReference = false)]
    public T RespObj { get; set; }

    /// <summary>
    /// No of records returned
    /// </summary> 
    public long RecordCount { get; set; }

    /// <summary>
    /// The Session Object
    /// </summary> 
    public string session_id { get; set; }

} 
```

* * *

## 回答 #4

> 赞同：2
> 
> 时间：2012-07-19T10:04:48.333

如果 'id' 是您的类的属性，则在其上应用 [JsonIgnore] 属性。否则，这可能是您问题的答案：

[http://james.newtonking.com/json/help/index.html?topic=html/PreserveObjectReferences.htm](http://james.newtonking.com/json/help/index.html?topic=html/PreserveObjectReferences.htm)

* * *

## 回答 #5

> 赞同：2
> 
> 时间：2018-01-15T11:09:18.733

您可以保留基本配置：

```
Newtonsoft.Json.PreserveReferencesHandling.All; 
```

我将这种代码格式用于我的方法

```
public JsonResult<T> Get()
{
    return Json(result);
} 
```

这对我来说可以。

* * *

## 回答 #6

> 赞同：1
> 
> 时间：2017-11-03T00:04:19.727

自定义 ContractResolver 设置会覆盖 PreserveReferencesHandling 设置。

在 DefaultContractResolver/IContractResolver 的实现中，添加这个；

```
public override JsonContract ResolveContract(Type type) {
    var contract = base.ResolveContract(type);
    contract.IsReference = false;
    return contract;
} 
```

这与没有自定义 ContractResolver 的 PreserveReferencesHandling.None 设置类似

# c++ - 在 Mac OS 上安装 MongoDB C++ 驱动程序

> ID：11542145
> 
> 赞同：0
> 
> 时间：2012-07-18T13:07:22.130
> 
> 标签：c++, macos, mongodb, boost, boost-filesystem

我试图安装 MongoDB 的驱动程序 C++ 已经 2 天了，但我一直遇到同样的错误（在 Mac OS X 环境中）

```
In file included from /opt/local/include/boost/filesystem/operations.hpp:24,
             from /opt/local/include/boost/filesystem/convenience.hpp:22,
             from pch.h:83,
             from pch.cpp:18:
/opt/local/include/boost/filesystem/config.hpp:16:5: error: #error Compiling Filesystem      version 3 file with BOOST_FILESYSTEM_VERSION defined != 3
In file included from util/goodies.h:22,
             from pch.h:161,
             from pch.cpp:18:
 util/concurrency/mutex.h: In function 'boost::xtime mongo::incxtimemillis(long long int)': 
```

在安装 lib（通过执行“scons”）之前，我通过 portmac（sudo port install boost）安装了 pcre 和 boost。

有任何想法吗 ？我现在真的卡住了。。

谢谢各位。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-08-02T05:41:15.230

您需要将 boost 库降级到 1.45 或更早版本来构建 mongodb，因为它依赖于 boost::filesystem v2，但最新的 boost（v1.46 之后）默认使用 boost::filesystem v3。

[http://www.boost.org/users/history/version_1_46_0.html](http://www.boost.org/users/history/version_1_46_0.html)

> 文件系统：该库的版本 3 现在是默认设置。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-08-05T18:38:04.437

我遇到了同样的问题，降级到 boost 1.45 为我编译了它（感谢[Flier Lu](https://stackoverflow.com/users/486038/flier-lu)）。我使用 MacPorts 安装 Boost；以下是有关如何降级的说明：

[https://trac.macports.org/wiki/howto/InstallingOlderPort](https://trac.macports.org/wiki/howto/InstallingOlderPort)

# iphone - 缩放时如何使视图居中

> ID：11542151
> 
> 赞同：0
> 
> 时间：2012-07-18T13:07:40.150
> 
> 标签：iphone, ipad, uiscrollview

当我触摸 UIScrollView 时，我将视图放大到很大比例。但是视图并没有以我触摸的地方为中心。我想知道当我触摸它时如何使视图中心，有人可以给我一些示例代码。

或者如果滚动视图有这个功能？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-07-18T13:10:46.560

在缩放之前，设置滚动视图的 contentoffset，使您触摸的点位于中心。

# scala - 如何从 Scala 中的持久层中抽象出领域层

> ID：11542153
> 
> 赞同：22
> 
> 时间：2012-07-18T13:07:54.233
> 
> 标签：scala, architecture, scalaquery

更新：我编辑了标题并添加了这段文字，以更好地解释我想要实现的目标：我正在尝试从头开始创建一个新应用程序，但不希望业务层知道持久性层，就像我们不希望业务层知道 REST API 层一样。下面是我想使用的持久层的示例。我正在寻找与此集成的好建议，即我需要设计/架构方面的帮助，以清晰地划分业务逻辑和持久性逻辑之间的职责。也许是一个将持久性对象编组和解组为域对象的概念。

从 SLICK（又名 ScalaQuery）[测试示例](https://github.com/slick/slick/blob/01251edbc7f970f29f3a471d7eee27460e6846cf/src/test/scala/scala/slick/test/ql/ForeignKeyTest.scala#L177)中，这就是您创建多对多数据库关系的方式。这将创建 3 个表：a、b 和 a_to_b，其中 a_to_b 保留表 a 和 b 中的行链接。

```
object A extends Table[(Int, String)]("a") {
  def id = column[Int]("id", O.PrimaryKey)
  def s = column[String]("s")
  def * = id ~ s
  def bs = AToB.filter(_.aId === id).flatMap(_.bFK)
}

object B extends Table[(Int, String)]("b") {
  def id = column[Int]("id", O.PrimaryKey)
  def s = column[String]("s")
  def * = id ~ s
  def as = AToB.filter(_.bId === id).flatMap(_.aFK)
}

object AToB extends Table[(Int, Int)]("a_to_b") {
  def aId = column[Int]("a")
  def bId = column[Int]("b")
  def * = aId ~ bId
  def aFK = foreignKey("a_fk", aId, A)(a => a.id)
  def bFK = foreignKey("b_fk", bId, B)(b => b.id)
}

(A.ddl ++ B.ddl ++ AToB.ddl).create
A.insertAll(1 -> "a", 2 -> "b", 3 -> "c")
B.insertAll(1 -> "x", 2 -> "y", 3 -> "z")
AToB.insertAll(1 -> 1, 1 -> 2, 2 -> 2, 2 -> 3)

val q1 = for {
  a <- A if a.id >= 2
  b <- a.bs
} yield (a.s, b.s)
q1.foreach(x => println(" "+x))
assertEquals(Set(("b","y"), ("b","z")), q1.list.toSet) 
```

作为我的*下一步*，我想把它提升一个层次（我仍然想使用 SLICK，但很好地包装它）来处理对象。所以在伪代码中做这样的事情会很棒：

```
objectOfTypeA.save()
objectOfTypeB.save()
linkAtoB.save(ojectOfTypeA, objectOfTypeB) 
```

或类似的东西。我对如何在 Java 中实现这一点有自己的想法，但我开始意识到，我从纯 OO 语言中获得的一些面向对象的想法开始让我失望。谁能给我一些关于如何在Scala中解决这个问题的指示。

例如：我是否创建了仅包装或扩展表对象的简单对象，然后将这些（组合）包含到另一个管理它们的类中？

任何想法，指导，示例（请），将帮助我作为设计师和编码人员更好地解决这个问题，将不胜感激。

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2012-08-12T06:38:40.630

最好的想法是实现类似[数据映射器](http://martinfowler.com/eaaCatalog/dataMapper.html)模式的东西。与活动记录相比，这不会违反 SRP。

由于我不是 Scala 开发人员，因此我不会展示任何代码。

思路如下：

*   创建域对象实例
*   对元素设置条件（例如`setId(42)`，如果您正在按 ID 查找元素）
*   创建数据映射器实例
*   `fetch()`通过传入域对象作为参数在映射器上执行方法

映射器将查找提供的域对象的当前参数，并根据这些参数从存储（可能是 SQL 数据库、JSON 文件或远程 REST API）中检索信息。如果检索到信息，它会将值分配给域对象。

另外，我必须注意，数据映射器是为与特定域对象的接口一起工作而创建的，但是它们从域对象传递到存储并返回的信息可以映射到多个 SQL 表或多个 REST 资源。

这样，当您切换到不同的存储介质时，您可以轻松地替换映射器，甚至可以在不接触真实存储的情况下对域对象中的逻辑进行单元测试。此外，如果您决定在某个时候添加缓存，那将只是另一个映射器，它试图从缓存中获取信息，如果失败，用于持久存储的映射器就会启动。

域对象（或者，在某些情况下，域对象的集合）将完全不知道它是被存储还是被检索。那将是数据映射器的责任。

如果这一切都在 MVC 上下文中，那么，要完全实现这一点，您将需要模型层中的另一组结构。我称它们为“服务”（请分享，你们中的人想出更好的名字）。它们负责包含数据映射器和域对象之间的交互。通过这种方式，您可以防止业务逻辑在表示层（确切地说是控制器）中泄漏，并且这些服务为业务（也称为模型）层和表示层之间的交互创建了一个自然接口。

PS 再次抱歉，我无法提供任何代码示例，因为我是一名 PHP 开发人员，不知道如何在 Scala 中编写代码。

PPS 如果您使用数据映射器模式，最好的选择是手动编写映射器而不使用任何声称实现它的第 3 方 ORM。它可以让您更好地控制代码库并避免无意义的*技术债务* ^([[1]](http://martinfowler.com/bliki/TechnicalDebt.html) [[2]](http://blog.ircmaxell.com/2012/03/power-of-technical-debt.html))。

* * *

## 回答 #2

> 赞同：5
> 
> 时间：2012-08-08T09:58:19.180

ActiveRecord 模式是简单持久性需求的一个很好的解决方案：[http](http://en.wikipedia.org/wiki/Active_record_pattern) ://en.wikipedia.org/wiki/Active_record_pattern 。这是在 Ruby 和 Play 中实现的！framework 1.2，您可以在独立应用程序中轻松地在 Scala 中实现它

唯一的要求是拥有一个单例数据库或单例服务来获取对您需要的数据库的引用。我个人会根据以下内容进行实施：

*   通用特征 ActiveRecord
*   泛型类型类 ActiveRecordHandler

利用隐式的力量，你可以获得惊人的语法：

```
trait ActiveRecordHandler[T]{

  def save(t:T):T

  def delete[A<:Serializable](primaryKey:A):Option[T]

  def find(query:String):Traversable[T]
}

object ActiveRecordHandler {
  // Note that an implicit val inside an object with the same name as the trait 
  // is  one of the way to have the implicit in scope.
  implicit val myClassHandler = new ActiveRecordHandler[MyClass] {

    def save(myClass:MyClass) = myClass

    def delete[A <: Serializable](primaryKey: A) = None

    def find(query: String) = List(MyClass("hello"),MyClass("goodbye"))
  }
}

trait ActiveRecord[RecordType] {
  self:RecordType=>

  def save(implicit activeRecordHandler:ActiveRecordHandler[RecordType]):RecordType = activeRecordHandler.save(this)

  def delete[A<:Serializable](primaryKey:A)(implicit activeRecordHandler:ActiveRecordHandler[RecordType]):Option[RecordType] = activeRecordHandler.delete(primaryKey)
}

case class MyClass(name:String) extends ActiveRecord[MyClass] 

object MyClass {
  def main(args:Array[String]) = {
    MyClass("10").save
  }
} 
```

有了这样的解决方案，你只需要你的类来扩展 ActiveRecord[T] 并有一个隐式的 ActiveRecordHandler[T] 来处理它。

实际上还有一个实现：[https](https://github.com/aselab/scala-activerecord) ://github.com/aselab/scala-activerecord ，它基于类似的想法，但不是使 ActiveRecord 具有抽象类型，而是声明了一个通用的伴随对象。

* * *

关于 ActiveRecord 模式的一个普遍但非常重要的评论是，它有助于满足持久性方面的简单需求，但不能处理更复杂的需求：例如，当您希望在同一事务下持久化多个对象时。

如果您的应用程序需要更复杂的持久性逻辑，最好的方法是引入一个持久性服务，该服务仅向客户端类公开一组有限的功能，例如

`def persist(objectsofTypeA:Traversable[A],objectsOfTypeB:Traversable[B])`

另请注意，根据您的应用程序复杂性，您可能希望以不同的方式公开此逻辑：

*   在您的应用程序很简单的情况下作为单例对象，并且您不希望您的持久性逻辑是可插入的
*   通过充当“应用程序上下文”的排序的单例对象，以便在您的应用程序启动时，您可以决定要使用哪种持久性逻辑。
*   如果您的应用程序是分布式的，则使用某种查找服务模式。

# asp.net-mvc - 表单身份验证 cookie 没有持久化或没有通过 ajax 请求过去？

> ID：11542157
> 
> 赞同：0
> 
> 时间：2012-07-18T13:08:11.923
> 
> 标签：asp.net-mvc, asp.net-mvc-3, forms-authentication

我不知道为什么我的身份验证 cookie 会消失。我将 Valums Ajax Upload 与其他几个 ajax 请求结合使用来构建用户的头像。cookie 何时消失是非常随机的。我可以毫无问题地上传 4 个文件，然后可能会上传 2 个文件（再次登录后）。似乎在我调用 CreateAvatar 方法之后，这可能会出现问题，但就像我说的那样，它不会一直发生。我错过了什么？

JavaScript：

```
$(function () {
        //This is the Upload Method
        var fileCount = 0;
        var uploader = new qq.FileUploader({
            element: document.getElementById('file-uploader'),
            action: '/Admin/Avatar/AvatarUpload',
            debug: true,
            params: {
                'userId': '@ViewBag.UserId'
            },
            onSubmit: function (id, fileName) {
                fileCount++;
            },
            onComplete: function (id, fileName, responseJson) {
                if (responseJson.success) {
                    //fileCount--;
                                        if (createAvatar(responseJson.file, responseJson.imageId)) {
                                            fileCount--;

                                        } else {
                                            fileCount--;
                                            //alert('There was an error when trying to save ' + fileName);
                                        }
                } else {
                    $("span.qq-upload-file:contains(" + fileName + ")").text(responseJson.errorMessage);
                    fileCount--;
                }

                if (fileCount == 0) {

                }

            },
            onCancel: function (id, fileName) {
                fileCount--;
                if (fileCount == 0) {
                    parent.$.fn.colorbox.close();
                }
            }
        });
    });

    //This Creates the Avatar Object
    function createAvatar(fileName, imageId) {

        var avatarUploadModel = { 
            UploadFileName: fileName,
            UserId: '@ViewBag.UserId',
            ImageId: imageId

        };
        $.ajax({
            url: '/Admin/Avatar/CreateAvatar/',
            type: 'POST',
            cache: false,
            timeout: 100000,
            data: JSON.stringify(avatarUploadModel),
            contentType: 'application/json; charset=utf-8',
            dataType: "json",
            error: function (xhr, status, error) {
                alert(error + " " + status);
            },
            success: function (data) {
                if (data.success) {

                    loadAvatar(data.avatarModel);
                    return true;
                } else {
                    return false;
                }
            }

        });
    }

    //This loads the partial to view the avatar after upload
    function loadAvatar(avatarModel) {

        $.ajax({
            url: '/Admin/Avatar/AvatarEdit',
            type: 'GET',
            cache: false,
            timeout: 100000,
            data: avatarModel,
            dataType: "html",
            error: function (xhr, status, error) {
                alert(error + " " + status);
            },
            success: function (data) {

                $("#avatarOriginal").html(data);

            }

        });
    } 
```

登录方式：

```
var user = _userService.GetByUserName(model.Username);
                var authTicket = new
                    FormsAuthenticationTicket(1, //version
                                              user.Id.ToString(), // user name
                                              DateTime.Now,
                                              DateTime.Now.AddMinutes(40), //Expiration
                                              model.RememberMe, //Persistent,
                                              user.Username);

                var encTicket = FormsAuthentication.Encrypt(authTicket);
                HttpContext.Response.Cookies.Add(new HttpCookie(FormsAuthentication.FormsCookieName, encTicket));

                return Json(new {success = true, url = model.ReturnUrl}, JsonRequestBehavior.AllowGet); 
```

控制器上的上传方法：

```
[HttpPost]
        public ActionResult AvatarUpload(HttpPostedFileBase fileData)
        {
            var id = Guid.NewGuid();
            string fileName;
            var serverPath = Server.MapPath("~/Areas/Admin/TemporaryUploads/");
            if (fileData != null)
            {
                var fileRenamed = System.IO.Path.GetFileName(id + "_" + fileData.FileName);
                fileName = Server.MapPath("~/Areas/Admin/TemporaryUploads/" + fileRenamed);
                fileData.SaveAs(fileName);
            }
            else
            {
                var ajaxUploadFileData = Request["qqfile"];
                fileName = Path.Combine(serverPath, id + "_" + Path.GetFileName(ajaxUploadFileData));
                using (var output = System.IO.File.Create(fileName))
                {
                    Request.InputStream.CopyTo(output);
                }
            }

            return Json(new {success = true, file = fileName, imageId = id}, JsonRequestBehavior.AllowGet);
        } 
```

创建头像方法：

```
[HttpPost]
        public ActionResult CreateAvatar(AvatarModel avatarModel)
        {

            try
            {

                var image = new WebImage(avatarModel.UploadFileName).Resize(400, 400, true);
                var imageFileName = Path.GetFileName(avatarModel.UploadFileName);
                var avatar = new Domain.YogaDiVitaContext.Model.Avatar()
                                 {
                                     CreatedById = Guid.Parse(HttpContext.User.Identity.Name),
                                     ModifiedById = Guid.Parse(HttpContext.User.Identity.Name),
                                     UserId = avatarModel.UserId,
                                     Image = new Image()
                                                 {
                                                     CreatedById = Guid.Parse(HttpContext.User.Identity.Name),
                                                     ModifiedById = Guid.Parse(HttpContext.User.Identity.Name),
                                                     OriginalImageRelativePath = "original/" + imageFileName
                                                 }
                                 };

                var user = UserService.FindById(avatarModel.UserId);
                if (user.Avatar != null)
                    RemoveAvatar(user.Avatar);

                avatar = _avatarService.Create(avatar);

                user.Avatar = avatar;
                UserService.Update(user);

                var basePath = Server.MapPath("~/" + avatar.ToAvatarBasePath(GlobalVariables.AvatarPath));
                Directory.CreateDirectory(basePath);
                Directory.CreateDirectory(basePath + "/thumbnail");
                Directory.CreateDirectory(basePath + "/fullsize");
                Directory.CreateDirectory(basePath + "/original");
                image.Save(Server.MapPath("~/" + avatar.ToAvatarOriginalPath(GlobalVariables.AvatarPath)));

                avatarModel.Width = image.Width;
                avatarModel.Height = image.Height;
                avatarModel.Top = image.Height*0.1;
                avatarModel.Left = image.Width*0.9;
                avatarModel.Right = image.Width*0.9;
                avatarModel.Bottom = image.Height*0.9;
                avatarModel.OriginalImagePath = "/" + avatar.ToAvatarOriginalPath(GlobalVariables.AvatarPath);

                System.IO.File.Delete(avatarModel.UploadFileName);

                return Json(new {success = true, avatarModel}, JsonRequestBehavior.AllowGet);
            }
            catch (Exception exception)
            {
                return Json(new {message = exception.Message}, JsonRequestBehavior.AllowGet);
            }
        } 
```

加载头像部分：

```
public ActionResult AvatarEdit(AvatarModel avatarModel)
        {
            return PartialView("AvatarCropPartial", avatarModel);
        } 
```

# javascript - 一次覆盖javascript点击事件

> ID：11542162
> 
> 赞同：0
> 
> 时间：2012-07-18T13:08:28.977
> 
> 标签：javascript, jquery, html

我想为网页中的所有锚点替换点击事件的默认操作。当我使用这段代码时：

```
<html> <head> <script>     
var list=document.getElementsByTagName("a");
var isChecked = false;

function load () {    
    for (i=0; i<list.length; i++)
    {
        var old = (list[i].onclick) ? list[i].onclick : function () {}; 
        list[i].onclick = function () {                 
        if( !isChecked)
        {
            test(); 
            old();
        }
        else
            old();
        };  
    }
}    
function test() {
    alert("new action");
    isChecked = true;
}     
</script> </head> 
<body onload="load();">     
<a id="nr_1" onClick="alert('test');"> Anchor 1 </A>
<a id="nr_2" onClick="alert('test2');"> Anchor 2 </A>      
</body> </html> 
```

当我单击一个锚点时，我会从测试功能中获得警报，然后是第二个锚点的默认功能（即使我单击第一个锚点）。当我再次单击两个锚点之一时，我总是从第二个锚点获得警报。如何为每个锚元素放回原来的 onclick 函数？当有人在 jquery 中有解决方案时，我也会很高兴。

**编辑**

我成功使用了这段代码：

```
function load()
{
$('a').attr('disabled', 'disabled');

$('a').click(function(e){
    if($(this).attr('disabled'))
    {
    alert("new");
    e.preventDefault(); 
    $('a').removeAttr("disabled");  
    this.click();
    }
});
} 
```

在加载页面时，调用此函数，为所有锚元素提供“禁用”属性。单击元素后，e.preventDefault() 函数将禁用内联 onclick 函数。然后我删除“禁用”属性并再次调用元素的点击函数。因为现在元素没有“禁用”属性，只执行默认功能。我仍然愿意为这个问题提供“更优雅”的解决方案，但现在我是一个快乐的露营者！

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-07-18T13:20:12.833

如果您使用 jQuery，您可以将一次性处理程序与持久处理程序结合起来：

[.one()](http://api.jquery.com/one/)和[.on()](http://api.jquery.com/on/)的文档

工作示例：http: [//jsfiddle.net/Q8gmN/](http://jsfiddle.net/Q8gmN/)

示例 HTML：

```
<input type="button" id="click" value="click" /> 
```

​ 示例 JavaScript：

```
button.one('click', function () {
  console.log('one time function fired');  
});

button.on('click', function () {
  console.log('persistent function fired');  
}); 
```

​</p>

# google-apps-script - 最近是否添加了新的图表服务功能？

> ID：11542165
> 
> 赞同：0
> 
> 时间：2012-07-18T13:08:41.863
> 
> 标签：google-apps-script

我提到 GAS Chart Service 包含一些未在[文档](https://developers.google.com/apps-script/class_charts)中描述的方法。有谁知道他们有什么目的？在哪里可以找到他们的文档？方法是

*   `Charts.newDashboardPanel()`
*   `Charts.newDataViewDefinition()`
*   `Charts.newCategoryFilter()`
*   `Charts.newNumberRangeFilter()`
*   `Charts.newStringFilter()`

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-07-19T19:16:52.697

这些新功能正处于发布的最后阶段，我们希望很快会有文档和公告。

# java - 为什么我不能删除和绘制相同的 java 对象？

> ID：11542169
> 
> 赞同：3
> 
> 时间：2012-07-18T13:09:01.633
> 
> 标签：java, breakout

我试着做功课，我写突破游戏。现在，我写了这个游戏完成的基本功能。但是我想增加红利当球撞到红砖时，我写了方法来检查它们并得到球撞到的颜色形式对象。

```
} else if(color == Color.BLACK){ 
        double xBonus = ball.getX() +20;
        double yBonus = ball.getY() +20;
        remove(ball);
        ball = new GOval(xBonus, yBonus, BALL_RADIUS+20, BALL_RADIUS+20);
        ball.setFilled(true);
        ball.setFillColor(Color.RED);
        add(ball); 
```

`GObject collider = getCollidingObject();` 我使用对撞机来检测球碰撞的物体，但是当球碰撞奖金砖时。球的尺寸增加了，但对撞机检测到新的球对象是砖块，并通过游戏边缘弹跳球。请帮助我..对不起，我的语法错误。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-08-09T21:56:26.923

我相信您想在 ball.getX 和 ball.getY 分配上使用 * 20 。

听起来新的球对象与原始游戏面板不在同一个实例中。您应该确保在进行游戏的面板上的同一实例中接受新的球对象。

如果您显示更多代码，我可能会更具体。

# php - php 数组函数没有正确的运算符分配？

> ID：11542172
> 
> 赞同：0
> 
> 时间：2012-07-18T13:09:06.237
> 
> 标签：php, arrays

我在一个关于读取 csv 文件的 php 脚本中看到了这一点：

```
 array($mydata); 
```

它有什么作用？来自 $mydata 的数组？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-07-18T13:11:04.853

是的，它创建了一个数组，其中`$mydata`第一个元素是。您甚至可以一次将许多元素放入其中：

```
php > $x = array(1,2,3);
php > var_dump($x);
array(3) {
  [0]=>
  int(1)
  [1]=>
  int(2)
  [2]=>
  int(3)
} 
```

但是，如果这就是那条线上发生的一切，我会说什么都没有发生。`array()`行为就像一个返回一个新数组的函数，如果它没有被分配给任何东西，它就会被简单地丢弃并且什么也没有发生。例子：

```
php > $y = 'foo';
php > array($y);
php > var_dump($y);
string(3) "foo" 
```

# aop - AspectJ：在@Around 建议中组合多个切入点时出现问题

> ID：11542181
> 
> 赞同：8
> 
> 时间：2012-07-18T13:09:29.370
> 
> 标签：aop, aspectj, execution, pointcuts

我是 AspectJ 的初学者，所以请指导我按照以下方法解决发生的问题。

```
 @Aspect
    public class TestAop {

    @Pointcut("execution(public * com.packg.foo.ClassOne.*(..))")
    public void fooPoint()

    @Pointcut("execution(public * com.packg.cat.ClassTwo.*(..))")
    public void catPoint()

    @Pointcut("execution(public * com.packg.roo.ClassThree.*(..))")
    public void rooPoint()

    @Around("fooPoint() || catPoint() || rooPoint()") 
    public Object myAdvice(ProceedingJoinPoint joinPoint) {
    //do something like joint proceed and all
    } 
```

什么时候不工作？如果我将所有三个切入点与 OR 结合起来。

它什么时候工作？如果我只保留两个切入点，它就可以工作。

我是否违反了@around 建议的任何规则。是否可以有多个执行/切入点？

期待答案...

* * *

## 回答 #1

> 赞同：19
> 
> 时间：2014-01-15T19:57:47.410

我有同样的问题，但更好的解决方案 IMO 是（对我有用）：

```
@Aspect
public class TestAop {

@Pointcut("execution(public * com.packg.foo.ClassOne.*(..)) || execution(public * com.packg.cat.ClassTwo.*(..)) || execution(public * com.packg.roo.ClassThree.*(..))")
public void fooPoint(){}

@Around("fooPoint()")
public Object myAdvice(ProceedingJoinPoint joinPoint) {
//do something like joint proceed and all
} 
```

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-07-28T18:41:32.473

我通过为每个切入点创建不同的建议解决了上述问题。我刚刚找到了一个替代解决方案，但我仍然不相信这一点。

```
@Aspect
public class TestAop {

@Pointcut("execution(public * com.packg.foo.ClassOne.*(..))")
public void fooPoint()

@Pointcut("execution(public * com.packg.cat.ClassTwo.*(..))")
public void catPoint()

@Pointcut("execution(public * com.packg.roo.ClassThree.*(..))")
public void rooPoint()

@Around("fooPoint()") 
public Object myFooAdvice(ProceedingJoinPoint joinPoint) {
//do something like joint proceed and all
}

@Around("catPoint()") 
public Object myCatAdvice(ProceedingJoinPoint joinPoint) {
//do something like joint proceed and all
}

@Around("rooPoint()") 
public Object myRooAdvice(ProceedingJoinPoint joinPoint) {
//do something like joint proceed and all
} 
```

# c - fscanf 如何处理不同的变量类型？

> ID：11542186
> 
> 赞同：-2
> 
> 时间：2012-07-18T13:09:35.950
> 
> 标签：c, file, variables, scanf

我正在查看有关 fsacnf 的 msdn 解释并尝试更改代码。这是一场灾难，我不明白它是如何工作的。例如，如果我有一个包含此信息的文件 x：“string”7 3.13 ' x' 当我写 scanf("%s",&string_input) 所以字符串被保存然后它转到下一行？-> 到 7？我现在要写： char test; fscanf("%c" , &test) -- 它会跳转到 'x' 还是取 7 并将其转换为它的 ascii 值？

这是我尝试过的代码和输出：

```
#include <stdio.h>

FILE *stream;

int main( void )
 {
    long l;
   float fp,fp1;
   char s[81];
    char c,t;

     stream = fopen( "fscanf.out", "w+" );
      if( stream == NULL )
        printf( "The file fscanf.out was not opened\n" );
      else
      {
      fprintf( stream, "%s %d %c%f%ld%f%c", "a-string",48,'y', 5.15,
              65000, 3.14159, 'x' );
  // Security caution!
  // Beware loading data from a file without confirming its size,
  // as it may lead to a buffer overrun situation.
  /* Set pointer to beginning of file: */
  fseek( stream, 0L, SEEK_SET );

  /* Read data back from file: */
  fscanf( stream, "%s", s );
  fscanf( stream, "%c", &t );
fscanf( stream, "%c", &c );

  fscanf( stream, "%f", &fp );
   fscanf( stream, "%f", &fp1 );
  fscanf( stream, "%ld", &l );

  printf( "%s\n", s );
   printf("%c\n" , t);
  printf( "%ld\n", l );
  printf( "%f\n", fp );
  printf( "%c\n", c );

  printf("f\n",fp1);
  getchar();

  fclose( stream );
    }
} 
```

这是输出：

```
字符串

-858553460
8.000000
4
F

```

不明白为什么

谢谢！！

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-07-18T13:18:26.993

缺少格式说明符：

```
printf("f\n",fp1); 
```

应该：

```
printf("%f\n",fp1); 
```

更重要**的是：检查`fscanf()`**. 它返回成功分配的数量：这里应该是`1`每次调用的次数，因为每次调用应该只有一个分配`fscanf()`。如果`fscanf()`失败，则变量未修改。由于代码中的变量未初始化，如果`fscanf()`未能分配给它们，它们将包含随机值，这里就是这种情况：

```
 /* a-string 48 y 5.15 65000 3.14159 x */
fscanf(stream, "%s", s);    /* ^             (s is assigned "a-string") */
fscanf(stream, "%c", &t);   /*         ^     (t is assigned space)      */
fscanf(stream, "%c", &c);   /*          ^    (c is assigned 4)          */
fscanf(stream, "%f", &fp);  /*           ^   (fp is assigned 8)         */
fscanf(stream, "%f", &fp1); /*             ^ (fail: 'y' is not a float) */
fscanf(stream, "%ld", &l);  /*             ^ (fail: 'y' is not a long)  */ 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-07-18T13:30:34.040

你的写声明是

> "%s %d %c%f%ld%f%c", "a-string",48,'y', 5.15, 65000, 3.14159, 'x'

如果您打印第五个参数 as`%ld`那么您也应该将其作为`(long)65000`. 但在大多数系统上，这不会产生影响。该文件的内容现在应该如下所示并被解析：

```
a-string 48 y5.15650003.14159x
^       ^^^
s       |c|
        t fp

s:  "a-string"
t:  ' '
l:  undefined
fp: 8
c:  '4'
fp1: undefined 
```

所以`s`匹配第一个单词，直到第一个空格。`t`匹配空格字符，因为`%c`不会跳过前导空格。`c`匹配 的第一个数字`48`和`fp`第二个数字。`%f`for将`fp1`跳过下一个空格，然后无法读取任何内容，因为`y`无法将字符读取为浮点数。`%ld`for`%l`会因为同样的原因而失败。您应该检查结果`fscanf`以检测和报告此类错误。

# wordpress - 如何移动 wordpress 博客？

> ID：11542188
> 
> 赞同：0
> 
> 时间：2012-07-18T13:09:40.680
> 
> 标签：wordpress, redirect

我有一个在 www.mydomain.com/blog1 下运行的 wordpress 博客。我想把它移到 www.mydomain.com/blog2。我的 blog1 链接已被 google 索引，我也想为它们设置 301 永久重定向。我怎样才能做到这一点？谢谢你。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-07-18T13:23:51.863

移动 WordPress 记录在[Codex](http://codex.wordpress.org/Moving_WordPress)中。按照那里提到的步骤进行操作。

至于重定向，你`.htaccess`应该修改。尝试添加这些行：

```
RewriteEngine on
RewriteBase /
RewriteRule ^blog1/(.*) www.mydomain.com/blog2/ [R=301,L] 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-07-18T13:26:12.263

试试这个-> [.htaccess](http://kb.mediatemple.net/questions/242/How+do+I+redirect+my+site+using+a+.htaccess+file%3F)

虽然我自己从未尝试过，但它应该可以工作！

# c# - 在 dll 中创建事件并在表单中处理事件

> ID：11542189
> 
> 赞同：3
> 
> 时间：2012-07-18T13:09:51.920
> 
> 标签：c#, .net

我使用以下代码创建了一个 DLL。我已将此代码编译为 DLL。

```
namespace DllEventTrigger
{
    public class Trigger
    {
        public delegate void AlertEventHandler(Object sender, AlertEventArgs e);

        public Trigger()
        {

        }

        public void isRinging()
        {
            AlertEventArgs alertEventArgs = new AlertEventArgs();
            alertEventArgs.uuiData = "Hello Damn World!!!";
            CallAlert(new object(), alertEventArgs);
        }
        public event AlertEventHandler CallAlert; 
    }

    public class AlertEventArgs : EventArgs
    {
        #region AlertEventArgs Properties
        private string _uui = null;
        #endregion

        #region Get/Set Properties
        public string uuiData
        {
            get { return _uui; }
            set { _uui = value; }
        }
        #endregion
    }
} 
```

现在我正在尝试使用此代码在表单应用程序中处理由此 dll 触发的事件。

```
namespace DLLTriggerReciever
{
    public partial class Form1 : Form
    {
        public Form1()
        {
            InitializeComponent();
        }

        private void button1_Click(object sender, EventArgs e)
        {
            Trigger trigger = new Trigger();
            trigger.isRinging();
            trigger.CallAlert += new Trigger.AlertEventHandler(trigger_CallAlert);
        }

        void trigger_CallAlert(object sender, AlertEventArgs e)
        {
            label1.Text = e.uuiData;
        }
    }
} 
```

我的问题我不确定我哪里出错了。请建议。

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-07-18T13:12:41.537

您需要在事件实际触发**之前**`NullReferenceException`分配事件处理程序，否则代码将抛出.

```
trigger.CallAlert += new Trigger.AlertEventHandler(trigger_CallAlert);
trigger.isRinging(); 
```

此外，建议先检查是否分配了处理程序：

```
var handler = CallAlert; // local variable prevents a race condition to occur

if (handler != null) 
{
  handler(this, alertEventArgs);
} 
```

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-07-18T13:17:27.913

正如@Gene 所说，您需要在引发事件之前注册该事件。无论如何，最好通过检查 null 来检查是否有人注册了您将要发起的事件。

像这样：

```
if (this.CallAlert != null)
    this.CallAlert(new object(), alertEventArgs); 
```

# php - 编辑刚刚插入的记录

> ID：11542190
> 
> 赞同：0
> 
> 时间：2012-07-18T13:09:53.763
> 
> 标签：php, javascript, crud

我正在用 javascript 制作一个 crud 应用程序 ui，我想知道如何做到这一点。基本上，我希望能够编辑我刚刚插入的记录。例如在 jqgrid 和 extjs 等网格中，这是可能的并且我很难弄清楚这是如何完成的。在普通的 php 和 html 中，我会有一个隐藏的输入，其中包含一些隐藏的值，比如

```
<input name="id" type="hidden" id="id" value="<? echo $rows['id']; ?>"> 
```

我有这个小提琴，我用它来调查通常会发生什么[http://jsfiddle.net/thiswolf/EgHP7/](http://jsfiddle.net/thiswolf/EgHP7/)

编辑：

这就是我插入新记录的方式

```
$.ajax({
        type: "POST",
  url: "update_data.php",
   data: dataString,
  cache: false,
  success: function(html){

  $("ol#update").prepend(html);
  $("ol#update li:first").slideDown("slow");
   document.getElementById('content').value='';
  $("#flash").hide();

  }
 }); 
```

这是php文件

```
<?php
include('db.php');
if(isSet($_POST['content']))
{
$content=$_POST['content'];
mysql_query("insert into messages(msg) values ('$content')");
$sql_in= mysql_query("SELECT msg,msg_id FROM messages order by msg_id desc");
$r=mysql_fetch_array($sql_in);
$msg=$r['msg'];
$msg_id=$r['msg_id'];
}
?>

<li class="bar<?php echo $msg_id; ?>">
<div align="left">
<span class="hello" id="<?php echo $msg_id; ?>" style=" padding:10px"><?php echo $msg; ?> </span>
<span class="delete_button">
<a href="#" id="<?php echo $msg_id; ?>"  class="update_btn">Edit</a>
<a href="#" id="<?php echo $msg_id; ?>" class="delete_update">Delete</a>
</span>
</div>
</li> 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-07-18T14:08:53.037

如何使用诸如`Date.now()`临时 id 之类的值，然后将该值插入数据库并插入客户端，可能使用 LocalStorage，然后当您想要编辑时，您只需将该值与数据库中的值进行比较。

# javascript - JavaScript 中的覆盖函数

> ID：11542192
> 
> 赞同：38
> 
> 时间：2012-07-18T13:09:56.243
> 
> 标签：javascript, prototype

> **可能重复：**
> [使用 JavaScript 原型调用基本方法](https://stackoverflow.com/questions/560829/calling-base-method-using-javascript-prototype)

我想继承将覆盖javascript中的函数的对象。

从我要调用的方法到基本方法。在这种情况下，我继承了对象`reader`，`Person`现在我想覆盖该函数`getName`，这意味着在阅读器中我首先要调用该函数`Person`，然后进行一些更改。

```
<script>
    /* Class Person. */
    function Person(name) {
        this.name = name;
    }
    Person.prototype.getName = function() {
        return this.name;
    }

    var reader = new Person('John Smith');
    reader.getName = function() {
        // call to base function of Person, is it possible?
        return('Hello reader');
    }
    alert(reader.getName());
</script> 
```

* * *

## 回答 #1

> 赞同：37
> 
> 时间：2012-07-18T13:45:32.783

文森特回答了您的直接问题，但是如果您想建立一个真正的继承层次结构，您可以进一步扩展，您可以这样做`Reader`。

创建您的人员类：

```
function Person(name) {
    this.name = name;
}

Person.prototype.getName = function(){
    alert('Person getName called for ' + this.name);
    return this.name;
} 
```

同时创建一个 Reader 类：

```
function Reader(name) {
    // Calls the person constructor with `this` as its context
    Person.call(this, name);
}

// Make our prototype from Person.prototype so we inherit Person's methods
Reader.prototype = Object.create(Person.prototype);

// Override Persons's getName
Reader.prototype.getName = function() {
    alert('READER getName called for ' + this.name);
    // Call the original version of getName that we overrode.
    Person.prototype.getName.call(this);
    return 'Something';
}
Reader.prototype.constructor = Reader; 
```

现在我们可以重复类似的过程来扩展 Reader，比如 VoraciousReader：

```
function VoraciousReader(name) {
    // Call the Reader constructor which will then call the Person constructor
    Reader.call(this, name);
}

// Inherit Reader's methods (which will also inherit Person's methods)
VoraciousReader.prototype = Object.create(Reader.prototype);
VoraciousReader.prototype.constructor = VoraciousReader;
 // define our own methods for VoraciousReader
//VoraciousReader.prototype.someMethod = ... etc. 
```

小提琴：http: [//jsfiddle.net/7BJNA/1/](http://jsfiddle.net/7BJNA/1/)

Object.create：[https ://developer.mozilla.org/en/JavaScript/Reference/Global_Objects/Object/create](https://developer.mozilla.org/en/JavaScript/Reference/Global_Objects/Object/create)

`Object.create(arg)`正在创建一个新对象，其原型是作为参数传入的。

**编辑** 自从这个原始答案以来已经有好几年了，现在 Javascript 支持`class`关键字，如果您来自 Java 或 C++ 之类的语言，则该关键字可以正常工作。[https://developer.mozilla.org/en-US/docs/Web/JavaScript/Reference/Classes](https://developer.mozilla.org/en-US/docs/Web/JavaScript/Reference/Classes)

* * *

## 回答 #2

> 赞同：34
> 
> 时间：2012-07-18T13:13:32.427

由于您正确地覆盖了对象本身而不是其原型上的函数，因此您仍然可以使用您的对象调用原型函数。

```
reader.getName = function() {
    var baseName = Person.prototype.getName.call(this);
    ...
} 
```

* * *

## 回答 #3

> 赞同：5
> 
> 时间：2012-07-18T13:16:05.467

我使用 John Resig 的这项技术来获得继承和方法覆盖。它甚至允许您通过调用 this._super() 来访问被覆盖的方法。

[http://ejohn.org/blog/simple-javascript-inheritance/](http://ejohn.org/blog/simple-javascript-inheritance/)

* * *

## 回答 #4

> 赞同：2
> 
> 时间：2012-07-18T13:14:33.477

这是一种方法：

```
function Person(name) {
this.name = name;
}
Person.prototype.getName = function(){
return this.name;
}

var reader = new Person('John Smith');
reader.oldGetName = reader.getName;
reader.getName = function() {
//call to base function of Person , is it possible ?
    return this.oldGetName();
}
alert(reader.getName());​ 
```

[http://jsfiddle.net/fXWfh/](http://jsfiddle.net/fXWfh/)

# iphone - 如何从 Phonegap（iPhone 应用程序）调用 SOAP 服务

> ID：11542195
> 
> 赞同：3
> 
> 时间：2012-07-18T13:10:21.330
> 
> 标签：iphone, soap, cordova

我正在尝试使用[此 SOAP 客户端](http://www.guru4.net/articoli/javascript-soap-client/en/)调用 SOAP 服务，但它对我不起作用。请帮我。如何使用 Phonegap 发送和接收 XML SOAP？

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2012-07-18T13:36:36.670

Phonegap 是 HTML/JS/CSS 通常通过 XHR/Ajax 进行通信。最好使用**jQuery Ajax**函数。您可以在[此处](http://api.jquery.com/jQuery.ajax/)获取详细信息。

例如：

[发布 XML SOAP 请求](http://www.bennadel.com/blog/1853-Posting-XML-SOAP-Requests-With-jQuery.htm)

[AJAX-Requests-Between-jQuery](http://www.bennadel.com/blog/2327-Cross-Origin-Resource-Sharing-CORS-AJAX-Requests-Between-jQuery-And-Node-js.htm)

[调用 SOAP Web 服务的简单 jQuery 客户端](http://leonidius2010.wordpress.com/2011/05/16/98/)

如果您发现任何跨域问题（或在浏览器中工作而不使用模拟器/设备），请参考以下步骤。

转到**Resources**文件夹，您可以看到一个名为**Cordova.plist**的文件。单击它，您可以看到**Root**元素。右键单击 Root，添加一行，将键设置为**ExternalHosts**类型为**Array**。

展开项目，并将项目添加为**item0**。给它类型**字符串**并输入值作为'*'。

不要忘记在更改后保存 Cordova.plist（只需使用 cmd+s）。

# sql - Sql Server FOR XML - 编码结果以防止格式错误的 xml

> ID：11542196
> 
> 赞同：1
> 
> 时间：2012-07-18T13:10:23.903
> 
> 标签：sql, sql-server, sql-server-2008, for-xml

我正在使用 SQL SERVER 2008 R2。我有一个使用 FOR XML 将结果作为 XML 返回的存储过程。这是存储过程的样子：

```
CREATE PROCEDURE [dbo].[myproc]
(
    @ID int,
)
AS
SET NOCOUNT ON
BEGIN 
SELECT 
    t1.FirstField
    t2.AnotherField
    t1.ThirdField
FROM table t1 
INNER JOIN table2 t2 ON t1.ID = t2.ID 
WHERE t1.id = @ID FOR XML RAW ('project'), ELEMENTS;
END 
```

这可以按预期工作并生成如下 XML：

```
<project>
  <FirstField>First field data</FirstField>
  <AnotherField> Another field data</AnotherField>
  <ThirdField>Third field data</ThirdField>
</project> 
```

这就是我想要的。但是我担心的是，当 XML 中有特殊字符（例如 < 和 >）时，这不会搞砸并导致 XML 格式错误吗？有没有办法解决这个问题？我可以在调用此存储过程的代码中进行一些检查，以查看它是否是有效的 XML，但是到发生这种情况时会不会太晚了？如果有人可以就我应该如何处理这个问题提出一些建议，我将不胜感激。非常感谢。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-07-18T13:17:39.957

SQL-Server 会自动为您编码您的 XML。

例如

```
SELECT  '<xml>Test</xml>'
FOR XML RAW ('Project'), ELEMENTS 
```

返回

```
<Project>&lt;xml&gt;Test&lt;/xml&gt;</Project> 
```

如果您需要特殊字符，则需要在从 SQL-Server 请求它的任何层中解码您的 xml。

**编辑**

如果您确实想在字段中保留特殊字符，则需要使用 CDATA。这需要`FOR XML EXPLICIT`. 下面将保留特殊字符并返回您需要的 xml 格式。

```
SELECT  1 AS Tag,
        NULL AS Parent,
        FirstField AS [Project!1!FirstField!cdata],
        AnotherField AS [Project!1!AnotherField!Cdata],
        ThirdField AS [Project!1!ThirdField!cdata]
FROM    table t1 
        INNER JOIN table2 t2 
            ON t1.ID = t2.ID 
WHERE   t1.ID = @ID
FOR XML EXPLICIT 
```

# php - 多个 MySQLi 准备好的语句和漏洞（评价我的代码）

> ID：11542198
> 
> 赞同：0
> 
> 时间：2012-07-18T13:10:27.287
> 
> 标签：php, mysql, mysqli

关于 MySQLi 在 PHP 中准备语句的超长问题。开始。

使用 MySQLi 准备好的语句是否完全不受 SQL 注入的影响？例如，请参见下面的代码，我是否认为可以直接从用户那里使用 $_POST 变量而无需任何注入保护？出于这个问题的目的，请忽略验证数据以确保它是我的数据库的正确格式（无论如何我总是这样做），我在这里更关注安全性。

```
$mysqli=new mysqli($host, $user, $password, $database);

$stmt=$mysqli->stmt_init();
$stmt->prepare('INSERT INTO `tablename` (`column`) VALUES (?)');

$stmt->bind_param('s', $_POST['value']);
$stmt->execute();

$stmt->close();
$mysqli->close(); 
```

我的代码也正确吗？这只是我第二次或第三次使用 MySQLi 类编写准备好的语句。虽然它有效，但我想知道我是否正确地做所有事情？该脚本的任何部分都可以被认为是不好的做法吗？

最后，我将如何处理使用相同数据库连接的多个准备好的语句？我是否只在 $stmt 上使用 close() 方法，然后初始化另一个 $stmt 类？

谢谢！

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-07-18T13:14:01.823

参数**绑定**对 SQL 注入是安全的。你不需要担心那部分。它将用户输入与不安全的 SQL 语句**连接起来。**

# php - 在页面加载时触发 onchange html 事件

> ID：11542199
> 
> 赞同：1
> 
> 时间：2012-07-18T13:10:30.023
> 
> 标签：php, ajax, jquery, triggers

好的，我在选择字段上有一个 onchange 事件。现在效果很好。当下拉“网络”更改时，它会刷新第二个下拉列表。我还希望顶部的 ajax 代码在页面加载和 onchange 时触发，以便填充第二个列表。这是因为它位于编辑页面上。这是我首先使用的ajax调用

```
function get_cities(networks) {
    $.ajax({
        type: "POST",
        url: "select.php", /* The country id will be sent to this file */
        beforeSend:     function () {
            $("#folder").html("<option>Loading ...</option>");
        },
        //data: "idnetworks="+networks,
        data: "idnetworks="+networks +"&doc="+ <?php echo $row_rs_doc['parentid']; ?>,
        success: function(msg){
            $("#folder").html(msg);
        }
    });
} 
```

现在两个下拉框

```
<label for="networks"></label>
<select name="networks" id="networks" onChange='get_cities($(this).val())'>
    <?php
    do {  
    ?>
        <option value="<?php echo $row_rs_net['idnetworks']?>"<?php if (!(strcmp($row_rs_net['idnetworks'], $row_rs_doc['network']))) {echo "selected=\"selected\"";} ?>><?php echo $row_rs_net['netname']?></option>
    <?php
    } while ($row_rs_net = mysql_fetch_assoc($rs_net));
    $rows = mysql_num_rows($rs_net);
    if($rows > 0) {
        mysql_data_seek($rs_net, 0);
        $row_rs_net = mysql_fetch_assoc($rs_net);
    };
    ?>
</select>
<select name="folder" id="folder">
</select> 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-07-18T13:19:42.220

您可以使用在选择框上`.trigger()`触发一个`change`事件，以便调用 onchange 代码，就像用户刚刚切换选项一样。

```
jQuery('#networks').trigger('change'); 
```

只需将其包含在页面的加载事件/函数中即可。

```
jQuery(document).ready(function() {
    jQuery('#networks').trigger('change');
}); 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-07-18T13:17:31.540

我不是 100% 清楚你想要什么，但是在页面加载时使用 JQuery 做某事的标准方法是使用

```
$(document).ready(handler) 
```

这会等到页面“准备好”，这样会更好。

所以，在你的文件头你会有这样的东西......

```
<script type="text/javascript">
$(document).ready( function(){
  do_some_stuff();
});
</script> 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-07-18T13:19:23.537

你不能`get_cities($('#networks').val())`在 DOM 准备好时调用吗？

```
$(function() { // will be run by jQuery when DOM is ready
  get_cities($('#networks').val());
}); 
```

# python - 在 Django 的抽象父模型类中实现所需的接口

> ID：11542205
> 
> 赞同：1
> 
> 时间：2012-07-18T13:10:48.013
> 
> 标签：python, django, model

我已经定义了一个基础抽象模型类，它为模型提供了一些额外的功能，如下所示：

```
class BaseModel(models.Model):
    # ... some fields and methods
    class Meta:
        abstract = True

class Model1(BaseModel):
    # ... some fields and methods
    def required_method(self, *args, *kwargs):
        # implementation

class Model2(BaseModel):
    # ... some fields and methods 
```

现在我需要确保每个派生类都定义了许多必需的方法。如果其中任何一个未定义，我需要在 manage.py 尝试执行时抛出异常。所以换句话说，BaseModel 应该要求每个派生类定义一些接口，这个 BaseModel 使用，但不是自己定义的。

我应该在哪里实施此检查？是检查这个`__init__`的`BaseModel`好地方吗？

**编辑**：这样做的目的只是为了安全。如果有人或我在一段时间后尝试从`BaseModel`类继承，但忘记实现所需的方法，代码仍将运行，直到`BaseModel`代码尝试执行任何缺失的方法。所以这对我来说有潜在的危险。最好防止执行此类代码。我相信 Java 有这种称为[接口](http://en.wikipedia.org/wiki/Interface_%28Java%29)的机制。我想在 Python 中做类似的事情。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-07-18T14:26:00.030

使用[abc](http://docs.python.org/library/abc.html)包中的装饰器来标记哪些方法应该是抽象的。该包裹会为您进行检查，因此您甚至不必担心检查的正确位置；-)

# java - 播放框架 2.0.2 中不存在渲染功能？

> ID：11542207
> 
> 赞同：3
> 
> 时间：2012-07-18T13:10:59.877
> 
> 标签：java, playframework, controller, render

我下载并安装了play framework 2.0.2，然后创建了一个项目。我使项目黯然失色并在eclipse中打开它。

我有一个名为 Application 的类，它扩展了 Controller 类。在网络上的大多数示例中，我看到如下控制器。

```
public class Application extends Controller {
    public static void index() {
        render(arg0,arg1,...);
    }

    public static void tasks() {
         render(arg0,arg1,...);
    }

    public static void newTask() {
         render(arg0,arg1,...);
    }

    public static void deleteTask(Long id) {
        render(arg0,arg1,...);
    }
} 
```

但是在我的默认应用程序中，我只能执行以下操作。不知道上一个怎么办。

```
public class Application extends Controller {
    public static Result index() {
        return ok("Hello World!");
    }

    public static Result tasks() {
         return ok(indexabc.render("hello world"));
    }

    public static Result newTask() {
         return TODO;
    }

    public static Result deleteTask(Long id) {
        return TODO;
    }
} 
```

在我的代码中，当我尝试用“void”替换“Result”返回类型时，没有问题。但是，当我想用​​一些参数调用“render()”方法时，该方法不存在。我找不到如何调用渲染函数的方法。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-07-18T13:36:40.260

您在 Web 上看到的示例适用于 Play 1.x，而您在 Controller 中获得的版本适用于 Play 2.x。

Play 1 used `render()`, play 2 返回一个 Result 对象，该对象是通过调用该`ok()`方法或许多其他方法创建的。

此时您有 2 个选项。下载 Play 1.2.5（当前稳定版本）并使用您找到的示例，或使用 Play 2.x 文档并搜索 Play 2.x 示例。

# ios - TableView 和 MapView 相同的详细视图

> ID：11542210
> 
> 赞同：-1
> 
> 时间：2012-07-18T13:11:11.910
> 
> 标签：ios, uitableview, mkmapview

我有一个表格视图，它从数组中的 xml 加载数据并显示它，每个单元格都指向重新填充的同一个详细视图。

在同一个视图中，我有一个隐藏的地图视图，地图视图在地图中显示相同的表格数组，每个注释都有一个指向表格的相同详细视图的披露按钮，但我不明白我是如何可以将数据从地图视图传递到详细视图...

对于披露按钮，我使用此代码

```
-(IBAction)showDetails:(id)sender{

DettMercatiViewController *dettMercatiViewController = [[DettMercatiViewController alloc] initWithNibName:@"DettMercatiViewController" bundle:nil];
dettMercatiViewController.mieiMercati = [table objectAtIndex:????];
[self.navigationController pushViewController:dettMercatiViewController animated:YES];
[dettMercatiViewController release]; 

} 
```

table 是从 xml 创建的 nsmutablearray 的名称，但我不知道 objectIndex 使用什么...任何想法？

好的，这里是viewdidload和pin的创建，请帮我解释一下，因为我很冷漠：

```
 - (void)viewDidLoad
{
    pp =0;

//Colore NavigationBar
self.navigationController.navigationBar.tintColor = [UIColor colorWithRed:33.0f/255.0f green:89.0f/255.0f blue:50.0f/255.0f alpha:1.0f];

//Font Navigation Bar
UILabel *label = [[UILabel alloc] initWithFrame:CGRectMake(0, 0, 200, 45)];
label.backgroundColor = [UIColor clearColor];
label.font = [UIFont fontWithName:@"Museo700-Regular" size:20];
label.shadowColor = [UIColor colorWithWhite:0.0 alpha:0.5];
label.textAlignment = UITextAlignmentCenter;
label.textColor =[UIColor whiteColor];
label.text=[self.title uppercaseString];  
self.navigationItem.titleView = label; 
[label release];

//creazione nome XML
NSUserDefaults *defaults = [NSUserDefaults standardUserDefaults];
NSString *nomeXML = [NSString stringWithFormat: @"%@_%@_%@",[defaults stringForKey:@"interesse"],[defaults stringForKey:@"provincia"],[defaults stringForKey:@"giorno"]]; 

NSLog(@"%@", nomeXML);

//Caricamento XML
table = [[NSMutableArray alloc] init];  
NSString *url = [[NSBundle mainBundle] pathForResource:nomeXML ofType:@"xml"];
XMLParser *myParser = [[[XMLParser alloc]autorelease] parseXMLAtURL:url toObject:@"Mercato" parseError:nil];

for(int i = 0; i < [[myParser items] count]; i++) {
    Mercato *new = [[myParser items] objectAtIndex:i];
    [table addObject:new];

///////////////////////////////////////////
//definizione posizione utente

AppDelegate *appDelegate=(AppDelegate *)[UIApplication sharedApplication].delegate;

CLLocation *userLoc = appDelegate.locationManager.location;
CLLocationCoordinate2D userCoordinate = userLoc.coordinate;

NSLog(@"user latitude = %f",userCoordinate.latitude);
NSLog(@"user longitude = %f",userCoordinate.longitude);

mapView.delegate=self;

//Pin Mappa

    CLLocationCoordinate2D theCoordinate;
    theCoordinate.latitude = [new.latitudine doubleValue];
    theCoordinate.longitude = [new.longitudine doubleValue];

    myAnnotation=[[MyAnnotation alloc] init];

    myAnnotation.coordinate=theCoordinate;
    myAnnotation.title=[NSString stringWithFormat:@"%@", new.ubicazione];
    myAnnotation.subtitle=[NSString stringWithFormat:@"%@, %@, %@",new.comune, new.giorno, new. orario];

    [mapView addAnnotation:myAnnotation];

    [annotations addObject:myAnnotation];

    if([new.latitudine doubleValue] == 0) {
        [mapView removeAnnotation:myAnnotation];
        myAnnotation = nil;
    }

    // Inizializza mappa al Centro della Provincia

    NSUserDefaults *defaults = [NSUserDefaults standardUserDefaults];

    if (([[defaults stringForKey:@"provincia"] isEqualToString:@"bergamo"])) {
        MKCoordinateRegion newRegion;
        newRegion.center.latitude = 45.6982642;
        newRegion.center.longitude = 9.6772698;
        newRegion.span.latitudeDelta = 0.512872;
        newRegion.span.longitudeDelta = 0.509863;
        [mapView setRegion:newRegion animated:YES];
    }

    if (([[defaults stringForKey:@"provincia"] isEqualToString:@"brescia"])) {
        MKCoordinateRegion newRegion;
        newRegion.center.latitude = 45.5411875;
        newRegion.center.longitude = 10.2194437;
        newRegion.span.latitudeDelta = 0.512872;
        newRegion.span.longitudeDelta = 0.509863;
        [mapView setRegion:newRegion animated:YES];
    }

    if (([[defaults stringForKey:@"provincia"] isEqualToString:@"como"])) {
        MKCoordinateRegion newRegion;
        newRegion.center.latitude = 45.8080597;
        newRegion.center.longitude = 9.0851765;
        newRegion.span.latitudeDelta = 0.512872;
        newRegion.span.longitudeDelta = 0.509863;
        [mapView setRegion:newRegion animated:YES];
    }

    if (([[defaults stringForKey:@"provincia"] isEqualToString:@"cremona"])) {
        MKCoordinateRegion newRegion;
        newRegion.center.latitude = 45.133249;
        newRegion.center.longitude = 10.0226511;
        newRegion.span.latitudeDelta = 0.512872;
        newRegion.span.longitudeDelta = 0.509863;
        [mapView setRegion:newRegion animated:YES];
    }

    if (([[defaults stringForKey:@"provincia"] isEqualToString:@"lecco"])) {
        MKCoordinateRegion newRegion;
        newRegion.center.latitude = 45.8565698;
        newRegion.center.longitude = 9.3976704;
        newRegion.span.latitudeDelta = 0.512872;
        newRegion.span.longitudeDelta = 0.509863;
        [mapView setRegion:newRegion animated:YES];
    }

    if (([[defaults stringForKey:@"provincia"] isEqualToString:@"lodi"])) {
        MKCoordinateRegion newRegion;
        newRegion.center.latitude = 45.3138041;
        newRegion.center.longitude = 9.5018274;
        newRegion.span.latitudeDelta = 0.512872;
        newRegion.span.longitudeDelta = 0.509863;
        [mapView setRegion:newRegion animated:YES];
    }

    if (([[defaults stringForKey:@"provincia"] isEqualToString:@"mantova"])) {
        MKCoordinateRegion newRegion;
        newRegion.center.latitude = 45.1564168;
        newRegion.center.longitude = 10.7913751;
        newRegion.span.latitudeDelta = 0.512872;
        newRegion.span.longitudeDelta = 0.509863;
        [mapView setRegion:newRegion animated:YES];
    }

    if (([[defaults stringForKey:@"provincia"] isEqualToString:@"milano"])) {
        MKCoordinateRegion newRegion;
        newRegion.center.latitude = 45.4654542;
        newRegion.center.longitude = 9.186516;
        newRegion.span.latitudeDelta = 0.512872;
        newRegion.span.longitudeDelta = 0.512872;
        [mapView setRegion:newRegion animated:YES];
    }

    if (([[defaults stringForKey:@"provincia"] isEqualToString:@"monza e brianza"])) {
        MKCoordinateRegion newRegion;
        newRegion.center.latitude = 45.623599;
        newRegion.center.longitude = 9.2588015;
        newRegion.span.latitudeDelta = 0.512872;
        newRegion.span.longitudeDelta = 0.509863;
        [mapView setRegion:newRegion animated:YES];
    }

    if (([[defaults stringForKey:@"provincia"] isEqualToString:@"pavia"])) {
        MKCoordinateRegion newRegion;
        newRegion.center.latitude = 45.1847248;
        newRegion.center.longitude = 9.1582069;
        newRegion.span.latitudeDelta = 0.512872;
        newRegion.span.longitudeDelta = 0.509863;
        [mapView setRegion:newRegion animated:YES];
    }

    if (([[defaults stringForKey:@"provincia"] isEqualToString:@"sondrio"])) {
        MKCoordinateRegion newRegion;
        newRegion.center.latitude = 46.1698583;
        newRegion.center.longitude = 9.8787674;
        newRegion.span.latitudeDelta = 0.512872;
        newRegion.span.longitudeDelta = 0.509863;
        [mapView setRegion:newRegion animated:YES];
    }

    if (([[defaults stringForKey:@"provincia"] isEqualToString:@"varese"])) {
        MKCoordinateRegion newRegion;
        newRegion.center.latitude = 45.8205989;
        newRegion.center.longitude = 8.8250576;
        newRegion.span.latitudeDelta = 0.512872;
        newRegion.span.longitudeDelta = 0.509863;
        [mapView setRegion:newRegion animated:YES];
    }

}
////////////////////////////

    [super viewDidLoad];

   }

 #pragma mark MKMapViewDelegate

 - (MKAnnotationView *)mapView:(MKMapView *)mapView viewForAnnotation:(id <MKAnnotation>)annotation{
NSLog(@"welcome into the map view annotation");
pp++;

// if it's the user location, just return nil.
if ([annotation isKindOfClass:[MKUserLocation class]]){

    return nil;

}

// try to dequeue an existing pin view first
static NSString* AnnotationIdentifier = @"AnnotationIdentifier";
pinView = [[[MKPinAnnotationView alloc] initWithAnnotation:myAnnotation reuseIdentifier:AnnotationIdentifier]autorelease];
pinView.animatesDrop=YES;
pinView.canShowCallout=YES;
pinView.pinColor=MKPinAnnotationColorGreen;
pinView.tag = pp;

UIButton* rightButton = [UIButton buttonWithType:UIButtonTypeDetailDisclosure];

[rightButton setTitle:myAnnotation.title forState:UIControlStateNormal];
[rightButton addTarget:self
                action:@selector(showDetails:)
      forControlEvents:UIControlEventTouchUpInside];
pinView.rightCalloutAccessoryView = rightButton;

return pinView;

 }

  ////////////////
   -(IBAction)showDetails:(id)sender{

    NSLog(@"%i", pp);

   DettMercatiViewController *dettMercatiViewController = [[DettMercatiViewController alloc]  initWithNibName:@"DettMercatiViewController" bundle:nil];
dettMercatiViewController.mieiMercati = [table objectAtIndex:[sender tag]];
[self.navigationController pushViewController:dettMercatiViewController animated:YES];
[dettMercatiViewController release]; 

} 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-07-18T13:16:18.810

我建议给你的地图视图中的每个披露按钮一个标签，你可以使用这个标签而不是这样

```
[table objectAtIndex:[sender tag]]; 
```

# java - 可以将字符串转换为枚举值吗？

> ID：11542215
> 
> 赞同：1
> 
> 时间：2012-07-18T13:11:27.173
> 
> 标签：java, enums, bufferedreader

我有这样的代码：

```
BufferedReader in = new BufferedReader(new FileReader("C:\file.txt"));
String text = in.readLine();//lets say text is now "asd" 
```

现在，我有了一个方法：

```
private static void doSomething(Enum word){
    ...
} 
```

是否有可能以某种方式将此文本转换为枚举？

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-07-18T13:12:38.390

你想使用[`Enum.valueOf`](http://docs.oracle.com/javase/1.5.0/docs/api/java/lang/Enum.html#valueOf%28java.lang.Class,%20java.lang.String%29)：

```
WhateverEnum.valueOf(someString); 
```

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-07-18T13:12:54.127

你可以使用

```
 MyEnum me = Enum.valueOf(MyEnum.class, word); 
```

或者

```
 MyEnum me = MyEnum.valueof(word) 
```

# c# - 如何轻松地从 lambda 函数创建比较器？

> ID：11542216
> 
> 赞同：4
> 
> 时间：2012-07-18T13:11:26.987
> 
> 标签：c#

我想知道.Net 框架中是否提供了一个实现 IComparer 并且可以从 lambda 函数构造的类。能够做到这一点将很有用：

```
void SortByLength(List<string> t)
{
    t = t.OrderBy(
           s => s, 
           Comparer<string>.FromLambda((s1,s2) => s1.Length.CompareTo(s2.Length))
        ).ToList();
} 
```

这比每次都必须定义一个 Comparer 类要容易得多。我知道创建这样的 FromLambda 方法并不复杂，但我想知道框架中是否存在现有方法，因为我认为这是一个非常常见的功能。

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-09-05T21:00:47.440

其他答案来自 .NET 4.5 发布之前。但是使用 .NET 4.5 (Visual Studio 2012) 的 BCL，您只需说

```
Comparer<string>.Create((s1,s2) => s1.Length.CompareTo(s2.Length)) 
```

请参阅[`Comparer<T>.Create`文档](http://msdn.microsoft.com/en-us/library/hh737198.aspx)。

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2012-07-18T13:17:04.000

你为什么要让事情变得那么困难？

按长度排序列表很简单：

```
var ordered = list.OrderBy(s => s.Length); 
```

如果你真的需要那些复杂的东西，ComparationComparer 可以帮助你。请看这里：[将比较转换为 icomparer](http://dpatrickcaldwell.blogspot.de/2009/04/converting-comparison-to-icomparer.html)

这是从 lamda 或委托构建 IComparer！

这是该示例中的基本代码

```
public class ComparisonComparer<T> : IComparer<T>  
{  
    private readonly Comparison<T> _comparison;  

    public ComparisonComparer(Comparison<T> comparison)  
    {  
        _comparison = comparison;  
    }  

    public int Compare(T x, T y)  
    {  
        return _comparison(x, y);  
    }  
} 
```

* * *

## 回答 #3

> 赞同：3
> 
> 时间：2012-07-18T13:20:11.830

我最终为常用方法（OrderBy、GroupBy 等）创建了额外的重载，以便为 IComparer 和 IEqualityComparer 获取 lambda：

```
public static class EnumerableExtensions
{
    public static IEnumerable<TSource> OrderBy<TSource, TKey>(this IEnumerable<TSource> source, Func<TSource, TKey> keySelector, Func<TKey, TKey, int> comparer)
    {
        return source.OrderBy(keySelector, new GenericComparer<TKey>(comparer));
    }

    private class GenericComparer<T> : IComparer<T>
    {
        private readonly Func<T, T, int> comparer;

        public GenericComparer(Func<T, T, int> comparer)
        {
            this.comparer = comparer;
        }

        public int Compare(T x, T y)
        {
            return this.comparer(x, y);
        }
    }
} 
```

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2012-07-18T13:18:13.663

我认为你把事情复杂化了。

```
void SortByLength(List<string> t) 
{ 
    t = t.OrderBy( 
           s => s.Length
        ).ToList();     
} 
```

# c# - 获取父目录的父目录

> ID：11542218
> 
> 赞同：18
> 
> 时间：2012-07-18T13:11:45.267
> 
> 标签：c#

我有一个与网络上的位置相关的字符串，我需要从该位置获取 2 向上的目录。

字符串可以采用以下格式：

```
string networkDir = "\\\\networkLocation\\staff\\users\\username"; 
```

在这种情况下，我需要该`staff`文件夹并可以使用以下逻辑：

```
string parentDir1 = Path.GetDirectoryName(networkDir);
string parentDir2 = Path.GetPathRoot(Path.GetDirectoryName(networkDir)); 
```

但是，如果字符串采用以下格式：

```
string networkDir = "\\\\networkLocation\\users\\username"; 
```

我只需要该`networkLocation`部分并`parentDir2`返回null。

我怎样才能做到这一点？

澄清一下：如果根目录恰好是给定文件夹中的目录 2，那么这就是我需要返回的内容

* * *

## 回答 #1

> 赞同：24
> 
> 时间：2012-07-18T13:14:15.257

您可以使用 System.IO.DirectoryInfo 类：

```
DirectoryInfo networkDir=new DirectoryInfo(@"\\Path\here\now\username");
DirectoryInfo twoLevelsUp=networkDir.Parent.Parent; 
```

* * *

## 回答 #2

> 赞同：9
> 
> 时间：2012-07-18T13:56:28.397

```
DirectoryInfo d = new DirectoryInfo("\\\\networkLocation\\test\\test");
if (d.Parent.Parent != null) 
{ 
    string up2 = d.Parent.Parent.ToString(); 
}
else 
{ 
    string up2 = d.Root.ToString().Split(Path.DirectorySeparatorChar)[2]; 
} 
```

是我一直在寻找的。对造成的任何混乱表示歉意！

* * *

## 回答 #3

> 赞同：3
> 
> 时间：2013-11-08T22:01:53.450

我遇到了类似的情况。看起来你可以打电话`GetDirectoryName`两次！

```
var root = Path.GetDirectoryName( Path.GetDirectoryName( path ) ); 
```

中提琴！

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2012-07-18T18:47:30.440

你可以试试这个（我一直在命令行/批处理文件中使用它）。

```
string twolevelsup = Path.Combine("\\\\networkLocation\\staff\\users\\username", "..\\..\\"); 
```

# c# - DataGridView 控件中的字段自动递减

> ID：11542220
> 
> 赞同：0
> 
> 时间：2012-07-18T13:11:50.850
> 
> 标签：c#, datagridview

我有一个绑定到 mdb 文件的 DataGridView 控件。第一个字段是 id。我还没有制作 mdb 文件。在程序中，我看到每当我创建新行时，id 都会变为-1。如果我离开它并转到另一行，表明我不会添加新行并返回到它（最后一行），则该字段将变为-2。当我反复这样做时，我发现该值每次都会递减。

一开始mdb文件有两行，id为1和2。如果定义为自增字段，则每次必须初始化为3，而不是每次递减。

由于这是我第一次尝试使用 DataGridView，请告知我此行为以及如何解决此问题？

# solr - 我如何知道 Solr 复制和提交需要多长时间

> ID：11542227
> 
> 赞同：2
> 
> 时间：2012-07-18T13:12:05.257
> 
> 标签：solr

我知道我的 Solr commitWithin 应该设置为比提交通常需要的更长的长度。

同样，在我的复制设置中，我想我的 pollInterval 应该设置为比复制时间更长的时间。

我不知道如何查看提交和复制需要多长时间 - 我该怎么做？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-07-19T14:37:02.843

当您向 Solr 发送任何请求时，您会在响应中返回 QTime。这是服务器处理您的请求所花费的时间。如果您发送提交，您将获得提交本身所花费的时间。
如果您使用自动提交，您可以查看 Solr 日志文件以了解提交需要多长时间。我不知道任何其他方式。
您还可以查看[solrmeter](http://code.google.com/p/solrmeter/)，它允许您针对正在运行的 Solr 运行一些性能测试，它显示了一个漂亮的图表，包括提交时间。关于复制，您可以获得一些将参数 command=details 传递给复制处理程序的详细信息，但我不确定是否有一些复制时间。如果不是，您需要再次查看您的日志文件。

# jquery - 为什么我不能将显示我的类名的文本添加到 jquery 句柄？

> ID：11542228
> 
> 赞同：1
> 
> 时间：2012-07-18T13:12:05.480
> 
> 标签：jquery

```
inClass = "'"+'.'+inClass+"'";      //inClass is a string
$(inClass).show(); 
```

Chrome 控制台错误>>未捕获的错误：语法错误，无法识别的表达式：''

我想动态更改 inclass 字符串如何使用 jquery 选择它？请帮忙

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-07-18T13:15:09.257

您不需要在[类选择器](http://api.jquery.com/class-selector/)本身中使用文字引号。你只需要写：

```
$("." + inClass).show(); 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-07-18T13:17:14.933

像这样的东西会更合适： `$('.' + inClass).show();`

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-07-18T13:14:56.200

不需要这些撇号，事实上，会破坏您的查询。

而是使用：

```
var inClass = "."+inClass;
$(inClass).show(); 
```

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2012-07-18T13:14:59.257

尝试这个

```
inClass = '.' + inClass;
$(inClass).show(); 
```

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2012-07-18T13:15:18.617

你应该这样使用；

```
var inClass = '.'+'inClass';
$(inClass).show(); 
```

奖金使用：

html:

```
<a class="tab1">content</a>
<a class="tab2">content</a>
<a class="tab3">content</a>

<div class="tab1C">content</div>
<div class="tab2C">content</div>
<div class="tab3C">content</div> 
```

jQuery：

```
$('a').click(function() {
   var take = $(this).attr('class');//takes class from clicked element

   $('div').hide();//hides all content
   $('.'+ take + 'C').show();//matches clicked elements id with div container like .tab2C
}); 
```

# php - PHP gettext 和非ANSII 章程

> ID：11542235
> 
> 赞同：0
> 
> 时间：2012-07-18T13:12:23.810
> 
> 标签：php, utf-8, translation, gettext

我有一个最初是波兰语的 PHP Web 应用程序。但我被要求将其本地化为俄语。我决定使用gettext。但是当我尝试用波兰语特殊字符翻译字符串时遇到问题。例如：

```
echo gettext('Urządzenie'); 
```

在网络浏览器中显示“Urządzenie”而不是俄语中的单词。所有文件都以 UTF-8 编码，并且 .po 文件是使用 --from-code utf-8 生成的。没有波兰语特殊字符的翻译，例如

```
echo gettext('Instrukcja'); 
```

效果很好。你知道这种奇怪行为的原因是什么吗？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-07-18T15:33:57.460

您*确定*PHP 文件是 UTF-8 格式吗？要验证，请尝试以下操作：

`echo bin2hex('Urządzenie');`

您应该看到以下字节：

`55 72 7a c4 85 64 7a 65 6e 69 65`

# java - 读取原始类型的多个线程

> ID：11542242
> 
> 赞同：0
> 
> 时间：2012-07-18T13:12:42.180
> 
> 标签：java, thread-safety, primitive

如果多个线程读取先前设置的原始类型并且以后不会更改，它们会得到错误的值吗？

例如，假设以下简单代码摘录：

```
public static final boolean proceed = read(); // Read the value from a file

public static void doSomething() // Method accessed by multiple threads
{
    if (proceed)
    {
        System.out.println("TRUE");
    }
    else
    {
        System.out.println("FALSE");
    }
} 
```

假设`proceed`变量被初始化为`true`，是否有可能在同时运行该`doSomething()`方法的多个线程中的一个或多个线程中，打印的消息是`FALSE`？

如果`proceed`变量是可变的，那肯定是可能的，因此需要同步或使用`AtomicBoolean`（例如，根据[这个问题](https://stackoverflow.com/questions/4501223/when-i-need-to-use-atomicboolean-in-java)）。但在这种情况下，`proceed`它是不可变的，并且只在包含类的静态初始化期间设置一次。

类似地，对于其他原始类型，如果一个值设置为 final，那么以后访问它应该始终是线程安全的，对吗？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-07-18T13:16:18.187

由于`proceed`is`static`和`final`，它不能被重新分配，这变成了线程安全的。

`static`说它是类级别的，并`final`说它的值不能改变，这是一个`primitive`如此挑衅的不可变的，因此是线程安全的。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-07-18T13:16:39.170

您的变量是`final`保证所有线程将在一致的初始化后状态中看到它的事实。这也适用于对象的引用（即，如果对象已被初始化为非空引用，则所有线程都将看到该对象的非空值 - 但如果您的对象不是线程安全的，则某些线程可能会在不一致或陈旧的状态）。

ps：假设您的 read 方法不尝试读取布尔值，在这种情况下它将看到默认（false）值。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-07-18T13:17:08.057

你说它是不可变`(static and final)`的，所以我们可以有把握地说它是线程安全的。

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2012-07-18T13:17:54.373

引用是线程安全的，因为它是不可变的。

如果它是可变的，则需要使用`volatile`关键字来确保在另一个线程中修改时获得最新值。

[你曾经在 Java 中使用过 volatile 关键字吗？](https://stackoverflow.com/questions/106591/do-you-ever-use-the-volatile-keyword-in-java)

# bash - 查找子进程的数量

> ID：11542243
> 
> 赞同：18
> 
> 时间：2012-07-18T13:12:47.353
> 
> 标签：bash, process, pid

如何从脚本本身中找到 bash 脚本的子进程数？

* * *

## 回答 #1

> 赞同：14
> 
> 时间：2012-07-18T13:18:29.630

要获取 bash 脚本的 PID，您可以使用 variable `$$`。

然后，要获得它的孩子，你可以运行：

```
bash_pid=$$
children=`ps -eo ppid | grep -w $bash_pid` 
```

`ps`将返回父 PID 列表。然后`grep`过滤所有与 bash 脚本的子进程无关的进程。为了获得孩子的数量，您可以执行以下操作：

```
num_children=`echo $children | wc -w` 
```

实际上，您将获得的数字将减 1，因为`ps`它也是 bash 脚本的子代。如果您不想将执行计算`ps`为一个孩子，那么您可以通过以下方式解决该问题：

```
let num_children=num_children-1 
```

**更新：**为了避免调用`grep`，可能会使用以下语法（如果已安装的版本支持`ps`）：

```
num_children=`ps --no-headers -o pid --ppid=$$ | wc -w` 
```

* * *

## 回答 #2

> 赞同：10
> 
> 时间：2014-02-24T18:51:52.333

我更喜欢：

`num_children=$(pgrep -c -P$$)`

它只产生一个进程，您不必计算字数或通过管道中的程序调整 PID 的数量。

例子：

```
~ $ echo $(pgrep -c -P$$)
0
~ $ sleep 20 &
[1] 26114
~ $ echo $(pgrep -c -P$$)
1 
```

* * *

## 回答 #3

> 赞同：5
> 
> 时间：2013-10-23T19:00:09.530

您还可以使用 pgrep：

`child_count=$(($(pgrep --parent $$ | wc -l) - 1))`

用于`pgrep --parent $$`获取 bash 进程的子进程列表。
然后`wc -l`在输出上使用以获取行数：`$(pgrep --parent $$ | wc -l)` 然后减去 1（`wc -l`即使`pgrep --parent $$`为空也报告 1）

* * *

## 回答 #4

> 赞同：4
> 
> 时间：2019-09-20T18:59:14.783

如果作业计数（而不是 pid 计数）足够，我只提供了一个 bash-only 版本：

```
job_list=($(jobs -p))
job_count=${#job_list[@]} 
```

* * *

## 回答 #5

> 赞同：2
> 
> 时间：2012-07-18T13:24:15.753

`ps`与选项一起使用`--ppid`以选择当前 bash 进程的子进程。

```
bash_pid=$$
child_count=$(ps -o pid= --ppid $bash_id | wc -l)
let child_count-=1    # If you don't want to count the subshell that computed the answer 
```

`ps`（注意：这需要for的 Linux 版本`--ppid`。我不知道是否有与 BSD 等效的版本`ps`。）

* * *

## 回答 #6

> 赞同：-2
> 
> 时间：2012-07-18T13:24:59.533

您可以评估 shell 内置命令作业，例如：

```
counter = `jobs | wc -l` 
```

# ruby-on-rails - Rails/Mongoid update_attributes 忽略持久的嵌套属性验证

> ID：11542244
> 
> 赞同：1
> 
> 时间：2012-07-18T13:12:49.380
> 
> 标签：ruby-on-rails, ruby-on-rails-3, mongoid

我有一个“has_many”地址（地址类）的 Mongoid“节点”模型。

我正在使用嵌套表单来管理地址，并且能够成功创建、更新、销毁节点的地址。

问题在于地址验证器：当对新地址的验证失败时，update_attibutes 失败并显示错误。但是当尝试使用无效值更新现有地址时，地址验证器被触发并失败（通过日志检查），但 Node 的 update_attributes 返回 true 并且不显示错误（地址保持其值不变）。

当尝试使用无效值更新现有地址并同时创建新的无效地址以强制 update_attributes 失败时，我的表单由于新地址而失败，但现有地址没有错误，其（有效）值为恢复。

新的和持久的嵌套属性验证之间是否存在不同的行为？

这是我的 Node 类的标题：

```
class Node

  # INCLUSIONS

    include Mongoid::Document
    include Mongoid::Timestamps

  # RELATIONS

    belongs_to              :organization
    has_and_belongs_to_many :platforms
    has_many                :addresses

    accepts_nested_attributes_for :addresses, allow_destroy: true, reject_if: :all_blank 
```

地址类（已跳过类方法）（请注意，有重载的 getter 和 setter，但它们似乎不是原因）：

```
class Address

  # INCLUSIONS

    include Mongoid::Document
    include Mongoid::Timestamps

  # RELATIONS

    belongs_to :node

  # FIELDS

    field :address, type: String
    field :nat,     type: String
    field :description

  # VALIDATIONS

    validates :address, :node,
      presence: true

    # Validates address and nat validity
    validate do
      [:address, :nat].each do |field|
        errors.add(field, :invalid) unless self[field].blank? || self.class.valid_hex?(self[field])
      end
    end

  # INSTANCE METHODS

    # Address getter
    def address
      return self.class.hex_to_ip(self[:address]).to_s if self.class.valid_hex? self[:address]
      self[:address]
    end

    # Address setter
    def address= value
      self[:address] = self.class.valid_ip?(value) ? self.class.ip_to_hex(value) : value
    end

    # NAT address getter
    def nat
      return self.class.hex_to_ip(self[:nat]).to_s if self.class.valid_hex? self[:nat]
      self[:nat]
    end

    # NAT Address setter
    def nat= value
      self[:nat] = self.class.valid_ip?(value) ? self.class.ip_to_hex(value) : value
    end

end 
```

NodesController 的更新方法：

```
def update
  @node = platform.nodes.find_by name: params[:id]
  if @node.update_attributes params[:node]
    flash[:success] = t_flash :update_success, @node
    redirect_to platforms_platform_node_path(organization, platform, @node)
  else
    flash.now[:error] = t_flash :update_error, @node, count: @node.errors.count
    render :form
  end
end 
```

我尝试在 Node 类中添加[validates_associated :addresses](http://guides.rubyonrails.org/active_record_validations_callbacks.html#validates_associated)，但它没有改变任何东西（而且它似乎没有必要，因为没有这个验证新地址）。

我也尝试用 after_initialize/before_save 回调替换 getter 和 setter，我也遇到了同样的问题。

Rails v3.2.6 / Mongoid v3.0.1

## 更新：参数 [：节点] 内容

提交新的有效地址时（无错误）：

```
{"name"=>"Test", "addresses_attributes"=>{"0"=>{"address"=>"1.2.3.4", "description"=>"", "nat"=>""}}} 
```

提交格式无效的新地址时（成功显示错误）：

```
{"name"=>"Test", "addresses_attributes"=>{"0"=>{"address"=>"fdgfdgfdgfd", "description"=>"", "nat"=>""}}} 
```

当更新具有无效值的有效地址时（应该没有错误）：

```
{"name"=>"Test", "addresses_attributes"=>{"0"=>{"id"=>"5007e1c26fad9db41f000008", "address"=>"dsfsdfsdf", "description"=>"", "nat"=>""}}} 
```

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-07-27T13:12:34.953

检查这个 git 提交[https://github.com/jiren/mongoid/commit/9ebb8af8514ea70c66a7dbe64be20bc7407a2829](https://github.com/jiren/mongoid/commit/9ebb8af8514ea70c66a7dbe64be20bc7407a2829)

您可以使用此 gem 修复此问题。

# php - 将csv转换为excel PHP

> ID：11542253
> 
> 赞同：-2
> 
> 时间：2012-07-18T13:13:32.487
> 
> 标签：php, json, excel, csv

我`csv`在我的应用程序中通过 JSON 生成一个文件。但是当我打开它时，它没有被格式化。
PHP中是否有任何脚本可以转换`csv`为`Excel`？

我现在的输出是：

```
,"12","1","1","","","","","","","","","","0","0","0","0","0","","","0","","","","0","0","0"2121","0","","1","1","","","non","210,"0","0","0","0","07:00","","","0","","", 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-07-18T13:19:02.623

只需在 Excel 中打开 csv....

你应该一切都好，花花公子^_^

无需“转换”它。

# linux - ldconfig 错误：使用 Linux 加载程序时“不是符号链接”

> ID：11542255
> 
> 赞同：48
> 
> 时间：2012-07-18T13:13:41.293
> 
> 标签：linux, linker, makefile, gnu-make

运行时：

```
 sudo /sbin/ldconfig 
```

出现以下错误：

```
 /sbin/ldconfig: /usr/local/lib/ is not a symbolic link 
```

当我运行`file`命令时，会出现以下内容：

```
 file /usr/local/lib/
    /usr/local/lib/: directory 
```

里面`/usr/local/lib/`有我使用的三个库。我在这里称它们为`lib1`,`lib2`和`lib3`。

现在，当我`ldd`对我的二进制文件执行操作时，它会导致：

```
 lib1.so => not found
    lib2.so => not found
    lib3.so => /usr/local/lib/lib3.so (0x00216000) 
```

但它们都在同一个文件夹中`/usr/local/lib/{lib1,lib2,lib3}.so`。

每次我运行时`ldconfig`，都会出现相同的错误：

```
/usr/local/lib/ is not a symbolic link 
```

我认为`/usr/local/lib`应该在 中声明两次`/etc/ld.conf.d/*.conf`，但不是：

```
 sudo egrep '\/usr\/local' /etc/ld.so.conf.d/*
    projectA.conf.old:/usr/local/projectA/lib
    local.conf:/usr/local/lib 
```

`ld.so.conf`只包括`/etc/ld.so.conf.d/*.conf`，所以`*.old`不处理，它指的是`/usr/local/projectA/lib`.

经过一段时间的尝试，我删除了所有 lib1 和 lib2（有时我在二进制文件夹中对其进行了测试），发生了同样的错误。

* * *

## 回答 #1

> 赞同：51
> 
> 时间：2013-06-18T19:34:18.497

我在使用 Oracle 11R2 客户端时遇到了这个问题。不确定 Oracle 安装程序是这样做的，还是在我到达之前有人这样做。它不是 64 位与 32 位，都是 64 位。

错误在于这`libexpat.so.1`不是符号链接。

原来有两个相同的文件，`libexpat.so.1.5.2`和`libexpat.so.1`. 删除有问题的文件并使其成为 1.5.2 版本的符号链接会导致错误消失。

您希望知名名称成为当前版本的符号链接是有道理的。如果你这样做，你最终得到一个陈旧的库的可能性就会降低。

* * *

## 回答 #2

> 赞同：7
> 
> 时间：2016-05-26T12:11:01.233

我只是运行以下命令：

```
export LD_LIBRARY_PATH=/usr/lib/ 
```

现在它工作正常。

* * *

## 回答 #3

> 赞同：5
> 
> 时间：2012-07-18T14:16:29.973

至少在问题的关键点上解决了。

问之前我在网上搜索了一下，没有确定的解决方案，这个错误的原因是：lib1.so和lib2.so不OK，很可能不是为64位PC编译的，而是为32位机器编译的否则 lib3.so 是一个 64 位的库。至少这是我的假设。

非常不幸`ldconfig`的是，它没有给出一个干净的错误消息，通知它无法加载库，它只泵：

**ldconfig: /folder_where_the_wicked_lib_is/ 不是符号链接**

当我删除`ldd`二进制文件未找到的库时，我解决了这个问题。现在我更容易知道问题出在哪里。

我的 ld 版本：GNU ld 版本 2.20.51，我不知道最新版本是否有更好的信息给用户。

谢谢。

* * *

## 回答 #4

> 赞同：2
> 
> 时间：2012-07-18T13:17:01.217

您需要在 /etc/ld.so.conf 中包含库的路径，然后重新运行 ldconfig 以更新列表

其他可能性是在环境变量 LD_LIBRARY_PATH 中包含库的路径，然后重新运行可执行文件。

检查符号链接是否指向有效的库...

可以直接在/etc/ld.so.conf中添加路径，不包括...

运行`ldconfig -p`以查看您的库是否很好地包含在缓存中。

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2021-01-04T04:15:37.197

我也遇到了同样的问题，解决方案是：您收到错误的文件可能是另一个版本的实际文件的重复文件。因此，只需删除引发错误的特定文件即可解决问题。

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2019-07-20T19:03:09.613

在 shell 中简单运行： sudo apt-get install --reinstall libexpat1
与 libxcb 有同样的问题 - 以这种方式解决 - 非常快:)

# networking - 如何在sencha touch中检测互联网连接

> ID：11542258
> 
> 赞同：2
> 
> 时间：2012-07-18T13:13:45.997
> 
> 标签：networking, cordova, extjs

我有一个基于 Sencha touch 的小应用程序。这个应用程序应该向服务器提交数据假设这是我所做的 Ajax 调用示例

```
Ext.Ajax.request({
url: 'http://www.google.com',
timeout:30*1000,
success: function(response, opts) {
  console.dir('success');
},
failure: function(response, opts) {
  console.log('server-side failure with status code ' + response.status);
} 
```

现在

> 失败

如果我有网络连接但没有互联网，则永远不会被调用！我的客户的问题是没有稳定的互联网连接，但他一直都有无线网络！所以，我在网上找到的所有东西都会检测我是否有网络连接！但我已经有一个，但这个连接不提供互联网。

任何人都知道如何检测互联网连接而不是网络？

仅供参考：我尝试了 navigator.online 和网络状态示例，它们都没有检测到互联网，我还附加了一个 phoneGap 监听器，因为我正在使用 sencha 和 phoneGap 创建一个 iOS 应用程序！

编辑：我正在使用 Sencha v1.1

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2012-07-19T11:31:10.783

```
alert(Ext.device.Connection.isOnline()); 
```

这是网址， [http://docs.sencha.com/touch/2-0/#!/api/Ext.device.Connection](http://docs.sencha.com/touch/2-0/#!/api/Ext.device.Connection)

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-07-19T12:52:03.633

您还可以使用 PhoneGap 检测连接。请参阅： [http ://docs.phonegap.com/en/1.9.0/cordova_connection_connection.md.html](http://docs.phonegap.com/en/1.9.0/cordova_connection_connection.md.html)

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-07-22T09:25:08.270

如果调用了成功回调，那么您最好检查响应参数的 null 和/或长度。如果您发现 null 或零长度，则假设请求失败。

# java - 为什么 cvFindContours() 方法不能在 javacv 中正确检测轮廓？

> ID：11542259
> 
> 赞同：19
> 
> 时间：2012-07-18T13:13:49.307
> 
> 标签：java, opencv, javacv

我在 StackOverflow 中遇到了很多问题，并且能够开发小程序来正确检测正方形和矩形。这是我的示例代码

```
public static CvSeq findSquares(final IplImage src, CvMemStorage storage) {
    CvSeq squares = new CvContour();
    squares = cvCreateSeq(0, sizeof(CvContour.class), sizeof(CvSeq.class), storage);
    IplImage pyr = null, timg = null, gray = null, tgray;
    timg = cvCloneImage(src);
    CvSize sz = cvSize(src.width(), src.height());
    tgray = cvCreateImage(sz, src.depth(), 1);
    gray = cvCreateImage(sz, src.depth(), 1);
    // cvCvtColor(gray, src, 1);
    pyr = cvCreateImage(cvSize(sz.width() / 2, sz.height() / 2), src.depth(), src.nChannels());
    // down-scale and upscale the image to filter out the noise
    // cvPyrDown(timg, pyr, CV_GAUSSIAN_5x5);
    // cvPyrUp(pyr, timg, CV_GAUSSIAN_5x5);
    // cvSaveImage("ha.jpg",timg);
    CvSeq contours = new CvContour();
    // request closing of the application when the image window is closed
    // show image on window
    // find squares in every color plane of the image
    for (int c = 0; c < 3; c++) {
        IplImage channels[] = { cvCreateImage(sz, 8, 1), cvCreateImage(sz, 8, 1), cvCreateImage(sz, 8, 1) };
        channels[c] = cvCreateImage(sz, 8, 1);
        if (src.nChannels() > 1) {
            cvSplit(timg, channels[0], channels[1], channels[2], null);
        } else {
            tgray = cvCloneImage(timg);
        }
        tgray = channels[c];
        // // try several threshold levels
        for (int l = 0; l < N; l++) {
            // hack: use Canny instead of zero threshold level.
            // Canny helps to catch squares with gradient shading
            if (l == 0) {
                // apply Canny. Take the upper threshold from slider
                // and set the lower to 0 (which forces edges merging)
                cvCanny(tgray, gray, 0, thresh, 5);
                // dilate canny output to remove potential
                // // holes between edge segments
                cvDilate(gray, gray, null, 1);
            } else {
                // apply threshold if l!=0:
                cvThreshold(tgray, gray, (l + 1) * 255 / N, 255,
                        CV_THRESH_BINARY);
            }
            // find contours and store them all as a list
            cvFindContours(gray, storage, contours, sizeof(CvContour.class), CV_RETR_LIST, CV_CHAIN_APPROX_SIMPLE);
            CvSeq approx;
            // test each contour
            while (contours != null && !contours.isNull()) {
                if (contours.elem_size() > 0) {
                    approx = cvApproxPoly(contours, Loader.sizeof(CvContour.class), storage, CV_POLY_APPROX_DP, cvContourPerimeter(contours) * 0.02, 0);
                    if (approx.total() == 4 && Math.abs(cvContourArea(approx, CV_WHOLE_SEQ, 0)) > 1000 && cvCheckContourConvexity(approx) != 0) {
                        double maxCosine = 0;
                        for (int j = 2; j < 5; j++) {
                            // find the maximum cosine of the angle between
                            // joint edges
                            double cosine = Math.abs(angle(
                                            new CvPoint(cvGetSeqElem(
                                                    approx, j % 4)),
                                            new CvPoint(cvGetSeqElem(
                                                    approx, j - 2)),
                                            new CvPoint(cvGetSeqElem(
                                                    approx, j - 1))));
                            maxCosine = Math.max(maxCosine, cosine);
                        }
                        if (maxCosine < 0.2) {
                            CvRect x = cvBoundingRect(approx, l);
                            if ((x.width() * x.height()) < 50000) {
                                System.out.println("Width : " + x.width()
                                        + " Height : " + x.height());
                                cvSeqPush(squares, approx);
                            }
                        }
                    }
                }
                contours = contours.h_next();
            }
            contours = new CvContour();
        }
    }
    return squares;
} 
```

我用这张图片来检测矩形和正方形

![在此处输入图像描述](../Images/70ba749bbf5f79db1ab90c6b92df08fa.png)

我需要识别以下输出

![在此处输入图像描述](../Images/6e064bdc07f52e6c3d8804b4279e7371.png)

和

![在此处输入图像描述](../Images/e707cb4f4699faf534018eca03f51f95.png)

但是当我运行上面的代码时，它只检测到以下矩形。但我不知道这是什么原因。请有人能解释一下原因。

这是我得到的输出。

![在此处输入图像描述](../Images/ebd7f99ddda1241a5d12dbdde6c57334.png)

请善意地解释上面代码中的问题，并给出一些建议来检测这个正方形和矩形。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-11-06T19:57:28.063

给定一个掩码图像（二进制图像，如您的第二个图）， cvFindContours() 为您提供轮廓（几个点列表）。
看看这个链接：[http ://dasl.mem.drexel.edu/~noahKuntz/openCVTut7.html](http://dasl.mem.drexel.edu/~noahKuntz/openCVTut7.html)

# liferay-6 - 在 Liferay 中放置一个 html 页面的位置

> ID：11542260
> 
> 赞同：0
> 
> 时间：2012-07-18T13:13:51.763
> 
> 标签：liferay-6

我的旧网站有几个 html 页面，我想将它们放在我的 Liferay 主题所在的服务器上的某个位置，并链接到我的 Liferay 网站上的那些。在哪里保存这些页面？

我在 _diffs 文件夹下创建了一个名为“HTML”的文件夹，将 html 页面放在那里并从那里进行链接。它运作良好，但我想知道是否允许我像这样使用我的主题的文件夹结构？如果没有，如何解决这个问题？

提前致谢。阿迪亚

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-07-18T14:51:46.580

1.  如果您在 liferay 门户前面有一个 Web 服务器，例如：Apache，我希望将这些 HTML 文件保存在 apache documentRoot 中并从那里访问它，以保持 liferay 主题的清洁。

2.  如果您使用的是 Liferay 6.1，您可以检查一个名为 Liferay Sync 的功能。它允许您共享文档。我还没有使用它。

高温高压

# css - 即使我正在覆盖 CSS 类，但仍使用旧的宽度值

> ID：11542267
> 
> 赞同：0
> 
> 时间：2012-07-18T13:14:12.620
> 
> 标签：css, twitter-bootstrap

我有两个 CSS 文件，为了简单起见，我们称它们为 style1.css 和 style2.css。

我按以下顺序包括它们：

```
<link rel="stylesheet" type="text/css" href="style1.css" />
<link rel="stylesheet" type="text/css" href="style2.css" /> 
```

样式一是具有许多类和属性的更通用的文件。Style2 会覆盖这些。

例如，style1 有这个：

```
.row-fluid > .span9 {
width: 74.358974359%;
} 
```

而 style2 具有：

```
.span9{
  width:50%;
} 
```

我有一些包含 .span9 元素的 .row-fluid DIV，并且第一个样式用于它们，即使如果发现重复的选择器，浏览器应该只接受最后一个 CSS 规则。

我通过 Chrome 开发人员工具发现了这一点，我看到来自 style9 的 span9 定义被交叉，而来自 style1 的定义位于顶部并被使用。

PS：具体来说，style1 是 Twitter Bootstrap CSS，style2 是我自己从头开始的 CSS。

* * *

## 回答 #1

> 赞同：8
> 
> 时间：2012-07-18T13:17:24.263

您正在理解这`cascading`部分，但可能不是 CSS 的特异性规则。第一条规则比第二条规则更具体地选择元素，因此选择它。

尝试将第二条规则更改为：

```
.row-fluid > .span9 {
    width: 50%;
} 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-07-18T13:37:03.477

A. 您需要将“span9”更改为“.span9”。

B. 这是一个关于 CSS 优先级的好资源。[http://www.vanseodesign.com/css/css-specificity-inheritance-cascaade/](http://www.vanseodesign.com/css/css-specificity-inheritance-cascaade/)

# websocket - 有没有人将 Yesod 聊天示例移植到 websockets？

> ID：11542277
> 
> 赞同：1
> 
> 时间：2012-07-18T13:14:42.920
> 
> 标签：websocket, yesod

有没有人将 Yesod 聊天示例移植到 websockets？

[http://www.yesodweb.com/book/wiki-chat-example](http://www.yesodweb.com/book/wiki-chat-example)

[https://github.com/yesodweb/wai/blob/master/wai-websockets/Network/Wai/Handler/WebSockets.hs](https://github.com/yesodweb/wai/blob/master/wai-websockets/Network/Wai/Handler/WebSockets.hs)

# c# - 如何在 c# 中获取活动对象列表？

> ID：11542280
> 
> 赞同：1
> 
> 时间：2012-07-18T13:14:56.253
> 
> 标签：c#, object, live, creation

我想获取在我的应用程序中定义的活动对象列表。

我所说的活动对象是指创建的每个对象。

例如，假设在应用程序的某些部分创建了控件对象，我想通过名称访问特定对象。

或者我想访问一些公共类中的一些私有对象，在这些公共类中我没有访问公共类对象的“起始”点。

必须有一种方法，因为它本质上是调试器所做的。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-07-18T13:17:15.417

这不是一件容易的事。我认为最接近的是[Profiler API](https://stackoverflow.com/questions/5736845/is-is-possible-to-use-profiling-api-right-from-c)。这[是另一个网站](http://blogs.msdn.com/b/davbr/)，它是分析 API 的一个很好的参考。

# jquery - jquery 将现有（可重用）函数放入 ajax 请求中 - 不能使用 async:false

> ID：11542282
> 
> 赞同：1
> 
> 时间：2012-07-18T13:15:02.243
> 
> 标签：jquery, function

我有一些 ajax 函数* 例如

```
 function MyFunctionA(PassingObj) {
            $.ajax({
                url: '123.ashx',data: PassingObj, type: 'POST',contentType: 'application/json',
                success: function (data1) {
                    return data1
                }
                }
            });

 function MyFunctionB(PassingObj) {
            $.ajax({
                url: '456.ashx',data: PassingObj,type: 'POST', contentType: 'application/json',
                success: function (data2) {
                    return data2
                }
                }
            }); 

var GetValuesXY(){
var x = MyFunctionA(PassingObj);            
var y = MyFunctionB(PassingObj);
return x + y; 
```

}

MyFunctionA 和 MyFunction 是在整个页面上调用的通用函数，如果不可能，我不想实现回调，因为它们可以在不同的情况下使用。我无法将 Ajax 函数设置为 async:false - 从 v1.8 开始不推荐使用该选项，并且我不允许使用它，并且它导致了问题 ( [http://api.jquery.com/jQuery.ajax/](http://api.jquery.com/jQuery.ajax/) )

因此，为了确认，我永远无法成功调用函数 GetValuesXY(){}，因为 x 将始终未定义，因为它会继续运行而无需等待结果，因为它是异步的。

因此，目前我知道如何处理上述问题的唯一方法是合并 2，这在这种情况下是不可接受的：

```
function MyFunctionA(PassingObj) {
            $.ajax({
                url: '123.ashx',data: PassingObj,type: 'POST',contentType: 'application/json',
                success: function (data1) {

                     $.ajax({             //MyFunctionB is effectively copied in here
                        url: '456.ashx',data: PassingObj,type: 'POST',contentType: 'application/json',
                        success: function (data2) {
                            return data1 + data2
                        }
                        }
                    });
                }
                }
            }); 
```

现在我根本不能单独使用这两个示例函数，这是一种非常非常低效的编程方式，因为我可能对此有无限量的排列，并且每次我都必须剪切和粘贴其中的每一个使用任何功能

至少不能将函数调用放在 ajax 请求中吗？顺其自然

```
var myData1;
var myData2;

                $.ajax({
                call MyFunctionA(),
                success: function (data1) {
                    myData1 = data1;
                        $.ajax({
                            call MyFunctionB(),
                            success: function (data2) {
                                myData2 = data2;
                                }
                            }
                        }); 
                    }

                }
            }); 
```

（* - 这些只是用于演示目的的虚拟函数）

# c# - 动画 WindowsFormsHost

> ID：11542283
> 
> 赞同：1
> 
> 时间：2012-07-18T13:15:04.530
> 
> 标签：c#, wpf, animation, windowsformshost

我需要为 WindowsFormsHost 控件设置动画。问题是我看不到动画，窗口没有刷新。如果我在动画期间调整 WPF 窗口的大小，那么过渡是可见的。

我尝试将 WindowsFormsHost 放在网格中，然后为网格设置动画，但结果是一样的。我在网格中放入了一些其他的东西，以确保我正确地编写了动画。

这里有一些简单的应用程序只是为了测试这个：

```
<Window x:Class="WpfApplication1.MainWindow"
    xmlns="http://schemas.microsoft.com/winfx/2006/xaml/presentation"
    xmlns:x="http://schemas.microsoft.com/winfx/2006/xaml"
    xmlns:wf="clr-namespace:System.Windows.Forms;assembly=System.Windows.Forms"
    Title="MainWindow" Height="350" Width="525">

<Window.Resources>
    <Grid x:Key="MoveX">
        <Grid.RenderTransform>
            <TranslateTransform X="0"/>
        </Grid.RenderTransform>
    </Grid>

    <Storyboard x:Key="Story">
        <DoubleAnimation 
            Storyboard.Target="{StaticResource MoveX}"
            Storyboard.TargetProperty="RenderTransform.(TranslateTransform.X)"
            From="0"
            To="600"/>
    </Storyboard>
</Window.Resources>

<Grid>
    <Grid.RenderTransform>
        <TranslateTransform X="{Binding Source={StaticResource MoveX}, Path=RenderTransform.(TranslateTransform.X)}"/>
    </Grid.RenderTransform>

    <WindowsFormsHost Height="224" HorizontalAlignment="Left" Margin="26,24,0,0" Name="windowsFormsHost1" VerticalAlignment="Top" Width="404" Background="#FF762323">
        <wf:Panel BackColor="Green" Width="300" Height="200"/>
    </WindowsFormsHost>

    <Button Content="Button" Height="23" HorizontalAlignment="Left" Margin="328,269,0,0" Name="button1" VerticalAlignment="Top" Width="75" >
        <Button.Triggers>
            <EventTrigger RoutedEvent="Button.Click">
                <BeginStoryboard Storyboard="{StaticResource Story}"/>
            </EventTrigger>
        </Button.Triggers>
    </Button>
    <Label Content="Label" Height="28" HorizontalAlignment="Left" Margin="85,269,0,0" Name="label1" VerticalAlignment="Top" />
</Grid>
</Window> 
```

有没有办法解决这个问题？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-07-18T13:36:02.197

在混合 WPF 和 WinForms 或 ActiveX 内容时，这是一个已知问题。在内部，每个渲染引擎都有自己的空间，像动画这样的互操作性是不可能的。

随着 .net 4.5 版本的发布，这个问题应该得到解决。

见[http://www.jonathanantoine.com/2011/09/24/wpf-4-5-%E2%80%93-part-8-no-more-airspace-problems-integrating-wpf-with-win32/](http://www.jonathanantoine.com/2011/09/24/wpf-4-5-%E2%80%93-part-8-no-more-airspace-problems-integrating-wpf-with-win32/)

# sql-server - 你如何与多个 CTE 联合？

> ID：11542288
> 
> 赞同：69
> 
> 时间：2012-07-18T13:15:08.460
> 
> 标签：sql-server, union, common-table-expression

你如何使用`UNION`多个`Common Table Expressions`？

我正在尝试将一些汇总数字放在一起，但无论我把它们放在哪里`;`，我总是会得到一个错误

```
SELECT  COUNT(*)
FROM    dbo.Decision_Data
UNION
SELECT  COUNT(DISTINCT Client_No)
FROM    dbo.Decision_Data
UNION
WITH    [Clients]
          AS ( SELECT   Client_No
               FROM     dbo.Decision_Data
               GROUP BY Client_No
               HAVING   COUNT(*) = 1
             )
    SELECT  COUNT(*) AS [Clients Single Record CTE]
    FROM    Clients; 
```

我很欣赏在上面的示例中，我可以将**单个**CTE 移到开头，但我有许多 CTE 我想`UNION`

* * *

## 回答 #1

> 赞同：118
> 
> 时间：2012-07-18T13:17:40.350

如果您尝试合并多个 CTE，则需要先声明 CTE，然后使用它们：

```
With Clients As
    (
    Select Client_No
    From dbo.Decision_Data
    Group By Client_No
    Having Count(*) = 1
    )
    , CTE2 As
    (
    Select Client_No
    From dbo.Decision_Data
    Group By Client_No
    Having Count(*) = 2
    )
Select Count(*)
From Decision_Data
Union
Select Count(Distinct Client_No)
From dbo.Decision_Data
Union
Select Count(*)
From Clients
Union
Select Count(*)
From CTE2; 
```

您甚至可以使用另一个 CTE：

```
With Clients As
        (
        Select Client_No
        From dbo.Decision_Data
        Group By Client_No
        Having Count(*) = 1
        )
        , CTE2FromClients As
        (
        Select Client_No
        From Clients
        )
    Select Count(*)
    From Decision_Data
    Union
    Select Count(Distinct Client_No)
    From dbo.Decision_Data
    Union
    Select Count(*)
    From Clients
    Union
    Select Count(*)
    From CTE2FromClients; 
```

[WITH common_table_expression (Transact-SQL)](http://msdn.microsoft.com/en-us/library/ms175972%28v=sql.105%29.aspx)

* * *

## 回答 #2

> 赞同：14
> 
> 时间：2012-07-18T13:18:26.370

你可以这样做：

```
WITH    [Clients]
          AS ( SELECT   Client_No
               FROM     dbo.Decision_Data
               GROUP BY Client_No
               HAVING   COUNT(*) = 1
             ),
        [Clients2]
          AS ( SELECT   Client_No
               FROM     dbo.Decision_Data
               GROUP BY Client_No
               HAVING   COUNT(*) = 1
             )
SELECT  COUNT(*)
FROM    Clients
UNION
SELECT  COUNT(*)
FROM    Clients2; 
```

# java - Java 线程安全 - 锁定整个静态类，但只锁定一个方法

> ID：11542291
> 
> 赞同：6
> 
> 时间：2012-07-18T13:15:17.040
> 
> 标签：java, multithreading, static, static-methods

我实现了一个静态帮助器类，它帮助缓存和检索数据库中的一些只读、非可变、非易失性数据。

（剥离）示例：

```
public class CacheHelper
{
    private static HashMap foos, bars;

    public static Foo getFoo(int fooId) { /* etc etc */ }
    public static Bar getBar(int barId) { /* etc etc */ }

    public static void reloadAllCaches()
    {
        //This is where I need it to lock access to all the other static methods
    }
} 
```

我为静态类阅读它的方式，如果我将`synchronized`关键字添加到 reloadAllCaches() 方法，这将在该方法执行时对整个类应用锁定。这个对吗？（编辑：是的，不正确。感谢您的回复。）

注意：我希望对`getter`方法的线程安全性和它们返回的对象保持不可知论，因为这些数据永远不会发生变异，并且希望它尽快返回。

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2012-07-18T13:26:29.620

如果将`synchronized`关键字添加到 reloadAllCaches() 函数，则在 reloadAllCaches() 函数运行时，类中获得该`synchronized`关键字的所有其他静态函数都无法执行。

非静态函数如何执行，无论它们是否获得`synchronized`关键字。`synchronized`没有关键字的所有其他函数也可以执行。

毕竟带有 的函数`synchronized`可以看成这样：

```
public class Bar
{
    public static void foo()
    {
        synchronized (Bar.class)
        {
            // your code
        }
    }
} 
```

带有关键字的非静态函数`synchronized`可以这样查看：

```
public class Bar
{
    public void foo()
    {
        synchronized (this)
        {
            // your code
        }
    }
} 
```

所以静态和非静态函数有不同的同步上下文，并且不会用 synchronized 关键字阻塞彼此的执行。

对于您的情况，我建议使用`ReentrantReadWriteLock`. 此类将允许任意数量的函数同时获得读锁，但只有一个函数获得写锁。只有在没有读锁到位时才会获取写锁，只要有写锁就不会获取读锁。

你可以让你的重载函数获取一个写锁，而你的所有读取函数都获取一个写锁。您必须使用`ReentrantReadWriteLock`原因的静态实例。

我的建议是这样实现：

```
public class CacheHelper
{
    private static HashMap foos, bars;
    private static java.util.concurrent.locks.ReadWriteLock lock = new java.util.concurrent.locks.ReentrantReadWriteLock();

    public static Foo getFoo(int fooId)
    {
        lock.readLock().lock();
        try {
            /* etc etc */
        } finally {
            lock.readLock().unlock();
        }
    }
    public static Bar getBar(int barId)
    {
        lock.readLock().lock();
        try {
            /* etc etc */
        } finally {
            lock.readLock().unlock();
        }
    }

    public static void reloadAllCaches()
    {
        lock.writeLock().lock();
        try {
            //This is where I need it to lock access to all the other static methods
        } finally {
            lock.writeLock().unlock();
        }
    }
} 
```

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-07-18T13:35:43.257

如果您希望能够重新填充集合而不锁定它们，您可以将它们替换为不可变集合。

```
private static volatile Map foos, bars;

public static Foo getFoo(int fooId) { return foos.get(fooId); }
public static Bar getBar(int barId) { /* etc etc */ }

public static void reloadAllCaches()
{
    Map newFoo = ...
    // populate newFoo
    foos = newFoo;

    Map newBar = ...
    // populate newBar
    bars = newBar;
} 
```

getFoo 将看到一个完全一致的副本，而不需要锁，因为 Map 总是被替换，从不修改。

* * *

`synchronized`锁定对象而不是方法，在这种情况下，您正在锁定`CacheHelper.class`对象

为了使 getter 尽可能快，您可以使用 ConcurrentHashMap 而不是使用`synchronized`

* * *

仅将同步用于更新的示例。

```
final ConcurrentMap<Key, ExpensiveObject> map =

public ExpensiveObject getOrNull(Key key) { 
     return map.get(key); 
}

public ExpensiveObject getOrCreate(Key key) {
     synchronized(map) {
         ExpensiveObject ret = map.get(key);
         if (ret == null)
              map.put(key, ret = new ExpensiveObject(key));
         return ret;
     }
} 
```

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2012-07-18T13:19:17.557

不，这是不正确的。仅添加`synchronized`到`reloadAllCaches`方法意味着该方法的调用者必须获取类上的锁，但调用非同步方法的线程仍然可以同时访问该类。为了安全起见，您仍然需要在同一个锁上同步访问器，否则读取器线程可能看不到最新的更改并且会得到陈旧的数据。或者，您可以使用 ConcurrentHashMap。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2012-07-18T13:24:32.023

除了在`CacheHelper`类对象（CacheHelper.class）上应用锁之外，`reloadAllCaches()`您还可以在此方法中在某些代码上应用此锁，因为我看到的所有方法都是`static`，如果您全部制作它们，`synchronized`那么如果任何线程正在访问任何线程，所有线程都将被阻塞方法。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2012-07-18T13:33:16.270

简单来说，锁只是防止其他线程同时运行相同的方法，它不会为类中的任何其他内容提供任何锁定资源，无论是静态的还是其他的。

只有在拥有控制权的线程退出该方法之前，其他线程才会阻止对该方法的访问。所有线程仍然可以免费访问任何其他内容。

如果您需要对对象本身进行锁定控制，那么您需要考虑为缓存提供线程安全访问器或某种继承处理。

我的意思是，如果你在这个方法中构造一个新的缓存，并且一旦构造了用这些新对象替换缓存助手中的引用对象，那么只需同步 reloadAllCaches 方法就可以了。

但是，如果您的意图是重用/回收现有的缓存容器，那么您将不得不在容器级别使用锁定来防止在缓存被破坏和重建时读取。

如果您需要重新加载多个缓存地图（根据您的示例），那么您可能会发现有必要将缓存对象抽象到另一层，否则您可能会在重新应用缓存时失去对缓存的同步访问。

# sql - 日期为 varchar，转换为浮点数以获取平均日期

> ID：11542294
> 
> 赞同：0
> 
> 时间：2012-07-18T13:15:36.330
> 
> 标签：sql, sql-server-2005, varchar

我的日期是 varchar(50)，在我的数据库中显示如下：

> 2012 年 2 月 15 日

该表如下所示：（注意：someid 不是主键，它标识一个组）

```
 |  someid  |   date     |  float_value  | 
 |   1      | 2/15/2012  |     3.2       |   
 |   1      | 2/15/2012  |     1.4       |
 |   1      | 2/15/2012  |     2.1       |
 |   1      | 2/16/2012  |     1.8       | 
```

我将如何做这样的事情：

```
select avg(date), avg(float_value)
where someid = 1 
```

要返回这样的东西：

```
|  date     |  float_value  |
| 2/15/2012 |   2.126       | 
```

也许答案不是平均日期，而是最常发生的日期（就 someid 而言）。

sql专家将不胜感激任何帮助。

提前致谢

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-07-18T13:18:31.143

忘记浮动废话。怎么样：

```
SELECT DATEADD(DAY, AVG(DATEDIFF(DAY, 0, create_date)), 0) FROM sys.objects; 
```

在您的情况下，您需要先转换。例如

```
SELECT 
  avg_date = DATEADD(DAY, AVG(DATEDIFF(DAY, 0, CONVERT(SMALLDATETIME, [date]))), 0) 
FROM dbo.yourtable
WHERE someid = 1; 
```

这种变化也可能有用：

```
SELECT 
  someid, 
  avg_date = DATEADD(DAY, AVG(DATEDIFF(DAY, 0, CONVERT(SMALLDATETIME, [date]))), 0) 
FROM dbo.yourtable
GROUP BY someid; 
```

**编辑**以呈现似乎必要的确切精确和特定格式：

```
SELECT 
  avg_date = CONVERT(CHAR(10), 
    DATEADD(DAY, AVG(DATEDIFF(DAY, 0, CONVERT(SMALLDATETIME, [date]))), 0),
    101) 
FROM dbo.yourtable
WHERE someid = 1; 
```

# android - Phonegap1.6.1 在Android 4.0.3 中页面加载或页面更改时显示白屏

> ID：11542296
> 
> 赞同：1
> 
> 时间：2012-07-18T13:15:39.540
> 
> 标签：android, jquery-mobile, cordova

**Android 4.0.3 中的问题**

1.  我正在使用 Phonegap 1.6.1。
2.  jQuery 移动 1.1.0

首次打开应用程序时，或页面转换（页面更改）时，它会显示白屏。

如果有人有任何想法或解决方案，请与我们分享。

谢谢。

# performance - 如何提高 Web 应用程序的图像加载性能？

> ID：11542298
> 
> 赞同：1
> 
> 时间：2012-07-18T13:15:47.057
> 
> 标签：performance, image

我有一个在本地主机上运行的 Web 应用程序。要求是加载多张矩形 jpg 图片（96 张图片，每张平均 7k 大小）并在运行时显示在主页上。图像以 8x12 行/列的网格显示。我通过在javascript中设置'img'的'src'属性来加载图像。分配给“src”属性的 url 对于所有图像都是相同的，但图像 ID 不同。图像正在加载，但主要问题是它们加载速度不是很快，它们是按顺序加载的一些意思是 1,2,3,4... 等等，但有些图像没有按顺序加载。我想提高这个页面的性能。我已经尝试过计算不同点的时间，例如：

1.  当从客户端发起呼叫时（设置了图像 src 属性）

2.  当服务器接听电话时。（服务器上提供单个图像的页面）

3.  当服务器即将返回图像时。

4.  在客户端接收/显示图像时（在 javascript 中调用图像加载事件）

在查看收集的数据后发现，在客户端调用发起和服务器正在接收特定图像的调用之间，主要时间在上述 1 和 2 之间丢失。

我还尝试在 machine.config 中设置 maxWorkerThreads、minWorkerThreads、requestQueueLimit 和 maxconnection 等参数，但还没有显着改善。

有人可以在这种情况下帮助我，因为我被困在这里很多天了，我现在真的很没时间。迫切需要提高这些图像加载的性能。

提前致谢。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-07-18T13:21:43.047

由于您强调时间不足，我建议您尝试使用按需加载图像的 jQuery 插件。您加载图片的画廊，用户是否在其中滚动？还是1个大领域？如果它是一个用户可以滚动的画廊，我强烈建议你看看[lazyload](http://www.appelsiini.net/projects/lazyload)。该插件的作用是仅在需要时才获取图像。只要它不在屏幕上，它就不会被加载。举个简单的例子，看看[这个演示](http://www.appelsiini.net/projects/lazyload/enabled_fadein.html)。

我希望这可以帮助你。

# c# - 如何以确定的方式将 IEEE754 浮点数转换为定点数？

> ID：11542299
> 
> 赞同：1
> 
> 时间：2012-07-18T13:15:47.977
> 
> 标签：c#, floating-point, ieee-754, fixed-point, deterministic

我需要将 32 位 IEEE754 浮点数转换为有符号的 Q19.12 定点格式。问题是它必须以完全确定的方式完成，所以通常的 (int)(f * (1 << FRACTION_SHIFT)) 是不合适的，因为它使用非确定性浮点数学。是否有任何“位摆弄”或类似的确定性转换方法？

编辑：在这种情况下确定性假设为：给定相同的浮点数据在不同平台上实现完全相同的转换结果。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-07-18T13:44:39.850

浮点数不是非确定性的。你从哪里得到这个荒谬的假设？

扩展一点： `1 << FRACTION_SHIFT`是 2 的精确幂，因此以浮点数精确表示。乘以 2 的精确幂是精确的（除非发生上溢/下溢，但在这种情况下，无论如何都没有有意义的定点表示，所以你不在乎）。因此，唯一可能的舍入来源是转换为整数，这完全由 C# 指定；因此，结果不仅是确定性的，而且您将获得可移植的相同结果。

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2012-07-19T15:03:23.957

虽然@StephenCanon 的回答可能是关于这个特定情况完全确定性的正确答案，但我决定保持更安全的一面，仍然手动进行转换。这是我最终得到的代码（感谢@CodesInChaos 提供有关如何执行此操作的指针）：

```
public static Fixed FromFloatSafe(float f) {
    // Extract float bits
    uint fb = BitConverter.ToUInt32(BitConverter.GetBytes(f), 0);
    uint sign = (uint)((int)fb >> 31);
    uint exponent = (fb >> 23) & 0xFF;
    uint mantissa = (fb & 0x007FFFFF);

    // Check for Infinity, SNaN, QNaN
    if (exponent == 255) {
        throw new ArgumentException();
    // Add mantissa's assumed leading 1
    } else if (exponent != 0) {
        mantissa |= 0x800000;
    }

    // Mantissa with adjusted sign
    int raw = (int)((mantissa ^ sign) - sign);
    // Required float's radix point shift to convert to fixed point
    int shift = (int)exponent - 127 - FRACTION_SHIFT + 1;

    // Do the shifting and check for overflows
    if (shift > 30) {
        throw new OverflowException();
    } else if (shift > 0) {
        long ul = (long)raw << shift;
        if (ul > int.MaxValue) {
            throw new OverflowException();
        }
        if (ul < int.MinValue) {
            throw new OverflowException();
        }
        raw = (int)ul;
    } else {
        raw = raw >> -shift;
    }

    return Fixed.FromRaw(raw);
} 
```

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-07-18T13:56:40.990

If determinism is absolutely required, I'd parse the content as an integer, and do the conversion manually.

First extract the exponent. If it's too small return `0`, if it's too large, throw an overflow exception.

Next extract sign and mantissa (remember the implicit leading `1`). If the sign bit is `1`, flip the sign of the mantissa. Finally execute a bit shift by the exponent combined with a bias.

I also wrote a [soft float implementation](https://github.com/CodesInChaos/SoftFloat/blob/master/SoftFloatTest/SoftFloat.cs), that guarantees determinism. It's pretty incomplete, but the parts you need are implemented.

# ruby-on-rails - 思考狮身人面像，过滤关联？

> ID：11542300
> 
> 赞同：0
> 
> 时间：2012-07-18T13:15:50.520
> 
> 标签：ruby-on-rails, ruby, activerecord, thinking-sphinx

我的 Rails 应用程序中的 Thinking Sphinx 存在严重问题。我的应用程序规格如下：

*   导轨 3.2.6
*   红宝石 1.9.3
*   狮身人面像 2.0.4 (r3135)
*   思考狮身人面像 2.0.12

在我的应用程序中，我有一个`Page`模型和一个`Offer`模型，并且`pages`有很多`offers`. 模型中定义的索引`Page`如下所示：

```
define_index do

  #other indexes defined here
  #...

  has offers.width, as: :offers_width
  has offers.height, as: :offers_height
  has offers.price, as: :offers_price

  set_property delta: true
end 
```

然后我在`Page`模型上进行搜索，`pages`根据搜索查询和条件选择哪里。但是，当我尝试使用`:with`过滤器时，Sphinx 给了我错误的结果。

当我只使用一个过滤器时，例如`price`or `width`，结果还可以，但是当我尝试组合过滤器时，例如`price and width`，我得到的结果包含带有给定`price`OR的报价`width`，而不是`price`AND `width`。

当我使用范围搜索时，大多数时间`:with`参数都是范围，而不仅仅是整数值。

**编辑 1**
查询即时使用：

```
Page.search Riddle.escape(query), conditions: conditions, with: has_cond, star: true, per_page: Page.per_page, page: page 
```

其中**has_cond**是：

```
{:offers_height=>[175..200], :offers_width=>[175..200], :offers_price=>[10..80]} 
```

它仍然给我提供***任何***报价在该范围内具有高度或***任何***报价在该范围内具有宽度或与价格相同的页面。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-07-19T09:36:45.877

好的，我找到了解决方案。sphinx 给我错误结果的原因是因为他在单个页面中汇总了所有报价。我不得不将索引从页面移动到报价，现在查询按预期工作。我的报价索引如下所示：

```
define_index do

  indexes page(:description), as: :page_description
  indexes page(:address), as: :page_address
  indexes page(:title), as: :page_title
  indexes page(:status), as: :page_status
  indexes page.tags(:name), as: :page_tags_name
  indexes page.category(:id), as: :page_category_id
  indexes page.country(:id), as: :page_country_id
  indexes page(:verified), as: :page_verified

  has page(:id), as: :page_id
  has :width
  has :height
  has :price
end 
```

我需要先查询狮身人面像，然后进行活动记录查询。

```
@sphinx_query = Offer.search Riddle.escape(query), with: has_cond, 
    conditions: conditions, group_function: :attr, group_by: 'page_id', 
    star: true, per_page: Page.per_page, page: page
@pages = Page.find(@sphinx_query.map(&:page_id)) 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-07-18T14:22:50.927

我相信错误将出现在您的搜索查询本身中。我刚刚进行了一些测试，一切都按预期工作......有范围和没有范围。

**控制器中的搜索代码：**

```
@titles = Title.search(params[:q], 
                              :rank_mode => :bm25,
                              :match_mode => :any,
                              :star => true,
                              :limit => 35,
                              :with_all => {
                                :runtime => [75..100],
                                :year => 1976
                              }) 
```

**索引代码：**

```
class Title < ActiveRecord::Base
    ...
    define_index do
      # fields
      indexes clean_name, :sortable => true
      # attributes
      has id, year, runtime, created_at, updated_at
    end
    ...
end 
```

**搜索结果 (JSON)**

```
{
    resultList: [
        {
            director: "Allan Arkush, Joe Dante",
            id: 34089,
            name: "Hollywood Boulevard",
            rating: "R",
            runtime: 83,
            year: 1976,
            text: "Hollywood Boulevard (1976)",
            identify: "title"
        },
        {
            director: "Patrick M. Wright",
            id: 40875,
            name: "Hollywood High",
            rating: "R",
            runtime: 81,
            year: 1976,
            text: "Hollywood High (1976)",
            identify: "title"
        }
    ],
    resultCount: 2
} 
```

对于我正在处理的项目，它不使用连接表——但这不重要。除了正在执行连接之外，索引仍然相同。

# forms - 尝试提交时没有以struts2形式执行任何操作

> ID：11542303
> 
> 赞同：0
> 
> 时间：2012-07-18T13:16:01.863
> 
> 标签：forms, struts2

当我单击表单（struts2）中的提交按钮时，不会执行任何操作。这些文件可能有什么问题？

`struts.xml`：

```
 ...<action name="EditMessageAction"
            class="action.content.EditMessageAction">
            <result name="success">/WEB-INF/pages/messages/message.jsp</result>
    </action>
    <action name="SaveEditedMessageAction"
            class="action.content.SaveEditedMessageAction">
        <result name="input">/WEB-INF/pages/messages/message.jsp</result>
        <result name="success">/WEB-INF/pages/messages/messagesFirstPosition.jsp</result>       
    </action>... 
```

`message.jsp`：

```
 <s:form id="saveEditedUserForm" action="SaveEditedUserAction" theme="simple">
            <h1>Edycja komunikatu</h1>
            <div>
                Id: <b><s:property value="id"/></b>
            </div>
            <div>
                <s:label for="dateFrom" value="Od:*"/>
                <s:textfield id="dateFrom" name="dateFrom" required="true"/>
            </div>
            <div>
                <s:label for="dateTo" value="Do:*"/>
                <s:textfield id="dateTo" name="dateTo" required="true"/>
            </div>
            <div>
                <s:label for="linkChecked" value="Link?"/>
                <s:checkbox id="linkChecked" name="linkChecked" value="true" cssClass="linkChecked"/>
            </div>
            <div class="linkDiv">
                <s:label for="link" value="Link:*"/>
                <s:textfield id="link" name="link"/>
            </div>
            <div class="redirectActionDiv">
                <s:label for="redirectAction" value="redirectAction:*"/>
                <s:textfield id="redirectAction" name="redirectAction"/>
            </div>
            <div>
                <s:label for="typeDth" value="DTH:"/>
                <s:checkbox id="typeDth" name="typeDth"/>
            </div>
            <div>

                <s:label for="typeMvno" value="MVNO:"/>
                <s:checkbox id="typeMvno" name="typeMvno" cssClass="typeMvno"/>
                <div class="typeMvnoDiv">
                    <s:label for="subTypeMvnoPostpaid" value="PostPaid:"/>
                    <s:checkbox id="subTypeMvnoPostpaid" name="subTypeMvnoPostpaid"/>
                    <s:label for="subTypeMvnoPrepaid" value="PrePaid:"/>
                    <s:checkbox id="subTypeMvnoPrepaid" name="subTypeMvnoPrepaid"/>
                </div>
            </div>
            <div>
                <s:label for="typeDvbt" value="DVBT:"/>
                <s:checkbox id="typeDvbt" name="typeDvbt"/>
            </div>
            <div>
                <s:label for="active" value="Aktywny:"/>
                <s:checkbox id="active" name="active"/>
            </div>
            <div>
<s:submit/>
            </div>
        </s:form> 
```

和`SaveEditedMessageAction.java`：

```
package pl.cyfrowypolsat.ebok.bm.action.content;

import java.util.Date;

import org.apache.commons.logging.Log;
import org.apache.commons.logging.LogFactory;

import pl.cyfrowypolsat.ebok.bm.action.BaseAction;
import pl.cyfrowypolsat.ebok.bm.consts.SessionParameters;
import pl.cyfrowypolsat.ebok.bm.ejb.IMessages;
import pl.cyfrowypolsat.ebok.bm.ejb.bean.MessageBean;
import pl.cyfrowypolsat.ebok.bm.utils.EJBLocator;

public class SaveEditedMessageAction extends BaseAction{

    private static final long serialVersionUID = 1L;

    private static final Log LOG = LogFactory.getLog(SaveEditedMessageAction.class);

    private int id;

    private Date dateFrom;
    private Date dateTo;

    private String link;
    private String header;
    private String redirectAction;

    private boolean typeDth;
    private boolean typeMvno;
    private boolean typeDvbt;
    private boolean subTypeMvnoPostpaid;
    private boolean subTypeMvnoPrepaid;
    private boolean active;
    private boolean linkChecked;

    public String execute() {
        LOG.info("Enter: execute(). " + dateFrom + " " + link);
        MessageBean sessionMessageBean = (MessageBean) sessionParameters.get(SessionParameters.MESSAGE_EDIT);

        if(sessionMessageBean != null) {
            IMessages messagesEJB = EJBLocator.getMessages();

            sessionMessageBean.setDateFrom(getDateFrom());
            sessionMessageBean.setDateTo(getDateTo());
            sessionMessageBean.setLinkHref(getLink());
            if(linkChecked){
                sessionMessageBean.setHtml(generateMessageHtmlLink(getLink(), getHeader()));
                sessionMessageBean.setRedirectAction("NULL");
            } else {
                sessionMessageBean.setRedirectAction(getRedirectAction());
                sessionMessageBean.setHtml(generateMessageWithoutLink(getHeader()));
            }
            sessionMessageBean.setTypeDth(booleanToInt(isTypeDth()));
            sessionMessageBean.setTypeMvno(booleanToInt(isTypeMvno()));
            sessionMessageBean.setSubTypeMvnoPostpaid(booleanToInt(isSubTypeMvnoPostpaid()));
            sessionMessageBean.setSubTypeMvnoPrepaid(booleanToInt(isSubTypeMvnoPrepaid()));
            sessionMessageBean.setTypeDth(booleanToInt(isTypeDth()));
            sessionMessageBean.setAktywny(booleanToInt(isActive()));

            messagesEJB.updateMessage(sessionMessageBean);
        }
        LOG.info("Exit: execute()");
        return SUCCESS;
    }

    public int getId() {
        return id;
    }

    public void setId(int id) {
        this.id = id;
    }

    public Date getDateFrom() {
        return dateFrom;
    }

    public void setDateFrom(Date dateFrom) {
        this.dateFrom = dateFrom;
    }

    public Date getDateTo() {
        return dateTo;
    }

    public void setDateTo(Date dateTo) {
        this.dateTo = dateTo;
    }

    public String getLink() {
        return link;
    }

    public void setLink(String link) {
        this.link = link;
    }

    public String getHeader() {
        return header;
    }

    public void setHeader(String header) {
        this.header = header;
    }

    public String getRedirectAction() {
        return redirectAction;
    }

    public void setRedirectAction(String redirectAction) {
        this.redirectAction = redirectAction;
    }

    public boolean isTypeDth() {
        return typeDth;
    }

    public void setTypeDth(boolean typeDth) {
        this.typeDth = typeDth;
    }

    public boolean isTypeMvno() {
        return typeMvno;
    }

    public void setTypeMvno(boolean typeMvno) {
        this.typeMvno = typeMvno;
    }

    public boolean isTypeDvbt() {
        return typeDvbt;
    }

    public void setTypeDvbt(boolean typeDvbt) {
        this.typeDvbt = typeDvbt;
    }

    public boolean isSubTypeMvnoPostpaid() {
        return subTypeMvnoPostpaid;
    }

    public void setSubTypeMvnoPostpaid(boolean subTypeMvnoPostpaid) {
        this.subTypeMvnoPostpaid = subTypeMvnoPostpaid;
    }

    public boolean isSubTypeMvnoPrepaid() {
        return subTypeMvnoPrepaid;
    }

    public void setSubTypeMvnoPrepaid(boolean subTypeMvnoPrepaid) {
        this.subTypeMvnoPrepaid = subTypeMvnoPrepaid;
    }

    public boolean isActive() {
        return active;
    }

    public void setActive(boolean active) {
        this.active = active;
    }

    public boolean isLinkChecked() {
        return linkChecked;
    }

    public void setLinkChecked(boolean linkChecked) {
        this.linkChecked = linkChecked;
    }
} 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-07-18T13:32:20.493

您的表单操作是针对`SaveEditedUserAction`，而不是`SaveEditedMessageAction`。

# android - 何时多线程 sqlite 数据库查询

> ID：11542304
> 
> 赞同：0
> 
> 时间：2012-07-18T13:16:02.173
> 
> 标签：android, database, multithreading, sqlite

我用一个数据库助手编写了一个内容提供程序，并开始构建一个“管理器”类来执行特定的插入、删除、更新、查询等。

经理在必要时为我的光标适配器返回光标加载程序，我相信这是多线程的。

我的问题是，当我在数据库上执行不涉及加载程序的操作时，我应该创建一个新线程吗？

一个例子可能是，我从操作栏中执行保存 - 我应该手动多线程插入吗？这也适用于更新查询删除等？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-07-18T13:27:28.460

多线程数据库操作时必须非常谨慎。

1.  是否需要多线程？除非您的数据库非常大并且您正在执行的操作对数据库非常繁重，否则我会说没有必要。

2.  安全吗？如果线程在同一个表上执行操作，那么在运行多个线程时必须非常小心。您必须确保您控制哪个线程首先运行以及该线程对数据库的影响。一般来说，这是不明智的。

从您的具体问题的声音来看，我会说不需要多个线程。如果这会影响用户并且您希望他们等待尽可能少的时间，也许您可​​以查看后台线程！

# php - 使用 PHPMailer 发送 SMTP 消息，“邮件未从服务器接受”的响应，为什么？

> ID：11542305
> 
> 赞同：0
> 
> 时间：2012-07-18T13:16:03.350
> 
> 标签：php, email, ubuntu, smtp, phpmailer

我一直在努力解决这个问题……任何线索将不胜感激。

我在运行 exim 的 Ubuntu 12.04 服务器上通过 PHPMailers SMTP 类本地发送邮件。如果我只发送 10 条消息，一切正常。但是，如果我排队说 260 多条消息并尝试一个接一个地发送它们，我可以保证其中约 30 条消息将与该行一起返回：

`MAIL not accepted from server`

他们都去同一个地址（其他 230 人成功到达那里），我有时可以看到 exim 中的队列正在运行，所以可能是什么原因造成的，如果我只是这样，为什么不会发生这种错误使用“邮件”命令？

提前致谢。

本

PS：我没有使用 mail 命令，因为我实际上是从 SMTP 输出中提取消息 ID

**更新**

我在 PHPMailers class.smtp.php 文件中进行了更多挖掘，并在 Mail 函数中添加了一个或两个 var_dump，并且我还将调试级别提高到 4（这样我就可以看到每个 SMTP 响应）。似乎该`$this->getLines()`函数正在从套接字读取一个空白行...... class.smtp.php 正在解释（可能是错误的）然后退出。这是一个有效的回应吗？为什么 telnet 什么都不返回..？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-07-18T13:44:54.000

您收到的错误应该比这提供更多信息，例如

```
ERROR: MAIL not accepted from server: 550 Tarpit active for... 
```

或类似的东西。消息的第二部分应该告诉您错误是什么。否则，您应该能够在邮件日志消息中看到原因 - /var/log/messages、/var/log/mail* 等。

**更新**：这就是我这么说的原因：

```
if($code != 250) {
  $this->error =
    array("error" => "MAIL not accepted from server",
          "smtp_code" => $code,
          "smtp_msg" => substr($rply,4));
  if($this->do_debug >= 1) {
    echo "SMTP -> ERROR: " . $this->error["error"] . ": " . $rply . $this->CRLF . '<br />';
  }
  return false;
} 
```

...所以错误应该还包括 SMTP 代码和/或消息，而不仅仅是“不接受来自服务器的邮件”。

无论如何，错误的原因应该已经被服务器记录了，并且可以在 /var/log/exim4/rejectlog 或 /var/log/exim4/mainlog 等中找到。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-07-18T13:39:49.043

1.  你试过把 sleep(1); 邮件之间的延迟？您可以在一定时间内发送多少邮件可能会有限制。

2.  检查该错误发生的时间，脚本工作了多长时间？邮件服务器登录时间似乎已过期。将电子邮件除以较小的数量，并在发送大约 20 封电子邮件后重新登录。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2015-03-10T05:00:09.600

1 天前我在 PHPMailer 类中遇到了同样的问题，我收到了错误消息：`MAIL not accepted from server:`没有进一步的错误详细信息。我有一个简单的解决方案，我`SetFrom("my@email.com", "My Name")`之前做过`Send()`，它是有效的。我猜这是关于 SMTP 服务器，它需要一个“FROM”标头才能通过 SMTP 服务器发送。我希望它对可能来到这个线程并且和我有同样问题的人有用。

# delphi - 如何定期处理列表框的下一项？

> ID：11542307
> 
> 赞同：0
> 
> 时间：2012-07-18T13:16:08.583
> 
> 标签：delphi, timer, listbox

我在与 TIdHTTP 一起使用的 TListBox（1.2.42.x.2.4:42、2.4.1.x.1.2.x.2:60 等）中有一个代理地址列表。单击按钮时，我使用选定的代理获取给定的 URL：

```
procedure TForm1.Button1Click(Sender: TObject);
var
  I: Integer;
  S: String;
begin
  I := Listbox1.ItemIndex;
  if I <> -1 then
  begin
    S := Listbox1.Items[I];
    IdHTTP1.ProxyParams.ProxyServer := Fetch(S, ':');
    IdHTTP1.ProxyParams.ProxyPort := StrToInt(S);
    try
      IdHTTP1.ReadTimeout:=strtoint(form1.Edit1.Text); // ZMAAN AŞIMI
      IdHTTP1.Get(Edit4.Text);                         // POST GET
      MessageDlg('Ok.', mtinformation,[mbOK],0); // TAMAMLANDI.
    except
      MessageDlg('Error.', mtinformation,[mbOK],0);   // HATA VERDİ.
      IdHTTP1.Disconnect;   // ÖLDÜR.
    end;
  end;
end; 
```

单击按钮后，我希望我的程序自动执行与上面相同的操作，但使用 ListBox1.Items[1]，然后是 ListBox1.Items[2]，依此类推。

我想我可以为此使用 TTimer，但是如何？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-07-18T13:27:50.920

当然。这是一种方法：

```
procedure TForm1.ListBox1Click(Sender: TObject);
var
  I: Integer;
  S: String;
begin
  I := Listbox1.ItemIndex;
  if I <> -1 then
  begin
    S := Listbox1.Items[I];
    IdHTTP1.ProxyParams.ProxyServer := Fetch(S, ':');
    IdHTTP1.ProxyParams.ProxyPort := StrToInt(S);
     try
      IdHTTP1.ReadTimeout:=strtoint(form1.Edit1.Text); // ZMAAN AŞIMI
      IdHTTP1.Get(Edit4.Text);                         // POST GET
      MessageDlg('Ok.', mtinformation,[mbOK],0); // TAMAMLANDI.
    except
      MessageDlg('Error.', mtinformation,[mbOK],0);   // HATA VERDİ.
      IdHTTP1.Disconnect;   // ÖLDÜR.
    end;
  end;
end;

procedure TForm1.Timer1Timer(Sender: TObject);
begin
  Timer1.Enabled := False;
  try
    ListBox1Click(nil);
    if ListBox1.ItemIndex < ListBox1.Items.Count - 1 then
      ListBox1.ItemIndex := ListBox1.ItemIndex + 1
    else
      ListBox1.ItemIndex := -1;
  finally
    // To stop after only one loop through all items, as you asked in your comment:
    Timer1.Enabled := (ListBox1.ItemIndex > -1);
  end;
end; 
```

我个人会将事件中的几乎所有代码移动`ListBox1Click`到它自己的独立方法中，您可以轻松地从`ListBox.OnClick`事件或事件中调用该方法。`Timer.OnTimer`您可以将`ListBox1.Items[ListBox1.ItemIndex]`作为参数传递给该方法。IMO，它会让你的代码更干净。

# ember.js - 在 init 函数中设置的控制器总是相等的

> ID：11542308
> 
> 赞同：7
> 
> 时间：2012-07-18T13:16:08.693
> 
> 标签：ember.js

我有一个`Ember.Controller`, 在 init 函数中有设置代码。实际上，此代码发出 AJAX 请求。但是当我创建这个控制器的两个实例时，它们总是相等的。为什么，我该怎么做呢？

我做了这个简单的例子，应该写入`Test 1` `Test 2`控制台。把它的字咬了`Test 2`两下。

```
App = Em.Application.create({});

App.TestController = Em.Controller.extend({
    content: Em.Object.create({
        info: null,
    }),
    init: function() {
        if(this.id == 1)
        {
            this.content.set('info', "Test 1");
        }

        if(this.id == 2)
        {
            this.content.set('info', "Test 2");
        }
    },
});

var c1 = App.TestController.create({id: 1});
var c2 = App.TestController.create({id: 2});

console.log('C1: ' + c1.get('content').get('info'));
console.log('C2: ' + c2.get('content').get('info'));

​ 
```

* * *

## 回答 #1

> 赞同：18
> 
> 时间：2012-07-18T13:21:07.280

您必须在 中设置`content`值`init`，否则在类声明时设置的值将由所有实例共享。

```
App.TestController = Em.Controller.extend({
  content: null,

  init: function () {
    this._super();
    this.set('content', Em.Object.create({
      info: null
    }));

    // other setup here...
  }
}); 
```

请参阅[http://codebrief.com/2012/03/eight-ember-dot-js-gotchas-with-workarounds/](http://codebrief.com/2012/03/eight-ember-dot-js-gotchas-with-workarounds/)

# c# - 使用 MVC2 的 HandleErrorInfo - 模型为空？

> ID：11542309
> 
> 赞同：5
> 
> 时间：2012-07-18T13:16:08.840
> 
> 标签：c#, asp.net, asp.net-mvc, asp.net-mvc-2

我有一个即将发布的 MVC 2 Web 应用程序。到目前为止，我已经关闭了自定义错误，但我希望它们在我准备好生产时工作。

我已经使用以下内容设置了我的 web.config：

```
<customErrors mode="On" defaultRedirect="/Error/">
  <error statusCode="404" redirect="/Error/NotFound "/>
</customErrors> 
```

404 完美运行，NotFound 是一个直接映射到视图的操作，该视图使用我自己的 Site.Master 文件显示一个非常标准的 404 页面。

对于 404 以外的任何内容，我希望用户能够查看异常详细信息。（这是一个内部应用程序，这样做没有安全风险）。

`Error`默认操作`Index`设置为返回我定义的 View() 。我想不通的是如何将异常信息传递到视图中？

这看起来很有希望：

[http://devstuffs.wordpress.com/2010/12/12/how-to-use-customerrors-in-asp-net-mvc-2/](http://devstuffs.wordpress.com/2010/12/12/how-to-use-customerrors-in-asp-net-mvc-2/)

但是当我使用 View 时：

```
<%@ Page Title="" Language="C#" 
    MasterPageFile="~/Views/Shared/Bootstrap.Master"
    Inherits="System.Web.Mvc.ViewPage<System.Web.Mvc.HandleErrorInfo>" %> 
```

错误页面本身会引发错误，因为 HandleErrorInfo 为空。显然，自定义错误中的错误会导致 MVC2 出现一系列问题，结果是黄屏死机。

我想要么我错过了博客中的一些关键内容，要么它没有解释如何在不为我的每个控制器/操作设置 Error 属性的情况下让 HandleErrorInfo 为 null 以外的任何内容。

另外，我知道 MVC3 可以更好地处理这个问题，并且我知道 Razor 非常好。它没有用于这个项目，也不会改变这个项目来使用它。所以请不要“使用 MVC3”的答案。

* * *

## 回答 #1

> 赞同：12
> 
> 时间：2012-07-18T14:12:56.110

为空，`HandleErrorInfo`因为您正在执行重定向`customErrors`。

这是我在我的最新项目中尝试的想法，我为 MVC 2 进行了更新。我没有使用`customErrors`，因为我无法在不执行重定向的情况下调用控制器操作（我猜）。

**应用程序错误**

```
protected void Application_Error(Object sender, EventArgs e)
{
    GlobalErrorHandler.HandleError(((HttpApplication)sender).Context, Server.GetLastError(), new ErrorController());
} 
```

**全局错误处理程序**

```
public class GlobalErrorHandler
{
    public static void HandleError(HttpContext context, Exception ex, Controller controller)
    {
        LogException(ex);

        context.Response.StatusCode = GetStatusCode(ex);
        context.ClearError();
        context.Response.Clear();
        context.Response.TrySkipIisCustomErrors = true;

        if (IsAjaxRequest(context.Request))
        {
            ReturnErrorJson(context, ex);
            return;
        }

        ReturnErrorView(context, ex, controller);
    }

    public static void LogException(Exception ex)
    {
        // log the exception
    }

    private static void ReturnErrorView(HttpContext context, Exception ex, Controller controller)
    {
        var routeData = new RouteData();
        routeData.Values["controller"] = "Error";
        routeData.Values["action"] = GetActionName(GetStatusCode(ex));

        controller.ViewData.Model = new HandleErrorInfo(ex, " ", " ");
        ((IController)controller).Execute(new RequestContext(new HttpContextWrapper(context), routeData));
    }

    private static void ReturnErrorJson(HttpContext context, Exception ex)
    {
        var json = string.Format(@"success: false, error:""{0}""", ex.Message);
        context.Response.ContentType = "application/json";
        context.Response.Write("{" + json + "}");
    }

    private static int GetStatusCode(Exception ex)
    {
        return ex is HttpException ? ((HttpException)ex).GetHttpCode() : 500;
    }

    private static bool IsAjaxRequest(HttpRequest request)
    {
        return request.Headers["X-Requested-With"] != null && request.Headers["X-Requested-With"] == "XMLHttpRequest";
    }

    private static string GetActionName(int statusCode)
    {
        string actionName;

        switch (statusCode)
        {
            case 404:
                actionName = "NotFound";
                break;

            case 400:
                actionName = "InvalidRequest";
                break;

            case 401:
                actionName = "AccessDenied";
                break;

            default:
                actionName = "ServerError";
                break;
        }

        return actionName;
    }

    public static bool IsDebug
    {
        get
        {
            bool debug = false;

#if DEBUG
            debug = true;
#endif
            return debug;
        }
    }
} 
```

**错误控制器**

```
public class ErrorController : Controller
{
    public ActionResult AccessDenied()
    {
        return View("AccessDenied");
    }

    public ActionResult InvalidRequest()
    {
        return View("InvalidRequest");
    }

    public ActionResult NotFound()
    {
        return View("NotFound");
    }

    public ActionResult ServerError()
    {
        return View("ServerError");
    }
} 
```

**服务器错误视图**

```
<%@ Page Title="" Language="C#" MasterPageFile="~/Views/Shared/Site.Master" Inherits="System.Web.Mvc.ViewPage<System.Web.Mvc.HandleErrorInfo>" %>

<asp:Content ID="Content1" ContentPlaceHolderID="TitleContent" runat="server">
    ServerError
</asp:Content>

<asp:Content ID="Content2" ContentPlaceHolderID="MainContent" runat="server">

    <h2>ServerError</h2>

    <% if (Model.Exception != null ) { %>
        <p>
          Controller: <%= Model.ControllerName %>
        </p>
        <p>
          Action: <%= Model.ActionName %>
        </p>
        <p>
          Message: <%= Model.Exception.Message%>
        </p>
        <p>
          Stack Trace: <%= Model.Exception.StackTrace%>
        </p>
    <% } %>

</asp:Content> 
```

# visual-studio-2008 - 设计继承窗体时 Visual Studio 2008 无法显示设计器

> ID：11542311
> 
> 赞同：1
> 
> 时间：2012-07-18T13:16:10.550
> 
> 标签：visual-studio-2008, windows-forms-designer

我正在尝试通过从我已经创建的另一个表单继承来创建一个表单。原因是原来的表单实际上有3个状态，继承结构会更容易调试、理解和改进。

问题是我的 Visual Studio 2008 Forms 设计器不适合这个想法。而不是我可以设计的表单，我收到以下错误消息：

**无法为此文件显示设计器，因为无法设计其中的任何类。设计人员检查了文件中的以下类： InheritedForm --- 无法加载基类“MyBaseForm”。确保已引用程序集并且已构建所有项目。**

基本上我在设计器中看不到我继承的表单，但原始表单在设计器中可以正常工作。

这非常令人沮丧，所以为了确保问题不是 VS2008 的错，我创建了一个全新的干净的 Forms 项目（.net 2.0）并创建了一个我称为 Form1 的表单和另一个从 Form1 继承的表单（Form2）。这个项目工作得很好。我可以在设计器中看到 Form1，在我的 Form2 中我可以看到我已添加到 Form1 的标签，但无法在 Form2 中移动它，因为它属于 Form 1。

我的测试结果证明我的 Visual Studio 确实有效；只是不在我需要它工作的原始项目中。我尝试的另一件事是，当您使用 VS2008 指南创建继承表单时，通过继承选择器创建继承的 From。在我的测试项目中，我可以看到我创建的所有表单，但在我的原始项目中，我无法选择任何东西。我试图浏览到我的 bin 文件夹中的 exe 文件，但它没有给我任何形式可供选择。

我也尝试过重建项目，清理项目并重新启动 VS2008，希望它处于某种奇怪的状态，但没有任何帮助。我不会否认我有一些可能会干扰设计器的奇怪项目设置的想法，因为项目文件有些旧并且有很多文件和元素。但是由于我得到的错误描述，我发现这不太可能（仍在调查）。

我一直在互联网上搜索到相同的文章、论坛或博客，无论我在 Google 的搜索字段中输入什么内容或进行链接浏览，都没有成功。你们中的任何人对可能导致我的问题的原因有什么想法或建议吗？在这一点上的任何帮助、提示或建议都非常感谢。

先感谢您。

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-07-19T06:41:50.270

我解决了这个问题。当我的一位同事认为他想解决我的问题并在他的计算机上启动相同的程序时，我正在研究 Hans Passant 的建议。令我们惊讶的是，他的设计师也在同一个项目上工作。在我们查看构建配置之前，我们都对此感到困惑。

我在我的问题中忘记提到的是，由于第 3 方 dll，我们的特定项目需要为 x64 或 86x 平台构建。这对于设计人员在使用普通表单时通常不是问题，但是当涉及到继承表单时，设计人员实际上需要运行基本表单才能显示继承的表单。

我的同事构建配置设置为 x86，我的设置为 x64。我们都在运行 VS2008(86x) 版本，这意味着设计者很可能构建在 86x 平台上。我们的结论是，如果我们将表单构建为 x64，设计者不知道如何运行它。所以我尝试将我的目标平台从 64x 更改为 86x，在我在 VS 中关闭我的表单并对项目进行重建后，设计师再次工作。

可以肯定的是，我尝试使用一个新的空干净项目对其进行测试。我创建了 2 种形式：一种是基类，另一种是从基类继承的。默认情况下，构建配置是“AnyCPU”，设计器工作正常。但是当我将配置更改为“x64”时，设计器再次按预期失败。切换到“x86”按预期解决了问题。

因此，在平台特定项目中使用继承表单时，**请始终在项目平台版本中设计等于您的 VS2008 平台版本**（在我的情况下为 x86。我实际上不知道是否有 x64 版本的 Visual Studio 2008）。由于某种原因，我仍然无法在我的原始项目中使用继承选择器，但在代码中继承就像一个魅力。

# tomcat - JRuby Rails 3.1.6 在子目录中的 Tomcat 7 上部署 WAR（重定向和链接不使用子目录）

> ID：11542314
> 
> 赞同：2
> 
> 时间：2012-07-18T13:16:23.367
> 
> 标签：tomcat, deployment, ruby-on-rails-3.1, jruby, rails-routing

我有一个 JRuby on Rails 3.1.6 应用程序，并希望将其作为 WAR 文件部署在 Tomcat 7 上。为了产生战争，我使用莺。

我可以将应用程序部署到服务器并且一切都在运行。但是生成的链接或重定向表单设计为`/users/sign_in`不起作用，因为上下文路径被忽略了。

我尝试使用以下命令设置相对 url 根：

```
config.action_controller.relative_url_root = '/foo' 
```

但是没有找到方法。（也为此尝试了 ENV 变量，但什么也没发生）

我尝试`scope '/foo'`在我的中使用，`routes.rb`但这也不起作用。

我也尝试将其添加到我的`config.ru`

```
map '/foo' do
  run Foo::Application
end 
```

但是`config.ru`文件接缝不包含在 WAR 文件中或以任何方式使用。

我无法在 tomcat 中生成 VirtualHost 或任何东西，我只有将应用程序部署为 WAR 文件的权限。有什么方法可以告诉 Rails 应用程序它在给定的子目录（上下文路径）下运行，以便将其添加到所有生成的链接、重定向等，在 Rails 3.1.6 中工作？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-07-30T11:03:35.980

听起来像是一个**设计**的东西，你检查过它是如何发出重定向的吗？假设您从操作中执行以下操作，它应该可以工作：

```
def index
  redirect_to :action => "hello"
end 
```

*`warble`当应用程序在不同于**/的 servlet 上下文路径中运行时，** *jruby-rack*（当你包含在内）正确处理情况。我建议扭转你试图让事情正常工作的“黑客”，并查看重定向你的代码......例如，诸如`redirect_to "/home/goodbye"`不会“工作”（前缀上下文路径）之类的代码被认为是一个完整的 URL小路。*

 *至于`config.ru`Rails 应用程序，Warbler 不会复制它——因此它可以将 Rails 与普通的 Rack 应用程序区分开来（因为*jruby-rack*对 Rails 做了更多的钩子，以提供与 Tomcat 等 servlet 容器的无缝体验）。*

# java - 泽西对象映射

> ID：11542315
> 
> 赞同：2
> 
> 时间：2012-07-18T13:16:23.667
> 
> 标签：java, json, jersey

我想使用 Jersey 来获取一个带有 REST 调用的 Java 对象。问题：如果 A 拥有 B 的所有成员，我可以发送 A 类的对象并接收 B 类的对象吗？

让我举个例子：

```
 class A {
    String one;
    Date two;
    int three;
 }

 class B {
    Date two;
    int three;
 } 
```

可以说，我有一个 REST 服务：

```
class MyREST {

  @GET
  @Path("somepath")
  public void getThing() {
     return new A();
{ 
```

我用代码调用它：

```
Client client = Client.create();
WebResource scResource = client.resource("somePath");

MyClass result = scResource.type(MediaType.APPLICATION_JSON_TYPE).accept(MediaType.APPLICATION_JSON_TYPE).get(B.class); 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-07-18T16:01:02.727

实际上，这是可能的。

Jackson 会将类编组/解组为 JSON，只要它可以解析它，另一端就不会注意到它是哪个类。

但是您的代码有几个错误：

*   将您的属性设为私有，然后提供 getter/setter 方法。这对于每个 java 类。
*   至少用 @XmlRootElement 注释类，以便杰克逊可以找到它们
*   使用 @Produces 和 @Consumes 注释方法，将它们设置为 JSON

以下代码可以正常工作（为方便起见，我将格式更改为 XML，在 JSON 中应该相同）：

测试服务程序：

```
@Path("/testDifferentClass")
public class TestServlet {

    @GET
    @Produces(MediaType.APPLICATION_XML)
    @Consumes(MediaType.APPLICATION_XML)
    public ClassA getClassA() {
        ClassA classA = new ClassA();
        classA.setOne("Hello");
        classA.setTwo(new Date());
        classA.setThree(1);
        return classA;
    }
} 
```

A类：

```
@XmlRootElement(name = "common")
public class ClassA {

    private String one;
    private Date two;
    private int three;

    public String getOne() {
        return one;
    }
//more getters and setters 
```

B类：

```
@XmlRootElement(name="common")
public class ClassB {

    private String one;
    private Date two;

    public String getOne() {
        return one;
    }
//more getters and setters 
```

测试不同：

```
public void test() {
    Client client = Client.create();
    WebResource scResource = client.resource("http://localhost:8080/services/testDifferentClass");

    ClassB result = scResource.type(MediaType.APPLICATION_XML).accept(MediaType.APPLICATION_XML).get(ClassB.class);
    System.out.println(result.getOne());
    System.out.println(result.getTwo());
} 
```

输出是 Hello 和今天的日期

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-07-18T13:30:53.667

如果您的 A 类与 B 类有任何关系，或者 B 与 A 类有关系，这是可能的。

但是在您的代码中似乎没有任何关系，因此不可能有关系。

# javascript - 使用 Javascript 创建 Azure Blob

> ID：11542317
> 
> 赞同：0
> 
> 时间：2012-07-18T13:16:33.890
> 
> 标签：javascript, azure

我不想使用 javascript 和 SharedAccessSignature 创建 blob。所有javascript文件都部署在BlobStorage中，我想上传我的blob，所以我希望Same Site Origin应该没有问题。服务器向客户端发送 SharedAccessSignature，客户端将文件/数据上传到 Blob 存储中。

这可能吗？

如果是：是否有用于 blob 处理的 javascript 库？（我找到了这个[库](http://azureblobstoragejs.codeplex.com/releases/view/32114)，但它不支持 PutBlob 操作）

如果不是：最好的替代方法是在相应的 ASP.Net 站点中实现上传功能并让 javascript 调用一些提供的方法吗？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-07-18T13:49:09.813

有一个用于访问 Azure 存储的 node.js 模块。您可以使用[browserify](https://github.com/substack/node-browserify)在客户端使用它。当然，将您的访问密钥放在可以读取的 javascript 中总是存在一些风险。谁知道您的存储帐户可以提供什么服务。

# ios - 撤销证书请求

> ID：11542322
> 
> 赞同：1
> 
> 时间：2012-07-18T13:16:43.063
> 
> 标签：ios, certificate, ios-provisioning

我尝试提交我的 iOS 应用程序进行验证。不幸的是，在 xcode 上存档应用程序并单击验证按钮后，我收到了此消息：

“此 Mac 上未安装“xxxxxx”的私钥”

但我无法从创建此证书的设备中导出配置文件。

我可以从 ios 开发者门户撤销开发和分发证书并创建新证书吗？

我想说实际的证书是另一个应用程序使用的证书。如果我撤销，如果我想更新这个应用程序会有风险吗？

# iphone - 使用 iPhone sdk 以编程方式在 Facebook 的墙上发布复杂消息

> ID：11542339
> 
> 赞同：0
> 
> 时间：2012-07-18T13:17:31.063
> 
> 标签：iphone, objective-c, ios, facebook

我刚刚解决了使用 Facebook iOS sdk 以编程方式在 Facebook 墙上发帖的问题。它完全在我的应用程序中工作。这是代码的一部分：

```
NSString *messageString=@"test message";
FBRequest *request=[[FBRequest alloc] initWithSession:FBSession.activeSession graphPath:@"me/feed" parameters:[NSDictionary dictionaryWithObject:messageString forKey:@"message"] HTTPMethod:@"POST"]; 
```

现在我不仅需要在 facebook 的墙上发布短信。我需要发布这个： ![在 Facebook 上发帖示例](../Images/0ba430c0672ed6f83468b6a0f9cb9925.png)

这是我应该用来使我的帖子看起来相似的参数[http://developers.facebook.com/docs/reference/rest/stream.publish/](http://developers.facebook.com/docs/reference/rest/stream.publish/)

请帮我用参数（消息、链接、标题等）制作系绳值。

最好的答案是`NSDictionary`对象，我可以将它`FBRequest`作为`parameters`参数传递给我的 init 方法。

感谢您的关注。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-07-18T13:34:54.050

这是我用来发布到 Facebook 的代码，内容与您的图片非常相似。

```
SBJSON *jsonWriter = [SBJSON new];

NSDictionary* attachment = [NSDictionary dictionaryWithObjectsAndKeys:
                            attachmentTitle, @"name",
                            attachmentLink, @"href",
                            attachmentCaption, @"caption",
                            attachmentDescription, @"description",
                            nil];

NSString *attachmentStr = [jsonWriter stringWithObject:attachment];

[postContent setObject:attachmentStr forKey:@"attachment"];       
[postContent setObject:textView.text forKey:@"message"];

[FB requestWithMethodName:@"stream.publish" andParams:postContent andHttpMethod:@"POST" andDelegate:self]; 
```

# c# - Linq从m到n个表中获取数据？

> ID：11542340
> 
> 赞同：0
> 
> 时间：2012-07-18T13:17:31.330
> 
> 标签：c#, linq, relational-database

我有 2 个表，它们之间是 m 到 n 的关系。角色，模块，模块InRoles。我得到当前的用户角色。我想得到这些角色的模块。我试着写点东西。但我不能成功。

```
string[] roller = System.Web.Security.Roles.GetRolesForUser();

IEnumerable<TblModuller> moduller = null;
IEnumerable<TblModulsInRoles> moduls_in_roles = null;

foreach (var rol in roller)
{
     moduls_in_roles = entity.TblModulsInRoles.Where(x => x.Roles.RoleName == rol);
     foreach(var modul in moduls_in_roles)
     {
         //I dont know What should I write or this code is correct.
     }
} 
```

例如; 我的数据是这样的：

```
Admin  Modul1
Admin  Modul2
User   Modul2
User   Modul3 
```

我想得到这个：

```
Modul1
Modul2
Modul3 
```

逻辑是什么？是否有一些关于这个主题的代码示例或教程。

谢谢。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-07-18T13:23:56.837

试试这个

```
var modullerList = new List< TblModuller>();

foreach (var rol in roller)
{
     moduls_in_roles = entity.TblModulsInRoles.Where(x => x.Roles.RoleName == rol);
     foreach(var modul in moduls_in_roles)
     {
        if(!modullerList .Contains(modul))
            modullerList .Add(modul);
     }
} 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-07-18T14:36:07.327

回答您的问题*“我想问是否有不同的方式？”* : 你可以使用`SelectMany`. 我不确定我是否完全理解你正在使用的结构，但我猜到了。希望是对的。

```
string[] roles = System.Web.Security.Roles.GetRolesForUser();

var modules = roles
    .SelectMany(r =>
        entity.TblModulsInRoles.Where(m => m.Roles.RoleName == r)
    )
    .Distinct(); 
```

假设从返回的每个模块`TblModulesInRoles`是每个角色映射中引用的相同对象，这应该有效。如果它不是同一个对象，那么您的模块实体可能必须通过一种标准方式进行比较。

这是我用来在本地测试的代码。显然，这并不完全一样，但`SelectMany`至少证明了这一点。

```
public class Module
{
    public Module(string name)
    {
        Name = name;
    }

    public string Name { get; private set; }
}

Module one = new Module("one");
Module two = new Module("two");
Module three = new Module("three");

Dictionary<string, List<Module>> dict = new Dictionary<string, List<Module>>
{
    {"cow", new List<Module> { one, two }},
    {"chicken", new List<Module> { one }},
    {"pig", new List<Module> { two }}
};

string[] roles = new string[] { "cow", "chicken", "pig" };

var result = roles.SelectMany(r => dict[r]).Distinct();

Console.WriteLine(result);

// { one, two } 
```

# android - 覆盖 Android GUI

> ID：11542341
> 
> 赞同：1
> 
> 时间：2012-07-18T13:17:33.763
> 
> 标签：android, android-layout

我正在研究我的一个特殊项目，该项目应该定制一点 Android 用户的体验。我们的想法是，我们应该在每个 Activity 中自定义导航按钮，允许用户在应用程序中来回切换。

我知道在 Android 中基本上无法隐藏导航按钮（尤其是从 4.​​x 开始）；但可以覆盖他们的行为。

我的问题有两个：

*   可以自定义这些按钮（改变它们的外观和感觉、大小……）

如果无法做到这一点：

*   创建一个扩展 Activity 并始终呈现按钮的主类是否可行（以便我可以在需要这些按钮时继承这个类）？

欢迎所有的反馈和批评。
此外，如果您对如何解决此问题有其他想法，或者如果您在其中一个项目中做了不同的事情，请指出正确的（*主观*）方向。

最好的。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-07-18T13:24:04.030

当然，您可以`view`通过多种方式自定义现有的 s：

*   您可以更改它们的样式、背景、状态等。
*   您可以扩展现有视图（`TextView`例如）并添加属性

您还可以`ViewGroup`通过扩展`ViewGroup`或`Layout`（线性、相对等）来定义自定义。最后，您可以从头开始创建视图，扩展`View`.

有关自定义组件，请参阅[此处的文档](http://developer.android.com/guide/topics/ui/custom-components.html)

这让您几乎可以做任何事情。

但是，我不建议您更改 Android UI，因为用户对它很熟悉，而且我认为显示“过于定制”的 UI 并不是一件好事。

希望这可以帮助你

***注意**：如果你想自定义Android ActionBar，你需要隐藏它并创建你自己的（或者使用一些像ActionBarSherlock这样的库）*

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-07-18T13:25:59.050

我认为您需要隐藏操作栏

像

```
ActionBar actionBar = getActionBar();
actionBar.hide(); 
```

并创建一个类似的（您自己的酒吧）。

# c# - 在 kinect 中只获得一名玩家

> ID：11542351
> 
> 赞同：1
> 
> 时间：2012-07-18T13:17:51.137
> 
> 标签：c#, wpf, tracking, kinect

我只想通过 kinect 跟踪一个人，我想跟踪它的骨骼数据，同时我想显示仅包含该玩家而不包含其他玩家的深度。

此处附上负责该代码的代码，任何人都可以帮忙吗？！

```
void mySensor_AllFramesReady(object sender, AllFramesReadyEventArgs e)
        {
            if (closing)
                return;

            using (DepthImageFrame depthFrame = e.OpenDepthImageFrame())
            {
                if (depthFrame == null)
                {
                    return;
                }
                byte[] pixels = GenerateDepthImage(depthFrame);

                int stride = depthFrame.Width * 4;
                depthImage.Source =
                    BitmapSource.Create(depthFrame.Width, depthFrame.Height,
                    96, 96, PixelFormats.Bgra32, null, pixels, stride);
            }

            //Get a skeleton
            Skeleton first = GetFirstSkeleton(e);

            ProcessSkeletalData(first, e);
        } 
```

这是生成深度图像的方法：

```
private byte[] GenerateDepthImage(DepthImageFrame depthFrame)
        {
            //get the raw data from kinect with the depth for every pixel
            short[] rawDepthData = new short[depthFrame.PixelDataLength];
            depthFrame.CopyPixelDataTo(rawDepthData);

            //use depthFrame to create the image to display on-screen
            //depthFrame contains color information for all pixels in image
            //Height x Width x 4 (Red, Green, Blue, empty byte)
            Byte[] pixels = new byte[depthFrame.Height * depthFrame.Width * 4];

            //Bgr32  - Blue, Green, Red, empty byte
            //Bgra32 - Blue, Green, Red, transparency 
            //You must set transparency for Bgra as .NET defaults a byte to 0 = fully transparent

            //hardcoded locations to Blue, Green, Red (BGR) index positions       
            const int BlueIndex = 0;
            const int GreenIndex = 1;
            const int RedIndex = 2;
            const int AlphaIndex = 3;

            //loop through all distances
            //pick a RGB color based on distance
            for (int depthIndex = 0, colorIndex = 0;
                depthIndex < rawDepthData.Length && colorIndex < pixels.Length;
                depthIndex++, colorIndex += 4)
            {
                //get the player (requires skeleton tracking enabled for values)
                int player = rawDepthData[depthIndex] & DepthImageFrame.PlayerIndexBitmask;

                //gets the depth value
                int depth = rawDepthData[depthIndex] >> DepthImageFrame.PlayerIndexBitmaskWidth;

                pixels[colorIndex + BlueIndex] = 255;
                pixels[colorIndex + GreenIndex] = 255;
                pixels[colorIndex + RedIndex] = 255;
                pixels[colorIndex + AlphaIndex] = 0;

                //Color all players
                //Debug.WriteLine(player);
                if (player > 0 )
                {
                    pixels[colorIndex + BlueIndex] = 0;
                    pixels[colorIndex + GreenIndex] = 0;
                    pixels[colorIndex + RedIndex] = 0;
                    pixels[colorIndex + AlphaIndex] = 40;
                }
            }
            return pixels;
        } 
```

GetFirstSkeleton 方法的代码

```
Skeleton GetFirstSkeleton(AllFramesReadyEventArgs e)
        {
            using (SkeletonFrame skeletonFrameData = e.OpenSkeletonFrame())
            {
                if (skeletonFrameData == null)
                    return null;

                skeletonFrameData.CopySkeletonDataTo(allSkeletons);

                //get the first tracked skeleton
                Skeleton first = (from s in allSkeletons
                                  where s.TrackingState == SkeletonTrackingState.Tracked
                                  select s).FirstOrDefault();

                return first;
            }
        } 
```

问题是在这里我有所有的玩家，深度图像检测到最多 6 个玩家，而骨架跟踪只有一个，我希望两者中只有一个，同一个玩家。

当我从 player > 0 更改为 player ==1 时，它不起作用，因为播放器并不总是 id 1。

知道如何解决这个问题吗？！

非常感谢，迈克尔

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-02-21T13:06:48.503

Kinect returns at most 2 skeletons in TrackingState == Tracked, and 4 in PositionOnly.

To track the skeletons I use the closest player approach.

From the Skeletons, I keep the first with TrackingState == Tracked and minimum Position.Z value.

This way you'll avoid any other skeletons in the back, and only focus on full tracked ones.

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-09-16T22:30:31.657

我会看见：

*   [Kinect 用户检测](https://stackoverflow.com/questions/10577862/kinect-user-detection/10584231#10584231)
*   [Kinect SDK 播放器检测](https://stackoverflow.com/questions/10562554/kinect-sdk-player-detection/10562574#10562574)

这些解释了玩家检测的所有内容，然后我会[使用 Kinect SDK 的身体点云](https://stackoverflow.com/questions/11024182/point-cloud-of-body-using-kinect-sdk)仅针对该玩家的深度。

# .net - sqlclient - 远程数据库服务器的命令超时

> ID：11542355
> 
> 赞同：1
> 
> 时间：2012-07-18T13:17:54.823
> 
> 标签：.net, sql-server, winforms, sqlclient

我有一个在 winforms(.net) 中开发的应用程序，它使用的是 Sql Server 数据库。
我的客户端将在本地（内部网）使用应用程序，而我的一些客户端将在远程位置使用相同的应用程序（区域中的 winform 应用程序和远在另一个区域的数据库服务器）。

现在的问题是当他们从远程位置使用我的应用程序时，有时我会收到命令超时。
现在我已经增加了运行良好的代码中的命令超时。但我想知道在这种情况下增加命令超时是否是最佳做法？
命令超时也包括网络通道中数据的读/写不是吗？（至少这是我在[msdn](http://msdn.microsoft.com/en-us/library/system.data.sqlclient.sqlcommand.commandtimeout.aspx)上找到的）所以如果数据库位于较远的位置，增加命令和连接超时是否明智？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-07-18T15:07:33.617

听起来您的应用程序中确实需要另一层，因此客户端与数据/业务逻辑层对话，然后代表客户端从 SQL 获取数据。

这样，您的客户端只需处理网络延迟而不是 SQL 命令超时。您也不必再将 SQL 服务器暴露给直接来自 Internet 上的计算机的登录，它可以配置为仅允许从与 SQL 框位于同一物理位置的数据层登录。

然后，您可以在不涉及 SQL 的情况下调查延迟问题。

# php - 从另一个文档中获取变量

> ID：11542356
> 
> 赞同：0
> 
> 时间：2012-07-18T13:18:02.937
> 
> 标签：php, sql

我是 PHP 新手。我想获取另一个文档中的变量，以便将值插入表中。所以，我有这个代码：insert.php：

```
$inputField = $_POST['inputField'];
$inputField2 = $_POST['inputField2'];
    $Allowed_traffic = $_POST['Allowed_traffic'];
    $Frequency = $_POST['Frequency'];

    $sql="INSERT INTO users_fup (fup_id, user_id, ModemSn, start_date, end_date, allowed_traffic, realized_traffic, frequency, nextreset, whichdb) VALUES ('NULL','','', '".$inputField."', '".$inputField2."', '".$Allowed_traffic."', '', '".$Frequency."', '', '')"; 
```

我想从另一个文件中获取 ModemSn，其中包含：

```
 $ffup = mysql_query("SELECT * FROM users_fup WHERE ModemSn = '".$row['ModemSn']."' AND start_date <  '$oraoggi' AND end_date > '$oraoggi' ");  
    .
    .
    echo "<td>".$row['ModemSn']."</td><td>".$percent_traffic."</td><td>linksetfup</td><td></td></tr>"; 
```

这些文件不在同一个文件夹中。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-07-18T13:22:29.303

你不能直接。

您可能想要做的是将值放在`$row['ModemSn']`您在上述代码中使用的表单中的隐藏输入字段中。

然后，您可以通过在第二个代码块中使用该`$_POST['ModemSn']`值（来自隐藏的输入字段）运行查询来获取所需的值

此外，您构建查询的方式很容易受到 SQL 注入的影响（这就是 @Quentin 的意思）

# c# - 无法在IE和Opera中用Jquery打开ASP文件上传控件

> ID：11542365
> 
> 赞同：1
> 
> 时间：2012-07-18T13:18:30.557
> 
> 标签：c#, jquery, asp.net

使用 IE 9 和 Opera 浏览时遇到以下问题： 我有一个隐藏的 aps 文件上传对话框，当用户单击 asp 按钮时会触发该对话框。

```
<asp:LinkButton ID="btnBrowse" class="button fright marl10" OnClientClick="return openFileDialog()" runat="server" CausesValidation="false"></asp:LinkButton> 
```

这是Jquery：

```
function openFileDialog() {
    $('#uploadPhotoDialog').click();        
    return false;
} 
```

uploadPhotoDialog 是 aps 文件上传控件的 ID。

我会很感激任何答案。提前致谢。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-07-18T13:58:20.530

With the fileupload, specifically, there are security and sandboxing issues. I know that there are some things the fileupload will not respond to, such as programmatic clicking, to prevent auto-uploaders and such security shenanigans.

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-07-18T13:54:14.777

我现在只是猜测，因为我没有看到页面的源代码，也不知道这是否是问题所在。

您正在使用 ID 来选择元素。当您使用服务器标签时，ID 会发生变化。如果将 ClientIDMode="Static" 添加到上传控件会怎样（您必须使用 .net 4.0 ）？这样，id 不会像默认情况下使用服务器标签时那样改变。

有关如何在使用服务器标签时使用 jquery 选择元素的更多信息，请参阅[使用 jQuery 检索服务器控件的 ID 。](https://stackoverflow.com/questions/5666011/retrieve-id-of-server-control-using-jquery)

# php - 批量插入后检索 ID

> ID：11542366
> 
> 赞同：4
> 
> 时间：2012-07-18T13:18:35.213
> 
> 标签：php, mysql, insert, mysqli, bulkinsert

我正在使用 MySQL 5.5 和 PHP 5.4。我正在执行批量插入，需要捕获所有新插入的 ID。这是我的代码：

```
$db->query("INSERT INTO commodity (analysis_id, commodity_description, a_units, 
a_average_yield, a_average_price) SELECT $analysis_id, commodity_description, 
a_units, a_average_yield, a_average_price FROM commodity WHERE analysis_id = 
$import_analysis_id"); 
```

有没有办法检索插入行的所有新 ID？使用`$db->insert_id`只返回一个 ID。我讨厌不得不使用 PHP 循环并执行多个查询，但如果必须的话，我会这样做。谢谢！

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-07-18T13:21:55.043

`id`您可以通过首先选择表中最高的 id来找到自动递增的 s。`id`s 高于插入后的新值。

```
select max(id) from commodity 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-07-18T13:35:11.680

我想我是在想这个。由于我要插入 analysis_id（例如，案例编号、客户编号等），因此我决定在此查询之后运行一个查询，该查询将提取插入的 analysis_id 的所有 ID。这解决了我的问题。

# c# - 在哪里可以找到 Microsoft.Build.Utilities.v3.5

> ID：11542367
> 
> 赞同：24
> 
> 时间：2012-07-18T13:18:40.143
> 
> 标签：c#, .net, msbuild, teamcity, msbuild-4.0

如何获取 Microsoft.Build.Utilities.v3.5？我正在使用 StyleCop 4.7，看起来 Stylecop.dll 中的 StyleCop msbuild 任务作为 Microsoft.Build.Utilities.v3.5 的依赖项。你知道我怎样才能获得那个dll吗？我的意思是我应该下载和安装什么才能获得那个 dll（安装 Visual Studio 不是一个选项）

* * *

## 回答 #1

> 赞同：31
> 
> 时间：2016-03-08T02:42:25.010

[我对Visual-StyleCop.MSBuild 版本 4.7.59.0](https://www.nuget.org/packages/Visual-StyleCop.MSBuild/)有类似的问题。

我通过导航到**控制面板-> 程序和功能-> 打开或关闭 Windows 功能**并安装了**.NET Framework 3.5（包括 .NET 2.0 和 3.0）来修复它**

* * *

## 回答 #2

> 赞同：10
> 
> 时间：2012-07-18T13:33:54.570

如果您的计算机上尚未明确安装 .NET v3.5 框架，请尝试下载并安装它。

[http://www.microsoft.com/en-us/download/details.aspx?id=21](http://www.microsoft.com/en-us/download/details.aspx?id=21)

* * *

## 回答 #3

> 赞同：4
> 
> 时间：2015-02-13T12:06:35.370

我知道这个问题已经有两年多了，但是这可能对其他人有用......

最近，我需要在 Windows 2012 R2 机器（内置 .Net 4.5）上设置 TeamCity Build Integration Server，但遇到了 StyleCop 4.7 问题。这是 StyleCop 4.7 具有的 .Net3.5 构建实用程序依赖项的一个已知问题。

取自[stylecop.codeplex.com](https://stylecop.codeplex.com/discussions/542139)

“我正在尝试让 stylecop 作为 msbuild 的一部分运行。我有一个服务器 2012 R2 服务器，用作构建服务器，其中构建的步骤之一是运行 stylecop。我安装了 Stylecop 4.7构建服务器，但不是 Visual Studio。执行构建步骤时，它抱怨 Stylecop.dll 的依赖项之一“microsoft.build.utilities.v3.5.dll”找不到，因此 stylecop 无法运行。

一旦我从另一台安装了 Visual Studio (2013) 的机器上复制了 microsoft.build.utilities.v3.5.dll 并将其放入 C:\Program Files\Stylecop 4.7 中，一切都很好。”

我从仅 Visual Studio 2010 的机器上复制了 dll，它解决了这个问题。

* * *

## 回答 #4

> 赞同：3
> 
> 时间：2016-10-14T02:25:57.660

我有一个类似的问题，解决方案是安装 .net framework v.3.5。

这在 Windows 上应该非常简单，只需访问打开或关闭 Windows 功能，然后检查 .NET Framework 3.5（包括 .NET 2.0 和 3.0）。

但是我在我的机器上打开这个功能有问题，因为检查后，资源下载总是返回错误。

搜索后，我在视频中找到了适用于我的案例的解决方案：

“如何在 Windows 10 中修复 .NET Framework 3.5 错误 0x800f081f”：[https ://www.youtube.com/watch?v=ZHQqb7IOHZE](https://www.youtube.com/watch?v=ZHQqb7IOHZE)

基本上，需要下载 .CAB 文件，将其移动到 C:\，然后在提示命令中运行命令。

.CAB 文件链接： [http ://www.mediafire.com/download/gaflwfg9tth889o/microsoft-windows-netfx3-ondemand-package.cab](http://www.mediafire.com/download/gaflwfg9tth889o/microsoft-windows-netfx3-ondemand-package.cab)

命令（需要以管理员身份打开命令提示符）：Dism.exe /online /enable-feature /featurename:NetFX3 /source:C:\ /LimitAccess

信息、链接和命令已从视频及其描述中提取。

# windows-installer - 高级安装程序启动操作

> ID：11542369
> 
> 赞同：3
> 
> 时间：2012-07-18T13:18:49.300
> 
> 标签：windows-installer, advanced-installer

我正在为小型 Windows 应用程序使用 Advanced Installer 专业版。

我想知道在执行安装程序并且产品已经安装（并且是最新的）时是否可以运行自定义操作？

通常，当您运行安装程序时，您要么收到“已安装另一个版本的产品”消息，要么没有任何反应。据我了解它是自动执行此操作的 MSI，但我希望有一些方法可以解决它，因为 Advanced Installer 可以将 MSI 包装在它自己的 exe 文件中。

如果它已经安装，我想做的是启动应用程序。我已经在正常安装完成后自动启动应用程序，但我希望安装程序在运行时始终启动应用程序。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-07-18T15:27:50.167

“已安装另一个版本的产品”消息仅在开发阶段出现，您的用户将永远不会看到此消息。更准确地说，当您安装了版本 1.0.0 的产品时，会出现此消息，而不是添加一个文件，重建 MSI 并尝试再次安装它，使用相同的版本 1.0.0。

在这种情况下，您有两个具有不同包代码但产品代码和版本相同的包，因此您会看到上述包。

您的用户永远不会有机会运行两个具有相同版本的不同软件包，因为他们可以访问官方版本，因此他们不会看到该消息。

他们将看到的实际上是维护对话框，即修改/修复/删除产品的选项。

要在每次他们再次启动 MSI 时启动您的应用程序，您可以在 InstallUISequence 的开头，在自定义操作页面中设置启动文件或打开 URL 预定义的自定义操作，设置为启动您的主可执行文件，执行条件设置为：

> 已安装

仅当应用程序已安装在计算机上时，此确切条件才会执行自定义操作。

但是，MSI 不会关闭，因此用户仍会看到维护对话框。

# .net - 添加服务引用时出错：类型是不支持的递归集合数据协定

> ID：11542371
> 
> 赞同：15
> 
> 时间：2012-07-18T13:18:51.993
> 
> 标签：.net, wcf, exception-handling, wsdl, service-reference

我尝试将服务引用添加到驻留在 ASP.NET MVC 4 项目的同一解决方案中的 WCF 服务，但失败了。我收到一条错误消息：

> 自定义工具错误：无法为服务引用“XXX”生成代码。有关详细信息，请查看其他错误和警告消息。根本警告是：
> 
> 警告 9 自定义工具警告：无法导入 wsdl:portType 详细信息：运行 WSDL 导入扩展时引发异常：System.ServiceModel.Description.DataContractSerializerMessageContractImporter 错误：类型“Newtonsoft.Json.Linq.JToken”是递归收集数据合同，它不支持。考虑修改集合“Newtonsoft.Json.Linq.JToken”的定义以删除对自身的引用。错误源的 XPath：//wsdl:definitions[@targetNamespace='http://tempuri.org/']/wsdl:portType[@name='IXXX'] C:\Projects...\Reference.svcmap 1 1 pqrt.web

如果我从服务合同中删除数据合同，它就起作用了。我还尝试将服务引用添加到其他项目，例如库项目甚至 ASP.NET MVC 3 项目，这一切都奏效了。我想知道这是否是 ASP.NET MVC 4 的问题？我使用的是 VS 2012 RC。

我能想到的一种解决方法是将服务引用添加到库项目，然后从 ASP.NET MVC 4 调用库项目，但我讨厌这样做，因为这是一个额外的步骤。有什么建议么？

* * *

## 回答 #1

> 赞同：14
> 
> 时间：2012-09-28T12:32:38.290

如果您想保留对 Newtonsoft.Json 的引用，您也可以将 Newtonsoft.Json 排除在程序集列表之外，以检查数据合同的重用。

为此：右键单击您的服务参考，然后单击配置服务参考...

在“在引用的程序集中重用类型”下，选择第二个选项以指定要在哪些程序集中搜索重用类型并选择所有程序集，但取消选中 Newtonsoft.Json

* * *

## 回答 #2

> 赞同：10
> 
> 时间：2012-09-06T15:33:31.763

尝试从您的引用中删除 Newtonsoft.Json 并重新添加您的服务引用。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2013-10-01T11:38:42.307

当我试图返回 a`JObject`作为端点结果时，我在编译时遇到了这个错误。

我通过使端点返回`object`并使用这种代码来解决它：

```
[WebGet(UriTemplate = "SomeRequest?form_request={form_request}", ResponseFormat = WebMessageFormat.Json)]
public object SomeRequest(string form_request)
{
    dynamic result = new JObject();
    // some other code
    result.status = "success";
    return JsonConvert.SerializeObject(result);
} 
```

jQuery 通过 jsonp 使用服务，`$.getJSON('<?>.svc/SomeRequest', 'form_request=' + webform_as_json, request_callback);`然后解压缩序列化对象，如下所示：

```
function request_callback(response) {
    var json = $.parseJSON(response);
    if (json.status == 'success') { 
```

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2012-07-18T16:48:36.480

您真的要返回任意深度树中的节点吗？

如果是这样，那么不要返回 JToken，而是先将其转换为字符串以获取 JSon 文本。在客户端，您可以`Jtoken.Parse(yourstring)`返回 JToken。

如果不是，则考虑传回`Value<T>`并让序列化处理 T。

# c# - 通过 ReSharper 将班级移动到其他班级

> ID：11542385
> 
> 赞同：4
> 
> 时间：2012-07-18T13:19:21.190
> 
> 标签：c#, resharper, resharper-5.1

我有一个**非嵌套**类`WillBeNestedClass`和另一个类`NestBox`。
现在我想将类作为嵌套类移动`WillBeNestedClass`到类中。`NestBox`所以`WillBeNestedClass`会嵌套在 class 中`NestBox`。

VS 或 ReSharper 中是否有重构可以进行移动并自动更新对嵌套类的所有引用（从`WillBeNestedClass`to `NestBox.WillBeNestedClass`）？

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-07-18T13:40:46.593

据我所知，默认情况下 ReSharper 中没有这样的快速操作或重构。也许有一些插件允许这样做 - 或者您可以尝试创建自己的插件。我相信它会受到更多开发人员的赞赏。

开箱即用的有：

*   移到文件夹
*   移动到命名空间
*   移动到单独的文件

我确实像您一样尝试使用 Move to namespace 并输入一个类型，但那只狗不会飞。

# sql - SQL INSERT 使用 WHILE LOOP 和 SELECT

> ID：11542387
> 
> 赞同：0
> 
> 时间：2012-07-18T13:19:25.277
> 
> 标签：sql, sql-server, select, insert, while-loop

需要将一堆重复的记录添加到数据库中，不想全部手动完成。

需要手动添加初始记录，然后想创建一个查询，我可以运行基本上模板其余记录，然后手动更改一个不同的字段。

问题是，在我输入它们之前，我并不确切知道初始记录是什么。

例如

```
 FieldOne | FieldTwo   | FieldThree
----------+------------+--------------
 Text One | Text Two A | int Three A
 Text One | Text Two B | int Three A
 Text One | Text Two C | int Three A
 ... 
```

这一切都必须手工完成。然后我需要创建：

```
 FieldOne | FieldTwo   | FieldThree
----------+------------+--------------
 Text One | Text Two A | int Three B
 Text One | Text Two B | int Three B
 Text One | Text Two C | int Three B
 ... 
```

...对字段二中的所有不同值重复。

希望这有意义吗？

基本上我想做的是：

```
WHILE (SELECT ALL DISTINCT VALUES FIELDTWO)
BEGIN
INSERT INTO TABLE VALUES ('Same all the time', Value From the FieldTwo Select, 'Same all the time')
END 
```

这可以在 SQL Server 中完成吗？你能给我确切的 T-SQL 语句吗？

* * *

## 回答 #1

> 赞同：9
> 
> 时间：2012-07-18T13:27:03.947

你应该能够做到这一点：

```
INSERT INTO TABLE1 (fieldtwo, fieldone, fieldthree)
SELECT DISTINCT fieldtwo, 'Same all the time',  'Same all the time' From TABLE2 
```

# regex - 允许在正则表达式中使用简单引号和双引号

> ID：11542390
> 
> 赞同：2
> 
> 时间：2012-07-18T13:19:39.630
> 
> 标签：regex

我有这个正则表达式`/src='cid:(.*)'/Uims`，它工作正常，但只匹配单引号中的元素。什么方法也允许匹配双引号（如`/src="cid:(.*)"/Uims`）但在单个正则表达式中的结果？

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-07-18T13:23:16.143

```
/src=(["'])cid:(.*?)\1/Uims 
```

将引用类型存储为反向引用，并在应该关闭的地方引用它。
请注意，您使用的反向引用将位于 \2（或 $2）而不是 \1。

哦，你可能想让分组变得懒惰（非贪婪），所以我添加了一个`?`after `.*`。有关更多信息，请参阅[正则表达式](http://www.regular-expressions.info/repeat.html#lazy).info。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-07-18T13:23:16.980

尝试

```
...'\''... 
```

在每次出现单引号时。

# android - 无法在 android 中的 facebook 在墙上发布/注销

> ID：11542392
> 
> 赞同：0
> 
> 时间：2012-07-18T13:19:42.010
> 
> 标签：android, facebook

在官方的 facebook 开发人员教程中，他们说在 facebook 上的用户 Wall 中发布就像写这行一样简单：

```
mFacebook.dialog(context, "feed", new PostDialogListener()); 
```

但是当我尝试使用它时，它一直要求我创建 PostDialogListener 类。这不是包含在 facebook sdk 中吗？我在哪里可以找到这门课？

而且，要注销，我必须使用这个：

```
mAsyncRunner.logout(getContext(), new RequestListener() {
@Override
public void onComplete(String response, Object state) {}

@Override
public void onIOException(IOException e, Object state) {}

@Override
public void onFileNotFoundException(FileNotFoundException e,
    Object state) {}

@Override
public void onMalformedURLException(MalformedURLException e,
    Object state) {}

@Override
public void onFacebookError(FacebookError e, Object state) {}
}); 
```

然后我被要求创建 getContext() 方法。

Facebook的教程很不完整，我现在该怎么办？谢谢！

编辑：我的 facebook 活动非常简单，我只是连接并从用户那里检索数据，然后将其传递给另一个活动。我想实现一个注销方法，并要求用户在登录后在墙上发帖（那将在另一个活动中）

```
public class FacebookConnectActivity extends Activity {
private static final String TAG_JSON = "json";
Facebook facebook = new Facebook("12121212112");
AsyncFacebookRunner mAsyncRunner;
private SharedPreferences mPrefs;
JSONObject json;

@Override
protected void onCreate(Bundle savedInstanceState) {
    super.onCreate(savedInstanceState);
    setContentView(R.layout.resgatar_produto_layout);

    mPrefs = getPreferences(MODE_PRIVATE);
    String access_token = mPrefs.getString("access_token", null);
    long expires = mPrefs.getLong("access_expires", 0);
    if(access_token != null) {
        facebook.setAccessToken(access_token);
    }
    if(expires != 0) {
        facebook.setAccessExpires(expires);
    }

    if(!facebook.isSessionValid()) {

    facebook.authorize(this, new String[] {"email", "user_birthday",     "publish_actions"}, new DialogListener() {
        @Override
        public void onComplete(Bundle values) {}

        @Override
        public void onFacebookError(FacebookError error) {}

        @Override
        public void onError(DialogError e) {}

        @Override
        public void onCancel() {}   
    });

    }

}

public void logoutFB(){

}

@Override
public void onActivityResult(int requestCode, int resultCode, Intent data) {
    super.onActivityResult(requestCode, resultCode, data);
    facebook.authorizeCallback(requestCode, resultCode, data);
    try{
        json = Util.parseJson(facebook.request("me"));
        Log.e("FacebookConnect", "JSON " + json.toString());
    }catch (JSONException e) {
        Log.e("FacebookConnect", "JSONException " + e.toString());
    }catch(FacebookError fbe){
        Log.e("FacebookConnect", "FacebookError " + fbe.toString());
    }catch (Exception e){
        Log.e("FacebookConnect", "Exception " + e.toString());
    }

    Intent a = new Intent(FacebookConnectActivity.this, FacebookDataProcess.class);
    a.putExtra(TAG_JSON, json.toString());
    startActivity(a);
    finish();
}   
} 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-07-18T19:53:20.020

我想我刚刚得到了一些有用的东西：

在 FacebookConnectActivity 中：

```
public static  void logoutFB(){
    if(facebook.isSessionValid()){
        facebook.setAccessToken(null);
    }
} 
```

此方法在 logoutbutton.onclick 中调用，如下所示：

```
FacebookConnectActivity.logoutFB(); 
```

也许它可以帮助某人。

# c# - 如何选择出现次数最多的字典值

> ID：11542395
> 
> 赞同：0
> 
> 时间：2012-07-18T13:19:59.973
> 
> 标签：c#, linq

```
Dictionary<objectx,objecty> d. 
```

我想使用 LINQ 选择在“d”中出现次数最多的对象 y。

```
d.GroupBy(t => t.Value) 
```

给了我结果，我无法从中获取值。

谢谢

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-07-18T13:26:55.857

```
objecty maxOccurenceValue = d.GroupBy(kv => kv.Value)
                     .OrderByDescending(g => g.Count())
                     .First().Key; 
```

请注意，您的对象需要覆盖`Equals`和`GetHashCode`/或实现[`IEqualityComparer<T>`](http://msdn.microsoft.com/en-us/library/ms132151.aspx).

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-07-18T13:24:21.233

你已经成功了。现在您已经有了这些组，您可以使用[MoreLinq](http://code.google.com/p/morelinq/wiki/OperatorsOverview)`MaxBy`中的方法来识别具有最高计数的值。

```
var highestFrequencyValue = d
    .GroupBy(t => t.Value)
    .MaxBy(g => g.Count())
    .Key; 
```

[MaxBy](http://code.google.com/p/morelinq/source/browse/MoreLinq/MaxBy.cs)的实现让您深入了解如何自己实现这一点（确保承认版权/许可）。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-07-18T14:03:24.500

```
List<Order> orders=new List<Order>
            {new Order(){State="cali",ID=1},
            new Order(){State="cali",ID=2},
            new Order(){State="nali",ID=3},
            new Order(){State="pali",ID=4},
            new Order(){State="pali",ID=5},
            new Order(){State="cali",ID=3},
        };
        List<Order> gr=null;
        orders.GroupBy(g => g.State).ToList().ForEach(d=>
        {
            if(gr==null)
                gr = d.ToList<Order>();
            else if (gr.Count() < d.Count())
                gr = d.ToList<Order>();

        });
        return gr; 
```

是的，您可以使用 OrderBy 来做到这一点，但如果 List 中有很多元素，我认为 OrderBy 是重型扩展功能。我希望这会有所帮助。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2012-07-18T13:53:47.237

或者，如果您真的只关心哪个发生最多（而不是他们拥有哪些键），请忽略它是 a`Dictionary`并仅对`Value`.

```
Dictionary<string, int> dict = new Dictionary<string, int>
{
    {"hi", 3},
    {"there", 3},
    {"you", 4},
    {"have", 5},
    {"a", 5},
    {"nice", 5},
    {"hat", 5},
    {"and", 6}, 
    {"shoes", 6},
};

var result = dict
    .Select(d => d.Value)
    .GroupBy(k => k)
    .OrderByDescending(k => k.Count())
    .First()
    .Key;

Console.WriteLine(result);

// 5 
```

**编辑**：我喜欢不使用第二个转换。谢谢，@蒂姆。更改了我的并删除了对不再在他的帖子中的内容的引用。

# windows-phone-7.1 - windows phone 7点击图片时如何模糊背景屏幕？

> ID：11542396
> 
> 赞同：0
> 
> 时间：2012-07-18T13:19:59.940
> 
> 标签：windows-phone-7.1

当单击显示大尺寸图像的页面时，在页面中存在小图像图标。然后我需要模糊屏幕的背景，直到他单击十字图标。我将背景控件放在网格中。请告诉我...

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-07-18T13:30:04.247

如果我理解你，我不确定，但我猜你想创建一个灯箱之类的东西。我猜 XNA 中没有内置功能可以模糊某些东西（比如整个屏幕），但是您可以尝试在整个屏幕上放置一个半透明图像（例如，不透明度为 50% 的全黑 .png 图像）并放置您想要的内容在此之上。

# maven - Maven 中的属性

> ID：11542402
> 
> 赞同：0
> 
> 时间：2012-07-18T13:20:30.540
> 
> 标签：maven

我想创建这种属性：

```
<properties> 
  <ignoredpackage>
     <ignore>com.example.*</ignore>
     <ignore>com.another.example.*</ignore> 
  </ignoredpackage>
<properties> 
```

这样我就可以像这样在我的 pom 中使用它：

```
<plugin>
    <groupId>org.codehaus.mojo</groupId>
    <artifactId>cobertura-maven-plugin</artifactId>
    <configuration>
      <instrumentation>
        <ignores>
          ${ignoredpackage}
        </ignores>
        <excludes>
        ... 
```

但这不起作用，还有其他方法吗？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-07-18T13:24:32.467

你不能这样做。

`<properties/>`标签只能这样工作：

```
<properties>
    <foo>bar</foo>
    <blah>dotfoo</blah>
</properties> 
```

# visual-studio-2010 - 添加对来自不同团队项目的文件的引用

> ID：11542405
> 
> 赞同：0
> 
> 时间：2012-07-18T13:20:36.120
> 
> 标签：visual-studio-2010, tfs

我在 Visual Studio 中有 2 个团队项目，它们之间有一些共享代码。

是否可以从一个团队项目到另一个团队项目有参考或某种链接？

请注意，1 个团队项目可能映射到一个文件夹，而另一个映射到另一个文件夹，它们都没有共享路径，因此制作相对链接不会切断它。谢谢！

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-07-18T14:49:19.220

要共享二进制文件，请将 Team Project 1 输出添加到 Team Project 2 Lib/3rd Party 文件夹。

**团队项目 1**

```
$/Project1/Dev/3rdParty/Project2/SomeProduct.Common.dll 
```

**团队项目 2**

```
$/Project2/Dev/SomeProduct/SomeProduct.Common/ <-- sources here 
```

如果您希望共享代码，那么我建议您重新考虑您的源代码控制策略，因为您将面临以下两个问题之一：

1.  管理重复的源代码
2.  在不同项目之间同步相同的代码

无论哪种方式都不会导致任何可管理的事情。而是将您的精力投入到二进制共享上。

# asp.net - 将数据库中的结果拆分为 10 个“块”

> ID：11542406
> 
> 赞同：2
> 
> 时间：2012-07-18T13:20:37.080
> 
> 标签：asp.net, linq, amazon-mws

下午，

我需要一只手将 1200 多个结果分成 10 个“块”，以便我可以使用亚马逊 MWS API 处理这些结果。任何人都可以就我将如何做这件事提供任何指导吗？

```
 List<string> prodASIN = dc.aboProducts.Select(a => a.asin).Take(10).ToList(); 
```

我目前有这个，它有效。但我有 1200 多个结果，需要遍历每 10 个结果，以便我可以处理它们并将它们传递给亚马逊 MWS API

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-07-21T21:00:51.783

我知道这个问题已经得到解答，但我不能拒绝你这个我曾经做过 [的小扩展方法，从那以后它对我很有帮助。](https://stackoverflow.com/a/6852288/861716)

你可以做：

```
foreach(var list in prodASINs.ToChunks(10))
{
    // send list
} 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-07-18T13:23:40.050

为什么不尝试类似的东西：

```
//Load all the database entries into Memory
List<string> prodASINs = dc.aboProducts.Select(a => a.asin).ToList();
var count = prodASINs.Count();
//Loop through passing 10 at a time to AWS
for (var i = 0; i < count; i++)
{
    var prodASINToSend = prodASINs.Skip(i * 10).Take(10).ToList(); 
    //Send to AWS
} 
```

或者，如果您不想将它们全部加载到内存中。

```
var count = dc.aboProducts.Count();
for (var i = 0; i < count; i++)
{
    List<string> prodASIN = dc.aboProducts.OrderBy(a => a.Id).Select(a => a.asin).Skip(i * 10).Take(10).ToList(); 
    //Send to AWS
} 
```

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-07-18T13:32:19.890

抱歉，这不是 LINQ 特定的，但也许它会有所帮助......

在使用 MWS 和 ERP 软件处理数据时，我所做的一件事是在数据库中添加一个控制列，例如“addASIN”。在数据库中，我将控制列定义为布尔值（或 TINYINT(1) MySQL ) 并将所有新条目的标志默认为 0，并在添加条目时将其设置为 1。

如果你能够做到这一点，那么你可以做类似的事情

```
SELECT asin FROM datasource WHERE addedASIN = 0 LIMIT 10; 
```

然后，一旦 MWS 返回成功添加，使用更新标志

```
UPDATE datasource SET addedASIN = 1 WHERE asin = 'asinnumber'; 
```

我发现这样做的好处是您的数据库将能够停止并以最少的数据重复开始 - 例如在我的情况下（以及启动此控制列的原因）我们的网络连接可能不稳定，所以我在订单导入我会失去连接，导致订单丢失，或者订单被上传到我们的系统两次。

由于连接丢失，该解决方案最多可以添加 1 个订单，并且为了将该订单上传两次，在将数据发送到我们的 ERP 系统、我们的 ERP 系统之间需要丢失连接确认已添加并更新数据库，往返大约需要 30 秒。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2012-07-18T13:34:16.670

切片扩展（用于数组）：

```
 public static T[] Slice<T>(this T[] source, int index, int length)
    {
        T[] slice = new T[length];
        Array.Copy(source, index, slice, 0, length);
        return slice;
    } 
```

Array.Copy 非常快，比 Select/Skip/Take 模式快很多。虽然这种方法不是我发现的禁食方法，但最近的测试表明它比用于拆分列表和数组的 Skip/Take 模式快了近 400 倍。

按原样使用它：

```
const int arraySize = 10;
List<string> listSource = whatever;
string[] source = listSource.ToArray();

for (int i = 0; i < source.Length; i += arraySize)
{
    List<string> buffer = source.Slice(i, arraySize).ToList();
    DoSomething(buffer);
} 
```

* * *

## 回答 #5

> 赞同：-1
> 
> 时间：2012-07-22T13:50:48.177

`List<T>`有一个名为的内置函数`GetRange()`，它是专门为你想要做的事情而制作的。它非常快，不需要 Linq、casting 等......

```
List<string> prodASINs = dc.aboProducts.Select(a => a.asin).ToList(); 

for(int i = 0; i < prodASINs.Count; i += 10)
{

    List<string> buffer = prodASINs.GetRange(i, 10);
    // do something with buffer
} 
```

而已。很简单。

* * *

测试结果：`GetRange`vs. `Slice`vs. `Linq`with 5000 strings`List<string>` 可以清楚地看到，使用 Linq 的 Skip/Take 方法比 383 倍`Slice<T>()`和 4736 倍`GetRange()`

==================================================== =================================

```
GetRange took on average 168 ticks
Slice took on average 2073 ticks
Linq took on average 795643 ticks 
```

使用的测试方法（自己试试）：

```
private static void GetRangeVsSliceVsLinq()
{
    List<string> stringList = new List<string>();
    for (int i = 0; i < 5000; i++)
    {
        stringList.Add("This is a test string " + i.ToString());
    }

    Stopwatch sw = new Stopwatch();

    long m1 = 0, m2 = 0, m3 = 0;

    for (int x = 0; x < 10; x++)
    {
        Console.WriteLine("Iteration {0}", x + 1);
        Console.WriteLine();

        sw.Reset();
        sw.Start();

        for (int i = 0; i < stringList.Count; i += 10)
        {
            List<string> buffer = stringList.GetRange(i, 10);
        }
        sw.Stop();
        Console.WriteLine("GetRange took {0} msecs", sw.ElapsedMilliseconds);
        Console.WriteLine("GetRange took {0} ticks", sw.ElapsedTicks);
        m1 += sw.ElapsedTicks;

        sw.Reset();
        sw.Start();

        string[] sliceArray = stringList.ToArray();
        for (int i = 0; i < sliceArray.Length; i += 10)
        {
            List<string> buffer = sliceArray.Slice(i, 10).ToList();
        }
        sw.Stop();
        Console.WriteLine("Slice took {0} msecs", sw.ElapsedMilliseconds);
        Console.WriteLine("Slice took {0} ticks", sw.ElapsedTicks);
        m2 += sw.ElapsedTicks;

        sw.Reset();
        sw.Start();

        var count = stringList.Count();
        for (var i = 0; i < count; i++)
        {
            var buffer = stringList.Skip(i * 10).Take(10).ToList();
        }

        sw.Stop();
        Console.WriteLine("Skip/Take took {0} msecs", sw.ElapsedMilliseconds);
        Console.WriteLine("Skip/Take took {0} ticks", sw.ElapsedTicks);
        m3 += sw.ElapsedTicks;

        Console.WriteLine();
    }

    Console.WriteLine();
    Console.WriteLine("GetRange took on average {0} ticks", m1 / 10);
    Console.WriteLine("Slice took on average {0} ticks", m2 / 10);
    Console.WriteLine("Linq took on average {0} ticks", m3 / 10);

} 
```

# c# - 每个请求的上下文：如何更新实体

> ID：11542413
> 
> 赞同：1
> 
> 时间：2012-07-18T13:21:09.933
> 
> 标签：c#, .net, entity-framework, design-patterns, domain-driven-design

我有一个存储库类，如下所示。有一个获取实体对象的方法——GetPaymentByID。我正在检索一个 Payment 对象并对它的 PaymentType 属性进行更改。但这并没有反映在数据库中。我知道原因——SaveContextChanges 方法使用了一个新的上下文。

我需要使用**每个请求的上下文**方法。因此，我在每种方法中都创建了新的上下文。

在这种情况下，如何修改代码才能成功更新数据库？

注意：客户端程序不应使用 ObjectContext，因为**可以使用不使用 Entity Framework 的另一个存储库来更改存储库**。

**注意**：“ *DataContext 是轻量级的，创建起来并不昂贵*”

```
namespace MyRepository
{

public class MyPaymentRepository
{
    private string connectionStringVal;
    public MyPaymentRepository()
    {
        SqlConnectionStringBuilder sqlBuilder = new SqlConnectionStringBuilder();
        sqlBuilder.DataSource = ".";
        sqlBuilder.InitialCatalog = "LibraryReservationSystem";
        sqlBuilder.IntegratedSecurity = true;

        // Initialize the EntityConnectionStringBuilder.
        EntityConnectionStringBuilder entityBuilder = new EntityConnectionStringBuilder();
        entityBuilder.Provider = "System.Data.SqlClient";
        entityBuilder.ProviderConnectionString = sqlBuilder.ToString();
        entityBuilder.Metadata = @"res://*/MyEDMtest.csdl|res://*/MyEDMtest.ssdl|res://*/MyEDMtest.msl";

        connectionStringVal = entityBuilder.ToString();
    }

    public MyEntityDataModelEDM.Payment GetPaymentByID(int paymentID)
    {
        MyEntityDataModelEDM.Payment payment;
        using (var myObjectContext2 = new MyEntityDataModelEDM.LibraryReservationSystemEntities(connectionStringVal))
        {

            Func<MyEntityDataModelEDM.Payment, bool> predicate = (p => p.PaymentID == paymentID);
            payment = myObjectContext2.Payments.SingleOrDefault(predicate);
        }
        return payment;
    }

    public void SaveContextChanges(MyEntityDataModelEDM.Payment paymentEntity)
    {
        using (var myObjectContext = new MyEntityDataModelEDM.LibraryReservationSystemEntities(connectionStringVal))
        {
            myObjectContext.SaveChanges();
        }
    }

}

} 
```

客户

```
 MyRepository.MyPaymentRepository rep = new MyRepository.MyPaymentRepository();

        MyEntityDataModelEDM.Payment p2= rep.GetPaymentByID(1);
        p2.PaymentType = "TeSSS";
        rep.SaveContextChanges(p2); 
```

**阅读**

1.  添加/附加和实体状态：http: [//blogs.msdn.com/b/adonet/archive/2011/01/29/using-dbcontext-in-ef-feature-ctp5-part-4-add-attach-and -实体状态.aspx](http://blogs.msdn.com/b/adonet/archive/2011/01/29/using-dbcontext-in-ef-feature-ctp5-part-4-add-attach-and-entity-states.aspx)

2.  [初始化实体框架上下文的最佳方法？](https://stackoverflow.com/questions/1063730/best-way-to-initialize-an-entity-framework-context)

3.  [Entity Framework 4.1：如何使用每次调用生命周期数据上下文？](https://stackoverflow.com/questions/10164949/entity-framework-4-1-how-to-work-with-per-call-life-time-data-context)

4.  [在 EF4.1 中正确地从上下文中附加和分离实体](https://stackoverflow.com/questions/7678665/attaching-and-detaching-entities-from-context-correctly-in-ef4-1)

5.  [存储库和工作单元模式中的上下文生命周期管理](https://stackoverflow.com/questions/7457275/context-lifetime-management-in-repository-and-unit-of-work-pattern)

6.  [实体框架多对象上下文](https://stackoverflow.com/questions/5693843/entity-framework-multiple-object-contexts)

7.  [EF4 - Context.Entry 不可用于更改实体状态](https://stackoverflow.com/questions/9398977/ef4-context-entry-isnt-available-to-change-an-entity-state)

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-07-18T13:30:00.383

您需要将对象添加（如果数据是新的）或附加（如果数据被编辑）到上下文中：

[http://blogs.msdn.com/b/adonet/archive/2011/01/29/using-dbcontext-in-ef-feature-ctp5-part-4-add-attach-and-entity-states.aspx](http://blogs.msdn.com/b/adonet/archive/2011/01/29/using-dbcontext-in-ef-feature-ctp5-part-4-add-attach-and-entity-states.aspx)

这些方面的东西：

```
public void SaveContextChanges(MyEntityDataModelEDM.Payment paymentEntity)
{
    using (var myObjectContext = new MyEntityDataModelEDM.LibraryReservationSystemEntities(connectionStringVal))
    {
        // use your own logic for determining a "new" entity
        myObjectContext.Entry(paymentEntity).State = 
                (paymentEntity.PaymentID == default(int)) ?  
                               EntityState.Added :
                               EntityState.Modified;

        myObjectContext.SaveChanges();
    }
} 
```

# java - 自创 JToggleButton：更改图标

> ID：11542414
> 
> 赞同：1
> 
> 时间：2012-07-18T13:21:24.970
> 
> 标签：java, swing, icons, jtogglebutton

我编写了一个扩展 JToggleButton 的类。

一切正常，除了我无法更改按钮的图标。

这是我的课程代码：

```
package be.blauweregen.lichtsturing;

import javax.swing.*;
import java.awt.*;

class MyToggleButton extends JToggleButton {
    private static final long serialVersionUID = 1L;
    String s;

    public MyToggleButton(String str) {
        super(str);
        s = str;
    }

    public MyToggleButton(String str, Boolean sel) {
        super(str, sel);
        s = str;
    }

    public void paintComponent(Graphics g) {
        super.paintComponent(g);
        if (this.isSelected() && this.isEnabled()) { // manueel en aan
            int w = getWidth();
            int h = getHeight();
            g.setColor(Color.green); // selected color
            g.fillRect(0, 0, w, h);
            g.setColor(Color.black); // selected foreground color
            g.drawString(s, (w - g.getFontMetrics().stringWidth(s)) / 2 + 1,
                    (h + g.getFontMetrics().getAscent()) / 2 - 1);
            setFont(new Font("Tahoma", Font.BOLD, 11));
        } else if (this.isSelected() && !this.isEnabled()) { // automatisch en
                                                                // aan
            int w = getWidth();
            int h = getHeight();

            g.setColor(Color.green); // selected color
            g.fillRect(0, 0, w, h);
            g.setColor(Color.black); // selected foreground color
            g.drawString(s, (w - g.getFontMetrics().stringWidth(s)) / 2 + 1,
                    (h + g.getFontMetrics().getAscent()) / 2 - 1);
            setFont(new Font("Tahoma", Font.PLAIN, 11));
        } else if (!this.isSelected() && this.isEnabled()) { // manueel en uit
            int w = getWidth();
            int h = getHeight();
            g.setColor(Color.red); // selected color
            g.fillRect(0, 0, w, h);
            g.setColor(Color.black); // selected foreground color
            g.drawString(s, (w - g.getFontMetrics().stringWidth(s)) / 2 + 1,
                    (h + g.getFontMetrics().getAscent()) / 2 - 1);
            setFont(new Font("Tahoma", Font.BOLD, 11));
        } else if (!this.isSelected() && !this.isEnabled()) { // automatisch en
                                                                // uit
            int w = getWidth();
            int h = getHeight();
            g.setColor(Color.red); // selected color
            g.fillRect(0, 0, w, h);
            g.setColor(Color.black); // selected foreground color
            g.drawString(s, (w - g.getFontMetrics().stringWidth(s)) / 2 + 1,
                    (h + g.getFontMetrics().getAscent()) / 2 - 1);
            setFont(new Font("Tahoma", Font.PLAIN, 11));
        }

    }
} 
```

我在我的程序中以这种方式使用代码：

```
btnGangSanitair = new MyToggleButton("Gang sanitair");
btnGangSanitair.setSelectedIcon(new ImageIcon("Z:\\Development\\Java\\BlauweRegen\\famfamfam_silk_icons_v013\\icons\\application_edit.png"));
btnGangSanitair.setIcon(new ImageIcon(Client.class.getResource("/be.blauweregen.icons/arrow_refresh.png"))); 
```

我究竟做错了什么？

图标不会出现在程序中。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-07-18T14:19:48.197

1.  不要`ImageIcon`在运行时重新创建和重新加载 s，将所有`ImageIcon`s 作为局部变量加载一次且仅一次，

2.  使用`setBackground()`代替`paintComponent()`

3.  为 JToggleButton使用[正确的 setXxxIcon 方法](https://stackoverflow.com/a/9369476/714968)

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-07-18T14:50:06.830

除了 mKorbel 的评论之外，您所有精彩的自定义绘画都超过了 super 调用所做的绘画，因此在您的图标上绘画

# string - 简单的字符串压缩和比较

> ID：11542421
> 
> 赞同：1
> 
> 时间：2012-07-18T13:22:20.693
> 
> 标签：string, perl, recursion, compression

我正在尝试比较两个字符串，作为输出，我想要一个连续相同字符的计数，如果字符不同，则只是第二个字符串中的字符。我有一个有效的递归实现，但我不知道如何将连续计数加在一起

代码：

```
use strict;
use warnings;
use Data::Dumper;
$Data::Dumper::Indent = 0;
$Data::Dumper::Terse  = 1;

my $str1 = "aaaaaaaaaaaabbbbbbbbbbbccccccccdddddddddddeeeefffffff";
my $str2 = "aaaaaaaaaaaabbbbbbbbbbbccccccccxxxxxxxddxxeeeefffffff";

sub find_diff {
    my ( $a, $b ) = @_;
    my @rtn = ();
    my $len = length $a;
    my $div = $len / 2;
    if ( $div < 1 ) {
        return $b;
    }
    my $a_1 = substr $a, 0, $div;
    my $b_1 = substr $b, 0, $div;
    if ($a_1 eq $b_1) {
         push @rtn, length $a_1;
    }
    else {
        push @rtn, find_diff( $a_1, $b_1 );
    }
    my $a_2 = substr $a, $div;
    my $b_2 = substr $b, $div;
    if ($a_2 eq $b_2) {
        push @rtn, length $a_2;
    }
    else {
        push @rtn, find_diff( $a_2, $b_2 );
    }
    return @rtn;
}

print Data::Dumper::Dumper( [ find_diff('xaabbb', 'aaabbc' ) ] ) . "\n";
print Data::Dumper::Dumper( [ find_diff('aaabbb', 'aaabbc' ) ] ) . "\n";
print Data::Dumper::Dumper( [ find_diff( $str1, $str2 ) ] ) . "\n"; 
```

输出：

```
['a',2,1,1,'c']
[3,1,1,'c']
[26,3,1,1,'x','x','x','x','x','x','x',1,1,'x','x',4,7] 
```

期望的输出：

```
['a',4,'c']
[5,'c']
[31,'x','x','x','x','x','x','x',2,'x','x',11] 
```

当然，我可以将字符拆分为一个数组，`unpack`然后相当容易地计算连续匹配，但我想尝试一种分而治之的方法，以便比较性能。

谢谢！

编辑——在递归情况下，通过返回一个嵌套数组然后减少来解决它。令人惊讶的是，它并没有那么慢：

```
sub find_diff {
    my ( $a, $b ) = @_;
    my @rtn = ();
    my $len = length $a;
    if ( $len < 2 ) {
        return [$b, 0];
    }
    my $div = $len / 2;
    my $a_1 = substr $a, 0, $div;
    my $b_1 = substr $b, 0, $div;
    if ($a_1 eq $b_1) {
        push @rtn, [length $a_1, 1];
    }
    else {
        push @rtn, find_diff( $a_1, $b_1 );
    }
    my $a_2 = substr $a, $div;
    my $b_2 = substr $b, $div;
    if ($a_2 eq $b_2) {
        push @rtn, [length $a_2, 1];
    }
    else {
        push @rtn, find_diff( $a_2, $b_2 );
    }
    return @rtn;
}
sub compress_string {
    my ($a, $b) = @_;
    my @list = find_diff($a, $b);
    my $acc = 0;
    my @result = ();
    foreach my $item (@list) {
        if ( $item->[1] ) {
            $acc += $item->[0];
        } else {
            push @result, if $acc;
            push @result, $item->[0];
            $acc = 0;
        }
    }
    push @result, $acc if $acc;
    return @result;
} 
```

结果符合我想要的。

**更新 - 性能统计**

这真的很有趣。使用`unpack( 'C*', $string)`速度非常快，我认为这就是为什么我的迭代版本如此之快。递归的速度优势来自更长的字符串（434 个字符）

```
 Rate short_recurse_borodin short_recurse short_array_borodin short_array_sodved short_array
short_recurse_borodin  6944/s                    --          -31%                -36%               -73%        -84%
short_recurse         10091/s                   45%            --                 -8%               -61%        -76%
short_array_borodin   10929/s                   57%            8%                  --               -57%        -74%
short_array_sodved    25707/s                  270%          155%                135%                 --        -40%
short_array           42553/s                  513%          322%                289%                66%          --
                      Rate mid_array_borodin mid_recurse_borodin mid_string mid_array_sodved mid_array
mid_array_borodin   1418/s                --                -28%       -56%             -65%      -82%
mid_recurse_borodin 1972/s               39%                  --       -39%             -52%      -76%
mid_recurse         3226/s              127%                 64%         --             -21%      -60%
mid_array_sodved    4082/s              188%                107%        27%               --      -49%
mid_array           8065/s              469%                309%       150%              98%        --
                       Rate long_array_borodin long_array_sodved long_recurse_borodin long_array long_string
long_array_borodin    172/s                 --              -67%                 -80%       -85%        -89%
long_array_sodved     513/s               199%                --                 -40%       -55%        -67%
long_recurse_borodin  854/s               397%               66%                   --       -25%        -45%
long_array           1142/s               564%              122%                  34%         --        -26%
long_recurse         1546/s               800%              201%                  81%        35%          -- 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-07-18T16:20:00.247

编辑：哎呀，对不起。刚刚看到您评论想要使用递归和拆分字符串。所以我的回答不太合适，对此感到抱歉。无论如何我都会离开它。

我认为你不需要递归。以下作品

```
use Data::Dumper;

sub find_diff($$)
{
    my( $a, $b ) = @_;
    my @res;
    my @a = split( '', $a );
    my @b = split( '', $b );
    # Assume a and b are the same length
    my $mcount = 0;
    for( my $i = 0; $i < scalar(@a); $i++ )
    {
        if( $a[$i] eq $b[$i] )
        {
            $mcount++;
        }
        else
        {
            if( $mcount )
            {
                push( @res, $mcount );
            }
            $mcount = 0;
            push( @res, $b[$i] );
        }
    }
    if( $mcount )
    {
        push( @res, $mcount );
    }
    return @res;
} # END find_diff

print Data::Dumper::Dumper( [ find_diff('xaabbb', 'aaabbc' ) ] ) . "\n";
print Data::Dumper::Dumper( [ find_diff('aaabbb', 'aaabbc' ) ] ) . "\n"; 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-07-18T16:38:57.107

尽管我有所保留，我还是更新了我的解决方案以展示递归方法。基准测试取决于您！请发布您的结果。

递归或*分而治之的方法*不适合这个问题。最后，必须比较每对字符并评估连续匹配字符的数量。无论您是一次执行所有这些操作，还是将字符串分成两部分，分别处理每一半，然后重新组合结果，都没有区别。事实上，由于拆分和组合中间结果所需的代码，递归解决方案*必然会*更慢。

应该通过将两个字符串拆分为单独的字符并比较两个序列中的每对字符来解决这个问题。

该解决方案似乎可以满足要求，并且还考虑了两个字符串长度不同的情况。

```
use strict;
use warnings;

use Data::Dump;

my $str1 = "aaaaaaaaaaaabbbbbbbbbbbccccccccdddddddddddeeeefffffff";
my $str2 = "aaaaaaaaaaaabbbbbbbbbbbccccccccxxxxxxxddxxeeeefffffff";

dd [ find_diff( 'xaabbb', 'aaabbc' ) ];
dd [ find_diff( 'aaabbb', 'aaabbc' ) ];
dd [ find_diff( $str1, $str2 ) ];
dd [ find_diff( 'xxx', 'xx' ) ];

sub find_diff {

  my @str1 = unpack '(A1)*', shift;
  my @str2 = unpack '(A1)*', shift;
  my @return;
  my $nmatch;

  while (@str1 or @str2) {
    my @pair = map $_ // '', ( shift(@str1), shift(@str2) );
    if ($pair[0] eq $pair[1]) {
      $nmatch++;
    }
    else {
      push @return, $nmatch if $nmatch;
      undef $nmatch;
      push @return, $pair[1];
    }
  }
  push @return, $nmatch if $nmatch;

  return @return;
} 
```

**输出**

```
["a", 4, "c"]
[5, "c"]
[31, "x", "x", "x", "x", "x", "x", "x", 2, "x", "x", 11]
[2, ""] 
```

**更新**

为了满足您对类似递归解决方案的要求，此子例程使用递归方法执行相同的操作。它产生相同的结果，只是如果提供一对具有不同长度的字符串进行比较，它就会死掉。

请注意，它依赖于完全非数字的原始字符串中的数据。如果不是这样，那么问题就会变得更加复杂。

**更新 2**

我已经修改`recursive_find_diff`为正确处理包含数字字符的字符串。它依赖于结果列表的成员都是单个字符，除非它们是匹配字符的计数。因此，我`+`在所有匹配计数之前添加了一个，以使它们始终比一个字符长并且易于区分。

我*相信*所有这些复杂性都会比简单的解决方案慢得多！

```
use strict;
use warnings;

use Data::Dump;

my $str1 = "aaaaaaaaaaaabbbbbbbbbbbccccccccdddddddddddeeeefffffff";
my $str2 = "aaaaaaaaaaaabbbbbbbbbbbccccccccxxxxxxxddxxeeeefffffff";

dd [ recursive_find_diff( 'xaabbb', 'aaabbc' ) ];
dd [ recursive_find_diff( 'aaabbb', 'aaabbc' ) ];
dd [ recursive_find_diff( $str1, $str2 ) ];
dd [ recursive_find_diff( '111222444888', '11122233488x' ) ];

sub recursive_find_diff {

  my ($str1, $str2) = @_;
  my $len = length $str1;

  die "Strings for comparison must be of equal lengths" unless length $str2 == $len;

  if ($str1 eq $str2) {
    return ( '+'.$len );
  }
  elsif ($len == 1) {
    return $str1 eq $str2 ? ( '+1' ) : ( $str2 );
  }
  else {
    my $half = int($len / 2);
    my @part1 = recursive_find_diff(substr($str1, 0, $half), substr($str2, 0, $half));
    my @part2 = recursive_find_diff(substr($str1, $half), substr($str2, $half));
    if (length $part1[-1] >1 and length $part2[0] > 1) {
      $part2[0] = '+'.($part2[0] + pop @part1);
    }
    return ( @part1, @part2 );
  }
} 
```

**输出**

```
["a", "+4", "c"]
["+5", "c"]
["+31", "x", "x", "x", "x", "x", "x", "x", "+2", "x", "x", "+11"]
["+6", 3, 3, "+3", "x"] 
```

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-07-19T15:53:22.497

多亏了 Borodin 和 Sodved，我改进了我的解决方案，使其速度非常快。由于我要比较的字符串是日志消息，除了更改值之外几乎相同，因此使用递归解决方案可以消除大量工作。

正如 Sodved 所提到的，在 C 语言中不会有类似的收益，因为我仍然需要进行逐个字符的比较。

它现在所做的是检查字符串的长度是否低于某个阈值，如果是，则回退到数组比较。

性能如下所示：

```
 Rate          long_recurse long_recurse_fallback
long_recurse          1613/s                    --                  -18%
long_recurse_fallback 1961/s                   22%                    -- 
```

这是我的最终代码（删除了测试字符串，它们是真正的日志消息）：

```
use strict;
use warnings;
use Data::Dumper;
use Benchmark qw(cmpthese);
$Data::Dumper::Indent = 0;
$Data::Dumper::Terse  = 1;

my $str1 = "aaaaaaaaaaaabbbbbbbbbbbccccccccdddddddddddeeeefffffff";
my $str2 = "aaaaaaaaaaaabbbbbbbbbbbccccccccxxxxxxxddxxeeeefffffff";

sub find_diff {
    my ( $a, $b, $minlen ) = @_;
    my $len = length $a;
    if ($len < $minlen) {
        return compress_unpack_ary( $a, $b );
    }
    if ( $len < 2 ) {
        return [ord($b), 0];
    }
    my @rtn = ();
    my $div = $len / 2;
    my $a_1 = substr $a, 0, $div;
    my $b_1 = substr $b, 0, $div;
    if ($a_1 eq $b_1) {
        push @rtn, [length $a_1, 1];
    }
    else {
        push @rtn, find_diff( $a_1, $b_1, $minlen );
    }
    my $a_2 = substr $a, $div;
    my $b_2 = substr $b, $div;
    if ($a_2 eq $b_2) {
        push @rtn, [length $a_2, 1];
    }
    else {
        push @rtn, find_diff( $a_2, $b_2, $minlen );
    }
    return @rtn;
}

sub compress_string {
    my ($a, $b, $minlen) = @_;
    my @list = find_diff($a, $b, $minlen);
    my $acc = 0;
    my @result = ();
    foreach my $item (@list) {
        if ( $item->[1] ) {
            $acc += $item->[0];
        } else {
            while ( $acc > 127 ) {
                push @result, 255;
                $acc -= 127;
            }
            push @result, $acc + 128 if $acc;
            push @result, $item->[0];
            $acc = 0;
        }
    }
    while ( $acc > 127 ) {
        push @result, 255;
        $acc -= 127;
    }
    push @result, $acc + 128 if $acc;
    return pack('C*', @result);
}
sub compress_unpack_ary {
    my ( $a, $b ) = @_;
    my @orig       = unpack('C*', $a);
    my @new        = unpack('C*', $b);
    my @nonmatches = ();
    my $count      = 0;
    my $repeats    = 0;
    while ( $count < scalar @new ) {
        if ( $orig[$count] and $new[$count] == $orig[$count] ) {
            $repeats++;
        }
        elsif ( $repeats == 1 ) {
            push @nonmatches, [ $new[$count - 1], 0], [$new[$count], 0];
            $repeats = 0;
        }
        elsif ( $repeats > 1 ) {
            push @nonmatches, [$repeats, 1];
            $repeats = 0;    # reset counter
            push @nonmatches, [$new[$count], 0];
        }
        else {
            push @nonmatches, [$new[$count], 0];
        }
        $count++;
    }
    if ( $repeats > 0 ) {
        push @nonmatches, [$repeats, 1];
    }
    return @nonmatches;
}
print Data::Dumper::Dumper( [ compress_string( $str1, $str2, 20 ) ] ) . "\n";
print Data::Dumper::Dumper( [ compress_string( $str1, $str2, 0 ) ] ) . "\n";
print Data::Dumper::Dumper( [ compress_string( $long_a, $long_b, 20 ) ] ) . "\n";
print Data::Dumper::Dumper( [ compress_string( $long_a, $long_b, 0 ) ] ) . "\n";

cmpthese(1000, {
        'long_recurse' => sub { compress_string($long_a, $long_b, 0 ) },
        'long_recurse_fallback' => sub { compress_string($long_a, $long_b, 20 ) },
        }); 
```

# html - HTML 5：关于流和 Chrome

> ID：11542422
> 
> 赞同：1
> 
> 时间：2012-07-18T13:22:24.137
> 
> 标签：html, video, mediastreamsource, webrtc

对不起，我的英语很差，所以请注意我的拼写:)

我正在寻找一个 HTML5 的录像机，我发现我对 HTML5 的 getUserMedia 很满意。

问题是`getUserMedia`要求用户`MediaStream`在界面上激活（对于 webRTC）`Chrome's`：chrome://flags/

我的问题是：是否可以通过在 javascript 中使用类似 url`chrome::/flags/mediastream=true`或类似函数的方式询问用户来激活此选项`setUserMedia`？

谢谢

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-07-18T13:41:46.313

不可以。用户必须手动打开它。如果您等待几个版本，它可能会默认打开。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-07-19T03:55:19.790

我们无法在 JavaScript 内/通过 JavaScript 更改[chrome 标志开关](http://peter.sh/experiments/chromium-command-line-switches/)---

[*Chromium 接受命令行标志（或“开关”）以启用特定功能或修改其他默认功能*。](http://www.chromium.org/developers/how-tos/run-chromium-with-flags/)

每当您想告诉最终用户启用“**对等连接**”开关时，**链接**此页面是一种很好的做法- [http://www.webrtc.org/running-the-demos](http://www.webrtc.org/running-the-demos)（如果您使用的是**PeerConnection** API！！！ )

 ******Chromium 21 stable**默认启用此功能（**getUserMedia ） -** [http://caniuse.com/stream](http://caniuse.com/stream)****

# android - 以钛金属为目标的其他平台是否只是 UI 更改的问题？

> ID：11542435
> 
> 赞同：3
> 
> 时间：2012-07-18T13:22:59.930
> 
> 标签：android, iphone, ipad, titanium, titanium-mobile

如果我有一个钛金属的 iPhone 应用程序，然后还想在 android 和 ipad 上运行相同的应用程序，让它在每个平台上都运行良好是只是进行一些 UI 更改的问题，还是需要重写大量的代码？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-07-18T15:20:15.413

我要做的第一件事就是在Android模拟器中尝试一下。它有效吗？Titanium 会将 UI 元素映射到目标平台功能，因此它可能会正常工作，尽管它看起来会有所不同。每个平台都有不同的方式在屏幕上显示信息。

Titanium Mobile 是一次编写，随处适应的模型。因此，您编写应用程序的主要功能，然后使 UI 适应平台。如果结构合理，您通常可以为设备重用大部分后端管理代码。在我的情况下，我正在编写一个合理的大型应用程序，我可以重用我所有的网络代码和数据库交互代码。您设置项目的方式允许您在平台特定文件夹中的需要替换平台特定文件。例如，如果您的 form1.js 不能在 Android 上运行，但可以在 iPhone 上运行，则将适用的 form1.js 文件放入与文件夹结构匹配的 Android 文件夹中，它会在编译期间从那里提取文件，但继续将 database.js 文件用于公共代码中的数据存储。

一些跨平台代码的一个很好的例子是可以通过 IDE 获得的**RSS Reader示例代码（IDE 中的左下面板）。**您可能会从中找出使您的应用程序在 Android 上运行所需的细微更改。我也喜欢**Tweetanium**应用程序源代码，因为它是一个更大的项目，并且具有类似的跨平台工作，可以使应用程序在两个操作系统上看起来相似。

此外，请搜索 Titanium Mobile Titans 以获取**“应用程序”**源代码。其实这里是链接：[https](https://github.com/appcelerator-titans/App) ://github.com/appcelerator-titans/App 。这是一个考虑了 UI 的跨平台界面示例。

我相信所有这些示例也都有平板电脑（iPad/Android）检测代码，因此您可以看到代码如何针对这些屏幕尺寸进行分支。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-07-18T15:37:46.847

虽然 Titanium 在技术上可以是“一次编写，随处部署”的平台，但我认为开发人员最好为每个平台创建相同的代码库，同时稍微改变开发以适应特定的目标平台。

例如，针对 Android 设备（从 Galaxy Nexus 等高端智能手机到 Nexus 7 等平板电脑）的需求与 iOS 应用程序的最佳实践需求大不相同。

我什至不希望完全相同的应用程序针对同一设备系列的成员。以 iOS 为例 - 为 iPhone 和 iPad 设计的最精心设计的应用程序具有强烈的 UI/UX 差异，由于它们在外观和使用上的巨大差异，应该加以考虑。

6wunderkinder 开发的**Wunderlist**应用程序就是一个不遵循“一次编写，随处部署”模型的应用程序的一个很好的例子。虽然他们使用 Titanium 来开发他们的 iOS 应用程序，但他们并没有将 Titanium 也用于他们的 Android 应用程序，而是决定完全放弃 Titanium 并进行本地开发。

这并不是说您不能在两个平台上都坚持使用 Titanium（我已经在 iOS 和 Android 上制作了改编自相同代码的应用程序），但 6wunderkinder 团队决定做出这是一个完全可以理解的选择。虽然他们可以很容易地将大部分现有的 iOS Titanium 代码库用于他们的 Android 应用程序，但他们可能必须做出许多牺牲才能使其在 Android 上以他们设想的方式显示。

所以，是的，如果想要一个漂亮的应用程序（在两个设备系列上完全按照您想要的方式获得它），您通常需要更改大量代码。

# haskell - 将它们放在一起时出现编译器错误

> ID：11542441
> 
> 赞同：0
> 
> 时间：2012-07-18T13:23:12.560
> 
> 标签：haskell, binary-search

**我编写了通过二进制搜索**在元组的索引列表中搜索的程序我编写并且工作正常

```
superBubble::(Ord t) =>[[t]]->[[t]]
superBubble a=map bubbleSort a
combining::[BookInfo]->[Int]
combining books= bubbleSort(map index books)  
 binsearch :: [Int] -> Int -> Int -> Int -> Int -- list, value, low, high, return int
 binsearch xs value low high
  | high < low       = -1
  | xs!!mid > value  = binsearch xs value low (mid-1)
  | xs!!mid < value  = binsearch xs value (mid+1) high
  | otherwise        = mid
   where
   mid = low + ((high - low) `div` 2)
  final::[BookInfo]->Int->Int->Int->Int 
  final vs key s r= binsearch concat( combining vs) key s r 
```

并且其他功能正常工作但是当我将它添加到孔中时会给我一个错误

错误是 unexcpted '|' 第一个，但为什么？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-07-18T13:28:36.927

from`binsearch ::`的行比它之前的行缩进一个空格。将这些行中的每一行取消一个空格。

此外，从`final::`后面开始的行比初始行缩进两个空格。将这些行中的每一行取消两个空格。

最后，正如丹尼尔指出的那样，你`-<`的`final::`行中有 a ，而不是 a `->`。*（您现在已在发布的代码中进行了更正，从而使将来查看此问题的任何人感到困惑。）*

* * *

正确代码：

```
superBubble::(Ord t) =>[[t]]->[[t]]
superBubble a=map bubbleSort a
combining::[BookInfo]->[Int]
combining books= bubbleSort(map index books)  
binsearch :: [Int] -> Int -> Int -> Int -> Int -- list, value, low, high, return int
binsearch xs value low high
 | high < low       = -1
 | xs!!mid > value  = binsearch xs value low (mid-1)
 | xs!!mid < value  = binsearch xs value (mid+1) high
 | otherwise        = mid
  where
  mid = low + ((high - low) `div` 2)
final::[BookInfo]->Int->Int->Int->Int 
final vs key s r= binsearch concat( combining vs) key s r 
```

（并且您还需要包括`bubbleSort`,`BookInfo`和的定义`index`。）

* * *

为什么你的缩进是错误的？

因为它`binsearch`看起来好像它是 的值的一部分`combining`，而不是一个单独的函数。第一个`|`是不可能成为表达式一部分的第一个字符。

# ocaml - 什么是主体类型？

> ID：11542446
> 
> 赞同：20
> 
> 时间：2012-07-18T13:23:19.803
> 
> 标签：ocaml

OCaml 编译器有一个“-principal”选项，邮件列表中有时会提到术语“principal type”。它到底是什么意思？维基百科中的定义是递归的，因为它假设读者已经熟悉这个概念。

* * *

## 回答 #1

> 赞同：36
> 
> 时间：2012-07-18T16:08:42.887

类型推断的过程是猜测，给定一个用户编写的程序，这个程序的类型是什么。一般来说，一个给定的程序可能有*几种*正确的类型。例如，程序`fun x -> x`可以被赋予类型`int -> int`和`bool -> bool`。

给定一个程序，如果该程序的类型是可以赋予​​该程序的最通用类型，则该程序的类型是*主体，从某种意义上说，所有其他可能的类型都是该类型的特化（实例）。*在我的`fun x -> x`示例中，多态`'a -> 'a`是一种主要类型。

在某些类型系统中，主体类型并不总是存在。你有一个程序`P`有两种可能的类型`T1`和`T2`，没有一个比另一个更通用。例如，在一些数值运算符被重载的系统中，程序`fun x -> x + x`可以被赋予 type`int -> int`和 type `float -> float`，并且没有包含两者的类型。这对推理引擎来说是个问题，因为这意味着它必须做出任意选择，在不知道它是否是用户想要的类型的情况下选择一种可能的类型。如果您有主体类型，则推理过程不需要做出任何选择。

（要解决该示例，您可以：（1）不重载算术运算符（2）做出任意选择（这就是 F# iirc 所做的）（3）拒绝程序并要求类型注释以消除歧义（4）有更多表现力类型，例如 Haskell 的`Num a => a -> a`.)

OCaml 语言的“简单”子集基于 Hindley-Milner 类型推断，具有主要类型。这意味着推理引擎总是做正确的事情（给定可能类型的规范）。类型系统的一些更高级的方面（例如多态字段和方法）失去了这个属性：在某些情况下，类型系统无法找到最通用的类​​型，或者找到最通用的类​​型需要从类型推理引擎（通常会尝试快速）。`-principal`如果我没记错的话，这个选项是一个旋钮：

*   失败是在某些情况下，类型检查器本来会接受非主要解决方案（做出任意选择）
*   更努力地找到一个主要的解决方案，代价是更长的类型检查时间和内存使用

我对这个标志不是很熟悉（我更喜欢避免过于高级的类型系统功能，所以我的程序通常不关心），所以你必须仔细检查这个，但这是粗略的想法。这个标志在我看来相对不重要（你通常不需要关心），但主体类型的概念确实是 ML 语言理论的重要组成部分。

如果您想更进一步，还有两个技术细节：

*   The ML notion of "principal types" is the question of whether there exist a most general type given a fixed type environment; some authors study the question of whether they exist a most general (environment, type) pair, so-called a "principal typing"; it is a harder question (you have to infer what you expect from the other modules, while in ML you are given signatures for the external modules you rely on; and inferring polymorphism is very hard) that is not used in most ML-inspired programming languages.

*   Existence of principal types is a delicate equilibrium for designers of type system. If you *remove* features from the ML type system (polymorphism, types such as `'a -> 'a`), you lose principality, but if you *add* power (going from ML to System F which has more expressive polymorphic types) you may also lose principality. You can regain that lost principality by moving to even more complex type systems such as MLF, but it is a hard problem.

In practice, a relatively large part of the designers of programming languages have lately given up on the idea of principality. They want to have more ambitious type systems (dependent types, etc.) where it's just too hard to seek principality, so they instead content themselves with non-principal inference: it's already good if the inference engine can find *some* type, let's not be difficult on the generality of the result. Jacques Garrigue, the main maintainer of the OCaml type system, still cares about it very much, and I think that's an interesting aspect of the OCaml programming language research.

* * *

## 回答 #2

> 赞同：10
> 
> 时间：2012-07-23T20:23:29.743

To build a little bit upon gasche's explanation, here's an example, stolen from OCaml's own testsuite, where principality, or lack thereof, appears. Disclaimer: this uses objects.

```
class c = object method id : 'a. 'a -> 'a = fun x -> x end;;
type u = c option;;
let just = function None -> failwith "just" | Some x -> x;;
let f x = let l = [Some x; (None : u)] in (just(List.hd l))#id;;
let g x =
  let none = (fun y -> ignore [y;(None:u)]; y) None in
  let x = List.hd [Some x; none] in (just x)#id;;
let h x =
  let none = let y = None in ignore [y;(None:u)]; y in 
  let x = List.hd [Some x; none] in (just x)#id;; 
```

When running this in a top-level session, you'll get:

```
#     val f : c -> 'a -> 'a = <fun>
#     val g : c -> 'a -> 'a = <fun>
#     val h : < id : 'a; .. > -> 'a = <fun> 
```

These functions perform the exact same thing but get assigned different types!

If you invoke OCaml with the `-principal` option, the first two examples will trigger:

```
Warning 18: this use of a polymorphic method is not principal. 
```

The interesting thing is that if you replace `'a` in the type of `h` with `'a -> 'a`, you get the exact same type as `f` and `g`, since the type `c` is just a type abbreviation for (i.e. expands to) `< id: 'a -> 'a; .. >`.

What the compiler wants to tell the programmer here is that there are two suitable types for `f` and `g`, and that there is no criterion that would help OCaml decide which one is the "best" (and by "best", I mean "principal", of course!).

# xpages - 如何在名称选择器中获取“本地通讯录”？

> ID：11542448
> 
> 赞同：0
> 
> 时间：2012-07-18T13:23:32.797
> 
> 标签：xpages, xpages-extlib

我们在**Xpages**中有一个名称选择器，它应该从当前服务器的 NAB 和本地地址簿中获取值。

我们从服务器的 NAB 获取值的代码运行良好。

但我不知道如何写“本地通讯录”

我尝试使用 ("") 和其他服务器名称，但没有运气。

谁能告诉我应该如何在 dblookup 中给出服务器名称？

谢谢

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-07-19T09:07:19.057

由于您使用的是标准（“vanilla”）版本的 xpages，这意味着您正在 Domino 服务器上运行您的代码。但是，服务器根本没有机会访问某种 Notes 客户端数据库——这怎么可能，尤其是因为您一开始就没有使用 Notes 客户端。因此，您需要将您的 NAB 数据带到服务器。

乍一看，我看到了两个选项：

1.  在该服务器上创建相关个人 NAB 的副本并修改其 ACL，以便可以从服务器端脚本代码访问它们

2.  确保您使用的是启用 iNotes 的邮件文件，并确保将您的个人 NAB 数据复制到此邮件文件中（如有疑问，请参阅 iNotes 文档）。然后您应该能够通过您的邮件文件访问您的个人 NAB 数据。它应该包含您个人 NAB 数据库中的所有重要视图。

# c# - 无法访问 listBox1

> ID：11542451
> 
> 赞同：1
> 
> 时间：2012-07-18T13:23:42.267
> 
> 标签：c#

我有 listBox1 但是当我在 buttonClick 内使用 listBox1 时，我可以访问但在 buttonClick 之外我无法访问。我在哪里做错了？谢谢

```
namespace design
{
    public partial class Form1 : Form
    {
        public Form1()
        {
            InitializeComponent();
        }

        private void button4_Click(object sender, EventArgs e)
        {
            listBox1.Items.Add(button1.Text);// I can access listBox1 here...
        }

        listBox1.//I can't access listBox1 here....
    }
} 
```

* * *

## 回答 #1

> 赞同：12
> 
> 时间：2012-07-18T13:25:02.080

您**可以**在那里访问它，但它不起作用，因为您不在任何函数或方法中。

你不能只是在类的某个地方开始输入代码，你需要处理某种事件或其他东西。

顺便说一句，这是非常基本的 C# 知识。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-07-18T13:42:13.643

你的代码是错误的。您需要放入`listBox1`一些方法来访问它。

```
namespace design
{
    public partial class Form1 : Form
    {
        public Form1()
        {
            InitializeComponent();
        }

        private void button4_Click(object sender, EventArgs e)
        {
            listBox1.Items.Add(button1.Text); // This part is inside a event click of a button. This is why you can access this.
        }

        public void accessList()
        {
            listBox1.Items.Add(button1.Text); // You'll be able to access it here. Because you are inside a method.
        }
        // listBox1\. // you'll NEVER access something like this. in this place
    }
} 
```

[也许你想做一个财产？](http://msdn.microsoft.com/en-us/library/x9fsa0sw.aspx)

# asp.net-mvc - 代替 使用 Html.ActionLink

> ID：11542455
> 
> 赞同：0
> 
> 时间：2012-07-18T13:23:53.130
> 
> 标签：asp.net-mvc, asp.net-mvc-2

在我的母版页中。原来我有代码：

```
<ul> 
   <li>Home</li> 
   <li>About</li> 
   <li>Sermon</li> 
</ul> 
```

在我的 MVC 2 项目中，我想使用 Html.ActionLink 替换 li 等。所以我的代码：

```
 <div id="leftcolumn">
               <% @Html.ActionLink("Home", "Home", "Home") %> 
               <% @Html.ActionLink("About", "About", "Home") %>
               <% @Html.ActionLink("Sermon", "Sermon", "Home") %>
          </div> 
```

快照喜欢： ![MVC](../Images/9b4a9d8e158623b0a32f58608d9d4c45.png)

请更正我的代码。

谢谢。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-07-18T13:26:26.313

您似乎正在尝试将 Razor 视图引擎语法与经典视图引擎语法混合使用。如果您真正使用 MVC 2，则您没有使用 Razor，因此您的代码可能应该是：

```
<%= Html.ActionLink("Home","Home","Home") %> 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-07-18T13:26:56.527

您将 Razor 语法 (MVC3) 与 MVC2 代码混合，对于您想要执行的 MVC2：

```
<%= Html.ActionLink("Home", "Home", "Home") %>
... 
```

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-07-18T13:26:23.423

您不需要`@`，因为这不是`razor`视图（MVC 3）。在 MVC 2 中，您可以：

```
<div id="leftcolumn">
       <%= Html.ActionLink("Home", "Home", "Home") %> 
       <%= Html.ActionLink("About", "About", "Home") %>
       <%= Html.ActionLink("Sermon", "Sermon", "Home") %>
</div> 
```

# git - git 导航表达式

> ID：11542457
> 
> 赞同：0
> 
> 时间：2012-07-18T13:23:58.260
> 
> 标签：git

我遇到了以下 git 命令：`git diff ^master my_branch@{1} my_branch`. `^master`,`my_branch@{1}`和命令本身是什么意思？

我找了人，`git diff`但没有找到任何具有三个分支的变体。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-07-18T13:36:36.080

^master 表示不是来自主人

一个 ref 后缀为 @ 并带有一个包含在大括号对中的序数规范（例如 {1}、{15}），指定了该 ref 的第 n 个先前值。例如，master@{1} 是 master 的直接优先值，而 master@{5} 是 master 的第 5 个优先值。此后缀只能紧跟在 ref 名称之后使用，并且 ref 必须具有现有日志 ($GIT_DIR/logs/)。

所以你做了一个 my_branch 的差异，但不显示任何 master 可以访问的差异。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-07-18T13:39:10.323

有关更多信息，请参见[`gitrevision`](http://schacon.github.com/git/gitrevisions.html)手册页。在您的示例中：

1.  `my_branch@{1}`表示先前的`my_branch`参考状态。
2.  `^master`是`git diff`除了已经存在于`master`分支中的所有内容之外的所有内容。

结果，您将获得以前版本中`my_branch`但`master`尚未出现的所有内容。

# c# - 当 openFileDialog 从第二个表单返回结果时，模态表单关闭

> ID：11542459
> 
> 赞同：3
> 
> 时间：2012-07-18T13:24:00.650
> 
> 标签：c#, winforms

**Form1**使用 Form2.ShowDialog()打开**Form2 。**在**Form2**中打开了一个文件对话框。当文件浏览器关闭时，Form2 也关闭（因为我猜是触发了 DialogResult）

我似乎无法通过搜索找到解决方案，也许是因为我不知道要搜索什么。那么在没有**Form2**关闭的情况下实现这一目标的首选方法是什么？

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-07-18T13:38:19.950

显然这不是我认为的默认行为。form2 中按钮的 DialogResult 属性确实将其值设置为 OK，我不知道。将此设置为无解决了这个简单的问题。谢谢您的帮助 ：）

# php - 安全 WebSocket (wss://) 在 Firefox 上不起作用

> ID：11542460
> 
> 赞同：7
> 
> 时间：2012-07-18T13:24:03.283
> 
> 标签：php, html, firefox, websocket, stunnel

我有一个有效的 WebSocket 非安全应用程序。但是我的网站使用 https 并且我需要一个安全的 WebSocket 连接来避免 Firefox 抱怨连接不安全的事实。

我将[php-websocket-server](http://code.google.com/p/php-websocket-server/)用于我的带有 PhP 5.2.9 的 WebSocket 服务器，所以当我使用 WebSocket 安全时，我无法使用 openssl_decrypt 函数解密数据包。

这就是为什么我使用[stunnel](http://www.stunnel.org/)来解密客户端使用 wss 发送的数据包，为此我将客户端 WebSocket 绑定到 12345 端口，将服务器 WebSocket 绑定到 54321 端口，然后我在服务器模式下添加了一个 stunnel：

```
[wsServer]
accept  = 12345
connect = 192.168.1.227:54321 
```

使用此配置，我的应用程序通过 https + wss 在 Chrome 上运行良好。`Sec-WebSocket-Version`但是在 Firefox 上，握手期间出现问题，标题中似乎`Sec-WebSocket-Key`没有。我不明白，因为它通过 http + ws 在 Firefox 上工作。

在此先感谢您的帮助。

编辑：我为端口 12345 上的证书添加了一个例外，现在握手进展顺利，因为我认为 Firefox 现在有`Sec-WebSocket-Key`.

这里是 Firefox 的工作标头请求（大于 Chrome 请求）：

```
GET / HTTP/1.1
Host: 192.168.1.227:12345
User-Agent: Mozilla/5.0 (Windows NT 6.1; WOW64; rv:14.0) Gecko/20100101 Firefox/14.0.1
Accept: text/html,application/xhtml+xml,application/xml;q=0.9,*/;q=0.8
Accept-Language: fr,fr-fr;q=0.8,en-us;q=0.5,en;q=0.3
Accept-Encoding: gzip, deflate
DNT: 1
Connection: keep-alive, Upgrade
Sec-WebSocket-Version: 13
Origin: https://192.168.1.227
Sec-WebSocket-Protocol: HyBi-00
Sec-WebSocket-Key: 65nHN33M6drIPjQHcGK8pA==
Pragma: no-cache
Cache-Control: no-cache
Upgrade: websocket 
```

* * *

## 回答 #1

> 赞同：11
> 
> 时间：2012-07-19T05:58:46.213

如果您使用自动签名证书在本地工作，则必须在运行在端口 443 上的两个服务器 https:// 和运行在端口 12345 上的 wss:// 上使用 Firefox 批准它。

我认为您的浏览器不允许安全的 websocket 连接，这就是为什么缺少一些标头的原因。

[从@Faisal 评论更新，因为它非常重要]
答案是正确的，但有点不清楚。好的，就是这样。
当您尝试使用 wss://mysite.com:12345 打开 wss 时，**Firefox 将继续给您错误，直到您打开单独的 Firefox 选项卡并尝试点击 URL [https]://mysite.com： 12345**并确认安全异常（就像您在 Firefox 上通常针对任何基于 https 的连接所做的那样）。
这真的很奇怪，而且只发生在 Firefox 中。

# java - 用于分析 Eclipse 插件的工具

> ID：11542465
> 
> 赞同：3
> 
> 时间：2012-07-18T13:24:16.827
> 
> 标签：java, eclipse-plugin, profiler

我正在开发一个 Eclipse 插件，我开始遇到性能问题，所以我想开始使用分析器。既然它是一个eclipse插件而不是一个普通的java程序，我应该使用什么工具来分析它？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-07-18T13:26:44.290

我发现 JProfiler 真的很有帮助。它具有 Eclipse 集成，尽管它不是每个 Eclipse 插件，因此您可以非常轻松地调用分析器而不是常规执行会话。它具有非常好的瓶颈分析，您可以找到调整设置以降低分析器本身的开销。强烈推荐。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-07-18T20:34:14.710

如果您认为您的应用程序导致系统耗尽句柄，我建议运行 sleak [http://www.eclipse.org/articles/swt-design-2/sleak.htm](http://www.eclipse.org/articles/swt-design-2/sleak.htm)。它非常易于使用，无论如何都值得不时进行完整性检查。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-07-18T20:55:00.230

每当我过去尝试不同的方法时，它们都没有相同的丰富功能和易用性来调查长时间运行的进程或像[Yourkit Java Profiler](http://www.yourkit.com/home/index.jsp)这样的巨大转储。

如果您的插件是开源的，那么您可以在该项目的免费许可下获得完整版本。

# random - 在同一标签中随机显示数组对象

> ID：11542466
> 
> 赞同：0
> 
> 时间：2012-07-18T13:24:17.650
> 
> 标签：random, nsmutablearray, label

我正在做一个包含 10 个问题和答案的项目。我正在使用 touchesbegan、touchesmoved 和 touchesended 方法。问题出现在一个标签中，答案在屏幕上有 10 个不同的标签。用户应该匹配他们，基本上这就是游戏。在 touchesended 方法中，我正在使用 if 语句验证问题的结果和答案的位置，因此请尝试通过拖动到正确的位置来了解它是否是正确的答案。

所以，我需要问这个；当用户给出正确答案时，问题应该改变。我对 NSMutableArray 提出了问题，每次打开它的顺序都不同且随机。如何在相同的标签和文本中显示数组的其他对象。（它应该是文本，因为后面还有另一个数字）这是一些代码的示例：

```
arr = [[NSMutableArray alloc] initWithObjects:@"1",@"2",@"3",@"4",@"5",@"6",@"7",@"8",@"9",@"10", nil];

srandom(time(NULL));
NSUInteger count = [arr count];
for (NSUInteger i = 0; i < count; ++i) {
    int nElements = count - i;
    int n = (random() % nElements) + i;
    [arr exchangeObjectAtIndex: i withObjectAtIndex:n];
}
Question.text = [NSString stringWithFormat:@"%ix1=", [[arr objectAtIndex:(random()%9)+1] intValue]]; 
```

问题解决后，我需要带来数组的其他数字之一。也使用过的数字不应该再次出现。

任何人都可以帮忙吗？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-07-18T16:25:22.353

代替

```
Question.text = [NSString stringWithFormat:@"%ix1=", [[arr objectAtIndex:(random()%9)+1] intValue]]; 
```

您需要先获取随机索引号

```
int index = (random()%9) + 1; 
```

然后

```
Question.text = [NSString stringWithFormat:@"%ix1=", [[arr objectAtIndex:index] intValue]]; 
```

接下来就可以使用`index`删除对应的对象了`NSMutableArray`

```
[arr removeObjectAtIndex:index]; 
```

# blackberry - 检查 gps、手机信号塔和 wifi 可用性

> ID：11542470
> 
> 赞同：0
> 
> 时间：2012-07-18T13:24:27.463
> 
> 标签：blackberry, gps, location

我正在通过 GPS 在我的 BlackBerry 应用程序中获取当前位置，并且工作正常。该位置每隔几秒就会更新一次。我想介绍一个逻辑来检查 GPS、wifi 和手机信号塔的可用性，并在此基础上开始跟踪位置。例如，如果它开始从手机信号塔获取位置并且突然 GPS 现在可用，我希望它切换到 GPS 以获取坐标等。我应该如何确定哪些可用。请帮忙。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-07-18T16:35:49.947

如果您的目标是 BBOS 5.0 或更高版本，则此功能已内置。请参阅[我对这个问题的回答](https://stackoverflow.com/questions/11535640/blackberry-gps-issue-with-locationlistener-cellsite-untill-gps-locks)。如果没有，那么[LocationListener](http://www.blackberry.com/developers/docs/7.0.0api/javax/microedition/location/LocationListener.html#providerStateChanged%28javax.microedition.location.LocationProvider,%20int%29)会在 GPS 服务不可用时告诉您。但是，在 5.0 之前，您不太可能找到具有 GPS 和 Cellsite 地理位置的设备，因此您必须使用 Signare 建议的技术。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-07-18T14:24:59.510

对于 gps 模块检查 -

```
 int m_bbHandle = CodeModuleManager.getModuleHandle("net_rim_bb_lbs");
 if(m_bbHandle<=0){
 //GPS Available
  } 
```

对于 WIFI 可用性 -

```
 if ((WLANInfo.getWLANState() == WLANInfo.WLAN_STATE_CONNECTED)&& RadioInfo.areWAFsSupported(RadioInfo.WAF_WLAN)) {
  //WiFi is available
    } 
```

对于手机信号塔 -

```
Integer.toString(GPRSInfo.getCellInfo().getCellId( ));
//Retrieves the current cell ID.

Integer.toString(GPRSInfo.getCellInfo().getLAC());
//Retrieves the Location Area Code.

Integer.toString(GPRSInfo.getCellInfo().getBSIC()) ;
//Base Station Identity Code 
```

# python - 使用乳胶和嵌入式 python 代码编译问题

> ID：11542491
> 
> 赞同：0
> 
> 时间：2012-07-18T13:25:19.053
> 
> 标签：python, latex, pdflatex

我正在使用带有 Python 2.7 和 LaTeX 的 Ubuntu 服务器，我尝试使用 shell 命令编译这个 LaTeX 代码：pdflatex test.tex

```
\documentclass{article}

\usepackage{python}

\begin{document}

     \begin{python}
     print "Hello World"
     \end{python}

\end{document} 
```

这很简单，因为这是我第一次尝试两者，但我收到以下错误消息：

```
(/usr/share/texmf/tex/latex/python/python.sty

Package: python 2007/06/07 v0.21 Python in LaTeX
\@out=\write3
\@module=\write4
) (./test.aux)

! I can't write on file `test.aux'.

\document ...ate \openout \@mainaux \jobname .aux          
\immediate \write \@mainau...
l.5 \begin{document}                   

(Press Enter to retry, or Control-D to exit; default file extension is `.tex')
Please type another output file name: 
! Emergency stop.
\document ...ate \openout \@mainaux \jobname .aux 
```

可能是权限问题还是其他什么？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-07-18T14:15:57.610

我对有问题的 LaTeX 包没有任何经验，但据我所知，它将尝试执行 python 片段并包含输出。尝试从 python 段中删除前导空格：

```
\begin{python}
print "Hello World!"
\end{python} 
```

代替：

```
 \begin{python}
     print "Hello World!"
     \end{python} 
```

多余的前导空格将导致 python 解释器抛出一个`IndentationError`可能是混淆 python.sty 的原因。粗略地看一下[python.sty](http://goodmami.org/files/python.sty)让我相信它会做以下 shell 命令会做的事情：

```
prompt$ echo '     print "Hello World!"' > test.py
prompt$ cat test.py | python > test.py.out 2> test.py.err 
```

然后它会逐字包含*test.py.out*，这将是空的。标准错误输出将包含以下内容：

```
File "<stdin>", line 1
  print "Hello World!"
  ^
IndentationError: unexpected indent 
```

在 sty 文件中提到他不应该忽略标准错误输出。我有一种感觉，如果`python`解释器退出失败，那么 LaTeX 永远不会生成输出，但我可能是错的。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-07-18T13:34:24.350

错误消息是为了您的利益！

```
! I can't write on file `test.aux'. 
```

表示 LaTex 正在尝试向文件“test.aux”写入内容，但不能。最可能的原因是文件被锁定，因为您在其他地方打开了它。

您应该能够通过尝试删除文件来检查这一点。解锁后应该没问题；最坏的情况，重启。

# mysql - 当一列达到0时删除整行？

> ID：11542493
> 
> 赞同：1
> 
> 时间：2012-07-18T13:25:28.413
> 
> 标签：mysql, sql

所以我有这个数据库表“userDeck”，有三列：idUser、idCard、amount。金额是一个计数器，用于跟踪用户添加了多少张特定卡的卡。现在我正在使用这个查询：

```
$query1 = "UPDATE userDeck SET amount=amount-$amount WHERE idCard=$idCard"; 
$result2 = mysql_query($query1) or die(mysql_error()); 
```

当用户想要删除他/她添加的卡片时。

这工作得很好，但如果您删除的卡比您列出的多，它会继续低于 0。我希望它在数量达到 0 时删除该行。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-07-18T13:27:58.633

您可以添加语句：

```
DELETE FROM userDeck WHERE idCard=$idCard and amount = 0 
```

更新后立即。

```
$query1 = "DELETE FROM userDeck WHERE idCard=$idCard and amount = 0";
$result2 = mysql_query($query1) or die(mysql_error()); 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-07-18T13:28:02.813

两种方式

1.  在 php 级别使用“应用程序控制”并且不让用户能够删除该卡
2.  使用 where 条件排除那些具有`amount = 0`

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-07-18T13:28:38.230

```
DELETE FROM userDeck WHERE amount<=0 
```

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2012-07-18T13:28:14.553

```
$query1 = "UPDATE userDeck SET amount=amount-$amount WHERE idCard=$idCard"; 
$result2 = mysql_query($query1) or die(mysql_error()); 
```

然后你可以在之后运行它：

```
$query_del = "DELETE FROM userDeck WHERE idCard=$idCard AND amount = 0"; 
mysql_query($query_del) or die(mysql_error()); 
```

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2012-07-18T13:33:05.537

除了 Gordon 提供的解决方案之外，还可以考虑将类型更改`amount`为`UNSIGNED`（假设它是 INTEGER 类型）以及[严格的 sql_mode](http://dev.mysql.com/doc/refman/5.0/en/server-sql-mode.html#sqlmode_strict_all_tables)。

如果您尝试将值设置为负值，这将引发错误。

# perl - 如何将调用环境正确导出到 Perl 的子 shell 中？

> ID：11542495
> 
> 赞同：4
> 
> 时间：2012-07-18T13:25:41.227
> 
> 标签：perl, path, environment

我正在尝试使用 Perl 脚本在我们拥有的工具（wpj）中添加某些目录。直接命令看起来像

```
$ wpj 添加路径/到/desired/library makefile.wpj
```

我想做一个脚本来自动化这个，因为很多事情都要做。但是，设置了一组非常特殊的环境变量来制作“wpj”。如果我用 Perl 的反引号调用 wpj，则调用失败。你可以看到下面的代码

```
$command = "wpj add library path\\to\\file.wpj \\path\\to\\add";
print $command."\n";
$result = `$command`;
print "->".$result."\n"; 
```

为此我得到

```
wpj: not found 
```

但是，来自 shell 的相同调用会成功。某些东西没有正确导出，您能否就如何将调用环境导出到反引号创建的子shell 中给我一些建议？

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2012-07-18T13:34:46.767

检查*PATH*并根据需要修改其内容：

```
use Env qw(@PATH);

# check the PATH:
print join("\n", @PATH);

# modify its content:
push @PATH, "/usr/bin/wpj"; 
```

[该模块的官方手册](http://perldoc.perl.org/Env.html)。

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2012-07-18T17:08:23.733

无需您执行任何操作即可继承环境。我怀疑`wpj`不是可执行文件，而是 shell 别名。因此，您需要在定义了该别名的 shell 中运行该命令。这可能需要一个交互式 shell，具体取决于您创建别名的方式。

```
system('bash', '-i', '-c', 'wpj add path/to/desired/library makefile.wpj'); 
```

# jquery - 带有 JQuery 的 YouTube 简单播放按钮

> ID：11542502
> 
> 赞同：3
> 
> 时间：2012-07-18T13:26:13.387
> 
> 标签：jquery, youtube, youtube-api

我想要 2 个简单的按钮来播放和停止 YouTube 视频。我用 jQuery 尝试过这样的事情，但不起作用。

1.  谁能帮我提供一个简单而干净的解决方案来为 YouTube 视频制作播放按钮？
2.  我可以隐藏视频以便只听到声音吗？

[http://codepen.io/anon/pen/Carwu](http://codepen.io/anon/pen/Carwu)
[http://jsfiddle.net/8kN6Z/34/](http://jsfiddle.net/8kN6Z/34/)

```
$(function(){

  $("#video").hide();          
  $("#escolta").click(function() {
    video.playVideo();
    //$("#video").playVideo();
    //$("#video").trigger('play');
    //$(".player").playVideo()

    });

  $("#pausa").click(function() {
    video.stopVideo();
    //$("#video").trigger('pause');
  });

}); 
```

CSS：

```
#escolta,#pausa{ font-family: Tahoma;letter-spacing:1px;font-size:11px;color: #666;width: 80px;text-align: center;height: 20px;line-height: 20px;background-color: #ccc;cursor: pointer;}
#escolta {position:absolute;top: 20px;left:20px;}
#pausa{position: absolute;top:20px;left: 150px;}​
#pausa{position: absolute;top:20px;left: 150px;}
#video{position:absolute;top:100px;left:20px;} 
```

HTML：

```
<div id="escolta">escolta</div>
<div id="pausa">pausa</div>

<iframe id="video" width="640" height="360" src="http://www.youtube.com/embed/4G1mundpq-Q?rel=0" frameborder="0" allowfullscreen></iframe> 
```

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2013-01-27T22:36:22.113

我重温了这个。弄清楚你遇到的一些问题。

看看它在 JSFiddle 上的工作[http://jsfiddle.net/8kN6Z/33/](http://jsfiddle.net/8kN6Z/33/)

这是你做错了什么：

您没有加载 Youtube Player API。即使您使用的是 iframe，也必须手动执行。

您没有创建名为 onYouTubePlayerAPIReady 的函数。

您没有为您的框架创建 YT.Player 对象并将该 YT.Player 对象的 onReady 事件处理程序设置为您的 onPlayerReady 函数。

您没有等到在 onPlayerReady 回调函数中将点击事件处理程序设置为就绪的 YT.Player 对象。

您将 JSFiddle 上的 Javascript API 设置为 Mootools，然后使用带有 $('#id') 的 CSS 选择器语法。$$('#id') 适用于 mootools，但 $('id') 是正确的 Mootools 语法。$('#id') 是 jQuery。

您将 javascript 包装在 onLoad 方法中。这是行不通的。

YouTube Player API 设置和函数定义需要在顶层定义。

最大的问题是 iframe 标签中缺少 type="text/html" 和 src 脚本参数 &enablejsapi=1 属性。没有这些，脚本将无法正常工作。

在 Codepen 上，您使用的是 jQuery，因此必须对这个解决方案进行音译。

我在使用 Mootools 时遇到的问题：$('video').hide() 不起作用。创建一个带有 display:none 的 .hideme 类并在 onPlayerReady 回调函数的末尾调用 $('video').addClass('hideme') 就可以了。

[JS Fiddle 工作示例](http://jsfiddle.net/8kN6Z/33/)

HTML：

```
<body>
    <div id="escolta">escolta</div>
    <div id="pausa">pausa</div>
    <iframe id="video" type="text/html" width="640" height="360" src="http://www.youtube.com/embed/4G1mundpq-Q?rel=0&enablejsapi=1" frameborder="0" allowfullscreen></iframe>
</body> 
```

CSS：

```
#escolta, #pausa {
    font-family: Tahoma;
    letter-spacing:1px;
    font-size:11px;
    color: #666;
    width: 80px;
    text-align: center;
    height: 20px;
    line-height: 20px;
    background-color: #ccc;
    cursor: pointer;
}
#escolta {
    position:absolute;
    top: 20px;
    left:20px;
}
#pausa {
    position: absolute;
    top:20px;
    left: 150px;
}
#pausa {
    position: absolute;
    top:20px;
    left: 150px;
}
#video {
    position:absolute;
    top:100px;
    left:20px;
}
.hideme {
    display:none;
} 
```

JS：

```
var tag = document.createElement('script');
tag.src = "//www.youtube.com/player_api";
var firstScriptTag = document.getElementsByTagName('script')[0];
firstScriptTag.parentNode.insertBefore(tag, firstScriptTag);
function onYouTubePlayerAPIReady() {
    new YT.Player('video', {
        events: {
            'onReady': onPlayerReady
        }
    });
}
function onPlayerReady(event) {
    $("escolta").addEvent('click', function () {
        event.target.playVideo();
    });
    $("pausa").addEvent('click', function () {
        event.target.stopVideo();
    });
    $('video').addClass('hideme');
} 
```

jQuery 的更新信息如下：

我保存了一个新的测试工作 jQuery jsfiddle [http://jsfiddle.net/8kN6Z/47/](http://jsfiddle.net/8kN6Z/47/)

唯一的变化是在 javascript 部分中通过 id 选择按钮的两行。其余的 javascript 使用内置 DOM 方法的 javascript。

jQuery JS：

```
var player;
function onYouTubePlayerAPIReady() {
    player = new YT.Player('video', {
      events: {
        'onReady': onPlayerReady
      }
    });
}
function onPlayerReady(event){
  event.target.playVideo();
    $("#escolta").on('click', function() {
      player.playVideo();
    });
    $("#pausa").on('click', function() {
      player.stopVideo();
    });
  }
var tag = document.createElement('script');
tag.src = "//www.youtube.com/player_api";
var firstScriptTag = document.getElementsByTagName('script')[0];
firstScriptTag.parentNode.insertBefore(tag, firstScriptTag); 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-07-18T13:31:06.660

你不需要使用 jQuery 选择器来获取播放器，你应该为播放器指定一个 ID“例如'player'”。从这一点上你可以简单地做`player.playVideo();`

[https://developers.google.com/youtube/iframe_api_reference](https://developers.google.com/youtube/iframe_api_reference)

编辑：要隐藏播放器，您可以使用 $("#player").hide(); 因为它会隐藏 iFrame :)

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2015-02-07T10:16:34.590

我创建了一个简单的函数，它 100% 有效。简单快速:)

这是代码

```
<div class="col-xs-12 vdoframe"><img src="images/vdoimg.jpg" style="cursor:pointer" id="videoimg" />
<iframe width="100%" height="100%" src="http://www.youtube.com/embed/9-F7fkAz5G0?rel=0&enablejsapi=0" frameborder="0" allowfullscreen="" id="video"></iframe>
</div>

<script type="text/javascript">
            $(document).ready(function(){

                $('#videoimg').on('click', function(){

                    $(this).css({
                        'z-index':'1'
                    });

                    $('#video').css('z-index', '2');
                    $("#video")[0].src += "&autoplay=1";
        ev.preventDefault();

                })

})

    </script> 
```

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2012-07-18T14:52:18.923

将其粘贴在 html 部分中。对不起格式。我很着急。

```
<body>
<div id="escolta">escolta</div>
<div id="pausa">pausa</div>
<div id="player"></div>
<script>
  // 2\. This code loads the IFrame Player API code asynchronously.
  var tag = document.createElement('script');
  tag.src = "//www.youtube.com/player_api";
  var firstScriptTag = document.getElementsByTagName('script')[0];
  firstScriptTag.parentNode.insertBefore(tag, firstScriptTag);
  // 3\. This function creates an <iframe> (and YouTube player)
  //    after the API code downloads.
  var player;
  function onYouTubePlayerAPIReady() {
    player = new YT.Player('player', {
      height: '360',
      width: '640',
      videoId: '4G1mundpq-Q',
      events: {
        'onReady': onPlayerReady,
        'onStateChange': onPlayerStateChange
      }
    });
  }
  // 4\. The API will call this function when the video player is ready.
  function onPlayerReady(event) {
    //event.target.playVideo();
    $("#escolta").click(function() {
        player.playVideo();
    });
    $("#pausa").click(function() {
        player.stopVideo();
    });
  }
  // 5\. The API calls this function when the player's state changes.
  //    The function indicates that when playing a video (state=1),
  //    the player should play for six seconds and then stop.
  var done = false;
  function onPlayerStateChange(event) {
    //if (event.data == YT.PlayerState.PLAYING && !done) {
      //setTimeout(stopVideo, 6000);
      //done = true;
    //}
  }
  function stopVideo() {
    player.stopVideo();
  }
</script>
</body>​ 
```

# android - 安卓。在对话框上调用dismiss

> ID：11542503
> 
> 赞同：4
> 
> 时间：2012-07-18T13:26:15.680
> 
> 标签：android

当你调用`dismiss()`一个对话框时，除了隐藏它之外，它还会从内存中删除它吗？它是否会从内存中删除所有放置在对话框中的对象，例如`ImageViews`,`Buttons`等？

有没有办法我可以自己释放这些对象的内存，而不是等待垃圾收集器完成它的工作？

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-07-18T13:33:23.020

不，我相信这`dismiss()`只是隐藏它。

[这是参考](http://developer.android.com/guide/topics/ui/dialogs.html#DismissingADialog)

`removeDialog(int)`将清除状态。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-07-18T13:33:06.193

在 Java 中，内存只能由垃圾收集器释放，您只能使所有对象为空，以便垃圾收集器可以收集内存以释放。

你为什么需要这个？Java 的全部意义在于它为您处理内存管理。你有一些明显的记忆问题吗？

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-07-18T13:33:39.017

谷歌 Android 开发者文档说：

> public void dismiss () : 自：API 级别 1 关闭此对话框，将其从屏幕上移除。可以从任何线程安全地调用此方法。请注意，当对话框被关闭时，您不应重写此方法进行清理，而应在 onStop() 中实现该方法。

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2012-07-18T13:35:38.563

手动`free`记忆是

1.  在Java中不可行。您可以使用 分配内存`new`，但垃圾收集器会负责释放它

2.  当你有一个垃圾收集器试图在后面工作时，这是一个坏主意。

`dismiss()`只是隐藏对话框。调用`removeDialog(int)`以删除对它的所有引用并等待 GC 启动。

# javascript - 获取哈希更改后的最后一个哈希

> ID：11542505
> 
> 赞同：1
> 
> 时间：2012-07-18T13:26:18.517
> 
> 标签：javascript, backbone.js, browser-history

我有一个主干应用程序，我想在其中打开一个覆盖层，它只是一个带有其 url 的页面。您还可以使用不同的页面/网址在此叠加层中导航。因此，当覆盖层关闭时，我想将哈希设置回覆盖层打开之前的状态。由于覆盖是通过链接打开的，因此我无法从之前的状态中获取哈希值。

那么有没有办法在哈希更改时获取以前的哈希？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-07-18T13:32:32.077

hashchange 事件有一个“oldURL”字段......存储所有“oldURL”（或仅最后一个），并在需要时使用最后一个 url 更改实际 url。

来源：[https ://developer.mozilla.org/en/DOM/window.onhashchange](https://developer.mozilla.org/en/DOM/window.onhashchange)

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-07-18T13:47:07.557

我想出了这个小技巧。当覆盖打开时，我存储`window.history.length`. 当覆盖关闭时，我调用`window.history.go`存储长度与实际长度之间的差异并减去 1。

```
var appStateActions = {
  overlayPre: function(){
    this.historyPosition = window.history.length;
  },
  overlayExit: function(){
    window.history.go(this.historyPosition - window.history.length -1);
  }
} 
```

不幸的是，由于历史的限制，这不起作用。因此，在达到历史长度限制后，您会得到错误的结果。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2014-11-01T12:16:35.467

```
var historyurl =[];

$(window).on('hashchange', function(e){
    historyurl.push(location.hash); 
   if(historyurl.length > 2){ 
       historyurl.splice(0,historyurl.length-2)
     }; 
});

console.log("Last Hah Url ="+historyurl[0]) 
```

# php - 在 php 中使用 preg_replace 删除 php 中的空间

> ID：11542510
> 
> 赞同：2
> 
> 时间：2012-07-18T13:26:33.883
> 
> 标签：php, regex, preg-replace

我有以下字符串`+ Example + Test + Test2`并使用 preg_replace 我想得到以下结果`+Example +Test +Test2`

我一直在尝试使用以下代码

```
preg_replace("/\s*([\+])\s*/", "$1", $string) 
```

但是这个回来了

```
+Example+Test+Test2 
```

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-07-18T13:29:05.903

```
$output = str_replace('+ ', '+', $input); 
```

或者

```
$output = preg_replace('/\\+\\s+/', '+', $input); 
```

# c# - 设置 Active Directory 用户密码错误（RPC-Server 不可用）

> ID：11542512
> 
> 赞同：1
> 
> 时间：2012-07-18T13:26:48.243
> 
> 标签：c#, asp.net, .net, active-directory

我正在创建一个 ASP.NET Web 应用程序，它应该为事件设置密码。现在我总是收到错误“RPC-Server 不可用。（异常 HRESULT：0x800706BA）”

```
PrincipalContext context = new PrincipalContext(ContextType.Domain, "FOOBAR.LOC", @"FOOBAR\Administrator", "password");

UserPrincipal principal = UserPrincipal.FindByIdentity(context, "myuser");
principal.SetPassword("newpassword"); 
```

我在整个互联网上搜索了解决方案，但找不到任何解决方案。

干杯

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-07-18T13:35:56.363

使用 DirectoryEntry 对象设置密码：

```
using (var user = new DirectoryEntry("LDAP://<IP/name>/CN=dummy,DC=corp", 
                                     "<admin>", 
                                     "<admin pass>"))
{
  user.Invoke("SetPassword", new object[] { "password" });
  user.CommitChanges();
} 
```

如本答案所述：[https ://stackoverflow.com/a/4895603/971](https://stackoverflow.com/a/4895603/971)

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-07-18T13:30:18.830

第一个结果：http: [//support.microsoft.com/kb/935677](http://support.microsoft.com/kb/935677)

# visual-studio-2010 - 如何获取 Visual Studio 2010 for MSBuild 使用的命令行？

> ID：11542514
> 
> 赞同：1
> 
> 时间：2012-07-18T13:26:53.880
> 
> 标签：visual-studio-2010, msbuild

有没有办法查看 Visual Studio 2010 用于部署项目的默认命令行参数？

# ajax - 使用 f:ajax 根据选择框更改更新屏幕内容

> ID：11542516
> 
> 赞同：0
> 
> 时间：2012-07-18T13:26:55.367
> 
> 标签：ajax, jsf-2, richfaces

我将 JSF2 与 Richfaces 4 一起使用。

我有以下JSF：

```
<h:panelGrid columns="2" cellspacing="5">
    <h:outputLabel value="#{msg.FrequencyOfSpending}" />

    <h:selectOneMenu id="ruleFrequencyOptions" value="#{Rule.ruleControls.ControlOne.controlParams.Period.valueSelected}" styleClass="commonSelect">
        <f:selectItems value="#{Rule.ruleControls.ControlOne.controlParams.Period.validValues}" itemLabelEscaped="true" />
        <f:ajax event="valueChange" listener="#{Rule.ruleControls.ControlOne.controlParams.Period.valueSelectedChange}" onerror="handleAjaxError" />
    </h:selectOneMenu>
</h:panelGrid>

<a4j:repeat value="#{Rule.ruleParams.Action.properties}" var="RuleParamProperty" id="budgetRuleIterator">

    <h:panelGrid columns="4" cellspacing="5" columnClasses="ruleParamCheckbox, ruleParamAction, ruleParamActionFrequency, ruleParamActionInput">

        <h:selectBooleanCheckbox value="#{RuleParamProperty.selected}">
            <a4j:ajax event="click" listener="#{RuleParamProperty.selectedChange}"  onerror="handleAjaxError" />
        </h:selectBooleanCheckbox>

        <h:outputText value="#{msg[RuleParamProperty.name]}" />

        <h:panelGrid columns="3">
            <h:outputText value="#{msg.Action_1}" />
            <h:outputText value="#{msg[Rule.ruleControls.ControlOne.controlParams.Period.valueSelected]}" id="ruleActionFrequency" class="italic-text" />   
            <h:outputText value="#{msg.Action_3}" />
        </h:panelGrid>

        <h:inputText value="#{RuleParamProperty.inputValue}" />

    </h:panelGrid>

</a4j:repeat> 
```

每次有人从*ruleFrequencyOptions*选择框中选择一个新值时，我都需要在此处反映/显示新值：

```
<h:outputText value="#{msg[Rule.ruleControls.ControlOne.controlParams.Period.valueSelected]}" id="ruleActionFrequency" class="italic-text" /> 
```

*由于 JSF 漂亮的自动生成 Id，为h:outputText* 分配 Id并在 f:ajax 上使用*render*属性不起作用！

是否有一些方法可以附加到*f:ajax*组件来实现这一点？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-07-18T13:41:06.143

试试这个：

```
<h:panelGroup id="toUpdate">
    <a4j:repeat value="#{Rule.ruleParams.Action.properties}" var="RuleParamProperty" id="budgetRuleIterator">
        ...
    </a4j:repeat>
</h:panelGroup> 
```

然后放入`render="toUpdate"`你的`<f:ajax>`.

# internet-explorer - IE 总是错误地在一页上加载相同的 css

> ID：11542518
> 
> 赞同：0
> 
> 时间：2012-07-18T13:26:58.673
> 
> 标签：internet-explorer

IE 将相同的 css 加载到所有页面，但在一页上显示 CSS 错误！每时每刻。当您单击其他页面时，它会加载相同的 CSS，这很好！我不知道为什么它显示错误！当我尝试检查 CSS throe 浏览器（ff、chrome、IE）时，它们显示相同的样式，eaven IE 显示相同的样式和值，但它显示错误的一切

就像他了解 CSS 一样，但并不关心它——而且只针对一页

太令人沮丧了

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-07-18T15:03:13.260

我发现了问题！是 DOCTYPE！写错了

# opengl - 两个连续的 glDrawPixels 是否适用于 alpha 混合？

> ID：11542528
> 
> 赞同：1
> 
> 时间：2012-07-18T13:27:23.937
> 
> 标签：opengl, alphablending

我想将两个 tga 图像与分配的 alpha 通道混合。基础图像和前景图像，前景图像只有几个字符，alpha设置为255，前景图像的其余alpha值设置为0。有了这个前景图像，我可以在基础上添加一些字符图像（只有字符覆盖在基础图像上，前景图像的其余部分是透明的）。我使用一些像这样的OpenGL代码：

```
glBindFramebuffer(GL_FRAMEBUFFER, 0);
glViewport(0, 0, m_width, m_height);
glClearColor(0.0, 0.0, 0.0, 0.0);
glClear(GL_COLOR_BUFFER_BIT | GL_DEPTH_BUFFER_BIT);
glBindBuffer(GL_PIXEL_UNPACK_BUFFER, 0);
glPixelStorei(GL_UNPACK_ALIGNMENT, 1);
glWindowPos3i(0, 0, 0);
// draw the base image to the FBO
glDrawPixels(m_width, m_height, GL_RGBA, GL_UNSIGNED_BYTE, m_base.imageData);
glEnable(GL_BLEND);
glBlendFunc(GL_SRC_ALPHA, GL_ONE_MINUS_SRC_ALPHA); 
glWindowPos3i(0, 0, 0);
// draw the foreground image to blend with the base image
glDrawPixels(m_width, m_height, GL_RGBA, GL_UNSIGNED_BYTE, m_foreground.imageData);
GL_ERROR;
glDisable(GL_BLEND); 
```

问题是它不起作用。该程序只渲染基本图像并且上面没有字符（在前景图像中）？我认为它应该工作，我不知道为什么它没有。我已经测试过了，没有`gl_error`发生。任何机构都可以提供帮助吗？混合功能在设置的背景颜色`glColor`和第一个之间可以正常工作`glDrawPixels`。但是，它在第​​一个和第二个之间不起作用`glDrawPixels`，为什么？

# java - 使用带有 Maven Failsafe 插件的 JUnit 类别

> ID：11542530
> 
> 赞同：11
> 
> 时间：2012-07-18T13:27:41.670
> 
> 标签：java, unit-testing, maven, junit, maven-failsafe-plugin

我正在使用 JUnit 类别将集成测试与单元测试分开。Surefire 插件配置有效 - 它跳过了使用我的标记接口 IntegrationTest 注释的测试。

但是，Failsafe 插件不选择集成测试。我什至尝试指定 junit47 提供程序，但在集成测试阶段运行零测试。

这是 pom.xml 片段：

```
 <plugin>
            <groupId>org.apache.maven.plugins</groupId>
            <artifactId>maven-failsafe-plugin</artifactId>
            <version>2.12</version>
            <executions>
                <execution>
                    <goals>
                        <goal>integration-test</goal>
                    </goals>
                </execution>
            </executions>
            <configuration>
                <groups>com.mycompany.test.IntegrationTest</groups>
                <excludedGroups>com.mycompany.test.UnitTest</excludedGroups>
            </configuration>
            <dependencies>
                <dependency>
                    <groupId>org.apache.maven.surefire</groupId>
                    <artifactId>surefire-junit47</artifactId>
                    <version>2.12</version>
                </dependency>
            </dependencies>
        </plugin> 
```

这是日志的故障安全部分：

```
[INFO] --- maven-failsafe-plugin:2.12:integration-test (default) @ MyProject.war ---
[INFO] Failsafe report directory: /home/stoupa/MyProject/war/target/failsafe-reports
[INFO] Using configured provider org.apache.maven.surefire.junitcore.JUnitCoreProvider

-------------------------------------------------------
 T E S T S
-------------------------------------------------------
Concurrency config is parallel='none', perCoreThreadCount=true, threadCount=2, useUnlimitedThreads=false

Results :

Tests run: 0, Failures: 0, Errors: 0, Skipped: 0 
```

可以在日志输出中看到的提供程序 org.apache.maven.surefire.junitcore.JUnitCoreProvider 是正确的吗？

* * *

## 回答 #1

> 赞同：16
> 
> 时间：2013-08-22T07:08:51.770

默认情况下，故障安全插件会排除各种文件。你必须覆盖它。因此，将您的配置部分更改为以下内容：

```
<configuration>
    <includes>
        <include>**/*.java</include>
    </includes>
    <groups>com.mycompany.test.IntegrationTest</groups>
    <excludedGroups>com.mycompany.test.UnitTest</excludedGroups>
</configuration> 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-07-19T00:23:40.153

**解决方法**

@Categories 会给您带来痛苦，因为您必须标记每个集成测试。

尝试创建如下所述的 inttests 配置文件并跳过肯定执行。

```
 <profile>
        <id>inttests</id>
        <activation>
            <activeByDefault>false</activeByDefault>
        </activation>
        <build>
            <plugins>
                <!-- skip the unit tests -->
                <plugin>
                    <groupId>org.apache.maven.plugins</groupId>
                    <artifactId>maven-surefire-plugin</artifactId>
                    <configuration>
                        <skip>true</skip>
                    </configuration>
                </plugin>
                <plugin>
                    <groupId>org.apache.maven.plugins</groupId>
                    <artifactId>maven-failsafe-plugin</artifactId>
                    <configuration>
                        <includes>
                            <include>**/IT*.java</include>
                        </includes>
                    </configuration>
                </plugin>
            </plugins>
        </build>
    </profile> 
```

使用一些字符串为集成测试添加前缀或后缀，并在包含中给出。默认情况下，故障安全将所有以 IT 为前缀的测试作为集成测试。参考： [故障安全包含和排除](http://maven.apache.org/plugins/maven-failsafe-plugin/examples/inclusion-exclusion.html)

使用 maven profile 命令运行它

```
mvn verify -P inttests 
```

**注意：**在上面提到的方法中，我们需要在构建过程中运行单元测试，然后分别进行 inttests。

**更新：在带有故障安全插件的 JUnit4 类别上**

*   2.12 - 分叉的虚拟机没有说再见就终止了。VM 崩溃或 System.exit 调用？ [https://issues.apache.org/jira/browse/SUREFIRE-827](https://issues.apache.org/jira/browse/SUREFIRE-827)*   2.12.1 - 无法在插件工件列表中找到 surefire-booter [https://issues.apache.org/jira/browse/SUREFIRE-896](https://issues.apache.org/jira/browse/SUREFIRE-896)*   2.12.2 - 当模块中没有测试时有一个错误，它将寻找 failsafe-summary.xml 并失败 [https://issues.apache.org/jira/browse/SUREFIRE-901](https://issues.apache.org/jira/browse/SUREFIRE-901)

# java - Wicket ：检查 CheckGroup 未获得所选选项并执行提交操作

> ID：11542533
> 
> 赞同：2
> 
> 时间：2012-07-18T13:27:51.860
> 
> 标签：java, wicket

我是 WICKET 的新手，并且在使用`PageableListView`.

对于我正在使用的单个复选框`Check`的选择和组选择`CheckGroupSelector`。

现在，尽管使用检查是否我使用 CheckBox，但我的代码工作正常，但无法让 selectall 工作......粘贴这段代码以供参考。

```
 final CheckGroup<DriveInfo> group = new CheckGroup<DriveInfo>("group", new ArrayList<DriveInfo>());
    driveSearchForm.add(group);
    group.add(new CheckGroupSelector("allSelected"));
    group.setOutputMarkupId(true);

    PageableListView<DashboardModel> pageableListView = new PageableListView<DashboardModel>("searchResults",
            driveDataModel, 50) {
        private static final long serialVersionUID = 1L;

        @Override
        protected void populateItem(ListItem<DashboardModel> item) {
            DashboardModel model = item.getModelObject();
            item.add(new Check("selected", new PropertyModel(model, "selected")));
            item.add(new Label("name", item.getModelObject().getName()));
            item.add(new Label("status", item.getModelObject().getStatus().toString()));
            item.add(new Label("driveUrl", item.getModelObject().getDriveURL()));
        }
    };
    pageableListView.setReuseItems(true); 
```

现在代替

```
item.add(new Check("selected", new PropertyModel(model, "selected"))); 
```

如果我使用

```
item.add(new CheckBox("selected", new PropertyModel(model, "selected"))); 
```

它工作正常......但我应该如何让 selectall(ie `CheckGroupSelector`) 也工作。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-07-18T18:13:35.210

模型`Check`必须保存将插入`CheckGroup`列表的对象，在您的情况下，是一个`DriveInfo`实例。似乎您正在传递一个布尔（选定）值，而不是要选择的对象。

# c# - 使用 AJAX 或 ASP.NET 进行异步调用？

> ID：11542535
> 
> 赞同：2
> 
> 时间：2012-07-18T13:27:55.417
> 
> 标签：c#, asp.net, ajax, asp.net-mvc, asynchronous

# 语境

我有这个函数可以在一个表和几个远程 IIS 之间同步一个站点列表：

```
namespace Dashboard.Controllers
{
    public class SiteController : Controller
    {
        public ActionResult Synchronize()
        {
            SiteModel.synchronizeDBWithIIS();

            return Content("Cool.");
        }
    }
} 
```

我想在仪表板启动和运行时异步调用此函数。

# 问题

*   你建议我做一个`$.get()`（jQuery）还是使用`AsyncResult`（ASP.NET）？

*   可以用`Application_start()`在`Global.asax`吗？

*   此外，我可以改进这个控制器以加快同步速度吗？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-07-18T14:25:59.617

以上都不是。这是您根本不应该在 ASP.NET 应用程序中做的事情。您可以阅读以下有关此危险的文章： http: [//haacked.com/archive/2011/10/16/the-dangers-of-implementing-recurring-background-tasks-in-asp-net.aspx](http://haacked.com/archive/2011/10/16/the-dangers-of-implementing-recurring-background-tasks-in-asp-net.aspx)

这应该在单独的应用程序中完成。例如，您可以使用 Windows 任务调度程序定期运行此应用程序，它会负责执行此冗长的操作。

在 ASP.NET 应用程序中，没有什么比长时间阻塞工作线程更糟糕的了。在 ASP.NET 应用程序中实现这一点的唯一可能可接受的解决方案是使用 I/O 完成端口。然后你可以使用[AsyncController](http://msdn.microsoft.com/en-us/library/ee728598.aspx)。但据我所知，您`SiteModel.synchronizeDBWithIIS();`是一种阻塞方法，因此无法完成。

但是，如果您`SiteModel`提供了一个异步 API 来执行 I/O 密集型任务（不是 CPU 密集型任务），那么它的实现方式如下：

```
public class SiteController : AsyncController
{
    public void SynchronizeAsync()
    {
        AsyncManager.OutstandingOperations.Increment();

        SiteModel.GetHeadlinesCompleted += (sender, e) =>
        {
            AsyncManager.OutstandingOperations.Decrement();
        };

        SiteModel.synchronizeDBWithIISAsync();
    }

    public ActionResult SynchronizeCompleted()
    {
        return Content("Cool.");
    }
} 
```

一旦你这样做了，无论你是使用 AJAX 调用还是普通调用来调用 Synchronize 操作，这并不重要。重要的是这个动作现在是异步的并且不会阻塞工作线程。它将这一点委托给底层 API，该 API 目前执行冗长的 I/O 操作，使用流、套接字、数据库连接上的 BeginXXX、EndXXX 方法......重要的是要了解，如果您的 API 尚未实现这样，您不能只将同步方法包装在新线程或异步委托中并在那里执行它。我的意思是你可以，但你这样做绝对没有任何收获。

备注：不要误以为这会让你的操作更快。这没有奇迹。该操作将花费与以前完全相同的时间。只是在执行期间不会危及 ASP.NET 工作线程，并且您的其他请求将执行得更快。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-07-18T14:15:52.270

两者用于不同的目的。从您所描述的内容来看，听起来您想使用`AsyncResult`异步执行方法调用。

# iphone - 如何使用 takePicture 方法显示带有自定义相机叠加层的图像编辑屏幕

> ID：11542538
> 
> 赞同：0
> 
> 时间：2012-07-18T13:27:57.120
> 
> 标签：iphone, objective-c, ios, overlay, uiimagepickercontroller

在我的应用程序中，我必须显示一个自定义的相机叠加层。它显示得很完美。在那个视图上，我有一个按钮，它点击`takePicture`负责从相机捕获图像的方法。

我的问题是拍摄照片后，我需要显示我们使用默认相机时显示的图像编辑屏幕。

请帮助我如何显示当相机叠加层为零时从相机拍摄图像后出现的图像编辑屏幕，但在我的情况下，有必要自定义相机叠加层。

所以请建议我如何使用自定义相机叠加视图显示图像预览（编辑）屏幕。

任何帮助将不胜感激！提前致谢。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-07-18T13:32:02.947

```
- (void)presentCamera{    
    UIImagePickerController *cameraUI = [[[UIImagePickerController alloc] init] autorelease];
    cameraUI.allowsEditing = YES;
    cameraUI.delegate = self;

    if ([UIImagePickerController isSourceTypeAvailable:UIImagePickerControllerSourceTypeCamera]){
        cameraUI.sourceType = UIImagePickerControllerSourceTypeCamera;
        cameraUI.mediaTypes = [NSArray arrayWithObject:(NSString *) kUTTypeImage];
    }
    else{ //camera not available
        //promt the user about camera's unavailability
        return;
    }
    [self presentModalViewController:cameraUI animated: YES];
} 
```

注意`cameraUI.allowsEditing = YES;`

# ssrs-2008 - 添加到主报告时子报告的问题

> ID：11542541
> 
> 赞同：2
> 
> 时间：2012-07-18T13:28:05.093
> 
> 标签：ssrs-2008

我有一个包含子报表的报表，主报表是根据参数值动态创建的，我有一个包含文本框的子报表，当添加到给定参数上显示的主报表时，这个子报表的问题和它崩溃其他！！！，知道当这个子报表为空时（数据集不返回行）显示在一个参数上并且其他参数是隐藏的............我需要这个子报表显示即使为空且不折叠

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-01-16T06:20:23.057

假设即使您没有从主报告参数中获得任何值，您也希望继续显示子报告的文本框，我建议您：

在子报表中创建一个表，并删除行（只保留标题），然后将其用作文本框（因为在这种情况下，您可以将数据集直接链接到表属性中的表）。

接下来，在表格单元格中输入以下表达式

`=iif(RowNumber(Nothing) < 1, " ", Field!yourData.Value)`- 这样您的表格将始终有一个值，并且子报表不会折叠

# php - 在php过滤器清理之前或之后保留文本区域的换行符

> ID：11542543
> 
> 赞同：0
> 
> 时间：2012-07-18T13:28:10.650
> 
> 标签：php, line-breaks, sanitize

我很难理解如何去做。我在标签中有内容，我想将其保存在数据库中。我使用 FILTER_SANITIZE_STRING 来逃避 XSS 攻击，但是它摆脱了我的 textarea 内容中的换行符。

我想知道如何清理我的内容（防止 XSS 风险）但仍然保留中断，以便我可以将其添加到我的数据库并从数据库中将其从数据库中拉出，而中断完好无损

谢谢 ：）

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-07-18T13:52:54.097

您可以替换其 HTML 实体的所有换行符`&#x000A;`- 当输出为 HMTL 时将显示为换行符。但是，如果您想要数据库中的可读内容，则必须将它们返回到原始换行符。

# httpresponse - Jboss7.1 更改服务器横幅响应头

> ID：11542548
> 
> 赞同：0
> 
> 时间：2012-07-18T13:28:17.683
> 
> 标签：httpresponse, jboss7.x

出于某些安全原因，在项目中正常的服务器横幅标头

服务器：Apache-Coyote/1.1

需要更改，我尝试在standalone.xml 系统属性中添加以下内容

```
<property name="org.apache.coyote.http11.Http11Protocol.SERVER" value="secureserver"/> 
```

但这似乎不起作用，是否有任何其他设置或属性更改来实现这一点？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-07-19T02:58:27.430

根据[此页面](http://docs.jboss.org/jbossweb/7.0.x/sysprops.html)，您尝试这样做的方式是正确的。

请检查您是否遵循了文档中指定的以下行

> 或编辑standalone.xml 并在扩展名之后添加：

# mule - 是否可以在一处声明所有出站 jms 消息都应具有某些出站属性？

> ID：11542555
> 
> 赞同：1
> 
> 时间：2012-07-18T13:28:29.687
> 
> 标签：mule

我希望我的出站 jms 消息（到队列或主题）包含某些出站属性。是否可以在一个地方（例如，在连接器级别）说明这一点？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-07-18T16:48:51.230

为此，您必须：

*   扩展`org.mule.transport.jms.transformers.ObjectToJMSMessage`并使其将所需的属性添加到它创建的 JMS 消息中，
*   将此自定义转换器注册为所考虑的 JMS 连接器的新默认出站转换器：

    ```
    <jms:connector name="jmsConnector">
        <service-overrides outboundTransformer="apackage.IpAddingObjectToJMSMessage"/>
    </jms:connector> 
    ```

这是自定义转换器的代码：

```
package apackage;

import java.net.InetAddress;

import javax.jms.Message;

import org.mule.api.MuleMessage;
import org.mule.api.transformer.TransformerException;
import org.mule.config.i18n.MessageFactory;
import org.mule.transport.jms.transformers.ObjectToJMSMessage;

public class IpAddingObjectToJMSMessage extends ObjectToJMSMessage
{
    @Override
    public Object transformMessage(final MuleMessage message, final String outputEncoding)
        throws TransformerException
    {
        final Message jmsMessage = (Message) super.transformMessage(message, outputEncoding);

        try
        {
            jmsMessage.setStringProperty("IP", InetAddress.getLocalHost().getHostAddress());
        }
        catch (final Exception e)
        {
            throw new TransformerException(
                MessageFactory.createStaticMessage("Failed to add IP address to JMS message"), e);
        }

        return jmsMessage;
    }
} 
```

# php - DOMDocument getElementsByTagName 不起作用

> ID：11542557
> 
> 赞同：1
> 
> 时间：2012-07-18T13:28:34.683
> 
> 标签：php, xml-parsing, domdocument

我正在尝试使用该`DOMDocument`函数`getElementsByTagName()`，但它一直返回一个空对象。我正在使用以下代码：

```
// Create some HTML
$output = '
<html>
   <body>
      <a href="foo">Bar</a>
   </body>
</html>';

// Load the HTML
$dom = new DOMDocument;
$dom->loadHTML($output);

// Find all links (a tags)
$links = $dom->getElementsByTagName('a');

var_dump($links); // object(DOMNodeList)#31 (0) { } - empty object 
```

我错过了什么？查看文档，看起来我正在正确使用该功能。

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2012-07-18T13:31:11.650

那`var_dump`只是说你有一个`DOMNodeList`对象。遍历列表，您会看到它在那里：

```
foreach( $links as $a) {
     echo $a->nodeName . ' ' . $a->nodeValue;
} 
```

这将输出：

```
a Bar 
```

因为它是一个`<a>`标签，它的内容是`Bar`.

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-07-18T13:31:03.867

不确定您对 的期望是什么`var_dump`，但该元素包含在该节点列表中，如您所见：

```
var_dump($links->item(0));
//object(DOMElement)#3 (0) {}
var_dump($links->item(0)->getAttribute("href"));
//string(3) "foo" 
```

# sockets - 指定连接到 PHP CLI 套接字服务器的客户端的远程 IP 地址

> ID：11542563
> 
> 赞同：3
> 
> 时间：2012-07-18T13:28:52.637
> 
> 标签：sockets, php, clients

我有 php cli socket 服务器，代码如下；客户端连接并发送请求

```
<?php
// PHP SOCKET SERVER
error_reporting(E_ERROR);
// Configuration variables
$host = "127.0.0.1";
$port = 5600;
$max = 500;
$client = array();

// No timeouts, flush content immediatly
set_time_limit(0);
ob_implicit_flush();

// Server functions
function rLog($msg){
             $msg = "[".date('Y-m-d H:i:s')."] ".$msg;
             echo($msg."\n");

}
// Create socket
$sock = socket_create(AF_INET,SOCK_STREAM,0) or die("[".date('Y-m-d H:i:s')."] Could not create socket\n");
// Bind to socket
socket_bind($sock,$host,$port) or die("[".date('Y-m-d H:i:s')."] Could not bind to socket\n");
// Start listening
socket_listen($sock) or die("[".date('Y-m-d H:i:s')."] Could not set up socket listener\n");

rLog("Server started at ".$host.":".$port);
// Server loop
while(true){
             socket_set_block($sock);
             // Setup clients listen socket for reading
             $read[0] = $sock;
             for($i = 0;$i<$max;$i++){
                          if($client[$i]['sock'] != null)
                                       $read[$i+1] = $client[$i]['sock'];
             }
             // Set up a blocking call to socket_select()
             $ready = socket_select($read,$write = NULL, $except = NULL, $tv_sec = NULL);
             // If a new connection is being made add it to the clients array
             if(in_array($sock,$read)){
                          for($i = 0;$i<$max;$i++){
                                       if($client[$i]['sock']==null){
                                                    if(($client[$i]['sock'] = socket_accept($sock))<0){
                                                                 rLog("socket_accept() failed: ".socket_strerror($client[$i]['sock']));
                                                    }else{
                                                                 rLog("Client #".$i." connected");
                                                    }
                                                    break;
                                       }elseif($i == $max - 1){
                                                    rLog("Too many clients");
                                       }
                          }
                          if(--$ready <= 0)
                          continue;
             }
             for($i=0;$i<$max;$i++){
                          if(in_array($client[$i]['sock'],$read)){
                                       $input = socket_read($client[$i]['sock'],1024);

                                        if($input){

                                                    rLog("Client ".$i." Call:".$input.")");

                                                    ## <<<<<<<<<<< Clients Request Show Here >>>>>>>>>>>> ##
                                                    ## <<<<<<<<<<< Clients Request Show Here >>>>>>>>>>>> ##
                                                    ## <<<<<<<<<<< Clients Request Show Here >>>>>>>>>>>> ##
                                                    ## <<<<<<<<<<< Clients Request Show Here >>>>>>>>>>>> ##
                                                    ## <<<<<<<<<<< Clients Request Show Here >>>>>>>>>>>> ##

                                        }
                          }
             }
}
// Close the master sockets
socket_close($sock);
?> 
```

***问题：***
-**如何检测连接到我的 php cli 套接字服务器的客户端的 IP 地址？**

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-07-18T13:39:39.433

在您成功呼叫的线路之后，立即`socket_accept()`呼叫[`socket_getpeername()`](http://php.net/manual/en/function.socket-getpeername.php)：

```
if (($client[$i]['sock'] = socket_accept($sock)) < 0) {
    rLog("socket_accept() failed: ".socket_strerror($client[$i]['sock']));
} else {
    rLog("Client #".$i." connected");
    socket_getpeername($client[$i]['sock'], $address, $port);
} 
```

`$address`现在包含远程主机的 IP 地址，并`$port`包含远程端口。随心所欲地处理这些信息。

# android - vpn 以编程方式 android

> ID：11542570
> 
> 赞同：2
> 
> 时间：2012-07-18T13:29:09.843
> 
> 标签：android, http, proxy, header, vpn

我想创建拦截 android 设备的所有 http 请求的 android 应用程序，并将一些修改应用于 http 请求标头。

可能吗 ？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-07-18T13:36:35.753

Android SDK 内置了对制作您自己的 VPN 的支持，请查看[http://developer.android.com/reference/android/net/VpnService.html](http://developer.android.com/reference/android/net/VpnService.html)看看它是否真的可行。您最好的选择是配置 VPN，然后在服务器端进行修改。

# .net - 如何在 VS 2010 中打开 .NET 2.0 项目而不进行转换？

> ID：11542571
> 
> 赞同：2
> 
> 时间：2012-07-18T13:29:11.020
> 
> 标签：.net, visual-studio-2010

一旦我在 VS1010 中打开项目，向导就会开始升级到 .net 4.0。我需要将这些项目保留在 .net 2.0 中，而无需迁移到 .net 4.0。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-07-18T13:33:27.970

VS2010 的项目文件格式比 VS2005 更新，所以需要自己转换项目文件。

但是您仍然可以使用 VS2010 来定位较旧的框架版本

右键单击项目 -> 属性 -> 应用程序选项卡，然后您可以选择目标框架：

![在此处输入图像描述](../Images/1d13c1ddd6d9ab4356b7c73cf2b0d167.png)

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-07-18T13:34:32.993

转换是为了支持较新 IDE 中的更改 - 不一定与更改目标框架有关。

显然这被称为**往返**，目前不支持：

[为什么 Visual Studio 2010 会转换我的项目](http://blogs.msdn.com/b/visualstudio/archive/2010/03/15/why-does-visual-studio-2010-convert-my-projects.aspx)

但是，一旦转换，您可以在项目属性下将框架重新定位回版本 2。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-07-18T13:35:47.223

好吧，您可以更改目标框架..这不是框架的迁移，而是项目的迁移，它仅转换项目定义。

因此，您可以继续进行迁移过程，然后更改目标框架。这不会对您的项目产生任何不良影响。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2012-07-18T13:35:49.150

它没有改变框架版本，而是改变了 Visual Studio 版本。仅当您想在早期版本的 VS 中打开转换后的解决方案时才重要。

基本上它与解决方案和项目文件中的 xml 混淆，因此新的 VS2010 IDE 选项可以工作。

如果您需要从早期版本的 VS 访问它们，那么如果 sln 或 prj 文件发生更改，例如添加新的类/项目等，您将会做一些混乱。

# node.js - 如何使用 process.nextTick 进行测试

> ID：11542577
> 
> 赞同：2
> 
> 时间：2012-07-18T13:29:36.640
> 
> 标签：node.js, testing, asynchronous, mocha.js, sinon

我正在使用[Mocha](http://visionmedia.github.com/mocha/)测试一些[Node.js](http://nodejs.org/)代码，并想用它[`process.nextTick()`](http://nodejs.org/api/process.html#process_process_nexttick_callback)来调用方法的回调。

## 编码

```
 @getNouns: (callback) ->
    @_wordnik.randomWords(
      includePartOfSpeech: 'noun',
      (e, result) ->
        throw new Error('Wordnik Failed') if e
        process.nextTick ->
          callback(result)
    ) 
```

## 考试

```
it 'should call a callback with the response', (done) ->
      sinon.stub(Word._wordnik, 'randomWords').yields(null, [
                              {id: 1234, word: "hello"},
                              {id: 2345, word: "foo"},
                              {id: 3456, word: "goodbye"}
                            ]
                          )

      spy = sinon.spy()

      Word.getNouns (result) -> spy(result); done(); null

      expect(spy).have.been.calledWith [
        {id: 1234, word: "hello"},
        {id: 2345, word: "foo"},
        {id: 3456, word: "goodbye"}
      ] 
```

由于某种原因，`done()`当我运行 mocha 时，我得到了一个被调用两次的错误。如果我在[`process.nextTick()`](http://nodejs.org/api/process.html#process_process_nexttick_callback).

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-07-19T15:43:10.980

`expect(spy).have.been.calledWith`在通过调用间谍之前，您的测试正在调用`spy(result)`。

我假设当期望失败时，`done`第一次调用（测试完成并失败）。在下一个滴答声中，`done`再次从您的`getNouns`回调中调用。

您不需要间谍检查传递给`getNouns`回调的值，您可以在回调中立即执行断言。

```
sinon.stub(Word._wordnik, 'randomWords').yields(null, [
                          {id: 1234, word: "hello"},
                          {id: 2345, word: "foo"},
                          {id: 3456, word: "goodbye"}
                        ]
                      )

Word.getNouns (result) ->
  expect(result).to.deep.equal [
    {id: 1234, word: "hello"},
    {id: 2345, word: "foo"},
    {id: 3456, word: "goodbye"}
  ]
  done() 
```

# javascript - Firefox 中的多参数关键字搜索不适用于此 URL

> ID：11542581
> 
> 赞同：1
> 
> 时间：2012-07-18T13:29:58.073
> 
> 标签：javascript, firefox, keyword-search

我试图让多参数搜索在 Firefox 中工作。

这需要使用[此处](http://kb.mozillazine.org/Multiple_parameter_keyword_searches)的 Javascript 代码。

我一直在尝试理解代码并使其适用于 Maven 中央存储库搜索。[这](http://search.maven.org/#search%7Cga%7C1%7Cg%3ajtidy%20a%3ajtidy)是我尝试通过关键字搜索执行的示例搜索。用我的搜索 URL替换*###INSERT YOUR KEYWORD SEARCH URL HERE###*后： `http://search.maven.org/#search|ga|1|g%3A%s%20a%3A%s`我得到以下书签代码：

```
javascript:var%C2%A0s='%s';%20url='http://search.maven.org/#search|ga|1|g%3A%s%20a%3A%s';%20t='';%20qc=0;%20chunks=url.split('%s');%20for(i=0;%20i<s.length;%20i++){if(s.charAt(i)=='"')qc=qc^1;%20t+=((s.charAt(i)=='%20'&&qc)?'^':s.charAt(i));%20}args=t.split(/\s/);%20nurl='';%20for(i=0;%20i<chunks.length;%20i++){nurl+=chunks[i];%20if(args[i]!=undefined)%C2%A0{args[i]=args[i].replace(/\^/g,'%20');%20nurl+=args[i];%20}}location.replace(nurl,'<%20BR>'); 
```

但不幸的是，这似乎不起作用。我试图在 Firebug 中调试美化的、未编码的代码，但我无法理解它的作用：

```
var s = '%s';
url = 'http://search.maven.org/#search|ga|1|g:%s a:%s';
t = '';
qc = 0;
chunks = url.split('%s');
for (i = 0; i < s.length; i++) {
    if (s.charAt(i) == '"') qc = qc ^ 1;
    t += ((s.charAt(i) == ' ' && qc) ? '^' : s.charAt(i));
}
args = t.split(/\s/);
nurl = '';
for (i = 0; i < chunks.length; i++) {
    nurl += chunks[i];
    if (args[i] != undefined) {
        args[i] = args[i].replace(/\^/g, ' ');
        nurl += args[i];
    }
}
location.replace(nurl, '< BR>'); 
```

似乎我的搜索 URL 的明显复杂性扰乱了上述书签。mozillaZine KB 文章中提到的[错误 124237](https://bugzilla.mozilla.org/show_bug.cgi?id=124237)也有一个书签生成器，它生成与上面完全相同的代码。

如果我能得到关于可能出了什么问题的提示，那就太好了。

谢谢！

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-08-09T15:42:22.507

我认为问题在于较新版本的 Firefox 不允许从位置栏执行代码。从小书签执行的代码有效，但关键字替换将 javascript url 放置在位置栏中（并且没有任何反应）。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2015-02-23T22:12:32.867

这些天我想知道为什么我的多参数关键字搜索不再起作用了。然后我发现他们只是在空白/新标签上不起作用：[https ://superuser.com/questions/382631/multiple-parameter-keyword-searches-in-firefox-or-chrome#comment618307_396619](https://superuser.com/questions/382631/multiple-parameter-keyword-searches-in-firefox-or-chrome#comment618307_396619)

# python - 带有子剪辑的 Python 分支

> ID：11542583
> 
> 赞同：0
> 
> 时间：2012-07-18T13:30:01.043
> 
> 标签：python, eclipse, subclipse

我正在研究使用 Subclipse 插件在 Eclipse 中分支 python 包。我可以在物理上很好地分支，当我在 Eclipse 中使用调试和运行功能时会出现问题。它不会改变进口的来源；举个例子……

```
PythonProject > trunk > test > __init__.py
                               main.py
                               message.py 
```

main.py 包含：

```
from test.message import message
print message 
```

message.py 包含：

```
message = "Hello world!" 
```

是`__init__`空的。

分支时：

```
PythonProject > branches > 1 > test > __init__.py
                               main.py
                               message.py 
```

main.py 包含：

```
from test.message import message
print message 
```

message.py 包含：

```
message = "Hello earth!" 
```

但是当我运行调试或从分支 main.py 运行时，我得到“Hello world！” 打印。我需要 Eclipse 来获取新的 PYTHONPATH。我知道这可以用`sys.path.append`/来完成，`sys.pah.insert`但我希望有一个更巧妙的解决方案。

希望这是有道理的。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-07-18T13:34:19.057

您可以在 Eclipse 中为分支创建单独的项目，并以`PYTHONPATH`不同的方式设置它们。可能还有另一种更老套的方法（也可能是一种非老套的方式），但项目的想法是它是一个有凝聚力的单元。根据定义，不同的分支不是一个有凝聚力的整体的一部分。

# r - 按列名引用时间序列对象

> ID：11542584
> 
> 赞同：13
> 
> 时间：2012-07-18T13:30:01.143
> 
> 标签：r, time-series

我有一个`test`具有列名的数据框对象：

```
> test
       a     b     c     d     e
1  -0.67 -0.02 -0.10 -0.22 -0.32
2   0.46 -1.51 -0.79  0.26  1.19
3   0.22 -0.18 -1.40  0.41 -0.32
4  -2.21  0.79  0.36  1.00 -0.51
5  -0.69  0.39 -0.76 -0.73 -0.43 
```

`test$b`在这种格式中，我可以使用符号轻松访问列。我可以毫无困难地将其转换为时间序列对象：

```
test.ts <- ts(test, frequency=<value>, start=<value> 
```

但是，一旦它是一个`ts`对象，是否有任何简单的方法可以按名称而不是按列号访问列（或行）？该`test.ts`对象仍然具有列名信息，通过使用显示`colnames`：

```
> colnames(test.ts)
[1] "a" "b" "c" "d" "e" 
```

但是，`test.ts$b`不起作用。请注意，我所说的“容易”是指不写一些丑陋的东西`test.ts[,which(colnames(test.ts)=="b"]`，因为这并不容易，那很丑陋。是的，我可以编写自己的函数来做到这一点，但我想知道是否有内置的方法来做到这一点。谢谢！

* * *

按照要求：

```
> dput(head(a))
structure(list(a = c(-0.67, 0.46, 0.22, -2.21, -0.69, -0.45), 
    b = c(-0.02, -1.51, -0.18, 0.79, 0.39, -1.33), c = c(-0.1, 
    -0.79, -1.4, 0.36, -0.76, 0.15), d = c(-0.22, 0.26, 0.41, 
    1, -0.73, -2.23), e = c(-0.32, 1.19, -0.32, -0.51, -0.43, 
    -0.58)), .Names = c("a", "b", "c", "d", "e"), row.names = c(NA, 
6L), class = "data.frame") 
```

* * *

## 回答 #1

> 赞同：13
> 
> 时间：2012-07-18T14:03:45.730

使用其他子集语法：

```
test.ts[, 'b']
#Time Series:
#Start = 1 
#End = 6 
#Frequency = 1 
#[1] -0.02 -1.51 -0.18  0.79  0.39 -1.33 
```

# android - Android警报管理器循环中的多个待处理意图

> ID：11542588
> 
> 赞同：0
> 
> 时间：2012-07-18T13:30:14.783
> 
> 标签：android, alarmmanager, android-pendingintent

我有一个保存在 TimeInterval 对象中的每周计划，它们工作正常。我构建了一个循环，这样我就可以为每个人设置一个警报。我的代码不起作用，我错过了什么？

此外，如何从另一个线程的 BroadcastReceiver 取消这些警报？

```
for(ArrayList<TimeInterval> day : days){
        for(TimeInterval ti : day){
            numberofintents++;
            Intent i = new Intent(getApplicationContext(),ChangeMode.class);
            i.putExtra("ringermode", ti.getRingerMode());

            PendingIntent pending = PendingIntent.getService(getApplicationContext(), id, i,PendingIntent.FLAG_CANCEL_CURRENT);
            Calendar cal = Calendar.getInstance();
            cal.set(Calendar.MINUTE,ti.getMinute()%60);
            cal.set(Calendar.HOUR_OF_DAY,ti.getMinute()/60);
            cal.set(Calendar.DAY_OF_WEEK,dayofweek);
            Log.d(TAG, cal.get(Calendar.HOUR_OF_DAY)+":"+cal.get(Calendar.MINUTE));
            service.setRepeating(AlarmManager.RTC_WAKEUP, cal.getTimeInMillis(), 1000*60*60*24*7, pending);
            id++;
        }
        dayofweek++;
    } 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-03-04T09:33:14.797

首先制作一个待处理意图的数组列表，

```
public static ArrayList <PendingIntent> intentArray= new ArrayList <PendingIntent>(); 
```

然后将待处理的意图添加到数组列表中，

```
for(ArrayList<TimeInterval> day : days){
    for(TimeInterval ti : day){
        numberofintents++;
        Intent i = new Intent(getApplicationContext(),ChangeMode.class);
        i.putExtra("ringermode", ti.getRingerMode());

        PendingIntent pending = PendingIntent.getService(getApplicationContext(), id, i,PendingIntent.FLAG_CANCEL_CURRENT);

        intentarray.add(pending);

        Calendar cal = Calendar.getInstance();
        cal.set(Calendar.MINUTE,ti.getMinute()%60);
        cal.set(Calendar.HOUR_OF_DAY,ti.getMinute()/60);
        cal.set(Calendar.DAY_OF_WEEK,dayofweek);

    AlarmManager alarmManager = (AlarmManager) getSystemService(ALARM_SERVICE);
    alarmManager.set(AlarmManager.RTC_WAKEUP, calendar.getTimeInMillis(),
            pendingIntent);

         id++;
    }
    dayofweek++;
} 
```

现在您的待处理意图存储在数组列表中。

如果您想取消闹钟，

```
alarmManager.cancel(intentArray.get(i)); 
```

# java - Ruby 或 Java 中的 WCF BinaryMessageEncodingBindingElement？

> ID：11542589
> 
> 赞同：-1
> 
> 时间：2012-07-18T13:30:16.570
> 
> 标签：java, ruby-on-rails, ruby, wcf

我有一个由 .NET 客户端使用的现有 WCF 服务，现在正计划由 Ruby/Java 客户端使用（我们的测试框架是用 Ruby 编写的）。

Ruby/Java 中是否有任何支持/库允许我这样做？

谢谢

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-07-18T13:58:40.023

您的问题可能需要重新措辞。据我了解，您有一个由 .NET 客户端使用的现有 WCF 服务，现在正计划由 Ruby/Java 客户端使用。

您可能知道这一点，WCF 允许您为一个服务配置[多个端点](http://msdn.microsoft.com/en-us/library/ms751515.aspx)。因此，我建议为您的非 .NET 客户端创建第二个可互操作的端点。

您最好的选择是使用`BasicHttpBinding`消息`Text`编码。当然，您可以进一步调整，MSDN 在这里为您提供了系统提供的绑定的完整[列表](http://msdn.microsoft.com/en-us/library/ms730879.aspx)。

# c - 为什么我需要线程来实现“基于共享内存的命名管道”？

> ID：11542597
> 
> 赞同：0
> 
> 时间：2012-07-18T13:30:43.597
> 
> 标签：c, operating-system, pipe, shared-memory

在尝试实现`Named pipe`（例如，使用相同共享内存的两个**独立**的不相关进程）时，我一直在阅读我将使用`pthread_atfork`和`atexit`.

我完全同意使用互斥体和信号量——使用它们我们可以决定何时`process A`读/写以及何时`process B`读/写。

但是出于什么原因我想为此使用`pthread_atfork`和线程？

**编辑：**

一个不使用信号量会付出高昂代价的例子：

```
 #include <stdio.h>
#include <string.h>
#include <stdlib.h>
#include <unistd.h>
#include <sys/file.h>
#include <sys/times.h>
#include <sys/stat.h>
#include <semaphore.h>
#include <assert.h>

 // Simple busy-wait loop to throw off our timing.
 void busywait(void)
 {
     clock_t t1 = times(NULL);
     while (times(NULL) - t1 < 2);
 }

 int main(int argc, char *argv[])
 {
     const char *message = "Hello World\n";
     int n = strlen(message) / 2;

     pid_t pid = fork();
     int i0 = (pid == 0) ? 0 : n;
     int i;

     for (i = 0; i < n; i++) {
         write(1, message + i0 + i, 1);
         busywait();
     }
 } 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-07-19T10:56:34.980

没有人说过您必须使用线程来实现命名管道。但是您的库代码*可以*在线程化的项目中使用，因此您可以处理许多特殊情况。正如您可能知道的那样，SysV IPC 对象（如共享内存段）不会在其使用计数下降到时自动删除，`0`除非它们已被标记为销毁。这意味着如果程序使用您的代码创建管道然后由于任何原因崩溃，则管道实现中的 IPC 对象很可能会保留，污染 IPC 命名空间，并消耗宝贵的系统资源。

您提到的两个函数，`pthread_atfork()`用于`atexit()`注册在发生某些事情时执行的回调。`atexit()`注册要在进程以正常方式终止时执行的代码（例如，通过调用`exit(3)`或从返回`main()`）。这使您可以捕获管道未明确关闭的情况并进行必要的清理。

除了在不关闭管道的情况下退出进程外，程序还可能会自行分叉。这也是您必须相应处理的特殊情况。`pthread_atfork()`应该注册三个回调，以便在进行分叉时在各个点调用。

您还应该处理某些操作系统信号，否则这些信号可能最终无法捕获，这可能会在执行适当的清理之前终止程序。

如您所见，编写库比编写程序要复杂得多。在编写程序时，您控制（几乎）所有用例。当您编写一个库时，它可能会用于许多不同的场景，您应该考虑所有这些场景并为所有这些场景做好准备。您应该考虑正确的用法和错误的用法。您应该考虑诸如清理之类的事情，以及如果您的库未正确使用，哪些系统资源可能会滞留。等等等等...

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-07-18T13:42:48.790

粗略地说，您的类似管道的结构应该位于共享内存中（例如，通过 获得`shm_open`）并包含以下成员：

*   一个互斥锁控制对结构的所有访问。
*   一个用于向等待对等方发出信号的条件变量。
*   一些固定大小的缓冲区。
*   当前读写位置的缓冲区的两个偏移量。

读取函数基本上应该是获取互斥体，然后检查是否有数据可供读取，如果没有，则等待条件变量并循环重新检查数据。找到数据后，如果读取可以在缓冲区中容纳更多数据以唤醒可能等待的写入器，则需要向条件变量发出信号。将读取的数据复制到调用者提供的缓冲区中，然后解锁互斥锁。

写函数基本上应该是获取互斥体，然后检查缓冲区中是否还有空间可以写。如果不是，它应该等待条件变量并循环重新检查可写入的空间。一旦找到空间，它应该将数据复制到缓冲区中，向条件变量发出信号以唤醒任何可能正在等待数据的读取器，并解锁互斥锁。

互斥体和条件变量都需要使用进程共享属性创建，您将使用“管道”在进程之间进行通信（不仅仅是同一进程中的线程）。您可能还需要考虑是否要支持多个读取器/写入器以及条件变量是否需要单信号或广播信号语义。有很多方法可以优化行为，但上面的大纲应该给你一个大致的起点。

# java - Maven 插件停止执行而不抛出 MojoExecutionException

> ID：11542600
> 
> 赞同：0
> 
> 时间：2012-07-18T13:30:50.507
> 
> 标签：java, maven, maven-2

我正在写一个 Maven 插件。在 execute() 函数中，我需要实例化另一个类并监视某些活动。当满足某个条件时，我想取消 maven 进程的执行，但我不能只抛出异常，因为上下文会有所不同。这是一些代码，说明了我的意思：

```
public void execute() throws MojoExecutionException {
  new AnotherClass() {
    void monitorForSomething() {
      // cancel execution here
    }
  }.start();
} 
```

据我所知，为了取消构建而标记错误的唯一方法是引发异常，但如果从这个内部类引发这将是无用的，因为异常不会通过 start() 函数升级。除了使用至少说起来很麻烦的线程之外，我还有什么可以使用的吗？如果有一种方法可以通过方法停止构建而不是仅仅抛出异常，那将是非常好的。

# objective-c - 将 UITableViewController 关联到 UITableView

> ID：11542609
> 
> 赞同：0
> 
> 时间：2012-07-18T13:31:08.697
> 
> 标签：objective-c, ios, xcode, uitableview, uiview

我正在开发一个 iOS 应用程序，我需要你们的帮助！

我的主页是一个 UIView，在这个 UIView 中我有一个 UIImageView，...，还有一个 UITableView。

我创建了一个 UITableViewController 类，我需要将这个类关联到我的 UITableView。

我能怎么做 ？

最好的祝福 ！

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-07-18T13:39:20.837

如果我们假设您的“主页”是 RootViewController 类 (.h/.m/.xib)，您将扩展该类以具有 UITableViewDelegate 和 UITableViewDataSource。在 UITableView 的定义中，您将委托和数据源设置为 RootViewController 并添加单元渲染所需的方法。

不需要 UITableViewController。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-07-18T13:40:42.287

你为什么要为它创建一个 UITableViewController。只需创建一个 UIViewController 并将 UITableViewControllerDelegate 和 UITableViewDataSource 附加到它以控制您的 UITableView：

```
 SomeClass : UIViewController <UITableViewControllerDelegate, UITableViewControllerDataSource> 
```

在 viewDidLoad 中，您必须将 tableview 的委托/数据源分配给您的 UIViewController：

```
self.tableView.delegate = self; 
self.tableView.datasource = self; 
```

# javascript - 在模块内的 Knockout.js 视图模型中使用模板

> ID：11542613
> 
> 赞同：0
> 
> 时间：2012-07-18T13:31:13.597
> 
> 标签：javascript, templates, knockout.js

因此，我将旧的 Web 表单应用程序转换为更加模块化，并使用淘汰赛重写了页面。现在我已经完成了所有工作，我想将我的淘汰视图模型导出到一个模块中，但是我遇到了内置模板系统无法渲染模板的问题。

例如

```
<script type="text/javascript">
  var MyPage = (function($, ko) {
    var my = {};
    my.Message = function(message) {
      var self = this;
      self.messageId = message.messageId;
      self.messageText = message.messageText;
    };
    my.MessageViewModel = function() {
      var self = this;
      self.messageArray = ko.observableArray([]);

      self.getMessageArray = function() {
        $.ajax({
          //get message array
          success: function() {
          //map message array and push new my.Message into messageArray
          }
        });
      };
    };
    return my;
  }) (jQuery, ko);
  $(document).ready(function () {
    ko.applyBindings(new MyPage.MessageViewModel());
  });
</script>

<script type="text/html" id="messageTemplate">
  <tr>
    <td data-bind="text: messageId"></td>
    <td data-bind="text: messageText"></td>
  </tr>
</script>

//exert from html

<table>
  <thead>
    <tr>
      <th>Message Id</th>
      <th>Message Text</th>
    </tr>
  </thead>
  <tbody data-bind="template: {name: 'messageTemplate', foreach: messageArray}">
  </tbody>
</table> 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-07-18T13:43:00.477

模板的名称需要像这样引用：

```
<tbody data-bind="template: {name: 'messageTemplate', foreach: messageArray}">
  </tbody> 
```

否则，它会尝试评估`messageTemplate`为变量以确定要使用的模板名称。

# visual-studio-2010 - Visual Studio 2010 的 Python 工具不提供设计视图

> ID：11542614
> 
> 赞同：1
> 
> 时间：2012-07-18T13:31:13.697
> 
> 标签：visual-studio-2010, ironpython

我已经在sharp develop下创建了一个带有iron python和.net的项目，但我想使用该项目与VS 2010一起运行。我已经安装了Visual Studio 2010的python工具。当我构建项目并运行它时，我可以看到执行的程序，这意味着，我可以看到我创建的 GUI，并且菜单也可以工作。

但是，我不能做的是切换到设计器模式并移动一些按钮等，因为没有可用于任何源文件的设计视图。

然而，在源代码中，我看到了具有特定坐标、大小和其他属性的按钮等，但根本没有可以编辑按钮的设计视图。谁能知道问题出在哪里？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-07-18T13:35:59.390

据我所知，VS2010的python工具只是不支持设计器，即设计器无法生成或理解python代码。

从[文档](http://pytools.codeplex.com/wikipage?title=Features%20Projects)

> **WinForms 应用程序**
> 
> 这是一个以“ipyw.exe Program.py”启动的应用程序。该程序将没有控制台窗口。一个典型的用法是启动一个 WinForms 应用程序。Python Tools 目前不为开发 WinForms 应用程序提供任何 WYSIWIG 支持。相反，您需要编写逻辑以在 Python 中创建 UI（有关示例，请参见 IronPython 教程）。

我发现最简单的方法是在 C# 中做 GUI，然后调用 IronPython 类来完成剩下的工作。

我还要注意这个[SO question](https://stackoverflow.com/questions/5853812/gui-development-with-ironpython-and-visual-studio-2010?rq=1)，它似乎表明您可以使用 XAML 在 GUI 中做一些事情

# android - 适用于 Android 的 GCM（Google Cloud Messaging），在 .Net 中编写第 3 方服务器

> ID：11542616
> 
> 赞同：1
> 
> 时间：2012-07-18T13:31:14.640
> 
> 标签：android, .net, google-cloud-messaging

需要一些帮助来使用 .Net 为 Android 实现 GCM（谷歌云消息传递）的 3rd 方服务器。

官方文档给出了使用 servlet-api 和 gcm-server.jar 的指南（用于服务器端的 java helper APIs）。

在 .Net 框架中使用它是否有任何等价物。任何有助于使用 .Net 实施 GCM 的指南？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-07-18T13:35:00.727

GCM 文档包括[第三方服务器要执行的 HTTP 操作](http://developer.android.com/guide/google/gcm/gcm.html#server)，包括请求的结构和响应的结构。您应该能够从 .NET 执行这些 HTTP 操作。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-07-18T13:39:46.047

正如 CommonsWare 所建议的，您应该编写允许发送消息的服务器端代码（Web 服务`HTTP POST`）`https://android.googleapis.com/gcm/send`。

GCM的[文档](http://developer.android.com/guide/google/gcm/gcm.html#server)中提到了响应和请求结构。

# asp.net - IIS7 URL 过滤

> ID：11542617
> 
> 赞同：0
> 
> 时间：2012-07-18T13:31:26.847
> 
> 标签：asp.net, security, iis-7

当用户使用类似的 URL 时，我试图拒绝访问我的网站

```
https://www.mywebsite.com/./somepage.aspx 
```

现在，当我尝试 IIS7 上面的 url 时，它将服务：

```
https://www.mywebsite.com/somepage.aspx 
```

我还在服务器上安装了 urlscan

```
AllowDotInPath=0

[DenyUrlSequences]

..  ; Don't allow directory traversals
./  ; Don't allow trailing dot on a directory name
\   ; Don't allow backslashes in URL
:   ; Don't allow alternate stream access
%   ; Don't allow escaping after normalization
&   ; Don't allow multiple CGI processes to run on a single request 
```

但它仍然允许访问:(

我的测试方法是使用 curl：

```
curl -I https://www.mywebsite.com/./somepage.aspx 
```

我究竟做错了什么？

提前感谢！

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-07-18T13:36:51.243

将您的 web.config 设置为拒绝访问 somepage.aspx 的所有用户，然后只允许授权用户。这取决于您使用的是 Windows Active Directory 授权还是表单授权，但概念仍然相同。

关于如何设置 web.config，[看这里](http://weblogs.asp.net/gurusarkar/archive/2008/09/29/setting-authorization-rules-for-a-particular-page-or-folder-in-web-config.aspx)

另一方面，为什么您的网址中有句点？是当前目录吗？？？

# portlet - JetSpeed2 中的 Portlet 间通信

> ID：11542621
> 
> 赞同：1
> 
> 时间：2012-07-18T13:31:43.870
> 
> 标签：portlet, jetspeed2

我正在寻找在 JetSpeed 客户端中进行 portlet 间通信的代码。我尝试四处浏览，但没有可用的正确 wiki。我知道一种使用 JQuery 的绑定和触发函数的方法，仍然需要检查。还想知道 Jetspeed 内部是否有相同的 API？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2014-06-12T14:43:35.120

这是否为您指明了正确的方向？ [http://portalstepbystep.blogspot.com.au/2011/01/inter-portlet-communication-overview.html](http://portalstepbystep.blogspot.com.au/2011/01/inter-portlet-communication-overview.html)

# c++ - 如何从内核模式 WFP 标注驱动程序调用 NtUserPostMessage？

> ID：11542627
> 
> 赞同：1
> 
> 时间：2012-07-18T13:32:03.677
> 
> 标签：c++, windows, windows-8, driver, wfp

为了将 WFP（Windows 过滤平台）标注驱动程序安装到现有产品中，我需要让它向现有应用程序发送窗口消息。有没有办法从内核模式 WFP 驱动程序执行此操作？

[这里](http://x1machine.blogspot.com/2010_08_01_archive.html)有一种从内核模式驱动程序调用 NtUserPostMessage 的技术，但我不确定它是否适用于 WFP 驱动程序并且它早于 Windows 8，因此它没有新操作系统的正确系统调用地址。

我愿意接受任何发送窗口消息的方法（或者更准确地说，发布它们以便不会有延迟），因为它可以让我不必重新编码现有应用程序的一部分。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2015-12-31T13:19:59.350

我认为最好的方法是在用户模式和内核模式之间建立 IOCTL 接口。您可以使用此方法[https://www.osr.com/nt-insider/2013-issue1/inverted-call-model-kmdf/](https://www.osr.com/nt-insider/2013-issue1/inverted-call-model-kmdf/)。这允许您在用户模式和内核模式之间发送数据。

# c# - 带有 Apple 的 C# MDM 服务器，无法发送推送通知

> ID：11542629
> 
> 赞同：2
> 
> 时间：2012-07-18T13:32:12.857
> 
> 标签：c#, ios, push, apple-push-notifications, mdm

我们正在为 iOS 设备开发 MDM 解决方案。

我们已经能够在网站上安装带有 MDM-Payload 的配置文件，并且我们已经收到了由 iOS 设备发送的 PUT 请求，其中还包含 PushMagic、deviceToken 和其他值。

我们使用以下描述创建了 COMPANY.pem SSL 证书：http: [//www.softhinker.com/in-the-news/iosmdmvendorcsrsigning](http://www.softhinker.com/in-the-news/iosmdmvendorcsrsigning)

我们尝试使用库 push-sharp 发送推送通知： [https ://github.com/Redth/PushSharp](https://github.com/Redth/PushSharp)

我们使用这些命令构建 MDM.p12 文件

```
openssl pkcs12 -export -in ./COMPANY.pem -inkey ./customerPrivateKey.pem -certfile ./CertificateSigningRequest.certSigningRequest -out MDM.p12 
```

发送此通知的程序不会抛出任何错误并正常退出。但是我们没有在我们的设备上收到任何推送通知，也没有通过反馈服务收到任何内容。

另外值得一提的是，我们也尝试使用沙盒服务器和生产服务器。

这是我们使用 push-sharp 库的代码：

```
 using System;
using System.Collections.Generic;
using System.Collections.Specialized;
using System.IO;
using System.Linq;
using System.Text;
using PushSharp;
using PushSharp.Apple;

namespace PushSharp.Sample
{
    class Program
    {
        static void Main(string[] args)
        {

            //Create our service    
            PushService push = new PushService();

            //Wire up the events
            push.Events.OnDeviceSubscriptionExpired += new Common.ChannelEvents.DeviceSubscriptionExpired(Events_OnDeviceSubscriptionExpired);
            push.Events.OnDeviceSubscriptionIdChanged += new Common.ChannelEvents.DeviceSubscriptionIdChanged(Events_OnDeviceSubscriptionIdChanged);
            push.Events.OnChannelException += new Common.ChannelEvents.ChannelExceptionDelegate(Events_OnChannelException);
            push.Events.OnNotificationSendFailure += new Common.ChannelEvents.NotificationSendFailureDelegate(Events_OnNotificationSendFailure);
            push.Events.OnNotificationSent += new Common.ChannelEvents.NotificationSentDelegate(Events_OnNotificationSent);

            //Configure and start Apple APNS
            // IMPORTANT: Make sure you use the right Push certificate.  Apple allows you to generate one for connecting to Sandbox,
            //   and one for connecting to Production.  You must use the right one, to match the provisioning profile you build your
            //   app with!
            //var appleCert = File.ReadAllBytes("C:\\TEMP\\apns-mdm.p12");
            var appleCert = File.ReadAllBytes(@".\MDM.p12");

            //IMPORTANT: If you are using a Development provisioning Profile, you must use the Sandbox push notification server 
            //  (so you would leave the first arg in the ctor of ApplePushChannelSettings as 'false')
            //  If you are using an AdHoc or AppStore provisioning profile, you must use the Production push notification server
            //  (so you would change the first arg in the ctor of ApplePushChannelSettings to 'true')
            push.StartApplePushService(new ApplePushChannelSettings(true, appleCert, "PWD"));

            //String p12File = @".\apns-mdm.p12";
            //String p12Password = "PWD";
            String pushMagicString = "00454668-00B2-4122-A1DC-72ACD64E6AFB";
            //String deviceToken = "27asObngxvVNb3RvRMs3XVaEWC1DNa3TjFE12stKsig=";

            //Configure and start Android GCM
            //IMPORTANT: The SENDER_ID is your Google API Console App Project ID.
            //  Be sure to get the right Project ID from your Google APIs Console.  It's not the named project ID that appears in the Overview,
            //  but instead the numeric project id in the url: eg: https://code.google.com/apis/console/?pli=1#project:785671162406:overview
            //  where 785671162406 is the project id, which is the SENDER_ID to use!
            //push.StartGoogleCloudMessagingPushService(new GcmPushChannelSettings("785671162406", "AIzaSyC2PZNXQDVaUpZGmtsF_Vp8tHtIABVjazI", "com.pushsharp.test"));

            //Configure and start Windows Phone Notifications
            //push.StartWindowsPhonePushService(new WindowsPhone.WindowsPhonePushChannelSettings());

            //Fluent construction of a Windows Phone Toast notification
            //push.QueueNotification(NotificationFactory.WindowsPhone().Toast()
            //.ForEndpointUri(new Uri("http://sn1.notify.live.net/throttledthirdparty/01.00/AAFCoNoCXidwRpn5NOxvwSxPAgAAAAADAgAAAAQUZm52OkJCMjg1QTg1QkZDMkUxREQ"))
            //.ForOSVersion(WindowsPhone.WindowsPhoneDeviceOSVersion.MangoSevenPointFive)
            //.WithBatchingInterval(WindowsPhone.BatchingInterval.Immediate)
            //.WithNavigatePath("/MainPage.xaml")
            //.WithText1("PushSharp")
            //.WithText2("This is a Toast"));

            //Fluent construction of an iOS notification
            //IMPORTANT: For iOS you MUST MUST MUST use your own DeviceToken here that gets generated within your iOS app itself when the Application Delegate
            //  for registered for remote notifications is called, and the device token is passed back to you
            String test = "3d 58 64 4d 90 d3 18 09 22 5c 50 d2 12 16 b5 67 71 1e be 5c 13 6e 41 3c 3e 81 b5 52 30 68 09 a5";
            test = test.Replace(" ", string.Empty);
            Console.WriteLine("Device Token length is: " + test.Length);
            Console.WriteLine("DeviceToken is: " + test);
            Console.WriteLine("PushMagic is: " + pushMagicString);

            DateTime dayAfterTomorrow = DateTime.Now.AddDays(2);
            Console.WriteLine("Expiry date is: " + dayAfterTomorrow.ToString());

            push.QueueNotification(NotificationFactory.Apple()
                .ForDeviceToken(test).WithExpiry(dayAfterTomorrow).WithCustomItem("mdm", pushMagicString));

            //push.Events.RaiseNotificationSent(NotificationFactory.Apple()
            //    .ForDeviceToken(hex).WithCustomItem("mdm", pushMagicString));

            //Fluent construction of an Android GCM Notification
            //push.QueueNotification(NotificationFactory.AndroidGcm()
            //    .ForDeviceRegistrationId("APA91bG7J-cZjkURrqi58cEd5ain6hzi4i06T0zg9eM2kQAprV-fslFiq60hnBUVlnJPlPV-4K7X39aHIe55of8fJugEuYMyAZSUbmDyima5ZTC7hn4euQ0Yflj2wMeTxnyMOZPuwTLuYNiJ6EREeI9qJuJZH9Zu9g")
            //    .WithCollapseKey("NONE")
            //    .WithJson("{\"alert\":\"Alert Text!\",\"badge\":\"7\"}"));

            Console.WriteLine("Waiting for Queue to Finish...");

            //Stop and wait for the queues to drains
            push.StopAllServices(true);

            Console.WriteLine("Queue Finished, press return to exit...");
            Console.ReadLine();
        }

        static void Events_OnDeviceSubscriptionIdChanged(Common.PlatformType platform, string oldDeviceInfo, string newDeviceInfo)
        {
            //Currently this event will only ever happen for Android GCM
            Console.WriteLine("Device Registration Changed:  Old-> " + oldDeviceInfo + "  New-> " + newDeviceInfo);
        }

        static void Events_OnNotificationSent(Common.Notification notification)
        {
            Console.WriteLine("Sent: " + notification.Platform.ToString() + " -> " + notification.ToString());
        }

        static void Events_OnNotificationSendFailure(Common.Notification notification, Exception notificationFailureException)
        {
            Console.WriteLine("Failure: " + notification.Platform.ToString() + " -> " + notificationFailureException.Message + " -> " + notification.ToString());
        }

        static void Events_OnChannelException(Exception exception)
        {
            Console.WriteLine("Channel Exception: " + exception.ToString());
        }

        static void Events_OnDeviceSubscriptionExpired(Common.PlatformType platform, string deviceInfo)
        {
            Console.WriteLine("Device Subscription Expired: " + platform.ToString() + " -> " + deviceInfo);
        }
    }
} 
```

我们使用以下网站将收到的 deviceToken 编码：http://home.paulschou.net/tools/xlate/ [从](http://home.paulschou.net/tools/xlate/) base64 到 HEX。

我们还在 iOS 设备上使用 APS/PC 日志记录配置文件，以通过 IPCU 提供的调试控制台获得更多输出。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-08-02T15:37:42.190

发送到推送通知服务的消息不得包含`aps`密钥。消息应该只包含`PushMagic`作为键值的字符串`mdm`。例如，使用您定义为 的值`pushMagicString`，发送到推送通知服务的消息应如下所示：

```
{"mdm":"00454668-00B2-4122-A1DC-72ACD64E6AFB"} 
```

我没有使用您正在使用的 push-sharp 库。但是，我简要浏览了代码，似乎该`AppleNotificationPayload.ToJson`方法总是`aps`在消息中添加一个键。我建议注释掉第 114 行，然后尝试一下。这是`ToJson`注释掉该行的方法：

```
 public string ToJson()
    {
        JObject json = new JObject();

        JObject aps = new JObject();

        if (!this.Alert.IsEmpty)
        {
            if (!string.IsNullOrEmpty(this.Alert.Body)
                && string.IsNullOrEmpty(this.Alert.LocalizedKey)
                && string.IsNullOrEmpty(this.Alert.ActionLocalizedKey)
                && (this.Alert.LocalizedArgs == null || this.Alert.LocalizedArgs.Count <= 0)
                && !this.HideActionButton)
            {
                aps["alert"] = new JValue(this.Alert.Body);
            }
            else
            {
                JObject jsonAlert = new JObject();

                if (!string.IsNullOrEmpty(this.Alert.LocalizedKey))
                    jsonAlert["loc-key"] = new JValue(this.Alert.LocalizedKey);

                if (this.Alert.LocalizedArgs != null && this.Alert.LocalizedArgs.Count > 0)
                    jsonAlert["loc-args"] = new JArray(this.Alert.LocalizedArgs.ToArray());

                if (!string.IsNullOrEmpty(this.Alert.Body))
                    jsonAlert["body"] = new JValue(this.Alert.Body);

                if (this.HideActionButton)
                    jsonAlert["action-loc-key"] = new JValue((string)null);
                else if (!string.IsNullOrEmpty(this.Alert.ActionLocalizedKey))
                    jsonAlert["action-loc-key"] = new JValue(this.Alert.ActionLocalizedKey);

                aps["alert"] = jsonAlert;
            }
        }

        if (this.Badge.HasValue)
            aps["badge"] = new JValue(this.Badge.Value);

        if (!string.IsNullOrEmpty(this.Sound))
            aps["sound"] = new JValue(this.Sound);

        if (this.ContentAvailable.HasValue)
            aps["content-available"] = new JValue(this.ContentAvailable.Value);

        //json["aps"] = aps;

        foreach (string key in this.CustomItems.Keys)
        {
            if (this.CustomItems[key].Length == 1)
                json[key] = new JValue(this.CustomItems[key][0]);
            else if (this.CustomItems[key].Length > 1)
                json[key] = new JArray(this.CustomItems[key]);
        }

        string rawString = json.ToString(Newtonsoft.Json.Formatting.None, null);

        StringBuilder encodedString = new StringBuilder();
        foreach (char c in rawString)
        {
            if ((int)c < 32 || (int)c > 127)
                encodedString.Append("\\u" + String.Format("{0:x4}", Convert.ToUInt32(c)));
            else
                encodedString.Append(c);
        }
        return rawString;// encodedString.ToString();
    } 
```

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-08-22T17:28:01.450

您是否确保在 MDM 注册期间，您提供的 MDM 有效负载 (PayloadType = com.apple.mdm) 具有正确的主题？

即在您从apple 下载的APN 推送证书中。您会看到类似CN = com.apple.mgmt.external.[GUID] 的内容。这需要与在 MDM 注册期间传递给您的 IOS 设备的值相同。

如果 APN 在消息上传过程中没有给出任何错误，或者反馈服务没有返回表明设备不可用的 deviceID，则应该意味着它将正确地传递到设备。下一阶段是确定 IOS 设备是否设置为通过此主题收听 APN 消息。

您可以尝试将您的设备连接到 XCode 或 IPCU，在控制台日志中，它将包含指示 APN 是否能够使用商定的主题成功传递此消息的日志。

这里还有一篇关于 APN 故障排除的文章 [http://developer.apple.com/library/ios/#technotes/tn2265/_index.html](http://developer.apple.com/library/ios/#technotes/tn2265/_index.html)

上述文章中有一个可下载的配置文件，您可以将其加载到您的设备以进行额外的详细日志记录。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-08-22T16:49:33.917

Push-sharp 库似乎是为应用程序通知而设计的。要使其适用于 MDM 通知，您可以通过以下方式修复功能 AppleNotificationPayload.ToJson，第 114 行

```
if (aps.HasValues == true)
{
    json["aps"] = aps;
} 
```

此修复将确保仅包含应用程序通知的“aps”键。该库可用于 MDM 通知和应用程序通知。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2012-09-06T04:00:49.807

![](../Images/de26a2695f53da6fc6e950b73f1d4370.png)

ios 将忽略“aps”键。你可以看到截图日志。它忽略“aps”并成功执行 clearpasscode 命令。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2014-09-24T09:04:33.013

我也遵循了相同的过程和命令。我在您的代码中注意到的一件事是您评论了从“MessageType：TokenUpdate”收到的 deviceToken

```
//String deviceToken = "27asObngxvVNb3RvRMs3XVaEWC1DNa3TjFE12stKsig="; 
```

并且您正在使用以下变量“test”作为设备令牌来发送推送通知。

```
String test = "3d 58 64 4d 90 d3 18 09 22 5c 50 d2 12 16 b5 67 71 1e be 5c 13 6e 41 3c 3e 81 b5 52 30 68 09 a5";
test = test.Replace(" ", string.Empty); 
```

当我使用来自“MessageType:TokenUpdate”的设备令牌时；pushsharp 给了我错误

> APNS NotificationFailureException -> 8：无效令牌

编辑：

我认为我们需要转换`byte[]`为十六进制字符串；使用以下方法相同：

```
public static string ByteArrayToString(byte[] ba) 
{ 
    StringBuilder hex = new StringBuilder(ba.Length * 2); 
    foreach (byte b in ba) 
        hex.AppendFormat("{0:x2}", b); 

    return hex.ToString(); 
} 
```

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2013-03-27T07:23:32.897

[无法使用 Push Sharp 发送 iOS MDM 推送通知](https://stackoverflow.com/questions/13012266/unable-to-send-ios-mdm-push-notification-using-push-sharp)

这个答案很好用

```
var pushService = new PushService();
// attach event listeners

// override the production/development auto-detection as it doesn't
// work for MDM certificates
var cert = null; // load your push client certificate
var channel = new ApplePushChannelSettings(true, cert, true);
pushService.StartApplePushService(channel);

// create and send the notification
var notification = NotificationFactory
    .Apple()
    .ForDeviceToken("your-device-token-received-from-checkin")
    .WithExpiry(DateTime.UtcNow.AddDays(1))
    .WithCustomItem("mdm", "your-push-magic-received-in-checkin");
pushService.QueueNotification(notification); 
```

# javascript - 带有验证的 JQuery 分页

> ID：11542631
> 
> 赞同：2
> 
> 时间：2012-07-18T13:32:17.997
> 
> 标签：javascript, jquery, validation

我想知道是否有人遇到过可能发生验证事件的 JQuery 分页脚本，如果验证成功则加载到所选的下一页，否则让 JS Validator 指出错误并阻止加载下一页。基本上我正在编写一些具有问卷类型表单的代码，并且某些字段需要验证。

目前我正在使用 www.xarg.org 分页脚本并添加了一些代码以允许对各种字段元素进行验证，但他的代码似乎在 onSelect 发生之前首先触发 onFormat （onSelect 是我的验证开始的地方）所以虽然错误出现在第 1 页上，您接下来选择的链接突出显示，我试图避免。

到目前为止，如果有人可以建议或推荐其他解决方案，我已经在这里（ [http://rkcr.recruitment.saint-dev.co.uk/form_stackoverflow.html ）上传了我的代码。](http://rkcr.recruitment.saint-dev.co.uk/form_stackoverflow.html)

另外，请注意，我不是一个铁杆 JS 开发人员，而是为了维持生计而努力工作：-|

谢谢

拉吉

# flash - 如何访问 Actionscript 2 中的子元素？

> ID：11542639
> 
> 赞同：0
> 
> 时间：2012-07-18T13:32:37.460
> 
> 标签：flash, actionscript-2

我有以下 Flash 结构。

```
Main Timeline
---test_menu (Movie Clip)
------test_menu_sub (Movie Clip)
---------submenu_item (Button) 
```

在主时间轴（第 2 帧）上，我添加了以下代码：

```
test_menu.test_menu_sub.submenu_item.onPress = function () {
     trace("clicked");
} 
```

但是，这不起作用。如何访问 actionscript 2 中的子元素或影片剪辑？请参阅以下文件以供参考。

*   佛罗里达州：[https ://dl.dropbox.com/u/92494048/test.fla](https://dl.dropbox.com/u/92494048/test.fla)
*   SWF：[https ://dl.dropbox.com/u/92494048/test.swf](https://dl.dropbox.com/u/92494048/test.swf)

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-08-31T10:51:10.463

这是已知问题，尤其是在创建 As2 横幅时。在 As2 中，您不能让像 onPress 这样的按钮事件作用于影片剪辑以及嵌套在其中的影片剪辑。

这里有关于 As2 按钮的很好的解释： [http ://www.senocular.com/flash/tutorials/buttoncapturing/](http://www.senocular.com/flash/tutorials/buttoncapturing/)

但是我决定完全解决这个问题。这是使用上述文章中的功能修改的源文件： [http ://www.baruckis.com/my-files/stackoverflow/11542639/test.fla](http://www.baruckis.com/my-files/stackoverflow/11542639/test.fla)

我希望它会有所帮助！;)

# python - 如何让 Django 单元测试全部从同一个测试数据库中检索？

> ID：11542640
> 
> 赞同：0
> 
> 时间：2012-07-18T13:32:43.503
> 
> 标签：python, database, django, unit-testing

目前，当我在 Django 上运行一组单元测试时，每个测试都会创建自己的数据库。这意味着遍历站点的多个功能都需要用户注册、登录等。如果它们都从同一个临时数据库中获取会更简单——无论如何要这样做？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-07-18T14:52:54.497

这是 Django 事务测试用例在每次测试后执行回滚的默认行为。

但是，没有什么能阻止您拥有模块功能、测试用例方法或重写`TestCase.setUp()`以动态创建测试数据。事实上，每当您发现自己在重复代码时，例如创建用户并使用他的凭据登录测试客户端，您应该找到一种方法使这些位可在项目的测试用例中重用。

# java - 缺少课程日期选择器

> ID：11542652
> 
> 赞同：2
> 
> 时间：2012-07-18T13:33:20.197
> 
> 标签：java, android, datepicker

我正在使用 IntelliJ IDEA 11.1.2 开发一个 android 应用程序，我的输入表单上需要 datepicker。但是，当我插入它时，IDEA 在预览窗口中给出“Missing class DatePicker”警告，我在手机上启动应用程序时它崩溃了。如果我删除 datepicker 元素，应用程序可以正常工作。

我使用 android 2.2 作为目标平台，使用 java 1.6 作为 java SDK。

这是我的表单的源代码：

```
<?xml version="1.0" encoding="utf-8"?>
<LinearLayout xmlns:android="http://schemas.android.com/apk/res/android"
    android:id = "@+id/l_main"
    android:orientation="vertical"
    android:layout_width="fill_parent"
    android:layout_height="fill_parent"
    >
<TextView
    android:text="Some text: "
    android:layout_width="fill_parent"
    android:textSize="@dimen/fnt_size"
    android:layout_height="wrap_content"
    />
<EditText
    android:id="@+id/source"
    android:layout_width="fill_parent"
    android:layout_height="wrap_content"
    />
<TextView
    android:text="Some text: "
    android:layout_width="fill_parent"
    android:textSize="@dimen/fnt_size"
    android:layout_height="wrap_content"
    />
<EditText
    android:id="@+id/destination"
    android:layout_width="fill_parent"
    android:layout_height="wrap_content"
    />
<TextView
    android:text="Some text: "
    android:layout_width="fill_parent"
    android:textSize="@dimen/fnt_size"
    android:layout_height="wrap_content"
    />
<DatePicker
    android:id="@+id/date"
    android:endYear="2011"
    android:startYear="2011"
    android:layout_width="fill_parent"
    android:layout_height="wrap_content" />
<Button
    android:id="@+id/submitBtn"
    android:text="Search"
    android:layout_width="@dimen/btn_size"
    android:textSize="@dimen/fnt_size"
    android:layout_height="wrap_content" />
</LinearLayout> 
```

我怎么解决这个问题？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-07-18T14:46:32.620

**更新：**我已经为此问题[提交了错误报告（Android <= 2.3）。](http://code.google.com/p/android/issues/detail?id=35151)

因此，我能够重现您拥有的案例。事实上， *IDEA*表明存在一些问题并且应用程序正在崩溃。使用 Eclipse 将无济于事（选中它） -那里的*图形布局*视图也会发出信号，表明它无法创建`DatePicker`对象。

### 根本原因

您的问题出现在设备上`android:startYear`并且`android:endYear`不包括当前年份（2011-2011 年不包括 2012 年-当前年份）。

这可能是`DatePicker`实现中的一个错误（在 API 11 之前），它[尝试使用当前日期初始化小部件，](http://grepcode.com/file/repository.grepcode.com/java/ext/com.google.android/android/2.3.7_r1/android/widget/DatePicker.java/#167)`android:startYear`无论是否`android:endYear`定义包含当前年份的范围。

### 解决方案

因为您使用的是 API 级别 9，所以没有`android:minDate`或`android:maxDate`属性（在 API 11 中引入）。因此，要将日期选择限制在任何年份范围内（上述错误的解决方法），您可以实现自己的`OnDateChangedListener`.

带注释的示例代码：

```
public class MyActivity extends Activity
{
    /** Called when the activity is first created. */
    @Override
    public void onCreate(Bundle savedInstanceState)
    {
        super.onCreate(savedInstanceState);
        setContentView(R.layout.main);
        DatePicker datePicker = (DatePicker) findViewById(R.id.date);

        final int MIN_YEAR = 2011;
        final int MAX_YEAR = 2011;

        datePicker.init(MIN_YEAR /* initial year */,
                        01 /* initial month of year */,
                        01 /* initial day of month */,
                new DatePicker.OnDateChangedListener() {
                    @Override
                    public void onDateChanged(DatePicker datePicker,
                                              int year,
                                              int monthOfYear,
                                              int dayOfMonth) {

                        // Override changing year to anything different from outside the range <MIN_YEAR, MAX_YEAR>
                        if (year < MIN_YEAR) {
                            datePicker.updateDate(MIN_YEAR, monthOfYear, dayOfMonth);
                        } else if (year > MAX_YEAR) {
                            datePicker.updateDate(MAX_YEAR, monthOfYear, dayOfMonth);
                        }
                    }

                });
    }
} 
```

# iphone - 使用 Core Graphics 绘制图形线

> ID：11542655
> 
> 赞同：0
> 
> 时间：2012-07-18T13:33:25.333
> 
> 标签：iphone, ios, ipad, graph, core-graphics

我正在尝试绘制一个显示在 imageview 上的随机图形，我尝试使用此代码

```
-(void)createGraph{
        UIGraphicsBeginImageContext(self.drawImage.frame.size);
        [drawImage.image drawInRect:CGRectMake(0, 0, drawImage.frame.size.width, drawImage.frame.size.height)];    
        CGContextRef context    = UIGraphicsGetCurrentContext();
        CGContextSetStrokeColorWithColor(context, [UIColor redColor].CGColor);
        CGContextSetLineWidth(context, 2.0);
        int i = 0;
        while (i<=20) {
            int r = rand() % 100;

            CGContextMoveToPoint(context, 20, 320);
            CGContextAddLineToPoint(context, linePoint.x+20+i*r, linePoint.y+320-i*r);         
            CGContextStrokePath(context);   
            i++;

            NSLog(@"random value %d",r);
        }
        drawImage.image = UIGraphicsGetImageFromCurrentImageContext();
    } 
```

但它在单线上画了一条对角线。已显示在下图中

我期待画一条曲线！使用核心图形 ![在此处输入图像描述](../Images/fb20f81ab1d703d60608277a3a2ebb3c.png)

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-07-18T13:36:05.193

首先，你不能`CGContextAddLineToPoint`进入循环。删除（仅）循环，并在 eg 中创建另一个循环`viewDidLoad`，在每次迭代时，调用`-(void)createGraph`给出最后一个点和下一个点。现在您将分配给的最后一个点`CGContextMoveToPoint`，以及您将分配给的下一个点`CGContextAddLineToPoint`。顺便说一句，在`CGContextBeginPath(context);`后面加上`CGContextSetLineWidth(context, 2.0);`

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-07-18T14:48:24.000

```
- (void)viewDidLoad
{
    //X_Line, Y_Line, x and y are integer variables
    X_Line = 20;
    Y_Line = 320;
    for(int i=0; i<10; i++)
    {
        x = x + arc4random() % 100;
        y = x + arc4random() % 100;
        [self createGraph];
    }
}

-(void)createGraph
{  
    UIGraphicsBeginImageContext(imgView.frame.size);
    [imgView.image drawInRect:CGRectMake(0, 0, imgView.frame.size.width, imgView.frame.size.height)];    
    CGContextRef context = UIGraphicsGetCurrentContext();
    CGContextSetStrokeColorWithColor(context, [UIColor redColor].CGColor);
    CGContextSetLineWidth(context, 2.0);
    CGContextMoveToPoint(context, X_Line, Y_Line);
    CGContextAddLineToPoint(context, x , y);         
    CGContextStrokePath(context);   
    imgView.image = UIGraphicsGetImageFromCurrentImageContext();

    X_Line = x;
    Y_Line = y;
} 
```

# entity-framework - 在 linq 中加入实体并仅返回关系的右侧

> ID：11542658
> 
> 赞同：2
> 
> 时间：2012-07-18T13:33:35.563
> 
> 标签：entity-framework, linq-to-entities, ef-code-first

我有两个具有一对多关系的实体，我正在尝试在子项中选择主实体过滤属性。

例如：

```
public class Pedido
{
    public int Id { get; set; }
    public string Descricao { get; set; }
    public virtual ICollection<PedidoItem> Itens { get; set; }
}

public class PedidoItem
{
    public int Id { get; set; }
    public int PedidoId { get; set; }
    public Pedido Pedido { get; set; }
    public string Descricao { get; set; }
    public int Status { get; set; }
}

public class DataInit : DropCreateDatabaseAlways<Data>
{
    protected override void Seed(Data context)
    {
        context.Pedidos.Add(new Pedido {
            Descricao = "PEDIDO UM",
            Itens = new List<PedidoItem> { 
                new PedidoItem { 
                    Descricao = "ITEM UM", 
                    Status = 0 },
                new PedidoItem{
                    Descricao = "ITEM DOIS",
                    Status = 0 },
                new PedidoItem{
                    Descricao = "ITEM TRES",
                    Status = 0 },
                new PedidoItem{
                    Descricao = "ITEM QUATRO",
                    Status = 1 }
            }
        });

        context.SaveChanges();

        base.Seed(context);
    }

    public DataInit()
    {

    }
}
public class Data : DbContext
{
    public DbSet<Pedido> Pedidos { get; set; }
    public Data()
    {
        Database.SetInitializer(new DataInit());
    }
}

class Program
{
    static void Main(string[] args)
    {
        Data dt = new Data();
        var pedidos = from ped in dt.Pedidos
                      where ped.Itens.Any(item => item.Status == 1)
                      select ped;

        var lista = pedidos.ToList();
    }
} 
```

我在数据库中只有一个 Pedido 实体和一个状态 = 1 的项目，我只想返回集合中状态 = 1 的项目，我该怎么办？

我想返回仅包含一项已过滤的 Pedido 实体（item.Status == 1）

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-07-21T17:41:12.083

准确地得到你想要的东西有点困难，但我认为是这样的：`Pedidos`只有一个`Iten`（项目？）*并且*其中一个项目有`Status == 1`。

那将是：

```
from ped in dt.Pedidos
where ped.Itens.Count() == 1
from it in ped.Itens.Where(i => i.Status == 1)
select ped // or new { ped.Property1, ..., it.Description } 
```

在流利的语法中，这转换为 a `SelectMany`，但这是综合（或查询）语法更容易遵循的情况之一。（虽然 Were 是流利的语法）。

# jquery - 使用 Ajax 的简单 HTML 页面不起作用

> ID：11542660
> 
> 赞同：0
> 
> 时间：2012-07-18T13:33:49.373
> 
> 标签：jquery

我刚刚开始了解 AJAX。为此，我正在尝试在本地计算机上搜索时找到的示例。但它不起作用。

页面加载时页面有一些静态文本，一旦我们向下滚动，使用 ajax 添加新的动态文本，但在滚动时不会添加新文本。

html文件代码为：

```
 <script type="text/javascript" language="javascript">
    $(document).ready(function () {

        $(window).scroll(function () {
            if ($(window).scrollTop() == $(document).height() - $(window).height()) {
                sendData();
            }
        });

        function sendData() {
            $.ajax(
             {
                 type: "POST",
                 url: "https://localhost/kailash/cgi/testing/getdata.pl",
                 data: "{}",
                 contentType: "application/json; charset=utf-8",
                 dataType: "json",
                 async: "true",
                 cache: "false",

                 success: function (msg) {
                     $("#myDiv").append(msg.d);
                 },

                 Error: function (x, e) {
                     alert("Some error");
                 }

             });

        }

    });

</script>
</head>
<body>
<form id="form1" runat="server">
<div id="myDiv">

    <p>
        Static data initially rendered.
    </p> 
```

它调用 getdata.pl。getdata.pl 中的代码是

```
our $resp;
my $cgi = new CGI;
print $cgi->header();

$resp = "<p>This content is dynamically appended to the existing content on scrolling.</p>";
return "$resp\n"; 
```

所以这是行不通的。你能帮我让它工作吗？请让我知道其中缺少什么。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-07-18T13:36:12.213

一种可能性：将您的绝对`https:`URL 更改为相对 URL（例如`/kailash/cgi/testing/getdata.pl`）。通过 AJAX 连接到不同域的唯一方法是使用[JSONP](http://api.jquery.com/jQuery.getJSON/)。

另一种可能性：您的 AJAX 调用从未运行。在成功调用中添加一个`alert()`以确保`sendData()`实际调用它。

这是如何正确使用[的一个示例](http://jsfiddle.net/mblase75/JFpvW/3/)`$.ajax`。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-07-18T13:40:44.830

你确定你的
$("#myDiv").append(msg.d);

，你试过 $("#myDiv").append(msg. responseText); ?

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-07-18T14:24:46.723

我已经解决了这个错误，由于这篇文章的帮助，我的代码中出现了错误： [检查这个](https://stackoverflow.com/questions/1969476/ajax-success-event-not-working)

我取出数据类型字段并仅使用：

```
$("#myDiv").append(msg); 
```

现在我正在获取 ajax 内容。AJAX 真的很酷，当我向下滚动时会添加文本:)。

# java - 从带有html标签的json值中删除不需要的'\'，使用amazonaws json toolkit生成

> ID：11542665
> 
> 赞同：0
> 
> 时间：2012-07-18T13:34:19.950
> 
> 标签：java, json, amazon

我使用 amazonaws library[com.amazonaws.util.json] (java) 生成 json 。我使用如下

```
 private static final String boldHtmlOpenTag = "<b>";
private static final String boldHtmlCloseTag = "</b>";
private static final String italicsHtmlOpenTag = "<i>";
private static final String italicsHtmlCloseTag = "</i>";
    String result = boldHtmlOpenTag + "hello" + boldHtmlCloseTag;
    jsonobj.put("test",result); 
```

我得到的回应是`{"test" : <b> hello<\/b>}`。我需要输出，因为没有`\`. 提前致谢。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-12-17T10:39:19.060

试试这个！

```
result = result.replace("\\\\",""); 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-07-18T13:48:38.070

问题似乎并不存在。我想包含您从其他地方加载的标签的值，并且该值与此转义字符一起存储。

我得出这个结论是因为：

1.  给出的样本不是java，是什么让我觉得你只是为这个问题写了一个伪样本；
2.  amazon json API 没有对转义字符发表任何评论，并且实现是根据 API（我检查过）。

因此，请检查您从哪里获取信息，以及是否没有存储错误的值。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-07-18T13:37:15.283

如果我对你的理解正确，为什么不直接做

```
result = result.replace("\\",""); 
```

**编辑：** 好的，那为什么不这样做：

```
boldHtmlCloseTag = "<&frasl;b>"; 
```

那应该仍然是合法的 JSON。

# jquery - 如何使用jquery将元素添加到前一个元素（追加）

> ID：11542667
> 
> 赞同：-1
> 
> 时间：2012-07-18T13:34:30.293
> 
> 标签：jquery

我在 jquery 中有以下代码：

```
var qtype ="<select id='qtype'><option>qt1 </option><option>qt2</option></select>";
var abc ="<select id='t1'><option>Simple 1</option><option>Simple 2</option></select>";
var xyz ="<select id='t2'><option>Hard</option></select>";
var pqr ="<select id='t3'><option>Diff</option></select>";

$("#qttype").html(qtype);
var qtype=$("qttype"); 
if(qtype== "qt1"){
 $("#t1").change(function(){        
    $("#abc").change(function(){
     $("#divid").html(abc+xyz);
         $("#divid").html(abc+xyz+pqr);

 });  } 
```

但它没有正确附加元素，我的意思是当我更改“简单 1”时，这会显示带有“xyz”的第二个组合框，但是当我再次单击它时，会显示双重附加元素，当我更改组合框值时，我只想显示一次。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-07-18T13:44:36.483

如果你的元素位于你想要追加的位置之后，你应该看看[.before()](http://api.jquery.com/before/)。您也可以使用[.after()](http://api.jquery.com/after/)，尽管在这种情况下您必须选择前一个元素。

*   例子：

    ```
    $("element").before("<p>this p will be added before the 'element'</p>");
    $("element").after(" <p>this p will be added after  the 'element'</p>"); 
    ```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-07-18T15:08:48.003

举个例子，希望对你有帮助！

```
$(document).ready(function(){
    $(document.body).append('<div id="abc"></div>'); // create new #abc and append it directly to body
    $('#abc').append($('<div/>').attr('id','divid').html('hello!'));
    var course = $('<select id="qtype"></select>'); // jquery object containing #qtype
    var abc = '<option value="s">Simple</option>'; // string
    var xyz = '<option value="h">Hard</option>'; // string
    var pqr = '<option value="d">Diff</option>'; // string
    course.append(abc).append(xyz).append(pqr); // triple call of .append()
    //alert("course is " + course + ",\n course[0] is " + course[0] + ' ~ ' + course[0].innerHTML);
    $('#abc').before(course); //insert <select> before #abc
    $('#qtype').change(function(){
        var str = this.options[this.selectedIndex].value;
        str += ' ~ ' + this.options[this.selectedIndex].innerHTML;
        $('#abc').html(str);
    });
}); 
```

示例@ [jsfiddle](http://jsfiddle.net/YGkvs/)，[jquery 网站上的更多详细信息](http://api.jquery.com/category/attributes/)

# google-app-engine - Google App Engine Bulkloader 深度密钥

> ID：11542669
> 
> 赞同：0
> 
> 时间：2012-07-18T13:34:32.587
> 
> 标签：google-app-engine

如何导出一种父键（id 为字符串）？

我有两种。种类 A 和种类 B。种类 B 是种类 A 的子项，当我导出时，我想知道种类 A 的 id。如果我想写 A 的密钥也是一个 id，那么种类 B 的导出转换应该是什么作为B的身份证？

```
- kind: A
  connector: csv
  connector_options:
  property_map:
    - property: __key__
      external_name: key
      export_transform: transform.key_id_or_name_as_string
      import_transform: transform.create_foreign_key('key', key_is_id=True)
- kind: B
  connector: csv
  connector_options:
  property_map:
    - property: __key__
      external_name: key
      export_transform: ????
      import_transform: transform.create_deep_key(('A', 'a', True),
                                                ('B', 'key', True)) 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-07-19T12:42:50.457

这是答案

```
export: 
   - external_name: A
     export_transform: transform.key_id_or_name_as_string_n(0)
   - external_name: B
     export_transform: transform.key_id_or_name_as_string_n(1) 
```

# c++ - 我应该在 C++ 中内联它吗？

> ID：11542675
> 
> 赞同：0
> 
> 时间：2012-07-18T13:35:04.583
> 
> 标签：c++, optimization

我不确定我是否应该内联这个：

```
float bm_softlight (float a, float b) {
    float Da = (a > 0.25f) ? sqrt (a) : ((16*a - 12) * a + 4) * a;
    return (b > 0.5f) ? Da*(2*b - 1) + 2*a*(1-b) : 2*a*b + a*a*(1-2*b);
} 
```

是否足够简单的函数可以并且应该被内联？

谢谢

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-07-18T13:36:34.320

何时内联没有具体答案。`Inline`只是对编译器的提示。所以它可能会忽略它，或者它可能会在没有提示的情况下内联。

在内联的情况下，性能可能会增加和减少。性能可能下降的原因之一是内联增加了代码的一面，它可能变得不那么缓存友好。你应该尝试你的代码，不管`inline`它是否有效。

在找到瓶颈之前不要优化

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2012-07-18T13:36:35.723

由于现代编译器的优化，使用`inline`不是那么明显和透明。有时编译器会自动将一个小函数内联，即使它没有这样声明。另一方面，有时即使您声明它是内联的，它也不会使函数内联。

您无法真正说出这一点，因为您无法说出什么成本更低：函数调用或复制代码（您可以，也许，但这并不容易一目了然）。另一方面，编译器可以很好地管理它。

另外，请记住 Donald Knuth 的一句名言：

> 过早的优化是编程中万恶（或至少是大部分）的根源。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-07-18T13:53:59.510

我认为`sqrt`and 条件将比额外的调用要多得多。无论如何，`inline`只是一个提示。

如果您想将实现分离到源文件中，您是否指定都没有区别`inline`。

如果将定义保留在标头中，则**必须**声明该函数`inline`以防止多个定义。这并不是说该函数实际上会被内联。

# lua - 动态分配对象二维数组lua

> ID：11542679
> 
> 赞同：1
> 
> 时间：2012-07-18T13:35:18.233
> 
> 标签：lua

下面是我正在尝试编写的代码。我正在尝试将对象动态分配给 lua 中的二维数组。它返回一个错误，说尝试在行 grid[i][j]=diceclass.new( ((i+2)/10),((j+2)/10)) 处索引全局 nil 值？有没有办法解决这个问题或我正在尝试做的事情，动态地将一个对象分配给数组的每个元素？

```
local diceClass = require( "dice" )
grid={}
for i =1,5 do
grid[i]=  {}
    for j =1,5 do

        grid[i][j]=diceclass.new( ((i+2)/10),((j+2)/10))
    end
end

--dice class
local dice = {}
local dice_mt = { __index = dice } 

function dice.new( posx, posy) 
a=math.random(1,6)
local newdice = display.newText(a, display.contentWidth*posx,
                                display.contentHeight*posy, nil, 60)

return setmetatable( newdice, dice_mt )
end

return dice 
```

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-07-18T14:41:47.690

`diceClass`不是同一个变量 `diceclass`。

# postgresql - 由于 IPV6 需要 128 位（16 字节），那么为什么在 postgres CIDR 数据类型中存储为 24 字节（8.1）和 19 字节（9.1）？

> ID：11542680
> 
> 赞同：7
> 
> 时间：2012-07-18T13:35:20.203
> 
> 标签：postgresql, ipv6, ipv4, cidr, inet

我正在使用 ipv4 和 ipv6 存储在 postgres db 中。

因为 ipv4 需要 32 位（4 字节）而 ipv6 需要 128（16 字节）位。那么为什么在 postgres CIDR 和 INET 数据类型中，IPV4 和 IPV6（8.1）分别存储为 12 字节和 24 字节。

对于 9.1，IPV4 和 IPV6 分别有 7 个字节和 19 个字节。

我不明白为什么它需要超过 16 个字节来存储 IPV6 和 4 个字节来存储 IPV4？

[http://www.postgresql.org/docs/8.1/static/datatype-net-types.html](http://www.postgresql.org/docs/8.1/static/datatype-net-types.html)

[http://www.postgresql.org/docs/9.1/interactive/datatype-net-types.html](http://www.postgresql.org/docs/9.1/interactive/datatype-net-types.html)

* * *

## 回答 #1

> 赞同：12
> 
> 时间：2012-07-18T19:18:57.663

IP 数据类型的[源代码](http://doxygen.postgresql.org/utils_2inet_8h_source.html)显示如下：

```
typedef struct
{
    unsigned char family;       /* PGSQL_AF_INET or PGSQL_AF_INET6 */
    unsigned char bits;         /* number of bits in netmask */
    unsigned char ipaddr[16];   /* up to 128 bits of address */
} inet_struct; 
```

这意味着，除了“原始”数据`ipaddr`（IP4 为 4 个字节，IP6 为 16 个字节）之外，还有一个字节用于网络掩码，一个字节用于地址族（基本上是 IP4/IP6 的开关）。

此外，还有`varlena`在同一文件中提到的开销：

```
/*
 * Both INET and CIDR addresses are represented within Postgres as varlena
 * objects, ie, there is a varlena header in front of the struct type
 * depicted above.  This struct depicts what we actually have in memory
 * in "uncompressed" cases.  Note that since the maximum data size is only
 * 18 bytes, INET/CIDR will invariably be stored into tuples using the
 * 1-byte-header varlena format.  However, we have to be prepared to cope
 * with the 4-byte-header format too, because various code may helpfully
 * try to "decompress" 1-byte-header datums.
 */
typedef struct
{
    char        vl_len_[4];     /* Do not touch this field directly! */
    inet_struct inet_data;
} inet; 
```

所以 IP4 的等式是这样的：

```
1 byte varlena
1 byte address family
1 byte netmask
4 raw bytes
=========== 
7 byte total 
```

对于 IP6，相同的公式为您提供 19 个字节。

**编辑**PostgreSQL 的旧版本只有 4 字节的 varlena 表示。因此，您可以为每种类型添加 3 个字节（IP4：10，IP6：22）。除此之外，还有一个填充到下一个 4 字节边界。这为每种类型提供 2 个字节，总计 12 或 24 个字节。

[这封邮件](http://archives.postgresql.org/pgsql-patches/2007-02/msg00484.php)为较短版本的开发提供了一些启示。

# java - 使用java中的过滤器记录servlet请求和响应的内容大小

> ID：11542684
> 
> 赞同：1
> 
> 时间：2012-07-18T13:35:36.250
> 
> 标签：java, servlets, size, response, servlet-filters

我正在处理一个 java 项目，现在我被要求跟踪从我们的服务器发送和发送的数据量。因此，我编写了一个过滤器并将其映射到它应该监控的所有呼叫，就像其他人告诉我的那样。该过滤器可以正常工作，但是我在获取响应大小时遇到​​了问题。这是我对 doFilter 的基本实现，我正在使用包装器进行响应。

过滤器：

```
public void doFilter(ServletRequest request,
                       ServletResponse response, FilterChain chain)
      throws IOException, ServletException
  {
    if (filterConfig == null)
      return;

    LogResponseWrapper logResponseWrapper = new LogResponseWrapper((HttpServletResponse) response);
    chain.doFilter(request, logResponseWrapper);

  } 
```

基于在线示例的包装器：

```
public class LogResponseWrapper extends HttpServletResponseWrapper
  {
    public long size = 0;
    public PrintWriter myWriter = null;
    public OutputStream myOutputStream = null;

    LogResponseWrapper(HttpServletResponse response)
    {
      super(response);
    }

    @Override
    public PrintWriter getWriter()
    {
      PrintWriter writer = null;
      try
      {
        System.out.println("calling the writer");
        writer = super.getWriter();
        myWriter = writer;
      }
      catch (Exception e)
      {
        e.printStackTrace();
      }
      return writer;
    }

    @Override
    public ServletOutputStream getOutputStream()
    {
      ServletOutputStream os = null;
      try
      {
        System.out.println("calling the getOutputStream");
        os = super.getOutputStream();
        myOutputStream = os;
      }
      catch (Exception e)
      {
        e.printStackTrace();
      }
      return os;
    }
  } 
```

所以，你看，这是非常基本的并且做了它应该做的事情。但是在调用 chain.doFilter 之后，我似乎无法找出有多少字节被传输到响应中。我已经尝试按照其他人的建议将其转换为 DataOutputStream 和 ByteArrayOutputStream ，但这也不起作用。因此，如果有人对如何执行此操作有任何指示，请随时帮助我。

先感谢您。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-07-18T14:55:41.970

让我们假设所有输出都是使用输出流完成的（不太确定，也许作者也可以直接写）。然后你必须提供一个实际增加你的“大小”计数器的代理。请注意，这可能会影响性能。

然后，您将返回 a`new MyOutputStream(super.getOutputStream())`而不是`super.getOutputStream()`，其中 MyOutputStream 是一个代理，可在关闭时更新您的总数。示例代码（警告：未测试）：

```
private class MyOutputStream extends OutputStream {
    private long written = 0;
    private OutputStream inner;
    public MyOutputStream(OutputStream inner) {
        this.inner = inner;
    }
    public void close() {
        inner.close();
        updateTotals();
    }
    public void flush() {
        inner.flush();
    }
    public void write(byte[] b) {
        write(b, 0, b.length);
    }
    public void write(byte[] b, int off, int len) {
        inner.write(b, off, len);
        written += len;
    }
    public abstract void write(int b) {
        written ++;
        inner.write(b);
    }
} 
```

神奇之处在于“updateTotals”——您可以在其中更新 LogResponseWrapper 的大小。如果这要在多线程环境中执行，您应该添加同步以避免竞争条件。

# sharepoint - SharePoint 审核条目

> ID：11542685
> 
> 赞同：0
> 
> 时间：2012-07-18T13:35:37.467
> 
> 标签：sharepoint, sharepoint-2010, sharepoint-2007

在我的应用程序中，我处理审核日志以获取已更改的项目。获得审计条目后，我运行 SPSiteDataQuery 以获取特定项目的 ListId，因为 SPAuditEntry 不公开该属性。

这可以正常工作，但是对于大量审计条目，它的运行速度非常慢，例如 10K 审计日志需要大约 12 分钟才能运行所有这些数据查询。

我想知道有没有办法扩展开箱即用的审计日志写入，所以在记录过程中它也在日志中写入 ListId？

谢谢，

赫雷尔

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-07-27T11:14:49.873

我不相信审计是可扩展的。但是审计条目确实包含有关审计发生的列表的信息。属性`SPAuditEntry.DocLocation`是否足够？

# git - git：如何忽略所有存在的未跟踪文件？

> ID：11542687
> 
> 赞同：148
> 
> 时间：2012-07-18T13:35:39.510
> 
> 标签：git, gitignore

有没有一种方便的方法可以忽略 git 存储库中所有未跟踪的文件和文件夹？
（我知道`.gitignore`。）

所以`git status`会再次提供一个干净的结果。

* * *

## 回答 #1

> 赞同：278
> 
> 时间：2013-02-28T17:36:12.693

如前所述，要从状态中排除，只需使用：

```
git status -uno  # must be "-uno" , not "-u no" 
```

如果您想永久忽略当前未跟踪的文件，您可以从项目的根目录启动：

```
git status --porcelain | grep '^??' | cut -c4- >> .gitignore 
```

每次后续调用都`git status`将明确忽略这些文件。

**更新**：上面的命令有一个小缺点：如果你还没有`.gitignore`文件，你的 gitignore 会忽略自己！发生这种情况是因为文件是在执行`.gitignore`之前创建的`git status --porcelain`。因此，如果您还没有`.gitignore`文件，我建议您使用：

```
echo "$(git status --porcelain | grep '^??' | cut -c4-)" > .gitignore 
```

这将创建一个子shell，该子shell在创建文件*之前完成。*`.gitignore`

**命令解释**因为我得到了很多选票（谢谢！）我想我最好解释一下命令：

*   `git status --porcelain`使用而不是`git status --short`因为[手动](https://www.kernel.org/pub/software/scm/git/docs/git-status.html)状态“以易于解析的格式为脚本提供输出。这类似于简短的输出，但在 git 版本之间以及无论用户配置如何都将保持稳定。” 所以我们兼具可解析性和稳定性；
*   `grep '^??'`仅过滤以 开头的行`??`，根据[git status 手册](https://www.kernel.org/pub/software/scm/git/docs/git-status.html)，这些行对应于未跟踪的文件；
*   `cut -c4-`删除每行的前 3 个字符，这只是为我们提供了未跟踪文件的相对路径；
*   `|`符号是管道[，](http://en.wikipedia.org/wiki/Redirection_%28computing%29#Piping)它将上一个命令的输出传递给下一个命令的输入；
*   和符号是[重定向运算符](http://en.wikipedia.org/wiki/Redirection_%28computing%29#Variants)`>>`，它们分别将上一个命令的输出附加到文件或覆盖/创建新文件。`>`

**对于那些喜欢[使用`sed`](https://unix.stackexchange.com/a/24151/49405)而不是`grep`and的人的**另**`cut`一种变体，这是另一种方式：**

 **```
git status --porcelain | sed -n -e 's/^?? //p' >> .gitignore 
```

* * *

## 回答 #2

> 赞同：59
> 
> 时间：2016-01-10T17:57:07.653

如果您想永久忽略这些文件，添加它们的简单方法`.gitignore`是：

1.  切换到 git 树的根目录。
2.  `git ls-files --others --exclude-standard >> .gitignore`

这将枚举未跟踪目录中的所有文件，这可能是也可能不是您想要的。

* * *

## 回答 #3

> 赞同：19
> 
> 时间：2012-07-18T13:40:31.167

[在手册](https://git-scm.com/docs/git-status)中找到

> mode 参数用于指定未跟踪文件的处理。它是可选的：默认为 all，如果指定，则必须坚持选项（例如 -uno，但不是 -u no）。

`git status -uno`

* * *

## 回答 #4

> 赞同：6
> 
> 时间：2021-01-22T14:28:44.760

恕我直言，比公认的答案更好的是使用以下内容：

`git config --local status.showUntrackedFiles no`

接受的答案不适用于添加不在其中的新文件时`.gitignore`

* * *

## 回答 #5

> 赞同：4
> 
> 时间：2012-07-18T13:39:51.197

两种方式：

*   使用参数`-uno`. `git-status`这是一个例子：

    ```
    [jenny@jenny_vmware:ft]$ git status
    # On branch ft
    # Untracked files:
    #   (use "git add <file>..." to include in what will be committed)
    #
    #       foo
    nothing added to commit but untracked files present (use "git add" to track)
    [jenny@jenny_vmware:ft]$ git status -uno
    # On branch ft
    nothing to commit (working directory clean) 
    ```

*   或者您可以将文件和目录添加到`.gitignore`，在这种情况下它们将永远不会出现。

* * *

## 回答 #6

> 赞同：3
> 
> 时间：2014-07-17T13:57:51.347

`-u no`也不显示未暂存的文件。 `-uno`按需要工作并显示未上演，但隐藏未跟踪。

* * *

## 回答 #7

> 赞同：2
> 
> 时间：2018-05-02T20:32:42.703

如果**您不在 Unix 之类的**操作系统上，这将在**Windows**上使用**PowerShell**

`git status --porcelain | ?{ $_ -match "^\?\? " }| %{$_ -replace "^\?\? ",""} | Add-Content .\.gitignore`

但是，`.gitignore`文件必须有一个新的空行，否则无论它是否有内容，它都会将文本附加到最后一行。

这可能是一个更好的选择：

`$gi=gc .\.gitignore;$res=git status --porcelain|?{ $_ -match "^\?\? " }|%{ $_ -replace "^\?\? ", "" }; $res=$gi+$res; $res | Out-File .\.gitignore`

* * *

## 回答 #8

> 赞同：1
> 
> 时间：2013-04-23T08:07:22.540

如果您有*很多*未跟踪的文件，并且不想“ `gitignore`”所有这些文件，请注意，从git 1.8.3 (April, 22d [2013) 开始](https://github.com/git/git/blob/master/Documentation/RelNotes/1.8.3.txt#L103-L104)，即使您没有在第一名！`git status``--untracked-files=no`

> " `git status`" 建议用户`--untracked=no`在时间过长时考虑使用选项。

* * *

## 回答 #9

> 赞同：0
> 
> 时间：2020-07-12T18:16:02.197

我来这里是为了解决一个稍微不同的问题。也许这对其他人有用：

我创建了一个新分支`feature-a`。作为这个分支的一部分，我创建了新目录，并且需要修改 .gitignore 来抑制其中的一些。在将新工具添加到创建各种缓存文件夹的项目中时，这种情况经常发生。 `.serverless`,`.terraform`等。

在我准备好将它合并回 master 之前，我还有其他东西出现，所以我`master`再次结帐，但现在再次`git status`拿起那些被抑制的文件夹，因为 .gitignore 尚未合并。

这里的答案实际上很简单，虽然我不得不找到[这个博客](https://jasonrudolph.com/blog/2009/02/25/git-tip-how-to-merge-specific-files-from-another-branch/)来弄清楚：

`feature-a`只需从分支签出 .gitignore 文件

```
git checkout feature-a -- feature-a/.gitignore
git add .
git commit -m "update .gitignore from feature-a branch" 
```**

# asp.net - ASP.NET 中的“名称”属性是如何计算的？

> ID：11542689
> 
> 赞同：0
> 
> 时间：2012-07-18T13:35:44.533
> 
> 标签：asp.net

我试图了解“名称”属性如何适用于通过 ASP.NET 呈现的标记中的元素

IE`<select id="lblxyz" name="ctl00$c$ctl341$lblxyz">`

`ctl00`和是什么 `c`？`ctl1341`

如果我创建 a `WebControl`，给它一个任意 id，然后将 a`Button`放在它的`Controls`集合中，该`name`属性似乎不反映容器的 id？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-07-18T13:40:30.213

您发现的关键是并非所有控件都会触发此行为。关键是[INamingContainer](http://msdn.microsoft.com/en-us/library/system.web.ui.inamingcontainer.aspx)接口。如您所见，只有命名容器将有助于控件的名称，其他控件不会。

上面链接的 MSDN 页面很好地说明了这一点：该接口“标识了一个容器控件，该控件在 Page 对象的控件层次结构中创建了一个新的 ID 命名空间。”

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-07-18T13:45:38.553

您可能对此感兴趣，它概述了生成的 id/名称：[http ://www.mostlylucid.net/archive/2008/11/03/way-too-much-information-on-control-ids-和-asp.net-4.0.aspx](http://www.mostlylucid.net/archive/2008/11/03/way-too-much-information-on-control-ids-and-asp.net-4.0.aspx)

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-07-18T13:42:42.520

生成的名称属性通常始终以 开头`ctl00`，其余的根据控件在控件层次结构中的位置生成。任何实现该接口的父控件`INamingContainer`都将有助于为任何子控件生成的名称。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2012-07-18T13:41:12.520

您可以使用新的 ClientIDMode 控制客户端 ID 的显示方式：

[关于 ASP.NET 4 中的客户端 ID 模式](http://beyondrelational.com/modules/2/blogs/61/posts/11206/all-about-client-id-mode-in-aspnet-4.aspx)

# c - 运行最小 OpenMP 程序时的非法指令

> ID：11542692
> 
> 赞同：8
> 
> 时间：2012-07-18T13:35:52.103
> 
> 标签：c, multithreading, gcc, openmp

这个最小的 OpenMP 程序

```
#include <omp.h>
int main() 
{
  #pragma omp parallel sections
  {
    #pragma omp section
    {
      while(1) {}
    }

    #pragma omp section
    {  
      while(1) {}
    }
  }
} 
```

编译和运行时会产生这个错误`gcc test.c -fopenmp`：

```
Illegal instruction (core dumped) 
```

当我更改任一循环时

```
 int i=1;
  while(i++) {} 
```

或它编译和运行没有错误的任何其他条件。看起来，`1`作为不同线程中的循环条件会导致一些奇怪的行为。为什么？

**编辑：**我正在使用 gcc 4.6.3

**编辑：**这是 gcc 中的一个错误，已作为[错误 54017](http://gcc.gnu.org/bugzilla/show_bug.cgi?id=54017)提交给 gcc 开发人员。

* * *

## 回答 #1

> 赞同：8
> 
> 时间：2012-07-18T15:21:36.133

这显然是 GCC 中的一个错误。`GOMP_sections_start()`GCC 使用例程实现 OpenMP 部分，该例程`libgomp`返回`1`调用线程应执行的基于 - 的部分 ID，或者`0`是否已分发所有工作项。基本上转换后的代码应该如下所示：

```
main._omp_fn.0 (void * .omp_data_i)
{
   unsigned int .section.1;

   .section.1 = GOMP_sections_start(2);
L0:
   switch (.section.1)
   {
      case 0:
         // No more sections to run, exit
         goto L2;
      case 1:
         // Do section 1
         while (1) {}
         goto L1;
      case 2:
         // Do section 2
         while (1) {}
         goto L1;
      default:
         // Impossible section value, possible error in libgomp
         __builtin_trap();
   }
L1:
   .section.1 = GOMP_sections_next();
   goto L0;
L2:
   GOMP_sections_end_nowait();
   return;
} 
```

发生的情况是，在您的情况下， the`default`和`0`case 都导致`__builtin_trap()`. `__builtin_trap()`是一个内置的 GCC，它应该异常终止你的程序，并且在 x86 上它会发出`ud2`使 CPU 发出非法操作码异常的指令。它通常放置在代码永远不应该执行的地方，例如所有可能的正确返回值，`GOMP_sections_start()`并且`GOMP_sections_next()` *应该*被 switch 中的 case 覆盖，如果达到默认值（表明可能存在错误`libgomp`），它应该会失败，你会抱怨开发人员:)

**编辑：**这绝对不是预期的 OpenMP 行为，它不会发生在`icc`or`suncc`中。我已将[错误 54017](http://gcc.gnu.org/bugzilla/show_bug.cgi?id=54017)提交给 GCC Bugzilla。

**编辑 2：**我更新了文本以更准确地反映 GCC 应该产生的内容。看起来 GCC 对并行区域中的控制流产生了错误的印象，并且做了一些进一步破坏代码生成的“优化”。

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2012-07-18T14:46:40.410

SIGILL 生成，因为存在非法指令 ud2/ud2a。根据[http://asm.inightmare.org/opcodelst/index.php?op=UD2](http://asm.inightmare.org/opcodelst/index.php?op=UD2)：

> 该指令导致#UD。英特尔保证，在未来的英特尔 CPU 中，该指令将导致 #UD。当然，所有以前的 CPU (186+) 都会在此操作码上导致 #UD。软件编写者使用此指令测试#UD 异常服务例程。

让我们看看里面：

```
$ gcc-4.6.2 -fopenmp omp.c -o omp
$ gdb ./omp
...

(gdb) r
Program received signal SIGILL, Illegal instruction.
...
0x08048544 in main._omp_fn.0 ()
(gdb) x/i $pc
0x8048544 <main._omp_fn.0+28>:  ud2a

(gdb) disassemble
Dump of assembler code for function main._omp_fn.0:
0x08048528 <main._omp_fn.0+0>:  push   %ebp
0x08048529 <main._omp_fn.0+1>:  mov    %esp,%ebp
0x0804852b <main._omp_fn.0+3>:  sub    $0x18,%esp
0x0804852e <main._omp_fn.0+6>:  movl   $0x2,(%esp)
0x08048535 <main._omp_fn.0+13>: call   0x80483f0 <GOMP_sections_start@plt>
0x0804853a <main._omp_fn.0+18>: cmp    $0x1,%eax
0x0804853d <main._omp_fn.0+21>: je     0x8048548 <main._omp_fn.0+32>
0x0804853f <main._omp_fn.0+23>: cmp    $0x2,%eax
0x08048542 <main._omp_fn.0+26>: je     0x8048546 <main._omp_fn.0+30>
0x08048544 <main._omp_fn.0+28>: ud2a
0x08048546 <main._omp_fn.0+30>: jmp    0x8048546 <main._omp_fn.0+30>
0x08048548 <main._omp_fn.0+32>: jmp    0x8048548 <main._omp_fn.0+32>
End of assembler dump. 
```

汇编文件中已经有 ud2a：

```
$ gcc-4.6.2 -fopenmp omp.c -o omp.S -S; cat omp.S

main._omp_fn.0:
.LFB1:
        pushl   %ebp
.LCFI4:
        movl    %esp, %ebp
.LCFI5:
        subl    $24, %esp
.LCFI6:
        movl    $2, (%esp)
        call    GOMP_sections_start
        cmpl    $1, %eax
        je      .L4
        cmpl    $2, %eax
        je      .L5
                .value  0x0b0f 
```

`.value 0xb0f`是ud2a的代码

在验证 ud2a 是由 gcc 有意插入后（在早期的 openmp 阶段），我试图理解代码。函数`main._omp_fn.0`是并行代码的主体；它将调用 `_GOMP_sections_start` 并解析其返回码。如果代码等于1，那么我们将跳转到一个无限循环；如果为 2，则跳转到第二个无限循环。但在其他情况下 ud2a 将被执行。（不知道为什么，但根据 Hristo Iliev 的说法，这是一个 GCC[错误 54017](http://gcc.gnu.org/bugzilla/show_bug.cgi?id=54017)。）

我认为，这个测试很好地检查了有多少 CPU 内核。默认情况下，GCC 的 openmp 库 (libgomp) 将为系统中的每个 CPU 内核启动一个线程（在我的例子中，有 4 个线程）。部分将按顺序选择：第一部分用于第一个线程，第二部分 - 第二个线程，依此类推。

没有 SIGILL，如果我在 1 个或 2 个 CPU 上运行程序（taskset 的选项是十六进制的 cpu 掩码）：

```
 $ taskset 3 ./omp
 ... running on cpu0 and cpu1 ...
 $ taskset 1 ./omp
 ... running first loop on cpu0; then run second loop on cpu0... 
```

# android - 如果子活动调用父活动，是否会打开一个新实例？

> ID：11542694
> 
> 赞同：1
> 
> 时间：2012-07-18T13:35:56.110
> 
> 标签：android, android-activity

如果一个activity调用它为父activity `startActivity(intent) // Here intent is parent activity`，那么，是会打开一个父activity的新实例还是同样的后台activity出现在前面呢？

我问是因为我的父活动包含一个`ListView`& 我的子活动正在执行更新父活动中的 ListView 的操作。

一旦用户在子活动中按下完成按钮，列表就需要更新。这就是我使用`startActivity`.

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-07-18T13:37:51.900

而不是`startActivity(intent)`在您的父活动中使用，而是使用`startActivityForResult(intent)`。做你打算做的事情会在你的活动堆栈中创建很多父+子活动的实例，这是不好的。

在父活动中，您可以只实现`onActivityResult()`方法，您可以更新您的列表。

你的问题的答案是，是的，如果你这样做，将创建一个父活动的新实例。

# android - android 可以使用 flash manifest 文件（.f4m）直接播放动态 HTTP 流吗

> ID：11542699
> 
> 赞同：1
> 
> 时间：2012-07-18T13:36:08.000
> 
> 标签：android, http, live-streaming

我正在尝试制作一个在 android 上播放实时 http 流的应用程序（我已经在[iphone](https://stackoverflow.com/questions/11473381/trying-to-live-stream-from-aws-fms-to-iphone-using-hls)中做了同样的事情）。Android官方教程展示了一个关于如何进行http直播的示例[代码，我遵循了：](http://developer.android.com/guide/topics/media/mediaplayer.html)

```
public class liveStream extends Activity implements OnClickListener {
    Button streamButton;
    MediaPlayer mediaPlayer = null;

    @Override
    public void onCreate(Bundle savedInstanceState) {
        super.onCreate(savedInstanceState);
        setContentView(R.layout.activity_live_stream);

        streamButton = (Button) findViewById(R.id.streamButton);
        streamButton.setOnClickListener(this);
    }

    @Override
    public boolean onCreateOptionsMenu(Menu menu) {
        getMenuInflater().inflate(R.menu.activity_live_stream, menu);
        return true;
    }

    public void onClick(View v) {       
        String url = "http://d2233avv69kunu.cloudfront.net/hds-live/livepkgr/_definst_/liveevent/livestream.f4m"; 
        mediaPlayer = new MediaPlayer();
        mediaPlayer.setAudioStreamType(AudioManager.STREAM_MUSIC);

        try {
            mediaPlayer.setDataSource(url);
        } catch (IllegalStateException e) {
            e.printStackTrace();
        } catch (IOException e) {
            e.printStackTrace();
        }

        try {
            mediaPlayer.prepare();
        } catch (IOException e) {
            e.printStackTrace();
        }
        mediaPlayer.start();
    }
} 
```

问题是当我尝试准备播放器时，我不断收到 IOException。如果是这样，我如何在没有第三方 Flash 播放器的情况下直接播放实时 http 流？类似于[iphone](https://stackoverflow.com/questions/11473381/trying-to-live-stream-from-aws-fms-to-iphone-using-hls)

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-08-07T10:48:08.520

Android 不支持 Flash 清单文件 (.f4m) 实时流式传输。

[Android 支持的流媒体格式](http://developer.android.com/guide/appendix/media-formats.html)

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-11-08T14:22:52.517

大多数从 2.3 开始的 android 设备都以某种形式原生支持 Apple 的 HLS。在某些设备上，您需要使用 httplive://.../playlist.m3u8 而不是 http://，但据我所知，大多数设备都支持仅使用 http 的 m3u8 URL，尤其是当您通过 Android 3.0

# c# - 动态更改按钮字体颜色c#

> ID：11542701
> 
> 赞同：-3
> 
> 时间：2012-07-18T13:36:09.980
> 
> 标签：c#, button, fonts, colors

我想将按钮的字体颜色动态更改为红色。我怎样才能做到这一点？

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2012-07-18T13:37:09.760

这是你要找的吗？：

```
Button1.ForeColor = Color.Red; //System.Drawing namespace 
```

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-07-18T13:37:16.670

您需要`ForeColor`按钮的属性。

# matlab - 将 MATLAB 图形保存为 PDF，质量 300 DPI，居中

> ID：11542703
> 
> 赞同：8
> 
> 时间：2012-07-18T13:36:14.410
> 
> 标签：matlab, pdf, matlab-figure

我想将 MATLAB 图形保存为 PDF，质量为 300  [DPI](http://en.wikipedia.org/wiki/Dots_per_inch)并居中。

到目前为止，我设法保存了它，但图像似乎被裁剪了。我将页面类型更改为[A3](http://en.wikipedia.org/wiki/ISO_216#A.2C_B.2C_C_comparison)并解决了问题，但我正在寻找更优雅的东西。我是从 GUI 做的，但也许从命令行在 MATLAB 中更容易。

是否有任何软件包或脚本可以使这（出版物和论文的基本任务）更容易一些？

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-07-18T14:34:20.053

尝试使用以下命令：

`print -painters -dpdf -r300 test.pdf`

当然，您必须在当前目录中有一个名为 test.pdf 的文件。

关于 -commands 的一些注释也是如此。

*   -painters：这指定使用画家算法进行导出。
*   -dpdf：指定矢量图像，在这种情况下特别是 pdf。这是通过Ghostscript。
*   -r300：指定 300 dpi 分辨率。-r400 将是 400 dpi，依此类推。

在一个关闭的音符。我倾向于将图形保存为高 DPI tiff 图像，然后将该 tiff 导入另一个程序，在该程序中我实际为论文组装我的图形。我个人倾向于倾向于 CorelDraw。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2014-11-11T09:30:35.717

我建议检查[`exportfig`](http://www.mathworks.ch/matlabcentral/fileexchange/727-exportfig)包裹

```
exportfig(gcf, path_to_file, 'format','pdf','Resolution', 300 ) 
```

此外，您可以检查[`fig`](http://www.mathworks.ch/matlabcentral/fileexchange/30736-fig-the-exact-figure-size-and-no-white-space)包，这很适合在以下之前调用`exportfig`：

```
figure
plot(x,y)
fig
exportfig(gcf, path_to_file, 'format','pdf','Resolution', 300 ) 
```

# php - Magento“告诉朋友”重定向到选项卡内的 404 页面

> ID：11542704
> 
> 赞同：0
> 
> 时间：2012-07-18T13:36:32.197
> 
> 标签：php, magento, friend, tell

我使用下面的代码在产品详细信息页面的选项卡中显示了“告诉朋友”表格

```
<block type="catalog/product_view_tabs" name="product.info.tabs" as="info_tabs" template="catalog/product/view/tabs.phtml" >
          <action method="addTab" translate="title" module="catalog">
     <alias>send-friend</alias>
     <title>Send Friends</title>
     <block>sendfriend/send</block>
     <template>sendfriend/send.phtml</template>
          </action>     
    </block> 
```

我已经启用了允许客人从后端“是”。但是在提交表单时，它会重定向到 404 页面。发送电子邮件的默认方式在选项卡之外可以正常工作，但在选项卡内部则不起作用。我错过了什么吗？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-08-03T16:50:26.853

如果它将您发送到正确的 url，无论您是否来自选项卡，您都应该期望它以相同的方式工作。

我刚刚解决了我的 404 错误

*   在配置 > 系统 > 高级中启用发送给朋友
*   在 Configuration > Catalog > Email to a Friend 中设置“已启用”、“默认模板”、“允许访客”、“Cookie（不安全）”

我收到的网址是[http://www.example.com/sendfriend/product/send/id/14530/](http://www.example.com/sendfriend/product/send/id/14530/)

我的猜测是，这是您模板中的某个问题。

# c# - 使用 c# 在服务器上捕获屏幕截图作为计划任务

> ID：11542717
> 
> 赞同：1
> 
> 时间：2012-07-18T13:37:01.743
> 
> 标签：c#, screenshot, rdp

我编写了以下 c# 代码，并希望将其作为计划任务在服务器上运行。但是，由于这部分代码，我得到了异常。我假设该错误与没有屏幕的事实有关。有没有人找到一种方法将屏幕捕获为计划任务而不连接到远程系统？

```
Bitmap bt;
        // a browser is running  for which screen shot needs to be taken.
            bt = new Bitmap(Screen.PrimaryScreen.Bounds.Width, Screen.PrimaryScreen.Bounds.Height, PixelFormat.Format24bppRgb);//use 24bbp for capture image as AForge supports only 24bpp.
        Graphics screenShot = Graphics.FromImage(bt);

        screenShot.CopyFromScreen(Screen.PrimaryScreen.Bounds.X, Screen.PrimaryScreen.Bounds.Y, 0, 0, Screen.PrimaryScreen.Bounds.Size, CopyPixelOperation.SourceCopy);

        bt.Save(@"C:\folder\test.png", ImageFormat.Png); 
```

因为我在服务器上运行它，它没有连接物理监视器，所以我必须远程连接到服务器。当我手动运行它时，没有错误。但是，当我安排它并从机器上注销时，它会给我以下消息

```
Application: ConsoleAppCaptureScreenshot.exe
Framework Version: v4.0.30319
Description: The process was terminated due to an unhandled exception.
Exception Info: System.ComponentModel.Win32Exception
Stack:
   at System.Drawing.Graphics.CopyFromScreen(Int32, Int32, Int32, Int32,      System.Drawing.Size, System.Drawing.CopyPixelOperation)
   at ConsoleAppCaptureScreenshot.Program.Main(System.String[]) 
```

# java - java.lang.ClassNotFoundException Netbeans java derby

> ID：11542719
> 
> 赞同：2
> 
> 时间：2012-07-18T13:37:05.877
> 
> 标签：java, database, database-connection, derby, javadb

我使用 Netbeans，做一个 java 应用程序。我在 netbeans 中使用 Java DB 为 db connetion 创建了一个 ConnectDB 类。我启动了服务器，十个连接到数据库。当我运行它产生的文件时

```
java.lang.ClassNotFoundException: org.apache.derby.jdbc.ClientDriver @ 25 line 
```

和

```
java.sql.SQLException: No suitable driver found for jdbc:derby://localhost:1527/Libraryprj;create=true 
```

@第 30 行代码

代码如下

```
package Lms;

import java.sql.Connection;
import java.sql.DriverManager;
import java.sql.PreparedStatement;
import java.sql.ResultSet;
import java.sql.Statement;

/**
 *
 * @author JOJO
 */
public class ConnectDB {
  static Connection conn;

  public static void main(String[] args) {
    String driver = "org.apache.derby.jdbc.ClientDriver";
    String connectionURL = "jdbc:derby://localhost:1527/Libraryprj;create=true";
    String createString = "CREATE TABLE Employee (NAME VARCHAR(32) NOT NULL, ADDRESS VARCHAR(50) NOT NULL)";
    try {
      Class.forName(driver);
    } catch (java.lang.ClassNotFoundException e) {
      e.printStackTrace();
    }
    try {
      conn = DriverManager.getConnection(connectionURL);
      Statement stmt = (Statement) conn.createStatement();
      stmt.executeUpdate(createString);

      PreparedStatement psInsert = conn.prepareStatement("insert into Employee values (?,?)");

      psInsert.setString(1, args[0]);
      psInsert.setString(2, args[1]);

      psInsert.executeUpdate();

      Statement stmt2 = (Statement) conn.createStatement();
      ResultSet rs = stmt2.executeQuery("select * from Employee");
      int num = 0;
      while (rs.next()) {
        System.out.println(++num + ": Name: " + rs.getString(1) + "\n Address" + rs.getString(2));
      }
      rs.close();
    } catch (Exception e) {
      e.printStackTrace();
    }
  }
} 
```

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-07-18T13:48:28.117

获取这个库
[http://repo.maven.apache.org/maven2/org/apache/derby/derbyclient/10.9.1.0/derbyclient-10.9.1.0.jar](http://repo.maven.apache.org/maven2/org/apache/derby/derbyclient/10.9.1.0/derbyclient-10.9.1.0.jar)

并将其复制到 Derby 的 libs 文件夹中。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2013-10-16T01:02:36.333

如果您使用 Tomcat，请从[此处](http://mvnrepository.com/artifact/org.apache.derby/derbyclient)下载 derbyclient.jar 。并将 jar 文件复制到 Tomcat 的 lib 文件夹中。

# iphone - Arc：为多个按钮设置对 nil 的引用

> ID：11542720
> 
> 赞同：1
> 
> 时间：2012-07-18T13:37:07.997
> 
> 标签：iphone, ios, xcode, ios5

在 ViewController 中显示诸如按钮之类的项目时，我在头文件中声明它：

```
@property (nonatomic, strong) UIButton *startButton; 
```

在实现文件中合成：

```
@synthesize startButton; 
```

在实现文件中启动它：

```
startButton = [[UIButton alloc] initWithFrame:CGRectMake(100, 100, 100, 100)]; 
```

并在 viewDidUnload 中设置对 nil 的引用：

```
[self setStartButton:nil]; 
```

但是，**如果我有 60 个列出的项目**（在 UIScrollView 中）在循环中动态创建，在 viewDidLoad（从核心数据提供）中呢？（不使用 TableView，因为这些项目非常复杂且具有交互性。）

我应该先在任何地方申报物品吗？**我应该在任何地方将它们设置为零吗？**（或者我应该保持手指交叉，向 Arc 祈祷？）

一些指导将不胜感激。谢谢。

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-07-18T13:59:30.897

您的视图控制器是否具有指向这 60 个项目中的每一个的属性或实例变量？

**是：**然后将这些 ivars 或属性设置为 nil 在您的`-viewDidUnload`.

**不：**那就没什么好担心的了。

ARC 改变*了你*管理内存的方式，但它并没有改变基本理念，即每个对象都应该处理自己对其他对象的引用，而不必担心其他对象的引用。

在这种情况下，包含所有这些项目的视图将对项目具有强引用（通过它的子视图数组）。当视图控制器释放其视图时，该视图将被释放并在该过程中释放其所有子视图。所以所有这些项目都会得到照顾。如果您确实对这些项目中的任何一个有强引用，那么这些引用将阻止被引用的对象被释放——将引用设置为 nil 将避免这种情况。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-07-18T13:55:55.947

如果您正在动态创建这些视图并将它们添加为滚动视图的子视图，那么您无需执行任何其他操作。

当 scrollView 在 期间释放时`-viewDidUnload`，它会正确清理其所有子视图。

* * *

**更新**

这样想吧。在故事板上的普通视图设置中，您不需要为每个视图都有一个属性，只需要与控制器交互的视图即可。这基本上是一样的。您有一堆嵌入到超级视图中的视图。如果控制器不与它们交互，那么您无需担心它们。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-07-18T13:47:31.083

不。:)

**当** `nil` **您**使用`ARC`.

`ARC`当没有更多`strong`指针试图使对象保持活动状态时，将释放当前对象的内存。如果您不将它们设置为您仍在使用它们`nil`的想法，它们将在内存中并且它们将导致严重的内存泄漏。`ARC`

**更新#1**

如果您对按钮有任何参考，这是最简单的方法，您无需设置`nil`任何内容，因为它们的`superview`类`retain`和您应该从它们的`superview`.

```
for (UIView *_subView in self.view.subviews) {
    if ([_subView isKindOfClass:[UIButton class]]) {
        [_subView removeFromSuperview];
    }
} 
```

如果您将它们的指针存储在任何其他地方（`NSArray`例如），您也必须从它们中删除指针。

# c - 如何获取 ip_sf_socklist 的大小

> ID：11542722
> 
> 赞同：0
> 
> 时间：2012-07-18T13:37:09.107
> 
> 标签：c, linux, kernel, sizeof, igmp

在我的代码中，我试图获取 ip_sf_socklist 的大小。唯一的问题是，这个结构是在以下之后定义的（在 igmp.h 中）：

```
#ifdef __KERNEL__ 
```

所以在用户空间，我看不到那个结构。我可以在 /usr/src/linux-headers-xxxx 形式中包含头文件，但这不会很优雅，如果我转向更高的内核可能会导致麻烦。如果我忘记更改这种情况下包含的标题，那会导致一些差异。

有没有一种更简单的方法来获取该结构的大小，这与使用指向最新标头的符号链接（将在 makefile 中更新）不同？

# python - 这个函数在 Python 中有什么作用？

> ID：11542725
> 
> 赞同：0
> 
> 时间：2012-07-18T13:37:17.950
> 
> 标签：python

我是 python 新手。

```
def maintain_delta(new_vals, host, action):
    file_name = build_file_name(host, action)
    err, data = read_values(file_name)
    old_vals = data.split(';')
    new_vals = [str(int(time.time()))] + new_vals
    delta = None
    try:
        err, delta= calc_delta(old_vals, new_vals)
    except:
        err = 2
    write_res = write_values(file_name, ";".join(str(x) for x in new_vals))
    return err + write_res, delta 
```

源github[链接](https://github.com/mzupan/nagios-plugin-mongodb/blob/master/check_mongodb.py)：

据我了解，它从文件中读取数据并添加`time.time()`函数以获取新的 val。做什么`time.time()`？此函数是否生成文件名？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-07-18T13:39:13.067

从[文档](http://docs.python.org/library/time.html#time.time)：

`time.time()` 以浮点数形式返回自纪元以来的时间（以秒为单位）。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-07-18T13:39:37.280

来自[Python 文档](http://docs.python.org/index.html)

[时间.时间（）](http://docs.python.org/library/time.html?highlight=time.time#time.time)

> 以浮点数形式返回自纪元以来的时间（以秒为单位）。请注意，尽管时间始终以浮点数形式返回，但并非所有系统都提供比 1 秒更好的时间精度。虽然此函数通常返回非递减值，但如果系统时钟已在两次调用之间调回，则它可以返回比先前调用更低的值。

值得为这些文档添加书签，我每天都会引用它们很多次。您将能够轻松地回答这些类型的问题。

正如@redrah 在下面的有用评论中提醒我们的那样，`help()`从 Python shell 内部访问还提供了一些有关各种功能的有用的即时在线信息。

# internationalization - Richfaces 文件上传国际化

> ID：11542726
> 
> 赞同：1
> 
> 时间：2012-07-18T13:37:24.987
> 
> 标签：internationalization, richfaces

我对 Richfaces 组件有一个大问题：http: [//livedemo.exadel.com/richfaces-demo/richfaces/fileUpload.jsf](http://livedemo.exadel.com/richfaces-demo/richfaces/fileUpload.jsf)

该组件允许您在应用程序包或您可以创建的“org.richfaces.renderkit”包中设置一些标签。在这里，您可以为您的语言设置 fileUpload_lang.properties。

[https://issues.jboss.org/browse/RF-2784?page=com.atlassian.jira.plugin.system.issuetabpanels:comment-tabpanel](https://issues.jboss.org/browse/RF-2784?page=com.atlassian.jira.plugin.system.issuetabpanels:comment-tabpanel)

问题是，无论是哪种语言，无论是哪种语言（在应用程序的捆绑包或 fileUpload 文件中设置），标签都是从英语中获取的。应用程序中的另一个标签工作正常。

有人知道为什么吗？

# runtime-error - j 脚本运行时错误：需要对象

> ID：11542728
> 
> 赞同：1
> 
> 时间：2012-07-18T13:37:27.903
> 
> 标签：runtime-error, jscript, jscript.net

我正在使用创建在线调查的 Confirmit 平台。这是一个导致运行时错误“需要对象”的脚本节点，如果您能帮我修复它，我将不胜感激。它应该检查问题 q2b 和 q3a 中的某些代码是否为 1 或 2（问题是用函数 f() - f(question id)[code]) 引用 - '//skip ?' 部分。然后它将最多四个代码重新编码为另一个问题（h_q4）以供进一步使用。

```
var flag1 : boolean = false;
var flag2 : boolean = false;

//null
for(var i: int=0; i <9; i++)
{
    var code = i+1;
    f("h_q4")[code].set(null);
}
f("h_q4")['95'].set(null);

//skip ?
for(var k: int=1; k <16; k+=2)
{
    var code = k;
    if(f("q2b")[code].none("1", "2"))
        flag1;
    else
    {
        flag1 = 0;
        break;
    }
}

if(f("q3a")['1'].none("1", "2"))
flag2;

if(flag1 && flag2)
f("h_q4")['95'].set("1");
//recode 
else 
{
    var fromForm = f("q2b"); 
    var toForm = f("h_q4"); 
    const numberOfItems : int = 4; 
    var available = new Set(); 
    if(!flag1)
    {
        for( i = 1; i < 16; i+=2)
        {
            var code = i;

            if(f("q2b")[i].any("1", "2"))
            available.add(i); 
        }
    }
    if(!flag2)
    {
        available.add("9");
    }
    var selected = new Set(); 
    if(available.size() <= numberOfItems) 
    { 
        selected = available; 
    } 
    else 
    { 
        while(selected.size() < numberOfItems) 
        {
            var codes = available.members();
            var randomNumber : float = Math.random()*codes.length;
            var randomIndex : int = Math.floor(randomNumber);
            var selectedCode = codes[randomIndex];
            available.remove(selectedCode);
            selected.add(selectedCode); 
        }
    } 
    var codes = fromForm.domainValues();
    for(var i = 0;i<codes.length;i++) 
    {
        var code = codes[i]; 
        if(selected.inc(code)) 
        { 
            toForm[code].set("1"); 
        }
        else
        { 
            toForm[code].set("0"); 
        } 
    }
} 
```

代码的第一部分 (//null) 清空 'recepient' 问题以简化测试
.set()、.get()、.any()、.none() 都是有效的

# c# - 如何仅在第一次订阅时强制执行对象构造？

> ID：11542729
> 
> 赞同：0
> 
> 时间：2012-07-18T13:37:29.357
> 
> 标签：c#, reactive-programming

迈出 Rx 的第一步，我被困在这里：

```
public class DisposableResourceDemo : IDisposable
{
    public DisposableResourceDemo() {
        Console.WriteLine("DisposableResourceDemo constructor.");
    }

    public void Dispose() {
        Console.WriteLine("DisposableResourceDemo.Dispose()");
    }

    public void SideEffect() {
        Console.WriteLine("DisposableResourceDemo.SideEffect()");
    }
}

[Test]
public void ShowBehaviourOfRxUsing()
{
    var test = Observable.Using(() =>
        {
             // This should happen exactly once, independent of number of subscriptions,
             // object should be disposed on last subscription disposal or OnCompleted call 
                return new DisposableResourceDemo();
        },
        (dr) =>
        {
            return Observable.Create<string>(
                (IObserver<string> observer) =>
                {
                    dr.SideEffect();
                    var dummySource = Observable.Return<string>("Some Text");

                    return dummySource.Subscribe(observer);
                });
        }).Publish().RefCount();

    Console.WriteLine("before 1st subscription.");
    test.Subscribe(Console.WriteLine, () => Console.WriteLine("OnCompleted in 1st."));
    Console.WriteLine("before 2nd subscription.");
    test.Subscribe(Console.WriteLine, () => Console.WriteLine("OnCompleted in 2nd."));
} 
```

令我惊讶的是，上面的代码产生了

```
before 1st subscription.
DisposableResourceDemo constructor.
DisposableResourceDemo.SideEffect()
Some Text
OnCompleted in 1st.
DisposableResourceDemo.Dispose()
before 2nd subscription.
--> [happy with missing "Some Text" here]
OnCompleted in 2nd.
--> [unhappy with second instantiation here] 
DisposableResourceDemo constructor.
DisposableResourceDemo.SideEffect()
DisposableResourceDemo.Dispose() 
```

请注意，在两个订阅之后手动调用 Connect() 不是我想要的，尽管输出符合预期。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-07-25T10:04:42.440

我不完全确定您要在这里实现什么。您似乎想共享可观察序列及其相关资源。因此，执行此操作的标准方法是使用从 .Replay() 和 .Publish() 等获得的 ConnectableObservable 类型

您说您不想使用 .Connect() 而是使用非常常见的 .RefCount() 。但是，您的序列完成。您还使用了扩展方法 Subscribe(...)，它将在内部创建一个自动分离观察者，即当序列完成时，它将断开连接。

所以我的问题是，内部序列真的应该完成吗？如果答案是肯定的，那么为什么第二次订阅会收到 OnComplete 通知……它已经发生了，它已经过去了。也许您确实想重播 OnComplete，在这种情况下，也许 .Replay(1) 就是您想要的。如果答案是否定的，那么您可以通过在 .Publish() 之前或 Observable.Return 之后放置 Concat(Observable.Never<string>()) 来轻松解决此问题。

# c# - 有人可以用简单的术语解释 C# 中的“访问修改后的闭包”吗？

> ID：11542731
> 
> 赞同：8
> 
> 时间：2012-07-18T13:37:29.900
> 
> 标签：c#, closures

> **可能重复：**
> [什么是“关闭”？](https://stackoverflow.com/questions/36636/what-is-a-closure)
> [访问修改的闭包](https://stackoverflow.com/questions/235455/access-to-modified-closure)
> [访问修改的闭包 (2)](https://stackoverflow.com/questions/304258/access-to-modified-closure-2)

Resharper 抱怨以下代码：

```
foreach (string data in _dataList)
    DoStuff (() => field); 
```

什么是闭包？我为什么要关心？

我读过关于数学和函数式编程的闭包，但我在这里不知所措。对我的大脑来说太重了。

简单来说，这里发生了什么？

* * *

## 回答 #1

> 赞同：9
> 
> 时间：2012-07-18T13:43:03.627

[这](http://www.codethinked.com/c-closures-explained)是一个相当好的解释。

当您从委托引用方法主体中的变量时，将创建一个闭包。本质上，生成了一个包含对局部变量的引用的类。
如果变量不断被修改，当外部方法调用委托时，它可能包含不可预知的值，甚至抛出异常。例如，在这样的示例中：

```
foreach (string data in _dataList)
{
    DoStuff (() => data);
} 
```

该方法`() => data`将始终是相同的方法。如果你存储它，你不知道它最终被调用时会发生什么——当时的价值`data`是多少？它甚至会有效吗？如果您使用`yield return`.

一个没有迭代器的更简单的例子是：

```
var x = 5;
Action f = () => Console.WriteLine(x);
x = 76;
f(); 
```

# css - 将单个坐标应用于数百个具有最少 CSS 样式的 div 元素，如何？

> ID：11542733
> 
> 赞同：0
> 
> 时间：2012-07-18T13:37:42.583
> 
> 标签：css, html

在定义 CSS 文件中的所有其他样式元素或页面部分中的样式元素时，是否有某种逻辑效果可以为大量绝对元素中的每一个添加内联位置标签？简单地拥有 a`<div id="divIDname" style="left:100px;top:40px;">`似乎并不有效，但我希望实现小内联样式附加/覆盖“CSS ID”样式元素的逻辑。

我正在为航空预订跟踪系统类型布局制作一天计划，并将一天中的 17 小时分解为代表 15 分钟块的元素，多架飞机的时间（每个 A/C 在它自己的线路上）。我已将每一个都设为单个父级中的绝对参考，以简化在整个规划器页面上的放置。

我将把实际预订作为更高层次的元素分层放在这个计划器上，因此我需要确切地知道 15 分钟元素中的每一个元素在父元素中的位置。为此，我使用绝对定位（数学构造的坐标和在 PHP 循环中生成的 html 等）放置了每个规划器 15 分钟的元素。

我的问题变成了如何将不同的边框样式和 :hover 伪类应用于元素，而无需为每个 15 分钟的块元素定义单独的 CSS 样式，因为每个元素都有自己独特的 left 和 top 属性。我使用内联样式作为一种解决方法，但是由于输出量巨大，PHP 代码的 HTML 输出和可读性使得很难解决我的 PHP 脚本中的逻辑错误，而且我无法应用 :hover 伪类内联，并且随着从列表中添加和删除飞机，行数（以及因此 15 分钟的块元素）将随着新行的添加或删除而改变。

服务器是一个简单的 WAMP 实现，没有 jscript 或 PHP 以外的其他编程脚本。

我不是一个经验丰富的程序员，只是承担了一个相当具有挑战性的项目来尝试重新学习和构建我粗略的 HTML 和 PHP 知识，所以请对答案保持温和... :)

任何帮助将不胜感激。

问候

Braedon King，澳大利亚汤斯维尔

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-07-19T09:46:26.167

简单的答案似乎是内联样式扩展了 css 类，并且不适用于 ID 类型 css 样式。使用 class 而不是 id 似乎已经成功了。

`<div class="xyz" style="left: 100px; top:100px;">`. 作品

`<div id="xyz" style="left: 100px; top:100px;">`. 不工作。

感谢所有人的回应，让我明白了这一点。

问候

布雷登

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-07-18T16:16:50.093

你应该添加一个 css 。

css会是这样的，

```
#div_id1, #div_id2 ,#div_id3   ....... , #div_id99,#div_id100{left:100px;top:40px;} 
```

现在为哪个 div 定义你想要的额外样式，

例子：

```
#div_id50{ define which extra style you want} 
```

# java - 滚动条上方的 JXTable 和标题单元格

> ID：11542736
> 
> 赞同：1
> 
> 时间：2012-07-18T13:37:54.270
> 
> 标签：java, swing, jtable, swingx, jxtable

JTable 和 JXTable 有一个在滚动条上方生成的标题单元格。这是一个小单元格，但我想用它来呈现图标和弹出菜单。我如何访问此标题单元格？

谢谢

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-07-18T13:58:19.220

In JXTable, the property to set is the columnControl: basically, it can be any component you like. To keep the functionality of the default, you can subclass ColumnControlButton

# php - SOAP 和 PHP 不起作用 | 未捕获的 SoapFault 异常：[HTTP] 获取 http 标头时出错

> ID：11542737
> 
> 赞同：-1
> 
> 时间：2012-07-18T13:37:54.567
> 
> 标签：php, soap

有这个代码：

```
set_time_limit(100);
ini_set('user_agent', 'Mozilla/5.0 (Macintosh; Intel Mac OS X 10.7; rv:13.0) Gecko/20100101 Firefox/13.0.1');
ini_set('default_socket_timeout', 100);
ini_set('soap.wsdl_cache_enabled', 0);

echo '<plaintext style="font-size:20px;">';

$client = new SoapClient('http://www.test/?wsdl', array(
    'soap_version'  => SOAP_1_2,
    'cache_wsdl'    => WSDL_CACHE_NONE,
    'use'           => SOAP_LITERAL,
    'style'         => SOAP_DOCUMENT,
    'user_agent'    => 'Mozilla/5.0 (Macintosh; Intel Mac OS X 10.7; rv:13.0) Gecko/20100101 Firefox/13.0.1',
    'connection_timeout' => 120
));

// $result = $client->ValidaRut(array(
$result = $client->__call('ValidaRut', array(
    'rut'       => 11111111,
    'dv'        => '1',
    'cup'       => '1',
    'ipserver'  => gethostbyname($_SERVER['SERVER_NAME']) ,
    'ipcliente' => $_SERVER['REMOTE_ADDR']
)); 
```

但是不工作，php 说：致命错误：未捕获的 SoapFault 异常：[HTTP] Error Fetching http headers in /home/.../test.php:1

发生什么了？对不起我的英语。数据转储：

```
print_r($client->__getFunctions());
Array
(
    [0] => ValidaRutResponse ValidaRut(ValidaRut $parameters)
)

print_r($client->__getTypes());
Array
(

    [0] => struct ValidaRut {
 double rut;
 string dv;
 string cup;
 string ipserver;
 string ipcliente;
}
    [1] => struct ValidaRutResponse {
 boolean ValidaRutResult;
}
    [2] => int char
    [3] => duration duration
    [4] => string guid
) 
```

安全模式已关闭。我使用 WHM/cPanel，安装了库。谢谢。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-07-20T19:37:03.490

对不起，服务器出现故障。

# java - 通过覆盖 paintComponent () 来缩放 JLabel

> ID：11542738
> 
> 赞同：1
> 
> 时间：2012-07-18T13:37:57.513
> 
> 标签：java, swing, zooming, jlabel, paintcomponent

## 考虑这个小的可运行示例：

```
import java.awt.Color;
import java.awt.Graphics;
import java.awt.Graphics2D;
import java.awt.event.MouseWheelEvent;
import java.awt.event.MouseWheelListener;
import java.util.ArrayList;
import javax.swing.JFrame;
import javax.swing.JLabel;
import javax.swing.JPanel;

public class Test2 extends JFrame implements MouseWheelListener{
        ArrayList<JLabel> lista = new ArrayList<JLabel>();
        JPanel p;
        double d = 0.1;
        Test2(){
        p=new JPanel();
        _JLabel j = new _JLabel("Hello");
        j.setOpaque(true);
        j.setBackground(Color.yellow);
        p.add(j);
        p.setBackground(Color.blue);
        add(p);
        this.setVisible(true);
        this.setSize(400,400);
        addMouseWheelListener(this);
        setDefaultCloseOperation(EXIT_ON_CLOSE);
    }
    public static void main(String args[]){
        new Test2();
    }
    private class _JLabel extends JLabel{

        _JLabel(String s){
            super(s);
        }

        protected void paintComponent(Graphics g) {
            d+=0.01;
            Graphics2D g2d = (Graphics2D) g;
            g2d.scale(d, d);
            setMaximumSize(null);
            setPreferredSize(null);
            setMinimumSize(null);
            super.paintComponent(g2d);
            System.out.println("d= " +d);
        }
    }
    public void mouseWheelMoved(MouseWheelEvent e) {
            this.repaint();
    }

} 
```

当我滚动鼠标滚轮时，JLabel 的大小会增加，并且会打印出变量 d。但是，当它达到实际大小 (d=1) 时，**只有文本继续缩放**。如何让背景继续放大？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-07-18T14:24:11.003

您不应该在绘制方法中修改首选/最小/最大尺寸，这可能会产生意想不到的结果（导致再次重新绘制）。

问题是父布局没有参考来确定组件的大小。也就是说，preferred/in/max size 实际上是根据字体信息计算出来的，并且这个信息没有改变。

因此，虽然“看起来”组件正在调整大小，但它的实际大小并没有改变。

尝试按原始字体大小进行缩放。

```
AffineTransformation af = AffineTranfrmation.getScaleInstance(scale, scale);
Font font = originalFont.deriveFont(af);
setFont(font);

invalidate();
repaint(); 
```

当然你会遇到如果用户改变字体会发生什么的问题，但是通过一点标记，你应该能够克服这个问题

# ajax - 从json上传django文件

> ID：11542739
> 
> 赞同：0
> 
> 时间：2012-07-18T13:38:13.317
> 
> 标签：ajax, django, json, django-views, response

嗨，我已经给出了我的文件上传的完整代码。但在我看来，我只是想返回一个响应并在 UI 上获得警报。但是没有一个返回语句正在工作。如何纠正这个..

`EDIT`：我看到服务器端的日志记录语句

```
 <h1>Add Content</h1>
  <form  method="post" enctype="multipart/form-data" id="contentform" action="/content/savecontent/" >{% csrf_token %}
  <b>
  <table>

   <tr><td><font>*</font>Content Name</td><td> <input type="text" id="cname" name="cname" maxlength="30"/></td></tr>
   <tr><td><font>*</font>Description</td><td><input type="text" id="cdescription" name="cdescription" maxlength="30"/> </td></tr>
   <tr><td><font>*</font>Type</td><td> 
   <select id="type" name="type">
   <option value="1" selected>Local</option>      
   <option value="2">Internet</option>      
   </select>
   </td></tr>
   <tr><td><font>*</font>Access</td><td>
   <select id="access" name="access">
   <option value="1" selected>Public</option>     
   <option value="2">Private</option>    
   </select>

   </td></tr>
   <tr><td><font>*</font>Content</td><td id="carea"> </td></tr>
   <tr><td></td><td><input type="button" value="Upload" id="addbtn" onclick="ajax_upload('#contentform');"/></td></tr>
  </table>
  </b>
  </form>

 <script>
 $(document).ready(function() {
 $('font').css({'color':'red'})
 $("#carea").html('').append('{{form.file_upload}}');
 });

  function ajax_upload(formid)
  {
     var form = $(formid);
     form.ajaxSubmit({
        dataType:  'json',
        success:   function (data) {
        alert("hereeeeeee");
        }
     } )   ;
  }
  </script> 
```

视图.py

```
def savecontent(request):
 response_dict={'status':1}
 logging.debug(request)
 logging.debug("========================================")
 return render_to_response('content/confirmation.html', context_instance=RequestContext(request, {'response_dict':response_dict}))
 #return HttpResponse(simplejson.dumps(response_dict), mimetype='application/javascript')
 #return HttpResponse(simplejson.dumps(response_dict), mimetype='text/html')
 #return HttpResponse(simplejson.dumps(response_dict), mimetype='application/json') 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-07-19T04:54:35.297

检查 Web 浏览器控制台中是否没有错误。可能是 ajaxSubmit 函数的问题。尝试将 ajaxSubmit 更改为：

```
$.ajax({
    url: form.attr('action'),
    data: form.serialize(),
    type: 'POST',
    success: function(data){
        alert(data);
    }
}); 
```

并检查结果。

# .net - 如何在不捕获 System.UnauthorizedAccessException 的情况下检查目录是否可访问

> ID：11542740
> 
> 赞同：0
> 
> 时间：2012-07-18T13:38:17.173
> 
> 标签：.net, directory, access-violation

我已经通过网络搜索和搜索，但找不到解决这个问题的好方法。

这是我的代码：

```
protected bool isFileValid(FileSystemInfo ifo)
{
   if (!ifo.Exists || ifo.Name.StartsWith("$") || ifo.Name.Equals("System Volume Information"))
        return false;
   if(ifo is DirectoryInfo){
        try
        {
           ((DirectoryInfo)ifo).GetFileSystemInfos();
        }
        catch (Exception e) { LogUtil.Debug("Exception in isFileValid" + e.Message); return false; }
   }
   return true;
} 
```

除了尝试捕获异常之外，还有什么方法可以检查我是否可以访问目录？这种方法的问题是，如果有很多我无法访问的目录，它会变得非常慢。

我所说的“访问目录”是指`GetFileSystemInfos()`无一例外的调用。`isFileValid`由我的应用程序调用 every`FileSystemInfo`以确定它是否可以按照我描述的方式访问。

提前感谢您提供解决此问题的任何想法。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-07-18T13:43:47.810

您可以尝试查看`DirectoryInfo.Exists`属性（[文档链接](http://msdn.microsoft.com/en-us/library/system.io.directoryinfo.exists.aspx)）

> 如果在尝试确定指定文件是否存在时发生任何错误，Exists 属性将返回 false。这可能发生在引发异常的情况下，例如传递包含无效字符或过多字符的文件名、磁盘故障或丢失，或者**调用者没有读取文件的权限。**

（强调的是我的）。

所以这里是一个简单的例子：

```
var di = (DirectoryInfo)ifo;
if(di.Exists)
{
    di.GetFileSystemInfos();
} 
```

**编辑：**听起来你有环境变量在工作。在调用此方法之前的某个地方，我猜您是`FileSystemInfo`从文件路径创建的，存储在字符串中。您需要像这样在此处扩展它：

```
string expandedFilePath = Environment.ExpandEnvironmentVariables(filePath); 
```

在从中创建之前`FileSystemInfo`。

[http://msdn.microsoft.com/en-us/library/system.environment.expandenvironmentvariables.aspx](http://msdn.microsoft.com/en-us/library/system.environment.expandenvironmentvariables.aspx)

# c# - 可以通过存储过程创建视图吗？

> ID：11542743
> 
> 赞同：0
> 
> 时间：2012-07-18T13:38:20.430
> 
> 标签：c#, mysql, sql, sql-server, sql-server-2008

```
create procedure pro_training2
as 
begin
    create view Tab1view As
      select * from tab1
end 
```

这可以在采购中创建一个视图吗？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-07-18T13:41:16.063

您可以使用动态 SQL 来执行此操作，例如

```
CREATE PROCEDURE dbo.pro_training2
AS
BEGIN
  DECLARE @sql NVARCHAR(MAX);

  SET @sql = N'CREATE VIEW dbo.Tab1View AS SELECT <columns> FROM dbo.tab1;';

  EXEC sp_executesql @sql;
END
GO 
```

但这是一种严重的代码异味。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-07-18T13:41:58.993

尽管上面不是 MySQL 语法，但您已使用 MySQL 进行了标记。

无论如何，如果您确实是指 MySQL：是的，可以`CREATE VIEW`从过程中发出，但使用不同的语法：

```
CREATE PROCEDURE pro_training2()
MODIFIES SQL DATA

BEGIN
  create view Tab1view As select * from tab1;
END 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-07-18T13:43:20.040

使用 sp_executesql 并指定数据库名称：

```
EXEC myDb1..sp_executesql N'CREATE VIEW Tab1view As select * from tab1' 
```

# linux - 在汇编中从键盘读取整数（Linux IA-32 x86 gcc gas）

> ID：11542745
> 
> 赞同：0
> 
> 时间：2012-07-18T13:38:27.903
> 
> 标签：linux, gcc, assembly, interrupt, gnu-assembler

我想知道如何在汇编中从键盘读取整数。我正在使用 Linux/x86 IA-32 架构和 GCC/GAS（GNU 汇编程序）。到目前为止，我发现的示例适用于 NASM 或其他一些与 Windows/DOS 相关的编译器。

我听说它与“int 16h”中断有关，但我不知道它是如何工作的（它需要参数吗？结果进入 %eax 或其任何虚拟寄存器 [AX, AH, AL] ？）。

在此先感谢，弗莱森。

:D

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-07-18T18:33:07.797

简单的答案是您不是从键盘读取整数，而是从键盘读取字符。您也不会将整数打印到屏幕上 - 您打印字符。您将需要例程来转换“ascii-to-integer”和“integer-to-ascii”。您可以为一个“只调用 scanf”，而为另一个“只调用 printf”。如果用户表现良好并将输入限制为代表十进制数字的字符，“scanf”可以正常工作，但很难摆脱输入的任何“垃圾”！“printf”还不错。

虽然我是 Nasm 用户（它适用于 Linux - 不是真正的“Windows/dos 相关”），但我可能在 (G) 中有例程作为语法。如果你想不出来，我会看看能不能找到他们。

正如 Brian 指出的那样，int 16h 是一个 BIOS 中断 - 16 位代码 - 在 Linux 中没有用。

最好的，弗兰克

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-07-19T13:53:39.310

如果你的目标是“获得”一个程序，我会完全同意 Basile。如果您的目标是“学习汇编语言”，那么这些其他语言并没有真正的帮助。如果您的目标是了解硬件的细节，您可能需要汇编语言，但 Linux（或任何其他“保护模式”操作系统）将我们与硬件隔离开来，因此您可能想使用笨重的旧 DOS 甚至“编写自己的操作系统”。Flayshon实际上并没有说他的目标是什么，但既然他在这里问，他可能对汇编语言感兴趣......

我们中的一些人患有精神疾病，使我们认为用汇编语言写作很“有趣”。幽默我们！

最好的，弗兰克

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-07-18T20:19:30.847

在 2012 年，我不建议在汇编中编写整个程序。只编码最关键的部分（如果你绝对想要一些汇编代码）。编译器比人类优化得更好。因此，对于低级软件使用*C*或*C++ ，而使用**Ocaml*等高级语言。

在 Linux 上，您需要了解[linux 内核](http://en.wikipedia.org/wiki/Linux_kernel)和[系统调用](http://en.wikipedia.org/wiki/System_call)的作用，这些都在[手册页的第 2 节](http://www.kernel.org/doc/man-pages/online/pages/man2/intro.2.html)中记录。您可能至少需要[read(2)](http://www.kernel.org/doc/man-pages/online/pages/man2/read.2.html)和[write(2)](http://www.kernel.org/doc/man-pages/online/pages/man2/write.2.html)（如果只处理应该已经由父进程打开的标准输入和标准输出，例如 shell），并且您可能需要许多其他系统调用（例如*open* ( *2* [)](http://www.kernel.org/doc/man-pages/online/pages/man2/open.2.html)并[关闭（2）](http://www.kernel.org/doc/man-pages/online/pages/man2/close.2.html)）。不要忘记进行缓冲（出于效率目的）。

[我强烈建议通过阅读诸如Advanced Unix Programming](http://basepath.com/aup/)之类的好书来学习 Linux 系统接口。

[Linux Assembly Howto](http://asm.sourceforge.net/howto/Assembly-HOWTO.html)（至少对于 32 位的 x86 Linux）记录了如何在汇编中的机器级别完成系统调用。

# javascript - 验证值

> ID：11542750
> 
> 赞同：0
> 
> 时间：2012-07-18T13:38:51.150
> 
> 标签：javascript, html, validation

我正在尝试验证我的字母和数字值以及从数据库中检查。我创建了一个验证功能，并用验证功能声明了我的 onclick 按钮。

功能：

```
<script>
function validate()
{
var StudentID= document.getElementById('StudentID').value;
var StudentName = document.getElementById('StudentName').value;
    var StudentAdd = document.getElementById('StudentAdd').value;

    if(StudentID.length ==0 || StudentName.length ==0)
{
    alert("Please do not leave any blanks");
    return false;
}
else
{
            if(isNumeric(StudentID))
            { alert("correct") }
            else { alert("Numbers only!"); return false;}

    alert("Correct correct");   
}
    return true;
}
</script> 
```

样品表格：

```
<form id="Student" name="Student" method="post" action="nextpage.php">
<input name="StudentID" type="text" id="StudentID" value="<?php echo $StudentID?>"/>
<input name="StudentName" type="text" id="StudentName" value="<?php echo $StudentName?>"/>
<input name="StudentAdd" type="text" id="StudentAdd" value="<?php echo $StudentAdd?>"/>
<input type="submit" name="submit" value="Submit" onclick="return validate();"/>
</form> 
```

我已经声明了返回验证函数，而不是调用我的 nextpage.php。但是没有任何警报弹出。好心提醒。谢谢

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-07-18T13:53:07.430

尝试在 body 标记之后包含您的脚本，以确保它仅在加载后引用元素。然后放入`return true`else 语句中。

```
function validate()
{
var StudentID= document.getElementById('StudentID').value;
var StudentName = document.getElementById('StudentName').value;
    var StudentAdd = document.getElementById('StudentAdd').value;

    if(StudentID.length ==0 || StudentName.length ==0)
{
    alert("Please do not leave any blanks");
    return false;
}
else
{
            if(isNumeric(StudentID))
            { alert("correct") }
            else { alert("Numbers only!"); return false;}

    alert("Correct correct");   
   return true;
}

} 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-07-18T13:47:50.757

JavaScript 中没有 isNumeric() 函数（我明白了`Uncaught ReferenceError: isNumeric is not defined`）。您必须自己创建它：[Validate decimal numbers in JavaScript - IsNumeric()](https://stackoverflow.com/questions/18082/validate-numbers-in-javascript-isnumeric)

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-07-18T13:43:15.657

而不是提交按钮的 onclick，将功能移动到表单的 onsubmit，例如：

```
<form onsubmit="validate()" ...> 
```

对于返回 true 的“if”语句部分，您可能会遇到 alerts() 的一些问题，因为浏览器将尝试提交表单，但总的来说它应该可以工作。

# php - 如何使用 Jquery 在 DatePicker 中设置昨天的日期

> ID：11542760
> 
> 赞同：3
> 
> 时间：2012-07-18T13:39:22.037
> 
> 标签：php, jquery, datepicker

我有一个文本框，当用户单击它时出现日历。这工作正常，显示当前日期和上一个日期的日历都被禁用。但现在我想显示选择了昨天日期的日历。我怎样才能做到这一点。

例如：如果当前日期是，`19-July-2012`那么日历必须显示日期，`18-july-2012`并且 18 日之前的所有其他日期必须处于非活动状态。我该怎么做？

提前致谢。

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-07-18T13:44:24.257

要选择昨天，您可以执行以下操作：

```
$( ".selector" ).datepicker({ defaultDate: -1 }); 
```

有关详细信息，请参阅[http://jqueryui.com/demos/datepicker/#option-defaultDate](http://jqueryui.com/demos/datepicker/#option-defaultDate)。

编辑：

根据评论，DatePicker 应该显示昨天的日期。所以这需要`minDate`昨天的。

```
 $(".selector").datepicker({minDate: -1}); 
```

见：http: [//jsfiddle.net/E3VEm/1/](http://jsfiddle.net/E3VEm/1/)

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2012-07-18T13:46:17.580

访问文档： [http ://docs.jquery.com/UI/Datepicker#option-defaultDate](http://docs.jquery.com/UI/Datepicker#option-defaultDate)

```
$( ".yourselector" ).datepicker({ defaultDate: -1, minDate:'-1d' }); 
```

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-07-18T13:42:58.593

检查[http://jqueryui.com/demos/datepicker/](http://jqueryui.com/demos/datepicker/)以获取所有选项。

您可能将`minDate`某处设置为今天的日期。

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2012-07-18T13:48:40.380

建议您使用 jquery-ui datepicker：

```
$(function() {
    $("#datepicker").datepicker({defaultDate: -1});
}); 
```

有关示例，请参见[http://jsfiddle.net/2qZRy/1/ 。](http://jsfiddle.net/2qZRy/1/)

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2012-07-18T13:44:00.367

[http://jqueryui.com/demos/datepicker/#option-defaultDate](http://jqueryui.com/demos/datepicker/#option-defaultDate)

这应该有效：

`$(".selector").datepicker({defaultDate: -1});`

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2012-07-18T13:44:14.067

我认为您可以使用 defaultDate 选项来实现这一点。

[http://jqueryui.com/demos/datepicker/#option-defaultDate](http://jqueryui.com/demos/datepicker/#option-defaultDate)

# ruby-on-rails - CanCan、嵌套资源和使用方法

> ID：11542761
> 
> 赞同：1
> 
> 时间：2012-07-18T13:39:24.207
> 
> 标签：ruby-on-rails, ruby, ruby-on-rails-3, cancan

在我的新项目中，我有一个资源 Bet，其他用户只有当他们是该赌注的所有者或他的朋友时才能阅读该资源。当我想为索引操作定义能力时，主要问题就出现了。在索引操作中，该块不会被执行，所以我想这不是一个选项。

让我们来说明一下。如果我只希望所有者能够为投注编制索引，这就足够了：

```
can :read, Bet, :user => { :id => user.id } 
```

但我需要可接受的 id 是一个范围，由用户的所有朋友定义。就像是：

```
if (bet.user == user) || (bet.user.friends.include? user)
    can :read, Bet
end 
```

但这不是正确的 CanCan 语法。

我想很多人都遇到过 CanCan 和嵌套资源的问题，但我仍然没有看到任何答案。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-07-18T14:13:03.257

在您的 Bet 模型中，创建一个方法：

```
def is_accessible_by? (user)
    owner = self.user
    owner == user || owner.friends.include?(user)
end 
```

现在在ability.rb 中，设置您的 CanCan 权限：

```
can :read, Bet { |bet| bet.is_accessible_by?(user) } 
```

**编辑**

正如您所指出的，由于索引操作没有对象的实例，因此上面的块不会被执行。

但是，听起来您正在尝试做的事情 - 列出用户或其朋友拥有的投注 - 不应该使用 CanCan 或权限来处理。我会在我的用户模型中创建一个函数：

```
def bet_listings
    friend_bets = friends.inject([]){ |bets, friend| bets<<friend.bets; bets }
    self.bets + friend_bets
end 
```

然后在您的索引操作中： `@bets = user.bet_listings`

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-07-18T14:02:57.050

刚才我找到了一个解决方案，但我不太喜欢它。它是关于创建自定义操作并为其定义能力。例如...

在控制器中：

```
def index
  authorize! :index_bets, @user
end 
```

在能力.rb 中：

```
can :index_bets, User do |friend|
  user == friend || user.friends.include?(friend)
end 
```

它有效，但我对使用它感觉不太好。没有更优雅的吗？

# ruby - 如何组合来自多个 Gemfile 的 gem 来运行一个 Ruby 程序？

> ID：11542762
> 
> 赞同：3
> 
> 时间：2012-07-18T13:39:24.597
> 
> 标签：ruby, heroku, rubygems, bundler, logstash

**我的问题**

假设我有一个这样的目录结构：

```
app/
    core/
        bin/
            runner
        Gemfile
        ...
    Gemfile
    lib/ 
```

“核心”是一个拥有自己的 Gemfile 和 Gemfile.lock 的应用程序。我不想以任何方式修改核心。app/Gemfile 是我的核心插件的一部分，它也有一个 Gemfile（列出了它自己的依赖于 core/Gemfile 的附加项）。

我可以从 app/core/ 和 app/ 目录“捆绑安装”。

如何从 app/ 目录运行 core/bin/runner，使其包含 app/core/Gemfile 和 app/Gemfile 中的所有 Ruby gem？

**背景**

我正在使用 C Ruby 为 Logstash 编写插件。Logstash 包含自己的 Gemfile；获取所有依赖项后，总包大小约为 40MB。

我想在 Heroku 中运行 Logstash。为了避免将 40MB 的内容放入 Git，我已经分叉了 Ruby buildpack (https://github.com/inscitiv/heroku-buildpack-logstash) 并对其进行了修改以下载 Logstash，解压缩并使用它的 Gemfile。

这工作正常，但我坚持使用 Logstash 提供的 Gemfile。对于我的插件，我想添加我的插件将使用的新依赖项；我真的不想分叉 Logstash 并更改其 Gemfile 以完成此操作。

相反，我想将 Logstash 解压到它自己的目录 (logstash/) 中，然后我想在它上面覆盖我的插件代码，包括用于依赖项的 Gemfile。然后我想运行一个 Heroku“worker”进程，它将运行 logstash，指定“。” 作为插件目录，并且可以访问两个 Gemfile 中的所有 gem。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-09-06T16:55:12.647

答案是顶层 Gemfile 应该包含子目录 Gemfiles。

像这样的东西（来自 Redmine 2.0 Gemfile）

```
# Load plugins' Gemfiles
Dir.glob File.expand_path("../plugins/*/Gemfile", __FILE__) do |file|
  puts "Loading #{file} ..." if $DEBUG # `ruby -d` or `bundle -v`
  instance_eval File.read(file)
end 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-07-18T13:44:31.537

要让 bundler 正确地获取所有 gem 依赖项，它确实需要将它们全部放在一个文件中。你能把你的插件变成一个 gem 并让你的部署例程添加一个 gem 到父 Gemfile 吗？然后，您自己的 gem 可以列出将合并到整体中的依赖项。

# iphone - 在 XCODE（组织者）上找不到签名身份

> ID：11542770
> 
> 赞同：0
> 
> 时间：2012-07-18T13:39:58.980
> 
> 标签：iphone, xcode, ios-provisioning, provisioning-profile, organizer

由于所有证书等，我已经制作了 iPhone 应用程序。现在，我正在安装第二台 Mac 来开发应用程序（相同的应用程序），所以：

*   我生成了一个认证登录请求（带有钥匙串）
*   我没有上传它，但我下载了分发证书（我之前用旧电脑生成的），然后安装它（再次在钥匙串中）
*   我下载了分发配置文件

最后一个 File ，我安装了它，在 Organizer 中，文件的状态是“未找到有效的签名身份”。

我该如何解决这个问题？

这是常见的操作，但我总是遇到所有这些证书的问题 :-)

谢谢

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-07-18T13:43:46.030

将现有证书从旧机器导出到新机器。这将使您跳过所有其他要做的事情，并且像 1,2,3 一样简单。

# javascript - 是否可以在编辑器中为另一个 slickgrid 使用 slickgrid？

> ID：11542771
> 
> 赞同：0
> 
> 时间：2012-07-18T13:39:59.637
> 
> 标签：javascript, jquery, slickgrid

我想为我的 slickgrid 中的列编写一个自定义编辑器。理想情况下，此编辑器将包含另一个允许用户过滤和选择多个项目的 slickgrid。

*   有没有人尝试过编写一个包含另一个 slickgrid 实例的编辑器？
*   有什么我应该避免的问题吗？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-07-31T23:49:08.307

我们刚刚完成了这项工作，我们在 SlickGrid v1.4.3 中发现的问题是，您会遇到两个光滑网格的问题，因为它们共享 GlobalEditorLock 状态。换句话说，当您从弹出的光滑网格中选择一个项目时，它会在您在原始网格中设置的处理程序上触发提交事件。这就是问题所在。我们通过添加一个名为 disableEditorCommit 的新选项来解决这个问题，默认为 false 并在 handleClick 方法中更改源：

```
if (options.enableCellNavigation && !columns[cell].unselectable) {
    // if this is a popup then do not commit edits to the global editor
    if (options.disableEditorCommit) {
        scrollRowIntoView(row,false);
        setSelectedCellAndRow($cell[0], (row === defaultGetLength()) || options.autoEdit);
    } else {
        // commit current edit before proceeding
        if (validated === true || (validated === null && options.editorLock.commitCurrentEdit())) {
            scrollRowIntoView(row,false);
            setSelectedCellAndRow($cell[0], (row === defaultGetLength()) || options.autoEdit);
        }    
    }
} 
```

在 handleDblClick 方法中：

```
validated = options.disableEditorCommit ? true : options.editorLock.commitCurrentEdit(); 
```

我们的弹出窗口 slickgrid 具有 disableEditorCommit = true ，因此它不会与我们在原始网格上设置的编辑器交互。

# html - 从移动设备查看网站时文本不合时宜

> ID：11542772
> 
> 赞同：0
> 
> 时间：2012-07-18T13:40:02.770
> 
> 标签：html, css, mobile, text-alignment, fluid-dynamics

我最近为我的第一批客户之一打造了这个网站。目前，我似乎无法找到从移动设备浏览时每个标题下的文本稍微偏左的原因。（使用银河关系）

[http://www.digitalgenesis.com.au/2012-websites/qsoils/example3.html](http://www.digitalgenesis.com.au/2012-websites/qsoils/example3.html)

页面上的所有其他内容都完美显示，我一直在尝试找出问题，但没有成功

我希望栗色标题下的文本以其全宽显示，即总包装容器的 60%，文本也应该相对于栗色线居中，就像它在正常屏幕尺寸上一样，因为每个 .info 标签都有被赋予了保证金：0自动；财产

任何帮助都将不胜感激，即使它不是设计的致命错误，干杯

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-07-18T14:37:54.223

我很确定这种行为是设计使然。尽管我的 nexus 上的 chrome 比股票浏览器做得更好。

一种可能的解决方案是为不同的屏幕尺寸提供不同的 CSS 规则，例如

```
@media screen and ( max-width: 480px) {
  #truck img {
    width: 460px;
  }
  .info {
    width: auto;
  }
  /* etc... */
} 
```

并且限制元素的宽度，否则会迫使页面呈现比通常的手机屏幕宽度更宽（纵向）

**另一种选择**是使用具有线性化支持的 CSS 框架（如[YAML](http://www.yaml.de/)）并重建设计。或者可能是两者的结合，因为无论如何图像都需要特别小心。

另请记住，由于移动设备的外形尺寸较小，应避免较大的边距。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-07-18T13:49:22.013

尝试给出段落 {text-align: justify;} 并查看它是否有助于减少移动浏览器中的正确间距问题。

# asp.net - 更改 ASP.NET 应用程序的目录后，Server.MapPath 不刷新

> ID：11542775
> 
> 赞同：0
> 
> 时间：2012-07-18T13:40:18.607
> 
> 标签：asp.net, .net, iis

我有 2 个 ASP.NET 应用程序。假设 App1 和 App2。

从 App1 中，当我调用 Server.MapPath("/App2") 时，我得到了 App2 应用程序的物理路径。

当我在 IIS 中更改 App2 的路径并再次从 App1 调用 Server.MapPath("/App2") 时，我得到了相同的结果。

我必须重新启动 App1 才能注意到它然后更改。

我可以在不重新启动 App1 的情况下做些什么吗？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-07-18T16:16:48.530

调用`Server.MapPath()`可能会被缓存以提高性能，尽管似乎没有文档暗示这一事实。

您可以使用以下代码绕过它

**免责声明 - 这是一个巨大的黑客**，但它确实有效

`Server.MapPath("/App2/" + Guid.NewGuid()).Substring(0,Server.MapPath("/App2/" + Guid.NewGuid()).Length-36)`

所以是的，您可以在不重新启动 App1 的情况下对此进行一些操作，但您可能不想这样做。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-07-18T14:48:07.530

`Server.MapPath()`依赖于 IIS 中声明的虚拟路径。可能有一个内部 IIS 缓存机制会延迟您的更改在不重新启动应用程序的情况下显示，但我认为没有任何方法可以在不重新启动的情况下更新 IIS 虚拟目录的更改。

可能会尝试`HostingEnvironment.MapPath()`查看是否获得了正确的路径，但无论如何看到`Server.MapPath()`最终调用`HostingEnvironment.MapPath()`它可能没有太大帮助。

# c# - 从网络上的不同计算机读取 xml 文件？

> ID：11542780
> 
> 赞同：0
> 
> 时间：2012-07-18T13:40:33.083
> 
> 标签：c#, asp.net, xml, windows-xp

首先，我开发了一个 Web 应用程序，它从特定位置读取 XML 文件，并在应用程序的可编辑网页上显示内容，当 XML 文件在同一台机器/计算机上时，它可以完美执行。当我尝试在网络上的不同计算机上读取相同的文件时，我无法将内容读取到我的网页上。

**我的观察：** 当我通过输入 \xxx.xxx.xx.xx\c$ 从计算机的运行窗口访问该文件时，它给了我一个窗口来连接到要求凭据的机器，我猜会话已打开。所以我关闭了窗口，当我从 Web 应用程序访问 xml 文件时，它能够读取内容。

当我使用我的 Web 应用程序读取 XML 文件时，是否有办法绕过作为 Windows 一部分的身份验证机制，或者是否有办法容纳在我的应用程序中配置身份验证的额外步骤？

如果有人可以指导我解决问题，我会很高兴。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-07-18T13:45:08.447

检查您的 Web 应用程序在哪个用户下运行，以及该用户是否也被允许访问该位置。

如果您使用 IIS 来托管页面，则必须检查“AppPool”用户以及在“网站”和“应用程序”中使用的用户

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-07-18T13:45:42.993

只需将 IIS 应用程序池用户更改为“足够权限”用户（右键单击当前应用程序池 - 高级设置 - 身份）或在 web.config 中的同名部分指定模拟。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-07-18T15:18:16.390

有没有可能改变你的逻辑，

通过将文件从不同的网络存储到运行代码的本地计算机，通过上传文件并处理它。

# xmpp - 关于 XMPP xep-0065 和 xep-0096 的混淆

> ID：11542789
> 
> 赞同：0
> 
> 时间：2012-07-18T13:41:08.917
> 
> 标签：xmpp, xmppframework

我目前正在研究 xmppframework，要求是在两部 iPhone 之间传输文件。我搜索了 XEP，发现 0065 和 0096

XEP-0065 说：

> XMPP 是为在网络实体之间发送相对较小的 XML 块而设计的，而不是为发送二进制数据而设计的。然而，有时希望将二进制数据发送到在 XMPP 网络上发现的另一个实体（例如，发送文件）。因此，拥有一个通用协议来在 XMPP 网络上的任意两个实体之间流式传输二进制数据是很有价值的。**这种字节流技术的主要应用是 SI 文件传输 [1] 和 Jingle 文件传输 [2] 中指定的文件传输。** 但是，其他应用程序也是可能的，这就是为什么开发通用协议而不是专门用于特定应用程序（如文件传输）的协议很重要的原因。

请看粗体线，如果文件传输 XEP 是 SI File Transfer(0096) 和 Jingle File Transfer(0234)，我会感到困惑，那么这个 0065 XEP 的目的是什么？为什么网上的人会提到 sep-0065 进行文件传输？

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-07-18T17:03:11.673

在 XMPP 中有用于文件传输的不同协议 (XEPS)。叮当声、字节流、OOB、IBB...

XEP-0096 的目的是**流启动**。因此，它建立在其他文件传输协议之上，以实现无缝文件传输。

因此，它用于在 2 个客户端之间就上述文件传输协议之一达成一致以进行传输，并且还用于在由于任何原因失败时寻找回退方法。

亚历克斯

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-07-18T16:03:01.117

XEP-0065 用于代理文件传输：除非您使用公共代理，否则您的基础架构中将需要这样的代理。

XEP-0096 要复杂得多，我不建议一开始就这样做，尽管如果您以后广泛使用大型二进制传输/交换，我会推荐它，因为 Jingle 至少用于 VoIP。

# bash - bash 脚本中的 tee 和管道

> ID：11542794
> 
> 赞同：1
> 
> 时间：2012-07-18T13:41:25.297
> 
> 标签：bash, stdout, stderr, tee

我需要将 bash 中的 stout 和 stderr 分别重定向到单独的文件。好吧，我完成了这个命令：

```
  ((/usr/bin/java -jar /opt/SEOC2/seoc2.jar 2>&1 1>&3 | tee --append /opt/SEOC2/log/err.log) 3>&1 1>&2 | tee --附加 /opt/SEOC2/log/app.log) >> /opt/SEOC2/log/combined.log 2>&1 &

```

**从命令行**运行正常。

试图将相同的命令放入**bash 脚本**

```
...
 12 cmd="(($run -jar $cmd 2>&1 1>&3 | tee --append $err) 3>&1 1>&2 | tee --append $log) >> $combined 2>&1"
 ...
 30 echo -e "开始服务..."
 31 $cmd &
 32 pid=`ps -eo pid,args | grep seoc2.jar | grep -v grep | 剪切-c1-6`
 33 如果 [ ! -z $pid ]; 然后
 ...

```

导致这样的错误：

```
   root@operator:/opt/SEOC2# seoc2 start
   开始服务...
   /usr/local/bin/seoc2: 第 31 行: ((/usr/bin/java: 目录或文件不存在

```

试图用 $( )、` ` 等来覆盖这个命令，但完全没有效果:(

任何建议或建议将不胜感激，已经玩了几个小时：/

非常感谢Rene

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-07-18T14:05:46.337

如果您将整个命令行存储在一个变量中，您必须使用`eval`它来执行它：

```
cmd="(($run -jar $cmd 2>&1 1>&3 | tee --append $err) 3>&1 1>&2 | tee --append $log) >> $combined 2>&1"
...
eval $cmd & 
```

# android - 不希望软键盘在启动时自动显示 - Android

> ID：11542797
> 
> 赞同：23
> 
> 时间：2012-07-18T13:41:38.760
> 
> 标签：android, android-softkeyboard

每次我打开我的 android 应用程序时，它都会自动聚焦`EditText`框并打开软键盘。有没有办法将其他东西集中在启动上，这样键盘就不会立即显示？

* * *

## 回答 #1

> 赞同：12
> 
> 时间：2012-07-18T13:49:49.913

你可以试试：

```
android:windowSoftInputMode="stateHidden" 
```

为您在 AndroidManifest.xml 中的活动

* * *

## 回答 #2

> 赞同：6
> 
> 时间：2012-07-18T13:43:11.083

将这两行添加到您的主布局中。

```
android:descendantFocusability="beforeDescendants"
android:focusableInTouchMode="true" 
```

* * *

## 回答 #3

> 赞同：3
> 
> 时间：2012-07-18T13:43:48.590

添加您的布局定义（在 xml 文件中）以下选项：

```
android:focusable="true" android:focusableInTouchMode="true" 
```

# ruby-on-rails - Ruby I/O：Rails rake 任务正在尝试查找和替换某些代码行，但没有

> ID：11542806
> 
> 赞同：0
> 
> 时间：2012-07-18T13:42:13.897
> 
> 标签：ruby-on-rails, ruby

我正在执行一项更改某些页面的元标记的 rake 任务。这些标签在控制器中定义。rake 任务旨在打开控制器文件，找到其中包含短语“@meta_tag”的任何行，然后根据 replace_line(line) 方法重写该行。当我运行 rake 任务时，我没有收到任何错误，但它也没有进行任何更改。

我认为我的问题出在 'r+' 行。我需要在一行中打开文件并在另一行代码中写入吗？

```
require 'rake'
namespace :meta_tags do
  desc 'changes the meta tags'
  task :update => :environment do 

    regex = /@meta_tag/
    found = false
    file = File.open('app/controllers/site_controller.rb', 'r+')
    file.each_line do |line|
      replace_line(line) if(found)
      found = true if(line =~ regex)
    end
  end

  def replace_line(line)
    meta_tags = MetaTag.all.map { |tag| tag["tag"] }
    new_tag = meta_tags.sample(1)[0]
    line = "@meta_tag = #{new_tag}"
  end
end 
```

如果你看到我做错了什么，请告诉我。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-07-18T19:10:30.697

好吧，您实际上并没有在任何地方写入文件。`each_line`就像它所说的那样，它遍历文件中的每一行（实际上它会读取直到有一个换行符，然后将此行生成给您提供的块）。

但是`file.write`现在使用并不是一个好主意，因为**就地**文件写入不像您期望的那样工作。因为文件是基于字节/字符的，所以替换行必须与旧行一样长。

因此，您应该遵循通常使用的*阅读然后写作*的做法。此外，您当前的代码会在 发生**后**`@meta_tag`更改该行，尽管您的问题表明这不是您想要的。这是适用于您的情况的示例：

```
require 'rake'
namespace :meta_tags do
  desc 'changes the meta tags'
    task :update => :environment do 

    regex = /@meta_tag/
    # only 'r' since you will only read the file,
    # although you could use 'r+' and just change the lineno
    # back to 0 when finished reading...
    file = File.open('app/controllers/site_controller.rb', 'r')
    lines = []
    file.each_line do |line|
      # i don't think you need the found variable,
      # it is simple if-then/else
      (line =~ regex) ? (lines << replace_line(line)) : (lines << line)
    end
    file.close
    file = File.open('app/controllers/site_controller.rb', 'w')
    # you could also join the array beforehand,
    # and use one big write-operation,
    # i don't know which approach would be faster...
    lines.each{|line| file.write line} 
    file.close
  end

  def replace_line(line)
    meta_tags = MetaTag.all.map { |tag| tag["tag"] }
    new_tag = meta_tags.sample(1)[0]
    line = "@meta_tag = #{new_tag}\n" # added the newline
  end
end 
```

# c# - 如何在 C# 中发布一条推文

> ID：11542808
> 
> 赞同：1
> 
> 时间：2012-07-18T13:42:23.663
> 
> 标签：c#, windows-phone-7, twitter, windows-phone-7.1, tweets

我正在尝试在我的 Windows 手机应用程序中将一条推文发布到任何推特帐户。我不想使用外部库或 API 使我的代码复杂化。如果它们是不可避免的，我将包括在内。我不需要阅读任何推文或保持我的连接。很简单，用户提供用户名、密码和推文消息并点击推文。

iPhone 中著名的寺庙运行正是我所需要的（截图如下）。

请用 C# 指导我

![在此处输入图像描述](../Images/8f6c0884d63a6df1c88efd5367023084.png)

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-07-29T23:14:33.027

这可以通过[XAuth](https://dev.twitter.com/docs/oauth/xauth)实现。不过，这项技术并不简单，您的请求必须通过 Twitter API 团队，一旦他们批准，他们将提供 xAuth 访问权限。有关更多详细信息，请参阅[此](https://stackoverflow.com/questions/11071817/twitter-authentication-without-using-pin)其他 SOF 答案。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-07-18T13:48:49.700

如果您想像在屏幕截图中那样集成它，我认为您需要自己与 API 进行通信。

但是命名空间`ShareStatusTask`中有`Microsoft.Phone.Tasks`。

这样，用户可以将您的状态分享到他们配置的社交媒体。

另请检查： http: [//msdn.microsoft.com/en-us/library/hh394027 (v=vs.92).aspx](http://msdn.microsoft.com/en-us/library/hh394027(v=vs.92).aspx)

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-07-18T15:30:33.367

你有两个选择：

*   使用内置`ShareStatusTask`
*   推出自己的系统。

优点`ShareStatusTask`是实现和维护简单。

对于用户来说，这也是一个很好的解决方案，因为它允许他在其选择的社交网络上发布状态，并避免强迫他再次进行身份验证。

如果你想推出自己的系统，你将不得不处理不同的问题：

*   用户身份验证 (OAuth)
*   维护（有时 Twitter 喜欢改变 3rd 方应用程序与它们交互的方式......）

[这是一个教程，它解释了如何在 Windows Phone 应用程序中实现 Twitter](http://dotnet.dzone.com/articles/building-twitter-client)。

Tweetsharp[也是](https://github.com/danielcrenna/tweetsharp)一个不错的 Twitter 库，您可以使用

# android - SyncResult 字段用于同步之间的延迟

> ID：11542810
> 
> 赞同：1
> 
> 时间：2012-07-18T13:42:29.823
> 
> 标签：android, android-syncadapter

我正在研究 SyncAdapter 的实现。并且想知道 - 我们的 onPerformSync 方法中有一个 SyncResult 类型的参数。SyncResult 包含字段 - delayUntil。正如它在文档中所述 - 它用于同步之间的延迟。但是，当我调用 ContentResolver.requestSync - 它被忽略了。那么，有人知道如何正确使用它吗？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-08-20T09:31:20.807

经过一番调查和调试，我得出了下一个结论：

*   SyncResult.delayUntil 影响由 ContentResolver.notifyChange 触发的 SyncAdapter 调用
*   ContentResolver.requestSync 忽略此标志

# javascript - 多个谷歌地图

> ID：11542812
> 
> 赞同：1
> 
> 时间：2012-07-18T13:42:43.630
> 
> 标签：javascript, google-maps

我目前使用 javascript api 在我的网页上加载了 3 个单独的谷歌地图，加载它们需要几秒钟的时间，这会使页面处于非活动状态，直到它们完成。

有人对我可以做些什么来改变这一点有任何建议吗？目前它非常慢，我不知道如何解决这个问题。

谢谢！

```
function googlemap() {

    // map pin
    var companyImage = new google.maps.MarkerImage('http://urlgoeshere.co.uk/images/home/map_pin.png',
        new google.maps.Size(100,60),
        new google.maps.Point(0,0),
        new google.maps.Point(21,65)
    );

    // map pin shadow
    var companyShadow = new google.maps.MarkerImage('http://urlgoeshere.co.uk/images/home/map_shadow.png',
        new google.maps.Size(120,60),
        new google.maps.Point(0,0),
        new google.maps.Point(23,23)
    );

    // map one
    var onePos = new google.maps.LatLng(44.374411, -1.088402);
    var oneSettings = {
        zoom: 15,
        center: onePos,
        scrollwheel: false,
        mapTypeControl: false,
        zoomControl: true,
        zoomControlOptions: {
            style: google.maps.ZoomControlStyle.SMALL,
            position: google.maps.ControlPosition.BOTTOM_CENTER
        },
        panControl: false,
        streetViewControl: true,
        streetViewControlOptions: {
            position: google.maps.ControlPosition.BOTTOM_CENTER
        },
        mapTypeId: google.maps.MapTypeId.ROADMAP
    };

    var oneMap = new google.maps.Map(document.getElementById("one_map"), oneSettings);
    var oneMarker = new google.maps.Marker({
        position: onePos,
        map: oneMap,
        icon: companyImage,
        shadow: companyShadow,
        zIndex: 3
    }); 

    google.maps.event.addListener(oneMarker, 'click', function() {
        infowindow.open(map,oneMap);
    });

    // two
    var twoPos = new google.maps.LatLng(42.349055,4.110803);
    var twoSettings = {
        zoom: 15,
        center: twoPos,
        scrollwheel: false,
        mapTypeControl: false,
        zoomControl: true,
        zoomControlOptions: {
            style: google.maps.ZoomControlStyle.SMALL,
            position: google.maps.ControlPosition.BOTTOM_CENTER
        },
        panControl: false,
        streetViewControl: true,
        streetViewControlOptions: {
            position: google.maps.ControlPosition.BOTTOM_CENTER
        },
        mapTypeId: google.maps.MapTypeId.ROADMAP
    };

    var twoMap = new google.maps.Map(document.getElementById("two_map"), twoSettings);
    var twoMarker = new google.maps.Marker({
        position: twoPos,
        map: twoMap,
        icon: companyImage,
        shadow: companyShadow,
        zIndex: 3
    }); 

    google.maps.event.addListener(twoMarker, 'click', function() {
        infowindow.open(map,twoMap);
    });

    // three
    var threePos = new google.maps.LatLng(32.377624,-0.523466);
    var threeSettings = {
        zoom: 15,
        center: threePos,
        scrollwheel: false,
        mapTypeControl: false,
        zoomControl: true,
        zoomControlOptions: {
            style: google.maps.ZoomControlStyle.SMALL,
            position: google.maps.ControlPosition.BOTTOM_CENTER
        },
        panControl: false,
        streetViewControl: true,
        streetViewControlOptions: {
            position: google.maps.ControlPosition.BOTTOM_CENTER
        },
        mapTypeId: google.maps.MapTypeId.ROADMAP
    };

    var threeMap = new google.maps.Map(document.getElementById("three_map"), threeSettings);
    var threeMarker = new google.maps.Marker({
        position: threePos,
        map: threeMap,
        icon: companyImage,
        shadow: companyShadow,
        zIndex: 3
    }); 

    google.maps.event.addListener(threeMarker, 'click', function() {
        infowindow.open(map,threeMap);
    }); 
```

和我的html

```
<div id="one_map"></div>
    <div id="two_map"></div>
    <div id="three_map"></div> 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-07-18T14:13:25.387

我建议将您的函数分解为您正在创建的每个地图的一个函数（或一个可以根据参数完成工作的动态函数），然后在每个函数结束时，使用`setTimeout`调用执行下一个延迟为 0，或只是一个小延迟。当您退出该功能时，您可以让 UI 有时间更新，而无需等待整个任务完成。虽然实际上并没有让你的页面更快，但它让人感觉更快、响应更快。可能还有其他改进，但是这种简单的更改通常会产生巨大的影响。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-07-18T17:55:32.900

也许它与您的操作系统或带宽有关。

看看这些：

9 张地图： http: [//maps.forum.nu/gm_maps_in_sync.html](http://maps.forum.nu/gm_maps_in_sync.html)

和

16 张地图： http: [//maps.forum.nu/gm_maps_in_sync2.html](http://maps.forum.nu/gm_maps_in_sync2.html)

它们是 API V2，几乎没用，但它们是在循环中创建的，并且加载速度很快。

请注意，根据 DOM 的复杂性，getElementById() 的成本可能很高。我发布的示例使用 createElement() 和 appendChild() 代替。

# javascript - 具有全局范围的 JavaScript 变量

> ID：11542814
> 
> 赞同：-6
> 
> 时间：2012-07-18T13:42:47.217
> 
> 标签：javascript, scope

[这是对问题](https://stackoverflow.com/questions/11540329/functions-scope-in-javascript/11541574#11541574)的扩展。我试过下面的代码来理解 JavaScript 范围

```
var a = function(){
   var aa = 10;
   var x = 13;            
   b = function(){ c = function(){ alert(aa); }; };       
};
a();
b();
c();
alert(typeof x);​ // Undefined
alert(x);​ // Returned me 13. 
```

我的查询是我`var`在全局函数中声明了变量。根据我的理解`x`应该是本地的。但它不是那样行事。有人请清除我的疑问......请检查[这个](http://jsfiddle.net/HJ4vK/6/)小提琴。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-07-18T13:52:27.617

将发生以下情况：

弹出一个警报，显示`aa`=的值`10`

弹出一个警报，说`undefined`因为您试图`x`从全局范围访问变量，但是`x`仅在函数 a 的范围内定义。

您的控制台中出现错误，`ReferenceError: x is not defined`.

因此，正如您所假设的， x 确实是私有的，您无法全局访问它。

你可能搞砸了一些东西给你错误的结果。

可能的情况是您忘记了 var 前面的 var ，`x`它突然使它成为全局对象的成员，而不是被限制在函数范围内。在这种情况下，最后一个警报会给你 13。但是 alert(typeof x) 会给你`"number"`然后。

# java - 如何在java中创建一个简单的加密算法？

> ID：11542819
> 
> 赞同：-2
> 
> 时间：2012-07-18T13:43:09.430
> 
> 标签：java, javascript, encryption, encryption-symmetric

任何人都可以指导我如何在Java中创建加密/解密算法吗？我需要进行客户端-服务器聊天，需要通过生成密钥来加密文本。在接收方，接收方接收到带有解密密钥的短信以打开完整的消息。我不知道。如果有人可以为此提供示例或教程，将不胜感激。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-07-18T13:56:14.370

我建议您不要创建自己的算法，而是从 JCE（Java 密码术扩展）或 Bouncy Castle 中可用的知名算法列表中进行选择，具体取决于您是否接受第三方软件。根据您要执行的操作，您应该相应地选择您的算法。不同类型的敏感数据需要不同的最低加密级别。

# javascript - javascript onclick create(element) div viz 弹出框

> ID：11542822
> 
> 赞同：2
> 
> 时间：2012-07-18T13:43:12.910
> 
> 标签：javascript, events, createelement

我正在尝试制作一个弹出框，它会在单击按钮时被调用，这就是我到目前为止所得到的...... [http://jsfiddle.net/WGPhG/2/](http://jsfiddle.net/WGPhG/2/)

* * *

## 回答 #1

> 赞同：9
> 
> 时间：2012-07-18T14:00:44.267

这是一个实际上可以满足您要求的小提琴-http: [//jsfiddle.net/WGPhG/6/](http://jsfiddle.net/WGPhG/6/)

**JS**

```
function popUp(){
    var popup = document.createElement('div');
    popup.className = 'popup';
    popup.id = 'test';
    var cancel = document.createElement('div');
    cancel.className = 'cancel';
    cancel.innerHTML = 'close';
    cancel.onclick = function (e) { popup.parentNode.removeChild(popup) };
    var message = document.createElement('span');
    message.innerHTML = "This is a test message";
    popup.appendChild(message);                                    
    popup.appendChild(cancel);
    document.body.appendChild(popup);
} 
```

**笔记**

要在元素上设置类，请使用 element.className 而不是 element.class。对于取消元素上的 onclick 事件处理程序，最好直接为 onclick 处理程序分配一个匿名函数，该函数执行您需要的操作，如我上面的示例所示。

* * *

**编辑（更有效的方式）**

这实际上比获得您想要的结果要好得多，因为每次显示弹出窗口时重新创建元素都不会产生任何开销。小提琴 - [http://jsfiddle.net/WGPhG/7/](http://jsfiddle.net/WGPhG/7/)

**CSS**

```
.popup
{
    position:absolute;
    top:0px;
    left:0px;
    margin:100px auto;
    width:200px;
    height:150px;
    font-family:verdana;
    font-size:13px;
    padding:10px;
    background-color:rgb(240,240,240);
    border:2px solid grey;
    z-index:100000000000000000;
    display:none
}

.cancel
{
    display:relative;
    cursor:pointer;
    margin:0;
    float:right;
    height:10px;
    width:14px;
    padding:0 0 5px 0;
    background-color:red;
    text-align:center;
    font-weight:bold;
    font-size:11px;
    color:white;
    border-radius:3px;
    z-index:100000000000000000;
} 
```

**HTML**

```
<button onClick="openPopup();">click here</button>
<div id="test" class="popup">
    This is a test message
    <div class="cancel" onclick="closePopup();"></div>
</div> 
```

**JS**

```
function openPopup() {
    document.getElementById('test').style.display = 'block';
}

function closePopup() {
    document.getElementById('test').style.display = 'none';
} 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2014-05-20T08:28:14.930

## [在JSFiddle](http://jsfiddle.net/WGPhG/1095/)上试试这个更新

**改变：**

1.  中心页面（固定）。
2.  效果（淡入淡出）

### HTML

```
<button onClick="openPopup();">click here</button>
<div id="test" class="popup" style="display:none;">
    This is a test message
    <div class="cancel" onclick="closePopup();"></div>
</div> 
```

### CSS

```
.popup {
    position:fixed;
    top:0px;
    left:0px;
    bottom:0px;
    right:0px;  
    margin:auto;
    width:200px;
    height:150px;
    font-family:verdana;
    font-size:13px;
    padding:10px;
    background-color:rgb(240,240,240);
    border:2px solid grey;
    z-index:100000000000000000;
}

.cancel {
    display:relative;
    cursor:pointer;
    margin:0;
    float:right;
    height:10px;
    width:14px;
    padding:0 0 5px 0;
    background-color:red;
    text-align:center;
    font-weight:bold;
    font-size:11px;
    color:white;
    border-radius:3px;
    z-index:100000000000000000;
}

.cancel:hover {
    background:rgb(255,50,50);
} 
```

### JS

```
function openPopup() {
    //document.getElementById('test').style.display = 'block';
   $('#test').fadeIn(1000);
}

function closePopup() {
    //document.getElementById('test').style.display = 'none';
    $('#test').fadeOut(500);
} 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-07-18T13:52:52.640

我已经更新了您的[Fiddle](http://jsfiddle.net/WGPhG/10/)并使其正常工作。

更改后的 HTML...

```
 <button id="popupButton">click here</button> 
```

更新了 JavaScript...

```
document.onreadystatechange = function () {
    function popUp() {
        var popup = document.createElement('div');
        popup.className = 'popup';
        popup.id = 'test';

        popup.innerHTML = "This is a test message";

        var cancel = document.createElement('div');
        cancel.className = 'cancel';
        cancel.onclick= function () { popup.destroy(); }
        popup.appendChild(cancel);

        document.body.appendChild(popup);
    }

    document.getElementById('popupButton').onclick = popUp;
}​ 
```

这回答了您的问题还是还有其他问题？

**更新**改进了代码和小提琴。现在打开和关闭作品

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2012-07-18T13:57:09.987

试试这个

```
function popUp(){
    var popup = document.createElement('div');
    popup.className = 'popup';
    popup.id = 'test';
    var cancel = document.createElement('div');
    cancel.className = 'cancel';
    cancel.setAttribute('onClick', 'document.getElementById("test").parentNode.removeChild('+popup +');')

    popup.innerHTML = "This is a test message";
    document.body.appendChild(popup);
    popup.appendChild(cancel);
 } 
```

# php - 为什么我在 PHPUnit 中使用 PHPT 得到“BORKED --CLEAN-- 部分”？

> ID：11542825
> 
> 赞同：1
> 
> 时间：2012-07-18T13:43:16.810
> 
> 标签：php, phpunit, phpt

我有一些在 PHPUnit 中运行的 PHPT 测试。这些测试包括`--CLEAN--`处理删除测试期间创建的文件的部分。在命令行使用 PHPT 测试运行`pear run-tests`正常，但是当它们通过 PHPUnit 运行时，我收到以下错误：

> 无聊——干净——部分！输出：
> X-Powered-By：PHP/5.3.10-1ubuntu3.2
> 内容类型：text/html

这显然看起来像一个 HTTP 标头，但没有进一步的文本，并且干净部分中的操作仍然按计划工作。删除 CLEAN 部分可以解决问题，但我宁愿不在 PHPT 文件之外进行测试清理。关于这些是由什么引起的以及如何摆脱它们的任何想法？他们没有破坏测试，但他们在输出中看起来不整洁。

PHPT 测试（POST 文件数据被截断以保护我的工作）：

```
--TEST--
Test file upload
--POST_RAW-- 
Content-Type: multipart/form-data; boundary=---------------------------168481652011378167832091260413
Content-Length: 3510

-----------------------------168481652011378167832091260413
Content-Disposition: form-data; name="code"

te
-----------------------------168481652011378167832091260413
Content-Disposition: form-data; name="name"

test
-----------------------------168481652011378167832091260413
Content-Disposition: form-data; name="file"; filename="test.xml"
Content-Type: text/xml

<?xml  version="1.0" encoding="utf-8"?>
<testElement>
    <innerElement />
</testElement>

-----------------------------168481652011378167832091260413--
--FILE--
<?php
// Zend/PHPUnit bootstrap
require_once __DIR__ . '/../../../bootstrap.php';

$upload = new My_File_Upload();
var_dump($upload->handleFile(
    'file', 
    APPLICATION_PATH . '/../datafiles/request/',
    'application/xml',
    'testname'
));
var_dump(file_exists(APPLICATION_PATH . '/../datafiles/request/testname.xml'))
?>
--CLEAN--
<?php
    $file = dirname(__FILE__) . '/../../../../datafiles/request/testname.xml';
    if(file_exists($file)) unlink($file);
?>
--EXPECT--
string(12) "testname.xml"
bool(true) 
```

Zend/PHPUnit 测试包装器：

```
<?php
require_once 'PHPUnit/Extensions/PhptTestCase.php';
/**
 * UploadFileHandleTest
 * 
 * PHPUnit wrapper for the phpt test file UploadFileHandleTest.phpt
 *
 */
class My_File_UploadFileHandle extends PHPUnit_Extensions_PhptTestCase
{
    /**
     * Test file uploads
     * 
     * Test the file uploads using associated .phpt test files. These test have to 
     * be abstracted to the php-cgi environment to permit accurate manipulation of 
     * the $_FILES superglobal. 
     * 
     * @see http://qafoo.com/blog/013_testing_file_uploads_with_php.html
     * 
     * @covers My_File_Upload::handleFile
     * 
     * @return void
     */
    public function __construct() 
    { 
        parent::__construct(__DIR__ . '/UploadFileHandleTest.phpt'); 
    }

    /**
     * Implement missing hasOutput method for PHPUnit
     * 
     * @return boolean 
     */
    public function hasOutput()
    {
        return false;
    }
} 
```

触发包装器的测试套件：

```
<?php

require_once 'UploadFileExists.php';
require_once 'UploadFileHandle.php';
require_once 'UploadFileHandleNoName.php';
require_once 'UploadFileHandleExceptions.php';

class My_File_UploadTestSuite extends PHPUnit_Framework_TestSuite
{
    public static function suite()
    {
        $suite = new My_File_UploadTestSuite('My_File_UploadFileTests');

        $suite->addTest(new My_File_UploadFileExists());
        $suite->addTest(new My_File_UploadFileHandle());
        $suite->addTest(new My_File_UploadFileHandleNoName());
        $suite->addTest(new My_File_UploadFileHandleExceptions());

        return $suite;
    }
} 
```

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-07-19T08:42:21.510

这是由于使用 PHP CGI 可执行文件而不是 CLI 版本来运行测试造成的。CGI 二进制文件将在响应前面附加两个标头，如果在 --CLEAN-- 部分中运行的代码提供了输出，则用于测试的 PEAR 模块将尖叫 bork bork 和血腥谋杀。将测试指向正确的 PHP 二进制文件，问题应该会消失。

```
:~$ echo "" | php5-cgi
X-Powered-By: PHP/5.3.10-1ubuntu3.2
Content-type: text/html 
```

更新：这是由 PEAR_RunTest 中的错误引起的，在运行 --CLEAN-- 部分时，它不会重置要使用的解释器。我已经[修补了 PEAR_RunTest 来解决这个问题](https://github.com/pear/pear-core/pull/6)并提交了一个 PR 来解决这个问题。

# asp.net-mvc-3 - EF4 MVC3 模型状态验证

> ID：11542827
> 
> 赞同：0
> 
> 时间：2012-07-18T13:43:24.060
> 
> 标签：asp.net-mvc-3, entity-framework-4.1

使用这个模型：

```
public class Cases
    {
    //case data model for call center
    //implement lists for all related child tables too

    [Key]
    public int CasesID { get; set; }

    public string CaseNumber { get; set; }

    [Required(ErrorMessage = "Customer is Required")]
    public int CustomerID { get; set; }
    public virtual Customer Customer { get; set; }

    [MaxLength(50)]
    public string UserName { get; set; }  //get user name from the aspnet membership

    [Required(ErrorMessage = "Case Category is Required")]
    public int CaseCategoryID { get; set; }

    [Required(ErrorMessage = "Technician is Required")]
    public int TechnicianID { get; set; }
    public virtual Technician Technicians { get; set; }

    [Required(ErrorMessage = "Engine Model is Required")]
    public int EngineModelID { get; set; }
    public virtual EngineModel EngineModel { get; set; }

    [MaxLength(50)]
    public string BMSWorkorder { get; set; }

    [MaxLength(50)]
    [Required(ErrorMessage = "Status is Required")]
    public string CaseStatus { get; set; }

    [MaxLength(50)]
    public string OpenedBy { get; set; }

    [Required(ErrorMessage = "Opened Date is Required")]
    [DataType(DataType.DateTime)]
    public DateTime? OpenedDate { get; set; }

    [MaxLength(50)]
    public string ClosedBy { get; set; }

    [DataType(DataType.DateTime)]
    public DateTime? ClosedDate { get; set; }

    [MaxLength(50)]
    [Required(ErrorMessage="Caller First Name is Required")]
    public string CallerFirstName { get; set; }

    [MaxLength(50)]
    [Required(ErrorMessage = "Caller Last Name is Required")]
    public string CallerLastName { get; set; }

    [MaxLength(100)]
    public string AdditionalContact { get; set; }

    [MaxLength(10)]
    [Required(ErrorMessage = "Qualified is Required")]
    public string Qualified { get; set; }

    public string Description { get; set; }

    [MaxLength(50)]
    [Required(ErrorMessage = "ESN is Required")]
    public string ESN { get; set; }

    [MaxLength(50)]
    [Required(ErrorMessage = "Mileage is Required")]
    public string Mileage { get; set; }

    [DataType(DataType.Date)]
    public DateTime? DateInService { get; set; }

    [MaxLength(50)]
    public string ESTR { get; set; }

    [MaxLength(50)]
    [Required(ErrorMessage = "EDS is Required")]
    public string EDS { get; set; }

    [MaxLength(50)]
    public string GensetSerialNumber { get; set; }

    [MaxLength(50)]
    public string GensetModelNumber { get; set; }

    //child Case Notes records
    public virtual ICollection<CaseNotes> CaseNotes { get; set; }

    //child case attachment records
    public virtual ICollection<Attachment> Attachments { get; set; }

    //child case complaint records
    public virtual ICollection<CaseComplaint> CaseComplaint { get; set; }

    //tracking fields
    public DateTime? CreatedOn { get; set; }
    [MaxLength(50)]
    public string CreatedBy { get; set; }
    public DateTime? ModifiedOn { get; set; }
    [MaxLength(50)]
    public string ModifiedBy { get; set; }
    } 
```

我想知道为什么即使只有一些属性被标记为必需，除非所有属性在保存时都有值，否则模型状态不会设置为有效。

难道我做错了什么？

***编辑***

以下是相关下拉列表字段的剃刀元素：

```
@Html.DropDownList("Qualified", String.Empty)
@Html.ValidationMessageFor(model => model.Qualified)

@Html.DropDownList("EngineModelID", String.Empty)
@Html.ValidationMessageFor(model => model.EngineModelID)

@Html.DropDownList("CaseCategoryID", String.Empty)
@Html.ValidationMessageFor(model => model.CaseCategoryID) 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-07-18T14:41:10.270

如果您想允许空值，则 and 属性在您的视图模型上必须是可为空的整数`EngineModelID`。`CaseCategoryID`糟糕，您没有使用视图模型。

ASP.NET MVC 自动使不可为空的类型成为必需。您可以在您的`Application_Start`：

```
DataAnnotationsModelValidatorProvider.AddImplicitRequiredAttributeForValueTypes = false; 
```

但是如果你想正确地做这些事情，你应该使用视图模型。

以下是绝对可怕的：

```
@Html.DropDownList("CaseCategoryID", String.Empty) 
```

我猜你已经把 a 塞进了`SelectList`a`ViewBag.CaseCategoryID`所以它`CaseCategoryID`同时做两件事：它代表一个列表和一个选定的标量值。

对于视图模型，您将使用这些助手的强类型版本：

```
@Html.DropDownListFor(x => x.CaseCategoryID, Model.CaseCategories) 
```

where`CaseCategories`将是`IEnumerable<SelectListItem>`控制器将填充的视图模型上的属性。

# install4j - 当端口不可用时强制安装程序失败？

> ID：11542831
> 
> 赞同：3
> 
> 时间：2012-07-18T13:43:39.107
> 
> 标签：install4j

我正在使用 install4j 安装需要 HTTP 和 HTTPS 端口的 Intranet 应用程序。我想测试这些端口是否可用并警告用户/阻止安装，直到他们选择不可用的端口。

我看到的唯一途径（除了自定义代码）是确保 Windows 服务在应用程序无法绑定到所需端口时失败，并使用失败策略“询问用户是在失败时重试还是退出”。在 Web 服务器启动代码中，如果服务器无法绑定到端口，我使用 System.exit(1)。但是，这似乎不会向安装程序注册为失败 - 安装继续进行而不调用失败策略。

向“启动服务”操作发出失败信号的正确方法是什么？其他人是否采取了替代方法来保证安装使用可用端口？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-07-18T16:32:27.470

我后来发现了一个很好的替代方法：添加自定义代码操作：

```
List<Integer> takenPorts = new ArrayList<Integer>();
for (int port : Arrays.asList(80, 443)) {
    java.net.ServerSocket socket = null;
    try {
        socket = new java.net.ServerSocket(port);
    } catch (IOException e) {
        takenPorts.add(port);
    } finally { 
        if (socket != null) socket.close(); 
    }
}

if (takenPorts.isEmpty()) {
     return true;
}
else {
    String msg;
    if (takenPorts.size() == 2) {
        msg = "Ports 80 and 443 must be available for uDiscovery";
    }
    else {
        msg = "Port " + takenPorts.get(0) + " must be available for uDiscovery";
    }
    context.setVariable("portErrorMessage", msg);
    return false;
} 
```

很好地解释了如何在[这里连接它](https://stackoverflow.com/a/7722937/207161)

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2015-10-05T15:52:37.437

所有刚刚收到错误对话框的人

> “com.install4j.runtime.beans.action.control.RunScriptAction 失败”

我认为这也是一个，亚当得到：

在上面的srciptlet 中设置了名为**portErrorMessage的****变量**。

 **我也没有首先意识到这一点。诀窍很简单：您必须`${installer:portErrorMessage}` **在“错误消息”字段**中插入。这样做，您不需要`Util.showOptionDialog`Ingo 所描述的，因为该方法调用会打开另一个必须首先确认的第二个对话框，之后用户也必须从 install4j 确认该对话框。**

# php - 如何在php中创建mysql左连接

> ID：11542833
> 
> 赞同：0
> 
> 时间：2012-07-18T13:43:43.770
> 
> 标签：php, mysql

我对 php 和 mysql 并不陌生，但我是左连接。我目前正在为一家小型大学报纸建立一个网站。文章可以链接到档案，所以我想做的是在一个档案中拥有一个包含所有文章的概述页面。在我的编辑器中这不是问题，但在网站本身上，它应该只显示过去发布日期的文章。所以这是我的表：

**文章**

> 文章ID；文章标题；文章文本；文章在线日期；文章状态；...

**档案**

> 档案ID；档案名称

**dossier_articles**

> dosar_id; dosar_dossier_id; dosar_article_id

我将如何创建 mysql 查询？像这样的东西：

> 从文章中选择 article_title、article_text、article_onlinedate LEFT JOIN dossier_articles ON dossier_articles.dosar_dossier_id =articles.article_id WHERE article_status = '1' AND dossier_articles.dosar_dossier_id = '".mysql_real_escape_string($currentDossier)."' AND article_onlinedate < '".date(' YmdHis')."' ORDER BY article_onlinedate DESC

我真的不知道这是否接近正确。有人可以发光吗？

非常感谢！

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-07-18T13:48:33.647

您可以在 MySQL 中执行此操作：

```
article_onlinedate < '".date('YmdHis')."' 
```

应该

```
article_onlinedate < NOW() 
```

这样 MySQL 将生成正确的标记。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-07-18T13:48:07.750

你可以参考这里给出的例子

左连接和[MySQL 左连接优化](http://dev.mysql.com/doc/refman/5.0/en/left-join-optimization.html)[示例](http://www.tizag.com/mysqlTutorial/mysqlleftjoin.php/)

# assembly - 如何在汇编中使用 DIV 操作

> ID：11542837
> 
> 赞同：1
> 
> 时间：2012-07-18T13:43:50.433
> 
> 标签：assembly

```
.MODEL SMALL
.STACK 64
.DATA

MSGA DB 13,10,"Input first number: ","$"
MSGB DB 13,10,"Input second number:","$"
MSGC DB 13,10,"The quotient is: ","$"
MSGD DB 13,10,"The modulo is: ","$"

NUM1 db ?
NUM2 db ?

.CODE

MAIN PROC NEAR

MOV AX, @DATA
MOV DS, AX

; get first number
LEA DX, MSGA
MOV AH, 09h
INT 21h

MOV AH, 01
INT 21H
SUB AL, '0'

MOV BL, AL

; get second number
LEA DX, MSGB
MOV AH, 09h
INT 21h

MOV AH, 01
INT 21H
SUB AL, '0'

MOV CL, AL
MOV AL, BL

; divide
DIV CL
MOV NUM1, AL
ADD NUM1, '0'
MOV NUM2, AH
ADD NUM2, '0'

; output quotient
LEA DX, MSGC
MOV AH, 09h
INT 21h

MOV DL, NUM1
MOV AH, 02H
INT 21h

; output remainder/modulo
LEA DX, MSGD
MOV AH, 09h
INT 21h

MOV DL, NUM2
MOV AH, 02H
INT 21h

MOV AH, 4Ch
INT 21h

MAIN ENDP
END MAIN 
```

我是汇编语言的新手，我遇到了 DIV 操作的问题。

如果 1 位数除以 1 位数，这应该输出商和余数。我的代码有什么问题？

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2012-07-18T16:47:37.790

`DIV`使用指令的8 位除法需要`AX`被除数和除数的操作数。

我已经更正了代码的除法部分和堆栈大小。堆栈大小至少应为 1000，否则您的程序可能会由于堆栈存储空间不足而崩溃。下面是代码。

```
.MODEL SMALL
.STACK 2000
.DATA

MSGA DB 13,10,"Input first number: ","$"
MSGB DB 13,10,"Input second number: ","$"
MSGC DB 13,10,"The quotient is: ","$"
MSGD DB 13,10,"The modulo is: ","$"

NUM1 db ?
NUM2 db ?

.CODE

MAIN PROC NEAR

MOV AX, @DATA
MOV DS, AX

; get first number
LEA DX, MSGA
MOV AH, 09h
INT 21h

MOV AH, 01
INT 21H
SUB AL, '0'

MOV BL, AL

; get second number
LEA DX, MSGB
MOV AH, 09h
INT 21h

MOV AH, 01
INT 21H
SUB AL, '0'

MOV CL, AL

; divide
MOV AH, 0 ; prepare dividend
MOV AL, BL
DIV CL
MOV NUM1, AL
ADD NUM1, '0'
MOV NUM2, AH
ADD NUM2, '0'

; output quotient
LEA DX, MSGC
MOV AH, 09h
INT 21h

MOV DL, NUM1
MOV AH, 02H
INT 21h

; output remainder/modulo
LEA DX, MSGD
MOV AH, 09h
INT 21h

MOV DL, NUM2
MOV AH, 02H
INT 21h

MOV AH, 4Ch
INT 21h

MAIN ENDP
END MAIN 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-04-22T16:15:16.133

```
.MODEL SMALL
.STACK 100H
.DATA                   
    CF EQU 0DH
    LF EQU 0AH

        ; Data Definition Starts Here

            msg11 db            '                    Enter Divisor  (0 - 9)  : $'
            msg12 db  cf,lf,    '                    Enter Dividend (0 - 9)  : $'
            msg13 db cf,lf,     '                       The Quotient is   : $' 
            msg14 db cf,lf,     '                     ! Division is Impossible !   $' 
            e db ?
            f db ? 

        ; Data Definition Ends Here

            msgch1 DB CF,LF,CF,LF,CF,LF,            '                ******************************************* :  $ '
            msgch2 DB CF,LF,            '                *  Press [ 1 | 0 ] To [ Continue | Exit ]   *  $ '
            msgch3 DB CF,LF,            '                ******************************************* :  $ '
.CODE

    MAIN PROC       
        MOV AX,@DATA                
        MOV DS,AX                   

    divp:
        mov  ah,0   
            mov  al,3
            int  10h

        MOV AX,0600h          
        MOV BH,71H            
        MOV CX,0000H          
        MOV DX,184FH
        INT 10H

        ; Program Starts Here

            MOV AH,9                    
            LEA DX,MSG12                
            INT 21H                 

            MOV AH,1
            INT 21H     
            MOV f,AL        
            INT 21H

            MOV AH,9                    
            LEA DX,MSG11                
            INT 21H                 

            MOV AH,1
            INT 21H     
            MOV e,AL        
            INT 21H

            mov dl,e        
            mov bl,f

            mov al,31h      

            cmp dl,30h
            jle div2

            cmp bl,30h
            jle div4

            cmp dl,bl
            jnle div2

        div1:
            sub bl,e
            add bl,30h

            cmp bl,30h
            jle div3

            add al,31h
            add al,-30h

            jmp div1

        div2:
            mov ah,9
            lea dx,msg14
            int 21h

            jmp divf        

        div3:

            mov ah,9
            lea dx,msg13
            int 21h

            mov ah,2
            mov dl,al
            int 21h

            jmp divf

        div4:

            mov ah,9
            lea dx,msg13
            int 21h

            mov ah,2
            mov dl,30h
            int 21h

            jmp divf

        divf:

        ; Program Ends Here

        ; Repitition Loop Starts Here

            MOV AH,2                
            mov dl,0ah              
            INt 21h

            MOV AH,9                
            LEA DX,msgch1               
            INT 21H

            MOV AH,9                
            LEA DX,msgch2               
            INT 21H

            MOV AH,9                
            LEA DX,msgch3               
            INT 21H

            MOV AH,1
            INT 21H
            MOV BL,AL
            INT 21H

            CMP BL,31H

            jl divlp
            jg divlp

            jmp divp        

        divlp:

        ; Repitition Loop Ends Here

        mov  ah,0   
            mov  al,3
            int  10h    

        MOV AH,4CH
        INT 21H         
        MAIN ENDP       
END MAIN 
```

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2013-09-12T18:07:44.530

你在你的程序中所做的一切都是正确的，除了一个。除法运算用完 AX 寄存器。如果您只使用 AL 进行除法，则必须首先清除 AH 寄存器。如果 AH 中存储了一个预值，则 AX 寄存器将包含该值，并且 AX 的最终值将与您期望的不同:)

此外，如果您不使用 Jumps、Call、Push 或 Pop，则无需使用堆栈段，因此您可以将其删除 :)

资料来源：经验

这是在注释中进行更改的代码：

```
.MODEL SMALL
.DATA

MSGA DB 13,10,"Input first number: ","$"
MSGB DB 13,10,"Input second number:","$"
MSGC DB 13,10,"The quotient is: ","$"
MSGD DB 13,10,"The modulo is: ","$"

NUM1 db ?
NUM2 db ?

.CODE

MAIN PROC NEAR

MOV AX, @DATA
MOV DS, AX

; get first number
LEA DX, MSGA
MOV AH, 09h
INT 21h

MOV AH, 01
INT 21H
SUB AL, '0'

MOV BL, AL

; get second number
LEA DX, MSGB
MOV AH, 09h
INT 21h

MOV AH, 01
INT 21H
SUB AL, '0'

;//CHANGES MADE HERE
MOV AH, 00h    ;Div operation requires AX register, if you are using only al, ah must be clear
;//END CHANGES

MOV CL, AL
MOV AL, BL

; divide
DIV CL
MOV NUM1, AL
ADD NUM1, '0'
MOV NUM2, AH
ADD NUM2, '0'

; output quotient
LEA DX, MSGC
MOV AH, 09h
INT 21h

MOV DL, NUM1
MOV AH, 02H
INT 21h

; output remainder/modulo
LEA DX, MSGD
MOV AH, 09h
INT 21h

MOV DL, NUM2
MOV AH, 02H
INT 21h

MOV AH, 4Ch
INT 21h

MAIN ENDP
END MAIN 
```

# ruby-on-rails-3 - 从 Padrino 到 Rails 3.2 - 瘦控制器

> ID：11542840
> 
> 赞同：1
> 
> 时间：2012-07-18T13:44:04.533
> 
> 标签：ruby-on-rails-3, padrino

我对 Rails 3.2 有点迷茫。我曾经使用以下方法在 Padrino 中创建瘦控制器：

```
 15   post :task, :provides => :js do
 16     result = execute(params)
 17     render "home/task"
 18   end 
```

某些方法并不完全与模型交互。在 Rails 3.2 中，我不能在控制器中使用帮助器来使它们变得干净（如 Rails 2.x 或 Padrino）。我已经创建了一些这样的方法：

```
 10   def show                                                                                                                                               
 11     @server = server_details                                                                                                                             
 12     respond_with(@server) if request_match_server_address?                                                                                               
 13   end 
```

但是将代码从 ServersController 移到了 ApplicationController，假设它是临时的，现在 application_controller 又丑又大（肯定有三个 g）。

如何让我的控制器美观？放置 server_details 等方法的正确位置在哪里？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-11-04T20:44:56.073

在路线.rb

```
post "/task", to: "tasks#show" 
```

在 tasks_controller.rb

```
respond_to :js
def show
  @result = execute(params)
  respond_with @result
end 
```

这将自动使用视图`tasks/show.js`

祝你好运

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-07-02T16:43:22.003

montrealmike 的答案是如何将您的 Padrino 转换为 Rails 3。

但是要回答您提出的问题（使用“？”），
您可以在 Rails 3 中使用帮助程序，因为只有普通的 ruby​​ 模块。

你只需要包括它们：

```
include ServerHelper
def show
  @server = server_details
  respond_with(@server) if request_match_server_address?
end 
```

你在哪里有 app/helpers/server_helper.rb

```
module ServerHelper do
  def server_details
    ...
  end
  def request_match_server_address?
    ...
  end
end 
```

**编辑：**您也可以将它们包含在 ApplicationController 中，它们将像所有其他好的小类一样被继承。

# node.js - NVM 和 Node.js - 推荐安装给所有用户

> ID：11542846
> 
> 赞同：70
> 
> 时间：2012-07-18T13:44:13.407
> 
> 标签：node.js, nvm

是否有推荐的 nvm 安装以便所有用户都可以使用？我在网上找不到任何关于此的内容。

这就是我所做的

*   将 nvm 安装在一个公共目录中
*   将所有用户的 nvm.sh 脚本位置放在 .profile 中
*   创建了一个 nvm/alias 目录（如果其他用户不在这里，nvm 会抱怨）

那么每个用户必须要么运行“nvm use”，要么默认将其放入他们的配置文件中

不确定是否有更好的方法？

谢谢

* * *

## 回答 #1

> 赞同：53
> 
> 时间：2013-09-26T23:27:34.500

这是我所做的：

1.  `nvm`以`/opt/nvm`root身份安装。似乎是一个合适的位置。

    ```
    # git clone git@github.com:creationix/nvm.git /opt/nvm 
    ```

2.  创建了目录`/usr/local/nvm`。这是下载的地方（`$NVM_DIR`）

    ```
    # mkdir /usr/local/nvm 
    ```

3.  创建目录`/usr/local/node`。这就是 NPM 全局内容的去向：

    ```
    # mkdir /usr/local/node 
    ```

4.  创建了一个名为`nvm.sh`in的文件`/etc/profile.d`，其内容如下：

    ```
    export NVM_DIR=/usr/local/nvm
    source /opt/nvm/nvm.sh

    export NPM_CONFIG_PREFIX=/usr/local/node
    export PATH="/usr/local/node/bin:$PATH" 
    ```

5.  重新登录到 shell 会话，然后设置默认节点版本。

    ```
    # nvm install 0.10
    # nvm alias default 0.10 
    ```

`PATH`下次登录到 shell 会话时，节点二进制文件现在应该在所有用户的目录中。NPM 会将全局的东西安装到`/usr/local/node`前缀。

* * *

## 回答 #2

> 赞同：41
> 
> 时间：2013-12-19T05:40:26.617

最好全局安装一份节点副本，以便其他用户可以访问它。为此，请运行以下命令（在提示符处输入您的用户密码）：

```
n=$(which node);n=${n%/bin/node}; chmod -R 755 $n/bin/*; sudo cp -r $n/{bin,lib,share} /usr/local 
```

这个建议是将您通过 nvm 激活的任何版本的节点复制到`/usr/local/`目录中并设置权限，以便所有用户都可以访问它们。

要检查它是否有效，请成为 root 用户并执行另一个 which 命令以确保该节点现在已安装到`/usr/local/bin`：

```
sudo -s
which node 
```

如果您想更改系统范围内安装的节点版本，只需执行另一个 nvm 使用 vXX.XX.XX 将您的用户节点切换到您想要的版本，然后重新运行上面的第一个命令将其复制到系统目录。

* * *

## 回答 #3

> 赞同：22
> 
> 时间：2017-02-24T18:27:16.277

1.  以root身份登录：`sudo -s`
2.  安装 nvm： `curl -o- https://raw.githubusercontent.com/creationix/nvm/v0.33.1/install.sh | NVM_DIR=/usr/local/nvm bash`
3.  创建了一个名为`nvm.sh`in的文件`/etc/profile.d`，其内容如下： `#!/usr/bin/env bash export NVM_DIR="/usr/local/nvm" [ -s "$NVM_DIR/nvm.sh" ] && \. "$NVM_DIR/nvm.sh" # This loads nvm`
4.  跑`/etc/profile.d/nvm.sh`
5.  安装节点：`nvm install node`
6.  可选择更新 npm：`npm install -g npm`

* * *

## 回答 #4

> 赞同：8
> 
> 时间：2020-04-06T08:44:11.317

在 Linux 服务器上安装 NVM，然后使用 NVM 安装节点版本（以 root 用户身份运行所有命令）。之后，为所有用户运行以下命令，获得可与 nvm 一起使用的 nodejs

```
n=$(which node);n=${n%/bin/node}; chmod -R 755 $n/bin/*; sudo cp -r $n/{bin,lib,share} /usr/local 
```

上面的命令有点复杂，但它所做的只是将您通过 nvm 激活的任何版本的节点复制到 /usr/local/ 目录（用户安装的全局文件应该位于 linux VPS/服务器上）并设置权限以便所有用户都可以访问它们。

/root/.nvm/versions/node/v8.10.0/bin/node **_**

切换用户名检查你的节点版本。

```
su - username
which node
/usr/local/bin/node 
```

* * *

## 回答 #5

> 赞同：5
> 
> 时间：2016-09-16T16:17:59.760

由于 LJHarb 建议不要在全局范围内安装它，因此我决定在您登录服务器时创建一个脚本来安装 nvm。我需要这个，因为我有几个*可以*登录的用户设置，但需要访问 pm2（监控我们的一个应用程序）。

在 /etc/profile.d/ 中创建脚本（例如命名为 nvm.sh）：

```
#!/bin/bash
NODE_VER=6.2.2
if [ ! -f ~/.nvm/nvm.sh ]; then
    # May need to be updated with the latest nvm release
    wget -qO- https://raw.githubusercontent.com/creationix/nvm/v0.32.0/install.sh | bash
fi
source ~/.nvm/nvm.sh
if ! command -v node | grep -q $NODE_VER; then
    echo "Node is not installed"
    nvm install $NODE_VER
    nvm alias default $NODE_VER
fi 
```

对于我们的应用程序，我们需要在用户之间共享 pm2：

```
if ! command -v pm2 &>/dev/null; then
    echo "pm2 not installed"
    npm install -g pm2
fi
# Share pm2 configuration between users
alias pm2='env HOME=/opt/sora pm2' 
```

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2018-11-06T19:54:41.007

还有这个为全球使用而设计的 nvm 分支：[https ://github.com/xtuple/nvm](https://github.com/xtuple/nvm)

```
wget -qO- https://raw.githubusercontent.com/xtuple/nvm/master/install.sh | sudo bash

sudo chown -R $USER /usr/local/nvm

nvm install 8 
```

更新：我尝试了各种方法来使用 xtuple 的 nvm 和 n 来管理全局节点环境，但我总是遇到有问题的边缘情况。最后，最适合我的是从他们的网站下载几个版本的 node 并将它们解压缩到 /usr/local。然后用我想要的版本更新我的路径。例如

```
export PATH=/usr/local/node-v7.10.1-linux-x64/bin:$PATH 
```

注意：您可能必须对节点路径进行 chmod 777 或指定一个用户来管理它。

* * *

## 回答 #7

> 赞同：0
> 
> 时间：2021-06-04T19:19:14.203

我有一个有两个用户的小型 VPS，由于空间有限，想避免安装多个节点副本

简单地将`$HOME/.nvm`具有 NVM 的用户转移到`/opt/nvm`所有`chmod -R 777 /opt/nvm`用户都可以写入

然后将每个用户设置`NVM_HOME`为`.bashrc``/opt/nvm`

对我来说似乎是最明显的解决方案，因为一个用户有一个预先存在的 .nvm 文件夹

回复：丑陋的权限，此副本仅用于开发目的 - 我建议任何在生产中使用节点的人不要考虑这种方法

# php - 如何让 PHP 结果显示博客风格

> ID：11542854
> 
> 赞同：1
> 
> 时间：2012-07-18T13:44:49.920
> 
> 标签：php, echo

好吧，这可能有点难以理解，但我会尽力描述我想要发生的事情......

我有一个 while 循环，它在代码上持续数千次。当它这样做时，我让它在每次循环增加一个值时打印出一行。回声每次都会在新行的页面上打印出来并继续向下页面（效果很好），但我想知道是否有办法让新的回声显示在页面的顶部而不是向下到页面底部（在其他结果下方）。所以简而言之，我想让循环中的每个没有回声都像博客文章（在顶部）一样显示出来。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-07-18T13:47:44.593

您最好[反转](http://php.net/manual/en/function.array-reverse.php)您正在迭代的数组。如果您不是迭代数组而是迭代一些 SQL 结果集，而不仅仅是在查询中添加一个 order 子句（或者`order by foo`，`order by foo ASC`两者都是**升序**或**降序**）。`order by foo DESC`

 **如果两者都不是，请执行以下操作：

```
$output = '';
while (something) {
  $output = 'blahblah' . $output;
}
echo $output; 
```

不管是什么情况；“几千次”听起来像是一个糟糕的计划。也许你需要[分页](http://en.wikipedia.org/wiki/Pagination)？

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-07-18T13:47:24.927

好吧，您只需要重新排序您的信息，例如，如果信息来自 sql 数据库，您应该使用**ORDER BY**语句按照您想要显示的顺序获取信息，这将使生活更轻松。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-07-18T13:53:15.643

不要立即回应你的结果。相反，将它们保存到一个字符串并将以前的结果附加到新的结果中。

```
$output = "";
do 
{
    $newresults = doWhatever();
    $output = $newresults . $output;
}
while( $stillWannaLoop == true );
echo $output; 
```**

# iphone - 可达性中的 UIAlertView 异常

> ID：11542857
> 
> 赞同：1
> 
> 时间：2012-07-18T13:44:58.310
> 
> 标签：iphone, ios, ios5, uialertview, reachability

我是 iOS 新手，在以编程方式关闭**UIAlertView时遇到问题。**

我在 .h 文件中声明了警报：

```
@interface ViewController : UIViewController<UIWebViewDelegate>{
    UIWebView *webView;
    UIAlertView *alert;
}

@property(nonatomic, retain) IBOutlet UIWebView *webView;
@property(nonatomic, retain) IBOutlet UIAlertView *alert; 
```

在 .m 文件中，我使用此警报警告用户有关互联网连接的信息：

```
@synthesize alert;
-(void) checkNetworkStatus:(NSNotification *)notice
{
// called after network status changes
NetworkStatus internetStatus = [internetReachable currentReachabilityStatus];
switch (internetStatus)
{
    case NotReachable:
    {
        NSLog(@"The internet is down.");
        self.internetActive = NO;
        alert = [[[UIAlertView alloc] initWithTitle:@"Network Unavailable" 
                                                         message:@"Internet connectivity could not be established!" 
                                                        delegate:self 
                                               cancelButtonTitle:nil 
                                               otherButtonTitles:nil] autorelease];
        [alert show];
        break;
    }
    default:
    {
        [alert dismissWithClickedButtonIndex:0 animated:NO];

    }
} 
```

}

现在，当互联网连接断开时，会出现警报。但是，当互联网连接建立时，程序会抛出异常，抱怨对对象的访问不正确。谁能告诉我我做错了什么？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-07-18T14:01:07.113

1-在你的头文件中实现 UIAlertViewDelegate

2-使用这种方法

```
 -(void)alertView:(UIAlertView *)alertView clickedButtonAtIndex:(NSInteger)buttonIndex
{

} 
```

在此方法中，根据单击按钮的索引关闭警报视图

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-07-18T13:49:43.920

```
[alert dismissWithClickedButtonIndex:0 animated:NO]; 
```

在所有其他情况下都会调用，并且在调用该方法时还没有为 alert 分配任何内存。也没有必要添加那条线。或者你可以像这样修改你的代码。

1.  保留对警报的引用（尽管这是一个非常糟糕的主意）
2.  在切换条件中检查是否显示了警报框，然后调用解除并释放警报视图

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-07-18T13:59:32.317

这应该有效：

```
 default:
    {
        if (alert){
            [alert dismissWithClickedButtonIndex:0 animated:NO];
        }
    } 
```

假设“警报”在你展示之前确实是“零”。

# android - 具有登录功能的应用程序的概念

> ID：11542862
> 
> 赞同：0
> 
> 时间：2012-07-18T13:45:09.630
> 
> 标签：android

假设我有 4 个活动：`Login`, `Sync`, `Main`, `Details`.

`Main`并且`Details`只有在用户登录并通过同步阶段时才能访问。`Main`可以从抽屉上的图标访问。`Details`可以`Main`从通知中访问。

用户在闲置 30 分钟后注销（使用服务上的计时器）。

我不确定应该采取哪种方式来确保用户已登录。这是我的两种情况：

*   图标启动`Login`检查用户是否登录，然后启动`Synch`，执行相同操作并启动`Main`。
*   图标`Main`启动检查用户是否登录，如果没有，则启动`Login`。`Login`关闭自身以显示`Main`它在后堆栈上。

然后还`Details`需要检查用户是否已登录。

第二种情况对我来说似乎更正确，因为它允许启动其他活动`Main`，但它会迫使我在需要用户登录的每个活动中复制检查代码。（我有超过 2 个活动）。

我为什么要走？为什么？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-07-18T13:57:56.403

您可以扩展`BaseActivity`实现所有检查代码的 a，然后`Activity`您使用的任何新代码都将内置它。

我在一个无需登录即可访问 50% 的活动的应用程序中使用它，并显示一个提示，`startActivityForResult(...)`用于捕捉登录尝试的成功或失败。

它工作得非常好，并且把所有东西都整齐地封装起来:)

**编辑**

这是一个可以根据需要修改的代码片段：

```
/**
 * This is an abstract class that all Activities will be based on.
 */
public abstract class BaseActivity extends ActionBarActivity
{
    protected static final int    SHOW_WALLET       = 100;
    protected static final int    SHOW_OFFER_DETAIL = 101;
    protected static final int    REGISTER          = 102;
    protected static final int    SHOW_ACCOUNT      = 103;

    protected static final int    LOGGED_IN_OK      = 103;
    protected static final int    REGISTERED_OK     = 104;

    protected static final int    DIALOG_DELAY      = 300;
    // for passing data in extras
    protected static final String TEXT_SEARCH       = "text_search";
    protected static final String SEARCH_TERM       = "search_term";

    protected boolean             mAlternateTitle   = false;
    private Dialog                loading;
    private Runnable              showDialog;   

         protected final void openAccount()
        {
            Intent i;
            if ( LoginManager.getInstance().isLoggedIn() )
            {
                i = new Intent( this, MyAccountActivity.class );
                startActivity( i );
            }
            else
            {
                i = new Intent( this, LoginActivity.class );
                startActivityForResult( i, SHOW_ACCOUNT );
            }
        }

} 
```

# javascript - 为什么图片不是链接？

> ID：11542866
> 
> 赞同：-1
> 
> 时间：2012-07-18T13:45:18.110
> 
> 标签：javascript, jquery, html, css

我有这个 JQuery 图像演示文稿，由于某种原因，我无法使用 ancor 标签来处理图像。这是我的页面： http: [//orhsfoundation.com/Trial](http://orhsfoundation.com/Trial)

我不知道这些是否需要，但你去

HTML：

```
<div id="allinone_bannerWithPlaylist_easy"  style="; ;  display: none;background-color: #03F;">
            <!-- IMAGES -->
        <a href="about.html"><img src="Assets/Images/01_easyPlaylist.jpg" alt=""  data-title="Lorem Ipsum Dolor1" data-text-id="#allinone_bannerWithPlaylist_photoText1" data-desc="Sed ut perspiciatis unde omnis iste natus error sit voluptatem accusantium doloremque hendrerit " border="0" /></a>

            <img src="Assets/Images/02_easyPlaylist.jpg" alt="" data-text-id="#allinone_bannerWithPlaylist_photoText2" data-title="Fusce Suscipit Risus2" data-desc="Phasellus vitae velit eu turpis consequat hendrerit. Curabitur vitae sapien libero, amet ornare lectus." />
            <img src="Assets/Images/03_easyPlaylist.jpg" alt="" data-text-id="#allinone_bannerWithPlaylist_photoText3" data-title="Class Aptent Taciti " data-desc="Maecenas interdum interdum enim id laoreet. Curabitur semper fermentum leo pretium eleifend." />
            <img src="Assets/Images/04_easyPlaylist.jpg" alt="" data-text-id="#allinone_bannerWithPlaylist_photoText4" data-title="Maecenas Lacus Ante" data-desc="Donec hendrerit magna sit amet eros lobortis non egestas diam scelerisque. Praesent molestie aliquet ipsum." /> 
            <img src="Assets/Images/05_easyPlaylist.jpg" alt="" data-text-id="#allinone_bannerWithPlaylist_photoText5" data-title="Lorem Ipsum Dolor" data-desc="Sed ut perspiciatis unde omnis iste natus error sit voluptatem accusantium doloremque hendrerit" />
            <img src="Assets/Images/06_easyPlaylist.jpg" alt="" data-text-id="#allinone_bannerWithPlaylist_photoText6" data-title="Suscipit Risus" data-desc="Phasellus vitae velit eu turpis consequat hendrerit. Curabitur vitae sapien libero, amet ornare lectus." />

          <img src="Assets/Images/01_easyPlaylist.jpg" alt="" data-text-id="#allinone_bannerWithPlaylist_photoText1" data-title="Lorem Ipsum Dolor1" data-desc="Sed ut perspiciatis unde omnis iste natus error sit voluptatem accusantium doloremque hendrerit " />
            <img src="Assets/Images/02_easyPlaylist.jpg" alt="" data-text-id="#allinone_bannerWithPlaylist_photoText2" data-title="Fusce Suscipit Risus2" data-desc="Phasellus vitae velit eu turpis consequat hendrerit. Curabitur vitae sapien libero, amet ornare lectus." />
            <img src="Assets/Images/03_easyPlaylist.jpg" alt="" data-text-id="#allinone_bannerWithPlaylist_photoText3" data-title="Class Aptent Taciti " data-desc="Maecenas interdum interdum enim id laoreet. Curabitur semper fermentum leo pretium eleifend." />
            <img src="Assets/Images/04_easyPlaylist.jpg" alt="" data-text-id="#allinone_bannerWithPlaylist_photoText4" data-title="Maecenas Lacus Ante" data-desc="Donec hendrerit magna sit amet eros lobortis non egestas diam scelerisque. Praesent molestie aliquet ipsum." /> 
            <img src="Assets/Images/05_easyPlaylist.jpg" alt="" data-text-id="#allinone_bannerWithPlaylist_photoText5" data-title="Lorem Ipsum Dolor" data-desc="Sed ut perspiciatis unde omnis iste natus error sit voluptatem accusantium doloremque hendrerit" />
            <img src="Assets/Images/06_easyPlaylist.jpg" alt="" data-text-id="#allinone_bannerWithPlaylist_photoText6" data-title="Suscipit Risus" data-desc="Phasellus vitae velit eu turpis consequat hendrerit. Curabitur vitae sapien libero, amet ornare lectus." />                                 

            <!-- TEXTS -->
            <div id="allinone_bannerWithPlaylist_photoText1" class="allinone_bannerWithPlaylist_texts">
                <div class="allinone_bannerWithPlaylist_text_line textbg_easy" data-initial-left="0" data-initial-top="100" data-final-left="-50" data-final-top="320" data-duration="0.5" data-fade-start="0" data-delay="0">
                <div class="textElement11_easy">Up to 5 types of banners</div>
                <div class="textElement12_easy">Each with multiple SKINS</div></div>
           </div>  

           <div id="allinone_bannerWithPlaylist_photoText2" class="allinone_bannerWithPlaylist_texts">
                <div class="allinone_bannerWithPlaylist_text_line textElement21_easy" data-initial-left="80" data-initial-top="50" data-final-left="30" data-final-top="30" data-duration="0.5" data-fade-start="0" data-delay="0">16 transition effects for images</div>
                <div class="allinone_bannerWithPlaylist_text_line textElement22_easy" data-initial-left="280" data-initial-top="80" data-final-left="30" data-final-top="90" data-duration="0.5" data-fade-start="0" data-delay="0.3">optional can set the transition for each image</div>
           </div> 

           <div id="allinone_bannerWithPlaylist_photoText3" class="allinone_bannerWithPlaylist_texts">
                <div class="allinone_bannerWithPlaylist_text_line textElement31_easy" data-initial-left="0" data-initial-top="50" data-final-left="40" data-final-top="35" data-duration="0.5" data-fade-start="0" data-delay="0">Animated text from any direction</div>
                <div class="allinone_bannerWithPlaylist_text_line textElement32_easy" data-initial-left="0" data-initial-top="90" data-final-left="40" data-final-top="66" data-duration="0.5" data-fade-start="0" data-delay="0.3">top, bottom, left and right</div>
                <div class="allinone_bannerWithPlaylist_text_line textElement33_easy" data-initial-left="0" data-initial-top="200" data-final-left="40" data-final-top="101" data-duration="1" data-fade-start="0" data-delay="0.5">Any color, CSS and HTML formated</div>               
           </div>  

           <div id="allinone_bannerWithPlaylist_photoText4" class="allinone_bannerWithPlaylist_texts">
                <div class="allinone_bannerWithPlaylist_text_line textbg_easy" data-initial-left="0" data-initial-top="100" data-final-left="0" data-final-top="287" data-duration="0.5" data-fade-start="0" data-delay="0">
                <div class="textElement41_easy">Lorem <a href="http://codecanyon.net/user/LambertGroup" target="_blank">Ipsum</a> Dolor Sit Amet</div>
                <div class="textElement42_easy">Consectetur Adiscipit</div></div>
           </div> 

            <div id="allinone_bannerWithPlaylist_photoText5" class="allinone_bannerWithPlaylist_texts">
                <div class="allinone_bannerWithPlaylist_text_line textElement51_easy" data-initial-left="30" data-initial-top="0" data-final-left="30" data-final-top="270" data-duration="0.5" data-fade-start="0" data-delay="0">Line One is here</div>
                <div class="allinone_bannerWithPlaylist_text_line textElement52_easy" data-initial-left="30" data-initial-top="384" data-final-left="30" data-final-top="250" data-duration="0.5" data-fade-start="0" data-delay="0.3">Line Two over there</div>
           </div> 
```

CSS（有一些被编辑）：

```
.allinone_bannerWithPlaylistBorder {
    position:relative;
}

/* the container */
.allinone_bannerWithPlaylist {
    position:relative;

}
.allinone_bannerWithPlaylist img {
    position:absolute;
    top:0px;
    left:0px;
    max-width:100%;
    max-height:100%;    
}
.allinone_bannerWithPlaylist .stripe {
    position:absolute;
    display:block;  
    height:100%;
    z-index:1;
}
.allinone_bannerWithPlaylist .block {
    position:absolute;
    display:block;  
    z-index:1;
        }

/***ELEGANT SKIN***/

.allinone_bannerWithPlaylist.elegant .bannerControls {
    position:absolute;
    left:0;
    top:0;
    z-index:2;
}

.allinone_bannerWithPlaylist.elegant .leftNav {
    position:absolute;
    left:0px;
    top:50%;
    margin-top:-35px; /* height/2 */
    width:31px;
    height:71px;
    background:url(leftNavOFF.png) 0 0 no-repeat;
    cursor: pointer;
}

.allinone_bannerWithPlaylist.elegant .leftNav:hover {
    background:url(leftNavON.png) 0 0 no-repeat;
}
.allinone_bannerWithPlaylist.elegant .rightNav {
    position:absolute;
    right:0px;
    top:50%;
    margin-top:-35px; /* height/2 */
    width:31px;
    height:71px;
    background:url(rightNavOFF.png) 0 0 no-repeat;
    cursor: pointer;
}
.allinone_bannerWithPlaylist.elegant .rightNav:hover {
    background:url(rightNavON.png) 0 0 no-repeat;
}
.allinone_bannerWithPlaylist.elegant .thumbsHolderWrapper {
    position:absolute;
    background:#e9e9e9;
    /*height:121px;
    width:100%;*/
    height:100%;
    overflow:hidden;
}
.allinone_bannerWithPlaylist.elegant .thumbsHolderVisibleWrapper {
    position:absolute;
    /*width:100%;
    height:121px;*/
    height:100%;
    overflow:hidden;
}
.allinone_bannerWithPlaylist.elegant .thumbsHolder {
    position:absolute;
}
.allinone_bannerWithPlaylist.elegant .thumbsHolder_ThumbOFF {
    display:block;
    height:110px;
    background:#cfcfcf;
    text-align:left;
    line-height:1.4em;
    cursor: pointer;
}
.allinone_bannerWithPlaylist.elegant .thumbsHolder_ThumbOFF  .padding {
    padding:10px;
}
.allinone_bannerWithPlaylist.elegant .thumbsHolder_ThumbOFF .title {
    font: bold 13px 'Droid Sans', sans-serif;
    color:#000;
    display:inline-block;
    padding-bottom:5px;
}
.allinone_bannerWithPlaylist.elegant .thumbsHolder_ThumbOFF .reg {
    font: 11px Arial, sans-serif;
    color:#000;
    line-height:1.4em;
}

.allinone_bannerWithPlaylist.elegant .thumbsHolder_ThumbOFF img {
    position:relative;
    float:left;
    margin-right:10px;
}

.allinone_bannerWithPlaylist.elegant .thumbsHolder_ThumbON {
    background:#611731;
}
.allinone_bannerWithPlaylist.elegant .thumbsHolder_ThumbON .title {
    color:#ff771c;
}
.allinone_bannerWithPlaylist.elegant .thumbsHolder_ThumbON .reg {
    color:#FFF;
}

/*  scroller start */
.allinone_bannerWithPlaylist.elegant .slider-vertical {
    display:none;
    position:absolute;
    width:6px;
}

.allinone_bannerWithPlaylist.elegant .slider-vertical.ui-slider { position: relative;}
.allinone_bannerWithPlaylist.elegant .slider-vertical.ui-slider .ui-slider-handle { position: absolute; z-index: 2; width: 6px; height: 25px; cursor: pointer; background:url(scrollerFaceOFF.png) 0 0 no-repeat; }
.allinone_bannerWithPlaylist.elegant .slider-vertical.ui-slider .ui-slider-handle:hover { background:url(scrollerFaceON.png) 0 0 no-repeat; }
.allinone_bannerWithPlaylist.elegant .slider-vertical.ui-slider .ui-slider-range { position: absolute; z-index: 1; display: block; border: 0; }

.allinone_bannerWithPlaylist.elegant .slider-vertical.ui-slider-vertical { width: 6px; height: 100px; }
.allinone_bannerWithPlaylist.elegant .slider-vertical.ui-slider-vertical .ui-slider-handle { left: 0px; margin-left: 0px; margin-bottom: -25px;; border: 0; }
.allinone_bannerWithPlaylist.elegant .slider-vertical.ui-slider-vertical .ui-slider-range { left: 0; width: 100%; }
.allinone_bannerWithPlaylist.elegant .slider-vertical.ui-slider-vertical .ui-slider-range-min { bottom: 0; }
.allinone_bannerWithPlaylist.elegant .slider-vertical.ui-slider-vertical .ui-slider-range-max { top: 0; }

/* Component containers
----------------------------------*/
.allinone_bannerWithPlaylist.elegant .slider-vertical.ui-widget-content { xbackground: #FF0000; }
.allinone_bannerWithPlaylist.elegant .slider-vertical .ui-widget-header { xbackground: #0000cc; }

/* Corner radius */
.allinone_bannerWithPlaylist.elegant .slider-vertical.ui-corner-all {}

/* Interaction states
----------------------------------
.allinone_bannerWithPlaylist.elegant .slider-vertical.ui-state-default {background: #000000; }
.allinone_bannerWithPlaylist.elegant .slider-vertical.ui-state-hover { background: #FFF000;  }
*/
/*  scroller end */

/***EASY SKIN***/

.allinone_bannerWithPlaylist.easy .bannerControls {
    position:absolute;
    left:0;
    top:0;
    z-index:2;
}

.allinone_bannerWithPlaylist.easy .leftNav {
    position:absolute;
    left:5px;
    top:50%;
    margin-top:-35px; /* height/2 */
    width:41px;
    height:41px;
    background:url(Assets/Images/Banner/skins/easy/leftNavOFF.png) 0 0 no-repeat;
    cursor: pointer;

}

.allinone_bannerWithPlaylist.easy .leftNav:hover {
    background:url(Assets/Images/Banner/skins/easy/leftNavON.png) 0 0 no-repeat;
}
.allinone_bannerWithPlaylist.easy .rightNav {
    position:absolute;
    right:5px;
    top:50%;
    margin-top:-35px; /* height/2 */
    width:41px;
    height:41px;
    background:url(Assets/Images/Banner/skins/easy/rightNavOFF.png) 0 0 no-repeat;
    cursor: pointer;
}
.allinone_bannerWithPlaylist.easy .rightNav:hover {
    background:url(Assets/Images/Banner/skins/easy/rightNavON.png) 0 0 no-repeat;
}

.allinone_bannerWithPlaylist.easy .thumbsHolderWrapper {
    position:absolute;
    background:#e9e9e9;
    height:100%;
    overflow:hidden;
    width:100%;
}

.allinone_bannerWithPlaylist.easy .thumbsHolderVisibleWrapper {
    position:absolute;
    height:100%;
    overflow:hidden;

}

.allinone_bannerWithPlaylist.easy .thumbsHolder {
    position:absolute;

}

.allinone_bannerWithPlaylist.easy .thumbsHolder_ThumbOFF {
    display:block;
    height:96px;
    background:url(Assets/Images/Banner/skins/easy/bgPlaylistUnit.png) top left repeat-x;
    text-align:left;
    line-height:1.4em;
    cursor: pointer;
}
.allinone_bannerWithPlaylist.easy .thumbsHolder_ThumbOFF  .padding {
    padding:10px;
}
.allinone_bannerWithPlaylist.easy .thumbsHolder_ThumbOFF .title {
    font: bold 13px 'Droid Sans', sans-serif;
    color:#000;
    display:inline-block;
    padding-bottom:5px;
}
.allinone_bannerWithPlaylist.easy .thumbsHolder_ThumbOFF .reg {
    font: 11px Arial, sans-serif;
    color:#000;
    line-height:1.4em;
}
/****
.allinone_bannerWithPlaylist.easy .thumbsHolder_ThumbOFF img {
    position:relative;
    float:left;
    margin-right:10px;
}/****/

.allinone_bannerWithPlaylist.easy .thumbsHolder_ThumbON {
    /*background: #611731 url(skins/easy/thumbActiveArrow.png) -3px 0px no-repeat;*/
    background: #611731;
    z-index:4;
}

.allinone_bannerWithPlaylist.easy .thumbsHolder_ThumbON .title {
    color:#ff771c;
}
.allinone_bannerWithPlaylist.easy .thumbsHolder_ThumbON .reg {
    color:#FFF;
}

/*  scroller start */
.allinone_bannerWithPlaylist.easy .slider-vertical {
    display:none;
    position:absolute;
    width:6px;
}

.allinone_bannerWithPlaylist.easy .slider-vertical.ui-slider { position: relative;}
.allinone_bannerWithPlaylist.easy .slider-vertical.ui-slider .ui-slider-handle { position: absolute; z-index: 2; width: 6px; height: 25px; cursor: pointer; background:url(Assets/Images/Banner/skins/easy/scrollerFaceOFF.png) 0 0 no-repeat; }
.allinone_bannerWithPlaylist.easy .slider-vertical.ui-slider .ui-slider-handle:hover { background:url(Assets/Images/Banner/skins/easy/scrollerFaceON.png) 0 0 no-repeat; }
.allinone_bannerWithPlaylist.easy .slider-vertical.ui-slider .ui-slider-range { position: absolute; z-index: 1; display: block; border: 0; }

.allinone_bannerWithPlaylist.easy .slider-vertical.ui-slider-vertical { width: 6px; height: 100px; }
.allinone_bannerWithPlaylist.easy .slider-vertical.ui-slider-vertical .ui-slider-handle { left: 0px; margin-left: 0px; margin-bottom: -25px;; border: 0; }
.allinone_bannerWithPlaylist.easy .slider-vertical.ui-slider-vertical .ui-slider-range { left: 0; width: 100%; }
.allinone_bannerWithPlaylist.easy .slider-vertical.ui-slider-vertical .ui-slider-range-min { bottom: 0; }
.allinone_bannerWithPlaylist.easy .slider-vertical.ui-slider-vertical .ui-slider-range-max { top: 0; }

/* Component containers
----------------------------------*/
.allinone_bannerWithPlaylist.easy .slider-vertical.ui-widget-content { xbackground: #FF0000; }
.allinone_bannerWithPlaylist.easy .slider-vertical .ui-widget-header { xbackground: #0000cc; }

/* Corner radius */
.allinone_bannerWithPlaylist.easy .slider-vertical.ui-corner-all {}

/***EASY TEXTS***/

.textbg_easy {
    width:690px;
    background:url(Assets/Images/Banner/skins/easy/textBg_transparency.png);
    padding:5px 10px 5px 10px;

}

.textElement11_easy {
    font: bold 24px 'Droid Sans', Verdana, Helvetica, sans-serif;
    text-transform:uppercase;
    padding:0px 10px 3px 10px;
    color:#ffffff;
}
.textElement12_easy {
    font: bold 18px 'Droid Sans', Verdana, Helvetica, sans-serif;
    text-transform:uppercase;
    padding:0px 10px 3px 10px;
    color:#ffffff;
}

.textElement21_easy {
    width:265px;
    background:#512d5d;
    font: bold 22px 'Droid Sans', Verdana, Helvetica, sans-serif;
    text-transform:uppercase;
    padding:5px 10px 5px 10px;
    color:#ffffff;
}
.textElement22_easy {
    width:240px;
    background:#611731;
    font: bold 14px 'Droid Sans', Verdana, Helvetica, sans-serif;
    padding:7px 10px 7px 10px;
    color:#ffffff;
}

.textElement31_easy {
    background:#d61d1d;
    font: bold 18px 'Droid Sans', Verdana, Helvetica, sans-serif;
    text-transform:uppercase;
    padding:5px 10px 5px 10px;
    color:#ffffff;
}
.textElement32_easy {
    background:#ffffff;
    font: bold 18px 'Droid Sans', Verdana, Helvetica, sans-serif;
    padding:7px 10px 7px 10px;
    color:#000000;
}

.textElement33_easy {
    background:#000000;
    font: bold 18px 'Droid Sans', Verdana, Helvetica, sans-serif;
    padding:7px 10px 7px 10px;
    color:#ffffff;
}

.textElement41_easy {
    font: bold 24px 'Droid Sans', Verdana, Helvetica, sans-serif;
    text-transform:uppercase;
    padding:0px 10px 3px 10px;
    color:#ffffff;
}

.textElement41_easy a {
    text-decoration:none;
    color:#ff771c;
}

.textElement41_easy a:hover {
    color:#c1dd56;
}

.textElement42_easy {
    font: bold 18px 'Droid Sans', Verdana, Helvetica, sans-serif;
    text-transform:uppercase;
    padding:0px 10px 3px 10px;
    color:#ffffff;
}

.textElement51_easy {
    font: bold 38px 'Droid Sans', Verdana, Helvetica, sans-serif;
    text-transform:uppercase;
    padding:6px 15px 6px 15px;
    color:#000000;
}
.textElement52_easy {
    font: bold 20px 'Droid Sans', Verdana, Helvetica, sans-serif;
    text-transform:uppercase;
    padding:6px 15px 6px 15px;
    color:#000000;
}

.textElement_easy {
    background:#512d5d;
    padding:10px;
    color:#FFF;
}
.textElement2_easy {
    background:#FF0000;
    padding:10px;
    color:#FFF;
}

.allinone_bannerWithPlaylist_texts {
    position:absolute;
    z-index:3;
    display:none;
    width:100%;
    text-align:left;
}

.allinone_bannerWithPlaylist_text_line {
    position:absolute;
}

.hideElement {
    display:none;
} 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-07-18T14:26:17.990

简要查看您的 allinone_bannerWithPlaylist.js 文件。看起来它通过剥离图像标签的 src 属性并将其设置为它创建的一系列 div 的背景图像来生成幻灯片。因此，您的图像没有被链接，因为您的图像（您放入 HTML 中）不是实际显示的内容。这种行为是允许列在“百叶窗式”过渡中的原因。

这就是你的答案。我的修复建议是找到一个可能更适合您需求的不同 jquery 幻灯片插件。您可能会失去柱状过渡，但您会获得链接。

# css - CSS：基于它们出现的顺序而不是类来样式化列表项？

> ID：11542870
> 
> 赞同：0
> 
> 时间：2012-07-18T13:45:30.787
> 
> 标签：css, css-selectors, html-lists

我使用的 CMS 生成的站点地图几乎没有样式选项，基本上，它不允许我向列表项添加类，我需要它们为它们提供不同的背景颜色。

现在我知道有 first-child 和 last-child 伪类可以让我为列表中的第一个和最后一个项目设置样式，但是如果一个类可以，是否有任何 CSS 允许我调用列表中的其他项目不被分配给他们？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-07-18T13:50:58.610

[`:nth-child()`](http://www.w3.org/TR/css3-selectors/#nth-child-pseudo)从 CSS3使用：

```
/* select the third element if it's an li */
li:nth-child(3) {
    background-color: yellow;
} 
```

[`:nth-child()`](http://caniuse.com/css-sel3)在 IE8 等旧浏览器中[无法使用，但](http://caniuse.com/css-sel3)[有一个 CSS2 解决方法](https://stackoverflow.com/questions/8492121/ie8-nth-child-and-before/8492882#8492882)。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-07-18T13:51:23.960

[`nth-child`](http://reference.sitepoint.com/css/pseudoclass-nthchild),[`nth-of-type`](http://reference.sitepoint.com/css/pseudoclass-nthoftype)

**例子：**

选择列表中的第二项

```
li:nth-child(2) {/*styles*/} 
```

选择奇数列表项

```
li:nth-child(odd) {/*styles*/} 
```

选择第 3 个、第 6 个、第 9 个、... 列表项

```
li:nth-child(3n) {/*styles*/} 
```

选择第 1 个、第 5 个、第 9 个、... 列表项

```
li:nth-child(4n+1) {/*styles*/} 
```

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-07-18T13:52:02.907

CSS2 不支持 :nth-child(n)，也许你可以为 < ul > 制作背景图像，颜色在正确的位置。但我说用旧浏览器搞砸的人;）

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2012-07-18T13:52:13.243

使用 CSS2，也许不是。使用 CSS3，有`nth-child()`选择器：

```
element:nth-child(2) { ... } 
```

以上将得到第二个孩子。

[jsFiddle](http://jsfiddle.net/xkEaW/)

否则，您可以使用 JavaScript/jQuery 来获得您想要的结果。这是一个 jQuery 示例：

```
$(function () {
    $('selector').eq(1).css('background', 'blue');
});​ 
```

[jsFiddle](http://jsfiddle.net/xkEaW/1/)

# javascript - knockout.js foreach，使用 2 n 个深度数组构建列表视图

> ID：11542880
> 
> 赞同：0
> 
> 时间：2012-07-18T13:45:48.163
> 
> 标签：javascript, jquery, listview, jquery-mobile, knockout.js

尝试使用淘汰赛和 jquery mobile 构建树形结构。使用 listview 并插入项目，我的对象有 2 个数组，其中 1 为 n 深，另一个持有 n 个对象，这些对象应该在每个级别的第一个数组之后列出。

制作了 2 个小提琴，以便更轻松地解释我正在尝试做的事情。

它试图实现的目标：http: [//jsfiddle.net/Qwark/gDTtd/](http://jsfiddle.net/Qwark/gDTtd/)

我有什么：http: [//jsfiddle.net/Qwark/NJZrN/13/](http://jsfiddle.net/Qwark/NJZrN/13/)

编辑：在此处添加源。以防万一小提琴发生了什么事。

它试图实现的目标：

```
<div id="myPage" data-role="page" data-theme="b">
  <div data-role="header">The header</div>
  <div data-role="content">        
    <div id="orgjson">
        <ul data-role="listview">
            <li>
                <span>CompanyRoot</span>
                <ul data-role="listview">
                    <li><span>Department1</span>
                        <ul data-role="listview">
                            <li>
                                <span>Department1.1</span>
                                <ul data-role="listview">
                                    <li><span>Dep1.1 Employee1</span></li>
                                    <li><span>Dep1.1 Employee2</span></li>
                                </ul>
                            </li>
                            <li>
                                <span>Department1.2</span>
                                <ul data-role="listview">
                                    <li><span>Dep1.2 Employee1</span></li>
                                    <li><span>Dep1.2 Employee2</span></li>
                                    <li><span>Dep1.3 Employee1</span></li>
                                </ul>
                            </li>                                
                            <li><span>Dep1 Employee1</span></li>
                            <li><span>Dep1 Employee2</span></li>
                            <li><span>Dep1 Employee3</span></li>
                        </ul>  
                    </li>
                    <li><span>Department2</span>
                        <ul data-role="listview">
                            <li>
                                <span>Department2.1</span>
                                <ul data-role="listview">
                                    <li><span>Dep2.1 Employee1</span></li>
                                    <li><span>Dep2.1 Employee2</span></li>
                                </ul>
                            </li>
                            <li>
                                <span>Department2.2</span>
                                <ul data-role="listview">
                                    <li><span>Dep2.2 Employee1</span></li>
                                    <li><span>Dep2.2 Employee2</span></li>
                                </ul>
                            </li>                                
                            <li><span>Dep2 Employee1</span></li>
                            <li><span>Dep2 Employee2</span></li>
                        </ul>  
                    </li>

                    <li><span>Root Employee1</span></li>
                    <li><span>Root Employee2</span></li>
                </ul>                                        
            </li>                                
        </ul>          

    </div>
</div> 
```

我有什么html：

```
<div id="myPage" data-role="page" data-theme="b">
   <div data-role="header">The header</div>
   <div data-role="content">        
      <ul data-bind="listview: true, template: {name: 'depTmpl', foreach: DepTree         }"></ul>   
    </div>    
</div>

<script id="depTmpl" type="text/html">
  <li>
    <span data-bind="text: depname"></span>
    <ul data-bind="listview: true, template: {name: 'depTmpl', foreach: departments}">
      </ul>
   </li>

    <!-- I do not know what should go here or if this is the right place at all -->
    <!-- I want to list employes after all Departments -->    
</script> 
```

我有什么js：

```
 function Department(depid, depname) {
    this.depid = depid;
    this.depname = depname;
    this.departments = new Array();
    this.employees = new Array();

    this.addDepartment = function (newdep) {
        this.departments.push(newdep);
    };
    this.addEmployee = function (newEmp) {
        this.employees.push(newEmp);
    };
};

function Employee(empid, empname) {
    this.empid = empid;
    this.empname = empname;
};

ko.bindingHandlers.listview = {
    update: function (element, valueAccessor, allBindingsAccessor, viewModel) {
        setTimeout(function () {
            $(element).attr('data-role', 'listview');
            $(element).listview();
        }, 0);
    }
};   

DepViewModel = function () {
    this.DepTree = SetupDepTree();
};

SetupDepTree = function () {//testdata, indented for easy reading
    var CompanyRoot= new Department("D0", "Root");
    var dep1 = new Department("D1", "Department1");        
        var dep11 = new Department("D1.1", "Department1.1");    
            var REmp111 = new Employee("E1.1.1", "Employee111");
            var REmp112 = new Employee("E1.1.2", "Employee112");                
            dep11.addEmployee(REmp111);
            dep11.addEmployee(REmp112);
        var dep12 = new Department("D1.2", "Department1.2");
            var REmp121 = new Employee("E1.2.1", "Employee121");            
            var REmp122 = new Employee("E1.2.2", "Employee122");
            var REmp123 = new Employee("E1.2.3", "Employee123");
            dep12.addEmployee(REmp121);
            dep12.addEmployee(REmp122);
            dep12.addEmployee(REmp123);            
        var REmp11 = new Employee("E1.1", "Employee11");
        var REmp12 = new Employee("E1.2", "Employee12");        
        dep1.addDepartment(dep11);
        dep1.addDepartment(dep12);
        dep1.addEmployee(REmp11);
        dep1.addEmployee(REmp12);        
    var dep2 = new Department("D2", "Department2");
        var dep21 = new Department("D2.1", "Department2.1");    
            var REmp211 = new Employee("E2.1.1", "Employee211");
            var REmp212 = new Employee("E2.1.2", "Employee212");                
            dep21.addEmployee(REmp211);
            dep21.addEmployee(REmp212);
        var dep22 = new Department("D2.2", "Department2.2");
            var REmp221 = new Employee("E2.2.1", "Employee221");            
            var REmp222 = new Employee("E2.2.2", "Employee222");
            var REmp223 = new Employee("E2.2.3", "Employee223");
            dep22.addEmployee(REmp221);
            dep22.addEmployee(REmp222);
            dep22.addEmployee(REmp223);            
        var REmp21 = new Employee("E2.1", "Employee21");
        var REmp22 = new Employee("E2.2", "Employee22");        
        dep2.addDepartment(dep21);
        dep2.addDepartment(dep22);
        dep2.addEmployee(REmp21);
        dep2.addEmployee(REmp22);
    var REmp1 = new Employee("E0.1", "Employee01");
    var REmp2 = new Employee("E0.2", "Employee02");
    CompanyRoot.addDepartment(dep1);
    CompanyRoot.addDepartment(dep2);
    CompanyRoot.addEmployee(REmp1);
    CompanyRoot.addEmployee(REmp2);    
    return CompanyRoot;
};

$(document).ready(function () {
        var vm = new DepViewModel ();
        ko.applyBindings(vm);
}); 
```

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-07-19T13:02:06.853

试试这个例子：http: [//jsfiddle.net/NJZrN/17/](http://jsfiddle.net/NJZrN/17/)

# ruby-on-rails - 如何为初始化变量创建验证？

> ID：11542884
> 
> 赞同：2
> 
> 时间：2012-07-18T13:46:02.080
> 
> 标签：ruby-on-rails, ruby, ruby-on-rails-3, validation

我有一个`value`在创建新对象时初始化的变量。但是，这个变量不是我表的列。我只想在我的模型中使用它，并将它用于我的类中的某些方法：

```
class MyClass < ActiveRecord::Base
  def initialize (value)
    @value = value
  end
end 
```

所以，在创建新对象`@value`的时候会`some text`暂时保留，例如：

```
test = MyClass.new("some text") 
```

有一种方法可以验证变量`value`是否只接受文本？

```
class MyClass < ActiveRecord::Base
  validates_format_of :value => /^\w+$/ # it doesn't work

  def initialize (value)
    @value = value
  end
end 
```

**编辑**

我已经尝试了所有答案，但我的 Rspec 仍然通过：

我的新课：

```
class MyClass < ActiveRecord::Base
  validate :check_value

  def check_value
    errors.add(:base,"value is wrong") and return false if !@value || !@value.match(/^\w+$/)
  end  

  def initialize (value)
    @value = value
  end

  def mymethod
    @value
  end
end 
```

我的 Rspec（我原以为它会失败，但它仍然通过了）：

```
describe MyClass do
  it 'checking the value' do
    @test = MyClass.new('1111').mymethod
    @test.should == '1111'
  end
end 
```

我想在分配`1111`给`@value`.

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-07-18T13:52:34.377

这是因为您使用的是`validates_format_of`. 这是一个辅助方法，本质上调用`validates_each`. 该方法验证特定属性。[你可以在这里](https://github.com/rails/rails/blob/master/activerecord/lib/active_record/validations/uniqueness.rb#L15-47)查看它的来源。

由于您尝试验证实例变量而不是属性，因此您必须编写自定义验证器。

改为验证：

```
validate :check_value

def check_value
   unless @value && @value.match(/^\w+$/)
      errors.add(:base,"value is wrong") and return false
   end
end 
```

我希望这只是您的代码的一个代表性示例。请告诉我你不用`@value`作变量名。

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2012-07-18T13:56:48.813

`valid?`只有当您调用或`save`在模型上时，Rails 才会进行验证。因此，如果您希望它在调用这些方法时仅接受您的值的值，请进行自定义验证：

```
class MyClass < ActiveRecord::Base

  validate :value_string

  #further code 
```

在受保护范围内设置您的价值验证

```
protected

  def value_string
    self.errors[:base] << 'Please assign a string to value' unless @value.match(/^\w+$/)
  end 
```

就像我之前说的，如果不调用`valid?`or就不会调用这些验证。**如果您希望在任何时候**`save`都不为 value 分配除 word-like-value 之外的其他值，那么除了在初始化时阻止它之外别无他法：

 **```
def initialize(attributes = nil, options = {})
  attr_value = attributes.delete(:value) if attributes
  @value = attr_value if attr_value && attr_value.match(/^\w+$/)

  super
end 
```

**编辑**

我不建议`ActiveRecord`在初始化时分配不接受的值时引发验证错误。尝试根据以下内容提出您自己的自定义错误[`ArgumentError`](http://www.ruby-doc.org/core-1.9.3/ArgumentError.html)

在你的课外

```
YourError = Class.new(ArgumentError) 
```

在你的班级里面

```
def initialize(attributes = nil, options = {})
  attr_value = attributes.delete(:value) if attributes
  if attr_value && attr_value.match(/^\w+$/)
    @value = attr_value
  elsif attr_value
    raise YourError.new('Value only accepts words')
  end

  super
end 
```

然后像这样测试它

```
describe Myclass do
  it 'should raise an error if value is assigned with something else than a word' do
    lambda{ MyClass.new(:value => 1111)}.should raise_error(YourError)
  end
  it 'should assign the value for words' do
    MyClass.new(:value => 'word').value.should == 'word'
  end
end 
```

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-07-18T14:01:11.083

小心。当@value 为nil 时，其他方法会崩溃。

```
validate :check_value

def check_value
  errors.add(:base,"value is wrong") and return false if !@value || !@value.match(/^\w+$/)
end 
```

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2012-07-18T13:51:05.217

您应该能够通过创建自己的验证器来做到这一点，如下所示：

```
class MyClass < ActiveRecord::Base

  validate :value_is_string

  protected

    def value_is_string
      unless @value.match(/^\w+$/)
        self.errors[:base] << 'Please put a string in value'
      end
    end
end 
```

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2012-07-18T14:24:18.333

验证在保存之前运行，所以如果你想在分配时引发错误，你可以这样做

```
 def initialize (value)
    raise ActiveRecord::RecordInvalid if !@value || !@value.match(/^\w+$/)
    @value = value
  end 
```

但我认为这不是一个好方法

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2020-01-29T03:47:41.427

您只需要`super`在初始化时调用。试试这个：

```
 # Trigger validation on initialization.
    def initialize(attributes = {})
      super
      valid?
    end 
```**

# c# - 使用 c# 将参数传递给命令提示符

> ID：11542888
> 
> 赞同：0
> 
> 时间：2012-07-18T13:46:18.993
> 
> 标签：c#

我是 C# 新手，我正在尝试禁用或启用本地计算机上的用户，如下面的代码所示。我正在创建一个 exe 并提示用户输入他们想要启用或禁用的用户名。

现在我想将参数传递给命令提示符并禁用或启用用户。例如：>cmd.exe John Disable。

如何使用 c# 将参数传递给命令提示符并使用下面的相同代码来启用或禁用用户？

```
class EnableDisableUsers
    {
        static void Main(string[] args)
        {
                Console.WriteLine("Enter user account to be enabled or disabled");
                string user = Console.ReadLine();
                Console.WriteLine("Enter E to enable or D to disable the user account");
                string enableStr = Console.ReadLine();
                bool enable;

            if (enableStr.Equals("E") || enableStr.Equals("e"))
            {

                PrincipalContext ctx = new PrincipalContext(ContextType.Machine);

                // find a user
                UserPrincipal username = UserPrincipal.FindByIdentity(ctx, IdentityType.SamAccountName, user);

                if (user != null)
                {
                    try
                    {
                        //Enable User
                        username.Enabled = true;
                        username.Save();
                        Console.WriteLine(user + " Enabled");
                    }
                    catch (Exception e)
                    {
                        Console.WriteLine("Operation failed - Username is not valid", e.Message);
                    }
                }
                Console.ReadLine();
            }
            else if (enableStr.Equals("D") || enableStr.Equals("d"))
            {

                PrincipalContext ctx = new PrincipalContext(ContextType.Machine);

                // find a user
                UserPrincipal username = UserPrincipal.FindByIdentity(ctx, IdentityType.SamAccountName, user);

                if (user != null)
                {
                    try
                    {
                        //Disable User
                        username.Enabled = false;
                        username.Save();
                        Console.WriteLine(user + " Disabled");
                    }
                    catch (Exception e)
                    {
                        Console.WriteLine("Operation failed - Username is not valid", e.Message);
                    }
                }
                Console.ReadLine();
            }
        }
    } 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-07-18T13:49:37.050

```
ProcessStartInfo processStartInfo = new ProcessStartInfo();
processStartInfo.Arguments = "/c ping " + machine;
processStartInfo.FileName = "cmd.exe";
Process process = new Process();
process.StartInfo = processStartInfo;
process.Start(); 
```

这是在控制台中使用 ping 命令的示例。您可以添加其他选项，例如强制它不打开 gui 等。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-07-18T13:50:21.423

您可以使用 `Environment.CommandLine`读取命令行参数或 [Environment.GetCommandLineArgs()](http://msdn.microsoft.com/en-us/library/system.environment.getcommandlineargs)方法。

```
 String[] arguments = Environment.GetCommandLineArgs(); 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-07-18T13:50:59.973

看看

```
string[] args 
```

您的命令行参数位于字符串数组中。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2012-07-18T13:51:28.313

发送到您的程序的参数存储在`args`

```
static void Main(string[] args) 
```

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2012-07-18T13:53:04.670

利用：

```
 switch (args[x])
 {
      .... 

  } 
```

例如

```
 switch (args[x])
 {
  #region --loop
  case "--loop":               
      x = -1;
      break;
 #endregion

 #region --test-net
     case "--test-net":
          Task isAlive = Task.Factory.StartNew(() =>
          {
              bool alive = tlib.CheckForInternetConnection();
              if (!alive)
              {
                  while (!alive)
                  {
                      Console.WriteLine("No connectivity found.");
                      System.Threading.Thread.Sleep(9000);
                      alive = tlib.CheckForInternetConnection();
                  }
              }
              else
              {
                   //TODO: Add alive code here 
              }
          });
          isAlive.Wait();
          break;

          #endregion
} 
```

这使您可以说 prog.exe --test-net 并运行该特定代码。

- 编辑 -

在这种情况下，您可以使用多个参数将命令串在一起

```
prog.exe --test-net --loop 
```

您可以拥有任意数量的参数。如果您想对 arg 使用人工输入，您始终可以控制 args 的数量并抓取 args[x+1] 以获取要禁用/启用的人的姓名。

这是假设您的案例陈述有两种情况：例如--enable 和--disable。然后你可以像这样调用程序：

```
prog.exe --enable John 
```

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2012-07-18T13:54:01.913

这是在你的主要吗？如果是这样，您将参考 string[] args 中的命令行参数：

```
static void Main(string[] args) 
```

你可以在这里看到一些例子：http: [//msdn.microsoft.com/en-us/library/aa288457 (v=vs.71).aspx](http://msdn.microsoft.com/en-us/library/aa288457(v=vs.71).aspx)

# sql - SQL Server CASE 语句的条件结果

> ID：11542893
> 
> 赞同：1
> 
> 时间：2012-07-18T13:46:44.843
> 
> 标签：sql, sql-server, sql-server-2000

是否可以在 SQL Server case 语句中的 case 表达式的 when 表达式中进行布尔比较。我有一个 SELECT 语句，其逻辑类似于以下内容：

```
SELECT T1.ProductNumber,
    CASE
        WHEN (SELECT SUM(T2.Quantity) FROM Table2 AS T2 WHERE T2.Product=T1.Product) IS NULL
            THEN T1.Quantity
        WHEN (SELECT SUM(T2.Quantity) FROM Table2 AS T2 WHERE T2.Product=T1.Product) > T1.Quantity
            THEN T1.Quantity
        ELSE T1.Quantity - (SELECT SUM(T2.Quantity) FROM Table2 AS T2 WHERE T2.Product=T1.Product)
    END
FROM Table1 AS T1 
```

这似乎在 Table2 上有很多重复的查找。如果可能的话，我想做这样的事情：

```
SELECT T1.ProductNumber,
    CASE (SELECT SUM(T2.Quantity) FROM Table2 AS T2 WHERE T2.Product=T1.Product) as altQty
        WHEN altQty IS NULL
            THEN T1.Quantity
        WHEN altQty > T1.Quantity
            THEN T1.Quantity
        ELSE T1.Quantity - altQty
    END
FROM Table1 AS T1 
```

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-07-18T13:50:17.813

您不能以这种方式引用别名，但如果将其放在子查询/派生表中，则可以。

```
SELECT ProductNumber, CASE WHEN altQty IS NULL
            THEN Quantity
        WHEN altQty > Quantity
            THEN Quantity
        ELSE Quantity - altQty END
FROM 
(
  SELECT T1.ProductNumber, T1.Quantity, 
    altQty = (SELECT SUM(T2.Quantity) FROM Table2 AS T2 WHERE T2.Product=T1.Product)
  FROM Table1 AS T1
) AS x; 
```

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2012-07-18T13:52:06.567

```
SELECT T1.ProductNumber,
    CASE 
        WHEN T2.Qty IS NULL
            THEN T1.Quantity
        WHEN T2.Qty > T1.Quantity
            THEN T1.Quantity
        ELSE T1.Quantity - T2.Qty END
FROM Table1 AS T1
    LEFT JOIN (SELECT ProductNumber, SUM(Quantity) AS Qty FROM Table2 GROUP BY ProductNumber) AS T2
        ON T1.ProductNumber = T2.ProductNumber 
```

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-07-18T13:50:58.803

不，但您可以删除重复的查找。

```
SELECT ProductNumber,
       CASE WHEN T2Quantity IS NULL THEN T1Quantity
            WHEN T2Quantity > T1Quantity THEN T1Quantity
            ELSE T1Quantity - T2Quantity END
  FROM
   (SELECT T1.ProductNumber, T1.Quantity as T1Quantity, SUM(T2.Quantity) as T2Quantity
      FROM Table1 AS T1 LEFT OUTER JOIN 
           Table2 AS T2 ON T2.Product=T1.Product
     GROUP BY T1.ProductNumber) innerTbl 
```

# css - 无重复 CSS 径向渐变

> ID：11542900
> 
> 赞同：2
> 
> 时间：2012-07-18T13:47:11.527
> 
> 标签：css, background, radial-gradients

有没有办法不重复白圈？

[http://dabblet.com/gist/3136266](http://dabblet.com/gist/3136266)

```
background: #ffffff;
background-image:
    radial-gradient(rgba(255, 255, 255, 1) 50%, rgba(255,255,255,0) 80%),
    linear-gradient(rgba(255, 255, 255, 1) 5px, transparent 5px),
    linear-gradient(0, rgba(0, 100, 0, 0.75) 3px, transparent 3px);
background-size:
    400px 60px,
    15px 15px,
    7px 7px;
background-position:
    1px 1px,
    -2px -2px,
    1px 1px; 
```

谢谢你的帮助:)

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-07-18T13:57:28.863

```
background-repeat: no-repeat, repeat, repeat; 
```

示例：[http ://dabblet.com/gist/3136366](http://dabblet.com/gist/3136366)

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-07-18T13:57:47.770

使用背景重复相同的其他

`background-repeat:no-repeat, repeat, repeat;`

# java - In-Criterion 忽略大小写

> ID：11542902
> 
> 赞同：4
> 
> 时间：2012-07-18T13:47:17.170
> 
> 标签：java, hibernate, hibernate-criteria

我想使用带有 Hibernate Criteria API 的 In-Criterion 选择不区分大小写的项目。例如

```
Criteria crit = session.createCriteria(Item.class);
crit.add(Restrictions.in("prop", valueList).ignoreCase()); 
```

不幸的是，Criterion 类没有 ignoreCase 方法。HQL 不是替代品。

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-07-18T14:27:31.647

`Restrictions.in()`获取( )返回的 Criterion 类的源代码`InExpression`，并创建另一个类似但将值列表的所有元素都转换为小写的 Criterion 类的源代码，并生成如下 SQL 查询：

```
lower(prop) in (...) 
```

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2012-07-18T15:29:38.487

我实现了自己的忽略大小写的 InExpression。它与 hibernate-core-3.6.10.Final 中的 InExpresion 几乎相同。唯一的区别是“下（..）”。

```
import java.util.ArrayList;
import org.hibernate.Criteria;
import org.hibernate.EntityMode;
import org.hibernate.HibernateException;
import org.hibernate.criterion.CriteriaQuery;
import org.hibernate.criterion.Criterion;
import org.hibernate.criterion.InExpression;
import org.hibernate.engine.TypedValue;
import org.hibernate.type.CompositeType;
import org.hibernate.type.Type;
import org.hibernate.util.StringHelper;

public class InExpressionIgnoringCase implements Criterion {

private final String propertyName;
private final Object[] values;

public InExpressionIgnoringCase(final String propertyName, final Object[] values) {
    this.propertyName = propertyName;
    this.values = values;
}

public String toSqlString(final Criteria criteria, final CriteriaQuery criteriaQuery) throws HibernateException {
    final String[] columns = criteriaQuery.findColumns(this.propertyName, criteria);
    final String[] wrappedLowerColumns = wrapLower(columns);
    if (criteriaQuery.getFactory().getDialect().supportsRowValueConstructorSyntaxInInList() || columns.length <= 1) {

        String singleValueParam = StringHelper.repeat("lower(?), ", columns.length - 1) + "lower(?)";
        if (columns.length > 1)
            singleValueParam = '(' + singleValueParam + ')';
        final String params = this.values.length > 0 ? StringHelper.repeat(singleValueParam + ", ",
                this.values.length - 1) + singleValueParam : "";
        String cols = StringHelper.join(", ", wrappedLowerColumns);
        if (columns.length > 1)
            cols = '(' + cols + ')';
        return cols + " in (" + params + ')';
    } else {
        String cols = " ( " + StringHelper.join(" = lower(?) and ", wrappedLowerColumns) + "= lower(?) ) ";
        cols = this.values.length > 0 ? StringHelper.repeat(cols + "or ", this.values.length - 1) + cols : "";
        cols = " ( " + cols + " ) ";
        return cols;
    }
}

public TypedValue[] getTypedValues(final Criteria criteria, final CriteriaQuery criteriaQuery)
        throws HibernateException {
    final ArrayList<TypedValue> list = new ArrayList<TypedValue>();
    final Type type = criteriaQuery.getTypeUsingProjection(criteria, this.propertyName);
    if (type.isComponentType()) {
        final CompositeType actype = (CompositeType) type;
        final Type[] types = actype.getSubtypes();
        for (int j = 0; j < this.values.length; j++) {
            for (int i = 0; i < types.length; i++) {
                final Object subval = this.values[j] == null ? null : actype.getPropertyValues(this.values[j],
                        EntityMode.POJO)[i];
                list.add(new TypedValue(types[i], subval, EntityMode.POJO));
            }
        }
    } else {
        for (int j = 0; j < this.values.length; j++) {
            list.add(new TypedValue(type, this.values[j], EntityMode.POJO));
        }
    }
    return list.toArray(new TypedValue[list.size()]);
}

@Override
public String toString() {
    return this.propertyName + " in (" + StringHelper.toString(this.values) + ')';
}

private String[] wrapLower(final String[] columns) {
    final String[] wrappedColumns = new String[columns.length];
    for (int i = 0; i < columns.length; i++) {
        wrappedColumns[i] = "lower(" + columns[i] + ")";
    }
    return wrappedColumns;
}
} 
```

用法：

```
final Criteria crit = session.createCriteria(Item.class);
            crit.add(new InExpressionIgnoringCase("prop", array)); 
```

* * *

## 回答 #3

> 赞同：3
> 
> 时间：2015-01-19T16:01:32.960

另一种方法是使用[sqlRestriction](https://docs.jboss.org/hibernate/orm/3.5/api/org/hibernate/criterion/Restrictions.html#sqlRestriction(java.lang.String))。因此，您将值转换为逗号分隔的小写字符串，然后调用。

```
crit.add(Restrictions.sqlRestriction("lower({alias}.prop) in ( " + q + " )")); 
```

但是，您的查询参数必须进行清理。

你也可以使用[析取](https://docs.jboss.org/hibernate/core/3.3/api/org/hibernate/criterion/Disjunction.html)。

```
Junction j = Restrictions.disjunction();
for (String prop: props) {
    j.add(Restrictions.eq("prop", prop).ignoreCase());
}
crit.add(j); 
```

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2016-06-17T10:08:41.530

```
 .add(Restrictions.sqlRestriction("upper({alias}.COLUMN_NAME) = upper(?)", VALUE_TO_COMPARE, Hibernate.STRING)) 
```

为我工作。

# c# - 在 Windows 7 64 位但不在 XP 32 位中运行时出现 InvalidCastException

> ID：11542905
> 
> 赞同：1
> 
> 时间：2012-07-18T13:47:20.720
> 
> 标签：c#, com, casting, windows-xp, windows-7-x64

我希望你们都可以帮助我。我有一个很久以前用 Delphi 编写的 dll，因此它与 XP 32 位兼容。我有用 C# 用 VS2010 编写的代码，目标是 .NET 4.0。我将 dll 添加到 VS2010 中的引用中。它在 XP 中可以正常工作，但是当我在 Windows 7 64 位中尝试相同的代码时，出现以下错误

> 无法将“FASTBeamCOM.GPFASTBeamClass”类型的 COM 对象转换为接口类型“FASTBeamCOM.IGPFASTBeam”。此操作失败，因为 IID 为“{B7D3D8C1-6919-11D4-8616-9E780E5EC276}”的接口的 COM 组件上的 QueryInterface 调用因以下错误而失败：不支持此类接口（来自 HRESULT 的异常：0x80004002 (E_NOINTERFACE)） .

FASTBeamCOM dll 包含 GPFASTBeamClass 和 IGPFASTBeam 接口。我能够找到如何在管理员模式下使用 sysWOW64\regsvr32 为 64 位注册 FASTBeamCOM.dll。但是，我不知道还能做什么才能让这个 dll 正常工作。

这是我用来在 XP 和 Windows 7 中测试 dll 的一些代码示例

> ```
>  private static FASTBeamCOM.GPFASTBeamClass f = new FASTBeamCOM.GPFASTBeamClass();
>    public FASTBeamCOM.IGPFASTBeam FB
>    {
>        get { return f as FASTBeamCOM.IGPFASTBeam; }
>    } 
> ```

```
 public MainWindow()
    {
        InitializeComponent();
    }

    private void button1_Click(object sender, RoutedEventArgs e)
    {
        int iCopyProtection = 0;
        FB.VerifyCopyProtection(ref iCopyProtection);
        FB.setApplicationName("Wholehouse.dll");
        FB.initializeFB();
        FB.SetProductAvailability();
    } 
```

我尝试将 FB 属性声明为 GPFASTBeamClass 和 IGPFASTBeam，但我收到了相同的错误消息。错误发生在 FB.VerifyCopyProtection 命令中。就像我说的，它在 XP 32 位中运行良好，但在 Windows 7 64 位中运行良好。我不知道这是 32 位与 64 位的问题还是 XP 与 Windows 7 的问题。

# linux - unix dircmp 失败并出现以下错误：排序：0653-657 合并时发生写入错误

> ID：11542908
> 
> 赞同：0
> 
> 时间：2012-07-18T13:47:34.740
> 
> 标签：linux, unix

我正在尝试`dircmp -s dir1 dir2`对两个非常大的目录进行操作。等待 15 分钟后，我收到以下错误：

```
sort: 0653-657 A write error occurred while merging. 
```

我猜它在尝试执行 unix 命令时用完了 RAM。你们有替代解决方案吗？

如果需要，我还可以在 Perl 中编写解决方案。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-07-18T17:17:10.733

如果`sort`需要比可用内存更多的内存*，它会使用磁盘空间。具体来说，由 或 指示的目录`-T`（`$TMPDIR`按`/tmp`优先级降序排列）。我的猜测是您的临时目录已满。如果是这样，解决方案是指定一个具有更多磁盘空间的工作目录。

* -- 对于“可用”的一些未知且可能非常松散的定义。

**更新**：嗯，一个小问题，你实际上并没有使用`sort`. 但听起来像是`dircmp`在产卵`sort`，在这种情况下`sort`应该继承`$TMPDIR`所见的`dircmp`。

# java - 有没有人针对标准 Java 运行时对 Excelsior JET 编译为本机进行基准测试？

> ID：11542909
> 
> 赞同：11
> 
> 时间：2012-07-18T13:47:35.577
> 
> 标签：java, performance, compilation

有没有人尝试过将使用 Excelsior JET 编译为本机的 Java 应用程序与在正常 Java 运行时上即时运行的相同应用程序进行基准测试？我能找到的唯一基准测试托管在 Excelsior 的网站上，并且是针对单个应用程序的；我希望看到一些独立的结果。

我的应用程序的 CPU 和内存使用率都很高（它正在训练机器学习模型）。我预计使用 Jet 不会提高性能，但我可能需要在没有可用的 java 运行时的环境中运行（因此编译为本机），我需要知道性能是否会更差。

我知道 Excelsior 有一个评估。可用，但我希望节省下载、配置、测试等时间...

* * *

## 回答 #1

> 赞同：22
> 
> 时间：2012-07-19T03:36:26.910

免责声明：我为 Excelsior 工作。

为了回答您的问题，我所知道的最新的第三方基准测试结果是**[这些](http://www.stefankrause.net/wp/?p=9)**，但我刚刚检查过 - 那个帖子已经有四年多了......

现在，如果您允许我提供一些建议：

基于超过 13 年的 Excelsior JET 市场寿命，我可以告诉您，您*必须*针对您的特定应用程序对其进行测试。没有任何基准可以让您了解*您的应用程序*在本机编译时的行为方式。正如我们所说，您的里程会有所不同。我们有客户报告我们在实验室中从未见过的速度提高，并且我们有潜在客户因为他们的应用程序变得更慢而提前放弃了他们的评估。（后者通常由于配置错误而发生 - 例如，并非所有类都已预编译 - 因此，如果您遇到类似情况，请联系我们的工程师。）

在我们的网站上也有一些性能比较的案例研究（[#1](http://www.excelsior-usa.com/jetcs00013.html)，[#2](http://www.excelsior-usa.com/jetcs00007.html)），但当然这些来自应用程序变得更快的用户。;)

**2014 年 12 月 15 日更新：**请注意：从 Excelsior JET 10 开始，64 位版本在性能方面落后于 32 位版本，因为前者基于从头开始构建的新编译器核心实施的优化较少。我们正在努力扭转这种情况，但目前，如果性能对您很重要，*并且*您没有任何真正好的理由使用 64 位版本，例如大堆或需要与 64 位集成本机库，或者针对 OS X 的需要，坚持使用久经考验的真正 32 位版本。

* * *

## 回答 #2

> 赞同：9
> 
> 时间：2013-04-25T15:48:31.700

我将 Excelsior JET 用于免费软件游戏。在我的测试中，游戏的运行速度并没有变快或变慢，但是与 Excelsior JET 相比，与 Oracle 的 VM 相比，帧速率与 Excelsior JET 更加一致。使用 JET 可以更好地启动我们的游戏。JVM 需要一段时间来预热和加载所有类，但使用 JET 它会立即运行。

如果您使用大量线程，Excelsior JET 的内存消耗可能会更高一些 - 因为默认情况下 Excelsior JET 使用较大的固定线程堆栈大小。但这可以配置 - 所以这不是问题。

电子邮件支持也很好。您可以与工程师交谈，而不是与支持人员交谈。如果你碰巧发现了一个错误，通常只有一天的时间才能修复。我还想指出，我收到了一些来自早期版本 JET（>2 岁左右）的用户的奇怪的不可重现的崩溃报告。当前版本（7.6 和现在的 8.0）都坚如磐石。我们在万台机器上看不到任何崩溃。

简而言之：我可以推荐 Excelsior JET，性能（在我们的例子中）与 JVM 一样好。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2018-07-24T22:47:25.610

我使用[`Excelsior JET 15.0 for Windows`](https://www.excelsiorjet.com/evaluate)测试版本来本地编译我的 CPU 和内存密集型应用程序。

**本机编译**时间大约需要 40 分钟。原始`JAR`文件是`10MB`（由于库）和本机`EXE` `60MB`由于捆绑`JRE 8`，所以这不是很好，除非不需要安装 Java。**在启动时间方面**，`JET`似乎做得更好。就连贯的感觉而言，`Swing GUI` `JET`也获胜或至少与`JRE`. **在性能和内存使用方面，**我惊讶地找不到合理的改进：有时是赢的，有时是本机二进制文件。他们的表现相当均匀。[`JIT`](https://en.wikipedia.org/wiki/Just-in-time_compilation) `JAR`

**在逆向工程保护方面**，`JET`这是我见过的最好的，因为本机二进制文件很大，被剥离了，你无法明智地导航或反编译它来提取你想要的东西。另一方面，`.jar`文件和`.class`文件很容易反编译回几乎完全相同的源代码。

总体而言，您可以决定为您的用例经历配置和可能正确许可的麻烦是否`JET`值得，因为使用它不仅有其建议的好处，而且在很大程度上取决于您的项目的性质。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2016-10-19T17:42:45.413

我刚刚安装了 Excelsior Jet 11 64 位评估版，包括维护包 3，以查看我用 Java 编写的自定义国际象棋引擎是否获得任何性能（elo-score +/- 2100）。不幸的是，它没有，它的速度几乎减半（每秒 450k 个节点，而不是 Intel Q9550 上的 1m）。我猜这是 64 位版本的 Excelsior 没有得到优化的结果。

我的国际象棋引擎使用位板（64 位长）作为其棋盘表示，并执行大量按位运算。此外，它还进行了很多数组查找。

内存消耗大致相同。

# javascript - 使用 ajax 的 javascript 应用程序的身份验证模型

> ID：11542910
> 
> 赞同：2
> 
> 时间：2012-07-18T13:47:35.220
> 
> 标签：javascript, jquery, ajax, security, authentication

这不是关于某些 javascript 细节的特定问题，但我正在寻找验证，即我创建的模型中没有明显的漏洞。我决定推出自己的身份验证例程（除了在后端使用 bcrypt 散列），其工作方式如下：

1.  用户（浏览器或 phonegap 创建的本机应用程序）注册 > 使用 jQuery ajax 发布到后端的 Json 对象使用 bcrypt 处理密码并保存密码用户配置文件数据
2.  后端生成并使用客户端 IP 地址保存它返回的令牌（随机哈希，如 /dev/urandom）
3.  jQuery 插件将令牌存储到本地 cookie
4.  当发出一些请求（发布、评论等，但不是太频繁）时，它会从 cookie 中获取令牌并将其添加到 json 并使用 ajax 再次发布
5.  后端检查令牌是否存在且未过期（有效期为 7 天），检查 ip-address 是否相同，如果 ok 验证请求 json 数据并处理请求
6.  当令牌过期时，会显示一个登录屏幕，并以 ajax 形式发布凭据，并在步骤 2 中创建一个新令牌。

ajax 请求的所有内容都通过 ssl 进行，并且没有密码存储在任何地方。如果超过阈值，还有一种机制检查暴力令牌垃圾邮件会暂时阻止源 IP。这不是一个高安全性的应用程序，但希望尊重用户数据并确保它“足够”安全。

我希望这个问题是合格的，即使它并不具体，如果它会引发一些讨论，它可以作为其他人的参考。我找不到任何关于这种特定方法的最佳实践教程。

更新：根据收到的反馈更新身份验证机制，因为它对于非关键 Web 应用程序似乎“足够安全”。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-07-21T08:42:26.293

鉴于您说您的应用程序不是高安全性应用程序，并且您希望基本的安全控制措施到位，我试图从高层次的角度涵盖我能想到的所有内容。

身份验证流程及其使用的机制对我来说似乎很好。我在这里看到的唯一关注点是会话管理本身。使用 MD5 生成会话令牌很好（取决于您是否使用正确的伪随机函数，这些函数以正确的方式播种），但如果有人试图为您的令牌创建冲突，SHA1/SHA256 可能是更好的选择。

我看到这里缺少一些东西——它们可能被省略了，或者它们可能不存在，所以我将全部提及。第一件事 - 您没有提到您是否确保用户与您收到的 cookie 之间存在匹配。您需要确保这两个匹配，以便一个用户无法窃取第二个用户的会话。

我在这里看到的第二件事是验证 cookie 不是从用户那里窃取的。例如，如果我设法从用户​​那里窃取会话 cookie，并在我自己的计算机上从不同的地方重放它，我仍然可以使用当前会话处理机制登录。

您需要一种方法来唯一地识别请求来自哪台计算机 - 一种方法（以及名为 CodeIgniter 的 PHP 框架执行此操作的方式）是通过验证 IP 地址以及请求的用户代理来自（哪里。后者很容易被欺骗，但前者要困难得多。这使您的会话对攻击更具弹性——除非应用程序在公共机器上的网吧中使用，并且用户尚未注销。

这让我想到了最后一点——我没有看到这里提到的注销机制，以及注销是如何执行的。基本假设是您将在用户注销后立即使会话 cookie 无效，并且您不再接受该会话 cookie。如果您还没有这样做，那么您可以采取其他措施来确保会话的安全性。

# oracle-apex - 登录到 Oracle XE，Apex 工作正常，但与 SQL Developer 连接？

> ID：11542911
> 
> 赞同：1
> 
> 时间：2012-07-18T13:47:35.907
> 
> 标签：oracle-apex, oracle-xe

好的，这可能是因为我不太了解 Oracle XE。

基本上，我已经按照本指南将 Oracle XE 安装到了 Amazon EC2 微型实例上；

[http://jeffkemponoracle.com/2011/09/08/installing-oracle-11gxe-on-amazon-elastic-cloud/](http://jeffkemponoracle.com/2011/09/08/installing-oracle-11gxe-on-amazon-elastic-cloud/)

一切正常，我登录到 my-ec2-elastic-ip:9090/apex/apex_admin 并创建了一个“工作区”（无论如何，我以为我在这里创建了一个数据库？）

然后我可以返回 my-ec2-elastic-ip:9090/apex url 并登录到工作区。

美好的。

但是现在当我开始使用 SQL Developer 尝试连接到数据库时，我输入以下内容；

```
Connection Name: Test (just a label right? nothing to do with the workspace name?)
username: admin (username created for the workspace, correct?)
password: <password> (password for above user?)
hostname: <my-ec2-elastic-ip>
port: 1521
sid: xe (is this correct?) 
```

它似乎连接正常，但它反复说用户名/密码错误。但事实并非如此，我一直很小心！

我什至在工作区中创建了另一个名称非常简单的用户，并在禁用 apex/admin 中的密码规则后将其密码设置为“a”。还是我的用户名/密码错误？

这是怎么回事？我假设我已经设置好端口等所有内容，因为我可以很好地进入 apex 和 apex/admin。但是为什么它抱怨用户名/密码错误呢？

我还没有真正创建数据库吗？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-07-18T15:22:00.140

您可能已经创建了一个数据库实例，但是当您创建一个工作区时，这并不一定等同于创建一个数据库用户。

进入主工作区页面并导航到“管理”->“仪表板”，然后转到“数据库”选项卡屏幕。

下拉“架构”字段的值是什么？

这是 Apex 正在查看的架构。如果它是`SYS`或者`SYSTEM`您需要通过 SQL Workshop 屏幕创建一个数据库用户，以`SYS`or`SYSTEM`用户（作为 sysdba）登录到您的数据库实例，并创建一个新的数据库用户来指向您的 Apex 工作区。

（注意如果您创建了一个数据库实例，它会在您创建它时要求您提供`SYS`密码`SYSTEM`，如果没有，请参阅[此线程](https://forums.oracle.com/forums/thread.jspa?threadID=716808)以了解如何重置它们）。

希望能帮助到你...

# ruby-on-rails - 如何将参数从控制器传递给视图，视图传递给控制器 ？

> ID：11542912
> 
> 赞同：0
> 
> 时间：2012-07-18T13:47:38.973
> 
> 标签：ruby-on-rails, ruby-on-rails-3, view, controller, breadcrumbs

假设我有一个名为“ReceivedMessages”的方法操作，它显示了所有收到的消息。
在该页面中，如果您单击任何消息，它将重定向到其“显示”页面。

我也可以从“SentMessages”进入“显示”页面。

必须判断“Show”页面来自“ReceivedMessages”还是“SentMessages”

这是面包屑的目的。它必须是这样的

主页 > 收到的消息 > 一条消息或
主页 > 已发送消息 > 一条消息

要创建此链接，我必须将路径传递到 Received Messages 视图，然后从那里传递到“显示”控制器以在我的面包屑中创建第二个链接。

这个怎么存档？？？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-07-18T13:52:44.133

将所需的参数放在链接的 url 路径中，如下所示：

```
<%= link_to "Show Message", message_path(:id => @message.id, :breadcrumb => 'ReceivedMessage') %>
<%= link_to "Show Message", message_path(:id => @message.id, :breadcrumb => 'SentMessages') %> 
```

然后，在您的控制器中，您使用这些参数创建逻辑。

```
params[:breadcrumb] 
```

# jquery - jQuery 选择器不适用于 jquery-mobile datepicker

> ID：11542915
> 
> 赞同：0
> 
> 时间：2012-07-18T13:47:45.963
> 
> 标签：jquery, jquery-mobile, triggers, datepicker

在我的 html 中，我有两个不同的日期选择器，在两个不同的 div 中。从日期选择器中选择一天时，我想做一些事情，如下所示：

```
$('#details1 tr .ui-body-c').on('click', function(){
    $('#details1 .hasDatepicker').hide();
    if($('#date1').val()!="")
    {
        var day=new Date($('#date1').val());
        day.setHours(23);
        day.setMinutes(59);
        day.setSeconds(59);

        getDayData(day);
    }
}); 
```

但是点击当天不会触发点击事件。如果我从选择器中删除#details1，则事件会触发，但同时使用两个日期选择器。

这是 datepicker 插件的链接：http: [//jquerymobile.com/demos/1.0a4.1/experiments/ui-datepicker/](http://jquerymobile.com/demos/1.0a4.1/experiments/ui-datepicker/)

**编辑：**似乎在页面内未检测到 jquery-mobile datepicker 创建的表。我什至试过这个：

```
$('html tr .ui-body-c').on('click', function(){
   $('#details1 .hasDatepicker').hide();
    if($('#date1').val()!="")
    {
        var day=new Date($('#date1').val());
        day.setHours(23);
        day.setMinutes(59);
        day.setSeconds(59);

        getDayData(day);
    }
}); 
```

并且不工作。结果也做`var a = $('.datepicker-calendar').parent()`了并得到了[]。

关于为什么会发生这种情况以及如何解决它的任何想法？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-07-18T14:27:10.767

**编辑：**我很抱歉，我应该仔细看看 datepicker 的移动版本是做什么的。您的问题很可能是由于稍后将表添加到 DOM，您将需要从静态事件委托事件，例如：

```
$('#details1').on('click', 'tr .ui-body-c', function(){ 
```

* * *

如果 datepicker 的移动版本与普通的 jQuery UI 相同，则最好在首次初始化时使用 onSelect 事件，例如：

```
$('#details1').datepicker({
    onSelect: function(dateText, inst) {
        inst.input.hide();
        var day=new Date(dateText);
        day.setHours(23);
        day.setMinutes(59);
        day.setSeconds(59);

        getDayData(day);
    }
});​ 
```

当您选择一天时会触发此事件，dateText 是它将放入输入中的值（无需自己获取），inst 是包含相关输入的 datepicker 实例（inst.input）。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-07-19T08:51:53.200

我通过编辑`jquery.ui.datepicker.mobile.js`文件、向元素添加自定义类来解决这个问题。

```
if(options.altField!=undefined)
    $(dp).attr('id', options.altField.split('#')[1] + '1'); 
```

然后在`function updateDatepicker(){`

```
$( ".ui-datepicker-calendar td", dp ).addClass("ui-body-c "+$(dp).attr('id')+'2'); 
```

因此，如果我的日期输入的 id 是“myDatePicker”，日历上的每个 td 都会有“myDatePicker12”类，我可以这样做：

```
$('.myDatePicker12').on('click', function(){
   $('#details1 .hasDatepicker').hide();
    if($('#date1').val()!="")
    {
        var day=new Date($('#date1').val());
        day.setHours(23);
        day.setMinutes(59);
        day.setSeconds(59);

        getDayData(day);
    }
}); 
```

# android - 在 AppWidget 上检测 OnTouch。如果有可能吗？

> ID：11542916
> 
> 赞同：4
> 
> 时间：2012-07-18T13:47:47.387
> 
> 标签：android, android-appwidget, touch-event, ontouchlistener

在 AppWidget 上检测 OnTouch。如果有可能吗？你好！我正在尝试为 Android 2.1 创建我的第一个 AppWidget，其中客户端可能有机会在我的自定义视图上选择一个项目。我将为其创建一个自定义视图和一个滑块，客户端可以通过将滑块拉到自定义视图上来进行选择。为此，我想检测 AppWidget 的 onTouch（以确定 X、Y 坐标），有没有办法做到这一点？

我看到了可以在 AppWidget 中使用的有效小部件列表：

*   模拟时钟
*   按钮
*   计时器
*   图像按钮
*   图像视图
*   进度条
*   文本视图
*   ViewFlipper
*   列表显示
*   网格视图
*   堆栈视图
*   AdapterViewFlipper

但是它们不符合我的需要。我用谷歌搜索了这个，但找不到任何可以帮助我的东西。有没有办法在 AppWidget 中检测 OnTouch？也许这需要我有一个更新的 API 版本。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-09-29T19:42:36.583

似乎没有办法检测到`AppWidget`.RemoteViews 上的触摸（我们无法为它们注册触摸监听器）。

Mark Murphy（[CommonsWare](https://stackoverflow.com/users/115145/commonsware)）在[检测小部件的 onTouch 中](https://groups.google.com/forum/?fromgroups=#!topic/android-developers/l55D63fp7PE)说：

> 您没有检测到应用小部件的“触摸”。但是，您可以通过 RemoteViews 上的 setOnClickPendingIntent() 检测点击。AFAIK，这适用于 RemoteViews 支持的所有视图类。

此外，您不能`StackView`在 Android2.1 中的 AppWidgets 中使用（请参阅[Android2(API 5) 中的模拟堆栈视图？](https://stackoverflow.com/questions/12286506/simulate-stack-view-in-android2api-5)）。

# web-crawler - 如何告诉 Google 不要抓取一组网址

> ID：11542918
> 
> 赞同：-3
> 
> 时间：2012-07-18T13:47:54.870
> 
> 标签：web-crawler, robots.txt

如何阻止谷歌抓取我的应用程序中的某些网址？

例如：我希望 google 停止抓取所有以`http://www.myhost-test.com/`

我应该在我的 robots.txt 中添加什么？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-07-18T13:50:03.437

答案可以直接在这里找到：

[http://support.google.com/webmasters/bin/answer.py?hl=en&answer=156449](http://support.google.com/webmasters/bin/answer.py?hl=en&answer=156449)

但看起来您添加了“禁止”和您的网址。

# spring - 如何使用 Spring 安全配置 WebSecurityExpressionHandler？

> ID：11542920
> 
> 赞同：2
> 
> 时间：2012-07-18T13:48:01.553
> 
> 标签：spring, security, taglib

我有一个在 Spring 3.0 上运行良好的项目。我现在已经转移到 Maven 来控制依赖关系并转移到 Spring 3.1.2 jar 和 Spring security 3.1.1 jar。

当我尝试访问包含使用安全标记库（例如）的 JSP 时，我收到以下错误：

```
javax.servlet.ServletException: javax.servlet.jsp.JspException: java.io.IOException: No visible WebSecurityExpressionHandler instance could be found in the application context. There must be at least one in order to support expressions in JSP 'authorize' tags. 
```

在我的安全上下文中，我有：

```
<http auto-config="true" use-expressions="true" create-session="ifRequired" 
```

从我的旧项目：

```
<beans:bean id="expressionHandler" class="org.springframework.security.access.expression.method.DefaultMethodSecurityExpressionHandler" /> 
```

我在我的项目的包中找不到那个类，所以认为它可能只是我尝试的类的一个移动：

```
<beans:bean id="expressionHandler" class="org.springframework.security.web.access.expression.WebSecurityExpressionHandler" /> 
```

这给了我同样的错误。

我目前配置的 Spring-security 依赖项：spring-security-core-3.1.1 spring-security-taglibs-3.1.1 spring-security-acl-3.1.1 spring-security-config-3.1.1 spring-security -web-3.1.1

我是否错过了一个包含任何“use-expressions = true”需要的罐子？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-07-27T10:18:33.337

从那以后，我对我的项目进行了许多更改，但我不能 100% 确定哪个确实解决了这个问题，但最有可能的竞争者如下：

*   我的应用程序的 lib 文件夹中隐藏了一些 3.0 jar。手动删除它们。
*   完全从 security-context 中删除了 expressionHandler 定义
*   因此更改了 URL 映射样式：

    ```
    <!-- Spring Security < 3.1
    These were inside the <http... > element
    <intercept-url pattern="/public/**" filters="none"/>
    <intercept-url pattern="/login" filters="none"/>
    <intercept-url pattern="/loggedOut" filters="none"/>
    <intercept-url pattern="/include/css/**" filters="none"/>
    <intercept-url pattern="/include/img/**" filters="none"/>
    --> 
    ```

    在安全上下文中的元素之前更改为以下内容：

    ```
    <!-- for Spring-security >= 3.1 -->
    <http pattern="/public/**" security="none"/>
    <http pattern="/login" security="none"/>
    <http pattern="/loggedOut" security="none"/>
    <http pattern="/include/css/**" security="none"/>
    <http pattern="/include/img/**" security="none"/> 
    ```

我的元素现在显示为：

```
 <http use-expressions="true" auto-config="true" create-session="ifRequired" access-denied-page="/accessDenied" > 
```

我希望这可以帮助其他有类似问题的人从 Spring security 3.0 -> 3.1 迁移。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-07-02T11:53:18.473

这不是真的，我们使用拦截 url 来控制角色访问，但你省略了它们。

# django - 如何动态访问 django 模板中的字典字段？

> ID：11542921
> 
> 赞同：1
> 
> 时间：2012-07-18T13:48:03.683
> 
> 标签：django, dictionary, django-templates

我有一个 django 模板，我希望在其中显示一个字段表。我希望表包含基于数据库字段子集的不同列。显示哪些字段基于 GET 调用（因此无法预先确定）。

我遇到的困难是我不能任意标记/排序列，然后让字段匹配。我正在使用 model.object.values 来选择我想要的列。

我尝试过的解决方案是：

1.  遍历字典。这会以随机顺序返回字段，而且以不能保证跨数据库元素稳定的顺序返回，尽管在实践中似乎是这种情况。
2.  使用 values_list，但我仍然无法控制顺序，但至少它是固定的。
3.  传递字段名称，并使用它们来访问字典，但是我无法弄清楚如何使用参数调用 dict.get。我认为这是故意不可能的。
4.  2和3一起。如果没有一些难看的嵌套字符串比较和索引黑客，就没有明显的方法可以使这项工作。
5.  迭代项目，这似乎需要嵌套循环来确定哪个元素进入哪个单元格。

任何帮助，将不胜感激。

NB dictsort 对行进行排序，而不是对列进行排序。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-07-18T14:28:45.197

您可以使用 #3 并使用[此处](https://stackoverflow.com/a/10700142/687488)建议的模板过滤器，或者仅在视图中准备数据，而不是尝试在模板中执行此操作。更具体地说，您可以按照您选择的顺序创建列标题列表，并为数据库中的每个对象以正确的顺序创建一个值元组。

# c# - finally 阻止使用 - 它是否像在 finally 的其他上下文中一样触发？

> ID：11542925
> 
> 赞同：0
> 
> 时间：2012-07-18T13:48:19.733
> 
> 标签：c#, using, finally, resource-cleanup

在我经常使用的一些代码中（并且已经编写了几次），使用了如下代码：

```
using (StreamWriter sw = new FileWriter(".\SomeFile.txt"))
{
    // Perform file IO here...
}
finally
{
    sw.Close();
} 
```

我熟悉 C# 中的 try/catch/finally ...我知道 finally 的上下文是有效的。当我对“最终使用”一词进行谷歌搜索时，我找不到相关匹配项。

这个 finally 的上下文是否像我想的那样工作，在 Using 语句的最终命令中，Finally 块的内容在哪里被执行？还是我（以及我正在使用的代码库）都错了？最终仅限于 Try/Catch 吗？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-07-18T13:55:41.137

最终总是运行，但你的代码大部分是多余的。编码：

```
 using (StreamWriter sw = new FileWriter(".\SomeFile.txt"))
 {
     // Perform file IO here...
 } 
```

在功能上等同于

```
 {
   StreamWriter sw = new FileWriter(".\SomeFile.txt");
    try {
       // Perform file IO here...
    }
    finally {
       ((IDisposable)sw).Dispose();
    }
 } 
```

StreamWriter 的 Dispose() 方法隐式调用 Close()。然而，这不应该是一个错误，因为用户定义的 finally 在系统隐式 finally 之前运行。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-07-18T14:01:36.833

> 最终仅限于 Try/Catch 吗？

[是](http://msdn.microsoft.com/en-us/library/zwc8s4fz%28v=vs.100%29.aspx)的。一个`finally`块之前*必须*有一个`try`块。只有`catch`是可选的。除此之外，您应该阅读一些有关[范围](http://msdn.microsoft.com/en-us/library/aa691132%28v=vs.71%29.aspx)的信息。您在块中声明的`sw`变量在该`using`块之外不可访问。

此外，一旦块超出范围（即执行该块中的最后一条指令时），[`using`](http://msdn.microsoft.com/en-us/library/yh598w02%28v=vs.100%29.aspx)将处理`StreamWriter`（`FileWriter`来自Java ;-)，因此您不必手动丢弃或关闭它。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-07-18T13:51:18.437

finally 总是有效的，是否存在（未捕获的）异常并不重要

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2012-07-18T13:52:34.700

我相信当 a`using`转换为[IL](http://en.wikipedia.org/wiki/Common_Intermediate_Language)时- .Net 无论如何都会将 a 转换`using`为 a `try`（某种） - 所以在这种情况下它仍然有意义。

[见这篇文章。](http://www.codeproject.com/Articles/6564/Understanding-the-using-statement-in-C)

# python - 将数组插入 sqlite3 python

> ID：11542930
> 
> 赞同：3
> 
> 时间：2012-07-18T13:48:34.980
> 
> 标签：python, sqlite, list

我有一个字符串列表/数组：

```
l = ['jack','jill','bob'] 
```

现在我需要在 slite3 中为 python 创建一个表，使用它我可以将这个数组插入一个名为“Names”的列中。我不希望每行中的每个名称都有多行。我想要一个包含完全如上所示数组的单行，并且我希望能够以完全相同的格式检索它。如何将数组作为元素插入到数据库中？在创建数据库本身时，我应该将什么声明为数组的数据类型？喜欢：

```
c.execute("CREATE TABLE names(id text, names ??)") 
```

我如何也插入值？喜欢：

```
c.execute("INSERT INTO names VALUES(?,?)",(id,l)) 
```

编辑：我太愚蠢了。我刚刚意识到我可以有多个 id 条目并使用查询来提取所有相关名称。不管怎么说，还是要谢谢你！

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2012-07-18T14:05:46.257

`pickle`如果您以某种方式生成它的字符串表示形式，例如唱模块，您可以将数组存储在单个字符串字段中。然后，当您阅读该行时，您可以解开它。Pickle 将许多不同的复杂对象（但不是全部）转换为可以恢复对象的字符串。但是：这很可能不是您想要做的（您将无法对表格中的数据执行任何操作，除了选择行然后取消选中数组。您将无法搜索。

如果你想要任何长度可变的东西（或固定长度，但有很多类似的实例），你不会想把它放在一列或多列中。垂直的东西，而不是水平的东西，意思是：不要考虑列，考虑行。对于存储包含任意数量分量的向量，表格是一个很好的工具。

从您提供的小细节中解释起来有点困难，但是您应该考虑创建第二个表并将第一个表的每一行的所有名称都放在那里。您的第一个表中需要一些键，您也可以将其用于第二个表：

```
c.execute("CREATE TABLE first_table(int id, varchar(255) text, additional fields)")
c.execute("CREATE TABLE names_table(int id, int num, varchar(255) name)") 
```

有了这个，您仍然可以存储除名称之外的任何信息并将名称`first_table`数组存储在 中`names_table`，只需使用与 in 相同`id`的方法`first_table`并将`num`索引位置存储在数组中。然后，您可以稍后通过执行类似操作来取回数组

```
SELECT name FROM names_table 
WHERE id=?
ORDER BY num 
```

读取 中任何行的名称数组`first_table`。

这是将数组存储在数据库中的一种非常正常的方式。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-07-18T13:52:31.877

这不是要走的路。您应该考虑为名称的外键创建另一个表。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-07-18T13:53:48.030

您可以 pickle/marshal/json 您的数组并将其作为 binary/varchar/jsonfield 存储在您的数据库中。

就像是：

```
import json

names = ['jack','jill','bill']
snames = json.dumps(names)
c.execute("INSERT INTO nametable " + snames + ";") 
```

# javascript - Javascript：如果填充了数组元素，则为数组的每个元素插入表行

> ID：11542938
> 
> 赞同：0
> 
> 时间：2012-07-18T13:49:01.240
> 
> 标签：javascript, html, multidimensional-array

我有一个多维数组，并非所有元素都会被填充。我想将该数组的内容输出到 HTML 表中。我目前有这个：

```
for (var basketRowJuice = 0; basketRowJuice < 10; basketRowJuice++){
    var outputName = "";
    outputName = (basketArray[0][basketRowJuice]);
    document.getElementById("basketJuiceName" + basketRowJuice).innerHTML = outputName;
}

for (var basketRowQuant = 0; basketRowQuant < 10; basketRowQuant++){
    var outputQuant = 0;
    outputQuant = (basketArray[1][basketRowQuant]);
    document.getElementById("basketJuiceQuant" + basketRowQuant).innerHTML = outputQuant;
}

for (var basketRowPrice = 0; basketRowPrice < 10; basketRowPrice++){
    var outputPrice = 0;
    outputPrice = (basketArray[2][basketRowPrice]);
    document.getElementById("basketJuicePrice" + basketRowPrice).innerHTML = outputPrice;
} 
```

HTML表格：

```
<table id="basket" cellpadding="0" cellspacing="0" summary="This table lists the items you have in your shopping basket">
                                <caption>Your basket</caption>
                                <tr>
                                    <th scope="col">Juice name</th>
                                    <th scope="col">Number of crates</th>
                                    <th scope="col">Total price</th>
                                </tr>
                                <tr>
                                    <td id="basketJuiceName0"></td>
                                    <td id="basketJuiceQuant0"></td>
                                    <td id="basketJuicePrice0"></td>
                                </tr> 
                                <tr>
                                    <td id="basketJuiceName1"></td>
                                    <td id="basketJuiceQuant1"></td>
                                    <td id="basketJuicePrice1"></td>
                                </tr>   
                                <tr>
                                    <td id="basketJuiceName2"></td>
                                    <td id="basketJuiceQuant2"></td>
                                    <td id="basketJuicePrice2"></td>
                                </tr>
                                <tr>
                                    <td id="basketJuiceName3"></td>
                                    <td id="basketJuiceQuant3"></td>
                                    <td id="basketJuicePrice3"></td>
                                </tr> 
                                <tr>
                                    <td id="basketJuiceName4"></td>
                                    <td id="basketJuiceQuant4"></td>
                                    <td id="basketJuicePrice4"></td>
                                </tr>  
                                <tr>
                                    <td id="basketJuiceName5"></td>
                                    <td id="basketJuiceQuant5"></td>
                                    <td id="basketJuicePrice5"></td>
                                </tr>  
                                <tr>
                                    <td id="basketJuiceName6"></td>
                                    <td id="basketJuiceQuant6"></td>
                                    <td id="basketJuicePrice6"></td>
                                </tr>  
                                <tr>
                                    <td id="basketJuiceName7"></td>
                                    <td id="basketJuiceQuant7"></td>
                                    <td id="basketJuicePrice7"></td>
                                </tr>  
                                <tr>
                                    <td id="basketJuiceName8"></td>
                                    <td id="basketJuiceQuant8"></td>
                                    <td id="basketJuicePrice8"></td>
                                </tr>  
                                <tr>
                                    <td id="basketJuiceName9"></td>
                                    <td id="basketJuiceQuant9"></td>
                                    <td id="basketJuicePrice9"></td>
                                </tr>
                            </table> 
```

但是，如果我的数组仅填充在 [0][9]、[1][9] 和 [2][9] 列中，那么在输出之前，我的 HTML 中会出现巨大的空行间隙。谁能建议一个更好的方法来做到这一点？也许这样我的 javascript 会为每个填充的数组元素插入一个表格行？

我是编程新手，所以请原谅我毫无疑问的冗长和不优雅的代码。

谢谢你，乔恩

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-07-18T14:16:09.023

您可能希望在循环中更像以下内容。

```
var outputPrice = basketArray[2][basketRowPrice];
if (outputPrice) {
    // do something here.  the if statement will be true for non-null, non-empty, non-zero values of the var outputPrice.
} 
```

我还要注意，您可以将 3 个循环替换为一个，例如：

```
for (var j = 0; j < 10; j++) {
    for (var i = 0; i < 3; i++) {
        var outputName = basketArray[i][j];
        var outputQuant = basketArray[1][basketRowQuant];
        //.. do the rest of the code
    }
} 
```

最后一步是删除硬编码的HTML并动态生成它，下面是没有检查的，所以它可能有点不对劲，查找DOM方法。

```
var tbody = document.getElementById('basket').tbodies[0];
for (var j = 0; ...) {
    var tr = document.createElement('tr');
    tbody.appendChild(tr);
    for (var i = 0; ..) {
        var td = document.createElement('td');
        td.innerHTML = ...;
        tr.appendChild(td);
    }
} 
```

# java - xlsx4j - 如何在电子表格中设置列宽？

> ID：11542939
> 
> 赞同：2
> 
> 时间：2012-07-18T13:49:04.690
> 
> 标签：java, excel, xlsx, docx4j

我正在尝试使用 xlsx4j 将 JTable 导出到 XLSX 文件，但无法设置列宽。我已成功设置所有列的默认宽度，但我想设置列的宽度以自动适应数据长度：

```
public void exportToXLS() throws Exception
{           
    //Create the spreadsheet
    SpreadsheetMLPackage pkg = SpreadsheetMLPackage.createPackage();
    WorksheetPart sheet = pkg.createWorksheetPart(new PartName("/xl/worksheets/sheet1.xml"), "Sheet1", 1);

    //Set default format for rows and columns
    CTSheetFormatPr format = Context.getsmlObjectFactory().createCTSheetFormatPr();
    format.setDefaultColWidth(20.0);        
    format.setDefaultRowHeight(16.8);
    format.setCustomHeight(Boolean.TRUE);
    sheet.getJaxbElement().setSheetFormatPr(format);

    //Get a few JTable properties 
    int iSelectedTab = tabPane.getSelectedIndex();
    int[] rowsSelected = table[iSelectedTab].getSelectedRows();
    int iColumns = table[0].getColumnCount();
    int iCurrentRow;

    //Retrieve SheetData from sheet object
    SheetData sheetData = sheet.getJaxbElement().getSheetData();
    Row row;
    Cell cell;

    //Copy data from JTable to spreadsheet  
    for(int iRow=0; iRow < rowsSelected.length; iRow++)
    {                       
        iCurrentRow = rowsSelected[iRow];
        row = Context.getsmlObjectFactory().createRow();
        List<Cell>rowl = row.getC();
        for(int iCol = 0; iCol < iColumns; iCol++)
        {
            cell = Context.getsmlObjectFactory().createCell();              
            CTRst ctrst = new CTRst();
            ctrst.setT(table[iSelectedTab].getValueAt(iCurrentRow, iCol).toString());
            cell.setT(STCellType.INLINE_STR);
            cell.setIs(ctrst);              
            rowl.add(cell);

        }
        sheetData.getRow().add(row);            
    }

    //Set the columns widths
    List<Cols> lstCols = sheet.getJaxbElement().getCols();
    System.out.println("lstCols.size() is " + lstCols.size());
    for(int i = 0; i< lstCols.size(); i++)
    {
        List<Col> lstCol = lstCols.get(i).getCol();
        System.out.println("lstCol.size() is " + lstCol.size());
        for(int j=0; j<lstCol.size(); j++)
        {               
            lstCol.get(j).setBestFit(Boolean.TRUE);
            lstCol.get(j).setWidth(30.0);   
            System.out.println("Column " + i + " : " + j);
        }
    }

    //Save the spreadsheet to file
    pkg.save(new File("Export.xlsx"));              
} 
```

上面的代码在控制台中显示：lstCols.size() 为 0，所以看起来在向 SheetData 添加行和单元格后，没有列定义。

另一方面，如果我以这种方式手动创建列：

```
Cols cols = Context.smlObjectFactory.createCols();  
Col col = Context.smlObjectFactory.createCol();
col.setBestFit(Boolean.TRUE);
cols.getCol().add(col);
sheet.getJaxbElement().getCols().add(cols); 
```

我在 XLSX 文件中遇到灾难性错误。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-07-18T21:26:22.270

从 ECMA-376 规范（我查看了 3ed，第 18.3.1.17 节，p1774）：

> 此示例显示第 4 (D) 列应用了“最佳拟合”，这也是自定义宽度。此外，列 5 (E) 被列为在列级别（与单元格级别相反）应用了自定义宽度和样式。

```
<cols>
<col min="4" max="4" width="12" bestFit="1" customWidth="1"/>
<col min="5" max="5" width="9.140625" style="3"/>
</cols> 
```

因此，看起来您只需要通过指定 col 编号（通过 min/max 属性）来完成 col 对象定义。

```
<col min="2" max="2" bestFit="1"/> 
```

给出一个以零宽度开头的 col，因此您应该指定 @width.

@bestFit 似乎没有达到您的预期（您想要更像 autoFit 的东西？）。

有关更多信息，请参阅[custom-column-widths-in-excel-open-xml](http://polymathprogrammer.com/2010/01/11/custom-column-widths-in-excel-open-xml/)和[正在计算的列宽度](http://polymathprogrammer.com/2010/01/18/calculating-column-widths-in-excel-open-xml/)。

# java - Netty，java.io.StreamCorruptedException：不支持的版本：0

> ID：11542943
> 
> 赞同：0
> 
> 时间：2012-07-18T13:49:18.707
> 
> 标签：java, netty

你好，我正在开发一个使用Netty的服务器。目标是能够来回发送对象。所以我使用ObjectDecoderInputStream和ObjectEncoderOutputStream配置了服务器。

所以我有一个客户端也使用 Netty 与服务器通信。客户端工作得很好。

每当我使用 Java 的套接字从服务器接收一个可序列化的对象时。发生了一些奇怪的事情，我在下面遇到了一个异常：

```
java.io.StreamCorruptedException: Unsupported version: 0
at org.jboss.netty.handler.codec.serialization.CompactObjectInputStream.readStreamHeader(CompactObjectInputStream.java:38)
at java.io.ObjectInputStream.<init>(Unknown Source)
at org.jboss.netty.handler.codec.serialization.CompactObjectInputStream.<init>(CompactObjectInputStream.java:30)
at org.jboss.netty.handler.codec.serialization.ObjectDecoderInputStream.readObject(ObjectDecoderInputStream.java:115)
at com.bvd.main.Client.readResponse(Client.java:139)
at com.bvd.main.Client.getFile(Client.java:80)
at com.bvd.main.Client.main(Client.java:163) 
```

从客户端发送对象：

```
 public static void writeRequest(Message requestMsg,
        OutputStream outputStream) {
    byte[] bytes = null;
    ByteArrayOutputStream byteOutputStream = new ByteArrayOutputStream();
    try {
        ObjectEncoderOutputStream objectOutputStream = new ObjectEncoderOutputStream(
                byteOutputStream, 8192);
        objectOutputStream.writeObject(requestMsg);
        objectOutputStream.flush();
        bytes = byteOutputStream.toByteArray();
        byteOutputStream.close();
        objectOutputStream.close();
        outputStream.write(bytes);
    } catch (IOException e) {
        // TODO Auto-generated catch block
        e.printStackTrace();
    }
} 
```

以及客户端收到对象的代码：

```
 public static Object readResponse(InputStream inputStream) {
    int count = 0;
    Object object = null;
    try {
        byte[] lenBuffer = new byte[4];
        while ((count = inputStream.read(lenBuffer)) < 4) {
        }
        System.out.println(ByteBuffer.wrap(lenBuffer).getInt());
        int infolen = ByteBuffer.wrap(lenBuffer).getInt();
        byte[] objBuffer = new byte[infolen];
        while ((count = inputStream.read(objBuffer)) < infolen) {
        }
        byte[] totalBuf = new byte[4 + infolen];
        System.arraycopy(lenBuffer, 0, totalBuf, 0, lenBuffer.length);
        System.arraycopy(objBuffer, 0, totalBuf, lenBuffer.length,
                objBuffer.length);

        ByteArrayInputStream byteArrayInputStream = new ByteArrayInputStream(
                totalBuf);
        System.out.println(byteArrayInputStream.available());
        ObjectDecoderInputStream objectDecoderInputStream = new ObjectDecoderInputStream(
                new BufferedInputStream(byteArrayInputStream));
        object = objectDecoderInputStream.readObject();
    } catch (IOException e) {
        // TODO Auto-generated catch block
        e.printStackTrace();
    } catch (ClassNotFoundException e) {
        // TODO Auto-generated catch block
        e.printStackTrace();
    }
    return object;
} 
```

更让我困惑的是，当我在2858(byte)的服务器上设置发送的对象内容的长度（该对象携带部分已转换为byte[]的文件）时，上面的客户端运行良好；当我将长度更改为 2859 或更大时，上面会发生**StreamCorruptedException**。

ps：发送对象工作正常，服务器接收成功并正确解码，所有问题都是关于从服务器接收对象的问题。

对不起我的英语不好，任何帮助表示赞赏。谢谢。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-07-23T02:43:37.077

如果您最终进行了多个读取调用，那么在您的两个读取循环中，您将获得虚假数据：

```
 while ((count = inputStream.read(lenBuffer)) < 4) {
    }

    while ((count = inputStream.read(objBuffer)) < infolen) {
    } 
```

每次调用 read 时，它都会*写入`byte[]`*. 因此，每次循环时，都会覆盖缓冲区中的部分数据，*而不是*读取整个缓冲区的数据。您需要跟踪当前偏移量（基于您目前已读取的数据量）并将其传递给线程`read()`调用。另外，您应该累积计数，而不是分配给它。

# iphone - 确定模态视图控制器的框架或其中相对于基本窗口的内容？

> ID：11542948
> 
> 赞同：0
> 
> 时间：2012-07-18T13:49:30.857
> 
> 标签：iphone, objective-c, ios, ipad, ios5

我有一个在屏幕上（在 iPad 上）显示的模态 VC——使用 UIModalPresentationFormSheet 演示样式。当键盘出现并遮盖 VC 中的某些元素时，我想调整 VC 中的某些内容的大小。

确定键盘的大小是微不足道的，但确定模态 VC 或其中内容相对于基本窗口的精确坐标却是一项挑战。我希望：

```
CGRect textViewFrame    = textView.frame;    
CGRect frameWRTWindow   = [self.view convertRect:textViewFrame toView:nil] 
```

会给我我的 textView 相对于基本窗口的大小。但是 frameWRTWindow 的值各不相同——有时给我正确的值，有时不是。

我不想对值进行硬编码，但这就是我现在所处的位置。

* * *

## 回答 #1

> 赞同：-1
> 
> 时间：2012-07-19T16:03:32.847

你试过这个：

```
CGRect frameWRTWindow = self.superview.frame; 
```

?

# activemq - 如何正确配置带有池的 ActiveMQ？

> ID：11542953
> 
> 赞同：10
> 
> 时间：2012-07-18T13:49:43.640
> 
> 标签：activemq, connection-pooling, apache-camel

我们对 AMQ 使用以下配置

```
<bean id="jmsConnectionFactory" class="org.apache.activemq.ActiveMQConnectionFactory">
    <property name="brokerURL" value="${brokerURL1}"/>
</bean>
<bean id="pooledConnectionFactory" class="org.apache.activemq.pool.PooledConnectionFactory">
    <property name="maxConnections" value="10"/>
    <property name="maximumActive" value="100"/>
    <property name="connectionFactory" ref="jmsConnectionFactory"/>
</bean>
<bean id="jmsConfig" class="org.apache.camel.component.jms.JmsConfiguration">
    <property name="connectionFactory" ref="pooledConnectionFactory"/>
    <property name="transacted" value="false"/>
    <property name="concurrentConsumers" value="5"/>
    <property name="maxConcurrentConsumers" value="10"/>
</bean>

<bean id="activemq" class="org.apache.activemq.camel.component.ActiveMQComponent">
    <property name="configuration" ref="jmsConfig"/>
</bean> 
```

定期我有奇怪的问题 - 松散的消息。实际上 AMQ 说一切正常，消息已出列，但应用程序上没有消息...

我已经读过缓存消费者可能会出现问题，而应该在配置之后使用 JmsConfiguration

```
<bean id="jmsConfig" class="org.apache.activemq.camel.component.ActiveMQConfiguration">
    <property name="connectionFactory" ref="pooledConnectionFactory"/>
    <property name="transacted" value="false"/>
    <property name="concurrentConsumers" value="5"/>
    <property name="maxConcurrentConsumers" value="10"/>
    <property name="cacheLevelName" value="CACHE_CONSUMER"/>
</bean> 
```

有人知道如何正确配置activemq吗？应设置哪些值以获得最佳性能和良好的可靠性？

```
<property name="maxConnections" value="?"/>
<property name="maximumActive" value="?"/>
<property name="concurrentConsumers" value="?"/>
<property name="maxConcurrentConsumers" value="?"/> 
```

我应该使用`org.apache.activemq.pool.PooledConnectionFactory`还是有更好的方法？

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2012-07-18T20:11:37.650

似乎您更多的是询问如何配置 Apache Camel 如何使用 ActiveMQ。

有很多方法可以配置池等。很大程度上取决于您在设置中看到的使用/负载模式以及您的要求。您引用的那些设置 maxConcurrentConsumers 等将取决于您的骆驼路线以及您在那里设置的消费者数量。

简单地说，有两个场景需要优化： 发送和接收消息（请求/回复也会浮现在脑海中，但那是另一回事）。

如果您在应用程序中收到大量消息，那么您通常会设置消息侦听器，并且池化并没有太大帮助，因为您不会创建/拆除大量连接/会话。只要确保您配置了足够的并发消费者 - 多少取决于您的硬件（# CPU 内核等）和每条消息的大小。您必须测量您的特定设置以获得最佳性能。

当您发送消息时，Camel[建议您使用 ActiveMQ 的 PooledConnectionFactory](http://camel.apache.org/activemq.html#ActiveMQ-Usingconnectionpooling)。链接到的文档还为您要求的设置建议了一些默认值。

```
 <property name="maxConnections" value="8" />
  <property name="maximumActive" value="500" />
   <property name="transacted" value="false"/> 
```

为了获得最大的可靠性，您应该使用事务处理会话并在安全处理后提交收到的消息。

奇怪的是你说你丢失了消息，你的设置中没有任何特定的东西会让你丢失消息。您需要进一步跟踪这一点或提供有关应用程序实施的一些信息。

# .net - .NET 中 3 层和 n 层架构的主要区别？

> ID：11542960
> 
> 赞同：6
> 
> 时间：2012-07-18T13:49:54.623
> 
> 标签：.net, n-tier-architecture, 3-tier

我搜索了谷歌以找到 .net 中 3 层和 n 层架构之间的主要区别，但我没有找到它。一些网站表示两者本质上是相同的，一些网站表示它们之间存在差异。

我想知道主要区别，在性能优化方面哪个更好？

* * *

## 回答 #1

> 赞同：12
> 
> 时间：2012-07-18T14:29:01.730

## 三层架构是软件开发中的通用架构，它包括

*   表示层（客户端浏览器）

*   应用程序或业务逻辑层

*   数据层

# .Net 中的 n 层架构

![在此处输入图像描述](../Images/163d385b2360c9cc4a4b119691d319e5.png)

主要区别在于 n 层拱门有 2 个额外的层。数据层的示例开发人员的一部分是 SQL 开发人员，他们在 DB 服务器上工作（制作 DB 结构，编写存储过程等），以及 .Net 开发人员，他们致力于使用存储过程和进行抽象（实现存储库模式）。 .

希望这对您有所帮助。

* * *

## 回答 #2

> 赞同：7
> 
> 时间：2014-04-11T03:40:02.370

我知道这个问题很老，但真正简单且最终正确的答案是：

3 层*是*N 层，其中 N=3。

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2016-05-29T02:36:31.777

[msdn链接](https://blogs.msdn.microsoft.com/cesardelatorre/2008/09/04/updating-data-using-entity-framework-in-n-tier-and-n-layer-applications-short-lived-ef-contexts-part-1/)

N 层应用程序是具有 3 个或更多物理层的应用程序。我的意思是“演示/客户端层”、“应用程序/业务服务器层”和“数据层”（大多数情况下是数据库服务器），而现在我们使用 Web 服务（甚至更好的是 WCF 服务）在表示层和应用服务器层之间进行通信。在这里，您可以看到有关 N 层架构的简单而典型的图片：

不同的是，我们可能会将我们的应用程序设计为 N 层应用程序，我的意思是，有几个逻辑层，我们在其中实现不同的逻辑任务。例如，根据我们使用的模式，我们可以有 DAL 层（数据访问层）、BLL 层（业务逻辑层）、BFLL 层（业务外观逻辑层）、WCF 服务层和几个表示层，例如 MVC（模型- View-Controller)、MVP (Model-View-Presenter) 等。此外，在 N 层架构中，您可以猜测实体框架适合作为 DAL 层（数据访问类）以及使用 EF 实体作为我们的断开连接的实体通过所有层，好吗？

顺便说一句，并非所有 N-Layer 应用程序都应该是 N-Tier 应用程序，但所有 N-Tier 应用程序必须在内部设计为 N-Layer。我的意思是，在很多情况下，你对模型的物理拆分越少，性能就越好（由于延迟，更多的层有利于可伸缩性，但不利于纯粹的性能）。请记住，N 层是关于逻辑层的。

好的！所以如果我们回到 N 层架构（物理层），就像我说的那样，我们需要远程机制来将客户端层与应用程序服务器层（例如 WCF 服务）进行通信，因此当我们查询来自应用服务器层的数据库，为了获取数据（如订单），我们将其保留为 EF 实体，然后将其与 EF 上下文断开连接（分离），WCF 对其进行序列化并将断开连接的实体发送到表示层（客户端应用程序和机器）。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2019-07-18T09:20:50.697

`N -Tier`和的区别`3 Tier`如下。

在`3 Tier`应用程序中有三层，如表示层、应用程序层和数据层。这里的应用层也包含业务逻辑。

另一方面，`N Tier`应用层分为2层，即应用层和业务逻辑层。`N`您可以根据来自表示层的数据（不同的操作系统、不同的平台等）添加最多数量的应用程序层。

# javascript - knockout.js 和具有现有 getter/setter 的视图模型（不是 ko.observable）

> ID：11542964
> 
> 赞同：2
> 
> 时间：2012-07-18T13:50:11.860
> 
> 标签：javascript, mvvm, knockout.js

knockout.js 似乎针对对象/字段绑定进行了优化，并且可以使用[ko.observables](http://knockoutjs.com/documentation/observables.html)来创建 getter/setter 函数。

但是，如果我想绑定的视图模型的成员已经是 getter/setter 函数怎么办？使这两者集成的最简单方法是什么？

```
var example = {
    FirstName: function(/* setValue */) { ... };
    LastName: function(/* setValue */) { ... };
    ArrayOfSomething: function(index /*, setValue */) { ... };
} 
```

我必须创建一个[自定义绑定](http://knockoutjs.com/documentation/custom-bindings.html)（这看起来很复杂）还是有其他机制？

这将如何工作`ArrayOfSomething`？

# javascript - 将数组从 javascript 传递到 servlet

> ID：11542970
> 
> 赞同：0
> 
> 时间：2012-07-18T13:50:37.127
> 
> 标签：javascript, servlets

我的 JSP 页面上有许多复选框。我需要将所有复选框的 ID 传递给我的 servlet，以便我可以执行一些数据库操作。我认为我可以在我的 javascript 函数中创建一个数组，放置在一个不同的 .js 文件中，该文件将存储这些 id，然后将数组传递给我的 servlet。但我无法弄清楚如何应用这个概念。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-07-18T13:53:09.130

这类问题通常用

```
 <input type="checkbox" name="foo" value="1">
  <input type="checkbox" name="foo" value="2">
  <input type="checkbox" name="foo" value="3">
  <input type="checkbox" name="foo" value="4"> 
```

进而

```
String values[]=req.getParameterValues("foo"); 
```

它为您提供了所有检查值的数组。

# c# - 尝试使用 sql 语句存储文本时收到 sql 注入攻击

> ID：11542972
> 
> 赞同：-1
> 
> 时间：2012-07-18T13:50:49.057
> 
> 标签：c#, sql

我在文本类型的数据库表中有一个列。此列可以包含 sql 语句。当我尝试将此文本插入 sql server 时，我收到了来自机器上安装的防病毒软件的 sql 注入攻击。

我如何转义文本，以便防病毒软件无法捕获它。

一个示例文本是：

```
"*By supplying a malformed @scriptfile parameter an attacker can run arbitrary
commands:
use master
declare @cmd nvarchar(4000)
exec sp_MScopyscriptfile N'c:\autoexec.bat" c:\cp.txt&amp;echo hello &gt;
c:\ccc.bbb &amp; echo "hello',@cmd OUTPUT
print @cmd
The above query will copy the autoexec.bat file to cp.txt but also echo hello to a file called ccc.bbb.* " 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-07-18T14:59:32.263

使用参数。

所有主要的 RDBMS 都在 C# 中可用。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-07-18T14:58:33.623

在将文本存储到数据库之前，我会尝试以某种方式对文本进行编码。像 Rot13 这样简单的东西应该可以解决问题。

# windows - 如何手动/通过注册表删除桌面图标？

> ID：11542974
> 
> 赞同：1
> 
> 时间：2012-07-18T13:50:50.320
> 
> 标签：windows, registry, administration, system-administration

我的公司笔记本电脑上有一堆烦人的图标，由于组策略我无法删除，如何通过注册表删除它们？

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-07-18T14:05:33.710

如果要删除桌面中的所有图标，请转到：

```
[HKEY_CURRENT_USER\Software\Microsoft\Windows\CurrentVersion\Explorer\Advanced] 
```

添加：

```
Name: HideIcons 
Type: REG_DWORD
Value: 1 
```

如果要删除特定图标（未测试）：

```
[HKEY_CURRENT_USER\Software\Microsoft\Windows\CurrentVersion\Explorer\HideDesktopIcons\NewStartPanel] 
```

在这里，您会发现几个 GUID，每个图标一个。值 0x0 将显示图标，0x1 将隐藏它。只需更改它并刷新桌面，它应该可以工作。

一些例子：

```
Network Places:         {208D2C60-3AEA-1069-A2D7-08002B30309D}
My Computer:            {20D04FE0-3AEA-1069-A2D8-08002B30309D}
My Documents:           {450D8FBA-AD25-11D0-98A8-0800361B1103}
Internet Explorer:      {871C5380-42A0-1069-A2EA-08002B30309D}
Recycle Bin:            {645FF040-5081-101B-9F08-00AA002F954E} 
```

# actinic - 光化网络增益

> ID：11542975
> 
> 赞同：0
> 
> 时间：2012-07-18T13:50:53.357
> 
> 标签：actinic

问题在于 Actic 版本 7 中的变量。此代码适用于 Actinic 版本 10。Webgains 获取信息，但未获取订单号或订单总额。

我认为这与变量 TheOrderNumber 和 NumericOrderTotal 有关。

```
<!-- <webgains tracking code> -->

<script language="javascript" type="text/javascript">

var wgOrderReference = "TheOrderNumber";

var wgOrderValue = "NumericOrderTotal";

var wgEventID = 10363;

var wgComment = "";

var wgLang = "en_EN";

var wgsLang = "javascript-client";

var wgVersion = "1.2";

var wgProgramID = 6455;

var wgSubDomain = "track";

var wgCheckSum = "";

var wgItems = "";

var wgVoucherCode = "";

var wgCustomerID = "";

var wgCurrency = "GBP";

if(location.protocol.toLowerCase() == "https:") wgProtocol="https";

else wgProtocol = "http";

wgUri = wgProtocol + "://" + wgSubDomain + ".webgains.com/transaction.html" + "?wgver=" + wgVersion + "&wgprotocol=" + wgProtocol + "&wgsubdomain=" + wgSubDomain + "&wgslang=" + wgsLang + "&wglang=" + wgLang + "&wgprogramid=" + wgProgramID + "&wgeventid=" + wgEventID + "&wgvalue=" + wgOrderValue + "&wgchecksum=" + wgCheckSum + "&wgorderreference="  + wgOrderReference + "&wgcomment=" + escape(wgComment) + "&wglocation=" + escape(document.referrer) + "&wgitems=" + escape(wgItems) + "&wgcustomerid=" + escape(wgCustomerID) + "&wgvouchercode=" + escape(wgVoucherCode) + "&wgCurrency=" + escape(wgCurrency);

document.write('<sc'+'ript language="JavaScript"  type="text/javascript" src="'+wgUri+'"></sc'+'ript>'); 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-07-18T19:22:07.560

Actinic 版本 7 仍然使用旧的变量使用方式，因此您需要使用 NETQUOTEVAR:THEORDERNUMBER 和 NETQUOTEVAR:ACTINICORDERTOTAL。

如果您使用它，则需要将 NETQUOTEVAR:ACTINICORDERTOTAL 除以 100：

```
var realPrice = NETQUOTEVAR:ACTINICORDERTOTAL / 100;

var wgOrderReference = "NETQUOTEVAR:THEORDERNUMBER";
var wgOrderValue = String(realPrice); 
```

这在您可以在订单参考中添加但不能添加到总数中的无脚本版本中不起作用。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-07-30T14:05:40.367

no Script 标签也需要使用这些变量进行更新:)

```
<noscript>
<img src="http://track.webgains.com/transaction.html?wgver=1.2&wgprogramid=6455&wgrs=1&wgvalue=NETQUOTEVAR:NUMERICORDERTOTALCGI&wgeventid=10363&wgorderreference=NETQUOTEVAR:THEORDERNUMBER&wgitems=&wgvouchercode=&wgcustomerid=&wgCurrency=GBP" alt="" />
</noscript> 
```

# wpf - 将用户控件的依赖属性绑定到其数据上下文

> ID：11542977
> 
> 赞同：0
> 
> 时间：2012-07-18T13:50:56.067
> 
> 标签：wpf, binding, user-controls, dependency-properties, datacontext

我有一个具有一个依赖属性的 UserControl。此 UserControl 用于已将 ViewModel 作为 DataContext 的视图中。我目前正在将我的顶级数据上下文中的一个属性绑定到依赖属性。但现在我想将相同的依赖属性绑定到来自 UserControl 的 Datacontext 的属性。最后，我想要我的 DataContext 的 2 个属性之间的绑定 - 视图和用户控件的。

我怎么能做到这一点？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-07-18T14:49:02.343

尝试以下绑定方式之一

```
 // UserControl DataContext={Binding SomeDataContext } Suppose here UserControl starts
    <!--Bind Height with Width of SameControl-->
    <TextBox Name="textBox1" Height="{Binding Width, RelativeSource={RelativeSource Mode=Self}}"/>

    <!--Bind Height to the  VMProperty in the DataContext of Window-->
    <TextBox Name="textBox2" Height="{Binding DataContext.VMProperty, RelativeSource={RelativeSource AncestorType={x:Type Window}}}"/>

    <!--Bind Height with the Width of first textbox-->
    <TextBox Name="textBox3" Height="{Binding Width, ElementName=textBox1}"/>

    <!--bind Height with the UserControlDataContextProperty in UserControl DataContext-->

    <TextBox Name="textBox4" Height="{Binding UserControlDataContextProperty}"/>
    //Here UserControl ends 
```

以上是多种绑定方式。您可以使用适合您要求的。我希望这会有所帮助。

# jquery - 动态手风琴

> ID：11542979
> 
> 赞同：0
> 
> 时间：2012-07-18T13:50:57.143
> 
> 标签：jquery, dynamic, refresh, accordion

我有一个关于 jQuery Accordion 的问题。

手风琴的设置有点时髦。

看起来像这样：

手风琴头
表格件

手风琴头
表格件

手风琴头
表格件

我要做的是根据先前的表单输入更改 Accordion 标题（以及单击标题时显示的信息）。这行得通，除了它确实显示为 Accordion 标题（所以基本上它丢失了 jQuery UI 手风琴部分，只是显示为带有文本的链接，当您单击手风琴时通常会下拉）。

这是一些代码：

在主 html 文档中

```
<script type="text/javascript">
    jQuery(function(){
    // Accordion
    //initialize accordion       

    jQuery("#jQueryUIAccordion").accordion({ 
        header: "h3",
        animated: "",
        event: "click",
        collapsible : true,
        autoHeight: false,
        navigation: true,
        active: false 
    }); 
    //set accordion header options
    jQuery("#jQueryUIAccordion").accordion("option", "icons",
      { 'header': 'ui-icon-triangle-1-e','headerSelected': 'ui-icon-info' });
    }); 
</script>

<div class="container fontClassBody paddingLeftBody">
    <div class="row">
        <div class="left">
            <div id="starting_type_in">
                <select name="Start" onchange="choiceStart(this.form);">
                    <option value=""></option>
                    <option value="Current Limit">Current Limit</option>
                    <option value="Soft Start">Soft Start</option>
                </select>
            </div>
        </div>
    </div>  
</div> 
```

*****这是需要根据上述更改的内容* *** ******

 **```
<div>
    <div id="current_torque"><h3><a href="#">Torque/Current %</a></h3>
        <div>This represents the level of current that will be allowed during the start.This is only active when a current limit mode is selected and is programmable as allowed by the product selected. 
             Since most designs are based in historical references the best place to start an analysis is with 350% current limit, which produces a torque equivalent to a star-delta type historical reduced voltage starting method.
        </div>
    </div>
</div> 
```

****这是表单输入如何更改下一个手风琴标题（在单独的 javascript 文件中）* ** *** ***

```
function setCurrentTorque() {
    var cur_trq = "";
    if (start_type === "Current Limit") {
        cur_trq = "<h3><a href='#'>Initial Current %</a></h3><div>This represents the level of current that will be allowed during the start. This is only active when a current limit mode is selected and is programmable as allowed by the product selected. Since most designs are based in historical references the best place to start an analysis is with 350% current limit, which produces a torque equivalent to a star-delta type historical reduced voltage starting method. </div>"; 
     } else if (start_type === "Soft Start") {
     cur_trq = "<h3><a href='#'>Initial Torque %</a></h3><div>This represents the initial level of torque that will be applied to the motor at zero speed. This value will increase as the voltage is ramped during the start time. This value is only active when a soft start mode is selected and is programmable as allowed by the product selected. A default setting of around 70% is a good place to start with the estimation.</div>";
     } else {
     cur_trq = "<h3><a href='#'>Torque/Current %</a></h3><div> Initial Current %: <br />This represents the level of current that will be allowed during the start. This is only active when a current limit mode is selected and is programmable as allowed by the product selected. Since most designs are based in historical references the best place to start an analysis is with 350% current limit, which produces a torque equivalent to a star-delta type historical reduced voltage starting method.<br /><br /> Initial Torque %: <br />This represents the initial level of torque that will be applied to the motor at zero speed. This value will increase as the voltage is ramped during the start time. This value is only active when a soft start mode is selected and is programmable as allowed by the product selected. A default setting of around 70% is a good place to start with the estimation.</div>"; 
    }
     document.getElementById('current_torque').innerHTML = cur_trq;
    }
} 
```

我希望这些信息足以让你们都开怀大笑。我想我想我正在尝试做一些 jQuery 刷新，但我不知道如何实现这一点，试图照顾以前的实习生工作，直到现在我从未使用过 jQuery。

非常感谢，

随机技术老兄**

# html - 如何将页面中的特色图像缩略图放在 wordpress 的主索引上

> ID：11542987
> 
> 赞同：1
> 
> 时间：2012-07-18T13:51:07.353
> 
> 标签：html, image, wordpress, thumbnails, frontpage

我正在尝试将页面中的特色图片与帖子中的特色图片一起放在博客的主索引页面上（帖子特色图片已经存在）。对于较长的帖子，我希望能够将它们分成多个帖子，将它们放在一个类别下，将该类别页面放在主索引上，然后将每个页面放在该类别页面上。

这是网站：

[http://theshalomimaginative.com/blog](http://theshalomimaginative.com/blog)

谢谢！

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-07-18T14:20:29.227

您可以通过设置自定义查询然后运行该查询为指定页面挑选特色图像来做到这一点。下面的示例使用 ID 为 7 的页面。

```
<?php $featured_image = new WP_Query('page_id=7'); ?>
    <?php while ($featured_image->have_posts()) : $featured_image->the_post(); ?>

    <?php if (function_exists('has_post_thumbnail') && has_post_thumbnail()) { ?>

        <?php $img_src = wp_get_attachment_image_src(get_post_thumbnail_id($post->ID), array( 960,960 )); ?>

        <div class="the-image">
            <a href="<?php the_permalink; ?>"><img src="<?php echo $img_src[0]; ?>" /></a> 
        </div>

    <?php }; ?>

    <?php endwhile; ?>
 <?php wp_reset_query(); ?> 
```

然后在其他地方，您将设置另一个自定义查询以从您的特定帖子类别中提取帖子并运行相同类型的脚本，只需更改 WP_Query.ie 的参数；

```
 <?php $featured_postimages = new WP_Query('cat=4&posts_per_page=-1'); ?>
          <?php while ($featured_postimages->have_posts()) : $featured_postimages->the_post(); ?> 
```

*编辑 2

好的，我明白了——我们再来一次。上面的代码完全一样。更改的是您用于此自定义页面的模板（特色图片链接到的模板）。

您需要设置自定义模板并将其分配给自定义页面。在您称之为帖子列表的自定义模板中；

[http://codex.wordpress.org/Pages#Creating_Your_Own_Page_Templates](http://codex.wordpress.org/Pages#Creating_Your_Own_Page_Templates)

# json - getJSON 与 ServiceStack？

> ID：11542989
> 
> 赞同：1
> 
> 时间：2012-07-18T13:51:17.657
> 
> 标签：json, rest, servicestack

服务器端：

```
[RestService("/x")]
public class XFilter
{
    public long[] CountryIds { get; set; }
}

public class XService : RestServiceBase<XFilter>
{
    private const int PageCount = 20;

    public override object OnGet(XFilter request)
    {
        Debugger.Break(); // request is always default at this point  !!
        return a;
    }
} 
```

客户端：

```
<script type="text/javascript">

 var requestData= "{CountryIds:[1,2]}";
$.getJSON("/api/x", requestData, function (b) {

}); 
```

它一定很简单，但我无法使用这种方法在服务器端获取 XFilter。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-07-18T15:37:15.177

这不是有效的 JSON：

```
var requestData= "{CountryIds:[1,2]}"; 
```

必须引用所有字符串，例如：

```
var requestData= '{"CountryIds":[1,2]}';
var requestData = JSON.stringify({CountryIds:[1,2]}); //same as above 
```

这将是您通过`$.ajax`POST 发送的内容，您可能会考虑这样做，因为在 GET 请求中没有处理复杂类型的约定，因为它必须将其序列化为 queryString。

如果您想将复杂类型作为 queryString 发送，您需要自己构建 URL。ServiceStack 使用其[JSV 格式](https://github.com/ServiceStack/ServiceStack.Text#jsv-text-format-json--csv)来处理 GET 请求中的复杂类型（这只是带有 CSV 转义的 JSON，也就是不带引号的 JSON）。

所以你的请求现在是：

```
var requestData = "[1,2]";
$.getJSON("/api/x?CountryIds=" + requestData, function (b) {
}); 
```

Re-Cap：如果您想发送 JSON，您需要通过 ajax POST 发送。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-07-18T14:14:07.123

```
var requestData= "{CountryIds:[1,2]}"; 
```

一定是

```
var requestData= {CountryIds:[1,2]}; 
```

！

但是getJSON还是有问题。它不适用于数组？

[使用 jQuery getJson 发送列表/数组作为参数](https://stackoverflow.com/questions/3676883/send-list-array-as-parameter-with-jquery-getjson)是它的解决方案:)

添加这个：

```
 $.ajaxSetup({
    traditional: true
}); 
```

# android - Android for dummy 示例错误

> ID：11542990
> 
> 赞同：0
> 
> 时间：2012-07-18T13:51:16.753
> 
> 标签：android, android-layout, android-emulator

我是 android 编程的新手，我正在通过“Android Application Development for dummies”学习它。书中有一个任务提醒应用程序的示例。我面临的问题是它在模拟器上运行时没有显示内置图像 ic_menu _add 。我使用的是安卓 4.1。以下是xml文件和主要活动文件的代码。

(list_menu.xml)

```
 <?xml version="1.0" encoding="utf-8"?>
<menu xmlns:android="http://schemas.android.com/apk/res/android" > 

<item android:id="@+id/menu_insert"
android:icon="@android:drawable/ic_menu_add"
android:title="@string/menu_insert" />

</menu> 
```

(ReminderListActivity.java)

```
 @Override
public boolean onCreateOptionsMenu(Menu menu) {
    getMenuInflater().inflate(R.menu.activity_reminder_list, menu);
    MenuInflater mi = getMenuInflater();
    mi.inflate(R.menu.list_menu, menu);
    return true;
} 
```

我已经尝试了我可能做的一切。我也用 Android 2.2、2.1 运行过这段代码，但发现了同样的问题。

提前谢谢了

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-07-18T13:57:51.250

Why did you inflate two xml menus in the same method ? check your onCreateOptionsMenu method

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-07-18T13:55:25.453

将您的项目目标更改为 android 8（或小于 14），它将工作。Android 4.1 没有菜单按钮

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-07-18T14:07:35.193

在 API 级别 8 中使用它在 4.1 中工作不确定

```
 public static final int ADD_CATEGORY_INDEX = Menu.FIRST;

@Override
public boolean onCreateOptionsMenu(Menu menu) {
    super.onCreateOptionsMenu(menu);

    menu.add(0, ADD_CATEGORY_INDEX, 0, "Add").setIcon( android.R.drawable.ic_menu_add);
    return true;
} 
```

# java - 如何在Java中获取对象类？

> ID：11542998
> 
> 赞同：3
> 
> 时间：2012-07-18T13:51:43.760
> 
> 标签：java, performance, class, comparison

获取实例类的最佳方法是什么？

推荐的方法是什么？以及它们之间有什么区别（性能）：

*   比较班级

`if( this.getClass().equals(MyClass.class) ){` 这似乎与`this.getClass() == MyClass.class` （或可能使用 `Class.forName("com.test.MyClass")`）相同

*   *测试（似乎更具可读性）*的实例

     *```
    if( this instanceof MyClass ){ 
    ```* 
**   使用类测试实例

    ```
    if( MyClass.class.isInstance(myInst) ){ 
    ```* 

 ** * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-07-18T13:55:37.217

我会建议`this.getClass().equals( MyClass.class)`您完全匹配一个类，`"someString" instanceOf Object`因为 String 类是 Object 的子类型，因此会产生 true。

这是检查`is a`任何实例和类之间的关系。

在您的情况下，任何子类`MyClass`都会产生`true`

1.  `instanceof`测试左边的东西是右边类型的实例还是某个子类型。
2.  `getClass() == ...`测试类型是否相同。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-07-18T13:58:12.490

选项一仅告诉您该类是否正是您正在测试的内容。这通常不是很有用。例如，它对接口完全没有意义。如果这实际上是您想要做的，您可能可以使用`==`，除非您使用不同的 s，在这种情况下，每个对象`ClassLoader`可能有多个实例。`Class`

选项二告诉您对象是否可以静态分配给给定的类（即可以强制转换为它）。

选项三与二相同，但使用[反射 API](http://docs.oracle.com/javase/6/docs/api/java/lang/Class.html#isInstance%28java.lang.Object%29)。只有在进行动态输入时才需要这个。内置的`instanceof`可读性更强，应该更有效率。*