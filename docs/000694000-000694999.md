# StackOverflow 问答 000694000-000694999

# python - 为什么 subprocess.Popen(...) 不总是返回？

> ID：694000
> 
> 赞同：6
> 
> 时间：2009-03-29T02:18:09.197
> 
> 标签：python, subprocess

我希望这是一个简单的python问题。

当我在 python 解释器中尝试以下操作时：

```
>>> import process
>>> def test(cmd):
...   p = subprocess.Popen(cmd)
...
>>> test(['ls', '-l']) 
```

它将运行`ls -l`，但我需要点击“return”以获得新的 >>> 提示。

但是，当我尝试以下操作时：

```
>>> import process
>>> def test(cmd):
...   p = subprocess.Popen(cmd)
...   p.wait()
...
>>> test(['ls', '-l']) 
```

然后`ls -l`将立即运行 >>> 提示符。

另一种变体：

```
>>> import process
>>> def test(cmd):
...   p = subprocess.Popen(cmd, stdout=subprocess.PIPE)
...
>>> test(['ls', '-l']) 
```

这会给我一个立即的新提示。

最后一个例子最接近我想要的。我的目标是启动一个子进程，等待它完成，然后通过引用在我的父进程中使用它的 stdout，`p.stdout`同时让 stderr 打印到其他地方。

现在在我的实际应用程序中，最后一个版本只是挂在： `p = subprocess.Popen(cmd, stdout=subprocess.PIPE)`有或没有`p.wait()`.

谢谢，

查理

* * *

## 回答 #1

> 赞同：8
> 
> 时间：2009-03-29T03:47:51.917

在第一个变体中，`test()`在启动进程后立即返回，但在其输出发送到控制台之前。

如果您查看输出，您*确实*会在 . 的输出之前立即收到提示`ls`。

```
>>> test(['ls', '-l'])
>>> total 0                            <----- test() returns, new propmpt
--rw-r--r--    1 foo bar   7 Mar 24 17:38
etc etc 
```

在第二个变体中，`test()`等待进程在返回之前终止。

在第三个版本中，您可能必须从子进程中读取`stdout`它才能继续。

* * *

## 回答 #2

> 赞同：7
> 
> 时间：2009-03-29T02:35:19.577

我可能已经回答了我自己的问题。我相信在最后一种情况下，我需要从 p.stdout 显式读取，以便我的过程继续。

IE：

```
p = subprocess.Popen(cmd, stdout=subprocess.PIPE)
output = p.stdout.readlines()
.... 
```

谢谢大家

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2014-02-20T09:46:46.980

Just use communicate() method.No need to return.

```
>>> test(['ls', '-l'])
>>> 
>>> def test(cmd):
...    p = subprocess.Popen(cmd).communicate()
... 
>>> test(['ls', '-l']) 
```

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2014-08-22T18:17:12.413

这是一个永远 ping Google 的命令，因此需要手动终止它以检索输出。

有关将 os.popen() 方法调用转换为完整的 subprocess.Popen 类的说明，请参阅subprocess[文档。](https://docs.python.org/2/library/subprocess.html#replacing-os-popen-os-popen2-os-popen3)

```
host = "www.google.com"
command = "ping %s -t"%host

#p = os.popen(command) -- using Popen instead of os.popen() to allow calling terminate()
p = Popen(command, stdout=subprocess.PIPE)

time.sleep(5)
print "term"
p.terminate()
pingResultSoFar = p.communicate()[0] # get what has been printed to standard out so far
print pingResultSoFar 
```

# python - 了解 Python 类实例

> ID：694002
> 
> 赞同：2
> 
> 时间：2009-03-29T02:19:23.907
> 
> 标签：python, class, sum

我正在解决一个问题，它使用 python 类并有一个构造函数来给出一个骰子的边数，以及一个函数来滚动骰子，并根据边数返回一个随机数。我意识到代码非常基本，但我很难理解如何总结三个不同面的骰子的总数。由于变量正在传递函数实例，因此获取该值以将其相加的最佳方法是什么？这就是我所拥有的。

*澄清一下...我可以将 roll1.roll_dice() 的总数加起来，但我必须单独显示每个掷骰子，然后显示三个骰子的总数。我可以做其中之一，但不能同时做。

```
class Die():

        def __init__(self, s = 6):
            self.sides = s
        def roll_die(self):
            x = random.randint(1,self.sides)
            return x

        roll1 = Die()   #Rolling die 1 with the default side of 6
        roll2 = Die(4)  #Rolling die 2 with 4 sides
        roll3 = Die(12) #Rolling die 3 with 12 sides

        print roll1.roll_die()  
        print roll2.roll_die()
        print roll3.roll_die() 
```

* * *

## 回答 #1

> 赞同：10
> 
> 时间：2009-03-29T02:32:52.673

您可以将结果存储在列表中：

```
rolls = [Die(n).roll_die() for n in (6, 4, 12)] 
```

然后您可以显示单个结果

```
>>> print rolls
[5, 2, 6] 
```

或将它们相加

```
>>> print sum(rolls)
13 
```

或者，您可以保留一个运行总计：

```
total = 0
for n in (6, 4, 12):
    value = Die(n).roll_die()
    print "Rolled a", value
    total += value
print "Total is", total 
```

（编辑以反映对问题的更改/澄清）

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2009-03-29T02:37:16.220

我不确定你到底在哪里感到困惑。您需要做的最简单的事情是将您要滚动的特定骰子（对象）的概念与动作（滚动它）分开。我将从这里开始：

```
d6 = Die() #create die 1 with the default side of 6
d4 = Die(4) #create die 2 with 4 sides
d12 = Die(12) #create die 3 with 12 sides

roll1 = d6.roll_die()
roll2 = d4.roll_die()
roll3 = d12.roll_die()

print "%d\n%d\n%d\nsum = %d" % (roll1, roll2, roll3, roll1 + roll2 + roll3) 
```

...然后用列表等变得更有趣。

* * *

## 回答 #3

> 赞同：3
> 
> 时间：2009-03-29T03:01:03.883

仅存储最后一卷也可能很有用，这样您就可以随时获取它。

```
def __init__(self, s = 6):
    self.sides = s
    self.last_roll = None

def roll_die(self):
    self.last_roll = random.randint(1,self.sides)
    return self.last_roll 
```

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2009-03-29T02:22:54.477

由于`roll_die`返回一个值，您可以添加这些值。

试试这个。

```
roll1.roll_die() + roll2.roll_die() 
```

发生什么了？

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2009-03-29T02:30:02.743

您可以将数字相加。如果您想对*n*次滚动的结果求和，请考虑将此函数添加到类中：

```
def sum_of_n_rolls(self, n)
    return sum(self.roll_die() for _ in range(n)) 
```

另外，考虑将*roll_die*重命名为*roll*。很明显，这与滚石无关，因为该方法是*Die*类的一部分。

* * *

**编辑**：我现在读到您需要打印中间卷。考虑：

```
def n_rolls(self, n):
    return [self.roll_die() for _ in range(n)] 
```

现在你可以掷一个 7 面骰子 10 次：

```
rolls = Die(7).n_rolls(10)
print(rolls, sum(rolls)) 
```

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2009-03-29T02:56:51.447

猜猜我会做这样的事情：

```
# Create dice
sides = [6,4,12]
dice = [Die(s) for s in sides]

# Roll dice
rolls = [die.roll_die() for die in dice]

# Print rolls
for roll in rolls:
    print roll 
```

如果您愿意，还可以组合其中的一些步骤：

```
for num_sides in [6,4,12]:
    print Die(num_sides).roll_die() 
```

* * *

## 回答 #7

> 赞同：0
> 
> 时间：2009-03-29T06:36:33.430

如果我理解正确，您需要一个类属性。

**更新：**添加了一种自动重置总数的方法

```
import random

class Die():
    _total = 0

    @classmethod
    def total(cls):
        t = cls._total
        cls._total = 0
        return t

    def __init__(self, s=6):
        self.sides = s

    def roll_die(self):
        x = random.randint(1,self.sides)
        self.__class__._total += x
        return x

roll1 = Die()   #Rolling die 1 with the default side of 6
roll2 = Die(4)  #Rolling die 2 with 4 sides
roll3 = Die(12) #Rolling die 3 with 12 sides

print roll1.roll_die()  
print roll2.roll_die()
print roll3.roll_die()
print Die.total()
print "--"
print roll1.roll_die()  
print roll2.roll_die()
print roll3.roll_die()
print Die.total() 
```

* * *

## 回答 #8

> 赞同：0
> 
> 时间：2009-03-29T22:26:23.023

让我们发疯吧:)（也结合我的最后一个答案）

```
class Die():
    def __init__(self, s = 6):
        self.sides = s
        self.last_roll = None

    def roll_die(self):
        self.last_roll = random.randint(1,self.sides)
        return self.last_roll

dice = map(Die, (6, 4, 12))
rolls = map(Die.roll_die, dice)

print rolls
print sum(rolls) 
```

# user-interface - 使用 D 进行跨平台 GUI 编程

> ID：694003
> 
> 赞同：12
> 
> 时间：2009-03-29T02:19:33.813
> 
> 标签：user-interface, cross-platform, d

我想从 D 开始编程。我有一个需要 GUI 的简单应用程序，但我想确保它同样好地移植到 Linux/Windows/Mac，并且每个平台的更改最少（无）。

wxD 看起来像是首选的竞争者，因为我已经知道 wx 工具包。

我将 fltk4d 视为 Qt 的竞争者和（未完成的）包装器。

是否有任何其他真正跨平台的 D 图形用户界面工具包可以毫不费力地到达我想要的地方？这里的人们选择的工具包是什么？

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2009-03-29T02:41:46.897

[GtkD](http://www.dsource.org/projects/gtkd)作为一个稳定的 Windows/Linux/Mac GUI 工具包对你来说应该是一个很好的选择。

[DWT](http://www.dsource.org/projects/dwt)曾经被认为是标准，它在 Digital Mars 服务器上拥有自己的新闻组，我认为 Walter Bright 可能也将其称为标准。我不认为它完全可以在 Mac 上运行，但将来应该会改变。

[这](http://www.prowiki.org/wiki4d/wiki.cgi?GuiLibraries)是一些其他选项的不错列表，但大多数选项的开发活动较少和/或尚未准备好投入生产。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-03-29T04:43:25.527

我没有使用过任何 D 的 GUI 库，但如果我现在想使用一个，我会选择 wxD。我会选择它，因为我认为 wxD 将拥有最原生的控件并且是跨平台的。特别是因为您已经了解 wx，它看起来是一个不错的选择。

我实际上正在编写一个跨平台的 GUI 库 Dynamin，但我还没有发布它。它不是一个港口；移植的库往往没有那么好的 API 或利用尽可能多的语言特性。但仅仅做一些简单的程序还远远不够。我还没有 Mac 后端或 GTK 主题。

# fonts - 如何获取字体的大小范围

> ID：694005
> 
> 赞同：0
> 
> 时间：2009-03-29T02:22:02.793
> 
> 标签：fonts

我想要做的是让用户从第三方字体选择组合框中选择一种字体并选择字体大小。如何获得该字体的正确大小范围？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-03-29T02:31:13.113

大多数字体是基于矢量的，即由线条和二次贝塞尔曲线描述。这意味着您可以随意调整它们的大小而不会降低质量。因此，在您的问题的上下文中，字体没有“大小范围”。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2009-03-29T02:32:22.847

字体（通常）是基于矢量的，可以以任何合理的点大小显示。我说“合理”是因为在典型的显示器上，低于 8pts 的字体并不是非常有用。

大多数 Microsoft 产品给出的范围从 8、9、10、11、12 开始，然后以不断增加的点值跳跃，最高可达 72。根据您的应用程序，您可能希望允许各种较小的值（如 8-12 ) 然后是一些更大的值..“正确”范围实际上取决于您要如何使用字体。

# wpf - 如何操作 TreeView 中的数据？我应该使用 ViewModelPattern 吗？

> ID：694007
> 
> 赞同：2
> 
> 时间：2009-03-29T02:23:21.620
> 
> 标签：wpf, design-patterns

我正在编写的编辑器的一部分使用 Wpf-TreeView。我正在使用 DataBinding 和 ItemTemplate 来填充 TreeView。到目前为止，我正在直接操作 ItemsSource（主要是 ObeservableCollection）（例如使用 Drag&Drop）。但现在我读[了这篇](http://www.codeproject.com/KB/WPF/TreeViewWithViewModel.aspx)文章，我不确定它是否真的会简化我的想法。在我继续这个项目之前，我想知道所有的优点和缺点。

如果添加、编辑或删除Data(ItemsSource)，如何保持Data和ViewModel一致？这是 ViewModel 必须处理的事情吗？如果我必须照顾一致性，这如何简化想法？

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2009-03-29T10:42:26.240

MVVM 通常非常适合 WPF 开发，而不仅仅是在`TreeView`s.

> 如果添加、编辑或删除Data(ItemsSource)，如何保持Data和ViewModel一致？

不确定您在这里问的是什么，但 WPF 绑定处理集合更改，只要这些集合实现`INotifyCollectionChanged`. `ObservableCollection<T>`为您提供了一个很好、有用的接口实现，您可以在视图模型中使用它。

绑定使视图与您的视图模型保持一致。通常，您的目标是在您看来零代码隐藏。您的视图只绑定到视图模型上的属性，并且视图模型有责任保持相关属性同步。这是一个非常简单的例子：

```
public class PersonViewModel : INotifyPropertyChanged
{
    public string FirstName
    {
        get { return _firstName; }
        set
        {
            if (_firstName != value)
            {
                _firstName = value;
                OnPropertyChanged("FirstName");
                OnPropertyChanged("FullName");
            }
        }
    }

    //LastName and other members omitted

    public string FullName
    {
        get { return FirstName + " " + LastName; }
    }
} 
```

此处`FullName`属性受 和 更改的`FirstName`影响`LastName`。视图可以绑定到`FullName`，对其他两个属性的任何更改都将在 UI 中可见。

我建议您在开始之前阅读我关于 POCO 与s 作为视图模型的[博客文章。](http://kentb.blogspot.com/2009/03/view-models-pocos-versus.html)`DependencyObject`

# java - 使用 Sheevaplug 作为基础服务器运行 tomcat 和 Mysql

> ID：694017
> 
> 赞同：2
> 
> 时间：2009-03-29T02:30:51.273
> 
> 标签：java, mysql, tomcat

下学期我可能会在大学里进行独立学习，学习 Java Web 编程，使用 Spring 和 Hibernate 等技术。我正在寻找可以放在宿舍角落里的东西，既不会大声喧哗，也不会消耗很多能量。这台机器需要能够运行流量非常低的 tomcat 和 Mysql 服务器，这样我的教授就可以看到我的工作，而无需运行他自己的 Java 应用程序服务器。我正在考虑购买[Sheevaplug](http://www.marvell.com/products/embedded_processors/developer/kirkwood/sheevaplug.jsp)并使用 8 或 16 gig sd 卡对其进行升级。我会在上面安装 Tomcat、Mysql 以及 Git 或 Subversion。对于基本上最多有两个用户使用它的服务器来说，这是一个可行的设置吗？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-04-06T23:55:59.523

我正在运行多个 grails 应用程序、eclipse、tomcat、mysql 和其他几个实用程序，这些实用程序运行在一个 5 岁的 windows 2k 机器上，其处理器速度、内存和磁盘空间比你链接到的插件少。在这篇文章之前我没有听说过插电式计算机，但根据规格，鉴于您的使用有限，这听起来可能是一种选择。虽然我不建议将它用于面向公众的应用程序。它可能适用于托管个人应用程序的家庭或宿舍服务器等有限环境。

如果你买了我想知道它是怎么回事。

现在我正在考虑买一个自己试试……;-)

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-05-13T13:37:57.143

这看起来是一个合理的工作工具。

您可能需要考虑来自 Debian ARM 邮件列表的关于类似设备上 JVM 速度的建议：

*   [http://www.nabble.com/Java-%2B-Tomcat-slow-on-TS-109-tt20003260.html#a20015796](http://www.nabble.com/Java-%2B-Tomcat-slow-on-TS-109-tt20003260.html#a20015796)

# ruby-on-rails - Activerecord：使用单个查询查找非关联和关联记录

> ID：694031
> 
> 赞同：2
> 
> 时间：2009-03-29T02:48:28.643
> 
> 标签：ruby-on-rails, ruby, activerecord

给定以下场景，使用 activerecord：

用户 belongs_to 事件

我想找到所有没有名为“party”的事件的用户。

所以我尝试了以下方法：

```
User.all(:joins => :event, :conditions => ["events.name != ?", "party"]) 
```

但是，这只会返回那些确实有事件的用户，而不是“聚会”事件。它不会返回所有没有事件的用户，因为 :joins 会自动将结果限制为仅关联记录。

我可以做两个查询并将结果加在一起，但是有没有办法在一个查询中获取非关联记录以及与条件匹配的关联记录？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2009-03-29T03:32:42.887

这个怎么样？

```
User.all(
  :include => :event, 
  :conditions => ["users.event_id IS NULL OR events.name != ?", "party"]) 
```

# vim - 作为图形 IDE 用户，我应该对传统编辑器感兴趣吗？

> ID：694032
> 
> 赞同：3
> 
> 时间：2009-03-29T02:50:58.637
> 
> 标签：vim, emacs, ide, eclipse-cdt

我使用成熟的图形 IDE，例如 Eclipse CDT (Linux) 和 Visual Studio (Windows)，它们具有自动完成、内置调试等功能。这些是我觉得我离不开的功能。

我不断听到每天有多少人使用 emacs/vim。当图形 IDE 似乎更易于使用时，人们为什么仍然使用基于控制台的编辑器？我知道如何使用 vim 和 emacs，但对于日常编程，我只使用 IDE，因为我发现自己更有效率。

这**不是**vim 与 emacs 的问题，所以请不要互相争论，而是请*图形 IDE*与*控制台 IDE*争论。

由于我**已经**熟悉图形 IDE，我是否可能通过使用 emacs/vim 来获得任何生产优势？

我希望答案是“也许不是”，仅仅是因为学习曲线~~，而且我会想念通常的图形 IDE 功能，例如自动完成和内置调试器~~；但显然 emacs 支持[自动完成和调试](https://stackoverflow.com/questions/694032/as-a-grapical-ide-user-should-i-be-interested-in-console-editors/718313#718313)。但是，对于使用标准 GUI 文本编辑器的人，我可能会说他们应该使用 emacs/vim。你怎么看？

### 相关问题：

*   [SciTE 用户想知道他们是否应该使用 emacs。](https://stackoverflow.com/questions/646438/are-there-any-reasons-why-a-c-developer-learn-emacs-vim)
*   [vi 用户想知道他们是否应该学习 emacs。](https://stackoverflow.com/questions/48006/is-it-worth-investing-time-in-learning-to-use-emacs)

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2009-03-29T03:02:10.247

对于没有完整 IDE 的情况，学习掌握命令行编辑器是有好处的。我认识一些对 VIM 发誓的人和对 Emacs 发誓的人。我认为后者更具可配置性，但您甚至可能不需要它。由于您已经了解 VI，因此它可能足以满足您的需求。

我谦虚地承认，在少数不需要通过 IDE 进行编辑的情况下，我只使用 pico ... :(

话虽如此，我确实有这样的印象，对于某些程序员亚文化和公司中的某些人来说，使用 emacs 而不是 IDE 是一个荣誉问题，就像在野营旅行中使用树叶而不是 TP 一样。

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2009-03-29T03:59:40.000

我总是建议至少了解一个纯命令行编辑器，无论是 Vi、emacs、pico、ed 等，即使您的大部分开发工作都是在 IDE 中完成的。如果您在 IDE 中比在其他编辑器中更有效率，那么请务必使用 IDE。

也就是说，我的推理是这样的：假设您正在 Linux 上安装图形驱动程序，而该驱动程序不是合作的。您的 X 版本无法使用新配置正确启动，您需要编辑您的 X 配置。您可以将工作配置的备份复制到已编辑的配置上，启动 X，使用 GUI 编辑器编辑 X 配置，然后重新启动 X，或者您可以使用不依赖于 X 的编辑器非常快速地进行编辑（通常是命令行）。

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2009-03-29T04:58:50.857

Eclipse 具有对 Emacs 键绑定的内置支持。我看到的对 Vim 的唯一支持是一个商业插件。

您当然不需要学习其中一个，也不需要争论一个编辑器与另一个编辑器的优点，但是如果您*确实*学习了 Emacs，您可以自定义您的 Eclipse 环境以使用 Emacs 键-绑定（它在 Windows->Preferences->General->Keys 下）。这（在我看来）可以*大大*提高您在 Eclipse 中的工作效率，因为您的双手很少需要离开键盘的“主”行。

这个特性是我在 90% 的开发中使用 Eclipse 的（众多）原因之一。

* * *

## 回答 #4

> 赞同：2
> 
> 时间：2009-04-05T03:56:11.007

我已经成为 emacs 用户将近 10 年了。Emacs 是一个支持 X 的 IDE，它不是基于控制台的。它确实具有自动完成功能，它确实具有集成调试器。我认为emacs优于其他IDE的优点是你说你在linux中使用eclipse，在windows上使用visual studio，我在两个操作系统上都使用emacs。切换操作系统时无需更换工具。同样在我的日常工作中，我使用多种语言 ruby​​、c/c++、java emacs 支持的语言比任何其他工具都多。一旦你熟练使用键盘，你的速度比使用 IDE 快 100 倍。您可以以极快的速度移动文件。我得到了我的终端，直接在编辑器中连接到我的数据库服务器，无需更改窗口并放松我的思路。

缺点是 emacs 和 vi 都有陡峭的学习曲线，以便正确使用它们，您需要在它们上投入一些时间，但我认为为什么不掌握一种适用于所有语言并适用于所有操作系统的工具。然后学习如何使用多种工具并在您想学习一门新语言时学习一种新工具。

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2009-03-29T03:03:16.907

在了解 vim 之后使用 emacs 会使该任务有些烦人。[编辑大战](http://en.wikipedia.org/wiki/Editor_war)时间久了，伤亡也不少。

简而言之，您应该简单地评估一下您是否认为您当前使用的编辑器不符合您的期望。如果您感到受阻，请尝试新事物。如果您工作得很好，请继续工作！

# freebase - 编写一个 Freebase MQL 查询来获取有关给定主题的所有信息？

> ID：694037
> 
> 赞同：2
> 
> 时间：2009-03-29T02:59:31.313
> 
> 标签：freebase, mql

我想编写一个查询来获取有关某个主题的所有已知信息（只需要一个级别的深度。

在使用[Freebase MQL 编辑器](http://www.freebase.com/tools/queryeditor)时，他们为“我们所知道的关于 Jimi Hendrix 的一切”提供了以下示例：

```
{
  "*" : null,
  "name" : "Jimi Hendrix",
  "type" : "/music/artist"
} 
```

问题是查询绑定到“/music/artist”类型，并且只获取与该类型相关的属性。如果您更改查询以使用不同的类型，您将获得完全不同的结果集。

```
{
  "*" : null,
  "name" : "Jimi Hendrix",
  "type" : "/people/person"
} 
```

我怎样才能编写一个查询来真正获取 Freebase 所知道的关于 Jimi Hendrix 的所有信息？

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2009-03-29T04:56:51.313

为此，您需要一种更高级的查询类型，它查看构成 Freebase 图的底层链接 (/type/link)。每个链接都有一个源、一个目标和一个分配给它的属性，可以像这样查询它们：

```
[
  {
    "master_property" : null,
    "source" : {
      "id" : "/en/jimi_hendrix"
    },
    "target" : null,
    "target_value" : null,
    "type" : "/type/link"
  }
] 
```

这些被称为传出链接，代表您通常在 Freebase UI 中看到的大部分值，但您也可以交换源和目标以获取传入链接链接列表：

```
[
  {
    "master_property" : null,
    "source" : null,
    "target" : {
      "id" : "/en/jimi_hendrix"
    },
    "type" : "/type/link"
  }
] 
```

这些链接包括将 Jimi Hendrix 视为其价值的其他主题的属性，并且这些值并未全部显示在 Freebase Jimi Hendrix 页面上，以将信息量保持在可管理的水平。

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2010-07-31T21:53:33.460

Freebase 主题 API 可能是您所追求的：

[http://www.freebase.com/experimental/topic/standard?id=/en/jimi_hendrix](http://www.freebase.com/experimental/topic/standard?id=/en/jimi_hendrix)

主题 API 将获取与图表中的主题直接相关的所有属性。API 包装了一系列 MQL 查询以获取 JSON 格式的所有数据和输出。

谷歌“ **Freebase 主题 HTTP API** ”以获取更多信息。

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2011-06-22T23:38:51.717

一段时间后，我们认为这是一个典型的用例，因此我们引入了一个全新的 API 来执行此操作：

[http://www.freebase.com/docs/topic_api](http://www.freebase.com/docs/topic_api)

这将为您提供上述查询中的所有属性，以及中介和其他好东西。

请注意，如果您想要 Freebase 中所有主题的所有属性，您应该使用[数据转储](http://wiki.freebase.com/wiki/Data_dumps)而不是运行时查询语言（它会快很多倍）。

# windows-vista - Vista 回收站最大尺寸

> ID：694040
> 
> 赞同：1
> 
> 时间：2009-03-29T03:01:46.643
> 
> 标签：windows-vista, vbscript, batch-file, cmd, recycle-bin

有谁知道如何通过脚本设置回收站的最大大小？无论是批处理还是vbs还是只是一个reg文件？最近几天我一直在探索这个想法，但无法得到答案。也许这里有人知道怎么做。我想将它添加到我的 Vista 清理脚本中 =)

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2010-05-28T13:22:38.773

每个驱动器的回收站的最大大小存储在此键下：

```
HKCU\Software\Microsoft\Windows\CurrentVersion\Explorer\BitBucket\Volume\ 
```

每个已安装卷的 GUID 都有一个子项。可以使用 MOUNTVOL 命令或以编程方式使用 GetVolumeNameForVolumeMountPoint() 找到此 GUID。

您可以只更改大小值，下次删除某些内容时它会被 Explorer 拾取（即您不需要通知外壳有关更改）。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-03-29T03:17:01.147

这不是代码*应该*能够做的事情，因此可能没有办法。似乎雷蒙德陈会写博客。

你为什么想这么做？

# iphone - 如果我希望我的班级有代表，我是否必须指定协议？

> ID：694044
> 
> 赞同：1
> 
> 时间：2009-03-29T03:02:47.000
> 
> 标签：iphone, objective-c

我是 Objective-C 和 Apple 平台上开发的新手，但希望我能以一种可以理解的方式提出这个问题：)

我想为我的 iPhone 应用程序解析 XML 提要，我决定不将所有委托方法从 NSXMLParser 实例推到我的视图控制器中，而是将其包装在 FeedParser 类中。在阅读了一些文档和示例代码之后，这就是我想出的：

```
@protocol FeedParserDelegate <NSObject>

- (void)parserDidLoadEpisodes:(NSArray *)episodes;

@end

@interface FeedParser : NSObject {
    id <FeedParserDelegate> delegate;
}

@property (nonatomic, assign) id <FeedParserDelegate> delegate;

- (id)initWithURL:(NSURL *)url delegate:(id<FeedParserDelegate>)theDelegate;

@end 
```

简单的。我的 FeedParser 对象的代表只需要实现`parserDidLoadEpisodes`.

然而，当我开始真正让我的`FeedParser`类使用`NSXMLParser`时，我意识到我不必指定它`FeedParser`实现协议`NSXMLParser`——我可以只实现我想做的委托方法。我想我在其他遵循委托模式的类中也注意到了这一点，但不是全部。

那么，我为什么不为我的`FeedParser`班级指定一个正式的协议而烦恼呢？它会删除一些可能不必要的代码。我想问题是：为什么我*要*创建一个正式的协议，而不是仅仅检查该方法是否在委托上实现 `respondsToSelector`？如果没有实现所需的委托方法，编译器是否会发出很好的警告？

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2009-03-29T03:37:17.247

用 声明的协议`@protocol`称为“正式协议”。另一种方法是在 NSObject 上声明一个类别（一组附加方法），如下所示：

```
@interface NSObject (FeedParserDelegate)

- (void)parserDidLoadEpisodes:(NSArray *)episodes;

@end 
```

然后只需为您想成为提要解析器委托的任何对象定义该方法，否则将其保留为未定义。这被称为“非正式协议”。

为什么有两种方式？好吧，这里有一个提示：非正式协议首先出现。归根结底是他们添加了正式的协议，因为非正式的协议并没有削减它。非正式的协议很容易忘记一个重要的方法，或者尝试使用一个对象作为它不适合使用的东西的委托。

基本上，对于到处添加的成本`<FeedParserDelegate>`，您可以让编译器为您进行调试。编译器将为最常见的委托错误生成警告，如果您犯了其中一个错误，这可以节省您的时间。为什么不利用它的帮助呢？

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2009-03-29T03:06:56.523

总是，总是，总是倾向于编译时错误检查而不是运行时。您当然可以询问该类是否支持该方法，但是为什么要问什么时候可以知道呢？

答案是否定的，你不必这样做。但你应该想要。:)

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2009-03-29T03:07:35.617

添加协议会使编译器为您检查。如果您在编译时没有收到那些不错的错误，那么您稍后会在运行时遇到它们，因为它们更难追踪。

# search - 无法在终端中搜索 pdf 文件的内容

> ID：694049
> 
> 赞同：1
> 
> 时间：2009-03-29T03:12:02.813
> 
> 标签：search, pdf

我有 pdf 文件，我没有设法通过任何终端程序搜索其内容。我只能通过 Acrobat Reader 和 Skim 搜索它们。

**如何在终端中搜索 pdf 文件的内容？**

似乎更好的问题是

**在 Acrobat Reader 和 Skim 等 pdf 查看器中如何进行搜索？**

或许，如果不存在这样的工具，我需要制作这样的搜索工具。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-03-29T04:31:51.763

尝试从[MacPorts安装](http://www.macports.org/)[xpdf](http://www.foolabs.com/xpdf/)；它应该带有一个名为[pdftotext](http://en.wikipedia.org/wiki/Pdftotext)的工具，然后应该允许您使用 grep 进行搜索。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2009-03-29T04:58:33.447

`pdftotext`确实是一个优秀的工具，但它会产生很长的线条；为了 grep 你会想要分解它们，例如，

```
pdftotext drscheme.pdf - | fmt | grep -i spidey 
```

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2009-03-29T04:29:52.063

PDF 文件通常被压缩。PDF 查看器（例如 Acrobat Reader 和 Skim）通过将 PDF 文本解压缩到内存中，然后搜索该文本来搜索内容。如果您想从命令行搜索，一种可能的建议是使用[pdftk](http://www.pdfhacks.com/pdftk/)解压缩 PDF，然后使用`grep`（或您喜欢的命令行文本搜索实用程序）查找所需的文本。例如：

```
# Search for the text "text_to_search_for", and print out 3 lines of context
# above and below each match
pdftk mydoc.pdf output - uncompress | grep -C3 text_to_search_for 
```

# java - 用于 spring 框架的 dimecasts.net 之类的截屏视频

> ID：694050
> 
> 赞同：0
> 
> 时间：2009-03-29T03:12:11.830
> 
> 标签：java, spring

有人知道这个网页 www.dimecasts.net 上的一系列 Spring 框架的截屏视频吗

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2009-10-11T18:25:03.537

试试[http://www.parleys.com/display/PARLEYS/Home](http://www.parleys.com/display/PARLEYS/Home)

# django - 如何保护我的网络游戏免受作弊者的侵害？

> ID：694057
> 
> 赞同：3
> 
> 时间：2009-03-29T03:25:59.113
> 
> 标签：django, security, debugging, reverse-engineering

我刚刚编写了我的第一个 Web 应用程序（Linux、Apache、MySQL、Django），并希望公开发布它。这是一个伪装成游戏的基于网络表单的任务；我打算最终将它放到[Amazon Mechanical Turk](https://www.mturk.com/mturk/welcome)上，并为达到一定分数的人提供小额奖金。

尽管这个应用程序没有非常高的安全风险，但我需要保护它免受操纵和逆向工程。但是，我几乎没有接受过测试/安全方面的正式培训。鉴于要赢得有形的奖品，我知道人们会有作弊的动机，无论是通过更改 POST 数据、按“返回”并重新提交数据直到他们获胜等等。到目前为止，我一直在处理这些当我想到可能的漏洞利用时，通过进行安全测试来临时解决问题。然而，我意识到可能有很多我还没有想到的操纵形式。

**谁能推荐一些阅读材料，我可以从中学习如何保护我的网站免受操纵和逆向工程？**

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-03-29T03:33:35.880

### [SQL 注入](http://en.wikipedia.org/wiki/SQL_injection)

防止恶意用户通过 URL 查询字符串更改 SQL 查询。

### [DoS 攻击](http://en.wikipedia.org/wiki/Denial-of-service_attack)

防止来自同一 IP 地址的用户在短时间内访问您的站点的次数过多。

### [密码强度](http://en.wikipedia.org/wiki/Password_strength)

当允许用户创建自己的密码时，显示一个密码强度指示器，鼓励用户输入更强的密码。

### [验证码](http://en.wikipedia.org/wiki/Captcha)

通过显示验证码图像阻止非人类用户提交表单。如果密码验证多次失败，您可能还想使用它，以防止机器人猜测密码。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2009-03-29T03:40:30.687

OWASP 是一个非常好的阅读场所；见[http://www.owasp.org/index.php/Main_Page](http://www.owasp.org/index.php/Main_Page)。他们有关于网站安全的大量文档。

编辑：如需快速概览，请查看“前十名”。

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2009-03-29T03:58:06.587

[Google 浏览器安全手册](http://code.google.com/p/browsersec/wiki/Main)包含大量有关 Web 架构中潜在漏洞的信息，特别是受 Web 浏览器行为影响的详细信息（与基于服务器的漏洞相反，例如 SQL 注入攻击等）。这是了解浏览器如何以影响安全的方式工作的一个很好的起点，例如它们如何处理 cookie、跨域请求、图像和 MIME 类型等。

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2009-03-29T03:47:23.803

我可能会推荐的一本书是罗斯·安德森（Ross Anderson）的《[安全工程](http://www.cl.cam.ac.uk/~rja14/book.html)》。它相当详细，并且很好地概述了与计算机安全相关的许多不同主题，尽管并非所有主题都与保护网站有关。

# matlab - 我想知道 MATLAB 是否是图灵完备的（计算通用）？

> ID：694058
> 
> 赞同：16
> 
> 时间：2009-03-29T03:26:03.340
> 
> 标签：matlab

我想知道 MATLAB 是否是[图灵完备](http://en.wikipedia.org/wiki/Turing_completeness)的（= 计算通用，即“如果它可以用来模拟任何单带图灵机”）？

* * *

## 回答 #1

> 赞同：41
> 
> 时间：2009-03-29T03:34:27.923

图灵完备对于现实世界的语言来说确实是一个相当低的标准。根据[维基百科](http://en.wikipedia.org/wiki/Turing_completeness)（强调我的）：

> 为了证明某事物是图灵完备的，足以表明它可以用来模拟一些图灵完备的系统。例如，如果命令式语言具有**条件** **分支**（例如，“if”和“goto”语句，或“branch if zero”指令。参见 OISC）和**更改任意内存** **位置**的能力（例如，保持任意数量的变量的能力）。由于几乎总是如此，如果我们忽略有限内存的任何限制，大多数命令式语言（如果不是全部的话）都是图灵完备的。

除此之外，MATLAB 具有许多您期望从相对现代的[3GL](http://en.wikipedia.org/wiki/Third-generation_programming_language) / [4GL](http://en.wikipedia.org/wiki/Fourth-generation_programming_language)中获得的功能。它包含 VM、I/O、用户界面结构、数学运算符（显然）、数据类型、用户定义函数等。您甚至可以在 Matlab 环境之外交付 Matlab 程序。

请注意，它是否是一门**好的**语言是一个完全不同的问题。

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2009-03-29T03:32:44.870

是的，一种[高级编程语言](http://en.wikipedia.org/wiki/High-level_programming_language)。

* * *

## 回答 #3

> 赞同：3
> 
> 时间：2009-03-29T03:50:12.143

我假设您区分编程语言和脚本语言，并且由于 MATLAB 的性质，它看起来像一种脚本语言？如果是这种情况，您的意见可能取决于您对编程语言的看法。

我相信 MATLAB 是图灵完备的，并且具有相当严格且可用的语法，因此我将其称为编程语言。同时，虽然 csh 可能是图灵完备的，但它的编程非常奇怪，我将其称为脚本语言。

# jquery - 无法让 jQuery 调整大小以工作：我做错了什么？

> ID：694059
> 
> 赞同：15
> 
> 时间：2009-03-29T03:26:22.233
> 
> 标签：jquery, resize

这是我尝试测试 jQuery resizable 是否正常工作的简单代码。我使用 google.load 很好地使用了其他 jQuery 组件，并且我尝试将 google.load 换成本地版本，没有任何区别。我已经在 3 个浏览器中进行了测试，我已经从几个演示/教程站点复制了代码（可以在他们的站点上找到它的工作原理）。

```
<!DOCTYPE html>
<html>
<head>
<script type="text/javascript" src="http://www.google.com/jsapi?key=blahblah_obviously changed_blahblah-blahblah_blah_blahblahblah"></script>
<script type="text/javascript">google.load("jquery", "1.3.2");google.load("jqueryui", "1.7.1");</script>
<style type="text/css">
   #resizable { width: 100px; height: 100px; background: silver; }
</style>
<script type="text/javascript">
  $(document).ready(function(){
  $("#resizable").resizable();
});
</script>
</head>
<body>  
 <div id="resizable"></div>
</body>
</html> 
```

我没有收到任何错误消息。我无计可施。我究竟做错了什么？为什么连这个简单的案例都不起作用？

更新：jQuery UI 库包含在 google.load("jqueryui", "1.7.1"); 行中

* * *

## 回答 #1

> 赞同：46
> 
> 时间：2009-03-29T04:34:13.973

jQuery UI 在您的示例中运行良好，您遇到的问题是因为您的[最后一个测试](http://www.bcsfanpoll.com/test/test.php)中没有包含任何 CSS 主题，并且未显示“可调整大小的句柄”图标。

添加您[自己的主题](http://jqueryui.com/themeroller/)或默认主题：

```
<link rel="stylesheet" type="text/css" 
href="http://ajax.googleapis.com/ajax/libs/jqueryui/1.7.1/themes/base/jquery-ui.css"/> 
```

[在此处](http://jsbin.com/emudi)查看您的示例。

* * *

## 回答 #2

> 赞同：11
> 
> 时间：2011-04-27T12:22:37.063

让 jquery ui .resizable() 工作所需的所有 CSS：（不要忘记将图像保存到本地）

```
<style type="text/css">
.ui-icon { width: 16px; height: 16px; background-image: url(http://ajax.googleapis.com/ajax/libs/jqueryui/1.7.1/themes/base/images/ui-icons_222222_256x240.png)/*{iconsContent}*/; }
.ui-resizable { position: relative;}
.ui-resizable-handle { position: absolute;font-size: 0.1px;z-index: 99999; display: block;}
.ui-resizable-disabled .ui-resizable-handle, .ui-resizable-autohide .ui-resizable-handle { display: none; }
.ui-resizable-n { cursor: n-resize; height: 7px; width: 100%; top: -5px; left: 0px; }
.ui-resizable-s { cursor: s-resize; height: 7px; width: 100%; bottom: -5px; left: 0px; }
.ui-resizable-e { cursor: e-resize; width: 7px; right: -5px; top: 0px; height: 100%; }
.ui-resizable-w { cursor: w-resize; width: 7px; left: -5px; top: 0px; height: 100%; }
.ui-resizable-se { cursor: se-resize; width: 12px; height: 12px; right: 1px; bottom: 1px; }
.ui-resizable-sw { cursor: sw-resize; width: 9px; height: 9px; left: -5px; bottom: -5px; }
.ui-resizable-nw { cursor: nw-resize; width: 9px; height: 9px; left: -5px; top: -5px; }
.ui-resizable-ne { cursor: ne-resize; width: 9px; height: 9px; right: -5px; top: -5px;}
.ui-icon-gripsmall-diagonal-se { background-position: -64px -224px; }
</style> 
```

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2009-03-29T03:36:59.743

你有没有尝试过：

```
<script type="text/javascript">
google.setOnLoadCallback(function() {
  $(function() {
    $("#resizable").resizable();
  });
});
</script> 
```

值得注意的是 google.load() 是一个异步调用，您将无法调用 jQuery 函数，直到它们被加载，因此回调。

好的，看看您的示例，您遇到了一些问题：

1.  这是最大的：你没有 jQuery UI 样式表；
2.  你是双重的，包括来自谷歌和本地的 jQuery、jQuery UI 和 SWFObject；
3.  可调整大小的 div 中的最后一个 div 阻止调整大小。不知道为什么，但我评论了它，它工作正常；和
4.  Google 的 AJAX 库 API 不需要 API 密钥。这不会引起问题。仅供参考。

你的工作版本：

```
<html>
<head>
<meta http-equiv="content-type" content="text/html; charset=UTF-8">
<link rel="stylesheet" type="text/css" href="http://ajax.googleapis.com/ajax/libs/jqueryui/1.7.1/themes/blitzer/jquery-ui.css">
<script type="text/javascript" src="http://www.google.com/jsapi"></script>
<script type="text/javascript">
google.load("jquery", "1.3.2");
google.load("jqueryui", "1.7.1");
google.load("swfobject", "2.1");
google.setOnLoadCallback(function() {
  $(function() {
    $("#resizable").resizable();
  });
});
</script>
<style type="text/css">
  #resizable { width: 100px; height: 100px; background: silver; }
</style>
</head>
<body>
<div id="resizable">
  <div style="-moz-user-select: none;" unselectable="on" class="ui-resizable-handle ui-resizable-e"></div>
  <div style="-moz-user-select: none;" unselectable="on" class="ui-resizable-handle ui-resizable-s"></div>
  <!--<div unselectable="on" style="z-index: 1001; -moz-user-select: none;" class="ui-resizable-handle ui-resizable-se ui-icon ui-icon-gripsmall-diagonal-se"></div>-->
</div>
</body>
</html> 
```

# vb.net - VB .NET 中的类型转换

> ID：694063
> 
> 赞同：1
> 
> 时间：2009-03-29T03:33:16.413
> 
> 标签：vb.net, casting

我正在向现有的 VB .Net 应用程序添加一项功能，该功能涉及从 .Net Web 服务中检索数据。Web 服务返回一个位置数组。位置非常简单，它有 3 个属性——一个整数和两个字符串。

因此，我的应用程序的其余部分不必依赖此 Web 服务，我想在我的应用程序中创建自己的 Location 类型。我的想法是我可以调用一个方法来返回我的 Location 类型的通用列表，该列表在内部调用 Web 服务并填充我返回的列表。这样，如果以后 Locations 的数据源更改为 Web 服务以外的其他内容，我只需修复方法而不是修复所有调用者。

所以我创建了自己的位置，它与服务位置具有相同的属性。但我似乎无法将服务位置数组转换为我的位置的通用列表。我还尝试将单个服务位置投射到我的一个位置中，但这也不起作用。

那么是铸造一个选项还是我必须遍历每个服务位置并将每个属性分配给我的一个新位置？还是有完全不同的方法来解决这个问题？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-03-29T03:41:43.333

铸造将不起作用，因为它们不是同一类型。即使两种类型看起来完全相同，也不能从一种类型转换到另一种类型，除非定义了一个 CType 运算符，该运算符描述了如何将对象从一种类型转换为另一种类型的对象。即使那样，您也不能直接将 List(of Type1) 转换为 List(Of Type2)。

您将不得不循环并创建您的类的新对象。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2009-03-29T14:07:13.753

默认情况下，您将无法将一个位置投射到另一个位置。它们是完全不相关的类型，因此不能成为强制转换的主题。您可以通过为 CType 的应用程序版本定义自定义运算符来进行转换。

```
' Location for application
Public Class Location
  ...
  Public Shared Operator Widening CType(p1 as Namespace.Of.WebService.Location) As Location
    Dim loc = ConvertWebServiceLocationToApplicationLocation
    return loc
  End Operator
End Class 
```

这允许您现在在 WebService 位置和应用程序位置之间执行 CType 操作。

但是，铸造阵列根本不可能。无法为数组定义转换运算符，因此它们不能使用上述技巧。但是您可以为此目的编写一个快速而肮脏的函数

```
Public Shared Function ConvertArray(ByVal arr As Namespace.Of.WebServiec.Location()) As Location()
  Dim newArray(arr.Length) As Location
  For i as Integer = 0 To arr.Length - 1
    newArray(i) = CType(arr(i), Location)
  Next
  return newArray
End Function 
```

# c++ - 如何在 Linux 上的 C++ 中读取 JPEG 和 PNG 像素？

> ID：694080
> 
> 赞同：22
> 
> 时间：2009-03-29T03:55:06.767
> 
> 标签：c++, c, linux, png, jpeg

我正在做一些图像处理，我想单独读取 JPEG 和 PNG 图像中的每个像素值。

在我的部署方案中，使用 3rd 方库对我来说会很尴尬（因为我在目标计算机上的访问受到限制），但我假设没有标准的 C 或 C++ 库来读取 JPEG/PNG...

因此，如果您知道一种*不*使用库的方法，那就太好了，如果没有，那么仍然欢迎您回答！

* * *

## 回答 #1

> 赞同：23
> 
> 时间：2009-03-29T04:02:39.633

C 标准中没有标准库来读取文件格式。

但是，大多数程序，尤其是在 linux 平台上的程序都使用相同的库来解码图像格式：

对于 jpeg，它是 libjpeg，对于 png，它是 libpng。

库已经安装的机会*非常*高。

[http://www.libpng.org](http://www.libpng.org)

[http://www.ijg.org](http://www.ijg.org)

* * *

## 回答 #2

> 赞同：21
> 
> 时间：2009-03-29T04:16:49.537

这是我从 10 年前的源代码中挖掘的一个小例程（使用 libjpeg）：

```
#include <jpeglib.h>

int loadJpg(const char* Name) {
  unsigned char a, r, g, b;
  int width, height;
  struct jpeg_decompress_struct cinfo;
  struct jpeg_error_mgr jerr;

  FILE * infile;        /* source file */
  JSAMPARRAY pJpegBuffer;       /* Output row buffer */
  int row_stride;       /* physical row width in output buffer */
  if ((infile = fopen(Name, "rb")) == NULL) {
    fprintf(stderr, "can't open %s\n", Name);
    return 0;
  }
  cinfo.err = jpeg_std_error(&jerr);
  jpeg_create_decompress(&cinfo);
  jpeg_stdio_src(&cinfo, infile);
  (void) jpeg_read_header(&cinfo, TRUE);
  (void) jpeg_start_decompress(&cinfo);
  width = cinfo.output_width;
  height = cinfo.output_height;

  unsigned char * pDummy = new unsigned char [width*height*4];
  unsigned char * pTest = pDummy;
  if (!pDummy) {
    printf("NO MEM FOR JPEG CONVERT!\n");
    return 0;
  }
  row_stride = width * cinfo.output_components;
  pJpegBuffer = (*cinfo.mem->alloc_sarray)
    ((j_common_ptr) &cinfo, JPOOL_IMAGE, row_stride, 1);

  while (cinfo.output_scanline < cinfo.output_height) {
    (void) jpeg_read_scanlines(&cinfo, pJpegBuffer, 1);
    for (int x = 0; x < width; x++) {
      a = 0; // alpha value is not supported on jpg
      r = pJpegBuffer[0][cinfo.output_components * x];
      if (cinfo.output_components > 2) {
        g = pJpegBuffer[0][cinfo.output_components * x + 1];
        b = pJpegBuffer[0][cinfo.output_components * x + 2];
      } else {
        g = r;
        b = r;
      }
      *(pDummy++) = b;
      *(pDummy++) = g;
      *(pDummy++) = r;
      *(pDummy++) = a;
    }
  }
  fclose(infile);
  (void) jpeg_finish_decompress(&cinfo);
  jpeg_destroy_decompress(&cinfo);

  BMap = (int*)pTest; 
  Height = height;
  Width = width;
  Depth = 32;
} 
```

* * *

## 回答 #3

> 赞同：7
> 
> 时间：2009-03-29T04:03:02.003

对于 jpeg，已经有一个名为[libjpeg](http://en.wikipedia.org/wiki/Libjpeg)的库，并且对于 png 有[libpng](http://www.libpng.org/pub/png/libpng.html)。好消息是它们可以直接编译，因此目标机器不需要 dll 文件或任何东西。坏消息是它们在 C 中:(

此外，甚至不要考虑自己[尝试读取](http://en.wikipedia.org/wiki/Jpeg#Discrete_cosine_transform) [文件](http://en.wikipedia.org/wiki/DEFLATE#Encoder_.2F_Compressor)。如果您想要一种易于阅读的格式，请改用[PPM](http://en.wikipedia.org/wiki/Portable_pixmap)。

* * *

## 回答 #4

> 赞同：4
> 
> 时间：2009-03-29T04:04:35.307

不幸的是，jpeg 格式是压缩的，因此您必须在读取单个像素之前对其进行解压缩。这是一项不平凡的任务。如果您不能使用某个库，您可能需要参考一个库来了解它是如何解压缩图像的。sourceforge 上有一个开源库：[CImg on sourceforge。](http://cimg.sourceforge.net/reference/group__cimg__tutorial.html)

* * *

## 回答 #5

> 赞同：2
> 
> 时间：2009-03-29T07:02:16.300

由于它可以使用曝光，我将提到另一个库来调查：[IM Toolkit](http://www.tecgraf.puc-rio.br/im)，托管在[Sourceforge 上](http://sourceforge.net/projects/imtoolkit/)。它是跨平台的，将文件格式完全从用户那里抽象出来，允许加载和处理图像而无需担心大部分细节。它确实支持开箱即用的 PNG 和 JPEG，并且可以根据需要使用其他导入过滤器进行扩展。

它还带有大量图像处理运算符...

它还具有与[Lua](http://www.lua.org/)的高质量绑定。

* * *

## 回答 #6

> 赞同：2
> 
> 时间：2010-01-22T13:33:39.410

正如 Nils 指出的那样，没有用于 JPEG 压缩和图像处理的 C 或 C++ 标准库之类的东西。

如果您能够使用第三方库，您可能想尝试支持 JPEG、PNG 和数十种其他格式、压缩和媒体的[GDAL 。](http://www.gdal.org)

这是一个简单的示例，展示了如何使用 GDAL C++ API 从 JPEG 文件中读取像素数据：

```
#include <gdal_priv.h>
#include <cassert>
#include <iostream>
#include <string>
#include <vector>

int main()
{
    GDALAllRegister(); // once per application

    // Assume 3-band image with 8-bit per pixel per channel (24-bit depth)
    std::string const file("/home/mloskot/test.jpg");

    // Open file with image data
    GDALDataset* ds = static_cast<GDALDataset*>(GDALOpen(file.c_str(), GA_ReadOnly));
    assert(0 != ds);

    // Example 1 - Read multiple bands at once, assume 8-bit depth per band
    {
        int const ncols = ds->GetRasterXSize();
        int const nrows = ds->GetRasterYSize();
        int const nbands = ds->GetRasterCount();
        int const nbpp = GDALGetDataTypeSize(GDT_Byte) / 8;
        std::vector<unsigned char> data(ncols * nrows * nbands * nbpp);

        CPLErr err = ds->RasterIO(GF_Read, 0, 0, ncols, nrows, &data[0], ncols, nrows, GDT_Byte, nbands, 0, 0, 0, 0);
        assert(CE_None == err);

        // ... use data
    }

    // Example 2 - Read first scanline by scanline of 1 band only, assume 8-bit depth per band
    {
        GDALRasterBand* band1 = ds->GetRasterBand(1);
        assert(0 != band1);

        int const ncols = band1->GetXSize();
        int const nrows = band1->GetYSize();
        int const nbpp = GDALGetDataTypeSize(GDT_Byte) / 8;
        std::vector<unsigned char> scanline(ncols * nbpp);

        for (int i = 0; i < nrows; ++i)
        {
            CPLErr err = band1->RasterIO(GF_Read, 0, 0, ncols, 1, &scanline[0], ncols, 1, GDT_Byte, 0, 0);
            assert(CE_None == err);

            // ... use scanline
        }
    }

    return 0;
} 
```

有更完整的[GDAL API 教程](http://www.gdal.org/gdal_tutorial.html)可用。

* * *

## 回答 #7

> 赞同：1
> 
> 时间：2009-03-29T04:17:34.170

我对[DevIL](http://openil.sourceforge.net/)库有很好的体验。它支持多种图像格式，并遵循与 OpenGL 非常相似的函数风格。

诚然，它是一个图书馆，但绝对值得一试。

* * *

## 回答 #8

> 赞同：1
> 
> 时间：2009-03-29T07:05:39.880

由于其他答案已经提到您很可能需要使用库，因此请查看[ImageMagick](http://www.imagemagick.org/script/index.php)并查看是否可以执行您需要的操作。它提供了多种与 ImageMagick 核心功能交互的不同方式，包括适用于几乎所有可用编程语言的库。

主页：[ImageMagick](http://www.imagemagick.org/script/index.php)

* * *

## 回答 #9

> 赞同：1
> 
> 时间：2010-11-29T18:52:06.627

**如果速度不是问题**，您可以尝试[LodePNG](http://members.gamedev.net/lode/projects/LodePNG/)，它采用非常简约的方法来加载和保存 PNG。

或者甚至使用来自同一作者的 picoPNG，它是一个函数中的自包含 png 加载器。

# php - 在 PHP 中使用短信网关 API

> ID：694091
> 
> 赞同：0
> 
> 时间：2009-03-29T04:15:32.693
> 
> 标签：php, sms

我无法使用以下代码发送短信，但我可以使用相同的 url 发送短信，同时我将 url($murl) 粘贴到浏览器地址栏中

连接超时，执行时间过长，但没有结果

问题是什么？

```
$amount="500";
$d="23-03-09";

$mNumber="98689988898";
$mName="TEST";
$mMessage ="\"We have debited Rs.$amount. Your account on $d.  Thank you for your valuable support.";
$u1 = 'http://bulksms.mysmsmantra.com:8080/WebSMS/SMSAPI.jsp?';
$u2= 'username='.urlencode('some').'&password='. urlencode('some').'&sendername='.urlencode('some') .'&mobileno='
. urlencode($mNumber).'&message='.urlencode($mMessage).'&submit=Submit';

$murl=$u1.$u2;

$ch = curl_init();
curl_setopt($ch, CURLOPT_URL, $murl);
//curl_setopt($ch, CURLOPT_HEADER, 1); 
//curl_setopt($ch, CURLOPT_RETURNTRANSFER,1);
/*curl_setopt($ch, CURLOPT_POST, 1);
curl_setopt($ch, CURLOPT_POSTFIELDS, $u2);
*/$response = curl_exec($ch);
print "Respons : $response";
curl_close($ch); 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2010-08-31T02:42:06.293

mysmsmantra 现在可作为 drupal 模块使用，您可以将其与触发器和操作一起使用，该模块可以在[http://drupal.org/project/sms_mysmsmantra找到](http://drupal.org/project/sms_mysmsmantra)

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-03-29T20:55:27.657

[`file_get_contents`](http://php.net/manual/en/function.file-get-contents.php)如果您不需要服务器端标头答案，也可以使用 $response = ($murl) 省略 curl 。还要检查[`http_build_query`](http://php.net/manual/en/function.http-build-query.php)()。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-03-29T05:47:00.867

将您的代码更改为此。应该管用：

从

```
$ch = curl_init();
curl_setopt($ch, CURLOPT_URL, $murl); 
```

至

```
$ch = curl_init($murl); 
```

您也可以在 curl_init 函数中设置 URL。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2009-11-22T21:48:48.990

也许您需要设置一个用户代理。您正在使用的服务可能会阻止默认用户代理：

```
curl_setopt($ch, CURLOPT_USERAGENT, 'SMS Gateway Agent/1.0'); // Pick something creative, or use a browser UA 
```

希望这可以帮助！

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2011-04-19T00:57:24.760

查看症状，我认为这是防火墙/访问的问题。您是否尝试过仅从同一站点获取页面的脚本，只是为了查看没有防火墙/代理设置阻止访问。您可以使用命令行 Web 浏览器（例如 lynx）从您正在运行脚本的服务器访问该站点，以检查服务器是否允许发出请求。

如果您足够游戏，请运行一些数据包嗅探器以查看是否有任何请求数据包从服务器发出。

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2017-05-04T05:03:50.657

```
<?php
if(isset($_POST['submit'])){
 $message=  rawurlencode($_POST['message']);
$phone=$_POST['phone'];
$url='http://sms.yourdomain.com/httpapi/smsapi?uname=xxxx&password=******&sender=XXXXX&receiver='.$phone.'&route=TA&msgtype=1&sms='.$message;
$ch = curl_init();
$header = array("Content-Type:application/json", "Accept:application/json");
curl_setopt($ch, CURLOPT_URL, $url);
curl_setopt($ch, CURLOPT_HTTPHEADER, $header);
curl_setopt($ch, CURLOPT_HTTPAUTH, CURLAUTH_BASIC);
curl_setopt($ch, CURLOPT_CONNECTTIMEOUT, 2);
curl_setopt($ch, CURLOPT_RETURNTRANSFER, 1);
curl_setopt($ch, CURLOPT_FOLLOWLOCATION, TRUE);
curl_setopt($ch, CURLOPT_MAXREDIRS, 2);
curl_setopt($ch, CURLOPT_POST, 1);

// response of the POST request
$response = curl_exec($ch);
$httpCode = curl_getinfo($ch, CURLINFO_HTTP_CODE);
$responseBody = json_decode($response);
curl_close($ch);
}
?>
<form action="sms.php" method="post">
Phone: <input type="text" name="phone"><br>
Message: <input type="text" name="message"><br>
<input type="submit" name="submit" value="sent">
</form> 
```

# sql - 使用模型延迟加载/缓存 SQL 查询结果

> ID：694094
> 
> 赞同：2
> 
> 时间：2009-03-29T04:17:42.360
> 
> 标签：sql, ruby-on-rails, ruby, caching

我正在开发一个具有相当大的报告组件的系统（使用 Rails 2.3.2、Ruby 1.8.7-p72）。为了提高性能，我创建了一个报告模型来存档旧报告。这个想法是，如果已经存在针对任意一组条件的匹配报告，则使用它，否则生成报告并保存结果。

此外，我想以这样一种方式设计报表模型，即只有请求的属性才会运行相应的 SQL 查询。这一切都源于这样一个事实，即每个属性都需要很长时间来计算，我宁愿不生成不会使用的结果。即我想做类似的事情：

```
定义富
  @foo ||= read_attribute(:foo)
  如果@foo.nil？
    @foo = write_attribute(:foo, (昂贵的 SQL 查询结果))
  结尾
  @foo
结尾

```

但是，我遇到的问题是结果没有正确写入我的数据库，因此代码不断地重新评估 SQL 查询。

谁能告诉我为什么

```
write_attribute
```

不工作？此外，有没有更好的方法？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-04-05T02:53:28.053

事实证明我所做的很好。真正的问题是对象的“id”查找被我在别处的一段代码所取代。即，实际写入发生在数据库中，但主键错误。

* * *

## 回答 #2

> 赞同：-1
> 
> 时间：2009-03-29T08:33:07.533

做write_attribute后不需要调用“save”吗？

# gdi+ - GDI+ 调整像素缩放的大小

> ID：694095
> 
> 赞同：2
> 
> 时间：2009-03-29T04:20:53.957
> 
> 标签：gdi+, resize, pixel

我想使用 GDI 库调整图像的大小，这样当我将其调整为比以前更大时，就不会出现混合。（就像在绘画程序中放大图像时一样）

EG：如果我的图像是 2px 宽和 2px 高
（白色、白色、
白色、黑色）
，并且我将其调整为 100% 大，则它是 4px x 4px 高
（白色、白色、白色、白色、
白色、白色） , 白色, 白色,
白色, 白色, 黑色, 黑色,
白色, 白色, 黑色, 黑色)

我可以使用图形对象的哪些 InterpolationMode 或 Smoothing 模式（或其他属性）来实现这一点？到目前为止我尝试过的组合都会导致灰色出现在测试图像中。

这是我正在使用的代码

```
 /// <summary>
    /// Do the resize using GDI+
    /// Credit to the original author
    /// http://www.bryanrobson.net/dnn/Code/Imageresizing/tabid/69/Default.aspx
    /// </summary>
    /// <param name="srcBitmap">The source bitmap to be resized</param>
    /// <param name="width">The target width</param>
    /// <param name="height">The target height</param>
    /// <param name="isHighQuality">Shoule the resize be done at high quality?</param>
    /// <returns>The resized Bitmap</returns>

    public static Bitmap Resize(Bitmap srcBitmap, int width, int height, bool isHighQuality)
    {
        // Create the destination Bitmap, and set its resolution
        Bitmap destBitmap = new Bitmap((int)Convert.ToInt32(width), (int)Convert.ToInt32(height), PixelFormat.Format24bppRgb);
        destBitmap.SetResolution(srcBitmap.HorizontalResolution, srcBitmap.VerticalResolution);

        // Create a Graphics object from the destination Bitmap, and set the quality
        Graphics grPhoto = Graphics.FromImage(destBitmap);
        if (isHighQuality)
        {
            grPhoto.SmoothingMode = System.Drawing.Drawing2D.SmoothingMode.HighQuality;
            grPhoto.InterpolationMode = InterpolationMode.HighQualityBicubic;
        }
        else
        {
            grPhoto.SmoothingMode = System.Drawing.Drawing2D.SmoothingMode.None; //? this doesn't work
            grPhoto.InterpolationMode = InterpolationMode.NearestNeighbor; //? this doesn't work

        }
        // Do the resize
        grPhoto.DrawImage(srcBitmap,
              new Rectangle(0, 0, width, height),
              new Rectangle(0, 0, srcBitmap.Width, srcBitmap.Height),
              GraphicsUnit.Pixel);

        grPhoto.Dispose();
        return destBitmap;
    } 
```

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2009-05-19T21:54:57.390

通过使用 InterpolationMode.NearestNeighbor，您走在了正确的轨道上。但是，使用默认的 PixelOffsetMode，GDI+ 将尝试在像素边缘进行采样，从而导致混合。

要在不进行混合的情况下进行缩放，还需要使用 PixelOffsetMode.Half。将您的非高质量案例更改为：

```
else
{
    grPhoto.SmoothingMode = System.Drawing.Drawing2D.SmoothingMode.None;
    grPhoto.PixelOffsetMode = System.Drawing.Drawing2D.PixelOffsetMode.Half;
} 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-03-29T04:38:03.980

当您绘制图像并传入源矩形时，仅传入原始图像的放大部分并将其绘制到更大的区域。当用户放大时，在某些时候他们将无法在查看区域中看到整个图像。因此，找出哪个源区域仍应在视图中并仅绘制该区域。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-03-30T01:06:09.190

看起来你并没有对我做错什么。请参阅 Microsoft 关于 InterpolationMode 的说明：

[http://msdn.microsoft.com/en-us/library/ms533836(VS.85).aspx](http://msdn.microsoft.com/en-us/library/ms533836(VS.85).aspx)

也许这个函数工作得很好，但是你给它错误的参数或错误地显示结果？

# javascript - 在 JavaScript 中声明多个变量

> ID：694102
> 
> 赞同：379
> 
> 时间：2009-03-29T04:37:25.027
> 
> 标签：javascript, variables, coding-style, performance, declaration

在 JavaScript 中，可以像这样声明多个变量：

```
var variable1 = "Hello, World!";
var variable2 = "Testing...";
var variable3 = 42; 
```

...或者像这样：

```
var variable1 = "Hello, World!",
    variable2 = "Testing...",
    variable3 = 42; 
```

一种方法比另一种更好/更快吗？

* * *

## 回答 #1

> 赞同：384
> 
> 时间：2009-03-29T05:40:36.153

第一种方式更容易维护。每个声明都是一行中的单个语句，因此您可以轻松地添加、删除和重新排序声明。

使用第二种方式，删除第一个或最后一个声明很烦人，因为它们`var`分别从关键字开始并以分号结束。每次添加新声明时，都必须将最后一个旧行中的分号替换为逗号。

* * *

## 回答 #2

> 赞同：227
> 
> 时间：2011-09-12T07:23:18.200

除了可维护性之外，第一种方法消除了意外创建全局变量的可能性：

```
(function () {
var variable1 = "Hello, World!" // Semicolon is missed out accidentally
var variable2 = "Testing..."; // Still a local variable
var variable3 = 42;
}()); 
```

虽然第二种方式不那么宽容：

```
(function () {
var variable1 = "Hello, World!" // Comma is missed out accidentally
    variable2 = "Testing...", // Becomes a global variable
    variable3 = 42; // A global variable as well
}()); 
```

* * *

## 回答 #3

> 赞同：39
> 
> 时间：2012-06-03T20:21:41.437

这样做时它更具可读性：

```
var hey = 23;
var hi = 3;
var howdy 4; 
```

但是这样占用更少的空间和代码行：

```
var hey=23,hi=3,howdy=4; 
```

它可以是节省空间的理想选择，但让 JavaScript 压缩器为您处理它。

* * *

## 回答 #4

> 赞同：33
> 
> 时间：2009-11-20T23:23:37.583

每个组织范围使用[一个`var`语句](https://web.archive.org/web/20150317095847/http://www.jslint.com/lint.html#scope)是很常见的。所有“范围”的方式都遵循类似的模式，使代码更具可读性。此外，无论如何，发动机都会将它们全部“提升”到顶部。因此，将您的声明放在一起可以更紧密地模仿实际发生的事情。

* * *

## 回答 #5

> 赞同：29
> 
> 时间：2016-07-21T14:36:52.703

[ECMAScript 2015](https://en.wikipedia.org/wiki/ECMAScript#6th_Edition_%E2%80%93_ECMAScript_2015)引入了非常好的[解构赋值：](https://developer.mozilla.org/en-US/docs/Web/JavaScript/Reference/Operators/Destructuring_assignment)

```
[a, b] = [1, 2] 
```

`a`将等于`1`将`b`等于`2`。

* * *

## 回答 #6

> 赞同：18
> 
> 时间：2009-03-29T04:39:36.067

这只是个人喜好问题。这两种方式之间没有区别，除了如果去掉空格，第二种形式会保存几个字节。

* * *

## 回答 #7

> 赞同：16
> 
> 时间：2011-12-19T14:00:43.207

也许像这样

```
var variable1 = "Hello, World!"
, variable2 = 2
, variable3 = "How are you doing?"
, variable4 = 42; 
```

除了更改第一个或最后一个变量时，它易于维护和读取。

* * *

## 回答 #8

> 赞同：13
> 
> 时间：2017-05-25T07:43:30.607

使用**ES6** [**解构赋值**](https://developer.mozilla.org/en-US/docs/Web/JavaScript/Reference/Operators/Destructuring_assignment)：它将数组中的值或对象中的属性解包到不同的变量中。

```
let [variable1 , variable2, variable3] =
["Hello, World!", "Testing...", 42];

console.log(variable1); // Hello, World!
console.log(variable2); // Testing...
console.log(variable3); // 42
```

* * *

## 回答 #9

> 赞同：12
> 
> 时间：2009-03-29T04:43:57.693

```
var variable1 = "Hello, World!";
var variable2 = "Testing...";
var variable3 = 42; 
```

比以下更具可读性：

```
var variable1 = "Hello, World!",
    variable2 = "Testing...",
    variable3 = 42; 
```

但他们做同样的事情。

* * *

## 回答 #10

> 赞同：7
> 
> 时间：2013-02-08T04:52:28.460

我唯一但必不可少的用于逗号的是在*for*循环中：

```
for (var i = 0, n = a.length; i < n; i++) {
  var e = a[i];
  console.log(e);
} 
```

我去这里看看这在 JavaScript 中是否可行。

即使看到它工作，一个问题仍然`n`是该功能是否是本地的。

这验证`n`是本地的：

```
a = [3, 5, 7, 11];
(function l () { for (var i = 0, n = a.length; i < n; i++) {
  var e = a[i];
  console.log(e);
}}) ();
console.log(typeof n == "undefined" ?
  "as expected, n was local" : "oops, n was global"); 
```

一时间我不确定，在语言之间切换。

* * *

## 回答 #11

> 赞同：7
> 
> 时间：2014-09-08T17:37:57.473

尽管两者都是有效的，但使用第二个会阻止没有经验的开发人员将 var 语句放在所有地方并导致提升问题。如果每个函数只有一个 var，在函数的顶部，那么更容易调试整个代码。这可能意味着声明变量的行并不像某些人所希望的那样明确。

我觉得权衡是值得的，如果这意味着让开发人员放弃在他们喜欢的任何地方删除“var”。

人们可能会抱怨[JSLint](https://en.wikipedia.org/wiki/JSLint)，我也一样，但其中很多不是为了解决语言问题，而是为了纠正编码人员的坏习惯，从而防止他们编写的代码出现问题。所以：

> “在具有块作用域的语言中，通常建议在第一次使用的地方声明变量。但由于 JavaScript 没有块作用域，因此在函数顶部声明函数的所有变量更为明智。它是建议每个函数使用单个 var 语句。” - [http://www.jslint.com/lint.html#scope](http://www.jslint.com/lint.html#scope)

* * *

## 回答 #12

> 赞同：7
> 
> 时间：2016-07-10T17:17:57.930

避免使用单语句版本（单*var*）的另一个原因是调试。*如果在任何*分配行中引发异常，则堆栈跟踪仅显示一行。

如果您使用逗号语法定义了 10 个变量，您将无法直接知道哪个是罪魁祸首。

个人陈述版本不受这种歧义的影响。

* * *

## 回答 #13

> 赞同：6
> 
> 时间：2015-02-10T17:02:59.770

我认为这是个人喜好问题。我更喜欢通过以下方式做到这一点：

```
 var /* Variables */
            me = this, that = scope,
            temp, tempUri, tempUrl,
            videoId = getQueryString()["id"],
            host = location.protocol + '//' + location.host,
            baseUrl = "localhost",
            str = "Visit W3Schools",
            n = str.search(/w3schools/i),
            x = 5,
            y = 6,
            z = x + y
   /* End Variables */; 
```

* * *

## 回答 #14

> 赞同：5
> 
> 时间：2019-05-03T15:08:20.693

可维护性问题可以很容易地通过一些格式化来克服，如下所示：

```
let
  my_var1 = 'foo',
  my_var2 = 'bar',
  my_var3 = 'baz'
; 
```

我严格按照个人喜好使用这种格式。当然，对于单个声明，我会跳过这种格式，或者它只是把工作搞砸了。

* * *

## 回答 #15

> 赞同：4
> 
> 时间：2021-07-02T20:46:12.357

正如每个人所说，它主要是偏好和可读性，但我会在线程上发表评论，因为我没有看到其他人分享这种想法

我认为这个问题的答案很大程度上取决于您设置的变量以及它们之间的关系。我尝试根据我创建的变量是否相关来保持一致；我的偏好通常看起来像这样：

# 对于不相关的变量

我将它们单线排列，以便以后可以轻松移动它们；我个人**绝不会以**任何其他方式声明不相关的项目：

```
const unrelatedVar1 = 1;
const unrelatedVar2 = 2;
const unrelatedVar3 = 3; 
```

# 对于相关的东西（实用程序）

如果我正在创建新变量，我将其声明为一个块——这表明属性属于一起

```
const
  x = 1,
  y = 2,
  z = 3
;

// or
const x=1, y=2, z=3;

// or if I'm going to pass these params to other functions/methods
const someCoordinate = {
  x = 1,
  y = 2,
  z = 3
}; 
```

对我来说，这与解构更加一致：

```
const {x,y,z} = someCoordinate; 
```

做类似的事情会感觉很笨重（**我不会这样做**）

```
const x = someCoordiante.x;
const y = someCoordiante.y;
const z = someCoordiante.z; 
```

# 对于相关的事情（建筑）

如果使用同一个构造函数创建多个变量，我通常也会将它们组合在一起；我*个人*觉得这更具可读性

而不是像（**我通常不这样做**）

```
const stooge1 = Person("moe");
const stooge2 = Person("curly");
const stooge3 = Person("larry"); 
```

我*通常*会这样做：

```
const [stooge1, stooge2, stooge3] = ["moe", "curly", "larry"].map(Person); 
```

我说*通常是*因为如果输入参数足够长以至于变得不可读，我会将它们分开。

我同意其他人关于使用严格的评论

* * *

## 回答 #16

> 赞同：2
> 
> 时间：2014-02-27T15:38:49.490

[“内聚](https://en.wikipedia.org/wiki/Cohesion_(computer_science))胜于[耦合](https://en.wikipedia.org/wiki/Coupling_(computer_programming))”的概念可以比对象/模块/函数更广泛地应用。它也可以在这种情况下使用：

OP 建议的第二个示例将所有变量耦合到同一个语句中，这使得不可能在不破坏内容的情况下将其中一条线移动到其他地方（高耦合）。他给出的第一个示例使变量分配彼此独立（低耦合）。

从*[联轴器](https://en.wikipedia.org/wiki/Coupling_(computer_programming))*：

> 低耦合通常是结构良好的计算机系统和良好设计的标志，当与高内聚相结合时，支持高可读性和可维护性的总体目标。

所以选择第一个。

* * *

## 回答 #17

> 赞同：1
> 
> 时间：2017-05-22T11:04:26.503

我相信在我们开始使用 ES6 之前，使用单个 var 声明的方法既不好也不坏（如果你有 linter 和`'use strict'`. 这确实是一种口味偏好。但现在情况对我来说发生了变化。这些是我赞成的想法多行声明：

1.  现在我们有了两种新的变量，并且`var`已经过时了。`const`在您真正需要之前，在任何地方都使用它是一种很好的做法`let`。因此，您的代码通常会在代码中间包含带有赋值的变量声明，并且由于块作用域，您经常会在块之间移动变量以防发生小的变化。我认为使用多行声明更方便。

2.  ES6 语法变得更加多样化，我们得到了析构函数、模板字符串、箭头函数和可选赋值。当您大量使用所有这些功能与单个变量声明时，它会损害可读性。

* * *

## 回答 #18

> 赞同：0
> 
> 时间：2014-01-27T11:15:54.477

我认为第一种方法（多个变量）是最好的，否则你可能会得到这个（来自使用[KnockoutJS](https://en.wikipedia.org/wiki/KnockoutJS)的应用程序），我认为这很难阅读：

```
 var categories = ko.observableArray(),
        keywordFilter = ko.observableArray(),
        omniFilter = ko.observable('').extend({ throttle: 300 }),
        filteredCategories = ko.computed(function () {
            var underlyingArray = categories();
            return ko.utils.arrayFilter(underlyingArray, function (n) {
                return n.FilteredSportCount() > 0;
            });
        }),
        favoriteSports = ko.computed(function () {
            var sports = ko.observableArray();
            ko.utils.arrayForEach(categories(), function (c) {
                ko.utils.arrayForEach(c.Sports(), function (a) {
                    if (a.IsFavorite()) {
                        sports.push(a);
                    }
                });
            });
            return sports;
        }),
        toggleFavorite = function (sport, userId) {
            var isFavorite = sport.IsFavorite();

            var url = setfavouritesurl;

            var data = {
                userId: userId,
                sportId: sport.Id(),
                isFavourite: !isFavorite
            };

            var callback = function () {
                sport.IsFavorite(!isFavorite);
            };

            jQuery.support.cors = true;
            jQuery.ajax({
                url: url,
                type: "GET",
                data: data,
                success: callback
            });
        },
        hasfavoriteSports = ko.computed(function () {
            var result = false;
            ko.utils.arrayForEach(categories(), function (c) {
                ko.utils.arrayForEach(c.Sports(), function (a) {
                    if (a.IsFavorite()) {
                        result = true;
                    }
                });
            });
            return result;
        }); 
```

# ruby-on-rails - Rails 保留的类名

> ID：694106
> 
> 赞同：7
> 
> 时间：2009-03-29T04:40:44.643
> 
> 标签：ruby-on-rails, ruby, class, naming

我尝试创建一个名为“类”的模型（如在一个毕业班的学生中），并遇到了各种各样的问题。在 Rails 中要避免哪些其他词或类名？

我找到了一些链接：http:
[//juicebar.wordpress.com/2007/05/30/reserved-words-in-rails/](http://juicebar.wordpress.com/2007/05/30/reserved-words-in-rails/)
[http://railsforum.com/viewtopic.php?id=22242](http://railsforum.com/viewtopic.php?id=22242)

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2009-03-29T05:24:54.163

这个页面有一长串不要使用的单词：

[https://reservedwords.herokuapp.com/words](https://reservedwords.herokuapp.com/words)

因为“class”作为元编程的名字非常普遍，我认为公认的 ruby​​ 替代品是“klass”。这显然与你毕业班的情况不同，但也许仍然有帮助。

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2009-03-29T04:45:28.517

你那里有大部分。显然，您还需要避免使用 Ruby 关键字：

```
alias   and     BEGIN   begin   break   case    class   def     defined  
do      else    elsif   END     end     ensure  false   for     if  
in      module  next    nil     not     or      redo    rescue  retry  
return  self    super   then    true    undef   unless  until   when  
while   yield 
```

（来自[http://www.zenspider.com/Languages/Ruby/QuickRef.html#4](http://www.zenspider.com/Languages/Ruby/QuickRef.html#4)）。

另外，不要命名模型`Transaction`（但生成器会对此发出警告！）。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2009-03-29T07:15:39.420

`Class`是一个内置的 ruby​​ 类。它是类的实例。

```
class Foo
end

puts Foo.class
# => Class 
```

覆盖会破坏 Ruby 中的整个对象结构。

# geometry - 分解为凸多边形

> ID：694108
> 
> 赞同：13
> 
> 时间：2009-03-29T04:41:34.190
> 
> 标签：geometry

这个问题有点牵强。我编写了一个将[简单多边形](http://en.wikipedia.org/wiki/Simple_polygon)分解为凸子多边形的算法，但现在我无法证明它*不是最优的（即使用**斯坦纳点*（添加顶点）的凸多边形数量最少）。我的教授坚持认为用这种贪心算法无法做到这一点，但我想不出一个反例。

所以，如果有人能证明我的算法是次优的（或最优的），我将不胜感激。

用图片解释我的算法的最简单方法（这些来自较旧的次优版本）

![](https://i.stack.imgur.com/jECBK.png)

我的算法所做的是将 i 点周围的线段延伸到另一边上的一个点。

如果此范围内没有顶点，它会创建一个新顶点（红点）并连接到该顶点：

![](https://i.stack.imgur.com/SQRpU.png)

如果范围内有*一个*或多个顶点，则它连接到最近的一个。这*通常*会产生具有最少凸多边形数量的分解：

![](https://i.stack.imgur.com/Jj9Vh.png)

然而，在某些情况下它可能会失败——在下图中，如果它恰好先连接中间的绿线，这将创建一个额外的不需要的多边形。为此，我建议仔细检查我们添加的所有边（对角线），并检查它们是否仍然是必要的。如果没有，请将其删除：

![](https://i.stack.imgur.com/SkGN8.png)

然而，在某些情况下，这还不够。看这个图：

![](https://i.stack.imgur.com/Pqw5F.png)

用 ac 替换 ab 和 cd 会产生更好的解决方案。但是，在这种情况下，没有要删除的边缘，所以这会带来问题。在这种情况下，我建议一个优先顺序：在决定将反射顶点连接到哪个顶点时，它应该选择具有最高优先级的顶点：

最低）最近的顶点

med）最近的反射顶点

最高）向后工作时也在范围内的最近反射（很难解释）-

在[此图](http://www.sfu.ca/~mnb2/conv/case4.png)中，我们可以看到反射顶点 9 选择连接到 12（因为它最近），而连接到 5 会更好。顶点 5 和 12 都在延长线定义的范围内段 10-9 和 8-9，但应优先考虑顶点 5，因为 9 在 4-5 和 6-5 给出的范围内，但不在 13-12 和 11-12 给出的范围内。即边 9-12 消除了 9 处的反射顶点，但不消除 12 处的反射顶点，但它可以消除 5 处的反射顶点，因此应优先考虑 5。

此修改后的版本可能仍然存在边缘 5-12，但可以在后期处理期间将其删除。

有没有我错过的案例？

* * *

伪代码（由 John Feminella 要求）——这缺少图 3 和图 5 下的位

```
assume vertices in `poly` are given in CCW order
let 'good reflex' (better term??) mean that if poly[i] is being compared with poly[j], then poly[i] is in the range given by the rays poly[j-1], poly[j] and poly[j+1], poly[j]

for each vertex poly[i]
    if poly[i] is reflex
        find the closest point of intersection given by the ray starting at poly[i-1] and extending in the direction of poly[i] (call this lower bound)
        repeat for the ray given by poly[i+1], poly[i] (call this upper bound)

        if there are no vertices along boundary of the polygon in the range given by the upper and lower bounds
            create a new vertex exactly half way between the lower and upper bound points (lower and upper will lie on the same edge)
            connect poly[i] to this new point
        else
            iterate along the vertices in the range given by the lower and upper bounds, for each vertex poly[j]
                if poly[j] is a 'good reflex'
                    if no other good reflexes have been found
                        save it (overwrite any other vertex found)
                    else
                        if it is closer then the other good reflexes vertices, save it
                else
                    if no good reflexes have been found and it is closer than the other vertices found, save it
            connect poly[i] to the best candidate
        repeat entire algorithm for both halves of the polygon that was just split
// no reflex vertices found, then `poly` is convex
save poly 
```

* * *

原来还有一个我没有预料到的情况：[图 5]

我的算法将尝试将顶点 1 连接到 4，除非我添加另一个检查以确保它可以。所以我建议使用我上面提到的优先级方案将“范围内”的所有内容填充到优先级队列中，然后取最高优先级的一个，检查它是否可以连接，如果不能，将其弹出并使用下一个。我*认为*如果我正确优化它，这会使我的算法成为 O(rn log n)。

* * *

我整理了[一个网站](https://mpen.ca/406/)，粗略地描述了我的发现。我倾向于四处移动东西，所以趁热拿走。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-04-07T00:17:35.883

我相信常规的五角星（例如具有共线段的交替点）是您寻求的反例。

**根据评论进行编辑**

根据我修改后的理解，修改后的答案：尝试一个*锐角*五角星（例如，一个手臂足够窄，只有与您正在处理的反射点相对的手臂的三个点在被认为是“良好反射点”的范围内）。至少在纸上完成它似乎提供了比最佳值更多的东西。但是，最终阅读您的代码让我想知道：“最接近”（即最接近什么）是什么意思？

**笔记**

尽管我的回答被接受了，但这并不是我们最初认为的反例。正如@Mark 在评论中指出的那样，它从四到五与最佳状态完全相同。

**触发器，触发器**

进一步思考，我认为我毕竟是对的。通过简单地确保一对臂具有共线边缘，可以在锐角星中保留最佳的四个边界。但是算法找到了五个，即使有补丁。

我明白了：

*删除死 ImageShack 链接*

当最优是这样的：

*删除死 ImageShack 链接*

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2009-04-07T08:09:17.247

我认为您的算法不可能是最优的，因为它没有使用任何最优性度量。您使用其他指标，如“最近”顶点，并检查“必要”对角线。

为了在您的算法和最佳算法之间建立一个楔子，我们需要通过寻找具有会严重分解的紧密顶点的形状来利用该间隙。例如（忽略这些行，我在 intertubenet 上找到了这个）：

[形成 G 或 U 形的凹多边形 http://avocado-cad.wiki.sourceforge.net/space/showimage/2007-03-19_-_convexize.png](http://avocado-cad.wiki.sourceforge.net/space/showimage/2007-03-19_-_convexize.png)

您无法防止最中心点跨过多边形*外部的凹形“间隙”连接。*

您的算法也非常复杂，并且可能过度使用它 - 就像复杂的代码一样，您可能会在其中发现错误，因为复杂的代码会做出复杂的假设。

考虑一个更广泛的初始阶段，将形状分解成更多、更简单的形状（如三角形），然后使用迭代或遗传算法重新组合它们。无论如何，您将需要一个这样的阶段来组合凸多边形之间的任何不必要的划分，到那时您可能已将可能的分解限制为仅次优的解决方案。

猜测如下：

1.  分解成三角形
2.  非确定性地产生许多重组
3.  计算质量指标（多边形数）
4.  选择最好的 x% 的重组
5.  **使用三角形部分**分解每个，并生成一组新的重组
6.  从 4 开始重复直到达到某种程度的收敛

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2009-03-29T05:30:00.127

> > 但应优先考虑顶点 5，因为 9 在 4-5 和 6-5 给出的范围内

如果 4-5 和 6-5 更加凸出以至于 9 不在它们的范围内，你会怎么做？然后根据您的规则，正确的做法是将 9 连接到 12，因为 12 是最近的反射顶点，这将是次优的。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2009-04-09T18:00:03.210

找到了:(它们实际上很明显。

* * *

*死图像hack img*

如果允许施泰纳点，四叶三叶草将不是最佳选择……红色顶点可能已连接。

* * *

*死图像hack img*

如果没有 Steiner 点，它甚至不会是最佳的...... 5 可以连接到 14，从而不需要 3-14、3-12 和 5-12。这可能是*两个*多边形更好！哎哟!

# java - 如何在开发和生产环境中使用不同的 META-INF/context.xml 文件

> ID：694109
> 
> 赞同：4
> 
> 时间：2009-03-29T04:41:57.153
> 
> 标签：java, tomcat, jdbc, jndi

在 Tomcat（和其他一些 servlet 容器）中，我可以将有关我的 JDBC 数据源的信息存储在`META-INF/context.xml`. 这非常有用。

但是，我的 JDBC DataSource 的设置在我的开发和生产环境中可能会有所不同。我想知道其他人如何以优雅的方式处理这些差异，特别是如何`context.xml`以最轻松的方式为我的开发环境和生产环境设置一个。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-03-29T04:51:03.497

您可以为特定构建创建不同的文件。例如创建：development.context.xml production.context.xml

然后，您可以控制在 build.xml 文件中使用哪个上下文文件。基本上，为您要使用的构建类型设置提示。当您选择开发时，它使用开发上下文文件。当您选择生产时，它使用生产上下文文件。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2009-03-29T14:42:59.063

我会像凯文提到的那样做。如果您使用的是 Maven，您将使用“配置文件”。

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2009-08-06T10:42:39.600

如果您想了解有关 Maven 配置文件的更多信息，请阅读以下内容：[构建配置文件简介](http://maven.apache.org/guides/introduction/introduction-to-profiles.html)

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2009-03-29T04:54:30.103

就我个人而言，我不会在 context.xml 中存储这样的配置信息（也许在另一个属性文件或其他东西中），但是这样的一般方法是让你的构建脚本将不同版本的配置文件打包到 WAR/EAR /任何。您可以让您的构建脚本根据您传入的参数、运行不同的目标等来决定是使用“dev”还是“production”配置文件。

我经常使用的是 ant 中的[任务](http://ant.apache.org/manual/using.html#filters)，即用过滤器文件中的值替换文件中的某些标记；并根据我的目标环境交换使用哪个过滤器文件。

# javascript - 如何将 JavaScript 添加到 ASP.NET MVC 视图？

> ID：694111
> 
> 赞同：33
> 
> 时间：2009-03-29T04:43:42.360
> 
> 标签：javascript, jquery, asp.net-mvc, views

我有一个简单的视图，我希望将[JQuery DatePicker JavaScript](http://jqueryui.com/demos/datepicker/)添加到该视图（而不是*每个*视图，通过母版页）。

我不确定这样做的最佳方法是什么。

其次，我知道我的 JavaScript 加载的位置/时间。我是 YSlow 的粉丝，它建议我将任何脚本添加到页面底部，我会这样做。

那么，我怎么能两者都做呢？

这是视图：

```
<%@ Page
    Language="C#" 
    MasterPageFile="~/Views/Shared/Site.Master" 
    Inherits="System.Web.Mvc.ViewPage" %>

<asp:Content ID="Content1" ContentPlaceHolderID="MainContent" runat="server">

    <h2>Index</h2>

    <% using (Html.BeginForm()) {%>

    <p>
        <label for="StartDate">Start Date:</label>
        <!-- JQuery DatePicker to be added, here. -->
    </p>
    <% } %>
</asp:Content> 
```

* * *

## 回答 #1

> 赞同：22
> 
> 时间：2011-04-11T13:56:18.303

在 ASP.NET MVC3 中，您现在可以使用 RenderSection 来实现这一点，至少对于更简单的场景是这样。只需在布局页面底部添加一个 RenderSection，然后从您的视图中填写应用程序代码

渲染部分：http: [//www.dotnetcurry.com/ShowArticle.aspx? ID=636](http://www.dotnetcurry.com/ShowArticle.aspx?ID=636)

* * *

## 回答 #2

> 赞同：15
> 
> 时间：2009-03-29T04:49:35.433

您的 MasterPage 应该有一个 ContentPlaceHolder 作为头部。

```
<head runat="server">
    <title></title>
    <asp:ContentPlaceHolder ID="head" runat="server" />
</head> 
```

然后，您可以在视图中包含头部元素（JavaScript、StyleSheets 等）：

```
<asp:Content ID="Content1" ContentPlaceHolderID="head" runat="server">
    <script src="/Scripts/jquery/ui/ui.datepicker.js" type="text/javascript">
    </script>
    <link href="/Styles/myStyle.css" rel="stylesheet" type="text/css" />
</asp:Content> 
```

* * *

## 回答 #3

> 赞同：12
> 
> 时间：2009-03-29T04:47:29.153

一种方法是在母版页底部放置一个内容占位符，然后需要 javascript 的特定从属页面可以将占位符内容指定为所需的 javascript。其他不需要 javascript 的页面根本不为占位符指定任何内容。

# ruby-on-rails - 为什么 Ruby open-uri 的 open 在我的单元测试中返回一个 StringIO，但在我的控制器中返回一个 FileIO？

> ID：694115
> 
> 赞同：31
> 
> 时间：2009-03-29T04:48:46.763
> 
> 标签：ruby-on-rails, ruby, amazon-s3, imagemagick, open-uri

我继承了一个 Rails 2.2.2 应用程序，该应用程序将用户上传的图像存储在 Amazon S3 上。基于 attachment_fu 的`Photo`模型提供了`rotate`一种用于`open-uri`从 S3 和 MiniMagick 检索图像以执行旋转的方法。

该`rotate`方法包含这一行来检索与 MiniMagick 一起使用的图像：

```
temp_image = MiniMagick::Image.from_file(open(self.public_filename).path) 
```

`self.public_filename`返回类似的东西

```
http://s3.amazonaws.com/bucketname/photos/98/photo.jpg 
```

检索图像并旋转它在生产和开发中运行的应用程序中工作得很好。但是，单元测试失败了

```
TypeError: can't convert nil into String
    /Users/santry/Development/totspot/vendor/gems/mini_magick-1.2.3/lib/mini_magick.rb:34:in `initialize'
    /Users/santry/Development/totspot/vendor/gems/mini_magick-1.2.3/lib/mini_magick.rb:34:in `open'
    /Users/santry/Development/totspot/vendor/gems/mini_magick-1.2.3/lib/mini_magick.rb:34:in `from_file' 
```

原因是在单元测试的上下文中调用模型方法时，`open(self.public_filename)`正在返回一个`StringIO`包含图像数据的对象。这个对象的`path`方法返回`nil`并`MiniMagick::Image.from_file`炸毁。

当从 调用这个相同的模型方法时`PhotosController`，`open(self.public_filename)`返回一个`FileIO`与名为 eg 的文件绑定的实例，`/tmp/open-uri7378-0`该文件包含图像数据。

想着一定是测试和开发环境的差异，我在开发环境下启动了控制台。但就像在单元测试中一样，`open('http://...')`返回 a `StringIO`，*而不是*a `FileIO`。

我已经通过 open-uri 和所有相关的特定于应用程序的代码追踪了我的方式，并且找不到任何差异的原因。

* * *

## 回答 #1

> 赞同：74
> 
> 时间：2011-07-09T01:05:35.037

open-uri 库使用一个常量来设置 StringIO 对象的 10KB 大小限制。

```
> OpenURI::Buffer::StringMax
=> 10240 
```

您可以将此设置更改为 0 以防止 open-uri 创建 StringIO 对象。相反，这将强制它始终生成一个临时文件。

只需将其放入初始化程序中：

```
# Don't allow downloaded files to be created as StringIO. Force a tempfile to be created.
require 'open-uri'
OpenURI::Buffer.send :remove_const, 'StringMax' if OpenURI::Buffer.const_defined?('StringMax')
OpenURI::Buffer.const_set 'StringMax', 0 
```

您不能直接设置常量。您需要实际删除常量，然后再次设置它（如上），否则您会收到警告：

```
warning: already initialized constant StringMax 
```

**2012 年 12 月 18 日更新：Rails 3 默认不需要 OpenURI，因此您需要**在**`require 'open-uri'`初始化程序的顶部添加。我更新了上面的代码以反映这种变化。**

 *** * *

## 回答 #2

> 赞同：30
> 
> 时间：2009-03-29T10:14:34.827

负责这个的代码在 open-uri 的 Buffer 类中。它首先创建一个 StringIO 对象，并且仅在数据超过一定大小（10 KB）时在本地文件系统中创建一个实际的临时文件。

我假设您的测试加载的任何数据都足够小，可以保存在 StringIO 中，并且您在实际应用程序中使用的图像足够大，可以保证使用 TempFile。解决方案是使用两个类共有的方法，特别是 read 方法，使用 MiniMagick::Image#from_blob：

```
temp_image = MiniMagick::Image.from_blob(open(self.public_filename, &:read)) 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2020-07-09T19:32:02.413

现在`OpenURI::Buffer::StringMax`可以直接设置：

```
require 'open-uri'
OpenURI::Buffer::StringMax = 0 
```

但有一个警告：

```
warning: already initialized constant OpenURI::Buffer::StringMax 
```

# cocoa - 灰色 NSTableView à la iTunes

> ID：694130
> 
> 赞同：1
> 
> 时间：2009-03-29T05:10:43.277
> 
> 标签：cocoa

如何在我自己的应用程序中实现深灰色`NSTableView`外观（用于 iTunes、Delicious Library 等）？

[![iTunes NSTableHeaderView](https://i.stack.imgur.com/Y4MKk.png)](https://i.stack.imgur.com/Y4MKk.png)

我一直认为这是`NSTableView`（或`NSTableHeaderView`）中的一个选项，但我从未尝试过实际这样做。

经过几个小时的搜索，我非常确信不存在这样的选择，我需要自己画。

在继续之前，我只想确保没有（未记录的）API，并且我没有遗漏任何东西。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-03-29T05:28:14.857

我的一个好朋友创建了一个名为[BGHUDAppKit](http://binarymethod.com/)的完整控制套件。这是 Apple 不久前推出的新 HUD 产品。我相信他的控件是主题化的，并且它们带有源代码。我个人没有对 Cocoa 做过任何事情，但他做过，而且我知道他可以回答一些问题。不幸的是，他并没有潜伏在这里，所以你必须联系他。我看看能不能让他来这里。:)

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-03-29T05:33:54.220

查看iTableColumnHeader 下的[这个页面。](http://mattgemmell.com/source)还有许多类似于 Apple 的自定义 UI 元素

# c++ - 使用树的序列化和为每个子树生成唯一 id 的树匹配

> ID：694132
> 
> 赞同：1
> 
> 时间：2009-03-29T05:14:27.760
> 
> 标签：c++, binary-tree

[二叉树 http://img9.imageshack.us/img9/9981/binarytree.jpg](http://img9.imageshack.us/img9/9981/binarytree.jpg)

序列化给定二叉树并反过来评估每个序列化二叉树的唯一 ID 的最佳方法是什么？

例如，我需要序列化子树 (2,7,(5,6,11)) 并生成代表该子树的唯一 id ' **x** '，这样每当我遇到类似的子树 (2 ,7,(5,6,11)) 它将序列化为相同的值“ **x** ”，因此我可以推断出我找到了匹配项。

在这里，我们假设每个节点都具有唯一的属性。在上面的示例中，它将是分配给每个节点的数字，因此它们总是会为相似的子树生成相同的 id。我正在尝试在 C++ 中执行此操作。

是否已经存在执行这种序列化树匹配的算法？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-03-29T07:07:29.267

您是否希望能够匹配树的任意部分或运行到某个叶节点的子树？IIUC，您正在查看后缀匹配。

您还可以查看 Compact Directed Acyclic Word Graph 的想法。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2009-03-29T11:35:50.980

我会根据节点的 ID 和树中的位置创建一个哈希值（以某种 Rabin-Karp 方式），即：

```
long h = 0
for each node in sub tree:
    h ^= node.id << (node.depth % 30) 
```

在伪代码中。缺点是不同的子树可能产生相同的哈希值。但优点是比较哈希值很快，当找到匹配时，您可以进一步调查实际的子树是否相等。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2009-03-29T08:14:53.303

如果您不追求高效率，您可能需要使用非常简单的深度优先搜索算法。

```
"2,7,2,U,6,5,U,11,U,U,U,5,9,4" 
```

如您所见，我添加了 U 命令（“up”）以显示下一个孩子将在哪里创建。当然，您可以提高效率，但我相信这是一个开始。

此外，您可能想看看[Boost.Graph](http://www.boost.org/doc/libs/1_38_0/libs/graph/doc/table_of_contents.html) (BGL) 的实现。

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2009-03-29T10:05:45.313

像您在问题中使用的括号符号有什么问题？

# sql - 如何将 SQL 服务器转换为 Oracle？

> ID：694133
> 
> 赞同：6
> 
> 时间：2009-03-29T05:15:25.700
> 
> 标签：sql, sql-server, oracle, migration

我有一个 SQL 服务器数据库（表、视图、SP...）。我需要将此数据库转换为 Oracle 10g。我该怎么做？

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2009-03-29T18:40:13.177

传输数据将很容易；SQL Server 集成服务可以做到这一点，或者 Oracle 的 SQL Developer。

但是，Oracle 和 SQL Server 之间的视图和存储过程是不同的。SQL Server 使用 T-SQL，Oracle 使用 PL/SQL。这些不是很兼容，我不知道有什么工具可以在两者之间自动转换。如果您的数据库依赖于特定的 T-SQL 功能，则需要开发人员进行转换。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2018-03-16T14:46:13.137

从 sourceforge获取[jTDS jdbc 驱动程序](https://sourceforge.net/projects/jtds/files/jtds/1.3.1/)。

将其添加到[Oracle SQL Developer](http://www.oracle.com/sqldeveloper)。

工具 > 迁移 > 迁移

[![在此处输入图像描述](https://i.stack.imgur.com/0aoPv.png)](https://i.stack.imgur.com/0aoPv.png)

在新的 Oracle 数据库中创建迁移存储库。

创建一个新的迁移项目。

将其指向您的 SQL Server 数据库。

转换它 - 注意数据类型。

迁移数据：

1.  通过 JDBC 进行在线逐行插入。适合小/测试盒。
2.  离线 - 使用微软的卸载实用程序将 sql 服务器拉到平面文件。SQL Developer 将创建 SQL*Loader 脚本以将它们放入 Oracle。
3.  如果您拥有 GoldenGate 许可，请使用它来移动数据并将更改从一个系统同步到另一个系统，以防您需要同时保持正常运行。

开始查看迁移的 T-SQL 过程和函数。SQL Developer 将为无法翻译的代码块留下注释……但您需要测试和验证每一个翻译。客户可以看到他们的 T-SQL 的翻译率高达 80-90%，但也可能低至 50%……这仅取决于代码的性质。

[这里描述了整个过程。](http://www.oracle.com/technetwork/database/migration/sqlserver-095136.html)

我写了[一篇白皮书](http://www.oracle.com/us/products/database/migrating-to-oracle-database-wp-3610526.pdf)，以 Sybase ASE 作为示例源平台，here。SQL Server 的过程相同。它提供带有屏幕截图的分步指导。

如果您有 Oracle 客户经理，请寻求帮助。我们有专门处理像您这样的迁移的专家。他们有很多实用的建议，如果您缺乏专业知识，可以推荐第三方合作伙伴。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-03-29T06:28:14.107

sql开发人员可以提供帮助。你可以在这里下载，它是免费的。[http://www.oracle.com/technology/software/products/sql/index.html](http://www.oracle.com/technology/software/products/sql/index.html)

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2016-07-27T05:58:09.677

有分步文档，包括有关如何将 SQL Server 迁移到 Oracle DB 的视频。您可以在这里找到： [从 Microsoft SQL Server 迁移到 Oracle](http://www.oracle.com/technetwork/database/migration/sqlserver-095136.html)

或者您可以使用 Ispirer 等工具为您完成这项工作[- 将 Microsoft SQL Server 迁移到 Oracle](http://www.ispirer.com/products/sql-server-to-oracle-migration)

* * *

## 回答 #5

> 赞同：-1
> 
> 时间：2009-03-29T05:23:54.557

您基本上设置了一个 Oracle 服务器，一旦准备就绪，您就可以使用为此制作的软件迁移您的表。我想这个脚本可以完成这项工作： [m2o](http://sourceforge.net/projects/m2o/)

# http-status-codes - 消除 401 个“未经授权”响应，然后是 200 个“Ok”响应

> ID：694135
> 
> 赞同：26
> 
> 时间：2009-03-29T05:16:53.857
> 
> 标签：http-status-codes, http-status-code-401

我遇到了一个大型内部企业基于 Web 的应用程序，它在 IIS6 上运行 ASP.NET 3.5，生成 401 个“未经授权”响应，然后是 200 个“Ok”响应（如 Fiddler 所述）。我知道为什么会发生这种情况（集成身份验证强制浏览器重新发送凭据），但我正在寻找一些关于如何最小化或消除这种情况的想法。有问题的应用程序在 WAN 中运行，一些用户遇到高达 250 毫秒的延迟，因此强制执行后续请求可能会对页面加载时间产生显着影响，尤其是当页面上有许多级联下拉列表时。

应用程序的用户是托管桌面环境的内部用户，因此从部署的角度来看，强制浏览器在第一个请求时发送凭据的机制（这甚至可能吗？）是可能的。这适用于需要用户身份的页面，但对于不需要身份验证的资源（WebResource.axd、ScriptResource.axd 和一些自定义 Web 服务），允许匿名身份验证是可能的。我已经在 web.config 中查看了基于每个位置的定义，但结果好坏参半（仍然有许多 401 响应）。

对于处理这种情况的“最佳实践”的任何指导，我将不胜感激。有很多资源可以确定问题，但我发现没有一个资源可以提供可行的解决方案。

谢谢！

编辑：不需要身份验证的资源（即用于级联下拉列表的 Web 服务）可以通过向 Web 配置添加位置条目来匿名请求，但我还没有找到经过身份验证的资源的答案。

* * *

## 回答 #1

> 赞同：17
> 
> 时间：2009-04-30T00:37:45.787

不幸的是，这是[HTTP NTLM 身份验证方案](http://www.innovation.ch/personal/ronald/ntlm.html)的产物。

简而言之，浏览器（Internet Explorer 或其他）根本不知道它需要进行身份验证，直到它被包含`WWW-Authenticate`响应标头的 401 响应退回。

在这种情况下`WWW-Authenticate: NTLM`——很烦人——它需要在一个持久连接上完成*两个*401 响应，并且一旦 HTTP 持久连接关闭，就必须重复这个过程。因此，即使您能够让浏览器发起一个盲目尝试 NTLM 的请求，也无法从事务中删除至少一个 401 响应。

我认为你最好的选择是最大化持续连接在空闲时保持打开的时间。

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2010-08-17T23:09:15.847

CSCRIPT.EXE c:\inetpub\adminscripts\ADSUTIL.VBS SET W3SVC/AuthPersistSingleRequest FALSE

将大大减少401的数量。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-03-29T08:22:48.150

我相信您可以说服 Firefox 通过“about:config”设置自动将 NTLM 凭据发送到一组列入白名单的域 - 使用“network.automatic-ntlm-auth.trusted-uris”设置。虽然我自己没有尝试过。我不确定 Internet Explorer 是否有任何等价物。

不幸的是，如果您使用的是 Kerberos 之类的其他东西，似乎没有办法避免 401。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2009-05-01T05:16:16.827

如果 401 引起的延迟太长，您可能需要考虑表单身份验证。用户必须显式登录，但只需登录一次。然后，您可以使用 cookie 或无 cookie 方案并在第一次尝试时获得响应。

我想如果您有级联下拉菜单并且您的初始页面加载填充一个值，该值导致 POST 获取下一个列表，设置该值，另一个 POST 再次获取下一个列表，我想页面加载会很慢，依此类推。如果是这种情况，也许您需要在第一次往返时填充所有这些下拉列表，而不是等待 POST 响应。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2020-04-30T11:17:53.693

**TL;DR 我将 HTTP 标头信息放在 HTTP 正文中**

我的例子是 Angular，但任何 TypeScript/JavaScript（框架）都可能有同样的问题。

在对我的后端 API 进行 HTTP 发布调用时，它需要带有登录用户信息的标头，我将我的 HTTP 标头添加到我的 HTTP 正文应该是并且标头为空的位置。

问题

```
 markInstructionAsCompleted(visitScheduleId: string, instructionId: number) {
    return this.http.post(`${environment.apiUrl}/VisitInstructions/schedule/${visitScheduleId}/done/${instructionId}`, this.getHeaderWithAuthorization());
  } 
```

解决方案，请注意 HTTP post 调用中添加了第二个参数，即`null`

```
 markInstructionAsCompleted(visitScheduleId: string, instructionId: number) {
    return this.http.post(`${environment.apiUrl}/VisitInstructions/schedule/${visitScheduleId}/done/${instructionId}`, null, this.getHeaderWithAuthorization());
  } 
```

# java - foreach 中的 Struts 2 URL 参数

> ID：694136
> 
> 赞同：1
> 
> 时间：2009-03-29T05:18:24.180
> 
> 标签：java, struts2, foreach

有人可以向我解释为什么以下代码会导致错误：根据标记文件中的 TLD 或属性指令，属性值不接受任何表达式。每当我尝试为 URL 的参数动态设置值时，它总是会中断。

```
<%@ page contentType="text/html; charset=UTF-8" %>
<%@ taglib prefix="s" uri="/struts-tags" %>
<%@ taglib uri="http://java.sun.com/jsp/jstl/core" prefix="c" %>

<c:forEach var="v" items="${files}">
    ${v} <a href='<s:url action="DeleteFile"><s:param name="fileName" value="${v}" /></s:url>'>Delete</a><br />
</c:forEach> 
```

我正在使用 Struts 2 和最新版本的 Java。任何帮助，将不胜感激。

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2009-03-29T09:48:50.660

您正在混合 JSTL 标记（foreach）和 Struts 标记（s 参数）。虽然可以让它们一起工作，但为什么会陷入困境呢？

使用 struts**迭代器**标签并转储 foreach。

详见[http://struts.apache.org/2.0.14/docs/iterator.html](http://struts.apache.org/2.0.14/docs/iterator.html)

理论上，可以使用 JSTL 完成的所有事情都可以使用原生 struts 2 标记，因此您的应用程序可能根本不需要 JSTL。

# .net - 在不使用大量内存的情况下显示大文件的最佳方法是什么？

> ID：694137
> 
> 赞同：2
> 
> 时间：2009-03-29T05:18:51.277
> 
> 标签：.net, file, file-io, scroll, memory-mapped-files

许多十六进制编辑器，例如 Hex Workshop，甚至可以读取大型文件，同时保持相对较小的内存占用，但仍能保持滚动流畅。我正在寻找实现这一目标的最佳方法，因此我有几个相关的问题。

我应该只使用 FileStream 吗？
  - 它的缓冲是否基于当前的 Seek 位置？（向后滚动时通常会出现页面错误吗？）
  - 如果我为 FileStream 创建一个仅在内部使用 Seek 的包装器，我会损害 FileStream 正确缓冲的能力吗？（即，即使搜索就在附近，重复搜索也会严重影响性能吗？我可以依靠缓冲算法或磁盘调度程序来保持性能吗？）

使用内存映射 I/O 会更好吗？（我真的只希望文件最多 100MB）
  - 来自搜索/跳转/快速滚动的页面错误会产生明显的性能问题吗？

最终必须显示数据。我应该将整个文件渲染为位图并在更改时使图像的某些部分无效（让滚动控件在图像上进行自己的分页），还是应该只在滚动事件上生成当前显示区域？

所以简而言之，我是分页数据、生成的图像，还是两者都分页，还是根据需要获取/生成它们？最适合此任务的（WPF/.Net）库/API 对象是什么？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-03-29T10:19:57.667

你似乎已经有了答案。
对此的一般解决方案是使用[内存映射文件](http://msdn.microsoft.com/en-us/library/ms810613.aspx)，让操作系统为缓存和查找而烦恼。
首先尝试最简单和最明显的解决方案。如果它不能让您满意，请优化瓶颈。[过早的优化是万恶之源。](http://en.wikipedia.org/wiki/Optimization_(computer_science))

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-03-29T06:43:59.683

100MB 真的不算大。所以在内存中可能会在新机器上工作。

但是您不希望您的解决方案随着时间的推移而无法扩展。您假设限制为 100MB 的那一刻，有人会尝试使用 200MB。因此，我建议您采取“寻求”路线-这是常见的方法。

# database - 在数据库中存储加密的用户名哈希

> ID：694147
> 
> 赞同：13
> 
> 时间：2009-03-29T05:25:21.183
> 
> 标签：database, security

我目前正在为我正在组装的应用程序进行基本用户身份验证，但我在安全方面没有太多经验。

这就是说，我理解在数据库中加盐/存储（加盐）密码哈希作为 blob 的做法（和必要性），而不是密码（加密或不加密）。我已经实现了这一点。

与纯文本（或加密）中的用户名相反，对用户名进行加盐/散列并将散列存储在数据库中是否有任何好处？令我震惊的是，这将使确定哪些用户可以使用数据库进行身份验证访问系统变得相当困难。

既然让某人难以破解用户帐户的密码至关重要，那么增加确定哪些用户可行的难度难道不是有意义的吗？

编辑：我使用的某些语言可能不是 100% 正确的：请随时纠正 :-)

Edit2：我改变了我的第一个点来表示盐渍哈希——感谢大家指出我错过了这个:-)

Edit3：删除了指示我正在加密/解密密码的措辞。我正在使用加盐哈希并将其存储在数据库中——感谢 Scotty 指出这一点。

* * *

## 回答 #1

> 赞同：10
> 
> 时间：2012-02-23T13:18:24.087

## 这取决于上下文

评估您所服务的材料的敏感性很重要。为了深入挖掘，我将提供一些用例。

**场景一：社交网络应用**

您的用户的所有交互都发生在公共场合。他们的电子邮件地址将用作他们的用户名。用户名不被认为是私人的，因为他们的名字出现在他们所有的帖子中。其他用户可能会搜索用户名和/或启用电子邮件邀请。

判决 - 散列 = 不好

**场景 2：电子商务网站**

用户可能参与也可能不参与公共互动（例如评论、评论）。使用电子邮件地址作为用户名可能不是一个好主意，因为通过使用密码恢复，被盗用的电子邮件帐户意味着您网站上的用户帐户被盗用。

这里有很多灰色区域，通常用于“方便”。如果您的网站使用电子邮件作为用户名、存储运输历史记录和信用卡号码；受感染的电子邮件可能会给您的用户带来很多身份盗用问题。

在这种情况下，使用用户名**不是**用户电子邮件地址的策略可能是个好主意。散列电子邮件不会增加任何价值。

*注意：我在看你[Amazon.com](http://www.amazon.com/)。*

结论：常见做法！=良好做法

**场景 3：色情网站**

将用户名设为化名，将登录名设为用户的电子邮件地址。他们可能倾向于谈论内容，并且不一定希望他们的名字出现在谷歌的色情网站搜索结果中。

在这里假设最坏的情况。如果您的数据库以某种方式被黑客入侵，那么暴露您的用户身份可能会造成无法弥补的伤害。你觉得这不会发生在你身上吗？[看看这篇文章](http://arstechnica.com/business/news/2012/02/exposed-passwords-in-all-their-plain-text-glory.ars)。

不仅他们的用户帐户被黑客入侵，密码被泄露，而且很有可能很多用户在他们的电子邮件帐户上使用了相同的密码。现在，他们的信息匿名发布在 PasteBin 上，让全世界都能看到。更糟糕的是，他们中的大多数人可能甚至都不知道这已经发生了。

通过简单地对用户名和密码进行哈希处理，他们可以为自己和他们的用户省去很多麻烦。

结论：无论是否将其用作用户名，都必须对电子邮件地址进行哈希处理。

**场景四：银行**

不言而喻，在银行/金融网站方面不应该节省任何费用。

可以通过以下方式提高安全性：

*   使用电子邮件地址以外的用户名
*   通过要求数字和字母来强制使用唯一的用户名
*   散列密码
*   需要 2 点身份验证（以防用户的电子邮件密码被泄露）
*   散列电子邮件地址
*   ETC...

不应该不惜一切代价保护您的用户，因为如果不这样做，就意味着您在拿他们的生计赌博。

* * *

**结论：**

没有适用于所有站点的安全规则。在某些情况下，用户名是公开的，因此散列它不会增加任何价值。在其他情况下，不对其进行散列可能会造成无法弥补的伤害。如果您最终开发了一个可以使用户名/电子邮件哈希有用的站点，那么这是一个好方法。

1.  哈希用户名
2.  为用户生成唯一的盐
3.  使用盐对密码进行哈希处理
4.  将密码与盐一起存储在数据库中

通过不使用盐对用户名进行哈希处理，您可以避免鸡/蛋问题。除非您对所有用户名使用静态盐。

请记住，可以通过阅读代码找到所有用户帐户的静态盐。一旦发现了静态盐，当使用彩虹表攻击时，它基本上就没有用了。如果您对密码进行加盐，则生成一个动态加盐并将其与用户的其余凭据一起存储在数据库中。

**如果您想要简单的硬/快速规则，这里有一些很好的假设要记住：**

*   假设您的数据库可能在某些时候受到损害
*   假设您的源代码将在某个时候受到损害
*   假设您的用户的电子邮件将在某个时候受到损害
*   假设您的用户是愚蠢的，并且在您的网站上使用的密码与他们在电子邮件中使用的密码相同
*   假设黑客很聪明/足智多谋且受财务驱动。

如果您选择存储敏感/私人数据，那么采取额外步骤可能会在未来为您节省 PR/法律噩梦。

**更新：一篇关于[种子散列的有趣文章刚刚出现在 Coding Horror 上](http://www.codinghorror.com/blog/2012/04/speed-hashing.html)。**

* * *

## 回答 #2

> 赞同：5
> 
> 时间：2009-03-29T05:28:48.960

**简短的回答：**很可能没有。

**长答案：**您的情况似乎缺少关键“我的用户名是敏感的，因为......”这提出了一个问题：“为什么？保护用户名可以解决的具体、可证明的问题是什么？”

如果没有这个问题，您所描述的是与安全相关的开发（以及整个开发）中的一个常见陷阱：想出一些想法来保护或混淆系统的某些部分，然后寻找使用它的理由. 与软件开发中的任何事情一样，在出现只能通过使用特定工具解决的明确问题之前，您应该避免做任何事情，而不是完全需要做的事情。

**额外提示（免费！）：** [加盐你的密码哈希](http://www.codinghorror.com/blog/archives/000953.html)。普通的哈希值[远没有那么安全](http://www.codinghorror.com/blog/archives/000949.html)。

* * *

## 回答 #3

> 赞同：4
> 
> 时间：2009-03-29T06:09:22.997

如果您对用户名进行加盐和哈希处理，您会遇到一些鸡和蛋的问题。

如果您对用户名进行加盐和哈希处理，您将如何在数据库中找到它？您需要查找用户的记录以找到您用来散列用户名的盐......

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2009-03-29T05:34:58.290

可能不是。这样想 - 用户名是应用程序确定用户尝试登录的帐户的方式。密码是应用程序确定用户是否实际被允许以该帐户登录的方式。实际上，这意味着您将使用用户名作为索引在您的帐户表中查找一行。通过加密用户名，您只会更难找到正确的行。

但是，如果您使用相同的加密方案来加密用户名和密码，它们几乎同样安全 - 如果您可以破解一个，您可以破解另一个。因此，加密两者会使查找用户变得更加困难，但不会增加任何额外的安全性。

**注意：**在您的问题中，您谈到了解密密码字段。你可能想让这不可能（字面意思）。大多数人使用某种单向哈希函数（MD5 和 SHA256 很流行）以及盐来加密他们的密码。“单向”部分仅仅意味着一旦你通过函数运行了一些东西，你就不能用你得到的东西来得到你开始的东西。但是，如果您从相同的输入开始，您将始终得到相同的输出。salt 是一个只有你的应用程序知道的秘密（有点像加密密钥），它被添加到你正在加密的任何内容中，然后再通过单向哈希运行。这使得无法执行诸如匹配来自两个不同站点的两个加密密码之类的事情（假设它们使用不同的盐）。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2009-03-29T05:28:30.147

将密码以纯文本形式存储对您的用户来说是不公平的，因为有权访问您的数据库的每个人都可以看到他们的密码。您应该使用盐渍哈希。

[Salt_（密码学）](http://en.wikipedia.org/wiki/Salt_(cryptography))

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2009-03-29T05:33:55.187

您永远无法通过孤立地查看系统的单个部分来正确评估系统的安全性。您在哪里存储用于解密密码的密钥？

有权访问数据库的人是否也有权访问您存储加密密钥的位置？如果是这样，您通过加密密码只获得了轻微的安全性改进，而通过加密用户名可能没有更多收获。

如果解密密钥和使用它的程序比数据库更安全——这很不寻常，通常数据库可能处于最安全的位置——那么加密用户名可能会带来额外的好处，因为你会剥夺攻击者暴力攻击中的有用信息。

# android - Android 应用程序中的日历同步

> ID：694150
> 
> 赞同：2
> 
> 时间：2009-03-29T05:28:25.887
> 
> 标签：android, google-calendar-api, android-calendar

我正在做一个项目，我必须`Calendar`使用 Android 应用程序将我的程序与谷歌同步。

为此我正在使用`eclipse`并且我在网上获得了一些代码，但我不知道我需要添加哪些 .jar 文件以支持导入。

```
import com.google.Android.gdata.client.AndroidXmlParserFactory;

import com.google.Android.gdata.client.JakartaGDataClient;

import com.google.wireless.gdata.calendar.client.CalendarClient;

import com.google.wireless.gdata.calendar.data.EventEntry;

import com.google.wireless.gdata.calendar.data.When;

import com.google.wireless.gdata.calendar.parser.xml.XmlCalendarGDataParserFactory;

import com.google.wireless.gdata.client.QueryParams;

import com.google.wireless.gdata.data.Feed;

import com.google.wireless.gdata.parser.GDataParser; 
```

请任何人都可以帮助我解决这个问题..

或我的项目的任何其他线索，因为我下周有截止日期..

非常感谢你提前..

我会很感激的。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-04-08T12:47:26.913

com.google.android.gdata 和 com.google.wireless 不是公共 SDK 的一部分，因此您将无法使用它们。

我还没有尝试在android上使用gdata-java-client库，但是你应该看看你是否可以下载它并将它包含在你的项目中，看看你是否可以在android上编译和运行它。

[http://code.google.com/p/gdata-java-client/](http://code.google.com/p/gdata-java-client/)

# c# - 将对象转换为通用列表

> ID：694154
> 
> 赞同：6
> 
> 时间：2009-03-29T05:30:40.513
> 
> 标签：c#, .net

我有一个要求，我可以在一个对象中获得以下内容 -

```
a type T or List<T> 
```

将 object 转换为 T 很容易。如何将它转换为 List（首先检查它是否可以成功转换），我要转换的原因是滚动列表并在每个元素上调用 tostring。

我的实际代码 -

```
namespace Generic_Collection_Code
{
    class Program
    {
        public static string DumpObj(object obj)
        {
            string sTemp = String.Empty;

            List<int> ints = obj as List<int>;
            if (ints != null)
            {
                foreach (int i in ints)
                    sTemp += i.ToString() + ",";
                sTemp.Trim(',');
            }
            else 
            {
                List<string> strings = obj as List<string>;
                if (strings != null)
                {
                    foreach (string s in strings)
                        sTemp += s + ",";
                    sTemp.Trim(',');
                }
                else
                {
                    sTemp += obj.ToString();
                }
            }
            return sTemp;
        }
        static void Main(string[] args)
        {
            List<int> listInts = new List<int>();
            listInts.Add(1);
            listInts.Add(2);
            listInts.Add(3);

            Console.WriteLine("Object1: {0}", DumpObj(listInts));
            int i = 90;

            Console.WriteLine("Object2 {0}", DumpObj(i));

            List<string> listStrings = new List<string>();
            listStrings.Add("1");
            listStrings.Add("2");
            listStrings.Add("3");

            Console.WriteLine("Object3: {0}", DumpObj(listStrings));
            Console.ReadKey();
        }
    }
} 
```

上面的代码有效，但我知道它是一种丑陋的方式来实现这一点。我想问社区我怎样才能拥有这个功能 -

```
 public static string DumpObj<T>(object obj)
    {
        string sTemp = String.Empty;

        List<T> list = obj as List<T>;
        if (list != null)
        {
            foreach (T i in list)
                sTemp += i.ToString() + ",";
            sTemp.Trim(',');
        }
        return sTemp;
    } 
```

这给了我编译错误，因为我必须在调用 DumpObj 时指定 T 错误为 -

错误 1 ​​无法从用法中推断方法“Generic_Collection_Code.Program.DumpObj(object)”的类型参数。尝试明确指定类型参数。D:\DotNet\Generic_Collection_Code\Generic_Collection_Code\Program.cs 57 47 Generic_Collection_Code

如您所见，obj 是一个对象，我在调用 dumobj 时不知道它的类型。

我希望我已经明确了这一点。

我很感激你的时间！

问候阿米特

* * *

## 回答 #1

> 赞同：11
> 
> 时间：2009-03-29T05:34:05.873

说

```
List<T> genericList = object as List<T>;

if(genericList != null)
{
   // Do the loop
} 
```

“as”关键字验证“object”实际上是“is-a”List<T>。如果是这样，你会从它那里得到一个 List<T>。如果没有，你会得到空值。

* * *

## 回答 #2

> 赞同：9
> 
> 时间：2009-03-29T05:47:55.480

你得到什么编译错误？如果在您的上下文中将 T 声明为泛型类型参数，那么我在该语句中看到的唯一编译时问题是将关键字`object`用作变量名。无论如何，我建议像这样最好地表达你的意图：

```
IEnumerable enumerable = obj as IEnumerable;

if (enumerable != null)
{
    foreach (object item in enumerable)
    {
        sTemp += item.ToString();
    }
} 
```

如果您的列表可能有很多项目，您可能还需要考虑使用[StringBuilder 。](http://msdn.microsoft.com/en-us/library/system.text.stringbuilder.aspx)

* * *

## 回答 #3

> 赞同：4
> 
> 时间：2009-03-29T09:43:31.500

你不能这样做

```
List<T> genericList = (List<T>)object 
```

可能是你想要的

```
List<T> genericList = (List<T>)obj 
```

其中 obj 是对象

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2009-03-29T15:10:12.040

将“as”与“is”结合起来怎么样？

```
if (object is List<T>)
{ 
  List<T> genericlist = object as List<T>;
 // loop list
}
else if (object is T)
{
 // do something else
} 
```

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2012-09-14T17:41:58.030

将对象转换为 System.Collections.IList（而不是通用版本）怎么样，因为通用列表也实现了这个接口。然后将它们中的每一个转换为所需的类型。这是我正在做的事情..

```
private static void DataSourcePropertyChanged(DependencyObject sender,     
        DependencyPropertyChangedEventArgs args) {
        BarChart _ = sender as BarChart;

        if (args.Property.Equals(BarChart.DataSourceProperty)) {
            System.Collections.IList data = (System.Collections.IList)args.NewValue;
            if (data == null) return;

            foreach (object __ in data) {
                IChartDataItem item = __ as IChartDataItem;
                BarChartItem bar = new BarChartItem() {
                    Label = item.Label,
                    Value = item.Value
                };
                _._visualCollection.Add(bar);

                if (_.MaxData < item.Value)
                    _.MaxData = item.Value;
            }

            if (_.Orientation == Orientation.Horizontal)
                _.Ratio = _.Width / _.MaxData;
        }
    } 
```

# scheme - 初学者：Scheme 中的柯里化函数

> ID：694162
> 
> 赞同：4
> 
> 时间：2009-03-29T05:37:20.763
> 
> 标签：scheme, currying

我正在使用 SICP 讲座和文本来自己了解 Scheme。我正在看一个练习，上面写着“表达式 E 的应用程序是 (E E1,...En) 形式的表达式。这包括 n=0 的情况，对应于表达式 (E)。Curried 应用程序E 的应用要么是 E 的应用，要么是 E 的 Curried 应用的应用。”

（编辑：我更正了上面的引用......我最初错误地引用了定义。）

任务是定义计算为 3 的过程的 Curried 应用程序

```
(define foo1
    (lambda (x)
        (* x x))) 
```

我真的不明白这里的想法，阅读关于 Curriying 的维基百科条目并没有真正帮助。

任何人都可以帮助更清楚地解释这里的要求吗？

实际上，即使给我这个问题的答案也会有所帮助，因为在这个问题之后还有五个要解决。...我只是没有得到基本的想法。

补充：即使在布赖恩坎贝尔冗长的解释之后，我仍然有些迷茫。

被`(foo1 (sqrt 3)))`认为是 foo 的应用程序，因此是 foo 的柯里化应用程序？

看起来太简单了，但也许...

输入`(((foo1 2 )) 2)`DrScheme 会出现以下错误（我有点预料到）

```
procedure application: expected procedure, given: 4 (no arguments) 
```

重新阅读[什么是柯里化？](https://stackoverflow.com/questions/36314/what-is-currying)我知道我也可以将 foo1 重新定义为：

```
(define (foo1 a)
    (lambda (b)
        (* a b))) 
```

那么我可以输入

```
((foo1 3 ) 4) 
```

> 12

但这并没有真正让我更接近于产生 3 作为输出，而且看起来这并不是真正对原始 foo1 进行柯里化，它只是重新定义它。

该死，20 年的 C 编程并没有让我为此做好准备。:-) :-)

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2009-03-29T06:35:47.237

嗯，与通常更清晰的书籍风格相比，这个问题的措辞相当混乱。实际上，如果您从[此处](http://mitpress.mit.edu/sicp/psets/ps1/ps1_1.ps)获取问题集，您可能会错误地引用问题集；这可能会导致您的困惑。

我将为您分解定义，并提供一些示例可以帮助您弄清楚发生了什么。

> 表达式 E 的应用是 (E E1 ... En) 形式的表达式。

这是一个应用程序的示例：

```
(foo 1 2)      ; This is an application of foo
(bar 1)        ; This is an application of bar 
```

> 这包括对应于表达式（E）的情况n=0。

```
(baz)          ; This is an application of baz 
```

> E 的 Curried 应用程序要么是 E 的应用程序，要么是 E 的 Curried 应用程序的应用程序............

这是您引用错误的那个；以上是我在网上找到的问题集的定义。

这个定义有两个部分。从第一个开始：

> E 的 Curried 应用程序是 E 的应用程序

```
(foo 1 2)       ; (1) A Curried application of foo, since it is an application of foo
(bar 1)         ; (2) A Curried application of bar, since it is an application of bar
(baz)           ; (3) A Curried application of baz, since it is an application of baz 
```

> 或 E 的 Curried 应用程序的应用程序

```
((foo 1 2) 3)   ; (4) A Curried application of foo, since it is an application of (1)
((bar 1))       ; (5) A Curried application of bar, since it is an application of (2)
((baz) 1 2)     ; (6) A Curried application of baz, since it is an application of (3)
(((foo 1 2) 3)) ; A Curried application of foo, since it is an application of (4)
(((bar 1)) 2)   ; A Curried application of bar, since it is an application of (5)
                ; etc... 
```

这是否为您提供了入门所需的帮助？

**编辑**：是的，`(foo1 (sqrt 3))`是一个 Curried 应用程序`foo1`；就是这么简单。这不是一个很好的问题，因为在许多实现中，您实际上会得到 2.9999999999999996 或类似的东西；不可能有一个准确返回 3 的值，除非您的 Scheme 具有某种精确[代数数](http://en.wikipedia.org/wiki/Algebraic_number)的表示形式。

你的第二个例子确实是一个错误。`foo1`返回一个整数，该整数无效。只有后面的一些例子，函数的应用程序的递归情况是有效的。看看`foo3`，例如。

**编辑 2**：我刚刚签入了 SICP，看起来这里的概念直到第 1.3 节才解释，而这个作业只提到了第 1.1 节。如果您还没有，我建议您尝试通读第 1.3 节。

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2009-03-29T07:06:11.893

请参阅[什么是“柯里化”？](https://stackoverflow.com/questions/36314/what-is-currying)

> Currying 接受一个函数并提供一个接受单个参数的新函数，并返回指定的函数，并将其第一个参数设置为该参数。

* * *

## 回答 #3

> 赞同：3
> 
> 时间：2014-01-28T20:34:40.757

您得到的大多数答案都是“部分评估”的示例。要在 Scheme 中进行真正的柯里化，您需要语法帮助。像这样：

```
(define-syntax curry
  (syntax-rules ()
    ((_ (a) body ...) 
     (lambda (a) body ...))
    ((_ (a b ...) body ...)
     (lambda (a) (curry (b ...) body ...))))) 
```

然后您将其用作：

```
> (define adding-n3 (curry (a b c) (+ a b c)))
> (define adding-n2-to-100 (adding-n3 100))
> ((adding-n2-to-100) 1) 10)
111

> (adding-n3 1)
#<procedure>

> ((adding-n3 1) 10)
#<procedure> 
```

* * *

## 回答 #4

> 赞同：3
> 
> 时间：2009-06-26T11:20:48.807

我不认为 James 的 curry 函数是正确的 - 当我在我的方案解释器中尝试它时出现语法错误。

这是我一直使用的“咖喱”的实现：

```
> (define curry (lambda (f . c) (lambda x (apply f (append c x)))))
> ((curry list 5 4) 3 2)
(5 4 3 2) 
```

请注意，它也适用于对一个函数进行多个参数的柯里化。

还有一个人写了一个宏，让你编写函数，当你用不足的参数调用它们时隐式地为你咖喱：[http ://www.engr.uconn.edu/~jeffm/Papers/curry.html](http://www.engr.uconn.edu/~jeffm/Papers/curry.html)

* * *

## 回答 #5

> 赞同：2
> 
> 时间：2009-06-25T15:32:31.147

我觉得你把自己搞糊涂了。Currying 一个函数接受一个 F(a1,a2,...aN) 类型的函数并将其转换为 F(a1)，它返回一个接受 a2 的函数，（它返回一个接受 a3 ......等的函数）

因此，如果您有：

```
(define F (lambda (a b) (+ a b)))
(F 1 2) ;; ==> 3 
```

您可以对它进行 curry 以制作如下所示的内容：

```
(define F (lambda (a) (lambda (b) (+ a b))))
((F 1) 2) ;; ==> 3 
```

就您的具体问题而言，这似乎很令人困惑。

```
(foo1 (sqrt 3)) 
```

似乎很合适。我建议暂时离开它并阅读更多这本书。

* * *

您实际上可以创建一个为您执行简单咖喱的函数：

```
(define (curry f x) (lambda (y) (apply f (cons x y))))
(curry = 0) ;; a function that returns true if input is zero 
```

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2013-03-04T17:51:22.983

根据您的 Scheme 实现，可能有一些实用程序能够从错误/异常中恢复，例如，在 Chicken Scheme 中，有`condition-case`.

```
(condition-case (func)
    ((exn) (print "error"))) 
```

我们可以定义一个函数，它接受任意数量的元素的函数并返回 curryed 形式：

```
(define curry
    (lambda (func . args)
        (condition-case (apply func args)
           ((exn)
               (lambda plus
                   (apply curry func (append args plus)))))])))) 
```

这有点难看，因为如果你一次使用太多参数，你永远不会得到最终结果，但这会将任何函数变成柯里化形式。

# vbscript - 查询时挂起 VBScript

> ID：694170
> 
> 赞同：-1
> 
> 时间：2009-03-29T05:46:30.057
> 
> 标签：vbscript, wmi

我从一位最近退休的同事那里继承了一段代码，该代码获取了一个盒子上的总物理内存，当我在 Windows XP 和 Server 2003 上执行以下操作时，它工作正常：

```
memSize = 0
set colItems = wmi.execQuery("select * from Win32_LogicalMemoryConfiguration")
for objItem in colItems
    memSize = memSize + objItem.TotalPhysicalMemory
next 
```

然而，在 Windows Server 2008 上，它似乎挂在`for`语句中（基于示例中未显示的每一行之后的大量调试语句）。

任何想法为什么？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-03-29T06:00:14.377

该类`Win32_LogicalMemoryConfiguration`已被弃用。请改用[Win32_OperatingSystem](http://msdn.microsoft.com/en-us/library/aa394239(VS.85).aspx)类。它应该在 Server 2008 上给出正确的结果。

我相信您感兴趣的属性是`TotalVisibleMemorySize`.

# ruby - 使用正则表达式从字符串模式中检索数字

> ID：694176
> 
> 赞同：3
> 
> 时间：2009-03-29T05:51:46.313
> 
> 标签：ruby, regex

我有一个字符串“搜索结果：找到 16143 个结果”，我需要从中检索 16143。

我正在用 ruby​​ 编码，我知道使用 RegEx 来获取它会很干净（与基于分隔符拆分字符串相反）

我如何从 ruby​​ 中的这个字符串中检索数字？

* * *

## 回答 #1

> 赞同：14
> 
> 时间：2009-03-29T16:28:37.530

```
> foo = "Search result:16143 Results found"
=> "Search result:16143 Results found"
> foo[/\d+/].to_i
=> 16143 
```

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2009-03-29T06:02:13.667

我不确定 Ruby 中的语法，但正则表达式是“(\d+)”，表示大小为 1 或更大的数字字符串。你可以在这里试试：[http ://www.rubular.com/](http://www.rubular.com/)

**更新：** 我相信语法是 /(\d+)/.match(your_string)

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2009-03-29T06:01:07.743

这个正则表达式应该这样做：

```
\d+ 
```

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2009-03-29T09:54:59.897

对于非正则表达式方法：

```
irb(main):001:0> foo = "Search result:16143 Results found"
=> "Search result:16143 Results found"
irb(main):002:0> foo[foo.rindex(':')+1..foo.rindex(' Results')-1]
=> "16143" 
```

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2009-03-29T14:48:24.090

```
 # check that the string you have matches a regular expression
 if foo =~ /Search result:(\d+) Results found/
   # the first parenthesized term is put in $1
   num_str = $1
   puts "I found #{num_str}!"
   # if you want to use the match as an integer, remember to use #to_i first
   puts "One more would be #{num_str.to_i + 1}!"
 end 
```

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2016-12-13T06:30:38.470

```
> foo = "Search result:16143 Results found"
=> "Search result:16143 Results found"
> foo.scan(/\d/).to_i
=> 16143 
```

# asp.net-mvc - 在 3 台 PC 之间共享 ASP.NET MVC Azure 项目的最佳方式？

> ID：694177
> 
> 赞同：0
> 
> 时间：2009-03-29T05:52:35.250
> 
> 标签：asp.net-mvc, visual-studio, azure

我压缩了一个 ASP.NET MVC Azure 项目并将其复制到另一台计算机（两者都有 VS 2008）。我以为我可以将它解压缩到“Doc​​uments\Visual Studio\Projects”中，但我无法让它正常工作。我的站点已构建，但浏览器看不到母版页或 Site.css。将项目作为 Zip 文件移动是否可行？

我真正的问题是，一位开发人员在 3 台不同的计算机之间共享 ASP.NET MVC Azure 项目的最佳方式是什么？我应该使用 Dropbox 还是 Live Mesh 之类的东西？或者，也许是 github？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-04-11T21:43:48.773

在这里。问题是第二台计算机上的 IIS 中未启用“静态内容”。Azure 的最新安装说明（2009 年 3 月 CTP）省略了这个关键步骤。第一台计算机最初运行 09 年 1 月的 CTP，其说明包括启用静态内容的步骤。通过压缩它们来移动项目似乎工作正常。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-03-29T06:08:24.607

我**喜欢**使用 git 和 github。我已经用它在许多计算机之间共享了我的代码。这是带有 Visual Studio 解决方案文件的 C#，因此听起来与您的情况非常相似。

当然，我喜欢用 git 来管理源代码。我会向任何人推荐它，但是如果您是新手，那么它的学习曲线还不错。我可以推荐对我有帮助的资源，因为我第一次深入研究它实际上只是大约 8 个月前。

如果您不打算采用 git 作为您的源代码管理工具，那么您可能需要查看在机器之间移动代码的其他选项。

也许您的 IIS 虚拟文件夹在机器上的配置不同？您说它可以构建，但不会运行。这表明网站本身的配置可能在 2 台机器之间有所不同（我们正在讨论一些我不知道此时 ASP MVC 是如何工作的事情）。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-03-29T09:10:14.793

是的，假设您的所有文件都在您压缩的子目录中，那么在 zip 中移动项目*应该可以*工作。有时您可能会将不在子目录中的文件添加到解决方案中，这可能会导致问题。对其他文件的引用需要是相对的，而不是绝对的。

您可能会遇到的一个问题是，如果你们俩都编辑了同一个文件，或者不小心用尚未进行该更改的开发人员机器上的一个文件覆盖了已编辑的文件。

大多数开发人员使用**源代码控制**系统来共享项目。Git 是一个相当新的，拥有越来越多的受众。Subversion 已经存在了一段时间并且非常流行。Visual Studio 与 TeamFoundation Server 集成。

ProjectLocker.com 提供免费的 subversion 托管（因此您不必设置自己的 subversion 存储库）。

Codeplex.com 为开源项目提供 Team Foundation Server 托管。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2009-03-29T09:15:01.630

如果 app-root 不是应用程序，或者应用程序没有正确处理虚拟目录，这听起来像是您看到的那种类型。

使用虚拟机；例如，你应该很少使用“/foo/bar”——因为如果你的应用程序没有安装在站点根目录下，你会得到意想不到的行为——你的意思是“~/foo/bar”，但这通常需要额外的代码，[正如这里所讨论的](https://stackoverflow.com/questions/347528/using-scripts-in-a-master-page-with-asp-net-mvc)。

# asp.net - 除了 `dropdownlist` 之外，ASP.NET 中是否有任何内置控件来显示时间？

> ID：694186
> 
> 赞同：0
> 
> 时间：2009-03-29T06:03:06.740
> 
> 标签：asp.net, vb.net

我想显示从早上 8 点到晚上 7 点的时间，间隔 15 分钟。所以：

*   8.15AM
*   8.30AM
*   8.45AM
*   早上9点
*   9.15AM
*   上午 9.30

在下拉列表中。`dropdownlist`除了显示时间之外，ASP.NET 中是否有任何内置控件？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-03-29T06:23:30.497

没有任何东西可以显示时间，您需要在下拉列表中进行。从可用性的角度来看，我倾向于将它分成一个小时的列表和 15 分钟的间隔。根据您的设计，您可能将列表的值存储在数据库中，因此可以将表绑定到列表，或者只是在后面的代码中实现一个循环并以编程方式添加列表项。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-03-29T06:23:38.233

你可以在[eworldui](http://www.eworldui.net/CustomControls/TimePickerDemo.aspx)或[codeproject](http://www.codeproject.com/KB/aspnet/DateAndTimePicker.aspx)上找到一些东西。 搜索“asp.net time picker”也会发现其他一些东西。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2009-03-29T06:24:46.733

要填写您的下拉列表，您可以尝试以下操作：

```
Dim dt As DateTime = #8:00:00 AM#

For i As Integer = 0 To 44
    DropDownList1.Items.Add(dt.ToString("hh:mmtt"))
    dt = DateAdd(DateInterval.Minute, 15, dt)
Next 
```

# linux - write() 系统调用何时写入所有请求的缓冲区而不是仅执行部分写入？

> ID：694188
> 
> 赞同：7
> 
> 时间：2009-03-29T06:04:38.250
> 
> 标签：linux, unix

如果我指望我的 write() 系统调用来写入例如 100 个字节，我总是将该 write() 调用放在一个循环中，以检查返回的长度是否是我期望发送的长度，如果不是，它会碰撞缓冲区指针并将长度减少写入的数量。

所以我又一次这样做了，但是现在有了 StackOverflow，我可以问你们大家是否知道我的写什么时候会写出我要求的所有内容，而不是给我部分写？

附加评论：X-Istence 的回复提醒我，我应该注意到文件描述符是阻塞的（即，不是非阻塞的）。我认为他建议阻塞文件描述符上的 write() 不会写入所有指定数据的唯一方法是 write() 被信号中断时。这对我来说似乎至少有直观的意义......

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2009-03-29T06:56:58.280

write 可能会返回部分写入，尤其是使用套接字上的操作或内部缓冲区已满时。很好的方法是执行以下操作：

```
while(size > 0 && (res=write(fd,buff,size))!=size) {
    if(res<0 && errno==EINTR) 
       continue;
    if(res < 0) {
        // real error processing
        break;
    }
    size-=res;
    buf+=res;
} 
```

永远不要转述*通常*发生的事情...

注意：如果是完整磁盘，您将获得 ENOSPC 而不是部分写入。

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2009-03-29T07:00:11.750

您需要检查 errno 以查看您的调用是否被中断，或者为什么 write() 提前返回，以及为什么它只写入了一定数量的字节。

从[男人 2 写](http://www.freebsd.org/cgi/man.cgi?query=write&apropos=0&sektion=2&manpath=FreeBSD+7.1-RELEASE&format=html)

> 在对象（例如受流控制的套接字）上使用非阻塞 I/O 时，write() 和 writev() 写入的字节数可能少于请求的字节数；必须记下返回值，并在可能的情况下重试剩余的操作。

基本上，除非您正在写入非阻塞套接字，否则唯一会发生这种情况的情况是您被信号中断。

> [EINTR] 一个信号在写入完成之前中断了写入。

有关可以返回什么以及何时返回的更多信息，请参见[手册页中的错误部分。](http://www.freebsd.org/cgi/man.cgi?query=write&apropos=0&sektion=2&manpath=FreeBSD+7.1-RELEASE&format=html)从那里您需要确定错误是否严重到足以记录错误并退出，或者您是否可以继续手头的操作！

这一切都在[Marc J. Rochkind 的《高级 Unix 编程](https://rads.stackoverflow.com/amzn/click/com/0131411543)》一书中进行了讨论，我在这本书的帮助下编写了无数程序，并在为类似 UNIX 的操作系统编程时建议使用它。

* * *

## 回答 #3

> 赞同：-2
> 
> 时间：2009-03-29T06:31:22.227

写入不应该有任何理由写入部分缓冲区 afaik。我可以想到的部分写入的可能原因是，如果您的磁盘空间不足，您正在写入超过块设备的末尾，或者您正在写入 char 设备/某种其他类型的设备。

但是，盲目重试写入的计划可能不是一个好的计划 - 检查 errno 以查看您是否应该先重试。

# php - 带双引号和单引号的字符串

> ID：694190
> 
> 赞同：1
> 
> 时间：2009-03-29T06:06:24.517
> 
> 标签：php

我有一个这样的双引号字符串

```
$count = 5;
$str = "result: $count";
echo $str; //result: 5 
```

变量解析效果很好，我的问题是 $count var 必须在 $str 之后定义

```
$str = "result: $count";
$count = 5;
echo $str; //result: 
```

所以我将使用单引号并在这里提出一个问题，以便在我想要的时候找到一种解析 var 的方法

```
$str = 'result: $count';
$count = 5;
//TODO: parse var process
echo $str; //result: 5 
```

我不会使用正则表达式替换。

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2009-03-29T06:38:07.530

对于这种类型的事情，我可能会使用字符串格式。在 PHP 中，就是[printf](http://us.php.net/sprintf)。

```
 ?php
$str="result: %d"
....dostuff.....define $count.....
printf($str,$count)
? 
```

编辑：虽然，最好的方法可能部分取决于为什么你必须在 $count 之前定义 $string。

如果它是一个重复很多的字符串，并且您想将其放入全局变量或其他东西中，那么 printf 将是我的选择，或者将其放入其他答案所建议的函数中。

如果字符串只使用一次或两次，你确定不能重构代码让$count在$string之前定义吗？

最后，有点乏味的理论：当你写 '$string = "result: $count"' 时，PHP 会立即获取 $count 的值并将其放入字符串中。之后，就 $string 而言，它不再担心 $count，即使 $count 发生变化，$string 也不会，因为它包含值的文字副本。据我所知，没有一种将字符串中的位置绑定到尚未定义的变量的方法。'printf' 方法在字符串中留下占位符，当您决定应该在占位符中放置什么时，函数 printf 将其替换为值。

所以，如果你只想写 $string = "result: $count" $count=5 $echo string

（并且不必调用另一个函数）

并得到“结果：5”，没有办法做到这一点。最接近的方法是使用占位符和 printf，但这需要显式调用函数，而不是隐式替换。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-03-29T06:37:34.473

为什么不使用函数？

```
function result_str($count) { return "result: $count"; } 
```

* * *

## 回答 #3

> 赞同：-2
> 
> 时间：2009-03-29T06:32:48.667

preg_replace 是最简单的方法。像这样的东西：

```
$str = preg_replace("/\\$([a-z0-9_]+)/ie", "$\\1", $str); 
```

但是如果你真的不想使用正则表达式，那么你将不得不手动解析字符串，提取变量名，然后替换它。

# python - 坏泡菜得到错误

> ID：694192
> 
> 赞同：0
> 
> 时间：2009-03-29T06:08:20.393
> 
> 标签：python, pickle

我一直在使用一个名为 Mnemosyne 的闪存卡程序，它使用 python 脚本。不久前，我的电脑死机后，我的闪存卡数据库无法访问，我不得不手动关闭它。每当我尝试加载包含我的卡的数据库时，我都会收到此错误。

```
文件格式无效
Traceback（最里面的最后一个）：
文件“mnemosyne\core\mnemosyne_core.pyc”，第 1012 行，在 load_database
BadPickleGet: 577"

```

帮助将不胜感激。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-03-30T03:40:52.643

（虽然 CLayton 的副本可能是二进制发行版，但 mnemosyne 的源代码是免费提供的。）

但这并没有多大帮助：第 1012 行只是：

```
db = cPickle.load(infile) 
```

其中“infile”是存储的数据库文件。所以你的数据库文件中有一些损坏。（BadPickleGet 是 UnpicklingError 的特定子类，这是您在输入中断时所期望的。）

您可以更改 mnemosyne_core.py 以使用普通的 Python pickle 模块而不是 cPickle，从而允许您向 pickle.py 添加调试并准确计算出它不喜欢的文件中的内容。但老实说，如果文件由于硬件故障/硬断电而损坏，则内容可能会被截断、无法读取或完全是垃圾。

准备好再次经历那些早期的卡片......

# eclipse - 将 Eclipse 的本地历史与 Time Machine (Mac) 集成

> ID：694196
> 
> 赞同：3
> 
> 时间：2009-03-29T06:12:46.093
> 
> 标签：eclipse, macos, timemachine

Eclipse 具有非常漂亮的“与本地历史比较”功能，它可以让您将工作区中的所有文件与以前的版本进行比较。即使旧版本不在源代码控制系统中，这对于恢复旧版本也非常有用，而且它之所以有效，是因为 Eclipse 会在您保存所有文件时保留它们的快照。

Eclipse（默认情况下）最多保留一周，每个文件最多保留 50 次更改和最多 1 MB 的快照数据。

在 Mac 上，您还拥有 Time Machine 备份，它每小时对每个文件进行一次快照，保留一天的每小时快照、一个月的每日快照和每周的快照，直到磁盘空间用完。

除了 Eclipse 存储的副本之外，是否有 Eclipse 插件可以将 Time Machine 数据用于本地历史记录？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2010-07-16T05:35:10.753

不，似乎没有，而且特定于 mac 的插件相对较少。您的选择基本上是使用内置功能来恢复您的整个工作区（痛苦）或按原样使用内置功能。

这类似于您对 VMWare 快照的选择。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-04-04T01:10:04.423

Eclipse 的本地历史存储在您工作区的 .metadata 目录中，因此从技术上讲，您可以使用 Time Machine 回到整个工作区的先前版本。不过，不确定这是否是您真正想要的。

但是，eclipse 存储的数量可以在首选项中配置。所以我建议你只选择你觉得你需要的东西。

# linq - linq 聚合

> ID：694200
> 
> 赞同：5
> 
> 时间：2009-03-29T06:21:30.050
> 
> 标签：linq, aggregate

```
class Category
{        
    public string Name { get; set; }
    public int Count { get; set;}
}

Name Count
AA   2
BB   3
AA   4 
```

我有一个`IEnumerable<Category>`

并希望获得具有唯一名称的类别列表和多个条目的总和

**输出**

```
Name Count
AA   6
BB   3 
```

**更新**

```
class Category 
{ 
public string Name { get; set; } 
public int CountA { get; set;} 
public int CountB { get; set;} 
public string Phone { get; set;} 
} 
```

我将如何总结两列。并且电话列可以是最后一行或任意行

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2009-03-29T07:54:50.480

您更新的问题在电话号码方面并不完全清楚，但我怀疑您想要类似的东西：

```
 var query = from category in list
                group category by category.Name into grouped
                select new { Name = grouped.Key,
                             SumA = grouped.Sum(x => x.CountA),
                             SumB = grouped.Sum(x => x.CountB),
                             Phone = grouped.Last().Phone }; 
```

顺便说一句，更改`grouped.Last()`为`grouped.First()`会更有效率。

以这种方式评估多个聚合通常不是非常有效。我和 Marc Gravell 开发的[Push LINQ](http://msmvps.com/blogs/jon_skeet/archive/2008/01/04/quot-push-quot-linq-revisited-next-attempt-at-an-explanation.aspx)项目以不那么容易使用为代价使其效率更高。如果您需要处理大量数据，您可能需要研究它。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-03-29T06:28:42.810

```
var foo = new List<Category>() { 
                new Category() { Name = "AA", Count = 2},
                new Category() { Name = "BB", Count = 3},
                new Category() { Name = "AA", Count = 4}
            };

            var bar = foo.GroupBy(c => c.Name).Select(g => new Category(){ Name = g.Key, Count = g.Sum(c => c.Count) }); 
```

# windows - 在 Windows 批处理文件中控制 psftp

> ID：694203
> 
> 赞同：11
> 
> 时间：2009-03-29T06:24:14.067
> 
> 标签：windows, batch-file

如何编写批处理文件来控制 psftp，但使用动态文件名？总的来说，我正在尝试转换视频文件，然后将其上传到我的 Apple TV。这是我所拥有的，它通常可以工作，但命令不控制 psftp，psftp 只是等待用户输入：

```
echo Convert and Upload to Apple TV file Called %1.mkv

ffmpeg -i %1.mkv -vcodec mpeg4 -acodec ac3 -ab 384k -sameq -s hd720 -t 60 %1.avi

psftp frontrow@192.168.1.50 -pw aaa
cd downloads/boxee
put %1.avi
quit 
```

我知道使用 -b 标志 psftp 可以调用它自己的批处理文件，但我不知道如何获取 %1 参数。我见过将文本文件重定向到 psftp 的解决方案，但也遇到了同样的问题。另外，我更喜欢只有一个文件，但必须调用第二个文件也可以。

* * *

## 回答 #1

> 赞同：15
> 
> 时间：2009-05-16T22:15:09.687

我最终从主文件创建了一个新的批处理文件，然后我告诉 psftp 使用：

```
echo cd downloads/boxee > psftp.bat
echo put "%1.avi" >> psftp.bat
echo quit >> psftp.bat

psftp frontrow@192.168.1.50 -pw aaa -b psftp.bat 
```

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2011-01-20T05:48:25.517

指定包含批处理命令的文件

在正常操作中，PSFTP 是一个交互式程序，它显示命令行并接受来自键盘的命令。

如果您需要使用 PSFTP 执行自动化任务，您可能更愿意提前指定一组命令并让它们自动执行。-b 选项允许您执行此操作。您可以将它与包含批处理命令的文件名一起使用。例如，您可以创建一个名为 myscript.scr 的文件，其中包含如下行：

```
cd /home/ftp/users/jeff
del jam-old.tar.gz
ren jam.tar.gz jam-old.tar.gz
put jam.tar.gz
chmod a+r jam.tar.gz
quit 
```

然后你可以通过键入来运行脚本

```
psftp user@hostname -b myscript.scr 
```

归功于[http://the.earth.li/~sgtatham/putty/0.52/htmldoc/Chapter6.html#6.1.3](http://the.earth.li/~sgtatham/putty/0.52/htmldoc/Chapter6.html#6.1.3)

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2013-11-07T15:52:01.637

全部在一个文件中：

```
@echo off
echo Convert and Upload to Apple TV file Called %1.mkv
ffmpeg -i %1.mkv -vcodec mpeg4 -acodec ac3 -ab 384k -sameq -s hd720 -t 60 %1.avi
(
echo cd downloads/boxee
echo put %1.avi
echo quit
) | psftp frontrow@192.168.1.50 -pw aaa -bc 
```

如果我们需要精确的端口号：

```
psftp frontrow@192.168.1.50 -P 222 -pw aaa -bc 
```

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2009-03-29T06:46:01.940

为什么不用windows自带的内置FTP命令呢？

您将需要编写一个将上传文件的脚本：

> *打开 192.168.1.50
> 用户
> frontrow aaa
> put file.avi
> 退出*

然后调用***ftp*** *-s:MyScript*

您需要使用 echo 和 >> 重定向器为每个文件生成脚本。

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2015-08-26T16:46:02.147

我正在努力运行一个简单的批处理文件/脚本，让最终用户将她刚刚编辑的文件上传到安全的 FTP 站点。

使用此脚本：

```
cd /outgoing
put Examplefile.txt
# chmod a+r Examplefile.txt
# ren Examplefile.txt Exam.ted
# rm Examplefile.txt
quit 
```

并从标准 Windows 命令提示符运行 PuTTY 的 sftp 命令：

```
psftp user@ftp.address.com -pw password -b testscript.scr 
```

我能够快速且（更重要的是！！）轻松地将我正在工作的公司的文件上传到我们需要与之进行业务往来的公司。您还可以看到我已准备好在需要时重命名文件 ( `ren`) 或在需要时删除文件 ( `rm`)。井号 ( `#`) 将这些行设置为备注行。

这使我能够在 Windows 中创建一个完整的批处理文件，最终用户可以在生成文件时简单地单击它来上传文件。它比使用我在网络上找到的其他一些 sftp“风格”简单得多，而且我几十年来一直使用并信任 PuTTY。

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2013-12-10T18:24:46.550

如果您对 ftp 所做的只是上传单个文件，则可以使用[pscp](http://www.chiark.greenend.org.uk/~sgtatham/putty/download.html)。

```
echo Convert and Upload to Apple TV file Called %1.mkv

ffmpeg -i %1.mkv -vcodec mpeg4 -acodec ac3 -ab 384k -sameq -s hd720 -t 60 %1.avi
pscp -pw aaa -sftp %1.avi frontrow@192.168.1.50:/downloads/boxee 
```

# marquee - 在显示数据内幕字幕方面需要帮助

> ID：694205
> 
> 赞同：0
> 
> 时间：2009-03-29T06:27:00.987
> 
> 标签：marquee

我想在我的银行应用程序的选取框标记内显示新闻，但它没有发生。请有人帮我看看我的代码有什么错误。这是我的代码：

```
<marquee bgcolor="silver" direction="left" id="marq1" runat="server" behavior="scroll" scrolldelay="80" style="height: 19px" width="565">
<% 
   String se = Session["countnews"].ToString();
   for (int i = 0; i < int.Parse("" +se); i++)
   { %>
       <strong><%Response.Write("&nbsp;&nbsp;" + Session["news"+i] + "&nbsp;&nbsp;"); %></strong>
<% } %>
</marquee>

public class News
{
    DataSet ds = new DataSet("Bank");
    SqlConnection conn;
    String check;
    SqlDataAdapter sda;
    int i;
    public string News_Name;
    public int Count_News;
public int newsticker()
    {
        conn = new SqlConnection(ConfigurationManager.ConnectionStrings["BankingTransaction"].ConnectionString.ToString());
        check = "Select NewsTitle from News where NewsStatus = 'A'";
        sda = new SqlDataAdapter(check, conn);
        sda.Fill(ds, "News");
        if (ds.Tables[0].Rows.Count > 0)
        {
            for (i = 0; i < ds.Tables[0].Rows.Count; i++)
            {
                News_Name =i+ ds.Tables[0].Rows[i].ItemArray[0].ToString();
            }
            Count_News = ds.Tables[0].Rows.Count;        }
        else
        {
            News_Name =0+ "Welcome to WestSide Bank Online Web site!";
            Count_News = 1;
        }
        return int.Parse(Count_News.ToString());       
    }

protected void Page_Load(object sender, EventArgs e)
    {
        News obj = new News();
        try
        {
            obj.newsticker();
            Session["news"] = obj.News_Name.ToString();
            Session["countnews"] = obj.Count_News.ToString();       
        }
        catch (SqlException ex)
        {
            Response.Write("Error in login" + ex.Message);
            Response.Redirect("Default.aspx");
        }
        finally
        {
            obj = null;
        } 
    } 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2009-03-30T15:41:50.520

> 会话["新闻"+i]

但是您没有将任何称为“新闻”加整数的内容放入 Session 范围内。您正在迭代数据集并将每个标题（神秘地以整数作为前缀）存储为单个 News 对象中的“News_Name”属性。每次写入“News_Name”都会覆盖前一个，因此只有最后一个标题存储在 Session[“news”] 的末尾。

在任何情况下，Session 是存储每页数据的麻烦地方：Session 用于在多个页面加载后持续存在的数据，如果用户同时加载两个页面，则可能会产生干扰。

此外，如果新闻的标题可能包含“ <' 其中的人物。而且我不太确定你为什么要使用'newscount'整数，将其转换为字符串，再次将其转换为字符串，再次将其转换为字符串，然后最终将其解析回整数。（？）

一般来说，这似乎是经典 ASP 和代码隐藏技术的一种令人不安的组合。在我看来，应该可以使用以下内容更简单地编写它：

```
<asp:Repeater DataSourceID="TickerSource" runat="server">
    <ItemTemplate><strong>
        <%# Eval("NewsTitle") %>
    </strong></ItemTemplate>
</asp:Repeater>

<asp:SqlDataSource ID="TickerSource" runat="server"
    SelectCommand="SELECT NewsTitle FROM News WHERE NewsStatus='A'"
    ConnectionString="<%$ ConnectionStrings:BankingTransaction %>"
/> 
```

[免责声明：我一生中从未真正编写过一行 ASP.NET，因此这可能无法按原样工作。欢迎更多精通 .NET 的用户进行编辑。]

# sql-server - 在 Sql Server 中存储 UInt32 的最佳方法

> ID：694211
> 
> 赞同：4
> 
> 时间：2009-03-29T06:31:44.707
> 
> 标签：sql-server, casting, types

我正在开发一个使用第三方组件的应用程序，该组件返回一个 UInt32 类型的值。

我需要将此 UInt32 存储在 Sql Server 表中。我正在考虑只使用一个简单的 int 列并插入这样的值：

```
int value = (int)(cs - int.MaxValue); 
```

但我不确定这是否是完成此类任务的最佳方式。

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2009-03-29T08:11:05.653

1.  使用 bigint 或 decimal(10,0) 列并定义检查约束以确保它在 0 到 40 亿之间。

2.  定义 CLR 数据类型

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2009-03-29T06:41:59.203

我建议您将其存储在 bigint 列中。

* * *

## 回答 #3

> 赞同：-1
> 
> 时间：2009-03-29T06:49:15.427

您可能应该使用 + int.MinValue。对于 32 位有符号整数，最大值为 2147483647，最小值为 -2147483648。零从正面窃取一个值。

# c# - MOSS：从模板创建站点时运行代码？

> ID：694212
> 
> 赞同：1
> 
> 时间：2009-03-29T06:31:57.717
> 
> 标签：c#, asp.net, sharepoint, moss

在 MOSS 2007 中，有没有一种方法可以插入我编写的一段代码，每次我从现成的模板创建网站时运行？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2009-03-29T12:44:33.233

是的，你当然可以。几个月前我写了一篇关于这个的帖子。您有两种选择，一种是具有功能激活处理程序的功能，另一种是在您的站点定义 webtemp*.xml 文件中使用 ProvisionAssembly。后者也是 MOSS 进行发布门户多站点设置的方式。

几个月前我写了一篇短文：http: [//furuknap.blogspot.com/2008/06/question-from-forum-post-at-httpwww.html](http://furuknap.blogspot.com/2008/06/question-from-forum-post-at-httpwww.html)

.b

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2009-03-29T07:37:17.807

你应该用一个特性来做，并给它一个包含你的代码的特性接收器。将该功能附加到站点模板。如果您自己制作了模板，您可以简单地将其添加到其 onet.xml。如果它是标准模板，您可以使用功能装订，它将您的新功能连接到现有站点模板。

请注意，在任何一种情况下，您的代码都不会在已经存在的网站上运行，（除非您在那里手动激活该功能。）

# graph - Munin：有没有可能恢复丢失的图表？

> ID：694215
> 
> 赞同：2
> 
> 时间：2009-03-29T06:34:31.360
> 
> 标签：graph, munin

我对 munin 的工作原理不是很熟悉，所以如果这很明显，我深表歉意。

我现在已经在我的几个项目中使用了 munin，我已经两次遇到这种情况，我将丢失从过去事件生成的所有 munin 图。这只是今天下午发生在我身上。现在，我只有今天下午以来所有系统事件的跟踪记录。

这些图表可以恢复吗？是否有数据存储在用于生成这些图表的某处？

如果它无法恢复，我想知道是什么可能导致这种情况发生。当然，每次发生这种情况时，我都在搞乱我的 munin 配置设置。对于这种情况，我正在添加新的服务器以由 munin 记录...我不知道这样做会如何导致 munin 丢失我其他服务器上的所有数据。

谢谢。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-05-04T10:20:39.800

数据是从 .rrd 数据库生成的，这些数据库在“munin-update”期间更新（通常从“munin-cron”调用）。您可以在 munin.conf（我的站点上的 /var/db/munin）中的 'dbdir' 指定的目录中找到这些文件。如果您的图表仅显示今天下午以来的事件，我的猜测是 .rrd 文件已被删除/重新创建/损坏。您应该能够从备份中恢复它们，然后调用“munin-graph”和“munin-html”。请参阅这些命令的相应手册页。

# asp.net - 在 ASP.NET MVC 中我不能做的事情

> ID：694226
> 
> 赞同：11
> 
> 时间：2009-03-29T06:44:19.387
> 
> 标签：asp.net, asp.net-mvc, webforms

有一些我不能用 ASP.NET MVC 做的事情吗？只有使用 ASP.NET WebForms 才能实现的事情，还是使用 WebForms*非常*容易？

我们考虑将 ASP.NET MVC 用于新项目。但我想知道与 WebForms 相比，是否有一些明显的事情我们将无法使用 ASP.NET MVC 来完成，或者我们将不得不花费大量时间使用 ASP.NET MVC 的地方。

* * *

## 回答 #1

> 赞同：14
> 
> 时间：2009-03-29T07:17:28.230

最大的一个是在您的表单上使用现有的 3rd 方控件。大多数内置控件很容易复制，但如果您有一个宠物 3rd 方控件，您可能必须在常规（非 MVC）aspx 页面上托管它（幸运的是，这是支持的）。

同样，“Web 部件”

此外 - ASP.NET 为不同的客户端（移动设备等）使用不同的 html 的特性变得......不同；您不想手动执行此操作，但实际上大多数客户端现在都使用标准 html，因此这首先不是问题。

有些东西，比如通过 resx 文件的 i18n 需要比 vanilla MVC 模板中的额外工作，但示例在 Internet 上。

一点... MVC 仅授权用于 MS/ASP.NET；所以你不能做的一件事（不违反条款，据我所知）是在 mono/Apache 中运行它——但是 IANAL。

现在考虑一下你**可以**用 MVC 做的事情，而你不能（或者很难）用 vanilla 做的事情：

*   路由而不是页面
*   自动输入解析（动作参数）
*   正确的html控制...
*   ...为简单的 AJAX 启用 jQuery 等
*   关注点分离
*   可测试性
*   IOC/DI
*   多个模板选项（不仅仅是 aspx/ascx）

* * *

重新输入分辨率：

```
public ActionResult Show(string name, int? page, int? pageSize) {...} 
```

将从（任何）路由、查询字符串或表单中选择“名称”、“页面”和“页面大小”——因此您不必花费大量时间挑选请求值。

重新模板 - aspx/ascx 不是唯一的模板选项。例如，请参见[此处](https://stackoverflow.com/questions/173207/best-template-engine-for-asp-net-mvc)；或者，如果您愿意，也可以自己编写...视图根本不绑定到 ASP.NET**控件**。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2009-03-29T12:14:46.707

验证不像在 WebForms 中那么容易。在 Webforms 中，您可以添加一个验证器并设置一个启用客户端验证的属性。您可以本地化错误消息。本地化工作在客户端和服务器端。

MVC 中没有开箱即用的客户端验证，您需要找到一种方法来本地化客户端错误消息。

本地化本身是不同的。显然，默认情况下每页不存在资源，因为没有页面。但是有一个好方法可以让每个视图都有资源。

我仍然没有检查是否可以为每个文件夹设置 SSL-required。

**编辑**

MVC3 的情况有所不同。现在有一个很好的验证支持。

还有一些东西没有在 MVC 中实现。对我来说最大的问题是甜甜圈兑现和部分兑现的完整实现。MVC3 在这方面有一些改进，但仍然不完整。无论如何，请继续关注：MVC 团队接缝意识到这是他们应该做的事情。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2009-03-29T07:14:30.517

最大的是控件。用户控件不适用于 ASP.NET MVC。我什至尝试使用这样的代码：

```
new Label().RenderControl(...ResponseStream...); 
```

没有骰子。

当然，作为其中的一部分，不需要视图状态，所以它不在那里。

不过，服务器控件确实有效。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2009-03-29T06:47:03.670

我认为 MVC 中不存在视图状态。除了非 MVC 项目中的内置视图状态之外，您将不得不以其他方式跟踪自己的视图状态。

编辑：根据评论：“*摆脱 ViewState 是一种优势而不是劣势*”。– 克雷格

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2009-03-29T10:10:52.290

正如 Marc 所说，不能使用第三方工具和（服务器端）网络控件。因此，通过在表单上拖放一些控件（如网格和数据访问控件）来快速将某些东西拼凑在一起不再是一种选择。

但是通过代码生成等，您仍然可以快速制作一些东西。如果您需要快速的东西，您仍然可以选择上述选项。

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2010-02-06T08:26:52.253

ASP.NET Ajax 不适用于 ASP.NET MVC，因此没有 UpdatePanel（由于缺少回发）。幸运的是，有内置的 ajax (Ajax.Form) 可用于执行部分更新，更不用说 Visual Studio 项目模板默认附带的 jQuery。

# architecture - 设计和建筑有什么区别？

> ID：694234
> 
> 赞同：11
> 
> 时间：2009-03-29T06:51:05.347
> 
> 标签：architecture, ooad

这两个术语非常分散。它们到底有什么不同？

是否有任何现实生活中的例子或场景可以详细说明这种差异？

* * *

## 回答 #1

> 赞同：10
> 
> 时间：2009-03-29T07:15:45.427

请参阅[架构](http://en.wikipedia.org/wiki/Software_architecture)和[设计](http://en.wikipedia.org/wiki/Software_design)。

> 程序或计算系统的软件架构是系统的一个或多个结构，它包括软件组件、这些组件的外部可见属性以及它们之间的关系。[...] 记录软件架构有助于利益相关者之间的沟通，记录有关高级设计的早期决策，并允许在项目之间重用设计组件和模式。

--

> 软件设计是解决问题和规划软件解决方案的过程。在确定了软件的用途和规格后，软件开发人员将设计或聘请设计人员制定解决方案的计划。它包括低级组件和算法实现问题以及架构视图。

--

因此它们彼此共享部分，但它们指的是软件的略有不同的方面。从技术上讲，架构应该包括[所有方面](http://en.wikipedia.org/wiki/4%2B1)，但实际上它们通常是指软件的高级拓扑或结构。例如，决定是否将系统实现为基于文件的命令行软件、Web 应用程序或[n 层](https://stackoverflow.com/questions/312187/what-is-n-tier-architecture/312197)富互联网应用程序将是一个架构决策。

`address1`软件设计包括制定架构决策，但它会包括更深层次的决策，例如数据库中应该有多少字符，这并不是真正的架构决策。

**编辑**：为了简化差异，架构是指已知的软件解决方案模式，通常涉及子组件/层/层之间的放置和关系。这些模式还指定了数据的存储、处理和呈现方式和位置。架构是可以使用方框和箭头来描述的东西，例如[自主机器人范式](http://en.wikipedia.org/wiki/Robotic_paradigms)。

软件设计是考虑给定软件需求的解决方案的过程。每个问题都有其独特的方式，因此设计会有所不同。

* * *

## 回答 #2

> 赞同：5
> 
> 时间：2009-03-29T07:04:17.483

在我的理解中，设计更针对一个系统。两个系统可以具有*相似*的设计但共享*相同*的架构。

因此，设计定义了如何将所选架构应用于给定的需求。（或类似的东西）

但这更像是我的一种感觉，所以我对其他答案很感兴趣......

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2010-12-17T10:02:49.083

可以这样想：建造房子，你从建筑师（Architect）那里得到一张蓝图。然后建设者使用这个蓝图并决定（设计师）需要多少柱子，使用什么样的水泥和砖块，需要做什么样的着色等等。这些都是设计决定。然后工人接受建筑商的订单并建造房屋（编码器）。

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2009-03-29T07:29:34.940

我对此的看法..

*   **设计**是计划如何构建软件的过程

*   **架构**是代码库结构的现实。如果您的代码不是结构化的，您就不能真正声称拥有架构。

理想情况下，您会从设计阶段（或代码库生命周期中的一系列设计阶段）获得架构，但有时好的架构可以来自重构的持续增量改进，并且只是一种做“正确”的感觉。

这些不是正式定义的词；）

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2013-12-18T11:12:22.630

体系结构是指计算机或基于计算机的系统的概念结构和逻辑组织。

设计是指为显示系统或对象在制造之前的外观和功能或工作原理而制作的计划或图纸。

如果您正在“构建”一个组件，那么您就是在定义它在更大系统中的行为方式。如果您正在“设计”相同的组件，那么您就是在定义它在内部的行为方式。

所有架构都是设计，但并非所有设计都是架构。

`How`部分是设计，`What`是`How`建筑 的交集![用于区分建筑和设计的图像](https://i.stack.imgur.com/SeqZ6.png)

还有一些设计决策，在架构上并不重要，即不属于设计的架构分支。例如，某些组件的内部设计决策，例如算法的选择、数据结构的选择等。任何在其组件边界之外不可见的设计决策都是组件的内部设计，并且是非架构的。这些是系统架构师将留给模块设计人员或实施团队的设计决策，只要他们的设计不破坏系统级架构施加的架构约束。

给出一个[很好的类比的链接](http://iankoenig.com/blog/2009/03/21/the-difference-between-architecture-and-design/)

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2009-03-29T12:27:12.743

架构是设计好的。但不是反过来。“架构”通常用于识别和命名大型（多层）系统的设计。根据定义，系统是多个组件或子系统的协作。人们可能称其为“系统设计”或仅称为“设计”，但由于某种原因，架构赋予它更公正的权重，因为它要求与其子系统或组件的设计有所不同。

* * *

## 回答 #7

> 赞同：0
> 
> 时间：2016-09-27T06:05:03.990

架构是组件以及它们之间的关系。例如，当您从一千米高处看到建筑物时，您只能看到连接的路径和房间。但是在设计中描述了房间内的内容。

* * *

## 回答 #8

> 赞同：-1
> 
> 时间：2015-05-10T01:24:59.597

设计是一个计划，你将如何做到这一点。架构师是你如何实现的。1.就其阶段、职责范围和决策级别而言 2.架构是框架、工具、语言、范围、目标和高级方法论方面的更大图景，而设计是实现方法论的较小图景，具有系统不同部分的外观、设计模式、编程习惯、重构和代码组织方式的局部约束。3.架构面向更高层次的战略、结构和目的。设计是战术性的，面向实施和实践，更面向具体。

# mysql - Mysql查询不起作用

> ID：694252
> 
> 赞同：0
> 
> 时间：2009-03-29T07:13:34.667
> 
> 标签：mysql, group-by, inner-join

我有三个结构如下的表：http: [//i41.tinypic.com/2bt9aq.png](http://i41.tinypic.com/2bt9aq.png)

我要做的是检索某个类别中所有笑话的笑话 ID、标题和平均评分，并按字母顺序排列它们。我有这个查询：

```
$result = mysql_query("
SELECT jokedata.id AS joke_id,
jokedata.joketitle AS joke_title,
SUM(ratings.rating) / COUNT(ratings.rating) AS average
FROM jokedata
INNER JOIN ratings ON ratings.content_type = 'joke' AND ratings.relative_id = jokedata.id
WHERE jokecategory = '$cur_category'
GROUP BY jokedata.id
ORDER BY jokedata.joketitle
LIMIT $offset, $jokes_per_page
"); 
```

但是，它没有选择任何笑话。

该查询有什么问题？谢谢你。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-03-29T07:40:18.533

首先，您可能想要使用`AVG()`而不是`SUM()/COUNT()`.

您的问题是内部联接 - 如果没有为笑话提交评分，则不会返回该笑话，因为只有评分值与内部联接匹配的笑话。

我建议改用左连接，甚至是子选择。虽然我通常更喜欢`JOIN`s 因为它们通常更快，但我会尝试这样的事情：

```
SELECT id AS joke_id,
joketitle AS joke_title,
(
    SELECT AVG(rating) AS avgrating FROM ratings
    WHERE content_type = 'joke' AND relative_id = joke_id
    GROUP BY relative_id
) AS average
FROM jokedata
WHERE jokecategory = '$cur_category'
GROUP BY id
ORDER BY joketitle
LIMIT $offset, $jokes_per_page 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-03-29T07:36:56.547

如果无法完成其中一个连接，则内部连接将不会返回一行。因此，标准`ratings.relative_id = jokedata.id`导致查询返回 0 个笑话的可能性很大。尝试替换`INNER JOIN`with `LEFT JOIN`，您会看到有多少`jokedata`' 行没有匹配`id`的 ' in `ratings.relative_id`。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-03-29T08:35:12.367

我将首先通过取出除连接之外的所有内容并查看结果来缩小问题范围：

SELECT * FROM jokedata INNER JOIN rating ON rating.content_type = 'joke' AND rating.relative_id = jokedata.id

如果这给了你结果，我会添加回 WHERE 标准。一步一步地执行此操作，每当您获得没有返回行的查询时，请查看前一组结果，并考虑添加其他条件时发生的情况。能够看到这组“中间”结果将帮助您识别和理解问题。

继续逐段添加回查询，直到您开始没有结果，至少您已经缩小到查询的哪个方面导致问题。

# .htaccess - .htaccess：如何只重写 .php URL？

> ID：694264
> 
> 赞同：2
> 
> 时间：2009-03-29T07:26:20.423
> 
> 标签：.htaccess, mod-rewrite

我有条件的重写工作正常，如下所示：

[http://www.sitename.com/index.php?n=text](http://www.sitename.com/index.php?n=text)重定向到 [http://www.sitename.com/pages/text](http://www.sitename.com/pages/text)

并且页面正确呈现，但是，存在一个问题，即重定向 URL 的参数也会添加到 URL。所以实际上在地址栏中它看起来像 -

[http://www.sitename.com/pages/text?n=text](http://www.sitename.com/pages/text?n=text)

有人可以帮我吗？htaccess 代码如下所示。

```
RewriteCond %{QUERY_STRING} ^n=(.*)$
RewriteRule index.php http://www.sitename.com/pages/%1 [r=301,nc] 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-03-29T07:50:05.280

你可能想抓住“ `index.php.*`”。否则 mod_rewrite 只会用新`index.php`的 URL 替换 URL 的“部分`index.php?n=text`”。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-03-30T05:25:15.947

格斯，

根据您的建议，我将其重建如下：

```
RewriteCond %{QUERY_STRING} ^n=(.*)$
RewriteRule index.php.* http://www.sitename.com/pages/%1 [r=301,nc] 
```

这似乎也不起作用。你能详细说明你所说的吗？

谢谢阿迪亚

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-03-30T05:34:54.850

不要在重写规则中使用 url，apache 然后发送一个 http 200 代码，然后是 301 ...

试试看。像这样：

```
RewriteRule (index\.php)(?n=)(.*) /pages/$3 [r=301] 
```

# architecture - 层和层有什么区别？

> ID：694270
> 
> 赞同：1
> 
> 时间：2009-03-29T07:34:54.727
> 
> 标签：architecture, ooad

我对这两个术语感到困惑。这两个术语是什么意思？层和层有什么区别？

* * *

## 回答 #1

> 赞同：8
> 
> 时间：2009-03-29T07:49:56.047

有时人们可以互换使用它们，但在我看来，一层是逻辑分离（GUI、数据访问、业务逻辑等），而一层是物理分离（单独的服务器……即 Web 服务器、数据库服务器等）。

请参阅 Wikipedia 中的条目：多层[架构](http://en.wikipedia.org/wiki/Multitier_architecture)与[多层架构](http://en.wikipedia.org/wiki/Multilayered_architecture)

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-03-29T08:29:14.843

层通常用于参考 3 层应用程序（GUI、业务对象/逻辑、数据库访问）或 n 层应用程序。通常在讨论 3 层应用程序时，有人会在提及其中一层时使用“层”，例如“业务层”或“数据库访问层”。它们经常互换使用。虽然可能有这些的技术定义来区分它们，但我不会陷入困境。通常，这些术语在不同的上下文中具有不同的风格。

因此，我喜欢在日常对话中使用它们时进一步澄清术语。如果我说“服务”，它可能意味着“Windows 服务”、“WCF 服务”、“某些 SOA 类型的服务”或“Web 服务”。所以我永远不会只说“服务”，因为我正在与之交谈的人可能会以一种方式解释它，然后我们将在完全不同的页面上。

# http - 您如何实现简单的网站重定向？

> ID：694280
> 
> 赞同：1
> 
> 时间：2009-03-29T07:48:48.077
> 
> 标签：http, redirect, dreamhost

如果你去[www.codinghorror.com](http://www.codinghorror.com)，它会自动重定向到[www.codinghorror.com/blog](http://www.codinghorror.com/blog)

如何重定向到“/blog/”？

我正在使用[Dreamhost Shared Hosting](http://www.dreamhost.com/)，所以我配置服务器的选项是有限的。

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2009-05-10T15:59:44.867

这将是一个自学 HTTP 状态代码的好机会。阅读 HTTP 1.1 规范的[状态码定义部分](http://www.w3.org/Protocols/rfc2616/rfc2616-sec10.html#sec10)；第 10.3 节“重定向 3xx”涵盖了与您的问题相关的状态代码。了解 HTTP 3xx 代码意味着您可以发送具有您想要的语义的响应。例如，如果您打算*始终*进行重定向，则可以使用 HTTP 301，“永久移动”。理论上，客户端可以使用 HTTP 301 响应作为存储新 URL 值来代替旧 URL 值的信号。

您在 Dreamhost 的配置选项并不像您想象的那么有限，因为您可以在隐藏的**.htaccess**文件中指定许多 Apache Web 服务器配置指令。该文件应放在网络文档目录中；使用您的示例，您可以将其放置在根 Web 文档目录*/home/midas/codinghorror/*中，尽管 .htaccess 文件可以放置在 Apache 提供的任何目录中。（记得在文件名中包含前导点。）它的内容可能是已经提到的 mod_alias 示例或 mod_rewrite 示例。

请注意，mod_alias 的 RedirectPermanent 指令将为您发送 HTTP 301 状态代码。如果您想使用 mod_rewrite 来执行此操作，您可以指定状态码：

```
RewriteEngine on
RewriteRule ^$ /blog/ [R=301] 
```

如果您使用不带代码的 [R]，则使用 HTTP 302（“临时移动”）。

由于您也可以使用 PHP，这也是一个选项，尽管使用 .htaccess 的上述选项可能更快。*您可以在/home/midas/codinghorror/*中放置一个名为 index.php 的文件，并使用上面 Jeremy Ruten 给出的代码。同样，您可以在 header() 的第三个参数中指定状态代码：

```
<?php
header('Location: http://www.codinghorror.com/blog', TRUE, 301);
?> 
```

否则，将 PHP 的 header() 函数与“Location”一起使用会默认发送 HTTP 302 状态响应。

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2009-03-29T07:57:13.797

另一种选择是使用 Apache 的 mod_alias 进行永久重定向（在 .htaccess 或 httpd.conf 中）：

```
RedirectPermanent / /blog 
```

可能有与服务器和编程语言一样多的方法（可能甚至更多）。如果您告诉我们您使用的具体技术，它可能有助于为您提供更具体的答案。

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2009-03-29T07:53:25.773

假设 Apache 具有 mod_rewrite 和允许使用它的上下文权限，您将其放在虚拟主机配置或 .htaccess 中：

```
RewriteEngine on
RewriteRule ^$ /blog/ 
```

* * *

## 回答 #4

> 赞同：2
> 
> 时间：2009-03-29T07:53:47.287

一种方法是向客户端发送“位置”标头。这是一个 PHP 示例：

```
<?php

header('Location: http://www.codinghorror.com/blog');

?> 
```

# .net - Portable Contacts API 的 .NET 实现

> ID：694283
> 
> 赞同：3
> 
> 时间：2009-03-29T07:52:43.170
> 
> 标签：.net, api, poco, opensocial, portable-contacts

谷歌刚刚发布了一个 java 实现（[jpoco](http://code.google.com/apis/contacts/docs/poco/1.0/developers_guide.html)）。有.NET 吗？有人打算写一个吗？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2009-03-29T09:01:52.287

正如 Marc 所说，这将是一件有趣的事情。幸运的是，我可以有效地抽出时间来解决这个问题——如果有足够多的人感兴趣，这将是一个合理的 20% 的项目（所以我可以证明它正在增加价值）。

如果这对您有用，请给我发邮件 (skeet@pobox.com)，我会研究它需要付出多少努力。如果只需要一两天的时间来移植，我很可能会挤进去。请不要因为猜测其他几个人已经这样做而觉得邮寄给我是多余的——关键是要衡量这样一个端口的用处。

如果您可以包含`jpoco`在主题行中，那将有所帮助 - 我可以设置一个 GMail 标签和过滤器以轻松找到它们。

# java - 通过容器和组件迭代/递归以查找给定类的对象？

> ID：694287
> 
> 赞同：3
> 
> 时间：2009-03-29T07:55:34.567
> 
> 标签：java, swing, recursion

我为 JLabels 和 AbstractButtons 编写了一个 MnemonicsBuilder 类。我想编写一个方便的方法`setMnemonics( JFrame f )`，它将遍历 JFrame 的每个子项并选择 JLabels 和 AbstractButtons。如何访问 JFrame 中包含的所有内容？我试过了：

```
LinkedList<JLabel> harvestJLabels( Container c, LinkedList<JLabel> l ) {
    Component[] components = c.getComponents();
    for( Component com : components )
    {
        if( com instanceof JLabel )
        {
            l.add( (JLabel) com );
        } else if( com instanceof Container )
        {
            l.addAll( harvestJLabels( (Container) com, l ) );
        }
    }
    return l;
} 
```

在某些情况下，这工作得很好。在其他情况下，它会耗尽内存。我没有想到什么？有没有更好的方法来搜索子组件？我的递归有缺陷吗？这不是关于事物如何在 Swing 中“包含”其他事物的图片吗？例如，Swing 不是有根树吗？

```
JFrame
|
|\__JMenuBar
|   |
|    \__JMenu
|       |
|        \__JMenuItem
|
|\__JPanel
|   |
|   |\__JButton 
|   |
|   |\__JLabel
|   |
|   |\__ ... JCheckBoxes, other AbstractButtons, etc. 
```

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2009-03-29T15:48:37.783

同意汤姆在这里...您的问题是您已经传递了`List`将`JLabel`s 添加到您的递归方法并且您还返回它 - 因此不止一次将相同的项目添加到您的列表中。用更政治正确的术语来说 - 这`List`是你的累加器。

您的方法应如下所示：

```
public void harvestJLabels(Container c, List<JLabel> l) {
    Component[] components = c.getComponents();
    for(Component com : components) {
        if(com instanceof JLabel) {
            l.add((JLabel) com);
        } else if(com instanceof Container) {
            harvestJLabels((Container) com, l));
        }
    }
} 
```

然后你可以有一个辅助方法来启动这个收获：

```
public List<JLabel> harvestJLabels(Container c) {
    List<JLabel> jLabels = new ArrayList<JLabel>();
    harvestJLabels(c, jLabels);
    return jLabels;
} 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-03-29T13:47:42.520

这是你的问题：

```
LinkedList<JLabel> harvestJLabels( Container c, LinkedList<JLabel> l ) {
    ...
                l.addAll( harvestJLabels( (Container) com, l ) );
    ...
    return l;
} 
```

您只有一个列表。您正在将一个列表附加到另一个列表。因此，您正在向自身添加一个列表。从某种意义上说，这可能有效，但是您的长度将增加一倍（指数增长）。

要么有一个`List`（通常不需要在声明中指定算法），要么在每次调用方法时创建一个新的列表实例。避免返回您不需要的参考 - 这只是误导。

也`ArrayList`比`LinkedList`. `LinkedList`几乎总是错误的选择。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-03-29T09:00:09.747

如果你有两个组件，每个组件在它们的组件集合中都有另一个呢？它会无限地递归通过它们，添加到您的集合中。

你可以在某处有一个循环引用，这可能不像我描述的那么明显或简单。我不熟悉 JFrame，所以我不确定这是否可能。

在执行此类操作时，您可能需要某种“已访问”属性，以便您可以将对象标记为已访问，如果是，请不要对它们进行递归调用。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2009-03-29T10:52:34.920

您可以尝试删除递归以释放组件数组：

```
LinkedList<JLabel> harvestJLabels( Container c, LinkedList<JLabel> l ) {
    List<Container> containers = new ArrayList<Container();
    containers.add(c);
    while (!containers.isEmpty()) {
        Container cont = containers.remove(0);
        Component[] components = cont.getComponents();
        for( Component com : components )
        {
            if( com instanceof JLabel )
            {
                    l.add( (JLabel) com );
            } else if( com instanceof Container )
            {
                containers.add((Container)com);
            }
        }
    }
    return l;
} 
```

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2014-07-11T04:43:28.873

站在@Maurice 和@Cem 等其他人的肩膀上的另一种实用方法：

```
public <T extends Component> List<T> harvestMatches(Container root, Class<T> clazz) {
    List<Container> containers = new LinkedList<>();
    List<T> harvested = new ArrayList<>();

    containers.add(root);
    while (!containers.isEmpty()) {
        Container container = containers.remove(0);
        for (Component component : container.getComponents()) {
            if (clazz.isAssignableFrom(component.getClass())) {
                harvested.add((T) component);
            } else if (component instanceof Container) {
                containers.add((Container) component);
            }
        }
    }

    return Collections.unmodifiableList(harvested);
} 
```

并用以下方式调用它：

```
List<AbstractButton> buttons = harvestMatches(root, AbstractButton.class); 
```

或者

```
List<JLabel> labels = harvestMatches(root, JLabel.class); 
```

虽然我也喜欢使用[org.fest.swing.core.GenericTypeMatcher的 Swing-Fest 方法](http://fest.codehaus.org/Types+of+GUI+Component+Lookup)

# python - 在python中检测按下了哪些键

> ID：694296
> 
> 赞同：19
> 
> 时间：2009-03-29T08:11:26.620
> 
> 标签：python, events, keyboard

我需要知道现在正在按下哪个键。我不想捕获一些特定的键来触发事件或类似的东西，

我想知道现在按下了哪些键并显示它们的列表。

我还需要捕获特殊键，如 F1 ... F12、shift、alt、home、windows 等。基本上键盘上的所有键。

我如何在python中做到这一点？如何捕获键盘事件？

### 有关的

*   [跨平台键盘记录器](https://stackoverflow.com/questions/365110/cross-platform-keylogger)
*   [是否有跨平台的 python 低级 API 来捕获或生成键盘事件？](https://stackoverflow.com/questions/676713/is-there-a-cross-platform-python-low-level-api-to-capture-or-generate-keyboard-ev)

**编辑**

只是让你知道我不是要制作键盘记录器。我正在尝试制作一个诊断工具（我在笔记本电脑上分水，键盘有时会开始变得疯狂！！）

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2009-03-29T08:25:45.210

[相关问题](https://stackoverflow.com/questions/365110/cross-platform-keylogger/365225#365225)中提到的[PyKeylogger](https://sourceforge.net/p/pykeylogger/wiki/Main_Page/)可能会完成这项工作。

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2009-03-29T21:43:02.173

如果您不太挑剔的话，最简单的方法是引入 GUI 工具包，例如 pygame 或 wxPython。例如，运行 wxPython Demo，然后转到 KeyEvents 的演示。

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2009-03-29T08:58:30.937

[我使用pyHook](http://pyhook.wiki.sourceforge.net/)[相关问题](https://stackoverflow.com/questions/365110/cross-platform-keylogger)中的链接找到了答案：

[pyHook 教程：捕获按键事件](http://pyhook.wiki.sourceforge.net/pyHook_Tutorial#tocpyHook_Tutorial4)

# xpath - XPath 1 查询和属性名称

> ID：694298
> 
> 赞同：9
> 
> 时间：2009-03-29T08:13:31.013
> 
> 标签：xpath, attributes

第一个问题：有没有办法获取节点属性的**名称？**

```
<node attribute1="value1" attribute2="value2" /> 
```

第二个问题：有没有办法将属性和值作为值对来获取？情况如下：

```
<node attribute1="10" attribute2="0" /> 
```

我想以这种方式获取值> 0的所有属性：“attribute1 = 10”。

* * *

## 回答 #1

> 赞同：13
> 
> 时间：2009-03-29T15:18:38.620

> 第一个问题：有没有办法获取节点属性的名称？
> 
> `<node attribute1="value1" attribute2="value2" />`

**是：这个 XPath 表达式**（什么时候`node`是上下文（当前）节点））：

    **`name(@*[1])`**

生成第一个属性的名称（排序可能取决于实现）

**和这个 XPath 表达式**（什么时候`node`是上下文（当前）节点））：

    **`name(@*[2])`**

生成第二个属性的名称（排序可能取决于实现）。

> 第二个问题：有没有办法将属性和值作为值对来获取？情况如下：
> 
> `<node attribute1="10" attribute2="0" />`
> 
> 我想以这种方式获取值> 0的所有属性：“attribute1 = 10”。

**这个 XPath 表达式**（当名为“ `attribute1`”的属性是上下文（当前）节点时）：

    **`concat(name(), '=', .)`**

产生字符串：

    **`attribute1=value1`**

**和这个 XPath 表达式**（当节点`node`是上下文（当前）节点时）：

    **`@*[. > 0]`**

选择上下文节点的所有属性，其值为大于 0 的数字。

**在 XPath 2.0 中，可以将它们组合成一个 XPath 表达式**：

    **`@*[number(.) > 0]/concat(name(.),'=',.)`**

得到（在这种特殊情况下）这个结果：

    **`attribute1=10`**

**如果您使用**功能较弱的 XPath 1.0，则**需要将 XPath 表达式嵌入到宿主语言中，例如 XSLT**。以下 XSLT 1.0 转换：

```
<xsl:stylesheet version="1.0"
    xmlns:xsl="http://www.w3.org/1999/XSL/Transform">
    <xsl:output method="text"/>

  <xsl:template match="/*">
      <xsl:for-each select="@*[number(.) > 0]">
        <xsl:value-of select="concat(name(.),'=',.)"/>
      </xsl:for-each>
    </xsl:template>
</xsl:stylesheet> 
```

**应用于此 XML 文档时**：

```
<node attribute1="10" attribute2="0" /> 
```

**产生完全相同的结果**：

    **`attribute1=10`**

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-03-29T08:18:55.400

我相信这有点取决于上下文。在大多数情况下，我希望您必须查询“ `@*`”，枚举项目，然后调用“ `name()`”——但它可能在某些测试中有效。

重新编辑 - 你可以这样做：

```
@*[number(.)>0] 
```

查找符合您的条件的属性，并且：

```
concat(name(),'=',.) 
```

显示输出。不过，我认为你不能同时做到这两点。这里的上下文是什么？xslt？什么？

# svn - Tortoise SVN 移动命令失败，并显示消息“无法锁定”

> ID：694306
> 
> 赞同：4
> 
> 时间：2009-03-29T08:18:55.930
> 
> 标签：svn, tortoisesvn

什么会导致使用 Tortoise SVN 的“SVN 将版本化文件移至此处”命令失败并出现错误“无法锁定 ''，请执行清理命令”，即使在执行了清理命令之后也是如此？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-03-29T08:32:29.953

我以前遇到过这种情况 - 总是在本身受源代码控制的目录的子目录中。如果是这种情况，请在当前目录的*父*目录中尝试 svn cleanup ，或者在该目录的父目录中尝试，等等 - 即，在您可以找到受源代码控制的最高级别父目录中尝试。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-03-29T10:21:11.893

我在使用 Tortoise 移动工具时也遇到了问题（除了用触摸板很难完成之外），当我需要移动某些东西时，我已经切换到使用命令行**svn move命令。**

**编辑：** Tortoise 没有附带命令行客户端，所以我使用来自[www.sliksvn.com](http://www.sliksvn.com/)的客户端。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-04-02T02:55:46.893

我将尼尔的回答标记为正确，因为这基本上是导致我找到解决方法的原因。move 命令实际上也失败了，这表明问题不在于 ToirtoiseSVN，而实际上是 SVN 本身。我删除了工作区并重新签出了存储库。但是该文件夹仍然存在问题，因此我最终不得不删除存储库本身中的一些文件夹，并在问题消失之前重新提交它们。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2018-02-14T14:26:53.903

我有同样的问题。我使用“右键单击 > TortoiseSVN > 存储库浏览器”，然后通过将目录拖放到存储库浏览器中来移动我的目录。有效。

为了更新我的工作副本，我只需要再次清理我的目录并激活“Break locks”选项。

# c# - 使用 ChartArea.Select 方法的问题

> ID：694317
> 
> 赞同：0
> 
> 时间：2009-03-29T08:31:04.573
> 
> 标签：c#, excel, reflection, automation

我正在尝试通过 C# 中的反射使用 Select 方法选择 ChartArea。这是我正在使用的代码行：

oChartArea.GetType().InvokeMember("Select", BindingFlags.InvokeMethod, null, oChartArea, null);

这里，oChartArea 是 ChartArea 对象。

这在 Vista/Office 2007 中运行良好，但在 XP SP2/Office 2003 中抛出异常。有什么建议吗？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2009-03-29T09:11:31.840

为什么要使用反射？
你不能直接调用 oChartArea.Select() 吗？

它在 Office 2003 中引发了什么异常？

# java - Jython 可以取代 Java 吗？

> ID：694329
> 
> 赞同：4
> 
> 时间：2009-03-29T08:41:47.233
> 
> 标签：java, java-me, jakarta-ee, jython, jvm-languages

如此多的服务器端和移动 Java 应用程序使用 Java 的本机 Java 语言。我们是否可以使用 Jython 来构建企业应用程序，例如网站、应用程序服务器等？

另外，您对 Jython 中的 Java ME 应用程序有何看法。

PS 也欢迎对问题发表评论。

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2009-03-29T09:06:35.317

不，Jython 不是 Java 的合适替代品。例如，如果不使用 Java 编写接口，然后在 Jython 中编写一个利用它的类，它就无法实现接口。

需要的是一个面向 JVM 的等价于 Boo。Boo 是一种针对 .NET CLR 的语言，它大致受 Python 启发但不兼容，并且完全公开了 CLR 的功能（因此与 C# 功能等效）。目前没有与 Java 功能相同的 Pythonic 语言——而且这种语言必然与 Python 不兼容，因为 Python 根本不提供表达某些相关概念（例如接口类型信息）的方法。

* * *

由于对此有一些疑问，但我澄清一下：

Jython 不是 Java 的替代品，因为您不能采用任意 Java 项目，而是决定在 Jython 中实现该项目的随机子集，并且开发团队中的任何其他人都不知道或关心。当然，Jython 适用于许多与 Java 相同的项目类，*除非您正在构建一个将从 Java 调用的接口，而不是反过来*。鉴于“企业应用程序”往往具有许多彼此紧密操作的组件，因此能够构建具有任意外部接口的类很重要……这在纯 Jython 中是不容易做到的。

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2009-04-01T23:32:39.703

这在很大程度上取决于您的要求。所有语言都有其优点和缺点。没有完美的语言，对语言选择做出明智的决定是程序员的一项重要技能。

我不同意 Charles 的观点，即 Jython 无法替代 Java，因为您无法实现接口。在动态语言中，它被视为您*不需要*接口的功能（请参阅鸭子类型）。

Jython 采用 Python 的出色语言特性，并将其与对大量 Java 库的轻松访问相结合。然而，它在开销方面确实有代价，而且作为一种相当新的语言，你需要更少的程序员和支持来支持你。

Jython 的好处是，如果出现性能问题，您可以用 Java 重写单个模块。速度问题在您可以使用硬件解决问题的服务器上不太明显。在手机上，性能仍然是关键，我看不出 Jython 在不久的将来会在那里产生重大影响。

So will Jython replace Java? No, I don't think it will - the momentum behind Java is too great. But we will see increasingly more software with parts written in Jython and other languages targeting the JVM.

* * *

## 回答 #3

> 赞同：3
> 
> 时间：2009-03-29T09:00:21.027

不，Jython 不能替代 Java，因为 Python 是动态类型的。是的，Jython 可用于服务器应用程序。

Jython 不适合 Java ME，因为 Java ME 的资源非常有限。也许几年后。

编辑：动态类型，不弱

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2009-03-30T14:09:30.510

是的。动态语言是未来。大约一年前，我从 SUN 的代表那里听到了这一点。关于 Jython 的惊人之处在于 Java 库的“本机”使用。服务和其他组件可能会保留在 Java 中，但集成层肯定会朝着动态语言的方向发展。我认为 Python 像 Java 一样是原生面向对象的，这就是它们匹配得如此出色的原因。我不期望 Perl 等其他脚本语言会出现类似的情况，但可以肯定 Ruby 和 Groovy 也是不错的选择。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2009-03-29T10:26:31.957

您可以将 Jython 用于该域。显然，Web 开发世界正朝着 Python 或 Ruby 等动态类型语言发展。Jython 在这个领域很不错，因为它允许在企业中使用完整的“Java 堆栈”（应用服务器、Tomcat、部署和测试基础架构……）。您还可以在 Java 中实现您的业务逻辑。

但是，Jython 不能替代 Java，因为它是 C#。您（可能）提高了程序员的工作效率，但您会损失性能和编译时间检查。这些语言确实不同，并且针对不同的任务进行了“优化”。我建议评估 Jython 的较小、非关键任务，例如开始在其中实施一些测试用例。

我怀疑 Jython 是否对 Java ME 开发有用。原因在其他帖子中给出：资源限制。

# cracking - 黑客/破解道义论

> ID：694330
> 
> 赞同：9
> 
> 时间：2009-03-29T08:42:01.943
> 
> 标签：cracking

假设您最近在几个主要在您所在国家/地区激活并在其市场中非常强大的网站中发现了一些重大漏洞。我说的漏洞和让我以超级管理员权限浏览管理界面一样糟糕。

你现在会怎么做？我在想类似的东西：

1.  向公司报告问题。
2.  公开宣布这些应用程序中存在安全漏洞，但未披露实际漏洞。
3.  给公司时间来解决它的问题。（多少？）
4.  在问题修复后，或修复宽限期已过（以先到者为准），充分披露漏洞。

你们有什么感想？您是否有一些材料可以阅读或分享经验？

* * *

## 回答 #1

> 赞同：18
> 
> 时间：2009-03-29T11:11:04.487

**讲话。到。律师。**

根据公司的不同，这可能会变得很棘手。通过说“在我宣布漏洞利用之前你有 xx 天的时间来解决这个问题”，你基本上是在说“按照我的期望去做，否则我会给你带来很多痛苦”。

另一个问题是，您是如何发现这一点的？您是否“正常”使用该网站，或者您是否看到了漏洞的潜力并决定看看它是否有效？记住这一点非常重要，特别是如果您正在考虑设置时间限制来解决问题。我不确定法律对您居住的地方有何规定，所以请与这样做的人交谈。

您最终可能会得到他们的感谢，一些用于进入 NDA 的现金（毕竟，您确实浏览了管理界面），并且您可能会在安全行业中获得一些荣誉。但是，要非常非常小心，并尝试寻求律师的建议。

* * *

## 回答 #2

> 赞同：5
> 
> 时间：2009-03-29T08:52:01.013

我认为你在正确的轨道上。

这种情况下的一般趋势是向上述公司提交错误报告，并根据问题的严重性和修复所需的时间估计给他们一些时间。在那之后，如果公司没有另外要求你（为了溢价？），通常会有一个完整的披露。

但是，如果公司没有及时回复您/不承认您有权（我相信）为了更大的利益发布您的结果。

无论您选择做什么，都要妥善记录您与公司的沟通。这可能有助于避免不可预见的情况。

* * *

## 回答 #3

> 赞同：4
> 
> 时间：2009-03-29T12:26:16.693

简单的说：

**忽略它。**

你的行为（*不管你发现了什么*）几乎总是违法的。因此，那家公司可以把你告上法庭，让你的生活变得悲惨。类似的事情以前也发生过。大多数时候，律师帮不了你。

一些不在安全行业工作的人可能不同意我的观点（*也就是反对票*），但他们去过那里，做到了。

最后一个正确的方法是，如果你有一个朋友在那里或一个私人联系人只是和他/她进行非正式的聊天（*你可以稍后否认，并且不能作为证据*）然后他/她可以说话看看这个并像内部发现一样报告。

对于报告开源/商业应用程序中的内容，您可能会发现这很有趣且很有帮助： http: [//www.wiretrip.net/rfp/policy.html](http://www.wiretrip.net/rfp/policy.html) -responsible publishing- 但这完全是另一个故事，而不是在公司的实时网站中发现漏洞/ 基础设施。

如果它是一种商业产品并且你已经对其进行了逆向工程，那么它在许多国家仍然是非法的。因此，即使在产品中，您也必须小心。最近，Google / MS 等公司开始公开宣布如何报告其产品中的安全问题。

* * *

## 回答 #4

> 赞同：3
> 
> 时间：2009-03-29T08:53:40.277

我个人会向公司报告，给他们一些合理的时间来纠正它。但如果他们认为需要更长的时间，也可以为他们提供请求延期的选项。在该截止日期之后，披露漏洞。

我可能会考虑向政府安全组织报告。我主要担心的是我是否需要匿名报告，因为您公开披露漏洞可能会违反某些法律。这取决于你的国家。

* * *

## 回答 #5

> 赞同：3
> 
> 时间：2009-03-29T12:47:05.647

很大程度上取决于对上述漏洞负责的人。为了掩饰自己的屁股，他可能会在法庭上追捕你。此外，如果一个人可以访问管理面板，也可能访问一些私人信息和商业机密。有太多变数无法确定。正如其他人已经说过的，请咨询您的律师。在一些国家，也有专门研究计算机犯罪和相关问题的律师，那是最好的。

一年前，我负责几台 linux 服务器，这些服务器经常受到 SSH 暴力攻击。我曾经向任何 IP 的大多数管理员发送电子邮件，其名称为 mail.some_company.com，因为这主要意味着系统受到攻击。检查日志后，我发现了我当地一家公司的 IP。没想到我打电话给他们报告问题。他们的管理员的回应是“什么？！你是谁？你对我们的服务器做了什么？！”。

* * *

## 回答 #6

> 赞同：3
> 
> 时间：2009-03-29T14:13:47.807

您可以考虑向 Secunia 等组织报告该漏洞，并要求他们管理披露。他们以前做过这种事……

[http://secunia.com/advisories/report_vulnerability/](http://secunia.com/advisories/report_vulnerability/)

* * *

## 回答 #7

> 赞同：2
> 
> 时间：2009-03-29T12:06:31.513

如果您所在的国家/地区有政府监管机构，例如联邦贸易委员会，请向他们报告，然后忘记它的存在。

如果你直接向公司汇报，你首先要找到汇报对象。然后你必须处理“你怎么知道这个”的问题（+1 on Talk to a Lawyer）。然后，如果您威胁要公开，您可能会发现当地警察拿着搜查令敲门，然后因敲诈勒索而被捕（与律师交谈 +2）。

* * *

## 回答 #8

> 赞同：1
> 
> 时间：2009-03-29T08:52:05.773

我会先向公司报告安全漏洞。如果他们不照顾他们 - 我会向公众宣布。

* * *

## 回答 #9

> 赞同：1
> 
> 时间：2009-03-29T08:52:44.257

如果我在你的位置，我肯定会向公司报告。如果问题像您提到的那样严重，请使用可用的最快通信方式进行报告。

如果您知道某些解决方案，也请让他们知道。

您可以写一篇关于问题和解决方案的概括性博客或文章。这将帮助其他人检查自己的系统。不要透露有关公司或网站的任何信息，否则您可能会遇到问题。

# c# - C# 中的河豚

> ID：694331
> 
> 赞同：2
> 
> 时间：2009-03-29T08:48:59.820
> 
> 标签：c#, blowfish

我的 C++ 程序使用标准的河豚。

我的 C# 程序从[这里](http://www.hotpixel.net/software.html)使用 Blowfish 加密算法。

两个应用程序（TCP 客户端）都做同样的事情：接收数据包，对其进行加密，然后将其发回。如果服务器将数据包识别为正常 - 它会发送另一个数据包，否则它会关闭套接字。我遵循了 C++ 和 C# 中的所有函数，除了加密之外，一切都是一样的。

在 C++ 文件中，我只有一种加密。但是，在 C# Blowfish 我有

*   河豚
*   河豚CFB
*   河豚欧洲央行
*   河豚简单

我不知道我的 C++ 项目中是哪一个，所以我随机选择了`BlowfishECB`. 但它不起作用，服务器（我无权访问它）无法将数据包识别为加密。

我的问题：C# 是否有标准的 Blowfish，或者如果这是唯一的，我该如何解决这个问题？ **编辑：**

C++ 河豚代码[可以在这里看到](http://pastebin.com/m178ea218)。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2009-03-29T09:18:57.953

不，C# 没有标准的河豚。它会使用你告诉它的任何一个。（编辑：我想我误解了。如果你想要一个符合标准的 C# 河豚，我会推荐 Bouncy Castle Crypto。它是 Java 的一个端口，包含大多数文档化的 RFC 标准。查看单元测试以了解如何使用类。每当我上次使用它时，文档都缺少，但是单元测试是很好的例子，说明了事物如何组合在一起。）

您要问的问题是您的 C++ 应用程序使用的是哪种 Blowfish。您在 C++ 应用程序中使用什么库来进行加密？一旦你知道了这一点，你就可以在你的 C# 应用程序中做出正确的选择。

我个人遇到的最多的是CBC。“简单”可能值得尝试。

您还必须处理一些事情，例如确保您的初始化向量根据您使用的向量匹配。

# jquery - ASMX Web 服务在本地主机上工作，但在生产服务器上不工作。请帮忙！

> ID：694332
> 
> 赞同：1
> 
> 时间：2009-03-29T08:49:35.670
> 
> 标签：jquery, web-services

我一直在从事一个 Intranet 项目，我使用 asmx Web 服务作为 DAL，并通过 jQuery 在 aspx 和 htm 页面上使用它们。在我的开发机器上，一切运行良好。当我在生产服务器上部署应用程序时，我无法访问 Web 服务。我尝试像这样直接通过 http 访问 Web 服务`http://productionserver/myproject/DataService.asmx`，但这也没有帮助，没有任何效果。

我正在使用.net 3.5。服务器上的其他应用程序运行良好。

请帮忙。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-03-29T08:57:34.200

听起来服务器配置不正确......当您访问 asmx 页面时，您有*什么收获吗？*没有更多就很难诊断......最常见的问题是：

*   应用程序根未在 IIS 中设置为应用程序（齿轮图标）
*   未使用正确版本的 ASP.NET（再次在 IIS 中配置）
*   应用程序池身份无法访问代码文件或数据库/其他任何内容（通常会导致“500”错误），或者无法作为服务运行，或者不在 IIS_WPG 组中

负载平衡器和防火墙之类的东西也会增加复杂性，但这通常不是最大的问题。

最后 - 对于与 jQuery 一起使用，您可能还考虑（对于下一个项目）从 ASP.NET MVC 路由返回 JSON - 这将使事情比使用 asmx 简单得多。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-03-29T09:26:52.413

当您直接访问 URL 时，结果是什么？究竟会发生什么？

您的网页和网络服务是否在同一台服务器上运行？

我会在事件日志中寻找更多线索，然后开始放入调试语句，在某处写出信息。（通常是事件日志。）

# asp.net - ASP.NET 多次调用应用程序变量的成本是多少？

> ID：694336
> 
> 赞同：3
> 
> 时间：2009-03-29T08:53:24.037
> 
> 标签：asp.net, performance, web-applications, path

简而言之：每次加载页面时检查 Application("WebAppName") 等应用程序变量 10-20 次是否成本高昂？

背景：（欢迎批评）

我网站中的一些包含包含许多链接和图像，由于它们包含在不同的路径中，它们不能使用相对 url。

因此，这些包括包含频繁的实例

```
<img src="<%=Application("Webroot")%>images\image.gif"> 
```

像这样继续调用应用程序变量是否昂贵？

我应该将 Application 值放在某个局部变量中以在需要的地方使用吗？

重要的提示：

我需要我的 webapp 在服务器上正常运行，无论它是在根 Web（“/”）还是在虚拟子 Web（“/app”）中。

提前感谢您分享的任何智慧。

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2009-03-29T08:58:53.947

它很便宜 - 非常非常便宜 - 只是一个字典查找。与您将在应用程序中执行的几乎所有其他操作（从磁盘或网络加载某些内容）相比，这将是统计噪音。

但总的来说，如果你担心这样的事情，最好的办法就是*测量*它。任意将 10,000 个调用放入一个页面，看看它如何影响性能。看看它是如何影响并发性的——在处理多个并发请求时，您仍然可以获得所需的吞吐量吗？

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2009-03-29T09:06:05.257

仅供参考，另一种选择是：

```
<img src="<%=VirtualPathUtility.ToAbsolute("~/images/image.gif")%>" 
```

这在 MVC 中特别有效，您可以在其中编写扩展方法来完成这项工作，即

```
<%=Html.Image("~/images/image.gif")%> 
```

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2009-03-29T09:03:43.187

Application 对象是一个同步的集合，它使用 ReadWriteObjectLock（一个只使用 lock 关键字的内部类），所以如果你只从集合中读取，它将与 Jon 提到的哈希表查找一样快，但如果同时当有人写这个集合时，读者会阻塞直到写完成。如果您非常担心性能，请调用索引器一次，将其存储到局部变量并在您的视图中使用此变量。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2009-03-29T08:59:56.597

改为使用`Request.ApplicationPath`（仅当您的应用程序在 IIS 中设置为虚拟目录时才有效）

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2009-03-29T09:01:07.047

简短的回答 - 衡量它并决定你自己的环境。我会说没关系。

更长的答案-无论如何，您都应该将呼叫包裹在某些东西中……例如WebConfiguration.Root。这将使您可以选择在将来的任何时间对其进行任何优化。

# regex - 引号之间匹配的正则表达式，包含转义引号

> ID：694344
> 
> 赞同：10
> 
> 时间：2009-03-29T08:59:41.667
> 
> 标签：regex, pcre

*这本来是我想问的一个问题，但在研究问题的细节时，我找到了解决方案，并认为其他人可能会对它感兴趣。*

在 Apache 中，完整的请求用双引号括起来，其中的任何引号总是用反斜杠转义：

```
1.2.3.4 - - [15/Apr/2005:20:35:37 +0200] "GET /\" foo=bat\" HTTP/1.0" 400 299 "-" "-" "-" 
```

我正在尝试构建一个匹配所有不同字段的正则表达式。`GET`我当前的解决方案总是在/之后的第一个引号处停止`POST`（实际上我只需要所有值，包括传输的大小）：

```
^(\d+\.\d+\.\d+\.\d+)\s+[^\s]+\s+[^\s]+\s+\[(\d+)/([A-Za-z]+)/(\d+):(\d+):(\d+):(\d+)\s+\+\d+\]\s+"[^"]+"\s+(\d+)\s+(\d+|-) 
```

我想我还会从我的 PHP 源代码中提供我的解决方案，其中包含注释和更好的格式：

```
$sPattern = ';^' .
    # ip address: 1
    '(\d+\.\d+\.\d+\.\d+)' .
    # ident and user id
    '\s+[^\s]+\s+[^\s]+\s+' .
    # 2 day/3 month/4 year:5 hh:6 mm:7 ss +timezone
    '\[(\d+)/([A-Za-z]+)/(\d+):(\d+):(\d+):(\d+)\s+\+\d+\]' .
    # whitespace
    '\s+' .
    # request uri
    '"[^"]+"' .
    # whitespace
    '\s+' .
    # 8 status code
    '(\d+)' .
    # whitespace
    '\s+' .
    # 9 bytes sent
    '(\d+|-)' .
    # end of regex
    ';'; 
```

在 URL 不包含其他引号的简单情况下使用它可以正常工作：

```
1.2.3.4 - - [15/Apr/2005:20:35:37 +0200] "GET /\ foo=bat\ HTTP/1.0" 400 299 "-" "-" "-" 
```

现在我正试图获得对无、一次或多次出现的支持`\"`，但找不到解决方案。使用 regexpal.com 到目前为止我已经想出了这个：

```
^(\d+\.\d+\.\d+\.\d+)\s+[^\s]+\s+[^\s]+\s+\[(\d+)/([A-Za-z]+)/(\d+):(\d+):(\d+):(\d+)\s+\+\d+\]\s+"(.|\\(?="))*" 
```

这里只是更改的部分：

```
 # request uri
    '"(.|\\(?="))*"' . 
```

不过，也太贪心了。它吃完所有东西，直到最后一个`"`，它应该只吃到第一个，`"`前面没有 a `\`。`\`我还尝试引入在我想要的之前没有的要求`"`，但它仍然吃到字符串的末尾（注意：我必须添加无关`\`的字符才能在 PHP 中进行这项工作）：

```
 # request uri
    '"(.|\\(?="))*[^\\\\]"' . 
```

但后来它击中了我：***`?`**：如果在任何量词*、+、? 或 {} 之后立即使用，则使量词非贪婪（匹配最小次数）*

```
 # request uri
    '"(.|\\(?="))*?[^\\\\]"' . 
```

完整的正则表达式：

```
^(\d+\.\d+\.\d+\.\d+)\s+[^\s]+\s+[^\s]+\s+\[(\d+)/([A-Za-z]+)/(\d+):(\d+):(\d+):(\d+)\s+\+\d+\]\s+"(.|\\(?="))*?[^\\]"\s+(\d+)\s+(\d+|-) 
```

**2009 年 5 月 5 日更新：**

由于解析了数百万行，我在正则表达式中发现了一个小缺陷：它在双引号之前包含反斜杠字符的行上中断。换句话说：

```
...\\" 
```

将打破正则表达式。Apache 不会记录`...\"`但总是将反斜杠转义为`\\`，因此可以安全地假设当双引号前有两个反斜杠字符时。

任何人都知道如何用正则表达式解决这个问题？

有用的资源： developer.mozilla.org和[regexpal.com](http://regexpal.com/)[上的 JavaScript Regexp 文档](https://developer.mozilla.org/En/Core_JavaScript_1.5_Reference:Global_Objects:RegExp#Special_characters_in_regular_expressions)

* * *

## 回答 #1

> 赞同：27
> 
> 时间：2009-03-29T09:06:47.017

试试这个：

```
"(?:[^\\"]+|\\.)*" 
```

此正则表达式匹配一个双引号字符，后跟一个由除 and 以外的任何字符组成的序列`\`，`"`或一个转义序列`\`*`α`*（其中*`α`*可以是任何字符），后跟最后一个双引号字符。语法只是一个非捕获组。`(?:`*`expr`*`)`

# windows - 为 win32 控制台应用程序设置库路径

> ID：694351
> 
> 赞同：3
> 
> 时间：2009-03-29T09:02:47.650
> 
> 标签：windows, dll, msdn

当我尝试执行简单的“HelloWorld”win32 控制台应用程序时，出现“找不到 dll：重新启动应用程序可能会解决问题”错误。我知道.dll 的位置。从命令提示符执行 .exe 时如何指定其位置？

PS：将.dll复制到.exe的当前目录似乎可以解决问题，但是这种方法不适合这种情况。

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2009-03-29T09:07:05.300

DLL 加载发生在 Windows 的管道深处。

如果在与应用程序相同的目录中找不到 DLL，则会自动扫描 PATH 以找到该目录。

因此，解决问题的最简单方法是将包含 DLL 的目录添加到 PATH。根据您的代码何时需要加载 DLL，您可以（临时）从“HelloWorld”应用程序内部修改 PATH。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2009-03-29T09:12:10.810

[LoadLibraryEx](http://msdn.microsoft.com/en-us/library/ms684179(VS.85).aspx)的文档对Windows 如何搜索您的 dll 进行了一些讨论。如果可以构建 DLL 的完整路径或使用[SetDllDirectory](http://msdn.microsoft.com/en-us/library/ms686203(VS.85).aspx)函数将目录添加到搜索路径，则可以尝试使用 LOAD_WITH_ALTERED_SEARCH_PATH 标志。

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2009-09-22T19:05:52.893

要手动，将您的路径永久添加到 Windows PATH（永久 = 直到您将其删除），右键单击我的电脑>属性>高级>环境变量>系统变量>路径>编辑>变量值，添加一个分号（这意味着“另外to all before") 并粘贴您的 dll 的完整路径。

每次在当前目录中找不到内容时，Windows 都会搜索路径。

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2014-03-20T09:31:51.867

来自：http: [//msdn.microsoft.com/en-us/library/7d83bc18.aspx](http://msdn.microsoft.com/en-us/library/7d83bc18.aspx)

> 对于隐式和显式链接，Windows 首先搜索“已知 DLL”，例如 Kernel32.dll 和 User32.dll。然后 Windows 按以下顺序搜索 DLL：
> 
> 1.  当前进程的可执行模块所在的目录。
>     
>     
> 2.  当前目录。
>     
>     
> 3.  Windows 系统目录。GetSystemDirectory 函数检索此目录的路径。
>     
>     
> 4.  Windows 目录。GetWindowsDirectory 函数检索此目录的路径。
>     
>     
> 5.  PATH 环境变量中列出的目录。

# openx - 防止在我的网站中弹出广告网络

> ID：694358
> 
> 赞同：0
> 
> 时间：2009-03-29T09:10:07.820
> 
> 标签：openx

有没有办法阻止广告网络在我的网站中创建弹出窗口。我正在使用 OpenX 来管理我的广告。我明确告诉网络不要显示任何弹出窗口。由于我有许多广告网络，我无法确定哪个广告网络在调用弹出窗口。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2009-03-29T09:30:39.847

我想这些广告是由 javascript 生成的，它在网络浏览器打开页面时运行。

因此，您无法在服务器端进行任何处理或过滤来确定并停止它。确定这一点的客户端脚本也很难产生。

为了扩展客户端脚本问题，如果您真的想始终如一地解决此问题，您可以创建一个模仿用户的程序，然后可以捕获任何创建的弹出窗口并记录它们。
您可以通过更改您的 IP 地址或其他测试来使用它来测试引用页面的结果。
这真的取决于你想花多少时间在这上面。
顺便说一句，您的广告提供商可能根本不喜欢这样，因为您这样做可能会犯下欺诈行为。（如果他们为每次广告浏览付费。）

我的建议是测试您的网页，并确定哪个广告提供商是问题所在。

一旦你知道你可以删除它们，或者与他们讨论。

# ip - B类IP地址：广播

> ID：694360
> 
> 赞同：0
> 
> 时间：2009-03-29T09:10:18.083
> 
> 标签：ip, broadcast

以下 IP 地址 - 168.94.254.255 和 168.94.255.254 - 是否用于广播，如果它们属于 B 类？（地址是随机选择的）。我想 168.94.255.255 宁愿成为广播地址，但我不确定。提前致谢！

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-03-29T09:43:53.837

CIDR 表示法中的 B 类网络是 /16 网络。广播地址是所有主机位都为 1 的地方。在您的情况下，最后 16 位需要为 1 才能成为广播地址。

168.94.254.255 和 168.94.255.254 在最后 16 位中各有一个零位，因此它们不是广播地址。

如果您的 B 类被划分为 /24 的子网，那么如果 168.94.254.0/24 是网络地址，那么 168.94.254.255 地址可能是广播地址。

# ruby-on-rails - 非空白字符的剥离方法？

> ID：694363
> 
> 赞同：5
> 
> 时间：2009-03-29T09:12:10.247
> 
> 标签：ruby-on-rails, ruby, string

是否有一个 Ruby/Rails 函数可以去除某个用户定义字符的字符串？例如，如果我想去掉我的引号字符串“... text...”

[http://api.rubyonrails.org/classes/ActiveSupport/Multibyte/Chars.html#M000942](http://api.rubyonrails.org/classes/ActiveSupport/Multibyte/Chars.html#M000942)

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-02-26T13:14:43.207

我不知道我是否在这里重新发明轮子，所以如果你找到一个做同样事情的内置方法，请告诉我:-)

我将以下`config/initializers/string.rb`内容添加到 ，将`trim`和`ltrim`方法添加`rtrim`到 String 类。

```
# in config/initializers/string.rb
class String
  def trim(str=nil)
    return self.ltrim(str).rtrim(str)
  end

  def ltrim(str=nil)
    if (!str)
      return self.lstrip
    else
      escape = Regexp.escape(str)
    end

    return self.gsub(/^#{escape}+/, "")
  end

  def rtrim(str=nil)
    if (!str)
      return self.rstrip
    else
      escape = Regexp.escape(str)
    end

    return self.gsub(/#{escape}+$/, "")
  end
end 
```

我像这样使用它：

`"... hello ...".trim(".")`=> “你好”

和

`"\"hello\"".trim("\"")`=> “你好”

我希望这有帮助 ：-）

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2009-03-29T09:29:03.390

您可以将 tr 与第二个参数一起用作空白字符串。例如：

```
%("... text... ").tr('"', '') 
```

将删除所有双引号。

尽管如果您使用此功能来清理您的输入或输出，那么它可能无法有效防止 SQL 注入或跨站点脚本攻击。对于 HTML，您最好使用 gem sanitize 或 view helper 函数`h`。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2009-03-29T19:38:20.930

我不知道一个开箱即用的，但这应该做你想要的：

```
class String
  def strip_str(str)
    gsub(/^#{str}|#{str}$/, '')
  end
end

a = '"Hey, there are some extraneous quotes in this here "String"."'
puts a.strip_str('"') # -> Hey, there are some extraneous quotes in this here "String". 
```

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2012-05-17T22:25:03.050

```
class String
    # Treats str as array of char
  def stripc(str)
    out = self.dup
    while str.each_byte.any?{|c| c == out[0]}
        out.slice! 0
    end
    while str.each_byte.any?{|c| c == out[-1]}
        out.slice! -1
    end
    out
  end
end 
```

`+`如果您想删除他的字符串模式的*所有*额外实例，Chuck 的答案需要一些符号。如果您想删除可能以任何顺序出现的任何一组字符，它也不起作用。

例如，如果我们希望字符串不以以下任何内容结尾: `a, b, c`，而我们的字符串是`fooabacab`，我们需要像我上面提供的代码那样更强大的东西。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2009-03-29T16:29:31.883

你可以使用字符串#gsub：

```
%("... text... ").gsub(/\A"+|"+\Z/,'') 
```

# python - 我怎样才能使这个递归爬虫函数迭代？

> ID：694366
> 
> 赞同：4
> 
> 时间：2009-03-29T09:13:29.760
> 
> 标签：python, recursion, web-crawler

出于学术和性能的考虑，鉴于这种爬网递归网络爬网功能（仅在给定域内爬网），使其迭代运行的最佳方法是什么？目前，当它运行时，当它完成时，python 已经使用超过 1GB 的内存，这对于在共享环境中运行是不可接受的。

```
 def crawl(self, url):
    "Get all URLS from which to scrape categories."
    try:
      links = BeautifulSoup(urllib2.urlopen(url)).findAll(Crawler._match_tag)
    except urllib2.HTTPError:
      return
    for link in links:
      for attr in link.attrs:
        if Crawler._match_attr(attr):
          if Crawler._is_category(attr):
            pass
          elif attr[1] not in self._crawled:
            self._crawled.append(attr[1])
            self.crawl(attr[1]) 
```

* * *

## 回答 #1

> 赞同：12
> 
> 时间：2009-03-29T09:16:53.920

使用 BFS 而不是递归爬行 (DFS)：[http ://en.wikipedia.org/wiki/Breadth_first_search](http://en.wikipedia.org/wiki/Breadth_first_search)

您可以为 BFS 队列使用外部存储解决方案（例如数据库）来释放 RAM。

算法是：

```
//pseudocode:
var urlsToVisit = new Queue(); // Could be a queue (BFS) or stack(DFS). (probably with a database backing or something).
var visitedUrls = new Set(); // List of visited URLs.

// initialization:
urlsToVisit.Add( rootUrl );

while(urlsToVisit.Count > 0) {
  var nextUrl = urlsToVisit.FetchAndRemoveNextUrl();
  var page = FetchPage(nextUrl);
  ProcessPage(page);
  visitedUrls.Add(nextUrl);
  var links = ParseLinks(page);
  foreach (var link in links)
     if (!visitedUrls.Contains(link))
        urlsToVisit.Add(link); 
} 
```

* * *

## 回答 #2

> 赞同：5
> 
> 时间：2009-03-29T09:54:17.650

您可以将要抓取的新 URL 放入队列中，而不是递归。然后运行直到队列为空而不递归。如果将队列放入文件中，则几乎不使用任何内存。

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2009-03-30T12:33:44.733

@Mehrdad - 感谢您的回复，您提供的示例简洁易懂。

解决方案：

```
 def crawl(self, url):
    urls = Queue(-1)
    _crawled = []

    urls.put(url)

    while not urls.empty():
      url = urls.get()
      try:
        links = BeautifulSoup(urllib2.urlopen(url)).findAll(Crawler._match_tag)
      except urllib2.HTTPError:
        continue
      for link in links:
        for attr in link.attrs:
          if Crawler._match_attr(attr):
            if Crawler._is_category(attr):
              continue
            else:
              Crawler._visit(attr[1])
              if attr[1] not in _crawled:
                urls.put(attr[1]) 
```

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2009-03-29T19:26:10.257

`links`只需将其用作队列，您就可以很容易地做到这一点：

```
def get_links(url):
    "Extract all matching links from a url"
    try:
        links = BeautifulSoup(urllib2.urlopen(url)).findAll(Crawler._match_tag)
    except urllib2.HTTPError:
        return []

def crawl(self, url):
    "Get all URLS from which to scrape categories."
    links = get_links(url)
    while len(links) > 0:
        link = links.pop()
        for attr in link.attrs:
            if Crawler._match_attr(attr):
                if Crawler._is_category(attr):
                    pass
            elif attr[1] not in self._crawled:
                self._crawled.append(attr[1])
                # prepend the new links to the queue
                links = get_links(attr[1]) + links 
```

当然，这并不能解决内存问题......

# silverlight - ItemsPanelTemplate 中的模板绑定

> ID：694368
> 
> 赞同：3
> 
> 时间：2009-03-29T09:16:33.157
> 
> 标签：silverlight, controls

我正在 Silverlight 中构建一个自定义 ItemsControl，它（除其他外）允许项目在运行时水平或垂直显示。如何将 ItemsPanel 的 Orientation 属性绑定到我的父控件的 Orientation 属性？我尝试使用 TemplateBinding（在 ControlTemplate 中工作）但似乎在 ItemsPanelTemplate 中不起作用，我做错了什么吗？

```
<Style TargetType="CustomItemsControl">
    <Setter Property="ItemsPanel">
        <Setter.Value>
            <ItemsPanelTemplate>
                <StackPanel Orientation="{TemplateBinding Orientation}" />
            </ItemsPanelTemplate>
        </Setter.Value>
    </Setter>
</Style> 
```

* * *

## 回答 #1

> 赞同：9
> 
> 时间：2009-03-29T12:05:40.893

使用相对来源：

```
<Style TargetType="CustomItemsControl">
    <Setter Property="ItemsPanel">
        <Setter.Value>
            <ItemsPanelTemplate>
                <StackPanel Orientation="{Binding Orientation, RelativeSource={RelativeSource FindAncestor, AncestorType={x:Type CustomItemsControl}}}" />
            </ItemsPanelTemplate>
        </Setter.Value>
    </Setter>
</Style> 
```

评论后编辑：Silverlight 不支持 RelativeSource，但Colin Eberhardt 的[这篇文章](http://www.scottlogic.co.uk/blog/wpf/2009/02/relativesource-binding-in-silverlight/)解释了如何手动实现它。

# c# - 命令执行后调用事件

> ID：694371
> 
> 赞同：4
> 
> 时间：2009-03-29T09:21:11.803
> 
> 标签：c#, wpf, events, .net-3.5, command

我正在寻找一种能够在命令执行后运行事件的方法。我正在使用 EditingCommands（ToggleBold、ToggleItalic...等），并希望能够在命令完成任何操作后直接调用一个方法。

例如，我选择了一些文本并按 Ctrl+B 并执行 EditingCommands.ToggleBold。在文本切换后，我想调用一个方法来更新与选择 FontWeight 连接的 ToggleButton。

我尝试使用该`Executed`事件，但不幸的是，我在文本受到影响之前调用了该事件，因此使用将在一秒钟内更改的信息更新按钮。有谁知道解决这个问题的方法？

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2009-03-29T10:28:41.063

一种解决方法是在您的 Executed 处理程序中排队另一条消息：

```
void copy_Executed(object sender, EventArgs e)
{
    Dispatcher.BeginInvoke(new ThreadStart(delegate()
    {
        //do update of bold button here
    }), null);
} 
```

这将确保您的工作被添加到队列的后面，并将在具有相同或更高优先级的其他消息之后执行。

但是，我想提出一个更好的解决方案。如果您考虑一下，粗体按钮负责执行两个不同的命令：加粗和正常。它根据当前选择的文本/插入符号位置在这两个命令之间切换。因此，您可以编写一个自定义`ICommand`实现来封装两个子命令（完全未经测试的代码）：

```
public class TogglingCommand : ICommand
{
    private readonly ICommand _command1;
    private readonly ICommand _command2;
    private ICommand _activeCommand;

    public TogglingCommand(ICommand command1, ICommand command2)
    {
        _command1 = command1;
        _command2 = command2;
    }

    public ICommand ActiveCommand
    {
        get { return _activeCommand; }
    }

    public bool CanExecute(object parameter)
    {
        if (_command1.CanExecute(parameter))
        {
            _activeCommand = _command1;
        }
        else if (_command2.CanExecute(parameter))
        {
            _activeCommand = _command2;
        }
        else
        {
            _activeCommand = null;
        }

        return _activeCommand != null;
    }

    public void Execute(object parameter)
    {
        _activeCommand.Execute(parameter);
    }
} 
```

然后，您可以`TogglingCommand`使用两个命令构造 a：一个用于加粗文本，另一个用于取消粗体文本。然后，您可以将`Button`UI 中的 绑定到`ActiveCommand`属性，以根据单击命令时发生的情况以您喜欢的方式更改它。例如，如果您正在使用 a`ToggleButton`您将绑定`IsChecked`到`ActiveCommand`并转换为`true`活动命令是非粗体。当然，粗体和非粗体命令需要`CanExecute`它们自己的逻辑来检查所选文本。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-03-29T09:44:01.217

您可以使用已执行（过去时）路由事件处理程序吗？（或者也许这就是你所说的你尝试过的）

```
public partial class CustomerWindow : Window
{
    public CustomerWindow()
    {
        InitializeComponent();

        CommandBinding binding = new CommandBinding(ApplicationCommands.Copy);
        binding.Executed += new ExecutedRoutedEventHandler(this.copy_Executed);
        this.CommandBindings.Add(binding);
    }

    void copy_Executed(object sender, RoutedEventArgs e)
    {
        MessageBox.Show("Executed the Copy command");
    }
} 
```

# java - 如何解决松耦合/依赖注入和富域模型之间的冲突？

> ID：694374
> 
> 赞同：17
> 
> 时间：2009-03-29T09:23:51.733
> 
> 标签：java, spring, dependency-injection, domain-driven-design

*编辑：*这不是理论层面的冲突，而是实施层面的冲突。

*另一个编辑：* 问题在于没有将域模型作为纯数据/DTO，而不是更丰富、更复杂的对象映射，其中 Order 具有 OrderItems 和一些 calculateTotal 逻辑。具体问题是，例如，Order 需要从中国的某个 Web 服务中获取 OrderItem 的最新批发价格（例如）。所以你有一些 Spring Service 正在运行，允许在中国调用这个 PriceQuery 服务。Order 有 calculateTotal，它遍历每个 OrderItem，获取最新价格，并将其添加到总数中。

那么如何确保每个 Order 都引用这个 PriceQuery 服务呢？您将如何在反序列化、从数据库加载和新实例化时恢复它？这是我的确切问题。

最简单的方法是传递对 calculateTotal 方法的引用，但是如果您的对象在其整个生命周期内都在内部使用此服务怎么办？如果它用在 10 种方法中呢？每次传递引用都会变得混乱。

另一种方法是将calculateTotal 移出Order 并移入OrderService，但这破坏了OO 设计，我们转向旧的“事务脚本”方式。

*原帖：*

**简短版本：** 富域对象需要对许多组件的引用，但这些对象会被持久化或序列化，因此它们对外部组件（本例中为 Spring bean：服务、存储库等）的任何引用都是瞬态的并被清除。当对象被反序列化或从数据库加载时，它们需要重新注入，但这非常难看，我看不到一种优雅的方式来做到这一点。

**更长的版本：** 一段时间以来，我在 Spring 的帮助下练习了松散耦合和 DI。它在保持事情的可管理性和可测试性方面帮助了我很多。然而，不久前，我阅读了领域驱动设计和一些 Martin Fowler。因此，我一直在尝试将我的域模型从简单的 DTO（通常是表行的简单表示，只是数据没有逻辑）转换为更丰富的域模型。

随着我的域增长并承担新的职责，我的域对象开始需要我在 Spring 上下文中拥有的一些 bean（服务、存储库、组件）。这很快就变成了一场噩梦，也是转换为富域设计最困难的部分之一。

基本上有些地方我手动将应用程序上下文的引用注入到我的域中：

*   当从存储库或其他负责实体加载对象时，因为组件引用是瞬态的并且显然不会持久化
*   当从工厂创建对象时，因为新创建的对象缺少组件引用
*   当对象在 Quartz 作业或其他地方反序列化时，因为瞬态组件引用被擦除

首先，它很难看，因为我向对象传递了一个应用程序上下文引用，并期望它通过名称引用来提取它需要的组件。这不是注射，是直接拉动。

其次，这是丑陋的代码，因为在所有提到的地方我都需要注入 appContext 的逻辑

第三，它容易出错，因为我必须记住为所有这些对象注入所有这些地方，这比听起来更难。

必须有更好的方法，我希望你能对此有所了解。

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2009-03-29T18:39:54.720

我敢说，在拥有“贫血的域模型”和将所有服务塞入域对象之间存在许多灰色阴影。而且很多时候，至少在业务领域和我的经验中，一个对象实际上可能只是数据而已。例如，只要可以在该特定对象上执行的操作取决于大量其他对象和一些本地化上下文，例如地址。

在我对网上领域驱动文献的回顾中，我发现了很多模糊的想法和著作，但我并不是找不到一个合适的、非平凡的例子来说明方法和操作之间的界限应该在哪里，并且，更重要的是，如何使用当前的技术堆栈来实现它。因此，出于这个答案的目的，我将举一个小例子来说明我的观点：

考虑 Orders 和 OrderItems 的古老示例。“贫血”域模型看起来像：

```
class Order {
    Long orderId;
    Date orderDate;
    Long receivedById;  // user which received the order
 }

 class OrderItem {
     Long orderId;      // order to which this item belongs
     Long productId;    // product id
     BigDecimal amount;
     BigDecimal price;
 } 
```

在我看来，领域驱动设计的重点是使用类来更好地建模实体之间的关系。因此，非贫血模型看起来像：

```
class Order {
   Long orderId;
   Date orderDate;
   User receivedBy;
   Set<OrderItem> items;
}

class OrderItem {
   Order order;
   Product product;
   BigDecimal amount;
   BigDecimal price;
} 
```

假设您将使用 ORM 解决方案在此处进行映射。在此模型中，您将能够编写一个方法，例如`Order.calculateTotal()`，它将总结`amount*price`每个订单项目的所有内容。

因此，该模型将是丰富的，从某种意义上说，从业务角度来看有意义的操作，例如`calculateTotal`，将被放置在`Order`域对象中。但是，至少在我看来，领域驱动设计并不意味着`Order`应该了解您的持久性服务。这应该在一个单独的独立层中完成。持久性操作不是业务领域的一部分，它们是实现的一部分。

即使在这个简单的例子中，也有很多陷阱需要考虑。`Product`应该用每个加载整个`OrderItem`吗？如果有大量订单项目，并且您需要大量订单的摘要报告，您会使用 Java，将对象加载到内存中并`calculateTotal()`在每个订单上调用吗？或者，从各个方面来看，SQL 查询是一个更好的解决方案。这就是为什么像 Hibernate 这样体面的 ORM 解决方案提供了精确解决这类实际问题的机制：前者的代理延迟加载和后者的 HQL。如果报告生成需要很长时间，理论上合理的模型会有什么好处？

当然，整个问题非常复杂，我可以一口气写下来或考虑。而且我不是站在权威的立场上发言，而是在部署业务应用程序时进行简单的日常实践。希望你能从这个答案中得到一些东西。随意提供一些额外的细节和你正在处理的例子......

**编辑**：关于`PriceQuery`服务，以及在计算总数后发送电子邮件的示例，我会区分：

1.  价格计算后应发送电子邮件的事实
2.  应发送订单的哪一部分？（这也可能包括电子邮件模板）
3.  发送电子邮件的实际方法

此外，人们不得不怀疑，发送电子邮件是一种固有的能力`Order`，还是可以用它完成的另一件事，比如持久化它、序列化为不同的格式（XML、CSV、Excel）等。

我会做什么，以及我认为好的 OOP 方法如下。定义一个接口，封装电子邮件的准备和发送操作：

```
 interface EmailSender {
     public void setSubject(String subject);
     public void addRecipient(String address, RecipientType type);
     public void setMessageBody(String body);
     public void send();
 } 
```

现在，在`Order`类内部，定义一个操作，通过该操作，订单“知道”如何使用电子邮件发件人将自己作为电子邮件发送：

```
class Order {
...
    public void sendTotalEmail(EmailSender sender) {
        sender.setSubject("Order " + this.orderId);
        sender.addRecipient(receivedBy.getEmailAddress(), RecipientType.TO);
        sender.addRecipient(receivedBy.getSupervisor().getEmailAddress(), RecipientType.BCC);
        sender.setMessageBody("Order total is: " + calculateTotal());
        sender.send();
    } 
```

最后，您应该对您的应用程序操作有一个外观，这是对用户操作的实际响应发生的地方。在我看来，这是您应该（通过 Spring DI）获取服务的实际实现的地方。例如，这可以是 Spring MVC`Controller`类：

```
public class OrderEmailController extends BaseFormController {
   // injected by Spring
   private OrderManager orderManager;  // persistence
   private EmailSender emailSender;    // actual sending of email

public ModelAndView processFormSubmission(HttpServletRequest request,
                                          HttpServletResponse response, ...) {
    String id = request.getParameter("id");
    Order order = orderManager.getOrder(id);
    order.sendTotalEmail(emailSender);

    return new ModelAndView(...);
} 
```

这是您使用这种方法得到的结果：

1.  域对象不包含服务，它们**使用**它们
2.  由于接口机制的性质，域对象与实际的服务实现（例如 SMTP、在单独的线程中发送等）分离
3.  服务接口是通用的、可重用的，但不知道任何实际的域对象。例如，如果 order 有一个额外的字段，您只需更改`Order`类。
4.  您可以轻松地模拟服务，并轻松地测试域对象
5.  您可以轻松测试实际的服务实现

我不知道这是否符合某些大师的标准，但这是一种脚踏实地的方法，在实践中效果相当不错。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2009-04-24T17:21:35.440

关注

> 如果您的订单在每次计算总额时都需要发送一封电子邮件怎么办？

我会雇用事件。
如果在订单计算其总数时它对您有意义，则让它引发一个事件作为 eventDispatcher.raiseEvent(new ComputedTotalEvent(this))。
然后你监听这种类型的事件，并如前所述回调你的订单，让它格式化一个电子邮件模板，然后你发送它。
您的域对象仍然很精简，不知道您的需求。
简而言之，将您的问题分为两个要求：
- 我想知道订单何时计算其总数；
- 当订单有（新的和不同的）总数时，我想发送电子邮件；

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2009-04-26T17:50:41.407

我找到了答案，至少对于那些使用 Spring 的人来说：

[6.8.1\. 使用 AspectJ 通过 Spring 依赖注入域对象](http://static.springsource.org/spring/docs/2.5.x/reference/aop.html#aop-atconfigurable)

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2009-04-08T05:30:32.440

我能想到的最简单的方法是在您的数据访问层中添加一些逻辑，该逻辑将在将域对象返回到更高层（通常称为服务层）之前注入其依赖项。您可以注释每个类的属性以指示需要连接的内容。如果您不在 Java 5+ 上，您可以为需要注入的每个组件实现一个接口，或者甚至在 XML 中声明这一切，并将该数据提供给将进行连接的上下文。如果你想变得花哨，你可以把它拉到一个方面，并在你的数据访问层全局应用它，这样所有拉出域对象的方法都会在它们返回后将它们连接起来。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2009-03-29T10:36:03.883

也许您想要的是一种引用对象，它将序列化为全局引用（例如 URI），并且在其他地方反序列化时能够作为代理复活。

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2009-03-29T10:58:26.297

[身份映射](http://martinfowler.com/eaaCatalog/identityMap.html)模式可能对您的方案有所帮助。查看Jeremy Miller 撰写的[Patterns In Practice](http://msdn.microsoft.com/en-us/magazine/dd569757.aspx)文章，他在其中讨论了这种模式。

# wpf - WPF 四元上下文菜单

> ID：694377
> 
> 赞同：2
> 
> 时间：2009-03-29T09:26:56.500
> 
> 标签：wpf, wpf-controls, contextmenu

**注意此问题已更新，请继续阅读**

你好，

我想创建一个自定义上下文菜单，它有 4 个子菜单，每个子菜单都在自己的象限（左上、右上、左下、右下）。类似于 3ds Studio Max。

到目前为止，我是这样处理这个问题的： - 创建一个自定义 WPF 控件，派生自 ContextMenu[1]
- 声明 ContextMenu 的 4 个依赖属性，这些将是显示的菜单，并且可以从 XAML 中设置。
- AddOwner 到 ContextMenu.IsOpenProperty，添加属性更改通知。
- 当 IsOpen 属性更改时，设置 4 个子上下文菜单的 IsOpen 属性。
- 使用 ContextMenuService 设置上下文菜单的垂直和水平偏移量，使它们出现在每个象限中；绑定实际的高度和宽度属性来计算偏移量。

[1] 需要从上下文菜单派生，否则不能将其分配给 Window 上的 ContextMenu 属性。

这*似乎*可行，菜单**不**保持打开存在问题（由于焦点在菜单之外，它们正在关闭），但我确信使用 Reflector.NET 可以找到解决方法。

这是我尝试编写的第一个自定义 WPF 控件；并且不确定这是否是最好的方法。

关于如何创建这个四元上下文菜单的任何建议/想法？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-03-29T22:22:42.517

我可以想到两种方法，两种方法都不一定那么干净，但如果你有时间的话，它们都有可能发挥作用。

方法一

使用上下文菜单，但通过设置模板使 ContextMenu 真正只显示碰巧打开其他窗口的控件。也许可以做一些技巧，这样打开这些二级菜单就不会把焦点移开。这可能最终仍会导致原始问题。

方法二

如果您将 ContextMenu.StaysOpen 设置为 false，然后尝试自行控制菜单何时关闭，会发生什么情况？

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-05-17T21:39:05.253

# **更新**

好的。*在*玩弄了自定义控件之后，我有了一些比以前更好的东西。现在所有菜单都保持打开状态。

我所做的：
- 创建了从 ContextMenu 派生的名为 QuadContextMenu 的自定义控件，覆盖默认样式键。
- 控件的样式有 4 个弹出原语：
- 每个都有 PART_ 名称，所以我在 OnApplyTemplate 时得到对它们的引用。
- 每个都有子 QuadMenu，这是从 MenuBase 派生的自定义控件。
- 每个都有它们的 VerticleOffset 和 Horizo​​ntalOffset 属性绑定到子 [2] 的 ActualHeight 和 ActualWidth。

QuadMenu 样式/控件模板：
- 具有带停靠面板的经典边框，以及带有用于放置菜单名称的文本块的边框。

[2] 如何将菜单定位到四边形中： - TopLeft 偏移为负，实际宽度和高度
- TopRight 偏移为负，实际高度 - BottomLeft
偏移为负，实际高度
- BottomRight 未**偏移**并且位于其原始位置

[![替代文字](https://i.stack.imgur.com/RvDag.jpg)](https://i.stack.imgur.com/RvDag.jpg)

# **新问题/问题**

这些是进行此控制的下一个挑战：
1\. 目前，键盘和鼠标被您关注的第一个菜单锁定/捕获，而将鼠标悬停在其他菜单上则无法使用。这意味着您只能使用其中一个菜单。
2\. 翻转MenuItem，以便TopLeft/BottomLeft 的子菜单在左侧打开。

我已经尝试通过覆盖 GetContainerForItemOverride 方法以返回 QuadMenuItem 来替换菜单项。QuadMenuItem 是从 MenuItem 派生的自定义控件。但是，当我这样做时，我失去了令人沮丧的子菜单功能。

**如果有人对如何解决这些问题有任何提示/技巧/建议，将不胜感激！:D 谢谢**

# java - OOP 术语：“容器”和“集合”

> ID：694387
> 
> 赞同：9
> 
> 时间：2009-03-29T09:42:53.217
> 
> 标签：java, c++, oop, terminology

C++ 术语“容器”是否只是 Java 术语“集合”的同义词？

* * *

## 回答 #1

> 赞同：14
> 
> 时间：2009-03-29T09:48:17.667

是的。

但是，如果我可以在这里推测的话，C++ 术语*容器*更好地强调了所包含项目的所有权，而不是 Java 的*collection*，其中没有明确的内存所有权（由于垃圾收集）。

C++ 容器中的项目在容器被销毁时被销毁（因此项目被*包含*或拥有），在 Java 中，如果集合本身被垃圾回收，项目可能会继续存在。

* * *

## 回答 #2

> 赞同：6
> 
> 时间：2009-03-29T10:49:34.477

[容器（维基百科）](http://en.wikipedia.org/wiki/Container_(data_structure))
[集合（维基百科）](http://en.wikipedia.org/wiki/Collection_(computing))

如果我理解正确 - 通常这种差异并不显着。

当我们谈论对象组时，我们说“对象集合”。
如果我们谈论包含一组对象的数据结构，我们说容器。

例如：std::vector< int > - 整数集合或包含整数的容器向量。

# amazon - 亚马逊会员报告更新间隔

> ID：694391
> 
> 赞同：0
> 
> 时间：2009-03-29T09:45:49.263
> 
> 标签：amazon

亚马逊会员报告系统的更新间隔是多少？我的帐户似乎在 24 小时内只更新一次。

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2009-03-29T12:46:26.800

Amazon Affiliates 网站本身声明（或曾经声明）“报告每 24 小时更新一次”。

我说“曾经陈述过”是因为自从我最初回答这个问题以来它已经改变了。

但是，如果您导航到[https://affiliate-program.amazon.com/gp/associates/help/t9?ie=UTF8&pf_rd_t=501&ref_=amb_link_10038041_1&pf_rd_m=ATVPDKIKX0DER&pf_rd_p=&pf_rd_s=assoc-center-2&pf_rd_r的“了解报告”页面=&pf_rd_i=assoc_help_main](https://affiliate-program.amazon.com/gp/associates/help/t9?ie=UTF8&pf_rd_t=501&ref_=amb_link_10038041_1&pf_rd_m=ATVPDKIKX0DER&pf_rd_p=&pf_rd_s=assoc-center-2&pf_rd_r=&pf_rd_i=assoc_help_main)，你会看到：

> **通过我们每天更新**的绩效报告，您可以获得数据...

# asp.net - 在不离开页面的情况下将新项目添加到 html-select 列表。如何？

> ID：694396
> 
> 赞同：1
> 
> 时间：2009-03-29T09:52:31.773
> 
> 标签：asp.net, jquery, user-interface, html-select

我一直想知道在网站中向 html-select 添加新项目的最佳方法是什么。是的，这可能听起来很傻，但从可用性的角度来看，这是一个很大的问题。我不希望用户每次需要将新项目添加到 html-select 时都被带到一个新页面。

我喜欢 Google Reader 和 Gmail 在“添加文件夹”和“添加标签”功能中处理这个问题的方式。我想模仿，但我不知道他们是怎么做到的。

我正在使用 jQuery，因此欢迎对插件、代码示例或教程的任何参考。我希望它尽可能模块化，以便我可以在任何地方重复使用它。

我使用 ASP.NET 3.5 web-forms、Microsoft Access 2003、jQuery、IIS 5 和 Win XP Professional 作为 web 服务器。

谢谢。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-03-29T10:58:47.137

有一个[jquery select 插件](http://www.texotela.co.uk/code/jquery/select/)可以帮助你。我已经在客户端操作了选择列表，并且后续表单提交没有问题，但是您需要在 asp.net 上做一些实验

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-03-29T10:01:42.000

执行此操作的标准技术称为[ajax](http://en.wikipedia.org/wiki/Ajax_(programming))，这基本上意味着仅替换页面的一部分。[JQuery ajax](http://docs.jquery.com/Ajax)和可能的[教程](http://www.ibm.com/developerworks/library/x-ajaxjquery.html)应该可以帮助您。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-03-29T10:53:07.183

这种情况下的一个常见错误是在客户端上添加项目（使用 jQuery 或纯 javascript）。看起来它可能会在下一次回发之前有效。不幸的是，Asp.NET 回发模型不允许仅在客户端更改控件内容。所以基本上有两种选择：

*   使用 ajax（最简单的方法是使用 UpdatePanel）
*   进行正常回发以添加项目（如果性能不是问题，则代码简单且快速 - 例如对于 Intranet 应用程序）

# c# - C#跨线程操作错误

> ID：694397
> 
> 赞同：3
> 
> 时间：2009-03-29T09:53:22.410
> 
> 标签：c#, multithreading

在用于模拟局域网信使的 ac# 程序中，我有一个用于 beginreceive 的回调函数，我需要显示在特定文本框中接收到的文本.. this.textBox1.Text = sb.ToString(); 但是，这样做时，我得到了一个跨线程操作无效的错误。我确实意识到我需要使用 object.invoke 方法，但是您能否提供我调用委托的完整代码，因为在线程方面我仍然很天真。谢谢

* * *

## 回答 #1

> 赞同：8
> 
> 时间：2009-03-29T09:56:55.210

您需要将工作推回 UI；幸运的是，这很容易：

```
this.Invoke((MethodInvoker) delegate {
    this.textBox1.Text = sb.ToString();
}); 
```

这使用 C# 的“匿名方法”和“捕获的变量”功能来完成所有繁重的工作。在 .NET 3.5 中，您可能更喜欢使用`Action`，但这并没有真正的区别：

```
this.Invoke((Action) delegate {
    this.textBox1.Text = sb.ToString();
}); 
```

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2009-03-29T09:58:12.197

你可以这样使用它：

```
void MyCallback(IAsyncResult result)
{
if (textBox1.InvokeRequired) {
    textBox1.Invoke(new Action<IAsyncResult>(MyCallBack),new object[]{result});
    return;
}
// your logic here
} 
```

# c# - 最大化窗口大小

> ID：694399
> 
> 赞同：3
> 
> 时间：2009-03-29T09:54:19.103
> 
> 标签：c#

我有一个通过以下方式存储窗口大小的函数：

```
size_W = this.Width;
size_H = this.Height; 
```

当我调整窗口大小时，这没关系。但是，当使用最大化按钮时，窗口的大小无法正确存储。我该怎么做？

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2009-03-29T09:58:04.757

你是在最大化*之前的窗口大小吗？*在 WinForms 中，这保存在[RestoreBounds](http://msdn.microsoft.com/en-us/library/system.windows.window.restorebounds.aspx)属性中。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2009-03-29T10:20:57.227

标准方法是同时存储 Size**和**布尔值`MainForm.WindowState == FormWindowState.Maximized`

# c# - C#/VS2008：向项目添加单独的调试/发布引用

> ID：694415
> 
> 赞同：35
> 
> 时间：2009-03-29T10:16:09.470
> 
> 标签：c#, visual-studio-2008, project

在向 VS 2008 C# 项目添加用户控件或项目引用时，我只能添加程序集的一种配置。是否可以添加单独的配置，具体取决于容器项目的配置。

例如，我正在开发一个用户控件，并且正在开发一个示例应用程序。我想添加用户控件，以便示例的调试版本将使用用户控件的调试版本，而示例的发布版本将使用用户控件的发布版本。

有什么建议么？

* * *

## 回答 #1

> 赞同：32
> 
> 时间：2011-02-15T10:22:49.223

```
<Reference Include="MyLibrary">
  <HintPath>..\$(Configuration)\MyLibrary.dll</HintPath>
</Reference> 
```

如果在调试模式下编译，则添加一个引用“..\Debug\MyLibrary.dll”，如果在发布模式下编译，则添加一个引用“..\Release\MyLibrary.dll”。

* * *

## 回答 #2

> 赞同：29
> 
> 时间：2009-03-29T10:21:46.493

您可以通过编辑 csproj 文件来做到这一点；向引用添加“条件”属性。

```
<Reference Include="Foo" Condition="'$(Configuration)'=='Debug'"/>
<Reference Include="Bar" Condition="'$(Configuration)'=='Release'"/> 
```

但是，我会担心这对单元测试意味着什么。

* * *

## 回答 #3

> 赞同：5
> 
> 时间：2009-03-30T01:02:01.697

虽然@Marc Gravell 的建议可行，但您是否有理由不希望两个项目在同一个解决方案中？如果它们在同一个解决方案中，您可以在将用户控件项目引用到示例应用程序的项目时添加项目引用。使用项目引用时，Visual Studio 将自动为 Debug 版本添加 Debug 版本，为 Release 版本添加 Release 版本。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2019-04-26T20:55:25.527

而不是直接添加对 .dll 的引用，这会迫使您在调试或发布文件夹中的 .dll 之间进行选择，您应该通过选择“项目引用”来添加引用。[此链接](https://www.c-sharpcorner.com/article/project-reference-vs-dll-reference-in-visual-studio/)说明了如何通过 .dll 与项目项目引用添加引用。出于您的目的，您应该选择后者。

另请参阅[我的回答](https://stackoverflow.com/a/55853814/6664129)以了解何时将引用添加为 .dll 与引用作为项目。

# php - 如何使用字符串映射枚举或反之亦然以保存到数据库中？

> ID：694424
> 
> 赞同：0
> 
> 时间：2009-03-29T10:21:48.660
> 
> 标签：php, cakephp

我在我的数据库中有一个可以有枚举值（'G'，'Y'，'M'）的coloumn say代理，其中G = google Y = yahoo M = msn

我应该如何将来自我的函数的输出映射为我的代码中的 G，以便数据库识别并保存它？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2009-03-29T11:07:32.123

我认为最简单的方法是**获取枚举值的 int 表示**。枚举是背景中的数字，因此通常很容易将枚举成员转换为数字，反之亦然。

您可以编写一个**转换器类**以获得最佳灵活性。您可以处理枚举值并生成一个字符串，或者获取一个字符串并返回一个枚举成员。您可以在一个简单的 if-then-else 或 switch-case 结构中做到这一点。

如果您使用的是 .NET (C#)，请注意，即使您指定了枚举，也可以将任何数字作为参数传递，因此在转换时必须使用 else 或默认分支。

如果您使用的是**PHP**，这是一个示例：

```
 $myEnum = array ("red" => 1,"blue" => 2,"yellow" => 3); 
 $d = $myEnum["red"]; 
```

你会得到 1 红色， 3 黄色。如果要使用字符串：

```
$myEnum = array ("Google" => "G","Yahoo" => "Y","MSN" => "M"); 
$d = $myEnum["Google"]; 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-03-29T17:59:28.187

您已经在使用 ENUM 数据类型，它们只是一个整数。为什么不（在您定义 ENUM 的 DB 模式中）只定义 ENUM('Google','Yahoo','MSN', ...)？这就是我所做的——然后，当您拉/推数据时，您可以只使用文字枚举值（当您从数据库中获取数据时，PHP 会将其视为字符串，而 MySQL 将处理从 PHP 传递的字符串作为枚举类型，假设它是相同的）。

真的没有理由使用“G”而不是“Google”，除非你真的是一个懒惰的打字员。如果你那么懒惰，你为什么要在你的代码中添加另一层间接层，这是不必要的？

编辑：很抱歉这篇文章的语气——它比预期的要严厉得多。我只是碰巧强烈反对不必要的间接。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-01-18T09:57:19.350

由于 Cake 不支持枚举，您可能需要使用 tinyint(2) 字段和这种方法： http: [//www.dereuromark.de/2010/06/24/static-enums-or-semihardcoded-attributes/](http://www.dereuromark.de/2010/06/24/static-enums-or-semihardcoded-attributes/)

它更快、更容易维护，并且还可以与您的（自定义）烘焙模板一起使用。

# sql-server - SSRS 配置的新功能

> ID：694425
> 
> 赞同：7
> 
> 时间：2009-03-29T10:22:46.117
> 
> 标签：sql-server, sql-server-2005, reporting-services

我正在尝试`SSRS`在`SQL 2005`. 当我点击`Reporting Services Configuration`时，我收到一条消息说

> 在指定的计算机上未找到任何报表服务器 - 详细信息 命名空间无效。

我该如何解决这个问题？

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2009-03-29T10:29:14.277

因此，您不会“在 SQL Server 2005 上配置 SSRS”。

它是您在安装时选择的组件（如分析服务、集成服务等）。对于 SSRS，您需要 IIS 作为先决条件，如果 IIS 不存在，则不会安装它。

如果没有安装 SSRS，错误本身是 100% 正确的......

真的安装了吗？

编辑：

刚刚在我的一个提要上得到了这个：[KB 960374](http://support.microsoft.com/kb/960374/EN-US)，它描述了上面的确切错误

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-10-22T16:23:39.797

非常简单。将带有 SQL 的光盘放入并运行安装程序。向现有实例添加功能并选择 Reporting Services。一旦安装，它将在您的 SQL Server 上创建 2 个名为 ReportServer 和 ReportServerTempDB 的数据库

打开服务配置，系统会提示您连接到 Reporting Services 的实例。

如果您看到此屏幕，那么您就可以开始了。

--只有在您可能有问题要问时才阅读此内容

1.  为网络服务设置一个服务帐户（保存 .snk 密钥，它将创建您的 IIS 条目等。如果您没有 IIS，则将您的操作系统升级到兼容版本。它可以通过添加或删除 Windows 功能安装）

2.  确保在“数据库”部分中选择了您的新数据库。如果没有，请按照屏幕添加它

3.  打开报告管理器 URL 并单击链接。（您可能需要以管理员身份进入）

4.  当您想要部署报告时，只需使用指向设置服务帐户后可用的 Web 服务 URL 的 TargetURL 更新您的解决方案属性）

如果您需要指导，请进一步询问。在过去的一个月里，我已经对大约 5 台服务器进行了此操作，所以我知道会出现什么问题。

干杯，

# svn - 将文件夹与 Subversion 存储库同步

> ID：694427
> 
> 赞同：1
> 
> 时间：2009-03-29T10:24:48.687
> 
> 标签：svn, command-line, nant, nantcontrib

有没有一种快速的方法、命令行工具或其他任何东西，可以查看文件夹并计算出添加新文件、删除旧文件、更新现有文件然后提交所有文件所需的 SVN 操作？

我正在通过 nant 将其连接起来，并且不想自己搞砸。

谢谢

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-03-29T10:38:37.343

您可以构建一个脚本来解析`svn status`（您可以根据需要添加`--xml`）的输出并删除不再存在的内容（`!`），添加未版本化的内容（`?`），然后提交所有内容。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2009-03-29T11:05:16.747

我假设您要自动同步的文件夹是版本化文件夹？

如果是这种情况，只需运行

```
svn add -R syncedfolder 
```

将所有新文件添加到版本控制。

如果您更新了现有文件，svn 将自动检测这些文件。此外，您已删除的文件将被 svn 检测为“丢失”，当您提交“同步文件夹”时，这些丢失的文件将自动在存储库中删除。

# php - 创建灵活的更新查询

> ID：694437
> 
> 赞同：1
> 
> 时间：2009-03-29T10:35:52.497
> 
> 标签：php, mysql, sql-update

我正在尝试创建一个灵活的更新查询。我现在有这样的东西：

```
 $lsQuery = "UPDATE `";
        $lsQuery .= $psTableName;
        $lsQuery .= " SET ";
        foreach($psValues as $lsKey => $lsValue)
        {
            $lsQuery .= $lsKey;
            $lsQuery .= " = '";
            $lsQuery .= $lsValue;
            $lsQuery .= "' AND ";
        }
        $lsQuery .= "` ";
        $lsQuery .= "WHERE ";
        if(isset($psWhere)){
            foreach($psWhere as $lsKey => $lsValue)
            {
                $lsQuery .= $lsKey;
                $lsQuery .= " = '";
                $lsQuery .= $lsValue;
                $lsQuery .= "' AND ";
            }
        }
        $lsQuery = substr($lsQuery,0,(strlen($lsQuery)-5)); 
```

但是当我在屏幕上打印我的查询时，我会得到如下信息：

更新`persons SET per_password = '2a6445462a09d0743d945ef270b9485b' AND`per_email = 'bla@gmail.com'

我怎样才能摆脱这个额外的'AND'？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2009-03-29T10:49:01.623

我可能会开始：

```
function update($table, $set, $where) {
  $change = array();
  foreach ($set as $k => $v) {
    $change[] = $k . ' = ' . escape($v);
  }
  $conditions = array();
  foreach ($where as $k => $v) {
    $conditions[] = $k . ' = ' . escape($v);
  }
  $query = 'UPDATE ' . $table . ' SET ' .
    implode(', ', $change) . ' WHERE ' .
    implode(' AND ', $conditions);
  mysql_query($query);
  if (mysql_error()) {
    // deal with it how you wish
  }
}

function escape($v) {
  if (is_int($v)) {
    $v = intval($v);
  } else if (is_numeric($v)) {
    $v = floatval($v);
  } else if (is_null($v) || strtolower($v) == 'null') {
    $v = 'null';
  } else {
    $v = "'" . mysql_real_escape_string($v) . "'";
  }
  return $v;
} 
```

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2009-03-29T11:40:03.980

如果您想保留现有代码。

```
$lsWhere = array();
foreach($psWhere as $lsKey => $lsValue)
{
    $lsWhere[] = $lsKey." = '".mysql_real_escape_string($lsValue)."'";
}
$lsQuery .= join(" AND ", $lsWhere); 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-03-29T10:49:48.470

这不是我特别引以为豪的解决方案，但您可以随时添加`$lsQuery .= 'someField=someField'`.

# asp.net - 管理标题模板？

> ID：694439
> 
> 赞同：0
> 
> 时间：2009-03-29T10:36:12.807
> 
> 标签：asp.net, html, web

我是创建 html 页面等的新手——但我使用 VS 2008 只是为了编辑/智能感知功能。

我的问题是我有一个纯 HTML 的网站（没有 ASP.NET），并且有一个相当广泛的标题，必须在每个页面中使用。每次更改一个页面时，都要更改所有页面的 HTML 标题部分，这是令人沮丧的。有没有办法我可以在其他 HTML 页面中“包含”标题部分 HTML，而不必手动剪切粘贴？

请注意 - 我没有使用 ASP.NET，所以我不能也将不能使用母版页。是否有其他一些技术是我想知道的 - 这样当我在 1 个地方更改标题模板时，它会反映在所有其他地方。我想到了内联框架，但不确定这是否是一种糟糕的方式以及它是否会影响 SEO

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-03-29T10:53:38.197

看看[服务器端包含](http://en.wikipedia.org/wiki/Server_Side_Includes)

它们将允许您在一个文件中编辑您的标题，该文件将立即出现在包含该标题文件的所有页面上。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-03-29T10:59:53.187

是的，看看SSI。服务器端包含是告诉您的 Web 服务器在 HTML 页面的各个点插入各种内容的简单方法。

例子：

```
<html>
<head>
    <!--#include FILE="head.html" -->   
</head>
<body>

</body>
</html> 
```

如果服务器端包含似乎没有按预期工作，请尝试使用 .shtml 文件扩展名重命名页面。

一些 Web 服务器要求您将文件命名为“.shtml”而不是“.html”，以便启用文件解析。

# c# - 使用泛型在 .NET 中向上转换

> ID：694449
> 
> 赞同：1
> 
> 时间：2009-03-29T10:50:10.857
> 
> 标签：c#, .net

所以我有一个这样的课程：

```
public class A { 
  internal A(int i) { ... }
  public int Foo { get; set; }
} 
```

然后这个类被一堆生成的类继承，例如：

```
public class B : A {
  ...
} 
```

基于`int`的构造函数不暴露给继承的类（出于设计原因，我不希望它暴露）。在我的包含类定义的库中，`A`我有一个这样的方法：

```
public T Load<T>() where T : A {
  //do some stuff, create an instance of T from an int, then return it
} 
```

然后我会这样使用它：

```
B b = Helper.Load<B>(); 
```

由于我要使用的构造函数在我这样做时没有暴露给类`B`，`typeof(T).GetConstructor(typeof(int))`所以我没有得到构造函数，所以我想我会这样做：

```
return (T)new A(/*some int */); 
```

但这给了我一个运行时错误`System.InvalidCastException`，我无法将 A 类型转换为 B 类型。

我该如何实现这种向上转换？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2009-03-29T11:11:54.390

您可以只使用默认构造函数，以便使用 new() 约束实例化 T 类型的对象。然后类 A 可以有一个虚拟（或您喜欢的抽象）方法，该方法将 int 作为参数并在构造函数运行后初始化对象。

```
public class A {
    internal A() { }
    internal Initialize(int i) { Foo = i; }
    public int Foo { get; set; }
}

public class B : A { 
    internal B() { }
}

...

public T Load<T>() where T : A, new() {
    var ret = new T();
    ret.Initialize(i);
    return ret;
} 
```

如果您打算使用某种工厂模式，则无需犹豫在构造函数调用之外初始化对象的某些部分，只要在将对象返回给调用者的控件之前完成即可。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-03-29T10:58:00.837

据我了解，T 派生自 A，因此您不能将 A 转换为 T。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2009-03-29T11:01:03.373

在您的示例中，您不能将 A 向上转换为 B，因为：

```
return (T)new A(/*some int */); 
```

实例化一个**不是**B 的 A。仅仅因为“B 是 A”并不意味着“A 是 B”。您必须首先实例化一个 B，将其转换为 A，做您想做的事情，然后将其向上转换回 B。

我不确定这是否会编译，但你可以试试这个：

```
T blah = new T(5); //this means your B will need to implement a int constructor
A blah2 = (A)blah;
//operate on A specific operations in blah2
T upcasted = (T)blah2;
//alternatively
T upcasted = blah2 as T; 
```

考虑重构您的构造函数，以便将整数初始化为属性，而不是构造函数的参数。我努力拥有默认（无参数）构造函数，以便通用代码可以轻松地实例化类。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2009-03-29T11:13:29.067

你不能这样做，改变你的设计。

# c# - 如何在 C++ 中使用河豚作为 C# 中的外部 dll

> ID：694454
> 
> 赞同：0
> 
> 时间：2009-03-29T10:53:26.557
> 
> 标签：c#, external, blowfish

似乎 C# 中没有和[这个](https://stackoverflow.com/questions/694331/blowfish-in-c)一样的河豚。所以我决定将它用作外部，如果它不能再次工作，那么在 C# 中翻译整个河豚。但首先我会尝试用作外部。

您能否看一下[C++ 河豚](http://pastebin.com/m178ea218)并告诉我是否必须更改函数参数（其中一些是 LPBYTE，不包含在 C# 中）。

另外，如果您告诉我如何将它们用作外部 dll（我已经将其编译为 dll），我将不胜感激，但是 C++ 中的函数参数让我感到沮丧。

**编辑：** 我只需要调用 Initialize、Encode 和 Decode。

提前致谢！

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-03-29T13:01:39.807

我在以前的项目中遇到过类似的问题。查看 C++ 代码后，它使用的是您在上一篇文章中怀疑的 ECB。我想我明白了使用 Blowfish.NET 获得不同结果的原因（Arkain 的建议）。C++ 代码在加密时将输入转换为两个 DWORD。我相信 Blowfish.NET 将通过在其内部用于加密的 DWORD 中保留字节顺序来做正确的事情。

例如：在 C++ 代码中，字节 0102030405060708 变为 0x04030201 和 0x08070605。.NET 实现将变为 0x01020304 和 0x05060708。

# python - 如何使用python挂钩到Windows中的事件/消息

> ID：694475
> 
> 赞同：10
> 
> 时间：2009-03-29T11:15:10.030
> 
> 标签：python, windows, wmi, power-management

## 简而言之：

我想截取笔记本电脑上的**挂起/待机消息**，但我的程序没有收到所有相关消息。

## 背景：

在 windows xp/2k 上的 ms-excel 中有一个错误，如果在网络/USB 驱动器上打开文件，它会阻止系统挂起。

我正在尝试以编程方式解决它（我的工具箱包括 python、vb6 或命令行工具）。

我对 Windows 仪表一无所知:-)

我有一个 sysinternals 实用程序，无论如何都会暂停系统。我想把它和闭盖事件挂钩！

## 长：

笔记本盖子关闭（富士通u810）启动待机程序[如何？]

然后系统向所有人发送 WM_POWERBROADCAST: PBT_APMQUERYSUSPEND（我可以使用 跟踪他们`SPYXX.EXE`）

每个程序都回答“真”，直到excel回答“假”，整个过程就停止了。

## 我的问题：

1）我的python程序既没有捕获pbm_apmquerysuspend，也没有捕获PBT_APMQUERYSTANDBYFAILED，也没有捕获PBT_APMQUERYSUSPENDFAILED：` ...

```
query = "SELECT * FROM Win32_PowerManagementEvent"

power_watcher = wmi.ExecNotificationQuery ( query )

power_event = power_watcher.NextEvent () 
```

` 如果待机最终发生，它只接收 PBT_APMSUSPEND。

为什么不 - 我如何拦截它？

2）还有其他方法可以拦截待机进程吗？

在一个完美的世界里，我会设置盖子关闭事件来运行我选择的命令。在一个完美的世界里，合盖是一个记录在案的事件。

谢谢你们 ：-）

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-04-02T00:47:07.310

我发现了一个丑陋的解决方法：我编写了一个[AutoIt](http://www.autoitscript.com/autoit3/)脚本，它检测 Excel 的错误 MessageBox，将其关闭，然后运行一个 sysinternals 实用程序来强制计算机待机。

```
Opt("WinWaitDelay",400)
; -- 精确的文本匹配，节省大量的杯子循环！
Opt("WinTitleMatchMode",3)
Opt("WinDetectHiddenText",1)
Opt("鼠标坐标模式",0)
; Opt("WinSearchChildren",1)
暗淡 $title = "微软 Excel"
dim $text = "Windows 无法进入待机状态，因为正在从网络访问 Microsoft Office 文档或应用程序组件。您必须关闭打开的文档或退出应用程序才能使计算机进入待机状态。"
虽然是真的
     ; 等待excel的错误信息
     WinWait($title, $text)
     运行（“psshutdown.exe -c -d -accepteula -m mooshmoosh -t 5”）
     ; 没有“睡眠”，烦人的 msgbox 不会关闭
     睡眠(1000)
     ; 关闭烦人的模态消息框！
     WinClose($title)
     ;1分钟延迟，节省cpu (?)
     睡眠(1*60*1000)
结束

```

（这是一个优化版本 - 第一次试验是 CPU 密集型的）。
现在它位于系统托盘中并且可以正常工作。

丢失的消息问题仍然悬而未决。虽然我首先意识到它与 python 无关。

# django - 获取对象的 Django 管理 url

> ID：694477
> 
> 赞同：210
> 
> 时间：2009-03-29T11:19:22.157
> 
> 标签：django, django-admin, django-urls

在 Django 1.0 之前，有一种简单的方法可以获取对象的 admin url，我编写了一个小过滤器，我会像这样使用它：`<a href="{{ object|admin_url }}" .... > ... </a>`

基本上我正在使用视图名称为的 url reverse 函数`'django.contrib.admin.views.main.change_stage'`

```
reverse( 'django.contrib.admin.views.main.change_stage', args=[app_label, model_name, object_id] ) 
```

获取网址。

正如您可能已经猜到的那样，我正在尝试更新到最新版本的 Django，这是我遇到的障碍之一，获取管理 url 的方法不再起作用。

我怎样才能在 django 1.0 中做到这一点？（或者 1.1 ，因为我正在尝试更新到 svn 中的最新版本）。

* * *

## 回答 #1

> 赞同：486
> 
> 时间：2010-05-28T15:22:17.307

您可以直接在模板中使用 URL 解析器，无需编写自己的过滤器。例如

`{% url 'admin:index' %}`

`{% url 'admin:polls_choice_add' %}`

`{% url 'admin:polls_choice_change' choice.id %}`

`{% url 'admin:polls_choice_changelist' %}`

参考：[文档](https://docs.djangoproject.com/en/dev/ref/contrib/admin/#reversing-admin-urls)

* * *

## 回答 #2

> 赞同：115
> 
> 时间：2009-11-12T09:17:32.700

```
from django.core.urlresolvers import reverse
def url_to_edit_object(obj):
  url = reverse('admin:%s_%s_change' % (obj._meta.app_label,  obj._meta.model_name),  args=[obj.id] )
  return u'<a href="%s">Edit %s</a>' % (url,  obj.__unicode__()) 
```

这类似于 hansen_j 的解决方案，只是它使用[url 命名空间](http://docs.djangoproject.com/en/dev/topics/http/urls/#defining-url-namespaces "网址命名空间")，admin: 是管理员的默认应用程序命名空间。

* * *

## 回答 #3

> 赞同：65
> 
> 时间：2009-05-11T21:40:14.190

我有一个类似的问题，我会尝试打电话`reverse('admin_index')`并不断`django.core.urlresolvers.NoReverseMatch`出错。

原来我的 urls.py 文件中有旧格式的管理 url。

我在我的 urlpatterns 中有这个：

```
(r'^admin/(.*)', admin.site.root), 
```

这使管理屏幕正常工作，但已被弃用。我需要将其更改为：

```
(r'^admin/', include(admin.site.urls) ), 
```

[一旦我这样做了， Reversing Admin URLs](https://docs.djangoproject.com/en/stable/ref/contrib/admin/#admin-reverse-urls)文档中承诺的所有优点就开始起作用了。

* * *

## 回答 #4

> 赞同：19
> 
> 时间：2014-07-17T14:34:17.320

更高版本还有另一种方法，例如[在 1.10 中](https://docs.djangoproject.com/en/1.10/ref/contrib/admin/#reversing-admin-urls)：

```
{% load admin_urls %}
<a href="{% url opts|admin_urlname:'add' %}">Add user</a>
<a href="{% url opts|admin_urlname:'delete' user.pk %}">Delete this user</a> 
```

类似的`opts`东西在哪里`mymodelinstance._meta``MyModelClass._meta`

一个问题是您不能直接在 Django 模板中访问下划线属性（如`{{ myinstance._meta }}`），因此您必须将`opts`视图中的对象作为模板上下文传递。

* * *

## 回答 #5

> 赞同：17
> 
> 时间：2016-05-06T19:06:22.007

与 Mike Ramirez 的回答基本相同，但在风格上更简单、更接近 django 标准`get_absolute_url`方法：

```
from django.urls import reverse

def get_admin_url(self):
    return reverse('admin:%s_%s_change' % (self._meta.app_label, self._meta.model_name),
                   args=[self.id]) 
```

* * *

## 回答 #6

> 赞同：15
> 
> 时间：2009-03-29T11:44:56.433

对于 1.1 之前的 django，它很简单（对于默认管理站点实例）：

```
reverse('admin_%s_%s_change' % (app_label, model_name), args=(object_id,)) 
```

* * *

## 回答 #7

> 赞同：3
> 
> 时间：2009-03-29T11:38:15.250

我通过将表达式更改为：

```
reverse( 'django-admin', args=["%s/%s/%s/" % (app_label, model_name, object_id)] ) 
```

这需要/假设根 url conf 有一个“admin” url 处理程序的名称，主要是该名称是“django-admin”，

即在根 url conf 中：

```
url(r'^admin/(.*)', admin.site.root, name='django-admin'), 
```

它似乎正在工作，但我不确定它的清洁度。

* * *

## 回答 #8

> 赞同：3
> 
> 时间：2009-07-17T01:23:39.337

如果您使用的是 1.0，请尝试制作如下所示的自定义模板标签：

```
def adminpageurl(object, link=None):
    if link is None:
        link = object
    return "<a href=\"/admin/%s/%s/%d\">%s</a>" % (
        instance._meta.app_label,
        instance._meta.module_name,
        instance.id,
        link,
    ) 
```

然后只需在模板中使用 {% adminpageurl my_object %} （不要忘记先加载模板标签）

* * *

## 回答 #9

> 赞同：-1
> 
> 时间：2010-08-03T15:14:12.383

这是另一种选择，使用模型：

创建一个基本模型（或者只是将 admin_link 方法添加到特定模型）

```
class CommonModel(models.Model):
    def admin_link(self):
        if self.pk:
            return mark_safe(u'<a target="_blank" href="../../../%s/%s/%s/">%s</a>' % (self._meta.app_label,
                    self._meta.object_name.lower(), self.pk, self))
        else:
            return mark_safe(u'')
    class Meta:
        abstract = True 
```

从该基本模型继承

```
 class User(CommonModel):
        username = models.CharField(max_length=765)
        password = models.CharField(max_length=192) 
```

在模板中使用它

```
{{ user.admin_link }} 
```

或查看

```
user.admin_link() 
```

# .net - .NET 奇怪行为中的字符串比较！

> ID：694478
> 
> 赞同：0
> 
> 时间：2009-03-29T11:19:43.017
> 
> 标签：.net

有人可以解释一下为什么这个测试失败了：

```
 [TestMethod]
        public void WierdComparison()
        {
            var machineConf = ConfigurationManager.OpenMachineConfiguration();
            var systemWeb = machineConf.GetSectionGroup("system.web") as SystemWebSectionGroup;
            var prov = systemWeb.Membership.Providers.OfType<ProviderSettings>().Where((s) => s.Name == "AspNetSqlMembershipProvider").First();

            bool result, expected;
            var connectionStringName = prov.ElementInformation.Properties["connectionStringName"].Value;

            result = connectionStringName.Equals("LocalSqlServer");
            expected = true;

            Assert.AreEqual(expected, result);

            result = connectionStringName == "LocalSqlServer";
            expected = true;

            Assert.AreEqual(expected, result); //This assertion fails
        } 
```

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2009-03-29T11:33:45.523

那是因为您正在将 a`Object`与 a进行比较`String`。

如果比较两个字符串，则 == 运算符将被重载以比较字符串的值。如果比较对象和字符串，`Object`则使用比较两个引用的 == 运算符，它只是比较引用，而不是值。

Equals 方法是一个虚方法，所以即使你在引用上调用它`Object`，它仍然会使用`String`类中被覆盖的方法，因为对象的实际类型是`String`.

# .net - 如何在 Linq 中将整数列表转换为字符串数组？

> ID：694479
> 
> 赞同：3
> 
> 时间：2009-03-29T11:19:48.320
> 
> 标签：.net, linq, .net-3.5

我有一个 IList，我希望把它变成一个 ToArray() 字符串结果。目前我必须做以下事情:(

```
List<string> values = new List<string>();
foreach(var value in numberList)
{
    values.Add(value.ToString());    
}

...

string blah = string.Join(",", values.ToArray()); 
```

我希望删除 foreach 并用一些[FunkyColdMedina](http://www.youtube.com/watch?v=DWSLXEyk7zI&feature=related) linq 代码替换它。

干杯!

* * *

## 回答 #1

> 赞同：13
> 
> 时间：2009-03-29T11:23:54.347

```
values.Select(v => v.ToString()).ToArray(); 
```

或一个班轮

```
string blah = string.Join(",", values.Select(v => v.ToString()).ToArray()); 
```

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2011-12-27T11:10:25.343

```
List<Int32> source= new List<Int32>()
{
  1,2,3

} // Above is List of Integer

//I am Using ConvertAll Method of  List
//This function is use to convert from one type to another
//Below i am converting  List of integer to list of string 

List<String> result = source.ConverTAll(p=>p.toString());

string[] array = result.ToArray() 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-03-29T12:36:13.690

对于那些阅读这个问题但没有使用 LINQ 的人（即，如果您不在 .NET 3.x 上），有一个稍微复杂一点的方法。它们的关键是，如果你创建一个 List，你就可以访问 List.ToArray()：

```
IList<int> numberList = new List<int> {1, 2, 3, 4, 5};

int[] intArray = new List<int>(numberList).ToArray();

string blah = string.Join(",", Array.ConvertAll(intArray, input => input.ToString())); 
```

效率不高，因为您随后创建了输入数据、一个列表、一个 int 数组和一个字符串数组，只是为了获取连接的字符串。如果没有 .NET 3.x，您的迭代器方法可能是最好的。

# asp.net - 使用 WatiN，我如何访问页面的头部，特别是元标记？

> ID：694480
> 
> 赞同：0
> 
> 时间：2009-03-29T11:20:51.780
> 
> 标签：asp.net, internet-explorer, dom, watin, shdocvw

WatIn 为以编程方式访问网页的显示部分提供了强大的功能。

我想访问页面的头部，特别是 META 标签。Watin 允许我访问 TITLE，但 AFAICT 没有别的。有一个 InternetExplorer 属性允许访问 ShDocVw.InternetExplorer。我怀疑这可能是道路的开始。就算是对的路，我也不知道怎么走。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-03-31T09:01:16.513

这将为您提供页面中的元标记集合。

WatiN 2.0 beta 1 中的语法：

```
var metaTags = browser.ElementsWithTag("meta"); 
```

WatiN 2.0 CTP 及更早版本中的语法：

```
var metaTags  = browser.Elements.Filter(Find.By("tagName", "META")); 
```

如果您不喜欢以下语法，请阅读我关于向 WatiN[添加元素](http://watinandmore.blogspot.com/2009/03/custom-elements-and-controls-in-watin.html)的博客文章：

```
var metaTags = browser.ElementsOfType<Meta>(); 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-03-30T05:42:07.593

```
browser
    .Element(Find.ByName(nameAttribute))
    .GetAttributeValue("content"); 
```

# c++ - STL 算法中的 begin()、end() 烦恼

> ID：694483
> 
> 赞同：20
> 
> 时间：2009-03-29T11:22:32.620
> 
> 标签：c++, algorithm, stl

我喜欢 STL 算法，并且更喜欢使用算法而不是通常的循环。
几乎所有的 STL 算法通常被用作：

```
std::algorithm_name( container.begin(), container.end(), ..... ) 
```

`container.begin(), container.end()`- 是我的项目中最流行的词对之一。

有人有同样的问题吗？
各位大佬是怎么解决这个问题的？
你有什么建议来避免这种重复？我看到了几种解决方法，但它们都有不同的限制（宏用法，与通常的指针不兼容等）。

* * *

## 回答 #1

> 赞同：29
> 
> 时间：2009-03-29T11:59:27.803

下一个 C++ 标准 C++0X（其中 X 代表，希望是 9）将增加从迭代器视角更改为容器视角的可能性。你将能够做例如。

> std::sort(my_vec);

如果你等不及了，我建议你看看：[Boost.Range](http://www.boost.org/doc/libs/1_38_0/libs/range/index.html)

如果你真的对迭代器/范围感兴趣，我建议你阅读 Andrei 的“*[迭代器必须去](http://www.boostcon.com/site-media/var/sphene/sphwiki/attachment/2009/05/08/iterators-must-go.pdf)*”

* * *

## 回答 #2

> 赞同：19
> 
> 时间：2009-03-29T11:37:59.070

许多人都遇到过这种麻烦。尽管迭代器的概念非常普遍，但它缺乏一些可用性。

输入“范围”概念。最好避免*任何*代码重复。因此，如果您在整个代码中遇到 .begin() 和 .end() 对，最好在“迭代器获取”和实际算法之间创建一个层。

参考：

*   [范围库](http://rangelib.synesis.com.au/)
*   [代码项目](http://www.codeproject.com/KB/stl/oven.aspx)

...

* * *

## 回答 #3

> 赞同：7
> 
> 时间：2009-03-29T12:17:40.600

```
#define ALL(x) (x).begin(), (x).end()

sort(ALL(vec)); 
```

* * *

## 回答 #4

> 赞同：3
> 
> 时间：2009-03-29T12:31:25.917

首先，我认为这不是一个大问题。一般来说，我并不关心再输入几个字符。可读性更重要，我认为开始/结束是完全可读的。

较短的容器名称会有所帮助（con.begin() 比 container.begin() 更容易输入）

并且传递迭代器而不是容器本身意味着您在任何情况下都不必多次调用开始/结束。

这并不是真正困扰我的事情。

* * *

## 回答 #5

> 赞同：3
> 
> 时间：2009-03-29T15:25:48.383

如果它*真的很糟糕*，我可能会在一个新的命名空间中为我最常用的算法创建一堆模板：

```
namespace my_ranged_algorithms {
    // Metafunction for extracting an appropriate iterator from
    // the container type
    template <typename T>
    struct get_iterator_type_for;

    // For vectors
    template <typename T>
    struct get_iterator_type_for<std::vector<T> > {
        typedef typename std::vector<T>::iterator type;
    };

    template <typename T>
    struct get_iterator_type_for<std::vector<T> const> {
        typedef typename std::vector<T>::const_iterator type;
    };

    // For C arrays
    template <typename T, size_t N>
    struct get_iterator_type_for<T(&)[N]> {
        typedef T* type;
    };

    // Generic begin() and end() wrappers

    // For all standard containers        
    template <typename Cont>
    typename get_iterator_type_for<Cont>::type begin(Cont& c) {
        return c.begin();
    }

    template <typename Cont>
    typename get_iterator_type_for<Cont>::type end(Cont& c) {
        return c.end();
    }

    // For C arrays
    template <typename T, size_t N>
    typename get_iterator_type_for<T (&)[N]>::type begin(T (&c)[N]) {
        return c;
    }

    template <typename T, size_t N>
    typename get_iterator_type_for<T (&)[N]>::type end(T (&c)[N]) {
        return c + N;
    }

    // Finally, the actual algorithm wrappers

    // copy
    template <typename Cont, typename OutIter>
    OutIter copy(Cont& from, OutIter to) {
        return std::copy(begin(from), end(from), to);
    }

    // remove
    template <typename Cont, typename T>
    typename get_iterator_type_for<Cont>::type remove(Cont& from, T x) {
        return std::remove(begin(from), end(from), x);
    }

    // etc.
}; 
```

然后像这样称呼他们：

```
vector<int> a, b;
using namespace my_ranged_algorithms;

copy(a, back_inserter(b));
b.erase(remove(b, 42), b.end()); // Remember to call erase() after remove()! 
```

* * *

## 回答 #6

> 赞同：3
> 
> 时间：2009-03-29T12:00:57.300

[C++11](http://en.wikipedia.org/wiki/C++11#Range-based_for_loop)已经解决了语言中的这个小问题。

* * *

## 回答 #7

> 赞同：3
> 
> 时间：2009-05-09T20:46:39.367

最近从 reddit 链接了这个关于未来可能解决方案的[精彩演示文稿[PDF]。](http://www.boostcon.com/site-media/var/sphene/sphwiki/attachment/2009/05/08/iterators-must-go.pdf)它讨论了如何用范围概念完全替换迭代器。

* * *

## 回答 #8

> 赞同：1
> 
> 时间：2009-04-16T20:22:01.983

boost::range_ex 将在 c++0x 之前解决这个问题。

与此同时，自己编写一些包装器并不难。

# openlaszlo - 如何部署 OpenLaszlo 单独应用程序？

> ID：694484
> 
> 赞同：4
> 
> 时间：2009-03-29T11:22:34.037
> 
> 标签：openlaszlo

我一直在看 OpenLaszlo。我找不到如何部署单独的应用程序。我必须复制什么或必须运行什么程序？

我知道部署类型可以是 dhtml 或 flash...

提前致谢。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2009-05-03T20:15:31.640

For SOLO mode, you take the OpenLaszlo .lzx source "program" (expressed in XML format) and "compile" it into an Adobe Flash .swf file using the lzc utility.

For example, a hello.lzx source would be compiled as follows

lzc hello.lzx

into a Flash application called

hello.sw8.swf

Then you simply embed the .swf into an HTML page as you would any other Flash content. The client browser must have the Adobe Flash Player version 8 or version 9 to play the .swf Flash application.

To see the Flash application work right off the disk of your development machine, just point your browser directly at the local .swf file and it should show up in the browser.

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-08-06T08:32:41.873

OpenLaszlo 文档包含有关如何部署应用程序的一些信息的部分： [http ://www.openlaszlo.org/lps3.4/docs/deploy/deployers-guide.html#deployers-guide.steps](http://www.openlaszlo.org/lps3.4/docs/deploy/deployers-guide.html#deployers-guide.steps)

文档中有另一部分描述了 SOLO 和代理部署模式。 [http://www.openlaszlo.org/lps4.9/docs/developers/proxied.html](http://www.openlaszlo.org/lps4.9/docs/developers/proxied.html)

该文档可能有点令人困惑，因为它在过去几年中没有更新。

部署应用程序的最简单方法是使用开发人员控制台，该控制台显示在浏览器中 OpenLaszlo 应用程序的下方。您将在控制台中看到一个“SOLO”按钮，它将开始为您的 OpenLaszlo 应用程序生成嵌入 HTML 页面的过程，将所有静态资源捆绑到一个 ZIP 文件中，该文件可以由自动构建脚本处理以生成一个您的软件的新版本。

所有编译和部署步骤都可以从命令行运行，使用“lzc”命令进行编译，使用“lzdeploy”命令生成部署 ZIP 文件。这两种工具都可以集成到 Ant 中。命令可以在文件夹中找到

> $LPS_HOME/WEB-INF/lps/server/bin

查看 OpenLaszlo 项目博客中的这篇博文，了解有关 lzdeploy 工具的更多信息（官方文档中似乎没有记录）： [http ://weblog.openlaszlo.org/archives/2008/04/lzdeploy-new-命令行实用程序用于部署单独应用程序/](http://weblog.openlaszlo.org/archives/2008/04/lzdeploy-new-command-line-utility-for-deploying-solo-applications/)

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2012-08-14T14:00:05.680

关于使用 Apache Ant 自动构建 OpenLaszlo SOLO 应用程序有一个类似的问题。答案包含一个完整的构建脚本，用于编译 SWF 或 DHTML/HTML5 应用程序，包括所有必需的资源。可以在此处找到讨论： [如何使用 Apache Ant 构建 OpenLaszlo DHTML 应用程序](https://stackoverflow.com/questions/11897892/how-to-build-an-openlaszlo-dhtml-application-using-apache-ant)

# css - 通过css替换图像

> ID：694486
> 
> 赞同：6
> 
> 时间：2009-03-29T11:23:14.397
> 
> 标签：css, image, replace, stylish

我正在用 Firefox 插件 Stylish 编写代码来更改显示的图像。

image 属性没有 div 标签，所以我必须使用这个：

```
img[src*="s_dschjungelplanet"]{
##########
} 
```

因此，这将替换页面中任何位置的“s_dschjungelplanet”，在 img src 中。

所以我的主要问题是我不确定如何告诉它替换 src="xxx"。

Ta 回复

* * *

## 回答 #1

> 赞同：8
> 
> 时间：2009-03-29T11:58:02.237

没有简单的方法。我认为您最好使用greasemonkey 脚本，因为使用简单的此类脚本您可以更改网址。

据我所知，您不能仅使用 css 更改 url。这是我能用css最接近的：

```
img[src*="s_dschjungelplanet"]{
    width:0;
    height:70px;
    padding-right:250px;
    background:transparent url(http://i.stackoverflow.com/Content/Img/stackoverflow-logo-250.png) top left no-repeat;
} 
```

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2011-04-14T16:16:59.890

你可以试试这个：

img[src*="s_dschjungelplanet"]{ 内容: url("myfavorite.png"); }

在 Chrome 中工作，而不是在 Firefox 中......

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2012-11-25T16:28:55.890

```
img[src*="http://url-of-image-to-be-replaced.jpg"]{
    background-image: url("https://url-of-image-you-want-to-display.jpg");
    width:38px;
    display:inline-block;
    padding:38px 0 0 0;
    height: 0px} 
```

根据您的规格更改宽度和填充。它对我有用。

# visual-c++ - 从 Visual C++ 2005 dll 启动 .exe

> ID：694489
> 
> 赞同：0
> 
> 时间：2009-03-29T11:25:00.600
> 
> 标签：visual-c++, windows-mobile, compact-framework, pinvoke

有谁知道代码或对如何使用 Visual C++ 2005 启动 .exe 有想法？

如果是 Windows Mobile，则 dll 所在的环境。执行此操作的 C#`P/Invoke`是

```
[DllImport("coredll.Dll")]
private static extern int CreateProcess(string strImageName, string strCmdLine, IntPtr pProcessAttributes, IntPtr pThreadAttributes , int bInheritsHandle, int dwCreationFlags, IntPtr pEnvironment, IntPtr pCurrentDir, Byte[] bArray, ProcessInfo oProc); 
```

c#代码启动.exe

```
CreateProcess("\\Program Files\\myprogram\\myprogram.exe.exe", "", IntPtr.Zero, IntPtr.Zero, 0, 0, IntPtr.Zero, IntPtr.Zero, new Byte[128], pi); 
```

我在 C++ 中需要它的原因是因为在运行自定义 cab 安装程序时，我被迫使用本机 dll 来执行前后 intit 检查等。

非常感谢您的想法。托尼

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-04-01T15:41:07.497

尝试这个：

```
BOOL RunExe(CString strFile)
{
    WIN32_FIND_DATA fd;
    HANDLE      hFind;
    BOOL        bFind;

    hFind = FindFirstFile(strFile, &fd);
    bFind = (hFind != INVALID_HANDLE_VALUE);

    if(bFind)
    {
    if(!(fd.dwFileAttributes & FILE_ATTRIBUTE_DIRECTORY))
    {
        SHELLEXECUTEINFO info;
        ZeroMemory(&info, sizeof(info));
        info.cbSize = sizeof(info);
        info.fMask = SEE_MASK_NOCLOSEPROCESS;
        info.hwnd = 0;
        info.lpVerb = _T("open");
        info.lpFile = strFile;
        info.lpParameters = NULL;
        info.lpDirectory = NULL;
        info.nShow = SW_SHOW;
        info.hInstApp = NULL;
        ShellExecuteEx(&info);  
    }
    else
        bFind = FALSE;
    }

    FindClose(hFind);

    return bFind;    
} 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-03-29T16:40:34.850

```
PROCESS_INFORMATION ProcessInfo = { 0 };

if (CreateProcess(ImagePath,
                  NULL,
                  NULL,
                  NULL,
                  FALSE,
                  0,
                  NULL,
                  NULL,
                  NULL,
                  &ProcessInfo))
{
    CloseHandle(ProcessInfo.hThread);
    CloseHandle(ProcessInfo.hProcess);
}
else
{
    return GetLastError();
} 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-03-29T18:21:48.837

如果您的意思是在设备上运行 exe，那么没有任何 Visual Studio 无法直接执行此操作。您需要设置自定义构建步骤或预/后构建步骤来运行将为您执行此操作的应用程序。您可以使用 WM5 SDK 代码示例[prun](http://msdn.microsoft.com/en-us/library/ms880639.aspx)（或创建您自己的）。PRun 使用[RAPI](http://msdn.microsoft.com/en-us/library/ms881501.aspx)在设备上运行应用程序，因此需要通过 ActiveSync 连接设备才能工作。

如果您试图在设备上“自动”发生某些事情（例如单元测试），您可能希望查看运行[设备模拟器](http://msdn.microsoft.com/en-us/library/ms889571.aspx)。与尝试使用物理设备相比，这可能会让您获得更多[控制权。](http://msdn.microsoft.com/en-us/library/bb936678.aspx)

# objective-c - 限制 NSArrayController 中的对象数量

> ID：694493
> 
> 赞同：0
> 
> 时间：2009-03-29T11:28:52.760
> 
> 标签：objective-c, cocoa, key-value-coding

我正在尝试在我的应用程序中创建某种“前 25 名”列表。我使用 NSPredicate 过滤数组控制器的内容，但我想将结果的数量限制为 25 个对象。我怎么能那样做？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2009-03-29T12:40:41.837

将排序描述符添加到同一个数组控制器，将其选择索引设置为 range `{ 0, 25 }`，然后绑定到（或直接访问） its`selection`或 its `selectedObjects`。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2009-03-30T17:25:50.943

另一种策略是将 NSArrayController 子类化并覆盖 mappedObjects 以返回类似的东西`[[super arrangedObjects] subarrayWithRange:NSMakeRange( 0, 25 )];`（您可能想先检查数组的长度）。当然，这个阵列控制器只适用于前 25 名，在您的应用程序中没有其他地方。

# java - 如何找出程序中给定用例实际执行了多少 java 代码？

> ID：694499
> 
> 赞同：4
> 
> 时间：2009-03-29T11:35:43.023
> 
> 标签：java, execution

是否可以在启动应用程序（或应用程序服务器）之前将代理或其他东西连接到 jvm，并有一个报告显示类路径中的代码库对于给定的用例实际执行了多少？我想弄清楚我在一个不使用许多 j2ee 技术（如 JCA、JMS、CMP 等）的应用服务器中运行的简单 servlet 应用程序有多少未执行的代码。

最好的问候， 比伦特·埃德米尔

* * *

## 回答 #1

> 赞同：10
> 
> 时间：2009-03-29T11:38:18.213

您正在寻找的是一个[代码覆盖](http://en.wikipedia.org/wiki/Code_coverage)工具。

[对于 Java，我在EMMA](http://emma.sourceforge.net/)方面取得了很大的成功。您应该知道，任何代码覆盖工具都可能显着影响性能——通常它用于单元测试，以检查您的单元测试是否命中了代码的适当部分。不过，您也可以将其用于 Web 应用程序的测试运行——我只是建议不要将其用于生产部署。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-03-29T16:17:39.587

我更喜欢[cobertura](http://cobertura.sourceforge.net/)而不是 EMMA。至少当我使用 EMMA 时，它会产生一些假阴性（实际执行的行但它说它们没有执行）。EMMA 可能已经解决了这个问题。

# .net - 日期范围从周数 + 年

> ID：694500
> 
> 赞同：0
> 
> 时间：2009-03-29T11:35:44.803
> 
> 标签：.net, date

我有 2 个下拉列表 1 带有周数 1 带有年份。我想从这些数据中提取日期范围。

所以：

Weeknumber 13 年 2009 将给出：

2009 年 3 月 23 日星期一 2009 年 3 月 24 日星期二 ...

VB.Net 首选，但 C# 解决方案也可以。

编辑：好的，我想我应该提到这是针对欧洲日期的。

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2009-03-29T12:08:09.437

```
CultureInfo curCulture = CultureInfo.CurrentCulture;

DateTime targetDate = curCulture.Calendar.AddWeeks(new DateTime([year], 1, 1), [Week]);

DayOfWeek targetWeekDay =
    curCulture.Calendar.GetDayOfWeek(targetDate);

DateTime targetBeginningOfWeek = targetDate.AddDays(-1*Convert.ToInt16(targetWeekDay)); 
```

targetBeginningOfWeek 将包含该周的第一天，加上 7 天并获得该周的剩余时间

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2011-09-05T05:07:50.510

尝试使用以下功能：

```
Public Function Week2Date1(ByVal Week2Date2 As Date) As Date
    Week2Date1 = DateAdd(DateInterval.Day, -4, Week2Date2)

End Function

Public Function Week2Date2(ByVal WeekNo As Integer) As Date
    Week2Date2 = DateSerial(Now.Year, 1, (WeekNo) * 7)

End Function 
```

我正在使用这些来确定每周数字的星期一和星期五的日期。

在哪里：

*   on Function Week2Date2 将返回星期数的星期五和
*   on Function Week2Date1 将从 Week2Date2 返回的日期值返回周数的星期一。

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2012-09-07T14:12:07.227

下面的代码从周数和年份获取日期范围。但它是用Java编写的。
希望能帮助到你。

```
 System.out.println("date Range from weekNumber and year but in Java");
   System.out.println(); // print a blank line

   // get the input from the user
   Scanner sc = new Scanner(System.in);

   System.out.print("Enter the week : ");
   int weekNumber  = sc.nextInt(); 
   System.out.print("Enter the Year: ");
   int year = sc.nextInt() ;

   Calendar cal = Calendar.getInstance();
   //cal.setTime(new Date());

   cal.set(Calendar.YEAR, year);
   cal.set(Calendar.WEEK_OF_YEAR, weekNumber);

   SimpleDateFormat formatter = new SimpleDateFormat("yyyy/MM/dd HH:mm:ss");

   cal.set(Calendar.DAY_OF_WEEK, Calendar.MONDAY);
   System.out.println(formatter.format(cal.getTime())); // start date

   cal.add(Calendar.DAY_OF_WEEK, 6);
   System.out.println(formatter.format(cal.getTime())); // end date 
```

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2010-04-21T15:58:29.007

```
var date = DateTime.MinValue + 2009.Years() + 13.Weeks(); 
```

通过在 Codeplex 上使用[Fluent DateTime](http://fluentdatetime.codeplex.com/)项目。

# apache-flex - 如何在eclipse上导入flex

> ID：694503
> 
> 赞同：0
> 
> 时间：2009-03-29T11:36:27.017
> 
> 标签：apache-flex, eclipse, flex-builder-3

我第一次在我的 ubuntu 8.04 机器上使用 linux Flex builder 和 eclipse 3.3，我需要修改一个预先存在的 flex 项目。如何将此项目（flex 项目的版本控制分支）导入到我的 eclipse 环境中。

我尝试在 eclipse 中创建一个新的 flex 项目并将源文件夹链接到它，但它不起作用。

任何指针？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-03-29T13:37:54.213

您应该能够为 SVN（或您正在使用的任何 SCM）安装 Eclipse 插件，然后检查项目。如果这不起作用，请尝试将其导入（文件 -> 导入 -> 现有项目到工作区）。如果这不起作用，则创建一个指向项目基目录的新 Flex 项目。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-03-29T13:42:02.160

当所有其他方法都失败时，只需创建一个正确类型的新 flex 项目，退出 eclipse 并将项目文件复制到该文件夹​​.. 重新启动构建器，您将启动

# c# - C# 3维数组定义问题

> ID：694510
> 
> 赞同：4
> 
> 时间：2009-03-29T11:41:04.103
> 
> 标签：c#, arrays

我的以下代码有编译错误，

错误 1 ​​无法将类型 'TestArray1.Foo[ *,* ,*]' 隐式转换为 'TestArray1.Foo[][][]' C:\Users\lma\Documents\Visual Studio 2008\Projects\TestArray1\TestArray1\Program.cs 17 30 测试阵列1

有没有人有任何想法？这是我的全部代码，我使用的是 VSTS 2008 + Vista 64 位。

```
namespace TestArray1
{
    class Foo
    {    
    }

    class Program
    {
        static void Main(string[] args)
        {
            Foo[][][] foos = new Foo[1, 1, 1];

            return;
        }
    }
} 
```

编辑：版本 2。我有另一个版本的代码，但仍然有编译错误。有任何想法吗？

```
Error   1   Invalid rank specifier: expected ',' or ']' C:\Users\lma\Documents\Visual Studio 2008\Projects\TestArray1\TestArray1\Program.cs 17  41  TestArray1
Error   2   Invalid rank specifier: expected ',' or ']' C:\Users\lma\Documents\Visual Studio 2008\Projects\TestArray1\TestArray1\Program.cs 17  44  TestArray1

namespace TestArray1
{
    class Foo
    {    
    }

    class Program
    {
        static void Main(string[] args)
        {
            Foo[][][] foos = new Foo[1][1][1];

            return;
        }
    }
} 
```

编辑：版本 3。我想我想要一个锯齿状数组。并在向其他人学习之后。这是我的代码修复，它在 VSTS 2008 中编译得很好。我想要的是一个锯齿状数组，目前我只需要一个元素。谁能检查我的代码是否正确以实现我的目标？

```
namespace TestArray1
{
    class Foo
    {    
    }

    class Program
    {
        static void Main(string[] args)
        {
            Foo[][][] foos = new Foo[1][][];
            foos[0] = new Foo[1][];
            foos[0][0] = new Foo[1];
            foos[0][0][0] = new Foo();
            return;
        }
    }
} 
```

提前谢谢，乔治

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2009-03-29T12:06:46.833

关于代码的第 2 版 - 不幸的是，您不能以这种方式指定锯齿状数组。相反，您需要执行以下操作：

```
Foo[][][] foos = new Foo[1][][];
foos[0] = new Foo[1][];
foos[0][0] = new Foo[1]; 
```

基本上，您必须分别填充每个数组。`Foo[][][]`意思是“Foo 数组的数组”。像这样的初始化语句一次只能初始化*一个*数组。使用矩形数组，您仍然只能得到一个（多维）数组，这就是`new Foo[1,1,1]`有效的原因。

顺便说一句，如果这是针对真正的代码，我会敦促您至少*考虑*其他设计决策。数组数组可能很有用，但您很容易遇到这样的问题。数组数组的数组甚至更糟糕。可能有更易读的方式来表达您感兴趣的内容。

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2009-03-29T11:43:52.007

下定决心：）

你要么想要：

```
Foo[,,] foos = new Foo[1, 1, 1]; 
```

或者：

```
Foo[][][] foos = new Foo[1][1][1]; 
```

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2009-03-29T11:47:30.937

您正在声明一个双嵌套数组（数组数组的数组）并分配一个三维数组。这两个肯定是不一样的。您可以将您的声明更改为

```
Foo[,,] foos = new Foo[1,1,1] 
```

如果你想要一个真正的三维数组。锯齿状数组（`[][][]`那种）在 C# 中并不像在 Java 中那样需要。

* * *

## 回答 #4

> 赞同：2
> 
> 时间：2009-03-29T12:05:40.957

最简单的答案是使用

```
Foo[,,] foos = new Foo[2, 3, 4]; 
```

它为您提供了一个 3 维数组作为 2*3*4=24 Foo 的连续内存块。

替代方案看起来像：

```
Foo[][][] foos = new Foo[2][][];

for (int a = 0; a < foos.Length; a++)
{
  foos[a] = new Foo[3][];
  for (int b = 0; b < foos[a].Length; b++)
  {
     foos[a][b] = new Foo [4];

     for (int c = 0; c < foos[a][b].Length; c++)
        foos[a][b][c] = new Foo();
  }
} 
```

尽管这种锯齿状（= 数组数组）方法工作量更大，但使用它实际上更快。这是由编译器的一个缺点引起的，它在访问 Foo[,,] 情况下的元素时总是会进行范围检查，而它至少能够优化使用 Foo[] 中的 Length 属性的 for 循环[][] 设想。

也看到[这个问题](https://stackoverflow.com/questions/597720/what-is-differences-between-multidimensional-array-and-array-of-arrays-in-c)

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2009-03-29T11:46:25.587

取决于您是否希望它们呈锯齿状：

```
//makes a 5 by 4 by 3 array:

string[,,] foos = new string[5,4,3]; 
```

[http://msdn.microsoft.com/en-us/library/aa288453(VS.71).aspx](http://msdn.microsoft.com/en-us/library/aa288453(VS.71).aspx)

哦，这里是初始化值：

```
 char[, ,] blah = new char[2, 2, 2] { 
        {{ '1', '2' }, { '3', '4' }},
        {{ '5', '6' }, { '7', '8' }}
         }; 
```

请注意，这不起作用：

```
Foo[][][] foos = new Foo[1][1][1]; 
```

因为您使用的是交错数组语法，它不允许您定义嵌套数组的大小。而是使用这样做：

```
Foo[,,] foos = new Foo[1][1][1];  //1 by 1 by 1 
```

或这个

```
Foo[][][] foos = new Foo[1][][];  //1 array allowing two nested levels of jagged arrays
foos[0] = new Foo[1];  //for the first element, create a new array nested in it
foos[0][0] = new Foo[1]; //create a third level new array nested in it 
```

* * *

## 回答 #6

> 赞同：1
> 
> 时间：2009-03-29T12:06:15.510

这两个不同的数组声明创建了非常不同的东西。

让我们看一个更简单的案例：

```
Foo[,] twoDimensionArray = new Foo[5,5]; 
```

这个数组有两个维度——你可以把它想象成一个表格。您需要两个轴才能返回任何内容：

```
Foo item = twoDimensionArray[2,3] 
```

索引始终具有相同的长度 - 在本例中为 0-4。

锯齿状数组实际上是一个数组数组：

```
Foo[][] jaggedArray = new Foo[5][];

jaggedArray[0] = new Foo[2];
jaggedArray[1] = new Foo[4];
... 
```

如果您只使用一个轴索引，它将返回一个数组：

```
Foo[] oneRow = jaggedArray[3]; 
```

如果您同时使用两者，则从子数组中进行选择：

```
Foo item = jaggedArray[3][2];

//would be the same as:
Foo item = oneRow[2]; 
```

这些子数组中的每一个都可以具有不同的长度，甚至可以不被填充。

* * *

## 回答 #7

> 赞同：1
> 
> 时间：2009-09-29T18:41:51.257

如果它意味着什么，仅用于 C# 声明：

```
int[,,] ary = new int[,,]
{
      { { 111, 112 }, { 121, 122 }, { 131, 132 } } 
    , { { 211, 212 }, { 221, 222 }, { 231, 232 } } 
    , { { 311, 312 }, { 321, 322 }, { 331, 332 } } 
    , { { 411, 412 }, { 421, 422 }, { 431, 432 } } 
}; 
```

* * *

## 回答 #8

> 赞同：0
> 
> 时间：2014-01-29T18:22:55.717

数组初始化

```
int[, ,] array3D = new int[,,] { { { 1, 2, 3 }, { 4, 5, 6 } }, 
                                { { 7, 8, 9 }, { 10, 11, 12 } } } 
```

来源：[多维数组（C# 编程指南）](http://msdn.microsoft.com/en-us/library/2yd9wwz4.aspx)

# java - 如何在 Windows XP 上安装 Tomcat？

> ID：694513
> 
> 赞同：1
> 
> 时间：2009-03-29T11:44:43.610
> 
> 标签：java, apache, tomcat, jakarta-ee

我在 Windows XP 机器上安装 Tomcat 时遇到问题。我已经安装了 Apache 和 JDK 6，我需要知道的是：

*   [从最新的Tomcat 下载页面](http://tomcat.apache.org/download-60.cgi)下载哪个文件

*   以及如何安装它，以便我可以运行示例 Web 应用程序`http://localhost/`

在我的`C:\Program Files\Java`文件夹中，我看到以下文件夹，这应该让您了解我是否需要安装任何其他东西：

*   jdk1.6.0_10
*   jre1.6.0_04
*   jre1.6.0_06
*   jre1.6.0_07
*   jre6

谢谢。

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2009-03-29T11:58:39.240

Tomcat 6 并不真正需要完整的 JDK，它也可以与 Java 1.5 一起运行，所以 Java 明智的你应该过得很好。只需确保设置了 JAVA_HOME 环境变量。

您可以获取核心 zip 或 tar.gz 文件，或 Windows 服务安装程序文件。

核心压缩文件：

[http://www.apache.org/dist/tomcat/tomcat-6/v6.0.18/bin/apache-tomcat-6.0.18.zip](http://www.apache.org/dist/tomcat/tomcat-6/v6.0.18/bin/apache-tomcat-6.0.18.zip)

只需解压缩并运行 bin/startup.bat。如果您想将其安装为 Windows 服务（并在 Windows 添加/删除程序中获取“常规”程序条目），您可以获取 Windows 服务安装程序文件：

[http://www.apache.org/dist/tomcat/tomcat-6/v6.0.18/bin/apache-tomcat-6.0.18.exe](http://www.apache.org/dist/tomcat/tomcat-6/v6.0.18/bin/apache-tomcat-6.0.18.exe)

默认情况下，tomcat 侦听端口 8080，因此要查看示例应用程序，您需要转到[http://localhost:8080/examples/](http://localhost:8080/examples/)。您可以通过编辑 conf 目录中的 server.xml 来更改默认端口。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-03-29T11:58:47.633

我不确定您提供的那个 URL 是什么（“CGI”在 J2EE 站点上看起来很奇怪），但是 tomcat 的下载链接在它的主页上：http: [//tomcat.apache.org/](http://tomcat.apache.org/)

您可能应该下载版本 6，特别是如果您将其用于个人开发。旧版本的可用和维护主要是为了支持不想迁移 J2EE 版本的用户。

最后：除非您已经在使用 Apache，否则不要打扰它。由于 Apache 的可配置性（尤其是 URL 重写），大多数商业网站都使用 Apache 作为前端。如果您只是想开发 Web 应用程序，除了 servlet/JSP 容器之外，Tomcat 将充当 Web 服务器。

安装说明（以及所有其他说明）在这里：http: [//tomcat.apache.org/tomcat-6.0-doc/index.html](http://tomcat.apache.org/tomcat-6.0-doc/index.html)

如果您以前没有做过任何 J2EE 开发，那么您需要一些关于它的文档。Sun 教程还可以，但针对的是 Sun 应用程序服务器，并且涵盖了许多并非真正需要的 XML。查看有关 Web 应用程序的介绍章节，然后跳转到第 11 章：http: [//java.sun.com/j2ee/1.4/docs/tutorial/doc/index.html](http://java.sun.com/j2ee/1.4/docs/tutorial/doc/index.html)

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-03-29T11:59:27.553

您应该从下载页面下载“Windows Service Installer”包。

至于其余的安装过程，请按照以下页面中描述的“步骤 3：安装 Tomcat”：

[http://mircwiki.rsna.org/index.php?title=New_Installation_Instructions](http://mircwiki.rsna.org/index.php?title=New_Installation_Instructions)

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2011-09-01T17:00:07.693

不是一个完整的答案，而是一个附加组件（堆栈溢出如何处理这个问题？）：

对于 Windows（XP、Vista、7）安装，您可以选择（从[http://tomcat.apache.org/download-60.cgi](http://tomcat.apache.org/download-60.cgi)中列出的选项中）：

*   .zip（根据您的 Windows 版本选择）
*   Windows 服务安装程序

现在前两个选项之间的区别：

*   .zip -- 这是手动安装，您可以在其中提取 .zip 并将其移动到您想要的任何文件夹中。它不会将 Tomcat 安装为服务。它不会“做”任何事情，除非您手动使用它或让另一个程序使用它。这是手动设置。
*   Windows 服务安装程序——这是一个自行安装程序，只需运行 .exe。它将 Tomcat 安装为 Windows 服务，如果您加载 Windows 服务（运行“services.msc”），您会看到它列为“Apache Tomcat 6.0 Tomcat6”。在安装过程中，它会询问您某些设置问题，例如。

如果您选择“Windows Service Installer”，以下是安装时会询问您的默认设置：

*   安装类型：普通
*   服务器关闭端口：8005
*   HTTP/1.1 连接器端口：8080
*   AJP/1.3 连接器端口：8009
*   Windows 服务名称：Tomcat6
*   为所有用户创建快捷方式：禁用（如果是您的机器，这并不重要）
*   Tomcat 管理登录 - 用户名：空白
*   Tomcat 管理登录 - 密码：空白
*   Tomcat 管理登录 - 角色：manager-gui
*   系统上安装的 Java SE 5.0 或更高版本 JRE 的路径：C:\Program Files\Java\jre7（如果您正在运行 Java SE 7）
*   目标（安装）文件夹：C:\Program Files\Apache Software Foundation\Tomcat 6.0

希望这可以帮助。

# c++ - Sqlite 作为 fopen() 的替代品？

> ID：694517
> 
> 赞同：11
> 
> 时间：2009-03-29T11:48:45.677
> 
> 标签：c++, c, sqlite, fopen

在一个[官方的 sqlite3 网页上](http://www.sqlite.org/)写着我应该将 sqlite 视为 fopen() 函数的替代品。

你怎么看待这件事？用 sqlite 补充应用程序内部数据存储总是好的解决方案吗？这种解决方案的优缺点是什么？

你有这方面的经验吗？

编辑：你的经历怎么样？这个容易用吗？它是痛苦的还是相当快乐的？你喜欢它吗？

* * *

## 回答 #1

> 赞同：10
> 
> 时间：2009-03-29T11:53:43.277

这取决于。有一些禁忌症：

*   对于配置文件，使用纯文本或 XML 比使用关系数据库更容易调试或更改，甚至是像 SQLite 这样轻量级的数据库。

*   使用（例如）XML 比使用关系表更容易描述树结构

*   SQLite API 的文档记录很差——没有足够的例子，而且超链接很差。OTOH，如果您愿意挖掘，信息就在那里。

*   直接使用特定于应用程序的二进制格式将比在数据库中存储与 BLOB 相同的格式更快

*   数据库损坏可能意味着丢失**所有**数据，而不是单个坏文件中的数据

OTOH，如果您的内部数据非常适合关系模型并且如果有很多，我会推荐 SQLite - 我自己将它用于我的一个项目。

关于经验 - 我使用它，它运行良好并且易于与现有代码集成。如果文档更易于浏览，我会给它 5 颗星 - 因为它是我会给它四颗星。

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2009-03-29T12:29:19.277

与往常一样，没有“一刀切”的解决方案

如果您需要将数据存储在独立文件中，并且您可以利用 SQL 数据库的关系数据库功能，那么 SQLite 就很棒。

如果您的数据不适合关系模型（例如分层数据），或者您希望您的数据易于阅读（配置文件），或者您需要与另一个系统进行互操作，那么 SQLite 不会很有帮助，XML 可能会更好。

另一方面，如果您需要同时从多个程序或计算机访问数据，那么 SQLite 不是最佳选择，您需要一个“真正的”数据库服务器（MS SQL、Oracle、MySQL、PosgreSQL ...） .

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2009-03-29T12:03:11.727

SQLite 的原子性是一个优点。知道如果您中途写入一些数据（可能在中间崩溃），它不会损坏您的数据文件。我通常通过在成功加载时备份文件来完成与 xml 配置文件类似的操作，并且任何未来失败的加载（表明损坏）都会自动恢复上次备份。当然，它没有那么精细，也不是原子的，但它足以满足我的需求。

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2009-03-29T21:39:04.087

我发现使用 SQLite 很愉快，但我不会认为它是 fopen() 的万能替代品。

例如，我刚刚编写了一个从 Web 服务器下载图像并在本地缓存它们的软件。将它们存储为单独的文件，我可以在 Windows 资源管理器中观看它们，这当然有好处。但是我需要保留一个在 URL 和图像文件之间映射的索引，以便使用缓存。将它们存储在 SQLite 数据库中，它们都位于一个整洁的小文件中，我可以通过 URL（从缓存中选择 imgdata，其中 url=' [http://foo.bar.jpg](http://foo.bar.jpg) '）轻松访问它们。

# html - 如何将此表格布局转换为 div/css？

> ID：694535
> 
> 赞同：0
> 
> 时间：2009-03-29T12:02:06.470
> 
> 标签：html, css, css-tables

我真的在尝试使用 div，但我似乎无法获得与以下简单表格布局等效的内容：

```
<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Strict//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-strict.dtd">
<html xmlns="http://www.w3.org/1999/xhtml" xml:lang="en" lang="en">
  <head>
    <title>Table example</title>
    <meta http-equiv="Content-Type" content="text/html; charset=UTF-8" />
    <style type="text/css">
      html, body {height: 100%}
      .content {width: 750px; vertical-align: top}
    </style>
  </head>
  <body style="margin: 0; padding: 0">
    <table style="height: 100%; width: 100%; border-collapse: collapse">
      <tr style="background-color: #666666">
        <td></td>
        <td class="content" style="height: 100px"><h1>Header Content</h1></td>
        <td></td>
      </tr>
      <tr style="background-color: #BBBBBB">
        <td></td>
        <td class="content" style="background-color: #FFFFFF"><h1>Main Content</h1></td>
        <td></td>
      </tr>
      <tr style="background-color: #666666">
        <td></td>
        <td class="content" style="height: 100px"><h1>Footer Content</h1>
        </td>
        <td></td>
      </tr>
    </table>
  </body>
</html> 
```

我要保留的重要元素：

1.  任何真实的内容都是固定宽度的。（在这种情况下，750 像素）

2.  页眉和页脚背景扩展为页面宽度的 100%。

3.  主要内容背景不会水平扩展，但会垂直扩展以填充页眉和页脚之间的区域。

4.  即使主要内容不是很高，页脚也始终位于页面底部。

我尝试了多种策略，发现至少有两种不同的方法可以使用 div 将页脚保持在页面底部。不幸的是，如果主要内容在 div 中，似乎没有任何方法可以使其垂直扩展以填充短页面上页眉和页脚之间的空间。

编辑：更改了示例以显示即使不在怪癖模式下它也可以工作。以上为证。

编辑2：

我已经找到了一种在很大程度上使用 javascript 来做到这一点的方法。所以，我想我的问题是：我如何在没有 javascript 的情况下做到这一点。这是我正在使用的（我确定它只适用于 Firefox，但我可以修复它）：

```
<script type="text/javascript">
function changeDiv() {
    document.getElementById("content").style.minHeight = document.body.clientHeight - 200 + "px";
}
changeDiv();
window.onresize = changeDiv;
</script> 
```

“内容”将指定我要扩展的主要内容 div。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2009-03-29T12:40:54.333

这是我的尝试。在 FF3 和 IE8 上似乎还可以：

```
<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN" "http://www.w3.org/TR/html4/loose.dtd">
<html>
<head>
<style type="text/css">
html, body { padding: 0; margin: 0; }
div { padding: 1px; }
#wrapper, #wrapper-top, #wrapper-bottom { position: absolute; left: 0; right: 0; width: 100%; }
#wrapper-top { background-color: #666; height: 100px; top: 0; }
#wrapper-bottom { background-color: #666; height: 100px; bottom: 0; }
#wrapper { top: 100px; bottom: 100px; background-color: #DDD; }
#header, #content, #footer { width: 750px; margin: 0 auto; height: 100%; min-height: 100%; }
#content { background-color: white; }
</style>
</head>
<body>
<div id="wrapper-top">
  <div id="header"><h1>Header Content</h1></div>
</div>
<div id="wrapper">
  <div id="content"><h1>Main Content</h1></div>
</div>
<div id="wrapper-bottom">
  <div id="footer"><h1>Footer Content</h1></div>
</div>
</body>
</html> 
```

**注意：** DOCTYPE 很重要，它强制在 IE 中使用兼容模式。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-03-29T12:51:02.593

为了让页脚粘在页面底部，取决于内容是否大于视口高度，或者内容是否没有完全到达底部（但您仍然希望页脚出现在底部）尝试实现[FooterStick](http://www.themaninblue.com/experiment/footerStickAlt/)。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-04-10T16:33:15.207

这可以在非 IE 浏览器中完成。但在 IE（至少 IE7-）上，您需要使用表格，最好使用[条件注释](https://stackoverflow.com/questions/414738/using-conditional-comments-in-html/530085#530085)。

我没有花时间测试，但试试这个，看看它是否有效：

在 html 上，使用严格的文档类型。最好像这样的xhtml

```
<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.1//EN" "http://www.w3.org/TR/xhtml11/DTD/xhtml11.dtd"> 
```

并将其放入体内：

```
<div class="header"></div>
<div class="content"></div>
<div class="footer"></div> 
```

在 CSS 上：

```
div.header,
div.content,
div.footer {
    position: absolute;
}

div.header {
    top: 0;
    height: 20px;
}

div.footer {
    bottom: 0;
    height: 20px;
}

div.content {
    top: 0;
    bottom: 0;
    /*can't remember if it was margin or padding, if one doesn't works, try the other*/
    margin-top: 20px;
    margin-bottom: 20px;
} 
```

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2009-03-29T12:14:06.347

你真正的问题似乎是“我如何让我的主 div 展开，我的页脚到页面底部。”

答案是：你也不能用表格来做，至少如果你使用指定 HTML 4.0 过渡或更高版本的 doctype 的话。是的，它可以在没有 doctype 的情况下工作，但那是因为在这种情况下浏览器会进入它们的“怪癖模式”。

我相信你可以用绝对定位来做到这一点，你可能已经看到了例子。就个人而言，我会更多地研究一种使用固定定位的页脚的方法，具有更大的 z 顺序，以便它呈现在内容的顶部，然后使用渐变效果使主要内容消失在它后面。这是一个例子（由比我好得多的人创建）： http: [//www.designbyfire.com/](http://www.designbyfire.com/)

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2015-01-13T06:01:36.030

而不是`position:absolute`用于`position:fixed`div（页眉/页脚）。

```
div.header, div.footer {
    position: fixed; } 
div.header{
    top: 0; }
div.footer {
        bottom: 0; } 
```

因此，`align`您`content div` `padding`依赖`header/footer height`. 因此，无论何时，`scroll`您的页面`footer`都将仅位于底部并`header`位于顶部。并且还`z-index:yourvalue;`提供`header/footer`.

# sql-server-2005 - SQL 多参数值

> ID：694536
> 
> 赞同：1
> 
> 时间：2009-03-29T12:02:40.853
> 
> 标签：sql-server-2005, stored-procedures

SQL 2005 中有哪些选项可用于将多个值传递给存储过程

伪代码

在 C# 代码中

```
 List<string> myApplicationList;
    .... (code to assign values)
    **Construct parameter list**
    Call stored procedure [spSelectMaster] with myApplicationList 
```

SQL 存储过程

```
 CREATE PROCEDURE [Ecn].[spSelectMaster]
        **Need to declare parameter here but not sure what this would be**
    AS
    BEGIN
        SET NOCOUNT ON
        SELECT *
        FROM [dbo].[Master]
        WHERE [Master].[ApplicationKey] IN (@ApplicationList)
    END
    GO 
```

提前致谢

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2009-03-29T12:08:04.583

SQL Server 2005 T-SQL 中没有对数组的内置支持，但您可以解决此问题：

[SQL Server 2005 中的数组和列表](http://www.sommarskog.se/arrays-in-sql-2005.html#CSV)

[如何将值列表或数组传递给 SQL Server 存储过程？](http://vyaskn.tripod.com/passing_arrays_to_stored_procedures.htm)

# ruby-on-rails - 在 Rails 上提供 Ruby 服务的最佳方式是什么？

> ID：694547
> 
> 赞同：1
> 
> 时间：2009-03-29T12:11:34.577
> 
> 标签：ruby-on-rails, ruby, service, rake

我需要将 ruby​​ 脚本作为服务运行。该脚本需要访问 rails-app 的 ActiveRecords。

最好的方法是什么？耙子任务？如何在 Windows 和 linux 上将它作为服务启动？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-03-29T19:21:03.420

这个 Stackoverflow 线程似乎对如何在 Windows 上将 Ruby 作为服务运行有一个很好的答案：[Running a Ruby Program as a Windows Service?](https://stackoverflow.com/questions/163497/running-a-ruby-program-as-a-windows-service)

这里是如何在 Rails 之外实例化 ActiveRecord：[http ://www.juixe.com/techknow/index.php/2009/01/14/activerecord-ruby-on-rails-optional/](http://www.juixe.com/techknow/index.php/2009/01/14/activerecord-ruby-on-rails-optional/)

如果您想使用与 Rails 应用程序相同的模型，您可以要求它们。

这是控制台中的一个示例：

```
irb(main):001:0> require 'ActiveRecord'
=> true
irb(main):002:0>     ActiveRecord::Base.establish_connection(
irb(main):003:1*       :adapter => 'mysql',
irb(main):004:1*       :database => 'development',
irb(main):005:1*       :username => 'root',
irb(main):006:1*       :password => '',
irb(main):007:1*       :host => 'localhost'
irb(main):008:1>     )
=> #<ActiveRecord::ConnectionAdapters::ConnectionPool:0x59613
irb(main):009:0> require 'app/models/User.rb'
=> ["User"]
irb(main):010:0> User.find(1)
=> #<User id: 1, first_name: "Michael"> 
```

祝你好运！

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-03-29T12:17:05.357

我想说，如果 Sinatra 应用程序只是一个脚本即服务，那么它可能是可行的方法。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-03-31T08:21:37.390

我将使用 [自定义守护程序](http://railscasts.com/episodes/129-custom-daemon)

# c# - 服务器服务和 gui 的良好架构是什么？

> ID：694548
> 
> 赞同：1
> 
> 时间：2009-03-29T12:12:19.613
> 
> 标签：c#, .net, architecture

我正在构建一个应用程序，允许用户通过电子邮件发送它们来在计算机上执行一些命令。服务器将监视（提取）一个或多个电子邮件帐户并启动通信会话。还涉及一些身份验证。我正在使用最新最好的 .net 技术。

我正在考虑将服务器公开为一项服务，但是我无法拥有一个 GUI 来允许用户配置密码和电子邮件帐户等内容。我怎样才能把这些分开？

其次，这些命令将是可插入的，并且应该提供它们自己的 GUI。我怎样才能合并这个？服务器进程应该能够使用命令功能，而 GUI 进程应该允许自定义。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-03-29T12:18:54.900

我使用了 WCF，这是 Microsoft 当前用于实现 Web 服务和/或 SOA 的技术。您将创建一个调用 WCF 服务的桌面客户端或网页。WCF 服务将是您的服务器组件，桌面客户端或网页将是您的用户前端。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-03-31T18:38:22.507

主要不是如何做服务本身的问题。通信协议不是主要问题——使用 WCF，您可以通过协议的幽灵公开您的应用程序方法。这只是应用程序配置的问题。

这里的主要问题是您喜欢如何实现 GUI。如果您的应用程序是普通的 Windows 服务，那么它不能有内置的 GUI。只是因为服务不应该有它。所以你需要单独的 GUI 应用程序。选项：

1.  GUI 是独立的 .NET 应用程序，它以某种方式与您的服务进行通信。假设通过 WCF。在这种情况下，插件也应该分两部分实现：服务插件和 GUI 插件。我认为，它太复杂而无法支持。

2.  第一个变体的修改。服务和 GUI 都打包在一个可执行文件中。它查看以何种模式启动（服务或独立）并监视邮件或显示 GUI。由于这是一个应用程序，因此配置也是相同的。因此，您将拥有插件的单一注册表。我假设，在 GUI 模式下，应用程序将搜索已启动的服务并对其进行配置。缺点 - GUI 只能在本地运行。

3.  您制作了一种“可转移”的 GUI - 服务将 GUI 发送到简单的客户端，它会显示它。在这种情况下，所有应用程序代码（服务和 GUI）都在一个地方，但它部分在服务中执行，部分在客户端软件中执行。但是你也需要这样的通用客户端软件。

4.  稍微思考一下变体 3，我们发现解决方案已经存在——它是网络技术。将您的服务作为网站的一部分来实现是最简单的。GUI 将是另一部分。如果您不熟悉 HTML 和 Javascript，您可以使用 Silverlight 实现 GUI。

5.  事实上，您可以直接在您的服务中托管 ASP.NET。[这是很好的解释](http://www.west-wind.com/presentations/aspnetruntime/aspnetruntime.asp)。但我担心它会增加不必要的复杂性

# nhibernate - NHibernate 和 iBATIS.NET 有什么区别？

> ID：694552
> 
> 赞同：5
> 
> 时间：2009-03-29T12:16:45.077
> 
> 标签：nhibernate, orm, ibatis.net, data-mapping

我正在寻找一些比较 NHibernate 和 iBATIS.NET 的最新信息。我在 Google 上搜索到了一些信息，但其中大部分信息要么适用于这些产品的 Java 版本，要么已经过时。

我感兴趣的一些具体的事情：

*   如果您同时控制数据模型和应用程序，哪个更好？
*   iBATIS 被反复称为更易于学习——这是否具有长期维护的后果（即易于启动，难以维护）？
*   两者都可以轻松切换底层数据库供应商吗？
*   您的开发人员需要具备多高的 SQL 技能？
*   一个人拥有另一个人缺乏的任何主要功能吗？
*   这两种产品是否更适合特定类型的应用？

现实世界中观察到的好处和缺点的例子值得赞赏！

编辑：感谢您的信息。我也在做自己的评价。我仍然想知道的一件事是，iBATIS 是否可以帮助您保存/更新复杂的对象图？NHibernate 似乎很不错，因为我可以将根对象传递给它，它会计算出数据库中需要更新的内容（如果有的话）的详细信息。

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2009-03-29T16:08:47.110

前段时间我做了一些研究。

我提出的一个具体问题可能会为您提供一些额外的信息： 您是否会将[NHibernate 用于具有部分无法控制的遗留数据库的项目？](https://stackoverflow.com/questions/454249/would-you-use-nhibernate-for-a-project-with-a-legacy-database-which-is-partly-ou)

我可以回答您的一些兴趣点：

*   如果您同时控制数据模型和应用程序，哪个更好？

我可以反过来回答：如果您无法控制数据模型并因此面临一些遗留数据库，那么 iBatis 是更好的选择。

*   iBATIS 被反复称为更易于学习——这是否具有长期维护的后果（即易于启动，难以维护）？

这取决于你想用它做什么。如果你有一个领域驱动的开发方法，那么 iBatis 可能会随着时间的推移而变得痛苦。如果您只是进行简单的数据操作并且没有完整的域模型，那么 nHibernate 到那时可能会过大。

*   两者都可以轻松切换底层数据库供应商吗？

两者都有保护您免受特定数据库供应商影响的机制，但我承认尚未在这方面进行深入研究。

*   您的开发人员需要具备多高的 SQL 技能？

当你使用 iBatis 时，你需要比 NHibernate 更多的 SQL 技能。使用 iBatis，您总是需要编写一些 SQL。NHibernate 不需要您编写 SQL 语句——它甚至可以为您编写 DDL。强大的功能将要求您使用旧的好 SQL，这将是不可避免的。

其他几点：

*   我个人发现 iBatis 更轻量级。您可以非常快速地完成工作。NHibernate 更强大，但具有更多功能，您可能会以错误的方式使用这些功能。

*   可以结合使用 NHibernate 和 iBatis！您可以将 NHibernate 用于您的业务逻辑。出于报告目的，您只需从表中读取数据，回退到 iBatis。

*   如果你的应用程序有更长的生命周期和大量的业务逻辑，可以考虑 NHibernate。它有很多功能可以帮助您处理业务对象。

*   NHibernate 周围的社区非常活跃，并且提供了有用的工具。

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2009-03-29T15:28:45.553

从某种意义上说，它是将苹果与橙子进行比较。

> 如果您同时控制数据模型和应用程序，哪个更好？

它们都可以很好地与规范化数据库一起使用，因此如果您可以塑造数据库，它们或多或少是相等的。iBatis 更擅长映射到遗留数据库，因为它实际上根本不关心数据库结构。它只关心结果集的形状。

> .iBATIS 被反复称为更易于学习 - 这是否具有长期维护后果（即易于启动，难以维护）？

它要简单得多，但那是因为它的功能集要小得多。我不认为它有任何滴答作响的定时炸弹长期维护问题。

> 两者都可以轻松切换底层数据库供应商吗？

是的

> 您的开发人员需要具备多高的 SQL 技能？

两者都需要良好的 SQL 知识。使用 iBatis，您仍然需要编写 sql 查询/过程。使用 NHibernate，您必须知道如何编写 NHibernate 查询以获得有效的 SQL。两者都不能替代 SQL 知识。

> 一个人拥有另一个人缺乏的任何主要功能吗？

iBatis 是一个数据映射器（iBatis 网站上使用的术语）。NHibernate 是一个成熟的对象关系映射器。如果您主要想要一些东西来消除将对象映射到结果集的单调性，那么 iBatis 是一个很好的方法。但是，它并没有完全解决对象/关系不匹配的问题。NHibernate 具有更多功能，例如脏跟踪、基于身份/身份映射的缓存、灵活查询、动态 sql、批处理等...... NHibernate 更具动态性，因为它可以在一次访问数据库中做很多事情iBatis 几趟。

* * *

## 回答 #3

> 赞同：3
> 
> 时间：2009-05-08T18:47:50.740

我们最近发布了一篇比较这两种工具的文章，我认为您的许多问题都已得到解决。这篇文章在[我们的 wiki 网站上](http://dvlp.synaptic.ca/twiki/bin/view/Synaptic/NHibernateVersusiBatis)。

# asp.net-mvc - ASP.NET MVC 中的 Telerik 控件

> ID：694566
> 
> 赞同：7
> 
> 时间：2009-03-29T12:34:50.447
> 
> 标签：asp.net-mvc, telerik

Telerik 声称他们的控件现在可以与 ASP.NET MVC 一起使用。有没有人已经在 MVC 项目中使用过这些控件？

我的公司在一个大型应用程序中使用 Telerik ASP.NET 控件，效果很好。这就是我们考虑在 MVC 项目中使用它们的原因。

编辑 1：telerik 在 ASP.NET MVC 上有一个新的尝试，这看起来比他们第一次尝试要好得多。但对我的项目来说已经太晚了。[http://www.telerik.com/products/aspnet-mvc.aspx](http://www.telerik.com/products/aspnet-mvc.aspx)

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2009-03-29T12:45:40.873

您可以查看他们使用 ASP.NET MVC 构建的[演示应用程序（一个论坛应用程序），](http://demos.telerik.com/mvc)[在此处公布](http://telerikwatch.com/2009/01/telerik-mvc-demo-app-now-available.html)。[源代码](http://demos.telerik.com/mvc/mvc-forum.zip)可用。

> 该演示是一个简单而时尚的论坛应用程序。它使用 9 个 RadControls，包括 RadGrid、RadEditor、RadChart、RadTreeView 和 RadUpload，来构建一个论坛站点，该站点具有基本的线程/帖子导航、格式化的论坛发布、用户身份验证（支持自定义头像）和站点活动“统计”视图。拥有功能齐全的 MVC 论坛应用程序所需的一切。源代码可立即下载，因此我鼓励任何有兴趣了解更多有关 MVC 或 MVC 中的 RadControls 的人抓紧时间并研究该示例。

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2009-03-29T12:51:29.097

你可能已经看过了，但是 Telerik 有[一篇](http://blogs.telerik.com/AtanasKorchev/Posts/08-11-06/ASP_NET_Ajax_Controls_in_ASP_NET_MVC.aspx)关于如何将他们的控件与 MVC 一起使用的博客文章以及一些限制。我实际上并没有使用他们的控件，所以我不能说这些限制是否真的是一个问题。可以说，在将控件与 MVC 一起使用时，似乎确实有更多的“手动提升”，但是有一些变通方法可以使大多数控件正常工作。

我希望他们最终会发布其控件的 MVC 版本。我会推迟评估它们，直到发生这种情况，但如果你已经在使用它们，我当然会看看它们与 MVC 一起使用有多么容易。如果你试一试，也许你可以用答案更新你的问题，让我们其他人知道它是怎么回事。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2011-10-31T21:08:04.663

我已经使用 Telerik 控件大约 6 个月了。我一直在 MVC 2 上使用 Grid 和 Window 控件。像大多数商业产品一样，我们有幸解决了这些问题。一旦您通过了最初的学习曲线，这些控件就可以节省时间。您获得的功能数量无法超过价格。

我最大的问题是他们在论坛上的反应似乎有点迟钝。也许我只是在问蹩脚的问题。我一直在游说管理层为受支持的版本支付费用。考虑到我们花费大量时间挖掘解决一些更复杂的问题，我认为这是值得的。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2010-10-25T20:19:20.063

我刚刚查看了他们的网格并用它编写了一个小型 POC 项目，我必须说我印象深刻。我不确定他们以前的 MVC 控件迭代，但当前的可以节省时间。它也非常适合 ASP.NET MVC ajax 应用程序，因为它有丰富的客户端 API。在客户端拥有 jquery DataTables 会带来更好的用户体验（因为它更快），但也需要更容易出错的 JavaScript 代码。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2020-03-19T15:25:29.687

作为替代方案，您可以检查 MDBootstrap（它是建立在 Bootstrap 之上的前端框架）。在那里你会发现[一篇](https://mdbootstrap.com/articles/miscellaneous/ready-to-use-asp-net-mvc-templates-from-mdb-and-how-to-integrate-them/)包含免费 ASP.NET MVC 模板的文章。

# c++ - 指定构造 boost::unordered_map 时的最小桶数

> ID：694572
> 
> 赞同：3
> 
> 时间：2009-03-29T12:39:53.430
> 
> 标签：c++, boost, unordered-map

我正在尝试使用 boost::unordered_map 来缓存一些值。我尝试在构造函数中指定最小桶数：

```
#include <boost/unordered_map.hpp>
typedef boost::unordered_map<float, float> Mycache;
Mycache cache((std::size_t)25165843,
              boost::hash<float>(),
              std::equal_to<float>(),
              std::allocator<std::pair<float const, float> >()); 
```

但是当我在程序结束时显示有关我的 unordered_map 的信息时：

克++：

```
unordered_map.size(): 15861612
unordered_map.load_factor: 10.0845
unordered_map.bucket_count: 1572869
unordered_map.max_size: 1572868
unordered_map.max_load_factor: 1
unordered_map.max_bucket_count: 1572869 
```

vc++:

```
unordered_map.size(): 13916119
unordered_map.load_factor: 8.8476
unordered_map.bucket_count: 1572869
unordered_map.max_size: 1572868
unordered_map.max_load_factor: 1
unordered_map.max_bucket_count: 1572869 
```

如何指定最小桶数？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2009-06-22T15:08:24.070

关于标准的另一个答案是正确的，但小`max_bucket_count`实际上是Boost 1.38中的一个错误，任何其他版本都会让你使用更多的桶。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2009-03-29T13:48:59.787

`boost::unordered_map::max_bucket_count()`返回对 的桶计数的依赖于实现的限制`unordered_map`。您的构造函数参数似乎已超出此限制。请注意，虽然 MSDN 将其定义为“当前”允许的最大存储桶（无论这意味着什么），但 C++0x 规范将其定义为地图可以拥有的最多存储桶。

我从未使用过该类，并且在 C++0x 规范草案中看不到任何内容来解释为什么构造函数会默默地创建一个对象，而该对象并没有按照您的要求执行。

我也不知道 value 背后的动机是什么`1572869`，除了它是一个大素数。

# javascript - Javascript令牌替换/附加

> ID：694576
> 
> 赞同：1
> 
> 时间：2009-03-29T12:43:42.627
> 
> 标签：javascript, regex, merge, replace, token

我有一个字符串，看起来类似于以下 'test:1;hello:five;just:23'。使用此字符串，我需要能够执行以下操作。

```
....
var test = MergeTokens('test:1;hello:five;just:23', 'yes:23;test:567');
... 
```

最终结果应该是 'test:567;hello:five;just:23;yes:23' （注意标记的确切顺序并不重要）。

只是想知道是否有人对如何解决这个问题有任何聪明的想法。我在想对右边的每个标记进行正则表达式替换，如果因为不匹配而没有发生替换，只需附加它。但也许有更好的方法。

干杯安东尼

编辑：右侧应覆盖左侧。左边是原来的内容，右边是新内容。另一种看待它的方式是，如果它们不存在于右侧，则仅将标记保留在左侧，并将所有标记保留在右侧。

**@Ferdinand** 感谢您的回复。问题是您提出的解决方案的效率。我最初考虑过类似的路线，但由于合并的 O(n*z) 复杂性（其中 n 和 z 分别是左侧和右侧的数字标记），更不用说拆分和连接了。

因此，为什么我试图查看正则表达式的路径。也许在幕后，正则表达式同样糟糕或更糟，但是有一个正则表达式从右侧存在的左侧字符串中删除任何令牌（O（n）右侧令牌的总量），然后只需添加2串在一起（即vat test = test1 + test2）似乎更有效。谢谢

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2009-03-29T12:55:53.720

我将使用`join()`并`split()`创建一些实用程序函数来将您的令牌数据打包和解包到一个对象：

```
// Unpacks a token string into an object.
function splitTokens(str) {
    var data = {}, pairs = str.split(';');
    for (var i = 0; i < pairs.length; ++i) {
        var pair = pairs[i].split(':');
        data[pair[0]] = pair[1];
    }
    return data;
}

// Packs an object into a token string.
function joinTokens(data) {
    var pairs = [];
    for (var key in data) {
        pairs.push(key + ":" + data[key]);
    }
    return pairs.join(';');
} 
```

使用这些，合并很容易：

```
// Merges all token strings (supports a variable number of arguments).
function mergeTokens() {
    var data = {};
    for (var i = 0; i < arguments.length; ++i) {
        var d = splitTokens(arguments[i]);
        for (var key in d) {
            data[key] = d[key];
        }
    }
    return joinTokens(data);
} 
```

如果您想提取一些键（比如“测试”）和/或检查是否存在，实用程序函数也很有用：

```
var data = splitTokens(str);
if (data["test"] === undefined) {
    // Does not exist
} else {
    alert("Value of 'test': " + data["test"]);
} 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-03-30T02:37:42.527

以下是我结束思考的内容。你们怎么看？

谢谢安东尼

```
function Tokenizer(input, tokenSpacer, tokenValueSpacer) {
    this.Tokenizer = {};
    this.TokenSpacer = tokenSpacer;
    this.TokenValueSpacer = tokenValueSpacer;
    if (input) {
        var TokenizerParts = input.split(this.TokenSpacer);
        var i, nv;
        for (i = 0; i < TokenizerParts.length; i++) {
            nv = TokenizerParts[i].split(this.TokenValueSpacer);
            this.Tokenizer[nv[0]] = nv[1];
        }
    }
}

Tokenizer.prototype.add = function(name, value) {
    if (arguments.length == 1 && arguments[0].constructor == Object) {
        this.addMany(arguments[0]);
        return;
    }
    this.Tokenizer[name] = value;
}

Tokenizer.prototype.addMany = function(newValues) {
    for (nv in newValues) {
        this.Tokenizer[nv] = newValues[nv];
    }
}

Tokenizer.prototype.remove = function(name) {
    if (arguments.length == 1 && arguments[0].constructor == Array) {
        this.removeMany(arguments[0]);
        return;
    }
    delete this.Tokenizer[name];
}

Tokenizer.prototype.removeMany = function(deleteNames) {
    var i;
    for (i = 0; i < deleteNames.length; i++) {
        delete this.Tokenizer[deleteNames[i]];
    }
}

Tokenizer.prototype.MergeTokenizers = function(newTokenizer) {
    this.addMany(newTokenizer.Tokenizer);
}

Tokenizer.prototype.getTokenString = function() {
    var nv, q = [];
    for (nv in this.Tokenizer) {
        q[q.length] = nv + this.TokenValueSpacer + this.Tokenizer[nv];
    }
    return q.join(this.TokenSpacer);
}

Tokenizer.prototype.toString = Tokenizer.prototype.getTokenString; 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2010-10-05T04:49:02.363

我晚了几年，但我认为这就是你要找的：

```
function MergeTokens(input, replace){
 var replaceTokens = replace.split(";");
 for(i=0; i<replaceTokens.length; i++){
  var pair = replaceTokens[i].split(":");
  var result = input;
  regString = "\\b" + pair[0] + ":[\\w]*\\b";
  var reg = new RegExp(regString);
  if(reg.test(result)){
   result = result.replace(reg, replaceTokens[i]);
  }
  else{
   result = result + replaceTokens[i];
  }
 }
 return result;
} 
```

# sql - 如何检查表上持有哪些锁

> ID：694581
> 
> 赞同：197
> 
> 时间：2009-03-29T12:46:43.150
> 
> 标签：sql, sql-server, database, performance, sql-server-2005

我们如何检查针对查询批处理的哪些行应用了哪些数据库锁？

有什么工具可以实时突出表行级锁定吗？

数据库：SQL Server 2005

* * *

## 回答 #1

> 赞同：150
> 
> 时间：2009-03-29T12:50:55.527

这并不能准确地向您显示哪些行被锁定，但这可能对您有所帮助。

您可以通过运行以下命令检查哪些语句被阻止：

```
select cmd,* from sys.sysprocesses
where blocked > 0 
```

它还会告诉您每个块正在等待什么。因此，您可以一直追踪它，以查看哪个语句导致了第一个块导致其他块。

**编辑**以添加来自[@MikeBlandford](https://stackoverflow.com/users/28643/mike-blandford)的评论：

> 阻塞列表示阻塞进程的 spid。你可以运行 kill {spid} 来修复它。

* * *

## 回答 #2

> 赞同：136
> 
> 时间：2009-03-29T14:02:18.897

要添加到其他响应，`sp_lock`还可以用于转储所有正在运行的进程的完整锁定信息。输出可能是压倒性的，但如果您想确切地知道锁定了什么，运行它是很有价值的。我通常使用它`sp_who2`来快速解决锁定问题。

`sp_lock`根据所讨论的 SQL Server 版本，在线提供了多种不同版本的“更友好”过程。

在您的情况下，对于 SQL Server 2005，`sp_lock`仍然可用，但已弃用，因此现在建议将[`sys.dm_tran_locks`](http://msdn.microsoft.com/en-us/library/ms190345.aspx)视图用于此类事情。[您可以在此处](http://www.techrepublic.com/blog/the-enterprise-cloud/write-your-own-sp-lock-system-stored-procedure-in-sql-server-2005/)找到如何“滚动您自己的”sp_lock 函数的示例。

* * *

## 回答 #3

> 赞同：78
> 
> 时间：2016-08-04T10:27:35.530

您可以通过以下查询找到表上的当前**锁。**

```
USE yourdatabase;
GO

SELECT * FROM sys.dm_tran_locks
  WHERE resource_database_id = DB_ID()
  AND resource_associated_entity_id = OBJECT_ID(N'dbo.yourtablename'); 
```

请参见[sys.dm_tran_locks](https://msdn.microsoft.com/en-us/library/ms190345.aspx)

如果存在多个相同**request_owner_type的实例，则使用****request_owner_id**列来区分每个实例。对于分布式事务，**request_owner_type**和**request_owner_guid**列将显示不同的实体信息。

例如，会话 S1 拥有 Table1 上的共享锁；在会话 S1 下运行的事务 T1 也拥有 Table1 上的共享锁。在这种情况下，**sys.dm_tran_locks**返回的**resource_description**列将显示同一资源的两个实例。**request_owner_type**列将一个实例显示为会话，另一个实例显示为事务。此外，**resource_owner_id**列将具有不同的值。

 ******* * *

## 回答 #4

> 赞同：37
> 
> 时间：2009-06-11T17:01:02.427

我使用动态管理视图 (DMV) 来捕获锁以及被锁定项目的 object_id 或 partition_id。

（必须切换到要观察的数据库才能获取 object_id）

```
SELECT 
     TL.resource_type,
     TL.resource_database_id,
     TL.resource_associated_entity_id,
     TL.request_mode,
     TL.request_session_id,
     WT.blocking_session_id,
     O.name AS [object name],
     O.type_desc AS [object descr],
     P.partition_id AS [partition id],
     P.rows AS [partition/page rows],
     AU.type_desc AS [index descr],
     AU.container_id AS [index/page container_id]
FROM sys.dm_tran_locks AS TL
INNER JOIN sys.dm_os_waiting_tasks AS WT 
 ON TL.lock_owner_address = WT.resource_address
LEFT OUTER JOIN sys.objects AS O 
 ON O.object_id = TL.resource_associated_entity_id
LEFT OUTER JOIN sys.partitions AS P 
 ON P.hobt_id = TL.resource_associated_entity_id
LEFT OUTER JOIN sys.allocation_units AS AU 
 ON AU.allocation_unit_id = TL.resource_associated_entity_id; 
```

* * *

## 回答 #5

> 赞同：20
> 
> 时间：2009-03-29T12:54:34.003

您还可以使用内置`sp_who2`存储过程来获取 SQL Server 实例上的当前阻塞和阻塞进程。通常，您会在 SQL Profiler 实例旁边运行它以查找阻塞进程并查看 spid 在 profiler 中发出的最新命令。

* * *

## 回答 #6

> 赞同：16
> 
> 时间：2019-08-05T12:42:38.793

您可以通过以下脚本找到详细信息。

```
-- List all Locks of the Current Database 
SELECT TL.resource_type AS ResType 
      ,TL.resource_description AS ResDescr 
      ,TL.request_mode AS ReqMode 
      ,TL.request_type AS ReqType 
      ,TL.request_status AS ReqStatus 
      ,TL.request_owner_type AS ReqOwnerType 
      ,TAT.[name] AS TransName 
      ,TAT.transaction_begin_time AS TransBegin 
      ,DATEDIFF(ss, TAT.transaction_begin_time, GETDATE()) AS TransDura 
      ,ES.session_id AS S_Id 
      ,ES.login_name AS LoginName 
      ,COALESCE(OBJ.name, PAROBJ.name) AS ObjectName 
      ,PARIDX.name AS IndexName 
      ,ES.host_name AS HostName 
      ,ES.program_name AS ProgramName 
FROM sys.dm_tran_locks AS TL 
     INNER JOIN sys.dm_exec_sessions AS ES 
         ON TL.request_session_id = ES.session_id 
     LEFT JOIN sys.dm_tran_active_transactions AS TAT 
         ON TL.request_owner_id = TAT.transaction_id 
            AND TL.request_owner_type = 'TRANSACTION' 
     LEFT JOIN sys.objects AS OBJ 
         ON TL.resource_associated_entity_id = OBJ.object_id 
            AND TL.resource_type = 'OBJECT' 
     LEFT JOIN sys.partitions AS PAR 
         ON TL.resource_associated_entity_id = PAR.hobt_id 
            AND TL.resource_type IN ('PAGE', 'KEY', 'RID', 'HOBT') 
     LEFT JOIN sys.objects AS PAROBJ 
         ON PAR.object_id = PAROBJ.object_id 
     LEFT JOIN sys.indexes AS PARIDX 
         ON PAR.object_id = PARIDX.object_id 
            AND PAR.index_id = PARIDX.index_id 
WHERE TL.resource_database_id  = DB_ID() 
      AND ES.session_id <> @@Spid -- Exclude "my" session 
      -- optional filter  
      AND TL.request_mode <> 'S' -- Exclude simple shared locks 
ORDER BY TL.resource_type 
        ,TL.request_mode 
        ,TL.request_type 
        ,TL.request_status 
        ,ObjectName 
        ,ES.login_name;

--TSQL commands
SELECT 
       db_name(rsc_dbid) AS 'DATABASE_NAME',
       case rsc_type when 1 then 'null'
                             when 2 then 'DATABASE' 
                             WHEN 3 THEN 'FILE'
                             WHEN 4 THEN 'INDEX'
                             WHEN 5 THEN 'TABLE'
                             WHEN 6 THEN 'PAGE'
                             WHEN 7 THEN 'KEY'
                             WHEN 8 THEN 'EXTEND'
                             WHEN 9 THEN 'RID ( ROW ID)'
                             WHEN 10 THEN 'APPLICATION' end  AS 'REQUEST_TYPE',

       CASE req_ownertype WHEN 1 THEN 'TRANSACTION'
                                     WHEN 2 THEN 'CURSOR'
                                     WHEN 3 THEN 'SESSION'
                                     WHEN 4 THEN 'ExSESSION' END AS 'REQUEST_OWNERTYPE',

       OBJECT_NAME(rsc_objid ,rsc_dbid) AS 'OBJECT_NAME', 
       PROCESS.HOSTNAME , 
       PROCESS.program_name , 
       PROCESS.nt_domain , 
       PROCESS.nt_username , 
       PROCESS.program_name ,
       SQLTEXT.text 
FROM sys.syslockinfo LOCK JOIN 
     sys.sysprocesses PROCESS
  ON LOCK.req_spid = PROCESS.spid
CROSS APPLY sys.dm_exec_sql_text(PROCESS.SQL_HANDLE) SQLTEXT
where 1=1
and db_name(rsc_dbid) = db_name()

--Lock on a specific object
SELECT * 
FROM sys.dm_tran_locks
WHERE resource_database_id = DB_ID()
AND resource_associated_entity_id = object_id('Specific Table'); 
```

* * *

## 回答 #7

> 赞同：8
> 
> 时间：2020-11-24T05:12:00.847

您可以通过运行以下命令找到阻塞 sql 和等待 sql：

```
SELECT
    t1.resource_type ,
    DB_NAME( resource_database_id) AS dat_name ,
    t1.resource_associated_entity_id,
    t1.request_mode,
    t1.request_session_id,
    t2.wait_duration_ms,
    ( SELECT TEXT FROM sys.dm_exec_requests r CROSS apply sys.dm_exec_sql_text ( r.sql_handle ) WHERE r.session_id = t1.request_session_id ) AS wait_sql,
    t2.blocking_session_id,
    ( SELECT TEXT FROM sys.sysprocesses p CROSS apply sys.dm_exec_sql_text ( p.sql_handle ) WHERE p.spid = t2.blocking_session_id ) AS blocking_sql 
FROM
    sys.dm_tran_locks t1,
    sys.dm_os_waiting_tasks t2 
WHERE
    t1.lock_owner_address = t2.resource_address 
```

# ruby-on-rails - rails中的link_to_remote问题

> ID：694593
> 
> 赞同：4
> 
> 时间：2009-03-29T12:57:16.493
> 
> 标签：ruby-on-rails, ruby, ajax

我在 Rails 中使用 link_to_remote 时遇到了一致性问题。

我有 2 个 link_to_remote 用例，它们生成不同的 ajax。我不知道为什么，这让我发疯。

这是用例一...

```
<%= link_to_remote "section-", :update => "sections", :url => {:action => :destroy, :controller => "sections", :id => @section.id } %> 
```

这会生成适当的 ajax（如下所示）并按我的预期工作。请注意，它从调用中获取 :action 参数并将其正确插入到 ajax 中。

```
<a href="#" onclick="if { new Ajax.Updater('sections', '/sections/destroy/1', {asynchronous:true, evalScripts:true, parameters:'authenticity_token=' + encodeURIComponent('f5e50e62fafd118e4588b33c9571ea6eef864176')}); }; return false;">section-</a> 
```

我还有另一个使用 link_to_remote 的实例，但它会生成不正确的 ajax。用例几乎相同，只是控制器不同。无论哪种方式，我都不希望这会导致不同的ajax。

通话...

```
<%= link_to_remote "question-", :update =>"questions-1", :url => {:action => :destroy, :controller => "questions", :id => @question.id} %> 
```

生成的ajax...

```
<a href="#" onclick="if { new Ajax.Updater('questions-1', '/questions/1', {asynchronous:true, evalScripts:true, parameters:'authenticity_token=' + encodeURIComponent('f5e50e62fafd118e4588b33c9571ea6eef864176')}); }; return false;">question-</a> 
```

这里明显的区别在于 Ajax.Updater 的第二个参数。该路径中缺少 :action 参数。为什么？这导致我的代码损坏，但我不明白为什么会这样。link_to_remote 调用几乎相同。

请指出我正确的方向。谢谢。

下面是我的 routes.rb 文件...

```
 ActionController::Routing::Routes.draw do |map|
  map.resources :questions, :has_one => :section, :collection => { :sort => :post }
  map.resources :sections, :has_many => :questions, :has_one => :form, :collection => { :sort => :post }
  map.resources :forms, :has_many => :sections

  # You can have the root of your site routed with map.root -- just remember to delete public/index.html.
  map.root :controller => "forms"

  map.connect ':controller/:action/:id'
  map.connect ':controller/:action/:id.:format'
end 
```

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2009-03-29T15:23:30.590

如果你把它复制到你的视图中，你会得到什么？

```
<%= url_for :action => :destroy, :controller => :questions, :id => @question.id %> 
```

我怀疑问题不在于 link_to_remote，而在于[routing](http://api.rubyonrails.org/classes/ActionController/Routing.html)。一旦 url_for 返回您期望的 URL，然后再次尝试 link_to_remote。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2009-03-30T20:18:05.257

只需在您的 link_to_remote 调用中添加 :method => :delete 可能是最简单的解决方法：

```
<%= link_to_remote "question-", :update =>"questions-1", :url => {:action => :destroy, :controller => "questions", :id => @question.id}, :method => :delete %> 
```

这应该强制调用 /questions/:id 以使用 HTTP DELETE 方法。如果您希望上述调用生成 url /questions/destroy/:id 而不是我相信您需要手动更改您的路线，因为默认的 map.resources 似乎没有达到该结果。

# asp.net - 什么是 asp.net mvc 的理想人选

> ID：694594
> 
> 赞同：2
> 
> 时间：2009-03-29T12:59:24.243
> 
> 标签：asp.net, asp.net-mvc

是否有任何特定的网站可以使用 MVC 与 webforms。

在这些选项之间做出决定的决策过程是什么？

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2009-03-30T03:09:31.640

现在有很多围绕 MVC 的热情，但是如果你现在开始一个新的开发项目，我仍然建议你在跳上 MVC 火车之前仔细考虑一下。

对于任何重要项目的大多数开发团队来说，都有一些严肃的考虑。以下是我认为最相关的：

*   MVC 需要开发人员的更多技能。他们需要在 HTML/CSS 的内部工作方面拥有丰富的专业知识，并且对 HTTP 的工作方式有很好的理解。对于客户端代码，他们需要强大的 javascript 和 JQuery 技能，并且在服务器端需要对 OO 原则的高级掌握。如果你打算从 MVC 中获得最大的收益，那么还要有单元测试和模拟框架的经验。

*   MVC 1.x 框架目前在 Visual Studio 的 RAD 功能方面并没有太多优势。你会得到一个文本编辑器和智能感知，但仅此而已。没有向导，没有拖放组件，没有属性编辑器等。虽然这并不是那么糟糕，但这通常意味着构建非平凡的 UI 将花费更长的时间，尤其是对于经验不足的开发人员。

*   MVC 是非常新的，因此代码示例、教程和示例应用程序很难获得，而且范围往往非常有限。目前文档也有点薄。

*   MVC 框架的最大缺点可能是缺乏围绕它的成熟和成熟的第 3 方市场。借助 Web 表单，市场上有大量非常先进的 UI 套件和组件，还有大量可供您借鉴的开源项目。

*   对于许多应用程序，尤其是商业应用程序而言，缺乏仅适用于 MVC 框架的 3rd 方报告、图表和高级网格控件应该是一个主要问题。

MVC 很棒，如果您可以使用它，我强烈推荐它。但是任何非常复杂的项目都存在真正的成本和风险，可能会让您在 Web 表单上停留更长时间。

我确实希望 MVC 的下一个主要版本可能会解决其中的许多问题，尤其是在缺少 RAD 功能的情况下。我也期望围绕 MVC 的热情也会为平台带来大量的 3rd 方支持。但是，所有这些都需要一些时间才能很好地建立起来。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-03-29T13:13:48.187

我不会说一种类型的网站会更好，但或多或​​少地满足网站的需求。

如果您需要一个无需大量代码即可快速组合在一起的网站，并且您不关心 HTML 标记。比 WebForms 是要走的路。

如果您是控制狂，并且想要控制正在发生的一切以及生成的标记。比 MVC 可能更适合你。

MVC 不是 HTTP 模型的抽象，这意味着为您做的事情要少得多。它不像 WebForms 的 ViewState 那样保持状态。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2009-04-08T20:49:44.493

在过去的 4 周里，我阅读了有关 MVC 的可用材料并制作了各种视频和教程。今天我开始研究一个实际的应用程序（一个客户正在等待很快看到结果）。我同意以前的答案（要学习很多东西，很多新概念，很少代替 3rd 方组件）。我仍然很高兴我花时间学习 mvc。- 你必须克服对隐藏在网络表单中的行 html/css/jscript 的恐惧。习惯 html 标签需要时间。一旦你这样做，你会发现可用的可能性。您不太可能会错过标签。- 如果您没有使用单元测试的经验，那么我认为 mvc 很好地介绍了单元测试带来的可能性。- OO 在 mvc 中更加存在和“明显”。
- 关注点分离是可能的和自然的。您不会错过在 aspx.cs 文件中混合 gui 和业务逻辑的机会。
- 没有更多的 page_load（以及 n 个不同的阶段）。如果您从不喜欢 asp.net 的数据绑定，那么您会喜欢 mvc。我很高兴不必再这样做了！

缺点： - 它很慢。一开始它很慢。在 web 表单中花费很少时间的事情，在 mvc 中可能会花费很多时间。
- 不再有页面也是一个巨大的变化。但是一旦你“内化”这个（时间......），你就不会错过这些页面。- 还需要一个 O/R 映射器。还有一件事要学。- 如果您有兴趣充分利用该框架，有很多东西需要学习和习惯。MVC 只是没有单元测试的半 mvc。没有模拟框架的单元测试是不可能的，所以你也必须学习。当您认为单元测试已经完成一半时，您会看到需要自动化部分工作时，也必须学习 nant。它只是无止境....但又一次，

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2009-03-29T13:14:05.363

对我来说，决策过程非常简单。所有新的开发都将使用 ASP.NET MVC 完成。需要稍作修改的现有站点将继续是 WebForms。需要进行重大修改的现有站点将成为迁移到 MVC 的候选者。

我进行转换的基本原因与可测试性和设计有关。IMO MVC 网站的可测试性明显更高。我可以使用单元测试来测试除视图逻辑之外的所有内容，并且通过使用和测试 HtmlHelper 扩展，我什至可以测试相当数量的视图逻辑。使用 WebForms 时，我不得不跳很多圈来测试代码隐藏，结果留下了很多应用程序进行手动测试。

我也觉得从设计的角度来看架构更好。由于关注点的明确分离，将业务逻辑插入错误的位置（例如视图）不太容易。它使概念化和理解应用程序变得更加容易。我还能够以更少的努力重用甚至查看代码，因为我没有来自其他层的无关逻辑位阻碍。

我目前看到的唯一真正的缺点是它还不够成熟，而且你还没有为它构建那么多可重用的组件。不过，我希望这种情况会随着时间的推移而改变。此外，即使可以将 MVC 与 WebForms 混合使用，我也不认为改造现有应用程序是一种可行的替代方案，除非还有其他重要工作要做。同样，这只是我的观点，但我宁愿从头开始使用 MVC，也不愿尝试让现有的应用程序使用它。我想这取决于应用程序的大小，但是任何具有大量页面的东西都会有很多路由异常。

# .net - .Net 人的源代码控制

> ID：694596
> 
> 赞同：6
> 
> 时间：2009-03-29T12:59:59.873
> 
> 标签：.net, asp.net, version-control

> 请参阅 [.Net 项目的 VSS 或 SVN？](https://stackoverflow.com/questions/690766/vss-or-svn-for-a-net-project)，以及许多其他类似的问题。

ASP.Net 开发人员有很多选择，有些完全是垃圾，有些功能丰富且价格昂贵。

在进行个人开发时，我已经使用 Visual Source Safe 2005 有一段时间了，但仅限于我的个人项目。它有问题，让我说。

最糟糕的问题是它似乎无法处理 ASP.Net 网站。无论您如何设置，大多数内容都不会在编辑时签出，我通常必须获取最新信息并说“保留本地更改并签出”才能获得该功能。

无论如何，我想看看是否有人可以帮助我从这个怪物转移到更稳定的地方。Team Foundation Server 显然是矫枉过正。SourceVault 是可靠的，但有点贵。SVN 是免费的，但大多数其他源代码控制提供商为您提供的所有插件都会让您付出“代价”。

我只是想知道每个人都在使用什么，以及他们是否可以提出更好的方法。

* * *

## 回答 #1

> 赞同：13
> 
> 时间：2009-03-29T13:56:19.973

I recently moved my team off SourceSafe to Subversion using three free tools:

1.  [VisualSVN Server](http://www.visualsvn.com/server/) - Subversion server package for Windows
2.  [TortoiseSVN](http://tortoisesvn.tigris.org/) - Explorer shell extension
3.  [AnkhSVN](http://ankhsvn.open.collab.net/) - Visual Studio plugin

You'll also want to reference the [Subversion book](http://svnbook.red-bean.com/).

This was easy to set up and has been a tremendous success. SourceSafe is a disaster -- the final straw for me was when I had to merge a feature branch and discovered that the functionality really doesn't exist in any usable form.

I prefer to use TortoiseSVN for complex operations such as adding solutions to svn, branching, and merging. I use AnhkSVN for updates, commits, and reverts.

Be aware that the latest versions of these tools are currently built against different versions of Subversion. VisualSVN and AnkhSVN are built against 1.5.5 but TortoiseSVN is built against 1.6\. You can either grab the previous version of TortoiseSVN or use a daily build of AnkhSVN.

* * *

## 回答 #2

> 赞同：7
> 
> 时间：2009-03-29T13:38:42.540

I suggest to take a closer look at SVN. We made the move from SourceSafe to SVN about 18 months ago, and I would never want to go back (we're mostly doing ASP.NET stuff).

Especially, when working in a team, the edit-merge-commit model makes it so much easier than SourceSafe's Lock-Edit-Unlock model. Also handling branches is much easier with subversion.

Regarding the plug-ins, I can say the following: I'm mainly using TortoiseSVN (free) which is nicely integrated into the windows explorer. I do not really miss a plug-in that is integrated into Visual Studio.

Out of curiosity, I installed AnkSVN (free), which gives you an integrated solution (in VS). I have to say, it works very well, but most of the time, I still use TortoiseSVN.

* * *

## 回答 #3

> 赞同：5
> 
> 时间：2009-03-29T13:38:30.280

You write .NET guy... if you are just a single user, SourceGear Vault is free. After that it runs about $250 / user with support. Either way, I have been using Vault for years. Simple, works well and coming from Source Safe, the interface will be similar.

[www.sourcegear.com](http://www.sourcegear.com)

At home, I use the free, single user edition. At work, we have licensed about 60 users.

* * *

## 回答 #4

> 赞同：4
> 
> 时间：2009-03-29T13:09:48.460

VisualSVN 很棒但不是免费的（尽管它的社区许可证允许在非域计算机上免费使用）。AnkhSVN 是免费的。Bazaar 还没有与 VS 进行太多集成，但它在命令行中非常棒。

对于大型项目，如果您正在寻找集中式源代码控制系统，TFS 是一种方法。

我个人建议切换到 Git。

* * *

## 回答 #5

> 赞同：3
> 
> 时间：2009-03-29T13:26:33.523

我将免费的 Visual SVN 服务器用于服务器端，将 TortoiseSVN 客户端用于 Explorer 集成。

我不关心 Visual Studio 集成，因为我也将 TVSN 用于非 VS 项目。我还使用 MSBuild 社区任务安装了用于自动构建的命令行 SVN 工具。

我还设置了 TortoiseSVN 以在树中有任何未签入的内容时显示“已修改”图标，并且我忽略特定文件夹（例如`bin`和`obj`）。我的结帐树与我的存储库布局相匹配。

* * *

## 回答 #6

> 赞同：2
> 
> 时间：2009-03-29T13:05:35.397

如果你的工作如此不重要以至于你拒绝花钱，那为什么要这样做呢？咬紧牙关，花 50 美元购买[VisualSVN](http://www.visualsvn.com)。

* * *

## 回答 #7

> 赞同：2
> 
> 时间：2009-03-29T13:27:06.297

I went with Team System and have been very happy. Yes, it's probably got more stuff in it than I will ever use, but my thinking was -- do I want to spend my time on configuring and maintaining a lot of free (or inexpensive) software and roll my own development environment or spend my (company's) money on an integrated environment that our server guys could maintain for me. I decided that my time was worth a whole lot more to the organization writing code and was enough of a justification to make the investment in TFS.

Believe me, it wasn't much of a sell to my manager who fully agreed with me. Since the server guys already maintain SharePoint and SQL Server for other reasons, it's not even much more effort for them -- just another server to worry about out of the dozens they're already supporting. Since we're running it on a VM, the hardware costs are negligible.

If I were working for myself, obviously, my calculation may have been different. I would say, though, that you need to consider the expense not only of the software but also in terms of the amount of time (and skill) you're willing to devote to maintaining your environment. You need to consider the opportunity cost associated with pulling bits and pieces of your dev environment together and maintaining it when you could be writing paying code.

* * *

## 回答 #8

> 赞同：1
> 
> 时间：2009-03-29T13:46:21.150

**[SourceGear Fortress](http://www.sourcegear.com)** (Client and Server)

*   Great integration with Visual Studio
*   Solid application
*   Has an issue tracking systemm on board

* * *

## 回答 #9

> 赞同：1
> 
> 时间：2009-05-24T13:55:19.137

Team Foundation Server is not necessarily overkill. If your team has 5 or fewer developers AND you already have an MSDN subscription you can use the workgroup edition for free. Upgrading to the full edition when the team gets bigger isn't too bad either.

You don't have to use all of the project management features if you don't want to. Using the source control alone is fine and a big improvement over Visual Sourcesafe.

I would swap out the default compare and merge tools with something like [Compare It!](http://www.grigsoft.com/wincmp3.htm) though.

# c# - 从 Winforms 迁移到 WPF

> ID：694597
> 
> 赞同：5
> 
> 时间：2009-03-29T13:00:21.853
> 
> 标签：c#, wpf, winforms

我们使用 Infragistic 框架使用 Winforms。我们正在考虑迁移到 WPF。问题是我们在 Winforms 中已经有几个表单、对话框等。我们需要通用的外观和感觉，因此我们需要将所有内容迁移到 WPF。

是否有迁移工具来获取 Winforms 并迁移到 WPF？我知道不可能完全做到这一点，但有什么可以做一些工作的吗？

谢谢

* * *

## 回答 #1

> 赞同：12
> 
> 时间：2009-03-29T13:14:08.530

在我看来，并且取决于您的架构，一对一的翻译并不是真正的正确方法：考虑您为什么要迁移到 wpf，并评估您是否真的想致力于它。这是一个强大的框架，但学习曲线相当陡峭，要真正值得，您需要花时间查看用户体验并了解 wpf 如何提供帮助。如果您想拥有 winform 的外观和感觉，并且只是转向 wpf，因为它是下一个新事物，那么您会遇到令人不快的惊喜。

无论如何，我们在迁移我们的 winforms 东西时所做的是在 wpf 中制作新屏幕，并使用[ElementHost](http://msdn.microsoft.com/en-us/library/system.windows.forms.integration.elementhost.aspx)和[WindowsFormsHost](http://msdn.microsoft.com/en-us/library/system.windows.forms.integration.windowsformshost.aspx)继续托管旧的 winforms 屏幕。顺便说一句，这些工作非常好——到目前为止我们还没有遇到任何问题。然后我们逐屏迁移到 wpf。同时看起来像一个科学怪人，但至少我们有定期的反馈，一切正常。

# c++ - Qt C++ 语法？

> ID：694598
> 
> 赞同：0
> 
> 时间：2009-03-29T13:01:32.833
> 
> 标签：c++, qt

我正在学习 Qt，发现了这个：

```
Widget::Widget(QWidget *parent)
    : QWidget(parent), ui(new Ui::WidgetClass)
{
    ui->setupUi(this);
} 
```

": QWidget(parent), ui(new Ui::WidgetClass)" 是什么意思？

我怎样才能得到关于这个的 C++ 文档？

* * *

## 回答 #1

> 赞同：8
> 
> 时间：2009-03-29T13:02:39.697

这对 Qt 来说没什么特别的，只是 C++ 的一部分。

`: QWidget(parent)`只是调用基础构造函数。

`ui(new Ui::WidgetClass)`只是一个被初始化的成员。

例子：

```
class B
{
public:
  B(int x)
  {
    myx = x;
  }

  int myx;
};

class D : public B
{
public:
   D() 
   : B(4), p(new char[1024])
   {
   }

   ~D()
   {
     delete[] p;
   }

   char *p;
}; 
```

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2009-03-29T13:15:56.217

该构造称为**初始化列表**，用于初始化类构造函数中的基类和/或成员变量。

如果您想了解有关它们的更多信息（这是 C++ 中的一个基本概念），请参阅例如[此文档](http://www.cprogramming.com/tutorial/initialization-lists-c++.html)或[询问“the”google](http://www.google.com/search?hl=en&q=c%2B%2B+initialization+list)。

# objective-c - 如何为 NSOutputStream 添加数据？

> ID：694601
> 
> 赞同：1
> 
> 时间：2009-03-29T13:02:15.360
> 
> 标签：objective-c, cocoa, sockets, stream

我想将 UIImage 转换为 NSOutputStream 并通过套接字将其发送到服务器。

```
 #import "Connection.h"

@implementation Connection

-(void) open: (NSString *) h : (int) p
{
    strHost = h;
    intPort = p;

    [NSStream getStreamsToHost:objHost
                port:intPort
            inputStream:&receiveStream
            outputStream:&sendStream];

    [receiveStream retain];
    [sendStream retain];

    [receiveStream setDelegate:self];
    [sendStream setDelegate:self];

    [receiveStream scheduleInRunLoop:[NSRunLoop currentRunLoop]                 forMode:NSDefaultRunLoopMode];
    [sendStream scheduleInRunLoop:[NSRunLoop currentRunLoop]                forMode:NSDefaultRunLoopMode];

    [receiveStream open];
    [sendStream open];

    printf("Open.\n");
}

- (void) stream: (NSStream *) stream handleEvent: (NSStreamEvent) eventCode
{
    printf("EVENT: Start.\n");

    switch(eventCode)
    {
        case NSStreamEventOpenCompleted:
        {
            printf("EVENT: Open completed.\n");

            if(stream == receiveStream)
            {
                printf("Receiving...\n");
            }

            if(stream == sendStream)
            {
                printf("Sending...\n");

                NSString * strBuffer = [NSString stringWithFormat:@"GET / HTTP/1.0\r\n\r\n"];
                const uint8_t * rawstring = (const uint8_t *)[strBuffer UTF8String];

                [sendStream write:rawstring maxLength:strlen(rawstring)];
            }

            break;
        }
        case NSStreamEventEndEncountered:
        {
            printf("EVENT: End encountered.\n");
            break;
        }
        case NSStreamEventHasSpaceAvailable:
        {
            printf("EVENT: Has space available.\n");
            break;
        }
        case NSStreamEventHasBytesAvailable:
        {
            printf("EVENT: Has bytes available.\n");
            break;
        }
        case NSStreamEventErrorOccurred:
        {
            printf("EVENT: Error occurred.\n");
            break;
        }
        case NSStreamEventNone:
        {
            printf("EVENT: None.\n");
            break;
        }
    }

    printf("EVENT: End.\n");
}

-(void) close
{
    [receiveStream close];
    [sendStream close];

    printf("Closed.\n");
}

@end 
```

我的问题是在哪里可以添加像“sendStream = ...”这样的代码？

另一个问题是我可以使用以下方法将 UIImage 转换为 NSData：

```
NSData *imageData = UIImageJPEGRepresentation(imageView.image, 90);
```

但是如何将 imageData 转换为 NSOutputStream 的实例呢？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-03-29T13:37:06.540

> 我的问题是在哪里可以添加像“sendStream = ...”这样的代码？

您已经在分配`sendStream`消息`getStreamsToHost:port:inputStream:outputStream:`。该方法通过引用返回两个流。

> ... 如何将 imageData 转换为 NSOutputStream 的实例？

您不需要将数据转换为流，您需要告诉流写入数据。

试试[NSOutputStream 的`write:maxLength:`方法](http://developer.apple.com/documentation/Cocoa/Reference/Foundation/Classes/NSOutputStream_Class/Reference/Reference.html#//apple_ref/occ/instm/NSOutputStream/write:maxLength:)。您需要从数据对象传递字节和长度。

# apache-flex - 设计模式不适用于 Flex 4 项目

> ID：694607
> 
> 赞同：1
> 
> 时间：2009-03-29T13:07:41.790
> 
> 标签：apache-flex, adobe, air, flex4

我正在尝试将一个小型 Flex 3 AIR 项目移植到 Flex 4 (Gumbo)。一切都很好。我可以运行和调试应用程序。但由于某种原因，我不能使用我的 WindowedApplication 的设计模式。MXML 文件的头部如下所示：

```
<?xml version="1.0" encoding="utf-8"?>
<WindowedApplication xmlns="http://ns.adobe.com/mxml/2009"
        xmlns:mx="http://ns.adobe.com/mxml/2009"
... 
```

我收到一条错误消息，指出无法识别根节点。

其他人让这个在秋葵中工作吗？任何指针？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2009-03-29T13:36:28.210

看起来你遇到了一个[已知的错误](http://bugs.adobe.com/jira/browse/FB-12527)

# c# - ADO.Net Entity Framework 一个实体对象不能被多个 IEntityChangeTracker 实例引用

> ID：694625
> 
> 赞同：19
> 
> 时间：2009-03-29T13:28:25.670
> 
> 标签：c#, entity-framework, ado.net

我正在尝试保存我的联系人，其中引用了 ContactRelation（只是联系人、已婚、单身等的关系）和国家/地区。但是每次我尝试保存我的联系人时，我都会收到异常“ADO.Net Entity Framework An entity object cannot be referenced by multiple instances of IEntityChangeTracker”

```
public Contact CreateContact(Contact contact)
{
    _entities.AddToContact(contact); //throws the exception
    _entities.SaveChanges();
    return contact ;
} 
```

我将松散耦合的 MVC 设计与服务和存储库一起使用。我已经阅读了很多关于这个异常的帖子，但没有一个给我一个有效的答案......

谢谢你，彼得

* * *

## 回答 #1

> 赞同：21
> 
> 时间：2009-03-29T17:33:27.017

**[更新]**
由于使用 L2E，您需要先保存所有链接对象，然后才能保存主对象。这是有道理的，否则您将创建（在我的示例中）没有联系对象的艺术家。数据库设计不允许这样做。
**[/更新]**

这是我的实现。

```
[AcceptVerbs(HttpVerbs.Post)]
public ActionResult Create([Bind(Exclude = "Id")] Artist artist, [Bind(Prefix = "Contact")] Contact contact, [Bind(Prefix = "Country")] Country country, [Bind(Prefix = "ContactRelationship")] ContactRelationship contactRelationship)
{
    ViewData["Countries"] = new SelectList(new CountryService(_msw).ListCountries().OrderBy(c => c.Name), "ID", "Name");
    ViewData["ContactRelationships"] = new SelectList(new ContactRelationshipService(_msw).ListContactRelationships().OrderBy(c => c.ID), "ID", "Description");

    country = _countryService.GetCountryById(country.ID);
    contact.Country = country;
    contactRelationship = _contactRelationshipService.GetContactRelationship(contactRelationship.ID);
    contact.ContactRelationship = contactRelationship;
    if(_contactService.CreateContact(contact)){
        artist.Contact = contact;
        if (_service.CreateArtist(artist))
            return RedirectToAction("Index");        
    }
    return View("Create");
} 
```

然后在我的 ContactRepository 中：

```
public Contact CreateContact(Contact contact)
{
    _entities.AddToContact(contact); //no longer throws the exception
    _entities.SaveChanges();
    return contact ;
} 
```

~~我还在这个网站上发现，最好在整个应用程序中保持相同的上下文，所以我现在为此使用了一个特殊的 Data 类：~~

Rick Strahl 和 Samuel Maecham 告诉我，您应该根据每个请求保留每个用户的数据上下文。这意味着将其放入 Web 应用程序的 HttpContext 中。[在这里](http://samscode.com/index.php/2009/12/making-entity-framework-v1-work-part-1-datacontext-lifetime-management/)阅读所有相关信息

```
public class Data
{
    public static MyDBEntities MyDBEntities
    {
        get
        {
            if (HttpContext.Current != null && HttpContext.Current["myDBEntities"] == null)
            {
                HttpContext.Current["myDBEntities"] = new MyDBEntities ();
            }
            return HttpContext.Current["myDBEntities"] as MyDBEntities;
        }
        set { 
            if(HttpContext.Current != null)
                HttpContext.Current["myDBEntities"] = value; 
        }
    }
} 
```

* * *

## 回答 #2

> 赞同：5
> 
> 时间：2009-03-29T13:53:30.760

我以前见过这种情况，您可能必须在保存之前将 Reference 字段转换为 EntityKey，然后在保存后加载它。试试这个代码：

```
public Contact CreateContact(Contact contact){
    contact.ConvertContactRelationToReference();
    _entities.AddToContact(contact); 
    //throws the exception
    _entities.SaveChanges();
    contact.ContactRelation.Load();
    return contact;
}

public partial class Contact
{
  public void ConvertContactRelationToReference()
  {
    var crId = ContactRelation.Id;
    ContactRelation = null;
    ContactRelationReference.EntityKey = new EntityKey("MyEntities.ContactRelations", "Id", crId);
  }
} 
```

当然，根据您的确切数据库结构，可能需要更改其中一些代码。

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2010-12-05T16:04:24.210

嗯，我想知道是否有人可以理智地检查我的解决方案。它与下面接受的答案非常相似，但在阅读了 Rick Strahl 关于[DataContext Life Management](http://www.west-wind.com/weblog/posts/246222.aspx)的博客后，我担心这不是 Web 应用程序的线程安全解决方案。

我还通过使用单例模式访问我的对象上下文来绕过我收到此错误消息的实例。

我在 MyObjectContext 类中添加了以下内容：

```
// singleton
private static MyObjectContext context;
public static MyObjectContext getInstance()
{
    if (context == null)
    {
        context = new MyObjectContext ();
    }
    return context;
} 
```

在我的每个实体存储库映射器中，我使用的不是实例化 MyObjectContext 的新实例

```
var db = MyObjectContext.getInstance(); 
```

我在这里傻吗？它似乎工作。

# java - 如何继承带有注释的 Hibernate 过滤器？

> ID：694626
> 
> 赞同：4
> 
> 时间：2009-03-29T13:28:45.327
> 
> 标签：java, hibernate, filter, annotations

我正在尝试设置带有注释的 Hibernate 过滤器。我想在基类中指定它并让所有子类都使用它，但是每当我尝试启用它时，Hibernate 都找不到过滤器。是否有可能继承过滤器注释？

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2010-06-22T19:50:55.937

从 3.5.0 开始，@MappedSuperclass 至少是可能的。不确定这是否对您有帮助...请参阅：[HHH-4332](http://opensource.atlassian.com/projects/hibernate/browse/HHH-4332)

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2009-03-29T14:54:14.997

您是直接使用休眠过滤器，还是出于自己的目的扩展休眠过滤器？默认情况下，Java 中不会继承注解，但如果您自己编写注解，并且我假设 hibernate 没有对其注解执行此操作，您可以在注解上指定 @Inherited 元注解以使其继承. 不过，这只适用于类型级别的注释。此外，[有些人](http://www.fusionsoft-online.com/articles-java-annotations.php)编写注释管理器来模拟完全继承。你可以做类似的事情，要么扩展休眠机制，要么编写一个预处理器，在它们应该被继承的地方添加注释。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-03-29T22:15:59.443

John Ellinwood 所写的正是如此。这就是为什么`@Filter`需要在所有子类上指定的原因，至少在 Hibernate Annotations 3.4.0-GA 中是这样。

此外，尽管这可能不明显，但如果您希望这些集合也容易受到过滤，您将需要对该类的所有映射集合使用相同的注释。

# flash - Actionscript indexOf 问题

> ID：694629
> 
> 赞同：0
> 
> 时间：2009-03-29T13:34:07.013
> 
> 标签：flash, actionscript-3, carriage-return, indexof

当我在 AS3 中创建一个 TextField 并将多行设置为 true 并将文本等同于说：

“你好\r你好”

我无法使用 indexOf 函数检索 \r 的索引位置，它总是返回 -1

有谁知道我做错了什么？

```
var txt:TextField;
txt.multiline = true;

txt.text = "Hola \r hola";

//txt now renders fine with the line break

trace(txt.indexOf("\r")); //Returns -1, should return the valid index of \r in txt 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-03-29T14:34:28.867

按照 Mikko 的回答，我试了一下：

```
var textField:TextField = addChild(new TextField()) as TextField;
textField.multiline = true;

textField.text = "test \r test";

trace("result>" + textField.text.indexOf("\r")); 
```

此代码跟踪：

```
result>5 
```

...正如预期的那样。

如果它仍然不适合您，首先尝试搜索除 \r 之外的另一个字符，如果这样也尝试搜索 \n。也许换行符会以某种方式进行转换。（你在哪个操作系统上？）

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-03-29T13:41:04.143

在我看来，您正在尝试获取 TextField 的索引，而不是您感兴趣的 TextField.text 的索引。

```
trace(txt.text.indexOf("\r")); 
```

可以工作得更好一点。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2009-03-30T23:48:02.880

好的，首先，

您还没有实例化您的文本字段，您只是做了一个参考。

其次，indexOf 对 TextField 类不可用，但对 String 类可用，所以使用以下内容就不会再有问题了。它对我来说很好。

```
var txt:TextField = new TextField();
addChild(txt);
txt.multiline = true;
txt.text = "Hola \r hola";

trace(txt.text.toString().indexOf("\r")); 
```

Theo 基本上是正确的，但我想我会尝试让它更清楚一点。

希望我能提供帮助。另外我建议检查正则表达式，它可以轻松找到空白字符或您能想到的任何其他模式。

# c# - 什么任务最好以函数式编程风格完成？

> ID：694651
> 
> 赞同：29
> 
> 时间：2009-03-29T13:52:33.023
> 
> 标签：c#, f#, c#-3.0, functional-programming

我最近刚刚发现了函数式编程风格，我相信它会减少开发工作，使代码更易于阅读，使软件更易于维护。然而，问题是我无法说服任何人。

好吧，最近我有机会发表关于如何减少软件开发和维护工作的演讲，我想向他们介绍函数式编程的概念以及它如何使团队受益。我的想法是向人们展示 2 组完全相同的代码，一组以非常命令式的方式编码，另一组以非常函数式的方式编码，以表明函数式编程可以使代码更短、更易于理解和因此可维护。除了 Luca Bolognese 著名的平方和示例之外，还有这样的例子吗？

* * *

## 回答 #1

> 赞同：68
> 
> 时间：2009-03-29T15:37:15.330

> 我最近刚刚发现了函数式编程风格 [...] 好吧，最近我有机会发表关于如何减少软件开发工作量的演讲，我想介绍函数式编程的概念。

如果您只是刚刚发现函数式编程，我*不*建议您尝试就该主题进行权威性发言。我知道在我学习 F# 的前 6 个月里，我所有的代码都是 C#，语法有点笨拙。然而，在那段时间之后，我能够以惯用的函数式风格编写始终如一的优秀代码。

我建议您也这样做：等待 6 个月左右，直到函数式编程风格更加自然，然后进行演示。

> 我试图说明函数式编程的好处，我想向人们展示两组代码，它们做同样的事情，一组以非常命令的方式编码，另一组以非常函数式的方式编码，以表明函数式编程可以使代码更短，更容易理解和维护。除了 Luca Bolognese 著名的平方和示例之外，还有这样的例子吗？

我向我所在地区的 .NET 用户组做了一个 F# 演示，我组中的许多人都对 F# 的模式匹配印象深刻。具体来说，我展示了如何在 C# 和 F# 中遍历抽象语法树：

```
using System;

namespace ConsoleApplication1
{
    public interface IExprVisitor<t>
    {
        t Visit(TrueExpr expr);
        t Visit(And expr);
        t Visit(Nand expr);
        t Visit(Or expr);
        t Visit(Xor expr);
        t Visit(Not expr);

    }

    public abstract class Expr
    {
        public abstract t Accept<t>(IExprVisitor<t> visitor);
    }

    public abstract class UnaryOp : Expr
    {
        public Expr First { get; private set; }
        public UnaryOp(Expr first)
        {
            this.First = first;
        }
    }

    public abstract class BinExpr : Expr
    {
        public Expr First { get; private set; }
        public Expr Second { get; private set; }

        public BinExpr(Expr first, Expr second)
        {
            this.First = first;
            this.Second = second;
        }
    }

    public class TrueExpr : Expr
    {
        public override t Accept<t>(IExprVisitor<t> visitor)
        {
            return visitor.Visit(this);
        }
    }

    public class And : BinExpr
    {
        public And(Expr first, Expr second) : base(first, second) { }
        public override t Accept<t>(IExprVisitor<t> visitor)
        {
            return visitor.Visit(this);
        }
    }

    public class Nand : BinExpr
    {
        public Nand(Expr first, Expr second) : base(first, second) { }
        public override t Accept<t>(IExprVisitor<t> visitor)
        {
            return visitor.Visit(this);
        }
    }

    public class Or : BinExpr
    {
        public Or(Expr first, Expr second) : base(first, second) { }
        public override t Accept<t>(IExprVisitor<t> visitor)
        {
            return visitor.Visit(this);
        }
    }

    public class Xor : BinExpr
    {
        public Xor(Expr first, Expr second) : base(first, second) { }
        public override t Accept<t>(IExprVisitor<t> visitor)
        {
            return visitor.Visit(this);
        }
    }

    public class Not : UnaryOp
    {
        public Not(Expr first) : base(first) { }
        public override t Accept<t>(IExprVisitor<t> visitor)
        {
            return visitor.Visit(this);
        }
    }

    public class EvalVisitor : IExprVisitor<bool>
    {
        public bool Visit(TrueExpr expr)
        {
            return true;
        }

        public bool Visit(And expr)
        {
            return Eval(expr.First) && Eval(expr.Second);
        }

        public bool Visit(Nand expr)
        {
            return !(Eval(expr.First) && Eval(expr.Second));
        }

        public bool Visit(Or expr)
        {
            return Eval(expr.First) || Eval(expr.Second);
        }

        public bool Visit(Xor expr)
        {
            return Eval(expr.First) ^ Eval(expr.Second);
        }

        public bool Visit(Not expr)
        {
            return !Eval(expr.First);
        }

        public bool Eval(Expr expr)
        {
            return expr.Accept(this);
        }
    }

    public class PrettyPrintVisitor : IExprVisitor<string>
    {
        public string Visit(TrueExpr expr)
        {
            return "True";
        }

        public string Visit(And expr)
        {
            return string.Format("({0}) AND ({1})", expr.First.Accept(this), expr.Second.Accept(this));
        }

        public string Visit(Nand expr)
        {
            return string.Format("({0}) NAND ({1})", expr.First.Accept(this), expr.Second.Accept(this));
        }

        public string Visit(Or expr)
        {
            return string.Format("({0}) OR ({1})", expr.First.Accept(this), expr.Second.Accept(this));
        }

        public string Visit(Xor expr)
        {
            return string.Format("({0}) XOR ({1})", expr.First.Accept(this), expr.Second.Accept(this));
        }

        public string Visit(Not expr)
        {
            return string.Format("Not ({0})", expr.First.Accept(this));
        }

        public string Pretty(Expr expr)
        {
            return expr.Accept(this).Replace("(True)", "True");
        }
    }

    class Program
    {
        static void TestLogicalEquivalence(Expr first, Expr second)
        {
            var prettyPrinter = new PrettyPrintVisitor();
            var eval = new EvalVisitor();
            var evalFirst = eval.Eval(first);
            var evalSecond = eval.Eval(second);

            Console.WriteLine("Testing expressions:");
            Console.WriteLine("    First  = {0}", prettyPrinter.Pretty(first));
            Console.WriteLine("        Eval(First):  {0}", evalFirst);
            Console.WriteLine("    Second = {0}", prettyPrinter.Pretty(second));
            Console.WriteLine("        Eval(Second): {0}", evalSecond);;
            Console.WriteLine("    Equivalent? {0}", evalFirst == evalSecond);
            Console.WriteLine();
        }

        static void Main(string[] args)
        {
            var P = new TrueExpr();
            var Q = new Not(new TrueExpr());

            TestLogicalEquivalence(P, Q);

            TestLogicalEquivalence(
                new Not(P),
                new Nand(P, P));

            TestLogicalEquivalence(
                new And(P, Q),
                new Nand(new Nand(P, Q), new Nand(P, Q)));

            TestLogicalEquivalence(
                new Or(P, Q),
                new Nand(new Nand(P, P), new Nand(Q, Q)));

            TestLogicalEquivalence(
                new Xor(P, Q),
                new Nand(
                    new Nand(P, new Nand(P, Q)),
                    new Nand(Q, new Nand(P, Q)))
                );

            Console.ReadKey(true);
        }
    }
} 
```

上面的代码是用惯用的 C# 风格编写的。它使用访问者模式而不是类型测试来保证类型安全。这大约是 218 LOC。

这是 F# 版本：

```
#light
open System

type expr =
    | True
    | And of expr * expr
    | Nand of expr * expr
    | Or of expr * expr
    | Xor of expr * expr
    | Not of expr

let (^^) p q = not(p && q) && (p || q) // makeshift xor operator

let rec eval = function
    | True          -> true
    | And(e1, e2)   -> eval(e1) && eval(e2)
    | Nand(e1, e2)  -> not(eval(e1) && eval(e2))
    | Or(e1, e2)    -> eval(e1) || eval(e2)
    | Xor(e1, e2)   -> eval(e1) ^^ eval(e2)
    | Not(e1)       -> not(eval(e1))

let rec prettyPrint e =
    let rec loop = function
        | True          -> "True"
        | And(e1, e2)   -> sprintf "(%s) AND (%s)" (loop e1) (loop e2)
        | Nand(e1, e2)  -> sprintf "(%s) NAND (%s)" (loop e1) (loop e2)
        | Or(e1, e2)    -> sprintf "(%s) OR (%s)" (loop e1) (loop e2)
        | Xor(e1, e2)   -> sprintf "(%s) XOR (%s)" (loop e1) (loop e2)
        | Not(e1)       -> sprintf "NOT (%s)" (loop e1)
    (loop e).Replace("(True)", "True")

let testLogicalEquivalence e1 e2 =
    let eval1, eval2 = eval e1, eval e2
    printfn "Testing expressions:"
    printfn "    First  = %s" (prettyPrint e1)
    printfn "        eval(e1): %b" eval1
    printfn "    Second = %s" (prettyPrint e2)
    printfn "        eval(e2): %b" eval2
    printfn "    Equilalent? %b" (eval1 = eval2)
    printfn ""

let p, q = True, Not True
let tests =
    [
        p, q;

        Not(p), Nand(p, p);

        And(p, q),
            Nand(Nand(p, q), Nand(p, q));

        Or(p, q),
            Nand(Nand(p, p), Nand(q, q));

        Xor(p, q),
            Nand(
                    Nand(p, Nand(p, q)),
                    Nand(q, Nand(p, q))
                )
    ]
tests |> Seq.iter (fun (e1, e2) -> testLogicalEquivalence e1 e2)

Console.WriteLine("(press any key)")
Console.ReadKey(true) |> ignore 
```

这是 65 行。由于它使用模式匹配而不是访问者模式，因此我们不会失去任何类型安全性，并且代码非常易于阅读。

*任何*类型的符号处理都比 C# 更容易用 F# 编写。

[编辑添加：]哦，模式匹配不仅仅是访问者模式的替代品，它还允许您匹配数据的*形状*。例如，这是一个将 Nand 转换为其等价物的函数：

```
let rec simplify = function
    | Nand(p, q) when p = q -> Not(simplify p)
    | Nand(Nand(p1, q1), Nand(p2, q2))
        when equivalent [p1; p2] && equivalent [q1; q2]
                    -> And(simplify p1, simplify q1)
    | Nand(Nand(p1, p2), Nand(q1, q2))
        when equivalent [p1; p2] && equivalent [q1; q2]
                    -> Or(simplify p1, simplify q1)
    | Nand(Nand(p1, Nand(p2, q1)), Nand(q2, Nand(p3, q3)))
        when equivalent [p1; p2; p3] && equivalent [q1; q2; q3]
                    -> Xor(simplify p1, simplify q1)
    | Nand(p, q) -> Nand(simplify p, simplify q)
    | True          -> True
    | And(p, q)     -> And(simplify p, simplify q)
    | Or(p, q)      -> Or(simplify p, simplify q)
    | Xor(p, q)     -> Xor(simplify p, simplify q)
    | Not(Not p)    -> simplify p
    | Not(p)        -> Not(simplify p) 
```

在 C# 中根本不可能简洁地编写此代码。

* * *

## 回答 #2

> 赞同：14
> 
> 时间：2009-03-29T13:57:36.490

那里有很多例子，但没有一个比使用与您工作中的一个项目相关的样本更能产生影响。像 Luca 的“Sum Of Squares”这样的例子很棒，但如果有人用它来证明我们的代码库可以如何更好地编写，我不会相信。所有的例子都证明了有些东西在功能上写得更好。你需要证明的是你的代码库在功能上写得更好

我的建议是在代码库中挑选一些流行的问题点和一些核心点，并以函数式的方式重写它们。如果你能展示出一个更好的解决方案，它将大大赢得同事的青睐。

* * *

## 回答 #3

> 赞同：9
> 
> 时间：2009-03-29T21:17:48.350

功能风格的任务？任何时候你有一个共同的编码模式并想减少它。不久前，我写了一些关于将 C# 用于函数式风格的文章，同时确保它是实用的：[Practical Functional C#](http://www.atrevido.net/blog/2007/08/12/Practical+Functional+C+Part+I.aspx)（我很犹豫在这里链接到我自己的东西，但我认为它在这种情况下是相关的）。如果您有一个常见的“企业”应用程序，例如，展示表达式在模式匹配中的可爱之处就不会太令人信服。

但在现实世界的应用程序中，有大量的模式以低编码级别弹出。使用高阶函数，您可以让它们消失。正如我在那组博客文章中展示的那样，我最喜欢的示例是 WCF 的“尝试关闭/最终中止”模式。“try/finally-dispose”模式非常普遍，它变成了一个语言关键字：使用。“锁”也是一样。这些都被简单地表示为高阶函数，只是因为 C# 最初不支持它们，我们才需要硬编码的语言关键字来支持它们。（快速：切换你的“锁”块以使用 ReaderWriter 锁。糟糕，我们必须先编写一个更高阶的函数。）

但也许令人信服只需要看看微软。泛型又名参数多态性？这几乎不是 OO，而是一个很好的功能概念，现在每个人都喜欢。可爱的 Ninject 框架没有它就无法工作。拉姆达斯？作为表达式树，它们是 LINQ、Fluent NHibernate 等获得全部力量的方式。同样，这不是来自 OO 或命令式编程。新的线程库？没有闭包就很丑。

因此，在过去十年中，函数式编程一直为 .NET 之类的东西带来福音。主要的进步（例如泛型，“LINQ”）直接来自函数式语言。为什么不意识到它有一些东西并更多地参与其中呢？这就是我对怀疑论者的说法。

**更大的问题**实际上是让人们对高阶函数的理解有了飞跃。虽然这很容易，但如果您以前从未见过它，那可能会令人震惊，难以理解。（哎呀，似乎很多人认为泛型只是用于类型安全的集合，而 LINQ 只是嵌入式 SQL。）

所以，你应该做的是检查你的代码库，找到一个过于复杂的命令式噩梦的地方。搜索底层模式，并使用函数将其很好地串在一起。如果你找不到任何东西，你可能会满足于仅仅从列表中进行演示。例如“查找此列表中的所有 Foos 并删除它们”。这是功能样式“myList.Remove(x=>x.Bla > 0)”中的 1 行内容，而 C# 样式中的 7 行（创建临时列表，循环并添加删除项目，循环并删除项目）。

希望是，即使语法很奇怪，人们也会认识到“哇，这要简单得多”。如果他们能放下“冗长 == 更具可读性”和“看起来令人困惑”，那么您将有机会。

祝你好运。

* * *

## 回答 #4

> 赞同：3
> 
> 时间：2009-03-31T01:09:11.407

有史以来最好的关于函数式风格的倡导论文是 John Hughes 的一篇名为[Why Functional Programming Matters](http://www.cse.chalmers.se/~rjmh/Papers/whyfp.html)的论文。我建议你自己做一些例子，直到你达到可以令人信服地提出论文中列出的论点的阶段。

论文中的许多例子都是数字化的，并没有引起当今观众的共鸣。我给我的学生提供的另一个现代练习是使用那篇论文中的想法将大型媒体文件打包到 4.7GB DVD 上以进行备份。他们使用 Michael Mitzenmacher 的“冒泡搜索”算法来生成替代包装，并且使用该算法和 Hughes 的技术很容易让每张 DVD（除了最后一张）99.9% 满。很甜。

* * *

## 回答 #5

> 赞同：2
> 
> 时间：2009-03-30T07:10:30.970

本质上，函数范式对于并行处理非常有效：

> “在这里，我想让你注意到的真正有趣的事情是，一旦你将 map 和 reduce 视为每个人都可以使用的函数，并且他们使用它们，你只需要让一个超级天才来编写运行的硬代码map 和 reduce 在全球大规模并行计算机阵列上运行，所有旧代码在你刚刚运行循环时运行良好，现在仍然运行，只是速度快了无数倍，这意味着它可以用来在瞬间解决巨大的问题。
> 
> 让我重复一遍。通过抽象出循环的概念，你可以以任何你想要的方式实现循环，包括以一种可以通过额外的硬件很好地扩展的方式来实现它。”
> 
> [http://www.joelonsoftware.com/items/2006/08/01.html](http://www.joelonsoftware.com/items/2006/08/01.html "Joel on Software：你的编程语言能做到这一点吗？")

* * *

## 回答 #6

> 赞同：1
> 
> 时间：2009-03-29T14:13:50.710

另一个例子是快速[排序算法](http://en.wikibooks.org/wiki/Algorithm_implementation/Sorting/Quicksort)。它可以用像 Haskell 这样的函数式语言非常简单地描述：

```
qsort []     = []
qsort (x:xs) = qsort (filter (< x) xs) ++ [x] ++ qsort (filter (>= x) xs) 
```

但需要在迭代语言中进行更多编码。在引用的网站上，您还可以找到许多其他语言之间的比较示例。

* * *

## 回答 #7

> 赞同：1
> 
> 时间：2009-03-29T14:20:52.707

为了实现您想要的并将其传达给您组织中的其他人，您需要展示您公司的业务正在以更好的方式建立。

如果函数式编程对您的业务领域完全无用，那么使用几种算法来展示函数式编程的力量是没有用的。因此，获取一些现有代码并在功能上对其进行重写。如果你能证明这一点，那就更好了，人们会听你的——你已经向他们展示了一个具体的、相关的例子。如果您不能，那么函数式编程可能不是您一直在寻找的解决方案。

* * *

## 回答 #8

> 赞同：1
> 
> 时间：2009-03-29T14:47:40.177

如果“功能风格”是指使用“map”、“apply”、“reduce”、“filter”、lambda 函数和列表推导等概念，那么很明显必须处理当以“功能风格”编写时，列表几乎总是更简洁。但是，如果您在主要是命令式语言中将“功能样式”与命令式代码混合在一起，那实际上只是样式问题。

例如，在 python 中，您可以重新实现发布的 Haskell qsort crackmigg，如下所示：

```
def qsort(list):
    if list == []:
        return []
    else:
        x = list[0]; xs = list[1:]
        return qsort(filter(lambda y: y<x, xs)) + [x] + qsort(filter(lambda y: y>= x, xs)) 
```

虽然把最后一行写成

```
return qsort([y for y in xs if y<x]) + [x] + qsort([y for y in xs if y>=x]) 
```

可以说是更“pythonic”。

但这显然比这里的实现更简洁：

[http://hetland.org/coding/python/quicksort.html](http://hetland.org/coding/python/quicksort.html)

顺便说一句，在我学习 Haskell 之前，我会考虑如何实现它。

*当*且*仅当*您适应了函数`filter`式编程并且了解将要做什么就像老练的 C++ 程序员了解`for`循环一样容易，甚至无需考虑太多，函数式版本才会非常清晰。这显然是这里真正的问题所在：函数式“风格”编程是一种*完全不同的思维方式*。如果与你一起工作的人不习惯递归思考，也不是那种令人兴奋的类型，不仅仅是一种新技术，而是一种解决问题的完全不同的思维方式，那么任何数量的代码比较都是不会赢得他们的。

* * *

## 回答 #9

> 赞同：0
> 
> 时间：2009-03-29T14:54:28.833

一个很好的例子是使用现有的编程语言创建自己的编程语言，您将不得不使用[Monads](http://en.wikipedia.org/wiki/Monads_in_functional_programming)。

使用 F# 编写解析逻辑比使用 C# 简单得多。

看看这篇文章：[Functional .NET - LINQ or Language Integrated Monads？](http://weblogs.asp.net/podwysocki/archive/2008/10/13/functional-net-linq-or-language-integrated-monads.aspx)

* * *

## 回答 #10

> 赞同：0
> 
> 时间：2009-03-29T15:08:32.777

涉及回溯搜索和简化 GUI 中的撤消支持的算法是我在实践中使用函数式风格的两个地方。

* * *

## 回答 #11

> 赞同：0
> 
> 时间：2009-03-29T15:26:09.677

在函数式风格中通常最容易完成的任务的一个简单示例是将数据从一种形式转换为另一种形式。“平方和”是数据转换的一个简单示例。Luca 在去年的 PDC 上的演讲展示了如何将这种数据转换用于更实用的事情，下载和分析股票报价。该演示是在 F# 中完成的，但概念是相同的，可以应用于 C# 或大多数其他编程语言。

[http://channel9.msdn.com/pdc2008/TL11/](http://channel9.msdn.com/pdc2008/TL11/)

* * *

## 回答 #12

> 赞同：0
> 
> 时间：2009-03-29T15:37:52.083

向他们展示 jQuery 迭代 DOM 元素的方式：

```
$(".magic-divs").click(function(){
    // FYI, in this context, "this" will be the element clicked on.
    alert("somebody clicked on " + this.id);
    this.hide();

});

$(".magic-divs").show(); 
```

与“按类名的javascript元素”的大多数谷歌结果如何做到这一点：

```
var arrayOfElements = // this is filled with the elements somehow
for(var i=0,j=arrayOfElements.length; i<j; i++) {
   alert("now I get to add an onclick event somehow " + i);
}
// i dont even want to type the ugly for-loop stuff to hide every div... 
```

函数式编程在上述日常工作中很有用！

（注意：我不知道我的示例是否符合函数式编程的确切定义，但如果符合，那么函数式编程就很棒）

* * *

## 回答 #13

> 赞同：0
> 
> 时间：2009-12-21T21:41:25.290

我最近想出了一个小技巧来制作 lambda，传递给我的扩展方法看起来更像 F# ish。它是这样的：

我想做的是：

```
3.Times(() => Console.WriteLine("Doin' it")); 
```

现在扩展方法很容易实现：

```
 public static void Times(this int times, Action action)
    {
        Enumerable.Range(1, times).ToList().ForEach(index => action());
    } 
```

我不喜欢的是我在这里指定了索引：`ForEach(index => action())`虽然它从未被使用过，所以我将它替换为 a`_`并得到了`ForEach(_ => action())`

很好，但现在我有动力让我的调用代码看起来相似

（我从不喜欢 lambda 表达式开头的“（）”），所以不是：`3.Times(() => ...);`我想要`3.Times(_ => ...);` 实现这个的唯一方法是将一个假参数传递给扩展方法，它永远不会被使用，所以我修改了它像这样：

```
 public static void Times(this int times, Action<byte> action)
    {
        Enumerable.Range(1, times).ToList().ForEach(_ => action(byte.MinValue));
    } 
```

这让我可以这样称呼它：

```
3.Times(_ => Console.WriteLine("Doin' it")); 
```

没有太大的变化，但我仍然喜欢，可以如此轻松地进行这个小调整，同时消除“（）”噪音使其更具可读性。

* * *

## 回答 #14

> 赞同：0
> 
> 时间：2015-05-25T22:25:06.700

没有真正回答这个问题，但对于那些想了解 C# 函数式编程的人来说，这是一个很好的链接

[http://blogs.msdn.com/b/ericwhite/archive/2006/10/04/fp-tutorial.aspx](http://blogs.msdn.com/b/ericwhite/archive/2006/10/04/fp-tutorial.aspx)

* * *

## 回答 #15

> 赞同：-1
> 
> 时间：2009-03-29T15:13:58.380

1.  展示如何编码一个不同的数组。Distinct 在 SQL 中非常容易，但在内存数组中很难。现在很容易用 LINQ 区分一个数组。

2.  你可以向他们解释，将来会有并行 LINQ（PLINQ）。当您开始编写函数式代码时，并行化您的应用程序会更容易。Google 广泛使用 MapReduce。

3.  向他们解释 LINQ 是一种用于处理各种不同数据的查询语言。在内存、数据库、excel、Web 服务、xml 文件、JSON 文件中。它是某种通用 SQL。然而，不喜欢 SQL 的人会不太相信。

我不会过多谈论函数式编程，我会解释 LINQ 如何帮助开发人员。

* * *

## 回答 #16

> 赞同：-3
> 
> 时间：2009-03-29T16:54:15.723

有趣的是，没有人真正回答过这个问题：什么任务最好以“功能风格”完成？

程序/算法由两部分组成：逻辑控制和数据结构。我认为最好以函数式风格完成的任务是那些涉及列表或数组的任务，它们的行为类似于列表（例如 qsort）。函数式编程语言对列表有很好的支持并非巧合。

当数据结构偏离列表时，我认为函数式编程风格的使用变得有点“不自然”。

# version-control - 在 Google 代码中禁用源选项卡

> ID：694657
> 
> 赞同：14
> 
> 时间：2009-03-29T13:59:02.540
> 
> 标签：version-control, google-code

如何禁用谷歌代码中的源标签？我不希望任何随机用户查看我的代码。

在你说这不能做之前，Google Code 默认是开源的。[有人设法做到了，不知何故](http://code.google.com/p/cnprog/)。

**编辑：在您进一步否决我之前，请查看我提供的链接。不管你想说什么，都可以做到。我想知道怎么做。**

* * *

## 回答 #1

> 赞同：23
> 
> 时间：2009-03-29T14:06:30.743

> 我不希望任何随机用户查看我的代码。

你不能阻止人们下载源代码。Google 的 SVN 存储库对匿名浏览和结帐开放。例如，在您引用的项目（StackOverflow 克隆）中，请注意

```
svn checkout http://cnprog.googlecode.com/svn/trunk/ cnprog-read-only 
```

可以很好地下载源代码。

如果您不希望人们查看您的源代码，请不要使用免费的公共托管服务。在任何情况下，设置本地`svn`存储库都非常容易：以下是**[设置](http://svnbook.red-bean.com/en/1.5/svn.tour.importing.html)**本地存储库并向其添加内容的方法。

* * *

## 回答 #2

> 赞同：21
> 
> 时间：2009-03-29T14:12:33.567

在您的 GC 页面**Administer|Tabs**然后选中 Source 旁边的 hide 复选框。不过，您的代码仍可通过 SVN 获得。

* * *

## 回答 #3

> 赞同：4
> 
> 时间：2009-03-29T14:03:02.890

Google Code 的全部意义在于它是开源的。这意味着每个人都可以看到它。如果您不希望人们查看您的代码，请使用一些封闭源代码托管站点。

* * *

## 回答 #4

> 赞同：4
> 
> 时间：2009-03-29T14:10:26.910

您可以将选项卡替换为 Wiki 页面（例如，指向您的 GitHub 存储库），但您不能阻止对 Google SVN 服务器的访问。

# .net - MS Source Server - 使用 srctool 查看时，源流显然不存在

> ID：694665
> 
> 赞同：2
> 
> 时间：2009-03-29T14:07:06.497
> 
> 标签：.net, debugging, srcsrv

我一直在玩 MS 调试工具安装中的 MS 源服务器的东西。

目前，我正在通过 Subversion 索引命令运行我的代码/pdbs，该命令现在按预期运行。它为给定的 pdb 文件创建流并将其写入 pdb 文件。

但是，当我在 Visual Studio 2008 中使用该 DLL 和关联的 pdb 时，它说无法检索源代码。

如果我根据 srctool 检查 pdb 是否包含任何源文件都没有被索引，这很奇怪，因为之前的过程运行良好。

如果我检查从 svnindex.cmd 为 pdb 运行生成的流，srctool 会说所有源文件都已编入索引。

**为什么会有区别？**

我已经在文本编辑器中打开了 pdb 文件，我可以看到对我机器上源文件的原始引用（也在 srcsrv 标头名称下）以及指向我的颠覆存储库的新“注入”源服务器链接）。

**两个引用是否仍然存在于 pdb 中？我会期望一个被删除？**

无论哪种方式，Visual Studio 2008 都不会获取我的源引用，所以我对接下来要尝试什么有点迷茫。据我所知，我已经做了我应该做的一切。

有人有类似的经历吗？

非常感谢。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-03-31T22:17:33.683

我已经解决了我的问题 - 在构建期间写入 PDB 的源文件路径与作为 Subversion 源索引任务的一部分写入的路径略有不同。

这必须使 Visual Studio 中的源搜索无效，因为这两个路径不匹配。

还将我自己的简化源索引流从自定义 NAnt 任务写入我的 PDB 文件，该任务连接到我们的 SCM 系统 Vault。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-03-29T18:49:06.680

Visual Studio 的 Options\Debugging\Symbols 中有一个选项可以发出源服务器的日志。
您还需要最新版本的 srcsrv.dll，只需从那里下载最新的[WinDBG](http://www.microsoft.com/whdc/devtools/debugging/default.mspx)复制 DLL 并确保 Visual Studio 使用它。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2010-03-30T22:40:46.543

好久没来了，不好意思。它非常适合我们公司的需求。应该足以显示发生了什么。

下面的代码片段：

**Pdb文件.cs**

```
using System;
using System.Collections.Generic;
using System.IO;
using System.Text;

namespace Code.Integration.SourceIndex
{
    public class PdbFile
    {
        private FileInfo _pdbFile;

        public FileInfo Pdb
        {
            get { return _pdbFile; }
        }

        public PdbFile(FileInfo pdbFile)
        {
            if (pdbFile == null)
                throw new ArgumentNullException("pdbFile");

            if (!pdbFile.Exists)
                throw new ArgumentException(string.Format("Pdb file specified \"{0}\" does not exist.", pdbFile.FullName), "pdbFile");

            _pdbFile = pdbFile;
        }

        // Read source files
        // Write source stream
    }
} 
```

**PdbUtil.cs**

```
using System;
using System.Collections.Generic;
using System.Diagnostics;
using System.IO;
using System.Text;

namespace Code.Integration.SourceIndex
{
    public static class PdbUtil
    {
        private static readonly string SRCTOOL_PATH_1 = @"C:\Program Files\Debugging Tools for Windows\srcsrv\srctool.exe";
        private static readonly string SRCTOOL_PATH_2 = @"C:\Program Files\Debugging Tools for Windows (x86)\srcsrv\srctool.exe";
        private static readonly string PDBSTR_PATH_1 = @"C:\Program Files\Debugging Tools for Windows\srcsrv\pdbstr.exe";
        private static readonly string PDBSTR_PATH_2 = @"C:\Program Files\Debugging Tools for Windows (x86)\srcsrv\pdbstr.exe";

        private static string SRCTOOL = "";
        private static string PDBSTR = "";

        static PdbUtil()
        {
            if (File.Exists(SRCTOOL_PATH_1))
                SRCTOOL = SRCTOOL_PATH_1;
            else if (File.Exists(SRCTOOL_PATH_2))
                SRCTOOL = SRCTOOL_PATH_2;

            if (File.Exists(PDBSTR_PATH_1))
                PDBSTR = PDBSTR_PATH_1;
            else if (File.Exists(PDBSTR_PATH_2))
                PDBSTR = PDBSTR_PATH_2;
        }

        private static void EnsureToolsExist()
        {
            if (string.IsNullOrEmpty(SRCTOOL))
                throw new ApplicationException(string.Format("SRCTOOL does not exist. Is it installed?", SRCTOOL));

            if (string.IsNullOrEmpty(PDBSTR))
                throw new ApplicationException(string.Format("PDBSTR does not exist. Is it installed?", PDBSTR));
        }

        public static List<string> ReadSourceFiles(PdbFile pdb)
        {
            EnsureToolsExist();

            ProcessStartInfo info = new ProcessStartInfo(SRCTOOL);

            info.UseShellExecute = false;
            info.RedirectStandardError = true;
            info.RedirectStandardOutput = true;
            info.Arguments = string.Format("-r \"{0}\"", pdb.Pdb.FullName);

            string output;
            string errors;

            using (Process p = Process.Start(info))
            {
                output = p.StandardOutput.ReadToEnd();
                errors = p.StandardError.ReadToEnd();

                p.WaitForExit();
            }

            if (!string.IsNullOrEmpty(errors))
                throw new ApplicationException(string.Format("Error reading pdb source files \"{0}\".", errors));

            List<string> result = new List<string>();

            if (!string.IsNullOrEmpty(output))
            {
                foreach (string item in output.Split('\r', '\n'))
                {
                    string sourceFile = item.Trim();

                    if (string.IsNullOrEmpty(sourceFile))
                        continue;

                    result.Add(sourceFile);
                }
            }

            return result;
        }

        public static void WriteSourceFileStream(PdbFile pdb, FileInfo stream)
        {
            EnsureToolsExist();

            ProcessStartInfo info = new ProcessStartInfo(PDBSTR);

            info.UseShellExecute = false;
            info.RedirectStandardError = true;
            info.RedirectStandardOutput = true;
            info.Arguments = string.Format("-w -s:srcsrv -p:\"{0}\" -i:\"{1}\"", pdb.Pdb.FullName, stream.FullName);

            string output;
            string errors;

            using (Process p = Process.Start(info))
            {
                output = p.StandardOutput.ReadToEnd();
                errors = p.StandardError.ReadToEnd();

                p.WaitForExit();
            }

            if (!string.IsNullOrEmpty(errors))
                throw new ApplicationException(string.Format("Error writing to pdb \"{0}\".", errors));
        }
    }
} 
```

**源索引任务.cs**

```
using System;
using System.Collections.Generic;
using System.IO;
using System.Text;

using NAnt.Core;
using NAnt.Core.Attributes;
using NAnt.Core.Types;

using Code.Integration.SourceIndex;

namespace Code.Integration.NAnt.Tasks.SourceIndex
{
    [TaskName("codesourceindex")]
    public class SourceIndexTask : Task
    {
        private FileSet _pdbs = new FileSet();
        private string _build = "0.0.0.0";
        private string _repositoryName = "";
        private string _repositoryProjectStart = "";
        private string _user = "";
        private string _password = "";
        private string _server = "";

        #region Properties

        /// <summary>
        /// FileSet of pdbs to process.
        /// </summary>
        [BuildElement("pdbs")]
        public FileSet Pdbs
        {
            get { return _pdbs; }
            set { _pdbs = value; }
        }

        /// <summary>
        /// Build label to extract.
        /// Default is "0.0.0.0".
        /// </summary>
        [TaskAttribute("build", Required = true)]
        [StringValidator(AllowEmpty = false)]
        public string Build
        {
            get { return _build; }
            set { _build = value; }
        }

        /// <summary>
        /// Name of repository we are working on.
        /// </summary>
        [TaskAttribute("reponame", Required = true)]
        [StringValidator(AllowEmpty = false)]
        public string RepositoryName
        {
            get { return _repositoryName; }
            set { _repositoryName = value; }
        }

        /// <summary>
        /// Name of start folder within project we are working on. i.e. if the 
        /// repository was "Code 2-0" then the repository project start could be "/Code/Trunk"
        /// or "/Code/Branches/1.0.0.123/"
        /// </summary>
        [TaskAttribute("repoprojectstart", Required = true)]
        [StringValidator(AllowEmpty = false)]
        public string RepositoryProjectStart
        {
            get { return _repositoryProjectStart; }
            set { _repositoryProjectStart = value; }
        }

        /// <summary>
        /// Vault user with repository access.
        /// </summary>
        [TaskAttribute("user", Required = true)]
        [StringValidator(AllowEmpty = false)]
        public string User
        {
            get { return _user; }
            set { _user = value; }
        }

        /// <summary>
        /// Vault user password.
        /// </summary>
        [TaskAttribute("password", Required = true)]
        [StringValidator(AllowEmpty = false)]
        public string Password
        {
            get { return _password; }
            set { _password = value; }
        }

        /// <summary>
        /// Location of Vault server.
        /// </summary>
        [TaskAttribute("server", Required = true)]
        [StringValidator(AllowEmpty = false)]
        public string Server
        {
            get { return _server; }
            set { _server = value; }
        }

        #endregion

        protected override void ExecuteTask()
        {
            try
            {
                WriteFiles();
            }
            catch (Exception exception)
            {
                throw new BuildException("Source indexing could not be completed.", Location, exception);
            }
        }

        private void WriteFiles()
        {
            foreach (string fileName in Pdbs.FileNames)
            {
                Log(Level.Info, string.Format("Processing '{0}'.", fileName));

                PdbFile pdb = new PdbFile(new FileInfo(fileName));
                List<string> sourceFiles = PdbUtil.ReadSourceFiles(pdb);
                string tmpFile = Path.GetFullPath(Path.GetTempFileName());

                try
                {
                    using (StreamWriter sw = new StreamWriter(tmpFile))
                    {
                        sw.WriteLine("SRCSRV: ini ------------------------------------------------");
                        sw.WriteLine("VERSION=1");
                        sw.WriteLine("VERCTRL=VAULT");
                        sw.WriteLine("DATETIME=" + DateTime.Now.ToUniversalTime().ToString("u"));
                        sw.WriteLine("SRCSRV: variables ------------------------------------------");
                        sw.WriteLine("VAULT_USER=" + User);
                        sw.WriteLine("VAULT_PASS=" + Password);
                        sw.WriteLine("VAULT_SRV=" + Server);
                        sw.WriteLine("VAULT_EXTRACT_TARGET=%targ%%fnbksl%(%var3%)\\%var4%\\%fnfile%(%var1%)");
                        sw.WriteLine("VAULT_EXTRACT_FOLDER=%targ%%fnbksl%(%var3%)\\%var4%");
                        sw.WriteLine("VAULT_EXTRACT_CMD=\"C:\\Program Files\\SourceGear\\Vault Client\\vault.exe\" getlabel -host %vault_srv% -user %vault_user% -password %vault_pass% -repository \"%var2%\" \"$%var3%\" %var4% -nonworkingfolder \"%vault_extract_folder%\" > \"%vault_extract_target%.log\"");
                        sw.WriteLine("SRCSRVTRG=%vault_extract_target%");
                        sw.WriteLine("SRCSRVCMD=%vault_extract_cmd%");
                        sw.WriteLine("SRCSRV: source files ---------------------------------------");

                        foreach (string sourceFile in sourceFiles)
                        {
                            // Will build against something like:
                            // D:\CruiseControl.NET.Working\Solutions 2.0\Code\Code\Trunk\Working\Solution\..
                            // Don't want "Working" folder name in there either.
                            // Need to generate Vault repo path to asset:
                            // /Code/Trunk/Solution/..

                            // 1\. Pass in repo start - /Code/Trunk
                            // 2\. Redirect slashes and search for \Code\Trunk
                            // 3\. Find first index and split at index to get - \Code\Trunk\Working\Solution\..
                            // 4\. Remove "Working\"
                            // 5\. Flip slashes again to get - /Code/Trunk/Solution/..

                            // Problems:
                            // 1\. Passing in "Trunk" - would need to work that out dynamically over time

                            string repositoryPath = sourceFile;

                            int index = sourceFile.IndexOf(RepositoryProjectStart.Replace("/", @"\"));
                            if (index != -1)
                                repositoryPath = sourceFile.Substring(index);

                            repositoryPath = repositoryPath.Replace(@"Working\", "");
                            repositoryPath = repositoryPath.Replace(@"\", "/");

                            sw.Write(sourceFile);
                            sw.Write("*");
                            sw.Write(RepositoryName);
                            sw.Write("*");
                            sw.Write(repositoryPath);
                            sw.Write("*");
                            sw.Write(Build);
                            sw.WriteLine();
                        }

                        sw.WriteLine("SRCSRV: end ------------------------------------------------");
                    }

                    Log(Level.Debug, string.Format("Generated stream '{0}'.", File.ReadAllText(tmpFile)));

                    // Write the stream to the pdb file
                    PdbUtil.WriteSourceFileStream(pdb, new FileInfo(tmpFile));

                    Log(Level.Info, "Written stream to pdb.");
                }
                finally
                {
                    if (File.Exists(tmpFile))
                        File.Delete(tmpFile);
                }
            }
        }
    }
} 
```

# lisp - 什么是在列表中查找元素的 Scheme 函数？

> ID：694669
> 
> 赞同：8
> 
> 时间：2009-03-29T14:07:54.233
> 
> 标签：lisp, scheme

我有一个元素列表'（abc），我想找出其中是否（真或假）x，其中x可以是'a或'd，例如。是否有内置功能？

* * *

## 回答 #1

> 赞同：26
> 
> 时间：2009-03-29T15:18:59.587

如果您需要使用内置等效运算符之一进行比较，则可以使用[`memq`、`memv`或`member`](http://www.schemers.org/Documents/Standards/R5RS/HTML/r5rs-Z-H-9.html#%_idx_428)，具体取决于您是否要分别使用 、 或 来查找[`eq?`相等`eqv?`性`equal?`](http://www.schemers.org/Documents/Standards/R5RS/HTML/r5rs-Z-H-9.html#%_sec_6.1)。

```
> (memq 'a '(a b c))
'(a b c)
> (memq 'b '(a b c))
'(b c)
> (memq 'x '(a b c))
#f 
```

如您所见，如果这些函数找到元素，则返回从第一个匹配元素开始的子列表。这是因为如果您正在搜索可能包含布尔值的列表，您需要能够区分找到 a`#f`的情况和未找到您要查找的元素的情况。列表是一个真值（Scheme 中唯一的假值是`#f`），因此您可以在任何需要布尔值的上下文中使用 、 或 的结果，`memq`例如、、或表达式。`memv``member``if``cond``and``or`

```
> (if (memq 'a '(a b c))
     "It's there! :)"
     "It's not... :(")
"It's there! :)" 
```

三种不同的功能有什么区别？它基于它们用于比较的等价函数。`eq?`（因此`memq`）测试两个对象是否是相同的底层对象；它基本上等同于指针比较（或整数情况下的直接值比较）。因此，看起来相同的两个字符串或列表可能不是`eq?`，因为它们存储在内存中的不同位置。`equal?`（因此`member?`）对列表和字符串进行深度比较，因此基本上任何两个打印相同的项目都是`equal?`. `eqv?`几乎`eq?`除了数字之外的任何东西；对于数字，两个数字相等的数字总是`eqv?`，但它们可能不是`eq?`（这是因为 bignums 和有理数，它们可能以不同的方式存储`eq?`）

```
> (eq? 'a 'a)
#t
> (eq? 'a 'b)
#f
> (eq? (list 'a 'b 'c) (list 'a 'b 'c))
#f
> (equal? (list 'a 'b 'c) (list 'a 'b 'c))
#t
> (eqv? (+ 1/2 1/3) (+ 1/2 1/3))
#t 
```

（请注意，规范未定义函数的某些行为，因此可能因实现而异；我已经包含了应该在实现精确有理数的任何 R ^(5 RS 兼容方案中工作的示例）)

如果您需要使用与内置谓词不同的等价谓词在列表中搜索项目，那么您可能需要[`find`](http://srfi.schemers.org/srfi-1/srfi-1.html#find)或[`find-tail`](http://srfi.schemers.org/srfi-1/srfi-1.html#find-tail)来自 SRFI-1：

```
> (find-tail? (lambda (x) (> x 3)) '(1 2 3 4 5 6))
'(4 5 6) 
```

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2009-03-29T14:23:01.640

这是一种方法：

```
> (cond ((member 'a '(a b c)) '#t) (else '#f))
#t
> (cond ((member 'd '(a b c)) '#t) (else '#f))
#f 
```

member 返回从元素所在位置或#f 开始的所有内容。cond 用于将其转换为真或假。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-03-29T14:12:52.600

您正在寻找“发现”

基础知识 - 最简单的情况就是（查找条目列表），通常用作谓词：“条目是否在列表中？”。如果成功找到有问题的元素，它会返回第一个匹配的元素，而不仅仅是“t”。**（取自第二个链接。）**

[http://www.cs.cmu.edu/Groups/AI/html/cltl/clm/node145.html](http://www.cs.cmu.edu/Groups/AI/html/cltl/clm/node145.html)

-或者-

[http://www.apl.jhu.edu/~hall/Lisp-Notes/Higher-Order.html](http://www.apl.jhu.edu/~hall/Lisp-Notes/Higher-Order.html)

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2012-11-16T17:54:10.110

我不知道是否有内置函数，但您可以创建一个：

```
(define (occurrence x lst)
       (if (null? lst) 0    
            (if (equal? x (car lst))  (+ 1 (occurrence x (cdr lst)))
                                     (occurrence x (cdr lst)) 
            )
       )
) 
```

Ỳou 将获得`x`列表中出现的次数作为回报。`true`你可以用or来扩展它`false`。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2020-06-25T16:15:55.647

```
 (define (member? x list)
     (cond ((null? list) #f)
           ((equal? x (car list)) #t)
           (else   (member? x (cdr list))))) 
```

该过程返回 #t (true) 或 #f (false)

```
(member? 10 '(4 2 3)) 
```

输出是#f

# c# - P/Invoke 函数调用问题

> ID：694672
> 
> 赞同：0
> 
> 时间：2009-03-29T14:12:40.620
> 
> 标签：c#, function, struct, pinvoke

我正在开发一个需要使用 P/Invoke 与本机 C API 交互的系统。现在我（又一次）偶然发现了一个我似乎无法以任何方式解决的问题。原始函数旨在根据指定使用哪种结构的参数返回两种结构。

C 头文件定义结构和功能如下：

```
#pragma pack(1)
typedef struct {
   DWORD JobId; 
   DWORD CardNum;
   HANDLE hPrinter;
} CARDIDTYPE, FAR *LPCARDIDTYPE;
#pragma pack()

typedef struct {
   BOOL        bActive;
   BOOL        bSuccess;
} CARD_INFO_1, *PCARD_INFO_1, FAR *LPCARD_INFO_1;

typedef struct {
   DWORD       dwCopiesPrinted;
   DWORD       dwRemakeAttempts;
   SYSTEMTIME  TimeCompleted;
} CARD_INFO_2, *PCARD_INFO_2, FAR *LPCARD_INFO_2;

BOOL ICEAPI GetCardId(HDC hdc, LPCARDIDTYPE pCardId);
BOOL ICEAPI GetCardStatus(CARDIDTYPE CardId, DWORD level, LPBYTE pData, DWORD cbBuf, LPDWORD pcbNeeded ); 
```

我试图像这样实现 P/Invoke 包装器：

```
[StructLayout(LayoutKind.Sequential, Pack=1)]
public class CARDIDTYPE {
    public UInt32 JobId;
    public UInt32 CardNum;
    public IntPtr hPrinter;
}

[StructLayout(LayoutKind.Sequential)]
public class CARD_INFO_1 {
    public bool bActive;
    public bool bSuccess;
}

[StructLayout(LayoutKind.Sequential)]
public class CARD_INFO_2 {
    public UInt32 dwCopiesPrinted;
    public UInt32 dwRemakeAttempts;
    public Win32Util.SYSTEMTIME TimeCompleted;
}
[DllImport("ICE_API.DLL", CharSet = CharSet.Auto, CallingConvention = CallingConvention.Winapi, SetLastError = true)]
public static extern bool GetCardId(HandleRef hDC, [Out]CARDIDTYPE pCardId);

[DllImport("ICE_API.DLL", CharSet = CharSet.Auto, CallingConvention = CallingConvention.Winapi, SetLastError = true)]
public static extern bool GetCardStatus(CARDIDTYPE CardId, UInt32 level, [Out] byte[] pData, UInt32 cbBuf, out UInt32 pcbNeeded); 
```

调用“GetCardId”似乎工作正常。调用它后，我在 CARDIDTYPE 实例中得到了合理的数据。但是，当我调用“GetCardStatus”时，问题就开始了。应返回的结构类型由“级别”参数定义，值为 1 应导致在“pData”中返回 CARD_INFO_1 结构。

该文档包含以下 C 示例：

```
CARD_INFO_1 ci1;
DWORD cbNeeded;
ci1.bActive = TRUE;
if (GetCardStatus(*lpCardID, 1, (LPBYTE)&ci1, sizeof(ci1), &cbNeeded )) { /* success */ } 
```

我等效的 C# 实现是这样的：

```
uint needed;
byte[] byteArray = new byte[Marshal.SizeOf(typeof(CARD_INFO_1))];
if (GetCardStatus(cardId, 1, byteArray, (uint)byteArray.Length, out needed)) { /* success */ } 
```

当我执行此 C# 代码时，该方法返回 false 并且 Marshal.GetLastWin32Error() 返回 -1073741737（这对我来说没有多大意义）。我看不出这个调用为什么会失败，而且绝对不是这个错误代码。所以我怀疑我的 P/Invoke 包装器有问题。

我知道使用“byte[]”作为 pData 的类型可能不正确，但根据一些谷歌搜索，“LPBYTE”转换为“[Out] byte[]”。我想这样做的正确方法是将 pData 作为 IntPtr，并使用 Marshal.PtrToStructure(...) 创建结构。我试过这个，但结果是一样的。这是此场景的代码：

```
[DllImport(@"ICE_API.DLL", CharSet = CharSet.Auto, EntryPoint = "_GetCardStatus@28", CallingConvention = CallingConvention.Winapi, SetLastError = true)]
public static extern bool GetCardStatus(CARDIDTYPE CardId, UInt32 level, IntPtr pData, UInt32 cbBuf, out UInt32 pcbNeeded);

uint needed;
int memSize = Marshal.SizeOf(typeof(CARD_INFO_1));
IntPtr memPtr = Marshal.AllocHGlobal(memSize);
if (!GetCardStatus(cardId, 1, memPtr, (uint)memSize, out needed)) {
    int lastError = Marshal.GetLastWin32Error();
    // error code is -1073741737
}
CARD_INFO_1 info = (CARD_INFO_1)Marshal.PtrToStructure(memPtr, typeof(CARD_INFO_1));
Marshal.FreeHGlobal(memPtr); 
```

**编辑：** 我忘了提到的一件事是，如果我没有指定 EntryPoint = "_GetCardStatus@28"，由于某种原因，GetCardStatus 调用会失败并出现未知的入口点异常。我包装的任何其他功能都没有发生这种情况，所以这让我有点疑惑。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2009-03-29T14:22:42.357

`_GetCardStatus@28`给了我一个想法。除非您在 64 位 Windows 上运行，否则您的参数数量是错误的。您的 P/Invoke for`GetCardStatus`将是`_GetCardStatus@20`，因为它有 5 个 32 位参数。您的 C 声明`GetCardStatus`似乎接受了`cardId`按值而不是按引用。由于`CARDIDTYPE`是 12 个字节长，这将给出参数列表 (28) 的正确长度。此外，这将解释您收到 -1073741737 (C0000057, ) 的错误代码`STATUS_INVALID_PARAMETER`- 因为您没有传递有效`cardId`-*以及*访问冲突 -`GetCardStatus`尝试写入`pcbNeeded`，这是垃圾，因为封送拆收器甚至没有推送它！

尔格：

```
[DllImport("ICE_API.DLL", CharSet = CharSet.Auto, 
     CallingConvention = CallingConvention.Winapi, SetLastError = true)]
 public static extern bool GetCardStatus (
     IntPtr hPrinter, UInt32 cardNum, UInt32 jobId, UInt32 level, 
    [In, Out] CARD_INFO_1 data, UInt32 cbBuf, out UInt32 pcbNeeded) ;
[DllImport("ICE_API.DLL", CharSet = CharSet.Auto, 
     CallingConvention = CallingConvention.Winapi, SetLastError = true)]
 public static extern bool GetCardStatus (
     IntPtr hPrinter, UInt32 cardNum, UInt32 jobId, UInt32 level, 
    [In, Out] CARD_INFO_2 data, UInt32 cbBuf, out UInt32 pcbNeeded) ; 
```

`CARDIDTYPE`注意三个成员的相反顺序：`stdcall`从左到右（即向较低地址）推送参数，我的猜测是 a`struct`被“推送”为一个单元。

此外，如果您稍后用 关闭打印机手柄`CloseHandle`，我建议将手柄`CARDIDTYPE`放入适当的`SafeHandle`，而不是裸露的`IntPtr`，并声明`GetCardStatus`接收安全手柄。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2009-03-30T10:26:45.270

正如 Anton 所说，问题在于传递给函数的参数。我昨天没有注意到这一点，但是 CARDIDTYPE 结构在 GetCardID 函数中是通过指针传递的，在 GetCardStatus 函数中是通过值传递的。在我的调用中，我还通过指向 GetCardStatus 的指针传递了 CARDIDTYPE，强制 P/Invoke 框架通过指定在 Dependecy Walker 中找到的确切函数名称来定位正确的函数。

我通过将 CARDIDTYPE 定义为结构而不是类来解决这个问题，并通过引用 GetCardId 函数将其传递。此外，当传递给 GetCardStatus 函数时，CARDIDTYPE 被编组为 Struct。除了使用具有不同 pData 类型（CARD_INFO_1 和 CARD_INFO_2）的两个函数定义的 Antons 技术之外，现在可以正常工作。这是最终定义：

```
[StructLayout(LayoutKind.Sequential, Pack = 1)]
public struct CARDIDTYPE {
    public UInt32 JobId;
    public UInt32 CardNum;
    public IntPtr hPrinter;
}

[StructLayout(LayoutKind.Sequential)]
public class CARD_INFO_1 {
    public bool bActive;
    public bool bSuccess;
}

[StructLayout(LayoutKind.Sequential)]
public class CARD_INFO_2 {
    public UInt32 dwCopiesPrinted;
    public UInt32 dwRemakeAttempts;
    public Win32Util.SYSTEMTIME TimeCompleted;
}

[DllImport("ICE_API.DLL", CharSet = CharSet.Auto, CallingConvention = CallingConvention.Winapi, SetLastError = true)]
public static extern bool GetCardId(HandleRef hDC, ref CARDIDTYPE pCardId);

[DllImport(@"ICE_API.DLL", EntryPoint = "GetCardStatus", CallingConvention = CallingConvention.Winapi, SetLastError = true)]
public static extern bool GetCardStatus([MarshalAs(UnmanagedType.Struct)]CARDIDTYPE CardId, UInt32 level,
    [In, Out] CARD_INFO_1 pData, UInt32 cbBuf, out UInt32 pcbNeeded);

[DllImport(@"ICE_API.DLL", EntryPoint = "GetCardStatus", CallingConvention = CallingConvention.Winapi, SetLastError = true)]
public static extern bool GetCardStatus([MarshalAs(UnmanagedType.Struct)]CARDIDTYPE CardId, UInt32 level,
    [In, Out] CARD_INFO_2 pData, UInt32 cbBuf, out UInt32 pcbNeeded); 
```

感谢你们为解决这个问题所做的贡献:-)

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2009-03-29T14:16:06.337

问题是你使用 [Out] 你应该什么都不用

```
[DllImport("ICE_API.DLL", CharSet = CharSet.Auto, CallingConvention = CallingConvention.Winapi, SetLastError = true)]
public static extern bool GetCardStatus(CARDIDTYPE CardId, UInt32 level, byte[] pData, UInt32 cbBuf, out UInt32 pcbNeeded); 
```

Out/In 属性告诉 CLR Marshaller**立即**变量将被编组的方向。在 byte[] 的情况下，参数实际上什么也没做。它的子元素之一正在被移动。

不过，编组数组是一项棘手的工作，尤其是直接在签名与结构中使用时。使用 IntPtr 可能会更好，在那里分配内存并手动将数组编组出 IntPtr。

```
[DllImport("ICE_API.DLL", CharSet = CharSet.Auto, CallingConvention = CallingConvention.Winapi, SetLastError = true)]
public static extern bool GetCardStatus(CARDIDTYPE CardId, UInt32 level, IntPtr pData, UInt32 cbBuf, out UInt32 pcbNeeded);

public void Example(uint size) {
  // Get other params
  var ptr = Marshal.AllocHGlobal(size);
  GetCardStatus(cardId, level, ptr, size, out needed);
  // Marshal back the byte array here
  Marshal.FreeHGlobal(ptr);
} 
```

# .net - 从实例化的 System.Type 中获取类型参数 T？

> ID：694683
> 
> 赞同：1
> 
> 时间：2009-03-29T14:18:53.757
> 
> 标签：.net, types, type-parameter

我有某个对象的 System.Type 但需要将其作为类型参数 T 传递给另一个方法......这可能吗？还是我迷失了那里的大局？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-03-29T14:23:59.827

这是不可能的。如果您考虑一下，类型参数是在编译时解析的，而 System.Type 是在运行时通过反射解析的。

现在，虽然说这是不可能的，但使用反射是可能的。如果您使用反射创建类，则可以将 System.Type 作为参数传递，但无论您尝试做什么，都可能值得重新设计。

编辑：这里有一些重新设计的想法。

System.Type 来自哪里？您能否将其作为类型参数本身传递，以便可以通过？

如果没有，您能否制作一个适配器来处理将要使用的已知类型？也许是从 System.Type 转换为正确类型的通用调用的 switch 语句？任何事情都比反思更快。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-03-29T14:25:03.147

您要求做的事情在 .Net 中是不可能的。类型参数是 .Net（C# 和 VB）中的编译类型操作。System.Type 实例虽然是一个运行时构造。任何关于 System.Type 背后的真实类型的查询都必须在运行时进行。因此解决方案不兼容。

例如：

```
public void DoSomething<T>(T value) {
  // Do something with a value of type T
}

public Example1() {

  DoSomething(42);  // Calls DoSomething<int>
  Type t1 = typeof(int);
  DoSomething(t1);  // Calls DoSomething<Type>

  object o1 = 42;
  Type t2 = o1.GetType();
  DoSomething(???)  // No way to call DoSomething<int> here without some
                    // wild reflection because the call to DoSomething is
                    // established at compile type where t2 is established
                    // at runtime
} 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-03-29T14:22:26.557

您可以通过使用反射来做到这一点。

你不想改变你的设计（以避免反射）吗？所以你可以将你的类型作为参数传递：

```
DoSomething(yourObject.GetTaype()); 
```

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2009-03-29T14:22:52.920

考虑使用替代设计。泛型类型旨在在编译时静态解析。

尽管如此，还是可以做到的。你需要诉诸反思：

```
public class TypeReporter<T> {
    public TypeReporter() {
        Console.WriteLine("this type is: {0}", typeof(T));
    }

    // other methods
}

public class StackOverflow694683 {
    static void Main() {
        string n = "..."; // Pick a type, such as System.String.
        Type arg = Type.GetType(n);
        Type genericClass = typeof(TypeReporter<>);
        Type createdClass = genericClass.MakeGenericType(arg);

        // Result is of TypeReporter<T> type. Invoke desired methods.
        object result = Activator.CreateInstance(createdClass);
    }
} 
```

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2009-03-29T14:35:42.827

您通常做的是为这些类型的操作专门为泛型方法提供重载。例如：

```
Load<T>();
Load(Type type); 
```

# c# - 在 C# winforms 解决方案中定义和保留“设置为启动”的位置在哪里？

> ID：694685
> 
> 赞同：4
> 
> 时间：2009-03-29T14:20:15.437
> 
> 标签：c#, projects-and-solutions

我没有在 .sln 文件中看到它，这是我所期望的。

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2009-03-29T14:30:05.913

哪个项目是“启动”项目仅与调试有关，这意味着从解决方案和项目的角度来看，它是用户元数据。无论哪个项目是“启动”项目，编译后的代码都是一样的。

因此，信息作为用户设置存储在解决方案文件 (solution.sln) 随附的解决方案用户选项文件 (solution.suo) 中。[根据MSDN](http://msdn.microsoft.com/en-us/library/xhkhh4zs.aspx)的说法，.suo 文件“记录您可能与解决方案关联的所有选项，以便每次打开它时，它都包含您所做的自定义” 。

.suo 文件是一个二进制文件。如果您想以编程方式读取或更改它，则必须[`IVsPersistSolutionOpts.LoadUserOptions`](http://msdn.microsoft.com/en-us/library/microsoft.visualstudio.shell.interop.ivspersistsolutionopts.loaduseroptions.aspx)从`Microsoft.VisualStudio.Shell.Interop`命名空间中使用。

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2009-03-29T14:26:18.340

它位于[解决方案用户选项](http://msdn.microsoft.com/en-us/library/bb165909(VS.80).aspx)(.suo) 文件中，该文件在 .sln 文件旁边创建。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2011-06-23T16:35:28.170

似乎解决方案的 sln 文件中的第一项默认情况下是启动项目。因此，您可以手动编辑 sln 文件，使您的项目成为解决方案中的第一个项目。然后，用户可以通过选择要启动的不同项目来覆盖它。

# java - JSP中基于类类型的自定义渲染，没有instanceof

> ID：694698
> 
> 赞同：5
> 
> 时间：2009-03-29T14:25:48.170
> 
> 标签：java, jsp, jstl, jsp-tags

您将如何在 jsp 中正确呈现具有不同类型的对象列表？比如说，我必须以指定的顺序渲染这些不同的对象。

一种方法是使用通用类型变量或 instanceof ，但这意味着有一个大的 switch/if 语句来管理它们：

```
<c:forEach var="o" items="${bigListofObjects}"  >
    <c:choose>
        <c:when test='${o.type=="simple"}' >
        <!-- render simple -->
        </c:when>
        <c:when test='${o.type=="complex"}' >
        <!-- render complex -->
        </c:when>
        <!-- etc etc ... -->
    </c:choose>
</c:forEach> 
```

我可以为每个类添加一个 render() 方法，但这意味着将视图与其余代码混合。

如果我想稍后渲染另一种类型会怎样？我可以用自定义 jsp 标签做些什么吗？

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2009-03-29T14:35:49.067

您可以包含另一个jsp，它将为给定类型进行正确的呈现。例如：

```
<c:forEach var="o" items="${bigListofObjects}"  >
    <c:import url="render-${o.type}.jsp"/>
</c:forEach> 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-03-29T14:38:48.123

您可以为每个类创建一个具有通用方法的接口，以实现以多态方式发出您需要的 HTML/JSP。我对这个建议并没有那么疯狂，因为它以一种糟糕的方式将用户界面泄漏到模型类中。也许另一种解决方法是可以为您发出 UI 的访问者模式。

无论哪种方式，您都必须在出现新类型时添加代码。

我不愿意创建自定义标签库。您必须小心确保样式不会泄漏到其中，从而使 CSS 蒙皮成为不可能。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-03-29T14:38:08.310

您可以有一个外部 forEach 循环，该循环遍历类型列表：

```
<c:forEach var="t" items="${listOfTypes}">
    <c:forEach var="o" items="${bigListofObjects}">
        <if test='${o.type==t}'>
            <!-- render -->
        </c:if>
    </c:forEach>
</c:forEach> 
```

# ios - 带有本地时间戳的日期

> ID：694701
> 
> 赞同：-1
> 
> 时间：2009-03-29T14:27:36.963
> 
> 标签：ios, cocoa-touch, nsdate

我想用时间戳跟踪日期。我可以使用什么objective-C/cocoa 类来获取机器时间设置的本地时间戳？

例如，如果我在美国，时间戳应该是我所在的地区。如果我在欧洲，应该是在欧洲时间。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2009-03-29T19:18:07.780

看看 NSDate。例如，

```
NSDate *today = [NSDate date]; 
```

会给你当前的日期和时间。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2015-03-04T11:25:43.120

你可以使用这个。

```
 NSDateFormatter *dateFormatter = [[NSDateFormatter alloc] init];
[dateFormatter setDateStyle:NSDateFormatterMediumStyle];
[dateFormatter setTimeStyle:NSDateFormatterMediumStyle];
[dateFormatter setTimeZone:[NSTimeZone localTimeZone]];
NSString *currentTime = [dateFormatter stringFromDate:[NSDate date]]
NSLog(@"Current Date:%@",currentTime); 
```

我希望这对你有用。

# c++ - 定义静态 const 结构

> ID：694706
> 
> 赞同：12
> 
> 时间：2009-03-29T14:32:50.197
> 
> 标签：c++, c, symbian

这个问题与 Symbian OS 有关，但我认为 C/C++ 老手也可以帮助我。我正在为 Symbian OS 编译一个开源库。使用 GCCE 编译器，它编译时没有错误（经过一些修补:)）。我将编译器更改为 ARMV5，现在静态 const 结构的定义出现多个错误，例如：我有一个结构：

```
typedef struct Foos{
    int a;
    int b;
} Foos; 
```

以及 Foos 类型的 const 结构的以下定义

```
static const Foos foo = {
    .a = 1,
    .b = 2,
}; 
```

GCCE 对此没有问题，ARMV5 在“.a = 1, .b = 2”上出现“预期表达式”错误。根据我在谷歌上搜索的内容，我认为这种方法在 C 中应该是合法的，但在 C++ 中是非法的，如果是这种情况，那么在 C++ 中声明 const 结构的可能性是什么？如果不是这种情况，那么任何其他帮助将不胜感激。

提前致谢 ：）

* * *

## 回答 #1

> 赞同：16
> 
> 时间：2009-03-29T14:36:00.267

```
static const struct Foos foo = { 1, 2 }; 
```

使用 g++ 和 gcc 编译。

正如 onebyone 指出的那样，您当然可以定义一个构造函数：

```
typedef struct Foos {
    int a;
    int b;
    Foos(int a, int b) : a(a), b(b) {}
}; 
```

你会像这样初始化：

```
static const struct Foos foo(1, 2); 
```

* * *

## 回答 #2

> 赞同：5
> 
> 时间：2009-03-29T14:47:06.887

那是合法的 C99，但不是合法的 C89 或 C++。大概您将其编译为 C++，因此如果您使用编译器选项来强制执行标准合规性，那么 GCCE 也会拒绝它。

您可以`foo = {1, 2};`使用 C 或 C++ 进行操作。显然，您失去了字段名称就在那里的好处：您必须依靠正确的顺序。

C++ 中的另一个不错的选择是为您的结构定义一个构造函数，并使用`static const Foos foo(1,2);`. 但是，这确实可以防止结构成为 POD，因此您不能对其在内存中的表示做出相同的假设。

* * *

## 回答 #3

> 赞同：5
> 
> 时间：2009-03-29T20:05:48.773

请注意，某些 Symbian 版本的 DLL 不支持[可写静态数据。](http://www.symbian.com/Developer/techlib/v9.1docs/doc_source/guide/N1001E/StaticData.html)它可能不会影响您正在做的事情，因为您的示例是 const 或者您可能只支持 Symbian v8.1b 或更高版本。

我以为我会在我曾经陷入那个陷阱时指出这一点。

从上面的链接引用：

> 支持 Symbian OS 上的全局可写静态数据
> 
> Symbian OS 支持所有版本和手机的 EXE 中的全局可写静态数据。
> 
> 基于 EKA2 内核（8.1b 和更高版本）的 Symbian OS 版本支持目标硬件上 DLL 中的 WSD。基于 EKA1 内核的 8.1a 及更早版本不支持 DLL 中的全局 WSD。

* * *

## 回答 #4

> 赞同：4
> 
> 时间：2009-03-29T14:38:05.877

我认为点样式符号在 ANSI C99 中有效。ANSI C89 是无效的。几乎所有的 C 编译器都没有实现 C99。

# c# - 为什么我应该避免在 C# 中使用属性？

> ID：694711
> 
> 赞同：103
> 
> 时间：2009-03-29T14:36:23.963
> 
> 标签：c#, properties

Jeffrey Richter 在他的优秀著作 CLR Via C# 中说他不喜欢属性，并建议不要使用它们。他给了一些理由，但我真的不明白。谁能向我解释为什么我应该或不应该使用属性？在具有自动属性的 C# 3.0 中，这会改变吗？

**作为参考，我添加了 Jeffrey Richter 的观点：**

• 属性可以是只读的或只写的；字段访问始终是可读写的。如果您定义一个属性，最好同时提供 get 和 set 访问器方法。

• 属性方法可能会抛出异常；字段访问永远不会引发异常。

• 属性不能作为out 或ref 参数传递给方法。一个字段可以。例如，以下代码将无法编译：

```
using System;
public sealed class SomeType
{
   private static String Name 
   {
     get { return null; }
     set {}
   }
   static void MethodWithOutParam(out String n) { n = null; }
   public static void Main()
   {
      // For the line of code below, the C# compiler emits the following:
      // error CS0206: A property or indexer may not
      // be passed as an out or ref parameter
      MethodWithOutParam(out Name);
   }
} 
```

• 属性方法可能需要很长时间才能执行；现场访问总是立即完成。使用属性的一个常见原因是执行线程同步，这可以永远停止线程，因此，如果需要线程同步，则不应使用属性。在那种情况下，一种方法是优选的。此外，如果您的类可以远程访问（例如，您的类是从 System.MashalByRefObject 派生的），调用属性方法将非常慢，因此，方法优先于属性。在我看来，从 MarshalByRefObject 派生的类不应该使用属性。

• 如果连续多次调用，属性方法每次可能返回不同的值；一个字段每次返回相同的值。System.DateTime 类有一个只读的 Now 属性，它返回当前日期和时间。每次查询此属性时，它都会返回不同的值。这是一个错误，Microsoft 希望他们可以通过将 Now 设为方法而不是属性来修复该类。

• 属性方法可能会导致可观察到的副作用；字段访问永远不会。换句话说，类型的用户应该能够以他或她选择的任何顺序设置类型定义的各种属性，而不会注意到类型中的任何不同行为。

• 属性方法可能需要额外的内存或返回对实际上不属于对象状态的某些内容的引用，因此修改返回的对象对原始对象没有影响；查询一个字段总是返回一个对保证是原始对象状态的一部分的对象的引用。使用返回副本的属性可能会让开发人员感到非常困惑，并且此特征通常没有记录。

* * *

## 回答 #1

> 赞同：173
> 
> 时间：2009-03-29T14:39:56.293

Jeff 不喜欢属性的原因是因为它们看起来像字段 - 因此不了解差异的开发人员会将它们视为字段，假设它们执行起来很便宜等。

我个人在这一点上不同意他的观点——我发现属性使客户端代码比等效的方法调用更易于阅读。我同意开发人员需要知道属性基本上是变相的方法 - 但我认为教育开发人员这比使用方法使代码更难阅读更好。（特别是，看到在同一个语句中调用了多个 getter 和 setter 的 Java 代码，我知道等效的 C# 代码会更容易阅读。Demeter 法则在理论上很好，但有时`foo.Name.Length`真的是使用正确的东西...）

（不，自动实现的属性并没有真正改变这一切。）

这有点像反对使用扩展方法的论点——我可以理解其中的原因，但在我看来，实际好处（当谨慎使用时）超过了坏处。

* * *

## 回答 #2

> 赞同：34
> 
> 时间：2009-03-29T15:32:24.157

好吧，让我们一一讨论他的论点：

> 一个属性可以是只读的或只写的；字段访问始终是可读写的。

这是属性的胜利，因为您可以更精细地控制访问。

> 属性方法可能会抛出异常；字段访问永远不会引发异常。

虽然这在很大程度上是正确的，但您可以很好地在未初始化的对象字段上调用方法，并引发异常。

> • 属性不能作为out 或ref 参数传递给方法。一个字段可以。

公平的。

> • 属性方法可能需要很长时间才能执行；现场访问总是立即完成。

它也可能需要很少的时间。

> • 如果连续多次调用，属性方法每次可能返回不同的值；一个字段每次返回相同的值。

不对。你怎么知道字段的值没有改变（可能是另一个线程）？

> System.DateTime 类有一个只读的 Now 属性，它返回当前日期和时间。每次查询此属性时，它都会返回不同的值。这是一个错误，Microsoft 希望他们可以通过将 Now 设为方法而不是属性来修复该类。

如果是一个错误，那是一个小错误。

> • 属性方法可能会导致可观察到的副作用；字段访问永远不会。换句话说，类型的用户应该能够以他或她选择的任何顺序设置类型定义的各种属性，而不会注意到类型中的任何不同行为。

公平的。

> • 属性方法可能需要额外的内存或返回对实际上不属于对象状态的某些内容的引用，因此修改返回的对象对原始对象没有影响；查询一个字段总是返回一个对保证是原始对象状态的一部分的对象的引用。使用返回副本的属性可能会让开发人员感到非常困惑，并且此特征通常没有记录。

大多数抗议也可以说是针对 Java 的 getter 和 setter 的——而且在实践中我们已经有很长一段时间没有遇到这样的问题了。

我认为大多数问题可以通过更好的语法突出显示（即区分属性和字段）来解决，这样程序员就知道会发生什么。

* * *

## 回答 #3

> 赞同：19
> 
> 时间：2013-09-21T16:29:55.563

早在 2009 年，这个建议似乎只是对“[谁动了我的奶酪”](http://en.wikipedia.org/wiki/Who_Moved_My_Cheese%3F)品种的吐槽。今天，它几乎已经过时了。

许多答案似乎蹑手蹑脚但并没有直接解决的一个非常重要的一点是，这些所谓的属性“危险”是**框架设计的有意部分！**

是的，房产可以：

*   为 getter 和 setter 指定不同的访问修饰符。这是相对于字段的*优势。*一种常见的模式是拥有一个公共的 getter 和一个*受保护*的或*内部*的 setter，这是一种非常有用的继承技术，仅通过字段是无法实现的。

*   抛出异常。迄今为止，这仍然是最有效的验证方法之一，尤其是在使用涉及数据绑定概念的 UI 框架时。在使用字段时，要确保对象保持有效状态要困难得多。

*   需要很长时间才能执行。此处有效的比较是使用同样长的*方法*，而不是*字段*。除了一位作者的个人偏好外，没有给出“一种方法是首选的”陈述的依据。

*   在后续执行中从其 getter 返回不同的值。这几乎看起来像是一个笑话，非常接近于用字段来颂扬`ref`/参数的优点，在/调用`out`之后字段的值几乎可以保证与之前的值不同，而且出乎意料。`ref``out`

    如果我们谈论的是没有传入耦合的单线程访问的特定（实际上是学术上的）案例，那么可以[很好地理解](https://softwareengineering.stackexchange.com/q/82377/3249)，具有可见状态改变的副作用只是糟糕的属性设计，也许我的记忆是褪色，但我似乎无法回忆起任何使用`DateTime.Now`并期望每次都出现相同值的人的例子。至少没有任何情况下他们不会用假设的`DateTime.Now()`.

*   导致可观察到的副作用——这当然正是属性最初被发明为语言特性的原因。Microsoft 自己的[Property Design](http://msdn.microsoft.com/en-us/library/ms229006.aspx)指南表明 setter 顺序无关紧要，否则会暗示[时间耦合](http://iansrobinson.com/2009/04/27/temporal-and-behavioural-coupling/)。当然，你不能单独用字段实现时间耦合，但这只是因为你不能单独用字段导致任何有意义的行为发生，直到某些方法被执行。

    属性访问器实际上可以通过在采取任何操作之前强制对象进入有效状态来帮助*防止*某些类型的时间耦合 - 例如，如果一个类具有 a`StartDate`和 an `EndDate`，那么在 the`EndDate`之前设置`StartDate`也可以强制`StartDate`返回。即使在多线程或异步环境中也是如此，包括事件驱动用户界面的明显示例。

属性可以做而字段不能包括的其他事情：

*   [延迟加载](http://en.wikipedia.org/wiki/Lazy_loading)，防止初始化顺序错误的最有效方法之一。
*   [更改通知](http://msdn.microsoft.com/en-us/library/ms743695.aspx)，这几乎是[MVVM](http://en.wikipedia.org/wiki/Model_View_ViewModel)架构的全部基础。
*   [继承](http://en.wikipedia.org/wiki/Inheritance_(object-oriented_programming))，例如定义抽象类`Type`或`Name`派生类可以提供有趣但不变的关于它们自己的元数据。
*   [拦截](http://docs.castleproject.org/Default.aspx?Page=Interceptors&NS=Windsor&AspxAutoDetectCookieSupport=1)，感谢以上。
*   [索引器](http://msdn.microsoft.com/en-us/library/vstudio/6x16t2tx.aspx)，曾经使用过 COM 互操作和不可避免的大量`Item(i)`调用的每个人都会认为这是一件很棒的事情。
*   使用[PropertyDescriptor](http://msdn.microsoft.com/en-us/library/system.componentmodel.propertydescriptor.aspx)，这对于创建设计器和一般的 XAML 框架至关重要。

Richter 显然是一位多产的作者，并且对 CLR 和 C# 了解很多，但我不得不说，这似乎是他最初写这个建议的时候（我不确定它是否在他最近的修订版中——我真诚地希望不是）他只是不想放弃旧习惯并且难以接受 C# 的约定（例如，与 C++ 相比）。

我的意思是，他的“被认为有害的属性”论点基本上归结为一个陈述：*属性看起来像字段，但它们可能不像字段。*该声明的问题在于，**它不是真的**，或者充其量是高度误导。属性看起来*不像*字段——至少，它们不*应该*看起来像字段。

C# 中有两个*非常*强大的编码约定，与其他 CLR 语言共享的类似约定，如果你不遵循它们，FXCop 会尖叫你：

1.  字段应该*始终*是私有的，而*不是*公开的。
2.  字段应以 camelCase 格式声明。属性是 PascalCase。

`Foo.Bar = 42`因此，对于属性访问器还是字段访问器没有歧义。它是一个属性访问器，应该像任何其他方法一样对待——它可能很慢，它可能会抛出异常等。这就是[抽象](http://en.wikipedia.org/wiki/Abstraction)的本质——完全取决于声明类如何做出反应。类设计者应该应用最小意外的原则，但是调用者不应该假设任何关于属性的东西，除非它按照它在锡上所说的那样做。**那是故意的。**

属性的替代方法是随处可见的 getter/setter 方法。这就是 Java 方法，[从一开始就存在争议](https://weblogs.java.net/blog/rbair/archive/2007/01/properties_in_j.html)。如果那是你的包，那很好，但这不是我们在 .NET 阵营中滚动的方式。我们尝试，至少在静态类型系统的范围内，避免 Fowler 所说的[句法噪声](http://martinfowler.com/bliki/SyntacticNoise.html)。我们不想要额外的括号、额外的`get`/`set`疣或额外的方法签名——如果我们可以避免它们而不会失去任何清晰度的话。

随便说什么，但`foo.Bar.Baz = quux.Answers[42]`总是比`foo.getBar().setBaz(quux.getAnswers().getItem(42))`. 当您每天阅读数千行此内容时，它会有所作为。

[（如果您对上述段落的自然反应是说“确实很难阅读，但是如果将其分成多行会更容易”，那么很抱歉，您*完全*没有抓住重点.)]

* * *

## 回答 #4

> 赞同：18
> 
> 时间：2009-03-29T14:46:14.470

我没看过这本书，你没有引用你不明白的部分，所以我不得不猜测。

有些人不喜欢属性，因为它们可以让你的代码做出令人惊讶的事情。

如果我键入`Foo.Bar`，阅读它的人通常会认为这只是访问 Foo 类的成员字段。这是一种廉价、几乎免费的操作，而且是确定性的。我可以一遍又一遍地调用它，并且每次都得到相同的结果。

相反，对于属性，它实际上可能是一个函数调用。这可能是一个无限循环。它可能会打开一个数据库连接。每次我访问它时它可能会返回不同的值。

这与 Linus 讨厌 C++ 的原因类似。您的代码可能会让读者感到惊讶。他讨厌运算符重载：`a + b`并不一定意味着简单的加法。这可能意味着一些非常复杂的操作，就像 C# 属性一样。它可能有副作用。它可以做任何事情。

老实说，我认为这是一个软弱的论点。两种语言都充满了这样的东西。（我们是否也应该避免 C# 中的运算符重载？毕竟，在那里可以使用相同的参数）

属性允许抽象。我们可以*假装*某个东西是一个普通的场，并把它当作一个场来使用，而不必担心幕后发生了什么。

这通常被认为是一件好事，但它显然依赖于程序员编写有意义的抽象。您的属性*应该*表现得像字段。它们不应该有副作用，它们不应该执行昂贵或不安全的操作。我们希望能够将*它们*视为字段。

然而，我还有另一个理由认为它们不够完美。它们不能通过引用传递给其他函数。

字段可以作为 传递`ref`，允许被调用的函数直接访问它。函数可以作为委托传递，允许被调用的函数直接访问它。

属性...不能。

太糟糕了。

但这并不意味着属性是邪恶的或不应该使用。出于许多目的，它们很棒。

* * *

## 回答 #5

> 赞同：11
> 
> 时间：2009-03-29T14:38:29.217

我看不出有任何理由说明您一般不应该使用属性。

C# 3+ 中的自动属性只是稍微简化了语法（就像语法糖一样）。

* * *

## 回答 #6

> 赞同：9
> 
> 时间：2009-03-29T14:58:32.567

这只是一个人的看法。我已经阅读了很多 c# 书籍，但我还没有看到其他人说“不要使用属性”。

我个人认为属性是 c# 中最好的东西之一。它们允许您通过您喜欢的任何机制公开状态。您可以在第一次使用某些东西时懒惰地实例化，并且可以对设置值等进行验证。在使用和编写它们时，我只是将属性视为 setter 和 getter，这是一种更好的语法。

至于属性的注意事项，有几个。一个可能是对属性的滥用，另一个可能是微妙的。

首先，属性是方法的类型。如果您在属性中放置复杂的逻辑可能会令人惊讶，因为类的大多数用户都希望该属性相当轻量级。

例如

```
public class WorkerUsingMethod
{
   // Explicitly obvious that calculation is being done here
   public int CalculateResult()
   { 
      return ExpensiveLongRunningCalculation();
   }
}

public class WorkerUsingProperty
{
   // Not at all obvious.  Looks like it may just be returning a cached result.
   public int Result
   {
       get { return ExpensiveLongRunningCalculation(); }
   }
} 
```

我发现对这些情况使用方法有助于区分。

其次，更重要的是，如果您在调试时评估属性，它们可能会产生副作用。

假设您有这样的属性：

```
public int Result 
{ 
   get 
   { 
       m_numberQueries++; 
       return m_result; 
   } 
} 
```

现在假设您在进行太多查询时发生了异常。猜猜当您开始调试并在调试器中翻转属性时会发生什么？坏事。避免这样做！查看属性会更改程序的状态。

这些是我唯一的警告。我认为房产的好处远远大于问题。

* * *

## 回答 #7

> 赞同：6
> 
> 时间：2009-03-29T14:41:08.163

这个理由一定是在一个非常具体的背景下给出的。它通常是相反的——建议使用属性，因为它们为您提供了一定程度的抽象，使您能够在不影响其客户端的情况下更改类的行为...

* * *

## 回答 #8

> 赞同：6
> 
> 时间：2009-03-29T18:14:33.253

我不禁要挑选杰弗里·里希特（Jeffrey Richter）观点的细节：

> 一个属性可以是只读的或只写的；字段访问始终是可读写的。

错误：字段可以标记为只读，因此只有对象的构造函数可以写入它们。

> 属性方法可能会抛出异常；字段访问永远不会引发异常。

错误：类的实现可以将字段的访问修饰符从公共更改为私有。尝试在运行时读取私有字段总是会导致异常。

* * *

## 回答 #9

> 赞同：5
> 
> 时间：2009-03-29T14:50:47.797

我不同意 Jeffrey Richter 的观点，但我可以猜到他为什么不喜欢房产（我没读过他的书）。

即使，属性就像方法（实现方式），作为一个类的用户，我希望它的属性表现得“或多或少”像一个公共字段，例如：

*   属性 getter/setter 内部没有耗时的操作
*   属性 getter 没有副作用（多次调用，不会改变结果）

不幸的是，我看到的属性不是那样的。但问题不在于属性本身，而在于实现它们的人。所以它只需要一些教育。

* * *

## 回答 #10

> 赞同：5
> 
> 时间：2018-03-23T00:19:00.357

该论点假设属性不好，因为它们看起来像字段，但可以执行令人惊讶的操作。这个假设被 .NET 程序员的期望无效：

*属性看起来不像字段。字段看起来像属性。*

> • 属性方法可能会抛出异常；字段访问永远不会引发异常。

因此，字段就像是保证永远不会抛出异常的属性。

> • 属性不能作为out 或ref 参数传递给方法。一个字段可以。

所以，一个字段就像一个属性，但它有额外的能力：传递给`ref`/`out`接受方法。

> • 属性方法可能需要很长时间才能执行；现场访问总是立即完成。[...]

因此，字段就像一个快速属性。

> • 如果连续多次调用，属性方法每次可能返回不同的值；一个字段每次返回相同的值。System.DateTime 类有一个只读的 Now 属性，它返回当前日期和时间。

因此，字段就像一个属性，除非该字段设置为不同的值，否则它保证返回相同的值。

> • 属性方法可能会导致可观察到的副作用；字段访问永远不会。

同样，字段是保证不会这样做的属性。

> • 属性方法可能需要额外的内存或返回对实际上不属于对象状态的某些内容的引用，因此修改返回的对象对原始对象没有影响；查询一个字段总是返回一个对保证是原始对象状态的一部分的对象的引用。使用返回副本的属性可能会让开发人员感到非常困惑，并且此特征通常没有记录。

这可能会令人惊讶，但并不是因为它是这样做的属性。相反，几乎没有人在属性中返回可变副本，因此 0.1% 的情况令人惊讶。

* * *

## 回答 #11

> 赞同：4
> 
> 时间：2009-04-10T12:31:12.323

有一段时间我考虑不使用属性，那就是编写 .Net Compact Framework 代码。CF JIT 编译器不执行与桌面 JIT 编译器相同的优化，也不优化简单属性访问器，因此在这种情况下，添加简单属性会导致少量代码因使用公共字段而膨胀。通常这不会成为问题，但几乎总是在 Compact Framework 世界中，您会遇到严格的内存限制，因此即使是这样的微小节省也很重要。

* * *

## 回答 #12

> 赞同：4
> 
> 时间：2009-08-10T13:45:14.830

由于其他贡献者给出的原因，您不应避免使用它们，但应谨慎使用它们。

我曾经看到一个名为“客户”之类的属性，它在内部打开了对数据库的进程外调用并读取了客户列表。客户端代码有一个“for (int i to Customers.Count)”，这会导致在每次迭代时单独调用数据库并访问选定的客户。这是一个令人震惊的例子，它展示了保持属性非常轻的原则——很少超过内部字段访问。

使用属性的一个论点是它们允许您验证正在设置的值。另一个是属性的值可能是派生值，而不是单个字段，例如 TotalValue = amount * quantity。

* * *

## 回答 #13

> 赞同：3
> 
> 时间：2009-03-29T14:50:01.403

就我个人而言，我只在创建简单的 get/set 方法时使用属性。当谈到复杂的数据结构时，我会偏离它。

* * *

## 回答 #14

> 赞同：0
> 
> 时间：2013-09-13T11:40:30.930

调用方法而不是属性会大大降低调用代码的可读性。例如，在 J# 中，使用 ADO.NET 是一场噩梦，因为 Java 不支持属性和索引器（它们本质上是带有参数的属性）。结果代码非常难看，到处都是空括号方法调用。

对属性和索引器的支持是 C# 相对于 Java 的基本优势之一。

# ruby-on-rails - Ruby Gem 开发入门

> ID：694712
> 
> 赞同：3
> 
> 时间：2009-03-29T14:36:42.933
> 
> 标签：ruby-on-rails, ruby, rubygems

最近我开始使用一个叫做 blackbook 的 gem。gem 有一些我想解决的问题。我克隆了 git repo 并在本地安装了 gem，希望我能弄乱源代码。当我编辑源代码时，什么也没有发生，所以现在我想每次进行更改时都必须重建 gem。

我的问题是：我应该能够编辑 gem 的源代码并立即查看结果，还是应该将源代码用作我的 rails 应用程序的插件，然后只有在我取得重大进展时才重建 gem？

谢谢，

托尼

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-08-07T09:19:18.077

我使用这个 rake 任务来使我的 gem 在工作时保持最新。它使用存储在名为“VERSION”的根文件中的版本号

```
desc "Build and install homer gem"
task :update do
  version = File.open('VERSION') { |f| f.read }.to_s
    `gem build homer.gemspec`
    `gem install ./homer-#{version}.gem`
end 
```

在宝石规范中：

```
s.version = File.open('VERSION') { |f| f.read }.to_s 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-03-29T14:54:25.013

您可以弄乱*已安装*gem 的源代码以更改已安装的行为。但是除非你在玩路径游戏，否则即使你重建也不会影响宝石本身。

我一般做的是这样的：

*   建立一个开发区域，我可以在其中进行更改和测试（例如运行单元测试、规范等）
*   在那里完成我的大部分工作
*   当我有我喜欢的东西时，重建 gem 并尝试测试安装
*   如果这令我满意，请推动它。

此外，如果您使用 git hub，他们应该在您每次使用更新的 gemspec 推送提交时自动为您重建 gem（例如，您已经更改了版本号）。

# c# - 如何加载与主程序集捆绑在一起的嵌入式程序集？

> ID：694713
> 
> 赞同：3
> 
> 时间：2009-03-29T14:37:38.983
> 
> 标签：c#, assemblies

将一个程序集捆绑到另一个程序集的最佳做法是什么？我有一个要分发的程序集，但我有几个在其中使用的第三方程序集，我不想分发多个。

因此，我想将几​​个程序集编译到我分发的程序集中，以便它们只是内置的。

这方面的最佳做法是什么？我知道我可以将其他程序集放入我的项目中并将它们设置为“嵌入式资源”，但是您如何将它们重新取出，这意味着您如何将其放到可以实例化该嵌入式程序集中定义的类的地方？

我见过 Assembly.Load 方法，但它似乎需要一个文件路径。还有另一种加载嵌入式程序集的方法吗？你如何告诉 Load 方法程序集在哪里？

一旦加载了嵌入式程序集，它是否只是在范围内神奇地存在，我可以从中自由地实例化类吗？

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2009-03-29T14:41:41.593

有一个[Assembly.Load(byte[])](http://msdn.microsoft.com/en-us/library/h538bck7.aspx)重载，可用于从内存数组加载程序集。如果我没记错的话，这就是[LINQPad](http://www.linqpad.net/)的工作方式。这是一种方法，假设程序集是 System.Reflection.Assembly 的一个实例，包含其他程序集作为托管资源：

```
Stream embedded = assembly.GetManifestResourceStream ("asm.dll");
byte [] buffer = new byte [embedded.Length];
using (embedded) {
    int length = buffer.Length;
    int offset = 0;
    while (length > 0) {
        int read = assemblyStream.Read (buffer, offset, length);
        if (read == 0)
            break;

        length -= read;
        offset += read;
    }
}

Assembly assembly = Assembly.Load (buffer); 
```

这个问题是运行时必须固定字节数组，所以我建议将程序集写入临时文件并使用[Assembly.LoadFile](http://msdn.microsoft.com/en-us/library/system.reflection.assembly.loadfile.aspx)。

这两种方法都返回一个[System.Reflection.Assembly](http://msdn.microsoft.com/en-us/library/system.reflection.assembly.aspx)对象，您可以使用它来获取类型，然后对它们做任何您想做的事情。

* * *

## 回答 #2

> 赞同：5
> 
> 时间：2009-03-29T14:48:04.887

我会推荐[ILMerge](http://research.microsoft.com/en-us/people/mbarnett/ilmerge.aspx)实用程序，它通过修复引用而不是从资源中加载原始程序集来将所有程序集组合成一个程序集。

# linux - Linux上进程的kill -9怎么可能没有效果？

> ID：694720
> 
> 赞同：65
> 
> 时间：2009-03-29T14:39:21.990
> 
> 标签：linux, process, sysadmin, kill

我正在编写一个插件来在您访问网站时自动突出显示文本字符串。就像高亮搜索结果一样，但是是自动的，并且适用于许多单词；它可以用于过敏症患者，让文字真正脱颖而出，例如，当他们浏览美食网站时。

但我有问题。当我尝试关闭一个空的、新鲜的 FF 窗口时，它会以某种方式阻止整个过程。当我终止进程时，所有窗口都消失了，但 Firefox 进程仍然存在（父 PID 为 1，不听任何信号，有很多资源打开，仍然占用 CPU，但不会让步）。

所以两个问题：

1.  一个进程怎么可能不听kill -9（既不是用户也不是root）？

2.  除了重新启动，我能做些什么吗？

[编辑] 这是有问题的过程：

```
USER       PID %CPU %MEM    VSZ   RSS TTY      STAT START   TIME COMMAND
digulla  16688  4.3  4.2 784476 345464 pts/14  D    Mar28  75:02 /opt/firefox-3.0/firefox-bin 
```

与`ps -ef | grep firefox`

```
UID        PID  PPID  C STIME TTY          TIME CMD
digulla  16688     1  4 Mar28 pts/14   01:15:02 /opt/firefox-3.0/firefox-bin 
```

这是唯一剩下的过程。如您所见，它不是僵尸，它在奔跑！它不听kill -9，无论我是按PID还是名称杀死！如果我尝试与 连接`strace`，那么`strace`也会挂起并且无法被杀死。也没有输出。我的猜测是 FF 挂在一些内核例程中，但是哪个？

[EDIT2] 根据 sigjuice 的反馈：

```
ps axopid,comm,wchan 
```

可以向您显示进程挂起在哪个内核例程中。就我而言，有问题的插件是 Beagle Indexer (openSUSE 11.1)。禁用插件后，FF 又是一只又快又快乐的狐狸了。

* * *

## 回答 #1

> 赞同：125
> 
> 时间：2009-03-31T14:07:48.057

正如对 OP 的评论中所指出的，进程状态 ( `STAT`)`D`表示进程处于“不间断睡眠”状态。在现实世界中，这通常意味着它正在等待 I/O 并且不能/不会做任何事情 - 包括死亡 - 直到 I/O 操作完成。

处于某个状态的进程`D`通常只会在操作完成之前存在几分之一秒，然后它们会返回`R`/ `S`。根据我的经验，如果一个进程卡在`D`，它最常尝试与无法访问的 NFS 或其他远程文件系统进行通信，尝试访问发生故障的硬盘驱动器，或通过不稳定的设备驱动程序使用某些硬件。在这种情况下，恢复并允许进程终止的唯一方法是让 fs/驱动器/硬件备份并运行，以便 I/O 可以完成，或者放弃并重新启动系统。在 NFS 的特定情况下，挂载也可能最终超时并从 I/O 操作返回（带有失败代码），但这取决于挂载选项，并且 NFS 挂载设置为永远等待是很常见的.

这与僵尸进程不同，僵尸进程的状态为`Z`.

* * *

## 回答 #2

> 赞同：8
> 
> 时间：2009-03-29T14:44:37.577

仔细检查 parent-id 是否真的是 1。如果不是，这是`firefox`，首先尝试`sudo killall -9 firefox-bin`。之后，尝试使用 . 单独杀死特定的进程 ID `sudo killall -9 [process-id]`。

> 一个进程怎么可能不听kill -9（既不是用户也不是root）？

如果一个进程已经走了`<defunct>`，然后变成了一个父级为 1 的[**僵尸**](http://en.wikipedia.org/wiki/Zombie_process)，你不能手动杀死它；只能`init`。僵尸进程已经死亡并消失了——它们已经失去了被杀死的能力，因为它们不再是进程，只有一个进程表条目及其相关的退出代码，等待收集。你需要杀死父母，你不能`init`因为明显的原因而杀死。

但请参阅[**此处**](http://www.faqs.org/faqs/unix-faq/faq/part3/section-13.html)了解更多一般信息。重启自然会杀死一切。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2009-03-29T15:12:27.497

是否有可能在您杀死它时重新启动该进程（例如通过init）？

您可以轻松地检查这一点。如果之后 PID 相同，`kill -9 PID`则不会终止该进程，但如果它已更改，则该进程已重新启动。

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2017-11-14T23:15:11.333

我最近陷入了[Double Fork](https://stackoverflow.com/questions/881388/what-is-the-reason-for-performing-a-double-fork-when-creating-a-daemon)的陷阱，并在终于找到答案之前登陆了这个页面。即使问题不同，症状也是相同的：

*   WYKINWYT : 你杀的不是你想的

下面显示了基于 SNMP 守护程序的示例的最小测试代码

```
#include <unistd.h>
#include <stdio.h>
#include <stdlib.h>
#include <signal.h>

int main(int argc, char* argv[])
{
    //We omit the -f option (do not Fork) to reproduce the problem
    char * options[]={"/usr/local/sbin/snmpd",/*"-f","*/-d","--master=agentx", "-Dagentx","--agentXSocket=tcp:localhost:1706",  "udp:10161", (char*) NULL};

    pid_t pid = fork();
    if ( 0 > pid ) return -1;

    switch(pid)
    {
        case 0: 
        {   //Child launches SNMP daemon
            execv(options[0],options);
            exit(-2);
            break;
        }
        default: 
        {
            sleep(10); //Simulate "long" activity

            kill(pid,SIGTERM);//kill what should be child, 
                              //i.e the SNMP daemon I assume
            printf("Signal sent to %d\n",pid);

            sleep(10); //Simulate "long" operation before closing
            waitpid(pid);
            printf("SNMP should be now down\n");

            getchar();//Blocking (for observation only)
            break;
        }
    }
    printf("Bye!\n");
} 
```

在第一阶段，主进程 (7699) 启动 SNMP 守护进程 (7700)，但我们可以看到这个进程现在是*Defunct/Zombie*。在旁边，我们可以看到另一个带有我们指定选项的进程（7702）

```
[nils@localhost ~]$ ps -ef | tail
root       7439      2  0 23:00 ?        00:00:00 [kworker/1:0]
root       7494      2  0 23:03 ?        00:00:00 [kworker/0:1]
root       7544      2  0 23:08 ?        00:00:00 [kworker/0:2]
root       7605      2  0 23:10 ?        00:00:00 [kworker/1:2]
root       7698    729  0 23:11 ?        00:00:00 sleep 60
nils       7699   2832  0 23:11 pts/0    00:00:00 ./main
nils       7700   7699  0 23:11 pts/0    00:00:00 [snmpd] <defunct>
nils       7702      1  0 23:11 ?        00:00:00 /usr/local/sbin/snmpd -Lo -d --master=agentx -Dagentx --agentXSocket=tcp:localhost:1706 udp:10161
nils       7727   3706  0 23:11 pts/1    00:00:00 ps -ef
nils       7728   3706  0 23:11 pts/1    00:00:00 tail 
```

在模拟 10 秒后，我们将尝试杀死我们知道的唯一进程（7700）。我们最终通过*waitpid()*取得了成功。但是进程 7702 仍然在这里

```
[nils@localhost ~]$ ps -ef | tail
root       7431      2  0 23:00 ?        00:00:00 [kworker/u256:1]
root       7439      2  0 23:00 ?        00:00:00 [kworker/1:0]
root       7494      2  0 23:03 ?        00:00:00 [kworker/0:1]
root       7544      2  0 23:08 ?        00:00:00 [kworker/0:2]
root       7605      2  0 23:10 ?        00:00:00 [kworker/1:2]
root       7698    729  0 23:11 ?        00:00:00 sleep 60
nils       7699   2832  0 23:11 pts/0    00:00:00 ./main
nils       7702      1  0 23:11 ?        00:00:00 /usr/local/sbin/snmpd -Lo -d --master=agentx -Dagentx --agentXSocket=tcp:localhost:1706 udp:10161
nils       7751   3706  0 23:12 pts/1    00:00:00 ps -ef
nils       7752   3706  0 23:12 pts/1    00:00:00 tail 
```

在给 getchar() 函数一个字符后，我们的主进程终止，但 pid 为 7002 的 SNMP 守护进程仍然存在

```
[nils@localhost ~]$ ps -ef | tail
postfix    7399   1511  0 22:58 ?        00:00:00 pickup -l -t unix -u
root       7431      2  0 23:00 ?        00:00:00 [kworker/u256:1]
root       7439      2  0 23:00 ?        00:00:00 [kworker/1:0]
root       7494      2  0 23:03 ?        00:00:00 [kworker/0:1]
root       7544      2  0 23:08 ?        00:00:00 [kworker/0:2]
root       7605      2  0 23:10 ?        00:00:00 [kworker/1:2]
root       7698    729  0 23:11 ?        00:00:00 sleep 60
nils       7702      1  0 23:11 ?        00:00:00 /usr/local/sbin/snmpd -Lo -d --master=agentx -Dagentx --agentXSocket=tcp:localhost:1706 udp:10161
nils       7765   3706  0 23:12 pts/1    00:00:00 ps -ef
nils       7766   3706  0 23:12 pts/1    00:00:00 tail 
```

*结论*

**我们忽略了双叉**机制的事实让我们认为kill动作没有成功。但实际上我们只是杀死了错误的进程！！

通过添加**-f**选项（ Do Not (Double) Fork ）一切都按预期进行

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2009-03-29T14:42:39.877

```
sudo killall -9 firefox 
```

应该管用

编辑：[PID] 更改为 firefox

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2009-03-29T14:44:02.323

ps -ef | grep 火狐；你可以看到 3 个进程，将它们全部杀死。

* * *

## 回答 #7

> 赞同：0
> 
> 时间：2009-03-29T15:09:47.597

您也可以执行 pstree 并杀死父级。这可以确保您获得整个有问题的进程树，而不仅仅是叶子。

# c# - 为什么“设置为启动”选项存储在 suo 文件而不是 sln 文件中？

> ID：694730
> 
> 赞同：187
> 
> 时间：2009-03-29T14:45:51.100
> 
> 标签：c#, visual-studio

似乎此设置应存储在解决方案文件中，以便在所有用户和部分源代码控制中共享。由于我们不签入 suo 文件，每个用户都必须单独设置，这看起来很奇怪。

* * *

## 回答 #1

> 赞同：402
> 
> 时间：2009-11-27T12:01:42.703

正如[Jon 已经说过](https://stackoverflow.com/a/694742)的，每个人都可以自己定义他们的 StartUp Project 是绝对必要的。但是有一个专用的默认设置会很棒，而且我可以告诉你，这是可能的！

**如果解决方案目录中没有 .suo 文件，Visual Studio 会选择 .sln 文件中的第一个项目作为默认启动项目。**

1.  关闭 Visual Studio 并在您喜欢的文本编辑器中打开 .sln 文件。从第 4 行开始，您会看到所有项目都封装在`Project`–`EndProject`行中。

2.  将所需的默认启动项目剪切并粘贴到顶部位置。

3.  删除您的 .suo 文件。

4.  在 Visual Studio 中打开您的解决方案。达达！

* * *

## 回答 #2

> 赞同：51
> 
> 时间：2009-11-27T11:42:37.870

在大多数情况下，对此设置默认值*确实*有意义。

容纳默认启动项目并将其存储在 .sln 文件中会更好，但开发人员可以在他们的 .suo 文件中覆盖它。如果在 .suo 文件中找不到启动设置，则将使用 .sln 中的默认启动项目。

实际上，这已[在 Visual Studio 的 UserVoice 上提出](http://visualstudio.uservoice.com/forums/121579-visual-studio/suggestions/2225956-save-default-project-s-in-the-sln-file)。

* * *

## 回答 #3

> 赞同：43
> 
> 时间：2009-03-29T14:49:18.207

为什么它应该是非用户特定的偏好？

如果我有一个包含 10 个文件的解决方案，并且一位开发人员主要测试/使用其中一种工具，那为什么会影响我的启动？

我认为 MS 在这一点上做出了正确的选择。*我*想开始的项目远非*其他*开发者想开始的项目。

* * *

## 回答 #4

> 赞同：3
> 
> 时间：2014-10-04T10:35:29.247

我为 Windows 编写了一个小命令行实用程序，用于[`slnStartupProject`](https://github.com/michaKFromParis/slnStartupProject)自动设置启动项目：

```
slnStartupProject slnFilename projectName 
```

[在使用cmake](http://cmake.org/)生成解决方案后，我个人使用它来设置启动项目，该解决方案始终将虚拟`ALL_BUILD`项目设置为解决方案中的第一个项目。

[源代码](https://github.com/michaKFromParis/slnStartupProject)在GitHub 上。欢迎分叉和反馈。

* * *

## 回答 #5

> 赞同：2
> 
> 时间：2015-08-22T18:34:51.343

如果您使用的是 GIT，您可以提交默认的 SUO 文件，然后使用

```
git update-index --assume-unchanged YourSolution.suo 
```

如果您想在默认启动组中拥有多个项目，它也可以使用。我知道的唯一缺点是该命令必须由不想提交 SUO 文件的每个人运行。

# unit-testing - 单元测试数据存储

> ID：694731
> 
> 赞同：6
> 
> 时间：2009-03-29T14:45:58.230
> 
> 标签：unit-testing

假设我有一个带有方法“storeData（key，data）”和“getData（key）”的接口。我应该如何测试一个具体的实现？我应该检查数据是否正确设置在存储介质（例如sql数据库）中，还是应该只检查它是否使用getData返回正确的数据？

如果我在数据库中查找数据，感觉就像我也在测试该方法的内部结构，但只检查它是否返回相同的数据感觉不完整。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-03-29T15:05:53.410

你似乎陷入了单元测试的炒作中，你要做的实际上是一个集成测试。从同一个键设置和取回相同的值是一个单元测试，你可以用存储引擎的模拟实现来做，但实际上测试真正的存储，比如你的数据库，就像你应该的那样，这不再是单元测试，但它是测试的基本部分，对我来说听起来像是集成测试。不要使用单元测试作为你的**锤子**，为正确的工作选择正确的工具。将您的测试划分为更多层。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2009-03-29T16:28:33.320

您想要在单元测试中做的是确保该方法完成它应该做的工作。如果该方法使用依赖项来完成它的工作，您将模拟这些依赖项并确保您的方法使用适当的参数调用它所依赖的对象上的方法。这样你就可以单独测试你的代码了。

这样做的好处之一是它将推动您的代码设计朝着更好的方向发展。例如，为了使用模拟，您自然会倾向于使用依赖注入来实现更多解耦代码。这使您能够轻松地将模拟对象替换为您的类所依赖的实际对象。您还最终实现了更自然地模拟的接口。这两件事都是很好的设计模式，会改进你的代码。

例如，为了测试您的特定示例，您可能让您的类依赖于工厂来创建与数据库的连接，并依赖构建器来构造通过连接执行的参数化 SQL 命令。您需要将这些对象的这些模拟版本传递给您的类，并确保调用了正确的方法来设置连接和命令、构建正确的命令、执行它以及断开连接。或者，您注入一个已经打开的连接并简单地构建命令并调用它。关键是您的类是针对一个接口或一组接口构建的，并且您使用模拟来提供实现这些接口的对象，并且可以记录调用并向您希望从接口使用的方法提供正确的返回值。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2009-03-29T15:04:59.167

在这种情况下，我通常会创建在单元测试之前/之后触发的 SetUp 和 TearDown 方法。这些方法将在数据库中设置我需要的任何测试数据，并在我完成后删除任何测试数据。伪代码示例：

```
Const KEY1 = "somekey"
Const VALUE1= "somevalue"

Const KEY2 = "somekey2"
Const VALUE2= "somevalue2"

Sub SetUpUnitTests()
{
   Insert Into SQLTable(KEY1,VALUE1)
}

//this test is not dependent on the setData Method
Sub GetDataTest()
{
   Assert.IsEqual(getData(KEY1),VALUE1)
}

//this test is not dependent on getData Method
Sub SetDataTest()
{
   storeData(newKey,NewData)
   Assert.IsNotNull(Direct Call to SQL [Select data from table where key=KEY2]) 

}

Sub TearDownUnitTests()
{
   Delete From table Where key in (KEY1, KEY2)
} 
```

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2009-03-29T14:57:23.727

我认为这取决于以后数据会发生什么——如果你只打算使用`storeData`and访问数据`getData`，为什么不一起测试这些方法呢？我想有可能会出现一个错误，并且要弄清楚它是否在`storeData`or中会稍微困难一些`getData`，但是如果它出现，我认为这是一个可以接受的风险

1.  使您的测试更易于实施，并且
2.  正如你所说，隐藏内部结构

如果将使用其他机制从数据库中读取或插入数据，那么我会按照您的建议使用 SQL 检查数据库。

不过，@brendan 提出了一个很好的观点 - 无论您决定采用哪种方法，您都将在数据库中插入数据。最好在测试前后清除数据，以确保获得一致的结果。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2009-03-29T15:06:43.860

同时测试两者是一种常见的技术（至少，根据我的经验），我不会回避它。我已经使用相同的模式进行序列化/反序列化以及解析和打印。

如果您不想访问数据库，则可以使用数据库模拟。有些人在使用模拟时和你有同样的感受——它部分是特定于实现的。与所有事情一样，这是一个权衡：考虑模拟的好处（更快，不依赖于数据库）与其缺点（不会检测到实际的数据库问题，更慢）。

# c++ - 使用 Win32 执行命令提示符的功能

> ID：694733
> 
> 赞同：1
> 
> 时间：2009-03-29T14:46:39.163
> 
> 标签：c++, c, winapi

哪些 Windows API 函数可用于执行命令提示符的功能？例如，我喜欢执行 dir 命令并希望在 GUI 中显示输出，而不是在 Windows 中使用 cmd.exe。

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2009-03-29T14:52:32.957

您可以`cmd /c dir S:\ome\Path`从您的流程开始并获取输出。否则是不可能的。但是，如果您对特定的格式细节不感兴趣，`dir`那么您最好枚举文件/目录并显示它们。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-03-29T14:51:05.020

dir 命令内置在 cmd.exe 中，它不是一个单独的可执行文件。除了运行 cmd.exe 之外，没有办法执行它。

编辑：至于结果的显示，您需要填写 STARTUPINFO.hStdXXX 成员，可能使用匿名管道。请参阅[此示例](http://edn.embarcadero.com/article/10387)。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-03-29T14:52:42.770

对于控制台应用程序，您可以使用**popen()**，但从 GUI 应用程序来说事情绝不是那么容易。有关一种方法，请参见[http://msdn.microsoft.com/en-us/library/ms682499%28VS.85%29.aspx](http://msdn.microsoft.com/en-us/library/ms682499%28VS.85%29.aspx)。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2009-03-29T18:39:15.330

如果您想要给定文件夹中的文件列表，请参阅此[问题](https://stackoverflow.com/questions/612097/how-can-i-get-a-list-of-files-in-a-directory-using-c-or-c)，该问题描述了如何使用 windows api 或更通用的 boost 方法来实现它。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2009-03-29T18:45:35.800

Windows 命令行所做的一切都是通过 Win32 API 完成的。

例如，关于“dir”，FindFirstFile() 和 FindNextFile() 将为您提供目录的内容。

对于任何给定的命令，您都需要弄清楚正在使用哪些 API/函数调用，然后自己学习如何在自己的代码中使用它们。

# c++ - 如何在 Windows 上使用 eclipse/gdb 调试共享库？

> ID：694744
> 
> 赞同：0
> 
> 时间：2009-03-29T14:50:02.730
> 
> 标签：c++, windows, eclipse, debugging, shared-libraries

在我的大学，我们目前正在使用开源工具在 Windows 上开发 VST 插件。

我的教授非常喜欢 Microsoft Visual Studio，对 Eclipse、GCC、Subclipse 等开源工具持怀疑态度。
然而，直到现在我都能解决他所有的问题，如果他不能被说服，那就太可惜了这个开源工具链与他的 MSVC 环境同样强大。

VST-Plugin 是一个用于音频处理的共享库。我们使用 Tobybear Minihost 作为我们的测试应用程序，它工作得很好。但是，我们无法调试它。我们可以设置断点，但是当 Minihost 打开插件时 Eclipse 无法识别它们。

你知道如何在 Windows 上使用 GDB/Eclipse 调试共享库吗？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-03-29T16:48:18.483

这些似乎是 Windows 上 GDB 的错误/限制

[http://synthedit.audioholik.com/index.php?name=Content&pid=8](http://synthedit.audioholik.com/index.php?name=Content&pid=8) [http://dev.eclipse.org/newslists/news.eclipse.tools.cdt/msg17618.html](http://dev.eclipse.org/newslists/news.eclipse.tools.cdt/msg17618.html)

解决方法是在代码中强制设置断点。

# html - 在 IE7 中显示侧选项卡导航的问题

> ID：694745
> 
> 赞同：1
> 
> 时间：2009-03-29T14:50:06.643
> 
> 标签：html, css, internet-explorer-7

我正在尝试使用 html/css 构建“选项卡式”侧导航菜单。

我将采用最方便的方法，即使用具有单行和两个单元格（列）的表格。左侧单元格用于“选项卡”，右侧单元格用于要显示的内容。包含选项卡的左侧单元格的右边框设置为选项卡和内容之间的分隔线。

每个“Tab”都是该单元格中的一个 div 标签。然后我想消除所选“选项卡”的右边框。为了实现这一点，我将选定的“Tab”div 设置为 -1px 的边距。这个想法是这将基本上抵消该 div 以覆盖在基础表格单元格中设置的右边框。这种机制在 Firefox 和 Safari 中运行良好，但在 IE7 中不起作用。任何人都知道如何让这个 Tor 在 IE7 中工作？

注意...我还没有在 IE8 中检查过这个。

这是html...

```
<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
    <title>Side Tabs</title>
    <style type="text/css">
        #sidemenu
        {
            background-color: #DDFFCC;
            border-right: 1px solid #BDDCAD;
            width: 199px;
            vertical-align: top;
            text-align: center;
        }
        #sidemenu div
        {
            padding: 8px 0px 8px 8px;
            border-bottom: 1px solid #BDDCAD;
            font-weight: bold;
            font-size: 12pt;
        }
        #sidemenuselected
        {
            padding: 8px 0px 8px 8px;
            border-bottom: 1px solid #BDDCAD;
            font-weight: bold;
            font-size: 12pt;
            background-color: #ffffff;
            margin-right: -1px;
        }
    </style>
</head>
<body>
    <center>
        <div style="background-color: #ECF1ED; padding: 16px; width: 600px;">
            <table cellpadding="0" cellspacing="0" style="width: 100%; table-layout: fixed;">
                <tr>
                    <td id="sidemenu">
                        <div style="height: 40px">
                        </div>
                        <div>
                            Product Specifications</div>
                        <div id="sidemenuselected">
                            How It Works</div>
                        <div>
                            Maintenance</div>
                    </td>
                    <td>
                        <div style="padding: 16px; background-color: #FFFFFF; text-align: left;">
                            Lorem ipsum dolor sit amet, consectetur adipisicing elit, sed do eiusmod tempor
                            incididunt ut labore et dolore magna aliqua. Ut enim ad minim veniam, quis nostrud
                            exercitation ullamco laboris nisi ut aliquip ex ea commodo consequat. Duis aute
                            irure dolor in reprehenderit in voluptate velit esse cillum dolore eu fugiat nulla
                            pariatur. Excepteur sint occaecat cupidatat non proident, sunt in culpa qui officia
                            deserunt mollit anim id est laborum. Sed ut perspiciatis unde omnis iste natus error
                            sit voluptatem accusantium doloremque laudantium, totam rem aperiam, eaque ipsa
                            quae ab illo inventore veritatis et quasi architecto beatae vitae dicta sunt explicabo.
                        </div>
                    </td>
                </tr>
            </table>
        </div>
    </center>
</body>
</html> 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-03-29T14:54:36.993

尝试一种风格

```
position: relative; left: 1px 
```

在 div#sidemenu 上已选中

# asp.net - 在 ASP.NET 中发现自动调整大小的 GridView 行的行高

> ID：694751
> 
> 赞同：0
> 
> 时间：2009-03-29T14:53:56.260
> 
> 标签：asp.net, gridview, row-height

我有许多 GridView 控件需要并排放置在页面上。例如，一个 GridView 包含购物篮中的项目列表，以及旁边的一些 GridView，显示来自多个供应商的定价。

在第一个 GridView 中，列的宽度是固定的——这意味着行高会根据文本的数量而变化。

所以，问题是 - 有没有办法发现第一个数据绑定 GridView 的各个行高，以便我可以更改其他 GridView 以正确对齐？

数据绑定后网格的 Row.Height 属性为空，因为高度尚未明确设置。

谢谢！

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-03-30T01:31:38.710

我不知道在.Net中有什么方法可以做到这一点，你可以使用javascript，如果你需要在后面的代码中设置一个.Net隐藏字段，也许可以在加载时设置它：

```
var h = document.getElementsByTagName('td')[0].offsetHeight; 
```

请记住，此高度还将包括您设置的任何单元格填充或间距。此外，这假设您没有在 CSS 中明确设置高度，根据您的问题，我认为您不是。

# javascript - Firefox、wmode 和 fscommand

> ID：694759
> 
> 赞同：0
> 
> 时间：2009-03-29T14:59:32.580
> 
> 标签：javascript, flash, firefox

我正在使用 SWFObject 在我的网站上嵌入 Flash。

```
var so = new SWFObject("file.swf", "file", "100%", "100%", "8", "#FFFFFF");
so.addParam("wmode", "opaque");
so.addParam("allowscriptaccess", "always");
so.write(container); 
```

据我所知，这在所有浏览器中都像一个魅力，但我也在使用来自 flash 的 fscommand，因此我有一个功能：

```
function file_DoFSCommand(command, args) {
    alert("It works!");
} 
```

这也适用于我测试的所有浏览器，除了 Windows 上的 Firefox，其中 file_DoFSCommand 没有被调用（但会显示 flash）。Firefox mac 和其他浏览器显示“It works！” 正如预期的那样。很奇怪。如果我删除“wmode”、“opaque”，它会突然起作用，但是我的 css 菜单会低于 Flash，所以这不是一个选项。wmode = transparent 似乎没有任何改变。

设置 so.addParam("allowscriptaccess", "never"); 设置 wmode 时，使其他浏览器在 Windows 上的行为类似于 FF。

有什么建议为什么 FF 不起作用？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-03-29T17:51:53.197

@Theo.T，感谢您的提示。虽然它并没有解决我的问题，但是搜索如何使用 ExternalInterface 导致我进入一个页面，说当容器被隐藏时 IE 不会收到来自 flash 的调用。我的容器没有隐藏，但高度设置为 0：

```
<div id="flashcontainer" style="height:0"> 
```

将高度设置为 1px 解决了问题，Firefox 现在成功接收到来自 Flash 的调用

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-03-29T15:18:59.883

首先，尝试使用 ExternalInterface 而不是 FSCommand （以某种方式折旧）。SO中已经有很多例子了。

# entity-framework - 我可以从我的实体中抽象出实体框架吗？

> ID：694761
> 
> 赞同：9
> 
> 时间：2009-03-29T15:03:55.877
> 
> 标签：entity-framework, interface

我`Foo`在实体框架中有一个实体。但是我让它继承自，`IFoo`以便我的业务逻辑只知道`IFoo`- 从而抽象出实体框架。

问题是有一个实体`Foo`集合。`Bar`而这个集合是 type `EntityCollection<Bar>`。

`IFoo`如果我按原样放入这个集合，我会`IFoo`依赖实体框架。所以我想把它作为`ICollection<IBar>`，但这不会编译（自然）。

我能想到的唯一解决方案是转到`Foo`实体框架设计器生成的具体实现并将集合从`EntityCollection<Bar>`那里更改`ICollection<IBar>`。但我害怕想到这将对“幕后”的实体框架产生影响。

我有什么方法可以定义实体框架`IFoo`并`IBar`独立于实体框架，同时仍然维护`Foo`并`Bar`作为实现它们的 EF 实体？如果我不能实现我所追求的这种独立性，是否有意义`IFoo`？`IBar`

* * *

## 回答 #1

> 赞同：8
> 
> 时间：2009-03-29T18:16:42.560

您所指的一般概念是“持久性无知”（PI），尽管这通常直接适用于实体本身，而不是使用实体的代码。

无论如何，Hibernate 和 NHibernate 本身就支持 PI，但微软实体框架的初始版本不支持。微软为此受到了很多抨击，而 PI 可能是下一版本（无论何时）讨论最多的#1 功能。

就您尝试对接口执行的操作而言，Bars 的集合是否需要在检索后进行修改？如果答案是肯定的，那么没有简单的答案。甚至协方差在这里也帮不了你，因为`ICollection<T>`它有一个 Add 方法。

如果集合是只读的，那么您可以考虑将其公开为`IEnumerable<IBar>`. 该`Enumerable.Cast`方法使这相当方便。

```
interface IFoo
{
    IEnumerable<IBar> Bars { get; }
}

partial class Foo : IFoo
{
    IEnumerable<IBar> IFoo.Bars
    {
        get { return Bars.Cast<IBar>(); }
    }
} 
```

此外，我知道[至少有一项努力](http://blogs.msdn.com/jkowalski/archive/2008/09/09/persistence-ignorance-poco-adapter-for-entity-framework-v1.aspx)使*当前*版本的 EF 支持持久性无知。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2009-03-29T15:40:59.377

我是一名 Java 开发人员，所以我不能以任何权威评论实体框架。我可以告诉你，像 Hibernate 这样的 ORM 解决方案使 POJO 持久化成为可能，而无需求助于常见的抽象类、接口或修改字节码。它可以处理您为 Foo 和 Bar 引用的 1:m 等关系，而无需使用特殊的集合类。

特殊的酱汁被外化为映射配置和 Hibernate 本身。

我读到的关于实体框架的一点点表明它是一个具有相同目标的 ORM 解决方案：POCO 持久性。我没有看到任何关于接口的提及。从您的示例中我看不出对它们的需求，因为它太抽象了。

我推断可以在业务对象和持久层之间获得独立性，而不必求助于这些接口，因为我知道 Hibernate 可以做到这一点。我想说 Spring 的 JDBC 解决方案也能做到这一点，因为不需要通用接口。他们使用 RowMapper 构造将数据从查询中传送到对象中。

我希望我能准确地建议您如何使用 Entity Framework 来做到这一点，但也许您会因为知道它可以做到而振作起来。

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2009-03-29T16:47:34.287

使用分部类将您的逻辑和规则与自动生成的 EF 对象分开。在下面的示例中，FooEntityObject 类使用 partial 关键字一分为二。我之前在 EF 和 LINQ to SQL 中使用过这种技术。部分类可以存储在单独的文件中，因此如果您再次重新生成 EF 对象，您的自定义代码不会被覆盖。

```
interface IFoo
{
    public ICollection<IBar> GetBars();
}

public partial class FooEntityObject : IFoo
{
    public ICollection<IBar> GetBars()
    {
        // convert EntityCollection<Bar> into ICollection<IBar> here
    }
}

public partial class FooEntityObject
{
    EntityCollection<Bar> Bars{get;set;}
} 
```

* * *

## 回答 #4

> 赞同：2
> 
> 时间：2009-05-02T10:14:42.997

我最近写了一篇关于此的综合文章：[ADO.NET 实体框架中的持久性无知](http://aleembawany.com/2009/04/06/persistence-ignorance-in-adonet-entity-framework/)。您可能想查看 EFPocoAdapter。这就是这样做的，它最终会在 EF v2 中被弃用。

对于它的价值，我正在使用 EFPocoAdapater，它对我来说效果很好。

* * *

## 回答 #5

> 赞同：2
> 
> 时间：2009-05-02T10:59:43.577

我们一直在为 LINQ to SQL 做同样的事情。我通过编写一个类来解决集合问题，该类根据需要包装`IList`并转换为正确的类型。它看起来有点像这样：

```
public class ListWrapper<TSource, TTarget> : IList<TTarget>
    where TTarget : class
    where TSource : class, TTarget
{
    private IList<TSource> internalList;

    public ListWrapper(IList<TSource> internalList)
    {
        this.internalList = internalList;
    }

    public void Add(TTarget item)
    {
        internalList.Add((TSource)item);
    }

    public IEnumerator<TTarget> GetEnumerator()
    {
        return new EnumeratorWrapper<TSource, TTarget>(internalList.GetEnumerator());
    }

    // and all the other IList members
} 
```

EnumeratorWrapper 类似地包装一个 IEnumerator 并执行强制转换。在 LINQ to SQL 部分类中，我们像这样公开属性：

```
public IList<ICustomer> Foos
{
    get
    {
        return new ListWrapper<Foo, IFoo>(this.Foos_internal);
    }
} 
```

对公开列表的任何更改都将在内部 EntitySet 上执行，以便它们保持同步。

这工作得很好，但我的感觉是，这整个方法比它的价值更麻烦，我是一个巨大的 NHibernate 粉丝和 PI 的坚定信徒，但我们在这方面付出了很多额外的努力，并没有真正看到任何优势。我们使用存储库模式来抽象出实际的 DataContext 访问，我想说这是将我们自己从 LINQ 解耦到 SQL 的关键部分。

# php - 插入时出现奇怪的Mysql问题

> ID：694763
> 
> 赞同：0
> 
> 时间：2009-03-29T15:05:22.490
> 
> 标签：php, mysql, insert

大家好，

不知道这里发生了什么，但如果我运行这个：

```
$query = 'INSERT INTO users 
(`id`, `first_name`, `second_name`, `register_date`, `lastlogin_date`) 
VALUES 
("'. $user_id . '", "' . $first_name .'", "'. $second_name . '", "' . $date . '", "' . $date . ");'; 
$result = mysql_query($query); 
```

我没有回报，但如果我把它改成这样就可以了：

```
$query = 'INSERT INTO users (`id`, `first_name`, `second_name`, `register_date`, `lastlogin_date`) 
VALUES ("21021212", "Joe", "Bloggs", "20090202", "20090202");'; 
$result = mysql_query($query); 
```

用户 id = bigint(20)

名字 = varchar(30)

第二个名字 = varchar(30)

日期 = int(8)

起初我认为这是 vars 的问题，但它们完全相同并且仍然不起作用。

任何帮助表示赞赏。

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2009-03-29T15:16:38.327

[养成使用mysql_real_escape_string](http://php.net/mysql_real_escape_string)转义所有数据库输入的习惯- 实际上，您应该使用某种包装器（如[PDO](http://php.net/pdo)或[ADODb）](http://phplens.com/lens/adodb/docs-adodb.htm)来帮助您做到这一点，但如果没有，您可以这样做：

```
$query = sprintf("INSERT INTO users ".
    "(id, first_name, second_name, register_date, lastlogin_date)".
    "VALUES('%s','%s','%s','%s','%s')",
    mysql_real_escape_string($user_id),
    mysql_real_escape_string($first_name),
    mysql_real_escape_string($second_name),
    mysql_real_escape_string($date),
    mysql_real_escape_string($date));

 $result = mysql_query($query); 
```

并使用[mysql_error检查错误](http://php.net/mysql_error)

```
 if (!$result)
 {
     echo "Error in $query: ".mysql_error();
 } 
```

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2009-03-29T15:08:39.440

“mysql_error()”的结果是什么？始终检查这一点，特别是如果某些东西似乎不起作用。

另外，回显 $query 以查看它的真实外观。这可以说明。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2009-03-29T15:25:04.063

也许是的`$date`价值`"1111'); DELETE FROM users;"`？

认真的吗？问题不在于您与数据库交互的方式。你不应该在你的查询中传递你的数据。您需要指定查询、查询的参数，并在执行查询时传入实际参数值。其他任何东西都是低效的、不安全的并且容易出现像你所拥有的那样的错误。

通过使用[PDO](http://us2.php.net/manual/en/book.pdo.php)或支持参数化查询的东西，您会发现这些问题消失了，因为您正在调用数据库属性。它也更加安全并且可以加速数据库。

```
$sth = $dbh->prepare("INSERT INTO users (`id`, `first_name`, `second_name`, `register_date`, `lastlogin_date`) VALUES (?,?,?,?,?)")
$sth->execute(array($user_id ,$first_name , $second_name , $date, $date )); 
```

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2009-03-29T15:15:51.777

除了[`mysql_error()`](http://www.php.net/mysql_error)像@GoatRider 建议的那样回显查询和检查：

1.  您是否正确地转义了数据？看[`mysql_real_escape_string()`](http://www.php.net/mysql_real_escape_string)
2.  使用时不应以分号结束查询[`mysql_query()`](http://www.php.net/mysql_query)

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2009-03-29T16:19:02.577

在 $query = 'INSERT INTO users ( `id`, `first_name`, `second_name`, `register_date`, `lastlogin_date`) VALUES ("' . $user_id . '", "' . $first_name . '", "' . $second_name . '", "' . $date . ' ", "' . $date . '"); 你给出正确的日期格式吗？这可能是问题所在。否则语法都很好。

# httpwebrequest - 服务器基准测试：服务器可以处理多少个 http 请求？

> ID：694765
> 
> 赞同：1
> 
> 时间：2009-03-29T15:06:21.177
> 
> 标签：httpwebrequest, rest, benchmarking

我正在创建一个应用程序，它每 200 毫秒将测量数据从手机发送到服务器。数据必须实时处理，但我注意到发送时间和进程启动时间之间的差异越来越大，所以我必须找到请求卡住的点。

我正在以 httpwebrequest 表单 (http://testserver/submitdata?ax=value1&ay=value2&az=value3) 发送请求，并且在我使用在 WCF 中创建的 RESTful 服务的服务器上。

无论如何，是否有任何基准测试工具可以测试服务器可以处理多少请求，或者是否有任何其他实用的方法来确定每秒处理的最大请求数而不会造成延迟？

谢谢！

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2009-03-29T15:19:32.737

[Apache Benchmarking (ab)](http://httpd.apache.org/docs/2.0/programs/ab.html)工具可能是一个很好的方法（它适用于任何 HTTP 服务器，而不仅仅是 Apache）。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2011-03-29T10:05:38.130

ab 确实是一个下降的解决方案。您可以以最简单的形式运行

```
ab -c 10 -n 100 http://my.page.com/ 
```

为了调用服务器 100 次并保持 10 个请求同时运行。我的[博客上](http://three99.com/posts/simple-benchmarking-of-nginx)有一个例子。

# python - 将具有多个 i18n 域的 Python 应用程序国际化的最佳方法是什么？

> ID：694768
> 
> 赞同：3
> 
> 时间：2009-03-29T15:08:06.523
> 
> 标签：python, localization, internationalization

我正在国际化一个 Python 应用程序，有两个目标：

1.  应用程序从多个包中加载类，每个包都有自己的 i18n 域。所以包 A 中的模块使用域 A，包 B 中的模块使用域 B，等等。

2.  可以在应用程序运行时更改区域设置。

Python 的`gettext`模块使单域单语言应用程序的国际化变得非常容易；您只需设置语言环境，然后调用`gettext.install()`，它会找到正确的`Translation`并将其`ugettext`方法安装在全局命名空间中作为`_`. 但显然全局值仅适用于单个域，并且由于它加载单个`Translation`，它仅适用于该语言环境。

我可以改为`Translation`在每个模块的顶部加载 ，并将其 ugettext 方法绑定为`_`. 然后每个模块将使用`_`它自己的域。但是当语言环境改变时，这仍然会中断，因为`_`是错误的语言环境。

所以我想我可以`ugettext`在每个函数的顶部加载正确的，但这看起来非常麻烦。另一种方法是仍然按模块执行此操作，但`ugettext`我将替换我自己的函数，而不是 binding ，该函数将检查当前语言环境，获取它的`Translation`，并将字符串转发给它。有没有人有更清洁的解决方案？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-03-29T16:55:49.790

你如何将 _ 绑定到一个大致像这样的函数（对于每个模块）：

```
def _(message):
    return my_gettext(__name__, message) 
```

这允许您在使用 gettext 的同时在每个模块每个调用的基础上执行任何查找，这也允许您切换区域设置。

# error-handling - 如何获取指示 Recordset.Find 是否找到任何内容的值？

> ID：694771
> 
> 赞同：0
> 
> 时间：2009-03-29T15:08:52.077
> 
> 标签：error-handling, vbscript, ado, recordset

我编写了一个程序，可以添加、删除、保存和搜索数据库（记录集）中的记录。但是我是在一个团队中做的。我的任务是将搜索功能添加到我拥有的程序中；但是，当有人键入不在数据库/记录集中的单词/任何内容时，我在添加错误消息时遇到问题。

因此，例如在文本框（txtFindBox.Text）中，如果他们键入“ashbndash”，它会出现一条错误消息。我已经注释掉了我自己的错误消息框，但请告诉我哪里出错了:(

这是查找按钮的代码。

```
Private Sub cmdFindDB_Click()
adoCustomer.Recordset.MoveFirst
If optLastName.Value = True Then
adoCustomer.Recordset.Find "LastName='" & txtFindBox.Text & "'"
'Else
'MsgBox ("NO RECORD FOUND")
End If
If OptFirstName.Value = True Then
adoCustomer.Recordset.Find "FirstName='" & txtFindBox.Text & "'"
'Else
'MsgBox ("NO RECORD FOUND")
End If
End Sub 
```

编辑：就像说问题是每次我点击“查找”按钮时，它都会在 msgbox 中显示“NO RECORD FOUND”消息，即使它找到了答案，如果你输入，它也会出现那个 msgbox在胡言乱语中。

谢谢你的时间

问候哈龙

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-03-29T15:24:15.767

以下是如何执行您尝试执行的操作的示例： [METHOD: Recordset::Find](http://www.devguru.com/technologies/ado/quickref/recordset_find.html)

您的代码示例：

```
adoCustomer.Recordset.MoveFirst
adoCustomer.Recordset.Find "LastName='" & txtFindBox.Text & "'"
If (adoCustomer.Recordset.BOF = True) OR (adoCustomer.Recordset.EOF = True) Then
   MsgBox "Record not found"
End If 
```

您需要检查 EOF 和 BOF，而不是检查 Value 属性是否为真。这些代表文件结束和文件开始。因此，如果其中任何一个为真，那么您不在记录集“内部”，这意味着您没有找到任何东西。

# python - 缩短用于在 Python 中测试返回值的常用代码段

> ID：694775
> 
> 赞同：1
> 
> 时间：2009-03-29T15:10:51.493
> 
> 标签：python, optimization

考虑这个 Python 段：

```
def someTestFunction():
    if someTest:
        return value1
    elif someOtherTest:
        return value2
    elif yetSomeOtherTest:
        return value3
    return None

def SomeCallingFunction():
    a = someTestFunction()
    if a != None:
        return a

    ... normal execution continues 
```

现在，问题是：SomeCallingFunction 开头的三行段，用于获取测试函数的值并在它不是 None 时退出，在许多其他函数中经常重复。三行太长了。我想把它缩短到一个。我怎么做？

我可以根据需要自由地重构这段代码和 someTestFunction 的内容。我想过使用异常，但这些似乎无助于减少调用代码的长度。

（我读过一些关于 Python 装饰器的文章，但没有使用它们。这会是这个地方吗？它是如何工作的？）

* * *

## 回答 #1

> 赞同：9
> 
> 时间：2009-03-29T15:27:43.963

如果你想使用装饰器，它看起来像这样：

```
def testDecorator(f):
    def _testDecorator():
        a = someTestFunction()
        if a is None:
            return f()
        else: return a
    return _testDecorator

@testDecorator
def SomeCallingFunction():
    ... normal execution 
```

当模块第一次被导入时，它运行，将它作为参数`testDecorator`传递给你原来的。`SomeCallingFunction`返回一个新函数，并绑定到`SomeCallingFunction`名称。现在，无论何时调用`SomeCallingFunction`，它都会运行另一个函数，该函数会进行检查，并返回`a`或原始`SomeCallingFunction`.

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2009-03-29T15:17:44.300

我经常使用哈希表来代替一系列 elif：

```
def someTestFunction(decorated_test):
    options = {
        'val1': return_val_1,
        'val2': return_val_2
    }
    return options[decorated_test] 
```

如果未找到密钥，您可以将选项设置为 defaultdict(None) 以默认为 None 。

如果您无法以这种形式进行测试，那么一系列 if 语句实际上可能是最好的选择。

你可以做的一件小事来缩短你的代码是使用这个：

```
if a: return a 
```

可能还有其他方法可以缩短您的代码，但这些是我可以在现场提出的方法。

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2009-03-29T15:34:09.923

我认为这会做到：

**更新已**修复！
对不起昨天，我匆忙并没有测试代码！

```
def test_decorator( test_func ):
    def tester( normal_function ):
        def tester_inner():
            a = test_func()
            if a is not None: 
                return a
            return normal_function()
        return tester_inner    
    return tester 

#usage:
@test_decorator( my_test_function )
def my_normal_function():
    #.... normal execution continue ... 
```

它类似于 DNS 的答案，但允许您指定要使用的测试功能

# asp.net - 动态加载的控件 - 如何访问 Page_Init 中的值

> ID：694795
> 
> 赞同：4
> 
> 时间：2009-03-29T15:21:20.877
> 
> 标签：asp.net, events, controls

当用户单击另一个 LinkBut​​ton 时，我正在动态加载 LinkBut​​ton。我正在为其附加一个事件处理程序。当用户单击动态加载的 LinkBut​​ton 时，不会触发该事件。

从我一直在阅读的内容来看，我理解这是因为当页面回发时，动态加载的控件不再存在。看起来我应该确保在 Page_Init 中重新创建此控件。

动态创建的 LinkBut​​ton 取决于一个值（产品 ID）。我需要以某种方式访问​​此值，以便我可以正确创建控件。ViewState 不可访问，我担心如果我使用 Session 它可能会超时，然后这将无济于事。有任何想法吗？

另外，我硬编码了一个 Product ID 值只是为了测试，但这仍然没有导致事件触发。还有什么我需要做的吗？

```
protected void Page_Init(object sender, EventArgs e)
{
   SetTabText(1, 1);
} 
```

SetTabText 调用创建 LinkBut​​ton 的 SetActionLinks：

```
protected Panel SetActionLinks(int prodID, int tabID) {
...
LinkButton lnkBtn = new LinkButton();
lnkBtn.ID = "lnkBtn" + rand.Next().ToString();
lnkBtn.CommandName = "action";
lnkBtn.Command += new CommandEventHandler(this.lnkAction_Command);
panel.Controls.Add(lnkBtn);
...
}
void lnkAction_Command(object sender, CommandEventArgs e)
{
   LinkButton btn = (LinkButton)sender;
   switch (btn.CommandArgument)
   {
      AddCart();
   }
} 
```

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2009-03-29T16:19:01.813

您可以将您的产品 ID 放在隐藏字段中，并使用 Page_Init 获取其值

```
Page.Request(Page.FindControl("hdnPageIdField")) 
```

这样你就不需要依赖 ViewState 或 SessionState

同样对于动态控制，我强烈建议您阅读[这个伟大的北极系列](http://weblogs.asp.net/infinitiesloop/archive/2006/08/25/TRULY-Understanding-Dynamic-Controls-_2800_Part-1_2900_.aspx)

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2009-03-29T16:01:13.417

在您的情况下，我尝试了您的代码，下面的行会导致您的事件触发错误：

```
lnkBtn.ID = "lnkBtn" + rand.Next().ToString(); 
```

尝试设置一个不会在回发之间更改的 id。

对于 ViewState，您可以将代码移动到 Page_Load。您的代码工作方式相同，但您可以访问 ViewState 和控件的发布值

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2009-06-04T21:47:55.837

几个月前，我花了一个不眠之夜想出这样的事情。那时我完全理解了 ASP.NET 是建立在无状态基础上的，它通过在客户端和服务器之间来回切换视图状态来维护状态。

如果您正在动态添加和删除控件或修改现有控件以响应动态创建的控件的事件触发，则父元素的 PageInit 需要重新创建子控件，使其处于事件触发时存在的状态（在事件的操作之前）被应用）。这似乎是多余的，但是为了确保接收器存在并且当服务器想要触发事件时可以调用它的处理程序是必要的。然后控件的事件处理程序将能够应用更改（并添加或删除控件，分配不同的 ID 等）

我发现这个关于 ASP.NET 事件生命周期的页面 ( [http://msdn.microsoft.com/en-us/library/ms178472.aspx](http://msdn.microsoft.com/en-us/library/ms178472.aspx) ) 很有帮助。

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2012-05-10T06:01:13.543

这适用于 Page_Init

```
HiddenField ctrl = (HiddenField)Page.FindControl("hfTest");
string strValue = Page.Request.Form.Get(ctrl.ClientID); 
```

HiddenField 将存储要加载的控件（管道分隔），我们可以动态加载控件。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2009-03-29T15:43:26.063

查看匿名代表

```
LinkButton lb = new LinkButton();
lb.Command += delegate { // do something here. also you can access any variable from current stack }; 
```

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2009-03-30T08:31:46.017

你有你`AutoEventWireup="true"`的 .aspx 文件吗？

# .net - 是否可以在 XAML 中设置有选择地影响控件的样式？

> ID：694798
> 
> 赞同：9
> 
> 时间：2009-03-29T15:24:55.873
> 
> 标签：.net, wpf, xaml, styles

在`<Window.Resources>`我定义了以下样式：

```
 <Style x:Key="textBlockStyle" TargetType="TextBlock">
        <Setter Property="Margin" Value="5,0,5,0"/>
    </Style> 
```

我已经定义了一些网格，其中有四个`TextBlocks`：

```
 <WrapPanel>
        <TextBlock Style="{StaticResource textBlockStyle}">Server</TextBlock>
        <TextBlock Style="{StaticResource textBlockStyle}">IP</TextBlock>
        <TextBlock Style="{StaticResource textBlockStyle}">Port</TextBlock>
        <TextBlock Style="{StaticResource textBlockStyle}">Status</TextBlock>
    </WrapPanel> 
```

**问题：**我需要引用`textBlockStyle`四次。

**问题：**是否可以在不重复对样式的引用的情况下只在其中`WrapPanel`或其他地方设置一次样式？

也许是这样的：

```
 <WrapPanel Style="{StaticResource textBlockStyle}">
        <TextBlock>Server</TextBlock>
        <TextBlock>IP</TextBlock>
        <TextBlock>Port</TextBlock>
        <TextBlock>Status</TextBlock>
    </WrapPanel> 
```

**我不是在寻找一个全球性的解决方案！**我可以删除该`x:Key="textBlockStyle"`属性，但这会影响Window 中的*所有内容。* `TextBlocks`我需要一个更具选择性的机制，但没有那种丑陋的代码重复。

* * *

## 回答 #1

> 赞同：17
> 
> 时间：2009-03-29T15:33:12.220

您有几个选项，这里按照它们的扩展程度排列。

**选项 1：在较低级别定义没有键的样式**

您可以将资源固定在该`WrapPanel`级别，以便它仅影响其中的控件`WrapPanel`：

```
<WrapPanel>
    <WrapPanel.Resources>
        <Style TargetType="TextBlock">
            <Setter Property="Margin" Value="5,0,5,0"/>
        </Style>
    </WrapPanel.Resources>

    <!-- TextBlocks here -->
</WrapPanel> 
```

注意缺少密钥。这`Style`将适用`TextBlock`于`WrapPanel`.

**选项 2：使用键定义样式，然后再次在较低级别定义样式**

如果您`Style`使用键在更高级别定义，则可以`Style`在没有键的情况下在较低级别定义另一个，并将其`Style`基于更高级别：

```
<Window>
    <Window.Resources>
        <Style TargetType="TextBlock" x:Key="textBlockStyle">
            <Setter Property="Margin" Value="5,0,5,0"/>
        </Style>
    </Window.Resources>

    <WrapPanel>
        <WrapPanel.Resources>
            <Style TargetType="TextBlock" BasedOn="{StaticResource textBlockStyle"/>
        </WrapPanel.Resources>

        <!-- TextBlocks here -->
    </WrapPanel>
</Window> 
```

这会导致 a`Style`自动应用于`TextBlock`s 内部`WrapPanel`，而不是外部。此外，您不会复制的详细信息`Style`- 它们存储在更高级别。

**选项 3：将样式放在 ResourceDictionary 中并有选择地合并它**

最后，您可以将您`Style`的 s 放在一个单独的`ResourceDictionary`并有选择地将该字典合并到控件的`Resources`集合中：

```
<!-- TextBlockStyles.xaml -->
<ResourceDictionary>
    <Style TargetType="TextBlock">
        <Setter Property="Margin" Value="5,0,5,0"/>
    </Style>
</ResourceDictionary>

<!-- Window.xaml -->
<Window>
    <WrapPanel>
        <WrapPanel.Resources>
            <ResourceDictionary>
                <ResourceDictionary.MergedDictionaries>
                    <ResourceDictionary Source="TextBlockStyles.xaml"/>
                </ResourceDictionary.MergedDictionaries>
            </ResourceDictionary>
        </WrapPanel.Resources>
    </WrapPanel>
</Window>

<!-- Alternative Window.xaml if you have only one RD to merge in -->
<Window>
    <WrapPanel>
        <WrapPanel.Resources>
            <ResourceDictionary Source="TextBlockStyles.xaml"/>
        </WrapPanel.Resources>
    </WrapPanel>
</Window> 
```

现在，您可以根据需要在单独的字典中定义任意数量的样式集，然后有选择地将它们应用于您的元素树。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2009-03-29T15:34:44.667

是的，你可以做到这一点。你几乎有正确的想法。你这样做是这样的......

```
<WrapPanel>
< WrapPanel. Resources >
<Style TargetType="{x:Type TextBlock}">
        <Setter Property="Margin" Value="5,0,5,0"/>
    </Style>
</WrapPanel.Resources/>
        <TextBlock Server</TextBlock>
        <TextBlock >IP</TextBlock>
        <TextBlock >Port</TextBlock>
        <TextBlock >Status</TextBlock>
    </WrapPanel> 
```

通过使用 {x:type } 语法，您不需要 x:key，它将为包装面板中的所有文本块设置样式。如果您想要不同的样式，您仍然可以使用 x:key 并在文本块上明确设置样式。

# c# - 如何在给定点停止线程？

> ID：694804
> 
> 赞同：4
> 
> 时间：2009-03-29T15:28:44.540
> 
> 标签：c#, multithreading

我试图停止一些线程，阅读一些关于优雅地做这件事的正确方法的东西，但我一定是做错了什么，因为它根本不起作用。起初我尝试不`lock()`使用`_IsRunning`易失性，然后尝试使用锁。这就是我所拥有的。

```
private volatile bool _IsRunning;
private static readonly object runLock = new object();

public void Start()
{
    if (_IsRunning == true)
        return;
    _IsRunning = true;
    (new System.Threading.Thread(new System.Threading.ThreadStart(SendLoop))).Start();
}

public void Stop()
{
    lock (runLock)
    {
        _IsRunning = false;
    }
}

private void SendLoop()
{
    while (_IsRunning)
    {
        lock (runLock)
        {
            if (_sockets.Count > 0)
            {
                //some stuff
            }
            else
            {
                System.Threading.Thread.Sleep(10);
            }
        }
    }
} 
```

我在我的设置了一个断点，`while()`即使`_IsRunnig`我通过了它仍然是正确的`Stop()`。

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2009-03-29T16:24:15.000

由于您的 start 方法的编写方式，此处需要锁定，但是，您只需要锁定`Start()`（现在不需要锁定）和`Stop()`，因为它们是唯一可能在您的情况下导致竞争条件的锁定.

我会从您的`SendLoop()`方法中完全删除锁（它会导致[死锁](http://en.wikipedia.org/wiki/Deadlock)，因为`Stop`正在等待锁设置`_isRunning`，并且您`SendLoop`一直持有锁，直到`_isRunning`设置为 false）。现在，当你打电话时`Stop()`，锁会阻止它设置`_isRunning = false;`

但是，您将需要锁定您的`Start()`和`Stop()`方法（除非您完全修改它们的结构方式）。就像是：

```
public void Start()
{
    lock (runLock)
    {
        if (_IsRunning == true)
            return;
        _IsRunning = true;
        (new System.Threading.Thread(new System.Threading.ThreadStart(SendLoop))).Start();
    }
}

public void Stop()
{
    lock (runLock)
    {
        _IsRunning = false;
    }
} 
```

这将保护您免于启动 2 个线程，并且还将阻止 Stop 在线程启动之前停止。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2009-03-29T15:34:19.813

你需要稍微重新组织你的循环。现在，您在很长一段时间内都持有 runLock 的锁定。这将导致任何调用 Stop 方法的人挂起，直到 if 块成功或 Sleep 调用返回。这可能会导致问题，因为您无法在调用 Stop 方法时查看 _isRunning，只能在它返回时查看。尝试按如下方式重新组织您的代码

```
private void SendLoop() {
  do {
    if ( _sockets.Count > 0 ) {
    } else { 
      System.Threading.Thread.Sleep(10);
    }
    bool shouldContinue;
    lock ( runLock ) { 
      shouldContinue = _IsRunning;
    }
  while(shouldContinue);
} 
```

我不是 100% 确定这是问题所在。但至少它应该有助于澄清一些事情。

# c++ - C++ 动态内存分配

> ID：694807
> 
> 赞同：0
> 
> 时间：2009-03-29T15:31:44.347
> 
> 标签：c++

我只是在学习动态内存分配，但有一件事我想解释一下。

动态分配的一种用途是用于动态大小的数组，这对我来说很清楚。另一种用途是用于普通物体。

应该使用它的情况是什么？是不是因为通常对象被压入堆栈，并且可以被弹出？

您如何识别应该使用动态内存分配的情况？

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2009-03-29T15:36:24.537

动态内存的另一个问题是生命周期。动态内存（new、malloc 等）存在于堆上。它将一直保持活动状态，直到它被一段代码通过适当的记忆功能明确删除。这对于长寿命的对象非常有用。

非动态内存或堆栈具有非常明确的生命周期。堆栈上分配的内存仅在该方法执行时才存在。一旦方法完成，内存将被自动回收。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-03-29T15:35:12.840

不知道您必须处理多少项目是很常见的——它们可能来自文件或其他任何东西。要存储来自程序外部的项目，您需要动态大小的数组。

PS：一定要使用像 std::vector 这样的 STL 类，而不是“数组”。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-03-29T15:35:38.080

当您不知道需要分配多少对象时，您需要动态分配。

# c - typedef enum，在其中赋值

> ID：694812
> 
> 赞同：11
> 
> 时间：2009-03-29T15:34:12.747
> 
> 标签：c, enums

使用 gcc C99 编译

我已经使用枚举一段时间了。但是，我正在使用一些示例代码来开发我的应用程序。我遇到了一些这样的代码。我被告知这是使用枚举时的最佳实践。但我不明白这有什么好处。

```
typedef enum {
    TYPE_DATE,
    TYPE_TIME,
    TYPE_MONEY,

    TYPE_COUNT,
    TYPE_UNKNOWN = TYPE_COUNT
} string_type_e; 
```

为什么有`TYPE_COUNT`以及为什么分配`TYPE_COUNT`给`TYPE_UNKNOWN`？

非常感谢您的任何建议，

* * *

## 回答 #1

> 赞同：17
> 
> 时间：2009-03-29T15:46:36.493

默认情况下，编译器会自动为枚举赋予从 0 开始的整数值。所以日期为零，时间为一，金钱为二。下一个值被赋予 'psuedo' 枚举值`TYPE_COUNT`，它将被赋予值 3，这恰好是“正确”枚举值的数量。

`TYPE_UNKNOWN`是另一个值，它表示不是“正确”值的东西，因此将失败 test `e < TYPE_COUNT`。让它等于`TYPE_COUNT`意味着每个不同的有意义的值都是连续的，但我不知道这有什么显着的优势（如果`TYPE_COUNT`1 小于 2 的幂，这可能会影响编译器可以使用的表示形式，并且让值连续是“很好的”，但这并不重要，因为`TYPE_COUNT`无论如何你都不会增加它们）

* * *

## 回答 #2

> 赞同：6
> 
> 时间：2009-03-29T15:44:43.860

枚举值基本上是整数常量。默认情况下，它们被赋予枚举中最后一个元素的值 + 1（第一个元素为 0）。当您想计算这样声明的枚举的元素（这对于将其映射到数组或其他内容时可能有用）（如果您添加或删除某些内容将动态更新），您可以将 COUNT 常量放在它的结尾（`TYPE_COUNT`在你的例子中）。为了能够区分枚举中的无效值，您可能需要声明另一个常量。在您的示例中，该常量将等于 count 常量，它比枚举的最大值大一个值。

* * *

## 回答 #3

> 赞同：3
> 
> 时间：2009-03-29T15:45:57.260

> 为什么有 type_count 以及为什么将 type_count 分配给 type_unknown？

保留一个标签的最大允许值`enum`。请记住，否则将无法检查给定值是否正确（在范围内）。

* * *

## 回答 #4

> 赞同：2
> 
> 时间：2009-03-29T16:03:38.497

TYPE_COUNT 可用于对由枚举元素索引的数组进行标注：

```
type_info my_info[TYPE_COUNT]; 
```

或可用于 for 循环的退出条件。TYPE_UNKNOWN 可用于表示该类型的非法或未定义值（-1 可以替代 TYPE_COUNT 的值）。

# ternary-operator - 三元运算符：坏习惯还是好习惯？

> ID：694814
> 
> 赞同：29
> 
> 时间：2009-03-29T15:34:26.833
> 
> 标签：ternary-operator

我正在寻找使用/不使用它的理由以及原创想法（在使用和替换它们时）。

* * *

复制：

*   [三元还是不三元](https://stackoverflow.com/questions/160218/to-ternary-or-not-to-ternary)

相关（但没有解决所提出的问题）：

*   [您对三元运算符使用哪种编码风格？](https://stackoverflow.com/questions/243217/which-coding-style-you-use-for-ternary-operator)

* * *

## 回答 #1

> 赞同：52
> 
> 时间：2009-03-29T15:50:20.900

为便于阅读，我只在适合 80 字符行的情况下使用三进制。

* * *

## 回答 #2

> 赞同：10
> 
> 时间：2009-03-29T15:45:00.927

适用于 PHP 等模板语言中的短标签，例如：

```
<form>
<input type='radio' name='gender' value='m' <?=($gender=='m')?"checked":""?>>Male
<input type='radio' name='gender' value='f' <?=($gender=='f')?"checked":""?>>Female
</form> 
```

适用于 javascript/jQuery 中的开关：

```
var el = $("#something");
$(el).is(':visible') ? $(el).hide("normal") : $(el).fadeIn("normal"); 
```

适合赋值，尤其是在特定变量名称可以采用不同类型的情况下：

```
$var = ($foo->isFoo()) ? 'Success!' : false; 
```

* * *

## 回答 #3

> 赞同：7
> 
> 时间：2009-03-29T15:44:47.340

条件三元运算符肯定会被过度使用，有些人觉得它很不可读。但是，我发现在大多数情况下，只要其意图明确，布尔表达式就可以非常干净。如果意图*不*明确，最好使用具有明确名称的临时变量，其值是使用 if 语句分配的，或者使用具有良好名称且返回预期值的函数。

* * *

## 回答 #4

> 赞同：4
> 
> 时间：2009-03-29T15:37:13.053

这有点像`for`循环。对于它的用途是有道理的，但是当您尝试在其中添加更多内容时，它变得不可读。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2009-03-29T15:39:19.817

你说的是哪个三元运算符？

三元运算符是任何带有三个参数的运算符。

如果你在谈论 ? : 运算符，这称为条件运算符。就个人而言，我不能没有它了。If-else 语句对我来说看起来很乱，尤其是在进行条件赋值时。有些人抱怨它看起来很乱，但仍然有可能（尤其是在使用 Visual Studio 或其他智能格式化 IDE 的情况下）使内容易于阅读，并且无论如何您都应该注释所有条件。

# mfc - mfc 中的事件和消息

> ID：694818
> 
> 赞同：4
> 
> 时间：2009-03-29T15:36:09.373
> 
> 标签：mfc

我对 mfc 中的事件和消息之间的区别有点困惑。他们是一样的吗？

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2009-03-30T09:03:09.560

由于您专门询问 MFC，我假设您的意思是您可以在 MFC 类的属性窗口中定义的事件处理程序和消息处理程序。

在“事件”下，您可以定义：

*   WM_COMMAND windows 消息的处理程序。
*   MFC ON_UPDATE_COMMAND_UI 处理程序。
*   子窗口通知消息的处理程序，如 ON_BN_CLICKED 用于处理对话框中的按钮单击。

在“消息”下，您可以为其他 Windows 消息定义消息处理程序。

另见[msdn中的一些解释](http://msdn.microsoft.com/en-us/library/0x0cx6b1(VS.80).aspx)

在 Win32 术语中，事件处理程序和消息处理程序实际上都是消息处理程序。

其他答案解释了 Windows 事件（与上述 MFC“事件”无关）和 Windows 消息（对应于上述“事件”和“消息”）之间的区别。

如果您认为这有点令人困惑，我完全同意...

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2009-03-29T15:44:19.527

如果我们谈论的是纯 Win32，那么这些是不同的：

事件是内核同步对象，有点像二进制互斥锁。它可以有两种状态：已发出信号和未发出信号。它用于同步线程，线程获取它（使用 WaitForSingleObject 或其表亲）并通过 SetEvent API 释放它。

user32 中的窗口管理器使用一条消息来通知窗口某些事件，有很多不同的消息用于各种目的：窗口管理、绘画、用户输入......

* * *

## 回答 #3

> 赞同：4
> 
> 时间：2009-03-29T16:26:02.920

消息用于窗口之间的**通信。**事件用于线程之间的**同步。**

* * *

## 回答 #4

> 赞同：2
> 
> 时间：2009-03-29T19:49:50.730

更多细节可能有用。

先说事件。

所以，你的程序正在运行。然后创建一个事件 - 使用的函数调用是 CreateEvent()。该事件有两种状态；有信号的和无信号的。（您选择它开始的状态）。您现在可以*等待该事件*- 也就是说，您可以例如将该事件提供给操作系统函数调用，然后等待该事件。操作系统完成后，它会将事件的状态更改为已发出信号，并且您的 Wait() 函数调用将返回。

现在，如果你只有一个线程，这没什么用——你可以调用操作系统函数并等待它返回。但是如果你有多个线程并且你想在它们之间进行通信——那么你就不能对其他线程进行函数调用。相反，您所做的是与另一个线程通信，告诉它做某事并给它事件，然后 Wait() 直到它完成。

现在，消息。

程序可以有所谓的“消息循环”，它是一个阻塞的线程，读取程序消息队列。您可以向线程（或窗口）发送消息，该线程将自动读取该消息。因此，如果您有多个线程，则一种用途是发出终止消息-该退出了。另一个是让线程知道你想让它做某事——一条消息可以将两个整数值作为数据，所以你也可以将句柄传递给一个事件，这样线程就可以在它完成时向你发出信号。（或者您可以让它在完成后向您发送消息；这完全取决于您希望如何组织代码 - 基于事件或基于消息）。

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2009-03-30T09:36:00.823

Dani 是正确的：在 MFC 世界中，“事件”与控件相关联，并通过 WM_COMMAND 消息传递。“消息”是一个更广泛的术语，包含所有 Windows 消息。有关示例，请参阅 msdn 文档以获取类似[BN_CLICKED](http://msdn.microsoft.com/en-us/library/aa925869.aspx)的内容。

这是对“事件”一词的令人遗憾的重载，这相当令人困惑。它与更广泛的 Win32 世界中的事件无关，它们是内核同步对象。

# java - 将数组写入文件

> ID：694824
> 
> 赞同：0
> 
> 时间：2009-03-29T15:37:57.013
> 
> 标签：java, arrays, file-io

我正在尝试在书中做一个练习，要求将数组列表的内容写入文本文件，有人可以给我一些关于我做错了什么而不是完整解决方案的想法，我是否需要制定一个方法返回一个字符串然后写那个？

```
import java.util.ArrayList;
import java.io.FileWriter;
import java.util.Iterator;

/**
 * A class to maintain an arbitrarily long list of notes.
 * Notes are numbered for external reference by a human user.
 * In this version, note numbers start at 0.
 * 
 * @author David J. Barnes and Michael Kolling.
 * @version 2008.03.30
 */
public class Notebook {
    // Storage for an arbitrary number of notes.
    private ArrayList<String> notes;

    /**
     * Perform any initialization that is required for the
     * notebook.
     */
    public Notebook() {
        notes = new ArrayList<String>();
    }

    /**
     * Store a new note into the notebook.
     * @param note The note to be stored.
     */
    public void storeNote(String note) {
        notes.add(note);
    }

    /**
     * @return The number of notes currently in the notebook.
     */
    public int numberOfNotes() {
        return notes.size();
    }

    /**
     * Remove a note from the notebook if it exists.
     * @param noteNumber The number of the note to be removed.
     */
    public void removeNote(int noteNumber) {
        if(noteNumber < 0) {
            // This is not a valid note number, so do nothing.
        } else if(noteNumber < numberOfNotes()) {
            // This is a valid note number.
            notes.remove(noteNumber);
        } else {
            // This is not a valid note number, so do nothing.
        }
    }

    /**
     * List all notes in the notebook.
     */
    public void listNotes() {
        for(String note : notes) {
            System.out.println(note);
        }
    }

    /**
     * 
     */
    public void writeToFile() {
        try{
            FileWriter writer = new FileWriter("file.txt");

            for(String str : notes){
                writer.write(str.toString());
            }
        }
        catch(Exception e ){
            System.out.println("some error...");
        }
    }
} 
```

编辑：我现在遇到的问题是，即使我使用 ，我也无法将每个字符串都放在新行上`writer.write('\n')`，我意识到我忘记了`writer.close();`;)

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-03-29T15:46:41.203

在我看来不对的事情：

*   在字符串上调用 toString() 纯粹是浪费
*   作家永远不会关闭
*   注释写在文件中，它们之间没有任何分隔符。该文件可能难以阅读。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-03-29T20:13:47.677

Without altering your code very much...

```
try{
    PrintWriter writer = new PrintWriter(new FileWriter("file.txt"));

    for(String str : notes){
        writer.println(str.toString());
    } 
```

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2009-03-29T15:42:25.507

您想看看在完成时关闭 FileWriter。否则，是什么迫使 FileWriter*完成*其操作？

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2009-03-29T17:02:36.327

Get the system newline property in a string variable.

String newline = System.getProperty("line.separator");

Then in the file write module append newline to the end of each line.

writer.write(str.toString() + newline);

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2009-03-29T15:48:29.140

您没有任何方法来分隔字符串，因此当您重新读取它们时，您将不知道一个字符串在哪里结束，下一个从哪里开始。由于 Java 字符串是 Unicode，因此您可以写入文件中的内容很少会不合法地包含在您的字符串中。所以我建议做的是写一个表示字符串长度的 int，然后是字符串，这样你就知道要读多少。相反，您可以研究使用 Java 的序列化方法并将整个 List 序列化到一个文件中。

但话又说回来，我是一名数据库专家，并且对 PreparedStatements 和 ResultSets 最满意，所以我可能只是将其作为 SQLite 数据库来完成。

# java - 如何使用蚂蚁？

> ID：694846
> 
> 赞同：5
> 
> 时间：2009-03-29T15:50:19.933
> 
> 标签：java, eclipse, ant, build-process, build-automation

我一直在尝试了解 Ant 的用途，但我仍然不明白。

有人可以给我一个使用 Ant 的用例吗，我可以尝试看看 Ant 为何有用以及我可以将它用于什么类型的事情？

我在 Eclipse 中进行 Java 开发，并且刚刚开始使用 servlet 和 Google Web Toolkit。

* * *

## 回答 #1

> 赞同：17
> 
> 时间：2009-03-29T15:55:23.803

Ant 是一个构建工具。例如，假设您的 Eclipse 工作区中有几个项目，所有这些项目都是一个更大的应用程序的一部分。要将其全部构建到包含依赖项的 jar 文件中，您可以选择所有项目并将它们导出为 jar 文件，但这有点麻烦。

Ant 是一个可扩展的解决方案。您在 XML 中定义构建过程，并且 ant 根据这个秘籍编译您的 java 文件。

Ant 可以做的不仅仅是构建。我在一家公司工作，该公司的部署机制是我们自己的存储库中的 Debian 软件包。我们有 Ant 脚本来构建 jar 文件，将它们和一些元数据文件排列到一个 Debian 包中，将它们放入存储库，然后重新生成存储库清单。

与任何 Java 一样，在您精通 Ant 之前，您需要了解很多配置，但一些基本教程应该让您了解自己正在进入什么领域。

* * *

## 回答 #2

> 赞同：5
> 
> 时间：2009-03-29T16:14:10.733

与任何构建工具一样，Ant 用于自动化构建代码的重复性任务。

无需每次手动运行 javac，而是将命令放入 Ant 脚本中，然后当您运行 ant 时，它会为您运行 javac。

我使用 ant 的典型构建过程是这样的：

*   在源代码上运行 javac
*   在 tets 上运行 javac
*   在源代码上运行 cobertura 工具（这是为了代码覆盖）
*   从源头打包类
*   关闭 cobertura 仪表类
*   jar 单元测试类
*   在源代码上运行 checkstyle、pmd、findbugs 以查找警告
*   通过 cobertura 运行单元测试以获取它们的代码覆盖率

所以这是我在每个构建中完成的 8 个步骤，我可以通过运行“ant”来完成。

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2009-03-29T17:03:05.500

Ant 是一个基于 XML 的 make 文件。

如果您是一个已经使用 Eclipse 之类的 IDE 成功构建和打包代码的单一开发人员，那么使用 Ant 不会有太多好处。

当您有一个团队在代码上进行协作时，更大的好处就会出现。然后，如果您使用 Cruise Control 或其他一些持续集成工具，您将获得巨大的提升。CC 需要一个 Ant build.xml。

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2009-03-29T23:56:25.317

这来自 ANT 文档并很好地解释了它。

> 既然已经有 make、gnumake、nmake、jam 和其他工具，为什么还要使用另一个构建工具？因为所有这些工具都有 Ant 的原作者在跨多个平台开发软件时无法忍受的限制。Make-like 工具本质上是基于 shell 的：它们评估一组依赖项，然后执行与在 shell 上发出的命令不同的命令。这意味着您可以通过使用或为您正在使用的操作系统编写任何程序来轻松扩展这些工具；但是，这也意味着您将自己限制在您正在使用的操作系统，或者至少是操作系统类型，例如 Unix。
> 
> Makefile 本质上也是邪恶的。任何从事过它们的人都会遇到可怕的标签问题。“我的命令没有执行是因为我的标签前面有一个空格吗？！！” 蚂蚁方式的原作者说了太多次了。像 Jam 这样的工具在很大程度上解决了这个问题，但仍然有另一种格式可以使用和记住。
> 
> 蚂蚁不一样。Ant 不是使用基于 shell 的命令扩展的模型，而是使用 Java 类扩展的。配置文件不是编写 shell 命令，而是基于 XML，调用一个目标树，在其中执行各种任务。每个任务都由实现特定任务接口的对象运行。
> 
> 诚然，这消除了能够构建 shell 命令（例如`find . -name foo -exec rm {}`. 嘿，如果你真的需要执行一个 shell 命令，Ant 有一个任务允许根据它正在执行的操作系统执行不同的命令。

# iphone - 自定义 UISwitch 和 App Store 批准

> ID：694848
> 
> 赞同：49
> 
> 时间：2009-03-29T15:50:21.647
> 
> 标签：iphone, objective-c

在做了一些阅读之后，我发现您可以自定义 UISwitch 控件上的文本和颜色。我很好奇这些方法是否会导致试图让我的应用程序获得批准并包含在 App Store 中的问题。

取自[iPhone Developer's Cookbook Sample Code 的示例代码](http://code.google.com/p/cookbooksamples/downloads/list)：

```
// Custom font, color
switchView = [[UICustomSwitch alloc] initWithFrame:CGRectZero];
[switchView setCenter:CGPointMake(160.0f,260.0f)];
[switchView setLeftLabelText: @"Foo"];
[switchView setRightLabelText: @"Bar"];
[[switchView rightLabel] setFont:[UIFont fontWithName:@"Georgia" size:16.0f]];
[[switchView leftLabel] setFont:[UIFont fontWithName:@"Georgia" size:16.0f]];
[[switchView leftLabel] setTextColor:[UIColor yellowColor]]; 
```

* * *

## 回答 #1

> 赞同：40
> 
> 时间：2009-03-29T16:21:07.737

这不会在提交到应用商店时产生问题。只要您不使用任何私有（未记录的）API 来构建/更改这些小部件，您就可以使用自定义控件或内置控件的更改版本。

* * *

## 回答 #2

> 赞同：16
> 
> 时间：2010-04-30T01:21:31.960

您可能会喜欢我实现的自定义开关（开源且免费使用）...它允许将开关设置为显示任何文本，或轻松将其子类化以在轨道中绘制您自己的自定义图像... [http:// /osiris.laya.com/projects/rcswitch/](http://osiris.laya.com/projects/rcswitch/)

这个开关使绘制图像而不是文本变得容易：子类化主开关类并像这样覆盖draw方法，您的图像将自动动画：

```
- (void)drawUnderlayersInRect:(CGRect)aRect withOffset:(float)offset inTrackWidth:(float)trackWidth
{
    [onImage drawAtPoint:CGPointMake(floorf(aRect.origin.x + 13 + (offset - trackWidth)), floorf((self.bounds.size.height - onImage.size.height) / 2.0))];
    [offImage drawAtPoint:CGPointMake(floorf(aRect.origin.x + 15.0 + (offset + trackWidth)), ceilf((self.bounds.size.height - offImage.size.height) / 2.0))];
} 
```

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-05-08T05:35:00.187

根本不需要 UISwitch 子类。我实现的一个相当简单的解决方案是子类 UIView 和在两个图像（开/关）之间切换的触摸事件，仅此而已。

问候 Dhanesh

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2013-03-16T20:07:29.827

我刚刚创建了这个视图，看到你的问题

希望这可以帮助

.h 文件：

```
#import <UIKit/UIKit.h>

@interface EDSwitch : UIView
{
    UIButton* onButton,*offButton;
    UIImageView* bg;
}

- (id)initWithText:(NSString*)on andText:(NSString*)off andDelegate:(id)delegate andOnSelector:(SEL)onSelector andOffSelector:(SEL)offSelector andBackgroundImage:(UIImage*)bgImage andStartingValue:(BOOL)b;

@end 
```

和 .m 文件：

```
#import "EDSwitch.h"

@implementation EDSwitch

- (id)initWithText:(NSString*)on andText:(NSString*)off andDelegate:(id)delegate     andOnSelector:(SEL)onSelector andOffSelector:(SEL)offSelector andBackgroundImage:     (UIImage*)bgImage andStartingValue:(BOOL)b
{
self = [super initWithFrame:CGRectZero];
if (self) {
    UILabel* onLabel = [[UILabel alloc] initWithFrame:CGRectMake(2, 8, 50, 20)];
    onLabel.text = on ;
    onLabel.tag = 1;
    onLabel.font = [UIFont fontWithName:kCalibri size:15];
    onLabel.textAlignment = UITextAlignmentCenter;
    onLabel.textColor = [UIColor colorFromHexString:@"#009dd0"];
    onLabel.backgroundColor = [UIColor clearColor];
    [onLabel sizeToFit];
    [onLabel setWidth:onLabel.frame.size.width + 4];

    UILabel* offLabel = [[UILabel alloc] initWithFrame:CGRectMake(2, 8, 50, 20)];
    offLabel.text = off ;
    offLabel.tag = 1;
    offLabel.textAlignment = UITextAlignmentCenter;
    offLabel.font = [UIFont fontWithName:kCalibri size:15];
    offLabel.textColor = [UIColor colorFromHexString:@"#009dd0"];
    offLabel.backgroundColor = [UIColor clearColor];
    [offLabel sizeToFit];
    [offLabel setWidth:offLabel.frame.size.width + 4];

    float high = MAX([offLabel.text sizeWithFont:offLabel.font].width,[onLabel.text sizeWithFont:onLabel.font].width) + 10;

    onButton = [UIButton buttonWithType:UIButtonTypeCustom];
    [onButton addTarget:self action:@selector(toggled:) forControlEvents:UIControlEventTouchUpInside];
    [onButton addTarget:delegate action:onSelector forControlEvents:UIControlEventTouchUpInside];
    offButton = [UIButton buttonWithType:UIButtonTypeCustom];
    [offButton addTarget:self action:@selector(toggled:) forControlEvents:UIControlEventTouchUpInside];
    [offButton addTarget:delegate action:offSelector forControlEvents:UIControlEventTouchUpInside];

    [onButton setWidth:high];
    [onButton setX:0];
    [onButton addSubview:onLabel];
    [onLabel setWidth:high];
    [onLabel setX:0];

    [offButton setWidth:high];
    [offButton addSubview:offLabel];
    [offButton setX:high];
    [offLabel setWidth:high];
    [offLabel setX:0];

    bg = [[UIImageView alloc] initWithImage:bgImage];

    self.frame = CGRectMake(200, 200 , (high*2), 34);
    self.layer.borderColor = [[[UIColor colorFromHexString:@"#009dd0"] colorWithAlphaComponent:0.5] CGColor];
    self.layer.borderWidth = 0.5;
    self.layer.cornerRadius = 5;
    [self setX:[UIApplication sharedApplication].keyWindow.frame.size.width - self.frame.size.width - 8];

    [self addSubview:bg];

    [bg setWidth:[self getWidth]];
    [bg setHeight:[self getHeight]];

    [self addSubview:onButton];
    [self addSubview:offButton];

    [onButton setHeight:[self getHeight]];
    [offButton setHeight:[self getHeight]];

    if(b){
        [onButton setBackgroundColor:[UIColor clearColor]];
        [offButton setBackgroundColor:[UIColor whiteColor]];
    }
    else{
        [onButton setBackgroundColor:[UIColor whiteColor]];
        [offButton setBackgroundColor:[UIColor clearColor]];
    }
}
return self;
}

-(void)toggled:(UIButton*)sender{
if(sender == onButton){
    UILabel* l = (UILabel*)[onButton viewWithTag:1];
    l.textColor = [UIColor grayColor];
    [onButton setBackgroundColor:[UIColor clearColor]];
    l = (UILabel*)[offButton viewWithTag:1];
    l.textColor = [UIColor colorFromHexString:@"#009dd0"];
    [offButton setBackgroundColor:[UIColor whiteColor]];

}
else{
    UILabel* l = (UILabel*)[offButton viewWithTag:1];
    l.textColor = [UIColor grayColor];
    [offButton setBackgroundColor:[UIColor clearColor]];
    l = (UILabel*)[onButton viewWithTag:1];
    l.textColor = [UIColor colorFromHexString:@"#009dd0"];
    [onButton setBackgroundColor:[UIColor whiteColor]];
}
}

@end 
```

用法：

```
 [[UIApplication sharedApplication].keyWindow addSubview:[[EDSwitch alloc] initWithText:@"aksdjaksdjh" andText:@"dasjdsaj" andDelegate:self andOnSelector:@selector(logon) andOffSelector:@selector(logoff) andBackgroundImage:[UIImage imageNamed:@"toggleBottom.png"] andStartingValue:YES]]; 
```

健康长寿·繁荣昌盛，

永然

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2011-09-18T18:36:09.280

来自 Apple 文档：-

> 您可以使用 UISwitch 类来创建和管理您看到的开/关按钮，例如，在飞行模式等服务的首选项（设置）中。这些对象称为开关。
> 
> UISwitch 类声明了一个属性和一个方法来控制其开/关状态。与 UISlider 一样，当用户操作开关控件（“翻转”它）时，会生成 UIControlEventValueChanged 事件，这会导致控件（如果配置正确）发送操作消息。
> 
> UISwitch 类不可自定义。

Apple 说它们不可定制，这可能意味着您的应用程序被拒绝。

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2011-10-13T08:30:44.463

在 Apple Human Interface Guidelines 中，在 Switch 文档中，Apple 声明：

> 使用表格行中的开关为用户提供两个简单的、截然相反的选择，以确定某物的状态，例如是/否或开/关。使用一对可预测的值，这样用户就不必滑动控件来发现另一个值是什么。

所以，是的，只要您使用一对可预测的值（如是/否），就可以更改文本。

* * *

## 回答 #7

> 赞同：-30
> 
> 时间：2009-05-21T18:13:19.187

这将导致您的应用审批出现问题。问我怎么知道 :P

我今天刚从 Apple 收到一封讨厌的信。我们正在寻找替代方案。

# php - 动态查询数据库以检查值

> ID：694849
> 
> 赞同：0
> 
> 时间：2009-03-29T15:53:40.517
> 
> 标签：php, javascript, jquery, mysql

我需要动态检查某个值“SheetNumber”是否在我的 mysql 数据库中。我已经在流行的网站上看到它完成了，我正在尝试找到一个很好的教程来为我概述它。我对 Javascript 相当陌生，但我知道很多 PHP。

我急于学习如何做到这一点。

*   克里斯

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2009-03-29T16:02:37.220

您将需要使用 Ajax 来执行此操作。我推荐[Jquery](http://jquery.com)库。使用 Jquery 文档安装它，然后使用如下内容：

**Javascript：**

```
function makeAjaxRequest()
{
   var url="script-that-checks-db.php";
   $.get(url,{},verifyDb);
}

function verifyDb(response)
{
    if (response==1)
    {
       //The value exists, do what you want to do here
    }

    else
    {
      //The value doesn't exist
    }
} 
```

您可以`makeAjaxRequest()`在有人单击链接、单击按钮或其他任何内容时调用，例如：

```
<a href="#" onclick="makeAjaxRequest();">Check database</a> 
```

文件的 php 代码`script-that-checks-db.php`（当然，命名不同）将负责检查 db. 代码看起来像这样。

**PHP：**

```
<?php

//Do the mysql query and find out if the value exists or not.

if ($exists==true)
   echo "1"; //1 will indicate to javascript that the value exists.
else
   echo "0";
?> 
```

您也可以在这里使用 JSON 而不是 0/1 方法，但是因为您是新手，我认为这对您来说已经足够简单了。

希望这会有所帮助，如果您有任何问题，请随时提出。此外，请随意更改函数和文件名。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2009-03-29T15:57:48.197

这很简单；检查关于 AJAX 函数的 jQuery 文档：[jQuery.get()](http://docs.jquery.com/Ajax/jQuery.get#urldatacallbacktype)

您需要设置一个简单的 PHP 服务，该服务返回原始数据、XML 或 JSON 格式的数据，然后您可以使用 jQuery 回调函数对其进行解释。

例子：

```
function checkData(userInputValue) {
  jQuery.get('ajax-backend.php?value='+userInputValue, false, function(data) { alert('Response from server: ' + data)});
} 
```

除了使用 alert() 来显示来自服务器的响应，您可能希望解释此值并更改页面上的某些内容以指示操作是否成功。

这是上一个问题中更详细的示例：[Beginning jQuery help](https://stackoverflow.com/questions/550494/beginning-jquery-help)

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2009-03-29T15:58:40.007

我假设“动态”是指“不离开页面”，建议使用“AJAX”解决方案。

您无法使用客户端 JavaScript 访问您的数据库，我建议使用 JavaScript 库/框架（如 JQuery）调用 PHP 脚本“在幕后”执行您想要的操作。

# c++ - 提升序列化 NVP 宏和非 XML 元素字符

> ID：694855
> 
> 赞同：5
> 
> 时间：2009-03-29T15:58:09.133
> 
> 标签：c++, xml, serialization, boost

当使用`BOOST_SERIALIZATION_NVP`宏为 XML 序列化创建名称-值对时，编译器很高兴地允许以下代码编译，即使元素名称不是有效的 XML 元素，并且在尝试将对象实际序列化为 XML 时抛出异常：

```
BOOST_SERIALIZATION_NVP(_member[index]) 
```

一个明显的解决方法是使用：

```
boost::serialization::make_nvp("ValidMemberName", _member[index]) 
```

但是任何人都可以建议一种修改 boost 的方法，以便非法元素名称会触发编译错误吗？（因此不依赖单元测试来捕捉上述微妙的错误）

* * *

**编辑：**

一个想法是用传递给宏的元素名称以某种方式声明一个虚拟局部变量，假设 C++ 中的有效标识符集是有效 XML 元素的子集。不完全确定这可以做到。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-04-06T08:18:54.330

引用名称的 XML 语法：

```
NameStartChar ::=   ":" | [A-Z] | "_" | [a-z] | [#xC0-#xD6] | [#xD8-#xF6] | [#xF8-#x2FF] | [#x370-#x37D] | [#x37F-#x1FFF] | [#x200C-#x200D] | [#x2070-#x218F] | [#x2C00-#x2FEF] | [#x3001-#xD7FF] | [#xF900-#xFDCF] | [#xFDF0-#xFFFD] | [#x10000-#xEFFFF]
NameChar      ::=   NameStartChar | "-" | "." | [0-9] | #xB7 | [#x0300-#x036F] | [#x203F-#x2040] 
```

我看到与 C++ 名称的以下差异： 前导 _ 可以在 C++ 中保留，具体取决于以下内容；冒号、点和减号在 XML 名称中有效。Unicode 字符也可能在 C++ 中引起一些麻烦，但这主要取决于实现。

[#x0300-#x036F] 部分正在组合重音符号（变音符号），这可能是名称相等的另一个问题。

因此，没有解决非字母字符的解决方案。<:::/> 可能看起来像一个笑脸，但它是格式良好的 XML。其余的，你的想法还不错。Eric Melski 的想法是一个不错的尝试，但它接受了很多非字母字符。例如，`foo[1]`、`&foo`、或。有一个更好的选择：. 这将接受，但实际上没关系 - foo::bar 在 XML 中是允许的。`*foo``foo=0``foo,bar``{using namespace name;}``foo::bar`

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-03-30T23:30:40.863

我认为你的想法可能会奏效。有效的 C++ 标识符由 AZ、az、0-9 和下划线组成，这实际上是 XML 标识符的一个适当子集（将连字符、句点和一堆 Unicode 字符添加到集合中）。

您可以尝试这样的构造来获得编译时错误：

```
#define SAFE_BOOST_SERIALIZATION_NVP(name) \
    { int name = 0; } ; BOOST_SERIALZATION_NVP(name) 
```

大括号将虚拟变量的范围限制为仅该行，因此您不会将函数与虚假变量混淆。可能编译器也优化了虚拟变量，因此没有运行时成本。当我在以下代码中使用此宏时，我得到`error: invalid intializer`：

```
#include "boost/serialization/nvp.hpp"
#define SAFE_BOOST_SERIALIZATION_NVP(name) \
    { int name = 0; } ; BOOST_SERIALIZATION_NVP(name)

int main(int argc, char *argv[])
{
    int foo[3] = { 10, 20, 30 };
    int bar = 10;
    SAFE_BOOST_SERIALIZATION_NVP(foo[0]);
    return 0;
} 
```

如果我在对 的调用中替换为`foo[0]`，它将编译没有错误。`bar``SAFE_BOOST_SERIALIZATION_NVP`

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2014-09-01T09:10:40.397

在 C++11 中，您可以执行以下操作：

```
 #define SAFE_BOOST_SERIALIZATION_NVP(name) \
        ([](){struct name{};}(), BOOST_SERIALIZATION_NVP(name)) 
```

这将强制名称成为有效的 XML，因为它强制它成为有效的 C++ 名称（我认为它是所有有效 XML 标记的子集）。

* * *

**更新**：下面的解决方案实际上是个坏建议，因为您不能再链接连接序列化变量 ( `ar & NVP(a) & NVP(b);`)。宏观解决方案可能仍然可行，但并不简单。

* * *

这是两个答案之间的混合体，@Eric Melski（大部分是正确的——额外的代码必须在结尾`define`——但不完整的解决方案——一些被禁止的名称没有被“过滤”——）和@MSalters'大部分是正确的（——`using namespace`不能用于任意未声明的名称--)。

我建议使用`struct`：

```
#define SAFE_BOOST_SERIALIZATION_NVP(name) \
    BOOST_SERIALIZATION_NVP(name); {struct name{};} 
```

或更危险的：

```
#undef BOOST_SERIALIZATION_NVP
#define BOOST_SERIALIZATION_NVP(name)                              \
    boost::serialization::make_nvp(BOOST_PP_STRINGIZE(name), name); {struct name{};} 
```

不用说，这没有运行时成本。

# javascript - 我可以控制网络浏览器的加载图标吗？

> ID：694858
> 
> 赞同：3
> 
> 时间：2009-03-29T16:00:13.293
> 
> 标签：javascript, browser

我可以用 JavaScript 控制浏览器的加载状态吗？

即，我希望浏览器显示其本机“加载”动画，而不是页面中我自己的加载图标，而是在浏览器加载页面时出现的图标而不是图标。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-03-29T16:06:44.980

您可以让浏览器加载某些页面（例如在不可见的 iframe 中）

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-03-29T16:15:31.090

我曾经构建了一个页面，一旦页面加载，它就会进入无限循环的 AJAX 请求。它会发出 ajax 请求，更新页面上的内容，然后重复请求，等等。

我在页面加载时触发了大约 4-6 个循环，每个循环都会检索和更新主页上一次“拍卖”的状态。

它具有页面始终保持在“加载”状态的效果，即始终显示进度条并且在地址栏中显示加载动画。客户不希望这样，所以我在每个请求之间设置了 2 秒的间隔，但它可能对你有用。

# cobol - 富士通 COBOL 3.0

> ID：694864
> 
> 赞同：2
> 
> 时间：2009-03-29T16:07:01.827
> 
> 标签：cobol, cobol85

我是 Fujitsu COBOL 3.0 软件的新手。我尝试执行一个简单的程序。代码和错误如下。程序中的所有内容似乎都是正确的。谁能帮我吗？在这个软件中是否要遵循任何预标准？

示例 cobol 程序是：

```
IDENTIFICATION DIVISION.
PROGRAM-ID.  ShortestProgram.

PROCEDURE DIVISION.
DisplayPrompt.
    DISPLAY "I did it".
   STOP RUN. 
--------------------------------------------------------------------------------------
** DIAGNOSTIC MESSAGE ** (NOPRGMID)
C:\FSC\PCOBOL32\samples\SAMPLE6\SAMPLE7.COB 0: JMN1102I-S  IDENTIFICATION DIVISION HEADER IS MISSING. HEADER ASSUMED TO BE CODED.
C:\FSC\PCOBOL32\samples\SAMPLE6\SAMPLE7.COB 1: JMN1019I-W  INDICATOR AREA MUST CONTAIN '-','*','/','D',OR BLANK. A BLANK IS ASSUMED TO BE SPECIFIED.
C:\FSC\PCOBOL32\samples\SAMPLE6\SAMPLE7.COB 1: JMN1005I-W  CHARACTER STRING 'DENTIFICATION' MUST START IN AREA B. ASSUMED TO START IN AREA B.
C:\FSC\PCOBOL32\samples\SAMPLE6\SAMPLE7.COB 1: JMN1356I-W  INVALID WORD 'DENTIFICATION' IS SPECIFIED IN IDENTIFICATION DIVISION. IGNORED UNTIL NEXT PARAGRAPH OR DIVISION.
C:\FSC\PCOBOL32\samples\SAMPLE6\SAMPLE7.COB 2: JMN1019I-W  INDICATOR AREA MUST CONTAIN '-','*','/','D',OR BLANK. A BLANK IS ASSUMED TO BE SPECIFIED.
C:\FSC\PCOBOL32\samples\SAMPLE6\SAMPLE7.COB 2: JMN1005I-W  CHARACTER STRING 'ROGRAM-ID' MUST START IN AREA B. ASSUMED TO START IN AREA B.
C:\FSC\PCOBOL32\samples\SAMPLE6\SAMPLE7.COB 4: JMN1019I-W  INDICATOR AREA MUST CONTAIN '-','*','/','D',OR BLANK. A BLANK IS ASSUMED TO BE SPECIFIED.
C:\FSC\PCOBOL32\samples\SAMPLE6\SAMPLE7.COB 4: JMN1005I-W  CHARACTER STRING 'ROCEDURE' MUST START IN AREA B. ASSUMED TO START IN AREA B.
C:\FSC\PCOBOL32\samples\SAMPLE6\SAMPLE7.COB 6: JMN1004I-W  RESERVED WORD 'DISPLAY' MUST START IN AREA B. ASSUMED TO START IN AREA B.
C:\FSC\PCOBOL32\samples\SAMPLE6\SAMPLE7.COB 7: JMN1104I-S  PROGRAM-ID PARAGRAPH IS MISSING. PROGRAM-NAME GENERATED BY SYSTEM.
C:\FSC\PCOBOL32\samples\SAMPLE6\SAMPLE7.COB 7: JMN1004I-W  RESERVED WORD 'STOP' MUST START IN AREA B. ASSUMED TO START IN AREA B.
STATISTICS: HIGHEST SEVERITY CODE=S, PROGRAM UNIT=1 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-03-29T20:43:09.823

Shift everything over 7 columns so that IDENTIFICATION DIVISION starts in column 8 and all subsequent lines began in column 8 or greater.

There's also a compiler switch (can't remember off the top of my head) that allows you to start in col 1

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2009-03-29T17:58:55.240

警告（指区域 B）似乎建议您的代码应该从每行的第二列开始。这就是为什么它找到例如“DENTIFICATION”而不是“IDENTIFICATION”的原因。

我从未在 COBOL 中开发过，但我隐约记得第一列必须为空白，或者 * 表示注释：警告消息似乎表明 / - 和 D 也是有效值。

更新：谷歌建议 COBOL 编译器忽略前 6 列，并且第 7 列具有特殊意义（D 表示调试，* 表示注释，...）。尽管行为可能是特定于编译器的。所以我怀疑你的问题是你的代码从第 7 列开始，它应该是第 8 列。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-03-29T17:26:56.457

Taking a WAG (wild-ass guess) here. Haven't cobol'd since my last year of college.

Your error message says, at the bottom,

```
STATISTICS: HIGHEST SEVERITY CODE=S, PROGRAM UNIT=1 
```

Okay, so I figure you have some warnings (possibly CODE=W), and one or more errors that are actually causing your program to fail.

So, scanning the error message, I see lots of W-s, and one line with an S:

> C:\FSC\PCOBOL32\samples\SAMPLE6\SAMPLE7.COB 7: JMN1104I-S PROGRAM-ID PARAGRAPH IS MISSING. PROGRAM-NAME GENERATED BY SYSTEM.

So it seems you're missing your Program-ID paragraph. Looking at your program, I do see a n identification division, which has a program-id.

I can conclude four things from this:
1) Your identification division paragraph is malformed
2) As Neil said, you aren't running your snippet, but a sample that does not have an ID paragraph. Open sample7.cob and see
3) Some other issue is causing the error, but it is being hidden or misinterpreted as an ID paragraph error

# wpf - 在描述性触摸下显示 WPF 控件的 Tooltip

> ID：694867
> 
> 赞同：0
> 
> 时间：2009-03-29T16:09:27.297
> 
> 标签：wpf, xaml

我有一个窗口，上面有许多控件，每个控件都有一个相关的工具提示。为了使窗口更加生动，我覆盖了一些半透明的椭圆，使整个窗口具有光泽，但是，在某些情况下，这些椭圆的位置会阻止命中测试进入我的控件。

我怎样才能让椭圆可见，但从命中测试的角度来看是透明的？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2009-03-29T16:10:37.590

IsHitTestVisible = 假

# windows - “Spy++ 在消息钩子中遇到问题”

> ID：694869
> 
> 赞同：4
> 
> 时间：2009-03-29T16:11:16.030
> 
> 标签：windows, winforms, winapi, spy++

我正在深入解决一些 Windows API 消息传递问题，我发现 Spy++ 不再工作了。它甚至不适用于记事本。在某些情况下，它会显示以下消息：

> ```
> ---------------------------
> Microsoft Spy++
> ---------------------------
> Spy++ has encountered a problem in the message hook. To prevent 
> 
> hanging the system, the hook has been disabled, so no further 
> 
> messages will be logged.Please restart Spy++ to re-enable 
> 
> message logging.
> ---------------------------
> OK   
> --------------------------- 
> ```

发生这种情况的任何已知原因？

**编辑：**只是想知道：这可能是由于我的防病毒软件或 Windows 更新造成的吗？或者其他一些使用消息挂钩的程序？

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2009-03-29T16:18:51.067

我不知道具体的错误，但如果 Spy++ 行为不端，可能值得尝试[Winspector](http://www.softpedia.com/get/Security/Security-Related/Winspector.shtml)。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-03-29T16:31:55.590

我有时会遇到安装全局钩子并且不能正常使用 spy++ 的其他程序的问题，请尝试停止所有不需要调试的程序。尝试重新启动机器以确保安全。

在pass中也经常发生尝试用VS和spy++调试导致整机挂掉的情况。更好的方法是在完全干净的机器上使用远程调试，以确保我不会受到其他程序的任何干扰（虚拟机可以很好地应对这种情况）。

正如 Neil 所说，Winspector 使用不同的挂钩机制，并且可能在 spy++ 失败的情况下工作，尽管有时消息日志太好了（至少对我来说）。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-04-20T18:31:05.597

我遇到了这个确切的问题，我必须卸载 McAfee 病毒防护并重新启动，然后 Spy++ 才能工作。

# debugging - 你曾经工作过的最具挑战性的开发环境是什么？你做了什么来克服这些限制？

> ID：694878
> 
> 赞同：2
> 
> 时间：2009-03-29T16:21:02.527
> 
> 标签：debugging, development-environment

我所说的“具有挑战性的开发环境”并不是说你在一艘上下摇晃的小船上，有人拿着枪指着你的头。我的意思是，您可以使用的工具是否使问题变得困难？

开发通常是一个循环的代码，运行，观察结果，重复。在某些环境中，这是一个非常快速且无痛的过程，但在其他环境中，这是非常困难的。我们最终使用了一些小技巧来帮助我们观察结果并更快地运行代码。

我之所以想到这个，是因为我刚开始使用 SSIS（SQL Server 2005/8 中包含的[ETL工具）。](http://en.wikipedia.org/wiki/Etl)取得进展对我来说非常具有挑战性，主要是因为没有关于所有对话框含义的指导，还因为错误非常神秘，而且大多数时候并没有真正告诉你问题是什么。

我认为我必须使用的最简单的环境是 VB6，因为您可以在应用程序运行时编辑代码，并且它将继续使用您的新代码运行！您甚至不必再次运行它。这可以为您节省大量时间。令人惊讶的是，在带有 Java 代码的 Netbeans 中，您也可以这样做。它退出该方法并使用新代码重新运行该方法。

在 SQL Server 2000 中，当触发器中出现错误时，您不会获得堆栈跟踪，这使得定位问题发生的位置变得非常棘手，因为插入可以产生级联效应并触发许多触发器。在 Oracle 中，您会得到一个非常漂亮的带有行号的小堆栈跟踪，因此解决问题非常容易。

我看到的一些事情确实有助于定位问题：

1.  出现问题时的良好错误消息。
2.  出现问题时提供堆栈跟踪。
3.  可以暂停的调试环境，然后输出变量的值并按照执行路径执行步骤。
4.  一个图形化的调试环境，在代码运行时显示代码。
5.  一个屏幕，可以显示变量的当前值，以便您可以打印到它们。
6.  能够在生产系统上打开调试日志记录。

你见过的最糟糕的情况是什么，可以做些什么来绕过这些限制？

编辑

我真的不打算让这成为火焰诱饵。我真的只是在寻找改进系统的想法，这样如果我正在创造一些东西，我会考虑这些东西，而不是为人们的问题做出贡献。我也在寻找解决这些限制的创造性方法，如果我发现自己处于这个位置，我可以使用这些方法。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2009-03-29T16:35:25.783

我正在为客户修改[Magento](http://magentocommerce.com)。关于 Magento 系统如何组织的信息很少。有数百个文件夹和文件，至少有上千个视图文件。Magento 论坛提供的支持很少，我怀疑缺少信息的主要原因是 Magento 的创建者希望您付费让他们成为经过认证的 Magento 开发人员。另外，去年那个时候还没有 StackOverflow :)

我的第一个任务是弄清楚数据库模式是如何工作的，以及哪个表存储了我正在寻找的一些属性。Magento 中有超过 300 个表，我不知道 SQL 查询是如何完成的。所以我只有一个选择...

*   我使用 PhpMyAdmin 将整个数据库（300 多个表和至少 20,000 行 SQL 代码）导出到一个 .sql 文件中，然后我将该文件“提交”到 subversion 存储库中。然后，我使用 Magento 管理面板对数据库进行了一些更改，并重新下载了 .sql 文件。然后，我使用 TortioseSvn 运行 DIFF，并滚动浏览 20k+ 行文件以查找哪些行已更改，哈哈。听起来很疯狂，但它确实有效，我能够弄清楚我需要访问哪些表。

*   我的第二个问题是，由于疯狂的目录结构，我不得不同时 ftp 到大约 3 个文件夹以进行微不足道的更改。所以我不得不打开我的 ftp 程序的 3 个窗口，每次都在它们和 ftp 之间切换。

*   第三个问题是弄清楚 url 映射是如何工作的，以及我想要的一些代码存储在哪里。在这里，幸运的是，我设法找到了我正在寻找的模型类。

主要是靠运气和其他类似的疯狂冒险，我设法完成并完成了这个项目。从那时起，StackOverflow 就开始了，通过对[这个赏金问题](https://stackoverflow.com/questions/576908/how-does-magento-code-work)的有用回答，我终于能够获得有关 Magento 的足够信息，以便我可以以一种不那么疯狂的方式（希望如此）来完成未来的项目。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2009-03-30T19:28:13.380

尝试在 Fortran 中用 IBM JCL（作业控制语言）完成你的卡片组，将它交给数据中心窗口，第二天早上回来，得到一英寸厚的打印纸，上面有你崩溃的十六进制转储，以及您帐户的费用清单。

在你的指甲上长出头发。

我想这是对坐在控制台前、切换开关和阅读灯光的先前方法的改进。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2009-03-30T19:21:33.347

早在 90 年代，我正在使用 Clipper（一种可编译的类似 dBase 的语言）开发应用程序。我不记得它是否带有调试器，我们经常使用名为“Mr Debug”的第 3 方调试器（真的！）。尽管 Clipper 很快，但我们的一些更密集的例程是用 C 编写的。如果您向正确的神祈祷并说出必要的咒语，您可以使用 Microsoft 的 CodeView 调试器来调试 C 代码。但通常不会超过几分钟，因为程序通常不喜欢花太多时间在 CodeView 上运行（通常是内存问题）。

我有一系列 makefile 开关，我用它们来存根我当时不需要调试的代码部分。我的调试环境非常稀疏，因此程序有尽可能多的可用内存。我也觉得我当时喝多了...

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2009-03-30T20:03:09.927

Some years ago I reverse engineered game copy protections. Because the protections was written in C or C++ they were fairly easy to disassemble and understand what was going on. But in some cases it got hairy when the copy protection took a detour into the kernel to obfuscate what was happening. A few of them also started to use of custom made virtual machines to make the problem less understandable. I spent hours writing hooks and debuggers to be able to trace into them. The environment really offered a competetive and innovative mind. I had everything at my disposal save time. Misstakes caused reboots and very little feedback what went wrong. I realized thinking before acting is often a better solution.

Today I dispise debuggers. If the problem is in code visible to me I find it easiest to use verbose logging. (Sometimes the error is not understanding the interface/environment then debuggers are good.) I have also realized time is of an essance. You need to have a good working environment with possibility to test your code instantly. If you compiler takes 15 sec, your environment takes 20 sec to update or your caches takes 5 minutes to clear find another way to test your code. Progress keeps me motivated and without a good working environment I get bored, angry and frustrated.

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2009-03-29T16:33:39.283

出现在 400x 晶片机网络上。由于只有一台晶片机可以输出到控制台调试是一场噩梦。必须在 Sun 网络上构建测试工具。

* * *

## 回答 #6

> 赞同：1
> 
> 时间：2009-03-29T16:36:02.553

我有一次上过一门课，那是松散地基于[SICP](http://mitpress.mit.edu/sicp/)的，除了它是在 Dylan 而不是 Scheme 中教授的。实际上，它是在旧的 Dylan 语法中，基于 Scheme 的前缀语法。但是因为那个旧版本的迪伦没有翻译，教授写了一个。在爪哇。作为一个小程序。这意味着它无法访问文件系统；您必须在单独的文本编辑器中编写所有代码，然后将其粘贴到 Dylan 解释器中。哦，当然，它没有调试工具。作为一个用 Java 编写的 Dylan 解释器，那是在 2000 年，它非常慢。

涉及打印语句调试、大量复制和粘贴，以及对解释器的大量诅咒。

* * *

## 回答 #7

> 赞同：0
> 
> 时间：2009-03-29T16:28:48.140

最近记忆中最糟糕的是使用 Dundas 控件开发 SSRS 报告。我们对需要编码的网格做了很多工作。痛苦是控件的错误，以及缺乏调试支持。

我从来没有绕过这些限制，但只是克服了它们。

* * *

## 回答 #8

> 赞同：0
> 
> 时间：2009-03-29T16:33:26.443

我的上一份工作是 Sitecore 开发人员。如果错误仅发生在客户端的系统上，并且他们没有在系统上安装 Visual Studio，远程调试关闭，并且问题仅发生在生产服务器（而不是暂存服务器）上，那么修复错误可能会非常痛苦。

# .net - 检查注册表值是否存在 Visual C++ 2005

> ID：694884
> 
> 赞同：2
> 
> 时间：2009-03-29T16:24:53.797
> 
> 标签：.net, c++, registry, visual-c++-2005

我试图编写一个 Visual C++ 2005 例程来检查注册表中的某些键/值。我在使用 c# 编写代码时没有问题，但我需要在 C++ 中使用它。任何人都知道如何在 vs2005 中使用 c++ 来做到这一点。

非常感谢托尼

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2009-03-29T16:34:57.580

**这是一些用于检索以下内容的伪代码：**

1.  如果存在注册表项
2.  该注册表项的默认值是什么
3.  什么是字符串值
4.  什么是 DWORD 值

**示例代码：**

包含库依赖：Advapi32.lib

将以下内容放在您的 main 或您要读取值的位置：

```
HKEY hKey;
LONG lRes = RegOpenKeyExW(HKEY_LOCAL_MACHINE, L"SOFTWARE\\Perl", 0, KEY_READ, &hKey);
bool bExistsAndSuccess (lRes == ERROR_SUCCESS);
bool bDoesNotExistsSpecifically (lres == ERROR_FILE_NOT_FOUND);
std::wstring strValueOfBinDir;
std::wstring strKeyDefaultValue;
GetStringRegKey(hKey, L"BinDir", strValueOfBinDir, L"bad");
GetStringRegKey(hKey, L"", strKeyDefaultValue, L"bad"); 
```

* * *

将这些包装函数放在代码的顶部：

```
LONG GetDWORDRegKey(HKEY hKey, const std::wstring &strValueName, DWORD &nValue, DWORD nDefaultValue)
{
    nValue = nDefaultValue;
    DWORD dwBufferSize(sizeof(DWORD));
    DWORD nResult(0);
    LONG nError = ::RegQueryValueExW(hKey,
        strValueName.c_str(),
        0,
        NULL,
        reinterpret_cast<LPBYTE>(&nResult),
        &dwBufferSize);
    if (ERROR_SUCCESS == nError)
    {
        nValue = nResult;
    }
    return nError;
}

LONG GetBoolRegKey(HKEY hKey, const std::wstring &strValueName, bool &bValue, bool bDefaultValue)
{
    DWORD nDefValue((bDefaultValue) ? 1 : 0);
    DWORD nResult(nDefValue);
    LONG nError = GetDWORDRegKey(hKey, strValueName.c_str(), nResult, nDefValue);
    if (ERROR_SUCCESS == nError)
    {
        bValue = (nResult != 0) ? true : false;
    }
    return nError;
}

LONG GetStringRegKey(HKEY hKey, const std::wstring &strValueName, std::wstring &strValue, const std::wstring &strDefaultValue)
{
    strValue = strDefaultValue;
    WCHAR szBuffer[512];
    DWORD dwBufferSize = sizeof(szBuffer);
    ULONG nError;
    nError = RegQueryValueExW(hKey, strValueName.c_str(), 0, NULL, (LPBYTE)szBuffer, &dwBufferSize);
    if (ERROR_SUCCESS == nError)
    {
        strValue = szBuffer;
    }
    return nError;
} 
```

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2009-03-29T16:29:22.320

有可用的 Win32 API：看看 MSDN[`RegOpenKey`](http://msdn.microsoft.com/en-us/library/ms724895(VS.85).aspx)和朋友（以及一般的[注册表功能](http://msdn.microsoft.com/en-us/library/ms724895(VS.85).aspx)）。

[这是“使用子键删除键”](http://msdn.microsoft.com/en-us/library/ms724235(VS.85).aspx)的示例。

# iphone - 你如何复制一个CALayer？

> ID：694890
> 
> 赞同：11
> 
> 时间：2009-03-29T16:28:04.757
> 
> 标签：iphone, objective-c, core-animation, calayer

如何使 NSArray 充满 CALayer 的多个实例（都具有相同的框架、内容等）？

背景：创建 CALayer 需要一些开销，所以我想在一个类的 init 方法中创建一些 CALayer（都共享相同的属性）（稍后在该类中使用。）

* * *

## 回答 #1

> 赞同：25
> 
> 时间：2012-12-12T00:05:31.593

我没有`CALayer`专门尝试过这个，但我知道你可以利用以下优势执行深层复制`NSCoding`：

`CALayer *layer = [NSKeyedUnarchiver unarchiveObjectWithData:[NSKeyedArchiver archivedDataWithRootObject:layer]];`

不过，我不确定复制它们对性能有何帮助。

* * *

## 回答 #2

> 赞同：6
> 
> 时间：2009-03-29T22:46:10.417

CALayer 没有内置`-(id)copy`方法。我不确定为什么。然而，自己动手并不难。创建一个 CALayer 类别并编写自己的复制方法。您所要做的就是实例化并手动从原始版本中获取公共 ivars/属性并设置为新副本。别忘了打电话`[super copy]`

顺便说一句，CALayer 是一个对象。您可以将其添加到 NSArray。

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2015-03-02T10:19:29.757

尝试使用 CAReplicatorLayer。它可以复制您的图层。

参考：[https ://developer.apple.com/documentation/quartzcore/careplicatorlayer](https://developer.apple.com/documentation/quartzcore/careplicatorlayer)

示例代码：[http ://www.knowstack.com/swift-careplicatorlayer-sample-code/](http://www.knowstack.com/swift-careplicatorlayer-sample-code/) [https://developer.apple.com/documentation/quartzcore/careplicatorlayer/1522391-instancedelay](https://developer.apple.com/documentation/quartzcore/careplicatorlayer/1522391-instancedelay)

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2010-05-31T14:34:06.930

我在我的程序中做同样的事情。

在初始化中：

```
 self.turrets = [NSMutableArray array];
    for (count = 0; count < kMaxTurrets; count++)
        [self spawnTurret]; 
```

spawnTurret：

```
evTurret* aTurret = [[[evTurret alloc] init] autorelease];
CGImageRef theImage = [self turretContents];
aTurret.contents = theImage;
double imageHeight = CGImageGetHeight(theImage);
double imageWidth = CGImageGetWidth(theImage);
double turretSize = 0.06*(mapLayer.bounds.size.width + mapLayer.bounds.size.height)/2.0;
aTurret.bounds = CGRectMake(-turretSize*0.5, turretSize*0.5, turretSize*(imageWidth/imageHeight), turretSize);
aTurret.hidden = YES;
[mapLayer addSublayer:aTurret]; 
[self.turrets addObject:aTurret]; 
```

基本上，我只是反复创建 CALayer 对象。这将比复制它们更快，因为此方法只需要每个属性调用 1 次 CALayer，而不是复制它，这需要您读取属性然后另外设置它。我使用这种方法在大约 0.02 秒内生成了大约 500 个对象，所以它肯定很快。如果你真的需要更快的速度，你甚至可以缓存图像文件。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2016-11-21T23:56:00.993

NSProxy 就是因为这个原因。您所描述的是一种常见场景，并且可以从中派生出任意数量的设计模式。

Pro Objective-C Design Patterns for iOS 为您描述的问题提供了解决方案；阅读第 3 章：原型模式。这是一个摘要定义：

原型模式指定使用原型实例创建的对象类型，通过复制此实例来创建新对象

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2021-06-16T16:34:53.673

MaxGabriel 评分最高的答案的更新链接。

Objective-C

```
CALayer *layer1;
CALayer *layer2;

// Set up layer1's specifics.

layer2 = [NSKeyedUnarchiver unarchivedObjectOfClass:[CALayer class]
                                                            fromData:[NSKeyedArchiver archivedDataWithRootObject:layer1 requiringSecureCoding:NO error:nil] error:nil]; 
```

在斯威夫特。

```
let layer1: CALayer?
var layer2: CALayer? = nil
// Set up layer1's specifics

do {
    layer2 = try NSKeyedUnarchiver.unarchivedObject(
        ofClass: CALayer.self,
        from: try NSKeyedArchiver.archivedData(withRootObject: layer1, requiringSecureCoding: false))
} catch {
// It failed.  Do something. 
} 
```

# java - 对比

> ID：694897
> 
> 赞同：12
> 
> 时间：2009-03-29T16:30:15.920
> 
> 标签：java, generics

我偶然发现了一个看起来像这样的函数：

```
public void function(Class<?> clazz) {...} 
```

将方法更改为：

```
public <T> void function(Class<T> clazz) {...} 
```

编辑：什么是编译时间/运行时差异。

* * *

## 回答 #1

> 赞同：13
> 
> 时间：2009-03-29T17:02:09.293

使用 ”？” 与“any”相同，而“T”表示“特定类型”。因此，比较这些接口：

```
public interface StrictClass<T> {
 public T doFunction(Class<T> class);
}

public interface EasyClass<T> {
 public > doFunction(Class<?> class);
} 
```

现在，我们可以创建类：

```
public class MyStrictClass implements StrictClass<String> {
  public String doFunction(Class<String> stringClass) {
    //do something here that returns String
  }
}

public class MyEasyClass implements EasyClass<String> {
  public String doFunction(Class<?> anyClass) {
    //do something here that returns String
  }
} 
```

希望有帮助！

* * *

## 回答 #2

> 赞同：13
> 
> 时间：2009-03-29T22:33:34.503

todd.run 完全正确，但这只是答案的一半。`<T>`当您不向包含该方法的类添加类型参数时，还有一些用于选择`<?>`（反之亦然）的用例。例如，考虑之间的区别

```
public <E extends JLabel> boolean add(List<E> j) {
    boolean t = true;
    for (JLabel b : j) {
        if (b instanceof JLabel) {
            t = t && labels.add(b);
        }
    }
    return t;
} 
```

和

```
public boolean add(List<? extends JLabel> j) {
    boolean t = true;
    for (JLabel b : j) {
        if (b instanceof JLabel) {
            t = t && labels.add(b);
        }
    }
    return t;
} 
```

第一种方法实际上不会编译，除非您向封闭类添加适当的类型参数，而第二种方法将编译，无论封闭类是否具有类型参数。如果您不使用`<?>`，那么您在本地负责告诉编译器如何获取将由在其位置使用的字母填充的类型。你经常遇到这个问题——需要使用吗？而不是 T - 当尝试编写使用或需要“扩展”和“超级”的通用方法时。[Gilad Bracha 的泛型教程 (PDF)](http://java.sun.com/j2se/1.5/pdf/generics-tutorial.pdf)第 18 页对此问题进行了更好但更详细的处理。另请参阅[此堆栈溢出问题](https://stackoverflow.com/questions/695298/java-field-type-for-a-value-of-a-generically-recusive-self-type)，其答案阐明了这些问题。

查看此堆栈溢出链接以获取有关您的第二个问题的信息：[Java generics - type erasure - when and what happens](https://stackoverflow.com/questions/339699/java-generics-type-erasure-when-and-what-happens)。虽然我不知道您关于 和 之间的编译时间差异的问题的答案`<?>`，`<T>`但我很确定可以在埃里克森在那篇文章中提到的[这个常见问题解答中找到答案。](http://www.angelikalanger.com/GenericsFAQ/FAQSections/TechnicalDetails.html#FAQ001)

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2009-03-29T16:32:22.140

基本上，它们是等价的。您可以在不需要声明任何 T 类型的情况下使用第一种语法。

更新：哦，并且 T 可用于将类型绑定在一起：如果`Class<T>`在函数的不同部分使用，它将引用同一个类，但不是`Class<?>`.

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2009-03-30T12:16:30.547

一个很好的资源可能是：[http](http://sites.google.com/site/io/effective-java-reloaded) ://sites.google.com/site/io/effective-java-reloaded 与您的问题相关的有趣部分从第 5 分钟左右开始。只是沉迷于以前的用户所说的话。

希望有帮助:]

# naming-conventions - “墨盒”模式是否存在？

> ID：694898
> 
> 赞同：0
> 
> 时间：2009-03-29T16:31:50.113
> 
> 标签：naming-conventions, design-patterns

AndroMDA 使用术语“墨盒”（例如，用于开箱即用的 NHibernate 支持）。据我了解，它需要一个 API/组件，包装它，从不添加新功能，简化它，通常会带走“全部功能”，但适用于大多数情况。

我的问题：

*   这个词被广泛使用吗？

*   可以正确定义吗？

*   后缀“Cartridge”应该用在类/方法名中吗？

一个例子：下面的 Base64 助手是 Base64 转换的墨盒吗？您放弃了性能调整的所有功能，但如果您只是想解码一个简单（和小）的字符串，它可以正常工作：

用法：

```
 Base64StringCartridge.Decode(input); 
```

执行

```
public static string Decode(string data)
{
    try
    {
        System.Text.UTF8Encoding encoder = new System.Text.UTF8Encoding();
        System.Text.Decoder utf8Decode = encoder.GetDecoder();

        byte[] todecode_byte = System.Convert.FromBase64String(data);
        int charCount = utf8Decode.GetCharCount(todecode_byte, 0, todecode_byte.Length);
        char[] decoded_char = new char[charCount];
        utf8Decode.GetChars(todecode_byte, 0, todecode_byte.Length, decoded_char, 0);
        string result = new String(decoded_char);
        return result;
    }

    catch
    {
        return "";
    }
} 
```

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2009-03-29T16:37:29.413

它被称为[外观模式](http://en.wikipedia.org/wiki/Facade_pattern)。据推测，AndroMDA 的人是旧视频游戏机的忠实粉丝......

# mysql - 将 MySQL 服务器从一个机器迁移到另一个机器

> ID：694903
> 
> 赞同：8
> 
> 时间：2009-03-29T16:34:54.473
> 
> 标签：mysql, linux, migration

数据库非常大（> 400MB），因此 dump > SCP > source 被证明是数小时的工作。

有没有更简单的方法？我可以直接连接到数据库并从新服务器导入吗？

* * *

## 回答 #1

> 赞同：12
> 
> 时间：2009-03-29T16:37:24.983

您可以简单地复制整个 /data 文件夹。

看看[高性能 MySQL - 传输大文件](http://www.google.gr/url?sa=t&source=web&ct=res&cd=1&url=http%3A%2F%2Fbooks.google.gr%2Fbooks%3Fid%3DBL0NNoFPuAQC%26pg%3DPA603%26lpg%3DPA603%26dq%3Dhigh%2Bperformance%2Bmysql%2Bcopying%2Bfiles%26source%3Dbl%26ots%3DCNSRwtuF9Q%26sig%3D4fkpA8PM7TiJbmIbgpvULZvTPrs%26hl%3Den%26ei%3D66PPSa28HsmRsAb02cWmCA%26sa%3DX%26oi%3Dbook_result%26resnum%3D1%26ct%3Dresult&ei=66PPSa28HsmRsAb02cWmCA&usg=AFQjCNEpKiuhnclRiwcLxTQhBUqh1TZjPg&sig2=fl0IDG-DGhmBqhyrzTVogg)

* * *

## 回答 #2

> 赞同：6
> 
> 时间：2009-03-29T17:52:06.630

使用可以使用 ssh 直接通过 Internet 管道传输您的数据。首先为无密码登录设置 SSH 密钥。接下来，尝试这样的事情：

```
$ mysqldump -u db_user -p some_database | gzip | ssh someuser@newserver 'gzip -d | mysql -u db_user --password=db_pass some_database' 
```

笔记：

*   基本思想是您只是将标准输出直接转储到另一端的命令中，SSH 非常适合。
*   如果您不需要加密，那么您可以使用 netcat 但这可能不值得
*   SQL 文本数据通过网络压缩！
*   显然，更改`db_user`为用户用户和`some_database`您的数据库。`someuser`是 (Linux)**系统用户**，而不是 MySQL 用户。
*   您还必须使用`--password`很长的方法，因为有 mysql 提示您会很头疼。

* * *

## 回答 #3

> 赞同：4
> 
> 时间：2009-03-29T16:39:34.137

您可以设置一个 MySQL 从属复制并让 MySQL 复制数据，然后使从属成为新的主

* * *

## 回答 #4

> 赞同：2
> 
> 时间：2009-03-29T17:38:13.213

400M真的不算大数据库；通过 100Mbit 网络将其传输到另一台机器只需几分钟。如果你的机器之间没有 100M 的网络，你就有大麻烦了！

如果他们运行完全相同版本的 MySQL 并且具有相同（或类似 ENOUGH）的 my.cnf 并且您只想要整个数据的副本，则可以安全地复制服务器的整个数据目录（当两个实例都停止时，明显地）。当然，您首先需要删除目标机器的数据目录，但您可能并不关心这一点。

备份/恢复通常会因为恢复必须重建表结构而不是文件副本而减慢。通过直接复制数据文件，您可以避免这种情况（受上述限制）。

* * *

## 回答 #5

> 赞同：2
> 
> 时间：2009-03-29T20:59:13.903

如果要迁移服务器：

转储文件可能非常大，因此最好在发送之前对其进行压缩或使用 scp 的 -C 标志。我们传输文件的方法是创建一个完整的转储，在其中刷新增量日志（使用 --master-data=2 --flush 日志，请检查是否有任何从属主机）。然后我们复制转储并播放它。之后我们再次刷新日志（mysqladmin flush-logs），获取最近的增量日志（不应该很大）并只播放它。一直这样做，直到最后一个增量日志非常小，这样您就可以在原始机器上停止数据库，复制最后一个增量日志然后播放它 - 应该只需要几分钟。

如果您只想将数据从一台服务器复制到另一台服务器：

```
mysqldump -C --host=oldhost --user=xxx --database=yyy -p | mysql -C --host=newhost --user=aaa -p 
```

您需要正确设置数据库用户并提供对外部主机的访问。

* * *

## 回答 #6

> 赞同：1
> 
> 时间：2009-03-29T16:45:57.863

尝试使用 mysql 控制台而不是辅助软件在新服务器上导入转储

* * *

## 回答 #7

> 赞同：0
> 
> 时间：2009-03-29T16:38:33.217

我没有使用 mysql 执行此操作的经验，但对我来说，瓶颈似乎是传输实际数据？

4oo MB 不是*那么*多。但是如果转储-> SCP 很慢，我认为从删除框连接到数据库服务器不会更快吗？

我建议转储、压缩，然后通过网络复制或刻录到磁盘并手动传输数据。压缩这样的转储很可能会给您带来很好的压缩率，因为很可能存在大量重复数据。

* * *

## 回答 #8

> 赞同：0
> 
> 时间：2009-03-29T17:23:17.867

如果您只是复制服务器的所有数据库，请复制整个`/data`目录。

如果您只是复制一个或多个数据库并将它们添加到现有的 mysql 服务器：

1.  在新服务器中创建空数据库，设置用户权限等。
2.  将数据库的文件夹复制`/data/databasename`到新服务器`/data/databasename`

* * *

## 回答 #9

> 赞同：0
> 
> 时间：2013-12-11T14:08:58.947

我喜欢使用 BigDump：从旧服务器导出数据库后交错的 Mysql Dump Importer。

[http://www.ozerov.de/bigdump/](http://www.ozerov.de/bigdump/)

不过需要注意的一点是，如果您没有根据新服务器可以处理的负载设置导出选项（即创建的查询的最大长度），它只会失败，您将不得不使用不同的参数再次尝试。就个人而言，我将我的设置为大约 25,000，但这只是我。稍微测试一下，你就会掌握它的窍门。

# iphone - 通过延迟绘制的简单动画

> ID：694905
> 
> 赞同：2
> 
> 时间：2009-03-29T16:35:15.707
> 
> 标签：iphone, objective-c, quartz-2d

我正在尝试为我的 iPhone 应用程序实现一些非常简单的线条绘制动画。我想在延迟后在我的视图上绘制一个矩形。我正在使用`performSelector`运行我的绘图方法。

```
-(void) drawRowAndColumn: (id) rowAndColumn
{
    int rc = [rowAndColumn intValue];
    CGContextRef context = UIGraphicsGetCurrentContext();
    CGContextSetLineWidth(context, 2.0);
    CGContextSetStrokeColorWithColor(context, currentColor.CGColor);
    CGRect rect = CGRectMake(rc * 100, 100, 100, 100);
    CGContextAddRect(context, rect);
    CGContextDrawPath(context, kCGPathFillStroke);

} 
```

然后通过以下方式调用：

```
int col = 10;
[self performSelector:@selector(drawRowAndColumn:) 
           withObject:[NSNumber numberWithInt:col]
           afterDelay:0.2]; 
```

但似乎在`drawRowAndColumn:`实际发送消息时，它不再有权访问有效的`CGContextRef`，因为我收到以下错误：

```
<Error>: CGContextAddRect: invalid context 
```

如果我用`performSelector`直接调用替换`drawRowAndColumn`，它工作正常。所以我的第一个想法是也传递`CGContextRef`via `performSelector`，但我似乎无法弄清楚如何同时传递多个参数（这是另一个好问题。）

上面的代码有什么问题？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2009-03-29T17:12:47.753

你不能像那样在任何时候画画。您需要实现`drawRect:`UIView 的方法并将您的绘图代码放在那里。要`drawRect:`启动，您需要让 Cocoa 知道需要绘制视图。为此，您可以调用`setNeedsDisplay`, 或`setNeedsDisplayInRect:`。

以这种方式直接翻译您的尝试，您可以使用 performSelector:withObject:afterDelay 调用 setNeedsDisplay - 但这可能不是制作动画的好方法。

这取决于您真正想要做什么 - 但您可以考虑，例如，`drawRect`按照我的建议放入您的绘图代码，但开始隐藏视图。然后，您可以使用 performSelector 调用 setHidden:NO 使其在延迟后出现 - 或者您可以通过开始不隐藏但 alpha 为 0 来平滑地对其进行动画处理，然后在 UIView 动画块中将 alpha 更改为 1（有很多关于这在文档中）。

# c - 你如何制作内存和数据结构的图表？

> ID：694909
> 
> 赞同：7
> 
> 时间：2009-03-29T16:36:59.617
> 
> 标签：c, memory, diagram

我必须在 C 中创建一个操作字符串的短程序，但我总是遇到一些奇怪的指针错误。虽然 K&R 是该语言的一个很好的参考，当我感到困惑时，我经常看它，它已经假设你是一个合格的程序员。

教我们编程的讲师说好的程序员在这些东西上画出漂亮的图表，但我不知道怎么做。你能推荐一本关于这方面的好书或讲座吗？

谢谢，我会很感激我得到的每一个答案。

* * *

## 回答 #1

> 赞同：11
> 
> 时间：2009-03-29T17:51:28.753

我赞同首先在纸上绘制它们的建议，然后，如果您觉得需要，可以将它们的 ascii 版本包含到代码中。

我通常使用这三种格式：

* * *

推理记忆：

```
      +--------+
   0 | | <-开始
      +--------+
   1 | | <- q 从头到尾扫描
      +--------+
      ~~~~~
      +--------+
      | | <-结束
      +--------+ \
      | | |
      +--------+ |__ 其余的
      ~ ..... ~ | 分配的内存
  n | | |
      +--------+ /

```

* * *

推理字符串：

```
    0 n
   +--+-- --+--+--+--+
   | | ... | | |\0|
   +--+- --+--+--+--+
     ^ ^__ q 从
     | 从头到尾
     p 从
       从头到尾

```

* * *

推理单词中的位：

```
   xxxx yyzz 00tt 11ss
   \ \ \ \ \ \ \__ 存储注册表
    \ \ \ \ \ \___ 始终设置为 1
     \ \ \ \ \____温度值
      \ \ \ \______ 始终归零
       \ \ \________ 零标志值
        \ \_________ 你注册
         \_____________ x 地址            

```

* * *

我曾经也为有限状态机做过类似的事情，但它们往往太复杂（而且做起来很耗时），所以我现在直接将 graphviz 代码嵌入到注释中。即使不了解 GraphViz，也应该很容易猜出如何绘制 FSM 图。

```
有向图 G {
  模式 = 等级

  LIMBO [样式=填充]；
    节点[形状=椭圆]；

    LIMBO -> 标题；
    标题-> LIMBO；
    标题 -> 调谐；
    曲调->歌词；
    TUNE -> CHORD [style=dashed ];
    TUNE -> LIMBO ;
    恩典->调；
    恩典->和弦[风格=破折号]；
    符号 -> 曲调；
    符号 -> LIMBO ;

    重叠=假
  九月 = 1.5
}

```

* * *

这些涵盖了我需要的绝大多数图表。对于更复杂的，我使用 GraphViz 或 OpenOffice Draw。

* * *

## 回答 #2

> 赞同：8
> 
> 时间：2009-03-29T17:07:36.987

我曾经做过的最有用的事情之一就是我的应用程序绘制图表......

在具有专门用于该工作的复杂数据结构的应用程序中（标准哈希表在这种情况下没有做;-) 我让我的应用程序输出一个“.dot”脚本，[graphviz](http://www.graphviz.org/)的点工具可以解析。

它通过一个输出 .dot 标头的转储例程（好吧，方法，它是 C++）来做到这一点

```
 digraph g { 
```

然后走我的数据结构，然后写页脚

```
 } 
```

在结构行走中，它写了每个指针

```
 SOURCE -> DESTINATION 
```

其中 Source 是以 O (O213435354) 开头的引用对象的内存地址，Destination 是以相同格式指向的对象。

在每个对象的开头它还写了

```
SOURCE [ .... ] 
```

其中 ... 是对象数据。

每当应用程序处于“有趣”状态时，我都会转储图形，然后使用 graphviz 中的点工具将其可视化。这样我就很容易发现很多指针错误，眼睛是为了看到行中的规则结构......

顺便说一句，我仍然经常使用[graphviz](http://www.graphviz.org/)，因为使用文本编辑器编写和编辑图形并让工具随后将它们可视化是非常好的。如果我需要为被 powerpoint 宠坏的观众修饰 .dot 图表，我会将它们加载到我的 Mac 上的[OmniGraffle中。](http://www.omnigroup.com/applications/OmniGraffle/)（而且我使用 PC 的同事认为我有一些绘制图表的超级英雄能力，因为通过这种组合，我生成图表的速度比他们使用 Visio 时快 10 倍）

* * *

## 回答 #3

> 赞同：7
> 
> 时间：2009-03-29T16:47:24.943

优秀的程序员不会制作“漂亮”的图表——他们会制作用于其目的的邋遢、难以辨认的图表。只需在任何可用的表面上写下您需要的内容。不要担心画出“正确”的形状——我的一位前同事曾经说过，如果你不能在一根烟的背面画出图表，那么图表方法就不值得了（香烟对于非英国人）数据包。

* * *

## 回答 #4

> 赞同：2
> 
> 时间：2009-03-29T16:50:34.903

C 的典型记忆模型是记忆是一组盒子；每个框为 1 字节宽。每个盒子都有一个十六进制地址。指针是一个包含地址的变量。

关于书籍/讲座，您正在寻找一本基本的计算机组织和体系结构书籍。

我用过这三本书；我通过“降低可理解性”来订购它们。经典是帕特森和轩尼诗的最后一部，但我觉得它的可读性最低。YMMV。

[http://www.amazon.com/Introduction-Computing-Systems-gates-beyond/dp/0072467509/ref=sr_1_1?ie=UTF8&s=books&qid=1238345302&sr=1-1](https://rads.stackoverflow.com/amzn/click/com/0072467509)

[http://www.amazon.com/Digital-Design-Computer-Architecture-Harris/dp/0123704979/ref=sr_1_6?ie=UTF8&s=books&qid=1238345245&sr=1-6](https://rads.stackoverflow.com/amzn/click/com/0123704979)

[http://www.amazon.com/Computer-Organization-Design-Fourth-Architecture/dp/0123744938/ref=sr_1_3?ie=UTF8&s=books&qid=1238345245&sr=1-3](https://rads.stackoverflow.com/amzn/click/com/0123744938)

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2009-03-29T16:41:57.017

您是否需要工具来帮助绘制图表，或者图表应该代表什么？我建议您只使用一张纸和铅笔来做任何事情，以尝试自己理解这一点；你不需要任何花哨的工具。

如果您想了解指针的工作原理以及图表的含义，我在谷歌搜索后发现[了这个讲义](http://fluid.stanford.edu/~fringer/teaching/operating_systems_03/handouts/lecture9.pdf)，看起来它可能是一个不错的教程。

* * *

## 回答 #6

> 赞同：1
> 
> 时间：2009-03-29T16:47:26.317

您可能想查看 Gustave Duartes 的[博客](http://duartes.org/gustavo/blog/)。在他的帖子中，他经常绘制记忆图等。他为此使用了 Visio，而我发现结果非常整洁。

* * *

## 回答 #7

> 赞同：1
> 
> 时间：2009-03-29T16:48:14.457

没有多少工具可以绘制您的教授所指的内存映射样式。

他试图传达的想法是，当你是 C 语言的初学者时，指针和数组的使用会让你很困惑。目的是什么？这两个指针指向同一个东西吗？每个索引引用的字符串数组的哪些单元格等？

有经验的程序员对此有一个心理印象。有经验，你也会。在那之前，你的想法是你可以在纸上画一些东西来理解这些东西，而不是把它们全都放在你的脑海里。

我同意 K&R 并不是一本教科书，因此没有这些视觉效果。

[您可以在我为 C 教程制作的幻灯片中](http://www.slideshare.net/udekel/introduction-to-pointers-and-memory-management-in-c)看到这些图表的示例

* * *

## 回答 #8

> 赞同：1
> 
> 时间：2009-03-29T17:26:40.667

如果您希望图表看起来不错，请使用一块方格纸（方形而不是图形）和一支像样的铅笔*。也可用于表示记忆单元、字符串中的字母等。如果你想同时保持臀部和方形，你甚至可以得到四边形鼹鼠。

*** 我喜欢 uni shalaku dx 0.5，因为它的侧面有进纸器按钮，因此您无需移动手柄即可获得更多铅。

* * *

## 回答 #9

> 赞同：1
> 
> 时间：2009-03-29T17:37:24.217

一种简单的方法是将内存绘制成一个巨大的“阶梯”。梯形图中的每个框代表内存中的一个地址。在框中键入数据，然后在其旁边键入地址。像这样的东西：

[http://cosketch.com/Saved/pe6sHGD0](http://cosketch.com/Saved/pe6sHGD0)

还要了解调试器的工作原理，它通常可以向您显示指针、变量等的内容。

* * *

## 回答 #10

> 赞同：1
> 
> 时间：2009-03-29T18:12:53.757

这仅适用于那些熟悉机器内部的人，但我使用的一个技巧是在我的图表中写一个“假”内存地址以使其看起来真实。我的意思是：

```
 .------.
 A  | 3FFC |
    '------'
    .------.
 B  |    7 |
    '------' 
```

猜猜哪个变量有指针，哪个有值？实际上，我通常会在 B 的框下方（或上方）写下地址以显示它在哪里。然后，我将编造另一个（非常不同的）假数字来表明 A 也位于某个地方。这在您刚开始时很有帮助。稍后，您会习惯所有这些指针的东西。

* * *

## 回答 #11

> 赞同：1
> 
> 时间：2009-03-29T18:43:17.380

可视化问题的最佳方法是调试代码。并专注于你的变量。它不仅可以让您深入了解您的代码，还可以让您绘制出您的讲师对您说的代码的精确图表。

# php - APC for windows 替代下载

> ID：694910
> 
> 赞同：8
> 
> 时间：2009-03-29T16:37:00.787
> 
> 标签：php, windows, installation, apc

我正在尝试在 Windows 上安装 APC，但网站[http://pecl4win.php.net/](http://pecl4win.php.net/)现在关闭了一段时间，并显示以下消息：

> pecl4win 构建盒暂时停止服务。我们正在准备一个新的构建系统。

有替代下载吗？或者任何人都可以分享他们的吗？

* * *

## 回答 #1

> 赞同：23
> 
> 时间：2009-07-19T10:48:52.090

**更新：**

我在下面的回答已过时，并且该`pierre`文件夹似乎已脱机。您现在可以使用[PECL :: Package Browser](https://pecl.php.net/packages.php)，例如：[PECL :: Package :: APC](https://pecl.php.net/package/APC)，其中列出了 DLL。

**老答案：**

我从[http://downloads.php.net/pierre/ 获得了适用于 Win32 的 APC（和其他一些 PECL 包）dll](http://downloads.php.net/pierre/)

不知道这个来源有多永久，不久前在某个论坛上找到它并添加了书签。

这是一个老问题，但我是通过谷歌搜索找到的，所以其他人也可以！

* * *

## 回答 #2

> 赞同：5
> 
> 时间：2011-11-17T00:48:47.530

[Win-Web-Dev](http://dev.freshsite.pl/php-accelerators/apc.html)提供最高 3.1.14 的版本。尽管它们没有我需要的“APC 3.1.9/PHP 5.3/Apache，线程安全，VC6”的确切配置。但他们还有其他几种可行的配置。

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2009-03-29T16:49:30.930

最新版本可以在[这里](http://downloads.php.net/pierre/)找到。

* * *

## 回答 #4

> 赞同：2
> 
> 时间：2009-07-25T07:19:16.250

[smautf 的链接已关闭，但您可以在http://downloads.php.net/pierre/](http://downloads.php.net/pierre/)中找到它的相同内容（APC 和另一个用于 Win 的构建）。我不知道它是多么永久，但截至 2009 年 7 月 25 日，它运行良好。

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2011-08-23T08:59:16.423

我从这里（截至 2011 年 8 月 23 日）获得了最新的 3.1.9 nts（iis 非线程安全），并在 Windows 2008 上使用 IIS 7 运行它：http: [//dev.freshsite.pl/download/file /details/apc-319-for-php-53-vc9-nts-win72008.html](http://dev.freshsite.pl/download/file/details/apc-319-for-php-53-vc9-nts-win72008.html)

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2011-08-03T16:29:02.997

[您可以在http://downloads.php.net/pierre/](http://downloads.php.net/pierre/)下载 php 扩展，然后下载扩展。有很多 APC 文件。

我只是下载`xampp-win32-1.7.4-VC6-installer.exe`，我下载`php_apc-3.1.5-5.3-vc6-x86.zip (2010-11-03 17:04 -0800)`，它的工作原理。

# c# - C# 中的窗口媒体播放器

> ID：694912
> 
> 赞同：0
> 
> 时间：2009-03-29T16:37:22.457
> 
> 标签：c#, .net, winforms

我正在构建一个音乐播放器，所以我选择使用 Window Media Player 的库：现在我卡住了，因为我希望在列表框中显示歌曲的名称并实时更改歌曲，但我不知道如何继续. 我存储文件夹中的歌曲，因此当音乐播放器从 Url 运行歌曲时选择。我给你看一个代码片段：

```
 private void PlaylistMidday(String folder, string extendsion)
   {
         string myPlaylist = "D:\\Music\\The_Chemical_Brothers-Do_It_Again-(US_CDM)-2007-SAW\\";
        ListView musicList = new ListView();

        WMPLib.IWMPPlaylist pl;

        WMPLib.IWMPPlaylistArray plItems;

        plItems = player1.playlistCollection.getByName(myPlaylist);

        if (plItems.count == 0)

            pl = player1.playlistCollection.newPlaylist(myPlaylist);

        else

            pl = plItems.Item(0);

        DirectoryInfo dir = new DirectoryInfo(folder);

        FileInfo[] files = dir.GetFiles(extendsion,  SearchOption.AllDirectories);

        foreach (FileInfo file in files)
        {

            string musicFile01 = file.FullName;

            string mName = file.Name;

            ListViewItem item = new ListViewItem(mName);

            musicList.Items.Add(item);

            WMPLib.IWMPMedia m1 = player1.newMedia(musicFile01);

            pl.appendItem(m1);

        }

        player1.currentPlaylist = pl;

        player1.Ctlcontrols.play();

   } 
```

在加载时，我决定播放“myPLaylist”的歌曲，所以我问你知道如何在列表框中显示我的播放列表中的歌曲，当我点击所选项目时，我会更改歌曲？

感谢您的支持。

很好的问候

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-03-29T17:08:25.330

`List<string>`您可以将它们添加到 a作为返回值，而不是将歌曲添加到播放列表。在加载事件中，您只需调用获取文件夹中媒体文件路径列表的方法，然后将它们添加到列表框中。

要更改正在播放的歌曲，您只需要添加`SelectedValueChanged/SelectedItemChanged`事件，在此事件中，获取当前在列表框中选择的文件路径，然后让 WMP 为您播放:)

```
 private void Form1_Load(object sender, EventArgs e)
        {

            List<string> str = GetListOfFiles(@"D:\Music\Bee Gees - Their Greatest Hits - The Record");
            listBox1.DataSource = str;
            listBox1.DisplayMember = "str";

        }

        private List<string> GetListOfFiles(string Folder)
        {
            DirectoryInfo dir = new DirectoryInfo(Folder);
            FileInfo[] files = dir.GetFiles("*.mp3", SearchOption.AllDirectories);
            List<string> str = new List<string>();
            foreach (FileInfo file in files)
            {                             
                str.Add(file.FullName);                   

            }
            return str;
        }

        private void listBox1_SelectedIndexChanged(object sender, EventArgs e)
        {
            string strSelected = listBox1.SelectedValue.ToString();
            MessageBox.Show(strSelected); //Just demo, you can add code that have WMP played this file here 
        } 
```

一个快速的解决方案。:)。不是很好，但它有效。帮助这个希望

# http - HTTP 代理缓存如何在提供身份和 gzip 编码资源之间做出决定？

> ID：694918
> 
> 赞同：7
> 
> 时间：2009-03-29T16:39:35.087
> 
> 标签：http, caching, proxy, reverse-proxy, content-encoding

HTTP 服务器使用内容协商来提供基于客户端`Accept-Encoding`标头的单个 URL 标识或 gzip 编码。

现在假设我们在客户端和 httpd 之间有一个像 squid 这样的代理缓存。

**如果代理已经缓存了 URL 的两种编码，它如何确定要服务哪个？**

非 gzip 实例（最初不与 一起提供`Vary`）可以提供给任何客户端，但编码实例（具有`Vary: Accept-Encoding`）只能发送给具有与`Accept-Encoding`原始请求中使用的相同标头值的客户端。

例如 Opera 发送`"deflate, gzip, x-gzip, identity, *;q=0"`但 IE8 发送`"gzip, deflate"`。根据规范，缓存不应该在两个浏览器之间共享内容编码的缓存。这是真的？

* * *

## 回答 #1

> 赞同：8
> 
> 时间：2009-03-29T17:28:16.047

首先，恕我直言，当实体确实因该标头（或不存在）而异时，不发送“Vary: Accept-Encoding”是不正确的。

[话虽如此，规范目前确实不允许向 Opera 提供缓存响应，因为 Vary 标头与HTTPbis 第 6 部分第 2.6 节](http://greenbytes.de/tech/webdav/draft-ietf-httpbis-p6-cache-06.html#rfc.section.2.6)中的定义不匹配。也许这是我们应该放宽缓存要求的领域（您可能需要跟进[IETF HTTP 邮件列表](http://greenbytes.de/tech/webdav/draft-ietf-httpbis-p6-cache-06.html#rfc.section.2.6)...

更新：原来这已经被标记为一个未解决的问题；我刚刚在我们的问题跟踪器中添加了一个问题，请参阅[问题 147](http://trac.tools.ietf.org/wg/httpbis/trac/ticket/147)。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2009-03-29T20:20:10.157

当然，朱利安是对的。教训：无论响应编码是什么，**总是`Vary: Accept-Encoding`在嗅探时发送。`Accept-Encoding`**

要回答我的问题，如果您错误地遗漏`Vary`了，如果代理收到未编码的响应（没有`Vary`），它可以简单地缓存并为每个后续请求返回它（忽略`Accept-Encoding`）。[鱿鱼这样做](http://wiki.squid-cache.org/KnowledgeBase/VaryNotCaching)。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2010-03-17T20:28:19.367

忽略 Vary 的一个大问题是，如果缓存接收到一个没有 Vary 的编码变体，那么它可能会发送它以响应其他请求，即使它们的 Accept-Encoding 指示客户端无法理解内容。

# .net - MS Access (MDB) 并发

> ID：694921
> 
> 赞同：36
> 
> 时间：2009-03-29T16:40:13.417
> 
> 标签：.net, database, ms-access, concurrency, ms-jet-ace

对于一个小型项目，我需要使用一个要求非常轻的简单数据库：很少的表，总共不超过几千条记录，2 或 3 个用户。我在.NET 环境中工作。

由于数据库服务器（即使是那些 Express 版本）在这种情况下似乎是一个巨大的矫枉过正，一个非常简单的 MDB 数据库可以满足大多数要求。但是，我担心并发性。我的想法是将 .mdb 文件放在网络共享上，让用户从基于 .NET 的客户端访问该文件。数据库主要针对只读操作，但用户有时也需要更新/删除记录。如果当时无法做到这一点（由于数据库被锁定或其他原因），我可以在客户端上保存更新并在以后处理它们。

问题本身涉及以下几点：

*   MDB 中如何处理并发读取？
*   MDB 中如何处理并发更新/删除？
*   是否有锁的概念以及如何在 .NET 应用程序中利用它？
*   将 MDB 文件放在网络共享上是好主意还是坏主意？

当我在 .NET 中工作时，我也很想知道如何检测任何并发问题并采取适当的措施。即，我应该捕获哪个异常以及您建议采取什么行动？

**编辑**：这可能是我对问题的错误描述，但大多数答案似乎都建议使用完整的数据库服务器。我确实了解安装服务器的区别和好处，并且实际上已经在 MSSQL 和 Oracle 上实施了相当数量的项目。但是，在这个问题中，我只关心 Access 及其并发问题，所以请不要建议使用数据库服务器。

谢谢你的帮助。

* * *

## 回答 #1

> 赞同：50
> 
> 时间：2009-12-22T02:16:54.860

这是一个古老的问题，但没有人真正回答过它。以下是问题：

1.  MDB 中如何处理并发读取？
2.  MDB 中如何处理并发更新/删除？
3.  是否有锁的概念以及如何在 .NET 应用程序中利用它？
4.  将 MDB 文件放在网络共享上是好主意还是坏主意？

前两个问题基本上可以用一个解释来回答。这里有一个关键警告：我在这里给出的答案是针对 Jet MDB（及其变体）的，并不完全适用于从 A2007 开始引入的新文件格式，即 ACCDB 格式。我还没有完全探讨从 ACE 中移除 Jet ULS 的影响，下面的一些评论可能会假设 Jet ULS 在引擎盖下。但是，对于很多事情，您可以将“LACCDB 文件”替换为“LDB 文件”，结果将是相同的。

### 1-2) 并发读取/更新/删除

Jet 数据库引擎通常被称为“文件服务器”数据库，因为没有服务器端恶魔管理服务器上的数据文件的 I/O。这意味着所有使用 Jet MDB 的客户端都在直接读取文件。

如果没有内置某种机制来处理对文件的并发访问，那当然是灾难的根源。

Jet 使用记录锁定文件，如果您的 MDB 是“MyFile.MDB”，则记录锁定文件将位于同一文件夹中并称为“MyFile.LDB”。LDB 文件记录了哪些 Jet ULS 用户打开了 MDB 文件、该用户从哪个工作站连接，以及协商并发问题所需的所有信息。

现在，对于那些开始研究客户端/服务器数据库引擎的人来说，这可能看起来很原始和危险，但是在开发 Jet 数据库引擎时，它的目的是用作小型工作组的桌面数据库引擎，并且它与 xBase 和 Paradox 等其他桌面数据库引擎竞争，它们都使用类似的锁定文件来管理来自多个客户端的数据文件的并发使用。

在 Jet 数据库文件中，锁定应用于数据页（在 Jet 4 中增加到 4K，而在 Jet 3.x 和之前的版本中，它们是 2K），或者如果数据表最初创建为使用记录级锁定。在 Jet 4 的早期，许多人发现记录级锁定非常缓慢，尤其是在使用悲观锁定时，因此许多 Access 开发人员除了页面级锁定之外从未使用过任何东西（@David Fenton 举手！）。

事实上，当使用乐观锁时，您可以避免悲观锁带来的大部分并发问题。

一些警告：

1.  从 DAO 中，记录级锁定不可用，并且您只能获得页面级锁定。

2.  从 DAO 中，有许多用于控制乐观/悲观锁定的选项，特别是 OpenRecordset 方法的 LockEdits 参数，但它也与 OpenRecordset 选项参数中指定的某些设置交互（例如，选项 dbReadOnly 不能与锁定编辑）。除了锁定之外，还有一致/不一致更新的选项，所有这些都可以与事务交互（例如，未提交事务中的更改不会对其他用户可见，因此不会与他们发生冲突，但它可以在所涉及的表上放置只读锁）。

从 ADO/OLEDB 中，这些 Jet 并发控制结构将映射到 ADO/OLEDB 中的相关函数和参数。由于我仅从 Access 使用 Jet，因此我仅通过 DAO 与其交互，因此我无法建议您如何使用 ADO/OLEDB 控制这些，但关键是 Jet 数据库引擎在访问它时提供对记录锁定的控制以编程方式（而不是通过 Access UI）——它只是更复杂。

### 3) 锁和.NET

除了您可能会使用 OLEDB 作为数据接口之外，我在这里无法提供任何建议，但关键是 db 引擎本身就存在锁定功能/控件，因此可能有一种方法可以通过OLEDB。不过，它可能并不漂亮，因为在我看来 OLEDB 是围绕客户端/服务器架构设计的，而 Jet 的基于文件的锁定可能无法以优雅的方式映射到它。

### 4) 网络共享上的 MDB

Jet 对任何网络连接中最轻微的故障都非常敏感。因此，低带宽网络会增加通过慢速连接打开的 Jet 数据库的脆弱性。

这是因为数据库文件的主要块必须通过线路拉到本地计算机的 RAM 进行处理。现在，许多人错误地声称整个 MDB 文件是通过网络传输的，或者整个表都是通过网络传输的。这不是真的。相反，Jet 首先请求索引（并且请求不超过完成查询所必需的），然后根据该结果确定需要哪些数据页面，然后仅提取这些页面。这是令人惊讶的高效和快速。

此外，Jet 进行了一些非常智能的缓存，这可能意味着第一个数据请求可能需要一段时间，但由于缓存，后续对相同数据的请求几乎是即时发生的。

现在，如果你没有很好地索引你的表，你最终可能会拉出整个表并进行全表扫描。同样，如果您基于不属于 Jet 的 SQL 方言的客户端函数的标准，您最终可能会拉取一个完整的表（排序，例如，Replace(MyField, "A", "Z") 可能会导致全表扫描）。但是这种事情对于客户端/服务器架构也将是低效的，因此正确索引事物并小心使用 UDF 或非 Jet 兼容函数只是常识模式设计。一般来说，对于客户端/服务器有效的相同操作将在 Jet 中有效（主要区别在于，对于 Jet，您最好使用持久连接，以避免重新创建 LDB 文件的开销，这很重要）。

要避免的另一件事是尝试通过 WiFi 连接使用 Jet 数据。我们都知道 WiFi 有多不可靠，它只是在尝试通过 WiFi 连接处理 Jet 数据时遇到麻烦。

底线：

如果您使用 MDB 作为数据存储来提供来自 Web 服务器的数据，则应将数据尽可能靠近 Web 服务器的 RAM。这意味着在可能的情况下，在连接到物理 Web 服务器的磁盘卷上。如果这是不可能的，您需要快速、可靠的 LAN 连接。如今，数据中心中的 GB LAN 非常普遍，我很乐意通过这种连接处理 Jet 数据。

对于共享使用，例如，运行 VB.NET 桌面应用程序的多个客户端工作站共享单个 Jet MDB 作为数据存储，将数据文件放在可靠的文件服务器上是非常安全的。在可能的情况下，最好将 Jet MDB 文件放在不具备多种用途的机器上（例如，运行 Exchange、SQL Server 并充当文件服务器和打印服务器的域控制器可能不是最佳位置） . 像 Exchange 这样的应用程序会严重干扰文件服务器的功能，我通常建议不要将 MDB 文件放在作为 Exchange 服务器的多任务服务器上，除非它的容量非常小。

其他注意事项：

1.  切勿尝试在复制的文件系统上分发 MDB，除非所有用户都使用相同的副本。也就是说，如果您有两台服务器在它们之间复制文件，甚至不要考虑从两台服务器编辑 MDB 文件。这几乎会立即损坏文件。

2.  我建议不要将任何 MDB 存储在通过本机 Microsoft SMB 网络提供服务的本机 Windows 文件系统以外的任何地方。这意味着没有 Novell、没有 Linux、没有 SAMBA。造成这种情况的关键原因是 Jet 显然在 Windows 文件系统中的某些低级锁定功能中存在低级挂钩，这些挂钩并未 100% 复制到其他文件系统上。现在，我对此非常保守，许多称职的 Access 开发人员报告了正确配置的 Novell 文件服务器的出色结果（通常需要进行一些记录锁定调整，尽管这些天可能不太相关 - 我不'甚至不知道 Novell 是否还存在！），以及运行 SAMBA 的基于 Linux 的文件服务器的出色性能。我对此持谨慎态度，并建议任何客户端反对它（这包括各种 SAN 设备，

3.  出于同样的原因，我永远不会在任何虚拟化文件系统上运行它们。但是，我有一个客户，她多年来一直在 Mac Air 上的 Parallels 下运行她的单用户 Access 应用程序，现在没有出现任何问题。但它是单用户的，所以锁定问题相对较小。

我不知道这是否回答了你的问题。这一切都基于我作为 Access 开发人员 13 年来经常使用 Jet 以及对唯一出版的关于 Jet 的书籍《Jet Database Engine Programmers Guide》（仅适用于 Jet 3.5）的研究。我没有提供任何真实的引用，但如果有人需要我所说的任何细节，我会尽可能地进行研究。

* * *

## 回答 #2

> 赞同：13
> 
> 时间：2009-03-30T00:32:52.577

多年来，我在 Access 中构建了十几个小型企业应用程序。大多数人一次最多有 10-20 个用户。数据库分为“应用程序”和“数据”数据库。性能不错，没有并发问题。自 Access 2000 SP2 以来，基本上不存在损坏。

有很多人说“永远不要使用 Access”——如果做得对（即由专业开发人员完成），Access 是一个相当不错的开发包，我已经过上了很好的生活。我的客户对我建造的东西非常满意。

* * *

## 回答 #3

> 赞同：11
> 
> 时间：2009-03-29T21:58:44.883

我编写了两个使用 Access 数据库的商业产品，从网络共享运行，通常最多可容纳 10 个用户。如果你不滥用它，那真的没有问题；但正如您所看到的，许多开发人员从未到达那里——而且由于其低端性质，有很多基于它的蹩脚黑客。对于一个产品，由于其他人详细描述的所有问题，我不得不重新设计应用程序；但是在我清理它之后，我在数百次安装中从未遇到过数据库完整性问题。

它的一大优势是单一文件数据库，易于备份、恢复和复制到您的笔记本电脑进行剖析。几乎所有的替代方案，包括 sqlite（尽管有些人不承认），都需要 DBA 时不时地给予某种形式的关注。

在大多数情况下，Access 默认为某些 DDL（例如架构更改）提供记录锁和文件锁。

但是微软基本上已经淘汰了它，你的一些同事会因为你使用它而嗤之以鼻。

（此时我通常会躲避并大喊“进来！！！”。）

* * *

## 回答 #4

> 赞同：4
> 
> 时间：2009-03-29T17:21:33.787

Access 是真正的桌面单用户解决方案。实际上，它的用户上限为“一”。

它也是一个本地引擎。也就是说，当您运行查询时，数据会通过网络拉到本地 JET 引擎进行处理。.ldb 文件放置在网络共享上以控制锁。

如果您使用服务器端引擎（MSSQL、MySQL、Sybase、'Orable 等），那么您将查询提交给处理它并将结果返回给您的引擎。锁是内部持有的。

这对性能、稳定性和数据完整性具有巨大影响。

如果您的用户决定按下重置按钮，则 Access 数据库很有可能被损坏，您必须删除 .ldb。

有了合适的数据库引擎（MSSQL、Sybase、'Orable：我不喜欢 MySQL 的备份），你也有合适的备份能力。除非您有一些出色的软件来备份正在使用的文件，否则您可能无法在 Access DB 中备份您的数据。

我特别提到了锁，因为数据库引擎可以比任何基于文件的系统更高效、更优雅地处理并发和事务。

我可以看到使用 Access 项目作为数据库引擎的前端，而不是投资于具有 Access 后端的完整客户端应用程序。

* * *

## 回答 #5

> 赞同：3
> 
> 时间：2009-03-29T20:41:59.437

我一直在使用 Access，或者更准确地说，Jet 作为一个非常小的私人网站的后端，该网站永远不会增长，因为它受到这个小国家的专业规模的限制。三年来，我没有遇到任何问题。用户不到 100 人，每天大约有 30 到 40 人使用它。这些表有几千条记录。

* * *

## 回答 #6

> 赞同：2
> 
> 时间：2009-03-29T16:52:02.890

我对 Access 没有太多经验，但此链接可能对您有用：

[http://office.microsoft.com/en-us/access/HP052408601033.aspx](http://office.microsoft.com/en-us/access/HP052408601033.aspx)

“您可以将整个 Access 数据库放在网络服务器上或共享文件夹中。这是最容易实现的方法。每个人都共享数据并使用相同的表单、报表、查询、宏和模块。如果您希望每个人都以相同的方式使用 Access 数据库，或者如果您不能支持用户创建自己的对象。”

“在共享模式下打开 Access 数据库文件 (.mdb) 时，Microsoft Access 还会在与数据库文件相同的文件夹中创建一个具有相同文件名（例如 Northwind.ldb）的锁定信息文件 (.ldb) . 这个锁定信息文件存储了数据库的每个共享用户的计算机名（如mypc）和安全名（如Admin）。Microsoft Access 使用此信息来控制并发。大多数情况下，Microsoft Access 会自动删除锁定信息最后一个用户关闭数据库文件时的文件。”

* * *

## 回答 #7

> 赞同：2
> 
> 时间：2009-03-29T21:57:29.910

Access 应该是多用户的 - 我认为 Microsoft 建议最多 4 或 5 个用户使用它，但实际上我建议您永远不要在有多个用户的情况下使用 Access 数据库，尽管如果您真的不这样做考虑到某些附带条件，没有两个或三个可以接受的选择。

我有过使用 Access 数据库后端的四五个系统的经验——所有这些系统都是从其他“开发人员”那里获得的——并且在所有情况下，我都将它们作为优先事项转移到 SQL Server 之后，需要任何即时更新和修复签订合同时——通常是在我能说服老板付账的时候。时间跨度通常是几个月，所以我看到它在几个不同的应用程序下并发运行了一段合理的时间。

实际上，如果系统没有很多并发插入/更新并且没有大量使用，它通常会很好地工作。根据我的经验，主要的实际问题是..

1.  它容易腐败——它就是这样。通常这不是什么大问题，因为打开文件并运行压缩和修复会解决问题，但良好的备份机制是绝对必要的。

2.  它很慢。每次我将系统升级到 SQL Server 时，我都会收到很多用户对系统加速的赞誉。

3.  由于 Access 将记录标记为已更新或已删除的方式，数据库文件膨胀。这进一步减慢了系统的速度，因为文件必须通过网络加载。因此，一些通常每天压缩数据的机制是必不可少的。

以上所有这些对于单用户系统来说都不是问题，因为引发这些问题的潜在问题不那么突出。

总而言之，我必须强调，我绝不会为任何多用户系统推荐 Access。但是，如果真的有太多，只要它是一个轻量级的应用程序并且您确实制定了备份和维护程序，您可能会侥幸逃脱。

* * *

## 回答 #8

> 赞同：1
> 
> 时间：2009-03-29T16:47:32.993

当使用网络共享时，我会使用启用网络的数据库（mysql/firebird/mssql）而不是访问。

对于您使用 Access 描述的情况不会有问题。

我在更具挑战性的情况下使用了 Access，这主要是在处理网站时，当 Access 未被滥用时，它确实不是数据库引擎那么糟糕。（不是在谈论表格和诸如表格和记录之类的东西）

当您一次从多个用户进行插入/更新/删除时，它会变得有点毛茸茸。这是您开始考虑真正的数据库引擎的地方。

此外，当您想要一个线程安全的低开销数据库时，您可以查看 vistadb（访问速度较慢，并不总是免费，100% .NET）

我认为访问使用具有某种排队机制的表级锁应该可以正常工作。如果您担心它，您可以随时对其进行模拟压力测试。

* * *

## 回答 #9

> 赞同：1
> 
> 时间：2009-03-29T17:19:22.307

我认为您可以在 .net 应用程序连接字符串中定义它。我搜索了 JET，访问和记录锁定

这是一个可能有帮助的[链接。](http://support.microsoft.com/kb/306435)

有关 Access 和 JET 如何获取数据的真实详细信息，请参阅已接受的答案。

* * *

## 回答 #10

> 赞同：1
> 
> 时间：2009-03-29T19:17:27.127

已经多次声明要使用真正的多用户、免费数据库平台。但其中一个原因尚未说明。原因是，有多少现有的、杂乱的、麻烦的、大型的 Access 数据库是从“几条记录，最多一两个用户”开始的？我敢说所有这些。

除非整个公司只有两三个员工，否则很有可能如果你开发了一个有用的软件，它最终会被超过原来的两三个用户使用，拥有超过原来的几千条记录, 并且将在多年来扩展到包括许多表格、更多表格和更多数据。房子建好后就不能再打地基了。今天打下坚实的基础，你就可以随心所欲地扩建房子。软件也一样。

* * *

## 回答 #11

> 赞同：-1
> 
> 时间：2009-03-29T18:36:14.307

请不要将 Access 用于多用户方案。

我刚刚经历了两周的痛苦，因为我的前任在一个项目中选择了 Access 作为后端。

具体原因：

*   没有 Linq-to-Access 这样的东西
*   Access 有许多怪癖，例如依赖于将参数添加到命令的顺序，这将花费您很长时间来调试
*   访问无法扩展
*   与使用 SQL Server 相比，数据库更新是一件苦差事

# c# - 如何猜测.NET中没有BOM的文件的编码？

> ID：694923
> 
> 赞同：6
> 
> 时间：2009-03-29T16:41:04.723
> 
> 标签：c#, .net, unicode, encoding, character-encoding

我在 .NET 中使用 StreamReader 类，如下所示：

```
using( StreamReader reader = new StreamReader( "c:\somefile.html", true ) {
    string filetext = reader.ReadToEnd();
} 
```

当文件有 BOM 时，这可以正常工作。我遇到了一个没有 BOM 的文件的问题 .. 基本上我是胡言乱语。当我指定 Encoding.Unicode 它工作正常，例如：

```
using( StreamReader reader = new StreamReader( "c:\somefile.html", Encoding.Unicode, false ) {
    string filetext = reader.ReadToEnd();
} 
```

所以，我需要把文件内容变成一个字符串。那么人们通常如何处理这个问题呢？我知道没有任何解决方案可以 100% 有效，但我想提高我的几率.. 显然有软件试图猜测（例如，记事本、浏览器等）。.NET 框架中是否有一种方法可以让我猜到？有人有一些他们想分享的代码吗？

更多背景：这个[问题](https://stackoverflow.com/questions/373081/how-can-i-best-guess-the-encoding-when-the-bom-byte-order-mark-is-missing)和我的差不多，但我在.NET 领域。这个问题让我找到了一个列出各种[编码检测](http://fredeaker.blogspot.com/2007/01/character-encoding-detection.html)库的博客，但没有一个在 .NET 中

* * *

## 回答 #1

> 赞同：8
> 
> 时间：2009-03-29T16:51:58.833

**库** [http://www.codeproject.com/KB/recipes/DetectEncoding.aspx](http://www.codeproject.com/KB/recipes/DetectEncoding.aspx)

[**也许是stackoverflow上的一个有用线程**](https://stackoverflow.com/questions/661717/c-cycle-through-encodings/673308#673308)

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2009-03-29T17:08:52.863

您应该阅读 Raymond Chen 的这篇文章。他详细介绍了程序如何猜测编码是什么（以及猜测带来的一些乐趣）。

*[记事本中的某些文件很奇怪](https://devblogs.microsoft.com/oldnewthing/20040324-00/?p=40093)*

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2011-06-20T20:16:01.720

[**我在普德**](http://code.google.com/p/ude/)（Pude ）的`C#`港口运气不错`Mozilla Universal Charset Detector`。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2009-03-29T16:47:37.360

UTF-8 的设计方式是不太可能使用 UTF-8 将文本以任意 8 位编码（如 latin1）解码为正确的 unicode。

所以最低限度的方法是这样的（伪代码，我不说.NET）：

尝试：u = some_text.decode("UTF-8") except UnicodeDecodeError: u = some_text.decode("most-likely-encoding")

对于最可能的编码，通常使用例如 latin1 或 cp1252 或其他。更复杂的方法可能会尝试并找到特定于语言的字符配对，但我不知道有什么东西可以作为库或类似的东西。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2009-03-29T16:54:51.260

不久前我用它来做类似的事情：

[http://www.conceptdevelopment.net/Localization/NCharDet/](http://www.conceptdevelopment.net/Localization/NCharDet/)

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2009-03-29T16:57:02.923

使用 Win32 的 IsTextUnicode。

在一般意义上，这是一个困难的问题。请参阅：http: [//blogs.msdn.com/oldnewthing/archive/2007/04/17/2158334.aspx](http://blogs.msdn.com/oldnewthing/archive/2007/04/17/2158334.aspx)。

* * *

## 回答 #7

> 赞同：0
> 
> 时间：2009-03-29T17:10:40.347

一种hacky技术可能是获取文本的MD5，然后解码文本并以各种编码重新编码，MD5'ing每个。如果一个匹配，你猜它是那个编码。

对于处理大量文件的东西来说，这显然太慢了，但对于像文本编辑器这样的东西，我可以看到它工作。

除此之外，从来自 Delphi SO 问题的[这篇文章](http://fredeaker.blogspot.com/2007/01/character-encoding-detection.html)中移植 Java 库或使用 IE MLang 功能将是一件很麻烦的事情。

* * *

## 回答 #8

> 赞同：0
> 
> 时间：2011-04-29T09:27:27.923

请参阅我对这个问题的（最近）回答（据我所知，等效）：[如何检测文本文件的编码/代码页](https://stackoverflow.com/questions/90838/how-can-i-detect-the-encoding-codepage-of-a-text-file/5830273#5830273)

它不会尝试猜测 MLang 和 NCharDet 等一系列可能的“国家”编码，而是假设您知道您可能遇到的非 unicode 文件类型。据我从您的问题中可以看出，它应该非常可靠地解决您的问题（不依赖于 MLang 的“黑匣子”）。

# database - 在数据库中存储复合模式（分层数据）

> ID：694927
> 
> 赞同：8
> 
> 时间：2009-03-29T16:42:15.423
> 
> 标签：database, hierarchical-data, modified-preorder-tree-t

在关系数据库中保存复合模式的“最佳实践”是什么？

我们一直在使用改进的预序树遍历。构建整个树非常快，但插入或删除新节点非常慢（所有左右值都需要调整）。查询一个节点的子节点也不容易而且很慢。

我们注意到的另一件事是，您确实必须确保树不会弄乱。您需要事务锁，否则左右值可能会损坏，修复损坏的左右树并非易事。

但是，Modified Preorder Tree Traversal 确实工作得很好，但我想知道是否有更好的选择。

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2009-03-29T17:08:09.747

虽然使用 MPTT 查找行的所有后代很快，但查找所有子代可能很慢。但是，您应该能够通过向`parent_id`表中添加一个记录（是的，冗余）行的父级的字段来解决此问题。那么搜索就变成了：

```
SELECT *
FROM tbl
WHERE parent_id = z 
```

是的，`parent_id`包含冗余信息，可能会使您的表非规范化——但由于任何插入/更新/删除都需要全局更改，因此保持`parent_id`最新并不需要额外支付太多费用。您也可以使用`level`记录行的垂直级别的字段，尽管实际上这在某些类型的转换下*更*可能发生变化（例如，将子树移动到树中的不同点）。

对于插入/更新繁重的工作负载，普通的旧链接到父表示（即只有`parent_id`没有`left_pos`or ）当然更快，但它可以有效回答的唯一查询是“查找 X 的父级”和“查找`right_pos`X的孩子。” 大多数工作负载涉及比写入更多的阅读，因此通常 MPTT 总体上更快 - 但也许在您的情况下，您需要考虑移动（“返回”）到链接到父级？

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-03-29T17:08:20.633

我听说在数据库中存储分层数据的最佳方法是使用字符串属性，其中内容是用冒号分隔的父级列表。

# c# - 您使用哪个 .NET Memcached 客户端，EnyimMemcached 与 BeITMemcached？

> ID：694928
> 
> 赞同：38
> 
> 时间：2009-03-29T16:43:26.560
> 
> 标签：c#, asp.net, caching, memcached

似乎**EnyimMemcached** ( [https://github.com/enyim/EnyimMemcached](https://github.com/enyim/EnyimMemcached) ) 和**BeITMemcached** ( [http://code.google.com/p/beitmemcached/](http://code.google.com/p/beitmemcached/) ) 都是流行的 .NET Memcached 库。两者都是正在开发中的相当活跃的项目，下载量超过一千次。试图找出使用哪一个，但发现了相互竞争的言论！我确实阅读了另一篇相关[文章](https://stackoverflow.com/questions/272989/which-memcached-client-library-should-i-use-for-net)，但在做出决定之前仍想询问更多人。

**EnyimMemcached**在其项目主页 ( [https://github.com/enyim/EnyimMemcached](https://github.com/enyim/EnyimMemcached) ) 上声称，

> 根据我们未公开的特制内部性能测试，我们是有史以来最快的 C# 客户端，使用负数的系统资源，无论是内存还是 CPU 时间

和

> 我们严格遵守 memcached 的协议规范：即使是 memcached 的人也会问我们他们是否不明白

虽然**BeITMemcached**在其项目 wiki 页面 ( [http://code.google.com/p/beitmemcached/wiki/Features](http://code.google.com/p/beitmemcached/wiki/Features) ) 上声称

> 我们已经对 BeIT Memcached 客户端进行了广泛的功能测试和性能测试，我们对它能够正常工作感到满意。当我们将性能与其他两个客户端（java 端口和[Enyim memcached 客户端](https://github.com/enyim/EnyimMemcached)）进行比较时，我们的客户端消耗的资源最少，性能最好。它也更严格地遵循 memcached 协议规范，拥有最多的 memcached 功能，并且实际代码大小仍然小得多。

因此，对于那些在这些或任何类似方面有经验的人，您选择使用哪个客户端，以及您可能为什么选择您选择的客户端？

谢谢，

射线。

* * *

## 回答 #1

> 赞同：19
> 
> 时间：2009-03-29T17:01:57.203

We tested both and found Enyim to perform the best for our expected usage scenario: many (but not millions) cached objects, and millions of cache-get requests (average web site concurrency load = 16-20 requests.)

Our performance factor was measuring the time from making the request to having the object initialized in memory on the calling server. Both libraries would have sustained the job, but the enyim client was preferred in our testing.

* * *

## 回答 #2

> 赞同：7
> 
> 时间：2011-03-14T16:56:50.537

There is a comparison between Enyim and BeIT at [sysdot.wordpress.com/2011/03/08/memcached-clients-which-ones-best/](http://sysdot.wordpress.com/2011/03/08/memcached-clients-which-ones-best/)

* * *

## 回答 #3

> 赞同：4
> 
> 时间：2010-12-14T15:27:27.417

Eniym client's Store() sometimes does not work correctly. It happens when key does not present in cache, for most cases after memcached service restart. This construction:

```
 T val = _client.Get<T>(key);
        if (val == null)
        {
            // ... filling val variable ...
            var result = _client.Store(StoreMode.Add, key, val);
            // ... result can be false, sometimes ...
        } 
```

works 50/50\. T entity is [Serializable].

* * *

## 回答 #4

> 赞同：3
> 
> 时间：2009-04-23T15:41:36.140

I have found Enyim to work the best. It is easy to use, reliable and fast :)

# asp.net - 使用 Url 重写器、Asp.Net 2 对子域进行本地测试

> ID：694947
> 
> 赞同：1
> 
> 时间：2009-03-29T16:53:52.120
> 
> 标签：asp.net, url-rewriting, asp.net-2.0

我正在使用 UrlRewriting.Net 在 Asp.Net 2 和 IIS 5.1（离线）和 IIS 6（在线）中进行 url 重写

该应用程序执行以下操作：

以下性质的 url：http: [//username.site.com](http://username.site.com)被重写为 [http://site.com/Default.aspx?user=username](http://site.com/Default.aspx?user=username)

这在网上完美运行。但是，我想知道我们如何离线测试它。

我尝试通过 IIS 将应用程序指向 127.0.0.1，然后将 username.site.com 放在主机文件中以指向 127.0.0.1 - 但它不起作用。

网站加载 - 但未生成查询字符串。

还尝试将 site.com -> 127.0.0.1 放入主机文件并访问 username.site.com。但在这种情况下，网站无法加载（未找到网站）

有任何想法吗？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2009-03-31T04:06:09.250

测试它的简单方法是编辑您的主机文件，以便 username.site.com 指向 127.0.0.1，但是您必须为要在每台 PC 上测试的每个用户执行此操作...

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-04-01T14:29:23.847

好的。

我设法让这个工作。如果您考虑一下，它很简单。我给自己弄了一个 DNS 服务器，将它安装在我的系统上，并将它配置为为我提供来自 127.0.0.1 的 site.com 页面

如果您想知道，我使用了来自[http://www.simpledns.com/的名为 SimpleDNS 的 DNS 服务器](http://www.simpledns.com/)

还有一个免费的 BIND DNS 服务器可从： [http ://oldwww.isc.org/sw/bind/view/?release=9.6.1b1&noframes=1](http://oldwww.isc.org/sw/bind/view/?release=9.6.1b1&noframes=1)

但这对我来说现在配置太多了。

# windows-vista - Screen capture and event with Vista UAC

> ID：694950
> 
> 赞同：2
> 
> 时间：2009-03-29T16:54:55.627
> 
> 标签：windows-vista, uac, capture

I'ved developed a c# application that captures screens using bitblt and sends keyboard and mouse events using calls to keybd_event and mouse_event.

According to Microsoft I needed to modify the app.manifest with: requestedExecutionLevel level="highestAvailable" uiAccess="true"

Sign the application and place it in a trusted location (program files).

I have done all of these to get the application to run under elevated priviledges under Vista but when UAC dialogs appear it does not capture those screens and the keyboard and mouse events do not reach the UAC dialog.

I am guess that UAC runs in a different desktop?? if so, how would i capture that? and how can i detect when the desktop switches to a UAC dialog in c#? or have i just missed a step?

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-03-29T17:09:07.980

UAC runs on the secure desktop, only trusted processes running on the system account are allowed to run in that context.

This is to prevent exactly what you are trying to achieve - processes spoofing or capturing user input.

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-03-29T17:07:40.980

You cannot. The UAC desktop is secure because it doesn't allow anyone to access it. To detect the desktop switch event, I would try to use [SENS](http://msdn.microsoft.com/en-us/library/aa383841(VS.85).aspx) or [WTSRegisterSessionNotification](http://msdn.microsoft.com/en-us/library/aa383841(VS.85).aspx). But it doesn't look very promising.

# eclipse - 如何跟踪 Eclipse 更新站点的下载？

> ID：694951
> 
> 赞同：3
> 
> 时间：2009-03-29T16:55:21.257
> 
> 标签：eclipse, analytics, update-site

我有一个通过 Eclipse 更新站点分发的插件。我想跟踪它被下载了多少次，最好是由谁下载。

对于我网站上的常规页面，我可以使用 Google 分析。但是，Eclipse 在更新站点时不使用任何 HTML。

当我无法访问托管 apache 时，有什么办法可以做到这一点？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2010-05-29T21:23:16.243

您可以做的一个肮脏的技巧是在您的 site.xml 中添加一个虚拟功能，该功能指向计数器页面而不是 .jar 文件。例如

```
<feature url="http://yourcountersite.com/counterpage.php" id="" version=""> 
  <category name="YourCategory"/> 
</feature> 
```

更新管理器在尝试从您的更新站点安装内容时将联系计数器页面，否则将忽略此功能。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-03-29T17:22:48.260

当您说更新站点时，您是指您自己的 URL 还是 Eclipse 存储库？

我想你真的需要访问底层服务器的日志。这样你就可以监控 eclipse 发起的任何类型的请求（我猜它只是一个标准的 HTTP 请求）

史蒂夫

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2009-03-30T04:14:07.850

AFAICT，您唯一的选择是使用 Web 服务器日志。我写[了这篇](http://blog.zvikico.com/2009/02/analyzing-eclipse-update-site-traffic-with-awstats.html)关于使用 AWSStats 跟踪更新站点下载的文章，但它需要一些服务器端调整。不过，这只是一次设置。之后，您可以通过其 Web 界面使用 AStats。

# flash - Is it possible to specify the display dimensions of a directly linked .swf?

> ID：694954
> 
> 赞同：2
> 
> 时间：2009-03-29T16:56:04.347
> 
> 标签：flash

Directly-linked .swf files, i.e not embedded in a web page, seem to render at 100% of the browser window size. Is it possible to specify in the .swf file itself dimensions for the .swf to display at?

Thanks all,

Richard.

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-04-06T09:28:23.007

在 AS2 中：

在第二帧添加以下代码（将第一帧留空，将代码放在第一帧可能会给您错误值）：

```
Stage.scaleMode = "noScale"; 
```

然后您可以使用以下命令访问舞台的宽度和高度：

```
var myWidth:Number = Stage.width;
var myHeight:Number = Stage.height; 
```

请注意，宽度和高度属性之前**没有下划线。**将您的整个影片放在根的单个影片剪辑中，并根据这些值设置它的相对大小。

让我知道这是否对你有用。[另外：请参阅我关于直接链接到 SWF 文件的缺点的](https://stackoverflow.com/questions/53989/linking-directly-to-a-swf-what-are-the-downsides/109016#109016)回答。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-03-29T19:53:18.490

You can stop the swf from scaling its content by choosing the [stage scale mode](http://livedocs.adobe.com/flash/9.0/ActionScriptLangRefV3/flash/display/Stage.html#scaleMode). I think what you're looking for is `stage.scaleMode = StageScaleMode.NO_SCALE`. Then, the swf will not scale at all and display at it's initial dimensions. The default, however, is StageScaleMode.SHOW_ALL.

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-03-29T17:08:19.043

The SWF will always be rendered at 100%, but if you're producing the swfs you can control the size of content within them.

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2009-03-29T17:30:52.297

Yes you can, with PHP you can use the function getimagesize() which works with SWF files and return its dimensions.

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2009-03-29T17:38:46.270

I don't think there is a way to cause the SWF to open with a given dimensions if you'll point your browser directly to the file ([http://www.mysite.com/somefile.swf](http://www.mysite.com/somefile.swf)). By doing that you tell the browser to do whatever it's default behavior when loading this file type (which can vary between browsers and computers).

# c - 夹板和测试覆盖率分析？

> ID：694967
> 
> 赞同：3
> 
> 时间：2009-03-29T17:05:12.887
> 
> 标签：c, unit-testing, static-analysis, splint

我正在寻找一种具有夹板成熟度的静态分析工具，该工具还可以对代码进行测试覆盖分析。例如，libfoo.c 中的所有非静态函数都应该存在于 libfoo.h 中，因此 libfoo.h 中的所有函数都应该有单元测试。

当然，这种行为需要某种粒度控制，但这将在静态分析工具的某种启动配置文件中定义。

我正在从事一个进展非常迅速的项目，每天都在添加各种东西，我希望找到一些有助于确保单元测试覆盖率保持足够的静态分析工具。它是一个庞大的、地理分布的团队，这意味着事情会 24/7 全天候提交，我需要每晚构建更智能。

我不需要它超级聪明，我只需要它在没有测试某些东西时破坏构建，除非它明确超出范围。

CCAN 正在研究类似的东西，但是在编写任何实质性内容之前还需要几个月的时间。我也需要一些成熟的东西。

提前感谢您提供任何宝石的链接。

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2009-03-30T05:12:58.130

GCC 文档将读者指向[gcov](http://gcc.gnu.org/onlinedocs/gcc/Gcov.html)进行代码覆盖分析。这篇 2005 年 Dobbs 博士关于[防御性编程](http://www.ddj.com/cpp/184401915)的文章包括对使用 gcov 的讨论。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-04-01T03:53:28.180

您可能有兴趣查看：[清理代码的最佳命令行工具是什么？](https://stackoverflow.com/questions/393208/what-is-the-best-command-line-tool-to-clean-up-code)我不知道它是否会有所帮助，但那里有很多很棒的建议。

# ironpython - Ironclad import error

> ID：694968
> 
> 赞同：0
> 
> 时间：2009-03-29T17:06:10.950
> 
> 标签：ironpython, ironclad

I am getting the following error when trying to import a C-Extension I need with irconclad. Is this related to my configuration or limitation in ironclad?

```
C:\devtools\ipython>ipy
IronPython 2.0 (2.0.0.0) on .NET 2.0.50727.3053
Type "help", "copyright", "credits" or "license" for more information.
>>> import ironclad
>>> ironclad.__version__
'0.8.1'
>>> import acm
Traceback (most recent call last):
  File "<stdin>", line 1, in <module>
  File "<string>", line 15, in load_module
  File "ironclad", line unknown, in LoadModule
  File "ironclad", line unknown, in Load
  File "ironclad", line unknown, in Invoke
  File "ironclad", line unknown, in Py_IsInitialized
NotImplementedError: called Py_IsInitialized -- stack is probably corrupt now 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-03-30T09:59:19.410

Ironclad 仍在进行中 - 它还不支持 Python C API 中的每个函数。开发人员在尝试使特定的扩展模块正常工作时会添加新的模块。

该消息看起来令人震惊，但我认为它提到的堆栈损坏不再准确 - 这是项目早期的保留。我认为 Py_IsInitialized 函数现在已经在 svn 中实现了，所以你可以尝试调试它们以制作新版本。（我不知道 acm 模块 - 它可能使用其他尚未实现的功能。）

您可能可以从[Ironclad 讨论组](http://groups.google.com/group/c-extensions-for-ironpython)获得更多帮助。我认为 Ironclad 的开发人员不会阅读 Stack Overflow，他们也不会期望在这里看到 Ironclad 的问题（尽管这是一个好兆头！）。

# java - 使用框架和 Java AWT

> ID：694971
> 
> 赞同：0
> 
> 时间：2009-03-29T17:07:18.687
> 
> 标签：java, layout, awt

我目前正在使用 AWT GUI 制作程序，但遇到了问题。我基本上想要屏幕左上角的图像，以及图像右侧的一列按钮。但这不是正在发生的事情。当我运行小程序时，我单击一个弹出窗口，上面写着“启动程序”，然后我想要的图片在小程序窗口本身中，而按钮列本身在另一个窗口中。这是它的样子：

![截屏](https://i.stack.imgur.com/pQboq.jpg)

有没有办法解决这个问题，使图像和按钮在同一个窗口中？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-03-29T17:09:03.020

是的。您正在创建一个框架，但您的图形不在框架内。没有代码就不能说太多，但是 java.sun.com 上的[AWT 教程](http://java.sun.com/developer/onlineTraining/awt/contents.html)在这方面还不错。

* * *

好吧，再多一点（我很久没用AWT了。）

这是您遇到的几个问题。框架是一种窗口——它想成为一个单独的窗口，有自己的关闭按钮等等。

当你创建你的图形时，你必须告诉它是它的父组件；您以某种方式将其作为Applet的父母。所以你有一些看起来像的代码

```
add(myComponent); 
```

在 Applet 的上下文中为`this`.

```
public class myApplet extends Applet {
   // lots of stuff here creating your canvas, putting the image in it
   // and so forth.  There's an example, see fn 1.
   // When you're done, you have a component, call it myImage.

   add(myImage);
} 
```

您有一个框架，并且您正在向其中添加按钮。

```
public class MyFrame extends Frame {

    add(new Button(...));
    add(new Button(...));

} 
```

您需要以某种方法将添加 Canvas 的代码移动到 Frame 类中。

（警告：这*不是*完整的 Java 代码，我不记得正确方法的名称。至少可能是 Applet 中的*init()方法。*

fn1。[http://java.sun.com/developer/onlineTraining/awt/contents.html#simpleexample](http://java.sun.com/developer/onlineTraining/awt/contents.html#simpleexample)

# algorithm - K 最近邻算法疑问

> ID：694982
> 
> 赞同：7
> 
> 时间：2009-03-29T17:09:25.687
> 
> 标签：algorithm, artificial-intelligence, knn

我是人工智能新手。我了解 K 最近邻算法以及如何实现它。但是，您如何计算不在秤上的物体的距离或重量？

例如，年龄的距离可以很容易地计算出来，但是如何计算红色与蓝色的距离？也许颜色是一个不好的例子，因为你仍然可以说使用频率。例如，从汉堡到比萨再到薯条怎么样？

我觉得有一种聪明的方法可以做到这一点。

预先感谢您的关注。

编辑：谢谢大家非常好的答案。它真的很有帮助，我很感激。但我认为必须有一条出路。

我可以这样做吗？假设我正在使用我的 KNN 算法对一个人进行预测，他/她是否会在我提供上述所有三种食物的餐厅用餐。当然，除了简单起见，还有其他因素，对于最喜欢的食物领域，在 300 人中，150 人喜欢汉堡，100 人喜欢披萨，50 人喜欢薯条。常识告诉我最喜欢的食物会影响人们是否吃的决定。

所以现在一个人输入他/她最喜欢的食物作为汉堡，我要预测他/她是否会在我的餐厅吃饭。忽略其他因素，并根据我（培训）以前的知识库，常识告诉我，与他进入比萨饼或薯条相比，这个特定领域最喜欢的食物的 k 最近邻居距离更近的可能性更高。

唯一的问题是我使用了概率，我可能错了，因为我不知道也可能无法计算实际距离。我也担心这个领域对我的预测施加太多/太少的权重，因为距离可能与其他因素（价格、一天中的时间、餐厅是否满员等我可以轻松量化）不成比例，但我猜想我可以通过一些参数调整来解决它。

哦，每个人都提出了一个很好的答案，但我只能接受一个。那样的话，我明天就接受得票最高的那个。再次感谢大家。

* * *

## 回答 #1

> 赞同：11
> 
> 时间：2009-03-30T12:58:30.727

将您为其收集数据的所有食物表示为“维度”（或表格中的列）。

为您可以收集数据的每个人记录“喜欢”，并将结果放在表格中：

```
          汉堡 | 披萨 | 薯条 | 墨西哥卷饼 | 喜欢我的食物
人1 1 | 0 | 1 | 1 | 1
人2 0 | 0 | 1 | 0 | 0
人3 1 | 1 | 0 | 1 | 1
人4 0 | 1 | 1 | 1 | 0

```

现在，给一个新人，有了他喜欢的一些食物的信息，您可以使用简单的度量来衡量与其他人的相似度，例如[Pearson 相关系数](http://en.wikipedia.org/wiki/Pearson_product-moment_correlation_coefficient)或[余弦相似度](http://en.wikipedia.org/wiki/Cosine_similarity)等。

现在你有办法找到 K 个最近的邻居并做出一些决定..

有关这方面的更多高级信息，请查找“协作过滤”（但我会警告您，它会变得数学化）。

* * *

## 回答 #2

> 赞同：7
> 
> 时间：2009-03-29T17:20:58.687

好吧，“最近”意味着您有一些指标可以衡量事物或多或少“遥远”。“burger”、“pizza”和“fries”的量化与其说是 KNN 问题，不如说是关于基本系统建模的问题。如果你有一个系统，你正在做分析，其中“汉堡”、“披萨”和“薯条”是术语，那么系统存在的原因将确定它们是如何量化的——就像你是试图弄清楚如何以给定的金额获得最好的味道和最少的卡路里，然后ta-da，你知道你的指标是什么。（当然，“最佳品味”是主观的，但这是另一组问题。）

这些术语不能具有内在的可量化性，从而告诉您如何设计分析系统；由您决定要完成的工作并从那里设计指标。

* * *

## 回答 #3

> 赞同：5
> 
> 时间：2009-03-29T17:15:45.327

这是人工智能中知识表示的问题之一。主观上起着很大的作用。例如，你和我会同意汉堡、比萨饼和薯条的“亲密度”吗？

您可能需要一个包含要比较的项目的查找矩阵。如果您可以假设传递性，则可以减少此矩阵，但我认为即使在您的示例中也不确定。

关键可能是尝试确定您要比较的功能。例如，如果您在比较健康方面的食品，您可能会得到更客观的结果。

* * *

## 回答 #4

> 赞同：2
> 
> 时间：2009-03-29T17:16:35.030

如果您查看[“集体智能”](https://rads.stackoverflow.com/amzn/click/com/0596529325)，您会发现它们分配了一个比例和一个值。这就是 Netflix 比较电影排名等的方式。

您必须通过提出该比例并为每个分配值来定义“接近度”。

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2009-03-30T12:36:34.693

我实际上会向用户展示这些属性对并要求他们定义他们的接近度。你会给他们呈现一个从[同义词..非常外国]或类似的尺度。让很多人这样做，您最终会得到一个广泛接受的非线性属性值的邻近函数。

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2009-03-29T17:17:38.210

没有“最好”的方法来做到这一点。最终，你需要想出一个任意的比例。

* * *

## 回答 #7

> 赞同：0
> 
> 时间：2009-03-30T12:43:25.770

很好的答案。你可以制定一个指标，或者像马拉奇建议的那样，问一些人。要真正做到正确，听起来您需要[贝叶斯分析](http://en.wikipedia.org/wiki/Bayesian_inference)。

# asp.net-mvc - 没有字段的 ModelState？

> ID：694985
> 
> 赞同：0
> 
> 时间：2009-03-29T17:10:44.683
> 
> 标签：asp.net-mvc, validation

我有一个这样的控制器动作：

```
[ActionName("Create"), AcceptVerbs(HttpVerbs.Post)]
public ActionResult Save([Bind(Exclude="Id")]Project project)
{
    try
    {
        _projectRepository.Save(project);
        return RedirectToAction("Details", new { id = project.Id });
    }
    catch (PropertyValueException ex)
    {
        ModelState.AddModelError(ex.PropertyName, ex.Message);
        return View();
    }
    catch (Exception ex)
    {
        ModelState.AddModelError("", ex);
        return View();
    }
} 
```

处理代码`PropertyValueException`工作正常：错误由 显示`Html.ValidationSummary`，错误正确显示在相关字段旁边。

使用第二个 catch 块，我试图迎合（例如）重复约束违规，并且我希望将异常显示在验证摘要中（它不能显示在特定字段旁边，因为我没有该信息）。它不起作用。

我究竟做错了什么？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2009-03-30T13:18:51.613

我不认为你做错了什么。请参阅我对这个问题的回答：[asp.net MVC - ValidationSummary not displayed](https://stackoverflow.com/questions/545941/asp-net-mvc-validationsummary-not-displaying)。我认为这是框架中的一个错误。********