# StackOverflow 问答 000294000-000294999

# c++ - 如何防止在托管 Internet Explorer 中打开新窗口

> ID：294007
> 
> 赞同：0
> 
> 时间：2008-11-16T15:40:24.417
> 
> 标签：c++, internet-explorer, atl, hosted

我在 CAxWindow ATL 类中托管一个 Internet Explorer 实例（Web 控件）。如何防止网站从托管的 IE 中打开新窗口？我已经设置了 IDocHostUIHandlerDispatch 的实现来禁用上下文菜单。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2008-11-16T16:49:09.317

WebBrowser ActiveX 控件上有一个事件，用于显示您需要侦听和取消的新窗口（NewWindow、NewWindow2、NewWindow3）。

# c++ - 优雅的对象比较

> ID：294009
> 
> 赞同：9
> 
> 时间：2008-11-16T15:41:42.480
> 
> 标签：c++, function, virtual

当比较两个对象（相同类型）时，有一个比较函数接受同一类的另一个实例是有意义的。如果我在基类中将其实现为虚函数，那么函数的签名也必须在派生类中引用基类。解决这个问题的优雅方法是什么？比较不应该是虚拟的吗？

```
class A
{
    A();
    ~A();
    virtual int Compare(A Other);
}

class B: A
{
    B();
    ~B();
    int Compare(A Other);
}

class C: A
{
    C();
    ~C();
    int Compare(A Other);
} 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2008-11-16T17:46:50.760

我会这样实现它：

```
class A{
    int a;

public:
    virtual int Compare(A *other);
};

class B : A{
    int b;

public:
    /*override*/ int Compare(A *other);
};

int A::Compare(A *other){
    if(!other)
        return 1; /* let's just say that non-null > null */

    if(a > other->a)
        return 1;

    if(a < other->a)
        return -1;

    return 0;
}

int B::Compare(A *other){
    int cmp = A::Compare(other);
    if(cmp)
        return cmp;

    B *b_other = dynamic_cast<B*>(other);
    if(!b_other)
        throw "Must be a B object";

    if(b > b_other->b)
        return 1;

    if(b < b_other->b)
        return -1;

    return 0;
} 
```

这与 .NET 中的模式非常相似`IComparable`，效果很好。

编辑：

对上述内容的一个警告是`a.Compare(b)`(where `a`is a and `b`is a B) 可能会返回相等，并且*永远不会*抛出异常，而`b.Compare(a)`会。有时这是你想要的，有时不是。如果不是，那么您可能不希望您的`Compare`函数是虚拟的，或者您希望比较`type_info`基`Compare`函数中的 s，如下所示：

```
int A::Compare(A *other){
    if(!other)
        return 1; /* let's just say that non-null > null */

    if(typeid(this) != typeid(other))
        throw "Must be the same type";

    if(a > other->a)
        return 1;

    if(a < other->a)
        return -1;

    return 0;
} 
```

请注意，派生类的`Compare`函数不需要更改，因为它们应该调用基类的`Compare`，`type_info`比较将在其中进行。但是，您可以`dynamic_cast`将覆盖`Compare`函数中的 替换为`static_cast`。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2008-11-16T18:11:12.617

可能，我会这样做：

```
class A
{
 public:
  virtual int Compare (const A& rhs) const
  {
    // do some comparisons
  }
};

class B
{
 public:
  virtual int Compare (const A& rhs) const
  {
    try
    {
      B& b = dynamic_cast<A&>(rhs)
      if (A::Compare(b) == /* equal */)
      {
        // do some comparisons
      }
      else
        return /* not equal */;
    }
    catch (std::bad_cast&)
    {
      return /* non-equal */
    }
  }
}; 
```

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2009-05-08T17:43:06.200

它取决于 A、B 和 C 的预期语义以及 compare() 的语义。比较是一个抽象概念，不一定有一个正确的含义（或任何含义，就此而言）。这个问题没有单一的正确答案。

这是两个场景，其中比较意味着具有相同类层次结构的两个完全不同的事物：

```
class Object 
{
    virtual int compare(const Object& ) = 0;
    float volume;
};

class Animal : Object 
{
    virtual int compare(const Object& );
    float age;
};

class Zebra  : Animal 
{
    int compare(const Object& );
}; 
```

我们可以考虑（至少）两种比较两个斑马的方法：哪个更老，哪个体积更大？两种比较都是有效且易于计算的；不同之处在于我们可以用体积来比较斑马和其他任何物体，但我们只能用年龄来比较斑马和其他动物。如果我们希望 compare() 实现年龄比较语义，那么在 Object 类中定义 compare() 没有任何意义，因为语义不是在层次结构的这个级别定义的。值得注意的是，这些场景都不需要任何强制转换，因为语义是在基类级别定义的（比较体积时是 Object，比较年龄时是 Animal）。

这引发了一个更重要的问题——某些类不适合单个包罗万象的 compare() 函数。通常，实现多个明确说明正在比较的内容的函数更有意义，例如 compare_age() 和 compare_volume()。这些函数的定义可以发生在继承层次结构中语义变得相关的点，并且将它们调整到子类应该是微不足道的（如果需要调整的话）。使用 compare() 或 operator==() 的简单比较通常只对正确语义实现明显且明确的简单类有意义。

长话短说……“这取决于”。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2008-11-16T15:53:48.120

如果您的意思是 B 或 C 类中的 Compare() 应始终传递 B 或 C 类的对象，无论签名说什么，您都可以使用指向实例而不是实例的指针，并尝试将指针向下转换该方法的代码使用类似的东西

```
int B::Compare(A *ptr)
{
   other = dynamic_cast <B*> (ptr);
   if(other)
      ...  // Ok, it was a pointer to B
} 
```

（这种重载仅对那些在其父状态中添加影响比较的东西的派生类是必要的。）

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2008-11-16T16:06:23.880

比较必须是反射性的，所以：

```
let a = new A
let b = new B (inherits from A)

if (a.equals(b))
 then b.equals(a) must be true! 
```

所以`a.equals(b)`应该返回假，因为 B 可能包含 A 没有的字段，这意味着`b.equals(a)`可能是假的。

因此，在 C++ 中，我猜比较应该是虚拟的，并且您应该使用类型检查来查看参数与当前对象的类型“相同”。

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2008-11-16T16:09:55.170

除了dynamic_cast，你还需要传递一个引用或者一个指针，可能是const。比较函数也可能是 const。

```
class B: public A
{
    B();
    virtual ~B();
    virtual int Compare(const A &Other) const;
};

int B::Compare(const A &Other) const
{
    const B *other = dynamic_cast <const B*> (&Other);
    if(other) {
        // compare
    }
    else {
        return 0;
    }
} 
```

编辑：发布前必须编译...

* * *

## 回答 #7

> 赞同：0
> 
> 时间：2008-11-16T16:43:31.047

我在 C++ 中几乎没有这个问题。与 Java 不同，我们不需要从同一个根 Object 类继承所有类。在处理可比较（/值语义）类时，它们不太可能来自多态层次结构。

如果在您的特定情况下确实需要，那么您又回到了双重调度/多方法问题。有多种解决方法（dynamic_cast、可能交互的函数表、访问者……）

* * *

## 回答 #8

> 赞同：0
> 
> 时间：2008-11-16T19:20:02.010

我建议不要将其设为虚拟。唯一的缺点是，如果类不同，您必须明确说明要使用哪个比较。但是因为你必须这样做，你可能会发现一个错误（在编译时），否则可能会导致运行时错误......

```
class A
{
  public:
    A(){};
    int Compare(A const & Other) {cout << "A::Compare()" << endl; return 0;};
};

class B: public A
{
  public:
    B(){};
    int Compare(B const & Other) {cout << "B::Compare()" << endl; return 0;};
};

class C: public A
{
  public:
    C(){};
    int Compare(C const & Other) {cout << "C::Compare()" << endl; return 0;};
};

int main(int argc, char* argv[])
{
    A a1;
    B b1, b2;
    C c1;

    a1.Compare(b1);     // A::Compare()
    b1.A::Compare(a1);  // A::Compare()
    b1.Compare(b2);     // B::Compare()
    c1.A::Compare(b1);  // A::Compare()

    return 0;
} 
```

# visual-studio - 如何修复 Visual Studio 2005 无响应？

> ID：294017
> 
> 赞同：0
> 
> 时间：2008-11-16T15:47:18.723
> 
> 标签：visual-studio

我的 VS 2005 一直没有响应。我已经尝试了 StackOverflow 上列出的所有优化技巧。我正在使用 Resharper 4.1 运行。（不确定这是否会导致这种情况）。我还有什么其他方法可以尝试在这里隔离根本问题？

升级到 VS 2008 是否可能对我有帮助？

更多细节： - 在解决方案资源管理器上上下滚动 - 折叠项目 - 似乎很随机

再次详细说明： - 如果我远程连接到一台机器上，情况似乎更糟。我看着顶部的标题，它似乎一直在启用/禁用，就好像我正在从一个应用程序切换到另一个应用程序（但我不是）。有任何想法吗 ？？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2008-11-16T15:57:35.193

实际上，听起来可能除了 VS 之外的其他东西正在占用您的计算机。尝试让任务管理器或进程资源管理器保持打开状态，并检查发生冻结时消耗 CPU 或磁盘的内容。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2008-11-16T17:06:50.297

1）如果您要远程处理它，请关闭动画。我一直把它关掉，那个 0.5 秒的窗口滑入让我慢了下来！但它在远程桌面或虚拟机上真的很糟糕。

在 VS2008 中，它位于：工具 - 选项 - 环境 - 动画环境工具

2) Outlook 似乎不能很好地与 VS2005 配合使用。我不记得为什么，但是在一台机器上，如果我打开 Outlook+VS2005，那么 VS 会非常慢。我在VS2008中没有遇到过这个问题。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2008-11-16T16:03:43.590

根据我的经验，可能是防病毒软件过于活跃，也可能是一些硬件缺陷。尝试在另一台 PC 上复制环境（相同的 Visual Studio 版本、相同的更新、相同的加载项）并使用相同的项目。

如果它在其他 PC 上的行为相同，另一种方法是同时停用加载项，并找出有罪的加载项。

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2008-11-16T16:06:08.750

您是否尝试在没有任何插件的情况下加载 Visual Studio？

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2009-03-06T17:25:38.587

几个月来我也遇到了同样的问题。当我打开不同的选项卡、开始调试、关闭选项卡，甚至有时只是编辑代码时，我的 VS2005 安装会挂起 5-10 秒，有时甚至更长。我尝试在不运行 Outlook 的情况下运行它，禁用编辑并继续，使用 Visual Studio 命令行启用 LARGEADDRESSAWARE 开关（32 位机器中的 4gb RAM），但似乎没有任何效果。这个周末我将尝试对硬盘进行碎片整理，但我认为碎片化的硬盘不会对应用程序产生如此明显的影响。

如果您找到了解决问题的方法，我真的很希望您在这里分享。

# c++ - 您从经验中学到了哪些与 C++ 相关的习语、误解和陷阱？

> ID：294018
> 
> 赞同：27
> 
> 时间：2008-11-16T15:47:34.857
> 
> 标签：c++, idioms

您从经验中学到了哪些与 C++ 相关的习语、误解和陷阱？

一个例子：

```
class A
{
  public: 
  char s[1024];
  char *p;

  A::A()
  {
    p = s;
  }

  void changeS() const
  {
    p[0] = 'a';
  }

}; 
```

甚至知道changeS是一个const成员函数，它是改变对象的值。所以一个 const 成员函数只是意味着它将所有变量都视为 const，并不意味着它实际上会保留所有成员 const。（为什么？成员函数上的 const 关键字将 char *p; 视为 char * const p; 而不是 const char *p;

因此，这意味着 p 不能指向其他东西。并不是说你不能改变 p 的数据。

* * *

## 回答 #1

> 赞同：55
> 
> 时间：2008-11-16T16:20:59.983

您无需了解 C++ 复杂的函数 typedef 声明语法。这是我发现的一个可爱的技巧。

快，描述一下这个 typedef：

```
typedef C &(__cdecl C::* const CB )(const C &) const; 
```

简单的！CB 是指向 C 类成员函数的指针，它接受对 C 对象的 const 引用并返回对 C 对象的非常量引用。哦，它是一个 const 成员函数。哦，函数指针本身是 const ......（对吗？）

C++ 函数声明规范语法是出了名的晦涩难记。是的，经验丰富的 C++ 资深人士可能会使用一些技巧来破译这种恐怖，但这不是本技巧的内容。这个技巧是关于你如何不需要记住这种可怕的语法并且仍然能够声明这样的函数指针类型定义（例如，如果你正在与一些从未听说过 boost::function 的遗留 API 交互）。让编译器为您完成工作，而不是费尽心思。下次您尝试为成员函数创建 typedef 时，如下所示：

```
struct C {
        const C& Callback(const C&) const   { }
}; 
```

与其努力手动想出上面的复杂语法，不如引发一个故意的编译错误，这将迫使编译器命名野兽。

例如：

```
char c = &C::Callback; 
```

编译器高兴地发出这个有用的错误消息：

```
“… cannot convert from 'const C &(__cdecl C::* )(const C &) const' to 'char'” 
```

这就是我们正在寻找的。:)

* * *

## 回答 #2

> 赞同：18
> 
> 时间：2008-11-16T15:51:15.737

自从我在一些代码中发现它以来，我就喜欢它：

```
assert(condition || !"Something has gone wrong!"); 
```

或者如果你手头没有条件，你可以这样做

```
assert(!"Something has gone wrong!"); 
```

以下归因于[@Josh](https://stackoverflow.com/users/8701/josh)（见评论）。它使用[逗号运算符](http://en.wikipedia.org/wiki/Comma_operator)代替：

```
assert(("Something has gone wrong!", condition)); 
```

* * *

## 回答 #3

> 赞同：18
> 
> 时间：2008-11-16T18:53:43.497

这是我有一天抓到的另一个：

```
char int2hex(int x) {
     return "-0123456789abcdef"[(x >= 0 && x < 16) ? (x + 1) : 0];
} 
```

它只是索引 char 数组而不是进行切换。如果超出范围，则返回“-”。

* * *

## 回答 #4

> 赞同：14
> 
> 时间：2008-11-16T16:38:06.517

当我们不知道以后是否需要时，永远不要浪费时间尝试在类上实现复制操作。我们处理的许多对象只是实体，复制它们几乎没有任何意义。使它们不可复制，如果确实需要，稍后再实施复制/复制。

* * *

## 回答 #5

> 赞同：11
> 
> 时间：2009-03-10T11:14:56.820

有时，标头会因不表现宏名称而受到污染，例如

```
#define max(a, b) (a > b ? a : b) 
```

这将使使用以这种方式调用的最大函数或函数对象的代码无效。一个臭名昭著的例子就是`windows.h`这样做的。一种解决方法是在调用周围加上括号，这会阻止它使用宏并使其使用真正的 max 函数：

```
void myfunction() {
    ....
    (max)(c, d);
} 
```

现在，最大值在括号中，不再算作对宏的调用！

* * *

## 回答 #6

> 赞同：7
> 
> 时间：2008-11-16T17:32:27.030

一个很少使用但很方便的 C++ 习惯用法是在构造函数链中使用 ?: 运算符。

```
class Sample
{  
    const char * ptr;
    const bool  freeable;

    Sample(const char * optional):
        ptr( optional ? optional : new char [32]),
        freeable( optional ? false : true ) {}
    ~Sample( )  { if (freeable) delete[] ptr; }
} 
```

C++ 不允许在构造函数的主体内更改 const 值，因此这避免了 const-casts。

* * *

## 回答 #7

> 赞同：6
> 
> 时间：2008-11-16T22:13:30.427

您通常可以在源文件中隐藏比您想象的更多的东西。如果不需要，不要将所有内容都设为私有 - 通常最好将其保留在源文件中的匿名命名空间中。我发现它实际上使事情更容易处理，因为这样您就不会透露实现细节，而是会受到启发来制作许多微小的功能而不是单一的功能。

* * *

## 回答 #8

> 赞同：5
> 
> 时间：2008-11-16T16:10:34.747

一些通常会绊倒人们的事情：

```
std::cout << a << a++ << --a;
i = ++i; 
```

上述行均未定义。

```
void foo(bar* b1, bar* b2);

int main() {
  foo(shared_ptr<bar>(new bar()), shared_ptr<bar>(new bar()));
} 
```

以上可能会泄漏内存。

```
int* arr = new int[10];
arr + 11; 
```

这会导致未定义的行为。

至于成语，我最喜欢的是[RAII](http://en.wikipedia.org/wiki/Resource_Acquisition_Is_Initialization)。在栈上分配对象，保证在对象超出范围时调用析构函数，防止资源泄漏。

* * *

## 回答 #9

> 赞同：5
> 
> 时间：2008-11-16T20:57:13.093

因为我们都忽略了 OP，而是发布了我们最喜欢的酷技巧......

使用 boost（或 tr1）shared_ptr 在运行时保持类不变（很明显，但我没有看到其他人这样做）：

```
#include <cassert>
#include <functional>
#include <stdexcept>
#include <boost/shared_ptr.hpp>
using namespace std;
using namespace boost;

class Foo
{
public:
    Foo() : even(0)
    {
        // Check on start up...
        Invariant();
    }

    void BrokenFunc()
    {
        // ...and on exit from public non-const member functions.
        // Any more is wasteful.
        shared_ptr<Foo> checker(this, mem_fun(&Foo::Invariant));

        even += 1;
        throw runtime_error("didn't expect this!");
        even += 1;
    }

private:
    void Invariant() { assert(even % 2 == 0); }
    int even;
}; 
```

* * *

## 回答 #10

> 赞同：4
> 
> 时间：2008-11-16T21:30:26.833

自从我了解了 RAII（有史以来最糟糕的首字母缩写词之一）和智能指针以来，内存和资源泄漏几乎完全消失了。

* * *

## 回答 #11

> 赞同：3
> 
> 时间：2008-11-16T17:54:52.913

如果您有一个没有值语义的类，请确保**显式**声明以下所有构造，以防止出现问题。

*   默认构造函数
*   复制构造函数
*   赋值运算符

在许多情况下，您只需要声明这些结构的一个子集。然而，在某些情况下，哪些需要哪些不需要，这可能会变得非常棘手。将所有 3 项声明为私有并完成此事要安全得多。

在顶部添加注释说明这不是复制安全类也非常有帮助。

这**将**节省您的时间。

* * *

## 回答 #12

> 赞同：0
> 
> 时间：2008-11-16T21:15:56.673

我不能说我是一位经验丰富的 C++ 程序员，但我最近了解到将数组和数组作为函数参数传递是多么困难。尽量避免这种情况:(

如果您知道编译时的大小，它很简单。即使您在编译时知道其中一个维度。如果你根本不知道......你可能正在看这样的东西

```
m[i*dim2+j] 
```

作为行的迭代器，dim2 是列数，j 是列的迭代器。

* * *

## 回答 #13

> 赞同：0
> 
> 时间：2009-03-10T11:34:49.813

我在编程时实际上没有遇到任何事情，但一位朋友想要解释为什么代码可以工作。我花了一段时间才弄清楚。也许这对你们来说很明显，但我不是一个经验丰富的程序员。

```
#include <iostream>
using namespace std;

int& strangeFunction(int& x){return x;}

int main(){
        int a=0;
        strangeFunction(a) = 5;               //<------- I found this very confusing
        cout << a <<endl;
        return 0;
} 
```

* * *

## 回答 #14

> 赞同：0
> 
> 时间：2013-01-16T11:50:44.643

`shared_ptr`除非需要，否则不喜欢使用。更喜欢使用 C++ 引用而`unique_ptr`不是。`shared_ptr`是性能猪，使代码看起来比实际更复杂。通常这不会是一个问题，除了不寻常的吸引力`shared_ptr`和它的传染性。

* * *

## 回答 #15

> 赞同：0
> 
> 时间：2013-01-16T11:58:50.897

`std::noncopyable`除非需要，否则不要陷入使用的陷阱。是的，它在很多地方都很有用，应该在那里使用。

陷阱是人们开始编写`clone()`函数并使其不可复制，这实现了相同的功能。相反，您也可以将`explicit`( [link](https://stackoverflow.com/questions/4153527/explicit-copy-constructor-behavior-and-pratical-uses) ) 用于复制构造函数，以防止意外复制（并将赋值设为私有，或删除 C++0x 中的函数）。`clone()`但是，继承的基类需要。

* * *

## 回答 #16

> 赞同：0
> 
> 时间：2013-01-16T12:06:33.730

使用`boost::spirit::hold_any`( [link](http://www.boost.org/doc/libs/1_46_1/boost/spirit/home/support/detail/hold_any.hpp) ) 而不是`boost::any`性能代码（同时持有大量小对象）。我看到他们的表现有很大的不同。

# visual-studio - CodeRush 或 ReSharper 是否有类似 GhostDoc 的插件？

> ID：294021
> 
> 赞同：6
> 
> 时间：2008-11-16T15:49:51.013
> 
> 标签：visual-studio, resharper, coderush, ghostdoc

我注意到 GhostDoc 很久没有更新了。所以我很好奇是否有 Resharper 或 CodeRush 的插件可以完成同样的事情？或者即使这种类型的功能内置在其中一个也很棒的工具中。

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2008-12-02T03:02:55.877

最新版本的 GhostDoc 特别适用于 VS 2008。不知道你的意思是它已经很久没有更新了。就我而言，GhostDoc 是可用的最好的代码内 XML 注释器。它是可定制的，具有出色的语言和语法支持。它只是工作。

有什么特别不适合你的吗？

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2009-05-01T19:13:20.747

你可以试试我的免费 AtomineerUtils 插件。它与 GhostDoc 非常相似，但我相信它更强大、更灵活（例如，在许多优点中：它支持 VB、C# C++/CLI、C++、C；同时支持 Doxygen 和 DocXml 注释格式；可选的自动换行注释和文档注释, 是完全可配置的，并为方法中抛出的异常添加条目）。我仍在积极开发它。

详细信息并在[atomineerutils.com](http://atomineerutils.com/)下载。

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2009-09-18T15:19:39.287

如果您有 ReSharper，您总是可以尝试使用[StyleCop for ReSharper](http://stylecopforresharper.codeplex.com/) - 它具有 GhostDoc 的一些文档功能，但也有[无数其他 QuickFixes](http://stylecopforresharper.codeplex.com/Wiki/View.aspx?title=Fixes)和基于 StyleCop 规则集的格式化选项。

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2008-11-16T15:53:48.867

GhostDoc 工作得很好，所以我想没有必要更新（除非会添加一些新功能）。此外，它不会以任何方式与 Resharper 冲突（至少对我而言）。

**编辑：**由于每个人似乎都乐于使用 GhostDoc（基于我的谷歌搜索），我怀疑任何人都会重新发明轮子，除非它遭受了 not-invented-here sindrom 的困扰。

**编辑**好吧，发布了一个新版本：[SubMain 收购 GhostDoc，发布新版本，将其与 CodeIt.Right 集成](http://submain.com/blog/SubMainAcquiresGhostDocReleasesNewVersionIntegratesItWithCodeItRight.aspx)

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2009-07-29T09:35:42.373

像许多人一样，我不能没有[GhostDoc](http://submain.com/products/ghostdoc.aspx)插件。

除了可以节省大量时间之外，如果 GhostDoc 没有为我的方法提供合理的“摘要”描述，我知道我对该方法的命名很糟糕。对我来说，这很有价值！

从新的 GhostDoc 网站：

> SubMain[最近收购了 GhostDoc](http://submain.com/blog/SubMainAcquiresGhostDocReleasesNewVersionIntegratesItWithCodeItRight.aspx)。我们将继续免费维护和分发产品。我们将改进 GhostDoc，我们始终欢迎社区反馈。如果您有想法，请在[GhostDoc 论坛](http://submain.com/support/ghostdoc/)中发布。Roland Weigelt 是 GhostDoc 的原作者，他的网站可以在[http://roland-weigelt.de/找到](http://roland-weigelt.de/)

它仍然是免费软件，但具有来自受人尊敬的商业开发工具公司支持的新优势。

# jquery - 用户想要选择选项后如何扩展“选择”选项宽度

> ID：294040
> 
> 赞同：33
> 
> 时间：2008-11-16T16:10:33.437
> 
> 标签：jquery, css, html-select, content-length

也许这是一个简单的问题，也许不是。我有一个选择框，我在其中硬编码宽度。说 120 像素。

```
<select style="width: 120px">
  <option>REALLY LONG TEXT, REALLY LONG TEXT, REALLY LONG TEXT</option>
  <option>ABC</option>
</select>
```

我希望能够显示第二个选项，以便用户可以看到文本的完整长度。

像其他一切一样。这在 Firefox 中运行良好，但不适用于 Internet Explorer6。

* * *

## 回答 #1

> 赞同：13
> 
> 时间：2009-02-19T10:02:09.163

我用以下代码解决了我的问题：

```
<div style="width: 180px; overflow: hidden;">
   <select style="width: auto;" name="abc" id="10">
     <option value="-1">AAAAAAAAAAA</option>
     <option value="123">123</option>
   </select>
</div>
```

希望能帮助到你！

* * *

## 回答 #2

> 赞同：12
> 
> 时间：2008-11-16T16:18:57.723

如果您有一个预先存在的选项 fixed-with `<select>`，并且您不想以编程方式更改宽度，那么除非您有一点创意，否则您可能会不走运。

*   您可以尝试将`title`属性设置为每个选项。这是非标准的 HTML（如果您关心这里的这种轻微违规行为），但 IE（和 Firefox 也是如此）将在鼠标悬停时在鼠标弹出窗口中显示整个文本。
*   当用户选择某些内容时，您可以使用 JavaScript 在某个定位的 DIV 中显示文本。恕我直言，这是一种*不太好的*方法，因为它完全需要 JavaScript 才能工作，而且它只有*在*选择了某些内容之后才能工作 - 在值发生变化之前，选择框不会触发任何事件。
*   您根本不使用选择框，而是[使用其他标记和 CSS 实现其功能](http://forums.microsoft.com/MSDN/ShowPost.aspx?PostID=2359319&SiteID=1)。不是我最喜欢的，但我想提一下。

如果您稍后通过 JavaScript 添加长选项，请查看此处：[如何在 IE 中动态更新 HTML“选择”框](https://stackoverflow.com/questions/261362/how-to-update-html-select-box-dynamically-in-ie)

* * *

## 回答 #3

> 赞同：5
> 
> 时间：2019-03-25T17:13:38.547

非常老的问题，但这是解决方案。在这里，您有一个使用`jquery`. 它利用了一个临时辅助`select`，从主选择中选择的选项被复制到其中，这样人们就可以评估主选择`select`应该具有的真实宽度。

```
$('select').change(function(){
  var text = $(this).find('option:selected').text()
  var $aux = $('<select/>').append($('<option/>').text(text))
  $(this).after($aux)
  $(this).width($aux.width())
  $aux.remove()
}).change()
```

```
<script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
<select>
  <option>ABC</option>
  <option>REALLY LONG TEXT, REALLY LONG TEXT, REALLY LONG TEXT</option>
</select>
```

* * *

## 回答 #4

> 赞同：4
> 
> 时间：2011-02-17T20:31:51.713

这模仿了您正在寻找的大多数行为：

```
 <!--

     I found this works fairly well.

  -->

  <!-- On page load, be sure that something else has focus. -->
  <body onload="document.getElementById('name').focus();">
  <input id=name type=text>

  <!-- This div is for demonstration only.  The parent container may be anything -->
  <div style="height:50; width:100px; border:1px solid red;">

  <!-- Note: static width, absolute position but no top or left specified, Z-Index +1 -->
  <select
   style="width:96px; position:absolute; z-index:+1;"
   onactivate="this.style.width='auto';"
   onchange="this.blur();"
   onblur="this.style.width='96px';">
  <!-- "activate" happens before all else and "width='auto'" expands per content -->
  <!-- Both making a selection and moving to another control should return static width -->

  <option>abc</option>
  <option>abcdefghij</option>
  <option>abcdefghijklmnop</option>
  <option>abcdefghijklmnopqrstuvwxyz</option>

  </select>

  </div>

  </body>

  </html> 
```

这将覆盖一些按键行为。

* * *

## 回答 #5

> 赞同：4
> 
> 时间：2011-09-02T14:51:14.037

把它放在一个div中并给它一个id

```
<div id=myForm> 
```

然后创建一个非常简单的 CSS 来搭配它。

```
#myForm select { 
width:200px; }

#myForm select:focus {
width:auto; } 
```

这就是你所需要的。

* * *

## 回答 #6

> 赞同：4
> 
> 时间：2015-06-02T20:25:41.433

我通过在 select 中将 min-width 和 max-width 设置为相同的值，然后将 select:focus 设置为 auto，在我的引导页面中修复了它。

```
select {
  min-width: 120px;
  max-width: 120px;
}
select:focus {
  width: auto;
}
```

```
<select style="width: 120px">
  <option>REALLY LONG TEXT, REALLY LONG TEXT, REALLY LONG TEXT</option>
  <option>ABC</option>
</select>
```

* * *

## 回答 #7

> 赞同：2
> 
> 时间：2021-04-24T07:03:38.413

即使这个问题来自 2008 年，仍然存在您希望选择框匹配当前选择的宽度而不是最长选项的情况。因此，这是一种现代方法：

它或多或少与[这个答案](https://stackoverflow.com/a/55343930/4168960)中的原理相同，只是没有 jQuery。

1.  获取 select 元素并监听它的变化。
2.  创建一个新的选择元素和选项，并将当前的文本传递`selectedIndex`给选项。
3.  向新的选择元素添加`position: fixed`和样式。`visibility: hidden`这样可以确保它不会影响您的布局，但仍然可以测量其边界框。
4.  将选项附加到选择。
5.  将选择附加到原始选择元素。
6.  使用获取该新尺寸所需的尺寸`getBoundingClientRect().width`
7.  根据新的尺寸设置原始的宽度。
8.  删除新的。
9.  调度更改事件以最初触发此逻辑。

```
const select = document.querySelector('select')

select.addEventListener('change', (event) => {
  let tempSelect = document.createElement('select'),
      tempOption = document.createElement('option');

  tempOption.textContent = event.target.options[event.target.selectedIndex].text;
  tempSelect.style.cssText += `
      visibility: hidden;
      position: fixed;
      `;
  tempSelect.appendChild(tempOption);
  event.target.after(tempSelect);

  const tempSelectWidth = tempSelect.getBoundingClientRect().width;
  event.target.style.width = `${tempSelectWidth}px`;
  tempSelect.remove();
});

select.dispatchEvent(new Event('change'));
```

```
<select>
  <option>Short option</option>
  <option>Some longer option</option>
  <option>An very long option with a lot of text</option>
</select>
```

* * *

## 回答 #8

> 赞同：1
> 
> 时间：2008-11-16T16:23:31.350

好的，这个选项很老套，但应该可以。

```
$(document).ready( function() {
$('#select').change( function() {
    $('#hiddenDiv').html( $('#select').val() );
    $('#select').width( $('#hiddenDiv').width() );
 }
 } 
```

这当然需要一个隐藏的div。

```
<div id="hiddenDiv" style="visibility:hidden"></div> 
```

哦，你将需要 jQuery

* * *

## 回答 #9

> 赞同：1
> 
> 时间：2010-10-05T22:13:03.863

我在 IE 中用于现有网站的一个简单解决方案（使用 jQuery，但`eventListener`如果你真的不太了解 JS，我可以用代码回帖）如下：

```
if (jQuery.browser.msie) {
  jQuery('#mySelect').focus(function() {
    jQuery(this).width('auto');
  }).bind('blur change', function() {
    jQuery(this).width('100%');
  });
}; 
```

当然，使用变量 ( `var cWidth = jQuery('#mySelect').width();`) 来存储以前的宽度，但这就是我们的工作所需的一切。

* * *

## 回答 #10

> 赞同：1
> 
> 时间：2012-05-30T15:18:41.340

样本

```
function PopulateDropdown() {
    $.ajax({
        type: "POST",
        url: "../CommonWebService.asmx/GetData",
        data: "{}",
        contentType: "application/json; charset=utf-8",
        dataType: "json",
        success: function (msg) {
            $("select[id^='MyDropDown']").empty();
            $.each(msg.d, function () {
                $("select[id^='MyDropDownSelect']").append($("<option></option>").val(this['IdIndexDataType']).html(this['DataTypeName']));
            }); 
            $("select[id^='MyDropDown']").css("width", "auto");  
        },
        error: function (e1) {
            alert("Error - " + e1.toString());
        }
    });
} 
```

下面的代码将通过在将数据插入下拉列表后添加此代码来解决您的下拉列表宽度问题。

```
$("select[id^='MyDropDown']").css("width", "auto"); 
```

* * *

## 回答 #11

> 赞同：0
> 
> 时间：2009-07-03T00:10:48.667

我改进了cychan的解决方案，就像这样：

```
<html>
<head>

<style>
    .wrapper{
        display: inline;
        float: left; 
        width: 180px; 
        overflow: hidden; 
    }
    .selectArrow{
        display: inline;
        float: left;
        width: 17px;
        height: 20px;
        border:1px solid #7f9db9;
        border-left: none;
        background: url('selectArrow.png') no-repeat 1px 1px;
    }
    .selectArrow-mousedown{background: url('selectArrow-mousedown.png') no-repeat 1px 1px;}
    .selectArrow-mouseover{background: url('selectArrow-mouseover.png') no-repeat 1px 1px;}
</style>
<script language="javascript" src="jquery-1.3.2.min.js"></script>

<script language="javascript">
    $(document).ready(function(){
        $('#w1').wrap("<div class='wrapper'></div>");
        $('.wrapper').after("<div class='selectArrow'/>");
        $('.wrapper').find('select').mousedown(function(){
            $(this).parent().next().addClass('selectArrow-mousedown').removeClass('selectArrow-mouseover');
        }).
        mouseup(function(){
            $(this).parent().next().removeClass('selectArrow-mousedown').addClass('selectArrow-mouseover');
        }).
        hover(function(){
            $(this).parent().next().addClass('selectArrow-mouseover');
        }, function(){
            $(this).parent().next().removeClass('selectArrow-mouseover');
        });

        $('.selectArrow').click(function(){
            $(this).prev().find('select').focus();
        });

        $('.selectArrow').mousedown(function(){
            $(this).addClass('selectArrow-mousedown').removeClass('selectArrow-mouseover');
        }).
        mouseup(function(){
            $(this).removeClass('selectArrow-mousedown').addClass('selectArrow-mouseover');
        }).
        hover(function(){
            $(this).addClass('selectArrow-mouseover');
        }, function(){
            $(this).removeClass('selectArrow-mouseover');
        });
    });

</script>
</head>
<body>
    <select id="w1">
       <option value="0">AnyAnyAnyAnyAnyAnyAny</option>
       <option value="1">AnyAnyAnyAnyAnyAnyAnyAnyAnyAnyAnyAnyAnyAny</option>
    </select>

</body>
</html> 
```

[在 css 类中使用的 PNG 在这里上传...](http://img189.imageshack.us/gal.php?g=selectarrow.png)

而且你仍然需要 JQuery .....

* * *

## 回答 #12

> 赞同：0
> 
> 时间：2012-09-27T06:40:29.050

您可以尝试仅使用 css 解决。通过添加类来选择

```
select{ width:80px;text-overflow:'...';-ms-text-overflow:ellipsis;position:absolute; z-index:+1;}
select:focus{ width:100%;} 
```

[有关特定项目（选项）HTML 中的](https://stackoverflow.com/questions/12458341/list-box-style-in-a-particular-item-option-html/12458842#12458842)更多参考列表框样式

[多选列表框](https://stackoverflow.com/questions/5488211/multi-select-list-box)

* * *

## 回答 #13

> 赞同：0
> 
> 时间：2022-02-22T17:34:35.173

我基于**data 属性**和**隐藏的 CSS 伪元素**创建了带有自动扩展的样式选择元素，只有一个最小的 JS 。

```
Array.from(document.querySelectorAll('.js-select-auto-expand'), (input) => {
  let parent = input.parentNode;

  function updateSize() {
    parent.dataset.selectAutoExpand = input.value
  }

  input.addEventListener('input', updateSize);

  updateSize();
});
```

```
*,
*::before,
*::after {
  box-sizing: border-box;
}

body {
  padding: 2rem 4rem;
  line-height: 1.5;
  color: gray;
}

.article-test {
  line-height: 2.5;
}

.select-auto-expand {
  position: relative;
  display: inline-block;
  min-width: 2rem;
  width: auto;
  height: 30px;
  line-height: 28px;
  padding: 0 10px;
  vertical-align: baseline;
  border: 1px solid black;
  background-color: transparent;
  color: #fafafa;
  font-size: 1rem;
}
.select-auto-expand .select-auto-expand__select {
  position: absolute;
  top: 0px;
  bottom: 0;
  left: 0;
  right: 0;
  width: 100%;
  min-width: 1em;
  height: 100%;
  margin: 0 2px;
  padding: 0 8px;
  -webkit-appearance: none;
     -moz-appearance: none;
          appearance: none;
  border-radius: 0;
  border: 0;
  background: transparent;
  font: inherit;
}
.select-auto-expand::after {
  content: attr(data-select-auto-expand);
  display: inline-block;
  width: 100%;
  min-width: 1em;
  white-space: pre-wrap;
  font: inherit;
  line-height: inherit;
  color: inherit;
  background: transparent;
  visibility: hidden;
  opacity: 0;
}
.select-auto-expand:focus-within {
  outline: 3px solid rgba(0, 0, 255, 0.3);
}
.select-auto-expand:focus-within input:focus {
  outline: none;
}
```

```
<form action="#" class="article-test">

  <p>
    Adipisci ipsum debitis quaerat commodi tenetur? Amet consectetur adipisicing elit. Lorem ipsum dolor sit, 
    <label class="select-auto-expand" for="pet-select">
      <select name="pets" id="pet-select" class="select-auto-expand__select js-select-auto-expand">
        <option value="select ...">select ...</option>
        <option value="sed qui">sed qui</option>
        <option value="veniam iste quis">veniam iste quis</option>
        <option value="ipsum debitis">ipsum debitis</option>
        <option value="officia excepturi repellendus aperiam">officia excepturi repellendus aperiam</option>
      </select>
    </label>
    veniam iste quis, sed qui non dolores. Porro, soluta. Officia excepturi repellendus aperiam cumque consectetur distinctio, veniam iste quis, sed qui non dolores. Adipisci ipsum debitis quaerat commodi tenetur?
  </p>

</form>
```

演示： [https ://codepen.io/astro87/pen/dyZerdg?editors=0010](https://codepen.io/astro87/pen/dyZerdg?editors=0010)

灵感来源： [https ://filamentgroup.github.io/select-css/demo/](https://filamentgroup.github.io/select-css/demo/) [https://codepen.io/shshaw/full/bGNJJBE](https://codepen.io/shshaw/full/bGNJJBE)

# wpf - WPF 文档和 Visual Studio 2008 Express

> ID：294043
> 
> 赞同：0
> 
> 时间：2008-11-16T16:12:08.613
> 
> 标签：wpf, visual-studio, documentation, visual-studio-express

我正在尝试使用 Visual C# Express 2008 在家里设置 WPF 开发环境。我安装了它和它的 MSDN 文档，但是看起来文档不包含任何 WPF 文档。

我正要安装 Windows Vista SDK，但它看起来只包含 .NET 3.0 的文档，而不是 3.5 SP1。我在哪里可以下载 .NET 3.5SP1 的文档并（理想情况下）将其与我已有的文档集成？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2008-11-17T13:57:09.587

在 Microsoft 的 Express Editions 网站上略微隐藏的是[完整 MSDN 库下载](http://www.microsoft.com/express/download/msdn/Default.aspx)的链接。您需要第二个条目（“MSDN Library for Visual Studio 2008”）。

# c# - 收益返回相对于返回列表的并发性或性能优势

> ID：294061
> 
> 赞同：19
> 
> 时间：2008-11-16T16:25:06.340
> 
> 标签：c#, yield, enumerators

我想知道是否有任何并发​​性（现在或将来），或者使用收益返回而不是返回列表是否有性能优势。请参阅以下示例

处理方法

```
void Page_Load()
{
  foreach(var item in GetPostedItems())
    Process(item);
} 
```

使用收益回报

```
IEnumerable<string> GetPostedItems()
{
  yield return Item1.Text;
  yield return Item2.Text;
  yield return Item3.Text; 
} 
```

返回列表

```
IEnumerable<string> GetPostedItems()
{
  var list = new List<string>();
  list.Add(Item1.Text);
  list.Add(Item2.Text);
  list.Add(Item3.Text);
  return list;
} 
```

* * *

## 回答 #1

> 赞同：41
> 
> 时间：2008-11-16T16:44:34.273

在`yield return`示例中，每次调用时都会评估结果，`IEnumerable.MoveNext`而在列表示例中，在返回之前评估所有结果`IEnumerable`（请注意，`Text`可能不会为每个结果评估属性，因为可能会发生缓存和内联）。因此，`yield return`您应该在第一次调用枚举器时获得小幅性能提升，然后在`IEnumerable.MoveNext`评估属性时每次后续调用时可能会有小幅性能下降。

其中一件很棒的事情`yield return`是，您可以返回无限序列、随机序列和各种其他新颖的枚举，这些枚举对于首先创建列表的模型来说效率极低或不可能。

简而言之，返回 的实例`List`需要在返回 之前评估列表中的所有元素`IEnumerable`，而 using`yield return`允许根据消费者的要求计算每个元素`IEnumerable`。

# java - 休眠：避免一次将所有记录读入内存

> ID：294077
> 
> 赞同：6
> 
> 时间：2008-11-16T16:41:24.980
> 
> 标签：java, nhibernate, hibernate

我需要从中创建 XML 文档的数据库中有大量行。我正在使用休眠 3。Criteria 和 Query 接口中的基本 list() 方法看起来很危险：我怀疑它几乎必须将所有记录读入内存，即使我只迭代它们。还是有一些延迟加载魔法？如果没有，我似乎还有两个选择：使用 Query 中的 scroll() 或 iterate() （scroll 也存在于 Criteria 中）。如果我想要最少的 SQL 往返，迭代看起来也不是那么好：“第一个 SQL 查询只返回标识符”。所以我是对的，我必须为此使用 scroll() 吗？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2010-11-23T16:27:08.137

尝试结合使用 scroll() ：

[http://docs.jboss.org/hibernate/core/3.3/api/org/hibernate/StatelessSession.html](http://docs.jboss.org/hibernate/core/3.3/api/org/hibernate/StatelessSession.html)

一种面向命令的 API，用于对数据库执行批量操作。

无状态会话不实现一级缓存，也不与任何二级缓存交互，也不实现事务性后写或自动脏检查，也不将操作级联到关联的实例。无状态会话会忽略集合。通过无状态会话执行的操作绕过 Hibernate 的事件模型和拦截器。由于缺少一级缓存，无状态会话容易受到数据别名效应的影响。

对于某些类型的事务，无状态会话的执行速度可能比有状态会话稍快。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-08-18T21:49:26.177

如果您不需要将对象标记为已处理，则可以简单地使用 scroll() 并在处理完对象后将对象从会话中逐出。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2008-11-16T17:20:16.337

在 Criteria 上使用 setMaxResults() 方法。

```
Criteria crit = sess.createCriteria(Cat.class);
crit.setMaxResults(maxResults);
crit.setFirstResult(firstResultIndex);
List cats = crit.list(); 
```

[http://hibernate.org/hib_docs/v3/reference/en/html/querycriteria.html](http://hibernate.org/hib_docs/v3/reference/en/html/querycriteria.html)

[http://www.hibernate.org/hib_docs/v3/api/org/hibernate/Criteria.html](http://www.hibernate.org/hib_docs/v3/api/org/hibernate/Criteria.html)

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2009-08-12T22:38:15.520

这就是我打算做的事情：使用我需要导出的所有行的对象 ID 创建一个临时表：

```
Insert into BatchTable (ID, Seq) Select (O.ID, Sequence.Next) 
From MyObject O Where ... 
```

在对象的小工作量单位中：

```
Select Min(B.Seq), Max(B.Seq) From BatchTable;

for (batch = minBatch; batch <= maxBatch; batch += size) {
 beginTransaction();
 results = query("Select O From MyObject O, BatchTable B 
                  Where O.ID = B.ID and (? <= B.Seq AND B.Seq < ?)");

 exportXML(results);
 for (MyObject O : results) {
  O.setProcessed(True);
  O.update();
 }
 commit();
} 
```

* * *

## 回答 #5

> 赞同：-1
> 
> 时间：2008-11-16T17:33:10.477

另外，请查看第 19.1.4 节和第 19.1.5 节应该做的批量获取。 [http://www.hibernate.org/hib_docs/v3/reference/en-US/html_single/#queryhql-joins-forms](http://www.hibernate.org/hib_docs/v3/reference/en-US/html_single/#queryhql-joins-forms)

# dll - dllimport 无法找到 dll，即使它位于 PATH 中

> ID：294080
> 
> 赞同：7
> 
> 时间：2008-11-16T16:43:17.957
> 
> 标签：dll, path, pinvoke, dllimport

我使用 [Dllimport("DllName.dll")] 我确定我的 dll 的路径存在于进程 PATH 环境变量中，但我仍然得到“找不到 DllName.dll”

* * *

## 回答 #1

> 赞同：13
> 
> 时间：2009-03-17T12:56:09.183

“找不到 DllName.dll”也可能意味着 DllImport 没有找到 DllName.dll 依赖项之一。

抓取[Dependecy Walker](http://www.dependencywalker.com/)以检查您缺少哪个依赖项。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2008-11-16T17:05:06.087

我建议您使用 FileMon (sysinternals.com) 来检查您对库位置的假设是否正确。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2008-11-16T17:52:01.577

加载 DLL 时，DllImport 不参考 PATH 环境变量。我相当肯定 DllImport 遵循在按名称引用 DLL 时在本机程序中加载本机 DLL 的标准规则。这是一篇详细介绍这些规则的文章

[http://msdn.microsoft.com/en-us/library/ms682586.aspx](http://msdn.microsoft.com/en-us/library/ms682586.aspx)

我发现加载 DLL 的最简单方法就是将它放在与我正在执行的程序相同的位置。

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2017-02-10T20:51:05.190

我 `const string lcms2Path = "C:\\lcms2.dll";`在 C# 应用程序中使用的时间最长。但最后将 DLL 移动到 BIN 文件夹，这很完美`[DllImport("lcms2.dll")]`。

# c# - 计时器、UI 框架和不良耦合 - 有什么想法吗？

> ID：294092
> 
> 赞同：2
> 
> 时间：2008-11-16T16:52:18.623
> 
> 标签：c#, .net, wpf, timer, coupling

我刚刚编写了一个小型 XBox 360 无线控制器托管接口，该接口基本上包裹了低级[SlimDX](http://slimdx.mdxinfo.com/wiki/index.php?title=Main_Page)包装器库，并为 XBOX 360 控制器提供了一个简单的托管 API。

在内部，该类每 N 毫秒轮询一次游戏手柄，并在检测到控制器底层状态的变化时触发事件。

我正在经历一些计时器的死胡同，这基本上迫使我在两个邪恶中取其较小的一个：

*   要么使我的 XBox360GamePad 类 UI 框架特定（即支持 WPF/WinForms 将被硬编码在类中，并且类必须引用这些框架......）

*   使类完全与框架无关，但强制用户使用 Dispatcher.Invoke / Invoke() 调用来散布他们的代码，以便能够根据生成的事件更新 UI。

如果我选择后一个选项（使代码 UI 不可知），那么我基本上使用“通用” System.Timers.Timer 或任何不依赖 UI 的计时器。在那种情况下，我最终会从无法直接更新 UI 的线程生成/调用事件，即在 WPF 中，我将不得不通过（丑陋的）使用 Dispatcher.Invoke 来发布源自 360 控制器类的每个更新.

另一方面，如果我在 XBox 360 Controller 类中使用 DispatcherTimer 我有一个工作组件可以直接更新 UI 而不会大惊小怪，但是现在我的整个控制器类都与 WPF 耦合，并且它不能在没有被使用的情况下使用依赖于 WPF（即在纯控制台应用程序中）

我正在寻找的是某种解决方案，它可以让我既不依赖于框架，又可以更新 UI，而无需求助于各种 Dispatcher.Invoke() 技术......例如，如果有一个共享的基础所有计时器的类，我可以根据相关场景以某种方式将计时器作为依赖项注入。有没有人成功处理过这类问题？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2008-11-16T16:58:33.790

轮询架构是唯一的选择吗？

无论如何，我个人会重组系统，以便外部世界可以订阅从控制器类触发的事件。

如果您希望控制器在正确的线程上下文中触发事件，那么我将为 ISynchronizeInvoke 接口添加一个属性，如果此属性在控制器内部为非 null，则使用该接口，否则只需直接调用事件，on控制器运行的线程。

例如，这将允许您将整个轮询事情变成一个线程，该线程每 N 毫秒唤醒一次以完成其工作，或者甚至使用事件对象来等待事件（如果 360 控制器架构有这样的东西）。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2008-11-16T17:34:58.540

360 控制器只能报告它的当前状态。没有其他方法可以在没有轮询的情况下获得状态。在我看来，使用 System.Threading.Timer 或打开一个执行 Thread.Sleep() 的新线程实际上是相同的，它们都实现了无 UI 计时器类的功能。

感谢您提到 ISynchronizeInvoke，我在 Google 上搜索了更多内容，发现有人分享我的痛苦，甚至可能有解决方案：http: [//geekswithblogs.net/robp/archive/2008/03/28/why-doesnt-dispatcher-implement -isynchronizeinvoke.aspx](http://geekswithblogs.net/robp/archive/2008/03/28/why-doesnt-dispatcher-implement-isynchronizeinvoke.aspx)

我会试试他的代码并保持这个线程发布......谢谢你的提示！

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2008-11-16T19:03:32.917

所以...看来信息/代码@ [http://geekswithblogs.net/robp/archive/2008/03/28/why-doesnt-dispatcher-implement-isynchronizeinvoke.aspx](http://geekswithblogs.net/robp/archive/2008/03/28/why-doesnt-dispatcher-implement-isynchronizeinvoke.aspx)确实提供了一个可行的解决方案。该代码完全独立于任何 UI，而是仅依赖于 ISynchronizeInvoke 以进行适当的 UI/线程集成。

刚用过这个，我还是有点不愿意让它保持原样。

我的问题的要点是每个事件调用函数看起来像这样：

```
protected virtual void OnLeftThumbStickMove(ThumbStickEventArgs e)
{
  if (LeftThumbStickMove == null) return;

  if (_syncObj == null || !_syncObj.InvokeRequired)
    LeftThumbStickMove(this, e);
  else
    _syncObj.BeginInvoke(LeftThumbStickMove, new object[] { this, e });
} 
```

以这种方式编写代码非常烦人且令人困惑，对我来说，这看起来就像是为了让该死的东西工作而大惊小怪。基本上我不喜欢用这么多逻辑来包装每个事件调用（！）

因此，我选择了不同/额外的策略：基本上，XBox360GamePad 类的构造函数现在看起来像这样：

```
public XBox360GamePad(UserIndex controllerIndex, Func<int, Action, object> timerSetupAction)
{
  CurrentController = new Controller(controllerIndex);
  _timerState = timerSetupAction(10, UpdateState);
} 
```

如您所见，它接受一个 Func 负责创建计时器并将其连接起来。

这意味着默认情况下，在 360 Controller 类中，我不需要使用任何特定于 UI 的计时器……本质上，我的控制器的“默认”构造函数如下所示：

```
public XBox360GamePad(UserIndex controllerIndex) : 
  this(controllerIndex, (i,f) => new Timer(delegate { f(); }, null, i, i)) {} 
```

我使用 lambda 函数来编写控制器类对计时器“服务”的依赖关系。

在 WPF 中，我使用更通用的构造函数来确保控件将使用 DispatcherTimer，如下所示：

```
 _gamePad = new XBox360GamePad(UserIndex.One, (i, f) => {
    var t = new DispatcherTimer(DispatcherPriority.Render) {Interval = new TimeSpan(0, 0, 0, 0, i) };
    t.Tick += delegate { f(); };
    t.Start();
    return t;
  }); 
```

这样，我基本上将它留给“用户”来为控件提供计时器实现，其中默认实现不必使用任何 WPF 或 WinForms 特定代码。

我个人觉得这种设计比使用 ISynchronizeInvoke 更有用/更好。

我很想听听喜欢这个/想要改进这个/对此感到厌恶的人的反馈。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2008-11-17T02:20:27.073

您还可以查看并发和协调运行时，它是 Microsoft Robotics Developers Studio 的一部分（但很快将成为独立产品）。

CCR 是线程协调器，它允许 MRDS 完全支持诸如操纵杆驱动机器人之类的东西，并在消息传递模型上运行。您可以设置从 Xbox 操纵杆请求数据的计时器，然后将数据发送到端口（队列）。然后，您设置在将数据发布到操纵杆端口以处理操作时调用的方法（接收器）。提供了 WinForms 的适配器，为 WPF 编写适配器并不难。

这是一篇很棒的文章，说明了如何在没有成熟的 MRDS 的情况下使用 CCR。 [http://msdn.microsoft.com/en-us/magazine/cc163556.aspx](http://msdn.microsoft.com/en-us/magazine/cc163556.aspx)

以我的经验，一旦掌握了 CCR 的基础知识，进行多线程并发异步编程实际上就变得容易了。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2008-11-17T08:46:54.830

@MattValerio：我知道 CCR，但这并不真正符合这里的要求，因为我计划将控制权放在 googlecode 上，而 CCR 不是框架或开源的一部分。

# iis - IIS 回收 Global.asax

> ID：294113
> 
> 赞同：7
> 
> 时间：2008-11-16T17:08:25.473
> 
> 标签：iis, events, global-asax, recycle

是否可以在 global.asax 中捕获回收事件？

我知道 Application_End 将被触发，但有没有办法知道它是由应用程序池的回收触发的？

谢谢，Lieven Cardoen 又名 Johlero

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2008-11-19T16:59:07.313

我在**Scott Guthries 的博客**上找到了这篇文章：

[**记录 ASP.NET 应用程序关闭事件**](http://weblogs.asp.net/scottgu/archive/2005/12/14/433194.aspx)

> listserv 上的某个人最近询问是否有办法找出 ASP.NET 重新启动应用程序域的原因和时间。具体来说，他正在寻找在生产共享托管环境中的应用程序上触发它们的确切原因（是 web.config 文件更改、global.asax 更改、app_code 目录更改、目录删除更改、最大-num-compilations 达到配额、\bin 目录更改等）。
> 
> 我团队中的 Thomas 有一个很酷的代码片段，他编写了该代码片段，使用一些漂亮的私有反射技巧来捕获和记录这些信息。它很容易重用和添加到任何应用程序中，并且可以用来在任何你想要的地方记录信息（下面的代码使用 NT 事件日志来保存它——但你可以很容易地将它发送到数据库或通过电子邮件发送给管理员）。该代码适用于 ASP.NET V1.1 和 ASP.NET V2.0。
> 
> 只需将 System.Reflection 和 System.Diagnostics 命名空间添加到您的 Global.asax 类/文件中，然后使用以下代码添加 Application_End 事件：

```
public void Application_End() {

    HttpRuntime runtime = 
       (HttpRuntime) typeof(System.Web.HttpRuntime).InvokeMember("_theRuntime",
          BindingFlags.NonPublic | BindingFlags.Static | BindingFlags.GetField, 
          null, null, null);

    if (runtime == null)
        return;

    string shutDownMessage = 
       (string) runtime.GetType().InvokeMember("_shutDownMessage",
           BindingFlags.NonPublic | BindingFlags.Instance | BindingFlags.GetField,
           null, runtime, null);

    string shutDownStack = 
       (string) runtime.GetType().InvokeMember("_shutDownStack",
           BindingFlags.NonPublic | BindingFlags.Instance | BindingFlags.GetField,
           null, runtime, null);

    if (!EventLog.SourceExists(".NET Runtime")) {
        EventLog.CreateEventSource(".NET Runtime", "Application");
    }

    EventLog log = new EventLog();
    log.Source = ".NET Runtime";

    log.WriteEntry(String.Format(
          "\r\n\r\n_shutDownMessage={0}\r\n\r\n_shutDownStack={1}", 
          shutDownMessage, shutDownStack),
       EventLogEntryType.Error);
} 
```

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2008-11-16T17:56:40.057

所以，这是一个如何工作的想法。

根据我[之前的回答](https://stackoverflow.com/questions/294113/iis-recycle-globalasax#294126)（附加到 AppDomain.CurrentDomain.ProcessExit）和[stephbu](https://stackoverflow.com/users/12702/stephbu)的评论：

> 这将捕获大多数结构化流程的拆解，例如 - 但我不确定它是否会捕获所有的拆解。例如 [http://blogs.msdn.com/jmstall/archive/2006/11/26/process-exit-event.aspx](http://blogs.msdn.com/jmstall/archive/2006/11/26/process-exit-event.aspx) 如果进程似乎被挂起，进程回收将终止进程 - 你的处理程序不会被调用。

我建议以下策略：

在（常规）ProcessExit 处理程序（我们假设不会在应用程序池回收时调用）中，将一些文件写入磁盘，如“ `app_domain_end_ok.tmp`”。

然后在 global.asax 的 Application_Start 中检查这个文件。如果它不存在，则表明应用程序没有以干净的方式终止（或者它是第一次启动）。检查后不要忘记从磁盘中删除此文件。

我自己没有尝试过，但值得一试。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2008-11-16T17:25:40.850

我自己从未尝试过，但您可以尝试将事件处理程序附加到 AppDomain 的 ProcessExit 事件。

```
...
AppDomain.CurrentDomain.ProcessExit += new EventHandler(OnExit);
...

void OnExit(object sender, EventArgs e) {
    // do something
} 
```

*我希望这有帮助！*

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2016-11-10T11:48:39.157

我附加到 DomainUnload 事件要成功得多，它是在 AppPool 回收和 AppPool 本身停止时触发的。

`AppDomain.CurrentDomain.DomainUnload += this.CurrentDomainOnProcessExit;`

# .net - 如何使用 Lucene.NET 索引和查找数字？

> ID：294115
> 
> 赞同：5
> 
> 时间：2008-11-16T17:11:05.530
> 
> 标签：.net, full-text-search, lucene, lucene.net

[我已经使用Lucene.NET](http://incubator.apache.org/lucene.net/)（2.0 版）实现了对网站的全文搜索。索引和搜索效果很好，但我有一个问题。如果我**查找数字**（电话号码、产品编号等）作为搜索词，我不会得到任何结果文档。

我正在使用 Lucene.Net.Analysis.SimpleAnalyzer 类。我想我必须更改 Analyzer 和/或 Tokenizer。

有什么建议吗？

*谢谢！*

* * *

## 回答 #1

> 赞同：14
> 
> 时间：2008-11-16T17:25:17.327

构建 Lucene 文档时，您可以为每个字段选择不同的索引选项。对于不想标记化的字段，您需要选择 Field.Index.UN_TOKENIZED 选项。这将使您的电话号码和产品号码保持完整。

我还建议使用 StandardAnalyzer，因为它不会像 SimpleAnalyzer 那样去除数字。

为索引和搜索使用相同的分析器以获得一致的结果也很重要。

# .net - 系统在哪里存储图标位置？

> ID：294116
> 
> 赞同：13
> 
> 时间：2008-11-16T17:11:44.640
> 
> 标签：.net, windows

任何文件夹上的“图标视图”和“文件夹视图”实际上都是一个 SysListView。如果您取消选中图标的自动排列，您可以在图标周围移动，下次打开文件夹时，所有图标都与上次相同。

我的问题是，系统在哪里存储图标的 x 和 y 位置？

* * *

## 回答 #1

> 赞同：17
> 
> 时间：2008-11-16T17:20:01.017

[Windows XP（或 Vista）中桌面图标放置](http://www.edugeek.net/forums/windows/15789-sort-desktop-icons-name-windows-xp.html)的设置位于

```
HKCU\Software\Microsoft\Windows\Shell\Bags\1\Desktop 
```

注册表项。

此注册表项包含许多值，其中最相关的是 ItemPos<screenresolution> 值、Sort 值和 FFlags 值。

sort 值控制图标的排序顺序（按名称、类型、大小等），FFlags 值控制图标的排列（对齐网格、自动对齐等）

最后，可能有任意数量的 ItemPos 值（附加不同的屏幕分辨率，例如 ItemPos800x600），它们控制用户定义的图标在不同屏幕分辨率下的位置。

有关`HKCU\Software\Microsoft\Windows\Shell`值内容的更多详细信息：

[ShellBagsView v1.05](http://www.nirsoft.net/utils/shell_bags_view.html)

![贝壳包查看](https://i.stack.imgur.com/M0tJb.gif)

关于用于选择的任何文件夹的**图标视图**，我相信图标的位置将存储在：

```
HKEY_CURRENT_USER\Software\Classes\Local Settings\Software\Microsoft\Windows\Shell\Bags\[x]\Shell\{yyyyyyy-yy...}\ItemPos 
```

'x' 代表您的许多文件夹特定设置之一。

# asp.net-mvc - 创建新的 ASP.Net MVC 项目 - 单元测试对话框不显示

> ID：294117
> 
> 赞同：2
> 
> 时间：2008-11-16T17:14:14.960
> 
> 标签：asp.net-mvc, visual-studio-2008, unit-testing

当我创建一个 ASP.Net MVC Web 应用程序类型的新项目时，我希望单元测试应用程序的对话框出现，但它没有。在我可以创建的产品类型中也找不到单元测试应用程序。如何设置我的 VS 以显示对话框？

我已经安装了 Visual Studio 2008、.Net Framework 3.5 SP1 和 ASP.Net MVC Framework (Beta)。

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2008-11-16T19:48:57.817

正如@MrJavaGuy 所说，您至少需要安装专业版而不是快速版的 VS2008。或者，您可以安装 nUnit 和/或 TestDriven.Net 并获得单元测试功能。有关 nUnit 的信息可以在[http://www.nunit.org/](http://www.nunit.org/index.php)和 TestDriven.Net 在[http://www.testdriven.net/](http://www.testdriven.net/)上找到。即使您拥有 Visual Studio 的测试功能，我也推荐 TestDriven.Net。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-01-28T08:37:46.893

结果发现其中一个问题是我没有在我的 VS 安装中安装测试功能 - 运行安装程序并添加功能使一切顺利进行 =)

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2008-11-16T22:12:37.260

与 Visual Web Developer Express 有同样的问题，我找到了这个博客。

[http://blogs.msdn.com/webdevtools/archive/2008/05/30/asp-net-mvc-preview-3-tooling-updates.aspx](http://blogs.msdn.com/webdevtools/archive/2008/05/30/asp-net-mvc-preview-3-tooling-updates.aspx)

我下载了

[http://www.box.net/shared/zmp0cdxsss](http://www.box.net/shared/zmp0cdxsss)

这对我有用.. 不确定这是否会解决您的问题。祝你好运。

# c# - C# / Web 开发学习策略

> ID：294128
> 
> 赞同：15
> 
> 时间：2008-11-16T17:27:09.787
> 
> 标签：c#

对于 .NET Web 开发和编程的新手，谁会选择 C# 作为首选语言？

先学习 C# 而不尝试将其应用于 Web 开发会更好吗？似乎大多数 C# 文献都使用控制台或 Windows 窗体作为学习平台。那么这会是最好的方向吗？

或者你应该练习 Web 开发并尝试学习 C#？

* * *

## 回答 #1

> 赞同：12
> 
> 时间：2008-11-16T17:33:50.040

您需要了解 C# 的基础知识才能开发任何有用的东西，无论是 ASP.NET 网站、Windows 客户端还是 Web 服务。

我将从一些关于类型、类、方法、事件等基础知识的优秀教程开始，以掌握 C#。[C# Station在这里](http://www.csharp-station.com/Tutorial.aspx)有一些很好的入门教程。

要开发特定于 Web 的技能，请从 HTML 和 CSS 开始。

然后看看 ASP.NET 平台如何集成 C#（应用程序代码）和 HTML 和 CSS（演示代码）。

还有祝你好运！

* * *

## 回答 #2

> 赞同：12
> 
> 时间：2008-11-16T17:36:16.960

我已经帮助几个人从以前的语言（如 C++）以及没有使用 C# 的经验中学习。

在尝试任何特定类型的开发（如 Web 内容）之前，一定要学习 C#。只会迷惑新人。

如果您已经了解一种语言，那么将一个小型应用程序从旧语言重新实现为新语言会很有帮助。

此外，通常还有一些关于通用语言转换的书籍——C# for C++ 开发人员书籍就是很好的例子。我建议阅读它们。

这是我的教学计划（简短摘要）：

1.  概述 C# 语言（类型、方法、Main()
2.  让学生从控制台编写 Hello World。
3.  让学生从控制台执行“Simon Says”游戏。
4.  让学生在 WPF 中实现“Simon Says”。（使用设计器。这曾经是 Windows 窗体，但 WPF 是更干净的模型）
5.  对 C# 中更高级的功能进行调查 - 委托、事件等。
6.  让学生在 ASP.NET 中实现“Simon Says”。

* * *

## 回答 #3

> 赞同：10
> 
> 时间：2008-11-16T17:44:46.537

我不同意在泡沫中学习 C#。如果您的最终目标是进行 Web 开发，为什么要从开发任何东西开始呢？

一个例外是控制台。在控制台中学习 if、for、foreach 等非常容易。

你有任何编程经验，网络或其他方面吗？如果答案是否定的，我会先学习 XHTML 和 CSS。网上有一百万个教程，而且非常简单。

如果您已经有 Web 编程经验，那么学习 C# 并应用到 Web 应该不会很困难。确保您阅读了两种类型的 ASP.NET（WebForms 和 MVC）的基础知识并选择对您更有意义的。浏览 asp.net 上的教程，你应该有一个很好的开始。

反正我就是这样做的。

* * *

## 回答 #4

> 赞同：2
> 
> 时间：2008-12-26T00:15:34.560

我的建议是两者都做，就好像您只做 Web 开发一样，那么控制台或 Windows 应用程序可能没有意义完成。另一点是，C# 的某些部分可能特定于 Webforms，例如 AJAX 功能，仅举一个例子，尽管 ASP.Net MVC 在某种程度上可能是另一个值得研究的地方。

I would start with the simple, "Hello World!" example(Which can be done in a few ways in the web case and it is worth knowing all of them, e.g. straight HTML that doesn't have anything fancy, a Response.Write in the .aspx file, a Response.Write in the code behind, and using the "<%=" and "%>" tags for the last form) and then expand on that by using storage in files or databases and work towards building up various skills around a core of seeing C# used within web stuff.

# sql - 将 Sql Server 2005 数据库导入 Sql Server express 2008

> ID：294136
> 
> 赞同：2
> 
> 时间：2008-11-16T17:36:57.770
> 
> 标签：sql, sql-server-2008

有什么方法可以将 2005 年的数据库备份导入 2008 年速成版。我不得不求助于编写数据库脚本，然后通过 DTS 导入所有数据。每当我尝试直接从备份文件导入时，它都会说不要导入到新版本的 sql server 中，否则我会收到以下错误。

标题：Microsoft SQL Server 管理工作室

指定的演员表无效。(SqlManagerUI)

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2008-11-16T18:00:55.180

SQL 2005 备份应该在 2008 年恢复没有问题（我自己做过很多次）。关于版本，您收到了哪些确切的错误消息？另一个错误（Specified cast is not valid）似乎是 Management Studio 错误，而不是服务器错误。您拥有 2008 服务器的完整权限吗？

看看这个问题 - [any-reason-to-have-sql-server-2005-and-2008-installed-on-same-machine](https://stackoverflow.com/questions/146750/any-reason-to-have-sql-server-2005-and-2008-installed-on-same-machine) - 讨论了恢复 SQL2005 备份和附加 SQL2005 数据文件。

（当然你不能附加生产数据库。要附加非生产数据库只需分离它们，制作这些文件的文件级副本并将副本附加到新服务器。原始文件也需要附加到原始服务器:)）

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2008-11-16T21:33:37.730

I imagine that you are in a development process where your data will have to be regularly copied to you SQL 2008 server.

You can then think of configuring a replication between the SQL 2005 server (publisher) and SQL Server Express 2008 (suscriber). Depending on your requirements, you have the choice between snapshot or merge replication. If no update is done on the suscriber side, go for snapshot.

Once you want to have your 2008 server running independantely from the publisher, just delete the replication.

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2010-04-16T13:50:01.627

一个有效的 SQL Server 2005 Express 备份文件应该能够恢复到 SQL Server 2008 Express。如果 SQL Server 2005 备份来自 Standard 或 Enterprise 版本，您可能会遇到将其还原到 Express 的问题。创建备份的用户上下文不应影响恢复该备份的能力。

您可以做的一件事是尝试运行还原操作作为验证，而不实际尝试运行还原。这将告诉您备份文件是否有效。您可以使用以下语法：

```
RESTORE VERIFYONLY
FROM yourbackupfile.bak 
```

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2011-07-14T09:46:17.747

如果可能的话，我还建议尝试简单地从 2005 年分离原始数据库，然后附加 2008 年版的文件。

虽然我自己只在标准版上尝试过，但它在保持数据库设置为 2005 的兼容模式下完美运行。

您是否尝试过运行升级顾问[http://www.microsoft.com/download/en/details.aspx?id=11455](http://www.microsoft.com/download/en/details.aspx?id=11455) - 它可能会突出显示升级原始数据库的问题。

# c# - 在 C# 中合并字典

> ID：294138
> 
> 赞同：586
> 
> 时间：2008-11-16T17:39:56.440
> 
> 标签：c#, dictionary, merge

`Dictionary<T1,T2>`在 C#中合并 2 个或多个字典 ( ) 的最佳方法是什么？（像 LINQ 这样的 3.0 特性很好）。

我正在考虑一个方法签名：

```
public static Dictionary<TKey,TValue>
                 Merge<TKey,TValue>(Dictionary<TKey,TValue>[] dictionaries); 
```

或者

```
public static Dictionary<TKey,TValue>
                 Merge<TKey,TValue>(IEnumerable<Dictionary<TKey,TValue>> dictionaries); 
```

**编辑：**从 JaredPar 和 Jon Skeet 那里得到了一个很酷的解决方案，但我正在考虑处理重复键的东西。在发生冲突的情况下，将哪个值保存到字典中并不重要，只要它是一致的即可。

* * *

## 回答 #1

> 赞同：368
> 
> 时间：2008-11-16T17:46:11.527

这部分取决于您遇到重复项时想要发生的情况。例如，您可以这样做：

```
var result = dictionaries.SelectMany(dict => dict)
                         .ToDictionary(pair => pair.Key, pair => pair.Value); 
```

如果您获得任何重复的键，那将引发异常。

编辑：如果你使用 ToLookup 那么你会得到一个查找，每个键可以有多个值。然后，您*可以*将其转换为字典：

```
var result = dictionaries.SelectMany(dict => dict)
                         .ToLookup(pair => pair.Key, pair => pair.Value)
                         .ToDictionary(group => group.Key, group => group.First()); 
```

这有点难看——而且效率低下——但就代码而言，这是最快的方法。（诚​​然，我没有测试过它。）

当然，您可以编写自己的 ToDictionary2 扩展方法（使用更好的名称，但我现在没有时间想一个）——这并不难，只需覆盖（或忽略）重复键。重要的一点（在我看来）是使用[`SelectMany`](https://docs.microsoft.com/en-us/dotnet/api/system.linq.enumerable.selectmany)，并意识到字典支持对其键/值对的迭代。

* * *

## 回答 #2

> 赞同：319
> 
> 时间：2011-07-14T14:51:20.647

我会这样做：

```
dictionaryFrom.ToList().ForEach(x => dictionaryTo.Add(x.Key, x.Value)); 
```

简单易行。根据[这篇博客文章](https://codeblog.jonskeet.uk/2009/01/29/for-vs-foreach-on-arrays-and-lists/)，它甚至比大多数循环更快，因为它的底层实现通过索引而不是枚举器访问元素[（参见这个答案）](https://stackoverflow.com/a/226029/2857326)。

如果有重复，它当然会抛出异常，因此您必须在合并之前进行检查。

* * *

## 回答 #3

> 赞同：113
> 
> 时间：2010-04-21T02:05:31.717

如果有多个键（“righter”键替换“lefter”键），这不会爆炸，可以合并多个字典（如果需要）并保留类型（限制它需要一个有意义的默认公共构造函数）：

```
public static class DictionaryExtensions
{
    // Works in C#3/VS2008:
    // Returns a new dictionary of this ... others merged leftward.
    // Keeps the type of 'this', which must be default-instantiable.
    // Example: 
    //   result = map.MergeLeft(other1, other2, ...)
    public static T MergeLeft<T,K,V>(this T me, params IDictionary<K,V>[] others)
        where T : IDictionary<K,V>, new()
    {
        T newMap = new T();
        foreach (IDictionary<K,V> src in
            (new List<IDictionary<K,V>> { me }).Concat(others)) {
            // ^-- echk. Not quite there type-system.
            foreach (KeyValuePair<K,V> p in src) {
                newMap[p.Key] = p.Value;
            }
        }
        return newMap;
    }

} 
```

* * *

## 回答 #4

> 赞同：56
> 
> 时间：2008-11-16T17:40:23.037

简单的解决方案是：

```
using System.Collections.Generic;
...
public static Dictionary<TKey, TValue>
    Merge<TKey,TValue>(IEnumerable<Dictionary<TKey, TValue>> dictionaries)
{
    var result = new Dictionary<TKey, TValue>();
    foreach (var dict in dictionaries)
        foreach (var x in dict)
            result[x.Key] = x.Value;
    return result;
} 
```

* * *

## 回答 #5

> 赞同：27
> 
> 时间：2008-11-16T17:44:12.547

尝试以下

```
static Dictionary<TKey, TValue>
    Merge<TKey, TValue>(this IEnumerable<Dictionary<TKey, TValue>> enumerable)
{
    return enumerable.SelectMany(x => x).ToDictionary(x => x.Key, y => y.Value);
} 
```

* * *

## 回答 #6

> 赞同：22
> 
> 时间：2010-04-06T15:28:54.353

```
Dictionary<String, String> allTables = new Dictionary<String, String>();
allTables = tables1.Union(tables2).ToDictionary(pair => pair.Key, pair => pair.Value); 
```

* * *

## 回答 #7

> 赞同：21
> 
> 时间：2014-07-08T05:27:59.293

我参加聚会很晚，可能错过了一些东西，但是如果没有重复的键，或者正如 OP 所说，“在发生冲突的情况下，将哪个值保存到字典中并不重要，只要它是一致，”这个有什么问题（将D2合并到D1）？

```
foreach (KeyValuePair<string,int> item in D2)
{
    D1[item.Key] = item.Value;
} 
```

看起来很简单，也许太简单了，我想知道我是否遗漏了什么。这就是我在一些我知道没有重复键的代码中使用的。不过，我仍在测试中，所以我现在很想知道我是否忽略了某些东西，而不是稍后再发现。

* * *

## 回答 #8

> 赞同：16
> 
> 时间：2014-08-08T22:22:07.893

以下对我有用。如果有重复，它将使用 dictA 的值。

```
public static IDictionary<TKey, TValue> Merge<TKey, TValue>(this IDictionary<TKey, TValue> dictA, IDictionary<TKey, TValue> dictB)
    where TValue : class
{
    return dictA.Keys.Union(dictB.Keys).ToDictionary(k => k, k => dictA.ContainsKey(k) ? dictA[k] : dictB[k]);
} 
```

* * *

## 回答 #9

> 赞同：15
> 
> 时间：2009-08-06T04:26:12.620

这是我使用的辅助函数：

```
using System.Collections.Generic;
namespace HelperMethods
{
    public static class MergeDictionaries
    {
        public static void Merge<TKey, TValue>(this IDictionary<TKey, TValue> first, IDictionary<TKey, TValue> second)
        {
            if (second == null || first == null) return;
            foreach (var item in second) 
                if (!first.ContainsKey(item.Key)) 
                    first.Add(item.Key, item.Value);
        }
    }
} 
```

* * *

## 回答 #10

> 赞同：11
> 
> 时间：2019-05-08T05:27:16.427

**选项 1：**如果您确定两个字典中没有重复键，这取决于您想要发生的情况。比你能做的：

```
var result = dictionary1.Union(dictionary2).ToDictionary(k => k.Key, v => v.Value) 
```

**注意：**如果您在字典中获得任何重复的键，这将引发错误。

**选项 2：**如果您可以拥有重复键，那么您必须使用 where 子句来处理重复键。

```
var result = dictionary1.Union(dictionary2.Where(k => !dictionary1.ContainsKey(k.Key))).ToDictionary(k => k.Key, v => v.Value) 
```

**注意：**它不会得到重复的密钥。如果有任何重复的键，它将获得字典 1 的键。

**选项 3：**如果您想使用 ToLookup。然后你会得到一个查找，每个键可以有多个值。您可以将该查找转换为字典：

```
var result = dictionaries.SelectMany(dict => dict)
                         .ToLookup(pair => pair.Key, pair => pair.Value)
                         .ToDictionary(group => group.Key, group => group.First()); 
```

* * *

## 回答 #11

> 赞同：7
> 
> 时间：2008-11-16T17:55:53.567

添加`params`重载怎么样？

此外，您应该键入它们以`IDictionary`获得最大的灵活性。

```
public static IDictionary<TKey, TValue> Merge<TKey, TValue>(IEnumerable<IDictionary<TKey, TValue>> dictionaries)
{
    // ...
}

public static IDictionary<TKey, TValue> Merge<TKey, TValue>(params IDictionary<TKey, TValue>[] dictionaries)
{
    return Merge((IEnumerable<TKey, TValue>) dictionaries);
} 
```

* * *

## 回答 #12

> 赞同：6
> 
> 时间：2013-02-20T10:28:25.497

基于上面的答案，但添加一个 Func 参数让调用者处理重复项：

```
public static Dictionary<TKey, TValue> Merge<TKey, TValue>(this IEnumerable<Dictionary<TKey, TValue>> dicts, 
                                                           Func<IGrouping<TKey, TValue>, TValue> resolveDuplicates)
{
    if (resolveDuplicates == null)
        resolveDuplicates = new Func<IGrouping<TKey, TValue>, TValue>(group => group.First());

    return dicts.SelectMany<Dictionary<TKey, TValue>, KeyValuePair<TKey, TValue>>(dict => dict)
                .ToLookup(pair => pair.Key, pair => pair.Value)
                .ToDictionary(group => group.Key, group => resolveDuplicates(group));
} 
```

* * *

## 回答 #13

> 赞同：5
> 
> 时间：2013-04-11T20:00:23.893

派对现在几乎死了，但这里有一个 user166390 的“改进”版本，它进入了我的扩展库。除了一些细节之外，我还添加了一个委托来计算合并值。

```
/// <summary>
/// Merges a dictionary against an array of other dictionaries.
/// </summary>
/// <typeparam name="TResult">The type of the resulting dictionary.</typeparam>
/// <typeparam name="TKey">The type of the key in the resulting dictionary.</typeparam>
/// <typeparam name="TValue">The type of the value in the resulting dictionary.</typeparam>
/// <param name="source">The source dictionary.</param>
/// <param name="mergeBehavior">A delegate returning the merged value. (Parameters in order: The current key, The current value, The previous value)</param>
/// <param name="mergers">Dictionaries to merge against.</param>
/// <returns>The merged dictionary.</returns>
public static TResult MergeLeft<TResult, TKey, TValue>(
    this TResult source,
    Func<TKey, TValue, TValue, TValue> mergeBehavior,
    params IDictionary<TKey, TValue>[] mergers)
    where TResult : IDictionary<TKey, TValue>, new()
{
    var result = new TResult();
    var sources = new List<IDictionary<TKey, TValue>> { source }
        .Concat(mergers);

    foreach (var kv in sources.SelectMany(src => src))
    {
        TValue previousValue;
        result.TryGetValue(kv.Key, out previousValue);
        result[kv.Key] = mergeBehavior(kv.Key, kv.Value, previousValue);
    }

    return result;
} 
```

* * *

## 回答 #14

> 赞同：5
> 
> 时间：2014-10-13T19:44:23.213

考虑到[字典键查找和删除的性能，](http://theburningmonk.com/2011/03/hashset-vs-list-vs-dictionary/)因为它们是哈希操作，并且考虑到问题的措辞是*最好*的方法，我认为下面是一种完全有效的方法，而其他方法有点过于复杂，恕我直言。

```
 public static void MergeOverwrite<T1, T2>(this IDictionary<T1, T2> dictionary, IDictionary<T1, T2> newElements)
    {
        if (newElements == null) return;

        foreach (var e in newElements)
        {
            dictionary.Remove(e.Key); //or if you don't want to overwrite do (if !.Contains()
            dictionary.Add(e);
        }
    } 
```

或者，如果您在多线程应用程序中工作并且您的字典无论如何都需要是线程安全的，那么您应该这样做：

```
 public static void MergeOverwrite<T1, T2>(this ConcurrentDictionary<T1, T2> dictionary, IDictionary<T1, T2> newElements)
    {
        if (newElements == null || newElements.Count == 0) return;

        foreach (var ne in newElements)
        {
            dictionary.AddOrUpdate(ne.Key, ne.Value, (key, value) => value);
        }
    } 
```

然后，您可以包装它以使其处理字典的枚举。无论如何，您正在查看大约 ~O(3n) （所有条件都是完美的），因为这将在幕后`.Add()`进行额外的、不必要但实际上是免费的。`Contains()`我不认为它会变得更好。

如果你想限制对大型集合的额外操作，你应该总结`Count`你要合并的每个字典的容量，并将目标字典的容量设置为那个，这样可以避免以后调整大小的成本。所以，最终产品是这样的......

```
 public static IDictionary<T1, T2> MergeAllOverwrite<T1, T2>(IList<IDictionary<T1, T2>> allDictionaries)
    {
        var initSize = allDictionaries.Sum(d => d.Count);
        var resultDictionary = new Dictionary<T1, T2>(initSize);
        allDictionaries.ForEach(resultDictionary.MergeOverwrite);
        return resultDictionary;
    } 
```

请注意，我采用了`IList<T>`这种方法...主要是因为如果您采用`IEnumerable<T>`，您已经向同一集合的多个枚举敞开了大门，如果您从延迟的 LINQ 中获取字典集合，这可能会非常昂贵陈述。

* * *

## 回答 #15

> 赞同：4
> 
> 时间：2019-08-14T07:53:00.840

在没有 LINQ 的情况下再次简化，如果存在，则默认为非破坏性合并，如果为 true，则完全覆盖，而不是使用枚举。它仍然适合我自己的需求，而无需任何更高级的代码：

```
using System.Collections.Generic;
using System.Linq;

public static partial class Extensions
{
    public static void Merge<K, V>(this IDictionary<K, V> target, 
                                   IDictionary<K, V> source, 
                                   bool overwrite = false)
    {
        foreach (KeyValuePair _ in source)
            if (overwrite || !target.ContainsKey(_.Key))
                target[_.Key] = _.Value;
    }
} 
```

* * *

## 回答 #16

> 赞同：4
> 
> 时间：2019-08-20T10:39:41.287

请注意，如果您使用名为“添加”的扩展方法，您可以使用集合初始化器来组合尽可能多的字典，如下所示：

```
public static void Add<K, V>(this Dictionary<K, V> d, Dictionary<K, V> other) {
  foreach (var kvp in other)
  {
    if (!d.ContainsKey(kvp.Key))
    {
      d.Add(kvp.Key, kvp.Value);
    }
  }
}

var s0 = new Dictionary<string, string> {
  { "A", "X"}
};
var s1 = new Dictionary<string, string> {
  { "A", "X" },
  { "B", "Y" }
};
// Combine as many dictionaries and key pairs as needed
var a = new Dictionary<string, string> {
  s0, s1, s0, s1, s1, { "C", "Z" }
}; 
```

* * *

## 回答 #17

> 赞同：2
> 
> 时间：2015-03-22T04:22:47.903

@Tim：应该是评论，但评论不允许代码编辑。

```
Dictionary<string, string> t1 = new Dictionary<string, string>();
t1.Add("a", "aaa");
Dictionary<string, string> t2 = new Dictionary<string, string>();
t2.Add("b", "bee");
Dictionary<string, string> t3 = new Dictionary<string, string>();
t3.Add("c", "cee");
t3.Add("d", "dee");
t3.Add("b", "bee");
Dictionary<string, string> merged = t1.MergeLeft(t2, t2, t3); 
```

注意：我将@ANeves 的修改应用于@Andrew Orsich 的解决方案，所以 MergeLeft 现在看起来像这样：

```
public static Dictionary<K, V> MergeLeft<K, V>(this Dictionary<K, V> me, params IDictionary<K, V>[] others)
    {
        var newMap = new Dictionary<K, V>(me, me.Comparer);
        foreach (IDictionary<K, V> src in
            (new List<IDictionary<K, V>> { me }).Concat(others))
        {
            // ^-- echk. Not quite there type-system.
            foreach (KeyValuePair<K, V> p in src)
            {
                newMap[p.Key] = p.Value;
            }
        }
        return newMap;
    } 
```

* * *

## 回答 #18

> 赞同：2
> 
> 时间：2017-01-26T17:05:32.887

我知道这是一个老问题，但既然我们现在有了 LINQ，你可以像这样在一行中完成它

```
Dictionary<T1,T2> merged;
Dictionary<T1,T2> mergee;
mergee.ToList().ForEach(kvp => merged.Add(kvp.Key, kvp.Value)); 
```

或者

```
mergee.ToList().ForEach(kvp => merged.Append(kvp)); 
```

* * *

## 回答 #19

> 赞同：2
> 
> 时间：2018-09-05T12:33:17.753

害怕看到复杂的答案，因为是 C# 的新手。

这里有一些简单的答案。
合并 d1、d2 等.. 字典并处理任何重叠键（以下示例中的“b”）：

示例 1

```
{
    // 2 dictionaries,  "b" key is common with different values

    var d1 = new Dictionary<string, int>() { { "a", 10 }, { "b", 21 } };
    var d2 = new Dictionary<string, int>() { { "c", 30 }, { "b", 22 } };

    var result1 = d1.Concat(d2).GroupBy(ele => ele.Key).ToDictionary(ele => ele.Key, ele => ele.First().Value);
    // result1 is  a=10, b=21, c=30    That is, took the "b" value of the first dictionary

    var result2 = d1.Concat(d2).GroupBy(ele => ele.Key).ToDictionary(ele => ele.Key, ele => ele.Last().Value);
    // result2 is  a=10, b=22, c=30    That is, took the "b" value of the last dictionary
} 
```

示例 2

```
{
    // 3 dictionaries,  "b" key is common with different values

    var d1 = new Dictionary<string, int>() { { "a", 10 }, { "b", 21 } };
    var d2 = new Dictionary<string, int>() { { "c", 30 }, { "b", 22 } };
    var d3 = new Dictionary<string, int>() { { "d", 40 }, { "b", 23 } };

    var result1 = d1.Concat(d2).Concat(d3).GroupBy(ele => ele.Key).ToDictionary(ele => ele.Key, ele => ele.First().Value);
    // result1 is  a=10, b=21, c=30, d=40    That is, took the "b" value of the first dictionary

    var result2 = d1.Concat(d2).Concat(d3).GroupBy(ele => ele.Key).ToDictionary(ele => ele.Key, ele => ele.Last().Value);
    // result2 is  a=10, b=23, c=30, d=40    That is, took the "b" value of the last dictionary
} 
```

对于更复杂的场景，请参阅其他答案。
希望有帮助。

* * *

## 回答 #20

> 赞同：2
> 
> 时间：2018-09-12T09:41:38.520

```
using System.Collections.Generic;
using System.Linq;

public static class DictionaryExtensions
{
    public enum MergeKind { SkipDuplicates, OverwriteDuplicates }
    public static void Merge<K, V>(this IDictionary<K, V> target, IDictionary<K, V> source, MergeKind kind = MergeKind.SkipDuplicates) =>
        source.ToList().ForEach(_ => { if (kind == MergeKind.OverwriteDuplicates || !target.ContainsKey(_.Key)) target[_.Key] = _.Value; });
} 
```

您可以跳过/忽略（默认）或覆盖重复项：Bob 是您的叔叔，前提是您对 Linq 性能不太挑剔，而是喜欢像我一样简洁可维护的代码：在这种情况下，您可以删除默认 MergeKind.SkipDuplicates 以强制执行调用者的选择，并使开发人员认识到结果将是什么！

* * *

## 回答 #21

> 赞同：2
> 
> 时间：2019-05-15T12:42:15.357

来自@user166390 答案的版本，添加了一个`IEqualityComparer`参数以允许不区分大小写的键比较。

```
 public static T MergeLeft<T, K, V>(this T me, params Dictionary<K, V>[] others)
        where T : Dictionary<K, V>, new()
    {
        return me.MergeLeft(me.Comparer, others);
    }

    public static T MergeLeft<T, K, V>(this T me, IEqualityComparer<K> comparer, params Dictionary<K, V>[] others)
        where T : Dictionary<K, V>, new()
    {
        T newMap = Activator.CreateInstance(typeof(T), new object[] { comparer }) as T;

        foreach (Dictionary<K, V> src in 
            (new List<Dictionary<K, V>> { me }).Concat(others))
        {
            // ^-- echk. Not quite there type-system.
            foreach (KeyValuePair<K, V> p in src)
            {
                newMap[p.Key] = p.Value;
            }
        }
        return newMap;
    } 
```

* * *

## 回答 #22

> 赞同：1
> 
> 时间：2013-11-08T12:35:35.797

使用扩展方法进行合并。当有重复键时它不会抛出异常，而是用第二个字典中的键替换这些键。

```
internal static class DictionaryExtensions
{
    public static Dictionary<T1, T2> Merge<T1, T2>(this Dictionary<T1, T2> first, Dictionary<T1, T2> second)
    {
        if (first == null) throw new ArgumentNullException("first");
        if (second == null) throw new ArgumentNullException("second");

        var merged = new Dictionary<T1, T2>();
        first.ToList().ForEach(kv => merged[kv.Key] = kv.Value);
        second.ToList().ForEach(kv => merged[kv.Key] = kv.Value);

        return merged;
    }
} 
```

用法：

```
Dictionary<string, string> merged = first.Merge(second); 
```

* * *

## 回答 #23

> 赞同：1
> 
> 时间：2019-04-12T16:26:06.117

```
public static IDictionary<K, V> AddRange<K, V>(this IDictionary<K, V> one, IDictionary<K, V> two)
        {
            foreach (var kvp in two)
            {
                if (one.ContainsKey(kvp.Key))
                    one[kvp.Key] = two[kvp.Key];
                else
                    one.Add(kvp.Key, kvp.Value);
            }
            return one;
        } 
```

* * *

## 回答 #24

> 赞同：0
> 
> 时间：2014-05-29T21:03:38.887

使用`EqualityComparer`映射项目以比较不同的值/类型进行合并。在这里，我们将从`KeyValuePair`（枚举字典时的项目类型）映射到`Key`.

```
public class MappedEqualityComparer<T,U> : EqualityComparer<T>
{
    Func<T,U> _map;

    public MappedEqualityComparer(Func<T,U> map)
    {
        _map = map;
    }

    public override bool Equals(T x, T y)
    {
        return EqualityComparer<U>.Default.Equals(_map(x), _map(y));
    }

    public override int GetHashCode(T obj)
    {
        return _map(obj).GetHashCode();
    }
} 
```

用法：

```
// if dictA and dictB are of type Dictionary<int,string>
var dict = dictA.Concat(dictB)
                .Distinct(new MappedEqualityComparer<KeyValuePair<int,string>,int>(item => item.Key))
                .ToDictionary(item => item.Key, item=> item.Value); 
```

* * *

## 回答 #25

> 赞同：0
> 
> 时间：2017-10-11T20:34:20.940

或者 ：

```
public static IDictionary<TKey, TValue> Merge<TKey, TValue>( IDictionary<TKey, TValue> x, IDictionary<TKey, TValue> y)
    {
        return x
            .Except(x.Join(y, z => z.Key, z => z.Key, (a, b) => a))
            .Concat(y)
            .ToDictionary(z => z.Key, z => z.Value);
    } 
```

结果是一个联合，其中重复条目“y”获胜。

* * *

## 回答 #26

> 赞同：0
> 
> 时间：2021-05-17T18:36:44.870

`AddAll()`除了`Merge()`处理将一个字典添加到另一个字典的简单情况外，我将拆分@orip 的简单且非垃圾创建解决方案以提供就地处理。

```
using System.Collections.Generic;
...
public static Dictionary<TKey, TValue>
    AddAll<TKey,TValue>(Dictionary<TKey, TValue> dest, Dictionary<TKey, TValue> source)
{
    foreach (var x in source)
        dest[x.Key] = x.Value;
}

public static Dictionary<TKey, TValue>
    Merge<TKey,TValue>(IEnumerable<Dictionary<TKey, TValue>> dictionaries)
{
    var result = new Dictionary<TKey, TValue>();
    foreach (var dict in dictionaries)
        result.AddAll(dict);
    return result;
} 
```

* * *

## 回答 #27

> 赞同：0
> 
> 时间：2022-01-12T16:24:15.577

根据这篇文章的所有答案，这是我能想到的最通用的解决方案。

我创建了 IDictionary.Merge() 扩展的 2 个版本：

*   合并<T, U>(sourceLeft, sourceRight)
*   合并<T, U>(sourceLeft, sourceRight, Func<U, U, U> mergeExpression)

第二个是第一个的修改版本，它允许您指定一个 lambda 表达式来处理这样的重复：

```
Dictionary<string, object> customAttributes = 
  HtmlHelper
    .AnonymousObjectToHtmlAttributes(htmlAttributes)
    .ToDictionary(
      ca => ca.Key, 
      ca => ca.Value
    );

Dictionary<string, object> fixedAttributes = 
  new RouteValueDictionary(
    new { 
      @class = "form-control"
    }).ToDictionary(
      fa => fa.Key, 
      fa => fa.Value
    );

//appending the html class attributes
IDictionary<string, object> editorAttributes = fixedAttributes.Merge(customAttributes, (leftValue, rightValue) => leftValue + " " + rightValue); 
```

（可以重点关注`ToDictionary()`和`Merge()`部分）

`IDictionary`这是扩展类（右侧有 2 个扩展版本的集合）：

```
 public static class IDictionaryExtension
  {
    public static IDictionary<T, U> Merge<T, U>(this IDictionary<T, U> sourceLeft, IDictionary<T, U> sourceRight)
    {
      IDictionary<T, U> result = new Dictionary<T,U>();

      sourceLeft
        .Concat(sourceRight)
        .ToList()
        .ForEach(kvp => 
          result[kvp.Key] = kvp.Value
        );

      return result;
    }

    public static IDictionary<T, U> Merge<T, U>(this IDictionary<T, U> sourceLeft, IDictionary<T, U> sourceRight, Func<U, U, U> mergeExpression)
    {
      IDictionary<T, U> result = new Dictionary<T,U>();

      //Merge expression example
      //(leftValue, rightValue) => leftValue + " " + rightValue;

      sourceLeft
        .Concat(sourceRight)
        .ToList()
        .ForEach(kvp => 
          result[kvp.Key] =
            (!result.ContainsKey(kvp.Key))
              ? kvp.Value
              : mergeExpression(result[kvp.Key], kvp.Value)
        );

      return result;
    }

    public static IDictionary<T, U> Merge<T, U>(this IDictionary<T, U> sourceLeft, IEnumerable<IDictionary<T, U>> sourcesRight)
    {
      IDictionary<T, U> result = new Dictionary<T, U>();

      new[] { sourceLeft }
        .Concat(sourcesRight)
        .ToList()
        .ForEach(dic =>
          result = result.Merge(dic)
        );

      return result;
    }

    public static IDictionary<T, U> Merge<T, U>(this IDictionary<T, U> sourceLeft, IEnumerable<IDictionary<T, U>> sourcesRight, Func<U, U, U> mergeExpression)
    {
      IDictionary<T, U> result = new Dictionary<T, U>();

      new[] { sourceLeft }
        .Concat(sourcesRight)
        .ToList()
        .ForEach(dic =>
          result = result.Merge(dic, mergeExpression)
        );

      return result;
    }
  } 
```

`mergeExpression`让您轻松处理想要合并项目的方式，例如加法、除法、乘法或任何您想要的特定过程。

请注意，我尚未测试扩展的集合版本......它们可能仍需要一些调整。

此外，扩展不会修改原始字典，如果需要，您必须将其分配回去。

* * *

## 回答 #28

> 赞同：0
> 
> 时间：2022-01-20T15:23:58.740

这是我的解决方案：它的行为类似于`dict.update()`python 中的方法。

```
public static class DictionaryExtensions
{
    public static void Update<K,V>(this IDictionary<K, V> me, IDictionary<K, V> other)
    {
        foreach (var x in other)
        {
            me[x.Key] = x.Value;
        }
    }
} 
```

* * *

## 回答 #29

> 赞同：-1
> 
> 时间：2019-07-19T00:13:10.960

```
fromDic.ToList().ForEach(x =>
        {
            if (toDic.ContainsKey(x.Key))
                toDic.Remove(x.Key);
            toDic.Add(x);
        }); 
```

# c# - 使用枚举设计问题以建模类型关系

> ID：294143
> 
> 赞同：0
> 
> 时间：2008-11-16T17:44:45.383
> 
> 标签：c#, vb.net, enums

例如，在为客户设计一个类时，为 CustomerType 使用 Enum 是否有意义？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2008-11-16T17:54:37.127

这取决于其他约束。你没有告诉我们足够的关于你的模型。例如，如果不同类型的客户具有与其相关联的不同类型的信息，则类层次结构将比单纯的枚举更适合。

在其他情况下，枚举会很好，甚至可能是首选（更简单，减少开销......）。

# ruby-on-rails - 模型中的自定义 Ruby 路由

> ID：294147
> 
> 赞同：0
> 
> 时间：2008-11-16T17:48:30.447
> 
> 标签：ruby-on-rails, routing

好的，这两个相关的问题是参考[Railscast #21](http://railscasts.com/episodes/21-super-simple-authentication)：

我遇到了一些路线问题。两个问题：

1）教程中的路由似乎是相对于应用程序的根目录的；我希望它们相对于模型的根。所以

" `[http://example.com/login](http://example.com/login)`" 我必须是 " `[http://example.com/model/login](http://example.com/model/login)`" (注销时反之亦然)。

我正在使用永久链接来引用我的记录，但我不知道如何指定覆盖，因为每次我尝试使用“ `[http://example.com/model/login](http://example.com/model/login)`”时都会收到一个错误，提示找不到“登录”*记录。*如何覆盖此登录/注销？

2) 为我选择自定义路线似乎并没有将自定义路线保留在我的地址栏中。所以去“ `[http://example.com/login](http://example.com/login)`”让我到正确的页面，但浏览器现在`[http://example.com/session/new](http://example.com/session/new)`在地址栏中显示“”。在本教程中，这不会发生：应用程序提供正确的页面并将自定义路由保留在地址栏中。我怎样才能让这发生在我身上？

```
## Sessions Controller
class SessionController < ApplicationController
  def create
    session[:password] = params[:password]
    flash[:notice] = "Successfully Logged In"
    redirect_to :controller => 'brokers', :action => 'index'
  end

  def destroy
    reset_session
    flash[:notice] = "Successfully Logged Out"
    redirect_to login_path
  end
end

## Routes
ActionController::Routing::Routes.draw do |map|
  map.resources :brokers, :session
  map.login 'login', :controller => 'session', :action => 'create'
  map.logout 'logout', :controller => 'session', :action => 'destroy'
  map.connect ':controller/:action/:id'
  map.connect ':controller/:action/:id.:format'
end 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2008-11-16T19:06:02.833

“模型的根”是什么意思？您应该为*控制器*及其*操作*创建路由。控制器应该与*模型*通信。

错误消息可能有点令人困惑，但据我所知，这个网址：

`http://example.com/model/login`

将使用以下路由在名为*model*的控制器中调用名为*login*的操作，其 ID 为空（可能不存在）：

 *`map.connect ':controller/:action/:id'`

如果你想在你的路线中有一个“子文件夹”，你可以使用命名空间，我不记得它的每一个细节，但你可以在[这里](http://guides.rubyonrails.org/routing_outside_in.html#_controller_namespaces_and_routing)找到很多关于它的信息。一句警告：命名空间使路由调试变得更加困难，我在弄清楚真正使用了哪条路由时获得了*很多乐趣。*我最终创建了许多非常具体的路线，以确保使用正确的路线。

# flowchart - 流程图最佳实践

> ID：294153
> 
> 赞同：0
> 
> 时间：2008-11-16T17:52:02.310
> 
> 标签：flowchart

有人可以指出有关如何创建良好流程图的文章/书籍吗？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-01-02T09:57:09.077

看看这个：

[http://drakon-editor.sourceforge.net/DRAKON.pdf](http://drakon-editor.sourceforge.net/DRAKON.pdf)

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2008-11-16T17:58:48.617

**BoUML-它是免费的！**

在过去的 6 个月里，我一直在使用这个开源工具来创建 UML 图：bouml.free.fr/

我在运行 OS X 的 Macbook 和桌面上的 Ubuntu Linux 上都使用过它，都成功了。它也做代码生成（虽然我自己没有使用过这个功能）。如果您从 BoUML 中创建图表，您可以右键单击 ->Tools->HTML 等，它会实际生成图表——这将创建一个完整的 html、css 等树，并包含一个.png 文件，您以后可以选择将其导入到类似 Word 的文档中。

如果您是 UML 新手，并且想探索这条路线，我建议您使用 Martin Fowler 的 UML Distilled 作为快速提升的一种方式。当我将图表放在一起时，我仍然使用它作为参考，我忘记了一些语法细节；）关于 UML 的好处是大多数程序员都会理解它。如果您不想买书，当然可以在 Google 的“UML 教程”中获取大量免费信息。

**非 UML：**

您还可以使用 Open Office 的绘图应用程序来做一些简单的流程图。它有一些不错的非 uml 形状，所以如果你不想在符合 UML 的意义上“严格”，而只是想要一个简单的流程图，那可能是一个不错的选择。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2008-11-16T17:56:42.100

教程[在这里](http://www.nos.org/htm/basic2.htm)。

还可以获得 Microsoft [Visio](http://office.microsoft.com/en-gb/visio/default.aspx)的副本。

# mysql - 使用XAMP的mysql导入问题

> ID：294154
> 
> 赞同：0
> 
> 时间：2008-11-16T17:53:25.523
> 
> 标签：mysql, import, mysql-error-1146, mysql-error-1044, mysql-error-1046

最初我使用的是easyPHP（windows），然后我切换到mac并使用了MAMP。我每隔一段时间存档我的数据库，就在我重新格式化之前。导出是通过进入 phpMyAdmin 的根目录并使用导出功能进行的。现在我正在尝试导入数据，但出现此错误“#1044 - 用户'root'@'localhost' 拒绝访问数据库'information_schema'”。在做其他事情时，我遇到了错误，例如“#1146 - 表 'test_db.COLLATION_CHARACTER_SET_APPLICABILITY' 不存在”、“#1146 - 表 'test_db.CHARACTER_SETS' 不存在”和“#1146 - 表 'test_db.COLUMNS' 不存在“不存在”和“#1046 - 未选择数据库”

如何让 MAMP 导入并忽略任何访问错误并继续，以便我的数据库填充到以前的状态？我宁愿不编写应用程序来执行此操作，但如果我必须使用哪些库来解析 sql 转储中的 sql 语句？它看起来并不难解​​析。它看起来像一个分号分隔语句。但是逃逸和逃逸问题呢？我该如何处理？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-02-14T11:28:42.940

第一个错误表明您的设置有问题。information_schema 是一个内部数据库，用于保存有关系统其他部分的数据（元数据）。您应该尝试重新安装 MySQL 服务器（甚至整个 MAMP）。

其次：可以使用 mysql 命令行客户端导入转储文件，如下所示：

```
mysql -p -u root test_db < dump.sql 
```

要记住的一件事是，在恢复转储*之前*需要创建“test_db” 。另一个可能的问题可能是转储/恢复是由不同版本的 MySQL（即 5.0 与 5.1）完成的。为此，您可以尝试在 mysql 命令行中使用 --force 命令跳过失败的执行，但请注意，这可能无法正确恢复您的数据。

# intellij-idea - 最有用的 Intellij IDEA 键盘快捷键是什么？

> ID：294167
> 
> 赞同：290
> 
> 时间：2008-11-16T17:59:13.560
> 
> 标签：intellij-idea, keyboard-shortcuts

我做了一些谷歌搜索，希望能找到一篇关于 IDEA 快捷方式的帖子，类似于 Jeff 在 Visual Studio 快捷方式（[Visual Studio .NET 2003 和 2005 键盘快捷方式](http://www.codinghorror.com/blog/archives/000315.html)）上的帖子，但并没有真正发现任何帮助。希望这个问题的答案将填补空白。

* * *

## 回答 #1

> 赞同：214
> 
> 时间：2008-11-27T11:48:58.700

这些是我最常用的一些键盘快捷键

编辑器中的语法感知选择在插入符号处选择一个单词，然后选择源代码的扩展区域。例如，它可以选择一个方法名，然后是调用这个方法的表达式，然后是整个语句，然后是包含块，等等 **`Ctrl`：`W`**

基本代码完成，完成方法、关键字等： **`Ctrl`+`Space`**

转到声明。使用它导航到代码中某处使用的类、方法或变量的声明： **`Ctrl`+`B`**

引入变量重构，从表达式创建变量。此表达式甚至可能不完整或包含错误。从版本 8 开始，IDEA 在没有选择文本时智能选择一个可能的表达式： **`Ctrl`+ `Alt`+`V`**

转到班级，在编辑器中快速打开任何班级： **`Ctrl`+`N`**

打开任何文件，而不仅仅是类 **：****`Ctrl`++`Shift``N`**

注释/取消注释当前行或选择： **`Ctrl`+`/`**和**`Ctrl`+ `Shift`+`/`**

在文本光标处显示方法或类的 JavaDoc 的快速 JavaDoc 弹出窗口： **`Ctrl`+`Q`**（在 Mac OS X 上为*`Ctrl`+ ）`J`*

Smart Type Completion 使用适合当前上下文的类型的方法调用或变量来完成表达式： **`Ctrl`+ `Shift`+`Space`**

重命名重构以重命名任何标识符。也可以查看评论、文本文件和不同的语言： **`Shift`+`F6`**

在 Popup 中选择以在任何视图（项目视图、结构视图或其他）中快速选择当前编辑的元素（类、文件、方法或字段）： **`Alt`+`F1`**

突出显示文件中的用法。将文本光标定位在任何标识符上而不选择任何文本，它将显示文件中使用该变量、方法等的所有位置。在 throws、try 或 catch 关键字上使用它以显示引发异常的所有位置。在 implements 关键字上使用它来突出实现接口的方法 **：****`Ctrl`++`Shift``F7`**

* * *

## 回答 #2

> 赞同：176
> 
> 时间：2008-12-03T11:14:44.497

到目前为止，我最喜欢的通用快捷方式是`Ctrl`+ `Shift`+`A`

它会在您键入 intellij 中的所有命令时进行搜索。不仅如此，当你找到你想要的命令时，它旁边还会显示相应的快捷键！

* * *

## 回答 #3

> 赞同：88
> 
> 时间：2009-12-16T14:17:24.017

以下是我认为最有用的 Intellij IDEA 键盘快捷键（大致按我的使用顺序列出）：

我最常用的快捷方式是`Ctrl`+ `B`（转到声明），查看方法的作用、声明变量的位置等。这几乎总是跟着`Ctrl`+ `Alt`+`Left`回到我原来的位置（`Ctrl`+ `Alt`+`Right`的作用是“去再次前进”）。

一个相关的导航快捷方式是`Ctrl`++ ，（转到实现）`Alt`。`B`当插入符号在接口的方法名称时按下它，您会弹出一个列表，其中列出了所有实现该方法的地方，您可以选择您想去哪一个（如果只有一个实现，你直接去那里）。被覆盖的方法也是如此。

与此相反的是`Ctrl`+ `U`（转到超方法/超类）。如果插入符号位于接口中方法的实现（由左侧装订线中的小绿色接口符号表示），则此快捷方式会将您带到接口本身。

当我想查看使用方法或变量的所有地方（我想做很多事情）时，我使用`Ctrl`+ `Alt`+ `F7`（显示用法）。这为您提供了所有用法的弹出列表，您可以轻松导航到每个用法。我更喜欢`Alt`+ `F7`（查找用法），它为您提供相同的信息，但在下面的单独窗格中。

要查找类，我使用`Ctrl`+ `N`（转到类），它允许您仅使用类名中的大写字母（“驼峰”）和 * 作为通配符进行搜索。

在阅读和编写代码时，我使用的另一个快捷方式是在方法和构造函数的参数处使用`Ctrl`+ `P`（参数信息），以查看参数的类型和名称。

在编写代码时，我经常使用`Ctrl`+ `space`（基本代码完成）来自动完成方法名称、变量名称等（或者只是通过尝试直接在对象名称后面的点）。

为了在当前文件中搜索，我使用`Ctrl`- `F`（查找 - 可能是此列表中最不令人惊讶的快捷方式）、`F3`/ `Shift`+ `F3`（查找下一个/上一个）重复搜索，以及`Ctrl`+ `Shift`+ `F`（在路径中查找）在整个项目中搜索。

`Ctrl`+ `W`（选择连续增加的代码块）在选择代码块时很方便。反复按下它会选择越来越多的代码。在搜索、缩进、注释代码等时很有用。

如果文件中有错误，`F2`/ `Shift`+ `F2`（下一个/上一个突出显示的错误）将跳转到它们。

我使用序列`Alt`+ `C`, `N`（显示更改视图）来查看与 subversion 存储库相比我修改了项目中的哪些文件。为了将当前文件与 subversion 存储库中的版本进行比较，我使用序列`Alt`+ `C`, `S`, `Y`（与相同的存储库版本比较）。在差异视图中，我使用`F7`/ `Shift`+`F7`在更改之间导航。

当不在 diff 视图中时，我使用`Ctrl`+ `Shift`+ `Alt`+ `Up`/ `Ctrl`+ `Shift`+ `Alt`+`Down`跳转到与签出版本相比已更改的文件部分。在每个修改点，您都会在弹出窗口中看到签出版本中的相应部分。

`Ctrl`最后，我使用++运行 JUnit`Shift`测试`F10`。

编辑：我在过去几个月才开始使用的一个非常有用的快捷方式是`Ctrl`+ `E`。它会弹出一个包含 15 个最近使用的文件的弹出窗口，您只需向下箭头到所需的文件，然后按 Enter 导航到它。

* * *

## 回答 #4

> 赞同：80
> 
> 时间：2009-02-14T08:30:56.380

根据 Jetbrains 的人的说法，它必须是这些，因为它们是为穿着这件衬衫的人准备的：（从 Devoxx 获得）

![促销衬衫](https://www.olafkock.de/ideashirt.jpg)

* * *

## 回答 #5

> 赞同：32
> 
> 时间：2008-11-20T11:35:10.603

帮助\生产力指南

它会告诉您使用/不使用的快捷方式并显示使用统计信息。它将引导您了解未知功能。

* * *

## 回答 #6

> 赞同：30
> 
> 时间：2008-11-17T07:39:19.740

一些节省时间的方法：

1.  `Alt`+ `Enter`：显示意图操作（如 Eclipse 快速修复）
2.  `Ctrl`+ `Alt`+ `V`：引入变量（永远不要再次输入赋值的左侧）
3.  `Ctrl`+ `Shift`+ `Space`：智能完成（[自 IntelliJ 8 以来甚至下降了两个级别](http://blog.xebia.com/2008/11/11/intellij-8-even-smarter-code-completion/)）
4.  `Ctrl`+ `W`：选择连续增加的代码块。有点明显但真正节省时间！

Canoo 博客包含一些[(+8)](http://www.canoo.com/blog/tag/idea/)关于一些更高级的 IntelliJ 键盘快捷键的文章。

*Key Promoter*和*Shortcut keys 列表*插件对于（不断地）学习新的 IntelliJ 键盘快捷 键**非常有帮助。**

* * *

## 回答 #7

> 赞同：22
> 
> 时间：2009-02-14T06:41:48.573

Try using the [Key Promoter](http://plugins.intellij.net/plugin/?idea&id=4455) plugin. That will help in learning the shortcuts. Couple of shortcuts apart from the above suggestions:

*   `Alt` + `Ins`: Works consistently to insert anything. (Add a new class, method etc)
*   `Ctrl` + `Alt` + `T`: Surround code block. Another useful stuff.

* * *

## 回答 #8

> 赞同：9
> 
> 时间：2009-05-07T20:31:25.157

这可能取决于您的开发环境，但是在进行 BlackBerry 开发时，我在 IntelliJ 中编写代码，并且仍然通过 BlackBerry JDE 进行编译和调试。`Ctrl`++在这种情况下`Shift`至关重要`C`，因为它允许您复制当前正在编辑的文件的完整路径，从而可以轻松地在单独的开发环境中打开文件。

* * *

## 回答 #9

> 赞同：9
> 
> 时间：2010-12-25T18:42:31.317

是的，`Ctrl`++`Shift`是`A`最有用的。这是一个元快捷方式

* * *

## 回答 #10

> 赞同：8
> 
> 时间：2011-09-02T16:15:12.387

`Shift`+`Delete`删除整行（将“剪切”到剪贴板）

`Ctrl`++重新格式化`Alt`和`L`优化导入

`Ctrl`++加入行（将下一行的内容拉到当前行）`Shift`。`J`

* * *

## 回答 #11

> 赞同：8
> 
> 时间：2009-04-08T04:10:40.073

在工具中：“Help -> Default Keymap Reference”（由[krosenvold](https://stackoverflow.com/users/23691/krosenvold)建议）

网上： [《IntelliJ IDEA 开发者文档》](http://www.jetbrains.com/idea/documentation/documentation.html)

适用于版本 8、7、6、5 和 4.5 的 Windows、Linux 和 Mac 键盘快捷键参考卡。

*（我**知道**我以前见过并使用过这些参考“卡片”！;-)*

我的最爱之一*（JetBrains 卡片上未显示）*是“ **Ctrl+Shift+** {向上或向下**箭头**}”在源代码中上下移动行/方法。

另请参阅[Ward Wiki 上的“Intellij Idea 键盘快捷键”页面](http://www.c2.com/cgi/wiki?IntellijIdeaKeyboardShortcuts)。

* * *

## 回答 #12

> 赞同：7
> 
> 时间：2011-07-08T07:42:41.497

`Alt`++ - 切换到[列选择模式](http://www.jetbrains.com/idea/webhelp/selecting-text-in-the-editor.html)，允许选择矩形文本片段（列`Shift`）`Insert`

`Ctrl`++ -`Shift`转到`Backspace`最近的代码编辑。再次击打可以走得更远。在编写代码、浏览其他类一段时间然后想要回到我们离开代码的地方时非常有用。

`Ctrl`+ `E`- 最近打开的文件

`Ctrl`+ `Shift`+ `E`- 最近编辑的文件

`Ctrl`+ `Shift`+ `V`- 从剪贴板粘贴以前的值之一

* * *

## 回答 #13

> 赞同：5
> 
> 时间：2011-08-08T01:48:02.967

我最喜欢的一个可能不能完全算作键盘快捷键。但是“iter”智能模板真的很棒。

基本上，如果您想使用 for 循环类型“iter”来迭代某些内容，则使用选项卡以使用实时模板

迭代器`tab`

它将找出您想要迭代的最有可能的变量并为其生成一个 for 循环。我很确定它使用了对支持迭代的对象的最近引用。

* * *

## 回答 #14

> 赞同：5
> 
> 时间：2011-01-26T11:48:39.367

`Ctrl` + `F11` invokes a dialog with all alphanumeric keys on the keyboard. Selecting one empty will add the current line to bookmarks and mark the line with selected key.

`Shift` + `F11` invokes a list of bookmarks. Pressing a key takes to associated bookmark.

* * *

## 回答 #15

> 赞同：4
> 
> 时间：2010-10-14T08:01:16.947

`Ctrl`++ - 自动完成您正在键入的代码语句，根据需要插入引号、括号、花括号和其他标点符号`Shift`。`Enter`

* * *

## 回答 #16

> 赞同：3
> 
> 时间：2008-11-16T18:01:01.683

`F7` `F8` `F9` 用于调试

* * *

## 回答 #17

> 赞同：2
> 
> 时间：2011-06-07T01:23:42.807

如果您来自 Eclipse： [http ://tanu.wordpress.com/2010/09/24/moving-from-eclipse-to-intellij-idea/](http://tanu.wordpress.com/2010/09/24/moving-from-eclipse-to-intellij-idea/)

一般文档和快捷方式位于 Intellij 的网站 [http://www.jetbrains.com/idea/documentation/index.jsp](http://www.jetbrains.com/idea/documentation/index.jsp)

* * *

## 回答 #18

> 赞同：1
> 
> 时间：2008-11-30T19:19:51.617

`Ctrl`+ `N`：公开课。

`Alt`+ `F7`：查找用法。

* * *

## 回答 #19

> 赞同：1
> 
> 时间：2008-11-16T18:54:59.907

`Ctrl`++`Alt`和.`Shift`的任意组合`N`。

`Ctrl``Shift`在idea8中的++`T`也很出色。

在线帮助中也有完整的键盘映射。

* * *

## 回答 #20

> 赞同：0
> 
> 时间：2009-04-27T15:33:44.537

这个链接有你需要的一切。另外，至少在 Idea 8 中，每个快捷方式都是完全可定制的，因此最有用的功能取决于您。

[Idea 8 参考 PDF](http://www.jetbrains.com/idea/docs/IntelliJIDEA8_ReferenceCard.pdf)

* * *

## 回答 #21

> 赞同：0
> 
> 时间：2008-11-30T19:00:27.443

[http://www.jetbrains.com/idea/docs/ReferenceCard70_mac.pdf](http://www.jetbrains.com/idea/docs/ReferenceCard70_mac.pdf)有你需要的一切。一段时间后，您会形成自己对某些快捷方式的偏好。

# database - 将数据行移动到另一个分片的最佳方法？

> ID：294170
> 
> 赞同：2
> 
> 时间：2008-11-16T18:01:28.953
> 
> 标签：database, language-agnostic, sharding

这个问题说明了一切。

示例：我打算对数据库表进行分片。该表包含标记为“活动”、“完成”和“已删除”的客户订单。我也有三个碎片，每个标志一个。

据我了解，当更改标志时，必须将一行移动到正确的分片。

我对吗？最好的方法是什么？可以使用触发器吗？

我考虑过不立即移动该行，而只是在一天/周/月结束时，但随后不确定，具有特定标志的行驻留在哪个分片中，并且必须始终对所有分片进行搜索。

编辑：一些澄清：

一般来说，我必须选择一个标准来决定一行所在的分片。在这种情况下，我希望它成为上面描述的标志，因为这是对此类数据进行分片的最自然方式。（在我看来）只有有限数量的活跃​​订单经常被访问。有大量已完成的订单，很少被访问，并且有非常大量的数据行几乎从未被访问过。

如果我想现在特定数据行所在的位置，我不必搜索所有分片。如果用户想要加载一个活动订单，我已经知道我必须查看哪个数据库。

现在，作为我的分片标准的标志发生了变化，我想知道处理这种情况的最佳方法。如果我只是将记录保留在其原始数据库中，最终所有数据都会累积在一个表中。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2010-12-27T07:03:56.607

在我看来，将所有活动记录保存在单个分片中可能不是一个好主意。在这种分片策略中，所有 IO 都将在单个数据库实例上执行，而所有其他的高度未充分利用。

备用分片策略可以是使用某种散列函数在分片之间分配新创建的行。这将允许

*   快速查找行
*   在所有分片实例上分配 IO。
*   无需将数据从一个分片移动到另一个分片（您想要增加分片数量的情况除外）。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2008-11-20T15:25:21.480

分片通常是指将它们分开在不同服务器上的不同数据库中。Oracle 可以使用称为分区表的功能来做您想做的事情。

如果您使用触发器（after/before_update/insert），这将是一个立即行动，其他方法将导致在第一个分片（活动）中具有不同类型的数据，直到它被清理。

我还建议按日期执行此操作（例如将任何不活动且超过一个月的内容移动到另一个“存档”数据库的月度工作）。

如果您这样做是为了提高性能，我想请您重新考虑这样做（除非您在此表中有数 TB 的数据）。请告诉我们您为什么要分片，我们都会想办法解决您的问题。

# .net - 如何修复此错误：“MyEvent += 预期”？

> ID：294171
> 
> 赞同：1
> 
> 时间：2008-11-16T18:02:05.160
> 
> 标签：.net, delegates

我有一个代表，说：

```
public delegate void MyDelegate(); 
```

我有一个事件，说：

```
public MyDelegate MyEvent; 
```

在调用事件时，我收到一条错误消息：

> “我的事件 += 预期......”

我该如何解决这个问题？

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2008-11-16T20:26:27.600

+= is associated with events, not just a declaration of a delegate. You are missing the 'event' keyword.

```
public **event** MyDelegate MyEvent; 
```

Once you have that keyword the += will work for you.

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2008-11-16T18:04:49.603

您只能从声明它的类中调用该事件。在任何其他地方，您只能通过运算符添加或删除事件委托中的处理程序`+=`和`-=`，因此会出现错误消息。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2008-11-16T18:51:06.607

如果您尝试使用来自不同类的事件，则需要了解事件和委托之间的区别。事件只是封装了“订阅”和“取消订阅”方面，而不是“引发事件”。（事实上​​，在 IL 中，您*可以*拥有一个“引发事件”的成员，但 C# 不支持它。）

有关更多详细信息，请参阅[我关于事件和代表的文章。](http://pobox.com/~skeet/csharp/events.html)

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2008-11-16T22:25:34.757

查看 Chris Sells [.NET Delegates: AC# Bedtime Story](http://www.sellsbrothers.com/writing/default.aspx?content=delegates.htm)了解代表和活动的精彩指南。内容丰富且非常有趣。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2008-11-16T18:11:05.050

此外，您可能想看看这篇关于[避免检查空委托的帖子](https://stackoverflow.com/questions/9033/hidden-features-of-c#9282)

# jquery - Jquery 如何从 HttpServletRequest 获取属性

> ID：294172
> 
> 赞同：1
> 
> 时间：2008-11-16T18:02:43.133
> 
> 标签：jquery, internet-explorer, servlets, xmlhttprequest

我有这段代码：

```
$("#faq").click(function () {               
    var url = $.get("faq", { pagina: "page" });
    alert(url);
}); 
```

在“常见问题解答”上响应在请求上设置属性的 Servlet

```
....
request.setAttribute("pageFAQ", pageFAQ);
.... 
```

获取 jQuery 后打印 [object XmlHttpRequest]。

我想访问 Servlet 中设置的属性，但我不知道该怎么做。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2008-11-16T20:54:39.930

我不确定 servlet 请求属性是否与客户端共享。

您可以像这样在 jQuery 中获取响应文本：

```
$("#faq").click(function () {                   
  $.get(
    "faq", 
    { pagina: "page" },
    function(data) {    // callback function, executed on GET success
      alert(data);
    }
  );
}); 
```

您需要做的就是让您的 servlet 返回一些文本。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-07-29T03:56:18.707

setAttribute() 方法设置可以在服务器内部但不能在客户端检索的值。我们使用它来设置和获取 servlet 通信中的值。您无法通过此方法访问服务器之外的任何信息，即客户端程序。

我们使用 req.getParameter(paramname) 来访问客户端属性。

# mouse - 是否可以映射按键以模拟 xwindows 中的中键？

> ID：294177
> 
> 赞同：4
> 
> 时间：2008-11-16T18:05:27.603
> 
> 标签：mouse, x11, keyboard-events

我想知道，是否有可能以某种方式将按键事件映射为 Xwindows 中鼠标的中键单击？我知道它们是不同的设备，但是如果有办法从 C 程序中触发中键单击事​​件，那么使用现有的 xwindows 机制将键绑定到它应该很容易。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2008-11-16T22:45:51.970

Xevent 做到了：

*   [http://www.isv.uu.se/~ziemann/xevent/](http://www.isv.uu.se/~ziemann/xevent/)
*   [http://linuxgazette.net/153/misc/ziemann/xevent.c](http://linuxgazette.net/153/misc/ziemann/xevent.c)

代码在我的机器上编译并运行得很好。

如果您对开发人员感兴趣：它使用 XTest 扩展，该扩展包含在 X 服务器中。还有一些旧的，仍然有效的 API 在线文档： [http ://www.xfree86.org/current/xtestlib.html](http://www.xfree86.org/current/xtestlib.html)

# bash - 尝试简化 rsync 命令时出错

> ID：294193
> 
> 赞同：3
> 
> 时间：2008-11-16T18:26:08.047
> 
> 标签：bash, rsync, scp

我通常使用 scp 来复制东西，但现在我正在尝试习惯更强大的 rsync 命令。它通过仅复制已更改的文件来帮助我使用更少的带宽。但是，rsync 有很多复杂的参数，所以我想，嘿，我就做一个简单的 Bash 脚本，调用命令 'rscp'。所以，我开始构建这样的东西。请注意，在下面的示例中，我的 Web 主机使用除了 22 之外的不同端口号，这就是为什么使用 $1 的原因。

```
#!/bin/bash

rsync -avzp --progress --rsh='ssh -p$1' $2 $3 $4 $5 $6 $7 
```

所以，我希望它的用法是这样的：

```
rscp 3822 --exclude=tiny_mce /var/www/mysite/* root@webhost.com:~/www/mysite 
```

你看，这会让它更接近我对 scp 命令的使用。

但是，当我运行此程序时，出现此错误：

```
building file list ... 
4 files to consider
ERROR: destination must be a directory when copying more than 1 file
rsync error: errors selecting input/output files, dirs (code 3) at main.c(494) [receiver=2.6.9]
rsync: connection unexpectedly closed (8 bytes received so far) [sender]
rsync error: error in rsync protocol data stream (code 12) at io.c(454) [sender=2.6.9] 
```

但是如果我回到常规的 rsync 命令，它工作得很好。

谁能弄清楚我在我的 Bash 脚本中做错了什么？

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2008-11-16T19:07:54.030

/var/www/mysite/* 由 shell 扩展，因此传入的参数比在脚本中处理的参数多得多。

变量也不用单引号代替，因此您需要使用双引号。（参见 bash[手册页](http://www.gnu.org/software/bash/manual/bashref.html#Double-Quotes)）

试试这个：

```
#!/bin/bash
PORT=$1
shift
rsync -avzp --progress --rsh="ssh -p$PORT" "$@" 
```

首先我们将端口从参数列表中取出（使用移位），然后我们使用特殊的“$@”，它指的是参数（在这种情况下是脚本），并被转换为所有参数，但每个都是单独的在双引号中。（有关更多详细信息，请参见 bash[手册页](http://www.gnu.org/software/bash/manual/bashref.html#Special-Parameters)）。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2016-12-24T04:38:57.413

你不能在技术上把它变成一个函数吗？：

```
 rscp() {
rsync -avzp --progress --rsh="ssh -p$PORT" "$@"
} 
```

然后当你运行它时： rscp 3822

# cocoa - 同步服务客户端和模式 Xcode 项目结构

> ID：294194
> 
> 赞同：0
> 
> 时间：2008-11-16T18:33:22.227
> 
> 标签：cocoa, syncservices, xcode, objective-c

我已经开始了一个主要充当同步服务客户端的项目。理想情况下，该项目有两个组件：自定义模式包和首选项窗格。

作为第一步，我为模式包创建了一个 Xcode 项目。但是现在我发现自己已经准备好开始为首选项窗格和客户端编写代码，我不确定将它与我已有的项目集成的最佳方法是什么。

您发现哪些方法在这些情况下效果很好？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2008-11-16T22:57:38.887

最简单的方法可能是创建一个新的 Pref Pane 项目。这样你就可以得到所有的好处。之后，您实际上可以将该项目拖到您的架构项目中，并使其成为您的架构项目的依赖项。每当您构建主项目（架构项目）时，如果您的首选窗格项目中有任何更改，它将被重建。

# svn - 如何确定修订之间的更改统计信息

> ID：294201
> 
> 赞同：5
> 
> 时间：2008-11-16T18:38:06.133
> 
> 标签：svn

给定 2 个文件修订版，我想知道添加/修改/删除了多少行。我想为数千个文件的整个存储库提供这些信息。请指点我一个脚本或工具，因为我是一个完全的 svn 新手

我在窗户上工作

样本输出

文件~新版本~旧版本~添加~修改~删除

文件1.c~#11~#10~1~2~0

文件1.c~#2~#1~2~2~0

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2008-11-16T18:59:20.273

Subversion 有一个非常好的 diff 工具集成在其中。我会使用如下命令：

```
svn diff -rOldRevision:NewRevision URL 
```

其中 URL 是您的存储库的 URL（例如，[http://www.mycode.org/svn/trunk](http://www.mycode.org/svn/trunk)）。这不会以您正在寻找的形式格式化差异输出，但它会显示每个文件在两个修订号之间的更改情况。

对于您的格式，您可以使用 grep 来计算每个文件中发生了多少加法和减法。

希望这可以帮助！

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2008-11-16T19:12:13.007

SVN（或任何类似工具）不区分修改的行和被删除并替换为其他内容的行。尽管如此，你最好的选择是获得一个差异（如 jordan002 所说），然后搜索以 + 或 - 开头的行。对于每个 -，删除一行，对于每个 +，添加一行（您可以使用 svn 忽略差异上的空格`svn diff --diff-cmd diff -x -w -x -u -rOldRev:NewRev`在安装了 Unix diff 的系统上）。然后，您可以比较它们。统一的差异将被组织成以 @@ 开头的行分隔的块（文件的不同部分），对于每个块，您可以说删除和添加的行中较少的行是更改的行数，并且对于每个添加的行超过一个块中删除的行，添加一行，并且对于每个删除的行超过一个块中添加的行，删除一行。不完美，但相对适合您的评估。

还有一点需要注意：如果您使用它来评估程序员，请小心。LOC 不是衡量相对有效性的好方法。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2011-10-22T14:10:47.593

我还尝试解决诸如“在选定的时间段内删除、添加或更改了多少行”之类的任务。所以我写了简单的 shell 脚本（仅适用于 Linux）。它收集了一些关于代码修改的简单统计信息。您可以在此处找到更多详细信息和共享脚本：

[http://cyber-fall.blogspot.com/2011/10/tools-linux-svn-generate-statistic.html](http://cyber-fall.blogspot.com/2011/10/tools-linux-svn-generate-statistic.html)

希望对您和其他人有所帮助！

# iphone - 使用 .NET 开发环境的 iPhone 应用程序？

> ID：294202
> 
> 赞同：15
> 
> 时间：2008-11-16T18:38:39.813
> 
> 标签：iphone

如何使用 .NET 开发环境创建 iPhone 应用程序？

* * *

## 回答 #1

> 赞同：18
> 
> 时间：2008-11-16T19:02:40.267

Mono 团队正在研究“静态编译”，它允许 Mono 应用程序在未越狱的 iPhone 上运行。简而言之，这是通过运行交叉编译 JIT 步骤作为构建过程的一部分来生成本机 exe 的。

在 PDC 上有一个演示......请参阅[Miguel de Icaza](http://tirania.org/blog/archive/2008/Nov-05.html)的博客。

* * *

## 回答 #2

> 赞同：15
> 
> 时间：2009-07-09T07:51:36.820

答案是来自 Novell 的 MonoTouch - [http://www.mono-project.com/MonoTouch](http://www.mono-project.com/MonoTouch)。Beta 版将于 2009 年 8 月发布，商业版将于 2009 年 9 月发布。

* * *

## 回答 #3

> 赞同：4
> 
> 时间：2008-11-17T01:46:28.233

如果您只是想利用一些 c# 知识，您可以使用 Unity。使用 Unity ( [http://unity3d.com](http://unity3d.com) ) 开发的游戏使用 Mono 和 AOT（提前编译器）将单字节码编译为 ARM。（Unity 创建的应用程序有一个 shell，实际上，它是一个用 Objective-C++ 和 XCode 创建的相当传统的可可触摸应用程序。）它不是一个 dot net 应用程序，但您可以使用您现有的 c# 知识。

* * *

## 回答 #4

> 赞同：3
> 
> 时间：2008-11-16T18:44:37.277

你没有。您需要在 Mac OS X 上使用 Xcode 来编写 iPhone 应用程序。

* * *

更新：2009 年 9 月 20 日

这曾经是真的。有关更多信息，请参阅下面的评论。

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2008-11-16T21:02:18.433

The only supported way to develop native iPhone applications is the iPhone SDK. It runs on Mac OS X only, and supports development using the Cocoa Touch frameworks and the Objective-C 2.0 language.

* * *

## 回答 #6

> 赞同：1
> 
> 时间：2008-11-16T18:43:24.203

据我所知，Apple 不支持 Microsoft .Net 开发环境。

您最多可以希望在[越狱](http://www.iphonehacks.com/jailbreak_iphone/)的iphone上安装[单声道。](http://www.mono-project.com/Main_Page)并不是说我宽恕这一点，你这样做的风险自负。

iPhone 应用程序是使用Objective C 或Ruby 开发的。

* * *

## 回答 #7

> 赞同：0
> 
> 时间：2008-11-17T19:11:34.507

有一些方法可以让其他语言工作，但它们几乎肯定不会被 AppStore 接受，并且会随着未来的更新而中断。一般来说，最好使用螺丝刀将某些东西拧入孔中，而不是用连接在 250hp 电机上的锤子重复敲打它...

* * *

## 回答 #8

> 赞同：0
> 
> 时间：2010-07-16T14:53:57.350

您可以使用名为 Component Studio-iPhone 的第三方工具。更多信息[请看这个](http://www.componentone.com/SuperProducts/StudioiPhone/)

# c# - 为什么 C# 禁止泛型属性类型？

> ID：294216
> 
> 赞同：538
> 
> 时间：2008-11-16T18:48:02.777
> 
> 标签：c#, generics, .net-attributes

这会导致编译时异常：

```
public sealed class ValidatesAttribute<T> : Attribute
{

}

[Validates<string>]
public static class StringValidation
{

} 
```

我意识到 C# 不支持通用属性。但是，经过多次谷歌搜索，我似乎找不到原因。

有谁知道为什么泛型类型不能派生自`Attribute`？有什么理论吗？

* * *

## 回答 #1

> 赞同：379
> 
> 时间：2008-11-16T19:25:11.390

好吧，我无法回答为什么它不可用，但我*可以*确认这不是 CLI 问题。CLI 规范没有提到它（据我所知），如果你直接使用 IL，你可以创建一个通用属性。C# 3 规范中禁止它的部分 - 第 10.1.4 节“类基础规范”没有给出任何理由。

带注释的 ECMA C# 2 规范也没有提供任何有用的信息，尽管它确实提供了一个不允许的示例。

我的带注释的 C# 3 规范副本明天应该会到……我会看看是否提供了更多信息。无论如何，这绝对是一种语言决定，而不是运行时决定。

编辑：Eric Lippert 的回答（释义）：没有特别的原因，除了避免语言和编译器的复杂性用于一个不会增加太多价值的用例。

* * *

## 回答 #2

> 赞同：88
> 
> 时间：2008-11-16T19:09:59.407

属性在编译时装饰类，但泛型类直到运行时才接收其最终类型信息。由于该属性会影响编译，因此在编译时它必须是“完整的”。

有关详细信息，请参阅此[MSDN 文章](http://msdn.microsoft.com/en-us/library/ms379564.aspx)。

* * *

## 回答 #3

> 赞同：22
> 
> 时间：2008-11-16T21:45:03.153

我不知道为什么不允许这样做，但这是一种可能的解决方法

```
[AttributeUsage(AttributeTargets.Class)]
public class ClassDescriptionAttribute : Attribute
{
    public ClassDescriptionAttribute(Type KeyDataType)
    {
        _KeyDataType = KeyDataType;
    }

    public Type KeyDataType
    {
        get { return _KeyDataType; }
    }
    private Type _KeyDataType;
}

[ClassDescriptionAttribute(typeof(string))]
class Program
{
    ....
} 
```

* * *

## 回答 #4

> 赞同：16
> 
> 时间：2013-11-07T06:45:46.433

这不是真正的泛型，您仍然必须为每种类型编写特定的属性类，但是您可以使用泛型基接口进行一些防御性编码，编写比其他要求更少的代码，获得多态性的好处等。

```
//an interface which means it can't have its own implementation. 
//You might need to use extension methods on this interface for that.
public interface ValidatesAttribute<T>
{
    T Value { get; } //or whatever that is
    bool IsValid { get; } //etc
}

public class ValidatesStringAttribute : Attribute, ValidatesAttribute<string>
{
    //...
}
public class ValidatesIntAttribute : Attribute, ValidatesAttribute<int>
{
    //...
}

[ValidatesString]
public static class StringValidation
{

}
[ValidatesInt]
public static class IntValidation
{

} 
```

* * *

## 回答 #5

> 赞同：8
> 
> 时间：2008-11-16T19:15:04.717

这个问题问得好。根据我对属性的经验，我认为约束已经到位，因为当反映一个属性时，它会创建一个条件，在该条件下您必须检查所有可能的类型排列：`typeof(Validates<string>)`, `typeof(Validates<SomeCustomType>)`, 等等...

在我看来，如果需要根据类型进行自定义验证，则属性可能不是最好的方法。

也许将 a`SomeCustomValidationDelegate`或 an`ISomeCustomValidator`作为参数的验证类会是更好的方法。

* * *

## 回答 #6

> 赞同：5
> 
> 时间：2019-01-03T11:52:54.853

这目前不是 C# 语言功能，但是[在官方 C# 语言 repo 上有很多讨论](https://github.com/dotnet/csharplang/issues/124)。

来自[一些会议记录](https://github.com/dotnet/csharplang/blob/master/meetings/2017/LDM-2017-02-21.md#generic-attributes)：

> 尽管这在原则上可行，但在大多数版本的运行时中都存在错误，因此它无法正常工作（从未使用过）。
> 
> 我们需要一种机制来了解它在哪个目标运行时工作。我们在很多事情上都需要它，并且目前正在研究它。在那之前，我们不能接受。
> 
> 一个主要 C# 版本的候选者，如果我们可以让足够数量的运行时版本来处理它。

* * *

## 回答 #7

> 赞同：3
> 
> 时间：2021-12-15T21:23:11.797

[Generic Attributes](https://docs.microsoft.com/en-us/dotnet/csharp/whats-new/csharp-10#generic-attributes)已作为*预览*功能添加到 C# 10，这意味着您必须将[<LangVersion> 设置为 Preview](https://docs.microsoft.com/en-us/dotnet/csharp/language-reference/compiler-options/language#langversion)才能启用此功能；该功能可能会在最终发布之前发生变化。

请注意，该功能有一些限制，例如：

> 您可以应用完全封闭的构造通用属性。换句话说，必须指定所有类型参数。例如，以下是不允许的：
> 
> ```
> public class GenericType<T>
> {
>    [GenericAttribute<T>()] // Not allowed! generic attributes must be fully closed types.
>    public string Method() => default;
> } 
> ```

和

> 类型参数必须满足与 typeof 运算符相同的限制。不允许使用需要元数据注释的类型。示例包括以下内容：
> 
> *   `dynamic`
> *   `nint`,`nuint`
> *   `string?`（或任何可为空的引用类型）
> *   `(int X, int Y)`（或任何其他使用 C# 元组语法的元组类型）。
> 
> 这些类型不直接在元数据中表示。它们包括描述类型的注释。在所有情况下，您都可以改用底层类型：
> 
> *   `object`为`dynamic`.
> *   `IntPtr`而不是`nint`or `unint`。
> *   `string`而不是`string?`.
> *   `ValueTuple<int, int>`而不是`(int X, int Y)`.

来源：[https ://docs.microsoft.com/en-us/dotnet/csharp/whats-new/csharp-10#generic-attributes](https://docs.microsoft.com/en-us/dotnet/csharp/whats-new/csharp-10#generic-attributes)

* * *

## 回答 #8

> 赞同：0
> 
> 时间：2016-01-29T06:56:01.867

我的解决方法是这样的：

```
public class DistinctType1IdValidation : ValidationAttribute
{
    private readonly DistinctValidator<Type1> validator;

    public DistinctIdValidation()
    {
        validator = new DistinctValidator<Type1>(x=>x.Id);
    }

    public override bool IsValid(object value)
    {
        return validator.IsValid(value);
    }
}

public class DistinctType2NameValidation : ValidationAttribute
{
    private readonly DistinctValidator<Type2> validator;

    public DistinctType2NameValidation()
    {
        validator = new DistinctValidator<Type2>(x=>x.Name);
    }

    public override bool IsValid(object value)
    {
        return validator.IsValid(value);
    }
}

...
[DataMember, DistinctType1IdValidation ]
public Type1[] Items { get; set; }

[DataMember, DistinctType2NameValidation ]
public Type2[] Items { get; set; } 
```

# assembly - 在 1 条 ARM 指令中清除高 16 位

> ID：294217
> 
> 赞同：3
> 
> 时间：2008-11-16T18:49:08.123
> 
> 标签：assembly, arm, bit-manipulation

在 ARM 汇编中，立即数由 8 位旋转值编码，这意味着我们只能编码

```
(0-256)^2n. 
```

现在我的问题是我想清除 r0 的高 16 位并将其替换为存储的半字 r1。但是由于立即数的范围有限，我必须做：-

```
bic r0, r0, #0xff000000
bic r0, r0, #0x00ff0000
add r0, r0, r1, LSL #16 
```

是否可以用一条指令替换 2 条 bic 指令？0xffff0000 是不可编码的。也许我应该使用另一个逻辑操作来清除高 16 位？

谢谢

编辑：对不起，我忘了说 r1 的前 16 位是空的，我使用的是 ARM7TDMI

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2008-11-17T12:42:35.290

如果您有足够新的 ARM 内核，那么问题很简单：

```
movt    r0, #0
orr     r0, r0, r1,lsl#16 
```

见[http://www.keil.com/support/man/docs/armasm/armasm_cjagdjbf.htm](http://www.keil.com/support/man/docs/armasm/armasm_cjagdjbf.htm)

但是，如果您确实有 ARMv6+，您实际上可以一口气完成整个引用的示例：

```
pkhbt   r0, r0, r1,lsl#16 
```

见[http://www.keil.com/support/man/docs/armasm/armasm_cihjedjg.htm](http://www.keil.com/support/man/docs/armasm/armasm_cihjedjg.htm)

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2008-11-16T22:35:28.433

怎么样：

```
orr r0,r1,r0,lsl #16
mov r0,r0,ror #16 
```

（这假设 r1 的上半字是空的，就像您的参考代码所做的那样。）根据具体情况，您可以通过将最后的 mov 与稍后的代码合并来省略它。

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2008-11-16T21:57:05.717

“用存储的半字 r1 替换它” - 这是否意味着您可以假设 r1 的前 16 位为零？如果是这样的话，

```
add r0, r1, r0 lsl #16
mov r0, r0 ror #16 
```

将 mov 视为一个占位符，因为您可以希望将 ror 移动到下一个将 r0 作为输入的任何位置，并在同一循环中实际执行有用的工作。

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2008-11-16T21:43:41.593

在 ARMv6（例如 MPCore）上，你可以说

```
 uxth    r1, r1
    orr     r0, r1, r0, asl #16 
```

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2008-11-16T18:56:34.757

如果你能清除整个事情，你可以`xor`用它自己。

如果您需要保留下半部分，您是否可以将寄存器左移 8 位并返回？不过，这可能是相同数量的指令。

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2008-11-16T19:42:46.003

对于 C 代码

```
 (a<<16)|((short)b) 
```

gcc 生成

```
 mov     r1, r1, asl #16
    mov     r1, r1, asr #16
    orr     r0, r1, r0, asl #16 
```

它不使用任何立即数——不过，它仍然是两条指令。

* * *

## 回答 #7

> 赞同：0
> 
> 时间：2014-04-29T14:37:01.177

您可以使用 BFC 指令。位字段清除。该指令从 m 位中清除 n 位

# .net - 在 WPF 中拖动图像

> ID：294220
> 
> 赞同：17
> 
> 时间：2008-11-16T18:52:13.843
> 
> 标签：.net, wpf, user-interface

我正在尝试创建一个 WPF 应用程序，我可以在其中拖动图像。

目前我有一个图像放置在窗口的中心，我正在考虑使用三个鼠标事件 MouseDown、MouseMove 和 MouseUp 来计算拖动图像时的新位置。

关于如何做到这一点还有其他好主意吗？我对 WPF 完全陌生，所以我的心态仍然在 Windows 窗体世界中。

据我所知，我需要使用 a 才能获得绝对定位。

* * *

## 回答 #1

> 赞同：32
> 
> 时间：2008-11-16T21:21:20.470

好的，这是一个附加属性“行为”，您可以使用它来使任何元素可拖动，前提是它位于画布上：

```
public class DraggableExtender : DependencyObject
{
    // This is the dependency property we're exposing - we'll 
    // access this as DraggableExtender.CanDrag="true"/"false"
    public static readonly DependencyProperty CanDragProperty =
        DependencyProperty.RegisterAttached("CanDrag",
        typeof(bool),
        typeof(DraggableExtender),
        new UIPropertyMetadata(false, OnChangeCanDragProperty));

    // The expected static setter
    public static void SetCanDrag(UIElement element, bool o)
    {
        element.SetValue(CanDragProperty, o);
    }

    // the expected static getter
    public static bool GetCanDrag(UIElement element)
    {
        return (bool) element.GetValue(CanDragProperty);
    }

    // This is triggered when the CanDrag property is set. We'll
    // simply check the element is a UI element and that it is
    // within a canvas. If it is, we'll hook into the mouse events
    private static void OnChangeCanDragProperty(DependencyObject d, 
              DependencyPropertyChangedEventArgs e)
    {
        UIElement element = d as UIElement;
        if (element == null) return;

        if (e.NewValue != e.OldValue)
        {
            if ((bool)e.NewValue)
            {
                element.PreviewMouseDown += element_PreviewMouseDown;
                element.PreviewMouseUp += element_PreviewMouseUp;
                element.PreviewMouseMove += element_PreviewMouseMove;
            }
            else
            {
                element.PreviewMouseDown -= element_PreviewMouseDown;
                element.PreviewMouseUp -= element_PreviewMouseUp;
                element.PreviewMouseMove -= element_PreviewMouseMove;
            }
        }
    }

    // Determine if we're presently dragging
    private static bool _isDragging = false;
    // The offset from the top, left of the item being dragged 
    // and the original mouse down
    private static Point _offset;

    // This is triggered when the mouse button is pressed 
    // on the element being hooked
    static void element_PreviewMouseDown(object sender,
            System.Windows.Input.MouseButtonEventArgs e)
    {
        // Ensure it's a framework element as we'll need to 
        // get access to the visual tree
        FrameworkElement element = sender as FrameworkElement;
        if (element == null) return;

        // start dragging and get the offset of the mouse 
        // relative to the element
        _isDragging = true;
        _offset = e.GetPosition(element);
    }

    // This is triggered when the mouse is moved over the element
    private static void element_PreviewMouseMove(object sender, 
              MouseEventArgs e)
    {
        // If we're not dragging, don't bother - also validate the element
        if (!_isDragging) return;

        FrameworkElement element = sender as FrameworkElement;
        if (element == null) return;

        Canvas canvas = element.Parent as Canvas;
        if( canvas == null ) return;

        // Get the position of the mouse relative to the canvas
        Point mousePoint = e.GetPosition(canvas);

        // Offset the mouse position by the original offset position
        mousePoint.Offset(-_offset.X, -_offset.Y);

        // Move the element on the canvas
        element.SetValue(Canvas.LeftProperty, mousePoint.X);
        element.SetValue(Canvas.TopProperty, mousePoint.Y);
    }

    // this is triggered when the mouse is released
    private static void element_PreviewMouseUp(object sender, 
            MouseButtonEventArgs e)
    {
        _isDragging = false;
    }

} 
```

然后，您可以通过导入您的类所包含的命名空间在您的 XAML 中使用它（类似这样：）

```
<Window x:Class="WPFFunWithDragging.Window1"
        xmlns:local="clr-namespace:WPFFunWithDragging" .. > 
```

然后您可以在要拖动的元素上设置 DraggableExtender.CanDrag="true" ：

```
<Canvas>
    <Image Source="Garden.jpg" 
           Width="50" 
           Canvas.Left="10" Canvas.Top="10" 
           local:DraggableExtender.CanDrag="true"/>
</Canvas> 
```

希望这有点用:)

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2019-12-30T19:18:24.610

deepcode.co.uk 提供的解决方案是可以的；但是，我在实现它时错过了一些功能，因此我正在扩展他的解决方案。

当画布内有2个或更多元素时，还需要设置：

```
 private void Element_PreviewMouseDown(object sender, MouseEventArgs e)
    {
        element.CaptureMouse();
    }

    private void Element_PreviewMouseUp(object sender, MouseButtonEventArgs e)
    {
        element.ReleaseMouseCapture();
    } 
```

这样拖动动作只会影响当前活动的元素。

人们也可能不希望元素在拖动时超出画布的边界：

```
 if (mousePoint.X > 0 && mousePoint.X + element.ActualWidth <= canvas.ActualWidth &&
        mousePoint.Y > 0 && mousePoint.Y + element.ActualHeight <= canvas.ActualHeight)
    {
        element.SetValue(Canvas.LeftProperty, mousePoint.X);
        element.SetValue(Canvas.TopProperty, mousePoint.Y);
    } 
```

如果您希望活动元素始终出现在顶部：

```
 private void Element_PreviewMouseDown(object sender, MouseEventArgs e)
    {
        Panel.SetZIndex(element, 1);
    }

    private void Element_PreviewMouseUp(object sender, MouseButtonEventArgs e)
    {
        Panel.SetZIndex(element, 0);
    } 
```

# c - 普通 C 语言中的 SGML 解析器

> ID：294228
> 
> 赞同：3
> 
> 时间：2008-11-16T18:57:53.410
> 
> 标签：c, parsing, sgml

我正在寻找一个用纯 C 编写的开源 SGML 解析器。这是为了解析真正的 SGML，而不是格式错误的东西。

有任何想法吗？

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2008-11-16T21:56:41.583

有 OpenSP，它是[OpenJade](http://sourceforge.net/projects/openjade/)项目的一部分，但用 C++ 实现。可能足够接近您的需求？

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2008-11-16T19:02:18.673

这出现在快速谷歌搜索（[sgml c 解析器](http://www.google.com/search?q=sgml+c+parser)）：[http](http://www.w3.org/Library/src/SGML.html) ://www.w3.org/Library/src/SGML.html 。这有帮助吗？

或者也许这个： http: [//www.math.utah.edu/pub/sgml/sgmls/](http://www.math.utah.edu/pub/sgml/sgmls/)

# java - 以恒定时间将节点插入链表？

> ID：294234
> 
> 赞同：1
> 
> 时间：2008-11-16T19:05:28.090
> 
> 标签：java, linked-list

我正在做一个任务，告诉我假设我有一个带有标题和尾节点的单链表。它要我在位置 p 之前插入一个项目 y。任何人都可以查看我的代码并告诉我我是否在正确的轨道上？如果没有，你能给我提供任何提示或指示（不是双关语）吗？

```
tmp = new Node();
tmp.element = p.element;
tmp.next = p.next;
p.element = y;
p.next = tmp; 
```

我认为我可能是错的，因为我根本没有使用头和尾节点，即使它们在问题描述中特别提到。我正在考虑编写一个 while 循环来遍历列表，直到它找到 p 并以这种方式解决问题，但这不会是恒定时间，对吗？

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2008-11-16T19:10:54.227

如果您遇到算法困难，只需将其写下来：

```
// First we have a pointer to a node containing element (elm) 
// with possible a next element.
// Graphically drawn as:
// p -> [elm] -> ???

tmp = new Node();
// A new node is created. Variable tmp points to the new node which 
// currently has no value.
// p   -> [elm] -> ???
// tmp -> [?]

tmp.element = p.element;

// The new node now has the same element as the original.
// p   -> [elm] -> ???
// tmp -> [elm]

tmp.next = p.next;

// The new node now has the same next node as the original.
// p   -> [elm] -> ???
// tmp -> [elm] -> ???

p.element = y;

// The original node now contains the element y.
// p   -> [y] -> ???
// tmp -> [elm] -> ???

p.next = tmp;

// The new node is now the next node from the following.
// p   -> [y] -> [elm] -> ???
// tmp -> [elm] -> ??? 
```

你有所需的效果，但它可以更有效，我敢打赌你现在可以找到自己。

写这样的东西更清楚：

```
tmp = new Node();
tmp.element = y;
tmp.next = p;
p = tmp; 
```

如果 p 不可变，这当然不起作用。但是如果 p == NULL，您的算法将失败。

但我想说的是，如果你对算法有问题，就把效果写出来。特别是对于树和链表，你需要确保所有的指针都指向正确的方向，否则你会弄得一团糟。

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2008-11-16T19:15:21.473

**提示：仅当位置***n* = 0 或链表的头部时，插入链表才是常数。否则，最坏情况的复杂度为*O(n)*。这并不是说您不能创建一个相当有效的算法，但它总是*至少*具有线性复杂性。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2010-07-17T23:53:48.260

问题中给出头部和尾部节点的原因是如果您创建的替换节点恰好成为头部或尾部，则更新头部和尾部引用。换句话说，给定的前一个节点要么是头部，要么是尾部。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2008-11-16T19:25:03.870

您没有做的是在将 y 插入到 y 之前将 p 之前的元素链接起来。因此，虽然 y 在 p 之前插入，但现在没有人指向 y（至少不在您显示的代码中）。

如果您知道必须插入 y 的元素的位置，则只能在恒定时间内插入。如果您必须搜索该位置，那么您永远无法在单个链接列表中进行恒定时间插入。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2008-11-17T04:17:22.423

使用已经存在的代码怎么样？LinkedHashMap、LinkedList、LinkedHashSet。您还可以查看代码并从中学习。

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2010-03-31T17:09:36.237

```
create a node ptr
ptr->info = item //item is the element to be inserted...
ptr->next = NULL
if (start == NULL) //insertion at the end...
    start = ptr
else
    temp = ptr
    while (temp->next != NULL)
        temp = temp->next
    end while 
end if
if (start == NULL) //insertion at the beginning...
    start = ptr
else
    temp = start
    ptr->info = item
    ptr->next = start
    start = ptr
end if
temp = start //insertion at specified location...
for (i = 1; i < pos-1; i++)
    if (start == NULL)
        start = ptr
    else
        t = temp
        temp = temp->next
    end if
end for
t->next = ptr->next
t->next = ptr 
```

* * *

## 回答 #7

> 赞同：0
> 
> 时间：2012-12-11T18:58:36.173

在一个单独的 LinkedList 中，仅将一个节点添加到列表的开头或创建一个只有一个节点的列表将花费 O(1)。或者因为他们已经提供了 TailNode，所以在列表末尾插入节点需要 O(1)。

每隔一个插入操作将花费 O(n)。

# wpf - WPF - HeaderStringFormat 在扩展器中不起作用

> ID：294241
> 
> 赞同：12
> 
> 时间：2008-11-16T19:08:16.900
> 
> 标签：wpf, data-binding, string-formatting

我似乎找不到使 HeaderStringFormat 为 WPF Expander 工作的神奇组合。

这是我尝试过的所有事情：

```
<Expander Header="{Binding Path=MyProperty, StringFormat=Stuff: ({0})}"  >
    <TextBlock Text="Some Content" />
</Expander>
<Expander HeaderStringFormat="{}Stuff ({0})" Header="{Binding Path=MyProperty}">
    <TextBlock Text="Some More Content" />
</Expander>
<Expander HeaderStringFormat="{}Stuff ({0:0})" Header="{Binding Path=MyProperty}">
    <TextBlock Text="Even More Content" />
</Expander> 
```

我可以让格式化字符串在我的代码中正常工作的唯一方法是这样做：

```
<Expander>
    <Expander.Header>
        <TextBlock Text="{Binding Path=MyProperty, StringFormat=Stuff: ({0})}" />
    </Expander.Header>
    <Expander.Content>
        A Expander with working header
    </Expander.Content>
</Expander> 
```

我究竟做错了什么？

* * *

## 回答 #1

> 赞同：12
> 
> 时间：2008-11-17T04:10:32.343

首先要注意的是：

> 如果您设置 HeaderedContentControl 的 HeaderTemplate 或 HeaderTemplateSelector 属性，则会忽略 HeaderStringFormat 属性。 [MSDN](http://msdn.microsoft.com/en-us/library/system.windows.controls.headeredcontentcontrol.headerstringformat.aspx)

在 WPF 中有很多这样的陷阱需要提防。您没有在示例中显示这一点，但请记住这一点。但是，我不认为这是你的问题。

第二件事要注意的是，这与以下内容不同：

```
String.Format("My string value is: {0}", myValue"); 
```

HeaderedContentControl 和 HeaderStringFormat 专门用于实现 IFormattable 的类。HederStringFormat 格式化标题，ContentStringFormat 格式化内容。如果 IFormattable.ToString，任一属性的值都是传递给您的类实现的格式。您可以阅读[MSDN](http://msdn.microsoft.com/en-us/library/system.windows.controls.headeredcontentcontrol.headerstringformat.aspx)上的完整示例。但这里是如何使它工作的要点。

```
public class MyTestClass : IFormattable
{
    #region IFormattable Members
    public string ToString(string format, IFormatProvider formatProvider)
    {
        if(format == "n")
        {
            return "This is my formatted string";
        }
        else
        {
            return "this is my non-formatted string";
        }
    }
    #endregion
}

    <Style TargetType="{x:Type TabItem}">
        <Setter Property="HeaderStringFormat" Value="n" />
        <Setter Property="ContentStringFormat" Value="" />
    </Style>

<TabControl>
    <TabItem Header="{Binding Content, RelativeSource={RelativeSource Self}}">
        <local:MyTestClass />
    </TabItem>
</TabControl> 
```

这个 TabItem 现在将在标题中显示“这是我的格式化字符串”，内容将是“这是我的非格式化字符串”。

有几件事要记住。通常，这些属性将仅在 HeaderedItemsControl 上下文中使用。HeaderStringFormat 不会以这种方式绑定，而是将具有 HeaderedItemsControl 的 ItemContainer 提供的默认绑定。例如，如果您设置 TabItem 的 ItemsSource 属性，那么它将自动为您连接标题和内容绑定，您所要做的就是提供您想要的格式值。

最后但并非最不重要的一点是，我能够使用 GroupBox 和 TabItem 使一切正常工作，但使用扩展器并没有那么幸运，我不知道为什么。扩展器正确处理 ContentStringFormat，但不能正确处理 HeaderContentStringFormat。考虑到两者都继承自 HeaderContentControl，这令人惊讶。

# javascript - 如何检索 HTML 元素的实际宽度和高度？

> ID：294250
> 
> 赞同：1058
> 
> 时间：2008-11-16T19:15:24.577
> 
> 标签：javascript, html, dhtml

假设我有一个`<div>`我希望在浏览器的显示（视口）中居中的。为此，我需要计算`<div>`元素的宽度和高度。

我应该使用什么？请包含有关浏览器兼容性的信息。

* * *

## 回答 #1

> 赞同：1525
> 
> 时间：2008-11-16T19:35:11.697

您应该使用[`.offsetWidth`](https://developer.mozilla.org/en-US/docs/Web/API/HTMLElement/offsetWidth)and[`.offsetHeight`](https://developer.mozilla.org/en-US/docs/Web/API/HTMLElement/offsetHeight)属性。请注意，它们属于元素，而不是`.style`.

`var width = document.getElementById('foo').offsetWidth;`

[函数`.getBoundingClientRect()`](https://developer.mozilla.org/en-US/docs/Web/API/Element/getBoundingClientRect)在执行 CSS 转换后将元素的尺寸和位置作为浮点数返回。

```
> console.log(document.getElementById('id').getBoundingClientRect())
DOMRect {
    bottom: 177,
    height: 54.7,
    left: 278.5,​
    right: 909.5,
    top: 122.3,
    width: 631,
    x: 278.5,
    y: 122.3,
} 
```

* * *

## 回答 #2

> 赞同：231
> 
> 时间：2015-09-18T18:37:04.957

看看[`Element.getBoundingClientRect()`](https://developer.mozilla.org/en-US/docs/Web/API/Element/getBoundingClientRect)。

此方法将返回一个包含`width`、`height`和其他一些有用值的对象：

```
{
    width: 960,
    height: 71,
    top: 603,
    bottom: 674,
    left: 360,
    right: 1320
} 
```

例如：

```
var element = document.getElementById('foo');
var positionInfo = element.getBoundingClientRect();
var height = positionInfo.height;
var width = positionInfo.width; 
```

我相信这不存在有时会返回的问题（如此`.offsetWidth`处的[评论](https://stackoverflow.com/a/294273/363701)中所述）`.offsetHeight``0`

另一个区别是`getBoundingClientRect()`可能返回小数像素，其中`.offsetWidth`和`.offsetHeight`将四舍五入到最接近的整数。

**IE8 注意**：`getBoundingClientRect`不返回**IE8**及以下版本的高度和宽度。*

如果您*必须*支持 IE8，请使用`.offsetWidth`and `.offsetHeight`：

```
var height = element.offsetHeight;
var width = element.offsetWidth; 
```

值得注意的是，该方法返回的 Object 并不是真正的*普通*对象。它的属性是不可[*枚举*](https://developer.mozilla.org/en-US/docs/Web/JavaScript/Enumerability_and_ownership_of_properties)的（例如，`Object.keys`不能开箱即用。）

更多信息在这里： [如何最好地将 ClientRect / DomRect 转换为普通对象](https://stackoverflow.com/questions/39417566/how-best-to-convert-a-clientrect-domrect-into-a-plain-object)

参考：

*   **`.offsetHeight`**：[https ://developer.mozilla.org/en-US/docs/Web/API/HTMLElement/offsetHeight](https://developer.mozilla.org/en-US/docs/Web/API/HTMLElement/offsetHeight)
*   **`.offsetWidth`**：[https ://developer.mozilla.org/en-US/docs/Web/API/HTMLElement/offsetWidth](https://developer.mozilla.org/en-US/docs/Web/API/HTMLElement/offsetWidth)
*   **`.getBoundingClientRect()`**：[https ://developer.mozilla.org/en-US/docs/Web/API/Element/getBoundingClientRect](https://developer.mozilla.org/en-US/docs/Web/API/Element/getBoundingClientRect)

* * *

## 回答 #3

> 赞同：75
> 
> 时间：2008-11-16T19:29:19.323

**注意**：*这个答案写于 2008 年。当时对大多数人来说最好的跨浏览器解决方案确实是使用 jQuery。我将答案留给后代，如果您使用的是 jQuery，这是一个很好的方法。如果您使用的是其他框架或纯 JavaScript，则可接受的答案可能是要走的路。*

从 jQuery 1.2.6 开始，您可以使用核心[CSS 函数](http://api.jquery.com/category/css/)之一, `height`and `width`（或`outerHeight`and `outerWidth`，视情况而定）。

```
var height = $("#myDiv").height();
var width = $("#myDiv").width();

var docHeight = $(document).height();
var docWidth = $(document).width(); 
```

* * *

## 回答 #4

> 赞同：54
> 
> 时间：2016-02-19T12:52:13.587

以防万一它对任何人有用，我用相同的 css 放置了一个文本框、按钮和 div：

```
width:200px;
height:20px;
border:solid 1px #000;
padding:2px;

<input id="t" type="text" />
<input id="b" type="button" />
<div   id="d"></div> 
```

我在 chrome、firefox 和 ie-edge 中尝试过，我尝试使用 jquery 和不使用，我尝试使用和不使用`box-sizing:border-box`. 总是与`<!DOCTYPE html>`

结果：

```
 Firefox       Chrome        IE-Edge    
                                                              with   w/o    with   w/o    with   w/o     box-sizing

$("#t").width()                                               194    200    194    200    194    200
$("#b").width()                                               194    194    194    194    194    194
$("#d").width()                                               194    200    194    200    194    200

$("#t").outerWidth()                                          200    206    200    206    200    206
$("#b").outerWidth()                                          200    200    200    200    200    200
$("#d").outerWidth()                                          200    206    200    206    200    206

$("#t").innerWidth()                                          198    204    198    204    198    204
$("#b").innerWidth()                                          198    198    198    198    198    198
$("#d").innerWidth()                                          198    204    198    204    198    204

$("#t").css('width')                                          200px  200px  200px  200px  200px  200px
$("#b").css('width')                                          200px  200px  200px  200px  200px  200px
$("#d").css('width')                                          200px  200px  200px  200px  200px  200px

$("#t").css('border-left-width')                              1px    1px    1px    1px    1px    1px
$("#b").css('border-left-width')                              1px    1px    1px    1px    1px    1px
$("#d").css('border-left-width')                              1px    1px    1px    1px    1px    1px

$("#t").css('padding-left')                                   2px    2px    2px    2px    2px    2px
$("#b").css('padding-left')                                   2px    2px    2px    2px    2px    2px
$("#d").css('padding-left')                                   2px    2px    2px    2px    2px    2px

document.getElementById("t").getBoundingClientRect().width    200    206    200    206    200    206
document.getElementById("b").getBoundingClientRect().width    200    200    200    200    200    200
document.getElementById("d").getBoundingClientRect().width    200    206    200    206    200    206

document.getElementById("t").offsetWidth                      200    206    200    206    200    206
document.getElementById("b").offsetWidth                      200    200    200    200    200    200
document.getElementById("d").offsetWidth                      200    206    200    206    200    206 
```

* * *

## 回答 #5

> 赞同：26
> 
> 时间：2018-03-01T20:38:01.883

根据[MDN：确定元素的尺寸](https://developer.mozilla.org/en-US/docs/Web/API/CSS_Object_Model/Determining_the_dimensions_of_elements)

`offsetWidth`并`offsetHeight`返回“元素占用的总空间量，包括可见内容的宽度、滚动条（如果有）、填充和边框”

`clientWidth`并`clientHeight`返回“实际显示的内容占用了多少空间，包括填充但不包括边框、边距或滚动条”

`scrollWidth`并`scrollHeight`返回“内容的实际大小，无论当前可见多少”

所以这取决于测量的内容是否预计会超出当前的可视区域。

* * *

## 回答 #6

> 赞同：6
> 
> 时间：2008-11-16T20:57:23.497

您只需要为 IE7 和更早版本计算它（并且仅当您的内容没有固定大小时）。我建议使用 HTML 条件注释来限制对不支持 CSS2 的旧 IE 的攻击。对于所有其他浏览器，请使用：

```
<style type="text/css">
    html,body {display:table; height:100%;width:100%;margin:0;padding:0;}
    body {display:table-cell; vertical-align:middle;}
    div {display:table; margin:0 auto; background:red;}
</style>
<body><div>test<br>test</div></body> 
```

这是完美的解决方案。它`<div>`以任何大小为中心，并将其收缩包装到其内容的大小。

* * *

## 回答 #7

> 赞同：4
> 
> 时间：2018-04-27T11:58:34.780

修改元素样式很容易，但读取值有点棘手。

JavaScript 无法读取来自 css(internal/external) 的任何元素样式属性 (elem.style)，除非您使用 javascript 中的内置方法调用 getComputedStyle。

> getComputedStyle（元素[，伪]）

**元素：**要为其读取值的元素。
**伪：**如果需要，一个伪元素，例如 ::before。空字符串或无参数表示元素本身。

结果是一个具有样式属性的对象，例如 elem.style，但现在涉及所有 css 类。

例如，这里的样式看不到边距：

```
<head>
  <style> body { color: red; margin: 5px } </style>
</head>
<body>

  <script>
    let computedStyle = getComputedStyle(document.body);

    // now we can read the margin and the color from it

    alert( computedStyle.marginTop ); // 5px
    alert( computedStyle.color ); // rgb(255, 0, 0)
  </script>

</body> 
```

因此修改了您的 javaScript 代码以包含您希望获取它的宽度/高度或其他属性的元素的 getComputedStyle

```
window.onload = function() {

    var test = document.getElementById("test");
    test.addEventListener("click", select);

    function select(e) {                                  
        var elementID = e.target.id;
        var element = document.getElementById(elementID);
        let computedStyle = getComputedStyle(element);
        var width = computedStyle.width;
        console.log(element);
        console.log(width);
    }

} 
```

**计算和解析值**

CSS中有两个概念：

> 计算的样式值是应用所有 CSS 规则和 CSS 继承后的值，作为 CSS 级联的结果。它可能看起来像 height:1em 或 font-size:125%。
> 
> 已解决的样式值是最终应用于元素的样式值。像 1em 或 125% 这样的值是相对的。浏览器采用计算值并使所有单位固定和绝对，例如：height:20px 或 font-size:16px。对于几何属性，解析值可能有一个浮点数，例如 width:50.5px。

*很久以前 getComputedStyle 被创建用于获取计算值，但结果证明解析值更方便，并且标准改变了。
所以现在 getComputedStyle 实际上返回了属性的解析值。*

**请注意：**

**getComputedStyle 需要完整的属性名称**

> 您应该始终询问您想要的确切属性，例如 paddingLeft 或高度或宽度。否则不能保证正确的结果。
> 
> 例如，如果有属性 paddingLeft/paddingTop，那么我们应该为 getComputedStyle(elem).padding 得到什么？什么都没有，或者可能是已知填充的“生成”值？这里没有标准规则。

**还有其他不一致的地方。例如，一些浏览器 (Chrome) 在下面的文档中显示 10px，而其中一些 (Firefox) 则不显示：**

```
<style>
  body {
    margin: 30px;
    height: 900px;
  }
</style>
<script>
  let style = getComputedStyle(document.body);
  alert(style.margin); // empty string in Firefox
</script> 
```

欲了解更多信息[https://javascript.info/styles-and-classes](https://javascript.info/styles-and-classes)

* * *

## 回答 #8

> 赞同：2
> 
> 时间：2008-11-16T19:50:32.370

element.offsetWidth 和 element.offsetHeight 应该按照上一篇文章中的建议进行。

但是，如果您只想使内容居中，则有更好的方法。假设您使用 xhtml 严格的 DOCTYPE。将 margin:0,auto 属性和所需宽度（以 px 为单位）设置为 body 标签。内容与页面中心对齐。

* * *

## 回答 #9

> 赞同：1
> 
> 时间：2009-03-25T11:24:32.067

您也可以使用以下代码：

```
var divID = document.getElementById("divid");

var h = divID.style.pixelHeight; 
```

* * *

## 回答 #10

> 赞同：1
> 
> 时间：2012-03-01T00:21:40.003

...似乎CSS有助于将div放在中心...

```
<style>
 .monitor {
 position:fixed;/* ... absolute possible if on :root */
 top:0;bottom:0;right:0;left:0;
 visibility:hidden;
 }
 .wrapper {
 width:200px;/* this is size range */
 height:100px;
 position:absolute;
 left:50%;top:50%;
 visibility:hidden;
 }

 .content {
 position:absolute;
 width: 100%;height:100%;
 left:-50%;top:-50%;
 visibility:visible;
 }

</style>

 <div class="monitor">
  <div class="wrapper">
   <div class="content">

 ... so you hav div 200px*100px on center ...

  </div>
 </div>
</div> 
```

* * *

## 回答 #11

> 赞同：0
> 
> 时间：2020-08-19T20:39:58.693

# 柔性

如果您想`<div>`在屏幕中心的某种弹出消息中显示 - 那么您不需要阅读 size of`<div>`但您可以使用[flex](https://css-tricks.com/snippets/css/a-guide-to-flexbox/)

```
.box {
  width: 50px;
  height: 20px;
  background: red;
}

.container {
  display: flex;
  justify-content: center;
  align-items: center;
  height: 100vh;
  width: 100vw;
  position: fixed; /* remove this in case there is no content under div (and remember to set body margins to 0)*/
}
```

```
<div class="container">
  <div class="box">My div</div>
</div>
```

* * *

## 回答 #12

> 赞同：0
> 
> 时间：2021-06-30T01:03:25.430

我为此创建了一个实用函数，具有很高的灵活性：

```
export type Size = {width: number, height: number};
export enum GetSize_Method {
    /** Includes: content, padding. Excludes: border, margin, scroll-bar (if it has one), "position:absolute" descendants. */
    ClientSize = "ClientSize",
    /** Includes: content, padding, border, margin, scroll-bar (if it has one). Excludes: "position:absolute" descendants. */
    OffsetSize = "OffsetSize",
    /** Includes: content, padding, border, margin, scroll-bar (if it has one), "position:absolute" descendants. Excludes: none. */
    ScrollSize = "ScrollSize",
    /** Same as ScrollSize, except that it's calculated after the element's css transforms are applied. */
    BoundingClientRect = "BoundingClientRect",
    /** Lets you specify the exact list of components you want to include in the size calculation. */
    Custom = "Custom",
}
export type SizeComp = "content" | "padding" | "border" | "margin" | "scrollBar" | "posAbsDescendants";

export function GetSize(el: HTMLElement, method = GetSize_Method.ClientSize, custom_sizeComps?: SizeComp[]) {
    let size: Size;
    if (method == GetSize_Method.ClientSize) {
        size = {width: el.clientWidth, height: el.clientHeight};
    } else if (method == GetSize_Method.OffsetSize) {
        size = {width: el.offsetWidth, height: el.offsetHeight};
    } else if (method == GetSize_Method.ScrollSize) {
        size = {width: el.scrollWidth, height: el.scrollHeight};
    } else if (method == GetSize_Method.BoundingClientRect) {
        const rect = el.getBoundingClientRect();
        size = {width: rect.width, height: rect.height};
    } else if (method == GetSize_Method.Custom) {
        const style = window.getComputedStyle(el, null);
        const styleProp = (name: string)=>parseFloat(style.getPropertyValue(name));

        const padding = {w: styleProp("padding-left") + styleProp("padding-right"), h: styleProp("padding-top") + styleProp("padding-bottom")};
        const base = {w: el.clientWidth - padding.w, h: el.clientHeight - padding.h};
        const border = {w: styleProp("border-left") + styleProp("border-right"), h: styleProp("border-top") + styleProp("border-bottom")};
        const margin = {w: styleProp("margin-left") + styleProp("margin-right"), h: styleProp("margin-top") + styleProp("margin-bottom")};
        const scrollBar = {w: (el.offsetWidth - el.clientWidth) - border.w - margin.w, h: (el.offsetHeight - el.clientHeight) - border.h - margin.h};
        const posAbsDescendants = {w: el.scrollWidth - el.offsetWidth, h: el.scrollHeight - el.offsetHeight};

        const sc = (name: SizeComp, valIfEnabled: number)=>custom_sizeComps.includes(name) ? valIfEnabled : 0;
        size = {
            width: sc("content", base.w) + sc("padding", padding.w) + sc("border", border.w)
                    + sc("margin", margin.w) + sc("scrollBar", scrollBar.w) + sc("posAbsDescendants", posAbsDescendants.w),
            height: sc("content", base.h) + sc("padding", padding.h) + sc("border", border.h)
                    + sc("margin", margin.h) + sc("scrollBar", scrollBar.h) + sc("posAbsDescendants", posAbsDescendants.h),
        };
    }
    return size;
} 
```

用法：

```
const el = document.querySelector(".my-element");
console.log("Size:", GetSize(el, "ClientSize"));
console.log("Size:", GetSize(el, "Custom", ["content", "padding", "border"])); 
```

* * *

## 回答 #13

> 赞同：0
> 
> 时间：2022-01-25T16:47:49.390

这是唯一对我有用的东西：

```
element.clientWidth -
parseFloat(window.getComputedStyle(element, null).getPropertyValue("padding-left")) -
parseFloat(window.getComputedStyle(element, null).getPropertyValue("padding-right")) 
```

* * *

## 回答 #14

> 赞同：-4
> 
> 时间：2015-03-04T14:12:30.050

如果 offsetWidth 返回 0，则可以获取元素的样式宽度属性并在其中搜索数字。“100 像素”-> 100

/\d*/.exec(MyElement.style.width)

* * *

## 回答 #15

> 赞同：-4
> 
> 时间：2018-05-31T11:52:38.463

这是确定特定 Dom 元素高度的**WKWebView**的代码（不适用于整个页面）

```
let html = "<body><span id=\"spanEl\" style=\"font-family: '\(taskFont.fontName)'; font-size: \(taskFont.pointSize - 4.0)pt; color: rgb(\(red), \(blue), \(green))\">\(textValue)</span></body>"
webView.navigationDelegate = self
webView.loadHTMLString(taskHTML, baseURL: nil)

func webView(_ webView: WKWebView, didFinish navigation: WKNavigation!) {
    webView.evaluateJavaScript("document.getElementById(\"spanEl\").getBoundingClientRect().height;") { [weak self] (response, error) in
        if let nValue = response as? NSNumber {

        }
    }
} 
```

* * *

## 回答 #16

> 赞同：-4
> 
> 时间：2020-11-02T17:56:43.707

使用宽度参数如下：

```
 style={{
      width: "80%",
      paddingLeft: 100,
      paddingRight: 200,
      paddingTop: 30,
      paddingBottom: 30,
      border: "3px solid lightGray",
    }} 
```

# c++ - tr1::mem_fn 和具有默认参数的成员

> ID：294261
> 
> 赞同：4
> 
> 时间：2008-11-16T19:25:24.620
> 
> 标签：c++, tr1

我有一个带有默认参数的成员函数的类。

```
struct Class
{
    void member(int n = 0)
    {}
}; 
```

通过 std::tr1::mem_fn 我可以调用它：

```
Class object;

std::tr1::mem_fn(&Class::member)(object,10); 
```

也就是说，如果我想使用默认参数调用对象上的*可调用成员，那么正确的语法是什么？*

```
std::tr1::mem_fn(&Class::member)(object); // This does not work 
```

g++ 抱怨以下错误：

```
test.cc:17: error: no match for call to ‘(std::tr1::_Mem_fn<void (Class::*)(int)>) (Class&)’
/usr/include/c++/4.3/tr1_impl/functional:551: note: candidates are: _Res std::tr1::_Mem_fn<_Res (_Class::*)(_ArgTypes ...)>::operator()(_Class&, _ArgTypes ...) const [with _Res = void, _Class = Class, _ArgTypes = int]
/usr/include/c++/4.3/tr1_impl/functional:556: note:                 _Res std::tr1::_Mem_fn<_Res (_Class::*)(_ArgTypes ...)>::operator()(_Class*, _ArgTypes ...) const [with _Res = void, _Class = Class, _ArgTypes = int] 
```

尽管如此，当 Class::member 被采用不同参数的成员重载时，我也有同样的问题......

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2008-11-16T19:41:42.543

默认函数在调用时绑定，但不能隐式绑定到任何类型的包装器中，因为它们的实现方式。当你通过时`&Class::member`，`mem_fn`只看到一个`void (Class::*)(int)`，而看不到默认参数。使用`tr1::bind`，您可以显式地绑定默认参数：`std::tr1::bind(&Class::member, 0)`或者您可以像使用它一样使用它`mem_fn`，但您不能在一个对象中同时执行这两种操作。您必须为此编写自己的包装类。

至于重载，您必须显式指定模板参数，`mem_fn`以便选择正确的函数指针，如`mem_fn<void(int)>(&Class::member)`.

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2008-11-16T19:36:27.450

原因是任何默认参数都不会改变函数的函数类型。

`mem_fn`无法知道该函数只需要 1 个参数，或者该函数的第二个参数是可选的，因为它获得的所有知识都是由`&Class::member`( 保留`void(Class::*)(int)`) 的类型提供给它的。因此它需要一个整数作为第二个参数。

如果要传递重载成员函数的地址，则必须强制转换为正确的成员函数指针类型：

`static_cast<void(Class::*)()>(&Class::member)` 而不是 just `&Class::member`，所以编译器有一个上下文来确定要采用哪个地址。

**编辑**： coppro 有一个更好的解决方案如何提供上下文：`std::tr1::mem_fn<void()>(&Class::member)`

# sharepoint - 将多个用户分配给 sharepoint 中的工作流任务

> ID：294267
> 
> 赞同：7
> 
> 时间：2008-11-16T19:27:34.007
> 
> 标签：sharepoint, workflow-foundation, wss

有没有人能够使用 CreateTask 活动将多个用户分配给一个共享点工作流任务？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2008-12-01T05:56:47.180

Sharepoint 任务允许使用组。将任务分配给组并在分配任务后触发工作流。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2008-11-28T04:31:09.473

不久前，我写了一篇关于如何与多个用户一起开发自定义活动的博客。我已经有一段时间没有这样做了，所以我不能 100% 确定它是否适用于您的问题，但值得一试：

[多值列解决方案 #2 - SPD 中的自定义活动](http://rapidapplicationdevelopment.blogspot.com/2007/04/multi-value-columns-solution-2-custom.html)

评论中也有有用的讨论。

希望有帮助，-李

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-01-22T10:50:29.070

是的，使用组来授予多个用户的权限。到目前为止最好的方法，我想这是轻松完成它的唯一方法。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2008-11-17T01:18:50.333

What version? WSS V3 or MOSS?

Is the "Create Task" bound to the Task List? If so then only one person at a time. Unless you have an AD group with a bunch of people or you modify the list to include SharePoint groups in the assigned to field.

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2009-03-03T20:27:01.030

如果该组中的任何用户都可以关闭任务，那么创建一个组绝对是要走的路。附带说明一下，如果您需要为多个用户执行单独的任务，您可以将复制器与自定义活动 / CreateTask 活动一起使用。

# c++ - 如何为全局对象、对象数组以及类/结构中的对象调用构造函数？

> ID：294270
> 
> 赞同：12
> 
> 时间：2008-11-16T19:32:36.680
> 
> 标签：c++, oop, constructor

在这三种情况下，您将如何调用以下类的构造函数：全局对象、对象数组和包含在另一个类/结构中的对象？

具有构造函数的类（在所有三个示例中都使用）：

```
class Foo {
    public:
        Foo(int a) { b = a; }

    private:
        int b;
}; 
```

以下是我调用此构造函数的尝试：

## 全局对象

```
Foo global_foo(3); // works, but I can't control when the constructor is called.

int main() {
    // ...
} 
```

## 对象数组

```
int main() {
    // Array on stack
    Foo array_of_foos[30](3); // doesn't work

    // Array on heap
    Foo *pointer_to_another_array = new Foo(3) [30]; // doesn't work
} 
```

在那里，我试图为数组的所有元素调用构造函数，但我也想知道如何在单个元素上调用它。

## 类/结构中包含的对象

```
class Bar {
    Foo foo(3); // doesn't work
};

int main() {
    Bar bar;
} 
```

* * *

## 回答 #1

> 赞同：11
> 
> 时间：2008-11-16T19:39:42.017

### 全局对象

你的方法是唯一的。另一方面，尽量避免这种情况。最好将函数（甚至其他对象）用作工厂。这样，您可以控制创建时间。

### 对象数组

没有办法直接做到这一点。非 POD 对象将始终是默认构造的。`std::fill`往往是很大的帮助。您可能还想研究分配器和`std::uninitialized_fill`.

### 类/结构中包含的对象

在构造函数中使用初始化列表：

```
class Bar {
    Foo foo;

    Bar() : foo(3) { }
}; 
```

静态成员实际上必须在类之外定义：

```
class Bar {
    static Foo foo;
};

Foo Bar::foo(3); 
```

* * *

## 回答 #2

> 赞同：5
> 
> 时间：2008-11-16T20:04:01.983

为了纠正对全局变量的一些误解：

*   该顺序在编译单元中得到了很好的定义。
    *   与定义顺序相同
*   跨编译单元的顺序未定义。
*   毁灭的顺序与创造**完全**相反。

不是我推荐的东西，但是：所以一个简单的解决方案是将所有全局变量放入一个编译单元中。

或者，您可以调整函数静态变量的使用。
基本上你可以有一个函数返回对你想要的全局的引用（在函数内部定义全局）。它将在首次使用时创建（并以创建的相反顺序销毁）。

```
Foo& getGlobalA() // passed parameters can be passed to constructor
{
    static Foo  A;
    return A;
}
Foo& getGlobalB()
{
    static Foo  B;
    return B;
}
etc. 
```

* * *

## 回答 #3

> 赞同：3
> 
> 时间：2008-11-16T20:10:09.443

Konrad 的回复是好的，只是关于数组的一个 puntualization.... 有一种方法可以创建一个项目数组（不是指针），如下所示：

```
//allocate raw memory for our array
void *rawMemory = operator new[](30 * sizeof(Foo))

// point array_of_foos to this memory so we can use it as an array of Foo
Foo *array_of_foos = static_cast<Foo *>(rawMemory);

// and now we can create the array of objects(NOT pointers to the objects)
//  using the buffered new operator
for (int i = 0; i < 30; i++)
    new(array_of_foos[i])Foo(3); 
```

这种方法在这里描述：[http ://www.amazon.com/gp/product/0321334876?ie=UTF8&tag=aristeia.com-20&linkCode=as2&camp=1789&creative=9325&creativeASIN=0321334876](https://rads.stackoverflow.com/amzn/click/com/0321334876)

* * *

## 回答 #4

> 赞同：2
> 
> 时间：2008-11-16T19:40:10.893

对于全局情况，无法控制何时调用。C++ 规范本质上说它将在 main() 之前调用，并在之后的某个时间被销毁。除此之外，编译器可以随心所欲地做任何事情。

在第一个数组案例中，您正在创建一个 Foo 对象的静态数组。默认情况下，数组中的每个值都将使用 Foo() 的默认构造函数进行初始化。原始 C++ 数组无法强制调用特定的重载构造函数。您可以通过切换到向量而不是数组来推断出一些控制。向量构造函数有一个重载的构造函数 vector(size,defaultValue) 应该实现你正在寻找的东西。但在这种情况下，您必须小心，因为它不会调用 Foo(3)，而是调用 Foo(const Foo& other)，其中 other 是 Foo(3)。

第二种数组情况与第一种情况非常相似。唯一真正的区别是分配内存的位置（在堆上而不是在堆栈上）。它在调用构造函数方面具有相同的限制。

包含的案例是一个不同的问题。C++ 在对象内字段的定义和字段的初始化之间有明确的区分。要让它在 C++ 中工作，您需要将 Bar 定义更改为以下

```
class Bar{
  Foo foo;
  Bar() : foo(3){}
}; 
```

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2008-11-16T22:31:24.727

该线程中似乎有一个一般要点，即除了使用默认构造函数之外，您无法初始化数组的成员。一个答案甚至创建了另一种类型，只是为了调用另一个构造函数。即使您可以（*如果数组不是类成员的一部分！*）：

```
struct foo {
    foo(int a): a(a) { }
    explicit foo(std::string s): s(s) { }
private:
    int a;
    std::string s;
};

/* global */
foo f[] = { foo("global"), foo("array") };

int main() {
    /* local */
    foo f[] = { 10, 20, 30, foo("a"), foo("b") };
} 
```

然而，类型需要是可复制的：给定的项目被复制初始化到数组的成员中。

对于作为类成员的数组，目前最好使用容器：

```
struct bar {
    /* create a vector of 100 foo's, initialized with "initial" */
    bar(): f(100, foo("initial")) { }
private:
    std::vector<foo> f;
}; 
```

使用`placement-new`andy.gurin 描述的技术也是一种选择。但请注意，这会使事情复杂化。您必须自己调用析构函数。如果任何构造函数抛出，而你仍在构建数组，那么你需要弄清楚你停止的位置......总而言之，如果你想在你的类中有数组，并且想要初始化它们，使用 a`std::vector`很简单赌注。

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2008-11-16T20:10:47.787

对象数组的构造：

您可以使用默认参数修改原始示例。

目前仅支持默认构造函数。
这是下一个版本正在解决的问题（因为每个人都会问这个问题）

* * *

## 回答 #7

> 赞同：0
> 
> 时间：2008-11-16T20:34:57.957

C++0X 初始化列表为对象数组解决了这个问题。请参阅[此](http://herbsutter.wordpress.com/2008/07/04/trip-report-june-2008-iso-c-standards-meeting/)Herb Sutter 博客条目，他在其中详细描述了它们。

与此同时，您也许可以像这样解决这个问题：

```
class Foo {
public:
    Foo(int a) : b(a) {}

private:
    int b;
};

class Foo_3 : public Foo {
public:
    Foo_3() : Foo(3) {}
};

Foo_3 array_of_foos[30]; 
```

在这里，`Foo_3`该类的存在只是为了`Foo`使用正确的参数调用构造函数。您甚至可以将其设为模板：

```
template <int i>    
class Foo_n : public Foo {
public:
    Foo_n() : Foo(i) {}
};

Foo_n<3> array_of_foos[30]; 
```

同样，这可能不会完全符合您的要求，但可能会提供一些思考。

（另请注意，在您的`Foo`课程中，您确实应该养成使用成员初始化列表而不是构造函数中的赋值的习惯，如我上面的示例所示）

* * *

## 回答 #8

> 赞同：0
> 
> 时间：2011-03-29T23:43:58.783

我认为有两种方法可以确保在“创建”时安全地调用全局类对象的构造函数：

1.  在命名空间中声明它们并使该命名空间可全局访问。

2.  使其成为指向类对象的全局指针，并在 main() 中为其分配一个新的类对象，授予访问该对象的其他全局对象的构造函数的代码将在此之前执行。

只是我的两分钱。

# java - 将 Java 库添加到 Netbeans Grails 项目

> ID：294279
> 
> 赞同：8
> 
> 时间：2008-11-16T19:39:53.840
> 
> 标签：java, grails, netbeans, groovy, jar

我刚刚开始使用 Grails。如何将 Java 库添加到我的 Grails 项目中？我将 Smack 库 jar 添加到我的 Grails 项目的 lib 文件夹中，但我仍然无法将它的任何包导入我的 Java 或 Groovy 类。我正在使用 Netbeans IDE。任何帮助，将不胜感激..

嗡嗡声

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2008-11-16T20:53:05.177

这是 NetBeans 中的一个已知错误：http: [//www.netbeans.org/issues/show_bug.cgi?id=144243](http://www.netbeans.org/issues/show_bug.cgi?id=144243)

也许您可以通过在 NetBeans 错误跟踪器中添加对此问题的评论来帮助 devolpers 修复它。

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2011-09-25T02:36:40.383

这是我在运行 SpringSource Toolssuite 时为解决问题所做的：

1.  通过添加外部 jars（例如 javax.mail、adwords-api 等）来配置构建路径

2.  将相同的 jar 导入 lib 文件夹（mysql 连接器 jar 所在的位置）。

这应该可以修复您因 java 文件中缺少导入而收到的编译时错误。

希望这可以帮助

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2008-11-16T21:45:54.290

如上所述，这是 IDE 中的错误，而不是 Grails。这些库在您的代码中可用，但 IDE 不会执行任何代码完成等。

注意，NetBeans 6.5 应该有更好的 Grails 集成。或者，您可以使用已经拥有的 IntelliJ。

G2One 被 Spring Source 收购也使得 Grails 的 Eclipse 集成路线图看起来更加美好。它还没有出现，但它即将到来，而且现在可能比我们想象的要快。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2009-06-11T22:33:36.917

NetBeans 6.5（内部版本 200811100001）中仍然存在该问题，因此 IDE 不会执行任何代码完成并将引用 JAR 中的类的代码格式化为错误。

我还没有尝试过 NetBeans 6.7。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2009-08-20T10:22:19.693

我正在使用 Netbeans 6.7。我只是将库粘贴到项目的“lib”文件夹中，当我回到 Netbeans 时，该库自动位于“库”文件夹下！

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2009-08-20T14:18:49.343

我也在使用netbean 6.7，当我通过Libraries文件夹下的jar时它会自动工作

# python - 用于 Autohotkey 风格的组合键嗅探、自动化的 Python？

> ID：294285
> 
> 赞同：10
> 
> 时间：2008-11-16T19:43:27.610
> 
> 标签：python, autohotkey

我想自动化几个任务（例如，模拟 Eclipse 风格`ctrl`——为其他编辑`shift`器`R`打开对话框）。一般模式是：用户按下某个组合键，我的程序会检测到它并可能会弹出一个对话框以获取用户输入，然后运行相应的命令，通常是通过运行可执行文件。

我的目标环境是 windows，虽然跨平台会很好。我的程序将启动一次，读取配置文件，然后坐在后台直到被组合键或其他事件触发。

基本上是自动热键。

为什么不只使用自动热键？我实际上有很多自动热键宏，但我更喜欢使用更理智的语言。

我的问题是：有没有一种让后台python进程检测组合键的好方法？

更新：使用 pyHook 和 win32 扩展找到了答案：

```
import pyHook
import pythoncom

def OnKeyboardEvent(event):
    print event.Ascii

hm = pyHook.HookManager()
hm.KeyDown = OnKeyboardEvent
hm.HookKeyboard()

while True:
    pythoncom.PumpMessages() 
```

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2008-11-16T22:05:51.160

你可能想看看[AutoIt](http://www.autoitscript.com/autoit3/)。它可以做 AutoHotKey 可以做的所有事情，但语言语法不会让你想把头发拉出来。此外，它具有 COM 绑定，因此如果您愿意，您可以在 python 中轻松使用它的大部分功能。[我之前](https://stackoverflow.com/questions/151846/get-other-running-processes-window-sizes-in-python#155587)已经在此处发布了有关如何操作的信息。

* * *

## 回答 #2

> 赞同：5
> 
> 时间：2009-02-17T16:07:25.310

使用 pyHook 和 win32 扩展找到了答案：

```
import pyHook
import pythoncom

def OnKeyboardEvent(event):
    print event.Ascii

hm = pyHook.HookManager()
hm.KeyDown = OnKeyboardEvent
hm.HookKeyboard()

while True:
    pythoncom.PumpMessages() 
```

# svn - 如何使用 svn 与超越比较 3

> ID：294286
> 
> 赞同：23
> 
> 时间：2008-11-16T19:46:00.770
> 
> 标签：svn, beyondcompare

我想使用 svn 命令行，并获得以下输出

```
Text Compare
Produced: 11/16/2008 11:45:34 AM

SourceFile,CompareFile,IOriginal,IAdded,IDeleted,IChanged,UOriginal,UAdded,UDeleted,UChanged
"E:\Downloads\eeli\eel\1.c","E:\Downloads\eeli\eel\2.c",967,192,501,270,368,113,205,89 
```

确切的命令行是什么？

* * *

## 回答 #1

> 赞同：20
> 
> 时间：2011-01-21T01:12:51.717

此处概述了不同版本控制系统的所有 Beyond Compare 设置：[http ://www.scootersoftware.com/download.php?c=kb_vcs](http://www.scootersoftware.com/download.php?c=kb_vcs)

对于 TortoiseSVN，请尝试[http://www.scootersoftware.com/support.php?zz=kb_vcs#tortoisesvn](http://www.scootersoftware.com/support.php?zz=kb_vcs#tortoisesvn)

* * *

## 回答 #2

> 赞同：8
> 
> 时间：2008-11-16T20:22:12.587

将其放入（例如）c:\bin\bcsvn.bat

```
@REM To configure this as the Subversion diff command, add these lines to
@REM    c:\Documents and Settings\username\Application Data\Subversion\config:
@REM
@REM [helpers]
@REM diff-cmd = c:\bin\bcsvn.bat
@REM
@"C:\Progra~1\Beyond~1\bcomp.exe" "%6" /title1=%3 "%7" /title2=%5
@exit 0 
```

您可能需要修复 bcomp.exe 的路径。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2019-05-20T16:14:24.577

其他人建议的说明对我不起作用。这是我最终得到它的方式：

I. 在 Windows 资源管理器窗口中，右键单击 > TortoiseSVN > 设置

1.  差异查看器
2.  外部的
3.  `...`

    [![前三个步骤](https://i.stack.imgur.com/m40IO.png)](https://i.stack.imgur.com/m40IO.png)

4.  找到`BCompare.exe`。如果您进行了正常安装，则它位于`C:\Program Files\Beyond Compare 4\`.

    *没有必要输入文档中列出的所有古怪变量，事实上我无法让它与这些变量一起工作。*

5.  如果需要，继续对 Diff Viewer 和 Merge Tool 中的其他选项执行相同的操作。

## *这是决赛的样子：*

[![在此处输入图像描述](https://i.stack.imgur.com/uxR6G.png)](https://i.stack.imgur.com/uxR6G.png)

# web-applications - 最新的网络应用程序功能

> ID：294287
> 
> 赞同：3
> 
> 时间：2008-11-16T19:46:31.083
> 
> 标签：web-applications

网络用户期待或兴奋什么样的功能？我知道阿贾克斯。还要别的吗？即使在这个 stackoverflow 网站上，我也不明白标签的重要性。我不明白维基是一个重要的功能吗？我看到问题在重要性或相关性方面被“踢”了，但仍然不了解它的全部影响。

我在哪里可以获得有关数据驱动网站的最新和最大期望的信息。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2008-11-16T19:54:49.693

而不是在这里向一群工程师提出您的问题。您应该采访目标人群中的潜在客户。不要寻找华而不实的东西，寻找最能解决客户问题的东西。

# c# - 更改主音量

> ID：294292
> 
> 赞同：15
> 
> 时间：2008-11-16T19:50:34.833
> 
> 标签：c#, winapi, volume

如何更改主音量级别？使用此代码

```
[DllImport ("winmm.dll")]
public static extern int waveOutSetVolume (IntPtr hwo, uint dwVolume);

waveOutSetVolume (IntPtr.Zero, (((uint)uint.MaxValue & 0x0000ffff) | ((uint)uint.MaxValue << 16))); 
```

我可以设置波形音量，但如果主音量太低，这不会有任何影响。

谢谢你的帮助。

* * *

## 回答 #1

> 赞同：34
> 
> 时间：2008-11-16T23:03:11.480

好的，这里开始：

```
const int MAXPNAMELEN            = 32;
const int MIXER_SHORT_NAME_CHARS = 16;
const int MIXER_LONG_NAME_CHARS  = 64;

[Flags] enum MIXERLINE_LINEF : uint{
    ACTIVE       = 0x00000001,
    DISCONNECTED = 0x00008000,
    SOURCE       = 0x80000000
}
[Flags] enum MIXER           : uint{
    GETLINEINFOF_DESTINATION     = 0x00000000,
    GETLINEINFOF_SOURCE          = 0x00000001,
    GETLINEINFOF_LINEID          = 0x00000002,
    GETLINEINFOF_COMPONENTTYPE   = 0x00000003,
    GETLINEINFOF_TARGETTYPE      = 0x00000004,
    GETLINEINFOF_QUERYMASK       = 0x0000000F,

    GETLINECONTROLSF_ALL         = 0x00000000,
    GETLINECONTROLSF_ONEBYID     = 0x00000001,
    GETLINECONTROLSF_ONEBYTYPE   = 0x00000002,
    GETLINECONTROLSF_QUERYMASK   = 0x0000000F,

    GETCONTROLDETAILSF_VALUE     = 0x00000000,
    GETCONTROLDETAILSF_LISTTEXT  = 0x00000001,
    GETCONTROLDETAILSF_QUERYMASK = 0x0000000F,

    OBJECTF_MIXER                = 0x00000000,
    OBJECTF_WAVEOUT              = 0x10000000,
    OBJECTF_WAVEIN               = 0x20000000,
    OBJECTF_MIDIOUT              = 0x30000000,
    OBJECTF_MIDIIN               = 0x40000000,
    OBJECTF_AUX                  = 0x50000000,
    OBJECTF_HANDLE               = 0x80000000,
    OBJECTF_HMIXER               = OBJECTF_HANDLE | OBJECTF_MIXER,
    OBJECTF_HWAVEOUT             = OBJECTF_HANDLE | OBJECTF_WAVEOUT,
    OBJECTF_HWAVEIN              = OBJECTF_HANDLE | OBJECTF_WAVEIN,
    OBJECTF_HMIDIOUT             = OBJECTF_HANDLE | OBJECTF_MIDIOUT,
    OBJECTF_HMIDIIN              = OBJECTF_HANDLE | OBJECTF_MIDIIN
}
[Flags] enum MIXERCONTROL_CT : uint{
    CLASS_MASK        = 0xF0000000,
    CLASS_CUSTOM      = 0x00000000,
    CLASS_METER       = 0x10000000,
    CLASS_SWITCH      = 0x20000000,
    CLASS_NUMBER      = 0x30000000,
    CLASS_SLIDER      = 0x40000000,
    CLASS_FADER       = 0x50000000,
    CLASS_TIME        = 0x60000000,
    CLASS_LIST        = 0x70000000,

    SUBCLASS_MASK     = 0x0F000000,

    SC_SWITCH_BOOLEAN = 0x00000000,
    SC_SWITCH_BUTTON  = 0x01000000,

    SC_METER_POLLED   = 0x00000000,

    SC_TIME_MICROSECS = 0x00000000,
    SC_TIME_MILLISECS = 0x01000000,

    SC_LIST_SINGLE    = 0x00000000,
    SC_LIST_MULTIPLE  = 0x01000000,

    UNITS_MASK        = 0x00FF0000,
    UNITS_CUSTOM      = 0x00000000,
    UNITS_BOOLEAN     = 0x00010000,
    UNITS_SIGNED      = 0x00020000,
    UNITS_UNSIGNED    = 0x00030000,
    UNITS_DECIBELS    = 0x00040000, /* in 10ths */
    UNITS_PERCENT     = 0x00050000, /* in 10ths */
}
[Flags] enum MIXERCONTROL_CONTROLTYPE : uint{
    CUSTOM         = MIXERCONTROL_CT.CLASS_CUSTOM | MIXERCONTROL_CT.UNITS_CUSTOM,
    BOOLEANMETER   = MIXERCONTROL_CT.CLASS_METER | MIXERCONTROL_CT.SC_METER_POLLED | MIXERCONTROL_CT.UNITS_BOOLEAN,
    SIGNEDMETER    = MIXERCONTROL_CT.CLASS_METER | MIXERCONTROL_CT.SC_METER_POLLED | MIXERCONTROL_CT.UNITS_SIGNED,
    PEAKMETER      = SIGNEDMETER + 1,
    UNSIGNEDMETER  = MIXERCONTROL_CT.CLASS_METER | MIXERCONTROL_CT.SC_METER_POLLED | MIXERCONTROL_CT.UNITS_UNSIGNED,
    BOOLEAN        = MIXERCONTROL_CT.CLASS_SWITCH | MIXERCONTROL_CT.SC_SWITCH_BOOLEAN | MIXERCONTROL_CT.UNITS_BOOLEAN,
    ONOFF          = BOOLEAN + 1,
    MUTE           = BOOLEAN + 2,
    MONO           = BOOLEAN + 3,
    LOUDNESS       = BOOLEAN + 4,
    STEREOENH      = BOOLEAN + 5,
    BASS_BOOST     = BOOLEAN + 0x00002277,
    BUTTON         = MIXERCONTROL_CT.CLASS_SWITCH | MIXERCONTROL_CT.SC_SWITCH_BUTTON | MIXERCONTROL_CT.UNITS_BOOLEAN,
    DECIBELS       = MIXERCONTROL_CT.CLASS_NUMBER | MIXERCONTROL_CT.UNITS_DECIBELS,
    SIGNED         = MIXERCONTROL_CT.CLASS_NUMBER | MIXERCONTROL_CT.UNITS_SIGNED,
    UNSIGNED       = MIXERCONTROL_CT.CLASS_NUMBER | MIXERCONTROL_CT.UNITS_UNSIGNED,
    PERCENT        = MIXERCONTROL_CT.CLASS_NUMBER | MIXERCONTROL_CT.UNITS_PERCENT,
    SLIDER         = MIXERCONTROL_CT.CLASS_SLIDER | MIXERCONTROL_CT.UNITS_SIGNED,
    PAN            = SLIDER + 1,
    QSOUNDPAN      = SLIDER + 2,
    FADER          = MIXERCONTROL_CT.CLASS_FADER | MIXERCONTROL_CT.UNITS_UNSIGNED,
    VOLUME         = FADER + 1,
    BASS           = FADER + 2,
    TREBLE         = FADER + 3,
    EQUALIZER      = FADER + 4,
    SINGLESELECT   = MIXERCONTROL_CT.CLASS_LIST | MIXERCONTROL_CT.SC_LIST_SINGLE | MIXERCONTROL_CT.UNITS_BOOLEAN,
    MUX            = SINGLESELECT + 1,
    MULTIPLESELECT = MIXERCONTROL_CT.CLASS_LIST | MIXERCONTROL_CT.SC_LIST_MULTIPLE | MIXERCONTROL_CT.UNITS_BOOLEAN,
    MIXER          = MULTIPLESELECT + 1,
    MICROTIME      = MIXERCONTROL_CT.CLASS_TIME | MIXERCONTROL_CT.SC_TIME_MICROSECS | MIXERCONTROL_CT.UNITS_UNSIGNED,
    MILLITIME      = MIXERCONTROL_CT.CLASS_TIME | MIXERCONTROL_CT.SC_TIME_MILLISECS | MIXERCONTROL_CT.UNITS_UNSIGNED
}

[StructLayout(LayoutKind.Sequential, CharSet=CharSet.Auto)]
struct MIXERLINE{
    [StructLayout(LayoutKind.Sequential, CharSet=CharSet.Auto)]
    public struct TargetInfo{
        public uint   dwType;
        public uint   dwDeviceID;
        public ushort wMid;
        public ushort wPid;
        public uint   vDriverVersion;
        [MarshalAs(UnmanagedType.ByValTStr, SizeConst=MAXPNAMELEN)]
        public string szPname;
    }

    public uint            cbStruct;
    public uint            dwDestination;
    public uint            dwSource;
    public uint            dwLineID;
    public MIXERLINE_LINEF fdwLine;
    public uint            dwUser;
    public uint            dwComponentType;
    public uint            cChannels;
    public uint            cConnection;
    public uint            cControls;
    [MarshalAs(UnmanagedType.ByValTStr, SizeConst=MIXER_SHORT_NAME_CHARS)]
    public string          szShortName;
    [MarshalAs(UnmanagedType.ByValTStr, SizeConst=MIXER_LONG_NAME_CHARS)]
    public string          szName;
    public TargetInfo      Target;
}
[StructLayout(LayoutKind.Sequential, CharSet=CharSet.Auto)]
struct MIXERCONTROL{
    [StructLayout(LayoutKind.Explicit)]
    public struct BoundsInfo{
        [FieldOffset(0)]
        public int    lMinimum;
        [FieldOffset(4)]
        public int    lMaximum;
        [FieldOffset(0)]
        public uint   dwMinimum;
        [FieldOffset(4)]
        public uint   dwMaximum;
        [FieldOffset(8), MarshalAs(UnmanagedType.ByValArray, SizeConst=4)]
        public uint[] dwReserved;
    }
    [StructLayout(LayoutKind.Explicit)]
    public struct MetricsInfo{
        [FieldOffset(0)]
        public uint   cSteps;
        [FieldOffset(0)]
        public uint   cbCustomData;
        [FieldOffset(4), MarshalAs(UnmanagedType.ByValArray, SizeConst=5)]
        public uint[] dwReserved;
    }

    public uint                     cbStruct;
    public uint                     dwControlID;
    public MIXERCONTROL_CONTROLTYPE dwControlType;
    public uint                     fdwControl;
    public uint                     cMultipleItems;
    [MarshalAs(UnmanagedType.ByValTStr, SizeConst=MIXER_SHORT_NAME_CHARS)]
    public string                   szShortName;
    [MarshalAs(UnmanagedType.ByValTStr, SizeConst=MIXER_LONG_NAME_CHARS)]
    public string                   szName;
    public BoundsInfo               Bounds;
    public MetricsInfo              Metrics;
}
[StructLayout(LayoutKind.Explicit)]
struct MIXERLINECONTROLS{
    [FieldOffset(0)]
    public uint   cbStruct;
    [FieldOffset(4)]
    public uint   dwLineID;
    [FieldOffset(8)]
    public uint   dwControlID;
    [FieldOffset(8)] // not a typo!  overlaps previous field
    public uint   dwControlType;
    [FieldOffset(12)]
    public uint   cControls;
    [FieldOffset(16)]
    public uint   cbmxctrl;
    [FieldOffset(20)]
    public IntPtr pamxctrl;
}
[StructLayout(LayoutKind.Explicit)]
struct MIXERCONTROLDETAILS{
    [FieldOffset(0)]
    public uint   cbStruct;
    [FieldOffset(4)]
    public uint   dwControlID;
    [FieldOffset(8)]
    public uint   cChannels;
    [FieldOffset(12)]
    public IntPtr hwndOwner;
    [FieldOffset(12)] // not a typo!
    public uint   cMultipleItems;
    [FieldOffset(16)]
    public uint   cbDetails;
    [FieldOffset(20)]
    public IntPtr paDetails;
}
[StructLayout(LayoutKind.Sequential)]
struct VOLUME{
    public int left;
    public int right;
}
struct MixerInfo{
    public uint volumeCtl;
    public uint muteCtl;
    public int  minVolume;
    public int  maxVolume;
}

[DllImport("WinMM.dll", CharSet=CharSet.Auto)]
static extern uint mixerGetLineInfo      (IntPtr hmxobj, ref MIXERLINE pmxl, MIXER flags);

[DllImport("WinMM.dll", CharSet=CharSet.Auto)]
static extern uint mixerGetLineControls  (IntPtr hmxobj, ref MIXERLINECONTROLS pmxlc, MIXER flags);

[DllImport("WinMM.dll", CharSet=CharSet.Auto)]
static extern uint mixerGetControlDetails(IntPtr hmxobj, ref MIXERCONTROLDETAILS pmxcd, MIXER flags);

[DllImport("WinMM.dll", CharSet=CharSet.Auto)]
static extern uint mixerSetControlDetails(IntPtr hmxobj, ref MIXERCONTROLDETAILS pmxcd, MIXER flags);

static MixerInfo GetMixerControls(){
    MIXERLINE         mxl = new MIXERLINE();
    MIXERLINECONTROLS mlc = new MIXERLINECONTROLS();
    mxl.cbStruct = (uint)Marshal.SizeOf(typeof(MIXERLINE));
    mlc.cbStruct = (uint)Marshal.SizeOf(typeof(MIXERLINECONTROLS));

    mixerGetLineInfo(IntPtr.Zero, ref mxl, MIXER.OBJECTF_MIXER | MIXER.GETLINEINFOF_DESTINATION);

    mlc.dwLineID  = mxl.dwLineID;
    mlc.cControls = mxl.cControls;
    mlc.cbmxctrl  = (uint)Marshal.SizeOf(typeof(MIXERCONTROL));
    mlc.pamxctrl  = Marshal.AllocHGlobal((int)(mlc.cbmxctrl * mlc.cControls));

    mixerGetLineControls(IntPtr.Zero, ref mlc, MIXER.OBJECTF_MIXER | MIXER.GETLINECONTROLSF_ALL);

    MixerInfo rtn = new MixerInfo();

    for(int i = 0; i < mlc.cControls; i++){
        MIXERCONTROL mxc = (MIXERCONTROL)Marshal.PtrToStructure((IntPtr)((int)mlc.pamxctrl + (int)mlc.cbmxctrl * i), typeof(MIXERCONTROL));
        switch(mxc.dwControlType){
        case MIXERCONTROL_CONTROLTYPE.VOLUME:
            rtn.volumeCtl = mxc.dwControlID;
            rtn.minVolume = mxc.Bounds.lMinimum;
            rtn.maxVolume = mxc.Bounds.lMaximum;
            break;
        case MIXERCONTROL_CONTROLTYPE.MUTE:
            rtn.muteCtl = mxc.dwControlID;
            break;
        }
    }

    Marshal.FreeHGlobal(mlc.pamxctrl);

    return rtn;
}
static VOLUME GetVolume(MixerInfo mi){
    MIXERCONTROLDETAILS mcd = new MIXERCONTROLDETAILS();
    mcd.cbStruct       = (uint)Marshal.SizeOf(typeof(MIXERCONTROLDETAILS));
    mcd.dwControlID    = mi.volumeCtl;
    mcd.cMultipleItems = 0;
    mcd.cChannels      = 2;
    mcd.cbDetails      = (uint)Marshal.SizeOf(typeof(int));
    mcd.paDetails      = Marshal.AllocHGlobal((int)mcd.cbDetails);

    mixerGetControlDetails(IntPtr.Zero, ref mcd, MIXER.GETCONTROLDETAILSF_VALUE | MIXER.OBJECTF_MIXER);

    VOLUME rtn = (VOLUME)Marshal.PtrToStructure(mcd.paDetails, typeof(VOLUME));

    Marshal.FreeHGlobal(mcd.paDetails);

    return rtn;
}
static bool IsMuted(MixerInfo mi){
    MIXERCONTROLDETAILS mcd = new MIXERCONTROLDETAILS();
    mcd.cbStruct       = (uint)Marshal.SizeOf(typeof(MIXERCONTROLDETAILS));
    mcd.dwControlID    = mi.muteCtl;
    mcd.cMultipleItems = 0;
    mcd.cChannels      = 1;
    mcd.cbDetails      = 4;
    mcd.paDetails      = Marshal.AllocHGlobal((int)mcd.cbDetails);

    mixerGetControlDetails(IntPtr.Zero, ref mcd, MIXER.GETCONTROLDETAILSF_VALUE | MIXER.OBJECTF_MIXER);

    int rtn = Marshal.ReadInt32(mcd.paDetails);

    Marshal.FreeHGlobal(mcd.paDetails);

    return rtn != 0;
}
static void AdjustVolume(MixerInfo mi, int delta){
    VOLUME volume = GetVolume(mi);

    if(delta > 0){
        volume.left  = Math.Min(mi.maxVolume, volume.left  + delta);
        volume.right = Math.Min(mi.maxVolume, volume.right + delta);
    }else{
        volume.left  = Math.Max(mi.minVolume, volume.left  + delta);
        volume.right = Math.Max(mi.minVolume, volume.right + delta);
    }

    SetVolume(mi, volume);
}
static void SetVolume(MixerInfo mi, VOLUME volume){
    MIXERCONTROLDETAILS mcd = new MIXERCONTROLDETAILS();
    mcd.cbStruct       = (uint)Marshal.SizeOf(typeof(MIXERCONTROLDETAILS));
    mcd.dwControlID    = mi.volumeCtl;
    mcd.cMultipleItems = 0;
    mcd.cChannels      = 2;
    mcd.cbDetails      = (uint)Marshal.SizeOf(typeof(int));
    mcd.paDetails      = Marshal.AllocHGlobal((int)mcd.cbDetails);

    Marshal.StructureToPtr(volume, mcd.paDetails, false);

    mixerSetControlDetails(IntPtr.Zero, ref mcd, MIXER.GETCONTROLDETAILSF_VALUE | MIXER.OBJECTF_MIXER);

    Marshal.FreeHGlobal(mcd.paDetails);
}
static void SetMute(MixerInfo mi, bool mute){
    MIXERCONTROLDETAILS mcd = new MIXERCONTROLDETAILS();
    mcd.cbStruct       = (uint)Marshal.SizeOf(typeof(MIXERCONTROLDETAILS));
    mcd.dwControlID    = mi.muteCtl;
    mcd.cMultipleItems = 0;
    mcd.cChannels      = 1;
    mcd.cbDetails      = 4;
    mcd.paDetails      = Marshal.AllocHGlobal((int)mcd.cbDetails);

    Marshal.WriteInt32(mcd.paDetails, mute ? 1 : 0);

    mixerSetControlDetails(IntPtr.Zero, ref mcd, MIXER.GETCONTROLDETAILSF_VALUE | MIXER.OBJECTF_MIXER);

    Marshal.FreeHGlobal(mcd.paDetails);
} 
```

这段代码又大又丑。它是一些 C++ 代码的翻译，并且必须定义所有 P/Invoke 的东西，它是更多的代码。但是我已经测试过了，它可以工作。要使用它，您只需要以下内容：

```
MixerInfo mi = GetMixerControls();
AdjustVolume(mi, 100);    // add 100 to the current volume 
```

或者

```
MixerInfo mi = GetMixerControls();
AdjustVolume(mi, (mi.maxVolume - mi.minVolume) / 10);    // increase the volume by 10% of total range 
```

或者

```
MixerInfo mi = GetMixerControls();
SetVolume(mi, mi.maxVolume);    // let's get this party crunk'd! 
```

或者

```
MixerInfo mi = GetMixerControls();
SetMute(mi, true);    // shhhh!!!!!! 
```

**警告**

由于使用了固定大小的整数和字段偏移，这在 64 位 Windows 上可能会失败。我不知道，我没有测试过，也没有足够注意知道这些字段大小是否扩展到 64 位。 *警告代码*

**编辑**

为了简单起见（相对而言），我省略了任何错误处理。你真的应该检查所有mixerXXX函数的返回码，但我会把它作为一个练习留给读者（读作：我懒得这样做）。

* * *

## 回答 #2

> 赞同：6
> 
> 时间：2008-11-16T20:10:16.480

对于主卷（对于 Vista 及更高版本），这将是：

[ISimpleAudioVolume::SetMasterVolume](http://msdn.microsoft.com/en-us/library/ms679141(VS.85).aspx)

如[here](http://www.tech-archive.net/Archive/Development/microsoft.public.win32.programmer.mmedia/2007-01/msg00045.html)所述，您可以参考以下部分：

[Windows Vista 中的核心音频 API](http://msdn.microsoft.com/en-us/library/ms678710.aspx)了解更多信息。

此调用不是媒体基础调用，而是 WASAPI（Windows 音频会话 API）调用：ISimpleAudioVolume::SetMasterVolume（SetMasterVolume 方法设置音频会话的主音量级别。）

然而，这可能很难让 Media Center 的 UI 反映该调用设置的新声音级别，正如该[线程所说明](http://discuss.mediacentersandbox.com/forums/thread/6758.aspx)的那样。

对于 windows Xp，您可以研究这个[脚本](http://www.vbfrance.com/codes/AUGMENTER-BAISSER-VOLUME-WAVE-BALANCE_498.aspx)，也可以研究[这个其他脚本](http://www.tech-archive.net/Archive/VB/microsoft.public.vb.winapi/2005-07/msg00218.html)。
[音频库](http://www.codeproject.com/KB/audio-video/AudioLib.aspx)也可能很有趣。

还有一个旧的[音频项目](http://www.codeguru.com/cpp/g-m/multimedia/article.php/c1575/)，它有一个主音量部分：

```
BOOL CVolumeDlg::amdInitialize()
{
    ASSERT(m_hMixer == NULL);

    // get the number of mixer devices present in the system
    m_nNumMixers = ::mixerGetNumDevs();

    m_hMixer = NULL;
    ::ZeroMemory(&m_mxcaps, sizeof(MIXERCAPS));

    m_strDstLineName.Empty();
    m_strVolumeControlName.Empty();
    m_dwMinimum = 0;
    m_dwMaximum = 0;
    m_dwVolumeControlID = 0;

    // open the first mixer
    // A "mapper" for audio mixer devices does not currently exist.
    if (m_nNumMixers != 0)
    {
        if (::mixerOpen(&m_hMixer,
                        0,
                        reinterpret_cast<DWORD>(this->GetSafeHwnd()),
                        NULL,
                        MIXER_OBJECTF_MIXER | CALLBACK_WINDOW)
            != MMSYSERR_NOERROR)
        {
            return FALSE;
        }

        if (::mixerGetDevCaps(reinterpret_cast<UINT>(m_hMixer),
                              &m_mxcaps, sizeof(MIXERCAPS))
            != MMSYSERR_NOERROR)
        {
            return FALSE;
        }
    }

    return TRUE;
}

BOOL CVolumeDlg::amdUninitialize()
{
    BOOL bSucc = TRUE;

    if (m_hMixer != NULL)
    {
        bSucc = (::mixerClose(m_hMixer) == MMSYSERR_NOERROR);
        m_hMixer = NULL;
    }

    return bSucc;
}

BOOL CVolumeDlg::amdGetMasterVolumeControl()
{
    if (m_hMixer == NULL)
    {
        return FALSE;
    }

    // get dwLineID
    MIXERLINE mxl;
    mxl.cbStruct = sizeof(MIXERLINE);
    mxl.dwComponentType = MIXERLINE_COMPONENTTYPE_DST_SPEAKERS;
    if (::mixerGetLineInfo(reinterpret_cast<HMIXEROBJ>(m_hMixer),
                           &mxl,
                           MIXER_OBJECTF_HMIXER |
                           MIXER_GETLINEINFOF_COMPONENTTYPE)
        != MMSYSERR_NOERROR)
    {
        return FALSE;
    }

    // get dwControlID
    MIXERCONTROL mxc;
    MIXERLINECONTROLS mxlc;
    mxlc.cbStruct = sizeof(MIXERLINECONTROLS);
    mxlc.dwLineID = mxl.dwLineID;
    mxlc.dwControlType = MIXERCONTROL_CONTROLTYPE_VOLUME;
    mxlc.cControls = 1;
    mxlc.cbmxctrl = sizeof(MIXERCONTROL);
    mxlc.pamxctrl = &mxc;
    if (::mixerGetLineControls(reinterpret_cast<HMIXEROBJ>(m_hMixer),
                               &mxlc,
                               MIXER_OBJECTF_HMIXER |
                               MIXER_GETLINECONTROLSF_ONEBYTYPE)
        != MMSYSERR_NOERROR)
    {
        return FALSE;
    }

    // store dwControlID
    m_strDstLineName = mxl.szName;
    m_strVolumeControlName = mxc.szName;
    m_dwMinimum = mxc.Bounds.dwMinimum;
    m_dwMaximum = mxc.Bounds.dwMaximum;
    m_dwVolumeControlID = mxc.dwControlID;

    return TRUE;
}

BOOL CVolumeDlg::amdGetMasterVolumeValue(DWORD &dwVal) const
{
    if (m_hMixer == NULL)
    {
        return FALSE;
    }

    MIXERCONTROLDETAILS_UNSIGNED mxcdVolume;
    MIXERCONTROLDETAILS mxcd;
    mxcd.cbStruct = sizeof(MIXERCONTROLDETAILS);
    mxcd.dwControlID = m_dwVolumeControlID;
    mxcd.cChannels = 1;
    mxcd.cMultipleItems = 0;
    mxcd.cbDetails = sizeof(MIXERCONTROLDETAILS_UNSIGNED);
    mxcd.paDetails = &mxcdVolume;
    if (::mixerGetControlDetails(reinterpret_cast<HMIXEROBJ>(m_hMixer),
                                 &mxcd,
                                 MIXER_OBJECTF_HMIXER |
                                 MIXER_GETCONTROLDETAILSF_VALUE)
        != MMSYSERR_NOERROR)
    {
        return FALSE;
    }

    dwVal = mxcdVolume.dwValue;

    return TRUE;
}

BOOL CVolumeDlg::amdSetMasterVolumeValue(DWORD dwVal) const
{
    if (m_hMixer == NULL)
    {
        return FALSE;
    }

    MIXERCONTROLDETAILS_UNSIGNED mxcdVolume = { dwVal };
    MIXERCONTROLDETAILS mxcd;
    mxcd.cbStruct = sizeof(MIXERCONTROLDETAILS);
    mxcd.dwControlID = m_dwVolumeControlID;
    mxcd.cChannels = 1;
    mxcd.cMultipleItems = 0;
    mxcd.cbDetails = sizeof(MIXERCONTROLDETAILS_UNSIGNED);
    mxcd.paDetails = &mxcdVolume;
    if (::mixerSetControlDetails(reinterpret_cast<HMIXEROBJ>(m_hMixer),
                                 &mxcd,
                                 MIXER_OBJECTF_HMIXER |
                                 MIXER_SETCONTROLDETAILSF_VALUE)
        != MMSYSERR_NOERROR)
    {
        return FALSE;
    }

    return TRUE;
} 
```

* * *

## 回答 #3

> 赞同：-1
> 
> 时间：2016-10-18T22:20:01.390

使用这个免费的库，它很简单并且可以完成工作。 [输入模拟器](https://inputsimulator.codeplex.com/)

它模拟按键。您只需要添加此引用并调用任何您想要的静态方法，如下所示：

```
 InputSimulator.SimulateKeyPress(VirtualKeyCode.VOLUME_UP);

  InputSimulator.SimulateKeyPress(VirtualKeyCode.VOLUME_DOWN);

  InputSimulator.SimulateKeyPress(VirtualKeyCode.VOLUME_MUTE); 
```

然后，如果您想获得主 vokume 级别，请执行以下操作：

```
 // volume update
  MMDevice defaultDevice = new MMDeviceEnumerator()
        .GetDefaultAudioEndpoint(DataFlow.Render‌​, Role.Multimedia);
  // veloce attesa per l'aggiornamento del volume
  Thread.Sleep(100);
  float level = defaultDevice.AudioEndpointVolume.MasterVolumeLevelScalar; 
```

这样做你将把当前音量调整为 0-1 格式（例如 52% 是 0.52）如果你想把它调整为 0-100 格式，只需执行 level*100

# design-patterns - 关于设计松散耦合的完整系统的建议？

> ID：294295
> 
> 赞同：3
> 
> 时间：2008-11-16T19:52:35.470
> 
> 标签：design-patterns, architecture, distributed, coupling

如何设计松散耦合的系统，这些系统可能经常需要来自彼此的数据，但不一定属于同一类别？

例如，让旧的 Pet-shop 示例更进一步，并创建一个 pet-store 特许经营权。每个宠物商店都有自己的网站，列出他们的联系信息、促销活动和当前库存。

特许经营所有者希望拥有所有特许宠物商店的列表以及联系信息，可能还有一些照片可以在他们的公司网站上找到。他们希望能够更新此信息，并让任何更新都自动双向推送。他们还希望以自动方式向所有商店的站点提供促销信息。

因此，在这种情况下，库存清单由商店“拥有”，联系信息由两个实体部分“拥有”，促销信息由总部“拥有”。由于任意原因，所有这些数据都不能存储在同一个地方。

是否有一些最佳实践或通用策略来应对这种情况？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2008-11-16T20:05:35.943

我的理解是，这类问题最常使用一种称为“数据联合”的技术来解决——独立实体独立运作，但存在一个伞状实体，可以将系统视为一个整体。

这是一篇可能有用的文章：http: [//www.soamag.com/I22/0908-1.asp](http://www.soamag.com/I22/0908-1.asp)

在规划您的架构时，请记住当其中一位参与者不可用时会发生什么。例如，我建议将促销信息复制到所有商店，或者作为批处理，或者在参考数据更改时。这样，如果网络出现故障，各个商店仍然有促销信息并且可以正常运行。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2008-11-16T20:49:22.500

我一直在思考这个问题，我通过说类之间的关系是由上下文决定的来表达它。任何假设类之间的全局静态关联（内在耦合）的模型都是有问题的。

我喜欢使用的另一个例子是产品。

一个产品可以扮演很多不同的角色。它与 OrderItem 相关联，OrderItem 与 Order 相关联，而 Order 又与 Customer 相关联。

它由供应商提供。

它在目录中，可能按部分和页面。

这是买方的责任，可从多个供应商处获得。

轻松处理这种复杂性的能力是关系数据模型的根本优势；而且我还没有看到它在 OOP 方面得到了很好的处理。

另外：还有另一个 ORM（对象角色建模，请参阅 VisioModeler、InfoModeler 等）从关系方面看问题，非常有用（恕我直言）。

当您将自己与数据库的关系隔离（通过使用 CRUD 生成器、ActiveRecords 等）时，您就隐藏了这一重要方面。（我认为 LINQ 也有同样的问题，以及引入了基本的耦合问题，但我还没有完全解决。）

我认为如果你小心的话，你可以成功地完成它，但是在设计中嵌入耦合变得很容易，特别是如果你从数据库工作回到应用程序的其余部分，而不是另一个方向。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2008-11-27T13:14:30.277

在这种情况下，SOA 似乎很有帮助。我特别指的是业务级 SOA，如[Bill Poole](http://bill-poole.blogspot.com/)和[Udi Dahan](http://www.udidahan.com/)所描述的，具有基于 pub-sub 异步事件的实现。

您描述了具有不同所有者的几个业务功能：特许经营和销售。您希望实现它们之间的松散耦合。

在 SOA 中，您定义特许经营服务和多个销售服务实例，每个商店一个。商店最初非常相似，但可以单独发展。

然后，您定义在这些服务中发生的共同感兴趣的业务事件。特许服务可以发布所有销售服务订阅的 NewPromotion 事件。此事件消息包含有关促销的所有详细信息，消费者可以选择他们需要的内容。销售服务依次发布 ContactDetailsChanged 事件以供特许经营使用。

每个服务在内部都有自己的多层实现，包括数据库、面向客户的网站、与其他系统的私有集成点等。

每个服务都以它认为合适的形式私下存储它感兴趣的所有数据：库存清单、联系信息、促销信息。一个服务中的信息更新通过事件传播到其他服务。

在实现方面，您需要某种服务之间的服务总线，支持通过不可靠的互联网进行持久消息传递，例如[NServiceBus](http://www.nservicebus.com/)。不需要 WebServices(tm)。

您的服务在实现中是松耦合的，因为它们只共享合同（对它们发布的消息和端点的描述）并且可以独立地发展内部表示。它们在时间上也是松散耦合的，因为如果它们在任何时候都不会相互发送可能通过互联网超时的同步请求。所有消息传递都由基础设施（服务总线）处理。

希望这可以帮助 ：）

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2008-12-08T04:30:28.893

我大多同意上述提出的解决方案（使用 SOA）。根据应用程序的复杂性，ESB 可能是一种很好的方法。但是，我认为 ESB 占用空间很大，并为大多数实际应用程序带来了不必要的复杂性。

但是，恕我直言，任何好的架构都应该很容易适应应用程序服务器，而无需进行重大的架构/设计更改。

假设一个基于 Java 的中大型 n 层应用程序，以下是我对中间层和 EIS 层的建议：

1.  分离每个 subSystem 实现并通过服务接口公开其功能，并隐藏直接使用或引用的实现。

2.  为每个子系统创建一个 JAR（或 EAR）文件，并确定上述子系统/JAR 之间的运行时和编译时依赖关系。

3.  花费大量时间来确定服务接口方法和子系统依赖项的正确粒度。

4.  在此过程中，尝试识别每个模块的 DAO 层（假设涉及 DB），并为每个子系统分离数据库表。

对于 web 层，尝试通过子系统划分表示层来执行与上述相同的操作。为每个子系统创建一个 WAR 文件。如有必要，请尝试将表示层 WAR 放入上面确定的适当 EAR 文件中。

对上述架构的一个很好的验证是在 OSGi 中使用每个服务作为 OSGi 服务来部署它（在创建适当的清单文件之后）。

请记住，如有必要，也可以在任何这些子系统之间设置基于事件的/异步通信。

这提供了拆分子系统并将它们部署在不同的服务器场中的机会，以获得更好的可扩展性机会。

祝你好运..！

# javascript - Gzip 的 JavaScript 实现

> ID：294297
> 
> 赞同：211
> 
> 时间：2008-11-16T19:54:38.337
> 
> 标签：javascript, ajax, compression, gzip

我正在编写一个 Web 应用程序，它需要通过 AJAX 将 JSON 数据存储在一个小的、固定大小的服务器端缓存中（想想：[Opensocial quotas](http://code.google.com/apis/opensocial/articles/persistence-0.8.html#restrictions-quotas)）。我无法控制服务器。

我需要减少存储数据的大小以保持在服务器端配额内，并希望能够在浏览器中对字符串化的 JSON 进行 gzip 压缩，然后再将其发送到服务器。

但是，我在 Gzip 的 JavaScript 实现方式中找不到太多。关于在发送之前如何在客户端压缩数据的任何建议？

* * *

## 回答 #1

> 赞同：145
> 
> 时间：2008-11-16T21:29:12.967

**Edit** There appears to be a better LZW solution that handles Unicode strings correctly at [http://pieroxy.net/blog/pages/lz-string/index.html](http://pieroxy.net/blog/pages/lz-string/index.html) (Thanks to pieroxy in the comments).

* * *

I don't know of any gzip implementations, but the [jsolait library](http://jsolait.net/) (the site seems to have gone away) has functions for LZW compression/decompression. The code is covered under the [LGPL](http://www.gnu.org/licenses/lgpl.txt).

```
// LZW-compress a string
function lzw_encode(s) {
    var dict = {};
    var data = (s + "").split("");
    var out = [];
    var currChar;
    var phrase = data[0];
    var code = 256;
    for (var i=1; i<data.length; i++) {
        currChar=data[i];
        if (dict[phrase + currChar] != null) {
            phrase += currChar;
        }
        else {
            out.push(phrase.length > 1 ? dict[phrase] : phrase.charCodeAt(0));
            dict[phrase + currChar] = code;
            code++;
            phrase=currChar;
        }
    }
    out.push(phrase.length > 1 ? dict[phrase] : phrase.charCodeAt(0));
    for (var i=0; i<out.length; i++) {
        out[i] = String.fromCharCode(out[i]);
    }
    return out.join("");
}

// Decompress an LZW-encoded string
function lzw_decode(s) {
    var dict = {};
    var data = (s + "").split("");
    var currChar = data[0];
    var oldPhrase = currChar;
    var out = [currChar];
    var code = 256;
    var phrase;
    for (var i=1; i<data.length; i++) {
        var currCode = data[i].charCodeAt(0);
        if (currCode < 256) {
            phrase = data[i];
        }
        else {
           phrase = dict[currCode] ? dict[currCode] : (oldPhrase + currChar);
        }
        out.push(phrase);
        currChar = phrase.charAt(0);
        dict[code] = oldPhrase + currChar;
        code++;
        oldPhrase = phrase;
    }
    return out.join("");
} 
```

* * *

## 回答 #2

> 赞同：59
> 
> 时间：2011-04-12T09:32:58.747

我遇到了另一个问题，我不想在 gzip 中编码数据，而是要**解码 gzipped data**。我在浏览器之外运行 javascript 代码，所以我需要使用*纯*javascript 对其进行解码。

我花了一些时间，但我发现在**JSXGraph**库中有一种读取 gzip 压缩数据的方法。

这是我找到图书馆的地方：http: [//jsxgraph.uni-bayreuth.de/wp/2009/09/29/jsxcompressor-zlib-compressed-javascript-code/](http://jsxgraph.uni-bayreuth.de/wp/2009/09/29/jsxcompressor-zlib-compressed-javascript-code/) 甚至还有一个独立的实用程序可以做到这一点，**JSXCompressor**，并且代码已获得 LGPL 许可。

只需在项目中包含 jsxcompressor.js 文件，然后您就可以读取 base 64 编码的 gzip 数据：

```
<!doctype html>
</head>
<title>Test gzip decompression page</title>
<script src="jsxcompressor.js"></script>
</head>
<body>
<script>
    document.write(JXG.decompress('<?php 
        echo base64_encode(gzencode("Try not. Do, or do not. There is no try.")); 
    ?>'));
</script>
</html> 
```

我知道这不是您想要的，但我仍然在这里回复，因为我怀疑它会对某些人有所帮助。

* * *

## 回答 #3

> 赞同：41
> 
> 时间：2014-03-15T19:41:59.673

我们刚刚发布了 pako [https://github.com/nodeca/pako，zlib](https://github.com/nodeca/pako)到 javascript 的端口。我认为这是现在deflate / inflate / gzip / ungzip最快的js实现。此外，它拥有民主的麻省理工学院执照。Pako 支持所有 zlib 选项，其结果是二进制相等的。

例子：

```
var inflate = require('pako/lib/inflate').inflate; 
var text = inflate(zipped, {to: 'string'}); 
```

* * *

## 回答 #4

> 赞同：17
> 
> 时间：2010-09-06T16:14:22.020

我将 LZMA 的实现从 GWT 模块移植到独立的 JavaScript 中。它被称为[LZMA-JS](https://lzma-js.github.io/LZMA-JS/)。

* * *

## 回答 #5

> 赞同：14
> 
> 时间：2009-09-15T17:13:16.160

以下是用 Javascript 实现的其他一些压缩算法：

*   [霍夫曼](http://rumkin.com/tools/compression/compress_huff.php)
*   [LZ77](http://github.com/olle/lz77-kit/blob/master/src/main/js/lz77.js)

* * *

## 回答 #6

> 赞同：8
> 
> 时间：2010-08-16T14:51:45.977

我没有测试，但是有一个 ZIP 的 javascript 实现，称为 JSZip：

[https://stuk.github.io/jszip/](https://stuk.github.io/jszip/)

* * *

## 回答 #7

> 赞同：0
> 
> 时间：2008-11-16T20:34:29.097

I guess a generic client-side JavaScript compression implementation would be a very expensive operation in terms of processing time as opposed to transfer time of a few more HTTP packets with uncompressed payload.

Have you done any testing that would give you an idea how much time there is to save? I mean, bandwidth savings can't be what you're after, or can it?

* * *

## 回答 #8

> 赞同：-4
> 
> 时间：2008-11-16T20:04:06.663

大多数浏览器都可以即时解压缩 gzip。这可能是比 javascript 实现更好的选择。

* * *

## 回答 #9

> 赞同：-5
> 
> 时间：2008-11-16T20:51:36.007

You can use a 1 pixel per 1 pixel Java applet embedded in the page and use that for compression.

It's not JavaScript and the clients will need a Java runtime but it will do what you need.

# asp.net - ASP.NET Ajax ErrorSys.WebForms.PageRequestManagerServerErrorException：处理服务器上的请求时发生未知错误

> ID：294299
> 
> 赞同：3
> 
> 时间：2008-11-16T19:57:03.930
> 
> 标签：asp.net, ajax

我在 Visual Studio 中创建了一个 Ajax 网站，添加了一个带有文本框和按钮的简单页面，当我在一切正常后单击按钮时，当我单击它两次时出现错误

Sys.WebForms.PageRequestManagerServerErrorException：处理服务器上的请求时发生未知错误。服务器返回的状态码是：500

这是我的页面

```
<form id="form1" runat="server">
    <asp:ScriptManager ID="ScriptManager1" runat="server" />
    <div>
        <asp:UpdatePanel ID="UpdatePanel1" runat="server">
            <ContentTemplate>
                <asp:TextBox ID="TextBox1" runat="server"></asp:TextBox>
                <asp:Button ID="Button1" runat="server" Text="Button" OnClick="Button1_Click" />
            </ContentTemplate>
        </asp:UpdatePanel>
    </div>
</form> 
```

```
        Protected Sub Button1_Click(ByVal sender As Object, ByVal e As System.EventArgs)
        TextBox1.Text = "aaa"
    结束子

```

编辑〜我在更新面板之外的页面上添加了第二个按钮，当我单击更新面板内的按钮，然后单击面板外的按钮时，我得到了错误

无法打开登录请求的数据库“ASPState”。登录失败。用户“服务器\用户”登录失败。说明：执行当前 Web 请求期间发生未处理的异常。请查看堆栈跟踪以获取有关错误及其源自代码的位置的更多信息。

异常详细信息：System.Data.SqlClient.SqlException：无法打开登录请求的数据库“ASPState”。登录失败。用户“服务器\用户”登录失败。

为什么是这样？

编辑〜为了解决我的问题，我做了

```
<sessionState mode="StateServer"
stateConnectionString="tcpip=localhost:42424"
cookieless="false"
timeout="20"/> 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2008-11-16T20:07:12.133

你试过了吗： [http ://forums.asp.net/t/1044963.aspx](http://forums.asp.net/t/1044963.aspx)

另外，尝试删除该`TextBox1.Text = "aaa"`行，看看是否仍然出现错误。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2008-11-16T22:33:23.273

看起来您的问题是您的会话状态被配置为使用 SQL 服务器，并且您将其更改为状态服务器服务以使其正常工作。您是否也尝试过 InProc 会话状态？

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-10-28T13:49:23.090

在 Web.config 添加这个

```
validateRequest="false" enableEventValidation="false" 
```

到页面部分

# php - 在 php 中解压一组参数

> ID：294313
> 
> 赞同：33
> 
> 时间：2008-11-16T20:05:42.540
> 
> 标签：php, python, arguments, iterable-unpacking

Python 提供了 "*" 运算符来解包元组列表并将它们作为参数提供给函数，如下所示：

```
args = [3, 6]
range(*args)            # call with arguments unpacked from a list 
```

这相当于：

```
range(3, 6) 
```

有谁知道是否有办法在 PHP 中实现这一点？一些“PHP Unpack”变体的谷歌搜索并没有立即出现任何东西......也许它在PHP中被称为不同的东西？

* * *

## 回答 #1

> 赞同：36
> 
> 时间：2014-04-19T00:14:26.537

在参数中添加了通过[（splat 运算符）](http://docs.php.net/manual/en/migration56.new-features.php#migration56.new-features.splat)`php5.6` [解包`...`](http://docs.php.net/manual/en/migration56.new-features.php#migration56.new-features.splat)。使用它，您可以摆脱`call_user_func_array()`这种更简单的替代方案。例如有一个功能：

```
function add($a, $b){
  return $a + $b;
} 
```

使用你的数组`$list = [4, 6];`（在 php5.5 之后你可以用这种方式声明数组）。

您可以使用以下命令调用您的函数`...`：

```
echo add(...$list); 
```

* * *

## 回答 #2

> 赞同：22
> 
> 时间：2008-11-16T20:08:30.617

您可以使用它[`call_user_func_array()`](http://www.php.net/call_user_func_array)来实现：

`call_user_func_array("range", $args);`用你的例子。

* * *

## 回答 #3

> 赞同：6
> 
> 时间：2015-09-04T15:22:57.007

在某些情况下，您可能会考虑使用`unpacking`php 中的 php 类似于 python 的方式：

```
list($min, $max) = [3, 6];
range($min, $max); 
```

至少我是这样得出这个答案的。谷歌搜索：`PHP argument unpacking`

* * *

## 回答 #4

> 赞同：4
> 
> 时间：2008-11-16T20:15:01.010

你应该使用 call_user_func_array

```
call_user_func_array(array(CLASS, METHOD), array(arg1, arg2, ....)) 
```

[http://www.php.net/call_user_func_array](http://www.php.net/call_user_func_array)

或使用反射 api [http://www.php.net/oop5.reflection](http://www.php.net/oop5.reflection)

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2019-10-08T12:52:45.327

```
<?php

function add(int ...$arr) {           // typehint ready
    return array_sum($arr);
}

var_dump(add(1, 2, 3, ...[1, 2, 3])); // int(12) 
```

... - 运算符的另一个示例。
RFC：[https ://wiki.php.net/rfc/variadics](https://wiki.php.net/rfc/variadics)

# javascript - How to get the mouse button pressed from a command event in XUL?

> ID：294340
> 
> 赞同：0
> 
> 时间：2008-11-16T20:17:37.337
> 
> 标签：javascript, xul

It seems that the XUL *command* and *click* events are somewhat different.

Although my function does get called when using the *command* event, the event object does not contain the *button* property.

My question is: **how do I detect what mouse button that was pressed without using the *click* event?**

The simplest code that can demonstrate my problem:

```
<?xml version="1.0"?>
<?xml-stylesheet href="chrome://global/skin/" type="text/css"?>

<window id="yourwindow" xmlns="http://www.mozilla.org/keymaster/gatekeeper/there.is.only.xul">
<script language="JavaScript">
    var showMeTheButton=function(e)
    {
        alert(e.button);
    }
</script>
<button onclick="showMeTheButton(event)" label="Click me with onclick"></button>
<button oncommand="showMeTheButton(event)" label="Click me with oncommand"></button>
</window> 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2008-11-16T23:00:21.377

要记住的主要事情是，`oncommand`任何导致按钮激活的操作都会触发它，包括在按钮获得焦点时按下空格键，使用附加到按钮的键盘快捷键，或单击按钮鼠标。事件处理程序并不真正应该关心它是如何被调用的，只关心它是如何被调用的。（我想这是一个有意识的决定，以保持一致的用户界面。）

导致按钮属性添加到 Event 对象的唯一操作是 `onclick`、`ondblclick`、`onmousedown`和`onmouseup`。您会注意到，即使您禁用了`onclick`按钮，事件仍然会触发，而`oncommand`不会触发。

要获得与 相同的功能`oncommand`，您需要自己处理`onclick`和`onkeydown`事件，同时确保按钮仍处于启用状态。您还可以使用 XBL 创建一个自定义按钮，该按钮具有自定义事件`onleftclick`，如果未设置`onmiddleclick`则回退到`oncommand`- 但我没有尝试过。

# delphi - 计算 TDbGrid 中的行数

> ID：294342
> 
> 赞同：8
> 
> 时间：2008-11-16T20:20:20.017
> 
> 标签：delphi, datagrid

我有一个 TDbGrid，我可以在运行时使用 FieldCount 属性轻松判断其中有多少列，但似乎没有相应的 RowCount 属性来显示正在显示的记录数。我怎样才能找到这个？

* * *

## 回答 #1

> 赞同：13
> 
> 时间：2008-11-16T20:47:36.200

`RowCount`和都是`VisibleRowCount`受保护的属性`TCustomGrid`，不会暴露在`TDBGrid`. 但是您可以通过以下方式解决这个问题：

```
type
  TDummyGrid = class(TDBGrid);

  RowCount := TDummyGrid(MyDBGrid).RowCount;
  VisibleRowCount := TDummyGrid(MyDBGrid).VisibleRowCount; 
```

请注意，这包括标题。

* * *

## 回答 #2

> 赞同：9
> 
> 时间：2008-11-16T20:24:32.237

你可以试试：

```
DBGrid1.DataSource.DataSet.RecordCount 
```

也许有更好的解决方案。但这对我有用。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2010-07-01T07:59:42.487

我会用

```
TDbGrid.ApproxCount 
```

# c++ - Read (and write) RTF files with C++ / Qt

> ID：294343
> 
> 赞同：16
> 
> 时间：2008-11-16T20:21:37.797
> 
> 标签：c++, qt, parsing, rtf

I am looking for a simple C++ library for tokenizing and parsing RTF (Rich Text Format) files. I am planning to edit them with Qt's QTextEdit.

More the Formatting preserved the better -- but actually I am planning to use Bold and Italics only.

In perl I would use [RTF::Tokenizer](http://search.cpan.org/%7Esargie/RTF-Tokenizer-1.10/lib/RTF/Tokenizer.pm).

It would be nice if the module had some sort of interface for writing also, but I am able to brute force that with a template and some regular expressions.

* * *

## 回答 #1

> 赞同：11
> 
> 时间：2009-03-11T09:23:36.940

我帮助在 KOffice 中编写了 RTF 导入导出过滤器。您可以在[https://cgit.kde.org/koffice.git/tree/filters/kword/rtf](https://cgit.kde.org/koffice.git/tree/filters/kword/rtf)查看代码。代码是模块化的，它只依赖于 Qt。

* * *

## 回答 #2

> 赞同：6
> 
> 时间：2008-11-16T20:51:22.667

A quick SourceForge search suggests [librtf](http://www.sf.net/projects/librtf). It hasn't been developed in a while, but is listed as stable and is under the LGPL. I don't know whether it will support what you need, but I always suggest searching SourceForge for libraries.

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2008-11-17T02:06:22.843

你可以在irc上问那些`#koffice`家伙。`irc.freenode.org`他们的程序`kword`能够打开 RTF 文件，而且确实也是用 Qt 编写的。我相信他们会很乐意告诉你他们是如何做到的。

# javascript - 创建使用显示/隐藏图层和 Z-Index 更改页面内容的下拉菜单

> ID：294349
> 
> 赞同：1
> 
> 时间：2008-11-16T20:26:28.957
> 
> 标签：javascript, z-index, data-layers, drop-down-menu

我正在尝试为一个站点创建一个侧边栏，允许用户从下拉菜单中选择一个项目并显示一个 RSS 提要。提要会根据从列表中选择的项目而改变。我不知道如何实现这一点，但我的第一个想法是使用 z-index 和显示/隐藏图层。我有一层和菜单设置，但它不会让我在选择不同的菜单项时更改显示的馈送。有谁知道我怎么能做到这一点？

我对到目前为止所做的事情进行了实时预览。它位于[CHUD](http://www.chud.com/articles/templates/chud/new_sidebarhome.php)网站上，

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2008-11-16T21:36:09.393

这使用 jQuery 和 jFeed 插件根据下拉选择替换 DIV 的内容。

```
// load first feed on document load
$(document).ready(
    function() {
       load_feed( $('select#feedSelect')[0], 'feedDiv' ) ); // pick first
    }
);

function load_feed( ctl, contentArea )  // load based on select
{
   var content = $('#' + contentArea )[0]; //pick first

   content.html( 'Loading feed, please wait...' );

   var feedUrl = ctl.options[ctl.selectedIndex].value;

   $.getFeed( { url: feedUrl,
        function(feed) {
           content.html( '' );
           content.append( '<h1>' + feed.title + '</h1>' );
           feed.items.each( 
              function(i,item) {
                  content.append( '<h2><a href="'
                                     + item.link
                                     + '">' 
                                     + feed.title
                                     + '</a></h2>' );
                  content.append( '<p>' + feed.description + '</p>' );
              }
           );
         }
     });
 } 
```

HTML

```
<div>
   <select id=feedSelect onchange="load_feed(this,'feedDiv');" >
      <option value='url-to-first-feed' text='First Feed' selected=true />
      <option value='url-to-second-feed' text='Second Feed' />
      ...
   </select>
   <div id='feedDiv'>
   </div>
</div> 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2008-11-16T23:04:19.170

这并不完全相同，但这使用了简单的 CSS 和 HTML，并且不需要 Javascript。一点逆向工程可以走很长的路。

[Image_switcher](http://www.gigadesign.be/images/tutorials/image_switcher/)

它是荷兰语，但很简单：将鼠标移到`<a>`零件上，图像就会切换。

纯 CSS+HTML，没有 Javascript

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2008-11-16T22:59:07.730

你有两个选择：

1.  预加载所有 rss 提要（我假设您`<ul>`的示例页面中的 's 是您的 RSS 提要的 HTML 输出？），在您的文档加载时将它们全部隐藏，然后将它们显示为选中

2.  当您的选择框更改时，使用 AJAX 动态获取选定的提要信息。

这是执行前者的 javascript 和 jQuery 版本的快速示例：

html:

```
<select id="showRss">
   <option name="feed1">Feed 1</option>
   <option name="feed2">Feed 2</option>
</select>

<div id="rssContainer">
   <ul id="feed1">
      <li>feed item 1</li>
      <li>...</li>
   </ul>
   <ul id="feed2">
      <li>feed item 2</li>
      <li>...</li>
   </ul>
   <!-- etc... -->
</div> 
```

javascript:

```
var rss = document.getElementById('rssContainer'); // main container
var nodes = rss.getElementsByTagName('ul');        // collection of ul nodes
var select = document.getElementById('showRss');   // your select box

function hideAll()  {                              // hide all ul's
    for (i = 0; i < nodes.length; ++i)  {
        nodes[i].style.display = 'none';
    }
}

select.onchange = function()    {                  // use the 'name' of each
    hideAll();                                     // option as the id of the ul
    var e = this[this.selectedIndex].getAttribute('name');
    var show = document.getElementById(e);         // to show when selected
    show.style.display = 'block';
}

hideAll(); 
```

jQuery：

```
$('#showRss').change(function() {
    $('#rssContainer ul').hide('slow');            // added a bit of animation
    var e = '#' + $(':selected', $(this)).attr('name');
    $(e).show('slow');                             // while we change the feed
});

$('#rssContainer ul').hide(); 
```

要执行选项 2，您的`onchange`函数将处理 AJAX 加载。如果您对 AJAX 不太熟悉，并且有一些提要，那么选项 1 可能是最简单的。（再次，我假设您已经将 RSS 解析为 HTML，因为这完全是另一个主题）。

# php - PHP YAML Parsers

> ID：294355
> 
> 赞同：105
> 
> 时间：2008-11-16T20:31:31.520
> 
> 标签：php, parsing, yaml

Does anyone know of a good YAML Parser for PHP? If so, what are the pros and cons of this library?

* * *

## 回答 #1

> 赞同：144
> 
> 时间：2010-09-11T16:17:03.080

> **最后更新时间**：2017 年 7 月 26 日

以下是 PHP 中 YAML 状态的总结：

*   C 库的包装器：如果您需要绝对速度，您可能会想要这些：
    *   [php-yaml](https://pecl.php.net/package/yaml) : [LibYAML](http://pyyaml.org/wiki/LibYAML)的包装器。可作为 PECL 扩展使用；它也是[PHP 文档](http://php.net/manual/en/book.yaml.php)中的一个。
    *   [syck](https://pecl.php.net/package/syck) : 绑定到 syck; 也可作为 PECL 扩展。（日期，见下文）

*   纯 PHP 实现：

    *   [sfYaml](http://symfony.com/doc/current/components/yaml.html) : Symfony 的 YAML 组件。[您可以在此处](http://fabien.potencier.org/article/40/the-state-of-yaml-in-php)查看其作者的动机。他想要“*易于使用、快速、经过单元测试并且有清晰的错误信息*”的东西。
    *   [spyc](https://github.com/mustangostang/spyc)：没有依赖项的 YAML 解析器

在撰写本文时，上述库的最新版本发布日期和它们支持的[YAML 规范](http://www.yaml.org/)版本（1.2 是最新版本）是：

```
php-yaml   1.3.0     2016-09-24     YAML 1.1  [PHP 5]
php-yaml   2.0.0     2016-09-24     YAML 1.1  [PHP 7]
syck       0.9.3     2008-11-18     YAML 1.0
sfYaml     3.3.5     2017-06-15     YAML 1.1, most of 1.2
spyc       0.6.2     2017-02-24     YAML 1.1 
```

* * *

## 回答 #2

> 赞同：50
> 
> 时间：2009-05-12T18:50:10.700

间谍：[https ://github.com/mustangostang/spyc](https://github.com/mustangostang/spyc)

纯PHP实现，无需对服务器进行任何修改即可安装。如果速度是一个可怕的问题，它可能不是理想的解决方案，但如果你使用 YAML 进行配置或相对低容量的使用，它是一个很棒的解决方案。

给定一个 YAML 文档，Spyc 将返回一个数组，您可以随意使用它。

```
require_once "spyc.php";
$data = Spyc::YAMLLoad($myfile); 
```

给定一个数组，Spyc 将返回一个字符串，其中包含从您的数据构建的 YAML 文档。

```
$yaml_str = Spyc::YAMLDump($myarray); 
```

* * *

## 回答 #3

> 赞同：16
> 
> 时间：2008-11-16T21:37:43.527

The [symfony framework](http://www.symfony-project.org) makes very heavy use of YAML, this [blog post by Grégoire Hubert](http://www.symfony-project.org/blog/2008/06/19/yaml-in-symfony-1-1) demonstrates using their YAML library in a non-symfony project.

* * *

## 回答 #4

> 赞同：7
> 
> 时间：2012-05-01T20:56:33.867

Symfony2 有一个 YAML 组件，它支持*大部分*YAML 1.2 规范

[https://github.com/symfony/Yaml](https://github.com/symfony/Yaml)

* * *

## 回答 #5

> 赞同：3
> 
> 时间：2010-01-25T20:50:31.417

如果您在项目中使用大量 YAML，您可能会发现像 spyc 或 Symfony YAML 这样的纯 PHP 库不够快。C YAML 解析器至少有两个 PHP 绑定：

*   [yaml](http://pecl.php.net/package/yaml/) - LibYAML YAML 1.1 解析器库的包装器
*   [syck](http://pecl.php.net/package/syck/) - Syck YAML 1.0 解析器库的包装器

* * *

## 回答 #6

> 赞同：2
> 
> 时间：2010-03-15T10:52:14.767

试试**[sfYaml](http://www.symfony-project.org/api/1_0/sfYaml)**，这是我所知道的最好的。

Symfony 和 Doctrine ORM 正在使用这个。

要获得它，您可以[下载 Doctrine 1.2](http://www.doctrine-project.org/download)并`sfYaml`从`vendor`目录中提取。

让我们知道它是否适合您的需求。

* * *

## 回答 #7

> 赞同：2
> 
> 时间：2010-04-03T17:25:14.470

如果您需要快速测试您的 YAML，我构建了：http: [//yaml-online-parser.appspot.com/](http://yaml-online-parser.appspot.com/)。它帮助我编写 YAML，尤其是在刚学习的时候。

# nhibernate - NHibernate、Codesmith 和项目物理架构

> ID：294360
> 
> 赞同：1
> 
> 时间：2008-11-16T20:36:14.007
> 
> 标签：nhibernate, codesmith

最近我尝试了 NHibernate 的 CodeSmith 模板。许多人可能看过，有一个视频解释了如何使用这些模板创建 Petshop.Data。我的问题是这种方法的正确架构是什么？我们应该有一个 BLL（或服务）层来与这个 Petshop.Data 交互还是直接在我们的表示层中调用 ManagerFactory？我们的表示层是否应该不知道 Petshop.Data 中的业务对象，我们是否应该再次在 BLL 中拥有业务实体？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2010-06-22T17:38:41.807

请随时在我们的[社区站点](http://community.codesmithtools.com/Template_Frameworks/f/67.aspx)和我们的[模板错误跟踪器](http://code.google.com/p/codesmith/issues/list?can=2&q=Framework-NHibernate)中解决这些问题。我们认真对待所有反馈并每天查看。

谢谢-布莱克·涅米斯基

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2008-11-17T00:18:33.107

我会说表示层可以知道您的业务对象，但不应该知道它们是如何从数据库中填充的（但 NHibernate 无论如何都会为您处理这些）。如果您确实使用服务层，它会为您提供更多的灵活性/控制点。我总是用一个。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2009-05-07T18:44:30.110

我在 CodeSmith 也有过类似的经历。这是我写的一篇博客文章：http: [//hypertrends.com/Blog/post/2008/12/15/CodeSmith-to-create-NHibernate-Mappings-Honest-Thoughts.aspx](http://hypertrends.com/Blog/post/2008/12/15/CodeSmith-to-create-NHibernate-Mappings-Honest-Thoughts.aspx)

# unicode - 在标识符中使用 unicode 有哪些经验

> ID：294367
> 
> 赞同：8
> 
> 时间：2008-11-16T20:41:03.640
> 
> 标签：unicode, uniqueidentifier

如今，越来越多的语言使用 unicode，这是一件好事。但这也带来了危险。过去很难区分 1 和 l 以及 0 和 O。但现在我们有了全新的相似字符范围。

例如：

```
ì, î, ï, ı, ι, ί, ׀ ,أ ,آ, ỉ, ﺃ 
```

有了这些，创建一些很难找到的错误并不难。

在我的工作中，我们决定使用 ANSI 字符作为标识符。有没有人使用 unicode 标识符，有什么经验？

* * *

## 回答 #1

> 赞同：10
> 
> 时间：2008-11-16T20:55:04.437

除了您提到的类似字符错误以及使用不同编辑器时可能出现的技术问题（w/BOM、wo/BOM、通过复制粘贴在同一文件中使用不同编码，这仅在实际存在无法编码的字符时才会出现问题ASCII 等），我发现在标识符中使用 Unicode 字符是不值得的。英语已成为开发的通用语，您在编写代码时应该坚持使用它。

对于任何开发人员可以在世界任何地方看到的代码（开源或与产品一起出售的代码），我发现尤其如此。

* * *

## 回答 #2

> 赞同：6
> 
> 时间：2008-11-16T20:57:11.983

我在 C# 源文件中使用 unicode 的经历是灾难性的，即使它是日语（所以没有什么可以与“i”混淆）。Source Safe 不喜欢 unicode，当您发现自己在 Word 中手动修复损坏的源文件时，您就知道有些地方不对劲。

我认为您的仅 ANSI 政策非常好。我真的看不出任何不可行的理由（只要您的大多数开发人员都是英语，即使他们不习惯于 ANSI 字符集）。

* * *

## 回答 #3

> 赞同：3
> 
> 时间：2008-11-17T00:37:39.683

我认为将整个 ANSI 字符集用于标识符并不是一个好主意。无论您使用的是哪个 ANSI 代码页，您的 ANSI 代码页都包含一些其他 ANSI 代码页不包含的字符。所以我建议坚持使用 ASCII，没有高于 127 的字符代码。

在实验中，我使用了比 ASCII 更广泛的 ANSI 字符，即使在标识符中也是如此。一些编译器接受了它。一些 IDE 需要为可以显示字符的字体设置选项。但我不建议将其用于实际用途。

现在谈谈 ANSI 代码页和 Unicode 之间的区别。

在实验中，我以 Unicode 存储源文件并在标识符中使用 Unicode 字符。一些编译器接受了它。但我仍然不建议将其用于实际用途。

有时我以 Unicode 存储源文件，并在某些字符串中使用转义序列来表示 Unicode 字符值。这是一个重要的做法，我强烈推荐它。当其他程序员在他们的字符串中使用 ANSI 字符时，我尤其不得不这样做，并且他们的 ANSI 代码页与其他 ANSI 代码页不同，因此字符串被破坏并导致编译错误或有缺陷的结果。解决这个问题的方法是使用 Unicode 转义序列。

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2008-11-16T23:19:17.783

我还建议使用 ascii 作为标识符。如果编辑器/ide/编译器等都支持区域设置并设置为使用相同的编码，则注释可以保留为非英语语言。

此外，一些不区分大小写的语言在使用前会将标识符更改为小写，如果活动系统语言环境是土耳其语或阿塞拜疆语，则会导致问题。[有关土耳其语言环境问题的更多信息，请参见此处](http://www.i18nguy.com/unicode/turkish-i18n.html)。我知道 PHP 会这样做，并且[它有一个长期存在的错误](http://bugs.php.net/bug.php?id=18556)。

这个问题也存在于任何使用土耳其语言环境比较字符串的软件中，不仅仅是语言实现本身，只是要指出。它引起[许多头痛](http://planet.gentoo.org/developers/serkan/2008/11/16/applications_failing_with_turkish_locale)

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2008-11-17T01:55:16.890

这取决于您使用的语言。例如，在 Python 中，我更容易坚持使用 unicode，因为我的应用程序需要使用多种语言。因此，当我从某个我不认识的人（某物）那里得到一个文件时，我假设为 Latin-1 并翻译为 Unicode。

为我工作，因为我在拉丁美洲。

实际上，一旦一切都解决了，整个事情就变得一帆风顺了。

当然，这取决于选择的语言。

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2009-01-23T09:15:57.233

我从来没有使用 unicode 作为标识符名称。但我想到的是 Python 在版本 3 中允许使用 unicode 标识符：[PEP 3131](http://www.python.org/dev/peps/pep-3131/)。

另一种广泛使用 unicode 的语言是[Fortress](http://projectfortress.sun.com/Projects/Community)。

即使您决定不使用 unicode，当您使用使用 unicode 的库时，问题也会再次出现。所以你必须在一定程度上忍受它。

# java - CharBuffer 与 char[]

> ID：294382
> 
> 赞同：28
> 
> 时间：2008-11-16T20:54:13.177
> 
> 标签：java, io, buffer

在以下情况下是否有任何理由更喜欢`CharBuffer`a `char[]`：

```
CharBuffer buf = CharBuffer.allocate(DEFAULT_BUFFER_SIZE);
while( in.read(buf) >= 0 ) {
  out.append( buf.flip() );
  buf.clear();
} 
```

对比

```
char[] buf = new char[DEFAULT_BUFFER_SIZE];
int n;
while( (n = in.read(buf)) >= 0 ) {
  out.write( buf, 0, n );
} 
```

（`in`a`Reader`和`out`a 在哪里`Writer`）？

* * *

## 回答 #1

> 赞同：18
> 
> 时间：2008-11-16T22:09:49.780

`CharBuffer`不，在这种情况下真的没有理由更喜欢 a 。

不过，总的来说，`CharBuffer`（和`ByteBuffer`）确实可以简化 API 并鼓励正确处理。如果您正在设计公共 API，那么绝对值得考虑使用面向缓冲区的 API。

* * *

## 回答 #2

> 赞同：7
> 
> 时间：2008-11-17T09:42:28.897

我想对这个比较进行迷你基准测试。

下面是我写的课。

问题是我无法相信 CharBuffer 的表现如此糟糕。我做错了什么？

*编辑：自从下面的第 11 条评论以来，我已经编辑了代码和输出时间，整体性能更好，但时间上仍然存在显着差异。我还尝试了注释中提到的 out2.append((CharBuffer)buff.flip()) 选项，但它比下面代码中使用的 write 选项慢得多。*

结果：（以毫秒为单位的时间）
char[]：3411
CharBuffer：5653

```
public class CharBufferScratchBox
{
    public static void main(String[] args) throws Exception
    {
        // Some Setup Stuff
        String smallString =
                "1111111111222222222233333333334444444444555555555566666666667777777777888888888899999999990000000000";

        StringBuilder stringBuilder = new StringBuilder();
        for (int i = 0; i < 1000; i++)
        {
            stringBuilder.append(smallString);
        }
        String string = stringBuilder.toString();
        int DEFAULT_BUFFER_SIZE = 1000;
        int ITTERATIONS = 10000;

        // char[]
        StringReader in1 = null;
        StringWriter out1 = null;
        Date start = new Date();
        for (int i = 0; i < ITTERATIONS; i++)
        {
            in1 = new StringReader(string);
            out1 = new StringWriter(string.length());

            char[] buf = new char[DEFAULT_BUFFER_SIZE];
            int n;
            while ((n = in1.read(buf)) >= 0)
            {
                out1.write(
                        buf,
                        0,
                        n);
            }
        }
        Date done = new Date();
        System.out.println("char[]    : " + (done.getTime() - start.getTime()));

        // CharBuffer
        StringReader in2 = null;
        StringWriter out2 = null;
        start = new Date();
        CharBuffer buff = CharBuffer.allocate(DEFAULT_BUFFER_SIZE);
        for (int i = 0; i < ITTERATIONS; i++)
        {
            in2 = new StringReader(string);
            out2 = new StringWriter(string.length());
            int n;
            while ((n = in2.read(buff)) >= 0)
            {
                out2.write(
                        buff.array(),
                        0,
                        n);
                buff.clear();
            }
        }
        done = new Date();
        System.out.println("CharBuffer: " + (done.getTime() - start.getTime()));
    }
} 
```

* * *

## 回答 #3

> 赞同：4
> 
> 时间：2008-11-16T21:16:17.250

如果这是您对缓冲区所做的唯一事情，那么在这种情况下，数组可能是更好的选择。

CharBuffer 上面有很多额外的铬，但在这种情况下它们都无关紧要 - 只会减慢一点速度。

如果您需要使事情变得更复杂，您可以随时重构。

* * *

## 回答 #4

> 赞同：4
> 
> 时间：2008-11-20T01:19:34.357

实际上，差异实际上小于 10%，而不是其他人报告的 30%。

为了读取和写入 5MB 文件 24 次，我使用 Profiler 获取了我的数字。他们平均为：

```
char[] = 4139 ms
CharBuffer = 4466 ms
ByteBuffer = 938 (direct) ms 
```

个别测试多次青睐 CharBuffer。

我还尝试用内存 IO 替换基于文件的 IO，性能相似。如果您尝试从一个本地流传输到另一个，那么最好使用“直接”ByteBuffer。

由于性能差异不到 10%，在实践中，我更喜欢 CharBuffer。它的语法更清晰，无关变量更少，您可以对其进行更直接的操作（即任何需要 CharSequence 的操作）。

基准在下面...有点错误，因为 BufferedReader 分配在测试方法内部而不是外部...但是，下面的示例允许您隔离 IO 时间并消除字符串或字节流调整其内部大小等因素内存缓冲区等

```
public static void main(String[] args) throws Exception {
    File f = getBytes(5000000);
    System.out.println(f.getAbsolutePath());
    try {
        System.gc();
        List<Main> impls = new java.util.ArrayList<Main>();
        impls.add(new CharArrayImpl());
        //impls.add(new CharArrayNoBuffImpl());
        impls.add(new CharBufferImpl());
        //impls.add(new CharBufferNoBuffImpl());
        impls.add(new ByteBufferDirectImpl());
        //impls.add(new CharBufferDirectImpl());
        for (int i = 0; i < 25; i++) {
            for (Main impl : impls) {
                test(f, impl);
            }
            System.out.println("-----");
            if(i==0)
                continue; //reset profiler
        }
        System.gc();
        System.out.println("Finished");
        return;
    } finally {
        f.delete();
    }
}
static int BUFFER_SIZE = 1000;

static File getBytes(int size) throws IOException {
    File f = File.createTempFile("input", ".txt");
    FileWriter writer = new FileWriter(f);
    Random r = new Random();
    for (int i = 0; i < size; i++) {
        writer.write(Integer.toString(5));
    }
    writer.close();
    return f;
}

static void test(File f, Main impl) throws IOException {
    InputStream in = new FileInputStream(f);
    File fout = File.createTempFile("output", ".txt");
    try {
        OutputStream out = new FileOutputStream(fout, false);
        try {
            long start = System.currentTimeMillis();
            impl.runTest(in, out);
            long end = System.currentTimeMillis();
            System.out.println(impl.getClass().getName() + " = " + (end - start) + "ms");
        } finally {
            out.close();
        }
    } finally {
        fout.delete();
        in.close();
    }
}

public abstract void runTest(InputStream ins, OutputStream outs) throws IOException;

public static class CharArrayImpl extends Main {

    char[] buff = new char[BUFFER_SIZE];

    public void runTest(InputStream ins, OutputStream outs) throws IOException {
        Reader in = new BufferedReader(new InputStreamReader(ins));
        Writer out = new BufferedWriter(new OutputStreamWriter(outs));
        int n;
        while ((n = in.read(buff)) >= 0) {
            out.write(buff, 0, n);
        }
    }
}

public static class CharBufferImpl extends Main {

    CharBuffer buff = CharBuffer.allocate(BUFFER_SIZE);

    public void runTest(InputStream ins, OutputStream outs) throws IOException {
        Reader in = new BufferedReader(new InputStreamReader(ins));
        Writer out = new BufferedWriter(new OutputStreamWriter(outs));
        int n;
        while ((n = in.read(buff)) >= 0) {
            buff.flip();
            out.append(buff);
            buff.clear();
        }
    }
}

public static class ByteBufferDirectImpl extends Main {

    ByteBuffer buff = ByteBuffer.allocateDirect(BUFFER_SIZE * 2);

    public void runTest(InputStream ins, OutputStream outs) throws IOException {
        ReadableByteChannel in = Channels.newChannel(ins);
        WritableByteChannel out = Channels.newChannel(outs);
        int n;
        while ((n = in.read(buff)) >= 0) {
            buff.flip();
            out.write(buff);
            buff.clear();
        }
    }
} 
```

* * *

## 回答 #5

> 赞同：2
> 
> 时间：2008-11-17T01:56:17.823

我认为 CharBuffer 和 ByteBuffer（以及任何其他 xBuffer）是为了可重用性，所以你可以 buf.clear() 它们而不是每次都重新分配

如果你不重复使用它们，你就没有充分利用它们的潜力，而且会增加额外的开销。但是，如果您打算扩展此功能，那么将它们保留在那里可能是个好主意

* * *

## 回答 #6

> 赞同：1
> 
> 时间：2008-11-17T01:43:07.150

CharBuffer 版本稍微不那么复杂（少一个变量），封装了缓冲区大小处理并使用标准 API。一般来说，我更喜欢这个。

然而，至少在某些情况下，仍然有一个很好的理由更喜欢阵列版本。CharBuffer 仅在 Java 1.4 中引入，因此如果您要部署到早期版本，*则不能*使用 Charbuffer（除非您自己滚动/使用反向端口）。

PS 如果您使用反向移植，请记住在赶上包含反向移植代码的*“真实”版本的版本时将其删除。*

* * *

## 回答 #7

> 赞同：1
> 
> 时间：2009-02-12T09:50:45.923

您应该避免`CharBuffer`在最近的 Java 版本中，`#subsequence()`. 您无法从缓冲区的后半部分获取子序列，因为实现混淆了`capacity`和`remaining`。我观察到 java 6-0-11 和 6-0-12 中的错误。

# c# - 绘制 C# 链表的变量图

> ID：294383
> 
> 赞同：2
> 
> 时间：2008-11-16T20:54:14.847
> 
> 标签：c#

我在理解如何将变量图绘制到链表方面遇到了一个真正的问题

在我正在阅读的书中，它没有提供足够的信息

我将发布一个示例：

* * *

插入：

```
public void Insert(Object newItem, Object after)
{
    Node current = new Node();

    Node newNode = new Node(newItem);
    current = Find(after);
    newNode.Link = current.Link;
    current.Link = newNode;
}

private Node FindPrevious(Object n)
{
    Node current = header;
    while(!(current.Link == null) && (current.Link.Element != n))
        current = current.Link;
    return current;
}

public void Remove(Object n)
{
    Node p = FindPrevious(n);
    if (!(p.Link == null))
        p.Link = p.Link.Link;
} 
```

我在网上搜索了更多信息，但每次我发现不同的信息时，谁能帮忙

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2008-11-16T21:53:03.900

你想把它画在纸上做作业吗？如果是这样，则每个节点的 Link 属性都具有对链表中下一个节点的引用。要绘制它，您可能会在一行中有一系列代表节点类的框。在每个节点中，您将有两个属性，即 Item 和 Link。Link 将指向链中的下一个节点，而 Item 将指向列表之外的项目。

您提供的代码看起来像一个单链表。有关示例和简单图表，请参阅[链接列表上的 Wikipedia 页面。](http://en.wikipedia.org/wiki/Linked_list#Singly-linked_list)在该示例中，数字是链接列表中的数据（您的项目），带箭头的点是您指向列表中下一个项目（链接属性）的链接。

希望这就是你要找的。否则，请修改您的问题。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2008-11-16T21:05:00.707

首先，您需要了解绘画的基础知识。
一个好主意是提供一个单独的“DrawNode”函数。然后，您将需要检索节点的子节点，并绘制它们中的每一个。最后，您需要绘制链接。

确保一个绘制的节点没有隐藏另一个。我希望这有帮助。如果不是，请说明你不明白的地方。

# c# - Good Tiff library for .NET

> ID：294391
> 
> 赞同：18
> 
> 时间：2008-11-16T20:57:49.737
> 
> 标签：c#, .net, tiff

I know [libtiff](http://www.libtiff.org/libtiff.html) for C, but haven't found a port for .NET. Does such a port exist?

* * *

## 回答 #1

> 赞同：26
> 
> 时间：2010-01-28T18:00:45.683

我的公司最近发布了一个免费和开源（新 BSD 许可证）版本的 LibTiff，仅使用托管 C# 编写（许可证允许商业使用和分发）。

[https://bitmiracle.com/libtiff/](https://bitmiracle.com/libtiff/)

* * *

## 回答 #2

> 赞同：11
> 
> 时间：2008-11-16T22:11:25.050

What about using the built in .NET class? See ["How to: Encode and Decode a TIFF Image"](http://msdn.microsoft.com/en-us/library/aa969817.aspx) on MSDN.

# asp.net - ASP.NET Ajax 错误

> ID：294415
> 
> 赞同：1
> 
> 时间：2008-11-16T21:23:31.230
> 
> 标签：asp.net, ajax, modalpopupextender

我将 ModalPopupExtender 添加到现有的 ASP.NET 应用程序中。在运行时我收到以下错误

编译错误描述：在编译服务此请求所需的资源期间发生错误。请查看以下特定错误详细信息并适当修改您的源代码。

编译器错误消息：BC32206：正在对包含“AjaxControlToolkit.ModalPopupExtender”的程序集 System.Web.Extensions 版本 3.5.0.0 进行间接引用。此项目引用 System.Web.Extensions 版本 1.0.61025.0 的早期版本。要使用“AjaxControlToolkit.ModalPopupExtender”，您必须将 System.Web.Extensions 的引用替换为 3.5.0.0 或更高版本。

源错误：

第 29 行：
第 30 行：
第 31 行：

我该如何解决。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2008-11-16T21:55:57.013

您正在尝试使用对 .NET 1.1 模块的引用来编译 .NET 3.5 应用程序。确保您安装了 .NET 3.5 框架，如果安装了，请确保您尝试在 .NET 3.5 中构建它。

您可能还想看看[这篇文章](https://stackoverflow.com/questions/43939/targeting-multiple-versions-of-net-framework)。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2008-11-16T22:20:12.440

您确定您拥有正确版本的 AjaxControlToolkit 吗？有一个针对 .NET 3.5 编译的版本和一个针对 .NET 2.0 的版本。

看起来您仍在 2.0 领域（带有 2.0 AJAX 扩展）。如果是这样，请获取正确版本的[Toolkit](http://www.codeplex.com/AjaxControlToolkit/Release/ProjectReleases.aspx?ReleaseId=11121)。看起来最新版本不支持.NET2.0。

如果您使用的是 3.5 版，请查看您对 System.Web.Extensions 的引用，并确保您引用的是 .NET3.5 版本（“内置”的实际版本 3.5.x），而不是 .NET2.0 版本（实际版本 1.0.x，这是一个下载添加）。

# asp.net - .net 3.0 服务器上的 .net 3.5SP1 - 是否可以在 ASP.net 中使用 /bin 文件夹？

> ID：294417
> 
> 赞同：1
> 
> 时间：2008-11-16T21:26:24.563
> 
> 标签：asp.net

我的一个网站位于共享主机提供商上，运行 .net 2.0 或 .net 3.0，但不运行 3.5 SP1。

我想知道是否可以通过简单地将所有 3.5 程序集部署到 /bin 文件夹中来继续使用 3.5 SP1，因为从技术上讲，它仍然是 2.0 CLR。

我知道如果我的主机更新了，我必须删除它们，否则可能会发生奇怪的事情，并且我正在全速驶入不受支持的领土，但是否有任何真正的大路标上写着“不要这样做！ " 甚至“因为X而不可能”？

主要原因是因为我想使用 ASP.net MVC 和可能的 ADO.net 实体框架，但我不想与另一个托管服务提供商签订合同。

谢谢！

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2008-11-16T21:40:22.333

*理论上*可以实现，但绝对*不*推荐。

Scott Hanselman 发表了一篇关于如何在安装了其他 .NET 2.0 的服务器上运行 ASP.NET MVC 的帖子，请参阅 - [http://www.hanselman.com/blog/DeployingASPNETMVCOnASPNET20.aspx](http://www.hanselman.com/blog/DeployingASPNETMVCOnASPNET20.aspx)

不过，这在很大程度上是一个“在我的机器上工作”认证的帖子。

ASP.NET 站点上的所有 DLL 都可以驻留在 /bin 中，前提是它们被正确引用。我的建议 - 创建一个虚拟机（MS Virtual PC 是免费的），只安装 .NET 2.0/.NET 3.0，然后从 .NET 3.5 安装中复制您需要的 DLL（提示 - 您会在 %program files 中找到 DLL %\参考程序集）。

**对于您从这个答案对您的提供商造成的损害，我不承担任何责任**

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2008-11-16T21:39:28.670

我很确定您不能这样做，但是在以下博客上搜索可能会为您提供明确的答案：

[斯科特古斯科](http://weblogs.asp.net/Scottgu/) [特哈](http://www.hanselman.com/blog/) [布拉德](http://blogs.msdn.com/brada/)

我认为问题是：

你想加载system.dll。它看起来在哪里？GAC 会优先考虑吗？（我认为确实如此），因此您得到 2.0。所以你有system.dll v2.0，你尝试使用绑定到system.dll v3.5的DLL（例如system.web.mvc），但只在你/bin中......它应该爆炸大声地，没有相同的合同等。

就个人而言，我不会尝试，尤其是在生产方面。但是，如果您可以暂时关闭该网站，请试一试。最坏的情况是，您必须删除文件并重新上传旧站点。

YMMV :)

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2008-11-17T04:24:23.907

我已经在仅安装了 .net 3.5 的主机上成功运行了一些 EntityFramework 网站。我从 Program Files%/Reference Assemblies 复制了 System.Data.Entity.dll 和 System.Web.Entity。我还必须修改我的 web.config 并删除对 System.Data.Entity 和 System.Web.Entity 的引用。

更新：此技术不适用于 DynamicData 或 EntityDataSource Web 控件。我相信它与从 3.5 开始存在于 GAC 中的 System.Web.WebExtensions.dll 有关

# c# - 在整个大型 Web 应用程序中一致地格式化 C# 中的字符串

> ID：294443
> 
> 赞同：4
> 
> 时间：2008-11-16T21:49:10.490
> 
> 标签：c#, .net, asp.net, architecture, formatting

我正在寻找一种一致的方式来构建我在整个大型 Web 应用程序中对格式化字符串的使用，并且我正在寻找关于哪种方式的建议或最佳实践。

到目前为止，我有一个静态类，它执行一些常见的格式化，例如

Formatting.FormatCurrency

Formatting.FormatBookingReference

我不相信这是要走的路，我更喜欢直接使用.NET中格式化字符串的标准方法并使用：

数量.ToString("c")

参考.ToString("000000")

对于我们一些更复杂的数据结构，我使用 IFormattable 和 ICustomFormatter，但我正在努力处理我们需要格式化的更简单的现有对象（在本例中为 Int32 以及 DateTime）。

我是否只是为“c”和“000000”定义常量并在整个 Web 应用程序中一致地使用它们，还是有更标准的方法来做到这一点？

* * *

## 回答 #1

> 赞同：12
> 
> 时间：2008-11-16T21:54:02.043

一种选择是使用具有扩展方法的辅助类，例如

```
public static class MyWebAppExtensions
{
    public static string FormatCurrency(this decimal d)
    {
        return d.ToString("c");
    }
} 
```

然后在任何你有十进制值的地方

```
Decimal d = 100.25;
string s = d.FormatCurrency(); 
```

* * *

## 回答 #2

> 赞同：5
> 
> 时间：2008-11-17T00:00:42.550

我同意 GeekyMonkey 的建议，但有一处改动：

格式化是一个实现细节。我建议`ToCurrencyString`遵守 To* 约定及其意图。

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2008-11-17T00:20:00.733

这个答案可以与 GeekyMonkey 的答案结合使用。

首先，在 ASP.NET 中，您可以使用[`globalization`](http://msdn.microsoft.com/en-us/library/hy4kkhe0.aspx)元素在 web.config 中设置文化和 UI 文化。当您有特殊的格式化需求时，该`resourceProviderFactoryType`属性是您的朋友。

另一种可能性是创建 ASP.NET Page 类的子类并覆盖该[`InitializeCulture`](http://msdn.microsoft.com/en-us/library/system.web.ui.page.initializeculture.aspx)方法。在这里，您可以更改存储在处理 HTTP 请求的当前线程中的文化和 UI 文化。

一个简单的例子：

```
protected override void InitializeCulture()
{
    Thread.CurrentThread.CurrentCulture = ...;
    Thread.CurrentThread.CurrentUICulture = ...;

    Thread.CurrentThread.CurrentCulture.DateTimeFormat.ShortDatePattern = "dd-MM-yyyy";
    ...
} 
```

对于那些担心 ASP.NET 进行“随机”线程切换的人：

> ASP.NET 确保，即使他们切换您的线程，CurrentPrincipal 和文化属性从原始线程继续传递到新线程。这是自动的，您无需担心丢失这些值。哇！
> 
> 来源：[ASP.NET 线程切换](http://www.lhotka.net/WeBlog/PermaLink,guid,019e3c37-38ed-492e-b769-16e1a57fed0a.aspx)

# c# - db 中每一行的单独数据表。。网

> ID：294444
> 
> 赞同：1
> 
> 时间：2008-11-16T21:49:58.010
> 
> 标签：c#, .net, layout, controls

我有超过页面宽度的数据网格控件生成的长表。我想将其转换为每一行或定义列表的单独表，其中每个字段名称后跟字段值。

我该怎么做。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2008-11-16T23:37:18.713

使用 jquery。如果您有不止一张桌子，则需要对其进行更改以适应它。此外，只需附加到文档的末尾。如果你想在别处找到它，找到你想要放置它的元素，然后将它插入到 DOM 中。

```
$(document).ready(
    function() {

        var headers = $('tr:first').children();

        $('tr:not(:first)').each(

          function(i,row) {

             var cols = jQuery(row).children();

             var dl = jQuery('<dl></dl>');

             for (var i=0, len = headers.length; i < len; ++i) {
                 var dt = jQuery('<dt>');
                 dt.text( jQuery(headers[i]).text() );

                 var dd = jQuery('<dd>');
                 dd.text( jQuery(cols[i]).text() );

                 dl.append(dt).append(dd);
             }
             $('body').append(dl);
          }
        );
        $('table').remove();
    }
); 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2008-11-16T21:56:19.760

这是一个参考：

[http://www.mail-archive.com/flexcoders@yahoogroups.com/msg15534.html](http://www.mail-archive.com/flexcoders@yahoogroups.com/msg15534.html)

我认为你想要的谷歌术语是“反转数据网格”。你会得到很多点击。

# visual-studio - Visual Studio 中的拆分编辑窗口

> ID：294449
> 
> 赞同：51
> 
> 时间：2008-11-16T21:54:44.630
> 
> 标签：visual-studio

有什么方法可以在 Visual Studio 中显示两个编辑窗口？我想同时查看两个源文件，但我必须错过这样做的选项。

* * *

## 回答 #1

> 赞同：91
> 
> 时间：2015-12-11T17:24:52.647

我认为您想要做的是添加一个新的垂直选项卡组。执行此操作的键盘快捷键是

> `Alt`+ `W`, `V`.

根据这个[来源](https://blogs.msdn.microsoft.com/zainnab/2011/03/01/split-code-windows-vertically/)，它适用于 Visual Studio 2005、2008 和 2010。根据我的经验，它也适用于 Visual Studio 2013。

* * *

## 回答 #2

> 赞同：48
> 
> 时间：2008-11-16T21:57:45.887

另一个简单的选择是打开两个文档，然后只需单击并拖动其中一个文档的选项卡并将其拖放到文档本身上。这将显示一个菜单，让您可以将文档移动到新的垂直或水平选项卡组。

我发现这是最简单、最快捷的方法。

您没有在问题中提问，但是如果您想在两个窗口中编辑**一个**文档，您可以抓住滚动条上方的小区域并将其向下拖动。您现在将在两个可滚动区域中打开您的文档。非常适合同时处理两个部分。

* * *

## 回答 #3

> 赞同：26
> 
> 时间：2009-05-09T15:49:54.923

要为“Window->New Vertical Tab Group”创建键盘快捷方式，您需要为“Window.NewVerticalTabGroup”命令分配快捷方式。
工具->选项->环境->键盘，在“显示包含的命令”中键入“Window.NewVerticalTabGroup”，并在“按下快捷键”字段中分配键盘快捷键。
请记住在“确定”之前单击“分配”。

* * *

## 回答 #4

> 赞同：10
> 
> 时间：2014-04-09T18:52:21.073

对于 Visual Studio 2012：

将鼠标移到类选项卡上 > 右键单击​​类的标题 > 新建水平选项卡组或新建垂直选项卡组。

如果你想拆分同一个类：工具 -> 选项 -> 环境 -> 键盘 -> 按 Window.Split 搜索并添加一个新的快捷方式。

* * *

## 回答 #5

> 赞同：7
> 
> 时间：2021-09-29T14:22:20.437

在 Visual Studio Community 2019 中拆分一个文档（代码）并拥有两个独立的代码视图，显示的右上角有一个小工具：

[![在此处输入图像描述](https://i.stack.imgur.com/I8gJj.jpg)](https://i.stack.imgur.com/I8gJj.jpg)

只需将其向下拖动，您将获得当前文件的另一个查看器。要调整高度，您可以抓住两个视图之间的栏并拖动。（可能有点棘手，只需移动鼠标，直到鼠标指针图标变为双箭头）

要在两个文件之间拆分视图，只需右键单击其中一个文件选项卡（标题），然后在结果菜单中，您可以选择“新建水平文档组或新建垂直文档组：

[![在此处输入图像描述](https://i.stack.imgur.com/llpnb.jpg)](https://i.stack.imgur.com/llpnb.jpg)

* * *

## 回答 #6

> 赞同：2
> 
> 时间：2018-08-21T13:07:28.857

在 Visual Studio 2015 中，右键单击写入文件名的选项卡部分，然后选择垂直拆分或水平拆分。

# java - 从 Java 到 .Net

> ID：294453
> 
> 赞同：7
> 
> 时间：2008-11-16T21:56:18.590
> 
> 标签：java, .net

对于从 Java 跳转到 .Net 的任何开发人员来说，这些都是一些问题：

如果你可以回到你切换的开始，你会做些什么来让过渡更容易？

有什么书可以推荐吗？

.Net 与 Java EE 相比如何？有什么让你完全烦恼的事情吗？

最重要的是，你后悔跳槽了吗？

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2008-11-16T22:17:59.263

我在 Java 和 .NET 之间进行了几年的 C/C++ 开发，所以我的经验可能有点不同。

我发现从 Java 迁移到 C# 非常容易。这些语言非常相似，并且大部分框架都以相似的方式工作。我喜欢 Java，但我不认为我会回去。我认为对我来说最大的不同是工具。Visual Studio 是一个很棒的产品，让编码成为一种乐趣。为 VS 添加一个重构插件，比如[Resharper](http://www.jetbrains.com/resharper/)，你可能不会回头。

根据您所做的开发类型，我会首先避免使用 WPF 并坚持使用 WinForms（或 WebForms 与 Silverlight），因为您会更熟悉 Java。一旦你开始感到舒服就转移到 WPF 或 Silverlight，因为这些框架有很多东西要学习。

您还会发现，您过去可能使用过的许多 OpenSource 库都已移植到 .NET，因此这可能会帮助您开始运行。

我认为最好的书是Wrox Press 的[Professional C# 2008](https://rads.stackoverflow.com/amzn/click/com/0470191376)。作为一名 Java 程序员，您不会在语言方面遇到太多问题，您将需要有关框架的最多帮助。这本书在那里会很有帮助。

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2008-11-16T22:07:37.990

为 VS 获取一个不错的重构插件，因为您会错过 Java-IDE 的所有不错的重构。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2008-11-16T22:07:05.463

不要认为它是一个开关。如果你学习一门像 C# 这样的新语言，你并没有用你在 Java 中的所有知识进行交易。您的其他语言技能开始下降需要几个月的时间。试试看它是否适合你。如果你改变主意，Java 还会存在几年。:)

我会推荐（并且多次推荐）[Head First C#](http://oreilly.com/catalog/9780596514822/)作为您的第一本 .NET 书籍。恕我直言，整个系列确实无与伦比。

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2008-11-16T22:14:57.943

作为一名 Java-C# 开发人员，我不确定我会做些什么不同的事情。

至于要阅读的书籍，我使用了O'Reilly 的[C# Pocket Reference](http://search.barnesandnoble.com/C-Language-Pocket-Reference/Peter-Drayton/e/9780596004293)。我真的很喜欢这些书，因为它们很小，因此您可以将它们放在身边，并在遇到问题时轻松翻阅它们。

我推荐的另一个参考不是一本书，它是 MSDN 上的[.NET Framework 类库](http://msdn.microsoft.com/en-au/library/ms229335.aspx)。MSDN 对于学习框架而不是语言最有用。

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2008-11-17T01:10:29.447

我注意到您说的是 .Net 而不是任何特定的 .Net 语言。我在 Java 和 VB.Net、C#.Net 和少量 C++.Net 之间来回切换。

要记住的主要事情是，大多数语言都有共同的根源并且在某种程度上相似，因此首先要做的是识别差异。牢记它们，您将有一个良好的开端，能够将您现有的知识移植到新环境中。接下来要做的是检查您现有的知识是否没有被您以前没有遇到过的某些语言功能所覆盖，例如。闭包，特殊的内置类/函数等。

我还尝试确保我使用的 IDE 具有：

*   常用/可配置的快捷方式。
*   重构工具（内置或第三方）。
*   我正在使用的工具集的适当插件。

这主要是为了减少我在 IDE 上“战斗”的时间，因为我经常使用快捷方式，而且我不想离开 IDE 来运行诸如 Maven 之类的东西。

我会推荐有关您将使用的特定 API 的书籍，并确保您有良好的互联网连接，因为 Google 是您的朋友 :-)

大多数语言总是有一些让我烦恼的事情（它们都不是完美的），但没有一个是杀手。小事包括 VB 声明与我现在常用的大多数其他语言相反，尽管我说过 15 年前当我经常使用 PL-1/PL-X 时，我会对 Java/C* 与我一贯的风格。

我来回跳跃，通常我会尝试使用最合适的工具来完成这项工作。我唯一的失望是如果我使用了错误的工具。

# asp.net-mvc - SSL 安全 SaaS 应用程序的 URL 设计

> ID：294463
> 
> 赞同：5
> 
> 时间：2008-11-16T22:06:39.130
> 
> 标签：asp.net-mvc

我正在使用 ASP.NET MVC 平台开发一个应用程序，它将作为 Web 上的服务（[SaaS](http://en.wikipedia.org/wiki/Software_as_a_Service)模型）公开。我正在尝试确定为每个用户帐户划分 URL 命名空间的最佳方法。该应用程序需要通过 SSL 安全地访问，所以我主要关心的是想出一个与 SSL 证书一起工作的 URL 设计。这是我想出的选项。在每个示例中， **bob**和**jane**是两个示例用户帐户：

## 选项 A：每个帐户在通用域名下都有唯一的子域

例如

```
https://bob.example.com
https://jane.example.com 
```

*   这将需要通配符 SSL 证书（例如映射到 *.example.com），因此每个用户都可以通过 SSL 无缝访问他们的帐户。无缝是指没有网络浏览器警告用户有关 SSL 证书问题的信息。我能想到的唯一缺点是通配符证书似乎比普通的固定域证书贵得多。在宏伟的计划中，成本差异肯定可以忽略不计，但如果其他一切都证明是平等的，我会牢记这一点。

## 选项 B：每个帐户都有唯一的域名

例如

```
https://bobs-domain.com
https://domain-of-jane.com 
```

*   在这种情况下，每个用户都有一个与其域名绑定的 SSL 证书。我能想到的一个大缺点是我们的服务器必须维护所有用户证书的私钥，并且我们必须设计一个允许用户安全地将他们的私钥传输到我们的服务器的系统。即使我们有这样的系统，我觉得必须获得证书然后将私钥提交给我们对用户来说负担太大了。

*   或者，我们可以在每个用户注册时自动颁发和配置 SSL 证书，这样他们就可以通过 SSL 开始访问他们的应用程序，而无需额外的步骤。这将要求我们成为 SSL 证书的颁发者，我还没有研究过……我们可能会成为像 Verisign 这样专门从事这类事情的其他大公司的经销商。

*   尽管这种方法有明显的痛苦，但这个选项确实启用了我们将来可能希望提供的一些功能，即允许用户通过他们自己的公司域名访问他们自己的品牌版本的应用程序。

## 选项 C：每个帐户在公共域名下都有唯一的子目录

例如

```
https://example.com/bob
https://example.com/jane 
```

*   从 SSL 证书维护的角度来看，这可能是最好的选择。我们只需要一个所有用户都可以使用的固定域 SSL 证书（例如 example.com）。

*   不幸的是，这种 URL 设计不适用于我们当前应用程序架构的其他方面，尤其是在负载平衡方面。

## 需要反馈

我对你们所有人的问题是：你会选择什么选项，为什么？我特别想听听真实世界的例子和经验，但我还没有提出的任何其他问题或疑虑将不胜感激。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2008-11-20T15:27:20.527

我会选择 A。这个解决方案不是很贵，它可以很好地扩展，并且它不会限制你使用自定义域，如果你以后决定的话。

通配符证书过去非常昂贵，但现在你可以在[GoDaddy](http://www.godaddy.com/gdshop/ssl/ssl.asp?ci=9039 "GoDaddy 的通配符证书")或[RapidSSL](http://www.rapidssl.com/ssl-certificate-products/rapidssl/usd/wildcard-ssl-certificate.htm "RapidSSL 通配符证书")上每年获得 200 美元左右，我认为这很便宜。这些证书（几乎）适用于任何浏览器，但它们不附带验证，VeriSign 提供。我不知道你是否需要这个。

如果你选择选项 B，你必须为每个用户购买一个证书，但使用通配符证书，证书将在几次注册后支付，其余的将是纯收入。

除此之外，该解决方案实施起来非常简单，这也是一种优势。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2008-11-16T22:55:29.033

对我来说听起来像选项B。它似乎是唯一一个 a) 与您的架构一起工作和 b) 与您潜在的未来目标一起工作的人。您可以将自定义域的 SSL 证书的价格作为服务启动成本的一部分（或在每月费用中摊销成本）。

我没有看到 A 和 B 之间的真正区别，它们实际上是相同的，除了您可以为 A 使用通配符证书，您只是不必这样做。如果没有通配符方面，A == B，它们都是 example.com 的子域这一事实是巧合。

即使一开始有选项 A，如果这是您想为客户提供的服务功能，您以后还有空间扩展到选项 B。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2011-05-11T16:34:31.203

选项 B 对用户有很大的价值，如果我可以选择，我会走这条路。请记住，您可以购买多域 ssl 证书/UCC，并且您可以在一个证书下获得多达 100 个域。如果还有其他允许超过 100 个的证书 - 请告诉我，因为我们也在构建 SAAS 模型并且有类似的问题。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2008-11-18T09:05:08.300

你是对的威尔，A和B是一样的。但是，我认为这主要从编码的角度来看是正确的。使用任一选项，Web 服务器将根据 HTTP 标头中的主机名确定帐户。C 从编码的角度来看略有不同，因为它会根据域名下的路径匹配帐户，而 ASP.NET MVC 框架的 URL 路由功能在这里会派上用场。

从管理的角度来看，每个选项都是完全不同的。使用选项 A，我们必须管理子域......我们可以这样做，因为我们的 DNS 提供商有一个 API 来管理主机记录。正如我所提到的，使用选项 B，我们必须管理所有不同域名的私钥。

我从回复的数量猜测这不是在这个论坛上问的最佳问题类型，可能是因为它太开放了。我只是希望曾经去过那里并做过这件事的人能加入进来，主要是为了让我知道我是否走在正确的轨道上，因为我以前从未设计过这样的系统。

谢谢

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2009-04-03T14:55:59.767

我会使用 secure.domain.com 而不是 www.domain 或 domain.com 的证书 我已经看到许多站点使用证书作为其中一个选项（带有或不带有 www 前缀）以及当用户使用另一个选项时（ s) 他被提示接受证书。

您可以将 user.domain.com 用于非安全站点，当用户需要启用 SSL 的部分时，只需使用您的主要 secure.domain.com/user/ ......

这只是一个想法。

斯拉维

# sql - Why can't my Perl CGI script find the Oracle DBD?

> ID：294465
> 
> 赞同：5
> 
> 时间：2008-11-16T22:07:33.263
> 
> 标签：sql, perl, oracle, permissions

DBD, and Oracle Masters:

I have a Perl web application that is behaving oddly. I am using it to read some stuff from an Oracle DB and report. I have version 11.1.0.6.0 of Oracle's Instant Client installed. I'm running on WinXP and have the PATH environment variable set to the instant client location. I have Apache2 for my webserver.

Here's the issue: when I run the app from a command line, it works without a hitch. However, when I run from [http://127.0.0.1/cgi-bin/a.cgi](http://127.0.0.1/cgi-bin/a.cgi), I get the following DB access error:

> `install_driver(Oracle) failed: Can't load 'C:/usr/lib/auto/DBD/Oracle/Oracle.dll' for module DBD::Oracle: load_file:The specified module could not be found at C:/usr/lib/DynaLoader.pm line 202\. at (eval 9) line 3`

Intuition tells me it's a permission issue, but I'm not sure where to look further. Can anyone shed some light on this? I would much appreciate any help.

Thanks, Saker Ghani

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2008-11-16T22:17:39.450

The fact that the error shows the full path of the .DLL suggests that the system isn't having any trouble finding the DLL, so that does back your theory that file permissions are the issue.

To test whether it really is a permissions issue, try writing a trivial Perl CGI script which does nothing but directly open that specific .DLL file (with a normal `open` call) and reports whether it worked or not.

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2008-11-16T22:56:37.047

谢谢阿尔尼塔克。我尝试按照您的建议进行操作，并且“打开”成功打开了“C：/usr/lib/auto/DBD/Oracle/Oracle.dll”。我记得当我在另一台机器上开发时看到了这个确切的错误，但那是因为 Oracle Instant Client 库在它上面丢失了。在我安装这些并设置“路径”变量之后，一切都开始正常工作了。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2010-06-20T22:22:22.920

我遇到了同样的问题，通过接口访问 cgi perl 程序时报告错误“Install_driver(Oracle) failed: Can't load 'C:/Perl/lib/auto/DBD/Oracle/Oracle.dll' for模块 DBD::Oracle: load_file:Access is denied at C:/Perl/lib/DynaLoader.pm line 201"。

我在带有 IIS 6 的 Window 2003 Server 上使用 Perl 5.10。

解决方案是将 Perl 目录的权限授予“所有人”以及 Oracle 安装文件夹。

# audio - Note onset detection

> ID：294468
> 
> 赞同：33
> 
> 时间：2008-11-16T22:09:15.943
> 
> 标签：audio, signal-processing, onset-detection

I am developing a system as an aid to musicians performing transcription. The aim is to perform automatic music transcription (it does not have to be perfect, as the user will correct glitches / mistakes later) on a single instrument monophonic recording. Does anyone here have experience in automatic music transcription? Or digital signal processing in general? Help from anyone is greatly appreciated no matter what your background.

So far I have investigated the use of the Fast Fourier Transform for pitch detection, and a number of tests in both MATLAB and my own Java test programs have shown it to be fast and accurate enough for my needs. Another element of the task that will need to be tackled is the display of the produced MIDI data in sheet music form, but this is something I am not concerned with right now.

In brief, what I am looking for is a good method for note onset detection, i.e. the position in the signal where a new note begins. As slow onsets can be quite difficult to detect properly, I will initially be using the system with piano recordings. This is also partially due to the fact I play piano and should be in a better position to obtain suitable recordings for testing. As stated above, early versions of this system will be used for simple monophonic recordings, possibly progressing later to more complex input depending on progress made in the coming weeks.

* * *

## 回答 #1

> 赞同：50
> 
> 时间：2008-11-17T02:01:02.183

Here is a graphic that illustrates the threshold approach to note onset detection:

![alt text](https://i.imgur.com/MBWzwT8.gif)

This image shows a typical WAV file with three discrete notes played in succession. The red line represents a chosen signal threshold, and the blue lines represent note start positions returned by a simple algorithm that marks a start when the signal level crosses the threshold.

As the image shows, selecting a proper absolute threshold is difficult. In this case, the first note is picked up fine, the second note is missed completely, and the third note (barely) is started very late. In general, a low threshold causes you to pick up phantom notes, while raising it causes you to miss notes. One solution to this problem is to use a relative threshold that triggers a start if the signal increases by a certain percentage over a certain time, but this has problems of its own.

A simpler solution is to use the somewhat-counterintuitively named compression (**not MP3 compression - that's something else entirely**) on your wave file first. Compression essentially flattens the spikes in your audio data and then amplifies everything so that more of the audio is near the maximum values. The effect on the above sample would look like this (which shows why the name "compression" appears to make no sense - on audio equipment it's usually labelled "loudness"):

![alt text](https://i.imgur.com/ctWBY3Y.gif)

After compression, the absolute threshold approach will work much better (although it's easy to over-compress and start picking up fictional note starts, the same effect as lowering the threshold). There are a lot of wave editors out there that do a good job of compression, and it's better to let them handle this task - you'll probably need to do a fair amount of work "cleaning up" your wave files before detecting notes in them anyway.

In coding terms, a WAV file loaded into memory is essentially just an array of two-byte integers, where 0 represents no signal and 32,767 and -32,768 represent the peaks. In its simplest form, a threshold detection algorithm would just start at the first sample and read through the array until it finds a value greater than the threshold.

```
short threshold = 10000;
for (int i = 0; i < samples.Length; i++)
{
    if ((short)Math.Abs(samples[i]) > threshold) 
    {
        // here is one note onset point
    }
} 
```

In practice this works horribly, since normal audio has all sorts of transient spikes above a given threshold. One solution is to use a running average signal strength (i.e. don't mark a start until the average of the last n samples is above the threshold).

```
short threshold = 10000;
int window_length = 100;
int running_total = 0;
// tally up the first window_length samples
for (int i = 0; i < window_length; i++)
{
    running_total += samples[i];
}
// calculate moving average
for (int i = window_length; i < samples.Length; i++)
{
    // remove oldest sample and add current
    running_total -= samples[i - window_length];
    running_total += samples[i];
    short moving_average = running_total / window_length;
    if (moving_average > threshold)
    {
        // here is one note onset point 
        int onset_point = i - (window_length / 2);
    }
} 
```

All of this requires much tweaking and playing around with settings to get it to find the start positions of a WAV file accurately, and usually what works for one file will not work very well on another. This is a very difficult and not-perfectly-solved problem domain you've chosen, but I think it's cool that you're tackling it.

Update: this graphic shows a detail of note detection I left out, namely detecting when the note ends:

![alt text](https://i.imgur.com/ARlewTE.gif)

The yellow line represents the off-threshold. Once the algorithm has detected a note start, it assumes the note continues until the running average signal strength drops below this value (shown here by the purple lines). This is, of course, another source of difficulties, as is the case where two or more notes overlap (polyphony).

Once you've detected the start and stop points of each note, you can now analyze each slice of WAV file data to determine the pitches.

Update 2: I just read your updated question. Pitch-detection through auto-correlation is much easier to implement than FFT if you're writing your own from scratch, but if you've already checked out and used a pre-built FFT library, you're better off using it for sure. Once you've identified the start and stop positions of each note (and included some padding at the beginning and end for the missed attack and release portions), you can now pull out each slice of audio data and pass it to an FFT function to determine the pitch.

One important point here is not to use a slice of the compressed audio data, but rather to use a slice of the original, unmodified data. The compression process distorts the audio and may produce an inaccurate pitch reading.

One last point about note attack times is that it may be less of a problem than you think. Often in music an instrument with a slow attack (like a soft synth) will begin a note earlier than a sharp attack instrument (like a piano) and both notes will sound as if they're starting at the same time. If you're playing instruments in this manner, the algorithm with pick up the same start time for both kinds of instruments, which is good from a WAV-to-MIDI perspective.

Last update (I hope): Forget what I said about including some paddings samples from the early attack part of each note - I forgot this is actually a bad idea for pitch detection. The attack portions of many instruments (especially piano and other percussive-type instruments) contain transients that aren't multiples of the fundamental pitch, and will tend to screw up pitch detection. You actually want to start each slice a little after the attack for this reason.

Oh, and kind of important: **the term "compression" here does not refer to MP3-style compression**.

Update again: here is a simple function that does non-dynamic compression:

```
public void StaticCompress(short[] samples, float param)
{
    for (int i = 0; i < samples.Length; i++)
    {
        int sign = (samples[i] < 0) ? -1 : 1;
        float norm = ABS(samples[i] / 32768); // NOT short.MaxValue
        norm = 1.0 - POW(1.0 - norm, param);
        samples[i] = 32768 * norm * sign;
    }
} 
```

When param = 1.0, this function will have no effect on the audio. Larger param values (2.0 is good, which will square the normalized difference between each sample and the max peak value) will produce more compression and a louder overall (but crappy) sound. Values under 1.0 will produce an expansion effect.

One other probably obvious point: you should record the music in a small, non-echoic room since echoes are often picked up by this algorithm as phantom notes.

Update: here is a version of StaticCompress that will compile in C# and explicity casts everything. This returns the expected result:

```
public void StaticCompress(short[] samples, double param)
{
    for (int i = 0; i < samples.Length; i++)
    {
        Compress(ref samples[i], param);
    }
}

public void Compress(ref short orig, double param)
{
    double sign = 1;
    if (orig < 0)
    {
        sign = -1;
    }
    // 32768 is max abs value of a short. best practice is to pre-
    // normalize data or use peak value in place of 32768
    double norm = Math.Abs((double)orig / 32768.0);
    norm = 1.0 - Math.Pow(1.0 - norm, param);
    orig = (short)(32768.0 * norm * sign); // should round before cast,
        // but won't affect note onset detection
} 
```

Sorry, my knowledge score on Matlab is 0\. If you posted another question on why your Matlab function doesn't work as expected it would get answered (just not by me).

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2008-11-16T23:10:42.993

What you want to do is often called **WAV-to-MIDI** (google "wav-to-midi"). There have been many attempts at this process, with varying results (note onset is one of the difficulties; polyphony is much harder to deal with). I'd recommend starting with a thorough search of the off-the-shelf solutions, and only start work on your own if there's nothing acceptable out there.

The other part of the process you'd need is something to render the MIDI output as a traditional musical score, but there are umpteen billion products that do that.

Another answer is: yes, I've done a lot of digital signal processing (see the software on my website - it's an infinite-voice software synthesizer written in VB and C), and I'm interested in helping you with this problem. The WAV-to-MIDI part isn't really that difficult conceptually, it's just making it work reliably in practice that's hard. Note onset is just setting a threshold - errors can be easily adjusted forward or backward in time to compensate for note attack differences. Pitch detection is much easier to do on a recording than it is to do in real time, and involves just implementing an auto-correlation routine.

* * *

## 回答 #3

> 赞同：4
> 
> 时间：2008-11-17T19:56:26.850

You should look at [MIRToolbox](http://www.jyu.fi/hum/laitokset/musiikki/en/research/coe/materials/mirtoolbox) - it is written for Matlab, and has an onset detector built in - it works pretty well. The source code is GPL'd, so you can implement the algorithm in whatever language works for you. What language is your production code going to use?

* * *

## 回答 #4

> 赞同：3
> 
> 时间：2008-11-17T02:23:34.790

this library is centered around audio labeling:

[aubio](http://aubio.org/)

> aubio is a library for audio labelling. Its features include segmenting a sound file before each of its attacks, performing pitch detection, tapping the beat and producing midi streams from live audio. The name aubio comes from 'audio' with a typo: several transcription errors are likely to be found in the results too.

and I have had good luck with it for onset detection and pitch detection. It's in c, but there is swig/python wrappers.

also, the author of the library has a pdf of his thesis on the page, which has great info and background about labeling.

* * *

## 回答 #5

> 赞同：3
> 
> 时间：2012-03-13T20:50:17.373

Hard onsets are easily detected in the time domain by using an average energy measurement.

SUM from 0 to N (X^2)

Do this with chunks of the entire signal. You should see peaks when onsets occur (the window size is up to you, my suggestion is 50ms or more).

**Extensive Papers on Onset Detection:**

For Hardcore Engineers:

[http://www.nyu.edu/classes/bello/MIR_files/2005_BelloEtAl_IEEE_TSALP.pdf](http://www.nyu.edu/classes/bello/MIR_files/2005_BelloEtAl_IEEE_TSALP.pdf)

Easier for average person to understand:

[http://bingweb.binghamton.edu/~ahess2/Onset_Detection_Nov302011.pdf](http://bingweb.binghamton.edu/~ahess2/Onset_Detection_Nov302011.pdf)

* * *

## 回答 #6

> 赞同：-1
> 
> 时间：2008-11-17T03:40:57.490

You could try to transform the wav signal into a graph of amplitude against time. Then a way to determine a consistent onset is to calculate the intersection of a tangent in the inflection point of the rising flank of a signal with the x axis.

# python - 如何通过登录找到用户 ID（*NIX 下的 Python）

> ID：294470
> 
> 赞同：12
> 
> 时间：2008-11-16T22:11:25.050
> 
> 标签：python, linux, unix, process-management

我需要将我的进程设置为在 'nobody' 下运行，我找到了 os.setuid()，但是`uid`如果我有，我该如何找到`login`？

我发现 uid 在 /etc/passwd 中，但也许有比扫描 /etc/passwd 更 Python 的方式。有人吗？

* * *

## 回答 #1

> 赞同：21
> 
> 时间：2008-11-16T22:19:52.550

您可能想查看 python stdlib 中的[pwd](http://docs.python.org/library/pwd.html)模块，例如：

```
import pwd
pw = pwd.getpwnam("nobody")
uid = pw.pw_uid 
```

它使用 /etc/passwd （好吧，从技术上讲，它使用 posix C API，所以我想如果它不使用 /etc/passwd 但暴露了所需的功能，它可能在操作系统上工作）但比手动解析更干净

* * *

## 回答 #2

> 赞同：5
> 
> 时间：2008-11-16T23:10:39.733

切勿直接扫描`/etc/passwd`。

例如，在我管理的 Linux 系统上，用户帐户不在 LDAP 服务器上`/etc/passwd`，而是在 LDAP 服务器上。

正确的方法是使用`getpwent`/`getgrent`和相关的 C 函数（如@TFKyle 的答案），它将获取每个系统的正确方法的信息（在 Linux glibc 上，它读取`/etc/nsswitch.conf`以了解要加载哪些 NSS 动态库以获取信息）。

# asp.net - 'System.Web.UI.ScriptManager' 类型不明确：它可能来自程序集

> ID：294485
> 
> 赞同：0
> 
> 时间：2008-11-16T22:22:22.233
> 
> 标签：asp.net, ajax

当我运行我的 asp.net 应用程序时，我得到了错误

> 'System.Web.UI.ScriptManager' 类型不明确：

我遇到了同样的问题，这个人遇到了[http://forums.asp.net/t/1313257.aspx](http://forums.asp.net/t/1313257.aspx)，当我将 1.0.61025.0 更改为 3.5 并重新编译时，它会将其重置为 1.0.61025.0

我能做些什么来解决这个问题。我一直试图让我的应用程序运行几个小时。

谢谢

编辑~HELPPpppppppppppppppppppppppppppppppppppppppppppppppppppppppppppppppppp

我在 GAC 中看到了 2 个 system.web.extensions。我尝试使用 gacutil.exe /u system.web.ext ensions, Version=1.0.61025.0, Culture=neutral, PublicKeyToken=31bf3856ad364e35 Microsoft (R) .NET Global Assembly Cache Utility 删除。版本 2.0.50727.42 版权所有 (c) Microsoft Corporation。版权所有。

未知选项：版本 = 1.0.61025.0 我做错了什么。

编辑~我的解决方案

> 我去了“添加删除程序”并卸载了 Ajax Web Extensions 2.0 版本 1.0.61025.0

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2011-11-26T06:24:26.963

您需要注释掉对 System.Web.Extensions 和 System.Web.Extensions.Design 的旧引用，并在 web.config 中添加 3.5 的引用：

```
 <!-- <add assembly="System.Web.Extensions.Design, Version=1.0.61025.0, Culture=neutral, PublicKeyToken=31BF3856AD364E35"/> -->
    <!-- <add assembly="System.Web.Extensions, Version=1.0.61025.0, Culture=neutral, PublicKeyToken=31BF3856AD364E35"/> -->
    <add assembly="System.Web.Extensions, Version=3.5.0.0, Culture=neutral, PublicKeyToken=31BF3856AD364E35"/>
    <add assembly="System.Web.Extensions.Design, Version=3.5.0.0, Culture=neutral, PublicKeyToken=31BF3856AD364E35"/> 
```

为了防止它们被重新添加，您需要使用 gacutil 从 GAC 中删除 1.0 版本：

```
 C:> cd C:\Program Files\Microsoft Visual Studio 8\SDK\bin
    C:\Program Files\Microsoft Visual Studio 8\SDK\bin>gacutil /u "System.Web.Extensions, Version=1.0.61025.0, Culture=neutral, PublicKeyToken=31BF3856AD364E35" 
```

如果您必须删除参考，您可以尝试

```
 gacutil /u /r "System.Web.Extensions, Version=1.0.61025.0, Culture=neutral, PublicKeyToken=31BF3856AD364E35" FILEPATH C:\WINDOWS\system32\msiexec.exe "Windows Installer" 
```

[http://msdn.microsoft.com/en-us/library/ex0ss12c(v=VS.71).aspx](http://msdn.microsoft.com/en-us/library/ex0ss12c(v=VS.71).aspx)将是您对语法的参考。以上是我试图从 Windows 安装程序中删除对 DLL 的引用，但它不起作用，因为它是一个注册表引用，而不是一个 FILEPATH 引用，或者一个 FILEPATH 可以删除，我猜。无论我需要什么，网站上都没有提供。因此，我进入了“System.Web.Extensions”的注册表。我在 HKEY_CURRENT_USER\Software\Microsoft\Installer\Assemblies\Global 下找到了它的条目，以及它的“设计”版本。在我删除这两个条目后，我可以使用我在那里的第一个 gacutil 命令删除它们就好了（为“设计”重新运行它）。&%$#微软！！！

-汤姆

PS 如果你没有 VS 2005 的 SDK，你也可以在 C:\WINDOWS\Microsoft.NET\Framework\v1.1* 访问 gacutil。或者只是去 C:\WINDOWS\Assembly 并找到正确的（小心！！）然后按 Delete。

PPS 如果您有 AJAX 控制工具包并且它会自动将 1.0 DLL 刷新到您的 Bin 中，您可能会遇到这些“模糊引用”错误之一——它可能不知道是使用 GAC 还是您的 Bin 用于 3.5 DLL。在这种情况下，我必须将这些条目添加到我的 ASPX 页面的顶部：

```
 <%@ Assembly Name="System.Web.Extensions, Version=3.5.0.0, Culture=neutral, PublicKeyToken=31BF3856AD364E35" %>
    <%@ Assembly Name="System.Web.Extensions.Design, Version=3.5.0.0, Culture=neutral, PublicKeyToken=31BF3856AD364E35" %> 
```

我可能很容易就可以将它们制作为 1.0 版本，然后看看是否可行……

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2008-11-16T22:39:20.640

看起来您（可能间接地）引用了旧的 System.Web.Extensions DLL。检查您的配置文件并在您的应用程序中搜索“System.Web.Extensions”。还要确保旧版本不在您的 bin 文件夹中（并且不会被复制到那里）。

确保您没有使用任何其他使用旧 System.Web.Extensions DLL 的库，即 AJAX Toolit 1.0.x。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-12-16T22:50:43.570

解决此问题的新方法是将其添加到 Web 配置中

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2008-11-16T22:39:30.873

更新您的项目引用并清理您的 bin 目录。Asp.net 正在从 bin 加载以前版本的 AJAX

确保删除： - System.Web.Extensions.dll - System.Web.Extensions.Design.dll
- AjaxToolkit.dll 的旧版本

# .net - .net 中带点的语义 url

> ID：294495
> 
> 赞同：25
> 
> 时间：2008-11-16T22:31:33.417
> 
> 标签：.net, iis, routing

我正在尝试为搜索页面制作语义 url，但如果有人使用点中完成的搜索，.net 引擎会返回 404。

该请求甚至没有到达路由引擎，所以我认为它与安全或类似的东西有关。

例如，stackoverflow 路由在这些情况下也不起作用： [https://stackoverflow.com/questions/tagged/etc](https://stackoverflow.com/questions/tagged/etc)。

* * *

## 回答 #1

> 赞同：24
> 
> 时间：2010-08-22T17:34:31.577

如果您使用的是 .NET 4.0 和 IIS 7+，您可以在 web.config 的 system.web 部分设置此标志，并且允许：

```
<httpRuntime relaxedUrlToFileSystemMapping="true" /> 
```

我已经对其进行了测试，并且可以正常工作。[哈克](http://haacked.com/archive/2010/04/29/allowing-reserved-filenames-in-URLs.aspx)对此进行了解释。

* * *

## 回答 #2

> 赞同：8
> 
> 时间：2008-11-30T14:24:08.843

'.' 之后的所有内容 是文件扩展名。如果该扩展没有映射到 ASP.NET，它就不会被移交给 ASP.NET 处理程序。IIS 改为查找静态文件。因此是 404。如果它没有添加任何东西（而且很难看出它会如何），我建议将其剥离。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2010-03-29T22:30:32.110

当尾随句点不重要时（如[https://stackoverflow.com/questions/tagged/etc.](https://stackoverflow.com/questions/tagged/etc.)的情况），您可以使用 IIS 的 URL 重写模块来去除尾随句点。

**模式**：`^(.*[^.])(\.+)$`
**重写 URL：** `{R:1}`

当丢弃句点不是一种选择时，这将无济于事，或者在中间路径段的末尾有句点，但对于处理通过自动链接算法附加到 URL 的句点的非常真实的用例它可以提供帮助。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2008-11-16T22:45:07.447

看起来 IIS 可能不知道如何处理带有空扩展名的请求。

右键单击该网站并选择“属性”。单击“主目录”选项卡上的“配置...”。查看“应用程序扩展”并尝试添加空扩展名或通配符扩展名。

* * *

## 回答 #5

> 赞同：-2
> 
> 时间：2008-11-30T12:53:16.077

在 Windows 中，文件名不能以“.”结尾 我认为所有问题都源于那里，即 IIS 不知道如何处理它，因此它永远不会到达 ASP.NET 错误处理程序并通过默认 IIS 404 页面获取句柄。

大多数搜索引擎（[无论如何都是谷歌](http://www.google.com/support/bin/answer.py?hl=en&answer=430)）从查询中排除标点符号，我认为你的也应该这样做。

编辑：它因为没有文件类型而崩溃，甚至微软网站也崩溃了[http://www.microsoft.com/en/us/fallover](http://www.microsoft.com/en/us/fallover)。但您可以修改默认错误文件（位于 C:\WINDOWS\help\iisHelp\common 之类的位置）或完全更改它。

看看这个：[配置自定义错误消息 (IIS 6.0)](http://www.microsoft.com/technet/prodtechnol/WindowsServer2003/Library/IIS/80cb8d8d-8fd8-4af5-bb3b-4d11fff3ab9c.mspx?mfr=true)

* * *

## 回答 #6

> 赞同：-2
> 
> 时间：2008-11-30T13:45:28.610

您不应该将精确的用户搜索放在这样的查询字符串中......您应该对它们进行 UrlEncode。这将解决问题。

# javascript - 如何使用 jQuery 和 blockUI 让 DIV 以页面为中心？

> ID：294502
> 
> 赞同：13
> 
> 时间：2008-11-16T22:35:54.140
> 
> 标签：javascript, jquery, css, blockui

我正在尝试转换 Matt Berseth 的“ [YUI Style Yes/No Confirm Dialog](http://mattberseth.com/blog/2007/10/yui_style_yesno_confirm_dialog.html) ”，以便可以将它与 jQuery blockUI 插件一起使用。

我不得不承认我不是 CSS 大师，但我认为即使对我来说这也很容易......除了 10 小时后，我不知道为什么我不能让这该死的东西工作。

问题是我似乎无法让 'confirmDialogue' DIV 在页面上居中，而上面没有显示一些工件。或者，如果我通过这样做重置 blockUI 的 CSS 设置......：

```
$.blockUI.defaults.css = {}; 
```

.....我发现 DIV 左对齐。

我已经尝试了各种各样的东西，但 CSS 并不是我作为服务器端应用程序的强项:(

因此，如果有任何 jQuery/blockUI/CSS 向导阅读此内容的人...请您试一试，让我知道我做错了什么吗？

基本上我遵循了马特博客上的设计模板，HTML 看起来像下面的东西（CSS 与马特的示例没有变化）。[您可以从http://mattberseth2.com/downloads/yui_simpledialog.zip](http://mattberseth2.com/downloads/yui_simpledialog.zip)的完整示例项目下载中获取 png 'sprite' 文件- 这是一个 .net 项目，但我只是想让它在一个简单的 html 中工作文件，因此不需要 .NET 知识。

无论如何，任何建议和指导都会非常非常有用。如果我们见面，我什至会鼓励购买承诺给你买啤酒的东西：）

```
<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN"
   "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml" >
<head>
  <title></title>
  <script type="text/javascript" src="script/jquery-1.2.6.js"></script>
  <script type="text/javascript" src="script/jquery.blockUI.js"></script>
  <style>
  .modalpopup
  {
    font-family: arial,helvetica,clean,sans-serif;
    font-size: small;
    padding: 2px 3px;
    display: block;
    position: absolute;
  }

  .container
  {
    width: 300px;
    border: solid 1px #808080;
    border-width: 1px 0px;
  } 

  .header
  {
    background: url(img/sprite.png) repeat-x 0px -200px;  
    color: #000;  
    border-color: #808080 #808080 #ccc;
    border-style: solid;
    border-width: 0px 1px 1px;
    padding: 3px 10px;
  } 

  .header .msg
  {
    font-weight: bold;
  }         

  .body
  {
    background-color: #f2f2f2;
    border-color: #808080;
    border-style: solid;
    border-width: 0px 1px;
    padding-top: 10px;
    padding-left: 10px;
    padding-bottom: 30px;
  } 

  .body .msg
  {
    background: url(img/sprite.png) no-repeat 0px -1150px;  
    float: left;
    padding-left: 22px;
  }  

  .footer
  {
    background-color: #f2f2f2;
    border-color: #808080;
    border-style: none solid;
    border-width: 0px 1px;
    text-align:right;
    padding-bottom: 8px;
    padding-right: 8px;
  } 

  .close
  {
    right: 7px;  
    background: url(img/sprite.png) no-repeat 0px -300px;  
    width: 25px;  
    cursor: pointer;  
    position: absolute;  
    top: 7px;  
    height: 15px;
  }

  .modalBackground 
  {
    background-color:Gray;
    filter:alpha(opacity=50);
    opacity:0.5;
  }     

  </style>
</head>

<body>

<input id="triggerDialogue" name="triggerDialogue" type="button" value="Go" />

<div id="confirmDialogue" 
     class="modalpopup" style="display:none; text-align: center">
  <div class="container">
    <div class="header">
      <span class="msg">Are you sure?</span>
      <a onclick="return false;" class="close" 
         href="javascript: return false;"></a>
    </div>
    <div class="body">
      <span class="msg">Do you want to continue?</span>
    </div>
    <div class="footer">
      <input type="button" id="Button1" value="Yes" style="width:40px" />
      <input type="button" id="Button2" value="No" style="width:40px" />   
    </div>                                                
  </div>
</div>   

<script type="text/javascript">
  $(document).ready(function() {
    $('#triggerDialogue').click(function() {
      $.blockUI({ message: $('#confirmDialogue') });
    });
  });
</script>
</body>
</html> 
```

@Owen - 非常感谢。我不得不在 Matt 的样式表中的 .modalPopup CSS 类中做一点小改动：

```
position: fixed; 
```

....它的工作原理。非常感激。我真的要坐下来看我的[O'Reilly CSS 书](http://oreilly.com/catalog/9780596527334/)，我从来没有机会在某个晚上阅读.... :)

* * *

## 回答 #1

> 赞同：8
> 
> 时间：2008-11-16T23:10:15.023

嗯，我对 blockUI 不太熟悉，但是居中 div 的基础知识非常普遍。我假设您希望您的`#confirmDialogue`div 在整个屏幕中居中？

如果是这样，你想做一些事情：

```
#confirmDialogue {
    position: fixed;    // absolutely position this element on the page
    height: 200px;      // define your height/width so we can calculate with it after
    width: 300px;
} 
```

现在你的jQuery：

```
$('#triggerDialogue').click(function() {
    // to position #confirmDialogue, we need the window height/width
    var msg = $('#confirmDialogue');
    var height = $(window).height();
    var width = $(document).width();

    msg.css({
        'left' : width/2 - (msg.width() / 2),  // half width - half element width
        'top' : height/2 - (msg.height() / 2), // similar
        'z-index' : 15,                        // make sure element is on top
    });

    // etc...
}); 
```

基本上，您想要固定您的位置`#confirmDialogue`（以便您可以相对于窗口/文档的大小定位它。`left`声明`top`是根据元素当前高度/宽度以及窗口的高度和文档宽度计算的。

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2011-04-07T10:40:31.190

看看这个[jQuery MSG 插件](http://dreamerslab.com/blog/en/jquery-blockui-alternative-with-jquery-msg-plugin/)。它重量很轻，易于使用。

### 示例代码

```
// default usage, this will block the screen and shows a 'please wait...' msg
$.msg();

// this will show a 'blah blah' msg
$.msg({ content : 'blah blah' }); 
```

更多选项请看这个[演示](http://dreamerslab.com/demos/jquery-blockui-alternative-with-jquery-msg-plugin)

完整的文档请看[这篇文章](http://dreamerslab.com/blog/en/jquery-blockui-alternative-with-jquery-msg-plugin/)。下载和源代码链接包含在帖子中。

或者如果你只是想集中一些 DOM 元素，你也可以试试这个[插件](http://dreamerslab.com/blog/en/centralize-html-dom-element-with-jquery-center-plugin/)

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2008-11-17T00:00:40.820

您可能会在这里找到一些有用的信息。[使用 jQuery 使 DIV 在屏幕上居中](https://stackoverflow.com/questions/210717/what-is-the-best-way-to-center-a-div-on-the-screen-using-jquery)

* * *

## 回答 #4

> 赞同：2
> 
> 时间：2010-02-25T12:10:01.080

你也可以试试 jquery ui 对话框[http://jqueryui.com/demos/dialog/](http://jqueryui.com/demos/dialog/)

# python - Python UPnP/IGD 客户端实现？

> ID：294504
> 
> 赞同：12
> 
> 时间：2008-11-16T22:38:41.170
> 
> 标签：python, networking, nat, upnp

[我正在寻找 Python 中UPnP](http://elinux.org/UPnP)客户端的开源实现，更具体地说，是它的[Internet 网关设备](http://en.wikipedia.org/wiki/Internet_Gateway_Device_Protocol)(IGD) 部分。

目前，我只能在[PyMediaServer](http://pymediaserver.sourceforge.net/)、[PyMedS](http://resnet.uoregon.edu/~gurney_j/jmpc/pymeds.html)、[BRisa](http://brisa.garage.maemo.org/)或[Coherence](https://coherence.beebits.net/)等项目中找到 UPnP 媒体服务器实现。

我确信我可以使用这些代码库作为开始，但媒体服务器部分会引入不必要的复杂性。

那么你能推荐一个客户端 UPnP（希望是 IGD）Python 库吗？另一种方法是将调用分派给[MiniUPnP](http://miniupnp.free.fr/)等 C 库，但我更喜欢纯 Python 实现。

更新：关于 SSDP 和 UPnP 的有趣的相关讨论可在[StackOverflow](https://stackoverflow.com/questions/22321/remoting-server-auto-discovery-broadcast-or-not)上找到。

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2008-11-18T07:26:00.497

MiniUPnP 源代码包含一个 Python 示例代码，它使用 C 库作为扩展模块（请参阅 参考资料`testupnpigd.py`），我认为这是解决我的问题的合适方法。

理由：这不是我正在寻找的纯 Python 解决方案，而是：

*   已经在这个图书馆投入了大量的精力，
*   它是轻量级的（它不解决媒体服务器问题），
*   IGD 通常仅用于连接设置，因此不将其与 Python 代码更紧密地集成似乎不是问题，
*   作为奖励，它还提供了 NAT-PNP 实现（IGD 的 Apple 并发，[Bonjour](http://developer.apple.com/networking/bonjour/specs.html)的一部分）。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2008-12-01T18:30:28.017

我认为你真的应该考虑 BRisa。它最近变成了一个纯 Python UPnP 框架，不仅仅专注于媒体服务器。

它提供了大量实用模块和功能，供您构建和部署 UPnP 设备。

该项目也缺乏反馈:-)。如果你愿意尝试 BRisa，我建议你使用最新的 svn 代码。

您也可以在 irc.freenode.org 上通过#brisa 联系开发人员，我们要么在线，要么空闲。

# php - 无法从本地主机通过 cURL 访问网站，但可以从托管服务器访问网站

> ID：294517
> 
> 赞同：1
> 
> 时间：2008-11-16T22:56:32.773
> 
> 标签：php, xml, curl, screen-scraping

我正在编写一个使用 PHP 5 和 cURL 从 wowarmory.com 提取 XML 数据的脚本：

```
$url = "http://www.wowarmory.com";
$userAgent = 'Mozilla/5.0 (Windows; U; Windows NT 6.0; en-US; rv:1.8.1.12) Gecko/20080201 Firefox/2.0.0.12';

$ch = curl_init();
curl_setopt($ch, CURLOPT_USERAGENT, $userAgent);
curl_setopt($ch, CURLOPT_URL,$url);
$str  = "Accept: text/html,application/xhtml+xml,application/xml;q=0.9,*/*;q=0.8\r\n";
$str .= "Accept-Language: en-us,en;q=0.5\r\n";
$str .= "Accept-Charset: ISO-8859-1,utf-8;q=0.7,*;q=0.7\r\n";
$str .= "Keep-Alive: 300\r\n";
$str .= "Connection: keep-alive\r\n";
curl_setopt($ch, CURLOPT_HTTPHEADER, array($str));
curl_setopt($ch, CURLOPT_FAILONERROR, true);
curl_setopt($ch, CURLOPT_FOLLOWLOCATION, true);
curl_setopt($ch, CURLOPT_AUTOREFERER, true);
curl_setopt($ch, CURLOPT_RETURNTRANSFER,true);
curl_setopt($ch, CURLOPT_TIMEOUT, 3000);
$xml = curl_exec($ch); 
```

当我从我的托管 Web 服务器运行它时，我得到了预期的 XML 响应。但是从我的本地主机网络服务器运行时，我什么也得不到。

我可以通过 cURL 从 localhost（yahoo.com，甚至 worldofwarcraft.com）获取任何其他网站，但不能获取 wowarmory.com。所以我知道 cURL 运行正常。

我正在使用以下版本的 PHP 和 cURL：

托管服务器：

*   php 5.2.6
*   cURL libcurl/7.16.1 OpenSSL/0.9.7e zlib/1.2.3

本地主机：

*   php 5.2.6
*   cURL libcurl/7.16.0 OpenSSL/0.9.8i zlib/1.2.3

有任何想法吗？

编辑：本地主机正在运行 Windows XP SP3。我可以通过网络浏览器访问 wowarmory.com。Tracert 在第 13 跳开始超时（显然是从我的位置开始）：

```
13   458 ms   529 ms   549 ms  0.so-6-0-0.BR1.LAX15.ALTER.NET [152.63.116.21]
14   476 ms   510 ms   488 ms  192.205.34.29
15   257 ms   279 ms   261 ms  cr1.la2ca.ip.att.net [12.122.128.14]
16   242 ms   259 ms   249 ms  gar5.la2ca.ip.att.net [12.122.128.25]
17   252 ms     *     1691 ms  12.122.255.74
18     *     2361 ms   634 ms  mdf001c7613r0003-gig-10-1.lax1.attens.net [12.129.193.242]
19     *        *        *     Request timed out. 
```

不幸的是，我不熟悉 tcptraceroute。

curl 的 Windows 二进制版本不会为 http://www.wowarmory.com/ 返回任何内容，[但](http://www.wowarmory.com/)会为[http://www.yahoo.com/返回任何内容](http://www.yahoo.com/)

我没有 wget 可用。

编辑2：我可以访问我的本地化网站就好了。这只是我没有收到 curl 的回复。我正在运行一个几乎默认的 XAMPP 安装（windows xp 上的 apache 2）。所有这一切都很好。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2008-11-16T23:25:08.643

您可以通过 Web 浏览器甚至通过命令行实用程序从本地主机访问它`curl`吗`wget`？

`tcptraceroute`告诉你什么？

如果 Web 浏览器和命令行实用程序都不能工作，但`tcptraceroute`可以工作（并且没有在某处显示透明代理），并且您位于 DSL 链接后面，那么您的问题可能是[PMTU blackhole](http://en.wikipedia.org/wiki/PMTU_blackhole)。如果是这种情况，解决方法是[MSS 钳位](http://en.wikipedia.org/wiki/MSS_clamping)。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2011-07-05T09:12:55.707

api 可能会将响应返回给某个 URL（比如 nextUrl 或 currentUrl）。如果您的 URL 是 localhost 或本地系统 IP 地址，api 响应如何以及在何处返回..？因为 api 将响应 nextUrl() 或 currentUrl()。所以请使用永久IP或域名来工作。

# c++ - 有哪些代码生成技术？

> ID：294520
> 
> 赞同：3
> 
> 时间：2008-11-16T22:58:22.520
> 
> 标签：c++, python, code-generation

我正在生成 C++ 代码，看起来它会变得非常混乱，即使我的简单生成类已经有大量的特殊情况。这是现在的代码：http: [//github.com/alex/alex-s-language/tree/local%2Fcpp-generation/alexs_lang/cpp](http://github.com/alex/alex-s-language/tree/local%2Fcpp-generation/alexs_lang/cpp)。

* * *

## 回答 #1

> 赞同：9
> 
> 时间：2008-11-16T23:06:18.823

我编写[Cog](http://nedbatchelder.com/code/cog/index.html)部分是为了从 XML 数据模式生成 C++ 代码。它允许您使用嵌入在 C++ 源文件中的 Python 代码来生成 C++ 源代码。

* * *

## 回答 #2

> 赞同：7
> 
> 时间：2008-11-16T23:12:17.750

我用于代码生成的一种技术是完全不用担心代码生成器中的格式。然后，作为生成代码后的下一步，运行它[`indent`](http://www.gnu.org/software/indent/)以合理地格式化它，以便您可以阅读（更重要的是，调试）它。

* * *

## 回答 #3

> 赞同：5
> 
> 时间：2008-11-16T23:23:00.333

请参阅[构建测试用例的工具](http://homepage.mac.com/s_lott/iblog/architecture/C20071019092637/E20080830091128/index.html)。

目前尚不清楚您的问题是什么。

如果您的问题是“我如何处理生成类中的所有特殊情况？” 那么这里有一些建议。如果您的问题是其他问题，请更新您的问题。

1.  使用模板生成器。 [例如， Mako](http://www.makotemplates.org/)会让您的生活更简单。

    写一个你的结果的例子。`${thing}`用占位符替换零件。由于您从可行的东西开始，因此将其转换为模板很容易。

2.  当用另一种语言生成代码时，您需要将所有其他语言的类定义设计为灵活的汇编。您希望生成尽可能少的新鲜代码。您想稍微调整和自定义，但又不想从头开始生成很多东西。

3.  特殊情况最好用普通多态处理。公共超类的单独子类可以实现各种异常和特殊情况。**策略**设计模式 可以很好地处理真正复杂的情况。

    本质上，您拥有代表现实世界对象的 Python 类。这些类具有可以适应 C++ 模板的属性，以生成这些对象的 C++ 版本。

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2008-11-21T14:32:36.767

我同意 S.Lott 的观点，你应该写出一个你想要生成的例子。

解决代码生成问题应该比没有解决问题简单。

这是因为您的整个程序必须处理大量输入信息，并且如果该信息的子集很少更改，例如每周一次，则代码生成器只需要以该子集为条件。剩余输入的生成代码条件更频繁地更改。这是一种分而治之的策略。它的另一个名称是“部分评估”。

生成的代码也应该运行得更快，因为它不太通用。

在您的特定情况下，在 2 次（或更多次）通道中进行代码生成没有害处。就像在第 1 阶段一样，您会生成声明。在通过 2 时，您生成过程代码。或者，您可以生成两个输出流，并在最后连接它们。

希望有帮助。对不起，如果我只是说显而易见的话。

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2012-03-04T18:54:59.930

正如 Ned 所建议的，Cog 是编写样板代码的绝佳工具。例如，我必须为某些类编写 AOP 风格的事件系统支持，它会像这样工作：

*   你为一个类声明一个方法
*   对于每个方法，都需要在调用时触发一个事件，将方法的参数作为事件参数传递

所以我做了一个特殊的 python 声明函数，我会在一个 cog 区域上调用它，它会为每个方法和事件生成样板声明和定义。在 cog 区域的末尾，用户放置一个隐藏实现并由 AOP 包装器调用的函数的代码块，大致如下：

```
class MyFoo
{

public:
/*[[[cog
import myAOPDeclarators
AOP = myAOPDeclarators.AOP

AOP.declareAOPInterceptorMethod( 'invokeSomeStuff' , '(int param1, std::string param2)' )
]]]*/
//AOP wrapper
void invokeSomeStuff_ImplementationAOP(int param1, std::string param2);
void invokeSomeStuff(int param1, std::string param2) {
 sendAOPPreEvent( param1 , param2 , "invokeSomeStuff" );
 invokeSomeStuff_ImplementationAOP( param1 , param2);
}
void invokeSomeStuff_ImplementationAOP(int param1, std::string param2)
//[[[end]]]
{
// ...invokeSomeStuff implementation, not automatically generated
} 
```

我可以为您提供代码生成的最佳指南是；**使您生成的代码与您手写的代码一样具有可读性**。它使代码生成的使用变得透明（甚至比模板代码更透明，购买 YMMV），当然，正如 Greg 建议的那样，缩进可以在之后应用，因此将缩进修补与代码生成混合起来真的没有任何意义如果一个工具无论如何都可以对源文件进行后处理

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2008-11-16T23:25:26.740

我有一个代码生成系统，我使用它的最佳选择之一是将大部分生成的程序放在非生成代码中，例如库/运行时。使用模板也很有效。复杂的模板系统可能很难手动使用，但您不能手动使用它们，因此请利用这一点。

* * *

## 回答 #7

> 赞同：0
> 
> 时间：2008-11-16T23:41:31.420

它实际上只是直接递归，除了我需要将所有函数声明拉出并将它们放在其他地方，并且对于所有函数调用我需要构建所有参数的向量，然后将其传递给函数，因为 C++ 没有向量的语法。

* * *

## 回答 #8

> 赞同：0
> 
> 时间：2012-10-19T19:37:06.567

我也在寻找类似的东西并发现了这个问题。我对 cog 不是很满意，所以我最终编写了自己的类似但添加了一些 (imo) 非常需要的功能。

[https://github.com/icholy/swapm](https://github.com/icholy/swapm)

# c# - 为什么在我的已发送邮件文件夹上停止处理 ItemAdd 事件？

> ID：294529
> 
> 赞同：4
> 
> 时间：2008-11-16T23:06:46.670
> 
> 标签：c#, outlook, event-handling

由于某种原因，我在保持事件句柄处于活动状态时遇到了一些麻烦。

我的项目是一个 Outlook 插件，它会在用户发送电子邮件时提示他们做某事。现在，我有一个连接到“已发送邮件”文件夹的事件处理程序，以便当发送的电子邮件到达该文件夹时，它会触发提示。我将它附加到已发送邮件文件夹的原因是我可以在发送后处理电子邮件。

最初一切都很好，然后我把它放到客户端机器上，事件根本不想触发。这是我将另一个事件（最初是为了弄清楚发生了什么）附加到 onSend 事件的时候。这样做是调用一个单例类，它将我需要的句柄附加到 Sent Items 文件夹，以便不会多次重新创建句柄。（我确实没有单例类，而是在最初附加句柄时有一个全局标志来切换，但这没有什么不同）

我希望这一切都有意义！

不过现在发生的情况是，在某些情况下，前几封电子邮件会按照他们应该的方式回复；即在发送后提示。在此之后它停止提示，我不知道为什么。

我希望也许有一种方法可以检查事件句柄是否直接存在。我唯一的另一个想法是，也许我设置的手柄正在以某种方式被清理？

如果有人有任何建议可以帮助我弄清楚发生了什么，我将不胜感激。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2008-12-15T16:33:35.173

经典的 garabe 收集错误，请尝试在您的代码中保留对文件夹的引用。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2008-12-03T01:50:34.307

它正在收集车库。如果您发布一些代码，我可能会提供帮助。

# sql - 左外连接（三个表之间的连接）？

> ID：294543
> 
> 赞同：1
> 
> 时间：2008-11-16T23:14:03.567
> 
> 标签：sql, db2, left-join

我有一个必须从中获取数据的主表。我有一个左外连接，其中字段将匹配 40% 的时间。然后我有另一个连接，我需要将表 A 中的数据与之匹配。

这是伪代码中的 SQL。此查询不起作用。

- 这是我想做但不起作用的部分。AND H.COL3 = A.STATE????

我正在使用 IBM DB2。

```
SELECT DISTINCT
  APP_NO as app_no,
  A.STATE as state
  ...
  ... Fields
  ...
FROM 
  TABLE_A A
LEFT OUTER JOIN  
  TABLE_B HIST
ON
  HIST.COL1 = A.COL1
, TABLE_C B  
LEFT OUTER JOIN
  TABLE_D H  
ON
  H.COL2 = B.COL2
-- This is the part I want to do but doesn't work.
AND
  H.COL3 = A.STATE????
WHERE
  A.BRANCH = 'Data' 
```

* * *

## 回答 #1

> 赞同：13
> 
> 时间：2008-11-16T23:46:11.690

我认为你可以像这样重写它（但我可能读错了你的陈述）

```
FROM 
  TABLE_A A LEFT OUTER JOIN TABLE_B HIST ON
      HIST.COL1 = A.COL1
  LEFT OUTER JOIN TABLE_D H ON 
      H.COL3 = A.STATE
  LEFT OUTER JOIN TABLE_C B ON H.COL2 = B.COL2
WHERE
  A.BRANCH = 'Data' 
```

此外，有关此错误的 IBM doco 指出：

与 JOIN 运算符或 MERGE 语句关联的 ON 子句无效。解释：

**ON 子句中的列引用只能引用 ON 子句范围内的表的列。**

所以我可能弄错了，当外部连接“H.COL3 = A.STATE”超出 On 子句的范围时，它看起来就像错误的 ON 子句，因为表 A 不在该范围内。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2008-11-16T23:34:29.047

如果将“AND H.COL3 = A.STATE”放在 WHERE 子句中会发生什么？

# c# - 带有命令的目录结构。

> ID：294545
> 
> 赞同：1
> 
> 时间：2008-11-16T23:18:18.533
> 
> 标签：c#, projects-and-solutions, directory-structure

我有一个 winforms 项目，我们使用命令模式。我们正在尝试清理我们的目录结构并使其保持一致。

我们正在尝试决定是否应该有一个根命令文件夹。你认为什么更适合目录结构？

项目
--Commands
----AddCommand
----SubtractCommand
----InsertCommand
----DeleteCommand

或者

项目
--Calculation
----AddCommand
----SubtractCommand
--Database
----InsertCommand
----DeleteCommand

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2008-11-16T23:34:21.807

似乎一般问题是您是要按动作/动词（即命令文件夹）还是按目标/名词（数据库、计算等文件夹）进行分类。无论您采用哪种方式，您都可能会尝试保持一致（对视图和小部件采用与对命令等相同的方法）。

我能想到的几点考虑：

*   Project/Database/etc 文件夹中是否还有其他内容，或者只有命令？如果只有命令，它可能会简化一些事情，只需要一个 Commands 文件夹，因此您不必为每个新命令决定一个好的顶级文件夹。例如，您在哪里放置对数据库值进行计算的命令？

*   如果您将拥有大量命令（其中“大”的定义有些不明确），那么拥有额外级别的目录可能会很好。

根据我的经验，如何组织代码的问题总是很烦人。如果一切都失败了，您应该选择一个选项并继续使用它，如果您确定您做出了错误的选择，请稍后重新安排。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2008-11-16T23:27:42.353

我个人喜欢第二种选择，但我认为你也可以这样做：

```
Project
-Commands
--Calculation
----AddCommand
----SubtractCommand
--Database
----InsertCommand
----DeleteCommand 
```

只是我的 2 美分

# .net - 新 {object} 与 {object} = 新 {object}

> ID：294553
> 
> 赞同：6
> 
> 时间：2008-11-16T23:25:04.823
> 
> 标签：.net, vb.net

我只是想知道这两个不同的新对象初始化器之间是否有任何区别，或者只是语法糖。

也是这样：

```
Dim _StreamReader as New Streamreader(mystream) 
```

并且不同于：

```
Dim _StreamReader as Streamreader = new streamreader(mystream) 
```

引擎盖下有什么区别吗？还是它们都一样？你更喜欢使用哪一个？

* * *

## 回答 #1

> 赞同：14
> 
> 时间：2008-11-16T23:33:13.307

在 VB.NET 中，它们是相同的。该`As New`变体是规范的。

在 VB6 中，它们的语义实际上不同（除了 VB6 不允许在声明中赋值的明显事实）：`As New`变体将创建一个永远不可能是`Nothing`. 相反，运行时将确保在每次访问对象之前始终正确初始化对象。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2008-11-17T00:36:51.590

这些陈述是相同的。我个人更喜欢“Dim x as New”语法，因为它更简洁。如果不产生程序差异，则没有理由在同一语句中编写相同的类型名称。它所做的只是让你花更多的时间在键盘上:)

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2008-11-16T23:29:52.270

我不是 VB 人，但据我所知，它们是等价的。根据[MSDN 对 Dim 语句的描述](http://msdn.microsoft.com/en-us/library/7ee5a7s1.aspx)：

> 如果不指定数据类型，则变量采用初始化程序的数据类型。如果既不存在数据类型也不存在初始值设定项，则默认情况下，数据类型为对象数据类型。如果同时指定数据类型和初始化程序，初始化程序的数据类型必须可转换为数据类型。

我不会就偏好发表评论，因为我不使用 VB（回答陈述时除外）。

# c++ - 我在哪里可以找到合适格式（不是 .html）的 C/C++ 用户日志存档？

> ID：294554
> 
> 赞同：0
> 
> 时间：2008-11-16T23:25:08.097
> 
> 标签：c++

这本杂志找了好久都找不到。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2008-11-17T00:27:04.463

几年前，他们与 frobbs 合并：[http](http://www.ddj.com/cpp/cuj.jhtml) ://www.ddj.com/cpp/cuj.jhtml 。你可能会在那里找到一些东西。

# sql - 我可以比较 MySQL 枚举吗？

> ID：294558
> 
> 赞同：11
> 
> 时间：2008-11-16T23:25:34.197
> 
> 标签：sql, mysql, enums, compare

我有一个枚举：`ENUM( 'alpha', 'beta', 'gamma', 'delta', 'omega' )`

如果我按此列对表格进行排序，我会按照上面定义的正确顺序得到它们。

但是，我找不到选择其中一个子集的方法，例如 delta 之前的所有内容。仅使用`WHERE status < 'delta'`返回 alpha 和 beta，而不是 gamma。似乎 MySQL 使用字符串比较，而不是枚举索引比较。

我可以使用索引号——即`WHERE status < 4`——但它有点代码味道（幻数），如果我在枚举中插入新值可能会中断。

* * *

## 回答 #1

> 赞同：9
> 
> 时间：2011-04-01T10:29:59.077

您可以使用`status+0`返回 ENUM 的索引，从 1 开始。

参考[http://serghei.net/docs/database/mysql/doc/E/N/ENUM.html](http://serghei.net/docs/database/mysql/doc/E/N/ENUM.html)

* * *

## 回答 #2

> 赞同：7
> 
> 时间：2008-11-17T18:35:44.530

您正在尝试对元数据使用数据操作方法，这肯定会很尴尬。

`ENUM`这是用查找表的外键替换 的一个很好的理由。然后，您可以使用传统的数据处理技术。

* * *

## 回答 #3

> 赞同：3
> 
> 时间：2009-10-13T02:05:49.923

刚刚遇到同样的问题。如果要对枚举字段进行排序，则必须先将其转换为字符串类型（在示例中，类别是我的枚举字段）：

```
SELECT
CONVERT(category USING utf8) as str_category 
FROM
example
GROUP BY
str_category
ORDER BY 
str_category 
```

容易！

* * *

## 回答 #4

> 赞同：2
> 
> 时间：2008-11-17T00:02:56.227

您可以使用它[`FIELD(column, "string1", "string2", ...)`](http://dev.mysql.com/doc/refman/5.0/en/string-functions.html#function_field)来查找具有任何特定可能`ENUM`值子集的行。

```
SELECT * FROM `table` WHERE FIELD(`enum_column`, "alpha", "delta", "et cetera"); 
```

如果要使用范围版本，可以使用[`FIND_IN_SET("needle", "hay,stack")`](http://dev.mysql.com/doc/refman/5.0/en/string-functions.html#function_find-in-set)返回索引，但必须先使用另一个查询从表定义中提取 ENUM 列表。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2014-07-30T15:27:45.117

创建一个函数：

```
CREATE fEnumIndex(_table VARCHAR(50), _col VARCHAR(50), _val VARCHAR(50))
RETURNS INT DETERMINISTIC
BEGIN
    DECLARE _lst VARCHAR(8192);
    DECLARE _ndx INT;

    SELECT REPLACE(REPLACE(REPLACE(COLUMN_TYPE,''', ''',','),'enum(',''),')','')
    FROM information_schema.COLUMNS WHERE TABLE_SCHEMA=DATABASE() AND
    TABLE_NAME=_table AND COLUMN_NAME=_col INTO _lst;
    SET _ndx = FIND_IN_SET(_val, _lst);
    RETURN _ndx;
END 
```

然后在查询中使用它，如下所示：

```
SELECT * FROM MyTable WHERE Status < fEnumIndex('MyTable','Status','delta') ; 
```

将`SELECT REPLACE(REPLACE(REPLACE(COLUMN_TYPE,''', ''',','),'enum(',''),')','')`接受`COLUMN_TYPE`诸如`ENUM( 'alpha', 'beta', 'gamma', 'delta', 'omega' )`并将其转换为逗号分隔的列表：`'alpha, beta, gamma, delta, omega'`。然后`FIND_IN_SET(_val, _lst)`获取索引。

唯一需要注意的是如何定义 ENUM（项目之间有或没有空格）和最内层`REPLACE`（在 from_string 中有或没有空格）。

# asp.net - 将所有请求路由到根文件夹（不允许斜杠）

> ID：294579
> 
> 赞同：0
> 
> 时间：2008-11-16T23:39:10.113
> 
> 标签：asp.net, asp.net-mvc, routes

我想在 url 的根文件夹中捕获所有 URL`www.example.com`

url 不能以斜杠结尾，也不能包含任何斜杠。

所以这些应该通过：

```
www.example.com/abc
www.example.com/abc123-asdf
www.example.com/abc123/  ** FAIL! 
```

此外，子文件夹，如：

```
www.example.com/asdfsd/asdf  ** FAIL! 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2008-11-17T00:37:25.130

What web server are you using? If you're using Apache, what you want is URL Rewriting (mod_rewrite)

[http://httpd.apache.org/docs/2.0/misc/rewriteguide.html](http://httpd.apache.org/docs/2.0/misc/rewriteguide.html)

It has full regular expression support. and can automatically change all offending requests to the default url for you.

# php - PHP 5 反射 API 性能

> ID：294582
> 
> 赞同：60
> 
> 时间：2008-11-16T23:41:58.533
> 
> 标签：php, performance, reflection

我目前正在考虑在我自己的 MVC Web 框架中使用反射类（主要是反射类和反射方法），因为我需要自动实例化控制器类并调用它们的方法而无需任何配置（“约定优于配置”方法）。

我担心性能，尽管我认为数据库请求可能比实际的 PHP 代码成为更大的瓶颈。

所以，我想知道从性能的角度来看，是否有人对 PHP 5 反射有任何好的或不好的经验。

此外，我很想知道是否有任何流行的 PHP 框架（CI、Cake、Symfony 等）实际上使用反射。

* * *

## 回答 #1

> 赞同：58
> 
> 时间：2013-02-01T19:45:48.833

我对这 3 个选项进行了基准测试（另一个基准测试没有拆分 CPU 周期并且已经 4 岁了）：

```
class foo {
    public static function bar() {
        return __METHOD__;
    }
}

function directCall() {
    return foo::bar($_SERVER['REQUEST_TIME']);
}

function variableCall() {
    return call_user_func(array('foo', 'bar'), $_SERVER['REQUEST_TIME']);
}

function reflectedCall() {
    return (new ReflectionMethod('foo', 'bar'))->invoke(null, $_SERVER['REQUEST_TIME']);
} 
```

1,000,000 次迭代所用的绝对时间：

> print_r(Benchmark(array('directCall', 'variableCall', 'reflectedCall'), 1000000));

```
Array
(
    [directCall] => 4.13348770
    [variableCall] => 6.82747173
    [reflectedCall] => 8.67534351
) 
```

以及相对时间，也有 1,000,000 次迭代（单独运行）：

> ph()->Dump(Benchmark(array('directCall', 'variableCall', 'reflectedCall'), 1000000, true));

```
Array
(
    [directCall] => 1.00000000
    [variableCall] => 1.67164707
    [reflectedCall] => 2.13174915
) 
```

似乎反射性能在 5.4.7 中大大提高（从 ~500% 下降到**~213%**）。

`Benchmark()`如果有人想重新运行这个基准测试，这是我使用的函数：

```
function Benchmark($callbacks, $iterations = 100, $relative = false)
{
    set_time_limit(0);

    if (count($callbacks = array_filter((array) $callbacks, 'is_callable')) > 0)
    {
        $result = array_fill_keys($callbacks, 0);
        $arguments = array_slice(func_get_args(), 3);

        for ($i = 0; $i < $iterations; ++$i)
        {
            foreach ($result as $key => $value)
            {
                $value = microtime(true);
                call_user_func_array($key, $arguments);
                $result[$key] += microtime(true) - $value;
            }
        }

        asort($result, SORT_NUMERIC);

        foreach (array_reverse($result) as $key => $value)
        {
            if ($relative === true)
            {
                $value /= reset($result);
            }

            $result[$key] = number_format($value, 8, '.', '');
        }

        return $result;
    }

    return false;
} 
```

* * *

## 回答 #2

> 赞同：57
> 
> 时间：2008-11-16T23:43:45.237

不要担心。安装[Xdebug](http://www.xdebug.org/)并确定瓶颈在哪里。

使用反射是有成本的，但这是否重要取决于你在做什么。如果您使用反射实现控制器/请求调度程序，那么每个请求只使用一次。完全可以忽略不计。

如果您使用反射实现 ORM 层，将其用于每个对象甚至对属性的每次访问，并创建数百或数千个对象，那么它可能会很昂贵。

* * *

## 回答 #3

> 赞同：18
> 
> 时间：2009-05-30T08:48:42.743

在我的机器上调用静态函数 100 万次将花费 ~ 0.31 秒。使用 ReflectionMethod 时，大约需要 1.82 秒。这意味着使用反射 API 的成本要高出约 500%。

这是我顺便使用的代码：

```
<?PHP

class test
{
    static function f(){
            return;
    }
}

$s = microtime(true);
for ($i=0; $i<1000000; $i++)
{
    test::f('x');
}
echo ($a=microtime(true) - $s)."\n";

$s = microtime(true);
for ($i=0; $i<1000000; $i++)
{
    $rm = new ReflectionMethod('test', 'f');
    $rm->invokeArgs(null, array('f'));
}

echo ($b=microtime(true) - $s)."\n";

echo 100/$a*$b; 
```

显然，实际影响取决于您期望进行的调用次数

* * *

## 回答 #4

> 赞同：6
> 
> 时间：2018-02-26T13:53:45.560

我想要更新的东西，所以看看[这个 repo](https://github.com/brainfoolong/php-reflection-performance-tests)。从总结：

> *   在反射方面，PHP 7 的速度几乎是 PHP 5 的两倍 - 这并不直接表明 PHP7 上的反射速度更快，PHP7 核心刚刚获得了很好的优化，所有代码都将从中受益。
> *   基本反射非常快——阅读 1000 个类的方法和文档注释只需几毫秒。解析/自动加载类文件确实比实际的反射机制花费更多的时间。在我们的测试系统上，将 1000 个类文件加载到内存中大约需要 300 毫秒（需要/包含/自动加载）——而在相同数量的类上使用反射解析（文档注释、getMethods 等）只需 1-5 毫秒。
> *   结论：反射速度很快，在正常用例中，您可以忽略这种性能影响。但是，始终建议只解析必要的内容。而且，缓存反射不会给您带来任何明显的性能优势。

另外，查看[另一个基准](https://github.com/mnapoli/ReflectionBenchmark)。

> 这些结果是在使用 PHP 5.5.5 的开发 OS X 机器上获得的。[...]
> 
> *   读取一个对象的单个属性：闭包稍微快一些。
>     
>     
> *   读取多个对象的单个属性：反射速度更快。
>     
>     
> *   读取对象的所有属性：闭包更快。
>     
>     
> *   在一个对象上写入单个属性：反射稍微快一些。
>     
>     
> *   在多个对象上编写单个属性：反射要快得多。

* * *

## 回答 #5

> 赞同：5
> 
> 时间：2009-02-16T18:10:44.820

> 此外，我很想知道是否有任何流行的 PHP 框架（CI、Cake、Symfony 等）实际上使用反射。

[http://framework.zend.com/manual/en/zend.server.reflection.html](http://framework.zend.com/manual/en/zend.server.reflection.html)

*“通常，此功能只会由框架的服务器类开发人员使用。”*

* * *

## 回答 #6

> 赞同：4
> 
> 时间：2009-01-03T16:22:23.593

开销很小，因此没有大的性能损失，其他东西，如数据库、模板处理等都是性能问题，用一个简单的动作测试你的框架，看看它有多快。

例如下面使用反射的代码（前端控制器）在几毫秒内完成工作

```
<?php
require_once('sanitize.inc');

/**
 * MVC Controller
 *
 * This Class implements  MVC Controller part
 *
 * @package MVC
 * @subpackage Controller
 *
 */
class Controller {

    /**
     * Standard Controller constructor
     */
    static private $moduleName;
    static private $actionName;
    static private $params;

    /**
     * Don't allow construction of the controller (this is a singleton)
     *
     */
    private function __construct() {

    }

    /**
     * Don't allow cloning of the controller (this is a singleton)
     *
     */
    private function __clone() {

    }

    /**
     * Returns current module name
     *
     * @return string
     */
    function getModuleName() {
        return self :: $moduleName;
    }

    /**
     * Returns current module name
     *
     * @return string
     */
    function getActionName() {
        return self :: $actionName;
    }

    /**
     * Returns the subdomain of the request
     *
     * @return string
     */
    function getSubdomain() {
        return substr($_SERVER['HTTP_HOST'], 0, strpos($_SERVER['HTTP_HOST'], '.'));
    }

    function getParameters($moduleName = false, $actionName = false) {
        if ($moduleName === false or ( $moduleName === self :: $moduleName and $actionName === self :: $actionName )) {
            return self :: $params;
        } else {
            if ($actionName === false) {
                return false;
            } else {
                @include_once ( FRAMEWORK_PATH . '/modules/' . $moduleName . '.php' );
                $method = new ReflectionMethod('mod_' . $moduleName, $actionName);
                foreach ($method->getParameters() as $parameter) {
                    $parameters[$parameter->getName()] = null;
                }
                return $parameters;
            }
        }
    }

    /**
     * Redirect or direct to a action or default module action and parameters
     * it has the ability to http redirect to the specified action
     * internally used to direct to action
     *
     * @param string $moduleName
     * @param string $actionName
     * @param array $parameters
     * @param bool $http_redirect

     * @return bool
     */
    function redirect($moduleName, $actionName, $parameters = null, $http_redirect = false) {
        self :: $moduleName = $moduleName;
        self :: $actionName = $actionName;
        // We assume all will be ok
        $ok = true;

        @include_once ( PATH . '/modules/' . $moduleName . '.php' );

        // We check if the module's class really exists
        if (!class_exists('mod_' . $moduleName, false)) { // if the module does not exist route to module main
            @include_once ( PATH . '/modules/main.php' );
            $modClassName = 'mod_main';
            $module = new $modClassName();
            if (method_exists($module, $moduleName)) {
                self :: $moduleName = 'main';
                self :: $actionName = $moduleName;
                //$_PARAMS = explode( '/' , $_SERVER['REQUEST_URI'] );
                //unset($parameters[0]);
                //$parameters = array_slice($_PARAMS, 1, -1);
                $parameters = array_merge(array($actionName), $parameters); //add first parameter
            } else {
                $parameters = array($moduleName, $actionName) + $parameters;
                $actionName = 'index';
                $moduleName = 'main';
                self :: $moduleName = $moduleName;
                self :: $actionName = $actionName;
            }
        } else { //if the action does not exist route to action index
            @include_once ( PATH . '/modules/' . $moduleName . '.php' );
            $modClassName = 'mod_' . $moduleName;
            $module = new $modClassName();
            if (!method_exists($module, $actionName)) {
                $parameters = array_merge(array($actionName), $parameters); //add first parameter
                $actionName = 'index';
            }
            self :: $moduleName = $moduleName;
            self :: $actionName = $actionName;
        }
        if (empty($module)) {
            $modClassName = 'mod_' . self :: $moduleName;
            $module = new $modClassName();
        }

        $method = new ReflectionMethod('mod_' . self :: $moduleName, self :: $actionName);

        //sanitize and set method variables
        if (is_array($parameters)) {
            foreach ($method->getParameters() as $parameter) {
                $param = current($parameters);
                next($parameters);
                if ($parameter->isDefaultValueAvailable()) {
                    if ($param !== false) {
                        self :: $params[$parameter->getName()] = sanitizeOne(urldecode(trim($param)), $parameter->getDefaultValue());
                    } else {
                        self :: $params[$parameter->getName()] = null;
                    }
                } else {
                    if ($param !== false) {//check if variable is set, avoid notice
                        self :: $params[$parameter->getName()] = sanitizeOne(urldecode(trim($param)), 'str');
                    } else {
                        self :: $params[$parameter->getName()] = null;
                    }
                }
            }
        } else {
            foreach ($method->getParameters() as $parameter) {
                self :: $params[$parameter->getName()] = null;
            }
        }

        if ($http_redirect === false) {//no redirecting just call the action
            if (is_array(self :: $params)) {
                $method->invokeArgs($module, self :: $params);
            } else {
                $method->invoke($module);
            }
        } else {
            //generate the link to action
            if (is_array($parameters)) { // pass parameters
                $link = '/' . $moduleName . '/' . $actionName . '/' . implode('/', self :: $params);
            } else {
                $link = '/' . $moduleName . '/' . $actionName;
            }
            //redirect browser
            header('Location:' . $link);

            //if the browser does not support redirecting then provide a link to the action
            die('Your browser does not support redirect please click here <a href="' . $link . '">' . $link . '</a>');
        }
        return $ok;
    }

    /**
     * Redirects to action contained within current module
     */
    function redirectAction($actionName, $parameters) {
        self :: $actionName = $actionName;
        call_user_func_array(array(&$this, $actionName), $parameters);
    }

    public function module($moduleName) {
        self :: redirect($moduleName, $actionName, $parameters, $http_redirect = false);
    }

    /**
     * Processes the client's REQUEST_URI and handles module loading/unloading and action calling
     *
     * @return bool
     */
    public function dispatch() {
        if ($_SERVER['REQUEST_URI'][strlen($_SERVER['REQUEST_URI']) - 1] !== '/') {
            $_SERVER['REQUEST_URI'] .= '/'; //add end slash for safety (if missing)
        }

        //$_SERVER['REQUEST_URI'] = @str_replace( BASE ,'', $_SERVER['REQUEST_URI']);
        // We divide the request into 'module' and 'action' and save paramaters into $_PARAMS
        if ($_SERVER['REQUEST_URI'] != '/') {
            $_PARAMS = explode('/', $_SERVER['REQUEST_URI']);

            $moduleName = $_PARAMS[1]; //get module name
            $actionName = $_PARAMS[2]; //get action
            unset($_PARAMS[count($_PARAMS) - 1]); //delete last
            unset($_PARAMS[0]);
            unset($_PARAMS[1]);
            unset($_PARAMS[2]);
        } else {
            $_PARAMS = null;
        }

        if (empty($actionName)) {
            $actionName = 'index'; //use default index action
        }

        if (empty($moduleName)) {
            $moduleName = 'main'; //use default main module
        }
        /* if (isset($_PARAMS))

          {

          $_PARAMS = array_slice($_PARAMS, 3, -1);//delete action and module from array and pass only parameters

          } */
        return self :: redirect($moduleName, $actionName, $_PARAMS);
    }
} 
```

* * *

## 回答 #7

> 赞同：2
> 
> 时间：2011-01-03T15:29:49.247

在我的例子中，它只比直接调用类方法慢 230%，与 call_user_func 函数一样快。

* * *

## 回答 #8

> 赞同：2
> 
> 时间：2011-03-25T06:08:13.363

有时使用诸如 call_user_func_array() 之类的东西可以得到你需要的东西。不知道性能有什么不同。

* * *

## 回答 #9

> 赞同：1
> 
> 时间：2010-05-14T08:15:00.800

CodeIgniter 肯定使用反射。我敢打赌其他人也会这样做。在 ci 安装中查看 system/controller 文件夹中的 Controller 类。

* * *

## 回答 #10

> 赞同：1
> 
> 时间：2015-04-24T12:32:04.550

基于@Alix Axel 提供的代码

因此，为了完整起见，我决定将每个选项包装在一个类中，并在适用的情况下包括对象缓存。这是结果和代码 i7-4710HQ 上 PHP 5.6 的结果

```
array (
  'Direct' => '5.18932366',
  'Variable' => '5.62969398',
  'Reflective' => '6.59285069',
  'User' => '7.40568614',
) 
```

# 代码：

```
function Benchmark($callbacks, $iterations = 100, $relative = false)
{
    set_time_limit(0);

    if (count($callbacks = array_filter((array) $callbacks, 'is_callable')) > 0)
    {
        $result = array_fill_keys(array_keys($callbacks), 0);
        $arguments = array_slice(func_get_args(), 3);

        for ($i = 0; $i < $iterations; ++$i)
        {
            foreach ($result as $key => $value)
            {
                $value = microtime(true); call_user_func_array($callbacks[$key], $arguments); $result[$key] += microtime(true) - $value;
            }
        }

        asort($result, SORT_NUMERIC);

        foreach (array_reverse($result) as $key => $value)
        {
            if ($relative === true)
            {
                $value /= reset($result);
            }

            $result[$key] = number_format($value, 8, '.', '');
        }

        return $result;
    }

    return false;
}

class foo {
    public static function bar() {
        return __METHOD__;
    }
}

class TesterDirect {
    public function test() {
        return foo::bar($_SERVER['REQUEST_TIME']);
    }
}

class TesterVariable {
    private $class = 'foo';

    public function test() {
        $class = $this->class;

        return $class::bar($_SERVER['REQUEST_TIME']);
    }
}

class TesterUser {
    private $method = array('foo', 'bar');

    public function test() {
        return call_user_func($this->method, $_SERVER['REQUEST_TIME']);
    }
}

class TesterReflective {
    private $class = 'foo';
    private $reflectionMethod;

    public function __construct() {
        $this->reflectionMethod = new ReflectionMethod($this->class, 'bar');
    }

    public function test() {
        return $this->reflectionMethod->invoke(null, $_SERVER['REQUEST_TIME']);
    }
}

$testerDirect = new TesterDirect();
$testerVariable = new TesterVariable();
$testerUser = new TesterUser();
$testerReflective = new TesterReflective();

fputs(STDOUT, var_export(Benchmark(array(
    'Direct' => array($testerDirect, 'test'),
    'Variable' => array($testerVariable, 'test'),
    'User' => array($testerUser, 'test'),
    'Reflective' => array($testerReflective, 'test')
), 10000000), true)); 
```

# c++ - 最优雅的循环结构？

> ID：294585
> 
> 赞同：8
> 
> 时间：2008-11-16T23:44:20.633
> 
> 标签：c++, c, loops

对不起，新手的问题。我还在学习编程。所以我使用 C++，我需要做这样的事情：

```
int n;
do {
    n = get_data();
    if(n != -1)
        send(n);
} while(n != -1); 
```

这只是一个草图。反正感觉不是很优雅。我必须进行两次测试。我可以只测试一次并设置一个标志，但这也不是很优雅，因为我必须检查标志两次。似乎应该有一种方法可以更轻松地做到这一点，因为我想做的事情很容易。

* * *

## 回答 #1

> 赞同：19
> 
> 时间：2008-11-16T23:47:09.787

```
int n;
while (-1 != (n = get_data())) {
    send(n);
} // while 
```

* * *

## 回答 #2

> 赞同：17
> 
> 时间：2008-11-17T02:53:39.753

Similar to eed3si9n's but arguably easier to read:

```
 int n;
 while (n = get_data(), n != -1)
 {
     send(n);
 } 
```

* * *

## 回答 #3

> 赞同：15
> 
> 时间：2008-11-16T23:46:20.037

如何使用[break](http://msdn.microsoft.com/en-us/library/37zc9d2w(VS.80).aspx)：

```
int n;
while(1) {
    n = get_data();
    if(n == -1)
        break;
    send(n);
} 
```

这样您只测试一次，如果 get_data 没有返回您想要的内容，则立即退出。

* * *

## 回答 #4

> 赞同：11
> 
> 时间：2008-11-17T03:15:52.343

```
for (int n = get_data(); n != -1; n = get_data()) {
  send(n);
} 
```

* * *

## 回答 #5

> 赞同：4
> 
> 时间：2008-11-17T00:01:45.450

你的原版没问题。

在我上一份 C 编程工作中，我们必须遵循 MISRA 编码标准。

根据 MISRA 规则，这：

```
int n;
while(1) {
    n = get_data();
    if(n == -1)
        break;
    send(n);
} 
```

被禁止是因为`break`, 并且这个：

```
while((n = get_data()) != -1) { send(n); } 
```

被禁止，因为赋值出现在布尔上下文中，所以我习惯于编写类似于原始版本的循环。

如果您认为它会使您的意图更清晰，或者如果测试是一个复杂的表达式，您可以使用布尔变量：

```
int n;
bool valid;
do {
    n = get_data();
    valid = n != -1;
    if(valid)
        send(n);
} while(valid); 
```

但是对于像“ `n != -1`”这样的简单测试，可能不值得让程序更长。

* * *

## 回答 #6

> 赞同：2
> 
> 时间：2011-03-25T01:52:23.443

```
/* This is cleaner */ 
AGAIN:;
    int n = get_data();
    if (n != -1)
    {
        send(n);
        goto AGAIN;
    }

/* This has some charm as well */ 
int n;
while ((n = get_data()) != -1)
    send(n);
/* and now i see that this is the top answer.  Oh well */ 
```

* * *

## 回答 #7

> 赞同：1
> 
> 时间：2008-11-18T16:12:30.840

```
int n;
n = get_data();
while (n != -1) {
  send(n);
  n = get_data();
} 
```

* * *

## 回答 #8

> 赞同：0
> 
> 时间：2008-11-18T10:47:02.403

用`goto`:)构造

```
int n;
goto inside; do {
  send(n);
inside:
  n=get_data();
} while(n!=-1); 
```

* * *

## 回答 #9

> 赞同：0
> 
> 时间：2010-02-22T23:55:01.453

在 Python 中，你会这样做：

```
while True:
    n = get_data()
    if n == -1:
        break
    send(n) 
```

**如您所见，这并不比您的 C 版本短多少。**通常，Python 代码比其 C 代码小 5 到 10 倍。这不是这里的情况，因此您可以享受可读、足够短、快速的片段，并专注于其他事情。

如果您确实想让它更短，请查看乔纳森的答案，但这并不重要。

* * *

## 回答 #10

> 赞同：-2
> 
> 时间：2008-11-18T12:50:01.453

```
int get_data()
{
 ...
}

void _send(int )
{
 ...
}

int  send(int (*a) ())
{
   int n = a();

   if (n == -1)
      return n;

   _send(n);
   return 1;
}

int main()
{
  int (*fp)();
  fp = get_data;
  while ( send(fp)!= -1 );

  return 0;
} 
```

高温高压

# python - django中网站“根”的正则表达式是什么？

> ID：294607
> 
> 赞同：5
> 
> 时间：2008-11-17T00:05:46.863
> 
> 标签：python, regex, django, django-urls

我正在使用 django，当用户访问 www.website.com/ 时，我想将他们指向索引视图。

现在我正在这样做：

```
(r'^$', 'ideas.idea.views.index'), 
```

但是，它不起作用。我假设我的正则表达式是错误的。谁能帮我吗？我看过 python 正则表达式，但它们对我没有帮助。

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2008-11-17T00:09:37.337

你所拥有的应该工作（它对我有用）。确保它在顶部`urls.py`，它也应该在列表的顶部。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2013-04-23T13:33:58.973

只需输入一个空的原始正则表达式：r''

我在这里测试过，效果很好。

```
urlpatterns = patterns('',
    url(r'', include('homepage.urls')),
) 
```

希望对您有所帮助！

编辑：

你也可以放：

```
urlpatterns = patterns('',
    url(r'\?', include('homepage.urls')),
) 
```

问号使栏成为可选的。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2008-11-17T00:45:17.203

有什么方法可以使用通用视图并直接进入索引页面的模板？：

```
urlpatterns += patterns('django.views.generic.simple',
    (r'', 'direct_to_template', {'template': 'index.html'}),
) 
```

# sql - 推荐在线SQL-92认证？

> ID：294609
> 
> 赞同：2
> 
> 时间：2008-11-17T00:06:56.220
> 
> 标签：sql

我有兴趣衡量和改进（在必要时）我团队的 SQL-92 技能。谁能推荐合适的在线课程和/或考试？

理想情况下，它将是供应商中立的，但它也可以是特定于 MSSQL/Oracle 的，只要将专有位标记为这样。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2010-05-04T15:40:49.657

尝试 SQL 练习：[http ://www.sql-ex.ru](http://www.sql-ex.ru)

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2008-11-17T00:08:06.140

W3Schools 提供[SQL 教程和测验](http://www.w3schools.com/sql/default.asp)。有人试过吗？

我刚刚做了测验，它非常基础。20 个问题，我在 3 分钟内答对了 100%。我想在初次面试中淘汰人也不错。

# c# - WinForm 中的输入处理

> ID：294611
> 
> 赞同：4
> 
> 时间：2008-11-17T00:09:23.860
> 
> 标签：c#, winforms, keyboard, user-input

在不阻止特殊击键（例如`Ctrl`- `V`/ `Ctrl`- ）的情况下阻止某些输入键在 TextBox 中使用的最佳方法是什么`C`？

例如，只允许用户输入字符或数字的子集，例如 A 或 B 或 C，仅此而已。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2008-11-17T00:46:44.813

我将[Masked Textbox](http://www.c-sharpcorner.com/UploadFile/jibinpan/MaskedTextBoxControl11302005051817AM/MaskedTextBoxControl.aspx)控件用于 winforms。[这里](http://en.csharp-online.net/MaskedTextBox)有一个更长的解释。本质上，它不允许与字段条件不匹配的输入。如果您不希望人们输入除数字之外的任何内容，那么它根本不允许他们输入除数字之外的任何内容。

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2008-11-17T01:27:53.250

如果不允许使用该键，我将使用 keydown-event 并使用 e.cancel 来停止该键。如果我想在多个地方执行此操作，那么我将创建一个继承文本框的用户控件，然后添加一个属性 AllowedChars 或 DisallowedChars 为我处理它。我有几个变种，我不时使用，一些允许货币格式化和输入，一些用于时间编辑等等。

作为用户控件的好处是您可以添加到它并使其成为您自己的杀手文本框。;)

* * *

## 回答 #3

> 赞同：3
> 
> 时间：2008-11-17T02:03:50.913

这就是我通常的处理方式。

```
Regex regex = new Regex("[0-9]|\b");            
e.Handled = !(regex.IsMatch(e.KeyChar.ToString())); 
```

那将只允许数字字符和退格。问题是在这种情况下您将不能使用控制键。如果您想保留该功能，我会创建自己的文本框类。

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2008-12-16T03:20:56.100

`Ctrl`我发现唯一可行的解​​决方案是在 ProcessCmdKey 中对- `V`、`Ctrl`- 、 Delete 或 Backspace中的按键进行预检查，`C`如果它不是 KeyPress 事件中的这些键之一，则使用常规进行进一步验证表达。

这可能不是最好的方法，但它在我的情况下有效。

```
protected override bool ProcessCmdKey(ref Message msg, Keys keyData)
{
    // check the key to see if it should be handled in the OnKeyPress method
    // the reasons for doing this check here is:
    // 1\. The KeyDown event sees certain keypresses differently, e.g NumKeypad 1 is seen as a lowercase A
    // 2\. The KeyPress event cannot see Modifer keys so cannot see Ctrl-C,Ctrl-V etc.
    // The functionality of the ProcessCmdKey has not changed, it is simply doing a precheck before the 
    // KeyPress event runs
    switch (keyData)
    {
        case Keys.V | Keys.Control :
        case Keys.C | Keys.Control :
        case Keys.X | Keys.Control :
        case Keys.Back :
        case Keys.Delete :
            this._handleKey = true;
            break;
        default:
            this._handleKey = false;
            break;
    }
    return base.ProcessCmdKey(ref msg, keyData);
}

protected override void OnKeyPress(KeyPressEventArgs e)
{
    if (String.IsNullOrEmpty(this._ValidCharExpression))
    {
        this._handleKey = true;
    }
    else if (!this._handleKey)
    {
        // this is the final check to see if the key should be handled
        // checks the key code against a validation expression and handles the key if it matches
        // the expression should be in the form of a Regular Expression character class
        // e.g. [0-9\.\-] would allow decimal numbers and negative, this does not enforce order, just a set of valid characters
        // [A-Za-z0-9\-_\@\.] would be all the valid characters for an email
        this._handleKey = Regex.Match(e.KeyChar.ToString(), this._ValidCharExpression).Success;
    }
    if (this._handleKey)
    {
        base.OnKeyPress(e);
        this._handleKey = false;
    }
    else
    {
        e.Handled = true;
    }

} 
```

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2008-11-17T00:19:04.400

您可以对文本框使用 TextChanged 事件。

```
 private void txtInput_TextChanged(object sender, EventArgs e)
    {
        if (txtInput.Text.ToUpper() == "A" || txtInput.Text.ToUpper() == "B")
        {
            //invalid entry logic here
        }
    } 
```

# vim - 是否有任何 IDE 有 vi 键绑定选项？

> ID：294613
> 
> 赞同：26
> 
> 时间：2008-11-17T00:10:00.020
> 
> 标签：vim, ide, vi

我通常不使用 IDE 进行开发的原因之一是我非常习惯于 vi 键绑定，以至于我通常最终会弄乱我的文本并输入很多“：w”，而且我不能使用vi 强大的正则表达式替换机制。是否有任何 IDE 允许您配置 vi 键绑定或使用 vi 作为 IDE 中的编辑器？

### 有关的：

> [是否可以在 NetBeans 中使用 vi 或 vim 键盘映射？](https://stackoverflow.com/questions/483962/is-it-possible-to-use-vi-or-vim-keymap-in-netbeans)

* * *

## 回答 #1

> 赞同：20
> 
> 时间：2008-11-17T00:15:15.580

ViEmu[为](http://viemu.com)Visual Studio 提供 vim 键绑定。我没有使用它，但如果我在 VS 中工作而不实际使用 vim，我可能会使用它。

另外，我知道[SlickEdit](http://slickedit.com)有一个 vi 键绑定选项。

* * *

## 回答 #2

> 赞同：13
> 
> 时间：2008-11-17T00:23:15.267

NetBeans有[jVi](http://jvi.sourceforge.net/)。还有用于 Eclipse 的[viPlugin](http://www.satokar.com/viplugin/)，但它不是免费的。:(

* * *

## 回答 #3

> 赞同：9
> 
> 时间：2008-11-17T00:31:52.940

[PIDA](http://pida.co.uk/)是一个集成、嵌入和平滑控制的真正 Vim 的 IDE。在我看来，没有任何模拟能比得上真正的 Vim，在那里你可以使用所有的 Vim 插件、语法高亮等。

[强制截图。](http://pida.co.uk/files/screenshots/pida_0-6_18.png)

* * *

## 回答 #4

> 赞同：8
> 
> 时间：2008-11-17T02:46:20.593

有适用于 IntelliJ 的[IDEAVim](http://ideavim.sourceforge.net/)，它是 rad。

* * *

## 回答 #5

> 赞同：8
> 
> 时间：2009-04-26T00:30:11.033

对于 Eclipse 也有[vrapper](http://vrapper.sourceforge.net/home/ "说唱歌手")，它是免费的。我用了两个星期，效果很好。

编辑：

[我在重构方法](http://sourceforge.net/apps/trac/vrapper/ticket/96)时遇到了错误，所以我停止使用它。

现在我正在使用[ViPlugin](http://www.viplugin.com/viplugin/)。它工作正常，我推荐它，但它不是免费的（但便宜并且有试用版）

* * *

## 回答 #6

> 赞同：6
> 
> 时间：2008-11-17T07:25:48.270

您可以尝试[免费的 Komodo Edit](http://www.activestate.com/Products/komodo_ide/komodo_edit.mhtml)，它集成了 vi 模式。

* * *

## 回答 #7

> 赞同：5
> 
> 时间：2008-11-17T11:50:10.700

对于 Visual Studio，有 ViEmu ( [http://www.viemu.com/](http://www.viemu.com/) )。不幸的是，它不是免费的，也不是 100% Vim。我已经使用它 1 到 2 年了，并且对它非常满意，因为它让我可以做大部分我习惯于 Vim 的事情。

我不会替换所有 VS 的键绑定，因此您实际上可以混合使用 VS 和 Vim 命令，这很好。但是，如果您想使用其他插件，例如 ReSharper 等，它确实会让生活变得更加困难。

* * *

## 回答 #8

> 赞同：4
> 
> 时间：2008-11-17T00:16:35.700

[Editra](http://editra.org/)有 vi 仿真，是跨平台的，处理语法高亮，等等...看起来不错。我刚开始在家里的 Mac 上使用它，可能也会在办公室切换到它。

* * *

## 回答 #9

> 赞同：3
> 
> 时间：2008-11-17T00:14:26.033

查看[jVi](http://jvi.sourceforge.net/)。

* * *

## 回答 #10

> 赞同：3
> 
> 时间：2009-09-09T19:59:35.137

[MonoDevelop](http://monodevelop.com/)既可以[嵌入 vim 作为编辑器](http://ankitjain.org/blog/2007/06/30/integrating-vim-with-monodevelop/)，而且[默认编辑器具有 vi 模式](http://mjhutchinson.com/journal/2008/10/14/vi%5Fmodes%5Fmonodevelop)。

MonoDevelop[现在可在 Windows 和 Mac](http://tirania.org/blog/archive/2009/Sep-09.html)以及 Linux 上使用。

* * *

## 回答 #11

> 赞同：3
> 
> 时间：2009-10-01T07:17:46.497

[QT Creator](http://qt.nokia.com/products/developer-tools)的编辑器也有 vi 模式。

但是，并非 vim 的所有功能都受支持。如果你正在寻找 vi 风格的编辑真的很好，但没有足够的功能来真正感觉你在 vim 中工作。

* * *

## 回答 #12

> 赞同：2
> 
> 时间：2010-04-29T17:48:09.783

我在同一条船上。我的大脑在 vi 中思考，使用不同的键绑定进行编码就像在对话中尝试翻译成不同的语言。

我使用 viPlugin 几年（直到 2008 年），但总觉得它在完成和查找功能方面掩盖了 Eclipse 的许多优点，我最终还是再次恢复到命令行 vi。

我现在正在接受 Komodo 的试用，我很想获得完整的商业许可证。它建立在 vi 仿真中，因此它是一种全新的方法，而不是一些附加的附加功能。

您可能考虑的另一条路径是采取措施使 vi 更像 IDE，唉...

[http://arstechnica.com/open-source/guides/2009/05/vim-made-easy-how-to-get-your-favorite-ide-features-in-vim.ars](http://arstechnica.com/open-source/guides/2009/05/vim-made-easy-how-to-get-your-favorite-ide-features-in-vim.ars)

* * *

## 回答 #13

> 赞同：1
> 
> 时间：2008-11-17T00:27:21.110

[Tasking EDE](http://www.tasking.com/resources/technologies/ede/)具有 vi 模式，如果您有幸为它所针对的嵌入式设备之一进行编码。

* * *

## 回答 #14

> 赞同：0
> 
> 时间：2011-05-17T11:27:21.130

试试 Activestate 的 Komodo IDE - 有一个免费的 Komodo Edit，但不确定是否包含绑定。我真的很喜欢它，特别是对于 perl 和 html/css 工作。

* * *

## 回答 #15

> 赞同：0
> 
> 时间：2013-03-10T14:38:39.617

同时有一个很好的免费和（从我有限的角度来看，但许多好评如潮的评论可能不言自明）完全足够替代两次提到的 Visual Studio 仍然商业的 ViEmu，即[VsVim 扩展](http://visualstudiogallery.msdn.microsoft.com/59ca71b3-a4a3-46ca-8fe1-0e90e3f79329)：

> 这是 Visual Studio 2010 [和 2012] 的 Vim 仿真层。它将 Vim 的熟悉的键绑定体验直接集成到 Visual Studio 的编辑器中。

它是通过 Jared Parsons 的 GitHub 项目[jaredpar/VsVim 开发](https://github.com/jaredpar/VsVim/)的 -[支持的功能](https://github.com/jaredpar/VsVim/wiki/Supported-Features)列表和解决互操作性选择/选项的[常见问题解答](https://github.com/jaredpar/VsVim/wiki/faq)也可用，最值得注意的是解决如何[临时禁用 VsVim](https://github.com/jaredpar/VsVim/wiki/faq#wiki-disable)：

> VsVim 可以通过按键序列 Ctrl+Shift+F12 暂时禁用，稍后通过相同的按键序列重新启用。禁用时，VsVim 不会干扰任何键盘或选择，让您可以像未安装 VsVim 一样使用 Visual Studio。

* * *

## 回答 #16

> 赞同：-5
> 
> 时间：2008-11-17T00:26:37.490

我所知道的大多数 IDE（eclipse、netbeasn、VS200X）都已替换为可用的正则表达式功能，我不是 vi 大用户，您真正想做什么？

我的建议是真正花时间学习选择的 IDE，你很快就会在那个环境中成为一个非常高效（以不同方式）的开发人员，如果有效率的话，它们不会是流行的 IDE。

我在 IDE 之间切换了很多次，而您最终只是习惯了按错误的组合键，这还不错。

# sql-server-2005 - 在 sql server 2005 中设置本地服务器

> ID：294615
> 
> 赞同：4
> 
> 时间：2008-11-17T00:10:13.140
> 
> 标签：sql-server-2005

我想设置一个本地主机服务器来在 sql server 2005 中测试我的站点。我刚刚安装了 sql server 2005，我以前从未在此设置过数据库。有一个登录屏幕，我尝试了一切，但它不会让我登录任何东西。我需要执行哪些步骤才能使其正常工作。谢谢

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2009-10-24T09:22:10.347

我收到了相同的错误消息，当我将服务器名称设置为“（本地）\SQLEXPRESS”时它得到了解决（SQLEXPRESS 是 SQL Server 安装的默认命名实例。如果您已更改它，则可以使用它而不是这个）和将 Windows 身份验证保留为默认身份验证方法。

问候， 阿什温·考尔

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2008-11-17T00:39:59.367

Aren't sql server 2005 services stopped by default? Check in Services to see if the SQL SERVER service is started. Also since you mention localhost you won't need to configure the sql server surface area to include remote connections.

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2008-11-18T08:12:34.117

假设您使用免费的 SQL 2005 Express 版本，您需要连接到的实例的默认名称是“SQLEXPRESS”。如果您以管理员身份登录计算机，那么您应该能够使用 Windows 身份验证访问您的数据库。所以你的连接信息应该是[这样](https://dl.getdropbox.com/u/111296/Forum/Example1.PNG)的：

![例子。](https://dl.getdropbox.com/u/111296/Forum/Example1.PNG)

SQL 带有一个内置的系统管理员帐户“sa”。您还可以尝试使用 SQL 身份验证登录，如下[所示](http://dl.getdropbox.com/u/111296/Forum/Example2.PNG)：

[例子。http://dl.getdropbox.com/u/111296/Forum/Example2.PNG](http://dl.getdropbox.com/u/111296/Forum/Example2.PNG)

在安装 SQL Server 期间必须设置的密码。

您可能还想在 SQL 配置管理器中检查您的连接参数

如果您在登录数据库引擎时仍然遇到问题，那么我可能会建议您重新安装 SQL，并确保您在安装时未选中“隐藏高级功能”。在 Express 版本中默认未选中。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2008-11-17T00:43:02.560

What error message are you getting?

If you named the instance, you have to connect to "localhost\INSTANCE" or "(local)\INSTANCE" or ".\INSTANCE" where INSTANCE is the name you gave at install time.

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2008-11-17T00:22:30.340

假设：

*   sql2005 安装在您的本地主机上
*   您可以通过查询分析器或 Sql Server Management Studio 连接到它吗？
*   当登录提示启动时，您有两个身份验证选项 -> Windows 身份验证或 Sql Server 身份验证。

如果这些假设都正确，请尝试通过 Windows 身份验证选项进行连接。如果失败，则尝试 Sql Server 身份验证并使用用户名“sa”（无引号），密码留空。

那样有用吗？此外，发布一些截图链接，以便我们可以准确地看到您所看到的内容，以进一步帮助您。

# c++ - 三角问题

> ID：294616
> 
> 赞同：0
> 
> 时间：2008-11-17T00:10:29.537
> 
> 标签：c++, puzzle

我正在尝试解决欧拉问题 18 -> [http://projecteuler.net/index.php?section=problems&id=18](http://projecteuler.net/index.php?section=problems&id=18)

我正在尝试用 c++ 来做到这一点（我正在重新学习它，欧拉问题是很好的学习/搜索材料）

```
#include <iostream>

using namespace std;

long long unsigned countNums(short,short,short array[][15],short,bool,bool);

int main(int argc,char **argv) {

    long long unsigned max = 0;
    long long unsigned sum;

    short piramide[][15] = {{75,0,0,0,0,0,0,0,0,0,0,0,0,0,0},
                            {95,64,0,0,0,0,0,0,0,0,0,0,0,0,0},
                            {17,47,82,0,0,0,0,0,0,0,0,0,0,0,0},
                            {18,35,87,10,0,0,0,0,0,0,0,0,0,0,0},
                            {20,4,82,47,65,0,0,0,0,0,0,0,0,0,0},
                            {19,1,23,75,3,34,0,0,0,0,0,0,0,0,0},
                            {88,2,77,73,7,63,67,0,0,0,0,0,0,0,0},
                            {99,65,4 ,28,6,16,70,92,0,0,0,0,0,0,0},
                            {41,41,26,56,83,40,80,70,33,0,0,0,0,0,0},
                            {41,48,72,33,47,32,37,16,94,29,0,0,0,0,0},
                            {53,71,44,65,25,43,91,52,97,51,14,0,0,0,0},
                            {70,11,33,28,77,73,17,78,39,68,17,57,0,0,0},
                            {91,71,52,38,17,14,91,43,58,50,27,29,48,0,0},
                            {63,66,4,68,89,53,67,30,73,16,69,87,40,31,0},
                            {4,62,98,27,23,9,70,98,73,93,38,53,60,4,23}};

    for (short i = 0;i<15;i++) {
        for (short m=0;m<15;m++) {
            if (piramide[i][m] == 0)
                break;
            sum = countNums(i,m,piramide,15,true,true);
            if (sum > max)
                max = sum;
            sum = countNums(i,m,piramide,15,true,false);
            if (sum > max)
                max = sum;
            sum = countNums(i,m,piramide,15,false,true);
            if (sum > max)
                max = sum;
            sum = countNums(i,m,piramide,15,false,false);
            if (sum > max)
               max = sum;

        }

    }
    cout << max;
    return 0;
}

long long unsigned countNums(short start_x,short start_y,short array[][15],short size, bool goright,bool goright2) {
    long long unsigned currentSum;

    currentSum = array[start_x][start_y];

    if (goright) { //go right
        if ((start_x + 1) < size)
            start_x++;
        if ((start_y + 1) < size)
            start_y++;
    }
    else //go down
        if ((start_x + 1) < size)
            start_x++;

    if (goright2) { //still going right
        for (short i = start_x, m = start_y;i< size && m < size;i++,m++) {
            currentSum += array[i][m];         
        }
    }
    else { //still going down
        for (short i = start_x;i<size;i++) {
            currentSum += array[i][start_y];            
        }
    }

    return currentSum;
} 
```

countNums 函数用于向下或对角线。我已经像这样测试了这个功能：

```
short a = 0;
short b = 0;
cout << countNums(a,b,piramide,15,true,true) << endl;
cout << countNums(a,b,piramide,15,true,false) << endl;
cout << countNums(a,b,piramide,15,false,true) << endl;
cout << countNums(a,b,piramide,15,false,false) << endl;
return 0; 
```

它确实有效（我还稍微改变了函数，所以它会打印它正在经历的每个数字）

但我仍然没有得到正确的结果。这向下和向右并且仍然向右（右侧的相邻数字），向下并继续向下（左侧的相邻数字）。我在这里做错了什么，有人吗？

* * *

阿拉斯泰尔：很简单

long long unsigned countNums(short start_x,short start_y,short array[][15],short size, bool goright,bool goright2);

start_x 和 start_y 是数组的坐标 数组是对数组的引用 size 只是数组的大小（它总是 15） goright 是知道我是要往下走还是往下走 goright2 是要知道我要继续往下或往左走

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2008-11-17T00:34:05.463

好的，首先，我有点不清楚您认为问题出在哪里。我根本无法解析倒数第二句话...

其次，您可能想在这里重新考虑您的设计。考虑执行单个离散任务并且不与应用程序的其余部分交织在一起的功能（即阅读“紧密耦合和松散绑定”）。对我来说，这里的一个大警告是存在一个`countNums`带有一长串参数的过于通用的函数名称。

我认为如果你把问题分成更小、更容易理解的块，你可能会发现问题更容易找到。我知道我会在这里采用的方法，但我假设练习的全部目的是帮助你练习编程技能，所以我就这样吧……

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2008-11-17T02:46:16.680

我已经解决了这个问题。鉴于 Project Euler 的本质是自己解决问题（“复印已解决的填字游戏并不意味着您解决了它”）并且我不想为其他人毁掉它，我真正能说的是您的解决方案看起来过于复杂。

但是，您可以在阅读文件时解决此问题。以这种方式解决它，问题 #69 将变得轻而易举！

祝你好运！

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2008-11-17T01:24:37.623

我对这个问题有点困惑。
我先清理你的代码。

```
long long unsigned countNums(short x,
                             short y,
                             short array[][15],
                             short size, 
                             bool goright,
                             bool goright2) 
{
    long long unsigned currentSum;
    currentSum = array[x][y];

    if ((x + 1) < size)    x++; //this happened in both your if cases

    if (goright && ((y + 1) < size)      y++; 

    if (goright2)
    { 
        for (;x< size && y< size;x++,y++)
            currentSum += array[x][y];         

    }
    else 
    {
        for (;x<size;x++) 
            currentSum += array[x][y];            
    }
    return currentSum;
 } 
```

现在我读了这个问题，我不确定它是否在做你想要的。由于这不是您想要的，我建议先对答案进行 psudo-code。忘记代码.. sudo 代码中的答案是什么。
哦，为了所有圣洁的爱。不要在 for 循环中放置一个以上的初始化程序。我知道我会为此受到抨击，但它很混乱而且真的不需要。您可能会考虑的是递归函数。似乎很适合这个问题。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2008-11-17T01:45:47.300

主函数检查一个条目是否不为零，但它调用的另一个函数不会检查它，即使它再次更改索引。我不知道，我真的不明白你想做什么。

我看到 15 个元素的数组大小为 15，声明的索引是否也从 0 开始？让我检查一下。只要确保，用大小声明，但基于 0 访问。很好。

为什么你在一个地方使用了嵌套的 for 语句，但后来却使用了复合条件 for 语句？最好检查`&&`没有比 更高的优先级`<`。[第 8 组在这里](http://www.cppreference.com/wiki/operator_precedence "C++ 参考")击败第 13 组。增量运算符不在语句中多次使用，这很好。

听起来你以前用另一种语言做过这个问题，你能不能也跟踪一下，找到你的新程序首先不同的地方？

其他人是对的，这个问题令人困惑。我会首先尝试解决问题，如果金字塔从那个点开始并从底部到顶部构建它，那么在另一个矩阵中建立子分数给出最高分数。

# c# - C#如何捕获异常并检查它是否包含字符串？

> ID：294622
> 
> 赞同：6
> 
> 时间：2008-11-17T00:18:31.267
> 
> 标签：c#, exception

当用户权限足够时，我收到一个显示“访问被拒绝”的异常，我如何捕获异常并检查“访问被拒绝”，以便向用户显示更友好的“抱歉访问被拒绝”消息？

谢谢初学者:-)

* * *

## 回答 #1

> 赞同：15
> 
> 时间：2008-11-17T00:24:57.900

You don't really want to check the string of the message, you want to check the type of the message, which can be easily done by catching only the type(s) of exception you are checking for. The following example will catch two different types of exceptions and do different actions based on what if any error occurs. (Note: the names of the exceptions are made up)

```
try {
    ...
} catch (SomeKindOfException ex) {
    MessageBox.Show(ex.Message);
} catch (AccessDeniedException ex) {
    //Do something else
} 
```

* * *

## 回答 #2

> 赞同：13
> 
> 时间：2010-05-09T11:20:54.243

我认为在这里做的最安全的事情（令人惊讶的是，没有一个答案表明这一点）是

*   尽可能地捕获*特定*的异常类型。真的尽量避免捕获所有异常。
*   测试`string.ToLowerInvariant()`包含目标字符串的异常消息。
*   **重新`throw`**，如果它不是你所期望的！

像这样：

```
try
{
    int result = DoStuff(param);
}
catch (System.IO.IOException ioex)
{
    if (ioex.Message.ToLowerInvariant().Contains("find me"))
    {
        .. do whatever ..
    }
    else
    {
        // no idea what just happened; we gotta crash
        throw;
    }
} 
```

* * *

## 回答 #3

> 赞同：7
> 
> 时间：2008-11-17T00:24:24.907

If you are using a try catch block...

```
try
{
    //error occurs
}
catch (Exception ex)
{
    MessageBox.show(ex.Message);
} 
```

Obviously that is pretty crappy error handling, but it shows that the Exception object contains the error string. You can narrow down the handling of different exceptions by catching different exception types.

```
Try
{
    //error occurs
}
catch (AccessDeniedException ex)
{
    MessageBox.show(ex.Message);
}
catch (FieldAccessException)
{

}
// etc... 
```

* * *

## 回答 #4

> 赞同：6
> 
> 时间：2017-11-06T18:05:12.820

在 C# 6.0 中使用[异常过滤器](https://docs.microsoft.com/en-us/dotnet/csharp/language-reference/keywords/when)更容易：

```
try
{
    int result = DoStuff(param);
}
catch (IOException ex) 
when (ex.Message.ToLowerInvariant().Contains("find me")) 
{
    //.. do whatever ..
} 
```

旧式 C# 解决方案将是

```
try
{
    int result = DoStuff(param);
}
catch (System.IO.IOException ex)
{
    if (ex.Message.ToLowerInvariant().Contains("find me"))
    {
        //.. do whatever ..
    }
    else
    {
        throw;
    }
} 
```

在这两种变体的情况下，您将获得相同的堆栈跟踪。在第一个变体中，根本没有捕获异常，而在第二个变体中，异常被追溯。但是有一个重要的区别：

在异常过滤器的情况下：

*   堆栈跟踪被保留。
*   堆栈被保留。

如果发生“如果抛出则捕获”：

*   堆栈跟踪被保留。
*   堆栈**不保留**。

堆栈和堆栈跟踪有什么区别？

Stacktrace 是堆栈的快照。

实际上，您可以在这些变体中看到的唯一区别是您可以有不同的内存转储（如果您结合了 C# 和 C++）。

**本土化**

如果您捕捉到一些已本地化为多种语言的第三方异常，并且您无法按类型或代码检查异常，请注意该消息可以本地化。有一个解决方法。您可以找到异常的英文消息。捕获异常，开始一个新的带有英语文化的线程并阅读带有英语文化的线程上的消息属性，然后返回当前线程并返回结果。

**结论**

您应该使用异常过滤器，它不仅是语法糖，而且您还将拥有正确的内存转储。

* * *

## 回答 #5

> 赞同：2
> 
> 时间：2008-11-17T00:27:09.860

Simple:

```
try
{
    YourCommandWhichResultsInDeniedAccess();
}
catch (AccessDeniedException)
{
    MessageBox.Show('Access Denied');
} 
```

If you don't know the type of the Exception and/or you want to check the Exception message instead, do the following:

```
try
{
    YourCommandWhichResultsInDeniedAccess();
}
catch (Exception e)
{
   if (e.Message == 'Access Denied')
   {
       MessageBox.Show('Access Denied')
   }
} 
```

* * *

## 回答 #6

> 赞同：1
> 
> 时间：2019-04-14T12:49:49.067

您可以使用条件捕获功能：

```
try
{
    // code here which throws exception
}
catch (Exception ex) when(ex.Message.Contains("Access Denied"))
{
    MessageBox.Show("Sorry, Access Denied", "This is a polite error message");
} 
```

* * *

## 回答 #7

> 赞同：0
> 
> 时间：2016-03-24T12:16:40.390

Just a modification from above, but working with datatable and database and dropdownlist

```
try {
        drop_grup_head.SelectedValue = ds.Rows[0]["group_head"].ToString();
     }
     catch (Exception exce ) {
        if (exce.Message.ToLowerInvariant().Contains("does not exist in the list")) {
           drop_grup_head.SelectedValue = "0";
        }
     } 
```

* * *

## 回答 #8

> 赞同：-2
> 
> 时间：2008-11-17T00:34:30.453

First off - should look into the permissions issue rather than tackling the exception solely. If "Access Denied" is thrown then there must either be a permissions issues or a lock of some sort.

Anyways, "Message" is a string and you can use the .Contains method on it to check for "Access Denied".

You can't change the "Message" property as it has no setter, but you can handle the exception and display a polite message.

MessageBox.Show("Sorry, Access Denied"); for instance.

Edit: as mentioned above you should check for the type of exception. e.g. AccessDeniedException rather than use something as generic as "Exception".

* * *

```
try
        {
            // code here which throws exception
        }
        catch (Exception ex)
        {
            if (ex.Message.Contains("Access Denied"))
            {
                MessageBox.Show("Sorry, Access Denied", "This is a polite error message");
            }
        } 
```

# wcf - What is WCF's performance like compared to other solutions for high volume programs?

> ID：294646
> 
> 赞同：3
> 
> 时间：2008-11-17T00:36:54.973
> 
> 标签：wcf, performance

What is WCF performance like compared to other solutions such as ASMX or even a custom module?

Example: An online multi-player video game based on AJAX with JSON with data always going back and forth with the browser and server with hundreds of thousands to millions of users.

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2008-11-17T03:08:56.947

如果您想将 ASMX 与 WCF 进行比较，[有几篇关于它的帖子](https://stackoverflow.com/questions/216931/what-is-the-difference-between-an-aspnet-web-method-and-a-wcf-service)...

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2008-11-18T08:15:04.783

[WCF 与 WebSphere](http://download.microsoft.com/download/4/8/6/486b4b4f-5a87-4b5c-beec-455290f83274/TradeBenchmark_WinServer2008.pdf)。这是基于[.NET StockTrader 示例应用程序](http://msdn.microsoft.com/en-us/netframework/bb499684.aspx)的详细性能测试。

[ASMX 与 WCF](http://msdn.microsoft.com/en-us/library/bb310550.aspx)

# wpf - 为什么我的 XmlSerializer 出现错误？

> ID：294659
> 
> 赞同：42
> 
> 时间：2008-11-17T00:54:59.213
> 
> 标签：wpf, system.xml

我对我的工作应用程序进行了一些更改，并在这行代码中开始出现以下错误。

```
Dim Deserializer As New Serialization.XmlSerializer(GetType(Groups)) 
```

这是错误。

```
 BindingFailure was detected
    Message: The assembly with display name 'FUSE.XmlSerializers' failed to load in the 'LoadFrom' binding context of the AppDomain with ID 1\. The cause of the failure was: System.IO.FileNotFoundException: Could not load file or assembly 'FUSE.XmlSerializers, Version=8.11.16.1, Culture=neutral, PublicKeyToken=null' or one of its dependencies. The system cannot find the file specified.
File name: 'FUSE.XmlSerializers, Version=8.11.16.1, Culture=neutral, PublicKeyToken=null'

    Message: The assembly with display name 'FUSE.XmlSerializers' failed to load in the 'LoadFrom' binding context of the AppDomain with ID 1\. The cause of the failure was: System.IO.FileNotFoundException: Could not load file or assembly 'FUSE.XmlSerializers, Version=8.11.16.1, Culture=neutral, PublicKeyToken=null' or one of its dependencies. The system cannot find the file specified.
File name: 'FUSE.XmlSerializers, Version=8.11.16.1, Culture=neutral, PublicKeyToken=null'

=== Pre-bind state information ===
LOG: User = DOUG-VM\Doug
LOG: DisplayName = FUSE.XmlSerializers, Version=8.11.16.1, Culture=neutral, PublicKeyToken=null, processorArchitecture=MSIL
 (Fully-specified)
LOG: Appbase = file:///E:/Laptop/Core Data/Data/Programming/Windows/DotNet/Work Projects/NOP/Official Apps/FUSE WPF/Fuse/bin/Debug/
LOG: Initial PrivatePath = NULL
Calling assembly : System.Xml, Version=2.0.0.0, Culture=neutral, PublicKeyToken=b77a5c561934e089.
===
LOG: This bind starts in default load context.
LOG: Using application configuration file: E:\Laptop\Core Data\Data\Programming\Windows\DotNet\Work Projects\NOP\Official Apps\FUSE WPF\Fuse\bin\Debug\FUSE.vshost.exe.config
LOG: Using machine configuration file from C:\WINDOWS\Microsoft.NET\Framework\v2.0.50727\config\machine.config.
LOG: Policy not being applied to reference at this time (private, custom, partial, or location-based assembly bind).
LOG: Attempting download of new URL file:///E:/Laptop/Core Data/Data/Programming/Windows/DotNet/Work Projects/NOP/Official Apps/FUSE WPF/Fuse/bin/Debug/FUSE.XmlSerializers.DLL.
LOG: Attempting download of new URL file:///E:/Laptop/Core Data/Data/Programming/Windows/DotNet/Work Projects/NOP/Official Apps/FUSE WPF/Fuse/bin/Debug/FUSE.XmlSerializers/FUSE.XmlSerializers.DLL.
LOG: Attempting download of new URL file:///E:/Laptop/Core Data/Data/Programming/Windows/DotNet/Work Projects/NOP/Official Apps/FUSE WPF/Fuse/bin/Debug/FUSE.XmlSerializers.EXE.
LOG: Attempting download of new URL file:///E:/Laptop/Core Data/Data/Programming/Windows/DotNet/Work Projects/NOP/Official Apps/FUSE WPF/Fuse/bin/Debug/FUSE.XmlSerializers/FUSE.XmlSerializers.EXE. 
```

这是怎么回事？

* * *

## 回答 #1

> 赞同：68
> 
> 时间：2008-11-18T00:11:58.830

发生这种情况的主要原因是我尝试序列化和反序列化的类型不匹配。我正在序列化 ObservableCollection （组）并反序列化一个业务对象 - 继承 ObservableCollection （组）的组。

这也是问题的一部分......来自 - [http://social.msdn.microsoft.com/Forums/en-US/asmxandxml/thread/9f0c169f-c45e-4898-b2c4-f72c816d4b55/](http://social.msdn.microsoft.com/Forums/en-US/asmxandxml/thread/9f0c169f-c45e-4898-b2c4-f72c816d4b55/)

> 此异常是 XmlSerializer 正常操作的一部分。它是预期的，并将在框架代码中被捕获和处理。忽略它并继续。如果它在调试期间困扰您，请将 Visual Studio 调试器设置为仅在未处理的异常而不是所有异常上停止。

* * *

## 回答 #2

> 赞同：8
> 
> 时间：2009-12-15T23:27:20.667

根据我发现的信息，与 XmlSerializers 关联的 BindingFailure 异常有时并不表示任何错误，应该被忽略，但有时您可以在调试模式下看到它，当您设置 VS 选项以显示所有抛出的异常时。

来源： [https ://connect.microsoft.com/VisualStudio/feedback/ViewFeedback.aspx?FeedbackID=88566&wa=wsignin1.0](https://connect.microsoft.com/VisualStudio/feedback/ViewFeedback.aspx?FeedbackID=88566&wa=wsignin1.0)

顺便提一句。这或多或少是第一个答案中提到的事情之一:)。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2008-11-17T03:38:56.510

您似乎无法找到程序集 FUSE.XmlSerializers。检查[程序集绑定日志查看器](http://msdn.microsoft.com/en-us/library/e74a18c4%28v=vs.110%29.aspx)(Fuslogvw.exe) 的结果以查看它的位置（尽管上面显示的列表似乎很完整）。

尝试找到此程序集在您的计算机上的存储位置并在其上运行[NGen](http://en.wikipedia.org/wiki/Native_Image_Generator)以查看它是否由于某种原因无法加载。确保此 DLL 文件出现在您的*Bin\Debug*目录中。Visual Studio 似乎无法获取依赖项的依赖关系，因此有时您必须确保自己拥有所需的所有文件。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2008-11-17T10:14:37.507

您是如何加载包含该`Groups`类型的程序集的？我猜你加载它是`Assembly.LoadFrom()`因为 XML 序列化程序使用相同的上下文（“LoadFrom”上下文）来尝试加载程序集以进行序列化。如果是这样，您有几个选择：

1.  使用`Assembly.Load()`而不是`Assembly.LoadFrom()`.
2.  附加一个处理程序`AppDomain.AssemblyResolve`以帮助 CLR 找到有问题的程序集。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2014-06-21T01:15:50.177

对于我所拥有的少数几个令人烦恼的 Visual Studio 项目，我更喜欢仅为**BindingFailure**和**System.IO.FileNotFoundException**禁用异常中断。

在 Visual Studio 中：`Ctl`+ `D`、`Ctl`+`E`用于“例外”对话框：

**1) 取消勾选Managed Debugging Assistants**下的 BindingFailure

 ****2) 取消选中Common Language Runtime Exceptions**下的 System.IO.FileNotFoundException 。

啊，那更好:-)

...我看到 1/2 这个答案是由 strager 2010 年 11 月 24 日 10:12 给出的

# algorithm - 将首选合作伙伴匹配为三组的算法

> ID：294660
> 
> 赞同：12
> 
> 时间：2008-11-17T00:57:28.537
> 
> 标签：algorithm, language-agnostic, grouping, graph-theory, matching

有什么好的算法可以解决这个问题？

我有三组人——A组、B组和C组。每组的人数相同。他们每个人都有一个他们愿意与之合作的其他组中的人员列表。我想将所有这些人分成 3 人一组（一个来自 A，一个来自 B，一个来自 C），这样一个组中的每个人都希望与他们组中的其他人一起工作。

如何快速找到这些组？如果没有办法让每个人都开心，那么算法应该首先让尽可能多的组有三个想要一起工作的人，然后让其他组中的尽可能多的人开心。

最后一点：人们就他们想和谁一起工作达成一致（如果 x 想和 y 一起工作，那么 y 也想和 x 一起工作）。如果您还可以给出算法运行时间的大 O，那就太好了！

* * *

## 回答 #1

> 赞同：19
> 
> 时间：2008-11-17T01:00:17.003

这就像稳定的婚姻问题，但有 3 方而不是 2 方。

查看以前问题（二分图匹配）的有效解决方案，并根据您的需要进行调整。

[http://en.wikipedia.org/wiki/Stable_marriage_problem](http://en.wikipedia.org/wiki/Stable_marriage_problem)

一种适应可能是首先仅从 A 组和 B 组构建工作对。然后这些对必须与 C 组中的一个工人配对。让两人只喜欢两人都同意的工人（给定他们的名单）。请注意，这只会给出局部最优值。

k-partite 匹配的最优解是 NP 难求的：

[http://www.math.tau.ac.il/~safra/PapersAndTalks/k-DM.ps](http://www.math.tau.ac.il/~safra/PapersAndTalks/k-DM.ps)

有关 k 部​​分匹配问题的非最佳解决方案，请参见本文：

[http://books.google.com/books?id=wqs31L1MF4IC&pg=PA309&lpg=PA309&dq=k-partite+matching&source=bl&ots=kgBuvi7ym_&sig=j3Y-nyo51y8qp0-HwToyUlkao4A&hl=de&sa=X&oi=book_result&resnum=1&ct=result](http://books.google.com/books?id=wqs31L1MF4IC&pg=PA309&lpg=PA309&dq=k-partite+matching&source=bl&ots=kgBuvi7ym_&sig=j3Y-nyo51y8qp0-HwToyUlkao4A&hl=de&sa=X&oi=book_result&resnum=1&ct=result)

既然您知道要搜索的字词，我相信您可以自己在 Google 上找到其他人。我不知道是否有一种有效的算法可以给出 k=3 的最优解。

* * *

## 回答 #2

> 赞同：10
> 
> 时间：2008-11-17T05:52:03.230

这与稳定婚姻问题的扩展不同，因为据我了解 OP 的问题，每个组中的人都没有从最多到最少要与谁一起工作的有序列表；这是一个二元关系（愿意/不愿意）。

这可以表述为一个可以很快解决的整数规划问题。我给出了以下问题的数学公式；您可以使用 glpk 或 AMPL/CPLEX 之类的包来处理数据。

定义以下矩阵：

`M1 = |A| x |B|`矩阵，其中

`M1(a,b) = 1`如果 a（A 的给定成员）愿意与 b（B 的给定成员）一起工作，否则为 0

`M2 = |A| x |C|`矩阵，`M2(a,c) = 1`如果a（A的给定成员）愿意与c（C的给定成员）一起工作，否则为0

`M2 = |B| x |C|`矩阵，其中

`M3(b,c) = 1`如果 b（B 的给定成员）愿意与 c（C 的给定成员）一起工作，否则为 0

现在定义一个我们将用于最大化的新矩阵：

`X = |A| x |B| x |C|`矩阵，其中

`X(a,b,c) = 1`如果我们让 a、b 和 c 一起工作。

现在，定义我们的目标函数：

//最大化组数

最大化`Sum[(all a, all b, all c) X(a,b,c)]`

受以下约束：

//确保没有人被分成两组

对于 a 的所有值：`Sum[(all j, k) X(a, j, k)] <= 1`

对于 b 的所有值：`Sum[(all i, k) X(i, b, k)] <= 1`

对于 c 的所有值：`Sum[(all i, j) X(i, j, c)] <= 1`

//确保所有组由兼容的个体组成

对于所有 a、b、c：`X(a,b,c) <= M1(a,b)/3 + M2(a,c)/3 + M3(b,c)/3`

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2009-02-11T15:43:04.043

只是对这个问题的快速说明。首先，它不是稳定婚姻问题的一个例子，实际上也不是它的延伸（即3D稳定匹配问题）。无论如何，这是一个已知为 NP-hard 的 3D 匹配问题（参见 Garey 和 Johnson）。要以合理的方式解决此类问题，您可能需要使用某种形式的约束、整数或线性规划（存在其他方法）。可能有用的是新的 Microsoft Solver Foundation，因此请检查一下。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2008-11-18T09:31:07.283

首先，您可以消除双方在第三组中将与谁合作的不相交列表的任何事实。然后开始蛮力，深度优先搜索，总是从最不受欢迎到最受欢迎。

或者，等效于上述消除，形成所有可能的三重奏的列表并从中工作。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2016-09-15T05:12:34.843

我遇到了一个类似的问题，只是写了一个暴力破解它的脚本...... [http://grouper.owoga.com/](http://grouper.owoga.com/)

我最初的想法是：对于一个太大而无法暴力破解的更大群体，某种类型的遗传算法？进行 N 次随机交换 M 次。通过一些“快乐”功能为每个新安排评分。采取最好的少数，繁殖，重复。

对于小团体，我最终通过循环几组获得更好的结果，找到“最佳”交换（产生最高整体“幸福”增益的交换），然后重复。

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2021-05-04T20:09:51.537

可能，以下文章可以帮助您：[https ://en.wikipedia.org/wiki/Lattice_of_stable_matchings](https://en.wikipedia.org/wiki/Lattice_of_stable_matchings)

在其最简单的形式中，稳定匹配问题的一个实例由两组相同数量的要相互匹配的元素组成，例如医生和医院的职位。每个元素对其他类型的元素都有一个偏好顺序：每个医生对他们想在哪家医院工作有不同的偏好（例如，基于他们更喜欢住在哪个城市），每个医院都有自己的偏好他们愿意为哪些医生工作（例如基于专业或推荐）。目标是找到一个稳定的匹配：没有一对医生和医院比他们指定的匹配更喜欢对方。例如，国家居民匹配计划使用这个问题的版本来匹配美国医学生与医院。

一般来说，可能有许多不同的稳定匹配。例如，假设有三个医生（A、B、C）和三个医院（X、Y、Z），他们的偏好是：

```
A: YXZ   B: ZYX   C: XZY  
X: BAC   Y: CBA   Z: ACB 
```

这种匹配安排有三种稳定的解决方案：

*   医生有他们的第一选择，医院有他们的第三选择：AY、BZ、CX。
*   所有参与者都有第二个选择：AX、BY、CZ。
*   医院是他们的第一选择，医生是他们的第三选择：AZ、BX、CY。

对于任何稳定匹配的实例，稳定匹配的格组织了这个解决方案的集合，使其具有分布格的结构。

# mysql - 在 MySQL 中插入和更新单行表的最佳方法是什么？

> ID：294661
> 
> 赞同：3
> 
> 时间：2008-11-17T00:58:52.560
> 
> 标签：mysql, insert

我有一个只有一行的 MySQL 表。第一次插入该行以及后续更新时，我的语句应该是什么？我尝试了主键等于 1 的插入，但这并没有考虑到第一次没有行存在的情况。

* * *

## 回答 #1

> 赞同：9
> 
> 时间：2008-11-17T01:31:53.787

如果您的表只有一行，您可以考虑在数据库创建脚本中将初始数据预加载到该行中。然后您的代码将只需要发出 UPDATE 语句。此外，您不需要主键列，因为只有一行。然后，您也可以在不需要 WHERE 子句的情况下发出 UPDATE 语句。

* * *

## 回答 #2

> 赞同：8
> 
> 时间：2008-11-17T01:11:03.937

```
INSERT INTO table(col1,col2,col3) VALUES(val1,val2,val3) ON DUPLICATE KEY UPDATE col1 = val1, col2 = val2, col3 = val3; 
```

# emacs - 如何在 Emacs 中设置字体大小？

> ID：294664
> 
> 赞同：367
> 
> 时间：2008-11-17T01:00:28.110
> 
> 标签：emacs, fonts, emacs-faces

我还想将字体大小保存在我的`.emacs`文件中。

* * *

## 回答 #1

> 赞同：438
> 
> 时间：2008-11-17T17:49:27.027

```
(set-face-attribute 'default nil :height 100) 
```

值是 1/10pt，所以 100 会给你 10pt，等等。

* * *

## 回答 #2

> 赞同：398
> 
> 时间：2010-05-04T21:06:23.483

来自[Emacswiki](http://www.emacswiki.org/emacs/SetFonts)，GNU Emacs 23 有一个内置的组合键：

> `C-x``C-+`并`C-x``C--`增加或减少缓冲区文本大小

* * *

## 回答 #3

> 赞同：81
> 
> 时间：2008-11-17T01:07:12.667

按 Shift 和第一个鼠标按钮。您可以通过以下方式更改字体大小： [该网站](http://www.emacs.uniyar.ac.ru/doc/em24h/emacs098.htm)有更多详细信息。

* * *

## 回答 #4

> 赞同：43
> 
> 时间：2008-11-17T01:19:48.303

`M-x customize-face RET default`将允许您设置`default`所有其他面所基于的面。在那里你可以设置字体大小。

这是我的 .emacs 中的内容。实际上，颜色主题将设置基础，然后我的自定义面部设置将覆盖一些东西。custom-set-faces 是由 emacs 的 customize-face 机制编写的：

```
;; my colour theme is whateveryouwant :)
(require 'color-theme)
(color-theme-initialize)
(color-theme-whateveryouwant)

(custom-set-faces
  ;; custom-set-faces was added by Custom.
  ;; If you edit it by hand, you could mess it up, so be careful.
  ;; Your init file should contain only one such instance.
  ;; If there is more than one, they won't work right.
 '(default ((t (:stipple nil :background "white" :foreground "black" :inverse-video nil :box nil :strike-through nil :overline nil :underline nil :slant normal :weight normal :height 98 :width normal :foundry "unknown" :family "DejaVu Sans Mono"))))
 '(font-lock-comment-face ((t (:foreground "darkorange4"))))
 '(font-lock-function-name-face ((t (:foreground "navy"))))
 '(font-lock-keyword-face ((t (:foreground "red4"))))
 '(font-lock-type-face ((t (:foreground "black"))))
 '(linum ((t (:inherit shadow :background "gray95"))))
 '(mode-line ((t (nil nil nil nil :background "grey90" (:line-width -1 :color nil :style released-button) "black" :box nil :width condensed :foundry "unknown" :family "DejaVu Sans Mono"))))) 
```

* * *

## 回答 #5

> 赞同：40
> 
> 时间：2014-02-24T13:39:05.553

这是另一个简单的解决方案。也适用于 24

```
(set-default-font "Monaco 14") 
```

捷径：

```
`C-+` increases font size
`C--` Decreases font size 
```

* * *

## 回答 #6

> 赞同：15
> 
> 时间：2008-11-17T02:11:24.517

我有以下内容`.emacs`：

```
(defun fontify-frame (frame)
  (set-frame-parameter frame 'font "Monospace-11"))

;; Fontify current frame
(fontify-frame nil)
;; Fontify any future frames
(push 'fontify-frame after-make-frame-functions) 
```

您可以用您选择的任何字体替换`"Monospace-11"`. 可用选项集高度依赖于系统。使用`M-x set-default-font`和查看制表符补全会给你一些想法。在我的系统上，启用了 Emacs 23 和抗锯齿功能，可以按名称选择系统字体，例如 ,`Monospace`等`Sans Serif`。

* * *

## 回答 #7

> 赞同：13
> 
> 时间：2013-01-25T11:51:54.527

在X11中打开emacs，转到菜单选项，选择“设置默认字体...”，更改字体大小。在同一菜单中选择“保存选项”。完毕。

* * *

## 回答 #8

> 赞同：11
> 
> 时间：2013-04-17T08:26:34.253

[zoom.cfg](https://bitbucket.org/DavidVilla/emacs-pills/src/default/pills/zoom.cfg.el)和[global-zoom.cfg](https://bitbucket.org/DavidVilla/emacs-pills/src/default/pills/global-zoom.cfg.el)提供字体大小更改绑定（来自 EmacsWiki）

*   C-- 或 C-mousewheel-up：增加字体大小。
*   C-+ 或 C-mousewheel-down：减小字体大小。
*   C-0 将字体大小恢复为默认值。

* * *

## 回答 #9

> 赞同：8
> 
> 时间：2013-12-22T14:20:38.087

Firefox 和其他程序允许您使用 C-+ 和 C-- 增大和减小字体大小。我设置了我的 .emacs，以便通过添加以下代码行来拥有相同的能力：

```
(global-set-key [C-kp-add] 'text-scale-increase)

(global-set-key [C-kp-subtract] 'text-scale-decrease) 
```

* * *

## 回答 #10

> 赞同：8
> 
> 时间：2014-07-17T16:36:59.103

这是一个以交互方式调整字体高度的选项，一次一点：

```
;; font sizes
(global-set-key (kbd "s-=")
                (lambda ()
                  (interactive)
                  (let ((old-face-attribute (face-attribute 'default :height)))
                    (set-face-attribute 'default nil :height (+ old-face-attribute 10)))))

(global-set-key (kbd "s--")
                (lambda ()
                  (interactive)
                  (let ((old-face-attribute (face-attribute 'default :height)))
                    (set-face-attribute 'default nil :height (- old-face-attribute 10))))) 
```

当您想要调整*所有*缓冲区中的文本大小时，这是更可取的。我不喜欢使用`text-scale-increase`和的解决方案，`text-scale-decrease`因为排水沟中的行号可能会在之后被切断。

* * *

## 回答 #11

> 赞同：5
> 
> 时间：2017-03-05T07:12:16.970

**Aquamacs**：

```
(set-face-attribute 'default nil :font "Monaco-16" ) 
```

从 Emacs Wiki [Globally Change the Default Font](https://www.emacswiki.org/emacs/SetFonts)中，它说您可以使用以下任何一种：

```
(set-face-attribute 'default nil :font FONT )

(set-frame-font FONT nil t) 
```

`FONT`类似的东西在哪里`"Monaco-16"`，例如：

```
(set-face-attribute 'default nil :font "Monaco-16" ) 
```

wiki 上的第一个建议中有一个额外的右括号，导致启动时出错。我终于注意到了额外的右括号，随后我更正了 wiki 上的建议。然后这两个建议都对我有用。

* * *

## 回答 #12

> 赞同：4
> 
> 时间：2011-11-17T15:54:45.593

这完全取决于您更改字体大小的意思。这个 EmacsWiki 部分提供了最好和最完整的信息。它区分了各种情况（文本缩放、框架字体、缓冲区/框架等）：[更改字体大小](http://www.emacswiki.org/emacs/SetFonts#ChangingFontSize)。

* * *

## 回答 #13

> 赞同：2
> 
> 时间：2013-04-15T00:21:20.390

在 AquaMacs 中`CMD +`并`CMD -`调整当前缓冲区的字体大小。

* * *

## 回答 #14

> 赞同：1
> 
> 时间：2010-04-11T22:32:27.000

在 NTEmacs 23.1 中，选项菜单有一个“设置默认字体...”选项。

* * *

## 回答 #15

> 赞同：1
> 
> 时间：2012-08-15T16:09:22.737

我对控制台 emacs (emacs -nw) 很满意，现代 vterm 实现（如 gnome-terminal）往往具有更好的字体支持。另外，如果您习惯了这一点，那么您可以使用 tmux，因此即使没有 X，也可以在远程服务器上使用您的完整环境。

* * *

## 回答 #16

> 赞同：1
> 
> 时间：2015-06-17T10:41:52.750

我使用[hydra](https://github.com/abo-abo/hydra)包通过按`f2 + + + +`/连续控制字体增加/减少`f2 - - - -`，这意味着按`f2`一次，然后使用`+`/`-`只控制，并恢复默认字体大小`f2 0`。因为我有键盘，所以我还将键盘绑定到字体设置。

```
(defhydra hydra-zoom (global-map "<f2>")
  "zoom"
  ("<kp-add>" text-scale-increase "in")
  ("+" text-scale-increase "in")
  ("-" text-scale-decrease "out")
  ("<kp-subtract>" text-scale-decrease "out")
  ("0" (text-scale-set 0) "reset")
  ("<kp-0>" (text-scale-set 0) "reset")) 
```

以及以下键绑定支持的现代编辑器鼠标控制功能，按控制+鼠标滚轮增加/减少字体。

```
(global-set-key (kbd "<C-wheel-up>") 'text-scale-increase)
(global-set-key (kbd "<C-wheel-down>") 'text-scale-decrease) 
```

* * *

## 回答 #17

> 赞同：1
> 
> 时间：2018-04-26T22:31:34.113

这是一个片段，可让您使用交互式函数直接指定全局字体大小：

```
(defun set-font-size ()
    "Set the font size."
  (interactive)
  (set-face-attribute
   'default nil :height
   (string-to-number
    (read-string "Font size: " (number-to-string (face-attribute 'default :height nil)))))) 
```

# c++ - 当所有时间似乎都花在内存分配上时，如何提高抽象工厂的性能

> ID：294680
> 
> 赞同：1
> 
> 时间：2008-11-17T01:18:51.973
> 
> 标签：c++, optimization

应用程序将流反序列化为动态分配的对象，然后将基类型指针保存在链表中（即抽象工厂）。它太慢了。分析表明所有时间都花在`operator new`.

注意：该应用程序已经使用了一个自定义的内存分配器来进行池化。编译器是 VC++ 6.0，代码使用旧的 RogueWave 集合而不是 STL。

我现在唯一的想法是引入对象池。我会为每种类型维护大量预先分配的对象并重新使用它们。但这将在这个旧代码中做很多工作，而且我还不确定是否有足够的重用它甚至会有所帮助。我希望比我聪明的人有一个想法。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2008-11-17T02:32:07.940

唯一的方法是减少内存分配的数量。您是否使用过一个分析器，它可以准确地告诉您分配的内容是什么？你可能在做一些字符串操作吗？
如果所有时间都花在分配工厂正在创建的对象上，您可能需要去一个池。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2008-11-17T08:10:59.863

您是否尝试过为已知大小的对象使用自定义分配器？这是加快分配速度的好方法。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2008-11-17T02:12:30.880

我假设大多数分配与您正在谈论的对象列表有关。如果您实际上分配了一堆其他对象作为解析的一部分，这太慢了，那么您需要更多信息来优化。

*   我对 RogueWave 集合一无所知，但如果他们的链表分配了一个外部节点，那么您应该能够通过使用侵入式列表将分配数量减半 - 如有必要，请编写您自己的容器。这假设您不需要一次将相同的对象放在多个列表中（或多次放在同一个列表中）。

*   如果您的应用程序是多线程的，那么内存分配器可能会进行一些同步。但是，如果您可以安排在分配它们的同一线程中释放这些对象，则可以通过重载 operator new 将它们从每个线程堆中分配。这可能会更快：如果没有争用，同步不一定那么慢，但它比没有同步需要更多的时间，如果您的进程中的其他线程同时分配，那么就会出现争用。

*   对于更有限的用例，如果你发现你分配了这些东西的全部负载，然后在完成列表时总是一次性释放它们，你可以编写一个更快的“gc-style”分配器。

运算符 new/delete 会调用这样的函数（如果只有一个类用于池，则 size 可能是常量而不是参数）：

```
char *alloc(POOL *pool, size_t size) {
    // if size is a parameter, and may be a non-multiple the max alignment 
    // requirement on your system, and you want this to work in general:
    // size = (size + MAX_ALIGNMENT - 1) % ALIGNMENT;
    char *block = pool.current;
    char *next = block + size;
    if (next > pool.limit) throw std::bad_alloc();
    pool.current = next;
    return block;
}

void free(char *block) {
    return;
}

void freeAll(POOL *pool) {
    pool.current = pool.start;
    return;
} 
```

这应该确保 operator new 花费的时间与解析正在创建的对象所花费的时间相比是微不足道的。但它确实需要应用程序确定它应该创建、销毁和清除池的时间，并使用合适的 new 运算符将池指针作为参数，因此它不是直接替代。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2008-11-17T11:47:32.217

只是一些想法...

1.  你在你的演员里做什么？也许他们很慢？大对象，文件访问等？

2.  您的应用程序有多少内存可用？您是否接近物理限制，因此操作系统忙于交换？

3.  通过本地化您的内存访问模式来实现缓存友好。如果 RogueWave 系列不能为您做到这一点，也许是时候寻找其他东西了。

4.  你确定你的自定义分配器不是罪魁祸首吗？

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2008-11-17T12:55:08.557

您可以替换 operator new，甚至每个班级。在您的特定情况下，您将分配和取消分配单个类的许多对象。这意味着您将有很多相同大小的分配。这是一种易于优化的模式。基本上，保留一个原始内存块 N*sizeof(T) 和一个 N/8 位的位图来指示空闲状态。这很容易改装；您的旧代码不需要更改。

# .net - 如何在我的手机上拨打来电触发我的电脑上的操作

> ID：294688
> 
> 赞同：18
> 
> 时间：2008-11-17T01:26:00.367
> 
> 标签：.net, android, mobile, bluetooth, phone-call

我有一个特定的场景，但我一般会问这个：

**有没有办法让我的手机在我的电脑上触发一个动作？**我在想，智能手机必须可以通过蓝牙将手机和个人电脑连接起来，并且在我的电脑上运行某种小程序来监听手机上的来电。当有人打电话给我时，我希望我的手机简单地将来电者的电话号码提交给个人电脑，然后个人电脑将从那里完成它的工作。然后，我想像往常一样处理手机上的电话。

**编辑**：

更新了这个问题！我目前正在使用 HTC Hero，希望 Android SDK 能让这更容易完成。

**我的具体情况是：**

当我的手机（诺基亚 N82）来电时，我想将呼叫者提交`phonenumber`给搜索*小程序/应用程序*，它将查询*Microsoft Dynamics CRM*并查看联系人或公司是否有`phonenumber`，如果有，显示相应的人或公司我的屏幕上的信息。我首选的开发平台是 .NET Framework。

* * *

## 回答 #1

> 赞同：8
> 
> 时间：2009-02-19T15:19:00.373

卫星导航与手机的接口方式是通过与手机的拨号调制解调器建立蓝牙串行连接。您可以在控制面板的蓝牙选项中查看对应的 COM 端口。

连接后，可以使用手机发送和接收常规 AT 命令 - 对于诺基亚，这些命令在[此处](http://wiki.forum.nokia.com/index.php/AT_Commands)记录（以及完整的流程指南） 。

您应该等待来电的“RING”通知，然后立即发出命令“AT+CLCC”（列出当前呼叫）。在我的 N78 上，这会导致以下结果

```
+CLCC: 1,1,4,0,0,"07xxxxxxxxx",129 
```

这应该是您在 PC 上触发任何所需操作所需的所有信息。

编辑：由于某种原因，该特定链接实际上并未提及 AT+CLCC。如需完整的命令集（包括查询电话簿的命令，甚至在某些手机上查看传入的 SMS），请尝试[此](http://www.forum.nokia.com/info/sw.nokia.com/id/95672052-6c77-488d-a055-acef77e4cdc5/AT_Command_Set_For_Nokia_GSM_And_WCDMA_Products_v1_2_en.pdf.html)文档。

* * *

## 回答 #2

> 赞同：5
> 
> 时间：2008-11-21T07:01:14.370

N82 运行 Symbian，因此您可以开发一个应用程序，使用 CTelephony (C++) 类来检测电话状态并使用它做任何您想做的事情。你有一个例子here

[http://www.symbian.com/developer/techlib/v9.1docs/doc_source/guide/Telephony-subsystem-guide/N1013A/answer.html](http://www.symbian.com/developer/techlib/v9.1docs/doc_source/guide/Telephony-subsystem-guide/N1013A/answer.html)

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2008-11-17T03:32:09.660

我会说这可以为那部手机完成，**但**在 C++ 中。有用于阻止来电的 Symbian 应用程序，这意味着您可以访问来电号码。并且蓝牙访问应该不是问题，因为这款手机即使在 J2ME 中也可以访问它。

/亚努斯西姆

* * *

## 回答 #4

> 赞同：2
> 
> 时间：2008-11-17T04:15:03.817

'依靠'

您需要检查目标手机的 SDK - 但 Symbian 和 WindowsCE 手机可以做到这一点（关于 iPhone 的 NFI）。

从 Web 服务调用 Dynamics 很容易，您可以在内部或外部公开它，从而使用该区域中的 WiFi（无论是您自己的公司网络还是热点）或通过移动电话网络使用数据。

从在 Microsoft CRM 工作的日子开始（v 1.* 的地狱般的日子），有一些模组可以使用 Skype 或普通固定电话来做你所说的事情，我确信为它写的东西已经改进了，因为它很糟糕。

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2009-02-19T16:12:31.577

跳出框框思考如何？

如果您可以通过交换机（Asterisk、GrandCentral 或其他任何支持振铃组的设备）路由呼叫，那么您实际上可以同时将呼叫发送到您的电话和侦听 SIP 事件的计算机。

这是一种更通用的技术，确实需要一些特殊的设置，但它会变得独立于手机并且可以更加灵活。

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2008-11-17T02:28:57.727

我知道你当然不能在 iPhone 上做到这一点。

关于诺基亚 n82，我不确定 symbian 是否（他们使用的不是吗？）为诸如电话之类的事情提供开发人员挂钩，但如果没有，我一点也不感到惊讶。电话属于“我们真的*不*希望第三方搞砸这件事，所以这是禁区”的类别

* * *

## 回答 #7

> 赞同：0
> 
> 时间：2008-11-17T02:45:02.173

这在 Windows Mobile 设备上的 .NET Compact Framework 中很容易做到。您可以让一个应用程序在设备上运行并由电话触发，使用 RAPI 将文件写入连接 ActiveSync 的 PC，然后在设备将文件写入特定文件夹时触发 PC 上的文件侦听器应用程序.

不幸的是，N82 运行的是 Symbian 操作系统，所以我一无所获。只是想在我们都被 iPhone 压垮之前吹嘘一下我最喜欢的设备操作系统。

* * *

## 回答 #8

> 赞同：0
> 
> 时间：2008-11-17T11:41:51.293

一个强有力的指标表明我想要做的在技术上是可行的，我可以通过蓝牙将手机连接到我的汽车 GPS 导航系统，并在汽车导航显示屏上查看任何来电的电话号码。

我希望这不会那么难完成，但我的希望正在减弱。

编辑：一直在进一步搜索，但仍然没有运气。在我找到有关该主题的更多信息之前，我将让这个问题保持开放，

* * *

## 回答 #9

> 赞同：0
> 
> 时间：2009-03-05T07:23:41.880

Salling Clicker 在 Mac 上工作就是为了做到这一点。我觉得有PC版。

无论哪种方式，它都是一个很酷的工具！！！

编辑：实际上，您汽车的免提套件和 GPS 以及所有显示来电号码和来电者的方式都是通过实现蓝牙免提协议。如果您使 PC 看起来像一个蓝牙车载套件（您可能必须自己编写协议），您就可以做到。

如果做不到这一点，您可以为手机编写一个应用程序来检测手机状态并通过蓝牙向 PC 发送消息，然后为 PC 编写另一个自定义应用程序来处理这些事件。就我个人而言，我只是下载答题器并使用它运行:)

Edit2：我根本没想到答题器，但它应该做你想做的事。有一个名为 BluePhone for Mac 的工具可以满足您的需求。我不确定它是否有 PC 版本，但如果您在互联网上闲逛，很可能有 PC 版。

* * *

## 回答 #10

> 赞同：0
> 
> 时间：2009-04-30T07:28:36.610

如果您可以在您的 PC 上访问蓝牙免提配置文件 API，则可以。如果手机是 HF 连接的，它会发送带有电话号码的 AT+CLIP 数据包。您将收到传入电话号码的通知。其余的很容易。但是你的手机应该支持 CLIP。我很确定所有现代手机都会这样做。

如果您可以编写访问 Microsoft 蓝牙堆栈的应用程序，这将很容易。

# html - 如何在防火墙后验证站点标记 [HTML/CSS]？

> ID：294694
> 
> 赞同：3
> 
> 时间：2008-11-17T01:29:51.810
> 
> 标签：html, css, validation

我正在设计一个网站，但它位于防火墙后面，像[http://validator.w3.org/](http://validator.w3.org/)这样的服务将无法工作。

是否有任何可以在 Windows 或 Mac OS X 上运行的免费应用程序来验证 html 和 css？

* * *

## 回答 #1

> 赞同：11
> 
> 时间：2008-11-17T01:36:00.237

使用 Firefox 的 HTML Validator 插件

[http://users.skynet.be/mgueury/mozilla/download.html](http://users.skynet.be/mgueury/mozilla/download.html)

它甚至可以处理您 PC 上的 HTML 文件

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2008-11-17T02:33:09.560

请注意，(X)HTML 验证器还具有[通过文件上传](http://validator.w3.org/#validate_by_upload)验证和[通过直接输入验证](http://validator.w3.org/#validate_by_input)选项。CSS 验证器有一组类似的选项。编写一个使用其中一种方法自动验证的脚本将是微不足道的。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2008-11-17T02:38:03.093

另请注意，[W3C](http://www.w3c.org/) HTML Validator 是开源软件，源代码可在[HTML Validator Source获得](http://validator.w3.org/source/)

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2008-11-17T02:37:34.980

w3 验证器确实有一个“通过直接输入验证”选项（我经常使用）但是 TravisO 的答案是值得选择的答案:)

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2008-11-20T02:41:33.597

Firefox 的 Web 开发人员工具栏在工具菜单下有“验证本地 HTML”，它就是这样做的。这只是安装 Web Developer Toolbar 的 457 个原因之一。

# caching - What's the best way to cache an archive file?

> ID：294696
> 
> 赞同：1
> 
> 时间：2008-11-17T01:32:06.377
> 
> 标签：caching, archive

We have a project page which consists of users' files, multimedia stuff, etc and we want to allow the user to export all this out into a single zip file. We're using unix and mysql to store all of these currently and our primary goal is to minimize load/performance time from all the processing and compiling all the files into a zip file.

My idea was to cache the zip file into a temp dir and keep all the CRC checksum for each files in the zip into a separate text file. Each time the user tries to do an export I will first check through each file's CRC and compare it to the list before adding or removing files from the zip file.

But my other concern is also the space that the zip file will be occupying as we might have a lot of users.

IMHO, this is probably the dumbest way possible to do this, so can any of you guys please suggest a better way to deal with this problem?

thanks ~codeNoobian

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2008-11-17T01:49:57.243

这意味着过早的优化，只需使用非常轻的压缩，也就是“最快”，如果它真的是一个问题，请担心速度。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2008-11-17T01:41:40.490

如果带宽/下载速度不是问题，我建议您使用未压缩的 tar 文件。TAR 是一种非常简单的格式，因此当一些文件发生更改时，很容易编写代码来更新它的部分。此外，不压缩它会大大节省服务器 CPU 时间。

当然，不压缩会占用服务器上的大量存储空间。但是由于它是未压缩的，它可能完全不需要您保留文件的缓存副本，如果您可以足够快地构建它，您可以根据需要即时构建它。然后，您也不必担心存储 CRC 和更新 TAR。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2008-11-17T02:08:08.987

普通的声音和图像文件一开始就被很好地压缩了，不是吗？可能值得查看您的有效负载，以了解您通过压缩购买了多少。

# java - Strip Images, CSS and JS from servlet-mapping

> ID：294699
> 
> 赞同：1
> 
> 时间：2008-11-17T01:33:59.413
> 
> 标签：java, jsp, servlets, jsp-tags

I am using the following servlet-mapping in my `web.xml` file:

```
<servlet>
    <servlet-name>PostController</servlet-name>
    <servlet-class>com.webcodei.controller.PostController</servlet-class>
</servlet>
<servlet-mapping>
    <servlet-name>PostController</servlet-name>
    <url-pattern>/*</url-pattern>
</servlet-mapping> 
```

To do some kind of a search. ex:

```
 [http://www.myweb.com/The](http://www.myweb.com/The) search string here 
```

But the problem is that CSS, JS and Images are treated like a search request.

**There are any patterns that strip out *.css, *.js, *.gif and etc, so the requests don't need to pass through my controller?**

Thank you so much, bye bye!

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2008-11-17T01:44:19.907

想到两个选择：

1) 通常，在这样的 web 应用程序中，由 servlet 处理的“动作”URL 被赋予像“”这样的子目录，或者被赋予像“ ”或“ ”这样`/actions/*`的扩展名（这就是 Struts 所做的） . 这样就很清楚哪些 URL 用于 servlet。这更像是一种包容性的解决方案，而不是您要求的独家解决方案，但我认为您想要的不可能。`*.action``*.do`

2) 更冒险的选择是在 apache 安装之后设置您的 Web 应用服务器，将图像、css 等作为平面文件提供，仅将其他所有内容发送到应用服务器。通常，这样做是为了减轻应用服务器的负载。这将要求您将所有这些文件复制到一个单独的目录以供 apache 处理。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2008-11-17T02:02:52.367

与其将某些扩展列入黑名单，不如考虑将到达 PostController servlet 的 URL 模式列入白名单。例如：

```
 <servlet>
    <servlet-name>PostController</servlet-name>
    <servlet-class>com.webcodei.controller.PostController</servlet-class>
 </servlet>
 <servlet-mapping>
    <servlet-name>PostController</servlet-name>
    <url-pattern>/*.jsp</url-pattern>
 </servlet-mapping> 
```

如果您使用的是简单的 JSP。现在，对扩展名为 *.css、*.gif 等文件的 HTTP GET 请求将不会通过此 servlet 进行路由。

正如提问者所指出的，有更多的 URL 不应该通过这个控制器进行路由。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-02-18T23:41:27.440

Jetty 按照您的预期解释 web.xml。我最近在将应用程序从 jetty 移动到 tomcat 时暴露了这个问题，突然间再也看不到我的静态资源了。非常令人沮丧。

# asp.net-mvc - How does ASP.NET MVC communicate w/ an AJAX enabled webpage?

> ID：294700
> 
> 赞同：0
> 
> 时间：2008-11-17T01:34:43.250
> 
> 标签：asp.net-mvc, ajax

How does the data go from the MVC to the browser and back again? Does it use Microsoft's own technology like ASMX or WCF or something completely different?

This sounds like MVC is using a ASMX Web Service they are using but I can't seem to find any documentation which gives the real answer.

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2008-11-17T03:23:43.280

来自 MVC 应用程序 <-> 浏览器的数据只是普通的 ole HTTP 请求/响应数据。要查看这些原始数据是什么，请在您的 PC 上安装[Firebug](https://addons.mozilla.org/en-US/firefox/addon/1843 "FireBug：火狐插件")或[Fiddler](https://addons.mozilla.org/en-US/firefox/addon/1843 "FireBug：火狐插件")，并使用它来显示原始输入和输出数据。这一切都很简单。

WebForms 使用相同的请求/响应模型。浏览器将一些信息传递给网络服务器（即请求......就像......我想看到[http://www.mysite.com/foo](http://www.mysite.com/foo)）并且网络服务器回复一些 html、json、xml、二进制数据（用于图像）等......这是响应。

所有浏览器都使用此*请求/响应*模型与所有网站通信。

现在.. MVC 和 WebForms 的区别在于 Web 服务器如何处理请求以及它如何生成响应。所以他们都遵循相同的概念，只是处理方式不同。例如，MVC 使用控制器来确定要向用户显示什么，而 WebForms 有一个“页面”来确定要显示什么数据（对于该页面）。

所以 - 本质上 - 你编程你的网站说：

*   如果用户*来到这里*，则*向*他们展示这些*数据*。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2008-11-17T03:01:15.993

AJAX requests are performed in the page using normal HTTP request/response. That is, in javascript the client will create a AJAX request object, send it off to a URL and it gets back a string. If that string is json, it can be eval'd and become a live javascript object.

The philosophy of MVC is that *all* http requests go through controllers. WCF is only for other types of web services that where the client doesn't consume html-json-css-etc.

You can return JSON from a controller action using the Json(object model) method on System.Web.Mvc.Controller.

for example

```
ActionResult MyAction() {
    return Json(new { success=false, for_lunch="mmm, chicken"});
} 
```

That will return the json your webpage can consume. So, that leaves the question - how does the browser call the MyAction for the json?

Several posts exist on this topic, and the first one i could find that did this was [this post](http://geekswithblogs.net/michelotti/archive/2008/06/28/mvc-json---jsonresult-and-jquery.aspx).

Hope that helps

# sql - SQL查询以获得最大的不同日期 - 一种

> ID：294705
> 
> 赞同：0
> 
> 时间：2008-11-17T01:42:53.733
> 
> 标签：sql, mysql

我有两个表：文章和文章标签

```
articles: id, author, date_time, article_text
articletags: id, tag

(article.id == articletags.id in a many-to-many relationship) 
```

我是在最后一次在每个标签下发布某些内容之后。换句话说，对于每个标签，查看与其相关的所有文章并找到最新的并返回。

例如文章：

```
1, me, 12 Nov, Sometext
2, me, 13 Nov, Sometext
3, me, 14 Nov, Sometext 
```

文章标签

```
1, foo
1, bar
2, foo
3, bar 
```

我想回来：

```
foo, 13 Nov
bar, 14 Nov 
```

我可以达到内部连接，然后被难住了。我不认为 DISTINCT 子句是我所追求的，而且我对子查询还不够熟悉，无法知道这是否有帮助。

```
SELECT date_time, tag 
FROM articles, articletags
WHERE articles.id = articletags.id 
```

这甚至可能吗？

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2008-11-17T01:50:31.800

```
select t.tag, max(a.date_time) as latest
from articles a
inner join articletags t
on t.id = a.id
group by t.tag 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2008-11-17T01:48:45.563

```
SELECT date_time, tag 
FROM articles, articletags
WHERE articles.id = articletags.id
ORDER BY date_time DESC
GROUP BY tag 
```

# deployment - 域句柄中有多个 IP，如何处理失败的 IP？

> ID：294707
> 
> 赞同：0
> 
> 时间：2008-11-17T01:43:15.167
> 
> 标签：deployment, dns

我正在尝试协调将站点从当前服务器移动到新服务器。我最初的计划是将数据迁移到新机器上，新机器已经到位并且迁移脚本测试成功。我计划将原始机器配置为将所有请求代理到新机器，以确保在 DNS 更改完全传播之前访问原始机器的任何人仍能得到正确的响应。

有人提出了一个替代建议，即我为新机器添加记录，但它实际上不提供任何内容。有人告诉我，在这种情况下，流量都会打到原始IP。当新记录传播时，我被告知我可以关闭旧服务器并启动新服务器。我对尝试这个并以中途模式进行迁移持怀疑态度。我应该尝试一下还是坚持我原来的计划？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2008-11-17T02:43:52.363

你原来的计划没有错。

当您不控制您使用的 DNS 服务器时，这也是一个不错的计划。

[编辑]此外，由于这听起来像是一个生产环境，因此在生产环境中尝试一些您不熟悉和不熟悉的东西绝不是一个好主意。

第二个想法听起来一点也不坏，但在这种情况下并不是最优的。选择你所知道的有效的方法。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2008-11-17T03:25:33.433

您无法控制记录传播多长时间，只能控制确定它们传播多长时间。

DNS 记录的 TTL 是它们可以被缓存的*最长时间；*但是，即使在此之前，人们已经在新地址上访问了该站点（例如，如果他们的 DNS 服务器没有缓存中的记录）。

这意味着任何解决方案都会有一个时间窗口，其中一些人访问旧地址而其他人访问新地址。任何迁移解决方案都必须考虑这种情况。

你原来的计划是最好的，只要你记得代理到 IP 地址（因为在 TTL 过去之前你不知道域名指向什么）。另一种计划（如果您可以让您的站点离线一段时间）将简单地使旧服务器离线，进行迁移，使新服务器在线，更改 DNS 记录，然后等待 TTL 过去；随着域名服务器上的 DNS 记录和浏览器 DNS 缓存过期，人们将逐渐开始使用新服务器，而在此之前，他们只能看到离线网站。

为新机器添加记录而不提供任何内容的建议是可疑的，因为一旦添加了记录，就会有人开始使用它。

# python - 在 Django 中扁平化一对多关系

> ID：294712
> 
> 赞同：7
> 
> 时间：2008-11-17T01:47:51.773
> 
> 标签：python, django, list, flatten

我有一些具有基本一对多关系的模型类。例如，一本书有很多食谱，每个食谱都有很多成分：

```
class Book(models.Model):
    name = models.CharField(max_length=64)

class Recipe(models.Model):
    book = models.ForeignKey(Book)
    name = models.CharField(max_length=64)

class Ingredient(models.Model):
    text = models.CharField(max_length=128)
    recipe = models.ForeignKey(Recipe) 
```

我想要一本特定书籍中所有食谱中所有成分的平面列表。用 Python 表达这一点的最佳方式是什么？

如果我使用的是 LINQ，我可能会这样写：

```
var allIngredients = from recipe in book.Recipes
                     from ingredient in recipe.Ingredients
                     select ingredient; 
```

* * *

## 回答 #1

> 赞同：11
> 
> 时间：2008-11-17T02:00:37.927

实际上，看起来使用过滤器有更好的方法：

```
my_book = Book.objects.get(pk=1)
all_ingredients = Ingredient.objects.filter(recipe__book=my_book) 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2008-11-17T01:52:19.533

要打印每个食谱及其成分：

```
mybook = Book.objects.get(name="Jason's Cookbook")
for recipe in mybook.recipe_set.all():
    print recipe.name
    for ingredient in recipe.ingredients:
        print ingredient.text 
```

如果您只想获取所有成分对象的列表：

```
mybook = Book.objects.get(name="Jason's Cookbook")
ingredient_list = []
for recipe in mybook.recipe_set.all():
    for ingredient in recipe.ingredients:
        ingredient_list.append(ingredient) 
```

[文档](http://docs.djangoproject.com/en/dev/topics/db/queries/#related-objects)。

# .net - Debugging .NET code with MS's Symbol Server - VS does not show variable's values

> ID：294738
> 
> 赞同：18
> 
> 时间：2008-11-17T02:13:44.297
> 
> 标签：.net, debugging, debug-symbols

When I debug my ASP.NET web site code using the Microsoft debug symbol's for .NET .. I keep getting this silly 'result' for most of the variables when I'm debugging .NET framework code (which of course is provided by the Microsoft Symbol Server, which I told VS2008 to grab the info, from)

```
Cannot obtain value of local or argument 'cookie' as 
it is not available at this instruction pointer, possibly because 
it has been optimized away. 
```

It's like the code I'm using is using optimized, compiled code. If that's the case, can I tell it NOT to optimize? I'm in DEBUG configuration. It's very frustrating because I cannot debug .. cause I can't see/retrieve the values of local variables as I step through the code.

Any clues/thoughts?

* * *

## 回答 #1

> 赞同：19
> 
> 时间：2009-10-05T08:19:08.813

Shawn Burke described a method of disabling this on his [blog](http://blogs.msdn.com/sburke/archive/2008/01/29/how-to-disable-optimizations-when-debugging-reference-source.aspx).

First, create a CMD that'll load Visual Studio without JIT optimization.

```
set COMPLUS_ZapDisable=1
cd /d "%ProgramFiles%\Microsoft Visual Studio 9.0\Common7\ide\"
start devenv.exe
exit 
```

Once in your Visual Studio project, do the following steps:

1) Right click on your project file and choose "Properties"

2) Choose the "Debug" tab and uncheck "Enable the Visual Studio Hosting Process"

3) Launch your application in the debugger.

* * *

## 回答 #2

> 赞同：7
> 
> 时间：2008-11-17T02:18:52.583

For a normal .Net application you can disable the use of JIT optimizations with an .INI file next to the starting binary. Here's a link to how this is accomplished

[http://blogs.msdn.com/jaredpar/archive/2008/08/29/disabling-jit-optimizations-while-debugging.aspx](http://blogs.msdn.com/jaredpar/archive/2008/08/29/disabling-jit-optimizations-while-debugging.aspx)

Debugging ASP.Net is a bit different though and I'm not sure if this will work for you. If you are debugging locally using the light weight web server (cassini) you can apply this trick to Cassini itself. If you are debuggin directly on a web server though inside of IIS I don't know how to get this trick to work but hopefully it will lead you in the right direction.

* * *

## 回答 #3

> 赞同：3
> 
> 时间：2013-03-12T14:26:55.040

After a lot of research, I was able to find a way to also make this "COMPLUS_ZapDisable" technique work when attaching to an IIS-hosted application under IIS7/Windows 7 x64.

In my case, I'm using symbols constructed by Reflector Pro, although my guess is that it will also work for the Microsoft symbols that the OP asked about.

The trick is in finding the right place to set that environment variable so that your w3wp.exe is launched with that setting enabled. To do this, add a string key called "COMPLUS_ZAPDISABLE" to your registry at "HKEY_LOCAL_MACHINE\SYSTEM\CurrentControlSet\Control\Session Manager\Environment". Set the key value to "1", and that should do the trick. Don't do this on production =)

Kudos to Clive Tong, the author of [this post](http://www.red-gate.com/products/dotnet-development/reflector/debugging-experience) from Red Gate, for pointing me in the right direction.

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2008-11-17T02:18:26.640

The .NET framework code is optimized, so you will not be able to view all the variables as they probably don't exist in the optimized code. I assume you are trying to debug inside the .NET framework itself. Nothing much you can do about it unfortunatly.

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2009-04-30T07:54:04.193

Finally, this solution worked for me when attaching to the aspnet_wp.exe Visual Studio 2008, .NET framework 2.0 : go into the project properties, into Build tab, Advanced button -> set Output Debug Info to "full". Hope this helps someone.

# oracle - Oracle - 使用包

> ID：294741
> 
> 赞同：1
> 
> 时间：2008-11-17T02:17:26.720
> 
> 标签：oracle, plsql

我读过一些 PL SQL 编程书籍，它们建议我将过程、函数、游标等组合在一个包中。包提供模块化和信息隐藏，这是面向对象的设计。但是，我只熟悉独立程序。有人愿意提供一些代码示例以及如何从客户端调用包吗？我目前正在使用 ODP.NET 作为客户端应用程序中的数据访问。谢谢你。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2008-11-17T02:24:39.640

如果您熟悉调用独立过程，那么在包中调用过程并没有太大区别。只需在程序名称前加上包名称，如下所示：package_name.procedure_name。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2008-11-18T02:26:02.990

您将程序、函数等的代码与私有变量的声明一起放在包体中。您将这些过程和函数的声明以及公共变量放在包中。只有后者可以从包外部访问，为此您需要在它们的名称前面加上包名称和一个点。

您也可以为这个包定义数据结构类型：如果公共程序将它们用作输入或输出，那么它们必须公开；如果没有，那么您可以自由选择。

示例代码，来自内存且未经测试，因此其中可能存在错误：

```
create or replace package foo as
  a number;         
  function test1(s1 in varchar2) return varchar2;
  procedure test2(i1 in integer);
end;
/

create or replace package body foo as
  b number;  -- internal only
  function internalfunc(s in varchar2) return varchar2;

  function test1(s1 in varchar2) return varchar2 is
    s varchar2(32000);
    -- variables ...
  begin
    -- code ...
    return internalfunc(s);
  end;

  procedure test2(i1 in integer) is
    -- variables ...
  begin
    -- code ...     
  end;

  function internalfunc(s in varchar2) return varchar2 is
  begin
    return INITCAP(LOWER(s));    
  end;

end;
/ 
```

使用`foo.a`等`foo.test1`来使用这些函数和变量。您不能从包外部访问内部函数。如果它们被调用到比它们的实现更高的位置，它们只需要在包体的早期声明。

包与普通函数和过程相比有一个额外的优势：您可以重载它们的名称，在同一个包中拥有多个具有相同名称但具有不同参数类型的不同过程，并且将根据您使用的参数类型调用正确的函数。相比之下，独立函数或过程的名称必须是唯一的。

HTH。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2008-11-17T16:02:39.753

要跟进，你可能有一个独立的喜欢

```
create or replace procedure foo (i_something in varchar2) as
begin
   -- do some stuff;
end foo; 
```

你用“foo（'bar'）;”调用它

那将成为一个包和一个包体

```
create or replace package my_package as
   procedure foo (i_something in varchar2);
end;

create or replace package body my_package as
   procedure foo (i_something in varchar2);
   begin
      -- do some stuff;
   end foo;
end my_package; 
```

你用“my_package.foo('bar');”调用它

对于单个过程，使用包可能不会增加太多清晰度。但是，如果您要处理很多函数和过程，它会更干净。

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2008-11-18T02:26:21.710

使用包而不是仅仅声明具有全局范围的函数仍然是一种很好的做法。

如果你有包，它可以提供可扩展性，如果你碰巧想稍后添加具有相同上下文的函数，它可以使你的过程更清晰，因为它说明了从哪个库（包）调用的函数。

# delphi - 每次更改 TDbGrid 的选定位置时会触发什么事件？

> ID：294748
> 
> 赞同：4
> 
> 时间：2008-11-17T02:21:04.513
> 
> 标签：delphi, datagrid, event-handling

我的项目中有一个 TDbGrid，每次更改所选行时，我都会尝试触发一个事件。行中的任何更改都已更新链接到同一 DataSource 的所有数据感知控件，但还需要进行其他更改，我需要一个事件处理程序。

我认为 OnColEnter 会起作用。根据帮助文件，它在以下情况下触发：

*   用户使用键盘导航到单元格。例如，当用户使用 Tab 键或 Home 键时。

*   用户在单元格中单击鼠标按钮。

*   SelectedField 或 SelectedIndex 属性已设置。

不幸的是，当用户在启用 dgRowSelect 选项并且没有 OnRowEnter 的情况下使用键盘导航时，它*不会触发。*OnKeyDown 事件在选择更改之前触发。我正在尝试在这里模拟 TListBox 的数据感知版本，并且我需要一些东西来替换列表框的 OnClick 处理程序，尽管名称实际上在任何时候更改选择时都会消失，无论是通过鼠标还是键盘。有什么办法可以用 TDbGrid 做到这一点？如果没有，则必须有其他一些网格控件可以做到这一点。有谁知道它是什么？（最好是开源的？）

* * *

## 回答 #1

> 赞同：8
> 
> 时间：2008-11-17T05:21:42.607

您是否尝试过 DataSource 的 OnDataChange 事件？

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2008-11-17T15:47:15.557

OnDataChange 是一种选择。另一个是，在 TDataset 方面，事件 AfterScroll。大多数时候，我发现它比 OnDataChange 更实用；因为在 OnDataChange 中，滚动事件带有 Field 参数 nil（这是一个陷阱，可能是您的 AV 对其进行编码的原因之一）。

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2008-11-17T14:48:51.900

使用 OnDataChange 并处理加载数据集的情况，添加布尔检查作为例程的第一行，并在加载完成时将其设置为 false。

```
procedure TForm1.DataSource1DataChange(Sender: TObject; Field: TField);
begin
  if fbLoading then exit;
  // rest of your code here
end;

procedure TForm1.Form1Create(Sender:tObject);
begin
  fbLoading := true;
  // load your table here     
  fbLoading := false; 
end; 
```

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2008-11-17T18:36:29.990

我只会在数据集上使用 AfterScroll，当你第一次打开数据集时会触发它，每次你移动它时都会触发它。在 DBGrid 中，每次点击一行或滚动条，或使用键盘（Home、Edn、Up、Down、PgUp、PgDown）...等。

如果您以许多不同的形式（在创建/释放或显示/关闭）中使用相同的数据集，您甚至可以动态分配它：

```
procedure TForm1.myAfterScroll(DataSet: TDataSet); 
begin
   //do your thing here
   if oldAfterScroll<>nil then
      oldAfterScroll(DataSet);
end;

constructor TForm1.Create(AOwner: TComponent);
begin
   oldAfterScroll:=DBGrid1.DataSet.OnAfterScroll;
   DBGrid1.DataSet.OnAfterScroll:=myAdrerScroll;
end;

destructor TForm1.Free;
begin
   DBGrid1.DataSet.OnAfterScroll:=oldAfterScroll;
end; 
```

# java - 有谁知道 Maven2 POM 类路径容器的 Eclipse(WSAD/RAD) 插件

> ID：294752
> 
> 赞同：0
> 
> 时间：2008-11-17T02:26:09.963
> 
> 标签：java, maven-2, eclipse-plugin

我试图找到一个**简单**的单一用途插件，它将基于 Maven2 POM 依赖项维护 Eclipse 类路径。

我知道 m2eclipse 和 q4e。不幸的是，我目前正在使用 RAD（Rational Application Developer - IBM 的 Eclipse 商业版），它与 m2eclipse 不完全兼容，我无法使用 q4e，因为我使用的是 Maven 2.0.7，无法升级到2.1。

我几乎到了编写自己的容器插件的地步（可能基于一些 m2eclipse 源 :-)）但是在解决传递和父依赖项方面会有很多麻烦，所以希望有人已经做到了......

* * *

## 回答 #1

> 赞同：-1
> 
> 时间：2009-01-08T05:18:14.027

没有更好的答案，所以我最终编写了自己的插件。效果很好:-)

基本上我解析项目中的 pom.xml，这给了我父级（如果有的话）和依赖项。然后我查找它们并递归地执行相同的操作以生成要添加到容器中的 jar 的完整列表。

有很多关于属性和依赖管理的麻烦，我们的“团队”存储库被 Maven 1 和 Maven 2 poms（加上其他东西）的混合破坏了，所以我剥离了 Maven 2 命名空间，这样我就可以处理xml 相同（很巧合，这也意味着我可以使用简单的 xpath 查询 :-)）。

Rich，我可以将代码发送给您，但这是一个重大黑客攻击。我一直在想我应该重建它以利用依赖项：列表和/或依赖项：树的输出，但我可能需要先清理存储库。

# sql-server - 触发器以提醒删除和插入

> ID：294758
> 
> 赞同：0
> 
> 时间：2008-11-17T02:33:11.400
> 
> 标签：sql-server, sql-server-2005

我们如何创建触发器以在表上的任何插入或删除操作上发送电子邮件。它应该发送电子邮件，并且它应该具有服务器和数据库的位置。请告诉我。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2008-11-17T03:06:44.237

您需要在 SqlServer 2005 中设置 dbmail（如果您还没有）。
在触发器内部，只需发送如下内容：

```
EXEC msdb.dbo.sp_send_dbmail
@recipients=N'me@address.com',
@subject=@sbj,
@blind_copy_recipients=N'you@address.com, himtoo@address.com',
@body=@Msg ; 
```

显然填充变量 - 您可以从插入的数据中提取它们。在 BOL 中很容易找到基本的触发器信息，我们使用以下方法拉动插件：

```
(select * from inserted) 
```

然后分配给变量，如：

```
SELECT @Msg = MessageText, @Subject= Subject FROM Inserted 
```

其中 MessageText 和 Subject 将是插入行中的列。如果您愿意，只需为 Location 和 ServerName 添加您自己的变量...

# .net - 如何使用 .NET Compact Framework 显示动画 gif

> ID：294760
> 
> 赞同：6
> 
> 时间：2008-11-17T02:34:45.110
> 
> 标签：.net, animation, compact-framework, picturebox

我想在 .NET Compact 上显示动画 gif `Form`。目前我使用一个控件并在和`PictureBox`之间切换 。`.Visible = true``.Visible = false`

显示gif后`.Visible = true`，它不是动画的。如何让 .NET Compact Framework 为其设置动画？

我已经尝试过[了，](https://stackoverflow.com/questions/165735/how-do-you-show-animated-gifs-on-a-windows-form-c)但它不起作用。

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2008-11-17T06:49:33.363

默认情况下，.Net Compact 框架不支持在 Windows 窗体上显示基于 GIF 的动画。可以编写一个自定义动画器，它基本上会做同样的事情。这是一个示例类的链接，用于在紧凑框架上显示 GIF。

[http://msdn.microsoft.com/en-us/library/aa446483.aspx](http://msdn.microsoft.com/en-us/library/aa446483.aspx)

# python - 分发使用自定义 c 模块扩展的 python 程序的最佳方法是什么？

> ID：294766
> 
> 赞同：1
> 
> 时间：2008-11-17T02:43:21.520
> 
> 标签：python, c, linux, macos, software-distribution

我已经探索 python 好几年了，但现在我正在慢慢学习如何使用 c。使用[python 文档](http://www.python.org/doc/2.5.2/ext/intro.html)，我学会了如何用一些 c 扩展我的 python 程序，因为这似乎是开始使用它的合乎逻辑的方式。我现在的问题是如何分发这样的程序。

我想我的问题的核心是如何编译东西。我可以在我自己的机器（gentoo）上轻松地做到这一点，但是像 Ubuntu 这样的二进制发行版可能默认没有可用的编译器。另外，我有几个朋友是mac用户。我的直觉告诉我，我不能只用自己的机器编译然后在另一台机器上运行。任何人都知道我能做什么，或者一些在线资源来学习这样的东西？

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2008-11-17T02:55:54.240

Please read up on distutils. Specifically, the section on [Extension Modules](http://www.python.org/doc/2.5.2/dist/describing-extensions.html).

Making assumptions about compilers is bad policy; your instinct may not have all the facts. You could do some marketplace survey -- ask what they can handle regarding source distribution of extension modules.

It's relatively easy to create the proper distutils `setup.py` and see who can run it and who can't.

Built binary distributions are pretty common. Perhaps you can sign up some users will help create binary distributions -- with OS-native installers -- for some considerations.

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-10-07T19:49:15.060

S. Lott 是对的。您应该首先查看 distutils。在你从 distutils 中了解了你需要的东西之后，看看[setuptools](http://peak.telecommunity.com/DevCenter/setuptools)。Setuptools 建立在 distutils 之上，使您的用户可以轻松安装。你曾经使用过 easy_install 或 Python Eggs 吗？这就是接下来的事情。

# php - 将 XML 导入 MySQL 5.1

> ID：294771
> 
> 赞同：6
> 
> 时间：2008-11-17T02:46:36.537
> 
> 标签：php, sql, xml

请原谅我缺乏知识...我知道互联网上有很多与此相关的文档，但我仍然不明白。

我的情况是这样的：

我有一个需要导入并最终每天替换的 XML 文件。

```
 <item>
        <model>AA311-Pink</model>
        <title>1122</title>
        <price>19.43</price>
        <category>cat</category>
        <loc>/AA311.html</loc>
        <image>/aa311.jpg</image>
        <description>Item Info</description>
        <weight>0.45</weight>
        <option_type>Color-Color</option_type>
        <option_value>Pink-Pink</option_value>
        <suggested_retail>51.50</suggested_retail>
        <special_handling/>
        <manufacturer>Tantus</manufacturer>
        <manufacturer_code>VB5074 and VB5067</manufacturer_code>
        <packaging>Retail Packaging</packaging>
        <in_stock>Yes</in_stock>
        <lastupdated>2008-11-05 16:35:56</lastupdated> 
```

我需要自动更改一些列名并将它们导入数据库中的多个表中。

例如，

```
 <item>
        <products_model>AA315</products_model>
        <products_name>name</products_name>
        <price>19.43</price>
        <category>cat</category>
        <loc>/AA315.html</loc>
        <products_image>aa315.jpg</products_image>
        <products_description>info</products_description>
        <products_weight>0.44</products_weight>
        <option_type/>
        <option_value/>
        <products_price>51.50</products_price>
        <special_handling/>
        <manufactures_name>Tantus</manufactures_name>
        <manufacturer_code>VA5104</manufacturer_code>
        <packaging>Retail Packaging</packaging>
        <products_status>Yes</products_status>
        <products_last_modified>2008-11-05 16:35:27</products_last_modified> 
```

然后导入 MySQL DB

列：products_weight、products_model、products_image、products_price、products_last_modified

导入表“产品”

列：products_description、products_name

导入表'product_description

还有自动创建的 product_id 呢？我可以发送表结构的 SQL 输出。

我真的很感激帮助...如果他们愿意创建一个全自动程序将此文件导入我的数据库，我愿意支付一些费用；我正在使用 Zen Cart 来托管我的购物车。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-01-18T20:16:21.667

你应该阅读这个 - 将 XML 加载到 MySQL [http://dev.mysql.com/doc/refman/5.5/en/load-xml.html](http://dev.mysql.com/doc/refman/5.5/en/load-xml.html)

这使您可以执行以下操作：

```
mysql> LOAD XML LOCAL INFILE 'items.xml'
    ->   INTO TABLE item
    ->   ROWS IDENTIFIED BY '<item>'; 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2008-11-17T12:58:25.057

无需付费，[在 MySQL 5.1 和 6.0 中使用 XML](http://web.archive.org/web/20100105150533/http://dev.mysql.com/tech-resources/articles/xml-in-mysql5.1-6.0.html#xml-5.1-importing)将回答您的大部分问题。此外，回到顶部并阅读整个页面，您可以使用 XML 和 MySQL 做很多事情。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2014-05-05T11:59:59.910

是的，谢谢 gx，[http: //web.archive.org/web/20100105150533/http://dev.mysql.com/tech-resources/articles/xml-in-mysql5.1-6.0.html#xml-5.1-导入](http://web.archive.org/web/20100105150533/http://dev.mysql.com/tech-resources/articles/xml-in-mysql5.1-6.0.html#xml-5.1-importing)为我做了。我使用了那里提到的存储过程，但是如果你想导入到另一个表而不是't1'，它有一个小错误。只需更换线路

```
SET @ins_text = CONCAT('INSERT INTO t1 (', ins_list, ') VALUES (', val_list, ')'); 
```

和

```
SET @ins_text = CONCAT('INSERT INTO ', database_name, '.', table_name, ' (', ins_list, ') VALUES (', val_list, ')'); 
```

通过执行程序

```
call xmldump_load('<filename>', '<schema>', '<tablename>'); 
```

在调用此过程之前，请确保要导入的文件是可访问的，例如在 mysql 的数据文件夹 (/var/lib/mysql/) 中，并使用具有 FILE 权限的用户执行它。

# .net - 使用 iTextSharp 与 Barcode.4NET 生成的 Code128A 条码匹配问题

> ID：294773
> 
> 赞同：3
> 
> 时间：2008-11-17T02:46:59.127
> 
> 标签：.net, itextsharp, itext, barcode

首先，我对条形码格式和我所知道的有点陌生，我从维基百科学到了。

我们有一些由使用 Barcode.4NET 库的现有应用程序生成的条形码。条形码采用 Code 128A 格式。生成它们的代码非常简单，如下所示：

```
// Create the barcode
Code128ABarcode c128A = new Code128ABarcode("045746201627080857"); 
```

没有为它设置其他参数 - 设置数据后，我们只是从库中获取条形码的 GIF 版本。

我正在开发一个使用 iTextSharp 生成 PDF 的新应用程序，我认为我不会使用两个库，而是使用 iTextSharp 的条形码生成库，因为它支持 Code128 条形码。它有一些不同的 Code 128 变体，但没有一个是“Code 128A”。

这是代码的样子：

```
Barcode128 code128 = new Barcode128();
code128.CodeType = Barcode.CODE128;
code128.ChecksumText = true;
code128.GenerateChecksum = true;
code128.StartStopText = true;
code128.Code = "045746201627080857"; 
```

下图显示了我迄今为止所取得的最好成绩。

![替代文字](https://farm4.static.flickr.com/3187/3037044282_c6396bc09a.jpg)

上图由 iTextSharp 生成，下图由 Barcode4Net 生成。显然，它们不一样（不仅在大小和字体上——条形码数据也大不相同）。

是否有人对 iTextSharp（或 iText 本身）的条形码组件或 Code 128A 条形码足够熟悉，可以告诉我如何使 iTextSharp 看起来与 Barcode.4NET 完全一样？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2008-11-17T02:59:36.370

数量应为：

```
*045746201627080857* 
```

您需要在开头和结尾添加星号以便可以读取条形码，您需要在组件文档中检查是否需要此字符。

扫描仪需要这种类型的 BC 的前导星号和尾随星号。

对于我在您的代码中可以看到的内容，该行

```
code128.StartStopText = true; 
```

自动添加它，尝试将此属性设置为 false，您将得到相同的条形码。在您应该使用的第一个代码中

```
Code128ABarcode c128A = new Code128ABarcode("*045746201627080857*"); 
```

自己试试:)

**编辑：**

正确的条形码是：

[![替代文字](https://web.archive.org/web/20210225033914/http://www.bcgen.com/demo/linear-dbgs.aspx?D=045746201627080857&S=13&CS=1)](https://web.archive.org/web/20210225033914/http://www.bcgen.com/demo/linear-dbgs.aspx?D=045746201627080857&S=13&CS=1)

从下面的链接（使用[ID 自动化免费服务](https://www.barcodefaq.com/barcode-properties/symbologies/code-128a/)）：

```
http://www.bcgen.com/demo/linear-dbgs.aspx?D=045746201627080857&S=13&CS=1 
```

你所拥有的是：

[![替代文字](https://web.archive.org/web/20210225033919/http://www.bcgen.com/demo/linear-dbgs.aspx?D=045746201627080857&S=13&CS=3)](https://web.archive.org/web/20210225033919/http://www.bcgen.com/demo/linear-dbgs.aspx?D=045746201627080857&S=13&CS=3)

这是**Code128C**而不是**Code128A**，因为您可以检查链接（我将[条形码属性](https://www.idautomation.com/barcode-components/iis-streaming-server/user-manual/#web_barcode_properties)更改为 Code128C）

[http://www.bcgen.com/demo/linear-dbgs.aspx?D=045746201627080857&S=13&CS=3](http://www.bcgen.com/demo/linear-dbgs.aspx?D=045746201627080857&S=13&CS=3)

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2008-11-17T04:44:18.563

他们真的有必要看起来完全一样吗？Code 128 的不同版本都可以对数字进行编码，即使条形码本身看起来完全不同；读者应该在最后把它全部整理出来。

我更喜欢 B 变体，因为除了大写字母之外，它还有小写字母。[您可以在http://www.barcodeisland.com/code128.phtml](http://www.barcodeisland.com/code128.phtml)上查看详细说明差异的表格

iTextSharp 看起来像是在生成变体 C，如果文本只有十进制数字，这是最紧凑的。它在与其他编码中的单个字符相同的空间量中编码 2 位数字。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2008-11-17T05:06:45.537

虽然我认为 balexandre 把发电机搞混了，但他的建议是好的。

显然 Barcode.4NET 正在正确生成我试图模拟的 Code 128A 条形码。

iTextSharp 正在生成一个 Code 128C 条形码，根据 Mark Ransom 的说法，它应该没问题，除了用户和客户可能会看到它并说“它太短了，应该看起来像其他的一样！”

所以，很好的建议，但我仍然回到“如何使用 iTextSharp 生成 Code 128A 条形码？”

# wcf - 为什么 WCF 类绑定没有成员 ReaderQuotas？

> ID：294774
> 
> 赞同：1
> 
> 时间：2008-11-17T02:48:56.267
> 
> 标签：wcf, binding, mex, readerquotas

我想知道为什么 WCF 中的类**Binding**没有属性***ReaderQuotas***，而它的子类**BasicHttpBinding**和**WSHttpBinding**有。

这个事实使编码有点困难。对我来说，我使用下面的代码从 MEX 端点 URI 中提取绑定信息。但是，它刚刚获得了绑定。如果我想更改绑定的***ReaderQuotas***，我必须将其向下转换为**Binding**的子类，但我无法在运行时告诉确切的绑定。

```
public static void LoadMex(string serviceMexUri,
    ContractDescription contract,
    out EndpointAddress endpointAddress,
    out Binding serviceBinding)
{
    EndpointAddress mexAddress = new EndpointAddress(serviceMexUri);
    MetadataExchangeClient mexClient = new MetadataExchangeClient(mexAddress);
    mexClient.ResolveMetadataReferences = true;
    mexClient.OperationTimeout = TimeSpan.FromSeconds(30);

    MetadataSet metaSet = mexClient.GetMetadata();
    WsdlImporter importer = new WsdlImporter(metaSet);
    ServiceEndpointCollection endpoints = importer.ImportAllEndpoints();

    foreach (ServiceEndpoint ep in endpoints)
    {
        // we just use one endpoint for now.
        if ((ep.Contract.Namespace == contract.Namespace) &&
             (ep.Contract.Name == contract.Name))
        {
            endpointAddress = new EndpointAddress(ep.Address.Uri);
            serviceBinding = ep.Binding;
            return;
        }
    }
    throw new ApplicationException(String.Format("no proper endpoint is found from MEX {0}", serviceMexUri));
} 
```

有人知道为什么 WCF 是这样设计的吗？

有没有办法解决这个限制？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2008-11-17T19:59:15.953

原因是绑定旨在用作通用通信基础设施，而 ReaderQuotas 是 SOAP 特定对象。这就是为什么您只在打算与 SOAP 消息传输一起使用的绑定上看到它的原因。

尝试转换为您想要支持的类型的“as”语句可能是您最好的选择。

# c# - 窗口句柄 C#/.NET

> ID：294775
> 
> 赞同：1
> 
> 时间：2008-11-17T02:49:20.637
> 
> 标签：c#, .net, interop

使用窗口句柄时，使用普通的**IntPtr是否足够***好*，或者我应该**继承 SafeHandle**吗？

 ****有什么显着的优点/缺点吗？

谢谢。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2008-11-17T03:57:25.037

那要看 ：）

如果句柄以这样一种方式返回，您最终必须在它们上调用 ::CloseHandle 的一个版本，那么您应该始终继承 SafeHandle。SafeHandle 在 .Net Framework 中提供了最强有力的保证，即释放句柄。不释放 IntPtr 将导致资源泄漏。足够多的资源泄漏最终会导致程序崩溃。

如果不需要释放句柄，那么传递 IntPtr 就足够了。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2008-11-17T04:10:17.117

我认为这`SafeHandle`不会增加任何价值。MSDN 对 s 的使用提供了以下注释`SafeHandle`（强调我的）：

> SafeHandle 类为句柄回收安全攻击提供保护；它还提供句柄资源的关键最终确定。此类允许您将句柄传递给非托管代码，该句柄指向包装在派生类实例中的非托管资源（例如操​​作系统句柄）。**它通过回收句柄提供针对安全攻击的保护**。句柄回收的一个示例是句柄的不受信任的用户尝试在一个线程上对资源进行排队操作，同时关闭另一个线程上的句柄。不受信任的用户会这样做，希望进程中的某个不相关线程立即重用句柄，并且进程内操作返回或更改调用者通常无法访问的数据。**SafeHandle 还提供关键的最终确定**：即使 AppDomain 被主机卸载，或者正常的终结器阻塞或清理时间过长，ReleaseHandle 方法也会运行。

`Control`这两个目标似乎都不适用于从 Windows 窗体对象返回的窗口句柄。`Control`考虑到 a 属性的典型用法，句柄回收似乎没有实际意义`Handle`，并且框架和操作系统通过窗口句柄从您手中解决了任何最终确定问题。

另一种思考方式是：要使用`SafeHandle`，您必须提供`IsInvalid`属性和`ReleaseHandle`方法的实现。据我所知，该`Control.Handle`属性永远不会返回无效值，并且窗口句柄将并且应该仅在释放控件时“释放”。

That said, the framework itself does wrap window handles in a `HandleRef` object when it uses them, which simply protects the control from the garbage collector while the handle is being used by unmanaged code. This is something you're unlikely to need in the typical scenarios you'd need a window handle, but it takes almost no work to use it, if there's a possibility you might need it.

# javascript - 在 Ajax Adob e AIR 应用程序中与 API 共享密钥

> ID：294777
> 
> 赞同：4
> 
> 时间：2008-11-17T02:51:11.787
> 
> 标签：javascript, ajax, api, air, flickr

我对开发 AIR 应用程序很陌生，所以也许这是一个愚蠢的问题，但我似乎无法从谷歌找到任何答案。非常感谢您能给我的任何帮助。

我正在使用与 flickr 的 Api 相同的 API 使用 Ajax 构建一个 AIR 应用程序，并具有共享密钥。问题是空气安装包包含所有源，我不想泄露我的共享秘密。有没有办法做到这一点？我可以隐藏一些来源，或者以某种方式在应用程序中包含这个共享秘密而不泄露它吗？

谢谢你的帮助。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2008-11-24T10:12:05.623

您可能希望使用[EncryptedLocalStore](http://help.adobe.com/en_US/AIR/1.5/jslr/flash/data/EncryptedLocalStore.html)安全地存储您的 API 密钥。

但是，您将无法将其与应用程序一起分发，因为商店的加密取决于应用程序在哪个操作系统上运行。

在应用程序安装时，一种播种商店的方法是：

1.  运行安装程序
2.  根据需要运行安装后脚本。
3.  检查商店。如果没有密钥，请从您的网站下载密钥并将其存储在 ELS 中。

使用这种方法，用户永远不会知道您的密钥，但它会出现在应用商店中。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2008-11-17T03:33:14.853

第一个问题 - 许可证是否允许您编写应用程序并将其提供给其他人使用您的密钥，而不是拥有自己的密钥？

如果是这样，并且如果这是一个与 AIR 兼容的 SDK，他们应该有一些他们推荐的方法。

编辑：

[这个问题](https://stackoverflow.com/questions/86163/why-do-i-need-a-flickr-api-key)描述了 flickr 如何通过密钥提供对额外资源的访问。如果这是一个 AIR 应用程序，您是否跳过沙盒圈来提供同时提供互联网和桌面应用程序？

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2008-12-23T12:53:18.823

我要么将密钥存储在服务器上，然后使用 SSL (https://) 和[flash.net.URLLoader](http://livedocs.adobe.com/flex/3/langref/index.html)类检索它，要么将其存储在加密的[SQLite 数据库](http://help.adobe.com/en_US/AIR/1.5/devappshtml/WS34990ABF-C893-47ec-B813-9C9D9587A398.html)中。显然，如果您还没有使用它，数据库会产生更多的开销，所以如果您现在或将来不打算使用 SQLite 数据库，我会选择第一个选项。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2008-12-23T21:47:27.293

您可以像提到的 Pierre-Yves Gillier 一样使用 EncryptedLocalStore。有一种方法可以检测应用程序是否从第一次运行。但我会选择这种方法：

检查 Encryptedlocalstore 是否有 api 密钥，如果没有，则从服务器获取它并存储它。

# lisp - 函数名称作为 Lisp 中的字符串？

> ID：294779
> 
> 赞同：10
> 
> 时间：2008-11-17T02:52:09.227
> 
> 标签：lisp, common-lisp

我有一大堆全局变量，每个变量都有自己的设置函数。我的目标是通过这个列表，调用每个项目的设置函数，并生成匹配变量中加载的数据的一些统计信息。但是，我现在尝试的方法不起作用，我需要帮助才能让我的程序调用设置函数。

全局变量及其设置函数是区分大小写的，因为它来自 XML 并且是唯一性所必需的。

数据看起来像这样：

```
'(ABCD ABC\d AB\c\d ...) 
```

设置函数如下所示：

```
(defun setup_ABCD...  
(defun setup_ABC\d... 
```

我尝试将它们连接在一起并将生成的字符串转换为函数，但这会干扰先前加载的设置函数的命名空间。这是我尝试实现的方法：

```
(make-symbol (concatenate 'string "setup_" (symbol-name(first '(abc\d))))) 
```

但是`funcall`在这个上使用是行不通的。如何从中获取可调用函数？

* * *

## 回答 #1

> 赞同：12
> 
> 时间：2008-11-17T02:58:52.783

这是因为 MAKE-SYMBOL 返回了一个 uninterned 符号。您应该改用 INTERN。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2008-11-17T12:35:51.870

我要么使用 INTERN 要么（可能，你必须配置文件以 100% 确定它有帮助）一个辅助函数，它执行字符串连接和初始查找，然后将结果缓存在哈希表中（键控原始符号）。这可能比纯 INTERN/CONCATENATE 解决方案更快，可能会产生更少的瞬态垃圾，但最终可能会使用更长期的存储。

类似于以下内容：

```
(defvar *symbol-function-map* (make-hash-table))

(defun 查找符号 (符号)
  （或（gethash 符号 *symbol-function-map*）
      (let ((function-name (intern (concatenate 'string "setup_" (symbol-name symbol)))))
        (setf (gethash symbol *symbol-function-map*) (symbol-function function-name)))))

```

如果您需要函数的名称，而不是函数本身，请忽略对 SYMBOL-FUNCTION 的调用。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2011-07-22T14:48:06.103

```
(funcall (read-from-string (concatenate 'string "setup_" (symbol-name(first '(abc\d)))))) 
```

也可以。

# asp.net - ASP.NET ModalPopup 不执行代码

> ID：294795
> 
> 赞同：1
> 
> 时间：2008-11-17T03:06:10.773
> 
> 标签：asp.net, modalpopupextender

W当我单击弹出窗口上的按钮将数据插入数据库时​​，它什么也不做，为什么？

```
<cc1:ModalPopupExtender ID="ModalPopupExtender1" runat="server" BehaviorID="popup" TargetControlID="cmdTrigger" 
            PopupControlID="pnlPopup" BackgroundCssClass="modalBackground"
            OkControlID="btnOk" >
    </cc1:ModalPopupExtender>  
    <asp:Panel ID="pnlPopup" runat="server" CssClass="modalpopup" Style="display: none">
        <div class="container">
            <div class="header">
                <asp:Label ID="Label1" runat="server" CssClass="msg" Text="Add a new Entry" />
                <asp:LinkButton ID="LinkButton1" runat="server" CssClass="close" OnClientClick="$find('popup').hide(); return false;" />
            </div>
            <div class="body">
                <asp:Label ID="Label2" runat="server" CssClass="msg" Text="Name" />
                <asp:TextBox ID="txtName" runat="server" Width="346px"></asp:TextBox>
                </div>
            <div class="footer">
                <asp:Button ID="btnOk" runat="server" Text="Save" Width="48px"   />
                <asp:Button ID="btnCancel" runat="server" Text="Cancel" Width="50px" OnClientClick="$find('popup').hide(); return false;" />
            </div>
        </div>
    </asp:Panel> 
```

btnOK 上的代码是

一个简单的 textbox1.text = txtName

我什至尝试设置断点，按钮单击事件没有被执行。有任何想法吗？

编辑~解决方案

> 关注[http://forums.asp.net/t/1070213.aspx](http://forums.asp.net/t/1070213.aspx)

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2008-11-17T03:09:26.913

删除 OkControlId 属性，因为我认为它可以防止发生回发。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-05-18T13:18:46.967

删除`CausesValidation="false"`任一使其成为现实。它会起作用的。

# database - 将数据库与 Clojure 一起使用

> ID：294802
> 
> 赞同：40
> 
> 时间：2008-11-17T03:14:10.507
> 
> 标签：database, clojure

有哪些使用 Clojure 数据库的方法？

我从 Clojure 知道你可以用 Java 做任何你能做的事情，但这意味着我最终可能会使用与 Clojure 简单性相冲突的过于复杂的东西（比如 Hibernate）。有什么建议或意见吗？

* * *

## 回答 #1

> 赞同：19
> 
> 时间：2008-11-17T03:45:29.850

[clojure-contrib](http://sourceforge.net/projects/clojure-contrib)有一个 sql 库，它是 JDBC (java.sql.DriverManager) 的一个瘦包装器。附带的测试文件有一些使用示例。

* * *

## 回答 #2

> 赞同：14
> 
> 时间：2011-11-04T10:20:25.280

我现在（截至 2011 年底）推荐[Korma](http://sqlkorma.com/) -“用于 Clojure 的美味 SQL”

这是一个漂亮的小 SQL DSL，这是网站上的一个示例：

```
(select users
  (aggregate (count :*) :cnt)
  (where (or (> :visits 20)
             (< :last_login a-year-ago)))) 
```

* * *

## 回答 #3

> 赞同：8
> 
> 时间：2008-11-24T03:49:08.967

如果您愿意使用 Java 库但想要一些简单的东西，那么您可能会喜欢[Persist](https://github.com/rufiao/persist)。只需 10 分钟即可查看它是否符合您的需求。

* * *

## 回答 #4

> 赞同：8
> 
> 时间：2011-11-14T13:34:58.177

为了任何从谷歌来到这里的人，我想添加一个截至 2011 年 11 月的答案。

Clojure 1.3 中当前的核心 SQL 访问库是 clojure.java.jdbc。在此基础上构建了一些非常好的库，例如[ClojureQL](http://clojureql.org/)和[Korma](http://sqlkorma.com/)。

* * *

## 回答 #5

> 赞同：8
> 
> 时间：2015-02-25T20:56:17.397

最新最好的 SQL 数据库似乎是[HoneySQL](https://github.com/jkk/honeysql)和[Yesql](https://github.com/krisajenkins/yesql)。

**HoneySQL**是一种非常优雅的 DSL，用于生成 SQL 查询。有传言说它甚至可以修改语句以进行高度优化，请参阅 clojure-group 线程“ [Current best-of-breed JDBC library?](https://groups.google.com/forum/#!topic/clojure/SgqL_zDvPdw) ”，来自 2015 年 2 月 24 日。

Niels van Klaveren 在上述帖子中说：

“基本上，它 [HoneySQL] 生成 SQL 脚本以重新链接外键引用以清理数据库中的重复项。它需要一个带有（至少）一个`from`表、一个`group-by`和一个`order-by`子句的 Honeysql 选择查询作为基本定义要考虑的内容双打, 并且应该保留记录的顺序. 结合 JDBC 元数据, 查询有效地被重写以生成：

*   临时替换表
*   统一唯一索引的查询，以防止更新外键引用时发生冲突
*   更新所有外键引用的查询
*   删除语句以删除所有重复项

为了创建性能最好但仍然独立于数据库的 SQL，我不得不使用额外的子句来扩展 honeysql，比如`OVER`and `PARTITION BY`。我不会说它轻而易举，但似乎工作得很好。

...

这将 SQL 减少到（有时）GB 的脚本到大约 100 行 SQL，并且有一次，运行时间从 19 小时减少到 1.5 分钟。”

**另一方面，**Yesql旨在完全简单。**它定义了一些函数来加载参数化`.sql`的文件。**

 **它的网页提到了以下“USP”：

*   没有语法上的惊喜。您的数据库不遵守 SQL 标准——它们都不遵守——但 Yesql 不在乎。您永远不会花时间寻找“等效的 sexp 语法”。你永远不需要回退到一个`(raw-sql "some('funky'::SYNTAX)")`函数。
*   更好的编辑器支持。您的编辑器可能已经拥有很好的 SQL 支持。通过将 SQL 保留为 SQL，您可以使用它。
*   团队互操作性。您的 DBA 可以读写您在 Clojure 项目中使用的 SQL。
*   更容易的性能调整。需要解释那个查询计划吗？当您的查询是普通 SQL 时，这会容易得多。
*   查询重用。将相同的 SQL 文件放到其他项目中，因为它们只是普通的 SQL。将它们作为子模块共享。

* * *

## 回答 #6

> 赞同：5
> 
> 时间：2009-03-20T11:12:35.727

我在 Clojure 中将[Berkeley DB用于一个简单的键/值数据库。](http://www.oracle.com/technology/products/berkeley-db/je/index.html)见[这里](http://github.com/schani/flickr-clojure/blob/3a65b232bc95221f799b57a20c2b5f60f5b13aca/at/ac/tuwien/complang/persistence_bdb.clj)。

* * *

## 回答 #7

> 赞同：4
> 
> 时间：2010-11-19T13:35:40.167

ClojureQL包含了关系代数[。](https://github.com/LauJensen/clojureql)

* * *

## 回答 #8

> 赞同：4
> 
> 时间：2014-11-17T23:46:04.257

现在有[Datomic](http://www.datomic.com/)和许多类似的解决方案，如[DataScript](https://github.com/tonsky/datascript) ，它们也用于非常有趣的关系（非 sql！）数据库功能。

* * *

## 回答 #9

> 赞同：1
> 
> 时间：2010-11-11T08:07:49.233

如果您需要持久连接和/或与多个数据库的连接，并且不想经常重新建立连接，我建议您使用数据库连接池。像 BoneCP 或 Tomcat CP 之类的东西。

您可以将这些包中的数据源提供给 (clojure.contrib.sql/with-connection ...)。

* * *

## 回答 #10

> 赞同：1
> 
> 时间：2016-04-14T12:30:57.727

然后是 SQLLite。看看这个简单的例子：[https ://github.com/ogrim/clojure-sqlite-example](https://github.com/ogrim/clojure-sqlite-example)

* * *

## 回答 #11

> 赞同：1
> 
> 时间：2018-10-03T20:11:25.460

首先，从导入库

```
 (ns clojureexercise.test
    (:require [clojure.java.jdbc :as sql])) ;;sql will alias used further in code to access java jdbc feature. 
```

其次，下面的功能允许您连接 MySQL 服务器。就像在 Java 中一样，我们声明数据库变量来启动 DB，在这里我们必须定义数据库连接的方式相同，在下面的代码中，您可以看到 db 变量是在 dbconnect 函数中定义的。db 变量将在运行查询中进一步使用。

```
(defn dbconnect []
  (def db{   
         :classname "com.mysql.jdbc.Driver" 
         :subprotocol "mysql"
         :subname "//127.0.0.1:3306/testdb" ;;testdb is the name of database
         :user "root"
         :password "password"})) 
```

现在，

```
;;Inserting Data into Database 
;;Table Name is patientinfo, consist columns {id, firstname, lastname, birthdate, gender}
 (defn insertdata []
  (sql/insert! db :patientinfo                    ;;used sql alias and db variable to insert data into table 
  {:id 1 :firstname "Satyam" :lastname "Ramawat" 
   :birthdate "1/1/2018" :gender "Male" })) 
```

我将详细说明这一点：

> **sql/插入！数据库：患者信息**

**sql**将启用插入查询功能，而**db**将允许系统了解必须在哪个表上插入哪个数据库连接的记录。

* * *

## 回答 #12

> 赞同：0
> 
> 时间：2011-01-09T09:12:39.200

你也可以试试 CLJ-Record，[https://github.com/duelinmarkers/clj-record](https://github.com/duelinmarkers/clj-record)

# asp.net - 为什么通过 Silverlight 2 上传的文件仅限于 .TXT 文件？

> ID：294805
> 
> 赞同：0
> 
> 时间：2008-11-17T03:17:27.630
> 
> 标签：asp.net, wcf, silverlight, web-services

我有一个 Silverlight 2 应用程序，它将一个字节数组发送到启用 Silverlight 的 WCF 服务。但是，（除非我尝试上传 .txt 文件）该服务的`SaveFile()`方法永远不会到达并且我得到一个错误：“远程服务器返回一个错误：NotFound”

我错过了一些非常明显的东西吗？为什么我不能上传 .doc 文件？为什么只有.txt？

更新：我尝试为 CLR 异常附加调试器，但这没有帮助。除了 404 之外，我仍然看不到任何错误。这是我的代码：

**在 Page.xaml.cs 中：**

```
OpenFileDialog dlg = new OpenFileDialog();

if (dlg.ShowDialog().Value)
{
  byte[] fileContent = new byte[dlg.File.Length];

  using (FileStream fs = dlg.File.OpenRead())
  {
    fs.Read(fileContent, 0, Convert.ToInt32(fs.Length));
    fs.Close();
  }

  Service1.Service1Client srv = new SL1.Service1.Service1Client();

  srv.SaveFileCompleted += (sender1, e1) =>
  {
    foo.Text = "Uploaded!";
  };

  srv.SaveFileAsync(dlg.File.Name, fileContent);
} 
```

**在 Service1.svc.cs 中：**

```
[OperationContract]
public string SaveFile(string fileName, byte[] fileContent)
{
  string ret = String.Empty;

  try
  {
    string target = @"c:\debug123\" + fileName;

    if (File.Exists(target))
    {
      File.Delete(target);
    }

    File.WriteAllBytes(target, fileContent);

    ret = "OK";
  }
  catch (Exception ex)
  {
    ret = ex.ToString();
  }

  return ret;
} 
```

有人看到这有什么问题吗？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2008-11-19T12:24:40.240

仅供参考，我发现了我的问题，[这篇文章](http://michaelsync.net/2008/03/27/uploading-with-silveright-2-beta-1-and-wcf)解决了它。“默认情况下，可以从客户端发送到服务的最大消息是 8124 字节。” 所以我不得不通过绑定配置设置来增加限制。

但现在我的主要问题是如何获得适当的错误消息，而不是 404。我将不得不研究更多，但希望其他人能想出一个好的答案（不幸的是，打破 CLR 异常并没有帮助我）。

UPDATE: Upon further reading of [the same article](http://michaelsync.net/2008/03/27/uploading-with-silveright-2-beta-1-and-wcf), I discovered that the WCF Service Configuration Utility that is included in the Windows SDK can help determine the underlying problem.

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2008-11-17T07:52:28.153

我不确定具体的问题是什么，但我可以告诉你，上传绝对不限于 .txt 文件——我已经上传了 10MB WMV 文件，没有问题。也许是服务端的编码导致了问题？

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2008-11-17T08:13:12.727

没有这样的限制。

将调试器附加到服务并检查引发了哪个异常。为此，您需要将 Visual Studio 设置为在异常发生时中断异常（而不是未处理）。通过选中“Common Language Runtime Exceptions”行上的左侧复选框，在 Debug->Exceptions 对话框中执行此操作。

通过将调试器附加到服务（调试->附加到进程），您将能够看到真正的错误。NotFound 错误是一般错误 - 真正的错误仅在服务端可见。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2008-11-18T22:37:20.097

这听起来像你的问题查看[http://www.yoda.arachsys.com/csharp/readbinary.html](http://www.yoda.arachsys.com/csharp/readbinary.html)和[http://social.msdn.microsoft.com/Forums/en-US/wcf/thread/ea40b542-c7e1 -4a4f-b974-7ecc03cbd475/](http://social.msdn.microsoft.com/Forums/en-US/wcf/thread/ea40b542-c7e1-4a4f-b974-7ecc03cbd475/)

# vba - Word VBA 访问自定义词典的内容

> ID：294806
> 
> 赞同：1
> 
> 时间：2008-11-17T03:18:59.467
> 
> 标签：vba, ms-word

我需要检查 Word 文档中的各种代码。

这些代码通常是一个字母后跟一个连字符和 5 位数字，例如 M-81406。

我们需要检查这些预定义的代码是否输入正确（有几千个代码的预定义列表）。我们不能使用普通的 Word 拼写检查，因为您不能拼错数字（您至少需要 2 个字母）。

我想我可以编写 VBA 代码来发现任何可能无效的内容。我可以使用正则表达式来检查它们。

我可以从 VBA 访问自定义字典的内容吗？

我需要一个可由客户轻松更新的解决方案。

奖金指向任何提出突出错误代码的聪明方法的人。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2008-11-17T05:54:13.617

您可能知道，自定义词典只是一个包含单词的文本文件，因此请参考 Microsoft Scripting Runtime，并使用：

```
Dim FSO As New FileSystemObject, FS As TextStream
Dim Code As String, Codes As New Scripting.Dictionary
Dim Paragraph As Paragraph, Word As Range

Set FS = FSO.OpenTextFile("c:\...\cust.dic")

Do Until FS.AtEndOfStream
    Code = FS.ReadLine
    If Not Codes.Exists(Code) Then Codes.Add Key:=Code, Item:=Nothing
Loop

' Use your own method for enumerating words
For Each Paragraph In ActiveDocument.Paragraphs
    Set Word = Paragraph.Range
    Word.MoveEnd WdUnits.wdCharacter, -1

    If Not Codes.Exists(Word.Text) Then
        Word.Font.Underline = wdUnderlineWavy
        Word.Font.UnderlineColor = wdColorBlue
    Else
        Word.Font.Underline = wdUnderlineNone
        Word.Font.UnderlineColor = wdColorAutomatic
    End If
Next 
```

不理想，因为它破坏了下划线格式，并且不提供建议机制（尽管围绕列表框构建的小表单就足够了）。

不幸的是，最好的解决方案是扩展拼写引擎。

# java - 在 Java 中嵌入 Web 浏览器窗口

> ID：294813
> 
> 赞同：10
> 
> 时间：2008-11-17T03:23:16.777
> 
> 标签：java, swing, browser, embed

有谁知道在集成到 Java 应用程序中的 Swing 窗口中打开平台（Windows/Linux/Mac）浏览器实例的方法。除了打开给定的 URL 之外，不会执行任何其他操作。目前，我们打开一个新的浏览器窗口，因为Java嵌入式浏览器已经不够用了。然而，从用户交互的角度来看，这并不理想。

我很好奇这个解决方案是否是 1.6 Java 版本的一部分。所以，到目前为止，我的 google-foo 还没有出现任何值得注意的东西。是否有任何封闭源代码库可以做到这一点？任何事物？

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2008-11-17T03:41:00.703

[JDIC](https://jdic.dev.java.net/)

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2008-11-17T06:07:54.417

使用[JEditorPane](http://docs.oracle.com/javase/1.4.2/docs/api/javax/swing/JEditorPane.html)

> 用于编辑各种内容的文本组件。默认情况下，已知以下类型的内容：text/plain、text/html 和 text/rtf

或[路宝](http://lobobrowser.org/java-browser.jsp)

> Lobo 是一个完全用 Java 编写的开源 Web 浏览器。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2008-11-21T09:31:04.177

我们也使用 JDIC，它适用于我们在 Windows 中；但是，将其配置为在 *nix/OS X 中工作可能会很痛苦，因为它只是使用平台原生浏览器（支持 IE 和 Mozilla），而在 Linux/Mac 上您可能两者都没有——这就是问题所在。

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2009-02-02T00:27:08.870

[WebRenderer](http://www.webrenderer.com/)是一种商业产品，可以做到这一点，而且做得很好。然而，我最后一次检查它也相当昂贵（他们想要为*大量*客户支付每客户 2 美元的费用，以及一份 1000 美元的支持合同）。

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2009-09-29T20:03:37.470

MozSwing 它是免费的或 JxBrowser 或 JExplorer ($500)

# wpf - 组合框项目的货币格式

> ID：294822
> 
> 赞同：2
> 
> 时间：2008-11-17T03:33:20.140
> 
> 标签：wpf, combobox, converters

我有一个绑定到小数的 ObservableCollection 的 ComboBox。将我们的货币转换器应用于商品的正确方法是什么？

编辑：

a) 我有一个必须使用的现有货币转换器 b) .NET 3.0

我需要对项目进行模板化吗？

* * *

## 回答 #1

> 赞同：10
> 
> 时间：2008-11-17T03:42:20.670

您可以使用 ComboBox 上的 ItemStringFormat 属性来告诉它如何格式化每个项目：

```
<ComboBox ItemStringFormat="c"> 
```

但是，请注意，当使用“c”作为货币格式化程序时，它将使用本地机器定义的货币。如果您的值以 $ 定义，但您的客户端 PC 使用英镑或日元作为其货币符号，他们将不会看到您希望他们看到的内容。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2008-11-17T04:51:18.207

如果您有一些代码来进行转换，那么您最好的选择确实是通过模板通过 IValueConverter 运行每个项目。

```
<Window.Resources>
    <my:CurrencyConverter x:Key="currencyConverter" />

    <DataTemplate x:Key="thingTemplate" DataType="{x:Type my:Thing}">
        <TextBlock
            Text="{Binding Amount,Converter={StaticResource currencyConverter}}" />
    </DataTemplate>
</Window.Resources>

<ComboBox
    ItemSource="... some list of Thing instances ..."
    ItemTemplate="{StaticResource thingTemplate}" /> 
```

因此，您只需定义 CurrencyConverter 类，使其实现 IValueConverter 并调用您的代码将给定金额转换为格式化字符串。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2008-11-17T03:37:47.433

在 Binding 表达式中使用**StringFormat ，例如**

```
<TextBox Text="{Binding Path=Value, StringFormat=Amount: {0:C}}"/> 
```

有关更多详细信息，请参阅此[博客。](http://blogs.msdn.com/llobo/archive/2008/05/19/wpf-3-5-sp1-feature-stringformat.aspx)

ValueConverter是另一种方式 - StringFormat 在[.NET3.0](http://msdn.microsoft.com/en-us/library/system.windows.data.ivalueconverter.aspx)上不起作用，它需要 WPF3.5 SP1。

# windows - 现在的程序员应该具备哪些技能？

> ID：294825
> 
> 赞同：10
> 
> 时间：2008-11-17T03:33:48.440
> 
> 标签：windows

我一直在使用 PHP、Javascript 进行编程，并且在一家公司担任了几年的设计师。我正在考虑离开我想知道现在我需要具备哪些技能才能取得成功。

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2008-11-17T03:54:12.797

你似乎对学习充满好奇和兴趣。那是资格＃1；这个领域的事情变化很快，只有终身学习者才能生存。

下一步是搜索您所在地区的工作委员会（[Monster](http://www.monster.com/)、[Craigslist](http://www.craigslist.org/about/sites)、[Joel On Software Jobs Board](http://jobs.joelonsoftware.com/)等），并跟踪您看到的大量技能。这可能是“热”的相当好的代表，至少在你附近。

然后，您可以在此处通过标签（例如[PHP](https://stackoverflow.com/questions/tagged/php)和[javascript](https://stackoverflow.com/questions/tagged/javascript)）检查堆栈溢出，看看人们提出的问题对您来说是否具有基本意义（不是您需要知道每个答案，但如果它听起来像希腊语，您可能还没有准备好在该主题中找到工作）。

为了更直接地回答您的问题：有一些针对 PHP 和 javascript 的网络作业，尽管如果您朝那个方向发展，大量的 CSS 和 Ajax 可能不会受到伤害。如果您想要一般的“网站管理员”类型的工作，设计背景会有所帮助，但请注意，这些工作通常不是面向编程的工作，因为您可以在普通网站上做的大多数事情通常最好使用现成的 CMS（您通常不需要重新发明轮子，除非您正在做的网站在某些方面功能强大）。正如其他海报所说，如果您想要更企业化的东西，C# / .NET 可能会很好。

真正的问题是：你喜欢做什么工作？什么让你快乐？找到它并做好它，你就会得到一份工作。:)

* * *

## 回答 #2

> 赞同：6
> 
> 时间：2008-11-17T03:49:04.587

这真的取决于你打算做什么。

我相信以下技能对于所有类型的“程序员”都很重要，无论他们选择哪种语言。

1.  准确估计。给你的老板准确的估计会让他们的工作更轻松，这让你的生活更轻松。
2.  沟通。必须能够与您一起工作的每个人进行有效的沟通。
3.  知道何时寻求帮助。就像你写的那样，你不可能知道一切。我宁愿让开发人员向同事寻求帮助，也不愿花几天时间想出一个解决方案。
4.  设计模式。每个开发人员都需要了解基本的设计模式。
5.  了解一门好的脚本语言。Perl、Python、Ruby、Bash、Powershell……任你挑选。

* * *

## 回答 #3

> 赞同：5
> 
> 时间：2008-11-18T05:09:54.673

我认为开发人员可以拥有的最佳资产之一就是知道如何使用 Google。留在我这里。

我曾与那些不知道如何搜索预先存在的解决方案的人一起工作。当面对任何软件项目时，我发现只要知道在 Google 中输入什么内容就可以解决一半的问题。我知道存在许多不同的技术，它们打算如何使用，以及我在其他人的博客上读到的关于它们的一般讨论，但我从未真正使用过它们，也许永远不会使用它们。但是当一个符合他们描述的问题出现在我面前时，我知道在谷歌中输入什么神奇的词，以及接下来要为那个特定的项目学习什么。

问题的另一半是决定从这些谷歌结果中拿走什么。[CodeProject](http://www.codeproject.com)是一个非常值得探索的网站，有时您会看到一篇文章直接解决了您的问题。有时，您可以直接在您的项目中使用提供的代码（我使用的是我得到的 Windows 窗体 LED 数字控件），但大多数情况下，您只会带走本文的想法并将其用作应用于您的项目的指南。有时您会查看一篇文章并确定该人不知道他们在说什么。*能够评估现有博客文章、库和片段的质量、使用、改编或仅仅从现有博客文章、库和片段中获得灵感是一项宝贵的资产。*你不必全部理解——你不可能什么都知道，你必须在某处画出“魔法线”——但重要的是你能够分辨出哪些看起来写得很好，哪些看起来很漂亮-dash 且容易出错。

所以，为此，我最好的建议是在你的 RSS 阅读器中加载来自从事你感兴趣的技术的人的提要。你不必阅读每一个单独的帖子，但你会感到惊讶只需放大它们并每天浏览头条新闻，您就可以了解多少。

对我来说，编程语言之类的东西并不那么重要。我从 C++ 开始，涉足 Java，在 PHP 领域工作了两年，另外两年一直在生活和呼吸 C#。您可以在一周内学习一门编程语言。但是，学习该语言常用的框架和习语可能需要数年时间，因此对于任何这样的框架，您可以确定在某处会涉及到一些工作。跳来跳去一段时间后，您会找到自己喜欢的一个（我的是 .NET 世界），但您仍然会知道如何绕过其他人。所以选择你的毒药，但请继续阅读以了解那里有什么。一个良好的*索引*程序员可以很容易地成为一个*全面的*一个是因为他会知道如何解决出现在他舒适区之外的新问题。

希望其中一些有意义。

* * *

## 回答 #4

> 赞同：4
> 
> 时间：2008-11-17T03:39:24.840

您的作品集，大量图片，非常简短的描述。PHP 在企业界并不流行，但它确实存在。您可能想考虑学习 JSP 或 C# ASP.NET 以保持您的选择余地。

不同的公司有不同的需求，网页设计商店将重点关注设计以及制作网站的速度（通常使用框架）。企业应用程序将关注诸如错误修复、测试、支持多种语言、使用 3rd 方控件之类的事情。

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2008-11-17T03:38:17.387

您所需要的只是完成学习和轻松学习新事物的能力。他们不能指望你知道他们告诉你做什么。但如果你能好好学习，那就没问题了。

这是我在大学里被告知的。我认为它是正确的。

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2008-11-17T03:51:27.920

学习测试驱动开发和单元测试，并对一些 javascript 库有扎实的了解。

* * *

## 回答 #7

> 赞同：0
> 
> 时间：2008-11-17T03:58:07.157

如果您已经了解 PHP 和 Javascript，请确保您的 CSS 和 MySQL 技能是最新的。这四个做一个很好的包裹。

* * *

## 回答 #8

> 赞同：0
> 
> 时间：2008-11-17T04:14:13.833

在 Web 开发中，至少（我主要工作的地方）经常存在前端和后端技能之间的差异。

我在这里说的是编码，所以“前端”是指css和javascript之类的东西。设计和编码之间经常有一条模糊的界限，所以在前端工作的人通常有一点编码技能，一点设计技能。

后端往往是更多的 java 或 .net（最常见于网络，至少在我看到的招聘广告中），带有一点 python、ruby、php 和其他。后者的技能可能会更频繁地将您带到一个较小的地方。根据我的观察，后端技能的报酬可能会更高一些。你最好找个地方做一些前面和后面的工作，然后过渡到做更多的编程类型的工作。

当然，“成功”是很私人的事情，所以请忽略上面写的一切，祝你好运。

对于一些实际的硬数据，这是一个根据职位发布中的受欢迎程度对语言进行排名的网站（还有其他网站） [http://www.langpop.com/](http://www.langpop.com/)

* * *

## 回答 #9

> 赞同：0
> 
> 时间：2013-03-27T14:41:31.643

基本上，您需要了解编程不是懒人的职业，即使它*过于*久坐。它需要*思考*，需要*实践*，需要*耐心*。如果您认为您可以学习一堆食谱方法并突然成为一名程序员，那么您就大错特错了。

（尽管不幸的是，许多经理相信有*食谱*解决方案，并根据你能背诵的流行语来招聘。但你问的是程序员*应该*具备什么技能，而不是他需要知道什么才能被聘用。）

# vb.net - 单元测试和 VB.NET

> ID：294826
> 
> 赞同：4
> 
> 时间：2008-11-17T03:36:05.470
> 
> 标签：vb.net, unit-testing

在哪里可以找到使用 VB.NET 进行单元测试应用程序的文献或视频演示？作为一名新手/业余程序员，我想为使用单元测试方法开发应用程序打下坚实的基础。

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2008-11-17T03:51:48.077

如果它有帮助，如果您打算留在 .NET 世界并打算专业使用 .NET，您可能想学习 C#。我已经[在这里](https://stackoverflow.com/questions/260325/which-net-programming-language-should-i-learn-as-a-web-developer#260389)回答了为什么。现在，关于你的问题：O'Reilly and Associates最近有[一篇关于这个主题](http://www.ondotnet.com/pub/a/dotnet/2005/07/18/unittesting_2005.html)的文章（如果到 2005 年你的意思是最近的，但为了我们的目的，我们可以称之为最近）。您可能还想学习[Nunit](http://www.nunit.org/index.php)，它是 .NET 的单元测试框架。

至于书籍：

*   [开源 .NET 开发](http://safari.oreilly.com/0321228103)- 涵盖 Nunit。
*   [eXtreme .NET：向 .NET 开发人员介绍 eXtreme 编程技术](http://safari.oreilly.com/0321303636)
*   [Microsoft.NET 中的测试驱动开发](http://safari.oreilly.com/0735619484)

那应该让你开始。我不知道代码示例是用 VB 还是 C# 编写的，但如果您有[Safari 在线](http://safari.oreilly.com/)订阅（我强烈推荐），您将能够浏览这些书籍而无需花钱购买。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-07-15T16:29:54.483

您可以在 Typemock 的网站上找到有关[单元测试 vb的一些信息](http://www.typemock.com/vbpage.php)

# project-planning - 80/20 时间管理规则是否适用于开发人员？

> ID：294841
> 
> 赞同：5
> 
> 时间：2008-11-17T03:44:12.007
> 
> 标签：project-planning, time-management

[Jeff 最近的文章](http://www.codinghorror.com/blog/archives/001187.html)链接到[First Fit Decreeasing](http://en.wikipedia.org/wiki/Bin_packing_problem#Analysis_of_heuristic_algorithms)算法的[时间管理示例](http://www.ams.org/featurecolumn/archive/bins1.html)，其中谈到了时间管理的[帕累托原则](http://en.wikipedia.org/wiki/Pareto_principle)（或 80/20 规则），即我们在 20% 的工作中产生 80% 的工作我们的时间。

现在我们都听过程序员的[名言](https://stackoverflow.com/questions/58640/great-programming-quotes#58854)：

> 前 90% 的代码占了前 90% 的开发时间。剩下的 10% 的代码占了另外 90% 的开发时间。

但抛开所有的玩笑不谈，通常你的代码中有 20% 是做你想做的事，另外 80% 是处理异常……那么 80/20 规则真的适用于开发人员吗？

有没有人有任何例子说明为什么它适用/不适用于我们？

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2008-11-17T04:10:57.617

我认为霍夫施塔特定律适用。

> 即使考虑到霍夫施塔特定律，它也总是比您预期的要长。
> 
> ——道格拉斯·霍夫施塔特

更严肃地说，看看[关键链项目管理](http://en.wikipedia.org/wiki/Critical_chain)。它建议您为项目中的每个步骤提供两个估计值。一种是乐观估计，如果一切顺利，你有 50% 的把握可以见面。另一个是更现实的估计，它考虑了损失的时间和错误（我的释义，不要责怪作者）。随着时间的推移和几个项目，您将了解哪个估计更准确，以及多少。它因开发人员而异，因此您需要跟踪。

* * *

## 回答 #2

> 赞同：6
> 
> 时间：2008-11-17T03:48:55.337

绝对地！我 80% 的时间花在 stackoverflow.com 上，20% 的时间在实际工作。

奇怪的是，我的生产力和以前一样……

……和以前一样！

;-)

* * *

## 回答 #3

> 赞同：3
> 
> 时间：2008-11-17T03:53:55.420

提前 2 小时编写单元测试并向您的客户演示功能将为您节省 8 小时的调试和重写时间。

* * *

## 回答 #4

> 赞同：3
> 
> 时间：2008-11-17T06:53:53.950

在我看来，Kozyarchuk 是对的：

问题不在于糟糕的时间估计，而是糟糕/不可能的范围估计。

尽早向客户/经理显示结果或结果模型，同时测试代码的有效性，从而更好地理解目标/要求。

请记住：**如果项目在完成时“让客户满意”，而不是在项目最初开始时满足分析师已知的需求，那么项目就是成功的。**

这自然意味着“**移动目标**”是规则，不是坏事，也没什么好怕的。这也意味着我，作为项目负责人/架构师，必须**确保范围变更的成本能够/将被传达和涵盖**。

这是怎么做到的？

*   尽早演示，经常演示（对同一房间的用户和他们的经理）
*   改变请求的心态。（因此客户知道更改是什么以及这些更改的成本是多少，因此客户可以使用它们来重新调整他的项目范围）
*   老实说，与客户和开发人员交谈......并确保他们也相互交谈。

这总是有效吗？**不**

* * *

## 回答 #5

> 赞同：2
> 
> 时间：2008-11-17T03:50:56.113

你为什么还要问80/20规则？您正确引用了 90/90 规则。您已经知道 90/90 规则适用于开发人员。

（很抱歉用事实而不是玩笑来回应。）

* * *

## 回答 #6

> 赞同：2
> 
> 时间：2008-11-17T04:33:54.107

我花 20% 的时间做我想做的事，80% 的时间在重构它。

所以，是的，如果你认为它在前 20% 中“有效”。但是，最后的 80% 使它可重复使用，值得维护，并且在未来使用是一种乐趣（而不是负担）。

* * *

## 回答 #7

> 赞同：1
> 
> 时间：2008-11-17T04:23:48.480

Pereto 原则适用于开发人员。有人说 80% 的工作是由 20% 的开发人员完成的。此外，80% 的错误是由 20% 的开发人员生成的。此外，80% 的功能被 20% 的用户使用。这些是我听说过的例子。

* * *

## 回答 #8

> 赞同：0
> 
> 时间：2008-11-17T06:15:16.053

我和蜥蜴比尔在一起。由于非常意外的事情或可能没有考虑到的事情，它总是比预期的要长。

* * *

## 回答 #9

> 赞同：0
> 
> 时间：2008-11-17T07:42:44.083

是的，80/20 法则适用于发展，但你必须以不同的方式解释它：

*   前 80% 的代码在 20% 的时间内完成。
*   剩下的 80% 的时间不足以完成剩下的 20% 的代码。

# .net - 如何通过 ADO.Net 数据服务使用在部分（实体框架）类中定义的只读属性

> ID：294849
> 
> 赞同：1
> 
> 时间：2008-11-17T03:52:11.257
> 
> 标签：.net, entity-framework, partial-classes, wcf-data-services

我有由实体框架定义的对象，然后我通过部分类向其中添加了其他方法和属性。我想我理解这样做的大部分限制，但想确认我所看到的东西（或者希望了解我需要做什么才能完成这项工作）。

我有一个部分类，它有一个只读属性，它使用几个项目来创建一个只读的计算字段。很高兴看到只读属性没有像我希望/期望的那样通过 ADO.Net 数据服务返回。即，我希望看到实体框架上的属性，并且通过部分类在代码中定义的属性来自数据服务调用。

是这样吗？当 ADO.Net 数据服务查询数据时，部分类是否完全被忽略？如果是这样，将只读类型属性添加到实体上的最佳做法是什么（因为我想避免将具有不同名称空间的相同部分类剪切并粘贴到客户端和服务器端代码库中）。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2008-11-18T02:21:43.577

来自 Microsoft 论坛帖子：（[请参阅此处的完整帖子](http://forums.microsoft.com/MSDN/ShowPost.aspx?PostID=4133701&SiteID=1&mode=1)）

> “我想你在问“如何向 EF 提供程序公开的现有实体添加只读属性”？在 V1 中，没有好的方法可以做到这一点。对于 EF，我们使用 EF 加载元数据元数据 api，因此我们不做任何反射。因此，您可能通过部分类添加的其他属性将被忽略。
> 
> Astoria 还没有只读属性的概念。因此，如果我们公开任何其他不属于模型的属性，我们不知道如何在更新中处理它们。我们也不想在服务器中默默地丢失数据。”

所以看起来这是无法通过 ADO.Net 数据服务公开的功能。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2008-11-17T05:11:05.310

这里有两个独立的关注点 - 基本模型 (EF) 和 WCF/mex 层。您的附加属性不会成为 edmx 模型的一部分，但我想知道这个问题是否与 WCF/mex 方面没有更多关系。

但是，即使它有效，ADO.NET 数据服务传输的是*数据*，而不是*逻辑*。所以依赖计算的属性不是一个安全的选择：客户端不会有公式——只有原始值。

要找出它是什么，请尝试使属性读/写（即使写入没有做任何有用的事情），并确保该值具有 [DataMember] 属性等。

* * *

## 回答 #3

> 赞同：-1
> 
> 时间：2008-11-17T06:53:57.740

我认为问题在于使用 XML 序列化，它只使用 get 和 set 方法序列化属性。否则无法反序列化。将一个空的 set 方法添加到您的属性中，看看您是如何进行的。

抢

# c++ - 在 C/C++ 中实现解释器所需的参考资料

> ID：294852
> 
> 赞同：36
> 
> 时间：2008-11-17T03:56:25.163
> 
> 标签：c++, lisp, interpreter

我发现自己加入了一个将解释器整合到现有应用程序中的项目。要解释的语言是 Lisp 的衍生语言，具有特定于应用程序的内置函数。单个“程序”将在应用程序中以批处理方式运行。

令我惊讶的是，这些年来我编写了几个编译器和几个数据语言翻译器/解析器，但我以前从未真正编写过解释器。原型很长，在 C++ 中实现为语法树遍历器。我可能会影响原型之外的架构，但不能影响实现语言（C++）。所以，约束：

*   实现将在 C++ 中
*   解析可能会使用 yacc/bison 语法处理（现在是）
*   像 NekoVM 和 LLVM 这样的完整 VM/Interpreter 生态系统的建议对于这个项目可能并不实用。独立的更好，即使这听起来像 NIH。

我真正想要的是阅读有关实现解释器的基础知识的材料。我浏览了 SO 和另一个名为[Lambda the Ultimate 的](http://www.lambda-the-ultimate.org)网站，尽管它们更倾向于编程语言理论。

到目前为止我收集的一些花絮：

*   [Lisp in Small Pieces](https://rads.stackoverflow.com/amzn/click/com/0521545668)，克里斯蒂安·奎内克（Christian Queinnec）。推荐它的人说它“从琐碎的解释器转向更高级的技术，并完成了字节码和‘Scheme to C’编译器的呈现。”

*   [内科虚拟机](http://nekovm.org/)。正如我上面提到的，我怀疑我们是否被允许合并一个完整的 VM 框架来支持这个项目。

*   [计算机程序的结构和解释](http://mitpress.mit.edu/sicp/full-text/book/book.html)。最初我建议这可能是矫枉过正，但经过一个健康的块，我同意@JBF。信息量大，思路开阔。

*   [保罗格雷厄姆在 Lisp](http://paulgraham.com/rootsoflisp.html)上。我读过这篇文章，虽然它是对 Lisp 原则的信息性介绍，但不足以快速开始构建解释器。

*   [鹦鹉实施](http://www.sidhe.org/~dan/presentations/Parrot_Implementation.pdf)。这似乎是一个有趣的阅读。不确定它是否会为我提供基础知识。

*   [从零开始的计划](http://peter.michaux.ca/articles/scheme-from-scratch-introduction)。Peter Michaux 正在攻击 Scheme 的各种实现，从用 C 编写的快速而肮脏的 Scheme 解释器（在以后的项目中用作引导程序）到编译的 Scheme 代码。到目前为止非常有趣。

*   [Language Implementation Patterns: Create Your Own Domain-Specific and General Programming Languages ，在](http://pragprog.com/book/tpdsl/language-implementation-patterns)[Books On Creating Interpreted Languages](https://stackoverflow.com/questions/2853412/books-on-creating-interpreted-languages)的评论线程中推荐。这本书包含两章专门介绍构建解释器的实践，所以我将它添加到我的阅读队列中。

*   *New* (and yet *Old* , ie 1979): [Writing Interactive Compilers and Interpreters](http://books.google.com/books?id=d6cpAQAAIAAJ&q=writing+interactive+compilers+and+interpreters&dq=writing+interactive+compilers+and+interpreters&hl=en&ei=FzorTsDzFIj0swOb_4XMCg&sa=X&oi=book_result&ct=result&resnum=1&ved=0CCkQ6AEwAA) by PJ Brown。这本书早已绝版，但有趣的是提供了与基本解释器的实现相关的各种任务的大纲。我看到这个的评论褒贬不一，但因为它很便宜（我订购它时使用了大约 3.50 美元），我会试一试。

那么怎么样呢？有没有一本好书可以帮助新手并展示如何在 C/C++ 中为类似 Lisp 的语言构建解释器？你喜欢语法树遍历器还是字节码解释器？

回答@JBF：

*   当前的原型是一个解释器，这对我来说很有意义，因为我们接受了任意代码文件的路径并在我们的应用程序环境中执行它。内置函数用于影响我们的内存数据表示。

*   它不应该慢得可怕。当前的树行者似乎可以接受。

*   该语言*基于*Lisp，但不是 Lisp，因此不需要符合标准。

*   如上所述，我们不太可能被允许添加一个完整的外部 VM/解释器项目来解决这个问题。

对于其他海报，我也会查看您的引文。谢谢大家！

* * *

## 回答 #1

> 赞同：12
> 
> 时间：2008-11-17T12:53:50.557

简短的回答：

lisp 解释器的基本阅读清单是 SICP。我一点也不认为它是矫枉过正，如果你觉得你对本书的第一部分的资格过高，请跳到第 4 章并开始解释（尽管我觉得这将是一个损失，因为第 1-3 章真的那么好！） .

添加 LISP in Small Pieces（LISP 从现在开始），第 1-3 章。特别是第 3 章，如果您需要实现任何重要的控制表单。

请参阅 Jens Axel Søgaard 关于最小自托管方案的这篇文章：[http](http://www.scheme.dk/blog/2006/12/self-evaluating-evaluator.html) ://www.scheme.dk/blog/2006/12/self-evaluating-evaluator.html 。

稍微长一点的答案：

在不知道您的口译员需要什么的情况下，很难给出建议。

*   它真的需要成为解释器，还是你真的需要能够执行 lisp 代码？
*   它需要快速吗？
*   它需要符合标准吗？普通的 Lisp？R5RS？R6RS？您需要任何 SFRI 吗？

如果您需要比简单的语法树遍历器更花哨的东西，我强烈建议您嵌入一个快速方案子系统。我想到了 Gambit 方案：http: [//dynamo.iro.umontreal.ca/~gambit/wiki/index.php/Main_Page](http://dynamo.iro.umontreal.ca/%7Egambit/wiki/index.php/Main_Page)。

如果这不是 SICP 中的第 5 章和 LISP 目标编译中的第 5 章以加快执行速度的选项。

为了更快地解释，我会看看最新的 JavaScript 解释器/编译器。似乎有很多关于快速执行 JavaScript 的想法，您可能可以从中学习。V8 引用了两篇重要的论文：[http](http://code.google.com/apis/v8/design.html) ://code.google.com/apis/v8/design.html和 squirrelfish 引用了一对：[http](http://webkit.org/blog/189/announcing-squirrelfish/) ://webkit.org/blog/189/announcing-squirrelfish/ 。

还有用于 RABBIT 编译器的规范方案文件： [http ://library.readscheme.org/page1.html。](http://library.readscheme.org/page1.html)

如果我进行一些过早的推测，内存管理可能是难以破解的难题。Nils M Holm 出版了一本书“来自空白空间的方案 9” [http://www.t3x.org/s9fes/](http://www.t3x.org/s9fes/)，其中包括一个简单的 stop-the-world 标记和清扫垃圾收集器。包括来源。

John Rose（较新的 JVM 成名）写了一篇关于将 Scheme 集成到 C 的论文： http: [//library.readscheme.org/servlets/cite.ss](http://library.readscheme.org/servlets/cite.ss?pattern=AcmDL-Ros-92) ?pattern=AcmDL-Ros-92 。

* * *

## 回答 #2

> 赞同：7
> 
> 时间：2008-11-17T16:57:40.627

是的，在 SICP 上。

我已经多次完成这项任务，如果我是你，我会这样做：

首先设计你的记忆模型。您将需要某种 GC 系统。先做这件事比以后再装上它要容易得多。

设计你的数据结构。在我的实现中，我有一个基本的 cons 框，其中包含许多基本类型：原子、字符串、数字、列表、布尔值、原始函数。

设计您的 VM 并确保保持 API 干净。我的最后一个实现将其作为顶级 API（请原谅格式 - 所以正在偷看我的预览）

```
ConsBoxFactory &GetConsBoxFactory() { return mConsFactory; }
AtomFactory &GetAtomFactory() { return mAtomFactory; }
Environment &GetEnvironment() { return mEnvironment; }
t_ConsBox *Read(iostream &stm);
t_ConsBox *Eval(t_ConsBox *box);
void Print(basic_ostream<char> &stm, t_ConsBox *box);
void RunProgram(char *program);
void RunProgram(iostream &stm); 
```

不需要 RunProgram - 它是根据 Read、Eval 和 Print 实现的。REPL 是解释器的常见模式，尤其是 LISP。

ConsBoxFactory 可用于制作新的 cons 框并对其进行操作。使用 AtomFactory 以便等效的符号原子映射到一个对象。Environment 用于维护符号与 cons 框的绑定。

你的大部分工作应该进入这三个步骤。然后你会发现你的客户端代码和支持代码也开始看起来很像 LISP：

```
t_ConsBox *ConsBoxFactory::Cadr(t_ConsBox *list)
{
    return Car(Cdr(list));
} 
```

您可以在 yacc/lex 中编写解析器，但何苦呢？Lisp 是一个非常简单的语法和扫描器/递归下降解析器对，因为它大约需要两个小时的工作。最糟糕的部分是编写谓词来识别标记（即 IsString、IsNumber、IsQuotedExpr 等），然后编写例程将标记转换为 cons 框。

使编写和编写 C 代码的胶水变得容易，并在出现问题时轻松调试问题。

* * *

## 回答 #3

> 赞同：5
> 
> 时间：2008-11-17T07:02:44.727

Samuel Kamin 的书*Programming Languages, An Interpreter-Based Approach中*[的 Kamin Interpreters](http://www.cs.cmu.edu/afs/cs/project/ai-repository/ai/lang/lisp/impl/kamin/0.html)，由 Timothy Budd 翻译成 C++。我不确定裸源代码会有多大用处，因为它本来是随书而来的，但这是一本很好的书，涵盖了用低级语言实现 Lisp 的基础知识，包括垃圾收集等。（这不是本书的重点，它是一般的编程语言，但它被涵盖了。）

*Lisp in Small Pieces*更深入，但这对您的情况有利也有弊。有很多关于编译的材料，这些材料与你无关，而且它更简单的解释器在 Scheme，而不是 C++ 中。

SICP 很好，当然。不是矫枉过正，但写口译员当然只是本书的一小部分。

JScheme 建议也是一个很好的建议（它包含我的一些代码），但不会帮助您处理 GC 之类的问题。

稍后我可能会通过更多建议来充实这一点。

**编辑：**有些人说他们从我的[awklisp](http://github.com/darius/awklisp/tree/master/awklisp)中学到了东西。这无疑是一种奇怪的建议，但它非常小，可读，实际可用，并且与其他微小但可读的玩具 Lisps 不同，它实现了自己的垃圾收集器和数据表示，而不是依赖于底层的高级实现语言来提供他们。

* * *

## 回答 #4

> 赞同：3
> 
> 时间：2008-11-17T04:10:20.473

查看[Peter Norvig](http://norvig.com/jscheme.html)的 JScheme 。我发现这非常容易理解并移植到 C++。呃，虽然不知道将方案用作脚本语言 - 将它教给 jnrs 很麻烦并且感觉过时（helloooo 1980 年代）。

* * *

## 回答 #5

> 赞同：2
> 
> 时间：2008-11-26T14:15:51.620

我想扩展我对[Programming Languages: Application and Interpretation](http://www.cs.brown.edu/~sk/Publications/Books/ProgLangs/)的推荐。如果你想写一个解释器，那本书会带你走很短的路。如果你通读编写你阅读的代码并进行练习，你最终会得到一堆相似但不同的解释器（一个是渴望的，另一个是懒惰的，一个是动态的，另一个有一些类型，一个有动态范围， other 具有词法范围等）。

# ms-office - 每个文档的功能区实例

> ID：294859
> 
> 赞同：4
> 
> 时间：2008-11-17T04:01:59.723
> 
> 标签：ms-office, vsto, ribbon

我正在使用 VSTO 3.0，功能区设计器为我提供了一个明显跨文档共享的功能区。

因此，如果我有需要显示在功能区（或切换按钮）中的文档特定状态（标记为 XML 标记的数量），那么所有文档似乎都共享功能区实例

如何修复此 TIA

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2009-09-16T16:05:46.990

您可以使用 Application.DocumentChange 事件或 Application.WindowActivate 事件。

第一个被触发，然后您更改当前活动文档，但在参数中没有关于该文档的信息，因此很难使用，因为您必须弄清楚这一点。

后者类似，每次更改窗口时都会触发它，但在这种情况下，它将当前活动文档作为参数传递，因此如果您需要检查任何文档属性的值，更改功能区会更容易。这对我有用。

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2008-11-17T05:05:07.350

挂钩到文档模型中的适当事件（例如活动文档更改时），在该事件中使适当的功能区按钮无效（您需要加载的原始功能区 xml 中的元素的 id）。

然后，当该按钮的刷新状态回调发生时，您可以根据需要更新标题/图像/启用。

# php - 如何在 PHP 中将数字格式化为美元金额

> ID：294865
> 
> 赞同：71
> 
> 时间：2008-11-17T04:09:41.800
> 
> 标签：php, formatting, currency

如何将数字转换为显示美元和美分的字符串？

```
eg:
123.45    => '$123.45'
123.456   => '$123.46'
123       => '$123.00'
.13       => '$0.13'
.1        => '$0.10'
0         => '$0.00' 
```

* * *

## 回答 #1

> 赞同：86
> 
> 时间：2008-11-17T04:18:44.417

如果你只是想要一些简单的东西：

```
'$' . number_format($money, 2); 
```

[number_format()](http://php.net/number_format)

* * *

## 回答 #2

> 赞同：84
> 
> 时间：2008-11-17T04:13:28.860

PHP 也有[money_format()](http://php.net/money_format)。

这是一个例子：

```
echo money_format('$%i', 3.4); // echos '$3.40' 
```

这个函数实际上有很多选项，请转到我链接到的文档来查看它们。

注意：money_format 在 Windows 中未定义。

* * *

更新：通过 PHP 手册：[https ://www.php.net/manual/en/function.money-format.php](https://www.php.net/manual/en/function.money-format.php)

*警告：此函数 [ **money_format** ] 自 PHP 7.4.0 起已弃用。强烈建议不要依赖此功能。*

相反，请查看[NumberFormatter::formatCurrency](https://www.php.net/manual/en/numberformatter.formatcurrency.php)。

```
 $number = "123.45";
    $formatter = new NumberFormatter('en_US', NumberFormatter::CURRENCY);
    return $formatter->formatCurrency($number, 'USD'); 
```

* * *

## 回答 #3

> 赞同：16
> 
> 时间：2014-02-03T13:07:41.727

我试过 `money_format()`了，但它根本不适合我。然后我尝试了以下一个。它对我来说很完美。希望它也能以正确的方式为你工作.. :)

你应该使用这个

```
number_format($money, 2,'.', ',') 
```

它将以货币格式显示货币数字，最多小数点后 2 位。

* * *

## 回答 #4

> 赞同：8
> 
> 时间：2008-11-17T04:10:27.180

在 PHP 和 C++ 中，您可以使用 printf() 函数

```
printf("$%01.2f", $money); 
```

* * *

## 回答 #5

> 赞同：4
> 
> 时间：2020-02-22T01:12:37.023

请注意，在 PHP 7.4 中，money_format() 函数已[弃用](https://www.php.net/manual/en/migration74.deprecated.php)。它可以被 intl NumberFormatter 功能替换，只需确保启用 php-intl 扩展。这是一个很小的努力，而且值得，因为您可以获得很多可定制性。

```
$f = new NumberFormatter("en", NumberFormatter::CURRENCY);
$f->formatCurrency(12345, "USD"); // Outputs "$12,345.00" 
```

[Darryl Hein](https://stackoverflow.com/users/5441/darryl-hein)提到了仍然适用于 7.4 的快速方法：

```
'$' . number_format($money, 2); 
```

* * *

## 回答 #6

> 赞同：2
> 
> 时间：2018-11-06T20:36:15.140

在 php.ini 添加这个（如果它丢失）：

```
#windows
extension=php_intl.dll

#linux
extension=php_intl.so 
```

然后这样做：

```
$amount = 123.456;

// for Canadian Dollars
$currency = 'CAD';

// for Canadian English
$locale = 'en_CA';

$fmt = new \NumberFormatter( $locale, \NumberFormatter::CURRENCY );
echo $fmt->formatCurrency($amount, $currency); 
```

* * *

## 回答 #7

> 赞同：0
> 
> 时间：2019-10-10T05:00:14.653

```
/*     Just Do the following, */

echo money_format("%(#10n","123.45"); //Output $ 123.45

/*    If Negative Number -123.45 */

echo money_format("%(#10n","-123.45"); //Output ($ 123.45) 
```

# php - Zend 框架中的模型

> ID：294875
> 
> 赞同：33
> 
> 时间：2008-11-17T04:16:35.000
> 
> 标签：php, model-view-controller, zend-framework, model

您在 Zend 框架中实现模型的方式有哪些？

我已经看到了基本的`class User extends Zend_Db_Table_Abstract`，然后在你的控制器中调用它：

`$foo = new User;`

`$foo->fetchAll()`

但是更复杂的用途呢？文档的快速入门部分提供了这样一个示例，但我仍然觉得我没有得到 Zend Framework 中模型的“最佳使用”示例。有什么有趣的实现吗？

* * *

**编辑：**我应该澄清（回应CMS的评论）......我知道做更复杂的选择。我对模型概念的整体方法和其他人如何实现它们的具体示例感兴趣（基本上，手册遗漏的内容以及基本操作方法的内容）

* * *

## 回答 #1

> 赞同：61
> 
> 时间：2008-11-17T07:23:03.157

我为 Zend 工作，并在 Zend_Db_Table 组件上做了很多工作。

Zend Framework 没有就域模型模式的“模型”概念提供很多指导。Model 没有基类，因为 Model 封装了特定于您的应用程序的业务逻辑的某些部分。我更详细地写了[一篇关于这个主题的博客。](http://karwin.blogspot.com/2008/05/activerecord-does-not-suck.html)

对数据库的持久性应该是模型的内部实现细节。该模型通常*使用*一个或多个表。将模型视为表的扩展是一种常见但不恰当的面向对象设计。换句话说，我们应该说 Model HAS-A Table——而不是 Model IS-A Table。

这是一个 IS-A 的例子：

```
class MyModel extends Zend_Db_Table_Abstract
{
} 
```

这是一个 HAS-A 的例子：

```
class MyModel // extends nothing
{
    protected $some_table;
} 
```

在真实的领域模型中，您将在 MyModel 的方法中*使用$some_table。*

您还可以阅读 Martin Fowler 对[域模型](http://martinfowler.com/eaaCatalog/domainModel.html)设计模式的看法，以及他对[贫血域模型](http://www.martinfowler.com/bliki/AnemicDomainModel.html)反模式的描述，即不幸的是有多少开发人员使用了 OO 编程。

* * *

## 回答 #2

> 赞同：23
> 
> 时间：2008-11-17T05:22:02.620

我个人将 和 子类`Zend_Db_Table_Abstract`化`Zend_Db_Table_Row_Abstract`。我的代码和你的代码之间的主要区别在于，明确地将子类`Zend_Db_Table_Abstract`视为“表”和`Zend_Db_Table_Row_Abstract`“行”。我很少看到直接调用选择对象、SQL 或控制器中内置的 ZF 数据库方法。我尝试隐藏请求特定记录以调用后面的逻辑，`Zend_Db_Table_Abstract`如下所示：

```
class Users extends Zend_Db_Table_Abstract {

    protected $_name = 'users';

    protected $_rowClass = 'User'; // <== THIS IS REALLY HELPFUL

    public function getById($id) {
        // RETURNS ONE INSTANCE OF 'User'
    }

    public function getActiveUsers() {
        // RETURNS MULTIPLE 'User' OBJECTS            
    }

}

class User extends Zend_Db_Table_Row_Abstract {

    public function setPassword() {
        // SET THE PASSWORD FOR A SINGLE ROW
    }

}

/* CONTROLLER */
public function setPasswordAction() {

    /* GET YOUR PARAMS */

    $users = new Users();

    $user = $users->getById($id);

    $user->setPassword($password);

    $user->save();
} 
```

有很多方法可以解决这个问题。不要认为这是唯一的，但我尝试遵循 ZF 的设计意图。（这里有更多[关于这个主题的想法和链接](https://stackoverflow.com/questions/57773/zend-php-framework#58837)。）这种方法确实有点重，但我觉得它让控制器专注于处理输入和与视图协调；让模型去做特定于应用程序的工作。

* * *

## 回答 #3

> 赞同：7
> 
> 时间：2008-11-17T08:43:22.887

永远不要使用 Zend_Db_Table 作为模型。它只会让你陷入困境。您可以编写自己的模型类来使用 Zend_Db_Table 与您的数据库对话，或者您可以阅读我的博客文章[以](http://www.zacharysnow.com/2008/06/20/zend_db_table-as-a-model/)了解允许您在某种程度上结合“模型”类和 Zend_Db_Table 的技巧。

最重要的是，当您直接在控制器中使用 Zend_Db_Table 时，您最终会在多个地方执行相同的操作。如果您必须对某些逻辑进行更改，则必须在多个地方进行更改。不好。我的第一个专业项目是这样完成的，因为我是公司里必须学习如何使用 ZF 的人，现在完全一团糟。

我还倾向于将辅助函数写入我的类中以进行复杂的提取。类似于 $table->doNameFetchAll() 或 $table->doOrderFetchAll() 之类的东西。

* * *

## 回答 #4

> 赞同：7
> 
> 时间：2009-01-26T21:40:16.440

我一直在对 ZF 模型进行一些研究，并偶然发现了 Matthew Weier O'Phinney 撰写的一系列有趣的文章，这些文章非常值得一看：

*   [在模型中使用 Zend_Form](http://weierophinney.net/matthew/archives/200-Using-Zend_Form-in-Your-Models.html)
*   [将 ACL 应用于模型](http://weierophinney.net/matthew/archives/201-Applying-ACLs-to-Models.html)
*   [模型基础设施](http://weierophinney.net/matthew/archives/202-Model-Infrastructure.html)

它不是“生产代码”，很多东西都留给想象，但它是一本很好的阅读书，对我有很大帮助。

* * *

## 回答 #5

> 赞同：5
> 
> 时间：2010-10-29T11:41:16.667

模型**与数据库无关**。如果我从 RSS 提要或 SOAP 服务获取数据或从 FS 读取文件怎么办？

我把所有这些东西放在模型中。在这种情况下，我的模型类可能**不会扩展任何东西**。我即将编写一个使用其他模型方法的模型。

* * *

## 回答 #6

> 赞同：3
> 
> 时间：2008-11-17T05:07:14.943

跳过模型部分的 ZF，有更好的解决方案。ZF 的“MVC”中的“M”几乎没有。阅读他们的文档，他们根本没有真正提到模型——这是一件好事，这意味着您可以使用几乎任何您想要的东西，而无需编写大量适配器代码。

改为查看[Doctrine](http://www.doctrine-project.org/)模型。它正在迅速成为 PHP 的事实上的 ORM。

* * *

## 回答 #7

> 赞同：1
> 
> 时间：2008-11-17T04:39:22.317

您可以进行更复杂的查询，请查看手册页中的[高级用法](http://framework.zend.com/manual/en/zend.db.table.html#zend.db.table.advanced.usage)部分。[`Zend_Db_Table`](http://framework.zend.com/manual/en/zend.db.table.html)

```
$select = $table->select();
$select->from($table,
              array('COUNT(reported_by) as `count`', 'reported_by'))
       ->where('bug_status = ?', 'NEW')
       ->group('reported_by'); 
```

* * *

## 回答 #8

> 赞同：1
> 
> 时间：2008-11-17T05:00:45.847

您可以扩展 Zend_Db_Table_Abstract 类并向其添加一些有用的方法。例如，您可以将 changePassword() 方法添加到您的用户类并操作它的数据。或者您可以更改类的默认 __toString() 方法，因此您将拥有一个自定义的 __toString() 方法，假设以格式良好的字符串返回用户的整个联系信息（姓名、地址、电话号码） . 在您的构造函数中，您可以将数据填充到对象的属性中。然后像这样使用它们：

```
public function __toString() {
   $data = $this->_name . ', ' . $this->_adderss . ', call: ' . $this->_phone;
   return $data;
} 
```

您的模型扩展 Zend_Db_Table_Abstract 只是为了简化访问其数据的过程，但是您可以对这些数据拥有的功能完全取决于您的创造力和需求。我向你推荐 Cal Evans 的书“php|architect's guide to Programming with zend framework”。这本书内容丰富，易于阅读。第 4 章和第 6 章将有助于解决这个问题。

* * *

## 回答 #9

> 赞同：1
> 
> 时间：2008-11-17T20:55:55.403

数据库实体不是唯一一种模型组件。因此，谈论模型（复数形式）并没有真正意义——您的应用程序有*一个*模型，其中包含大量组件。其中一些组件可能是表网关（因此扩展自`Zend_Db`），而其他组件则不是。

我建议您阅读 Eric Evans 的《[领域驱动设计](http://books.google.com/books?id=7dlaMs0SECsC&dq=Domain+Driven+Design&pg=PP1&ots=ulAU40W7s1&source=bn&sig=RIl_hphC_4_esto9wSYmm7FJ81s&hl=da&sa=X&oi=book_result&resnum=4&ct=result#PPR9,M1)》一书，该书在解释如何构建对象模型方面做得非常出色。

* * *

## 回答 #10

> 赞同：1
> 
> 时间：2009-01-30T14:52:16.023

我使用 Propel 1.3 而不是 Zend_Db_Table。设置起来很棘手，但很棒。它可以检查您的数据库并自动生成所有模型。它实际上生成了 2 个级别和 2 种类型的模型。

“用户”表的示例：

第 1 级：BaseModel 和 BasePeer：每次重新生成 ORM 时，这些都会被覆盖。即 BaseUser.php & BaseUserPeer.php

第 2 级：StubModel 和 StubPeer：这些不会被覆盖。它们是您自定义的。即 User.php & UserPeer.php

类型 1：模型 - 用于基本 CRUD 操作，而不是查询，即 User.php 类型 2：对等 - 用于查询。这些是静态对象。即UserPeer.php

所以要创建一个用户：

```
$derek = new User();
$derek->setFirstName('Derek');
$derek->save(); 
```

要找到所有 dereks：

```
$c = new Criteria();
$c->add(UserPeer::FIRST_NAME, 'Derek');
$dereks = UserPeer::doSelect($c); 
```

* * *

## 回答 #11

> 赞同：1
> 
> 时间：2010-04-06T14:58:55.967

[http://zfsite.andreinikolov.com/2008/08/zend_db_table-time-overhead-about-25-percents/](http://zfsite.andreinikolov.com/2008/08/zend_db_table-time-overhead-about-25-percents/)

有点问题 22，Zend_Table 原则上很好，但会产生一些性能开销（没有缓存）......

# iphone - 将新设备添加到临时条款的最佳工作流程是什么？

> ID：294878
> 
> 赞同：3
> 
> 时间：2008-11-17T04:18:17.680
> 
> 标签：iphone, xcode

所以我们都需要将我们的应用程序部署到真实的 iPhone 上进行测试。我相信你和我一样已经找到了一组sucke^H^H^H^H^H 测试人员来帮助你完成这个过程。每当您想将构建发送给新人时，都需要将新设备 ID 添加到您的临时配置中。这部分相当无痛。当试图让 Xcode 使用新的配置文件时，麻烦就开始了。

第一次让 Xcode 获取并使用新规定的最佳方式是什么？理想情况下，我想在*不*更改 .xcodeproj 文件的情况下执行此操作。

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2008-11-17T18:11:29.183

我已经这样做了，取得了很好的成功：

*   发出征集测试人员的电话。
*   回复每个“为了进行 beta 测试，我需要你的 UDID。你可以按照这些说明将其发送给我......”
    *   无法发送 UDID 的人们会被告知“感谢您的宝贵时间，但 beta 版不再接受申请”。
    *   如果太多人无法弄清楚，请查看您的说明。
*   几天后，与所有处于测试阶段的人一起制作批量配置文件。
    *   我以该人的电子邮件地址命名这些设备，*即*mikeATexampleDOTcom。
    *   我以 beta 程序命名该条款，*即*Neko-beta-1。
*   构建应用程序、提供和交付（使用非技术安装说明！）
*   对于落后者，您可以构建另一个配置，或者将它们添加到现有配置中，或者告诉他们“测试版已满”。

然后...

*   几天后，发送电子邮件询问进展如何，是否有任何困难等。
*   大约在 Beta 结束前 3 天，电子邮件说“Beta 即将结束，请务必返回您的问卷。”
*   公测结束后，一定要感谢大家，即使是没有回复的人。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-08-05T20:14:38.940

如果设备发生变化，我现在要做的是创建一个新的配置文件。即使您修改了现有的配置文件，它本质上也是一个具有不同 ID 的新配置文件，而是一个新名称。然后测试人员的 iPhone 会填满同名的配置文件 :)

是的，这意味着每次都更改您的 Xcode 项目文件，但根据我的经验，它更可靠。

如果您确实保留相同的名称，请注意 Xcode 的配置文件缓存，这可能会导致构建混乱。最好的办法是从管理器窗口中删除所有配置文件，以及删除 ~/Library/MobileDevice/Provisioning Profiles 中的文件。然后重新启动 Xcode 并重新导入配置文件。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2009-05-28T20:09:58.053

如何从 XCode 自动构建 IPA 文件：[http ://www.idotcom.us/2009/05/how-to-build-a-ipa-file-from-xcode/](http://www.idotcom.us/2009/05/how-to-build-a-ipa-file-from-xcode/)

逐步说明如何构建 IPA 文件以通过 ad-hoc 发送出去。您确实必须更改您的 XCode 项目，但这样您就创建了一个单独的目标，因此它不会影响您的主项目。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2008-11-17T04:36:31.747

如果不更改 .xcodeproj 文件，我无法做到这一点，但这可能是因为我运气不好，没有经历整个“构建干净，取消选择配置文件，重新选择配置文件”过程。 .

# html - 如何在 TBODY 元素之间放置间距

> ID：294885
> 
> 赞同：106
> 
> 时间：2008-11-17T04:29:48.030
> 
> 标签：html, css

我有一张这样的桌子：

```
<table>
    <tfoot>
        <tr><td>footer</td></tr>
    </tfoot>
    <tbody>
        <tr><td>Body 1</td></tr>
        <tr><td>Body 1</td></tr>
        <tr><td>Body 1</td></tr>
    </tbody>
    <tbody>
        <tr><td>Body 2</td></tr>
        <tr><td>Body 2</td></tr>
        <tr><td>Body 2</td></tr>
    </tbody>
    <tbody>
        <tr><td>Body 3</td></tr>
        <tr><td>Body 3</td></tr>
        <tr><td>Body 3</td></tr>
    </tbody>
</table> 
```

我想在每个 tbody 元素之间放置一些间距，但是 padding 和 margin 没有效果。有任何想法吗？

* * *

## 回答 #1

> 赞同：95
> 
> 时间：2012-05-26T00:03:18.293

根据您的浏览器支持要求，这样的事情会起作用：

```
tbody::before
{
  content: '';
  display: block;
  height: 15px;

} 
```

* * *

## 回答 #2

> 赞同：64
> 
> 时间：2008-11-17T04:31:36.997

试试这个，如果你不介意没有边界。

```
<style>
table {
  border-collapse: collapse;
}

table tbody {
  border-top: 15px solid white;
}
</style>

<table>
    <tfoot>
        <tr><td>footer</td></tr>
    </tfoot>
    <tbody>
        <tr><td>Body 1</td></tr>
        <tr><td>Body 1</td></tr>
        <tr><td>Body 1</td></tr>
    </tbody>
    <tbody>
        <tr><td>Body 2</td></tr>
        <tr><td>Body 2</td></tr>
        <tr><td>Body 2</td></tr>
    </tbody>
    <tbody>
        <tr><td>Body 3</td></tr>
        <tr><td>Body 3</td></tr>
        <tr><td>Body 3</td></tr>
    </tbody>
</table> 
```

* * *

## 回答 #3

> 赞同：25
> 
> 时间：2008-11-17T18:00:51.857

人们对于使用空表元素来布局页面总是有争议的意见（正如这个答案的反对票所证明的那样）。**我认识到这一点，但有时当您以“快速而肮脏**”的方式工作时，以这种方式使用它们会更容易。

我在过去的项目中使用空行来分隔表格行组。我为间隔行分配了一个它们自己的 css 类，并为该类定义了一个高度，作为该组表格行的顶部和底部边距。

```
 .separator{
             height: 50px;
    }

   <table>
           <tr><td>Cell 1</td><td>Cell 2</td></tr>
           <tr><td>Cell 1</td><td>Cell 2</td></tr>
           <tr><td>Cell 1</td><td>Cell 2</td></tr>

           <tr class="separator" colspan="2"></tr>

           <tr><td>Cell 1</td><td>Cell 2</td></tr>
           <tr><td>Cell 1</td><td>Cell 2</td></tr>
           <tr><td>Cell 1</td><td>Cell 2</td></tr>

           <tr class="separator" colspan="2"></tr>

           tr><td>Cell 1</td><td>Cell 2</td></tr>
           <tr><td>Cell 1</td><td>Cell 2</td></tr>
           <tr><td>Cell 1</td><td>Cell 2</td></tr>
   </table> 
```

~~如果您的表格单元格上没有边框，~~您还可以在样式表中定义典型单元格或行的高度，以均匀地隔开表格的所有行。

```
tr{
   height: 40px;
} 
```

* * *

## 回答 #4

> 赞同：15
> 
> 时间：2015-09-15T13:06:08.330

在几个浏览器中存在包含行跨度的情况下，我一直在`<tbody>`用伪正确地间隔多个。`::before``<tr>``<td>`

基本上，如果你有这样的`<tbody>`结构：

```
<tbody>
    <tr>
        <td>td 1</td>
        <td rowspan"2">td 2</td>
        <td>td 3</td>
        <td>td 4</td>
    </tr>
    <tr>
        <td>td 1</td>
        <td>td 2</td>
        <td>td 4</td>
    </tr>
</tbody> 
```

并且您遵循谁建议在`::before`伪元素上编写 css，如下所示：

```
tbody::before
{
    content: '';
    display: block;
    height: 10px;
} 
```

这将影响行跨度，使表在第二个中“丢失”第一个中存在`<tr>`多少行跨度。`<td>`

因此，如果有人遇到这种类型的问题，解决方案就是以`::before`这种方式设置伪样式：

```
tbody::before
{
    content: '';
    display: table-row;
    height: 10px;
} 
```

这是一个[小提琴](https://jsfiddle.net/6e8vxnpn/)

* * *

## 回答 #5

> 赞同：7
> 
> 时间：2008-11-17T05:09:28.980

这是依赖于 :first-child 的另一种可能性，并非在所有浏览器中都可用：

```
<style>
table {
  border-collapse: collapse;
}

td {
  border: 1px solid black;
}

tbody tr:first-child td {
  padding-top: 15px;
}

</style>

<table>
    <tfoot>
        <tr><td>footer</td></tr>
    </tfoot>
    <tbody>
        <tr><td>Body 1</td></tr>
        <tr><td>Body 1</td></tr>
        <tr><td>Body 1</td></tr>
    </tbody>
    <tbody>
        <tr><td>Body 2</td></tr>
        <tr><td>Body 2</td></tr>
        <tr><td>Body 2</td></tr>
    </tbody>
    <tbody>
        <tr><td>Body 3</td></tr>
        <tr><td>Body 3</td></tr>
        <tr><td>Body 3</td></tr>
    </tbody>
</table> 
```

* * *

## 回答 #6

> 赞同：5
> 
> 时间：2009-04-02T06:36:02.293

在上面给出的所有答案中，只有 djenson47 的答案保留[了presentation 和 content 的分离](http://en.wikipedia.org/wiki/Separation_of_presentation_and_content)。**折叠边框模型**方法的缺点是您不能再使用表格的*边框*或单元格*间距*属性来分隔各个单元格。您可能会争辩说这是一件好事，并且有一些解决方法，但这可能会很痛苦。所以我认为第*一个孩子*的方法是最优雅的。

或者，您也可以将 TBODY 类的*溢出*属性设置为“可见”以外的任何内容。此方法还允许您保留分离的边框模型：

```
<style>
tbody {
    overflow: auto;
    border-top: 1px solid transparent;
}
</style>
<table>
    <tfoot>
        <tr><td>footer</td></tr>
    </tfoot>
    <tbody>
        <tr><td>Body 1</td></tr>
        <tr><td>Body 1</td></tr>
        <tr><td>Body 1</td></tr>
    </tbody>
    <tbody>
        <tr><td>Body 2</td></tr>
        <tr><td>Body 2</td></tr>
        <tr><td>Body 2</td></tr>
    </tbody>
    <tbody>
        <tr><td>Body 3</td></tr>
        <tr><td>Body 3</td></tr>
        <tr><td>Body 3</td></tr>
    </tbody>
</table> 
```

* * *

## 回答 #7

> 赞同：4
> 
> 时间：2012-12-15T19:07:13.393

您可以`border-spacing`在具有表行组的表中使用这些组之间的空格。不过，我认为没有办法指定哪些组是间隔的，哪些不是。

```
<table>
  <thead>
    ...
  </head>
  <tbody>
    ...
  </tbody>
  <tbody>
    ...
  </tbody>
  <tfoot>
    ...
  </tfoot>
</table> 
```

CSS

```
table {
  border-spacing: 0px 10px; /* h-spacing v-spacing */
} 
```

* * *

## 回答 #8

> 赞同：4
> 
> 时间：2014-05-15T15:26:27.163

只需设置`display`为`block`，它就会工作。

```
table tbody{
    display:block;
    margin-bottom:10px;
    border-radius: 5px;
} 
```

* * *

## 回答 #9

> 赞同：4
> 
> 时间：2014-07-11T11:00:40.103

因为填充可以应用于 TD，所以你可以用 + 号来做一个技巧。然后可以为 tbody 的第一个 TR 的 TD 提供顶部填充：

```
// The first row will have a top padding
table tbody + tbody tr td {
    padding-top: 20px;
}

// The rest of the rows should not have a padding
table tbody + tbody tr + tr td {
    padding-top: 0px;
} 
```

我添加了“tbody + tbody”，所以第一个 tbody 不会有顶部填充。但是，这不是必需的。

据我所知，没有缺点:)，虽然没有测试旧的浏览器。

* * *

## 回答 #10

> 赞同：0
> 
> 时间：2009-04-02T06:51:34.580

## 新答案

您可以使用任意数量的`<tbody>`标签。直到现在我才意识到 W3C 可以这样做。并不是说我的下面的解决方案不起作用（确实如此），但是要执行您想做的事情，请分配您的`<tbody>`标签类，然后`<td>`通过 CSS 引用它们的各个标签，如下所示：

```
table tbody.yourClass td {
    padding: 10px;
} 
```

因此，您的HTML：

```
<table> 
<tbody>
<tr><td>Text</td></tr>
<tr><td>Text</td></tr>
<tr><td>Text</td></tr>
</tbody>
<tbody class="yourClass">    
<tr><td>Text</td></tr>
<tr><td>Text</td></tr>
<tr><td>Text</td></tr>
</tbody>
<tbody>
<tr><td>Text</td></tr>
<tr><td>Text</td></tr>
<tr><td>Text</td></tr>
</tbody>
</table> 
```

试试那个人:)

## 旧答案

无论您做什么，都不要插入空白行...

你的表中不应该有超过 1 个 tbody 元素。你可以做的是在你的`<tr>`元素中设置 class 或 id 属性并给它们相应的`<td>`标签填充：

```
table {
    border-collapse: collapse;
}

tr.yourClass td {
    padding: 10px;
} 
```

您甚至可以为 top 和 bottom 分配`<tr>`一个附加类，以便它们分别只进行顶部或底部填充：

```
tr.yourClass.topClass td {
    padding: 10px 0 0 0;
}

tr.yourClass.bottomClass td {
    padding: 0 0 10px 0;
} 
```

在您的 HTML 中，您的`<tr>`标签将如下所示：

```
<table> 
<tbody>
<tr><td>Text</td></tr>
<tr><td>Text</td></tr>
<tr><td>Text</td></tr>
<tr class="yourClass topClass"><td>Text</td></tr>
<tr class="yourClass"><td>Text</td></tr>
<tr class="yourClass bottomClass"><td>Text</td></tr>
<tr><td>Text</td></tr>
<tr><td>Text</td></tr>
<tr><td>Text</td></tr>
</tbody>
</table> 
```

希望这可以帮助！

* * *

## 回答 #11

> 赞同：0
> 
> 时间：2013-09-13T19:23:12.140

djensen47 答案适用于较新的浏览器，但是，正如它所指出的那样，它在 IE7 中不起作用。

我解决此问题以支持旧版浏览器的解决方法是将每个单元格内容包装在一个 div 中。然后在 div 中添加一个 margin-top。

```
<table class="tbl">
<tr></tr>
<tr></tr>
<tr></tr>
<tr><td><div></div></td></tr>
</table> 
```

CSS

```
.tbl tr td div {
    height:30px;
    margin-top:20px;
} 
```

高度设置使单元格至少保持 30px 高，以防止 div 内使用的任何单元格颜色在文本周围折叠。margin-top 通过使整行更高来创建所需的空间。

* * *

## 回答 #12

> 赞同：0
> 
> 时间：2019-05-10T14:58:44.773

在尝试自己解决时遇到了这个问题。我成功地`<br>`在结束标签之前放置了一个`</tbody>`标签。这是一个纯粹的视觉修复，但似乎适用于我测试的大多数浏览器。

```
<table>
    <tbody>
        <tr>
            <td></td>
        </tr>
        <br>
    </tbody>
    <tbody>
        <tr>
            <td></td>
        </tr>
    </tbody>
</table> 
```

也应该可以访问。

* * *

## 回答 #13

> 赞同：0
> 
> 时间：2020-10-29T13:36:14.263

感谢所有第一个回答的人......

```
table {
  border-collapse: collapse;
  table-layout: fixed;
  width: 50%;
}
tbody:before {
  content: "";
  display:block;
  border-top: 15px solid white;
}
tbody tr {
  border-color: #000;
  border-style: solid;
}
tbody tr:first-of-type{
  border-width: 2px 2px 0 2px;
}
tbody tr:nth-of-type(1n+2){
  border-width: 0 2px 0 2px;
}
tbody tr:last-of-type{
  border-width: 0 2px 2px 2px;
}
tbody tr:nth-child(odd) {
  background-color: #ccc;
}
tbody tr:hover {
  background-color: #eee;
}
td {
  text-align: right;
}
```

```
<table>
  <tbody>
    <tr>
      <th colspan="3">One</th>
    </tr>
    <tr>
      <td>1</td>
      <td>2</td>
      <td>3</td>
    </tr>
    <tr>
      <td>1</td>
      <td>2</td>
      <td>3</td>
    </tr>
    <tr>
      <td>1</td>
      <td>2</td>
      <td>3</td>
    </tr>
    <tr>
      <td>1</td>
      <td>2</td>
      <td>3</td>
    </tr>
  </tbody>
  <tbody>
    <tr>
      <th colspan="3">Two</th>
    </tr>
    <tr>
      <td>1</td>
      <td>2</td>
      <td>3</td>
    </tr>
    <tr>
      <td>1</td>
      <td>2</td>
      <td>3</td>
    </tr>
    <tr>
      <td>1</td>
      <td>2</td>
      <td>3</td>
    </tr>
    <tr>
      <td>1</td>
      <td>2</td>
      <td>3</td>
    </tr>
  </tbody>
</table>
```

# asp.net-mvc - ASP.NET MVC - 用户输入和服务/存储库 - 在哪里进行验证？

> ID：294890
> 
> 赞同：4
> 
> 时间：2008-11-17T04:35:02.933
> 
> 标签：asp.net-mvc, design-patterns

这可能是一个太自以为是的问题，但寻求帮助！

我一直在尝试改进我的 ASP.NET MVC 程序结构。我刚刚在预览版 5 中开始使用它，这是我第一次涉足业务应用程序开发——所以一切都是新的！

在控制器级别，我有一个服务对象，负责与存储库通信并处理所有业务逻辑。在操作级别，我有一个包含所有视图数据的对象——用户输入和生成的输出——我将其称为视图对象（是否有一个通用术语？）。与我看到的大多数示例不同，此对象不是数据库对象，而是特定于视图的对象。

所以现在我想添加用户验证。问题是，我不知道把它放在哪里。在服务层中做这件事对我来说最有意义。服务层负责所有的业务逻辑，验证就是业务逻辑。另一方面，我看到的大多数验证框架都是用于验证对象，这让我认为视图对象应该具有验证意识。最后，有一些验证方法需要数据库连接（例如检查用户输入字段是否有对应的数据库记录），并且视图对象没有数据库的概念，只有服务。

所以我看到的一些选项是：

*   在 Service.Method 中对传递给方法的参数进行验证。
*   在调用 Service.Method 之前在视图对象中进行验证。
*   在视图对象中进行验证，但使 Service.Method 需要视图对象引用，因此它正在启动对象的验证。

我敢肯定还有更多。我很好奇其他人如何处理 MVC 意义上的用户输入验证。我以前使用过 Enterprise Validation Block，并且喜欢能够对所有内容使用库存验证器，但我不确定如何使其适合单独的视图对象和服务层。如果它们（查看对象/服务）是同一个对象，那会很容易，这可能是人们所做的吗？就像我说的，这对我来说是全新的，我正在寻找最佳实践/模式。

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2008-11-17T04:49:13.187

我通常在提交表单时在控制器操作中进行基本验证（必填字段、电子邮件格式等）。然后我让业务层处理需要业务知识的验证。我通常也会仔细检查业务层中的基本内容，因此如果我通过 Web 服务公开该逻辑或稍后在另一个应用程序中使用它，我仍然可以验证最重要的地方（IMO）。

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2008-11-17T05:54:09.827

这有一些有趣的链接

*   [MVC 和 MS 验证应用程序块](http://stephenwalther.com/Blog/archive/2008/09/09/asp-net-mvc-tip-42-use-the-validation-application-block.aspx "点我！")
*   [MVC 和数据注释验证器](http://stephenwalther.com/blog/archive/2008/09/10/asp-net-mvc-tip-43-use-data-annotation-validators.aspx "也点我！")
*   [表单验证视频](http://www.asp.net/learn/mvc-videos/video-423.aspx)

就个人而言，我已经向我的服务层对象（前两个链接）添加了验证。这样，如果*任何控制器中的**任何*方法决定调用我的服务方法.. 逻辑都被选中并装箱在一个位置。*干*。

 **也就是说，我还有一些 UI 验证（第三个链接）.. 以减少往返时间。

最后，当前的 MVC dll 能够将错误消息传递回 UI ......因此视图可以很好地显示它们。查看 ：-

*   ViewData.ModelState.AddModelError（键，消息）

嗯！

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2008-11-17T05:44:13.950

检查以下博客文章

[http://blog.codeville.net/2008/09/08/thoughts-on-validation-in-aspnet-mvc-applications/](http://blog.codeville.net/2008/09/08/thoughts-on-validation-in-aspnet-mvc-applications/) [http://www.emadibrahim.com/2008/09/08/client-server- aspnet-mvc 中的侧面验证/](http://www.emadibrahim.com/2008/09/08/client-server-side-validation-in-aspnet-mvc/)

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2008-11-17T05:00:16.830

看看 S#arp 架构项目。在模型上处理验证以确保没有实体以无效状态持久保存到数据库中。它通过使用 NHibernate.Validator 并将其附加到 NHibernate 的保存和更新事件来做到这一点。

就个人而言，这种方法对我来说最有意义，因为您不必在多个控制器中复制验证逻辑。

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2008-11-17T16:32:45.730

我担心我的帖子没有回复，很高兴错了！

我以前读过这些链接，但可能是一个月或更长时间前，用我现在理解的内容重新阅读它们非常有帮助。我真的很喜欢史蒂夫·桑德森（Steve Sanderson）的带有滑动比例的帖子，但希望他能展示一个在光谱的右端验证某些东西的例子。

作为他博客中的一个例子，他给出了：“'用户名必须是唯一的'可能会在您的数据库中强制执行”。那么这会是这样的：

```
public static void SavePerson(Person person)
{
    // make sure it meets some format requirement
    // in this case the object is responsible for validation and the service layer is the caller
    person.EnsureValid();

    // todo: action to verify username is unique by checking database
    // in this case the service layer is responsible for calling and implementing validation

    // todo: action to save to database
} 
```

这是有道理的，并且会显示我很难掌握将验证放在哪里，因为它位于服务层（非常独特的名称）和视图对象（验证格式）中。

我担心的另一个问题是服务层开始随着验证逻辑膨胀。也许把它分成不同的班级或其他什么？在我的情况下，一些验证逻辑可能会在服务之间共享，所以我想考虑一种 DRY 方法来实现它。有趣的事情要考虑！

Emad Ibrahim 的链接很棒，因为一旦我开始对这个过程有了更多了解，我就会寻找一种方法来使用相同的规则集生成 javascript 客户端验证，而无需重复代码。他已经有了:)

我听说过 S#arp，但没有坐下来看看它是如何工作的（我不确定它上面是否有很多演示，或者下载代码是否就是演示！）。我不确定仅对数据库模型进行验证是否就足够了。在我看来，关于数据库的许多有效模型状态会被业务逻辑认为是无效的（例如日期范围/必须在之前/之后/等）。这些是让我脑筋急转弯的案例：）

另外，一个我喜欢的链接（在我看到 Emad 用 BLL 回复 Steves 的帖子后用谷歌搜索它，但不知道它是什么意思...... duh）：

[http://en.wikipedia.org/wiki/Business_logic_layer](http://en.wikipedia.org/wiki/Business_logic_layer)

所以我不知道，但我认为这是我要写入的模型：处理数据交互的业务流程对象，以及作为逻辑模型而不是数据库模型的业务实体。我想我需要开始阅读一些更基本的模式和实践，以更好地理解这些概念（看起来很多都是 Java 人写的东西与 .NET 人写的东西）。可能是时候退后一步了:)

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2009-10-13T20:15:48.920

我在最近的一个项目中遇到了同样的问题。首先，为了重申这个问题，我试图遵循 DDD 的以域为中心的方法。我将实体组合成可以验证自己的聚合，并且存储库在保存时验证有效性。UI 还可以从聚合中获取有效性信息，以便向客户端显示错误反馈。一般的方法是尽可能多地利用 ASP.NET MVC 的模型绑定和验证/表单 UI 助手。这将创建简单的 UI 流程：1) 绑定，2) 验证，3) 如果有效，则保存，否则重新填充视图。

但是，当涉及 DDD 服务时，如何利用 ASP.NET MVC 和这个简单的流程并不是很明显。最初，我是这样开发我的服务的：

```
public class SomeProcessService 
{
  public Result Execute(int anAggregateID, int anotherAggregateID, string someData) 
  {
    // validate input

    // if invalid, return failures

    // else 
    //   modify aggregates
    //   using (transaction)
    //   {
    //     save aggregates
    //     commit
    //   }

    // return success
  }
} 
```

问题是验证和保存在方法中是密不可分的。为了利用 MVC 模型绑定，我们需要一些可以作为模型绑定的东西。我正在对此进行重构：

```
public class SomeProcessService 
{
  public class Request : IValidateable
  {
    public int AggregateID {get;set;}
    public int AnotherAggregateID {get;set;}
    public string SomeData {get;set;}

    public Result Validate() 
    {
      // validation
    }
  }

  public void Execute(Request request) 
  {
    // validate input by calling request.Validate()

    // if invalid, throw new ValidationException(request)

    // else 
    //   modify aggregates
    //   using (transaction)
    //   {
    //     save aggregates
    //     commit
    //   }

    // return success
  }
} 
```

这将[参数对象模式](http://c2.com/cgi/wiki?ParameterObject)重新用于分离方法输入验证。我可以绑定到控制器中的 SomeProcessService.Request 对象，并在那里获取验证信息。如果一切顺利，我会从我的控制器使用 Request 对象作为参数启动服务调用。这种方法似乎很高兴地将 DDD 服务与 ASP.NET MVC 验证要求结合在一起。

# gmail - Yahoo、Gmail、Hotmail 和 AOL 是否有白名单？

> ID：294894
> 
> 赞同：1
> 
> 时间：2008-11-17T04:37:59.527
> 
> 标签：gmail, yahoo, hotmail, whitelist

在我的网站（正在开发中）中，成员可以互相发送消息，这些消息直接发送到他们的电子邮件，现在我担心一些成员可以向其他成员发送垃圾邮件（我有一个垃圾邮件过滤器，但它不给如您所知，100% 保护），我担心我的域可能会在 Yahoo、Gmail、Hotmail 或 AOL 上被列入黑名单，这会导致从我的域发送的任何邮件最终进入垃圾邮件文件夹，这就是我想添加的原因我网站的域到他们的白名单（如果存在）。

PS 我不想使用会员在网站上查看的私人消息，我有这样做的理由。

谢谢

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2008-11-19T01:24:13.927

您的电子邮件可能不会被视为“批量”，因为它听起来像是一个 -> 一个，而不是一个 -> 多个，但这些批量邮件帮助资源可能仍然有用：

*   [雅虎！邮件管理员帮助](http://help.yahoo.com/l/us/yahoo/mail/postmaster/forms_index.html)
*   [GMail 批量发件人指南](https://mail.google.com/support/bin/answer.py?answer=81126)
*   [Windows Live Hotmail 邮政主管服务](http://postmaster.live.com/)
*   [美国在线邮政局长网站](http://postmaster.aol.com/)

正如 Bevan 所提到的，您的任务将是一项持续的任务，以使您的网站在各种服务上保持清洁。

不确定您是否已经在考虑这一点，但您可以“代表”请求用户发送电子邮件（即，将 from 和 reply-to 字段设置为发送邮件的用户）。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2008-11-17T04:58:07.083

虽然这些网站可能使用了白名单，但我怀疑它们只会对正在使用的评分系统做出贡献——仅仅在名单上是不够的。

总体控制因素将是您网站的“声誉”——您需要努力确保声誉保持良好。

不幸的是，对于您的工作量，我认为这将是一项持续的任务，而不是一次性的。

# winforms - Form.Show 未显示在 Vista 的任务栏中

> ID：294901
> 
> 赞同：2
> 
> 时间：2008-11-17T04:46:59.713
> 
> 标签：winforms

我有一个 winform 应用程序，它隐藏它的 UI 并在显示之前等待命名管道消息在接收到事件时，线程调用到主 UI 线程，然后执行以下操作

将不透明度设置为 100 ShowInTaskbar = true; 带前（）；

在 Windows Vista 上，该窗口不会显示在任务栏上，并且该窗口位于后台。你不能说，如果你终于找到它并点击它，它会显示在任务栏上

有想法该怎么解决这个吗

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2008-11-27T14:35:08.943

我不在 vista 中工作，但最好只是闪烁任务栏或弹出气球或类似的东西。你的建议对用户来说可能有点烦人。说在那里打字，在那里看着键盘，你的窗口偷走了他们回头看的焦点，发现他们刚刚写的东西并没有进入他们认为进入的应用程序。[像这样](http://www.codinghorror.com/blog/archives/001011.html "像这样")。

[闪烁任务栏](https://stackoverflow.com/questions/29460/stop-the-taskbar-flashing)

[这也可能有帮助](https://stackoverflow.com/questions/46030/c-force-form-focus)

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2010-10-27T15:52:52.193

如果表单设置了所有者，它可能会或可能不会显示在任务栏中。

不要设置 Owner 属性，它应该显示正常（它对我有用）。

# .net - 为什么 .NET 中的布尔值是 4 个字节？

> ID：294905
> 
> 赞同：42
> 
> 时间：2008-11-17T04:51:57.190
> 
> 标签：.net

为什么 System.Boolean 需要 4 个字节？它只存储一种状态，*true*或*false*，可以存储在不到 4 个字节的空间中。

* * *

## 回答 #1

> 赞同：58
> 
> 时间：2008-11-17T05:26:34.140

A`bool`其实只有1个字节，但是对齐可能会导致在32位平台上使用4个字节，在64位平台上甚至是8个字节。例如，`Nullable<bool>`(aka `bool?`) 类型使用完整的 32 位或 64 位 — 取决于平台 — 即使它仅由两个`bool`s 组成。 **编辑**：正如 Jon Skeet 所指出的，对齐填充并不*总是*存在。例如，一个`Nullable<bool>`s 数组每个对象只占用 2 个字节，而不是 4 或 8 个字节。

`bool`但是，如果要存储很多位，即使是 8 位来表示 a也可能被认为是浪费的。出于这个原因，如果您创建的类型有许多`bool`s 作为成员（或使用许多`Nullable<>`类型），**并且**您的类的用户可能会创建它的许多实例，您可能会考虑使用 a`BitVector32`代替。例如，框架本身使用这种技术来减少许多 Windows 窗体控件的内存占用。

* * *

## 回答 #2

> 赞同：13
> 
> 时间：2008-11-17T04:56:41.750

因为它很快。

32 位处理器通常使用 32 位值。使用较小的值涉及较长的指令或额外的逻辑。

* * *

## 回答 #3

> 赞同：6
> 
> 时间：2008-11-17T04:55:57.883

Google 搜索[System.Boolean size](http://www.google.com/search?q=system.boolean+size)的第一个结果告诉我，这与内存对齐有关。推动一个四字节的 Int32 比处理单个字节/位要快。

* * *

## 回答 #4

> 赞同：2
> 
> 时间：2008-11-17T04:56:55.107

我认为这只是为了性能，32 位值的操作效率更高。

* * *

## 回答 #5

> 赞同：2
> 
> 时间：2008-11-17T04:57:14.090

你从哪儿弄来的？System.Boolean 只占用**1**个字节。

你试一试：

```
Console.WriteLine( sizeof( System.Boolean ).ToString() ); 
```

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2014-02-14T16:46:44.503

我使用以下代码创建了几个数组并对其进行了测试。float?[100000] 使用的内存是 float[100000] 的两倍。这是因为在浮点数中伴随浮点数的布尔值？case 对齐到 32 位（至少在我的机器上 ;-) ）

```
long startMem = 0, stopMem = 0;
DateTime startTime = DateTime.Now;
private void StartMemoryUsage()
{
    GC.Collect();
    GC.Collect();
    startMem = GC.GetTotalMemory(true);
    startTime = DateTime.Now;
}
private void StopMemoryUsage()
{
    GC.Collect();
    GC.Collect();
    stopMem = GC.GetTotalMemory(true);

    Console.WriteLine("---> {0} sec.  Using {1} KB.", (DateTime.Now - startTime).TotalSeconds, ((stopMem - startMem) / 1000).ToString());
} 
```

# tdd - 我是否应该在尚未使用 TDD 的项目上开始使用它

> ID：294909
> 
> 赞同：14
> 
> 时间：2008-11-17T04:57:01.860
> 
> 标签：tdd

我有一个项目我已经做了一段时间了，这只是我希望有一天将其发布为开源的那些小宠物项目之一。

现在我大约 12 个月前开始了这个项目，但我只是轻轻地工作，我刚刚开始将更多的时间集中在它上面（几乎每天晚上）。

因为它是一个类似于应用程序的框架，所以我有时会在方向感上挣扎，因为我没有任何东西来驱动我的设计决策，而且我有时最终会做出难以使用甚至找不到的功能。我一直在阅读有关如何进行 TDD 的文章，并认为这可能会帮助我解决我遇到的一些问题。

所以问题是您认为在尚未使用 TDD 的项目上开始使用 TDD 是个好主意吗？

编辑：我刚刚添加了一点来澄清我所说的与“方向感”斗争的意思，如果没有澄清，这不是最好的说法。

* * *

## 回答 #1

> 赞同：12
> 
> 时间：2008-11-17T05:01:25.220

在我看来，采用更好的做法——或者放弃更糟糕的做法——永远不会太晚——所以我会说“是的，你应该开始”。

然而......（总是有一个“但是”）......

... TDD 的最大收获之一是它会影响您的设计，鼓励您保持职责分离、交互清晰等等。

在您的项目中，您可能会发现很难为框架的某些方面编写测试。但是不要放弃，即使你不能测试某些领域，你的质量会在你可以测试的领域更好，你的技能会随着体验而提高。

* * *

## 回答 #2

> 赞同：7
> 
> 时间：2008-11-17T05:02:29.760

是的。

基本上，为您编写的任何新代码以及对现有代码所做的任何更改添加 TDD 都不会造成任何伤害。显然，回过头来对现有代码进行精确的测试是很棘手的，但涵盖主要用例肯定不会有什么坏处。

也许考虑看看[.NET 中的棕地应用程序开发](http://manning.com/baley/)？对于这种情况，它充满了务实和实用的建议（为“棕地”提供的定义之一是“没有适当的单元测试”）。

* * *

## 回答 #3

> 赞同：6
> 
> 时间：2008-11-17T05:21:18.923

是的，开始做 TDD 绝对是个好主意。

您将支付启动费用至少有两个原因：

1.  学习新技能 TDD/单元测试。
2.  改造您的代码以使其可测试。

你需要同时做一些，但是当你工作时，如果你发现自己在挣扎，想想这两者中的哪一个是努力的源泉。

但最终的结果是值得的。根据您的描述，这是一个您打算使用一段时间的项目。请记住，当您在这里或那里失去一个小时时。一年后，您会非常高兴您在技能集和代码库上都进行了这项投资。

* * *

## 回答 #4

> 赞同：4
> 
> 时间：2008-11-17T05:17:07.263

更糟糕的是，您可以只对新事物进行 TDD，同时为现有代码库慢慢创建测试。

* * *

## 回答 #5

> 赞同：4
> 
> 时间：2008-11-17T06:20:08.493

是的，开始使用 TDD 永远不会太晚。在我加入时，我已经将 TDD 引入了一个已经运行了五年的商业项目，这绝对是一个不错的决定。

虽然您是该技术的新手，但您可能应该专注于将它用于您从零开始编写的代码 - 新类，新方法等。一旦您掌握了它，开始为您更改的代码编写测试.

对于某些代码，后者可能被证明是困难的，因为到目前为止您编写的代码不太可能在编写时考虑到可测试性。有一些技术可以解决这个问题，但现在关注它们可能还为时过早。

但是，如果您缺少方向感，我怀疑 TDD 是否会对您有很大帮助。您可能希望改为研究验收测试，它至少与单元测试一样重要，并且将帮助您专注于系统的功能而不是单个代码单元。Lasse Koskela 的 TDD 书很好地介绍了*这两种*技术。

另一种可能对您有所帮助的技术是极限编程计划游戏，您可以将功能片段放在索引卡上并确定它们的优先级。我通常会注意到，将想法从脑海中浮出水面并按优先顺序排列有助于我理解下一步要去哪里。

* * *

## 回答 #6

> 赞同：1
> 
> 时间：2008-11-17T05:59:38.207

正如其他人所说，TDD 不应该伤害正在进行的项目，但如果您想进行大规模重构以进行测试，请仔细考虑。确保收益证明成本合理。

我有点担心你“在方向感上挣扎”。我不知道 TDD 会帮助你。我发现它对低级设计决策有很大帮助，但对架构决策却没有那么大。将 TDD 添加到一个没有方向的项目中听起来有点像生孩子来挽救婚姻——不明智。希望我误读了你的意图。

* * *

## 回答 #7

> 赞同：1
> 
> 时间：2008-11-17T12:52:39.293

是的。

TDD 使其他人更容易理解代码，并随着时间的推移为应用程序提供更好的设计

* * *

## 回答 #8

> 赞同：1
> 
> 时间：2008-11-23T20:56:39.800

理论上你应该先测试，但你没有。在这种情况下，与其他人的看法相反，我不会从新功能开始。

*   利用 80:20 规则，运行分析器，并将测试用例放在最常调用的代码段中。
*   围绕房子的宝石、直觉、最重要的代码进行测试。
*   围绕烦人的、总是破坏性的、反复出现的似曾相识的错误代码进行测试。
*   *在修复测试失败的错误之前*，围绕您遇到的所有 错误进行测试。

警告：放置测试用例需要重构，这意味着您必须修复一些没有破坏的东西。

如果您此时仍然喜欢单元测试，那么您将成为 Red、Green、Refactoring 自己。

* * *

## 回答 #9

> 赞同：0
> 
> 时间：2008-11-17T13:35:34.060

绝对地。

将 TDD 引入新代码，如果时间允许，如果尚未测试，请在现有代码中引入“评论驱动设计”。

*   注释掉你需要测试的现有代码块
*   写你的测试
*   一次取消注释您的原始代码一条语句（如果您有 if 块，请取消注释整个块）
*   确定您的原始代码是否最终通过了您的测试，如果没有，则重新编写以相应地通过您的测试

* * *

## 回答 #10

> 赞同：0
> 
> 时间：2008-11-23T20:16:45.510

为您不打算更改的现有工作代码编写测试不符合 TDD 的主旨，即*编写测试来教您正在构建的系统。*

我引入 TDD 中游的方法是：

*   为所有新功能编写测试，以及
*   更改一段代码时，编写一个涵盖现有功能的测试（以确保我理解它），然后在更改代码之前更改测试。

为与您正在更改的代码相关的代码编写测试也是有益的——例如，如果您正在更改父类，您可能希望首先围绕子类构建测试，以保护自己免受潜在的损害。

* * *

## 回答 #11

> 赞同：0
> 
> 时间：2008-11-23T20:39:45.230

是的你应该。我目前正在从事一个直到最近还没有包含单元测试的项目，但我们决定应该开始测试我们的代码，所以我们现在开始编写它们。不幸的是，我是唯一一个实践 TDD 的开发人员，其他人只是在编写代码后编写测试。
尽管如此，我发现练习 TDD 可以帮助我编写更好的代码，而且我写得比以前更快。现在我学会了如何进行 TDD，我只是不想回到以前的方式编写代码。

# jsf - JSF 上传组件：交替触发

> ID：294916
> 
> 赞同：0
> 
> 时间：2008-11-17T05:01:38.637
> 
> 标签：jsf, file-upload

我有一个 JSF 表单，需要通过单击图标来上传文件（即不显示文件上传组件的文本字段/浏览按钮）。

是否可以通过其他组件类型触发上传组件的文件打开对话框和上传功能？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2009-10-28T17:47:15.543

我认为没有任何其他“现成的”组件可以用来触发文件打开对话框（毕竟，这`<input type=file>`是由渲染器编写的结果）。

但是，如果您愿意开发自己的渲染器，它可以同时编写`<input>`图标和图标`<img>`（一个接一个）。给`<input>`一个使用绝对定位的 css 类将其放在顶部`<img>`并将其不透明度降低到 0（您也可以将光标设置为“指针”）。

现在，当用户点击*icon*时，他们也点击了不可见的输入，这会弹出你的对话框。

（现在我想起来了，我几乎肯定你可以通过将相同类型的 css 应用于现成组件来实现这一点，而无需编写自己的渲染器......）

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-04-08T08:55:10.980

不，文件上传对话框作为一项安全功能几乎是不可更改的。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2015-06-29T08:37:48.703

在 HTML5 中，有一种新方法可以使用引导程序设置 CSS 样式，并用字形图标替换图像。

```
.btn-file {
  position: relative;
  overflow: hidden;
}
.btn-file input[type=file] {
  filter: alpha(opacity=0);
  opacity: 0;
  outline: none;
  cursor: inherit;
  display: block;
  width:32px;
  font-size:24pt;
  height:12px;
}
```

```
<html>
  <head>
  <link rel="stylesheet" href="https://maxcdn.bootstrapcdn.com/bootstrap/3.3.5/css/bootstrap.min.css">
  </head>
  <body>
    <form>
      <span class="btn btn-default btn-file btn-lg">
        <span class="glyphicon glyphicon-upload"> </span> <input type="file">
      </span>
    </form>
  </body>
</html>
```

# css - Outlook 渲染问题，渲染文本过大

> ID：294917
> 
> 赞同：5
> 
> 时间：2008-11-17T05:02:21.740
> 
> 标签：css, outlook, rendering, outlook-2007

我正在尝试为我们的组织创建一个时事通讯标准，但 Outlook 呈现文本过大时遇到问题。

这是页面的css部分

```
body {
    margin: 0;
    padding: 0;
    font-family: Arial, Helvetica, sans-serif;
    font-size: 75%;
    background: url(http://www.blah.com/stuff.gif);
    }
a {
    color: #f24c22 !important;
    }
a:visited {
    color: #f24c22 !important;
    }
a:hover {
    color: #3d7ac5 !important;
    }
table {
    background: #ffffff;
    }
h1 {
    font-size: 1.3em;
    }
h2 {
    font-size: 1.2em;
    color: #494949;
    padding-top: 0 !important;
    margin-top: 0 !important;
    }
h3 {
    font-size: 1.1em;
    color: #12377c;
    }
p {
    padding-top: 0 !important;
    margin-top: 0 !important; 
    color:#333333;
    }
   .style1 {color: #333333}
   .style2 {color: #12377c}
   .style3 {
       font-size: smaller;
       color: #666666;
   } 
```

有什么建议可能会导致这种情况吗？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-02-22T21:45:46.127

你试过用`main *{font-size: 12pt;}`吗？

默认情况下，Outlook 使用 Trident，即 IE 用于接收邮件的引擎，以及用于发送邮件的 Word HTML 渲染引擎……[直到 Office 2007，人们都讨厌它。](http://blogs.zdnet.com/microsoft/?p=229)

现在，[它使用Word 2007的渲染](http://www.campaignmonitor.com/blog/post/2393/microsoft-takes-email-design-b/)，这[是相当缺乏](http://msdn.microsoft.com/en-us/library/aa338201.aspx)的。[在 microsoft 的页面上](http://msdn.microsoft.com/en-us/library/aa338201.aspx)，您可以看到 de`body`元素不支持该`style`属性。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2008-11-17T05:18:04.330

如果你想为你的字体设置一个特定的大小，那么你可能应该使用一个固定大小的类型，比如 pt。而不是像 em/% 这样的变量

[请参阅此处](http://net.jasonpearce.com/tools/cssfontsizes.html)了解我的意思。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-02-18T03:05:29.953

许多邮件阅读器从收到的任何电子邮件中去除“正文”标签，或者忽略应用于此元素的样式。尝试将字体大小应用于封闭的 div。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2009-02-24T00:02:24.463

将字体大小抽象为更小，我在标准查看时发现它是等效的大小。考虑到它是一个基本模板，在 div 中重写页面，参考 div 的 ID 以进行渲染，效果很好。在包括 gmail、hotmail 在内的各种电子邮件帐户上对其进行了测试，并通过 Outlook 呈现。Outlook 是唯一有问题的，相同的页面参考链接失败。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2009-11-05T09:18:49.300

添加这些元标记，您会发现 Word / Outlook“神奇地”呈现页面（包括图像）正确的大小：

```
<meta name="ProgId" content="Word.Document" />
<meta name="Generator" content="Microsoft Word 12" />
<meta name="Originator" content="Microsoft Word 12" /> 
```

我不知道为什么 Outlook 会这样做，我收到的大多数公司电子邮件在 Outlook 中看起来很糟糕——但是，有了这些标签，我发送的那些看起来很原始。

# c# - winforms 应用程序的轻量级工具

> ID：294922
> 
> 赞同：2
> 
> 时间：2008-11-17T05:06:29.000
> 
> 标签：c#, winforms, instrumentation

我有一个 winforms 应用程序，我想跟踪用户每次点击某些按钮等以及其他操作。什么是我跟踪这些信息的最佳方式，然后将它们放在一起，以便我可以针对最常用的功能等运行指标。

这是一个 winforms 应用程序，我在世界各地都有用户。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2008-11-17T06:01:44.087

您的设计必须确保解决两个大问题

1.  隐私（Don 提到的）- 您必须清楚地知道您正在收集哪些信息并将其发送到中央服务器，理想情况下，用户应该能够检查您发送回中央服务器的确切数据（如果他们愿意的话） ) - 对于任何公共软件，都应该有一种非常简单的退出方式。

2.  性能和可扩展性 - 您必须估计服务器端真正需要多少数据，并查看聚合和压缩数据客户端的各种技巧（以及对您将发送的流量和你多久发送一次）

至于客户端实现，我建议调查[Sqlite.net](http://sqlite.phxsoftware.com/)或其他嵌入式数据库。使用嵌入式数据库在客户端存储此信息将为您提供很大的聚合灵活性，并将具有事务性、快速和易于实现的优势。Sqlite 有一个非常慷慨的公共领域许可证，因此从法律角度来看，它非常容易在公共应用程序中使用。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2008-11-17T05:29:15.600

尝试做一个谷歌学者搜索。Ben Liblit 和合著者提出了一些有趣的想法，而 Alex Orso 和合着者的另一系列想法（免责声明 - 我是 Alex Orso 的合着者之一）基于从每个用户那里获取运行时信息样本，并以一种有趣的方式将它们组合在一起。

[http://theory.stanford.edu/~aiken/publications/papers/pldi03b.pdf](http://theory.stanford.edu/~aiken/publications/papers/pldi03b.pdf)

和

[http://www.cs.umd.edu/class/fall2006/cmsc838p/Ramss/remoteClassJournal.pdf](http://www.cs.umd.edu/class/fall2006/cmsc838p/Ramss/remoteClassJournal.pdf)

是此类论文/想法的两个（不一定是最好的）示例。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2008-11-17T05:27:11.707

我会尝试这样的事情：

```
 // execute this method once all forms have been created
    public static void HookButtons()
    {
         foreach( Form f in Application.OpenForms )
         {
              EnumerateControls( f.Controls );
         }
    }

    public static void EnumerateControls( ICollection controls )
    {
        foreach( Control ctrl in controls )
        {
            if( ctrl.Controls.Count > 0 )
            {
                EnumerateControls( ctrl.Controls );
            }

            if( ctrl is ButtonBase )
            {
                ctrl.MouseClick +=new MouseEventHandler( ctrl_MouseClick );
            }
        }

    }

    static void ctrl_MouseClick( object sender, MouseEventArgs e )
    {
        ButtonBase clicked = ((ButtonBase)sender);

        // do something with the click information here
    } 
```

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2008-11-17T05:48:03.473

小心你如何处理这件事。一些公司因收集太多信息或不清楚收集了什么而受到用户的强烈反对。最安全的方法是在启用任何“电话回家”功能之前询问用户。允许用户在发送之前查看实际数据似乎也不错。

我想知道是否有某种方法可以搭载一键式应用程序启动并检查更新时发生的一键式部署调用。不过我还没有调查。

至于收集实际数字，也许用户设置是最简单的地方。如果您不熟悉它们，只需查看项目属性并转到“设置”选项卡。

# c++ - 删除是否适用于指向基类的指针？

> ID：294927
> 
> 赞同：51
> 
> 时间：2008-11-17T05:14:54.273
> 
> 标签：c++, boost, polymorphism

您是否必须传递 delete 与 new 返回的相同的指针，或者您可以传递一个指向类基类型之一的指针？例如：

```
class Base
{
public:
    virtual ~Base();
    ...
};

class IFoo
{
public:
    virtual ~IFoo() {}
    virtual void DoSomething() = 0;
};

class Bar : public Base, public IFoo
{
public:
    virtual ~Bar();
    void DoSomething();
    ...
};

Bar * pBar = new Bar;
IFoo * pFoo = pBar;
delete pFoo; 
```

当然，这大大简化了。我真正想做的是创建一个充满 boost::shared_ptr 的容器，并将其传递给一些代码，该代码将在完成后将其从容器中删除。这段代码对 Bar 或 Base 的实现一无所知，并且将依赖 shared_ptr 析构函数中隐含的删除运算符来做正确的事情。

这可能行得通吗？我的直觉说不，因为指针不会有相同的地址。另一方面， dynamic_cast<Bar*> 应该可以工作，因此编译器在某个地方存储了足够的信息来解决这个问题。

* * *

感谢您的帮助，所有回答和评论的人。我已经知道虚拟析构函数的重要性，如我的示例所示；看到答案后，我想了一下，意识到虚拟析构函数的*全部原因*就是这种情况。因此它必须工作。我被缺少将指针转换回原始指针的可见方法而感到震惊。更多的思考让我相信有一种看不见的方法，我推测析构函数正在返回真正的删除指针以释放。当我在 ~Base 中看到这一行时，调查来自 Microsoft VC++ 的编译代码证实了我的怀疑：

```
mov eax, DWORD PTR _this$[ebp] 
```

跟踪汇编器发现这是传递给删除函数的指针。谜团已揭开。

我已经修复了将虚拟析构函数添加到 IFoo 的示例，这是一个简单的疏忽。再次感谢所有指出这一点的人。

* * *

## 回答 #1

> 赞同：64
> 
> 时间：2008-11-17T05:19:37.790

**是的，当且仅当**基类析构函数是虚拟的时它才会起作用，您已经为`Base`基类而不是为`IFoo`基类做了这件事。如果基类析构函数是虚拟的，那么当您调用`operator delete`基类指针时，它会使用动态调度通过在虚函数表中查找派生类析构函数来确定如何删除对象。

在您的多重继承的情况下，只有当您删除它的基类具有虚拟析构函数时，它才会起作用；其他基类没有虚拟析构函数是可以的，但前提是您不尝试通过其他基类指针删除任何派生对象。

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2008-11-17T07:19:09.453

这与您给定的示例无关，但是由于您提到您在`shared_ptr`删除其拥有的对象时对 ' 的行为非常感兴趣，因此您可能对使用`shared_ptr`'deleter' 感兴趣。

如果所拥有的对象`shared_ptr`在被删除时需要特殊处理，您可以为任何特定的`shared_ptr<>`. 删除器不是类型的一部分，它是`shared_ptr<>`实例的属性，因此您的`shared_ptr<>`对象容器可能有一些具有不同删除器的对象。以下是 Boost 文档对删除器的`shared_ptr<>`评价：

> 自定义释放器允许工厂函数返回 a`shared_ptr`以将用户与其内存分配策略隔离开来。由于释放器不是类型的一部分，因此更改分配策略不会破坏源或二进制兼容性，并且不需要客户端重新编译。例如，“无操作”释放器在将 a 返回`shared_ptr`到静态分配的对象时很有用，而其他变体允许将 a`shared_ptr`用作另一个智能指针的包装器，从而简化互操作性。

如果您可以修改`IFoo`为具有虚拟析构函数，那将是最干净的，因为您计划通过`IFoo`引用或指针删除作为它的子类的对象。但是，如果您遇到`IFoo`无法更正的 a ，那么如果您想`shared_ptr<IFoo>`在容器中使用，但让它指向 a `Bar`，您可以使用删除器创建`shared_ptr`实例，该删除器执行向下转换到 a`Bar*`然后执行删除操作。向下转换被认为是不好的形式，但这种技术可能是您可以在绑定中使用的东西。

# amazon-s3 - 有人实际使用 Mosso Files（Amazon S3 的竞争对手）吗？

> ID：294928
> 
> 赞同：4
> 
> 时间：2008-11-17T05:15:15.473
> 
> 标签：amazon-s3, rackspace, mosso

我们有一堆关于 S3 的数据（图像），但刚刚开始阅读有关 Mosso 文件（机架空间）的信息。本月的某个时候，他们将添加 CDN 功能，因此您上传的任何文件都是聚光灯 CDN 的一部分。

任何使用此服务的人，它都没有在 S3 上得到很好的记录或宣传。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-01-25T06:20:27.040

是的，它没有很好的记录或作为 S3 进行宣传。但是老兄，它有 CDN 支持，而 S3 缺乏这种支持（当然，除非你愿意支付额外费用）。坏事是你不能 FTP 到 Mosso CloudFile，你要么必须通过基于 Web 的控制面板或 API 上传它。然而，它仍然便宜且值得，尤其是使用 CDN。

我正在使用该服务，与 S3 相比，它非常好且具有成本效益。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-03-06T14:13:35.053

我们将它用于我们所有的客户站点，从图像到播客，它是分发内容并使其高度可用的最佳方式——尤其是在这个价格下！

干杯

# tfs - Visual Studio Team System 2008 和域问题

> ID：294931
> 
> 赞同：1
> 
> 时间：2008-11-17T05:19:31.597
> 
> 标签：tfs

我们在美国服务器上安装了 TFS。我们需要登录 VPN 才能访问 TFS 服务器。TFS 配置为与公司的域用户帐户一起使用。但是我的系统是域的一部分。因此我无法访问 TFS。我有 Visual Studio Team System Developer 版本。这里有人可以帮助如何访问安装在不同域中的 TFS 服务器吗？

问候，

克里什

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2008-11-17T06:05:27.697

TFS 使用当前登录的 Windows 帐户的域信息，它是 TFS API 的一部分。

如果您使用不同域中的帐户登录机器（*注意*：本地用户也在不同域中），您将无法获得单点登录。

据我所知，没有办法绕过 VSTS 使用的身份验证模型。您*可以*使用现有的 VS API 编写自己的 VSTS 样式扩展，也就是说，使用配置文件作为身份验证凭据，因为 TFS API 确实支持通过手动创建的用户进行身份验证（我们有一个外部应用程序在工作，它针对我们的身份验证TFS 服务器，供我们在不同域的许多办事处的员工使用）。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2008-11-19T10:22:33.247

对于 codeplex，您必须使用“SND\username_cp”连接到 TFS，也许您也可以使用“DOMAINNAME\username”。

# sql - 生成唯一 ID 以与多个表共享 SQL 2008

> ID：294933
> 
> 赞同：3
> 
> 时间：2008-11-17T05:20:51.797
> 
> 标签：sql, stored-procedures

我需要为其生成唯一 ID 的 SQL 2008 服务器中有几个表。我查看了“身份”列，但 ID 确实需要是唯一的并且在所有表之间共享。

因此，如果我说（5）五个“资产基础设施”风格的表，并且我想在它们之间使用唯一 ID 作为一个组合组运行，我需要某种生成器来查看所有（5）五个表和问题在这（5）五个故事中的任何一个中都没有重复的下一个 ID。

我知道这可以通过某种存储过程来完成，但我不确定如何去做。有任何想法吗？

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2009-05-06T14:27:33.417

最简单的解决方案是在每个表上设置您的身份种子和增量，这样它们就不会重叠。表 1：种子 1，增量 5 表 2：种子 2，增量 5 表 3：种子 3，增量 5 表 4：种子 4，增量 5 表 5：种子 5，增量 5

标识列 mod 5 将告诉您记录在哪个表中。您将用五倍的速度使用标识空间，因此请确保数据类型足够大。

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2008-11-17T05:25:13.363

为什么不使用 GUID？

* * *

## 回答 #3

> 赞同：4
> 
> 时间：2008-11-17T05:37:19.453

你可以让他们每个人都有一个身份，这个身份来自相距足够远的数字，永远不会发生冲突。

GUID 可以工作，但如果这很重要，它们会很丑陋，而且是不连续的。

另一种常见的技术是有一个带有标识的单列表，每次插入记录时都会分配下一个值。如果您需要它们从一个公共序列中提取，那么有第二列指示它被分配到哪个表并不是很有用。

您意识到这存在逻辑设计问题，对吗？

* * *

## 回答 #4

> 赞同：4
> 
> 时间：2008-11-17T06:02:58.873

稍微阅读一下设计，听起来您真正需要的是一个名为“Asset”的带有标识列的表，然后是：

a) 5 个用于资产子类型的附加表，每个表都有一个指向 Asset 主键的外键；或者

b) Asset 上的 5 个视图，每个视图选择行的一个子集，然后（向用户）显示（对用户），就像您现在拥有的 5 个原始表一样。

如果表上的列都相同，（b）是更好的选择；如果它们都不同，（a）是更好的选择。这是关于超类型/子类型关系的经典 DB 旋转。

或者，您可以做您正在谈论的事情，并使用包含所有 5 个表的 INSERT 访问的存储过程自己重新创建 IDENTITY 功能。请注意，如果您想要保证唯一性，则必须在其周围放置一个 TRANSACTION，如果这是一个流行的表，则可能使其成为性能瓶颈。如果这不是问题，那么这样的过程可能会采用以下形式：

```
CREATE PROCEDURE InsertAsset_Table1 (
  BEGIN TRANSACTION
  -- SELECT MIN INTEGER NOT ALREADY USED IN ANY OF THE FIVE TABLES
  -- INSERT INTO Table1 WITH THAT ID
  COMMIT TRANSACTION -- or roll back on error, etc.
) 
```

同样，如果您选择我上面提到的模式，SQL 已高度优化以帮助您，而不是针对此类事情进行优化（创建事务存在开销，并且您将在此过程中对所有 5 个表发出共享锁继续）。与使用上面的 PK / FK 方法相比，SQL Server 确切知道如何在没有锁的情况下执行此操作，或者使用视图方法，您只插入到 1 个表中。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2009-01-09T20:56:56.837

我在google上搜索时发现了这个。我第一次遇到类似的问题。我的想法是有一个专门的 ID 表来专门生成 ID，但我不确定这是否被认为是好的设计。所以我只想说谢谢你的确认。它看起来是一个足够的解决方案，虽然并不理想。

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2011-01-24T16:20:50.133

我有一个非常简单的解决方案。它应该适用于表数量较少的情况：

```
create table T1(ID int primary key identity(1,2), rownum varchar(64))

create table T2(ID int primary key identity(2,2), rownum varchar(64))

insert into T1(rownum) values('row 1')
insert into T1(rownum) values('row 2')
insert into T1(rownum) values('row 3')

insert into T2(rownum) values('row 1')
insert into T2(rownum) values('row 2')
insert into T2(rownum) values('row 3')

select * from T1

select * from T2

drop table T1
drop table T2 
```

* * *

## 回答 #7

> 赞同：0
> 
> 时间：2011-11-27T07:32:16.980

这是一个常见问题，例如在使用人员表（请称为 PERSON 单数）并且每个人都被分类时，例如医生、患者、员工、护士等。

为每个人创建一个包含特定类别信息（例如员工开始日期和薪水以及护士资格和编号）的表非常有意义。

例如，患者可能有许多护士和医生在他身上工作，因此将患者与 PERSON 表中的其他人联系起来的多对多表很好地促进了这一点。在这张表中应该有一些关于这些人之间关系的描述，这使我们回到了人的类别。

由于医生和患者可以在他们自己的表中创建相同的主键 ID，因此拥有全局唯一 ID 或对象 ID 非常有用。

按照建议执行此操作的一个好方法是指定一个表来自动递增主键。首先对该表执行插入以获取 OID，然后将其用于新的 PERSON。

我喜欢更进一步。当事情变得丑陋时（一些新开发人员掌握了数据库，或者更糟糕的是，一个非常老的开发人员，那么为 OID 添加更多含义非常有用。

通常这是以编程方式完成的，而不是使用数据库引擎，但是如果您对所有主键 ID 使用 BIG INT，那么您有很大的空间来为带有视觉可识别序列的数字添加前缀。例如，所有医生 ID 可以以 100 开头，所有患者以 110 开头，所有护士以 120 开头。

为此，我会附加一个 Julian 日期或 Unix 日期+时间，最后附加自动增量 ID。

这将产生如下数字：

```
110,2455892,00000001
120,2455892,00000002
100,2455892,00000003 
```

由于儒略日期 100 年后只有 2492087，因此您可以看到 7 位数字足以存储此值。

BIGINT 是 64 位（8 字节）有符号整数，范围为 -9.22x10^18 到 9.22x10^18（-2^63 到 2^63 -1）。请注意，指数是 18。这是您必须使用的 18 位数字。

使用这种设计，您将被限制为 1 亿个 OID、999 个类别的人和日期……远远超过了数据库的保质期，但我怀疑这对于大多数解决方案来说已经足够了。

像这样创建 OID 所需的操作都是乘除法，避免了文本操作的所有齿轮磨削。

缺点是 INSERT 需要的不仅仅是一个简单的 TSQL 语句，但优点是当您跟踪错误数据甚至在查询中聪明时，您的 OID 在视觉上告诉您的不仅仅是随机数或更糟，令人眼花缭乱像 GUID。

# asp.net - 网页设计师

> ID：294938
> 
> 赞同：0
> 
> 时间：2008-11-17T05:22:42.137
> 
> 标签：asp.net, html, visual-studio-2008, designer

是否有任何网页设计软件可以让我像桌面应用程序一样拖放控件。我发现使用 Visual Studio 2008 中的设计器设计网页非常困难，因为它将我限制在流或网格布局中。（我不是一个有成就的设计师，但在设计桌面应用程序时应该有一些轻松的体验）。

提前谢谢。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2008-11-17T06:50:01.553

使用 Dreamweaver 并将其传输到 Visual Studio 应该没有问题。

毕竟，他们都吐出了 HTML 和 CSS。

但是请注意，如果您决定跳入标记，它们吐出的 HTML 和 CSS 非常臃肿并且是维护的噩梦。

您可能还想查看已经存在的 CSS 网格布局，例如[Blueprint](http://www.blueprintcss.org/)、[960 Grid 系统](http://960.gs/)和[Yahoo Grids CSS](http://developer.yahoo.com/yui/grids/)，并尝试将它们与 Dreamweaver/VS 集成。Yahoo Grids CSS 甚至有一个工具可以让您从头开始构建网格。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2008-11-17T06:58:50.617

Dreamweaver 允许您将元素移动到页面的任何部分，而不受限制。当您在页面中拖动元素时，它会自动创建用于绝对定位和自定义坐标的 CSS 代码。

如果您已经在使用 Visual Studio，您可以为元素定义 CSS 样式，然后为其提供绝对定位和自定义坐标（例如，定位：位置：绝对；左侧：100 像素；顶部：100 像素）。完成此操作后，Visual Studio 允许您在其设计模式下在页面周围拖动元素，而不是将元素限制为紧贴页面的左侧。

我希望这会有所帮助。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2008-11-17T05:28:45.523

您在寻找[Dreamweaver 之类的东西吗？](http://www.adobe.com/products/dreamweaver/)

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2008-11-17T06:09:45.910

也许[KompoZer](http://www.kompozer.net/ "KompoZer - 轻松的网络创作")，至少对于总体布局。

# c# - 环境常数

> ID：294939
> 
> 赞同：17
> 
> 时间：2008-11-17T05:23:12.477
> 
> 标签：c#, constants, environment

在 DotNet 中是否有与 Environment.NewLine 等效的 Tab 字符？

* * *

## 回答 #1

> 赞同：25
> 
> 时间：2008-11-17T05:27:13.203

NewLine 位于 Environment 类上，因为新线路规范因平台而异：

对于非 Unix 平台是“\r\n”，对于 Unix 平台是“\n”。但是选项卡始终是“\t”。

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2008-11-17T05:27:27.213

简短的回答是：不，选项卡不会像换行符那样在平台之间更改，因此不需要一个。

长答案是：从技术上讲，是的，您可以使用 VB 在 Microsoft.VisualBasic.dll 中提供的那个。我认为它是 Microsoft.VisualBasic.Constants.vbTab，但正如我上面所说，没有充分的理由在 C# 中使用它。

# php - JavaScript（或 JS+PHP）终端客户端

> ID：294945
> 
> 赞同：5
> 
> 时间：2008-11-17T05:27:18.977
> 
> 标签：php, javascript, ssh, terminal

有人知道基于 JS 的终端客户端吗？可以启动与远程主机的 SSH 连接，甚至可以简单地与远程 PHP 脚本通信以执行命令和检索输出。这样的事情存在吗？

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2008-11-17T05:36:17.210

检查[Anyterm](http://anyterm.org/)，它使用 XmlHttpRequest 通道与使用伪终端与 shell 或其他应用程序通信的守护进程通信。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2010-12-13T23:08:51.007

[http://www.masswerk.at/termlib/](http://www.masswerk.at/termlib/)作为基础看起来很有趣。

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2012-08-29T22:33:02.820

[http://sourceforge.net/projects/jsterminal](http://sourceforge.net/projects/jsterminal)

但是您必须编写自己的命令才能与主机连接

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2011-05-17T16:38:13.133

盒装外壳也可以与小型华硕 EEE-PC 一起使用：

[http://code.google.com/p/shellinabox/](http://code.google.com/p/shellinabox/)

它也适用于云中的虚拟机。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2008-11-17T05:31:01.027

到目前为止，[JSDom Shell](http://www.webessence.nl/projects/jsdom.ui.console/index.html)是我发现的唯一东西，它看起来相对准系统但很实用。如果还有其他更实质性的选择，请随时分享！

# ado - 如何从 ADO 创建一个空的 MDB

> ID：294949
> 
> 赞同：2
> 
> 时间：2008-11-17T05:30:02.620
> 
> 标签：ado

我需要创建一个空的 .mdb 文件，以便我可以在其上运行 ADO 命令（*不是*ADO.NET）。有没有办法使用 ADO 创建一个空的 mdb？

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2008-11-17T05:39:39.370

以下是一些有效的代码片段：

```
 string sADOProvider = "Provider=Microsoft.Jet.OLEDB.4.0;Data Source=";

        ADOX.CatalogClass cat = new ADOX.CatalogClass();

        string sCreate = MainForm.sADOProvider + sFullPath;

        cat.Create(sCreate);

        // The point of this code is to unlock the access file after we
        // create it.   You can tell it is unlocked if the .ldb file disappears.
        System.Runtime.InteropServices.Marshal.ReleaseComObject(cat);
        cat = null;
        GC.Collect(); 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2008-11-17T05:57:40.693

不确定是否直接通过 ADO 创建它，但如果计算机上安装了 Access，您可以使用 Access 通过 COM 创建文件。

下面是一个早期和晚期绑定的例子。两种方法都有其优点/缺点。

```
Option Explicit

Sub CreateMDBEarlyBound()
  '' Remember to set your reference to "Microsoft Access XX.0 Object Library"
  Dim acApp As Access.Application

  Set acApp = New Access.Application
  acApp.NewCurrentDatabase ("c:\temp\MyDB-early.mdb")

  Set acApp = Nothing

End Sub

Sub CreateMDBLateBound()

  Dim acApp As Object

  On Error Resume Next
    Set acApp = GetObject(, "Access.Application")
  On Error GoTo 0 '' turn off the resume next

  If acApp Is Nothing Then
    Set acApp = CreateObject("Access.Application")
  End If

  acApp.NewCurrentDatabase "c:\temp\MyDB-late.mdb"
  Set acApp = Nothing

End Sub 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-01-08T12:32:58.623

如果“不是 ADO.NET”意味着“不是 .NET”，这里是 Corey Trager 的代码重写为 VBA：

```
 Const sADOProvider As String = "Provider=Microsoft.Jet.OLEDB.4.0;Data Source="

  Const sFullPath As String = "C:\DeleteMe.mdb"

  Dim cat As ADOX.Catalog
  Set cat = New ADOX.Catalog

  Dim sCreate As String
  sCreate = sADOProvider & sFullPath

  cat.Create sCreate

  ' The point of this code is to unlock the access file after we
  ' create it.   You can tell it is unlocked if the .ldb file disappears.
  Set cat.ActiveConnection = Nothing 
```

# python - Pycurl WRITEDATA WRITEFUNCTION 碰撞/崩溃

> ID：294960
> 
> 赞同：0
> 
> 时间：2008-11-17T05:42:14.873
> 
> 标签：python, crash, libcurl, pycurl

如何关闭 WRITEFUNCTION 和 WRITEDATA？

使用 pycurl 我有一个类调用 curlUtil。在其中我有 pageAsString (self, URL) ，它返回一个字符串。

为此，我设置了 WRITEFUNCTION。现在在 downloadFile (self, URL, fn, overwrite=0) 我做了一个 open 和 self.c.Setopt (pycurl.WRITEFUNCTION, 0) 这会导致问题。Int 不是一个有效的参数。

然后我假设 WRITEDATA 会覆盖该值，否则会有一个 NOWRITEFUNCTION 推荐。NOWRITEFUNCTION 不存在，所以我只使用了 WRITEDATA 并且 Python 崩溃了。

我编写了一个名为 reboot() 的快速函数，它关闭 curl，再次打开它，然后调用 reset 将其置于默认状态。我在 pageAsString 和 downloadFile 中都调用它，完全没有问题。但是，我不想重新初始化 curl。我可能设置了一些特殊选项。

如何关闭 WRITEFUNCTION 和 WRITEDATA？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2008-11-17T23:28:53.957

使用 writefunction，而不是关闭它会为你省去很多麻烦。您可能想通过使用 WRITEFUNCTION 重写您的 pageAsString..

举个例子：

```
from cStringIO import StringIO
c = pycurl.Curl()
buffer = StringIO()
c.setopt(pycurl.WRITEFUNCTION, buffer.write)
c.setopt(pycurl.URL, "http://example.com")
c.perform()
...
buffer.getvalue() # will return the data fetched. 
```

# windows-installer - 链接 msi/Bootstrapper/先决条件？

> ID：294961
> 
> 赞同：9
> 
> 时间：2008-11-17T05:42:14.967
> 
> 标签：windows-installer, installshield, bootstrapper, prerequisites, chained

我有一些组件 MSI 包需要一起安装以形成最终应用程序。

问题是：可以更新组成包的组件，并且可以在 http 文件服务器上重新启动该组件。我应该采取什么方法？

我正在编写的安装程序是“主”安装程序。它需要能够读取其客户端计算机上安装的每个组件的版本，以便仅在该一个组件上执行升级。

此外，如果第一次安装应用程序，安装程序将下载并安装所有必需的组件。

我正在使用 Installshield 2009。

我已经查看了链接的 MSI，但主安装程序是空的。因为它需要尽可能轻巧。

我不知道如何编写引导程序应用程序，我的公司更喜欢我使用 installshield 来编写安装程序。

我已经研究过 - 显然先决条件并不意味着要卸载。

* * *

我相信我可以通过更改版本号来进行小更新，从而允许下载仅下载它需要的组件而不下载整个安装程序 - 目前我正在实施您建议的方式（sascha），我的公司将正在使用通过 InstallShield 提供的 FLEXnet 连接服务。我提到的“组件”（我们的开发人员喜欢使用的一个术语）在概念上类似于 InstallShield 的组件概念。但是，我已经修改了要由功能封装的“组件”，这样在构建版本时，我可以选择将每个“功能”包装在 cab 文件中。

这听起来很令人困惑——即使对我来说也是如此。

我已经诉诸功能<组件（包括服务）

我的公司拒绝让我使用除 Installshield 之外的任何其他安装程序。我的猜测是，为了在遥远的将来更新先决条件要求，需要编写一个新的安装程序，并将应用程序作为主要升级重新发布。这对我来说很有意义。

Perermtate，我认为没有办法卸载预先安装的先决条件，这是有道理的，因为可能需要先决条件作为其他应用程序的平台，毕竟“先决条件”是应用程序的第 3 方组件.

感谢您的所有回复！

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2008-11-18T01:27:42.437

我研究过类似的问题，我对此表示同情，因为我知道没有简单的答案。如果我理解正确，您基本上需要一个 setup.exe 来检测目标系统上先决条件的当前版本，如果它们丢失则安装它们，如果它们过时则升级它们。

我过去使用的几个选项是：

1.  微软的[通用 Boostrapper](http://msdn.microsoft.com/en-us/library/ms165429.aspx)。这个我以前用过，挺喜欢的。缺点是，如果您的先决条件不是预定义的条件之一，则必须编写自己的 boostrapper 清单。编写清单可能有点棘手且耗时，尽管有一个[工具](http://code.msdn.microsoft.com/bmg)可以提供帮助。此外，如果 msi 无法进行升级（我遇到的其他问题），我无法找到卸载已安装组件的方法。如果你弄清楚了，请告诉我！

2.  编写自己的助推器/链接器。我从[Microsoft .NET Framework Setup.exe Bootstrapper Sample](http://www.microsoft.com/DOWNLOADS/details.aspx?familyid=BF253CFD-1EFC-4FC5-BA7E-6A6F21403495&displaylang=en)开始。它附带源代码，因此您可以灵活地部署组件。然而，这里的代码是 C++，检查先决条件和发出正确的安装命令的逻辑很棘手，而且很难做到正确。

更新：当我写这篇文章时（2009 年 8 月），它还没有准备好，但是 Wix 项目正在开发它自己的引导程序/chaniner，称为[Burn](http://robmensching.com/blog/posts/2009/7/14/Lets-talk-about-Burn)，对于我们这些喜欢 Wix 的人来说，它看起来很有希望。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-02-19T17:42:39.313

由于您的“主”安装程序是空的并且没有真正安装它自己的任何东西，您可以使用 InstallScript 项目（而不是基于 MSI 的项目），将安装脚本用作“引导程序”。如果您使用 InstallScript，您甚至无需担心设置运行代码的环境，因为它将由 InstallShield 自动配置；如果您使用 .NET 作为引导程序，您将需要 .NET 或将其作为安装的一部分进行安装。

由于 InstallScript 项目不使用 MSI，因此您不必担心在安装的安装执行序列期间运行其他 MSI。您可以使用 InstallScript“LaunchAppAndWait”函数调用需要安装/更新的组件的安装。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2010-06-08T01:57:55.807

[http://dotnetinstaller.codeplex.com](http://dotnetinstaller.codeplex.com)将完成这项工作。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2008-11-18T00:48:28.383

您所说的“组件”是指 Installshield/MSI 组件/功能吗？还是您在自己的术语中使用它？据我所知，如果不发布全新的软件包版本，您将无法更新组件。

我的建议是部署一个带有*未压缩*文件（或每个组件一个 CAB）的“网络下载器”安装程序，然后您的有效负载将是 300kb，并且只有用户选择的功能才会从网上下载。

# python - 如何在 Python 中计算字节码，以便可以适当地修改 sys.setcheckinterval

> ID：294963
> 
> 赞同：1
> 
> 时间：2008-11-17T05:44:44.040
> 
> 标签：python, performance, multithreading, internals

我有一个使用工作队列和线程的端口扫描应用程序。

它使用简单的 TCP 连接并花费大量时间等待数据包返回（最多半秒）。因此线程不需要完全执行（即前半部分发送一个数据包，上下文切换，做一些事情，回到有网络数据等待它的线程）。

我怀疑我可以通过修改默认值 100 来提高性能`sys.setcheckinterval`（在切换到另一个线程之前最多可以执行 100 个字节码）。

但是在不知道线程或函数中实际执行了多少字节码的情况下，我盲目地猜测值，测试和依赖测试显示出可测量的差异（这很困难，因为正在执行的代码量很少；一个简单的socket 连接，因此网络抖动可能会影响任何测量，而不是更改 sys.setcheckinterval）。

因此，我想找出某些代码执行中有多少字节码（即一个函数或线程执行的总数），以便我可以更明智地猜测将 sys.setcheckinterval 设置为什么。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2008-11-17T05:50:00.567

对于更高级别（方法，类）的明智，[dis 模块](http://www.python.org/doc/2.5.2/lib/module-dis.html)应该有所帮助。

但如果需要更细的粒度，[追踪](http://www.python.org/doc/2.5.2/lib/debugger-hooks.html)将是不可避免的。跟踪确实逐行运行，但[这里解释](http://nedbatchelder.com/blog/200804/wicked_hack_python_bytecode_tracing.html)的是在字节码级别深入研究的一个很好的技巧。向 Ned Batchelder 致敬。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2008-11-18T03:05:53.283

对如此复杂的系统进行推理很少会产生正确的答案。测量结果，并使用运行最快的设置。如果如您所说，测试无法测量 setcheckinterval 的各种设置的差异，那为什么还要更改它呢？只有可测量的差异才是有趣的。如果您的测试运行时间太短而无法提供有意义的数据，那么请延长运行时间，直到它提供。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2008-11-17T12:37:11.073

“我怀疑我可以通过修改 sys.setcheckinterval 来提高性能”

这很少奏效。正确的行为不能依赖于时间——你无法控制时间。操作系统、硬件、Python 的补丁级别或月相的细微变化将改变您的应用程序的行为方式。

选择模块是[用来](http://www.python.org/doc/2.5.2/lib/module-select.html)等待 I/O 的。您的应用程序可以构造为一个主循环，为其他线程执行选择和[排队](http://www.python.org/doc/2.5.2/lib/module-Queue.html)工作。其他线程正在等待其处理请求队列中的条目。

# database - 真实世界的 MySQL/Postgres 数据库模式示例和分析工具

> ID：294965
> 
> 赞同：2
> 
> 时间：2008-11-17T05:45:40.047
> 
> 标签：database, schema, analysis, relational

我正在对模式演变进行分析，但实际上并没有真正实现一些演变并存储在版本控制中的真实世界数据库模式。到目前为止， Mediawiki（[http://svn.wikimedia.org/svnroot/mediawiki/trunk/phase3/maintenance/tables.sql](http://svn.wikimedia.org/svnroot/mediawiki/trunk/phase3/maintenance/tables.sql)）似乎是一个非常好的候选者。我考虑过Bugzilla，但它们似乎没有像Mediawiki 那样的主干中的.sql 文件。必须执行构建数据库架构/表的 Perl 脚本 - 因此，我现在基本上必须下载整个 Bugzilla 文件夹以进行不同的修订，以了解架构更改，而不是像在 mediawiki(tables.sql) 中那样只获取一个文件。

**问题 1：** 我想知道你们中是否有人知道或使用过大型数据库模式，这些模式是开源的，处于修订控制之下，并且更改大到足以进行模式演化分析（最好有 DDL 脚本 - .sql 文件）。

**问题 2：** 此外，您是否遇到过任何可以对 .sql 文件（DDL 脚本）提供分析（表/列数、修订之间的补丁等）的工具。我发现的所有工具都需要在对它们进行任何分析之前将 .sql 文件加载到数据库中。

对于这两个问题，首选 MySQL 或 Postgres 作为数据库。

我感谢这个社区的其他成员的任何回应。

谢谢，

文卡特什曼陀罗巴

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2009-03-05T22:21:06.963

[http://www.databaseanswers.org/](http://www.databaseanswers.org/) - 包含许多数据库模式示例。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-10-23T15:34:59.357

查看我们在[http://schemaevolution.org](http://schemaevolution.org)上的工作，在 UCLA 进行了一些关于模式演化的有趣研究，我们发布了预先收集的模式演化历史（来自 mediawiki、Ensembl Genetic DB 和其他几个），我们提供了统计分析在这些情况下，还有一个工具可用于自动收集和分析模式演变历史的过程。

再见，

## 卡罗

Carlo A. Curino 博士

## 麻省理工学院-CSAIL

我存在的祸根是做事

## 我知道电脑可以为我做。

# sql - SQL：一个外键引用几个表之一中的主键

> ID：294969
> 
> 赞同：0
> 
> 时间：2008-11-17T05:50:12.597
> 
> 标签：sql, database, foreign-keys, relationship

我正在开发一个将用作其他应用程序的可扩展框架的应用程序。

基本类之一称为节点，节点具有内容。SQL 表如下所示：

表节点（NodeId int，....等）

表 NodeContentRelationship（NodeId int、ContentType 字符串、ContentId int）

这将取决于扩展应用程序以创建自己的内容类型的开发人员。

显然，从关系数据库的角度来看，这是不好的，因为无法将外键关系添加到 NodeContentRelationship.ContentId，即使它*是*外键列。

但是，该解决方案非常简单且功能强大，因此我不愿意更改它。

你怎么看 - 我会在赛道上陷入痛苦的世界吗？

* * *

## 回答 #1

> 赞同：8
> 
> 时间：2008-11-17T06:14:09.630

当心[内部平台效应](http://thedailywtf.com/Articles/The_Inner-Platform_Effect.aspx)。

如果您正在尝试构建一个“可扩展框架”，允许开发人员存储不同“内容类型”的数据并以通用方式将它们相互关联，您可能会发现其他人已经[解决](http://www.microsoft.com/sqlserver/2008/en/us/default.aspx) [了这个](http://www.oracle.com/index.html) [问题](http://www.mysql.com/)。

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2008-11-17T06:14:57.880

为什么不能设置`NoteContentRelationship.ContentId`为外键？您可以轻松地将关系继承模型与`Content`表示抽象基类的表和表示派生类的各种表等`AnimalContent`一起使用。`CarContent`

* * *

## 回答 #3

> 赞同：3
> 
> 时间：2008-11-17T15:12:39.247

在我看来，这就像 EAV（实体、属性、值）设计的变体。

EAV 设计的优点和缺点已被广泛记录。

以下是从同情的角度对 EAV 的描述：

[http://ycmi.med.yale.edu/nadkarni/Introduction%20to%20EAV%20systems.htm](http://ycmi.med.yale.edu/nadkarni/Introduction%20to%20EAV%20systems.htm)

这是一个从敌对的角度来看的：

[http://tonyandrews.blogspot.com/2004/10/otlt-and-eav-two-big-design-mistakes.html](http://tonyandrews.blogspot.com/2004/10/otlt-and-eav-two-big-design-mistakes.html)

在投入数千个工时将数据注入其中之前，请注意 EAV 的缺点。它对程序员来说极具诱惑力，但它可能成为数据管理员的噩梦。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2008-11-17T15:46:35.683

如果您想实际报告这些数据，那么您将面临一个痛苦的世界。你只是让编写连接等变得更加困难。缺乏约束是不好的，但查询所需的额外工作（恕我直言）更糟。

但是，如果您希望其他开发人员能够扩展系统并将数据存储在数据库中但不能更改数据库模式，则可能没有选择。在这种情况下，答案是尽量减少以这种方式存储的数量。您还可以通过将 ContentType 替换为另一个表中定义的 ContentTypeId 来稍微加快速度。

# php - 如何压缩我的网络文件

> ID：294976
> 
> 赞同：10
> 
> 时间：2008-11-17T05:58:35.480
> 
> 标签：php, .htaccess

按照 Yahoo! 的规定，gzip'ng 文件会使您的网站加载速度更快。问题？我不知道怎么做：p

* * *

## 回答 #1

> 赞同：8
> 
> 时间：2008-11-17T06:02:35.177

[http://www.webcodingtech.com/php/gzip-compression.php](http://www.webcodingtech.com/php/gzip-compression.php)

或者，如果您有 Apache，请尝试[http://www.askapache.com/htaccess/apache-speed-compression.html](http://www.askapache.com/htaccess/apache-speed-compression.html)

一些托管服务在控制面板中有一个选项。但是，这并不总是可能的，因此，如果您遇到困难，请回复有关您平台的更多详细信息。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2008-11-17T06:17:15.067

如果您正在运行 Java Tomcat，那么您可以在连接器上设置一些属性（在 conf/server.xml 中）。

具体来说，您设置：

1.  compressableMimeType（要压缩的类型）
2.  压缩（关|开|）
3.  noCompressionUserAgents（如果您不希望某些代理接收 gzip，请在此处列出）

这是讨论这个的tomcat文档：http: [//tomcat.apache.org/tomcat-5.5-doc/config/http.html](http://tomcat.apache.org/tomcat-5.5-doc/config/http.html)

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2008-11-17T07:24:17.680

编辑您的 httpd.conf 文件。

添加此行以加载模块：

```
LoadModule deflate_module modules/mod_deflate.so 
```

添加这些行以实际压缩输出：

```
AddOutputFilterByType DEFLATE text/css text/html application/x-javascript application/javascript
BrowserMatch ^Mozilla/4 gzip-only-text/html
BrowserMatch ^Mozilla/4\.0[678] no-gzip
BrowserMatch \bMSIE !no-gzip !gzip-only-text/html 
```

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2009-08-18T16:19:03.410

Jetty 将寻找 gzip 版本的静态文件，并且它具有用于动态内容的 GzipFilter。

如果您想对压缩进行更多控制，而不仅仅是 Tomcat 的连接器级压缩，则可以将 GzipFilter 拉到 Tomcat 中...

[http://docs.codehaus.org/display/JETTY/GZIP+Compression](http://docs.codehaus.org/display/JETTY/GZIP+Compression)

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2013-08-28T09:55:38.337

Gzip 在将您的网页和级联样式表发送到客户端浏览器之前对其进行压缩。

这大大减少了传输时间，因为文件要小得多。

根据您是否拥有 IIS 或 Apache 服务器，可以使用不同的方法设置 gzip 压缩

示例：此[链接](http://www.nicom.ir)。

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2008-11-17T06:58:13.830

[http://developer.yahoo.com/performance/rules.html#gzip](http://developer.yahoo.com/performance/rules.html#gzip)

如果有人问我关于加载 gzip 文件的参考，这是参考

* * *

## 回答 #7

> 赞同：0
> 
> 时间：2008-11-17T07:57:41.683

如果您使用的是 Lighttpd，则有[mod_compress](http://redmine.lighttpd.net/wiki/lighttpd/Docs:ModCompress)。

* * *

## 回答 #8

> 赞同：0
> 
> 时间：2012-10-24T17:22:06.567

看到这里的大多数答案已经有将近 5 年的历史了，这里有一些非常最新的示例参考。

例如，为 、 、 启用 gzip/deflate 类型压缩的服务器配置，`iis`甚至`lighthttpd`参见`nginx`：`node`https: [//github.com/h5bp/server-configs](https://github.com/h5bp/server-configs)

有关当前非常好的实现，`Apache mod_deflate`请参见 [https://github.com/h5bp/html5-boilerplate/blob/master/.htaccess#L156](https://github.com/h5bp/html5-boilerplate/blob/master/.htaccess#L156)

* * *

## 回答 #9

> 赞同：0
> 
> 时间：2014-05-26T08:51:04.440

Gzip 压缩您的网页和级联样式表，然后将它们发送到客户端浏览器其他示例此[链接](http://maskanha.com)

# java - 如何在 JasperReports 中使用 printWhenExpression

> ID：294989
> 
> 赞同：16
> 
> 时间：2008-11-17T06:10:27.173
> 
> 标签：java, jasper-reports

有人可以告诉我如何使用*`printWhenExpression`*JasperReports 吗？

* * *

## 回答 #1

> 赞同：21
> 
> 时间：2008-11-17T06:16:18.750

你有相对于 boolean 的错误吗？

因为您需要使用 Boolean 而不是原始类型。

所以：

```
$F{mesure} != "PH"
($F{userfd4}).equals("1") ? true : false 
```

会给`cannot cast from boolean to Boolean`。

```
( $F{mesure}.startsWith("PH") ? Boolean.TRUE:Boolean.FALSE ) 
($F{userfd4}).equals("1") ? Boolean.TRUE : Boolean.FALSE 
```

会是正确的。

另请参阅此[示例](http://jasperforge.org/plugins/espforum/view.php?group_id=83&forumid=101&topicid=47713)

* * *

2015 年 11 月更新（7 年后）

[Petter Friberg](https://stackoverflow.com/users/5292302/petter-friberg)[在评论中](https://stackoverflow.com/questions/294989/how-to-use-printwhenexpression-in-jasperreports/294999?noredirect=1#comment55033358_294999)指出：

> 在[jasper 报告](https://en.wikipedia.org/wiki/JasperReports)6.0 中，这不是必需的：
> 您可以返回其中一个`boolean`或`Boolean`一个简单的表达式，如`$F{fieldName}.equals("hello")`将起作用。

* * *

您可以在中查看该命令的演示[`demo/samples/tableofcontents/reports/TocPart.jrxml`](https://github.com/TIBCOSoftware/jasperreports/blob/89055a52f85c589ff08f0a72d0108ecf17a388e6/jasperreports/demo/samples/tableofcontents/reports/TocPart.jrxml#L61-L68)

```
<reportElement style="Sans_Bold" positionType="Float" x="50" y="0" width="100" height="15" isRemoveLineWhenBlank="true" uuid="db8b68c6-4430-4199-8967-3ab5c077cb56">
    <property name="local_mesure_unitx" value="pixel"/>
    <property name="com.jaspersoft.studio.unit.x" value="px"/>
    <printWhenExpression><![CDATA[$F{level} == 1]]></printWhenExpression>
</reportElement> 
```

* * *

## 回答 #2

> 赞同：5
> 
> 时间：2008-11-19T15:02:22.777

另一张海报很好地解释了如何使用它的技术细节，所以我将尝试解释人们可能会发现它有用的情况。

基本上，它允许您根据布尔表达式显示或隐藏单元格的内容。例如，您可能希望仅在该人超过 18 岁时才显示该人的姓名，然后在姓名字段中使用 printwhen 表达式，例如：

```
$F{age} >= 18 
```

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2009-02-12T15:41:55.533

You can also use the static method "Boolean.valueOf(boolean b)". It does exactly the same logic as "($F{mesure}.startsWith("PH") ? Boolean.TRUE:Boolean.FALSE)" and good rule of thumb is don't recreate the wheel.

> Boolean.valueOf($F{mesure}.startsWith("PH"))
> 
> Boolean.valueOf($F{userfd4}).equals("1"))

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2013-07-12T12:56:14.187

$P{mesure}.equals("200") 应该可以在没有任何额外细节的情况下工作。如果条件为真，它将打印

# logging - 使用 Stomp 和 Apache ActiveMQ 作为可靠的系统日志

> ID：294990
> 
> 赞同：3
> 
> 时间：2008-11-17T06:12:53.937
> 
> 标签：logging, messaging, activemq, syslog

我的一个程序需要一种可靠的方式来登录不可靠的网络（即互联网）。发送方或接收方可能随时下线，稍后再回来。但是不应错过客户端发送的任何消息。显然 syslog 不符合要求。我正在探索使用像 Apache ActiveMQ 这样的消息服务器而不是 syslog。消息发送者使用 perl、ruby 和 c。所以我有 Stomp 作为消息传输。

这符合我的目的吗？我在这里缺少什么陷阱吗？

拉吉

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2008-11-17T12:34:48.643

这一切对我来说都很好

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2008-11-18T22:54:48.767

您可能想查看具有 tcp 模式的[syslog-ng 。](http://www.balabit.com/network-security/syslog-ng/)这可以实现可靠的交付，但您必须确保正确配置它。***********