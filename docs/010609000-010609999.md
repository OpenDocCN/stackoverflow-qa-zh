# StackOverflow 问答 10609000-10609999

# c# - TYPE_E_CANTLOADLIBRARY - 通过 MTA 线程的 COM 互操作

> ID：10609000
> 
> 赞同：2
> 
> 时间：2012-05-15T21:17:42.183
> 
> 标签：c#, com-interop

我有一个简单的以 x86 为目标的 .NET 3.5 控制台程序，它通过互操作调用 ActiveX DLL 中的 COM 对象上的方法。在我的注册表中，ActiveX DLL 有一个 Apartment 的 ThreadingModel。当 .NET 程序在 STA 线程中运行时，一切正常。在 MTA 线程中，一些 COM 方法运行良好，其他的给我：

System.InvalidCastException：无法将“MyComTypeClass”类型的 COM 对象转换为接口类型“_MyComType”。此操作失败，因为 IID 为“{[省略]}”的接口的 COM 组件上的 QueryInterface 调用失败，原因是以下错误：加载类型库/DLL 时出错。（来自 HRESULT 的异常：0x80029C4A (TYPE_E_CANTLOADLIBRARY)）。

如果我将 ActiveX DLL 的 ThreadingModel 切换为 Free 或 Both，.NET 程序在 MTA 线程中工作，但我想将 ThreadingModel 保留在 Apartment。

具有相同 ActiveX DLL 和互操作程序集的相同 .NET 程序在使用这两种线程模型的多台其他计算机（WinXP 32 位、Win7 64）上运行良好。该异常仅发生在一台 PC (Win7 64) 上，并且仅发生在 MTA 线程中。有谁知道为什么？

在没有解决方案的情况下提出了类似的问题，希望第三次是一个魅力：

[COM 异常 - TYPE_E_CANTLOADLIBRARY？](https://stackoverflow.com/questions/5705613/com-exception-type-e-cantloadlibrary)

[TYPE_E_CANTLOADLIBRARY 仅在 Windows 2003 x64 上的单独线程上使用 COM 对象时](https://stackoverflow.com/questions/2203585/type-e-cantloadlibrary-when-using-a-com-object-on-a-separate-thread-on-windows-2)

谢谢！

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-05-15T21:44:08.767

使用 MTA 线程中的 STA 对象需要编组。标准编组需要类型库。您收到的错误意味着无法加载类型库。

所以我猜想类型库没有正确注册。尝试注销并重新注册 DLL，否则尝试使用 REGTLB.exe 直接注册类型库

# css - 定义 CSS @Font-Face 粗斜体

> ID：10609002
> 
> 赞同：2
> 
> 时间：2012-05-15T21:18:05.030
> 
> 标签：css, font-face, typography

我正在做一个项目，我正在使用六种字体的权重/样式。这些包括：常规、斜体、半粗体、半粗斜体、粗体和粗斜体。我有@font-face 标签设置（理论上）它们应该显示的方式。然而在现实中发生的是粗体总是斜体。无论如何要声明这些粗体+斜体重量，以便它们正常工作？我不想到处称呼不同的字体系列名称。理想情况下，我应该能够声明正确的重量和样式并获得正确的字体版本。

```
@font-face {
    font-family: 'AdobeGaramondPro';
    src: url('agaramondpro-bold-webfont.eot');
    src: url('agaramondpro-bold-webfont.eot?#iefix') format('embedded-opentype'),
         url('agaramondpro-bold-webfont.woff') format('woff'),
         url('agaramondpro-bold-webfont.ttf') format('truetype');
    font-weight: bold;
    font-style: normal;
    }

    @font-face {
    font-family: 'AdobeGaramondPro';
    src: url('agaramondpro-bolditalic-webfont.eot');
    src: url('agaramondpro-bolditalic-webfont.eot?#iefix') format('embedded-opentype'),
         url('agaramondpro-bolditalic-webfont.woff') format('woff'),
         url('agaramondpro-bolditalic-webfont.ttf') format('truetype');
    font-weight: bold;
    font-style: italic, oblique;
    }

    @font-face {
    font-family: 'AdobeGaramondPro';
    src: url('agaramondpro-italic-webfont.eot');
    src: url('agaramondpro-italic-webfont.eot?#iefix') format('embedded-opentype'),
         url('agaramondpro-italic-webfont.woff') format('woff'),
         url('agaramondpro-italic-webfont.ttf') format('truetype');
    font-weight: normal;
    font-style: italic, oblique;
    }

    @font-face {
    font-family: 'AdobeGaramondPro';
    src: url('agaramondpro-regular-webfont.eot');
    src: url('agaramondpro-regular-webfont.eot?#iefix') format('embedded-opentype'),
         url('agaramondpro-regular-webfont.woff') format('woff'),
         url('agaramondpro-regular-webfont.ttf') format('truetype');
    font-weight: normal;
    font-style: normal;
    }

    @font-face {
    font-family: 'AdobeGaramondPro';
    src: url('agaramondpro-semibold-webfont.eot');
    src: url('agaramondpro-semibold-webfont.eot?#iefix') format('embedded-opentype'),
         url('agaramondpro-semibold-webfont.woff') format('woff'),
         url('agaramondpro-semibold-webfont.ttf') format('truetype');
    font-weight: 600;
    font-style: normal;
    }

    @font-face {
    font-family: 'AdobeGaramondPro';
    src: url('agaramondpro-semibolditalic-webfont.eot');
    src: url('agaramondpro-semibolditalic-webfont.eot?#iefix') format('embedded-opentype'),
         url('agaramondpro-semibolditalic-webfont.woff') format('woff'),
         url('agaramondpro-semibolditalic-webfont.ttf') format('truetype');
    font-weight: 600;
    font-style: italic, oblique;
    } 
```

有什么想法可以让它发挥作用吗？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-05-16T09:20:20.093

这可能不是您正在寻找的技术答案，但是为什么您需要使用三个权重（reg、semi 和粗体，暂时不考虑斜体）？

您可能会发现这些权重之间的对比不足以保证在一页内使用所有三个权重。您想使用不同的字体权重在布局中创建不同的层次结构；两个权重，结合大小、大小写和颜色的变化就足够了。

具有多种粗细的字体可能包括以下字体：薄的; 光; 常规的; 中等的; 半粗体; 大胆的; 黑色的; 重（每个都有斜体版本）。该频谱的极端不应用于设置长文本块，而只能用于大显示尺寸或顶级标题。然后，您将在主体文本的 Light 和 Bold 位置之间选择两个权重，在大多数情况下，至少选择两个位置的权重 - Light 和 Medium，或 Regular 和 Bold - 以获得足够的对比度。过多的对比会破坏沉浸式阅读；例如，不要将 Light 与 Bold 配对。

如果您出于特殊目的需要额外的中间权重（例如，您可能在深色背景下设置了白色文本，因此半粗体会很好），那么您可以为偶尔使用创建一个单独的类，而 style - 正常链接字体系列声明中的四个常规粗细和斜体。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-05-15T21:22:25.860

您可以使用类似这样的方法来声明带有 paragraf 类的字体：

```
p.normal {font-style:normal}
p.italic {font-style:italic}
p.oblique {font-style:oblique} 
```

或类似的东西：

```
h1, h2, h3, h4, h5, #headline a {color: #FF9900} 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-08-02T15:52:37.193

我可能是错的，但我似乎记得读过，要让它与 IE8 一起工作，你必须在任何地方调用字体名称（这是你不想做的）。因此，在每个字体声明中，您必须声明“font-style:normal”以及 . 这非常烦人，好像无论出于何种原因，您都获得了“正常”样式的系统字体，即使是粗体和斜体字体也不起作用。对不起，我不记得我在哪里读到了！

# image-processing - 使用 D4 小波对图像进行离散小波变换

> ID：10609010
> 
> 赞同：0
> 
> 时间：2012-05-15T21:18:59.337
> 
> 标签：image-processing, wavelet, dwt

我正在尝试使用 D4 小波编写前向小波变换。输入数据是 24 位/像素的彩色 .bmp 图像。我采用的小波系数：

```
h0 = 0.48296
h1 = 0.83652
h2 = 0.22414
h3 = -0.12941

g0 = -0.12941
g1 = -0.22414
g2 = 0.83652
g3 = -0.48296 
```

问题是，在转换过程中，我得到的值大于 255 或小于 0。我应该怎么做才能保持在 [0,255] 范围内？

谢谢。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-05-18T10:01:15.540

小波变换的输出总是超出输入像素范围。包括 Intel 的[IPP](http://software.intel.com/en-us/articles/intel-ipp/)和[CUVILib](http://www.cuvilib.com/)在内的大多数图像处理库都将输出存储在 32 位浮点数中。因此，您也应该将输出存储在更大的容器中。但是在逆小波变换中，您始终可以将输出饱和到原始图像范围，在您的情况下为 [0,255]

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-04-05T11:56:44.783

您可以从您的滤波器系数中看到，您的小波变换中会有负值——在近似系数和细节系数中。

我可以想到一对小波，其中近似系数将是非负的（如果输入信号/图像是）：haar 小波，与

```
[h0 h1] = [1  1] / 2 
```

和

```
[g0 g1] = [1 -1] / 2 
```

通常，细节系数仍然部分为负，部分为正（您可能会发现单调递减的信号/图像，其中 g 始终为非负）。

# java - Play Framework：内部 Web 服务的密钥库

> ID：10609019
> 
> 赞同：4
> 
> 时间：2012-05-15T21:19:44.170
> 
> 标签：java, playframework, ssl-certificate

我们正在尝试让 Play 设置与我们的内部 CRM 对话。我们之前的所有应用程序都是在一个矫枉过正的 JSF 框架 (ICEfaces) 中编写的 - 但它们在与我们的 CRM 对话时工作良好，因为 JSF 应用程序部署在 glassfish 盒子上，我们安装了 glassfish 的证书以便能够与之通信我们的 CRM 网络服务。

现在我们正试图让 play 做同样的事情，但我们遇到了一些困难，因为我们想在 netty 上运行 play 应用程序。我们如何将证书导入密钥库（或类似的），以便它们可以与我们的 CRM 通信？由于 CRM 在我们公司内部，因此证书是自签名的并根据需要分发。

我在播放配置文件中尝试了以下内容 - 但我不确定这个，因为这些配置属性似乎更多地用于播放服务器本身，而不是用于播放应用程序与另一个服务通信。

```
# Keystore 
trustmanager.algorithm=jks
ssl.KeyManagerFactory.algorithm=SunX509
keystore.algorithm=jks
keystore.password=changeit
keystore.file=conf/cacerts.jks 
```

我们的其他开发人员之一能够让它工作，但我们必须将它直接放在我们的代码中，这并不理想。

```
System.setProperty("javax.net.ssl.trustStore", "C:/webapps/playapp1/cacerts.jks");
System.setProperty("javax.net.ssl.trustStorePassword", "changeit");
System.setProperty("javax.net.ssl.keyStoreType", "jks");
System.setProperty("javax.net.ssl.keyStore", "C:/webapps/playapp1/keystore.jks");
System.setProperty("javax.net.ssl.keyStorePassword", "changeit"); 
```

请注意，我们的 CRM 构建了一个 jar 文件，我们将其放入 JSF 或播放为我们包装 web 服务的应用程序，因此我们不必为每个服务构建客户端代码（类似于您下载的 jar，亚马逊的 S3 服务）。该服务 jar 在下面使用 Jersey 通过 XML / Rest 与我们的服务进行通信。当我们不使用 SSL 时，它在播放框架中工作得很好。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-05-20T22:35:33.073

你用的是什么版本的play？我知道我实际上必须重新编译 playframework，因为它禁用了安全支持。但我认为那是 1.1 版

# php - PHP MVC 会话

> ID：10609021
> 
> 赞同：0
> 
> 时间：2012-05-15T21:20:04.500
> 
> 标签：php, model-view-controller, session

我试图在 MVC 的模型中使用 $_session 变量来获取登录用户的分数和名称，然后通过数组将其发送到视图。

这是我的游戏模型。我将如何从视图中获取 SESSION 变量？当用户提交登录表单时，页面转到 login.php，它检查用户是否存在，如果存在则启动会话： $_SESSION['username']=$_POST["username"]; 如果我在 mySQL 查询中将用户名设置为“test”，它就可以工作。

```
public function game()
{
    include 'connect.php';

    //$query = "SELECT * FROM users WHERE USERNAME='"$this->$_SESSION["username"]."'";      
    $query = "SELECT * FROM users WHERE USERNAME='test'";

    $result = mysql_query($query) or die (mysql_error());
    $score = mysql_fetch_array($result) or die(mysql_error());

    $user = $score['username'];
    $s1 = $score['score1'];
    $s2 = $score['score2'];
    $s3 = $score['score3']; 

    //store values to array for view to see, extract() array so views can use 
    them as variables 
    $game_model = array('user' => $user, 's1' => $s1, 's2' => $s2, 's3' => $s3);
    return game $model;
} 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-05-15T21:23:14.287

您应该将它从控制器作为参数传递给函数。

```
public function game( $username ) 
```

# python - Python 2.6 抱怨缺少数学模块 - 在某些（其他）软件更新后我无法使用它。有小费吗？

> ID：10609025
> 
> 赞同：0
> 
> 时间：2012-05-15T21:20:34.280
> 
> 标签：python, macos, installation

我对 Python 比较陌生。这是我的问题：

我的环境是 python2.6 和 MacOs 10.6.8。我最近不得不用 Python2.7 和其他一些东西（Eclipse 3.6 和 GoogleAppEngine）更新我的系统。Python 在 Eclipse 中运行良好，但是，我希望保持 shell 模式能够在命令行上快速测试小东西。我收到此错误消息，我需要它尽快摆脱：

```
$ python
Python 2.7.3 (v2.7.3:70274d53c1dd, Apr  9 2012, 20:52:43) 
[GCC 4.2.1 (Apple Inc. build 5666) (dot 3)] on darwin
Type "help", "copyright", "credits" or "license" for more information.
>>> import urllib
>>> import urllib2
Traceback (most recent call last):
File "<stdin>", line 1, in <module>
File "/System/Library/Frameworks/Python.framework/Versions/2.6/lib/python2.6/urllib2.py",
line 92, in <module>
import httplib
File "/System/Library/Frameworks/Python.framework/Versions/2.6/lib/python2.6/httplib.py", 
line 77, in <module>
import mimetools
File "/System/Library/Frameworks/Python.framework/Versions/2.6/lib/python2.6/mimetools.py", 
line 6, in <module>
import tempfile
File "/System/Library/Frameworks/Python.framework/Versions/2.6/lib/python2.6/tempfile.py", 
line 34, in <module>
from random import Random as _Random
File "/System/Library/Frameworks/Python.framework/Versions/2.6/lib/python2.6/random.py", 
line 45, in <module>
from math import log as _log, exp as _exp, pi as _pi, e as _e, ceil as _ceil
ImportError: dlopen(/System/Library/Frameworks/Python.framework/Versions/2.6/lib/python2.6    
/lib-dynload/math.so, 2): Symbol not found: __PyLong_AsScaledDouble
Referenced from: /System/Library/Frameworks/Python.framework/Versions/2.6/lib/python2.6
/lib-dynload/math.so
Expected in: flat namespace
in /System/Library/Frameworks/Python.framework/Versions/2.6/lib/python2.6/lib-dynload/math.so 
```

无论如何，这是我的 macbook 在购买时附带的 python 版本。我不认为我想在删除、重新安装等苹果批准的 python 版本上浪费时间。有谁知道我怎样才能让我的系统恢复正常运行？为什么会发生这个错误？感谢您的快速帮助！

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-05-15T21:46:19.913

尝试在 virtualenv 中运行您的新 python，以便它与系统安装隔离。

[http://pypi.python.org/pypi/virtualenv](http://pypi.python.org/pypi/virtualenv)

# android - 带有音频的android进度条移动

> ID：10609027
> 
> 赞同：2
> 
> 时间：2012-05-15T21:20:43.157
> 
> 标签：android, audio, progress

如何在android中使用音频制作进度条或进度对话框移动

我正在尝试设计一个音频播放器。我需要有关进度条的帮助。我希望进度条的状态随着音频的进行而改变。我希望进度条在按下暂停按钮时暂停，并在按下开始按钮时重新开始。请帮助...谢谢

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-05-15T22:10:58.903

第1步：

*   使用 MediaPlayer.getDuration() 获取音频持续时间

第2步：

*   设置 ProgressBar 进度最大值。从第 1 步开始的价值到价值

第 3 步：

*   从 MediaPlayer.getCurrentPosition() 定期更新进度条，同时使用 Handler 播放媒体。[在这里](http://developers.androidcn.com/resources/articles/timed-ui-updates.html)检查

记得;

*   在暂停和停止时停止第 3 步的定期更新

*   如果要添加搜索进度条功能，请使用 MediaPlayer.seekTo(int msec) 方法，其中 msec 是 SeekBar.getProgress()，使用 SeekBar.OnSeekBarChangedListener

祝你好运！

# shell - 在 Shell 脚本中添加一些数字？

> ID：10609028
> 
> 赞同：0
> 
> 时间：2012-05-15T21:20:46.513
> 
> 标签：shell

我怎样才能得到以下数字的总和？在被添加之前，它们正在成倍增加。

```
Input File (count.txt)
2*4
2*1
3*1
3*1
2*1
2*1

Command I am using:
( echo 0 ; sed 's/$/ +/' count.txt; echo p ) | dc. 
```

我得到的总和是 343，这是不正确的。我期待20作为总和。

```
2*4
2*1
3*1
3*1
2*1
2*1 
```

总和：20（每行乘法然后求和）

有任何想法吗？

谢谢，拉吉

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-05-15T21:39:59.427

这应该做的工作：

```
cat count.txt | tr \\n \+ | sed 's/$/\n/' | bc 
```

确保文件末尾没有新行，否则必须修改 sed 表达式。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-05-15T21:51:33.393

这也将完成这项工作：

```
awk -F'*' '{i+=$1*$2} END{print i}' count.txt 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-05-15T21:30:56.860

```
cat count | while read line; do echo $(($line)); done | awk '{i+=$1} END {print i}' 
```

这是我能想到的最好的解决方案，希望对您有所帮助。

# ruby-on-rails - 使用 Shoulda 测试期望方法的对象

> ID：10609042
> 
> 赞同：0
> 
> 时间：2012-05-15T21:22:33.233
> 
> 标签：ruby-on-rails, ruby, testing, shoulda

在以下示例中，@user.expects(:send_invitations!).once 断言失败，即使应用程序正在发送邀请并且正在分配 @send_invitations 变量。你会期待@user.send_invitations！要在此时调用还是 @user.expects(:send_invitations!) 使用不正确？

## 控制器

```
class RegistrationsController < ApplicationController
  before_filter :require_active_user

  def welcome
    if params[:send_invitations]
      current_user.send_invitations!
      @send_invitations = true
    end
  end   
end 
```

## 控制器测试

```
require 'test_helper'

class RegistrationsControllerTest < ActionController::TestCase
  context "With a logged-in user" do
    setup { login_as @user = Factory(:user) }

    context ":welcome" do
      context "with params[:send_invitations] present" do
        setup { get :welcome, { :send_invitations => true } }

        should "send invitations" do
          @user.expects(:send_invitations!).once # tests say this isn't being invoked
          assert assigns(:send_invitations) # but tests say this IS being assigned
        end
      end

      context "without the presence of params[:send_invitations]" do
        setup { get :welcome }

        should "not send invitations" do
          @user.expects(:send_invitations!).never # passes fine
          assert !assigns(:send_invitations!) # also passes fine          
        end
      end
    end
  end
end 
```

# php - php登录行为奇怪

> ID：10609044
> 
> 赞同：0
> 
> 时间：2012-05-15T21:22:45.383
> 
> 标签：php

登录就像典型的登录一样工作，问题是你只能输入用户名，它会让你登录。如果用户名是正确的，那么密码甚至都无关紧要。

php

```
<?php
include 'password.php'; 

session_start();
if (!isset($_SESSION['loggedIn'])) {
    $_SESSION['loggedIn'] = false;
}

if (isset($_POST['password']) && isset($_POST['user'])) {
    if (sha1($_POST['password'] == $password) && sha1($_POST['user']) == $user) {
        $_SESSION['loggedIn'] = true;
    } else {
        $error_msg = "Incorrect Login!";
    }
} 

if (!$_SESSION['loggedIn']): ?> 
```

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-05-15T21:25:44.627

错误在这一行

```
 if (sha1($_POST['password'] == $password) && sha1($_POST['user']) == $user) { 
```

你把括号放在错误的地方（密码后面的那个），下面应该没问题。

```
 if (sha1($_POST['password']) == $password && sha1($_POST['user']) == $user) { 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-05-15T21:33:20.323

除了`marvin`解释的事实之外，我还会在您的代码中添加一行。

```
} else {
        $error_msg = "Incorrect Login!";
        $_SESSION['loggedIn'] = false;   // Add this line
} 
```

# java - Java.lang.reflect.InvocationTargetException JApplet/HTML

> ID：10609045
> 
> 赞同：1
> 
> 时间：2012-05-15T21:22:45.537
> 
> 标签：java, html, japplet

好的，这是我的第一个小程序，我多次尝试绕过这个异常。任何形式的帮助将不胜感激！谢谢！

这是我的代码：

```
package Application;

import java.applet.*;
import java.awt.*;

import javax.swing.JApplet;
import javax.swing.JButton;
import javax.swing.JPanel;

public class FirstApplet extends JApplet
{
    private JPanel jpnlMain = new JPanel(new BorderLayout());
    private JPanel jpnlBoutton = new JPanel(new GridLayout(5,5));
    private JPanel jpnlLogo = new JSplash(this);
    private GenericRoundedButton[] jbtnAllo = new GenericRoundedButton[10];

    public void init(){
        super.init();
        this.add(jpnlMain);
        for(int i =0;i<jbtnAllo.length;i++){
            jbtnAllo[i] = new GenericRoundedButton();
            jpnlBoutton.add(jbtnAllo[i]);
        }       
        jpnlMain.add(jpnlBoutton,"North");
        jpnlMain.add(jpnlLogo,"Center");
    }
} 
```

这是我的 HTML 代码：

```
<html>
    <title>The ImageDemo applet</title>
    <hr>
        <applet code="Application.FirstApplet.class" width="400" height="400">
    </applet>
    <hr>
</html> 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-05-15T21:42:09.993

此代码（与您的代码非常接近的 SSCCE）加载时不会显示任何异常。我可以由此得出结论，问题在于您选择**不包含的代码部分。**

```
// <applet code=FirstApplet width=400 height=400></applet>
import java.awt.*;
import javax.swing.*;

public class FirstApplet extends JApplet
{
    private JPanel jpnlMain = new JPanel(new BorderLayout());
    private JPanel jpnlBoutton = new JPanel(new GridLayout(5,5));
    private JPanel jpnlLogo = new JPanel();
    private JButton[] jbtnAllo = new JButton[10];

    public void init(){
        super.init();
        this.add(jpnlMain);
        for(int i =0;i<jbtnAllo.length;i++){
            jbtnAllo[i] = new JButton();
            jpnlBoutton.add(jbtnAllo[i]);
        }
        jpnlMain.add(jpnlBoutton,"North");
        jpnlMain.add(jpnlLogo,"Center");
    }
} 
```

# function - 如何使 shell 脚本函数能够在命令行中指定参数或从管道中获取它们？

> ID：10609046
> 
> 赞同：0
> 
> 时间：2012-05-15T21:22:51.573
> 
> 标签：function, shell, pipe, command-line-arguments, arguments

例如，我想编写一个名为 的函数`fooFun`，它将对 PDF 文件进行一些处理。我想让它能够以以下两种方式运行：

```
 $ fooFun foo.pdf
  $ ls *.pdf | fooFun 
```

有任何想法吗？谢谢。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-05-15T21:50:02.443

我认为您不能使用 shell 函数轻松地做到这一点。一个更好的主意是把它变成一个脚本，让它接受命令行参数，并通过以下方式实现第二种风格`xargs`：

```
 ls *.pdf | xargs fooFun 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-05-16T10:53:30.403

我同意@larsmans，最好坚持将参数作为参数传递。但是，这是实现您所要求的方法的方法：

```
foofun() {
  local args arg 
  if [[ $# -eq 0 ]]; then
    args=()
    # consume stdin
    while IFS= read -r arg; do args+=($arg); done
  else
    args=("$@")
  fi
  # do something with "${args[@]}"
} 
```

# wso2 - 从 IS 远程访问 Stratos 客户经理

> ID：10609047
> 
> 赞同：0
> 
> 时间：2012-05-15T21:22:58.850
> 
> 标签：wso2, wso2stratos

我需要能够从 Identity Server 更新租户帐户信息，而无需登录到`Apache Stratos Manager`. 我打算通过一个自定义的 jsp 页面来做到这一点。

1.  如何才能做到这一点？
2.  什么罐子需要添加到IS？
3.  调用什么方法来执行调用？

我试图复制`account-mgr.jsp`代码但无法访问`AccountMgrService`.

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-05-17T06:52:57.493

您需要将以下`jar`s 从复制`Manager`到`IS`，

```
|-- org.wso2.carbon.account.mgt-1.5.2.jar
|-- org.wso2.carbon.account.mgt.stub-3.2.2.jar
|-- org.wso2.carbon.account.mgt.ui-1.5.2.jar
|-- drools-5.0.1.wso2v1.jar
|-- jsr94-1.1.0.wso2v1.jar
|-- org.wso2.carbon.billing.core-1.5.2.jar
|-- org.wso2.carbon.billing.mgt-1.5.2.jar
|-- org.wso2.carbon.email.sender-1.5.2.jar
|-- org.wso2.carbon.email.verification-3.2.1.jar
|-- org.wso2.carbon.rulecep.adapters-3.2.0.jar
|-- org.wso2.carbon.rulecep.commons-3.2.0.jar
|-- org.wso2.carbon.rule.core-3.2.0.jar
|-- org.wso2.carbon.rule.engine.drools-3.2.0.jar
|-- org.wso2.carbon.rule.engine.jsr94-3.2.0.jar
|-- org.wso2.carbon.rule.server-3.2.0.jar
|-- org.wso2.carbon.usage-1.5.2.jar
`-- org.wso2.carbon.usage.meteringqueryds.stub-3.2.0.jar 
```

`billing-config.xml`也从目录复制`$MANAGER_HOME/repository/conf`。`$IS_HOME/repository/conf`

理想情况下，它应该只需要`account.mgt.*.jar`s，但由于帐户管理依赖于计费等，因此您将需要上面提到的所有`jar`s `classpath`。这是最新的 WSO2 Stratos 版本 1.5.2。

我们正在考虑使帐户管理独立于计费。

# c++ - 在 strtok 之后比较字符串

> ID：10609051
> 
> 赞同：0
> 
> 时间：2012-05-15T21:23:43.917
> 
> 标签：c++, strtok

我想在 strtok 之后比较字符串，但我似乎变得假而不是真

如果我使用 strtok，我还需要做什么吗？

```
char file[] = "temp.txt";
ifstream getfile;
getfile.open(file,ios::in);
if(getfile.is_open())
{
        char data[256];
    char *line;
    const char * test = "init";

    //loop till end of file                   
    while(!getfile.eof())
    {
        //get data and store to variable data
            getfile.getline(data,256,'\n');

        line = strtok(data," ");
        while(line != NULL)
        {
            cout << "Comparing " << line << " with " << test <<endl;
            //This is suppose to print but it dosent
            if(line == test)
                cout << line << endl;

            line = strtok(NULL," ");
        }

    }
} 
```

输出 ：

```
 comparing init with init 
```

想要的输出：

```
 comparing init with init
 init 
```

谢谢！:D

============================

更改为以下，它的工作！:)

```
if(strcmp(line,test)==0) 
```

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-05-15T21:25:59.593

您正在比较指针而不是内容。查看 strcmp 或将 C 字符串包装在 std::string 中。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-05-15T21:26:42.563

您正在比较指针（字符串的地址）。他们将永远不同。用于`strcmp()`比较字符串本身。

# php - 使用 jQuery，为什么通过 Ajax 返回 JSON 时不执行 Success Callback？

> ID：10609054
> 
> 赞同：0
> 
> 时间：2012-05-15T21:23:55.640
> 
> 标签：php, jquery, ajax, json, callback

我有以下 PHP 代码，它通过 Ajax 将 JSON 对象返回给客户端。

```
function loadAll(){
    $knowledgeHandler = new KnowledgeLevelHandler();
    $json = $knowledgeHandler->loadAll();        
    header('Content-type: application/json');
    print $json;
} 
```

我有一个测试函数分配给 jQuery Ajax 的成功回调。

```
successCallback = function(data){
    alert("A");
}

options = {    
    "data": data,
    "async": false,
    "type": "post",
    "success":successCallback        
}
$.ajax(url, options); 
```

当我`header('Content-type: text/json');`从 PHP 代码中删除时，回调被执行，但是当它被执行时，成功回调没有被执行。怎么了？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-05-15T21:34:42.123

我相信您需要在 JQuery AJAX 调用中将返回的数据类型指定为 JSON。

[http://api.jquery.com/jQuery.ajax/](http://api.jquery.com/jQuery.ajax/)

> json 类型将获取的数据文件解析为 JavaScript 对象，并将构造的对象作为结果数据返回。

```
successCallback = function(data){
    alert("A");
}

options = {    
    data: data,
    async: false,
    type: "POST",
    success: "successCallback",
    dataType: "json"
}

$.ajax(url, options); 
```

您的 successCallback 函数现在将包含一个数据对象，您可以通过它访问您的变量；data.var_1、data.some_other_var 等

尼尔

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-05-15T21:28:17.457

试着告诉 jQuery 你期待 json 回来。

```
options = {    
    "data": data,
    "async": false,
    "type": "post",
    "success":successCallback,
    "dataType": "json"       
} 
```

您还可以使用 xhr、msg、代码作为 args 添加错误回调并输出这些以更好地了解问题所在。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-05-15T21:32:07.560

尝试这个：

```
options = {    
    "data": data,
    "async": false,
    "type": "post",
    "success":successCallback,        
    "dataType: "json"
}
$.ajax(url, options); 
```

# apache-flex - 模型注入后未设置函数绑定

> ID：10609058
> 
> 赞同：0
> 
> 时间：2012-05-15T21:24:21.767
> 
> 标签：apache-flex, datagrid, parsley, datagridcolumn

我有一个从 DataGrid 扩展的 CustomDataGrid 和一个从 DataGridColumn 扩展的 CustomDataGridColumn。

CustomDataGridColumn 具有函数类型的成员变量。

在我看来，我使用 parsley 注入了一个演示模型。

代码如下：

```
<fx:Declarations> 
        <spicefactory:Configure/> 
    </fx:Declarations> 

<fx:Script> 

        [Inject(id="associatedDocumentsPM")] 
        [Bindable] 
        public var model:AssociatedDocumentsPM; 

</fx:Script> 

   <customDataGrid:CustomDataGrid id="AssocDocGrid" 
                                   width="100%" height="{(documentDataList.length+2)*20}" 
                                   doubleClickEnabled="true" enabled="{modeHandler.appEnable}" 
                                   dataP="{documentDataList}" 
                                   sortableColumns="false"> 
        <customDataGrid:columnList> 
            <customDataGrid:CustomDataGridColumn 
                textAlign="left" 
                dataFieldIdentifier="documentName" 
                headerText="Document Type" 
                modifyLabelField="{model.modifyLabelField}" 
                dataField="documentName" 
                isNaNZero="true" 
                showDataTips="true" 
                editable="false"/> 
                ...more columns here...  
       </customDataGrid:columnList>
    </customDataGrid:CustomDataGrid> 
```

AssociatedDocumentsPM 定义了函数，这些函数在列中设置。

一个例子是属性`modifyLabelField="{model.modifyLabelField}"`

CustomDataGridColumn.myLabelField 是函数类型。AssociatedDocumentsPM 中的 myLabelField 是一个公共函数。

Parsley Context 文件位于上述文件的父级中，并声明 PM 如下：

AssocDocPMFactory 是一个具有用 [Factory] ​​装饰的唯一函数的类。

所以问题如下：

当我调试应用程序并检查 DataGrid 的 columnList 时，变量 modifyLabelField 为空。

函数绑定与变量的处理方式不同吗？我正在使用 Flex 4.5.1 和 Parsley 2.4.1

我知道在调用 creationComplete 之后可能会发生注入，但我认为绑定会解决这个问题。

我有一种感觉，模型 - PM - 直到很久以后才为空，并且没有触发函数绑定。

我也尝试使用 FastInject 但无济于事。

这是函数指针和 Flex 绑定的问题吗？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-05-16T09:09:55.660

不，不是。如果您有这些疑问，最好快速设置一个简单的隔离测试情况来验证您的假设。我创建了以下内容来测试您的：

```
<s:Application xmlns:fx="http://ns.adobe.com/mxml/2009" 
               xmlns:s="library://ns.adobe.com/flex/spark" 
               creationComplete="onCreationComplete()" >

    <fx:Script>
        <![CDATA[
            private function onCreationComplete():void {
                test = function(item:*):String {
                    return "AAA";
                }
            }

            [Bindable]
            private var test:Function;
        ]]>
    </fx:Script>

    <s:List labelFunction="{test}">
        <s:dataProvider>
            <s:ArrayList>
                <fx:String>A</fx:String>
                <fx:String>B</fx:String>
                <fx:String>C</fx:String>
            </s:ArrayList>
        </s:dataProvider>
    </s:List>

</s:Application> 
```

如果`test`声明了 Function 变量`Bindable`，您将看到 3 次“AAA”。如果您删除`Bindable`元数据，您将看到“A”、“B”、“C”。

很明显，绑定也适用于函数指针（你必须在别处寻找你的空指针）。

# android - ANDROID XML 解析 - URL

> ID：10609063
> 
> 赞同：1
> 
> 时间：2012-05-15T21:25:00.983
> 
> 标签：android, xml, parsing, url, uri

我已成功将 XML 文件解析为 custom `ListView`，但是如何将 XML 中的 URL 解析为按钮，以便在单击时将用户带到网页？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-05-15T22:03:33.147

您可以简单地使用以下 Intent 替换我的 wordpress 网站 :)

```
 Intent intent = new Intent(Intent.ACTION_VIEW, Uri.parse("http://www.alchemiasoft.wordpress.com"));
    startActivity(intent); 
```

# ruby-on-rails - 是否可以使用 ERB 缩进 Rails 中的视图助手生成的 HTML？

> ID：10609066
> 
> 赞同：2
> 
> 时间：2012-05-15T21:25:24.133
> 
> 标签：ruby-on-rails, erb

我正在使用带有 ERB 的 Rails 3.2.x。我使用辅助方法创建了一个构建器，例如`content_tag`. 但是输出全部连接在一行上。

有人问了同样的问题，但使用了 HAML：[是否可以让 Rails 中的视图助手生成 Haml 缩进 HTML？](https://stackoverflow.com/questions/1528166/is-it-possible-to-have-haml-indent-html-generated-by-a-view-helper-in-rails).

例如，在我的助手中：

```
def foo
  content_tag :div do
    content_tag :div do
      content_tag :span, "test"
    end
  end
end 
```

在我的erb中：

```
<%= foo %> 
```

结果是：

```
<div><div><span>test</span></div></div> 
```

我想拥有：

```
<div>
  <div>
    <span>test</span>
  </div>
</div> 
```

由于我对 Rails 很陌生，我可能会遗漏一些明显的东西，但我在互联网上找不到任何东西......

谢谢

# php - 如何通过 AJAX 从 PHP 文件返回 JavaScript？

> ID：10609070
> 
> 赞同：3
> 
> 时间：2012-05-15T21:25:46.693
> 
> 标签：php, javascript, ajax

这个怎么做？

1.  我们有带有 onclick 事件的按钮，它使用 AJAX 向 PHP 文件发送查询。
2.  PHP 文件有这个 JavaScript：`echo '<script>alert("hello");</script>';`
3.  按下 onclick 事件按钮时，JavaScript 不起作用。我没有看到“你好”的消息。

有人知道如何从 PHP 执行 JavaScript 吗？我正是需要这个。我知道所有的 JavaScript 都应该在 AJAX 级别上执行。但是这种情况需要执行一个 JavaScript，PHP 作为响应返回。

此致

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-05-15T21:30:59.433

您不能从 PHP 执行 Javascript，因为 PHP 在服务器端执行，而 JS 在客户端执行。您需要`eval`在客户端返回 Javascript 代码。

您可以在 AJAX 回调函数中执行此操作：

```
$('#yourButton').onclick(function(){
    //make your ajax request
    $.ajax({
        url : "url",
        success : function(resp){
            //resp is the javascript code sent back from PHP
            //eval it
            eval(resp);
        }
    })
}); 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-05-15T21:28:54.747

考虑一个像这样的javascript：

```
"alert(\"hello\");" 
```

像这样返回：

```
var js = ajax.r; 
```

只需执行以下操作：

```
eval(js); 
```

但在我看来，你有一个非常严重的架构问题。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-05-15T21:44:07.367

评估会起作用，但要小心。

如果用户生成的内容可以进入您的 eval 语句，那么有人可能会使用它为您的站点创建恶意脚本。

只是一个抬头。

# asp.net-mvc-3 - 将数据从列表发送到另一个列表，然后在控制器中编辑

> ID：10609076
> 
> 赞同：1
> 
> 时间：2012-05-15T21:26:01.670
> 
> 标签：asp.net-mvc-3

我的目标是将数据从一个列表传输到另一个。我能够填充它们，现在尝试完成其余的工作。我想在列表之间添加 2 个按钮，以便可以从双方发送数据。我需要帮助对按钮进行编码，以及如何对控制器进行编码，以便我可以收集列表中的选定项目（以删除和/或删除）。

这是我的模型：

命名空间 OnlineTR.WebUI.Areas.Admin.Models { 公共类 TestCategoryModel {

```
 public IEnumerable<TestCase> TestCasesAvailable { get; set; }
   public IEnumerable<TestCase> TestCasesCurrent { get; set; }

} 
```

}

看法 ：

```
@model Models.TestCategoryModel           

@Html.ListBoxFor(model => model.TestCasesAvailable, new SelectList(Model.TestCasesAvailable,"TestCaseId", "TestCaseName"))          

@Html.ListBoxFor(model => model.TestCasesCurrent, new SelectList(Model.TestCasesCurrent, "TestCaseId", "TestCaseName")) 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-05-15T22:13:43.817

亚历克斯，

如果这是您的用例，我会看一下用于交换场景的 jquery UI。我在一个需要将成分类别从一个列表添加到另一个列表的项目中使用了类似的技术。为此，我使用了 jquery draggables，然后将生成的“list b”元素保存为表单帖子的一部分（通过 ajax）。这些示例可能对初学者有所帮助：

*   [jQuery 可拖动、可放置、ASP.NET MVC](https://stackoverflow.com/questions/1405396/jquery-draggable-droppable-asp-net-mvc)
*   [http://www.c-sharpcorner.com/UploadFile/krishnasarala/drag-and-drop-items-from-one-list-to-another-list-using-jque/](http://www.c-sharpcorner.com/UploadFile/krishnasarala/drag-and-drop-items-from-one-list-to-another-list-using-jque/)

将尽快跟进更多

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-05-15T22:13:17.890

这是一个示例帖子...您可以尝试一下...这与您的问题相似...

[http://www.codeproject.com/Articles/136730/ASP-NET-MVC-2-Basics-Working-with-ListBoxes](http://www.codeproject.com/Articles/136730/ASP-NET-MVC-2-Basics-Working-with-ListBoxes)

虽然它是在 MVC 2 中完成的......动态/方法在 MVC 3 中仍然保持不变......

# mongodb - mongoDB Collection LRU Policy +java

> ID：10609080
> 
> 赞同：0
> 
> 时间：2012-05-15T21:26:15.320
> 
> 标签：mongodb

我是 mongoDB 的新手。我正在构建一个需要对集合实施 LRU 策略的应用程序。在 mongoDB 站点中，我看到上限集合支持 FIFO。有没有其他支持 LRU 的集合。通过文档，我只看到站点中的上限集合。mongoDb 中是否还有其他集合。

默认情况下，集合在 mongodb 中是否有上限？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-05-15T21:32:14.693

MongoDB 上限集合是数据库支持的唯一千字节大小限制集合。基于限制特定数量的文档，没有对 LRU 或 FIFO 的内置支持。

默认情况下，集合在 MongoDB 中没有上限 - 有上限的集合是一种特殊情况。

# python - Python：从日期时间列表创建人类友好的字符串

> ID：10609081
> 
> 赞同：-1
> 
> 时间：2012-05-15T21:26:28.747
> 
> 标签：python, datetime, formatting

我实际上正在寻找这个问题的反面： [Converting string into datetime](https://stackoverflow.com/questions/466345/converting-string-into-datetime)

我有一个日期时间对象的列表，我想从中创建一个对人类友好的字符串，例如“2012 年 2 月 4 日 1 月 27 日和 30 日”。有任何想法吗？

请注意，strftime 仅适用于单个日期时间对象。这里的问题是您有一个日期时间列表，这些日期时间的间隔可能不均匀，可能跨越月或年的界限，但整个日期范围必须用一个简洁的字符串表示。

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2012-05-15T21:51:54.013

[这](http://docs.python.org/library/datetime.html#datetime.date.strftime).

```
your_date.isoformat() # -> '2002-03-11'
your_date.strftime("%A %d. %B %Y") # -> Monday 11\. March 2002 
```

**更新**：您需要列表理解才能在一行中完成。

```
date_strings = [dt.strftime("%A %d. %B %Y") for dt in your_date_list] 
```

或者，使用 for 循环：

```
date_strings = []
for dt in your_date_list:
    date_str.append(dt.strftime("%A %d. %B %Y")) 
```

**更新2**：我相信这更接近你的期望，但仍然是你想要的，只有你知道：你想什么时候展示这一年，什么时候不想展示？何时仅显示月份或日期等...但这基本上是一个想法。您可能需要做某种类来表示范围，您可以在那里选择格式，比较范围之间的月份和年份，......这就是我现在想出的。希望能帮助到你：

```
import datetime

# sample input
dates = [datetime.date(2012, 5, 21), datetime.date(2012, 5, 23),
        datetime.date(2012, 5, 25), datetime.date(2012, 5, 19),
        datetime.date(2012, 5, 17), datetime.date(2012, 5, 26),
        datetime.date(2012, 5, 18), datetime.date(2012, 5, 20)]

def get_consecutive_ranges(dates):
    dates = sorted(dates)

    delta_1day = datetime.timedelta(days=1)
    ranges = []
    last_d = dates[0]
    tmp_range = [last_d, None]
    for d in dates[1:]:
        if d-last_d <= delta_1day:
            # the difference between the dates is less than a day
            # we can extend the range, update the right-most boundary
            tmp_range[1] = d
        else:
            ranges.append(tmp_range)
            tmp_range = [d, None]
        last_d = d
    else:
        ranges.append(tmp_range)
    return ranges

ranges = get_consecutive_ranges(dates)

fmt = "%d %b %Y"

output = ", ".join([("%s" % (r[0].strftime(fmt),)) if r[1] is None else \
            ("%s-%s" % (r[0].strftime(fmt), r[1].strftime(fmt))) \
            for r in ranges])

print output 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-05-16T01:38:48.817

```
>>> dt=datetime.date(2012,2,4)
>>> dt.strftime('%A %B %d, %Y')
'Saturday February 04, 2012' 
```

# ruby-on-rails - 存储创建不保存到数据库

> ID：10609085
> 
> 赞同：0
> 
> 时间：2012-05-15T21:26:40.887
> 
> 标签：ruby-on-rails, model-view-controller, ruby-on-rails-3.1, model-associations

我正在尝试创建一个表单，允许我的用户在 Rails 中创建与他们关联的商店。

我有一个 has_many 和 belongs_to 关联，但似乎无法让商店甚至保存到数据库中以查看关联是否有效。

目前对于我的商店中的表格#new 视图，我有：

```
<%= form_for @store do |f| %>

<div class = "field">
    <%= f.label :name %>
    <%= f.text_field :name %>
</div>

<%= f.submit "Submit" %>

<% end %> 
```

对于我的新操作和创建操作，我的商店控制器中有以下内容

```
def new
  @store = Store.new
end

def create
  @user = current_user 
  @store = @user.stores.new(params[:stores])

  if @store.save
    redirect_to store_path
  else
    render newstore_path
  end
end 
```

我的型号名称也绝对是单数（商店）。

这在过去对我有用，所以我很困惑为什么现在不行。

如果有人可以向我展示使用嵌套资源成功关联两个模型的绝对最简单的方法，然后创建一个可以保持这种关联的表单，这将非常有用，因为我在过去几天一直在努力解决这个问题并且真的认为一个可靠的例子有助于。

不过，人们可以提供的任何信息都会非常好。提前致谢 ：）

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-05-15T21:35:10.960

由于这是嵌套资源的表单，您可能需要

```
<%= form_for [@user, @store] do |f| %> 
```

您可能还想尝试在控制器的创建操作中使用 create 或 build，而不是 new。

嵌套模型的表单上还有一个很好的 Railscast：

[http://railscasts.com/episodes/196-nested-model-form-revised](http://railscasts.com/episodes/196-nested-model-form-revised)

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-05-16T14:21:28.063

You don't need any nested attributes here. you are in the Store controller and i assume the store#new view too. So you are just creating a store with the user_id field as current_user.id or `current_user.stores.build(params[:stores])` should be working in your create method.

Let's see your view first too, and what does console say when you do `u = User.first; u.stores.create!`

Lastly, imo, this is just a User has many stores association, no need for a habtm.

# cocoa-touch - 循环中的 Cocoa Touch ProgressView 不显示更新

> ID：10609088
> 
> 赞同：0
> 
> 时间：2012-05-15T21:27:23.713
> 
> 标签：cocoa-touch, uikit, uiprogressview

如果我有一个无害的循环，当我按下一个按钮时会被触发：

```
- (IBAction)start:(id)sender{
    calculatingProgressBar.progress = 0.0;  
    int j = 1000;
    for (int i=0; i<j; i++) {
        calculatingProgressBar.progress = (i/j);
    }
} 
```

ProgressView 未更新。在其他语言中，您必须在这些情况下执行视图更新命令。什么是 Cocoa 等价物，或者您是否必须采取其他一些解决方法。

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-05-15T22:45:20.037

问题是 UI 仅在运行（事件）循环转动时定期更新。`for()`我假设在主线程上运行的循环将阻塞运行循环直到完成。这不仅意味着进度条不会更新（或者，更确切地说，最后会直接跳到 100%），而且您可能会冻结 UI 一段时间。（我假设，由于您正在显示进度条，这可能需要一段时间。）

对于任何冗长的操作，您想要做的是在单独的队列/线程上完成工作，并定期调用主线程上的 UI 更新。例如，您可以尝试类似（**警告：在浏览器中键入**）：

```
dispatch_queue_t queue = dispatch_get_global_queue(DISPATCH_QUEUE_PRIORITY_BACKGROUND, 0);
dispatch_async(queue, ^{
    int j = 1000;
    for (int i=0; i<j; i++) {
        // Do your presumably useful work, not just looping for fun :-)
        dispatch_async(dispatch_get_main_queue(), ^{
            // UI updates always come from the main queue!
            calculatingProgressBar.progress = (i/j);
        });
    }
}); 
```

此示例使用 GCD（[Grand Central Dispatch](https://developer.apple.com/library/mac/#documentation/Performance/Reference/GCD_libdispatch_Ref/Reference/reference.html)）。您还可以查看更高级别的构造，例如[NSOperationQueue](https://developer.apple.com/library/mac/#documentation/Cocoa/Reference/NSOperationQueue_class/Reference/Reference.html)，但基本思想保持不变。

如果您不熟悉并发（多线程）编程，那么您将有一个适度的学习曲线来加快速度。我建议从[并发编程指南](https://developer.apple.com/library/ios/#documentation/General/Conceptual/ConcurrencyProgrammingGuide/Introduction/Introduction.html)开始。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-05-15T22:46:12.397

当您在主线程上运行代码时，UI 无法自行更新。这是有意的，并且大大提高了性能。这意味着在`start`返回之前不会对 UI 进行任何更新。你更新`progress`了很多次，然后又回来了，所以它只画了一次。

您将需要使用计时器或 GCD 队列来实现您所说的。这在很大程度上取决于其余代码的外观，但这是一种方法，例如，如果您希望它运行超过 60 秒：

```
- (IBAction)start:(id)sender{
  calculatingProgressBar.progress = 0.0;  
  int j = 60;

  dispatch_time_t now = dispatch_time(DISPATCH_TIME_NOW, 0);
  for (int i=0; i<j; i++) {
    dispatch_after(dispatch_time(now, i * NSEC_PER_SEC),
                   dispatch_get_current_queue(),
                   ^{
                     calculatingProgressBar.progress = (i/j);
                    });
    }
} 
```

它的作用是设置 60 个事件并安排它们运行一秒钟。然后它返回（还没有运行它们）。

还有很多其他方法，例如`NSTimer`GCD 计时器。您还可以使用`dispatch_async()`. （请参阅康拉德舒尔茨的回答）

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-12-10T19:03:44.520

我认为一个更优雅（和通用）的解决方案是：在你的代表中，有这个：

```
maxNumber = 1000; // define this somewhere, just for convenience
...
[self performSelectorInBackground:@selector(doLoop:) withObject:[NSNumber numberWithInt:maxNumber]]; 
```

有这样的方法：

```
- (void)doLoop:(NSNumber *)myMaxNumber { // this runs on the background
  calculatingProgressBar.progress = 0.0;  
  NSNumber *j = myMaxNumber;
  for (int i=0; i<j; i++) {
    [self performSelectorOnMainThread:@selector(updateProgress:) withObject:[NSNumber numberWithInt:i] waitUntilDone:NO];
  }
  // here you could call a method in the main thread, just to signify that your loop is done.
  // [self performSelectorOnMainThread:@selector(loopDone:) withObject:nil waitUntilDone:NO];
} 
```

并且更新在这里完成：

```
-(void)updateProgress:(NSNumber *)myNumber {
  calculatingProgressBar.progress = ([myNumber intValue]/maxNumber);
} 
```

* * *

## 回答 #4

> 赞同：-1
> 
> 时间：2012-05-15T22:35:12.463

假设calculatingProgressBar 是一个IBOutlet，那么您可能只需要以符合KVO 的方式设置新值，即使用setter：self.calculatingProgressBar.progress = (i/j);

# java - 删除 JFX 中选项卡后面的灰色 bg

> ID：10609103
> 
> 赞同：20
> 
> 时间：2012-05-15T21:28:33.787
> 
> 标签：java, user-interface, javafx

那么有什么方法可以删除选项卡后面的灰色区域： ![例子](../Images/0b0c7ee6a7c5fa08bfe1b1f7ff1cdab8.png)

我试过用 CSS 来做到这一点，但没有找到方法。

* * *

## 回答 #1

> 赞同：19
> 
> 时间：2013-03-31T17:27:28.407

要设置 tabpane 标题的背景颜色，请在 CSS 文件中写入：

```
.tab-pane .tab-header-area .tab-header-background {
    -fx-background-color: yellow;
} 
```

要删除边框，请写：

```
.tab-pane .tab-header-area .tab-header-background {
    -fx-effect: null;
} 
```

要完全删除标题，请将不透明度设置为 0：

```
.tab-pane .tab-header-area .tab-header-background {
    -fx-opacity: 0;
} 
```

有关样式类选项卡窗格的更多信息，您可以在此处找到：http:
[//docs.oracle.com/javafx/2/api/javafx/scene/doc-files/cssref.html#tabpane](http://docs.oracle.com/javafx/2/api/javafx/scene/doc-files/cssref.html#tabpane)

* * *

## 回答 #2

> 赞同：9
> 
> 时间：2012-05-16T09:06:10.057

JavaFX 有一个名为 caspian.css 的内置默认 CSS 表。请阅读这篇文章：[https](https://stackoverflow.com/a/10149050/682495) ://stackoverflow.com/a/10149050/682495 。
要更改默认 CSS，请将此选择器添加到您的 CSS 文件并对其进行自定义：

```
.tab-pane *.tab-header-background {
    -fx-background-color: -fx-outer-border, -fx-inner-border, derive(-fx-color, -20%);
    -fx-effect: innershadow(two-pass-box , rgba(0,0,0,0.6) , 4, 0.0 , 0 , 0);
} 
```

* * *

## 回答 #3

> 赞同：3
> 
> 时间：2018-12-31T17:25:40.583

这是一种更简单的方法 tabPane.getStyleClass().add("floating"); （从上面没有得到足够关注的评论中复制）

# javascript - 用于产生类似 iOS 的滚动的线程合成？

> ID：10609112
> 
> 赞同：2
> 
> 时间：2012-05-15T21:29:20.683
> 
> 标签：javascript, ios, google-chrome, scroll, compositing

什么是线程合成？

它在最近的[Paul Irish Post](https://plus.google.com/113127438179392830442/posts/Kgk78sixgYp)中被称为产生类似 iOS 的滚动的一种手段：

我搜索了 chrome about:flags，但找不到 Paul 所指的内容。我认为它与元素的呈现方式有关，但我对是否/如何以编程方式处理合成感兴趣（在 JavaScript 中？）。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-07-19T05:43:25.657

在这个页面上测试了这个标志，仍然滚动冻结 [http://romaxa.info/tests/scrolltest/layout3_busy_long.html](http://romaxa.info/tests/scrolltest/layout3_busy_long.html)

在 XUL firefox 上运行良好（具有多进程层的移动版本）

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-05-17T19:37:57.660

此时，线程合成是一项实验性功能，因此[仅在 dev 或 canary 通道中可用](http://code.google.com/chrome/extensions/experimental.html)。如果您想试用此功能，可以[在 dev 或 canary 频道下载 Chrome 版本](http://www.chromium.org/getting-involved/dev-channel)。

关于功能本身，在 上描述如下`chrome://flags/`：

> 使用辅助线程执行网页合成。这允许平滑滚动，即使主线程没有响应。

# ruby-on-rails - 在开发中进行黄瓜测试时，是否可以关闭 ActionMailer 电子邮件？

> ID：10609113
> 
> 赞同：5
> 
> 时间：2012-05-15T21:29:27.210
> 
> 标签：ruby-on-rails, cucumber

目前，我的本地开发环境已设置为能够发送实际电子邮件。正因为如此，交付正在进行中，并且没有任何东西保留在`ActionMailer::Base.deliveries`表中。是否可以在黄瓜测试中禁用电子邮件发送？如果是这样，这样做的语法是什么？还是有更好的方法来测试正在发送的电子邮件？

authentication_steps.rb：

```
Then /^I should receive a confirmation email$/ do
  email = ActionMailer::Base.deliveries.last
  email.subject.should == "Welcome to our website!"
end 
```

应用程序/配置/开发.rb

```
 ...
  # Don't care if the mailer can't send
  config.action_mailer.raise_delivery_errors = true
  config.action_mailer.perform_deliveries    = true

  # Setup for local testing of emails using gmail test account
  config.action_mailer.delivery_method = :smtp
  config.action_mailer.smtp_settings = {  :address => 'smtp.sendgrid.net',
                                           :port => 587,
                                           :domain => ENV['MAIL_DOMAIN'],
                                           :authentication => 'plain',
                                           :enable_starttls_auto => true,
                                           :user_name => ENV['MAIL_USERNAME'],
                                           :password => ENV['MAIL_PASSWORD']
                                           }
  ... 
```

谢谢

* * *

## 回答 #1

> 赞同：10
> 
> 时间：2012-05-15T21:44:57.703

```
 config.action_mailer.delivery_method = :test 
```

或者

就在测试之前

```
ActionMailer::Base.delivery_method = :test 
```

# ssl - 打开 HTTPS 页面时的浏览器步骤

> ID：10609118
> 
> 赞同：5
> 
> 时间：2012-05-15T21:30:25.440
> 
> 标签：ssl, https

我想知道浏览器在打开 HTTPS 页面时执行的步骤，以深入了解双方（服务器和客户端）需要执行的每个操作。我知道它的基本步骤，但我想了解更多细节。我在 Google 中找到的链接描述的是一般信息，而不是细节。

有没有可以阅读相关信息的来源。

我一直在考虑寻找 Mozilla Firefox 的来源，但之前决定在这里询问。

谢谢你。

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2012-05-15T22:55:48.773

HTTPS 在[RFC 2818](https://www.rfc-editor.org/rfc/rfc2818)中定义。简而言之，浏览器首先与服务器建立 SSL/TLS 连接，然后在此连接中发送 HTTP 请求/响应。

为了建立 SSL/TLS 通道，客户端启动握手，在此期间服务器发送其 X.509 证书。除了 SSL/TLS 握手机制外，浏览器还根据它拥有的信任锚列表（受信任的证书）和它尝试访问的名称（URL 中的主机名必须与证书匹配，如[RFC中定义的那样）验证证书2818 第 3.1 节](https://www.rfc-editor.org/rfc/rfc2818#section-3.1)）。其中大部分通常在 SSL/TLS 堆栈中实现，但某些浏览器可以让您通过添加异常（有时是永久异常）来绕过这一点，因此浏览器还有一个备用机制，以防 SSL/TLS 堆栈无法接受证书成功地。

SSL/TLS 协议（及其握手）在[SSLv3](http://www.mozilla.org/projects/security/pki/nss/ssl/draft302.txt)、[TLS 1.0](https://www.rfc-editor.org/rfc/rfc2246)、[1.1](https://www.rfc-editor.org/rfc/rfc4346)和[1.2](https://www.rfc-editor.org/rfc/rfc5246)中定义。

使用服务器证书中的服务器公钥，客户端和服务器能够执行经过身份验证的密钥交换，之后它们具有共同的预主密钥。主密钥以及用于加密应用程序数据的共享对称密钥都是从该预主密钥导出的。

用于此经过身份验证的密钥交换的机制[取决于密码套件](https://stackoverflow.com/a/10438199/372643)。[TLS 规范本身](https://www.rfc-editor.org/rfc/rfc4346#appendix-F.1.1)有更多细节。

如果您想通过示例学习，值得查看 Wireshark 示例数据（如[本答案](https://stackoverflow.com/a/10247166/372643)所示）。

“ [*HTTPS 连接的前几毫秒*](http://www.moserware.com/2009/06/first-few-milliseconds-of-https.html)”也应该很有趣。

# ruby-on-rails - 缓存控制和 Rails 本地化：好的做法？

> ID：10609123
> 
> 赞同：1
> 
> 时间：2012-05-15T21:30:40.017
> 
> 标签：ruby-on-rails, url, caching, localization

我有这个 Rails 应用程序，它提供一堆本地化的静态页面（通过 PagesController）。语言环境是从用户的`HTTP_ACCEPT_LANGUAGE`变量中设置的。问题是，无论语言环境如何，URL 都保持不变，所以我不能使用`Cache-Control`，因为它也会缓存语言环境。

我已经读过，在 URL 中没有语言环境是不好的做法。但是查看 Facebook 和 Twitter 等网站的主页时，他们不会这样做（twitter.com 将显示在访问者的区域设置中，该区域设置存储在 cookie 中）。此外，像这样的网址`twitter.com?locale=en`有点难看......

如果我想使用`Cache-Control`, 设置语言环境`HTTP_ACCEPT_LANGUAGE` **并且**只有一个 URL，我有什么选择，就像 Twitter 和 Facebook 一样？

# google-apps-script - createDocsListDialog setInitialView 错误

> ID：10609124
> 
> 赞同：3
> 
> 时间：2012-05-15T21:30:40.517
> 
> 标签：google-apps-script

使用 createdocsListDialog 函数再次返回 :)

我已经开始工作了，但是我想将要选择的文件限制为仅电子表格。

**“遇到错误：找不到方法 setInitialView(string)。（第 13 行）”**

.setInitialView 作为一种方法出现在脚本编辑器中，但是在运行时.. 并没有那么多。这是代码。

`var doclisthandler = app.createServerHandler('selectionhandler'); var doclist = app.createDocsListDialog().showDocsPicker() .addSelectionHandler(doclisthandler).setInitialView('spreadsheet');`

有任何想法吗？

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2012-05-15T21:50:05.517

从代码完成本身可以看出，该`setInitialView`函数不需要字符串作为参数，而是 FileType 常量。在[文档](https://developers.google.com/apps-script/class_uiapp_filetypeconstants)中，您可以看到它被称为`SPREADSHEETS`.

下面是它的工作原理：

```
app.createDocsListDialog().showDocsPicker().
  addSelectionHandler(doclisthandler).setInitialView(UiApp.FileType.SPREADSHEETS) 
```

# cordova - 按正确顺序学习phonegap的步骤

> ID：10609127
> 
> 赞同：1
> 
> 时间：2012-05-15T21:31:11.387
> 
> 标签：cordova, sdk

我刚刚听说 phonegap 是一个框架，它让开发人员制作 Web 应用程序，然后用 phonegap 框架包装来构建原生应用程序。如果这是正确的，开发人员应该首先制作 web 应用程序（使用 HTML、JS、CSS），然后在 phonegap 下工作，最后创建构建以制作原生应用程序。

但是当我访问它的入门页面时，它说在开始时安装 SDK（比如 Android）。这应该是最后一步。首先它应该允许我制作网络应用程序，然后让我决定要为哪个平台制作应用程序。

有没有什么方法可以在不安装 Android 等 SDK 的情况下学习 phonegap？

我只想学习phonegap，它的平台独立那为什么我第一步安装android SDK？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-05-15T23:17:46.097

即使您使用PhoneGap，您仍然需要使用本机SDK 编译您的应用程序。您可以尝试使用云 IDE，例如：

[http://www.applaudcloud.com/](http://www.applaudcloud.com/)

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-05-16T05:28:02.280

您也可以尝试[build.phonegap.com](http://build.phonegap.com)服务。该服务允许上传他们的 HTML、JS 和 CSS 并取回适用于 iOS、Android、BB、Windows Phone、webOS 和 Symbian 的可安装二进制文件。

# asp.net - 为什么 IIS 6 / Windows 2003 强制网站使用 .NET 2.0？

> ID：10609128
> 
> 赞同：1
> 
> 时间：2012-05-15T21:31:30.243
> 
> 标签：asp.net, .net-4.0, iis-6, windows-server-2003, asp.net-2.0

我有一个运行 IIS 6.0 的 Windows 2003 Server 64 位。

当我设置服务器时，我注意到“ASP.NET”选项卡已从 IIS 管理器的“网站”属性中删除。

现在每个网站都在 .NET 2.0 上运行，我需要将它们更改为在 .NET 4.0 上运行。
我在“Web 服务扩展”中启用了 ASP.NET 4（32 位）（32 位和 64 位模式下唯一的其他选项 ASP.NET 版本 2）。

我可以确认在 C:\Windows\Microsoft.net 文件夹中，有 'WOW' 和 32 位 .Net 安装。

这是一个有许多网站的生产服务器，我害怕运行一些 IISReg 脚本来放回“ASP.NET”选项卡。

当我尝试访问 .Net 4 目标网站时，出现错误：

> 无法识别的配置部分 system.web.extensions

版本信息显示.Net 2.0

那么我能做什么呢？
谢谢！

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-05-16T18:05:33.580

正如我在上面的“评论”中指出的那样，我必须在 64 位系统中以 32 位模式运行 IIS 才能针对某个 Web 应用程序。可以在此处查看背景信息：

[http://dillieodigital.wordpress.com/2010/10/07/windows-server-2003-64bit-iis-6-32bit-asp-net-4-framework-and-targeting/](http://dillieodigital.wordpress.com/2010/10/07/windows-server-2003-64bit-iis-6-32bit-asp-net-4-framework-and-targeting/)

这导致使用 .NET 2.0 以 32 位模式运行所有网站。为了让新的 Web 应用程序在 .NET 4 中运行，我按照以下说明进行操作：

[http://mlichtenberg.wordpress.com/tag/iis6-asp-net/](http://mlichtenberg.wordpress.com/tag/iis6-asp-net/)

问题解决了！供参考。谢谢。

# ruby-on-rails - rails 3 simple_form_for：默认值

> ID：10609130
> 
> 赞同：3
> 
> 时间：2012-05-15T21:31:41.713
> 
> 标签：ruby-on-rails, simple-form

我有一堆要水平渲染的部分，使用 form-inline (twitter bootstrap)。如果单独指定它们可以正常工作，但是当使用 :defaults 指定时，该类不会出现。

```
%ul.nav.nav-tabs#tab
  %li= link_to "General", "#client_tab1", 'data-toggle'=>"tab"
  %li= link_to "Applications", "#client_tab2", 'data-toggle'=>"tab"
= simple_form_for @client, defaults:{input_html:{class:'form-inline'}}, :html=>{:class=>"client tab-content"} do |f|
  #client_tab1.tab-pane.fade.in.active
    = render :partial => "client", :locals => {:f => f}
  #client_tab2.tab-pane.fade.in
    = render :partial => "applications/applications", :locals => {:f => f}
  .actions
    = f.button :submit, class:"btn-primary", value: "Save" 
```

部分看起来像：

```
.status
  .span3
    = f.label :status
    = f.collection_select :status_id, selection_list(Status), :last, :first
    %br
    = f.input :open_date, :as => :jdate
    %br
    = f.label :assigned_to
    = f.collection_select :assigned_to_id, selection_list(User), :last, :first
    %br
    .form-inline
      = f.label :assistant
      = f.collection_select :assistant_id, selection_list(User), :last, :first
    %br 
```

在上面，使用明确的 .form-inline，一切都按预期工作。但是根据[https://github.com/plataformatec/simple_form](https://github.com/plataformatec/simple_form)下面的示例代码， :defaults 中定义的类应该应用于所有方法。事实上，他们不是。

```
<%= simple_form_for @user, :defaults => { :input_html => { :class => 'default_class' } } do |f| %>
  <%= f.input :username, :input_html => { :class => 'special' } %>
  <%= f.input :password, :input_html => { :maxlength => 20 } %>
  <%= f.input :remember_me, :input_html => { :value => '1' } %>
  <%= f.button :submit %>
<% end %> 
```

谁能解释为什么会这样或者我做错了什么？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-05-15T22:14:59.490

几件事：

1.  通过阅读 twitter bootstrap 文档，看起来 form-inline 类在应用于输入字段的父元素时有效，例如表单元素，或者在您的示例中为 div。

您可以在此处看到（取自样式表）：

```
.form-search input,
.form-inline input,
.form-horizontal input,
.form-search textarea,
.form-inline textarea,
.form-horizontal textarea,
.form-search select,
.form-inline select,
.form-horizontal select,
.form-search .help-inline,
.form-inline .help-inline,
.form-horizontal .help-inline,
.form-search .uneditable-input,
.form-inline .uneditable-input,
.form-horizontal .uneditable-input,
.form-search .input-prepend,
.form-inline .input-prepend,
.form-horizontal .input-prepend,
.form-search .input-append,
.form-inline .input-append,
.form-horizontal .input-append {
  display: inline-block;
  *display: inline;
  margin-bottom: 0;
  *zoom: 1;
} 
```

1.  我阅读了 simple_form 文档，意思是默认值仅适用于 f.input 方法。我认为这意味着这意味着提供给 input_html 的内容将应用于 f.input 生成的所有元素，包括标签和输入字段本身。但是，看起来 f.input 不会像 div 那样为输入字段生成任何父元素。

因此，由于 twitter bootstrap 仅在有父元素（例如 div，其类为 form-inline）时才应用样式，因此将 form-inline 应用于输入字段无关紧要。

将 .form-inline 保留在部分中似乎并没有增加太多，为什么不把它保留在那里呢？

# jquery - Internet Explorer shiv 和用法？

> ID：10609131
> 
> 赞同：0
> 
> 时间：2012-05-15T21:31:43.847
> 
> 标签：jquery, internet-explorer, html5shiv

我想我不知道使用 shiv。

我已将此添加到我的头顶！

```
<!--[if lt IE 9]>
<script src="//html5shiv.googlecode.com/svn/trunk/html5.js"></script>
<![endif]--> 
```

但简单地说，不知何故它根本没有帮助？或者别的什么是我的问题而不是 IE ？无论如何，这是我开始制作的网站如何查看 Internet Explorer 9 的示例：

> [http://snpr.cm/t0dFbv.png](http://snpr.cm/t0dFbv.png)

还有一些元素，但抱歉我不能展示。无论如何，所有元素都是如此。遍及IE。

到目前为止，我的网站可以在 Mozilla、Chrome、Safari 中运行。我安装了这些浏览器，所以我在那里测试了......

谁能告诉我IE有什么问题？

# c++ - 如何在 linux 中优化构建

> ID：10609132
> 
> 赞同：0
> 
> 时间：2012-05-15T21:31:52.323
> 
> 标签：c++, linux, gcc, compilation, multiprocessing

如何在多处理器机器上加速/优化 Linux 上大型项目的编译，以便利用所有处理器并行完成编译。

任何有关特殊标志、调整的建议都会有所帮助。

问候，-J

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-05-16T05:35:51.790

如果你真的有一个*庞大*的项目，比如几百万行 C++ 和几千个 CPU，你可能想看看 Google 如何[解决](http://google-engtools.blogspot.com/2011/05/welcome-to-google-engineering-tools.html)它的[构建](http://google-engtools.blogspot.com/2011/06/build-in-cloud-accessing-source-code.html)问题。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-05-16T06:27:49.273

您应该设置依赖规则并告诉编译器发出它们（-MD -MP for gcc），例如：

```
YOUR_DEP    :=$(patsubst %.o,%.d,$(YOUR_OBJ))
-include $(YOUR_DEP)
...

%_c.o: %.c Makefile
@echo [GCC ] $<
@$(CC) $(CFLAGS) -MD -MP $< -o $@
%_cpp.o: %.cpp Makefile
@echo [CXX ] $<
@$(CXX) $(CXXFLAGS) -MD -MP $< -o $@ 
```

这样make可以进行依赖检查。但是，并行 make -j 有时会给具有多级依赖的大型项目带来麻烦。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-05-15T21:39:22.010

这取决于您使用的构建系统。如果它是 GNU `make`，只需添加`-j`（或`--jobs`）应该并行化构建。它可能适用于*大型*项目，也可能不适用，具体取决于 makefile 的表现如何。

另请参阅[手册](http://www.gnu.org/software/make/manual/html_node/Parallel.html)。

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2012-05-15T21:34:15.500

```
make -j <NUM_CPUS> 
```

（见`make(1)`。）

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2012-05-24T17:09:09.217

您可以使用 distcc 工具从预定义的机器池中编译不同 Linux 机器上的不同源文件。显然make命令行中的“-j”必须使用。此外，您应该尽量避免递归 Makefile，即从 Makefile 调用“make -C $sub_dir”递归 - 这会减慢大型项目的制作过程。

# iframe - 带有 Flash 内容的 iframe 上方的 div

> ID：10609139
> 
> 赞同：1
> 
> 时间：2012-05-15T21:32:25.597
> 
> 标签：iframe, html, z-index

我想在带有 Flash 内容的 iframe 上方放置一个 div（例如 youtube 视频）。我无权访问 iframe 中的内容，因此无法修改其中的内容。

我已经尝试了很多东西（z-index...一切）。但没有任何效果。我只是问，因为我真的找不到解决方案:(

问题是 iframe 包含 Flash 内容。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-05-15T21:47:21.867

恐怕我无法为经过测试的解决方案提供帮助，因为我没有任何 Flash 文件来测试创建答案，但我可以告诉你为什么会发生这种情况。

Flash 是一个浏览器插件，这意味着 Flash 电影永远不会真正成为 HTML 文档的一部分。取而代之的是页面的区域被保留给插件运行，然后被调用并在页面的“顶部”运行。因此，在其他元素上设置 z-index 永远不会真正解决问题，无论您尝试哪种组合。

但是，您可以在插件识别的元素本身上设置一个“魔术”参数/属性，称为“wmode”。如果您将此参数/属性设置为“透明”，则 Flash 插件允许一些 HTML 元素显示出来，从而产生它们位于 Flash 电影之上的错觉。

如果您能够联系 iframe 的所有者将 wmode 参数设置为透明，我建议您这样做。如果这是嵌入的 youtube 或 vimeo，请查看是否有任何文档或选项可以自行添加参数。

如果你没有什么可以做的，因为即使是 JavaScript 也不会是你的朋友（出于安全原因，你不能用 JS 修改框架的内容）

编辑：

刚刚记住，如果有办法让您使用 HTML5 视频而不是 Flash，那会有所帮助。HTML5 视频作为文档对象模型的一部分呈现，因此可以通过 z-index 属性进行控制。

尼尔

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-05-15T21:40:20.183

`iframe`标签具有最高的 z-index。它们在页面上高于一切。你可以把一个`iframe`放在另一个上面，然后把你的文本放在里面。

jsFiddle：http: [//jsfiddle.net/USqxj/30/](http://jsfiddle.net/USqxj/30/)

```
<div><iframe style="width:100px;height:100px;"></iframe></div>
<div><iframe style="width:50px;height:50px;position:absolute;margin-top:-85px;left:25px;"></iframe></div> 
```

# css - 在伪元素上添加 CSS 类

> ID：10609142
> 
> 赞同：25
> 
> 时间：2012-05-15T21:32:55.440
> 
> 标签：css, pseudo-element

我想知道是否有办法将 CSS 类添加到伪元素，例如：after。

我想使用 :after 附加错误消息。我还希望错误消息的样式与其他错误消息的样式相同。

这有效：

```
.error:after {
  content: "Error Message";
  color: red;
} 
```

但是我可以做这样的事情来添加比颜色样式更多的东西吗？：

```
.error:after {
  content: "Error Message";
  class: error_message_styles;
} 
```

另外，使用“::after”和“:after”有区别吗？

提前致谢！

* * *

## 回答 #1

> 赞同：23
> 
> 时间：2012-05-15T21:37:37.923

无法将任何类型的 HTML 属性赋予伪元素。

只需使用选择器两次：

```
.error:after {
  content: "Error Message";
}
.error:after, .error-style {
  color:red;
} 
```

> 另外，使用“::after”和“:after”有区别吗？

根据这个：

> [https://developer.mozilla.org/en/CSS/:after](https://developer.mozilla.org/en/CSS/:after)
> 
> 该`::after`符号是在 CSS 3 中引入的，目的是区分伪类和伪元素。`:after`浏览器也接受CSS 2 中引入的符号。
> 
> **注意：** Microsoft Internet Explorer 8 仅支持 :after 表示法。

我认为错误消息可能是内容，而不是装饰 - 但这是你的决定。

* * *

## 回答 #2

> 赞同：6
> 
> 时间：2012-05-15T21:44:19.370

该`:after`元素不是物理 DOM 元素，因此它不能带类。

如果您使用[LESS](http://lesscss.org/#synopsis)之类的样式表库，则可以通过将该类作为属性来混合其他类的样式：

```
.error {
    .error-styles;
} 
```

# vb.net - WP7 - 更新列表框

> ID：10609143
> 
> 赞同：3
> 
> 时间：2012-05-15T21:32:57.827
> 
> 标签：vb.net, windows-phone-7, webclient, observablecollection

我终于开始着手开发 Windows Phone 了。我还不是很擅长，但无论如何，我希望你们明白我想在这里做什么。

根据我从其他程序员那里学到的知识，ObservableCollection 可以在数据绑定到对象（例如列表框）时实时更新。对 ObservableCollection 的所有更改都将导致其数据绑定对象的 UI 更新其项目。

所以我想做的是从我的服务器下载一个文件，用 json 解析它，然后用新数据更新 ObservableCollection。但是，在重新打开应用程序之前，网络客户端似乎不会下载新数据！

* * *

这是一个 gif，显示了该应用程序目前的工作方式： ![在此处输入图像描述](../Images/2336091f926bc016c9d9a8972274b297.png)

这是我的代码（减少一点）：

```
Dim aList As New ObservableCollection(Of classes.consoles)

Private Sub PhoneApplicationPage_Loaded(sender As System.Object, e As System.Windows.RoutedEventArgs) Handles MyBase.Loaded
        checkforconsoles()
End Sub

Public Sub checkforconsoles()
        Dim wc As New WebClient()
        AddHandler wc.DownloadStringCompleted, AddressOf downloaded
        wc.DownloadStringAsync(New Uri("http://localhost/api/?function=GetConsolesForUser&userid=" & id))
    End Sub

    Private Sub downloaded(sender As Object, e As DownloadStringCompletedEventArgs)

        aList.Clear()
        'MessageBox.Show(e.Result)

        Dim o As JObject = JObject.Parse(e.Result)

        Dim jarray As JArray = DirectCast(o("results"), JArray)

        Try
            Dim i As Integer = jarray.Count()

            For i = 0 To jarray.Count() - 1 Step 1

                Dim id As String = jarray(i)("id").ToString
                Dim name As String = jarray(i)("name").ToString
                Dim image As String = jarray(i)("image").ToString

                MessageBox.Show(name)

                Dim c As classes.consoles = New classes.consoles()
                c.categoryimage = New Uri(image)
                c.categoryname = name
                c.categoryid = id

                aList.Add(c)
            Next

            listBoxview.ItemsSource = aList
            StackPanel1.Visibility = Windows.Visibility.Collapsed
            StackPanel2.Visibility = Windows.Visibility.Visible

        Catch ex As Exception
            StackPanel2.Visibility = Windows.Visibility.Collapsed
            StackPanel1.Visibility = Windows.Visibility.Visible
        End Try

    End Sub

Private Sub ApplicationBarIconButton_Click_1(sender As System.Object, e As System.EventArgs)
    checkforconsoles()
End Sub 
```

有人知道出了什么问题吗？:(

提前致谢。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-05-16T11:42:59.137

这是 WebClient 的缓存问题。您可以附加一个随机查询字符串以确保 URL 始终是唯一的，这样 WebClient 就不会缓存结果。一种方法是添加一个随机的 GUID 值，因为它不太可能在短时间内生成两个相同的 GUID。

```
wc.DownloadStringAsync(New Uri("http://localhost/api/?function=GetConsolesForUser&
                         userid=" & id & "&random=" + Guid.NewGuid().ToString())) 
```

# sql - Upsert 是否违反单一职责原则？

> ID：10609145
> 
> 赞同：5
> 
> 时间：2012-05-15T21:33:01.710
> 
> 标签：sql, sql-server, oop, design-patterns, stored-procedures

我喜欢使用 Upsert 存储过程，如果记录存在则更新记录，如果不存在则插入记录。如果没有它们，我需要首先确定记录是否存在，然后根据结果调用两个单独的存储过程。

在今天之前，当我创建一个名为 UpdateOrDeleteRow 的存储过程时，我从未真正考虑过这个问题。当我发现自己在名称中包含“或”时，我的 SRP 蜘蛛意识就开始发挥作用，我意识到这些 upserts 基本上是一回事。

这是否违反 SRP？如果可以，是否可以接受？如果没有，我该怎么办？

我意识到 SRP 是 OOP 原则，而 T-SQL 不是 OOP 语言，但该原则的基础似乎也应该适用于此。

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-05-15T21:40:45.583

还有一个比 SRP- [DRY 更让](http://en.wikipedia.org/wiki/Don%27t_repeat_yourself)我喜欢的原则。所以，如果你在一个地方调用这个序列，你可以考虑单一责任。但是当你多次重复相同的动作序列时，DRY 让我删除重复。

顺便说一句，我想到了，你可以避免`OR`在过程/方法名称中。`UpdateOrInsert`操作有很好的名字`Save`。我认为它不会破坏 SRP。

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2012-05-15T21:46:07.320

我个人不相信这个原则完全适用于 SQL Server。存储过程并不总是只执行一个动作（我认为存储过程等同于类的概念是有缺陷的）。我认为将存储过程中的每条语句拆分为自己的存储过程是没有意义的。你会变得非常荒谬。

当然有一个平衡，否则你可能会很荒谬。您不希望存储过程具有 18 种不同的方式来指定参数，以便它可以根据组合执行 540 种不同的事情。

对于 UPSERT，我仍然建议使用单个存储过程来解决此问题。如果您想让它更好地服务于单一目的，请将您的更新/插入更改为单个`MERGE`. :-) 话虽如此，说真的，[要非常小心`MERGE`](https://www.mssqltips.com/sqlservertip/3074/use-caution-with-sql-servers-merge-statement/?utm_source=AaronBertrand).

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2012-05-16T10:30:27.263

我不同意在这种情况下应该应用主体，因为它会在您的代码隐藏中产生一些冗余代码。

首先让我们检查一下您的 UPSERT 做了什么，它检查数据是否存在，然后根据它执行 INSERT 或 UPDATE。

在代码隐藏中，您必须对数据库进行 2 次调用，具体取决于应用程序的结构，这也可能意味着打开和关闭两个连接。

因此，您在代码隐藏中有 3 个方法（一个用于执行每个 proc），然后是一个方法来调用这些方法中的每一个并执行逻辑来决定是否需要插入或更新。

您的数据库中还有 3 个单独的存储过程来执行每个操作。

对我来说，这似乎是结构糟糕的代码，因为您将向插入/更新过程传递与向 upsert 传递相同的参数，因此在一个地方完成所有这些是有意义的。

通过使用 UPSERT，您有 1 个存储过程，并且只需要一个连接，其中一种方法可以从代码隐藏中调用。我认为这会产生更好、更简洁的代码。

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2012-05-15T21:38:07.690

如果您已经有独立执行更新或删除操作的过程，希望记录用于审计目的，您可以让您的 upsert 过程单独调用它们。这样，即使从多个位置调用它们，也只有那些 proc 正在做有助于保持事情可控的工作。

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2012-05-15T21:39:30.493

单一责任原则说，一个对象应该只有一个改变的理由。Upsert 存储过程应该更改的唯一原因是表结构是否更改。因此，我认为您可以创建 upsert 存储过程。

# ruby-on-rails - rails 3 渲染错误 div_for？

> ID：10609147
> 
> 赞同：1
> 
> 时间：2012-05-15T21:33:10.713
> 
> 标签：ruby-on-rails, ruby, ruby-on-rails-3

我正在开发一个 on rails 3 项目，并试图在用户个人资料页面上呈现部分内容。渲染对除照片之外的所有内容都适用。当我尝试访问用户个人资料页面时，出现以下错误

> `undefined method`模型名称'为 NilClass:Class`

用户 show.html.erb

```
def show
  @user= User.find(params[:id])
  @photo = Photo.find_by_id(params[:id])
end 
```

在配置文件 show.html.erb

```
<%= content_tag :h2, "My photos" %>
<% photo = @user.photos %>
<% if photo.blank? %>
  <%= link_to 'Create photo', new_photo_path %>
<% else %>
  <%= render :partial => 'photos/photo', :locals => {:photo => @photo} %>
<% end %> 
```

这是它正在渲染的部分

```
<%= div_for photo do %>
 <table>
   <tr>
     <th>Title</th>
     <th>Date</th>
     <th>Extra</th>
   </tr>

   <tr>
     <td><%= photo.title %></td>
     <td><%= photo.date %></td>
     <td><%= photo.extra %></td>
     <td><%= link_to 'View photos', photo %></td>
   </tr>
 </table>
<% end %> 
```

关于如何摆脱此错误的任何想法或建议？提前致谢

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-05-15T21:38:44.983

抛出错误是因为 in `:locals => {:photo => @photo}`,`@photo`为 null

请注意，您发送的是列表`@user.photos`，而不是单个图像。

在这里`@photo = Photo.find_by_id(params[:id])`，您通过 id、photo_id 获取照片。我相信你想找到用户的照片

```
@photos = @user.photos 

#for only one photo, also you need to make sure its not null
@photo = @user.photos.first 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-05-15T21:53:51.750

数据库中没有此id的照片`@photo = Photo.find_by_id(params[:id])`

因此，您将`nil`对象发送到部分。如果你想显示所有用户照片，试试这个。

```
<%= content_tag :h2, "My photos" %>
<% photos = @user.photos %>
  <% if photos.empty? %>
    <%= link_to 'Create photo', new_photo_path %>
  <% else %>
    <% photos.each do |photo| %>
      <%= render :partial => 'photos/photo', :locals => {:photo => photo} %>
    <% end %>
<% end %> 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-05-16T15:31:55.027

当使用 div_for 时，注释为 nil，所以我会尝试通过迭代代码来访问它，就像我在下面所做的那样。那么照片现在应该可以访问了。

```
<% @photos.each do |photo| %>
  <%= div_for photo do %>
    Code here
  <% end %>
<% end %> 
```

# git - 如何在仍然能够推送到 dotCloud 的同时从 git repo 中排除 database.yml？

> ID：10609148
> 
> 赞同：2
> 
> 时间：2012-05-15T21:33:12.367
> 
> 标签：git, dotcloud

我想在我的一个项目上添加一个远程 git 协作者，但我不想让他访问我在 database.yml 中的密码。我知道如何 .gitignore database.yml 并相应地清除 repo，但问题是我正在将这个特定项目部署到 DotCloud，据我所知，这需要 database.yml 成为 git repo 的一部分。我现在能想到的最好的解决方案是使用 rsync 推送到 DotCloud，但我宁愿直接从 git repo 推送。任何人都知道我可以做到这一点的方法吗？

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-05-16T00:15:49.717

根据您想要做什么，您有几个不同的选择。

您可以将`database.yml`文件放在您的`.gitignore file`中，然后在使用 dotcloud push 时使用 rsync 而不是 git 来推送您的代码。

```
$ dotcloud push --all ramen 
```

使用该`--all`选项将强制上传者使用“rsync”方法，从而推送所有文件。有关更多信息，请参阅此页面。[http://docs.dotcloud.com/guides/git-hg/#pushing-uncomitted-changes](http://docs.dotcloud.com/guides/git-hg/#pushing-uncomitted-changes)

如果您需要忽略文件，那么您可以创建一个`.dotcloudignore`文件，并在此处添加要忽略的文件。

第二种更好的方法是根本不将密码放入`database.yml`文件中。将您的密码添加为环境变量，然后您的`database.yml`文件可以安全且无密码。

```
$ dotcloud var set myapp MYVAR=MYVALUE 
```

`environment.yml`然后，您可以像使用or一样引用变量`environment.json`。更多信息可以在这里找到：http: [//docs.dotcloud.com/guides/environment/#adding-environment-variables](http://docs.dotcloud.com/guides/environment/#adding-environment-variables)

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-05-15T23:57:07.870

注意 1：假设更简单的方法是在 git 中创建别名，它会自动执行 rsync：

```
git config alias.<yourcommand>; !<your script> 
```

例子：

```
git config alias.sendtocloud "! echo 'rsync' && rsync && echo pull && git pull" 
```

然后尝试：

```
git sendtocloud <continue parameters as after git pull > 
```

如果你想拥有纯 git 解决方案和至少 3 个 repos：

*   [Y]你的：（database.yml 不重要？）
*   [C]ollaborator：（没有database.yml）
*   [D]otCloud（带有原始databse.yml）

所以还有一些额外的问题：

1.  您如何与您的合作者共享存储库？（拉或推，由谁？）
2.  或者您是否有一些裸存储库来交换数据（由 [Y] 和 [C] 共享）？
3.  这是正确的，你不需要在你的回购中有 database.yml 吗？

注意 2：你可以使用 git hooks 做几乎所有你想做的事情。例如，您甚至可以在更新等之前使用一些临时分支进行管理。

注意 3：如果您的仓库中不需要 database.yml，那么您可以在 [y] 和 [D] 之前创建中间裸仓库，并使用“update”挂钩将更改转发到 [D]

# javascript - 获取触发元素

> ID：10609149
> 
> 赞同：1
> 
> 时间：2012-05-15T21:33:15.317
> 
> 标签：javascript, jquery, events, coffeescript

我的核心问题如下：

```
$('input').click (e) ->
  # do some things conditionally, depending on the event origin
  false

$('a').click ->
  $('input').click() 
```

所以问题是，我怎么知道是谁发起了这个活动。

请注意，在这两种情况下（单击输入或链接`e.target`都是相同的）。

更新：我在这里发布了上面的代码：http: [//jsfiddle.net/w7faW/1/](http://jsfiddle.net/w7faW/1/)

谢谢。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-05-15T22:52:58.460

您可以将额外的参数传递给事件处理程序 [1]：

```
$('input').click (e, triggered) ->
  if triggered then x
  false

$('a').click ->
  $('input').trigger('click', true) 
```

这允许您使用额外的参数来识别点击的来源（用户启动的或编程的），`e.target`从锚点点击中继，或将数据发送到事件处理程序。

[1] [http://api.jquery.com/trigger/](http://api.jquery.com/trigger/)

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-05-15T23:28:28.523

[`trigger`](http://api.jquery.com/trigger/)您可以在使用该函数以编程方式触发事件时传递参数：

```
$('input').click (e, target = e.target) ->
  console.log 'target:', target
  false

$('a').click (e) ->
  $('input').trigger 'click', this 
```

在那里我传递了一个`target`默认为的可选参数`e.target`，当单击链接时，链接本身作为该参数传递。然后您可以使用该参数来检查哪个是触发元素。您可以检查[此 jsfiddle](http://jsfiddle.net/nvSj6/1/)中的不同输出。

* * *

但是，鉴于这个简单的例子，我必须说这个解决方案可能有点令人困惑，我宁愿只使用相同的函数作为两个元素的点击处理程序（[jsfiddle](http://jsfiddle.net/nvSj6/2/)）：

```
$('input, a').click (e) ->
  console.log 'target:', e.target
  false 
```

或者，如果您需要为每个元素做一些不同的事情，然后为两者做一些共同的事情，您可以只使用另一个函数来实现该常见行为：

```
$('input').click (e) ->
  # Do something special for the input.
  commonClickHandler this, e

$('a').click (e) ->
  # Do something special for the link.
  commonClickHandler this, e

somethingCommon = (element, event) ->
  # Do something common for both elements. 
```

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-05-15T21:38:17.120

```
$('input').click (e) ->
      if $(@).data 'triggeredBy'?
          #do something         
      false

$('a').click (e) ->
    $('input').data 'triggeredBy', e.target
    $('input').click() 
```

可能有一种方法可以将先前的目标保存到实际的事件对象中，但无论如何我都会保存到 jQuery 数据属性中，只是为了更容易理解。基本上在触发之前将触发者附加到被触发者。这样你就可以在事后取回它。

如果您需要更具体地了解触发器（您有多个对象触发同一事件），您可以执行以下操作：

使用自定义活动更新往返行程

```
input = $('input')
thingyOne = $('#thingyOne')
thingyTwo = $('#thingyTwo')

input.on 'inputClick', (e, triggerer) ->
      that = $(@)
      if triggerer.is thingyOne
          #do something         
      else triggerer.is thingyTwo
          #do something else
      else triggerer.is that
          #do something if triggerer and triggeree are the same
      false

attachAndTrigger = (triggerer,triggeree) ->
    triggerer.on 'click', ->
        triggeree.trigger 'inputClick', triggerer  

attachAndTrigger thingyOne, input
attachAndTrigger thingyTwo, input
attachAndTrigger input, input 
```

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2012-05-15T22:03:18.783

抱歉，我不知道咖啡脚本，但这应该告诉您触发了哪个元素，如果您想了解有关该元素的更多信息，您可以检查它们的属性，例如类或 ID。

```
$('a').click(function(e) {
    var target = e.target,
        $target = $(target);

    console.log( 'This element is: ' + target.nodeName );    
    console.log( 'This class is: ' + $target.attr('class') );
    console.log( 'This ID is: ' + $target.attr('id') );
}); 
```

# directory - 其他目录中的 app.config

> ID：10609155
> 
> 赞同：0
> 
> 时间：2012-05-15T21:34:23.087
> 
> 标签：directory, app-config

Web 服务客户端 (WCF) 被编译为 DLL，然后将 dll 放入文件夹“c:\windows\assembly”......就像我现在可以说我的 DLL 在`C:\client\client.dll.config`预期中一样？

程序也有可能直接存储，问题是它从一个肯定不是那么简单的 SharePoint 工作流开始。

这听起来可能很傻，但问题听起来很简单......不幸的是，我发现一段时间后没有找到具体的解决方案。

编辑：

不知道？这是绝望，我的时间不多了，我有很多工作要做，还有这么多可笑的时间来留住我？

我在编辑文件方面发现了很多，但我不会更改它我只会更改对文件所在的另一个目录的访问...

在代理类中，我们只引用如此急切的...

```
[System.ServiceModel.ServiceContractAttribute
  (Name = "_-ASD_-CAS01D0005P0000013203", 
   Namespace = "urn:sap-com:document:sap:soap:functions:mc-style",    
   ConfigurationName = "_ASD_CAS01D0005P000001320")
] 
```

理论上必须有可能简单地改变......

我只是想把它扔到 SharePoint 文件夹中的某个地方，程序正在启动。该文件是从“C:\Windows\system32\inetsrv”启动的，但是在这个目录上，dll 可能没有访问权限，因为我仍然得到与那里没有配置文件一样的错误。

该文件是从“C:\Windows\system32\inetsrv”启动的，但是在这个目录上，dll 可能没有访问权限，因为我仍然得到与那里没有配置文件一样的错误。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-05-16T12:38:49.017

终于解决了

```
AppDomain.CurrentDomain.GetData ("APP_CONFIG_FILE"); 
```

我找不到令人上瘾的 client.dll.config，而是**SharePoint 虚拟目录**“c:\inetpub\wwwroot\wss\Virtual Directories\80\”中的 web.config 搜索。我在那里添加了信息，它工作正常！

# javascript - XDomainRequest - 不调用...不做任何事情

> ID：10609161
> 
> 赞同：3
> 
> 时间：2012-05-15T21:35:15.967
> 
> 标签：javascript, asp.net, internet-explorer, xdomainrequest

我有一个问题...我使用 jQuery ajax 调用返回 XML 的 Web 服务。jQuery ajax 的东西对除了 ie 之外的所有浏览器都非常有用。

所以对于ie浏览器，我使用的是XDomainRequest。这是代码：

```
if ($.browser.msie && window.XDomainRequest) {
    // Use Microsoft XDR
    var xdr = new XDomainRequest();
    xdr.open("get", theUserUrl);
    xdr.timeout = 95000;
    xdr.onerror = function () {
        console.log('we have an error!');
    }
    xdr.onprogress = function () {
        console.log('this sucks!');
    };
    xdr.ontimeout = function () {
        console.log('it timed out!');
    };
    xdr.onopen = function () {
        console.log('we open the xdomainrequest');
    };
    xdr.onload = function () {
        // XDomainRequest doesn't provide responseXml, so if you need it:
        var xml2 = new ActiveXObject("Microsoft.XMLDOM");
        xml2.async = false;
        xml2.loadXML(xdr.responseText);
        console.log('do we get any response text at all?: ' + xdr.responseText);
        ParseOwnershipObjects(xml2);
        //AddServiceRequestsToMap(xml2, map, spinner);
    };
    xdr.send();
} 
```

*   这个确切的代码可以在应用程序的其他地方使用不同的 url 正常工作。

    url 很好，它返回的正是浏览器中的内容（以及 jquery ajax 调用工作的原因）。需要注意的几点：

    我正在将我自己的 html/javascript 与另一个人的 asp.net 项目集成。

在`global.asax.cs`文件中，我有：

```
protected void Application_BeginRequest(object sender, EventArgs e)
{
    HttpContext.Current.Response.AddHeader("Access-Control-Allow-Origin", "*");
    HttpContext.Current.Response.AddHeader("Access-Control-Allow-Methods", "GET,OPTIONS");
} 
```

所以我不认为这是一个标题问题。

我的处理程序都没有开火。不是onprogress、ontimeout、onerror……什么都没有！我没有时间将 Web 服务转换为 JSON。

有什么想法吗？

谢谢！

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-05-16T00:04:07.403

免责声明 - 我实际上没有使用“XDomainRequest” - 当使用 jQ 时，我将数据设置为`jsonp`用于 xdomain 请求......

调试时 - 您是否使用 IE 开发工具 ( `F12`)？如果没有，错误很可能`console.log`

编辑：过失，无视这些`jsonp`东西 - 错过了你提到的部分`XML`

* * *

更新：

出于好奇，我正在尝试`XDomainRequest`。我复制了你的代码，只是为`theUserUrl`.

*   如上所述/预期，除非我运行 Internet Explorer 开发工具，否则`console`-`undefined`并且可能给人的印象是“您的处理程序都没有触发”。

*   一旦我启用了 IE 开发工具（停靠或其他），就会`xdr.onerror`触发。`we have an error`已登录 IE 控制台。因此，当出现错误时，处理程序**会***触发*。

![Internet Explorer 开发工具控制台](../Images/e37ea60983c7cb141ce8f1a15d277d86.png)

快速阅读`XDomainRequest`需要**响应**服务器具有*Access-Control-Allow-Origin*标头。我正在调用我自己的服务器，并且我知道我**没有**设置此标头，因此无需进一步调试，这将是一个很好的猜测，这`xdr.onerror`就是被解雇的原因。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-05-16T19:37:11.523

事实证明，XDomainRequest 对象没有正确处理 url 参数中的特殊字符。而不是 GET 请求，我将在 Internet Explorer 查询中使用 POST 请求。

编辑 - 我最终将 Web 服务切换为以 JSON 格式返回输出，从而消除了对 XDomainRequest 的需求。使用 JSON 也可以加快速度，我推荐它！

# c# - 时间：2019-05-10 标签：c#string padded now 希望它短

> ID：10609162
> 
> 赞同：1
> 
> 时间：2012-05-15T21:35:17.840
> 
> 标签：c#, string, padding

所以我有两个填充的字符串，但现在我希望它们显示并且 Trim() 似乎不想这样做。

```
String devicename = "".PadRight(100);

String deviceversion = "".PadRight(100);

bool isDeviceReady = capGetDriverDescriptionA(i, ref devicename, 100, ref deviceversion, 100); 
```

后来我使用如下字符串：

```
Messagebox.show("Device Name="+devicename.Trim()+" , Device Version="+deviceversion.Trim()); 
```

显示的都是“ `Device Name=name of the device`”

想法？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-05-15T21:45:21.380

你为什么要填充字符串？看起来你只是用空格填充字符串，这些空格稍后会被内容替换，但从你的问题来看，我不明白为什么这是必要的。只是有什么问题：

```
String devicename = "";
String deviceversion = "";

bool isDeviceReady = capGetDriverDescriptionA(i, ref devicename, 100, ref deviceversion, 100); 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-05-15T21:49:51.470

您可以尝试在调用返回零终止字符串的 API 函数时使用`StringBuilder`而不是。`string`您得到的行为可能源于 API 在字符串末尾写入零值（以终止它），而 .NET 将其视为包含零值的普通字符串。

或者，看看[这个讨论](http://social.msdn.microsoft.com/Forums/da/clr/thread/425105d9-ff54-404d-8039-305fff4f6b06)，它建议用`[MarshalAs(UnmanagedType.LPWSTR)]`属性注释参数。然后 PInovke 机制应该在最后自动处理零值。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-05-21T21:40:58.950

最后，这很简单。Tomas Petrick 走在了正确的轨道上。返回的字符串是一个以空字符结尾（也称为以零结尾）的字符串。然后我只需要从字符串中删除空终止符。

```
devicename = devicename.trim('\0'); 
```

# jquery - 使用 jQuery 插件挂钩

> ID：10609165
> 
> 赞同：0
> 
> 时间：2012-05-15T21:35:50.927
> 
> 标签：jquery, wordpress

我正在使用这个 jquery 来显示悬停的一些信息：

```
jQuery(document).ready(function() {
    jQuery('.promo_slider_wrapper').hover(function() {
            jQuery('.promo_slider_excerpt').animate({right: 0, opacity: 1}, 500 );
        },
        function() {
            jQuery('.promo_slider_excerpt').animate({right: -320, opacity: 1}, 500 );
    });
}); 
```

我在“Promotion Slider”Wordpress 插件上使用它，效果很好。只有客户希望信息在幻灯片加载时显示，而不是在悬停时显示。我正在使用的插件有一个在幻灯片加载时调用的“动作钩子”。动作钩子是“promoslider_content”。

那么如何使用“promoslider_content”动作挂钩来触发动画而不是我当前的“悬停”功能呢？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-05-15T23:05:46.980

如果您不需要悬停部分，那么您应该能够只包含函数内容，它将立即运行。

```
jQuery(document).ready(function() {
    jQuery('.promo_slider_excerpt').animate({right: 0, opacity: 1}, 500 );
}); 
```

但随后动画不会返回到`-320`，这通常会在您将鼠标移出时发生。您可以设置某种类型的间隔计时器来执行此操作。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-05-16T15:22:43.877

我最终通过编辑插件解决了这个问题（然后更改插件名称，这样他们就不会更新它并覆盖我的自定义）。这不是最好的解决方案，但它确实有效。

promo_slider.js（从第 161 行开始）：

```
// Add / Remove classes
currentItem.removeClass('current');
jQuery('.promo_slider_excerpt').animate({right: -260, opacity: 1}, 200 );
newItem.addClass('current');
currentSpan.removeClass('current');
newSpan.addClass('current');

// Fade in / out
currentItem.fadeOut('fast', function(){
newItem.fadeIn('fast');
jQuery('.promo_slider_excerpt').animate({right: 0, opacity: 1}, 500 );
}); 
```

# javascript - JS 改变 DOM 后如何抓取一些东西？

> ID：10609168
> 
> 赞同：7
> 
> 时间：2012-05-15T21:36:18.343
> 
> 标签：javascript, ruby, screen-scraping, nokogiri, mechanize

我正在使用 Mechanize，尽管如果 Mechanize 做不到，我对 Nokogiri 持开放态度。

我想在所有脚本加载后而不是预先加载页面。

我该怎么做？

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2013-08-14T08:03:23.060

我认为 Nokogiri、Watir 和 PhantomJs 是一个不错的选择：

`b = Watir::Browser.new(:phantomjs)`

`b.goto URL`

`doc = Nokogiri::HTML(b.html)`

生成的文档将来自脚本加载后的时间。phantomjs 很好，因为不需要加载浏览器。

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2012-05-15T21:51:13.177

Nokogiri 和 Mechanize 不是完整的 Web 浏览器，并且不在浏览器模型 DOM 中运行 JavaScript。您想使用[Watir](http://watir.com/)或[Selenium](http://seleniumhq.org/projects/remote-control/)之类的东西，它们允许您使用 Ruby 来控制实际的 Web 浏览器。

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2012-05-16T09:19:20.230

除了 watir-webdriver 和 capybara-webkit，celerity[是](http://celerity.rubyforge.org/)一个不错的选择，尽管它只是 jruby。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2012-05-15T21:46:05.963

我对机械化或nokogiri一无所知，所以我无法具体评论它们。但是，修改后获取 JavaScript 的问题我认为只能通过更多的 JavaScript 来解决。为了获取新生成的 HTML，您需要获取文档元素的 .innerHTML。这可能很棘手，因为您必须将 js 注入页面。

我所知道的唯一方法是编写一个 FireFox 插件。使用插件，您可以在页面上运行 JavaScript，即使它不是您的页面。对不起，我没有更多的帮助，我希望这有助于你走上正确的道路。

如果您对插件感兴趣，这是一个开始的地方：http://anthonystechblog.wordpress.com/category/internet/firefox/

# list - VBA分离工作表中的动态依赖列表（二）

> ID：10609169
> 
> 赞同：0
> 
> 时间：2012-05-15T21:36:20.510
> 
> 标签：list, excel, dynamic, worksheet, vba

我正在使用 7 个动态依赖列表，我认为如果我修改列表，那么自动化该过程并避免将来安排任何事情的最佳方法是 VBA 代码。

我开始处理的 VBA 代码发布在：[VBA 中分离工作表中的动态依赖列表](https://stackoverflow.com/questions/10586616/dynamic-depending-lists-in-separated-worksheets-in-vba)

该代码仅适用于前 2 个列表。

那是我的主表。我只想为黄色列的第一行选择列表：

![在此处输入图像描述](../Images/4fd14653a65ad9146de5d09b8001d2c5.png)

那是我有列表的表（它们必须是动态的）：

![在此处输入图像描述](../Images/2a96e4d12c9984d0a1e34866abbeac16.png)

我的列表之间的关系是：

*   责任人名单和站点名单与项目名单相关。
*   其他列表与站点列表相关。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-05-16T14:22:59.250

好的。我有你要找的东西。几个月前我在另一个项目中解决了这个问题。基本上，间接在这里不好，因为它不适用于动态命名范围，因为它们不会产生实际结果，只是公式引用。

首先，像这样在工作表上设置您的命名范围。以我描述的方式命名命名范围非常重要，因为这将提供代码来制作您的动态列表。另外，请注意，我只写了 X1 和 T2 的 SamplePoints。如果您选择其他选项，则在您添加这些命名范围之前，代码将不起作用。

![动态命名范围](../Images/15f6da32abe94c8e1c0285fc6890f0eb.png)

然后假设输入表设置如下：

![输入表](../Images/b0cbc24cce19888ef51a6ae205b28714.png)

将此代码放在输入表的工作表更改事件中。它所做的是获取在一个单元格中选择的值，然后附加适当的列名来提供该列表。因此，如果选择了项目 A，并且您想为项目 A 选择负责方，它将 Range("B(whatever row you on)" 中的验证设置为 A_Responsible，从而为您提供该列表。

```
Private Sub Worksheet_Change(ByVal Target As Range)

Dim wks As Worksheet
Dim strName As String, strFormula
Dim rng As Range

Set wks = ActiveSheet

With wks

    If Target.Row = 1 Then Exit Sub

    Select Case Target.Column

        Case Is = .Rows(1).Find("Project", lookat:=xlWhole).Column

            Set rng = Target.Offset(, 1)

            strName = Target.Value
            strFormula = "=" & Replace(strName, " ", "_") & "_Responsible"

            AddValidation rng, 1, strFormula

            'add any more cells that would need validation based on project selection here.

        Case Is = .Rows(1).Find("Responsible", lookat:=xlWhole).Column

            Set rng = Target.Offset(, 1)

            strName = Target.Value
            strFormula = "=" & Replace(strName, " ", "_") & "_SamplePoint"

            AddValidation rng, 1, strFormula

            'add any more cells that would need validation based on responsible selection here.

        'Case Is = add any more dependenices here ... and continue with cases for each one

    End Select

End With 
```

您还需要在工作簿某处的标准模块中使用此功能。

```
Function AddValidation(ByVal rng As Range, ByVal iOperator As Integer, _
    ByVal sFormula1 As String, Optional iXlDVType As Integer = 3, _
    Optional iAlertStyle As Integer = 1, Optional sFormula2 As String, _
    Optional bIgnoreBlank As Boolean = True, Optional bInCellDropDown As Boolean = True, _
    Optional sInputTitle As String, Optional sErrorTitle As String, _
    Optional sInputMessage As String, Optional sErrorMessage As String, _
    Optional bShowInput As Boolean = True, Optional bShowError As Boolean = True)

'==============================================
'Enumaration for ease of use
'XlDVType
'Name Value Description
'xlValidateCustom 7 Data is validated using an arbitrary formula.
'xlValidateDate 4 Date values.
'xlValidateDecimal 2 Numeric values.
'xlValidateInputOnly 0 Validate only when user changes the value.
'xlValidateList 3 Value must be present in a specified list.
'xlValidateTextLength 6 Length of text.
'xlValidateTime 5 Time values.
'xlValidateWholeNumber 1 Whole numeric values.

'AlertStyle
'xlValidAlertInformation 3 Information icon.
'xlValidAlertStop 1 Stop icon.
'xlValidAlertWarning 2 Warning icon.

'Operator
'xlBetween 1 Between. Can be used only if two formulas are provided.
'xlEqual 3 Equal.
'xlGreater 5 Greater than.
'xlGreaterEqual 7 Greater than or equal to.
'xlLess 6 Less than.
'xlLessEqual 8 Less than or equal to.
'xlNotBetween 2 Not between. Can be used only if two formulas are provided.
'xlNotEqual 4 Not equal.
'==============================================

With rng.Validation
    .Delete ' delete any existing validation before adding new one
    .Add Type:=iXlDVType, AlertStyle:=iAlertStyle, Operator:=iOperator, Formula1:=sFormula1, Formula2:=sFormula2
    .IgnoreBlank = bIgnoreBlank
    .InCellDropdown = bInCellDropDown
    .InputTitle = sInputTitle
    .ErrorTitle = sErrorTitle
    .InputMessage = sInputMessage
    .ErrorMessage = sErrorMessage
    .ShowInput = bShowInput
    .ShowError = bShowError
End With

End Function 
```

# java - 如何使用正则表达式计算元素相对于另一个元素的位置？

> ID：10609173
> 
> 赞同：4
> 
> 时间：2012-05-15T21:36:43.487
> 
> 标签：java, regex

给定字符串

```
//          1       2       3
String a = "letters.1223434.more_letters"; 
```

**我想认识到数字在第一个点之后排在第二位**

然后我想用这些知识来代替“第二位置”

```
//          1         2           3
String b = "someWords.otherwords.morewords"; 
```

用“你好”有效地使

```
//          1         2     3
String b = "someWords.hello.morewords"; 
```

必须根据 String a 中匹配元素的原始位置进行替换

请问如何使用正则表达式来完成？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-05-15T21:53:01.080

您想要做的事情在 RegExp 中无法直接实现，因为您无法访问捕获组的编号并在替换操作中使用它。

两种选择：

*   如果您可以使用任何编程语言：将使用正则表达式拆分为组。检查每个组是否符合您的数字标识符条件。将 b 字符串分成组。替换对应的匹配项。

*   如果您只想使用多个正则表达式，那么您可以使用唯一的分隔符（比如说 |）连接 a 和 b。然后匹配`.*?\.\d+?\..*?|.*?\.(.*?)\..*?`和替换`$1`。您需要在第一个位置、第二个位置、第三个位置的三个变体中应用这个正则表达式。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-05-16T00:30:07.600

为了找到这些数字，您可以使用组机制（正则表达式中的圆括号）：

```
import java.util.regex.*;

...

String data = "letters.1223434.more_letters";
String pattern="(.+?)\\.(.+?)\\.(.+)";
Matcher m = Pattern.compile(pattern).matcher(data);
if (m.find()) //or while if needed
    for (int i = 1; i <= m.groupCount(); i++) 
    //group 0 == whole String, so I ignore it and start from i=1
        System.out.println(i+") [" + m.group(i) + "] start="+m.start(i));
// OUT:
//1) [letters] start=0
//2) [1223434] start=8
//3) [more_letters] start=16 
```

但是，如果您的目标只是替换两个点之间的文本，请尝试`replaceFirst(String regex, String replacement)`使用 String 对象上的方法：

```
//find ALL characters between 2 dots once and replace them 
String a = "letters.1223434abc.more_letters";
a=a.replaceFirst("\\.(.+)\\.", ".hello.");
System.out.println(a);// OUT => letters.hello.more_letters 
```

`regex`告诉搜索两个点之间的所有字符（包括这些点），所以`replacement`应该是“.hello”。（带点）。

如果您的字符串将有更多点，它将替换第一个和最后一个点之间的所有字符。如果您希望正则表达式搜索满足模式所需的最少字符数，您需要使用 Reluctant Quantifier ->`?`像：

```
String b = "letters.1223434abc.more_letters.another.dots";
b=b.replaceFirst("\\.(.+?)\\.", ".hello.");//there is "+?" instead of "+"
System.out.println(b);// OUT => letters.hello.more_letters.another.dots 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-05-15T21:45:43.373

字符串 a 的正则表达式是

```
\w+\.(\d+)\.\w+ 
```

使用匹配组来抢号码。

第二个的正则表达式是

```
\w+\.(\w+)\.\w+ 
```

获取第二个字符串的匹配组。

然后使用这样的代码来做你喜欢的比赛。

```
Pattern pattern = Pattern.compile(patternStr);
Matcher matcher = pattern.matcher(inputStr);
boolean matchFound = matcher.find(); 
```

其中 patternStr 是我上面提到的模式， inputStr 是输入字符串。

您可以使用它的变体来尝试您想要的每种组合。所以你可以将匹配组移动到第一个位置，试试看。如果它返回匹配项，则在第一个位置的第二个字符串中进行替换。如果没有，请转到位置 2，依此类推...

# logback - 如何禁用在日志文件中打印 Logback 模式

> ID：10609176
> 
> 赞同：1
> 
> 时间：2012-05-15T21:36:54.677
> 
> 标签：logback

我注意到[Logback](http://logback.qos.ch/)会在每个日志文件的顶部打印用于格式化日志条目的模式。

例如，我在每个日志文件的顶部看到这个：

```
#logback.classic pattern: %d [%t] %-5p %c - %m%n 
```

我怎样才能禁用它？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-05-18T23:16:19.540

好的，我发现问题已[在 logback-user mailing list 上得到解答](http://mailman.qos.ch/pipermail/logback-user/2012-May/003103.html)。

我添加了这个：

```
<outputPatternAsPresentationHeader>false</outputPatternAsPresentationHeader> 
```

到`<encoder>`元素，在元素下面`<pattern>`，我的问题就解决了！

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-05-19T13:37:39.670

设置`outputPatternAsPresentationHeader`为 false 将起作用。但是，该问题在[logback](/questions/tagged/logback "显示标记为“logback”的问题")版本 1.0.3 中`outputPatternAsPresentationHeader`得到解决，默认设置为 false。

# google-maps-api-3 - “数据可能仍在加载中”......但它已经在那里了？

> ID：10609186
> 
> 赞同：0
> 
> 时间：2012-05-15T21:37:48.483
> 
> 标签：google-maps-api-3, google-fusion-tables

所以我正在运行这段代码，所有的点都显示得很好。但我仍然得到“数据可能仍在加载”图块。我已经仔细检查了表 ID、地理编码、列名等......所以现在我很茫然。有人以前经历过吗？

```
function changeByZip(formResults) {
    geocoder.geocode( { 'address': formResults }, function(results, status) {
        if (status == google.maps.GeocoderStatus.OK) {
            map.setCenter(results[0].geometry.location);
            map.setZoom(13);
            layer.setQuery("SELECT 'Address' FROM " + tableid + " WHERE 'Zip' = '" + formResults + "'");
            layer2.setQuery("SELECT 'Address' FROM " + tableid2 + " WHERE 'Zip' = '" + formResults + "'");
        } 
    });
} 
```

我有两层，因为我有大约 14,000 点。当我注释掉其中任何一个图层时，数据加载图块就会消失并按预期显示。出于某种原因，这两层彼此不喜欢？

提前致谢。

编辑：我发现列名与查询所查找的不同。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-05-16T03:39:12.043

请看一下这个链接：

[https://developers.google.com/fusiontables/docs/troubleshooting](https://developers.google.com/fusiontables/docs/troubleshooting)

根据故障排除指南：

**地图图块“数据可能仍在加载”消息无法解决**

原因：*Fusion Tables 无法理解 FusionTableLayer 中的查询。有几件事要尝试：*

*   检查查询对象语法。任何语法错误都可能触发此错误消息。要解决它，请修复您的 Fusion Tables Layers 语法。请参阅 Google Maps Javascript API V3 Reference 和 Google Maps Javascript API Layers 中的 FusionTableLayer 文档
*   检查表 ID。仔细检查您使用的表 ID 是否正确。
*   检查列名。列名区分大小写，因此“Zipcode”和“zipcode”不一样。多词列名需要用单引号括起来。请参阅 Fusion Tables SQL API：参考。
*   检查您的地理编码。Fusion Tables 必须先了解表中的位置，然后才能映射它们。表中的位置描述（例如地址）必须进行地理编码。请参阅 Fusion Tables 开发人员指南中的“地理编码位置描述”。

# php - 使用正则表达式从字符串中获取文本

> ID：10609187
> 
> 赞同：0
> 
> 时间：2012-05-15T21:38:02.713
> 
> 标签：php, regex

我有以下字符串：

```
         苹果 香蕉 橙子
我 1 2 3  
兄弟 4 4 5

```

我需要一个正则表达式来获取我们每个人“我和我的兄弟”拥有的苹果、香蕉和橙子的数量。

请帮助我，我在这里完全一无所知。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-05-15T22:15:51.830

你可能想要一些这样的代码：

```
$string = file('input.txt');
$headers = array();
$results = array();
foreach($string as $i => $line) {
    preg_match_all('@(\w+)@', $line, $matches);
    if (!$i) {
        $headers = $matches[0];
    } else {
        $name = array_shift($matches[0]);
        $results[$name] = array_combine($headers, $matches[0]);
    }   
}   
print_r($results); 
```

这将导致：

```
Array
(   
    [Me] => Array
        (   
            [Apples] => 1
            [Bananas] => 2
            [Oranges] => 3
        )   

    [Brother] => Array
        (   
            [Apples] => 4
            [Bananas] => 4
            [Oranges] => 5
        )   

) 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-05-15T21:53:16.400

大致

```
$regexp = "/([\w]+) +([\d]+) +([\d]+) +([\d]+)/";
$matches = array();
preg_match($regexp, $yourDataSet, $matches); 
```

根据您使用的是 1 个长字符串还是带有换行符的字符串，您可以在正则表达式的最后一个 / 之前添加 \n 并使其更精确。

# x86 - 如何使用 SSE 计算某个范围内的字节数？

> ID：10609188
> 
> 赞同：2
> 
> 时间：2012-05-15T21:38:02.757
> 
> 标签：x86, sse, simd

我想编写一个 ac 程序来计算一个范围内的字节数`a`......`c`用下面的代码：

```
char a[16], b[16], c[16];  
int counter = 0; 
for(i = 0;  i < 16; i++)  
{  
  if((a[i] < b[i]) && (b[i] < c[i]))  
  counter++;  
}  
return counter; 
```

我打算做这样的事情

```
__m128i result1 = _mm_cmpgt_epi8 (b, a);  
__m128i result2 = _mm_cmplt_epi8 (b, c);  
unsigned short out1 = _mm_movemask_epi8(result1);  
unsigned short out2 = _mm_movemask_epi8(result2);  
unsigned short out3 = out1 & out2;  
unsigned short out4 = _mm_popcnt_u32(out3); 
```

我的方法正确吗？有没有更好的方法来做到这一点？

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-05-15T21:55:20.983

你的方法看起来很合理。我认为您可以通过在 SIMD 寄存器中执行 AND 来保存指令，如下所示：

```
__m128i result1 = _mm_cmpgt_epi8 (b, a);
__m128i result2 = _mm_cmplt_epi8 (b, c);
__m128i mask = _mm_and_si128(result1, result2);
int mask2 = _mm_movemask_epi8(mask);
int counter = _mm_popcnt_u32(mask2); 
```

# java - 通过使用 BAT 文件执行 Jar 文件

> ID：10609189
> 
> 赞同：0
> 
> 时间：2012-05-15T21:38:04.203
> 
> 标签：java, jar, batch-file, executable-jar

我创建了一个只有固有 Java 依赖项（`java.io`等）的简单类。我已经在同一个文件夹中设置了我的 jar 文件和 bat 文件。BAT 简单地写道：

```
java -jar "MyApp.jar"
pause 
```

我已经能够从我计算机上的几个不同位置运行它。但是当我将它作为 zip 文件发送给同事时，他无法通过双击 BAT 文件来运行它。

命令窗口返回错误

```
could not find the main class: MyApp.MyApp. Program will exit. 
```

我已经浏览了这个站点，但大多数类似的错误都涉及在同一台计算机上使用。是的，另一台计算机已安装 Java 6.29

非常感谢任何帮助。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-05-15T21:41:40.487

我能想到的两个选项：

1）他可能没有将它们都解压缩到同一个目录（或）在解压缩之后，他可能已经将 JAR 文件移动到另一个位置。

2）他的类路径不包括当前目录。你的类路径有一个“。” （表示当前目录）而他没有。如果是这种情况，您可能可以修改您的命令以包含“-cp”开关。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-05-15T21:44:03.197

为了以这种方式运行 jar，您需要在其中有一个 META-INF 文件夹，其中包含一个清单文件。清单文件需要一个主类行，该行使用 main() 指向您的类。您的 IDE 可能添加了这一点，但可能在提取内容的过程中，他也解压缩了 jar 文件，或者类似的“有趣”内容。

[http://docs.oracle.com/javase/tutorial/deployment/jar/appman.html](http://docs.oracle.com/javase/tutorial/deployment/jar/appman.html)

# java - 为什么在尝试创建 JDOM 文档时得到 DeferedDocumentImpl？

> ID：10609200
> 
> 赞同：0
> 
> 时间：2012-05-15T21:39:41.520
> 
> 标签：java

我试图从 zipfile zip 条目解析输入流并尝试创建 org.w3c.dom.Document 但由于某种原因我得到了 DeferedDocumentImpl 回来。我还创建了一个新的 org.w3c.dom.Document，这将返回一个 DocumentImpl。然后使用 Xpath 选择单个节点，但是当我尝试查找我的特定节点时出现此错误“org.apache.xerces.dom.DocumentImpl 与 org.jdom.Element 不兼容”。我做了一些搜索，但似乎无法找到示例。任何人都知道为什么我没有将我的文档创建为 dom 文档？在此先感谢您的帮助。

```
 //create a zip file from the crate location
        File downloadFile = crate.getLocation();
        ZipFile zipFile = new ZipFile(downloadFile);

        //put all the contents of the zip file into an enumeration
        Enumeration entries = zipFile.entries();

        while (entries.hasMoreElements()){
            ZipEntry entry = (ZipEntry) entries.nextElement();
            String currentEntry = entry.getName();

            if (currentEntry.equals("ATTACH 8130-3 XML/signature.xml")){
                InputStream zipStream = zipFile.getInputStream(entry);
                DocumentBuilderFactory dbFactory = DocumentBuilderFactory.newInstance();
                DocumentBuilder dBuilder = dbFactory.newDocumentBuilder();
                org.w3c.dom.Document doc = (org.w3c.dom.Document)dBuilder.parse(zipStream);
                doc.getDocumentElement().normalize();
                NodeList certNode = doc.getElementsByTagName("ATA_PartCertificationForm");
                int testInt = certNode.getLength();
                org.w3c.dom.Document doc2 = (org.w3c.dom.Document) dBuilder.newDocument();
                Node parentNode = doc.getParentNode();
                Element rootElement = doc2.createElement("CurrentCertificate");
                doc2.appendChild(rootElement);
                for(int i=0; i<certNode.getLength(); i++){
                    Node childNode = certNode.item(i);
                    Element childElement;
                    childElement = (Element)certNode.item(i);
                    rootElement.appendChild(doc2.importNode(childNode, true));
                    String nameString = childNode.getNodeName();
                    Element block13Element = (Element) XPath.selectSingleNode(doc2, "//Block13M");
                    System.out.println("tester test");
                }
                System.out.println("Test break");

            }
        } 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-05-15T22:29:54.980

您将 org.w3c.dom.Document 传递给 jdom.xpath.XPath.selectSingleNode()，但该方法需要 org.jdom.Document 或 org.jdom.Element。

这是将 XML 解析为 JDOM 文档并使用 Jaxen 执行 XPath 查询的一种方法，该查询也必须位于类路径中。

```
import org.jdom.Document;
import org.jdom.Element;
import org.jdom.JDOMException;
import org.jdom.input.SAXBuilder;
import org.jdom.xpath.XPath;

import java.io.IOException;
import java.io.InputStream;
import java.util.List;

public class JdomXpathSandbox {
    public static void main(String[] args) throws Exception {
        InputStream is = ...;
        Document document = new SAXBuilder().build(is);
        Element rootElement = document.getRootElement();

        String xpathExpression = ...
        List matchingNodes = XPath.selectNodes(rootElement, xpathExpression);
    }
} 
```

# jquery - Qaptcha - 它有效吗？

> ID：10609201
> 
> 赞同：20
> 
> 时间：2012-05-15T21:39:41.710
> 
> 标签：jquery, security, captcha

在此处查看 JQuery Qaptcha 的演示 - [http://www.myjqueryplugins.com/QapTcha/demo](http://www.myjqueryplugins.com/QapTcha/demo)

它需要您滑动滑块来解锁并证明您是人类。我已经阅读了所有关于它如何设置随机字段值并删除它们的信息，但不是所有这些都是通过 javascript 调用完成的吗？如果是这样，那么机器人不是只需要运行javascript方法然后qaptcha就坏了吗？

帮助我了解这是如何安全的...

* * *

## 回答 #1

> 赞同：44
> 
> 时间：2012-05-15T22:31:25.253

不幸的是，这似乎*不是*一个安全的验证码。

在这篇文章的最后是一些可以绕过它的示例代码。我写了这个脚本，没有查看他们的任何源代码（php 或 javascript）。我只是嗅探了几个 HTTP 请求，看到了它在做什么并试图模仿它。我现在查看了他们的 JS 代码，但仍然没有查看 PHP，所以即使没有看到任何源代码，也可以绕过它。

我根据成功和失败快速猜测它是如何工作的：

*   你在他们的页面上加载表单，一个 PHP 会话被创建，可能没有数据。
*   加载一个生成 qaptcha_key 并将其附加到表单的 JS 脚本。
*   此密钥由 JavaScript 创建，尚未存储在服务器上。
*   您将滑块向右移动，jQuery 通过 Ajax 将“qaptcha_key”发布到 PHP，然后密钥存储在会话中（密钥不是秘密的）。
*   如果您移动滑块，您提交的表单包含先前通过 Ajax 发送的 qaptcha_key。
*   如果会话中存在匹配的 qaptcha_key（通过移动滑块），则该表单被视为有效。如果不存在这样的键，他们会假设您没有移动滑块（或禁用 JS），并且由于会话不包含 qaptcha_key，因此表单无效。

它可以变得更安全吗？在我看来并不容易。为了安全，秘密必须存储在服务器上，并且不能通过任何脚本或对服务器的 HTTP 请求轻易获得。也就是说，根据一些公共值发出 Ajax 请求来验证自己仍然可以使用 Ajax 或 HTTP 请求进行欺骗，如下面的示例。基本上，验证码解决方案必须存储在服务器上，并由人（希望不是计算机）解释并发送回服务器。

这是您可以运行以绕过它的代码。基本上，如果你运行它，你会看到：

```
Form can be submited
First Name : A Test
Last Name : Of Qaptcha 
```

在结果输出中。正如您在代码中看到的那样，我只是一遍又一遍地使用相同的键。密钥是什么并不重要，因为客户端会通知服务器密钥，当您提交表单时，Qaptcha 只会检查与表单一起提交的值是否与 PHP 会话中存储的值匹配。因此键的值是无关紧要的，你只需要在提交表单之前告诉服务器它是什么。

我怀疑垃圾邮件发送者对 Qaptcha 表单实施广泛使用的绕过并将其集成到他们的蜘蛛中只是时间问题。

## 概念证明：

```
<?php

$COOKIE_FILE = '/tmp/cookies.txt';  // The cookie file to use for storing the PHP session ID cookie
$FIRST_NAME  = 'A Test';            // first name to send
$LAST_NAME   = 'Of Qaptcha';        // last name to send

if (file_exists($COOKIE_FILE)) unlink($COOKIE_FILE); // clear cookies on start - just prevents re-using the same PHPSESSID over and over

$fake_qaptcha_key = 'thisIsAFakeKey12345';  // arbitrary qaptcha_key - normally generated by client JavaScript

// fetch the form - this creates a PHP session and gives us a cookie (yum)
$first = fetch_url('http://demos.myjqueryplugins.com/qaptcha/');

// This step is important - this stores a "qaptcha_key" in the PHP session that matches our session cookie
// We can make the key up in this step, it doesn't matter what it is or where it came from
$params = array('action' => 'qaptcha', 'qaptcha_key' => $fake_qaptcha_key);
$second = fetch_url('http://demos.myjqueryplugins.com/qaptcha/php/Qaptcha.jquery.php', 'POST', $params);

// Now submit the form along with the same qaptcha_key we told the server about in the last step
// As long as a form field is submitted that has the same name as the qaptcha_key we just told the server about, the captcha is bypassed
$params = array('firstname' => $FIRST_NAME, 'lastname' => $LAST_NAME, $fake_qaptcha_key => '', 'submit' => 'Submit Form');
$third  = fetch_url('http://demos.myjqueryplugins.com/qaptcha/', 'POST', $params);

// echo the contents so you can see it said form was accepted.
echo $third;

// basic function that uses curl to fetch a URL with get/post
function fetch_url($url, $method = 'GET', $params = array())
{
    $ch = curl_init($url);
    curl_setopt($ch, CURLOPT_COOKIEJAR, $GLOBALS['COOKIE_FILE']);
    curl_setopt($ch, CURLOPT_COOKIEFILE, $GLOBALS['COOKIE_FILE']);
    curl_setopt($ch, CURLOPT_RETURNTRANSFER, 1);

    if ($method == 'POST') {
        curl_setopt($ch, CURLOPT_POST, 1);
        curl_setopt($ch, CURLOPT_POSTFIELDS, http_build_query($params));
    }

    $return = curl_exec($ch);

    return $return;
} 
```

我希望这能清楚地回答你的问题。

# javascript - 通过 json 检索动态数据

> ID：10609202
> 
> 赞同：1
> 
> 时间：2012-05-15T21:39:44.677
> 
> 标签：javascript, jquery, json

我有一个逻辑思维问题。我通过 json 从 php 文件中检索数据，一切正常。

但现在我有一个小问题。我想检索一些头条新闻。有主标题和副标题。每个主标题都有（未知）数量的子标题。

现在我想把这些标题全部打包成一个数组，通过json发送到一个javascript，然后把主标题用另一种颜色作为副标题，但副标题应该显示在主标题下面。

那么我应该如何将值打包到数组中，然后解包呢？我已经使用了每个功能（用于解包），但目前我很难找到一个成功的解决方案。

希望你能给我一些提示。

提前致谢。最好的问候，约翰

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-05-15T21:48:57.147

在不了解数据结构的情况下：

```
<?php

$headlines = array(
    'title' => 'Headline Title'
    'subheadlines' => array(
        array(
            'title' => 'Sub Headline Title'
        )
    )
);

?> 
```

这就是我构建 PHP 数组的方式。

然后使用 jQuery 的 $.each() 函数：

```
headlines = data.parseJSON();

$.each(headlines, function(i, headline) {

    var headline_title = headline.title;
    var subheadlines = headline.subheadlines;

    $.each(subheadlines, function(k, subheadline) {

        var subheadline_title = subheadline.title;

    });

}); 
```

# javascript - 如何通过 javascript REST 客户端处理 Neo4j 服务器中的索引？

> ID：10609203
> 
> 赞同：0
> 
> 时间：2012-05-15T21:39:53.787
> 
> 标签：javascript, node.js, rest, neo4j, d3.js

我在独立的 Neo4j REST 服务器中有数据，包括节点索引。我希望纯 JavaScript 客户端连接到 Neo4j 并将格式化数据提供给 d3.js，这是一个基于 Node.js 构建的可视化库。

JugglingDB 非常流行，但 Neo4j 实现“错误”：[https ://github.com/1602/jugglingdb/issues/56](https://github.com/1602/jugglingdb/issues/56)

github 上的下一个最受欢迎的选项是：[https](https://github.com/thingdom/node-neo4j) ://github.com/thingdom/node-neo4j 查看方法定义[https://github.com/thingdom/node-neo4j/blob/develop/lib/GraphDatabase._coffee](https://github.com/thingdom/node-neo4j/blob/develop/lib/GraphDatabase._coffee)

我可以使用“getNodeById: (id, _) ->”

```
> node1 = db.getNodeById(12, callback); 
```

返回来自 REST 服务器的输出，包括节点属性。惊人的。

我不知道如何使用“getIndexedNodes：（索引，属性，值，_）->”

```
> indexedNodes = db.getIndexedNodes:(index1, username, Homer, callback);
... 
```

indexedNodes 没有被定义。我尝试了几种不同的组合。没有喜悦。我如何使用这个命令？

此外， getIndexedNodes() 需要一个键值对。有没有办法在不循环的情况下获取索引中的所有项目或项目的子集？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-05-16T12:54:13.687

node-neo4j 的作者/维护者之一。=)

> indexedNodes 没有被定义。我尝试了几种不同的组合。没有喜悦。我如何使用这个命令？

您的示例似乎有一些语法错误。和变量是否`index1`在别处定义？假设不是，即假设它们是实际的索引名称、属性名称和值，则需要将它们引用为字符串文字，例如，和。但是您在不应该存在的左括号之前也有一个冒号。（这就是导致 Node.js REPL 无法理解您的命令的原因。）`username``Homer``'index1'``'username'``'Homer'`

然后，注意`indexedNodes` **应该**是`undefined`-- `getIndexedNodes()`，像大多数 Node.js API 一样，是异步的，所以它的返回值是`undefined`. 因此回调参数。

您可以查看示例[node-neo4j-template](https://github.com/aseemk/node-neo4j-template)`getIndexedNodes()`应用程序中如何使用自述文件引用的示例：

[https://github.com/aseemk/node-neo4j-template/blob/2012-03-01/models/user.js#L149-L160](https://github.com/aseemk/node-neo4j-template/blob/2012-03-01/models/user.js#L149-L160)

> 此外， getIndexedNodes() 需要一个键值对。有没有办法在不循环的情况下获取索引中的所有项目或项目的子集？

`getIndexedNodes()`确实返回所有匹配的节点，因此不需要循环。Neo4j 的 REST API 不直接支持获取子集，但您可以使用[Cypher](http://docs.neo4j.org/chunked/stable/cypher-query-lang.html)获得结果。

例如，返回按用户名字母顺序排序的第 6-15 个用户（假设他们有一个`type`属性设置为）：`user`

```
db.query([
  'START node=node:index1(type="user")',
  'RETURN node ORDER BY node.username',
  'SKIP 5 LIMIT 10'
].join('\n'), callback); 
```

不过，Cypher 仍在快速发展，因此请务必参考与您正在使用的 Neo4j 版本匹配的文档。

如上所述，一般来说，看一下示例[node-neo4j-template](https://github.com/aseemk/node-neo4j-template)应用程序。它涵盖了库公开的以及典型应用程序需要的广泛功能。

希望这可以帮助。=)

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2014-08-11T14:49:09.360

Neo4j 2 允许您通过 REST 进行索引。文档在这里

[休息指数](http://docs.neo4j.org/chunked/stable/rest-api-unique-indexes.html)

# jquery - jQuery - 环绕所选文本 - 重复实例错误

> ID：10609206
> 
> 赞同：4
> 
> 时间：2012-05-15T21:39:57.470
> 
> 标签：jquery, cursor-position, string-length, replace

这个问题指的是一个类似的问题[，这里](https://stackoverflow.com/questions/2236982/jquery-select-text-and-add-span-to-it-in-an-paragraph)询问如何将标签应用于选定的文本。该问题已得到回答，但该答案有一个主要缺陷，即如果所选文本存在于文档的其他地方，则`<span>`环绕副本，而不是有问题的文本。

我意识到这可能违反了一些 stackoverflow 协议，但我在这里发帖时没有关于如何继续的真正线索。我最好的猜测是以某种方式找到所选文本之前的字符串长度（[沿着这些线](http://javascript.nwbox.com/cursor_position/)），但是如何将其合并到替换函数本身......好吧我可以使用推送。任何人？

（我已将解决方案粘贴到下面的上一篇文章（由[mathias-bynens 撰写](https://stackoverflow.com/users/96656/mathias-bynens)）。）

```
 $("p").live("mouseup",function() {
    selection = getSelectedText();
    if(selection.length >= 3) {
        var spn = '<span class="selected">' + selection + '</span>';
        $(this).text($(this).html().replace(selection, spn));

    }
});

//Grab selected text
function getSelectedText(){
    if(window.getSelection){
        return window.getSelection().toString();
    }
    else if(document.getSelection){
        return document.getSelection();
    }
    else if(document.selection){
        return document.selection.createRange().text;
    }
} 
```

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2013-02-23T08:14:52.810

我作弊了，用 document.execCommand 包裹选中的文本，然后用 href（CreateLink execCommand 的第三个参数）找到元素，用我想要的包裹它，然后删除链接：

```
$("p").live("mouseup",function() {
    document.execCommand('CreateLink', false, 'uniqueid');
    var sel = $('a[href="uniqueid"]');
    sel.wrap('<span class="selected" />')
    sel.contents().unwrap();
}); 
```

所有主要浏览器都支持 document.execCommand，因此您应该安全地以这种方式破解它。在我测试过的浏览器中，浏览器本身会为您关闭和打开标签，因此如果您从一个 html 标签的中间选择另一个 html 标签的中间，它应该正确嵌套标签。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-05-15T21:50:00.750

我认为您的关键是弄清楚 getSelection 返回并使用它。

在 Firefox 上，我能够做到这一点：

```
$(document.getSelection().anchorNode).wrap('<div style="color:blue">') 
```

document.selection.createRange() 必须有一个类似的东西，可以让你找到被选中的东西。

所以像：

```
$("p").live("mouseup",function() {
    var $sel = getSelectedElem();
    if($.trim($sel.text()).length >= 3) {
        $sel.warp('<span class="selected">');
    }
});

//Grab selected text
function getSelectedElem(){
    if(window.getSelection){
        return $(window.getSelection().anchorNode);
    }
    else if(document.getSelection){
        return $(document.getSelection().anchorNode)
    }
    else if(document.selection){
        //todo figure out what to return here:
        return document.selection.createRange().text;
    }
    return $([]);
} 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2014-12-12T06:27:34.680

那这个呢？

```
document.execCommand("insertHTML", false, "<span class='own-class'>"+ document.getSelection()+"</span>"); 
```

[来源](https://stackoverflow.com/questions/16529316/javascript-document-execcommand-own-tags)[YeppThat'sMe](https://stackoverflow.com/users/787999/yeppthatsme) _

# php - 提交 AJAX 表单后获取访问者的 IP 地址

> ID：10609212
> 
> 赞同：10
> 
> 时间：2012-05-15T21:40:09.200
> 
> 标签：php, javascript, jquery

我有一个 HTML 表单。当访问者提交表单时，会调用一个 javascript 方法。此方法向我的服务器的 php 文件发送 AJAX 请求。我的问题是我需要获取访问者的 IP 地址。但是由于 AJAX 请求调用 php 文件，**$_SERVER['REMOTE_ADDR']**给了我我的服务器地址。在这种情况下，我如何获取访问者的 ip？谢谢

```
<form onsubmit="sendData(); return false;">
    // some data here
</form>

function sendData(){
    // do some work, get variables
    $.ajax({
        url:"/mypage.php",
        type:"GET",
        data: { name: e },
        success : function(data) {
           // do some work
        },
        error: function (xhr, ajaxOptions, thrownError) {
        }
    })
}

// in mypage.php
public function useData() {
        $name=$_GET["name"];
        $ip = $_SERVER['REMOTE_ADDR'];
} 
```

* * *

## 回答 #1

> 赞同：28
> 
> 时间：2012-05-15T21:43:03.020

`$_SERVER['REMOTE_ADDR']`会给你客户端的IP地址。但是，由于大概您使用的是与服务器**和**客户端相同的机器，因此您获得了相同的 IP，这是正常的。一旦您将网站托管到 Web 服务器并从另一台机器远程访问它，您将获得该远程机器的地址。

因此，您无需再做任何事情。您的代码已经按预期工作。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-05-15T21:42:29.650

ajax 请求仍然来自客户端，它应该给客户端 IP 而不是服务器。

# gradle - Gradle - 将 zip 解压缩到特定目录

> ID：10609214
> 
> 赞同：1
> 
> 时间：2012-05-15T21:40:20.510
> 
> 标签：gradle

我的 gradle 构建脚本中有一个 zip 文件作为依赖项。我能够从中提取和引用文件，但它被提取到我的构建目录中的文件夹中（我猜这是默认行为）。是否可以更改此行为并使 gradle 将 zip 解压缩到我选择的目录中？例如，我想将 zip 解压缩到项目根目录下的文件夹中。

预先感谢您的帮助。

这是代码片段：

`FileCollection ZipFiles = files(configurations.new_config.findAll { it.name.endsWith('.zip') })
FileCollection zipFileContents = files(ZipFiles.collect { zipTree(it) })
return files(zipFileContents.findAll { it.name.endsWith('.jar') })`

实际上我在一个函数中有这个。最后一行仅返回 zip 中的 jar 文件。之前的行进行提取。

# ruby-on-rails - 为什么 PostgreSQL 告诉我模式不存在？

> ID：10609217
> 
> 赞同：2
> 
> 时间：2012-05-15T21:41:03.550
> 
> 标签：ruby-on-rails, unit-testing, postgresql, rake

我在使用 Rails 进行敏捷 Web 开发（第 4 版）的第 7 章，当我运行 rake test:units 时，我收到以下错误：

```
rake aborted!
PG::Error: ERROR: invalid value for parameter "search_path": "public" 
DETAIL: schema "public" does not exist
: SET search_path TO public

Tasks: TOP => db:test:load => db:test:purge
(See full trace by running task with --trace) 
```

我在装有 OSX 10.7.4 的 MacBook Pro 上。我有 Ruby 1.9.3、Rails 3.1.0、Rake 0.9.2.2 和 PostgreSQL 9.1。我的生产、开发和测试数据库都存在，已迁移到并匹配我的 config/database.yml 文件中的名称、用户和密码。所有这些的架构都是公开的。

谁能帮我？

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-09-13T13:06:14.723

确保您的用户默认数据库具有公共架构。

例如，如果您使用用户“postgres”连接到数据库，那么应该有一个名为“postgres”的数据库，其模式名为“public”。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-07-31T09:33:49.437

来自[http://www.postgresql.org/docs/9.1/static/infoschema-schemata.html](http://www.postgresql.org/docs/9.1/static/infoschema-schemata.html)（强调我自己的）：

> 视图模式包含当前数据库**中由当前启用的角色拥有的**所有模式。

`postgres`如果您与默认用户 ( )以外的用户连接，则`public`架构可能不会显示。（是的，即使该用户创建并拥有数据库，`public`架构也归`postgres`[1] 所有。）

[1] [http://archives.postgresql.org/pgsql-general/2008-10/msg01320.php](http://archives.postgresql.org/pgsql-general/2008-10/msg01320.php)

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-05-15T22:28:38.450

根据错误消息，架构`public`不存在。你检查过，它在那里吗？它只是另一个可以像其他任何模式一样被删除的模式。

# java - iText 表格未呈现

> ID：10609220
> 
> 赞同：-2
> 
> 时间：2012-05-15T21:41:08.833
> 
> 标签：java, itext

我正在尝试从以列表为值的地图开始制作表格。每个列表中有 2 个字符串

```
public class Table{

    public static PdfPTable createTable( HashMap<Integer,List<String>> map ){   

        PdfPTable table = new PdfPTable(2); // 2 is the number of columns 

        for( int i = 1 ; i == map.size() ; i++ ){ 
             PdfPCell leftCell  = new PdfPCell(new Paragraph(map.get(i).get(0))); 
             PdfPCell rightCell = new PdfPCell(new Paragraph(map.get(i).get(1))); 

             table.addCell( leftCell ); 
             table.addCell( rightCell ); 
        }

        return table; 
    }
} 
```

我确定数据在地图中，但表格似乎是空的。有什么建议么？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-05-15T21:56:43.640

您的 for 循环不正确：

```
for ( int i = 1 ; i == map.size() ; i++ ) 
```

你想要什么

```
for ( int i = 1 ; i <= map.size() ; i++ ) 
```

# html - Chrome 与 FF 按钮点击行为

> ID：10609221
> 
> 赞同：13
> 
> 时间：2012-05-15T21:41:09.900
> 
> 标签：html, css, button, cross-browser, click

我在按钮上使用 :active 伪类来更改单击时的填充和边框颜色。这在视觉上模仿了按钮按下。[看一个例子。](http://jsfiddle.net/uPZuJ/4/)

在FF工作。但是，在 Chrome 中，点击并不总是注册。具体来说，如果您单击并按住按钮内的文本，然后拖出文本（但仍在按钮内），则不会触发单击。如果您单击填充，然后拖动到文本中，也是如此。

我读过关于 FF 与 Chrome 中的按钮和填充的奇怪内容，但我不知道如何解决这个问题。

* * *

## 回答 #1

> 赞同：14
> 
> 时间：2012-05-30T00:19:17.463

## 解决方案：给它一个单一的点击

添加 a `position: relative`，`button`然后用`:before`伪元素覆盖它，如下所示：

```
button:before {
    content: '';
    position: absolute;
    top: 0;
    right: 0;
    bottom: 0;
    left: 0;
} 
```

似乎为我解决了这个错误。看到[这个小提琴](http://jsfiddle.net/uPZuJ/23/)。我想它通过在单击时提供一个“元素”来关注它来解决错误（我确实认为这是一个错误）。

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2012-05-28T19:21:00.920

试试这个：http: [//jsfiddle.net/uPZuJ/9/](http://jsfiddle.net/uPZuJ/9/)

不要同时检查`mousedown`同`mouseup`一个元素，而是只检查`mousedown`你的按钮，然后检查`mouseup`任何其他元素。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-05-15T21:52:01.227

您的按钮在 Chrome 中效果很好。我已经通过几行 CSS 和 IE 的属性修复了“单击并按住按钮内的文本”的问题。 [http://jsfiddle.net/uPZuJ/2/](http://jsfiddle.net/uPZuJ/2/)

编辑：这是我修复的错误的屏幕截图：

![在此处输入图像描述](../Images/cf42fa78238037a29190342a45bf41db.png)

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2012-05-29T22:08:31.710

试试这个：~~http://jsfiddle.net/uPZuJ/22/~~ [http://jsfiddle.net/uPZuJ/25/](http://jsfiddle.net/uPZuJ/25/)

这是它的工作原理：

1.  将“向下”初始化为假
2.  按钮上的 mousedown 导致“向下”为真
3.  在 mouseup/click 时，如果 'down' 为 true，则附加文本 'click' 并将 'down' 设置为 false

点击触发点击。

将文本拖动到填充中会触发单击。

将填充拖动到文本中会触发单击。

从内部拖动到外部不会**触发**单击。

从外向内拖动**不会**触发点击。

这是代码：

```
var down=false;
$("button").mousedown(function() {
    down=true;
});
$("button").mouseup(function() {
    if(down) {
        $("#clicks").append("<div>click</div>");
    }
    down=false;
});
$("button").click(function() {
    if(down) {
        $("#clicks").append("<div>click</div>");
    }
    down=false;
}); 
```

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2012-05-29T09:44:47.227

在玩弄了你的例子之后，我想我明白了幕后发生的事情。默认情况下，click 事件会在触发回调之前检查 mousedown 和 mouseup 事件是否被触发。问题是您单击文本，您当前的目标现在是文本（这意味着 mousedown 事件已经在文本区域内触发，并且它正在等待触发 mouseup 事件以完成单击事件）。但是，您将光标拖出文本并在文本区域外释放鼠标，您当前的目标现在是按钮，而不是文本了（鼠标事件不会在文本区域内触发，而是在按钮区域内触发），所以单击事件不会发生。但是，如果您单击文本并拖动，然后在文本区域内释放鼠标，它会正常工作。这就是事件冒泡或捕获的问题。

我建议使用 mousedown 和 mouseup 事件而不是 click 事件。

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2012-05-29T10:00:33.363

使用“mouseup”而不是“click”，它应该在 ie、chrome 和 ff 中工作。

```
 var elementName = "";

    $("button").mouseup(function() {

        if (elementName != "" && elementName == "BUTTON") {

            $("#clicks").append("<span>click</span><br/>");
            elementName = "";
        }

    });

    $("button").mousedown(function() {

        elementName = $(this).get(0).tagName;

    }); 
```

# android - Android 以编程方式创建和填充列表布局

> ID：10609224
> 
> 赞同：0
> 
> 时间：2012-05-15T21:41:38.990
> 
> 标签：android, listview, android-xml

我不能使用 listview，因为这个布局已经需要滚动。所以这给我留下了一个问题：如何创建我的表。

我知道的：

*   JSON数组的大小

我打算尝试在 XML 中创建每个单元格并在代码中执行一个 for 循环，但我的困境是我不能`findViewById`很好，因为`R.id.myId`名称很难解释，并且是整数而不是字符串。（可能问题没有我做的那么大）。

![](../Images/28e5875e93b4dc6d654359ef3f0a7535.png)

所以在这里，我知道服务器调用将返回一个 json 数组，其中最多包含 5 个对象。如何填充我的视图？

我为每一行使用一个 LinearLayout，就像我准备一个自定义列表视图一样。

洞察力赞赏。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-05-15T22:17:29.863

是否有特定原因需要它成为 ListView？如果没有，您可以尝试使用垂直方向的 LinearLayout 作为列表的容器。只需将容器放入您的 xml 中，您就可以以编程方式添加您使用生成的行`addView()`。

# jdbc - WSO2 ESB 4.0.3 和治理注册表配置

> ID：10609226
> 
> 赞同：0
> 
> 时间：2012-05-15T21:41:41.663
> 
> 标签：jdbc, wso2, wso2esb

我有一台服务器运行 ESB，另一台运行治理注册表。

我正在使用嵌入式 h2 数据库。我无法将 ESB 连接到注册表。我收到以下错误

SQLNestedException：无法为连接 URL 创建类“org.h2.Driver”的 JDBC 驱动程序

带有驱动程序的 jar 在路径中并与本地 h2 实例一起使用。

任何帮助表示赞赏

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-05-16T16:14:49.543

我相信这可能是由于 h2 数据库无法接受多个连接。但是您需要提供更多详细信息来回答这个问题吗？也许是整个堆栈跟踪。通常，当我们使用远程注册表时，我们使用 mysql 或类似的数据库。

由于 h2 驱动程序已交付并且无论如何它已经在类路径中，因此除非您更改了驱动程序，否则不会是由于 h2 驱动程序有问题。

# android - 代码点击屏幕上的任意位置拍照

> ID：10609227
> 
> 赞同：1
> 
> 时间：2012-05-15T21:41:49.200
> 
> 标签：android, cordova, camera, screen

有谁知道我如何编写相机功能来拍摄照片，用户只需点击屏幕上的任意位置？我正在用 Android 中的 Phonegap 编写应用程序。

谢谢！

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-05-15T23:13:56.833

当您执行 navigator.camera.getPicture() 方法时，您将触发 Intent 以启动 Android 相机。相机提供了用户界面来拍照，所以你需要使用他们的快门按钮。

如果您想执行随处点击功能，您需要编写一个插件来提供您自己的相机功能。

# javascript - iOS 从 Javascript 调用 Objective-C：某些调用被忽略？

> ID：10609228
> 
> 赞同：2
> 
> 时间：2012-05-15T21:41:49.563
> 
> 标签：javascript, objective-c, ios, timing

我已经使用 UIWebView 委托 shouldStartLoadWithRequest() 方法在 iOS 上实现了从 javascript 到 Objective-c 的唯一通信方式。

起初它似乎工作正常，但现在我注意到如果我在短时间内从javascript多次调用objective-c，第二次调用通常会被忽略（应用程序是钢琴键盘，每次按键都会触发一次调用对于本机代码，在处理多次触摸时，不会为每个手指调用本机代码）。

这是我响应 javascript 调用的 Objective-C 代码。我知道这很愚蠢，但我只是想要一些现在可以使用的东西。

```
- (BOOL)webView:(UIWebView *)webView2 shouldStartLoadWithRequest:(NSURLRequest *)request 
        navigationType:(UIWebViewNavigationType)navigationType 
{  
  // Intercept custom location change, URL begins with "js-call:"
  NSString * requestString = [[request URL] absoluteString];
  if ([requestString hasPrefix:@"js-call:"]) 
  {
    // Extract the selector name from the URL
    NSArray * components = [requestString componentsSeparatedByString:@":"];
    NSString * functionCall = [components objectAtIndex:1];
    NSArray * params = [functionCall componentsSeparatedByString:@"%20"];
    NSString * functionName = [params objectAtIndex:0];

    // Parse playnote event
    if ([functionName isEqualToString:@"playNote"])
    {
      NSString * param = [params objectAtIndex:1];
      NoteInstanceID note_id = [m_audioController playNote:[param intValue]];
      NSString * jscall = [NSString stringWithFormat:@"document.PlayNoteCallback(%i);", note_id];
      NSLog(@"playNote: %i", (int)note_id);
      [m_webView stringByEvaluatingJavaScriptFromString:jscall];
    }

    // Parse stopnote event
    if ([functionName isEqualToString:@"stopNote"])
    {
      NSString * param = [params objectAtIndex:1];
      NoteInstanceID note_id = [param intValue];
      NSLog(@"stopNote: %i", (int)note_id); 
      [m_audioController stopNote:note_id];
    }

    // Parse log event
    if ([functionName isEqualToString:@"debugLog"])
    {
      NSString * str = [requestString stringByReplacingOccurrencesOfString:@"%20" withString:@" "];
      NSLog(@"%s", [str cStringUsingEncoding:NSStringEncodingConversionAllowLossy]);
    }

    // Cancel the location change
    return NO;
  }

  // Accept this location change
  return YES;

} 
```

从javascript我通过设置单个隐藏iframe的src属性来调用objective-c方法。这将触发 Objective-c 中的委托方法，然后将调用所需的本机代码。

```
$("#app_handle").attr("src", "js-call:playNote " + key.data("pitch")); 
```

app_handle 是相关 iframe 的 id。

综上所述，我的方法基本可以，但是短时间内多次调用是不行的。这只是我们被迫从javascript到objective-c通信的可怕方法的产物吗？还是我做错了什么？我知道 PhoneGap 做了类似的事情来实现同样的目标。我宁愿不使用PhoneGap，所以如果他们没有这个问题，那么我很想弄清楚他们正在做什么来完成这项工作。

更新：

我刚刚发现：[从 UIWebView 中的 javascript 向 ObjectiveC 发送通知，](https://stackoverflow.com/questions/5671742/send-a-notification-from-javascript-in-uiwebview-to-objectivec) 这证实了我对快速连续调用丢失的怀疑。显然，我需要将我的呼叫集中在一起或手动延迟呼叫，以便在我拨打另一个呼叫时返回 url 请求。

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-11-01T11:45:39.043

接受的答案并不能解决问题，因为在处理第一个之前到达的位置更改仍然被忽略。见第一条评论。

我建议采用以下方法：

```
function execute(url) 
{
  var iframe = document.createElement("IFRAME");
  iframe.setAttribute("src", url);
  document.documentElement.appendChild(iframe);
  iframe.parentNode.removeChild(iframe);
  iframe = null;
} 
```

您`execute`重复调用该函数，并且由于每个调用都在其自己的 iframe 中执行，因此在快速调用时不应忽略它们。

归功于[这个家伙](http://blog.techno-barje.fr/post/2010/10/06/UIWebView-secrets-part3-How-to-properly-call-ObjectiveC-from-Javascript/)。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-05-15T22:29:32.450

与其在 JavaScript 端对所有内容进行排队，不如使用 GCD 将复杂的逻辑（如对音频处理程序的调用）移出主线程可能更容易、更快捷。您可以使用`dispatch_async()`来排队您的活动。如果您将它们放入串行队列，那么它们肯定会按顺序运行，但您会更快地返回到 javascript。例如：

*   在初始化期间为您的对象创建一个队列：

    self.queue = dispatch_queue_create("player", NULL);

*   在您的回调中：

    ```
    if ([functionName isEqualToString:@"stopNote"])
    {
      NSString * param = [params objectAtIndex:1];
      NoteInstanceID note_id = [param intValue];
      NSLog(@"stopNote: %i", (int)note_id); 
      dispatch_async(self.queue, ^{[m_audioController stopNote:note_id]});
    } 
    ```

# ruby-on-rails-3 - 您如何使用 :as 并正确匹配路由？

> ID：10609233
> 
> 赞同：0
> 
> 时间：2012-05-15T21:42:23.137
> 
> 标签：ruby-on-rails-3

我不知道我做错了什么。这是我的路线：

```
resources :stores do 
   get '/add_shoes' => 'stores#add_shoes', :as => :add_shoes
end 
```

我的路径应该是：`<%= link_to "Add Shoes", add_shoes_path %>`

但它给出了路径不存在的错误。我如何使用它们？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-05-15T22:10:13.080

如果我没记错的话，因为它嵌套在一个`resources`块中，它会附加`stores`到最后。所以正确的路线是add_shoes_stores_path。有时它还会在末尾添加一个索引（不知道为什么），给你 add_shoes_stores_index_path。

由于这是一个`get`电话，你总是可以把它放在`resources`街区之外。

此外，更多的 Rails 方法是：

```
resources :stores do
  collection do
    get :add_shoes
  end
end 
```

关于如何处理它，您有很多选择。但只是一个快速提示，您始终可以`rake routes`从命令行键入以获取所有可用路线的列表以及它们指向的位置。

如果您为了代码的清晰而考虑这样做，请记住这一点：您的路线应始终提及它们指向的位置。那将是`add_shoes`和`stores`。有一个`add_shoes_path`可能指向任何控制器，因为它并不是很冗长。我肯定会坚持使用 Rails 的方式来做这件事——当你深入研究时，它会更有意义。

最后，另一个想法 - 如果您在商店模型中添加鞋子，那么每个商店都有鞋子是有意义的。您可能应该为 Shoes 创建一个新模型并使用 RESTFUL 路由。

# configuration - Gradle：配置注入与继承

> ID：10609244
> 
> 赞同：1
> 
> 时间：2012-05-15T21:43:21.170
> 
> 标签：configuration, build, gradle

Gradle 文档状态（[49.9](http://gradle.org/docs/current/userguide/userguide_single.html#sec%3aproperty_and_method_inheritance)）：

> 项目中声明的属性和方法将继承到其所有子项目。这是配置注入的替代方法。但我们认为继承模型并不能很好地反映多项目构建的问题空间。在本用户指南的未来版本中，我们可能会对此进行更多介绍。

我原则上了解配置注入在做什么，但我想更多地了解与继承的区别，以及为什么它更适合多项目构建。

任何人都可以给我一些子弹吗？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-05-22T22:31:55.980

[在 Gradle论坛](http://forums.gradle.org/gradle/topics/what_is_the_difference_between_inheritance_and_configuration_injection)上得到了答案。

本质上，配置注入允许您有选择地将属性应用到子项目。

# android - 我正在尝试将 phonegap 添加到我的本地 maven 存储库以用于 android 应用程序，我正在寻求有关我采取的步骤的帮助

> ID：10609245
> 
> 赞同：1
> 
> 时间：2012-05-15T21:43:25.977
> 
> 标签：android, maven, cordova

我最初发现 Nico 的建议[https://github.com/nicokruger/android-maven-phonegap/issues/1](https://github.com/nicokruger/android-maven-phonegap/issues/1)当我浏览以查找托管 phonegap .jar 文件的 maven 存储库时。

虽然这使我走上了将 jar 添加到本地存储库的道路上，但我遇到了各种各样的问题（这里是 Maven 新手），错误如下：

*   [错误] ...目标需要执行项目，但此目录中没有 POM（尝试将 -DgeneratePom=true 添加到命令行，但这没有帮助）
*   [错误]...此项目的打包未将文件分配给构建工件

在解决了这些问题之后，我想出了这些安装步骤。但是，当我查看本地 .m2 存储库时，我只看到下面创建的 pom 文件；不存在 jar 文件。

谢谢！

### 环境

*   Windows 7的
*   阿帕奇 Maven 3.0.4
*   Java 版本：1.6.0_31，供应商：Sun Microsystems Inc.

### 步骤（修改：这些是现在正确的步骤。感谢 Ryan）

1.  [从http://phonegap.com/download](http://phonegap.com/download)下载 phonegap 1.7.0

2.  解压到临时文件夹

3.  导航到：temp/phonegap-phonegap-475bfd2/lib/android

4.  在命令提示符处执行以下命令：

    ```
    mvn install:install-file -Dfile=cordova-1.7.0.jar -DgroupId=org.apache.cordova -DartifactId=phonegap -Dversion=1.7.0 -Dpackaging=jar 
    ```

5.  Phonegap (cordova-1.7.0.jar) 现在应该安装在本地 Maven 存储库中

6.  在您的项目 pom 中，将以下内容添加到您的 POM 文件中：

    ```
    <dependency>
      <groupId>org.apache.cordova</groupId>
      <artifactId>phonegap</artifactId>
      <version>1.7.0</version>
    </dependency> 
    ```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-05-15T22:12:04.850

删除 pom 并使用[install-file 目标](http://maven.apache.org/plugins/maven-install-plugin/install-file-mojo.html)，如下所示：

```
mvn install:install-file -Dfile=cordova-1.7.0.jar -DgroupId=org.apache.cordova -DartifactId=phonegap -Dversion=1.7.0 -Dpackaging=jar 
```

# sql-server - SQL Server 2008 在 10 0 万条记录表上选择性能 - 慢？

> ID：10609252
> 
> 赞同：0
> 
> 时间：2012-05-15T21:44:08.093
> 
> 标签：sql-server, performance, select

我有一个包含 1000 万条记录的表，需要全部加载到内存中（缓存应用程序）。

表结构如下：

```
CREATE TABLE [TestTable] (
    [Id]        [int] IDENTITY(1,1) NOT NULL,
    [RefId1]    [int] NOT NULL,
    [RefId2]    [int] NOT NULL,
    [RefId3]    [int] NULL,
    [Credits]   [money] NOT NULL,
    CONSTRAINT [PK_Table] PRIMARY KEY CLUSTERED ( [Id] ),
    CONSTRAINT [UK_Table] UNIQUE NONCLUSTERED ([RefId1],[RefId2],[RefId3])
) 
```

表大小约为：364080 KB（数据）- 341648 KB（索引）

使用简单的选择加载这么多数据大约需要 2 分钟。

选择使用：

```
SELECT  Id, RefId1, Credits, RefId3
FROM    TestTable WITH (NOLOCK) 
```

这是 SQL Server 的正常速度性能吗？我怎样才能加快这个查询？

从缓存应用程序和 SSMS 测试查询，结果几乎相同。

我在具有 32 GB Ram 和 SSD 磁盘 RAID 的 16 核服务器上使用 SQL Server 2008 R2 Std，没有其他应用程序或与 SQL 服务器的连接。

从性能计数器中，我可以看到没有队列/磁盘/cpu 使用，因为数据库完全在内存中。执行查询时，唯一可见的信息是 SQL 和 SSMS 之间大约 6 MB/s 的缓慢网络流量。

所有测试均在本地机器上完成。

关于如何加快速度或在哪里寻找问题的任何建议？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-05-15T22:19:30.330

我想这不是 SQL 服务器的问题，更多的是关于将大量数据从数据库传输到本地 Windows 交换文件/内存。为什么需要所有的表，SQL Server 会计算出在正常情况下哪些页面应该保留在缓存中。

# javascript - 如何使用 JavsScript 检查外部页面上是否存在字符串？

> ID：10609257
> 
> 赞同：0
> 
> 时间：2012-05-15T21:44:19.430
> 
> 标签：javascript

我正在尝试检查特定字符串的页面（在同一域上），然后相应地执行某些操作。我怎样才能在 JavaScript 中解决这个问题（加载了 jQuery）？

一个（可能太多）简化示意图：

```
url = "pageToLoad.php"

if(StringOnPage(url) == TRUE){
    // Do a bunch of stuff
}else{
    // Do nothing
} 
```

现在我将如何`StringOnPage()`理想地构建？我用 jQuery`.load` 和jQuery 做了几次尝试`.ajax`，我什至尝试将它加载到一个隐藏的容器中。必须有一种方法可以将页面加载到字符串中并检查表达式或其他内容，而无需所有 html hack。

该页面只是一个 HTML 填充文件。基本上我需要在 DOM 元素中找到一个文本。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-05-15T21:46:40.237

通过 AJAX 将页面加载为纯字符串，然后只需检查您要查找的字符串是否在您从 AJAX 调用获得的字符串中的某个位置：

```
$.get(url, function(data) {
    if(data.indexOf('whatever') != -1) {
        // do a bunch of stuff
    }
}, 'text'); 
```

当然你也可以使用`'html'`代替`'text'`; then`data`是一个 jQuery 对象，其中包含您刚刚加载的页面的 DOM。

# python - Python 服务器和游戏客户端：消息过载？

> ID：10609261
> 
> 赞同：1
> 
> 时间：2012-05-15T21:44:48.400
> 
> 标签：python, sockets, tcp, game-maker

我正在用 Python 编写一个游戏服务器，并使用 Faucet Networking 插件在 Game Maker 中编写一个游戏客户端（尽管这无关紧要）。每次玩家移动时，客户端都会向服务器发送一条UPDATEXY消息，并且客户端中有消息聊天的东西。当有 2 个客户端连接到服务器时，客户端似乎会收到消息超载（进一步进入运行时，聊天消息显得更慢，并且玩家落后于实际其他玩家所在的位置）。我相信这是因为客户端无法以它们流入的速度处理消息，所以我在客户端中实现了一个功能，它将所有消息转储到接收缓冲区中，并忽略它们。这似乎有效，但玩家会猛烈地抽搐。这个问题有什么“干净的解决方法”吗？

顺便说一句，我使用的协议是 TCP。这是 TCP 本身的问题还是我只是用错了？切换到 UDP 有帮助吗？

谢谢。

编辑：请求代码，所以你去服务器：

```
def sendmsg(msgtype, msg, conn, args=None):
    if msgtype == MSG_PLAYER_ASSIGN_ID:
        dataload = struct.pack('!hhh', MSG_STARTBYTE, msgtype, msg)
        conn.send(dataload)

    elif msgtype == MSG_PLAYER_UPDATEXY: #This will only ever be broadcasted
        #print("Sending xy from " + str(args['pid']))
        dataload = struct.pack('!hhhhh', MSG_STARTBYTE, msgtype, args['pid'], msg[0], msg[1])
        conn.send(dataload)

    elif msgtype == MSG_ASKFORLIST:
        players = msg
        for player in players:
            if args['pid'] != player.pid and player.dead == False:
                dataload = struct.pack('!hhhh' + str(len(str(player.name))) + "s", MSG_STARTBYTE, MSG_PLAYERENTRY, player.pid, len(str(player.name)), player.name.encode())
                conn.send(dataload)
                loginfo("Sent a player") 
```

^这只是几个包，还有更多，但它们都非常像那些

在这里，你去客户端：

```
if msgtype == MSG_PLAYER_UPDATEXY
{
if tcp_receive(serversocket, 6){
pidtoupdate = read_short(serversocket)
//show_message(string(pidtoupdate))
if objNewNetProcessor.pid != pidtoupdate
{
xtoupdate = read_short(serversocket)
ytoupdate = read_short(serversocket)
playertoupdate = ds_map_find_value(global.players, string(pidtoupdate))
if playertoupdate != objChar
{
playertoupdate.y = ytoupdate
playertoupdate.x = xtoupdate}
}}}

if msgtype == MSG_CHAT
{
if tcp_receive(serversocket, 4){
fromperson = read_short(objNewNetProcessor.serversocket)
strlen = read_short(objNewNetProcessor.serversocket)
tcp_receive(objNewNetProcessor.serversocket, strlen)
chatmsg = read_string(objNewNetProcessor.serversocket, strlen)
display_chat(fromperson, chatmsg)
}} 
```

^抱歉，这完全是乱码，现在只是临时代码。它也只是几个数据包，它在该代码下面处理更多，尽管它们看起来都相似。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-05-15T22:04:55.270

如果尚未准备好发送大数据块（大约 100 到 1000 字节），TCP 通常配置为在发送任何内容之前等待大约 200 毫秒。这称为 Nagle 算法。当客户端尝试以 60fps（~16ms 周期）发送更新时，这意味着您将爆发大量过时的数据。

可以关闭 Nagle 缓冲，但 UDP 更适合实时游戏中的持续位置更新等情况。

也就是说，我希望一台速度相当快的机器上的 Python 服务器能够跟上 2 个客户端的更新，所以可能还有其他事情发生。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-05-20T10:25:49.910

通常这应该可以正常工作，我怀疑这是 CPU 负载高的问题 - 每秒 60 次更新相当多，但只有两个客户端连接，不应该有那么多流量需要处理。相比之下，Gang Garrison 2 每秒只使用 30 次更新，但使用一台不错的 PC，它可以在服务器上处理 20 名玩家。检查任务管理器中的客户端和服务器 CPU 负载以确保安全，但我不认为这是问题所在。

如果清除客户端上的“积压”使它们赶上来，这可能不是网络速度或服务器的问题，但是使用[Wireshark](http://www.wireshark.org/)记录客户端上的流量以查看一切是否看起来仍然很有价值预期的（例如，数据包以预期的速率发送和接收，并且是均匀定时的）。

由于客户端上似乎有积压：客户端是否尝试在每个步骤中使用尽可能多的消息，还是仅在一个服务器步骤中使用消息？如果您每个客户端步骤只处理一个服务器步骤，那么任何不可避免发生的连接中断都会导致您永久落后，这似乎与您描述的一致。

Russell Borogove 也给了你一个很好的指导，一定要确保在服务器上每个与游戏相关的套接字上禁用 Nagle 算法（=启用 tcp_nodelay）。Faucet 默认执行此操作。

# mysql - Rails 3：如何在 MongoDB 中实现查询缓存

> ID：10609262
> 
> 赞同：-1
> 
> 时间：2012-05-15T21:44:48.770
> 
> 标签：mysql, ruby-on-rails-3, caching, mongodb, query-cache

我对 MongoDB 做了一些研究，发现它没有任何查询缓存。

> MongoDB 不实现查询缓存：MongoDB 直接从索引和/或数据文件提供所有查询。（http://docs.mongodb.org/manual/faq/fundamentals/）

有没有办法在 Rails 中为 MongoDB 实现查询缓存？我只想要与 MySQL 查询缓存相同的行为。第二次相同的数据库查询应该更快。

谢谢！

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-05-16T02:54:06.367

您可以使用 memcached 添加缓存层，但 MongoDB 可能仍会将上次读/写操作中的数据分页到内存中。将 MongoDB 服务器内存用于 memcached 将与其内存映射文件模型竞争。更少的 MongoDB 内存意味着更多的交换到磁盘。

如果您正在运行 map reduce 作业（大到足以导致分页），可能值得缓存结果，但正确跟踪更新可能非常棘手。

# android - Fragment 和 FragmentActivity 有什么区别？

> ID：10609268
> 
> 赞同：162
> 
> 时间：2012-05-15T21:45:17.787
> 
> 标签：android, android-fragments, android-fragmentactivity

我的问题是除了明显的继承差异之外，[`Fragment`](http://developer.android.com/reference/android/app/Fragment.html)和之间的主要区别是[`FragmentActivity`](http://developer.android.com/reference/android/support/v4/app/FragmentActivity.html)什么？每个类最适合哪些场景？我试图了解为什么这两个类都存在......

* * *

## 回答 #1

> 赞同：285
> 
> 时间：2012-05-15T22:42:48.240

A[`Fragment`](http://developer.android.com/guide/topics/fundamentals/fragments.html)是 a 的一部分`Activity`，它具有：

*   自己的生命周期
*   接收自己的输入事件
*   可以在`Activity`运行时添加或删除。

A`Fragment`必须始终嵌入到`Activity`.

`Fragments`在 HoneyComb (3.0) 之前不是 API 的一部分。如果您想`Fragments`在针对 HoneyComb 之前的平台版本的应用程序中使用，您需要将[支持包](http://developer.android.com/sdk/compatibility-library.html)[`FragmentActivity`](http://developer.android.com/reference/android/support/v4/app/FragmentActivity.html)添加到您的项目并使用`Fragments`. 该类`FragmentActivity`有一个处理 的 API `Fragments`，而`Activity`HoneyComb 之前的类没有。

如果您的项目仅针对 HoneyComb 或更新版本，您应该使用`Activity`而不是`FragmentActivity`持有您的`Fragments`.

一些细节：

`android.app.Fragment`与 一起使用`Activity`。`android.support.v4.app.Fragment`与 一起使用`FragmentActivity`。不要将支持包添加`Fragment`到 an`Activity`中，因为它会导致抛出异常。

需要注意的一点：`FragmentManager`并且`LoaderManager`对 FragmentActivity 有单独的支持版本：

如果您`Fragment`在`Activity`（HoneyComb 及以上）中使用 a，请致电

*   `getFragmentManager()`要得到`android.app.FragmentManager`
*   `getLoaderManager()`要得到`android.app.LoaderManager`

如果您`Fragment`在`FragmentActivity`(pre-HoneyComb) 中使用 a，请致电：

*   `getSupportFragmentManager()`得到`android.support.v4.app.FragmentManager`.
*   `getSupportLoaderManager()`要得到`android.support.v4.app.LoaderManager`

所以，**不**要这样做

```
//don't do this
myFragmentActivity.getLoaderManager(); 
//instead do this:
myFragmentActivity.getSupportLoaderManager(); 
```

或者

```
//don't do this:
android.app.FragmentManager fm = myFragmentActivity.getSupportFragmentManager();
//instead do this:
android.support.v4.app.FragmentManager fm = myFragmentActivity.getSupportFragmentManager() 
```

同样有用的是，虽然必须将片段嵌入到其中，`Activity`但它不必是`Activity`布局的一部分。它可以用作活动的隐形工作者，没有自己的 UI。

* * *

## 回答 #2

> 赞同：14
> 
> 时间：2012-05-15T21:56:56.273

FragmentActivity 是我们的经典 Activity，支持 Fragment，仅此而已。因此需要 FragmentActivity，当一个 Fragment 将附加到 Activity 时。

那么 Fragment 是一个很好的组件，它复制了 Activity 的基本行为，仍然不是像 Activity 那样的独立应用程序组件，需要附加到 Activity 才能工作。

看[这里](http://developer.android.com/guide/topics/fundamentals/fragments.html)了解更多详情

* * *

## 回答 #3

> 赞同：8
> 
> 时间：2013-02-15T19:30:43.707

将 FragmentActivity 视为可以支持 Fragments 的常规 Activity 类。在honeycomb 之前，活动类不能直接支持Fragment，因此在使用Fragment 的活动中需要这样做。

如果您的目标分布是 Honeycomb 及以上，则可以改为扩展 Activity。

片段也被视为“子活动”。它不能没有活动而存在。始终将片段视为子活动，您应该做得很好。因此，活动将是父级，片段是子级的象征关系。

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2012-05-15T22:09:38.960

FragmentActivity 是一个包含 Fragment 的临时活动。在这几句话中，我向您解释了在 android 3.0(HoneyComb) 中，android 团队在 android sdk 中插入的主要重要变化之一。

有了这些新概念，您的代码和布局变得更加灵活和可维护。如果你在谷歌上搜索有很多例子。

# c++ - 使用 CQL 准备查询在 C++ 中管理计数器

> ID：10609272
> 
> 赞同：2
> 
> 时间：2012-05-15T21:45:50.403
> 
> 标签：c++, cassandra, cql

重新发布实际代码

```
 // cassandra is a connected org::apache::cassandra::CassandraClient
// statement is a CqlPreparedResult
// result is a CqlResult
// CF declaration is:
/*
CREATE COLUMNFAMILY xp (
  cid ascii PRIMARY KEY,
  exp4 counter,
  exp2 counter,
  exp3 counter,
  exp1 counter
) WITH
  comment='' AND
  comparator=text AND
  read_repair_chance=0.100000 AND
  gc_grace_seconds=864000 AND
  default_validation=counter AND
  min_compaction_threshold=4 AND
  max_compaction_threshold=32 AND
  replicate_on_write=True AND
  compaction_strategy_class='SizeTieredCompactionStrategy' AND
  compression_parameters:sstable_compression='org.apache.cassandra.io.compress.SnappyCompressor';
 */
std::vector<std::string> values;
values.resize(2);
values[0]="1";
values[1]="103";
cassandra->prepare_cql_query(statement,"update xp set exp2 = exp2 + ? where cid=?",Compression::NONE);
int32_t handle=statement.itemId;
try {
    cassandra->execute_prepared_cql_query(result,handle,values);
}
catch(InvalidRequestException &e) {
    cout << __LINE__ << " " << e.why << " "<< e.what() << endl;
}
// throws '?' is an invalid value, should be a long.
values.resize(1);
values[0]="103";
cassandra->prepare_cql_query(statement,"update xp set exp2 = exp2 + 1 where cid=?",Compression::NONE);
handle=statement.itemId;
cassandra->execute_prepared_cql_query(result,handle,values);
//works 
```

所以看起来问题在于我们无法传递二进制数据。我试图传入一个包含 long 实际表示的字符串，但没有成功。当我从中读取数据时出现同样的问题，但我认为我可以管理它（扫描返回的字符串并将其一次转换一个字节作为最后的手段）

有人成功使用计数器、c++ 和 cql 吗？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-05-16T15:35:11.880

long 值应编码为 big-endian 64 位整数。所以试试：

```
values[0] = "\0\0\0\0\0\0\0\x64"; 
```

如果您打算在没有驱动程序的情况下继续使用 CQL，您将需要大量编组/解组例程来涵盖这类事情。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-06-15T20:37:32.250

好吧，我发现我缺少正确的二进制编码。使用此函数将我的 long 转换为字符串，我成功地使用了准备好的查询

```
string to_counter(const long value) {
    union  {
        long    v;
        char    cc[8];
    } xx;
    xx.v=value;
    string r;
    r.assign(xx.cc,8);
    reverse(r.begin(),r.end());
    return r;
} 
```

它是伴侣

```
long from_counter(const string& value) {
    union  {
        long    v;
        char    cc[8];
    } xx;
    for (size_t i=0; i < 8;++i) {
        xx.cc[7-i]=value.at(i);
    }
    return xx.v;
} 
```

我很确定这段代码可以改进，任何建议都会受到欢迎:)

# windows - 是否有任何帮助工具“即时”创建图形编辑文件（以编程方式）

> ID：10609283
> 
> 赞同：1
> 
> 时间：2012-05-15T21:46:28.807
> 
> 标签：windows, directshow, graphedit, avisynth

我注意到avisynth只能通过包含该源的graphedit文件接受“实时直接显示源”作为输入。如果您知道捕获源名称（和/或您希望从该引脚获得的输出格式），是否有任何帮助工具可以即时创建图形编辑文件？

参考：[http ://betterlogic.com/roger/2012/05/avisynth-live-capture](http://betterlogic.com/roger/2012/05/avisynth-live-capture)

此处描述了graphedit文件语法：http: [//msdn.microsoft.com/en-us/library/windows/desktop/dd388788](http://msdn.microsoft.com/en-us/library/windows/desktop/dd388788(v=vs.85).aspx) (v=vs.85).aspx （虽然它没有提到如何发现正确的值放在那里）。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-05-16T05:50:00.377

文件格式位于 MSDN 上的相邻部分：[将过滤器图保存到 GraphEdit 文件](http://msdn.microsoft.com/en-us/library/windows/desktop/dd377551%28v=vs.85%29.aspx)中。有一个过滤器图形和过滤器，支持持久性（`IPeristStream`界面和朋友），`SaveGraphFile`MSDN文章上的功能将把图形保存到GraphEdit-loadable文件中。

# simperium - Simperium 没有告诉“Simperium 管理 x MyEntity 对象实例”

> ID：10609286
> 
> 赞同：1
> 
> 时间：2012-05-15T21:46:44.037
> 
> 标签：simperium

在 SimpleTodo 中，Simperium 说

```
Simperium starting... 
Simperium loaded 1 entity definitions
Simperium managing 2 Todo object instances
Simperium found an existing auth token for myemail@myhost.de
Simperium starting network managers... 
```

初始化并启动后。

在我自己的应用程序中启动 Simperium 时，`Simperium managing x MyEntity object instances`缺少这句话。它说`Simperium loaded 15 entity definitions`，虽然。

我的应用程序的数据模型非常复杂（因此有 15 个实体），我没有`SPManagedObject`在我的数据模型中引入 a。但是我将所有`NSManagedObject`超类更改为`SPManagedObject`并将这两个属性添加`ghostData`到`simperiumKey`所有实体中。

我该怎么做才能检查一切是否正常？我该怎么做才能让它管理我的实体？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-05-17T07:43:46.653

我们今晚推送了一个实体名称的修复程序，这应该有助于解决您遇到的问题。如果您希望完全控制表结构（如[从 SPManagedObject 继承中](https://stackoverflow.com/questions/10565002/inherit-from-spmanagedobject)所述），现在应该可以手动指定`ghostData`和属性。`simperiumKey`

# html - 带锚的错误负边距

> ID：10609288
> 
> 赞同：2
> 
> 时间：2012-05-15T21:47:34.593
> 
> 标签：html, css, anchor

我使用负边距底部来获得 n 个高度相等的 DIV（我使用这种方法：[http](http://abcoder.com/css/css-equal-height-columns) ://abcoder.com/css/css-equal-height-columns “三列布局 - 使用纯 CSS 等高”）

但这不适用于锚链接。

div 的顶部就消失了。

这是我的例子：[http ://club-scpi.com/bug.php](http://club-scpi.com/bug.php)

这太奇怪了！我错过了什么？

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-05-15T22:56:48.803

这不是错误，可以按 html 和 css 的预期工作

```
 #container {
    overflow: hidden;
 } 
```

导致 div 内的内容（当被告知转到锚点时）向上滚动到

```
 <a name="test"> 
```

由于溢出设置为隐藏，它似乎 - 消失。它只是“隐藏”

改成

```
 #container {
     overflow: auto;
   } 
```

你会看到发生了什么。

顺便说一句，我不喜欢这种创建等高 div 的建议方法，（原因之一就是您刚刚强调的内容），这一切都取决于特定的工作是什么。

替代方案是；在我们开始标记之前，使用背景颜色、% 高度、px 高度或只是工厂和前期内容设计注意事项。

然后是javascript，它可以在大小方面随处跟进和整理盒子（也值得研究）

...始终保持尽可能简单。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-07-29T22:18:47.763

我有同样的情况，我的页脚有一个负边距，并且锚定链接切断了我的页面顶部并在单击时将其移动到底部。我曾有一个

在页脚内标记版权信息，并将负边距从

并像魅力一样工作。不确定它是否直接适用于这种情况，但可能会对某人有所帮助。

# android - Horizo ntalScrollView 中的 Android ImageView 是屏幕宽度的两倍

> ID：10609289
> 
> 赞同：1
> 
> 时间：2012-05-15T21:47:35.427
> 
> 标签：android, android-layout

我正在尝试在 Horizo​​ntalScrollView 中创建一个 ImageView，但 imageView 的宽度是屏幕宽度的两倍，并且在一半范围内结束。

我的 XML：

```
<?xml version="1.0" encoding="utf-8"?>

<HorizontalScrollView xmlns:android="http://schemas.android.com/apk/res/android"
android:id="@+id/horizontalScrollView1"
android:layout_width="match_parent"
android:layout_height="match_parent" >

<LinearLayout
    android:layout_width="wrap_content"
    android:layout_height="wrap_content"
    android:layout_gravity="top"
    android:baselineAligned="true"
    android:orientation="vertical" >

    <ImageView
        android:id="@+id/imageView1"
        android:layout_width="wrap_content"
        android:layout_height="wrap_content"
        android:src="@drawable/penguins" />
</LinearLayout>

</HorizontalScrollView> 
```

[以及我得到的图像（点击我！）](http://anderak.dyndns.org/Untitled.png)

有谁知道这个问题的解决方案？

问候

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-11-12T21:31:19.417

我复制了你的 xml 并使用我的资源，它看起来很完美，我相信你的资源比你想象的要大，你可能应该使用`layout_width`和`layout_height`作为固定大小，并将 scaleType 设置为 centerInside。

# c# - 控制台应用程序串行执行

> ID：10609290
> 
> 赞同：1
> 
> 时间：2012-05-15T21:47:41.407
> 
> 标签：c#, xml

我想链接'n'个可执行文件，第'n-1'个exe的输出作为'n'th exe的输入传递。我打算使用 XML 文件来配置可执行位置、路径、i/p、o/p 等。

我的问题是当有多个输出和多个输入（命令行参数）时如何将“n-1”链接到“n”。我对此有一些想法，但想看看其他人的想法，也许我会知道一种有效/快速的方法来做到这一点。灵活的 xml 配置的设计模式会有所帮助。

我将使用的伪 XML 结构

```
<executables>
  <entity position="1" exePath="c:\something1.exe">
     <op><name="a" value=""></op>
  </entity>
  <entity position="2" exePath="c:\something2.exe">
   <ip><name="a"></ip>
   <op><name="b"  value=""></op>
  </entity>
  <entity position="3" exePath="c:\something3.exe">
   <ip><name="b"</ip>
  </entity>
</executables> 
```

在配置这些之前，我会了解 i/p 和 o/p。上下文是我可能会或可能不会在我将使用的某些类型的链接中包含某些节点，从而有效地创建灵活的串行 exe 执行路径。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-05-15T23:43:18.807

您可以为此使用 System.Diagnostics.Process 类。以下代码应该对两个可执行文件起作用：

```
using (Process outerProc = new Process())
{
    outerProc.StartInfo.FileName = "something1.exe";
    outerProc.StartInfo.UseShellExecute = false;
    outerProc.StartInfo.RedirectStandardOutput = true;
    outerProc.Start();

    string str = outerProc.StandardOutput.ReadToEnd();

    using(Process innerProc = new Process())
    {
        innerProc.StartInfo.FileName = "something2.exe";
        innerProc.StartInfo.UseShellExecute = false;
        innerProc.StartInfo.RedirectStandardInput = true;
        innerProc.Start();

        innerProc.StandardInput.Write(str);
        innerProc.WaitForExit();
    }

    outerProc.WaitForExit();
} 
```

您可以轻松修改它以适应您的“n-1”到“n”的情况。

# javascript - 在不使用滚动条的情况下在巨大的 html 页面中移动浏览器视图

> ID：10609291
> 
> 赞同：0
> 
> 时间：2012-05-15T21:47:47.153
> 
> 标签：javascript, jquery, html, view

我有一个非常大的 html 页面（如 7000*5000），我需要使用 javascript 在该页面周围移动用户的视图。

通过删除浏览器滚动条（在 html 上带有溢出：隐藏），我可以很容易地无法让用户自己移动，我接下来需要做的是控制“相机”在 js/jquery 中围绕那个大页面的移动。

即使我搜索了很多，我也没有在网上找到任何东西，除了使用带有平滑 jQuery 滚动的锚点，这可以（即使不是很整洁）以垂直方式移动，但是这样做变得非常复杂它水平。

有什么办法吗？

非常感谢 ：）

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-05-15T21:55:15.280

jQuery scrollTo 和 localScroll 插件非常适合这个。看看这里： http: [//flesler.blogspot.co.uk/2007/10/jquerylocalscroll-10.html](http://flesler.blogspot.co.uk/2007/10/jquerylocalscroll-10.html)的选项和这里的演示：[http ://demos.flesler.com/jquery/scrollTo/](http://demos.flesler.com/jquery/scrollTo/)

这些插件允许您对动画进行排队并定义同时水平和垂直滚动或垂直然后水平滚动等的设置。

尼尔

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-05-15T21:56:10.113

您的主要周围元素、div 或部分（如果您确实有一个），请将其设置得太固定。无需在浏览器窗口中实际滚动，只需重新定位屏幕上的内容并产生滚动效果。用户不会知道区别。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-05-15T21:51:43.300

查看 jQuery 的动画功能。也许你可以做这样的事情：

```
function movePage(newTop, newLeft){
    $('#pageview').animate({left:newLeft + "px", top: newTop + "px"});
} 
```

请更新您的问题，并说明您*何时*想要移动页面，我可以尝试为您提供更多帮助。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2012-05-15T22:09:59.507

如果您的[内容溢出其周围的矩形](https://developer.mozilla.org/en/Determining_the_dimensions_of_elements)，您仍然可以使用 JS 滚动它 - 无论 CSS 是否显示滚动条。

对于整个窗口，您可以使用[`window.scrollTo()`](https://developer.mozilla.org/en/DOM/window.scrollTo)及其衍生物。

对于单个 DOM 元素，这可以通过设置[`scrollLeft`](https://developer.mozilla.org/en/DOM/element.scrollLeft)和[`scrollTop`](https://developer.mozilla.org/en/DOM/element.scrollTop)属性来完成。

使用这两种方法，您将能够构建（jQuery）动画，当然已经有一些插件可以实现这一点。例如，我找到了[jQuery.ScrollTo](http://flesler.blogspot.de/2007/10/jqueryscrollto.html)[`.scrollLeft()`](http://api.jquery.com/scrollLeft/)，但也许内置方法[`.scrollTop()`](http://api.jquery.com/scrollTop/)足以满足您的目的。在[评论](http://api.jquery.com/scrollLeft/#dsq-comment-77972155)中也有类似

```
 $(someSelector).animate({scrollLeft: someNumber}, 'slow'); 
```

提到。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2012-05-17T17:25:13.030

如果你想做自己的事情，你可以做这样的事情，

```
var targetOffset = $('#post-10').offset().top ;
var scrollElem = scrollableElement('html', 'body');

$(scrollElem).animate({scrollTop: targetOffset}, 400, function() {
    // scroll is complete
      location.hash = 'post-10';
});

   // Use the first element that is "scrollable"  (cross-browser fix?)
function scrollableElement(els) {
    for (var i = 0, argLength = arguments.length; i <argLength; i++) {
        var el = arguments[i],
        $scrollElement = $(el);
        if ($scrollElement.scrollTop()> 0) {
            return el;
        } else {
            $scrollElement.scrollTop(1);
            var isScrollable = $scrollElement.scrollTop()> 0;
            $scrollElement.scrollTop(0);
            if (isScrollable) {
                return el;
            }
        }
    }
    return [];
} 
```

这是用于垂直滚动。

对于水平滚动，你可以这样做，

```
 var targetOffset = $('#post-10').offset().left ;
    var scrollElem = scrollableElement('html', 'body');

    $(scrollElem).animate({scrollLeft: targetOffset}, 400, function() {
        // scroll is complete
          location.hash = 'post-10';
    }); 
```

我强烈推荐这个插件，用于具有很多效果的漂亮水平/垂直滚动。

[http://demos.flesler.com/jquery/scrollTo/](http://demos.flesler.com/jquery/scrollTo/)

# javascript - 获取集合时未调用渲染函数

> ID：10609296
> 
> 赞同：0
> 
> 时间：2012-05-15T21:48:12.310
> 
> 标签：javascript, backbone.js, backbone-events

我已经定义了一个视图绑定到一个集合。

1）当我初始化视图时，会执行一个对集合的获取调用。
2) 如果我查看 get 请求的结果，则可以
3) 我想触发此更改（在 myCollection 中）以调用渲染函数，但它不起作用。

这是我的代码的一部分：

```
define([
    "MyCollection",
    "!text/template"
], function (myCollection, myTemplate) {

    var myView = Backbone.View.extend({

        initialize: function ()
        {
            myCollection.bind('change', this.render); // why the render is not called when 
                                                      // I perform the fetch even if the data is correctly loaded? 

            myCollection.fetch(); // it works
        },

        render: function ()
        {
            // some code
            this.$el <-- undefined 
        }

    });

    return myView;
}); 
```

* * *

如果我使用

1)

```
 initialize: function ()
   {
       myCollection.bind('reset', this.render);  // this.$el <-- undefined in render call, Why?

        myCollection.fetch(); // it works
   } 
```

2)

```
myCollection.fetch({
    success: function () {
         that.render(); // <-- here the $el is defined and it works, Why myCollection.bind('reset', this.render); not?? 
         // it seems to me that when I use reset the render function is called before the this.$el is defined
    }
}); 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-05-15T21:56:07.177

你必须听`reset`事件，而不是`change`事件。

所以：

```
myCollection.bind('reset', this.render, this); 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-05-15T21:58:54.900

[Backbone 在成功完成fetch()](http://documentcloud.github.com/backbone/#Collection-fetch)时触发[“重置”事件](http://documentcloud.github.com/backbone/#FAQ-events)，而不是更改事件

```
var myView = Backbone.View.extend({

    initialize: function ()
    {
        myCollection.bind('reset', this.render);
        myCollection.fetch(); // it works
    },

    render: function ()
    {
        // some code
    }

}); 
```

# java - 正则表达式多行与html代码？

> ID：10609298
> 
> 赞同：0
> 
> 时间：2012-05-15T21:48:22.577
> 
> 标签：java, regex

如何使用正则表达式提取以下内容？

```
String string = "<h1>1st header</h1>" + "<h2>second header</h2>" +
"<p>some text</p>" + "<hr />";

Pattern p = Pattern.compile("</h1>(\\S+)<hr />", Pattern.MULTILINE); 
```

输出为空，但为什么呢？

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-05-15T21:57:03.983

输出为空，因为 和 之间的字符`</h1>`包含`<hr />`空格。`\S+`一旦遇到空格，您将失败。

如果您替换`\\S+`为 ，`.+`它应该会捕获您**高度具体的示例字符串中的所有内容。**但是，如果您想“正确”执行此操作，并且能够匹配不完全适合您的示例的任意 HTML，请使用[HTML Agility Pack](http://htmlagilitypack.codeplex.com/)之类的 HTML 解析器。基于解析器的版本将简单、正确，并且不会[危及您的理智和/或宇宙。](https://stackoverflow.com/a/1732454/399649)

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2012-05-15T21:54:15.230

正则表达式 \S+ 将不匹配“某些文本”之间的空格。此外，[如果您重视 sanity，请不要使用正则表达式来解析 HTML](https://stackoverflow.com/questions/1732348/regex-match-open-tags-except-xhtml-self-contained-tags#1732454)。

# php - 将变量从 flash 传递到 php 和 mysql

> ID：10609302
> 
> 赞同：0
> 
> 时间：2012-05-15T21:48:57.790
> 
> 标签：php, mysql, actionscript-2

我有一个名为：name 的变量和一个名为 score 的变量。

我想在发布时将它们发送到我本地主机上的数据库，以便我可以在页面上显示它们。我如何发送这两个变量并将它们添加到 mysql DB 中？

我正在使用动作脚本 2.0

谢谢

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-05-15T21:58:10.707

从 actionscript 2 你需要使用`LoadVars`.

```
your_btn.onRelease = function() {
    lv = new LoadVars();
    lv.score = score;
    lv.name = name;
    lv.load("http://localhost/send.php", "POST");
    lv.onLoad = function(src:String) {
        if (src) {
            // OK. src contains the output of the PHP file.
            // i.e. what you "print" or "echo" from php.
            trace(src);
        } else {
            // Problem. Most probably there's an error if src is undefined.
        }
    };
}; 
```

在 PHP 中，您可以从`$_POST`数组中获取它们，然后使用`mysqli`.

```
$score = $_POST['score'];
$name = $_POST['name'];

// See a tutorial on how to add them to database.
// You need to connect to MySQL, then do an INSERT query to your table. 
```

[Mysqli Docs](http://www.php.net/manual/en/mysqli.query.php)，或者搜索一些关于 MySQL 和 php 的教程，有很多。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-05-15T21:53:27.650

您可以使用 URL 中的 GET 参数将参数从 Flash 传递到 PHP。

首先在 Flash 中制作 URL，例如`http://www.your-site.org/page.php?name=John&age=21`.

然后在 PHP 中访问您的 GET 参数，例如`$name = $_GET["name"]; $age = $_GET["age"];`

# javascript - 隐藏元素，但显示为空白

> ID：10609304
> 
> 赞同：1
> 
> 时间：2012-05-15T21:49:01.157
> 
> 标签：javascript, jquery, css, html

任何人都可以解释我应该修改什么，隐藏图像后如何将 div 保持为空白，没有内容，但宽度和高度与图像相同，

**确切的例子：http: [//jsfiddle.net/rJuWL/1/](http://jsfiddle.net/rJuWL/1/)**

于是躲了起来，二！来到第一！，但我需要保持第一！空白秒！

html

```
<html>
<body>
    <div>First!</div>
<div class="loading">
<img id="loading" src="http://preloaders.net/preloaders/284/preview.gif" class="none"/>
    <div>Second!</div>
</div>
</body> 
```

CSS

```
.none{display:none}
.loading{width: 32px;height:32px;} 
```

Javascript

```
showLoading();    
function showLoading() {
  $("#loading").hide();
  $("#loading").show().delay(2500).fadeOut('10');
} 
```

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2012-05-15T21:50:00.097

不要隐藏它`display:none`，设置`visibility:hidden`

`display:none`会将其从 DOM 流中移除。更改`visibility`to`hidden`将保留它，但模拟设置`opacity`为 0。

这是一个快速演示，可让您的`fadeOut` [http://jsfiddle.net/AlienWebguy/5cwE7/](http://jsfiddle.net/AlienWebguy/5cwE7/)

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-05-15T21:56:13.667

我会使用不透明度。

```
showLoading();    
function showLoading() {
  $("#loading").fadeTo(0,0);
  $("#loading").fadeTo(0,1).delay(2500).fadeTo(10,0);
} 
```

第一个`0`是持续时间，第二个是不透明度。`1`为了展示，`0`为了隐藏。

但是，您的代码并没有真正的意义。为什么要隐藏它然后立即显示它，然后等待 2 秒半并隐藏它？

我认为不需要初始隐藏（`showLoading()`我的代码中函数的第一行）

编辑：

或者，您可以使用`.css("opacity",0)`代替`.fadeTo(0,0)`，它很可能更有效。

# python - 表示 numpy 省略号

> ID：10609313
> 
> 赞同：2
> 
> 时间：2012-05-15T21:49:53.310
> 
> 标签：python, numpy, slice

例如，我知道如何用 numpy 对数组进行切片

```
v[1, :, :] 
```

现在我想要一个函数将切片作为输入`(1,1,None)`并返回`v[1,:,:]`

问题是我不知道如何表示椭圆

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-05-15T21:53:17.117

您可以用 表示椭圆`Ellipsis`。

[这里](http://docs.python.org/release/2.5.2/lib/bltin-ellipsis-object.html)提到

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-06-11T13:07:44.257

```
slice(None) 
```

所有这些都是等价的：

```
v[1, :, :]
v[1, Ellipsis, Ellipsis]
v[1, slice(None), slice(None)]
v[(1, Ellipsis, Ellipsis)]
v[(1, slice(None), slice(None))] 
```

最后两个是我需要的。

# ios - 如何使 MKMapView 上的注释中的 Popover 像 Apple 这样的地图滚动？

> ID：10609314
> 
> 赞同：3
> 
> 时间：2012-05-15T21:49:53.507
> 
> 标签：ios, ipad, map, mkmapview, popover

如果您在 iPad 上触摸 Apple 内置地图应用程序上的注释，您将获得带有“显示”标注附件的标准标注。当您按下附件时，您会看到一个漂亮的 Popover 视图，其中包含有关注释标记的更多详细信息。

这一切都很容易模仿。

然而。当您滚动和缩放地图时，Apple 的 Popover 实际上保持打开状态并随地图移动。这很甜蜜。听起来很简单，但我尝试了很多方法来模仿它，但都失败了！有没有人设法模仿这个？

![Apple 地图应用程序的屏幕截图](../Images/5e227226ef529dca5af62c40d34c2fb9.png)

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-06-23T21:37:50.407

听起来弹出框被添加到 UiScrollView 的子视图以外的视图中 - 这是实际被移动的视图。

如果您在 presentPopoverFromRect:inView:permittedArrowDirections 中传递对子视图的引用，则应该将弹出框添加为滚动视图的子视图的子视图，并允许它随着地图（或正在滚动的任何视图）的移动而移动。不过，我不确定它是地图而不是普通 UIScrollView 是否会影响事情。

# groovy - Groovy 运算符重载增量/减量错误

> ID：10609319
> 
> 赞同：2
> 
> 时间：2012-05-15T21:50:09.410
> 
> 标签：groovy, operator-overloading, overloading

我有以下 Groovy 代码片段，它试图将运算符重载用于递增、递减和等于。所有这一切都是创建两个实例，执行其中一个实例的递增和递减，然后使用重载方法 equals 比较这两个实例。当我进行比较时，它失败了。当此代码完成时，两者都应为 100。（打印语句显示它，但其中一个`toString()`功能似乎是错误的）。我在这里做错了什么？

这是 groovy 1.8.6

```
class Overload {
    def value

    public Overload(value = 0) {
        this.value = value
    }

    def next() {
        value = value + 1;
    }

    def previous() {
        value = value - 1;
    }

    def boolean equals(other) {
        if (value == other?.value) {
            return true
        }

        return false
    }

    def String toString() {
        "value is = ${value}"
    }
}

def cls1 = new Overload(100)
def cls2 = new Overload(100)

cls1++
cls1--
if (cls1 == cls2) {
    println("cls1 == cls2")
}
else {
    println("cls1 != cls2")
}

println(cls1.toString())
println(cls2.toString()) 
```

输出：

```
cls1 != cls2
100
value is = 100 
```

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2012-05-15T23:06:44.550

问题是`Overload`实例的增量和减量方法。

Groovy 具有隐式返回最后评估的表达式的特性。当您调用 to 时`cls1++`，现在对象是一个整数，这就是我们看不到被覆盖`toString`方法的输出的原因。

```
def next() {
    value = value + 1
    return this
}

def previous() {
    value = value - 1
    return this
} 
```

现在检查：

```
assert cls1.class == Overload
assert cls2.class == Overload
assert cls1 == cls2
assert cls1 == 100
assert cls2 == 100 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-05-16T08:47:02.190

作为一个快速的附加评论，您不需要`def`在定义方法的返回类型时使用。您的课程更简洁的版本是：

```
class Overload {
    def value

    public Overload(value = 0) {
        this.value = value
    }

    def next() {
        value = value + 1
        this
    }

    def previous() {
        value = value - 1
        this
    }

    boolean equals(other) {
        value == other?.value
    }

    String toString() {
        "value is = ${value}"
    }
} 
```

# ruby-on-rails - Gemfiles 和 Webrick 的依赖问题

> ID：10609320
> 
> 赞同：1
> 
> 时间：2012-05-15T21:50:13.353
> 
> 标签：ruby-on-rails, ssl, webrick

我一直在尝试将 webrick 配置为在我的应用程序的所有页面上使用 SSL。

我添加了

```
gem 'rack-ssl', :require => 'rack/ssl' 
```

到我的 gem 文件和

```
config.middleware.insert_before ActionDispatch::Static, "Rack::SSL"
config.force_ssl = true 
```

到我的 /config/application.rb 文件。我将 webrick 配置为使用我的自签名证书，方法是修改我的 /script/rails 文件看起来像这样

```
require 'rubygems'
require 'rails/commands/server'
require 'rack'
require 'webrick'
require 'webrick/https'

module Rails
  class Server < ::Rack::Server
    def default_options
      super.merge({
          :Port => 3001,
          :environment => (ENV['RAILS_ENV'] || "development").dup,
          :daemonize => false,
          :debugger => false,
          #:pid => File.expand_path("tmp/pids/server.pid"),
          :config => File.expand_path("config.ru"),
          :SSLEnable => true,
          :SSLVerifyClient => OpenSSL::SSL::VERIFY_PEER,
          :SSLPrivateKey => OpenSSL::PKey::RSA.new( File.open("home/sureweb/rubystuff/server.cert.key").read),
      :SSLCertificate => OpenSSL::X509::Certificate.new(File.open("home/sureweb/rubystuff/server.cert.crt").read),
          :SSLCACertificateFile => 'home/sureweb/rubystuff/server.crt',
          :SSLCertName => [["CN", WEBrick::Utils::getservername]]
     })
    end
  end
end

APP_PATH = File.expand_path('../../config/application',  __FILE__)
require File.expand_path('../../config/boot',  __FILE__)
require 'rails/commands' 
```

但是每次我运行 rails s 我都会收到一条消息说

```
You have already activated activesupport 3.2.3, but your Gemfile requires activesupport 3.0.12\. Using bundle exec may solve this. (Gem::LoadError) 
```

通常我可以通过删除版本 3.2.3 来解决这个问题，但是我有许多其他依赖它的 gem，所以这不是一个选择。还有另一种方法可以让这个工作吗？

# jquery - jquery将每个元素从选择器传递给函数，制作选择最后一个元素的数组

> ID：10609323
> 
> 赞同：1
> 
> 时间：2012-05-15T21:50:30.113
> 
> 标签：jquery, function, selector

我有一些这样声明的函数来检查元素的某些东西（真，假）：

```
(function($) {
$.myfunc = function(element, settings) {
    // skiped return comparison
};

})(jQuery); 
```

然后我想用这个函数作为一个额外的选择器。我正在尝试这样的某个时候（当然是错误的代码）：

```
var lastprl = $("a[prl]").filter(function() { $.myfunc($(this), {param : 0}) }).last(); 
```

似乎主要思想是用我的函数过滤元素，然后`.last()`从数组中选择。请帮助修复此代码。也许我错误地使用`$.myfunc`了电话？或者是其他东西？

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-05-15T21:55:00.643

`.filter()`需要你给它的函数的返回值。你`return`的不见了。

```
.filter(function() { return $.myfunc($(this), {param : 0}) })
        // ------------^^^ 
```

还要确保`$.myfunc`返回布尔结果。

# prolog - Prolog：a(b,c) 和 a(X,Y):-a(Y,X)，查询 a(c,b) 返回无限真？

> ID：10609324
> 
> 赞同：3
> 
> 时间：2012-05-15T21:50:32.980
> 
> 标签：prolog

这是我的知识库：

```
a(b,c). 
a(X,Y):-a(Y,X). 
```

这是我的查询：`a(c,b).`

我正在使用 SWI-Prolog。我认为这个查询会导致程序打印“true”。但是，如果我按分号，它会打印“真”并继续打印真......直到永远。

为什么停不下来？

我的想法：首先，X 绑定到 b，Y 绑定到 c。然后，Prolog 测试 a(b,c) 并​​发现这是真的。因此，a(c,b) 也为真，SWI-Prolog 应该打印一次为真。但是，由于只要我一直按那个分号，它就会永远打印出来，这让我认为递归正在发生。这发生在哪里？帮助！

编辑：更具体地说，我的问题是为什么程序在每个“真”之后暂停并等待我按分号或另一个键而不是完成？如果我有两个谓词 human(socrates) 和 mortal(X):-humans(X)，则对查询 mortal(socrates) 的响应将是一个“真”。（对不起，如果我没有在上面说清楚。）

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-05-15T21:59:31.187

Prolog 首先`a(c,b)`通过第二条规则证明，然后是第一条规则。`a(c,b)`然后，它通过对第二条规则和第一条规则的三次调用来证明。然后，通过对第二条规则的五次调用，等等。Prolog 的推理算法是没有封闭集的深度优先搜索，即它不跟踪它已经证明的内容，并且很乐意再次证明它。

如果您不想要这种行为，您应该将规则重写为，例如，

```
a_fact(b, c).
a(X, Y) :- a_fact(X, Y).
a(Y, X) :- a_fact(X, Y). 
```

...或使用某种[表格执行](http://en.wikipedia.org/wiki/Prolog#Tabling)。不过，我不认为 SWI-Prolog 支持表格。

# c++ - 如何复制或连接两个 char*

> ID：10609326
> 
> 赞同：4
> 
> 时间：2012-05-15T21:50:42.037
> 
> 标签：c++, strcpy, strcat

您如何将 char* 连接或复制在一起？

```
char* totalLine;

const char* line1 = "hello";
const char* line2 = "world";

strcpy(totalLine,line1);
strcat(totalLine,line2); 
```

此代码产生错误！

```
segmentation fault 
```

我猜我需要为 totalLine 分配内存？

另一个问题是，下面是复制内存还是复制数据？

```
char* totalLine;

const char* line1 = "hello";

 totalLine = line1; 
```

提前致谢！:)

* * *

## 回答 #1

> 赞同：15
> 
> 时间：2012-05-15T21:52:47.450

> 我猜我需要为 totalLine 分配内存？

是的，你猜对了。 `totalLine`是一个未初始化的指针，所以这些`strcpy`调用试图写入内存中的某个随机位置。

幸运的是，当您标记了这个 C++ 时，您无需为所有这些烦恼。只需这样做：

```
#include <string>

std::string line1 = "hello";
std::string line2 = "world";

std::string totalLine = line1 + line2; 
```

无需内存管理。

> 下面是复制内存还是复制数据？

我认为您的意思是“是复制了基础字符串，还是仅复制了指针？”。如果是这样，那么只是指针。

* * *

## 回答 #2

> 赞同：8
> 
> 时间：2012-05-15T21:54:28.553

是的，您需要将内存分配给`totalLine`. 这是一种方法；这恰好是我推荐的方法，但还有许多其他方法也一样好。

```
const char *line1 = "hello";
const char *line2 = "world";

size_t len1 = strlen(line1);
size_t len2 = strlen(line2);

char *totalLine = malloc(len1 + len2 + 1);
if (!totalLine) abort();

memcpy(totalLine,        line1, len1);
memcpy(totalLine + len1, line2, len2);
totalLine[len1 + len2] = '\0'; 
```

**[编辑：**假设这是一个 C 问题，我写了这个答案。在 C++ 中，正如 Oli 建议的那样，只需使用`std::string`. **]**

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2019-06-15T15:07:58.027

`totalLine`有垃圾值

```
const char* Line1{ "Hallo" };  
const char* Line2{ "World" };   
char* TotalLine{ new char[strlen(Line1) + strlen(Line2) + 1] };

TotalLine = strcpy(TotalLine, Line1);
TotalLine = strcat(TotalLine, Line2); 
```

> 注意=> 如果你在 Visual Studio 上工作，你需要`#define _CRT_SECURE_NO_WARNINGS`

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2020-04-14T03:00:52.777

将“aaa”和“bbb”集中到“aaabbb”：

```
#include <iostream>
#include <cstring>
using namespace std;

int main() {
    const char* Line1 ="aaa";
    const char* Line2 ="bbb";
    char* TotalLine{ new char[strlen(Line1) + strlen(Line2) + 1] };
    TotalLine = strcpy(TotalLine, Line1);
    TotalLine = strcat(TotalLine, Line2);   
    cout << TotalLine <<endl;
} 
```

# c# - Asp.net + ajaxcontroltoolkit 4 + html 编辑器扩展器 + sanitizer

> ID：10609327
> 
> 赞同：1
> 
> 时间：2012-05-15T21:50:45.747
> 
> 标签：c#, webforms, ajaxcontroltoolkit, sanitization

好的，问题很简单。我已经在我的 webforms 4 应用程序中成功设置了一个 html 编辑器扩展器。一切正常。

进一步阅读 tuts 并找到一部分，当他们强烈建议使用 ajaxcontroltoolkit 4 附带的消毒剂时。太好了，我告诉自己。按照教程进行设置，一切正常。

好吧，几乎所有内容 - 提交后格式都消失了。似乎消毒剂会去除每个标签，从而导致我心爱的 html 编辑器扩展器突然变成带有精美按钮的非常标准的文本区域。

所以，我尝试禁用消毒剂并检查输出，如果输入恶意脚本后真的那么危险。输出是标准的 html 编码文本。

我的问题是——我真的需要这么推荐的消毒剂吗？我错过了什么？如果是，请解释我们为什么需要它以及如何让它发挥作用。

PS：我相信我不必包含源代码，因为它几乎遵循官方教程关于如何让它工作。如果您认为不同，请告诉我，我将编辑帖子以在此处包含相关部分...

编辑：

问题是不清楚还是为什么它只有 17 个视图？给我评论，以便我可以改进它......

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-05-24T00:17:18.200

似乎这篇文章几乎描述了我正在经历的行为......

[http://wpl.codeplex.com/workitem/17246](http://wpl.codeplex.com/workitem/17246)

换句话说，一些奇怪的错误，到目前为止唯一的修复是等待库的更新/补丁......或者恢复到以前的版本。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2017-04-09T08:47:57.477

为了解决这个问题，我登录到我的 plesk 帐户并在 asp.net 设置页面中将“CAS 信任级别”更改为高（从中等）

# objective-c - iOS 比较数组和集合

> ID：10609331
> 
> 赞同：0
> 
> 时间：2012-05-15T21:51:23.603
> 
> 标签：objective-c, ios, nsarray, nsset

我正在尝试比较两个数组以查看它们是否匹配-我的测试用例是“赢家”，我一直在尝试将它们与 halArray 和 playerArray 进行比较，但没有成功。即使我知道例如 playerArray 和 win1 都有相同的对象，但它们似乎并不匹配并触发我的 NSLOG()

这就是获胜者数组的设置方式

```
NSArray  *win = [NSArray arrayWithObjects:@"0",@"1",@"2",nil];
winners = [NSArray arrayWithObjects: win1,win2,win3,win4,win5,win6,win7,win8,nil]; 
```

阵容和球员的填充方式

```
-(void)checkSpace:(NSString *)playerName spot:(int)selectedSpot
{
    NSString *p = playerName;
    int s = selectedSpot;
    NSNumber* gameSpace = [NSNumber numberWithInt:s];

    if (p == comp)
    {    
        [halArray addObject:gameSpace];        
        [self checkWin];
    }
} 
```

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-05-16T01:20:34.190

问题是您正在使用 's 填充 win 数组`NSString`并将它们与`NSNumber`您填充的 ​​'s进行比较`halArray`。

**他们永远不会匹配。**

从这里改变这个（和另一个胜利）：

```
NSArray  *win1 = [NSArray arrayWithObjects:@"0",@"1",@"2",nil]; 
```

对此：

```
NSArray  *win1 = [NSArray arrayWithObjects:[NSNumber numberWithInt:0],
                                           [NSNumber numberWithInt:1],
                                           [NSNumber numberWithInt:2],
                                           nil]; 
```

**或者**

添加`NSString`'s 而不是`NSNumbers`to `halArray`and `playerArray`。

# javascript - XSS 安全 - 删除所有脚本，允许其他所有内容

> ID：10609333
> 
> 赞同：1
> 
> 时间：2012-05-15T21:51:34.717
> 
> 标签：javascript, html, xss, sanitization

我们在我们的网页上显示 3rd 方 HTML，它应该正确呈现大多数内容，包括链接和图像。我们基本上想对所有脚本进行清理，即

```
<script>...</script> 
```

但事情可能会变得非常有创意。脚本可以显示在“脚本”标签之外的一个简单情况是

```
<a href="javascript:alert('XSS')"> 
```

我们绝对需要允许链接。

事实上，我相信你们中的许多人都知道，这个问题非常残酷： [http ://ha.ckers.org/xss.html](http://ha.ckers.org/xss.html)

如果您处于用户向您的网站发表评论的情况，您可以逃避所有 HTML，或者转义除`<em>`、`<i>`和. 在我的情况下，我们需要允许所有 HTML 但禁用所有脚本，这要困难得多，但并非不常见的要求。是否有支持这种级别的 HTML 许可和 XSS 安全的库或工具？`<u>``<s>`

语言，按优先顺序排列：Python、PHP、Java、C/C++。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-05-15T22:01:49.537

您是否考虑过使用 PHP 框架 CodeIgnitor？

有一个包含 xss_clean() 函数的安全类以及更多看起来可以非常接近地满足您的需求的安全类。

[http://codeigniter.com/user_guide/libraries/security.html](http://codeigniter.com/user_guide/libraries/security.html)

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-05-15T22:01:16.657

AFAIK，该站点仅列出了整个 XSS 注入。类似的方法[`strip_tags`](http://us.php.net/manual/en/function.strip-tags.php)不适用于分段（多点）注入，我认为它更隐蔽。您可以做的最好的事情是在将字符显示到页面之前使用[PHP 之`htmlentities`](http://php.net/manual/en/function.htmlentities.php)类的东西对字符进行编码。但这会阻止显示 HTML。

你可以做替代标记，比如论坛是如何做的（那些有`[code][/code]`语法的）。还可以考虑使用[Markdown](http://en.wikipedia.org/wiki/Markdown)，这是 StackOverflow 中使用的相同编辑器，如果您只需要文本格式，它很容易使用。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-05-15T22:30:07.227

我建议您可以找到最强大的 XSS 预防措施。一般来说，最好的方法是将您想要允许的元素和属性（和值）列入白名单，而不是将不允许的元素和属性（和值）列入黑名单。

我只能在[HTML Purifier](http://htmlpurifier.org/)中提供基于 PHP 的解决方案，除了安全性之外，它还有助于确保您的标记有效（非常适合用户提交的 HTML 片段）。

我看到您找到了[http://ha.ckers.org/](http://ha.ckers.org/) - 我还建议使用[OWASP](https://www.owasp.org/index.php/Cross-site_Scripting_%28XSS%29)（开放 Web 应用程序安全项目）作为资源。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2012-05-15T22:00:57.627

您可以使用 javascript（或 jQuery）在页面提交之前检查您的 href 是否具有`<a>`使用正则表达式的任何标签的 http:// 形式。

# jakarta-ee - 为什么这个简单的 JPA ManyToOne 关系不起作用？

> ID：10609334
> 
> 赞同：0
> 
> 时间：2012-05-15T21:51:37.630
> 
> 标签：jakarta-ee, jpa

我将 JPA 与 Java EE 5（IBM RAD 7.5 和 WebSphere 7）一起使用。我已将问题简化为以下示例...

我有一个项目和一个用户。表格如下所示：

```
PROJECT
--
id
name
projectmanagerid // is a User

USER
--
id
username 
```

我的课程如下所示：

```
@Entity
@Table(name="PROJECT")
class Project
  @Id
  @GeneratedValue(...)
  Long id;
  String name;
  @ManyToOne(fetch=FetchType.EAGER)
  @JoinColumn(name="projectmanagerid");
  User projectManager;

@Entity
@Table(name="USER")
class User
  @Id
  @GeneratedValue(...)
  Long id;
  String username; 
```

要检索我的项目，我这样做：

```
Query query = em.createQuery("select distinct p from Project p");
query.getResult... 
```

一切正常，除了`project.projectManager`is always `null`。

不应该`FetchType.EAGER`导致用户被填充？我究竟做错了什么？

任何建议都非常感谢！

抢

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-05-22T13:05:12.087

看起来我找到了问题的答案，所以我会在这里发布。希望它可以帮助其他人。

在 IBM RAD 7.5 中，JPA 项目属性有一个名为“平台”的设置。默认值为“RAD JPA 平台”。当我将它更改为“通用”时，现在它可以工作了。

注意：我也按照 tomred 的建议更改`@JoinColum`为，不确定是否有任何作用。`@Column`

谢谢大家！

抢

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-05-19T00:56:55.510

在这种情况下，您应该能够将其与 @Column 注释映射，因为连接列是例如引用位于关系另一侧的位置

项目->（有一个）用户然后项目有@Column，名称为=“projectmanagerid”

如果另一方面有用户引用的项目，那么您将拥有

用户 - >（有一个）项目然后项目有@JoinColumn 名称=“projectid”

目前您说用户表有一个名为 projectmanagerid 的引用列，但事实并非如此。

我希望这会有所帮助，汤姆雷德

# css - IE中的背景位置问题

> ID：10609335
> 
> 赞同：1
> 
> 时间：2012-05-15T21:51:42.193
> 
> 标签：css, internet-explorer, background-position

我在 IE 所有版本中设置背景图像时遇到问题，它在所有其他浏览器中都可以正常工作，任何人都可以帮助我解决任何可能的 css hack 或任何建议，任何帮助或建议将不胜感激，谢谢，下面是链接： [网站](http://sales.b2bleadforce.com/blog/)

此外，在其他页面上，背景图像不会重复。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-05-15T22:01:53.303

看看[你的css的验证](http://jigsaw.w3.org/css-validator/validator?uri=http://sales.b2bleadforce.com/css/layout.css&profile=css3&usermedium=all&warning=1&vextwarning=&lang=en)

> 属性 background-position-x 不存在 : center 属性
> 
> 背景位置-y 不存在：200px

将 .page 上的 CSS 更改为类似

```
.page {
  background: url('../images/body-bg.png') no-repeat center 200px;
  top: 200px;
  margin: 0 auto;
} 
```

[在https://developer.mozilla.org/en/CSS/background](https://developer.mozilla.org/en/CSS/background)了解有关背景 css 的更多信息

# java - 尝试将 vlcj 媒体播放器嵌入 JPanel 内的 WindowsCanvas

> ID：10609338
> 
> 赞同：4
> 
> 时间：2012-05-15T21:51:57.443
> 
> 标签：java, video, jpanel, vlcj

我正在尝试在 JPanel 中使用 vlcj 播放视频，但它对我不起作用。我收到的消息异常是 "java.lang.IllegalStateException: The video surface component must be displayable" ，这与[Keep getting an Error "Component must be displayable"](https://stackoverflow.com/questions/4830567/keep-getting-an-error-component-must-be-displayable)中的问题相同。

包含画布和 vlcj 播放器的 JPanel 的代码是这样的：

```
import javax.swing.JPanel;

import com.sun.jna.Native;
import com.sun.jna.NativeLibrary;

import java.awt.Canvas;
import java.awt.Color;

import uk.co.caprica.vlcj.binding.LibVlc;
import uk.co.caprica.vlcj.player.MediaPlayerFactory;
import uk.co.caprica.vlcj.player.embedded.EmbeddedMediaPlayer;
import uk.co.caprica.vlcj.player.embedded.videosurface.CanvasVideoSurface;
import uk.co.caprica.vlcj.runtime.RuntimeUtil;
import uk.co.caprica.vlcj.runtime.windows.WindowsCanvas;

public class MyJPanel extends JPanel {
private EmbeddedMediaPlayer player;
private WindowsCanvas canvas;

public MyJPanel() {
    canvas = new WindowsCanvas();
    add(canvas);
    revalidate();
    repaint();

    canvas.setVisible(true);

    MediaPlayerFactory mediaPlayerFactory = new MediaPlayerFactory();
    player = mediaPlayerFactory.newEmbeddedMediaPlayer();

    CanvasVideoSurface videoSurface = mediaPlayerFactory.newVideoSurface(canvas);

    player.setVideoSurface(videoSurface);
    player.playMedia("v.avi");   // This sentence throws the exception.
}
} 
```

MyJFrame 扩展了 JFrame 并且仅包含 MyJPanel JPanel。我认为这根本不重要。

```
import javax.swing.JFrame;

public class MyJFrame extends JFrame {
protected MyJPanel myJPanel;

public static void main(String[] args) {
    EventQueue.invokeLater(new Runnable() {
        public void run() {
            try {
                MyJFrame frame = new MyJFrame();
                frame.setVisible(true);
            } catch (Exception e) {
                e.printStackTrace();
            }
        }
    });
}

public MyJFrame() {
    myJPanel = new myJPanel();
    add(myJPanel);
}   
} 
```

提前致谢。

* * *

## 回答 #1

> 赞同：8
> 
> 时间：2012-05-16T15:52:28.697

您正在尝试在包含画布的框架设置为可见之前播放媒体。您需要将`playMedia()`调用放在一个单独的方法中，并在创建整个框架并将其设置为可见*后调用它。*

编辑：

如果您仍然希望它直接播放，只需在创建框架并使其可见后调用相关方法：

```
MyJFrame frame = new MyJFrame();
frame.setVisible(true);
frame.startPlaying(); 
```

...显然，您需要`startPlaying()`在 MyJFrame 上进行定义，但它应该立即开始播放。你只需要先设置可见的框架。

# ruby-on-rails - RSpec - 测试之外的未初始化变量

> ID：10609340
> 
> 赞同：2
> 
> 时间：2012-05-15T21:52:04.763
> 
> 标签：ruby-on-rails, rspec

抱歉，我不知道如何更好地表达标题，但这是我测试的大致思路：

```
describe Model do
  let(:model) { FactoryGirl.create(:model) }
  subject { model }

  it { should be_valid }

  model.array_attribute.each do |attribute|
    context "description" do
      specify { attribute.should == 1 }
    end
  end
end 
```

问题是在该行`model.array_attribute.each do |attribute|`，我得到一个未定义局部变量或方法的错误`model`。我知道它`let(:model)`正在工作，因为验证（除其他外）工作正常。我怀疑这个问题是因为它在任何实际*测试*之外被调用（即`specify`，`it`等）。

关于如何让它发挥作用的任何想法？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-05-15T22:02:20.940

`model`这里是未知的，因为它只在 specs 块上下文中评估。

执行以下操作：

```
describe Model do
  def model
    FactoryGirl.create(:model)
  end

  subject { model }

  it { should be_valid }

  model.array_attribute.each do |attribute|
    context "description" do
      specify { attribute.should == 1 }
    end
  end
end 
```

顺便说一句，[这里读得很好](http://blog.davidchelimsky.net/2012/05/13/spec-smell-explicit-use-of-subject/)。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-05-15T22:04:53.743

我用以下代码解决了这个问题：

```
describe Model do
  let(:model) { FactoryGirl.create(:model) }
  subject { model }

  it { should be_valid }

  it "description" do
    model.array_attribute.each do |attribute|
      attribute.should == 1
    end
  end
end 
```

# jquery - 当我slideToggle ... css3时，jquery正在为高度设置内联样式？

> ID：10609342
> 
> 赞同：1
> 
> 时间：2012-05-15T21:52:15.867
> 
> 标签：jquery, css, height, shadowbox

`#shadowBox`当我使用时，Jquery 正在为我的高度添加内联样式`slideToggle()`我不知道为什么会发生这种情况或如何摆脱它...... [http://test.yamiko.org/cp/](http://test.yamiko.org/cp/#)是页面。当您单击登录或联系时，shadowBox 会动画。

```
//login script
$('#header a[title="Sign In"], #login>button').click(function()
{
    if($('#login').is(':visible'))
    {$('#login').slideUp(1000).parent('#shadowBox').delay(1000).fadeToggle(1000);}
    else{$('#shadowBox').fadeToggle(1000).children('#login').delay(1000).slideDown(1000);}
}); 
```

我已经尝试过 `$('#shadowBox').height($(document).height());`，但它被内联样式覆盖。

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-05-15T22:01:50.693

slideDown 方法允许一个可选的回调，你可以改变

```
$('#shadowBox').fadeToggle(1000).children('#login').delay(1000).slideDown(1000);} 
```

至

```
$('#shadowBox').fadeToggle(1000).children('#login').delay(1000).slideDown(1000, function() { 
  $('#shadowBox').height("100%"); 
}); 
```

如果您想完全删除高度，可以将我的最后一个示例更改为

```
$('#shadowBox').fadeToggle(1000).children('#login').delay(1000).slideDown(1000, function() { 
  $('#shadowBox').height(""); 
}); 
```

# typo3 - 强制 tt_news 始终检索新帖子

> ID：10609345
> 
> 赞同：0
> 
> 时间：2012-05-15T21:52:39.127
> 
> 标签：typo3, tt-news

是否可以强制 tt_news 始终检索新帖子？

我有一个插件，允许用户在前端发布新闻。
新闻被插入到 tt_news 表中，用户被重定向到列出新闻的页面。但是用户发布的最新消息是不可见的。

我必须等待几秒钟，然后重新加载页面。这确实破坏了网站的可用性。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-05-16T06:50:38.187

有几种解决方案：

1）将页面设置为“不缓存”（编辑页面属性）。但这会阻止 indexed_search 搜索该站点，这可能没问题。

2）添加一个钩子，清除该站点的缓存（看看t_c_emain.html#a339ac0da0377744f512bf790e79f5563">http://api.typo3.org/typo3v4/current/html/classt3lib_t_c_emain.html#a339ac0da0377744f512bf790e79f5536）

3) 添加 &no_cache=1 并将页面的缓存时间设置为几分钟（这样页面将通过 indexed_search 进行索引）

4) 编写一个 AJAX 脚本 (eID)，请求尚未显示的最新新闻记录。

我想，这取决于你的需要走哪条路。1) 从开发人员的角度来看是最快的，但从性能的角度来看是最差的。2）对开发人员来说更难，也许对性能更好，3）介于两者之间。4）如果有很多用户，也许是一个更好的解决方案

# android - 从 doInBackground 返回时，AsynchTask 崩溃

> ID：10609346
> 
> 赞同：0
> 
> 时间：2012-05-15T21:52:40.597
> 
> 标签：android

我有以下代码：

```
public class TestSynch extends Activity {

public static ArrayList<HashMap<String,String>> list;

public void onCreate(Bundle savedInstanceState) {
    super.onCreate(savedInstanceState);

    setContentView(R.layout.splash);
    Context ctx = this.getApplicationContext();

    new ProcessFileTask().execute(ctx);

    Intent i = new Intent(TestSynch.this, ListSchools.class);
    i.setAction(Intent.ACTION_VIEW);
    i.putExtra("arraylist", list);
    startActivity(i);

}

private class ProcessFileTask extends AsyncTask<Context, Void, ArrayList<HashMap<String,String>>> {
    @Override
    protected ArrayList<HashMap<String,String>> doInBackground(Context... ctx) {

        ArrayList<HashMap<String,String>> threadList = FileOperations.getListAsMaps(ctx[0]);
        return threadList;
    }
    @Override
    protected void onPostExecute(ArrayList<HashMap<String,String>> result) {
         list = result;
        return;
    }
} 
```

我可以调试到返回threadList；doInBackground 中的行，并且 ArrayList 变量 threadList 是完全正确的。

但是，onPostExecute 似乎没有被调用，并且 Activity 在从 doInBackground 返回时崩溃，LogCat 建议 nullPointerException 试图触发 Intent（在我开始弄乱 AsynchTask 之前我已经测试过并且工作正常）

知道为什么会这样吗？代码看起来很简单......

谢谢

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-05-15T21:57:43.763

您需要在 Async 的**onPostExecute**方法中移动**startActivity部分。**

 **例如：

```
public class TestSynch extends Activity {

//public static ArrayList<HashMap<String,String>> list;

public void onCreate(Bundle savedInstanceState) {
    super.onCreate(savedInstanceState);

    setContentView(R.layout.splash);
    Context ctx = this.getApplicationContext();

    new ProcessFileTask().execute(ctx);
}

private class ProcessFileTask extends AsyncTask<Context, Void, 
        ArrayList<HashMap<String,String>>> {
    @Override
    protected ArrayList<HashMap<String,String>> doInBackground(Context... ctx) {

        ArrayList<HashMap<String,String>> threadList = 
             FileOperations.getListAsMaps(ctx[0]);

        return threadList;
    }
    @Override
    protected void onPostExecute(ArrayList<HashMap<String,String>> result) {
         Intent i = new Intent(TestSynch.this, ListSchools.class);
         i.setAction(Intent.ACTION_VIEW);
         i.putExtra("arraylist", result);
         startActivity(i);
    }
} 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-05-15T22:05:50.063

我认为瓦卡斯是正确的。您正在执行一个`AsyncTask`执行后设置 `public static`变量的操作`list`。此列表用于传递到`Intent`您在 中创建的`onCreate`。但是，不能保证`AsyncTask`在您创建`Intent`. 因此，`list`此时的值为`null`。

因此，正如 Waqas 建议的那样，您需要在为设置值`Intent` *之后*`list`创建，即在 内`onPostExecute`。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-05-15T22:11:20.570

澄清一下，AsyncTask 是异步执行的，正如它的名字所暗示的那样。当您调用
new ProcessFileTask().execute(ctx)
时，那段代码会关闭并执行它的工作，但随后您的代码的其余部分会继续执行，这意味着在您尝试开始时可能不会填充列表新的 Intent，因为在您尝试启动新 Activity 并将 List 对象传递给它时，AsyncTask 可能尚未完成执行。**

# rabbitmq - 在这个用例中我需要 Celery（分布式任务队列）吗？

> ID：10609357
> 
> 赞同：0
> 
> 时间：2012-05-15T21:53:36.307
> 
> 标签：rabbitmq, celery

我有两台网络服务器，一台是异步的，另一台是同步的。异步服务器处理页面上与客户端的实时交互，而同步服务器提供页面的静态内容，以及同步 Web 服务器的其他常见任务（例如身份验证、静态页面等）。

我想连接两台服务器，以便将异步服务器上收集的交互数据发送到同步服务器，然后同步服务器将数据保存到数据库中。为了实现这一点，我将使用 RabbitMQ，以便将包含数据的每条消息从异步服务器发送到同步服务器。同步服务器收到这些消息后，会一一处理。

我想知道我是否还需要使用 Celery 来提高这种两台服务器情况下的性能？如果我需要将此设置扩展到多个异步服务器和多个同步服务器，该怎么办？那我应该如何使用 Celery 呢？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-05-16T11:34:11.113

你理解一切正确，但你能不能在 celery Daemon 上实现保存东西。您还可以看到其他更简单的解决方案。您可以使用[http://docs.python-requests.org/en/latest/](http://docs.python-requests.org/en/latest/)从异步服务器调用 GET-POST 请求到同步服务器。所以。它很容易从异步转换为同步。我认为现在对你更好。

# python - python 等到连接激活

> ID：10609358
> 
> 赞同：4
> 
> 时间：2012-05-15T21:53:36.260
> 
> 标签：python, urllib

我希望我的 python 脚本检查活动的互联网连接，如果有，则继续执行。如果没有连接，则继续检查。基本上阻止“main()”中的执行，直到脚本可以重新连接。

Python

```
import urllib2

def main():
    #the script stuff

def internet_on():
    try:
        response=urllib2.urlopen('http://74.125.113.99',timeout=1)
        main()
    except urllib2.URLError:
    internet_on() 
```

* * *

## 回答 #1

> 赞同：8
> 
> 时间：2012-05-15T21:55:32.640

绝对不要递归地这样做。改用循环：

```
def wait_for_internet_connection():
    while True:
        try:
            response = urllib2.urlopen('http://74.125.113.99',timeout=1)
            return
        except urllib2.URLError:
            pass

def main():
    ...

wait_for_internet_connection()
main() 
```

# ios - 如何自定义 UIPrintInteractionController 的外观

> ID：10609362
> 
> 赞同：13
> 
> 时间：2012-05-15T21:54:18.117
> 
> 标签：ios

苹果蓝与我的应用颜色不匹配，因此打印对话框非常刺眼。

在我的 iPhone 应用程序中，我可以使用以下 UIPrintInteractionControllerDelegate 代码获得正确的导航栏和背景颜色。

```
- (UIViewController *)printInteractionControllerParentViewController:   (UIPrintInteractionController *)printInteractionController
{
   return self.navigationController;
}
- (void)printInteractionControllerDidPresentPrinterOptions:(UIPrintInteractionController *)printInteractionController
{
   self.navigationController.topViewController.view.backgroundColor = [UIColor whiteColor];   
} 
```

问题是我使用自定义 UIPrintPageRenderer 类来呈现我的页面。这似乎触发了在发送打印作业后弹出的屏幕。它有一个带有完成按钮的导航栏和下面的消息，上面写着“发送到打印机”。我认为这是为了让您可以看到正在发送的多个页面（我只有一个）。在选项对话框消失并且您已返回到您启动所有操作的原始屏幕后，这会弹出。

“发送到打印机”屏幕是蓝色和丑陋到最大。有没有办法消除它或定制它的外观？”

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2014-12-23T03:45:37.530

我不知道你的完整代码，但你可以试试外观协议。这实质上允许您设置特定 UI 元素（如按钮和栏）的通用颜色（或其他属性）。因此，您可以使用以下代码设置打印控制器导航栏的背景颜色：

```
[[UINavigationBar appearance] setTintColor:[UIColor redColor]]; 
```

这将使您的应用程序中的所有导航栏，包括打印导航控制器的，都是红色的。然后，您可以稍后通过设置栏的外观（即 self.navigationController.navigationBar.tintColor）来更改您不想变成红色的那些。

顺便说一句，这适用于**iOS 7**，iOS 6 没有 tint color 属性，我认为它只是使用背景颜色。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2021-04-06T05:23:47.720

对于 iOS 13.0 + 你可以使用对我有用的这个

```
if #available(iOS 13.0, *) {
        let appearance = UINavigationBarAppearance()
        appearance.configureWithOpaqueBackground()
        appearance.backgroundColor = UIColor.orange
        appearance.titleTextAttributes = [.foregroundColor: UIColor.white] // With a red background, make the title more readable.
        UINavigationBar.appearance().standardAppearance = appearance
        UINavigationBar.appearance().scrollEdgeAppearance = appearance
        UINavigationBar.appearance().compactAppearance = appearance // For iPhone small navigation bar in landscape.
} else {
        UINavigationBar.appearance().tintColor = UIColor.white
        UINavigationBar.appearance().titleTextAttributes = [.foregroundColor: UIColor.white]
        UINavigationBar.appearance().barTintColor = UIColor.orange
}
    UIBarButtonItem.appearance().tintColor = UIColor.white
    UISegmentedControl.appearance().tintColor = UIColor.orange 
```

# c# - C# Domino LDAP 查询

> ID：10609363
> 
> 赞同：0
> 
> 时间：2012-05-15T21:54:21.403
> 
> 标签：c#, ldap, lotus-domino

我正在尝试连接到 Domino 服务器以获取所有用户信息（姓名、电子邮件等）。当我尝试运行以下代码时，出现以下错误：{“发生协议错误。\r\n”}

我环顾四周并在 ldap 浏览器中尝试了相同的查询，一切正常。任何建议表示赞赏。

```
DirectorySearcher search = new DirectorySearcher(new DirectoryEntry("LDAP://server:port"));

        try
        {

            search.Filter = "(objectClass=dominoPerson)";
            search.PropertiesToLoad.Add("cn");
            SearchResultCollection results = search.FindAll();

            foreach (SearchResult r in results)
            {
                DirectoryEntry de = r.GetDirectoryEntry();

                foreach (DirectoryEntry child in de.Children)
                {
                    Console.WriteLine(child.Name);
                }
            }

            search.Dispose();

        }
        catch (Exception msg)
        {
            Console.WriteLine(msg.ToString());
        }v 
```

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-05-16T01:09:34.963

您是否使用 ldap 浏览器进行身份验证，但从您的代码中执行未经身份验证的查询？根据配置设置，Domino 可能会完全拒绝未经身份验证的查询，或者限制它将返回的属性。另外，您是否在 ldap 浏览器连接中指定了 BaseDN 而不是在代码中？

不过，我建议不要只是猜测，而是在服务器端收集尽可能多的信息。即，在 Domino 服务器上设置调试日志记录以捕获有关 LDAP 连接和请求的信息。使用服务器命令**set config LDAPDEBUG=7**，然后重新启动 ldap 任务。（您可以将其设置为 3 开始，以减少冗长的输出，但恕我直言，您可能还不如直接进入最高级别的信息。）

设置好之后，使用 ldap 浏览器进行查询并观察 Domino 服务器的控制台。（如果它滚动到可见窗口之外，您应该能够在服务器上的 IBM 技术支持文件夹中找到日志信息。）接下来，输入一个服务器命令（例如“show server”），作为一个容易看到的分隔符，然后运行您的代码并查看控制台日志。

此时，您应该能够将来自 ldap 浏览器连接和查询的控制台日志条目与来自代码连接和查询的条目进行比较。这些差异应该会引导您找到解决方案。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2017-08-18T06:07:19.003

在目录搜索中使用`Autheticationtype.None`它会起作用。

```
DirectorySearcher search = new DirectorySearcher(
new DirectoryEntry("LDAP://XXX.XX.XX.XX:","","",AuthenticationTypes.None)); 
```

# tsql - 两端行的 case 语句错误

> ID：10609364
> 
> 赞同：0
> 
> 时间：2012-05-15T21:54:22.470
> 
> 标签：tsql

我试图弄清楚为什么第 22 行和第 25 行的第二个 BEGIN/END 块错误。两种情况的 END。我错过了什么？另外我怎么能做一个查询而不是两个块？

```
 BEGIN

     SELECT

     l.partNum AS [Part Number]
    ,l.pricePerUOM AS [Price Per UOM]
    ,l.uom AS [UOM]
    ,SUM(CONVERT(DECIMAL(18,12), l.totalCostPerWS/l.pricePerUOM)) AS [Quantity/WS] INTO #temp
   FROM tbl_step s
    JOIN tbl_line l ON s.stepId = l.stepId
    WHERE s.revisionId = @revisionId
            AND ISNUMERIC(l.totalCostPerWS) > 0
            AND ISNUMERIC(l.pricePerUOM) > 0
        GROUP BY l.partNum, l.pricePerUOM, l.uom
    END

    BEGIN
        SELECT
             l.partNum AS [Part Number]
            ,l.pricePerUOM AS [Price Per UOM]
            ,l.uom AS [UOM]
        ,CASE
            WHEN l.partNum >=2 AND l.uom = 'liter' THEN (SELECT CONVERT(DECIMAL(18,12),[Quantity/WS] * 1000)
        END AS [Converted]
        ,CASE
            WHEN l.uom = 'milliliter' THEN (SELECT CONVERT(DECIMAL(18,12),[Quantity/WS] + l.pricePerUOM)
        END AS [Qnty/WS + Price per UOM]
        FROM #temp
            JOIN tbl_line l ON s.stepId = l.stepId
            JOIN tbl_step s ON l.stepId = s.stepId
            WHERE
                ISNUMERIC(l.totalCostPerWS) > 0
            AND ISNUMERIC(l.pricePerUOM) > 0
        GROUP BY l.partNum, l.pricePerUOM, l.uom
    END 
```

谢谢你的帮助。F

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-05-15T22:12:22.627

你也有这个：

```
FROM #temp
JOIN tbl_line l ON s.stepId = l.stepId
JOIN tbl_step s ON l.stepId = s.stepId 
```

我想也许你的意思是：

```
FROM #temp AS t
JOIN tbl_line l ON t.stepId = l.stepId
JOIN tbl_step s ON l.stepId = s.stepId 
```

但是，这将要求 #temp 有一个 stepId 列。我认为您需要退后一步，从更简化的查询开始，因为您现在所做的一大堆事情没有意义。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-05-15T21:58:37.150

失去嵌入`SELECT`的：

```
,CASE
WHEN l.partNum >=2 AND l.uom = 'liter' THEN CONVERT(DECIMAL(18,12),[Quantity/WS] * 1000)
END AS [Converted]
,CASE
WHEN l.uom = 'milliliter' THEN CONVERT(DECIMAL(18,12),[Quantity/WS] + l.pricePerUOM)
END AS [Qnty/WS + Price per UOM] 
```

# mysql - sql查找缺失的关联

> ID：10609367
> 
> 赞同：1
> 
> 时间：2012-05-15T21:54:30.113
> 
> 标签：mysql

我有一个表，该表`items`与一个表的 belongsTo 关联，该`books`表与一个表 foreignKey `book_id`。我怎样才能找到该ID`items`有`book_id`但没有记录`books`？原因是不知何故该`books`记录已被删除，但关联的`items`记录却没有。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-05-15T21:57:36.417

如果每本书都有一个 ID，那么试试这个

```
select * from items where book_id not in (select ID from books) 
```

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-05-15T21:59:33.823

```
select i.* 
from items as i
left join books as b
on i.book_id = b.id 
where b.id is null 
```

# php - 在 PHP 中创建一个 json 对象

> ID：10609369
> 
> 赞同：8
> 
> 时间：2012-05-15T21:54:42.250
> 
> 标签：php, json

如何在 PHP 中创建与此类似的 json 对象？

```
{
    "employees": [
        { "firstName":"John" , "lastName":"Doe" }, 
        { "firstName":"Anna" , "lastName":"Smith" }, 
        { "firstName":"Peter" , "lastName":"Jones" }
    ]
} 
```

* * *

## 回答 #1

> 赞同：23
> 
> 时间：2012-05-15T21:56:10.020

您创建一个数组，并将其传递给[json_encode](http://php.net/manual/en/function.json-encode.php)

```
$stuff = array(
    'employees' => array(
        array('firstName' => 'John', 'lastName' => 'Doe'),
        ....
    )
);

echo json_encode($stuff); 
```

# html - 如何在 php 中使用 css 删除 Html 中的项目符号

> ID：10609370
> 
> 赞同：1
> 
> 时间：2012-05-15T21:54:47.720
> 
> 标签：html, css

我正在尝试使用 ul，li 在 html 中在画廊中显示图像

列表项通过while循环迭代

```
<ul style="list-style-type: none;">
while($data=mysql_fetch_row($result))
{
$path=$data[1];
<li style="list-style:none; float: left; margin-left:4px; margin-top:5px; margin-bottom:5px;">
<div><img src=<?=$path?> width=300 height=240></img></div>
</li>
}
</ul> 
```

但是 ul 标记在开始时显示一个项目符号

请帮我

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-05-15T21:58:18.130

```
ul, ul li {
   list-style:none;
 } 
```

用 CSS 设置样式

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-05-15T22:05:48.770

我看不出它为什么会在您的页面中添加错误的项目符号的任何明显原因，但是您可能需要先整理几件事以排除它们。

首先，没有结束标签。图像元素用尾部斜杠关闭自己。

其次，为什么你用引号括起一些属性而不是其他属性？开始习惯良好的做法并将所有属性括在引号中。

此外，您应该使用样式表将样式与标记分开：

```
ul, ul li {
    list-style:none;
}

li {
    float: left;
    margin-left:4px;
    margin-top:5px;
    margin-bottom:5px;
} 
```

此外，PHP 的一个技巧是使用`while: ... endwhile;`它，因为它更具可读性：

```
<ul>
    <?php
    while($data=mysql_fetch_row($result)) :
    {
        $path=$data[1];
    ?>
        <li>
             <div><img src="<?=$path?>" width="300" height="240" /></div>
        </li>
    <?php endwhile; ?>
</ul> 
```

在编辑您的代码时，我还注意到您没有在 php 标记中包含 while 循环。我假设您在实际应用程序的 php 标记中正确地包含了它？

尼尔

# ruby - 更聪明的选择是什么：Ruby 逻辑还是 SQL 函数？

> ID：10609372
> 
> 赞同：0
> 
> 时间：2012-05-15T21:54:52.080
> 
> 标签：ruby, postgresql, optimization, ruby-on-rails-3.1, rails-postgresql

我需要编写一个始终返回整数值的方法。如果记录不存在，则该方法返回 0

我在被查询的列上有一个唯一索引，并提出了两种解决方案：

```
# Option a) Ruby logic
def some_method id
  result = Model.some_scope.find(:first,
                                  conditions: { foo_id: id },
                                  select: :int_value)

  # Return 0 if record does not exist:
  ( result.nil? ? 0 : result.int_value )
end

# Option b) Allow Postgres to do the work
def some_method id
  # sum() returns 0 if the record wasn't found
  Model.some_scope.where(foo_id: id).sum(:int_value)
end 
```

由于唯一索引，两种方法都返回相同的值。

除了简洁之外，还有什么理由比另一种解决方案更好吗？

我倾向于选择基于服务器资源的解决方案，即通过将工作交给 Ruby 来最小化数据库服务器负载。

* * *

运行 Ruby 1.9.3 和 Postgres 9.1

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-05-15T22:38:14.447

您不需要（可能更昂贵的）聚合函数`sum()`。
为此使用 SQL- [`COALESCE()`](http://www.postgresql.org/docs/current/interactive/functions-conditional.html#FUNCTIONS-COALESCE-NVL-IFNULL)。

`COALESCE`可能是最便宜的方式。但成本如此之小，无论哪种方式都无所谓。

# c# - 带有隔离存储的 Linq To XML - 缺少根元素

> ID：10609381
> 
> 赞同：0
> 
> 时间：2012-05-15T21:56:02.453
> 
> 标签：c#, .net, windows-phone-7, linq-to-xml, isolatedstorage

我尝试使用 Linq 到 XML 从隔离存储中读取 Xml 文件。

我的文件包含上面的代码：

```
<?xml version="1.0" encoding="utf-8"?>
<lense>
   <days>14</days>
   <date>5/29/2012</date>
   <useToday>True</useToday>
   <dateUseToday />
</lense> 
```

我写了一个这样的查询：

```
using (var store = IsolatedStorageFile.GetUserStoreForApplication())
{
   using (IsolatedStorageFileStream isoStream = new  IsolatedStorageFileStream("Lenses.xml", FileMode.Open, store))
   {
      var custs = from c in XElement.Load(isoStream).Elements("Lense")c;
   }
} 
```

但我有以下错误：

> 缺少根元素

我不知道为什么？你能给我解释一下并帮助我吗？

* * *

谢谢你的帮助！

但是当我尝试以下代码时，我遇到了相同的根元素错误。

```
var custs = from c in XDocument.Load(isoStream).Elements("Lense")
            select c; 
```

* * *

我使用此代码在隔离存储中查看我的 xml 文件存储：

```
using (StreamReader reader = new StreamReader(store.OpenFile("Lenses.xml", FileMode.Open)))
{
    MessageBox.Show(reader.ReadToEnd());
} 
```

并且 xml 文件只包含一个元素：

```
<?xml version="1.0" encoding="utf-8"?>
<lense>
   <days>14</days>
   <date>5/29/2012</date>
   <useToday>True</useToday>
   <dateUseToday />
</lense> 
```

感谢帮助 ！

* * *

我知道我可以使用 XmlReader 操作我的 xml 文档：

```
using (IsolatedStorageFileStream isoStream = new IsolatedStorageFileStream("Lenses.xml", FileMode.Open, store))
{
   isoStream.Position = 0;
   XmlReader xmlReader;
   xmlReader = XmlReader.Create(isoStream);
   xmlReader.MoveToContent();
   while (xmlReader.Read())
   {
      switch (xmlReader.NodeType)
      {
         case XmlNodeType.Element:
         {
            if (xmlReader.Name == "date")
            {
               // Code here
            }
         }
      }
   }
} 
```

它可以工作，但如果可能的话，我更喜欢 linq to xml 解决方案。

谢谢你的帮助 ！

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-05-15T23:42:31.260

由于您要加载完整的 XML 文档，请尝试：

```
XDocument.Load(isoStream) 
```

代替：

```
XElement.Load(isoStream) 
```

如建议的那样，您还需要`Elements("lense")`使用`lense`小写字母。

请注意，如果您的文件实际上包含以下内容：

```
<?xml version="1.0" encoding="utf-8"?>
<lense>
   <days>14</days>
   <date>5/29/2012</date>
   <useToday>True</useToday>
   <dateUseToday />
</lense>
<lense>
   <days>14</days>
   <date>5/29/2012</date>
   <useToday>True</useToday>
   <dateUseToday />
</lense> 
```

它将因多个根元素错误而失败。不同的错误，类似的问题。

# java - KeyBindings 和 KeyListeners 之间的区别

> ID：10609388
> 
> 赞同：3
> 
> 时间：2012-05-15T21:56:14.700
> 
> 标签：java, swing, awt, key-bindings, keylistener

如果您可以这样做，那么 KeyBindings 的意义何在：

```
// Imports

public void Test {
    JButton button1;
    JButton button2;
    JButton button3;
    ...

    Test() {
        button1 = new JButton();
        button1.addKeyListener(this);

        button2 = new JButton();
        button2.addKeyListener(this);

        button3 = new JButton();
        button3.addKeyListener(this);

        ...
    }

    public void keyPressed(KeyEvent e) {
    }

    public void keyReleased(KeyEvent e) {
    }

    public void keyTyped(KeyEvent e) {

        Object src = e.getSource();

        if (src == button1) {
            ...
        }

        else if (src == button2) {
            ...
        }

        else if (src == button3) {
            ...
        }
        ...
    }
} 
```

假设我有**十个**按钮。然后，如果您使用 KeyBindings，则必须为每个按钮创建单独的键绑定。我展示的例子不是更有效率吗？为什么不？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-05-15T22:26:43.200

如果您纯粹计算 CPU 周期，是的，它（可以说）效率更高（经过仔细考虑，我什至不确定）。但也有一些反对它的强项：

1.  它使您的代码非常难看（想象一下您有数千个测试）
2.  它的可重用性较低
3.  更少面向对象：将对象 KeyStroke 绑定到对象 Action 更加 OO（请参阅[此处](http://docs.oracle.com/javase/tutorial/uiswing/misc/action.html)的 Actions 更多信息）
4.  它更容易出错，因为您的代码可读性较差并且可能变得巨大
5.  您的代码是紧密耦合的（您几乎无法将 KeyListener 移动到单独的类中）
6.  在您的测试中，您检查了哪个按钮触发了该事件，但您还不知道输入了哪个键。您将不得不添加更多测试来找出答案。

因此，对于非常局部化的问题，您的方法可能就足够了，而对于更大的视图，它就不能成立。

[您可以在此处](http://docs.oracle.com/javase/tutorial/uiswing/misc/keybinding.html)的第三段中找到有关此问题的一些类似和附加评论。

最后，将 KeyListener 放在 JButton 上有点奇怪。通常，我们注册一个 ActionListener。

# asp.net - 删除页面上的参数，gridview 连接到下拉选择

> ID：10609394
> 
> 赞同：0
> 
> 时间：2012-05-15T21:56:52.747
> 
> 标签：asp.net, gridview, .net-4.0, drop-down-menu

我有一个简单的 ASP.NET/C# 页面，其中包含一个 DropDownList（“Category”）和一个 GridView（“Items”）。每个都通过 SqlDataSource 从各自的表中提取数据。“Items”数据源有一个用于 Select 语句的 ControlParameter，并且下拉列表会自动回发。一切正常——我可以在下拉列表中选择一个项目，gridview 会像我预期的那样自动更改。

有没有办法（在 ASP.NET 中）我可以在下拉列表中有一个“显示全部”项目，该项目将从数据源中删除参数，以便无论类别如何，它都会拉入所有项目？或者这是不可能的，我需要将其中的一些切换到代码隐藏。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-08-02T20:22:25.533

取决于`Category`：

A）如果`Category`是 varchar 类型，那么您应该能够将您`Select`的修改`SqlDataSource`为：

```
... WHERE Category LIKE @Category 
```

并在您`DropDownList`的项目中包含：

```
<asp:ListItem Text="(Any)" Value="%"></asp:ListItem> 
```

B）如果 `Category`是数字类型，那么您应该能够修改您的`Select`以检查“幻数”（您通过业务规则保留的表示通配符的数字 - 并确保在某处记录）：

```
... WHERE Category = @Category OR @Category = -99 
```

并在您`DropDownList`的项目中包含：

```
<asp:ListItem Text="(Any)" Value="-99"></asp:ListItem> 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-08-03T09:49:01.090

你可以做这样的事情

如果类别是数字（数据值字段），那么您可以按照以下方式进行操作..添加一个新项目

```
<asp:ListItem Text="(Any)" Value="%"></asp:ListItem> 
```

在您的选择语句的过滤器表达式中，您需要编写类似

```
Convert(Category,System.String) like '{0}%' 
```

这会将您的数字列更改为字符串类型，并且您的过滤器表达式将传递正确的参数

如果它是 String 类型，则无需使用 Convert 函数。

```
<asp:ListItem Text="(Any)" Value="%"></asp:ListItem>

Category like '{0}%' 
```

让我知道这是否对您有帮助。

# java - 如何从Java中的重复中取出变量？

> ID：10609396
> 
> 赞同：0
> 
> 时间：2012-05-15T21:57:01.593
> 
> 标签：java, recurrence

这是 Java 中的一种方法，int[] arr 中的（当 k == 0 时）具有 k 组合 int[] intems 之一。在变量 iloczyn 中计算了该组合中元素的乘积。在 tmp 中计算所有此类产品的总和。不幸的是，System.out.println(tmp) 显示，当函数结束时，tmp 等于 0。这很可悲，因为我需要这个变量来进行下一次计算。我该怎么办？

```
int tmp = 0;
public void kcomb(int[] items, int n, int k, int[] arr) 
{
    int iloczyn = 1;

    if (k == 0) {
        for(int i = 0; i< arr.length; i++){
            iloczyn*=arr[i];
        }
        tmp +=iloczyn;

    } else {
        for (int i = n; i <= items.length - k; i++) {
            arr[arr.length - k] = items[i];
            kcomb(items, i + 1, k - 1, arr);
        }
    }
    System.out.println(tmp);
} 
```

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-05-15T22:09:52.537

递归方法可能很棘手。你被烧毁了，因为你没有很好地处理方法的返回值。事实上，根本没有。

首先，按照@olicharlesworth 的建议进行操作并通过您的代码进行调试。这会很有启发性。

然后，要解决此问题，请考虑您的例程基本上有 2 个永远不会相遇的部分 - k==0 部分和另一个。这些部分中的每一个都应初始化 tmp 值，计算适合该部分的 tmp 值*并将其返回给调用者*。

那么有问题的实例*tmp*变量将不是问题。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-05-15T22:18:39.310

好吧，该方法并不总是打印 0 —— 我[对其进行了测试](http://ideone.com/wFOkl)，对于输入`{1, 3, 5, 7}, 3, 1, {4, 3, 2, 1}`它打印 168（两次）。当然，我不知道这些输入是否有意义。

您应该仔细考虑逻辑，看看代码是否真的在做您认为应该做的事情。@TonyEnnis 是正确的，使用返回值而不是副作用会使这变得更好（无论是在理解方面还是在编码实践方面）。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-05-15T22:16:29.987

arr[] 中的任何值是否等于 0？如果这是真的，那么这个块：

```
for(int i = 0; i< arr.length; i++){
        iloczyn*=arr[i];
} 
```

...总是会产生一个零。如果第一个值为零，则 iloczyn * 0 = 0，并且所有后续迭代也将为零。如果数组中的任何值为零，也会发生同样的事情......它们每次都会强制 iloczyn 设置为零。

单步执行代码并仔细检查 arr[] 的值，以确保确定。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2012-05-15T22:06:19.420

除非我遗漏了什么，否则您只在 k==0 时设置 tmp。k 不会改变，因此在调用方法时它必须为非零。

# python - 如何从我的 Python 主函数返回多个字典

> ID：10609399
> 
> 赞同：1
> 
> 时间：2012-05-15T21:57:18.373
> 
> 标签：python, function, methods, dictionary

我有一个包含两个要输出的字典的主函数。我省略了字典是如何创建的。

这是我的功能：

```
def main()
    dict1 = {'a1':{'b1':1,'c1':2},'a2':{'b2':1,'c2':2}}
    dict2 = {'cat':0,'dog':2}
    return dict1, dict2
if __main__ == '__main__':
>...main() 
```

这是我在 python 提示符中调用它的方式：

```
>>from filename import *
>>x,y=main() 
```

或多或少这就是我得到的

```
>>print x
'a1'
>>print y
'a2' 
```

但这就是我想要的：

```
>>print x
{'a1':{'b1':1,'c1':2},'a2':{'b2':1,'c2':2}}
>>print y
{'cat':0,'dog':2} 
```

我做错了什么？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-05-15T22:02:16.723

你不是在`return`做`dict1, dict2`，只是`dict1`。您可以轻松地重现此行为：

```
>>> dict1 = {'a1': 'some_stuff', 'a2': 'some_other_stuff'}
>>> dict2 = {'cat': 0, 'dog': 0}
>>> return_val = dict1
>>> x, y = return_val
>>> x
'a1'
>>> y
'a2'
>>> return_val = dict1, dict2
>>> x, y = return_val
>>> x
{'a1': 'some_stuff', 'a2': 'some_other_stuff'}
>>> y
{'cat': 0, 'dog': 0} 
```

发生这种情况是因为当您遍历字典时，您会得到它的键，所以当您执行`x, y = main()`并`main`返回时`dict1`，您会遍历 的键`dict1`。由于恰好有两个，因此您不会收到错误并`x`获取`y`这些键的值。

如果您更改`main`为返回两个字典，则应该没问题。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-05-15T22:00:49.843

该代码已经完全按照您的期望进行：

```
In [4]: def main():
   ...:     dict1 = {'a1':{'b1':1,'c1':2},'a2':{'b2':1,'c2':2}}
   ...:     dict2 = {'cat':0,'dog':2}
   ...:     return dict1, dict2
   ...: 

In [5]: x, y = main()

In [6]: x
Out[6]: {'a1': {'b1': 1, 'c1': 2}, 'a2': {'b2': 1, 'c2': 2}}

In [7]: y
Out[7]: {'cat': 0, 'dog': 2} 
```

也许您不小心调用了不同的`main()`函数（例如，具有不同`return`语句的函数）？

# android - Android：创建具有多个可排序列的选中列表

> ID：10609400
> 
> 赞同：1
> 
> 时间：2012-05-15T21:57:25.537
> 
> 标签：android, user-interface

**编辑：**
这个问题现在已经解决了。我设法创建了我需要的东西，您可以在我的网站上找到可下载的 Eclipse 项目的结果：http: [//jordanmoore.co.uk/examples/Android/CheckableSortableMulticolumnListView.html](http://jordanmoore.co.uk/examples/Android/CheckableSortableMulticolumnListView.html)

* * *

**原始问题：**
对于我的 android 应用程序，我有一组数据，当前存储在 a 中`ArrayList<Song>`，其中`Song`是我创建的用于保存单首歌曲详细信息的对象。这个 ArrayList 通常有 200 项左右。

我想以这样一种方式显示它，以便用户可以根据他们的需要对数据进行排序。我想以您可以在 Windows 资源管理器中列出的属性（例如名称和日期）并让您对其进行排序的方式来执行此操作。

我要显示和可排序的字段是：`songName`, `albumName`, `artistName`, `year`, `trackNum`, `duration`. 不过，我仍然需要对 Song 对象的引用，以便在用户选择操作时可以访问所选歌曲的更多属性。

在我的 Android 平板电脑上，我有一个文件管理器应用程序，几乎可以满足我的需求： ![在此处输入图像描述](../Images/5cdce50b12d5bab86defd93a57cef8f8.png)

我希望重新创建显示我的图像的实际部分，包括带有列标签的灰色标题。

我一直在搜索和搜索，似乎无法弄清楚从哪里开始这项任务，因此我问是否有人能指出我正确的方向，或者甚至给我一个简单的例子。

谢谢，乔丹。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-05-16T00:46:58.823

没有特别的顺序，这是我的想法

创建一个排序函数，允许您按任何标准进行排序

带有标题的线性布局，然后是包含带有实际数据的线性布局的列表视图

标题将是具有适当权重值的水平分区线性布局

为行创建一个单独的布局文件，使其具有与上面相同的权重值

在每个标题的 onclicklistener 中，让它调用排序函数，然后重新制作列表。

当然，这是基于我所做的一些不太相似的东西，所以我真的没有任何代码来帮助它。

# http - 使用参数发出简单的 post 请求并接收响应

> ID：10609405
> 
> 赞同：2
> 
> 时间：2012-05-15T21:57:52.453
> 
> 标签：http, networking, haskell

我想复制这个功能：

```
curl -d "user=username&passwd=passwd&api_type=json" http://www.reddit.com/api/login/username 
```

我遇到了至少 3 个以迂回方式提供此功能的库`http-conduit`：`network-http`和`curl`. 什么库是发出 http 请求的标准，我将如何使用它来发出这个 post 请求？

我应该指定我也想阅读回复。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-05-16T01:39:23.610

标准库是[HTTP](http://hackage.haskell.org/package/HTTP)。它与 Haskell 平台一起提供。

> HTTP 包支持 Haskell 中的客户端 Web 编程。它允许您设置 HTTP 连接、传输请求和处理返回的响应，所有这些都在 Haskell 的舒适范围内。它依赖于网络包来运行，但除此之外，实现都是用Haskell编写的。
> 
> 提供了用于发出单个 HTTP 请求 + 接收响应的基本 API。最重要的是，还提供了会话级抽象（BrowserAction monad）；它负责处理持久连接、代理、状态（cookies）和身份验证凭据的管理，以处理与 Web 服务器的多步交互。
> 
> 流经的字节表示可以通过使用类型类进行扩展，让您选择最适合您使用的请求和响应的表示。为您提供了一些预打包的常用实例（ByteString、String。）

如果 HTTP 包由于某种原因不适合，Hackage 上有很多包，正如您所指出的，包括直接 curl 绑定、各种高级绑定以及专注于性能的绑定。

# c++ - Visual c++ 和 SAX

> ID：10609412
> 
> 赞同：0
> 
> 时间：2012-05-15T21:58:34.777
> 
> 标签：c++, xml, sax

[http://support.microsoft.com/kb/276505](http://support.microsoft.com/kb/276505) 该站点有一个 Win32 应用程序向导的下载。我目前正在开发一个 win32 应用程序，这个 XML 解析器会派上用场。我在 Internet 上搜索了有关将 SAX 与 MS Visual Studio 结合使用的文档。有没有人有这方面的经验？我只是在寻找一些有关将 SAX 与 VS c++ 结合使用的文档或任何信息。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-05-16T22:23:29.920

我能够得出一个决议。我使用了 xerces，它内置了 SAX 和 SAX2。链接库并引用 *.dll 是必要的：

[http://xerces.apache.org/](http://xerces.apache.org/)

# ios - UITableView 不滚动（iOS）

> ID：10609416
> 
> 赞同：2
> 
> 时间：2012-05-15T21:58:44.447
> 
> 标签：ios, uitableview, scroll

我以编程方式创建了一个 UITableView 并且发现它不会滚动。这是我第一次以编程方式而不是通过 Interface Builder 创建 UITableView。我需要以编程方式设置一些属性以使我的视图滚动吗？我尝试过 setBounces、setScrollEnabled、setAlwaysBounceVertical，但似乎没有任何效果。任何想法将不胜感激！谢谢！

示例代码：

```
UIInterfaceOrientation interfaceOrientation = [[UIApplication sharedApplication] statusBarOrientation];
CGFloat height = (interfaceOrientation == UIInterfaceOrientationPortrait || interfaceOrientation == UIInterfaceOrientationPortraitUpsideDown) ? 460 : 300;
feed = [[UITableView alloc] initWithFrame:CGRectMake(0.0f, 44.0f, self.bounds.size.width, height - 44.0f)];
[feed setSeparatorColor:[UIColor colorWithRed:38.0f/255.0f green:43.0f/255.0f blue:63.0f/255.0f alpha:1.0f]];
[feed setBackgroundColor:[UIColor colorWithRed:48.0f/255.0f green:53.0f/255.0f blue:73.0f/255.0f alpha:1.0f]];
[feed setDataSource:self];
[feed setDelegate:self];
[feed setHidden:YES];
[feed setBounces:YES];
[feed setScrollEnabled:YES];
[feed setAlwaysBounceVertical:YES];
[feed setDelaysContentTouches:YES];
[self addSubview:feed]; 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-05-15T22:04:16.130

尝试在 TableView 上设置 delaysContentTouches。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-05-30T00:16:37.063

我知道这是一个旧线程，但是您是否偶然在 iOS 模拟器中看到了这个问题？我的表格视图遇到了同样的问题，但事实证明我只是在模拟器中没有使用正确的手势。请参阅[Can't get UITableView list to scroll in iPhone simulator](https://stackoverflow.com/questions/7721042/cant-get-uitableview-list-to-scroll-in-iphone-simulator)。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2014-09-17T09:30:50.810

我正在使用启动 iOS 模拟器的 Xamarin Studio。我不得不重新启动我的 Mac。现在表格视图再次滚动。仅重新启动 Xamarin 或 iOS 模拟器不起作用。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2012-05-16T17:05:06.323

我试图把它放在评论中，但它太长了......

您的大多数 set 方法只是设置默认值，因此它们在您的代码的最终版本中不是必需的。此外，您创建 tableview 并将其添加为子视图的方式没有任何问题。这让我相信这个错误存在于周围的代码中，可能与超级视图上的属性有关。当您说“工作完美”时，您的意思是您可以选择单元格并调用您的 didSelectRow... 方法吗？您可以尝试将内容注释掉，将 tableview 剥离为所需的基本内容（init、addSubview、numberOfRows 返回 0、cellForRow 返回 nil，不要设置委托和数据源以外的任何内容）。这应该会给你一个空的 tableview，即使里面什么都没有，它也会滚动和反弹。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2012-05-15T22:56:36.997

ScrollView 必须设置 contentSize 才能滚动。尝试设置您的 contentSize：

```
[feed setContentSize:[feed frame].size]; 
```

# regex - 在 Linux 中根据其内容输出文本块

> ID：10609421
> 
> 赞同：0
> 
> 时间：2012-05-15T21:59:00.557
> 
> 标签：regex, linux, shell, grep, vi

我有很多大型文本文件，它们按已知的分隔符 {} 进行分组。如果一个块包含某个序列，比如 xyq，那么我想输出整个块。

我知道我可以编写一个 grep 来获取搜索标签，但是如何将我的选择扩展到最近的括号？请注意，{ 和 } 可以位于任何位置，即不是行首或行尾、空格、...

寻找这样的东西：

```
Input:
 {i am a turtle}
 {i am a horse}
 {i am a programmer}

grep ???programmer??? ./File

output: {i am a programmer} 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-05-15T22:05:12.403

您可以先尝试将换行符翻译成其他内容。假设输入没有 NUL，这是一个很好的候选。

```
cat input | tr '\n' '\0' | grep -aEo '\{.*?programmer.*?\}' | tr '\0' '\n' 
```

在正则表达式本身中，`?`s 使先前的匹配成为非贪婪的，这意味着它们匹配最短的可能序列而不是最长的序列。请注意，如果搜索词可能出现在大括号之外，这将无法正常工作，您需要更加明确：

```
cat input | tr '\n' '\0' | grep -aEo '\{[^{}]*programmer[^{}]*\}' | tr '\0' '\n' 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-05-16T13:02:39.743

```
>cat file
 {i am a turtle}
  jay   {i am a horse}
     {i am a programmer}

>grep horse file | awk -F"{}" '{print substr($2,0,length($2)-1)}'

 i am a horse 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-05-16T12:41:25.160

```
sed -n '/{\|}/ !{H; b}; /{/ {h; b open}; :open {/}/ b close; n; H; b open}; :close {g; /programmer/ p}' File 
```

解释：

```
$ sed -n '#suppress printing of all input
> /{\|}/ !{H; b} # if no curly brackets on the line, append it to hold space and finish
> /{/ {h; b open} # if an opening { is found, copy the line to hold space and branch to label :open
> :open
> /}/ b close # if a } is matched, branch to label close
> n; H; b open # else read a new line, append it to hold space and go back to :open
> :close
> g # put all hold space to pattern space
> /programmer/ p # if _programmer_ matches, print the pattern space' File 
```

# image - 检查动态加载的图像是否完整

> ID：10609422
> 
> 赞同：3
> 
> 时间：2012-05-15T21:59:02.923
> 
> 标签：image, jquery

我有一个发布到 php 脚本的代码，该脚本读取文件夹中的所有文件并返回它们，它们都是 img 的，jquery 解析信息，在一个数组的 var 上，每个图像都保存为带有 src 的 img 对象，宽度，高度和属性，成功后我想检查每个图像是否已加载，然后最后完全触发另一个函数并删除一个 div。但我不知道如何检查图像是否已完全加载，我一直在玩弄 .complete 但它似乎永远不会加载，该函数调用 itef 直到加载 img 然后返回 true 以便它可以保持去。这是代码，它有点乱，可能不是一个很好的编码。

```
var gAllImages = [];
function checkFed()

{
    var leni = gAllImages.length;   
    for (var i = 0; i < leni; i++) {

        if (!gAllImages[i].complete) {
            var percentage = i * 100.0 / (leni);
            percentage = percentage.toFixed(0).toString() + ' %';
            console.log(percentage);
            //  userMessagesController.setMessage("loading... " + percentage);
            checkFed();

            return;

        }

    //userMessagesController.setMessage(globals.defaultTitle);
    }
}

 if($('slideshow')){
 var topdiv = '<div id="loading"><div class="centered"><img src="/karlaacosta/templates/templatename/images/ajax-loader.gif" /></div> </div>';
    $('#overall').append(topdiv);
    //console.log('alerta');
    var jqxhr = $.post('http://localhost/karlaacosta/templates/templatename/php/newtest.php', function(data){

        var d = $.parseJSON(data);
        //console.log(d[1]);

        if(typeof(d) == 'object' && JSON.parse){
            var len = d.length;
            //console.log(len);

            for(var i = 0; i < len; i++){
                var theImage = new Image();
                var element = d[i].split('"');
                //        console.log(element);
                //      console.log(element[4]);
                theImage.src = '/karlaacosta/images/Fotografia/TODO'+element[0];
                theImage.width = element[2];
                theImage.height = element[4];                   
                theImage.atrr = element[6];
                gAllImages.push(theImage);

            }

        // console.log(html);
        }else{
            console.log('error');
        }
    }).success(function (){

    setTimeout('checkFed', 150);

    }).error(function(){
        var err = '<div id="error"><h2>Error: Lo sentimos al parecer no se pueden cargar las imagenes</h2></div>';
        $('#loading').append(err);

    }).complete(
        function(){
            var len = gAllImages.length;
            var html = '<ul class="slides">'    
            for(var i = 0; i < len; i++){
                html += '<li><img src="'+gAllImages[i].src+'" width="'+gAllImages[i].width+'" height="'+gAllImages[i].height+'" attr="'+gAllImages[i].attr+'" /></li>';

            }
            html += '</ul>';
            $('#slideshow').append(html);
        }
        );
 jqxhr.complete(function(){
    //
    imageSlide();
    $('#loading').remove();
    //
    console.log('completed');
});
} 
```

如果我取出 checkFed() 的递归性，显然脚本完成了，当图像放在 html 上时，它们加载得很好而且很快，缓存中是否永远不会被加载？也欢迎对代码的其他部分提出任何其他建议。

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2012-05-15T22:20:55.827

> 我想检查每个图像是否已加载，然后最终完全触发另一个功能并删除一个 div。但我不知道如何检查图像是否已完全加载

从根本上说，检查图像加载是否成功很简单：

```
var theImage = new Image();
var element = d[i].split('"');
$(theImage).load(function() {
    // The image has loaded (from cache, or just now)
    // ...do something with the fact the image loaded...
});
theImage.src = '/karlaacosta/images/Fotografia/TODO'+element[0]; 
```

上面的关键是在设置事件**之前**`load`挂钩事件。如果您先设置，并且图像在缓存中，则该事件可以在下一行代码钩住它之前触发，您会错过它。**`src``src``load`**

 *** * *

这是一个示例：[Live copy](http://jsbin.com/enagig) | [来源](http://jsbin.com/enagig/edit)

HTML：

```
<img src="http://www.gravatar.com/avatar/ca3e484c121268e4c8302616b2395eb9?s=32&d=identicon&r=PG">
<p>When you see the image above, 
<input type="button" id="theButton" value="Click Me"></p> 
```

JavaScript：

```
jQuery(function($) {

  $("#theButton").click(function() {
    var img = document.createElement('img');
    $(img).load(function() {
      display("Image <code>load</code> event received");
    });
    img.src = "http://www.gravatar.com/avatar/ca3e484c121268e4c8302616b2395eb9?s=32&d=identicon&r=PG";
    document.body.appendChild(img);
  });

  function display(msg) {
    $("<p>").html(msg).appendTo(document.body);
  }
}); 
```

如您所见，我`src`在每种情况下都使用相同的 img。在我尝试过的每个浏览器上，我**确实**收到了该`load`事件。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-05-15T22:01:50.670

由于浏览器缓存和事件模型的怪异，它无法在没有插件的情况下以可靠的跨浏览器方式实现。试试 imagesLoaded 或 waitForImages。

[https://github.com/desandro/imagesloaded](https://github.com/desandro/imagesloaded)

[https://github.com/alexanderdickson/waitForImages](https://github.com/alexanderdickson/waitForImages)

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2021-11-25T11:58:38.093

现在你绝对应该只检查`.complete`价值。例子：

```
var imgs = document.querySelectorAll("img");
imgs.forEach(function(e) { console.log(e.src + ":" + e.complete); }); 
```

有关详细信息，请参阅[https://developer.mozilla.org/en-US/docs/Web/API/HTMLImageElement/complete](https://developer.mozilla.org/en-US/docs/Web/API/HTMLImageElement/complete)

如果缓存标头不允许适当的缓存以允许将来自同一 URL 的*另一个*图像用作在实际内容中加载图像的代理，那么所有尝试收集 URL 并使用`new Image()`、设置`.src`和跟踪事件的 hack 都将失败。请注意，即使该代理检测在每个缓存中都会起作用，但如果浏览器实现例如异步图像渲染，它仍然可能在实践中失败。`progress`

 *如果`.complete`用户代理不支持，那么遵循代理对象的进度事件是最不坏的选择。但是，如果`.complete`支持，它是查询真实状态的唯一真实方式。***

# c# - 流异常 & System.Xml.XmlException: '--' 是一个意外的标记。预期的令牌是 ''

> ID：10609439
> 
> 赞同：0
> 
> 时间：2012-05-15T22:01:01.717
> 
> 标签：c#, xml, streamwriter

我收到 StreamWriter 抛出的错误，我收到的消息是：

```
Length = '(sw.BaseStream).Length' threw an exception of type 'System.NotSupportedException'
Position = '(sw.BaseStream).Position' threw an exception of type 'System.NotSupportedException' 
```

堆栈跟踪：

```
Message: System.Xml.XmlException: '6163592' is an unexpected token. The expected token is '\'" or "".
Stack Trace: System.Xml.XmlTextReaderImpl.Throw(Exception e)
   at System.Xml.XmlTextReaderImpl.Throw(String res, String[] args)
   at System.Xml.XmlTextReaderImpl.ThrowUnexpectedToken(String expectedToken1, String expectedToken2)
   at System.Xml.XmlTextReaderImpl.ParseAttributes()
   at System.Xml.XmlTextReaderImpl.ParseElement()
   at System.Xml.XmlTextReaderImpl.ParseElementContent()
   at System.Xml.XmlTextReaderImpl.Read()
   at System.Xml.XmlLoader.LoadNode(Boolean skipOverWhitespace)
   at System.Xml.XmlLoader.LoadDocSequence(XmlDocument parentDoc)
   at System.Xml.XmlLoader.Load(XmlDocument doc, XmlReader reader, Boolean preserveWhitespace)
   at System.Xml.XmlDocument.Load(XmlReader reader)
   at System.Xml.XmlDocument.Load(Stream inStream)
   at BasecampManager.SendRequest(String command, String request) in C:\Inetpub\wwwroot\basecamp\Basecamp_Net_20_API_src\BasecampAPI\BasecampManager.cs:line 146 
```

我的代码：

```
public XmlDocument SendRequest(string command, string request) 
{
    XmlDocument result = null;
    if (IsInitialized()) 
    {
        result = new XmlDocument();
        HttpWebRequest webRequest = null;
        HttpWebResponse webResponse = null;

        try 
        {
            string prefix = (m_SecureMode) ? "https://" : "http://";
            string url = string.Concat(prefix, m_Url, command);
            webRequest = (HttpWebRequest)WebRequest.Create(url);

            webRequest.Method = "POST";
            webRequest.ContentType = "text/xml";
            webRequest.ServicePoint.Expect100Continue = false;

            string UsernameAndPassword = string.Concat(m_Username, ":", m_Password);
            string EncryptedDetails = Convert.ToBase64String(Encoding.ASCII.GetBytes(UsernameAndPassword));
            webRequest.Headers.Add("Authorization", "Basic " + EncryptedDetails);

            //MessageBox.Show(webRequest.GetRequestStream().ToString());

            using (StreamWriter sw = new StreamWriter(webRequest.GetRequestStream()))
            {
               sw.WriteLine(request);
            }

            // Assign the response object of 'WebRequest' to a 'WebResponse' variable.

            webResponse = (HttpWebResponse)webRequest.GetResponse();

            using (StreamReader sr = new StreamReader(webResponse.GetResponseStream()))
            {
                result.Load(sr.BaseStream);
                sr.Close();
            }
        }
        catch (Exception ex) 
        {
            string ErrorXml = string.Format("<error>{0}</error>", ex.ToString());
            result.LoadXml(ErrorXml);
        }
        finally 
        {
            if (webRequest != null)
                webRequest.GetRequestStream().Close();

            if (webResponse != null)
                webResponse.GetResponseStream().Close();
        }
    }
    return result;
} 
```

我不确定是什么问题。我检查了很多帖子，但没有什么能真正帮助我。

几个月前，这段代码运行良好。现在它通过异常自动停止工作。通过认为这可能是 VS 2005 的一些问题，我尝试在 VS 2005、2008、2010 上运行此代码，但它不再起作用。

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2012-05-15T22:27:08.610

很可能服务器响应不再是有效的 XML。

使用一些 HTTP 调试工具（即[Fiddler](http://www.fiddler2.com/fiddler2/)）来查看响应的实际样子。或者将响应保存为文本，而不是尝试加载为 XML。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-05-16T19:14:04.170

对您的代码的一些建议改进：

```
public XmlDocument SendRequest(string command, string request)
{
    if (!IsInitialized())
        return null;

    var result = new XmlDocument();

    try
    {
        var prefix = (m_SecureMode) ? "https://" : "http://";
        var url = string.Concat(prefix, m_Url, command);
        var webRequest = (HttpWebRequest) WebRequest.Create(url);

        webRequest.Method = "POST";
        webRequest.ContentType = "text/xml";
        webRequest.ServicePoint.Expect100Continue = false;

        var UsernameAndPassword = string.Concat(m_Username, ":", m_Password);
        var EncryptedDetails = Convert.ToBase64String(Encoding.ASCII.GetBytes(UsernameAndPassword));
        webRequest.Headers.Add("Authorization", "Basic " + EncryptedDetails);

        using (var requestStream = webRequest.GetRequestStream())
        {
            using (var sw = new StreamWriter(requestStream))
            {
                sw.WriteLine(request);
            }
        }

        using (var webResponse = webRequest.GetResponse())
        {
            using (var responseStream = webResponse.GetResponseStream())
            {
                result.Load(responseStream);
            }
        }
    }
    catch (Exception ex)
    {
        result.LoadXml("<error></error>");
        result.DocumentElement.InnerText = ex.ToString();
    }
    return result;
} 
```

您创建的所有实现 IDisposable 的对象都应该在一个`using`块中。您省略了`WebResponse`and 结果`Stream`。

另外，`XmlDocument.Load`可以直接接受 a `Stream`，所以不需要在中间使用`StreamReader`。我会进一步建议完全删除 try/catch 块，而不是强制调用者必须读取 XML 以确定是否发生错误。但是，如果您坚持这样做，那么您至少应该使用 XML API 来构建您的 XML。您不知道 . 的内部是什么`ex.ToString()`，因此很可能将其放入其中`<error>{0}</error>`会产生无效的 XML。

# c# - Windows 服务中未处理的异常

> ID：10609443
> 
> 赞同：4
> 
> 时间：2012-05-15T22:01:39.320
> 
> 标签：c#, .net, exception-handling, windows-services

我创建了一个运行多个任务的 .net c# windows 服务。我在其中包含了异常处理，但我想设置一个全局处理程序来捕获 Windows 服务中未处理的异常，我该怎么做？

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2012-05-15T22:24:35.133

> 我在其中包含了异常处理，但我想设置一个全局处理程序来捕获 Windows 服务中未处理的异常

你**可以**使用`AppDomain.UnhandledException`. 但是，在您的情况下，您对服务的整个调用都可以包装在 try/catch 块中。由于您没有提供有关您计划如何处理此未处理异常的详细信息，因此我认为在这种情况下您的正确路径是**让服务崩溃**。

```
try
{
   MainCallToYourService();
}
catch (Exception)
{
   //it's probably too late to do anything useful here, try to log and die
} 
```

请记住，这样做的问题在于，在很多情况下，您的应用程序的状态在引发此事件时已损坏。您最好的选择是尝试记录并退出。

# ios - 是否可以在 iAd 中使用 iPhone 摄像头？

> ID：10609445
> 
> 赞同：0
> 
> 时间：2012-05-15T22:01:44.820
> 
> 标签：ios, iad

是否可以访问 iAd 中的摄像头？

我读到创建 iAds 的语言是 JS，所以我相信它不能被访问。但是关于 iAd 的文档并不多。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-05-21T14:41:02.047

是的，有办法做到这一点。我建议你下载 iAd Producer。安装后，.dmg 磁盘中有一个“额外”目录。有一些有用的例子，其中之一是相机的访问和图像处理。

[https://developer.apple.com/iad/iadproducer/](https://developer.apple.com/iad/iadproducer/)

无论如何，这是一个按钮的小片段，它将触发相机并在图像视图中显示拍摄的照片：

```
var button = this.viewController.outlets.button; 
```

var image = this.viewController.outlets.image;

this.onViewTouchUpInside = 函数（事件）{

```
// Access the camera object
var camera = window.ad.camera;

// if the API is unavailable, the object will be null
if (!camera) {
    if (iAd.Device.iOSVersionLessThan('5.0')) {
        alert('The Camera API is not available in iOS ' + iAd.Device.iOS_VERSION);
    }
    else {
        alert('The Camera API could not be accessed.');
    }

    return;
}

// Reason from the app to explain the user
var reason = 'The app would like to take a photo';
camera.present(reason); 
```

};

如果（window.ADCamera）{

```
this.viewController.addEventListener(ADCamera.ADCameraUserTookPicture, function (event) {

    // access the camera object
    var camera = window.ad.camera; 

    // access the new picture
    var newPicture = camera.currentPictureURI;

    // set the image view's image to the new picture
    image.image = new iAd.Image(newPicture);         

}, false);

this.viewController.addEventListener(ADCamera.ADCameraUserCanceledPicture, function (event) {
}, false); 
```

}

祝你好运！

# asp.net - Datagridview 信息加载速度很慢，有多个记录

> ID：10609450
> 
> 赞同：0
> 
> 时间：2012-05-15T22:01:55.863
> 
> 标签：asp.net

我有一个 DataGridView，我在其中显示 Web 上的一些信息，当我的记录很少时一切正常，但问题是当 DataGridView 尝试加载超过 300 条左右的记录时，因为页面需要很长时间加载信息。

问题是有没有办法使用 Datagridview 优化此类查询？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-05-15T22:08:01.310

首先确保您使用良好的做法：

*   如果可能，消除视图状态（这可能是很多隐藏数据）
*   使用 DataGridView 分页通过在 10、20、30、...的页面中显示数据来缩短请求时间
*   如果不需要分页，请使用 DataList 或 Repeater 来减少对象的开销
*   从发布版本部署解决方案，无需任何调试或跟踪指令

如果这样做没有帮助，请使用 ANTS 或 dotTrace 等分析器来调查 DataGridView 行为。

这些工具将准确地告诉您瓶颈在哪里。

# php - 覆盖 Symfony 2 中重复字段的表单模板

> ID：10609451
> 
> 赞同：0
> 
> 时间：2012-05-15T22:02:15.293
> 
> 标签：php, forms, symfony, twig

我有一个包含重复行的表格；我想更改此行的呈现方式，但在 Twig 中我似乎只能覆盖特定行。

```
{% block _person_contacts_row_0_forename %}
{% spaceless %}
    <h3>{{ label }}</h3>
    {{ form_errors(form) }}
    {{ form_widget(form) }}
{% endspaceless %}
{% endblock %} 
```

这适用于第一行（id 0），但显然不适用于其他任何行。

所以我的问题是如何覆盖特定字段及其任何重复项？

干杯，詹姆斯板凳

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-05-19T02:22:41.717

利用 `{{form_row(form)}}`

内`for`循环

在你的情况下

```
{% block _person_contacts_row_0_forename %}
{% spaceless %}
    <h3>{{ label }}</h3>

{% for user in users %}
    {{ form_errors(form) }}
    {{ form_row(form) }}
{%endfor%}
{% endspaceless %}
{% endblock %} 
```

for [**for 循环文档检查**](http://twig.sensiolabs.org/doc/tags/for.html)

希望这对你有帮助

# c# - 使用情节提要为属性设置动画

> ID：10609453
> 
> 赞同：0
> 
> 时间：2012-05-15T22:02:19.333
> 
> 标签：c#, wpf, xaml, storyboard

我知道有几个示例说明如何在故事板包含目标时为其设置动画。例如动画按钮的宽度或矩形的颜色。

我想用情节提要为属性设置动画，并且该属性恰好绑定到其他事物。结果我有类似的东西：

**XAML：**

```
<Window.Resources>
    <Storyboard x:Key="sbVolume">
        <DoubleAnimation Storyboard.TargetProperty="{Binding SbVolumeValue}" To="40">           
        </DoubleAnimation>
    </Storyboard> 
```

**背后的代码：（** 我也实现了 INotifyPropertyChanged）

```
 double _SbVolumeValue;
    public double SbVolumeValue
    {
        get
        {
            return _SbVolumeValue;
        }
        set
        {
            _SbVolumeValue = value;
            OnPropertyChanged("SbVolumeValue");
        }
    } 
```

当我为故事板制作动画时出现异常：

> > 没有为“System.Windows.Media.Animation.DoubleAnimation”指定目标。

我不想为目标设置动画，我只想为我的属性设置动画。我怎样才能做到这一点？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-05-16T07:35:16.590

对于`TargetName`您遇到的错误，您应该向我们展示实际应用情节提要的 XAML 代码...

同时我确信

```
 Storyboard.TargetProperty="{Binding SbVolumeValue}" 
```

...不是有效代码！这应该使用目标依赖属性的名称来指定，而**不是**通过`Binding`!

所以像...

```
 Storyboard.TargetProperty="Width" 
```

...**是正确的**，但类似 ​​....

```
 Storyboard.TargetProperty="EmployeeName" 
```

...**不正确**，就好像它不是依赖属性一样。

我希望我清楚！

# c# - 通过 ASP.NET MVC 中的自定义操作筛选器重定向到自定义视图

> ID：10609456
> 
> 赞同：3
> 
> 时间：2012-05-15T22:02:26.443
> 
> 标签：c#, asp.net, asp.net-mvc, action-filter

我需要实现以下自定义操作过滤器：

动作过滤器，当应用于一个动作时`CountRows`，应该在它的处理程序中`OnActionExecuting`“记住”它之前被调用的动作，并将客户端浏览器重定向到一个`Login`动作。但是登录动作应该以某种方式知道被调用的原始动作，以便在登录完成后，它会立即重定向回`CountRows`.

我猜我可以将原始动作名称 name 保存在`filterContext`'s`TempData`中，但是我一般如何实现该场景？

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-11-26T20:07:05.993

您可以使用以下代码简单地执行此操作：

```
[AttributeUsage(AttributeTargets.All)]
public class MyActionFilterAttribute : ActionFilterAttribute
{
    public override void OnActionExecuting(ActionExecutingContext filterContext)
    {
        //write your logic 

        RouteValueDictionary redirectTargetDictionary = new RouteValueDictionary();
        redirectTargetDictionary.Add("area", "");
        redirectTargetDictionary.Add("action", "Error");
        redirectTargetDictionary.Add("controller", "Home");
        filterContext.Result = new RedirectToRouteResult(redirectTargetDictionary);   
    }
} 
```

*MyActionFilter*重定向到链接“ *~/Home/Error* ”。

这个例子是从链接中复制的（并且为了回答的目的略有改变）： [http ://www.c-sharpcorner.com/UploadFile/ff2f08/use-of-mvc-custom-action-filter/](http://www.c-sharpcorner.com/UploadFile/ff2f08/use-of-mvc-custom-action-filter/)

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-05-15T23:01:20.043

你不应该需要临时数据。理想情况下，您的 SignIn GET 操作应采用字符串 returnUrl 参数。然后您可以使用过滤器并将 filterContext.HttpContext.Request.RawUrl 传递给登录。让它将重定向 URL 写入登录表单中的隐藏字段。然后当他们 POST 时，进行身份验证，并返回一个 Redirect(model.ReturnUrl)。

如果您使用 [Authorize] 属性装饰受保护的操作，则 MVC 实际上默认具有此行为。从技术上讲，它通过 Request.Url.Path 而不是 RawUrl，但概念和结果是相同的。

# css - 使用带有 webkit 渐变的 webkit 选择器的正确方法

> ID：10609457
> 
> 赞同：0
> 
> 时间：2012-05-15T22:02:29.097
> 
> 标签：css, webkit, selector

我正在使用`-webkit-gradient`文本，但它在 android 操作系统上创建了一个渐变块。后备颜色在其他浏览器中似乎可以正常工作，例如不使用选择器，但是当我添加`.webkit`选择器时，就像我在渐变下方一样，渐变停止适用于所有浏览器。这样做的正确方法是什么？

```
div#item-header h2 a
{
text-decoration:none;
text-transform:uppercase;
color:#bf000f;
font-family:ImpactWebFont;
font-weight:normal;
}
div#item-header h2 a.webkit
{
    background: -webkit-gradient(linear, left top, left bottom, from(#D60011), to(#540007));
    -webkit-background-clip: text;
    -webkit-text-fill-color: transparent;
} 
```

# logging - 如何在 Apache TomEE 中更改 OpenEJB 的日志记录级别

> ID：10609459
> 
> 赞同：1
> 
> 时间：2012-05-15T22:02:57.160
> 
> 标签：logging, openejb, apache-tomee

如何设置在 TomEE 中运行的 OpenEJB 组件的日志记录级别？我想从`org.apache.openejb.config.AutoConfig`.

我尝试修改 conf/logging.properties 并在我的 WAR 的 WEB-INF\classes 中添加一个 logging.properties 文件，但我找不到正确的组合，我什至不确定这些是要修改/创建的正确文件。

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-05-16T15:44:24.293

添加：

```
OpenEJB.startup.config.level=FINE 
```

到`conf/logging.properties`

~~由于某种原因从 Eclipse 启动服务器时，这不起作用。~~

要使其在 Eclipse 中工作，请将其添加到服务器的启动配置中：

```
 -Djava.util.logging.config.file="<put catalina.base path here>/conf/logging.properties"
 -Djava.util.logging.manager=org.apache.juli.ClassLoaderLogManager 
```

资料来源：[http ://wiki.eclipse.org/WTP_Tomcat_FAQ#How_do_I_enable_the_JULI_logging_in_a_Tomcat_5.5_Server_instance.3F](http://wiki.eclipse.org/WTP_Tomcat_FAQ#How_do_I_enable_the_JULI_logging_in_a_Tomcat_5.5_Server_instance.3F)

# python - python中混合设计的双向重复测量方差分析？

> ID：10609460
> 
> 赞同：1
> 
> 时间：2012-05-15T22:03:10.437
> 
> 标签：python, statistics, anova

有人知道用于执行混合实验设计（2组，4个条件）的双向重复测量ANOVA的python函数吗？我查看了 scipy.statistics，但它们似乎没有我需要的东西（除非我错过了......）

谢谢

# java - Spring Security 3.0 中的 security-role-ref 和 role-link 等价物是什么？

> ID：10609463
> 
> 赞同：2
> 
> 时间：2012-05-15T22:03:27.687
> 
> 标签：java, spring, jakarta-ee, spring-security

我正在将带有 web.xml、安全约束、安全角色和登录配置的标准 Web 应用程序移植到 Spring Security 3.0。除了 security-role-ref 元素之外，我在 web.xml 中找到了几乎所有功能的等效映射。

我不想规定安全角色名称用于部署环境，因此我利用 J2EE 安全性的映射功能将逻辑角色名称映射到物理角色名称，如下所示：

```
<servlet>
    <servlet-name>MyServlet</servlet-name>
    <servlet-class>org.example.MyServlet</servlet-class>
    <security-role-ref>
        <role-name>MANAGER</role-name>
        <role-link>DISTRICT_MANAGER</role-link>
    </security-role-ref>
</servlet> 
```

请注意，在上面的代码片段中，代码或 JSP 中有一项或多项检查，以查看用户是否处于逻辑角色“MANAGER”中。在此特定部署中，该角色链接到从 JAAS 上下文（JDBC 或 LDAP）返回的物理角色“DISTRICT_MANAGER”。

Spring Security 3.0 中是否有类似的映射工具？我希望避免修改应用程序以检查部署环境的物理角色，并且我无法让系统管理员仅为我的应用程序向用户的 LDAP 记录添加特定角色/权限。

提前致谢。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-05-17T13:42:18.540

Spring Security 3.1 有一个称为[GrantedAuthoritiesMapper](http://static.springsource.org/spring-security/site/docs/3.1.x/apidocs/org/springframework/security/core/authority/mapping/GrantedAuthoritiesMapper.html)的通用映射策略，您可以实现该策略并将其注入到 an`AuthenticationProvider`中，以告诉它如何将其加载的权限转换为将用于在应用程序中做出决策的权限。

如果您使用的是早期版本，您可以直接实现`AuthenticationProvider`并自己自定义对象的创建`Authentication`。例如，您可以在应用程序上下文文件中定义一组定义为映射的映射，并使用这些映射创建从提供者返回的最终权限集。映射实际上只是从`web.xml`应用程序上下文文件移动（并且应该不那么冗长）。

# mailchimp - Mailchimp 和老用户

> ID：10609469
> 
> 赞同：3
> 
> 时间：2012-05-15T22:04:00.300
> 
> 标签：mailchimp

我有一个过去几个月注册我的 Web 应用程序的用户数据库。

现在我想使用 Mailchimp 向他们发送时事通讯。我是否可以将他们的电子邮件地址添加到分发列表并开始向他们发送新闻通讯，或者在此之前，Mailchimp 是否会向他们发送一封电子邮件，询问他们是否要添加到我的分发列表中？

谢谢，
丹

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-05-15T22:10:32.333

AFAIK，MailChimp 支持单选择和双选择列表，并且只会在用户通过 mailchimp 表单（或 API）注册时发送双选择确认电子邮件。如果您导入列表，则假定用户已经选择加入并且没有发送欢迎电子邮件。

他们确实非常密切地关注退订/投诉率，但确保您的列表干净很重要，否则您的帐户可能会被关闭。如果您只是为了这个猜测而设置一个新帐户，则不必担心，但如果它是现有帐户则可能会担心。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-05-15T22:11:14.687

我以前尝试过一次，结果不太令人满意。

我有一个包含大约 2,000 个用户的数据库，并将他们全部添加到 Mailchimp 列表中。Mailchimp 为用户提供了报告垃圾邮件的能力，而且他们的容忍度非常严格。我想我可能有 4-5 个帐户将我的邮件报告为垃圾邮件（超过 2,000 个），Mailchimp 立即暂停了我的帐户。

在承诺实施选择加入机制后，我能够重新激活它。问题是，我曾经实际上*有*一个选择加入机制，你必须选中一个框，说你想被添加到邮件列表中，但是在数百个用户中，我从来没有人选中那个框。当我默认选中它时，我从来没有人取消选中它。所以我只是想没人在乎。

Mailchimp 确实有一个 API，因此可以将您的用户数据库与 Mailchimp 集成，并为人们订阅和取消订阅时事通讯提供 UI 机制。

# android - Android 如何用手指移动视图

> ID：10609473
> 
> 赞同：2
> 
> 时间：2012-05-15T22:04:34.617
> 
> 标签：android, android-animation

我正在尝试根据触摸在其父级内部平滑移动视图。我有 OnTouchListener 工作和跟踪动作。我如何实际移动视图？我试过使用 RelativeLayout.LayoutParameters 并设置边距，但边距只接受 int 值，这使得视图抖动。我尝试过使用 TranslateAnimation，它可以让我使用浮点数，但这只会移动画布，所以我的触摸事件被抛在了后面。有没有人想出一种方法来顺利地做到这一点？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-05-15T22:26:48.943

最好的解决方案是重写一个自定义 ViewGroup 子类，这会折磨你的灵魂。如果成功，请确保您有超人的神经:)。

第二种解决方案更简单，但当且仅当您的视图包含图像时才有效。因此，您可以编写自定义 View 子类并在 onDraw() 方法的 Canvas 上细化图像。

我的最后一个解决方案是 OpenGL。

另外，我不确定，但可能在相对布局有点布局更新边距，然后 invalidate() 视图可能会起作用。

祝你好运！

# iphone - 将时间戳转换为日期格式

> ID：10609474
> 
> 赞同：2
> 
> 时间：2012-05-15T22:04:38.270
> 
> 标签：iphone, ios, ipad

我正在尝试将时间戳（NSTimeInterval）转换为日期格式。我得到了正确的当前日期（日-月-年），但时间不对。这是我的代码。如何修复它以正确获取当前时间？提前致谢。

```
- (NSString*)formatTimestamp:(NSTimeInterval)timeStamp
{
    NSDate *date = [NSDate dateWithTimeIntervalSinceNow:timeStamp];
    NSDateFormatter *formatter=[[NSDateFormatter alloc]init];
    [formatter setDateFormat:@"dd-MM-yyyy HH:mm:ss:SSS zzz"];
    NSString *dateString=[formatter stringFromDate:date];
    [formatter release];
    return dateString;
} 
```

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-05-16T08:45:06.477

也许我误解了一些东西，但我认为你的比较是不对的......

`NSLog`'s time 是*当前时间*，`UIEvent`'s`timestamp`是*自系统启动以来的秒数*（并且您使用 将其添加到当前时间`[NSDate dateWithTimeIntervalSinceNow:]`）...

如果您想要绝对日期时间，则需要先获取系统启动日期，这并不容易......`UIEvent`然后添加`UIEvent`.`timestamp`

您可以使用

```
lastRebootTime = [[NSDate date] addTimeInterval:-[self secondsSinceLastReboot]]; 
```

和

```
- (NSTimeInterval)secondsSinceLastReboot
{
    // get the timebase info -- different on phone and OSX
    mach_timebase_info_data_t info;
    mach_timebase_info(&info);

    // get the time
    uint64_t absTime = mach_absolute_time();

    // apply the timebase info
    absTime *= info.numer;
    absTime /= info.denom;

    // convert nanoseconds into seconds
    return (NSTimeInterval) ((double)absTime / 1000000000.0);
} 
```

参照。[生成 iPhone UIEvent 时间戳](http://davepeck.org/2010/03/08/generating-iphone-uievent-timestamps/)

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-05-15T22:17:15.733

需要设置时区吗？

NSTimeZone *timeZone = [NSTimeZone timeZoneWithName:@"YourTimeZone"]; [foprmatter setTimeZone:timeZone];

# prolog - 将 OSM 数据转换为 Prolog 事实？

> ID：10609483
> 
> 赞同：2
> 
> 时间：2012-05-15T22:05:32.427
> 
> 标签：prolog, converter, openstreetmap

对于一个小型实验，我想将导出的[OSM](http://planet.openstreetmap.org/)数据集从 XML 转换为 Prolog。

我知道有某些通用 XML 到 Prolog 转换器（例如[Pl4Xml](http://www.techrepublic.com/whitepapers/pl4xml-an-swi-prolog-library-for-xml-data-management/2358643)），但是这些通用转换器是解决这个问题的最佳方法吗？可能有人知道将 OSM 数据转换为Prolog 中**方便表示的库？**

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-05-16T23:01:03.643

塞尔吉奥，我不知道最好的方法。但是我用 OSM 做了我自己的小实验。我没有使用 Pl4XML，而只是使用带有库（sgml）的 SWI-Prolog。像这样：

```
tt2(tag, Attrs, _) :- 
   memberchk(k=Key, Attrs), 
   \+ tag(Key), assertz(tag(Key)), 
   fail ; true.

?- dynamic tag/1.
?- new_sgml_parser(Parser, []), 
   open('UA.osm', read, Stream), 
   sgml_parse(Parser, [source(Stream), call(begin, tt2)]), 
   free_sgml_parser(Parser), 
   close(Stream). 
```

UA.osm 是我的 XML 数据。我有超过 1000 个不同的标签键。应该妥善处理。我认为最好的方法是对 OSM 节点、方式和与公共`tags`成员的关系使用谓词，并将标签数据表示为一组有序的键值对（或 AVL 树）。因为我是[Uranium Test](http://uranium-test.sourceforge.net)的开发人员，所以我认为 Uranium 为我提供了 Prolog 的最佳对象模型（对于特定的 Prolog 实现没有锁定）。我可以给你一个例子，你可以如何管理 OSM 对象关系：

```
:- module(node_v, [on_begin/3, on_end/2]).
:- use_module(u(v)).

% helper for callback tag parsing
new_class(xml_tag_v, db_object_v, [closed_by_parser]).

% OSM element 
new_class(element_v, xml_tag_v,
      [id,
       changeset,
       visible,
       user,
       timestamp,
       tags]).

% OSM node, way and barrier - children of element
new_class(node_v, element_v, [lat, lon]).
new_class(way_v, element_v, [nodes]).
new_class(barrier_v, element_v, [barrier_type]).

% Example of a tag-based dynamic class
% (see http://wiki.openstreetmap.org/wiki/Barriers)
'element_v?'(Obj, class, barrier_v) :-
   obj_field(Obj, tags, Tags),
   % if it contains Key:barrier it is a barrier
   % (way or node)
   memberchk(barrier-_, Tags), !.

% XML parsing callbacks
on_begin(node, Attrs, _) :-
   % Construct the node_v object
   obj_construct(node_v, [], [], Obj),
   foreach(member(Name=Value, Attrs),
      obj_field(Obj, weak, Name, Value)),
   % Put it into DB 'nodes'
   db_recorda(nodes, Obj).

on_begin(tag, Attrs, _) :-
   db_recorded(nodes, Obj0), !,
   obj_rewrite(Obj0,
           [closed_by_parser, tags],
           [Is_Closed, Tags0],
           [Is_Closed, Tags], Obj),
   var(Is_Closed), !, % found unclosed node
   memberchk(k=Key, Attrs),
   memberchk(v=Value, Attrs),
   (  var(Tags0) -> Tags1 = [] ; Tags1 = Tags0 ),
   Tags = [Key - Value|Tags1], % add new tag
   db_recorda(nodes, _, Obj, _, replaced). % db update

on_end(node, _) :-
   % close the node parsing
   db_recorded(nodes, Obj0), !,
   obj_rewrite(Obj0,
           [closed_by_parser, tags],
           [_, Tags0],
           [true, Tags], Obj),
   (  var(Tags0) 
   -> Tags = [] 
   ; sort(Tags0, Tags) % if your expectation for a number of tags is big
                       % try use library(assoc) (AVL trees)
   ),
   db_put_object(nodes, _, Obj, _, replaced). 
```

new_class/3 定义了一个类 - 它是一个常见的序言术语，可以命名访问值（在附加谓词的帮助下）和许多其他东西，如继承、对象数据库等。该模块定义了三个主要的 OSM 实体-`node_v`和（_v 是对象的后缀）作为. 每个都包含该字段。`way_v``relation_v``element_v``element_v``tags`

`barrier_v`是一个如何根据标签键（或值）识别 OSM 类的示例。在这个例子中，一个特殊的谓词'element_v?'/3 计算一个对象的一个​​类。barrier_v 可以是 node_v 或 way_v 的子节点（此示例中未显示）。

该模块的最后一部分是 XML（回调）解析器。我用 ~1.7G 文件对其进行了测试，它运行良好（SWI-Prolog）。

节点 - 是一个基于标准 prolog 数据库的对象数据库（也可以在未来版本中使用外部 PostgreSQL）。

一个解析结果的例子是：

```
?- db_recorded(nodes, N), obj_pretty_print(N), !.

N = node_v(70, '6176525', true, nodes, 32, '10980421', '46.4718061', '30.7308961', 
    [highway-traffic_signals], '2010-10-25T19:17:07Z', 'Buccaneer', _G391)

node_v ( 
  changeset : 6176525 
  closed_by_parser : true 
  db_key : nodes 
  db_ref : 32 
  id : 10980421 
  lat : 46.4718061 
  lon : 30.7308961 
  tags : [highway-traffic_signals] 
  timestamp : 2010-10-25T19:17:07Z 
  user : Buccaneer 
) 
```

Uranium 还提供了许多对象/数据库操作谓词、图形算法和许多其他思想。很抱歉没有在项目网站上显示所有这些内容。我们主要在商业项目中使用铀，SF 网站是我空闲时间的孩子。但它是开源的，我们有很多文档和示例可以分享。

希望我的回答有用。

# android - 如何保存 onActivityResult 结果？

> ID：10609484
> 
> 赞同：0
> 
> 时间：2012-05-15T22:05:38.157
> 
> 标签：android

我创建了一个`MainActivity`和一个`SecondActivity`。当`onClick` `MainActivity`它启动时`SecondActivity`。完成`SecondActivity`后，它返回一个值，该值变成一个`ImageView.setVisibility(View.VISIBLE);`并生成一个`counter++`。

我的问题是，当我关闭应用程序然后再次重新启动它时，所有值都被清除了，我的`ImageView`轮流`ImageView.setVisibility(View.INVISIBLE);`又一次`counter == 0`。

`SecondActivity`即使我关闭应用程序或重新启动我的手机，我如何保存数据（结果）？我想`public void onCreate(Bundle savedInstanceState) {`在每次重新启动应用程序时关闭应用程序之前进行设置。

* * *

我想要的是保存“int contadorliga”、“correcto1.setVisibility(View.VISIBLE);” 和“correcto2.setVisibility(View.VISIBLE);” 所以每次我重新启动应用程序时，它都是最近一次。这是我的代码：

```
package com.fakur.android.futbolquiz;

import android.app.Activity;
import android.content.ComponentName;
import android.content.Intent;
import android.os.Bundle;
import android.view.View;
import android.widget.ImageView;
import android.widget.TextView;

public class Liga extends Activity {
/** Called when the activity is first created. */

static final int LIGA = 0;
int contadorbarcelona = 0;
int contadormadrid = 0;
int contadorliga = 0;

ImageView about;

@Override
public void onCreate(Bundle savedInstanceState) {
super.onCreate(savedInstanceState);

setContentView(R.layout.liga);
TextView contador1 = (TextView) findViewById(R.id.contador1);
contador1.setText(contadorliga + "/20");
}

public void onBarcelonaClick(View botton) {

Intent intent = new Intent();
intent.setClass(this,Pregunta.class);
intent.putExtra("Barcelona", "Barcelona");
startActivityForResult(intent,LIGA);
}

public void onMadridClick(View botton) {

Intent intent = new Intent();
intent.setComponent(new ComponentName(this,Pregunta.class));
intent.putExtra("Madrid", "Madrid");
startActivityForResult(intent,LIGA);
}
protected void onActivityResult(int requestCode, int resultCode, Intent data) {
super.onActivityResult(requestCode, resultCode, data);

TextView contador1 = (TextView) findViewById(R.id.contador1);
ImageView correcto1 = (ImageView) findViewById(R.id.correcto1);
ImageView correcto2 = (ImageView) findViewById(R.id.correcto2);

if (requestCode == LIGA){

  if (resultCode == 1) {

      if(contadorbarcelona == 0){

          correcto1.setVisibility(View.VISIBLE);
          contadorliga++ ;
          contadorbarcelona++;
      }
  }

  if (resultCode == 2) {
      if(contadormadrid == 0){

           correcto2.setVisibility(View.VISIBLE);
           contadorliga++ ;
           contadormadrid++;
      }
  }

}

contador1.setText(contadorliga + "/20");

} 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-05-15T23:04:42.060

如果您的数据集不是很大，就像 Gokhan 建议的那样，使用共享偏好对您来说非常有用。

同时，如果您有很多类似的数据要存储，请使用 sqlite3 数据库来存储您的数据。[链接](http://developer.android.com/resources/tutorials/notepad/index.html)。

此外，将数据存储在 onStop() 函数中。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-05-15T22:54:42.347

共享偏好的使用最适合您，请参见[此处](http://developer.android.com/guide/topics/data/data-storage.html#pref)

编辑：

*   在下面添加了源以回应您的评论；

    ```
    private static final String PREFERENCES_CONTADORLIGA =  "ChangeThisTextWithSomethingYouPrefer";
    private static final String PREFERENCES_CONTADORLIGA_KEY = "ChangeThisTextWithSomethingYouPrefer";

    public void onCreate(Bundle savedInstanceState)
    {

        // Restore preferences
        SharedPreferences settings = getSharedPreferences(PREFERENCES_CONTADORLIGA, Context.MODE_PRIVATE);
        contadorliga = settings.getInt(PREFERENCES_CONTADORLIGA_KEY, 0);
    }

    protected void onDestroy() 
    {

        super.onDestroy();

        // We need an Editor object to make preference changes.
        // All objects are from android.context.Context
        SharedPreferences settings = getSharedPreferences(PREFERENCES_CONTADORLIGA, Context.MODE_PRIVATE);
        SharedPreferences.Editor editor = settings.edit();
        editor.putInt(PREFERENCES_CONTADORLIGA_KEY, contadorliga);

        // Commit the edits!
        editor.commit();
    } 
    ```

我希望这对你有用。祝你好运！

# visual-studio-2008 - MSBuild - 如何复制项目目录之外的文件

> ID：10609489
> 
> 赞同：1
> 
> 时间：2012-05-15T22:05:57.980
> 
> 标签：visual-studio-2008, msbuild, copy, csproj

我是 MSBuild 的新手，我正在尝试将文件从源代码控制上的一个文件夹复制到项目目录。下面是代码：

```
<ItemGroup>
    <MySourceFiles Include="C:\my_clearcase_view\Demo_Folder\demo.jar" />
</ItemGroup>

<Target Name="AfterBuild">
   <Copy SourceFiles="@(MySourceFiles)" DestinationFiles="$(MSBuildProjectDirectory)\demo.jar" />
</Target> 
```

此代码适用于“demo.jar”文件的绝对路径。文件夹结构如下所示：

```
C:\my_clearcase_view\
             - DemoFolder (Source)
             - my_project (Destination, which is $(MSBuildProjectDirectory)) 
```

假设源路径永远不会改变，我怎样才能获得文件夹层次结构中项目上方的源文件的相对路径？我只能使用 $(MSBuildDirectory) 到达项目目录的根目录。请指教。提前致谢。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-05-15T22:19:03.363

如果我对您的理解正确，您可以这样做；

```
<ItemGroup>
    <MySourceFiles Include="$(MSBuildProjectDirectory)\..\Demo_Folder\demo.jar" />
</ItemGroup> 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-05-16T14:13:48.437

根据 Rory 的回答，我尝试了不同的组合，最终得到了它。

```
<ItemGroup>
   <MySourceFiles Include="..\Demo_Folder\demo.jar" />
</ItemGroup> 
```

感谢指针罗里。

# mysql - mySQL - 单个表中的 SELECT 日期范围重叠

> ID：10609491
> 
> 赞同：4
> 
> 时间：2012-05-15T22:06:10.460
> 
> 标签：mysql

很抱歉之前可能会搞砸这个问题......它仍然让我感到困惑。

基本上，我有一个表来跟踪一组报告的“审批者”。还跟踪报告的“创建”时间和“提交”时间。

我希望标记任何报告的日期/时间重叠。

示例（一个表格，“报告”）：

```
"Created"                 "Submitted"                "ApproverID"
4/20/2012 5:01:32 AM          4/20/2012 5:30:32 AM          10
4/20/2012 5:08:32 AM          4/20/2012 5:45:32 AM          10
4/20/2012 5:01:32 AM          4/19/2012 5:38:16 PM          15 
```

...我需要返回以下内容（同一批准人重叠日期/时间）

```
"Created"                 "Submitted"                "ApproverID"    
4/20/2012 5:01:32 AM          4/20/2012 5:30:32 AM          10            
4/20/2012 5:08:32 AM          4/20/2012 5:45:32 AM          10 
```

因此审批者（本例中为 10 个）有一个与这些报告重叠的窗口。看起来像是一个带有 BETWEEN 子句的 SELECT ......但我有点难过。

我有一些简单的东西，如下所示：

```
SELECT Created, LastModified, ApprovalGroupID, count(*) 
FROM   shifthandover.uniquereports
WHERE ApprovalGroupID between Created and LastModified 
```

帮助赞赏！

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-05-15T22:16:05.360

根据您的问题，我了解到在创建第一个（或更早）报告之后但在提交之前的报告之前创建第二个（或后续）报告时会发生“重叠” - 即批准人正在处理多个报告一次。那是对的吗？

您可以尝试将报告表连接到自身 - 例如：

```
SELECT * FROM reports r1 
JOIN reports r2 
ON r1.approvalId=r2.approvalId 
AND r2.created>r1.created 
AND r2.created<r1.submitted 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-05-16T00:27:11.310

```
SELECT   Created, LastModified, ApprovalGroupID, count(*) --whatever those are
FROM     uniquereports AS r1
JOIN     uniquereports AS r2.ApproverID = r1.ApproverID AND r2 ON r2.id = r1.id -- the unique id of the table, or use whatever combination to get a unique representation, which is important.
WHERE    r2.Created >= r1.Created AND r2.Created <= r1.LastModified OR
         r2.LastModified >= r1.Created AND r2.LastModified <= r1.LastModified OR
         r2.Created <= r1.Created AND r2.LastModified >= r1.LastModified OR
         r2.Created >= r1.Created AND r2.LastModified <= r1.LastModified             
GROUP BY r1.ApproverID 
```

The last `OR` clause is not useful here since we have already considered the case of `r2.Created` being greater than `r1.Created` in first `OR` clause, considering technically a record can not be modified before its created. Still added there to ensure all cases.

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-05-16T14:12:47.763

这提供了批准者 ID 和该批准者的重叠数。

```
select approver_id, count(*)/2 from (
  select t1.approver_id 
  from reports t1 
  join reports t2 on 
     t2.approver_id = t1.approver_id 
     AND t1.id <> t2.id 
  where
     NOT((t1.submitted < t2.created) 
     OR (t1.created > t2.submitted))
  ) t2 group by approver_id; 
```

count(*)/2 在那里，所以你不会重复计算 A 重叠 B 和 B 重叠 A 的排列。另外，我假设你有一个 record_id 或其他主键来防止记录本身计数。

# ruby - Ruby::test/unit - 如何动态地将测试插入到测试用例的中间？

> ID：10609493
> 
> 赞同：2
> 
> 时间：2012-05-15T22:06:24.537
> 
> 标签：ruby, module, watir, testunit

我对 ruby​​ 和 test/unit 有点陌生，所以这似乎是一个愚蠢的问题，但我正在寻找一种方法来动态地将测试输入到模板测试用例中（顺序很重要）。

基本上我有一个类似的测试用例：

主测试用例文件：

```
#testcase.rb

require 'test/unit/ui/console/testrunner'
require 'watir/testcase'
load "customTest1.rb"

class TC_Test_US < Watir::TestCase
    def test_a
        #do stuff
    end

    def test_b
        #do stuff
    end

    #dynamically load website specific modules here
    include myStuff
    # end of custom tests carry on with generic tests    

    def test_y
       #do stuff
    end

    def test_z
       #do stuff
    end
end 
```

-- 自定义测试用例

```
#customTest1.rb
module myStuff
    def test_customTest1
       #do stuff
    end

    def test_customTest2
       #do stuff
    end
end 
```

现在我有几个 customTestX.rb 文件。目前我在每个文件中将我的 test_a 复制到 test_z ，当我需要更改一个或添加一个新文件时，这很糟糕。

我希望能够重用主测试中的测试，并在中间动态插入我的自定义测试（重要的是 test_b 留在我的测试之前，而 test_y 留在我的测试之后）。我会动态更改“加载 customTestX.rb”并在每个文件中保持模块名称相同。

当我像这样启动这个测试用例时，我没有收到任何错误，但我的自定义测试都没有真正执行。脚本从 test_b 跳到 test_y 并且 customTest1 和 customTest2 没有被执行。

答案可能在于我的主要 testcase.rb 实例化，但我还没有成功地做到这一点。一旦您加载主文件，它就会执行....如果我删除了 testrunner 要求行，我将无法加载文件而没有例外。如果我这样做，我不确定如何在中间插入我的方法。有什么建议么？

谢谢！！！

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-05-16T13:20:38.837

您的自定义测试未运行，因为它们不是以“测试”一词开头的。

“test”前缀是 Test::Unit 如何知道哪些方法是测试与常规方法。我相信 Watir::TestCase 是一样的。

尝试：

```
#customTest1.rb
module myStuff
    def test_customTest1
       #do stuff
    end

    def test_customTest2
       #do stuff
    end
end 
```

**更新 - 使用 TestSuite：**

我不确定为什么您的解决方案不起作用，但看起来可行的一种解决方案是使用 TestSuite。然后，您可以调用您的起始测试用例、自定义测试用例和结束测试用例。

测试套件：

```
#testsuite.rb
require 'test/unit/ui/console/testrunner'
require 'test/unit/testsuite'
require 'rubygems'
require 'watir/testcase'
require 'testcase_start'
require 'testcase_end'
require 'customTest1'

class TS_MyTests
    def self.suite
        suite = Test::Unit::TestSuite.new
        suite << TC_Test_US_Start.suite
        suite << MyStuff.suite
        suite << TC_Test_US_End.suite
        return suite
    end
end
Test::Unit::UI::Console::TestRunner.run(TS_MyTests) 
```

您的初始测试：

```
#testcase_start.rb
class TC_Test_US_Start < Watir::TestCase
    def test_a
        #do stuff
       puts 'a'
    end

    def test_b
        #do stuff
       puts 'b'
    end
end 
```

你的结束测试：

```
#testcase_end.rb
class TC_Test_US_End < Watir::TestCase
    def test_y
       #do stuff
      puts 'y'
    end

    def test_z
       #do stuff
      puts 'z'
    end

end 
```

您的自定义中间测试：

```
#customTest1.rb
class MyStuff < Watir::TestCase
    def test_customTest1
      puts '1'
    end

    def test_customTest2
      puts '2'
    end
end 
```

# ruby-on-rails - 为什么 RVM/Bundler 集成会破坏 RVM 与终端的加载？

> ID：10609495
> 
> 赞同：1
> 
> 时间：2012-05-15T22:06:29.877
> 
> 标签：ruby-on-rails, ruby-on-rails-3, rvm

**注意：我已经在我的环境中修复/破解了这个问题（详情如下），但我真的很想了解发生了什么并提供资源，如果这发生在其他人身上。希望这是对 Stack 的正常使用。:)**

我正在阅读 Michael Hartl 的 Ruby on Rails 教程（第 2 版），今天遇到了我的第一个主要问题。

在第 3 章[第 3.6.1 节“消除 Bundle Exec”](http://ruby.railstutorial.org/chapters/static-pages#sec:eliminating_bundle_exec)中，我执行了这些命令以让 Ruby 版本管理器 (RVM) 为所有项目“调整”我的路径，这样我就可以停止经常键入*bundle exec ：*

```
$ rvm get head && rvm reload
$ chmod +x $rvm_path/hooks/after_cd_bundler
$ cd /path/to/project
$ bundle install --binstubs=./bundler_stubs 
```

..瞧！我不能再运行*bundle*、*rvm*或许多其他常用功能（我还是 Rails 的新手，所以我不知道这些命令共享什么关系或起源）。我进行了完全重启，因为我来自 Windows，这正是你在狗屎变得时髦时所做的事情，但问题仍然存在！布拉格！

**bundle、rvm 等的错误是相同的：**

> -bash：rvm：找不到命令

（注意：大约在这个时候，我将*xcode-select -switch*从 /Developer 修改为其他更长、更疯狂的路径 -如果您认为这可能会起作用，请参阅[此链接以获取详细信息）](https://github.com/thibaudgg/rb-fsevent/issues/26)

我做了一些挖掘，发现这可能与我的 $PATH 有关，所以这是我的*环境 $PATH*，如果重要的话：

```
PATH=/usr/bin:/bin:/usr/sbin:/sbin:/usr/local/bin:/usr/X11/bin:/usr/local/git/bin 
```

PATH 似乎是错误的——那里应该有一些 RVM 的东西，或者那里有一些捆绑器的东西——这就是改变的重点！- 所以我做了更多的挖掘，发现我的文件系统仍然完好无损（RVM 仍然安装，Gemfile 仍然正确等），但在我的终端会话中，Ruby 的版本是旧的（v1.8.7），而且 Rails 甚至都没有安装，所以它开始看起来更像是特定于会话或 RVM 的问题。

做了更多的挖掘，发现如果我在终端中手动运行以下命令（来自**~/.bash_login ），一切正常：**

```
[[ -s "$HOME/.rvm/scripts/rvm" ]] && source "$HOME/.rvm/scripts/rvm" # Load RVM into a shell session *as a function* 
```

是的！

当我关闭并重新打开终端时，问题又回来了，但是当我重新执行上面的命令时，问题再次得到解决。很明显，这只是终端中没有正确加载的问题，对吧？

我将上面的命令移到**~/.bash_profile**（除了提示样式之外，它以前是空的），问题对我来说已经完全解决了。我可以关闭并重新打开终端，我要去参加比赛了。

**但是发生了什么？！**为什么该命令在**~/.bash_login**而不是**~/.bash_profile**？我很想了解正在发生的事情，这样我就不会那么笨拙了，这样其他人就可以避免我刚刚经历的 2 小时的 Google 搜索冒险。:)

谢谢！

环境：

*   Mac OS X 10.7.4（狮子）
*   终端（内置）
*   崇高的文字 2

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-05-16T02:51:58.333

选择其中一个文件并将其合并到第二个文件中。

RVM 检查这两个文件，一个包含加载 RVM 就足够了，它会工作。

要摆脱`bundle exec`你，可以使用我的 gem **ruby​​gems-bundler**，它将被集成到 bundler 1.3 中，因此不再需要额外的工具/脚本/技巧。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-05-15T23:35:46.083

好吧，登录脚本将在不同的时间运行。[您可以在这个so question](https://stackoverflow.com/questions/415403/whats-the-difference-between-bashrc-bash-profile-and-environment)中看到一些细节。但据此[，](http://www.hypexr.org/bash_tutorial.php)是`~/.bash_login`一个别名`~./bash_profile`。所以我不确定为什么一个为你运行而另一个不为你运行。

但是，在我的系统（Mac OS X 10.6）上，我没有`~/.bash_login`文件。我有 rvm 和 bundler。

可能相关 - 我安装了 Homebrew，它建议了我`/usr/local/bin`之前的路径`/usr/bin`。这样 Homebrew 安装的项目和我自己安装的项目将优先于系统安装的项目。

# android - 使用模拟器 Android 使用生产密钥库构建

> ID：10609498
> 
> 赞同：0
> 
> 时间：2012-05-15T22:07:10.107
> 
> 标签：android, android-emulator

我的应用程序有一些 facebook 集成，需要使用我的密钥库对应用程序进行签名。但是，在模拟器上运行时，这不起作用，因为它使用默认的调试密钥库。

是否可以将我的开发人员密钥库用于模拟器来解决此问题？

当我使用手机进行开发时，我通常不会介意，但我需要在演示中展示它。

谢谢，

# java - Doclets vs DocLava

> ID：10609499
> 
> 赞同：0
> 
> 时间：2012-05-15T22:07:12.527
> 
> 标签：java, javadoc, doclet

我的*理解*是：

*   Java Doclet API 只是一个 API（由接口组成），植根于`com.sun.javadoc`
*   当 Javadoc 运行时，它会查找要在运行时绑定到的 Doclet API impl
*   如果不存在这样的 impl，则它使用一些默认值（因此您可以生成 Javadocs 而无需指定自己的 CSS 文件等）
*   Google 的 DocLava 就是这样一种 Doclet API impl

如果这是真的，那么如何指定一个不同的 Doclet impl（例如 DocLava）而不是默认值？如果我偏离了基础，那么 Javadoc 工具、Doclet API 和 DocLava 是如何相互关联的？

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-05-15T23:02:43.540

> 如何在默认情况下指定不同的 Doclet impl（例如 DocLava）？

请参阅[javadoc 工具文档](http://docs.oracle.com/javase/1.5.0/docs/tooldocs/windows/javadoc.html#doclet)命令行选项部分。您指定要与`-doclet`参数一起使用的文档：

> `-doclet class`
> 
> 指定启动用于生成文档的 doclet 的类文件。使用完全限定名称。此 doclet 定义内容并格式化输出。如果未使用 -doclet 选项，javadoc 将使用标准 doclet 生成默认 HTML 格式。此类必须包含 start(Root) 方法。此起始类的路径由 -docletpath 选项定义。
> 
> 例如，要调用 MIF doclet，请使用：
> 
> ```
>  -doclet com.sun.tools.doclets.mif.MIFDoclet 
> ```
> 
> 有关运行特定 doclet 的完整工作示例，请参阅[运行 MIF Doclet](http://java.sun.com/j2se/javadoc/mifdoclet/docs/mifdoclet.html#runningmifdoclet)。

有关使用 DocLava doclet 的详细信息，请参阅[DocLava 入门](http://code.google.com/p/doclava/wiki/GettingStarted)指南：

> 传递给 Javadoc 以使用 Doclava 的命令行参数是：
> 
> ```
> -doclet com.google.doclava.Doclava
> -docletpath ${jar.file} 
> ```

# python - win32security.LogonUser() 是否更新上次登录时间戳？

> ID：10609500
> 
> 赞同：0
> 
> 时间：2012-05-15T22:07:49.163
> 
> 标签：python, active-directory, pywin32, windows-security

我正在编写一个 Python 脚本，它将自动从列表中登录用户。此脚本将每月运行一次，以防止帐户因活动不足而被禁用。下面是工作代码：

```
import win32security
import getpass
accounts = {'user1':'password1', 'user2':'password2', 'user3':'password3'}
for username, password in accounts.items():
    handle = win32security.LogonUser(username, "DOMAIN", password, win32security.LOGON32_LOGON_INTERACTIVE, win32security.LOGON32_PROVIDER_DEFAULT)
    print username.upper() + ': ' + repr(bool(handle))
    handle.close() 
```

我的问题是，win32security.LogonUser() 会更新 Active Directory 中的“上次登录”时间戳吗？是否有其他方法可以在没有 Active Directory 服务器管理权限的情况下实现此目的？

谢谢

沃尔

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-05-16T22:10:22.917

您正在进行的交互式登录调用应该更新它。即使具有管理权限，也无法手动更新该值，但仅供参考。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-05-28T19:08:50.090

任何交互式登录、文件服务访问或交换服务器访问都将更新 LastLogon，从而更新由 DS 服务器管理的 LastLogonTimestamp，并保持 10 天内的准确性。

# javascript - 隐藏文本并添加一个按钮以使其显示

> ID：10609502
> 
> 赞同：1
> 
> 时间：2012-05-15T22:08:28.810
> 
> 标签：javascript, jquery, css, iframe, greasemonkey

我正在尝试更改脚本，我这样做更多是为了学习如何去做，而不是因为我需要它。

单击页面上的链接后，您将获得一个 javascript:nameoffunction('somekey'); 所以它会在你的屏幕上弹出。在右侧的网站空白部分弹出[的脚本打开至少是意图。](http://userscripts.org/scripts/show/121249)

所以我想要做的是用一个按钮“显示它”隐藏打开对象的描述文本，这样文本只会在点击时出现。

我试过使用监听器 onload,DOMNodeInsertedIntoDocument 没有任何工作。我尝试在 DOM 上输入按钮的元素出现未定义错误

```
document.body.innerHTML += '<div id="divlegenda" align="left">';

if (typeof contentWindow != 'undefined') {
    unsafeWindow = contentWindow; // google chrome
} else if (typeof unsafeWindow != 'undefined') {
    // firefox
} else {
    unsafeWindow = window; // opera + safari?
}

//unsafeWindow
unsafeWindow.abredown = function abredown(download) {
    document.getElementById('divlegenda').innerHTML = '<iframe src="info.php?d='+download+'" width="498" height="2500" frameborder="0" id="framelegenda"></iframe>';

}

description = document.getElementById('divlegenda').getElementsByClassName('comentuser')[0];
description.style.display='none';

button = document.createElement('button');
button.id = 'show';
button.appendChild(document.createTextNode('<< Show >>'));
button.onclick = function () { click(); };
document.getElementsByClassName('titulofilme')[2].appendChild(button);

function click() {
    description.style.display='inherit';
    button.style.display='none';
} 
```

我尝试插入的 HTML 部分

```
 <td class="titulofilme">
<div align="left">Comentário:</div>
</td>
</tr>
<tr>
<td class="comentuser">
<div id="descricao" align="left">
...text here... 
```

当我在页面上打开源代码时，找不到以 id divlegenda 插入的元素。当我右键单击时，我只能通过检查元素看到它

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-05-16T02:13:22.823

几个问题：

1.  Greasemonkey 在 iframe 上运行，就好像它们是单独的页面一样。在为您关心 iframed 内容的页面进行编码时，您必须考虑（或利用）这一点。

2.  尽量避免使用`innerHTML`。它会破坏事物（事件等），速度很慢，如果您尝试编写可重用的代码，它在浏览器中的行为会有所不同。
    `document.body.innerHTML +=`特别糟糕。

3.  这是尝试获得跨浏览器兼容性的错误方法，它不会起作用。此外，`contentWindow`对于许多版本的 Chrome，它已过时。

    如果脚本适用于多个浏览器，请在问题中说明并适当标记。这被标记为[greasemonkey](/questions/tagged/greasemonkey "显示标记为“greasemonkey”的问题") - 这意味着它适用于Firefox 或Tampermonkey（Chrome 扩展）。
    除非您有充分的理由不这样做，否则以纯 Greasemonkey 风格编写代码是最简单和最好的。

4.  升级到[jQuery](http://jquery.com/)，它会让事情变得更容易。

5.  不要使用属性来设置样式（`width="498"`,`height="2500"`等）。使用 CSS。

6.  当您打开页面源代码 ( `Ctrl``U`) 时，它仅显示静态 HTML，您不会看到页面、Greasemonkey 或 Firebug 已更改的内容。为此使用检查工具。
    **但是**，如果您***保存***页面 ( `Ctrl``S`)，Firefox 会将当前 DOM 保存到磁盘，包括各种脚本所做的更改。

因此，无需进一步解释，这里是一个*Greasemonkey*脚本，它执行问题指定的操作：

```
// ==UserScript==
// @name        _Legendas.tv, show details in an iframe
// @namespace   _pc
// @include     http://legendas.tv/*
// @include     https://legendas.tv/*
// @require     http://ajax.googleapis.com/ajax/libs/jquery/1.7.2/jquery.min.js
// ==/UserScript==

if (window.top == window.self) {
    /*--- This part executes only in the master window (Not in iframes).
        It's not necessary in this case, just showing how...
    */
    //--- jQuery uses proper DOM methods to add nodes
    $("body").append ('<div id="divlegenda"></div>');

    unsafeWindow.abredown   = function abredown (download) {
        var legendaryDiv    = document.getElementById ('divlegenda');
        if (legendaryDiv) {
            //--- innerHTML is okay-ish here; replace later.
            legendaryDiv.innerHTML  = '<iframe src="info.php?d='
                                    + download + '"></iframe>';
        }
        window.scrollTo (0,0);
    }
}

/*--- This part executes both in frames and out. But the code (so far)
    is harmless if the targeted nodes are not present.
*/

//--- Hide comments but add a button to show them...
$(".comentuser").hide ().each ( function () {
    $(this).before ('<button class="gmShowHide"><< Show >></button>');
} );

//--- Activate the button(s).
$("button.gmShowHide").click ( function () {
    var jThis       = $(this);
    var Comments    = jThis.next ();
    Comments.toggle (); //-- Show or hide as necessary

    if (/Show/.test (jThis.text () ) )
        jThis.text ('>> Hide <<');
    else
        jThis.text ('<< Show >>');
} );

GM_addStyle ( (<><![CDATA[
    #divlegenda {
        margin:             0;
        padding:            0;
        position:           fixed;
        top:                0;
        right:              0;
        height:             100%
    }
    #divlegenda iframe {
        margin:             0;
        padding:            0;
        width:              598px;
        height:             100%
        border:             none;
    }
]]></>).toString () ); 
```

# php - 规范化序列化表

> ID：10609503
> 
> 赞同：0
> 
> 时间：2012-05-15T22:08:35.097
> 
> 标签：php, mysql, normalization

我有以下表格用于向公司的供应商发送有关产品的消息：

```
Table Messages:
INT PK  Message_ID 
TEXT    Message
INT FK  Company_ID
INT FK  Product_ID
DATE    Date
TEXT    Message_Receivers
TEXT    Email_Attachments
TINYINT Status

Table Email_addresses:
INT PK  Company_Email_ID
INT FK  Company_ID
VARCHAR Email_Name
VARCHAR Email_Address

Table Attachments:
INT PK  attachment_id
INT FK  image_id
INT FK  product_id
DATE    Upload_date
VARCHAR Category 
```

现在，如果一条消息被发送给多个接收者，并且如果它有多个附件，它们将被放入序列化的消息表中。我对这种方法不太熟悉，并且想对表格进行规范化，以便在一行上有一个接收者和一个附件，但我不知道该怎么做。

我的问题是，将其序列化有什么好处吗？作为一个新手，我不确定我是否错过了一个好处，如果规范化是关键，你能给我一个提示吗？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-05-15T23:57:25.253

恕我直言，标准化始终是第一个假设。序列化非常适合编程使用，但对于 MySQL 可能参与的任何事情都完全适得其反。我的一般方法是序列化诸如用户设置之类的东西，也许是一些事务历史记录，以及类似的东西——我知道的东西永远不会包含在 SQL 语句中。

虽然搜索响应时间是并且应该始终是重要的考虑因素，但许多人似乎忽略了数据库引擎是为搜索而设计的这一事实，因此只要您在数据库设计中遵循规范化规则，然后搜索意味着可搜索应该始终运行良好。

# php - 我可以使用来自 domain.com/user/Bob 等 URL 的值 Bob 吗？

> ID：10609504
> 
> 赞同：0
> 
> 时间：2012-05-15T22:08:42.150
> 
> 标签：php

我一直想知道如何使用 PHP 从网站的 URL 中获取值。我是 PHP 新手，所以请尽可能详细地解释：）

例如...我相信 YouTube 使用 $_GET['v'] 从 URL 获取视频 ID，然后找到具有该 ID 的记录并将信息回显到页面上。

```
http://www.youtube.com/watch?v=QWERTYUIOPA 
```

虽然，我很好奇的是如何从一个看起来很普通的 URL 中获取值，该 URL 基本上只是一个文件夹名称。

```
http://www.youtube.com/user/QWERTYUIOPA 
```

如何使用 PHP 从 URL 中获取值“QWERTYUIOPA”？

我在谷歌上搜索过这个，但我很难找到任何东西，因为我不知道要搜索什么。任何链接都会很棒。

谢谢！

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-05-15T22:26:48.430

像您所描述的那样“漂亮的 URL”只不过是一点点 .htaccess / mod_rewrite 诡计。

.htaccess 是服务器在每次页面请求时读取和评估的文件，而 mod_rewrite 是可以加载到服务器中的模块之一。

当用户请求一个页面时会发生什么，例如[http://www.youtube.com/user/QWERTYUIOPA](http://www.youtube.com/user/QWERTYUIOPA)，服务器接收到请求并读取 .htaccess 文件。

请求的 URL 与 .htaccess 文件中设置的规则匹配，并被 mod_rewrite 服务器模块拦截。mod_rewrite 然后以 PHP 期望的格式将 URL 传递给 PHP。

IE，对用户来说它看起来像

> [http://www.youtube.com/user/QWERTYUIOPA](http://www.youtube.com/user/QWERTYUIOPA)

但是 server / mod_rewrite 传递给 PHP 引擎的内容实际上看起来像

> [http://www.youtube.com/index.php?mode=user&v=QUERYTUIOPA](http://www.youtube.com/index.php?mode=user&v=QUERYTUIOPA)

这看起来像是对 mod_rewrite 的相对温和的介绍，因此您可以开始：[http ://www.yourhtmlsource.com/sitemanagement/urlrewriting.html](http://www.yourhtmlsource.com/sitemanagement/urlrewriting.html)

尼尔

# python - 如何在两个方向上实现对象属性

> ID：10609508
> 
> 赞同：2
> 
> 时间：2012-05-15T22:08:56.953
> 
> 标签：python, data-binding, properties

如果我将一个对象分配给另一个对象的属性，那么在给定第二个对象的情况下，获得第一个对象的自然方法是什么？我认为这有点像外键在数据库中的作用。

```
class Box(object):
    things = []

class Thing(object):
    box = None

thing = Thing()
box = Box()

# thing.box updates the box.things
thing.box = box
thing in box.things # should be true

# box.things updates thing.box
box.things.append(thing)
thing.box == box # should be true 
```

我还想通过一对一和多对多的关系来实现这一点。这可能吗？

此刻我一直保存着所有“东西”的全局集合，然后在“盒子”上提供一个属性，让属于什么的信息只在一个地方。然而，事物的集合是如此巨大，以至于我想将指向“事物”对象的指针放在“盒子”对象本身中。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-05-15T23:09:47.860

对于“事物”的情况，如果您只想跟踪一个对象，Python 的属性将为您提供开箱即用的功能。

至于许多“事物”的容器，单个属性将不起作用 - 因为您想跟踪指向对象属性的容器的更改（属性适用于属性本身的更改）。因此，一个小的自定义容器类对添加到容器的对象进行所需的更改是一种简单的方法。（我认为“集合”比列表更适合您）

```
class Thing(object):
    def get_box(self):
        return self._box
    def set_box(self, box):
        self._box = box
        if not self in box.things:
            box.things.add(self)
    box = property(get_box, set_box)

class CallbackSet(set):
    def __new__(cls, box, *args, **kw):
        self = set.__new__(cls, *args, **kw)
        self.box = box
    def add(self, item):
        item.box = self.box
        return set.add(self, item)

class Box(object):
    def __init__(self):
        self.things = CallbackSet(self) 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-05-16T22:50:15.430

这就是描述符的用途，如下所示：

```
class Box(object):

    things = []

class BoxManager(object):

    def __set__(self, instance, value):
        if isinstance(value, Box):
            instance._box = value
            Box.things.append(instance)

    def __get__(self, instance, type_=None):
        return instance._box

class Thing(object):
    box = BoxManager()

thing = Thing()
box = Box()

# thing.box updates the box.things
thing.box = box
print 'Thing is in box.things', thing in box.things  # should be true

# box.things updates thing.box
box.things.append(thing)
thing.box == box  # should be true
print 'thing.box == box is', thing.box == box

import pdb
pdb.set_trace() 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-05-15T22:26:46.777

您可能想要使用[python weakref](http://docs.python.org/library/weakref.html)。否则你最终会得到循环引用，这可能会导致垃圾收集器出现问题，也就是内存泄漏。

最重要的问题是，谁将持有对象的强引用（阻止它被垃圾收集的那个）。它是“世界”对象还是“盒子”对象？谁持有盒子对象？除此之外，所有其他人都会对其他人持有弱引用。[或者你可以通过它的python id()](http://docs.python.org/library/functions.html#id)来引用每个人，但是在使用 int 和字符串时要小心（如果你这样做`a=a+1` `id(a)`会改变）。在弱引用文档的末尾寻找想法。

要实现您想要的语法，请查看[emulating container types](http://docs.python.org/reference/datamodel.html#object.__len__)。

# c - 使用消息队列锁定与否

> ID：10609509
> 
> 赞同：0
> 
> 时间：2012-05-15T22:08:58.907
> 
> 标签：c, linux, message-queue

我正在尝试在 Linux 中使用消息队列，是否可以执行以下操作

进程 1 具有名为 1 的消息队列

生产者 1 和 2 向没有锁定机制的生产者发送消息，可以吗？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-05-15T22:33:10.717

Sys V 消息队列提供优先级，因此可以指定特定的队列接收者，并且可以获取“针对”它的消息。毫无争议。队列读取器也可以访问任何消息，具体取决于`msgrcv()`. POSIX 消息队列有点不同。通常，您可以使用 Sys V 队列，而不必担心锁定资源。Sys V 信号量队列和共享内存也有一些缺点。就像它们是内核持久的事实一样。

尝试`http://beej.us/guide/bgipc/`

# javascript - Javascript Url 参数解析

> ID：10609511
> 
> 赞同：3
> 
> 时间：2012-05-15T22:09:19.920
> 
> 标签：javascript, html, url

所以，我真的需要一些帮助。我进行了广泛的搜索，我发现的一些解决方案很棒，但对我不起作用，所以这里......

当有人访问我的网站时，他们会点击一个链接，该链接会将 URL 传递给“recipes.html”……例如，如果他们点击“Ancho Chile Sauce”，则 URL 将是：

blahblahblah.com/recipes.html?r=Ancho-Chile-Sauce

此参数实际上是文件夹“Recipes”中的 JPEG 名称，当然扩展名为“.jpg”

我需要将此参数放入一个字符串中，并在其前添加“Recipes/”并在其后添加“.jpg”，然后在我的 html 文档中更改图像标记的源以显示新的动态调用的配方图像。

我以为我已经做到了，但似乎没有任何效果。显然我的 Javascript 做错了什么，因为我的标记工作正常，并且带有参数的 url 正在被传递。

这是我的代码：

```
<!DOCTYPE html>
<html>
<head>
<title>Recipes</title>
<link href="mobi-styles.css" rel="stylesheet" />
<script type="text/javascript">
function getParam ( sname )
{
  var params = location.search.substr(location.search.indexOf("?")+1);
  var sval = "";
  params = params.split("&");
    // split param and value into individual pieces
    for (var i=0; i<params.length; i++)
       {
         temp = params[i].split("=");
         if ( [temp[0]] == sname ) { sval = temp[1]; }
       }
  return sval;
}
window.onload = changePic();
var param = getParam("r");
var recipeName = "Recipes/"+param+".jpg";
function changePic() {
document.getElementById("recipe").src=recipeName;
}
</script>
</head>

<body>
<img class"resizer" id="recipe" src="" />
</body>
</html> 
```

请帮忙！我爱你很久了！

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2012-05-15T22:16:41.923

删除`()`. 附加事件时，您*分配一个函数*，而不是函数调用的结果。您所做的是调用`changePic()`，返回`sval`并分配`sval`to的值`window.onload`- 这是错误的。

```
window.onload = changePic;
                         ^---remove () 
```

并`window.onload = changePic`在底部移动，这样 JSLint 就不会生气了。最好的做法是在使用函数之前先声明函数，即使有提升也是如此。

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2012-05-15T22:31:34.010

我写了一个小脚本，让我过去可以访问 url 参数，它可能非常有效。它在文件的开头运行，因此您可以随时访问它们。

```
GET = (function () {
    var get = {
        push:function (key,value){
            var cur = this[key];
            if (cur.isArray){
                this[key].push(value);
            }else {
                this[key] = [];
                this[key].push(cur);
                this[key].push(value);
            }
        }
    },
    search = document.location.search,
    decode = function (s,boo) {
        var a = decodeURIComponent(s.split("+").join(" "));
        return boo? a.replace(/\s+/g,''):a;
    };
    search.replace(/\??(?:([^=]+)=([^&]*)&?)/g, function (a,b,c) {
        if (get[decode(b,true)]){
            get.push(decode(b,true),decode(c));
        }else {
            get[decode(b,true)] = decode(c);
        }
    });
    return get;
})(); 
```

现在您可以访问所需的参数：

```
blahblahblah.com/recipes.html?r=Ancho-Chile-Sauce

GET['r']; // will print: Ancho-Chile-Sauce 
```

或者

```
GET.r; 
```

如果参数重复多次，则将其存储为数组；

```
example.com/test?name=John&name=Smith 
```

name 属性变成一个数组

```
GET.name[1] ; // Smith 
```

我希望这可以帮助你

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-05-15T22:13:32.760

改变这个：

```
if ( [temp[0]] == sname ) { sval = temp[1]; } 
```

对此：

```
if ( temp[0] == sname ) { sval = temp[1]; } 
```

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2012-05-15T22:13:33.470

这是我用来收集 URL 变量的方法：

**查询扩展**

```
$.extend({
  getUrlVars: function(){
    var vars = [], hash;
    var hashes = window.location.href.slice(window.location.href.indexOf('?') + 1).split('&');
    for(var i = 0; i < hashes.length; i++)
    {
      hash = hashes[i].split('=');
      vars.push(hash[0]);
      vars[hash[0]] = hash[1];
    }
    return vars;
  },
  getUrlVar: function(name){
    return $.getUrlVars()[name];
  }
}); 
```

**你可以像这样使用它：**

```
// blahblahblah.com/recipes.html?r=Ancho-Chile-Sauce

var r = $.getUrlVar('r');

alert(r); // outputs 'Ancho-Chile-Sauce'

function changePic() {
  $('#recipe').attr("src", r);
} 
```

* * *

如果**您不使用 Jquery**，则只有**Javascript**的解决方案是：

```
function getQueryVariable(variable)
{
  var query = window.location.search.substring(1);
  var vars = query.split("&");
  for (var i=0;i<vars.length;i++) {
    var pair = vars[i].split("=");
    if(pair[0] == variable){return pair[1];}
  }
  return(false);
} 
```

**并且可以这样使用：**

```
var r = getQueryVariable("r");

alert(r); // outputs 'Ancho-Chile-Sauce'

function changePic() {
  document.getElementById("recipe").src = r;
} 
```

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2018-02-07T12:52:06.060

```
parseURLparameters(string) {
    let parsed = {};
    (string.split('?')[1] || string).split('&')
                                    .map((item) => {
                                        return item.split('=');
                                    })
                                    .forEach((item) => {
                                        parsed[item[0]] = item[1];
                                    });
    return parsed;
} 
```

所以你可以传递任何字符串：

```
'?asd'
'?asd=123'
'asd=&kjnwer=13' 
```

等等...

# c# - PUT 请求导致 400 Bad Request

> ID：10609512
> 
> 赞同：3
> 
> 时间：2012-05-15T22:09:26.380
> 
> 标签：c#, asp.net-web-api, restsharp, http-status-code-400, dotnet-httpclient

我正在尝试使用 HttpClient 对 Web API 方法执行 PUT 请求。几乎相同的 POST 请求按预期工作，但 PUT 请求会导致 400（错误请求）错误。我不确定我做错了什么。

这是我的 Web API 控制器代码：

```
public HttpResponseMessage Post(object val)
{
    Debug.WriteLine(val.ToString());
    return new HttpResponseMessage(HttpStatusCode.OK);
}

public HttpResponseMessage Put(int id, object val)
{
    Debug.WriteLine(id.ToString(), val.ToString());
    return new HttpResponseMessage(HttpStatusCode.OK);
} 
```

然后是尝试调用这些方法的客户端代码。POST 请求如下所示：

```
var client = new HttpClient();
var content = log.ToJsonContent();
var address = new Uri(_webApiBaseAddress + "logs");

client.PostAsync(address, content).ContinueWith(requestTask =>
    {
        requestTask.Result.EnsureSuccessStatusCode();
    }); 
```

不起作用的 PUT 请求如下所示：

```
var client = new HttpClient();
var content = log.ToJsonContent();
var address = new Uri(_webApiBaseAddress + "logs/" + jobId);

client.PutAsync(address, content).ContinueWith(requestTask =>
    {
        requestTask.Result.EnsureSuccessStatusCode();
    }); 
```

正如你所看到的，我已经尽可能地精简了功能，但每次 PUT 请求时我仍然收到错误。

顺便说一句，我可以使用 RestSharp 客户端成功发出 PUT 请求。此代码成功调用 API 方法：

```
var client = new RestClient(_webApiBaseAddress);
var request = new RestRequest("logs/{id}", Method.PUT);
request.AddUrlSegment("id", jobId.ToString());
request.AddObject(log);
client.Execute(request); 
```

这样做的问题是，我使用 AddObject 传入的任何对象在到达控制器方法时都只是一个字符串。如果我传入一个 int，我想得到一个 int。HttpClient 使用 POST 方法执行此操作，所以我想使用它，但 PUT 会引发错误。因此，不幸的是，我坚持使用 2 个半工作的解决方案，它们并不能构成一个完整的解决方案。我将不胜感激任何一种模式的反馈，以使其发挥作用。

**编辑：** 因为它在下面提到，这是我的`.ToJsonContent()`扩展方法：

```
public static StringContent ToJsonContent(this object obj)
{
    var converter = new IsoDateTimeConverter();
    converter.DateTimeStyles = DateTimeStyles.AdjustToUniversal;
    var json = JsonConvert.SerializeObject(obj, converter);
    var content = new StringContent(json, Encoding.UTF8, "application/json");
    return content;
} 
```

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-05-17T20:24:32.073

是`ToJsonContent`你写的功能吗？如果是这样，可能值得一看，以确保您提供了正确的 Content-Type 并生成了正确的 JSON 格式。要消除 JSON 成为问题，您可以进行如下测试：

```
var client = new HttpClient();
var content = new StringContent(
    @"{""message"": ""this is a log message"" }",
    Encoding.UTF8,
    "application/json");

var address = new Uri(_webApiBaseAddress + "logs/" + jobId);

client.PutAsync(address, content).ContinueWith(task =>
{
    task.Result.EnsureSuccessStatusCode();
}); 
```

Noice 我`application/json`作为参数提供。我知道如果 Web API 不知道您的请求是什么媒体类型，它会做一些疯狂的事情。您的 RestClient 测试*确实*有效的事实让我认为您发送的 JSON 无效。

可能对您有所帮助的第二部分是，如果您在诸如控制台应用程序之类的东西中对此进行测试，该应用程序可能会在异步调用真正被初始化和发送之前关闭，您将不会得到您的响应。`.Wait()`您可以通过在您的后面加上一个来测试这一点，`ContinueWith`但我怀疑如果您实际上得到 400 响应，情况并非如此。

# cakephp - 无法在 Cakephp 中编写查看和编辑操作

> ID：10609514
> 
> 赞同：0
> 
> 时间：2012-05-15T22:09:36.877
> 
> 标签：cakephp

四种模式餐厅、餐厅地址、餐厅美食和美食。

我可以通过页面 View/Restaurants/index.ctp 显示所有餐馆、地址和他们的美食类型

但是，我无法对视图和编辑操作进行编码，以下是我用于这两个操作的代码：

编辑操作（代码）：

编辑工作，但它在 Restaurant_Addresses 和 Cucines 表中添加了两个条目。

公共功能编辑（$id = null）{ $this->餐厅->id = $id;

```
 $this->loadModel('Cusine');
            $model_cusine_edit_data = $this->Cusine->find('list');
            $this->set('CusineEditList', $model_cusine_edit_data);

    if (!$this->Restaurant->exists()) {
        throw new NotFoundException('Invalid Restaurant');
    }

    if ($this->request->is('post') || $this->request->is('put')) {              

        $this->Restaurant->save($this->request->data);

            $this->Session->setFlash('The restaurant has been saved');
            $this->redirect(array('action' => 'index'));
        } else {
    $this->request->data = $this->Restaurant->read();
    }
} 
```

查看操作（代码）：

以下代码仅显示餐厅。姓名信息，看不到街道和邮政编码。

公共函数视图（$id = null）{ $this->Restaurant->id = $id;

```
 if (!$this->Restaurant->exists()) {
        throw new NotFoundException('Invalid user');
    }

    if (!$id) {
        $this->Session->setFlash('Invalid user');
        $this->redirect(array('action' => 'index'));
    }
    $this->set('restaurant', $this->Restaurant->Read());

} 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-05-15T22:41:58.950

这是我将如何编写您的方法的方法。我认为您关于未显示数据的主要问题是 read 方法仅获取第一个模型数据并且没有获取关联数据......所以我会做一个 Model::find()，而不是 Model： :read() 使用包含参数来获取相关数据。

不要忘记在模型 $actsAs 参数中添加“可包含”。

```
public function edit($id=null){
    $this->Restaurant->id = $id;
    if (!$this->Restaurant->exists()) {
        throw new NotFoundException('Invalid Restaurant');
    }

     if(!empty($this->request->data)){
          if($this->Restaurant->save($this->request->data)){
              $this->Session->setFlash('The restaurant has been saved');
              $this->redirect(array('action' => 'index'));
          } else {
              $this->Session->setFlash('Unable to save the restaurant');
          }
     }

     $model_cusine_edit_data = $this->Restaurant->RestaurantCusine->Cusine->find('list');
     $this->set('CusineEditList', $model_cusine_edit_data);

     $this->request->data = $this->Restaurant->find('first', array('conditions'=>array('Restaurant.id'=>$id), 'contain'=>array('RestaurantAddresses','RestaurantCusine')));
}

public function view($id=null){
    $this->Restaurant->id = $id;

    if (!$this->Restaurant->exists()) {
        throw new NotFoundException('Invalid user');
    }

    if (!$id) {
        $this->Session->setFlash('Invalid user');
        $this->redirect(array('action' => 'index'));
    }

    $this->set('restaurant', $this->Restaurant->find('first', array('conditions'=>array('Restaurant.id'=>$id), 'contain'=>array('RestaurantAddresses','RestaurantCusine'))));
} 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-05-15T22:26:54.020

对于视图，您需要做一个`find('first', array('conditions' => array('Restaurant.id' => $id), 'recursive' => 2));`或者更好的方法，使用`ContainableBehavior`which 可以让您准确选择要获取的模型。在书中搜索用法和示例。

至于编辑，提供一个链接到帖子数据的样子。

# jquery - 使用选项选择触发没有按钮的jquery

> ID：10609524
> 
> 赞同：2
> 
> 时间：2012-05-15T22:10:53.533
> 
> 标签：jquery

假设我有一个下拉菜单...

```
<select id="menu">
   <option value="1">One</option>
   <option value="2">Two</option>
   <option value="3">Three</option>
</select> 
```

当我选择该选项（不单击按钮）时，我希望它触发一个 jQuery 函数。在不单击按钮（仅在选择时）的情况下，我将如何从选项选择中执行此操作？我想我需要先在菜单 id 上调用 jQuery 来执行此操作，但不知道从哪里开始。谢谢。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-05-15T22:13:23.910

### 描述

您应该使用 jQuery`change`事件。

### 样本

```
​$("#menu").change(function() {
    alert("fire your function");
});​​​​​ 
```

### 看看这个[jsFiddle 演示](http://jsfiddle.net/UHmSk/)

### 更多信息

*   [jQuery - 改变（）](http://api.jquery.com/change/)

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-05-15T22:13:19.740

`change`当您从 中选择某些内容时应该触发该事件，`select`并且您可以使用[`.change()`](http://api.jquery.com/change/).

```
$('#menu').change(function () {
    //your code
}); 
```

我建议你彻底研究[jQuery 手册。](http://docs.jquery.com/Main_Page)

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-05-15T22:15:11.987

试试这个：

```
$("#menu").change(function() {
    alert($(this).val());
}); 
```

# jquery - 使用 json、jquery 和 rails 从标签下拉列表中添加计数功能

> ID：10609529
> 
> 赞同：0
> 
> 时间：2012-05-15T22:11:19.530
> 
> 标签：jquery, ruby-on-rails, json, jquery-tokeninput

我使用 jquery tokeninput 跟随 railscasts

[http://railscasts.com/episodes/258-token-fields-revised](http://railscasts.com/episodes/258-token-fields-revised)

在创建自动完成标记令牌并已成功完成此操作。但是，我一直在尝试添加一个计数属性，非常类似于堆栈溢出标签计数器。

我的标签中有#index

```
 @tags = Tag.order(:name)
    #@tags = Tag.order(:name).where("name like ?", "%#{params[:term]}%")
    respond_to do |format|
        format.html
        format.json { render json: @tags.tokens(params[:q]) }
    end 
```

当我渲染时，它会调用我的令牌方法，它是......

```
 def self.tokens(query)
    tags = where("name like ?", "%#{query}%")
    if tags.empty?
        [{id: "<<<#{query}>>>", name: "New: \"#{query}\""}]
    else
        puts tags.inspect
        tags
    end
  end 
```

如果我输入“steelswarm”这个词并检查返回的标签，在我的控制台上它会说......

```
[#<Tag id: 4, name: "steelswarm", created_at: "2012-05-11 01:49:55", updated_at: "2012-05-11 01:49:55", count: 2>] 
```

当用户开始输入单词“steelswarm”时，我希望下拉菜单显示“steelswarm x 2”，因为它的计数为 2。

我试过做

```
tags.map{ |tag| {:label => "#{tag.name} x #{tag.count}", :value => tag.name} } 
```

在我的 else 语句中，但下拉菜单停止渲染。它甚至找不到第一个字母了。我究竟做错了什么？

:label 和 :value 属性不属于整个 jquery 吗？

我也一直在寻找选项

[http://loopj.com/jquery-tokeninput/](http://loopj.com/jquery-tokeninput/)

但我似乎找不到有用的东西，或者至少我能想到......对不起，我对 json 和 jquery 不是很熟悉，所以非常感谢您的帮助 =）

谢谢你。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-05-21T19:52:26.350

我修好了它。似乎令牌只有一个 :id 和 :name 属性。所以我做了..

```
tags.map{ |tag| {  id: "#{tag.id}", name: "#{tag.name} # #{tag.count}" } } 
```

# html - 将 div 的高度指定为容器的 100% 减去同级 div 的高度

> ID：10609531
> 
> 赞同：2
> 
> 时间：2012-05-15T22:11:28.010
> 
> 标签：html, css

我在以下布局中有一个 div

```
<html style="height:100%">
<body style="height:100%">
    <div id="divBody" style="height:100%;width:1000px">
        <div id="divHeader" style="height:30px"></div>
        <div id="divContent" style="height:100%">
            <div id="divLeft" style="height:100%; float:left; width:200px; border-left:1px solid black"></div>
            <div id="divRight" style="width:800px"></div>
        </div>
    <div>
</body>
</html> 
```

我的问题是 divContent 如何具有身体 100% 的高度。我需要它做的是占据整个 divBody 的高度减去 divHeader 的高度。所以我将 divContent 的高度设置为自动：

```
<html style="height:100%">
<body style="height:100%">
    <div id="divBody" style="height:100%;width:1000px">
        <div id="divHeader" style="height:30px"></div>
        <div id="divContent" style="height:auto">
            <div id="divLeft" style="height:100%; float:left; width:200px; border-left:1px solid black"></div>
            <div id="divRight" style="width:800px"></div>
        </div>
    <div>
</body>
</html> 
```

现在 divContent 的高度是正确的，它是 divBody 的 100% 减去 divHeader 的高度，但现在 divLeft 的高度并没有填满它的父级（divContent）的 100%。我怎样才能在这里两全其美？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-05-15T22:23:07.110

您应该继续使用百分比，而不是使用固定数量的像素作为标题。header 和 content 的宽度应该是 100%，但是高度是“auto”，所以它实际上会根据你使用的 body div 中的实际需要进行调整。

关于左右 div，我猜两者都应该设置为高度 100%

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2020-02-25T13:09:35.907

既然您知道 的高度`#divHeader`是 30px，那么您的问题的简单答案就是这样`calc()`使用`#divContent`：

```
#divContent {
  height: calc(100% - 30px);
} 
```

困难的部分是设置兄弟姐妹`#divContent`的高度，例如当其他兄弟姐妹的高度未知或动态时。这时候[CSS Flex](https://www.w3schools.com/css/css3_flexbox.asp)就派上用场了：

```
.flex {
  display: flex;
  flex-direction: column;
  height: 100vh;
}

.top {
  flex-shrink: 0;
}

.bottom {
  height: 100%;
} 
```

具有类的元素`bottom`将使用 100% 高度减去其兄弟元素的高度。这条`flex-shrink: 0`规则很重要，主要是针对 iOS 设备，以避免缩小同级设备。

[Codepen 的工作示例在这里](https://codepen.io/calsal/pen/bGdgyBX)。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-05-15T22:40:02.523

如果您只关心两列的高度和固定的标题高度，那么有一个 CSS hack 可以帮助您实现这一目标。

考虑这个 HTML：

```
<html style="height:100%">
<body style="height:100%">
    <div id="divBody">
        <div id="divHeader">Header</div>
        <div id="divContent">
            <div id="divLeft">Left</div>
            <div id="divRight">Right</div>
        </div>
    </div>
</body>
</html>​ 
```

以及以下 CSS：

```
#divBody {
    height: 100%;
    width: 1000px;
    overflow: hidden;
}

#divHeader {
    height:30px;
    background-color: Yellow;
}

#divContent {
    height:auto;
    background-color: Aqua;
    position: relative;
}

#divLeft {        
    height:100%;
    float:left;
    width:200px;
    border-left:1px solid black;
    background-color: Azure;

    padding-bottom: 30000px;
    margin-bottom: -30000px;
}

#divRight {
    height: 100%;
    width:800px;
    background-color: Pink;

    padding-bottom: 30000px;
    margin-bottom: -30000px;
} 
```

这是带有插图的 JSFiddle：http: [//jsfiddle.net/3rDNC/](http://jsfiddle.net/3rDNC/)

```
​ 
```

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2017-09-12T15:56:24.517

这是一个老问题，但这是我使用 calc(100% - 30px) 减去标题大小的两分钱：

```
#divContent {
    height: calc(100% - 30px);
    background-color: Aqua;
    position: relative;
} 
```

# sql-server-2008 - asp.net(c#) 使用按钮单击将用户数据从一个表复制到另一个表

> ID：10609533
> 
> 赞同：0
> 
> 时间：2012-05-15T22:11:35.797
> 
> 标签：sql-server-2008

我想将数据从 detailsview(tableName=Jobs) 复制到另一个表(tablename=Company) 但它显示错误，例如 Incorrect syntax near ')' 我的代码如下：

```
 string apply = "INSERT INTO Company (JobTitle,CompanyName) select JobTitle,CompanyName from Jobs)"; 
```

我正在使用 asp.net

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-05-15T22:16:06.983

你应该使用它，最后删除`)`

```
 string apply = "INSERT INTO dbo.Company (JobTitle) select JobTitle from Jobs"; 
```

**更新** 根据更新的问题。

```
string apply = "INSERT INTO Company (JobTitle,CompanyName) select JobTitle,CompanyName from Jobs"; 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-05-15T22:17:17.243

```
string apply = "INSERT INTO dbo.Company (JobTitle) select JobTitle from Jobs)"; 
```

我不想指出明显的，但最后你有一个额外的')'。:)

# usb - 重新发明鼠标完整性检查

> ID：10609536
> 
> 赞同：4
> 
> 时间：2012-05-15T22:11:50.240
> 
> 标签：usb, mouse, fpga, intel-fpga

我本质上是在创造一种新的方式来控制屏幕上的光标。现在我有一个 Altera Stratix iv FPGA，我希望它通过 USB 向计算机发送信息并控制光标。

这是可行的，有没有人知道类似的事情？这最终会是什么样子？我意识到我可能必须在机器上编写一些代码来侦听端口并移动鼠标，我对此很好，但是是否可以使用位于 FPGA 上的代码来移动鼠标？

谢谢！

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-05-15T22:13:33.363

您可能想要实现一个[USB HID 类](https://en.wikipedia.org/wiki/USB_human_interface_device_class)设备。HID 类是最简单的 USB 类之一，大多数 USB 套件都带有一个示例 HID 设备。好处是您的操作系统已经知道如何与 HID 设备通信，因此您无需编写任何操作系统驱动程序。

# html - 指定电子邮件回复的报价级别

> ID：10609539
> 
> 赞同：1
> 
> 时间：2012-05-15T22:12:20.370
> 
> 标签：html, email, formatting

格式化电子邮件的标准（甚至有标准）或约定是什么？具体来说，我如何以电子邮件客户理解的方式指定报价水平？

只是深入研究了几封电子邮件，我注意到苹果邮件似乎在引用的段落前面加上 a `>`，这是标准吗？

如果我要发送 html 电子邮件，我也会这样做吗？

干杯

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-05-15T22:38:08.223

维基百科有一篇关于这个的[好文章](http://en.wikipedia.org/wiki/Posting_style)。使用“>”前缀表示引用级别可能是安全的 - 它有很长的历史，我想大多数（也许所有）电子邮件客户都会正确解释它。

如果您要发送 HTML 电子邮件，您几乎可以做任何您喜欢的事情，但您无法控制收件人是否会以 HTML 格式查看您的电子邮件，或者更喜欢查看纯文本版本（或者更糟 - 他们看到原始HTML）。我建议保持简单。

# sql-server-2008 - 如何上传条码数据和秤数据

> ID：10609543
> 
> 赞同：1
> 
> 时间：2012-05-15T22:13:18.557
> 
> 标签：sql-server-2008, ms-access, upload, barcode, barcode-scanner

所以，我正在构建一个简单的库存系统。该信息将存储在远程 SQL Server 2005 数据库中。在我正在处理的项目的当前部分，我需要扫描条形码（其中包含两条数据，员工 ID 和产品 ID）。我们将使用 MC9090-G 扫描仪。在扫描它的同时，它会坐在秤上。我需要将这三个数据保存在一起，并将它们上传到数据库。

首先，我需要弄清楚如何收集数据。其次，我需要找出编写客户端应用程序的最佳平台。这些将相当简单，例如插入上述数据。我不确定是否应该使用 ACCESS 2010 前端，或者用其他东西编写前端。

很抱歉，如果这个问题显得含糊不清，请向我询问更多详细信息。谢谢大家的帮助，我真的迷路了。

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-05-18T04:14:05.037

这是您[上一个问题](https://stackoverflow.com/questions/10524579/mc9090-g-barcode-scanner-with-sql-server-front-end)的副本。您不必重新创建一个新问题以使其再次可见：只需使用更多数据编辑您的原始问题，它就会再次出现在顶部。

当时没有人能够回答，因为这太模糊了。对于这些类型的系统，工人的实际工作方式是解决方案的驱动力：您需要简化他们的行动，以便它们自然流动，并且不需要比严格必要的更多的动作、确认和处理。

所以，让我们尝试一下。

## 假设

因为我对你的环境、设备和流程了解不够，所以我对这个问题做一些假设：

*   一台计算机安装在秤附近用于数据输入。

*   条码扫描器和秤都连接到计算机

*   条形码阅读器的行为类似于 HID 设备（就像在键盘上输入的一样）

*   条码阅读器配置为在每次扫描后添加一个 CR（回车）后缀（所有阅读器都具有这种类型的配置）。

*   员工条形码印在（上方或下方）产品 ID 上，即贴在鱼上的标签。
    员工 ID 条形码的格式为：`@123456`其中 123456 是员工 ID。
    前缀允许系统检测扫描的`@`条形码是员工 ID。
    使用[Code128](http://en.wikipedia.org/wiki/Code_128)或类似代码打印字母数字字符串。

*   假设鱼条形码标签位于鱼身上或印在卡片上。
    鱼条码标签可以是任何东西，但不能以 . 开头`@`。

*   我们假设秤有一个界面。由于您没有提及您使用哪一个或如何从 PC 中检索数据，因此我们必须假设秤提供了一个 SDK，或者可以让您读取当前重量的东西。
    让我们调用该函数`ReadScale()`并假设它返回一个带有重量的浮点数，无论测量对您的任务有意义。

## 工作进程

在这里，我们再次做出一些假设。根据您的确切设置以及物理执行的操作流程，情况可能会有很大不同，在这种情况下，您的软件可能也需要表现不同。

我假设权重和数据输入是最终操作：到那时标签已经贴在鱼/产品上。

可能的过程：

*   工作者在计算机和标度的前面

*   工人把鱼放在秤上

*   工人等待读数稳定

*   工作人员扫描放置在鱼身上的标签上的 2 个条形码。

或者：

*   工作人员扫描放置在鱼身上的标签上的 2 个条形码。

*   工人把鱼放在秤上

*   工人等待读数稳定

*   工作人员在键盘上键入 ENTER 键或扫描一个特殊的 OK 条形码，告诉软件该过程已完成。

第一种选择需要较少的操作，但它要求标签在产品在秤上时可见以便扫描。这可能是真的，也可能不是。

## 软件解决方案

有一千种不同的方法可以实现您想要的，但既然您提到了 Access，我们将假设您对此感到满意。
此外，它提供了一种很好的方法来制作解决方案原型，因为它很容易更新 Access 应用程序。

我假设 SQL Server 数据库与将托管 Access 应用程序的数据输入计算机位于同一 LAN 上。
如果不是这种情况，或者如果您必须使用 Wifi，那么连接到数据库和保存数据的方式会有所不同（并且可能会更复杂一些）。

### 数据流

当员工扫描条形码时，应用程序将收到一串键，就好像员工实际在键盘上键入一样：

例如，假设用户扫描员工 ID，然后扫描产品 ID。计算机将收到以下数据流，就好像它来自键盘一样：

```
@443678¶
876657098¶ 
```

该`¶`符号仅代表条形码扫描仪添加的 CR 代码后缀（与 ENTER 键相同的代码）。

### SQL Server 数据库

我假设您在 SQL Server`ProductLog`的数据库中有一个表。`Fishery`该`ProductLog`表将仅记录每种鱼/产品的数据集：

```
ID          : Auto-increment ID (IDENTITY), to identify each record uniquely
EmployeeID  : Stores the Employee ID (INT/CHAR) 
ProductID   : stores the Product ID (INT/CHAR)
Weight      : Store the measured weight (FLOAT)
TimeStamp   : records the operation's exact date and time (DATETIME). 
```

现在[将`ProductLog`表链接到您的 Access 应用程序前端](http://office.microsoft.com/en-us/access-help/import-or-link-to-sql-server-data-HA010200494.aspx#BM2)。
然后我们就可以像使用本地 Access 表一样使用它。

### 数据输入表

让我们不要去做最基本的事情：创建一个空白表单并为其添加 3 个大标签，您将调用它们`labelEmployeeID`：`labelProductID`和`labelWeight`.

编辑表单的属性，使其变为模态并停留在应用程序的前面，除其他外：

```
Default View    : Single Form
Record Selector : No
Pop up          : yes
Modal           : yes
key Preview     : Yes  (on the Events page) 
```

![表格设计](../Images/bed52e033884692a804fcd7cc049b1e4.png)

打开 VBA IDE 以编辑表单的代码并添加以下内容：

```
Option Compare Database
Option Explicit

' The SQL Server Connection String. Update to match your database '
Const SQLSERVERCONSTR As String = "ODBC;DRIVER=SQL Server;SERVER=MYSERVER;DATABASE=Fishery;Trusted_Connection=Yes;"

' Just clear the labels on the screen when we open the form '
Private Sub Form_Load()
    labelEmployeeID.Caption = "-"
    LabelProductID.Caption = "-"
    labelWeight.Caption = "-"
End Sub

' Most of the processing is done here: the barcode scanner will act   '
' as if the scanned code was typed on the keyboard.                   '
' We trap each keystroke and use a basic state machine to reconstruct '
' each barcode and process them once they have been received          '
Private Sub Form_KeyPress(KeyAscii As Integer)
    ' Status = 0 : Waiting for any barcode input        '
    ' Status = 1 : Currently reading EmployeeID barcode '
    ' Status = 2 : Currently reading ProductID barcode  '
    ' Status = 3 : All barcode data read                '
    Static Status As Integer
    ' Keep track of our barcodes '
    Static EmployeeID As String
    Static ProductID As String

    ' All barcodes entered, but not processed yet, do not accept more entry '
    If Status = 3 Then Exit Sub

    ' We received a CR, check if we have both barcodes and complete '
    If KeyAscii = vbKeyReturn Then
        Dim employeeCodeReceived As Boolean
        Dim productCodeReceived As Boolean
        employeeCodeReceived = (EmployeeID <> vbNullString)
        productCodeReceived = (ProductID <> vbNullString)

        ' Update UI to reflect the completed code we scanned '
        If employeeCodeReceived Then
            labelEmployeeID.Caption = "Employee : " & EmployeeID
        Else
            labelEmployeeID.Caption = "-"
        End If

        If productCodeReceived Then
            LabelProductID.Caption = "Product  : " & ProductID
        Else
            LabelProductID.Caption = "-"
        End If

        labelWeight.Caption = "-"

        ' If both have been received, complete the transaction '
        If employeeCodeReceived And productCodeReceived Then
            Status = 3
            ' Get the weight from the scales '
            Dim weight As Double
            weight = ReadScale()
            ' Display the weight '
            labelWeight.Caption = "Weight   : " & Format(weight, "0.000") & " kg"
            ' Save to log '
            Save EmployeeID, ProductID, weight
            ' Reset barcode data '
            EmployeeID = vbNullString
            ProductID = vbNullString
        End If
        Status = 0
        Exit Sub
    End If

    Dim c As String
    c = Chr(KeyAscii)

    ' We're starting a barcode '
    If Status = 0 Then
        If c = "@" Then
            Status = 1
            EmployeeID = vbNullString
            Exit Sub ' Skip the @ prefix '
        Else
            Status = 2
            ProductID = vbNullString
        End If
    End If

    If Status = 1 Then
        EmployeeID = EmployeeID & c
    ElseIf Status = 2 Then
        ProductID = ProductID & c
    End If
End Sub

Private Sub Save(ByVal EmployeeID As String, ByVal ProductID As String, ByVal weight As Double)
    ' We use ADO and late binding to avoid requiring a library reference '
    Dim rs As Object
    Set rs = CreateObject("ADODB.Recordset")

    ' Open using options adOpenDynamic(2) and adLockOptimistic(3) '
    rs.Open "ProductLog", SQLSERVERCONSTR, 2, 3
    ' Add a new record and close '
    With rs
        .AddNew
        !EmployeeID = EmployeeID
        !ProductID = ProductID
        !weight = weight
        !timestamp = Now()
        .Update
        .Close
    End With
    Set rs = Nothing

End Sub

' Magic function to be replaced by whatever you need to do to read the scale '
Private Function ReadScale() As Double
    Randomize
    ReadScale = Rnd() * 2
End Function 
```

所有这一切当然是一个特别简单的实现，它基于可能与您的特定情况匹配或不匹配的简单假设。
没有错误处理，甚至不是很好的代码，但它可以帮助您将一些东西放在一起并开始使用。

### 利用

要尝试模拟数据输入过程，只需打开表单并使用键盘。
例如，输入以下内容（先输入 ProductID*然后*EmployeeID 也可以）：

```
@TIMOTHY¶
987654¶ 
```

将出现此屏幕，并自动记录数据：

![在此处输入图像描述](../Images/e8d63c1ec578c7e601ef1861d98e5b23.png)

## 样本数据库

我已经公开了一个示例数据库，其中显示了正在运行的代码。
它将数据保存到自己的演示中。
[下载它](http://dl.dropbox.com/u/52900980/StackOverflow/SO10609543.accdb)。

## 结论

同样，构建这些仓库数据输入应用程序时的主要问题是将数据输入建模为实际的流线型物理过程。
如果您不考虑用户的实际环境和实践，您的解决方案可能会适得其反，需要工人付出更多努力，并使他的工作变得尴尬而不是高效。

# java - 从 html 源中提取信息？

> ID：10609545
> 
> 赞同：0
> 
> 时间：2012-05-15T22:13:20.100
> 
> 标签：java, android, regex, web-scraping

如何使用网站中包含的特定信息？现在，我正在获取`InputStream`整个网站的信息。然后，尝试使用 RegEx 提取有用的信息。

现在有人告诉我，从 HTML 中提取 RegEx 真的很糟糕。Android还有什么？

如何使用和提取网站的特定部分？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-05-15T22:16:37.787

我推荐你使用[JSoup 库](http://jsoup.org/)。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-05-15T22:18:22.420

您好，有很多情况需要从 XML 中解析和提取元素：

*   DOM 解析
*   [SAX 解析](http://developer.android.com/reference/javax/xml/parsers/SAXParser.html)
*   XML 拉解析器

还有一个不错的简单库，叫做[jsoup](http://jsoup.org/)

# regex - Perl 匹配特殊字符

> ID：10609547
> 
> 赞同：1
> 
> 时间：2012-05-15T22:13:28.637
> 
> 标签：regex, perl, special-characters

我正在尝试做一个简单的匹配，例如：

```
if ($variable ne '*') { print "Hello"; } 
```

我想匹配不等于“*”字符的所有内容（无引号）

但我不确定是否需要在 * 之前使用反斜杠，或者是否应该使用我看到的其他解决方案的正斜杠正则表达式表示法。这里最好的解决方案是什么？

这是一个示例代码：

```
if ($var ne '*') { print "it is not a star!"; }
else 
{ 
    $var = '*';
    print "made $var into a star!"
} 
```

将变量设置为 * 字符是否正确？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-05-15T22:24:31.463

如果您使用正则表达式匹配，您只需要转义“*”字符，但由于您使用的是直接比较（与`ne`），那么您的代码就可以了。如果您使用的*是*正则表达式，那么您会说：

```
if ($variable !~ /^\*$/) { ... } 
```

但在这种情况下`ne`，我想使用起来会更清晰、更快捷。

为了完整起见，您还可以`\Q`在正则表达式中使用引用所有元字符，直到`\E`遇到 a。所以：

```
if ($variable !~ /^\Q***\E$/ { ... } 
```

如果`$variable`不等于三个 '*' 字符，则计算结果为 true。但同样，你会更好：

```
if ($variable ne '***') { ... } 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-05-15T22:26:23.407

不确定您是否正在寻找正则表达式。

```
if ($variable !~ /\*/) { print "Hello"; } 
```

# php - PHP - 使用内置函数编写自己的函数 VS

> ID：10609552
> 
> 赞同：3
> 
> 时间：2012-05-15T22:13:40.973
> 
> 标签：php, function, built-in

使用“box”函数有什么好处，例如`array_map`，而不是编写自己的循环（当您知道“box”函数不能以您自己的函数之外的任何其他方式编写时？

`callback`（为什么？有时当函数是自定义函数时它更具可读性）

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2012-05-15T22:16:20.010

与 PHP 中的相同实现相比，内置函数总是更快。内置函数将在 C 中执行，而 PHP 函数将被解释为 C - 然后执行。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-05-15T22:16:13.640

有时这完全与性能有关，因为与 php 相比，这些函数可能是用 C 语言编写的，低级...

虽然这不是系统的。

# installation - 如果不满足条件，则停止前进到下一页

> ID：10609555
> 
> 赞同：3
> 
> 时间：2012-05-15T22:13:43.987
> 
> 标签：installation, nsis

**如何阻止 NSIS 自定义页面前进到下一页？**

我有一个自定义页面，用户可以在其中决定他们可以为哪个版本的应用程序安装我们的插件 - 因此有 3 个复选框可供选择。

用户必须选择至少 1 个版本来安装我们的插件，否则安装程序将无法安装任何内容。

因此，当用户单击下一步时，我需要检查是否选中了 1 个或多个复选框，如果没有，则禁用下一步并显示 MessageBox。

**如果我不能停止前进到下一页，我可以禁用下一个按钮吗？**

```
Page Custom CustomPageInitialise CustomPageFinalise
Function CustomPageFinalise
    Var /GLOBAL versToInstall
    ${NSD_GetState} $hasVersion8ChkBx  $0
    ${NSD_GetState} $hasVersion9ChkBx  $1
    ${NSD_GetState} $hasVersion10ChkBx $2
    IntOp $versToInstall $0 + $1
    IntOp $versToInstall $versToInstall + $2

    # TODO: stop advance to NEXT page if no versions selected to install
    # If no versions selected to install
    ${If} $versToInstall <= 0
        MessageBox MB_ICONEXCLAMATION|MB_OK "You must select at least one version of the Application to install our plugins to."
        # how do I stop the advance to the next page?
    ${EndIf}
FunctionEnd 
```

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-05-15T22:34:59.343

使用`Abort`命令。

[NSIS 手册，第 4 章，*脚本参考*，第 5 节，*页面*，第 3 小节，*回调*](http://nsis.sourceforge.net/Docs/Chapter4.html#4.5.3)：

> leave-function 允许您使用[Abort](http://nsis.sourceforge.net/Docs/Chapter4.html#4.9.4.1)强制用户停留在当前页面上。

# testing - JUnit 自己的示例测试失败了？

> ID：10609556
> 
> 赞同：3
> 
> 时间：2012-05-15T22:13:44.467
> 
> 标签：testing, junit, sample

我刚刚下载了junit-4.10.jar。根据[JUnit FAQ](http://junit.sourceforge.net/doc/faq/faq.htm#started_2)，您所要做的就是将 jar 文件解压缩到一个目录中，然后将 jar 文件放在您的类路径中，然后就可以安装了。然后，您可以通过使用以下命令运行示例测试来测试安装：

```
java org.junit.runner.JUnitCore org.junit.tests.AllTests 
```

不过，FAQ 肯定是过时的，因为 AllTests 不驻留在 org.junit.tests 中，它驻留在 org.junit.runners 中。这就是我尝试使用 org.junit.tests 包中的 AllTests 运行示例测试时得到的结果。有人知道为什么样本测试失败了吗？是的，我检查了我的 CLASSPATH 并且 junit-4.10.jar 在那里。

```
C:\Users\username\Downloads\junit4.10-extracted>java org.junit.runner.JUnitCore org.junit.runners.AllTests
JUnit version 4.10
.E.E
Time: 0.003
There were 2 failures:
1) initializationError(org.junit.runners.AllTests)
java.lang.Exception: Test class should have exactly one public zero-argument constructor
    at org.junit.runners.BlockJUnit4ClassRunner.validateZeroArgConstructor(BlockJUnit4ClassRunner.java:144)
    at org.junit.runners.BlockJUnit4ClassRunner.validateConstructor(BlockJUnit4ClassRunner.java:121)
    at org.junit.runners.BlockJUnit4ClassRunner.collectInitializationErrors(BlockJUnit4ClassRunner.java:101)
    at org.junit.runners.ParentRunner.validate(ParentRunner.java:344)
    at org.junit.runners.ParentRunner.<init>(ParentRunner.java:74)
    at org.junit.runners.BlockJUnit4ClassRunner.<init>(BlockJUnit4ClassRunner.java:55)
    at org.junit.internal.builders.JUnit4Builder.runnerForClass(JUnit4Builder.java:13)
    at org.junit.runners.model.RunnerBuilder.safeRunnerForClass(RunnerBuilder.java:57)
    at org.junit.internal.builders.AllDefaultPossibilitiesBuilder.runnerForClass(AllDefaultPossibilitiesBuilder.java:29)
    at org.junit.runner.Computer.getRunner(Computer.java:38)
    at org.junit.runner.Computer$1.runnerForClass(Computer.java:29)
    at org.junit.runners.model.RunnerBuilder.safeRunnerForClass(RunnerBuilder.java:57)
    at org.junit.runners.model.RunnerBuilder.runners(RunnerBuilder.java:98)
    at org.junit.runners.model.RunnerBuilder.runners(RunnerBuilder.java:84)
    at org.junit.runners.Suite.<init>(Suite.java:79)
    at org.junit.runner.Computer.getSuite(Computer.java:26)
    at org.junit.runner.Request.classes(Request.java:69)
    at org.junit.runner.JUnitCore.run(JUnitCore.java:117)
    at org.junit.runner.JUnitCore.runMain(JUnitCore.java:98)
    at org.junit.runner.JUnitCore.runMainAndExit(JUnitCore.java:53)
    at org.junit.runner.JUnitCore.main(JUnitCore.java:45)
2) initializationError(org.junit.runners.AllTests)
java.lang.Exception: No runnable methods
    at org.junit.runners.BlockJUnit4ClassRunner.validateInstanceMethods(BlockJUnit4ClassRunner.java:166)
    at org.junit.runners.BlockJUnit4ClassRunner.collectInitializationErrors(BlockJUnit4ClassRunner.java:102)
    at org.junit.runners.ParentRunner.validate(ParentRunner.java:344)
    at org.junit.runners.ParentRunner.<init>(ParentRunner.java:74)
    at org.junit.runners.BlockJUnit4ClassRunner.<init>(BlockJUnit4ClassRunner.java:55)
    at org.junit.internal.builders.JUnit4Builder.runnerForClass(JUnit4Builder.java:13)
    at org.junit.runners.model.RunnerBuilder.safeRunnerForClass(RunnerBuilder.java:57)
    at org.junit.internal.builders.AllDefaultPossibilitiesBuilder.runnerForClass(AllDefaultPossibilitiesBuilder.java:29)
    at org.junit.runner.Computer.getRunner(Computer.java:38)
    at org.junit.runner.Computer$1.runnerForClass(Computer.java:29)
    at org.junit.runners.model.RunnerBuilder.safeRunnerForClass(RunnerBuilder.java:57)
    at org.junit.runners.model.RunnerBuilder.runners(RunnerBuilder.java:98)
    at org.junit.runners.model.RunnerBuilder.runners(RunnerBuilder.java:84)
    at org.junit.runners.Suite.<init>(Suite.java:79)
    at org.junit.runner.Computer.getSuite(Computer.java:26)
    at org.junit.runner.Request.classes(Request.java:69)
    at org.junit.runner.JUnitCore.run(JUnitCore.java:117)
    at org.junit.runner.JUnitCore.runMain(JUnitCore.java:98)
    at org.junit.runner.JUnitCore.runMainAndExit(JUnitCore.java:53)
    at org.junit.runner.JUnitCore.main(JUnitCore.java:45)

FAILURES!!!
Tests run: 2,  Failures: 2 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-05-20T22:50:12.270

[AllTests](http://junit.sourceforge.net/javadoc/org/junit/runners/AllTests.html)用于运行 JUnit 3.8 测试。如果查看[源代码](http://grepcode.com/file/repo1.maven.org/maven2/junit/junit/4.5/org/junit/runners/AllTests.java)，您会发现它没有扩展 TestCase（JUnit 3.8 风格）或具有 @Test 方法（JUnit 4.0 风格）。它也没有公共的无参数构造函数。它不需要，因为它不是一个可以作为单元测试运行的类。

正如盛源所说，检查测试文件夹。您找到的 AllTests 类将位于源文件夹中，这意味着您可能在错误的文件夹中查找实际的示例测试。

# php - 如何在 PHP 中将日期从 mm/dd/yy 格式转换为 dd/mm/yy 现在函数 split() 已弃用？

> ID：10609557
> 
> 赞同：0
> 
> 时间：2012-05-15T22:14:27.790
> 
> 标签：php, string, date, split, deprecated

好的，所以我花了一年的时间从​​事网络开发以追求其他职业兴趣，然后这周回来检查一个客户网站，该网站的发布已经暂停了一段时间，我发现自从我的托管公司更新了服务器上的 PHP 版本，包含日期转换功能的脚本会抛出错误，因为 split() 已被弃用（这将教会我花一年的时间！）。

在环顾这里和其他地方之后，我从不同的角度读到我应该使用 preg_split()、explode() 和 strtotime()。理论上听起来很简单，但是当我尝试过它们时，要么日期格式错误（例如 /--15/5/12），要么我收到未定义的偏移警告，或者脚本似乎工作但打印的确认更新的工作显示了可怕的 1-1-70 日期，所以现在不仅我的脚本不起作用，而且我的数据库有一些奇怪的空白条目并且奇怪地添加了总计（至少数据库相对容易找到和修复错误 - 一旦我记得我把服务器密码放在哪里！）。

我知道我可以隐藏 split() 错误，但这不是最佳做法，我想尝试让它按应有的方式工作。有问题的脚本如下。我想我的问题的简短版本是，我需要做什么来重写这个脚本以便它再次工作？

```
 <?php
        require_once('/home/thebooks/admins/connect.php');
        $id = stripslashes($_POST['id']);            
        $date = stripslashes($_POST['dateinput']); // get the data from the form
        $amountraised = stripslashes($_POST['amountraised']);  
        $comments = stripslashes($_POST['comments']); 
        // *** function dateconvert ***
        // dateconvert converts data from a variable (posted from a form or just stored) 
        // into a format mysql will be able to store and converting the 
        // database date back into the british standard of date month year.
        // The script accepts day.month.year or day/month/year or day-month-year. 
        // @param string $date - Date to be converted
        // @param string $func - which function is to be used (1 for input to mysql, 2 for output from mysql)    
        require_once('/home/thebooks/admins/connect.php');
        $id = stripslashes($_POST['id']);            
        $date = stripslashes($_POST['dateinput']); // get the data from the form
        $amountraised = stripslashes($_POST['amountraised']);  
        $comments = stripslashes($_POST['comments']); 
        // using type 1
        $date = dateconvert($date,1); // Would convert to e.g. 2005-12-19 which is the format stored by mysql
        function dateconvert($date,$func) {
        if ($func == 1){ //insert conversion
        list($day, $month, $year) = split('/-', $date); 
        $date = "$year-$month-$day"; 
        return $date;
        }
        if ($func == 2){ //output conversion
        list($year, $month, $day) = split('/-', $date); 
        $date = "$day/$month/$year"; 
        return $date;
          }
        }
        $update = "UPDATE fundraisingtotal SET date = '$date', amountraised = '$amountraised', comments = '$comments' WHERE id='$id' ";
        $result = mysql_query($update) or die(mysql_error());
        $realdate = dateconvert($date,2); // convert date to British date 
        if ($result) {
        echo "<p class=\"dbpara\">Thank you. Your update to the record was successful.</p>";
        echo "<p class=\"dbpara\">The record has been amended to a date of <b>$realdate</b> and amount of <b>$amountraised</b>. Comments: <b>$comments</b></p>";
        }
        else {
        echo "<p>Nothing has been changed.</p>";
        }
        mysql_close();
        ?> 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-05-15T22:19:15.057

PHP 内置了一个惊人的[日期/时间库](http://php.net/manual/en/book.datetime.php)。你最好用那个。

另外，请花点时间了解一下[SQL 注入](http://en.wikipedia.org/wiki/SQL_injection)。你的代码很容易受到最简单的攻击，所以[尽快修复它](https://stackoverflow.com/questions/60174/best-way-to-stop-sql-injection-in-php)。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-05-15T22:16:14.300

`split`已弃用，但`explode`不是。它做同样的事情，但使用字符串而不是表达式（如果`split`这样做 - 我实际上不确定）。当然，总是有的`preg_split`。

重读后听起来你想使用`preg_split('#/|-#' ...`

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-05-15T22:18:44.870

你不能使用：

```
$date = "01/12/2012"; 
echo date("dd/mm/yyyy", strtotime($date)); 
```

编辑：

如所见是这个线程：

[转换日期格式 yyyy-mm-dd => dd-mm-yyyy](https://stackoverflow.com/questions/2487921/php-convert-date-format-yyyy-mm-dd-dd-mm-yyyy-not-in-sql)

# jquery-mobile - jQueryMobile 按钮向下颜色

> ID：10609560
> 
> 赞同：0
> 
> 时间：2012-05-15T22:15:02.410
> 
> 标签：jquery-mobile, cordova

我有一个按钮定义为：

```
 <a id="myBtn" href="" data-role="button">Logon</a> 
```

我有一个与按钮关联的点击事件。但是，当点击它时，它不会更改为 ui-btn-down-c 主题颜色。请注意，如果它有这样的 href 它可以工作。

```
 <a id="myBtn" href="logon.html" data-role="button">Logon</a> 
```

我不能在我的应用程序中使用它，所以这种解决方法对我没有好处。关于为什么这不起作用的任何想法。此外，我已经为点击事件处理程序中的按钮设置了背景，但是在它在 PhoneGap 中变为该颜色（至少在 iOS 中）之前存在严重滞后。

谢谢！

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-05-15T23:20:54.037

存在延迟以允许双击和点击并按住等。它通常是 500 毫秒到 700 毫秒的延迟。要解决此延迟，请尝试绑定到 touchstart。例子：

```
$('#myBtn').on('touchstart',function(){
    $(this).addClass('ui-btn-down-c');
}); 
```

请注意，这在某些手机浏览器（WP7、黑莓）中不起作用。但它应该在IOS中工作正常

# node.js - SocketIO + MySQL 认证

> ID：10609564
> 
> 赞同：2
> 
> 时间：2012-05-15T22:15:47.140
> 
> 标签：node.js, authentication, websocket, socket.io

我正在尝试通过 socketIO 对 MySQL 数据库进行身份验证。我已经建立了连接并且可以毫无问题地查询结果，但是由于某种原因，我无法将用户是否通过身份验证传递给`connection`socketio 的部分。这个想法是我的应用程序有主机和观众。如果连接到应用程序而不在应用程序中发送密码，`QueryString`则应用程序假定其为查看器并接受连接。如果发送了密码，则会针对 DB 进行检查并接受/拒绝连接。我想要一个变量传递给我，`connection`这样我就可以在我的应用程序事件中使用它。这是我到目前为止所拥有的，但显然`data.query['ishost']`没有传递到应用程序中。

```
sio.configure(function() {
    sio.set('authorization', function (data, accept) {
        UserID = data.query['username'];

        try {
            UserID = UserID.toLowerCase();
        } catch(err) {
            return accept("No WebBot Specified. ("+err+")", false);
        }

        // if not sending a password, skip authorization and connect as a viewer
        if (data.query['password'] === 'undefined')
        {
            return accept(null, true);
        }
        // if sending a password, attempt authorization and connect as a host
        else
        {
            client.query(
            'SELECT * FROM web_users WHERE username = "'+UserID+'" LIMIT 1',
              function selectCb(err, results, fields) {
                if (err) {
                  throw err;
                }
                // Found match, hash password and check against DB
                if (results.length != 0)
                {
                    // Passwords match, authenticate.
                    if (hex_md5(data.query['password']) == results[0]['password'])
                    {
                        data.query['ishost'] = true;
                        accept(null, true);
                    }
                    // Passwords don't match, do not authenticate
                    else
                    {
                        data.query['ishost'] = false;
                        return accept("Invalid Password", false);
                    }
                }
                // No match found, add to DB then authenticate
                else
                {
                    client.query(
                        'INSERT INTO web_users (username, password) VALUES ("'+UserID+'", "'+hex_md5(data.query['password'])+'")', null);

                    data.query['ishost'] = "1";
                    accept(null, true);
                }

                client.end();
              }
            );

            // Should never reach this
            return accept("Hacking Attempt", false);
        }

        // Definitely should never reach this
        return accept("Hacking Attempt", false);
    });
}); 
```

写入`data.query`使其可以通过 handshakeData 访问。但由于某种原因，它没有通过应用程序传递它。任何帮助表示赞赏，谢谢。

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2012-05-16T15:56:13.123

你很接近，但我建议设置请求标头而不是设置查询字符串参数。您的授权函数中的`data`变量是握手数据，其中包含您可以使用的请求标头和 cookie 信息。以下是设置 cookie 的示例：

**在服务器上**

```
io.configure(function() {
    io.set('authorization', function(handshake, callback) {
        var cookie, token, authPair, parts;

        // check for headers
        if (handshake.headers.cookie && 
            handshake.headers.cookie.split('=')[0]=='myapp') {

            // found request cookie, parse it
            cookie   = handshake.headers.cookie;
            token    = cookie.split(/\s+/).pop() || '';
            authPair = new Buffer(token, 'base64').toString();
            parts    = authPair.split(/:/);

            if (parts.length>=1) {
                // assume username & pass provided, check against db
                // parts[0] is username, parts[1] is password
                // .... {db checks}, then if valid....
                callback(null, true);
            } else if(parts.length==1) {
                // assume only username was provided @ parts[0]
                callback(null,true);
            } else {
                // not what we were expecting
                callback(null, false);
            }
        }
        else {
            // auth failed
            callback(null, false);
        }
    });
}); 
```

**在客户端**

*在*您致电之前，请`socket.connect`使用您的身份验证/用户信息设置一个 cookie：

```
function writeCookie(value, days) {
    var date, expires;

    // days indicates how long the user's session should last
    if (days) {
        date = new Date();
        date.setTime(date.getTime()+(days*24*60*60*1000));
        expires = "; expires="+date.toGMTString();
    } else {
        expires = "";
    }
    document.cookie = "myapp="+Base64.encode(value)+expires+"; path=/";
};

// for a 'viewer' user:
writeCookie('usernameHere', 1);

// for the 'host' user:
writeCookie('usernameHere:passwordHere', 1); 
```

除非您的浏览器支持[`btoa()`](https://developer.mozilla.org/en/DOM/window.btoa).

需要注意的是，这不是一个好的身份验证结构。直接在查询字符串或标头信息中传递用户凭据是不安全的。不过，这种方法让您更接近更安全的方法。我建议查看像 passport.js 或everyauth 这样的身份验证库。您可以在此代码中使用这些库存储的会话信息来运行您的检查。

# jquery - 在提交表单后，如何让我的 jQuery 验证器代码再次运行？

> ID：10609567
> 
> 赞同：2
> 
> 时间：2012-05-15T22:15:58.217
> 
> 标签：jquery, jquery-validate

这是场景。

用户填写表格。他忘记了一些必要的信息。我的验证码向用户表明缺少的字段是必需的。他完整填写表格并提交。它的工作原理。

现在，用户手动删除必填字段并再次点击提交。Presto 它可以工作（它应该）。如何让我的验证再次生效以防止提交空字段？这是我的代码。它仅适用于表单提交的 1 次迭代。所有后续提交都会忽略我的验证。

谢谢...

```
//Validation  
$('#CommentsForm').validate({
    rules: {
        Author: "required",
        Message: "required"
    },
    messages: {
        Author: "Author is required.",
        Message: "Comment is required."
    },
    errorContainer: "#CommentsErrorBox",
    errorLabelContainer: "#CommentsErrorBox ul",
    wrapper: "li"
});

//User Clicked Submit Button
$('#CommentsForm').live('submit', function (e) {
    e.preventDefault(); //Prevent Browser from getting new url

    //Create JSON object
    var jsonCommentData = {
        ID: $('#HiddenID').val(),
        Author: $('#Author').val(),
        Message: $('#Message').val()
    }

    //Add the comment.
    $.ajax({
        url: '/Home/_CommentsAdd',
        type: 'POST',
        data: JSON.stringify(jsonCommentData),
        dataType: 'html',
        contentType: 'application/json',

        //The request was a success. Repopulate the div with new result set.
        success: function (data) {
            $('#AjaxComments').html(data);
            $('abbr.timeago').timeago(); //update the timestamp with timeago

            //Change colors of message.                
            if ($('#CommentStatus').html() == "Your Comment Has Been Added!") {
                $('#CommentStatus').css('color', 'GREEN');
            }
        },
        error: function (data) {
            alert('Fail');
        }
    });
}); 
```

这是我的部分观点：_Comments

```
@model DH.ViewModels.CommentsViewModel

<div id="AjaxComments">
@{
    <input type="hidden" id="HiddenPageNumber" value="@Model.PageNumber.ToString()" />
    <input type="hidden" id="HiddenPageCount" value="@Model.PageCount.ToString()" />

    //No Comments Yet
    if (Model.CommentStatus.Length > 0)
    {
            <div id="CommentStatus">@Model.CommentStatus</div>
    }

    foreach (var item in Model.Comment)
    {   
        <div class="CommentContainer">
            <div class="RateComment">
                <img src="/content/images/icons/Thumbs-Up-16x16.png" alt="Thumbs Up" title="Uprate Comment" style="margin-top: 10px;" />
                <div class="CommentRating">8</div>
                <img src="/content/images/icons/Thumbs-Down-16x16.png" alt="Thumbs Down" title="Downrate Comment" style="margin-top: 5px;" />
            </div>
            <div class="CommentHeader">
                <div class="CommentAuthor">@item.Author</div>
                <div class="MessageDate">
                    <img src="/content/images/icons/Clock-16x16.png" width="16" height="16" alt="Comment Time" style="vertical-align: middle; padding-bottom: 2px;" />
                    <abbr class="timeago" title="@item.MessageDate" style="border-bottom-width: 0;">@item.MessageDate</abbr>
                </div>
            </div>
            <div class="CommentMessage">@item.Message</div>
            <div style="clear: both;"></div>
        </div>
    }
}

<div id="Pagination">
@{ 
    //Setting up Increments of 10 Pagination links
    int StartPage;
    int EndPage;
    int PageNumber = Model.PageNumber;
    int PageCount = Model.PageCount;

    if (PageCount < 10) {
        StartPage = 1;
        EndPage = PageCount;
    }
    else {
        if (PageNumber < 10) {
            StartPage = 1;
            EndPage = 10;
        }
        else {
            StartPage = PageNumber - 5;
            EndPage = PageNumber + 4;
            if (EndPage > PageCount) {
                EndPage = PageCount;
                StartPage = EndPage - 9;
            }
        }
    }

    //Display "Page of" if there are comments.
    if (@Model.PageCount > 0)
    {
        <div id="PageOf">Page @Model.PageNumber of @Model.PageCount</div>
    }

    //Set up First and Prev arrow links
    if (Model.PageNumber > 1) {
        <a class="PaginationLink" title="Prev" href="">< Prev</a>
    }

    //Loop through and create the page #'s.
    for (var PageCounter = StartPage; PageCounter <= EndPage; PageCounter++) {
        //Display the Page # in a Black Box
        if (PageCounter == PageNumber) {
            <span class="CurrentPage">@PageNumber</span>
        }
        //Create the Page # Links.
        else {
            <a class="PaginationLink" title="@PageCounter" href="">@PageCounter</a>
        }
    }

    //Set up Next and Last arrow links
    if (Model.PageNumber < Model.PageCount) {
        <a class="PaginationLink" title="Next" href="">Next ></a>
    }
} 
</div>

<div id="CommentsFormContainer">
    <form id="CommentsForm" action="">
    <div id="CommentsErrorBox"><ul></ul></div>
    <fieldset id="CommentsFormFieldset">
        <legend id="CommentsFormLegend" align="center">Add a Comment</legend>
        <label for="Author" class="LabelAuthorMessage">Author:&nbsp;</label><input type="text" id="Author" name="Author" size="30" class="CommentInputs" />
        <label for="Message" class="LabelAuthorMessage">Comment:&nbsp;</label><textarea id="Message" name="Message" cols="35" rows="5" class="CommentInputs"></textarea>
        <input type="text" id="CharCount" value="0" readonly="readonly" />&nbsp;&nbsp;
        <label for="CharCount" id="LabelCharCount">* Max 200 Characters</label>
        <input type="submit" id="SubmitComment" value="Submit" name="SubmitComment" style="float: left; margin-left: 50px;" />
    </fieldset>
    </form>
</div> 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-05-15T22:46:33.997

您的问题完全在于您的实施。

当页面加载时会发生以下情况，这使您的表单在第一次提交时成功工作......

```
var validator = form.validate({
    rules: {
        Author: "required",

        etc.... 
```

然后，因为您再次将它包含在提交处理程序中，所以它在这里重新初始化......

```
form.live('submit', function (e) {
    e.preventDefault(); //Prevent Browser from getting new url

    $(this).validate(); 
```

...这打破了下一次提交。

您需要做的就是初始化**一次**（包括所有选项），而**不是**在提交处理程序中......

```
$('#CommentsForm').validate({
    rules: {
        Author: "required",

        etc.... 
```

[参考这些官方demo](http://jquery.bassistance.de/validate/demo/)的源码。

* * *

**编辑：**

同样，您不需要提交处理程序，因为它会干扰您的表单提交。

换句话说，您的验证工作正常，但是当您点击“提交”时，您的外部提交处理程序函数将完全接管，因此验证随后开始失败也就不足为奇了。

正如我在原始评论中提到的，验证插件有一个内置的提交处理程序来处理包括您的 ajax 在内的所有内容。

彻底删除这一切...

```
form.live('submit', function (e) { .... 
```

然后*在*您的`validate()`函数中，您只需[根据作为第二个选项列出的插件文档](http://docs.jquery.com/Plugins/Validation/validate#toptions)添加一个提交处理程序...

```
$('#CommentsForm').validate({
    rules: {
        Author: "required",

        /// etc....

    },

    submitHandler: function(form) {

        /// put all your ajax and such in here

    }

 }); 
```

# javascript - 防止在 iPad 3 上的 HTML5 Canvas 中绘制 @2x

> ID：10609582
> 
> 赞同：0
> 
> 时间：2012-05-15T22:17:05.177
> 
> 标签：javascript, ios, ipad, html, canvas

我为 HTML5 画布编写了一个游戏，但不幸的是，它在 iPad 3 上的性能不太理想。我不确定这个问题是否是由 iPad 的视网膜显示引起的，但怀疑可能是。有没有办法阻止 iPad 在画布上绘制 @2x？

谢谢你的帮助。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-10-14T18:28:42.040

```
<meta name="viewport" content="width=device-width, maximum-scale=0.5,initial-scale=0.5"> 
```

比例为 0.5，因为在视网膜显示器上 window.devicePixelRatio = 2 (比例 = 1.0/2)

# java - 扩展多个类的替代方案

> ID：10609589
> 
> 赞同：0
> 
> 时间：2012-05-15T22:17:35.097
> 
> 标签：java, module, minecraft

> **可能重复：**
> [从两个类扩展](https://stackoverflow.com/questions/5836662/extending-from-two-classes)

我目前正在尝试为 Minecraft 制作一个简单的 Mod，我基本上需要以下代码：

（我不想编辑很多类，因为我希望我的模组与许多其他模组兼容。）

```
public class EntityModPlayer extends EntityPlayer, EntityCreature
{
    super(par1World);
    fishHook = new EntityFishHook(this /* has to be EntityPlayer */);
    tasks.addTask(0, new EntityAISwimming(this /* has to be EntityCreature */));
} 
```

但是你不能扩展一个以上的类......

新的**EntityFishHook***需要 EntityPlayer 而不是 EntityModPlayer 作为参数，但**新的 EntityAISwimming**方法希望我使用 EntityCreature 的实例作为参数。所以我需要“扩展”EntityPlayer **AND** EntityCreature 并且不能只复制 EntityPlayer 并将其粘贴为 EntityModPlayer。

我已经玩过接口，但我认为这是不同的，所以我不能像“扩展”一样使用它。

对不起@所有不了解Minecraft或不懂我的英语的人......（我是德国人。）

有什么想法我不必更改**许多/重要的**类，如 EntityTasks（因为如果它们正在编辑同一个类，这会使我的 mod 与其他 mod 不兼容）？

*方法 new EntityFishHook (EntityPlayer) 在 Minecraft 中并不存在。我只是以此为例来更好地解释它。我希望您理解我试图解释的内容，我敢肯定这并不容易：/

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-05-15T22:25:00.147

你可以尝试让你的一个超类来扩展另一个。然后你可以从两个类中获取方法！

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2012-05-15T22:28:29.280

Java（和其他单继承语言）的正确习惯用法是有两个接口。`EntityPlayer`然后`EntityCreature`你将它们组合成一个单独的类，`Implements`每个接口。

另一种方法是使用`Composite Pattern`创建单个类，该类具有每个类的所有方法，`Class`并让该类将每个方法委托给组合接口的单个​​类所拥有的每个内部类的实例。如果客户端代码不期望任何一个语言级别的接口或使用像 Python 这样的鸭子类型语言，则此方法有效。

您可以将这两种方法与两个接口结合起来，`Composite Pattern`并将`Composite`对象委托给每个接口的单独实现`Interface`，这样可以轻松进行依赖注入；使用 Google Guice 之类的工具使您的代码更加灵活。

# android - 尝试使用 while 循环创建应用程序

> ID：10609590
> 
> 赞同：0
> 
> 时间：2012-05-15T22:17:44.300
> 
> 标签：android, eclipse, multithreading, while-loop

我是一个完整的新手。我正在尝试将我在课堂上制作的这个简单程序移植到 Android 应用程序中。只是假设打印出“我喜欢计算机科学！！” 一定数量。但我怀疑 while 循环导致我的程序自动强制关闭。搜了一圈，发现需要做个跟帖，但是找不到类似的情况。

这是我的 onCreate 方法：

```
public void onClick(View v) 
     {
int number = 1;
int printed = 0;
int limit = 0;
int count = 0;

String countString;
second.setText("How much do you love Computer Science?");

countString = howMuchEditText.getText().toString();
count = Integer.valueOf(countString);

printed = count;

while ((count -1) >= limit)
{
   third.setText(+number + " I love Computer Science!!");
   count -= 1;
   number ++;      
}
fourth.setText("This printed " +printed + " times.");
     }
    });

}
} 
```

谁能帮我修复我的力量关闭？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-05-16T00:33:18.557

要添加到前面的答案， AsyncTask 也不是答案。这是因为您无法在后台线程上对 TextView 进行修改——UI 调用只允许在主线程上进行。要在 UI 线程上安排定期任务，请为自己创建一个[Handler](http://developer.android.com/reference/android/os/Handler.html)对象，该对象具有多种`post`方法，您可以调用这些方法在指定的时间间隔后或尽快运行任务。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-05-15T22:22:46.750

Android 只允许您的应用程序的处理程序执行五秒钟，然后您将收到“应用程序无响应”消息。根据循环计数，您的`onClick`方法很容易超过该限制。

如果要显示自动更新的计数器，则需要启动在后台执行的异步任务。

这是一个关于[的快速教程](http://labs.makemachine.net/2010/05/android-asynctask-example/)`AsyncTask`，但您需要了解更多有关 Android 平台基础知识的知识，然后才有意义。祝你好运！

# cuda - 如何在 CUDA 的内核调用之间使用共享内存？

> ID：10609591
> 
> 赞同：1
> 
> 时间：2012-05-15T22:17:45.513
> 
> 标签：cuda, shared-memory, gpgpu

我想在一个内核的内核调用之间使用共享内存。我可以在内核调用之间使用共享内存吗？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-05-15T22:24:30.777

不，你不能。共享内存具有线程块生命周期。`__global__`在一次函数调用期间，属于一组的所有线程都可以访问存储在其中的变量。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-05-22T08:48:53.747

试试page-locked memory，但速度应该比显存慢很多。cudaHostAlloc (void **ptr, size_t size, cudaHostAllocMapped); 然后将ptr发送到内核代码。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-05-22T14:37:18.090

以前您可以以非标准方式执行此操作，您将为每个共享内存块拥有一个唯一的 id，下一个内核将检查该 id 并因此对该共享内存块执行所需的处理。这很难实现，因为您需要确保每个内核的完全占用并处理各种极端情况。此外，如果没有正式支持，您将无法依赖计算设备和 cuda 版本之间的兼容性。

# c# - 控制动画后停止工作

> ID：10609593
> 
> 赞同：0
> 
> 时间：2012-05-15T22:17:59.387
> 
> 标签：c#, wpf, xaml, binding, storyboard

**我有一个名为`tbMaster`：**

```
<Slider  Name="tbMaster"  Maximum="10000"  Value="{Binding SbVolumeValue}"/> 
```

**绑定属性的代码：**

```
 double _SbVolumeValue;
    public double SbVolumeValue
    {
        get
        {
            return _SbVolumeValue;
        }
        set
        {
            _SbVolumeValue = value;
            OnPropertyChanged("SbVolumeValue");
        }
    } 
```

**我有故事板`sbVolume`**

```
 <Storyboard x:Key="sbVolume">
        <DoubleAnimationUsingKeyFrames Storyboard.TargetProperty="(RangeBase.Value)" Storyboard.TargetName="tbMaster">
            <EasingDoubleKeyFrame KeyTime="0:0:1.2" Value="40">
                <EasingDoubleKeyFrame.EasingFunction>
                    <CircleEase EasingMode="EaseOut"/>
                </EasingDoubleKeyFrame.EasingFunction>
            </EasingDoubleKeyFrame>
        </DoubleAnimationUsingKeyFrames>
    </Storyboard> 
```

* * *

如果我运行应用程序，滑块效果很好。当我开始故事板时它停止工作：

```
 var sbVolume = this.FindResource("sbVolume") as Storyboard;
 sbVolume.Begin(); 
```

为什么我制作动画后它停止工作？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-05-15T22:41:57.143

尝试将 a 添加[`FillBehavior.Stop`](http://msdn.microsoft.com/en-us/library/system.windows.media.animation.timeline.fillbehavior)到您的动画中。默认值为`FillBehavior.HoldEnd`.

从上面的链接：

> 由于动画在其填充期间继续覆盖其目标属性的值，因此尝试通过其他方式设置目标属性的值可能看起来没有效果。有关显示如何在动画后设置属性值的示例，请参阅[如何：在使用情节提要动画后设置属性。](http://msdn.microsoft.com/en-us/library/aa970493)

# javascript - 使用提交按钮重构 ajax 表单的建议？

> ID：10609595
> 
> 赞同：1
> 
> 时间：2012-05-15T22:18:14.090
> 
> 标签：javascript, ruby-on-rails, ajax, ruby-on-rails-3, twitter-bootstrap

我有这个弹出窗口，它包含 2 个按钮来拒绝并接受问题是我正在尝试设置按钮的样式并且仍然触发一个 JS 事件来关闭弹出窗口（它是一个模态 ajax 弹出窗口）问题是我缺乏灵感和将以下 3 个元素组合在一起的想法。

一些导轨代码：

```
 // ACCEPT FORM
  = form_tag(friend_path, :method => 'post', :remote => true) do
    = hidden_field_tag :user_id, current_user.id
    = submit_tag 'ACCEPT'

  // DECLINE FORM
  = form_tag(friend_path, :method => 'post', :remote => true) do
    = hidden_field_tag :user_id, current_user.id
    = submit_tag 'DECLINE'
    //fbmodal.close () 
```

任何人都知道我如何拥有按钮

*   可样式化（就像 twitter bootstrap 一样）

*   仍然用ajax发送

*   触发一个 JS 事件来关闭弹出窗口？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-05-15T22:36:18.153

可样式化的按钮：

```
%button.btn#accept-button
  %i.icon-plus
  Accept 
```

你的 JS 可以是这样的：

```
$(document).ready(function() {
  $('#accept-button').click(function() {
    // replace this with your AJAX call
    $.get('/foo.json');
    // close the modal
    $('#your-modal-id').modal('hide');
    // and don't submit
    return false;
  });
}); 
```

# java - 比较Java中的日期字符串

> ID：10609596
> 
> 赞同：11
> 
> 时间：2012-05-15T22:18:17.053
> 
> 标签：java, date

所以我使用`dateString1.compareTo(dateString2)`which 根据每个字符的 Unicode 值与字符串进行字典比较，并返回一个 int。这是一个代码示例。

```
String dateString1 = "05-12-2012";
String dateString2 = "05-13-2012";
if (dateString1.compareTo(dateString2) <=0){
   System.out.println("dateString1 is an earlier date than dateString2");
} 
```

这是在 Java 中比较日期的错误方法吗？

在我的测试中，我没有遇到意外结果的情况。如果我不需要的话，我真的不想从字符串中创建一个 Date 对象，因为我在一个长时间运行的循环中执行此操作。

**Ninja Edit** 从下面的答案中收集到，如果日期是格式的，将日期作为字符串进行比较没有任何问题，`yyyyMMdd`但如果它是任何其他格式，显然会导致错误。

我实际上`yyyyMMdd`在我的实际代码中将日期字符串作为格式。（我在上面给出的示例中输入了错误的格式。）所以现在，我将保持代码不变，并添加几行注释来证明我的决定。

但是我现在看到，像这样比较字符串是非常有限的，如果 dba 决定在以后更改日期格式，我会遇到错误，而我认为这不会发生。

* * *

## 回答 #1

> 赞同：18
> 
> 时间：2012-05-15T22:34:34.553

在 Java 中使用字符串处理日期并不总是最好的选择。例如，当是**闰年**时，二月会多出一天。因为字符串可能看起来是正确的，所以执行**转换**更合适。Java 验证日期是否正确。

[您可以使用SimpleDateFormat](http://docs.oracle.com/javase/7/docs/api/java/text/SimpleDateFormat.html)类将字符串转换为日期。

```
public static void main(String[] args) throws ParseException {
    String dateString1 = "05-12-2012";
    String dateString2 = "05-13-2012";

    SimpleDateFormat format = new SimpleDateFormat("dd-MM-yyyy");

    Date date1 = format.parse(dateString1);
    Date date2 = format.parse(dateString2);

    if (date1.compareTo(date2) <= 0) {
        System.out.println("dateString1 is an earlier date than dateString2");
    }
} 
```

要找出允许检查[自定义格式的参数（Java™ 教程 > 国际化 > 格式）](http://docs.oracle.com/javase/tutorial/i18n/format/simpleDateFormat.html)

* * *

## 回答 #2

> 赞同：8
> 
> 时间：2012-05-15T22:23:44.130

我建议您做正确的事情（[如此处所述](https://stackoverflow.com/questions/2592501/compare-dates-in-java)）并转换为适当的`Date`对象进行比较。如果以及何时实际影响您的应用程序（它可能不会），请担心性能影响。

* * *

## 回答 #3

> 赞同：4
> 
> 时间：2012-05-15T22:20:47.317

这很糟糕，因为现在你无法处理一年的变化。

如果你想这样做，你可能想要格式化日期，`YYYY-MM-DD`这样新的一年就不会毁了它。

* * *

## 回答 #4

> 赞同：3
> 
> 时间：2012-05-17T15:14:09.420

使用字母排序规则来处理日期排序是不好的，主要是因为您遇到了根据字母和数字系统对事物进行不同排序的问题

对于字母表

```
01-02-2011 comes before
01-1-2011 (because 0 in the date field is before 1 in the other date field) 
```

对于数制

```
01, 02, 2011 comes after
01, 1, 2011  because all fields are being compared like numbers 
```

日期对象扩展了数字比较以了解哪些字段在比较中优先，因此您不会得到较早的月份将日期“放在”另一个实际发生在后一个月但较早年份的日期之前。

如果您对日期格式有严格的控制，您可以对齐日期，使其也遵循字母规则；但是，如果您不小心注入了格式错误的日期，这样做可能会使您的整个程序以奇怪的方式失败。

典型的做法是（不推荐，请使用非字符串日期比较）

```
YYYYMMDD
(year)(month)(day) all zero-padded. 
```

最后一种技术主要是因为您最终会在野外看到它，并且应该认清它的本质：尝试在没有适当日期库的情况下处理日期（又名聪明的 hack）。

* * *

## 回答 #5

> 赞同：2
> 
> 时间：2016-07-12T16:59:48.910

正如所讨论的，通常使用日期时间对象而不是字符串更好。

# java.time

其他答案使用旧的过时的日期时间类，这些类已被证明设计不良、令人困惑且麻烦。它们缺少一个类来真正表示没有时间和时区的纯日期值。

而是使用Java 8 及更高版本中内置的[java.time框架。](http://docs.oracle.com/javase/8/docs/api/java/time/package-summary.html)请参阅[Oracle 教程](http://docs.oracle.com/javase/tutorial/datetime/TOC.html)。许多 java.time 功能在 ThreeTen-Backport 中向后移植到 Java 6 和 7，并在[ThreeTenABP](https://github.com/JakeWharton/ThreeTenABP)[中](http://www.threeten.org/threetenbp/)进一步适应 Android 。

```
String input = "05-12-2012";
DateTimeFormatter formatter = DateTimeFormatter.ofPattern( "MM-dd-yyyy" );
LocalDate ld = LocalDate.parse( input , formatter ); 
```

`LocalDate`工具`compareTo`。_ 此外，您可以调用方法 equals、isBefore、isAfter。

```
Boolean isEarlier = ld.isBefore( someOtherLocalDate ); 
```

* * *

## 回答 #6

> 赞同：1
> 
> 时间：2012-05-15T23:44:58.990

如果您只对每个日期进行一次读取，那么 YYYYMMDD（而不是您所做的 MMDDYYYY）可能是最佳解决方案。但是，当您打算多次处理每个日期时（例如，您正在对它们进行排序），那么肯定最好将它们更改为可以比字符串更快地进行比较的对象（例如日期）

# maven - 如何使用 Gerrit 在 Jenkins 中触发 Maven 特定工作

> ID：10609598
> 
> 赞同：0
> 
> 时间：2012-05-15T22:18:19.557
> 
> 标签：maven, jenkins, gerrit

我目前正在使用 Jenkins(1.451) 和 Gerrit Trigger(2.3.1) 从 Gerrit 启动构建以验证代码。

只要将 Jenkins 中的项目配置为“自由风格”项目，它就可以正常工作。但是，我目前正在设置一个新的构建管道，我正在使用“构建一个 maven2/3 项目”选项，以便利用我无法从“自由样式”选项中获得的 Maven 特定属性。出于某种原因，Jenkins 似乎没有使用此选项触发构建。当我向 Gerrit 提交代码时，什么都没有发生，在正常情况下应该被提取。我实际上想知道 Gerrit 触发器是否适用于配置为 maven2/3 作业的 Jenkins 项目，或者我只能使用 Free style 选项来执行此操作。ge

任何人都可以确认是否是这种情况？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-04-25T04:17:13.653

是的，这会起作用。我怀疑您可能有一些身份验证问题导致您的工作不被触发。

检查 gerrit 配置文件夹中的 sshd_log 以查看是否有任何 jenkins 登录会导致立即 LOGOUT。在我的情况下，我忘记为所有项目下的非交互式用户添加流事件权限，这导致了一些奇怪的行为。

这是我在 sshd_log 中每秒 3 次看到的消息： `jenkins a/1000002 gerrit.stream-events 0ms 0ms not-admin`

请参阅[此处](https://stackoverflow.com/a/16206203/2259878)了解更多详细信息

# java - 结合快速排序和中值选择算法

> ID：10609602
> 
> 赞同：1
> 
> 时间：2012-05-15T22:18:35.353
> 
> 标签：java, quicksort, median

我想修改 QuickSort（在 Java 中），以便每次调用 Partition 时，都将比例数组的中值用作枢轴。

我在 Java 中有一个中值选择算法，它返回第 k 个最小的元素，在这种情况下是中值。我在java中有大量的快速排序算法，它们都可以自行工作并对数组进行排序。不幸的是，我无法将这两者结合起来以实现上述目标......每次我尝试它时，我通常都会遇到 stackoverflow 错误。

任何人都可以给我看代码，看看它是如何完成的吗？

谢谢

编辑：例如，这是我尝试使用的中值选择算法。

```
public int quickSelect(int[] A, int p, int r, int k) {
    if (p==r) return A[p];
    int q = Partition(A,p,r);
    int len = q-p+1;

    if (k == len) return A[q];
    else if (k<len) return Select(A,p,q-1,k);
    else return Select(A,q+1,r,k-len);
}

public int partition(int[]A, int p, int r) {
    int x = A[r];
    int i = p-1;
    for (int j = p; j<=r-1; j++) {
        if (A[j] <= x) {
            i++;
            swap(A,i,j);
        }
    }
    swap(A,i+1,r);
    return i+1;
} 
```

它自己工作，但是当我尝试通过快速排序的分区函数调用 quickSelect 以返回要使用的枢轴时，它不起作用。显然我做错了什么，但我不知道是什么。不幸的是，在 Internet 上，我没有找到任何算法，即使是伪代码，也可以将中值选择与快速排序结合起来。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-05-15T23:14:26.610

获得中位数的标准方法是对数据进行排序。并且您想通过对中位数进行分区来对数据进行排序。这对我来说似乎很鸡和蛋。

您能否详细说明为什么要在中位数上进行分区/旋转？

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-05-15T23:52:38.563

您正在寻找的是选择算法。这是一个[带有伪代码的链接](http://en.wikipedia.org/wiki/Selection_algorithm)。

从链接：

> 在计算机科学中，选择算法是一种用于查找列表中第 k 个最小数字的算法

要找到中位数，您需要在列表中找到 k=floor((n+1)/2) 的最小数字，其中 n 是列表的大小。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-01-20T11:29:13.567

你可以用这个...

```
int Select(int array[],int start, int end,int k){

if(start==end){
    return start;
}

int x=array[end];
int i=start-1;
for(int j=start;j<=end-1;j++){
    if(array[j]<x){
        i++;
        Swap(array+i,array+j);
    }
}
i++;
Swap(array+i,array+end);

if(i==k){
    return i;
}
else if(i>k){
    return Select(array,start,i-1,k);
}
else{
    return Select(array,i+1,end,k);
} 
```

}

Select 将在数组中的第 k 个最小元素上对数组进行分区；

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2012-07-18T06:15:21.723

请注意，`PARTITION`在`pivot`.`A[r]`

```
public int QUICKSORT2(int[] A, int p, int r) {
    if (p<r) {
        int median=Math.floor((p + r) /2) - p + 1
        int q=SELECT(A, p, r, median)
        q=PARTITION2(A, p, r, q)
        QUICKSORT2(A, p, q-1)
        QUICKSORT2(A, q+1, r)
    }
}

public int PARTITION2(int[]A, int p, int r, int q) {
    int temp = A[r];
    A[r]=A[q];
    A[q]=temp;
    return PARTITION(A, p, r)
} 
```

# c - 如何告诉openmp不要同步数组

> ID：10609604
> 
> 赞同：2
> 
> 时间：2012-05-15T22:18:38.373
> 
> 标签：c, linux, gcc, openmp, x86-64

我有一个具有以下结构的代码。

```
#pragma omp parallel for
for( i = 0; i < N; i++ )
{
    .....
    index = get_index(...);
    array[index] = ...;
    .....
} 
```

现在每个线程的值`index`都是唯一的（对于不同的线程它永远不会重叠），但是 OpenMP 当然无法对此做出猜测，我想是使用同步对象来访问`array`.

我怎么能要求openmp不要使用同步对象`array`并依赖我这个`index`值对于不同的线程是唯一的。我尝试放入`array`私人列表，但因此出现分段错误。

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-05-16T08:45:07.670

Openmp 确实在障碍或隐式障碍处同步。例如，`for`除非指定 nowait 子句，否则在构造末尾有一个隐式障碍。

但是 openmp 不会为您通过访问来同步内存。相反，它为每个线程提供了共享和私有内存块的机制。

在您的情况下，`index`需要是私有的。否则，每个线程都会写入相同的内存位置，当您访问`array[index]`.

为了演示，我明确地设置了行为，尽管`i`默认情况下是私有的并且`array`默认情况下是共享的。

```
#pragma omp parallel for private(i, index) shared(array)
for( i = 0; i < N; i++ )
{
    .....
    index = get_index(...);
    array[index] = ...;
    .....
} 
```

# java - 拒绝访问？JAVA

> ID：10609606
> 
> 赞同：-1
> 
> 时间：2012-05-15T22:18:42.957
> 
> 标签：java, file-io, applet, file-permissions, accesscontrolexception

我正在为学校的 java 课制作游戏，需要写入文件。我从之前制作的工作程序中复制了一些代码，但每当我运行它时，我都会收到拒绝访问错误。我的java老师说我对文件有完全的读写权限，但它仍然吐出错误。

Hiscore.txt 文件确实存在并且拼写完全一样。

错误出现在 MakeOutputFile 方法中，特别是在初始化 printwriter 的位置。它也确实出现在 CheckOutputFile 中，但该方法目前已被注释掉。

我是这个网站的新手，所以我不太清楚如何放置代码，所以结果会很粗制滥造。

```
Exception in thread "AWT-EventQueue-1" java.security.AccessControlException: 
    access denied  ("java.io.FilePermission" "Hiscore.txt" "write") 
```

## 代码

```
 import java.awt.*;

 import java.awt.event.*;

 import javax.swing.*;

 import javax.swing.event.*;

 import java.io.File;

 import java.io.PrintWriter;

 import java.io.IOException;

 import java.io.FileNotFoundException;

import java.util.Scanner;

public class TowerDefence extends JApplet implements MouseListener  {

 int xpos, ypos, money, attackspawn, attackcount, lives, attackerhealth, hiscore, 
laser;        // x,y location of current square

private DrawingArea canvas;    // JPanel canvas on which to draw grid

private int[][] numbers;     

private int[][] damage;

JPanel startscreen;

File ifile, ofile, qfile;

Scanner input, output, questionreader;

boolean start, play, checkhiscore, fileexists, end, inquestionstate;

long totaldamage;

Timer timer;

boolean [][] moved;

JButton button;

public File fargle;

PrintWriter makesOutput;

 //JButton begin;

 // Constructor

 public TowerDefence( ) {

   inquestionstate = false;

 JButton begin = new JButton ("BEGIN");

 //begin = new JButton("BEGIN");

 checkhiscore = false;

 xpos = ypos = attackcount = laser = 4;        

 button = new JButton("Double Damage for 15 seconds");

 money = 200;

 attackspawn = 0;

 totaldamage = 0;

 lives = 10;

 attackerhealth = 24;

 fileexists = true;

 numbers = new int[30][30];    

 damage = new int [20][20];

 moved = new boolean  [20][20];

 Timer timer;

 end = false;

 for (int i = 0; i< 20; i++){

     for (int j = 0; j< 20; j++){

         moved[i][j] = false;

         damage [i][j] = 0;

     }

 }

 for (int i = 0; i<30; i++){

     for (int j = 0; j<30; j++){

         numbers[i][j] = 0;

     }

 }

 start = false;

 play = false;

 ifile = new File("map.txt");

 ofile = new File ("hiscore.txt");

 qfile = new File("questions.txt");

 RepaintAction action = new RepaintAction();

 timer = new Timer(1000, action);

 timer.start();

 }

 private class RepaintAction implements ActionListener {

 public void actionPerformed(ActionEvent evt) {

 repaint();  // Call the repaint() method in the panel class.

 }

 }// MANDATORY: required initialization of JApplet

 // MANDATORY: required initialization of JApplet

 public void init ( ) {

 canvas = new DrawingArea();                // create a new Drawing Area

 setContentPane(canvas);                    // connect the canvas to JApplet

 canvas.setBackground(Color.lightGray);    // make the background lightGray

 canvas.addMouseListener(this);

 canvas.requestFocus();                     // focus keyboard on JApplet'

 }

 // MANDATORY: Define DrawingArea as a JPanel

 class DrawingArea extends JPanel {

  JButton begin = new JButton ("BEGIN");

  JButton upgrade = new JButton ("upgrade");

  JComboBox selectmap = new JComboBox();

  String op1, op2 = "yodel";

  String askquestion;

  String option = "ocean";

  String findplace = "";

  JRadioButton option1, option2;

  JLabel question;

  ButtonGroup group = new ButtonGroup();

  JFrame questionframe = new JFrame();

 public void paintComponent(Graphics g) {

     super.paintComponent(g);        // MANDATORY: Must be first method called.

     if (!play&&!end){

          ReadIt1();

          StartScreen(g);

          StartButton();

      }

     if (start){

             ReadIt();

     }
    if (play){

         ChangeAttackers();

         drawGrid(g);                    

         Attack(g);

         DamageCheck();

         if (attackspawn % 15 == 0){

             SpawnAttackers();

             ReadQuestions();

         }

         LifeCheck(g);

     }

       //  CheckOutputFile();

       //if (fileexists){

              MakeOutputFile();

         //}

  if (end){

     LifeCheck(g);

          }

 }

 public void ReadQuestions(){

   if(!inquestionstate){

   try{

     questionreader = new Scanner(qfile);

   }catch(FileNotFoundException e){

     System.out.println("ERROR: cannot open file map.txt");

     System.exit(1);

   }

   while (!findplace.equalsIgnoreCase(op2)){

           findplace = questionreader.nextLine();

           }

           askquestion = questionreader.nextLine();

           op1 = questionreader.nextLine();

           op2 = questionreader.nextLine();

           System.out.println(askquestion);

           System.out.println(op1);

           System.out.println(op2);

           question = new JLabel(askquestion);

           option1 = new JRadioButton(op1);

           option2 = new JRadioButton(op2);

           questionframe.setLayout(new GridLayout(0,1));

           questionframe.removeAll();

           questionframe.getContentPane().add(question);

           questionframe.getContentPane().add(option1);

           questionframe.getContentPane().add(option2);

           questionframe.setVisible(true);

           inquestionstate = true;

           }

   }

 public void ReadIt1(){

     if (option.equalsIgnoreCase("ocean")){

         ifile = new File("oceanmap.txt");

     }

     else if (option.equalsIgnoreCase("canyon")){

         ifile = new File("map.txt");

     }

 try{

     input = new Scanner(ifile);

 }catch(FileNotFoundException e){

     System.out.println("ERROR: cannot open file map.txt");

     System.exit(1);

 }

 for (int i = 0; i<20; i++){

     for (int j = 0; j < 20; j++){

         numbers [j+5][i+5] = input.nextInt();

     }

 }

         input.close();

 }//end method ReadIt

 public void StartScreen(Graphics g){

      for (int row = 0; row < 20; row ++){

         for (int col = 0; col < 20; col ++){

             if (numbers[row+5][col+5] == 0&&option.equalsIgnoreCase("canyon")){

                 g.setColor(Color.green);

             }

             else if (option.equalsIgnoreCase("canyon")){

                 g.setColor(Color.black);

             }

             else if (option.equalsIgnoreCase("ocean")&&numbers[row+5][col+5] == 0){

                 g.setColor(Color.yellow);

             }

             else if (option.equalsIgnoreCase("ocean")){

                 g.setColor(Color.cyan);

             }

             g.fillRect(30 + col *22, 30 + row * 22, 21, 21);

             g.setFont( new Font ("Serif", Font.BOLD, 48));

             g.setColor(Color.red);

             g.drawString("TOWER DEFENCE", 10,100);

         }

     }

         }

         public void StartButton(){

          selectmap.addItem("Ocean");

          selectmap.addItem("Canyon");

          begin.setVisible(true);

          begin.addActionListener(new ButtonListener());

          this.setLayout(null);

          this.add(begin);

          begin.setBounds(0,468,500,32);
          selectmap.setVisible(true);

          this.add(selectmap);

          selectmap.setBounds(300,300, 100,25);

         }

 // Draw the numbers on the grid

 // Draw the Sudoku grid of rectangles

 public void LifeCheck(Graphics g){

   if(!inquestionstate){

         JButton upgrade = new JButton ("upgrade");

         upgrade.addActionListener(new ButtonListener());

     for (int i = 0; i<20; i++){

         for (int j = 19; j<20; j++){

             if (numbers [i+5][j+5] == 2){

                 lives--;

                 numbers[i+5][j+5] = 1;
             }

         }

     }

     if (lives <=0){

         play = false;

         end = true;

         for (int row = 0; row < 20; row ++){

         for (int col = 0; col < 20; col ++){

             if (numbers[row+5][col+5] == 0&&option.equalsIgnoreCase("Canyon")){

                 g.setColor(Color.green);

             }

             else if (numbers [row+5][col+5] == 1&&option.equalsIgnoreCase("Canyon")){

                 g.setColor(Color.black);
             }

             else if (numbers [row+5][col+5] == 2){

                 g.setColor(Color.red);

             }

             else if (numbers[row+5][col+5] == 0&&option.equalsIgnoreCase("Ocean")){

                 g.setColor(Color.yellow);

             }

             else if (numbers [row+5][col+5] == 1&&option.equalsIgnoreCase("Ocean")){

                 g.setColor(Color.cyan);

             }

             else if (numbers [row+5][col+5] == 3){

                 g.setColor(Color.gray);

             }

            g.fillRect(30 + col *22, 30 + row * 22, 21, 21);

             g.setColor(Color.black);

             g.drawString("Money: "+money, 420,480);

             g.drawString("Lives: "+lives, 360,480);

             g.drawString("Laser: "+laser, 240,480);

             System.out.print(damage[row][col]);

         }

     }

     this.setLayout(null);

     this.add(upgrade);

    upgrade.setBounds(0, 475, 100, 25);

         Font myFont = new Font ("Arial", Font.BOLD, 25);

         g.setFont(myFont);

         if (option.equalsIgnoreCase("Ocean")){

               g.setColor(Color.red);

         }

         else if (option.equalsIgnoreCase("Canyon")){

             g.setColor(Color.cyan);

         }

         g.drawString("You have lost.  You lasted for " + attackspawn + "seconds.",10,100);

     }

     }

 }

 public void SpawnAttackers(){

   if(!inquestionstate){

     int currentspawn = 0;

     attackcount++;

     attackerhealth+=3;

     if (attackerhealth % 10 == 0){

         attackerhealth += (int)(attackerhealth*1.1);

                 }

    if (attackerhealth % 17 == 0){

         attackerhealth += (int)(attackerhealth*1.2);

    }

    if (attackerhealth % 12 == 0){

         attackerhealth += (int)(attackerhealth*1.3);

    }

    if (attackerhealth % 2 == 0){

         attackerhealth += 1+(int)(attackerhealth * 1.05);

    }

     for (int i = 0; i < 20; i++){

         for (int j = 0; j< 20; j++){

             if (numbers [j+5][i+5] == 1){

                 numbers [j+5][i+5] = 2;

                 currentspawn++;

                 if (currentspawn == attackcount){

                     i = j = 100;

                 }

             }

         }

     }

     }

 }

 public void drawGrid(Graphics g) {

   if(!inquestionstate){

     money++;

     attackspawn++;

           }

     upgrade.addActionListener(new ButtonListener());

     for (int row = 0; row < 20; row ++){

         for (int col = 0; col < 20; col ++){

             if (numbers[row+5][col+5] == 0&&option.equalsIgnoreCase("Canyon")){

                 g.setColor(Color.green);

             }

             else if (numbers [row+5][col+5] == 1&&option.equalsIgnoreCase("Canyon")){

                 g.setColor(Color.black);

             }

             else if (numbers[row+5][col+5] == 0&&option.equalsIgnoreCase("Ocean")){

                 g.setColor(Color.yellow);

             }

             else if (numbers [row+5][col+5] == 1&&option.equalsIgnoreCase("Ocean")){

                 g.setColor(Color.cyan);

             }

             else if (numbers [row+5][col+5] == 2){

                 g.setColor(Color.red);

             }

             else if (numbers [row+5][col+5] == 3){

                 g.setColor(Color.gray);

             }

             g.fillRect(30 + col *22, 30 + row * 22, 21, 21);

             g.setColor(Color.black);

             g.drawString("Money: "+money, 420,480);

             g.drawString("Lives: "+lives, 360,480);

             g.drawString("Laser: "+laser, 240,480);

             g.drawString("Wave: " + (int)(attackspawn/15), 170,480);

             g.drawString("Total Damage: " + totaldamage, 170,20);

             System.out.print(damage[row][col]);

         }

         System.out.println();

     }

     this.setLayout(null);

     this.add(upgrade);

    upgrade.setBounds(0, 475, 100, 25);

     System.out.println();

 }

 public void ReadIt(){

   if(!inquestionstate){

     if (option.equalsIgnoreCase("ocean")){

         ifile = new File("oceanmap.txt");

     }

     else if (option.equalsIgnoreCase("canyon")){

         ifile = new File("map.txt");

     }

 try{

     input = new Scanner(ifile);

 }catch(FileNotFoundException e){

     System.out.println("ERROR: cannot open file map.txt");

     System.exit(1);

 }

 for (int i = 0; i<20; i++){

     for (int j = 0; j < 20; j++){

         numbers [j+5][i+5] = input.nextInt();

     }

 }

 start = false;

 play = true;

 input.close();

 }

 }//end method ReadIt

 public void DamageCheck(){

   if(!inquestionstate){

 for (int i = 0; i<20; i++){

     for (int j = 0; j<20; j++){

         if (damage[i][j] >=attackerhealth){

             numbers[i+5][j+5] = 1;

             damage[i][j] = 0;

             money+=25;

         }

     }

 }

 }

 }

 public void Attack(Graphics g){

   if(!inquestionstate){

     for (int i = 0; i<20; i++){

         for (int j = 0; j<20; j++){

             if (numbers [i+5][j+5] == 3){

                 for (int o = -3; o<4; o++){

                     for (int e = -3; e<4; e++){

                         if (numbers [i+o+5][j+e+5] == 2){

                             damage [i+o][j+e] +=laser;

                             totaldamage+=laser;
                             g.setColor(Color.white);

                             g.drawLine(40+j*22, 40+i*22, 40+(j+e)*22, 40+(i+o)*22);

                         }

                     }

                 }

             }

         }

     }

     }

 }

 public void ChangeAttackers(){

   if(!inquestionstate){

     for (int i = 0; i<20; i++){

         for (int j = 0; j<20; j++){

             moved[i][j] = false;

         }

     }

     for (int i = 0; i<20; i++){

         for (int j = 0; j<20; j++){

             if (numbers[i+5][j+5] == 2){

                 if (numbers[i+5][j+6] == 1&&moved[i][j] == false){

                     numbers [i+5][j+5] = 1;

                     numbers [i+5][j+6] = 2;

                     damage[i][j+1] = damage[i][j];

                     damage[i][j] = 0;

                     moved [i][j+1] = true;

                     System.out.println("Move Right");

                 }

                 else if ((i>13)||(i<9&&i>=7)){

                     if (numbers[i+4][j+5] == 1&&moved [i][j] == false){

                             numbers [i+5][j+5] = 1;

                             numbers [i+4][j+5] = 2;

                             moved [i-1][j] = true;

                             damage[i-1][j] = damage[i][j];

                             damage[i][j] = 0;

                             System.out.println("Move Up");

                     }

                     else if (numbers [i+6][j+5] == 1&&moved[i][j] == false){

                         numbers [i+5][j+5] = 1;

                         numbers [i+6][j+5] = 2;

                         moved [i+1][j] = true;

                         damage[i+1][j] = damage[i][j];

                         damage[i][j] = 0;

                         System.out.println("Move Down");

                     }

                 }

                 else if ((i<=13&&i>=10)||(i<7)){

                     if (numbers [i+6][j+5] == 1&&moved[i][j] == false){

                         numbers [i+5][j+5] = 1;

                         numbers [i+6][j+5] = 2;

                         moved [i+1][j] = true;

                         damage[i+1][j] = damage[i][j];

                         damage[i][j] = 0;

                         System.out.println("Move Down");

                     }

                     else if (numbers[i+4][j+5] == 1&&moved [i][j] == false){

                             numbers [i+5][j+5] = 1;

                             numbers [i+4][j+5] = 2;

                             moved [i-1][j] = true;

                             damage[i-1][j] = damage[i][j];

                             damage[i][j] = 0;

                             System.out.println("Move Up");

                     }

                 }

                 else if (j!=0){

                     if (numbers[i+5][j+4] == 1&&j!=0&&moved[i][j] == false){

                         numbers [i+5][j+5] = 1;

                         numbers [i+5][j+4] = 2;

                         moved[i][j-1] = true;

                         damage[i][j-1] = damage[i][j];

                         damage[i][j] = 0;

                         System.out.println("Move Left");

                     }

                 }

             }

         }

     }

     }

 }

 public void CheckOutputFile(){
          int number;

         try{

         output = new Scanner(ofile);

         }catch(FileNotFoundException e){

         System.out.println("ERROR: cannot open file hiscore.txt");

         fileexists = true;

        // System.exit(1);

         }

         if (fileexists){

                 hiscore = output.nextInt();

                 checkhiscore = true;

                 output.close();

                 }

         }

 public void MakeOutputFile ( ) {

   fargle = new File ("Hiscore.txt");

      try {

           makesOutput = new PrintWriter ( fargle );

   }catch ( IOException e ){

      System.out.println("Cannot create file to be written to");

      System.exit(1);

   }// end catch

      makesOutput.println("\nHiscore :\t" + attackspawn);

      makesOutput.println ( );

      System.exit(1);

 }// end method MakeOutput File

   class ButtonListener implements ActionListener{

 public void actionPerformed(ActionEvent evt){

         System.out.println("RAWR");

               if (evt.getSource() == begin){

                         System.out.println("Button Pressed");

                         begin.setVisible(false);

                         selectmap.setVisible(false);

                         play = true;

                         start = true;

                         option = (String)selectmap.getSelectedItem();

                         System.out.println(option);

               }

              if (evt.getSource() == upgrade){

                  if (money>=50){

                      money+=-50;

                      laser+=1+(int)(laser*.1);

                  }

              }
  }

}

 }

 public void mousePressed(MouseEvent m){

     int x = m.getX();

     int y = m.getY();

     for (int row = 0; row < 20; row ++){

         for (int col = 0; col < 20; col ++){

             if (x>30+col*22&&x<51+col*22&&y>30+row*22&&y<51+row*22){
                 if (numbers [row+5][col+5] == 1&&money>200){

                     numbers [row+5][col+5] = 0;

                     money+=-200;

                     repaint();

                 }

                 else if (numbers [row+5][col+5] == 0&&money>50){

                     System.out.println(row+" " +col);

                     money+=-50;

                     numbers [row+5][col+5] = 3;

                     repaint();

                 }

             }

         }

     }

 }

 public void mouseClicked(MouseEvent m){}

 public void mouseReleased(MouseEvent m){}

 public void mouseEntered(MouseEvent m){}

 public void mouseExited(MouseEvent m){}

} 
```

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-05-15T22:23:41.627

不允许不受信任的小程序读取/写入`File`客户端计算机上的对象。

替代方案是：

1.  将信息存储在服务器上。
2.  对小程序进行数字签名，并在被要求信任它时让用户确定它。
3.  为 Plug-In 2 JRE 部署并使用 JNLP API 服务来调解文件写入。

# amazon-web-services - AWS Auto Scaling 活动的潜在状态代码是什么？

> ID：10609609
> 
> 赞同：1
> 
> 时间：2012-05-15T22:18:56.767
> 
> 标签：amazon-web-services, autoscaling

这是[Activity 数据类型](http://docs.amazonwebservices.com/AutoScaling/latest/APIReference/API_Activity.html)的文档。

但是，我想我已经看到了 4 个响应状态代码：

```
'Successful'
'Cancelled'
'InProgress'
'PreInProgress' 
```

还有其他人吗？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-07-07T00:05:55.563

看起来他们已经在您共享[的同一网址中更新了文档：](http://docs.amazonwebservices.com/AutoScaling/latest/APIReference/API_Activity.html)

`Valid Values: WaitingForSpotInstanceRequestId | WaitingForSpotInstanceId | WaitingForInstanceId | PreInService | InProgress | Successful | Failed | Cancelled`

# django - Django 模板 - 不显示动态图像

> ID：10609614
> 
> 赞同：1
> 
> 时间：2012-05-15T22:19:28.143
> 
> 标签：django, image, django-templates

我已经阅读了有关图像的其他问题，但我仍然无法解决我的问题:(这可能是一些基本的东西，因为我是 django 的新手。

所以我有模型示例：

```
class Example(models.Model):
    image = models.ImageField(upload_to = "examples/") 
```

我想在模板中显示它。作为一个视图，我使用通用的 detailView。这是与模板图像相关的部分：

```
<p>Image: <img src="{{ example.image.url }}"/></p> 
```

我改变了我的settings.py：

```
MEDIA_ROOT = '/home/nicpon/Dokumenty/aplikacje/images/'
MEDIA_URL = '/images/' 
```

并且此时站点显示为没有图像（在它的位置有一个正方形，当图像无法显示时显示）

现在我也改变了 urls.py :`

```
if settings.DEBUG:
    urlpatterns += patterns('', url(r'^images/(?P<path>.*)$',
    'django.views.static.serve', {'document_root': settings.MEDIA_ROOT})), 
```

但这导致了错误：“'list' object has no attribute 'resolve'”在每个页面上。

编辑：当我将 {{ example.image.url }} 放在 img 标签之外时，它显示 /images/exapmles/specific_image.jpg 并且我计算机上该图像的目录是 /home/nicpon/Dokumenty/aplikacje/images/examples/specific_image .jpg

和追溯：

```
Environment:

Request Method: GET
Request URL: http://127.0.0.1:8000/images/examples/sepcific_image.jpg

Django Version: 1.4
Python Version: 2.6.5
Installed Applications:
('django.contrib.auth',
 'django.contrib.contenttypes',
 'django.contrib.sessions',
 'django.contrib.sites',
 'django.contrib.messages',
 'django.contrib.staticfiles',
 'django.contrib.admin',
 'example',
 'registration')
Installed Middleware:
('django.middleware.common.CommonMiddleware',
 'django.contrib.sessions.middleware.SessionMiddleware',
 'django.middleware.csrf.CsrfViewMiddleware',
 'django.contrib.auth.middleware.AuthenticationMiddleware',
 'django.contrib.messages.middleware.MessageMiddleware')

Traceback:
File "/usr/local/lib/python2.6/dist-packages/django/core/handlers/base.py" in get_response
  89\.                     response = middleware_method(request)
File "/usr/local/lib/python2.6/dist-packages/django/middleware/common.py" in process_request
  67\.             if (not urlresolvers.is_valid_path(request.path_info, urlconf) and
File "/usr/local/lib/python2.6/dist-packages/django/core/urlresolvers.py" in is_valid_path
  531\.         resolve(path, urlconf)
File "/usr/local/lib/python2.6/dist-packages/django/core/urlresolvers.py" in resolve
  420\.     return get_resolver(urlconf).resolve(path)
File "/usr/local/lib/python2.6/dist-packages/django/core/urlresolvers.py" in resolve
  300\.                     sub_match = pattern.resolve(new_path)

Exception Type: AttributeError at /images/examples/specific_image.jpg
Exception Value: 'list' object has no attribute 'resolve' 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-05-16T19:46:28.420

尝试做这样的事情是你的 settings.py：

```
MEDIA_SERVER_URL = 'http://www.example.com/'
MEDIA_URL = os.path.join(MEDIA_SERVER_URL, 'images/') 
```

然后做

```
src="{{ MEDIA_URL }}{{ example.image.url }}" 
```

还要检查权限：

1.  媒体目录（/home/nicpon/Dokumenty/aplikacje/images/）：应该允许您的网络服务器读取（例如：chgrp www-data images）
2.  您的网络服务器应配置为适当地处理媒体服务。理想情况下，可以使用单独的媒体服务器，但如果您让 django 为媒体提供服务，则应检查相应的 URL（就像您的 urls.py 中的情况一样）

# scala - Scala 方法调用中 _ 背后的语义

> ID：10609616
> 
> 赞同：1
> 
> 时间：2012-05-15T22:19:39.707
> 
> 标签：scala

scala 2.9.2 这编译得很好

```
object AppBuilder extends App {

  def app( blockw: Int => String ) : List[String] = List( blockw(6) )

  def app( block: => String ) : List[String] = app( _ => block )
} 
```

但是在 REPL 中，与上面相同的方法/函数（不确定此处的区别），当没有包含在一个类中时，我得到以下错误

```
scala> def app( blockw: Int => String ) : List[String] = List( blockw(6) )
app: (blockw: Int => String)List[String]

scala> def app( block: => String ) : List[String] = app( _ => block )
<console>:8: error: missing parameter type
       def app( block: => String ) : List[String] = app( _ => block )
                                                     ^ 
```

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-05-15T22:42:49.300

REPL 目前不支持重载方法 - 请参阅[此答案](https://stackoverflow.com/a/122338/334519)以了解原因。你可以用一个更简单的例子来证明这一点：

```
scala> def f(x: Int) = x
f: (x: Int)Int

scala> def f(x: String) = x
f: (x: String)String 
```

现在试试`f(0)`，你会得到类型不匹配。

您可以使用粘贴模式作为解决方法：

```
scala> :paste
// Entering paste mode (ctrl-D to finish)

def app( blockw: Int => String ) : List[String] = List( blockw(6) )
def app( block: => String ) : List[String] = app( _ => block )

// Exiting paste mode, now interpreting.

app: (blockw: Int => String)List[String] <and> (block: => String)List[String]
app: (blockw: Int => String)List[String] <and> (block: => String)List[String] 
```

但是您最好[避免重载](https://stackoverflow.com/a/2512001/334519)。

# c++ - 将任意数据传递给没有 void 指针的函数

> ID：10609620
> 
> 赞同：0
> 
> 时间：2012-05-15T22:20:02.887
> 
> 标签：c++, parameter-passing, void-pointers

我正在使用实现一组系统测试的抽象基类。在简化形式中，类声明是：

```
class Test_Class
{
    Test_Class();
    ~Test_Class();

    Run_Test(void * param_set = NULL) = 0;
} 
```

基类需要实现 Run_Test 函数，该函数允许用户将任意数据结构作为 void 指针传递，并将其转换为子类中 Run_Test 主体内的适当类型，以允许使用不同的测试不同的数据结构，例如一个测试中的浮点数与另一个测试中的整数列表。

这很麻烦，并且看起来像是一种难以置信的类似 C 的做事方式。有没有更好的方法来使用继承或其他语言实用程序？

注意：由于客户限制，不允许此程序访问 STL 或 Boost 库。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-05-15T22:23:47.610

如果您想要一组测试，请使用`std::vector<std::function<void()>> tests;`然后您可以简单地使用`tests.push_back([=] { do_test(the_args, I_captured, from_local, scope); });`.

`std::bind`如果您的编译器不支持 lambda ，您可以使用类似的技巧。

作为最终用户，您无需编写自己的通用函数接口。它已经完成了。

编辑：是的，如果你不这样做，你最终会得到一些 C 风格的垃圾 A）重新实现 Boost 或 STL 提供的轮子，或者 B）使用 Boost 或 STL 提供的现有轮子。在“编写自己的好代码”或“使用别人的好代码”之间没有神奇的第三选择，仍然会产生好代码。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-05-15T22:24:56.323

是的。用户不会传入*任意*数据结构，但可以通过扩展您的基类来*创建任意数据结构。*

```
class Test_Class {
    Run_Test(const Config& config);
}; 
```

客户端代码：

```
class MyConfig : public Config {
    //...
}; 
```

另一种选择是模板。您可以使用其中任何一个来完成许多常见任务，我不确定在这种情况下哪个是理想的，所以如果您走这条路，我会将其留给其他答案或让您研究。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-05-15T22:51:30.410

我不记得是否有可能/如何对类内的函数进行参数检测所以也许这会做：

```
class Test_Class {

public:
  template <typename T>
  void Run_Test(T p) { 

  }
};

template <class T>
void tester(Test_Class t, T p) {
t.Run_Test<T>(p);
}

int main() {
  Test_Class p;
  int a = 5;

  tester(p, a);
} 
```

# c - 从哪里开始修改开源软件？

> ID：10609622
> 
> 赞同：2
> 
> 时间：2012-05-15T22:20:18.710
> 
> 标签：c, open-source, fortran

我问这个问题是因为我需要修改一个开源软件，我完全不知道如何启动这个项目。

这里有更多细节。我通常在 Linux 中工作并使用 GNU 编译器（g++、gfortran 等）和 Intel 编译器（icc 和 ifort）。我可以编写 fortran 和 c/c++ 程序。到目前为止，我写的项目不到10个文件（有vim，目前还没有IDE）。我通常分别编译它们并将它们组合成一个可执行文件。

现在我需要修改一个开源软件（用于科学计算的软件。没有 GUI。它读取包含所有计算参数的输入文件。）。它的来源包含数百个文件，这对我来说太多了。它确实带有一个配置脚本和一些生成文件。它同时使用 c 和 fortran 代码（我怀疑 c 代码调用了一些 fortran 子例程。）。但我没有尝试在 c/c++ 中使用 fortran 子例程。

我需要了解它，做一个小的修改，并在软件中添加一些功能或子程序作为新功能。

你能告诉我从哪里开始吗？是否有可以将软件“导入”为项目的 IDE？或者一些方便的工具来绘制不同文件之间的连接？（先阅读配置脚本和makefile，然后开始工作，真是太可怕了。）

谢谢。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-05-15T22:31:37.970

您可以尝试与项目的维护者交谈，或者在他们的论坛上寻求指导（如果有的话）。但是，不要指望他们只是告诉您要编辑。如果您至少尝试了解源代码在做什么以及它是如何连接在一起的，那么您更有可能获得帮助，特别是因为至少在我看来，您真的应该在更改之前了解它当前的功能它。

话虽如此，如果您需要进行的更改对其他人有用，维护人员可能会接受您提出的更改作为功能请求。

# actionscript-3 - 增强现实对象运动跟踪（无标记）

> ID：10609624
> 
> 赞同：0
> 
> 时间：2012-05-15T22:20:40.143
> 
> 标签：actionscript-3, flash, augmented-reality

是否有任何 AS3 库允许您通过网络摄像头检测和跟踪对象的运动，而无需任何标记或图像。例如，我想建立一个游戏，你可以只用你的手部动作来玩球。谢谢你。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-05-15T23:26:33.417

我认为您不应该为此使用任何库。有很多本地方法可以做到这一点。例如你可以写这样的东西

```
stage.addEventListener(Event.ENTER_FRAME,handleMotion);

public function handleMotion(e:Event):void
{
    if (ball.x != oldBallX || ball.y != oldBallY)
    {
    //Do something
    }    
} 
```

或覆盖球类的 x 和 y 属性的设置器，并在那里放置您的跟踪功能。第三种方法是将您的跟踪功能放入处理用户输入的回调中。

# firefox - 更少的 CSS 和本地存储问题

> ID：10609625
> 
> 赞同：3
> 
> 时间：2012-05-15T22:20:42.597
> 
> 标签：firefox, local-storage, less

我正在使用 LESS CSS（更确切地说是 less.js），它似乎在后台利用了 LocalStorage。在本地运行我的应用程序时，我以前从未见过这样的错误，但现在我在每个页面显示时都会收到“达到持久存储最大大小”，就在我的应用程序的唯一 .less 文件的链接上方。

到目前为止，这只发生在 Firefox 12.0 上。

有没有办法解决这个问题？

PS：主要受[计算 localStorage space 的使用](https://stackoverflow.com/questions/3027142/calculating-usage-of-localstorage-space)启发，这就是我最终要做的（这是基于 Prototype 并依赖于自定义的琐碎 Logger 类，但这应该很容易适应您的上下文）：

```
"use strict";
var LocalStorageChecker = Class.create({
    testDummyKey: "__DUMMY_DATA_KEY__",
    maxIterations: 100,
    logger: new Logger("LocalStorageChecker"),
    analyzeStorage: function() {
        var result = false;
        if (Modernizr.localstorage && this._isLimitReached()) {  
            this._clear();
        }
        return result;
    },
    _isLimitReached: function() {
        var localStorage = window.localStorage;
        var count = 0;
        var limitIsReached = false;
        do {
            try {
                var previousEntry = localStorage.getItem(this.testDummyKey);
                var entry = (previousEntry == null ? "" : previousEntry) + "m";
                localStorage.setItem(this.testDummyKey, entry);
            }
            catch(e) {
                this.logger.debug("Limit exceeded after " + count + " iteration(s)");
                limitIsReached = true;
            }
        }
        while(!limitIsReached && count++ < this.maxIterations);
        localStorage.removeItem(this.testDummyKey);
        return limitIsReached;
    },
    _clear: function() {
        try {
            var localStorage = window.localStorage;
            localStorage.clear();
            this.logger.debug("Storage clear successfully performed");
        }
        catch(e) {
            this.logger.error("An error occurred during storage clear: ");
            this.logger.error(e);
        }
    }
});

document.observe("dom:loaded",function() {
    var checker = new LocalStorageChecker();
    checker.analyzeStorage();
}); 
```

PPS：我还没有测量对 UI 的性能影响，但是可以创建一个装饰器并仅每 X 分钟执行一次存储测试（例如，在本地存储中执行的最后一个时间戳）。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-05-15T22:28:48.910

这是您遇到的错误的一个很好的资源。

[http://www.sitepoint.com/building-web-pages-with-local-storage/#fbid=5fFWRXrnKjZ](http://www.sitepoint.com/building-web-pages-with-local-storage/#fbid=5fFWRXrnKjZ)

提供一些见解，即 localstorage 只有这么多空间，您可以在每个浏览器中将其最大化。考虑从本地存储中删除一些数据以解决您的问题。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-05-15T22:34:41.923

Less.js 持久缓存 @imported 的内容。您可以使用此脚本清除缓存的内容。使用下面的脚本，您可以调用函数 destroyLessCache('/path/to/css/') ，它将清除已缓存的 css 文件的 localStorage。

```
 function destroyLessCache(pathToCss) { // e.g. '/css/' or '/stylesheets/'
       if (!window.localStorage || !less || less.env !== 'development') {
            return;
       }
       var host = window.location.host;
       var protocol = window.location.protocol;
       var keyPrefix = protocol + '//' + host + pathToCss;
       for (var key in window.localStorage) {
          if (key.indexOf(keyPrefix) === 0) {
             delete window.localStorage[key];
          }
       }
    } 
```

# html - 有没有办法使用 html5 为每个用户加载语言资源？

> ID：10609628
> 
> 赞同：1
> 
> 时间：2012-05-15T22:20:53.047
> 
> 标签：html, manifest, offline, multilingual

我正在尝试构建一个多语言并允许用户离线工作的 html5 网站。如何下载每个用户的特定语言资源（当他们选择他们的语言时）而不必下载所有语言文件（即清单文件适用于所有连接）？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-05-15T22:53:41.610

如何为每种语言生成一个清单，然后从 php 中回显正确的标签？非常丑陋，但你不觉得应该这样做吗？

编辑：当然这意味着无论如何都有一个默认清单，带有一个默认语言包......

# gcc - 用某个值填充向量（SSE2）的最快方法。模板友好

> ID：10609630
> 
> 赞同：3
> 
> 时间：2012-05-15T22:21:02.797
> 
> 标签：gcc, copy, initialization, sse, vectorization

我有这个模板类：

```
template<size_t D>
struct A{
    double v_sse __attribute__ ((vector_size (8*D)));
    A(double val){
        //what here?
    }
}; 
```

`v_sse`用副本填充字段的最佳方法是`val`什么？因为我使用向量，所以我可以使用 gcc SSE2 内在函数。

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2015-08-04T07:52:51.503

如果我们可以编写一次代码，只需稍作调整就可以将其编译为更广泛的向量，即使在自动向量化不起作用的情况下也是如此。

我得到了与@hirschhornsalz 相同的结果：当使用大于硬件支持的向量大小的向量实例化它时，代码量很大，效率低下。例如`A<8>`，在没有 AVX512 的情况下构建会产生大量 64 位`mov`和`vmovsd`指令。它对堆栈上的本地进行一次广播，然后分别读回所有这些值，并将它们写入调用者的 struct-return 缓冲区。

对于 x86，**我们可以让 gcc**`double`根据标准调用约定为接受 arg（在 xmm0 中）并返回向量（在 x/y/zmm0 中）的函数发出最佳广播：

*   上交所2：`unpckpd xmm0, xmm0`
*   上交所3：`movddup xmm0, xmm0`
*   AVX：`vmovddup xmm0, xmm0 / vinsertf128 ymm0, ymm0, xmm0, 1`
    （AVX1 仅包括`vbroadcastsd ymm, m64`表单，如果在调用内存中的数据时内联，它可能会被使用）
*   AVX2：`vbroadcastsd ymm0, xmm0`
*   AVX512 `vbroadcastsd zmm0, xmm0`：。（请注意，AVX512 可以即时从 mem 广播：
    `VADDPD zmm1 {k1}{z}, zmm2, zmm3/m512/m64bcst{er}`
    `{k1}{z}`意味着它可以使用掩码寄存器作为结果的合并或零掩码。
    `m64bcst`意味着要广播的 64 位内存地址。
    `{er}`意味着这条指令可以覆盖 MXCSR 舍入模式.
    IDK 如果 gcc 将使用这种广播寻址模式将广播加载折叠到内存操作数中。

但是，**gcc 也理解 shuffles**，并且具有`__builtin_shuffle`任意向量大小。使用全零的编译时常量掩码，shuffle 变成了广播，gcc 使用该作业的最佳指令进行广播。

```
typedef int64_t v4di __attribute__ ((vector_size (32)));
typedef double  v4df __attribute__ ((vector_size (32)));
v4df vecinit4(double v) {
    v4df v_sse;
    typeof (v_sse) v_low = {v};
    v4di shufmask = {0};
    v_sse = __builtin_shuffle (v_low, shufmask );
    return v_sse;
} 
```

在模板函数中，gcc 4.9.2 似乎有一个问题，即识别出两个向量的宽度和元素数量相同，并且掩码是一个 int 向量。即使没有实例化模板也会出错，所以也许这就是类型有问题的原因。如果我复制类并将其取消模板化为特定的矢量大小，一切都会完美运行。

```
template<int D> struct A{
    typedef double  dvec __attribute__ ((vector_size (8*D)));
    typedef int64_t ivec __attribute__ ((vector_size (8*D)));
    dvec v_sse;  // typeof(v_sse) is buggy without this typedef, in a template class
    A(double v) {
#ifdef SHUFFLE_BROADCAST  // broken on gcc 4.9.2
    typeof(v_sse)  v_low = {v};
    //int64_t __attribute__ ((vector_size (8*D))) shufmask = {0};
    ivec shufmask = {0, 0};
    v_sse = __builtin_shuffle (v_low, shufmask);  // no idea why this doesn't compile
#else
    typeof (v_sse) zero = {0, 0};
    v_sse = zero + v;  // doesn't optimize away without -ffast-math
#endif
    }
};

/*  doesn't work:
double vec2val  __attribute__ ((vector_size (16))) = {v, v};
double vec4val  __attribute__ ((vector_size (32))) = {v, v, v, v};
v_sse = __builtin_choose_expr (D == 2, vec2val, vec4val);
*/ 
```

使用`-O0`. 向量+模板似乎需要一些工作。（至少，它确实回到了 Ubuntu 目前正在发布的 gcc 4.9.2 中。上游可能已经改进了。）

我的第一个想法是，当您使用带有向量和标量的运算符时，gcc 会隐式广播，因为 shuffle 无法编译，因此我将其作为备用。因此，例如，将标量添加到全零向量就可以了。

问题是实际的 add 不会被优化掉，除非你使用`-ffast-math`. `-funsafe-math-optimizations`不幸的是，不仅仅是`-fno-signaling-nans`. 我尝试了`+`不会导致 FPU 异常的替代方法，例如`^`(xor) 和`|`(or)，但 gcc 不会在`double`s 上执行这些操作。`,`运算符不会为 生成向量结果`scalar , vector`。

这可以通过使用简单的初始化列表专门化模板来解决。如果你不能让一个好的通用构造函数工作，我建议省略定义，这样在没有专门化时你会得到一个编译错误。

```
#ifndef NO_BROADCAST_SPECIALIZE
// specialized versions with initializer lists to work efficiently even without -ffast-math
// inline keyword prevents an actual definition from being emitted.
template<> inline A<2>::A (double v) {
    typeof (v_sse) val = {v, v};
    v_sse = val;
}
template<> inline A<4>::A (double v) {
    typeof (v_sse) val = {v, v, v, v};
    v_sse = val;
}
template<> inline A<8>::A (double v) {
    typeof (v_sse) val = {v, v, v, v, v, v, v, v};
    v_sse = val;
}
template<> inline A<16>::A (double v) { // AVX1024 or something may exist someday
    typeof (v_sse) val = {v, v, v, v, v, v, v, v, v, v, v, v, v, v, v, v};
    v_sse = val;
}
#endif 
```

现在，测试结果：

```
// vecinit4 (from above) included in the asm output too.
// instantiate the templates
A<2> broadcast2(double val) { return A<2>(val); }
A<4> broadcast4(double val) { return A<4>(val); }
A<8> broadcast8(double val) { return A<8>(val); } 
```

编译器输出（去除汇编指令）：

```
g++ -DNO_BROADCAST_SPECIALIZE  -O3 -Wall -mavx512f -march=native vec-gcc.cc -S -masm=intel -o-

_Z8vecinit4d:
    vbroadcastsd    ymm0, xmm0
    ret
_Z10broadcast2d:
    vmovddup        xmm1, xmm0
    vxorpd  xmm0, xmm0, xmm0
    vaddpd  xmm0, xmm1, xmm0
    ret
_Z10broadcast4d:
    vbroadcastsd    ymm1, xmm0
    vxorpd  xmm0, xmm0, xmm0
    vaddpd  ymm0, ymm1, ymm0
    ret
_Z10broadcast8d:
    vbroadcastsd    zmm0, xmm0
    vpxorq  zmm1, zmm1, zmm1
    vaddpd  zmm0, zmm0, zmm1
    ret

g++ -O3 -Wall -mavx512f -march=native vec-gcc.cc -S -masm=intel -o-
# or   g++ -ffast-math -DNO_BROADCAST_SPECIALIZE blah blah.

_Z8vecinit4d:
    vbroadcastsd    ymm0, xmm0
    ret
_Z10broadcast2d:
    vmovddup        xmm0, xmm0
    ret
_Z10broadcast4d:
    vbroadcastsd    ymm0, xmm0
    ret
_Z10broadcast8d:
    vbroadcastsd    zmm0, xmm0
    ret 
```

请注意，如果您不对其进行模板化，则 shuffle 方法应该可以正常工作，而是在代码中仅使用一种向量大小。因此，从 SSE 更改为 AVX 就像在一个地方将 16 更改为 32 一样简单。但是，您需要多次编译同一个文件以生成一个 SSE 版本和一个 AVX 版本，您可以在运行时将其分派到。（不过，您可能需要它来获得不使用 VEX 指令编码的 128 位 SSE 版本。）

# regex - 正则表达式匹配 dll 但不匹配目录

> ID：10609633
> 
> 赞同：0
> 
> 时间：2012-05-15T22:22:18.863
> 
> 标签：regex

我有一个正在加载插件的 conf 文件。我需要解析和匹配目录中的某个插件，而不是同一目录中的其他插件：

```
plugin: c:\program files\application\abc\abc.dll
plugin: c:\program files\application\abc\xyz.dll 
```

我只需要匹配 abc.dll 但由于 abc 也在目录名称中，它匹配两行但我不想要 xyz.dll

所以我尝试了： ^plugin:(.*)(abc.dll)

所以 ^ = 行首，然后是插件，然后是 .* 任何东西，然后是 abc 转义点 dll。

但它似乎不起作用。有人可以帮忙吗？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-05-15T22:29:40.933

问题是 abc.dll 中的点。尝试转义它，这样它就不是通配符了。

```
^plugin:(.*)(abc\.dll) 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-05-15T22:32:55.043

你想使用这个正则表达式：

```
([a-zA-Z0-9-_]*\.dll) 
```

这是[示例](http://regexr.com?30vcn)

# c# - 尝试从使用 ProcessStartInfo 和 Process 的方法中运行 slui.exe

> ID：10609635
> 
> 赞同：1
> 
> 时间：2012-05-15T22:22:55.460
> 
> 标签：c#, win32exception

我在从 c# 中的方法运行 slui.exe 时遇到问题。我正在使用代码：

`ProcessStartInfo startInfo = new ProcessStartInfo(@"C:\Windows\System32\slui.exe"); Process p = new Process(); p.StartInfo = startInfo; p.Start(); p.WaitForExit();`

但我不断收到 Win32Exception：“系统找不到指定的文件”。

如果我将 ProcessStartInfo 更改为： (@"C:\Windows\System32\cmd.exe") 它将启动得很好。

在这种情况下运行 slui.exe 是否有问题？

我确定该文件位于指定的目录中，所以我很难理解这里可能出了什么问题。

任何想法如何从 ac# 方法调用 slui.exe？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-05-15T23:07:33.943

Slui.exe 仅作为 Windows x64 上的 64 位程序提供。当您作为 32 位进程运行时，您的硬编码路径 c:\windows\system32 将被重定向到 c:\windows\syswow64。因此找不到该文件。

Project + Properties，Compile 选项卡，将 Platform target 设置更改为“AnyCPU”。重复发布配置。并使用 Environment.GetFolderPath() 确保它在 Windows 未安装到 c:\windows 时仍然有效。

# asp-classic - 从 http 调用 web 服务到 https

> ID：10609639
> 
> 赞同：1
> 
> 时间：2012-05-15T22:23:15.567
> 
> 标签：asp-classic

这是我的场景...

我正在使用经典 ASP 中 http:// 的服务器

公司购买了一个验证信息的网络服务，这个网络服务是[https://xxx.svc?etc](https://xxx.svc?etc)

我该怎么做才能调用此服务？我用 jQuery 尝试过 AJAX，我尝试过 XmlHTTPRequest 和 XDR，但我几乎没有想法。我每次都遇到同样的错误。当我在我的对象上调用“打开”时，“访问被拒绝”。我听说过一些关于同域策略和跨站点脚本的事情，但现在是 2012 年。有没有办法做到这一点？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-05-16T07:37:16.103

您遇到了跨域问题。

`ServerXMLHttp`设置通过对象与 Web 服务通信的服务器端页面。[在此处](http://msdn.microsoft.com/en-us/library/windows/desktop/ms754586%28v=vs.85%29.aspx)阅读有关此内容的更多信息。

然后，您可以处理请求服务器端或使用 JavaScript 向您的服务器端页面发出 AJAX 请求。由于它将在同一个域上，因此您不会遇到跨域问题。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-05-15T22:28:08.157

2个建议...

你看过 JSONP：[http ://en.wikipedia.org/wiki/JSONP](http://en.wikipedia.org/wiki/JSONP)

或者你可以调用服务器端的服务……</p>

# mysql - mysql 索引和优化，使用 where；使用临时的；使用文件排序

> ID：10609640
> 
> 赞同：3
> 
> 时间：2012-05-15T22:23:19.613
> 
> 标签：mysql, count, indexing, group-by, filesort

哪些表和列应该有索引？我在 flow_permanent_id 和 entry_id 上有一个索引，但它似乎在使用文件排序？

我能做些什么来优化这个？

```
mysql> explain SELECT COUNT(*) AS count_all, entry_id AS entry_id FROM `votes` WHERE `votes`.`flow_permanent_id` = '4fab490cdc1c82cfa800000a' GROUP BY entry_id;
+----+-------------+-------+------+----------------------------------+----------------------------------+---------+-------+------+----------------------------------------------+
| id | select_type | table | type | possible_keys                    | key                              | key_len | ref   | rows | Extra                                        |
+----+-------------+-------+------+----------------------------------+----------------------------------+---------+-------+------+----------------------------------------------+
|  1 | SIMPLE      | votes | ref  | index_votes_on_flow_permanent_id | index_votes_on_flow_permanent_id | 74      | const |    1 | Using where; Using temporary; Using filesort |
+----+-------------+-------+------+----------------------------------+----------------------------------+---------+-------+------+----------------------------------------------+
1 row in set (0.00 sec) 
```

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2012-05-15T22:31:30.677

为了避免文件排序，您需要在 ( `flow_permanent_id`, `entry_id`) 上使用复合索引，以便 MySQL 可以将索引用于 WHERE 和 GROUP BY。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-05-15T22:41:11.483

首先 - 使用 COUNT(1) 而不是 COUNT( * )，在某些情况下可能会提高性能。永远不要使用 COUNT(*)。

第二：看起来您使用了索引，它列在 EXPLAIN 输出的“键”列中。您的“GROUP BY”是导致文件排序的原因。通常是 ORDER BY 是罪魁祸首，但我已经看到 GROUP BY 也可以做到这一点。

希望这可以帮助。

# objective-c - localStorage 未在 OSX 应用程序中保留（Xcode 4.3）

> ID：10609644
> 
> 赞同：8
> 
> 时间：2012-05-15T22:23:44.353
> 
> 标签：objective-c, macos, webkit, local-storage, xcode4.3

从我所见，如果您正在构建 OSX 桌面 HTML5 应用程序并希望 localStorage 保留在您的 WebView 包装器中，您需要执行以下操作：

```
WebPreferences* prefs = [webView preferences];
[prefs _setLocalStorageDatabasePath:@"~/Library/Application Support/MyApp"];
[prefs setLocalStorageEnabled:YES]; 
```

摘自：[如何在基于 WebKit 的应用程序中启用本地存储？](https://stackoverflow.com/questions/4527905/how-do-i-enable-local-storage-in-my-webkit-based-application)

但这在 Xcode 4.3 中似乎对我不起作用。相反，我得到

```
"No visible @interface for 'WebPreferences' declares the selector '_setLocalStorageDatabasePath:'
"No visible @interface for 'WebPreferences' declares the selector 'setLocalStorageEnabled:' 
```

我对Objective C很陌生，可能正在做一些愚蠢的事情，比如不包括一些标题或其他东西。

我已经包含了 WebKit 框架和这两个标头：

```
#import <WebKit/WebKit.h>
#import <WebKit/WebPreferences.h> 
```

奇怪的是，我可以访问其他首选项方法，即`[prefs setDefaultFontSize:10]`- 但不能访问我列出的上述两种方法。

有任何想法吗？这是在 Xcode 4.3 中删除的东西吗？

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-05-26T04:58:35.117

好的，我有一个解决方案。[我查看了macgap](https://github.com/maccman/macgap)的源代码，并注意到他们是如何处理这个问题的。

事实证明，我收到的错误消息确实有点道理——我需要先为 WebPreferences 声明一个接口。

```
@interface WebPreferences (WebPreferencesPrivate)
- (void)_setLocalStorageDatabasePath:(NSString *)path;
- (void) setLocalStorageEnabled: (BOOL) localStorageEnabled;
@end

...

WebPreferences* prefs = [WebPreferences standardPreferences];
[prefs _setLocalStorageDatabasePath:"~/Library/Application Support/MyApp"];
[prefs setLocalStorageEnabled:YES];
[webView setPreferences:prefs]; 
```

就像我说的，我是 Objective-C 的新手。我真的不明白为什么需要接口来调用这两个方法（即当我可以在没有接口的情况下调用其他方法时）。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-05-19T13:54:14.187

有好消息也有坏消息；我将假设您首先想要坏消息（如果我先用坏消息回答您的问题会更容易）。

# 坏消息

发生这种情况的唯一答案是 Xcode 4.3 不再提供这些方法。您链接到的那个问题“[如何在我的基于 WebKit 的应用程序中启用本地存储？](https://stackoverflow.com/questions/4527905/how-do-i-enable-local-storage-in-my-webkit-based-application) ”最后一次活跃是在一年多前（接受的答案是在 2011 年初编辑的）。从那时起，Xcode 至少有两次更新（可能更多，我只是不记得它们了），对我来说，Apple 希望将它们的私有方法保持私有似乎是可行的，所以可以安全地假设他们删除了它们以及对`setLocalStorageEnabled:`.

我认为您的问题没有其他答案的原因如下：

1.  您在实例上调用的两种方法`WebPreferences`均不受支持。这不仅仅是私有方法，所以 Apple 肯定修改了这个`WebPreferences`类，不仅删除`setLocalStorageEnabled:`了对私有方法的支持，例如`_setLocalStorageDatabasePath:`. 为什么他们一开始就支持私有方法，我不知道，但他们肯定会打击他们的支持，因为我已经有一段时间没有看到实现私有方法的机会了。
2.  如果实现私有方法（或什至其他公共方法）是可能的，那么它会像您的代码一样简单。如果查看链接的问题，他们并没有提到获得支持代码的任何困难步骤。没有任何方法可以导入框架的私有部分，例如`WebKit`不做一些繁重的工作，不仅要找到私有部分，还要将其放入您的代码中。即使您可以在所有繁重的工作之后在您的代码中获得这些方法的支持，Apple 也不太可能对此感到非常满意，并且他们可能会拒绝您的应用程序从应用程序商店中发布。

很抱歉成为 Debbie-downer，但我只是认为如果没有一些深入挖掘和大型解决方法，您的代码将不再工作。如果您希望它轻松工作，您可能不得不回到 2011 年初，然后改为制作您的应用程序。

# 好消息

由于缺乏使用`WebKit`. 与其寻找为什么你的代码不能工作的答案，我会开始寻找你的代码应该做什么的替代方案。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2013-08-09T18:24:37.067

我找到了持久性问题的解决方案。见我的帖子

[webview中的本地存储不是持久的](https://stackoverflow.com/questions/8198453/local-storage-in-webview-is-not-persistent/18153115#18153115)

# list - Pattern matching to iterate over a list

> ID：10609645
> 
> 赞同：0
> 
> 时间：2012-05-15T22:23:47.440
> 
> 标签：list, haskell, logic

I am trying to learn Haskell from [Haskell Road to Logic](http://homepages.cwi.nl/~jve/HR/) and came across this example:

```
 mnmInt :: [Int] -> Int
    mnmInt [] = error "empty list"·
    mnmInt [x] = x
    mnmInt (x:xs) = min x (mnmInt xs) 
```

I understand the functions takes a list of `Int` - Checks if empty if not checks if it's a list with 1 int if so return x if not plug mnmInt with xs parameter to min.

how does it reach the base case? what does the xs stand for?

min implementation:

```
 min' :: Int -> Int -> Int
   min' x y | x <= y    = x
            | otherwise = y 
```

doesn't take an array.

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-05-15T22:27:53.523

`(x:xs)` is pattern matching syntax. Pattern matching lets you "destructure" data types and bind them to names. In this case x is the head of the list, and xs is the tail. `min'` doesn't need to take a list because x is the head of the list, not a list itself.

`min'` itself finds the minimum value between two `Ints`, `mnmInt` will eventually expand out to something like `(min' 1 (min' 2 (min' 3 4)))` if you pass in a list that looks like `[1,2,3,4]`.

This is easy to see if you evaluate the code by hand, which I highly suggest you try. Remember, `(x:xs)` is two names, which are the head and tail of the list. You might want to play around with constructing lists using `:`

Here is an example that shows how pattern matching relates to code flow.

```
foo (x:y:[]) = "two"
foo ([]) = "none"
foo (_) = "some other value" 
```

if you call `foo [1,2]` it will output "two", if you do `foo [1,2,3]` it will give you "some other value", and if you do `foo []` it will return `"none"`

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-05-16T10:03:07.657

You can write a list in two ways in Haskell, first like [1,2,3,4,5], which is only syntactic sugar for 1:2:3:4:5:[]. Now the pattern (x:xs) matches with a list like this:

```
 head(x:xs) = x
    --> head [1,2,3,4,5] = head 1:2:3:4:5:[] = head 1:xs = 1 
```

i hope this example make it clear to you how a list pattern works.

# jquery - 扳机带有图标或按钮

> ID：10609656
> 
> 赞同：-1
> 
> 时间：2012-05-15T22:25:15.353
> 
> 标签：jquery, button, input, triggers

我正在使用一个效果很好的上传插件。我需要使用按钮或 img 标签触发上传文件选择对话框。我可以用 jquery 来做到这一点吗？

我不喜欢它的样子

我发现了很多“解决方法”，但它们似乎都过于复杂，只是认为我可能错过了这里有人知道的简单解决方案。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-05-15T22:27:43.410

一般来说，浏览器不希望你能够做到这一点。浏览器供应商希望确保提示用户上传文件的任何内容都非常明确并使用“熟悉的 UI”，以便用户知道他们在做什么。

您可以使用各种技巧和技巧，但它们都会给人一种“hacky”的感觉，仅仅是因为您试图规避浏览器试图强制执行的内容。

# bash - 如何使用 sed 查找和替换项目，仅当匹配项不受字母或数字约束？

> ID：10609659
> 
> 赞同：1
> 
> 时间：2012-05-15T22:25:41.640
> 
> 标签：bash, sed

我`sed`用来查找和替换项目，例如：

```
sed -i 's/fish/bear/g' ./file.txt 
```

我想将此限制为仅更改前后没有字母或数字的项目，例如：

*   `The fish ate the worm.`会改变，因为前后只有空格。
*   `The lionfish ate the worm.`不会改变，因为之前有一个字母`fish`。

我怎样才能找到和替换一些项目，但如果至少有一个字母或数字出现在之前或之后？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-05-15T22:59:12.540

使用单词边界转义：

```
sed -i 's/\<fish\>/bear/g' inputfile 
```

某些版本`sed`可能不支持此功能。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-05-15T22:27:52.433

在 之前和之后使用否定字符类`fish`，如下所示：`\(^\|[^[:alnum:]]\)fish\($\|[^[:alnum:]]\)`. 这说：

1.  行首或任何非字母数字
2.  紧随其后的是鱼
3.  后跟行尾或任何非字母数字

这保证了紧接其前和紧随其后的字符`fish`不是字母数字。

```
sed 's/\(^\|[^[:alnum:]]\)fish\($\|[^[:alnum:]]\)/\1bear\2/g' 
```

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-05-15T22:34:05.477

检查字符串前后的字符。如果它在开头或结尾，则不会有要检查的字符，因此也要检查。

```
sed -i 's/\(^\|[^[:alnum:]]\)fish\($\|[^[:alnum:]]\)/\1bear\2/g' 
```

# php - jQuery 立方体有时会相互重叠

> ID：10609660
> 
> 赞同：0
> 
> 时间：2012-05-15T22:26:02.950
> 
> 标签：php, javascript, jquery, ajax

我有一个 pinterest 风格的网站，并制作了一个 jquery 脚本，无论浏览器有多大，它都能均匀地排列立方体。由于页面加载的某种原因，它有一些以前不存在的重叠立方体。我与帮助我制作它的人交谈，他说这可能是因为创建块并定位它们的代码之前的代码。它使javascript崩溃。

我认为这是因为 $(window).scroll ajax 加载代码，但我似乎无法确定问题所在。我尝试移动 positionBlocks(); 周围没有任何变化。如果您在浏览器中加载页面然后更改浏览器大小，那么它会正确定位它们，但显然我希望它在用户第一次到达那里时看起来正确。

```
function setupBlocks() {
    windowWidth = $(window).width();
    blocks = [];

    // Calculate the margin so the blocks are evenly spaced within the window
    colCount = Math.floor(windowWidth/(colWidth+margin*2));
    spaceLeft = (windowWidth - ((colWidth*colCount)+margin*2)) / 2;
    spaceLeft -= margin;

    for(var i=0;i<colCount;i++){
        blocks.push(margin);
    }
    positionBlocks();
}

function positionBlocks() {
    $('.block').each(function(i){
        var min = Array.min(blocks);
        var index = $.inArray(min, blocks);
        var leftPos = margin+(index*(colWidth+margin));
        $(this).css({
            'left':(leftPos+spaceLeft)+'px',
            'top':min+'px'
        });
        blocks[index] = min+$(this).outerHeight()+margin;
    });
}

// Function to get the Min value in Array
Array.min = function(array) {
    return Math.min.apply(Math, array);
};

var curlimit=<?php echo $curlimit;   ?>;
var totalnum=<?php echo $num_rws; ?>;
var perpage=<?Php echo $perpage ?>;
var working_already=false;

$(document).ready(function() {
//($(window).scrollTop() + $(window).height() )> $(document).height()*0.8
// old ($(window).scrollTop() + $(window).height() == $(document).height())

    $(window).resize(setupBlocks);

    $(window).scroll(function() {
        if(($(window).scrollTop() + $(window).height() )> $(document).height()*0.90  && totalnum>0 && working_already==false  ) {
        } else return false;

        working_already=true;
        $("div#loading_bar").fadeIn("slow");
        curlimit=curlimit+perpage;
        $("div#loading_data_location").html("");

        $.get('get_cubes.php?page=<?php echo $_GET['page'] ?>&curlimit='+curlimit, function(response) {
            $("div#loading_data_location").html(response);

            $("div#ColumnContainer").append($("div#loading_data_location").html()); 

            $("a#bigpic").fancybox({
                'onComplete' : imageLoadComplete,
                'onClosed' : imageClosed,
                'type': 'ajax' });

            if ($("div#loading_data_location").text()=="")  
                totalnum=0;
            else
                totalnum=<?php echo $num_rws; ?>;

            $('.like:not(.liked)').click(like_box);
            $('.save:not(.saved)').click(save_box);
            $('.follow:not(.following)').click(follow);
            $("div#loading_bar").fadeOut("fast");

            $("div#loading_data_location").html('');

            setupBlocks();
            working_already=false;          
        });
    }); 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-05-23T19:55:31.573

我不得不将此添加到脚本的末尾：

```
<script language="javascript">
$(window).bind("load", function() {
  setupBlocks();
});
</script> 
```

然后到滚动 ajax 加载结束。有时 jquery 只需要一点面子哈哈：

```
setTimeout(function(){setupBlocks();},100); 
```

# sql-server-2005 - 操作必须使用 Access 2007 和 SQL 2005 后端的可更新查询错误

> ID：10609665
> 
> 赞同：1
> 
> 时间：2012-05-15T22:26:37.220
> 
> 标签：sql-server-2005, ms-access, ms-access-2007

我在 Access 2007 中使用带有 SQL 2005 主干的 VB 代码。我的 SQL 服务器位于单独的机器上，下面的代码在客户端上运行。问题是当我运行下面的 UPDATE 命令时，我收到错误“操作必须使用可更新查询”。我知道这很常见，但我在互联网上的所有研究都没有产生与我的情况相似的任何东西。

```
Dim MyDB as DAO.Database
Dim sSQL as String
sSQL = "UPDATE tblBMS_Batch SET Status = 70 WHERE Batch_ID = 108582"
MyDB.Execute sSQL 
```

设置的表如下

```
SET ANSI_NULLS ON
GO
SET QUOTED_IDENTIFIER ON
GO
SET ANSI_PADDING ON
GO
CREATE TABLE [dbo].[tblBMS_Batch](
[Batch_Id] [int] IDENTITY(1,1) NOT NULL,
[SDetail_Id] [int] NULL,
[Destination_Id] [int] NULL,
[Batch_Number] [smallint] NULL,
[Line_Number] [smallint] NULL,
[Packing_Number] [smallint] NULL,
[Start_Time] [datetime] NULL,
[End_Time] [datetime] NULL,
[Status] [smallint] NULL,
[Batch_Note] [varchar](1000) NULL,
[Employee_Number] [smallint] NULL,
[PLC_BatchNumber] [smallint] NULL,
[Packing_BatchLetter] [varchar](3) NULL,
[Number_Bags] [smallint] NULL,
[Abort_Status] [bit] NULL,
[Return_Bags] [smallint] NULL
) ON [PRIMARY]

GO
SET ANSI_PADDING OFF 
```

错误发生在执行上。为了使它更加混乱，完全相同的 UPDATE 直接在 SQL 中工作，我还可以在同一台机器上的单独应用程序中的其他 VB 代码中更新该表（尽管使用 ADODB 连接）。

有任何想法吗？我在这里很困惑。提前致谢。

杰森

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-05-16T14:59:50.567

我认为问题在于您需要在更新包含 Identity 字段的 SQL Server 表时使用 dbSeeChanges 选项。此外，这可能是您的疏忽，但我看不出您将 MyDB 设置为什么。

```
Dim MyDB As DAO.Database
Set MyDB = CurrentDb
Dim sSQL As String
sSQL = "UPDATE tblBMS_Batch SET [Status] = 70 WHERE Batch_ID = 108582"
MyDB.Execute sSQL, dbFailOnError + dbSeeChanges
Set MyDB = Nothing 
```

我在网上查看了几个地方，令我惊讶的是，Status 这个词实际上不是 SQL Server 或 MS Access 中的保留字，但我还是把括号括起来，以防万一。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-05-16T11:01:10.230

你能试试这个SQL：

```
UPDATE tblBMS_Batch SET Status = '70' WHERE Batch_ID = '108582' 
```

字段存储为数字还是文本？如果是文本，那么上面的内容可能会起作用，因为 Access 对它的语法很严格，而 MS SQL 可以在 SQL 中的文本/数字字段之间进行补偿，只要值匹配（我认为总是一个很好的接触）

或者，如果此 SQL 必须通过 Access 运行，那么您可以将其作为对 SQL 服务器的传递查询运行，然后它应该以与在服务器上执行它时相同的方式运行。

# javascript - 如何将嵌套的 for 循环转换为递归？

> ID：10609667
> 
> 赞同：0
> 
> 时间：2012-05-15T22:26:39.107
> 
> 标签：javascript, node.js

我从 Memcached 中获取了一些数据，但是 nodejs 的异步性完全让我无法理解。我想将所有结果放入一个对象中。

这是我通常会做的：

```
for( x = startX; x <= endX; x++ )
{
  for( y = startY; y <= endY; y++ )
  {
    oData[ x + '_' + y ] = Db.get( x + '_' + y );
  } 
} 
```

但我不知道如何

该`Db.get()`函数需要一个键和一个回调 ( `function(error, result) {}`)

这只会增加 x ...

```
var onGet = function (error, result)
{
  x++;
  if(!error && result !== null) 
  {
    oData[ x + '_' + y ] = result
  }
};

Db.get(x + '_' + y, onGet); 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-05-15T22:51:33.560

这不是递归问题，而是“异步问题”。您的问题是 NodeJS 异步访问 memcached 而您的程序样式代码没有。因此，您需要以不同的方式思考问题。

```
function getMemcacheData(key, data)
{
    DB.get(key, function(err, result)
    {
        if (err) return false;

        data[ key ] = result;
    })
}

var oData = {};

for (var x = startX; x <= endX; x++)
{
    for (var y = startY; y <= endY; y++)
    {
        var key = x + "_" + y;
        getMemcacheData(key, oData);
    }
} 
```

这会起作用，但是 - 你还有另一个问题。您无法知道您的 MemcacheD 数据何时加载到`oData`中，您只需要坐等猜测。有办法解决这个问题；但我最喜欢的方法是使用一个名为[`async`](https://github.com/caolan/async).

使用异步，您可以这样做：

```
var syncStack = [],
    oData = {};

for (var x = startX; x <= endX; x++)
{
    for (var y = startY; y <= endY; y++)
    {
        (function(key)
        {
            syncStack.push(function(callback)
            {
                DB.get(key, function(err, result)
                {
                    /** If you don't care about data not being loaded 
                    you do this: */
                    if (!err)
                    {               
                        data[ key ] = result;
                    }

                    callback();

                    /** If you do care, and you need to terminate if 
                    you don't get all your data, do this: */
                    if (err)
                    {
                        callback(err);
                        return false;
                    }

                    data[ key ] = result;

                    callback();
                })                    
            });
        })(x + "_" + y);  
    }
}

async.parallel(syncStack, function(error)
{
    //this is where you know that all of your memcached keys have been fetched.
    //do whatever you want here.

    //if you chose to use the 2nd method in the fetch call, which does
    //"callback(error)" error here will be whatever you passed as that
    //err argument
}); 
```

这段代码实际上在做的是创建一个函数数组，每个函数调用`Db.get`特定键的方法，并将结果添加到`oData`变量中。

创建函数数组后，我们使用`async`库的`parallel`方法，该方法接受一个函数数组并并行调用它们。这意味着您的代码将一次性向 memcached 发送一堆请求以获取您的数据。当每个函数完成时，它调用该`callback`函数，该函数告诉`async`库请求已完成。当所有这些都完成后，`async`调用您在调用中作为第二个参数提供的回调闭包`parallel`方法。调用该方法时，您要么知道 A. 出了点问题，并且您有错误要从中恢复，要么 B. 所有请求都已完成，您可能拥有或不拥有您请求的所有数据（请求的过期或过时的密钥， 管他呢）。从那里，你可以做任何你想做的事，知道你已经完成了所有你需要的钥匙的要求。

我希望这有帮助。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-05-16T05:56:26.083

并行获取：

```
function loadPoints(cb)
{
  var oData = {};
  for( x = startX; x <= endX; x++ )
  {
    for( y = startY; y <= endY; y++ )
    {
       var key = x + '_' + y;     
       num_points++;
       Db.get(key, function(err, val) {
         if (err)
           return cb(err);

         oData[key] = val;
         num_points--;
         if (num_points === 0)
            cb(null, oData);         
       });
    } 
  }
} 
```

顺序获取：

```
function loadPoints(cb)
{
   var oData = {};

   function loadPoint(x, y)
   {
      var key = x + '_' + y;
      Db.get(key, function(err, val) {
         if (err)
           return cb(err);
         oData[key] = val;
         if (x + 1 < endX)
            return loadPoint(x + 1, y);
         else if (y + 1 < endY)
            return loadPoint(startX, y+1);
         else
            cb(null, oData);
      });
   }
   loadPoint(startX, startY);
} 
```

# drupal - D6 视图 field-override.tpl.php - [field] 令牌没有被覆盖输出？

> ID：10609669
> 
> 赞同：1
> 
> 时间：2012-05-15T22:26:44.657
> 
> 标签：drupal, views, themes, rewrite

我为我的一个 CCK 字段“标签”的所有实例创建了一个主题覆盖文件。

我排除了视图中的大多数字段，并在视图`[field_tokens]`中的最后一个字段中将它们组合在一起，因此我可以轻松地在一个字段中格式化我的输出。例子：

[✓] 重写*Global: Custom Text*的输出：

`<div>[field_1]: You're viewing my [tags] <strong>work</strong>!</div>`

但是，除非我取消选中“从显示中排除”复选框，否则我的覆盖主题字段模板文件**不会启动。**`[tags]`

换句话说，该字段仅在其自身的 Views-native、单独字段中正常输出时才会被覆盖，而*不是*在使用该字段的`[tags]`标记的任何地方。

这是视图故障吗？我确定在使用 .tpl 文件之前我已经覆盖了字段，并且在使用`$output`令牌的任何地方都已重写...

谁能解释一下？

# ios - 在 iOS 上使用 TouchXML 解析包括尖括号在内的文档

> ID：10609674
> 
> 赞同：0
> 
> 时间：2012-05-15T22:26:58.313
> 
> 标签：ios, touchxml

我正在尝试使用 iOS 的 TouchXML 解析 XML 文档。通常这很好用，但我试图解析的当前文档在实际数据中包含尖括号。例如：

```
<reference>
<title>Title < 5</title>
</reference> 
```

由于“无效的 startTag”错误，此操作失败。我可以在 TouchXML 中做些什么来解决这个问题，还是我需要在源材料中解决这个问题？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-05-21T23:04:19.907

这不是一个理想的解决方案，但我最终基本上在将 XML 文档传递给 TouchXML 之前对其进行了预处理。我使用正则表达式在一行中搜索多个尖括号（例如<<，或<...<，或<...<...<），并用< 或> 替换附加的尖括号。然后，在解析各个节点的数据时，我将这些符号替换为原始尖括号。

可能有一些方法可以告诉 TouchXML 忽略错误，但我找不到。

# android - 适用于 android 和 iphone 的 RabbitMQ 或 ActiveMQ

> ID：10609675
> 
> 赞同：3
> 
> 时间：2012-05-15T22:27:06.603
> 
> 标签：android, iphone, chat, activemq, rabbitmq

我需要为考试实现简单的聊天（android 和 ios 应用程序）。我需要根据您自己的经验提供建议，使用什么，RabbitMQ 或 ActiveMQ 或其他东西，以便在两个平台上以简单的方式实现？欢迎任何建议。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-09-08T03:11:51.847

ActiveMQ 也可以，您只需将核心库包含在您的 Android 项目中。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-05-15T22:43:19.717

RabbitMQ 适用于 Android。

参见例如：[http ://simonwdixon.wordpress.com/2011/06/03/getting-started-with-rabbitmq-on-android-part-1/](http://simonwdixon.wordpress.com/2011/06/03/getting-started-with-rabbitmq-on-android-part-1/)

我还建议使用 Google 查找更多示例，并查看 rabbitmq-discuss 邮件列表。

# python - Django 表单集的困难

> ID：10609683
> 
> 赞同：1
> 
> 时间：2012-05-15T22:28:01.883
> 
> 标签：python, django, django-forms, formset

我正在构建一个具有 Company、Employee 和 Ext 模型的 Django 应用程序：

```
class Company(models.Model):
    user = models.ForeignKey(User)
    name = models.CharField(max_length=30)
    ...

class Employee(models.Model):
    company = models.ForeignKey(Company)
    emp_name = models.CharField(max_length=15)
    ...

class Ext(models.Model):
    employee = models.ForeignKey(Employee)
    expiry_date = models.DateField(default=lambda:datetime.datetime.now()+datetime.timedelta(days=60))
    ... 
```

对于这些模型，我有以下表格：

```
class CompanyForm(ModelForm):
    class Meta:
        model = Company

class EmployeeForm(ModelForm):
    class Meta:
        model = Employee
        exclude = ('company')

class ExtForm(ModelForm):
    class Meta:
        model = Prize
    exclude = ('employee')

class EmployeeFormSet(BaseFormSet):

    def clean(self):
        if any(self.errors):
            return

        names = []

        for i in range(0, self.total_form_count()):
            form = self.forms[i]
            e_name = form.cleaned_data['emp_name']

            if e_name in names:
                raise forms.ValidationErrors("Employees must have unique names")

            names.append(e_name) 
```

我遇到了“Django Dynamic Formset”（http://code.google.com/p/django-dynamic-formset/），我已经成功地开始工作，允许我在模板中动态地将多个员工表单添加到我的员工表单集中：

```
<script type="text/javascript" src="{% static "js/jquery-1.4.2.min.js" %}"></script>
<script type="text/javascript" src="{% static "js/jquery.formset.js" %}"></script>
<script type="text/javascript">
    $(function() {
        $('#eForm tbody tr').formset();
    })
</script>
...
<form id="eForm" method="post" action="">
    {% csrf_token %}
            <table border="0" cellpadding="0" cellspacing="0">
            <tbody>
            {% for form in employee_formset.forms %}
            <tr>
                        <td>{{ form.emp_name }}</td></br>
                        ...
                    </tr>
                    {% endfor %}
                    </tbody>
                </table>
        {{ employee_formset.management_form }}
        <input id="submit" type="submit" name="submit" value="Submit" />
</form> 
```

我的目标是能够添加一个公司、一个或多个与该公司关联的员工，以及一个与这些员工中的一个关联的单个 Ext 对象，所有这些都在一个提交中。

我不确定如何解决这个问题。谁能指出我正确的方向？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-05-16T00:00:53.890

如果您的 ExtModel() 不需要任何用户输入，则：

表格.py

```
class CompanyForm(ModelForm):
    class Meta:
        model = Company

class EmployeeForm(ModelForm):

    ext = forms.BooleanField(initial=False)

    class Meta:
        model = Employee 
```

然后，在您的视图中，创建 CompanyForm 的单个实例，并使用`inlineformset_factory(Company, Employee, form=EmployeeForm)`.

保存表单集时：

```
if formset.is_valid():
    for form in formset:
        employee = form.save()
        if form.cleaned_data['ext'] == True
            Ext(employee=employee, ...).save() 
```

如果您需要用户输入更多 Ext 字段，并且对于任何给定职位的每个员工的输入相同，则为该数据呈现一个附加表单。如果不同员工的 Ext 数据不同，那么情况会更复杂。

# javascript - 如果歌剧 - 在 css 中有什么不同？

> ID：10609686
> 
> 赞同：2
> 
> 时间：2012-05-15T22:28:15.363
> 
> 标签：javascript, css, html

如果用户/访问者使用歌剧，有什么方法可以覆盖css中的某些内容并使用不同的大小？

例如，在 chrome、ff 和 safari 中，这很有效：

```
.section#search h3 a {
    background: url("../img/search.png") no-repeat 0 50%;
    padding: 0 0 0 25px;
    position: relative;
} 
```

但是在 Opera 中填充不是很好......我需要添加`top: 16px;`到它或将填充更改为`padding: 0 0 36px 25px;`

是否有像 IE 或 javascript 使用这样的“黑客”？没有想法...

我只需要为歌剧添加顶部或新填充。谢谢 ;）

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-05-15T22:31:44.897

您可以使用像[Modernizr](http://modernizr.com/)这样的 JavaScript 库来测试浏览器，并使用它添加的专门针对 Opera 的 css 类。

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2012-05-15T22:34:14.553

使用 conditional-css 工具，您可以定位 opera，但引擎很重要。conditional-css.com 解释说：

> Conditional-CSS 并不真正对用户使用的浏览器感兴趣，而是对用户浏览器使用的渲染引擎感兴趣。这就是为什么 Conditional-CSS 使用“Gecko”而不是众所周知的 Firefox 作为其浏览器条件之一的原因。同样对于 Safari 使用“Webkit”。这允许使用相同渲染引擎的其他浏览器接收相同的目标 CSS。此规则的例外情况适用于 IE（而不是使用“Trident”），因为这是 IE 条件注释使用的内容，而 Trident 并不特别为人所知。同样对于 Opera，由于只有 Opera 浏览器使用它的 Presto 渲染引擎，所以使用了 'Opera'。

[http://www.conditional-css.com/advanced](http://www.conditional-css.com/advanced)

他们写道，条件标签的形成如下：

```
[if {!} browser]
[if {!} browser version]
[if {!} condition browser version] 
```

并且浏览器名称如下：

```
IE - Internet Explorer
Gecko - Gecko based browsers (Firefox, Camino etc)
Webkit - Webkit based browsers (Safari, Shiira etc)
'SafMob' - Mobile Safari (iPhone / iPod Touch)
Opera - Opera's browser
IEMac - Internet Explorer for the Mac
Konq - Konqueror
IEmob - IE mobile
PSP - Playstation Portable
NetF - Net Front 
```

因此，根据他们的说法，从逻辑上讲，您可以通过以下方式进行定位： `[if Opera]`

像这样在 CSS 块中：

```
[if Opera] .box {  
    width: 500px;  
    padding: 100px 0;  
} 
```

或者像这样的 CSS 包括：

```
<!--[if Opera]>

<![endif]--> 
```

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-05-15T22:37:06.037

什么版本和类型的歌剧？你可以使用这个媒体查询

@media not all 和 (-webkit-min-device-pixel-ratio:0) { } 以 10、10.5、11 和 11.6 为目标

在这里查看：注意，我只在 chrome19 和 Opera 11.6 中查看过[http://jsfiddle.net/jalbertbowdenii/fw94a/](http://jsfiddle.net/jalbertbowdenii/fw94a/)

更好的

x:-o-prefocus, p{}

[http://jsfiddle.net/jalbertbowdenii/6pRPC/](http://jsfiddle.net/jalbertbowdenii/6pRPC/)

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2012-05-15T22:38:26.263

在您计划使用变通方法和技巧之前，请考虑以下事项：

1.  您的页面是否处于严格模式？如果没有，请在页面的第一行添加一个文档类型：

    ```
    <!DOCTYPE html> 
    ```

    否则，您的页面处于怪异模式，这是跨浏览器不一致的主要原因。

2.  尝试使用[CSS 重置](http://html5doctor.com/html-5-reset-stylesheet/)。这应该可以消除浏览器之间的小不一致，如填充、边距、对齐等。在任何其他样式之前加载此样式。

# java - Android 初学者：java.lang.NullPointerException

> ID：10609689
> 
> 赞同：0
> 
> 时间：2012-05-15T22:28:31.657
> 
> 标签：java, android, eclipse, android-layout, android-intent

我是 android/java 新手，所以请多多包涵。我的代码之前运行良好，但自从我添加了 for() 循环后，我就收到了 NullPointerException。有任何想法吗？

```
public class PreferencesActivity extends Activity {

SharedPreferences settings;
SharedPreferences.Editor editor;
static CheckBox box, box2;

private final static CheckBox[] boxes={box, box2};
private final static String[] checkValues={"checked1", "checked2"};

@Override
public void onCreate(Bundle savedInstanceState) {
    super.onCreate(savedInstanceState);
    setContentView(R.layout.main);

    box=(CheckBox)findViewById(R.id.checkBox);
    box2=(CheckBox)findViewById(R.id.checkBox2);

    settings= getSharedPreferences("MyBoxes", 0);
    editor = settings.edit();

    if(settings != null){

    for(int i =0;i<boxes.length; i++)
        boxes[i].setChecked(settings.getBoolean(checkValues[i], false));   
    }

}

@Override
protected void onStop(){
   super.onStop();

   for(int i = 0; i <boxes.length; i++){           
   boolean checkBoxValue = boxes[i].isChecked();        
   editor.putBoolean(checkValues[i], checkBoxValue);
   editor.commit();       
   }

    }
} 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-05-15T22:35:03.140

您初始化 和 的值`box`（`box2`因为`null`这是未明确分配时的默认值）。`Checkbox`然后在创建数组时使用这些值`boxes`。因此，`boxes`有两个空值。然后重新分配 和 的`box`值`box2`。`boxes`请注意，这对数组中的值没有影响。因此，当您尝试访问数组中的值时，您会得到一个`NullPointerException`.

在为和分配值`boxes` *后*设置其中的值。`box``box2`

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-05-16T03:46:28.557

这是固定代码。希望它有所帮助：

```
public class PreferencesActivity extends Activity {

    SharedPreferences settings;
    SharedPreferences.Editor editor;
    static CheckBox box, box2; // box and box2 are null when class is loaded to DalvikVM

    private final static CheckBox[] boxes={null, null};
    private final static String[] checkValues={"checked1", "checked2"};

    @Override
    public void onCreate(Bundle savedInstanceState) {
        super.onCreate(savedInstanceState);
        setContentView(R.layout.main);

        box=(CheckBox)findViewById(R.id.checkBox);
        box2=(CheckBox)findViewById(R.id.checkBox2);

        // assign CheckBox instances to boxes array
        boxes[0] = box;
        boxes[1] = box2;

        settings= getSharedPreferences("MyBoxes", 0);
        editor = settings.edit();

        if(settings != null){

        for(int i =0;i<boxes.length; i++)
            boxes[i].setChecked(settings.getBoolean(checkValues[i], false));   
        }

    }

    @Override
    protected void onStop() {
        super.onStop();

        for(int i = 0; i <boxes.length; i++){           
            boolean checkBoxValue = boxes[i].isChecked();        
            editor.putBoolean(checkValues[i], checkBoxValue);
            editor.commit();       
        }
    }
} 
```

# android - 是否有任何类被视为 android 中的上下文，或者是否有一些特定的事情必须做？

> ID：10609691
> 
> 赞同：1
> 
> 时间：2012-05-15T22:28:44.507
> 
> 标签：android, sqliteopenhelper, android-context

我有这个类，省略了代码以使其更具可读性：

```
import android.app.Activity;
import android.content.Intent;
import android.os.Bundle;
import android.view.Menu;
import android.view.MenuInflater;
import android.view.MenuItem;
import android.widget.ListView;
public class TimeTrackerActivity extends Activity {

    //some code here
    public void onCreate(Bundle savedInstanceState) {
    super.onCreate(savedInstanceState);
    setContentView(R.layout.main);

    ListView listView = (ListView) findViewById(R.id.times_list);

    listView.setAdapter(timeTrackerAdapter);

    TimeTrackerOpenHelper openHelper = new TimeTrackerOpenHelper(this);
    //my error with line of code right above saying
    //the constructor of TimeTrackerOpenHelper(TimeTrackerActivity) is undefined

    }
    //more code here
} 
```

我评论了我的错误在哪里。我在网上查看了其他示例，其他所有人都将其发送到扩展 SQLiteOpenHelper 的类中，这使我认为它应该可以工作。但它不是。我的代码如下：

```
import android.content.Context;
import android.database.sqlite.SQLiteDatabase;
import android.database.sqlite.SQLiteOpenHelper;
public class TimeTrackerOpenHelper extends SQLiteOpenHelper {

TimeTrackerOpenHelper(Context context) {
    super(context, "timetracker.db", null, 1);
}

public void onCreate(SQLiteDatabase database) {/*stuff*/}

public void onUpgrade(SQLiteDatabase datbase, int oldVersion, int newVersion) {/*stuff*/}

} 
```

我的假设是错误的吗，我是否遗漏了什么。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-05-15T22:35:15.193

由于`Activity`派生自`android.content.Context`，因此只要`Context`使用的类`TimeTrackerOpenHelper(Context context)`也是`android.content.Context`，而不是`Context`来自不同包的类，您的代码就应该编译没有错误。

**编辑**

感谢 superfell 的评论，我认为问题在于`TimeTrackerOpenHelper`' 构造函数的可见性。尝试公开：

```
public TimeTrackerOpenHelper(Context context) { 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-05-15T22:33:12.887

Android Activity 是 Context 的子类。请参阅[活动源](http://grepcode.com/file/repository.grepcode.com/java/ext/com.google.android/android/2.2_r1.1/android/app/Activity.java)。不，并不是每个类都被视为 Android 中的上下文。你必须扩展 Context 但我不认为你会想要执行这样的事情并且需要这样做。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-05-15T22:34:21.227

没有唯一包含上下文引用的“类”是活动和服务。例如，如果您使用广播接收器，您会在侦听器方法中收到上下文引用。

# .net - 如何在两个可执行文件之间传递隐藏数据？

> ID：10609693
> 
> 赞同：0
> 
> 时间：2012-05-15T22:28:55.597
> 
> 标签：.net, vb6

我们有一个遗留的 VB6 应用程序，我们已将许可代码从该应用程序迁移到一个 Net 可执行文件。之所以选择单独的可执行文件，是因为此代码需要提升。Net 可执行文件需要获取 VB6 的版本号，以检查该版本的使用是否符合许可证。我们正在努力解决如何将隐藏或加密数据从 VB6 应用程序传递到许可网络应用程序。由于 VB6 应用程序在当前用户的凭据下运行，而 Net 应用程序需要提升，通过注册表传递此信息并不能可靠地工作。

请就如何做到这一点提供一些指导！

编辑：给出的链接和建议是有用的和有启发性的。但是，在流程边界上只获取一个隐藏参数太麻烦了。我以不同的方式实现它。
谢谢！

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-05-17T04:22:57.940

您始终可以在启动时使用命令行参数将敏感数据传递给 .NET 可执行文件。您可以使用[CryptoSys](http://www.cryptosys.net/)或 .NET Framework 加密类等免费 API 来加密/解密敏感的许可证数据。

VB6 应用程序可以使用 COM 互操作调用 CryptoSys 或 .NET 密码库，当然 .NET 应用程序可以直接调用它们。

# javascript - Backbone.js 删除事件未触发

> ID：10609694
> 
> 赞同：1
> 
> 时间：2012-05-15T22:28:57.157
> 
> 标签：javascript, backbone.js

我有以下视图，我试图将点击事件绑定到删除按钮，但它似乎没有触发任何东西。在控制台中没有收到任何错误，它似乎没有绑定“点击”事件。

span.delete 元素深深嵌套在一堆其他元素中，不确定这是否重要，我也尝试将它作为直接子元素，但仍然不行。

```
var ListRow = Backbone.View.extend(
{
    events:
    {
        'click span.delete': 'remove'
    },

    initialize: function()
    {
        _.bindAll(this, 'render', 'unrender', 'remove');

        this.model.bind('remove', this.unrender);
    },

    render: function()
    {
        this.el = _.template($('#tpl-sTableList_' + key + 'Row').html());

        return this;
    },

    unrender: function()
    {
        $(this.el).fadeOut();
    },

    remove: function()
    {
        this.model.destroy();
    }
}); 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-05-15T22:38:48.343

模型上没有默认`remove`事件，只有一个来自集合的删除事件，所以如果你想在模型从集合中删除时删除视图，最好放一个

```
this.collection.bind('remove', this.onRemove, this); 
```

在您的 ListView 中（因为我假设您根据您的示例使用 ListView 和 ListItemView ），然后您的`onRemove`方法将模型作为参数传递，以便您可以找到与之关联的视图。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-05-16T16:29:03.203

发现问题了，是因为我只是设置了el对象，没有渲染它，所以不是：

```
this.el = 
```

应该

```
$(this.el).html(); 
```

否则，一切都按预期工作。

# ruby-on-rails - Rails 3.2 session_id 永远不会改变

> ID：10609695
> 
> 赞同：0
> 
> 时间：2012-05-15T22:29:03.263
> 
> 标签：ruby-on-rails, session

我在我的 Rails 应用程序之上运行了一个主干应用程序，它发出了许多 AJAX 请求。奇怪的是，我的浏览器存储的会话 ID cookie 似乎永远不会改变。我可以看到正在发出的下一个请求和返回成功的回复。然而，响应仍然挂在旧的会话 ID 上，因此我无法以任何方式注销或更改用户状态。

以下是发送标头的示例：

对 /login.json 的请求：

```
Accept:*/*
Accept-Charset:ISO-8859-1,utf-8;q=0.7,*;q=0.3
Accept-Encoding:gzip,deflate,sdch
Accept-Language:en-US,en;q=0.8
Connection:keep-alive
Cookie:_session_id=BAh7CEkiD3Nlc3Npb25faWQGOgZFRkkiJWY0YTI1Y2I5ZDE5MTgyYjJmN2MzMzZiMmE5ZWE2ZTAyBjsAVEkiEF9jc3JmX3Rva2VuBjsARkkiMTB1ZEozbzJCbUl4ZjluUDdCZVVEOXBhL0ZUeXNVRnFiMlFLblFTVUZPNGM9BjsARkkiDHVzZXJfaWQGOwBGaQg%3D--cf57849d4a4c0cbc5608574d959a772080b3afc5
Host:localhost:3000
If-None-Match:"7363e85fe9edee6f053a4b319588c086"
Referer:http://localhost:3000/
User-Agent:Mozilla/5.0 (Macintosh; Intel Mac OS X 10_7_4) AppleWebKit/536.5 (KHTML, like Gecko) Chrome/19.0.1084.46 Safari/536.5
X-CSRF-Token:0udJ3o2BmIxf9nP7BeUD9pa/FTysUFqb2QKnQSUFO4c=
X-Requested-With:XMLHttpRequest 
```

来自 /login.json 的响应：

```
Cache-Control:max-age=0, private, must-revalidate
Date:Tue, 15 May 2012 22:44:46 GMT
Etag:"7363e85fe9edee6f053a4b319588c086"
Server:WEBrick/1.3.1 (Ruby/1.9.2/2011-07-09)
Set-Cookie:_session_id=BAh7B0kiD3Nlc3Npb25faWQGOgZFRkkiJWY0YTI1Y2I5ZDE5MTgyYjJmN2MzMzZiMmE5ZWE2ZTAyBjsAVEkiEF9jc3JmX3Rva2VuBjsARkkiMTB1ZEozbzJCbUl4ZjluUDdCZVVEOXBhL0ZUeXNVRnFiMlFLblFTVUZPNGM9BjsARg%3D%3D--b16d1f8e4bba3c86d5e3e9ece1ae50f1ad898d00; path=/; HttpOnly
X-Request-Id:8e278bdd3504257bcb9956e068ca3ca3
X-Runtime:0.014739
X-Ua-Compatible:IE=Edge 
```

请注意，它给了我一个新的会话 ID。然而，当我提出下一个要求时...

```
Accept:application/json, text/javascript, */*; q=0.01
Accept-Charset:ISO-8859-1,utf-8;q=0.7,*;q=0.3
Accept-Encoding:gzip,deflate,sdch
Accept-Language:en-US,en;q=0.8
Connection:keep-alive
Cookie:_session_id=BAh7CEkiD3Nlc3Npb25faWQGOgZFRkkiJWY0YTI1Y2I5ZDE5MTgyYjJmN2MzMzZiMmE5ZWE2ZTAyBjsAVEkiEF9jc3JmX3Rva2VuBjsARkkiMTB1ZEozbzJCbUl4ZjluUDdCZVVEOXBhL0ZUeXNVRnFiMlFLblFTVUZPNGM9BjsARkkiDHVzZXJfaWQGOwBGaQg%3D--cf57849d4a4c0cbc5608574d959a772080b3afc5
Host:localhost:3000
If-None-Match:"53135bfd970c6b34f39ea3c4780ed240"
Referer:http://localhost:3000/
User-Agent:Mozilla/5.0 (Macintosh; Intel Mac OS X 10_7_4) AppleWebKit/536.5 (KHTML, like Gecko) Chrome/19.0.1084.46 Safari/536.5
X-CSRF-Token:0udJ3o2BmIxf9nP7BeUD9pa/FTysUFqb2QKnQSUFO4c=
X-Requested-With:XMLHttpRequest 
```

cookie 从未改变。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-05-17T15:57:51.337

我想到了。我有一个异步。请求同时触发，因此浏览器永远没有机会获得正确的会话 ID。

# c# - 如何在 C# 中将命名空间仅添加到 ref 元素？

> ID：10609696
> 
> 赞同：1
> 
> 时间：2012-05-15T22:29:03.967
> 
> 标签：c#, xml, namespaces, linq-to-xml, xelement

我有一个包含我想要的内容的 XElement。但是，我只想向 ref 元素添加命名空间前缀。这在 C# 中可能吗？

例如，原始 XML 如下所示：

```
<Root>
  <Element1 />
  <Element2 />
  <Element3>
    <Element3_Child1 />
    <Element3_Child2 />
  </Element3>
  <Element4 />
  <Element5>
    <Element5_Child1>
       <Element5_Child1_Child51 />
    </Element5_Child1>
  </Element5>
</Root> 
```

我想添加一个命名空间前缀，以便 XML 如下所示

```
<Root>
  <Element1 />
  <Element2 />
  <ns:Element3>
    <Element3_Child1 />
    <Element3_Child2 />
  </Element3>
  <Element4 />
  <ns:Element5>
    <ns:Element5_Child1>
       <Element5_Child1_Child51 />
    </Element5_Child1>
  </Element5>
</Root> 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-05-16T14:21:37.307

You can do as stated here : [http://www.w3schools.com/xml/xml_namespaces.asp](http://www.w3schools.com/xml/xml_namespaces.asp)

```
<root
    xmlns:foo="http://www.example.org/foo"
    xmlns:bar="http://www.example.org/bar"> 
```

However, I'm pretty sure you'll need a valid URI and that you can't "fake" one. Otherwise, the namespace will be invalid. But you can test and let us know.

# django - 在 Django 中有效地删除孤立的 m2m 对象/标签

> ID：10609699
> 
> 赞同：6
> 
> 时间：2012-05-15T22:29:40.927
> 
> 标签：django, many-to-many, orphan, orphaned-objects

我有两个模型 - 照片和标签 - 通过 ManyToManyField 连接。

```
class Photo(models.Model):
    tags = models.ManyToManyField(Tag)

class Tag(models.Model):
    lang = models.CharField(max_length=2)
    name_es = models.CharField(max_length=40)
    name_en = models.CharField(max_length=40) 
```

每隔一段时间，我们就会得到孤立的标签，任何照片都不再引用这些标签。有没有删除这些标签的有效方法？我知道这个答案： [Django: delete M2M orphan entries?](https://stackoverflow.com/questions/4381928/django-delete-m2m-orphan-entries)

我们的解决方案目前看起来是这样的：

```
for tag in Tag.objects.all():
    if not tag.photo_set.select_related(): tag.delete() 
```

但是，随着数据库的增加，这个脚本的运行时间变得非常高：-P 有没有一种有效的方法可以从标签表中获取所有标签 ID 的列表，然后从多对多中获取所有标签 ID 的列表表来创建交集列表？

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-05-16T02:45:07.800

尝试带有中间表的子查询

```
qs = Tag.objects.exclude(pk__in=Book.tags.through.objects.values('tag'))

# then you could
qs.delete()

# or if you need to trigger signal per item
for x in qs:
    x.delete() 
```

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-11-12T23:58:19.640

我们不得不进一步提高这项任务的性能，所以我稍微修改了 okm 的解决方案：

```
 all_tag_pks = Tag.objects.values_list('pk', flat=True)
    used_tag_pks = Photo.tags.through.objects.values_list('tag', flat=True)
    Tag.objects.filter(pk__in=list(set(all_tag_pks) - set(used_tag_pks))).delete() 
```

这样，对数据库的查询变得更小更快。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2018-11-12T18:05:18.237

我找到了一种“实时”执行此操作的方法：

```
from django.db.models.signals import m2m_changed
from django.dispatch import receiver

class Photo(models.Model):
    tags = models.ManyToManyField(Tag)

class Tag(models.Model):
    lang = models.CharField(max_length=2)

@receiver(m2m_changed, sender=Photo.tags.through)
def delete_orphean_dateranges(sender, **kwargs):
    # when something is removed from the m2m:
    if kwargs['action'] == 'post_remove':  
        Tag.objects.filter(pk__in=kwargs['pk_set'], photo_set=None).delete()
        # select removed tags and check if they are not linked
        # to any Photo, and delete it 
```

这样，每次从 m2m 中删除标签时编辑 Photo 的 m2m 时，都会调用此函数。

# asp.net - 在 asp.NET 正则表达式验证控件中重用表达式

> ID：10609701
> 
> 赞同：3
> 
> 时间：2012-05-15T22:29:42.560
> 
> 标签：asp.net, ascx

我在 ascx 文件中有这个：

```
<asp:textbox ID="AddHourlyRate" runat="server" width="55px" />
<asp:RegularExpressionValidator  ID="AddHourlyRateRegexValidator"
    ErrorMessage="Please enter a valid charge rate (whole number only)" 
    ValidationExpression="^\$?[0-9]+(\.[0]{2})?$" ControlToValidate="AddHourlyRate" 
    Display="Dynamic" runat="server" /> 
```

如何在无需复制粘贴正则表达式的情况下重用`ValidationExpression`in other ？`asp:RegularExpressionValidator`我是 asp.NET 的新手。

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2012-05-15T22:44:35.313

为每个正则表达式创建一个带有 const 字符串的类，我使用该解决方案来解决您的确切问题。该类位于多个项目之间共享的公共程序集中。您可能会在其他一些地方使用正则表达式，而不仅仅是验证器控件。

像这样的东西：

```
public class RegularExpressions
{
  public const string TelephoneValidation = @"^[0-9 ]+$";
  public const string IntegerValidation = @"^\d+$";
} 
```

然后，您可以从后面的代码中设置验证器表达式：

```
validator.ValidationExpression = RegularExpressions.IntegerValidation; 
```

或在标记中：

```
<%@ Import Namespace="RegularExpression.Class.Namespace" %>  
.
.
.  
<asp:RegularExpressionValidator  ID="AddHourlyRateRegexValidator"
        ErrorMessage="Please enter a valid charge rate (whole number only)" 
        ValidationExpression="<%# RegularExpressions.IntegerValidation %>" ControlToValidate="AddHourlyRate" 
        Display="Dynamic" runat="server" /> 
```

当然，在导入指令中编写适当的命名空间。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-05-15T22:37:47.833

您可以重复使用您的正则表达式（将其提取到常量并在 Page_Load 函数中为所有必需的正则表达式验证器设置）

```
public const string WholeNumbersValidation = @"^\$?[0-9]+(\.[0]{2})?$";

protected void Page_Load(object sender, EventArgs e)
{
   AddHourlyRateRegexValidator.ValidationExpression = WholeNumbersValidation;
   AddHourlyRateRegexValidator.ErrorMessage= "Please enter a valid charge rate (whole number only)";
   validatorIdForNextField.ValidationExpression = WholeNumbersValidation;
   validatorIdForNextField.ErrorMessage= "Error message text 2";

} 
```

[，但您不能对几个字段重复使用一个正则表达式 ASP.NET 验证器，因为在ControlToValidate](http://msdn.microsoft.com/en-us/library/system.web.ui.webcontrols.basevalidator.controltovalidate)属性中不接受多个 ID 。

您可以编写自己的客户端验证函数，在提交时一次性验证所有文本框以解决此问题，并且您还应该为服务器端编写验证函数。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-05-15T22:37:53.150

您是否考虑过将表达式添加为项目级设置，然后在代码隐藏中设置“ValidationExpression”？

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2012-05-15T22:41:40.387

您当然可以执行以下操作：

```
private RegularExpressionValidator GetValidatorControl(string controlToValidate, string errorMessage)
{

    RegularExpressionValidator validator = new RegularExpressionValidator();
    validator.ID = String.Format("{0}RegExValidator", controlToValidate);
    validator.ValidationExpression = @"^\$?[0-9]+(\.[0]{2})?$";
    validator.ControlToValidate = controlToValidate;
    validator.ErrorMessage = errorMessage;
    return validator;

} 
```

而且，在 Page_Load 事件或类似事件中，您可以这样调用它：

```
Page.Controls.AddAt(Page.Controls.IndexOf(AddHourlyRate) + 1, GetValidatorControl(control.ID, "my validation message")); 
```

这会将验证器控件添加到您的页面，并且您的表达式将仅在此处定义（它可以作为静态方法放置到另一个类中并在整个项目中共享）。

您还可以使用此[Stack Overflow 答案](https://stackoverflow.com/questions/2209854/find-all-child-controls-of-specific-type-using-enumerable-oftypet-or-linq)中的方法来获取页面上的所有 RegEx 验证器，然后在每个验证器上设置 ValidationExpression。例如，如果您将所有控件包装在 Panel 中（在我的示例中使用 RootPanel 的 ID）或类似的容器控件，那么您可以：

```
IEnumerable<Control> validators = RootPanel.FlattenChildren();

IEnumerator<Control> enumerator = validators.GetEnumerator();

while (enumerator.MoveNext() == true)
{
    if (enumerator.Current is RegularExpressionValidator) //Only interested in RegularExpressionValidators. You could even filter this further by naming them consistently and checking for a fragment of the ID here.
    {
        ((RegularExpressionValidator)enumerator.Current).ValidationExpression = @"^\$?[0-9]+(\.[0]{2})?$"; //Load from config if necessary!
    }
} 
```

要使用 FlattenChildren 方法，请将其放入项目中某处的公共静态类中，并使用适当的 using 指令引用它。有关.Net 中的扩展方法，请参阅[本文。](http://msdn.microsoft.com/en-us/library/bb383977.aspx)

无论发生什么情况，每个控件都需要一个 RegularExpressionValidator。当然，您的另一个选择是在 javascript 或 PostBack 上手动验证这些。

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2012-05-15T22:43:29.587

您将不得不使用多个验证器，但您应该能够将表达式作为值存储在 web.config 文件中，然后通过内联 C# 访问它。

在 web.config 中：

```
<appSettings>
  <add key="myRegExString" value="^\$?[0-9]+(\.[0]{2})?$" />
</appSettings> 
```

在 YourPage.aspx 中：

```
<asp:textbox ID="AddHourlyRate" runat="server" width="55px" />
<asp:RegularExpressionValidator  ID="AddHourlyRateRegexValidator"
    ErrorMessage="Please enter a valid charge rate (whole number only)" 
    ValidationExpression="<% = ConfigurationSettings.AppSettings["myRegExString"]%>" ControlToValidate="AddHourlyRate" 
    Display="Dynamic" runat="server" /> 
```

# php - 将不规则的 CSV 数据提取到结构化数组中 - 尝试使用 PHP

> ID：10609710
> 
> 赞同：0
> 
> 时间：2012-05-15T22:30:20.403
> 
> 标签：php, arrays, csv

使用 PHP 尝试解决这个问题，但对其他解决方案（Python、Bash 等）持开放态度。

我有以下格式的 csv 数据：注意：商店名称 id（第 1 和 6 行）始终为 10 位产品 id（col1，第 2、3、4 和 7、8、9、10、11 行）始终为 7 位.

```
Store name 0123456789,,,
0123456,product desc,1,1.00
1234567,product desc2,1,2.00
2345678,product desc3,1,3.00
Ship Total,6.00,,
Store name2 9876543210,,,
0123456,product desc,4,1.00
1234567,product desc2,2,2.00
2345678,product desc3,1,3.00
3456789,product desc4,3,4.00
45678901,product desc5,1,5.00
Ship Total,28.00,, 
```

所需的格式是：

```
0123456789,0123456,product desc,1,1.00
0123456789,1234567,product desc2,1,2.00
0123456789,2345678,product desc3,1,3.00
9876543210,0123456,product desc,4,1.00
9876543210,1234567,product desc2,2,2.00
9876543210,2345678,product desc3,1,3.00
9876543210,3456789,product desc4,3,4.00
9876543210,45678901,product desc5,1,5.00 
```

我有一个程序来解析上述格式的数据。

我已经将商店放入一个数组中，并将交易放入另一个数组中......只需将它们放在一起。

这是我到目前为止所得到的。

```
 ```
$csv = array();
$file = fopen($datafile, 'r');

while (($result = fgetcsv($file)) !== false)
{
    $csv[] = $result;
}

fclose($file);

foreach ($csv as $key => $value) { 
    if (preg_match('/\d{10}$/', $value[0],$store)) {
        $stores[$key] .= $store[0];
    }
}
print_r($stores);

foreach ($csv as $key => $value) {
    if (preg_match('/^\d{7}/', $value[0],$transaction)) {
        $transactions[$key] = array("Item"=>$value[0],"Desc"=>$value[1],"Qty"=>$value[2],"Price"=>$value[3]);
    }
}
print_r($transactions) 
``` print_r 结果：

```
 ```
Array
(
    [0] => 0123456789
    [5] => 9876543210
)

Array
(
    [1] => Array
        (
            [Item] => 0123456
            [Desc] => product desc
            [Qty] => 1
            [Price] => 1.00
        )
...
... arrays 2,3,4,6,7,8,9....
...

    [10] => Array
        (
            [Item] => 45678901
            [Desc] => product desc5
            [Qty] => 1
            [Price] => 5.00
        )
) 
``` 回答后编辑。这是完美的工作。

[代码]

```
$file = fopen($datafile, 'r'); 

$txns = array();
$LastStore = '';
while (($result = fgetcsv($file)) !== false) 
{ 
    if (preg_match('/\d{10}$/', $result[0],$store)) { 
        $LastStore = $store;
    } elseif (preg_match('/[A-Za-z]+/', $result[0])) {
        continue;
    } else {
        $txns[] = array("Store"=>$LastStore[0], "Item"=>$result[0],"Desc"=>$result[1],"Qty"=>$result[2],"Price"=>$result[3]);
    }
} 
fclose($file); 
```

[/代码]

            回答 #1

赞同：0

时间：2012-05-15T22:48:11.593

```
$file = fopen($datafile, 'r'); 

$Out = '';
$LastStore = '';
while (($result = fgetcsv($file)) !== false) 
{ 
    if (preg_match('/\d{10}$/', $result[0],$store)) { 
        $LastStore = $store;
    } elseif (preg_match('/^\d{7}/', $result[0],$transaction)) { {
        $aT = array("Store"=>$LastStore, "Item"=>$transaction[0],"Desc"=>$transaction[1],"Qty"=>$transaction[2],"Price"=>$transaction[3])
        $Out .= implode(',', $aT) . "\n";

    }
} 
fclose($file); 

// Output as file (if this is as intended). Otherwise you have $Out to be the CSV string you need.    
file_put_contents($OutFileName, $Out); 
```

或者，如果您想要一个大数组中的所有内容

```
$file = fopen($datafile, 'r'); 

$aT = array();
$LastStore = '';
while (($result = fgetcsv($file)) !== false) 
{ 
    if (preg_match('/\d{10}$/', $result[0],$store)) { 
        $LastStore = $store;
    } elseif (preg_match('/^\d{7}/', $result[0],$transaction)) { {
        $aT[] = array("Store"=>$LastStore, "Item"=>$transaction[0],"Desc"=>$transaction[1],"Qty"=>$transaction[2],"Price"=>$transaction[3])
    }
} 
fclose($file); 
```

            回答 #2

赞同：0

时间：2012-05-15T23:19:26.220

我会建议这样的事情

```
$handle = @fopen($datafile, "r");
if ($handle) {
    $Out = '';
    $Store = '';
    while (($buffer = fgets($handle)) !== false) {
        if (substr($buffer, 0, 5) == 'Store') {
            preg_match('/\d{10}/', $buffer, $storeId);
            $Store = $storeId[0] . ',';
        } else if (substr($buffer, 0, 4) == 'Ship') {
            // ignore
        } else {
            $Out .= $Store . $buffer . "\n";
        }
    }
}
fclose($handle);

file_put_contents('Results.txt', $Out); 
```

```

```

# python - for循环，Python中的重复计算

> ID：10609711
> 
> 赞同：0
> 
> 时间：2012-05-15T22:30:28.437
> 
> 标签：python, for-loop, repeat

```
from random import uniform

prob = [0.25,0.30,0.45]

def onetrial(prob):
    u=uniform(0,1)
    if 0 < u <= prob[0]:
        return 11
    if prob[0] < u <= prob[0]+prob[1]:
        return 23
    if prob[0]+prob[1] < u <= prob[0]+prob[1]+prob[2]:
        return 39

print onetrial(prob) 
```

我想知道如何使用一些 for 循环技术来减少 def 中的重复部分。谢谢。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-05-15T22:41:42.150

以下等效于您当前的代码，它使用 for 循环：

```
from random import uniform

prob = [0.25, 0.30, 0.45]

def onetrial(prob):
    u = uniform(0, 1)
    return_values = [11, 23, 39]
    total_prob = 0
    for i in range(3):
        total_prob += prob[i]
        if u <= total_prob:
            return return_values[i] 
```

我对你返回的值和概率之间的关系有点不清楚，你的代码似乎`prob`总是有 3 个元素，所以我也做了这个假设。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-05-15T22:45:16.837

我喜欢 FJ 的回答，但我会使用元组列表，假设您可以轻松地这样做：

```
from random import uniform

prob = [(0.25, 11), (0.30, 23), (0.45, 39)]

def onetrial(prob):
    u = uniform(0, 1)
    total_prob = 0
    for i in range(3):
        total_prob += prob[i][0]
        if u <= total_prob:
            return prob[i][1] 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-05-15T23:01:22.713

假设您`onetrial`经常调用，请先计算[CDF](http://en.wikipedia.org/wiki/Cumulative_distribution_function)以使其更快一点：

```
from random import uniform

vals = [11, 23, 39]
prob = [0.25, 0.30, 0.45]
cdf = [sum(prob[0:i+1]) for i in xrange(3)]

def onetrial(vals, cdf):
    u = uniform(0, 1)
    for i in range(3):
        if u <= cdf[i]:
            return vals[i] 
```

您可以使用[bisect](http://docs.python.org/library/bisect.html)使其更快。

# c# - ASP.NET MVC 3 - Nick 和电子邮件接受验证（Ajax 调用）

> ID：10609715
> 
> 赞同：1
> 
> 时间：2012-05-15T22:30:47.287
> 
> 标签：c#, asp.net-mvc, asp.net-mvc-3

在 MVC 中处理“Nick / Email Take”AJAX 验证的推荐方法是什么，它与 DataAnnotantion (@Html.ValidationMessageFor(model => model.Email)) 提供的验证器很好地集成在一起？我知道我可能会有这样的事情：

```
<input id="email" onBlur="emailTaken();" onchanged="emailTaken();" />
<script type="text/javascript">
    function emailTaken() {
        var encodedEmail = enc($("#email").val());
        $.getJSON("/Ajax/EmailTaken/" + encodedEmail, function (data) {
            if (data.res) {
                // all is OK
            } else {
                // TODO: Show Error?
            }
        });
    }
</script> 
```

我已经知道在服务器上我可以做 ModelState.AddModelError 并且我正在这样做......但我想知道客户端验证的推荐方法是什么？我需要调用 jquery.validate.unobtrusive.js 提供的一些方法吗？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-05-15T22:33:58.703

您可能希望为此使用远程验证。它是内置的，因此您不必自己编写任何 javascript。

[http://msdn.microsoft.com/en-us/library/gg508808(v=vs.98).aspx](http://msdn.microsoft.com/en-us/library/gg508808(v=vs.98).aspx)

# facebook - FB登录不启动窗口

> ID：10609716
> 
> 赞同：0
> 
> 时间：2012-05-15T22:30:51.627
> 
> 标签：facebook, login

FB.login() 似乎执行但弹出窗口没有启动

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-05-15T22:51:04.310

您没有提供有关该问题的任何其他信息，例如错误（如果有）、您如何调用*FB.login*以及任何相关代码。

我猜您可能是在尝试自动调用此方法，而不是在用户操作之后。在[文档](http://developers.facebook.com/docs/reference/javascript/FB.login/)中它说：

> 调用 FB.login 会导致 JS SDK 尝试打开一个弹出窗口。因此，该方法只能在用户点击事件后调用，否则弹出窗口将被大多数浏览器阻止。

因此，如果您在单击鼠标后没有调用它，则弹出窗口将被阻止。是这样吗？

# c# - 哪种线程睡眠方法最精确：Monitor.Wait vs System.Timer vs DispatchTimer vs Threading.Timer

> ID：10609718
> 
> 赞同：3
> 
> 时间：2012-05-15T22:31:15.553
> 
> 标签：c#, .net, multithreading, timer, threadpool

什么 .NET 对象（或技术）在每 XXX 毫秒启动一个线程时最精确？有哪些权衡？

例如：

```
 int maxDurationMs = 1000;
        while (true)
        {
            DateTime dt = DateTime.UtcNow;
            DoQuickStuff()
            TimeSpan duration1 =  DateTime.UtcNow - dt;
            int sleepTime = maxDurationMs - duration1.Milliseconds;
            if (sleepTime > 0)
                System.Threading.Thread.Sleep(sleepTime);
        } 
```

或者

```
 // CPU Intensive, but fairly accurate
       int maxDurationMs = 1000;
        while (true)
        {
            DateTime dt = DateTime.UtcNow;
            DoQuickStuff()
            while (true)
            {
                if (dt.AddMilliseconds(maxDurationMs) >= DateTime.UtcNow)
                    break;
            }
        } 
```

做同样事情的替代方法，但具有不同程度的准确性和权衡（CPU等）

*   [系统定时器](http://msdn.microsoft.com/en-us/library/system.timers.timer.aspx)
*   [调度定时器](http://msdn.microsoft.com/en-us/library/system.windows.threading.dispatchertimer.aspx)
*   [System.Threading.Timer](http://msdn.microsoft.com/en-us/library/system.threading.timer.aspx)
*   [线程连接](http://msdn.microsoft.com/en-us/library/6b1kkss0)
*   [.NET 4.0 任务](http://msdn.microsoft.com/en-us/library/system.threading.tasks.task.aspx)
*   线程.睡眠（）
*   [Monitor.Wait(obj, 时间跨度)](http://msdn.microsoft.com/en-us/library/tdc87f8y%28v=vs.110%29.aspx)
*   [多媒体定时器](http://msdn.microsoft.com/en-us/library/windows/desktop/dd743609%28v=vs.85%29.aspx)（感谢 Brian Gideon）
*   [Win32 高分辨率计时器](http://msdn.microsoft.com/en-US/library/ms644900.aspx)
*   还有什么？

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-05-16T02:29:35.510

我自己从未真正使用过它们，但据说[多媒体定时器](http://msdn.microsoft.com/en-us/library/windows/desktop/dd743609%28v=vs.85%29.aspx)在 Windows 中的任何定时器服务中具有最佳分辨率。.NET BCL 还没有此计时器服务的包装器，因此您必须自己执行 P/Invoke 调用。

另一种选择可能是在紧密循环中`Stopwatch`与一些标准调用一起使用。`Thread.Sleep`我不确定您使用这种方法会有多少运气，但它可能比一个普通的旧`Thread.Sleep`调用本身更准确。我从未尝试过，但我想任何事情都值得一试。

我做了一些实验，发现更改线程优先级会`ThreadPriority.Highest`产生很大的不同。在我尝试的每种技术上，它都大大降低了间隔的标准偏差。

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2012-05-16T15:59:41.587

不要使用 DateTime：在大多数系统上，它的精度限制在 16 毫秒左右。（参见[Eric Lippert 的](http://blogs.msdn.com/b/ericlippert/archive/2010/04/08/precision-and-accuracy-of-datetime.aspx)博客）

最准确的方法是让一个专用线程运行一个带有[System.Diagnostics.Stopwatch](http://msdn.microsoft.com/en-us/library/system.diagnostics.stopwatch%28v=vs.110%29.aspx)对象的 while 循环来计算时间。

即使使用现有的最精确和最准确的计时器，鉴于 CPU 时间片的不可预测性，每 x 毫秒准确地引发一个事件也不是简单的任务：我建议研究游戏如何执行其主循环（通过延迟补偿实现稳定的 30fps，对于实例）。一个很好的例子是 OpenTK 的[GameWindow](http://www.opentk.com/files/doc/_game_window_8cs_source.html)，特别是 RaiseUpdateFrame 方法。

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2012-05-15T22:56:11.397

如果您想要[精确的间隔 Windows 计时器](http://msdn.microsoft.com/en-us/library/aa741307.aspx)可能不是您需要使用的，可能某种[RTOS](http://en.wikipedia.org/wiki/Real-time_operating_system)会更适合您。

从上面的链接：

> 创建 Timer API 是为了解决当前可用计时器的问题……但是，Windows 计时器并不像应用程序可能需要的那样准确。尽管 Windows 计时器消息可以以毫秒的精度进行调度，但它们很少提供这种结果，因为 Windows 计时器的准确性取决于系统时钟和当前活动。因为 WM_TIMER 消息以低优先级处理，有点像 WM_PAINT 消息，所以它们通常在处理其他消息时被延迟。

* * *

## 回答 #4

> 赞同：2
> 
> 时间：2012-05-15T23:12:47.997

在我的窗口服务中，我使用定期操作`Monitor.Wait`，因为它释放了一个线程并允许我在完成之前执行操作而不必担心下一个“计时器滴答”。有了这个，我得到了 +/- 1 ms 的精度。如果一切顺利。

但是，如果您需要可以信赖的完美精度，则不应使用 .NET。其实你不应该使用Windows。您的进程（或线程）总是有可能在执行中被推迟。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2012-05-17T20:01:07.080

System.Timers.Timer 对象的基本实现倾斜了大约 120 毫秒，导致我每分钟至少跳过一秒。

我可以使用以下技术以 1 分钟的间隔在 1ms 内获得准确的计时器。更短的间隔可能无法达到相同的精度（加上 DoWork() 的开销在此效率中起作用）

```
 public class SystemTimerTest
   {

    readonly System.Timers.Timer timerRecalcStatistics;
    readonly System.Diagnostics.Stopwatch stopwatchForRecalcStatistics = new System.Diagnostics.Stopwatch();

    public SystemTimerTest(TimeSpan range, DataOverwriteAction action)
    {
        int recalculateStatisticsEveryXMillseconds = 1000;

        timerRecalcStatistics = new System.Timers.Timer(recalculateStatisticsEveryXMillseconds);
        timerRecalcStatistics.AutoReset = true;
        timerRecalcStatistics.Elapsed += new System.Timers.ElapsedEventHandler(TimerRecalcStatisticsElapsed);
        timerRecalcStatistics.Interval = recalculateStatisticsEveryXMillseconds;
        timerRecalcStatistics.Enabled = true;

        this.maxRange = range;
        this.hashRunningTotalDB = new HashRunningTotalDB(action);
        this.hashesByDate = new HashesByDate(action);
        this.dataOverwriteAction = action;
    }

    private void TimerRecalcStatisticsElapsed(object source, System.Timers.ElapsedEventArgs e)
    {
        stopwatchForRecalcStatistics.Start();
        Console.WriteLine("The TimerRecalcStatisticsElapsed event was raised at {0}", e.SignalTime.ToString("o"));

         // DO WORK HERE

        stopwatchForRecalcStatistics.Stop();
        double timeBuffer  = GetInterval(IntervalTypeEnum.NearestSecond, e.SignalTime) - stopwatchForRecalcStatistics.ElapsedMilliseconds;

        if (timeBuffer > 0)
            timerRecalcStatistics.Interval = timeBuffer;
        else
            timerRecalcStatistics.Interval = 1;

        stopwatchForRecalcStatistics.Reset();         
        timerRecalcStatistics.Enabled = true;
    }
 } 
```

我想知道这是否每 1 秒周期损失 1 到 120 毫秒意味着 CPU 的效率不如此实现所能达到的效率。

# javascript - 当子窗口准备好时，使用jquery将html从父窗口注入到子窗口

> ID：10609721
> 
> 赞同：1
> 
> 时间：2012-05-15T22:31:24.287
> 
> 标签：javascript, jquery, code-injection, childwindow, document-ready

我的初步代码是这样的。

```
$j(document).ready(function() {
   var w = window.open(childPage);

   $j(w.document).ready(function() {
      $j('#DestinationElement', w.document).html($j('#SourceElement').html());
   });
}); 
```

但是，这只适用于我在 html 注入语句上设置断点时，这意味着在进行注入之前它并没有真正等待子窗口准备好。

有人可以解决这个问题吗？谢谢。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-05-16T00:02:49.983

以下是一些替代方案：将事件侦听器附加到窗口 onload 事件。 [等待子窗口加载完成](https://stackoverflow.com/questions/1372022/waiting-for-child-window-loading-to-complete) （但在 IE 中，您将使用 attachEvent 来“加载”）

在子窗口本身中，当文档准备好时获取打开器的 html。

```
$j(document).ready(function() {
   $j('#DestinationElement').html($j('#SourceElement', window.opener.document).html());
}); 
```

但它仍然困扰着我，我不明白为什么原来的解决方案会失败。

# .net - LINQ 按语法排序

> ID：10609724
> 
> 赞同：0
> 
> 时间：2012-05-15T22:31:31.747
> 
> 标签：.net, linq

由于 order by 子句，以下行将无法编译。我在语法上做错了什么？

```
 ddlMIP.DataSource = dt.AsEnumerable().Select(row => row.Field<string>("MIP_NO").ToString()).Distinct().OrderBy(row => row.Field<string>("MIP_NO").ToString()).ToList(); 
```

谢谢！

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-05-15T22:36:21.043

由于您正在调用 ToString()，因此您的选择正在投影字符串集合

这意味着在您的 OrderBy 中，llambda 中的“row”值实际上将是一个字符串本身。你可能只做 OrderBy(r => r)

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-05-15T22:36:53.473

```
ddlMIP.DataSource = dt.AsEnumerable().Select(row => row.Field<string>("MIP_NO").ToString()).Distinct().OrderBy(row => row.Field("MIP_NO").ToString()).ToList(); 
```

看起来 OrderBy() 部分中的列表运算符导致了问题。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-05-16T09:19:41.590

你哪里出错了；当涉及到排序时，您只剩下之前在`.Select`方法中选择的字符串的集合。只需稍作改动即可轻松实现您想要做的事情。下面将选择字段`MIP_NO`作为字符串，然后将其分配给不同的有序可枚举集合。

```
ddlMIP.DataSource = dt.AsEnumerable()
    .Select(row => row.Field<string>("MIP_NO").ToString())
    .Distinct()
    .OrderBy(mipNo => mipNo); 
```

# sql-server - 使用 delphi 枚举本地网络上的 Microsoft SQL 数据库服务器

> ID：10609728
> 
> 赞同：10
> 
> 时间：2012-05-15T22:31:39.630
> 
> 标签：sql-server, delphi

如果我使用 C#，我可以使用 .net 框架的[SqlDataSourceEnumerator](http://msdn.microsoft.com/en-us/library/system.data.sql.sqldatasourceenumerator%28v=vs.80%29.aspx)来发现并向用户显示网络上的 SQL Server 实例列表。

我怎么能在德尔福做到这一点？

* * *

## 回答 #1

> 赞同：11
> 
> 时间：2012-05-15T22:44:10.150

您可以使用[NetServerEnum](http://msdn.microsoft.com/en-us/library/windows/desktop/aa370623%28v=vs.85%29.aspx)函数，通过`SV_TYPE_SQLSERVER`servertype 参数中的值进行过滤，另一个选项是使用[`SQLOLEDB Enumerator`](http://msdn.microsoft.com/en-us/library/aa198369%28v=sql.80%29)ADO 对象。

* * *

## 回答 #2

> 赞同：5
> 
> 时间：2012-05-16T07:38:12.687

我使用这段代码：

```
uses ActiveX,
     ComObj,
     OleDB,
     DB,
     ADOInt,
     ADODB;

procedure ListAvailableSQLServers(Names: TStringList);
var
  RSCon: ADORecordsetConstruction;
  Rowset: IRowset;
  SourcesRowset: ISourcesRowset;
  SourcesRecordset: _Recordset;
  SourcesName, SourcesType: TField;

function PtCreateADOObject(const ClassID: TGUID): IUnknown;
var
  Status: HResult;
  FPUControlWord: Word;
begin
  asm
    FNSTCW FPUControlWord
  end;
  Status := CoCreateInstance(
              CLASS_Recordset,
              nil,
              CLSCTX_INPROC_SERVER or
              CLSCTX_LOCAL_SERVER,
              IUnknown,
              Result);
  asm
    FNCLEX
    FLDCW FPUControlWord
  end;
  OleCheck(Status);
end;

begin
  SourcesRecordset :=
       PtCreateADOObject(CLASS_Recordset)
       as _Recordset;
  RSCon :=
       SourcesRecordset
       as ADORecordsetConstruction;
   SourcesRowset :=
       CreateComObject(ProgIDToClassID('SQLOLEDB Enumerator'))
       as ISourcesRowset;
   OleCheck(SourcesRowset.GetSourcesRowset(
            nil,
            IRowset, 0,
            nil,
            IUnknown(Rowset)));
   RSCon.Rowset := RowSet;
   with TADODataSet.Create(nil) do
   try
     Recordset := SourcesRecordset;
     SourcesName := FieldByName('SOURCES_NAME');
     SourcesType := FieldByName('SOURCES_TYPE');
     Names.BeginUpdate;
     Names.Clear;
     try
        while not EOF do
        begin
          if (SourcesType.AsInteger = DBSOURCETYPE_DATASOURCE) and
             (SourcesName.AsString <> '') then
            Names.Add(SourcesName.AsString);
          Next;
        end;
     finally
        Names.EndUpdate;
     end;
  finally
     Free;
  end;
end;

procedure GetServer();
var
  oItems: TStringList;
begin
  oItems:= TStringList.Create;
  try
    ListAvailableSQLServers(oItems);
    // To something with oItems
    ShowMessage(oItems.Text);
  finally
    oItems.Free;
  end;
end; 
```

* * *

## 回答 #3

> 赞同：5
> 
> 时间：2012-05-18T23:48:31.347

要枚举所有可用的 Microsoft SQL Server，您可以遵循这个出色的教程：

> [枚举可用的 SQL Server。在 SQL Server 上检索数据库](https://web.archive.org/web/20150907013136/http://delphi.about.com/od/sqlservermsdeaccess/l/aa090704a.htm)

包含在[Zarko](https://www.thoughtco.com/zarko-gajic-bio-1056695)的教程中，有一个[下载完整源代码的链接（直接下载）](https://web.archive.org/web/20150926143559/http://delphi.about.com/library/weekly/code/src090704.zip)，这有助于快速测试它并检查它是否符合您的需求。

**编辑**Zarko Gajic 的主要程序是：

```
procedure ListAvailableSQLServers(Names : TStrings);
var
  RSCon: ADORecordsetConstruction;
  Rowset: IRowset;
  SourcesRowset: ISourcesRowset;
  SourcesRecordset: _Recordset;
  SourcesName, SourcesType: TField;

    function PtCreateADOObject(const ClassID: TGUID): IUnknown;
    var
      Status: HResult;
      FPUControlWord: Word;
    begin
      asm
        FNSTCW FPUControlWord
      end;
      Status := CoCreateInstance(
                  CLASS_Recordset,
                  nil,
                  CLSCTX_INPROC_SERVER or CLSCTX_LOCAL_SERVER,
                  IUnknown,
                  Result);
      asm
        FNCLEX
        FLDCW FPUControlWord
      end;
      OleCheck(Status);
    end;
begin
  SourcesRecordset := PtCreateADOObject(CLASS_Recordset) as _Recordset;
  RSCon := SourcesRecordset as ADORecordsetConstruction;
  SourcesRowset := CreateComObject(ProgIDToClassID('SQLOLEDB Enumerator')) as ISourcesRowset;
  OleCheck(SourcesRowset.GetSourcesRowset(nil, IRowset, 0, nil, IUnknown(Rowset)));
  RSCon.Rowset := RowSet;
  with TADODataSet.Create(nil) do
  try
    Recordset := SourcesRecordset;
    SourcesName := FieldByName('SOURCES_NAME'); { do not localize }
    SourcesType := FieldByName('SOURCES_TYPE'); { do not localize }
    Names.BeginUpdate;
    try
      while not EOF do
      begin
        if (SourcesType.AsInteger = DBSOURCETYPE_DATASOURCE) and (SourcesName.AsString <> '') then
          Names.Add(SourcesName.AsString);
        Next;
      end;
    finally
      Names.EndUpdate;
    end;
  finally
    Free;
  end;
end; 
```

* * *

我不知道我可以添加什么而不*对 Zarko*的解释进行解释。

# c++ - 尝试将小部件添加到 QTabWidget 时出错

> ID：10609729
> 
> 赞同：3
> 
> 时间：2012-05-15T22:31:42.217
> 
> 标签：c++, qt, qtabwidget

我想制作一个窗口并添加一个带有我想要的小部件的 QTabWidgets。因此，我遵循了 Qt TabDialog 示例，据我所知，我遵循了与示例中相同的路径。问题是我在尝试将小部件添加为选项卡时出现此错误：“/home/user/Programming/C++/QtTests/TabExample/TabExample-build-desktop-Desktop_Qt_4_8_1_for_GCC__Qt_SDK__Release/../TabExample/tabwidget.cpp:20: 错误：调用“QTabWidget::addTab(Tab_One*, QString*&)”没有匹配的函数。为什么我会收到此错误，因为 Tab_One 是从 QWidget 继承的？这是我的主要小部件代码：

头文件：

```
#ifndef TABWIDGET_H
#define TABWIDGET_H

#include <QWidget>

class QTabWidget;
class Tab_One;
class Tab_Two;
class QString;
class QHBoxLayout;
class QDialog;

class TabDialog : public QDialog {
    Tab_One *firstTab;
    Tab_Two *secondTab;
    QTabWidget *myTabWidget;
    QString *labelTabOne;
    QString *labelTabTwo;
    QHBoxLayout *layout;
public:
    TabDialog(QWidget *parent = NULL);
};

#endif // TABWIDGET_H 
```

和源文件：

```
#include <QWidget>
#include <QDialog>
#include <QTabWidget>
#include <QHBoxLayout>
#include <QString>

#include "tabwidget.h"
#include "tab1.h"
#include "tab2.h"

TabDialog::TabDialog(QWidget *parent) : QDialog(parent)
{
    layout = new QHBoxLayout;

    labelTabOne = new QString("My First Tab");
    labelTabTwo = new QString("My Second Tab");

    myTabWidget = new QTabWidget;

    firstTab = new Tab_One;
    secondTab = new Tab_Two;

    myTabWidget->addTab(firstTab, labelTabOne);
    myTabWidget->addTab(secondTab, labelTabTwo);

    layout->addWidget(myTabWidget);
    setLayout(layout);
} 
```

这是我的一个宽度（tab1）：标题：

```
#ifndef TAB1_H
#define TAB1_H

#include <QWidget>
class QVBoxLayout;
class QPushButton;

class Tab_One : public QWidget {
    QPushButton *button_one;
    QPushButton *button_two;
    QVBoxLayout *layout;

public:
    Tab_One(QWidget *parent = NULL);
};

#endif // TAB1_H 
```

和来源：

```
#include <QWidget>
#include <QDialog>
#include <QTabWidget>
#include <QHBoxLayout>
#include <QString>

#include "tabwidget.h"
#include "tab1.h"
#include "tab2.h"

TabDialog::TabDialog(QWidget *parent) : QDialog(parent)
{
    layout = new QHBoxLayout;

    labelTabOne = new QString("My First Tab");
    labelTabTwo = new QString("My Second Tab");

    myTabWidget = new QTabWidget;

    myTabWidget->addTab(new Tab_One(this), labelTabOne);
    myTabWidget->addTab(new Tab_Two(this), labelTabTwo);

    layout->addWidget(myTabWidget);
    setLayout(layout);
} 
```

非常感谢，很抱歉发了这么长的帖子

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-05-15T22:38:10.413

问题不是你的标签，而是 QString。`QTabWidget::addTab()`期望一个对 QString 的 const 引用，但你给它一个指向 QString 的指针。尝试使用取消引用运算符 ( `*`)，如下所示：

```
myTabWidget->addTab(firstTab, *labelTabOne);
myTabWidget->addTab(secondTab, *labelTabTwo); 
```

# java - Android unregisterReceiver 与 onPause

> ID：10609732
> 
> 赞同：1
> 
> 时间：2012-05-15T22:31:49.990
> 
> 标签：java, android

我的清单文件中有类似的东西 - 我需要一个接收器来连接电源，另一个接收器用于拔出电源。

```
<receiver android:name=".PowerConnectionOnReceiver" >
        <intent-filter>
            <action android:name="android.intent.action.ACTION_POWER_CONNECTED" />
        </intent-filter>
    </receiver>
            <receiver android:name=".PowerConnectionOffReceiver" >
        <intent-filter>
            <action android:name="android.intent.action.ACTION_POWER_DISCONNECTED" />
        </intent-filter>
    </receiver> 
```

但是我想在我的 MainActivity 中调用 onPause 时取消注册接收器。怎么做？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-05-15T22:38:15.867

如果您的广播接收器在清单中指定，则不能以编程方式取消注册。您需要将其从清单中取出并在您的代码中进行注册。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-05-15T22:38:51.107

您不能取消注册这些接收器，因为它们是在清单中定义的，而不是在代码中。以编程方式定义的接收器可能会被取消注册。

# javascript - 字符串和数字之间的Javascript比较

> ID：10609735
> 
> 赞同：-3
> 
> 时间：2012-05-15T22:32:25.480
> 
> 标签：javascript

嗨，我只是在浏览一些基本的 javascript，然后遇到了这段代码

```
if('3'!=3)
{
   document.write("Hello");
} 
```

这会向屏幕打招呼，但是当我将其更改为：

```
if('3'==3)
{
   document.write("Hello");
} 
```

这也将 Hello 写入屏幕

有谁知道这是什么原因？我读到javascript在比较中将字符串转换为数字我只是不理解更改条件时的不同行为

谢谢 ！！

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-05-15T22:33:40.657

发生这种情况是因为`==`运算符在比较之前尝试将两个操作数转换为相同的类型。换句话说，它看到 string`'3'`与 number 相同`3`，并说它们是相等的。使用`===`运算符来避免这种情况，因为它不会尝试转换操作数（它执行**严格**的相等检查）。

这*不会*写“你好”：

```
if('3'===3)
{
   document.write("Hello");
} 
```

这是另一个有趣的例子：

```
if(false == 0) {
    document.write("Hello");
} 
```

它会写你好！这是因为`0`被视为可以转换为的值`false`。和以前一样，使用`===`运算符可以解决这个问题：

```
if(false === 0) {
    document.write("Hello"); // won't write hello
} 
```

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-05-15T22:33:57.163

这是因为 == 不关心类型。

使用 === 代替。

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2012-05-15T22:34:06.317

如果要进行严格比较，请使用`===`运算符或`!==`

# html - 无法在 html 页面中加载第二个 iframe

> ID：10609736
> 
> 赞同：1
> 
> 时间：2012-05-15T22:32:32.180
> 
> 标签：html, iframe

我想在同一页面中加载 2 个 iframe。第一个 iframe 正常加载，但第二个从不加载（我尝试了很多 url，我在 safari、chrome、firefox 上进行了测试，但没有）这是代码

```
 <div align="center">

        <iframe src="http://www.google.com" height="50px" width="500px" frameborder="0" scrolling="no" id="iframeupload" name="frame1"/><br />
          <iframe src="http://www.yahoo.com" name="frame2" width="500px" height="50px" scrolling="no" frameborder="0" id="iframedomain"/>

</div> 
```

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-05-15T22:35:51.310

很简单，iframe 应该像这样关闭：

```
<iframe src="http://www.google.com" height="50px" width="500px" frameborder="0"
scrolling="no" id="iframeupload" name="frame1"></iframe> 
```

不是这样的：

```
<iframe src="http://www.google.com" height="50px" width="500px" frameborder="0"
scrolling="no" id="iframeupload" name="frame1" /> 
```

# objective-c - 什么是 ARC 兼容的 iOS 的好 zip 库？

> ID：10609737
> 
> 赞同：0
> 
> 时间：2012-05-15T22:32:54.927
> 
> 标签：objective-c, ios, zip, automatic-ref-counting

我正在寻找在 iOS 应用程序中解压缩文件，但找不到与 ARC 兼容的库。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-05-15T22:49:26.497

[Minizip](http://www.winimage.com/zLibDll/minizip.html)工作得很好。不过，我不确定您所说的“ARC 兼容”是什么意思。如果它在 C 或 C++ 中，则 ARC 不相关。如果它在 ObjC 中，您可以为您需要的文件关闭 ARC（[如何为项目中的单个文件禁用 ARC？](https://stackoverflow.com/questions/6646052/how-can-i-disable-arc-for-a-single-file-in-a-project)）

# opengl - 如何在 OpenGL 中实现基本的相机操作？

> ID：10609743
> 
> 赞同：1
> 
> 时间：2012-05-15T22:33:40.047
> 
> 标签：opengl, graphics, camera

我正在尝试使用 OpenGL 实现一个应用程序，我需要实现基本的相机运动：轨道、平移和缩放。

为了让它更清晰一点，我需要类似 Maya 的相机控制。由于应用程序的性质，我不能使用“转换场景以使其看起来像相机移动”这样的好方法。所以我坚持使用变换矩阵、gluLookAt 等。

我知道缩放很容易，我只需要连接到眼睛矢量的深度分量（gluLookAt），但我不太确定如何实现另外两个，平移和轨道。有没有人这样做过？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-05-15T22:40:32.857

> 我不能使用好的 ol'“变换场景以使其看起来像相机移动”

OpenGL没有相机。所以你最终会这样做。

> 我知道缩放很容易，我只需要挂钩眼睛矢量的深度分量（gluLookAt），

这不是Zoom，这是Dolly。缩放意味着改变投影体积的限制，即正射投影的范围，或透视的视野。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-05-19T08:08:16.953

您已经遇到的 gluLookAt 是您的解决方案。前三个参数是相机的位置 (x,y,z)，接下来的三个是相机的中心（它正在看的点），最后三个是向上向量（通常是 (0,1,0)），它定义*相机*的yz 平面。*

这很简单：你只需 glLoadIdentity();，调用 gluLookAt(...)，然后像往常一样绘制你的场景。就个人而言，我总是自己在 CPU 中进行所有计算。我发现环绕一个点是一项极其常见的任务。我的模板 C/C++ 代码使用球坐标，看起来像：

```
double camera_center[3] = {0.0,0.0,0.0};
double camera_radius = 4.0;
double camera_rot[2] = {0.0,0.0};
double camera_pos[3] = {
    camera_center[0] + camera_radius*cos(radians(camera_rot[0]))*cos(radians(camera_rot[1])),
    camera_center[1] + camera_radius*                            sin(radians(camera_rot[1])),
    camera_center[2] + camera_radius*sin(radians(camera_rot[0]))*cos(radians(camera_rot[1]))
};
gluLookAt(
       camera_pos[0],   camera_pos[1],   camera_pos[2],
    camera_center[0],camera_center[1],camera_center[2],
    0,1,0
); 
```

显然，您可以调整camera_radius，这将改变相机的“缩放”，camera_rot，这将改变相机围绕其轴的旋转，或者camera_center，这将改变相机围绕其运行的点。

*唯一另一个棘手的问题是*准确*了解这一切的含义。澄清一下，因为互联网缺乏：

*   该位置是相机的 (x,y,z) 位置。很简单。
*   中心是相机聚焦的 (x,y,z) 点。您基本上是沿着一条*从*该位置*到*中心的假想射线。
*   现在，您的相机仍然可以查看该向量*周围*的任何方向（例如，它可能是倒置的，但仍沿同一方向查看）。上向量是向量，*而不是*位置。它与从该位置到中心的那个假想矢量一起形成一个平面。这是相机的 yz 平面。

# javascript - 将javascript代码存储在velocity vm模板文件中并包含在页面中

> ID：10609745
> 
> 赞同：0
> 
> 时间：2012-05-15T22:33:41.433
> 
> 标签：javascript, velocity

我有使用速度上下文和 rundata 对象的 javascript 代码，我必须将其包含在 VM 模板中。有没有办法让我把它分成独立的文件，比如 screen-js.vm，并包含在 GlobalMacros.vm 文件中，比如：

和 screen-js.vm 看起来像：

```
 $data.setLayoutTemplate("/NoNavigationJs.vm") ##this for not creating any header

    <script type="text/javascript">
    $(document).ready(function() {
         //javascript code ...

    }
</script> 
```

但这不起作用，这是页面源代码，开头有 2 个空行：

```
<script type="text/javascript">

$(document).ready(function() {
...
}
</script> 
```

我在这里做错了什么？谢谢！

大卫

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-05-16T06:23:03.643

我想通了：#parse("path/to/vm file") 就可以了。

# c# - IXmlSerializable 的通用实现

> ID：10609747
> 
> 赞同：3
> 
> 时间：2012-05-15T22:33:52.230
> 
> 标签：c#, xml, generics, serialization

我有一个用户定义的类，我的代码中的几乎所有对象都扩展了它。我想在这个类上实现 iXmlSerializeable，以便我可以在基本级别控制我的对象被序列化的方式。具体来说，我需要以特定方式处理对象中的 DateTime 字符串。是的，可能有更好的方法来欺骗应用程序从序列化的 DateTime 中剥离 TimeZone 信息。然而，我的要求迫使我忽略这张脸。我需要一种方法将其写入本质上是一个函数，该函数不必影响或更改应用程序中其他任何地方的代码以实现此效果。

这是到目前为止的实现（仅限阅读器，甚至还没有启动编写器）：

```
 public void ReadXml(System.Xml.XmlReader reader)
    {
        //loop through properties, Read property by name, converting as necessary based on property type.
        Type curType = this.GetType();

        PropertyInfo[] pis;
        PropertyInfo prop = null;
        List<PropertyInfo> piList = new List<PropertyInfo>();

        //get all fields and properties (this does not need to be recursive, properties of the underlying object DO appear at this stage, unlike fields.
        pis = curType.GetProperties(BindingFlags.Instance | BindingFlags.Public | BindingFlags.NonPublic);

        foreach (PropertyInfo pi in pis)
            piList.Add(pi);

        bool isEmpty = reader.IsEmptyElement;

        reader.ReadStartElement();

        if (!isEmpty)
        {
            bool isProp = false;

            while (reader.NodeType != System.Xml.XmlNodeType.EndElement)
            {
                if (!reader.IsEmptyElement)
                {
                    if (piList.Select(a => a.Name).Contains(reader.Name))
                        isProp = true;

                    if (!isProp)//property not found?
                    {
                        reader.Skip();//cant do anything with it...keep going.
                        continue;
                    }

                    #region property set
                    prop = piList.Where(a => a.Name.Equals(reader.Name)).Single();
                    if (prop.CanWrite)
                    {
                        if (prop.PropertyType.BaseType.IsGenericType)
                        {//this should be one of the Rig Collections, are there any false positives?
                            ReadXmlCollection(prop, reader);
                        }
                        else if (prop.PropertyType.IsSubclassOf(typeof(BusinessObjectBase)))
                        {
                            //have to create a 'new' object, then call its reader to fill it in, then set the property value.
                            object newObj = Activator.CreateInstance(prop.PropertyType, false);
                            prop.PropertyType.GetMethod("ReadXml").Invoke(newObj, new object[] { reader });
                            prop.SetValue(this, newObj, null);
                        }
                        else
                        {
                            string elVal = reader.ReadString();
                            if (!String.IsNullOrEmpty(elVal))
                            {
                                if (prop.PropertyType == typeof(String))
                                    prop.SetValue(this, elVal, null);
                                else if (prop.PropertyType == typeof(int) || prop.PropertyType == typeof(int?))
                                    prop.SetValue(this, Convert.ToInt32(elVal), null);
                                else if (prop.PropertyType == typeof(double) || prop.PropertyType == typeof(double?))
                                    prop.SetValue(this, Convert.ToDouble(elVal), null);
                                else if (prop.PropertyType == typeof(bool) || prop.PropertyType == typeof(bool?))
                                    prop.SetValue(this, Convert.ToBoolean(elVal), null);
                                else if (prop.PropertyType == typeof(DateTime) || prop.PropertyType == typeof(DateTime?))
                                {//special handle
                                    elVal = System.Text.RegularExpressions.Regex.Replace(elVal, @"(\d{4}-\d{2}-\d{2})T(\d{2}:\d{2}:\d{2}\.?\d*)([\+|-]\d{2}:\d{2})", "$1 $2");
                                    prop.SetValue(this, Convert.ToDateTime(elVal), null);
                                }
                            }
                        }
                    }
                    #endregion
                }

                if (prop == null)//read anyway, something weird has happened?
                {
                    if (!reader.Read())
                        break;
                }
                else if(prop.Name.Equals(reader.Name))//only read if we are still on this node, otherwise, this has already been done.
                    if (!reader.Read())
                        break;

                prop = null;
                isProp = false;
            }
        }
        reader.ReadEndElement();
    }

    private void ReadXmlCollection(PropertyInfo prop, System.Xml.XmlReader reader)
    {
        string colName = reader.Name;
        object collectionIntance = Activator.CreateInstance(prop.PropertyType, false);
        reader.ReadStartElement();
        //now we are at the first element in the collection...what is it?
        Type ColType = prop.PropertyType.BaseType.GetGenericArguments()[0];
        while (reader.Name != colName && reader.NodeType != System.Xml.XmlNodeType.EndElement)
        {
            object colObj = Activator.CreateInstance(ColType, false);
            ColType.GetMethod("ReadXml").Invoke(colObj, new object[] { reader });
            prop.PropertyType.GetMethod("Add", new Type[] {ColType}).Invoke(collectionIntance, new object[] { colObj });
        }
        prop.SetValue(this, collectionIntance, null);
        reader.ReadEndElement();
    } 
```

我认为它有效......但它也很慢。任何建议，将不胜感激。

我也不介意“天哪，这太疯狂了，永远不会起作用”……或类似的东西。请记住，这是在抽象基类上实现的，它在已经扩展的类型上运行。

这是我需要阅读的数据样式的一个非常截断和大量简化的示例：

```
<RigX>
    <isDirty>True</isDirty>
    <RXJob>
        <prop1>1.3</prop1>
        <prop2>False<prop2>
        <prop3>1984-08-10T09:30:00-06:00</prop3>
        <prop4 />
        <prop5>Hello World</prop5>
    </RXJob>
    <RXCollection>
        <ColObject>
            <p1>Yo</p1>
            <p2>Yellow</p2>
        </ColObject>
        <ColObject>
            <p1>No</p1>
            <p2>Orange</p2>
        </ColObject>
    </RXCollection>
    <RXNestedCollection>
        <RXNestedObject>
            <RXAnotherCollection>
                <RXAnotherObject>
                    <p1>1.9</p1>
                </RXAnotherObject>
            </RXAnotherCollection>
            <RXObject>
                <prop1>nope</prop1>
                <prop2>Im On A Horse!</prop2>
            </RXObject>
        </RXNestedObject>
    </RXNestedCollection>
</RigX> 
```

在此示例中，RigX 是外部的单个对象。IsDirty 是 RigX 的属性。同样，RXJob、RXCollection 和 RXNestedCollection 是 RigX 的属性。RXJob 是一个对象，另外两个是集合。RXCollection 是一个集合，其中包含未知数量的用户定义对象，每个对象都是仅包含原始对象的简单对象。RXNestedCollection 包含未知数量的用户定义对象，每个对象都包含其他用户定义对象和集合。

# javascript - 提交表单后执行脚本

> ID：10609751
> 
> 赞同：0
> 
> 时间：2012-05-15T22:34:05.023
> 
> 标签：javascript, jquery, forms

`POST`我在这个网站上发现了一种无需离开页面即可提交表单的方法。在该脚本中，他们说明了如何在提交表单后执行功能。脚本如下所示：

```
$(document).ready(function(){
$form = $('form');
$form.submit(function(){
  $.post($(this).attr('action'), $(this).serialize(), function(response){
  },'json');
  return false;
});
});​ 
```

他们说，在提交表单后`function(response){`，`},'json');`您可以指定其他 JavaScript，例如警报等。我试过

```
$(document).ready(function(){
$form = $('form');
$form.submit(function(){
  $.post($(this).attr('action'), $(this).serialize(), function(response){
$('form').hide();
  },'json');
  return false;
});
}); 
```

不幸的是，这不起作用，谁能告诉我为什么？我已经设置了一个[jsFiddle](http://jsfiddle.net/v5yY6/)。请帮忙。谢谢。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-05-15T23:08:03.597

使用 $.post，“函数（响应）”仅在成功结果后调用，因此您在服务器处理请求时被错误地告知在此函数中执行工作。

要在将请求发送到服务器后继续处理，请将 $('form').hide() 放在 $.post 调用之后：

```
$form.submit(function(){
  $.post(
    $(this).attr('action'), $(this).serialize(), 
    function(response){
    }
    ,'json'
  );
  $('form').hide();
  return false;
}); 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-05-15T23:33:40.840

问题：

1.  将 JavaScript 变量设置为`form`，而不是`$form`。然后在 jQuery 中作为`$(form)`.
2.  的上下文`$(this).attr('action')`是`$.post()`回调，**而不是**表单。解决方案：`$(form)`代替`$(this)`.

* * *

解决方案：

```
$(document).ready(function(){
    form = $('form');

    $(form).on('submit', function() {
        $.post($(form).attr('action'), $(this).serialize(), function(response) {
            $('form').hide();
        },'json');

        return false;
    });
}); 
```

* * *

## 回答 #3

> 赞同：-1
> 
> 时间：2012-05-15T23:08:22.460

当表单更改为时，您的小提琴工作正常

```
<form action="#" method="post"> 
```

[http://api.jquery.com/jQuery.post/](http://api.jquery.com/jQuery.post/)上的文档显示这是一个有效的语法和[http://www.johnnycode.com/blog/2010/04/08/jquery-form-serialize- dont-post-submit-and-button-values-duh/](http://www.johnnycode.com/blog/2010/04/08/jquery-form-serialize-doesnt-post-submit-and-button-values-duh/)也是一个正在运行的示例。如果它根本不适合你，那么愚蠢，你的页面中是否有对 jQuery 的引用？

# facebook - 缓存 Facebook 评论框的“URL 无法访问”错误？

> ID：10609763
> 
> 赞同：4
> 
> 时间：2012-05-15T22:35:24.773
> 
> 标签：facebook, facebook-opengraph, facebook-comments

我们的网站使用 Facebook 评论框插件。我们在防火墙后面的临时站点上包含评论框，这意味着 Facebook 无法访问它并生成“URL 无法访问”错误。这个我明白。

但是，一旦页面发布，并且 Facebook 可以访问，错误仍然会显示。这可以通过单击与错误一起提供的调试链接轻松修复，但我的内容编辑器不想每次都这样做，他们有时会忘记。

一旦使用调试器，似乎可达状态被缓存并重置。谁能想到另一种解释？

我想我可以从临时站点中省略 Facebook 评论框，但不希望这样做。还有其他想法吗？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-05-15T22:57:04.603

在[Like Button](http://developers.facebook.com/docs/reference/plugins/like/)的文档中，他们解释了何时**抓取**页面：

> **Facebook 什么时候抓取我的页面？**
> 
> Facebook 需要抓取您的页面以了解如何在网站周围显示它。
> 
> Facebook 每 24 小时抓取一次您的页面，以确保属性是最新的。当 Open Graph 页面的管理员单击 Like 按钮以及将 URL 输入 Facebook URL Linter 时，该页面也会被抓取。Facebook 会观察您 URL 上的缓存标头 - 它会按优先顺序查看“过期”和“缓存控制”。但是，即使您指定更长的时间，Facebook 也会每 24 小时抓取一次您的页面。
> 
> 爬虫的用户代理是：“facebookexternalhit/1.1 (+http://www.facebook.com/externalhit_uatext.php)”

这里有三个选项：

1.  您可以通过发出一个简单的 http 请求来调用调试器，您可以在发布文章（或您正在发布的任何内容）时从服务器执行此操作，您不必使用调试器工具。

2.  您可以检查用户代理字符串是否有请求，如果它是 facebook**刮板**允许它，以便它可以缓存页面。

3.  您可以为生产和登台使用不同的 url，这样登台页面的缓存在生产中就无关紧要了。

# java - 日历的 AM 和 PM 值在 12 点错误？

> ID：10609770
> 
> 赞同：3
> 
> 时间：2012-05-15T22:36:30.663
> 
> 标签：java, android

下面是我用来将日期向后移动 3 小时的代码。它显示新时间和下午值。但是当它到达 12pm 或 am 时，它会将新时间的 am pm 值更改为与它来自的 12 点相同。即，如果它设置在上午 12 点并且新值是晚上 9 点，它会输出晚上 9 点。我错过了一些简单的东西吗？我是否正确地认为上午 12 点是午夜这样的？

```
 calendar.set(Calendar.HOUR, HourValue);
         calendar.set(Calendar.MINUTE, MinValue);
         calendar.set(Calendar.SECOND, 0);
         if(AMPM.equals("AM")){ampmval=0;}
         else{ampmval=1;}
         Log.e("AMPMVAL Before",Integer.toString(ampmval));

         sdf = new SimpleDateFormat("hh");
         NewHourValue = sdf.format(calendar.getTime());
         Log.e("Before Time",NewHourValue);

         calendar.set(Calendar.AM_PM, ampmval);
         calendar.add(Calendar.MINUTE, -300);

         int AmOrPm = calendar.get(Calendar.AM_PM);
         Log.e("AMPMVAL After",Integer.toString(AmOrPm)); 
         sdf = new SimpleDateFormat("hh");
         NewHourValue = sdf.format(calendar.getTime());
         Log.e("After Time",NewHourValue); 
```

这输出类似

```
05-15 23:07:11.233: E/Before Time(457):   09:00:00 PM
05-15 23:07:11.240: E/AMPMVAL After(457): 0
05-15 23:07:11.640: E/After Time(457):    06:00:00 AM
05-15 23:07:23.369: E/AMPMVAL Before(457):0
05-15 23:07:23.742: E/Before Time(457):   10:00:00 PM
05-15 23:07:23.749: E/AMPMVAL After(457): 0
05-15 23:07:24.113: E/After Time(457):    07:00:00 AM
05-15 23:07:28.320: E/AMPMVAL Before(457):0
05-15 23:07:28.712: E/Before Time(457):   11:00:00 PM
05-15 23:07:28.720: E/AMPMVAL After(457): 0
05-15 23:07:29.112: E/After Time(457):    08:00:00 AM
05-15 23:07:34.700: E/AMPMVAL Before(457):1
05-15 23:07:35.300: E/Before Time(457):   12:00:00 AM
05-15 23:07:35.330: E/AMPMVAL After(457): 1
05-15 23:07:35.693: E/After Time(457):    09:00:00 PM 
```

正如您所看到的，它工作正常，因为我在上午 12 点（午夜）之前的几个小时内递增，但是当它到达午夜时，它会说新值也在 am

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-05-16T08:16:25.340

您在午夜/中午使用什么 HOUR 值？0和12不一样。

例如，对于午夜，您必须设置`AM_PM`为0（`AM`而`HOUR`不是 12）。`DateFormat`AM/PM 格式的输出将在午夜显示 12 AM。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-07-23T05:52:12.260

我建议在日历对象中显示确切的小时字符串，初始化 df 对象，如下所示：

SimpleDateFormat sdf = new SimpleDateFormat("yyyy-MM-dd HH:mm:ss"); 那么日期字符串 2012-05-19 12:00:00 转换为 Calendar 对象时将 Hour 为 12 而不是 0。

但是您使用日期格式作为

SimpleDateFormat sdf = new SimpleDateFormat("yyyy-MM-dd hh:mm:ss");

然后 12 将在小时内转换为 0

# c# - 从不同数据库获取行的最佳方法是什么？

> ID：10609771
> 
> 赞同：0
> 
> 时间：2012-05-15T22:36:40.330
> 
> 标签：c#, sql-server, linq, entity-framework, dynamicquery

我有 10 个相同的数据库。

我在运行时获取数据库名称。

我想将行存储到对象集合中。

我也只想在数据库服务器上点击一次。

**我目前的做法： -**

*   在查询中（由于 X 原因没有存储过程）我得到数据库列表并存储在临时表中。
*   然后我遍历每个数据库并创建一个动态查询并执行它。

    ```
    DECLARE @MaxRownum int SET @MaxRownum = (SELECT MAX(RowNum) FROM #Databases) 
    DECLARE @Iter int SET @Iter = 1
    WHILE @Iter <= @MaxRownum
    BEGIN
    DECLARE @Database varchar(255) SELECT @Database = Databases FROM #Databases 
          WHERE RowNum = @Iter
    IF HAS_DBACCESS(@Database) > 0
        BEGIN 
          //appending query
    END
    SET @Iter = @Iter + 1
    END
    EXEC(@Query) 
    ```

我可以使用 Linq + 实体框架一键访问服务器，无需动态查询且不影响性能吗？有没有更好的解决方案？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-05-15T23:46:45.420

不知道您的查询是什么（我问过但您没有提供），并且不确定您是否理解在没有“动态查询”的情况下将数据库名称作为变量提供非常困难，这是一种更简单的方法做到这一点恕我直言：

```
DECLARE @sql NVARCHAR(MAX);

SELECT @sql = N'';

SELECT @sql = @sql + CHAR(13) + CHAR(10) + 'UNION ALL'
    --// you will need to fill in your "//appending query" stuff here:
    + ' SELECT ... FROM ' + QUOTENAME(Databases) + '.dbo.tablename'
 FROM #Databases
 WHERE HAS_DBACCESS(Databases) = 1;

SET @sql = STUFF(@sql, 1, 9, '');

EXEC sp_executesql @sql; 
```

# r - 在没有 for 循环的情况下标记连续的观察块

> ID：10609772
> 
> 赞同：3
> 
> 时间：2012-05-15T22:36:44.580
> 
> 标签：r

我有一个标准的“可以避免循环”问题，但找不到解决方案。

[我通过@splaisan](https://stackoverflow.com/questions/10532192/add-segments-to-scatter-plot/10559398#10559398)回答了这个问题，但我不得不在中间部分诉诸一些丑陋的扭曲，并进行一个`for`和多个`if`测试。我在这里模拟一个更简单的版本，希望有人能给出更好的答案...

**问题**

给定这样的数据结构：

```
df <- read.table(text = 'type
a
a
a
b
b
c
c
c
c
d
e', header = TRUE) 
```

我想识别相同类型的连续块并将它们标记为组。第一个块应标记为 0，下一个块应标记为 1，依此类推。有无限数量的块，每个块可能只有一个成员那么短。

```
type    label
   a    0
   a    0
   a    0
   b    1
   b    1
   c    2
   c    2
   c    2
   c    2
   d    3
   e    4 
```

**我的解决方案**

我不得不求助于一个`for`循环来做到这一点，这里是代码：

```
label <- 0
df$label <- label

# LOOP through the label column and increment the label
# whenever a new type is found
for (i in 2:length(df$type)) {
    if (df$type[i-1] != df$type[i]) { label <- label + 1 }
    df$label[i] <- label
} 
```

**我的问题**

没有循环和条件，任何人都可以做到这一点吗？

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2012-05-15T22:58:37.977

使用`rle`

```
r <- rle(as.numeric(df$type))
df$label <- rep(seq(from=0, length=length(r$lengths)), times=r$lengths) 
```

不使用`rle`，而是使用`cumsum`强制为数字的逻辑。

```
df$label <- c(0,cumsum(df$type[-1] != df$type[-length(df$type)])) 
```

两者都给出：

```
> df
   type label
1     a     0
2     a     0
3     a     0
4     b     1
5     b     1
6     c     2
7     c     2
8     c     2
9     c     2
10    d     3
11    e     4 
```

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2012-05-15T23:05:57.623

我对此的破解：

```
as.numeric(df[, 1])-1 
```

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2012-05-15T23:05:10.573

这也发生在我身上，您可以简单地转换为一个因子，然后返回整数并减去一个：

```
as.integer(as.factor(df$type))-1 
```

如果`type`已经是一个因素，您可以跳过该步骤。

# java - java用新行写入文件末尾

> ID：10609775
> 
> 赞同：9
> 
> 时间：2012-05-15T22:36:57.770
> 
> 标签：java

我想使用 java 将结果写入文件末尾

```
FileWriter fStream;
        try {
            fStream = new FileWriter("recallPresision.txt", true);
            fStream.append("queryID=" + queryID + "         " + "recall=" + recall + "           Pres=" + presision);
            fStream.append("\n");
            fStream.flush();
            fStream.close();
        } catch (IOException ex) {
            Logger.getLogger(query.class.getName()).log(Level.SEVERE, null, ex);
        } 
```

我`"\n"`输入了语句，它写入文件但没有换行

****我想用新行打印结果****

* * *

 **## 回答 #1

> 赞同：10
> 
> 时间：2012-05-15T22:39:14.517

换行顺序取决于系统。在某些系统上它是,`\n`在其他系统上是`\n\r`,或其他完全不同的东西。幸运的是，Java 有一个内置属性允许您访问它：`\r\n``\r`

```
 String newline = System.getProperty("line.separator"); 
```

* * *

## 回答 #2

> 赞同：7
> 
> 时间：2012-05-15T22:40:09.857

## 错误的

```
fStream.append("\n"); 
```

## 对

```
// don't guess the line separator!
fStream.append(System.getProperty("line.separator")); 
```

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2012-05-15T22:39:34.647

它确实打印换行符，你想要的是最后的空行。添加另一个`\n`.

* * *

## 回答 #4

> 赞同：2
> 
> 时间：2012-05-15T22:39:45.017

尝试`\r\n`改用。

此外，您应该会发现，如果您在富文本编辑器（例如写字板）中打开文本文件，您的附加功能实际上是有效的。

编辑：忽略我。Jeffery 和 Andrew 的回答要好得多。

* * *

## 回答 #5

> 赞同：2
> 
> 时间：2012-05-15T22:42:45.457

您还可以更改为：

```
fStream = new FileWriter("recallPresision.txt", true);
PrintWriter out = new PrintWriter(fStream);
out.println("queryID=" + queryID + "         " + "recall=" + recall + "           Pres=" + presision);
out.flush();
out.close();
fStream.close(); 
```**

# android - LazyList OutOfMemoryError：android中的内存耗尽

> ID：10609782
> 
> 赞同：1
> 
> 时间：2012-05-15T22:37:46.050
> 
> 标签：android, lazy-loading

我有一个问题，我正在实现 LazyListAdapter 以通过缓存在列表视图中显示图像，它运行良好，但在某些情况下它返回 outofMemoryError: memory 已用尽。我不知道为什么？请提出任何解决方案。

**代码：**

```
package com.TCC.android.adapters;

import java.util.ArrayList;
import java.util.Iterator;

import android.app.Activity;
import android.content.Context;
import android.view.LayoutInflater;
import android.view.View;
import android.view.ViewGroup;
import android.widget.BaseAdapter;
import android.widget.ImageView;
import android.widget.TextView;
import android.widget.Toast;

import com.TCC.android.R;
import com.TCC.android.collections.BrandListCollection;
import com.TCC.android.collections.CatedoryListCollection;
import com.TCC.android.collections.PriceListCollection;

public class PriceListLazyAdapter extends BaseAdapter {

    private Activity activity;
   // private   List<BaseInventoryItem> localItems;
    private LayoutInflater inflater = null;
    private ImageLoader imageLoader;
    public static Long id;
    public static int cat_id;
    public static String type;
    PriceListCollection priceList = PriceListCollection.getSingletonObject();

    // Pass in the list of items to adapt
    public PriceListLazyAdapter(Activity inputActivity) {
        activity = inputActivity;
       // localItems = inputItems;
        inflater = (LayoutInflater) activity.getSystemService(Context.LAYOUT_INFLATER_SERVICE);
        imageLoader = new ImageLoader(activity.getApplicationContext());
    }

    public int getCount() {
        return priceList.getDisplayNames().size();
    }

    public Object getItem(int position) {
        return position;
    }

    public long getItemId(int position) {
        return position;
    }

    public View getView(int position, View convertView, ViewGroup parent) {
        View vi = convertView;
        if (convertView == null) {
            vi = inflater.inflate(R.layout.price_item, null);
        }
        // Grab all of the layout elements in which we need ot insert content.
        TextView tvDisplayName = (TextView) vi.findViewById(R.id.tv_PriceItem_Name);
        TextView tvRating1 = (TextView) vi.findViewById(R.id.tv_PriceItem_Rating1);

        TextView tvPrice1 = (TextView) vi.findViewById(R.id.tv_PriceItem_Price1);

        TextView tvMPG1 = (TextView) vi.findViewById(R.id.tv_PriceItem_MPG1);

        TextView tvYear1 = (TextView) vi.findViewById(R.id.tv_PriceItem_Year1);

        ImageView productImage = (ImageView) vi.findViewById(R.id.img_PriceItem);
       /* ArrayList<String> arr = catList.getMapRating().get("Toyota Paseo");
        System.out.println("The array================================>"+arr.get(0));
        System.out.println("The array================================2>"+arr.get(1));*/
            /*tvRating1.setText(catList.getMapRating().get(position).get(0));
            tvRating2.setText(catList.getMapRating().get(position).get(1));
            tvPrice1.setText(catList.getMapPrice().get(position).get(0));
            tvPrice2.setText(catList.getMapPrice().get(position).get(1));
            tvMPG1.setText(catList.getMapMpg().get(position).get(0));
            tvMPG2.setText(catList.getMapMpg().get(position).get(1));
            tvYear1.setText(catList.getMapYears().get(position).get(0));
            tvYear2.setText(catList.getMapYears().get(position).get(1));*/
        tvRating1.setText(priceList.getRating());

        tvPrice1.setText(priceList.getPrice());

        tvMPG1.setText(priceList.getMPG());

        tvYear1.setText(priceList.getYear());

       tvDisplayName.setText(priceList.getDisplayNames().get(position));
      // Iterator myVeryOwnIterator = catList.getMapMpg().keySet().iterator();
        /*while(myVeryOwnIterator.hasNext()) {
            String key=(String)myVeryOwnIterator.next();
            ArrayList<String> value=catList.getMapMpg().get(key);
            //Toast.makeText(this, "Key: "+key+" Value: "+value.get(0)+" and "+value.get(1), Toast.LENGTH_LONG).show();
            System.out.println("Key:"+key+" Value:"+value.get(0)+" and "+value.get(1));
        }*/
        //tvBrandName.setText(brandList.getDisplayNames().get(position));
        imageLoader.displayImage(priceList.getImages().get(position), activity, productImage);

        return vi;
    }

    // expose this method so that SearchResultActivity.onDestroy() can safely close the Thread.
    public void stopImageLoader() {
        if(imageLoader != null) {
            imageLoader.stopThread();
        }
    }
} 
```

**ImageLoader.java：**

```
package com.TCC.android.adapters;

import java.io.ByteArrayOutputStream;
import java.io.File;
import java.io.FileInputStream;
import java.io.FileNotFoundException;
import java.io.FileOutputStream;
import java.io.InputStream;
import java.io.OutputStream;
import java.net.HttpURLConnection;
import java.net.URL;
import java.util.Map;
import java.util.Stack;
import java.util.concurrent.ConcurrentHashMap;

import android.app.Activity;
import android.content.Context;
import android.graphics.Bitmap;
import android.graphics.BitmapFactory;
import android.widget.ImageView;

import com.TCC.android.R;

public class ImageLoader {

    MemoryCache memoryCache=new MemoryCache();
    FileCache fileCache;
    private Map<ImageView, String> imageViews = new ConcurrentHashMap<ImageView, String>();

    public ImageLoader(Context context){
        //Make the background thead low priority. This way it will not affect the UI performance
        photoLoaderThread.setPriority(Thread.NORM_PRIORITY-1);

        fileCache=new FileCache(context);
    }

    final int stub_id=R.drawable.ic_launcher;
    public void displayImage(String url, Activity activity, ImageView imageView)
    {
        imageViews.put(imageView, url);
        Bitmap bitmap=memoryCache.get(url);
        if(bitmap!=null)
            imageView.setImageBitmap(bitmap);
        else
        {

            queuePhoto(url, activity, imageView);
            imageView.setImageResource(stub_id);
        }    
    }

    private void queuePhoto(String url, Activity activity, ImageView imageView)
    {
        //This ImageView may be used for other images before. So there may be some old tasks in the queue. We need to discard them. 
        photosQueue.Clean(imageView);
        PhotoToLoad p=new PhotoToLoad(url, imageView);
        synchronized(photosQueue.photosToLoad){
            photosQueue.photosToLoad.push(p);
            photosQueue.photosToLoad.notifyAll();
        }

        //start thread if it's not started yet
        if(photoLoaderThread.getState()==Thread.State.NEW)
            photoLoaderThread.start();
    }

    private Bitmap getBitmap(String url) 
    {
        File f=fileCache.getFile(url);
        InputStream is;
        //from SD cache
        Bitmap bitmap=null;
        Bitmap b = decodeFile(f);
        if(b!=null)
            return b;

        //from web
        try {

            System.out.println("---------------------IMAGE URL: "+url);

            URL imageUrl = new URL(url);
            HttpURLConnection conn = (HttpURLConnection)imageUrl.openConnection();
            conn.setConnectTimeout(30000);
            conn.setReadTimeout(30000);
            is=conn.getInputStream();
            OutputStream os = new FileOutputStream(f);
            Utils.CopyStream(is, os);
            os.close();
            bitmap = decodeFile(f);
            ByteArrayOutputStream baos = new ByteArrayOutputStream();
            bitmap.compress(Bitmap.CompressFormat.JPEG, 70, baos);
            return bitmap;
        } catch (Exception ex){
            System.out.println("---------------------IMAGE URL: "+url);
           ex.printStackTrace();
           return null;
        }
        finally{
            bitmap = null;
            is=null;
        }
    }

    //decodes image and scales it to reduce memory consumption
    private Bitmap decodeFile(File f){
        try {
            //decode image size
            BitmapFactory.Options o = new BitmapFactory.Options();

            o.inJustDecodeBounds = true;
            BitmapFactory.decodeStream(new FileInputStream(f),null,o);

            //Find the correct scale value. It should be the power of 2.
            final int REQUIRED_SIZE=70;
            int width_tmp=o.outWidth, height_tmp=o.outHeight;
            int scale=1;
            while(true){
                if(width_tmp/2<REQUIRED_SIZE || height_tmp/2<REQUIRED_SIZE)
                    break;
                width_tmp/=2;
                height_tmp/=2;
                scale*=2;
            }

            //decode with inSampleSize
            BitmapFactory.Options o2 = new BitmapFactory.Options();
            o2.inSampleSize=scale;
            return BitmapFactory.decodeStream(new FileInputStream(f), null, o2);
        } 
        catch(OutOfMemoryError e)
        {
            e.printStackTrace();
        }catch (FileNotFoundException e) {}
        return null;
    }

    //Task for the queue
    private class PhotoToLoad
    {
        public String url;
        public ImageView imageView;
        public PhotoToLoad(String u, ImageView i){
            url=u; 
            imageView=i;
        }
    }

    PhotosQueue photosQueue=new PhotosQueue();

    public void stopThread()
    {
        photoLoaderThread.interrupt();
    }

    //stores list of photos to download
    class PhotosQueue
    {
        private Stack<PhotoToLoad> photosToLoad=new Stack<PhotoToLoad>();

        //removes all instances of this ImageView
        public void Clean(ImageView image)
        {
            for(int j=0 ;j<photosToLoad.size();){
                if(photosToLoad.get(j).imageView==image)
                    photosToLoad.remove(j);
                else
                    ++j;
            }
        }
    }

    class PhotosLoader extends Thread {
        public void run() {
            try {
                while(true)
                {
                    //thread waits until there are any images to load in the queue
                    if(photosQueue.photosToLoad.size()==0)
                        synchronized(photosQueue.photosToLoad){
                            photosQueue.photosToLoad.wait();
                        }
                    if(photosQueue.photosToLoad.size()!=0)
                    {
                        PhotoToLoad photoToLoad;
                        synchronized(photosQueue.photosToLoad){
                            photoToLoad=photosQueue.photosToLoad.pop();
                        }
                        Bitmap bmp=getBitmap(photoToLoad.url);
                        memoryCache.put(photoToLoad.url, bmp);
                        String tag=imageViews.get(photoToLoad.imageView);
                        if(tag!=null && tag.equals(photoToLoad.url)){
                            BitmapDisplayer bd=new BitmapDisplayer(bmp, photoToLoad.imageView);
                            Activity a=(Activity)photoToLoad.imageView.getContext();
                            a.runOnUiThread(bd);
                        }
                    }
                    if(Thread.interrupted())
                        break;
                }
            } catch (InterruptedException e) {
                //allow thread to exit
                System.out.println("This is the Exit Point............");
            }
        }
    }

    PhotosLoader photoLoaderThread=new PhotosLoader();

    //Used to display bitmap in the UI thread
    class BitmapDisplayer implements Runnable
    {
        Bitmap bitmap;
        ImageView imageView;
        public BitmapDisplayer(Bitmap b, ImageView i){bitmap=b;imageView=i;}
        public void run()
        {
            if(bitmap!=null)
                imageView.setImageBitmap(bitmap);
            else
                imageView.setImageResource(stub_id);
        }
    }

    public void clearCache() {
        memoryCache.clear();
        fileCache.clear();
    }

} 
```

# asp.net - Request[] 集合的内容是什么

> ID：10609787
> 
> 赞同：0
> 
> 时间：2012-05-15T22:37:55.067
> 
> 标签：asp.net

当我将 Request 对象作为集合访问时，它从哪里获取数据？

例如我知道

```
Request["someKey"] 
```

将返回任何一个的值

```
Request.QueryString["someKey"] 
```

或者

```
Request.Form["someKey"] 
```

取决于设置。

是否搜索了任何其他集合（cookie、会话）？

键值对存在于几个集合中会发生什么？

我查看了 MSDN，但找不到太多信息。

[http://msdn.microsoft.com/en-us/library/system.web.httpcontext.request](http://msdn.microsoft.com/en-us/library/system.web.httpcontext.request)

谢谢您的帮助！

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-05-15T22:49:04.637

如果你反编译这个程序集并查看源代码，它会先查看`QueryString`, then `Form`, then `Cookies`, then `ServerVariables`, 然后最后返回`null`，如果它们都不包含该项。

```
public string this[string key]
{
    get
    {
        string item = this.QueryString[key];
        if (item == null)
        {
            item = this.Form[key];
            if (item == null)
            {
                HttpCookie httpCookie = this.Cookies[key];
                if (httpCookie == null)
                {
                    item = this.ServerVariables[key];
                    if (item == null)
                    {
                        return null;
                    }
                    else
                    {
                        return item;
                    }
                }
                else
                {
                    return httpCookie.Value;
                }
            }
            else
            {
                return item;
            }
        }
        else
        {
            return item;
        }
   }
} 
```

# c# - MVC3 如何在控制器的类中发布列表？

> ID：10609788
> 
> 赞同：1
> 
> 时间：2012-05-15T22:37:55.977
> 
> 标签：c#, jquery, asp.net-mvc-3

我有一堂课：

```
public class CarList
{
    public int quantity{get;set;}
    public List<Car> Cars {get;set;}
}

public class Car {
    public string Name {get;set;}
} 
```

然后，我创建了一个汽车列表，其中包含三辆汽车。然后，我使用 for 循环 Model.Cars 在屏幕上显示信息。当我提交表单时，数量字段具有有效值，但 Cars 为空。

```
[HttpPost]
public ActionResult Save(CarList list)
{
    //why is list.Cars NULL when i am posting three items in the list
} 
```

视图：Model = Car，添加一行

为 Car 添加了新的编辑器模板`<tr><td>Name</td><td>Html.TextBoxFor(x=>Model.Name)</td></tr>`

在主视图中：Model = CarList，添加了 forloop

```
@{foreach (Car item in Model.Cars)
       {
           @Html.EditorFor(x=>item);
       } 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-05-15T23:52:12.877

实际上，您不需要遍历汽车集合。你只是有它喜欢

```
@Html.EditorFor(x => x.Cars) 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-05-15T22:58:16.800

我认为这是问题所在：

```
@foreach (Car item in Model.Cars)
       {
           @Html.EditorFor(x=>item);
       } 
```

将其更改为

```
@foreach (Car item in Model.Cars)
       {
           @Html.EditorFor(x=>item.Name);
       } 
```

这可能是模型绑定器不够聪明，无法向下绑定多个级别的情况，尽管我不记得曾经遇到过这个问题。[将Glimpse (http://getglimpse.com/)](http://getglimpse.com/)添加到您的项目中也可能会有所帮助， 以便您可以查看请求的实际处理方式。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-05-15T23:50:04.000

使用**EditorTemplate**，你会很好。

**创建一个名为“ EditorTemplates** ”的文件夹并创建一个名为“EditorTemplates”的视图（编辑器模板）`Car.cshtml`

![在此处输入图像描述](../Images/50cc0782f3856c514d13213e3eb65a71.png)

现在将以下代码添加到这个新视图中。

```
@model Car
<p>
   @Html.TextBoxFor(x => x.Name)
</p> 
```

现在在您的主视图中，使用 Html.EditorFor HTML 辅助方法调用此编辑器模板

```
@model SO_MVC.Models.CarList
<h2>CarList</h2>
@using (Html.BeginForm())
{
    <p>Quanitty </p>
    @Html.TextBoxFor(x => x.quantity) 
    @Html.EditorFor(x=>x.Cars)
    <input type="submit" value="Save" />
} 
```

现在有一个 HTTPPOst 操作方法来接受表单发布

```
[HttpPost]
public ActionResult CarList(CarList model)
{
   //Check model.Cars property now.
} 
```

您现在将看到结果 ![在此处输入图像描述](../Images/5ec7e3b91f35a05e9416f38f02841b8a.png)

# php - call_user_func_array 太慢了吗？

> ID：10609794
> 
> 赞同：4
> 
> 时间：2012-05-15T22:38:10.953
> 
> 标签：php, mysql

我正在使用 mysqli 和准备好的语句为我的数据库编写一个简单的搜索引擎，我目前正在使用 call_user_func_array 来动态创建我的查询。我的问题是：使用 mysqli 是否有更快或更好的方法来做到这一点？这是我的代码：

```
<?php 
session_start();
require('../../../scripts/bkfunctions.php');
header('Cache-Control: no-cache, must-revalidate');
header('Expires: Mon, 26 Jul 1997 05:00:00 GMT');
header('Content-type: application/json');

//////////////////
$resultParameters = array();
$paramsArr =array();
$results = array();

////DB OPEN//////////////////////////////////////////
$conn = dbConnect("ITbunker");
$paramsArr = explode(",", $_GET['paramsQuery']);
$qStr="";
$bindParams = array('s');

    ////////////////////////////////////
    foreach ($paramsArr as $n=>$k) {

            if ($n==0) {
            $qStr = "SELECT * FROM trabajosEnSubasta WHERE MATCH(titulo, descripcion, habilidades) AGAINST (?)";
            }
            else {
            $qStr .= " UNION SELECT * FROM trabajosEnSubasta WHERE MATCH(titulo, descripcion, habilidades) AGAINST (?)";
            $bindParams[0] .= 's';
            }
            array_push($bindParams, $k);
    }
    ///////////////////////////////////////

    ///Preparar query y ejecutar
    $stmt = $conn->prepare($qStr);
    call_user_func_array(array($stmt, 'bind_param'), makeValuesReferenced($bindParams));
    $stmt->execute();

/////////////////////////////////////////////////////////////////////////////////////////*

$meta = $stmt->result_metadata();  

    while ($campo = $meta->fetch_field() ) {
    $resultParameters[] = &$row[$campo->name];
    }
    call_user_func_array(array($stmt, 'bind_result'), $resultParameters);

    $i=0;
    while ( $stmt->fetch() ) {  
        $i++;
        foreach( $row as $key => $val ) {
        $results["resultado$i"][$key] = $val;
        }  
    }

echo json_encode($results);
///////////////////////////////////////////////////

$conn->close();
?> 
```

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-05-16T10:33:27.983

您的问题有很多要解决的问题 - 而`call_user_func_array`不是其中之一。

**查看您的查询**

这是您正在构建的查询类型：

```
SELECT
    * 
FROM 
    trabajosEnSubasta 
WHERE 
    MATCH(titulo, descripcion, habilidades) AGAINST (?)
UNION 
    SELECT
        * 
    FROM 
        trabajosEnSubasta 
    WHERE 
        MATCH(titulo, descripcion, habilidades) AGAINST (?)
UNION 
    SELECT
        ... 
```

而且..它引出了你为什么要这样做的问题。这在功能上是相同的，并且执行起来可能要快得多：

```
SELECT
    * 
FROM 
    trabajosEnSubasta 
WHERE 
    MATCH(titulo, descripcion, habilidades) AGAINST (?)
    OR
    MATCH(titulo, descripcion, habilidades) AGAINST (?)
    OR
    ... 
```

**看看你的逻辑**

```
$paramsArr = explode(",", $_GET['paramsQuery']); 
```

因此，请求 url like`/foo?paramsQuery=a,b,c,d,e,f,g,h,i,j`当前将触发 10 个表联合查询，如果您更新查询语法，那将是 10 个全文索引查询。这真的是你想要的吗？可能是 - 但例如，如果有人搜索已知的 habilidad，这样做会更有效率：

```
SELECT
    trabajosEnSubasta.*
FROM
    trabajosEnSubasta
LEFT JOIN
    habilidades_map ON habilidades_map.trabajo_id = trabajosEnSubasta.id
WHERE
    habilidades_map.habilidad = "known habilidad" 
```

全文索引查询起来相对昂贵，并且不应该是您搜索数据的唯一方法。

**分析您的代码**

我不得不假设您正在询问，`call_user_func_array`因为您的代码执行速度很慢。不要猜测代码中的问题出在哪里，**并找出**问题所在。

*   使用[explain](http://dev.mysql.com/doc/refman/5.5/en/explain.html)查看您的查询在做什么
*   使用[xdebug 分析](http://xdebug.org/docs/profiler)来查看你的代码在哪里花费它的时间
*   [Webgrind](http://code.google.com/p/webgrind/)是一种易于安装的查看 xdebug 配置文件输出的方法。

**不要浪费时间优化 0.01%**

`call_user_func_array`确实有使用成本，这就是存在这样的[代码](https://github.com/cakephp/cakephp/blob/master/lib/Cake/Core/Object.php#L102)的原因。但是差异确实非常微不足道（尤其是考虑到问题中的超重 UNION 查询），除非您将其称为数百次以上。专注于对您的应用程序性能影响最大的事情，而不是那些绝对无法以某种方式产生可衡量差异的事情。

# php - PHP 使用 SPL 迭代器递归删除空目录

> ID：10609805
> 
> 赞同：6
> 
> 时间：2012-05-15T22:39:18.177
> 
> 标签：php, iterator

我正在努力解决如何使用 SPL 迭代器删除 PHP 中的空目录树。考虑以下所有目录为空的目录结构：

> /顶部目录
> 
> ```
>  level1
> 
>        level2 
> ```

我尝试了以下方法：

```
$it = new RecursiveIteratorIterator(new RecursiveDirectoryIterator(
    '/topdir', RecursiveIteratorIterator::CHILD_FIRST
));

foreach ($it as $file) {
    if ($file->isDir()) {
        rmdir((string)$file);
    }
} 
```

但是`RecursiveIteratorIterator::CHILD_FIRST`阻止底层文件成为循环的一部分，我得到标准的`Directory not empty`E_WARNING 因为 level1 不是空的。

如何使用 SPL 迭代器递归删除空目录树？注意：我知道如何使用 , 等来执行此操作`glob`。`scandir`请不要将这些/类似功能作为解决方案提供。

我觉得我必须在这里遗漏一些非常基本的东西......

* * *

## 回答 #1

> 赞同：10
> 
> 时间：2012-05-15T22:58:04.227

它是对`RecursiveIteratorIterator`子目录的实际访问。唯一为它`RecursiveDirectoryIterator`提供了把手。

因此，您需要在`RecursiveIteratorIterator`而不是在CHILD_FIRST 上设置标志`RecursiveDirectoryIterator`：

```
$it = new RecursiveIteratorIterator(new RecursiveDirectoryIterator('/topdir', FilesystemIterator::SKIP_DOTS), RecursiveIteratorIterator::CHILD_FIRST
);

foreach ($it as $file) {
    if ($file->isDir()) {
        rmdir((string)$file);
    }
} 
```

为了防止出现警告，还要将`::SKIP_DOTS`标志添加到`RecursiveDirectoryIterator`

# maven-plugin - 发现以元素“包装”开头的 Maven 无效内容

> ID：10609809
> 
> 赞同：1
> 
> 时间：2012-05-15T22:39:45.303
> 
> 标签：maven-plugin, pom.xml

我正在使用带有 apache wicket 的 eclipse maven 项目。当我将带有标签的 wicket-examples 依赖项添加到 pom xml 时，出现错误：

cvc-complex-type.2.4.a：发现以元素“包装”开头的无效内容。'{" [http://maven.apache.org/POM/](http://maven.apache.org/POM/) 4.0.0":type、" [http://maven.apache.org/POM/4.0.0](http://maven.apache.org/POM/4.0.0) ":classifier、" [http://maven之一.apache.org/POM/4.0.0](http://maven.apache.org/POM/4.0.0) ":scope, " [http://maven.apache.org/POM/4.0.0":systemPath](http://maven.apache.org/) , " [http://maven.apache.org/POM/4.0.0](http://maven.apache.org/POM/4.0.0) ":exclusions, " [http://maven.apache.org/POM/4.0.0](http://maven.apache.org/POM/4.0.0) ":optional}' 是预期的。

POM.XML：

```
<project xmlns="http://maven.apache.org/POM/4.0.0" xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance"
    xsi:schemaLocation="http://maven.apache.org/POM/4.0.0 http://maven.apache.org/maven-v4_0_0.xsd">
    <modelVersion>4.0.0</modelVersion>

<dependencies>
    <!-- WICKET DEPENDENCIES -->
    <dependency>
        <groupId>org.apache.wicket</groupId>
        <artifactId>wicket-examples</artifactId>
        <version>1.5.5</version>
        <packaging>war</packaging>
    </dependency> 
```

...

你能帮我吗？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-01-03T15:04:10.513

Instead of '**packaging**' use '**type**'

```
 <dependency>
        <groupId>org.apache.wicket</groupId>
        <artifactId>wicket-examples</artifactId>
        <version>1.5.5</version>
        <type>war</type>
    </dependency> 
```

# emulation - 仿真：无条件跳转和 PC 通过 CPU 周期递增

> ID：10609818
> 
> 赞同：2
> 
> 时间：2012-05-15T22:40:20.797
> 
> 标签：emulation, gameboy

我正在编写一个简单的 GB 模拟器（哇，现在这是新的东西，不是吗），因为我真的在 emu 中迈出了第一步。

我似乎不明白的是如何正确实现 CPU 周期和无条件跳转。

如果我有一个基本循环，请考虑命令 JP nn（指出的无条件跳转到内存地址），例如 JP 1000h：

```
increment PC
read opcode
execute command 
```

然后在读取 JP 操作码并执行命令后（从内存中读取 1000h 并设置 PC = 1000h），PC 会递增并变为 1001h，从而导致仿真不良。

**tl; dr 当有增加 PC 的 cpu 循环时，您如何模拟模拟器中的跳转，以使 PC 值保持正确？**

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-05-15T22:44:07.703

移动`increment PC`到循环的末尾，它是否根据操作码有条件地执行？

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-05-15T22:55:45.120

我对仿真几乎一无所知，但我想到了两种明显的方法。

1.  与其硬编码`PC += 1`到主循环中，不如让评估是否每个操作码返回下一个 PC 值（或偏移量，或表示是否增加它的标志等）。然后跳转和其他操作码（它们对程序计数器的影响）之间的区别以及关于它们的所有其他内容都是可以定义的。

2.  知道主循环总是将 PC 加 1，只需执行跳转将 PC 设置为`target - 1`而不是`target`.

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-05-15T23:00:45.167

每次用于返回字节时，PC 都应作为“原子”操作递增。这意味着立即操作数和操作码。

在您的示例中，PC 将被使用三次，一次用于操作码，两次用于两个操作数字节。当 CPU 获取三个字节并可以加载 PC 时，PC 已经指向第二个操作数之后的下一条指令操作码，但是，由于实际执行指令会重新加载 PC，所以没关系.

# asp.net-mvc-3 - 我可以从 ZedGraph 生成图像结果吗？

> ID：10609820
> 
> 赞同：0
> 
> 时间：2012-05-15T22:40:43.020
> 
> 标签：asp.net-mvc-3, zedgraph

我正在尝试使用 MVC 中的 ZedGraph。我可以从 ZedGraph 生成图像结果并从我的视图中引用它吗？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-05-17T17:11:05.557

好的，所以我想出了如何：

```
public FileContentResult Graph()
{
    var web = new ZedGraphWeb();
    web.Height = 450;
    web.Width = 800;
    web.RenderGraph += (w, g, masterPane) =>
                       {
                           GraphPane myPane = masterPane[0];
                           var xData = new double[] { 1, 2, 3 };
                           var yData = new double[] { 10, 60, 50 };
                           myPane.AddCurve("Allocated", xData, yData, Color.Black);
                       };
    var ms = new MemoryStream();
    web.CreateGraph(ms, ImageFormat.Png);
    return new FileContentResult(ms.ToArray(), "image/png");
}

<img src="@Url.Action("Graph")"/> 
```

ZedGraph 可以在 Windows 窗体中使用，也可以用作 ASP.NET Web 控件。从 MVC 中使用它更难，这种图像方法是我想出的方法。我认为在 MVC 中使用 ASP.NET Web 控件是可能的（有人知道怎么做吗？）。如果您有任何其他建议，请发布。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-11-15T09:28:02.270

如何做到这一点的另一个[例子。](http://blog.denouter.net/2012/03/zedgraph-in-mvc3.html)

# javascript - 某些 JavaScript 库是否使用原型系统的动态方面？

> ID：10609822
> 
> 赞同：1
> 
> 时间：2012-05-15T22:40:45.410
> 
> 标签：javascript, prototype

使用原型创建的 JavaScript 对象保持与其原型的“实时”连接，因此更改原型也会影响从它创建的对象。

如果新创建的对象只是从原型中复制所有内容然后忘记它，那么语言的语义会简单得多。当然，实际的底层实现可能更智能。

实时/动态连接的这种特性是否实际用于某些知名的 JavaScript 库或程序中？

编辑：我并不是说 JS 继承系统有缺陷，我只是想了解上述功能的好处。

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-05-15T22:44:47.587

一定。我认为这个特性最突出的用途是动态添加方法到 jQuery 原型（称为“插件”），它被暴露为`jQuery.fn`.

我不明白为什么你认为“如果新创建的对象只是复制原型属性，语言的语义会简单得多”。为什么会更简单？您可以使用该方法创建对象，使用`extend()`函数，但这会颠覆原型继承的概念。

在 Javascript 中具有非静态继承是核心功能之一。修改已生成实例的原型对象很有用：

*   添加功能，如上所述。只有在需要时才能加载整个插件。
*   增强功能（有时）。这通常用于覆盖非标准行为
*   真正改变它们（很少）。这可以与配置对象一起使用，这些对象继承自具有默认设置的对象。然后您可以更改默认设置，它们将适用于所有实例（至少适用于没有覆盖相关属性的实例）。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-05-15T22:49:18.790

在最近的一次演讲中，Brendan Eich 将 Javascript 描述为一种“目标”语言，这使得 Jquery 或 CoffeeScript 等库可以在其上编写，库原型用于更快地公开常用函数和方法，查看 javascript很好的原型示例的游戏框架

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2015-03-11T12:12:30.730

这种活力存在于修补旧浏览器的 polyfill 库中，例如通过添加`Array.prototype.map`或添加来自 ES6 的即将推出的新功能，例如`Array.prototype.find`. 有关示例，请参见[https://github.com/paulmillr/es6-shim/ 。](https://github.com/paulmillr/es6-shim/)

# ruby - 不需要重要吗？

> ID：10609823
> 
> 赞同：3
> 
> 时间：2012-05-15T22:41:09.763
> 
> 标签：ruby, require

我希望能够拥有一个包含`require`所有常见依赖项的 ruby​​ 文件，以便其他文件可以`require`在此共享文件上只有一个。例如；我有*foo.rb*和*bar.rb*和*allrequires.rb*。我想`require "allrequires.rb"`在*foo.rb*和*bar.rb*中都有这条线，但`bar.rb`不需要所有要求。

如果我`require`在不需要该文件的 .rb 文件中使用它有关系吗？它可能会对性能产生影响吗？

我目前在`ruby 1.8.7 (2010-08-16 patchlevel 302) [i386-mingw32]`

# 更新

看起来在两个 .rb 文件中“共享”/使用所有要求并不是最好的主意。有什么解决办法呢？

现在我可以考虑在条件中使用文件名。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-05-15T23:27:14.917

有两个主要的性能惩罚：

1.  自己做的时间`require`。在 Ruby 1.9.1 和 Ruby 1.9.2 中，完成所有`require`s 所花费的时间比线性可伸缩性更差——如果你将`require`s 的数量增加一倍，它花费的时间是你的两倍多——我认为它花费了你四倍的时间长。
2.  执行文件中的代码所花费的时间为`require`d。如果您有如下代码，那么执行代码将花费大量时间。

```
class MyClass
  MY_CONSTANT = File.read("data.txt")
end 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-05-16T10:08:48.407

另一种条件要求方法，以下脚本在 JSON 解析器上没有错误，因为它被命名为 require1.rb，在没有名称的脚本中，如 script2.rb 的 require1.rb 不需要 gem

```
require 'json' if "require1.rb, script2.rb"[File.basename(__FILE__)]

p File.basename(__FILE__)

text = '[{ "name" : "car", "status": "good"}, { "name" : "bus", "status": "bad"},{ "name" : "taxi", "status": "soso"},
  {"noname":"", "status" : "worse"}
]' 
data = JSON.parse(text) 

p data.collect { |item| item['name'] } 
```

编辑：这里有一个使用数组的版本

```
["require1.rb","script1.rb"].find{|script|require 'json' if script===File.basename(__FILE__)} 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-05-16T09:59:53.137

是的，将会有一个速度分析，如果它真的很重要，你可以基准如何考虑。有了多个要求，我像这样将下摆放在我的代码中，这样它就不会占用太多屏幕空间。

```
['green_shoes','Hpricot'].each(&method(:require)) 
```

你也可以做一个有条件的要求，但是在你的代码周围会很难看

```
begin
  data = JSON.parse(text)
rescue
  require 'json_pure' 
  data = JSON.parse(text)
end 
```

所以简而言之，给每个 rb 自己的要求

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2012-05-23T00:28:41.437

我的最终解决方案是（以防有人发现它有用）：

requires.rb 从 web.rb 或 testweb.rb、rufus.rb 或 testrufus.rb 调用

```
called_from=caller[0].split(":")[0]

puts "loading web 'requires' for file: #{called_from} ..." if (["web"].any?{|s| called_from[s]})
puts "loading web 'requires' for file: #{called_from} ..." if (["rufus"].any?{|s| called_from[s]})
puts "loading web 'requires' for file: #{called_from} ..." if (["settings"].any?{|s| called_from[s]})

require 'rubygems'

require 'socket'        if (["web","settings"].any?{|s| called_from[s]})
require 'ruby-growl'    if (["web","settings","rufus"].any?{|s| called_from[s]})
require 'sinatra'       if (["web"].any?{|s| called_from[s]}) 
```

感谢@Andrew 的解释和@peter 的提示如何解决这个问题。

# maven-2 - Maven 程序集插件 - 多模块项目 - 源代码和 javadoc 未添加到 zip 文件中

> ID：10609836
> 
> 赞同：3
> 
> 时间：2012-05-15T22:42:44.340
> 
> 标签：maven-2, maven-assembly-plugin

我有多模块项目并使用 maven 的程序集插件来压缩项目的工件。

```
Proj
 +Module A
   pom.xml
 +Module B
   pom.xml
pom.xml 
```

当我构建主模块时，它将产生以下内容

```
Proj
 +Module A
   target\A.jar
   target\A-source.jar
   target\A-javadoc.jar
 +Module B
   target\B.jar
   target\B-source.jar
   target\B-javadoc.jar 
```

1）我在 ModuleB pom 文件下添加了程序集插件，我在程序集描述符文件中使用了 ModuleSet

```
<moduleSets>
    <moduleSet>
       <useAllReactorProjects>true</useAllReactorProjects>
      <includes>
        <include>groupA:A:jar</include>
        <include>groupA:A:javadoc</include>
        <include>groupA:A:source</include>  
      </includes>
      <binaries>
        <outputDirectory>moduleA</outputDirectory>
        <unpack>false</unpack>
      </binaries>
    </moduleSet>

    <moduleSet>
    <useAllReactorProjects>true</useAllReactorProjects>
      <includes>
        <include>groupB:B:jar</include>
        <include>groupB:B:javadoc</include>
        <include>groupB:B:source</include>
      </includes>
      <binaries>
        <outputDirectory>moduleB</outputDirectory>
        <unpack>false</unpack>
      </binaries>
    </moduleSet>
  </moduleSets> 
```

但我在 zip 文件下只得到 A.jar 和 B.Jar。我没有在 zip 文件中获取 javadoc 和源代码。是从 m2 repo 下载它吗，我怀疑它是否这样做，因为在 maven reporee 工件中不会有源代码和 java doc。如何在 zip 文件中添加所有三个工件？

2）我想在我的父 pom 中而不是在 ModuleB 的 pom 中添加程序集插件，但如果我这样做，我会得到一个异常“请确保在生成程序集之前运行包阶段”。谷歌搜索后，我发现很少有人建议将程序集添加为模块。有没有其他方法来处理这个？

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-05-22T18:09:06.763

我使用dependecySet来解决这个问题，我们可以使用通配符添加所有二进制文件。

```
<assembly xmlns="http://maven.apache.org/plugins/maven-assembly-plugin/assembly/1.1.0" xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance"
  xsi:schemaLocation="http://maven.apache.org/plugins/maven-assembly-plugin/assembly/1.1.0 http://maven.apache.org/xsd/assembly-1.1.0.xsd">
  <id>bin</id>
  <includeBaseDirectory>false</includeBaseDirectory>
  <formats>
    <format>zip</format>
  </formats>
 <dependencySets>
        <dependencySet>
            <includes>
                <include>groupA:*:*:*</include>
            </includes>
            </dependencySet>
         </dependencySets>
</assembly> 
```

这将添加项目的所有二进制工件。还要注意的另一件事是程序集描述符中使用的 id。它应该是二进制工件的 bin。如果有人遇到类似问题，请在此处发布，这可能会有所帮助。

# ios - 无延迟地对 MPMoviePlayer 缩略图应用过滤器

> ID：10609841
> 
> 赞同：0
> 
> 时间：2012-05-15T22:42:59.543
> 
> 标签：ios, filter, uiimage, cgimage, mpmovieplayer

我能够从 MPMoviePlayer 中的缩略图生成 CGImage。我想要做的是在图像上应用过滤器并尽快将其显示在设备上（可能在 UIImageView 中）。

这里需要注意的是，我需要将过滤器应用于视频的每一帧，以便用户在视频流中看到过滤后的图像，而不会出现延迟。

目前我得到缩略图，应用我的过滤器，并将我的 UIImageView.image 设置为这个过滤后的图像。过滤器工作正常，图像显示，但应用程序确实滞后。有什么办法可以加快这个速度吗？

我也尝试过使用 CAdisplaylink，因为这帮助我加快了多个 UIImage 一次在屏幕上飞来飞去的速度，但在这种情况下它没有做任何事情。任何帮助，将不胜感激。

谢谢你。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-08-16T01:29:13.763

使用 Brad Larsons GPUImage 框架。简而言之……太棒了。

概述如下： GPUImage 框架是一个 BSD 许可的 iOS 库，可让您将 GPU 加速的滤镜和其他效果应用于图像、实时摄像机视频和电影。与 Core Image（iOS 5.0 的一部分）相比，GPUImage 允许您编写自己的自定义过滤器，支持部署到 iOS 4.0，并具有更简单的界面。但是，它目前缺少 Core Image 的一些更高级的功能，例如面部检测。

对于处理图像或实时视频帧等大规模并行操作，GPU 比 CPU 具有一些显着的性能优势。在 iPhone 4 上，一个简单的图像过滤器在 GPU 上的执行速度比同等的基于 CPU 的过滤器快 100 倍以上。

这是[链接](https://github.com/BradLarson/GPUImage) [https://github.com/BradLarson/GPUImage](https://github.com/BradLarson/GPUImage)包含指向 git 存储库的页面、详细信息和示例项目，其中使用许多过滤器完成实时处理。

# java - REST (Jersey) 调用永远接受一定数量的请求

> ID：10609854
> 
> 赞同：0
> 
> 时间：2012-05-15T22:44:51.727
> 
> 标签：java, rest, jersey

基本信息：REST 请求，使用 Jersey (Java)

我正在做一个项目，其中有一个引用单个项目的数字列表。

用户可以点击一个项目编号并加载和呈现相应的项目/数据。

我们遇到了这个奇怪的问题，在大约第 14 次点击之后（方向无关紧要），一个单一的 REST 调用需要*永远*。

在第 14 次（左右）点击之后，每增加一次点击，我们就会再谈 500 毫秒到 1 秒。我有足够的耐心把它开到 15 秒。

Chrome 在事件的“等待”部分显示 < 2 秒，在接收状态下显示 2 秒以上*360 字节*。

关于可能导致这种情况的任何想法？

我写了一个测试页面，只是用几十个请求敲击服务器。正如预期的那样，浏览器一次阻止了 6 个以上的加载。单独的 6 个请求集表现正常。

我还尝试按顺序发出相同的 REST 请求，等待一个完成，然后等待 500 毫秒，然后再次调用它以模拟用户单击其他项目。表现如预期。

我的测试页面和实际部署的版本之间只有两个区别。

1）我们进行了 3 次 ajax 调用（2 次调用相同的 rest 服务，1 次调用不同的服务）总是按时完成。这三个甚至在第四个（麻烦的一个）开始之前就完成了。

2) 我们有一个“自动”保存功能，可以在 30 秒计时器上完成上述操作。这从来没有问题，并且总是按预期按时完成。

感谢社区。几天来一直在努力解决这个问题，我已经束手无策了。:P

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-05-15T23:02:47.797

你有访问服务器端的权限吗？

你在日志中看到了什么异常？

您是否尝试并测量服务层中每个方法的执行时间？

你可能想看看：

[http://codemate.wordpress.com/2009/05/08/cpu-profiling-explained/](http://codemate.wordpress.com/2009/05/08/cpu-profiling-explained/)

也许还有内存分析但不一定因为你没有内存不足异常

# ruby-on-rails - Rails PostgreSQL 数值字段溢出错误

> ID：10609855
> 
> 赞同：3
> 
> 时间：2012-05-15T22:45:05.053
> 
> 标签：ruby-on-rails, ruby, database, ruby-on-rails-3, postgresql

我的架构上有一个十进制的价格字段，每次我尝试插入价格时，pg 都会出现此错误。任何人都可以给我任何光吗？谢谢

**配置**

```
t.decimal  "price",  :precision => 2, :scale => 2 
```

**错误**

```
PG::Error: ERROR:  numeric field overflow
DETAIL:  A field with precision 2, scale 2 must round to an absolute value less than 1.
: INSERT INTO "items" ("category_id", "name", "price", "updated_at") VALUES ($1, $2, $3, $4, $5, $6, $7, $8, $9, $10, $11, $12, $13, $14) RETURNING "id" 
```

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2012-05-15T22:57:57.050

我引用了[任意精度数](http://www.postgresql.org/docs/current/interactive/datatype-numeric.html#DATATYPE-NUMERIC-DECIMAL)的手册：

> 数字的小数位数是小数部分中小数位数的计数，位于小数点右侧。数字的精度是整数中有效位数的总数，即小数点两边的位数。

您不能将数字分配给`>= 1`数据类型的列`numeric(2,2)`。小数点前没有数字的空间。

`0.999`并且`0.995`也违反了类型，因为它们以`1`给定的*比例四舍五入**2*。

# r - 从 R 编辑 Fortran 引用的代码

> ID：10609864
> 
> 赞同：3
> 
> 时间：2012-05-15T22:46:10.677
> 
> 标签：r, fortran, edit

我希望能够编辑 fGarch 包中引用的 Fortran 代码。

更具体地说，我想编辑 fGarch::garchFit 可以使用的可用条件分布，即包括稳定分布和广义双曲线分布。

因此，在查看了 garchFit() 函数之后，我深入研究了代码，并且 .aparchLLH.internal() 是从 garchFit() 函数中引用的，并且其中有一行引用了 Fortran 编写的代码。

我所指的具体行是以下代码：

```
 fit <- .Fortran("garchllh", N = as.integer(N), Y = as.double(.series$x), 
        Z = as.double(.series$z), H = as.double(.series$h), 
        NF = as.integer(NF), X = as.double(params), DPARM = as.double(DPARM), 
        MDIST = as.integer(MDIST), MYPAR = as.integer(MYPAR), 
        F = as.double(0), PACKAGE = "fGarch") 
```

我相信 Fortran 函数 garchllh 是我想要编辑的，但不知道如何编辑它，以便我可以将新分布引入 garchFit() 函数。

NB 作为一个注释，我在 Fortran 代码方面没有太多经验，但想看看它是否可以编辑和更改以适合我的目的，所以对 Fortran 代码编辑部分的任何帮助将不胜感激...

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-05-16T14:12:56.540

正如评论中提到的，您需要下载源代码——一个好的地方是开始`install.packages("fGarch",type="source")`并看到一切都正确编译。然后，查看包源——似乎您需要对 dist.f 进行非常简单的调整，并且可能对设置 MDIST 的各个位置添加更多更改——从`grep MDIST *.R`提取源的 R 目录开始。完成并测试后，您还可以与包维护人员交谈——也许他们会在下一个版本中包含您的添加:)

# c# - 不包含“显示”的定义并且没有扩展方法“显示”错误

> ID：10609866
> 
> 赞同：0
> 
> 时间：2012-05-15T22:46:15.797
> 
> 标签：c#, wpf, xaml

我正在尝试使用以下代码显示 PluginManagerView 的实例。

此 XAML 文件位于同一命名空间、同一项目中。但是我在`mainwindow.Show();`说那句话时遇到了一个错误

```
Error 1 'PluginManager.PluginManagerView' does not contain a definition for 'Show' and no extension method 'Show' accepting a first argument of type 'PluginManager.PluginManagerView' could be found (are you missing a using directive or an assembly reference?) Blah procedyre .cs  30  24  PluginManager 
```

谁能告诉我问题是什么？为什么它不会为 MainWindow 的先前用法抛出错误？

```
using System;
using System.Collections.Generic;
using System.Configuration;
using System.Data;
using System.Linq;
using System.Windows;
using System.ComponentModel.Composition.Hosting;

namespace PluginManager
{
    public class PublicProcedures : Application
    {
        public static void ShowPlugins()
        {
            var mainwindow = new PluginManagerView();

            //An aggregate catalog that combines multiple catalogs

            var catalog = new AggregateCatalog();
            //Adds all the parts found in the same assembly as the Program class
            //catalog.Catalogs.Add(new AssemblyCatalog(this.GetType().Assembly));
            catalog.Catalogs.Add(new DirectoryCatalog("./Plugins/"));

            var container = new CompositionContainer(catalog);

            var modules = container.GetExportedValues<IPlugin>();

            mainwindow.DataContext = modules;
            mainwindow.Show();
        }

    }

} 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-05-16T07:38:27.783

为了调用[Window.Show](http://msdn.microsoft.com/en-us/library/system.windows.window.show.aspx)（我猜这是你想要做的）， PluginManagerView 必须从类[Window](http://msdn.microsoft.com/en-us/library/ms590112)派生，它的 XAML 必须看起来像这样：

```
<Window x:Class="PluginManager.PluginManagerView" ...>
    ...
</Window> 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-05-15T22:58:57.230

它抱怨不管`PluginManagerView`是什么，它都没有一个`Show`方法（你试图在一个`PluginManagerView`名为“mainwindow”的实例中调用它）。

# function - Mathematica 对一组点进行积分以获得函数的解析形式

> ID：10609870
> 
> 赞同：0
> 
> 时间：2012-05-15T22:46:26.737
> 
> 标签：function, wolfram-mathematica, integration, numerical

我有以下问题 - 我需要在 Mathematica 中集成这样的功能（我无法发布图像，所以我以乳胶形式编写它）：

G(r)= \int_{0}^{\infty} dq f(q)*q*sin(qr)/r

获得依赖于 r 的函数 G(r)。不过我不知道 f(q) 的解析形式，而是我有一组 f(q) 和 q 的值。所以我想进行某种数值积分，但之后接收的不是一个值，而是 G(r) 的曲线。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-05-15T23:05:56.673

如果你知道函数的解析形式，`f[q]`你可以这样做：

```
Integrate[f[q] q Sin[q r]/r, {q, 0, Infinity}] 
```

但是如果只知道你的值`f[q]`可以进行数值积分：

```
G[r_]:= NIntegrate[ f[q] q Sin[q r]/r, {q, 0, Infinity}] 
```

假设例如

```
f[q_] := Exp[-q]
Integrate[f[q] q Sin[q r]/r, {q, 0, Infinity}] 
```

产量

```
ConditionalExpression[2/(1 + r^2)^2, Abs[Im[r]] < 1] 
```

您可以先验地做出假设，例如：

```
Assuming[r > 0, Integrate[f[q] q Sin[q r]/r, {q, 0, Infinity}]] 
```

产量

```
2/(1 + r^2)^2 
```

假设`r > 0`你隐含地假设`r`是真实的，所以`Im[r] == 0`. 有了这个函数`G[r]`，我们可以绘制适当的曲线，定义`f[q]`如上：

```
Plot[ G[r], {r, 0, 10}] 
```

![在此处输入图像描述](../Images/df3c6fffd47b3b4721eb6e6b034f68e5.png)

# java - 如何在 Joda Time 中表示“美国东部标准时间上午 9 点”？

> ID：10609874
> 
> 赞同：2
> 
> 时间：2012-05-15T22:47:03.857
> 
> 标签：java, jodatime

Joda Time 似乎处理了拥有关于特定时刻的一些信息的概念，但不是全部。例如，`LocalTime`该类可以表示时间“9:43:17 AM”，并且`LocalDate`该类知道“2010 年 7 月 7 日”，而与时区无关。

但是我有一堆 Instant，我想知道它们中的哪一个发生在“太平洋标准时间上午 9 点”之后。也就是说，在 PST 中，哪些输入时刻发生在上午 9 点之后？

这可以在 Joda Time 中轻松表达吗？如果有办法解析像“9:43 AM EST”这样的字符串，则可以加分

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-05-16T03:04:30.797

“部分”时间类（以及`PartialTime`它们实现的接口）都不能代表时区。这就是文档所说的。所以你**必须分别**代表时区。

作为结果，

*   您需要手动进行“东部标准时间上午 9 点之后”的计算，并且
*   你不能直接解析像“9:43 AM EST”这样的字符串。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-09-10T18:08:45.670

我有一个类似的问题，我没有找到满意的代码答案。所以这就是我所做的：（对不起，我把它保存在 Scala 中）

```
def nineAMOfDate(date: DateTime) = {
  new DateTime(date.getYear, date.getMonthOfYear, date.getDayOfMonth, 9, 0, DateTimeZone.forID("America/New_York"))
} 
```

据我了解，这将使用东部流行时间。

# wcf - System.Net.WebException：远程服务器返回错误：（401）在 Windows 服务中托管的 WCF 中未授权

> ID：10609875
> 
> 赞同：0
> 
> 时间：2012-05-15T22:47:08.087
> 
> 标签：wcf

我有一个托管在 Windows 服务中的 WCF 服务，并且 Windows 服务使用“本地系统帐户”运行。服务正在尝试从 SharePoint 服务器下载文件并失败并出现错误：

**System.Net.WebException：远程服务器返回错误：（401）未经授权。在 System.Net.WebClient.DownloadFile（Uri 地址，字符串文件名） 在 System.Net.WebClient.DownloadFile（字符串地址，字符串文件名）**

类似的设置在另一台机器上工作，服务能够与 Sharepoint 站点通信，但不能在我的服务器中。我已经在另一台机器上尝试过这个设置，但除了一台机器之外，同样的错误。

与 SharePoint 通信需要哪些权限？另外，如何检查请求期间传递的凭据是什么？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-05-16T02:57:40.920

如果此处涉及证书，请查看这是否是证书问题。使用[MMC 管理单元](http://msdn.microsoft.com/en-us/library/ms788967.aspx)并比较工作机器和非工作机器上的证书。

# javascript - 设计模式中的浏览器在 UL 中包装孤立的 LI 元素 - Firefox 和 Chrome

> ID：10609876
> 
> 赞同：1
> 
> 时间：2012-05-15T22:47:10.103
> 
> 标签：javascript, browser, tinymce, wysiwyg, designmode

我正在使用 TinyMce 为 Web 应用程序实现 WYWIWYG 编辑器。该应用程序允许用户编辑包含部分 HTML 的令牌。例如，正在编辑的令牌可能包含：

> <li>一些文字</li>

但是，当我在编辑器上调用 SetContent 并使用值 <li>some text</li> 时，该元素会自动包装在 <ul> 元素中。据我所知，这不是由 TinyMCE 完成的，而是由浏览器本身完成的。

我知道这是浏览器创建有效 HTML 的方式，不幸的是我没有任何办法允许用户编辑无效元素（无效仅因为 li 不在 ul 中）。

这发生在 FireFox 和 Chrome 中，有没有办法阻止浏览器这样做（调用 setHtml 时）并允许无效的 HTML（甚至说，打开 p 标签）？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-05-23T09:00:26.947

为什么你想要无效的 html？

除此之外，您应该仔细查看 tinymce 配置设置[valid_children](http://www.tinymce.com/wiki.php/Configuration%3avalid_children)和[valid_elements](http://www.tinymce.com/wiki.php/Configuration%3avalid_elements)。

# facebook - 实际重定向到外部网站的 Facebook 应用

> ID：10609879
> 
> 赞同：0
> 
> 时间：2012-05-15T22:47:33.613
> 
> 标签：facebook, facebook-php-sdk

我看到一些 Facebook 应用程序不是使用 Canvas iframe 的普通应用程序，而是将用户重定向到外部网站，例如

[http://www.facebook.com/foursquare](http://www.facebook.com/foursquare)

查看转到应用程序链接是如何转到网站的，如果您在时间线或新闻提要中看到帖子，则`via Foursquare`显示当您悬停时显示弹出窗口的链接也直接链接到网站。

Neowin 应用页面上也有这样的示例：

![在此处输入图像描述](../Images/86383ba449e6b48368e586df56e81c6d.png)

我的问题是你如何创建这个？

因为我已经为我正在构建的产品创建了一个 Facebook 页面，该页面将允许用户发布到他们的时间线等，但实际上不会是一个应用程序，因为网站本身就是应用程序，而不是在 Facebook 上查看的 iframe。

它不能是任何重定向脚本，因为链接的浏览器状态栏中显示的 url 是实际网站，因此链接本身已被修改，而不是在用户访问画布页面时重定向用户......

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-05-16T00:30:49.727

好吧，我认为这是 facebook.stackoverflow 的一个有效问题。

除了您的页面，您还需要在[Facebook Apps Dashboard](https://developers.facebook.com/apps)中创建一个应用程序。在应用程序设置中，只需检查网站并输入您的 URL。取消选中画布页面“Facebook 上的应用”。

转到应用程序或单击帖子底部的链接将自动打开网站，而不是画布。

# spring - 页面中的更多 bean

> ID：10609880
> 
> 赞同：0
> 
> 时间：2012-05-15T22:47:40.707
> 
> 标签：spring, hibernate, jsf-2, xhtml

我是JSF的新手。
我有一个使用 3 bean 的页面 xhtml。
我可以这样做还是最好的方式是具有相同属性的大豆？

我问这个是因为页面很慢。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-05-16T00:36:08.397

我想到的一种方法是，如果您的页面以聚合方式显示不同面板中的详细信息，可能是您使用 AJAX 请求加载面板以按需加载 bean。IMO 一个包含所有细节的更大的 bean 并不是一个很好的关注点分离。理想情况下，您所说的 3 个 bean 按逻辑分组，这样就很好。

# c++ - 是否可以指定一个空的 std::vector 作为默认参数？

> ID：10609883
> 
> 赞同：20
> 
> 时间：2012-05-15T22:48:04.483
> 
> 标签：c++, optional-parameters

我一直在阅读[这个类似的问题](https://stackoverflow.com/questions/703453/optional-function-parameters-use-default-arguments-null-or-overload-the-funct)，发现自己对回答不太满意。我没有一个名为“foo”的简单函数；我有一个更复杂的函数，如果没有明智地提供参数，它就会非常危险。对我来说，执行自己的规则并确保系统稳健性的功能似乎比倾向于坚持“一个功能，一件事要做”的语义细节更可取。我认为对这个问题的偏爱反应反映了编程理想主义走得太远，而不是某些情况的现实。

我面对的是：

```
void DoSomethingVeryComplex( const CRect bounds, CPoint startPoint = CPoint(-1,-1) ); 
```

现在这恰好满足语义规则 - 它正在做一些事情，而不是几件事。它正在做的一件事恰好是复杂的、多阶段的，但它仍然是一件事。

对于那个复杂的东西，建议用户提供边界，让函数确定自己的起点。高级用户可能想要做大量的数学运算来确定一个特定的替代起点并提供它……但用户要小心。

现在我发现，在极少数情况下，提供几个起点而不是一个起点是有意义的。这并没有改变所涉及的过程的语义概念，因为该过程是从一个点传播到邻居、邻居的邻居等等的过程。所以从多方面入手是一种自然的延伸。

因此，我更愿意指定：

```
void DoSomethingVeryComplex( const CRect bounds,
                             const std::vector<CPoint> startPoint /* = empty" */ ); 
```

因此，如果向量为空，则该函数像以前一样确定起点，如果向量中有任何点，则将它们用作起点。

是否有可用的 C++ 语法允许我这样做 - 将空数组指定为默认参数？

* * *

## 回答 #1

> 赞同：38
> 
> 时间：2012-05-15T22:49:18.993

在 C++11 中，这是最简单的：

```
const std::vector<CPoint> startPoint = {} 
```

在此之前，这将起作用：

```
const std::vector<CPoint> startPoint = std::vector<CPoint>() 
```

这两个都调用默认构造函数，该构造函数创建一个空向量。请注意，同样的语法也可以用于调用其他构造函数，只要您填写适当的参数即可。

```
//this one has 5 default-constructed CPoints
const std::vector<CPoint> startPoint = std::vector<CPoint>(5) 
```

在 C++11 中，您甚至可以填写默认向量：

```
const std::vector<CPoint> startPoint = {CPoint(1, 2), CPoint(4, 5), CPoint(3, 9)} 
```

如果您想为自己的课程提供这种功能，[这里有一个关于它如何工作的链接](http://www.stroustrup.com/C++11FAQ.html#init-list)。

# php - 限制php中的数组列表

> ID：10609885
> 
> 赞同：-4
> 
> 时间：2012-05-15T22:48:16.653
> 
> 标签：php, phpmyadmin

我想知道我如何限制评论列表（数组）或表格列表。

因为我正在制作一个网站，用户可以发表帖子和评论，但我想按页面限制它。因为如果不是，它会走向无限。

对于评论和帖子（帖子在表格中），我是如何做到的？

顺便说一句，我正在使用 php。

感谢您的回答。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-05-15T22:51:28.193

您将在很大程度上依赖于查询的 LIMIT 子句。这将允许您从任何索引开始返回固定数量的结果。所以前十条记录可以返回：

```
SELECT foo, bar FROM comments WHERE post_id = 5 LIMIT 0, 10 
```

请注意，这`0`不是必需的，但它使下一个示例更易于理解。

第二个 10 可以返回：

```
SELECT foo, bar FROM comments WHERE post_id = 5 LIMIT 11, 10 
```

通常，您会`$page`在 URL 中存储一个变量并对此进行一些数学运算，并根据每页的评论总数来确定您的偏移量应该是多少。

# java - Java将Int转换为Hex并将其粘贴在字节数组元素中

> ID：10609886
> 
> 赞同：0
> 
> 时间：2012-05-15T22:48:22.890
> 
> 标签：java, arrays, hex, byte

我已经开始学习一点 Java，并试图完成一项可能非常简单的任务，但我正在努力解决它。

假设我有一个字节数组：

```
byte[] test = {(byte) 0x0a, (byte) 0x01, (byte) 0x01, (byte) 0x0b}; 
```

我想将 test[3]（当前为数字 11（0b）的最后一个值）更改为随机值。

```
Random generator = new Random();

int newTest3 = generator.nextInt(255); 
```

所以，现在我在 newTest3 中有一些随机数。我想将其转换为十六进制 (FF)，然后将其放入测试的最后一个元素或 test[3]。

在这方面我找不到太多帮助，而且我几个小时前刚刚开始学习 java，所以任何帮助都会非常出色！

提前致谢 ：）

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-05-15T22:54:42.063

我不明白你为什么要经历这么多麻烦。在您编写时使用显式转换:)：

```
byte[] test = {(byte) 0x0a, (byte) 0x01, (byte) 0x01, (byte) 0x0b}; 
```

0x0a 实际上是一个 int ，您将其显式转换为一个字节。你可以对 newTest3 做同样的事情。

```
test[3] = (byte)  newTest3; 
```

请注意，这种类型的转换通常涉及数据丢失，因为 byte 只是 8 位，而 int 是 32 位。例如（FFFFFFFF 将被转换为 FF）。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-05-15T22:50:47.023

使用字节缓冲区

```
// elsewhere
import java.nio.ByteBuffer;

byte[] arr = new byte[4];
ByteBuffer buf = ByteBuffer.wrap(arr);
buf.putInt(generator.nextInt(255); 
```

# zebra-printers - 使用 android 使用 zebra mz 220 打印

> ID：10609888
> 
> 赞同：2
> 
> 时间：2012-05-15T22:48:51.147
> 
> 标签：zebra-printers

我正在学习使用我的 MZ 220 斑马打印机，我已经使用斑马设置实用程序打印了几个字，但我需要使用 android 和蓝牙进行打印，我不知道如何使它工作。任何信息都会有所帮助。zebra 是否有任何 api 可以帮助我使用 android？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-05-16T13:24:18.217

使用[适用于 Android 设备的 Zebra SDK](http://www.zebra.com/us/en/products-services/software/adapt-software/zebralink-sdk-android.html)。

如果支持通过 wifi 和蓝牙打印。SDK 附带了一堆示例和带有示例代码的非常详细的文档。它会做你需要的，而不必自己做蓝牙通讯

# iphone - 不兼容的指针类型将“NSString *”发送到“NSInteger *”类型的参数（又名“int *”）

> ID：10609889
> 
> 赞同：1
> 
> 时间：2012-05-15T22:48:59.977
> 
> 标签：iphone, objective-c, xcode4

我有 2 个文件，data.h 和 data.m，带有连接 db 和方法 db。当我实现一个方法时，我有一个警告

***不兼容的指针类型将'NSString *'发送到'NSInteger *'（又名'int *'）类型的参数这是我的代码。***

在数据.h

```
 - (id)initCity:(NSString *)pathDB: (NSInteger *)id_city: (NSString *)type;
 - (void)getCity:(NSString *)dbPath:(NSInteger *)id_city; 
```

在数据.m

```
- (id)initCity:(NSString *)pathDB: (NSInteger *)id_city: (NSString *)type
 {
  [self getCity:pathDB: id_city: type];
  return self;
 }

- (void)getCity:(NSString *)dbPath : (NSInteger *)id_city : (NSString *)type { .......
......
} 
```

我在哪里调用我的方法

```
NSString *mystring = @"string";
dataCity = [[Data alloc] initCity: defaultDBPath: selectedItem :mystring];
NSMutableDictionary *dictionary = [dataCity objectAtIndex:0]; 
```

哪里错了？谢谢坦率

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-05-15T22:56:26.057

首先 NSInteger 是一个整数类型，而不是一个对象，所以你不需要一个指针。

其次，您的方法声明格式不正确。它应该是这样的：

```
- (id)initCityWithPath:(NSString *)pathDB andId:(NSInteger)id_city andType:(NSString *)type;
- (void)getCityWithPath:(NSString *)dbPath andId:(NSInteger)id_city; 
```

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-05-15T23:25:18.463

```
 - (id)initCity:(NSString *)pathDB: (NSInteger *)id_city: (NSString *)type; 
```

这个方法的名字是`initCity:::`接受三个参数`pathDB`，`id_city`和`type`。这可能不是您想要的，也可能不是任何必须查看您的代码的人想要的。Objective-C 使您能够命名方法的参数，任何不命名其参数的方法将始终是可疑的¹。对于大多数 Objective-C 开发人员来说，`initCity:::`这并不是一个好名字的方法。

其次，初始化方法应*始终*从调用`[super init]`并将结果分配给`self`. 很少有理由不这样做（例如，当您创建自己的根类时）。

第三，您的初始化程序调用`getCity:::`（另一个糟糕的名称），它返回`void`并接受两个输入参数，可能还有一个输入/输出或输出参数，这看起来不会正确初始化您的对象。`get`除非它具有输出参数（例如`getBytes:length:`） ，否则很少看到方法以开头。在您的情况下，我认为您可能使用了错误的类型，`NSInteger`是 32 位平台上的 32 位整数和 64 位平台上的 64 位整数的别名。`NSInteger *`因此是一个指向这样一个整数的指针。`NSNumber`这很令人*困惑*，但这与封装诸如`NSInteger`.

这里无意冒犯，但从您上面提供的代码看来，您似乎对 Objective-C 的基本方面缺乏一些了解。我建议阅读一本好书，遵循一些著名的教程，并在继续之前查看一些 Apple 的示例代码。

* * *

[1：对于较旧的运行时，在中声明的根`Object`类[`objc/Object.h`](http://gcc.gnu.org/viewcvs/tags/gcc_3_4_6_release/libobjc/objc/Object.h?revision=111785&view=markup)有两个方法被调用`forward::`，`performv::`并且都包含一个未命名的参数，这些都用于消息转发。]

# javascript - 使用css3或js的连续旋转动画？

> ID：10609895
> 
> 赞同：1
> 
> 时间：2012-05-15T22:49:20.860
> 
> 标签：javascript, jquery, animation, css

我在动画中有一些对象，它们使用 css3 不断地来回旋转动画。为此，我创建了一个声明，如下所示：

```
@-webkit-keyframes wiggle {
0% {-webkit-transform:rotate(12deg);}
50% {-webkit-transform:rotate(-6deg);}
100% {-webkit-transform:rotate(12deg);}
} 
```

我想使用它的每个对象都执行以下操作：

```
.p4, .p5, .p6 {
-webkit-animation-name: wiggle; 
-webkit-animation-iteration-count: infinite; 
-webkit-animation-timing-function: ease-in-out;
} 
```

由于我希望每个对象之间有一些随机性，因此我有以下改变动画持续时间：

```
.p4 {
-webkit-animation-duration: 5s; 
}

.p5 {
-webkit-animation-duration: 7s; 
}

.p6 {
-webkit-animation-duration: 8s; 
} 
```

等等...

这工作正常 - （目前仅在 Chrome 中测试）。但这似乎不是很理想。

我想知道是否有更快的方法来实现这一目标。或者更精简的方式。我相信我可以使用 JS 执行此操作，但我不确定最终用户资源会更轻量级。

有没有更好的方法来用更少的资源实现这种基本动画 - 如果是这样，怎么做？

除此之外，例如，如果我要使用 jquery 创建相同的动画，我该如何实际测试所需的内存使用情况？我最近发现了一些东西来测试标签的内存使用情况，但结果似乎不一致。即有时一个选项卡比另一个使用更多的内存，反之亦然，即使代码保持不变。

感谢您的任何指示。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-05-15T23:22:46.170

如果 CSS3 动画按预期工作，请坚持使用，如果需要，在 JS 中做一些事情作为不支持浏览器的后备。

用 JS 替换 CSS3 并不是真正的精简或更少的资源密集型，恰恰相反，因为 CSS3 似乎有更流畅的动画，并且在某些浏览器中将使用硬件加速和 GPU，这在 JS 中是不可能的（至少不容易）。

总而言之，您最终会在 JS 中编写更多内容，并且可能还会使用库或插件来旋转动画。在大多数浏览器中它会不太流畅，并且使用更多的资源以及 JS 将不得不每秒设置几次 css 转换值以获得稍微平滑的动画。

# python - PYTHONPATH 不适用于多路径

> ID：10609899
> 
> 赞同：1
> 
> 时间：2012-05-15T22:49:35.280
> 
> 标签：python, python-3.x, python-2.7, pythonpath

我想设置pythonpath，但它不适用于其他目录。

我的 .bashrc：

**导出 PYTHONPATH=/usr/lib/python2.7
导出 PYTHONPATH=$PYTHONPATH/plat-linux2:$PYTHONPATH/lib-dynload:$PYTHONPATH/dist-packages:$PYTHONPATH/lib-tk:$PYTHONPATH**

如果我只保留第一行（单个目录）
**export PYTHONPATH=/usr/lib/python2.7**
，那么我的 bash shell 会将我带到 /usr/lib/python2.7 目录。

但是当我包含多个目录时 -
**export PYTHONPATH=$PYTHONPATH/plat-linux2:$PYTHONPATH/lib-dynload:$PYTHONPATH/dist-packages:$PYTHONPATH/lib-tk:$PYTHONPATH**
它会抛出类似 bash: cd: /usr /lib/python2.7/plat-linux2:/usr/lib/python2.7/lib-dynload:/usr/lib/python2.7/dist-packages:/usr/lib/python2.7/lib-tk: /usr/lib/python2.7：没有这样的文件或目录

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-05-15T23:15:25.200

不要使用 PYTHONPATH 来构造更多的连接路径。使用一些临时变量。

```
PY_BASE=/usr/lib/python2.7

PYTHONPATH=$PY_BASE:$PY_BASE/plat-linux2:$PY_BASE/lib-dynload
PYTHONPATH=$PYTHONPATH:$PY_BASE/dist-packages:$PY_BASE/lib-tk
export PYTHONPATH 
```

此外，该`cd`命令与 PYTHONPATH 无关。这意味着您正在做一些与尝试和 cd 进入 PYTHONPATH 完全无关的事情。

# iphone - iPhone：UIWebView打开外部浏览器后，返回应用程序再次打开它

> ID：10609903
> 
> 赞同：1
> 
> 时间：2012-05-15T22:50:43.237
> 
> 标签：iphone, objective-c, ios, cocoa-touch, ios4

我有一个`UIWebView`加载 HTML 页面，其中包含一些指向 App Store`<a herf="http://itunes/bla/bla/bla">`的链接（链接类型）。

单击一个链接，打开外部 Safari，然后打开外部 App Store 应用程序并成功转到正确的页面。

如果您然后单击主页按钮并返回跳板并再次单击应用程序，它将短暂打开到`UIWebView`显示的应用程序，然后再次跳转到外部 Safari 和外部 App Store 应用程序。

如果您再次返回应用程序，它会留在应用程序中。

所以发生的事情是，在从 HTML 页面打开外部浏览器链接后返回应用程序`UIWebView`，然后会再次跳转回同一个链接。

任何人有任何想法可能导致这种情况？

我正在使用 Xcode 4.2.1，它发生在模拟器和实际设备上（iPad 1 和 iOS 4.3）。

编辑 - 解决方案：

好的，这是我解决问题所必须做的（感谢 Ben 在下面的回复，他让我看到了正确的区域）：

这是我原来的方法：

```
- (BOOL)webView:(UIWebView *)_webView shouldStartLoadWithRequest:(NSURLRequest *)request navigationType:(UIWebViewNavigationType)navigationType
{
    if (didLoad) { //Do not jump to URL when view first loads
        return YES;
    }

    [[UIApplication sharedApplication] openURL:[request URL]];
    return YES;
} 
```

这是我的固定方法，不会一直跳转到 URL：

```
- (BOOL)webView:(UIWebView *)_webView shouldStartLoadWithRequest:(NSURLRequest *)request navigationType:(UIWebViewNavigationType)navigationType
{
    if (didShowURL) { //Do not jump to URL when returning to app
        didShowURL = 0;
        return NO;
    }

    if (didLoad) { //Do not jump to URL when view first loads
       return YES;
    }

    didShowURL = 1;
    [[UIApplication sharedApplication] openURL:[request URL]];
    return YES;
} 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-05-16T02:29:40.660

我建议使用该`itms-apps://`协议作为您的链接。这会将用户直接发送到 App Store 中的应用程序，而无需重定向。

```
NSURL *appStoreLink = [NSURL URLWithString:@"itms-apps://itunes.apple.com/us/app/instagram/id389801252?mt=8"];
[[UIApplication sharedApplication] openURL:appStoreLink]; 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-05-15T22:59:12.047

您的 webview 正在重新加载到其最后一页（应用商店页面），并再次自动将用户重定向。您只需要确保在重新加载应用程序时它不会再次尝试加载应用程序商店链接。

根据您的应用设置，您可以使用

```
viewWillAppear 
```

并在每次视图被带到前面时重新加载带有链接的原始 HTML 页面。

# android - 在导航栏中使用标签的片段比较

> ID：10609904
> 
> 赞同：1
> 
> 时间：2012-05-15T22:50:44.377
> 
> 标签：android, comparison, android-fragments

我无法确定是否在导航栏中选择了某个选项卡。我正在尝试确定是否选择了成分选项卡。每次我运行我的代码时，它都会返回一个空指针错误，因为 mFragment 为空且尚未实例化。

好的...我知道 mFragment 为空。我想这就是我感到困惑的地方。在比较片段时，您是在比较它们的内容还是对象本身？如果有人知道如何比较片段，那就太好了。先感谢您。这是代码：

```
public static class TabListener<T extends Fragment> implements ActionBar.TabListener {
    private final Activity mActivity;
    private final String mTag;
    private final Class<T> mClass;
    private final Bundle mArgs;
    private Bundle mTitleArgs;
    private Fragment mFragment;
    private IngredientCreation ingredientFrag;
    private FragmentTabControl controller;

    public TabListener(Activity activity, String tag, Class<T> clz) {
        this(activity, tag, clz, null);
    }

    public TabListener(Activity activity, String tag, Class<T> clz, Bundle args) {
        mActivity = activity;
        mTag = tag;
        mClass = clz;
        mArgs = args;

        // Check to see if we already have a fragment for this tab, probably
        // from a previously saved state.  If so, deactivate it, because our
        // initial state is that a tab isn't shown.
        mFragment = mActivity.getFragmentManager().findFragmentByTag(mTag);
        if (mFragment != null && !mFragment.isDetached()) {
            FragmentTransaction ft = mActivity.getFragmentManager().beginTransaction();
            ft.detach(mFragment);
            ft.commit();
        }
    }

    public void onTabSelected(Tab tab, FragmentTransaction ft) {
        ingredientFrag = (IngredientCreation) mActivity.getFragmentManager().findFragmentByTag("ingredients");

        if (mFragment.equals(ingredientFrag)) {

            System.out.println("got here");
            mFragment = Fragment.instantiate(mActivity, mClass.getName(), mTitleArgs);
            ft.add(android.R.id.content, mFragment, mTag);
        } else {
            ft.attach(mFragment);
        }
    } 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-09-13T07:02:20.613

ActionBar 上的文档有一个很好的示例，说明了如何正确创建选项卡侦听器。查看此链接以获得良好的实施。[http://developer.android.com/guide/topics/ui/actionbar.html](http://developer.android.com/guide/topics/ui/actionbar.html)

# javascript - 无法在 Firefox/Opera 中设置焦点

> ID：10609909
> 
> 赞同：5
> 
> 时间：2012-05-15T22:51:07.297
> 
> 标签：javascript, firefox, focus

使用 JavaScript 将焦点设置在表单元素上通常非常简单。我无法在 Firefox 12.0 或 Opera 11 中使用它。

适用于其他浏览器（Chrome、IE 等）和 Firefox 3.6。

简单的 HTML：

```
<form action="">
    <input type="radio" id="focusID1" name="sex" value="male" /> Male<br />
    <input type="radio" id="focusID2" name="sex" value="female" /> Female<br />
</form> 
```

简单的Javascript：

```
var elem = document.getElementById("focusID2");
if (elem != null) {
   elem.focus();
} 
```

[在http://jsfiddle.net/4Ddtv/](http://jsfiddle.net/4Ddtv/)上亲自尝试一下。​</p>

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-05-21T00:02:20.020

Firefox 按预期工作。问题在于 jsfiddle 焦点和 Firefox 未突出显示焦点元素。

这不是问题.. 用户错误！

# django - 在 App Engine 1.6.5 上包含标签不是最新的

> ID：10609910
> 
> 赞同：1
> 
> 时间：2012-05-15T22:51:08.880
> 
> 标签：django, google-app-engine, python-2.7

我正在运行 Google App Engine 1.6.5，根据发行说明，应该支持 Django 1.3。但是我的 {% include %} 标签不能接受上下文参数；我收到以下错误。当应用引擎在本地运行时，我检查了我的 django 版本，它是 1.3.1。我在 Python 2.5 上很好。顺便说一句，我正在使用 use_library('django', '1.3') 导入 django，并且在我的 app.yaml 中还有以下行：

库：-名称：django 版本：1.3

有任何想法吗 ？

错误：

```
line 89, in render
    t = _load_internal_django(template_path, debug)
  File "/Applications/GoogleAppEngineLauncher.app/Contents/Resources/GoogleAppEngine-default.bundle/Contents/Resources/google_appengine/google/appengine/ext/webapp/template.py", line 163, in _load_internal_django
    template = django.template.loader.get_template(file_name)
  File "/Applications/GoogleAppEngineLauncher.app/Contents/Resources/GoogleAppEngine-default.bundle/Contents/Resources/google_appengine/google/appengine/_internal/django/template/loader.py", line 160, in get_template
    template = get_template_from_string(template, origin, template_name)
  File "/Applications/GoogleAppEngineLauncher.app/Contents/Resources/GoogleAppEngine-default.bundle/Contents/Resources/google_appengine/google/appengine/_internal/django/template/loader.py", line 168, in get_template_from_string
    return Template(source, origin, name)
  File "/Applications/GoogleAppEngineLauncher.app/Contents/Resources/GoogleAppEngine-default.bundle/Contents/Resources/google_appengine/google/appengine/_internal/django/template/__init__.py", line 158, in __init__
    self.nodelist = compile_string(template_string, origin)
  File "/Applications/GoogleAppEngineLauncher.app/Contents/Resources/GoogleAppEngine-default.bundle/Contents/Resources/google_appengine/google/appengine/_internal/django/template/__init__.py", line 186, in compile_string
    return parser.parse()
  File "/Applications/GoogleAppEngineLauncher.app/Contents/Resources/GoogleAppEngine-default.bundle/Contents/Resources/google_appengine/google/appengine/_internal/django/template/__init__.py", line 281, in parse
    compiled_result = compile_func(self, token)
  File "/Applications/GoogleAppEngineLauncher.app/Contents/Resources/GoogleAppEngine-default.bundle/Contents/Resources/google_appengine/google/appengine/_internal/django/template/loader_tags.py", line 195, in do_extends
    nodelist = parser.parse()
  File "/Applications/GoogleAppEngineLauncher.app/Contents/Resources/GoogleAppEngine-default.bundle/Contents/Resources/google_appengine/google/appengine/_internal/django/template/__init__.py", line 281, in parse
    compiled_result = compile_func(self, token)
  File "/Applications/GoogleAppEngineLauncher.app/Contents/Resources/GoogleAppEngine-default.bundle/Contents/Resources/google_appengine/google/appengine/_internal/django/template/loader_tags.py", line 173, in do_block
    nodelist = parser.parse(('endblock', 'endblock %s' % block_name))
  File "/Applications/GoogleAppEngineLauncher.app/Contents/Resources/GoogleAppEngine-default.bundle/Contents/Resources/google_appengine/google/appengine/_internal/django/template/__init__.py", line 281, in parse
    compiled_result = compile_func(self, token)
  File "/Applications/GoogleAppEngineLauncher.app/Contents/Resources/GoogleAppEngine-default.bundle/Contents/Resources/google_appengine/google/appengine/_internal/django/template/defaulttags.py", line 693, in do_for
    nodelist_loop = parser.parse(('empty', 'endfor',))
  File "/Applications/GoogleAppEngineLauncher.app/Contents/Resources/GoogleAppEngine-default.bundle/Contents/Resources/google_appengine/google/appengine/_internal/django/template/__init__.py", line 281, in parse
    compiled_result = compile_func(self, token)
  File "/Applications/GoogleAppEngineLauncher.app/Contents/Resources/GoogleAppEngine-default.bundle/Contents/Resources/google_appengine/google/appengine/_internal/django/template/defaulttags.py", line 828, in do_if
    nodelist_true = parser.parse(('else', 'endif'))
  File "/Applications/GoogleAppEngineLauncher.app/Contents/Resources/GoogleAppEngine-default.bundle/Contents/Resources/google_appengine/google/appengine/_internal/django/template/__init__.py", line 281, in parse
    compiled_result = compile_func(self, token)
  File "/Applications/GoogleAppEngineLauncher.app/Contents/Resources/GoogleAppEngine-default.bundle/Contents/Resources/google_appengine/google/appengine/_internal/django/template/loader_tags.py", line 210, in do_include
    raise TemplateSyntaxError("%r tag takes one argument: the name of the template to be included" % bits[0]) 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-05-16T19:51:38.843

正如 Guido 指出的那样，我使用的模板系统始终使用 1.2.5。解决方案是将我的模板系统更改为 Django 或 Jinja ...

# php - 如何停止 preg_match_all 返回完整模式匹配数？

> ID：10609912
> 
> 赞同：0
> 
> 时间：2012-05-15T22:51:10.407
> 
> 标签：php, regex, preg-match

我有这段代码来获取所有的 img 标签：

```
<?php

foreach($design_children as $design_child) {
    echo preg_match_all('/<img[^>]+>/i', $design_child->post_content, $result);
    echo $result[0];
    break;
}

?> 
```

但是我不断让模式匹配数字返回到我的输出中，例如图像旁边的 2、3 我如何删除它？？？！！

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-05-15T22:58:02.860

删除`echo`之前的`preg_match_all`.

# c - 例如，git 如何创建他们使用的数据库？

> ID：10609914
> 
> 赞同：4
> 
> 时间：2012-05-15T22:51:19.417
> 
> 标签：c, git, shell, command-line, terminal

嗨，我正在开发一个终端应用程序，并想使用一个数据库。不过，我不确定最好的方法。

所以我想让程序能够像你一样安装 git 或使用 brew install 等。然后每个安装它的人都有自己的数据库，可以通过某些命令访问。

我只是不确定最好的方法是什么？我在想，对于我要放入数据库的每个条目，我可以在 .directory 中创建一个文件吗？

谢谢。

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2012-05-15T22:57:12.827

文件系统实际上是一个很好的数据库，适合存储中等数量的文档，大小从小到大不等。它不是关系型的（唯一的“键”是文件名），它实际上更接近于“NoSQL”数据库而不是关系型数据库。

事实上，Git 数据库可以存储它的所有对象，每个文件一个对象。但是，出于效率原因，我们发现将许多对象组合到一个“包”文件中可以更好地满足 Git 所需的访问模式。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-05-15T23:00:31.323

Git 与其他应用程序有很大不同的“数据库”方案。如图所示[，](http://git-scm.com/book/en/Git-Branching-What-a-Branch-Is)它有一个 .git 目录、一个 objects/ 目录和一堆以 SHA 校验和命名的文件。对于刚起步的人来说，这不是一个很好的模型。

如果你想使用 Git 文件系统，有办法做到这一点（搜索“git plumbing”）。

我推荐 MySQL、XML 文件或文件系统格式之一（请记住，如果您在 Windows 上运行，任何低于 4KB 的文件都在浪费空间）。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2017-04-14T16:21:30.227

您很可能正在寻找 SQLite。

# php - 如何根据相同的类而不是相同的名称对单选按钮进行分组

> ID：10609918
> 
> 赞同：1
> 
> 时间：2012-05-15T22:51:33.937
> 
> 标签：php, jquery, html, forms, radio-button

有没有办法对共享同一类的单选按钮集进行分组。

我希望能够检查每组的单选按钮。

目前它只允许我检查一个单选按钮（因为我知道因为同名）

也有 JQuery 方式吗？

例子：

**套装 A**

```
<input type="radio" name="item[]" class="a" value="1"><br>
<input type="radio" name="item[]" class="a" value="2"><br>
<input type="radio" name="item[]" class="a" value="3"><br>
<input type="radio" name="item[]" class="a" value="4"><br> 
```

**B组**

```
<input type="radio" name="item[]" class="b" value="5"><br>
<input type="radio" name="item[]" class="b" value="6"><br>
<input type="radio" name="item[]" class="b" value="7"><br>
<input type="radio" name="item[]" class="b" value="8"><br> 
```

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-05-15T23:05:44.020

```
$('#container').on('click', 'input[type="radio"]', function(){
    this.name = this.className;
});​ 
```

这~~应该~~可以解决它。

[**现场演示**](http://jsfiddle.net/gdoron/r9GMM/4)

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2012-05-15T23:42:10.607

好的，所以您尝试拥有多个数组条目，但使用 1 个数组。

由于 html 将它们解释为具有相同的名称，因此您必须自己将数字添加到数组键中。

所以这样的事情应该有效。

```
<input type="radio" name="item[0]" class="a" value="1" />
<input type="radio" name="item[0]" class="a" value="2" />
<input type="radio" name="item[0]" class="a" value="3" />
<input type="radio" name="item[0]" class="a" value="4" />
<input type="radio" name="item[0]" class="a" value="5" />

<input type="radio" name="item[1]" class="b" value="6" />
<input type="radio" name="item[1]" class="b" value="7" />
<input type="radio" name="item[1]" class="b" value="8" />
<input type="radio" name="item[1]" class="b" value="9" />
<input type="radio" name="item[1]" class="b" value="10" /> 
```

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-05-15T22:55:24.170

你不能用不同的方式命名这些集合吗？

套装 A

```
< input type="radio" name="item1[]" class="a" value="1">
< input type="radio" name="item1[]" class="a" value="2">
< input type="radio" name="item1[]" class="a" value="3">
< input type="radio" name="item1[]" class="a" value="4"> 
```

B组

```
< input type="radio" name="item2[]" class="b" value="5">
< input type="radio" name="item2[]" class="b" value="6">
< input type="radio" name="item2[]" class="b" value="7">
< input type="radio" name="item2[]" class="b" value="8"> 
```

# mysql - 如何创建查找表

> ID：10609920
> 
> 赞同：0
> 
> 时间：2012-05-15T22:51:52.253
> 
> 标签：mysql, sql

我有一个已导入 MySQL 的电子表格。它有很多行条目，包括赌博赔率，即 2/1 或 7/2。不幸的是，赌博赔率被 MySQL 读取为 varchar，这使得无法对其进行计算。有人建议我创建一个查找表，其中可以将赌博赔率转换为十进制值。这是有道理的。好的，所以最大的问题是我该怎么做？我是否应该创建一个单独的表来列出赌博赔率并将其等同于其十进制等值，如果是这样，我将如何进行查询，例如从表 1 中找到赔率为 2/1 的所有行，并将其乘以 £1 . 请问有什么建议吗？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-05-16T04:02:26.720

I think a lookup table is too hard to maintain, since there are an infinite number of possible odds combinations.

Instead, I would strongly suggest that you create a view over your base table, that has the various fields that contain the odds:

```
create view v_table as
    select t.*,
           OddsTop*1.0/OddsBottom as OddsNumeric,
           OddsBottom*1.0/(OddsTop + OddsBottom) as OddsPvalue
    from (select t.*,
                 cast(left(t.odds, locate('/', t.odds, '/')-1) as int) as OddsTop, 
                 cast(substring(t.odds, locate('/', t.odds)+1, 100) as int) as OddsBottom, 
          from t
         ) t 
```

You can easily calculate various types of information related to the odds. Here, I've shown how to get the top number, bottom number, odds as a floating point number, and the p-value equivalent.

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-05-15T23:15:54.337

据我所知，MySQL 中没有它的数据类型。我建议不要按照您的建议创建单独的表格。如果精度不是最重要的，您可以将它们存储为具有特定宽度的小数并使用十进制值进行查询。您始终可以[将其转换回应用层中的分数表示](https://stackoverflow.com/questions/5124743/algorithm-for-simplifying-decimal-to-fractions)。如果简单很重要，您可以将它们存储为 varchar。有关相关问题，请参见[此处](https://stackoverflow.com/a/10507598/661933)。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-05-16T00:20:14.373

这实际上是一个非常有趣的问题。我的两位建议“7/2”实际上并未用作数字，因此可以解释为“代码”，就像使用国家代码而不是整个国家名称一样。我可能倾向于使用查找表，将 Odds 用作键，将乘法因子用作每行中的列以用于数学。您还可以控制要使用的精度，以及非常轻松地查询高赔率和低赔率。

不一定说我就在这里，只是觉得这是一个有趣的。

# facebook - 检索已发布 url 的 facebook 用户

> ID：10609922
> 
> 赞同：0
> 
> 时间：2012-05-15T22:52:36.543
> 
> 标签：facebook, facebook-graph-api, facebook-fql

我很感兴趣使用 FB API 来查询哪些用户共享了某个 URL。共享，不喜欢。

因此，从[http://cnn.com](http://cnn.com)之类的内容开始，我很想获得共享链接的用户的 ID 或至少名称。

我意识到许多 FB 帖子是用户网络的私有帖子，但有些帖子是公开的，就像在粉丝页面上一样。

通读文档，我找不到实现此目的的方法。

# android - 安卓多人游戏

> ID：10609928
> 
> 赞同：0
> 
> 时间：2012-05-15T22:54:10.353
> 
> 标签：android, nosql, couchbase

我正在尝试开发将使用远程服务器进行协调的多人回合制安卓游戏。我想将 couchbase nosql 服务器与 java sdk 一起使用。我不明白数据将如何从移动设备移动到数据库并返回。请你帮助我好吗 ？我需要使用 jetty 或 tomcat 吗？还有其他方法吗？大多数情况下，我只在客户端工作，所以我无法弄清楚这一点。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-05-30T06:31:51.420

如果您想了解服务器并从头开始开发服务器，我可以将其联系起来，但是作为客户端开发人员，您可能需要花费大量时间来配置、开发、测试、运行、托管、维护、扩展服务器端（当然，这可能会花费你很多钱）。如果您希望尽快发布您的游戏，我会提出另一种解决方案。我来自 Skiller，我们有 SDK，可以缩短您将游戏推向市场的时间。您可以使用内置的基于轮流的简单 API 来创建或加入现有游戏、挑战玩家、发送消息等等...

查看我们的[wiki 页面](http://wiki.skiller-games.com)或我们的[Skiller 网站](http://www.skiller-games.com)了解更多信息。

很高兴收到您的意见。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-05-16T00:51:53.033

您需要开始使用 [java 中的套接字编程](http://www.javaworld.com/javaworld/jw-12-1996/jw-12-sockets.html)，这是您在开发网络应用程序时应该知道的最基本的事情。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-05-16T00:59:34.653

您应该考虑客户端和服务器之间的 REST-ful 接口而不是套接字，特别是如果它是一个慢节奏的游戏（例如 Words with Friends 或 Draw Something）

基本思想是移动设备在您使用服务器设置的各个页面上发布数据：

[http://mygame.com/mobile/api/submitMove?id=123&player=1&move=KnightA4](http://mygame.com/mobile/api/submitMove?id=123&player=1&move=KnightA4)

然后服务器将读取参数，使用数据库确定它是否有效，并做出相应的响应。

# ios - 是否可以仅使用 ipsw（无设备）加载符号进行符号化？

> ID：10609930
> 
> 赞同：3
> 
> 时间：2012-05-15T22:54:21.427
> 
> 标签：ios, crash, symbolicate

我从使用 iOS 4.3.2 设备的客户端收到应用程序崩溃报告。我没有具有该版本的设备，因此我下载了 .ipsw，并认为将其放入 xcode Organizer 软件图像部分可以让我符号化 iOS 日志，但它不起作用。知道这是否可以在没有设备的情况下实现吗？

谢谢！

# html - 如何避免溢出：隐藏的性能成本？

> ID：10609931
> 
> 赞同：9
> 
> 时间：2012-05-15T22:54:24.267
> 
> 标签：html, css, performance, optimization, html-table

我有一个可以超过 1K 行和十几列的 HTML 表。

我希望列是固定大小（可由用户控制），并且不会垂直或水平增长/收缩。因此，在视觉上，特定表格单元格的内容将在一行上，并且溢出在单元格末尾被切断。

在 Chrome 中对大表进行性能分析，主要的性能杀手是**overflow:hidden**。

我尝试将每个单元格的内容放在输入中，因为这会复制相同的视觉行为，但会产生类似的性能影响。

人们推荐什么来提高性能？

如有必要，我不必使用表格标签，但如果可以实现良好的性能，我宁愿坚持使用表格标签。

**更新 1**：我在[这里](https://www.dropbox.com/s/69i5lv05vt14ute/gistfile1.html)包含了一个演示性能问题的文件。警告该文件非常庞大 (25MB)，会降低您的计算机速度。默认情况下，该表没有将溢出设置为隐藏，并且一旦加载了表（可能需要一段时间），浏览器的性能相对平稳。

但是，如果您编辑文件并取消注释第 12-15 行，然后打开它。在桌子周围加载浏览器后，您会看到响应速度明显降低。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-06-28T01:38:43.080

仅供参考：我在 iPad/iOS 上遇到了这个问题，导致一个页面在 table-layout:fixed 的表格中有大约一百行的页面出现性能问题。

一旦一个单元格或单元格中的一个 div 获得一个强制它单独绘制该单元格的属性，则绘制大约需要 300 毫秒而不是 100 毫秒（这导致 UI 在我的情况下感觉非常缓慢）。

两个属性（`position:relative`或`overflow:hidden`）中的任何一个都对我造成了问题，删除它们优化了速度，但如果单元格文本对于固定宽度的列来说太宽，则会导致文本溢出。

即使在绘制表格之后，速度也会放缓，因为我在表格上动态弹出一个绝对 div。分析 javascript（使用`(new Date).getTime()`）时，在 javascript 中与表格无关的地方测量减速。

[编辑：添加以下作为部分解决方案]

1.  将所有单元格内容放在一个`span`元素内（因此可以测量内容的 offsetWidth 而不是包含块元素的宽度）。
2.  将行附加到文档后，测试每个 span.offsetWidth 是否大于列宽，如果是，则将“overflow:hidden”添加到包含块的样式（或通过类）。
3.  对于某些列，可以跳过上面的 1 和 2（如果知道单元格内容永远不需要剪辑）。

注意事项：

1.  仅针对 iOS5 Safari 进行了测量（我没有分析任何其他浏览器）。
2.  对我们有用，因为我们动态创建表行（使用 javascript 处理您的示例会很慢？）。
3.  我们数据的大多数单元格不会溢出（只需要少量裁剪 - 只需要有限数量的单元格）。
4.  初始页面加载受损（页面中表格的生成时间从 80 毫秒变为 800 毫秒）。
5.  但是加快了动态组合弹出窗口（340 毫秒到 130 毫秒）的速度，从而提供了更好的键盘响应能力。

对于您的情况，可能很快首先使用可变宽度列，测量所有列的 offsetWidth，将列宽设置为像素宽度并设置溢出：仅在列的 offsetWidth 大于您将用于的像素宽度的列上隐藏柱子。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-05-16T00:03:26.730

您可以尝试使用平铺方法。这是一种非常典型的高效制作无限横向滚动游戏的方法。

将所有数据放入 Javascript 数组中，然后在有 N 行可见的表中包含 N + 1 行。当您向下滚动时，最后一个项目将进入视图。在您滚动到足够远以至于第一个项目移出视图的那一刻，您将所有数据向上移动一行并将滚动位置重置回它开始的位置。如果操作正确，这种转变对用户来说是完全透明的。您只能在 N 行可见表中使用 N + 1 行。

我以前做过，但是在非常具体的 UI 限制下。一想到使用内置的浏览器滚动条等使这一点保持一致，我就有点犹豫了。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-05-15T23:22:14.343

首先，拥有一个表格所需的标记量比仅使用带有 clear:both css 的 div 用于新行要大得多。所以这是第一个性能命中。

另外，您将溢出设置为一个类（？）

```
 <style type="text/css"> .ovfl { overflow:hidden; }</style>

  <td class="ovfl"></td> 
```

顺便说一句，1000 行是交付的重量。

使用 div，您至少有一个更容易的机会将那些看不见（超出滚动）扔到具有**display:none**的 div 中，直到访问者滚动到它们。

在这项工作中最有可能猫的皮肤很少，

希望有一些好的想法。

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2012-06-29T04:12:02.823

[Webkit 错误 75001](https://bugs.webkit.org/show_bug.cgi?id=75001)与此问题有关，它涵盖了为解决该问题所做的工作（有关信息，另请参阅 bugzilla 依赖项）。

# javascript - Dygraph 对 CSV 进行故障排除

> ID：10609932
> 
> 赞同：0
> 
> 时间：2012-05-15T22:54:32.967
> 
> 标签：javascript, csv, dygraphs

这直接来自**错误栏**部分下的[dygraphs](http://dygraphs.com/)，我将 csv 文件与带有 dygraph 代码的 html 放在同一目录中。Firefox 或 Chrome 都不会抛出错误或绘制任何线条。它只显示轴和背景网格。我该如何去追这个呢？ .csv 文件是否正在加载？在 dygraph-combined.js 中我应该从哪里开始寻找？

 **```
<html>
<head>
<script type="text/javascript" src="js/dygraph-combined.js"></script>
</head>
<body>
<div id="graphdiv4" style="width:480px; height:320px;"></div>
<script type="text/javascript">
  g4 = new Dygraph(
    document.getElementById("graphdiv4"),
    "twonormals.csv",
    {
      rollPeriod: 7,
      showRoller: true,
      errorBars: true,
      valueRange: [50,125]
    }
  );
</script>
</body>
</html> 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-05-16T03:10:22.227

确保 twonormals.csv 是世界可读的。您可以通过直接在 URL 栏中输入其 URL 来查看/下载它吗？**

# wpf - WPF TextBox 从鼠标指针获取并设置插入符号位置

> ID：10609933
> 
> 赞同：2
> 
> 时间：2012-05-15T22:54:42.030
> 
> 标签：wpf, textbox, mouse, coordinates, caret

我试图在将鼠标悬停在文本框上时根据鼠标坐标设置文本框插入符号位置。我可以使用 Mouse.GetPosition(this.MyTextBox) 获得相对于 TextBox 的鼠标坐标，但我需要帮助将这些坐标转换为插入符号位置。任何帮助将不胜感激！

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-05-16T14:10:57.407

```
MyTextBox.CaptureMouse();
MyTextBox.CaretIndex = MyTextBox.GetCharacterIndexFromPoint(Mouse.GetPosition(MyTextBox), true); 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-12-10T18:26:14.393

MyTextBox.GetCharacterIndexFromPoint(..) 这将返回最接近指定点的字符的从零开始的索引。请参阅下面的链接：http: [//msdn.microsoft.com/en-us/library/system.windows.controls.textbox.getcharacterindexfrompoint.aspx](http://msdn.microsoft.com/en-us/library/system.windows.controls.textbox.getcharacterindexfrompoint.aspx)

# haskell - 为什么在 where 子句中使用类型签名如此罕见？

> ID：10609936
> 
> 赞同：21
> 
> 时间：2012-05-15T22:54:51.097
> 
> 标签：haskell, where-clause, type-signature

它是否有助于编译器进行优化，或者只是添加额外的类型签名的多余工作？例如，人们经常看到：

```
foo :: a -> b
foo x = bar x
      where bar x = undefined 
```

而不是：

```
foo :: a -> b
foo x = bar x
      where bar :: a -> b
            bar x = undefined 
```

如果我省略了顶级类型签名，GHC 会给我一个警告，所以如果我没有收到警告，我很有信心我的程序是正确的。但是，如果我在 where 子句中省略签名，则不会发出警告。

* * *

## 回答 #1

> 赞同：22
> 
> 时间：2012-05-15T23:18:55.580

存在一类本地函数，其类型不能用 Haskell 编写（即不使用花哨的 GHC 扩展）。例如：

```
f :: a -> (a, Int)
f h = g 1
  where g n = (h, n) 
```

这是因为从外部看`a`in`f`类型签名是多态的`f`，但从内部看却不是这样`f`。在`g`中，它只是*一些*未知类型，而不是*任何*类型，并且（标准）Haskell 无法用其类型语言表达“与定义此函数的函数的第一个参数相同的类型”。

* * *

## 回答 #2

> 赞同：20
> 
> 时间：2012-05-16T01:05:10.787

`where`如果子表达式在定义中多次出现，则子句中的定义通常是为了避免重复自己。在这种情况下，程序员将局部定义视为写出内联子表达式的简单替代。您通常不会显式键入内联子表达式，因此您也不会键入`where`定义。如果你这样做是为了节省打字，那么类型声明会扼杀你所有的积蓄。

向 Haskell 学习者介绍这种形式的示例似乎很常见`where`，因此他们继续认为“正常样式”是不为局部定义提供类型声明。至少，那是我学习 Haskell 的经验。`where`从那以后，我发现如果我不知道本地定义的类型，我的许多复杂到需要一个块的函数变得相当难以理解，所以我试图错误地现在总是输入它们；即使我在编写代码时认为类型很明显，但当我有一段时间没有看它后阅读它时，它可能并不那么明显。在我的脑海中运行类型推断的一两个实例几乎总是超过我手指的一点努力！

Ingo 的回答给出了*故意*不为本地定义提供类型的充分理由，但我怀疑主要原因是许多程序员已经吸收了经验法则，即为顶级定义提供类型声明，而不是为本地定义提供类型声明他们学习了 Haskell。

* * *

## 回答 #3

> 赞同：11
> 
> 时间：2012-05-15T23:07:46.020

声明通常`where`用于简短的本地事物，它们具有简单的类型或易于推断的类型。结果，添加类型对人类或编译器没有任何好处。

如果类型很复杂，或者无法推断，那么您可能需要添加类型。

虽然提供单态类型签名可以使顶级函数更快，但对于`where`子句中的本地定义来说并不是一个胜利，因为 GHC 无论如何都会内联和优化定义。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2012-05-15T23:07:16.127

添加类型签名可以使您的代码更快。以下面的程序（斐波那契）为例：

```
result = fib 25 ;
-- fib :: Int -> Int
fib x = if x<2 then 1 else (fib (x-1)) + (fib (x-2)) 
```

*   如果没有第 2 行中的注释，则需要 0.010 秒。跑步。
*   使用`Int -> Int`注释，需要 0.002 秒。

发生这种情况是因为如果你什么都不说`fib`，它将被键入为`fib :: (Num a, Num a1, Ord a) => a -> a1`，这意味着在运行时，必须在函数之间传递额外的数据结构（“字典”）来表示`Num`/`Ord`类型类。

# facebook - 域中多个页面的 Facebook 赞

> ID：10609942
> 
> 赞同：2
> 
> 时间：2012-05-15T22:55:49.423
> 
> 标签：facebook, facebook-graph-api, facebook-like

要解决的问题：

1.  想象一下，我有一个域和相应的网站`http://my-awesome-site`
2.  在这个网站上，我有 10,000 页。
3.  每个页面都有一个 Facebook Like 按钮。
4.  如何从 Facebook 图表中检索每页的点赞数？

[可以使用简单的 GET 请求（例如： google.com](https://graph.facebook.com/http://google.com/)、[google.com/reader](https://graph.facebook.com/http://google.com/reader)、[news.google.com](https://graph.facebook.com/http://news.google.com) ）查找每个 URL 的总点赞数。但是是否有可能获得整个域的类似列表，按页面细分？结果如下：

```
{
   "id": "http://my-awesome-site/",
   "shares": 12345
},
{
   "id": "http://my-awesome-site/page1.html",
   "shares": 5678
},

....

{
   "id": "http://my-awesome-site/page10000.html",
   "shares": 9012
} 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-05-15T23:21:01.663

我认为您能做的最好的事情是（使用[link_stat 表](http://developers.facebook.com/docs/reference/fql/link_stat/)）：

```
SELECT url, share_count
FROM link_stat
WHERE url IN ("http://my-awesome-site/", "http://my-awesome-site/page1.html"...) 
```

但是，如果您有 10,000 个页面，则必须将其分解为多个请求。但是，您可以使用[Batch Requests](http://developers.facebook.com/docs/reference/api/batch/) api 来组合一些请求。

如果这是您所追求的，那么该解决方案应该会大大降低 http 请求的数量。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-08-28T02:38:09.210

您也可以通过 facebook graph 用逗号分隔 ID

```
https://graph.facebook.com/?ids=http://techcrunch.com,http://mashable.com 
```

结果将是一个 json，如下所示

```
{
   "http://mashable.com": {
  "id": "http://mashable.com",
  "shares": 14436 
},
"http://techcrunch.com": {
   "id": "http://techcrunch.com",
  "shares": 2144
}
} 
```

# java - 将 Java 程序映射到操作系统进程

> ID：10609944
> 
> 赞同：4
> 
> 时间：2012-05-15T22:55:50.127
> 
> 标签：java, compiler-construction, process, operating-system, callstack

我想知道这是如何发生的：Java 程序如何映射到 OS 进程（如下面的 Linux 所示）：
![借自：linuxjournal.com](../Images/d55894d0785b3270a0551abb8bc82686.png)

在 C 中，它是程序如何编写以及整个调用堆栈如何在操作系统中进行的直接关联。我想知道如何在 Java 中实现映射？方法 meth()，在对象上调用：obj，是否只是转换为定位 obj.meth() 的地址，然后在堆栈上使用它在 C 中的方式？

提前致谢！

编辑：我也很想知道其他 OOP 语言通常使用的模型（C++、Python 等）。

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-05-15T23:10:52.223

这是一个相当复杂的问题。这是一篇关于这个主题的非常好的[文章。](http://blog.codecentric.de/en/2010/01/the-java-memory-architecture-1-act/)简而言之，Java 有两种执行模式，它们极大地影响了内存布局。

1.  一些代码由解释器执行
2.  一些代码被编译为本机代码以获得更好的性能。

请参阅此 wiki 页面：[http](http://en.wikipedia.org/wiki/Just-in-time_compilation) ://en.wikipedia.org/wiki/Just-in-time_compilation 。

并且 JVM 获得了更多类型的内存区域，例如 perm-gen、JIT 内存等。

这在其他线程中得到了很好的讨论：

1.  [java和内存布局](https://stackoverflow.com/questions/1714674/java-and-memory-layout)
2.  [jdk1.6 内存布局](https://stackoverflow.com/questions/9896729/jdk1-6-memory-layout)

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-05-16T01:32:29.603

大多数 Java JVM 都是纯 C 程序。所以图片将与正在解释/执行的第一个类文件相同。

之后，它取决于 JVM 实现。通常，他们会使用堆栈存储来跟踪控制类型信息，例如加载了哪些类、正在运行哪些线程等。对于实际的“程序”存储，解释器和垃圾收集器将使用普通的“malloc”/“mfree”来存储分配和释放内存以及一些相当复杂的控制结构以使垃圾收集器能够正常工作。

# windows-phone-7 - 获取使用 Twitter 搜索 API 找到的推文的位置

> ID：10609950
> 
> 赞同：1
> 
> 时间：2012-05-15T22:56:24.057
> 
> 标签：windows-phone-7, twitter, geolocation

每当我使用地理编码选项搜索推文时，返回的推文都将“null”作为其地理属性。它们肯定来自正确的位置，因为 location 属性的名称位于正确的区域，但是我想知道推文的坐标是什么，以便我可以将其放置在地图上（特别是 Windows Phone）。

我已经尝试过使用geo api搜索位置的非常hacky的解决方案，但这似乎是一种非常尴尬的方式并且经常返回糟糕的结果（我想要来自英国牛津的结果，但通常地理搜索返回牛津，IN例如）。

环顾四周，似乎 Twitter 的地理定位目前已损坏，但我真的需要这个来在周四的演示文稿中展示我们在一个组中构建的应用程序，如果我们的主要功能不起作用，那真的很糟糕。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-05-16T08:22:58.253

[Twitter 的搜索 API 坏了](https://dev.twitter.com/issues/79)。它不会返回一些可通过常规 API 获得的信息。

找到推文后，您可以尝试使用[statuses/show直接查找它](https://dev.twitter.com/docs/api/1/get/statuses/show/%3aid)

例如，调用我的一条推文：

```
https://api.twitter.com/1/statuses/show.xml?id=202471009973051393&include_entities=true 
```

给

```
<geo>
  <georss:point>51.52505194 -0.132582</georss:point>
</geo>
<coordinates>
  <georss:point>51.52505194 -0.132582</georss:point>
</coordinates> 
```

# javascript - 在制作 javascript 库时，哪里是记录 API 的好地方？

> ID：10609955
> 
> 赞同：2
> 
> 时间：2012-05-15T22:56:57.153
> 
> 标签：javascript

我正在制作一个库来生成一些自定义内容。它非常冗长，大约 1100 行代码。尽管代码非常易读并且遵循严格的命名约定，但我不确定在包含脚本文件时在哪里记录可用的 API。在页面中包含脚本时，intellisense 不会选择“公共”方法，jQuery 也不会。jQuery 为其 API 提供了一个很棒的网站（[http://api.jquery.com/](http://api.jquery.com/)），但我不觉得做这么棒的东西。

我应该在哪里记录这个自定义 API？

*如果*在评论中，你会建议什么样的评论结构？

*编辑*

我对智能感知的观点是，即使是好的命名约定也需要文档化的 API。所以我绝对对通用方法感兴趣。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-05-15T23:03:26.833

我认为 jsdoc 很受欢迎。

[http://code.google.com/p/jsdoc-toolkit/](http://code.google.com/p/jsdoc-toolkit/)

您将按照链接上的约定进行内联文档。您将分发一个用于部署的缩小/混淆的生产构建，以及用于开发的文档化构建（即您可以这样做）

编辑，您还可以在这里找到更多选项：http: [//o2js.com/2011/05/01/how-to-document-a-javascript-framework/](http://o2js.com/2011/05/01/how-to-document-a-javascript-framework/)

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-05-15T23:06:57.640

这取决于您的 api 有多复杂，对于我自己的小型库，我只是在包含

*   快速记录这一切
*   如果库对 html 标记进行操作，则可以复制和粘贴一些示例代码
*   函数列表及其参数和每个函数的单行文档
*   通常如何使用该库的示例
*   注释/警告/限制。总有一些奇怪的事情发生，人们不会想到

基本上这就是你放在 C 头文件中的内容。

我想你可以在一个单独的文件中完成我上面提到的所有事情，然后使用 markdown 语法（我太懒了......我更喜欢将所有内容都放在一个文件中）。

* * *

ps 有些人提到内联注释（即直接在函数所在的位置）。这当然也是一种选择。但对我来说，这似乎只有在自动生成文档时才方便，这是一种快速研究文件内文档的可怕方式，因为它缺乏大图视图。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-05-15T23:10:47.990

它不是通用的，但如果您不介意为不同的编辑器维护单独的版本，Visual Studio 的 IntelliSense 将在您的 JavaScript 代码中加载和解析 XML 注释。我想 MonoDevelop 和 SharpDevelop 也可以使用相同的文件，但我认为 IntelliJ 或 Eclipse 之类的 IDE 不会从中得到任何用处......

HTH。

# javascript - 为什么我收到错误“document.write 可以是 eval 的一种形式”？

> ID：10609957
> 
> 赞同：0
> 
> 时间：2012-05-15T22:57:09.677
> 
> 标签：javascript, eval, document.write

这就是我要做的一切，但我的调试器说'document.write 可以是 eval 的一种形式'，而我的 jsonString 变量打印为未定义。任何帮助表示赞赏，谢谢。

```
function getUrlVars() {
        var map = {};
        var parts = window.location.href.replace(/[?&]+([^=&]+)=([^&]*)/gi, function(m,key,value) {
                                                 map[key] = value;
                                                 });
        return map;
    }

    var jsonString = getUrlVars()['json'];
    document.write(jsonString); 
```

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-05-15T23:06:25.333

document.write 可以是 eval 的一种形式的原因是，如果您编写脚本元素，它将被评估。

至于为什么你的 jsonString 是未定义的，你可能没有一个名为 'json' 的参数。

# wsgi - 了解 WSGI

> ID：10609961
> 
> 赞同：13
> 
> 时间：2012-05-15T22:57:31.077
> 
> 标签：wsgi

我正在尝试了解 WSGI 的功能并需要一些帮助。

到目前为止，我知道它是服务器和应用程序之间的一种中间件，用于将不同的应用程序框架（驻留在服务器端）与应用程序接口，前提是相关框架具有 WSGI 适配器。继续理论部分，我知道服务器要与应用程序通信，服务器调用一个可调用对象（它需要两个参数：环境变量和 start_response 函数）。这里的 start_response 函数由服务器 (?) 提供，并由应用程序使用，其中包含响应状态和标头，后跟响应正文。

我对上面写的内容知之甚少，所以这里是新手问题：1）一般呼叫流程是什么？应用程序将为服务器提供一个可调用对象，然后服务器将使用该可调用对象并使用 env_vars 和 start_response 函数作为参数来调用应用程序？

2) 最让我困惑的是应用程序正在发送请求标头，然后它也发送响应正文。这是什么类型的请求？

请赐教，因为我无法理解这些东西。

谢谢！

* * *

## 回答 #1

> 赞同：8
> 
> 时间：2012-08-31T08:01:07.907

调用流程如下：

1.  服务器有一个http连接，
2.  服务器解析 http 请求行和标头，读取正文，
3.  服务器根据请求填充**环境字典，**
4.  **服务器以environ**和**start_response**作为参数调用可调用的应用程序，
5.  应用程序可调用调用**start_response**并带有响应状态和响应标头，
6.  应用程序向服务器返回响应正文，
7.  服务器将http响应发送给客户端。

对于你的第二个问题，请求/响应是wsgi协议定义的接口（例如status = '200 OK', response_headers = [('Content-type', 'text/plain')]），与**http**不一样请求/响应。

您可以浏览站立库模块[wsgiref](http://docs.python.org/library/wsgiref.html)作为参考。

# python - Python - 从文件中删除最后一个字节的最简单方法？

> ID：10609965
> 
> 赞同：1
> 
> 时间：2012-05-15T22:57:57.527
> 
> 标签：python, file, truncate

我想制作一个脚本来获取文件，去掉文件的最后一个字节。该文件可以是任何内容，而不仅仅是文本。

我一直在玩 seek() 和 tell() 方法，但我找不到处理允许我这样做的文件的方法。

我认为它应该相对微不足道，但也许 Python 不是一个合适的工具？

```
fileStripped = file[:-4]
newpath = path + "\\" + fileStripped 
if not os.path.exists(newpath): 
 os.makedirs(newpath)
with open(fname, "r") as f:
 f.seek (0, 2)           # Seek @ EOF
 fsize = f.tell()        # Get Size
 f=f.read
 f=f[:fsize-2] 
```

此方法错误，并告诉我不能下标该`f=f[:fsize-2]`行

* * *

## 回答 #1

> 赞同：12
> 
> 时间：2012-05-15T23:00:59.663

从末尾开始查找一个字节，然后截断。

```
f = open(..., 'r+')
f.seek(-1, os.SEEK_END)
f.truncate()
f.close() 
```

* * *

## 回答 #2

> 赞同：6
> 
> 时间：2012-05-15T23:01:31.887

用于[`shutil.copyfileobj`](http://docs.python.org/library/shutil.html#shutil.copyfileobj)复制文件，然后通过返回一个字节并截断文件来删除最后一个字节：

```
with open(srcfile, 'r') as fsrc:
    with open(destfile, 'w+') as fdest:
        shutil.copyfileobj(fsrc, fdest)
        fdest.seek(-1, os.SEEK_END)
        fdest.truncate() 
```

# sql - 嵌套的“CASE when”语句

> ID：10609972
> 
> 赞同：2
> 
> 时间：2012-05-15T22:58:40.950
> 
> 标签：sql, sql-server-2008

如何在 sql 查询中使用嵌套形式的“case”语句。我正在尝试执行以下查询。

```
SELECT AccessTabF1.Month, AccessTabF1.Year, AccessTabF1.[Entity Number], 
case when [Exp Year]= 2010 + 1
     then 'Expires in 1 to 5 Years'
     else
          case when [Exp Year]>2010 + 5
               then 'Expires After 5 Years'
               else 'No Expiration Year Listed' 
end
from AccessTabF1 
```

* * *

## 回答 #1

> 赞同：12
> 
> 时间：2012-05-15T23:01:38.173

在您的情况下，您不需要嵌套多个 CASE 表达式。

```
SELECT AccessTabF1.Month, AccessTabF1.Year, AccessTabF1.[Entity Number], 
case when [Exp Year] = 2010 + 1 -- why not = 2011 ?
     then 'Expires in 1 to 5 Years' -- this does not match the logic on line above
     when [Exp Year] > 2010 + 5 -- why not > 2015 ?
     then 'Expires After 5 Years'
     else 'No Expiration Year Listed' 
end
from AccessTabF1 
```

# python - 在 django 中为身份验证应用程序创建迁移

> ID：10609976
> 
> 赞同：2
> 
> 时间：2012-05-15T22:59:07.117
> 
> 标签：python, django, migration, django-south

我需要使用以下方法在 django`contrib.auth`应用程序中的 Group 模型中添加几个字段：

```
field_name = models.CharField(...)
field_name.contribute_to_class(Group, 'field_name') 
```

我的问题是在使用 South 创建迁移时，因为它们是在 auth 应用程序内的“迁移”目录中创建的，并且由于系统已经在生产中，我不允许按顺序更改服务器中当前的 django 安装迁移`auth`。

有谁知道如何创建和加载这样的迁移？

在此先感谢您的帮助。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-05-16T03:52:05.507

Django 并没有让修改标准模型变得特别容易。我不建议您使用 sublass `Group`，因为使用内置功能来引用新模型非常烦人。

这里通常要做的事情是创建一个`GroupProfile`具有`Group`唯一外键的模型。它可能并不优雅，但它不会产生分叉 Django 源代码所带来的巨大维护开销。

另外：如果您无法修改服务器上的 Django 代码，那么您将无法使用原始 SQL 黑客技术或巧妙的迁移来做到这一点。South 不会是问题——问题是 Django ORM 会注意到 SQL 表中存在未在代码中指定的字段，这将导致它抛出异常。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-05-16T00:06:38.597

由于您使用 hack 来修补模型，我认为您应该手动编写迁移。尝试复制另一个迁移并进行更改`add_column`，`models`首先，如果失败 - 总是有一个名为“raw sql”的选项:)

# c# - UDP DatagramSocket 和多播 IP

> ID：10609980
> 
> 赞同：0
> 
> 时间：2012-05-15T22:59:49.040
> 
> 标签：c#, network-programming, windows-runtime, udpclient, .net-4.5

我在客户端接收消息时遇到了一些问题：

本质上，我能够向监听器发送消息“Hello world”，但是当监听器尝试发送“回复”时，客户端没有收到消息？

你认为我在这里缺少什么？

客户：

```
 var socket = new DatagramSocket();
        socket.MessageReceived += HandleMessageReceive;
        await socket.ConnectAsync(new Windows.Networking.HostName("224.192.12.12"), "9991");
        socket.JoinMulticastGroup(_multicastGroupIp);

        DataWriter writer = new DataWriter(_socket.OutputStream);
        writer.WriteString("Hello world");
        await writer.StoreAsync(); 
```

听众：

```
 var stateObject = new StateObject();
            stateObject.LocalEndPoint = new IPEndPoint(IPAddress.Any, 9991);
            stateObject.SocketClient = new UdpClient();

            stateObject.SocketClient.Client.Bind(stateObject.LocalEndPoint);
            stateObject.SocketClient.JoinMulticastGroup(IPAddress.Parse("224.192.12.12"));
            stateObject.SocketClient.BeginReceive(new AsyncCallback(HandleDiscoveryServiceReceive), stateObject);

private static void HandleDiscoveryServiceReceive(IAsyncResult ar)
        {
            var stateObject = (StateObject)ar.AsyncState;

            IPEndPoint localEndPoint = stateObject.LocalEndPoint;

            byte[] data = stateObject.SocketClient.EndReceive(ar, ref localEndPoint);
            string decodedData = Encoding.UTF8.GetString(data);
            System.Console.WriteLine("Got something back: {0}", decodedData);

            UdpClient client = stateObject.SocketClient;
            client.MulticastLoopback = false;
            byte[] msg = Encoding.UTF8.GetBytes("REPLY");
            IPEndPoint remoteEndPoint = new IPEndPoint(IPAddress.Parse("224.192.12.12"), 9991);
            client.Send(msg, msg.Length, remoteEndPoint);

            client.BeginReceive(HandleDiscoveryServiceReceive, stateObject);
        } 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-05-20T01:56:59.417

您必须将回复发送到错误的地址：端口。你已经硬连线了：为什么？远程地址：端口由接收提供。用那个。

# c# - 同步客户端和服务器交互

> ID：10609988
> 
> 赞同：0
> 
> 时间：2012-05-15T23:01:25.527
> 
> 标签：c#, networking, tcp

所以我正在制作这个 tcp 程序，它只是在客户端和服务器之间发送和接收信息。

我的设置工作如下：

1）服务器开始监听

2）客户端发送“hello”命令以及用户名/密码

3）服务器发送“正确密码”或“错误密码”

4)客户端开始以50kb为间隔发送大量数据

5）服务器接收并存储这些数据

我的问题是：**我应该做些什么来确保当服务器没有监听时客户端不发送数据？例如，是否应该从服务器发送一条命令说它已成功获取数据？我只是想知道这一点，因为我不能让数据不按顺序排列。**

我通过 tcp 接收，我知道 TCP 应该将所有数据发送到服务器，但我的问题是服务器在发送给它时可能没有读取。

我的另一个问题是：**TCP 是通过互联网发送大量小数据（加起来很多）的好协议吗？这是 Dropbox 和其他同步实用程序与其服务器通信的方式吗？**

编辑：我目前正在使用 C# 和 networkstream 进行通信

谢谢，

罗希特

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-05-15T23:38:59.583

首先认为您需要阅读已经发明的数据通信协议和标准。包括 OSI/ISO [http://en.wikipedia.org/wiki/OSI_model](http://en.wikipedia.org/wiki/OSI_model) 帮助您了解 tcp 和 udp、http、rest 等级别。了解为交互和通信设计的技术，如 WCF。但是不要忘记使用您的自定义协议，它可以让您体验和表示数据通信如何工作以及为什么以及何时使用不同的协议和技术。

要解决数据传输冲突，您可以使用请求/应答通信组织。

但是使用 WCF 服务，您可以轻松地进行数据传输。没有很多编码和错误。

Tcp 可以很好地发送数据并避免数据损坏。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-05-16T01:46:04.420

> 我的问题是服务器在发送给它时可能没有读取。

您担心的问题实际上并不存在。如果服务器没有打开连接，您将获得“连接重置”。如果服务器的读取速度不如您写入的速度快，您的写入将在阻塞模式下阻塞，或者在非阻塞模式下返回重试指示。

# php - 我是否必须担心与 Doctrine2 EntityManagers 的多个实例不一致？

> ID：10609994
> 
> 赞同：0
> 
> 时间：2012-05-15T23:01:45.817
> 
> 标签：php, orm, doctrine-orm

我正在构建一个 Web 应用程序，并使用 CodeIgniter 和 Doctrine2。我们已经成功地通过项目引导 Doctrine2，并且在域和控制器上工作非常简单明了。

我们希望通过在 CodeIgniter 的控制器之间放置一个服务层来提高抽象级别。

我是否必须担心在所有服务类之间保持相同的实体管理器实例？我想知道如果我的一个控制器需要访问多个服务类，这是否会成为一个问题，并且由于拥有多个 EntityManagers 实例并将实体从一个服务类传递到另一个服务类，会形成不一致。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-05-18T11:05:36.173

构建服务定位器以获取您的实体管理器。节拍将它四处传递。

# sql-server - 有没有一种有效的方法将一个表的所有行转移到另一个表，一次一条记录

> ID：10609995
> 
> 赞同：0
> 
> 时间：2012-05-15T23:02:03.273
> 
> 标签：sql-server, performance, tsql, triggers, foreach

要求是将所有插入的记录转移到一个表到另一个表。我用触发器来做到这一点。我遍历所有插入的记录并一次插入新表一条记录，因为我必须增加目标表中的序列号。但是当插入的行数增加时，这个循环相当慢。有没有更好的方法来做到这一点。

```
Declare @maxpk int, @count int, @seq int
set @maxpk=(select max(refno) from inserted )
set @count=(select count(1) from inserted)
set @seq=((select max(seq_no) from dbase.dbo.destination))

while @count>0
begin
set @seq=(select @seq+1)
insert into dbase.dbo.destination(orderno,SEQ_NO,PRODUCT_ID,qty)
select  ordernumber,@seq,productid ,quantity
from inserted where refno=@maxpk
set @count=(select @count-1)
set @maxpk=(select top 1 refno from inserted where refno<@maxpk)
end 
```

refno 是源表的主键。有没有办法检查插入记录的结尾，所以我不必初始化和维护循环计数器？

并且可以为插入表中的每条记录执行循环，因此我不必通过比较主键的值来查找要插入的下一条记录。使用 mssql 2005

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-05-15T23:39:48.327

这应该可以处理并发，但我真的认为您需要重新审视设计（例如制作`seq_no`一个`IDENTITY`列，然后系统为您生成唯一值，并处理并发）。

```
CREATE TRIGGER dbo.SourceTrg ON dbo.Source
AFTER INSERT
AS
BEGIN
    SET NOCOUNT ON;

    DECLARE @seq INT;
    SET @seq = COALESCE((SELECT MAX(seq_no) 
      FROM dbase.dbo.Destination WITH (TABLOCKX, HOLDLOCK)), 0);

    INSERT dbase.dbo.Destination(SEQ_NO, orderno, PRODUCT_ID, qty)
      SELECT @seq + ROW_NUMBER() OVER (ORDER BY refno),
        ordernumber, productid, quantity
      FROM inserted;
END
GO 
```

# wordpress - 重写问题，Wordpress 永久链接

> ID：10609997
> 
> 赞同：0
> 
> 时间：2012-05-15T23:02:27.170
> 
> 标签：wordpress, url-rewriting, oscommerce

在我的一个网站中，我正在使用 wp_on​​line_store 插件 for wordpress，这是 oscommerce for wordpress。

如果我使用友好的 URL，我在这样的链接内有：

```
www.mysite.com/store/product_info/products_id/1234 
```

其中store是wordpress的一页(pagename=store)或(page_id=1)的rewrite，product_info与oscommerce的product_info.php有关。

主要问题是这种链接不存在，wordpress 无法识别它，并发送到：

```
www.mysite.com 
```

所以 oscommerce 重写了 url 但不识别它，正确的 url 是：

```
http://www.mysite.com/store?slug=product_info.php&products_id=1234
http://www.mysite.com/index.php?pagename=store&slug=product_info.php&products_id=1234
http://www.mysite.com/index.php?page_id=1&slug=product_info.php&products_id=1309 
```

我需要 wordpress 将第一个 url 发送到其中一个，但不断响应并使用第一种 url，所以这必须在内部进行，

有些方向会很好，

谢谢。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-05-22T22:11:34.480

```
function add_mypage_var($public_query_vars) {
$public_query_vars[] = 'slug';
$public_query_vars[] = 'cPath';
$public_query_vars[] = 'products_id';
$public_query_vars[] = 'manufacters_id';
$public_query_vars[] = 'sort';
$public_query_vars[] = 'action';
$public_query_vars[] = 'page';
$public_query_vars[] = 'guest';
$public_query_vars[] = 'keywords';

return $public_query_vars;
}

//add a rewrite rules to "Page that links to Store in my case (loja)"
function do_rewrite_mypage() {
add_rewrite_rule('loja/([^/]+)/([^/]+)/([^/]+)/([^/]+)/([^/]+)/([^/]+)/([^/]+)/([^/]+)/([^/]+)?$', 'index.php/loja/?slug=$1.php&$2=$3&$4=$5&$6=$7&$8=$9','top');
add_rewrite_rule('loja/([^/]+)/([^/]+)/([^/]+)/([^/]+)/([^/]+)/([^/]+)/([^/]+)?$', 'index.php/loja/?slug=$1.php&$2=$3&$4=$5&$6=$7','top');
add_rewrite_rule('loja/([^/]+)/([^/]+)/([^/]+)/([^/]+)/([^/]+)?$', 'index.php/loja/?slug=$1.php&$2=$3&$4=$5','top');
add_rewrite_rule('loja/([^/]+)/([^/]+)/([^/]+)?$', 'index.php/loja/?slug=$1.php&$2=$3','top');
add_rewrite_rule('loja/([^/]+)/?$', 'index.php/loja/?slug=$1.php','top');
}

add_filter('query_vars', 'add_mypage_var');
add_action('init', 'do_rewrite_mypage'); 
```

# .net - 在哪里可以找到 System.Diagnostics 的所有 CategoryName 及其 CounterName 的列表？

> ID：10609999
> 
> 赞同：0
> 
> 时间：2012-05-15T23:02:29.897
> 
> 标签：.net, system.diagnostics

这是我在这个我使用了很长时间的伟大网站上的第一个问题。

我想使用 System.Diagnostics 从远程计算机获取使用的 CPU 和内存的百分比。还需要知道某些进程使用的 CPU 和内存的百分比。为了访问远程计算机，我实现了“模拟”。这可以通过 WMI 轻松完成，但对于简单的监视任务来说效率非常低且资源密集。在具有 CounterName “Available MBytes” 的 CategoryName “Memory” 中，我可以获得可用内存量，但我还没有找到如何知道已使用总内存的百分比。

所以...

在哪里可以找到 System.Diagnostics 的所有 CategoryName 及其 CounterName 的列表？

* * *

## 回答 #1

> 赞同：-1
> 
> 时间：2012-05-15T23:08:45.270

我相信您需要性能计数器来获取那些远程计算机统计信息。请访问此链接以获取更多信息

[http://msdn.microsoft.com/en-us/library/system.diagnostics.performancecounter.aspx](http://msdn.microsoft.com/en-us/library/system.diagnostics.performancecounter.aspx) [http://www.cinchoo.com/category/diagnostics/performancecounters](http://www.cinchoo.com/category/diagnostics/performancecounters)