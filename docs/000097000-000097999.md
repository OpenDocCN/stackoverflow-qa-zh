# StackOverflow 问答 000097000-000097999

# intersystems-cache - 缓存对象的类型检查

> ID：97005
> 
> 赞同：2
> 
> 时间：2008-09-18T21:09:36.770
> 
> 标签：intersystems-cache, intersystems

Caché Object（来自 Intersystems）上的方法参数的类型定义有什么意义，因为在它被预编译为 .int 格式之后，它会删除任何类型信息，因此根本没有区别？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2008-09-25T14:34:12.907

这些类型不会在缓存代码内部使用/检查，但是当您通过 XML、SQL 等公开您的类时会使用它们。

人们希望在未来的版本中，Intersystems 将开始进行一些编译时类型检查，但这可能要求太多了。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2008-10-25T11:30:54.527

Cache 中没有真正的数据类型，因此没有类型检查。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2008-09-22T04:36:24.757

如果您正在编写 ANSI M 代码，则根本不应该有类型。我的猜测是这是特定于 Intersystems 代码的。

# eclipse - 如何以只读方式打开 Eclipse 项目？

> ID：97013
> 
> 赞同：22
> 
> 时间：2008-09-18T21:10:31.900
> 
> 标签：eclipse

有谁知道有没有办法在 Eclipse 中以只读模式打开项目？如果有很多类似的项目打开，很容易对错误的项目进行更改。

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2010-02-21T03:37:40.763

当您从前一个项目创建另一个实例时，将项目置于只读模式非常有用。因此，您从旧项目中复制所有文件，然后在新实例中进行更改。错误地编辑旧项目中的文件非常简单（它们具有相同的名称）！

Serg 如果您使用 linux，我建议在终端中使用 chmod 将所有文件置于只读模式：

```
sudo chmod 444 -R /path/to/your/project 
```

在此操作之后，Eclipse 将告诉您您尝试编辑的文件处于只读模式。我认为这足以使之前的项目安全:)

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2008-09-18T21:14:19.067

一种次优解决方案是在底层操作系统的文件系统中将项目目录设为只读。我不确定日食会如何反应。

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2009-08-13T16:12:42.400

此功能称为“二进制项目”，由 eclipse 插件开发环境 (PDE) 提供。请注意，这仅适用于 eclipse 插件项目，请参阅

[为 Eclipse 做贡献 - 原则、模式和插件](http://books.google.com/books?id=0X6wZRd5OOQC&pg=PA11&lpg=PA11)

或者

[http://www.vogella.de/articles/EclipseCodeAccess/article.html#importplugins_binary](http://www.vogella.de/articles/EclipseCodeAccess/article.html#importplugins_binary)

* * *

## 回答 #4

> 赞同：-1
> 
> 时间：2008-09-23T15:09:19.173

您还可以使用关闭项目/打开项目功能：关闭所有项目并只打开您需要处理的项目？

# flash - 你如何反编译一个swf文件

> ID：97018
> 
> 赞同：93
> 
> 时间：2008-09-18T21:11:06.127
> 
> 标签：flash, decompiling

我是一个网站的维护者，该网站据称“丢失”了 Flash swf 文件的源代码。我如何反编译这个源？

有没有我可以使用的在线或离线程序？

* * *

## 回答 #1

> 赞同：21
> 
> 时间：2008-09-18T21:13:01.707

通常“丢失”是“我们停止向开发人员付款，现在他不会给我们源代码”的委婉说法。

话虽如此，我拥有一份[Burak 的 ActionScript Viewer](http://www.buraks.com/asv/index.html)，它运行良好。一个简单的谷歌搜索会找到许多其他 SWF 反编译器。

* * *

## 回答 #2

> 赞同：11
> 
> 时间：2008-09-18T21:14:56.087

erlswf 是一个用 erlang 编写的开源项目，用于反编译 .swf 文件。

这是网站：[https ://github.com/bef/erlswf](https://github.com/bef/erlswf)

* * *

## 回答 #3

> 赞同：9
> 
> 时间：2008-09-18T21:15:14.837

获取 Sothink SWF 反编译器。不是免费的，但值得。最近用它来反编译一个我丢失了fla的SWF，我可以完全往返swf-fla！
[链接文本](http://www.sothink.com/)

* * *

## 回答 #4

> 赞同：2
> 
> 时间：2008-09-19T07:45:24.307

我对 CPAN 上的[SWF::File](http://search.cpan.org/dist/SWF-File/)库非常幸运，尤其是该发行版附带的[dumpswf.plx工具。](http://search.cpan.org/src/YSAS/SWF-File-0.42/dumpswf.plx)它生成 Perl 代码，运行时会重新生成您的 SWF。

* * *

## 回答 #5

> 赞同：2
> 
> 时间：2011-10-12T07:57:40.307

我用过硕思闪客 SWF 反编译器几次，唯一的问题是随着项目变得越来越复杂，反编译器的输出越来越难以再次编译回来。但它确保您可以在大多数情况下获取您的 .as 文件，可编译的 fla 是一个问题。

[Sothink SWF反编译器](http://www.sothink.com/product/flashdecompiler/)

# c++ - std::map 插入或 std::map 查找？

> ID：97050
> 
> 赞同：101
> 
> 时间：2008-09-18T21:14:26.307
> 
> 标签：c++, optimization, stl, stdmap

假设您要在其中保留现有条目的地图。20% 的时间，您插入的条目是新数据。使用返回的迭代器执行 std::map::find 然后 std::map::insert 是否有优势？或者尝试插入然后根据迭代器是否指示记录已插入或未插入是否更快？

* * *

## 回答 #1

> 赞同：154
> 
> 时间：2008-09-19T13:52:25.413

答案是你都不做。相反，您想做[Scott Meyers的](http://www.aristeia.com/)[Effective STL](https://rads.stackoverflow.com/amzn/click/com/0201749629)的第 24 条建议的事情：

```
typedef map<int, int> MapType;    // Your map type may vary, just change the typedef

MapType mymap;
// Add elements to map here
int k = 4;   // assume we're searching for keys equal to 4
int v = 0;   // assume we want the value 0 associated with the key of 4

MapType::iterator lb = mymap.lower_bound(k);

if(lb != mymap.end() && !(mymap.key_comp()(k, lb->first)))
{
    // key already exists
    // update lb->second if you care to
}
else
{
    // the key does not exist in the map
    // add it to the map
    mymap.insert(lb, MapType::value_type(k, v));    // Use lb as a hint to insert,
                                                    // so it can avoid another lookup
} 
```

* * *

## 回答 #2

> 赞同：13
> 
> 时间：2008-09-19T11:09:50.743

这个问题的答案还取决于创建您在地图中存储的值类型的成本：

```
typedef std::map <int, int> MapOfInts;
typedef std::pair <MapOfInts::iterator, bool> IResult;

void foo (MapOfInts & m, int k, int v) {
  IResult ir = m.insert (std::make_pair (k, v));
  if (ir.second) {
    // insertion took place (ie. new entry)
  }
  else if ( replaceEntry ( ir.first->first ) ) {
    ir.first->second = v;
  }
} 
```

对于诸如 int 之类的值类型，上述方法将比 find 后跟 insert 更有效（在没有编译器优化的情况下）。如上所述，这是因为通过地图的搜索只发生一次。

但是，对 insert 的调用要求您已经构建了新的“值”：

```
class LargeDataType { /* ... */ };
typedef std::map <int, LargeDataType> MapOfLargeDataType;
typedef std::pair <MapOfLargeDataType::iterator, bool> IResult;

void foo (MapOfLargeDataType & m, int k) {

  // This call is more expensive than a find through the map:
  LargeDataType const & v = VeryExpensiveCall ( /* ... */ );

  IResult ir = m.insert (std::make_pair (k, v));
  if (ir.second) {
    // insertion took place (ie. new entry)
  }
  else if ( replaceEntry ( ir.first->first ) ) {
    ir.first->second = v;
  }
} 
```

为了调用“插入”，我们为构造我们的值类型的昂贵调用付出了代价——从你在问题中所说的来看，你不会在 20% 的时间内使用这个新值。在上述情况下，如果更改映射值类型不是一个选项，那么首先执行“查找”以检查我们是否需要构造元素会更有效。

或者，可以更改映射的值类型以使用您最喜欢的智能指针类型存储数据的句柄。对 insert 的调用使用空指针（构造起来非常便宜），并且仅在必要时才构造新的数据类型。

* * *

## 回答 #3

> 赞同：8
> 
> 时间：2008-09-18T21:17:26.610

2 之间的速度几乎没有任何差异，find 将返回一个迭代器， insert 做同样的事情，并且无论如何都会搜索地图以确定条目是否已经存在。

所以..它取决于个人喜好。我总是尝试插入，然后在必要时更新，但有些人不喜欢处理返回的对。

* * *

## 回答 #4

> 赞同：5
> 
> 时间：2008-09-18T21:24:42.227

我认为，如果您先查找然后插入，那么额外的成本将是您找不到密钥并在之后执行插入。这有点像按字母顺序浏览书籍但没有找到书籍，然后再次浏览书籍以查看将其插入的位置。它归结为您将如何处理密钥以及它们是否不断变化。现在有一些灵活性，如果你没有找到它，你可以记录，异常，做任何你想做的事情......

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2008-09-18T21:26:30.957

如果您关心效率，您可能需要查看[hash_map<>](http://www.sgi.com/tech/stl/hash_map.html)。

通常 map<> 被实现为二叉树。根据您的需要， hash_map 可能更有效。

* * *

## 回答 #6

> 赞同：1
> 
> 时间：2011-07-28T06:47:05.877

我似乎没有足够的分数来发表评论，但是勾选的答案对我来说似乎是冗长的 - 当您认为 insert 无论如何都会返回迭代器时，为什么要搜索 lower_bound，当您可以使用返回的迭代器时。奇怪的。

* * *

## 回答 #7

> 赞同：-1
> 
> 时间：2008-09-18T21:21:27.287

任何关于效率的答案都取决于您的 STL 的确切实现。唯一确定的方法是对它进行双向基准测试。我猜这种差异不太可能很大，所以根据你喜欢的风格来决定。

* * *

## 回答 #8

> 赞同：-2
> 
> 时间：2008-09-18T21:19:43.563

map[ key ] - 让 stl 整理出来。那是最有效地传达你的意图。

是的，很公平。

如果您进行查找然后插入，则当您错过时，您将执行 2 x O(log N)，因为查找只会让您知道是否需要插入而不是插入应该去的位置（lower_bound 可能会帮助您） . 直接插入然后检查结果就是我要走的路。

# asp.net - GetConnectionInterface 在生命周期的哪个阶段被调用？

> ID：97054
> 
> 赞同：1
> 
> 时间：2008-09-18T21:14:48.893
> 
> 标签：asp.net, sharepoint, web-parts, page-lifecycle, webpart-connection

我在 webpart 上有这个方法：

```
private IFilterData _filterData = null;

[ConnectionConsumer("Filter Data Consumer")]
public void GetConnectionInterface(IFilterData filterData)
{
    _filterData = filterData;
} 
```

现在，在我可以调用之前`_filterData`，我需要知道我什么时候可以期望它不为*null*。这是什么时候？！

在不知道这一点的情况下，我能做的最好的事情就是把我所有的`_filterWebpart`依赖代码都塞进最后几行，`OnPreRender`并希望最好。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2008-09-19T00:14:27.730

根据这个文件，它看起来像加载。

[http://msdn.microsoft.com/en-us/library/ms366536.aspx](http://msdn.microsoft.com/en-us/library/ms366536.aspx)

# business-objects - 谁能给我一份业务对象错误代码列表及其含义？

> ID：97063
> 
> 赞同：0
> 
> 时间：2008-09-18T21:15:28.503
> 
> 标签：business-objects

Business Objects Web 服务返回错误代码，我还没有找到一个很好的资源来列出这些代码以及它们的含义。我目前收到“结果集为空。（错误：WBP 42019）”。关于这些可能在哪里列出的任何想法？我已致电 Business Objects 支持，但技术人员甚至无法告诉我。任何人？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-10-05T20:27:09.813

这是我找到的最好的地方：

[http://help.sap.com/businessobject/product_guides/errors/12/0/en/html/idxentries.htm](http://help.sap.com/businessobject/product_guides/errors/12/0/en/html/idxentries.htm)

每个错误代码都是一个带有描述的链接。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2008-09-18T21:24:16.157

也许[这](http://resources.businessobjects.com/support/communitycs/TechnicalPapers/pecodes.pdf?recDnlReq=Record&dnlPath=pecodes.pdf)？（PDF链接-当心）

在这里找到：（谷歌缓存，因为页面似乎死了）： http: [//209.85.173.104/search ?q=cache:fyB21Ywrj-MJ:support.businessobjects.com/communityCS/TechnicalPapers/pecodes.pdf.asp+%22Business+对象%22+%22错误+代码%22&hl=en&ct=clnk&cd=1&gl=us](http://209.85.173.104/search?q=cache:fyB21Ywrj-MJ:support.businessobjects.com/communityCS/TechnicalPapers/pecodes.pdf.asp+%22Business+Objects%22+%22Error+Codes%22&hl=en&ct=clnk&cd=1&gl=us)

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2008-09-18T21:35:52.073

我发现最好的是 Business Objects 的“错误消息指南”。 [http://help.sap.com/businessobject/product_guides/boexir2/en/xir2_ErrMsgGde_en.pdf](http://help.sap.com/businessobject/product_guides/boexir2/en/xir2_ErrMsgGde_en.pdf)

如果您在该指南中找不到错误代码，那么您最终不得不处理未记录的应用程序的标准调试。
1\. 阅读消息，也许会有所帮助。
2.检查服务器上的日志，如果是DeskI，则为本地机器。
3\. 看看[BOB论坛](http://forumtopics.com/busobj/index.php)搜索有没有答案。

您列出的示例似乎没有检索到数据。仔细检查生成的查询是否正确，并且通常应该返回结果。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2021-03-04T09:17:50.467

**SAP DI API(SDK) 的错误列表 - SAP B1 9.3**

此列表可以在 SDK 安装目录中找到：

> C:\Program Files (x86)\SAP\SAP Business One SDK\Samples\UDO\Include\VS6\__SBOERR.h

这是它的内容，很好地解释了所有错误：

```
#ifndef __SBOERR_H_
#define __SBOERR_H_

typedef long SBOErr;

#define dbdError                    -1
#define noErr                       0
#define errNoMsg                    -10
#define coreEndOfFile               -39
#define coreFileNotFound            -43
#define coreFileBusy                -47
#define coreFileNotOpened           -50
#define coreFileCorrupted           -51
#define coreDivisionByZero          -99
#define coreOutOfMemory             -100
#define corePrinterError            -101
#define corePrintCanceled           -103
#define coreMoneyOverflow           -104
#define coreInvalidPointer          -111
#define coreError                   -199
#define coreBadDirectory            -213
#define coreFileExists              -214
#define coreInvalidFilePermission   -216
#define coreInvalidPath             -217
#define coreBadPassword             -218
#define coreBadUser                 -219
#define coreUpgradePerformed        -221
#define coreNoCurrPeriodErr         -222
#define coreLanguageInitErr         -8020

/* DBM Errors */
#define dbmFirstError           -1000
#define dbmBadColumnType        -1001
#define dbmNotSupported         -1002
#define dbmAliasNotFound        -1003
#define dbmValueNotFound        -1004
#define dbmBadDate              -1005
#define dbmNoDefaultColumn      -1012
#define dbmZeroOrBlankValue     -1013
#define dbmIntegerTooLarge      -1015
#define dbmBadValue             -1016
#define dbmOtherFileNotRelated  -1022
#define dbmOtherKeyNotInMainKey -1023
#define dbmArrayRecordNotFound  -1025
#define dbmMustBePositive       -1027
#define dbmMustBeNegative       -1028
#define dbmColumnNotUpdatable   -1029
#define dbmBadNumValue          -1030
#define dbmBadTimeValue         -1031
#define dbmBadMoneyValue        -1032
#define dbmNotUserDataSource    -1033

#define dbmCannotAllocEnv       -1100
#define dbmBadConnection        -1101
#define dbmConnectionNotOpen    -1102
#define dbmDatabaseExists       -1103
#define dbmCannotCreateDatabase -1104

#define dbmInternalError        -1200

#define dbmBadParameters        -2001
#define dbmTooManyTables        -2003
#define dbmTableNotFound        -2004
#define dbmBadDefinition        -2006
#define dbmBadDAG               -2007
#define dbmBadRecordOffset      -2010
#define dbmNoColumns            -2013
#define dbmBadColumnIndex       -2014
#define dbmBadIndexNumber       -2015
#define dbmBadAlias             -2017
#define dbmAliasAlreadyExists   -2018
#define dbmBadColumnSize        -2020
#define dbmBadColumLevel        -2022
#define dbmDAGsNoMatch          -2024
#define dbmNoKeys               -2025
#define dbmPartialDataFound     -2027
#define dbmNoDataFound          -2028
#define dbmColumnsNoMatch       -2029
#define dbmDuplicateKey         -2035
#define dbmRecordLocked         -2038
#define dbmDataWasChanged       -2039
#define dbmEndOfSort            -2045
#define dbmNotOpenForWrite      -2049
#define dbmNoMatchWithDAG       -2056
#define dbmBadContainerOffset   -2062
#define dbmLoadExtLibFailed     -2100
#define dbmRowSizeTooLong       -2110 // the size of the table row is over the Sql limit 8K
#define dbmLastError            -2999

//db2 specific errors
#define dbmdb2AttachFailed      -2101
#define dbmdb2CreateDBFailed    -2102
#define dbmdb2DeAttachFailed    -2103
#define dbmdb2BackupFailed      -2104

//sybase specific errors
#define dbmSybaseDeviceCreationFailed    -2200

// QRY errors
#define qryNotDefined           -1
#define qryFirstError           -3000
#define qryColumnNotFound       -3001
#define qryBadVarNum            -3003
#define qryWrongToken           -3004
#define qryTokenAfterEnd        -3005
#define qryUnexpectedEnd        -3006
#define qryQueryTooLong         -3008
#define qryExtraRightPar        -3009
#define qryNoRightPar           -3010
#define qryNoOpcode             -3012
#define qryNoColInComp          -3013
#define qryBadCondition         -3014
#define qryBadSortList          -3015
#define qryNoString             -3017
#define qryTooManyColumns       -3018
#define qryTooManyIndices       -3019
#define qryTooManyTables        -3020
#define qryRefNotFound          -3021
#define qryBadRangeSet          -3022
#define qryBadParse             -3023
#define qryTwoArraysInQuery     -3024
#define qryVarMissing           -3025
#define qryBadInput             -3026
#define qryProgressAborted      -3027
#define qryBadTableIndex        -3028
#define qryBadQuery             -3032
#define qryEmptyRecord          -3033
#define qryNoImpYet             -3034
#define qryBadParameter         -3036
#define qryMissingTableInList   -3037
#define qryBadOperation         -3040
#define qryBadExpression        -3041
#define qryNameAlreadyExists    -3042
#define qryTimeExpired          -3044
#define qryBadCallbackNum       -3045
#define qryNoCallback           -3046
#define qryLastError            -3046

//FORM errors
#define formNoWindow                3001
#define formBadVarNum               3002
#define formTooManyVars             3003
#define formDuplicateUID            3004
#define formInvalidItem             3006
#define formTooManyForms            3007
#define formTooManySavedPtrs        3009
#define formInvalidForm             3012
#define formCantGetMultilineEdit    3015
#define formBadItemType             3016
#define formBadParameters           3017
#define formNoMessageProc           3023
#define formItemNotSelectable       3029
#define formBadValue                3031
#define formItemNotFound            3033
#define formAXCreateFailed          3034
#define formNotUserItem             3035
#define formItemNotEditable         3036
#define formItemFocusFailedNotVisible       3037
#define formItemFocusFailedNotEditable      3038
#define fromCloseAllFormsFailed             3039

// GRID errors
#define gridInvalidGrid             4007
#define gridBadSize                 4008
#define gridNoData                  4009
#define gridInvalidParams           4011
#define gridNoSuperTitle            4013
#define gridSuperTitle2Exits        4014
#define gridBadItemNum              4015
#define gridBadData                 4016
#define gridAlreadyFolded           4017
#define gridAlreadyExpanded         4018
#define gridLineExists              4019
#define gridNotEnoughData           4020
#define gridSuperTitlesExists       4022
#define gridRowNotCollapssible      4027
#define gridRowHasNoCollapseLevel   4028
#define gridInvalidRow              4029
#define gridItemSelectNotSupported  4030
#define gridInvalidColNum           4031
#define gridFocusFailedNotEditable          4032
#define gridFocusFailedNotVisible           4033
#define gridColumnFocusFailedNotEditable    4034

// SBAR
#define sbarNoSuchInfo          8004
#define sbarInfoOcccupied       8005
#define sbarProgressStopped     8007
#define sbarTooManyProgresses   8008
#define sbarNoMessageBar        8006

// GRAPH
#define graphInvalidGraph       5001
#define graphBadItemNum         5002
#define graphBadParameters      5005

// IBAR
#define ibarError               9000

// SCRIPT
#define     scFirstError            -9000
#define     scInvalidType           -9000
#define     scLineTooLarge          -9002
#define     scInvalidTokType        -9003
#define     scInvalidLine           -9004
#define     scInvalidFormType       -9005
#define     scInvalidOperator       -9006
#define     scInvalidScriptCall     -9007
#define     scItemNotValid          -9008
#define     scNotGird               -9009
#define     scUndefinedVar          -9010
#define     scRedefinedVar          -9011
#define     scNotVarOperation       -9012
#define     scIncompatVarType       -9013
#define     scStringTooLong         -9014
#define     scDivByZero             -9015
#define     scFileNotChoosen        -9016
#define     scFileNotOpen           -9017
#define     scSomeDataRead          -9018
#define     scIfNotClosed           -9020
#define     scLoopNotClosed         -9021
#define     scNotCompareThisType    -9022
#define     scLastError             -9022

// Reports
#define rptFirstError               -6100
#define rptNotValid                 -6100
#define rptDuplicateItem            -6101
#define rptBadParameters            -6200
#define rptColNotFound              -6250
#define rptBadVarNum                -6300
#define rptVarNotSet                -6305
#define rptBadStandardIndex         -6350
#define rptBadItemNum               -6370
#define rptBadItemType              -6373
#define rptItemFromAnotherPart      -6380
#define rptPassedPageLimit          -6390
#define rptProgressAborted          -6400
#define rptTooManyPages             -6450
#define rptNotPageFooter            -6500
#define rptNoQuery                  -6550
#define rptNotPicture               -6600
#define rptPrintCanceledByUser      -6650
#define rptMarginTooLarge           -6651
#define rptLoadExtLibFailed         -6652
#define rptLoadExtProcFailed        -6653
#define rptReportTooLongForExport   -6700
#define rptInvalidFieldIDFormat     -6710
#define rptFieldIDAlreadyExist      -6711
#define rptRecursiveDependency      -6712
#define rptFormulaGrammarError      -6713
#define rptSumItemCanOnlyBeInRepArea    -6714
#define rptNoSums                   -6715
#define rptDataTypeNoSuchMethod     -6716
#define rptFieldDoesnotExist        -6717
#define rptFieldNotEvaluatedYet     -6718
#define rptInvalidParameter         -6719
#define rptMethodNotSupported       -6720
#define rptTotalPageLiveAlone       -6721
#define rptRecursiveRelation        -6722
#define rptLastError                -6799

// Prog
#define progBadProgress                 9001
#define progProgressIsModal             9002
#define progProgressStopped             9003
#define progBadParams                   9004
#define progOnlyOneDim                  9005
#define progModalProgressAlreadyOn      9006

//Menus
#define menuNotOwnerDrawn               -11001
#define menuNotSupportedImageType       -11002
#define menuCannotLoadImageFile         -11003

//UI errors
#define uiDuplicateUniqueID             -7502
#define uiInvalidObject                 -7503
#define uiFunctionNotSupported          -7002
#define uiCannotSetFocusOnItem          -7653
#define uiSecuritySetFocusFailed        -7654
#define uiFailedLoadXml                 -7040
#define uiInvalidFieldValue             -7018

#define dataTableSourceDTEqualToTargetDT        -7751
#define dataTableDuplicateColumnUID             -7752 //4500
#define dataTableInvalidColumnIndex             -7753 //4501
#define dataTableInvalidColumnUid               -7754 //4502
#define dataTableInvalidDAG                     -7755 //4503
#define dataTableDuplicateUid                   -7756 //4504
#define dataTableInvalidUid                     -7757 //4505
#define dataTableInvalidIndex                   -7758 //4506
#define dataTableInvalidVaribleNumber           -7759 //4507
#define dataTableInvalidRowIndex                -7760 //4508
#define dataTableInvalidAlias                   -7761 //4509
#define dataTableLineExists                     -7762 //4510
#define dataTableInvalidItemType                -7763 //4511
#define dataTableNotWritable                    -7764 //4512
#define dataTableAlreadyConnectedToGrid         -7765 //4513
#define dataTableAlreadyConnectedToFormItem     -7766 //4514
#define dataTableColumnDataExceedsSize          -7767 //4515
#define dataTableInvalidValueType               -7768

#endif 
```

# c++ - “get() const”与“getAsConst() const”

> ID：97081
> 
> 赞同：1
> 
> 时间：2008-09-18T21:17:50.930
> 
> 标签：c++, coding-style, constants

有人告诉我他们团队中的 C++ 风格差异。我对这个主题有自己的看法，但我会对每个人的*利弊**感兴趣*。

所以，如果你有一个类属性，你想通过两个 getter 公开，一个是读/写，另一个是只读的（即没有 set 方法）。至少有两种方法：

```
class T ;

class MethodA
{
   public :
      const T & get() const ;
      T & get() ;

      // etc.
} ;

class MethodB
{
   public :
      const T & getAsConst() const ;
      T & get() ;

      // etc.
} ; 
```

每种方法的优缺点是什么？

我对 C++ 技术/语义原因更感兴趣，但也欢迎风格原因。

请注意，它`MethodB`有一个主要的技术缺陷（提示：在通用代码中）。

* * *

## 回答 #1

> 赞同：10
> 
> 时间：2008-09-18T21:24:23.630

C++ 应该完全能够在几乎所有情况下处理方法 A。我一直用它，从来没有遇到过问题。

方法B，在我看来，是一个违反OnceAndOnlyOnce的案例。而且，现在您需要弄清楚您是否正在处理 const 引用来编写第一次编译的代码。

我想这是一种风格上的事情——从技术上讲，它们都可以工作，但是 MethodA 使编译器工作得更加努力。对我来说，这是一件好事。

* * *

## 回答 #2

> 赞同：8
> 
> 时间：2008-09-18T21:34:35.697

好吧，一方面，当“this”指针为 const 时，*必须*调用 getAsConst，而不是在您想要接收 const 对象时调用。因此，除了任何其他问题之外，它还被巧妙地命名为错误名称。（当 'this' 是非常量时，你仍然可以调用它，但这既不在这里也不在那里。）

忽略这一点，getAsConst 将一无所获，并且给使用该接口的开发人员带来了不应有的负担。而不是仅仅调用“get”并知道他得到了他需要的东西，现在他必须确定他当前是否正在使用 const 变量，以及他正在抓取的新对象是否需要是 const 。之后，如果两个对象由于一些重构而变为非常量，他必须切换他的调用。

* * *

## 回答 #3

> 赞同：4
> 
> 时间：2008-09-18T21:26:01.707

就个人而言，我更喜欢第一种方法，因为它使界面更加一致。此外，对我来说 getAsConst() 听起来和 getAsInt() 一样愚蠢。

另一方面，在将非常量引用或非常量指针返回到类的数据成员之前，您确实应该三思而后行。这是邀请人们利用您班级的内部运作，理想情况下应该隐藏。换句话说，它打破了封装。我会使用 get() const 和 set()，并且仅在没有其他方法或确实有意义时才返回非常量引用，例如授予对数组元素的读/写访问权限或矩阵。

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2008-09-18T21:37:55.283

鉴于标准库设置的样式先例（即 begin() 和 begin() const 仅举一个例子），显然方法 A 是正确的选择。我质疑选择方法 B 的人的理智。

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2008-09-18T23:45:00.767

因此，通常首选第一种样式。

不过，我们确实在我目前正在处理的代码库中大量使用了第二种样式的变体，因为我们希望在 const 和非常量用法之间有一个很大的区别。

在我的具体示例中，我们有 getTessellation 和 getMutableTessellation。它是用写时复制指针实现的。出于性能原因，我们希望尽可能使用 const 版本，因此我们将名称缩短，并且我们将其命名为不同的名称，这样人们就不会在他们不打算写的时候意外地复制。

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2008-09-18T21:22:21.513

虽然您的问题似乎只解决了一种方法，但我很乐意就风格提供我的意见。就个人而言，出于风格原因，我更喜欢前者。大多数 IDE 会为您弹出函数的类型签名。

* * *

## 回答 #7

> 赞同：0
> 
> 时间：2008-09-18T21:25:36.840

我更喜欢第一个。当本质上做相同事情的两件事看起来相同时，它在代码中看起来更好。此外，您很少有一个非常量对象但又想调用 const 方法，因此这并不是什么大问题（在最坏的情况下，您只需要一个 const_cast<>）。

* * *

## 回答 #8

> 赞同：0
> 
> 时间：2008-09-18T21:27:07.400

第一个允许更改变量类型（无论是否`const`），而无需进一步修改代码。当然，这意味着没有通知开发人员这可能已从预期路径更改。因此，您真正看重的是能够快速重构还是拥有额外的安全网。

* * *

## 回答 #9

> 赞同：0
> 
> 时间：2008-09-18T21:43:13.460

第二个是与匈牙利符号有关的东西，我个人*不*喜欢，所以我会坚持**第**一种方法。

我不喜欢匈牙利符号，因为它增加了我在编程中通常讨厌的冗余。这只是我的意见。

* * *

## 回答 #10

> 赞同：0
> 
> 时间：2008-09-18T21:55:20.763

由于您隐藏了类的名称，因此这种关于风格的思考可能适用也可能不适用：

告诉这两个对象 MethodA 和 MethodB “get”还是“getAsConst”有意义吗？您会将“get”或“getAsConst”作为消息发送到任一对象吗？

在我看来，作为消息的发送者/方法的调用者，*你*是获得价值的人；因此，为了响应这个“获取”消息，您正在向 MethodA / MethodB 发送一些消息，其结果是您需要获取的值。

示例：如果 MethodA 的调用者是 SOA 中的服务，而 MethodA 是存储库，则在服务的 get_A() 中，调用 MethodA.find_A_by_criteria(...)。

* * *

## 回答 #11

> 赞同：0
> 
> 时间：2008-09-19T16:38:28.900

我看到的 MethodB 的主要技术缺陷是，在对其应用泛型代码时，我们必须将代码加倍以同时处理 const 和非 const 版本。例如：

假设 T 是一个可排序的对象（即，我们可以使用运算符 < 与 T 类型的对象进行比较），假设我们想要找到两个 MethodA（分别是两个 MethodB）之间的最大值。

对于 MethodA，我们只需要编写以下代码：

```
template <typename T>
T & getMax(T & p_oLeft, T & p_oRight)
{
   if(p_oLeft.get() > p_oRight.get())
   {
      return p_oLeft ;
   }
   else
   {
      return p_oRight ;
   }
} 
```

此代码适用于 T 类型的 const 对象和非 const 对象：

```
// Ok
const MethodA oA_C0(), oA_C1() ;
const MethodA & oA_CResult = getMax(oA_C0, oA_C1) ;

// Ok again
MethodA oA_0(), oA_1() ;
MethodA & oA_Result = getMax(oA_0, oA_1) ; 
```

当我们想将这个简单的代码应用到遵循 MethodB 约定的东西时，问题就来了：

```
// NOT Ok
const MethodB oB_C0(), oB_C1() ;
const MethodB & oB_CResult = getMax(oB_C0, oB_C1) ; // Won't compile

// Ok
MethodA oB_0(), oB_1() ;
MethodA & oB_Result = getMax(oB_0, oB_1) ; 
```

为了让 MethodB 在 const 和 non-const 版本上都工作，我们都必须使用已经定义的 getMax，但要添加以下版本的 getMax：

```
template <typename T>
const T & getMax(const T & p_oLeft, const T & p_oRight)
{
   if(p_oLeft.getAsConst() > p_oRight.getAsConst())
   {
      return p_oLeft ;
   }
   else
   {
      return p_oRight ;
   }
} 
```

结论，由于不信任编译器的 const 使用，我们负担了创建两个泛型函数的负担，而一个应该足够了。

当然，如果有足够的妄想症，第二个模板函数应该被称为 getMaxAsConst ......因此，问题将通过所有代码传播......

:-p

# c# - 如何将 Sytem.Windows.Form 的高度限制为精确值？

> ID：97092
> 
> 赞同：1
> 
> 时间：2008-09-18T21:19:20.273
> 
> 标签：c#, winforms

我想要实现的是一个表单，上面有一个按钮，导致表单“下拉”并变大，显示更多信息。我目前的尝试是这样的：

```
private void btnExpand_Click(object sender, EventArgs e)
{
    if (btnExpand.Text == ">")
    {
        btnExpand.Text = "<";
        _expanded = true;
        this.MinimumSize = new Size(1, 300);
        this.MaximumSize = new Size(int.MaxValue, 300);
    }
    else
    {
        btnExpand.Text = ">";
        _expanded = false;
        this.MinimumSize = new Size(1, 104);
        this.MaximumSize = new Size(int.MaxValue, 104);
    }
} 
```

效果很好！除了一个小细节...请注意，宽度值应该能够从 1 变为 int.MaxValue？好吧，在实践中，它们从 this.Width 变为 int.MaxValue，即。您可以使表格更大，但永远不会再变小。我不知道为什么会发生这种情况。有人有想法么？

作为记录：我还尝试了一个 Form.Resize 处理程序，它将表单的高度设置为相同的值，具体取决于布尔值 _expanded 的设置，但我最终得到了相同的副作用。

PS：我在 Visual Studio 2008 中使用 .NET 3.5。欢迎使用其他解决方案，但这是我对“应该”如何完成以及我如何尝试去做的想法。

编辑：根据接受的答案响应，似乎代码有效。如果其他人遇到此特定问题的麻烦，请检查表单的 AutoSize 属性，它应该是 FALSE，而不是 TRUE。（这是默认设置，但我在使用表单和带有自动大小的标签时将其打开，以便更早地显示调试信息）

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2008-09-18T22:36:05.737

根据文档，使用 0 表示没有最大或最小大小。Tho，我刚刚尝试过，它根本不喜欢 0。所以我像你一样使用了 int.MaxValue 并且它起作用了。你使用的是什么版本的框架？

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2008-09-18T23:07:52.353

实际上，看看反射器中的`MinimumSize`and `MaximumSize`(.NET 3.5) 很明显，设计的行为与文档建议的不太一样。有一些从帮助类确定的最小宽度约束，并且 0 没有特殊含义（即没有限制。

另一个注意事项，我在上面的代码中看到，您正在根据 Button 的文本值进行扩展或收缩，这是一个坏主意，如果有人稍后出现并将设计器中的文本更改为“扩展”而不是< 如果不查看您的代码，它将产生意想不到的副作用，大概您在某处有一些代码可以更改按钮文本，最好在某处有一个状态变量并打开它。

# c# - VB.net 的 InputDialog 的 C# 版本是什么？

> ID：97097
> 
> 赞同：166
> 
> 时间：2008-09-18T21:20:05.963
> 
> 标签：c#, vb.net

VB.net 的 InputBox 的 C# 版本是什么？

* * *

## 回答 #1

> 赞同：255
> 
> 时间：2008-09-18T21:25:56.480

在命名空间中添加对`Microsoft.VisualBasic`,的引用：`InputBox``Microsoft.VisualBasic.Interaction`

```
using Microsoft.VisualBasic;
string input = Interaction.InputBox("Prompt", "Title", "Default", x_coordinate, y_coordinate); 
```

只有第一个参数 for`prompt`是强制性的

* * *

## 回答 #2

> 赞同：125
> 
> 时间：2013-07-09T11:20:09.807

动态创建对话框。您可以根据自己的口味进行定制。

*注意这里除了winform没有外部依赖*

```
private static DialogResult ShowInputDialog(ref string input)
    {
        System.Drawing.Size size = new System.Drawing.Size(200, 70);
        Form inputBox = new Form();

        inputBox.FormBorderStyle = System.Windows.Forms.FormBorderStyle.FixedDialog;
        inputBox.ClientSize = size;
        inputBox.Text = "Name";

        System.Windows.Forms.TextBox textBox = new TextBox();
        textBox.Size = new System.Drawing.Size(size.Width - 10, 23);
        textBox.Location = new System.Drawing.Point(5, 5);
        textBox.Text = input;
        inputBox.Controls.Add(textBox);

        Button okButton = new Button();
        okButton.DialogResult = System.Windows.Forms.DialogResult.OK;
        okButton.Name = "okButton";
        okButton.Size = new System.Drawing.Size(75, 23);
        okButton.Text = "&OK";
        okButton.Location = new System.Drawing.Point(size.Width - 80 - 80, 39);
        inputBox.Controls.Add(okButton);

        Button cancelButton = new Button();
        cancelButton.DialogResult = System.Windows.Forms.DialogResult.Cancel;
        cancelButton.Name = "cancelButton";
        cancelButton.Size = new System.Drawing.Size(75, 23);
        cancelButton.Text = "&Cancel";
        cancelButton.Location = new System.Drawing.Point(size.Width - 80, 39);
        inputBox.Controls.Add(cancelButton);

        inputBox.AcceptButton = okButton;
        inputBox.CancelButton = cancelButton; 

        DialogResult result = inputBox.ShowDialog();
        input = textBox.Text;
        return result;
    } 
```

用法

```
string input="hede";
ShowInputDialog(ref input); 
```

* * *

## 回答 #3

> 赞同：112
> 
> 时间：2008-09-18T22:02:51.900

把它们加起来：

*   [C#](http://www.google.com/search?hl=en&q=c%23+inputbox)中没有。
*   您可以通过添加对 Microsoft.VisualBasic 的引用来使用 Visual Basic 中的对话框：

    1.  在**解决方案资源管理器**中，右键单击**References**文件夹。
    2.  选择**添加参考...**
    3.  在**.NET**选项卡中（在较新的 Visual Studio 版本 -**程序集**选项卡中）- 选择**Microsoft.VisualBasic**
    4.  点击**确定**

然后你可以使用前面提到的代码：

```
string input = Microsoft.VisualBasic.Interaction.InputBox("Prompt", "Title", "Default", 0, 0); 
```

*   编写自己的输入框。
*   用[别人的](http://www.reflectionit.nl/Articles/InputBox.aspx)。

也就是说，我建议您首先考虑是否需要输入框。对话并不总是做事的最佳方式，有时它们弊大于利——但这取决于具体情况。

* * *

## 回答 #4

> 赞同：9
> 
> 时间：2008-09-18T21:23:57.033

没有一个。如果你真的想在 C# 中使用 VB InputBox，你可以。只需添加对 Microsoft.VisualBasic.dll 的引用，您就会在那里找到它。

但我建议*不要*使用它。这是丑陋和过时的国际海事组织。

* * *

## 回答 #5

> 赞同：5
> 
> 时间：2013-02-19T19:12:01.667

您不仅应该将 Microsoft.VisualBasic 添加到项目的参考列表中，还应该声明“使用 Microsoft.VisualBasic；” 所以你只需要使用 'Interaction.Inputbox("...")' 而不是 Microsoft.VisualBasic.Interaction.Inputbox

* * *

## 回答 #6

> 赞同：5
> 
> 时间：2013-02-21T22:00:15.497

返回用户输入的字符串；如果他们命中，则为空字符串`Cancel`：

```
 public static String InputBox(String caption, String prompt, String defaultText)
    {
        String localInputText = defaultText;
        if (InputQuery(caption, prompt, ref localInputText))
        {
            return localInputText;
        }
        else
        {
            return "";
        }
    } 
```

`String`以**ref**参数的形式返回，`true`如果它们命中`OK`，或者`false`如果它们命中 ，则返回`Cancel`：

```
 public static Boolean InputQuery(String caption, String prompt, ref String value)
    {
        Form form;
        form = new Form();
        form.AutoScaleMode = AutoScaleMode.Font;
        form.Font = SystemFonts.IconTitleFont;

        SizeF dialogUnits;
        dialogUnits = form.AutoScaleDimensions;

        form.FormBorderStyle = FormBorderStyle.FixedDialog;
        form.MinimizeBox = false;
        form.MaximizeBox = false;
        form.Text = caption;

        form.ClientSize = new Size(
                    Toolkit.MulDiv(180, dialogUnits.Width, 4),
                    Toolkit.MulDiv(63, dialogUnits.Height, 8));

        form.StartPosition = FormStartPosition.CenterScreen;

        System.Windows.Forms.Label lblPrompt;
        lblPrompt = new System.Windows.Forms.Label();
        lblPrompt.Parent = form;
        lblPrompt.AutoSize = true;
        lblPrompt.Left = Toolkit.MulDiv(8, dialogUnits.Width, 4);
        lblPrompt.Top = Toolkit.MulDiv(8, dialogUnits.Height, 8);
        lblPrompt.Text = prompt;

        System.Windows.Forms.TextBox edInput;
        edInput = new System.Windows.Forms.TextBox();
        edInput.Parent = form;
        edInput.Left = lblPrompt.Left;
        edInput.Top = Toolkit.MulDiv(19, dialogUnits.Height, 8);
        edInput.Width = Toolkit.MulDiv(164, dialogUnits.Width, 4);
        edInput.Text = value;
        edInput.SelectAll();

        int buttonTop = Toolkit.MulDiv(41, dialogUnits.Height, 8);
        //Command buttons should be 50x14 dlus
        Size buttonSize = Toolkit.ScaleSize(new Size(50, 14), dialogUnits.Width / 4, dialogUnits.Height / 8);

        System.Windows.Forms.Button bbOk = new System.Windows.Forms.Button();
        bbOk.Parent = form;
        bbOk.Text = "OK";
        bbOk.DialogResult = DialogResult.OK;
        form.AcceptButton = bbOk;
        bbOk.Location = new Point(Toolkit.MulDiv(38, dialogUnits.Width, 4), buttonTop);
        bbOk.Size = buttonSize;

        System.Windows.Forms.Button bbCancel = new System.Windows.Forms.Button();
        bbCancel.Parent = form;
        bbCancel.Text = "Cancel";
        bbCancel.DialogResult = DialogResult.Cancel;
        form.CancelButton = bbCancel;
        bbCancel.Location = new Point(Toolkit.MulDiv(92, dialogUnits.Width, 4), buttonTop);
        bbCancel.Size = buttonSize;

        if (form.ShowDialog() == DialogResult.OK)
        {
            value = edInput.Text;
            return true;
        }
        else
        {
            return false;
        }
    }

    /// <summary>
    /// Multiplies two 32-bit values and then divides the 64-bit result by a 
    /// third 32-bit value. The final result is rounded to the nearest integer.
    /// </summary>
    public static int MulDiv(int nNumber, int nNumerator, int nDenominator)
    {
        return (int)Math.Round((float)nNumber * nNumerator / nDenominator);
    } 
```

> **注意**：任何代码都会发布到公共领域。无需归属。

* * *

## 回答 #7

> 赞同：4
> 
> 时间：2008-09-18T21:29:26.880

添加引用`Microsoft.VisualBasic`并使用此函数：

```
string response =  Microsoft.VisualBasic.Interaction.InputBox("What's 1+1?", "Title", "2", 0, 0); 
```

最后 2 个数字是显示输入对话框的 X/Y 位置。

* * *

## 回答 #8

> 赞同：3
> 
> 时间：2008-09-18T21:22:51.433

你是说输入框？只需查看 Microsoft.VisualBasic 命名空间。

C# 和 VB.Net 共享一个公共库。如果一种语言可以使用它，那么另一种也可以。

* * *

## 回答 #9

> 赞同：2
> 
> 时间：2014-09-18T12:26:33.380

不添加对 Microsoft.VisualBasic 的引用：

```
// "dynamic" requires reference to Microsoft.CSharp
Type tScriptControl = Type.GetTypeFromProgID("ScriptControl");
dynamic oSC = Activator.CreateInstance(tScriptControl);

oSC.Language = "VBScript";
string sFunc = @"Function InBox(prompt, title, default) 
InBox = InputBox(prompt, title, default)    
End Function
";
oSC.AddCode(sFunc);
dynamic Ret = oSC.Run("InBox", "メッセージ", "タイトル", "初期値"); 
```

有关详细信息，请参阅这些： JScript [Input中的](http://cwestblog.com/2012/03/10/jscript-using-inputbox-and-msgbox/)
[ScriptControl](http://www.geocities.jp/maru3128/SakuraMacro/usage/scriptcontrol.html)
[MsgBox和 JScript 中的 MsgBox](http://with-love-from-siberia.blogspot.ch/2009/12/msgbox-inputbox-in-jscript.html)

.NET 2.0：

```
string sFunc = @"Function InBox(prompt, title, default) 
InBox = InputBox(prompt, title, default)    
End Function
";

Type tScriptControl = Type.GetTypeFromProgID("ScriptControl");
object oSC = Activator.CreateInstance(tScriptControl);

// https://github.com/mono/mono/blob/master/mcs/class/corlib/System/MonoType.cs
// System.Reflection.PropertyInfo pi = tScriptControl.GetProperty("Language", System.Reflection.BindingFlags.Instance | System.Reflection.BindingFlags.Static | System.Reflection.BindingFlags.CreateInstance| System.Reflection.BindingFlags.Public | System.Reflection.BindingFlags.NonPublic | System.Reflection.BindingFlags.SetProperty | System.Reflection.BindingFlags.IgnoreCase);
// pi.SetValue(oSC, "VBScript", null);

tScriptControl.InvokeMember("Language", System.Reflection.BindingFlags.SetProperty, null, oSC, new object[] { "VBScript" });
tScriptControl.InvokeMember("AddCode", System.Reflection.BindingFlags.InvokeMethod, null, oSC, new object[] { sFunc });
object ret = tScriptControl.InvokeMember("Run", System.Reflection.BindingFlags.InvokeMethod, null, oSC, new object[] { "InBox", "メッセージ", "タイトル", "初期値" });
Console.WriteLine(ret); 
```

* * *

## 回答 #10

> 赞同：2
> 
> 时间：2015-09-16T18:25:58.210

我能够通过自己编写代码来实现这一点。我不喜欢扩展并依赖大型图书馆的一些基本的东西。

形式和设计师：

```
public partial class InputBox 
    : Form
{

    public String Input
    {
        get { return textInput.Text; }
    }

    public InputBox()
    {
        InitializeComponent();
    }

    private void button2_Click(object sender, EventArgs e)
    {
        DialogResult = System.Windows.Forms.DialogResult.OK;
    }

    private void button1_Click(object sender, EventArgs e)
    {
        DialogResult = System.Windows.Forms.DialogResult.Cancel;
    }

    private void InputBox_Load(object sender, EventArgs e)
    {
        this.ActiveControl = textInput;
    }

    public static DialogResult Show(String title, String message, String inputTitle, out String inputValue)
    {
        InputBox inputBox = null;
        DialogResult results = DialogResult.None;

        using (inputBox = new InputBox() { Text = title })
        {
            inputBox.labelMessage.Text = message;
            inputBox.splitContainer2.SplitterDistance = inputBox.labelMessage.Width;
            inputBox.labelInput.Text = inputTitle;
            inputBox.splitContainer1.SplitterDistance = inputBox.labelInput.Width;
            inputBox.Size = new Size(
                inputBox.Width,
                8 + inputBox.labelMessage.Height + inputBox.splitContainer2.SplitterWidth + inputBox.splitContainer1.Height + 8 + inputBox.button2.Height + 12 + (50));
            results = inputBox.ShowDialog();
            inputValue = inputBox.Input;
        }

        return results;
    }

    void labelInput_TextChanged(object sender, System.EventArgs e)
    {
    }

}

partial class InputBox
{
    /// <summary>
    /// Required designer variable.
    /// </summary>
    private System.ComponentModel.IContainer components = null;

    /// <summary>
    /// Clean up any resources being used.
    /// </summary>
    /// <param name="disposing">true if managed resources should be disposed; otherwise, false.</param>
    protected override void Dispose(bool disposing)
    {
        if (disposing && (components != null))
        {
            components.Dispose();
        }
        base.Dispose(disposing);
    }

    #region Windows Form Designer generated code

    /// <summary>
    /// Required method for Designer support - do not modify
    /// the contents of this method with the code editor.
    /// </summary>
    private void InitializeComponent()
    {
        this.labelMessage = new System.Windows.Forms.Label();
        this.button1 = new System.Windows.Forms.Button();
        this.button2 = new System.Windows.Forms.Button();
        this.labelInput = new System.Windows.Forms.Label();
        this.textInput = new System.Windows.Forms.TextBox();
        this.splitContainer1 = new System.Windows.Forms.SplitContainer();
        this.splitContainer2 = new System.Windows.Forms.SplitContainer();
        ((System.ComponentModel.ISupportInitialize)(this.splitContainer1)).BeginInit();
        this.splitContainer1.Panel1.SuspendLayout();
        this.splitContainer1.Panel2.SuspendLayout();
        this.splitContainer1.SuspendLayout();
        ((System.ComponentModel.ISupportInitialize)(this.splitContainer2)).BeginInit();
        this.splitContainer2.Panel1.SuspendLayout();
        this.splitContainer2.Panel2.SuspendLayout();
        this.splitContainer2.SuspendLayout();
        this.SuspendLayout();
        // 
        // labelMessage
        // 
        this.labelMessage.AutoSize = true;
        this.labelMessage.Location = new System.Drawing.Point(3, 0);
        this.labelMessage.MaximumSize = new System.Drawing.Size(379, 0);
        this.labelMessage.Name = "labelMessage";
        this.labelMessage.Size = new System.Drawing.Size(50, 13);
        this.labelMessage.TabIndex = 99;
        this.labelMessage.Text = "Message";
        // 
        // button1
        // 
        this.button1.Anchor = ((System.Windows.Forms.AnchorStyles)((System.Windows.Forms.AnchorStyles.Bottom | System.Windows.Forms.AnchorStyles.Right)));
        this.button1.Location = new System.Drawing.Point(316, 126);
        this.button1.Name = "button1";
        this.button1.Size = new System.Drawing.Size(75, 23);
        this.button1.TabIndex = 3;
        this.button1.Text = "Cancel";
        this.button1.UseVisualStyleBackColor = true;
        this.button1.Click += new System.EventHandler(this.button1_Click);
        // 
        // button2
        // 
        this.button2.Anchor = ((System.Windows.Forms.AnchorStyles)((System.Windows.Forms.AnchorStyles.Bottom | System.Windows.Forms.AnchorStyles.Right)));
        this.button2.Location = new System.Drawing.Point(235, 126);
        this.button2.Name = "button2";
        this.button2.Size = new System.Drawing.Size(75, 23);
        this.button2.TabIndex = 2;
        this.button2.Text = "OK";
        this.button2.UseVisualStyleBackColor = true;
        this.button2.Click += new System.EventHandler(this.button2_Click);
        // 
        // labelInput
        // 
        this.labelInput.AutoSize = true;
        this.labelInput.Location = new System.Drawing.Point(3, 6);
        this.labelInput.Name = "labelInput";
        this.labelInput.Size = new System.Drawing.Size(31, 13);
        this.labelInput.TabIndex = 99;
        this.labelInput.Text = "Input";
        this.labelInput.TextChanged += new System.EventHandler(this.labelInput_TextChanged);
        // 
        // textInput
        // 
        this.textInput.Anchor = ((System.Windows.Forms.AnchorStyles)(((System.Windows.Forms.AnchorStyles.Top | System.Windows.Forms.AnchorStyles.Left) 
        | System.Windows.Forms.AnchorStyles.Right)));
        this.textInput.Location = new System.Drawing.Point(3, 3);
        this.textInput.Name = "textInput";
        this.textInput.Size = new System.Drawing.Size(243, 20);
        this.textInput.TabIndex = 1;
        // 
        // splitContainer1
        // 
        this.splitContainer1.Dock = System.Windows.Forms.DockStyle.Fill;
        this.splitContainer1.FixedPanel = System.Windows.Forms.FixedPanel.Panel2;
        this.splitContainer1.IsSplitterFixed = true;
        this.splitContainer1.Location = new System.Drawing.Point(0, 0);
        this.splitContainer1.Name = "splitContainer1";
        // 
        // splitContainer1.Panel1
        // 
        this.splitContainer1.Panel1.Controls.Add(this.labelInput);
        // 
        // splitContainer1.Panel2
        // 
        this.splitContainer1.Panel2.Controls.Add(this.textInput);
        this.splitContainer1.Size = new System.Drawing.Size(379, 50);
        this.splitContainer1.SplitterDistance = 126;
        this.splitContainer1.TabIndex = 99;
        // 
        // splitContainer2
        // 
        this.splitContainer2.Anchor = ((System.Windows.Forms.AnchorStyles)((((System.Windows.Forms.AnchorStyles.Top | System.Windows.Forms.AnchorStyles.Bottom) 
        | System.Windows.Forms.AnchorStyles.Left) 
        | System.Windows.Forms.AnchorStyles.Right)));
        this.splitContainer2.IsSplitterFixed = true;
        this.splitContainer2.Location = new System.Drawing.Point(12, 12);
        this.splitContainer2.Name = "splitContainer2";
        this.splitContainer2.Orientation = System.Windows.Forms.Orientation.Horizontal;
        // 
        // splitContainer2.Panel1
        // 
        this.splitContainer2.Panel1.Controls.Add(this.labelMessage);
        // 
        // splitContainer2.Panel2
        // 
        this.splitContainer2.Panel2.Controls.Add(this.splitContainer1);
        this.splitContainer2.Size = new System.Drawing.Size(379, 108);
        this.splitContainer2.SplitterDistance = 54;
        this.splitContainer2.TabIndex = 99;
        // 
        // InputBox
        // 
        this.AutoScaleDimensions = new System.Drawing.SizeF(6F, 13F);
        this.AutoScaleMode = System.Windows.Forms.AutoScaleMode.Font;
        this.ClientSize = new System.Drawing.Size(403, 161);
        this.Controls.Add(this.splitContainer2);
        this.Controls.Add(this.button2);
        this.Controls.Add(this.button1);
        this.FormBorderStyle = System.Windows.Forms.FormBorderStyle.FixedDialog;
        this.MaximizeBox = false;
        this.MinimizeBox = false;
        this.Name = "InputBox";
        this.StartPosition = System.Windows.Forms.FormStartPosition.CenterScreen;
        this.Text = "Title";
        this.TopMost = true;
        this.Load += new System.EventHandler(this.InputBox_Load);
        this.splitContainer1.Panel1.ResumeLayout(false);
        this.splitContainer1.Panel1.PerformLayout();
        this.splitContainer1.Panel2.ResumeLayout(false);
        this.splitContainer1.Panel2.PerformLayout();
        ((System.ComponentModel.ISupportInitialize)(this.splitContainer1)).EndInit();
        this.splitContainer1.ResumeLayout(false);
        this.splitContainer2.Panel1.ResumeLayout(false);
        this.splitContainer2.Panel1.PerformLayout();
        this.splitContainer2.Panel2.ResumeLayout(false);
        ((System.ComponentModel.ISupportInitialize)(this.splitContainer2)).EndInit();
        this.splitContainer2.ResumeLayout(false);
        this.ResumeLayout(false);

    }

    #endregion

    private System.Windows.Forms.Label labelMessage;
    private System.Windows.Forms.Button button1;
    private System.Windows.Forms.Button button2;
    private System.Windows.Forms.Label labelInput;
    private System.Windows.Forms.TextBox textInput;
    private System.Windows.Forms.SplitContainer splitContainer1;
    private System.Windows.Forms.SplitContainer splitContainer2;
} 
```

用法：

```
String output = "";

result = System.Windows.Forms.DialogResult.None;

result = InputBox.Show(
    "Input Required",
    "Please enter the value (if available) below.",
    "Value",
    out output);

if (result != System.Windows.Forms.DialogResult.OK)
{
    return;
} 
```

请注意，这会根据您要求显示的文本量显示一些自动调整大小以使其保持美观。我也知道它缺乏花里胡哨，但对于那些面临同样困境的人来说，这是向前迈出的坚实一步。

* * *

## 回答 #11

> 赞同：-3
> 
> 时间：2008-09-18T21:22:29.390

没有这样的东西：我建议自己编写它并在需要时使用它。

# winforms - 如何在 WinForms TraceListener 中获取当前异常

> ID：97104
> 
> 赞同：1
> 
> 时间：2008-09-18T21:20:44.513
> 
> 标签：winforms, exception

我正在修改现有的 WinForms 应用程序，该应用程序使用自定义 TraceListener 进行设置，该程序记录应用程序中发生的任何未处理的错误。在我看来， TraceListener 获得了异常的消息部分（这是记录的内容），而不是其他异常信息。我希望能够获取异常对象（获取堆栈跟踪和其他信息）。

在我更熟悉的 ASP.NET 中，我会调用 Server.GetLastError 来获取最新的异常，但当然这在 WinForms 中不起作用。

如何获取最新的异常？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2008-09-18T23:59:29.343

我假设您已经设置了一个事件处理程序来捕获未处理的域异常和线程异常。在该委托中，您可能会调用跟踪侦听器来记录异常。只需发出额外的调用来设置异常上下文。

```
[STAThread]
private static void Main()
{
    // Add the event handler for handling UI thread exceptions
    Application.ThreadException += new ThreadExceptionEventHandler(Application_ThreadException);
    // Add the event handler for handling non-UI thread exceptions
    AppDomain.CurrentDomain.UnhandledException += new UnhandledExceptionEventHandler(CurrentDomain_UnhandledException);
    ...
    Application.Run(new Form1());
}

private static void CurrentDomain_UnhandledException(object sender, UnhandledExceptionEventArgs e)
{
    MyTraceListener.Instance.ExceptionContext = e;
    Trace.WriteLine(e.ToString());
}

private static void Application_ThreadException(object sender, ThreadExceptionEventArgs e)
{
    // similar to above CurrentDomain_UnhandledException
}

...

Trace.Listeners.Add(MyTraceListener.Instance);

...

class MyTraceListener : System.Diagnostics.TraceListener
{
    ...
    public Object ExceptionContext { get; set; }
    public static MyTraceListener Instance { get { ... } }
} 
```

在 MyTraceListener 中的 Write 方法上，您可以获得异常上下文并使用它。请记住同步异常上下文。

# regex - 用于解析 LDAP dn 的正则表达式

> ID：97113
> 
> 赞同：4
> 
> 时间：2008-09-18T21:21:50.313
> 
> 标签：regex

我有以下字符串：

```
cn=abcd,cn=groups,dc=domain,dc=com 
```

可以在这里使用正则表达式来提取第一个之后`cn=`和之前的字符串`,`吗？在上面的例子中，答案应该是`abcd`。

* * *

## 回答 #1

> 赞同：12
> 
> 时间：2008-09-18T21:23:33.553

```
 /cn=([^,]+),/ 
```

大多数语言会将匹配项提取为 $1 或 match[1]

如果你因为某种原因不能使用下标，

```
$x =~ s/^cn=//
$x =~ s/,.*$// 
```

这是一种分两步完成的方法。

如果您使用 sed 从日志中解析它

```
sed -n -r '/cn=/s/^cn=([^,]+),.*$/\1/p'    < logfile > dumpfile 
```

会给你你想要的。（添加到仅打印匹配行的额外命令）

* * *

## 回答 #2

> 赞同：7
> 
> 时间：2008-09-18T21:23:26.270

```
/^cn=([^,]+),/
```

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2008-09-18T21:25:11.803

另外，寻找一个预先构建的 LDAP 解析器。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2008-09-18T21:23:18.423

是的，使用 perl/java 语法`cn=([^,]*),`。然后你会得到第一组。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2012-07-20T19:23:24.947

我必须在 PHP 中解决这个问题。

由于 LDAP 字符串有时可能很长并且有很多属性，所以我想贡献一下我在项目中如何使用它。

我想使用：

```
CN=username,OU=UNITNAME,OU=Region,OU=Country,DC=subdomain,DC=domain,DC=com 
```

并将其变成：

```
array (
    [CN] => array( username )
    [OU] => array( UNITNAME, Region, Country )
    [DC] => array ( subdomain, domain, com )
) 
```

这是我构建方法的方式。

```
/**
 * Read a LDAP DN, and return what is needed
 *
 * Takes care of the character escape and unescape
 *
 * Using:
 * CN=username,OU=UNITNAME,OU=Region,OU=Country,DC=subdomain,DC=domain,DC=com
 *
 * Would normally return:
 * Array (
 *     [count] => 9
 *     [0] => CN=username
 *     [1] => OU=UNITNAME
 *     [2] => OU=Region
 *     [5] => OU=Country
 *     [6] => DC=subdomain
 *     [7] => DC=domain
 *     [8] => DC=com
 * )
 *
 * Returns instead a manageable array:
 * array (
 *     [CN] => array( username )
 *     [OU] => array( UNITNAME, Region, Country )
 *     [DC] => array ( subdomain, domain, com )
 * )
 *
 *
 * @author gabriel at hrz dot uni-marburg dot de 05-Aug-2003 02:27 (part of the character replacement)
 * @author Renoir Boulanger
 * 
 * @param  string $dn          The DN
 * @return array
 */
function parseLdapDn($dn)
{
    $parsr=ldap_explode_dn($dn, 0);
    //$parsr[] = 'EE=Sôme Krazï string';
    //$parsr[] = 'AndBogusOne';
    $out = array();
    foreach($parsr as $key=>$value){
        if(FALSE !== strstr($value, '=')){
            list($prefix,$data) = explode("=",$value);
            $data=preg_replace("/\\\([0-9A-Fa-f]{2})/e", "''.chr(hexdec('\\1')).''", $data);
            if(isset($current_prefix) && $prefix == $current_prefix){
                $out[$prefix][] = $data;
            } else {
                $current_prefix = $prefix;
                $out[$prefix][] = $data;
            }
        }
    }
    return $out;
} 
```

# unit-testing - 条件编译是单元测试的有效模拟/存根策略吗？

> ID：97114
> 
> 赞同：4
> 
> 时间：2008-09-18T21:21:55.570
> 
> 标签：unit-testing, stub, conditional-compilation

在最近关于存根的问题中，许多答案建议使用 C# 接口或委托来实现存根，但[一个答案](https://stackoverflow.com/questions/43711/whats-a-good-way-to-overwrite-datetimenow-during-testing#43718)建议使用条件编译，在生产代码中保留静态绑定。这个答案在阅读时被修改为 -2，所以至少有 2 人真的认为这是一个*错误*的答案。原因可能是误用 DEBUG，或者可能是使用固定值而不是更广泛的验证。但我不禁想知道：

使用条件编译是实现单元测试存根的一种不合适的技术吗？有时？总是？

谢谢。

**编辑添加：** 我想添加一个示例作为实验：

```
class Foo {
    public Foo() { .. }
    private DateTime Now { 
      get {
#if UNITTEST_Foo
        return Stub_DateTime.Now;
#else
        return DateTime.Now;
#endif
      }
    }
    // .. rest of Foo members
} 
```

比较

```
interface IDateTimeStrategy { 
    DateTime Now { get; }
}
class ProductionDateTimeStrategy : IDateTimeStrategy {
  public DateTime Now { get { return DateTime.Now; } }
}
class Foo {
    public Foo() : Foo(new ProductionDateTimeStrategy()) {}
    public Foo(IDateTimeStrategy s) { datetimeStrategy = s; .. }
    private IDateTime_Strategy datetimeStrategy;
    private DateTime Now { get { return datetimeStrategy.Now; } }
} 
```

这允许通过 C# 接口对“DateTime.Now”的传出依赖项进行存根。但是，我们现在添加了一个动态调度调用，其中静态就足够了，即使在生产版本中对象也更大，并且我们为 Foo 的构造函数添加了一个新的失败路径（分配可能会失败）。

我在这里什么都不担心吗？感谢您迄今为止的反馈！

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2008-09-18T21:44:19.417

尝试将生产代码与测试代码分开。维护不同的文件夹层次结构..不同的解决方案/项目。

**除非**..您身处遗留 C++ 代码的世界。一切都会发生……如果条件块可以帮助您获得一些可测试的代码并且您会看到好处……请务必这样做。但尽量不要让它变得比初始状态更混乱。清楚地注释和划分条件块。谨慎行事。这是在测试工具下获取遗留代码的有效技术。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2008-09-18T21:27:15.933

我认为它降低了人们审查代码的清晰度。您不必记住特定代码周围有一个条件标记来理解上下文。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2008-09-18T21:34:16.023

不，这太可怕了。它将测试泄漏到您的生产代码中（即使它已关闭）

坏坏。

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2008-09-18T21:36:26.330

测试代码应该是显而易见的，而不是在与测试代码相同的块中相互混合。

这与您不应该写的原因几乎相同

```
if (globals.isTest) 
```

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2008-09-19T14:48:57.387

我想到了另一个可怕的原因：

很多时候你模拟/存根某些东西，你希望它的方法根据你正在测试的内容返回不同的结果。这要么排除了这一点，要么让它变得尴尬。

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2008-09-18T21:36:12.290

当您在大型代码库中重构可测试性时，它可能作为一种依赖工具很有用。我可以看到您如何使用这些技术来实现较小的更改并避免“大爆炸”重构。但是我会担心过于依赖这种技术，并会尝试确保这些技巧不会在代码库中存在太久，否则您可能会使应用程序代码变得非常复杂且难以遵循。

# java - 使用哪个软件来持续集成 Java Web 项目

> ID：97123
> 
> 赞同：2
> 
> 时间：2008-09-18T21:23:08.750
> 
> 标签：java, continuous-integration

我们正处于一个新网络项目的早期阶段。随着时间的推移，该项目将变得越来越复杂。从一开始，我们将使用 JUnit 进行单元和集成测试，使用 HtmlUnit 进行系统测试。如果它们被证明对我们有价值，我们也可能会在构建过程中添加一些静态代码分析工具。

如果您正在或曾经参与过使用持续集成的项目。您使用过/使用过哪些软件，您认为它获得了回报吗？对于 Java Web 项目的持续集成，您会推荐哪种软件？

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2008-09-18T21:23:53.133

哈德逊（最好的）。[哈德逊网站](http://hudson-ci.org/)

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2008-09-18T21:26:29.663

JetBrains TeamCity Pro。 [http://www.jetbrains.com/teamcity/index.html](http://www.jetbrains.com/teamcity/index.html)

专业版不需要任何许可证密钥。如果未在程序中输入许可证密钥，TeamCity 将自动与 Professional Edition Server 一起运行。单个 Professional Edition Server 安装授予设置权限：

3 免费构建代理 20 用户帐户 20 构建配置

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2008-09-18T21:41:50.890

同时使用[CruiseControl](http://cruisecontrol.sourceforge.net/)和[Hudson](http://hudson-ci.org/)后，我可以推荐 Hudson 作为两者中更容易配置的（通过 Web GUI 轻松完成，尽管也支持直接配置文件编辑）。

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2008-09-18T21:25:25.983

Hudson 很棒而且免费： [http ://hudson.dev.java.net/](http://hudson.dev.java.net/)

竹子很棒，但要花 $$ [http://www.atlassian.com/software/bamboo/](http://www.atlassian.com/software/bamboo/)

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2010-01-14T11:59:51.130

我对[Atlassian 的 Bamboo](http://www.atlassian.com/software/bamboo/)非常满意。尽管它是商业的，但对于 10 个用户，Starter Pack 许可证只需 10 美元。它有很好的文档记录，易于设置且灵活。

* * *

## 回答 #6

> 赞同：-1
> 
> 时间：2008-09-18T21:24:16.063

CruiseControl 一旦配置好就可以正常工作。

[http://cruisecontrol.sourceforge.net/](http://cruisecontrol.sourceforge.net/)

* * *

## 回答 #7

> 赞同：-1
> 
> 时间：2008-09-18T21:32:07.793

[巡航控制](http://cruisecontrol.sourceforge.net/)

> CruiseControl 既是一个持续集成工具，也是一个用于创建自定义持续构建过程的可扩展框架。它包括数十个插件，用于各种源代码控制、构建技术和通知方案，包括电子邮件和即时消息。Web 界面提供当前和以前构建的详细信息。标准 CruiseControl 发行版通过丰富的 3rd 方工具选择得到增强。

* * *

## 回答 #8

> 赞同：-1
> 
> 时间：2008-09-18T21:36:25.800

我将[CruiseControl](http://cruisecontrol.sourceforge.net/)用于 Java 项目，将[CruiseControl.NET](http://ccnet.thoughtworks.com/)用于 .NET 项目，两者都运行良好。

我为一个项目设置了 CruiseControl，该项目已经与数十名开发人员一起运行了 4 年，虽然在此期间对配置进行了多次调整，但它运行良好。（我不再积极支持该项目，但我仍然与支持该项目的人一起工作。）

在我目前的职位上，CruiseControl.NET 被用于支持多个 .Net 项目，并且已经使用了 2 年多。

# c# - 如何在 .NET 2.0 中为 asp:DataList 实现分页？

> ID：97124
> 
> 赞同：2
> 
> 时间：2008-09-18T21:23:15.490
> 
> 标签：c#, asp.net, .net-2.0, paging, datalist

我花了几个小时研究这个问题，只是想分享一个解决方案，以防您需要在 .NET 2.0 中为 asp:DataList 实现分页。

**我的具体要求是有“上一个”和“下一个”链接和页码链接。**

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2008-09-18T23:24:27.007

我将其从问题中移出，因此它不会显示为“未回答”...

[本文中的 PagedDataSource 解决方案](http://web.archive.org/web/20180402032034/http://aspdotnetcodes.com:80/DataList_Dynamic_Paging_PagedDataSource.aspx)是解决此问题的最优雅和最简单的解决方案。

如果您有更好的解决方案 - 请在此处发布。

**ps 我与该网站没有任何关联。**

# linux - 如何在 *nix 中登录时运行脚本？

> ID：97137
> 
> 赞同：72
> 
> 时间：2008-09-18T21:24:13.880
> 
> 标签：linux, bash, macos, unix, shell

我知道我曾经知道如何做到这一点，但是......你如何在 unix 登录时运行脚本（bash 可以）？

* * *

## 回答 #1

> 赞同：114
> 
> 时间：2008-09-18T21:29:02.403

来自[维基百科 Bash](http://en.wikipedia.org/wiki/Bash_%28Unix_shell%29)

> 当 Bash 启动时，它会执行各种不同脚本中的命令。
> 
> 当 Bash 作为交互式登录 shell 调用时，它首先从文件 /etc/profile 中读取并执行命令（如果该文件存在）。读取该文件后，它会按顺序查找 ~/.bash_profile、~/.bash_login 和 ~/.profile，然后从第一个存在且可读的文件中读取并执行命令。
> 
> 当登录 shell 退出时，Bash 从文件 ~/.bash_logout（如果存在）读取并执行命令。
> 
> 当一个不是登录 shell 的交互式 shell 启动时，Bash 从 ~/.bashrc 读取并执行命令，如果该文件存在的话。这可以通过使用 --norc 选项来禁止。--rcfile 文件选项将强制 Bash 从文件而不是 ~/.bashrc 读取和执行命令。

* * *

## 回答 #2

> 赞同：30
> 
> 时间：2008-09-18T22:10:42.083

在登录时，大多数 shell 都会执行一个登录脚本，您可以使用它来执行您的自定义脚本。当然，shell 执行的登录脚本取决于 shell：

*   bash：.bash_profile、.bash_login、.profile（为了向后兼容）
*   sh: .profile
*   tcsh 和 csh：.login
*   zsh: .zshrc

您可能可以通过以下方式找出您正在使用的外壳

```
echo $SHELL 
```

从提示。

对于“登录”的更广泛的定义，了解在大多数发行版上启动 X 时，您的 .xsessionrc 将在您的 X 会话启动时执行是很有用的。

* * *

## 回答 #3

> 赞同：10
> 
> 时间：2008-09-18T21:33:54.480

使用 Bash 时，第一个`~/.bash_profile`,`~/.bash_login`和`~/.profile`将为交互式登录 shell 运行。我相信`~/.profile`除了 Bash 之外，它通常由 Unix shell 运行。Bash 将`~/.bashrc`为非登录交互式 shell 运行。

我通常将我想要始终设置的所有内容放入其中`.bashrc`，然后从中运行它`.bash_profile`，我还设置了一些仅在我登录时才应该运行的东西，例如设置`ssh-agent`或运行`screen`。

* * *

## 回答 #4

> 赞同：5
> 
> 时间：2008-09-18T21:34:55.320

如果您希望运行*一个*脚本并且*只*运行一个脚本，您可以将其设为用户默认 shell。

```
echo "/usr/bin/uptime" >> /etc/shells
vim /etc/passwd  
  * username:x:uid:grp:message:homedir:/usr/bin/uptime 
```

可能会产生有趣的效果:)（它不安全，所以不要太相信它。没有什么比将默认外壳设置为擦除驱动器的脚本更好的了。...虽然，..我可以想象这样的场景可能非常有用）

* * *

## 回答 #5

> 赞同：3
> 
> 时间：2008-09-18T21:25:50.507

将其放在您的[bash 配置文件](http://www.linuxfromscratch.org/blfs/view/stable/postlfs/profile.html)中：

```
~/.bash_profile 
```

* * *

## 回答 #6

> 赞同：3
> 
> 时间：2008-09-18T21:26:44.217

如果你在 OSX 上，那么它是`~/.profile`

* * *

## 回答 #7

> 赞同：3
> 
> 时间：2008-09-19T14:06:32.807

`Launchd`是 OS X 中的首选方式。

如果您希望它在登录时运行，请将其放入`~/Library/LaunchAgents`

开始`launchd`项目

```
launchctl load /Library/LaunchDaemons/com.bob.plist 
```

停止项目

```
launchctl unload /Library/LaunchDaemons/com.bob.plist 
```

例子`com.bob.plist`

```
<?xml version="1.0" encoding="UTF-8"?>
<!DOCTYPE plist PUBLIC "-//Apple//DTD PLIST 1.0//EN" "http://www.apple.com/DTDs/PropertyList-1.0.dtd">
<plist version="1.0">
<dict>
<key>Label</key>
<string>com.bob</string>
<key>RunAtLoad</key>
<true/>
<key>ProgramArguments</key>
<array>
<string>/usr/bin/java</string>
<string>-jar</string>
<string>/Users/user/program.jar</string>
</array>
</dict>
</plist> 
```

* * *

## 回答 #8

> 赞同：3
> 
> 时间：2015-04-29T11:27:23.343

我对这个问题感到沮丧好几天。在 ubuntu 上没有任何效果。如果我将调用放在 /etc/profile 中，它在登录尝试时都会崩溃。我不能使用“启动应用程序”，因为那不是我想要的。这只会为该当前用户设置脚本。

最后我找到了这篇小文章：[http ://standards.freedesktop.org/autostart-spec/autostart-spec-0.5.html](http://standards.freedesktop.org/autostart-spec/autostart-spec-0.5.html)

解决方案是：

1.  找出 $XDG_CONFIG_DIRS 路径：

    回声 $XDG_CONFIG_DIRS

2.  把你的脚本放在那个目录

* * *

## 回答 #9

> 赞同：2
> 
> 时间：2008-09-18T21:44:24.830

添加一个`/etc/profile`执行脚本的条目。这将在每次登录期间运行。如果您只是为自己的帐户执行此操作，请使用您的登录脚本之一（例如`.bash_profile`）来运行它。

* * *

## 回答 #10

> 赞同：2
> 
> 时间：2008-09-19T00:24:46.457

在本地系统的 bash 手册页中搜索 ^INVOCATION 以获取有关在启动时将读取哪个文件的信息。

```
man bash
/^INVOCATION 
```

同样在文件部分，

```
 ~/.bash_profile
          The personal initialization file, executed for login shells
   ~/.bashrc
          The individual per-interactive-shell startup file 
```

将您的脚本添加到正确的文件中。确保脚本在 $PATH 中，或使用脚本文件的绝对路径。

* * *

## 回答 #11

> 赞同：1
> 
> 时间：2008-09-18T21:24:53.130

该脚本`~/.bash_profile`在登录时运行。

# ruby-on-rails - Ruby on Rails：没有要加载的文件——RedHat Linux Enterprise 上的 openssl

> ID：97142
> 
> 赞同：12
> 
> 时间：2008-09-18T21:24:28.030
> 
> 标签：ruby-on-rails, ruby, openssl, rake, redhat

我正在尝试执行“rake db:migrate”并收到错误消息“没有要加载的此类文件--openssl”。'openssl' 和 'openssl-devel' 软件包都已安装。Debian 或 Ubuntu 上的其他人似乎可以通过安装 RedHat 不可用的“libopenssl-ruby”来摆脱这种情况。有没有人遇到这个并有解决方案？

* * *

## 回答 #1

> 赞同：13
> 
> 时间：2008-11-16T16:38:26.767

升级到 8.10 后，我在 Ubuntu 上遇到了这个问题。Ubuntu的解决方案是

`sudo apt-get install libopenssl-ruby`

* * *

## 回答 #2

> 赞同：10
> 
> 时间：2008-09-18T21:33:19.723

看来你需要制作 ruby​​ 头文件

进入 openssl 目录并：

```
ruby extconf.rb
cd ../..
make
make install 
```

看[这里](http://www.ruby-forum.com/topic/90083)

* * *

## 回答 #3

> 赞同：8
> 
> 时间：2010-11-22T07:38:04.170

如果您使用 RVM 来管理您的红宝石，请按照此处的说明进行操作：

[http://rvm.io/packages/openssl/](http://rvm.io/packages/openssl/)

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2008-09-18T21:32:08.823

您可能缺少一颗宝石。你能提供堆栈跟踪和它起源的代码行吗？

重新运行 rake with`--trace`以打印堆栈跟踪。

编辑：您还运行什么版本的 Ruby？openssl.rb 在我的 1.8.6 安装中

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2013-03-03T12:38:42.710

我遇到过同样的问题。我尝试进入 openssl 文件夹并运行 make 等，但它找不到库 lcrypto。我通过运行 ruby​​ 1.9.3-p327 解决了这个问题。

希望这可以帮助！

# spring - 国际化网站

> ID：97173
> 
> 赞同：-1
> 
> 时间：2008-09-18T21:27:14.373
> 
> 标签：spring, internationalization, freemarker, sitemesh

我正在使用 freemarker、SiteMesh 和 Spring 框架。对于页面，我使用 ${requestContext.getMessage()} 从 message.properties 获取消息。但是对于装饰者来说，这是行不通的。我应该怎么做才能让sitemesh的国际化工作？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2008-09-19T20:13:25.717

您必须使用***fmt***标签库。

首先，在装饰器的第一行添加 sitemesh 和 fmt 的 taglib。

```
<%@ taglib prefix="decorator" uri="http://www.opensymphony.com/sitemesh/decorator"%>
<%@ taglib prefix="page" uri="http://www.opensymphony.com/sitemesh/page"%>
<%@ taglib prefix="c" uri="http://java.sun.com/jstl/core"%>
<%@ taglib prefix="fmt" uri="http://java.sun.com/jstl/fmt"%>
<fmt:setBundle basename="messages" /> 
```

在我的示例中，i18n 文件是 messages.properties。然后你需要使用 fmt 标签来使用这些消息。

```
<fmt:message key="key_of_message" /> 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2008-10-08T10:24:03.433

如果您更喜欢模板和 freemarker servlet，则可以在模板中输入以下内容：

```
<#assign fmt=JspTaglibs["http://java.sun.com/jstl/fmt"]>
<@fmt.message key="webapp.name" /> 
```

在你的`web.xml`：

```
<context-param>
    <param-name>javax.servlet.jsp.jstl.fmt.localizationContext</param-name>
    <param-value>messages</param-value>
</context-param> 
```

# smtp - SMTP 客户端是否必须在 HELO 中向 MTA 提供全局可解析的主机名？

> ID：97179
> 
> 赞同：3
> 
> 时间：2008-09-18T21:28:03.137
> 
> 标签：smtp, postfix-mta, email-spam

简而言之：我正在试图弄清楚是否应该告诉朋友雇主的邮件管理员是否应该修复他们的邮件配置，或者我是否应该修改自己的政策以在我接受的内容上更加自由，或者两者都不要。

一位朋友抱怨无法访问我的邮件服务器上的任何内容。我对其进行了深入研究，似乎他的邮件服务器在连接到我的时提供的主机名位于 *.local 空间中的某个位置，这意味着它无法全局解析。

他们被拒绝了“Helo command denied: Host not found;” 通过我的后缀邮件服务器。我可能对后缀中的 UCE 检查很严格，所以我将他们的（在我看来，配置错误的）服务器列入白名单，但现在我试图弄清楚它们实际上配置错误的程度，而不是我是否过于苛刻在我接受的。

然后我检查了 RFC - RFC 821 说“HELO 接收者可以验证 HELO 参数是否真的对应于发送者的 IP 地址。但是，接收者不得拒绝接受消息，即使发送者的 HELO 命令验证失败。” 这表明我实际上是违反 RFC 的人。

我可以指出，RFC 821 的这一部分是否曾经被未来的 RFC 所取代？或者邮件服务器必须接受带有假 HELO 的邮件吗？是否有任何受人尊敬的权威机构我可以指出 HELO 主机名应该是有效的，作为联系他们的邮件管理员的参考？

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2008-09-18T21:44:57.497

严格来说，你们*都*违反了 RFC。

需要注意的部分是：

> sender-SMTP 必须确保 HELO 命令中的参数是客户端主机的有效主体主机域名。

和

> HELO 接收者可以验证 HELO 参数是否真的对应于发送者的 IP 地址。但是，即使发送者的 HELO 命令验证失败，接收者也不能拒绝接受消息。

由于垃圾邮件的盛行，如今的邮件服务器比 RFC 所说的*要*严格得多，并且通常会发现各种专有检查和拒绝原因。

但是，他们的 HELO 字符串中的主机名不正确，根本没有给自己带来任何好处。尽管您的邮件服务器可能工作得很好，但他们的邮件服务器可能会在发送和接收来自许多系统的电子邮件时遇到问题。

我会让他们知道。如果只是因为他们的错误配置，他们可能没有收到他们应该收到的所有电子邮件。

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2008-09-18T21:38:15.483

正如您所引用的，RFC 822 标准将行为留给 MTA。如今，如果名称无法解析，则在 HELO 阶段拒绝连接（并将其与 spamhaus 等黑名单进行检查）是 MTA 跟上僵尸网络产生的大量垃圾邮件的唯一方法。

所以没有标准说你必须，但如果你不这样做，你的电子邮件就不会走得很远。

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2008-09-18T21:40:04.187

SMTP RFC 不需要它，但许多流行的系统会拒绝带有虚假 HELO 的邮件。请注意，RFC 1033 和 RFC 1912 都要求所有 Internet 可访问的主机具有有效名称；只需在 HELO 中列出该名称即可解决许多问题。不幸的是，一些垃圾邮件过滤器也会拒绝来自主机名的邮件，这些主机名包含暗示它们位于动态地址池中的字符串（例如，“动态”、“dsl”或许多 ISP 常见的以破折号分隔的 IP 地址）。

如果您的朋友无法控制他们的反向 DNS，一个选择是使用合适的机器作为发送邮件的智能主机；例如他们的 ISP 的邮件服务器。

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2008-09-18T21:31:55.687

是的，他们应该。许多其他系统，包括雅虎，将拒绝来自无法反向映射到连接 IP 或无法解析的主机名的邮件。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2008-09-18T21:40:14.123

嗯，我不同意。如果愿意，它可以在 EHLO/HELO 内提供总垃圾。只要它说什么，*只要*我能解析它来自的 IP 地址，我就很高兴。

EHLO 内部通常是一个简短的主机名，而不是 FQDN。

# monitoring - 是否有像 xentop 这样的监控工具可以跟踪历史数据？

> ID：97188
> 
> 赞同：0
> 
> 时间：2008-09-18T21:29:05.273
> 
> 标签：monitoring, system-administration, xen

我想查看访客 cpu/内存/IO 使用的历史数据，而不仅仅是当前使用情况。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-10-06T16:30:03.110

我编写了一个 perl 程序来执行此操作。查看[链接文本](http://phplens.com/phpeverywhere/?q=node/view/266 "xenstat.pl 软件") 它还支持登录到 URL。

特征：

```
perl xenstat.pl          -- generate cpu stats every 5 secs
perl xenstat.pl 10       -- generate cpu stats every 10 secs
perl xenstat.pl 5 2      -- generate cpu stats every 5 secs, 2 samples

perl xenstat.pl d 3      -- generate disk stats every 3 secs
perl xenstat.pl n 3      -- generate network stats every 3 secs
perl xenstat.pl a 5      -- generate cpu avail (e.g. cpu idle) stats every 5 secs

perl xenstat.pl 3 1 http://server/log.php    -- gather 3 secs cpu stats and send to URL
perl xenstat.pl d 4 1 http://server/log.php    -- gather 4 secs disk stats and send to URL
perl xenstat.pl n 5 1 http://server/log.php    -- gather 5 secs network stats and send to URL 
```

样本输出：

```
[server~]# xenstat 5 
cpus=2
       40_falcon   2.67%    2.51 cpu hrs  in 1.96 days ( 2 vcpu,  2048 M)
       52_python   0.24%  747.57 cpu secs in 1.79 days ( 2 vcpu,  1500 M)
     54_garuda_0   0.44% 2252.32 cpu secs in 2.96 days ( 2 vcpu,   750 M)
           Dom-0   2.24%    9.24 cpu hrs  in 8.59 days ( 2 vcpu,   564 M)

                    40_falc 52_pyth 54_garu   Dom-0    Idle
2009-10-02 19:31:20     0.1     0.1    82.5    17.3     0.0 *****
2009-10-02 19:31:25     0.1     0.1    64.0     9.3    26.5 ****
2009-10-02 19:31:30     0.1     0.0    50.0    49.9     0.0 ***** 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2008-09-18T21:37:42.413

[Xentop](http://linux.die.net/man/1/xentop)是一个监控在 Xen 下运行的域 (VM) 的工具。VMware 的 ESX 有一个类似的工具（我相信它叫做 esxtop）。

问题是您想查看 Xen 系统上域的历史 CPU/Mem 使用情况，对吗？

与所有虚拟化层一样，与管理员相关的信息有两种视图：域对主机施加的负担以及域认为的进程负载。如果域认为它的资源不足但主机没有，则很容易从主机向域分配更多资源。如果主机资源不足，您将需要优化或关闭某些域。

不幸的是，我不知道有任何免费工具可以做到这一点。XenSource 提供了丰富的 XML-RPC API 来控制和监视他们的系统。您可以轻松地从中构建一些东西。

如果您只关心其自身资源的域视图，我相信已经有大量可用的监控工具可以满足您的需求。

作为免责声明，我应该提到我工作的公司 Leostream 构建虚拟化管理软件。不幸的是，它并没有真正进行利用率监控。

希望这可以帮助。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2008-09-18T21:37:42.943

试试[Nagios](http://www.nagios.org/)或[Munin](http://www.howtoforge.com/server_monitoring_monit_munin)。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2008-09-19T02:51:58.570

Nagios 和 Munin 似乎都有插件/支持 Xen 数据收集。

[Nagios 的 Xen 虚拟机监视器插件](http://www.novell.com/coolsolutions/feature/19490.html)

[munin 插件](http://munin.projects.linpro.no/wiki/PluginCat#Xen)

# c# - 我可以通过反射/诊断从方法中获取调用实例吗？

> ID：97193
> 
> 赞同：12
> 
> 时间：2008-09-18T21:29:45.287
> 
> 标签：c#, .net, reflection

有没有办法通过 System.Reflection、System.Diagnostics 或其他方法来获取对调用静态方法的实际实例的引用而不将其传递给方法本身？

例如，沿着这些思路

```
class A
{
    public void DoSomething()
    {
        StaticClass.ExecuteMethod();
    }
}

class B
{
    public void DoSomething()
    {
        SomeOtherClass.ExecuteMethod();
    }
}
public class SomeOtherClass
{
    public static void ExecuteMethod()
    {
        // Returns an instance of A if called from class A
        // or an instance of B if called from class B.
        object caller = getCallingInstance();
    }
} 
```

我可以使用[System.Diagnostics.StackTrace.GetFrames](http://msdn.microsoft.com/en-us/library/system.diagnostics.stacktrace.getframes.aspx)获取类型，但是有没有办法获取对实际实例的引用？

我知道反射和性能的问题，以及静态到静态调用的问题，而且这通常，甚至可能几乎是普遍的，不是解决这个问题的正确方法。这个问题的部分原因是我很好奇它是否可行。我们目前正在传递实例。

```
ExecuteMethod(instance) 
```

我只是想知道这是否可能并且仍然能够访问该实例。

```
ExecuteMethod() 
```

* * *

@Steve Cooper：我没有考虑过扩展方法。一些变化可能会起作用。

* * *

## 回答 #1

> 赞同：10
> 
> 时间：2008-09-18T21:44:04.020

考虑使该方法成为扩展方法。将其定义为：

```
public static StaticExecute(this object instance)
{
    // Reference to 'instance'
} 
```

它被称为：

```
this.StaticExecute(); 
```

我想不出一种直接做你想做的事情的方法，但我只能建议，如果你找到了一些东西，你要注意静态方法，它不会有一个，匿名方法，它会有实例自动生成的类，这会有点奇怪。

我确实想知道您是否应该将调用对象作为适当的参数传入。毕竟，`static`a 暗示了这个方法除了输入参数之外不依赖任何东西。另请注意，此方法可能难以测试，因为您编写的任何测试代码都不会具有与正在运行的系统相同的调用对象。

* * *

## 回答 #2

> 赞同：6
> 
> 时间：2008-09-18T21:40:08.647

我不相信你可以。甚至 StackTrace 和 StackFrame 类也只是为您提供命名信息，而不是对实例的访问。

我不确定你为什么要这样做，但知道即使你能做到，它也可能会很慢。

更好的解决方案是在调用 ExecuteMethod 之前将实例推送到线程本地上下文，您可以在其中检索或仅传递实例。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2008-09-18T21:38:20.383

只需让 ExecuteMethod 获取一个对象。然后无论如何你都有实例。

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2008-09-18T21:45:56.683

在静态方法调用您的静态方法的情况下，没有调用实例。

找到一种不同的方式来完成你想做的任何事情。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2008-09-18T21:44:32.863

我觉得我在这里错过了一些东西。静态方法可以从任何地方调用。不能保证 A 类或 B 类实例会出现在调用堆栈中的任何位置。

必须有更好的方法来完成你想做的任何事情。

# orm - ORM（对象关系映射）中的“N+1 选择问题”是什么？

> ID：97197
> 
> 赞同：1948
> 
> 时间：2008-09-18T21:30:00.963
> 
> 标签：orm, select-n-plus-1

“N+1 选择问题”通常在对象关系映射 (ORM) 讨论中被表述为一个问题，我知道这与必须对对象中看似简单的东西进行大量数据库查询有关世界。

有人对这个问题有更详细的解释吗？

* * *

## 回答 #1

> 赞同：1303
> 
> 时间：2008-09-18T21:36:40.683

假设您有一个`Car`对象集合（数据库行），每个对象`Car`都有一个`Wheel`对象集合（也是行）。换句话说，`Car`→`Wheel`是一对多的关系。

现在，假设您需要遍历所有汽车，并为每辆汽车打印出车轮列表。天真的 O/R 实现将执行以下操作：

```
SELECT * FROM Cars; 
```

然后**对于每个`Car`：**

```
SELECT * FROM Wheel WHERE CarId = ? 
```

换句话说，您有一个用于 Cars 的选择，然后是 N 个额外的选择，其中 N 是汽车的总数。

或者，可以获取所有轮子并在内存中执行查找：

```
SELECT * FROM Wheel 
```

这将数据库的往返次数从 N+1 减少到 2。大多数 ORM 工具为您提供了几种防止 N+1 选择的方法。

参考：*[Java Persistence with Hibernate](http://www.manning.com/bauer2/)*，第 13 章。

* * *

## 回答 #2

> 赞同：167
> 
> 时间：2016-09-26T07:13:55.957

## 什么是 N+1 查询问题

N+1 查询问题发生在数据访问框架执行 N 个附加 SQL 语句以获取执行主 SQL 查询时可能已检索到的相同数据时。

N值越大，执行的查询越多，对性能的影响越大。而且，与可以帮助您找到运行缓慢的查询的慢查询日志不同，N+1 问题不会被发现，因为每个单独的附加查询运行速度足够快，不会触发慢查询日志。

问题在于执行大量附加查询，总体而言，这些查询需要足够的时间来减慢响应时间。

假设我们有以下 post 和 post_comments 数据库表，它们形成了一对多的表关系：

[![post 和 post_comments 表](https://i.stack.imgur.com/T1uWG.png)](https://i.stack.imgur.com/T1uWG.png)

我们将创建以下 4`post`行：

```
INSERT INTO post (title, id)
VALUES ('High-Performance Java Persistence - Part 1', 1)

INSERT INTO post (title, id)
VALUES ('High-Performance Java Persistence - Part 2', 2)

INSERT INTO post (title, id)
VALUES ('High-Performance Java Persistence - Part 3', 3)

INSERT INTO post (title, id)
VALUES ('High-Performance Java Persistence - Part 4', 4) 
```

而且，我们还将创建 4`post_comment`个子记录：

```
INSERT INTO post_comment (post_id, review, id)
VALUES (1, 'Excellent book to understand Java Persistence', 1)

INSERT INTO post_comment (post_id, review, id)
VALUES (2, 'Must-read for Java developers', 2)

INSERT INTO post_comment (post_id, review, id)
VALUES (3, 'Five Stars', 3)

INSERT INTO post_comment (post_id, review, id)
VALUES (4, 'A great reference book', 4) 
```

## 纯 SQL 的 N+1 查询问题

如果您选择`post_comments`使用此 SQL 查询：

```
List<Tuple> comments = entityManager.createNativeQuery("""
    SELECT
        pc.id AS id,
        pc.review AS review,
        pc.post_id AS postId
    FROM post_comment pc
    """, Tuple.class)
.getResultList(); 
```

并且，稍后，您决定`post` `title`为 each获取关联的`post_comment`：

```
for (Tuple comment : comments) {
    String review = (String) comment.get("review");
    Long postId = ((Number) comment.get("postId")).longValue();

    String postTitle = (String) entityManager.createNativeQuery("""
        SELECT
            p.title
        FROM post p
        WHERE p.id = :postId
        """)
    .setParameter("postId", postId)
    .getSingleResult();

    LOGGER.info(
        "The Post '{}' got this review '{}'",
        postTitle,
        review
    );
} 
```

您将触发 N+1 查询问题，因为您执行了 5 (1 + 4) 而不是一个 SQL 查询：

```
SELECT
    pc.id AS id,
    pc.review AS review,
    pc.post_id AS postId
FROM post_comment pc

SELECT p.title FROM post p WHERE p.id = 1
-- The Post 'High-Performance Java Persistence - Part 1' got this review
-- 'Excellent book to understand Java Persistence'

SELECT p.title FROM post p WHERE p.id = 2
-- The Post 'High-Performance Java Persistence - Part 2' got this review
-- 'Must-read for Java developers'

SELECT p.title FROM post p WHERE p.id = 3
-- The Post 'High-Performance Java Persistence - Part 3' got this review
-- 'Five Stars'

SELECT p.title FROM post p WHERE p.id = 4
-- The Post 'High-Performance Java Persistence - Part 4' got this review
-- 'A great reference book' 
```

修复 N+1 查询问题非常容易。您需要做的就是提取原始 SQL 查询中所需的所有数据，如下所示：

```
List<Tuple> comments = entityManager.createNativeQuery("""
    SELECT
        pc.id AS id,
        pc.review AS review,
        p.title AS postTitle
    FROM post_comment pc
    JOIN post p ON pc.post_id = p.id
    """, Tuple.class)
.getResultList();

for (Tuple comment : comments) {
    String review = (String) comment.get("review");
    String postTitle = (String) comment.get("postTitle");

    LOGGER.info(
        "The Post '{}' got this review '{}'",
        postTitle,
        review
    );
} 
```

这一次，只执行一个 SQL 查询来获取我们进一步感兴趣使用的所有数据。

## JPA 和 Hibernate 的 N+1 查询问题

在使用 JPA 和 Hibernate 时，有几种方法可以触发 N+1 查询问题，因此了解如何避免这些情况非常重要。

对于下一个示例，考虑我们将`post`和`post_comments`表映射到以下实体：

[![Post 和 PostComment 实体](https://i.stack.imgur.com/rZJne.png)](https://i.stack.imgur.com/rZJne.png)

JPA 映射如下所示：

```
@Entity(name = "Post")
@Table(name = "post")
public class Post {

    @Id
    private Long id;

    private String title;

    //Getters and setters omitted for brevity
}

@Entity(name = "PostComment")
@Table(name = "post_comment")
public class PostComment {

    @Id
    private Long id;

    @ManyToOne
    private Post post;

    private String review;

    //Getters and setters omitted for brevity
} 
```

## `FetchType.EAGER`

隐式或显式地使用`FetchType.EAGER`JPA 关联是一个坏主意，因为您将获取更多所需的数据。此外，该`FetchType.EAGER`策略还容易出现 N+1 查询问题。

不幸的是，`@ManyToOne`and`@OneToOne`关联`FetchType.EAGER`默认使用，所以如果你的映射看起来像这样：

```
@ManyToOne
private Post post; 
```

您正在使用该`FetchType.EAGER`策略，并且每次在使用JPQL 或 Criteria API 查询`JOIN FETCH`加载某些`PostComment`实体时忘记使用：

```
List<PostComment> comments = entityManager
.createQuery("""
    select pc
    from PostComment pc
    """, PostComment.class)
.getResultList(); 
```

您将触发 N+1 查询问题：

```
SELECT 
    pc.id AS id1_1_, 
    pc.post_id AS post_id3_1_, 
    pc.review AS review2_1_ 
FROM 
    post_comment pc

SELECT p.id AS id1_0_0_, p.title AS title2_0_0_ FROM post p WHERE p.id = 1
SELECT p.id AS id1_0_0_, p.title AS title2_0_0_ FROM post p WHERE p.id = 2
SELECT p.id AS id1_0_0_, p.title AS title2_0_0_ FROM post p WHERE p.id = 3
SELECT p.id AS id1_0_0_, p.title AS title2_0_0_ FROM post p WHERE p.id = 4 
```

请注意执行的附加 SELECT 语句，因为必须在`post`返回实体之前获取关联。`List``PostComment`

`find`与调用方法时使用的默认获取计划不同`EnrityManager`，JPQL 或 Criteria API 查询定义了一个显式计划，Hibernate 无法通过自动注入 JOIN FETCH 来更改该计划。因此，您需要手动执行此操作。

如果您根本不需要`post`关联，那么您在使用时就不走运了，`FetchType.EAGER`因为无法避免获取它。这就是为什么最好`FetchType.LAZY`默认使用。

但是，如果你想使用`post`关联，那么你可以使用`JOIN FETCH`来避免 N+1 查询问题：

```
List<PostComment> comments = entityManager.createQuery("""
    select pc
    from PostComment pc
    join fetch pc.post p
    """, PostComment.class)
.getResultList();

for(PostComment comment : comments) {
    LOGGER.info(
        "The Post '{}' got this review '{}'", 
        comment.getPost().getTitle(), 
        comment.getReview()
    );
} 
```

这一次，Hibernate 将执行一条 SQL 语句：

```
SELECT 
    pc.id as id1_1_0_, 
    pc.post_id as post_id3_1_0_, 
    pc.review as review2_1_0_, 
    p.id as id1_0_1_, 
    p.title as title2_0_1_ 
FROM 
    post_comment pc 
INNER JOIN 
    post p ON pc.post_id = p.id

-- The Post 'High-Performance Java Persistence - Part 1' got this review 
-- 'Excellent book to understand Java Persistence'

-- The Post 'High-Performance Java Persistence - Part 2' got this review 
-- 'Must-read for Java developers'

-- The Post 'High-Performance Java Persistence - Part 3' got this review 
-- 'Five Stars'

-- The Post 'High-Performance Java Persistence - Part 4' got this review 
-- 'A great reference book' 
```

## `FetchType.LAZY`

即使您切换到`FetchType.LAZY`显式使用所有关联，您仍然会遇到 N+1 问题。

这一次，`post`关联映射如下：

```
@ManyToOne(fetch = FetchType.LAZY)
private Post post; 
```

现在，当您获取`PostComment`实体时：

```
List<PostComment> comments = entityManager
.createQuery("""
    select pc
    from PostComment pc
    """, PostComment.class)
.getResultList(); 
```

Hibernate 将执行一条 SQL 语句：

```
SELECT 
    pc.id AS id1_1_, 
    pc.post_id AS post_id3_1_, 
    pc.review AS review2_1_ 
FROM 
    post_comment pc 
```

但是，如果之后，您将引用延迟加载的`post`关联：

```
for(PostComment comment : comments) {
    LOGGER.info(
        "The Post '{}' got this review '{}'", 
        comment.getPost().getTitle(), 
        comment.getReview()
    );
} 
```

您将收到 N+1 查询问题：

```
SELECT p.id AS id1_0_0_, p.title AS title2_0_0_ FROM post p WHERE p.id = 1
-- The Post 'High-Performance Java Persistence - Part 1' got this review 
-- 'Excellent book to understand Java Persistence'

SELECT p.id AS id1_0_0_, p.title AS title2_0_0_ FROM post p WHERE p.id = 2
-- The Post 'High-Performance Java Persistence - Part 2' got this review 
-- 'Must-read for Java developers'

SELECT p.id AS id1_0_0_, p.title AS title2_0_0_ FROM post p WHERE p.id = 3
-- The Post 'High-Performance Java Persistence - Part 3' got this review 
-- 'Five Stars'

SELECT p.id AS id1_0_0_, p.title AS title2_0_0_ FROM post p WHERE p.id = 4
-- The Post 'High-Performance Java Persistence - Part 4' got this review 
-- 'A great reference book' 
```

由于`post`关联是延迟获取的，因此在访问延迟关联时将执行辅助 SQL 语句以构建日志消息。

同样，修复包括向`JOIN FETCH`JPQL 查询添加一个子句：

```
List<PostComment> comments = entityManager.createQuery("""
    select pc
    from PostComment pc
    join fetch pc.post p
    """, PostComment.class)
.getResultList();

for(PostComment comment : comments) {
    LOGGER.info(
        "The Post '{}' got this review '{}'", 
        comment.getPost().getTitle(), 
        comment.getReview()
    );
} 
```

而且，就像在`FetchType.EAGER`示例中一样，此 JPQL 查询将生成单个 SQL 语句。

> 即使您正在使用`FetchType.LAZY`并且不引用双向`@OneToOne`JPA 关系的子关联，您仍然可以触发 N+1 查询问题。

## 如何自动检测 N+1 查询问题

如果要在数据访问层自动检测 N+1 查询问题，可以使用[`db-util`](https://github.com/vladmihalcea/db-util)开源项目。

首先，您需要添加以下 Maven 依赖项：

```
<dependency>
    <groupId>com.vladmihalcea</groupId>
    <artifactId>db-util</artifactId>
    <version>${db-util.version}</version>
</dependency> 
```

之后，您只需使用`SQLStatementCountValidator`实用程序来断言生成的底层 SQL 语句：

```
SQLStatementCountValidator.reset();

List<PostComment> comments = entityManager.createQuery("""
    select pc
    from PostComment pc
    """, PostComment.class)
.getResultList();

SQLStatementCountValidator.assertSelectCount(1); 
```

如果您正在使用`FetchType.EAGER`并运行上述测试用例，您将得到以下测试用例失败：

```
SELECT 
    pc.id as id1_1_, 
    pc.post_id as post_id3_1_, 
    pc.review as review2_1_ 
FROM 
    post_comment pc

SELECT p.id as id1_0_0_, p.title as title2_0_0_ FROM post p WHERE p.id = 1

SELECT p.id as id1_0_0_, p.title as title2_0_0_ FROM post p WHERE p.id = 2

-- SQLStatementCountMismatchException: Expected 1 statement(s) but recorded 3 instead! 
```

* * *

## 回答 #3

> 赞同：123
> 
> 时间：2008-09-18T21:43:11.480

```
SELECT 
table1.*
, table2.*
INNER JOIN table2 ON table2.SomeFkId = table1.SomeId 
```

这将为您提供一个结果集，其中 table2 中的子行通过返回 table2 中每个子行的 table1 结果来导致重复。O/R 映射器应根据唯一键字段区分 table1 实例，然后使用所有 table2 列填充子实例。

```
SELECT table1.*

SELECT table2.* WHERE SomeFkId = # 
```

N+1 是第一个查询填充主对象的位置，第二个查询填充每个返回的唯一主对象的所有子对象。

考虑：

```
class House
{
    int Id { get; set; }
    string Address { get; set; }
    Person[] Inhabitants { get; set; }
}

class Person
{
    string Name { get; set; }
    int HouseId { get; set; }
} 
```

和具有类似结构的表。对地址“22 Valley St”的单个查询可能会返回：

```
Id Address      Name HouseId
1  22 Valley St Dave 1
1  22 Valley St John 1
1  22 Valley St Mike 1 
```

O/RM 应该用 ID=1、Address="22 Valley St" 填充 Home 的实例，然后用 Dave、John 和 Mike 的 People 实例填充 Inhabitants 数组，只需一个查询。

对上面使用的相同地址的 N+1 查询将导致：

```
Id Address
1  22 Valley St 
```

使用单独的查询，例如

```
SELECT * FROM Person WHERE HouseId = 1 
```

并产生一个单独的数据集，如

```
Name    HouseId
Dave    1
John    1
Mike    1 
```

并且最终结果与上面的单个查询相同。

单选的优点是您可以预先获得所有数据，这可能是您最终想要的。N+1 的优点是降低了查询复杂性，并且您可以使用延迟加载，其中子结果集仅在第一次请求时加载。

* * *

## 回答 #4

> 赞同：66
> 
> 时间：2009-12-01T13:35:38.847

与产品具有一对多关系的供应商。一个供应商拥有（供应）许多产品。

```
***** Table: Supplier *****
+-----+-------------------+
| ID  |       NAME        |
+-----+-------------------+
|  1  |  Supplier Name 1  |
|  2  |  Supplier Name 2  |
|  3  |  Supplier Name 3  |
|  4  |  Supplier Name 4  |
+-----+-------------------+

***** Table: Product *****
+-----+-----------+--------------------+-------+------------+
| ID  |   NAME    |     DESCRIPTION    | PRICE | SUPPLIERID |
+-----+-----------+--------------------+-------+------------+
|1    | Product 1 | Name for Product 1 |  2.0  |     1      |
|2    | Product 2 | Name for Product 2 | 22.0  |     1      |
|3    | Product 3 | Name for Product 3 | 30.0  |     2      |
|4    | Product 4 | Name for Product 4 |  7.0  |     3      |
+-----+-----------+--------------------+-------+------------+ 
```

因素：

*   供应商的惰性模式设置为“true”（默认）

*   用于查询 Product 的 Fetch 模式是 Select

*   获取模式（默认）：访问供应商信息

*   缓存第一次没有发挥作用

*   供应商被访问

获取模式是选择获取（默认）

```
// It takes Select fetch mode as a default
Query query = session.createQuery( "from Product p");
List list = query.list();
// Supplier is being accessed
displayProductsListWithSupplierName(results);

select ... various field names ... from PRODUCT
select ... various field names ... from SUPPLIER where SUPPLIER.id=?
select ... various field names ... from SUPPLIER where SUPPLIER.id=?
select ... various field names ... from SUPPLIER where SUPPLIER.id=? 
```

结果：

*   1 选择产品声明
*   供应商的 N 条选择语句

这是 N+1 选择问题！

* * *

## 回答 #5

> 赞同：43
> 
> 时间：2014-01-08T12:49:28.047

我不能直接评论其他答案，因为我没有足够的声誉。但值得注意的是，问题的出现本质上只是因为从历史上看，许多 dbms 在处理连接方面一直很差（MySQL 是一个特别值得注意的例子）。因此，n+1 通常比连接快得多。然后有一些方法可以改进 n+1 但仍然不需要连接，这就是最初的问题所涉及的。

然而，在连接方面，MySQL 现在比以前好多了。当我第一次学习 MySQL 时，我经常使用连接。然后我发现它们有多慢，并在代码中切换到 n+1 。但是，最近，我又回到了连接，因为 MySQL 现在在处理它们方面比我刚开始使用它时要好得多。

如今，在性能方面，对一组正确索引的表进行简单的连接很少成为问题。如果它确实会影响性能，那么使用索引提示通常可以解决它们。

MySQL 开发团队之一在此处讨论了这一点：

[http://jorgenloland.blogspot.co.uk/2013/02/dbt-3-q3-6-x-performance-in-mysql-5610.html](http://jorgenloland.blogspot.co.uk/2013/02/dbt-3-q3-6-x-performance-in-mysql-5610.html)

所以总结是：如果您过去因为 MySQL 的糟糕性能而一直在避免连接，那么请在最新版本上重试。你可能会感到惊喜。

* * *

## 回答 #6

> 赞同：29
> 
> 时间：2011-06-09T21:18:00.617

由于这个问题，我们离开了 Django 中的 ORM。基本上，如果你尝试去做

```
for p in person:
    print p.car.colour 
```

ORM 将愉快地返回所有人员（通常作为 Person 对象的实例），但随后它需要查询每个 Person 的 car 表。

一种简单且非常有效的方法是我称之为“**折叠**”的方法，它避免了来自关系数据库的查询结果应该映射回组成查询的原始表的荒谬想法。

第 1 步：广泛选择

```
 select * from people_car_colour; # this is a view or sql function 
```

这将返回类似

```
 p.id | p.name | p.telno | car.id | car.type | car.colour
  -----+--------+---------+--------+----------+-----------
  2    | jones  | 2145    | 77     | ford     | red
  2    | jones  | 2145    | 1012   | toyota   | blue
  16   | ashby  | 124     | 99     | bmw      | yellow 
```

第 2 步：客观化

将结果吸入通用对象创建器，并在第三项之后拆分参数。这意味着“琼斯”对象不会被多次制作。

第 3 步：渲染

```
for p in people:
    print p.car.colour # no more car queries 
```

有关python的**fanfolding**的实现，请参阅[此网页。](http://campbell-lange.net/company/articles/dbwrapper/)

 *** * *

## 回答 #7

> 赞同：22
> 
> 时间：2008-09-18T21:43:19.810

[这是一个很好的问题描述](https://web.archive.org/web/20160310145416/http://www.realsolve.co.uk/site/tech/hib-tip-pitfall.php?name=why-lazy)

现在您了解了这个问题，通常可以通过在查询中执行连接提取来避免它。这基本上强制获取延迟加载的对象，以便在一个查询而不是 n+1 个查询中检索数据。希望这可以帮助。

* * *

## 回答 #8

> 赞同：20
> 
> 时间：2008-09-18T21:33:41.517

假设您有 COMPANY 和 EMPLOYEE。COMPANY 有许多 EMPLOYEES（即 EMPLOYEE 有一个字段 COMPANY_ID）。

在某些 O/R 配置中，当您有一个映射的 Company 对象并访问其 Employee 对象时，O/R 工具将为每个员工执行一次选择，而如果您只是在直接 SQL 中执行操作，则可以`select * from employees where company_id = XX`. 因此 N（员工人数）加 1（公司）

这就是 EJB 实体 Bean 的初始版本的工作方式。我相信像 Hibernate 这样的东西已经消除了这一点，但我不太确定。大多数工具通常包含有关其映射策略的信息。

* * *

## 回答 #9

> 赞同：18
> 
> 时间：2012-06-05T22:21:47.797

检查 Ayende 关于主题的帖子：[在 NHibernate 中解决 Select N + 1 问题](http://ayende.com/blog/1328/combating-the-select-n-1-problem-in-nhibernate)。

基本上，当使用像 NHibernate 或 EntityFramework 这样的 ORM 时，如果您有一对多（主从）关系，并且想要列出每个主记录的所有详细信息，您必须对数据库，“N”是主记录的数量：1 次查询获取所有主记录，N 次查询，每个主记录一个，获取每个主记录的所有详细信息。

更多数据库查询调用 → 更多延迟时间 → 降低应用程序/数据库性能。

但是，ORM 有一些选项可以避免这个问题，主要是使用 JOIN。

* * *

## 回答 #10

> 赞同：16
> 
> 时间：2014-11-07T10:30:07.943

发出 1 个返回 100 个结果的查询比发出 100 个每个返回 1 个结果的查询要快得多。

* * *

## 回答 #11

> 赞同：13
> 
> 时间：2010-07-21T11:55:01.893

在我看来，[Hibernate Pitfall:Why Relationships Should Be Lazy](http://www.realsolve.co.uk/site/tech/hib-tip-pitfall.php?name=why-lazy)中的文章与真正的 N+1 问题完全相反。

如果您需要正确的解释，请参考[Hibernate - 第 19 章：提高性能 - 获取策略](http://docs.jboss.org/hibernate/core/3.3/reference/en/html/performance.html#performance-fetching)

> Select fetching（默认）极易受到 N+1 选择问题的影响，因此我们可能希望启用 join fetching

* * *

## 回答 #12

> 赞同：10
> 
> 时间：2009-02-20T08:33:47.307

提供的链接有一个非常简单的 n + 1 问题示例。如果将它应用于 Hibernate，它基本上是在谈论同一件事。当您查询对象时，会加载实体，但任何关联（除非另有配置）都将被延迟加载。因此，对根对象的一个​​查询和另一个为每个对象加载关联的查询。返回的 100 个对象意味着一个初始查询，然后是 100 个附加查询以获取每个查询的关联，n + 1。

[http://pramatr.com/2009/02/05/sql-n-1-selects-explained/](http://pramatr.com/2009/02/05/sql-n-1-selects-explained/)

* * *

## 回答 #13

> 赞同：9
> 
> 时间：2015-04-15T07:52:59.100

N+1 选择问题很痛苦，在单元测试中检测这种情况是有意义的。我开发了一个小型库，用于验证给定测试方法或任意代码块执行的查询数量 - [JDBC Sniffer](https://github.com/bedrin/jdbc-sniffer)

只需向您的测试类添加一个特殊的 JUnit 规则，并在您的测试方法上放置带有预期查询数量的注释：

```
@Rule
public final QueryCounter queryCounter = new QueryCounter();

@Expectation(atMost = 3)
@Test
public void testInvokingDatabase() {
    // your JDBC or JPA code
} 
```

* * *

## 回答 #14

> 赞同：6
> 
> 时间：2021-10-11T19:12:59.820

**Hibernate & Spring Data JPA 中的 N+1 问题**

N+1 问题是对象关系映射中的一个性能问题，它会在数据库中为应用层的单个选择查询触发多个选择查询（准确地说是 N+1，其中 N = 表中的记录数）。Hibernate & Spring Data JPA 提供了多种方法来捕捉和解决这个性能问题。

**什么是 N+1 问题？**

为了理解 N+1 问题，让我们考虑一个场景。假设我们有一个*用户*对象的集合映射到数据库中的*DB_USER*表，并且每个用户都有一个使用连接表*DB_USER_ROLE*映射到*DB_ROLE表的集合或**角色*。在 ORM 级别，**User与****Role**有**多对多的**关系。

 ********```
Entity Model
@Entity
@Table(name = "DB_USER")
public class User {

    @Id
    @GeneratedValue(strategy=GenerationType.AUTO)
    private Long id;
    private String name;

    @ManyToMany(fetch = FetchType.LAZY)                   
    private Set<Role> roles;
    //Getter and Setters 
 }

@Entity
@Table(name = "DB_ROLE")
public class Role {

    @Id
    @GeneratedValue(strategy= GenerationType.AUTO)
    private Long id;

    private String name;
    //Getter and Setters
 } 
```

**一个用户可以有很多角色。角色被延迟加载。**现在假设我们*要从该表中获取所有用户并为每个用户打印角色*。非常天真的对象关系实现可能是 - 带有**findAllBy**方法的**UserRepository**

```
public interface UserRepository extends CrudRepository<User, Long> {

    List<User> findAllBy();
} 
```

**ORM 执行的等效 SQL 查询将是：**

首先获取**所有用户**(1)

```
Select * from DB_USER; 
```

然后**为每个执行 N 次的用户获取角色**（其中 N 是用户数）

```
Select * from DB_USER_ROLE where userid = <userid>; 
```

所以我们需要**一个用户选择**和**N 个额外的选择来为每个用户获取角色**，其中*N 是用户总数*。***这是 ORM 中的经典 N+1 问题***。

**如何识别它？**

Hibernate 提供了在控制台/日志中启用 SQL 日志记录的跟踪选项。***使用日志，您可以轻松查看 hibernate 是否为给定的调用发出 N+1 个查询***。

如果您看到给定选择查询的多个 SQL 条目，则很有可能是由于 N+1 问题。

**N+1 分辨率**

**在 SQL 级别**，为了避免 N+1，ORM 需要实现的是*触发一个连接两个表的查询，并在单个查询中获得组合结果*。

***在单个查询中检索所有内容（用户和角色）的连接 SQL***

**或纯 SQL**

```
select user0_.id, role2_.id, user0_.name, role2_.name, roles1_.user_id, roles1_.roles_id from db_user user0_ left outer join db_user_roles roles1_ on user0_.id=roles1_.user_id left outer join db_role role2_ on roles1_.roles_id=role2_.id 
```

**Hibernate 和 Spring Data JPA 提供了解决 N+1 ORM 问题的机制。**

**1\. Spring Data JPA 方法：**

如果我们使用 Spring Data JPA，那么我们有两种选择来实现这一点 - 使用***EntityGraph***或使用***带有 fetch join 的 select 查询。***

```
public interface UserRepository extends CrudRepository<User, Long> {

    List<User> findAllBy();             

    @Query("SELECT p FROM User p LEFT JOIN FETCH p.roles")  
    List<User> findWithoutNPlusOne();

    @EntityGraph(attributePaths = {"roles"})                
    List<User> findAll();
} 
```

使用left join fetch在数据库级别发出N+1个查询，我们使用attributePaths解决了N+1个问题，Spring Data JPA避免了N+1个问题

**2.休眠方式：**

如果它是纯 Hibernate，那么以下解决方案将起作用。

使用**HQL**：

```
from User u *join fetch* u.roles roles roles 
```

使用**标准**API：

```
Criteria criteria = session.createCriteria(User.class);
criteria.setFetchMode("roles", FetchMode.EAGER); 
```

所有这些方法的工作方式都相似，并且它们使用左连接提取发出类似的数据库查询

* * *

## 回答 #15

> 赞同：5
> 
> 时间：2012-10-17T04:48:55.697

正如其他人所说的更优雅的问题是，您要么拥有 OneToMany 列的笛卡尔积，要么正在执行 N+1 选择。分别可能是巨大的结果集或与数据库聊天。

我很惊讶没有提到这一点，但这就是我解决这个问题的方法......**我制作了一个半临时 ids table**。[当您有条款限制](https://stackoverflow.com/a/11119642/318174)[时，我也会这样做`IN ()`](https://stackoverflow.com/a/11119642/318174)。

这不适用于所有情况（甚至可能不是大多数情况），但如果您有很多子对象，这样笛卡尔积就会失控（即很多`OneToMany`列，结果的数量将是列的乘法）及其更像是批处理的工作。

首先，您将父对象 ID 作为批次插入到 ids 表中。这个 batch_id 是我们在应用程序中生成并保留的东西。

```
INSERT INTO temp_ids 
    (product_id, batch_id)
    (SELECT p.product_id, ? 
    FROM product p ORDER BY p.product_id
    LIMIT ? OFFSET ?); 
```

现在，对于每一`OneToMany`列，您只需`SELECT`在 ids 表`INNER JOIN`上使用 a 对子表执行 a `WHERE batch_id=`（反之亦然）。您只想确保按 id 列排序，因为它会使合并结果列更容易（否则您将需要一个 HashMap/Table 用于整个结果集，这可能不是那么糟糕）。

然后你只需定期清理 ids 表。

如果用户选择 100 个左右不同的项目进行某种批量处理，这也特别有效。将 100 个不同的 id 放入临时表中。

现在，您正在执行的查询数量是 OneToMany 列的数量。

* * *

## 回答 #16

> 赞同：3
> 
> 时间：2021-01-08T12:03:43.627

在不深入技术栈实现细节的情况下，从架构上讲，N + 1 问题至少有两种解决方案：

*   只有 1 个 - 大查询 - 有连接。这使得大量信息从数据库传输到应用层，尤其是在有多个子记录的情况下。数据库的典型结果是一组行，而不是对象图（对于不同的数据库系统有解决方案）
*   有两个（或更多需要加入的孩子）查询 - 1 个用于父母，在你拥有它们之后 - 通过 ID 查询孩子并映射它们。这将最大限度地减少 DB 和 APP 层之间的数据传输。

* * *

## 回答 #17

> 赞同：1
> 
> 时间：2013-07-12T17:58:36.430

以 Matt Solnit 为例，假设您将 Car 和 Wheels 之间的关联定义为 LAZY，并且您需要一些 Wheels 字段。这意味着在第一次选择之后，hibernate 将为每辆车执行“Select * from Wheels where car_id = :id”。

这使得每 N 辆车第一次选择和更多 1 次选择，这就是为什么它被称为 n+1 问题。

为避免这种情况，请使关联获取为急切，以便休眠加载带有连接的数据。

但请注意，如果您多次不访问关联的 Wheels，最好保持 LAZY 或使用 Criteria 更改获取类型。

* * *

## 回答 #18

> 赞同：1
> 
> 时间：2022-02-15T08:36:42.947

### N+1 的推广

N+1 问题是一个特定于 ORM 的问题名称，您将可以在服务器上合理执行的循环移动到客户端。通用问题并非特定于 ORM，您可以使用任何远程 API 来解决它。[在本文中，我展示了](https://blog.jooq.org/the-cost-of-jdbc-server-roundtrips/)如果您调用 API N 次而不是仅 1 次，JDBC 往返是多么昂贵。该示例的不同之处在于您是否调用了 Oracle PL/SQL 过程：

*   `dbms_output.get_lines`（调用一次，收到N个物品）
*   `dbms_output.get_line`（调用N次，每次收到1件）

它们在逻辑上是等价的，但是由于服务器和客户端之间的延迟，您在循环中添加了 N 个延迟等待，而不是只等待一次。

### ORM 案例

事实上，ORM-y N+1 问题甚至也不是 ORM 特定的，您也可以通过手动运行自己的查询来实现它，例如，当您在 PL/SQL 中执行以下操作时：

```
-- This loop is executed once
for parent in (select * from parent) loop

  -- This loop is executed N times
  for child in (select * from child where parent_id = parent.id) loop
    ...
  end loop;
end loop; 
```

使用连接来实现这个会更好（在这种情况下）：

```
for rec in (
  select *
  from parent p
  join child c on c.parent_id = p.id
)
loop
  ...
end loop; 
```

现在，循环只执行一次，并且循环的逻辑已经从客户端 (PL/SQL) 转移到服务器 (SQL)，服务器甚至可以对其进行不同的优化，例如通过运行哈希连接 ( `O(N)`) 而不是嵌套循环连接（`O(N log N)`带索引）

### 自动检测 N+1 个问题

如果您使用 JDBC，[则可以在幕后使用 jOOQ 作为 JDBC 代理来自动检测您的 N+1 问题](https://blog.jooq.org/using-jooqs-diagnosticsconnection-to-detect-n1-queries/)。jOOQ 的解析器规范化您的 SQL 查询并缓存有关连续执行父查询和子查询的数据。如果您的查询不完全相同，但在语义上等价，这甚至也有效。

* * *

## 回答 #19

> 赞同：0
> 
> 时间：2020-10-22T17:14:31.970

N+1 SELECT 问题真的很难发现，尤其是在具有大域的项目中，直到它开始降低性能的那一刻。即使问题得到解决，即通过添加急切加载，进一步的开发可能会破坏解决方案和/或在其他地方再次引入 N+1 SELECT 问题。

我创建了开源库[jplusone](https://github.com/adgadev/jplusone)来解决基于 JPA 的 Spring Boot Java 应用程序中的这些问题。该库提供了两个主要功能：

1.  生成将 SQL 语句与触发它们的 JPA 操作的执行相关联的报告，并将其放置在涉及它的应用程序的源代码中

```
2020-10-22 18:41:43.236 调试 14913 --- [主要] cajcore.report.ReportGenerator ：
    根
        com.adgadev.jplusone.test.domain.bookshop.BookshopControllerTest.shouldGetBookDetailsLazily(BookshopControllerTest.java:65)
        com.adgadev.jplusone.test.domain.bookshop.BookshopController.getSampleBookUsingLazyLoading(BookshopController.java:31)
        com.adgadev.jplusone.test.domain.bookshop.BookshopService.getSampleBookDetailsUsingLazyLoading [代理]
            会话边界
                操作 [隐含]
                    com.adgadev.jplusone.test.domain.bookshop.BookshopService.getSampleBookDetailsUsingLazyLoading(BookshopService.java:35)
                    com.adgadev.jplusone.test.domain.bookshop.Author.getName [代理]
                    com.adgadev.jplusone.test.domain.bookshop.Author [获取实体]
                        声明 [阅读]
                            从中选择 [...]
                                作者作者0_
                                在 author0_.genre_id=genre1_.id 上左外连接流派 Genre1_
                            在哪里
                                author0_.id=1
                操作 [隐含]
                    com.adgadev.jplusone.test.domain.bookshop.BookshopService.getSampleBookDetailsUsingLazyLoading(BookshopService.java:36)
                    com.adgadev.jplusone.test.domain.bookshop.Author.countWrittenBooks(Author.java:53)
                    com.adgadev.jplusone.test.domain.bookshop.Author.books [获取收藏]
                        声明 [阅读]
                            从中选择 [...]
                                书籍书籍0_
                            在哪里
                                book0_.author_id=1

```

2.  提供 API，允许编写测试检查您的应用程序使用 JPA 的效率（即断言延迟加载操作的数量）

```
@SpringBootTest
class LazyLoadingTest {

    @Autowired
    private JPlusOneAssertionContext assertionContext;

    @Autowired
    private SampleService sampleService;

    @Test
    public void shouldBusinessCheckOperationAgainstJPlusOneAssertionRule() {
        JPlusOneAssertionRule rule = JPlusOneAssertionRule
                .within().lastSession()
                .shouldBe().noImplicitOperations().exceptAnyOf(exclusions -> exclusions
                        .loadingEntity(Author.class).times(atMost(2))
                        .loadingCollection(Author.class, "books")
                );

        // trigger business operation which you wish to be asserted against the rule,
        // i.e. calling a service or sending request to your API controller
        sampleService.executeBusinessOperation();

        rule.check(assertionContext);
    }
} 
```

# asp.net - WebDev：进行多文件上传的最佳方式是什么？

> ID：97198
> 
> 赞同：2
> 
> 时间：2008-09-18T21:30:13.773
> 
> 标签：asp.net, web-applications, file-upload

我希望（几乎没有计算机知识的）人们通过我的网络应用程序轻松提交大量文件（图片）。是否有一个简单、强大、免费/便宜、广泛使用的标准工具/组件（Flash 或 .NET - 抱歉，浏览器上没有 Java 运行时），它允许 Web 用户在他们的计算机上选择一个文件夹或一堆文件，并且上传它们？

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2008-09-18T21:31:28.027

[swfupload](http://www.swfupload.org)，我知道的最好的工具，可以让你做到这一点。简单，易于使用，甚至为 1% 没有 Flash 8+ 的网络用户提供后备机制。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2008-09-18T21:35:19.953

我发现上传一堆文件的最佳方法是压缩它们并上传单个文件（然后在服务器上解压缩）。但是，对于您的目标受众来说，这可能不是一个好的选择。

* * *

## 回答 #3

> 赞同：-1
> 
> 时间：2008-09-18T21:56:44.753

我们让一家公司想出了一个 Silverlight 上传功能，它可以预先调整图片的大小，这样 5MB 的文件就不必上传然后调整大小。Silverlight 附带的 clr 中不包含图像大小调整功能。枕骨想出了自己的。你可以在这里看到它： [http ://www.occipital.com/fjcore.html](http://www.occipital.com/fjcore.html)

我不知道他们会收取什么费用，但我们对它的运作方式非常满意。如果您在上传之前不需要调整大小功能，那么我会使用 Flash 上传选项之一，例如[http://swfupload.org](http://swfupload.org)或[http://www.codeproject.com/KB/aspnet/FlashUpload.aspx](http://www.codeproject.com/KB/aspnet/FlashUpload.aspx)

# windows-installer - Windows Installer：如何仅为管理员创建开始菜单快捷方式？

> ID：97202
> 
> 赞同：0
> 
> 时间：2008-09-18T21:30:46.017
> 
> 标签：windows-installer

我有一个 WSI 安装程序包，用于安装我的应用程序。应用程序本身可以由普通用户运行，但我有一个只能由系统管理员运行的配置应用程序。因此，我不希望它出现在所有用户的“开始”菜单中，只为管理员显示。

有没有办法告诉 Windows Installer 为所有用户创建一些快捷方式，而另一些只为管理员创建？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2008-09-18T21:38:27.030

因为我怀疑您是否会知道每个管理员的名称，并且没有仅管理员的启动文件夹，所以我认为更好的解决方案是让配置应用程序检查运行它的用户是否是管理员然后退出如果不是，请优雅地。

编辑：

也许我应该进一步解释为什么我认为为管理员添加快捷方式是解决错误问题的一种情况。以下是一些我认为可以说明陷阱的场景：

1）如果您查看本地管理员组并为列出的每个用户添加快捷方式怎么办。现在一周后，我被添加到本地管理员中。我没有捷径。

2）通常特别是在企业中，个人不在本地管理员中，组在。理论上你可以：查询 AD 以查找每个组的成员（我们甚至不考虑嵌套组）然后在文档和设置下为每个用户添加适当的文件夹，即使他们可能会或可能不会登录到这台机器。即使您这样做了，如果该组成员发生更改，那么某些管理员可能会登录并且没有快捷方式。

3）假设您为每个管理员添加它。当我的管理员权限被取消时会发生什么？我仍然有捷径。

通过让您的 MSI 安装一个脚本来测试当前用户是否是管理员，如果他们是该脚本，则可以解决其中的一些问题。然后将脚本注册为 Active Setup 项。然后，每当新管理员登录时，他们都会获得快捷方式。但是，如果他们失去了管理员权限，这不会删除快捷方式。

不管这一切，如果我了解情况，那么没有什么可以阻止任何用户管理员或不去快捷方式指向的任何地方并运行它。

所以，我再说一遍，只为管理员添加快捷方式正在解决错误的问题。要解决的正确问题是使您必须成为管理员才能运行配置实用程序。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2008-09-18T21:35:26.850

通常在所有用户目录（C:\Documents and settings\All Users）中到处都有快捷方式。如果您只想在管理员组中，则应将其放在 C:\Documents and settings\Administrator 或任何用户名中（这可能在安装过​​程中找到 - 这需要管理权限）。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2008-09-18T21:43:14.990

您可以将有问题的快捷方式放在子文件夹中，并拒绝非管理员用户访问该文件夹的内容。他们将看到一个空文件夹，管理员将看到一个充满快捷方式的文件夹。这不是理想的解决方案，但非管理员用户可以在不提升权限的情况下完成的最佳解决方案。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2012-08-29T13:33:32.367

我将为配置应用程序制作一个单独的 MSI，并将其启动顺序设置为需要管理员权限。然后您可以为每个用户安装应用程序，或者更好地更新您的配置应用程序以拒绝以普通用户身份运行。

# c# - 比较 C# 和 Java

> ID：97204
> 
> 赞同：6
> 
> 时间：2008-09-18T21:31:00.993
> 
> 标签：c#, java

我在大学学习了 Java，然后被一家 C# 商店聘用，并一直使用它。第一周我意识到这两种语言几乎是相同的，接下来的两个月我才发现了细微的差异。在大多数情况下，我是否注意到 Java 具有 C# 所没有的东西，因此我很沮丧。（例如：枚举类型，它是成熟的类，而不仅仅是带有新油漆的整数）我开始欣赏 C# 世界，但我不能说我对 Java 的了解足以真正对比两者，所以我'很好奇获得社区横截面。

C# 和 Java 的相对优缺点是什么？这包括从语言结构到可用 IDE 和服务器软件的所有内容。

* * *

## 回答 #1

> 赞同：8
> 
> 时间：2008-09-18T21:52:18.150

比较和对比两者之间的语言可能非常困难，因为在许多方面，您使用的相关库与最能展示另一种语言的各种优势的语言相关联。

所以我会尽量列出我能记住的或已经发布的东西，并注意我认为谁有优势：

1.  GUI 开发（厚或薄）。C# 与 .NET 结合是目前更好的选择。
2.  自动数据源绑定。C# 与 LINQ 遥遥领先，丰富的第三部分库也提供了优势
3.  SQL 连接。爪哇
4.  自动装箱。两种语言都提供了它，但 C# 属性在 setter 和 getter 方面为它提供了更好的设计
5.  注释/属性。C# 属性是一个更强大、更清晰的实现
6.  内存管理——在我做过的所有测试中，Java VM 都远远优于 CLR
7.  垃圾收集——Java 是另一个明显的赢家。使用 C#/.NET 框架的非托管代码使这成为一场噩梦，尤其是在使用 GUI 时。
8.  泛型 - 我相信这两种语言在这里基本上是联系在一起的......我已经看到了显示任何一方都更好的优点。我的直觉是 Java 更好，但没有任何逻辑基础。此外，我只使用过几次 C# 泛型 ALLOT 和 Java 泛型......
9.  枚举。Java 一路走来，就我而言，C# 实现很糟糕。
10.  XML - 在这里折腾。使用 .NET 获得的 XML 和序列化功能本身胜过使用开箱即用的 eclipse/Java 获得的功能。但是这两种产品都有很多库来帮助处理 XML……我已经尝试了一些，但从来没有真正对其中任何一个感到满意。我一直坚持使用本机 C# XML 和一些我自己制作的自定义库，我已经习惯了，所以在这一点上很难给出一个远的比较......
11.  IDE - 对于非 GUI 工作，Eclipse 比 Visual Studio 更好。所以 Java 赢得了非 GUI 而 Visual Studio 赢得了 GUI...

这些都是我暂时想不出来的项目……我相信你可以从字面上挑选数百个项目来比较和对比两者。希望这个列表是更常用功能的横截面......

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2008-09-18T21:36:39.933

一个区别是 C# 可以更好地与 Windows 一起工作。这样做的缺点是它不能与Windows 以外的任何东西一起工作（也许 Mono 除外*，*[我](http://www.mono-project.com/Main_Page)没有尝试过）。

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2008-09-18T21:33:04.763

要记住的另一件事是，您可能还想比较它们各自的虚拟机。

比较 CLR 和 Java VM 将为您提供另一种区分两者的方法。

例如，如果执行繁重的多线程，Java VM 的内存模型比 CLR（.NET 的等价物）更强。

* * *

## 回答 #4

> 赞同：2
> 
> 时间：2008-09-18T21:36:11.370

C# 使用 WPF 具有更好的 GUI，这是 Java 传统上不擅长的。

C# 有非常好的 LINQ。

否则两者实际上是相同的——你认为他们在 .NET 刚问世时如何如此迅速地创建了如此庞大的类库？从那时起，情况略有变化，但从根本上说，C# 可以称为 MS-Java。

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2008-09-18T21:36:58.733

不要把这当作意见，但我个人无法忍受 Java 的 GUI。它离 Windows 很近，但不是很近，所以它进入了一个令人不安的山谷区域，这让我非常沮丧。

C#（和其他 .Net 语言，我想）允许我制作完美融入 Windows 的程序，这让我很高兴。

当然，如果我们不是在谈论开发桌面应用程序，那就没有意义了……

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2008-09-18T21:44:42.583

爪哇：

*   Java 中的枚举太牛了，它甚至都不好笑。
*   Java 支持泛型变体

C＃：

*   C# 不再局限于 Windows (Mono)。
*   Java 中缺少关键字 internal 相当令人失望。

* * *

## 回答 #7

> 赞同：0
> 
> 时间：2008-09-18T21:47:24.433

你说：

> 枚举类型是成熟的类，而不仅仅是带有新油漆的整数

你真的看过输出吗？如果你编译一个包含枚举的应用程序，然后阅读 CIL，你会发现枚举实际上是一个从 System.Enum 派生的密封类。

Red-Gate（以前是 Lutz Roeder 的）Reflector 等工具将尽可能靠近原始 C# 拆解它，因此可能不容易看到引擎盖下实际发生的事情。

* * *

## 回答 #8

> 赞同：0
> 
> 时间：2015-07-05T17:23:03.517

正如伊丽莎白巴雷特布朗宁所说：我如何爱你？让我来计算一下。

请原谅这篇文章的定性（与定量）方面。

比较这两种语言（及其相关的运行时间）非常困难。比较可以在多个层面上进行，并侧重于许多不同的方面（例如前面文章中提到的 GUI 开发）。他们之间的偏好通常是个人的，而不仅仅是技术性的。

C# 最初基于 Java（以及 JRE 上的 CLR），但恕我直言，总的来说，它的特性、表现力和可能的实用性已经超越了 Java。由一家公司（相对于一个委员会）控制，C# 可以比 Java 更快地前进。不同版本之间的差异起起落落，Java 经常迎头赶上（例如最近 C# 在 Java 中添加了 lambdas，这已经很长时间了）。两种语言在所有方面都不是另一种语言的超集，因为它们都具有另一种缺乏的特征（和弱点）。

详细的并排比较可能需要数百页。但我的观点是，对于大多数现代业务相关的编程任务，它们在功率和效用方面是相似的。最关键的区别可能在于便携性。Java 几乎可以在所有流行的平台上运行，而 C# 主要只在基于 Windows 的平台上运行（忽略 Mono，它并没有获得广泛的成功）。Java，因为它的可移植性，可以说拥有更大的开发者社区，因此有更多的第三方库和框架支持。

如果您觉得需要在它们之间进行选择，那么您的最佳标准就是您感兴趣的平台。如果您的所有工作都只能在 Windows 系统上运行，恕我直言，C#/CLR 具有更丰富的语言以及直接与 Windows 的原生 API 交互的能力，无疑是赢家。如果您需要跨系统可移植性，那么 Java/JRE 无疑是赢家。

PS。如果您需要更多可移植的工作技能，那么恕我直言 Java 也是赢家。

# asp.net - 'AjaxControlToolkit' 未定义错误

> ID：97206
> 
> 赞同：7
> 
> 时间：2008-09-18T21:31:32.397
> 
> 标签：asp.net, javascript

我在 VS2005 中使用**AjaxControlToolkit**，它工作正常。不过，我确实有一些问题，当我转到一些我拥有的页面，然后单击返回时，我收到了这个 JavaScript 错误：

> 'AjaxControlToolkit' 未定义

我搜索了 MSDN 论坛和谷歌，并尝试了许多解决方案，但都没有奏效。我试过了，`EnablePartialRendering="true",`还有其他的。除了重写所有内容并更改我的应用程序的工作流程之外，有没有办法找到这个问题的根本原因，或者修复它？

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2012-01-27T18:03:03.603

我解决了这个问题，但不是通过设置 CombineScripts="false" 而是通过使用本文中描述的解决[方案](http://forums.asp.net/post/4431011.aspx)。

最新版本发生了一些变化，因此您必须使用`Sys.Extended.UI.BehaviorBase`而不是`AjaxControlToolkit.BehaviorBase`在`registerClass`通话中使用。

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2011-01-05T00:13:56.073

要解决此“AjaxControlToolkit”未定义错误，您可能还需要确保在 ToolkitScriptManager 配置中将 CombineScripts 设置为 false。这可以在您的母版页中找到，这个解决方案对我有用。

```
<myTagPrefix:ToolkitScriptManager ID="ScriptManager1" runat="server" EnablePageMethods="true" EnablePartialRendering="true" SupportsPartialRendering="true" **CombineScripts="false"**> 
```

请注意，您需要将 myTagPrefix 更改为您用于 AjaxControlToolkit 的 tagprefix。这通常在 asp 文件顶部的 asp 中定义，如下所示......

```
<%@ Register assembly="AjaxControlToolkit" namespace="AjaxControlToolkit" tagprefix="myTagPrefix" %> 
```

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2008-09-18T21:45:14.063

这可能是一个愚蠢的问题，但您是否仔细检查以确保您的 aspx 文件顶部有工具包引用？

（为便于阅读，从评论中添加）

尝试将此添加到您的 web.config

```
<system.web.extensions>
    <scripting>
        <scriptResourceHandler enableCompression="false" enableCaching="false" />
    </scripting></system.web.extensions> 
```

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2008-09-18T21:40:27.540

这是一个javascript错误吗？

我想这与工具包中的后退按钮支持有关。

未定义的错误主要是因为包含“AjaxControlToolkit”的脚本没有被正确加载。

想到的事情：

*   订单脚本被加载，工具包是否获得优先权？
*   当任何已加载脚本中存在错误时，所有其他尚未加载的脚本将被取消并且不会被加载。

查看问题页面的输出 HTML，找到所有 AXD 文件的链接，并确保您可以下载它们并查看其中的有效 javascript。

如果您还没有，请获取[Firefox](http://www.mozilla.com/en-US/firefox/)和[Firebug](https://addons.mozilla.org/en-US/firefox/addon/1843)，您应该能够追踪到发出错误的实际脚本行。

希望这可以帮助。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2008-09-18T22:58:28.740

正如 [CodeRot] 所说，您需要确保您拥有所有 AJAX web.config 扩展，这是在做 ASP.NET AJAX 站点时（尤其是 VS 2005）最常遗漏的一点。

接下来确保页面上有一个 ScriptManager（我猜你是从“EnablePartialRendering”提到的）。

确保您引用了 .NET 版本的 AjaxControlToolkit 版本，它是为 .NET 2.0 和 .NET 3.5 编译的，我相信最新版本仅支持 .NET 3.5。

确保您将 Microsoft AJAX 客户端库添加到页面（您没有收到任何有关“Sys”缺失的错误）。

确保您在 ASPX、ASCX 或 web.config 中注册了 AjaxControlToolkit。

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2010-12-01T20:26:01.147

如果你还没有解决任何问题。确认您没有缓存此 ascx/aspx。删除 OutputCache 声明。

# .net - .Net 的条形码和字符识别组件

> ID：97212
> 
> 赞同：1
> 
> 时间：2008-09-18T21:32:05.560
> 
> 标签：.net, ocr, barcode

我需要从图像中提取和解码条形码和文本。是否有任何可用的开源库可以帮助完成该任务？如果没有，你知道一个好的商业产品吗？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2008-09-22T00:58:51.990

免责声明：我为 Atalasoft 工作。

来自 Atalasoft 的 DotImage + [Barcode Reader 插件](http://www.atalasoft.com/products/dotimage/barcode/)提供了不使用任何 COM 的运行时免版税选项。

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2008-10-10T13:06:08.287

我使用过 Leadtools 和 Atalasoft 的商业版本。 [Leadtools 14 烂透](http://blogs.freshlogicstudios.com/Search.aspx?q=Leadtools)了，我相信他们会随着时间的推移变得更好。如果你负担得起的话，Atalasoft 很高兴与它合作（我发现他们的定价和许可条款非常合理）。

对于 OCR，您可以尝试使用 Google 的 Tesseract 引擎的 .NET 包装器之一......比如[Tessnet2](http://www.pixel-technology.com/freeware/tessnet2/)

我很想找到一个 .NET 开源条形码阅读器。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2008-09-18T21:35:13.603

我是 Pegasus Imaging 的 Barcode Xpress 的
粉丝 www.jpg.com

# caching - 任何 HTTP 代理都具有对请求/响应缓冲和延迟连接的显式、可配置支持？

> ID：97220
> 
> 赞同：5
> 
> 时间：2008-09-18T21:33:04.077
> 
> 标签：caching, proxy, mobile, nginx, squid

在与移动客户端打交道时，在传输 HTTP 请求期间出现数秒延迟是很常见的。如果您从 prefork Apache 提供页面或服务，即使您的应用服务器逻辑在 5 毫秒内完成，子进程也将在几秒钟内为单个移动客户端提供服务。我正在寻找支持以下功能的 HTTP 服务器、平衡器或代理服务器：

1.  请求到达代理。代理开始在 RAM 或磁盘中缓冲请求，包括标头和 POST/PUT 正文。代理不打开到后端服务器的连接。这可能是最重要的部分。

2.  代理服务器在以下情况下停止缓冲请求：

    *   已达到大小限制（例如 4KB），或
    *   请求已被完整接收，headers 和 body
3.  只有现在，在内存中有（部分）请求时，才打开到后端的连接并中继请求。

4.  后端发回响应。代理服务器再次开始立即缓冲它（最大到更大的大小，比如 64KB。）

5.  由于代理有足够大的缓冲区，后端响应在几毫秒内完全存储在代理服务器中，后端进程/线程可以自由处理更多请求。后端连接立即关闭。

6.  代理以尽可能快或尽可能慢的速度将响应发送回移动客户端，而无需与后端连接占用资源。

我相当肯定你可以用 Squid 做 4-6，而 nginx 似乎支持 1-3（在这方面看起来相当独特）。我的问题是：是否有任何代理服务器可以理解这些缓冲和不打开连接直到准备好功能？也许只有一点 Apache config-fu 让这种缓冲行为变得微不足道？他们中的任何一个认为它不是像 Squid 那样的恐龙并且支持精益的单进程、异步、基于事件的执行模型吗？

（旁白：我会使用 nginx，但它不支持分块 POST 主体，因此无法为移动客户端提供服务。是的，便宜的 50 美元手机喜欢分块 POST……叹息）

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2008-09-24T11:36:40.363

同时使用 nginx 和 Squid（客户端 - Squid - nginx - 后端）怎么样？当从后端*返回*数据时，Squid 确实将其从 CTE: 分块转换为设置了 Content-Length 的常规流，因此它也可以规范化 POST。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2008-09-18T23:39:39.217

[Fiddler](http://www.telerik.com/fiddler)是 Telerik 的免费工具，它至少可以完成您正在寻找的一些事情。

具体来说，`Rules | Custom Rules...`您可以在连接期间的所有点添加任意 Javascript 代码。您可以通过调用模拟一些您需要的东西`sleep()`。

但是，我不确定这种方法能否为您提供所需的精细缓冲控制。不过，有总比没有好？

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2008-10-01T08:03:35.330

Nginx 可以为所欲为。您正在寻找的配置参数是

[http://wiki.codemongers.com/NginxHttpCoreModule#client_body_buffer_size](http://wiki.codemongers.com/NginxHttpCoreModule#client_body_buffer_size)

和

[http://wiki.codemongers.com/NginxHttpProxyModule#proxy_buffer_size](http://wiki.codemongers.com/NginxHttpProxyModule#proxy_buffer_size)

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2010-04-15T03:08:06.297

Squid 2.7 可以通过补丁支持 1-3：

*   [http://www.squid-cache.org/Versions/v2/HEAD/changesets/12402.patch](http://www.squid-cache.org/Versions/v2/HEAD/changesets/12402.patch)

我已经对此进行了测试，发现它运行良好，但条件是它只缓冲到内存，而不是磁盘（当然，除非它交换，而且你不想要这个），所以你需要在一个盒子上运行它这是为您的工作负载适当配置的。

对于大多数服务器和中介来说，分块 POST 是一个问题。你确定你需要支持吗？通常客户端在收到 411 时应该重试请求。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2008-09-19T09:37:18.407

不幸的是，我不知道有现成的解决方案。在最坏的情况下，考虑自己开发它，例如，使用 Java NIO —— 它不应该花费超过一周的时间。

# visual-studio-2008 - VS 2008 Post Build Step 搞笑业务

> ID：97228
> 
> 赞同：2
> 
> 时间：2008-09-18T21:34:28.037
> 
> 标签：visual-studio-2008, build-process

好的，这是我的项目的细分：我有一个带有“Scripts”子文件夹的 Web 项目。该文件夹包含一些 javascript 文件和 JSMin.exe 的副本以及在其中一些文件上运行 JSMin.exe 的批处理文件。我尝试设置“调用“$(ProjectDir)Scripts\jsmin.bat”'的后期构建步骤。当我执行构建时，批处理文件总是“以代码 1 退出”。这通过 Visual Studio 或通过 msbuild 命令行发生。我可以从 Scripts 文件夹手动运行批处理文件，它似乎按预期工作，所以我不确定这里的问题是什么。$(ProjectDir)Scripts\jsmin.bat 调用用引号引起来，因为 $(ProjectDir) 可能有空格（实际上在我的机器上也有）。我不确定此时该怎么做。一世'

理想情况下，我想通过 post 或 pre-build 步骤解决这个问题，这样构建管理器在部署代码时就不必经过额外的步骤。

谢谢！

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2008-09-18T21:40:24.200

如果您的自定义构建步骤中有返回错误代码的内容，您可以添加：

```
exit 0 
```

作为构建步骤的最后一行。这将阻止构建失败。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2008-11-07T12:43:14.443

我使用的一个可行的解决方案：

CD $(项目目录)

DoStuff.bat

不需要调用命令或其他任何东西，当然，如果您的项目目录中有该文件。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2008-10-03T14:31:46.320

您的脚本或批处理文件是否在内部使用任何路径引用？

我发现如果路径引用不是完全限定的，批处理文件将无法正常工作。

示例：名为 DoStuff.bat 的批处理文件使用 echo 命令附加文本文件。

这在 .bat 文件中不起作用**：**

```
echo "test" >>"test.txt" 
```

这在 .bat 文件**中确实有效：**

```
echo "test" >>"C:\Temp\CompileTest\test.txt" 
```

Visual Studio**生成后事件命令行**是这样的：

```
call "C:\Temp\CompileTest\DoStuff.bat" 
```

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2008-09-18T21:41:41.250

不知何故，我不熟悉 .bat 文件如何退出的细节，但是 JSMin 或批处理文件执行正在以非零返回码退出。

作为后期构建的一部分，您是否尝试过直接运行脚本（即不通过 JSMin.bat）？

编辑：看起来 Hallgrim 有它。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2008-10-20T21:06:05.177

现在回到这个问题（不得不转移到其他火灾上）

@Jonathan Webb - 我尝试了一些想法，但没有成功。事实上，我了解到我们在其他内部项目中正在做类似的事情（使用构建后任务调用外部程序）。我倾向于相信这是与 jsmin.exe 工具的一些交互或我的其他一些愚蠢的错误。

然而，一切并没有丢失，另一位开发人员将我的注意力转向了 YUI 压缩器及其[在 .NET 中的实现](http://www.codeplex.com/YUICompressor)。通过一些手动 .csproj 操作，我能够实现我的目标，然后实现一些目标（包括 CSS 压缩）！

# .net - 如何在表单的 KeyUp 事件上捕获星号？或者，如何在 KeyUp 事件中获得 KeyChar？

> ID：97270
> 
> 赞同：0
> 
> 时间：2008-09-18T21:38:48.493
> 
> 标签：.net, vb.net

我正在尝试使用表单的 KeyUp 事件劫持星号。我可以在 KeyUp 事件中获取 SHIFT 键和 D8 键，但我无法从中获取 *。我可以在 KeyPress 事件 (e.KeyChar = "*"c) 中轻松找到它，但公司标准规定我们必须在所有此类场合使用 KeyUp 事件。谢谢！

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2008-09-18T21:40:31.797

在 KeyPress 上缓存 charcode，然后响应 KeyUp。还有其他组合键会生成星号，尤其是当您面对的国际用户可能具有不同的键盘布局时，因此您不能依赖 KeyUp 为您提供所需的信息。

# date - Unix gettimeofday() - 用于确定月内周的兼容算法？

> ID：97276
> 
> 赞同：0
> 
> 时间：2008-09-18T21:40:03.437
> 
> 标签：date, time, calendar

如果我从`gettimeofday()`Unix 环境（例如 Linux、BSD）中获得或兼容的 time_t 值，是否有可用的紧凑算法能够告诉我该月内相应的周数？

理想情况下，返回值的工作方式类似于 中的`%W`行为方式`strftime()`，除了给出月份中的周而不是一年中的周。

我认为 Java 有一个`W`格式化标记，它或多或少地像我要求的那样。

* * *

[下面的所有内容都是在 David Nehme、Branan 和 Sparr 发布答案后写的。]

我意识到要以与 类似的方式返回此结果`%W`，我们要计算该月迄今为止发生的星期一的数量。如果该数字为零，则应返回 0。

特别感谢 David Nehme 和 Branan 的解决方案，让事情走上了正轨。返回[使用 Branan 的变量名称] 的代码位`((ts->mday - 1) / 7)`表示当前日期之前已发生的完整周数。

但是，如果我们要计算到目前为止发生的星期一的数量，那么我们要计算包括今天在内的整数周数，然后考虑剩余的小数周是否还包含任何星期一。

为了弄清楚在取出整周后剩下的小数周是否包含星期一，我们需要考虑`ts->mday % 7`并将其与一周中的某一天进行比较，`ts->wday`。如果您写出组合，这很容易看出，但是如果我们确保日期不是星期日 ( `wday > 0`)，那么任何时候`ts->wday <= (ts->mday % 7)`我们都需要将星期一的计数增加 1。这来自于考虑自月，以及根据第一个小数周内的当前日期，小数周是否包含星期一。

所以我会重写 Branan 的 return 语句如下：

`return (ts->tm_mday / 7) + ((ts->tm_wday > 0) && (ts->tm_wday <= (ts->tm_mday % 7)));`

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2008-09-18T21:52:51.907

假设您的第一周是第一周：

```
int getWeekOfMonth()
{
  time_t my_time;
  struct tm *ts;

  my_time = time(NULL);
  ts = localtime(&my_time);

  return ((ts->tm_mday -1) / 7) + 1;
} 
```

对于 0-index，`+1`在 return 语句中删除。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2008-09-18T22:03:57.310

如果您将第一周定义为该月的第 1-7 天，第二周定义为第 8-14 天，......那么以下代码将起作用。

```
int week_of_month( const time_t *my_time)
{
  struct tm *timeinfo;

  timeinfo =localtime(my_time);
  return 1 + (timeinfo->tm_mday-1) / 7;

} 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2008-09-18T22:06:33.047

考虑一下这个伪代码，因为我主要用 C 语法编写它，但假装我可以从其他语言中借用功能（字符串->int 赋值，字符串->时间转换）。适应或扩展您选择的语言。

```
int week_num_in_month(time_t timestamp) {
  int first_weekday_of_month, day_of_month;
  day_of_month = strftime(timestamp,"%d");
  first_weekday_of_month = strftime(timefstr(strftime(timestamp,"%d/%m/01")),"%w");
  return (day_of_month + first_weekday_of_month - 1 ) / 7 + 1;
} 
```

显然，我假设您希望像标准时间函数处理一年中的几周一样处理一个月中的几周，而不是仅处理第 1-7 天、第 8-13 天等。

# .net - 关闭 Visual Studio 中所有选项卡但当前选项卡的键盘快捷键？

> ID：97279
> 
> 赞同：80
> 
> 时间：2008-09-18T21:40:09.427
> 
> 标签：.net, visual-studio, resharper

有谁知道关闭除 Visual Studio 中当前选项卡之外的所有选项卡的键盘快捷键吗？当我们这样做时，关闭所有选项卡的快捷方式？有 Resharper 选项吗？我过去看过，一直没能找到。

* * *

## 回答 #1

> 赞同：94
> 
> 时间：2008-09-18T21:41:33.027

我认为默认情况下没有，但您可以转到工具>选项>环境>键盘并将密钥绑定到 File.CloseAllButThis。

我用`ctrl`+ `alt`+`w`

* * *

## 回答 #2

> 赞同：55
> 
> 时间：2008-10-13T10:36:45.420

默认情况下，该命令`File.CloseAllButThis`没有键盘绑定。不过，您可以自己设置一个，如下所示：

![](https://i.imgur.com/j3ueK.png)

在此示例中，我将在全局范围内映射`CTRL`++到。您可能希望将范围设置为仅文本编辑器。`SHIFT``ALT``W``File.CloseAllButThis`

* * *

`ALT`我使用++`W`关闭所有文档`L`。

这在 Visual Studio 中可用，无需任何特殊插件或配置。它只是使用工具栏助记符。`Window.CloseAllDocuments`如果您希望将其绑定到其他东西，则相应的命令是。

* * *

## 回答 #3

> 赞同：42
> 
> 时间：2014-07-22T19:52:38.263

快速回答：`ALT`+ `-`+`A`

在 Visual Studio 2013 上测试。在要保持打开的窗口上按`ALT`+ `-`，这将打开窗口左上角的菜单，然后按`A`关闭除当前窗口以外的所有窗口。

* * *

## 回答 #4

> 赞同：12
> 
> 时间：2008-09-18T21:47:50.157

默认情况下没有键盘快捷键，但您可以将其绑定到常规环境设置（选项->环境->键盘）中的键盘快捷键，命令是 File.CloseAllButThis。

* * *

## 回答 #5

> 赞同：5
> 
> 时间：2008-09-19T07:56:55.247

如果您发现自己经常使用“关闭除此之外的所有内容”，您还可以尝试工具 \ 选项 \ 环境 \ 文档 \ [x] 重用当前文档窗口（如果已保存）。结合 ReSharper 的最近编辑（ctrl- 或 ctrl-e，具体取决于键盘映射），您可以避免一直打开太多文档，并且仍然可以在最近打开的文件之间快速导航。

* * *

## 回答 #6

> 赞同：4
> 
> 时间：2021-08-27T13:00:46.810

这不是 100% 与原始问题有关，但我最终在这里为 VS Code 寻找此功能。

对于像我这样最终在这里寻找 Visual Studio Code 答案的人，可以选择关闭组中的所有选项卡。我可以在 Mac 上确认这一点，而不是在 Windows 上 100%。

`workbench.action.closeOtherEditors`

[![在此处输入图像描述](https://i.stack.imgur.com/ZikKw.png)](https://i.stack.imgur.com/ZikKw.png)

* * *

## 回答 #7

> 赞同：3
> 
> 时间：2008-09-18T21:49:17.050

Sara Ford 有很多关于 Visual Studio 的类似提示。

这是引用[aaronjensen 所说](https://stackoverflow.com/a/97298)的内容`File.CloseAllButThis`：

[https://docs.microsoft.com/en-us/archive/blogs/saraford/did-you-know-you-can-close-all-but-this-on-files-in-the-file-tab-通道 124](https://docs.microsoft.com/en-us/archive/blogs/saraford/did-you-know-you-can-close-all-but-this-on-files-in-the-file-tab-channel-124)

* * *

## 回答 #8

> 赞同：2
> 
> 时间：2010-07-08T11:05:20.133

为了关闭所有文件：

工具->自定义...->键盘..->环境->键盘

我已经将命令 Window.CloseAllDocuments 映射到`Alt`++`Ctrl``F4`

* * *

## 回答 #9

> 赞同：1
> 
> 时间：2008-09-18T22:38:27.307

我按照[aarojensen 的方法](https://stackoverflow.com/questions/97279/keyboard-shortcut-to-close-all-tabs-but-current-one-in-visual-studio#97298)，但是把它放在文件菜单中（右键单击菜单并选择自定义）。然后`Alt`- `F`-`B`关闭除当前之外的所有内容。

# c# - 如何确定 C# 中当前关注的进程的名称

> ID：97283
> 
> 赞同：9
> 
> 时间：2008-09-18T21:40:19.270
> 
> 标签：c#

例如，如果用户当前正在运行 VS2008，那么我想要值 VS2008。

* * *

## 回答 #1

> 赞同：17
> 
> 时间：2008-09-18T22:09:56.047

我假设您想获取拥有当前焦点窗口的进程的名称。使用一些 P/Invoke：

```
// The GetForegroundWindow function returns a handle to the foreground window
// (the window  with which the user is currently working).
[System.Runtime.InteropServices.DllImport("user32.dll")]
private static extern IntPtr GetForegroundWindow();

// The GetWindowThreadProcessId function retrieves the identifier of the thread
// that created the specified window and, optionally, the identifier of the
// process that created the window.
[System.Runtime.InteropServices.DllImport("user32.dll")]
private static extern Int32 GetWindowThreadProcessId(IntPtr hWnd, out uint lpdwProcessId);

// Returns the name of the process owning the foreground window.
private string GetForegroundProcessName()
{
    IntPtr hwnd = GetForegroundWindow();

    // The foreground window can be NULL in certain circumstances, 
    // such as when a window is losing activation.
    if (hwnd == null)
        return "Unknown";

    uint pid;
    GetWindowThreadProcessId(hwnd, out pid);

    foreach (System.Diagnostics.Process p in System.Diagnostics.Process.GetProcesses())
    {
        if (p.Id == pid)
            return p.ProcessName;
    }

    return "Unknown";
} 
```

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2013-09-27T07:43:15.183

```
using System;
using System.Windows;
using System.Windows.Forms;
using System.Runtime.InteropServices;

namespace FGHook
{
    class ForegroundTracker
    {
        // Delegate and imports from pinvoke.net:

        delegate void WinEventDelegate(IntPtr hWinEventHook, uint eventType,
            IntPtr hwnd, int idObject, int idChild, uint dwEventThread, uint dwmsEventTime);

        [DllImport("user32.dll")]
        static extern IntPtr SetWinEventHook(uint eventMin, uint eventMax, IntPtr
           hmodWinEventProc, WinEventDelegate lpfnWinEventProc, uint idProcess,
           uint idThread, uint dwFlags);

        [DllImport("user32.dll")]
        static extern IntPtr GetForegroundWindow();

        [DllImport("user32.dll")]
        static extern Int32 GetWindowThreadProcessId(IntPtr hWnd, out uint lpdwProcessId);

        [DllImport("user32.dll")]
        static extern bool UnhookWinEvent(IntPtr hWinEventHook);

        // Constants from winuser.h
        const uint EVENT_SYSTEM_FOREGROUND = 3;
        const uint WINEVENT_OUTOFCONTEXT = 0;

        // Need to ensure delegate is not collected while we're using it,
        // storing it in a class field is simplest way to do this.
        static WinEventDelegate procDelegate = new WinEventDelegate(WinEventProc);

        public static void Main()
        {
            // Listen for foreground changes across all processes/threads on current desktop...
            IntPtr hhook = SetWinEventHook(EVENT_SYSTEM_FOREGROUND, EVENT_SYSTEM_FOREGROUND, IntPtr.Zero,
                    procDelegate, 0, 0, WINEVENT_OUTOFCONTEXT);

            // MessageBox provides the necessary mesage loop that SetWinEventHook requires.
            MessageBox.Show("Tracking focus, close message box to exit.");

            UnhookWinEvent(hhook);
        }

        static void WinEventProc(IntPtr hWinEventHook, uint eventType,
            IntPtr hwnd, int idObject, int idChild, uint dwEventThread, uint dwmsEventTime)
        {
            Console.WriteLine("Foreground changed to {0:x8}", hwnd.ToInt32());
            //Console.WriteLine("ObjectID changed to {0:x8}", idObject);
            //Console.WriteLine("ChildID changed to {0:x8}", idChild);
            GetForegroundProcessName();

        }
        static void GetForegroundProcessName()
        {
            IntPtr hwnd = GetForegroundWindow();

            // The foreground window can be NULL in certain circumstances, 
            // such as when a window is losing activation.
            if (hwnd == null)
                return;

            uint pid;
            GetWindowThreadProcessId(hwnd, out pid);

            foreach (System.Diagnostics.Process p in System.Diagnostics.Process.GetProcesses())
            {
                if (p.Id == pid)
                {
                    Console.WriteLine("Pid is: {0}",pid);
                    Console.WriteLine("Process name is {0}",p.ProcessName);
                    return;
                }
                //return;
            }

             Console.WriteLine("Unknown");
        }
    }
} 
```

# linq - LINQ 格式异常

> ID：97293
> 
> 赞同：1
> 
> 时间：2008-09-18T21:41:01.610
> 
> 标签：linq, linq-to-sql, exception

我目前有一个现有的数据库，我正在使用 LINQtoSQL 生成器工具为我创建类。该工具对该数据库运行良好，并且该工具没有错误。
当我对数据运行 LINQ to SQL 查询时，有一行在表中以某种方式包含一些无效数据，并且当它在该行中运行时抛出 System.FormatException。有谁知道这源于什么？有谁知道如何在不将它们一一添加到 select 子句的情况下缩小影响列的范围？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2008-09-18T21:44:24.283

你有存储空字符串的 varchar(1) 吗？

您需要在设计器中将类型从 char 更改为 string（或以某种方式禁止清空）。.net char 类型不能包含空字符串。

# visual-studio - VB6安装VS2005后失去F1帮助功能，重新安装MSDN2001无效

> ID：97305
> 
> 赞同：2
> 
> 时间：2008-09-18T21:42:30.933
> 
> 标签：visual-studio, vb6, msdn

安装 VS2005 VB6 后，F1 功能丢失到 MSDN Oct/2001 lib。

重新安装 MSDN 的建议不起作用。

F1 现在唯一的工作是 VB6 中的 ADO 语句。示例 ado1.recordset.recordcount 如果我突出显示记录计数并按 F1，我会得到 ADO 帮助信息。如果我突出显示“记录集”，则会出现“未找到帮助”对话框。

与任何常规 VB 工具属性相同。lblEvent.Caption 尝试查找有关说字幕的帮助时出错。如果我在 for next 循环中突出显示 Next，我会得到一个想要知道的对话框……已找到所选单词的多个实例。请选择一个主题并按帮助。在这种情况下，VBA 是一个，Excel 是一个 MSComctlLib 是一个。如果我在语句中突出显示 FOR，我会再次收到“Help Not Found”错误。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2008-10-24T15:37:04.813

这发生在我更新 Windows 之后，或者可能是 XP 服务包之一。卸载修补程序 896358 解决了我的问题。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2008-09-18T22:23:00.307

这发生在我身上一次。我唯一能做的就是完全重新安装VB6（不是由安装VS2005引起的，而是安装一个将自己的文档添加到帮助的组件）。可能不是你想听到的。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-09-27T05:24:04.813

类似的事情发生在我身上，试图编译一个 vb6 dll 不起作用。原来在后台安装了一个更新，我需要重新启动它才能让我再次编译它。

# c# - 如何找出我的控制台应用程序在哪个目录中运行？

> ID：97312
> 
> 赞同：99
> 
> 时间：2008-09-18T21:43:30.480
> 
> 标签：c#, .net, console-application

如何使用 C# 找出我的控制台应用程序在哪个目录中运行？

* * *

## 回答 #1

> 赞同：174
> 
> 时间：2008-09-18T21:45:45.560

要获取 .exe 文件所在的目录：

```
AppDomain.CurrentDomain.BaseDirectory 
```

获取当前目录：

```
Environment.CurrentDirectory 
```

* * *

## 回答 #2

> 赞同：15
> 
> 时间：2008-09-18T22:06:06.430

根据授予应用程序的权限、卷[影复制](http://msdn.microsoft.com/en-us/library/ms404279.aspx)是否有效以及其他调用和部署选项，不同的方法可能会起作用或产生不同的结果，因此您必须明智地选择武器。话虽如此，对于在其所在机器上本地执行的完全受信任的控制台应用程序，以下所有内容都将产生相同的结果：

```
Console.WriteLine( Assembly.GetEntryAssembly().Location );
Console.WriteLine( new Uri(Assembly.GetEntryAssembly().CodeBase).LocalPath );
Console.WriteLine( Environment.GetCommandLineArgs()[0] );
Console.WriteLine( Process.GetCurrentProcess().MainModule.FileName ); 
```

您需要查阅上述成员的文档以查看所需的确切权限。

* * *

## 回答 #3

> 赞同：5
> 
> 时间：2010-03-02T18:34:12.850

Path.GetDirectoryName(Assembly.GetExecutingAssembly().Location)

* * *

## 回答 #4

> 赞同：3
> 
> 时间：2008-09-18T21:47:26.803

在 .NET 中，您可以使用它`System.Environment.CurrentDirectory`来获取启动进程的目录。
`System.Reflection.Assembly.GetExecutingAssembly().Location`将告诉您当前正在执行的程序集的位置（仅当当前执行的程序集是从与进程开始的程序集位置不同的位置加载时才有意义）。

* * *

## 回答 #5

> 赞同：2
> 
> 时间：2019-10-24T18:48:21.673

假设您的 .Net 核心控制台应用程序项目名称是 DataPrep。

获取项目基础目录：

```
Console.WriteLine(Environment.CurrentDirectory); 
```

**输出：** ~DataPrep\bin\Debug\netcoreapp2.2

```
Get Project .csproj file directory:
string ProjectDirPath = Path.GetFullPath(Path.Combine(Environment.CurrentDirectory, @"..\..\..\"));
Console.WriteLine(ProjectDirPath); 
```

**输出：** ~DataPrep\

* * *

## 回答 #6

> 赞同：1
> 
> 时间：2008-09-18T21:45:43.080

在 Windows 上（不确定 Unix 等），它是命令行中的第一个参数。

在 C/C++ 中，argv* 中的第一个项目

WinAPI - GetModuleFileName(NULL, char*, MAX_PATH)

* * *

## 回答 #7

> 赞同：1
> 
> 时间：2009-02-19T05:22:04.517

应用程序.StartUpPath;

* * *

## 回答 #8

> 赞同：0
> 
> 时间：2020-07-31T04:46:50.513

用于`AppContext.BaseDirectory`.net5。

# c# - WCF 错误和异常

> ID：97324
> 
> 赞同：6
> 
> 时间：2008-09-18T21:44:51.380
> 
> 标签：c#, wcf, validation, exception

我是第一次编写 WCF 服务。该服务及其所有客户端（至少目前是这样）都是用 C# 编写的。该服务必须对其传递的数据进行大量输入验证，因此我需要有一些方法将无效数据指示回客户端。我已经阅读了很多关于故障和异常、将异常包装在故障中的文章，以及许多让我更加困惑的相互冲突的文章。处理这种情况的正确方法是什么？

我应该完全避免异常并打包结果返回消息吗？我应该创建一个特殊的故障，还是一个特殊的异常，或者像我为非 WCF 验证函数那样抛出 ArgumentExceptions？

我现在拥有的代码（受[MSDN](http://msdn.microsoft.com/en-us/library/ms733841.aspx)影响）是：

```
[DataContract]
public class ValidationFault
{
    [DataMember]
    public Dictionary<string, string> Errors { get; private set; }

    [DataMember]
    public bool Fatal { get; private set; }

    [DataMember]
    public Guid SeriesIdentifier { get; private set; }

    public ValidationFault(Guid id, string argument, string error, bool fatal)
    {
        SeriesIdentifier = id;
        Errors = new Dictionary<string, string> {{argument, error}};
        Fatal = fatal;
    }

    public void AddError(string argument, string error, bool fatal)
    {
        Errors.Add(argument, error);
        Fatal |= fatal;
    }
} 
```

在方法上有 [FaultContract(typeof(ValidationFault))]。那么这是解决这个问题的“正确”方法吗？

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2008-09-22T12:42:40.487

从 WCF 服务中抛出异常没有用 为什么不呢？因为它作为一个简单的错误回来，你需要

a) 设置故障以包含异常

b) 解析故障以获取异常的文本并查看发生了什么。

所以是的，你需要一个错误而不是一个例外。在您的情况下，我会创建一个自定义故障，其中包含作为故障合同的一部分未能通过验证的字段列表。

请注意，WCF 使用不是 ISerializable 的字典做了一些有趣的事情；它有特殊处理，所以检查返回的消息在网络上看起来不错；如果不是，它会为您返回数组。

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2008-09-18T22:33:44.027

如果您在客户端上进行验证，并且一旦将它们传递给方法（Web 服务调用）就应该具有有效值，那么我会抛出异常。这可能是一个异常，表明参数名称无效。（请参阅：参数异常）

但是您可能不想依赖客户端来正确验证数据，这会让您假设数据可能无效进入 Web 服务。在那种情况下，它并不是真正的例外情况，也不应该是例外。在这种情况下，您可以返回一个枚举或一个 Result 对象，它的 Status 属性设置为一个枚举（OK、Invalid、Incomplete）和一个带有细节的 Message 属性，例如参数的名称。

我会确保在开发过程中发现并修复这些类型的错误。您的 QA 流程应仔细测试客户端的有效和无效使用，并且您不希望将这些技术消息转发回客户端。相反，您想要做的是更新您的验证系统，以防止无效数据进入服务调用。

我对任何 WCF 服务的假设是会有多个 UI。现在一个可能是 Web UI，但稍后我可能会使用 WinForms、WinCE 甚至是不符合您对 .NET 客户端的期望的本机 iPhone/Android 移动应用程序添加另一个。

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2008-09-22T12:30:52.933

您可能想看看 MS Patterns and Practices Enterprise Library Validation 块以及策略注入块[链接文本](http://www.codeplex.com/entlib)，它允许您使用验证属性装饰数据合同成员并装饰服务实现，以及它的集成对于 WCF，这意味着验证失败会自动返回为 ArgumentValidationException 错误，每个错误都包含每个验证失败的 ValidationDetail 对象。

将 entlib 与 WCf 一起使用，您可以获得大量验证、错误报告，而无需编写太多代码

# c# - 从字符串成员的条件匹配的集合中查找对象的最快方法

> ID：97329
> 
> 赞同：1
> 
> 时间：2008-09-18T21:45:39.693
> 
> 标签：c#, arrays, string, collections, performance

假设我有一个特定类的集合（可以是数组、通用列表或任何**最快**解决此问题的方法），我们称之为`ClassFoo`：

```
class ClassFoo
{
    public string word;
    public float score;
    //... etc ...
} 
```

假设集合中将有 50.000 个项目，全部在内存中。现在我想尽可能快地获取集合中遵守其 bar 成员条件的所有实例，例如：

```
List<ClassFoo> result = new List<ClassFoo>();
foreach (ClassFoo cf in collection)
{
    if (cf.word.StartsWith(query) || cf.word.EndsWith(query))
        result.Add(cf);
} 
```

如何尽快获得结果？我应该考虑一些高级索引技术和数据结构吗？

此问题的应用程序域是一个自动完成器，它获取查询并作为结果提供一组建议。假设条件没有比这更复杂。还假设会有很多搜索。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2008-09-18T22:13:14.887

由于条件子句可以是“任何东西”的约束，您只能扫描整个列表并应用条件。

如果条件子句有限制，那么您可以考虑组织数据以更有效地处理查询。

例如，带有“byFirstLetter”字典的代码示例对“endsWith”查询根本没有帮助。

因此，这实际上归结为您要对这些数据进行哪些查询。

在数据库中，这个问题是“查询优化器”的负担。在典型的数据库中，如果您有一个没有索引的数据库，那么显然每个查询都将是一次表扫描。当您向表中添加索引时，优化器可以使用该数据来制定更复杂的查询计划以更好地获取数据。这本质上就是您所描述的问题。

一旦您有了更具体的查询类型子集，您就可以更好地决定哪种结构是最好的。此外，您需要考虑数据量。如果您有一个包含 10 个元素的列表，每个元素都小于 100 字节，那么扫描所有内容可能是您可以做的最快的事情，因为您的数据量如此之少。显然，这不能扩展到 1M 元素，但即使是聪明的访问技术也会在设置、维护（如索引维护）和内存方面产生成本。

**编辑**，根据评论

如果它是自动完成器，如果数据是静态的，则对其进行排序并使用二进制搜索。你真的不会比这更快。

如果数据是动态的，则将其存储在平衡树中并进行搜索。这实际上是一种二分搜索，它可以让您随机添加数据。

其他任何东西都是对这些概念的一些专业化。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2008-09-18T21:48:11.920

var Answers = myList.Where(item => item.bar.StartsWith(query) || item.bar.EndsWith(query));

我认为这是最简单的，应该执行得相当快。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2008-09-18T21:49:03.057

不确定我是否理解...您真正能做的就是优化规则，这是需要最快的部分。如果不投入更多硬件，就无法加速循环。

如果您有多个内核或机器，您可以并行化。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2008-09-18T21:56:30.353

我现在不熟悉我的 Java，但我会考虑以下事情。

你是如何创建你的列表的？也许您可以通过一种减少比较时间的方式创建它已经排序。

如果您只是在集合中进行直接循环，则将其存储为数组或链表之间不会有太大区别。

对于存储结果，取决于您收集它们的方式，结构可能会有所不同（但假设 Java 的通用结构是智能的，它不会）。正如我所说，我没有使用我的 Java，但我认为通用链表会保留一个尾指针。在这种情况下，它不会真正有所作为。对底层数组与链表实现以及它最终如何查看字节码有更多了解的人可能会告诉您使用尾指针附加到链表或插入数组是否更快（我的猜测是数组）。另一方面，如果您想使用数组，您将需要知道结果集的大小或牺牲一些存储空间并使其与您正在迭代的整个集合一样大。

通过找出最有可能是真的比较来优化您的比较查询并首先进行比较也可能会有所帮助。即：如果集合的成员通常有 10% 的时间以您的查询开始，而成员有 30% 的时间以查询结束，那么您可能希望先进行结束比较。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2008-09-18T21:56:43.443

对于您的特定示例，对集合进行排序会有所帮助，因为您可以 binarychop 到以查询开头的第一个项目，并在您到达下一个没有的项目时提前终止；您还可以生成一个指向集合项目的指针表，该表按第二个子句的每个字符串的倒序排序。

一般来说，如果你事先知道查询的结构，你可以适当地对你的集合进行排序（或者如果有多个子句，则为你的集合构建几个排序索引）；如果你不这样做，你将无法比线性搜索做得更好。

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2008-09-18T21:59:35.603

如果它是您填充列表一次然后进行多次查找（数千或更多）的地方，那么您可以创建某种查找字典，该字典将以值开头/结尾映射到它们的实际值。这将是一个快速查找，但会使用更多的内存。如果您没有进行那么多查找或知道您将至少半频繁地重新填充列表，我会使用 CQ 建议的 LINQ 查询。

* * *

## 回答 #7

> 赞同：0
> 
> 时间：2008-09-18T22:01:36.490

您可以创建某种索引，它可能会变得更快。

我们可以像这样构建一个索引：

```
Dictionary<char, List<ClassFoo>> indexByFirstLetter;
foreach (var cf in collection) {
  indexByFirstLetter[cf.bar[0]] = indexByFirstLetter[cf.bar[0]] ?? new List<ClassFoo>();
  indexByFirstLetter[cf.bar[0]].Add(cf);
  indexByFirstLetter[cf.bar[cf.bar.length - 1]] = indexByFirstLetter[cf.bar[cf.bar.Length - 1]] ?? new List<ClassFoo>();
  indexByFirstLetter[cf.bar[cf.bar.Length - 1]].Add(cf);
} 
```

然后像这样使用它：

```
foreach (ClasssFoo cf in indexByFirstLetter[query[0]]) {
  if (cf.bar.StartsWith(query) || cf.bar.EndsWith(query))
    result.Add(cf);
} 
```

现在我们可能不必像您的示例中那样循环遍历尽可能多的 ClassFoo，但是我们必须再次保持索引是最新的。不能保证它更快，但它肯定更复杂。

* * *

## 回答 #8

> 赞同：0
> 
> 时间：2008-09-18T22:21:16.473

依靠。你所有的对象总是要加载到内存中吗？您是否有可以加载的对象的有限限制？您的查询是否必须考虑尚未加载的对象？

如果集合变大，我肯定会使用索引。

事实上，如果集合可以增长到任意大小并且您不确定是否能够将其全部放入内存中，我会研究 ORM、内存数据库或其他嵌入式数据库。我想到了来自 DevExpress 的用于 ORM 的 XPO 或用于内存数据库的 SQLite.Net。

如果您不想走这么远，请创建一个简单的索引，其中包含映射到类引用的“bar”成员引用。

* * *

## 回答 #9

> 赞同：0
> 
> 时间：2008-09-19T22:06:41.157

如果可能的标准集是固定的且很小，您可以为列表中的每个元素分配一个位掩码。位掩码的大小是标准集的大小。当您创建一个元素/将其添加到列表中时，您检查它满足哪些条件，然后在该元素的位掩码中设置相应的位。匹配列表中的元素就像将它们的位掩码与目标位掩码匹配一样容易。更通用的方法是布隆过滤器。

# c++ - 为不同的输出目录生成 GCC 依赖项

> ID：97338
> 
> 赞同：23
> 
> 时间：2008-09-18T21:46:56.073
> 
> 标签：c++, gcc, makefile, dependencies

我正在使用 GCC 生成依赖文件，但我的构建规则将输出放入子目录中。有没有办法告诉 GCC 将我的子目录前缀放在它为我生成的依赖文件中？

```
gcc $(INCLUDES) -E -MM $(CFLAGS) $(SRC) >>$(DEP) 
```

* * *

## 回答 #1

> 赞同：44
> 
> 时间：2010-01-11T23:20:53.320

我假设您使用的是 GNU Make 和 GCC。首先添加一个变量来保存您的依赖文件列表。假设您已经有一个列出我们所有来源的文件：

```
SRCS = \
        main.c \
        foo.c \
        stuff/bar.c

DEPS = $(SRCS:.c=.d) 
```

然后在 makefile 中包含生成的依赖项：

```
include $(DEPS) 
```

然后添加此模式规则：

```
# automatically generate dependency rules

%.d : %.c
        $(CC) $(CCFLAGS) -MF"$@" -MG -MM -MP -MT"$@" -MT"$(<:.c=.o)" "$<"

# -MF  write the generated dependency rule to a file
# -MG  assume missing headers will be generated and don't stop with an error
# -MM  generate dependency rule for prerequisite, skipping system headers
# -MP  add phony target for each header to prevent errors when header is missing
# -MT  add a target to the generated dependency 
```

“$@” 是目标（: 左边的东西），“$<” 是先决条件（: 右边的东西）。表达式“$(<:.c=.o)”将 .c 扩展名替换为 .o。

这里的技巧是通过两次添加 -MT 来生成具有两个目标的规则；这使得 .o 文件和 .d 文件都依赖于源文件及其头文件；这样，每当更改任何相应的 .c 或 .h 文件时，依赖文件就会自动重新生成。

如果缺少头文件，-MG 和 -MP 选项可以防止 make 崩溃。

* * *

## 回答 #2

> 赞同：21
> 
> 时间：2008-09-19T03:27:25.940

答案在[GCC 手册](http://gcc.gnu.org/onlinedocs/gcc-4.3.2/cpp/Invocation.html)中：使用`-MT`标志。

> `-MT target`
> 
> 更改依赖生成发出的规则的目标。默认情况下，CPP 采用主输入文件的名称，删除任何目录组件和任何文件后缀，例如`.c`，并附加平台常用的对象后缀。结果就是目标。
> 
> 一个`-MT`选项会将目标设置为您指定的字符串。如果需要多个目标，可以将它们指定为 的单个参数`-MT`，或使用多个`-MT`选项。
> 
> 例如，`-MT '$(objpfx)foo.o'`可能会给
> 
> ```
> $(objpfx)foo.o: foo.c 
> ```

* * *

## 回答 #3

> 赞同：12
> 
> 时间：2013-06-06T18:06:20.923

[您可能会喜欢Don McCaughey 回答的](https://stackoverflow.com/questions/97338/gcc-dependency-generation-for-a-different-output-directory/2045668#2045668)简短版本：

```
SRCS = \
    main.c \
    foo.c \
    stuff/bar.c 
```

`DEPS = $(SRCS:.c=.d)`

添加`-include $(DEPS)`注意前缀，如果文件尚不存在`-`，它将消除错误。`.d`

不需要单独的模式规则来生成依赖文件。只需将`-MD`或添加`-MMD`到您的正常编译行，`.d`文件就会在编译源文件的同时生成。例如：

```
%.o: %.c
     gcc $(INCLUDE) -MMD -c $< -o $@

# -MD can be used to generate a dependency output file as a side-effect of the compilation process. 
```

* * *

## 回答 #4

> 赞同：3
> 
> 时间：2014-06-09T21:52:15.883

详细说明[DGentry 的答案](https://stackoverflow.com/questions/97338/gcc-dependency-generation-for-a-different-output-directory/97374#97374)，这对我来说效果很好：

```
.depend: $(SOURCES)
    $(CC) $(CFLAGS) -MM $(SOURCES) | sed 's|[a-zA-Z0-9_-]*\.o|$(OBJDIR)/&|' > ./.depend 
```

这也适用于只有一个依赖文件包含所有源文件的依赖规则的情况。

* * *

## 回答 #5

> 赞同：2
> 
> 时间：2008-09-18T22:38:41.063

好的，只是为了确保我的问题是正确的：我假设你有`test.c`which contains `test.h`，并且你想生成`subdir/test.d`（而*不是*生成`subdir/test.o`） where `subdir/test.d`contains

```
subdir/test.o: test.c test.h 
```

而不是

```
test.o: test.c test.h 
```

这就是你现在得到的。是对的吗？

我无法想出一种简单的方法来完全按照您的要求进行操作。但是，查看*[Dependency Generation Improvements](http://www.gnu.org/software/gcc/news/dependencies.html)*，如果要在`.d`生成 .o 文件时创建文件，可以使用：

```
gcc $(INCLUDES) -MMD $(CFLAGS) $(SRC) -o $(SUBDIR)/$(OBJ) 
```

（给定`SRC=test.c`、`SUBDIR=subdir`和`OBJ=test.o`。）这将创建 subdir/test.o 和 subdir/test.d，其中`subdir/test.d`包含上述所需的输出。

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2008-09-18T21:52:21.863

如果 GCC 有理由这样做，我不知道它是什么。我们最终通过[sed](http://en.wikipedia.org/wiki/Sed)管道依赖输出来重写所有出现的`<blah>.o`as `${OBJDIR}/<blah>.o`。

* * *

## 回答 #7

> 赞同：0
> 
> 时间：2008-09-18T23:10:51.143

1.  如果您不将输出放在当前目录中，[GNU] make 会生气。您应该真正从构建目录运行 make，并使用 VPATH make 变量来定位源代码。如果你对编译器撒谎，它迟早会报复。

2.  如果您坚持在其他目录中生成对象和依赖项，则需要使用`-o`参数，正如[Emile 所回答的那样](https://stackoverflow.com/questions/97338/gcc-dependency-generation-for-a-different-output-directory/97710#97710)。

# .net-2.0 - MessageBox 在最大化的 MDI 形式中失去焦点

> ID：97344
> 
> 赞同：3
> 
> 时间：2008-09-18T21:47:43.107
> 
> 标签：.net-2.0, mdi, messagebox

我有一个 MDI 应用程序（用 .NET 2.0 编写），它允许用户打开多个子窗体。子窗体总是在 MDI 父窗体中最大化。当 MDI 父级最大化并且我尝试执行 MessageBox.Show 时，MessageBox 不显示。如果我执行 alt-tab（或者甚至只是按 alt），MessageBox 会弹出到前面。

有什么想法可以让那个傻瓜一开始就出现吗？

这只是在最大化 MDI 父级时出现的问题......

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2008-09-18T23:23:33.813

尝试使用 [MessageBox.Show(Window owner, string message, string caption)](http://msdn.microsoft.com/en-us/library/ms598681.aspx) 将 MDI 应用程序设置为所有者，以便 MB 显示在前面

啊，您还应该在帖子中添加一些标签。

# tfs - TFSBuild.proj 和导入外部目标

> ID：97349
> 
> 赞同：7
> 
> 时间：2008-09-18T21:48:17.520
> 
> 标签：tfs, msbuild, tfsbuild

我们希望将覆盖的构建目标存储在外部文件中，并将该目标文件包含在 TFSBuild.proj 中。我们有一组核心步骤发生，并且希望通过简单地将导入行添加到向导创建的 TFSBuild.proj 来获得这些额外的步骤。

```
<Import Project="$(SolutionRoot)/libs/my.team.build/my.team.build.targets"/> 
```

我们无法对 中的任何文件进行导入，`$(SolutionRoot)`因为在验证 Import 语句时，尚未从存储库中获取源。看起来 TFS 正在拉下第`TFSBuild.proj`一个没有任何其他文件的文件。

即使我们添加条件导入，如果存在源代码管理中的版本，也不会被导入。将导入磁盘上已存在的先前版本。

我们可以放弃将这些构建目标与我们的源代码一起存储，但它是第一个从源代码树中移出的依赖项，因此我们不愿意这样做。

有没有办法：

1.  告诉 Team Build 拉下更多文件，以便`Import`正确评估这些语句？
2.  以除?`AfterCompile`之外的方式覆盖那些 Team Build 目标。`Import`
3.  最终在 Team Build 中运行构建目标，这些目标保存在它试图构建的源代码下？

* * *

## 回答 #1

> 赞同：16
> 
> 时间：2008-09-19T08:29:34.077

Team Build 有一个“引导”阶段，其中 Team Build Configuration 文件夹（包含 TFSBuild.proj 的文件夹）中的所有内容都是从版本控制下载的。这是在构建代理调用 MSBuild.exe 告诉它运行 TFSBuild.proj 之前由构建代理执行的。

如果您从 SolutionRoot 下移动目标文件并将其放在 TFSBuild.proj 文件旁边的配置文件夹中，您将能够使用相对导入语句将其导入 TFSBuild.proj 文件，即

```
<Import Project="myTeamBuild.targets"/> 
```

如果这些目标依赖于任何其他自定义 MSBuild 任务程序集，那么您也可以将它们放在与 TFSBuild.proj 文件相同的文件夹中，并且可以使用相对路径轻松引用它们。

请注意，在 TFS2008 中，构建配置文件夹默认位于 $/TeamProject/TeamBuildTypes 下，但它不必在那里。它实际上可以存在于您的解决方案内的文件夹中 - 甚至可以是您的解决方案中专门用于 Team Build 的项目。这有几个优点，包括使构建的分支更容易。因此，我通常将我的构建放在这样的文件夹中：

```
$/TeamProject/main/MySolution/TeamBuild 
```

另请注意，默认情况下，在构建的引导阶段，构建代理只会下载构建配置文件夹中的文件，不会递归到任何子文件夹中。如果您希望它在引导阶段包含子文件夹中的文件，那么您可以在构建代理机器上的 tfsbuildserver.exe.config 文件的 appSettings 中设置以下属性（位于 %ProgramFiles%\Visual Studio 9.0\Common7\IDE \私人组件）

```
<add key="ConfigurationFolderRecursionType" value="Full" /> 
```

请注意，如果您有多个构建代理，您必须记住在所有机器上设置此设置，它会影响该构建代理执行的每个构建 - 所以实际上最好将文件保留在根目录中如果可以的话，构建配置文件夹。

祝你好运，

马丁。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2008-09-18T22:05:32.643

如果只应在 TFS 运行构建而不是在本地开发机器上运行目标，则可以将目标文件放在构建本身的文件夹中并通过以下方式引用它：

```
<Import Project="$(MSBuildProjectDirectory)\my.team.build.targets.proj" /> 
```

但是，如果您希望目标为所有构建运行，您可以设置它，以便各个项目通过添加以下内容来引用它：

```
<Import Project="$(SolutionRoot)/libs/my.team.build/my.team.build.targets" Condition="Exists('$(SolutionRoot)/libs/my.team.build/my.team.build.targets')" /> 
```

在我的项目中，我们实际上使用了这两者，第一个允许我们自定义夜间构建，以便我们可以在运行完整解决方案编译之前和之后执行额外的步骤，第二个允许逐个项目自定义。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2008-09-19T05:32:35.563

如果您创建要导入的覆盖目标文件并将其命名为 TeamBuildOverrides.targets 之类的名称，并将其放在源代码控制中 TFSBuild.proj 为您的构建类型所在的同一文件夹中，它将首先被拉取并可以导入到 TFSBuild .proj 文件。默认情况下，TFSBuild.proj 文件会直接添加到项目根文件夹下的源代码管理中的 TeamBuildTypes 文件夹中。

在 TFSBuild.proj 文件中使用以下导入语句：

```
<Import Project="$(MSBuildProjectDirectory)\TeamBuildOverrides.targets" /> 
```

确保您的 TFSBuild.proj 文件中没有任何重复的覆盖，否则导入的覆盖将不会被触发。

# vba - 在 Word 中自动运行宏 OnSave

> ID：97370
> 
> 赞同：1
> 
> 时间：2008-09-18T21:52:05.233
> 
> 标签：vba, ms-word, ms-office

我有一个宏可以刷新文档中的所有字段（相当于`F9`对字段执行操作）。我想在用户保存文档时自动触发这个宏。

在选项下，我可以选择“打印文档时更新字段”，但这不是我想要的。在 VBA 编辑器中，我似乎只找到事件的`Document_Open()`事件，而不是`Document_Save()`事件。

用户保存文档时是否可以触发宏？

请注意：

1.  这是 Word 97。我知道在更高版本的 Word 中是可能的
2.  我不想用一个按钮替换工具栏上的标准保存按钮来运行我的自定义宏。替换工具栏上的按钮适用于所有文档，我只希望它影响这个文档。

为了理解我为什么需要这个，文档包含一个“SaveDate”字段，我希望当用户单击“保存”时该字段在屏幕上更新。因此，如果您可以提出另一种方法来实现这一目标，那也一样好。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2008-09-18T22:17:10.103

就我所记得的 Word 97 而言，你很不走运。97 年唯一的文档事件是打开和关闭。

我没有可用的 Word 97，但在 Word 2000+ 中，您可以设置一个读取文档属性的字段。你可以检查一下。在 Word 2003 中，它位于**Insert > Field...**下，您要查找的名称为**SaveDate**。

编辑：呃。你已经知道了。误解了你的问题。道歉。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2008-11-26T18:50:18.197

是的，fencliff 是对的，你对 Word 97 不走运。

如果升级不是一个选项，我唯一想到的就是使用计时器轮询文件的最后修改时间。我知道这很丑，但是您不会收到事件，也没有可以覆盖的 Word 命令。

# batch-file - 如何编写 Windows 批处理脚本以从目录中复制最新文件？

> ID：97371
> 
> 赞同：73
> 
> 时间：2008-09-18T21:52:05.343
> 
> 标签：batch-file, forfiles

我需要将目录中的最新文件复制到新位置。到目前为止，我已经找到了有关[forfiles](http://www.ss64.com/nt/forfiles.html)命令的资源、一个[与日期相关的问题](https://stackoverflow.com/q/51837)here 和另一个[相关的问题](https://stackoverflow.com/q/50902)。我只是有一点麻烦把碎片放在一起！如何将该目录中的最新文件复制到新位置？

* * *

## 回答 #1

> 赞同：137
> 
> 时间：2009-06-10T21:32:12.100

接受的答案给出了在命令中使用最新文件然后退出的示例。如果您需要在具有其他复杂操作的 bat 文件中执行此操作，您可以使用以下内容将最新文件的文件名存储在变量中：

```
FOR /F "delims=" %%I IN ('DIR "*.*" /A-D /B /O:D') DO SET "NewestFile=%%I" 
```

现在您可以参考`%NewestFile%`整个 bat 文件的其余部分。

例如，这是我们用来从目录中获取最新版本的数据库 .bak 文件，将其复制到服务器，然后恢复数据库的方法：

```
:Variables
SET DatabaseBackupPath=\\virtualserver1\Database Backups

echo.
echo Restore WebServer Database
FOR /F "delims=|" %%I IN ('DIR "%DatabaseBackupPath%\WebServer\*.bak" /B /O:D') DO SET NewestFile=%%I
copy "%DatabaseBackupPath%\WebServer\%NewestFile%" "D:\"

sqlcmd -U <username> -P <password> -d master -Q ^
"RESTORE DATABASE [ExampleDatabaseName] ^
FROM  DISK = N'D:\%NewestFile%' ^
WITH  FILE = 1,  ^
MOVE N'Example_CS' TO N'C:\Program Files\Microsoft SQL Server\MSSQL.1\MSSQL\Example.mdf',  ^
MOVE N'Example_CS_log' TO N'C:\Program Files\Microsoft SQL Server\MSSQL.1\MSSQL\Example_1.LDF',  ^
NOUNLOAD,  STATS = 10" 
```

* * *

## 回答 #2

> 赞同：69
> 
> 时间：2008-09-18T22:48:39.620

Windows 外壳，一个衬里：

```
FOR /F "delims=" %%I IN ('DIR *.* /A-D /B /O:-D') DO COPY "%%I" <<NewDir>> & EXIT 
```

* * *

## 回答 #3

> 赞同：11
> 
> 时间：2011-02-22T18:56:07.440

为了允许它使用空格处理文件名，需要接受答案的修改版本：

```
FOR /F "delims=" %%I IN ('DIR . /B /O:-D') DO COPY "%%I" <<NewDir>> & GOTO :END
:END 
```

* * *

## 回答 #4

> 赞同：6
> 
> 时间：2014-11-19T23:12:36.913

```
@echo off
set source="C:\test case"
set target="C:\Users\Alexander\Desktop\random folder"

FOR /F "delims=" %%I IN ('DIR %source%\*.* /A:-D /O:-D /B') DO COPY %source%\"%%I" %target% & echo %%I & GOTO :END
:END
TIMEOUT 4 
```

我尝试从文件夹中复制最新文件

只需设置您的源和目标文件夹，它应该可以工作

这个忽略文件夹，只关心文件

建议您在 DIR 路径中选择文件类型，例如更改`*.*`为`*.zip`

我认为TIMEOUT在winXP上不起作用

* * *

## 回答 #5

> 赞同：3
> 
> 时间：2008-09-18T21:57:27.187

我知道你要求 Windows 但我想我还是会添加这个，在 Unix/Linux 中你可以这样做：

```
cp `ls -t1 | head -1` /somedir/ 
```

它将列出当前目录中按修改时间排序的所有文件，然后将最新的 cp 到 /somedir/

* * *

## 回答 #6

> 赞同：2
> 
> 时间：2008-09-18T21:58:50.833

这将打开第二个 cmd.exe 窗口。如果您希望它消失，请将 /K 替换为 /C。

显然，将 new_file_loc 替换为您的新文件位置。

```
@echo off
for /F %%i in ('dir /B /O:-D *.txt') do (
    call :open "%%i"
    exit /B 0
)
:open
    start "window title" "cmd /K copy %~1 new_file_loc"
exit /B 0 
```

* * *

## 回答 #7

> 赞同：2
> 
> 时间：2011-06-29T17:39:18.163

@克里斯·诺伊

> 请注意，& 前面的空格成为上一个命令的一部分。这让我对 SET 感到厌烦，它很乐意将尾随空格放入值中。

要绕过添加到环境变量的尾随空格，请将 set 命令包装在括号中。

例如`FOR /F %%I IN ('DIR "*.*" /B /O:D') DO (SET NewestFile=%%I)`

* * *

## 回答 #8

> 赞同：0
> 
> 时间：2021-07-04T09:40:15.087

将最近的文件`date`从一个目录复制到另一个目录

```
echo off
rem copying latest file with current date from one folder to another folder
cls
echo Copying files. Please wait...
:: echo Would you like to do a copy?
rem pause
for /f "tokens=1-4 delims=/ " %%i in ("%date%") do (
     set dow=%%i
     set month=%%j
     set day=%%k
     set year=%%l
)
:: Pad digits with leading zeros e.g Sample_01-01-21.csv
    set yy=%year:~-2%
:: Alternate way - set datestr=%date:~0,2%-%date:~3,2%-%date:~6,2%
set datestr=%day%-%month%-%yy%
:: echo "\\networkdrive\Test\Sample_%datestr%.csv"
rem copy files from src to dest e.g copy <src path> <dest path>
copy "D:\Source\Sample_%datestr%.csv" D:\Destination
echo Completed
rem pause 
```

`Save`上面的代码具有`.bat`文件格式，并根据您的需要更改目录并运行`batch`文件。

* * *

## 回答 #9

> 赞同：-2
> 
> 时间：2008-09-18T22:00:11.843

重击：

```
 find -type f -printf "%T@ %p \n" \
     | sort  \
     | tail -n 1  \
     | sed -r "s/^\S+\s//;s/\s*$//" \
     | xargs -iSTR cp STR newestfile 
```

其中“newestfile”将成为最新文件

或者，你可以做 newdir/STR 或者只是 newdir

分解：

1.  以 {time} {file} 格式列出所有文件。
2.  按时间排序
3.  得到最后一个
4.  从开始/结束切断时间和空白
5.  复制结果值

**重要的**

运行一次后，最新的文件将是您刚刚复制的任何内容：p（假设它们都在同一个搜索范围内）。因此，如果您希望它不止一次地工作，您可能必须调整您复制的文件编号。

# .net - VB.NET 中的产量

> ID：97381
> 
> 赞同：66
> 
> 时间：2008-09-18T21:53:22.140
> 
> 标签：.net, vb.net

C# 有一个叫做[yield](http://msdn.microsoft.com/en-us/library/9k7k7cf0(VS.80).aspx)的关键字。VB.NET 缺少这个关键字。Visual Basic 程序员如何解决缺少这个关键字的问题？他们是否实现了自己的迭代器类？还是他们尝试编写代码以避免需要迭代器？

[yield](http://msdn.microsoft.com/en-us/library/9k7k7cf0(VS.80).aspx)关键字确实强制编译器在幕后进行一些编码。*[C# 中迭代​​器的实现及其后果（第 1 部分）](http://blogs.msdn.com/oldnewthing/archive/2008/08/12/8849519.aspx)*就是一个很好的例子。

* * *

## 回答 #1

> 赞同：71
> 
> 时间：2008-12-19T21:00:18.017

## 注意：这个答案现在已经过时了。迭代器块已被添加到[VB.NET](http://en.wikipedia.org/wiki/Visual_Basic_.NET)

C# 在编译时将 yield 关键字转换为状态机。VB.NET 没有 yield 关键字，但它确实有自己的机制，可以在 C# 中不容易获得的函数中安全地嵌入状态。

C#`static`关键字通常使用`Shared`关键字转换为 Visual Basic，但有两个地方会让人感到困惑。一个是 C# 静态类实际上是 Visual Basic 中的一个模块，而不是一个共享类（您可能认为他们会让您在 Visual Basic 中以任何一种方式对其进行编码，但不）。另一个是 VB.NET 确实有自己的`Static`关键字。但是，`Static`在 VB.NET 中具有不同的含义。

您`Static`在 VB.NET 中使用关键字在函数内声明变量，并且当您这样做时，变量在函数调用之间保持其状态。这与仅在 C# 中声明私有静态类成员不同，因为 VB.NET 中的静态函数成员也保证是线程安全的，因为编译器将其转换为在编译时使用 Monitor 类。

那么为什么要在这里写这一切呢？好吧，应该可以构建一个可重用的泛型`Iterator<T>`类（或`Iterator(Of T)`在 VB.NET 中）。在此类中，您将实现 C# 使用的状态机，`Yield()`以及`Break()`与 C# 关键字相对应的方法。然后，您可以在函数中使用静态实例（在 VB.NET 意义上），以便它最终可以`yield`在大约相同数量的代码中完成与 C# 几乎相同的工作（丢弃类实现本身，因为它将是无限的可重复使用的）。

我对 Yield 的关心还不够，无法亲自尝试，但它*应该*是可行的。也就是说，它也远非微不足道，因为 C# 团队成员 Eric Lippert 将其称为“[编译器中最复杂的转换](http://blogs.msdn.com/ericlippert/archive/2009/08/24/iterator-blocks-part-seven-why-no-anonymous-iterators.aspx)”。

我也开始相信，自从我一年多前写了这个的初稿以来，在 Visual Studio 2010 出现之前，它不可能以有意义的方式真正实现，因为它需要将多个 lambdas 发送到 Iterator 类，所以要真正做到实际上，我们需要[.NET 4](http://en.wikipedia.org/wiki/.NET_Framework)对多行 lambda 的支持。

* * *

## 回答 #2

> 赞同：21
> 
> 时间：2011-05-05T14:39:55.427

[Async CTP](http://msdn.microsoft.com/en-us/vstudio/async.aspx)包括对`Yield`VB.NET的支持。

有关用法的信息，请参阅[Visual Basic 中的迭代器。](http://msdn.microsoft.com/en-us/vstudio/gg497937)

现在它已包含在 Visual Studio 2012 的包装盒中！

* * *

## 回答 #3

> 赞同：15
> 
> 时间：2009-09-26T07:22:07.323

Bill McCarthy 在 Visual Studio 杂志上发表了一篇关于在 VB.NET 中进行仿真的精彩文章*[Use Iterators in VB Now 。](http://visualstudiomagazine.com/Articles/2009/02/01/Use-Iterators-in-VB-Now.aspx?Page=2)*`yield`或者等待下一个版本的 Visual Basic。

* * *

## 回答 #4

> 赞同：4
> 
> 时间：2018-02-11T10:19:26.423

幸运的是，现在我们在这里`Yield`返回
了一个来自我的项目的示例 + 实现了一个带有`System.Collections.Generic.IEnumerable(T)`函数的接口：

```
Public Class Status
    Implements IStatus

    Private _statusChangeDate As DateTime
    Public Property statusChangeDate As DateTime Implements IStatus.statusChangeDate
        Get
            Return _statusChangeDate
        End Get
        Set(value As Date)
            _statusChangeDate = value
        End Set
    End Property

    Private _statusId As Integer
    Public Property statusId As Integer Implements IStatus.statusId
        Get
            Return _statusId
        End Get
        Set(value As Integer)
            _statusId = value
        End Set
    End Property

    Private _statusName As String
    Public Property statusName As String Implements IStatus.statusName
        Get
            Return _statusName
        End Get
        Set(value As String)
            _statusName = value
        End Set
    End Property

    Public Iterator Function GetEnumerator() As IEnumerable(Of Object) Implements IStatus.GetEnumerator
        Yield Convert.ToDateTime(statusChangeDate)
        Yield Convert.ToInt32(statusId)
        Yield statusName.ToString()
    End Function

End Class

Public Interface IStatus
    Property statusChangeDate As DateTime
    Property statusId As Integer
    Property statusName As String
    Function GetEnumerator() As System.Collections.Generic.IEnumerable(Of Object)
End Interface 
```

这就是我从外部提取所有属性的方式：

```
For Each itm As SLA.IStatus In outputlist
    For Each it As Object In itm.GetEnumerator()
        Debug.Write(it & " ")
    Next
    Debug.WriteLine("")
Next 
```

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2008-09-18T21:56:04.177

我个人只是编写自己的迭代器类，它继承自`IEnumerator(Of T)`. 把它写好确实需要一些时间，但我认为最后最好把它写对，然后尽量避免它。我做过的另一种方法是编写一个递归方法，它返回`IEnumerable(Of T)`并且只返回`List(Of T)`并使用`.AddRange`.

* * *

## 回答 #6

> 赞同：1
> 
> 时间：2017-06-22T13:40:22.730

VB.NET 有`Iterator`关键字[https://docs.microsoft.com/en-us/dotnet/visual-basic/language-reference/modifiers/iterator](https://docs.microsoft.com/en-us/dotnet/visual-basic/language-reference/modifiers/iterator)

自 Visual Studio 2012 以来，它似乎

* * *

## 回答 #7

> 赞同：0
> 
> 时间：2008-12-19T21:07:54.770

希望随着即将推出的 VB 版本，这将成为过去。由于迭代器实际上在新范式中变得越来越重要（尤其是结合惰性求值的 LINQ），据我从 Paul Vick 的博客中了解到，这具有相当高的优先级。话又说回来，Paul 不再是 VB 团队的负责人，我还没有时间观看 PCD 的演讲。

不过，如果您有兴趣，可以在[Paul 的博客](http://www.panopticoncentral.net/archive/2008/10/31/24803.aspx)中链接它们。

* * *

## 回答 #8

> 赞同：-1
> 
> 时间：2011-05-02T09:57:16.910

下面的代码给出了输出

2、4、8、16、32

在 VB.NET 中，

```
Public Shared Function setofNumbers() As Integer()
    Dim counter As Integer = 0
    Dim results As New List(Of Integer)
    Dim result As Integer = 1
    While counter < 5
        result = result * 2
        results.Add(result)
        counter += 1
    End While
    Return results.ToArray()
End Function

Private Sub Form1_Load(ByVal sender As Object, ByVal e As System.EventArgs) Handles Me.Load
    For Each i As Integer In setofNumbers()
        MessageBox.Show(i)
    Next
End Sub 
```

在 C# 中

```
private void Form1_Load(object sender, EventArgs e)
{
    foreach (int i in setofNumbers())
    {
        MessageBox.Show(i.ToString());
    }
}

public static IEnumerable<int> setofNumbers()
{
    int counter=0;
    int result=1;
    while (counter < 5)
    {
        result = result * 2;
        counter += 1;
        yield return result;
    }
} 
```

# c# - 如何在 C# 中打开 google chrome 控件

> ID：97385
> 
> 赞同：3
> 
> 时间：2008-09-18T21:54:06.477
> 
> 标签：c#

我知道有一种方法可以添加 IE 控件，请问如何添加 chrome 控件...？现在甚至可能吗？

我需要这个，因为在 chrome 中找到了快速的 javascript VM。

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2011-03-03T13:20:07.680

看看这个：[在 C# 中使用 chrome 作为浏览器？](https://stackoverflow.com/q/2141668/258482)

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2008-09-18T22:05:56.463

我四处搜索，我不认为 Google Chrome 将自己注册为 Windows COM+ 组件。我觉得你运气不好。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2008-09-18T21:59:17.430

IE 控件实际上是 ActiveX 组件 - 因此它可以包装在 .Net 组件中。它不是真正的 IE，主要是它的渲染引擎（HTML+CSS+JS）加上 web 客户端（HTTP 和一些更多的协议） 控件本身没有菜单、书签等。Chrome 是全功能浏览器。所以你应该要求 WebKit（渲染引擎 chrome 使用，由 Safari 的家伙开发）控制。

有一个过时的 Mozilla ActiveX（实际上是 Gecko 渲染引擎）。它使用起来要复杂得多，只能作为 ActiveX 使用，没有原生的 .Net/C#。

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2009-09-10T19:57:44.780

如果你想自己使用... Chrome 是基于开源的 webkit 渲染引擎。不过祝你好运，我很确定它对托管代码不友好。

# c# - 如何获取枚举的基础值

> ID：97391
> 
> 赞同：16
> 
> 时间：2008-09-18T21:54:34.900
> 
> 标签：c#, .net, enums

我声明了以下枚举：

```
 public enum TransactionTypeCode { Shipment = 'S', Receipt = 'R' } 
```

如何从 TransactionTypeCode.Shipment 中获取值“S”或从 TransactionTypeCode.Receipt 中获取值“R”？

简单地执行 TransactionTypeCode.ToString() 会给出一个枚举名称“Shipment”或“Receipt”的字符串，因此它不会减少芥末。

* * *

## 回答 #1

> 赞同：36
> 
> 时间：2010-02-18T22:04:19.580

您必须检查枚举的基础类型，然后转换为正确的类型：

```
public enum SuperTasks : int
    {
        Sleep = 5,
        Walk = 7,
        Run = 9
    }

    private void btnTestEnumWithReflection_Click(object sender, EventArgs e)
    {
        SuperTasks task = SuperTasks.Walk;
        Type underlyingType = Enum.GetUnderlyingType(task.GetType());
        object value = Convert.ChangeType(task, underlyingType); // x will be int
    } 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2008-09-18T21:55:37.813

我相信 Enum.GetValues() 是您正在寻找的。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2013-12-01T12:47:43.113

您的枚举的基础类型仍然是 int，只是由于某种原因存在从`char`to的隐式转换。`int`你的枚举相当于

```
TransactionTypeCode { Shipment = 83, Receipt = 82, } 
```

另请注意，可能出于某种语义原因，它[`enum`可以具有任何整数类型作为基础类型，除了。`char`](http://msdn.microsoft.com/en-us/library/sbbt4032%28VS.80%29.aspx)这是不可能的：

```
TransactionTypeCode : char { Shipment = 'S', Receipt = 'R', } 
```

* * *

要`char`恢复值，您可以使用强制转换。

```
var value = (char)TransactionTypeCode.Shipment;

// or to make it more explicit:
var value = Convert.ToChar(TransactionTypeCode.Shipment); 
```

第二个导致拳击，因此应该表现更糟。所以可能稍微好一点的是

```
var value = Convert.ToChar((int)TransactionTypeCode.Shipment); 
```

但丑陋。考虑到性能/可读性的权衡，我更喜欢第一个（演员）版本..

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2009-04-01T03:20:51.270

我正在寻找那个，我得到了解决方案使用转换类

```
int value = Convert.ToInt32(TransactionTypeCode.Shipment); 
```

看看它有多容易

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2015-06-25T11:08:49.870

枚举的基础值必须是数字。如果基础值的类型已知，则简单转换返回枚举的给定实例的基础值。

```
enum myEnum : byte {Some = 1, SomeMore, Alot, TooMuch};
myEnum HowMuch = myEnum.Alot;
Console.Writeline("How much: {0}", (byte)HowMuch); 
```

输出：多少：3

或（更接近原始问题）

```
enum myFlags:int {None='N',Alittle='A',Some='S',Somemore='M',Alot='L'};
myFlags howMuch = myFlags.Some;
Console.WriteLine("How much: {0}", (char)howMuch);
//If you cast as int you get the ASCII value not the character. 
```

这对我来说是一个反复出现的问题，我总是忘记简单的演员阵容会给你带来价值。

* * *

## 回答 #6

> 赞同：-1
> 
> 时间：2008-09-23T20:11:47.777

这就是我通常设置我的枚举的方式：

```
public enum TransactionTypeCode {

  Shipment("S"),Receipt ("R");

  private final String val;

  TransactionTypeCode(String val){
    this.val = val;
  }

  public String getTypeCode(){
    return val;
  }
}

System.out.println(TransactionTypeCode.Shipment.getTypeCode()); 
```

* * *

## 回答 #7

> 赞同：-2
> 
> 时间：2008-09-18T21:55:53.897

将此标记为不正确，但我无法删除它。

试试这个：

```
string value = (string)TransactionTypeCode.Shipment; 
```

# java - JAVA中的物理地址

> ID：97392
> 
> 赞同：2
> 
> 时间：2008-09-18T21:54:41.093
> 
> 标签：java, macos

如何在**Java**中获取我的机器的物理地址？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2008-09-18T22:07:36.350

从 Java 6 开始，java.net.NetworkInterface 类现在具有 getHardwareAddress() 方法

[http://java.sun.com/javase/6/docs/api/java/net/NetworkInterface.html#getHardwareAddress()](http://java.sun.com/javase/6/docs/api/java/net/NetworkInterface.html#getHardwareAddress())

如果这太新了，有 UUID 包会尝试每个操作系统的各种方法来请求它。试试例如[http://johannburkard.de/blog/programming/java/MAC-address-lookup-using-Java.html](http://johannburkard.de/blog/programming/java/MAC-address-lookup-using-Java.html)

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2008-09-18T21:57:14.877

```
try {
    InetAddress addr = InetAddress.getLocalHost();

    // Get IP Address
    byte[] ipAddr = addr.getAddress();

    // Get hostname
    String hostname = addr.getHostName();
} catch (UnknownHostException e) {
} 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2008-09-18T21:57:27.340

我认为这可能是您正在寻找的，在 InetAddress 类的 Java API 中：http: [//java.sun.com/javase/6/docs/api/java/net/InetAddress.html](http://java.sun.com/javase/6/docs/api/java/net/InetAddress.html)

```
getLocalHost() 
```

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2008-09-18T23:34:00.697

如果您需要 MAC 地址，您将需要 JNI。我使用一个名为[JUG](http://jug.safehaus.org/)的库来生成基于机器真实 MAC 地址的 UUID。您可以查阅他们的[源代码](http://jug.safehaus.org/curr/jug-src.zip)，了解这是如何在 Linux、Solaris、Windows 和 Mac 平台上实现的。

# eclipse - 如何在 Eclipse Ganymede 中安装 PDT 2.0？

> ID：97402
> 
> 赞同：1
> 
> 时间：2008-09-18T21:56:36.127
> 
> 标签：eclipse, eclipse-3.4, eclipse-pdt, ganymede

我已经尝试在 Eclipse 3.4 中安装 PDT 几个小时了，但没有任何成功。

我以前为 Java EE 开发人员（我的主要交易）发行版安装了 Eclipse，我只想将 PDT 添加到我的安装中，这样我也可以在 Eclipse 中处理我的一些网站。

我已尽力按照PDT Wiki 上[的说明](http://wiki.eclipse.org/PDT/Installation)进行操作，但没有任何成功。因此，当我尝试 在可用软件对话框的 PDT 更新站点部分中 选择**PDT 功能选项时，它向我吠叫的特定消息是：**

```
Cannot complete the request.  See the details.
Cannot find a solution satisfying the following requirements Match[requiredCapability:
org.eclipse.equinox.p2.iu/org.eclipse.wst.web_ui.feature.feature.group/
[3.0.1.v200807220139-7R0ELZE8Ks-y8HYiQrw5ftEC3UBF,
3.0.1.v200807220139-7R0ELZE8Ks-y8HYiQrw5ftEC3UBF]]. 
```

解决办法是什么？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2008-10-13T19:18:27.177

如果你有一个你已经拥有的所有插件的列表，那么去[YOXOS](http://www.yoxos.com/ondemand/)并下载一个新的 eclipse 副本可能会更快更容易，并且所有插件都已经加载。如果您这样做，请记住更改您的工作区。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2008-10-17T14:18:54.610

我对 PDT 插件有同样的问题。只需遵循本指南[http://wiki.eclipse.org/PDT/Installation](http://wiki.eclipse.org/PDT/Installation)并确保您使用的是最新的 PDT 版本 (2)。PDT 更新站点提供以前的稳定版本。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2008-10-29T10:01:48.033

我看过很多指南，但我最终自己弄清楚了：

1.  下载 Ganyamede SDK
2.  通过更新管理器安装 Web Developer Tools (v 3.0.x)
3.  再次使用更新管理器安装 DLTK 版本 1.0 或更高版本
4.  手动下载最新的集成或夜间 od PDT 2.0 并将其解压缩到 eclipse 文件夹中

5.  现在您应该在 ganyamede 中使用 PDT 2.0 ;)

# ssl - IE6 是否支持 AES 256 位加密？

> ID：97421
> 
> 赞同：0
> 
> 时间：2008-09-18T21:57:42.020
> 
> 标签：ssl, internet-explorer-6, aes

如果服务器有能力，IE6 会协商 256 位 AES SSL 连接吗？

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2008-09-19T00:07:42.990

有时只有一种简单明了的方法可以找出答案。如果您查看 Internet Explorer 帮助 > 关于 Internet Explorer，它会告诉您它支持的最大密码位，在 IE6 上它是 128。

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2012-09-07T17:21:14.607

实际上，据我所见，IE6 不支持任何 AES。

[http://www.raritan.com/helpfiles/ccsg42/en/1926.htm](http://www.raritan.com/helpfiles/ccsg42/en/1926.htm)

3DES、RC4、AES，这些都是 128、168、256 位的东西。SHA 和 Blowfish 都是 512 位或更少。有人在 Linux 上引用的“2048 位”密钥交换是不同的。

IE7 和 IE8 支持 AES，但仅限于 Vista 或更高版本。我已经确认它们不在 Windows XP 上。XP 上最好的 IE8 是 RC4 或 3DES。即使我的 IE8 密码强度是“128 位”，我也可以访问安全网站并通过以下方式进行连接：

TLS 1.0，具有 168 位加密的三重 DES（高）；具有 2048 位交换的 RSA

嗯。看起来 Windows 在只声称可以处理 128 位的浏览器上也使用 2048 位加密！

我知道这是一个非常古老的话题，但是当我搜索同样的东西时它出现了，所以希望这些信息会有用。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2008-09-18T22:20:16.303

可能，我还不能确定，但​​我可以告诉你的是，AES256 似乎受到美国出口对高安全性密码的限制，因此，某些平台可能缺乏这种能力。

此外，经过进一步搜索，msdn 页面（例如[这个](http://blogs.msdn.com/ie/archive/2005/10/22/483795.aspx)）似乎指向 AES 支持（句号！）仅在 Vista / IE7 之后才可用。

MS 是否决定向后移植它目前还没有消息，但它看起来很可疑。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2012-03-07T10:39:57.770

Windows XP SP3 上 Internet Explorer 6 中的关于对话框将密码支持声明为 128 位。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2015-07-15T07:25:55.227

IE6 肯定不支持 AES256。我知道，因为我终于通过限制 Apache 2 中的 SSLCipherSuite 以排除 MEDIUM 密码，在我管理的网站上阻止了使用 IE6 的用户。Apache 文档说“MEDIUM”是指 128 位的密码。

所以现在我们在 Apache 配置中有以下内容，这将排除 IE6 用户：

```
SSLCipherSuite ALL:!ADH:RC4+RSA:+HIGH:!MEDIUM:!LOW:!SSLv2:!EXP:!NULL 
```

相同的配置字符串也适用于连接器中 server.xml 文件中的 Tomcat，带有 SSLCipherSuite 参数：

例如

```
<Connector port="8443" protocol="HTTP/1.1" SSLEnabled="true"
            maxThreads="150" minSpareThreads="25" scheme="https" secure="true" 
            keystorePass="xxxxxxxx"
            clientAuth="false" sslProtocol="TLSv1.2" 
            SSLCipherSuite="ALL:!ADH+DH:!RC4:+HIGH:!MEDIUM:!LOW:!SSLv2:!EXPORT"
            enableLookups="false" redirectPort="8443" acceptCount="100"
            connectionTimeout="20000" disableUploadTimeout="true"
            allowTrace="false" /> 
```

# .net - 使用 AppDomain 的好例子

> ID：97433
> 
> 赞同：50
> 
> 时间：2008-09-18T21:59:41.517
> 
> 标签：.net, appdomain

我在面试中不断被问到关于 AppDomains 的问题，[我知道基础知识](http://en.wikipedia.org/wiki/Appdomain)：

*   它们是应用程序中的隔离级别（使它们与应用程序不同）
*   他们可以有线程（使它们与线程不同）
*   一个 appdomain 中的异常不会影响另一个
*   appdomains不能访问彼此的内存
*   每个 appdomain 可以有不同的安全性

我仍然不明白是什么让它们变得必要。我正在寻找一个合理的具体情况，当你会使用一个。

答案：

*   不受信任的代码

*   受核心应用程序保护
    的不受信任/第 3 方插件通过隔离在具有安全限制的单独应用程序域中来防止损坏共享内存和对注册表或硬盘驱动器的非授权访问，从而保护应用程序或服务器。例如 ASP.NET 和 SQL Server 托管组件代码

*   可信代码

*   稳定性
    应用程序细分为安全、独立的特性/功能
*   架构灵活性
    在单个 CLR 实例或每个程序中运行多个应用程序的自由。

还要别的吗？

* * *

## 回答 #1

> 赞同：50
> 
> 时间：2008-09-18T22:01:20.687

最常见的一种可能是加载包含来自不受信任方的插件代码的程序集。代码在其自己的 AppDomain 中运行，隔离应用程序。

此外，无法卸载特定程序集，但您可以卸载 AppDomain。

对于完整的纲要，Chris Brumme 有一篇关于此的大量博客文章：

~~[http://blogs.msdn.com/cbrumme/archive/2003/06/01/51466.aspx](http://blogs.msdn.com/cbrumme/archive/2003/06/01/51466.aspx)~~

[https://devblogs.microsoft.com/cbrumme/appdomains-application-domains/](https://devblogs.microsoft.com/cbrumme/appdomains-application-domains/)

* * *

## 回答 #2

> 赞同：16
> 
> 时间：2008-09-18T23:13:26.987

AppDomains 的另一个好处（正如您在问题中提到的）是您加载到其中的代码可以使用不同的安全权限运行。例如，我编写了一个动态加载 DLL 的应用程序。我是一名讲师，这些是我正在加载的学生 DLL。我不想让一些心怀不满的学生清除我的硬盘或损坏我的注册表，所以我将代码从他们的 DLL 加载到一个单独的 AppDomain 中，该 AppDomain 没有文件 IO 权限或注册表编辑权限，甚至没有显示新窗口的权限（它实际上只有执行权限）。

* * *

## 回答 #3

> 赞同：8
> 
> 时间：2008-09-18T22:50:35.420

我认为拥有 AppDomains 的主要动机是 CLR 设计人员想要一种隔离托管代码的方法，而不会导致多个 Windows 进程的性能开销。如果 CLR 最初是在 UNIX 之上实现的（在 UNIX 上创建多个进程的成本要低得多），那么 AppDomains 可能永远不会被发明出来。

此外，虽然 3rd 方应用程序中的托管插件体系结构绝对是 AppDomains 的一个很好的用途，但它们存在的更大原因是用于 SQL Server 2005 和 ASP.NET 等知名主机。例如，ASP.NET 托管服务提供商可以提供一个共享托管解决方案，该解决方案支持来自多个客户的多个站点，所有这些站点都位于在单个 Windows 进程下运行的同一机器上。

* * *

## 回答 #4

> 赞同：4
> 
> 时间：2008-09-18T22:02:13.210

如果您创建允许第三方插件的应用程序，您可以将这些插件加载到单独的 AppDomain 中，以便您的主应用程序不受未知代码的影响。

ASP.NET 还为单个工作进程中的每个 Web 应用程序使用单独的 AppDomain。

* * *

## 回答 #5

> 赞同：4
> 
> 时间：2008-09-18T22:08:46.550

应用程序域非常适合应用程序稳定性。

通过让您的应用程序包含一个中央进程，然后在单独的应用程序域中产生“功能”，您可以防止其中一个行为不端时发生全局崩溃。

* * *

## 回答 #6

> 赞同：4
> 
> 时间：2008-09-18T22:12:43.983

据我了解，AppDomain 旨在允许托管实体（操作系统、数据库、服务器等）自由地在单个 CLR 实例或每个程序中运行多个应用程序。所以这是主机而不是应用程序开发人员的问题。

这与 Java 相比是有利的，在 Java 中每个应用程序总是有 1 个 JVM，这通常会导致许多 JVM 实例与重复资源并行运行。

* * *

## 回答 #7

> 赞同：3
> 
> 时间：2011-02-19T02:35:23.570

我看到 2 或 3 个用于创建单独应用程序域的主要用例：

**1)**具有低资源使用和开销的类似进程的隔离。例如，这就是 ASP.NET 所做的——它将每个网站托管在一个单独的应用程序域中。如果它在单个应用程序域中使用不同的线程，那么不同网站的代码可能会相互干扰。如果它在不同的进程中托管不同的网站 - 它将使用大量资源，并且与进程内通信相比，进程间通信相对困难。

**2）**在具有特定安全权限的单独应用程序域中执行不受信任的代码（这实际上与第一个原因有关）。正如人们已经说过的，您可以将 3rd 方插件或不受信任的 dll 加载到单独的应用程序域中。

**3)**能够卸载程序集以减少不必要的内存使用。不幸的是，没有办法从应用程序域中卸载程序集。因此，如果您将一些大型程序集加载到您的主应用程序域，那么在不再需要该程序集之后释放相应内存的唯一方法是关闭您的应用程序。在单独的应用程序域中加载程序集并在不再需要这些程序集时卸载该应用程序域是解决此问题的方法。

# regex - 正则表达式和多个多字符分隔符

> ID：97435
> 
> 赞同：1
> 
> 时间：2008-09-18T21:59:52.593
> 
> 标签：regex

假设您有以下字符串：

```
white sand, tall waves, warm sun 
```

编写一个匹配分隔符的正则表达式很容易，Java String.split() 方法可以使用它为您提供一个包含标记“白沙”、“高浪”和“暖阳”的数组：

```
\s*,\s* 
```

现在说你有这个字符串：

```
white sand and tall waves and warm sun 
```

同样，拆分标记的正则表达式很容易（确保您没有在单词“sand”中得到“and”）：

```
\s+and\s+ 
```

现在，考虑这个字符串：

```
white sand, tall waves and warm sun 
```

是否可以编写一个正确匹配分隔符的正则表达式，允许您将字符串拆分为与前两种情况相同的标记？或者，是否可以编写一个匹配标记本身并省略分隔符的正则表达式？（逗号两侧的任何空格或单词“and”都应视为分隔符的一部分。）

编辑：正如评论中所指出的，正确的答案应该在输入字符串的开头或结尾处稳健地处理分隔符。*理想*的答案应该能够使用像“,white sand, high waves and warm sun and”这样的字符串，并提供这三个确切的标记：

```
[ "white sand", "tall waves", "warm sun" ] 
```

...没有~~额外的空令牌或~~任何标记的开头或结尾处的额外空白。

编辑：有人指出，String.split() 无法避免额外的空标记，因此已将其作为“完美”正则表达式的标准删除。

* * *

感谢大家的回应！我试图确保我对所有贡献了一个本质上不是重复的可行正则表达式的人都投了赞成票。丹的答案是最有力的（它甚至可以处理“、白色的沙子、高耸的海浪和温暖的阳光和”，合理地，在“波浪”一词后面加上奇怪的逗号），所以我将他的答案标记为已接受的答案。nsayer 提供的正则表达式紧随其后。

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2008-09-18T22:25:14.357

这应该非常有弹性，并且可以处理字符串末尾的分隔符之类的东西（例如，“foo and bar and”）

```
\s*(?:\band\b|,)\s* 
```

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2008-09-18T22:02:13.837

这应该同时捕获 'and' 或 ','

```
(?:\sand|,)\s 
```

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2008-09-18T22:03:16.580

问题与

```
\s*(,|(and))\s* 
```

是它会不恰当地分裂“沙子”。

问题与

```
\s+(,|(and))\s+ 
```

是它需要逗号周围的空格。

正确的答案可能必须是

```
(\s*,\s*)|(\s+and\s+) 
```

我会在返回由分隔符包围的字符串的概念上作弊，建议许多语言都有一个“拆分”运算符，当正则表达式指定分隔符本身的形式时，它完全符合您的要求。请参阅 Java String.split() 函数。

* * *

## 回答 #4

> 赞同：2
> 
> 时间：2008-09-18T22:04:38.963

这行得通吗？

```
\s*(,|\s+and)\s+ 
```

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2008-09-18T22:02:17.407

是的，这就是正则表达式的用途：

```
\s*(?:and|,)\s* 
```

该| 定义备选方案， () 分组选择器和 :? 确保正则表达式引擎不会尝试保留 () 之间的值。

编辑：避免沙坑（感谢通知）：

```
\s*(?:[^s]and|,)\s* 
```

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2008-09-18T22:06:48.333

```
(?:(?<!s)and\s+|\,\s+) 
```

可能工作

没有办法测试它，但取出了刚刚的空间匹配器。

* * *

## 回答 #7

> 赞同：0
> 
> 时间：2008-09-18T23:00:50.153

也许：

((\s*,\s*)|(\s+和\s+))

我不是 java 程序员，所以我不确定 java regex 是否允许'？

# c++ - 用于以通用方式返回序列的 C++ API

> ID：97447
> 
> 赞同：6
> 
> 时间：2008-09-18T22:01:22.200
> 
> 标签：c++, api, generics, sequences

如果我正在编写一个库并且我有一个需要返回一系列值的函数，我可以执行以下操作：

```
std::vector<int> get_sequence(); 
```

但是，这要求库用户使用 std::vector<> 容器，而不是允许他们使用他们想要使用的任何容器。此外，它可以添加返回数组的额外副本（取决于编译器是否可以优化它），这可能会对性能产生负面影响。

理论上，您可以通过制作一个带有开始和结束迭代器的模板化函数来启用任意容器的使用（并避免不必要的额外复制）：

```
template<class T_iter> void get_sequence(T_iter begin, T_iter end); 
```

然后该函数会将序列值存储在迭代器给定的范围内。但是这样做的问题是它需要您知道序列的大小，以便在序列之间有足够的元素`begin`并`end`存储序列中的所有值。

我想到了一个界面，例如：

```
template<T_insertIter> get_sequence(T_insertIter inserter); 
```

这要求 T_insertIter 是一个插入迭代器（例如，使用 创建`std::back_inserter(my_vector)`），但这似乎太容易误用，因为编译器会很乐意接受非插入迭代器，但在运行时会表现不正确。

那么设计返回任意长度序列的通用接口是否有最佳实践？

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2008-09-18T22:23:15.970

让 get_sequence 返回一个（自定义）`forward_iterator`类，按需生成序列。（它也可以是更高级的迭代器类型，例如`bidirectional_iterator`这对您的序列是否实用。）

然后用户可以将序列复制到他们想要的任何容器类型中。或者，他们可以直接在您的迭代器上循环并完全跳过容器。

您将需要某种结束迭代器。在不确切知道如何生成序列的情况下，很难确切地说应该如何实现它。一种方法是让您的迭代器类拥有一个返回结束迭代器的静态成员函数，例如：

```
static const my_itr& end() { static const my_itr e(...); return e; }; 
```

where`...`表示创建结束迭代器（可能使用私有构造函数）所需的任何参数。然后你的循环看起来像：

```
for (my_itr i = get_sequence(); i != my_itr::end(); ++i) { ... } 
```

这是一个生成连续整数序列的前向迭代器类的简单示例。显然，这可以很容易地变成一个双向或随机访问迭代器，但我想保持这个例子很小。

```
#include <iterator>

class integer_sequence_itr
  : public std::iterator<std::forward_iterator_tag, int>
{
 private:
  int i;

 public:
  explicit integer_sequence_itr(int start) : i(start) {};

  const int& operator*()  const { return i; };
  const int* operator->() const { return &i; };

  integer_sequence_itr& operator++() { ++i; return *this; };
  integer_sequence_itr  operator++(int)
    { integer_sequence_itr copy(*this); ++i; return copy; };

  inline bool operator==(const integer_sequence_itr& rhs) const
    { return i == rhs.i; };

  inline bool operator!=(const integer_sequence_itr& rhs) const
    { return i != rhs.i; };
}; // end integer_sequence_itr

//Example:  Print the integers from 1 to 10.
#include <iostream>

int main()
{
  const integer_sequence_itr stop(11);

  for (integer_sequence_itr i(1); i != stop; ++i)
    std::cout << *i << std::endl;

  return 0;
} // end main 
```

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2008-09-18T22:14:00.157

为什么你需要你的接口独立于容器？Scott Meyers 在他的“Effective STL”中给出了一个很好的理由，即不管诱惑有多大，*不要试图让你的代码独立于容器。*基本上，容器旨在用于完全不同的用途：您可能不想将输出存储在 map 或 set 中（它们不是间隔容器），因此您只剩下 vector、list 和 deque，以及您为什么希望在需要列表的地方有向量，反之亦然？它们是完全不同的，使用其中一个的所有功能将获得比尝试同时工作更好的结果。好吧，请考虑阅读“有效的 STL”：值得您花时间。

但是，如果您对容器有所了解，则可以考虑执行类似的操作

```
 template void get_sequence(T_Container & container)
{
  //...
  container.assign(iter1, iter2);
  //...
} 
```

或者可能

```
 template void get_sequence(T_Container & container)
{
  //...
  container.resize(size);
  //use push_back or whatever
  //...
} 
```

甚至可以控制您对策略的操作，例如

```
 class AssignStrategy // for stl
{
public:
  template
  void fill(T_Container & container, T_Container::iterator it1, T_Container::iterator it2){
    container.assign(it1, it2);
  }
};

class ReserveStrategy // for vectors and stuff
{
public:
  template
  void fill(T_Container & container, T_Container::iterator it1, T_Container::iterator it2){
    container.reserve(it2 - it1);
    while(it1 != it2)
      container.push_back(*it1++);
  }
};

template 
void get_sequence(T_Container & container)
{
  //...
  T_FillStrategy::fill(container, iter1, iter2);
  //...
} 
```

* * *

## 回答 #3

> 赞同：3
> 
> 时间：2008-09-18T22:38:56.447

呃......只是我的两分钱，但是：

```
void get_sequence(std::vector<int> & p_aInt); 
```

这将消除复制问题的潜在回报。现在，如果您真的想避免强加一个容器，您可以尝试以下操作：

```
template <typename T>
void get_sequence(T & p_aInt)
{
    p_aInt.push_back(25) ; // Or whatever you need to add
} 
```

这只会为向量、列表和双端队列（以及类似的容器）编译。如果您想要大量可能的容器，代码将是：

```
template <typename T>
void get_sequence(T & p_aInt)
{
    p_aInt.insert(p_aInt.end(), 25) ; // Or whatever you need to add
} 
```

但正如其他帖子所说，您应该接受将您的界面仅限于一种容器。

* * *

## 回答 #4

> 赞同：2
> 
> 时间：2008-09-18T22:24:11.863

需要特别注意的一件事是，如果您所说的*库*是指 DLL 或类似的。如果库使用者（例如应用程序）是用另一个编译器而不是库本身构建的，那么可能会出现问题。

考虑您在示例中`std::vector<>`按值返回 a 的情况。然后内存将在库的上下文中分配，但在应用程序的上下文中释放。两个不同的编译器可能会以不同的方式分配/解除分配，因此可能会发生严重破坏。

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2008-09-19T00:49:14.807

如果您已经为序列管理内存，则可以返回一对迭代器供调用者在 for 循环或算法调用中使用。

如果返回的序列需要管理自己的内存，那么事情就更复杂了。您可以使用@paercebal 的解决方案，或者您可以实现自己的迭代器，将 shared_ptr 保存到它们正在迭代的序列中。

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2008-09-18T22:10:20.307

`std::list<int>`稍微好一点，IMO。请注意，这不需要列表中数据的额外副本，因为它只是被复制的指针。

这完全取决于您的消费者。如果您可以期望他们成为 C++ 开发人员，请给他们一个`std`容器类，我说。

我唯一想到的另一件事是你会这样做：

```
void get_sequence(std::tr1::function<void(int)> f); 
```

然后调用者可以使用`std::tr1::bind`让你的`get_sequence`函数调用他们想要的任何对象（或不）上的任何函数。您只需不断调用`f`您正在创建的每个元素。

* * *

## 回答 #7

> 赞同：0
> 
> 时间：2008-09-18T22:13:03.420

你可以做类似的事情

```
template<typename container>
container get_sequence(); 
```

并要求提供的容器类型符合某些标准接口（比如有一个成员 push_back 并且可能保留，以便您的接口的用户可以使用 vector/deque/list）。

* * *

## 回答 #8

> 赞同：0
> 
> 时间：2008-09-18T22:19:30.377

您可以使用 iterator_traits 静态调度迭代器的类型

像这样的东西：

```
template<T_insertIter> get_sequence(T_insertIter inserter)
{
   return get_sequence(inserter, typename iterator_traits<Iterator>::iterator_category());
}

template<T_insertIter> get_sequence(T_insertIter inserter, input_iterator_tag); 
```

* * *

## 回答 #9

> 赞同：0
> 
> 时间：2010-09-17T15:01:47.967

您可以将仿函数传递给接受单个值的函数。然后，仿函数将负责将值存储在您当时使用的任何容器中。

```
struct vector_adder {
  vector_adder(std::vector<int>& v) : v(v) {}
  void operator()(int n) { v.push_back(n); }
  std::vector<int>& v;
};

void gen_sequence(boost::function< void(int) > f) {
  ...
  f(n);
  ...
}

main() {
  std::vector<int> vi;
  gen_sequence(vector_adder(vi));
} 
```

注意：我在这里使用 boost.function 来定义函子参数。你不需要提升就能做到这一点。它只是让它更简单。

您也可以使用函数指针而不是仿函数，但我不推荐它。它容易出错，并且没有简单的方法将数据绑定到它。

此外，如果您的编译器支持 C++0x lambda 函数，您可以通过消除显式仿函数定义来简化代码：

```
main() {
  std::vector<int> ui;
  gen_sequence([&](int n)->void{ui.push_back(n);});
} 
```

（我仍在使用 VS2008，所以我不确定我的 lambda 语法是否正确）

* * *

## 回答 #10

> 赞同：0
> 
> 时间：2010-09-17T14:47:08.143

对于输出序列，我看到两个选项。第一个是类似的

```
template <typename OutputIter>
void generate_sequence(OutputIter out)
{
    //...
    while (...) { *out = ...; ++out; }
} 
```

第二个是像

```
struct sequence_generator
{
    bool has_next() { ... }
    your_type next() { mutate_state(); return next_value; }

private:
    // some state
}; 
```

您可能希望将其转换为标准 C++ 迭代器（`boost::iterator_facade`为方便起见），以便在标准算法（`copy`, `transform`, ...）中使用它。

也看看`boost::transform_iterator`, 结合一些按顺序返回整数的迭代器。

# asp.net - ASP.Net 中如何处理 Web 服务请求

> ID：97452
> 
> 赞同：3
> 
> 时间：2008-09-18T22:01:53.243
> 
> 标签：asp.net, web-services

当客户端发出 Web 服务请求时，asp.net 如何分配服务类的实例来处理该请求？

是否为每个请求创建了一个新的服务类实例，或者是否发生了池化，或者是否有一个用于处理所有请求的单例实例？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2008-09-18T22:45:29.503

对于经典的 ASMX 服务，您肯定会在每个请求中获得一个新实例，就像 ASPX 请求一样。对于 WCF 服务 (.SVC)，您确实有更多选择，例如作为单例运行。

如果您对使用单例和池化工作感兴趣，您可以使用 ASMX 服务作为轻量级代理来来回传递参数。您的服务实现可能是与您网站的应用程序池一起存在的单例。您需要考虑偶尔重置的应用程序池，因为这就是 IIS 管理 ASP.NET 站点的方式。

您还可以使用始终运行的 WCF 服务运行 Windows 服务。该服务将在只能从同一台机器访问的端点上侦听 localhost。然后，您可以让 ASMX 服务在本地调用 WCF 服务。这将允许您始终确保您的状态只要您愿意，即使在 IIS 重新启动应用程序池时也是如此。当然，如果您希望允许多个 Web 服务使用同一服务主机以提高资源使用率，您也可以更改 WCF Windows 服务的安全性以允许使用密码远程访问。

# .net - 使 WinForms TextBox 的行为类似于浏览器的地址栏

> ID：97459
> 
> 赞同：163
> 
> 时间：2008-09-18T22:02:18.157
> 
> 标签：.net, winforms, user-interface, textbox

当 C# WinForms 文本框获得焦点时，我希望它的行为类似于浏览器的地址栏。

要了解我的意思，请单击 Web 浏览器的地址栏。您会注意到以下行为：

1.  如果文本框先前没有聚焦，则单击文本框应选择所有文本。
2.  鼠标向下并在文本框中拖动应该只选择我用鼠标突出显示的文本。
3.  如果文本框已经获得焦点，则单击不会选择所有文本。
4.  以编程方式或通过键盘选项卡聚焦文本框应该选择所有文本。

我想在 WinForms 中做到这一点。

**最快的枪支警报：请在回答之前阅读以下内容！**多谢你们。:-)

> **在 .Enter 或 .GotFocus 事件期间调用 .SelectAll() 将不起作用**，因为如果用户单击文本框，插入符号将放置在他单击的位置，从而取消选择所有文本。
> 
> **在 .Click 事件期间调用 .SelectAll() 将不起作用**，因为用户将无法用鼠标选择任何文本；.SelectAll() 调用将继续覆盖用户的文本选择。
> 
> **在焦点/输入事件输入上调用 BeginInvoke((Action)textbox.SelectAll) 不起作用**，因为它违反了上面的规则 2，它将继续覆盖用户对焦点的选择。

* * *

## 回答 #1

> 赞同：112
> 
> 时间：2008-09-19T14:08:30.040

首先，感谢您的回答！共 9 个答案。谢谢你。

坏消息：所有答案都有一些怪癖或不太正确（或根本没有）。我已为您的每个帖子添加了评论。

好消息：我找到了一种让它发挥作用的方法。这个解决方案非常简单，似乎适用于所有场景（鼠标向下、选择文本、选项卡焦点等）

```
bool alreadyFocused;

...

textBox1.GotFocus += textBox1_GotFocus;
textBox1.MouseUp += textBox1_MouseUp;
textBox1.Leave += textBox1_Leave;

...

void textBox1_Leave(object sender, EventArgs e)
{
    alreadyFocused = false;
}

void textBox1_GotFocus(object sender, EventArgs e)
{
    // Select all text only if the mouse isn't down.
    // This makes tabbing to the textbox give focus.
    if (MouseButtons == MouseButtons.None)
    {
        this.textBox1.SelectAll();
        alreadyFocused = true;
    }
}

void textBox1_MouseUp(object sender, MouseEventArgs e)
{
    // Web browsers like Google Chrome select the text on mouse up.
    // They only do it if the textbox isn't already focused,
    // and if the user hasn't selected all text.
    if (!alreadyFocused && this.textBox1.SelectionLength == 0)
    {
        alreadyFocused = true;
        this.textBox1.SelectAll();
    }
} 
```

据我所知，这会导致文本框的行为与 Web 浏览器的地址栏完全相同。

希望这可以帮助下一个试图解决这个看似简单的问题的人。

再次感谢，伙计们，你们所有的回答帮助我走上了正确的道路。

* * *

## 回答 #2

> 赞同：83
> 
> 时间：2011-07-28T10:12:58.473

我找到了一个更简单的解决方案。它涉及使用异步启动 SelectAll`Control.BeginInvoke`以便它在 Enter 和 Click 事件发生后发生：

在 C# 中：

```
private void MyTextBox_Enter(object sender, EventArgs e)
{
    // Kick off SelectAll asynchronously so that it occurs after Click
    BeginInvoke((Action)delegate
    {
        MyTextBox.SelectAll();
    });
} 
```

在 VB.NET 中（感谢[Krishanu Dey](https://stackoverflow.com/users/1309193/krishanu-dey)）

```
Private Sub MyTextBox_Enter(sender As Object, e As EventArgs) Handles MyTextBox.Enter 
    BeginInvoke(DirectCast(Sub() MyTextBox.SelectAll(), Action)) 
End Sub 
```

* * *

## 回答 #3

> 赞同：30
> 
> 时间：2010-09-09T17:14:09.027

您的解决方案很好，但在一种特定情况下失败。如果您通过选择文本范围而不是单击来为 TextBox 提供焦点，则 alreadyFocused 标志不会设置为 true，因此当您再次单击 TextBox 时，所有文本都会被选中。

这是我的解决方案版本。我还将代码放入一个继承 TextBox 的类中，因此逻辑被很好地隐藏起来。

```
public class MyTextBox : System.Windows.Forms.TextBox
{
    private bool _focused;

    protected override void OnEnter(EventArgs e)
    {
        base.OnEnter(e);
        if (MouseButtons == MouseButtons.None)
        {
            SelectAll();
            _focused = true;
        }
    }

    protected override void OnLeave(EventArgs e)
    {
        base.OnLeave(e);
        _focused = false;
    }

    protected override void OnMouseUp(MouseEventArgs mevent)
    {
        base.OnMouseUp(mevent);
        if (!_focused)
        {
            if (SelectionLength == 0)
                SelectAll();
            _focused = true;
        }
    }
} 
```

* * *

## 回答 #4

> 赞同：8
> 
> 时间：2008-09-18T22:08:28.097

这有点笨拙，但在您的点击事件中，使用`SendKeys.Send( "{HOME}+{END}" );`.

* * *

## 回答 #5

> 赞同：4
> 
> 时间：2008-09-18T22:07:28.987

文本框的点击事件？甚至 MouseCaptureChanged 事件也适合我。- 好的。不起作用。

所以你必须做两件事：

```
private bool f = false;

private void textBox_MouseClick(object sender, MouseEventArgs e)
{ 
  if (this.f) { this.textBox.SelectAll(); }
  this.f = false;
}

private void textBox_Enter(object sender, EventArgs e)
{
  this.f = true;
  this.textBox.SelectAll();
}
private void textBox_MouseMove(object sender, MouseEventArgs e) // idea from the other answer
{
  this.f = false; 
} 
```

也适用于制表符（通过文本框到一个） - 在 Enter 中调用 SelectAll() 以防万一...

* * *

## 回答 #6

> 赞同：4
> 
> 时间：2009-04-06T20:03:28.723

我使用的单行答案......你可能会踢自己......

在输入事件中：

txtFilter.BeginInvoke(new MethodInvoker(txtFilter.SelectAll));

* * *

## 回答 #7

> 赞同：3
> 
> 时间：2008-09-18T22:09:27.640

```
'Inside the Enter event
TextBox1.SelectAll(); 
```

好的，在这里尝试后就是您想要的：

*   在 Enter 事件中启动一个标志，表明您已参加 enter 事件
*   在 Click 事件中，如果您设置了标志，请调用 .SelectAll() 并重置标志。
*   在 MouseMove 事件中，将输入标志设置为 false，这将允许您单击突出显示而无需先输入文本框。

这选择了输入时的所有文本，但允许我在之后突出显示部分文本，或者允许您在第一次单击时突出显示。

按要求：

```
 bool entered = false;
    private void textBox1_Enter(object sender, EventArgs e)
    {
        entered = true;
        textBox1.SelectAll();   //From Jakub's answer.
    }

    private void textBox1_Click(object sender, EventArgs e)
    {
        if (entered) textBox1.SelectAll();
        entered = false;
    }

    private void textBox1_MouseMove(object sender, MouseEventArgs e)
    {
        if (entered) entered = false;
    } 
```

对我来说，进入控件的选项卡选择了所有文本。

* * *

## 回答 #8

> 赞同：3
> 
> 时间：2011-08-07T05:34:30.703

这是一个帮助函数将解决方案提升到一个新的水平 - 重用而不继承。

```
 public static void WireSelectAllOnFocus( TextBox aTextBox )
    {
        bool lActive = false;
        aTextBox.GotFocus += new EventHandler( ( sender, e ) =>
        {
            if ( System.Windows.Forms.Control.MouseButtons == MouseButtons.None )
            {
                aTextBox.SelectAll();
                lActive = true;
            }
        } );

        aTextBox.Leave += new EventHandler( (sender, e ) => {
            lActive = false;
        } );

        aTextBox.MouseUp += new MouseEventHandler( (sender, e ) => {
            if ( !lActive )
            {
                lActive = true;
                if ( aTextBox.SelectionLength == 0 ) aTextBox.SelectAll();
            }   
        });
    } 
```

要使用它，只需调用传递一个 TextBox 的函数，它会为您处理所有混乱的部分。我建议在 Form_Load 事件中连接所有文本框。你可以把这个函数放在你的表单中，或者如果你喜欢我，可以放在实用程序类的某个地方，以便更多地重用。

* * *

## 回答 #9

> 赞同：2
> 
> 时间：2012-05-02T15:03:31.083

这类似于[nzhenry](https://stackoverflow.com/a/3678888/7444103)的流行答案，但我发现不必子类化更容易：

```
Private LastFocused As Control = Nothing

Private Sub TextBox1_Enter(sender As Object, e As System.EventArgs) Handles TextBox1.Enter, TextBox2.Enter, TextBox3.Enter
    If MouseButtons = Windows.Forms.MouseButtons.None Then LastFocused = sender
End Sub

Private Sub TextBox1_Leave(sender As Object, e As System.EventArgs) Handles TextBox1.Leave, TextBox2.Leave, TextBox3.Leave
    LastFocused = Nothing
End Sub

Private Sub TextBox1_MouseUp(sender As Object, e As System.Windows.Forms.MouseEventArgs) Handles TextBox1.MouseUp, TextBox2.MouseUp, TextBox3.MouseUp
    With CType(sender, TextBox)
        If LastFocused IsNot sender AndAlso .SelectionLength = 0 Then .SelectAll()
    End With
    LastFocused = sender
End Sub 
```

* * *

## 回答 #10

> 赞同：2
> 
> 时间：2013-03-07T23:55:24.510

这适用于 WPF/XAML 文本框。

```
 private bool initialEntry = true;
    private void TextBox_SelectionChanged(object sender, RoutedEventArgs e)
    {
        if (initialEntry)
        {
            e.Handled = true;
            initialEntry = false;
            TextBox.SelectAll();
        }
    }
    private void TextBox_GotFocus(object sender, RoutedEventArgs e)
    {
        TextBox.SelectAll();
        initialEntry = true;      
    } 
```

* * *

## 回答 #11

> 赞同：1
> 
> 时间：2012-05-02T20:13:25.380

SelectAll 从来没有为我工作过。

这行得通。

```
ActiveControl = textBox1;
textBox1->SelectionStart = 0;
textBox1->SelectionLength = textBox1->Text->Length; 
```

* * *

## 回答 #12

> 赞同：1
> 
> 时间：2014-12-01T13:25:28.653

我找到了一个更简单的解决方案：

要确保在单击文本框时选择所有文本，请确保 Click 处理程序调用 Enter 处理程序。不需要额外的变量！

例子：

```
private void textBox1_Click(object sender, EventArgs e){
        textBox1_Enter(sender, e);
    }

private void textBox1_Enter(object sender, EventArgs e){
        TextBox tb = ((TextBox)sender);
        tb.SelectAll();
    } 
```

* * *

## 回答 #13

> 赞同：0
> 
> 时间：2008-09-18T22:31:05.903

```
private bool _isSelected = false;
private void textBox_Validated(object sender, EventArgs e)
{
    _isSelected = false;
}

private void textBox_MouseClick(object sender, MouseEventArgs e)
{
    SelectAllText(textBox);
}

private void textBox_Enter(object sender, EventArgs e)
{
    SelectAllText(textBox);
}

private void SelectAllText(TextBox text)
{
    if (!_isSelected)
    {
        _isSelected = true;
        textBox.SelectAll();
    }
} 
```

* * *

## 回答 #14

> 赞同：0
> 
> 时间：2008-09-18T22:54:38.670

有趣的是，我认为，带有 DropDownStyle=Simple 的 ComboBox 几乎完全符合您正在寻找的行为。

（如果您降低控件的高度以不显示列表 - 然后再降低几个像素 - ComboBox 和 TextBox 之间没有有效的区别。）

* * *

## 回答 #15

> 赞同：0
> 
> 时间：2008-09-19T07:58:25.383

实际上 GotFocus 是您感兴趣的正确事件（确实是消息），因为无论您如何控制您最终都会得到它。问题是什么时候调用 SelectAll()。

试试这个：

```
public partial class Form1 : Form
{
    public Form1()
    {
        InitializeComponent();
        this.textBox1.GotFocus += new EventHandler(textBox1_GotFocus);
    }

    private delegate void SelectAllDelegate();    
    private IAsyncResult _selectAllar = null; //So we can clean up afterwards.

    //Catch the input focus event
    void textBox1_GotFocus(object sender, EventArgs e)
    {
        //We could have gotten here many ways (including mouse click)
        //so there could be other messages queued up already that might change the selection.
        //Don't call SelectAll here, since it might get undone by things such as positioning the cursor.
        //Instead use BeginInvoke on the form to queue up a message
        //to select all the text after everything caused by the current event is processed.
        this._selectAllar = this.BeginInvoke(new SelectAllDelegate(this._SelectAll));
    }

    private void _SelectAll()
    {
        //Clean-up the BeginInvoke
        if (this._selectAllar != null)
        {
            this.EndInvoke(this._selectAllar);
        }
        //Now select everything.
        this.textBox1.SelectAll();
    }
} 
```

* * *

## 回答 #16

> 赞同：0
> 
> 时间：2008-11-10T07:07:48.017

为什么不简单地使用文本框的 MouseDown-Event 呢？它对我来说很好，不需要额外的布尔值。非常干净和简单，例如：

```
private void textbox_MouseDown(object sender, MouseEventArgs e) {
    if (textbox != null && !string.IsNullOrEmpty(textbox.Text))
    {
        textbox.SelectAll();
    } } 
```

* * *

## 回答 #17

> 赞同：0
> 
> 时间：2008-12-22T09:18:47.650

您是否尝试过[MSDN 论坛“Windows Forms General”上建议的解决方案，](http://social.msdn.microsoft.com/forums/en-US/winforms/thread/e0d183d7-5bfe-4e68-abbb-fba9fdd209fd/)它只是子类 TextBox？

* * *

## 回答 #18

> 赞同：0
> 
> 时间：2009-10-26T15:19:32.273

我在 MouseUp 事件中调用了 SelectAll，它对我来说效果很好。

```
 private bool _tailTextBoxFirstClick = false;

    private void textBox1_MouseUp(object sender, MouseEventArgs e)
    {
        if(_textBoxFirstClick)           
            textBox1.SelectAll();

        _textBoxFirstClick = false;
    }  

    private void textBox1_Leave(object sender, EventArgs e)
    {
        _textBoxFirstClick = true;
        textBox1.Select(0, 0);
    } 
```

* * *

## 回答 #19

> 赞同：0
> 
> 时间：2010-01-06T05:21:03.937

只需从 TextBox 或 MaskedTextBox 派生一个类：

```
public class SMaskedTextBox : MaskedTextBox
{
    protected override void OnGotFocus(EventArgs e)
    {
        base.OnGotFocus(e);
        this.SelectAll();
    }
} 
```

并在您的表格上使用它。

* * *

## 回答 #20

> 赞同：0
> 
> 时间：2011-05-23T18:35:43.810

对于表单中的一组文本框：

```
private System.Windows.Forms.TextBox lastFocus;   

private void textBox_GotFocus(object sender, System.Windows.Forms.MouseEventArgs e)   
{
    TextBox senderTextBox = sender as TextBox;
    if (lastFocus!=senderTextBox){
        senderTextBox.SelectAll();
    }
    lastFocus = senderTextBox;   
} 
```

* * *

## 回答 #21

> 赞同：0
> 
> 时间：2012-01-13T16:30:15.370

我知道这已经解决了，但我有一个我认为实际上相当简单的建议。

在鼠标向上事件中，您所要做的就是放置

```
if(textBox.SelectionLength = 0)
{
    textBox.SelectAll();
} 
```

它似乎在 VB.NET 中对我有用（我知道这是一个 C# 问题......遗憾的是，我在工作中被迫使用 VB.. 我遇到了这个问题，这就是我来到这里的原因...... )

我还没有发现任何问题..除了它没有立即选择点击的事实，但我遇到了问题....

* * *

## 回答 #22

> 赞同：0
> 
> 时间：2012-08-31T08:56:11.643

以下解决方案对我有用。我添加了`OnKeyDown`事件`OnKeyUp`覆盖以保持 TextBox 文本始终处于选中状态。

```
 public class NumericTextBox : TextBox
{
    private bool _focused;
    protected override void OnGotFocus(EventArgs e)
    {
        base.OnGotFocus(e);
        if (MouseButtons == MouseButtons.None)
        {
            this.SelectAll();
            _focused = true;
        }
    }
    protected override void OnEnter(EventArgs e)
    {
        base.OnEnter(e);
        if (MouseButtons == MouseButtons.None)
        {
            SelectAll();
            _focused = true;
        }
    }

    protected override void OnLeave(EventArgs e)
    {
        base.OnLeave(e);
        _focused = false;
    }

    protected override void OnMouseUp(MouseEventArgs mevent)
    {
        base.OnMouseUp(mevent);
        if (!_focused)
        {
            if (SelectionLength == 0)
                SelectAll();
            _focused = true;
        }
    }

    protected override void OnKeyUp(KeyEventArgs e)
    {
        base.OnKeyUp(e);

        if (SelectionLength == 0)
            SelectAll();
        _focused = true;
    }
    protected override void OnKeyDown(KeyEventArgs e)
    {
       base.OnKeyDown(e);
       if (SelectionLength == 0)
            SelectAll();
        _focused = true;
    }
} 
```

* * *

## 回答 #23

> 赞同：0
> 
> 时间：2013-06-20T18:31:24.203

离开控件时设置选择。当你回来时它会在那里。围绕表单进行选项卡，当您返回控件时，将选择所有文本。

如果您通过鼠标进入，那么插入符号将正确放置在您单击的位置。

```
private void maskedTextBox1_Leave(object sender, CancelEventArgs e)
    {
        maskedTextBox1.SelectAll();
    } 
```

* * *

## 回答 #24

> 赞同：0
> 
> 时间：2014-09-23T15:03:56.030

非常简单的解决方案：

```
 private bool _focusing = false;

    protected override void OnEnter( EventArgs e )
    {
        _focusing = true;
        base.OnEnter( e );
    }

    protected override void OnMouseUp( MouseEventArgs mevent )
    {
        base.OnMouseUp( mevent );

        if( _focusing )
        {
            this.SelectAll();
            _focusing = false;
        }
    } 
```

**编辑：**原始OP特别关注鼠标按下/文本选择/鼠标向上序列，在这种情况下，上述简单解决方案最终会部分选择文本。

这应该可以解决*问题（实际上我拦截了 WM_SETCURSOR）：

```
 protected override void WndProc( ref Message m )
    {
        if( m.Msg == 32 ) //WM_SETCURSOR=0x20
        {
              this.SelectAll(); // or your custom logic here                
        }

        base.WndProc( ref m );
    } 
```

*实际上，以下序列以部分文本选择结束，但是如果您将鼠标移到文本框上，所有文本将再次被选中：

鼠标向下/文本选择/鼠标移出文本框/鼠标向上

* * *

## 回答 #25

> 赞同：0
> 
> 时间：2015-05-27T15:43:07.817

我发现这个效果最好，当鼠标单击而不是立即释放时：

```
 private bool SearchBoxInFocusAlready = false;
    private void SearchBox_LostFocus(object sender, RoutedEventArgs e)
    {
        SearchBoxInFocusAlready = false;
    }

    private void SearchBox_PreviewMouseUp(object sender, MouseButtonEventArgs e)
    {
        if (e.ButtonState == MouseButtonState.Released && e.ChangedButton == MouseButton.Left &&
            SearchBox.SelectionLength == 0 && SearchBoxInFocusAlready == false)
        {
            SearchBox.SelectAll();
        }

        SearchBoxInFocusAlready = true;
    } 
```

* * *

## 回答 #26

> 赞同：0
> 
> 时间：2015-07-19T14:21:03.103

我的解决方案非常原始，但适合我的目的

```
private async void TextBox_GotFocus(object sender, RoutedEventArgs e)
{
    if (sender is TextBox)
    {
        await Task.Delay(100);
        (sender as TextBox).SelectAll();
    }
} 
```

* * *

## 回答 #27

> 赞同：-1
> 
> 时间：2008-09-18T22:42:15.503

下面似乎工作。enter 事件处理控件的选项卡，并且 MouseDown 在单击控件时起作用。

```
 private ########### void textBox1_Enter(object sender, EventArgs e)
    {
        textBox1.SelectAll();
    }

    private void textBox1_MouseDown(object sender, MouseEventArgs e)
    {
        if (textBox1.Focused)
            textBox1.SelectAll();
    } 
```

* * *

## 回答 #28

> 赞同：-1
> 
> 时间：2010-04-15T18:05:13.770

我创建了一个新的 VB.Net Wpf 项目。我创建了一个 TextBox 并将以下代码用于代码隐藏：

```
Class MainWindow 

    Sub New()

        ' This call is required by the designer.
        InitializeComponent()

        ' Add any initialization after the InitializeComponent() call.
        AddHandler PreviewMouseLeftButtonDown, New MouseButtonEventHandler(AddressOf SelectivelyIgnoreMouseButton)
        AddHandler GotKeyboardFocus, New KeyboardFocusChangedEventHandler(AddressOf SelectAllText)
        AddHandler MouseDoubleClick, New MouseButtonEventHandler(AddressOf SelectAllText)
    End Sub

    Private Shared Sub SelectivelyIgnoreMouseButton(ByVal sender As Object, ByVal e As MouseButtonEventArgs)
        ' Find the TextBox
        Dim parent As DependencyObject = TryCast(e.OriginalSource, UIElement)
        While parent IsNot Nothing AndAlso Not (TypeOf parent Is TextBox)
            parent = VisualTreeHelper.GetParent(parent)
        End While

        If parent IsNot Nothing Then
            Dim textBox As Object = DirectCast(parent, TextBox)
            If Not textBox.IsKeyboardFocusWithin Then
                ' If the text box is not yet focussed, give it the focus and
                ' stop further processing of this click event.
                textBox.Focus()
                e.Handled = True
            End If
        End If
    End Sub

    Private Shared Sub SelectAllText(ByVal sender As Object, ByVal e As RoutedEventArgs)
        Dim textBox As Object = TryCast(e.OriginalSource, TextBox)
        If textBox IsNot Nothing Then
            textBox.SelectAll()
        End If
    End Sub

End Class 
```

* * *

## 回答 #29

> 赞同：-1
> 
> 时间：2014-04-02T13:19:38.213

答案实际上可能比上述所有内容都简单得多，例如（在 WPF 中）：

```
public void YourTextBox_MouseEnter(object sender, MouseEventArgs e)
    {
        YourTextBox.Focus();
        YourTextBox.SelectAll();
    } 
```

当然我不知道你想如何使用这段代码，但这里主要看的是：首先调用 .Focus() 然后调用 .SelectAll();

* * *

## 回答 #30

> 赞同：-1
> 
> 时间：2015-04-14T10:28:09.650

只需在输入和单击事件上使用 selectall()

```
private void textBox1_Enter(object sender, EventArgs e)
        {

            textBox1.SelectAll();
        }
        private void textBox1_Click(object sender, EventArgs e)
        {
            textBox1.SelectAll();
        } 
```

* * *

## 回答 #31

> 赞同：-1
> 
> 时间：2015-12-01T19:25:23.747

这在 .NET 2005 中为我工作-

```
 ' * if the mouse button is down, do not run the select all.
    If MouseButtons = Windows.Forms.MouseButtons.Left Then
        Exit Sub
    End If

 ' * OTHERWISE INVOKE THE SELECT ALL AS DISCUSSED. 
```

# .net - 水晶报表和 LINQ

> ID：97465
> 
> 赞同：12
> 
> 时间：2008-09-18T22:02:45.223
> 
> 标签：.net, linq, linq-to-sql, crystal-reports, reporting

有人知道如何将 Crystal Reports 与 Linq to SQL 一起使用吗？

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2011-10-07T19:01:35.613

您可以将您的 LINQ 结果集转换为 a `List`，您不必严格使用 a`DataSet`作为报表`SetDataSource`，您可以提供带有 a 的 Crystal Reports 数据`IEnumerable`。由于`List`继承自`IEnumerable`您可以将报表的数据源设置为列表，因此您只需`.ToList()`在 LINQ 结果集上调用该方法。基本上：

```
 CrystalReport1 cr1 = new CrystalReport1();

        var results = (from obj in context.tSamples
                      where obj.ID == 112
                      select new { obj.Name, obj.Model, obj.Producer }).ToList();

        cr1.SetDataSource(results);
        crystalReportsViewer1.ReportSource = cr1; 
```

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2008-09-19T03:28:43.287

[msdn doc](http://msdn.microsoft.com/en-us/library/ms227595(VS.80).aspx)建议您可以将 Crystal Report 绑定到 ICollection 。

我可以推荐一个 List(T) 吗？

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2008-09-19T03:10:08.493

尽管我自己没有尝试过，但似乎可以通过结合使用 DataContext.LoadOptions 使其渴望接受关系和 GetCommand(IQueryable) 返回一个保留关系的 SQLCommand 对象。

[在MSDN 论坛](http://forums.microsoft.com/msdn/ShowPost.aspx?PostID=3421530&SiteID=1)上查看更多信息。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2014-05-27T06:20:18.503

如果您有 dbnull 值，上述代码将无法在 Web 应用程序中运行。您必须将结果列表对象转换为数据集或数据表。没有内置的方法。我遇到了同样的问题，经过数小时在互联网上的探索，我找到了解决方案，并想在这里分享以帮助任何人坚持下去。你必须在你的项目中创建一个类：-

```
 public class CollectionHelper
    {
        public CollectionHelper()
        {
        }

        // this is the method I have been using
        public DataTable ConvertTo<T>(IList<T> list)
        {
            DataTable table = CreateTable<T>();
            Type entityType = typeof(T);
            PropertyDescriptorCollection properties = TypeDescriptor.GetProperties(entityType);

            foreach (T item in list)
            {
                DataRow row = table.NewRow();

                foreach (PropertyDescriptor prop in properties)
                {
                    row[prop.Name] = prop.GetValue(item) ?? DBNull.Value;
                }

                table.Rows.Add(row);
            }

            return table;
        }

        public static DataTable CreateTable<T>()
        {
            Type entityType = typeof(T);
            DataTable table = new DataTable(entityType.Name);
            PropertyDescriptorCollection properties = TypeDescriptor.GetProperties(entityType);

            foreach (PropertyDescriptor prop in properties)
            {
                // HERE IS WHERE THE ERROR IS THROWN FOR NULLABLE TYPES
                table.Columns.Add(prop.Name, Nullable.GetUnderlyingType(
            prop.PropertyType) ?? prop.PropertyType);
            }

            return table;
        }
    } 
```

在这里设置你的水晶报告

```
CrystalReport1 cr1 = new CrystalReport1();

            var results = (from obj in context.tSamples
                           where obj.ID == 112
                           select new { obj.Name, obj.Model, obj.Producer }).ToList();
            CollectionHelper ch = new CollectionHelper();
            DataTable dt = ch.ConvertTo(results);
            cr1.SetDataSource(dt);
            crystalReportsViewer1.ReportSource = cr1; 
```

# ruby-on-rails - Rails SSL Requirement 插件——它不应该在重定向到 https 之前检查您是否处于生产模式吗？

> ID：97468
> 
> 赞同：4
> 
> 时间：2008-09-18T22:03:06.190
> 
> 标签：ruby-on-rails, ssl, https

[看看 ssl_requirement 插件。](http://github.com/rails/ssl_requirement/tree/master/lib/ssl_requirement.rb)

它不应该检查您是否处于生产模式吗？我们在开发模式下看到重定向到 https，这看起来很奇怪。或者这是插件的正常行为？我认为它在过去的表现有所不同。

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2008-09-19T01:37:56.547

我猜他们认为您可能应该在开发模式下使用 HTTPS（可能带有自签名证书）。如果这不是所需的行为，那么没有什么能阻止您自己在开发环境中使用特殊套管 SSL 行为：

```
class YourController < ApplicationController
  ssl_required :update unless Rails.env.development?
end 
```

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2010-03-20T09:55:52.263

```
 def ssl_required?
    return false if local_request? || RAILS_ENV == 'test' || RAILS_ENV == 'development'
    super
  end 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-12-14T17:25:38.243

理想情况下，您应该测试您的应用程序是否在敏感阶段重定向到 https。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2010-01-28T07:43:16.560

在开发环境中要求 SSL 没有多大意义。

您可以将插件**ssl_required 存根吗？**使用 Rails 内置的模拟工具的方法。

在您的应用程序根目录下创建一个文件 test/mocks/development/application.rb

```
require 'controllers/application_controller'

class ApplicationController < ActionController::Base
  def ssl_required?
    false
  end
end 
```

这种方式在开发环境中永远不需要 SSL。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2011-07-16T06:21:12.993

实际上，通过 https 进行重定向是网络服务器的职责。在 Rails 中为每个请求添加额外的请求哈希验证是一个开销恕我直言。我写了 nginx [config](https://gist.github.com/711913)，其中包括以下重写：

重写 ^(.*) https://$host$1 永久；

# xml - 鉴于此 XML，是否有一个 xpath 可以为我提供“测试”和“名称”值？

> ID：97474
> 
> 赞同：0
> 
> 时间：2008-09-18T22:03:55.720
> 
> 标签：xml, xslt

我需要在 xsl:when 标记中获取“test”属性的值，以及在 xsl:call-template 标记中获取“name”属性的值。这个 xpath 让我非常接近：

```
..../xsl:template/xsl:choose/xsl:when 
```

但这只是返回'when'元素，而不是我需要的确切属性值。

这是我的 XML 的片段：

```
<xsl:template match="field">
    <xsl:choose>
    <xsl:when test="@name='First Name'">
        <xsl:call-template name="handleColumn_1" /> 
    </xsl:when>
</xsl:choose> 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2008-09-18T22:07:29.737

你想要`.../xsl:template/xsl:choose/xsl:when/@test`

如果您想真正从测试属性中获取值“名字”，那么您就不走运了——属性中的内容只是一个字符串，而不是一段 xml，所以你不能 xpath 它. 如果你需要得到它，你必须使用字符串操作（例如，子字符串）来获取正确的内容

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2008-09-18T22:42:32.897

史蒂夫库珀回答了第一部分。对于第二部分，您可以使用：

```
.../xsl:template/xsl:choose/xsl:when[@test="@name='First Name'"]/xsl:call-template/@name 
```

这将专门匹配上面代码片段中的 xsl:when 。如果您希望它一般匹配，那么您可以使用：

```
.../xsl:template/xsl:choose/xsl:when/xsl:call-template/@name 
```

# database - 如何从进度数据库中获取 ROWID

> ID：97480
> 
> 赞同：4
> 
> 时间：2008-09-18T22:04:30.257
> 
> 标签：database, progress-4gl, progress-db

我有一个正在执行 ETL 的 Progress 数据库。我正在读取的表之一没有唯一键，因此我需要访问 ROWID 才能唯一标识该行。访问正在进行的 ROWID 的语法是什么？

我知道使用 ROWID 进行行识别存在问题，但这就是我现在所拥有的。

* * *

## 回答 #1

> 赞同：8
> 
> 时间：2008-09-19T08:12:16.943

对我的回答有一个简短的警告-自从我与[Progress](http://www.progress.com/)合作以来已经将近 10 年了，所以我的知识可能已经过时了。

检查[进度语言参考](http://www.psdn.com/library/servlet/KbServlet/download/1078-102-885/langref.pdf)[PDF] 似乎显示了我记得的两个功能仍然存在：`ROWID`和`RECID`. 该`ROWID`功能较新，是首选。

在 Progress 4GL 中，你会像这样使用它：

```
FIND customer WHERE cust-num = 123.
crowid = ROWID(customer). 
```

或者：

```
FIND customer WHERE ROWID(customer) = crowid EXCLUSIVE-LOCK. 
```

检查[Progress SQL Reference](http://www.psdn.com/library/servlet/KbServlet/download/1223-102-1092/s92.pdf) [PDF] 显示`ROWID`在 SQL 中也可以作为 Progress 扩展。你会像这样使用它：

```
SELECT ROWID, FirstName, LastName FROM customer WHERE cust-num = 123 
```

**编辑：**根据 Stefan 的反馈进行编辑。

* * *

## 回答 #2

> 赞同：5
> 
> 时间：2009-06-22T12:13:00.210

根据您的情况和应用程序的行为，这可能会或可能不重要，但您应该知道 ROWID 和 RECID 被重用并且它们可能会改变。

1）如果一条记录被删除，它的ROWID最终将被重用。

2) 如果表通过转储和加载或 tablemove 重新组织到新的存储区域，则 ROWID 将更改。

* * *

## 回答 #3

> 赞同：3
> 
> 时间：2008-09-19T15:31:28.920

只是为戴夫韦伯的答案添加一点。我曾在 select 语句中尝试过 ROWID，但出现语法错误。ROWID 仅在您指定要选择的其余列时才有效，您不能使用 *.

这不起作用：

```
SELECT ROWID, * FROM customer WHERE cust-num = 123 
```

这确实有效：

```
SELECT ROWID, FirstName, LastName FROM customer WHERE cust-num = 123 
```

* * *

## 回答 #4

> 赞同：-2
> 
> 时间：2008-09-18T22:16:23.787

一个快速的谷歌搜索出现了这个： [http ://bytes.com/forum/thread174440.html](http://bytes.com/forum/thread174440.html)

通过 greg@turnstep.com 阅读底部的消息（您需要 oid 或 ctid，具体取决于您想要重新持久性和唯一性的保证）

# ajax - 是否有任何免费的 java/flash 图像编辑器插件/小程序可以包含在我的站点中？

> ID：97484
> 
> 赞同：0
> 
> 时间：2008-09-18T22:05:04.017
> 
> 标签：ajax, image-manipulation, web-based, image-editor

我目前正在重新开发电子商务后端系统，我想知道这里是否有人遇到过免费的 ajax 脚本/插件/flash 文件，它可以让我们的用户上传图像并提供一些基本的编辑工具，即裁剪、旋转、调整大小？

我们目前有一个使用 GD 库的基于 PHP 的图像大小调整工具，它可以简单地将图像缩小到正确的尺寸，但我希望我们可以添加一些 Flickr 风格的功能，以便在将图像放置在网站上之前稍微修饰一下它们的图像。

我不太在意它是什么语言或它是如何实现的。重要的是它是免费的（或便宜的）并且可以用于商业用途。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2008-09-19T02:14:05.180

[AJAX 图像编辑器](http://www.ajaxprogrammer.com/?p=9)似乎是更受欢迎的免费选择之一。它提供裁剪、调整大小、一些效果等。

# c# - 将空值绑定到 Web 用户控件的属性

> ID：97505
> 
> 赞同：2
> 
> 时间：2008-09-18T22:08:04.307
> 
> 标签：c#, .net, asp.net

在一个有点复杂的页面上工作，用于在工作中配置客户。设置是有一个主页，其中包含用于各种设置的各种“面板”。

在一种情况下，主表上有一个电子邮件地址字段和一个“导出”配置，用于控制电子邮件的发送方式。我创建了一个选择公司并绑定到 FormView 的主面板。FormView 包含一个 Web 用户控件，用于处理导出详细信息的显示/配置。

Web 用户控件包含一个属性来定义它应该处理哪个 Config，它使用 Bind() 从 FormView 获取值。

基本上控件是这样使用的：

```
<syn:ExportInfo ID="eiConfigDetails" ExportInfoID='<%# Bind("ExportInfoID" ) %>' runat="server" /> 
```

被绑定的属性在 CodeBehind 中是这样声明的：

```
public int ExportInfoID    
{
    get
    {
        return Convert.ToInt32(hfID.Value);
    }
    set
    {
        try
        {
            hfID.Value = value.ToString();
        }
        catch(Exception)
        {
            hfID.Value="-1";
        }
    }
} 
```

每当`ExportInfoID`is null 我得到一个空引用异常，但最重要的是它发生在它实际尝试设置属性之前（或者它会在这个版本中被捕获。）

任何人都知道发生了什么，或者更重要的是，如何解决它......？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2008-09-18T22:12:50.270

似乎是因为`hfID.Value`尚未初始化为值，因此无法转换。您可能想在您的 getter 中添加一个空检查或一些验证，以确保`hfID.Value`它不为空并且是数字。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2008-09-18T22:17:24.440

Bind 无法将 null 值转换为 int 值，以设置 ExportInfoID 属性。这就是为什么它不会被您的代码捕获的原因。您可以将属性设为可为空的类型（int？），或者您可以在绑定逻辑中处理 null。

所以会是这样的

```
bind receives field to get value from
bind uses reflection to get the value
bind attempts to set the ExportInfoID property // boom, error 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2008-09-18T22:20:08.630

在 hfID 上使用空对象设计模式

[http://www.cs.oberlin.edu/~jwalker/nullObjPattern/](http://www.cs.oberlin.edu/~jwalker/nullObjPattern/)

# c - if 语句的格式

> ID：97506
> 
> 赞同：9
> 
> 时间：2008-09-18T22:08:15.647
> 
> 标签：c, if-statement

**这不是一场圣战，这不是“哪个更好”的问题。**

对单个语句 if 块使用以下格式的优点是什么。

```
if (x) print "x is true";

if(x) 
    print "x is true"; 
```

相对于

```
if (x) { print "x is true"; }
if(x) {
    print "x is true";    
} 
```

**如果你格式化你的单个语句 ifs 没有括号**或知道一个程序员这样做，是什么导致你/他们首先采用这种风格？我对这给你带来了什么好处特别感兴趣。

**更新**：由于最受欢迎的答案忽略了实际问题（即使它提出了最理智的建议），这里是无括号专业人士的综述。

1.  紧凑
2.  对某些人来说更具可读性
3.  括号调用范围，在某些情况下具有理论上的开销

* * *

## 回答 #1

> 赞同：51
> 
> 时间：2008-09-18T22:11:01.863

我发现这个：

```
if( true ) {
    DoSomething();
} else {
    DoSomethingElse();
} 
```

比这更好：

```
if( true )
    DoSomething();
else
    DoSomethingElse(); 
```

这样，如果我（或其他人）稍后返回此代码以向其中一个分支添加更多代码，我将不必担心忘记将代码括在大括号中。我们的眼睛会在视觉上将缩进视为我们正在尝试做的事情的线索，但大多数语言不会。

* * *

## 回答 #2

> 赞同：48
> 
> 时间：2008-09-18T22:09:31.073

**我非常不喜欢任何将 if 的测试和正文放在同一行的样式。**

这是因为共享行使得在许多调试器中无法在 if 的主体上设置断点，因为断点通常基于行号。

* * *

## 回答 #3

> 赞同：34
> 
> 时间：2008-09-19T01:13:55.187

总是使用大括号是个好主意，但标准答案总是给出“如果有人添加一行代码并忘记添加大括号怎么办？” 是一个相当薄弱的理由。

有一个微妙的错误可以通过从一开始就没有大括号来引入。这在我身上发生过几次，我也看到它发生在其他程序员身上。

它从一个简单的 if 语句开始，很天真。

```
if (condition)
    do_something();
else
    do_something_else(); 
```

这一切都很好。

然后有人出现并在 if 中添加了另一个条件。他们无法使用 && 将其添加到 if 语句本身，因为逻辑不正确，因此他们添加了另一个 if。我们现在有：

```
if (condition)
    if (condition2)
        do_something();
else
    do_something_else(); 
```

你看到问题了吗？它可能看起来正确，但编译器的看法不同。它是这样看的：

```
if (condition)
    if (condition2)
        do_something();
    else
        do_something_else(); 
```

这意味着完全不同的东西。编译器不关心格式。else 与最近的 if 一起使用。另一方面，人类依赖于格式化，很容易错过这个问题。

* * *

## 回答 #4

> 赞同：21
> 
> 时间：2008-09-18T22:11:15.187

我总是用

```
if(x) 
{
    print "x is true";    
} 
```

省略大括号可能会导致维护代码的人错误地认为如果他们在当前行之后添加一行，他们正在添加到 if 子句。

* * *

## 回答 #5

> 赞同：14
> 
> 时间：2008-09-18T23:06:31.467

我用

```
如果 (x)
{
    做点什么（）;
}

```

对于多行，但我更喜欢无括号的单行：

```
如果 (x)
   做点什么（）;
别的
   DoSomethingElse();

```

我发现多余的括号在视觉上令人反感，而且我从来没有犯过上述错误之一，在添加另一个语句时不添加括号。

* * *

## 回答 #6

> 赞同：8
> 
> 时间：2008-09-18T22:11:35.997

```
if
{
// code
}
else 
{
// else code
} 
```

因为我喜欢代码块排成一行（包括它们的大括号）。

* * *

## 回答 #7

> 赞同：7
> 
> 时间：2008-09-18T22:14:02.030

如果我编码：

```
if(x) 
    print "x is true"; 
```

并且 6 个月后需要添加一个新行，大括号的存在使我输入的可能性大大降低

```
if(x) 
    print "x is true";
    print "x is still true"; 
```

这将导致逻辑​​错误，而不是：

```
if(x) { 
    print "x is true";
    print "x is still true";
} 
```

因此，我发现花括号使此类逻辑错误更易于阅读和避免。

* * *

## 回答 #8

> 赞同：7
> 
> 时间：2008-09-18T23:14:23.973

像马特（上面的 3 个）一样，我更喜欢：

```
if (x)
{
    ...statement1
    ...statement2
} 
```

和

```
if (x)
    ...statement
else
    ...statement 
```

我认为认为有人可能稍后出现并且没有意识到他们必须添加大括号以形成多行 if 块是很奇怪的。如果这超出了他们的能力，我想知道还有什么！

* * *

## 回答 #9

> 赞同：5
> 
> 时间：2008-09-18T22:17:17.327

单语句 if 块缺少大括号：

优点：

*   更少的字符
*   更清洁的外观

缺点：

*   均匀性：如果块看起来相同，则并非所有
*   向块中添加语句时可能出现错误：用户可能忘记添加大括号，新语句将不会被 if 覆盖。

> 如：

```
if(x) 
    print "x is true";
    print "something else"; 
```

* * *

## 回答 #10

> 赞同：5
> 
> 时间：2008-09-18T23:14:22.197

当我在函数开头测试中断条件时，我倾向于只使用单行代码，因为我喜欢让这段代码尽可能简单和整洁

```
public void MyFunction(object param)
{
     if (param == null) return;

     ...
} 
```

另外，如果我发现我确实想避免使用大括号并内联 if 子句代码，我可以将它们单行，这样对于任何在 if 需要添加括号的人添加新行的人来说都是显而易见的

* * *

## 回答 #11

> 赞同：4
> 
> 时间：2008-09-18T22:14:52.743

我用

```
if (cond) {
  ...
} else {
  ...
} 
```

*   一切都应该总是有大括号。即使现在我在 if 块中只有一行，我稍后也会添加更多。
*   我不会把大括号放在他们自己的线上，因为这是毫无意义的浪费空间。
*   为了便于阅读，我很少将块与条件放在同一行。

* * *

## 回答 #12

> 赞同：4
> 
> 时间：2008-09-18T22:34:19.953

[Joel Spolsky](https://stackoverflow.com/users/4/joel-spolsky)写了一篇很好的文章：[让错误的代码看起来是错误的](http://www.joelonsoftware.com/articles/Wrong.html)

他专门解决了这个问题……

> ```
> if (i != 0)  
>     foo(i); 
> ```
> 
> 在这种情况下，代码是 100% 正确的；它符合大多数编码约定并且没有任何问题，但是 if 语句的单语句体没有括在大括号中的事实可能会困扰您，因为您可能在脑后思考，天哪，某人可能会在那里插入另一行代码
> 
> ```
> if (i != 0)
>     bar(i);
>     foo(i); 
> ```
> 
> …忘记添加大括号，从而意外地使 foo(i) 成为无条件的！因此，当您看到不在大括号中的代码块时，您可能会感觉到一点点的不干净，这让您感到不安。

他建议你……

> ... 故意以这样一种方式构建您的代码，使您对不洁的嗅觉使您的代码更有可能是正确的。

* * *

## 回答 #13

> 赞同：4
> 
> 时间：2008-09-18T23:14:35.347

我不喜欢在不需要时使用大括号。我觉得它使方法中的行数膨胀并使其不可读。所以我几乎总是选择以下内容：

```
if (x)
   print "x is true"
for (int i=0; i<10; i++)
   print "y is true" 
```

等等。如果有人需要添加另一个语句，那么他可以添加大括号。即使你没有 R# 或类似的东西，这也是一笔小买卖。

尽管如此，在某些情况下，即使语句中只有一行，我也会使用大括号，那就是如果该行特别长，或者如果我需要在那个“if”中添加注释。基本上，我只是用我的眼睛看起来更好看的东西。

* * *

## 回答 #14

> 赞同：3
> 
> 时间：2008-09-18T22:10:50.227

空白是你的朋友....

但是，话又说回来，我喜欢：

```
if (foo)
{
    Console.WriteLine("Foobar");
} 
```

* * *

## 回答 #15

> 赞同：3
> 
> 时间：2008-09-18T23:14:12.883

说真的，你最后一次在任何地方的任何代码中出现导致某人这样做的错误是什么时候：

```
if (a)
  foo();
  bar(); 
```

是的，从不……*这里唯一真正的“专业”就是匹配周围代码的风格，而将审美之争留给刚从大学毕业的孩子们。

*（警告当 foo(); bar(); 是宏扩展时，但这是宏的问题，而不是大括号的问题/ ifs。）

* * *

## 回答 #16

> 赞同：3
> 
> 时间：2008-09-18T23:45:15.803

```
if (x) {
    print "x is true";    
}
else {
    do something else;
} 
```

我总是打大括号。这只是一个好习惯。与思考相比，打字不是“工作”。

注意条件句前的空格。这有助于它看起来不像一个方法调用。

* * *

## 回答 #17

> 赞同：3
> 
> 时间：2015-03-04T19:41:54.807

另一种方法是写：

```
(a==b) ? printf("yup true") : printf("nop false"); 
```

如果您想存储一个比较简单条件的值，这将是实用的，如下所示：

```
int x = (a==b) ? printf("yup true") : printf("nop false"); 
```

* * *

## 回答 #18

> 赞同：2
> 
> 时间：2008-09-18T22:15:10.497

```
if (x)
{
    print "x is true";
} 
```

在同一列中打开和关闭大括号可以轻松找到不匹配的大括号，并在视觉上隔离块。在与“if”相同的列中打开大括号可以很容易地看出该块是条件的一部分。由仅包含大括号的行创建的块周围的额外空白使得在浏览代码时很容易挑选出它的逻辑结构。当人们稍后编辑代码并误读哪些语句是条件的一部分而哪些不是时，总是显式地使用大括号有助于避免问题 - 缩进可能与现实不符，但用大括号括起来总是会的。

* * *

## 回答 #19

> 赞同：2
> 
> 时间：2008-09-19T05:33:51.660

大约唯一一次似乎接受无支撑是在方法开始时检查参数时：

```
public int IndexOf(string haystack, string needle)
{
    // check parameters.
    if (haystack == null)
        throw new ArgumentNullException("haystack");
    if (string.IsNullOrEmpty(needle))
        return -1;

    // rest of method here ... 
```

唯一的好处是紧凑。当很明显：

*   该方法在任何真正的分支上退出
*   很明显，这些都是 1-liner

也就是说，出于其他人所述的原因，我将始终{} 用于程序逻辑。当您放下大括号时，很容易在没有大括号的情况下精神上支持并引入微妙的代码缺陷。

* * *

## 回答 #20

> 赞同：2
> 
> 时间：2016-06-07T10:20:16.677

H8ers 该死的我不是一个真正的教条规则的人。在某些情况下，如果它没有超过一定的宽度，我实际上会支持紧凑性，例如：

```
if(x > y)      { xIsGreaterThanY(); }
else if(y > x) { yIsGreaterThanX; }
else           { xEqualsY(); } 
```

这对我来说比以下更具可读性：

```
if( x > y ){
    xIsGreaterThanY(); 
}else if( x < y){
    yIsGreaterThanX();
}else{
    xEqualsY();
} 
```

这具有鼓励人们将逻辑抽象到方法中的额外好处（就像我所做的那样），而不是将更多逻辑集中到嵌套的 if-else 块中。它也占用了三行而不是七行，这可能使得不必滚动即可查看多个方法或其他代码。

* * *

## 回答 #21

> 赞同：1
> 
> 时间：2008-09-18T22:14:35.303

我更喜欢括号样式，主要是因为它给眼睛一个清晰的起点和终点。它使查看语句中实际包含的内容变得更容易，并且它实际上是一个 if 语句。也许是一件小事，但这就是我使用它的原因。

* * *

## 回答 #22

> 赞同：1
> 
> 时间：2008-09-18T22:14:49.780

只要它在你工作的团队中是一致的，那么这并不重要

每个人都做同样的事情是主要的

* * *

## 回答 #23

> 赞同：1
> 
> 时间：2008-09-18T22:15:16.067

如果您（或其他维护或更改代码的编码人员）需要在该条件块的某些部分添加语句，则将您的单行 if 语句括起来具有相当大的理智优势，可以保护您免受头痛。

* * *

## 回答 #24

> 赞同：1
> 
> 时间：2008-09-18T22:19:18.210

不管怎样，这就是我要走的路！它看起来最好。

```
If(x)
{
    print "Hello World !!"
}
Else
{
    print "Good bye!!"
} 
```

* * *

## 回答 #25

> 赞同：1
> 
> 时间：2008-09-18T22:25:08.553

如果您对各种代码格式样式的名称感到好奇，维基百科有一篇关于[缩进样式](http://en.wikipedia.org/wiki/Indent_style)的文章。

* * *

## 回答 #26

> 赞同：1
> 
> 时间：2008-09-18T22:49:16.563

如果你做这样的事情：

```
if(x)
{
    somecode;
}
else
{
    morecode;
} 
```

这对于长期存在的代码的源代码控制和预处理器指令效果更好。添加#if 左右会更容易，而不会无意中破坏语句或不必添加额外的行。

习惯了有点奇怪，但一段时间后效果很好。

* * *

## 回答 #27

> 赞同：1
> 
> 时间：2008-09-18T23:24:51.093

如果它是 if 的一行（以及可选的 else 行），我宁愿不使用括号。它更具可读性和简洁性。我说我更喜欢它，因为这纯粹是一个偏好问题。尽管我认为试图强制执行必须始终使用大括号的标准有点愚蠢。

如果您不得不担心有人在 if 语句的主体中添加另一行而不添加（仅需要）大括号，我认为您的问题比次拜占庭编码标准更大。

* * *

## 回答 #28

> 赞同：1
> 
> 时间：2008-09-19T04:21:40.680

```
/* I type one liners with brackets like this */
if(0){return(0);}
/* If else blocks like this */
if(0){
    return(0);
}else{
    return(-1);
} 
```

我从不在制表符之外使用多余的空格，但总是包含括号可以节省大量时间。

* * *

## 回答 #29

> 赞同：1
> 
> 时间：2008-09-30T20:10:00.507

我不喜欢在同一行使用以下关键字的右大括号：

```
如果 (x) {
    打印“x 为真”；    
} 别的 {
    做点别的事情；
}

```

这使得仅删除/注释掉 else 子句变得更加困难。通过将 follow 关键字放在下一行，我可以利用编辑器，例如，让我选择一系列行，并一次注释/取消注释它们。

```
如果 (x) {
    打印“x 为真”；    
}
//别的 {
// 做其他事情；
//}

```

* * *

## 回答 #30

> 赞同：1
> 
> 时间：2008-09-30T20:14:57.187

我总是喜欢这个：

```
if (x) doSomething();

if (x) {
    doSomthing();
    doOtherthing();
} 
```

但始终取决于您正在执行的语言和操作。有时我喜欢戴牙套，有时不喜欢。取决于代码，但我编码就像必须写一次，重写十次，读一百次；所以，随心所欲地去做，就像你想更快地阅读和理解一样

* * *

## 回答 #31

> 赞同：0
> 
> 时间：2008-09-18T22:12:53.483

对我来说，大括号更容易看到程序的流程。它还可以更轻松地将语句添加到 if 语句的主体。当没有大括号时，您必须添加大括号才能添加另一个语句。

我想不使用大括号的优点是它看起来更干净，而且你不会浪费一条带右大括号的线。

* * *

## 回答 #32

> 赞同：0
> 
> 时间：2008-09-18T22:13:40.407

行间距和缩进对可读性有很大帮助。

就可读性而言，我更喜欢以下内容：

```
// Do this if you only have one line of code
// executing within the if statement
if (x)
    print "x is true";

// Do this when you have multiple lines of code
// getting executed within the if statement    
if (x)
{
    print "x is true";
} 
```

* * *

## 回答 #33

> 赞同：0
> 
> 时间：2008-09-18T22:56:59.740

我希望 IDE 会强制执行这种行为。正如您正确指出的那样，没有“正确”的行为。一致性更重要……它可以是任何一种风格。

* * *

## 回答 #34

> 赞同：0
> 
> 时间：2008-09-19T01:29:39.547

到目前为止，我觉得自己的投票被否决了，但我会保证以下之一：

```
if (expr) {
   funcA();
}
else {
   funcB();
} 
```

或者，在有限的情况下为了可读性而简写：

```
if (expr) funcA();
else funcB(); 
```

对我来说，当您希望它像英语语法一样阅读时，速记格式很好。如果代码看起来不够可读，我将换行：

```
if (expr)
   funcA();
else
   funcB(); 
```

经过仔细考虑，我不会在`if`/`else`块中放置嵌套条件以避免编码器/编译器的歧义。如果它比这更复杂，我在`if`和`else`块上都使用大括号。

* * *

## 回答 #35

> 赞同：0
> 
> 时间：2008-09-19T05:54:02.593

这种类型的任何格式都可以。人们会在这个问题上与你争论不休，因为它很容易理解。人们喜欢谈论他们理解的事情，而不是处理更大的问题，比如好的设计和用新算法解决难题。对于简单的单行，我倾向于不使用括号。但是，我也很高兴用括号来阅读它。如果给定项目有特定的样式指南，我更愿意遵循它。我相信对正确性的一些主观理想的一致性。

我个人对单行不加括号的选择是由于键入的字符更少、代码更短且简洁。

* * *

## 回答 #36

> 赞同：0
> 
> 时间：2008-09-19T15:52:45.983

在提供的选项中，我会选择

```
if (x) {
  print "x is true";    
} 
```

仅仅因为大括号是打字的习惯。

但实际上，作为一个主要使用 Perl 的程序员，我更有可能使用

```
print "x is true" if x; 
```

（当我使用不支持后缀条件的语言时，这总是让我感到困惑。）

* * *

## 回答 #37

> 赞同：0
> 
> 时间：2008-09-20T23:21:28.160

我更喜欢不带括号的单行语句，我知道插入新代码行时可能会忘记添加它们，但我不记得上次发生这种情况是什么时候。我的编辑器（vim）阻止我写这样的东西：

```
 if (x)
    x = x + 1;
    printf("%d\n", x); 
```

因为它会以不同的方式缩进。我唯一遇到的问题是写得不好的宏：

```
 #define FREE(ptr) {free(ptr); ptr = NULL;}

if (x)
    FREE(x);
else
    ... 
```

这当然行不通，但我认为最好修复宏，以避免那些可能的错误或问题，而不是更改格式化样式。

因此，这种格式化方式可能存在问题，但它们并不是致命的。它最终成为一个品味问题。

* * *

## 回答 #38

> 赞同：0
> 
> 时间：2008-09-23T01:19:04.567

我还没有看到有人提到将括号与 emacs 中的 if -- 括号匹配放在同一行的最有用的原因。当您将光标放在结束括号上时，emacs 会显示带有匹配开始括号的行。将开始括号放在自己的行上，否定该功能。

* * *

## 回答 #39

> 赞同：0
> 
> 时间：2008-09-23T01:43:31.093

我更喜欢以下...我认为它看起来更干净。

```
if(x)
{
    code;
}
else
{
     other code;
} 
```

* * *

## 回答 #40

> 赞同：0
> 
> 时间：2009-07-10T04:52:11.613

我想我比我想象的更离群。我还没有注意到这个。

我是

```
if (x)
{ foo(); } 
```

它感觉紧凑且可读（我讨厌大括号），但它使条件的范围明确。

它也比单行 if 对断点更友好。在我的大括号换行符世界中，它也让我感觉更自在：

```
if (x)
{ foo(); }
else
{
   bar();
   baz();
} 
```

**编辑**：看来我误读了原始问题，所以这个答案离题了。不过，我仍然对任何回应感到好奇。

* * *

## 回答 #41

> 赞同：0
> 
> 时间：2009-07-10T05:21:48.497

一个衬垫就是……一个衬垫，应该保持这样：

```
if (param == null || parameterDoesNotValidateForMethod) throw new InvalidArgumentExeption("Parameter null or invalid"); 
```

例如，我喜欢这种用于参数检查的风格，它紧凑且通常易于阅读。我过去一直使用带有缩进代码的大括号，但发现在许多微不足道的情况下它只是浪费了显示器上的空间。在某些情况下放下大括号使我能够更快地进入方法的实质，并使整体呈现更容易在眼睛上。但是，如果它涉及更多，那么我会像对待其他所有事物一样对待它，并且会像这样全力以赴：

```
if (something)
{
    for(blablabla)
    {
    }
}else if
{
 //one liner or bunch of other code all get the braces
}else
{
  //... well you get the point
} 
```

话虽这么说...我鄙视同一行的大括号，如下所示：

```
if(someCondition) { doSimpleStuff; } 
```

最坏的

```
if(somethingElse){
  //then do something
} 
```

它更紧凑，但我发现很难跟踪牙套。

总的来说，这更像是个人品味的问题，只要一个人不采用某种非常奇怪的方式来缩进和支撑......

```
 if(someStuff)
        {
  //do something
        } 
```

* * *

## 回答 #42

> 赞同：0
> 
> 时间：2017-08-22T22:59:08.170

我相信这是最重要的原因，我很惊讶地看到它还没有作为答案给出（尽管它已经在[评论](https://stackoverflow.com/q/97506/1672723#comment15865_97526)中提到，在答案中的脚注和[答案中](https://stackoverflow.com/q/97506/1672723#97917)[的](https://stackoverflow.com/a/109750/1672723)旁白））。

你应该总是使用括号，因为

```
if (x)
   DoSomething(); 
```

`DoSomething`如果随后被重新定义为多语句宏，则中断：

```
#define DoSomething()          *语句[1]* ;  *声明[2]*；
```

当然，[我们都知道](https://stackoverflow.com/q/154136/1672723 "为什么在宏中使用看似毫无意义的 do-while 语句？")正确的做法是像这样定义宏：

```
#define DoSomething()    做 {  *语句[1]* ;  *声明[2]*；  } 而 (0)
```

这使得宏的行为更像是一个语句。

也就是说，我承认我没有听从自己的建议。当我有（看起来是）单个语句时，我通常不使用大括号。（羞愧地低着头。）

# user-interface - 我可以使用哪些库来构建带有 Erlang 的 GUI？

> ID：97508
> 
> 赞同：46
> 
> 时间：2008-09-18T22:08:17.283
> 
> 标签：user-interface, erlang

我可以使用哪些库来为 Erlang 应用程序构建 GUI？请每个答案选择一个。

* * *

## 回答 #1

> 赞同：27
> 
> 时间：2009-04-30T22:46:27.777

对于 Erlang 中的 GUI 应用程序，您应该使用 r13b 版本中包含的 wxErlang。Beta 版的源代码已经存在了一段时间，但现在，自 r13a 以来，它已包含在主要的 OTP 版本中。

* * *

## 回答 #2

> 赞同：18
> 
> 时间：2008-09-18T22:12:38.087

大多数人不会在 Erlang 中编写实际的 GUI。更常见的方法是用 Java 或 C# 编写 GUI 层，然后通过套接字或管道与您的 Erlang 应用程序通信。

考虑到这一点，您可能想要查看各种库以在 java 或 .Net 应用程序和 Erlang 之间进行 RPC：

[http://weblogs.asp.net/nleghari/archive/2008/01/08/integrating-net-and-erlang-using-otp-net.aspx](http://weblogs.asp.net/nleghari/archive/2008/01/08/integrating-net-and-erlang-using-otp-net.aspx)

[http://www.theserverside.com/tt/articles/article.tss?l=IntegratingJavaandErlang](http://www.theserverside.com/tt/articles/article.tss?l=IntegratingJavaandErlang)

**编辑** 如果你真的打算在 erlang 中编写一个界面，你可能会考虑做一个基于 web 的 GUI，通过 Yaws 服务，erlang web 服务器：http: [//yaws.hyber.org/appmods.yaws](http://yaws.hyber.org/appmods.yaws)

* * *

## 回答 #3

> 赞同：16
> 
> 时间：2008-09-22T08:18:21.917

我将违反“每个帖子一个选项”的要求 - 抱歉，但使用哪种工具实际上取决于您的优先级。

一个相当稳定的库是[gtkNode](https://github.com/massemanet/gtknode)。它使用一种简单但强大的方式将所有 GTK 小部件映射到 Erlang，并且应该在各个版本中继续保持稳定。它也适用于 Glade GUI 构建器。它由 Erlang 大师 Mats Cronqvist 积极维护，但它当然是尽力而为。

WxWidgets 很有前途，有望成为 Erlang 的主要 GUI 库，但它仍处于 beta 阶段，界面还不稳定，也没有承诺向后兼容。

因此，如果您想走在最前沿，WxWidgets 可能就是您的选择。否则，gtkNode 应该为您提供一个相对容易和安全的漂亮 GUI。

Erlang 唯一官方支持的 GUI 库是[GS](http://www.erlang.org/doc/apps/gs/index.html)，它是 OTP 版本的一部分，并保证与即将发布的版本一起使用。因此，如果这比原生外观和现代外观更重要，它可能是一种选择。

* * *

## 回答 #4

> 赞同：5
> 
> 时间：2008-09-21T18:52:12.993

我发现有人想用 Erlang 以外的东西为 Erlang 程序编写 GUI 有点令人费解？Erlang 的并发模型使其成为编写 GUI 的优秀语言。UI 元素和事件完美地映射到 Erlang 进程和消息。

* * *

## 回答 #5

> 赞同：4
> 
> 时间：2008-09-19T07:06:55.990

对于为 Erlang 编写本机 GUI，[wxErlang](http://erlang.org/doc/apps/wx/chapter.html)似乎是当今最成熟的库（也在[SourceForge 上](http://sourceforge.net/projects/wxerlang/)）。

* * *

## 回答 #6

> 赞同：3
> 
> 时间：2010-05-13T00:07:20.937

我在[http://wxerlang.dougedmunds.com上发布了一个 wxErlang 教程](http://wxerlang.dougedmunds.com)

* * *

## 回答 #7

> 赞同：2
> 
> 时间：2008-09-18T22:20:44.273

我不确定有没有……但我在网上找到[了 Erlbol](http://erlbol.dougedmunds.com/)，还有一个听起来很有趣的[X11 GUI](http://projects.openmoko.org/forum/forum.php?forum_id=397)，还有[GTK2](http://www.erlang.se/euc/05/1620cronqvist.pdf)（pdf 链接）

* * *

## 回答 #8

> 赞同：2
> 
> 时间：2019-06-05T14:57:06.530

有用于构建前端的新兴[**Scenic库。**](https://github.com/boydm/scenic)它具有的特定于 erlang 的方法看起来很有希望。

# python - 如何在 Komodo 中将 python 模块加载到新的交互式 shell 中？

> ID：97513
> 
> 赞同：2
> 
> 时间：2008-09-18T22:09:21.353
> 
> 标签：python, shell, interpreter, komodo

使用 PyWin 时，我可以轻松地将 python 文件加载到新的交互式 shell 中，我发现这对于原型设计和其他探索性任务非常方便。

我想使用 Komodo 作为我的 python 编辑器，但我还没有找到替代 PyWin 重新启动 shell 和重新加载当前模块的能力。我怎样才能在科莫多做到这一点？

对我来说也很重要的是，当我重新加载时，我会得到一个新的外壳。如果我以前的交互在 shell 历史中，我会更喜欢它，但对我来说更重要的是内存与以前的版本和尝试隔离。

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2008-09-18T22:25:29.520

我使用 Komodo Edit，它可能没有完整的 Komodo 复杂一点。

我创建了一个“新命令”`%(python) -i %f`作为命令的文本。我在“新控制台”中运行。我通常将起始目录设置为 %p，即项目目录的顶部。

-i 选项运行文件并进入交互式 Python。

# c# - NHibernate、审计和计算列值

> ID：97520
> 
> 赞同：4
> 
> 时间：2008-09-18T22:10:23.393
> 
> 标签：c#, .net, nhibernate

当通过 NHibernate 更新/插入实体而不扩展具有特殊属性的域类时，如何设置一些特殊的列值？

例如，每个表都包含审计列，如 CreatedBy、CreatedDate、UpdatedBy、UpdatedDate。但我不想将这些属性添加到域类中。我想保持域模型 Percistence Ignorance 尽可能高。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2008-09-18T23:20:12.900

您可能想尝试查看 NHibernate 的 IUserType。

在下一页的底部是一个示例，其中 ayende 从实体中删除了一些加密逻辑并允许 NHibernate 处理它。

[http://ayende.com/Blog/archive/2008/07/31/Entities-dependencies-best-practices.aspx](http://ayende.com/Blog/archive/2008/07/31/Entities-dependencies-best-practices.aspx)

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2008-09-19T10:47:22.217

在对 NHibernate 进行了几个小时的黑客攻击后，我发现了如何使域层类与基础设施层隔离的妥协解决方案。这里只有一个“受害者”是下面列表中的第 1 点：

1）我已经为域中的所有可持久实体引入了基类 DomainObject ，只有一个私有字段：

```
private IDictionary _infrastructureProperties = new Dictionary<object, object>(); 
```

2) 在类映射中添加以下部分：

```
<dynamic-component name='_infrastructureProperties' access='field'>
  <property name='CreateBy' column='CreatedBy' />
  <property name='CreateDate' column='CreatedDate' />
</dynamic-component> 
```

3) 实现了一个设置这些属性值的拦截器。

4) 可选。我们也可以通过配置每个类在应用程序中扮演的“角色”来实现一种设置，然后在拦截器中使用角色特定的属性。例如，此配置可能声明 Product 是 TenantScopeObject 并且拦截器将在当前租户身份的值中设置名为 TenantID 的属性记录在系统中。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2011-04-18T23:22:16.587

请注意，对于搜索引擎旅行者，使用 NH v2.0 及更高版本，现在使用事件侦听器执行此操作非常优雅：

*例子：*

[http://ayende.com/Blog/archive/2009/04/29/nhibernate-ipreupdateeventlistener-amp-ipreinserteventlistener.aspx](http://ayende.com/Blog/archive/2009/04/29/nhibernate-ipreupdateeventlistener-amp-ipreinserteventlistener.aspx)

*手动的：*

[http://knol.google.com/k/fabio-maulo/nhibernate-chapter-11-interceptors-and/1nr4enxv3dpeq/14](http://knol.google.com/k/fabio-maulo/nhibernate-chapter-11-interceptors-and/1nr4enxv3dpeq/14)

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2008-09-18T22:26:33.667

这与“不添加这些属性”不同，但上次我看到这个时，工程师通过实现具体的 NHibernate 类并从实现您不喜欢的属性的通用抽象基类（例如 MyAuditable）派生它们来解决它。这样，您只需解决问题一次。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2009-01-26T23:50:43.960

[使用 NHibernate 的 ICompositeUserType 映射时间戳数据](http://www.lostechies.com/blogs/rhouston/archive/2008/03/23/mapping-timestamp-data-using-nhibernate-s-icompositeusertype.aspx)并 [在 NHibernate 中创建时间戳拦截器](http://www.lostechies.com/blogs/rhouston/archive/2008/03/27/creating-a-timestamp-interceptor-in-nhibernate.aspx)

我发现这些文章很有用。显然这不是 PI，因为您与 NH / SQL 相关联。

大多数 IoC 容器现在都带有拦截器，因此您可以拦截您的更改并将它们排队。如果 UoW 刷新您的更改，那么您也可以保留您的审计跟踪。

# html - XHTML 中所有有效的自闭合元素（由主要浏览器实现）是什么？

> ID：97522
> 
> 赞同：194
> 
> 时间：2008-09-18T22:10:44.207
> 
> 标签：html, browser, xhtml, cross-browser

XHTML（由主流浏览器实现）中所有有效的自闭合元素（例如<br/>）是什么？

我知道 XHTML 在技术上允许任何元素自关闭，但我正在寻找所有主要浏览器支持的那些元素的列表。见[http://dusan.fora.si/blog/self-closing-tags](http://dusan.fora.si/blog/self-closing-tags)以了解由 <div /> 等自闭合元素引起的一些问题的示例。

* * *

## 回答 #1

> 赞同：185
> 
> 时间：2008-10-15T20:48:52.000

每个支持 XHTML 的浏览器（Firefox、Opera、Safari、[IE9 ）都支持](https://docs.microsoft.com/en-us/archive/blogs/ie/xhtml-in-ie9)**每个元素**的自关闭语法。

`<div/>`, `<script/>`,`<br></br>`一切都应该正常工作。如果没有，那么您的*HTML*中添加了不恰当的 XHTML DOCTYPE。

**DOCTYPE 不会改变文档的解释方式。[只有 MIME 类型可以](http://www.webdevout.net/articles/beware-of-xhtml#content_type)**。

[W3C 关于忽略 DOCTYPE 的决定](https://lists.w3.org/Archives/Public/www-html/2000Sep/0024.html)：

> HTML WG 讨论了这个问题：其目的是允许旧的（仅 HTML）浏览器按照指南接受 XHTML 1.0 文档，并将它们作为 text/html 提供。因此，作为 text/html 的文档应该被视为 HTML 而不是 XHTML。

这是一个非常常见的陷阱，因为 W3C Validator 在很大程度上忽略了该规则，但浏览器却虔诚地遵循它。从 WebKit 博客中阅读 [理解 HTML、XML 和 XHTML ：](https://webkit.org/blog/68/understanding-html-xml-and-xhtml/)

> 事实上，互联网上绝大多数所谓的 XHTML 文档都是以`text/html`. 这意味着它们根本不是 XHTML，而是实际上在 HTML 解析器的错误处理中得到的无效 HTML。所有那些“有效的 XHTML 1.0！” 网络上的链接实际上是在说“无效的 HTML 4.01！”。

* * *

要使用 XHTML 的 DOCTYPE 测试您是否有真正的 XHTML 或无效的 HTML，请将其放入您的文档中：

```
<span style="color:green"><span style="color:red"/> 
 If it's red, it's HTML. Green is XHTML.
</span> 
```

它验证并在真正的 XHTML 中完美运行（参见：[1](https://kornel.ski/1) vs [2](https://kornel.ski/2)）。如果您不相信自己的眼睛（或不知道如何设置 MIME 类型），请通过[XHTML 代理](https://schneegans.de/xp/)打开您的页面。

另一种检查方法是在 Firefox 中查看源代码。当斜杠无效时，它会以红色突出显示斜杠。

在 HTML5/XHTML5 中，这并没有改变，而且区别更加清晰，因为你甚至没有额外`DOCTYPE`的 . `Content-Type`是国王。

* * *

作为记录，XHTML 规范允许任何元素通过使 XHTML 成为[XML 应用程序](https://www.w3.org/TR/REC-xml/#sec-starttags)来自动关闭：[强调我的]

> 空元素标签可用于**任何没有内容的元素**，无论它是否使用关键字 EMPTY 声明。

它也在[XHTML 规范](https://www.w3.org/TR/xhtml1/#h-4.6)中明确显示：

> 空元素必须**有**一个结束标签或开始标签必须以`/>`. 例如，`<br/>`或`<hr></hr>`

* * *

## 回答 #2

> 赞同：42
> 
> 时间：2008-09-26T23:14:18.023

在这个主题上要非常小心的一个元素是`<script`> 元素。如果你有一个外部源文件，当你自己关闭它时会引起问题。尝试一下：

```
<!-- this will not consistently work in all browsers! -->
<script type="text/javascript" src="external.js" /> 
```

这将在 Firefox 中工作，但至少在 IE6 中会中断。我知道，因为当我过分热心地自我关闭我看到的每个元素时，我遇到了这个问题 ;-)

* * *

## 回答 #3

> 赞同：36
> 
> 时间：2008-11-12T08:14:36.773

自闭合语法适用于 application/xhtml+xml 中的所有元素。text/html 中的任何元素都不支持它，但是 HTML4 中的“空”或 HTML5 中的“void”元素无论如何都不会使用结束标记，所以如果你在它们上加上斜线，它看起来好像支持自关闭语法。

* * *

## 回答 #4

> 赞同：34
> 
> 时间：2008-09-18T22:17:39.867

来自[W3 Schools 参考网站](http://www.w3schools.com/tags/ref_byfunc.asp)：

```
<area />
<base />
<basefont />
<br />
<hr />
<input />
<img />
<link />
<meta /> 
```

* * *

## 回答 #5

> 赞同：32
> 
> 时间：2012-01-13T16:09:54.907

更好的问题是：即使在 HTML 模式下，哪些标签也可以自动关闭而不影响代码？答：只有那些内容为空的（无效）。根据[HTML 规范](http://www.w3.org/html/wg/drafts/html/master/syntax.html#void-elements)，以下元素是无效的：

`area, base, br, col, embed, hr, img, input, keygen, link, menuitem, meta, param, source, track, wbr`

旧版本的规范也列出来了`command`。此外，根据各种来源，以下过时或非标准标签是无效的：

`basefont, bgsound, frame, isindex`

* * *

## 回答 #6

> 赞同：11
> 
> 时间：2009-11-14T22:01:24.873

希望这可以帮助某人：

```
<base />
<basefont />
<frame />
<link />
<meta />

<area />
<br />
<col />
<hr />
<img />
<input />
<param /> 
```

* * *

## 回答 #7

> 赞同：6
> 
> 时间：2008-09-26T23:10:18.140

`<meta>`和怎么样`<link>`？为什么他们不在那个名单上？

快速的经验法则，不要自行关闭任何打算包含内容的元素，因为它迟早会导致浏览器问题。

自然自闭的，如`<br>`和`<img>`，应该是显而易见的。那些不是......只是不要自行关闭它们！

* * *

## 回答 #8

> 赞同：5
> 
> 时间：2008-09-18T22:16:18.107

您应该看一下[xHTML DTDs](http://www.w3.org/TR/xhtml1/#dtds)，它们都已列出。以下是所有主要内容的快速回顾：

```
<br />
<hr />
<img />
<input /> 
```

* * *

## 回答 #9

> 赞同：5
> 
> 时间：2008-11-12T09:23:44.577

我上次检查时，以下是 HTML5 中列出的空/空元素。

对作者有效：area、base、br、col、command、embed、eventsource、hr、img、input、link、meta、param、source

对作者无效：basefont、bgsound、frame、spacer、wbr

除了 HTML5 中的一些新内容之外，这应该让您了解在将 XHTML 作为 text/html 服务时可能支持的内容。（只需通过检查生成的 DOM 来测试它们。）

至于作为 application/xhtml+xml 的 XHTML（这使它成为 XML），应用 XML 规则并且任何元素都可以是空的（即使 XHTML DTD 不能表达这一点）。

* * *

## 回答 #10

> 赞同：5
> 
> 时间：2013-04-22T20:08:59.480

它们在 HTML 5 中被称为“void”元素。它们列在[官方 W3 规范](https://www.w3.org/TR/html/syntax.html#void-elements)中。

> void 元素是其内容模型在任何情况下都不允许它拥有内容的元素。

截至 2013 年 4 月，它们是：

> area, base, br, col, command, embed, hr, img, input, keygen, link, meta, param, source, track, wbr

截至 2018 年 12 月（HTML 5.2），它们是：

> area, base, br, col, embed, hr, img, input, link, meta, param, source, track, wbr

* * *

## 回答 #11

> 赞同：2
> 
> 时间：2008-10-12T23:04:16.847

IE 的另一个自闭标签问题是标题元素。当 IE（刚刚在 IE7 中尝试过）看到这一点时，它会向用户显示一个空白页面。但是，您“查看源代码”并且一切都在那里。

```
<title/> 
```

我最初在 XSLT 生成自结束标记时看到了这一点。

* * *

## 回答 #12

> 赞同：2
> 
> 时间：2010-08-27T04:16:20.747

我不会试图对此进行过度阐述，特别是因为我编写的大多数页面要么是生成的，要么标签确实有内容。在使它们自动关闭时，唯一给我带来麻烦的两个是：

`<title/>`

为此，我只是简单地总是给它一个单独的结束标签，因为一旦它出现在`<head></head>`它上面，它并不会真正让你的代码变得更混乱。

`<script/>`

这是我最近遇到的大问题。多年来，`<script/>`当脚本来自外部来源时，我总是使用自闭合标签。但我最近开始收到关于 null 表单的 JavaScript 错误消息。经过几天的研究，我发现问题是（据说）浏览器从未访问过`<form>`标签，因为它没有意识到这是`<script/>`标签的结尾。所以当我把它做成单独的`<script></script>`标签时，一切正常。为什么我在同一个浏览器上创建的不同页面会有所不同，我不知道，但找到解决方案让我松了一口气！

* * *

## 回答 #13

> 赞同：-3
> 
> 时间：2008-09-18T22:13:13.327

<hr /> 是另一个

# asp.net - 没有 IIS 访问的自定义 URL 扩展/路由

> ID：97528
> 
> 赞同：2
> 
> 时间：2008-09-18T22:11:13.533
> 
> 标签：asp.net, iis-6

我需要使用无扩展名的 URL。我无权访问 IIS (6.0)，因此我无法将请求映射到 ASP.NET 并使用 HttpHandler/HttpModule 进行处理。但是，我可以通过网络主机控制面板设置自定义 404 页面。

我目前的计划是在自定义 404 页面中执行必要的逻辑，但它“感觉不对”。有没有我遗漏的建议？

已编辑：在标题中添加了“没有 IIS 访问权限”，因为有人认为这是一个重复的问题。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2008-09-18T22:14:20.687

如果无法访问 IIS，那将是您唯一的选择。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2008-09-18T22:42:23.740

如果您无法映射请求，则 404 页面确实是您唯一的选择。我已经看到几个博客包这样做是为了启用诸如 .../archive/YYYY/MM/DD 之类的魔术 URL - 没有这样的页面，所以它会点击 404 页面，而 404 页面会进行重定向。

# performance - 从网站性能的角度来看，DTO 的优缺点是什么？

> ID：97532
> 
> 赞同：2
> 
> 时间：2008-09-18T22:11:44.577
> 
> 标签：performance, jakarta-ee, ejb, rpc, dto-mapping

从网站性能的角度来看，DTO 的优缺点是什么？（我说的是在与 Web 服务器不同的应用程序服务器上访问数据库的情况 - 并且 Web 服务器可以直接访问数据库。）

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2008-09-18T22:31:37.290

DTO 不是性能问题。我认为您要问的是分层的性能影响。特别是，在 Web 层（Web 服务器）和数据层（数据库服务器）之间使用应用层。

通常，这意味着延迟会增加（您有额外的网络往返），但您可以通过在机器之间分配负载来获得一些额外的容量。

人们这样做的另一个常见原因（同样，非性能）是允许他们将 Web 服务器放置在 DMZ 中，同时将应用程序和数据库服务器保留在防火墙内。

另一个潜在原因（非性能）是在单个应用程序之上插入多个 UI 的能力。我已经在过去的项目中完成了这项工作，并取得了很好的成果（业务需要的地方）。

此外，不要低估维护这种性质的架构所需的工作。它比非分层解决方案工作量更大，因此请仅在您预计需要时使用它。

话虽如此，使用 DTO 并不一定需要使用分层。

我发现的关于分层的最佳描述来自 Martin Fowler 的书《分析模式》。后面有一小部分是关于应用程序外观和分层的。

重申前面的答案，DTO 不是性能问题。它只是一个没有用于在应用程序的各个部分之间提供隔离的方法的类。

我还建议阅读 Martin 的另一本书，企业应用程序架构模式。DTO“模式”记录在那里。

# open-source - 如何估算开源实现的 TCO

> ID：97557
> 
> 赞同：3
> 
> 时间：2008-09-18T22:14:34.773
> 
> 标签：open-source, sakai

我的意思是，这是[Sakai](http://sakaiproject.org/portal)，一个学习管理系统的开源项目。但是，我真的一无所知，试图估计一个中小型机构的一个实施项目（在技术方面，而不是教学法方面）的隐藏成本。

*   部署（1名工程师两三个月，有Java EE经验）
*   定制（1名工程师，1名设计师两三个月也可以）
*   支持（1人）
*   一台具有 4、8 或 16 GB RAM 的服务器相当不错。它将托管应用程序服务器、数据库服务器和 da da！?
*   ？？？

有经验的人能给我建议如何估计像这样的开源实现中的 TCO 吗？事实上，它可能是 Moodle，那样的话我也会迷路！

是的，这并不是一个真正的编程问题，但我认为这是一个合适的地方。

谢谢！

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2008-09-18T22:41:34.817

我在使用 Blackboard 的大型大学的支持人员工作。所有的支持人员都是兼职的学生，所以每小时的工资可能很低。您将希望有人担任永久员工作为管理员，他也可能是开发人员/部署人员。*如果您的机构足够小，也许只是兼职，但是当*（而不是如果）出现问题时，了解系统来龙去脉的人会很方便。（也许您可以将它们与支持角色结合起来？）在这方面，您可能需要一个单独的服务器来进行备份和恢复，至少可以备份数据。

如果您的学校足够小，也许一个人可以自己处理管理员/支持/开发角色（我的角色既是支持者又是开发者，我经常希望我有管理员权限）。您可能可以与您的 IT 部门讨论这些天的服务器数量，我不确定那里或有竞争力的薪水范围（但学生很便宜。）希望对一些人有所帮助。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-01-07T09:19:22.230

[Sakai Deployments](http://jira.sakaiproject.org/jira/secure/IssueNavigator.jspa?reset=true&&pid=10280&sorter/field=issuekey&sorter/order=ASC)列出了一些 Sakai 部署的详细信息，但请注意检查上次更新日期，因为我会查看去年更新的部署数据。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-11-27T22:57:04.417

我管理 Sakai 部署，所有方面都可以通过一个 FTE 实现，其中包括完全定制和开发。对于更大的安装（>10K 用户）和更多的定制，请考虑添加另一个 FTE。

# c# - C#“通用”类型问题

> ID：97565
> 
> 赞同：2
> 
> 时间：2008-09-18T22:15:15.910
> 
> 标签：c#, generics, image

C# 问题 (.net 3.5)。我有一个类 ImageData，它有一个字段 ushort[,] 像素。我正在处理专有图像格式。ImageData 类在构造函数中获取文件位置，然后打开文件扩展名以确定如何解码。在几个图像文件中，标题中有一个“位深度”字段。在我解码标题后，我将像素值读入“像素”数组。到目前为止，我没有超过 16bpp，所以我没事。但是如果我有 32bpp 怎么办？

我想要做的是在运行时确定像素的类型。我想在从标头中读取位深度之后并将像素数据复制到内存中之前执行此操作。有任何想法吗？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2008-09-18T22:23:46.577

我会说不要在构造函数中做这项工作——在我看来，构造函数不应该做这么多的工作。使用读取文件的工厂方法来确定位深度，然后让它构造该类的正确泛型变体并返回它。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2008-09-18T22:48:56.580

为了简化您的问题，您希望能够拥有一个有时具有**ushort[,] 像素**字段（每像素 16 位）和其他时候具有**uint32[,] 像素**字段（每像素 32 位）的类. 有几种不同的方法可以实现这一目标。

您可以通过创建一个具有 32 位和 16 位子类的 Pixel 类来创建 ushort / uint32 的替代品，在 wazoo 上覆盖各种运算符，但这会产生很多开销，很难正确定位，甚至更难以确定如果它是正确的。或者，您可以为像素数据创建代理类（其中将包含 ushort[,] 或 uint32[,] 数组，并具有所有有用的必要访问器）。不利的一面是，您可能最终会在 ImageData 类中使用许多特殊情况代码，这些代码根据某些 16 位/32 位模式标志以一种或另一种方式执行。

我认为更好的解决方案是将 ImageData 子类化为 16 位和 32 位类，并使用工厂方法创建实例。例如 ImageData 是基类，ImageData16bpp 和 ImageData32bpp 是子类，静态方法 ImageData.Create(string imageFilename) 是工厂方法，它根据头数据创建 ImageData16bpp 或 ImageData32bpp。例如：

```
public static ImageData Create(string imageFilename)
{
   // ...
   ImageDataHeader imageHeader = ParseHeader(imageFilename);
   ImageData newImageData;
   if (imageHeader.bpp == 32)
   {
      newImageData = new ImageData32(imageFilename, imageHeader);
   }
   else
   {
      newImageData = new ImageData16(imageFilename, imageHeader);
   }
   // ...
   return newImageData;
} 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2008-09-18T22:39:08.130

让您的 decode 函数返回一个 Array 类型的对象，它是所有数组的基类。然后关心类型的人如果想要通过像素可以执行“if (a is ushort[,])”等等。如果这样做，则需要在 ImageData 中分配数组，而不是相反。

*或者，调用者可能知道他们*希望您使用哪种像素阵列。即使是 8bpp 或 16bpp 的图像，如果您将其解码为 32bpp 的屏幕，您也需要使用 uint 而不是 ushort。因此，您可以编写一个 ImageData 函数，该函数将解码为任何类型 T 的整数。

您的问题的根源是您不知道如何决定您想要什么样的输出格式。您需要首先弄清楚这一点，然后是程序语法。

# javascript - 如何在 onClick 处理程序内的 JavaScript 代码中转义字符串？

> ID：97578
> 
> 赞同：69
> 
> 时间：2008-09-18T22:16:22.117
> 
> 标签：javascript, html, string, escaping

也许我只是在想这个太难了，但是我在弄清楚链接的 onClick 处理程序中的某些 JavaScript 代码中的字符串使用什么转义时遇到了问题。例子：

```
<a href="#" onclick="SelectSurveyItem('<%itemid%>', '<%itemname%>'); return false;">Select</a> 
```

`<%itemid%>`和`<%itemname%>`是模板替换发生的地方。我的问题是项目名称可以包含任何字符，包括单引号和双引号。目前，如果它包含单引号，则会破坏 JavaScript 代码。

我的第一个想法是使用模板语言的函数来 JavaScript 转义项目名称，这只是转义引号。这不会解决包含双引号的字符串会破坏链接的 HTML 的情况。这个问题一般是怎么解决的？我是否需要对整个 onClick 处理程序进行 HTML 转义？

如果是这样，那看起来真的很奇怪，因为模板语言的转义函数也会 HTMLify 括号、引号和分号......

正在为搜索结果页面中的每个结果生成此链接，因此无法在 JavaScript 标记内创建单独的方法，因为我需要为每个结果生成一个。

此外，我正在使用我工作的公司内部开发的模板引擎，因此特定于工具包的解决方案对我来说毫无用处。

* * *

## 回答 #1

> 赞同：80
> 
> 时间：2008-09-18T22:51:10.597

在 JavaScript 中，您可以将单引号编码为“\x27”，将双引号编码为“\x22”。因此，使用此方法，您可以在 JavaScript 字符串文字的（双引号或单引号）内使用 \x27 \x22 不受惩罚，而不必担心任何嵌入的引号会“中断”字符串。

\xXX 用于 chars < 127，而 \uXXXX 用于[Unicode](http://en.wikipedia.org/wiki/Unicode)，因此有了这些知识，您可以为通常白名单之外的所有字符创建强大的*JSEncode*函数。

例如，

```
<a href="#" onclick="SelectSurveyItem('<% JSEncode(itemid) %>', '<% JSEncode(itemname) %>'); return false;">Select</a> 
```

* * *

## 回答 #2

> 赞同：23
> 
> 时间：2011-12-23T03:15:57.477

根据服务器端语言，您可以使用以下其中一种：

.NET 4.0

```
string result = System.Web.HttpUtility.JavaScriptStringEncode("jsString") 
```

爪哇

```
import org.apache.commons.lang.StringEscapeUtils;
...

String result = StringEscapeUtils.escapeJavaScript(jsString); 
```

Python

```
import json
result = json.dumps(jsString) 
```

PHP

```
$result = strtr($jsString, array('\\' => '\\\\', "'" => "\\'", '"' => '\\"', 
                                 "\r" => '\\r', "\n" => '\\n' )); 
```

Ruby on Rails

```
<%= escape_javascript(jsString) %> 
```

* * *

## 回答 #3

> 赞同：11
> 
> 时间：2009-02-03T08:27:04.487

使用隐藏跨度，每个参数一个`<%itemid%>`，`<%itemname%>`并将它们的值写入其中。

例如，span for`<%itemid%>`看起来像`<span id='itemid' style='display:none'><%itemid%></span>`并且在 javascript 函数`SelectSurveyItem`中从这些 spans' 中选择参数`innerHTML`。

* * *

## 回答 #4

> 赞同：9
> 
> 时间：2008-09-18T22:21:20.437

如果它进入 HTML 属性，您需要对其进行 HTML 编码（至少：`>`to和`&gt;` `<`to ），并*转义*单引号（带反斜杠），这样它们就不会干扰您的 javascript 引用。`&lt``"``&quot;`

 *最好的方法是使用您的模板系统（如有必要，对其进行扩展），但您可以简单地制作几个转义/编码功能并将它们包装在其中的任何数据周围。

是的，对 HTML 属性的全部内容进行 HTML 转义是完全有效的（甚至是正确的），即使它们包含 javascript。

* * *

## 回答 #5

> 赞同：9
> 
> 时间：2008-09-18T22:35:42.727

尽量避免在 HTML 中使用字符串文字，并使用 JavaScript 来绑定 JavaScript 事件。

*此外，除非您真的*知道自己在做什么，否则请避免使用 'href=#' 。它破坏了强迫性中间点击器（标签打开器）的许多可用性。

```
<a id="tehbutton" href="somewhereToGoWithoutWorkingJavascript.com">Select</a> 
```

我选择的 JavaScript 库恰好是 jQuery：

```
<script type="text/javascript">//<!-- <![CDATA[
jQuery(function($){
   $("#tehbutton").click(function(){
        SelectSurveyItem('<%itemid%>', '<%itemname%>');
        return false;
   });
});
//]]>--></script> 
```

如果您碰巧要呈现这样的链接列表，您可能需要这样做：

```
<a id="link_1" href="foo">Bar</a>
<a id="link_2" href="foo2">Baz</a>

<script type="text/javascript">
   jQuery(function($){
        var l = [[1,'Bar'],[2,'Baz']];
        $(l).each(function(k,v){
           $("#link_" + v[0] ).click(function(){
                SelectSurveyItem(v[0],v[1]);
                return false;
           });
        });
   });
 </script> 
```

* * *

## 回答 #6

> 赞同：4
> 
> 时间：2008-09-18T22:41:17.627

另一个有趣的解决方案可能是这样做：

```
<a href="#" itemid="<%itemid%>" itemname="<%itemname%>" onclick="SelectSurveyItem(this.itemid, this.itemname); return false;">Select</a> 
```

然后，您可以对这两个变量使用标准的 HTML 编码，而不必担心 javascript 引用的额外复杂性。

是的，这*确实会*创建严格无效的 HTML。但是，它*是*一种有效的技术，所有现代浏览器都支持它。

如果是我的，我可能会采用我的第一个建议，并确保这些值是 HTML 编码的*并且*有单引号转义。

* * *

## 回答 #7

> 赞同：1
> 
> 时间：2008-09-18T22:18:33.187

在 <head> 部分声明单独的函数并在 onClick 方法中调用这些函数。如果你有很多，你可以使用一个命名方案来给它们编号，或者在你的 onClicks 中传递一个整数，并在函数中有一个大的胖 switch 语句。

* * *

## 回答 #8

> 赞同：1
> 
> 时间：2008-09-18T22:18:49.973

使用包含 JavaScript 编码的[Microsoft Anti-XSS 库。](http://blogs.msdn.com/ace_team/archive/2006/11/20/microsoft-anti-cross-site-scripting-library-v1-5-is-done.aspx)

* * *

## 回答 #9

> 赞同：1
> 
> 时间：2008-09-18T22:32:28.333

首先，如果以这种方式设置 onclick 处理程序会更简单：

```
<a id="someLinkId"href="#">Select</a>
<script type="text/javascript">
  document.getElementById("someLinkId").onClick = 
   function() {
      SelectSurveyItem('<%itemid%>', '<%itemname%>'); return false;
    };

</script> 
```

然后 itemid 和 itemname 需要为 JavaScript 进行转义（即`"`成为`\"`等）。

如果您在服务器端使用 Java，您可以查看jakarta 的 common-lang中的[StringEscapeUtils类。](http://commons.apache.org/lang/api/org/apache/commons/lang/StringEscapeUtils.html#escapeJavaScript(java.lang.String))否则，编写自己的“escapeJavascript”方法应该不会花费太长时间。

* * *

## 回答 #10

> 赞同：1
> 
> 时间：2008-09-19T15:20:05.547

任何值得称道的优秀模板引擎都将具有“转义引号”功能。我们的（也是本土的，我工作的地方）也有一个函数来为 javascript 转义引号。在这两种情况下，模板变量都只是附加了 _esc 或 _js_esc，这取决于你想要的。您永远不应该将用户生成的内容输出到尚未转义的浏览器，恕我直言。

* * *

## 回答 #11

> 赞同：1
> 
> 时间：2012-02-15T23:28:41.143

我也遇到过这个问题。我制作了一个脚本，将单引号转换为不会破坏 HTML 的转义双引号。

```
function noQuote(text)
{
    var newtext = "";
    for (var i = 0; i < text.length; i++) {
        if (text[i] == "'") {
            newtext += "\"";
        }
        else {
            newtext += text[i];
        }
    }
    return newtext;
} 
```

* * *

## 回答 #12

> 赞同：0
> 
> 时间：2008-09-19T11:35:07.157

这里的答案是您无法使用 JavaScript 转义引号，并且您需要从转义字符串开始。

所以。JavaScript 无法处理字符串 'Marge 对 Peter 说“我认为那是”'，您需要在将数据提供给脚本之前对其进行清理吗？

* * *

## 回答 #13

> 赞同：0
> 
> 时间：2011-03-11T13:05:59.603

我遇到了同样的问题，我以一种棘手的方式解决了它。首先制作全局变量v1、v2和v3。在 onclick 中，发送一个指标 1、2 或 3，并在函数中检查 1、2、3 以放置 v1、v2 和 v3，如：

```
onclick="myfun(1)"
onclick="myfun(2)"
onclick="myfun(3)"

function myfun(var)
{
    if (var ==1)
        alert(v1);

    if (var ==2)
        alert(v2);

    if (var ==3)
        alert(v3);
} 
```

# java - 有没有人有 aerith 风格摇摆与 SWT 编辑的 GUI 可维护性混合的例子？

> ID：97586
> 
> 赞同：0
> 
> 时间：2008-09-18T22:17:47.667
> 
> 标签：java, eclipse, swing, swt, lf

我的老板喜欢 VB（我们在 Java 商店工作），因为他认为它易于学习和维护。我们希望使用 Eclipse SWT 编辑器将一些 VB 替换为 java 等价物，因为我们认为它几乎同样易于维护。为了出售这个，我们想使用 aerith 风格的 L&F。

谁能提供一个 SWT 应用程序的示例，它仍然能够在 Eclipse 中编辑 GUI，但拥有 Aerith L&F？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2008-09-19T14:16:44.030

SWT 不支持外观。您可以通过更改您的操作系统原生 L&F 来获得不同的 L&F。唯一的例外是使用 eclipse 表单工具包。它仍然具有操作系统原生的感觉，但力求具有类似网络浏览器的外观。它主要通过将所有内容设置为 SWT.FLAT 并在所有内容上使用白色背景来做到这一点。有时，他们必须在本身不支持它的控件周围手动绘制轮廓。如果您正在寻找跨平台出现的自定义 L&F，那么您真的需要 Swing。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2008-09-21T21:47:19.750

就像 Heath Borders 说的，SWT 不支持 L&F，所以你必须使用 Swing。然而，Aerith 并不基于外观和感觉，而是基于具有大量渐变的组件上的自定义绘画。
如果您正在寻找一个（几乎）与 VB 一样易于使用的 Swing GUI 编辑器，请尝试[NetBeans](http://www.netbeans.org)中的 Matisse GUI Builder 。还有一个 Eclipse 版本，但它是随商业版[MyEclipse](http://www.myeclipseide.com/)一起提供的。如果您想了解更多关于使用酷炫的 GUI 编写应用程序的信息，请查看 Chet Haase 和 Romain Guy 撰写的[Filthy Rich Clients](http://filthyrichclients.org)一书。
如果这不能说服您的老板，请尝试调整 VB GUI 的大小，然后调整 Swing GUI 的大小。;-) 我想说的是，从长远来看，VB 真的不太好维护……

# c# - 在 Windows 中长期跟踪进程的内存使用情况的最佳工具是什么？

> ID：97590
> 
> 赞同：1
> 
> 时间：2008-09-18T22:18:16.653
> 
> 标签：c#, .net, performance, memory

在很长一段时间内监视我的 C#/.Net windows 服务的内存使用情况的最佳可用工具是什么。据我所知，像 perfmon 这样的工具可以在短时间内监控内存使用情况，但不能在很长一段时间内以图形方式监控内存使用情况。我需要几天的趋势数据，而不是几秒钟。

需要明确的是，我想在很长一段时间内以精细的细节水平监控内存使用情况，并让图表同时显示整个时间范围和细节水平。我需要一个小的采样间隔和一个大图。

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2008-09-18T22:25:28.180

在我看来，Perfmon 是执行此操作的最佳工具之一，但请确保根据您希望监控的时间正确配置采样间隔。

例如，如果你想监控一个进程：

*   1 小时：我会使用 1 秒的间隔（这将生成 60*60 个样本）
*   1 天：我会使用 30 秒的间隔（这将生成 2*60*24 样本）
*   1 周：我会使用 1 分钟的间隔（这将生成 60*24*7 样本）

使用这些采样间隔，Perfmon 应该可以毫无问题地生成漂亮的计数器图形输出。

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2008-09-18T22:21:10.827

好吧，我使用了 perfmon，将结果导出到 csv，然后使用 excel 进行统计。上次我需要监控流程时效果很好

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2008-09-18T22:28:09.187

玩弄计算机管理（假设您在这里运行 Windows），似乎您可以让它随着时间的推移监控一个进程。转到计算机管理 -> 性能日志和警报并查看计数器/跟踪日志。右键单击计数器日志并添加一个新日志。现在单击添加对象并选择内存。现在单击添加计数器并将“性能对象”更改为进程，然后选择您的进程。

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2008-09-18T22:34:47.330

与监控内存本身一样好，您可能正在考虑使用内存分析来识别泄漏或陈旧对象 - [http://memprofiler.com/](http://memprofiler.com/)是一个不错的选择，但还有很多其他选择。

如果您想做一些非常具体的事情，请不要害怕编写自己的基于 WMI 的记录器，该记录器在计时器上运行 - 您可以通过电子邮件将其发送给您处理统计信息，当它增长过快或过高时发出警告，将其发送为用于图表等的 XML

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2008-09-18T22:44:45.980

如果您熟悉 Python，则很容易为此编写脚本。

[Activestate Python （免费）通过](http://www.activestate.com/Products/activepython/index.mhtml)[win32process](http://docs.activestate.com/activepython/2.5/pywin32/win32process.html)模块公开了 Win32 API 的相关部分。

您还可以查看[所有与 win32 相关的模块](http://docs.activestate.com/activepython/2.5/pywin32/win32_modules.html) 或使用[gotAPI](http://www.gotapi.com/python)浏览 Python 标准库。

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2008-09-21T12:56:14.037

我建议使用软件验证中的[.Net Memory Validator](http://www.softwareverify.com/dotNet/memory/index.html)工具。这个工具帮助我解决了与我必须使用的 .Net 应用程序中的内存管理相关的许多不同问题。

我更频繁地使用 C++ 版本，但它们非常相似，而且您可以实时看到正在分配的对象的类型这一事实对您来说是无价的。

* * *

## 回答 #7

> 赞同：-1
> 
> 时间：2008-09-18T22:20:51.700

如果您需要比 perfmon 更强大的功能，我会使用 ProcessMonitor。

# linq-to-sql - 用户“用户名”登录失败-外部项目/类库中带有 LINQ 的 System.Data.SqlClient.SqlException

> ID：97594
> 
> 赞同：3
> 
> 时间：2008-09-18T22:18:59.473
> 
> 标签：linq-to-sql

这似乎很明显，但是当我尝试在一个单独的类库项目中将 LINQ to SQL 与我的业务逻辑一起使用时，我遇到了这个错误。

我在一个类库中创建了 DBML，我的所有业务逻辑和自定义控件都在这个项目中。我从我的 web 项目中引用了类库，并尝试直接从 web 项目中使用它。

该错误表明我的用户名登录失败。我的用户名和密码是正确的，但解决方法是将我的连接字符串复制到正确的位置。我从另一个网站了解到这个问题，并认为我会在这里做一个说明。

错误：用户“用户名”System.Data.SqlClient.SqlException 登录失败

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2008-09-18T22:19:07.023

LINQ 设计器将连接字符串广告到类库的 app.config，但网站需要在 Web 项目的 web.config 中看到它。一旦被复制，一切都很好。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2008-09-18T22:23:08.340

您也可以将连接或连接字符串传递给数据上下文。

# c# - 是否有用于显示 HTML 的 .Net WinForm 应用程序的控件

> ID：97598
> 
> 赞同：4
> 
> 时间：2008-09-18T22:19:46.087
> 
> 标签：c#, .net, winforms

我有一个 .net (3.5) WinForms 应用程序，想在其中一个表单上显示一些 html。有没有我可以使用的控件？

* * *

## 回答 #1

> 赞同：8
> 
> 时间：2008-09-18T22:22:05.160

是的，WebBrowser 控件。

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2008-09-18T22:23:01.430

我正在查看 WebBrowser 控件，但不知道如何将 HTML 分配（设置）给它...？

编辑：找到它 - 文档文本

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2008-09-18T22:22:05.333

浏览器控件呢？有点重，但至少你会得到一个准确的渲染。

# java - Java的静态分析工具推荐？

> ID：97599
> 
> 赞同：57
> 
> 时间：2008-09-18T22:19:50.657
> 
> 标签：java, static-analysis

由于对 Java 世界有点熟悉，我在谷歌上搜索一个静态分析工具，它也足够聪明，可以解决它发现的问题。我在 CodePro 工具上运行过，但我还是 Java 社区的新手，不了解供应商。

根据上述标准，您可以推荐什么工具？

* * *

## 回答 #1

> 赞同：48
> 
> 时间：2008-09-18T22:49:44.097

*   [查找错误](http://findbugs.sourceforge.net/)
*   [PMD](http://pmd.sourceforge.net)
*   [格纹风格](http://checkstyle.sourceforge.net)
*   [Lint4J](http://www.jutils.com)
*   [经典](http://classycle.sourceforge.net)
*   [依赖](http://sourceforge.net/projects/jdepends)
*   [娘娘腔](http://sissy.sourceforge.net)
*   [谷歌代码专业](https://developers.google.com/java-dev-tools/codepro/doc/)

* * *

## 回答 #2

> 赞同：38
> 
> 时间：2008-09-18T23:05:22.250

FindBugs、PMD 和 Checkstyle 都是很好的选择，尤其是如果您将它们集成到构建过程中。

在我上一家公司，我们还使用[Fortify](http://www.fortify.com)来检查潜在的安全问题。我们很幸运拥有企业许可证，所以我不知道所涉及的成本。

* * *

## 回答 #3

> 赞同：13
> 
> 时间：2008-09-18T22:21:09.610

我推荐 FindBugs。 [http://findbugs.sourceforge.net/](http://findbugs.sourceforge.net/)擅长协助进行代码审查。

* * *

## 回答 #4

> 赞同：11
> 
> 时间：2008-09-18T22:23:26.267

来自 JetBrains 的 IntelliJ IDEA。他们还在 .Net 社区中使用 ReSharper。

* * *

## 回答 #5

> 赞同：7
> 
> 时间：2008-09-19T07:40:10.827

[声纳](http://sonar.codehaus.org/)是一种质量控制工具。它通过遵守编码规则约定、度量标准和高级指标来衡量 Java 应用程序的质量。

Sonar 基于以下项目：

*   [JavaNCSS](http://www.kclee.de/clemens/java/javancss/)：质量指标

*   [Checkstyle](http://checkstyle.sourceforge.net/) : 风格检查

*   [PMD](http://pmd.sourceforge.net/)：对潜在错误进行代码扫描。

*   [Cobertura](http://cobertura.sourceforge.net/)：测试覆盖率

您还可以使用[Simian](http://www.redhillconsulting.com.au/products/simian/)进行重复检测。

* * *

## 回答 #6

> 赞同：1
> 
> 时间：2008-09-24T13:21:54.743

[CRAP4J](http://crap4j.org/)不仅是一个很棒的名字，而且非常有用。其他好的都在上面，最重要的是（恕我直言）是 FindBugs，因为它确实可以立即在大型代码库中找到诚实至善的错误。

* * *

## 回答 #7

> 赞同：1
> 
> 时间：2011-11-08T11:36:51.053

您可以尝试[JavaDepend](http://www.javadepend.com)，它补充了其他静态分析工具，并提供了 CQL 语言来查询数据库等代码，

JavaDepend 还提供了许多交互式视图来了解现有的代码库和超过 82 个指标。

* * *

## 回答 #8

> 赞同：0
> 
> 时间：2008-09-24T13:18:32.817

以上都是很棒的工具。PMD 可能是最常见的。

另一个工具是[Enerjy](http://www.enerjy.com/)。它最近变得免费，因此您可以下载并自己尝试。Enerjy 更有条理，更适合大型团队。它使自定义和共享规则变得更加容易。就个人而言，我不是一个大粉丝，但也许你会比我更喜欢它。

* * *

## 回答 #9

> 赞同：0
> 
> 时间：2009-06-24T18:57:42.390

几个提供 Java 产品的商业供应商：

[Klocwork](http://www.klocwork.com) [覆盖率](http://www.coverity.com)

他们不会“解决他们发现的问题”（我相信，上面提到的任何其他问题也不会），但这些都是具有不同优势的工具。

# sql-server - SQL Server 2005 用户映射到底是什么？

> ID：97614
> 
> 赞同：6
> 
> 时间：2008-09-18T22:22:02.447
> 
> 标签：sql-server, security

在 SQL Server 2005 Management Studio Express 的新登录对话框中，用户映射实际上在做什么？我是否限制访问那些被检查的数据库？如果我没有检查怎么办？

* * *

## 回答 #1

> 赞同：9
> 
> 时间：2008-09-18T22:24:20.380

它将用户权限映射到特定数据库。如果您不选中任何内容，则该用户将无权访问任何数据库，除非该用户处于允许访问单个数据库的服务器角色中。

# function - “组合器”的好解释（非数学家）

> ID：97637
> 
> 赞同：55
> 
> 时间：2008-09-18T22:25:40.143
> 
> 标签：function, lambda, combinators, y-combinator

有人对“组合器”（Y-组合器等而**不是** [公司](https://en.wikipedia.org/wiki/Y_Combinator_(company))）有很好的解释吗？

我正在寻找一位了解递归和高阶函数但没有强大理论或数学背景的实用程序员。

（注意：我说的是[这些东西](https://en.wikipedia.org/wiki/Fixed-point_combinator#Fixed_point_combinators_in_lambda_calculus)）

* * *

## 回答 #1

> 赞同：34
> 
> 时间：2008-09-19T13:45:20.113

Unless you're deeply into theory, you can regard the Y combinator as a neat trick with functions, like monads.

Monads allow you to chain actions, the Y combinator allows you to define self-recursive functions.

Python has built-in support for self-recursive functions, so you can define them without Y:

```
> def fun():
>  print "bla"
>  fun()

> fun()
bla
bla
bla
... 
```

`fun` is accessible inside `fun` itself, so we can easily call it.

*But what if Python were different, and `fun` weren't accessible inside `fun`?*

```
> def fun():
>   print "bla"
>   # what to do here? (cannot call fun!) 
```

The solution is to pass `fun` itself as an argument to `fun`:

```
> def fun(arg): # fun receives itself as argument
>   print "bla"
>   arg(arg) # to recur, fun calls itself, and passes itself along 
```

And Y makes that possible:

```
> def Y(f):
>   f(f)

> Y(fun)
bla
bla
bla
... 
```

All it does it call a function with itself as argument.

(I don't know if this definition of Y is 100% correct, but I think it's the general idea.)

* * *

## 回答 #2

> 赞同：22
> 
> 时间：2008-11-13T00:57:14.443

Reginald Braithwaite（又名 Raganwald）在他的新博客[homoiconic](http://github.com/raganwald/homoiconic/tree/master)上写了一个关于 Ruby 组合子的精彩系列。

虽然他（据我所知）没有查看 Y 组合器本身，但他确实查看了其他组合器，例如：

*   红[隼](http://github.com/raganwald/homoiconic/tree/master/2008-10-29/kestrel.markdown)
*   [画眉](http://github.com/raganwald/homoiconic/tree/master/2008-10-30/thrush.markdown)_
*   [红衣主教](http://github.com/raganwald/homoiconic/tree/master/2008-10-31/songs_of_the_cardinal.markdown)_
*   顽固的[红隼](http://github.com/raganwald/homoiconic/tree/master%2F2008-11-12%2Fthe_obdurate_kestrel.md)
*   其他古怪的鸟

以及一些关于如何[使用](http://github.com/raganwald/homoiconic/tree/master/2008-11-04/quirky_birds_and_meta_syntactic_programming.markdown)[它们](http://github.com/raganwald/homoiconic/tree/master/2008-11-07/from_birds_that_compose_to_method_advice.markdown) 的帖子。

* * *

## 回答 #3

> 赞同：15
> 
> 时间：2010-02-06T23:45:52.997

引用维基百科：

> 组合器是一个高阶函数，它仅使用函数应用程序和早期定义的组合器来定义其参数的结果。

现在这是什么意思？这意味着组合器是一个函数（输出仅由其输入决定），其输入包含一个函数作为参数。

这些功能是什么样的，它们的用途是什么？这里有些例子：

`(f o g)(x) = f(g(x))`

这`o`是一个组合器，它接收 2 个函数`f`和`g`，并返回一个函数作为其结果，即`f`with的组合。`g``f o g`

组合器可用于隐藏逻辑。假设我们有一个数据类型`NumberUndefined`，其中`NumberUndefined`可以采用数值`Num x`或值`Undefined`，其中`x`a 是 a `Number`。现在我们要为这个新的数字类型构造加法、减法、乘法和除法。除了`Number`如果`Undefined`是输入，输出也必须是`Undefined`，除以数字时，输出也必须`0`是`Undefined`。

可以编写如下繁琐的代码：

```
Undefined +' num = Undefined
num +' Undefined = Undefined
(Num x) +' (Num y) = Num (x + y)

Undefined -' num = Undefined
num -' Undefined = Undefined
(Num x) -' (Num y) = Num (x - y)

Undefined *' num = Undefined
num *' Undefined = Undefined
(Num x) *' (Num y) = Num (x * y)

Undefined /' num = Undefined
num /' Undefined = Undefined
(Num x) /' (Num y) = if y == 0 then Undefined else Num (x / y) 
```

请注意所有关于`Undefined`输入值的逻辑是如何相同的。只有除法做得更多。解决方案是通过使其成为组合器来提取逻辑。

```
comb (~) Undefined num = Undefined
comb (~) num Undefined = Undefined
comb (~) (Num x) (Num y) = Num (x ~ y)

x +' y = comb (+) x y
x -' y = comb (-) x y
x *' y = comb (*) x y
x /' y = if y == Num 0 then Undefined else comb (/) x y 
```

这可以概括为程序员在 Haskell 等函数式语言中使用的所谓`Maybe`monad，但我不会去那里。

* * *

## 回答 #4

> 赞同：6
> 
> 时间：2010-02-07T00:09:12.567

组合器是**没有自由变量**的函数。这意味着，除其他外，组合器不依赖于函数之外的事物，仅依赖于函数参数。

使用 F# 这是我对组合器的理解：

```
let sum a  b = a + b;; //sum function (lambda) 
```

在上述情况下， sum 是一个组合子，因为`a`和`b`都绑定到函数参数。

```
let sum3 a b c = sum((sum a b) c);; 
```

上面的函数不是它使用的组合子，它`sum`不是一个绑定变量（即它不是来自任何参数）。

我们可以通过简单地将 sum 函数作为参数之一来使 sum3 成为一个组合器：

```
let sum3 a b c sumFunc = sumFunc((sumFunc a b) c);; 
```

这种方式`sumFunc`是有**界的**，因此整个函数是一个组合子。

所以，这就是我对组合器的理解。另一方面，它们的重要性仍然让我无法理解。正如其他人指出的那样，定点组合器允许人们在没有`explicit`递归的情况下表达递归函数。即递归函数不调用自身，而是调用作为参数之一传入的 lambda。

这是我发现的最容易理解的组合子推导之一：

[http://mvanier.livejournal.com/2897.html](http://mvanier.livejournal.com/2897.html)

* * *

## 回答 #5

> 赞同：2
> 
> 时间：2010-02-23T19:20:18.957

这看起来不错： http: [//www.catonmat.net/blog/derivation-of-ycombinator/](http://www.catonmat.net/blog/derivation-of-ycombinator/)

* * *

## 回答 #6

> 赞同：2
> 
> 时间：2008-09-18T22:47:13.167

这是一篇好[文章](https://web.archive.org/web/20160913141703/http://www.dreamsongs.com/NewFiles/WhyOfY.pdf)。代码示例在方案中，但它们应该不难理解。

* * *

## 回答 #7

> 赞同：1
> 
> 时间：2008-11-13T01:22:09.413

我的理论很短，但我可以给你一个例子，让我的想象力飞起来，这可能对你有帮助。最简单有趣的组合子可能是“测试”。

希望你了解 Python

```
tru = lambda x,y: x
fls = lambda x,y: y 

test = lambda l,m,n: l(m,n) 
```

用法：

```
>>> test(tru,"goto loop","break")
'goto loop'
>>> test(fls,"goto loop","break")
'break' 
```

test 如果第一个参数为真，则计算第二个参数，否则为第三个。

```
>>> x = tru
>>> test(x,"goto loop","break")
'goto loop' 
```

整个系统可以由几个基本的组合器组成。

（这个例子或多或少地从 Benjamin C. Pierce 的 Types and Programming Languages 中复制出来）

* * *

## 回答 #8

> 赞同：0
> 
> 时间：2010-02-06T23:59:38.237

简而言之，Y 组合器是一个高阶函数，用于在 lambda 表达式（匿名函数）上实现递归。查看 Mike Vanier 的文章[How to Succeed at Recursion without Being Recursing](http://mvanier.livejournal.com/2897.html) - 这是我见过的对这个问题的最佳实用解释之一。

此外，扫描 SO 档案：

*   [什么是 y 组合子？](https://stackoverflow.com/questions/93526/what-is-a-y-combinator)
*   [Y-Combinator 实际示例](https://stackoverflow.com/questions/869497/y-combinator-practical-example)

# java - 使 Maven 将依赖项复制到 target/lib

> ID：97640
> 
> 赞同：275
> 
> 时间：2008-09-18T22:26:09.753
> 
> 标签：java, maven, dependencies, maven-2, maven-3

如何将项目的运行时依赖项复制到`target/lib`文件夹中？

就像现在一样，`mvn clean install`该`target`文件夹仅包含我的项目的 jar，但不包含任何运行时依赖项。

* * *

## 回答 #1

> 赞同：279
> 
> 时间：2009-06-15T15:58:18.717

这对我有用：

```
<project>
  ...
  <profiles>
    <profile>
      <id>qa</id>
      <build>
        <plugins>
          <plugin>
            <artifactId>maven-dependency-plugin</artifactId>
            <executions>
              <execution>
                <phase>install</phase>
                <goals>
                  <goal>copy-dependencies</goal>
                </goals>
                <configuration>
                  <outputDirectory>${project.build.directory}/lib</outputDirectory>
                </configuration>
              </execution>
            </executions>
          </plugin>
        </plugins>
      </build>
    </profile>
  </profiles>
</project> 
```

* * *

## 回答 #2

> 赞同：100
> 
> 时间：2014-02-08T02:30:55.723

```
mvn install dependency:copy-dependencies 
```

使用在目标文件夹中创建的依赖项目录为我工作。喜欢它！

* * *

## 回答 #3

> 赞同：89
> 
> 时间：2008-09-19T01:45:24.783

最好的方法取决于你想做什么：

*   如果要将依赖项捆绑到 WAR 或 EAR 文件中，只需将项目的打包类型设置为 EAR 或 WAR。Maven 会将依赖项捆绑到正确的位置。
*   如果您想创建一个包含您的代码以及所有依赖项的 JAR 文件，请使用带有*jar-with-dependencies*描述符的[程序集](http://maven.apache.org/plugins/maven-assembly-plugin/ "Maven2 程序集插件文档")插件。Maven 将生成一个完整的 JAR 文件，其中包含您的所有类以及来自任何依赖项的类。
**   如果您只想以交互方式将依赖项拉入目标目录，请使用[依赖](http://maven.apache.org/plugins/maven-dependency-plugin/ "Maven2 依赖插件文档")项插件将文件复制到其中。*   如果您想为其他类型的处理引入依赖项，那么您可能需要生成自己的插件。有一些 API 可以获取依赖项列表以及它们在磁盘上的位置。你必须从那里拿走它......*

 ** * *

## 回答 #4

> 赞同：38
> 
> 时间：2008-09-19T00:03:12.000

Take a look at the [Maven dependency plugin](http://maven.apache.org/plugins/maven-dependency-plugin/index.html), specifically, the [dependency:copy-dependencies goal](http://maven.apache.org/plugins/maven-dependency-plugin/copy-dependencies-mojo.html). Take a look at [the example](http://maven.apache.org/plugins/maven-dependency-plugin/usage.html) under the heading **The dependency:copy-dependencies mojo**. Set the **outputDirectory** configuration property to ${basedir}/target/lib (I believe, you'll have to test).

Hope this helps.

* * *

## 回答 #5

> 赞同：34
> 
> 时间：2011-06-30T14:16:07.317

对于需要将依赖项复制到目标目录而不使用任何其他 maven 阶段的情况（我发现这在使用 Vaadin 时非常有用），这是一种简单而优雅的解决方案。

完整的 pom 示例：

```
<project xmlns="http://maven.apache.org/POM/4.0.0" xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance"
    xsi:schemaLocation="http://maven.apache.org/POM/4.0.0 http://maven.apache.org/maven-v4_0_0.xsd">

    <modelVersion>4.0.0</modelVersion>
    <groupId>groupId</groupId>
    <artifactId>artifactId</artifactId>
    <version>1.0</version>

    <dependencies>
        <dependency>
            <groupId>org.mybatis</groupId>
            <artifactId>mybatis-spring</artifactId>
            <version>1.1.1</version>
        </dependency>
    </dependencies>

    <build>
        <plugins>
            <plugin>
                <artifactId>maven-dependency-plugin</artifactId>
                    <executions>
                        <execution>
                            <phase>process-sources</phase>

                            <goals>
                                <goal>copy-dependencies</goal>
                            </goals>

                            <configuration>
                                <outputDirectory>${targetdirectory}</outputDirectory>
                            </configuration>
                        </execution>
                    </executions>
            </plugin>
        </plugins>
    </build>
</project> 
```

然后运行`mvn process-sources`

jar 文件依赖项可以在`/target/dependency`

* * *

## 回答 #6

> 赞同：32
> 
> 时间：2014-08-22T06:59:24.797

如果您想偶尔执行此操作（因此不想更改您的 POM），请尝试以下命令行：

```
mvn 依赖：复制依赖 -DoutputDirectory=${project.build.directory}/lib
```

如果省略[最后一个参数](http://maven.apache.org/plugins/maven-dependency-plugin/copy-dependencies-mojo.html#outputDirectory)，则依赖项将放在`target/dependencies`.

* * *

## 回答 #7

> 赞同：30
> 
> 时间：2017-12-24T20:01:23.647

您所需要的只是 pom.xml 中的以下代码段`build/plugins`：

```
<plugin>
    <artifactId>maven-dependency-plugin</artifactId>
    <executions>
        <execution>
            <phase>prepare-package</phase>
            <goals>
                <goal>copy-dependencies</goal>
            </goals>
            <configuration>
                <outputDirectory>${project.build.directory}/lib</outputDirectory>
            </configuration>
        </execution>
    </executions>
</plugin> 
```

以上会在`package`你运行的阶段运行

```
mvn clean package 
```

并且依赖项将被复制到片段中指定的 outputDirectory，即`lib`在这种情况下。

如果您只想偶尔这样做，则不需要更改 pom.xml。只需运行以下命令：

```
mvn clean package dependency:copy-dependencies 
```

要覆盖默认位置，即`${project.build.directory}/dependencies`，添加一个名为 的系统属性`outputDirectory`，即

```
 -DoutputDirectory=${project.build.directory}/lib 
```

* * *

## 回答 #8

> 赞同：24
> 
> 时间：2012-05-01T08:57:47.000

尝试这样的事情：

```
<plugin>
<groupId>org.apache.maven.plugins</groupId>
<artifactId>maven-jar-plugin</artifactId>
<version>2.4</version>
<configuration>
    <archive>
        <manifest>  
            <addClasspath>true</addClasspath>
            <classpathPrefix>lib/</classpathPrefix>
            <mainClass>MainClass</mainClass>
        </manifest>
    </archive>
    </configuration>
</plugin>
<plugin>
    <groupId>org.apache.maven.plugins</groupId>
    <artifactId>maven-dependency-plugin</artifactId>
    <version>2.4</version>
    <executions>
        <execution>
            <id>copy</id>
            <phase>install</phase>
            <goals>
                <goal>copy-dependencies</goal>
            </goals>
            <configuration>
                <outputDirectory>
                    ${project.build.directory}/lib
                </outputDirectory>
            </configuration>
        </execution>
    </executions>
</plugin> 
```

* * *

## 回答 #9

> 赞同：9
> 
> 时间：2016-11-24T10:42:18.337

假如

*   你不想改变 pom.xml
*   您不希望测试范围（例如 junit.jar）或提供的依赖项（例如 wlfullclient.jar）

这对我有用：

```
mvn 安装依赖项：复制依赖项 -DincludeScope=runtime -DoutputDirectory=target/lib

```

* * *

## 回答 #10

> 赞同：5
> 
> 时间：2009-09-19T22:06:02.287

如果您想交付应用程序 jar 的捆绑包，以及它的所有依赖项和一些用于调用 MainClass 的脚本，请查看[appassembler-maven-plugin](http://www.mojohaus.org/appassembler/appassembler-maven-plugin/)。

以下配置将为 Window 和 Linux 生成脚本以启动应用程序（生成的路径引用所有依赖项 jar，下载所有依赖项（到 target/appassembler 下的 lib 文件夹中）。然后可以使用程序[集插件](http://maven.apache.org/plugins/maven-assembly-plugin/)来打包整个appassembler 目录到一个 zip，它与 jar 一起安装/部署到存储库。

```
 <plugin>
    <groupId>org.codehaus.mojo</groupId>
    <artifactId>appassembler-maven-plugin</artifactId>
    <version>1.0</version>
    <executions>
      <execution>
        <id>generate-jsw-scripts</id>
        <phase>package</phase>
        <goals>
          <goal>generate-daemons</goal>
        </goals>
        <configuration>
          <!--declare the JSW config -->
          <daemons>
            <daemon>
              <id>myApp</id>
              <mainClass>name.seller.rich.MyMainClass</mainClass>
              <commandLineArguments>
                <commandLineArgument>start</commandLineArgument>
              </commandLineArguments>
              <platforms>
                <platform>jsw</platform>
              </platforms>              
            </daemon>
          </daemons>
          <target>${project.build.directory}/appassembler</target>
        </configuration>
      </execution>
      <execution>
        <id>assemble-standalone</id>
        <phase>integration-test</phase>
        <goals>
          <goal>assemble</goal>
        </goals>
        <configuration>
          <programs>
            <program>
              <mainClass>name.seller.rich.MyMainClass</mainClass>
              <!-- the name of the bat/sh files to be generated -->
              <name>mymain</name>
            </program>
          </programs>
          <platforms>
            <platform>windows</platform>
            <platform>unix</platform>
          </platforms>
          <repositoryLayout>flat</repositoryLayout>
          <repositoryName>lib</repositoryName>
        </configuration>
      </execution>
    </executions>
  </plugin>
  <plugin>
    <artifactId>maven-assembly-plugin</artifactId>
    <version>2.2-beta-4</version>
    <executions>
      <execution>
        <phase>integration-test</phase>
        <goals>
          <goal>single</goal>
        </goals>
        <configuration>
          <descriptors>
            <descriptor>src/main/assembly/archive.xml</descriptor>
          </descriptors>
        </configuration>
      </execution>
    </executions>
  </plugin> 
```

将目录打包为 zip 的程序集描述符（在 src/main/assembly 中）将是：

```
<assembly>
  <id>archive</id>
  <formats>
    <format>zip</format>
  </formats>
  <fileSets>
    <fileSet>
     <directory>${project.build.directory}/appassembler</directory>
     <outputDirectory>/</outputDirectory>
    </fileSet>
  </fileSets>
</assembly> 
```

* * *

## 回答 #11

> 赞同：3
> 
> 时间：2008-09-18T22:44:14.873

如果您将项目设为战争或耳朵类型，maven 将复制依赖项。

* * *

## 回答 #12

> 赞同：2
> 
> 时间：2012-01-31T22:27:36.230

这是嵌入重度依赖项的重度解决方案，但 Maven 的[Assembly Plugin](http://maven.apache.org/plugins/maven-assembly-plugin/index.html)为我解决了问题。

@ [Rich Seller 的回答应该有效，但对于更简单的情况，您应该只需要](https://stackoverflow.com/a/1449651/155090)[使用指南](http://maven.apache.org/plugins/maven-assembly-plugin/usage.html)中的这段摘录：

```
<project>
    <build>
        <plugins>
            <plugin>
                <artifactId>maven-assembly-plugin</artifactId>
                <version>2.2.2</version>
                <configuration>
                    <descriptorRefs>
                        <descriptorRef>jar-with-dependencies</descriptorRef>
                    </descriptorRefs>
                </configuration>
            </plugin>
        </plugins>
    </build>
</project> 
```

* * *

## 回答 #13

> 赞同：1
> 
> 时间：2008-09-18T22:59:48.423

您可以使用[Shade 插件](http://maven.apache.org/plugins/maven-shade-plugin/)创建一个 uber jar，您可以在其中捆绑所有 3rd 方依赖项。

* * *

## 回答 #14

> 赞同：1
> 
> 时间：2010-09-22T12:23:53.977

只是为了简要说明已经说过的内容。我想创建一个可执行 JAR 文件，其中包含我的依赖项以及我的代码。这对我有用：

(1) 在 pom 中，在 <build><plugins> 下，我包括：

```
<plugin>
    <artifactId>maven-assembly-plugin</artifactId>
    <version>2.2-beta-5</version>
    <configuration>
        <archive>
            <manifest>
                <mainClass>dk.certifikat.oces2.some.package.MyMainClass</mainClass>
            </manifest>
        </archive>
        <descriptorRefs>
            <descriptorRef>jar-with-dependencies</descriptorRef>
        </descriptorRefs>
    </configuration>
</plugin> 
```

(2) 运行 mvn compile assembly:assembly 在项目的目标目录中生成所需的 my-project-0.1-SNAPSHOT-jar-with-dependencies.jar。

(3) 我用 java -jar my-project-0.1-SNAPSHOT-jar-with-dependencies.jar 运行了 JAR

* * *

## 回答 #15

> 赞同：0
> 
> 时间：2011-05-17T16:31:29.330

如果您在 Eclipse 中的 Tomcat 服务器上运行时遇到与 WEB-INF/lib 文件中未出现的依赖项相关的问题，请查看以下内容：

[启动 Tomcat 时出现 ClassNotFoundException DispatcherServlet（Maven 依赖项未复制到 wtpwebapps）](https://stackoverflow.com/questions/4777026/classnotfoundexception-dispatcherservlet-when-launching-tomcat-maven-dependencie)

您只需在 Project Properties > Deployment Assembly 中添加 Maven 依赖项。

* * *

## 回答 #16

> 赞同：0
> 
> 时间：2022-01-17T21:43:16.163

您可以在项目目录中放置一个`settings.xml`文件，其基本配置如下：

```
<?xml version="1.0" encoding="UTF-8"?>
<settings xmlns="http://maven.apache.org/SETTINGS/1.0.0" xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance"
          xsi:schemaLocation="http://maven.apache.org/SETTINGS/1.0.0 https://maven.apache.org/xsd/settings-1.0.0.xsd">
    <localRepository>.m2/repository</localRepository>
    <interactiveMode/>
    <offline/>
    <pluginGroups/>
    <servers/>
    <mirrors/>
    <proxies/>
    <profiles/>
    <activeProfiles/>
</settings> 
```

有关这些设置的更多信息可以在官方[Maven 文档](https://maven.apache.org/settings.html#simple-values)中找到。
请注意，除非您输入绝对路径，否则该路径是相对于实际设置文件所在的目录解析的。

执行 maven 命令时，可以按如下方式使用设置文件：

```
mvn -s settings.xml clean install 
```

旁注：我在我的 GitLab CI/CD 管道中使用它，以便能够为多个作业缓存 maven 存储库，这样就不需要为每个作业执行下载依赖项。GitLab 只能缓存您项目目录中的文件或目录，因此我在我的项目目录中引用了一个目录。

# c# - 如何确定给定颜色的较深或较浅颜色变体？

> ID：97646
> 
> 赞同：43
> 
> 时间：2008-09-18T22:27:34.837
> 
> 标签：c#, colors

给定系统或用户的任何色调的源颜色，我想要一个简单的算法，我可以使用它来计算所选颜色的更亮或更暗的变体。类似于 Windows Live Messenger 上用于设置用户界面样式的效果。

语言是带有 .net 3.5 的 C#。

**回复评论：**颜色格式为（Alpha）RGB。将值作为字节或浮点数。

**标记答案：**对于我使用的上下文（一些简单的 UI 效果），我标记为已接受的答案实际上是该上下文中最简单的。但是，我也放弃了对更复杂和准确的答案的投票。任何做更高级颜色操作并在未来找到这个线程的人都应该检查一下。谢谢。:)

* * *

## 回答 #1

> 赞同：51
> 
> 时间：2010-04-22T10:40:08.023

在[XNA 中，有一种`Color.Lerp`静态方法](http://msdn.microsoft.com/en-us/library/microsoft.xna.framework.graphics.color.lerp.aspx)可以区分两种颜色。

`Lerp`是两个浮点数之间的数学运算，它通过它们之间的差异的比率来改变第一个浮点数的值。

这是对 a 执行此操作的扩展方法`float`：

```
public static float Lerp( this float start, float end, float amount)
{
    float difference = end - start;
    float adjusted = difference * amount;
    return start + adjusted;
} 
```

因此，使用 RGB 在两种颜色之间进行简单的 lerp 操作将是：

```
public static Color Lerp(this Color colour, Color to, float amount)
{
    // start colours as lerp-able floats
    float sr = colour.R, sg = colour.G, sb = colour.B;

    // end colours as lerp-able floats
    float er = to.R, eg = to.G, eb = to.B;

    // lerp the colours to get the difference
    byte r = (byte) sr.Lerp(er, amount),
         g = (byte) sg.Lerp(eg, amount),
         b = (byte) sb.Lerp(eb, amount);

    // return the new colour
    return Color.FromArgb(r, g, b);
} 
```

应用它的一个例子是这样的：

```
// make red 50% lighter:
Color.Red.Lerp( Color.White, 0.5f );

// make red 75% darker:
Color.Red.Lerp( Color.Black, 0.75f );

// make white 10% bluer:
Color.White.Lerp( Color.Blue, 0.1f ); 
```

* * *

## 回答 #2

> 赞同：28
> 
> 时间：2008-09-18T22:41:30.903

只需将 RGB 值乘以要修改级别的量即可。如果其中一种颜色已经处于最大值，那么你不能让它更亮（无论如何使用 HSV 数学。）

这给出了与切换到 HSV 然后修改 V 完全相同的结果，只要您不想开始失去饱和度，就可以得到与切换到 HSL 然后修改 L 相同的结果。

* * *

## 回答 #3

> 赞同：20
> 
> 时间：2008-09-18T22:37:00.617

HSV（色调/饱和度/值）也称为HSL（色调/饱和度/亮度）只是一种不同的颜色表示。

使用这种表示方式更容易调整亮度。因此，从 RGB 转换为 HSV，使“V”变亮，然后再转换回 RGB。

下面是一些要转换的C代码

```
void RGBToHSV(unsigned char cr, unsigned char cg, unsigned char cb,double *ph,double *ps,double *pv)
{
double r,g,b;
double max, min, delta;

/* convert RGB to [0,1] */

r = (double)cr/255.0f;
g = (double)cg/255.0f;
b = (double)cb/255.0f;

max = MAXx(r,(MAXx(g,b)));
min = MINx(r,(MINx(g,b)));

pv[0] = max;

/* Calculate saturation */

if (max != 0.0)
    ps[0] = (max-min)/max;
else
    ps[0] = 0.0; 

if (ps[0] == 0.0)
{
    ph[0] = 0.0f;   //UNDEFINED;
    return;
}
/* chromatic case: Saturation is not 0, so determine hue */
delta = max-min;

if (r==max)
{
    ph[0] = (g-b)/delta;
}
else if (g==max)
{
    ph[0] = 2.0 + (b-r)/delta;
}
else if (b==max)
{
    ph[0] = 4.0 + (r-g)/delta;
}
ph[0] = ph[0] * 60.0;
if (ph[0] < 0.0)
    ph[0] += 360.0;
}

void HSVToRGB(double h,double s,double v,unsigned char *pr,unsigned char *pg,unsigned char *pb)
{
int i;
double f, p, q, t;
double r,g,b;

if( s == 0 )
{
    // achromatic (grey)
    r = g = b = v;
}
else
{
    h /= 60;            // sector 0 to 5
    i = (int)floor( h );
    f = h - i;          // factorial part of h
    p = v * ( 1 - s );
    q = v * ( 1 - s * f );
    t = v * ( 1 - s * ( 1 - f ) );
    switch( i )
    {
    case 0:
        r = v;
        g = t;
        b = p;
    break;
    case 1:
        r = q;
        g = v;
        b = p;
    break;
    case 2:
        r = p;
        g = v;
        b = t;
    break;
    case 3:
        r = p;
        g = q;
        b = v;
    break;
    case 4:
        r = t;
        g = p;
        b = v;
    break;
    default:        // case 5:
        r = v;
        g = p;
        b = q;
    break;
    }
}
r*=255;
g*=255;
b*=255;

pr[0]=(unsigned char)r;
pg[0]=(unsigned char)g;
pb[0]=(unsigned char)b;
} 
```

* * *

## 回答 #4

> 赞同：14
> 
> 时间：2008-09-18T23:17:01.177

Rich Newman在他的博客上讨论了与 .NET System.Drawing.Color 相关的[HSL 颜色，甚至](http://richnewman.wordpress.com/2007/05/07/using-hsl-color-hue-saturation-luminosity-to-create-better-looking-guis-part-2/)[提供了一个 HSLColor 类](http://richnewman.wordpress.com/hslcolor-class/)来为您完成所有工作。将您的 System.Drawing.Color 转换为 HSLColor，对 Luminosity 添加/减去值，然后转换回 System.Drawing.Color 以在您的应用程序中使用。

* * *

## 回答 #5

> 赞同：10
> 
> 时间：2008-09-18T22:29:56.437

您可以将颜色转换为 HSL 颜色空间，在那里对其进行操作并转换回您选择的颜色空间（很可能是 RGB）

较浅的颜色具有较高的 L 值，较暗的具有较低的 L 值。

这是相关的东西和所有的方程式：

[http://en.wikipedia.org/wiki/HSL_color_space](http://en.wikipedia.org/wiki/HSL_color_space)

另一种方法是简单地将颜色插入白色或黑色。这也会稍微降低颜色的饱和度，但计算起来更便宜。

* * *

## 回答 #6

> 赞同：9
> 
> 时间：2008-10-18T01:26:57.913

我用过`ControlPaint.Dark()`and `.Light()`in `System.Windows.Forms`。

* * *

## 回答 #7

> 赞同：5
> 
> 时间：2008-09-18T22:49:45.860

我猜您正在使用带有字节值（0 到 255）的 RGB，因为这在任何地方都很常见。

为了更亮，用白色的 RGB 平均 RGB 值。或者，为了控制增亮程度，按一定比例混合它们。让`f`从 0.0 到 1.0 变化，然后：

```
Rnew = (1-f)*R + f*255
Gnew = (1-f)*G + f*255
Bnew = (1-f)*B + f*255 
```

对于较暗的颜色，请使用黑色的 RGB - 全为零，使数学更容易。

我省略了诸如将结果转换回字节之类的细节，这可能是您想要做的。

* * *

## 回答 #8

> 赞同：3
> 
> 时间：2008-09-18T22:37:40.287

如果您使用的是 RGB 颜色，我会将此颜色参数转换为[HSL](http://en.wikipedia.org/wiki/HSL_color_space)（色相、饱和度、亮度），修改亮度参数，然后再转换回 RGB。谷歌周围，你会发现很多关于如何进行这些颜色表示转换的代码示例（RGB 到 HSL，反之亦然）。

这是我很快找到的：http: [//bytes.com/forum/thread250450.html](http://bytes.com/forum/thread250450.html)

* * *

## 回答 #9

> 赞同：0
> 
> 时间：2008-09-18T22:30:45.983

假设您将颜色设为 RGB，首先将其转换为 HSV（色调、饱和度、值）颜色空间。然后增加/减少该值以产生更浅/更深的颜色阴影。然后转换回RGB。

* * *

## 回答 #10

> 赞同：0
> 
> 时间：2008-09-18T22:37:19.493

如果您的颜色是 RGB 格式（或者可能是 CMYK），您可以使用相当粗略的方法来增加颜色的每个组件的值。例如，在 HTML 中，颜色表示为三个两位数的十六进制数字。#ff0000 会给你一个明亮的红色，然后可以通过将 G 和 B 组件的值增加相同的量来淡化它，例如 #ff5555（给出一个更浅的红色）。大概对于色相、饱和度和亮度 (HSL) 颜色，您可以只提高 L 分量，但我不能肯定地说；我对这个色彩空间不太熟悉。

不过，正如我所说，这种方法非常粗糙。根据我对 Live Messenger 的记忆，听起来您正在尝试做渐变，这可以非常容易地应用到 Windows Presentation Foundation（WPF，.NET 3.0 的一部分）中。WPF 支持许多不同类型的渐变画笔，包括线性渐变和径向渐变。

我强烈推荐 Adam Nathan 的书[*Windows Presentation Foundation Unleashed*](http://www.amazon.co.uk/Windows-Presentation-Foundation-Unleashed-WPF/dp/0672328917/ref=sr_1_1?ie=UTF8&s=books&qid=1221777340&sr=8-1)作为对 WPF 的全面介绍。

高温高压

* * *

## 回答 #11

> 赞同：0
> 
> 时间：2008-09-18T22:48:49.747

在 HSL/HSV 中更好地完成任何颜色变化。

一个很好的测试是在 RGB 空间和 HSL 空间中的两个等效值之间进行插值。HSL 空间中的坡道看起来像是一个自然的进程。在 RGB 空间中，它通常看起来很不自然。HSL 比 RGB 更好地映射到我们的视觉色彩空间感知。

* * *

## 回答 #12

> 赞同：0
> 
> 时间：2008-09-18T22:53:50.920

转换为 HSV 或其他颜色空间的想法似乎不错，并且对于精确的颜色工作可能是必要的，但对于普通目的，在 RGB 中工作的错误可能并不重要。此外，处理边界情况可能会很痛苦：RGB 是一个立方体形状的空间，而 HSV 不是。如果使用字节值，您可以在空间之间进行多对一和一对多映射。这可能是也可能不是问题，具体取决于应用程序。YMMV

* * *

## 回答 #13

> 赞同：0
> 
> 时间：2008-12-02T15:29:09.083

该[网站](http://www.csharp411.com/lighten-and-darken-colors-in-net/)指出，您可以在 BCL C# System.Windows.Forms 命名空间中使用 ControlPaint 类。

# php - 如何让自动换行在 Eclipse PDT 中为 PHP 文件工作？

> ID：97663
> 
> 赞同：52
> 
> 时间：2008-09-18T22:30:59.150
> 
> 标签：php, eclipse, eclipse-pdt, word-wrap

在 Eclipse PDT 中编程 PHP 主要是一种乐趣：代码完成、模板、方法跳转等。

然而，让我发疯的一件事是，我无法让 PHP 文件中的行自动换行，所以在很长的行中，我无限期地向右输入。

我点击 Windows|Preferences 并输入“wrap”并得到：

```
- Java | Code Style | Formatter
- Java | Editor | Typing
- Web and XML | CSS Files | Source 
```

我尝试将在那里找到的“自动换行”和“线宽”更改为 72，但它们没有效果。

如何让自动换行在 Eclipse PDT 中为 PHP 文件工作？

* * *

## 回答 #1

> 赞同：66
> 
> 时间：2008-09-18T22:50:56.603

这确实是 Eclipse 中最需要的特性之一。它不仅在 PHP 文件中丢失——它在 IDE 中丢失。幸运的是，我们从 Google Summer of Code 中得到了这个插件[Eclipse Word-Wrap](http://ahtik.com/blog/projects/eclipse-word-wrap/)

要安装它，请在 Eclipse 中添加以下更新站点：

[AhtiK Eclipse WordWrap 0.0.5 更新站点](http://ahtik.com/eclipse-update/)

* * *

## 回答 #2

> 赞同：15
> 
> 时间：2013-04-03T09:06:45.737

[Florian Weßling的 Eclipse Word-Wrap 插件](http://dev.cdhq.de/eclipse/word-wrap/)在 Eclispe PDT (3.0.2) 中运行良好。

**安装和更新站点**

*建议* `-clean` *安装后立即使用选项重启 Eclipse。*

Eclipse Indigo 3.7：[http](http://dev.cdhq.de/eclipse/updatesite/indigo/)
://dev.cdhq.de/eclipse/updatesite/indigo/ Eclipse Juno 4.2：[http://dev.cdhq.de/eclipse/updatesite/juno/](http://dev.cdhq.de/eclipse/updatesite/juno/)
Eclipse Kepler 4.3：[http://dev. cdhq.de/eclipse/updatesite/kepler/](http://dev.cdhq.de/eclipse/updatesite/kepler/)
Eclipse Luna 4.4：[http](http://dev.cdhq.de/eclipse/updatesite/luna/)
://dev.cdhq.de/eclipse/updatesite/luna/ Eclipse Mars 4.5：[http](http://dev.cdhq.de/eclipse/updatesite/mars/)
://dev.cdhq.de/eclipse/updatesite/mars/ Eclipse Neon 4.6：不需要插件。* 只需按`Alt`- `Shift`- `Y`:)

^(* 有关更多详细信息以及如何使自动换行永久化，请参阅[KrisWebDev 的回答。](https://stackoverflow.com/a/37103016/1134080))

**用法**

安装插件后：

*   上下文菜单：*右键单击*>*切换自动换行*
*   菜单栏：*编辑*>*切换自动换行*
*   键盘快捷键：`Ctrl`- `Alt`-`E`
*   您也可以：在所有打开的编辑器中*编辑*>*激活自动换行*

自动换行设置的当前状态没有专门的指示器，但您可以在编辑器中查看水平滚动条。

*   水平滚动条可见：自动换行已禁用。
*   没有水平滚动条：已启用自动换行。

* * *

## 回答 #3

> 赞同：10
> 
> 时间：2016-05-08T17:55:31.223

终于在 2016 年有了**原生支持**！

您需要最新的 Eclipse **NEON**版本，因为[Bug 35779](https://bugs.eclipse.org/bugs/show_bug.cgi?id=35779)最终得到修补：

*   使用[Eclipse 安装程序](https://eclipse.org/downloads/index.php?show_instructions=TRUE)
*   单击右上角的“菜单”图标并选择`ADVANCED MODE`
*   选择`Eclipse IDE for PHP Developers`产品*版本*：`Latest`
*   下一步...下一步，完成

`Alt`现在您可以使用++为每个文件手动`Shift`转换自动换行！`Y`无聊的！

所以如果你幸运的话，应该在> > > > > 中丢失了一个[不错的全局设置](https://bugs.eclipse.org/bugs/attachment.cgi?id=257691)，但不，这是一个陷阱，没有 GUI 设置！至少在撰写本文时。`Window``Preferences``General``Editors``Text Editors``Enable Wordwrap`

所以我找到了**全局**设置它的艰难方法（默认情况下）：

1.  关闭日食

2.  查找`org.eclipse.ui.editors.prefs`Eclipse 设置文件：

    `find ~ -name org.eclipse.ui.editors.prefs -printf "%p %TY-%Tm-%Td %TH:%TM:%TS\n"`

如果您在 macOS 之类的平台上，上面的命令不起作用，您可以在当前工作区文件夹中的`.metadata/.plugins/org.eclipse.core.runtime/.settings/org.eclipse.ui.editors.prefs`.

3.  添加：

    `wordwrap.enabled=true`

* * *

## 回答 #4

> 赞同：9
> 
> 时间：2008-09-18T22:36:20.167

这是一个已知的增强请求。[错误 35779](https://bugs.eclipse.org/bugs/show_bug.cgi?id=35779)

# asp.net - Visual Studio 2005 说我没有调试权限？

> ID：97666
> 
> 赞同：1
> 
> 时间：2008-09-18T22:31:36.370
> 
> 标签：asp.net, visual-studio, debugging

我是 Visual Studio/asp.net 的新手，所以请多多包涵。使用 vs 2005 和 asp.net 3.5。我在生产服务器上安装了 vs。如果我在调试我的网站时将站点的启动选项设置为“使用默认 Web 服务器”vs 尝试在[http://localhost:4579/project打开站点](http://localhost:4579/project)并返回 404。如果我将启动选项设置为“使用自定义服务器”并指定正确的应用程序路径（我从外部访问站点的方式）vs 无法运行调试并返回错误“无法在Web 服务器。登录失败：未知用户名或密码错误”。我在生产服务器上以管理员身份运行 vs。我想也许我需要在 Visual Studio 远程调试监视器中设置用户权限，但我的管理员帐户已经在那里。我检查了 IIS 并确保检查了应用程序配置/调试“启用 asp 服务器端脚本调试”。Web 配置也设置为 debug="true"。显然我错过了一些东西。

编辑 > 运行 windows server 2003

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2008-09-18T22:35:25.393

这样做...而不是尝试按 F5 进行调试

*   转到工具
*   附加到进程
*   单击查看所有用户的进程
*   确保仅选择托管代码
*   选择“W3WP.EXE”。这是 ASP.NET 工作进程。
*   单击附加。
*   您现在已附加并调试，请在浏览器中刷新页面，它应该会遇到您的断点。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2008-09-18T22:36:58.683

您是在 Vista 还是 Server 2008 上运行？我不确定 Vista，但是当我运行 Server 2008 时，当我以普通用户身份启动 VS 时尝试调试时出现权限错误。我的解决方案是右键单击 VS 图标并选择“以管理员身份运行”。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2008-09-18T22:47:56.800

您运行的帐户需要是开发人员用户组的一部分。否则将无法正确调试。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2008-11-03T16:59:51.477

您是否检查过是否为所需网站打开了集成 Windows 身份验证。这是调试所必需的。

注意：您可以同时启用此功能和 Annonomus 访问权限。这意味着该站点将登录用户视为他们的用户帐户，而不是将登录用户视为匿名帐户。如果应用程序尝试访问需要登录的内容，未登录的用户只会看到一个登录框。

要调试 Javascript，您必须在 IE 的设置中启用它。在调试之前取消选中“IE->工具->选项->高级->浏览->禁用脚本调试”中的两个设置。

# java - 在 Castor OQL 中过滤当前日期

> ID：97678
> 
> 赞同：1
> 
> 时间：2008-09-18T22:34:00.513
> 
> 标签：java, castor, apache-cocoon, oql

我正在运行 java cocoon 2 和 castor oql。我正在尝试按今天的日期过滤我的 oql 查询，但我似乎无法弄清楚（或在谷歌中找到）日期的语法。数据库是 mySql，但是 oql 是由 java 类映射的......所以在 field_date >= Now() 上进行搜索不起作用。有任何想法吗？我真的无法忍受这个网站的局限性，但这是我必须使用的。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2008-09-23T04:41:00.620

自从我使用 Cocoon 已经有一段时间了，所以我不能说我真的有一个很好的答案给你。但是由于这个问题一直停滞不前，所以有几点建议；-)

1.  仅当您对文字 SQL 字符串进行编码时，语法才有意义。我的印象是使用 castor 可以绑定变量（并让 OQL 选择适当的格式）。即“哪里 field_date >= ？”，myDateVal

2.  CastorTransformer 似乎只在一个特定版本的 Cocoon 中短暂出现，而 AFAIK 不是最新版本。如果您可以控制正在运行的 Cocoon 版本，则可能需要查看 CastorTransformer 的升级和替代方案

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2008-10-28T20:39:35.003

改编自[Castor JDO FAQ](http://www.castor.org/jdo-faq.html#How-should-I-represent-string/date/boolean-literals-in-OQL-query?)，假设您要与日期而不是时间戳进行比较（请参阅[OQL 参考](http://www.castor.org/oql.html#OQL-FAQ)）。

```
OQLQuery query = db.getOQLQuery("SELECT p FROM Person p "
      +"WHERE lastvisitdate=$2");
query.bind( new Date() ); //new Date() defaults to today. 
```

# user-interface - 游戏界面HUD

> ID：97681
> 
> 赞同：5
> 
> 时间：2008-09-18T22:34:21.433
> 
> 标签：user-interface, hud

制作游戏UI有哪些好的工具和技术？我正在寻找可以帮助艺术家类型创建和动画游戏 HUD（平视显示器）UI 并且可以添加到游戏引擎以进行实时播放的东西。

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2008-09-19T16:06:36.527

如果您使用的是 Torque 或 Unity3D 之类的中间件环境，它们包含一个 GUI 框架供您构建。Flash 是一个理想的工具，但要在 Flash 或 Shockwave3d 游戏以外的任何东西中使用，您还需要购买 ScaleForm，它价格昂贵，而且对于独立开发者来说不容易掌握。WPF 和 Silverlight 看起来很有前途，但到目前为止还没有为游戏集成设置。

不幸的是，对于许多开发人员来说，唯一的解决方案是从头开始滚动他们自己的 UI 组件。

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2008-09-18T22:42:09.870

使用 Flash 将为图形艺术家提供最高的工作效率（好吧 - 如果他知道 Flash）。

你可能想看看gameswf。它有点过时，但似乎非常适合您的问题。

[http://tulrich.com/geekstuff/gameswf.html](http://tulrich.com/geekstuff/gameswf.html)

另一种选择是在您的 3D 内容工具中完成整个 UI，并使用您的动画系统来播放过渡。

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2008-09-18T22:36:16.640

一种选择是将 Flash 与名为 ScaleForm 的包结合使用。这允许艺术家在 Flash 中制作 UI，然后 ScaleForm 在游戏中执行 Flash。

# css - 绝对位置，谁能解释一下

> ID：97683
> 
> 赞同：3
> 
> 时间：2008-09-18T22:35:04.053
> 
> 标签：css, css-position

这是我需要解释的 CSS 片段：

```
#section {
    width: 860px;
    background: url(/blah.png);
    position: absolute;
    top: 0;
    left: 50%;
    margin-left: -445px;
} 
```

好的，显然这是图像的绝对定位。

1.  top 就像从顶部填充，对吗？
2.  剩下的 50% 做什么？
3.  为什么左边距是-445px？

**更新：** 宽度为 860 像素。实际图像是 100x100 是否有区别？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2008-09-18T22:43:37.433

1.  Top 是到 html 元素顶部的距离，或者，如果它在另一个具有绝对位置的元素内，则距该顶部的距离。

2.  & 3\. 它取决于图像的宽度，但它可能用于水平居中图像（如果图像的宽度为 890 像素）。不过，还有其他方法可以使图像水平居中。更常见的是，这用于将已知高度的块垂直居中（这是将已知高度的东西垂直居中的最简单方法）：

    ```
    top: 50%
    margin-top: -(height/2)px; 
    ```

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2008-09-18T22:46:14.463

这可能是为了使页面上的元素居中（使用[“死中心”](http://www.wpdfd.com/editorial/thebox/deadcentre4.html)技术）。

它的工作原理是这样的：假设元素是 890px 宽，它被设置为`position:absolute`and `left:50%`，它把它的**左边缘**放在浏览器的**中心**（好吧，它可能是其他元素的中心`position:relative`）。

然后负边距用于**将左侧边缘**向左移动等于**元素宽度一半的**距离，从而使其居中。

当然，这可能不会完全居中（这取决于元素的实际宽度，`width`您粘贴的代码中没有，因此无法确定）但它肯定将元素放置在相对于页面中心的位置

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2008-09-18T22:39:32.497

> top 就像从右上角填充？

是的，页面顶部。

> 剩下的 50% 做什么？

它将内容移动到屏幕的中心（100% 将一直向右。）

> 为什么左边距是-445px？

用“left: 50%”移动它后，它会向左移动 445 像素。

* * *

## 回答 #4

> 赞同：2
> 
> 时间：2008-09-18T22:48:52.960

上面的代码片段与一个 id 为 section 的元素（可以是 div、span、image 或其他）相关。

该元素有一个 blah.png 的背景图像，它将在 x 和 y 方向上重复。

如果父元素也是绝对定位的，则元素的顶部边缘将位于距其父元素顶部 0px（或任何其他单位）的位置。如果父窗口是窗口，它将位于浏览器窗口的顶部边缘。

该元素的左边缘将位于其父元素左边缘左侧的 50% 处。

然后该元素将从该 50% 点向左“移动”445px。

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2008-09-18T22:39:37.943

[通过阅读CSS 盒子模型](http://www.w3.org/TR/CSS2/box.html)，你会发现所有你需要知道的东西

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2008-09-18T22:37:59.913

当 position 是绝对值时，top 是到父级的垂直距离（可能是 body 标签，所以 0 是浏览器窗口的上边缘）。左 50% 是距左边缘的距离。负边距将其向左移动 445 像素。至于为什么，你的猜测和我的一样好。

* * *

## 回答 #7

> 赞同：0
> 
> 时间：2016-01-14T21:37:45.647

冒着听起来像显而易见的船长的风险，我将尝试尽可能简单地解释它。

Top 是一个数字，它确定您希望它从其上方的任何 html 元素的顶部开始的像素数......所以不一定是页面的顶部。在设计 css 时要小心你的 html 格式。

Your left to 50% should move it to the center of your screen, given that it's 50\. Keep in mind people have different screen sizes and is allocated to the (0,0) top left of your image, not the center of the image, so it will not be perfectly allocated to the center of one's screen like you may expect it to.

THIS is why the margin-left to -445 pixels is used-- to move it further over, fixed.

Good luck, I hope that this made sense. I was trying to word my explanation differently in case other answers were still giving you a hard time. They were great answers as well.

(If you have two different sized monitors, I suggest toying around the with the code to see how each modification affects different sized screens!)

# c - 在vim中使用C自动缩进空格？

> ID：97694
> 
> 赞同：87
> 
> 时间：2008-09-18T22:36:57.810
> 
> 标签：c, vim, coding-style, vi

我在使用 Eclipse 和 java 时有点被宠坏了。我开始在 linux 环境中使用 vim 进行 C 编码，有没有办法让 vim 自动为块做适当的间距？

因此，在键入 { 后，下一行将缩进 2 个空格，并且该行上的 return 将使其保持相同的缩进，而 } 将移回 2 个空格？

* * *

## 回答 #1

> 赞同：137
> 
> 时间：2008-09-18T22:41:16.690

这两个命令应该这样做：

```
:set autoindent
:set cindent 
```

对于奖励积分，请将它们放在一个名为 .vimrc 的文件中，该文件位于您的 linux 主目录中

* * *

## 回答 #2

> 赞同：57
> 
> 时间：2008-09-18T22:47:32.620

我[在 vim 中写了所有关于标签的内容](http://tedlogan.com/techblog3.html)，它提供了一些你没有问过的有趣的东西。要自动缩进大括号，请使用：

```
:set cindent 
```

缩进两个空格（而不是八个空格的一个制表符，vim 默认）：

```
:set shiftwidth=2 
```

要防止 vim 将八个空格转换为制表符：

```
:set expandtab 
```

如果您想更改文本块的缩进，请使用 < 和 >。我通常将此与块选择模式（v，选择文本块，< 或 >）结合使用。

（我会尝试说服您不要使用两个空格缩进，因为我（和大多数其他人）发现它很难阅读，但这是另一个讨论。）

* * *

## 回答 #3

> 赞同：8
> 
> 时间：2008-09-19T00:35:03.937

vim 的许多功能（如`autoindent`和`cindent`）默认情况下是关闭的。要真正了解 vim 可以为您做什么，您需要一个像样的`~/.vimrc`.

一个好的入门者是在`$VIMRUNTIME/vimrc_example.vim`。如果您想尝试一下，请使用

```
:source $VIMRUNTIME/vimrc_example.vim 
```

在 vim 中时。

I'd actually suggest just copying the contents to your `~/.vimrc` as it's well commented, and a good place to start learning how to use vim. You can do this by

```
:e $VIMRUNTIME/vimrc_example.vim
:w! ~/.vimrc 
```

This will overwrite your current `~/.vimrc`, but if all you have in there is the indent settings Davr suggested, I wouldn't sweat it, as the example vimrc will take care of that for you as well. For a complete walkthrough of the example, and what it does for you, see `:help vimrc-intro`.

* * *

## 回答 #4

> 赞同：5
> 
> 时间：2010-04-17T07:10:13.900

## Simply run:

```
user@host:~ $ echo set autoindent >> .vimrc 
```

* * *

## 回答 #5

> 赞同：4
> 
> 时间：2011-06-22T00:33:24.763

I think the best answer is actually explained on the vim wikia:

[http://vim.wikia.com/wiki/Indenting_source_code](http://vim.wikia.com/wiki/Indenting_source_code)

Note that it advises against using "set autoindent." The best feature of all I find in this explanation is being able to set per-file settings, which is especially useful if you program in python and C++, for example, as you'd want 4 spaces for tabs in the former and 2 for spaces in the latter.

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2008-09-18T23:09:28.200

并永远记住这个关于空格 + 制表符的古老解释：

[http://www.jwz.org/doc/tabs-vs-spaces.html](http://www.jwz.org/doc/tabs-vs-spaces.html)

* * *

## 回答 #7

> 赞同：-1
> 
> 时间：2008-09-18T22:40:44.727

尝试：

设置 sw=2

设置 ts=2

设置智能缩进

# asp.net - 将 ASP.NET SiteMap 用于具有多个路径的页面

> ID：97732
> 
> 赞同：0
> 
> 时间：2008-09-18T22:41:52.773
> 
> 标签：asp.net, vb.net, .net-2.0

我有一个特定的页面（我们称之为 MyPage），可以从三个不同的页面访问它。在 Web.sitemap 文件中，我尝试将此页面的 XML 填充到三个单独的节点下，如下所示：

<第1页> <我的页面
  />
  ...
</第1页>

<第2页> <我的页面
  / >
  ...
</第2页>

<第3页> <我的页面
  />
  ...
</第3页>

在这样做时，我收到以下错误：

找到具有相同 URL 'Default.aspx' 的多个节点。XmlSiteMapProvider 要求站点地图节点具有唯一的 URL。

我在网上读到 SiteMapNodes 在内部存储为字典，这解释了为什么我不能使用相同的 URL。无论如何，我只是在寻找解决这个问题的替代方法。任何建议将不胜感激。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2008-09-18T22:58:17.367

这并不是 Web.sitemap 文件的真正预期目的。

来自[SiteMap 类的 MSDN Docs](http://msdn.microsoft.com/en-us/library/system.web.sitemap(VS.80).aspx)，

> 从根本上说，SiteMap 是 SiteMapNode 对象的分层集合的容器。但是，SiteMap 不维护节点之间的关系；相反，它将这个委托给站点地图提供者。

因此，简单地说，web.SiteMap 只描述了页面的*层次结构*，而不是这些页面*之间*的关系。

但是，如果您的意图只是将“MyPage”链接到您的其他页面，那么无论如何您都不需要将 MyPage 作为这些其他页面的子节点。

希望这有助于澄清一些事情。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2008-09-20T07:17:14.123

我知道你可以有两个不同的 ~/folder/index.aspx 和 ~/folder/ 条目都指向同一个地方。有点小技巧，是的，但也许有一种方法可以让你更进一步？

*   ~/文件夹/index.aspx
*   〜/文件夹/
*   〜/文件夹

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2008-10-14T18:23:32.153

你可以试试这个...

```
<siteMapNode url="ListAll.aspx">
  <siteMapNode url ="Detail.aspx?node=all" />
</siteMapNode>
<siteMapNode url="ListMine.aspx">
  <siteMapNode url ="Detail.aspx?node=mine" />
</siteMapNode> 
```

但是，如果您尝试转到“Detail.aspx?node=all&id=13”，它会中断（我仍在尝试解决。）

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2008-11-15T02:23:23.310

一种简单但有效的方法是使用不同的查询字符串进行区分：

*   default.aspx?page=1
*   default.aspx?page=2
*   default.aspx?page=3

尽管它们都指向同一个页面，但它们在站点地图中都是不同的。

# c# - 使用 PostSharp 拦截对 Silverlight 对象的调用？

> ID：97733
> 
> 赞同：3
> 
> 时间：2008-09-18T22:41:54.707
> 
> 标签：c#, postsharp

我正在使用 PostSharp 拦截对我不拥有的对象的方法调用，但我的方面代码似乎没有被调用。Silverlight 区域的文档似乎很松散，所以我很感激你们能提供的任何帮助:)

我有一个看起来像这样的属性：

```
public class LogAttribute : OnMethodInvocationAspect
{
    public override void OnInvocation(MethodInvocationEventArgs eventArgs)
    {
        // Logging code goes here...
    }
} 
```

我的 AssemblyInfo 中的一个条目如下所示：

```
[assembly: Log(AttributeTargetAssemblies = "System.Windows", AttributeTargetTypes = "System.Windows.Controls.*")] 
```

所以，我对你的问题是......我错过了什么？匹配属性目标下的方法调用似乎不起作用。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-03-16T10:15:25.677

**当前版本的 PostSharp 无法做到这一点。**

PostSharp 通过在 CLR 加载之前转换程序集来工作。现在，为了做到这一点，必须做两件事：

*   程序集必须即将加载到 CLR 中；你只能得到一个镜头，你必须在这一点上采取它。
*   转换阶段完成后，您无法进行任何其他修改。这意味着您不能在运行时修改程序集。

最新版本 1.5 CTP 3[消除了这两个限制中的第一个](http://www.postsharp.org/blog/announcing-postsharp-1.5-ctp-3)，但真正有问题的是第二个。然而，这是[一个非常需要的功能](http://www.postsharp.org/blog/using-postsharp-at-runtime)，所以请注意：

> 用户经常询问是否可以在运行时使用 PostSharp，因此在编译时不必知道方面。部署后更改方面确实是一个很大的优势，因为它允许支持人员启用/禁用对软件各个部分的跟踪或性能监控。**它可以实现的一件很酷的事情是在第三方程序集上应用方面。**
> 
> 如果你问是否可能，简短的回答是肯定的！**不幸的是，长答案更复杂。**

### 运行时/第三方方面的陷阱

作者还继续概述了如果您允许在运行时进行修改会发生的一些问题：

> 那么现在，有什么问题呢？
> 
> *   **插入引导程序。**如果您的代码是托管的（例如在 ASP.NET 或 COM 服务器中），则不能插入引导程序。因此，任何运行时编织技术都受到您应该自己托管应用程序的限制。
> *   **在 CLR 之前。**如果 CLR 自己找到未转换的程序集，它不会要求转换的程序集。因此，您可能需要为转换后的应用程序创建一个新的应用程序域，并将转换后的程序集放在其二进制路径中。这也许不是什么大问题。
> *   **强大的名字。**哎呀。如果在运行时修改程序集，则必须删除其强名称。它会起作用吗？是的，主要是。当然，您必须从对该程序集的所有引用中删除强名称。这不是问题。PostSharp 开箱即用地支持它。但是有一些 PostSharp 无法解决的问题：如果在字符串或文件中（例如在 app.config 中）有一些强命名的引用，我们很难找到它们并对其进行转换。所以这里我们有一个真正的限制：不能有对强命名程序集的“松散引用”：我们只能转换真正的引用。
> *   **加载自。**如果任何程序集使用 Assembly.LoadFrom、Assembly.LoadFile 或 Assembly.LoadBytes，我们的引导程序将被跳过。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2008-09-18T22:47:23.697

我相信如果您将 AttributeTargetAssemblies 更改为“PresentationFramework”，它可能会起作用。（还没有把 PostSharp 搞得那么好）。

WPF 的程序集是 PresentationFramework.dll。AttributeTargetAssemblies 需要它应该定位的 dll。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2009-03-13T20:23:57.837

PostSharp 有一个新版本，可从下载页面链接访问“所有下载”。

[PostSharp 1.5 PostSharp](http://www.postsharp.org/all-downloads/postsharp-1.5) 的开发分支，包括支持 Mono、Compact Framework 或 Silverlight 以及方面继承等新功能。如果您想尝试新功能并通过测试新开发来帮助社区，并且可以接受 API 的可靠性和稳定性较差，请从此分支下载。

该版本目前为 1.5 CTP 3，但它支持 Silverlight。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2008-09-19T02:24:37.480

如果您试图拦截框架内的调用（即，不在您自己的代码中），它将无法正常工作。PostSharp 只能替换您自己程序集中的代码。如果您试图拦截您正在拨打的电话，那么它看起来应该可以工作。您是否看到 PostSharp 在构建输出中运行？

# java - OSCache 与 EHCache

> ID：97741
> 
> 赞同：19
> 
> 时间：2008-09-18T22:43:12.083
> 
> 标签：java, caching, ehcache, oscache

以前从未使用过这样的缓存。问题是我想从数据库中加载 500,000 多条记录并快速进行一些选择/过滤。

我正在考虑使用缓存，并初步找到了[EHCache](http://ehcache.org/)和[OSCache](https://java.net/projects/oscache/)，有什么意见吗？

* * *

## 回答 #1

> 赞同：54
> 
> 时间：2009-09-02T13:28:49.187

从他们的[发布页面](http://www.opensymphony.com/oscache/download.action)来看，自 2007 年以来，OSCache 就没有得到积极维护。这不是一件好事。另一方面，EhCache 正在不断开发中。仅出于这个原因，我会选择 EhCache。

2013 年 11 月编辑：OSCache 与 OpenSymphony 的其余部分一样，已死。

* * *

## 回答 #2

> 赞同：19
> 
> 时间：2008-09-18T23:16:16.217

它们都是非常可靠的项目。如果您有非常基本的缓存需求，那么其中任何一个都可能与另一个一样好。

如果可行，您可能还希望考虑在数据库查询中进行过滤。通常，与将 500,000 行加载到内存然后过滤它们相比，使用返回较小结果集的优化查询会给您带来更好的性能。

* * *

## 回答 #3

> 赞同：6
> 
> 时间：2008-09-19T00:00:44.940

我使用过 JCS ( [http://jakarta.apache.org/jcs/](http://jakarta.apache.org/jcs/) )，它看起来很可靠且易于以编程方式使用。

* * *

## 回答 #4

> 赞同：5
> 
> 时间：2008-09-18T23:26:12.777

这有点取决于您的需求。如果您在一台机器上的内存中进行工作，那么 ehcache 将完美运行，前提是您有足够的 RAM 或足够快的硬盘，这样溢出不会导致磁盘分页/抖动。如果你发现你需要实现可伸缩性，即使这种特定操作发生了很多，那么你可能会想要进行集群。JBoss 的 JGroups /TreeCache 支持这一点，EHcache 也是如此（我认为），而且我知道如果您将 Ehcache 与 terracotta 一起使用，它肯定会起作用，这是一个非常巧妙的集成。这个答案并没有直接说明 EHcache 和 OSCache 的优点，所以这里的答案是：EHcache 似乎具有最大的惰性（曾经是默认的、众所周知的、积极的开发，包括一个新的缓存服务器），并且 OSCache 似乎（至少在某一点上）具有更多的功能，但我认为使用上面提到的选项，这些优势是没有实际意义的/被取代的。啊，我忘了提到的另一件事是数据的事务性很重要，您的要求将细化有效选择的列表。

* * *

## 回答 #5

> 赞同：5
> 
> 时间：2016-05-19T14:03:59.933

选择一个符合 JSR 107 的缓存，当您想要从一个实现迁移到另一个实现时，这将使您的工作变得轻松。具体到 Ehcache 的问题，它是更流行和广泛使用的 Java 缓存解决方案。我们广泛使用 Ehcache，它对我们有用。

* * *

## 回答 #6

> 赞同：3
> 
> 时间：2009-03-27T17:35:08.277

其他答案讨论了缓存的优缺点；但我想知道您是否真的从缓存中受益。目前还不太清楚您打算在这里做什么，以及为什么缓存会有好处：如果您有数据集供您使用，只需访问它即可。缓存仅有助于在其他独立任务之间重用事物。如果这是你正在做的，是的，缓存可以提供帮助。但是，如果它是一项可以承载其数据集的大任务，那么缓存将不会增加任何价值。

* * *

## 回答 #7

> 赞同：2
> 
> 时间：2008-09-19T01:03:43.197

无论哪种方式，我都建议将它们与 Spring 模块一起使用。缓存对应用程序是透明的，并且缓存实现很容易交换。除了 OSCache 和 EHCache，Spring Modules 还支持 Gigaspaces 和 JBoss 缓存。

至于比较.... OSCache 更容易配置 EHCache 有更多的配置选项

它们都坚如磐石，都支持镜像缓存，都与 Terracotta 一起工作，都支持内存和磁盘缓存。

* * *

## 回答 #8

> 赞同：2
> 
> 时间：2010-05-11T12:05:09.053

我在几个带有 spring-modules 的 spring 项目中使用了 oscache，使用基于 aop 的配置。

最近我想在 Spring 3.x 项目中使用 oscache + spring 模块，但发现不支持基于 spring-modules 注释的缓存（即使是 fork）。

我最近发现了这个项目——

[http://code.google.com/p/ehcache-spring-annotations/](http://code.google.com/p/ehcache-spring-annotations/)

它支持 spring 3.x 和使用 ehcache 的声明式基于注释的缓存。

* * *

## 回答 #9

> 赞同：0
> 
> 时间：2008-09-18T23:10:48.693

我主要使用 EhCache，因为它曾经是 Hibernate 的默认缓存提供程序。[Java-Source.net](http://java-source.net/open-source/cache-solutions)上有一个缓存解决方案列表。

我曾经有一个比较主要缓存解决方案的链接。如果我找到它，我会更新这个答案。

* * *

## 回答 #10

> 赞同：0
> 
> 时间：2016-05-23T23:05:52.300

OSCache 几乎已经死了，因为它在几年前就被抛弃了。您可以看看 Cacheonix，它已经在积极开发中，我们刚刚发布了 v.2.2.2，支持 Web 层中的缓存。我是一名提交者，所以如果您有任何问题，可以联系我们。

# .net - 非重叠矩形中的命中测试算法

> ID：97762
> 
> 赞同：5
> 
> 时间：2008-09-18T22:46:18.347
> 
> 标签：.net, geometry

我有一组覆盖封闭矩形的非重叠矩形。找到鼠标单击的包含矩形的最佳方法是什么？

显而易见的答案是拥有一个矩形数组并按顺序搜索它们，使得搜索 O(n)。是否有某种方法可以按位置对它们进行排序，以使算法小于 O(n)，例如 O(log n) 或 O(sqrt(n))？

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2008-09-18T22:51:31.003

您可以将矩形组织在四边形或 kd 树中。这给了你 O(log n)。这是主流的方法。

这个问题的另一个有趣的数据结构是 R-trees。如果您必须处理大量矩形，这些可能非常有效。

[http://en.wikipedia.org/wiki/R-tree](http://en.wikipedia.org/wiki/R-tree)

然后是 O(1) 方法，可以简单地生成与屏幕大小相同的位图，用“无矩形”的占位符填充它，并将命中矩形索引绘制到该位图中。查找变得如此简单：

```
 int id = bitmap_getpixel (mouse.x, mouse.y)
  if (id != -1)
  {
    hit_rectange (id);
  }
  else
  {
    no_hit();
  } 
```

显然，只有当您的矩形不经常更改并且您可以为位图腾出内存时，该方法才有效。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2008-09-18T22:56:30.943

创建一个区间树。查询区间树。请参阅麻省理工学院出版社的“算法”。

区间树最好实现为红黑树。

请记住，如果您要单击矩形更多然后您通常会更改它们的位置，则建议对矩形进行排序。

You'll have to keep in mind, that you have build build your indices for different axis separately. E.g., you have to see if you overlap an interval on X and on Y. One obvious optimization is to only check for overlap on either X interval, then immediately check for overlap on Y.

Also, most stock or 'classbook' Interval Trees only check for a single interval, and only return a single Interval (but you said "non-overlapping" didn't you?)

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2008-09-18T22:48:40.150

将它们推入[四叉树](http://en.wikipedia.org/wiki/Quadtree)。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2008-09-18T22:50:09.570

使用[BSP](http://en.wikipedia.org/wiki/Binary_space_partitioning)树来存储矩形。

# security - 强制字母数字用户 ID

> ID：97765
> 
> 赞同：3
> 
> 时间：2008-09-18T22:46:45.617
> 
> 标签：security, web-applications, finance, user-experience

我是一家金融机构的程序员。我最近被告知要强制所有新用户 ID 至少有一个字母和一个数字。我立即认为这是一个可怕的想法，我宁愿不实施它，因为我认为这是一个反功能并且用户体验很差。问题是我没有很好的理由不执行此要求。

你认为这是一个很好的要求吗？

你有什么好的理由不这样做吗？

你知道我可以参考的任何研究吗？

> 编辑：这与密码**无关。**我们已经对此提出了类似的要求，我并不反对。

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2008-09-18T22:51:10.753

反对这一点的一个论点是，其他领域的许多用户名/ID 不需要数字组件。用户更有可能更好地记住他们在其他地方使用过的用户 ID——如果他们不需要包含数字，那就更有可能了。

此外，根据系统的不同，用户 ID 在连接到外部系统时可能会作为默认值正常工作（ssh 在类 unix 系统下会以这种方式运行）。在这种情况下，拥有一个在系统之间共享的 ID 显然是有益的。

在多个地方使用相同的 ID 可以提高一致性，这是良好软件界面的一个众所周知的方面。表明人们与系统交互的方式*是*用户界面并不难，并且应该遵守（至少一些）众所周知的界面指南。（显然，如果您正在考虑多个可能未知的系统之间的交互，则键盘快捷键之类的想法毫无意义，但一致性等方面*确实*适用。）

**编辑：**我假设这个讨论是关于用户名或公开可见的 ID，而*不是*与安全直接相关的东西，例如密码。

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2008-09-18T22:56:29.400

我会首先询问他们背后的具体原因。一旦你有了一个要点列表和原因，就更容易反驳或提供替代方案。

至于一般的想法：

*   这是意见，但在用户名中添加数字不一定会提高安全性。人们在便条纸上写下用户名，大多数用户只会在其用户名的开头或结尾添加一个“1”，以便于猜测。
*   从可用性的角度来看，这很糟糕，因为它违反了规范。强迫他们在用户名中添加数字只会导致上述问题。他们只会在用户名的末尾或开头添加一个“1”。

请记住，身份验证系统越复杂，一般用户就越有可能找到绕过它的方法并使他们在链中的链接变弱。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2008-09-18T22:49:22.850

用户 ID？要求密码为字母数字通常是一个好主意，因为它使密码更能抵抗字典攻击。这对用户名没有任何意义。拥有名称/密码组合的全部意义在于名称部分不必保密。

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2008-09-18T23:10:44.483

如果你在一家金融机构工作，可能有关于这类事情的规定，所以它很可能不在你的掌控之中。但是您可以做的一件事是在用户输入无效 ID 时让他清楚。不要等到他点击提交；在字段旁边显示某种消息，并在他键入时更新它。

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2008-09-19T07:16:21.913

上面的一些答案有一个相反的论点：如果用户选择他们在其他网站上使用的相同用户名，那么他们也可能为金融网站选择相同或相似的密码，从而降低安全性。

一个不这样做的理由：如果你对用户施加比他们习惯的更多的限制，他们会开始写下登录信息，这显然是安全性的损失。

我拥有的两个银行帐户都需要一个字母数字用户名和两个密码才能在线登录。其中一个也有我必须记住的图像。这两个密码必须每月更改一次左右。因此，我将所有登录信息都保存在一个文本文件中。（即使看也没有任何意义；我将不得不去银行再次重置我的密码。总共为 6 次登录重置了 7 次密码。谈论安全性，甚至*我*都无法访问我的帐户。）

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2008-09-18T22:48:54.427

如果它在他们的密码中很好（唉，金融公司喜欢否认你的这种担保权[我在和你说话美国运通]）。

用户名，我说不，除非他们愿意。

* * *

## 回答 #7

> 赞同：0
> 
> 时间：2008-09-18T23:06:25.007

在电话寻求支持时（可能）需要在电话上引用用户名，以便与密码不同的是，它会被公开。此外，用户名字段不会像密码字段那样在浏览器中被屏蔽，因此它将有更多的曝光度并在各个地方缓存/记录，因此增加的安全性的“好处”将立即失效。

而且你做的事情越难，用户就越有可能把它写下来，这又会破坏安全性（实际上同样适用于密码策略，但那是另一回事了！）

* * *

## 回答 #8

> 赞同：0
> 
> 时间：2008-09-18T23:21:15.300

我也在一家金融机构工作，我们的用户名（真实的人和生产 ID）都是小写字母，最多 8 个字符，我从来没有认为这是一个问题......避免了 0 与 O、1 与我和 8 vs B - 除非你和我在同一家公司工作并且即将实施新政策......

* * *

## 回答 #9

> 赞同：0
> 
> 时间：2008-09-19T15:09:03.717

添加任何功能都会增加成本。现在需要时间来构建和测试它，并在未来支持它。没有充分的理由就不应该构建任何功能。

这个功能毫无意义。用户名不应该保密，因此拥有强大的用户名没有任何优势。花时间使密码（或其他身份验证因素）变得强大可能是值得的，但用户应该能够将他们的用户名传达给其他用户，而不会有安全风险。

如果您的应用程序对用户 ID 的选择施加了额外的限制，那么您的一些用户对于您的应用程序的用户 ID 将与您环境中的其他应用程序的用户 ID 不同。注意：我假设这是一个内部应用程序（供员工使用），而不是面向 Internet 的应用程序。

用户名不一致会增加许多特定风险：

1.  这将使审计跟踪更难跟踪（严重的安全风险）。
2.  如果您稍后开始使用[单点登录](http://en.wikipedia.org/wiki/Single_sign-on)，可能会增加成本。
3.  这将导致糟糕的用户体验，因为用户必须记住这个应用程序使用了一个奇怪的用户名。

# linux - 在 Linux CLI 上将常见视频格式转换为 FLV 的最佳工具是什么

> ID：97781
> 
> 赞同：11
> 
> 时间：2008-09-18T22:48:10.807
> 
> 标签：linux, flash, video, flv

我被指派从事的新产品的一部分涉及将“常见”视频格式在服务器端转换为 Flash 可以播放的格式。

据我所知，我唯一的选择是转换为 FLV。我一直在尝试使用 ffmpeg，但我发现一些 WMV 文件出现乱码（我尝试过播放音频速率）。

是否还有其他适用于 Linux 的“好”CLI 转换器？或者还有其他 Flash 可以播放的视频格式吗？

* * *

## 回答 #1

> 赞同：15
> 
> 时间：2008-09-18T22:50:17.013

Flash 可以播放以下格式：

```
FLV with AAC or MP3 audio, and FLV1 (Sorenson Spark H.263), VP6, or H.264 video.
MP4 with AAC or MP3 audio, and H.264 video (mp4s must be hinted with qt-faststart or mp4box). 
```

ffmpeg 是一个整体不错的转换工具；mencoder 可以更好地处理晦涩和专有的格式（由于 w32codecs 二进制解码器包），但它的多路复用并不理想（阅读：通常完全损坏）。一种解决方案可能是通过 mencoder 使用 x264 对 H.264 进行编码，然后使用 mp4box 单独进行多路复用。

作为 x264 的开发人员（以及用于在线视频播放的 flash 的狂热用户），我在这类东西方面有相当多的经验，所以如果你需要更多帮助，我也可以在 Freenode IRC #x264 上获得帮助， #ffmpeg 和 #mplayer。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2008-09-18T23:02:28.153

大多数编码器默认情况下（包括 ffmpeg）将 mp4 的标头原子（“moov atom”）放在视频的末尾，因为它们在完成编码之前无法放置标头。但是，为了让文件在下载完成之前开始播放，必须将 moov atom 移到前面。

为此，您必须使用 mp4box（默认情况下执行此操作）（重新）复用或使用 qt-faststart，这是一个用于 ffmpeg 的脚本，它只是将原子移动到前面。它很简单。

请注意，对于 FLV，默认情况下，ffmpeg 将使用 FLV1 视频格式，这非常糟糕；到目前为止，它已有十多年的历史了，考虑到现代标准，它的效率相当糟糕。您最好使用更现代的格式，如 H.264。

# delphi - 如何修复此 delphi 7 编译错误 - “重复资源”

> ID：97800
> 
> 赞同：3
> 
> 时间：2008-09-18T22:50:28.883
> 
> 标签：delphi, resources

我正在尝试编译我继承的 Delphi 7 项目，但出现此错误：

> [错误] 警告。重复资源：
> [错误] 类型 2 (BITMAP)，ID 编辑：
> [错误] 文件 C:[路径缩短]\common\CRGrid.res 资源保留；文件 c:\common\raptree.RES 资源被丢弃。

它说警告，但它实际上是一个错误 - 编译没有完成。

看起来两个组件 - CRGrid 和 RapTree - 正在以某种方式发生碰撞。有没有人对如何解决这个问题有任何想法？

当然，除了从项目中删除一个组件之外。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2008-09-18T22:54:21.417

尝试启动您的资源编辑器（我很确定 Delphi 自带）并打开文件。检查两者中有哪些位图资源，看看哪些可能是重复的。

如果您需要保留这两种资源，则需要重新编号其中之一。

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2008-09-18T22:54:43.960

试试这个：[修复“重复资源”错误](http://delphi.about.com/od/adptips2005/a/bltip0105_3.htm)

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2008-09-18T22:53:16.177

您需要进入组件并重命名其中一个资源，然后更新组件代码以使用新名称。这是一种痛苦，但这是你所能做的。

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2012-08-21T13:33:21.493

我知道这是一个旧线程，但对于维护旧代码的任何人来说仍然值得更新：

我遇到了这个问题，这是由于 RES 文件中的图像被命名为相同的东西。Delphi7 有一个可以打开 RES 文件的图像编辑器。只需打开涉及重复资源错误的两个 RES 文件，然后重命名一个有问题的重复资源。保存 RES 文件并重新编译。当我用（稍微）较新的组件替换 Delphi 7 应用程序中的旧组件时，最近为我工作了两次。

# linux - 你禁用 SELinux 吗？

> ID：97816
> 
> 赞同：19
> 
> 时间：2008-09-18T22:55:12.833
> 
> 标签：linux, selinux

我想知道这里的人们是否通常在默认情况下启用 SELinux 的安装中禁用它？如果是这样，你能解释为什么，它是什么样的系统，等等？

我想尽可能多地对此发表意见。

* * *

## 回答 #1

> 赞同：13
> 
> 时间：2008-09-18T23:06:51.497

三四年前我做到了，当时定义的政策有很多陷阱，制定政策太难了，我“没有时间”学习。当然，这是在非关键机器上进行的。

如今，为发布带有合理策略的发行版所做的所有工作，以及帮助您创建、修复和定义策略的现有[工具](http://seedit.sourceforge.net/index.html)和[教程](http://www.redhatmagazine.com/2007/08/21/a-step-by-step-guide-to-building-a-new-selinux-policy-module/)，都没有理由禁用它。

* * *

## 回答 #2

> 赞同：8
> 
> 时间：2008-09-19T00:12:52.320

I worked for a company last year where we were setting it enforcing with the 'targeted' policy enabled on CentOS 5.x systems. It did not interfere with any of the web application code our developers worked on because Apache was in the default policy. It did cause some challenges for software installed from non-Red Hat (or CentOS) packages, but we managed to get around that with the configuration management tool, [Puppet](http://reductivelabs.com/trac/puppet).

We used Puppet's template feature to generate our policies. See [SELinux Enhancements for Puppet](http://spook.wpi.edu/), heading "Future stuff", item "Policy Generation".

Here's some basic steps from the way we implemented this. Note other than the audit2allow, this was all automated.

Generate an SELinux template file for some service named ${name}.

```
sudo audit2allow -m "${name}" -i /var/log/audit/audit.log > ${name}.te 
```

Create a script, `/etc/selinux/local/${name}-setup.sh`

```
SOURCE=/etc/selinux/local
BUILD=/etc/selinux/local

/usr/bin/checkmodule -M -m -o ${BUILD}/${name}.mod ${SOURCE}/${name}.te
/usr/bin/semodule_package -o ${BUILD}/${name}.pp -m ${BUILD}/${name}.mod
/usr/sbin/semodule -i ${BUILD}/${name}.pp

/bin/rm ${BUILD}/${name}.mod ${BUILD}/${name}.pp 
```

That said, most people are better off just disabling SELinux and hardening their system through other commonly accepted consensus based best practices such as [The Center for Internet Security's Benchmarks](http://cisecurity.org/) (note they recommend SELinux :-)).

* * *

## 回答 #3

> 赞同：5
> 
> 时间：2008-09-19T15:02:59.520

我公司做一个CMS/集成平台产品。我们的许多客户都有遗留的第 3 方系统，其中仍然有重要的操作数据，并且大多数人希望继续使用这些系统，因为它们可以正常工作。因此，我们通过多种方式挂钩我们的系统以提取数据以进行发布或报告等。在每台服务器上运行大量客户端特定的东西使得正确配置 SELinux 成为一项艰巨的，因此也是昂贵的任务。

许多客户最初想要最好的安全性，但是当他们听到我们的集成解决方案的成本估算时，“SELinux disabled”这个词往往很快就会出现在项目计划中。

真可惜，因为纵深防御是个好主意。不过， SELinux 从来都不是安全所*必需*的，这似乎是它的失败之处。当客户问“那么你能在没有 SELinux 的情况下确保它的安全吗？”，我们应该回答什么？“嗯……我们不确定”？

我们可以而且我们会，但是当地狱冻结，发现一些新的漏洞，更新没有及时出现，你的系统很不幸成为零基础...... SELinux 可能会拯救你的屁股。

但这是一个艰难的销售。

* * *

## 回答 #4

> 赞同：3
> 
> 时间：2010-11-22T07:06:23.837

I used to work for a major computer manufacturer in 3rd level support for RedHat Linux (as well as two other flavors) running on that company's servers. In the vast majority of cases, we had SELinux turned off. My feeling is that if you REALLY NEED SeLinux, you KNOW that you need it and can state specifically why you need it. When you don't need it, or can't clearly articulate why, and it is enabled by default, you realize pretty quickly that it is a pain in the rear end. Go with your gut instinct.

* * *

## 回答 #5

> 赞同：2
> 
> 时间：2008-09-18T23:10:03.890

我听说它正在好转，但我仍然禁用它。对于服务器，除非您是希望在多个本地用户之间实施细粒度访问级别控制的 ISP 或大型公司，否则它实际上没有任何意义。

在 Web 服务器上使用它时，我在 apache 权限方面遇到了很多问题。我必须不断地奔跑，

```
chcon -R -h -t httpd_sys_content_t /var/www/html 
```

添加新文件时更新 ACL。我确信这个问题现在已经解决了，但是，SELinux 仍然让您在标准网站部署中启用它所获得的有限回报非常痛苦。

* * *

## 回答 #6

> 赞同：2
> 
> 时间：2008-11-12T15:41:06.500

可悲的是，我大部分时间也关闭了 SELinux，因为大量第三方应用程序，如 Oracle，在打开 SELinux 的情况下不能很好地工作和/或在运行 SELinux 的平台上不受支持。

请注意，Red Hat 自己的 Satellite 产品也要求您关闭 SELinux，这再次令人遗憾地说明了人们在支持 SELinux 的平台上运行复杂应用程序时遇到的困难。

对您可能有用也可能没用的使用提示：SELinux 可以在运行时通过使用 setenforce 来打开和关闭（使用 getenforce 检查当前状态）。restorecon 在 chcon 很麻烦但 ymmv 的情况下会很有帮助。

* * *

## 回答 #7

> 赞同：2
> 
> 时间：2008-09-18T23:06:36.847

SELinux 需要用户注意和手动授予权限，只要（哦，好吧）您没有某事的权限。许多人发现它妨碍了它并将其关闭。

在最近的版本中，SELinux 对用户更加友好，甚至有人谈到取消关闭或隐藏它的可能性，以便只有知识渊博的用户知道如何操作 - 并且假设只有用户才是真正理解结果。

对于 SELinux，存在先有鸡还是先有蛋的问题：为了始终拥有它，作为用户的您需要向开发人员报告问题，以便他们改进它。但是用户不喜欢在它改进之前使用它，如果没有多少用户使用它，它不会得到改进。

因此，默认情况下它处于打开状态，希望大多数人会使用它足够长的时间来报告至少一些问题，然后再将其关闭。

最后，这是你的决定：你是在寻找一个短期的解决方案，还是对软件的长期改进，这将导致有一天不再需要问这样的问题。

* * *

## 回答 #8

> 赞同：1
> 
> 时间：2008-09-19T00:09:22.000

I do not disable it, but there are some problems.

Some applications don't work particularly well with it.

For example, I believe I enabled smartd to try and keep track of my raid disks s.m.a.r.t. status, but selinux would get confused about the new `/dev/sda*` nodes created at boot (I think that's what the problem was)

You have to download the source to the rules to understand things.

Just check `/var/log/messages` for the "avc denied" messages and you can decode what is being denied.

google "selinux faq" and you'll find a fedora selinux faq that will tell you how to work through these problems.

* * *

## 回答 #9

> 赞同：1
> 
> 时间：2008-09-18T23:05:23.997

我在这里没有太多贡献，但由于它没有得到答复，我想我会投入两分钱。

就个人而言，我在开发盒上以及在处理不重要的事情时禁用它。当我处理任何生产或需要更好的安全性时，我会保留它和/或花时间调整它以处理我需要的事情。

天气是否使用它真的取决于您的需求，但它的创建是有原因的，所以考虑使用它而不是总是关闭它。

* * *

## 回答 #10

> 赞同：1
> 
> 时间：2011-08-10T04:08:09.443

我在我所有的 cPanel 盒子上都关闭了它，因为 cPanel 不会在它打开的情况下运行。

* * *

## 回答 #11

> 赞同：1
> 
> 时间：2010-05-26T02:53:03.660

是的。脑残了 它可能会破坏几乎无法诊断的标准守护程序。它也可以关闭一扇门，但打开一扇窗户。也就是说，由于某种原因，在新安装的 CentOS 上，它阻止了 smbd 从“/etc/init.d/smb”开始。但它并没有阻止它在以“sh /etc/init.d/smb”或“smbd -D”调用时启动，或者将init.d/smb文件移动到另一个目录，它将从该目录启动smbd美好的。

因此，无论它认为它正在做什么来保护我们的系统——通过破坏它们——它甚至都没有始终如一地做。咨询了一些严肃的 CentOS 大师，他们也不了解其行为的不一致之处。它旨在让您感到安全。但这是安全的表象。它可以替代锁定系统安全性的实际工作。

* * *

## 回答 #12

> 赞同：0
> 
> 时间：2009-08-10T12:08:46.110

我从未禁用 selinux，我的承包商必须使用它。而且，如果/何时，某些守护进程（顺便说一句，具有 OSS 许可证）没有安全策略，则必须编写一个（好的）安全策略。这不是因为我相信 selinux 在 Linux 上是一个无懈可击的 MAC——举例来说毫无用处——而是因为它无论如何都增强了操作系统的安全性。对于 web 应用程序，OSS 安全性更好的解决方案是 mod_security ：所以我两者都使用。selinux 的大多数问题都出在很少或易于理解的文档上，尽管近年来情况有了很大改善。

* * *

## 回答 #13

> 赞同：0
> 
> 时间：2010-05-26T03:00:54.517

我作为开发机器使用的 CENTOS 盒子打开了它，我把它关掉了。它阻止了我在测试我正在开发的网络应用程序时尝试做的一些事情。该系统（当然）位于防火墙后面，该防火墙完全阻止了来自我们 LAN 外部的访问，并且具有许多其他安全措施，因此即使关闭 SELinux，我也感到相当安全。

* * *

## 回答 #14

> 赞同：-1
> 
> 时间：2008-09-19T14:07:45.410

在 Red-hat 下，您可以编辑`/etc/sysconfig/selinux`和设置`SELINIX=disabled`.

我认为在所有版本的 Linux 下，您都可以`selinux=0 noselinux`在 lilo.conf 或 grub.conf 中添加引导行。

* * *

## 回答 #15

> 赞同：-1
> 
> 时间：2010-05-26T02:56:32.740

如果默认情况下它是打开的，我会一直打开它，直到它破坏某些东西然后关闭它。

就我个人而言，我认为它没有提供任何安全性，我不会为此烦恼。

# .net - WAS 托管与 Windows 服务托管

> ID：97830
> 
> 赞同：7
> 
> 时间：2008-09-18T22:58:27.040
> 
> 标签：.net, wcf, iis-7

我正在为一些内部服务使用 Windows 2008、.NET 3.5 和 WCF 进行项目，并且出现了如何托管服务的问题。

由于我们使用的是 Windows 2008，因此我认为利用 Windows Process Activation Service (WAS) 会很好，尽管对项目的感觉似乎是使用 Windows 服务会更好。

那么与 Windows 服务相比，使用 WAS 托管 WCF 服务有什么不足之处呢？使用 Windows 服务是否有任何真正的优势，或者是要走的路？

* * *

## 回答 #1

> 赞同：11
> 
> 时间：2008-09-19T00:10:48.830

最近我不得不回答非常相似的问题，这就是我决定使用 IIS 7.0 和 WAS 而不是 Windows 服务基础架构的原因。

1.  IIS 7.0 是更强大的主机，它具有许多使调试变得容易的功能。失败的请求跟踪、工作进程回收、进程孤立等等。
2.  IIS 7.0 为您提供了更多选项来指定工作进程在某些情况下应该发生什么。
3.  如果您在 IIS 下托管您的服务，则在第一个请求之前它没有分配工作进程。从我的角度来看，这是一种理想的行为，但在您的情况下可能会有所不同。Windows 服务使您能够以更确定的方式启动服务。
4.  根据我的经验，WAS 本身并不能提供更高的可靠性。它的最大优势在于它将 IIS 的丰富性暴露给使用不同于 HTTP 的协议的应用程序。我的意思是：TCP、命名管道和 MSMQ。
5.  我知道使用 WAS 的唯一缺点是您的服务所暴露的地址需要符合某种模式。[此处](http://blogs.msdn.com/tomholl/archive/2008/07/12/msmq-wcf-and-iis-getting-them-to-play-nice-part-1.aspx)描述了 MSMQ 的情况

# windows-server-2003 - Windows Server 2003 NLB drainstop 停止通知

> ID：97833
> 
> 赞同：2
> 
> 时间：2008-09-18T22:58:34.463
> 
> 标签：windows-server-2003, load-balancing

我将如何通过命令行停止 MS NLB 中的一个节点，然后收到其完成的通知？

如果没有办法回调，有没有简单的轮询方法？

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2008-09-19T03:24:00.833

[http://technet.microsoft.com/en-us/library/cc772833.aspx](http://technet.microsoft.com/en-us/library/cc772833.aspx)拥有一切。

运行 drainstop 然后查询直到它被排空。

**nlb 查询*yourServer***

# asp.net - 如何在专用服务器中使用 IIS6 SMTP 从 ASP.NET 发送邮件？

> ID：97840
> 
> 赞同：4
> 
> 时间：2008-09-18T23:00:07.487
> 
> 标签：asp.net, iis, smtp

我正在尝试配置一个运行 ASP.NET 的专用服务器，以通过本地 IIS SMTP 服务器发送邮件，但邮件卡在 Queue 文件夹中并且无法传递。

我在 .aspx 页面中使用此代码进行测试：

```
<%@ Page Language="C#" AutoEventWireup="true" %>

<% new System.Net.Mail.SmtpClient("localhost").Send("info@thedomain.com", 
    "jcarrascal@gmail.com", "testing...", "Hello, world.com"); %> 
```

然后，我将以下内容添加到 Web.config 文件中：

```
<system.net>
  <mailSettings>
    <smtp>
      <network host="localhost"/>
    </smtp>
  </mailSettings>
</system.net> 
```

在 IIS 管理器中，我在“默认 SMTP 虚拟服务器”的属性中更改了以下内容。

```
General: [X] Enable Logging
Access / Authentication: [X] Windows Integrated Authentication
Access / Relay Restrictions: (o) Only the list below, Granted 127.0.0.1
Delivery / Advanced: Fully qualified domain name = thedomain.com 
```

最后，我像这样运行 SMTPDiag.exe 工具：

```
C:\>smtpdiag.exe info@thedomain.com jcarrascal@gmail.com

Searching for Exchange external DNS settings.
Computer name is THEDOMAIN.
Failed to connect to the domain controller. Error: 8007054b

Checking SOA for gmail.com.
Checking external DNS servers.
Checking internal DNS servers.
SOA serial number match: Passed.

Checking local domain records.
Checking MX records using TCP: thedomain.com.
Checking MX records using UDP: thedomain.com.
Both TCP and UDP queries succeeded. Local DNS test passed.

Checking remote domain records.
Checking MX records using TCP: gmail.com.
Checking MX records using UDP: gmail.com.
Both TCP and UDP queries succeeded. Remote DNS test passed.

Checking MX servers listed for jcarrascal@gmail.com.
Connecting to gmail-smtp-in.l.google.com [209.85.199.27] on port 25.
Connecting to the server failed. Error: 10060
Failed to submit mail to gmail-smtp-in.l.google.com.
Connecting to gmail-smtp-in.l.google.com [209.85.199.114] on port 25.
Connecting to the server failed. Error: 10060
Failed to submit mail to gmail-smtp-in.l.google.com.
Connecting to alt2.gmail-smtp-in.l.google.com [209.85.135.27] on port 25.
Connecting to the server failed. Error: 10060
Failed to submit mail to alt2.gmail-smtp-in.l.google.com.
Connecting to alt2.gmail-smtp-in.l.google.com [209.85.135.114] on port 25.
Connecting to the server failed. Error: 10060
Failed to submit mail to alt2.gmail-smtp-in.l.google.com.
Connecting to alt1.gmail-smtp-in.l.google.com [209.85.133.27] on port 25.
Connecting to the server failed. Error: 10060
Failed to submit mail to alt1.gmail-smtp-in.l.google.com.
Connecting to alt2.gmail-smtp-in.l.google.com [74.125.79.27] on port 25.
Connecting to the server failed. Error: 10060
Failed to submit mail to alt2.gmail-smtp-in.l.google.com.
Connecting to alt2.gmail-smtp-in.l.google.com [74.125.79.114] on port 25.
Connecting to the server failed. Error: 10060
Failed to submit mail to alt2.gmail-smtp-in.l.google.com.
Connecting to alt1.gmail-smtp-in.l.google.com [209.85.133.114] on port 25.
Connecting to the server failed. Error: 10060
Failed to submit mail to alt1.gmail-smtp-in.l.google.com.
Connecting to gsmtp183.google.com [64.233.183.27] on port 25.
Connecting to the server failed. Error: 10060
Failed to submit mail to gsmtp183.google.com.
Connecting to gsmtp147.google.com [209.85.147.27] on port 25.
Connecting to the server failed. Error: 10051
Failed to submit mail to gsmtp147.google.com. 
```

我正在使用 ASP.NET 2.0、Windows 2003 Server 和它附带的 IIS。

你能告诉我还有什么可以改变来解决这个问题吗？

谢谢

* * *

@mattlant

这是一个专用服务器，这就是我手动安装 SMTP 的原因。

> 编辑：我使用交换，所以它有点不同，但它被称为交换智能主机，但在普通的 SMTP 服务配置中，我认为它叫做别的东西。不记得确切的设置名称。

感谢您将我指向智能主机领域。邮件现在正在送达。

在“默认 SMTP 虚拟服务器”属性的“传递”选项卡中，单击“高级”并在“智能主机”字段中填写您的提供商为您提供的地址。就我而言（GoDaddy），它是 k2smtpout.secureserver.net。

更多信息在这里：[http ://help.godaddy.com/article/1283](http://help.godaddy.com/article/1283)

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2008-09-18T23:05:58.457

我发现最好的办法通常取决于有多少电子邮件，就是通过您的 ISP 的 SMTP 服务器转发邮件。少头痛。看起来这就是您遇到问题的地方，从您的 SMTP 到外部服务器，而不是从 asp.net 到您的 SMTP。

只需将您的 SMTP 服务器设置为将其发送到您的 ISP，或者您可以将 asp.net 配置为发送到它。

编辑：我使用交换，所以它有点不同，但它被称为交换智能主机，但在普通的 SMTP 服务配置中，我认为它被称为其他东西。

我不记得确切的设置名称。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2008-09-18T23:14:44.083

从外观上看，您的防火墙并没有让 SMTP（TCP 端口 25）离开您的网络。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2008-09-18T23:15:05.657

两个非常明显的问题（以防万一他们没有被覆盖） 1\. Windows 防火墙是否被禁用？2\. 您是否有阻止您的邮件发送的个人/公司防火墙？

# windows - 2GB USB 驱动器上的版本控制

> ID：97850
> 
> 赞同：43
> 
> 时间：2008-09-18T23:05:12.827
> 
> 标签：windows, version-control, usb-drive

对于我的学校工作，我做了很多切换计算机（从实验室到我的笔记本电脑再到图书馆）。我有点想将此代码置于某种版本控制之下。当然，问题是我不能总是在我使用的计算机上安装额外的软件。是否有任何类型的版本控制系统可以保存在拇指驱动器上？我有一个 2GB 的驱动器来安装它，但如果需要，我可以买一个更大的驱动器。

我正在做的项目并不是特别大，仅供参考。

**编辑：** 这需要在 Windows 下工作。

**编辑二：** 集市最终成为我选择的。如果您使用 TortoiseBzr，那就更好了。

* * *

## 回答 #1

> 赞同：21
> 
> 时间：2008-09-18T23:14:42.913

我用 Git 做这个。只需为您的目录创建一个 Git 存储库：

```
git-init
git add .
git commit -m "Done" 
```

插入棒，cd 到它上面的目录（我有一个用 -o 循环挂载的大 ext2 文件），然后执行：

```
git-clone --bare /path/to/my/dir 
```

然后，我把棍子带到其他电脑（家里等）。我可以直接在棒上工作，或者再次克隆。转到硬盘上的某个目录，然后：

```
git-clone /path/to/stick/repos 
```

当我完成更改后，我会“git push”返回到棒，当我回到工作岗位时，我再次“git push”将更改从棒移动到工作计算机。设置完成后，您可以使用 'git pull' 仅获取更改（您不再需要克隆，只是第一次）和 'git push' 以另一种方式推送更改。

这样做的美妙之处在于，您可以使用“git log”查看所有更改，甚至在两个地方同时发生更改时保持一些不相关的工作同步。

如果您不喜欢命令行，可以使用 gitk 和 git-gui 等图形工具。

* * *

## 回答 #2

> 赞同：18
> 
> 时间：2008-09-18T23:21:19.933

[Darcs](http://darcs.net)非常适合这个目的。

*   我不能保证其他平台，但在 Windows 上它只是一个可以保存在驱动器上的可执行文件。
*   最重要的是，它的交互式命令行界面非常棒，并且很快变得直观（我现在真的很怀念任何缺少它们的 VCS 中的交互式提交）——作为正常工作流程的一部分，您也不需要记住许多命令。这是我在个人项目中使用它而不是 git 的主要原因。

配置：

```
darcs init
darcs add -r *
darcs record -am "Initial commit" 
```

在您的实验室机器上创建存储库：

```
darcs get E:\path\to\repos 
```

检查您所做的更改：

```
darcs whatsnew      # Show all changed hunks of code
darcs whatsnew -ls  # List all modified & new files 
```

从您的更改中以交互方式创建新补丁：

```
darcs record 
```

以交互方式将补丁推送到驱动器上的存储库：

```
darcs push 
```

众所周知，它对于大型项目来说很慢，但我在使用它的中小型个人项目中从未遇到任何性能问题。

由于不需要安装，您甚至可以省去驱动器，只需从网络上获取 darcs 二进制文件 - 如果我忘记了驱动器，我会从我保留在我的网络空间中的镜像中提取我想要处理的存储库的副本，然后创建补丁并将其作为文件通过电子邮件发送给我自己：

```
darcs get http://example.com/repos/forum/
# Make changes and record patches
darcs send -o C:\changes.patch 
```

* * *

## 回答 #3

> 赞同：13
> 
> 时间：2008-09-18T23:13:00.030

您可以使用[Portable Python](http://www.portablepython.com/)和[Bazaar](http://bazaar-vcs.org/)（Bazaar 是一个 Python 应用程序）。我喜欢将 Bazaar 用于我自己的个人项目，因为它非常简单。另外，它可以移植，因为 Python 可以移植。你只需要在你的 Portable Python 安装中安装它的依赖项。

* * *

## 回答 #4

> 赞同：10
> 
> 时间：2008-09-18T23:10:10.257

对你来说最好的答案是某种 DVCS（流行的是[Git](http://git.or.cz)、[Mercurial](http://www.selenic.com/mercurial/wiki/)、[Darcs](http://darcs.net/)、[Bazaar](http://bazaar-vcs.org/) ...）。原因是您在使用的任何机器上都拥有整个存储库的完整副本。我个人没有使用过这些系统，所以其他人最好推荐一个占用空间小、跨平台兼容性好的 DVCS。

* * *

## 回答 #5

> 赞同：8
> 
> 时间：2008-09-18T23:10:40.520

我会使用[git](http://git.or.cz)。Git 存储库非常小，不需要守护程序。您可能可以在闪存驱动器上安装[cygwin](http://www.cygwin.com/)或[msysgit](http://code.google.com/p/msysgit/)。

编辑：[这里有一些关于在闪存驱动器上安装 cygwin 的说明](http://www.dam.brown.edu/people/sezer/software/cygwin/)

* * *

## 回答 #6

> 赞同：5
> 
> 时间：2009-02-24T11:25:44.853

只是为了在 Stick 上添加额外的资源[Subversion](http://dotnet.org.za/trumpi/archive/2006/12/13/Subversion-on-a-stick.aspx)。我刚刚在我的 4GB USB 驱动器上进行了设置，非常简单且无痛。

以为我现在很想尝试 Bazaar。

更新：我已经在我的 USB 驱动器上设置了 PortablePython，很简单，但是在那里得到了集市……我放弃了，一个接一个地依赖，因为我已经 svn 工作了。
如果有人知道一个简单的便携式安装程序，我会很高兴。

* * *

## 回答 #7

> 赞同：4
> 
> 时间：2010-01-08T20:17:01.000

我推荐 Fossil [http://www.fossil-scm.org/](http://www.fossil-scm.org/)

包括

*   命令行
*   dvcs
*   跨平台（且易于编译）
*   'autosync' 命令使同步到备份的基本任务变得容易。
*   备份服务器配置是轻而易举的事。
*   易于学习/使用
*   非常有帮助的社区
*   包含 wiki 和 bugtracker 的 web ui。
*   3.5Mb，单个可执行文件
*   一个 sqlite 数据库作为存储库

* * *

## 回答 #8

> 赞同：3
> 
> 时间：2008-09-18T23:13:10.047

你可以把颠覆二进制文件放在那里——它们只有 16 兆，所以你也有足够的空间来存放一些存储库。您可以从命令行使用官方二进制文件，或将图形工具（如[TortoiseSVN](http://tortoisesvn.tigris.org/)）指向存储库目录。如果您喜欢，那么您可以安装驱动器以自动运行 SVNSERVE 应用程序，在您插入驱动器的那一刻，将任何计算机变成轻量级颠覆服务器。

[我在这里](http://dotnet.org.za/trumpi/archive/2006/12/13/Subversion-on-a-stick.aspx)找到了有关此过程的一些说明。

* * *

## 回答 #9

> 赞同：3
> 
> 时间：2008-09-18T23:33:12.587

我在我的拇指驱动器上使用颠覆，官方二进制文件将在驱动器上运行。这个技巧的问题是您需要访问命令行才能使其工作或能够运行批处理文件。当然，我将拇指驱动器上的文件同步到我付费的服务器。如果您不想在网络上获得托管空间，您可以始终将存储库托管在桌面上（使用 file:/// 协议）。

* * *

## 回答 #10

> 赞同：3
> 
> 时间：2008-09-18T23:56:21.783

我会因为说出这个答案而被处以私刑，但它在 Windows 下有效：[RCS](http://www.cs.purdue.edu/homes/trinkle/RCS/)。

您只需`RCS`使用您的代码在每个目录中创建一个目录。到了办理入住手续的时候，`ci -u $FILE`. （二进制文件还要求您`rcs -i -kb $FILE`在第一次签入之前运行。）

如果您希望有一天“升级”到那个目录（并从那里升级到其他海报提到的任何其他 VCS 系统），目录中有一堆文件，它们与 CVS兼容`RCS`。`,v`:-)

* * *

## 回答 #11

> 赞同：1
> 
> 时间：2008-09-18T23:16:26.030

颠覆会有点工作。见[线程](http://svn.haxx.se/users/archive-2006-08/1016.shtml)

就个人而言，我更喜欢将所有内容保存在一台机器上，并将远程桌面保存在其中。

* * *

## 回答 #12

> 赞同：1
> 
> 时间：2009-02-24T11:30:30.863

在我看来，闪存和版本控制似乎不是一个好主意。恐怕内存很快就会用完，特别是如果您广泛使用各种版本控制操作，这些操作会进行许多小磁盘操作（合并、来回恢复等）。

至少，请确保尽可能多地备份存储库，以防驱动器发生故障。

* * *

## 回答 #13

> 赞同：1
> 
> 时间：2011-02-15T09:23:35.947

根据 Milan Babuškov 的回答，我正在使用 GIT：

(1) 创建存储库并提交（在办公室 PC 上）

mkdir /home/yoda/project && cd /home/yoda/project

混帐初始化

混帐添加。

git commit -m "完成"

(2) 插入 U 盘并克隆存储库

猫/proc/partitions

mount -t ext3 /dev/sdc1 /mnt/usb

git clone --bare /home/yoda/project /mnt/usb/project

(3) 把U盘带回家，在家里做一个仓库的克隆

猫/proc/partitions

mount -t ext3 /dev/sdc1 /mnt/usb

git clone /mnt/usb/project /home/yoda/project

(4) 将提交从家用 PC 推送回 U 盘

mount -t ext3 /dev/sdc1 /mnt/usb

cd /home/yoda/项目

git 推送

(5) 将 U 盘带到办公室并将提交从 U 盘推送到办公室 PC

mount -t ext3 /dev/sdc1 /mnt/usb

cd /mnt/usb/项目

git 推送

(6) 从办公室 PC 拉取提交到 U 盘

mount -t ext3 /dev/sdc1 /mnt/usb

cd /mnt/usb/项目

git 拉

(7) 从 U 盘拉取提交到家用 PC

mount -t ext3 /dev/sdc1 /mnt/usb

cd /home/yoda/项目

git 拉

* * *

## 回答 #14

> 赞同：0
> 
> 时间：2008-09-21T22:13:06.677

bitnami stack subversion 很容易安装。您也可以尝试使用portableapps.com 和subversion 安装xampp。

# sockets - 将时间与机器之间的毫秒精度和精度同步的最佳方法是什么？

> ID：97853
> 
> 赞同：32
> 
> 时间：2008-09-18T23:05:34.603
> 
> 标签：sockets, synchronization, gps, time-management

据我了解，PC 上的晶体因时钟偏差而臭名昭著。如果时钟总是倾斜，那么以毫秒精度和精度在机器之间同步时钟的最佳方法是什么？根据我的发现，NTP 和 PTP 是可能的解决方案，但我想知道是否有人对 stackoverflow.com 有任何经验！

我知道 NTP 是流行的选择，但我想知道是否有人对 PTP (IEEE1588) 有任何经验

* * *

## 回答 #1

> 赞同：17
> 
> 时间：2008-09-18T23:08:43.973

只需运行标准的 NTP 守护程序。

它确实具有从多个 GPS 设备获取输入以及与网络服务器通信的选项。

编辑：我指的是[http://www.ntp.org/](http://www.ntp.org/)，而不是 Windows 附带的那个。

对于什么 NTP 客户端最适合 Windows，我没有任何建议，但对于 Unix 机器，没有真正的理由不运行 NTP。

* * *

## 回答 #2

> 赞同：15
> 
> 时间：2015-03-09T16:44:54.637

这是一些有 15 年历史的软件，可以在**百分之**一毫秒内同步。（当 NTP 对我们的实验室来说不够好时，我的团队编写了它。）

来自会议论文的[摘要](http://scholar.google.com/citations?view_op=view_citation&citation_for_view=QmbeOvsAAAAJ:5nxA0vEk-isC)：“用于联网商品 PC 的分布式时钟。在没有额外硬件的情况下，该时钟将来自多台 PC 的传感器数据与平均低于 10 微秒（最坏情况下为 100 微秒）的延迟和抖动相关联。”

源代码：[https](https://github.com/camilleg/clockkit)
://github.com/camilleg/clockkit （直到 2020 年 2 月 13 日在[http://zx81.isl.uiuc.edu/clockkit/](http://zx81.isl.uiuc.edu/clockkit/)，现在离线。）

* * *

## 回答 #3

> 赞同：9
> 
> 时间：2008-09-18T23:17:35.840

您无法通过交换数据将机器同步到毫秒级别，因为任何数据交换本身已经至少需要毫秒才能发生，因此会破坏您的结果！即使是尝试首先测量数据传输需要多长时间然后发送时间信息（考虑到测量的延迟）的协议也比平均水平好一点，但它们仍然不好，因为并非每次数据传输都需要相同的时间（只是不断地 ping Internet 上的服务器，看看每个 ping 有不同的延迟）。

在毫秒范围内真正同步两台计算机的唯一方法是让它们都通过没有未知或不断变化的延迟的传输方法从同一源获取时间。例如，如果两者都接收到卫星信号，则广播时间。信号将始终具有恒定的延迟（从卫星到地球），并且它们几乎都在相同的纳秒内接收到它。

例如，德国有无线电控制时间。在这个国家的某个地方有一个原子钟（几百年来它的时间精确到纳秒），一些发送者在全国范围内以给定的频率永久广播当前时间。存在可以接收此时间并与之永久同步的闹钟甚至手表（嗯，并非真正永久，大多数型号每 24 小时只执行一次以节省电池运行时间）。此类接收器设备也适用于计算机，并附带可以使您的计算机时钟与该时间信号永久同步的软件。

据我所知，GPS 也发送时间信息（或者可以从 GPS 信息中以某种方式计算时间，我对 GPS 协议不太熟悉）。因此，将 GPS 接收器连接到两台计算机可能也可以使它们同步到毫秒。但是，如果您的同步是通过 Internet 完成的，则不要期望比一台计算机最多关闭 20 毫秒的同步效果更好。

要更新评论者，
NTP 并不像人们喜欢在这里声称的那样准确：

> NTP在公共互联网上通常可以将时间保持**在几十毫秒以内，**在理想条件下在局域网中可以达到优于一毫秒的精度。

资料来源：[维基百科](https://en.wikipedia.org/wiki/Network_Time_Protocol)

我宁愿在不涉及任何网络的情况下使它们保持同步，并进一步使它们与官方 GMT 时间保持同步，在这里 GPS 可能是在所有机器上获得真正准确结果的唯一方法（实际上，这不仅限于毫秒低至微秒）。

* * *

## 回答 #4

> 赞同：3
> 
> 时间：2008-09-18T23:13:58.420

我在公司的整个网络中都使用 NTP，它运行良好。关键是在本地网络上拥有一个权威服务器，并让网络上的每台机器与之同步。最好的办法是在该服务器上安装一个无线电时钟。NTP 很棒，因为它不只是偶尔校正时钟，而且它实际上会计算和校正时钟频率，使其更加准确。

一旦我在网络上设置了 NTP，我就打开了到不同服务器的五个 VNC 会话并坐在那里看时钟。所有服务器上的时钟都以毫秒为单位同步，这是在设置之后。它在运行时变得更加准确。

* * *

## 回答 #5

> 赞同：2
> 
> 时间：2008-09-18T23:15:59.510

基于 NTP 或 SNTP 的解决方案可以很好地工作，但这很大程度上取决于客户端实现的好坏。

当然，如果你想要亚秒级的精度，这个问题的答案是***不要***使用默认的 Windows 时间服务。众所周知，它在机器上保持稳定的时基方面很差，并且通常会超调校正，甚至几乎是不稳定的，尤其是当机器开始时的时基相当不准确时——这很常见。假设 Window 工具中内置的标准可以在所有机器之间可靠地保持准确度，通常只有几秒钟，我通常会看到机器之间的波动高达 30 秒——即使你调整了注册表设置。

免费软件工具[Achron](http://oneguycoding.com/pub/)是一个很好的解决方案，可以降低到正负 500 毫秒的范围。做得更好将需要更具工业实力的解决方案，例如[Greyware的解决方案](http://www.greyware.com/software/domaintime/instructions/misc/agent/)

* * *

## 回答 #6

> 赞同：2
> 
> 时间：2016-02-26T01:27:49.237

我最近对这个主题进行了研究（阅读谷歌搜索），这是我到目前为止所学到的：

*   要获得毫秒精度（或更好），您需要硬件支持。PTP 中的 GPS 源或硬件时间戳（以及良好的时间源）。

*   PTP 中的硬件时间戳是使用受支持的 NIC 完成的 - 英特尔拥有它们。

*   如果没有硬件时间戳，NTP 和 PTP 之间的准确性是相似的。

*   （以前没有使用过 PTP）我读到 NTP 更容易设置。

*   我对 GPS 时间源（串行）的有限经验各不相同。如果你能让它工作，那就太好了，但是我们在数据中心有一个设备，我从来没有设法让它工作......

*   如果您的机器在科罗拉多州，请询问您的 DC 他们可以提供什么 - 这样您就不必做出决定。:D

高温高压

* * *

## 回答 #7

> 赞同：1
> 
> 时间：2008-09-18T23:08:04.723

正如您已经建议的那样，NTP 是解决此问题的行业标准解决方案，但它需要 Internet 连接或第 0 层源（准确的硬件时钟，如具有计算机接口的 GPS 接收器）。

如果您使用 Internet 连接，请考虑使用[NTP 池](http://www.pool.ntp.org/)。

* * *

## 回答 #8

> 赞同：1
> 
> 时间：2008-09-18T23:08:02.430

NTP绝对是要走的路。基本上是一劳永逸，只要你让它离开本地主机（通常是防火墙或路由器机器）上的防火墙。

* * *

## 回答 #9

> 赞同：1
> 
> 时间：2008-09-19T00:58:36.017

还要记住，硬件系统时钟（即不准确的时钟）仅在机器启动时读取 - 如果您谈论的是服务器机器，您不会因为它们而浪费时间。

# xml - 现有 XML 文件是否有 XML XQuery 接口？

> ID：97856
> 
> 赞同：2
> 
> 时间：2008-09-18T23:06:05.460
> 
> 标签：xml, xquery

我的公司从事教育行业，我们使用 XML 来存储课程内容。我们还将一些课程相关信息（主要是元信息）存储在关系数据库中。现在我们正在从我们专有的 XML Schema 切换到 DocBook 5。随着切换，我们希望将课程相关信息从数据库移动到 XML 文件。这样做的原因是将所有课程数据放在一个地方并将其放在 Subversion 下。但是，我们希望保持关系数据库的灵活性，并能够轻松地从 XML 文档中提取有关课程的特定信息。XQuery 似乎可以胜任这项任务，所以我正在研究支持它的数据库，但到目前为止找不到我需要的东西。我基本上想要的，是将我的 XML 文件放在某个目录结构中，然后在此之上，我希望有一个系统可以索引我的文件并让我使用 XQuery 从任何文件中选择任何内容。这样我就可以拥有“我的蛋糕也可以吃”：我将拥有 XQuery 界面，并且仍然将我的文件保存为纯文本和版本。那里有什么东西至少与我想要的东西很相似吗？

如果您认为我的要求是胡说八道，请提出替代建议。

关于相关说明：您有哪些 XML 数据库（最好是原生的和开源的）的经验，您会推荐什么？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2008-09-18T23:16:36.310

看看[exist](http://exist.sourceforge.net/)，它是一个支持XQuery 的开源xml 数据库。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2008-09-20T07:36:00.210

对于 am Native XML 数据库，您可以尝试[Berkeley XMLDB](http://www.oracle.com/technology/products/berkeley-db/xml/index.html)，它由 Oracle 维护，但是是开源的。

如果您想要一个真正强大的解决方案，您可以使用[MarkLogic Xml Server](http://www.marklogic.com/product/marklogic-server.html?PHPSESSID=td4pr92mgsp566bn220msha8s7)。这是有代价的。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2008-09-26T09:06:34.217

我不知道有任何 XQuery 实现既可以索引您的文档，又可以将它们留在文件系统中。

但是如果您有少量数据，您可以使用文件系统并使用[Saxon](http://www.saxonica.com/)作为您的 XQuery 实现来查询文档。Saxon 可以[将任何目录视为一个“集合”](http://saxonica.com/documentation/sourcedocs/collections.html "撒克逊收藏")（以一种非常灵活的方式），这意味着您可以同时查询一堆文档。

如果您的数据量适中（并且文件系统方法太慢），那么[eXist](http://exist.sourceforge.net/)是我使用过的一个很好的开源选项。一个优点是它具有 WebDAV 界面，这意味着编辑文件并将它们视为另一个目录非常容易。eXist 有一个[历史触发器](http://exist-db.org/triggers.html#N102B2)，它会在文档被替换时存储旧版本的文档；我没有使用过它，但您也许可以围绕它构建一些东西，从而为您提供所需的版本控制。也可以将 eXist 数据库备份到文件中，然后使用 Subversion 进行版本控制。

如果您有大量数据或 eXist 不够健壮，那么[MarkLogic Server](http://www.marklogic.com/product/marklogic-server.html)是领先的商业 XML 数据库，我相信它对内部版本控制有一些支持。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2008-11-04T19:35:13.113

在过去的一年中，我与 Berkeley XMLDB 合作了很多次，它的情况好坏参半。

优点：FAST、xquery 和 xupdate，oracle 维护良好，许多语言都有接口、小印记、嵌入式、基于文件（也许有些人认为这是一个骗局？），对于一些邪恶的真棒查询非常灵活

缺点：如果您正在处理任何并发类型的情况，它会让人头疼，环境对于任何关系数据库的人来说都是一个奇怪的概念，通常非常敏感，如果不满意，往往会出现段错误

同意另一张海报 - 去一个更强大的情况是一个很大的成本，通常是速度。如果我要尝试其他任何东西，它会存在，但我被 java 打包的开销吓倒了。

从概念上讲，xmldbs 非常难，只是它的实现有些不成熟，缺乏竞争，缺乏行业知识。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2010-04-12T18:21:02.610

MarkLogic Xml 数据库服务器 (4.x) 有几个您可以尝试的好功能。

1.  它有一个很好的原生 Xquery 实现，您可以查询您的 xml 文档。

2.  它有一个内置的搜索引擎/搜索解析器和一个 XQuery 扩展，可以快速索引您的文档。

3.  它有一个简单的基于 REST 的协议支持，可以与外部系统对话并运行。

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2010-11-30T17:17:16.693

MarkLogic 发布了带有 XSLT 的 v4.2，这对于 XML 转换非常方便。好的部分是在这个版本中，您可以混合使用 XQuery 和 XSLT 代码以获得两全其美的效果。

# sql-server - 存储过程中适当范围的事务

> ID：97857
> 
> 赞同：4
> 
> 时间：2008-09-18T23:06:17.067
> 
> 标签：sql-server, stored-procedures, transactions, scope

假设我有一个管理自己的事务的存储过程

```
CREATE PROCEDURE theProc
AS
BEGIN

  BEGIN TRANSACTION

-- do some stuff

  IF @ThereIsAProblem
    ROLLBACK TRANSACTION
  ELSE
    COMMIT TRANSACTION
END 
```

如果我从现有事务中调用此 proc，则 proc 可以回滚外部事务。

```
BEGIN TRANSACTION
EXEC theProc
COMMIT TRANSACTION 
```

如何在存储过程中正确确定事务的范围，以便存储过程不回滚外部事务？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2008-09-18T23:18:47.257

执行此操作的语法可能因数据库而异。但在 Transact-SQL 中，您所做的是检查 @@TRANCOUNT 以查看您是否处于事务中。如果你是，那么你想创建一个保存点，最后你可以通过函数的末尾（相信稍后会发生提交或回滚）或者回滚到你的保存点。

有关更多信息，请参阅 Microsoft 关于[保存点](http://msdn.microsoft.com/en-us/library/ms188378.aspx)的文档。

对保存点的支持相当广泛，但我认为发现您当前处于事务中的机制（假设有一个）会有很大差异。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2008-09-18T23:16:25.187

输入时使用@@trancount 查看您是否已经在事务中

# mobile - 从移动浏览器获取位置数据

> ID：97865
> 
> 赞同：11
> 
> 时间：2008-09-18T23:06:41.747
> 
> 标签：mobile, gps

我正在开发一个经常被移动浏览器访问的网络应用程序。我想知道是否有一种方法可以从浏览器请求中获取足够的信息来查找位置数据（三角测量或 GPS）**，当然不是直接从请求中获取。**一位同事建议，一些运营商在请求标头中提供了一个唯一标识符，该标识符可以发送到由所述提供商公开的 Web 服务，如果客户启用，该服务将返回位置数据。任何人都可以为这个或任何其他收集位置数据的方法指出正确的方向，甚至是非常近似的。显然这是应用程序糖果，例如，如果数据不可用，应用程序并不真正关心......

或者也许是运营商的网络服务，将通过 IP 提供三角数据？

* * *

## 回答 #1

> 赞同：11
> 
> 时间：2008-09-19T07:20:00.313

Google 将[ClientLocation](http://code.google.com/apis/ajax/documentation/#ClientLocation)作为其 AJAX API 的一部分。您需要加载 Google 的 AJAX API（需要 API 密钥），它会尝试为您解析用户的位置数据。

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2009-02-06T15:28:20.717

我有黑莓 gps 到 javascript 在 GMaps 混搭中工作正常。其实很简单。 [http://www.saefern.org/tickets/test4.php](http://www.saefern.org/tickets/test4.php) - 帮助你自己查看源代码。

（我目前没有 bb。一位用户给我发电子邮件“......它似乎每 15 秒左右轮询一次，所以它不断添加新位置......”。）

我正在寻找 iPhone 等效的 javascript gps 信息。还有诺基亚，还有……

任何信息表示赞赏。

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2011-07-29T17:31:08.210

我已经成功使用了这个 javascript 库：

[http://code.google.com/p/geo-location-javascript/](http://code.google.com/p/geo-location-javascript/)

这些示例效果很好。总是会提示用户分享他们的位置——不知道如何避免这种情况。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2008-09-18T23:42:40.613

使用源 IP 地址来估计网络位置。不，您不会在来自 iPhone 的 HTTP 请求中获得纬度和经度。除非您编写一个 3rd 方应用程序并要求他们运行它。

您最好只在您的网站上进行民意调查。

* * *

## 回答 #5

> 赞同：-2
> 
> 时间：2008-09-19T01:38:27.747

我知道日本的一些供应商提供手机位置跟踪服务。我也知道这些信息是不公开的。我认为在提供商免费提供该信息之前，您需要有充分的理由，因为在我看来，这是敏感的个人数据。当然，他们会将信息提供给警察，但不会提供给公众。

# windows - Windows 的“rm -rf”等效项？

> ID：97875
> 
> 赞同：616
> 
> 时间：2008-09-18T23:08:29.120
> 
> 标签：windows, cmd, wsh

我需要一种递归删除文件夹及其子文件夹的方法。

是否有为此预先构建的工具，还是我需要编写一个？

`DEL /S`不删除目录。

`DELTREE`已从 Windows 2000+ 中删除

* * *

## 回答 #1

> 赞同：848
> 
> 时间：2008-09-18T23:11:12.423

如果您使用的是经典命令提示符 (cmd.exe)，则为 RMDIR 或 RD：

```
rd /s /q "path" 
```

> RMDIR [/S] [/Q] [驱动器:]路径
> 
> RD [/S] [/Q] [驱动器:]路径
> 
> /S 除目录本身外，删除指定目录中的所有目录和文件。**用于删除目录树。**
> 
> /Q 安静模式，不询问是否可以用 /S 删除目录树

如果您使用的是 PowerShell，则可以使用`Remove-Item`（别名为`del`、`erase`、`rd`、`ri`和）并接受一个`rm`可以缩写为的参数`rmdir``-Recurse``-r`

```
rd -r "path" 
```

* * *

## 回答 #2

> 赞同：151
> 
> 时间：2008-09-18T23:41:07.967

行政：

```
takeown /r /f folder
cacls folder /c /G "ADMINNAME":F /T
rmdir /s folder 
```

适用于任何东西，包括 sys 文件

编辑：我实际上找到了解决文件路径太长问题的最佳方法：

```
mkdir \empty
robocopy /mir \empty folder 
```

* * *

## 回答 #3

> 赞同：128
> 
> 时间：2008-09-18T23:13:52.243

`RMDIR **[/S]** [/Q] [drive:]path`

`RD **[/S]** [/Q] [drive:]path`

*   **`/S`** 除目录本身外，删除指定目录中的所有目录和文件。 ***用于删除目录树。***

*   `/Q` 安静模式，不要询问是否可以删除目录树`/S`

* * *

## 回答 #4

> 赞同：23
> 
> 时间：2016-03-01T19:32:12.090

转到路径并触发此命令。

```
rd /s /q "FOLDER_NAME" 
```

/s ：删除指定目录和所有子目录，包括任何文件。使用 /s 删除一棵树。

/q ：以安静模式运行 rmdir。删除目录而不确认。

/？：在命令提示符处显示帮助。

* * *

## 回答 #5

> 赞同：20
> 
> 时间：2008-09-18T23:14:45.127

您可以安装 cygwin，它具有`rm`以及`ls`等。

* * *

## 回答 #6

> 赞同：15
> 
> 时间：2016-06-01T19:59:06.383

要删除目录（无论它是否存在），请使用以下命令：

```
if exist myfolder ( rmdir /s/q myfolder ) 
```

* * *

## 回答 #7

> 赞同：11
> 
> 时间：2019-03-01T15:27:33.947

公认的答案很好，但假设您安装了 Node，您可以使用允许通配模式的节点库“rimraf”更精确地做到这一点。如果您经常使用它（我经常使用），只需全局安装即可。

```
yarn global add rimraf 
```

然后，例如，我经常使用的模式：

```
rimraf .\**\node_modules 
```

或者对于让您避开全局安装的单线器，但对于包动态下载需要稍长的时间：

```
npx rimraf .\**\node_modules 
```

* * *

## 回答 #8

> 赞同：9
> 
> 时间：2020-09-04T17:20:22.550

```
rm -r -fo <path> 
```

是您可以在 Windows PowerShell 中获得的最接近的。它是的缩写

```
Remove-Item -Recurse -Force -Path <path> 
```

[（更多细节）](https://stackoverflow.com/a/61573240/11942268)。

* * *

## 回答 #9

> 赞同：8
> 
> 时间：2018-12-19T21:08:03.567

通过 Powershell

```
 Remove-Item -Recurse -Force "TestDirectory" 
```

通过命令提示符

[https://stackoverflow.com/a/35731786/439130](https://stackoverflow.com/a/35731786/439130)

* * *

## 回答 #10

> 赞同：6
> 
> 时间：2008-09-18T23:12:44.697

`rmdir /S /Q %DIRNAME%`

* * *

## 回答 #11

> 赞同：5
> 
> 时间：2008-09-18T23:11:01.737

试试这个命令：

```
del /s foldername 
```

* * *

## 回答 #12

> 赞同：4
> 
> 时间：2008-09-18T23:10:48.303

rmdir /s 目录名

* * *

## 回答 #13

> 赞同：4
> 
> 时间：2015-04-21T17:40:10.517

首先，让我们回顾一下是做什么的`rm -rf`：

```
C:\Users\ohnob\things>touch stuff.txt

C:\Users\ohnob\things>rm -rf stuff.txt

C:\Users\ohnob\things>mkdir stuff.txt

C:\Users\ohnob\things>rm -rf stuff.txt

C:\Users\ohnob\things>ls -l
total 0

C:\Users\ohnob\things>rm -rf stuff.txt 
```

`rm -rf`在预期返回的地方通常使用三种场景`0`：

1.  指定的路径不存在。
2.  指定的路径存在并且是一个目录。
3.  指定的路径存在并且是一个文件。

我将忽略整个权限的事情，但无论如何，没有人使用权限或试图拒绝自己对 Windows 中的事物的写入权限（好吧，那是个玩笑……）。

首先[设置`ERRORLEVEL`为0](https://superuser.com/a/649329/149378)，然后仅在存在时删除路径，根据是否为目录使用不同的命令。如果路径不存在，则`IF EXIST`不会设置为 0，因此必须首先将 设置为 0，以便以模仿正常使用的方式正确检测成功。保护with是必要的，因为与 不同，如果目标不存在会抛出错误。`ERRORLEVEL``ERRORLEVEL``rm -rf``RD``IF EXIST``RD``rm -f`

以下脚本片段假定 DELPATH 已预先引用。（当你做类似的事情时这是安全的`SET DELPATH=%1`。尝试`ECHO %1`输入 a`.cmd`并传递一个带有空格的参数，看看你自己会发生什么）。代码段完成后，您可以使用`IF ERRORLEVEL 1`.

```
: # Determine whether we need to invoke DEL or RD or do nothing.
SET DELPATH_DELMETHOD=RD
PUSHD %DELPATH% 2>NUL
IF ERRORLEVEL 1 (SET DELPATH_DELMETHOD=DEL) ELSE (POPD)
IF NOT EXIST %DELPATH% SET DELPATH_DELMETHOD=NOOP
: # Reset ERRORLEVEL so that the last command which
: # otherwise set it does not cause us to falsely detect
: # failure.
CMD /C EXIT 0
IF %DELPATH_DELMETHOD%==DEL DEL /Q %DELPATH%
IF %DELPATH_DELMETHOD%==RD RD /S /Q %DELPATH% 
```

关键是，当环境符合 POSIX 时，一切都会变得更简单。或者，如果您安装了一个最小的 MSYS 并使用它。

* * *

## 回答 #14

> 赞同：3
> 
> 时间：2012-09-04T01:55:58.260

这是您需要做的...

使用以下行创建批处理文件

`RMDIR /S %1`

将批处理文件另存为`Remove.bat`并放入`C:\windows`

创建以下注册表项

`HKEY_CLASSES_ROOT\Directory\shell\Remove Directory (RMDIR)`

使用以下值启动`regedit`并更新默认值`HKEY_CLASSES_ROOT\Directory\shell\Remove Directory (RMDIR)\default`

`"c:\windows\REMOVE.bat" "%1"`

就是这样！现在您可以右键单击任何目录并使用 RMDIR 功能

* * *

## 回答 #15

> 赞同：2
> 
> 时间：2008-09-19T00:03:57.257

您可以在 Windows 上安装[GnuWin32](http://gnuwin32.sourceforge.net/)并本机使用 *nix 命令。我先安装它，然后再在 Windows 的薄荷味新副本上安装其他任何东西。:)

* * *

## 回答 #16

> 赞同：2
> 
> 时间：2018-09-03T06:57:45.803

使用 Powershell 5.1

```
 get-childitem *logs* -path .\ -directory -recurse | remove-item -confirm:$false -recurse -force 
```

将*日志*替换为要删除的目录名称。

**get-childitem**从当前路径 (.) 递归搜索名称为子目录。

**remove-item**删除结果。

* * *

## 回答 #17

> 赞同：2
> 
> 时间：2019-06-12T23:16:17.130

使用风险自负。信息按“原样”提供。未经广泛测试。

右键单击 Windows 图标（通常是左下角）> 单击“Windows PowerShell（管理员）”> 使用此命令（请注意，如果您不小心，您可以轻松删除所有文件）：

```
rd -r -include *.* -force somedir 
```

`somedir`您要删除的非空目录在哪里。

请注意，对于外部连接的磁盘或有问题的磁盘，Windows 有时会表现得很奇怪 - 它在删除（或任何复制尝试）时不会出错，但不会按照指示删除（或不复制）目录。（我发现在这种情况下，至少对我而言，@n_y 在他的回答中给出的命令会产生类似“get-childitem：文件或目录已损坏且无法读取”之类的错误，因此在 PowerShell 中）

* * *

## 回答 #18

> 赞同：2
> 
> 时间：2020-04-05T18:17:16.877

**对于在 Windows 机器上安装[npm](https://www.npmjs.com/)包时遇到问题并且看到错误提示“`rm -rf...`找不到命令”的任何人，**迟到但重要的答案。**您可以使用[bash cli](https://gitforwindows.org/)在 Windows 上运行 rm 命令。**

 **对于 npm 用户，`npm config set script-shell "C:\Program Files\Git\bin\bash.exe"`如果您尝试安装的 npm 包具有使用命令[的安装后脚本](https://docs.npmjs.com/misc/scripts)`rm -rf`，则可以将 npm 的配置更改为这种方式，您将能够运行该`rm`命令而无需更改 npm 包中的任何内容或禁用安装后脚本配置。（例如，在他们的安装后脚本中`styled-components`使用命令）`rm`

如果您只想使用`rm`命令，您可以轻松地使用 bash 并传递参数。

**所以是的，您可以在 Windows 上使用“rm”命令。**

* * *

## 回答 #19

> 赞同：2
> 
> 时间：2021-07-09T10:48:13.013

在 powershell 中`rm -recurse -force`工作得很好。

* * *

## 回答 #20

> 赞同：1
> 
> 时间：2021-07-13T21:13:51.970

作为侧节点：

从具有所有子目录（递归）+强制删除的linux版本

`$ rm -rf ./path`

到 PowerShell

`PS> rm -r -fo ./path`

它具有接近相同的参数（只是分开）（需要 -fo，因为 -f 可以匹配不同的其他参数）

笔记：

```
Remove-Item ALIASE
    ri
    rm
    rmdir
    del
    erase
    rd 
```

* * *

## 回答 #21

> 赞同：1
> 
> 时间：2021-10-01T13:04:52.617

在 powershell 中， rm 是 的别名`Remove-Item`，所以删除一个文件，

```
rm -R -Fo the_file 
```

相当于

```
Remove-Item -R -Fo the_file 
```

如果您对 gnu util 感到满意`rm`，您可以在 windows 上`rm`通过[choco](https://chocolatey.org/install)包管理器使用 util。

使用以下命令在 powershell 中安装 gnu utils `choco`：

```
choco install GnuWin 
```

最后，

```
rm.exe -rf the_file 
```

* * *

## 回答 #22

> 赞同：0
> 
> 时间：2015-03-25T13:01:10.783

这对我有用：

只需尝试减少路径的长度。ie :: 将导致此类文件的所有文件夹重命名为尽可能小的名称。说出一个字母的名字。继续在文件夹层次结构中向上重命名。通过这个你有效地减少了路径长度。现在终于尝试立即删除文件。

* * *

## 回答 #23

> 赞同：0
> 
> 时间：2021-07-22T07:42:46.883

Windows 注册表编辑器版本 5.00

[HKEY_CLASSES_ROOT\Folder\shell\rmdir\command]
@="cmd.exe /s /c rmdir "%V""

* * *

## 回答 #24

> 赞同：-3
> 
> 时间：2008-09-18T23:14:50.743

如果您使用的是旧版本的 Windows，还有 deltree。

您可以从这里了解更多信息： [SS64：DELTREE - 删除所有子文件夹和文件。](https://ss64.com/nt/deltree.html)

# asp.net - ASP.Net 应用程序在部署到 Web 服务器时无法登录到 SQL Server 数据库

> ID：97899
> 
> 赞同：1
> 
> 时间：2008-09-18T23:11:50.300
> 
> 标签：asp.net, sql-server-2005, web-deployment-project

我在将 ASP.NET V2 Web 应用程序部署到我们的部署环境时遇到问题，并且在设置 sql server 时遇到问题。

当我运行该网站时，我得到用户“MOETP\MOERSVPWLG$”的登录失败。尝试连接数据库时出错。

这似乎是网络服务用户，这是我希望从应用程序中获得的行为，但我似乎无法允许网络服务用户访问数据库。

关于设置的一些细节。IIS 6 和 SQL Server 2005 都安装在部署环境中的同一台服务器上。我所做的测试设置的唯一更改是将数据库连接字符串指向新的实时数据库，当然还要复制所有内容。

我在这一点上的假设是，需要对 SQL 服务器设置进行一些操作以允许来自 asp.net 的连接。但我看不出它可能是什么。

有任何想法吗？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2008-09-18T23:23:14.983

听起来您可以正常连接到数据库，并且您正在使用集成的 Windows 身份验证。

通过集成的 Windows 身份验证，您与数据库的连接将使用您的应用程序池用户身份使用的任何内容。您必须确保 asp.net 使用的用户身份在数据库服务器上。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2008-09-18T23:26:06.520

如果是全新安装，则可能无法设置所有内容。检查 SQL Server 配置管理器， http: [//msdn.microsoft.com/en-us/library/ms174212.aspx](http://msdn.microsoft.com/en-us/library/ms174212.aspx)。分步说明[http://download.pro.parallels.com/10.3.1/docs/windows/Guides/pcpw_upgrade_guide/7351.htm](http://download.pro.parallels.com/10.3.1/docs/windows/Guides/pcpw_upgrade_guide/7351.htm)。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2008-09-19T00:15:50.410

您在帖子中指定的用户名是一台机器上的网络服务帐户在其他机器上的样子，即“DOMAIN\MACHINENAME$”。

如果您从一台计算机上的 IIS6 连接到另一台计算机上的 SQL Server，并且您使用网络服务作为应用程序池的进程标识，那么您需要显式添加“MOETP\MOERSVPWLG$”作为 SQL Server 的登录名，并将其映射到适当的数据库用户和角色。输入与登录名完全相同的名称（当然要减去引号）。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2008-09-18T23:17:32.203

确保在 sql server 上为您尝试登录的用户创建了一个登录名。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2008-09-18T23:20:06.707

它可能有一些不同的东西。

您是否使用集成 Windows 身份验证？如果是这样，您需要确保用户 ASP.net 正在运行，可以与数据库对话（或模拟可以与数据库对话的用户）。

Web 服务器是否有权与数据库通信？有时，Web 服务器部署在 DMZ 中。

如果您使用的是 SQL Server 登录名，生产服务器上是否存在具有相同权限的相同登录名？

# testing - Quick and Dirty Usability testing tips?

> ID：97913
> 
> 赞同：6
> 
> 时间：2008-09-18T23:13:56.767
> 
> 标签：testing, usability, user-experience, hci

What are your best usability testing tips? I need quick & cheap.

* * *

## 回答 #1

> 赞同：9
> 
> 时间：2008-09-18T23:38:19.953

While aimed at web design, Steve Krug's excellent "[Don't Make Me Think: A Common Sense Approach To Web Usability](http://www.amazon.co.uk/Dont-Make-Me-Think-Usability/dp/0321344758/ref=sr_1_3?ie=UTF8&s=books&qid=1221780772&sr=8-3)" features (in the second edition, at least), a great chapter entitled "Usability Testing On 10 Cents A Day", which I think is applicable to a much wider range of platforms.

The chapter specifically deals with usability testing done quick and dirty, in a low-budget (no money and/or no time) environment, and illustrates some of the most important considerations for getting an initial "feel" of the thing.

Some of the points I like in particular are:

*   You don't need to test with a huge number of people (a sentiment also echoed by [Jakob Nielsen](http://www.useit.com/alertbox/20000319.html))
*   A live reaction is worth a lot; if possible, make sure the developers can see the reaction (perhaps using a video camera and a TV; it doesn't need to be an expensive one)
*   Testing a few people early is better than a lot later

Joel Spolsky is known for advocating "[hallway usability testing](http://www.joelonsoftware.com/articles/fog0000000043.html)", where you grab a few passing users and ask them to complete some simple task. Partly inspired by the "a few users yield the bulk of the results" philosophy, it's also relatively convenient and inexpensive, and can be done every so often.

* * *

## 回答 #2

> 赞同：8
> 
> 时间：2008-09-19T01:33:23.640

Ask someone non-techy and unfamiliar with it to use it.

`The archetypal non-technical user, one's elderly and scatterbrained maiden aunt. Invoked in discussions of usability for people who are not hackers and geeks; one sees references to the “Aunt Tillie test”.`

The `Aunt Tilly Test` (Probably needs a better name in today's day and age, but that's what it's referred to)

* * *

## 回答 #3

> 赞同：3
> 
> 时间：2008-09-18T23:26:44.413

You have to watch people use your application. If you work in a reasonable sized company, do some 'hallway testing'. Pull someone who is walking past your door into the room and say something like, 'Could you please run the payroll on this system for the next month? It should only take two minutes'.

Hopefully they won't have any problems and it shouldn't be too much of an imposition on the people walking past. Fix up any hiccups or smooth over any processes that are unnecessarily complex and repeat. A lot.

Also, make sure you know what usability is and how to achieve it. If you haven't already, check out [The Design of Everyday Things](https://rads.stackoverflow.com/amzn/click/com/0465067107).

* * *

## 回答 #4

> 赞同：3
> 
> 时间：2008-09-18T23:51:02.543

Some good tips here.

One mistake I made earlier on in my career was turning the usability test into a teaching exercise. I'd spend a fair amount of time explaining how to use the app rather than letting the user figure that out. It taught me a lot about whether my applications were easy or hard to use by how puzzled they got trying to use the app.

One thing I did was put together a very simple scenario of what I wanted the user to do and then let them go do it. It didn't have step-by-step instruction ("click the A button, then click the B button") but instead it said things like "create a new account" and "make a deposit". From that, the user got to 'explore' my application and I got to see how easy it was to use.

Anyhow, that was pretty cheap and quite enlightening to me.

* * *

## 回答 #5

> 赞同：3
> 
> 时间：2008-10-09T16:14:28.200

Quick and cheap won't cut it. You have to invest in a user experience framework, starting with defining clear goals for your app or website. I know it's not what people want to hear, but after supervising and watching a lot of user testing over the years, using Nielsen's discount usability methods is just not enough in most cases. Sure, if your design really sucks and have made huge usability errors, quick and dirty will get 80% of the crud out of the system. But, if you want long-term, quality usability and user experience, you must start with a good design team. And I don't mean good graphic designers, but good Information Architects, interaction designers, XHTML/CSS coders, and even Web Analytics specialists who will make sure your site/app is measurable with clear goals and metrics. I know, it's a lot of $$$, but if you are serious with your business (as I am sure most of us are), we need to get real and invest upfront instead of trying to figure out what went wrong once the whole thing is online.

* * *

## 回答 #6

> 赞同：2
> 
> 时间：2008-09-19T00:31:14.477

Another topic to research is [Heuristics](http://www.useit.com/papers/heuristic/heuristic_list.html) for usability. This can give you general tips to follow. Here's another [use of heuristics](http://instone.org/heuristics)

* * *

## 回答 #7

> 赞同：1
> 
> 时间：2008-09-19T21:33:29.347

If you don't know where to begin, start small. Sit a friend down at your computer. Explain that you want them to accomplish a task using software, and watch everything they do.

It helps to remain silent while they are actually working. Write everything down. `"John spent 15 seconds looking at the screen before acting. He moused over the top nav to see if it contained popup menus. He first clicked "About Us" even though it wasn't central to his task."` Etc.

Then use the knowledge you gain from this to help you design more elaborate tests. Tests with different users from different knowledge realms. More elaborate tasks and more of them.

Film them. A web-cam mounted on the monitor is a good way to capture where their eyes are moving. A video recorder coming over their shoulder at 45 degrees is a good way to capture an overview. Bonus points if you can time-sync the two. Don't worry if you can't do it all. Do what you can do.

Don't plan your test as if it's the last one you'll ever need and you want to get it perfect. There is no perfect. The only thing approaching perfection is many iteration and much repetition. You can only approach 100% confidence as the number of tests approaches the number of actual users of your software. Usually nobody even gets close to this number, but everybody should be trying to.

And don't forget to re-test people after you incorporated the improvement you saw were needed. Same people, different people, either is ok.

Do what you can do. Don't lament what you can't do. Only lament what you could have tested but didn't.

* * *

## 回答 #8

> 赞同：1
> 
> 时间：2009-07-13T07:38:26.863

I am answering very late but I was thinking about asking a similar questions about some ideas. Maybe it is better to keep everything in this question.

I would say that:

*   Do not teach people about your app. Let them have fresh eyes.

*   Ask them to make some tasks and record their actions with a tool like camstudio [http://camstudio.org/](http://camstudio.org/)

*   After the test, ask them to answer so simple questions. Here is my list:

    *   What was your first feeling when you accessed the app?
    *   Can you define the key concepts that are used by the app?
    *   What are the top-3 positive things about the application?
    *   What are the top-3 negative things about the application?

What do you think about these ideas?

# ruby - 用于 IVR 的 Asterisk AGI 框架；粘连替代？

> ID：97920
> 
> 赞同：1
> 
> 时间：2008-09-18T23:14:32.897
> 
> 标签：ruby, asterisk, telephony, ivr, agi

我正在尝试开始使用 Asterisk 和 Ruby 编写可扩展的电信级应用程序。我原本打算为此使用 Adhearsion 框架，但它不具备所需的成熟度，而且它的文档严重缺乏。AsteriskRuby 似乎是一个不错的选择，因为它有据可查，而且似乎是由 Vonage 编写的。

有人有部署基于 AGI 的 IVR 应用程序的经验吗？你使用了什么框架（如果有的话）？如果合理的话，我什至会考虑使用非 Ruby 的。谢谢！

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2008-12-18T15:45:13.553

SipX 确实是错误的答案。我在 SipX 3.10.2 上编写了一些极其复杂的 VoiceXML，自从 SipX 4 放弃 SipXVXML 用于需要编译 JAR 的 IVR 的接口以来，这一切都是徒劳的。最重要的是，北电申请破产，开源版本的文档极差，对 VXML 2.0（截至 3.10.2）和 SIP 标准（截至 3.10.2，不能很好地与 ITSP 建立中继）的合规性差。我会为它的设计目的而鼓掌，因为它是一个 PBX。但作为 IVR，如果让我重新做一遍，我会做一些不同的事情。我不确定是什么，但有些不同。我现在正在使用 Trixbox CE 并致力于将其绑定到 JVoiceXML 或 VoiceGlue。

另外，不要阅读 SipX wiki 废话。它将 SipX 3.10 与 AsteriskNOW 1 与 Trixbox 1 进行比较。来吧。这就像将 Mac OS X 与 Win95 进行比较！更现实的比较是 SipX 4（将于 2009 年第一季度发布）与 Asterisk 1.6 和 Trixbox 2.6，这将表明它们实现了几乎相同的结果，但在可扩展性和高可用性方面除外；SipX 在这方面获胜。但是，为了成熟和稳定，我会提倡 Asterisk。

此外，我使用 SipXVXML 的真实性能结果：
Dell PowerEdge R200，至强双核 3.2GHz，在抖动前处理 17 个呼叫。
HP DL380 G4，双 Xeon HT 3.2 GHz，在长时间停顿前处理 30 个呼叫。

当我完成对 VoiceGlue 和 JVoiceXML 的评估后，我将发布我的发现，但我认为我最终将编写一个从 AGI 调用的自定义 PHP，因为所有工具都是 Asterisk 的本地工具。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2008-11-12T20:34:19.403

如果您正在寻找“电信级”应用程序，您可能需要研究 SipXecs 而不是星号。它功能强大、免费且开源，可从北电获得商业支持。您可以通过 ruby​​（或任何其他语言）的 Web 服务 API 与它进行交互。

有关更多信息，请参阅[SipXecs wiki](http://sipx-wiki.calivia.com/index.php/Main_Page)。该站点上有一个比较矩阵，将功能与 AsteriskNOW 和 TrixBox 进行比较。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2009-01-29T02:12:42.847

随着 v0.8.1 的发布，您应该重新访问 Adhearsion，并且文档最近变得更好了。看看这里：

[http://adhearsion.com](http://adhearsion.com) [http://docs.adhearsion.com](http://docs.adhearsion.com) [http://api.adhearsion.com](http://api.adhearsion.com)

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2008-09-18T23:30:03.280

那里真的没有任何其他框架。当然，每种语言都有 AGI 绑定，但就用于开发电话应用程序的成熟框架而言，我们还没有实现。至少在开源世界中。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2008-09-18T23:32:11.327

我在[这里](https://stackoverflow.com/questions/36054/anyone-have-experience-with-sphinx-speech-recognition)、[这里](https://stackoverflow.com/questions/36056/whats-a-good-open-source-voicexml-implementation)和[这里](https://stackoverflow.com/questions/10575/whats-your-interactive-voice-response-platform)问过一些相关的问题。我正在使用 Microsoft 的语音服务器，我非常有兴趣了解那里的任何替代方案，尤其是开源的替代方案。您可能会在其中一个问题的答案中找到一些有用的信息。

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2009-02-20T18:51:11.460

我广泛使用了[JAGIServer](http://sourceforge.net/projects/jagiserver/)，尽管它不再处于开发阶段，而且它非常好且易于使用。它是 FastAGI 的接口，我建议您使用它来代替简单的 AGI。

这个框架的新版本是[OrderlyCalls](http://orderlycalls.sourceforge.net/)，它似乎有更多的功能，但由于我不需要它们，所以我没有尝试过。

我想这完全取决于你想用 AGI 做什么。通常我有一个有点复杂的拨号计划来收集和验证所有用户输入，然后只使用 AGI 连接到 Java 应用程序，该应用程序将读取一些变量，用它做一些事情（执行操作、查询等），然后设置更多AGI 通道上的变量并断开连接。此时，拨号计划会根据 Java 应用程序设置的变量的结果继续进行。

这工作得非常快，因为您在 Java 应用程序上有一个 ServerSocket，它接收来自 AGI 的传入连接，使用新套接字和 JAGIProcessor 的新实例创建一个 JAGIClient（您必须编写它，它是一个对象，它将完成您的所有工作）处理），然后在线程池中运行 JAGIClient。您的 JAGIProcessor 实现了 processCall 方法，在该方法中它完成了它需要的所有工作，与作为参数传递的 JAGIClient 交互，读取和设置变量或执行 AGI 接口允许您执行的任何操作。

所以你有一个一直在运行的 Java 应用程序，它可以是一个简单的 J2SE 应用程序，也可以是一个容器上的 EE 应用程序，没关系；一旦它运行，它将非常快速地处理 AGI 请求，因为不必启动新进程（与为每个 AGI 调用运行一个程序的简单 AGI 相比）。

* * *

## 回答 #7

> 赞同：0
> 
> 时间：2009-08-12T17:26:16.647

再喷。在使用 PHPAGI 将我客户的 IVR 从 SipX 迁移到 Asterisk 之后，我必须说我还没有遇到任何其他架构如此简单和强大。今天我将在我之前测试过 SipX 的同一硬件上对 Trixbox CE 2.8 进行压力测试。但我必须说，使用 PHPAGI 进行 IVR 和 Asterisk CLI 进行调试非常有效，并且让我开发 IVR 的速度比任何其他公司都快。我今天正在实施 TTS 和 ASR，我会尽可能发布我的压力测试结果。

* * *

## 回答 #8

> 赞同：0
> 
> 时间：2010-03-11T15:38:01.650

简单的小型灵活的 Asterisk AGI IVR 写在 PHP [http://freshmeat.net/projects/phpivr](http://freshmeat.net/projects/phpivr)

* * *

## 回答 #9

> 赞同：0
> 
> 时间：2010-05-31T09:01:23.163

对于小型和简单的应用程序，我在 perl 中使用 Asterisk::AGI。Fast AGI 也有扩展。对于更大的应用程序，例如 VoIP 运营商的后端，我使用类似于用 Java 编写的 OrderlyCalls（我自己的代码）的东西。尽管从 java fastagi 引擎开始并将其扩展到您的需要，但 OrderlyCalls 非常棒。

# delphi - Codegear RAD Studio 帮助系统已损坏

> ID：97927
> 
> 赞同：2
> 
> 时间：2008-09-18T23:15:15.593
> 
> 标签：delphi, delphi-2007

我已经使用**Codegear RAD Studio**一年多了，但自从**“May08 帮助更新”**以来，帮助系统不再工作。如果我打开帮助，内容窗格完全是空白的。如果我按 F1，我会收到以下错误： **“无法解释指定的 HxC 文件。”**

我已经使用搜索引擎和 Codegear 论坛搜索了答案，但到目前为止似乎没有任何解决问题的方法。如果可能的话，我宁愿不进行完全重新安装。有没有其他人遇到过这个问题并知道如何解决它？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2008-09-19T00:38:11.527

听起来您需要完全卸载/重新安装。唉。

请务必查看[http://docs.codegear.com](http://docs.codegear.com)以获取最新的 Delphi 帮助。在该站点上，您还可以下载各种形式的 Delphi 2007 帮助，包括 PDF 和 CHM。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2008-09-18T23:24:29.830

您可能从下载中获得了损坏的文件。我会尝试再次下载并重新安装帮助。

# assembly - Grub 并进入实模式（低级汇编语言编程）

> ID：97946
> 
> 赞同：8
> 
> 时间：2008-09-18T23:19:19.390
> 
> 标签：assembly, x86, grub, real-mode

我一直在开发一个玩具操作系统，并且一直在使用 grub 作为我的引导加载程序。最近在尝试使用 VGA 时，我发现我无法使用硬件中断。我发现这是因为我被 grub 置于保护模式。

有谁知道如何在不必摆脱 grub 的情况下回到实模式？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2008-09-25T16:43:03.410

如果您使用 GRUB 作为引导加载程序，您可以使用`intcall`（在[COMBOOT API](http://syslinux.zytor.com/comboot.php)中指定）在您的情况下调用 BIOS 函数 int 0x10 来访问[VESA VBE](http://www.vesa.org/public/VBE/vbe3.pdf)。

但是，如果您需要访问 VGA 硬件寄存器，这将无济于事。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-01-20T19:25:01.437

你的意思是写端口（价值，$ 3c9）？

```
>mov 03c9,AH
>out value,AL 
```

或类似的 INTEL asm(NASM)

3c9 3c8 IIRC 是 VGA 寄存器。

# c++ - 什么是 std::pair？

> ID：97948
> 
> 赞同：44
> 
> 时间：2008-09-18T23:19:38.017
> 
> 标签：c++, boost, stl, std-pair

有什么`std::pair`用，我为什么要使用它，它`boost::compressed_pair`带来了什么好处？

* * *

## 回答 #1

> 赞同：81
> 
> 时间：2009-02-21T17:51:30.177

`compressed_pair`使用一些模板技巧来节省空间。在 C++ 中，一个对象（小 o）不能与不同的对象具有相同的地址。

所以即使你有

```
struct A { }; 
```

`A`的大小不会为 0，因为那时：

```
A a1;
A a2;
&a1 == &a2; 
```

会持有，这是不允许的。

*但是*许多编译器会做所谓的“空基类优化”：

```
struct A { };
struct B { int x; };
struct C : public A { int x; }; 
```

在这里，`B`和`C`具有相同的大小是可以的，即使`sizeof(A)`不能为零。

因此`boost::compressed_pair`，利用这种优化，如果它是空的，将在可能的情况下从该对中的一个或另一个类型继承。

所以a`std::pair`可能看起来像（我省略了很多，ctors等）：

```
template<typename FirstType, typename SecondType>
struct pair {
   FirstType first;
   SecondType second;
}; 
```

这意味着如果 要么 要么`FirstType`是`SecondType`，`A`你`pair<A, int>`必须大于`sizeof(int)`。

但如果您使用`compressed_pair`，其生成的代码将类似于：

```
 struct compressed_pair<A,int> : private A {
    int second_;
    A first() { return *this; }
    int second() { return second_; }
 }; 
```

并且`compressed_pair<A,int>`只会和 sizeof(int) 一样大。

* * *

## 回答 #2

> 赞同：35
> 
> 时间：2008-09-18T23:32:20.360

[`std::pair`](http://en.cppreference.com/w/cpp/utility/pair)是一种数据类型，用于将两个值组合为一个对象。 [`std::map`](http://en.cppreference.com/w/cpp/container/map)将它用于键值对。

在你学习的时候[`pair`](http://en.cppreference.com/w/cpp/utility/pair)，你可能会去看看[`tuple`](http://en.cppreference.com/w/cpp/utility/tuple)。这就像`pair`但是用于对任意数量的值进行分组。 `tuple`是 TR1 的一部分，许多编译器已经将它包含在他们的标准库实现中。

此外，请查看Pete Becker所著*的 The C++ Standard Library Extensions: A Tutorial and Reference*一书的第 1 章“元组” ，ISBN-13：9780321412997，以获得详尽的解释。

![替代文字](https://i.stack.imgur.com/M82nG.gif)

* * *

## 回答 #3

> 赞同：11
> 
> 时间：2008-09-18T23:21:37.047

您有时需要从一个函数返回 2 个值，并且为此创建一个类通常是矫枉过正的。

std:pair 在这些情况下会派上用场。

我认为 boost:compressed_pa​​ir 能够优化掉大小为 0 的成员。这对于库中的重型模板机制非常有用。

如果您确实直接控制类型，则无关紧要。

* * *

## 回答 #4

> 赞同：11
> 
> 时间：2009-02-21T19:11:24.540

听到compressed_pa​​ir 关心几个字节听起来很奇怪。但是当考虑在哪里可以使用compressed_pa​​ir 时，它实际上可能很重要。例如，让我们考虑以下代码：

```
boost::function<void(int)> f(boost::bind(&f, _1)); 
```

在上述情况下使用compressed_pa​​ir 会突然产生很大的影响。如果 boost::bind 将函数指针和占位符存储`_1`为自身或 a`std::pair`本身的成员，会发生什么情况？好吧，它可能膨胀到`sizeof(&f) + sizeof(_1)`. 假设函数指针有 8 个字节（对于成员函数来说并不罕见）并且占位符有一个字节（请参阅 Logan 的回答了解原因），那么绑定对象可能需要 9 个字节。由于对齐，这可能会在通常的 32 位系统上膨胀多达 12 个字节。

`boost::function`鼓励其实现应用小对象优化。这意味着对于*小型*函子，直接嵌入在`boost::function`对象中的小缓冲区用于存储函子。对于较大的仿函数，必须通过使用 operator new 来使用堆来获取内存。在 boost[版本 1.34](http://www.boost.org/users/history/version_1_34_0)左右，决定采用[这种优化](http://lists.boost.org/Archives/boost/2005/12/98624.php)，因为它被认为可以获得一些非常好的性能优势。

现在，这样一个小缓冲区的合理（但可能仍然很小）限制是 8 个字节。也就是说，我们非常简单的绑定对象*不*适合小缓冲区，并且需要存储 operator new。如果上面的绑定对象使用 a `compressed_pair`，它实际上可以将它的大小减少到 8 个字节（或非成员函数指针通常为 4 个字节），因为占位符只不过是一个空对象。

因此，看起来只是为了几个字节而浪费大量精力实际上会对性能产生重大影响。

* * *

## 回答 #5

> 赞同：3
> 
> 时间：2008-09-18T23:24:40.737

std::pair 对于 STL 中的其他几个容器类非常有用。

例如：

```
std::map<>
std::multimap<> 
```

两者都存储 std::pairs 键和值。

在使用 map 和 multimap 时，您经常使用指向 pair 的指针来访问元素。

* * *

## 回答 #6

> 赞同：3
> 
> 时间：2008-09-18T23:25:09.830

它是存储一对值的标准类。它被一些标准函数返回/使用，例如`std::map::insert`.

`boost::compressed_pair`声称更有效率：[见这里](http://www.boost.org/doc/libs/1_36_0/libs/utility/compressed_pair.htm)

* * *

## 回答 #7

> 赞同：3
> 
> 时间：2008-09-23T11:48:18.317

附加信息：当对的类型之一是空结构时， boost::compressed_pa​​ir 很有用。当对的类型以编程方式从其他类型推断时，这通常用于模板元编程中。最后，您通常会有某种形式的“空结构”。

我更喜欢 std::pair 用于任何“正常”使用，除非您从事繁重的模板元编程。

* * *

## 回答 #8

> 赞同：3
> 
> 时间：2009-02-21T17:31:57.180

它只不过是一个具有两个变量的结构。

我实际上不喜欢使用 std::pair 来返回函数。代码的读者必须知道 .first 是什么以及 .second 是什么。

我有时使用的折衷方案是立即创建对 .first 和 .second 的常量引用，同时清楚地命名引用。

* * *

## 回答 #9

> 赞同：3
> 
> 时间：2010-01-23T19:25:56.730

> 什么是 std::pair，我为什么要使用它？

它就像简单的两个元素元组一样。[它是在STL](http://www.sgi.com/tech/stl/pair.html)的第一个版本中定义的，当时编译器没有广泛支持模板和元编程技术，而这些技术需要实现更复杂的元组类型，如[Boost.Tuple](http://www.boost.org/doc/libs/release/libs/tuple/doc/tuple_users_guide.html)。

它在许多情况下都很有用。`std::pair`用于标准关联容器。它可以用作范围的一种简单形式`std::pair<iterator, iterator>`- 因此可以定义接受单个对象表示范围的算法，而不是分别接受两个迭代器。（在许多情况下它是一个有用的替代方案。）

* * *

## 回答 #10

> 赞同：1
> 
> 时间：2008-09-18T23:26:45.677

有时，您总是将两条信息一起传递，无论是作为参数，还是返回值，或其他。当然，您可以编写自己的对象，但如果它只是两个小的原语或类似的，有时一对似乎就可以了。

# javascript - 提交 Web 表单时反跳点击

> ID：97962
> 
> 赞同：4
> 
> 时间：2008-09-18T23:23:19.320
> 
> 标签：javascript, html, prototypejs

我们与之交互的编写不佳的后端系统在处理我们产生的负载时遇到了麻烦。虽然他们修复了负载问题，但我们正在尝试减少我们生成的任何额外负载，其中之一是后端系统继续尝试为表单提交提供服务，即使另一个提交来自同一用户。

我们注意到的一件事是用户双击表单提交按钮。我需要消除这些点击，并防止第二次提交表单。
我的方法（使用原型）`onSubmit`在表单上放置一个调用以下函数的表单，该函数隐藏表单提交按钮并显示“正在加载...” `div`。

```
function disableSubmit(id1, id2) {
    $(id1).style.display = 'none';
    $(id2).style.display = 'inline';
} 
```

我发现这种方法的问题是，如果我在 "loading..." 中使用动画 gif `div`，它可以正常加载，但在表单提交时不会动画。

在等待表单结果（最终）加载的同时，有没有更好的方法来进行这种去弹跳并继续在页面上显示动画？

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2008-09-27T04:28:44.443

使用 Prototype，您可以使用此代码查看是否已提交任何表单，并在提交时禁用所有提交按钮：

```
document.observe( 'dom:loaded', function() { // when document is loaded
    $$( 'form' ).each( function( form ) { // find all FORM elements in the document
        form.observe( 'submit', function() {  // when any form is submitted
            $$( 'input[type="submit"]' ).invoke( 'disable' );  // disable all submit buttons
        } );
    } );
} ); 
```

这应该对双击提交按钮的用户有所帮助。但是，仍然可以通过任何其他方式提交表单（例如，在文本字段上按 Enter）。为了防止这种情况，您必须在第一个表单提交之后开始观察并停止它：

```
document.observe( 'dom:loaded', function() {
    $$( 'form' ).each( function( form ) {
        form.observe( 'submit', function() {
            $$( 'input[type="submit"]' ).invoke( 'disable' );
            $$( 'form' ).observe( 'submit', function( evt ) { // once any form is submitted
                evt.stop(); // prevent any other form submission
            } );
        } );
    } );
} ); 
```

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2009-03-20T17:17:02.917

以上所有好的建议。如果你真的想像你说的那样“去抖动”，那么我有一个很好的功能。更多详情请访问[unscriptable.com](http://unscriptable.com/index.php/2009/03/20/debouncing-javascript-methods/)

```
var debounce = function (func, threshold, execAsap) {

    var timeout;

    return function debounced () {
        var obj = this, args = arguments;
        function delayed () {
            if (!execAsap)
                func.apply(obj, args);
            timeout = null; 
        };

        if (timeout)
            clearTimeout(timeout);
        else if (execAsap)
            func.apply(obj, args);

        timeout = setTimeout(delayed, threshold || 100); 
    };

} 
```

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2008-09-19T03:42:32.957

如果您有 jQuery，请附加一个 click() 事件，在初始提交后禁用按钮 -

```
$('input[type="submit"]').click(function(event){
 event.preventDefault();
 this.click(null);
}); 
```

之类的东西。

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2008-09-18T23:28:52.503

您可以尝试在输入 (type=submit) 元素上设置“禁用”标志，而不仅仅是更改样式。那应该完全关闭浏览器端的 from 。

见： http: [//www.prototypejs.org/api/form/element#method-disable](http://www.prototypejs.org/api/form/element#method-disable)

* * *

## 回答 #5

> 赞同：-1
> 
> 时间：2010-12-03T01:38:31.427

使用 AJAX 提交表单，GIF 就会动画。

# eclipse - 开始使用 IDE？

> ID：97971
> 
> 赞同：3
> 
> 时间：2008-09-18T23:24:53.480
> 
> 标签：eclipse, emacs, ide

在这一点上通过 emacs 和 vi 编程多年，我听说使用 IDE 是提高效率的好方法。

为此，我决定尝试使用 Eclipse 进行大量编码并看看我是如何进行的。

是否有任何建议可以简化向 IDE 的过渡。显然，有些人会认为这些都不值得费心，但我认为 Eclipse 允许 emacs 样式的键绑定并具有代码完成和内置调试，我认为值得尝试转向功能更丰富的环境对于我的大部分开发价值。

那么你对缓和过渡有什么建议呢？

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2008-09-18T23:28:51.130

帮助我从 Emacs 过渡到其他 IDE 的一件事是 IDE 是糟糕的编辑器。我嘲笑那个人，但我现在明白他们的意思了。

像 Emacs 或 Vim 这样的编辑器可以真正专注于成为一名优秀的编辑器。

像 Visual Studio 或 Eclipse 这样的 IDE 真正专注于成为一个具有内置修改文件方式的优秀项目管理工具。

我发现牢记以上内容（并保持 Emacs 方便）有助于我在 IDE du jour 无法满足我的需求时不会感到沮丧。

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2008-09-18T23:57:19.970

Eclipse 是我用过的最好的 IDE，即使考虑到它在慢速计算机（比如我的工作机器...... Pentium III！）上的占用空间很大并且运行缓慢。

与其试图“缓解过渡”，我认为最好直接跳进去，让自己被花里胡哨的东西和真正有用的重构等所淹没。

以下是我会尽快有意识地使用的一些最有用的东西：

*   ctrl-shift-t 通过对名称的增量搜索找到并打开一个类
*   ctrl-shift-o 自动生成导入语句（并删除多余的语句）
*   F3 在标识符上跳转到它的定义，alt-left/right 就像在 web 浏览器中一样在导航历史中后退/前进
*   “快速修复”工具，具有大量上下文相关的重构等。一些例子：

    ```
    String messageXml = in.read();
    Message response = messageParser.parse(messageXml);
    return response;
    ```

如果将文本光标放在 parse(...) 的参数上并按 ctrl+1，Eclipse 将提示“内联局部变量”。如果你这样做，然后将光标放在返回变量“response”上重复，最终结果将是：

```
return messageParser.parse(in.read()); 
```

有很多很多这样的小规则，快速修复工具会建议并应用这些规则来帮助重构您的代码（包括完全相反的“提取到局部变量/字段/常量”，这可能是非常宝贵的）。您可以编写代码来调用您尚未编写的方法 - 转到现在显示错误的行并使用快速修复将提供创建与从您的使用情况推断的参数匹配的方法。对于变量也是如此。所有这些小的重构和捷径可以节省大量时间，并且比您预期的要快得多。每当您要重新排列代码时，请尝试快速修复以查看它是否提出了有用的建议。

菜单中还有很多直接可用的技巧，例如生成 getter/setter、提取接口等。跳进去尝试一切！

* * *

## 回答 #3

> 赞同：3
> 
> 时间：2008-09-18T23:27:28.297

如果您多年来一直在使用 emacs/vi（尽管您同时列出了两者，因此您似乎无法完全适应其中之一），那么使用上述编辑器可能比 IDE 更快。一个有竞争力的 emacs/vi 用户可以通过定制的设置和多年的肌肉记忆达到惊人的思维融合水平。

* * *

## 回答 #4

> 赞同：2
> 
> 时间：2008-09-19T00:36:59.267

一些免费的：

*   [Mac 上的 XCode](http://developer.apple.com/tools/xcode/)
*   [蚀](http://www.eclipse.org/)
*   [Lazarus（Delphi 的开源克隆）](http://www.lazarus.freepascal.org/)
*   [Visual Studio 速成版](http://www.microsoft.com/express/)

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2008-09-18T23:28:45.343

尝试制作几个测试应用程序只是为了让你的脚湿透。一开始可能会觉得比较麻烦。直到您开始充分了解 IDE 及其各种功能后，IDE 的优势才会显现。一旦你知道一切都在哪里并开始理解关键命令，生活就会变得更轻松，更轻松。

* * *

## 回答 #6

> 赞同：1
> 
> 时间：2008-09-18T23:33:53.570

我认为一旦您进入 IDE，您就会发现 IDE 的无价之宝。完整的代码和导航功能、集成的运行/调试以及所有其他小好处确实加起来了。

开始和缓和过渡的一些建议： - 首先阅读 IDE 文档中包含的教程或演示，以熟悉 GUI 中的内容。- 查看不同类型的示例项目（通常包含在 IDE 中或作为单独的下载），用于您可能正在编码的不同类型的区域（Web 应用程序、桌面应用程序等），以了解它们在 IDE 中的布局和结构. - 舒适后，从您熟悉的现有代码创建您自己的项目，理想情况下不要过于复杂，然后编译/工作。- 探索力量！调试您的代码，使用重构等。右键菜单是您的朋友，直到您学习键盘快捷键以查看您可以做的所有事情。

* * *

## 回答 #7

> 赞同：0
> 
> 时间：2008-09-18T23:29:29.540

阅读文档...并查看您熟悉的快捷键/键绑定等效项。学习新的...

* * *

## 回答 #8

> 赞同：0
> 
> 时间：2012-07-31T17:54:48.880

老问题，但让我建议在某些情况下，像 Notepad++ 这样的东西可能适合其他人可能遇到的 OP 情况。特别是如果您正在寻找轻量级的东西，Notepad++ 可以成为开发人员工具库的一部分。Eclipse、Visual Studio 和其他人都是资源消耗者，它们的所有自动魔法都在进行，如果你想用一大堆键盘快捷键等快速做出一些东西，或者如果你有兴趣查看其他人的源代码，这可以是很有用。哦，是的，而且它也是免费的。

# vb.net - 在 windows 窗体中的 datagridview 中设置焦点

> ID：97976
> 
> 赞同：1
> 
> 时间：2008-09-18T23:25:51.467
> 
> 标签：vb.net, winforms, datagridview

我有一个接受列表（myObject）作为数据源的数据网格视图。我想在数据网格中添加一个新行以添加到数据库中。我通过获取列表来完成此操作...将空白 myObject 添加到列表中，然后重置数据源。我现在想将焦点设置到新行中的第二个单元格。

为了澄清我正在尝试设置焦点

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2009-07-31T16:28:02.010

您可以将焦点设置到一行中的特定单元格，但前提是 DataGridView 上的 SelectionMode 设置为 CellSelect。如果是，只需执行以下操作：

```
dataGridView.Rows[rowNumber].Cells[columnNumber].Selected = true; 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2008-09-18T23:27:55.767

在 WinForms 中，您应该能够设置

```
Me.dataEvidence.SelectedRows 
```

属性到您要选择的行。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-08-13T23:23:27.257

在 Visual Studio **2012** (vb.NET **Framework 4.50** ) 中，您可以将焦点设置在 DataGridView 控件的任何所需单元格上。

试试这个：

```
Sub Whatever()

    ' all above code

    DataGridView1.Focus()
    DataGridView1.CurrentCell = DataGridView1.Rows(x).Cells(y)       'x is your desired row number, y is your desired column number

    ' all below code

End Sub 
```

好的，这对我有用。我希望它也对你有用。

# seo - 如何获取特定网站的 Google 索引中页数的历史记录？

> ID：97982
> 
> 赞同：1
> 
> 时间：2008-09-18T23:26:57.690
> 
> 标签：seo

Google 搜索“site:example.com”会告诉您当前在 Google 索引中的 example.com 页面数。是否有可能找出这个数字是如何随时间变化的？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2008-09-18T23:35:21.583

[HubSpot](http://www.hubspot.com/)为您做到这一点。这需要花钱，但他们会做很多这样有用的事情。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2008-09-20T08:43:49.283

如果您不介意等待，您可以让 cron 每天解析您的 site:example.com 结果并等待数据建立。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2008-10-05T19:54:33.970

我打算建议使用 Google 网站管理员工具，但它似乎没有此信息。多么令人恼火。

无论如何，按照 UltimateBrent 的回答，这个正则表达式将从谷歌搜索中提取值：

```
\d+(?=</b> from <b>domain\.net</b>) 
```

显然，将 domain\.net 更改为您的域。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2008-10-07T13:41:25.390

我将 Python 脚本设置为 cron 作业，以解析来自 Google 结果页面的结果并将其保存。我将其设置为每天针对一组站点运行一次。我编写了另一个脚本来从数据中生成一个 CSV 电子表格。我可以在电子表格程序中打开它并快速制作图表以可视化趋势。

我有用于监控 PageRank 的类似脚本。

这仍然只会给我从我开始检查之日起的数据。我不知道访问历史价值的方法。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2009-09-07T18:46:47.297

你可以使用 domaintools.com

拉胡尔 [http://Valdot.com](http://Valdot.com)

# apache - 如何建立一个现成的 https 到 http 网关？

> ID：97983
> 
> 赞同：0
> 
> 时间：2008-09-18T23:26:59.437
> 
> 标签：apache, http, https, webserver, gateway

我有一个 HTTP 服务器，它位于我们的内部网络中，只能从它内部访问。我想放置另一台服务器来侦听可从外部访问的 HTTPS 端口，并将请求转发到该 HTTP 服务器（并通过 HTTPS 发回响应）。我知道有几种方法可以通过涉及一些编程来做到这一点（我自己用 Tomcat 和我编写的一个非常简单的 servlet 做了一个临时解决方案），但是有没有办法做同样的事情只是插入已经制作的部件（比如 Apache + 模块）？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2008-09-18T23:58:27.427

[这是stunnel](http://www.stunnel.org/)设计的那种用例。有一个使用 stunnel 包装 HTTP 服务器的具体[示例。](http://www.stunnel.org/examples/https_windows.html)

不过，您应该考虑这是否真的是一个好主意。为在企业防火墙内使用而设计的 Web 应用程序通常在安全性方面相当松懈。仅仅加密连接可以防止随意窃听，但不能保护站点。如果攻击者发现了您面向外部的服务器并开始连接到它，他们仍然可以尝试在 Web 服务中找到可利用的漏洞（SQL 注入、跨站点脚本等）。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2008-09-18T23:46:39.247

使用 Apache 查看 mod_proxy。

[Apache 2.2 mod_proxy 文档](http://httpd.apache.org/docs/2.2/mod/mod_proxy.html)

[Apache 2.0 mod_proxy 文档](http://httpd.apache.org/docs/2.0/mod/mod_proxy.html)

# php - 如何在 PHP 中保护数据库密码？

> ID：97984
> 
> 赞同：417
> 
> 时间：2008-09-18T23:27:03.913
> 
> 标签：php, database, security

当 PHP 应用程序建立数据库连接时，它当然通常需要传递登录名和密码。如果我为我的应用程序使用单一的、最低权限的登录名，那么 PHP 需要在某处知道该登录名和密码。保护该密码的最佳方法是什么？似乎只是在 PHP 代码中编写它并不是一个好主意。

* * *

## 回答 #1

> 赞同：255
> 
> 时间：2008-09-18T23:32:18.923

一些人将其误认为是关于如何在数据库中**存储**密码的问题。那是错的。它是关于如何存储让您**访问**数据库的密码。

通常的解决方案是将密码从源代码中移到配置文件中。然后将管理和保护该配置文件的工作留给您的系统管理员。这样开发人员就不需要知道任何有关生产密码的信息，并且在您的源代码管理中没有密码记录。

* * *

## 回答 #2

> 赞同：104
> 
> 时间：2009-08-03T18:28:18.483

如果您托管在其他人的服务器上并且在您的 webroot 之外没有访问权限，您始终可以将您的密码和/或数据库连接放在一个文件中，然后使用 .htaccess 锁定该文件：

```
<files mypasswdfile>
order allow,deny
deny from all
</files> 
```

* * *

## 回答 #3

> 赞同：51
> 
> 时间：2012-04-16T15:13:08.293

最安全的方法是根本没有在您的 PHP 代码中指定的信息。

如果您使用的是 Apache，这意味着在您的 httpd.conf 或虚拟主机文件文件中设置连接详细信息。如果你这样做，你可以不带参数调用 mysql_connect()，这意味着 PHP 永远不会输出你的信息。

这是您在这些文件中指定这些值的方式：

```
php_value mysql.default.user      myusername
php_value mysql.default.password  mypassword
php_value mysql.default.host      server 
```

然后你像这样打开你的mysql连接：

```
<?php
$db = mysqli_connect(); 
```

或者像这样：

```
<?php
$db = mysqli_connect(ini_get("mysql.default.user"),
                     ini_get("mysql.default.password"),
                     ini_get("mysql.default.host")); 
```

* * *

## 回答 #4

> 赞同：42
> 
> 时间：2008-09-18T23:32:18.923

将它们存储在 Web 根目录之外的文件中。

* * *

## 回答 #5

> 赞同：36
> 
> 时间：2008-09-19T13:33:51.183

对于极其安全的系统，我们在配置文件中加密数据库密码（该文件本身由系统管理员保护）。在应用程序/服务器启动时，应用程序会提示系统管理员输入解密密钥。然后从配置文件中读取数据库密码，解密并存储在内存中以供将来使用。仍然不是 100% 安全，因为它存储在解密后的内存中，但在某些时候你必须称它为“足够安全”！

* * *

## 回答 #6

> 赞同：15
> 
> 时间：2013-12-23T21:48:28.963

这个解决方案是通用的，因为它对开源和闭源应用程序都很有用。

1.  为您的应用程序创建一个操作系统用户。见[http://en.wikipedia.org/wiki/Principle_of_least_privilege](http://en.wikipedia.org/wiki/Principle_of_least_privilege)
2.  使用密码为该用户创建一个（非会话）操作系统环境变量
3.  以该用户身份运行应用程序

好处：

1.  您不会偶然将密码检查到源代码控制中，因为您不能
2.  你不会不小心搞砸文件权限。嗯，你可以，但它不会影响这一点。
3.  只能由 root 或该用户读取。无论如何，Root 都可以读取您的所有文件和加密密钥。
4.  如果您使用加密，您如何安全地存储密钥？
5.  作品x平台
6.  确保不要将 envvar 传递给不受信任的子进程

这种方法是 Heroku 提出的，非常成功。

* * *

## 回答 #7

> 赞同：11
> 
> 时间：2008-09-19T19:25:43.710

如果可以在存储凭据的同一文件中创建数据库连接。在连接语句中内联凭据。

```
mysql_connect("localhost", "me", "mypass"); 
```

否则最好在连接语句之后取消设置凭据，因为不在内存中的凭据无法[从内存中读取](http://heartbleed.com)；）

```
include("/outside-webroot/db_settings.php");  
mysql_connect("localhost", $db_user, $db_pass);  
unset ($db_user, $db_pass); 
```

* * *

## 回答 #8

> 赞同：9
> 
> 时间：2017-02-15T02:41:48.713

以前我们将 DB 用户/密码存储在配置文件中，但后来进入了偏执模式——采用了*深度防御*策略。

如果您的应用程序受到威胁，用户将拥有对您的配置文件的读取权限，因此破解者有可能读取此信息。配置文件也可能陷入版本控制，或在服务器周围复制。

我们已切换到在 Apache VirtualHost 中设置的环境变量中存储用户/密码。此配置只能由 root 读取——希望您的 Apache 用户没有以 root 身份运行。

缺点是现在密码在全局 PHP 变量中。

为了降低这种风险，我们采取了以下预防措施：

*   **密码已加密。**我们扩展 PDO 类以包含用于解密密码的逻辑。如果有人阅读了我们建立连接的代码，那么很明显连接是使用加密密码而不是密码本身建立的。
*   **加密密码从全局变量移动到私有变量**中。应用程序立即执行此操作以减少该值在全局空间中可用的窗口。
*   **`phpinfo()`被禁用。**PHPInfo 是获取所有内容（包括环境变量）概览的简单目标。

* * *

## 回答 #9

> 赞同：8
> 
> 时间：2008-09-18T23:52:43.070

如果您使用的是 PostgreSQL，那么它会`~/.pgpass`自动查找密码。有关详细信息，请参阅[手册](http://www.postgresql.org/docs/8.3/interactive/libpq-pgpass.html)。

* * *

## 回答 #10

> 赞同：7
> 
> 时间：2008-09-18T23:36:03.830

您的选择是有限的，因为您说您需要密码才能访问数据库。一种通用方法是将用户名和密码存储在单独的配置文件中，而不是主脚本中。然后确保将其存储在主网络树之外。那就是如果存在网络配置问题，导致您的 php 文件仅显示为文本而不是被执行，那么您还没有暴露密码。

除此之外，您在正确的线路上，对正在使用的帐户的访问权限最小。添加到那个

*   不要将用户名/密码的组合用于其他任何事情
*   将数据库服务器配置为仅接受来自该用户的 Web 主机的连接（如果数据库位于同一台计算机上，则 localhost 会更好）这样即使凭据被公开，除非他们具有其他访问权限，否则它们对任何人都没有用机器。
*   混淆密码（即使是 ROT13 也会这样做）如果某些人确实可以访问该文件，它不会进行太多防御，但至少它会阻止随意查看它。

彼得

* * *

## 回答 #11

> 赞同：6
> 
> 时间：2016-08-28T16:27:10.127

我们以这种方式解决了它：

1.  在服务器上使用 memcache，并打开来自其他密码服务器的连接。
2.  将密码（甚至所有已加密的 password.php 文件）和解密密钥保存到内存缓存中。
3.  该网站调用保存密码文件密码的 memcache 密钥并在内存中解密所有密码。
4.  密码服务器每 5 分钟发送一个新的加密密码文件。
5.  如果您在项目中使用加密的 password.php，则进行审核，以检查该文件是否被外部触摸或查看过。发生这种情况时，您可以自动清理内存，以及关闭服务器以供访问。

* * *

## 回答 #12

> 赞同：5
> 
> 时间：2008-09-18T23:32:40.483

将数据库密码放在一个文件中，使其对提供文件的用户只读。

除非您有某种方法只允许 php 服务器进程访问数据库，否则您几乎可以做到这一点。

* * *

## 回答 #13

> 赞同：4
> 
> 时间：2008-09-18T23:35:09.243

如果您谈论的是数据库密码，而不是来自浏览器的密码，标准做法似乎是将数据库密码放在服务器上的 PHP 配置文件中。

您只需要确保包含密码的 php 文件对其具有适当的权限。即它应该只能由网络服务器和您的用户帐户读取。

* * *

## 回答 #14

> 赞同：4
> 
> 时间：2008-09-18T23:35:47.840

只需将其放入某个配置文件中就是通常的做法。只要确保你：

1.  禁止从网络外的任何服务器访问数据库，
2.  注意不要意外地向用户显示密码（在错误消息中，或通过 PHP 文件意外地作为 HTML 提供，等等。）

* * *

## 回答 #15

> 赞同：4
> 
> 时间：2008-09-19T13:08:18.530

另一个技巧是使用 PHP 单独的配置文件，如下所示：

```
<?php exit() ?>

[...]

Plain text data including password 
```

这不会妨碍您正确设置访问规则。但是如果您的网站被黑客入侵，“require”或“include”只会在第一行退出脚本，因此更难获取数据。

尽管如此，永远不要将配置文件放在可以通过 Web 访问的目录中。您应该有一个“Web”文件夹，其中包含您的控制器代码、css、图片和 js。就这样。其他任何内容都在脱机文件夹中。

* * *

## 回答 #16

> 赞同：2
> 
> 时间：2008-09-20T21:17:12.403

最好的方法是根本不存储密码！
例如，如果您在 Windows 系统上并连接到 SQL Server，则可以使用集成身份验证使用当前进程的身份连接到数据库而无需密码。

如果您确实需要使用密码连接，请先对其**进行加密**，使用强加密（例如使用 AES-256，然后保护加密密钥，或使用非对称加密并让操作系统保护证书），然后将其存储在具有**强 ACL**的配置文件（在 web 目录之外）。

* * *

## 回答 #17

> 赞同：0
> 
> 时间：2020-12-28T10:08:20.380

实际上，最佳做法是将数据库凭据存储在环境变量中，因为：

*   这些凭据取决于环境，这意味着您在 dev/prod 中不会拥有相同的凭据。将它们存储在所有环境的同一个文件中是错误的。
*   凭据**与业务逻辑**无关，这意味着登录名和密码与您的代码无关。
*   您可以在不创建任何业务代码类文件的情况下设置环境变量，这意味着您永远不会犯将凭证文件添加到 Git 中的提交的错误。
*   环境变量是超全局变量：您可以在代码中的任何地方使用它们，而无需包含任何文件。

**如何使用它们？**

*   使用 $_ENV 数组：
    *   环境 ：`$_ENV['MYVAR'] = $myvar`
    *   [得到](https://www.php.net/manual/en/reserved.variables.environment.php)：`echo $_ENV["MYVAR"]`
*   使用 php 函数：
    *   使用[putenv 函数](https://www.php.net/manual/en/function.putenv.php)设置-`putenv("MYVAR=$myvar");`
    *   使用[getenv 函数](https://www.php.net/manual/en/function.getenv.php)-`getenv('MYVAR');`
*   [在 vhosts 文件和 .htaccess](https://stackoverflow.com/questions/17550223/set-an-environment-variable-in-htaccess-and-retrieve-it-in-php)中，但不建议这样做，因为它在另一个文件中，并且无法通过这种方式解决问题。

您可以轻松地删除一个包含所有环境变量的文件，例如 envvars.php，然后执行它 ( `php envvars.php`) 并删除它。这有点老派，但它仍然有效，并且您在服务器中没有任何包含您的凭据的文件，您的代码中也没有凭据。由于它有点费力，框架做得更好。

**Symfony 的示例（好吧，不仅仅是 PHP）** 现代框架如 Symfony 建议使用环境变量，并将它们存储在 .env 未提交的文件中或直接存储在命令行中，这意味着您可以这样做：

*   [使用 CLI](https://symfony.com/doc/current/cloud/cookbooks/env.html)：`symfony var:set FOO=bar --env-level`
*   [使用 .env 或 .env.local](https://symfony.com/doc/current/configuration/env_var_processors.html)： FOO="bar"

文档：

# c++ - 切换 if-else 语句的优势

> ID：97987
> 
> 赞同：178
> 
> 时间：2008-09-18T23:28:23.800
> 
> 标签：c++, if-statement, optimization, switch-statement

`switch`使用语句与使用`if`语句进行 30 个枚举的最佳实践是什么，`unsigned`其中大约 10 个具有预期的操作（目前是相同的操作）。需要考虑性能和空间，但并不重要。我已经抽象了这个片段，所以不要因为命名约定而讨厌我。

`switch`陈述：

```
// numError is an error enumeration type, with 0 being the non-error case
// fire_special_event() is a stub method for the shared processing

switch (numError)
{  
  case ERROR_01 :  // intentional fall-through
  case ERROR_07 :  // intentional fall-through
  case ERROR_0A :  // intentional fall-through
  case ERROR_10 :  // intentional fall-through
  case ERROR_15 :  // intentional fall-through
  case ERROR_16 :  // intentional fall-through
  case ERROR_20 :
  {
     fire_special_event();
  }
  break;

  default:
  {
    // error codes that require no additional action
  }
  break;       
} 
```

`if`陈述：

```
if ((ERROR_01 == numError)  ||
    (ERROR_07 == numError)  ||
    (ERROR_0A == numError)  || 
    (ERROR_10 == numError)  ||
    (ERROR_15 == numError)  ||
    (ERROR_16 == numError)  ||
    (ERROR_20 == numError))
{
  fire_special_event();
} 
```

* * *

## 回答 #1

> 赞同：174
> 
> 时间：2008-09-18T23:32:46.613

使用开关。

在最坏的情况下，编译器将生成与 if-else 链相同的代码，因此您不会丢失任何内容。如果有疑问，请将最常见的情况首先放入 switch 语句中。

在最好的情况下，优化器可能会找到更好的方法来生成代码。编译器所做的常见事情是构建二叉决策树（在一般情况下保存比较和跳转）或简单地构建一个跳转表（根本不进行比较）。

* * *

## 回答 #2

> 赞同：45
> 
> 时间：2008-09-24T20:01:19.853

对于您在示例中提供的特殊情况，最清晰的代码可能是：

```
if (RequiresSpecialEvent(numError))
    fire_special_event(); 
```

显然这只是将问题转移到代码的不同区域，但现在您有机会重用此测试。对于如何解决它，您还有更多选择。您可以使用 std::set，例如：

```
bool RequiresSpecialEvent(int numError)
{
    return specialSet.find(numError) != specialSet.end();
} 
```

我并不是说这是 RequiresSpecialEvent 的最佳实现，只是它是一个选项。您仍然可以使用 switch 或 if-else 链，或查找表，或对值进行一些位操作，等等。你的决策过程变得越模糊，你就会从一个独立的函数中获得更多的价值。

* * *

## 回答 #3

> 赞同：25
> 
> 时间：2008-09-19T16:12:55.857

切换**速度**更快。

只需在一个循环中尝试 if/else-ing 30 个不同的值，然后使用 switch 将其与相同的代码进行比较，看看 switch 的速度有多快。

现在，**交换机有一个真正的问题**：交换机必须在编译时知道每种情况下的值。这意味着以下代码：

```
// WON'T COMPILE
extern const int MY_VALUE ;

void doSomething(const int p_iValue)
{
    switch(p_iValue)
    {
       case MY_VALUE : /* do something */ ; break ;
       default : /* do something else */ ; break ;
    }
} 
```

不会编译。

然后大多数人将使用定义（Aargh！），而其他人将在同一编译单元中声明和定义常量变量。例如：

```
// WILL COMPILE
const int MY_VALUE = 25 ;

void doSomething(const int p_iValue)
{
    switch(p_iValue)
    {
       case MY_VALUE : /* do something */ ; break ;
       default : /* do something else */ ; break ;
    }
} 
```

所以，最终，开发者必须在“速度+清晰度”与“代码耦合”之间做出选择。

（并不是说开关不能写得令人困惑……我目前看到的大多数开关都属于这种“令人困惑”的类别”……但这是另一个故事……）

> **编辑 2008-09-21：**
> 
> [bk1e](https://stackoverflow.com/users/8090/bk1e)添加了以下注释：“**在头文件中将常量定义为枚举是另一种处理方式”。**
> 
> 当然是的。
> 
> extern 类型的意义在于将值与源解耦。将此值定义为宏、简单的 const int 声明，甚至是枚举，都会产生内联值的副作用。因此，如果定义、枚举值或 const int 值发生变化，则需要重新编译。extern 声明意味着在值变化的情况下不需要重新编译，但另一方面，使得无法使用 switch。结论是**Using switch 将增加 switch 代码和用作 case 的变量之间的耦合**。没问题的时候再用switch。如果不是，那就不足为奇了。

.

> **编辑 2013-01-15：**
> 
> [Vlad Lazarenko](https://stackoverflow.com/users/405725/vlad-lazarenko)对我的回答发表了评论，并提供了一个链接，指向他对开关生成的汇编代码的深入研究。非常有启发性：http: [//lazarenko.me/switch/](http://lazarenko.me/switch/)

* * *

## 回答 #4

> 赞同：18
> 
> 时间：2008-09-18T23:30:31.953

编译器无论如何都会对其进行优化 - 选择开关，因为它是最易读的。

* * *

## 回答 #5

> 赞同：6
> 
> 时间：2008-09-18T23:30:52.717

Switch，如果只是为了可读性。在我看来，巨大的 if 语句更难维护，也更难阅读。

**ERROR_01** : // 故意掉线

或者

**(ERROR_01 == numError) ||**

后者比第一个更容易出错，并且需要更多的打字和格式化。

* * *

## 回答 #6

> 赞同：6
> 
> 时间：2008-09-24T19:26:06.647

代码可读性。如果您想知道什么性能更好，请使用分析器，因为优化和编译器各不相同，而且性能问题很少出现在人们认为的地方。

* * *

## 回答 #7

> 赞同：6
> 
> 时间：2015-09-02T14:37:11.837

编译器真的很擅长优化`switch`。最近的 gcc 也擅长优化`if`.

[我在godbolt](https://goo.gl/lYmM1Q)上做了一些测试用例。

当`case`值组合在一起时，gcc、clang 和 icc 都足够聪明，可以使用位图来检查一个值是否是特殊值之一。

例如 gcc 5.2 -O3 编译`switch`到（和`if`非常相似的东西）：

```
errhandler_switch(errtype):  # gcc 5.2 -O3
    cmpl    $32, %edi
    ja  .L5
    movabsq $4301325442, %rax   # highest set bit is bit 32 (the 33rd bit)
    btq %rdi, %rax
    jc  .L10
.L5:
    rep ret
.L10:
    jmp fire_special_event() 
```

请注意，位图是即时数据，因此没有潜在的数据缓存未命中访问它或跳转表。

gcc 4.9.2 -O3 将 编译`switch`为位图，但`1U<<errNumber`使用 mov/shift 编译。它将`if`版本编译为一系列分支。

```
errhandler_switch(errtype):  # gcc 4.9.2 -O3
    leal    -1(%rdi), %ecx
    cmpl    $31, %ecx    # cmpl $32, %edi  wouldn't have to wait an extra cycle for lea's output.
              # However, register read ports are limited on pre-SnB Intel
    ja  .L5
    movl    $1, %eax
    salq    %cl, %rax   # with -march=haswell, it will use BMI's shlx to avoid moving the shift count into ecx
    testl   $2150662721, %eax
    jne .L10
.L5:
    rep ret
.L10:
    jmp fire_special_event() 
```

请注意它是如何减去 1 的`errNumber`（`lea`将该操作与移动相结合）。这使它可以将位图适合 32 位立即数，避免`movabsq`需要更多指令字节的 64 位立即数。

更短的（机器代码）序列是：

```
 cmpl    $32, %edi
    ja  .L5
    mov     $2150662721, %eax
    dec     %edi   # movabsq and btq is fewer instructions / fewer Intel uops, but this saves several bytes
    bt     %edi, %eax
    jc  fire_special_event
.L5:
    ret 
```

* * *

（使用失败`jc fire_special_event`无处不在，并且是[编译器错误](https://gcc.gnu.org/bugzilla/show_bug.cgi?id=42497#c3)。）

`rep ret`为了旧的 AMD K8 和 K10（推土机之前）的利益，用于分支目标和以下条件分支：[“rep ret”是什么意思？](https://stackoverflow.com/questions/20526361/what-does-rep-ret-mean). 没有它，分支预测在那些过时的 CPU 上就无法正常工作。

`bt`带有寄存器 arg 的（位测试）很快。它结合了将 1 左移一位`errNumber`和执行 a 的工作`test`，但仍然是 1 个周期延迟并且只有一个 Intel uop。使用内存 arg 很慢，因为它的方式过于 CISC 语义：对于“位字符串”的内存操作数，要测试的字节的地址是根据另一个 arg（除以 8）计算的，并且是不限于内存操作数指向的 1、2、4 或 8 字节块。

从[Agner Fog 的指令表](http://agner.org/optimize/)中，可变计数移位指令比`bt`最近的 Intel 上的要慢（2 uop 而不是 1，并且 shift 并不能做其他所有需要的事情）。

* * *

## 回答 #8

> 赞同：5
> 
> 时间：2008-09-24T20:54:31.863

使用 switch，它是它的用途和程序员所期望的。

不过，我会将多余的案例标签放入其中——只是为了让人们感到舒服，我试图记住何时/什么规则将它们排除在外。
你不希望下一个开发它的程序员不得不对语言细节做任何不必要的思考（几个月后可能就是你了！）

* * *

## 回答 #9

> 赞同：2
> 
> 时间：2008-09-18T23:31:11.797

IMO 这是一个完美的例子，说明了切换失败的目的。

* * *

## 回答 #10

> 赞同：2
> 
> 时间：2008-09-18T23:33:49.467

它们同样工作得很好。给定现代编译器，性能大致相同。

我更喜欢 if 语句而不是 case 语句，因为它们更易读、更灵活——您可以添加其他不基于数值相等的条件，例如“|| max < min”。但是对于您在此处发布的简单案例，这并不重要，只需做对您来说最易读的事情。

* * *

## 回答 #11

> 赞同：1
> 
> 时间：2008-09-18T23:30:56.523

我不确定最佳实践，但我会使用 switch - 然后通过“默认”捕获故意的失败

* * *

## 回答 #12

> 赞同：1
> 
> 时间：2008-09-18T23:31:35.773

如果您的案例将来可能会保持分组状态（如果多个案例对应一个结果），则转换可能会更易于阅读和维护。

* * *

## 回答 #13

> 赞同：1
> 
> 时间：2008-09-18T23:34:21.587

switch 绝对是首选。查看开关的案例列表并确定它在做什么比阅读长 if 条件更容易。

这种情况下的重复`if`对眼睛来说很难。假设其中一个`==`是写的`!=`；你会注意到吗？或者，如果“numError”的一个实例写成“nmuError”，而恰好编译？

我通常更喜欢使用多态性而不是 switch，但是如果没有更多的上下文细节，很难说。

至于性能，最好的办法是使用分析器来测量应用程序在与您在野外所期望的条件相似的条件下的性能。否则，您可能会在错误的位置和错误的方式进行优化。

* * *

## 回答 #14

> 赞同：1
> 
> 时间：2008-09-18T23:47:15.270

我同意交换机解决方案的紧凑性，但 IMO 你在这里**劫持了交换机**。
开关的目的是根据值进行**不同的处理。**
如果你必须用伪代码解释你的算法，你会使用 if，因为从语义上讲，这就是它的本质：**if whatever_error do this** ...
所以除非你打算有一天改变你的代码，为每个错误提供特定的代码，我会使用**if**。

* * *

## 回答 #15

> 赞同：1
> 
> 时间：2008-09-24T20:46:11.027

从美学上讲，我倾向于这种方法。

```
unsigned int special_events[] = {
    ERROR_01,
    ERROR_07,
    ERROR_0A,
    ERROR_10,
    ERROR_15,
    ERROR_16,
    ERROR_20
 };
 int special_events_length = sizeof (special_events) / sizeof (unsigned int);

 void process_event(unsigned int numError) {
     for (int i = 0; i < special_events_length; i++) {
         if (numError == special_events[i]) {
             fire_special_event();
             break;
          }
     }
  } 
```

让数据更智能一点，这样我们就可以让逻辑更笨一点。

我意识到它看起来很奇怪。这是灵感（来自我在 Python 中的做法）：

```
special_events = [
    ERROR_01,
    ERROR_07,
    ERROR_0A,
    ERROR_10,
    ERROR_15,
    ERROR_16,
    ERROR_20,
    ]
def process_event(numError):
    if numError in special_events:
         fire_special_event() 
```

* * *

## 回答 #16

> 赞同：1
> 
> 时间：2010-09-30T21:18:51.430

```
while (true) != while (loop) 
```

可能第一个是由编译器优化的，这可以解释为什么第二个循环在增加循环计数时会变慢。

* * *

## 回答 #17

> 赞同：1
> 
> 时间：2021-03-01T20:52:45.187

很抱歉不同意当前接受的答案。这是 2021 年。现代编译器及其优化器不应再区分`switch`等价`if`链。如果他们仍然这样做，并且为任一变体创建优化不佳的代码，则写信给编译器供应商（或在此处公开，这具有更高的受尊重变化），但不要让微优化影响您的编码风格。

所以，如果你使用：

```
switch (numError) { case ERROR_A: case ERROR_B: ... } 
```

或者：

```
if(numError == ERROR_A || numError == ERROR_B || ...) { ... } 
```

或者：

```
template<typename C, typename EL>
bool has(const C& cont, const EL& el) {
    return std::find(cont.begin(), cont.end(), el) != cont.end();
}

constexpr std::array errList = { ERROR_A, ERROR_B, ... };
if(has(errList, rnd)) { ... } 
```

不应该对执行速度产生影响。但是根据您正在从事的项目，它们可能会在编码清晰度和代码可维护性方面产生重大影响。例如，如果您必须在代码的许多地方检查某个错误列表，那么模板`has()`可能更容易维护，因为 errList 只需要在一个地方更新。

谈到当前的编译器，我已经编译了下面引用的测试代码`clang++ -O3 -std=c++1z`（版本 10 和 11）和`g++ -O3 -std=c++1z`. 两个 clang 版本都给出了类似的编译代码和执行时间。所以我从现在开始只谈论版本 11。最值得注意的是，`functionA()`(which uses `if`) 和`functionB()`(which uses `switch`) 使用 ! 生成完全相同的汇编程序输出`clang`。并`functionC()`使用跳台，尽管许多其他海报认为跳台是`switch`. 然而，尽管许多人认为跳转表是最优的，但这实际上是最慢的解决方案`clang`：需要比or`functionC()`多 20% 的执行时间。`functionA()``functionB()`

手动优化的版本`functionH()`是迄今为止最快的`clang`。它甚至部分展开循环，在每个循环上进行两次迭代。

实际上，`clang`计算了在`functionH()`、`functionA()`和中明确提供的位域`functionB()`。但是，它在 and 中使用了条件分支`functionA()`，`functionB()`这使得这些分支变得很慢，因为分支预测经常失败，而它`adc`在`functionH()`. 虽然它未能在其他变体中应用这种明显的优化，但我不知道。

生成的代码`g++`看起来比 - 复杂得多，`clang`但实际上运行速度要`functionA()`快一些，对于`functionC()`. 在非手动优化的函数中，`functionC()`是最快的`g++`，比`clang`. 相反，`functionH()`编译时需要两倍的执行时间`g++`而不是 with `clang`，主要是因为`g++`不进行循环展开。

以下是详细结果：

```
clang:
functionA: 109877 3627
functionB: 109877 3626
functionC: 109877 4192
functionH: 109877 524

g++:
functionA: 109877 3337
functionB: 109877 4668
functionC: 109877 2890
functionH: 109877 982 
```

如果常量在整个代码`32`中更改为，则性能会发生巨大变化：`63`

```
clang:
functionA: 106943 1435
functionB: 106943 1436
functionC: 106943 4191
functionH: 106943 524

g++:
functionA: 106943 1265
functionB: 106943 4481
functionC: 106943 2804
functionH: 106943 1038 
```

加速的原因是，如果测试的最高值是 63，编译器会删除一些不必要的绑定检查，因为`rnd`无论如何， 的值都绑定到 63。请注意，删除绑定检查后，未优化的`functionA()`using simple `if()`on`g++`执行速度几乎与 hand-optimized 一样快`functionH()`，并且它还产生相当相似的汇编器输出。

结论是什么？如果您大量手动优化和测试编译器，您将获得最快的解决方案。任何假设是否`switch`更好`if`，都是无效的——它们在`clang`. 并且检查值的易于编码的解决方案`array`实际上是最快的情况`g++`（如果省略手动优化和按事件匹配列表的最后一个值）。

未来的编译器版本会越来越好地优化你的代码，越来越接近你的手工优化。所以不要在这上面浪费你的时间，除非周期对你来说真的很重要。

这里是测试代码：

```
#include <iostream>
#include <chrono>
#include <limits>
#include <array>
#include <algorithm>

unsigned long long functionA() {
    unsigned long long cnt = 0;

    for(unsigned long long i = 0; i < 1000000; i++) {
        unsigned char rnd = (((i * (i >> 3)) >> 8) ^ i) & 63;
        if(rnd == 1 || rnd == 7 || rnd == 10 || rnd == 16 ||
           rnd == 21 || rnd == 22 || rnd == 63)
        {
            cnt += 1;
        }
    }

    return cnt;
}

unsigned long long functionB() {
    unsigned long long cnt = 0;

    for(unsigned long long i = 0; i < 1000000; i++) {
        unsigned char rnd = (((i * (i >> 3)) >> 8) ^ i) & 63;
        switch(rnd) {
        case 1:
        case 7:
        case 10:
        case 16:
        case 21:
        case 22:
        case 63:
            cnt++;
            break;
        }
    }

    return cnt;
}

template<typename C, typename EL>
bool has(const C& cont, const EL& el) {
    return std::find(cont.begin(), cont.end(), el) != cont.end();
}

unsigned long long functionC() {
    unsigned long long cnt = 0;
    constexpr std::array errList { 1, 7, 10, 16, 21, 22, 63 };

    for(unsigned long long i = 0; i < 1000000; i++) {
        unsigned char rnd = (((i * (i >> 3)) >> 8) ^ i) & 63;
        cnt += has(errList, rnd);
    }

    return cnt;
}

// Hand optimized version (manually created bitfield):
unsigned long long functionH() {
    unsigned long long cnt = 0;

    const unsigned long long bitfield =
        (1ULL << 1) +
        (1ULL << 7) +
        (1ULL << 10) +
        (1ULL << 16) +
        (1ULL << 21) +
        (1ULL << 22) +
        (1ULL << 63);

    for(unsigned long long i = 0; i < 1000000; i++) {
        unsigned char rnd = (((i * (i >> 3)) >> 8) ^ i) & 63;
        if(bitfield & (1ULL << rnd)) {
            cnt += 1;
        }
    }

    return cnt;
}

void timeit(unsigned long long (*function)(), const char* message)
{
    unsigned long long mintime = std::numeric_limits<unsigned long long>::max();
    unsigned long long fres = 0;

    for(int i = 0; i < 100; i++) {
        auto t1 = std::chrono::high_resolution_clock::now();
        fres = function();
        auto t2 = std::chrono::high_resolution_clock::now();

        auto duration = std::chrono::duration_cast<std::chrono::microseconds>(t2 - t1).count();
        if(duration < mintime) {
            mintime = duration;
        }
    }

    std::cout << message << fres << " " << mintime << std::endl;
}

int main(int argc, char* argv[]) {
    timeit(functionA, "functionA: ");
    timeit(functionB, "functionB: ");
    timeit(functionC, "functionC: ");
    timeit(functionH, "functionH: ");
    timeit(functionA, "functionA: ");
    timeit(functionB, "functionB: ");
    timeit(functionC, "functionC: ");
    timeit(functionH, "functionH: ");
    timeit(functionA, "functionA: ");
    timeit(functionB, "functionB: ");
    timeit(functionC, "functionC: ");
    timeit(functionH, "functionH: ");

    return 0;
} 
```

* * *

## 回答 #18

> 赞同：0
> 
> 时间：2008-09-18T23:31:30.330

为了清晰和约定，我会选择 if 语句，尽管我相信有些人会不同意。毕竟，你想做某事，`if`某些条件是真的！用一个动作切换似乎有点……不必要。

* * *

## 回答 #19

> 赞同：0
> 
> 时间：2008-09-18T23:31:48.003

我不是告诉您速度和内存使用情况的人，但是查看 switch 语句比大型 if 语句更容易理解（尤其是 2-3 个月后）

* * *

## 回答 #20

> 赞同：0
> 
> 时间：2008-09-18T23:37:34.607

我会说使用SWITCH。这样你只需要实现不同的结果。您的十个相同案例可以使用默认值。如果您只需要进行一项更改就是显式实施更改，则无需编辑默认值。从 SWITCH 添加或删除案例也比编辑 IF 和 ELSEIF 容易得多。

```
switch(numerror){
    ERROR_20 : { fire_special_event(); } break;
    default : { null; } break;
} 
```

甚至可以根据可能性列表（在这种情况下为 numerror）测试您的条件（在这种情况下为 numerror），可能是一个数组，因此您的 SWITCH 甚至不会被使用，除非肯定会有结果。

* * *

## 回答 #21

> 赞同：0
> 
> 时间：2008-09-19T13:18:15.497

看到你只有 30 个错误代码，编写你自己的跳转表，然后你自己做出所有优化选择（跳转总是最快的），而不是希望编译器会做正确的事情。它还使代码非常小（除了跳转表的静态声明）。它还有一个附带的好处，即使用调试器，您可以根据需要在运行时修改行为，只需直接戳表数据即可。

* * *

## 回答 #22

> 赞同：0
> 
> 时间：2009-11-23T13:50:48.653

我知道它很旧，但是

```
public class SwitchTest {
static final int max = 100000;

public static void main(String[] args) {

int counter1 = 0;
long start1 = 0l;
long total1 = 0l;

int counter2 = 0;
long start2 = 0l;
long total2 = 0l;
boolean loop = true;

start1 = System.currentTimeMillis();
while (true) {
  if (counter1 == max) {
    break;
  } else {
    counter1++;
  }
}
total1 = System.currentTimeMillis() - start1;

start2 = System.currentTimeMillis();
while (loop) {
  switch (counter2) {
    case max:
      loop = false;
      break;
    default:
      counter2++;
  }
}
total2 = System.currentTimeMillis() - start2;

System.out.println("While if/else: " + total1 + "ms");
System.out.println("Switch: " + total2 + "ms");
System.out.println("Max Loops: " + max);

System.exit(0);
}
} 
```

改变循环计数变化很大：

While if/else: 5ms Switch: 1ms Max Loops: 100000

While if/else: 5ms Switch: 3ms Max Loops: 1000000

While if/else: 5ms Switch: 14ms Max Loops: 10000000

While if/else: 5ms Switch: 149ms Max Loops: 100000000

（如果需要，添加更多语句）

* * *

## 回答 #23

> 赞同：0
> 
> 时间：2017-02-23T03:39:48.260

到编译程序的时候，不知道有没有什么区别。但至于程序本身以及代码尽量简单，我个人认为还是要看你想做什么。if else if else 语句有其优点，我认为是：

允许您针对特定范围测试变量，您可以使用函数（标准库或个人）作为条件。

（例子：

```
`int a;
 cout<<"enter value:\n";
 cin>>a;

 if( a > 0 && a < 5)
   {
     cout<<"a is between 0, 5\n";

   }else if(a > 5 && a < 10)

     cout<<"a is between 5,10\n";

   }else{

       "a is not an integer, or is not in range 0,10\n"; 
```

但是，If else if else 语句可能会很快变得复杂和混乱（尽管您已尽了最大努力）。Switch 语句往往更清晰、更简洁、更易于阅读；但只能用于针对特定值进行测试（例如：

```
`int a;
 cout<<"enter value:\n";
 cin>>a;

 switch(a)
 {
    case 0:
    case 1:
    case 2: 
    case 3:
    case 4:
    case 5:
        cout<<"a is between 0,5 and equals: "<<a<<"\n";
        break;
    //other case statements
    default:
        cout<<"a is not between the range or is not a good value\n"
        break; 
```

我更喜欢 if - else if - else 语句，但这完全取决于你。如果您想使用函数作为条件，或者您想针对范围、数组或向量进行测试和/或您不介意处理复杂的嵌套，我建议您使用 If else if else 块。如果您想针对单个值进行测试，或者您想要一个干净且易于阅读的块，我建议您使用 switch() 案例块。**************