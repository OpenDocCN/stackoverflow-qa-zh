# StackOverflow 问答 000824000-000824999

# javascript - JavaScript 文本节点更新

> ID：824000
> 
> 赞同：2
> 
> 时间：2009-05-05T09:08:05.050
> 
> 标签：javascript, dom, innerhtml, createtextnode

如果我有一个

```
var t = document.createTextNode(text)
parent.appendChild(t); 
```

是否可以简单地更新内容`t`？

我想在`parent`不使用`removeChild`,`createTextNode`和的情况下更改里面的文本`appendChild`。为什么我需要这个而不是仅仅使用`innerHTML`？因为我不想用 HTML 代码更新元素的内容，并且`text`可能包含特殊字符，例如应该由`TextNode`DOM 方法解析的 < 或 &。

谢谢，
汤姆

* * *

## 回答 #1

> 赞同：11
> 
> 时间：2009-05-05T09:24:21.843

请注意，相邻的文本节点会合并为一个（因为实际上无法区分两个相邻的文本节点）。

文本节点的内容可以使用它的`nodeValue`属性进行更新（参见[MDC](https://developer.mozilla.org/En/DOM/Node.nodeValue)）。

由于定义的文本节点不能包含任何标记，因此没有`innerHTML`属性。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2009-05-05T09:17:23.360

如果您保留 TextNode 对象的实例（示例代码中的 t），那么您可以使用各种函数（如 replaceData()、substringData() 等）更改内容。

请参阅此页面以获得很好的参考： http: [//msdn.microsoft.com/en-us/library/ms535905 (VS.85).aspx#](http://msdn.microsoft.com/en-us/library/ms535905(VS.85).aspx#)

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2009-05-05T09:31:20.237

```
parent.innerText = text; 
```

# c# - 在 C# 中同步接口和实现注释的方法

> ID：824007
> 
> 赞同：102
> 
> 时间：2009-05-05T09:10:09.600
> 
> 标签：c#, documentation, xml-documentation

是否有自动方法在接口及其实现之间同步注释？我目前正在记录它们，并且不想手动使它们保持同步。

更新：

考虑这段代码：

```
interface IFoo{
    /// <summary>
    /// Commenting DoThis method
    /// </summary>
    void DoThis();
}
class Foo : IFoo {
    public void DoThis();
} 
```

当我这样创建类时：

```
IFoo foo=new Foo();
foo.DoThis();//comments are shown in intellisense 
```

这里没有显示评论：

```
Foo foo=new Foo();
foo.DoThis();//comments are not shown in intellisense 
```

该`<inheritDoc/>`标签将完美地在 Sand Castle 中生成文档，但在智能感知工具提示中不起作用。

请分享你的想法。

谢谢。

* * *

## 回答 #1

> 赞同：64
> 
> 时间：2009-05-05T09:21:54.207

`inheritdoc`您可以使用 Microsoft Sandcastle（或 NDoc）标签很容易地做到这一点。规范并未正式支持它，但自定义标签是完全可以接受的，而且微软在创建 Sandcastle 时确实选择从 NDoc 复制这个（以及一两个其他标签）。

```
/// <inheritdoc/>
/// <remarks>
/// You can still specify all the normal XML tags here, and they will
/// overwrite inherited ones accordingly.
/// </remarks>
public void MethodImplementingInterfaceMethod(string foo, int bar)
{
    //
} 
```

[这](http://www.ewoodruff.us/shfbdocs/html/79897974-ffc9-4b84-91a5-e50c66a0221d.htm)是 Sandcastle Help File Builder GUI 的帮助页面，它完整地描述了它的用法。

（当然，正如您的问题所提到的，这并不是专门的“同步”，但它似乎正是您正在寻找的。）

作为一个注释，这听起来对我来说是一个非常公平的想法，尽管我观察到有些人认为你应该总是在派生类和实现类中重新指定注释。（实际上，我自己在记录我的一个库时已经完成了，我没有发现任何问题。）评论几乎总是没有理由完全不同，那么为什么不只是继承并以简单的方式去做呢？

**编辑：**关于您的更新，Sandcastle 也可以为您处理。Sandcastle 可以输出它用于输入的实际 XML 文件的修改版本，这意味着您可以将*这个修改版本*与您的库 DLL 一起分发，而不是由 Visual Studio 直接构建的版本，这意味着您可以在智能感知以及文档文件（CHM，等等）。

* * *

## 回答 #2

> 赞同：14
> 
> 时间：2009-05-05T09:20:07.423

如果您还没有使用它，我强烈推荐一个名为[GhostDoc](http://www.roland-weigelt.de/ghostdoc/)的免费 Visual Studio 插件。它简化了文档过程。看看[我](https://stackoverflow.com/questions/461306/how-to-document-thrown-exceptions-in-c-net/461515#461515)对一个有点相关的问题的评论。

虽然 GhostDoc 不会自动进行同步，但它可以帮助您解决以下情况：

您有一个记录在案的接口方法。在一个类中实现这个接口，按下 GhostDoc 快捷键，`Ctrl-Shift-D`，接口中的 XML 注释将被添加到实现的方法中。

转到**选项-> 键盘**设置，然后分配一个键`GhostDoc.AddIn.RebuildDocumentation`（我用过`Ctrl-Shift-Alt-D`）。 [![替代文字](https://i.stack.imgur.com/zh77x.png)](https://i.stack.imgur.com/zh77x.png)

*现在，如果你改变了界面*上的 XML 注释，只需在实现的方法上按下这个快捷键，文档就会更新。不幸的是，反之亦然。

* * *

## 回答 #3

> 赞同：7
> 
> 时间：2009-05-05T09:14:01.650

我通常会这样写评论：

```
/// <summary>
/// Implements <see cref="IMyInterface.Foo(string, int)"/>
/// </summary>
/// <returns></returns> 
```

这些方法仅由接口使用，因此在编码时甚至不会在工具提示中显示此注释。

**编辑：**

如果你想在直接调用类*而不*使用接口的情况下查看文档，则需要编写两次或使用 GhostDoc 之类的工具。

* * *

## 回答 #4

> 赞同：4
> 
> 时间：2009-05-05T09:15:37.060

试试[GhostDoc](http://www.roland-weigelt.de/ghostdoc/)！这个对我有用 ：-）

**编辑：**既然我已经知道 Sandcastle 对 的支持`<inheritdoc/>`，我支持 Noldorin 的帖子。这是一个更好的解决方案。不过，我仍然普遍推荐 GhostDoc。

* * *

## 回答 #5

> 赞同：2
> 
> 时间：2009-07-03T18:45:39.763

*我有一个更好的答案：**FiXml**。*, 我是它的作者之一

克隆当然是可行的方法，但它有很大的缺点，例如：

*   当原始注释被更改时（在开发过程中经常发生），它的克隆不会。
*   你正在产生大量的重复。如果您使用任何源代码分析工具（例如 Team City 中的 Duplicate Finder），它将主要找到您的评论。

*如前所述，[Sandcastle](http://blogs.msdn.com/sandcastle/)`<inheritdoc>`中有标签*，但与 FiXml 相比，它几乎没有缺点：

*   Sandcastle 生成已编译的 HTML 帮助文件 - 通常它不会修改 `.xml`包含提取的 XML 注释的文件（最后，这不能在编译期间“即时”完成）。
*   Sandcastle 的实现没有那么强大。例如，不是 `<see ... copy="true" />`。

有关详细信息，请参阅[Sandcastle 的`<inheritdoc>`描述](http://www.ewoodruff.us/shfbdocs/html/79897974-ffc9-4b84-91a5-e50c66a0221d.htm)。

FiXml 的简短描述：它是由 C#\Visual Basic .Net 生成的 XML 文档的后处理器。它是作为 MSBuild 任务实现的，因此很容易将其集成到任何项目中。它解决了一些与用这些语言编写 XML 文档相关的烦人案例：

*   **不支持从基类或接口继承文档。**即任何被覆盖的成员的文档都应该从头开始编写，尽管通常至少继承它的一部分是非常可取的。
*   **不支持插入常用的文档模板**，例如“这种类型是单例的 - 使用它的`<see cref="Instance" />`属性来获取它的唯一实例。”，甚至“初始化一个新的`<CurrentType>`类实例”。</li>

为了解决上述问题，提供了以下附加 XML 标记：

*   `<inheritdoc />, <inherited />`标签
*   `<see cref="..." copy="..." />``<see/>`标签中的属性。

这是[它的网页](http://wiki.dataobjects.net/index.php?title=FiXml)和[下载页面](http://www.x-tensive.com/Downloads/?Path=Freeware%5CXtensive.MSBuildTasks)。

* * *

## 回答 #6

> 赞同：1
> 
> 时间：2009-05-05T09:24:26.853

```
/// <inheritDoc/> 
```

[在这里阅读](http://sandcastle.codeplex.com/Thread/View.aspx?ThreadId=22873&ANCHOR)

[用这个](http://www.codeplex.com/SHFB)

* * *

## 回答 #7

> 赞同：1
> 
> 时间：2017-12-20T22:42:33.800

我构建了一个库来对 XML 文档文件进行后处理，以添加对 <inheritdoc/> 标记的支持。

虽然它对源代码中的 Intellisense 没有帮助，但它确实允许将修改后的 XML 文档文件包含在 NuGet 包中，因此可以在引用的 NuGet 包中与 Intellisense 一起使用。

更多信息请访问[www.inheritdoc.io](https://www.inheritdoc.io/)（提供免费版本）。

* * *

## 回答 #8

> 赞同：0
> 
> 时间：2009-05-05T09:13:35.957

不要那样做。这样想——如果要求两条评论始终相同，则不需要其中一条。评论必须有一个原因（除了某种奇怪的义务来评论阻止每个函数和变量）所以你需要弄清楚那个独特的原因是什么并记录下来。

* * *

## 回答 #9

> 赞同：0
> 
> 时间：2009-05-05T09:45:14.213

使用 ReSharper，您可以复制它，但我不认为它一直是同步的。

# java - 为现有代码中的常量创建静态导入的简单方法？

> ID：824011
> 
> 赞同：36
> 
> 时间：2009-05-05T09:11:36.227
> 
> 标签：java, eclipse

如果我在 Foo 中有一个常量 BAR，我将在 C 类中使用它，我将不得不编写

```
Object o = Foo.BAR + "..."; 
```

我可以在 Eclipse 中使用 Ctrl-Shift-M（将光标放在 BAR 上）来创建静态导入，例如：

```
import static Foo.BAR;

Object o = BAR + "...."; 
```

我目前正在更新旧代码，其中有数千个我想转换为静态导入。Ctrl-Shift-O / 组织导入不这样做。有没有我错过的技巧？

* * *

编辑：实际上，我更喜欢告诉 Eclipse 我想让 Ctrl-Shift-M 在这个特定类中的所有实例上发挥它的魔力，而不仅仅是我放置光标的单个实例。（这是遗留代码，所以这实际上提高了可读性:)）

* * *

编辑：我发现 IntelliJ 建议这样做。

* * *

## 回答 #1

> 赞同：9
> 
> 时间：2009-05-05T09:17:03.920

一个警告：过度使用静态导入实际上会使您的代码可读性降低（恕我直言），特别是如果常量名称没有清楚地表明它所属的类或枚举。您还可以从听起来相似甚至具有相同名称的不同类/枚举中获取常量名称。

所以你强迫读者做的是希望他的 IDE 会告诉他这个类（例如，通过一个工具提示），或者他们必须导航到它以找出它是什么。打印输出和代码片段变得不那么可读了。

老实说，由于这些原因，我很少使用静态导入。

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2009-05-05T10:49:33.183

我不知道任何其他自动重构来做你正在寻找的东西，但是这样做有两个关键方面 - 一个是添加导入，另一个是从常量中删除类名。

`import static application.KeyHolder.*;`为了添加导入，我建议在使用它们的每个文件的包之后粘贴。

要删除类名，请在 Eclipse 中执行 Java 搜索`KeyHolder.*`并搜索字段。然后，您可以查找/替换“KeyHolder”。并替换为“”。为了防止不匹配，请确保替换的项目数等于该文件的匹配数。此外，请确保您在导入后向下搜索并开始。

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2009-05-05T10:35:32.627

正则表达式被发明来解决这些问题！=)

您将需要编写一个小脚本（或使用 IDE 正则表达式搜索/替换）。唯一的问题是，如果有很多类需要静态导入，那么它的工作量也是一样的。否则，如果它只是像 FOO.BLAH 这样的一个类，那么你可以使用像这样的正则表达式

`(\bFOO\.(\w+)\b)`-> 替换为第 2 组（$2 或 \2 或者您的正则表达式搜索器确实捕获替换）。

你可以在这里试试：[http](http://www.gskinner.com/RegExr/) ://www.gskinner.com/RegExr/ 。选择替换选项卡并输入 $2

如果你有这样的表达式，可能会出现问题: `FOO f = FOO.blah + "FOO.blah"`，所以要小心。

至于文件顶部的导入语句，eclipse 有一个自动导入功能，它会自动导入格式，只要导入的名称足够独特，它就可以工作。或者，如果由于名称太常见而无法使用它，则可以只使用 perl 脚本来执行正则表达式，并预先添加静态导入。

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2009-07-06T14:43:03.393

Eclipse 可以对项目中的所有文件进行全局搜索并用正则表达式替换。

要在所有文件的开头添加静态导入，您可以将包声明本身替换为静态导入。

然后在项目范围内组织导入，一切就绪。

但是要小心，如果你做错了，这也可能会造成很大的混乱。

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2009-07-07T06:00:19.317

听起来是个好主意，但是在您更改了所有文件之后，它们会好多少？也许您应该考虑只更改由于其他原因而正在处理的文件。

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2009-07-04T19:13:17.360

如果我面临这样的挑战，我可能会编写一个小程序来为我做这件事。Ruby 和 Python（JRuby 和 Jython？）非常适合这项任务，尽管您也可以在 Java 中完成。

好的，所以这可能会花费您至少与手工操作相同的时间，但至少您会玩得开心:)。

* * *

## 回答 #7

> 赞同：-1
> 
> 时间：2009-07-06T08:02:59.767

好吧，作为解决方案出现的东西。我建议使用一个简单的 groovy 脚本。基本上，语义与解析导入语句及其引用的文件有关。一些基本步骤可能像

1.  递归目录中的每个文件。检查文件扩展名是否为.java
2.  匹配任何以 import 开头的行
3.  对于每个这样的行，打开相关的源文件（您已经知道 import 语句中的路径）。
4.  使用反射匹配静态修饰符的字段/方法声明
5.  在步骤 5 中找到的匹配项的导入语句之后添加静态。

如果我有时间，我会尝试发布一个小的 groovy 脚本来做同样的事情。

* * *

## 回答 #8

> 赞同：-2
> 
> 时间：2015-09-19T07:19:35.183

确保与其他常量类没有冲突

替换所有“Foo”。空（“”）

在顶部使用这一行。为我工作

导入静态 Foo.*

* * *

## 回答 #9

> 赞同：-3
> 
> 时间：2009-07-06T21:39:49.010

我不知道它是否符合您的需求，但您始终可以在接口中定义这些常量，并让您的所有类都实现这个接口。然后像其他人建议的那样使用一些智能 RegExp 可以摆脱所有出现的情况`Foo.`。

例子：

```
public interface Foo {
   static final String constant1 = "Some";
   static final String constant2 = "Value";
   //...
} 
```

接着

```
public class YourClass implements Foo {
   public YourClass() {
      System.out.println("Hello " + constant1);
   }
} 
```

# .net - 如何使 TableLayoutPanel 中的所有列自动调整为完全相同的宽度？

> ID：824012
> 
> 赞同：4
> 
> 时间：2009-05-05T09:11:38.677
> 
> 标签：.net, winforms, tablelayoutpanel

我正在尝试创建一个相当广泛的 UserControl，将方形控件合并到设计中，并允许调整大小。因为设计需要正方形，所以我需要 TableLayoutPanels 中的所有列具有相同的宽度，以便包含的停靠控件也是正方形的。

不幸的是，TableLayoutPanel 的行为并没有给我这个结果。
使用所有列设置为使用相同百分比的 Control 的 TableLayoutPanel 给出（在一组 7 列中）6 列等宽和第 7 列宽度可变。
我知道发生这种情况是因为每 7 种尺寸中有 6 种，在 7 列周围共享的列像素数量不相等，而第 7 列是这种不等式的溢出。

我想我想要的是第 8 列，它占用其他 7 列的溢出，允许所有 7 个“真实”列具有真正相等的宽度，但允许第 8 列的宽度为 0 .
到目前为止，我找不到允许这种行为的设置。

谁能告诉我如何让 TableLayoutPanel 做我想做的事，还是我必须开始编写很多解决方法代码？

编辑：

作为对 Yacoder 的回答，我添加了一些代码来演示该问题，而另一个代码显示了使用 TableLayoutPanel 和 Dock 属性的标准功能来解决它​​的不成功的、幼稚的尝试

问题演示：

```
Public Class Form1
Inherits System.Windows.Forms.Form
Public Sub New()
    Me.InitializeComponent()
End Sub
'Form overrides dispose to clean up the component list.
<System.Diagnostics.DebuggerNonUserCode()> _
Protected Overrides Sub Dispose(ByVal disposing As Boolean)
    Try
        If disposing AndAlso components IsNot Nothing Then
            components.Dispose()
        End If
    Finally
        MyBase.Dispose(disposing)
    End Try
End Sub

'Required by the Windows Form Designer
Private components As System.ComponentModel.IContainer

'NOTE: The following procedure is required by the Windows Form Designer
'It can be modified using the Windows Form Designer.  
'Do not modify it using the code editor.
<System.Diagnostics.DebuggerStepThrough()> _
Private Sub InitializeComponent()
    Me.TableLayoutPanel1 = New System.Windows.Forms.TableLayoutPanel
    Me.SuspendLayout()
    '
    'TableLayoutPanel1
    '
    Me.TableLayoutPanel1.CellBorderStyle = System.Windows.Forms.TableLayoutPanelCellBorderStyle.[Single]
    Me.TableLayoutPanel1.ColumnCount = 7
    Me.TableLayoutPanel1.ColumnStyles.Add(New System.Windows.Forms.ColumnStyle(System.Windows.Forms.SizeType.Percent, 14.28571!))
    Me.TableLayoutPanel1.ColumnStyles.Add(New System.Windows.Forms.ColumnStyle(System.Windows.Forms.SizeType.Percent, 14.28572!))
    Me.TableLayoutPanel1.ColumnStyles.Add(New System.Windows.Forms.ColumnStyle(System.Windows.Forms.SizeType.Percent, 14.28572!))
    Me.TableLayoutPanel1.ColumnStyles.Add(New System.Windows.Forms.ColumnStyle(System.Windows.Forms.SizeType.Percent, 14.28572!))
    Me.TableLayoutPanel1.ColumnStyles.Add(New System.Windows.Forms.ColumnStyle(System.Windows.Forms.SizeType.Percent, 14.28572!))
    Me.TableLayoutPanel1.ColumnStyles.Add(New System.Windows.Forms.ColumnStyle(System.Windows.Forms.SizeType.Percent, 14.28572!))
    Me.TableLayoutPanel1.ColumnStyles.Add(New System.Windows.Forms.ColumnStyle(System.Windows.Forms.SizeType.Percent, 14.28572!))
    Me.TableLayoutPanel1.Dock = System.Windows.Forms.DockStyle.Fill
    Me.TableLayoutPanel1.Location = New System.Drawing.Point(0, 0)
    Me.TableLayoutPanel1.Name = "TableLayoutPanel1"
    Me.TableLayoutPanel1.RowCount = 7
    Me.TableLayoutPanel1.RowStyles.Add(New System.Windows.Forms.RowStyle(System.Windows.Forms.SizeType.Percent, 14.28571!))
    Me.TableLayoutPanel1.RowStyles.Add(New System.Windows.Forms.RowStyle(System.Windows.Forms.SizeType.Percent, 14.28571!))
    Me.TableLayoutPanel1.RowStyles.Add(New System.Windows.Forms.RowStyle(System.Windows.Forms.SizeType.Percent, 14.28571!))
    Me.TableLayoutPanel1.RowStyles.Add(New System.Windows.Forms.RowStyle(System.Windows.Forms.SizeType.Percent, 14.28571!))
    Me.TableLayoutPanel1.RowStyles.Add(New System.Windows.Forms.RowStyle(System.Windows.Forms.SizeType.Percent, 14.28571!))
    Me.TableLayoutPanel1.RowStyles.Add(New System.Windows.Forms.RowStyle(System.Windows.Forms.SizeType.Percent, 14.28571!))
    Me.TableLayoutPanel1.RowStyles.Add(New System.Windows.Forms.RowStyle(System.Windows.Forms.SizeType.Percent, 14.28571!))
    Me.TableLayoutPanel1.Size = New System.Drawing.Size(261, 264)
    Me.TableLayoutPanel1.TabIndex = 0
    '
    'Form1
    '
    Me.AutoScaleDimensions = New System.Drawing.SizeF(6.0!, 13.0!)
    Me.AutoScaleMode = System.Windows.Forms.AutoScaleMode.Font
    Me.ClientSize = New System.Drawing.Size(261, 264)
    Me.Controls.Add(Me.TableLayoutPanel1)
    Me.Name = "Form1"
    Me.Text = "Form1"
    Me.ResumeLayout(False)

End Sub
Friend WithEvents TableLayoutPanel1 As System.Windows.Forms.TableLayoutPanel
Private labelList As List(Of Label)
Protected Overrides Sub OnLoad(ByVal e As System.EventArgs)
    MyBase.OnLoad(e)
    labelList = New List(Of Label)
    For JJ As Integer = 0 To Me.TableLayoutPanel1.ColumnCount - 1
        For II As Integer = 0 To Me.TableLayoutPanel1.RowCount - 1
            Dim addLabel As New Label
            Me.TableLayoutPanel1.Controls.Add(addLabel, JJ, II)
            addLabel.Dock = DockStyle.Fill
            Me.labelList.Add(addLabel)
        Next
    Next
End Sub
Private Sub TableLayoutPanel1_Resize(ByVal sender As Object, ByVal e As System.EventArgs) Handles TableLayoutPanel1.Resize
    If Me.labelList IsNot Nothing Then
        For Each labelIn As Label In Me.labelList
            labelIn.Text = labelIn.Width.ToString & ", " & labelIn.Height.ToString
        Next
    End If
End Sub
End Class 
```

天真的解决方案：

```
Public Class Form1
Inherits System.Windows.Forms.Form
Public Sub New()
    Me.InitializeComponent()
End Sub
'Form overrides dispose to clean up the component list.
<System.Diagnostics.DebuggerNonUserCode()> _
Protected Overrides Sub Dispose(ByVal disposing As Boolean)
    Try
        If disposing AndAlso components IsNot Nothing Then
            components.Dispose()
        End If
    Finally
        MyBase.Dispose(disposing)
    End Try
End Sub

'Required by the Windows Form Designer
Private components As System.ComponentModel.IContainer

'NOTE: The following procedure is required by the Windows Form Designer
'It can be modified using the Windows Form Designer.  
'Do not modify it using the code editor.
<System.Diagnostics.DebuggerStepThrough()> _
Private Sub InitializeComponent()
    Me.TableLayoutPanel1 = New System.Windows.Forms.TableLayoutPanel
    Me.SuspendLayout()
    '
    'TableLayoutPanel1
    '
    Me.TableLayoutPanel1.CellBorderStyle = System.Windows.Forms.TableLayoutPanelCellBorderStyle.[Single]
    Me.TableLayoutPanel1.ColumnCount = 8
    Me.TableLayoutPanel1.ColumnStyles.Add(New System.Windows.Forms.ColumnStyle(System.Windows.Forms.SizeType.Percent, 14.28571!))
    Me.TableLayoutPanel1.ColumnStyles.Add(New System.Windows.Forms.ColumnStyle(System.Windows.Forms.SizeType.Percent, 14.28572!))
    Me.TableLayoutPanel1.ColumnStyles.Add(New System.Windows.Forms.ColumnStyle(System.Windows.Forms.SizeType.Percent, 14.28572!))
    Me.TableLayoutPanel1.ColumnStyles.Add(New System.Windows.Forms.ColumnStyle(System.Windows.Forms.SizeType.Percent, 14.28572!))
    Me.TableLayoutPanel1.ColumnStyles.Add(New System.Windows.Forms.ColumnStyle(System.Windows.Forms.SizeType.Percent, 14.28572!))
    Me.TableLayoutPanel1.ColumnStyles.Add(New System.Windows.Forms.ColumnStyle(System.Windows.Forms.SizeType.Percent, 14.28572!))
    Me.TableLayoutPanel1.ColumnStyles.Add(New System.Windows.Forms.ColumnStyle(System.Windows.Forms.SizeType.Percent, 14.28572!))
    Me.TableLayoutPanel1.ColumnStyles.Add(New System.Windows.Forms.ColumnStyle(System.Windows.Forms.SizeType.Percent, 0.0!))
    Me.TableLayoutPanel1.Dock = System.Windows.Forms.DockStyle.Fill
    Me.TableLayoutPanel1.Location = New System.Drawing.Point(0, 0)
    Me.TableLayoutPanel1.Name = "TableLayoutPanel1"
    Me.TableLayoutPanel1.RowCount = 8
    Me.TableLayoutPanel1.RowStyles.Add(New System.Windows.Forms.RowStyle(System.Windows.Forms.SizeType.Percent, 14.28571!))
    Me.TableLayoutPanel1.RowStyles.Add(New System.Windows.Forms.RowStyle(System.Windows.Forms.SizeType.Percent, 14.28571!))
    Me.TableLayoutPanel1.RowStyles.Add(New System.Windows.Forms.RowStyle(System.Windows.Forms.SizeType.Percent, 14.28571!))
    Me.TableLayoutPanel1.RowStyles.Add(New System.Windows.Forms.RowStyle(System.Windows.Forms.SizeType.Percent, 14.28571!))
    Me.TableLayoutPanel1.RowStyles.Add(New System.Windows.Forms.RowStyle(System.Windows.Forms.SizeType.Percent, 14.28571!))
    Me.TableLayoutPanel1.RowStyles.Add(New System.Windows.Forms.RowStyle(System.Windows.Forms.SizeType.Percent, 14.28571!))
    Me.TableLayoutPanel1.RowStyles.Add(New System.Windows.Forms.RowStyle(System.Windows.Forms.SizeType.Percent, 14.28571!))
    Me.TableLayoutPanel1.RowStyles.Add(New System.Windows.Forms.RowStyle(System.Windows.Forms.SizeType.Percent, 0.0!))
    Me.TableLayoutPanel1.Size = New System.Drawing.Size(261, 264)
    Me.TableLayoutPanel1.TabIndex = 0
    '
    'Form1
    '
    Me.AutoScaleDimensions = New System.Drawing.SizeF(6.0!, 13.0!)
    Me.AutoScaleMode = System.Windows.Forms.AutoScaleMode.Font
    Me.ClientSize = New System.Drawing.Size(261, 264)
    Me.Controls.Add(Me.TableLayoutPanel1)
    Me.Name = "Form1"
    Me.Text = "Form1"
    Me.ResumeLayout(False)

End Sub
Friend WithEvents TableLayoutPanel1 As System.Windows.Forms.TableLayoutPanel
Private labelList As List(Of Label)
Protected Overrides Sub OnLoad(ByVal e As System.EventArgs)
    MyBase.OnLoad(e)
    labelList = New List(Of Label)
    For JJ As Integer = 0 To Me.TableLayoutPanel1.ColumnCount - 1
        For II As Integer = 0 To Me.TableLayoutPanel1.RowCount - 1
            Dim addLabel As New Label
            Me.TableLayoutPanel1.Controls.Add(addLabel, JJ, II)
            addLabel.Dock = DockStyle.Fill
            Me.labelList.Add(addLabel)
        Next
    Next
End Sub
Private Sub TableLayoutPanel1_Resize(ByVal sender As Object, ByVal e As System.EventArgs) Handles TableLayoutPanel1.Resize
    If Me.labelList IsNot Nothing Then
        For Each labelIn As Label In Me.labelList
            labelIn.Text = labelIn.Width.ToString & ", " & labelIn.Height.ToString
        Next
    End If
End Sub
End Class 
```

对于这段代码在重绘时的糟糕表现，我深表歉意。

* * *

## 回答 #1

> 赞同：11
> 
> 时间：2009-05-20T18:38:32.587

也许我不太明白这个问题，但是......这就是我所做的：

1.  创建新表格
2.  在表单上放置一个 TableLayoutPanel，并设置 Dock = Fill
3.  在表单设计窗口（如果您使用 VS）中，单击 TableLayoutPanel 上的小箭头以打开包含任务的菜单并转到“编辑行和列...”
4.  在该窗口中，根据需要添加任意数量的列，并将所有列设置为占整个大小的“百分比”，并在任何地方放置相同的数字。您可以输入任何数字，只要确保相同，VS 会自动使总和等于 100%。

而且......它应该可以工作，至少当我调整这种形式的大小时，我看到所有列都一起调整大小......

如果您不在 VS 中，或者该方法有问题，这是我在 Designer 类中自动生成的代码：

```
 this.tableLayoutPanel1.ColumnCount = 7;
    this.tableLayoutPanel1.ColumnStyles.Add(new System.Windows.Forms.ColumnStyle(System.Windows.Forms.SizeType.Percent, 14.28571F));
    this.tableLayoutPanel1.ColumnStyles.Add(new System.Windows.Forms.ColumnStyle(System.Windows.Forms.SizeType.Percent, 14.28571F));
    this.tableLayoutPanel1.ColumnStyles.Add(new System.Windows.Forms.ColumnStyle(System.Windows.Forms.SizeType.Percent, 14.28571F));
    this.tableLayoutPanel1.ColumnStyles.Add(new System.Windows.Forms.ColumnStyle(System.Windows.Forms.SizeType.Percent, 14.28571F));
    this.tableLayoutPanel1.ColumnStyles.Add(new System.Windows.Forms.ColumnStyle(System.Windows.Forms.SizeType.Percent, 14.28571F));
    this.tableLayoutPanel1.ColumnStyles.Add(new System.Windows.Forms.ColumnStyle(System.Windows.Forms.SizeType.Percent, 14.28571F));
    this.tableLayoutPanel1.ColumnStyles.Add(new System.Windows.Forms.ColumnStyle(System.Windows.Forms.SizeType.Percent, 14.28571F)); 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-05-29T17:32:39.210

我已尝试在我的环境中进行设置，并阅读您的帖子大约 6 或 7 次，但我无法确定您到底想要做什么。我有 6 列停靠了 SWF GroupBox 对象，这些对象停靠以填充设置为相同 % 宽度的列，因此我可以轻松地看到它们调整大小。我还将第 7 列设置为 0px 绝对宽度以用作溢出。这正如我所期望的那样工作。

我无法确定此设置有什么问题和/或您试图让它做什么。您能否更好地描述您需要 TableLayoutPanel 做什么？

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2014-03-25T19:50:37.370

```
public MainForm()
{
    TableLayoutPanel pnlDragAndDrop = new TableLayoutPanel();

    // make the panel full width
    pnlDragAndDrop.Dock = DockStyle.Fill;

    // be sure to add columns and rows explicitly!
    pnlDragAndDrop.ColumnCount = 2;
    pnlDragAndDrop.RowCount = 1;

    // add a border just for testing
    pnlDragAndDrop.CellBorderStyle = 
        TableLayoutPanelCellBorderStyle.InsetDouble;
    pnlDragAndDrop.CellPaint += 
        new TableLayoutCellPaintEventHandler(TblLayoutPanel_CellPaint);

    // add a column style for each column!
    for (int i = 0; i < pnlDragAndDrop.ColumnCount * pnlDragAndDrop.RowCount; ++i)
    {
        pnlDragAndDrop.ColumnStyles.Add(new ColumnStyle(SizeType.Percent, 50F));
    }

    // add the panel to the form
    this.Controls.Add(pnlDragAndDrop);
}

private void TblLayoutPanel_CellPaint(object sender, TableLayoutCellPaintEventArgs e)
{
    // Add a border around each cell
    e.Graphics.DrawLine(
        Pens.Black, 
        e.CellBounds.Location, 
        new Point(e.CellBounds.Right, e.CellBounds.Top)
        );
} 
```

# cakephp - 如何在 CakePHP 中更新登录用户记录？

> ID：824017
> 
> 赞同：0
> 
> 时间：2009-05-05T09:12:49.220
> 
> 标签：cakephp, login

我是 CakePHP 和框架的新手，我试图用谷歌搜索答案，但没有任何运气。

我正在使用空白 login() 函数并希望能够更改登录时的用户记录（如 last_login）。我怎样才能做到这一点？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-05-20T04:05:09.450

如果您使用的是 Cake 的 Auth 组件，首先您必须将以下行插入到 beforeFilter 函数中：

```
$this->Auth->autoRedirect = false; 
```

将此设置为 false 将允许在 CakePHP 的登录功能完成其魔力后执行以下代码。

在您的登录功能中添加：

```
if ($this->Auth->User()) {
$this->User->id = $this->Auth->user('id');
$this->User->saveField('last_login', date('Y-m-d H:i:s'));
} 
```

注意：确保您的用户表中有 last_login 字段并将其设置为日期时间。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-05-05T15:31:03.180

我相信即使将 autoRedirect 设置为 true，您也可以向 login() 函数添加内容。我在隐式重定向方面遇到了一些问题（用户请求受限资源，必须登录，然后被重定向），所以我在登录函数中添加了一些代码。似乎工作正常，并且还调用了自动登录功能。

我会说只是继续添加一些逻辑来登录，看看它是否适合你。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-06-22T11:49:53.610

我喜欢的一种模式是在 User 模型中创建一个 afterLogin() 挂钩。因此，在您的 UsersController 中创建如下内容：

```
function beforeFilter() {
    $this->Auth->autoRedirect = false;
    parent::beforeFilter();
}

function login() {
    if($this->Auth->User()) {
        if(!$this->User->afterLogin($this->Auth->User())) {
            return $this->logout();
        }

        $this->redirect($this->Auth->redirect());
    }
} 
```

然后在用户模型中创建：

```
function afterLogin($User) {
    // perform actions on $User here

    return true; // return false to halt login
} 
```

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2009-05-05T10:09:48.897

假设您使用的是内置`AuthComponent`应用程序，您需要在控制器中设置以下属性：

```
$this->Auth->autoRedirect = false; 
```

这将使您能够使用您的`login()`功能（和`logout()`）来做事。有关当前登录用户的信息可通过

```
$this->Auth->user() 
```

然后，您可以使用此数据对该用户做任何您想做的事情。

作为一个无耻的自我宣传，我建议你看看[我的开源项目](http://dsi.vozibrale.com/articles/view/neutrinocms-0-1-beta-has-been-released)，我正在使用这种技术来创建一个“记住我”的 cookie。

# maven-2 - Maven 2.1.0 未将系统属性传递给 Java 虚拟机

> ID：824019
> 
> 赞同：38
> 
> 时间：2009-05-05T09:13:22.090
> 
> 标签：maven-2, jvm, maven-plugin, surefire, system-properties

在 Linux机器上运行[Hudson](http://en.wikipedia.org/wiki/Hudson_%28software%29)构建时，我们使用命令行将系统属性传递给 Java 虚拟机。它曾经在 2.0.9 中运行良好，但自从我们升级到 2.1.0 后，它已经完全停止运行。系统属性永远不会进入 Java 虚拟机。

我创建了一个小型测试项目，实际上它根本不起作用。

这应该适用于[Maven](http://en.wikipedia.org/wiki/Apache_Maven) 2.0.9：

```
mvn2.0.9 -Dsystem.test.property=test test 
```

但这会失败：

```
mvn2.1 -Dsystem.test.property=test test 
```

Java 代码就是这样做的

```
assertTrue( System.getProperty("system.test.property") != null); 
```

* * *

## 回答 #1

> 赞同：54
> 
> 时间：2009-05-05T09:14:41.603

我认为这在 Maven 或 Surefire 插件中都不是问题。否则，万无一失的行为会有所不同。现在看起来，当 Surefire 分叉[JVM](http://en.wikipedia.org/wiki/Java_Virtual_Machine)时，不会从父 JVM 获取所有系统属性。

这就是为什么您应该使用 argLine 为测试传递所需的任何系统属性。所以，这两个都应该工作

```
mvn2.1 -Dsystem.test.property=test test -DforkMode=never 
```

或者

```
mvn2.1 test -DargLine="-Dsystem.test.property=test" 
```

* * *

## 回答 #2

> 赞同：13
> 
> 时间：2009-05-15T17:54:10.183

我在[Surefire](http://maven.apache.org/plugins/maven-surefire-plugin/)插件中体验过这一点。Surefire 插件在由 Maven 启动的不同 JVM 实例下运行。命令行参数可在 pom.xml 中的 surefile-plugin 配置下进行配置。这是我们的配置示例。

```
 <plugin>
            <groupId>org.apache.maven.plugins</groupId>
            <artifactId>maven-surefire-plugin</artifactId>
            <version>2.4.3</version>
            <!--
                    By default, the Surefire Plugin will automatically include all test classes with the following wildcard patterns:
                    "**/Test*.java" - includes all of its subdirectory and all java filenames that start with "Test". "**/*Test.java" -
                    includes all of its subdirectory and all java filenames that end with "Test". "**/*TestCase.java" - includes all of
                    its subdirectory and all java filenames that end with "TestCase".
                -->
            <configuration>
                <includes>
                    <include>**/*Test.java</include>
                </includes>
                <systemProperties>
                    <property>
                        <name>app.env</name>
                        <value>dev</value>
                    </property>
                     <property>
                        <name>oracle.net.tns_admin</name>
                        <value>${oracle.net.tns_admin}</value>
                    </property>
                </systemProperties>
            </configuration>
        </plugin> 
```

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2010-07-15T13:03:10.787

注意不要将配置文件与命令行参数混淆。配置文件 (pom.xml) 覆盖所有 cmd 参数。所以不要在 pom.xml 中配置 surefire 插件，如果你想像 raisercostin 解释的那样通过命令行传递它。

# .net - 如何将 xsl 样式表节点添加到 XmlSerializer 生成的 XML？

> ID：824024
> 
> 赞同：6
> 
> 时间：2009-05-05T09:14:35.567
> 
> 标签：.net, wcf, web-services, rest, xslt

我有一个 WCF REST 服务，它返回使用 XmlSerializer 序列化的对象。如何将 XSL 样式表信息（如下所示）添加到 WCF 服务返回的输出中？

```
<?xml version="1.0" encoding="utf-8"?>
<?xml-stylesheet type="text/xsl" href="transforms/Customer.xsl"?>
<Customer>
    <Name>Foo</Name>
</Customer> 
```

我目前的操作合同：

```
[操作合同，XmlSerializerFormat]
[WebGet(UriTemplate = "{id}")]
客户 GetById( 字符串 id );

```

为了控制样式表引用，我希望能够做些什么：

```
[OperationContract, XmlSerializerFormat]
 [XslStylesheet(Href = "transforms/Customer.xsl")]
[WebGet(UriTemplate = "{id}")]
客户 GetById( 字符串 id );

```

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2009-05-05T18:32:56.707

[这篇文章](http://shevaspace.blogspot.com/2009/01/include-xml-declaration-in-wcf-restful.html)描述了如何引入一个`[IncludeXmlDeclaration]`属性。您应该能够为您的 XslStylesheet 属性进行类似的操作。

# c - 如何在c程序中进行串行通信？

> ID：824029
> 
> 赞同：-1
> 
> 时间：2009-05-05T09:15:54.703
> 
> 标签：c, serial-port, serial-communication

使用 vc++ 编译器如何访问串口。Bioscom() 函数可以在 Turbo C 中使用。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-05-05T09:32:11.513

你必须像这样打开适当的 com 设备`CreateFile`。适应您的需求。

```
// Handle of the communication connection 
void *comHandle;

// Port parameters, set to your own needs
unsigned portIndex;
unsigned baudRate;
unsigned dataBits;
Parity   parity;
unsigned stopBits;
bool     handShake;
int      readIntervalTimeout;
int      readTotalTimeoutMultiplier;
int      readTotalTimeoutConstant;
int      writeTotalTimeoutMultiplier;
int      writeTotalTimeoutConstant;
DCB dcb;
COMMTIMEOUTS ct;

// Create COM-device name string 
char comDevice[20];
sprintf(comDevice, "\\\\.\\COM%d", portIndex);

// Open serial port
_comHandle = CreateFile(comDevice, GENERIC_READ | GENERIC_WRITE, 0, NULL, OPEN_EXISTING, 0, NULL);
if (comHandle == INVALID_HANDLE_VALUE)
{
  return false;
}

ct.ReadIntervalTimeout         = readIntervalTimeout;        
ct.ReadTotalTimeoutMultiplier  = readTotalTimeoutMultiplier; 
ct.ReadTotalTimeoutConstant    = readTotalTimeoutConstant;   
ct.WriteTotalTimeoutMultiplier = writeTotalTimeoutMultiplier;
ct.WriteTotalTimeoutConstant   = writeTotalTimeoutConstant;  

if (!GetCommState(_comHandle,&dcb))
{
  disconnect();
  return false;
}

dcb.BaudRate        = baudRate;  
dcb.ByteSize        = (BYTE)dataBits;
dcb.Parity          = (parity == None) ? NOPARITY : ((parity == Even) ? EVENPARITY : ODDPARITY);
dcb.StopBits        = (stopBits > 1) ? TWOSTOPBITS : ONESTOPBIT;
dcb.fRtsControl     = handShake ? RTS_CONTROL_HANDSHAKE : RTS_CONTROL_ENABLE;
dcb.fOutxCtsFlow    = handShake;
dcb.fOutxDsrFlow    = handShake;
dcb.fDtrControl     = handShake ? DTR_CONTROL_HANDSHAKE : DTR_CONTROL_ENABLE;
dcb.fDsrSensitivity = handShake;
dcb.fOutX           = FALSE;
dcb.fInX            = FALSE;
dcb.fErrorChar      = FALSE;
dcb.fNull           = FALSE;
dcb.fAbortOnError   = TRUE;

// Set port state
if( !SetCommState(_omHandle, &dcb) ||
    !SetCommTimeouts(comHandle, &ct) ||
    !SetupComm(comHandle, 64, 64) ||
    !PurgeComm(comHandle, PURGE_TXABORT | PURGE_RXABORT | PURGE_TXCLEAR | PURGE_RXCLEAR))
{
  disconnect();
  return false;
} 
```

阅读调用的各种函数的相应 MSDN 条目。另外，出于简洁的原因，我省略了断开连接的方法。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2009-05-05T09:35:27.480

它们是 Code Project 中关于[与 C++ 进行串行通信](http://www.codeproject.com/info/search.aspx?artkw=serial+port)的许多文章。这是返回的第一[篇文章](http://www.codeproject.com/KB/system/serial.aspx)。您基本上可以通过文件 I/O 操作访问端口。这有点复杂，我建议为此任务找到合适的库。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2009-05-05T09:18:52.433

[Microsoft 开发人员网络上的此页面](http://msdn.microsoft.com/en-us/library/ms810467.aspx)介绍了如何在 Windows 中使用串行端口，我假设这是您想要定位的环境，具体取决于您选择的编译器。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2009-05-05T09:23:45.667

bios 功能仅在您使用 MSDOS 或非常旧的 Windows 版本（并且特定于 Turbo C）时可用。对于现代版本的 Windows，您将需要使用 OS API 来执行串行 I/O。

# c# - 如何将 VS2003 项目转换为 VS2005 项目

> ID：824030
> 
> 赞同：0
> 
> 时间：2009-05-05T09:16:18.837
> 
> 标签：c#, visual-studio, visual-studio-2005

嗨，我有一个测试项目，我需要从 VS2003 转换为 VS2005，恐怕我收到了很多错误和警告。

主要出现的错误是**错误C2220：警告视为错误 - 没有生成'对象'文件**
相同的项目将在VS2003中编译并执行良好。我能做什么？？？

提前致谢

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2009-07-31T06:56:43.700

我猜你已经转换了一个或多个 C++ 项目。VS2005 编译器比 VS2003 更严格；您突然在使用 VS2003 编译好的项目中收到警告。你只需要修复警告，然后你会没事的。如果您将警告文本添加到您的问题中，我可能会告诉您如何解决它。

问候，

塞巴斯蒂安

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-05-05T09:52:40.857

尝试创建一个新的 2005 解决方案并添加头文件和源文件并编译。如果是这样，您可以查看错误是否发生在代码或项目本身上。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-05-05T10:07:20.710

试着在你的问题中提供一些细节，你会在答案中得到更多细节。

这是一个 ASP.NET 项目吗？你在运行 VS2005 SP1 吗？

确保 VS 没有为您创建网站“项目”。他们在 VS2005 中引入了这种废话，然后在 SP1 中重新添加了 Web 应用程序项目。确保您正在运行 SP1。

# c# - 自定义依赖属性

> ID：824031
> 
> 赞同：1
> 
> 时间：2009-05-05T09:16:18.917
> 
> 标签：c#, wpf, dependency-properties

我想创建一个具有 2 个选项（左和右）的 DependencyProperty，类似于 TextBlock 中的 LeftAlignment 等属性。

有谁知道与此相关的代码？到目前为止，我只创建了简单的 DependencyPropertys，如下所示：

```
public static readonly DependencyProperty AlignProperty = DependencyProperty.Register("Align", typeof(string), typeof(HalfCurvedRectangle), new FrameworkPropertyMetadata("Left", FrameworkPropertyMetadataOptions.AffectsRender | FrameworkPropertyMetadataOptions.AffectsMeasure));

[TypeConverter(typeof(StringConverter))]
public string Align
{
     get { return (string)base.GetValue(AlignProperty); }
     set { base.SetValue(AlignProperty, value); }
} 
```

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2009-05-05T09:24:12.577

只需将属性的类型设置为枚举类型而不是字符串，例如：

```
 public enum BrushTypes
    {
        Solid,
        Gradient
    }

    public BrushTypes BrushType
    {
        get { return ( BrushTypes )GetValue( BrushTypeProperty ); }
        set { SetValue( BrushTypeProperty, value ); }
    }

    public static readonly DependencyProperty BrushTypeProperty = 
               DependencyProperty.Register( "BrushType", 
                                            typeof( BrushTypes ), 
                                            typeof( MyClass ) ); 
```

# wpf - 如何在 WPF 应用程序中绘制色轮？

> ID：824032
> 
> 赞同：6
> 
> 时间：2009-05-05T09:16:50.147
> 
> 标签：wpf, transform, gradient, color-wheel

我开始使用 WPF 并想在表单上绘制[色轮。](http://en.wikipedia.org/wiki/Color_wheel)

起初我尝试在 ArcSegment 上使用 LinearGradientBrush，如下所示：

```
<Path StrokeThickness="35" Height="150" Width="150">
    <Path.Stroke>
        <LinearGradientBrush StartPoint="0,0" EndPoint="1,0">
            <GradientStop Color="Red" Offset="0.15" />
            <GradientStop Color="Orange" Offset="0.2" />
            <GradientStop Color="Yellow" Offset="0.35" />
            <GradientStop Color="Green" Offset="0.5" />
            <GradientStop Color="Blue" Offset="0.65" />
            <GradientStop Color="Indigo" Offset="0.75" />
            <GradientStop Color="Violet" Offset="0.9" />
        </LinearGradientBrush>
    </Path.Stroke>
    <Path.Data>
        <PathGeometry >
            <PathFigure IsClosed="True" StartPoint="25,70">
                <ArcSegment Point="25,71" IsLargeArc="True"
                    Size="50,50" SweepDirection="Clockwise" />
            </PathFigure>
        </PathGeometry>
    </Path.Data>
</Path> 
```

不成功，因为渐变仍然是水平的。

另一个想法是在应用渐变后我必须以某种方式弯曲线。但我找不到合适的变换。

如果没有标准转换，是否可以进行自定义转换？还是我应该按像素绘制色轮？

请有任何想法。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2011-11-26T01:11:32.950

这是 silverlight 的另一个示例：http: [//asyrovprog.host22.com/colorwheel.html](http://asyrovprog.host22.com/colorwheel.html)。源代码位于：timeline.codeplex.com 在 bsd 许可下。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2009-06-20T05:03:06.400

您正在寻找的是[Path Gradient Brush](http://msdn.microsoft.com/en-us/library/system.drawing.drawing2d.pathgradientbrush.aspx)。遗憾的是，它在 WPF 中尚不可用（但在 GDI+ 中）。也许在未来的版本中......

我确实有一个关于如何获得近似色轮的想法。

对它的高级描述是使用线性梯度（矩形），这些梯度被旋转和平移以形成一个正多边形，其厚度比所需的环宽度宽得多。然后，您从中“切出”一个环形并将其用作您的色轮。

色轮有几种主要颜色（红色、绿色、蓝色、黄色等）。您首先需要从某个任意基线定义度数测量。例如，红色的弧度为 0，蓝色的弧度为 pi，等等。您还可以定义环的内半径和外半径。使用 trig，您可以使用从您开始的颜色到下一个相邻颜色的线性渐变绕着环形绘制矩形走动。矩形的宽度必须大于环的宽度（稍后您会看到原因），并且需要旋转矩形以在其中点与圆相切。

完成后，您将拥有一个“彩色多边形”（我刚刚编造的一个术语）。然后，您可以从这个多边形中提取一个环形，就像饼干切割器对面团所做的那样。有不止一种方法可以做到这一点。只需用背景从中心到内半径绘制一个实心圆，中间部分就会消失。外面的部分会更困难。我不知道您是否可以在 WPF 中执行此操作，但您需要做的是生成一个蒙版，该蒙版是从圆环中心到外缘的圆形。这将是黑色背景上的白色圆圈。然后，您将其与图像“与”以摆脱多边形的外部。

不完美，但我怀疑它看起来很合理。很多触发！

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2017-04-23T20:04:38.117

[该库具有绘制色轮的像素着色器](https://github.com/JohanLarsson/Gu.Wpf.Geometry#hsvwheeleffect)

示例 xml：

```
<Ellipse Width="300"
         Height="300"
         Fill="White">
    <Ellipse.Effect>
        <effects:HsvWheelEffect />
    </Ellipse.Effect>
</Ellipse> 
```

请注意，椭圆必须设置有刷子`Fill`才能使用，可以是任何颜色。

# c# - C# Linq Guid 匿名类型问题

> ID：824036
> 
> 赞同：2
> 
> 时间：2009-05-05T09:17:20.003
> 
> 标签：c#, linq, linq-to-sql, guid, anonymous-types

我有一个 linq 查询，它根据问题文本返回问题的 ID。然后需要使用此 ID 将日期表中的日期与该特定问题相关联。问题已存储，日期存储在不同时间。

问题是查询将 questionID 作为匿名类型返回，因此当我需要将该 questionID 分配为另一个表中的 questionID 时，它会引发错误，说明该表需要一个 Guid。在此之后，我将匿名类型转换为字符串，然后使用 GUID 转换功能将字符串转换为 GUID，但是现在它给我的错误是 GUID 应该是 32 个字符和 4 个破折号。

我对此的想法是匿名类型将 questionID 返回为“QuestionID = jkj939-89239829- etc etc”。- 前面有字符前缀，因此在将其转换为 GUID 时，转换后的字符串包含这些字符。

我错过了什么吗？我真的不明白为什么会这样做，有没有办法删除匿名类型返回的前缀？帮助将不胜感激。

这是代码：

```
public static void GetQuesID(string quesText)
    {
        ExamineDataContext dc = new ExamineDataContext();
        var matchedques = from q in dc.GetTable<Question>()
                            where q.QuestionText.Contains(quesText)
                            select new{
                                q.QuestionID
                            };
        foreach (var element in matchedques)
        {
            MessageBox.Show(element.ToString());
        }

        try
        {
            Guid g = Guid.NewGuid();
            Table<DateLastUsed> dlused = Repository.GetDateLastUsedTable();
            DateLastUsed dlu = new DateLastUsed(); ;
            string qidGuidString = matchedques.ToString();
            Guid convQuesGuid = new Guid(qidGuidString);
            dlu.DLUID = g;
            dlu.QuestionID = convQuesGuid;
            dlu.DateLastUsed1 = DateTime.Now;

            dlused.InsertOnSubmit(dlu);
            dlused.Context.SubmitChanges();
        }
        catch (Exception ex)
        {
            throw ex;
        }
    } 
```

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2009-05-05T09:20:29.047

除非我遗漏了一些东西，否则你为什么不直接`select q.QuestionID`制作一个新的匿名类型包装器呢？

```
var matchedques = from q in dc.GetTable<Question>()
                            where q.QuestionText.Contains(quesText)
                            select q.QuestionID;

foreach (var element in matchedques)
{
    MessageBox.Show(element.ToString());
} 
```

或者，为字段命名（`theID`下面的“”）并直接访问它：

```
var matchedques = from q in dc.GetTable<Question>()
                            where q.QuestionText.Contains(quesText)
                            select new{
                                theID = q.QuestionID
                            };

foreach (var element in matchedques)
{
    MessageBox.Show(element.theID.ToString());
} 
```

* * *

显然，这个问题比我最初想象的要多。作为对评论的回应，请记住，您将返回matchques 中的结果*枚举（因此上面的 foreach，对吗？）。*所以下面这行也是错误的：

```
string qidGuidString = matchedques.ToString(); 
```

你要么想要

```
string qidGuidString = matchedques.Single().ToString(); 
```

如果matchedques 应该包含一个结果，或者如果matchedques 应该包含多个结果，则使用foreach 循环。

* * *

请注意，没有理由将 GUID 转换为字符串然后再转换回来，您还可以使用查询返回更有用的内容（即新`DateLastUsed`对象）：

```
var matchedques = from q in dc.GetTable<Question>()
                            where q.QuestionText.Contains(quesText)
                            select new DateLastUsed() {
                                DLUID = Guid.NewGuid(),
                                QuestionID = q.QuestionID,
                                DateLastUsed1 = DateTime.Now
                            };

Table<DateLastUsed> dlused = Repository.GetDateLastUsedTable();

foreach(var dlu in matchedques)
{
    dlused.InsertOnSubmit(dlu);
    dlused.Context.SubmitChanges();
} 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-05-05T09:19:53.760

为什么不直接`select q.QuestionID;`使用这个`select new { q.QuestionID };' 东西？

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2009-05-05T09:20:38.297

您在matchedques上调用 .ToString() ，这是一个枚举：

```
var matchedques = from q in dc.GetTable<Question>()
                            where q.QuestionText.Contains(quesText)
                            select new{
                                q.QuestionID
                            };

string qidGuidString = matchedques.ToString(); 
```

因此，在上面的示例中，matchedques 是匿名类型的枚举（您可能应该取消它并直接选择 q.QuestionID）。对此调用 ToString() 将返回对象的字符串表示形式，而不仅仅是序列的第一个元素的 QuestionId。

您是否期望上述查询始终只有一个结果？如果是这样，您可能应该查看 Single 运算符。

这样的事情应该做：

```
var matchedQuesId = 
    dc.GetTable<Question>()
    .Where(q =>q.QuestionText.Contains(quesText))
    .Single()
    .QuestionID; 
```

在这种情况下，您可以直接使用matchedQuesId。请注意，如果 Where 查询不匹配或匹配多个元素，则会引发错误。阅读 Single 运算符以找出原因。

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2012-02-29T23:58:41.193

尝试这个：

```
var matchedques = (from q in dc.GetTable<Question>()
                  where q.QuestionText.Contains(quesText)
                  select new{
                      q.QuestionID
                  }).FirstOrDefault(); 
```

然后简单地说：

```
if (matchedques != null){
    // Just use matchedques.QuestionID to get your value
} 
```

`FirstOrDefault`将`matchedques`var 设置为对象的单个实例，而不是它们的枚举。当您知道只有一个您想要的值时，这是一种享受。该`OrDefault`位意味着`NULL`如果什么也没找到。

* * *

## 回答 #5

> 赞同：-1
> 
> 时间：2009-05-05T09:20:32.493

改成：

```
...
var matchedques = from q in dc.GetTable<Question>()
                        where q.QuestionText.Contains(quesText)
                        select q.QuestionID; 
```

例如删除新的 {...}，因此您正在创建一个具有 id 属性的新匿名用户类型。

# javascript - 在 window.location.hash 中做子字符串

> ID：824040
> 
> 赞同：2
> 
> 时间：2009-05-05T09:19:49.233
> 
> 标签：javascript

不知何故，window.location.hash 在不同浏览器中的处理方式不同。如果我有如下网址

```
http://maps-demo.bytecraft.com.my/postdemo/parcel
    #parcel/history/1?as=json&desc[]=ctime&desc[]=history_id 
```

我有兴趣在 #parcel/history/ 和 ?as=json 之间获取值......所以子字符串语句将类似于

```
window.location.hash.substring(14, window.location.hash.search(/\?/g)); 
```

我在 Firefox 3.0.10 中可以正常工作，但相同的子字符串语句在 Opera 9.60 中不起作用。

经过一番快速搜索，我发现了一些可能会有所帮助的有趣信息

*   window.location.hash 应该总是返回 urlencoded 字符串，但这是Firefox[中的一个](https://developer.mozilla.org/en/DOM/window.location)[错误](https://bugzilla.mozilla.org/show_bug.cgi?id=378962)

> 如果 URL 的哈希部分包含编码字符（请参阅 Core_JavaScript_1.5_Reference:Global_Functions:encodeURIComponent），则哈希返回解码后的 URL 部分。这是 Firefox 中的一个错误。href、search 和 pathname 返回正确的编码 URL 部分。

*   Opera 只返回 #parcel/history/1 并忽略剩余的字符串，这是我的子字符串语句失败的主要原因......

如果我想提取 #parcel/history/ 和 ?as=json.... 除了正则表达式之间的字符串，还有更好的方法吗？！

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2009-05-05T09:56:36.650

尝试这个：

```
var match = window.location.href.match(/^[^#]+#([^?]*)\??(.*)/);
var hashPath = match[1];
var hashQuery = match[2]; 
```

这与哈希的以下部分匹配：

```
…#parcel/history/1?as=json&desc[]=ctime&desc[]=history_id
  \______________/ \____________________________________/
   hashPath         hashQuery 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-05-05T09:37:17.757

这是我目前对问题的解决方案

```
 var get_hash_end = function(_hash) {
        var result = _hash.length;

        if(_hash.search(/\?/g) != -1) {
            result = _hash.search(/\?/g);
        }

        return result;
    }; 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-05-05T09:39:47.797

您可以只使用`window.location.href`而不是哈希，但为什么不使用正则表达式？比基于字符 N 的子串的方法更可靠和未来安全。尝试：

```
window.location.href.match(/#parcel\/history\/(.*?)(\?|$)/)[1] 
```

正则表达式并非总是正确的答案，但有时它是正确的。

编辑：清理方法封装

```
function GetValue()
{
    var m = window.location.href.match(/#parcel\/history\/(.*?)(\?|$)/);
    return m ? m[1] : null;
} 
```

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2009-05-05T11:07:07.247

你也可以这样做：

var whatYouWant = window.location.hash.split('?')[0].substring(14);

# c# - 通过 linq-to-sql 插入超过 3mb 的图像

> ID：824042
> 
> 赞同：0
> 
> 时间：2009-05-05T09:19:54.600
> 
> 标签：c#, .net, silverlight, linq-to-sql, .net-3.5

新的一天，新的问题:-)

代码：
客户端：

```
void abw_Closed(object sender, EventArgs e)
{
    DbServiceClient sc = new DbServiceClient();
    abw = (AddBlobWindow)sender;
    fi = ((AddBlobWindow)sender).fi;
    if ((bool)((AddBlobWindow)sender).DialogResult)
    {
        blob = new Blob();
        binBlob = new Binary();
        binaryBlob = new byte[fi.Length];

        int n = fi.OpenRead().Read(binaryBlob,0,Convert.ToInt32(fi.Length));

        binBlob.Bytes = binaryBlob;
        blob.Content = binBlob;
        blob.Signature = abw.tbSignature.Text;
        blob.Size = (int)fi.Length;

        sc.SaveBlobCompleted += new EventHandler<AsyncCompletedEventArgs>(sc_SaveBlobCompleted);
        sc.SaveBlobAsync(blob);
        }
    } 
```

服务器端服务代码：

```
[OperationContract]
public void SaveBlob(Blob blob)
{
    try
    {
        RichTekstModelDataContext dc = new RichTekstModelDataContext();
        dc.Blobs.InsertOnSubmit(blob);
        dc.SubmitChanges();
    }
    catch (Exception ex) { string s = ex.Message; }
} 
```

问题：当我尝试保存内容字段小于 3mb 的 blob 时，它工作得很好，但是当 blob 超过 3 mb 时，我在 Referencenece.cs 文件中收到“未找到”异常（---> 错误行）

```
public void EndSaveBlob(System.IAsyncResult result) {
    object[] _args = new object[0]; 
```

----> base.EndInvoke("SaveBlob", _args, result); }

我不知道如何解决它。我在 web.config 中设置了适当的缓冲区大小，但它仍然不起作用。

感谢帮助。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2009-05-05T09:50:44.840

好的。我找到了一个解决方案：

解决方案链接：

[http://silverlight.net/forums/p/18162/61547.aspx](http://silverlight.net/forums/p/18162/61547.aspx)

# mysql - 在Mysql中选择一些东西+任意数字

> ID：824048
> 
> 赞同：0
> 
> 时间：2009-05-05T09:21:24.567
> 
> 标签：mysql, select, numbers

我有一种情况需要做类似的事情

```
select 2, id from users; 
```

我认为这至少适用于 Oracle，但它不适用于 Mysql。有任何想法吗？

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2009-05-05T09:25:49.703

我认为您需要为任意值指定一个名称：

```
SELECT 2 AS arbitrary_value, id FROM users; 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-05-05T09:25:50.670

你的要求没问题。也许您应该更准确地定义“不起作用”。

# php - 使用 PHP 安装程序安装 Pear 扩展

> ID：824050
> 
> 赞同：1
> 
> 时间：2009-05-05T09:21:50.383
> 
> 标签：php, pear

我使用[PHP 安装程序](http://www.php.net/downloads.php)安装 PHP 。因此，[不包括](http://forums.codewalkers.com/pear-packages-47/no-go-pear-bat-file-47151.html)PEAR 包。现在的问题是[我需要 PEAR](http://www.symfony-project.org/book/1_2/03-Running-Symfony)来[升级 Symfony](https://stackoverflow.com/questions/823722/move-symfony-engines-out-from-my-sandbox-application)，但是我在 Internet 上找到的资源似乎适合 PEAR 包已经包含在 PHP 包中的情况。

鉴于我使用 PHP 安装程序进行安装，安装 PEAR 扩展的最佳方法是什么？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-05-05T15:12:07.577

我解决了这个问题。

事实证明，您必须在选择 PHP 安装组件时选择扩展菜单下的 PEAR 选项才能安装 PEAR 包。

[http://lh4.ggpht.com/_SDci0Pf3tzU/SgBXLClDWEI/AAAAAAAAEuI/TgnBA_SEHFs/s400/pear%20install.jpg](http://picasaweb.google.com/lh/photo/Cmv4KsLwUiF4spw3tDzfHw?feat=embedwebsite)

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-05-05T11:30:57.407

PEAR 只是 PHP 附带的一组库，但您也可以手动安装 PEAR。

在解决 PHP 安装问题时，您可以按照[http://pear.php.net/manual/en/installation.getting.php](http://pear.php.net/manual/en/installation.getting.php)中“托管环境中的 PEAR”部分下的说明进行操作。

# vb.net - 如何使用正则表达式替换特定字符串中的非单词字符？

> ID：824052
> 
> 赞同：2
> 
> 时间：2009-05-05T09:22:44.860
> 
> 标签：vb.net, regex, replace

我有这样一行的文本文件：

```
SendersTimeSeriesIdentification: COMPANY_A/COMPANY_B/REF_7/20090505 
```

我想用字符替换值部分中的所有非单词字符`n`，如下所示：

```
SendersTimeSeriesIdentification: COMPANYnAnCOMPANYnBnREFn7n20090505 
```

但是整个文件中都有类似的字符串，它们必须保持不变。一个例子是：

```
MessageIdentification: REF_7/VER_1/20090505 
```

我想我必须使用lookbehind，我来到了这个尝试（VB.NET）：

```
Regex.Replace(fileContentString, "(?<=SendersTimeSeriesIdentification: )(\W)", "0") 
```

这不像我想要的那样工作。所以我的问题是：
是否可以用一个 Regex.Replace 调用替换特定字符串中的所有非单词字符？如何？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-05-05T09:29:15.843

我没有将文件作为单个正则表达式替换，而是将文件分成几行，然后只处理以“SendersTimeSeriesIdentification:”开头的行。这样，正则表达式替换既好又简单。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2009-05-05T09:42:23.377

试试这个：

```
Regex.Replace(fileContentString, "(?<=SendersTimeSeriesIdentification:\s.*)[_\W]", "0") 
```

This replaces all \W and _ chars with "0" after "SendersTimeSeriesIdentification: ".

# visual-studio - 黑莓开发平台

> ID：824053
> 
> 赞同：1
> 
> 时间：2009-05-05T09:23:10.710
> 
> 标签：visual-studio, eclipse, windows-mobile, blackberry, mobile

我想知道不同黑莓开发环境的优缺点。我正在尝试决定是使用 Visual Studio 还是 Eclipse。

感谢您的想法

托尼

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2009-05-05T09:32:11.000

Visual Studio 是一个 RAD 开发工具，很容易将一些代码拼凑在一起，将几个屏幕放在一起，但您无法控制正在发生的事情，也无法轻松对其进行自定义。

我更喜欢 Eclipse，因为您可以访问[RIM API](http://www.blackberry.com/developers/docs/4.3.0api/index.html)，并且您可以更好地控制正在发生的事情，例如创建自己的控件、自定义菜单和访问手机中的更多功能。

在各种论坛上，[http://www.blackberryforums.com/developer-forum/](http://www.blackberryforums.com/developer-forum/)或[例如http://supportforums.blackberry.com/rim/board?board.id=java_dev](http://supportforums.blackberry.com/rim/board?board.id=java_dev)，您可以获得对 Java（Eclipse 或 JDE）的更好支持。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-05-05T19:22:18.833

我使用 Eclipse 是因为 Blackberry 开发的初始设置和 RIM 的操作指南视频假定您使用的是 Eclipse。由于您需要 Blackberry JRE 并且将使用 blackberry 模拟器进行测试，因此使用 Eclipse 将是最轻松的。Visual Studio 很漂亮但不是免费的（除非你是学生并访问 Microsoft 的 Dreamspark 网站）

# database - 如何安全地存储数据库连接详细信息

> ID：824055
> 
> 赞同：6
> 
> 时间：2009-05-05T09:23:54.623
> 
> 标签：database, security

在需要打开数据库连接的应用程序中，必须将用户名/密码详细信息发送到数据库。存储和使用这些数据的最安全方式是什么？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2009-05-05T09:34:09.543

确切的方法取决于环境，但一般来说，您将凭据存储在只有运行您的应用程序的用户才能读取的位置。例如，在 Windows 上，您可以将凭据存储在注册表中受 ACL 保护的位置，以便只有该用户可以读取它。或者，您可以使用 DPAPI 加密数据，以便进一步保护数据。在 Unix 中，您会将其存储在一个受保护`chmod`（并且可以选择加密）的文件中，以便只有应用程序可以读取它。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2009-05-05T09:34:23.117

这取决于您使用的数据库。对于 Microsoft SQL Server，您可以在配置中加密数据库连接字符串，或者使用集成安全性，在这种情况下，您使用正在连接的应用程序的身份连接到数据库。

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2009-05-06T11:32:06.350

很好的问题。
这是我们一直在努力解决的问题 - 并提出了多种方法。

第一个答案是遵循 1800 INFORMATION 的建议：

### 把它放在一个只有运行你的应用程序的用户 ID 可读的区域。

我不认为你会得到比这更好的全方位解决方案。

我们尝试过（并被拒绝）的其他方法：

*   将其保存在加密文件中
    *   这仅在攻击者无法访问您的代码以查看加密是如何工作的情况下才有效，因此大多数时候都不是很好。
*   将其保存在数据库中并需要人工登录才能启动应用程序
    *   这行得通，只要您能够让真人一直启动应用程序
*   依赖内置的安全设备，例如 .NET 中的安全设备（请参阅 rwwilden 的回答）。
    *   如果您是 Microsoft 商店，这是一个很好的解决方案。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2009-05-05T09:34:40.587

不在您的源代码中，而是在您的应用程序读取的单独文件中。然后使用系统安全性使该文件只能由应用程序用户读取

# excel - OpenXML SDK 电子表格入门工具包

> ID：824056
> 
> 赞同：12
> 
> 时间：2009-05-05T09:24:11.500
> 
> 标签：excel, sdk, openxml, openxml-sdk, spreadsheetml

我正在尝试通过 OpenXML SDK 电子表格 API 开始使用 Excel 文档。但是我还没有找到任何关于如何从头开始创建 xlsx 文件的好的指南甚至示例。仅如何打开现有文档并对其进行修改。

我一直在考虑拥有一个空的模板文档并制作一份副本，然后开始处理它。但感觉不对。这可能更容易，但我不喜欢使用一种我不觉得我至少理解“相当”好的技术。

所以我的问题是：有没有人对文章或书籍或任何其他类型的解释 API 的资源有任何好的提示？

提前致谢。/约翰

* * *

## 回答 #1

> 赞同：14
> 
> 时间：2009-05-19T15:21:04.820

最好的办法是下载[OpenXml SDK 2.0](http://msdn.microsoft.com/en-us/library/bb448854(office.14).aspx)并安装。安装后，检查 Tools 目录中是否有名为 DocumentReflector.exe 的工具。使用此工具，您可以“破解”现有的 xslx 文档（或 docx 或 pptx）。打开后，应用程序将向您显示部件的树形视图、带有给定部件的 xml 的面板以及从头开始生成文档所需的代码。

这应该会给你一个很好的开始，让你真正理解 SpreadsheetML 语法（我使用这个工具来学习 WordProcessingML，它真的很有帮助！）。

另请参阅[如何使用 asp.net 创建和下载 excel 文档](https://stackoverflow.com/questions/643643/how-to-create-and-download-excel-document-using-asp-net)

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2009-08-11T14:08:16.340

我不得不承认。OpenXml SDK 很不错，但是要创建一个空白电子表格还有很多工作要做。

但是，codeplex 上有一组名为[simpleooxml的 Helper Classes](http://simpleooxml.codeplex.com/)

文档的方式很少，但这篇[博客文章](http://bloggingdotnet.blogspot.com/2009/05/getting-started-with-simple-ooxml.html)展示了如何在没有现有模板的情况下创建新的电子表格。

我发现它工作得很好。

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2009-05-19T15:39:06.977

[http://openxmldeveloper.org](http://openxmldeveloper.org) is a pretty good resource, with concepts and code samples in various programming languages

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2012-01-20T16:38:02.487

现在，在 MSDN 上，所有类都有很好的文档，即：[SpreadsheetDocument](http://msdn.microsoft.com/en-us/library/documentformat.openxml.packaging.spreadsheetdocument.aspx)和一些演练，例如[“如何创建电子表格”](http://msdn.microsoft.com/en-us/library/ff478153.aspx)。

# visual-studio-2008 - 如何摆脱 Visual Studio 中的颠覆源代码控制？

> ID：824067
> 
> 赞同：20
> 
> 时间：2009-05-05T09:26:29.827
> 
> 标签：visual-studio-2008, svn, ankhsvn

我有一个在 Visual Studio 2008 中使用 Subversion 和 AnkhSVN 进行源代码控制的解决方案，但我想从中删除源代码控制，我该怎么做？

* * *

## 回答 #1

> 赞同：32
> 
> 时间：2009-05-05T09:30:31.253

SVN 与可怕的 VSS 不同，它的“绑定”不会使您的项目文件混乱：它将所有系统信息`.svn`或`_svn`子文件夹保存在每个版本控制的目录中。因此，从项目中“删除”版本控制实际上意味着删除所有这些文件夹。

然而，这很乏味，因此 SVN 有一个名为[svn export](http://svnbook.red-bean.com/en/1.0/re10.html)的特殊命令，它可以“从 URL 指定的存储库中导出干净的目录树”或“从工作副本中导出干净的目录树”。

* * *

## 回答 #2

> 赞同：13
> 
> 时间：2009-05-05T09:43:36.260

据我所知，AnkhSVN 将绑定存储在项目和解决方案文件中（也缓存在解决方案用户选项文件**.suo* 中）。

我认为您可以通过转到`File | Source control | Change Source Control`（或在专用的 AnkhSVN 工具栏中）删除这些绑定。在该对话框中应该有一个`Disconnect`项目命令。

* * *

## 回答 #3

> 赞同：4
> 
> 时间：2009-05-05T09:38:18.800

删除 .svn 文件夹，您的源代码树将不再进行版本控制。

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2009-05-05T10:13:55.033

如果你想删除一个文件/文件夹的 Subversion 控制，但想把它留在当前位置，你可以使用 TortoiseSVN 上的“删除（保持本地）”选项。要查看此选项，您必须在右键单击文件/文件夹时按住 shift 键，然后它将出现在上下文菜单中。

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2013-05-17T13:52:56.963

1.  从文件系统中删除具有隐藏属性的 SVN 文件夹
2.  在文本编辑器中打开 VS 解决方案文件并删除对 subversion 的引用“...由 Subversion 管理...”对我来说很好..

# uml - UML 2.1.2 和 UML 2.2 有什么区别

> ID：824068
> 
> 赞同：3
> 
> 时间：2009-05-05T09:26:42.417
> 
> 标签：uml, modeling

我正在评估一个说它支持 UML 2.2 的工具。但是，如果我在互联网上搜索，我找不到两个版本之间发生了哪些增量变化。

是的，我试图浏览 OMG 文档，但这些文档太密集而无法阅读。任何地方都有简单的解释吗？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-05-05T10:24:35.227

我认为 2.2 中的变化没有一个清晰的概述。有一个带有更改条的 UML 2.2 规范文档：它标记了与版本 2.1.2 不同的更改部分。这确实是查看这些更改的最佳方式 - 再次，没有真正的概述，至少我找不到。[您可以在此处](http://www.omg.org/cgi-bin/apps/doc?formal/09-02-03.pdf)查看文档 (PDF) 。

我稍微浏览了一下文档。它们大多是微小的变化。我遇到的一些变化你可以很快找到：

*   8.3（类说明）
*   8.3.2（组件实现）
*   10.2（部署 - 抽象语法）
*   11.2（抽象语法）
*   11.3.12（清除结构特征动作）
*   11.3.19（输入引脚）
*   11.3.33 (ReadLinkAction)
*   11.3.47 (StartObjectBehaviorAction)
*   11.3.55（WriteStructuralFeatureAction）
*   15.2（状态机 - 抽象语法）

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-05-05T10:20:54.813

不确定您的 UML 参考级别是多少，但是[带有更改条的 UML 2.2 规范](http://www.omg.org/technology/documents/formal/uml.htm)向您显示了所有更改。翻页只需要时间。阅读[2.2 版的 RTF 报告](http://www.omg.org/cgi-bin/doc?ptc/2008-06-03)可能更容易。

# memory-management - Flash 电影在浏览器中可以使用的最大内存是多少？

> ID：824078
> 
> 赞同：1
> 
> 时间：2009-05-05T09:31:15.040
> 
> 标签：memory-management, flash

我需要将从服务器传入的大量数据存储到内存中，因此我必须根据我可以安全使用多少而不会挂起或崩溃浏览器来编写我的内存存储算法。

是否有任何安全的大小限制，如 1MB 或 100MB，全局变量的内容不应超过？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-05-07T20:30:36.343

没有硬性限制，但对于针对中低端机器的 Flash 游戏开发，我们发现将内存占用保持在 500MB 以下可以显着减少随机崩溃。:-D 在看到内存容量限制之前，您可能会看到其他可伸缩性限制（处理能力、单线程），除非您在本地生成大量数据，程序上（例如使用生成的位图）。

我总是建议切换到 AS3，但我认为内存管理不会成为 AS2 的阻碍。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-09-01T13:51:44.160

您可以检查您正在使用多少内存：

```
trace("MEMORY USAGE: " + (System.totalMemory/1048576) + "MB"); 
```

使用它来帮助定位内存泄漏并改进您的垃圾收集代码。

在 actionScript 2 中，他们说您应该清除和删除动态创建的对象以获得最快的 GC。

```
myArray[0] = "value";

myArray[0] = null; // to Garbage Collect
delete myArray[0]; 
```

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2009-05-06T07:26:04.023

看看[这个](https://stackoverflow.com/questions/203800/memory-in-swf-flash-player)非常相似的问题，正如那里所说，你所追求的可能在[这里](http://www.linkedin.com/answers/technology/web-development/TCH_WDD/452057-43859701?browseCategory=)。

祝你好运。

# tfs - 使用 TFS 设置 Dynamics AX 2009 团队开发环境

> ID：824097
> 
> 赞同：0
> 
> 时间：2009-05-05T09:35:58.383
> 
> 标签：tfs, installation, dynamics-ax-2009

大约一周以来，我尝试设置 Dynamics AX 2009 团队开发环境，并不断遇到障碍（主要是关于设置 TFS）。

是否有任何有关将 Dynamics AX Team Server 与 Team Foundation Server 2008**一起**使用的安装说明？有没有人启动并运行过这种组合（AX TS 和 TFS）？

官方安装文档充满了错误（说 /Sites 而不是 /Websites），这使得使用它们成为真正的 PitA！MS 认证 MB6-820 和它的学习材料并没有说明分布式编程，只涉及单用户安装。

其他人如何安装分布式 AX 开发系统？将服务器运送到 MS 以便他们处理？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-05-07T12:32:04.543

啊！问题看起来很简单：

**永远不要在非英语版本的 Windows Server 上安装 AX Team Server！**

一些奇怪的翻译人员翻译了计算机帐户的名称。例如，系统帐户“NT AUTHORITY\NETWORK SERVICE”在德文版 Windows Server 中称为“NT-AUTORITÄT\NETZWERKDIENST”。

现在很多程序都有硬编码的帐户名称，因此无法找到他们正在寻找的帐户，因为名称不匹配。

故事要点：始终在英文版 Windows Server 上安装 AX 2009 团队服务器。

# svn - Tortoise SVN 不要求用户/通行证并失败

> ID：824103
> 
> 赞同：11
> 
> 时间：2009-05-05T09:37:42.407
> 
> 标签：svn, tortoisesvn

我安装了 tortoiseSVN 并且能够检查存储库中已经存在的目录/文件（我不需要为此进行身份验证）当我尝试提交更改时，我收到以下错误：

服务器响应 CHECKOUT 发送了意外的返回值（403 Forbidden）

我从来没有被要求输入我的用户/通行证进行身份验证。

试着用谷歌搜索了一下，发现了各种各样的提及，但没有明确的答案。我和我们校园的SVN服务器负责人谈过，他们声称服务器端一切正常......

任何帮助将不胜感激 ：）

* * *

## 回答 #1

> 赞同：9
> 
> 时间：2009-05-05T09:47:33.193

也许 TortoiseSVN 使用了一些不再有效的已保存身份验证数据？

尝试在 TortoiseSVN 的设置对话框中删除所有已保存的身份验证数据（在“已保存数据”下），然后重试提交。

* * *

## 回答 #2

> 赞同：9
> 
> 时间：2012-11-01T21:20:48.000

根据我的经验可能：1-您需要以这种方式清除身份验证数据：右键单击>>设置>>保存的数据>>身份验证数据>>清除

2-当您想在 sourceforge.net 等存储库中签出时，您必须使用“https://”协议而不是“svn://”或“http://”。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2013-10-04T10:19:53.210

似乎**从 1.8 版本开始**，TortiseSVN 更喜欢 Kerberos（Active Directory）而不是密码验证。这意味着**如果您登录的帐户没有 SVN 路径的权限，您现在将收到`403 Forbidden`错误消息**。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2009-05-05T09:45:28.067

我将假设您通过 http 或 ssh 与存储库交谈。

然后你可以这样写存储库地址：*protocol* :// *username* @ *machine-address* / *repository-dir*。这应该会迫使乌龟让你登录。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2013-01-11T17:36:29.070

确保您的互联网连接不在代理下。否则，在乌龟外部连接处配置它。

此外，需要清理保存的数据设置（如其他用户所述）

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2014-10-01T13:59:56.873

验证您是否处于代理连接状态，如果您进入：TortoiseSVN > 设置 > 网络启用代理，配置您的代理服务器信息 - 服务器地址和端口应该这样做。

* * *

## 回答 #7

> 赞同：-1
> 
> 时间：2009-05-05T10:28:20.880

也许您必须在存储库的配置文件中的帐户/密码设置之前删除前面的空格。

[替代文字 http://img365.imageshack.us/img365/7338/svnconfig.jpg](http://img365.imageshack.us/img365/7338/svnconfig.jpg)

* * *

## 回答 #8

> 赞同：-1
> 
> 时间：2013-10-03T12:58:58.123

另外，请尝试在结帐时将 https:// 替换为 svn+ssh://。

在类似的情况下，这对我有用。

来自：[http ://tortoisesvn.net/docs/release/TortoiseSVN_en/tsvn-serversetup.html](http://tortoisesvn.net/docs/release/TortoiseSVN_en/tsvn-serversetup.html)

# c - rl-rtx中网页的c代码

> ID：824104
> 
> 赞同：0
> 
> 时间：2009-05-05T09:38:10.017
> 
> 标签：c, cgi, webserver

我们必须在我们的项目中使用 RL-RTX (RTOS)。因为我们必须做一些网页。我们有使用“go-ahead webserver”在 linux 中构建网页的经验。

我们可以用 c 语言编写代码并将该可执行文件存储在 .cgi 扩展名中并从浏览器调用吗？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2009-05-05T09:42:27.200

是的你可以。几乎所有的 Web 服务器都可以配置为提供 cgi 服务。您可以使用[libcgi](http://libcgi.sourceforge.net/)之类的东西来处理 c 代码中的接口。尽管如此，使用某种脚本语言而不是 c 可能会更有效。

# grails - 在遗留数据库之上在 Grail 中建模多对多关系

> ID：824107
> 
> 赞同：3
> 
> 时间：2009-05-05T09:39:19.967
> 
> 标签：grails, grails-orm

我在 LAMP 上构建了一个简单的票证记录应用程序。

我目前正在玩grails。我想构建一个使用现有 MySql 数据库的演示应用程序，而无需过多地更改数据库。

数据库中存在多对多关系：'client' 表通过'cliet_contact' 表映射到'user' 表（即不是标准的'client_user' 约定）。

我如何使用 grail 1.1 将其转换为 grails 域类？

任何帮助，将不胜感激。

谢谢！

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2009-05-05T11:03:56.207

您可以在映射中使用[joinTable](http://www.grails.org/doc/1.1/ref/Database%20Mapping/joinTable.html)关键字来指定表名。这是该页面的示例：

```
class Book {
    String title 
    static belongsTo = Author 
    static hasMany = [authors:Author]
    static mapping = { 
        authors joinTable:[name:"mm_author_books", key:'mm_book_id' ] 
    }
}

class Author { 
    String name
    static hasMany = [books:Book]
    static mapping = { 
        books joinTable:[name:"mm_author_books", key:'mm_author_id'] 
    }
} 
```

# java - Windows 上的 Java 准确睡眠

> ID：824110
> 
> 赞同：22
> 
> 时间：2009-05-05T09:40:25.940
> 
> 标签：java, windows, sleep

有谁知道为 Java 提供 Thread.sleep() 的库，其错误不高于 1-2 毫秒？

我尝试了睡眠、错误测量和 BusyWait 的混合，但在不同的 Windows 机器上我没有得到这个可靠的结果。

如果实现也可用于 Linux 和 MacOS，它可以是本机实现。

**编辑** Nick 提供的链接（[http://blogs.oracle.com/dholmes/entry/inside_the_hotspot_vm_clocks](http://blogs.oracle.com/dholmes/entry/inside_the_hotspot_vm_clocks)）是一个非常好的资源来了解各种计时器/睡眠/时钟 java 的问题。

* * *

## 回答 #1

> 赞同：18
> 
> 时间：2009-05-05T11:30:00.700

要提高睡眠的粒度，您可以从此[Thread.sleep](http://www.javamex.com/tutorials/threads/sleep.shtml)页面尝试以下操作。

> **Windows 下 Thread.sleep() 的错误**
> 
> 如果时间对您的应用程序至关重要，那么解决这些错误的一种不雅但实用的方法是让一个守护线程在您的应用程序的整个持续时间内运行，它只是休眠大量的质数毫秒（Long.MAX_VALUE 会这样做）。这样，每次调用应用程序都会设置一次中断周期，从而最大限度地减少对系统时钟的影响，并将睡眠粒度设置为 1ms，即使默认中断周期不是 15ms。

该页面还提到它会导致 Windows 系统范围内的更改，这可能会导致用户的时钟由于此[错误](http://support.microsoft.com/?id=821893)而快速运行。

**编辑**

有关这方面的更多信息，请参见 [此处](http://blogs.oracle.com/dholmes/entry/inside_the_hotspot_vm_clocks)以及来自 Sun的相关[错误报告。](http://bugs.sun.com/view_bug.do?bug_id=6435126)

* * *

## 回答 #2

> 赞同：12
> 
> 时间：2009-10-28T19:02:04.363

这晚了约 5 个月，但可能对阅读此问题的人有用。我发现这与纳秒精度（理论上）`java.util.concurrent.locks.LockSupport.parkNanos()`相同，但精度比实践中`Thread.sleep()`要好得多。`Thread.sleep()`这当然取决于您使用的 Java 运行时，所以 YMMV。

看看：[LockSupport.parkNanos](http://java.sun.com/javase/6/docs/api/java/util/concurrent/locks/LockSupport.html#parkNanos(long))

（我在 Sun 的 Linux 1.6.0_16-b01 VM 上验证了这一点）

* * *

## 回答 #3

> 赞同：9
> 
> 时间：2010-06-07T03:28:27.263

不幸的是，从 Java 6 开始，Windows 操作系统上所有与睡眠相关的方法 [包括 LockSupport.awaitNanos()] 都基于毫秒，正如上面几个人所提到的。

计算精确间隔的一种方法是“旋转产量”。方法 System.nanoTime() 为您提供相当精确的相对时间计数器。此调用的成本取决于您的硬件，并且位于 2000-50 纳秒左右。

以下是 Thread.sleep() 的建议替代方案：

```
 public static void sleepNanos (long nanoDuration) throws InterruptedException {
        final long end = System.nanoTime() + nanoDuration;
        long timeLeft = nanoDuration;
        do {
            if (timeLeft > SLEEP_PRECISION)
                Thread.sleep (1);
            else
                if (timeLeft > SPIN_YIELD_PRECISION)
                    Thread.yield();

            timeLeft = end - System.nanoTime();
        } while (timeLeft > 0);
    } 
```

这种方法有一个缺点 - 在等待命中 CPU 内核的最后 2-3 毫秒期间。请注意， sleep()/yield() 将与其他线程/进程共享。如果你愿意牺牲一点 CPU，这会给你[非常准确的睡眠](http://andy-malakov.blogspot.com/2010/06/alternative-to-threadsleep.html)。

* * *

## 回答 #4

> 赞同：4
> 
> 时间：2009-05-05T11:15:46.147

JDK 提供了 Timer 类。

[http://java.sun.com/j2se/1.5.0/docs/api/java/util/Timer.html](http://java.sun.com/j2se/1.5.0/docs/api/java/util/Timer.html)

阅读文档清楚地表明，除了使这个框架成为一个通用框架的管道之外，它使用的没有什么比调用 Object.wait(timeout) 更复杂的了：

[http://java.sun.com/j2se/1.5.0/docs/api/java/lang/Object.html#wait(long)](http://java.sun.com/j2se/1.5.0/docs/api/java/lang/Object.html#wait(long))

因此，您可以自己使用 Object#wait 来减少追逐。

除了这些考虑之外，事实仍然是 JVM 不能保证跨平台的时间准确性。（阅读[http://java.sun.com/j2se/1.5.0/docs/api/java/lang/System.html#currentTimeMillis()](http://java.sun.com/j2se/1.5.0/docs/api/java/lang/System.html#currentTimeMillis%28%29)上的文档）

如果您想在您的平台上获得最高的计时精度，我认为您需要尝试一种结合了计时器和繁忙轮询的折衷解决方案。有效地 Object#wait(1) -> System#nanoTime -> 计算 delta -> [必要时循环]。

如果您愿意自己动手​​，JNI 几乎可以为特定平台的解决方案敞开大门。我很高兴不知道 Window 的内部结构，但显然如果主机操作系统确实提供了足够准确的实时计时器服务，那么设置 timerRequest(timedelta, callback) 本机库的准系统结构不应该是遥不可及的。

* * *

## 回答 #5

> 赞同：4
> 
> 时间：2009-05-05T10:04:44.477

在普通代码中使用没有充分的理由`Thread.sleep()`——它（几乎）总是表明设计不好。最重要的是，没有保证线程将在指定时间后继续执行，因为语义`Thread.sleep()`只是停止执行给定时间，而不是在该时间过去后立即继续执行。

所以，虽然我不知道你想达到什么目的，但我很确定你应该使用计时器。

* * *

## 回答 #6

> 赞同：3
> 
> 时间：2009-05-15T05:10:44.183

Long.MAX_VALUE hack 是有效的解决方案。

我尝试用 Object.wait(int milis) 替换 Thread.sleep，但发现 Object.wait 和 Thread.sleep 一样准确（Windows 下为 10ms）。如果没有 hack，这两种方法都不适合任何动画

* * *

## 回答 #7

> 赞同：1
> 
> 时间：2009-05-05T19:39:26.110

您可以尝试使用新的并发库。就像是：

```
private static final BlockingQueue SLEEPER = new ArrayBlockingQueue(1);
public static void main(String... args) throws InterruptedException {
    for(int i=0;i<100;i++) {
        long start = System.nanoTime();
        SLEEPER.poll(2, TimeUnit.MILLISECONDS);
        long time = System.nanoTime() - start;
        System.out.printf("Sleep %5.1f%n", time/1e6);
    }
} 
```

这会在 2.6 到 2.8 毫秒之间休眠。

* * *

## 回答 #8

> 赞同：1
> 
> 时间：2009-05-05T09:43:49.037

使用当前线程上的`Thread::join` [覆盖之一。](http://java.sun.com/j2se/1.4.2/docs/api/java/lang/Thread.html#join(long,%20int))您指定等待的毫秒数（和纳秒）。

* * *

## 回答 #9

> 赞同：0
> 
> 时间：2009-05-05T11:21:22.220

听起来您需要[实时 Java](http://java.sun.com/javase/technologies/realtime/index.jsp)的实现。

# ruby-on-rails - Thinking Sphinx - Delta 索引不起作用

> ID：824112
> 
> 赞同：5
> 
> 时间：2009-05-05T09:40:54.970
> 
> 标签：ruby-on-rails, ruby, thinking-sphinx

在我的应用程序中，我需要立即将每条新记录添加到索引中（而不是在 rake ts:index 之后）。如果我理解正确，增量索引就是我正在寻找的。因此，我`delta`在使用 Sphinx 索引的每个表中添加了列，将默认值设置为`false`并添加`set_property :delta => true`到每个`define_index`块中；然后运行 ​​rake ts:index 和 rake ts:restart。但是，“即时”索引似乎不起作用。在控制台中测试时，我创建了一个新记录，保存并尝试搜索它但不会取回它（在我运行 rake ts:index 后它工作得很好）。我在这里做错了吗？

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2009-05-06T06:31:49.397

感谢你付出的努力。经过一些相当长的探索后，我发现我只是忘记了运行迁移（它将 delta 列的默认值设置为 false）。现在，我应该为这样一个愚蠢的错误得到一些减分。很抱歉打扰您，再次感谢您。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2010-01-26T04:58:01.887

我在增量索引不起作用时遇到了类似的问题……实际上它在我的开发环境中有效，但在生产环境中无效。我对帖子开头的陈述感到困惑，这些陈述表明 delta 的默认值应该为 false。在[http://freelancing-god.github.com/ts/en/deltas.html](http://freelancing-god.github.com/ts/en/deltas.html)的思考狮身人面像文档中，它指出默认值应该为 true：

```
def self.up
  add_column :articles, :delta, :boolean, :default => true,
    :null => false
end 
```

我错过了什么吗？

谢谢！

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-05-05T19:20:13.113

您是否使用 rake ts:conf 正确生成配置文件？

您可以检查生成的配置文件以查看配置文件中是否同时存在 SQL 请求（标准和增量）。

我们毫无问题地使用它。

# asp.net-mvc - ASP.NET MVC 本地化

> ID：824115
> 
> 赞同：1
> 
> 时间：2009-05-05T09:41:43.737
> 
> 标签：asp.net-mvc, localization

我想使用资源文件 (.resx) 在 ASP.NET MVC 中进行本地化。我的想法是：

1.  在 App_GlobalResources 文件夹下制作一个默认资源文件 在 App_LocalResources 文件夹下制作几个本地资源文件
2.  读取 cookie 信息以设置 CultureInFo Thread.CurrentThread.CurrentCulture = new CultureInfo("en-US");

然后，我想在控制器中使用资源文件来设置 ViewData 值，例如：

```
ViewData["Title"] = Resources:Resource, PageTitle; 
```

但是语法错误，我该怎么做？

任何想法？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-05-19T16:43:16.863

你试过跟随吗？

```
ViewData["Title"] = Resources.Resource.PageTitle; 
```

如果你有`Resource.aspx`文件，`App_GlobalResources`这应该可以。

# c - 为什么 floor() 这么慢？

> ID：824118
> 
> 赞同：35
> 
> 时间：2009-05-05T09:42:32.423
> 
> 标签：c, performance, visual-c++, x86, intel

我最近编写了一些代码（ISO/ANSI C），并对它实现的糟糕性能感到惊讶。长话短说，原来罪魁祸首是`floor()`函数。它不仅速度慢，而且没有矢量化（使用英特尔编译器，又名 ICL）。

以下是为 2D 矩阵中的所有单元格执行地板的一些基准：

```
VC:  0.10
ICL: 0.20 
```

将其与简单的演员表进行比较：

```
VC:  0.04
ICL: 0.04 
```

怎么可能`floor()`比简单的演员阵容慢那么多？！它基本上做同样的事情（除了负数）。第二个问题：有人知道超快速的`floor()`实现吗？

PS：这是我进行基准测试的循环：

```
void Floor(float *matA, int *intA, const int height, const int width, const int width_aligned)
{
    float *rowA=NULL;
    int   *intRowA=NULL;
    int   row, col;

    for(row=0 ; row<height ; ++row){
        rowA = matA + row*width_aligned;
        intRowA = intA + row*width_aligned;
#pragma ivdep
        for(col=0 ; col<width; ++col){
            /*intRowA[col] = floor(rowA[col]);*/
            intRowA[col] = (int)(rowA[col]);
        }
    }
} 
```

* * *

## 回答 #1

> 赞同：44
> 
> 时间：2009-05-05T10:17:43.510

有几件事使 floor 比 cast 慢并阻止矢量化。

最重要的一个：

floor 可以修改全局状态。如果您传递的值太大而无法以浮点格式表示为整数，则**errno**变量将设置为**EDOM**。还对 NaN 进行了特殊处理。所有这些行为都适用于想要检测溢出情况并以某种方式处理这种情况的应用程序（不要问我如何）。

检测这些有问题的条件并不简单，占 floor 执行时间的 90% 以上。实际的舍入很便宜，可以内联/矢量化。还有很多代码，所以内联整个 floor-function 会使你的程序运行得更慢。

一些编译器具有特殊的编译器标志，允许编译器优化掉一些很少使用的 c 标准规则。例如，可以告诉**GCC**你根本对 errno 不感兴趣。为此，请通过**-fno-math-errno**或**-ffast-math**。ICC 和 VC 可能有类似的编译器标志。

顺便说一句-您可以使用简单的演员来滚动自己的地板功能。你只需要以不同的方式处理消极和积极的情况。如果您不需要对溢出和 NaN 进行特殊处理，这可能会快很多。

* * *

## 回答 #2

> 赞同：19
> 
> 时间：2013-03-11T14:32:00.400

如果您要将`floor()`运算结果转换为 int，并且您不担心溢出，那么以下代码比以下代码要快得多`(int)floor(x)`：

```
inline int int_floor(double x)
{
  int i = (int)x; /* truncate */
  return i - ( i > x ); /* convert trunc to floor */
} 
```

* * *

## 回答 #3

> 赞同：11
> 
> 时间：2015-05-18T16:56:24.747

无分支地板和天花板（更好地利用管道）无错误检查

```
int f(double x)
{
    return (int) x - (x < (int) x); // as dgobbi above, needs less than for floor
}

int c(double x)
{
    return (int) x + (x > (int) x);
} 
```

或使用地板

```
int c(double x)
{
    return -(f(-x));
} 
```

* * *

## 回答 #4

> 赞同：4
> 
> 时间：2018-11-02T06:52:54.233

现代 x86 CPU 上***大型*****阵列**的实际最快实现**是**

 **   **将 MXCSR FP 舍入模式更改为向 -Infinity (aka `floor`)**舍入。在 C 中，这应该可以用`fenv`东西或`_mm_getcsr`/来实现`_mm_setcsr`。
*   `_mm_cvtps_epi32`在 SIMD 向量上循环遍历数组，`float`使用当前舍入模式将 4 秒转换为 32 位整数。（并将结果向量存储到目的地。）

    [`cvtps2dq xmm0, [rdi]`](http://felixcloutier.com/x86/CVTPS2DQ.html)是自 K10 或 Core 2 以来的任何 Intel 或 AMD CPU 上的单个微融合 uop。( [https://agner.org/optimize/](https://agner.org/optimize/) ) 与 256 位 AVX 版本相同，带有 YMM 向量。

*   使用 MXCSR 的原始值将当前舍入模式恢复为正常的 IEEE 默认模式。（四舍五入，甚至作为抢七）

**这允许在每个时钟周期加载 + 转换 + 存储 1 个 SIMD 结果向量，与 truncation 一样快**。（SSE2 有一个特殊的 FP->int 截断转换指令，正是因为它是 C 编译器非常普遍需要的。在 x87 糟糕的旧时代，甚至`(int)x`需要将 x87 舍入模式更改为截断然后返回。 [`cvttps2dq`对于打包浮点数->带截断的 int](http://felixcloutier.com/x86/CVTTPS2DQ.html)（注意助记符中的额外`t`内容）。或者对于标量，从 XMM 到整数寄存器，[`cvttss2si`](http://felixcloutier.com/x86/CVTTSS2SI.html)或者`cvttsd2si`对于标量`double`到标量整数。

通过一些循环展开和/或良好的优化，这应该可以在前端没有瓶颈的情况下实现，假设没有缓存未命中瓶颈，每时钟只有 1 个存储吞吐量。（在 Skylake 之前的 Intel 上，每时钟 1 个打包转换吞吐量也存在瓶颈。）即**每个周期 16、32 或 64 字节，使用 SSE2、AVX 或 AVX512。**

* * *

在不更改当前舍入模式的情况下，您需要 SSE4.1使用您选择的舍入模式将`roundps`a舍入`float`到最接近的整数。`float`或者您可以使用其他答案中显示的技巧之一，这些技巧适用于幅度足够小的浮点数以适合有符号的 32 位整数，因为无论如何这都是您的最终目标格式。）

* * *

（使用正确的编译器选项，例如`-fno-math-errno`，以及正确的`-march`or`-msse4`选项，编译器可以内联`floor`使用`roundps`，或标量和/或双精度等价物，例如`roundsd xmm1, xmm0, 1`，但这需要 2 uop 并且在 Haswell 上每 2 个时钟吞吐量为 1 用于标量或向量。实际上，即使没有任何快速数学选项，gcc8.2 也会内联`roundsd`，`floor`正如[您在 Godbolt 编译器资源管理器中看到的那样](https://godbolt.org/#g:!((g:!((g:!((h:codeEditor,i:(j:1,lang:c%2B%2B,source:'%23include+%3Cimmintrin.h%3E%0A%0A__m128d+vfloor(__m128d+x)+%7B+return+_mm_floor_pd(x)%3B+%7D%0A%0A%23include+%3Cmath.h%3E%0A%0Adouble+f(double+x)+%7B+return+floor(x)%3B+%7D'),l:'5',n:'0',o:'C%2B%2B+source+%231',t:'0')),k:50.83418951162773,l:'4',n:'0',o:'',s:0,t:'0'),(g:!((h:compiler,i:(compiler:g82,filters:(b:'0',binary:'1',commentOnly:'0',demangle:'0',directives:'0',execute:'1',intel:'0',trim:'1'),lang:c%2B%2B,libs:!(),options:'-std%3Dgnu%2B%2B17+-O3+-Wall+-march%3Dhaswell',source:1),l:'5',n:'0',o:'x86-64+gcc+8.2+(Editor+%231,+Compiler+%231)+C%2B%2B',t:'0')),k:49.16581048837228,l:'4',m:100,n:'0',o:'',s:0,t:'0')),l:'2',n:'0',o:'',t:'0')),version:4)。但这是与`-march=haswell`. 不幸的是，它不是 x86-64 的基线，因此如果您的机器需要启用它支持它。）

* * *

## 回答 #5

> 赞同：2
> 
> 时间：2009-05-05T17:04:27.167

是的，`floor()`在所有平台上都非常慢，因为它必须实现 IEEE fp 规范中的许多行为。你不能真正在内部循环中使用它。

我有时使用宏来近似 floor()：

```
#define PSEUDO_FLOOR( V ) ((V) >= 0 ? (int)(V) : (int)((V) - 1)) 
```

它的行为并不完全像`floor()`: 例如，`floor(-1) == -1`但是`PSEUDO_FLOOR(-1) == -2`，但对于大多数用途来说已经足够接近了。

* * *

## 回答 #6

> 赞同：2
> 
> 时间：2018-11-02T05:54:28.330

需要在浮点域和整数域之间进行一次转换的实际无分支版本会将值转移`x`到所有正数或全负数范围，然后强制转换/截断并将其移回。

```
long fast_floor(double x)
{
    const unsigned long offset = ~(ULONG_MAX >> 1);
    return (long)((unsigned long)(x + offset) - offset);
}

long fast_ceil(double x) {
    const unsigned long offset = ~(ULONG_MAX >> 1);
    return (long)((unsigned long)(x - offset) + offset );
} 
```

正如评论中所指出的，此实现依赖于`x +- offset`不溢出的临时值。

在 64 位平台上，使用 int64_t 中间值的原始代码将产生三个指令内核，同样适用于 int32_t 缩减范围 floor/ceil，其中`|x| < 0x40000000`--

```
inline int floor_x64(double x) {
   return (int)((int64_t)(x + 0x80000000UL) - 0x80000000LL);
}
inline int floor_x86_reduced_range(double x) {
   return (int)(x + 0x40000000) - 0x40000000;
} 
```

* * *

## 回答 #7

> 赞同：-1
> 
> 时间：2009-05-05T10:00:55.423

1.  他们不做同样的事情。floor() 是一个函数。因此，使用它会导致函数调用、分配堆栈帧、复制参数和检索结果。强制转换不是函数调用，因此它使用更快的机制（我相信它可能使用寄存器来处理值）。
2.  可能 floor() 已经优化。
3.  你能从你的算法中挤出更多的性能吗？也许切换行和列可能会有所帮助？你能缓存常用值吗？你的编译器的所有优化都在吗？可以切换操作系统吗？编译器？ [Jon Bentley 的 Programming Pearls](http://www.cs.bell-labs.com/cm/cs/pearls/)对可能的优化进行了很好的回顾。

* * *

## 回答 #8

> 赞同：-3
> 
> 时间：2013-09-25T11:22:23.920

**快速双轮**

```
double round(double x)
{
    return double((x>=0.5)?(int(x)+1):int(x));
} 
```

* * *

**终端日志**

测试 custom_1 8.3837

测试 native_1 18.4989

测试 custom_2 8.36333

测试 native_2 18.5001

测试 custom_3 8.37316

测试 native_3 18.5012

* * *

**测试**

```
void test(char* name, double (*f)(double))
{
    int it = std::numeric_limits<int>::max();

    clock_t begin = clock();

    for(int i=0; i<it; i++)
    {
        f(double(i)/1000.0);
    }
    clock_t end = clock();

    cout << "test " << name << " " << double(end - begin) / CLOCKS_PER_SEC << endl;

}

int main(int argc, char **argv)
{

    test("custom_1",round);
    test("native_1",std::round);
    test("custom_2",round);
    test("native_2",std::round);
    test("custom_3",round);
    test("native_3",std::round);
    return 0;
} 
```

* * *

**结果**

类型转换和使用你的大脑比使用本机函数快约 3 倍。

# ms-access - 为 Access 2007 表单中的按钮分配键盘快捷键

> ID：824123
> 
> 赞同：6
> 
> 时间：2009-05-05T09:43:32.423
> 
> 标签：ms-access, ms-access-2007

假设我有一个表单，其中存在许多按钮。单击按钮时，一切正常。如何为我的按钮分配键盘快捷键，以便 Alt+A 运行按钮 A 的操作，Alt+B 运行按钮 B 的操作等。

看起来这样做很简单，但我无法看到我可以在哪里设置它。

* * *

## 回答 #1

> 赞同：10
> 
> 时间：2009-05-05T17:30:51.223

创建按钮时，在要 Alt+ 的字母前使用 & 号？在 Caption 属性中。

例子：

&文件 --- >**文件**

&编辑 --- >**编辑**

锻造-- >**锻造**

够了->**够了**

* * *

## 回答 #2

> 赞同：5
> 
> 时间：2009-06-06T20:59:30.440

如果您想设置一个无论您在当前数据库中的哪个位置都可以使用的全局键盘快捷键，那么您可以创建一个名为 AutoKeys 的特殊宏并进行如下设置：

[![替代文字](https://i.stack.imgur.com/DlXCL.jpg)](https://i.stack.imgur.com/DlXCL.jpg)

注意用于表示特殊键的特殊字符：

```
^ for Ctrl
+ for Shift
% for Alt 
```

{F11} 代表 F11（功能）键

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2016-08-13T07:05:27.503

如果您想将功能键添加为表单的快捷方式，请将以下代码添加到您的表单 VB 代码中。

> 需要设置`KeyPreview`才能`Yes`工作（见下图）

```
Private Sub Form_KeyDown(KeyCode As Integer, Shift As Integer)
    Select Case KeyCode
        Case vbKeyF5
        'Process F5 key events.
           Msgbox "F5"
        Case vbKeyF4
        ' Process F4 key events.
           MsgBox "F4"
        Case Else
    End Select
End Sub 
```

[![设置键预览](https://i.stack.imgur.com/rjSO1.jpg)](https://i.stack.imgur.com/rjSO1.jpg)

* * *

## 回答 #4

> 赞同：2
> 
> 时间：2016-05-26T10:36:26.003

> 当 Access 为您完成时不要输入

`[Ctrl]+[;]`插入当前日期。如果您保留历史记录，或者在数据库中的任何注释或其他字段中包含日期，这将是非常宝贵的。它不仅可以节省时间，还可以确保数据的准确性，让您不必记住日期。

`[Ctrl]+[:]`插入当前时间。与插入日期快捷方式一样，此功能可以节省比您想象的更多的时间，并且还有助于保持数据的准确性。

`[Ctrl]+[']`在上一条记录中插入来自同一字段的值。当您需要连续输入多条记录时，您可能会发现记录之间的许多字段是相同的。使用剪贴板复制数据会有所帮助，但您可能需要输入多个重复信息字段（您的姓名在一个字段中，日期在另一个字段中，一些通用注释在第三个字段中）。使用此快捷方式从上一条记录中插入相同字段的值。

`[Ctrl]+[Alt]+[Spacebar]`插入当前字段的默认值。当您开始键入时，这会派上用场，然后意识到您应该保留默认值。

> 可以使用键盘时不要使用鼠标

`[Ctrl]+Arrow`组合键加速导航

`[Ctrl]+[Left/Right Arrow]`将您移动到最后一个/下一个单词的开头。

`[Ctrl]+[Up/Down Arrow]`将您移至最后/下一段的开头。

`[Shift] +Arrow`组合键选择文本

`[Shift]+[Left/Right Arrow]`选择一个字母。

`[Shift]+[Up/Down Arrow]`选择一行。

`[Ctrl]+ [Shift]+[Left/Right Arrow]`选择一个词。

`[Ctrl]+ [Shift]+[Up/Down Arrow] 选择一个段落。

`[F2]`在编辑模式和导航模式之间切换 编辑模式显示插入点。导航模式隐藏插入点，并选择整个字段。在导航模式下，使用箭头键在字段之间移动。

`[F4]`打开组合框或列表框 使用此键盘快捷键下拉列表，然后使用箭头键从列表中选择一个值。

`[Ctrl]+[+]`添加新记录

`[Ctrl]+[-]`删除当前记录

`[Shift]+[Enter]`保存当前记录 切换记录也会保存数据，但最好经常保存，尤其是在输入大量数据时。

`[Ctrl]+[PgUp]`转到上一条记录

`[Ctrl]+[PgDn]`转到下一条记录

# c# - 覆盖基类的方法、属性等多远，例如.net TreeNode 类

> ID：824128
> 
> 赞同：2
> 
> 时间：2009-05-05T09:44:28.613
> 
> 标签：c#, .net, treeview, overriding

我正在开发一些应用程序，它使用 TreeView 控件来表示业务对象。目前，业务对象和 TreeNode 之间的链接是通过 TreeNode 的 Tag 属性来维护的。我对此不太满意，因为我认为链接不够“紧密”。例如，可能有一个没有业务对象的 TreeNode 对象，我也想根据业务对象状态更新 TreeNode 图像。因此，我从 TreeNode 派生了我自己的特殊 TreeNode 类：

```
class ActionTreeNode : TreeNode
   {
      private Action mAction;

      public Action Action
      { get ... }

      public ActionTreeNode(Action action)
         : base()
      {
         if (action == null) throw new ArgumentNullException("action", "Paramter action must not be null.");

         mAction = action;
      }

    public void UpdateState()
      {
         switch (mAction.ActionState)
         {
            case ActionState.Passed:
               SelectedImageIndex = 3;
               ImageIndex = 3;
               break;
            case ActionState.Failed:
               SelectedImageIndex = 2;
               ImageIndex = 2;
               break;
            ...
         }

         return;
      }
   } 
```

使用这种最小的方法，每次调用返回 TreeNode 对象的基类的属性或方法时，我都必须强制转换，如“(ActionTreeNode)myNode.Parent”。解决方案是覆盖/覆盖每个方法或属性并返回 ActionTreeNode 类型的对象。您认为，采用最小方法更合适，还是您会努力重新实现所有方法、属性以避免强制转换？谢谢。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2009-05-05T09:49:20.397

我喜欢最小的方法。如果您担心使用大量强制转换语句使代码混乱，只需创建一种方法在一个地方为您执行此操作：

```
private ActionTreeNode GetParent(ActionTreeNode node)
{
    return node.Parent as ActionTreeNode;
}

// in some method:
ActionTreeNode parent = GetParent(someNode);
if (parent != null)
{
    // the parent is an ActionTreeNode
} 
```

不要忘记对返回值进行空检查，如果父级不是 ActionTreeNode...

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2009-05-05T09:58:26.303

我认为问题是你需要多长时间才能努力使它成为强类型。

权衡使一切“紧密”的成本与您和其他开发人员拥有可靠平台的成本。

在不了解更多信息的情况下，我个人认为我会强烈键入它，因为这也意味着对您的业务逻辑的任何更改（例如存储在树中的不同类型）都会导致编译失败，而不是可能的未知错误。

# php - 如何用 jquery 加载图片？

> ID：824133
> 
> 赞同：1
> 
> 时间：2009-05-05T09:47:14.380
> 
> 标签：php, javascript, jquery, ajax, image

我目前正在研究一个使用 php 将图表生成为图片的类。我想用jquery动态加载这些图片。我怎样才能做到这一点？？我不会有一个真正的图片文件，只有当我用ajax调用它时文件的内容......而且我不能简单地将php脚本定义为src，因为我需要将Post参数传递给图片......

编辑：

好吧..我想我必须进一步解释一下...

这是html代码：

```
<div>
<img id="image" />
</div>
<input type="button" onclick="loadPicture();" /> 
```

按下按钮时，应将一些数据发送到生成图片的 php 脚本。回调函数或类似的东西现在应该将图片发布到 img- 元素中。简单地将图片发布到 img 标签中是行不通的。下面的代码可以工作，但我怎样才能添加 POST 参数？

```
<img src="<scriptname>.php" /> 
```

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2009-05-05T10:01:35.560

Http POST 请求并不意味着返回资源。为什么不使用 GET 请求？执行此操作的“REST”方法是使用 POST 请求创建图像，然后使用 GET 请求加载它。您需要为您的资源定义一个 URL 映射。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2009-07-23T23:34:17.243

没有人！在我看来，你基本上有 3 个选项。

### 方法 1 - 内联图像

做 Brayn 说的，但`data`应该是[你的 image 的 base64 编码](http://www.sweeting.org/mark/blog/2005/07/12/base64-encoded-images-embedded-in-html)。

```
$("#div").html(data); // instead of this
$('#image').attr('src','data:image/gif;base64,'+data); // try something like this 
```

但我不喜欢内联图像或传递帖子数据的想法。对于大图像，Base64 也可能会有点大。

### 方法 2 - 保存图像

您可以`$.post`像以前一样保存数据，然后**保存**图像，并返回图像的 URL。

### 方法 3 - 使用 GET

修改您的图像生成脚本以接受`GET`数据。如果您要传递大量数据，请尝试以某种方式对其进行压缩，或者*您*可以使用`SESSION`变量。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2009-05-05T12:23:59.900

我不太确定我是否从您所说的内容中得到了正确的答案，但是您可以使用 $.post() 方法，该方法将通过其回调返回您需要的任何内容。像这样的东西：

```
$.post("file.php",{param: val},function(data){
    $("#div").html(data);
}) 
```

如果您能进一步解释，也许我们会更好地理解。希望这可以帮助。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2009-07-23T23:18:36.010

是否有任何实际需要使用 AJAX / jQuery？或者你只是因为它很酷而把它放进去？

这是我要做的：

```
if (isset($_POST['createImage'])){
    // This means that the button was clicked
    // Generate your image, and then display it:
}

// Regardless, you would now show your form
// That way if values were to be changed, the graphic can be recalculated. 
```

这样，您就可以实现所需的输出（图形加载取决于表单输出），然后单击即可生成该输出。

# windows - 对域组的 Oracle 的 Windows 身份验证

> ID：824139
> 
> 赞同：2
> 
> 时间：2009-05-05T09:50:57.147
> 
> 标签：windows, oracle, authentication

我知道可以使用“操作系统身份验证”来验证 Oracle 数据库中的 Windows 用户。该过程基本上是将当前的 Windows 用户 ID 传递给 Oracle 进行身份验证。

问题是 - 是否可以在 Oracle 中对域组进行身份验证（因为可以使用 SQL Server 集成安全性），这样就不需要为每个域成员创建单独的数据库用户？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-05-07T08:25:05.603

有可能的。

Oracle 对此有一份[白皮书](http://www.oracle.com/technology/tech/windows/wp/Oracle_with_Active_Directory_TWP.pdf)，[这里有一个教程](http://www.fm-berger.de/ora_adinteg/)，

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-05-06T14:33:24.870

我认为这是不可能的，但我很想被证明是错误的。

# c++ - 使用字符串流？

> ID：824143
> 
> 赞同：3
> 
> 时间：2009-05-05T09:52:42.480
> 
> 标签：c++, string, stringstream

假设我在 C++ 中有一个字符串，我想对它做不同的操作，比如：

搜索字符序列，将文本块转换为 int（在行的中间），来回移动 get 指针等等。

用字符串流做这种事情的标准/常用方法是什么？

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2009-05-05T10:05:53.320

您可以使用返回关联的 std::string 对象的 stringstream::str() 方法。然后您可以对返回的字符串执行所需的操作。

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2009-05-05T10:07:26.453

顾名思义，stringtream 是一个流。流允许顺序访问，而不是随机访问。如果要随机访问，可以使用 stringstream::str() 函数来获取字符串的字符串版本。

# jquery - 我如何对多个单词使用 JQuery 自动完成

> ID：824144
> 
> 赞同：13
> 
> 时间：2009-05-05T09:53:14.850
> 
> 标签：jquery, autocomplete

我有一个自动完成字段，我只是想知道如何将它用于多个单词？当我输入第一个单词时它工作得很好，但是当我空格并输入第二个单词时，它会将这两个单词发送回服务器，当然结果是错误的！

例如。当我输入这两个词时，

'Java javascript'

第一个单词'Java'，自动完成效果很好，拉列表。

但是当我空格并键入 javascript 时，自动完成将“Java +javascript”发送到我的 ajax 函数。

任何想法如何解决这一问题？

* * *

## 回答 #1

> 赞同：14
> 
> 时间：2010-07-02T18:23:51.403

如果您使用的是“bassistance”版本的 Autocomplete，它是内置的。但如果您使用的是 jQuery UI 版本，这里有一个示例：

[http://jqueryui.com/demos/autocomplete/#multiple](http://jqueryui.com/demos/autocomplete/#multiple)

* * *

## 回答 #2

> 赞同：10
> 
> 时间：2009-05-31T10:01:41.280

看起来你不能，内置实现不支持它 - 你可以在上面的链接中看到：“不是稳定版本或发行版的一部分”。

但是，我已经下载并使用了外部版本，可[在此处](http://bassistance.de/jquery-plugins/jquery-plugin-autocomplete/)获得：

[http://bassistance.de/jquery-plugins/jquery-plugin-autocomplete/](http://bassistance.de/jquery-plugins/jquery-plugin-autocomplete/)

稍微大一点，但是用法完全一样，不用改什么，多选的话，加options {multiple:true}

**更新**

JQueryUI 现在已针对最新版本进行了更新，使此答案已过时。一个最新的例子可以在这里找到

[http://jqueryui.com/demos/autocomplete/#multiple](http://jqueryui.com/demos/autocomplete/#multiple)

* * *

## 回答 #3

> 赞同：8
> 
> 时间：2009-10-01T09:01:38.383

```
$("#tagnames").autocomplete("/tags/filter", {
        max: 6,
        highlightItem: true,
        multiple: true,
        multipleSeparator: " ", 
  }) 
```

要为多个单词启用自动完成，您应该设置选项**multiple : true**和**multipleSeparator: " "**

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2015-08-02T00:06:46.750

添加评论以获得更完整的答案，假设您有两个可能的选择具有共同的前缀：

**ip5**、**ip5电池**

如果用户在文本框 ip5 中键入，则将自动选择上面的第一个选项，而不会让用户继续输入第二个选项，为避免这种行为，请确保使用该选项

**triggerSelectOnValidInput：真，**

# c# - 在 C# 中使用 vc++ 类库

> ID：824146
> 
> 赞同：0
> 
> 时间：2009-05-05T09:53:55.737
> 
> 标签：c#, visual-c++, dll

我在 vc++ 项目中创建了一个简单的“公共参考类”，它被配置为生成一个动态库。在 c# 项目（简单的控制台应用程序）中，我将 vc++ 项目添加到引用中并执行“使用 myVC++ 库”。但是当我尝试从 vc++ dll 创建一个对象时，我总是得到： System.BadImageFormatException is unhandled

关于此的任何线索或有用的教程？

TIA

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-05-05T12:04:28.760

您的 c# 项目是否设置为为“任何 CPU”构建 - 如果是，并且您使用的是 64 位操作系统，那么加载将失败。

VC++ dll 只能是 32 位的，64 位的应用程序不能运行它。

您可以改为将您的 c# 构建更改为以 x86 为目标。

# java - 如何使用 Java 以编程方式将网页的内部样式表转换为内联样式表？

> ID：824149
> 
> 赞同：-1
> 
> 时间：2009-05-05T09:55:05.623
> 
> 标签：java, css

是否有现成的工具或实用程序可以做到这一点

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-05-05T10:30:37.707

您可以打开**CSS**文件并将其内容嵌入到*样式*标签中。

它不应该那么难：

```
FileReader frCSS = new FileReader("your_css.css");
FileReader frHTML = new FileReader("your_html.html");
FileWriter output = new FileWriter("result.html"); 
```

然后解析*frHTML*并将其内容复制到*输出*，直到找到开头的*标签*。当你这样做时，打开一个*样式*标签并从*frCSS*复制所有内容。然后，关闭*样式标签并复制**frHTML*的剩余部分。

这不漂亮，但可以做到。

# language-agnostic - 如何从 Web Designer 切换到 Front End Developer/Web Developer？

> ID：824150
> 
> 赞同：0
> 
> 时间：2009-05-05T09:55:06.623
> 
> 标签：language-agnostic

我想从 Web Designer 切换到 Front End Developer 或 Web 开发人员 PHP，我应该获得哪些技能，从 Designer 切换到 Developer 是否容易。我有两年的Exp。在网页设计。请建议。

或者我应该坚持在 DIV 布局之后为设计师设计**下一件大事。**

我当前的角色将 PSD 转换为 HTML，修复不同浏览器中的错误，对 HTML 和 CSS 有深入的了解。我想使用 PHP 和 MySQL 之类的开源编程

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2009-05-05T10:58:01.790

在设计方面，您可以学习 Flash 或 Silverlight。UX 和 UI 设计现在很热门。

在编程方面，您擅长客户端编程吗？JavaScript AJAX 等

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2009-05-05T11:33:46.963

@wazdesign，我没有像你这样的设计背景，但我在前端 Web 开发中找到了自己的定位。我从基于标准的 HTML 和 CSS 开始，然后开始研究 MVC 框架中的 Views 和 Helper 函数（由一个优秀的团队负责控制器、模型等）。请一位称职的 Web 开发人员给你一个基本的 Web -服务器架构和流程演示。了解数据库中的数据如何进入您的用户页面，以及数据在途中经过的所有检查点。一旦你理解了这些原则，在使用语法工具之后，你几乎可以使用任何技术。

我在下面列出了一些与技术无关的研究术语。我无法帮助您解决 PHP 方面的问题 :)

一些值得一读的书：

*   [日常用品的设计](https://rads.stackoverflow.com/amzn/click/com/0465067107)——唐·诺曼
*   [不要让我思考](https://rads.stackoverflow.com/amzn/click/com/0321344758)——史蒂夫·克鲁格
*   Luke Wroblewski 的任何作品，例如[Web 表单设计](https://rads.stackoverflow.com/amzn/click/com/B0018S232Q)
*   [高性能网站](https://rads.stackoverflow.com/amzn/click/com/0596529309)(O'Reilly)

一些研究术语：

*   交互设计
*   MVC 框架
*   模板系统
*   HTTP
*   用户界面

使用的一些工具：

*   萤火虫
*   Firebug 的 YSlow

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2009-05-07T15:26:26.857

我从“Web Designer”转到“User Experience / User Interface Designer”再到“Application Architect”。每个角色都很好地建立在下一个角色之上，并且不一定需要直接的编程知识，尽管我认为我作为架构师缺乏编程技能并不是常态。

我知道你问过关于进入开发者角色的问题，但我想我会提供这个作为替代方案。用户体验人员的市场现在似乎很强大，很可能你已经具备了许多所需的技能——开发线框图、设计应用程序工作流程、信息架构等。

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2009-06-19T16:18:59.993

# 设计师到开发者

我对此进行了很多思考，并写了一篇关于[设计师转变](http://perlbuzz.com/2008/08/why-do-designers-fail-to-adopt-perl.html)为 PerlBuzz 开发人员的文章，其中涵盖了许多必要的基础（尽管从 Perl 的角度来看）。

主要问题是：

1.  理解为什么要分离：编程代码、可视化标记和数据是一件好事
2.  了解一点[MVC](http://ootips.org/mvc-pattern.html)、框架和 HTML 模板
3.  学习[足够多的 Unix](http://freeengineer.org/learnUNIXin10minutes.html)（至少是[权限](http://www.washington.edu/computing/unix/permissions.html)和[路径](http://helpdesk.ua.edu/unix/tipsheet/tipv1n12.html)）来掌握和理解命令行
4.  尝试（比如说）一个简单的 Ruby 框架，比如[Sinatra](http://www.sinatrarb.com/)或[Ramaze](http://ramaze.net/)。[Camping](http://camping.rubyforge.org/files/README.html)非常适合学习 MVC（一个小文件中的所有内容），但目前缺乏确定的版本
5.  或者，花一天时间让 Python 框架[Django](http://www.djangoproject.com/)启动并运行——现在很热，Python 是一种很好的第一语言，[省去了 SQL](http://www.eflorenzano.com/blog/post/secrets-django-orm/)，正在非常活跃的开发中，大量的文档都在线
6.  使用[JQuery](http://jquery.com/)或其他[Javascript 库](http://www.javascriptlibraries.com/)来获得客户端的好处

[PHP 写得好](http://www.sitepoint.com/blogs/2007/05/25/good-and-bad-php-code/)，并且有利于学习如何构建 HTML 模板，[Symfony](http://www.symfony-project.org/)似乎是一个健全的框架，但要避免从 hacking（比如）WordPress 或 Joomla 开始。你只会学习……嗯，如何破解 WordPress 或 Joomla，而真正的飞跃在于学习编程。

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2009-05-05T23:01:09.383

我认为你在这里做得很好。对我来说，你表现出你想要成长和学习新事物的主动性。我的建议是你先学习如何编程。像 PHP 这样的编程语言的问题主要在于它真的很容易访问，这意味着它很容易获取、复制和粘贴一些代码等。PHP 因其剪切和过去的脚本心态而臭名昭著，但掌握在一个优秀的人手中程序员 它是一种与任何其他编程语言一样好的编程语言。

所以，为了避免成为一个剪切和粘贴的 PHP 程序员，首先要学习如何编程。了解变量、函数、控制语句、[算法](http://www.wrox.com/WileyCDA/WroxTitle/Beginning-Algorithms.productCd-0764596748.html)、面向对象编程、网络技术等。我建议您先[选择一本书](http://www.wrox.com/WileyCDA/WroxTitle/Beginning-Programming.productCd-0764584065.html)并开始学习基础知识，然后再深入研究。这样你就可以为自己打下良好的基础，避免成为剪切粘贴程序员。

祝你好运！

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2009-05-05T09:57:55.290

一些基本要求：

1.  需要有很强的能力
2.  了解使用任何语言进行编程的基础知识。（C/C++ 将是不错的选择）
3.  对于 Web 开发，您应该精通 html 和 javascript 以及后端（PHP、ASP.NET 等）

# http - 什么优先：ETag 或 Last-Modified HTTP 标头？

> ID：824152
> 
> 赞同：84
> 
> 时间：2009-05-05T09:55:40.787
> 
> 标签：http, caching, last-modified, etag

对于两个后续请求，以下两个标头中的哪一个会被浏览器赋予更大的权重，其中一个应该更改：ETag 还是 Last-Modified？

* * *

## 回答 #1

> 赞同：93
> 
> 时间：2009-10-13T13:01:15.683

根据[RFC 2616](http://www.ietf.org/rfc/rfc2616.txt)第 13.3.4 节，HTTP 1.1 客户端必须在任何缓存条件请求中使用 ETag，如果 ETag 和 Last Modified 都存在，则它应该同时使用两者。ETag 标头被认为是一个强验证器（参见第 13.3.3 节），除非服务器明确声明为弱，而 Last Modified 标头被认为是弱的，除非它与 Date 标头之间存在至少一分钟的差异。但是请注意，服务器不需要发送任何一个（但它应该，如果可以的话）。

请注意，客户端不会检查标头以查看它们是否已更改；它只是在下一个条件请求中盲目地使用它们；由服务器来评估是否发送请求的内容或 304 Not Modified 响应。如果服务器只发送一个，那么客户端将单独使用那个（尽管只有强验证器对 Range 请求有用）。当然，中间缓存（除非它们已通过缓存控制指令阻止缓存）和服务器也可以自行决定它们将如何作用于标头；RFC 声明，如果验证器不一致，它们不得返回 304 Not Modified，但由于标头值是由服务器生成的，因此它有很大的余地。

在实践中，我注意到 Chrome、FireFox 和 IE 7+ 都会发送两个标头（如果可用）。我还测试了发送修改后的标头时的行为，我已经从 RFC 中的信息中怀疑了这一点。我测试的四个客户端仅在页面被刷新或当前进程第一次请求页面时才发送条件请求。

* * *

## 回答 #2

> 赞同：21
> 
> 时间：2009-05-05T10:12:13.040

是不是更像一个“OR”表达式。在伪代码中：

```
if ETagFromServer != ETagOnClient || LastModifiedFromServer != LastModifiedOnClient
   GetFromServer
else
   GetFromCache 
```

* * *

## 回答 #3

> 赞同：8
> 
> 时间：2014-11-14T12:48:08.960

=！是正确的比较运算符。客户端需要保留从服务器接收到的文字字符串，因为转换可能会产生微小的差异。您不能假设“更新更好”。

为什么？考虑服务器操作员恢复资源的错误版本的情况。还原的版本较旧 - 但正确。

客户端必须使用服务器当前提供的版本；只有在相同的情况下，它才能使用缓存版本。因此，服务器必须检查相等性，而不是“更新”。

# c++ - 如何检查 STL 迭代器是否指向任何东西？

> ID：824157
> 
> 赞同：23
> 
> 时间：2009-05-05T09:56:49.597
> 
> 标签：c++, stl, iterator

> **可能重复：**
> [C++ 检查迭代器是否有效的最佳方法](https://stackoverflow.com/questions/2062956/c-best-way-to-check-if-an-iterator-is-valid)

我想做这样的事情：

```
std::vector<int>::iterator it;
// /cut/ search for something in vector and point iterator at it. 
if(!it) //check whether found
    do_something(); 
```

但是没有运营商！对于迭代器。如何检查迭代器是否指向任何东西？

* * *

## 回答 #1

> 赞同：48
> 
> 时间：2009-05-05T09:58:33.353

你不能。通常的习惯用法是使用容器的结束迭代器作为“未找到”标记。这就是`std::find`回报。

```
std::vector<int>::iterator i = std::find(v.begin(), v.end(), 13);
if (i != v.end())
{
     // ...
} 
```

对未赋值的迭代器唯一能做的就是给它赋值。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2009-05-05T10:08:13.690

尽管迭代器被认为是指针的一般形式，但它们并不完全是指针。该标准定义了`Past-the-end`迭代器来指示容器中的搜索失败。因此，不建议检查迭代器是否为 NULL

`Past-the-end`值是非奇异且不可解引用的。

```
if(it != aVector.end())  //past-the-end iterator
    do_something(); 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-05-05T10:02:06.810

如果你想在循环中使用迭代器，最安全的使用方式是：

```
for (std::vector<int>::iterator it = v.begin(); it != v.end(); ++it)
{
 do_smth();
} 
```

* * *

## 回答 #4

> 赞同：-2
> 
> 时间：2009-06-04T18:28:40.807

我相信这通常应该给你一个很好的测试：

```
if (iterator._Mycont == &MyContainer)
{
Probably a valid iterator!
} 
```

您可以进行测试以确保迭代器不等于结尾...

```
iterator != MyContainer.end() 
```

和：

```
iterator >= MyContainer.begin() 
```

# c++ - 应该为分析设置哪个编译选项？

> ID：824160
> 
> 赞同：3
> 
> 时间：2009-05-05T09:57:10.517
> 
> 标签：c++, visual-studio, profiling, intel-vtune

我需要通过 VC++ 分析使用英特尔编译器编译的应用程序。我正在使用 VTune 来分析我的代码。

我的理解是，在发布模式下，我将没有探查器在调试模式下分析我的代码所必需的调试信息，分析的结果将不相关。

我应该怎么办 ？是否可以在发布模式下添加调试信息？如何设置此模式？

如果是这样，我还会从所有优化（内联等）中受益吗？

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2009-05-05T10:25:12.430

您当然应该启用优化（编译器选项/O3）进行分析。/Zi 是英特尔编译器开关（在 Windows 上），用于启用调试信息。

由于优化，调试信息中可能会由于内联而缺少某些功能，但 VTune 会解决这个问题。

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2009-05-05T10:53:34.953

即使在发布目标中，您也可以生成程序数据库文件 (PDB)。转到项目属性，链接器/调试并检查选项“生成程序数据库文件”。它通常类似于“$(TargetDir)$(TargetName).pdb”。现在，这取决于 VTune 是否知道如何解释 PDB 文件......

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2009-05-05T14:36:41.110

函数内联和进程间优化将使您的配置文件难以解释。这就是为什么在调试和发布模式下进行分析是个好主意。如果发布模式仅显示函数 foo 使用了 80% 的程序时间，您可以使用调试配置文件查看内联到 foo 中的函数 bar 正在使用 foo 的 60% 的时间。

# c# - 序列化为 XML 并包含序列化对象的类型

> ID：824162
> 
> 赞同：5
> 
> 时间：2009-05-05T09:57:27.600
> 
> 标签：c#, xml-serialization

在上一个关于[将对象序列化为`XmlDocument`C# 中](https://stackoverflow.com/questions/781442/serialise-object-to-xmldocument)的问题中，我需要将一些错误信息序列化为`XmlDocument`从 asmx 样式的 Web 服务调用返回的一个。在客户端上，我需要反序列化`XmlDocument`回一个对象。

如果您知道类型，这很简单，但我意识到我想要一种灵活的方法，其中要反序列化的类型也编码在`XmlDocument`. 我目前正在通过向具有类型名称的 中添加一个`XmlNode`来手动执行此操作`XmlDocument`，计算如下：

```
 Type type = fault.GetType();
    string assemblyName = type.Assembly.FullName;

    // Strip off the version and culture info
    assemblyName = assemblyName.Substring(0, assemblyName.IndexOf(",")).Trim();

    string typeName = type.FullName + ", " + assemblyName; 
```

然后在客户端上，我首先从 中获取此类型名称`XmlDocument`，并创建传递给的类型对象`XmlSerialiser`：

```
 object fault;
        XmlNode faultNode = e.Detail.FirstChild;
        XmlNode faultTypeNode = faultNode.NextSibling;

        // The typename of the fault type is the inner xml of the first node
        string typeName = faultTypeNode.InnerXml;
        Type faultType = Type.GetType(typeName);

        // The serialised data for the fault is the second node
        using (var stream = new StringReader(faultNode.OuterXml))
        {
            var serialiser = new XmlSerializer(faultType);
            objectThatWasSerialised = serialiser.Deserialize(stream);
        }

        return (CastToType)fault; 
```

所以这是一种蛮力的方法，我想知道是否有一个更优雅的解决方案，它以某种方式自动包含序列化类型的类型名，而不是在其他地方手动记录它？

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2009-05-05T10:29:10.330

我遇到了类似的问题，我想出了相同的解决方案。就我而言，这是在 XML 序列化中将类型与值保持在一起的唯一方法。

我看到你正在削减装配版本，就像我一样。但我想提一下，你会遇到泛型类型的问题，因为它们的签名看起来像这样：

```
System.Nullable`1[[System.Int, mscorlib, Version=2.0.0.0, Culture=neutral, PublicKeyToken=b77a5c561934e089]], mscorlib, Version=2.0.0.0, Culture=neutral, PublicKeyToken=b77a5c561934e089 
```

所以我做了一个函数来只删除程序集版本，这似乎足以摆脱版本控制问题：

```
 private static string CutOutVersionNumbers(string fullTypeName)
    {
        string shortTypeName = fullTypeName;
        var versionIndex = shortTypeName.IndexOf("Version");
        while (versionIndex != -1)
        {
            int commaIndex = shortTypeName.IndexOf(",", versionIndex);
            shortTypeName = shortTypeName.Remove(versionIndex, commaIndex - versionIndex + 1);
            versionIndex = shortTypeName.IndexOf("Version");
        }
        return shortTypeName;
    } 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-05-05T10:04:25.930

尼尔，为什么你需要它在客户端和服务器上都是*相同*的类型？

您还在客户端上使用 ASMX 吗？这将是一个原因，因为 ASMX 不能正确支持故障。

另外，您是否有太多不同的故障类型，以至于一个简单的*switch*语句无法确定要使用的正确类型？

# nhibernate - 方法join没有实现

> ID：824172
> 
> 赞同：0
> 
> 时间：2009-05-05T09:59:37.330
> 
> 标签：nhibernate

我正在使用 Fluent NHibernate，

我编写了以下代码来选择客户名称和 CustProdId。

当我执行代码时，我得到了错误，

> “方法加入未实现。”

如何为此查询编写内部联接？

```
var data = (from cp in session.Linq<CustomerProduct>()                        
                     join cu in session.Linq<Customer>()
                         on cp.customerId equals cu.customerID                        
                     select new
                     {
                         cp.CUSTPRODID,
                        cu.CUSTOMERNAME
                     }).Distinct(); 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-05-07T15:19:26.640

这是 Fluent NHibernate 附带的 Linq to NHibernate 实现的限制，而不是 FNH 直接附带的。

基本上，在 NHibernate 主干中完成重写之前，您将无法使用 linq 进行复杂查询。您应该使用 Criteria API 或 HQL。

# c# - 将 IQueryable 集合导出到 Excel

> ID：824174
> 
> 赞同：2
> 
> 时间：2009-05-05T10:00:22.227
> 
> 标签：c#, asp.net, linq, linq-to-sql, excel

我有一个巨大的 IQueryable，我想直接导出到 Excel 以进行数据转储，我该怎么做？

我试图将它放入 GridView 并从那里导出，如果我只使用一大块数据，它就可以工作，但如果我使用整个 IQueryable，什么也不会发生。

这是一个有 4k 行的表，每行有 70 列左右。

编辑：如果这更容易的话，CSV文件也可以！

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-05-05T11:11:58.293

为什么不直接写文件呢？使用`foreach`,`IQueryable`并逐行写出 CSV 文件。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-05-05T17:19:20.300

CSV 可能不是最好的解决方案。我一直在处理非常大的数据集，并使用与此类似的功能。我将假设它是否是 IQueryable 它也是 IEnumerable。这是示例代码，请随意使用它。如果分隔符是“，”，那么它将输出一个 CSV，如果分隔符是一个“\t”，您将输出一个 Excel 可读文件。无论哪种方式，在运行此方法输出数据之前，您都需要执行类似于输出包含列标题的单行标题的操作。

```
//This is changed slightly from my actual code but it should give you an idea of what to do
//tickStorage contains a dictionary named MessageData and the key is the column name
//Obviously tickStorage is what is being directly mapped to my listView component

private void OutputItems(StreamWriter writer, int startIndex, int endIndex, String delimiter)
{
    endIndex = endIndex < tickStorage.Count ? endIndex : tickStorage.Count;
    for (Int32 i = startIndex; i < endIndex; i++)
    {
    IEnumerator<Columns> fields = listView.ColumnsInDisplayOrder.GetEnumerator();
    fields.MoveNext();
    writer.Write((tickStorage[i].MessageData[fields.Current.Text]).Trim());
    while (fields.MoveNext())
    {
        writer.Write(delimiter + (tickStorage[i].MessageData[fields.Current.Text]).Trim());
    }
    writer.WriteLine();
    }
} 
```

# css - IE6 双倍边距错误

> ID：824175
> 
> 赞同：1
> 
> 时间：2009-05-05T10:00:37.373
> 
> 标签：css, internet-explorer, internet-explorer-6

当我们将一个固定宽度的 div 元素向左浮动时，`margin-left`' 的值加倍。有没有可用的解决方案？

我更喜欢不需要 JavaScript 的解决方案。

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2009-05-05T10:05:39.717

如果我没记错的话，设置

```
display: inline 
```

到这个DIV就可以解决问题了。

- 编辑：

[此错误的详细信息](http://www.positioniseverything.net/explorer/doubled-margin.html)

# java - 在远程 jvm 中执行一个类

> ID：824187
> 
> 赞同：2
> 
> 时间：2009-05-05T10:05:01.997
> 
> 标签：java, jvm

我有一个小型测试类，我想在已经启动并运行的特定 jvm 上运行（基本上它是在 Tomcat 上运行的 Web 应用程序）。我想这样做的原因是我想在该 jvm 中执行一个小型测试类（使用 main 方法和所有方法），以便为我的测试类获得相同的环境（加载和初始化的类）。

是否可以通过 jvm 参数表明它不应该初始化一个新的虚拟机来执行我的类，而是去远程虚拟机上执行并在我的控制台上显示结果。所以本地 jvm 充当一种瘦代理？

我不知道是否有一些工具可以使这成为可能。还在某处听说 java 6 jvm 带有这样的选项，这是真的吗？请帮我。

谢谢，

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2015-11-15T20:18:56.983

在阅读了这个问题和答案后，我决定推出自己的小实用程序：[remoteJunit](https://github.com/ruediste/remote-junit)

它是轻量级的，可以将类从客户端动态加载到服务器 JVM。它使用 HTTP 进行通信。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-06-05T11:59:53.540

您可能想看看[btrace](https://btrace.dev.java.net/)。它允许您在已经启动的 JVM 中运行代码，前提是您不更改该 JVM 中变量的状态。通过这种跟踪，您可能能够以不同的方式解决您的问题。不是通过以新类的形式运行额外的代码，而是通过向 JVM 中运行的现有类添加安全代码。

例如，`System.out.println`当调用`File.exists`.

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-11-01T01:34:48.593

我假设“小型测试类”基本上是您想要运行以监控真实应用程序的一些调试代码，该应用程序远程部署在 Tomcat 上。如果是这种情况，您应该将 Eclipse 调试器远程连接到 Tomcat 实例，这样您就可以在感兴趣的位置设置断点，然后使用 Eclipse 的 Display 视图运行您可能需要执行高级调试代码的任意代码。由于 java 使用调试机制支持热代码替换，您还可以在运行时使用新代码更改远程端的现有代码。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2009-05-05T11:28:41.000

您可能会发现 JMX 很有用。`MBean`在服务器进程中注册一个。`visualvm`用（或）调用它`jconsole`。[（教程）](http://java.sun.com/docs/books/tutorial/jmx/mbeans/standard.html)请注意，我自己从未尝试过。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2009-06-05T11:41:47.913

RMI 也会发挥作用。

[http://java.sun.com/javase/6/docs/technotes/guides/rmi/index.html](http://java.sun.com/javase/6/docs/technotes/guides/rmi/index.html)

让您的 Web 应用程序启动一个 RMI 注册表并在那里注册您的服务 bean。

然后在其他 JVM 中，您可以运行一个程序来查询由您的 Web 应用程序启动的 RMI 注册表以获取您想要验证的服务，然后您就完成了。

# c# - WPF UIElements 中的动态 TextSize

> ID：824189
> 
> 赞同：4
> 
> 时间：2009-05-05T10:05:49.903
> 
> 标签：c#, wpf, font-size, uielement

正如建议的那样，我允许我所有的 WPF`UIElement`具有动态大小，因此可以轻松调整它们的大小，但是，在`TextBlock`s 中，我必须指定`Font`. 这意味着当元素的大小增加或减小时，字体大小保持不变。有没有办法让`Font`尺寸变成动态的？

* * *

## 回答 #1

> 赞同：14
> 
> 时间：2009-05-05T11:06:46.543

尝试将控件内的文本放入`Viewbox`：

```
<Button>
    <Viewbox>
        <TextBlock>Text To Resize</TextBlock>
    </Viewbox>
</Button> 
```

# sql-server-2005 - 仅当插入记录时标识才增加

> ID：824190
> 
> 赞同：1
> 
> 时间：2009-05-05T10:05:50.763
> 
> 标签：sql-server-2005, tsql, transactions

sql server 2005：我在员工表中有一个带有标识的列empid。如果在将数据插入表时出现一些错误。标识增加。我希望只有在插入记录时标识才增加。就像我生成了emp id从 1 到 5，然后在第 6 条记录插入错误发生。下一条记录插入标识值将是 7。我希望它是 6。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-05-05T10:21:38.307

你为什么要那样做？

身份列应该只用作数据库的“内部管理价值”，它不应该有“商业价值”，那么为什么在这个序列中有空白很重要呢？
如果正确使用身份，那么您的软件的用户将永远不会面对具有身份值的列；您只需使用它来唯一标识一条记录。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-05-05T10:08:49.617

我不认为这是可以做到的。如果您希望您的身份号码完全连续，那么您可能必须自己生成它们，而不是使用 SQL 身份功能。

编辑：即使回滚失败的交易也不会使身份计数回落，这是设计使然，请参阅[this other question](https://stackoverflow.com/questions/282451/sql-identity-autonumber-is-incremented-even-with-a-transaction-rollback)。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2009-05-05T16:58:20.693

如果存在差距，您有什么正当的商业理由来关心？数据库没有理由关心，也没有理由要确保身份值永远不会被重用于其他东西，因为它们可能会导致数据完整性出现重大问题，例如根据旧报告查找信息等。假设您有一个报告显示上个月的订单，然后您删除其中一条记录，因为客户被重复并因此被删除。然后，您为已删除的重复客户重复使用身份字段。现在有人在上个月的报告中查找客户 12345，与该客户相关的数据属于 John Smith 而不是 Sally Jones。但是这个人不知道，因为她使用的是聚合，所以现在她有完全可以避免的不正确信息。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2009-05-05T10:21:46.607

当您需要具有此特定行为时，您应该使用存储过程来生成 ID。这样你就可以真正地回滚了。但请记住，当前的行为是有目的的。当您不对保存当前或下一个 ID 值的主数据表中的 id 字段使用锁定时，事务隔离和不同的读取级别（脏读）很可能会给您带来麻烦。

# ms-access - 如何在 MS-Access 表单中使用 400 个字段？

> ID：824196
> 
> 赞同：0
> 
> 时间：2009-05-05T10:07:50.820
> 
> 标签：ms-access, field, max

我知道 MS-Access 表单中的最大字段数是 255。有没有办法绕过这个限制？

我正在使用一个包含大约 400 个字段的心理健康调查表。

我想创建 1 个数据输入表，让心理健康访问员在一张表上输入所有回复。

我计划使用标签来促进数据输入的移动。

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2009-05-06T01:07:28.787

Access 记录源中的最大字段数为 255，与任何 Jet SQL 语句一样。*在表单的整个生命周期内，表单*上的控件数量限制为 754 （即，删除控件不会获得额外的控件）。

设计显然不正确，但通常情况下，我们无法选择这些东西！

在这种情况下，我能想到的唯一解决方案是一个主表单，它有一个字段，PK，然后是一堆带有字段子集的子表单，例如每个字段 100 个。这意味着您必须非常小心地确保您的子表单将其编辑保存在其 OnExit 事件中（否则您将遇到写入冲突）。

而且，不，这根本不是一个好的设计。

但是，如果您因为有一个无法正确规范化的外部数据源而被迫拥有 400 个字段，那么它至少是一种解决方法。

# sharepoint - SharePoint：如何使用列表中的 CAML 查询获取前 5 条记录

> ID：824202
> 
> 赞同：18
> 
> 时间：2009-05-05T10:08:53.687
> 
> 标签：sharepoint, caml

我已经创建了一个 webpart 来显示列表中的数据，但我真正想要的是只显示该列表中的前 5 条记录（通过使用 CAML 查询）。

有谁知道如何做到这一点？非常感谢。

```
<Query>
   <OrderBy>
      <FieldRef Name='ID' Ascending='False' />
   </OrderBy>
</Query> 
```

* * *

## 回答 #1

> 赞同：23
> 
> 时间：2009-05-05T11:36:49.110

您可以设置 SPQuery 对象的 RowLimit 属性。

该`<RowLimit>`标记位于视图的架构定义中（ < 的直接子级`View>`），因此不能嵌套在`<Query>`标记内。

* * *

## 回答 #2

> 赞同：10
> 
> 时间：2009-12-09T16:12:41.510

下面的代码显示了列表中的前 5 条记录（通过使用 CAML 查询）。

```
SPQuery spQuery = new SPQuery();
spQuery.Query = "<OrderBy><FieldRef Name='ID' Ascending='FALSE'/></OrderBy>";
spQuery.RowLimit = 5; 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2014-04-03T09:56:49.023

如果您想构建其他简单的 caml 查询，请尝试使用此工具。 [http://www.camldesigner.com/](http://www.camldesigner.com/)

Ps 工具不会使用 SPListItemCollectionPosition 构造“分页”caml 查询。

# ruby-on-rails - 在处理电子邮件回复时，我如何忽略任何电子邮件客户端的详细信息和历史记录？

> ID：824205
> 
> 赞同：6
> 
> 时间：2009-05-05T10:10:13.857
> 
> 标签：ruby-on-rails, ruby, email, parsing

我有一个通过 IMAP 处理传入电子邮件的 rails 应用程序。目前使用的方法是在 TMail 对象的各个部分中搜索给定的 content_type：

```
def self.search_parts_for_content_type(parts, content_type = 'text/html')
    parts.each do |part|
      if part.content_type == content_type
        return part.body
      else
        if part.multipart?
          if body = self.search_parts_for_content_type(part.parts, content_type)
            return body
          end
        end
      end
    end

    return false
 end 
```

这些电子邮件通常是为了响应它首先发送的 html 电子邮件。（原始的出站电子邮件永远不会相同。）上面的方法返回的正文包含电子邮件的完整历史记录，我只想解析出回复文本。

1.  我想知道在邮件顶部放置一些“---请在此行上方回复---”文本是否合理，正如我在 37 信号应用程序中看到的那样。

2.  除了为每个邮件客户端编写大量正则表达式（我还没有尝试过）之外，还有其他方法可以忽略电子邮件中客户端的特定添加吗？他们似乎都在任何回复的顶部加入了自己的观点。

* * *

## 回答 #1

> 赞同：9
> 
> 时间：2009-05-06T18:47:18.143

我必须对我正在处理的项目进行电子邮件回复解析。我最终使用模式匹配来识别响应部分，因此用户不必担心在哪里插入他们的回复。

好消息是实施真的不是太难。困难的部分只是测试您想要支持的所有不同的电子邮件客户端和服务，并弄清楚如何识别每一个。通常，您可以使用消息 ID 或 X-Mailer 或 Return-Path 标头来确定传入电子邮件的来源。

这是一个方法，它采用 TMail 对象并提取消息的响应部分并将其与发送它的电子邮件客户端/服务一起返回。`FROM_NAME`它假定您在常量和中具有原始消息的 From: 名称和地址`FROM_ADDRESS`。

```
def find_reply(email)
  message_id = email.message_id('')
  x_mailer = email.header_string('x-mailer')

  # For optimization, this list could be sorted from most popular to least popular email client/service
  rules = [
    [ 'Gmail', lambda { message_id =~ /.+gmail\.com>\z/}, /^.*#{FROM_NAME}\s+<#{FROM_ADDRESS}>\s*wrote:.*$/ ],
    [ 'Yahoo! Mail', lambda { message_id =~ /.+yahoo\.com>\z/}, /^_+\nFrom: #{FROM_NAME} <#{FROM_ADDRESS}>$/ ],
    [ 'Microsoft Live Mail/Hotmail', lambda { email.header_string('return-path') =~ /<.+@(hotmail|live).com>/}, /^Date:.+\nSubject:.+\nFrom: #{FROM_ADDRESS}$/ ],
    [ 'Outlook Express', lambda { x_mailer =~ /Microsoft Outlook Express/ }, /^----- Original Message -----$/ ],
    [ 'Outlook', lambda { x_mailer =~ /Microsoft Office Outlook/ }, /^\s*_+\s*\nFrom: #{FROM_NAME}.*$/ ],

    # TODO: other email clients/services

    # Generic fallback
    [ nil, lambda { true }, /^.*#{FROM_ADDRESS}.*$/ ]
  ]

  # Default to using the whole body as the reply (maybe the user deleted the original message when they replied?)
  notes = email.body
  source = nil

  # Try to detect which email service/client sent this message
  rules.find do |r|
    if r[1].call
      # Try to extract the reply.  If we find it, save it and cancel the search.
      reply_match = email.body.match(r[2])
      if reply_match
        notes = email.body[0, reply_match.begin(0)]
        source = r[0]
        next true
      end
    end
  end

  [notes.strip, source]
end 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-05-05T20:59:10.677

我想你会被困在这个上。最近我自己在 TMail 中对电子邮件进行了一些处理，您通常会发现具有 HTML 部分的电子邮件通常结构如下：

```
part 1 - multipart/mixed
  sub part 1 - text/plain
  sub part 2 - text/html
end 
```

我使用 Outlook 和 Gmail 玩过的电子邮件客户端都以这种格式生成回复，并且它们通常只是在回复中引用原始电子邮件。起初我认为原始电子邮件的“旧”部分将是单独的部分，但实际上它们不是 - 旧部分只是合并到回复部分中。

您可以在该部分中搜索以“发件人：”开头的行（因为大多数客户通常会在原始电子邮件文本的顶部放置一个标题，详细说明发送者等），但可能无法保证。

我真的看不出有什么问题——请在此行上方回复——一般来说，它没有那么侵入性，并且可以让事情变得更简单。

# java - 学习 Hibernate 的好书或在线资源

> ID：824214
> 
> 赞同：3
> 
> 时间：2009-05-05T10:12:56.097
> 
> 标签：java, hibernate, jpa

到目前为止，我发现了一些这样的在线资源：

[http://www.torsten-horn.de/techdocs/java-hibernate.htm](http://www.torsten-horn.de/techdocs/java-hibernate.htm) (德国)

[https://www.hibernate.org/5.html](https://www.hibernate.org/5.html)（休眠文档）

[http://docs.jboss.org/hibernate/stable/core/reference/en/html/tutorial.html](http://docs.jboss.org/hibernate/stable/core/reference/en/html/tutorial.html)

[http://www.manning.com/bauer2/chapter2.pdf（Java](http://www.manning.com/bauer2/chapter2.pdf) Persistence with Hibernate 的示例章节）

[http://www.wenzlaff.de/hibernate.html](http://www.wenzlaff.de/hibernate.html) (德国)

所以这是一个很好的开始方式，但我想知道你是否可以推荐任何学习 Hibernate 的好书，或者你知道其他一些非常好的在线资源来学习它？

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2009-05-05T11:43:32.243

[Java Persistence with Hibernate](http://www.manning.com/bauer2/)是“Hibernate in Action”的第二版。他们更改了名称，因为他们现在提供 JPA 示例以及 Hibernate。

[High-Performance Java Persistence](https://vladmihalcea.com/books/high-performance-java-persistence/)也值得一读，因为它解释了哪些 Hibernate 特性是高效的，而您应该远离哪些特性。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2009-05-05T11:26:42.410

**Christian Bauer 和 Gavin King 的**Hibernate in Action****

 **它有点过时了，但是是一个很好的介绍。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2009-05-05T10:18:17.923

访问[www.flazx.com](http://www.flazx.com/search.php?p=hibernate&submit=Search)。我猜 Professional Hibernate (Programmer to Programmer) 会是一个不错的选择

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2009-05-05T10:22:32.610

这些是我收藏的一些链接：

*   [http://www.laliluna.de](http://www.laliluna.de/struts-hibernate-integration-tutorial-en.html)
*   [休眠基础](http://www.developer.com/open/article.php/3559931)

然而，在我看来，Java Persistence with Hibernate 绝对值得花时间和金钱来阅读它。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2009-05-05T10:20:29.807

尝试在[www.scribd.com上搜索](http://www.scribd.com/)

# asp.net - 覆盖 PrincipalPermissionAttribute SecurityAction.Demand 方法

> ID：824215
> 
> 赞同：0
> 
> 时间：2009-05-05T10:13:08.793
> 
> 标签：asp.net, security

如何覆盖 PrincipalPermissionAttribute SecurityAction.Demand 方法？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-05-05T10:16:09.287

你不能。两者都是密封类`PrincipalPermission`。`PrincipalPermissionAttribute`

# vb6 - VB6 中的 VSFlexgrid 许可问题

> ID：824216
> 
> 赞同：2
> 
> 时间：2009-05-05T10:13:17.233
> 
> 标签：vb6, licensing, vsflexgrid

我在 VB6 中遇到了 VideoSoft VSFlexGrid 7.0 的许可问题。当我创建一个新的 FlexGrid 时，它会触发一个带有许可/关于消息的消息框。我们有许可证，但似乎 VB 并没有完全保留它。有没有办法摆脱这个消息？

我目前使用一种解决方法：不是创建新的 FlexGrid，而是复制现有的 FlexGrid 并根据需要对其进行修改。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-05-05T10:41:38.337

您使用的是什么操作系统？我对旧的 flexgrid 和 64 位 Vista 有问题 - flexgrid 安装程序是 16 位的，不能在 64 位 Vista 上运行；没有安装程序许可证信息无法写入注册表。我在这个项目中使用 XP。

如果 flexgrid 安装程序在您的系统中运行，只需重新安装它（以管理员权限运行！） - 这应该会在注册表中创建开发人员许可证。只需重新注册 ocx 文件不会创建开发人员许可证。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-05-14T23:00:35.353

遗憾的是，注册组件与许可无关。VB 自定义组件（可选）附带一个 lic 文件，该文件由应用程序安装程序添加到注册表中。如果没有正确的 lic 详细信息，您可以在运行时实例化控件，但不能在设计时实例化。

因此，解决此问题的最可能方法是重新运行原始 Flex Grid 安装程序。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2009-05-05T10:21:40.177

您可以尝试手动重新注册 OCX 组件。在命令行窗口中，运行`regsvr32`后跟 .ocx 文件的名称。

# java - 抛出 RuntimeException 的方法应该在方法签名中指出它吗？

> ID：824217
> 
> 赞同：96
> 
> 时间：2009-05-05T10:13:39.247
> 
> 标签：java, exception, oop, exception-handling

例如，框架/JDK 中的许多方法可能会抛出

```
java.lang.SecurityException 
```

但这在方法签名中没有说明（因为这是通常为检查异常保留的做法）。我想说在方法 sigs 中声明 RuntimeExceptions 有很多好处（例如类似于静态类型检查）。我是喝醉了还是其他？

* * *

## 回答 #1

> 赞同：74
> 
> 时间：2009-05-05T13:24:14.840

我不会在签名中声明未经检查的异常，因为它会误导该 API 的用户。是否必须显式处理异常不再明显。

在 javadoc 中声明它是一种更好的方法，因为它允许某人在认为有必要时处理它，但知道如果他们愿意可以忽略它。这使得检查和未检查之间的分离变得清晰。

* * *

## 回答 #2

> 赞同：44
> 
> 时间：2012-09-04T18:37:17.727

来自[Oracle Java 教程](http://docs.oracle.com/javase/tutorial/essential/exceptions/runtime.html)：

> “如果记录一个方法的 API 非常好，包括它可以抛出的异常，为什么不指定运行时异常呢？” 运行时异常表示由编程问题引起的问题，因此，不能合理地期望 API 客户端代码从它们中恢复或以任何方式处理它们。此类问题包括算术异常，例如除以零；指针异常，例如试图通过空引用访问对象；和索引异常，例如尝试通过太大或太小的索引访问数组元素。
> 
> 运行时异常可以在程序中的任何地方发生，并且在一个典型的程序中它们可能非常多。**必须在每个方法声明中添加运行时异常会降低程序的清晰度。**

* * *

## 回答 #3

> 赞同：19
> 
> 时间：2009-05-05T11:28:31.733

查看 Collection#add 的 javadoc

提到了一大堆未经检查的异常：

```
Throws:
UnsupportedOperationException - add is not supported by this collection.
ClassCastException - class of the specified element prevents it from being added to this collection.
NullPointerException - if the specified element is null and this collection does not support null elements.
IllegalArgumentException - some aspect of this element prevents it from being added to this collection. 
```

如果您有耐心，我建议您以这种方式彻底记录您的方法引发的可能异常。在某种程度上，对未经检查的异常执行此操作更为重要，因为检查的异常在某种程度上是自记录的（编译器强制调用代码确认它们）。

* * *

## 回答 #4

> 赞同：8
> 
> 时间：2009-05-05T10:17:07.490

在我看来，至少在该方法的 javadoc 中声明运行时异常会更好。在签名中声明它可以让出现问题时可能发生的事情变得更加明显。这是我建议提供此信息的主要原因。

仅供参考：随着时间的推移（现在是 2017 年），我现在更倾向于仅在 javadoc 中记录它们并尽可能避免检查异常。

* * *

## 回答 #5

> 赞同：3
> 
> 时间：2009-05-05T11:12:40.773

在我看来，不应该在方法签名中声明未经检查的异常，因为这与其性质相反。

但是，如果某个方法可能会抛出一些未经检查的异常，请注意 Javadoc 中 @throws 中可能出现的情况，这可能有助于其他调用该方法的人了解可能出现的问题。这仅对调用者可能能够处理的异常有用（例如由于输入错误等导致的 NPE）

* * *

## 回答 #6

> 赞同：3
> 
> 时间：2009-05-05T11:45:02.613

如果您正在编写供他人使用的 api，那么有充分的理由在 api 中明确记录您的意图，并且在方法签名中声明 RuntimeExceptions 没有任何不利之处。

* * *

## 回答 #7

> 赞同：1
> 
> 时间：2009-05-05T10:30:07.850

这与关于[检查异常](https://stackoverflow.com/questions/613954/the-case-against-checked-exceptions)的讨论有关。大多数人会同意不应在方法签名中声明异常。

还有关于如何使用运行时异常的[讨论。](https://stackoverflow.com/questions/499437/in-java-when-should-i-create-a-checked-exception-and-when-should-it-be-a-runtim)我同意一位发帖者的观点，即运行时异常应该表示编程错误或致命情况。因此，在签名中声明它们并没有多大价值。每种方法都可能通过一种方法。

# sql - if 语句 SQL

> ID：824225
> 
> 赞同：3
> 
> 时间：2009-05-05T10:16:02.563
> 
> 标签：sql

嗨，我想运行一个 if 语句，但在我的所有 AS 别名附近不断出现语法错误，我做错了什么？

```
SELECT

IF @Origin = 'ALL'

(SELECT COUNT(*)  FROM TBL_PARTORDER INNER JOIN TBL_REPAIR_ORDER ON TBL_PARTORDER.ORDERID = TBL_REPAIR_ORDER.ORDERID INNER JOIN TBL_PROPERTY ON TBL_REPAIR_ORDER.PROPREF = TBL_PROPERTY.PROPREF WHERE (TBL_PARTORDER.RAISED IS NOT NULL) AND (TBL_PARTORDER.RAISED BETWEEN CONVERT(DATETIME,@STARTDATE, 103) AND DATEADD(hh,23,CONVERT(DATETIME,@ENDDATE, 103))) AND (TBL_PROPERTY.CONTRACT = @CONTRACT) AND DATEDIFF(mi, TBL_PARTORDER.RAISED, TBL_PARTORDER.RECEIVED) <= 60) AS OneHour,
(SELECT COUNT(*)  FROM TBL_PARTORDER INNER JOIN TBL_REPAIR_ORDER ON TBL_PARTORDER.ORDERID = TBL_REPAIR_ORDER.ORDERID INNER JOIN TBL_PROPERTY ON TBL_REPAIR_ORDER.PROPREF = TBL_PROPERTY.PROPREF WHERE (TBL_PARTORDER.RAISED IS NOT NULL) AND (TBL_PARTORDER.RAISED BETWEEN CONVERT(DATETIME,@STARTDATE, 103) AND DATEADD(hh,23,CONVERT(DATETIME,@ENDDATE, 103))) AND (TBL_PROPERTY.CONTRACT = @CONTRACT) AND DATEDIFF(mi, TBL_PARTORDER.RAISED, TBL_PARTORDER.RECEIVED) BETWEEN 61 AND 120) AS TwoHour,
(SELECT COUNT(*)  FROM TBL_PARTORDER INNER JOIN TBL_REPAIR_ORDER ON TBL_PARTORDER.ORDERID = TBL_REPAIR_ORDER.ORDERID INNER JOIN TBL_PROPERTY ON TBL_REPAIR_ORDER.PROPREF = TBL_PROPERTY.PROPREF WHERE (TBL_PARTORDER.RAISED IS NOT NULL) AND (TBL_PARTORDER.RAISED BETWEEN CONVERT(DATETIME,@STARTDATE, 103) AND DATEADD(hh,23,CONVERT(DATETIME,@ENDDATE, 103))) AND (TBL_PROPERTY.CONTRACT = @CONTRACT) AND DATEDIFF(mi, TBL_PARTORDER.RAISED, TBL_PARTORDER.RECEIVED) BETWEEN 121 AND 180) AS ThreeHour,
(SELECT COUNT(*)  FROM TBL_PARTORDER INNER JOIN TBL_REPAIR_ORDER ON TBL_PARTORDER.ORDERID = TBL_REPAIR_ORDER.ORDERID INNER JOIN TBL_PROPERTY ON TBL_REPAIR_ORDER.PROPREF = TBL_PROPERTY.PROPREF WHERE (TBL_PARTORDER.RAISED IS NOT NULL) AND (TBL_PARTORDER.RAISED BETWEEN CONVERT(DATETIME,@STARTDATE, 103) AND DATEADD(hh,23,CONVERT(DATETIME,@ENDDATE, 103))) AND (TBL_PROPERTY.CONTRACT = @CONTRACT) AND DATEDIFF(mi, TBL_PARTORDER.RAISED, TBL_PARTORDER.RECEIVED) BETWEEN 181 AND 240) AS FourHour,
(SELECT COUNT(*)  FROM TBL_PARTORDER INNER JOIN TBL_REPAIR_ORDER ON TBL_PARTORDER.ORDERID = TBL_REPAIR_ORDER.ORDERID INNER JOIN TBL_PROPERTY ON TBL_REPAIR_ORDER.PROPREF = TBL_PROPERTY.PROPREF WHERE (TBL_PARTORDER.RAISED IS NOT NULL) AND (TBL_PARTORDER.RAISED BETWEEN CONVERT(DATETIME,@STARTDATE, 103) AND DATEADD(hh,23,CONVERT(DATETIME,@ENDDATE, 103))) AND (TBL_PROPERTY.CONTRACT = @CONTRACT) AND DATEDIFF(mi, TBL_PARTORDER.RAISED, TBL_PARTORDER.RECEIVED) BETWEEN 241 AND 480) AS EightHour,
(SELECT COUNT(*)  FROM TBL_PARTORDER INNER JOIN TBL_REPAIR_ORDER ON TBL_PARTORDER.ORDERID = TBL_REPAIR_ORDER.ORDERID INNER JOIN TBL_PROPERTY ON TBL_REPAIR_ORDER.PROPREF = TBL_PROPERTY.PROPREF WHERE (TBL_PARTORDER.RAISED IS NOT NULL) AND (TBL_PARTORDER.RAISED BETWEEN CONVERT(DATETIME,@STARTDATE, 103) AND DATEADD(hh,23,CONVERT(DATETIME,@ENDDATE, 103))) AND (TBL_PROPERTY.CONTRACT = @CONTRACT) AND  DATEDIFF(mi, TBL_PARTORDER.RAISED, TBL_PARTORDER.RECEIVED) BETWEEN 481 AND 1440) AS TwentyFourHour,
(SELECT COUNT(*)  FROM TBL_PARTORDER INNER JOIN TBL_REPAIR_ORDER ON TBL_PARTORDER.ORDERID = TBL_REPAIR_ORDER.ORDERID INNER JOIN TBL_PROPERTY ON TBL_REPAIR_ORDER.PROPREF = TBL_PROPERTY.PROPREF WHERE (TBL_PARTORDER.RAISED IS NOT NULL) AND (TBL_PARTORDER.RAISED BETWEEN CONVERT(DATETIME,@STARTDATE, 103) AND DATEADD(hh,23,CONVERT(DATETIME,@ENDDATE, 103))) AND (TBL_PROPERTY.CONTRACT = @CONTRACT) AND DATEDIFF(mi, TBL_PARTORDER.RAISED, TBL_PARTORDER.RECEIVED) BETWEEN 1441 AND 2880) AS FortyEightHour,
(SELECT COUNT(*)  FROM TBL_PARTORDER INNER JOIN TBL_REPAIR_ORDER ON TBL_PARTORDER.ORDERID = TBL_REPAIR_ORDER.ORDERID INNER JOIN TBL_PROPERTY ON TBL_REPAIR_ORDER.PROPREF = TBL_PROPERTY.PROPREF WHERE (TBL_PARTORDER.RAISED IS NOT NULL) AND (TBL_PARTORDER.RAISED BETWEEN CONVERT(DATETIME,@STARTDATE, 103) AND DATEADD(hh,23,CONVERT(DATETIME,@ENDDATE, 103))) AND (TBL_PROPERTY.CONTRACT = @CONTRACT) AND DATEDIFF(mi, TBL_PARTORDER.RAISED, TBL_PARTORDER.RECEIVED) >=2881) AS PlusFortyEightHour

END
ELSE

(SELECT COUNT(*)  FROM TBL_PARTORDER INNER JOIN TBL_REPAIR_ORDER ON TBL_PARTORDER.ORDERID = TBL_REPAIR_ORDER.ORDERID INNER JOIN TBL_PROPERTY ON TBL_REPAIR_ORDER.PROPREF = TBL_PROPERTY.PROPREF WHERE (TBL_PARTORDER.RAISED IS NOT NULL) AND (TBL_PARTORDER.RAISED BETWEEN CONVERT(DATETIME,@STARTDATE, 103) AND DATEADD(hh,23,CONVERT(DATETIME,@ENDDATE, 103))) AND (TBL_PROPERTY.CONTRACT = @CONTRACT) AND (TBL_REPAIR_ORDER.ORIGIN = @ORIGIN) AND DATEDIFF(mi, TBL_PARTORDER.RAISED, TBL_PARTORDER.RECEIVED) <= 60) AS OneHour,
(SELECT COUNT(*)  FROM TBL_PARTORDER INNER JOIN TBL_REPAIR_ORDER ON TBL_PARTORDER.ORDERID = TBL_REPAIR_ORDER.ORDERID INNER JOIN TBL_PROPERTY ON TBL_REPAIR_ORDER.PROPREF = TBL_PROPERTY.PROPREF WHERE (TBL_PARTORDER.RAISED IS NOT NULL) AND (TBL_PARTORDER.RAISED BETWEEN CONVERT(DATETIME,@STARTDATE, 103) AND DATEADD(hh,23,CONVERT(DATETIME,@ENDDATE, 103))) AND (TBL_PROPERTY.CONTRACT = @CONTRACT) AND (TBL_REPAIR_ORDER.ORIGIN = @ORIGIN) AND DATEDIFF(mi, TBL_PARTORDER.RAISED, TBL_PARTORDER.RECEIVED) BETWEEN 61 AND 120) AS TwoHour,
(SELECT COUNT(*)  FROM TBL_PARTORDER INNER JOIN TBL_REPAIR_ORDER ON TBL_PARTORDER.ORDERID = TBL_REPAIR_ORDER.ORDERID INNER JOIN TBL_PROPERTY ON TBL_REPAIR_ORDER.PROPREF = TBL_PROPERTY.PROPREF WHERE (TBL_PARTORDER.RAISED IS NOT NULL) AND (TBL_PARTORDER.RAISED BETWEEN CONVERT(DATETIME,@STARTDATE, 103) AND DATEADD(hh,23,CONVERT(DATETIME,@ENDDATE, 103))) AND (TBL_PROPERTY.CONTRACT = @CONTRACT) AND (TBL_REPAIR_ORDER.ORIGIN = @ORIGIN) AND DATEDIFF(mi, TBL_PARTORDER.RAISED, TBL_PARTORDER.RECEIVED) BETWEEN 121 AND 180) AS ThreeHour,
(SELECT COUNT(*)  FROM TBL_PARTORDER INNER JOIN TBL_REPAIR_ORDER ON TBL_PARTORDER.ORDERID = TBL_REPAIR_ORDER.ORDERID INNER JOIN TBL_PROPERTY ON TBL_REPAIR_ORDER.PROPREF = TBL_PROPERTY.PROPREF WHERE (TBL_PARTORDER.RAISED IS NOT NULL) AND (TBL_PARTORDER.RAISED BETWEEN CONVERT(DATETIME,@STARTDATE, 103) AND DATEADD(hh,23,CONVERT(DATETIME,@ENDDATE, 103))) AND (TBL_PROPERTY.CONTRACT = @CONTRACT) AND (TBL_REPAIR_ORDER.ORIGIN = @ORIGIN) AND DATEDIFF(mi, TBL_PARTORDER.RAISED, TBL_PARTORDER.RECEIVED) BETWEEN 181 AND 240) AS FourHour,
(SELECT COUNT(*)  FROM TBL_PARTORDER INNER JOIN TBL_REPAIR_ORDER ON TBL_PARTORDER.ORDERID = TBL_REPAIR_ORDER.ORDERID INNER JOIN TBL_PROPERTY ON TBL_REPAIR_ORDER.PROPREF = TBL_PROPERTY.PROPREF WHERE (TBL_PARTORDER.RAISED IS NOT NULL) AND (TBL_PARTORDER.RAISED BETWEEN CONVERT(DATETIME,@STARTDATE, 103) AND DATEADD(hh,23,CONVERT(DATETIME,@ENDDATE, 103))) AND (TBL_PROPERTY.CONTRACT = @CONTRACT) AND (TBL_REPAIR_ORDER.ORIGIN = @ORIGIN) AND DATEDIFF(mi, TBL_PARTORDER.RAISED, TBL_PARTORDER.RECEIVED) BETWEEN 241 AND 480) AS EightHour,
(SELECT COUNT(*)  FROM TBL_PARTORDER INNER JOIN TBL_REPAIR_ORDER ON TBL_PARTORDER.ORDERID = TBL_REPAIR_ORDER.ORDERID INNER JOIN TBL_PROPERTY ON TBL_REPAIR_ORDER.PROPREF = TBL_PROPERTY.PROPREF WHERE (TBL_PARTORDER.RAISED IS NOT NULL) AND (TBL_PARTORDER.RAISED BETWEEN CONVERT(DATETIME,@STARTDATE, 103) AND DATEADD(hh,23,CONVERT(DATETIME,@ENDDATE, 103))) AND (TBL_PROPERTY.CONTRACT = @CONTRACT) AND (TBL_REPAIR_ORDER.ORIGIN = @ORIGIN) AND  DATEDIFF(mi, TBL_PARTORDER.RAISED, TBL_PARTORDER.RECEIVED) BETWEEN 481 AND 1440) AS TwentyFourHour,
(SELECT COUNT(*)  FROM TBL_PARTORDER INNER JOIN TBL_REPAIR_ORDER ON TBL_PARTORDER.ORDERID = TBL_REPAIR_ORDER.ORDERID INNER JOIN TBL_PROPERTY ON TBL_REPAIR_ORDER.PROPREF = TBL_PROPERTY.PROPREF WHERE (TBL_PARTORDER.RAISED IS NOT NULL) AND (TBL_PARTORDER.RAISED BETWEEN CONVERT(DATETIME,@STARTDATE, 103) AND DATEADD(hh,23,CONVERT(DATETIME,@ENDDATE, 103))) AND (TBL_PROPERTY.CONTRACT = @CONTRACT) AND (TBL_REPAIR_ORDER.ORIGIN = @ORIGIN) AND DATEDIFF(mi, TBL_PARTORDER.RAISED, TBL_PARTORDER.RECEIVED) BETWEEN 1441 AND 2880) AS FortyEightHour,
(SELECT COUNT(*)  FROM TBL_PARTORDER INNER JOIN TBL_REPAIR_ORDER ON TBL_PARTORDER.ORDERID = TBL_REPAIR_ORDER.ORDERID INNER JOIN TBL_PROPERTY ON TBL_REPAIR_ORDER.PROPREF = TBL_PROPERTY.PROPREF WHERE (TBL_PARTORDER.RAISED IS NOT NULL) AND (TBL_PARTORDER.RAISED BETWEEN CONVERT(DATETIME,@STARTDATE, 103) AND DATEADD(hh,23,CONVERT(DATETIME,@ENDDATE, 103))) AND (TBL_PROPERTY.CONTRACT = @CONTRACT) AND (TBL_REPAIR_ORDER.ORIGIN = @ORIGIN) AND DATEDIFF(mi, TBL_PARTORDER.RAISED, TBL_PARTORDER.RECEIVED) >=2881) AS PlusFortyEightHour
END 
```

* * *

## 回答 #1

> 赞同：8
> 
> 时间：2009-05-05T10:19:33.413

```
IF condition
BEGIN
-- ...
END
ELSE
BEGIN
-- ...
END 
```

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2009-05-05T10:35:15.467

有两个问题。缺少 BEGIN，而且 SELECT 需要在每个 IF 语句中。SELECT 中不能有内联 IF，如果需要这样做，可以使用 CASE 语句。

```
IF @Origin = 'ALL'
BEGIN
    SELECT
        (SELECT COUNT(*)  FROM TBL_PARTORDER INNER JOIN TBL_REPAIR_ORDER ON TBL_PARTORDER.ORDERID = TBL_REPAIR_ORDER.ORDERID INNER JOIN TBL_PROPERTY ON TBL_REPAIR_ORDER.PROPREF = TBL_PROPERTY.PROPREF WHERE (TBL_PARTORDER.RAISED IS NOT NULL) AND (TBL_PARTORDER.RAISED BETWEEN CONVERT(DATETIME,@STARTDATE, 103) AND DATEADD(hh,23,CONVERT(DATETIME,@ENDDATE, 103))) AND (TBL_PROPERTY.CONTRACT = @CONTRACT) AND DATEDIFF(mi, TBL_PARTORDER.RAISED, TBL_PARTORDER.RECEIVED) <= 60) AS OneHour,
        (SELECT COUNT(*)  FROM TBL_PARTORDER INNER JOIN TBL_REPAIR_ORDER ON TBL_PARTORDER.ORDERID = TBL_REPAIR_ORDER.ORDERID INNER JOIN TBL_PROPERTY ON TBL_REPAIR_ORDER.PROPREF = TBL_PROPERTY.PROPREF WHERE (TBL_PARTORDER.RAISED IS NOT NULL) AND (TBL_PARTORDER.RAISED BETWEEN CONVERT(DATETIME,@STARTDATE, 103) AND DATEADD(hh,23,CONVERT(DATETIME,@ENDDATE, 103))) AND (TBL_PROPERTY.CONTRACT = @CONTRACT) AND DATEDIFF(mi, TBL_PARTORDER.RAISED, TBL_PARTORDER.RECEIVED) BETWEEN 61 AND 120) AS TwoHour,
        (SELECT COUNT(*)  FROM TBL_PARTORDER INNER JOIN TBL_REPAIR_ORDER ON TBL_PARTORDER.ORDERID = TBL_REPAIR_ORDER.ORDERID INNER JOIN TBL_PROPERTY ON TBL_REPAIR_ORDER.PROPREF = TBL_PROPERTY.PROPREF WHERE (TBL_PARTORDER.RAISED IS NOT NULL) AND (TBL_PARTORDER.RAISED BETWEEN CONVERT(DATETIME,@STARTDATE, 103) AND DATEADD(hh,23,CONVERT(DATETIME,@ENDDATE, 103))) AND (TBL_PROPERTY.CONTRACT = @CONTRACT) AND DATEDIFF(mi, TBL_PARTORDER.RAISED, TBL_PARTORDER.RECEIVED) BETWEEN 121 AND 180) AS ThreeHour,
        (SELECT COUNT(*)  FROM TBL_PARTORDER INNER JOIN TBL_REPAIR_ORDER ON TBL_PARTORDER.ORDERID = TBL_REPAIR_ORDER.ORDERID INNER JOIN TBL_PROPERTY ON TBL_REPAIR_ORDER.PROPREF = TBL_PROPERTY.PROPREF WHERE (TBL_PARTORDER.RAISED IS NOT NULL) AND (TBL_PARTORDER.RAISED BETWEEN CONVERT(DATETIME,@STARTDATE, 103) AND DATEADD(hh,23,CONVERT(DATETIME,@ENDDATE, 103))) AND (TBL_PROPERTY.CONTRACT = @CONTRACT) AND DATEDIFF(mi, TBL_PARTORDER.RAISED, TBL_PARTORDER.RECEIVED) BETWEEN 181 AND 240) AS FourHour,
        (SELECT COUNT(*)  FROM TBL_PARTORDER INNER JOIN TBL_REPAIR_ORDER ON TBL_PARTORDER.ORDERID = TBL_REPAIR_ORDER.ORDERID INNER JOIN TBL_PROPERTY ON TBL_REPAIR_ORDER.PROPREF = TBL_PROPERTY.PROPREF WHERE (TBL_PARTORDER.RAISED IS NOT NULL) AND (TBL_PARTORDER.RAISED BETWEEN CONVERT(DATETIME,@STARTDATE, 103) AND DATEADD(hh,23,CONVERT(DATETIME,@ENDDATE, 103))) AND (TBL_PROPERTY.CONTRACT = @CONTRACT) AND DATEDIFF(mi, TBL_PARTORDER.RAISED, TBL_PARTORDER.RECEIVED) BETWEEN 241 AND 480) AS EightHour,
        (SELECT COUNT(*)  FROM TBL_PARTORDER INNER JOIN TBL_REPAIR_ORDER ON TBL_PARTORDER.ORDERID = TBL_REPAIR_ORDER.ORDERID INNER JOIN TBL_PROPERTY ON TBL_REPAIR_ORDER.PROPREF = TBL_PROPERTY.PROPREF WHERE (TBL_PARTORDER.RAISED IS NOT NULL) AND (TBL_PARTORDER.RAISED BETWEEN CONVERT(DATETIME,@STARTDATE, 103) AND DATEADD(hh,23,CONVERT(DATETIME,@ENDDATE, 103))) AND (TBL_PROPERTY.CONTRACT = @CONTRACT) AND  DATEDIFF(mi, TBL_PARTORDER.RAISED, TBL_PARTORDER.RECEIVED) BETWEEN 481 AND 1440) AS TwentyFourHour,
        (SELECT COUNT(*)  FROM TBL_PARTORDER INNER JOIN TBL_REPAIR_ORDER ON TBL_PARTORDER.ORDERID = TBL_REPAIR_ORDER.ORDERID INNER JOIN TBL_PROPERTY ON TBL_REPAIR_ORDER.PROPREF = TBL_PROPERTY.PROPREF WHERE (TBL_PARTORDER.RAISED IS NOT NULL) AND (TBL_PARTORDER.RAISED BETWEEN CONVERT(DATETIME,@STARTDATE, 103) AND DATEADD(hh,23,CONVERT(DATETIME,@ENDDATE, 103))) AND (TBL_PROPERTY.CONTRACT = @CONTRACT) AND DATEDIFF(mi, TBL_PARTORDER.RAISED, TBL_PARTORDER.RECEIVED) BETWEEN 1441 AND 2880) AS FortyEightHour,
        (SELECT COUNT(*)  FROM TBL_PARTORDER INNER JOIN TBL_REPAIR_ORDER ON TBL_PARTORDER.ORDERID = TBL_REPAIR_ORDER.ORDERID INNER JOIN TBL_PROPERTY ON TBL_REPAIR_ORDER.PROPREF = TBL_PROPERTY.PROPREF WHERE (TBL_PARTORDER.RAISED IS NOT NULL) AND (TBL_PARTORDER.RAISED BETWEEN CONVERT(DATETIME,@STARTDATE, 103) AND DATEADD(hh,23,CONVERT(DATETIME,@ENDDATE, 103))) AND (TBL_PROPERTY.CONTRACT = @CONTRACT) AND DATEDIFF(mi, TBL_PARTORDER.RAISED, TBL_PARTORDER.RECEIVED) >=2881) AS PlusFortyEightHour
END
ELSE
BEGIN
    SELECT
        (SELECT COUNT(*)  FROM TBL_PARTORDER INNER JOIN TBL_REPAIR_ORDER ON TBL_PARTORDER.ORDERID = TBL_REPAIR_ORDER.ORDERID INNER JOIN TBL_PROPERTY ON TBL_REPAIR_ORDER.PROPREF = TBL_PROPERTY.PROPREF WHERE (TBL_PARTORDER.RAISED IS NOT NULL) AND (TBL_PARTORDER.RAISED BETWEEN CONVERT(DATETIME,@STARTDATE, 103) AND DATEADD(hh,23,CONVERT(DATETIME,@ENDDATE, 103))) AND (TBL_PROPERTY.CONTRACT = @CONTRACT) AND (TBL_REPAIR_ORDER.ORIGIN = @ORIGIN) AND DATEDIFF(mi, TBL_PARTORDER.RAISED, TBL_PARTORDER.RECEIVED) <= 60) AS OneHour,
        (SELECT COUNT(*)  FROM TBL_PARTORDER INNER JOIN TBL_REPAIR_ORDER ON TBL_PARTORDER.ORDERID = TBL_REPAIR_ORDER.ORDERID INNER JOIN TBL_PROPERTY ON TBL_REPAIR_ORDER.PROPREF = TBL_PROPERTY.PROPREF WHERE (TBL_PARTORDER.RAISED IS NOT NULL) AND (TBL_PARTORDER.RAISED BETWEEN CONVERT(DATETIME,@STARTDATE, 103) AND DATEADD(hh,23,CONVERT(DATETIME,@ENDDATE, 103))) AND (TBL_PROPERTY.CONTRACT = @CONTRACT) AND (TBL_REPAIR_ORDER.ORIGIN = @ORIGIN) AND DATEDIFF(mi, TBL_PARTORDER.RAISED, TBL_PARTORDER.RECEIVED) BETWEEN 61 AND 120) AS TwoHour,
        (SELECT COUNT(*)  FROM TBL_PARTORDER INNER JOIN TBL_REPAIR_ORDER ON TBL_PARTORDER.ORDERID = TBL_REPAIR_ORDER.ORDERID INNER JOIN TBL_PROPERTY ON TBL_REPAIR_ORDER.PROPREF = TBL_PROPERTY.PROPREF WHERE (TBL_PARTORDER.RAISED IS NOT NULL) AND (TBL_PARTORDER.RAISED BETWEEN CONVERT(DATETIME,@STARTDATE, 103) AND DATEADD(hh,23,CONVERT(DATETIME,@ENDDATE, 103))) AND (TBL_PROPERTY.CONTRACT = @CONTRACT) AND (TBL_REPAIR_ORDER.ORIGIN = @ORIGIN) AND DATEDIFF(mi, TBL_PARTORDER.RAISED, TBL_PARTORDER.RECEIVED) BETWEEN 121 AND 180) AS ThreeHour,
        (SELECT COUNT(*)  FROM TBL_PARTORDER INNER JOIN TBL_REPAIR_ORDER ON TBL_PARTORDER.ORDERID = TBL_REPAIR_ORDER.ORDERID INNER JOIN TBL_PROPERTY ON TBL_REPAIR_ORDER.PROPREF = TBL_PROPERTY.PROPREF WHERE (TBL_PARTORDER.RAISED IS NOT NULL) AND (TBL_PARTORDER.RAISED BETWEEN CONVERT(DATETIME,@STARTDATE, 103) AND DATEADD(hh,23,CONVERT(DATETIME,@ENDDATE, 103))) AND (TBL_PROPERTY.CONTRACT = @CONTRACT) AND (TBL_REPAIR_ORDER.ORIGIN = @ORIGIN) AND DATEDIFF(mi, TBL_PARTORDER.RAISED, TBL_PARTORDER.RECEIVED) BETWEEN 181 AND 240) AS FourHour,
        (SELECT COUNT(*)  FROM TBL_PARTORDER INNER JOIN TBL_REPAIR_ORDER ON TBL_PARTORDER.ORDERID = TBL_REPAIR_ORDER.ORDERID INNER JOIN TBL_PROPERTY ON TBL_REPAIR_ORDER.PROPREF = TBL_PROPERTY.PROPREF WHERE (TBL_PARTORDER.RAISED IS NOT NULL) AND (TBL_PARTORDER.RAISED BETWEEN CONVERT(DATETIME,@STARTDATE, 103) AND DATEADD(hh,23,CONVERT(DATETIME,@ENDDATE, 103))) AND (TBL_PROPERTY.CONTRACT = @CONTRACT) AND (TBL_REPAIR_ORDER.ORIGIN = @ORIGIN) AND DATEDIFF(mi, TBL_PARTORDER.RAISED, TBL_PARTORDER.RECEIVED) BETWEEN 241 AND 480) AS EightHour,
        (SELECT COUNT(*)  FROM TBL_PARTORDER INNER JOIN TBL_REPAIR_ORDER ON TBL_PARTORDER.ORDERID = TBL_REPAIR_ORDER.ORDERID INNER JOIN TBL_PROPERTY ON TBL_REPAIR_ORDER.PROPREF = TBL_PROPERTY.PROPREF WHERE (TBL_PARTORDER.RAISED IS NOT NULL) AND (TBL_PARTORDER.RAISED BETWEEN CONVERT(DATETIME,@STARTDATE, 103) AND DATEADD(hh,23,CONVERT(DATETIME,@ENDDATE, 103))) AND (TBL_PROPERTY.CONTRACT = @CONTRACT) AND (TBL_REPAIR_ORDER.ORIGIN = @ORIGIN) AND  DATEDIFF(mi, TBL_PARTORDER.RAISED, TBL_PARTORDER.RECEIVED) BETWEEN 481 AND 1440) AS TwentyFourHour,
        (SELECT COUNT(*)  FROM TBL_PARTORDER INNER JOIN TBL_REPAIR_ORDER ON TBL_PARTORDER.ORDERID = TBL_REPAIR_ORDER.ORDERID INNER JOIN TBL_PROPERTY ON TBL_REPAIR_ORDER.PROPREF = TBL_PROPERTY.PROPREF WHERE (TBL_PARTORDER.RAISED IS NOT NULL) AND (TBL_PARTORDER.RAISED BETWEEN CONVERT(DATETIME,@STARTDATE, 103) AND DATEADD(hh,23,CONVERT(DATETIME,@ENDDATE, 103))) AND (TBL_PROPERTY.CONTRACT = @CONTRACT) AND (TBL_REPAIR_ORDER.ORIGIN = @ORIGIN) AND DATEDIFF(mi, TBL_PARTORDER.RAISED, TBL_PARTORDER.RECEIVED) BETWEEN 1441 AND 2880) AS FortyEightHour,
        (SELECT COUNT(*)  FROM TBL_PARTORDER INNER JOIN TBL_REPAIR_ORDER ON TBL_PARTORDER.ORDERID = TBL_REPAIR_ORDER.ORDERID INNER JOIN TBL_PROPERTY ON TBL_REPAIR_ORDER.PROPREF = TBL_PROPERTY.PROPREF WHERE (TBL_PARTORDER.RAISED IS NOT NULL) AND (TBL_PARTORDER.RAISED BETWEEN CONVERT(DATETIME,@STARTDATE, 103) AND DATEADD(hh,23,CONVERT(DATETIME,@ENDDATE, 103))) AND (TBL_PROPERTY.CONTRACT = @CONTRACT) AND (TBL_REPAIR_ORDER.ORIGIN = @ORIGIN) AND DATEDIFF(mi, TBL_PARTORDER.RAISED, TBL_PARTORDER.RECEIVED) >=2881) AS PlusFortyEightHour
END 
```

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2009-05-05T10:23:16.320

你忘记了开始...

```
IF (@Origin = 'ALL')
BEGIN
--
END
ELSE
BEGIN
--
END 
```

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2009-05-05T10:27:35.437

我刚刚尝试了以下作为测试，它工作正常。您应该可以将此作为示例的起点。

```
DECLARE @Origin NVARCHAR(200)
SET @Origin = 'ALL'
IF @Origin = 'ALL'
    BEGIN
    (SELECT ('Test') AS HI)
    END
ELSE
    BEGIN
        (SELECT ('Test2') AS HI)
    END 
```

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2009-05-05T14:03:40.283

我认为如果您使用这种方法，您的查询会更容易阅读：

```
SELECT
    SUM(
        CASE WHEN DATEDIFF(mi, TBL_PARTORDER.RAISED, TBL_PARTORDER.RECEIVED) <= 60 THEN 1
        ELSE 0
    ) AS OneHour,
    SUM(
        CASE WHEN DATEDIFF(mi, TBL_PARTORDER.RAISED, TBL_PARTORDER.RECEIVED) BETWEEN 61 AND 120 THEN 1
        ELSE 0
    ) AS TwoHour,
    ...
FROM TBL_PARTORDER INNER JOIN TBL_REPAIR_ORDER ON TBL_PARTORDER.ORDERID = TBL_REPAIR_ORDER.ORDERID 
    INNER JOIN TBL_PROPERTY ON TBL_REPAIR_ORDER.PROPREF = TBL_PROPERTY.PROPREF 
WHERE (TBL_PARTORDER.RAISED IS NOT NULL) 
    AND (TBL_PROPERTY.CONTRACT = @CONTRACT)
    AND (TBL_PARTORDER.RAISED BETWEEN CONVERT(DATETIME,@STARTDATE, 103) 
    AND DATEADD(hh,23,CONVERT(DATETIME,@ENDDATE, 103))) 
```

或者更好的是，将时间窗口定义拉到一个表中：

```
create table TimeWindow (MinuteLowerBound int , MinuteUpperBound int , TimeWindowName varchar(32))
insert TimeWindow (MinuteLowerBound , MinuteUpperBound , TimeWindowName)
select 0 as MinuteLowerBound , 60 as MinuteUpperBound , 'OneHour' as TimeWindowName
union all select 61, 120, 'TwoHour'
union all select 121, 180, 'ThreeHour' 
```

然后只需加入时间窗口定义：

```
SELECT
    tw.TimeWindowName,
    count(*) as TimeWindowCount
FROM TBL_PARTORDER INNER JOIN TBL_REPAIR_ORDER ON TBL_PARTORDER.ORDERID = TBL_REPAIR_ORDER.ORDERID 
    INNER JOIN TBL_PROPERTY ON TBL_REPAIR_ORDER.PROPREF = TBL_PROPERTY.PROPREF
    INNER JOIN TimeWindow as tw on DATEDIFF(mi, TBL_PARTORDER.RAISED, TBL_PARTORDER.RECEIVED) BETWEEN tw.MinuteLowerBound and tw.MinuteUpperBound
WHERE (TBL_PARTORDER.RAISED IS NOT NULL) 
    AND (TBL_PROPERTY.CONTRACT = @CONTRACT)
    AND (TBL_PARTORDER.RAISED BETWEEN CONVERT(DATETIME,@STARTDATE, 103) 
    AND DATEADD(hh,23,CONVERT(DATETIME,@ENDDATE, 103)))  
GROUP BY tw.TimeWindowName 
```

# vb.net - Visual Basic 2008 '测试'

> ID：824227
> 
> 赞同：0
> 
> 时间：2009-05-05T10:16:17.773
> 
> 标签：vb.net

有没有类似程序或网络考试的网站？

我能给出的最好的例子是 Auto-it 的“Auto-it 1,2,3”在[这里](http://www.autoitscript.com/forum/index.php?showtopic=21048 "自动 1-2-3")找到。

这是给一个绝对初学者的，我自己，所以即使是最简单的问题也会有所帮助。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-05-05T10:36:17.507

这个怎么样：**[VB.NET测验](http://www.ex-designz.net/test_page.asp?tid=44)**

# colors - 使用 Graphics.Drawstring() 时防止颜色溢出？

> ID：824228
> 
> 赞同：0
> 
> 时间：2009-05-05T10:16:49.097
> 
> 标签：colors, drawstring

使用 vb .net Graphics.Drawstring 方法时，如何防止颜色相互渗透。这发生在真正不应该一起使用的颜色上，例如绿色/橙色和黑色和红色。谢谢

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2009-05-22T13:06:49.900

我通过生成 png 而不是 jpeg 来解决这个问题，质量最终要好得多

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-05-05T10:22:57.507

听起来您启用了抗锯齿功能。您是否尝试禁用它？

# c# - 全局键盘挂钩 (C#)

> ID：824229
> 
> 赞同：5
> 
> 时间：2009-05-05T10:16:49.863
> 
> 标签：c#, windows, hotkeys, global-hotkey

> **可能重复：**
> [C# 应用程序中的全局键盘捕获](https://stackoverflow.com/questions/604410/global-keyboard-capture-in-c-application)

谁能帮我为我的应用程序设置一个全局键盘挂钩？

我想设置在不关注实际表单时可以使用的热键（例如`Ctrl`+ ）。`S`

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2009-05-05T11:07:28.680

Paul 的帖子链接到两个答案，一个告诉您如何实现挂钩，另一个告诉您调用 RegisterHotKey。您不需要为像 Ctrl+S 热键这样简单的东西安装挂钩，因此请改为调用[RegisterHotKey 。](http://www.pinvoke.net/default.aspx/user32/RegisterHotKey.html)

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2009-05-05T11:31:26.423

或者您可以使用 C# 的 MessageFilter。当您的应用程序进程中的任何控件/表单具有焦点时，它应该可以工作。

示例代码：

```
class KeyboardMessageFilter : IMessageFilter
{
    public bool PreFilterMessage(ref Message m)
    {
        if (m.Msg == ((int)Helper.WindowsMessages.WM_KEYDOWN))
        {
            switch ((int)m.WParam)
            {
                case (int)Keys.Escape:
                    // Do Something
                    return true;
                case (int)Keys.Right:
                    // Do Something
                    return true;
                case (int)Keys.Left:
                    // Do Something
                    return true;
            }
        }

        return false;
    }
} 
```

而不仅仅是向您的应用程序添加一个新的 MessageFilter：

```
Application.AddMessageFilter(new KeyboardMessageFilter()); 
```

# logging - 如何使用 \L DOS 命令在 SSIS 中创建日志文件

> ID：824232
> 
> 赞同：0
> 
> 时间：2009-05-05T10:17:09.457
> 
> 标签：logging, command-line, ssis, dos, package

我正在尝试使用以下命令来执行为 SSIS 包生成日志文件。

DTExec /FILE "C:\Documents and Settings\CP0808\My Documents\Test.dtsx" /logger "DTS.LogProviderTextFile;c:\log.txt"

但它得到了如下错误。请指教。

开始时间：上午 12:03:20 错误：2009-05-04 12:03:21.15 代码：0xC001000E 来源：测试描述：未找到连接“c:\log.txt”。当未找到特定连接元素时，Connections 集合会引发此错误。结束错误错误：2009-05-04 12:03:21.18 代码：0xC001000E 来源：测试描述：未找到连接“c:\log.txt”。当未找到特定连接元素时，Connections 集合会引发此错误。结束错误错误：2009-05-04 12:03:21.21 代码：0xC02020EA 来源：测试日志提供程序“{1AEAB490-1124-4A84-981F-7C1FDD80A721}”描述：连接管理器“c:\log.txt”不是成立。组件未能在 Connections 集合中找到连接管理器。结束错误

请帮我解决这个问题...

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-05-07T10:46:50.087

您需要在 BIDS 中设置日志记录。它会告诉你你需要设置一个连接管理器，并且你写“C:\log.txt”的地方，你应该有连接管理器的名字。

# language-agnostic - 什么是回调函数？

> ID：824234
> 
> 赞同：780
> 
> 时间：2009-05-05T10:18:10.357
> 
> 标签：language-agnostic, callback

什么是回调函数？

* * *

## 回答 #1

> 赞同：779
> 
> 时间：2011-09-26T01:04:21.140

由于该死的东西的名称，开发人员经常对回调是什么感到困惑。

回调函数是一个函数，它是：

*   可由另一个函数访问，并且
*   如果第一个函数完成，则在第一个函数之后调用

想象回调函数如何工作的一个很好的方法是，它是一个在它被传递到的函数**的“后面调用”的函数。**

也许更好的名字是**“调用后”**功能。

这个结构对于异步行为非常有用，我们希望在前一个事件完成时发生活动。

**伪代码：**

```
// A function which accepts another function as an argument
// (and will automatically invoke that function when it completes - note that there is no explicit call to callbackFunction)
funct printANumber(int number, funct callbackFunction) {
    printout("The number you provided is: " + number);
}

// a function which we will use in a driver function as a callback function
funct printFinishMessage() {
    printout("I have finished printing numbers.");
}

// Driver method
funct event() {
   printANumber(6, printFinishMessage);
} 
```

**调用 event() 的结果：**

```
The number you provided is: 6
I have finished printing numbers. 
```

这里的输出顺序很重要。由于之后调用回调函数，“我已完成打印数字”最后打印，而不是第一个打印。

回调之所以被称为是因为它们与指针语言一起使用。如果您不使用其中之一，请不要为“回调”这个名称而努力。请理解，它只是描述作为参数提供给另一个方法的方法的名称，这样当调用父方法时（无论条件如何，例如按钮单击、计时器滴答等）并且其方法主体完成，然后调用回调函数。

一些语言支持支持多个回调函数参数的结构，并根据父函数的完成方式调用（即，如果父函数成功完成，则调用一个回调，如果父函数抛出一个回调，则调用另一个回调。具体错误等）。

* * *

## 回答 #2

> 赞同：249
> 
> 时间：2014-05-04T06:34:36.167

# 不透明的定义

回调函数是您提供给另一段代码的函数，允许该代码调用它。

# 人为的例子

你为什么想做这个？假设您需要调用一项服务。如果服务立即返回，您只需：

1.  叫它
2.  等待结果
3.  结果出来后继续

例如，假设服务是`factorial`功能。当你想要 的值时`5!`，你会调用`factorial(5)`，然后会发生以下步骤：

1.  您当前的执行位置已保存（在堆栈上，但这并不重要）

2.  执行权移交给`factorial`

3.  完成`factorial`后，它将结果放在您可以得到的地方

4.  执行回到它在 [1] 中的位置

现在假设`factorial`花了很长时间，因为你给了它大量的数字，它需要在某个超级计算集群上运行。假设您预计返回结果需要 5 分钟。你可以：

1.  晚上睡觉时保持你的设计并运行你的程序，这样你就不会有一半时间盯着屏幕看

2.  设计你的程序在`factorial`做它的事情的同时做其他事情

如果您选择第二个选项，那么回调可能对您有用。

# 端到端设计

为了利用回调模式，您想要的是能够以`factorial`以下方式调用：

```
factorial(really_big_number, what_to_do_with_the_result) 
```

第二个参数 ,`what_to_do_with_the_result`是一个你发送给 的函数`factorial`，希望`factorial`在返回之前调用它的结果。

*是的，这意味着`factorial`需要编写支持回调。*

现在假设您希望能够将参数传递给您的回调。现在你不能，因为你不会打电话给它，`factorial`是。因此`factorial`需要编写以允许您传递参数，并且在调用它时它只会将它们交给您的回调。它可能看起来像这样：

```
factorial (number, callback, params)
{
    result = number!   // i can make up operators in my pseudocode
    callback (result, params)
} 
```

现在`factorial`允许这种模式，您的回调可能如下所示：

```
logIt (number, logger)
{
    logger.log(number)
} 
```

你的电话`factorial`是

```
factorial(42, logIt, logger) 
```

如果您想从中返回一些东西`logIt`怎么办？嗯，你不能，因为`factorial`没有注意它。

那么，为什么不能`factorial`只返回你的回调返回的内容呢？

## 使其无阻塞

由于执行是为了在完成时移交给回调`factorial`，所以它实际上不应该向调用者返回任何内容。理想情况下，它会以某种方式在另一个线程/进程/机器中启动它的工作并立即返回，以便您可以继续，可能是这样的：

```
factorial(param_1, param_2, ...)
{
    new factorial_worker_task(param_1, param_2, ...);
    return;
} 
```

这现在是一个“异步调用”，这意味着当您调用它时，它会立即返回，但还没有真正完成它的工作。所以你确实需要一些机制来检查它，并在它完成时获得它的结果，并且你的程序在这个过程中变得更加复杂。

顺便说一句，使用这种模式`factorial_worker_task`可以异步启动你的回调并立即返回。

## 所以你会怎么做？

答案是保持在回调模式内。每当你想写

```
a = f()
g(a) 
```

并且`f`要异步调用，您将改为编写

```
f(g) 
```

where`g`作为回调传递。

*这从根本上改变了程序的流拓扑*，需要一些时间来适应。

您的编程语言可以通过为您提供一种即时创建函数的方法来帮助您。在上面的代码中，函数`g`可能小到`print (2*a+1)`. 如果您的语言要求您将其定义为一个单独的函数，并带有完全不必要的名称和签名，那么如果您经常使用这种模式，您的生活将会变得不愉快。

另一方面，如果您的语言允许您创建 lambda，那么您的状态会好得多。然后你最终会写出类似的东西

```
f( func(a) { print(2*a+1); }) 
```

这好多了。

# 如何传递回调

你将如何将回调函数传递给`factorial`？好吧，你可以通过多种方式做到这一点。

1.  如果被调用的函数在同一个进程中运行，你可以传递一个函数指针

2.  或者你可能想`fn name --> fn ptr`在你的程序中维护一个字典，在这种情况下你可以传递名字

3.  也许您的语言允许您就地定义函数，可能是 lambda！在内部，它正在创建某种对象并传递一个指针，但您不必担心这一点。

4.  也许您正在调用的函数在完全独立的机器上运行，并且您正在使用诸如 HTTP 之类的网络协议来调用它。您可以将回调公开为 HTTP 可调用函数，并传递其 URL。

你明白了。

# 最近回调的兴起

在我们进入的这个网络时代，我们调用的服务通常是通过网络进行的。我们通常对这些服务没有任何控制权，即我们没有编写它们，我们不维护它们，我们无法确保它们正常运行或它们的性能如何。

但是我们不能指望我们的程序在等待这些服务响应时阻塞。意识到这一点，服务提供商经常使用回调模式设计 API。

JavaScript 非常好地支持回调，例如使用 lambda 和闭包。JavaScript 世界中有很多活动，无论是在浏览器上还是在服务器上。甚至还有针对移动设备开发的 JavaScript 平台。

随着我们向前发展，我们中将有越来越多的人编写异步代码，对此理解将是必不可少的。

* * *

## 回答 #3

> 赞同：111
> 
> 时间：2009-05-05T10:19:35.300

维基百科上的[*回调*页面](http://en.wikipedia.org/wiki/Callback_(computer_science))解释得很好：

> 在计算机编程中，回调是对可执行代码或一段可执行代码的引用，它作为参数传递给其他代码。这允许较低级别的软件层调用在较高级别层中定义的子例程（或函数）。

* * *

## 回答 #4

> 赞同：51
> 
> 时间：2011-09-15T16:48:35.043

外行的回应是，它不是由您调用，而是由用户或浏览器在某个事件发生或处理某些代码之后调用的函数。

* * *

## 回答 #5

> 赞同：46
> 
> 时间：2016-02-29T12:26:02.243

让我们保持简单。什么是回调函数？

**比喻和类比的例子**

我有秘书。每天我都会要求她：（i）将公司寄出的邮件送到邮局，***在***[她完成之后，去做：（ii）我在其中一张便签](http://www.psdgraphics.com/file/sticky-notes.jpg)上为她写的任何任务。

现在，便签上的任务是什么？任务每天都在变化。

假设在这一天，我要求她打印一些文件。所以我把它写在便利贴上，然后把它和她需要发布的外发邮件一起钉在她的桌子上。

总之：

1.  首先，她需要投递邮件并且
2.  *完成后*，她需要立即打印一些文件。

回调函数是第二个任务：打印这些文档。因为它是在邮件投递之后完成的，而且还因为告诉她打印文件的便签与她需要发布的邮件一起提供给了她。

**现在让我们将其与编程词汇联系起来**

*   本例中的方法名称为：DropOffMail。
*   而回调函数是：PrintOffDocuments。PrintOffDocuments 是回调函数，因为我们希望秘书这样做，只有在 DropOffMail 运行之后。
*   所以我会“通过：PrintOffDocuments 作为 DropOffMail 方法的“参数”。这是一个重要的观点。

就是这样。而已。我希望这为您解决了问题 - 如果没有，请发表评论，我会尽力澄清。

* * *

## 回答 #6

> 赞同：45
> 
> 时间：2009-05-05T16:07:04.450

回调函数是在满足特定条件时应该调用的函数。回调函数不是立即被调用，而是在未来的某个时间点被调用。

通常，当正在启动一个异步完成的任务时使用它（即，将在调用函数返回后的某个时间完成）。

例如，请求网页的函数可能要求其调用者提供一个回调函数，该回调函数将在网页完成下载时调用。

* * *

## 回答 #7

> 赞同：43
> 
> 时间：2014-01-11T01:13:05.953

*回调最容易用电话系统来描述。函数调用类似于打电话给某人，问她一个问题，得到答案，然后挂断电话。添加回拨会改变类比，以便在问她问题后，您还可以给她您的姓名和电话号码，以便她可以回电给您答案。*

-- Paul Jakubik，“C++ 中的回调实现”

* * *

## 回答 #8

> 赞同：34
> 
> 时间：2012-07-20T10:58:50.693

我相信这个“​​回调”行话在很多地方都被错误地使用了。我的定义是这样的：

> 回调函数是您传递给某人并让他们在某个时间点调用它的函数。

我认为人们只是阅读了 wiki 定义的第一句话：

> 回调是对可执行代码或一段可执行代码的引用，它作为参数传递给其他代码。

我一直在使用很多 API，看到各种不好的例子。许多人倾向于将函数指针（对可执行代码的引用）或匿名函数（一段可执行代码）命名为“回调”，如果它们只是函数，为什么需要另一个名称呢？

实际上只有wiki定义中的第二句话揭示了回调函数和普通函数之间的区别：

> 这允许较低级别的软件层调用在较高级别层中定义的子例程（或函数）。

所以区别在于你将传递函数的对象以及传递函数的调用方式。如果您只是定义一个函数并将其传递给另一个函数并直接在该函数体中调用它，请不要将其称为回调。定义说你传入的函数将被“低级”函数调用。

我希望人们不要在模棱两可的上下文中使用这个词，它不能帮助人们更好地理解，只会更糟。

* * *

## 回答 #9

> 赞同：28
> 
> 时间：2015-05-11T07:09:18.543

* * *

## 回答 #10

> 赞同：21
> 
> 时间：2010-10-27T23:18:11.643

这使得回调听起来像是方法末尾的返回语句。

我不确定他们是这样的。

我认为回调实际上是对函数的调用，这是另一个函数被调用和完成的结果。

我还认为回调旨在解决原始调用，以一种“嘿！你要求的那件事？我已经做到了 - 只是想我会让你知道 - 回到你身边”。

* * *

## 回答 #11

> 赞同：18
> 
> 时间：2013-11-19T01:40:06.553

**Call After**会比愚蠢的名字**callback**更好。当或如果在函数中满足条件，则调用另一个函数，即**Call After**函数，该函数作为参数接收。

与其在函数中硬编码内部函数，不如编写一个函数来接受已经编写**好的 Call After**函数作为参数。**Call After**可能会根据接收参数的函数中的代码检测到的状态变化而被调用。

* * *

## 回答 #12

> 赞同：17
> 
> 时间：2009-05-05T10:21:04.190

回调函数是您为现有函数/方法指定的函数，在操作完成时调用，需要额外的处理等。

例如，在 Javascript，或更具体的 jQuery 中，您可以指定在动画完成时调用的回调参数。

在 PHP 中，该`preg_replace_callback()`函数允许您提供一个函数，该函数将在匹配正则表达式时调用，将匹配的字符串作为参数传递。

* * *

## 回答 #13

> 赞同：12
> 
> 时间：2011-12-23T06:29:36.410

看图片:)![这就是它的工作原理](https://i.stack.imgur.com/VN9Nj.jpg)

主程序使用回调函数名称调用库函数（也可能是系统级函数）。该回调函数可能以多种方式实现。主程序根据需要选择一个回调。

最后，库函数在执行过程中调用回调函数。

* * *

## 回答 #14

> 赞同：7
> 
> 时间：2011-03-10T05:27:54.183

这个问题的简单答案是回调函数是通过函数指针调用的函数。如果将函数的指针（地址）作为参数传递给另一个函数，当该指针用于调用它指向的函数时，就说进行了回调

* * *

## 回答 #15

> 赞同：7
> 
> 时间：2013-05-04T06:29:59.003

假设我们有一个函数`sort(int *arraytobesorted,void (*algorithmchosen)(void))`，它可以接受一个函数指针作为它的参数，它可以在`sort()`实现中的某个点使用。然后，这里被函数指针寻址的代码被`algorithmchosen`称为**回调函数**。

并且看到优势是我们可以选择任何算法，例如：

```
 1\.    algorithmchosen = bubblesort
  2\.    algorithmchosen = heapsort
  3\.    algorithmchosen = mergesort   ... 
```

比如说，已经用原型实现了：

```
 1\.   `void bubblesort(void)`
  2\.   `void heapsort(void)`
  3\.   `void mergesort(void)`   ... 
```

这是用于在面向对象编程中实现多态性的概念

* * *

## 回答 #16

> 赞同：4
> 
> 时间：2019-04-26T03:20:19.093

回调是一种将函数作为参数传递给另一个函数并在过程完成后调用该函数的想法。

如果您通过上述很棒的答案了解了回调的概念，我建议您应该了解其想法的背景。

“是什么让他们（计算机科学家）开发回调？” 你可能会学到一个问题，那就是阻塞。（尤其是阻塞 UI）并且回调不是唯一的解决方案。还有很多其他的解决方案（例如：Thread、Futures、Promises...）。

* * *

## 回答 #17

> 赞同：4
> 
> 时间：2017-05-16T15:50:51.407

“在计算机编程中，回调是对可执行代码或一段可执行代码的引用，它作为参数传递给其他代码。这允许较低级别的软件层调用在较高级别层中定义的子例程（或函数）。” - 维基百科

**使用函数指针在 C 中回调**

在 C 中，回调是使用函数指针实现的。函数指针——顾名思义，是指向函数的指针。

例如 int (*ptrFunc) ();

这里，ptrFunc 是一个指向不带参数并返回整数的函数的指针。不要忘记放入括号，否则编译器会假定 ptrFunc 是一个普通的函数名，它什么都不带，并返回一个指向整数的指针。

这是一些演示函数指针的代码。

```
#include<stdio.h>
int func(int, int);
int main(void)
{
    int result1,result2;
    /* declaring a pointer to a function which takes
       two int arguments and returns an integer as result */
    int (*ptrFunc)(int,int);

    /* assigning ptrFunc to func's address */                    
    ptrFunc=func;

    /* calling func() through explicit dereference */
    result1 = (*ptrFunc)(10,20);

    /* calling func() through implicit dereference */        
    result2 = ptrFunc(10,20);            
    printf("result1 = %d result2 = %d\n",result1,result2);
    return 0;
}

int func(int x, int y)
{
    return x+y;
} 
```

现在让我们尝试使用函数指针来理解 C 中回调的概念。

完整的程序有三个文件：callback.c、reg_callback.h 和 reg_callback.c。

```
/* callback.c */
#include<stdio.h>
#include"reg_callback.h"

/* callback function definition goes here */
void my_callback(void)
{
    printf("inside my_callback\n");
}

int main(void)
{
    /* initialize function pointer to
    my_callback */
    callback ptr_my_callback=my_callback;                        
    printf("This is a program demonstrating function callback\n");
    /* register our callback function */
    register_callback(ptr_my_callback);                          
    printf("back inside main program\n");
    return 0;
}

/* reg_callback.h */
typedef void (*callback)(void);
void register_callback(callback ptr_reg_callback);

/* reg_callback.c */
#include<stdio.h>
#include"reg_callback.h"

/* registration goes here */
void register_callback(callback ptr_reg_callback)
{
    printf("inside register_callback\n");
    /* calling our callback function my_callback */
    (*ptr_reg_callback)();                               
} 
```

如果我们运行这个程序，输出将是

这是一个演示函数回调的程序 my_callback 内部的 register_callback 内部的主程序

上层函数像普通调用一样调用下层函数，回调机制允许下层函数通过指向回调函数的指针调用上层函数。

**使用接口在 Java 中回调**

Java没有函数指针的概念，通过Interface机制实现Callback机制这里我们声明一个Interface，而不是函数指针，而是声明一个Interface，它有一个方法，当被调用者完成任务时会调用该方法

让我通过一个例子来演示它：

**回调接口**

```
public interface Callback
{
    public void notify(Result result);
} 
```

**调用者或更高级别的类**

```
public Class Caller implements Callback
{
Callee ce = new Callee(this); //pass self to the callee

//Other functionality
//Call the Asynctask
ce.doAsynctask();

public void notify(Result result){
//Got the result after the callee has finished the task
//Can do whatever i want with the result
}
} 
```

**被调用者或下层函数**

```
public Class Callee {
Callback cb;
Callee(Callback cb){
this.cb = cb;
}

doAsynctask(){
//do the long running task
//get the result
cb.notify(result);//after the task is completed, notify the caller
}
} 
```

**使用 EventListener 模式进行回调**

*   项目清单

此模式用于通知 0 到 n 个观察者/监听者特定任务已完成

*   项目清单

Callback 机制和 EventListener/Observer 机制的区别在于，在 callback 中，被调用者通知单个调用者，而在 Eventlisener/Observer 中，被调用者可以通知任何对该事件感兴趣的人（通知可能会转到其他部分未触发任务的应用程序）

让我通过一个例子来解释它。

**事件接口**

```
public interface Events {

public void clickEvent();
public void longClickEvent();
} 
```

**类小部件**

```
package com.som_itsolutions.training.java.exampleeventlistener;

import java.util.ArrayList;
import java.util.Iterator;

public class Widget implements Events{

    ArrayList<OnClickEventListener> mClickEventListener = new ArrayList<OnClickEventListener>(); 
    ArrayList<OnLongClickEventListener> mLongClickEventListener = new ArrayList<OnLongClickEventListener>();

    @Override
    public void clickEvent() {
        // TODO Auto-generated method stub
        Iterator<OnClickEventListener> it = mClickEventListener.iterator();
                while(it.hasNext()){
                    OnClickEventListener li = it.next();
                    li.onClick(this);
                }   
    }
    @Override
    public void longClickEvent() {
        // TODO Auto-generated method stub
        Iterator<OnLongClickEventListener> it = mLongClickEventListener.iterator();
        while(it.hasNext()){
            OnLongClickEventListener li = it.next();
            li.onLongClick(this);
        }

    }

    public interface OnClickEventListener
    {
        public void onClick (Widget source);
    }

    public interface OnLongClickEventListener
    {
        public void onLongClick (Widget source);
    }

    public void setOnClickEventListner(OnClickEventListener li){
        mClickEventListener.add(li);
    }
    public void setOnLongClickEventListner(OnLongClickEventListener li){
        mLongClickEventListener.add(li);
    }
} 
```

**类按钮**

```
public class Button extends Widget{
private String mButtonText;
public Button (){
} 
public String getButtonText() {
return mButtonText;
}
public void setButtonText(String buttonText) {
this.mButtonText = buttonText;
}
} 
```

**类复选框**

```
public class CheckBox extends Widget{
private boolean checked;
public CheckBox() {
checked = false;
}
public boolean isChecked(){
return (checked == true);
}
public void setCheck(boolean checked){
this.checked = checked;
}
} 
```

**活动课**

包 com.som_itsolutions.training.java.exampleeventlistener；

```
public class Activity implements Widget.OnClickEventListener
{
    public Button mButton;
    public CheckBox mCheckBox;
    private static Activity mActivityHandler;
    public static Activity getActivityHandle(){
        return mActivityHandler;
    }
    public Activity ()
    {
        mActivityHandler = this;
        mButton = new Button();
        mButton.setOnClickEventListner(this);
        mCheckBox = new CheckBox();
        mCheckBox.setOnClickEventListner(this);
        } 
    public void onClick (Widget source)
    {
        if(source == mButton){
            mButton.setButtonText("Thank you for clicking me...");
            System.out.println(((Button) mButton).getButtonText());
        }
        if(source == mCheckBox){
            if(mCheckBox.isChecked()==false){
                mCheckBox.setCheck(true);
                System.out.println("The checkbox is checked...");
            }
            else{
                mCheckBox.setCheck(false);
                System.out.println("The checkbox is not checked...");
            }       
        }
    }
    public void doSomeWork(Widget source){
        source.clickEvent();
    }   
} 
```

**其他类**

```
public class OtherClass implements Widget.OnClickEventListener{
Button mButton;
public OtherClass(){
mButton = Activity.getActivityHandle().mButton;
mButton.setOnClickEventListner(this);//interested in the click event                        //of the button
}
@Override
public void onClick(Widget source) {
if(source == mButton){
System.out.println("Other Class has also received the event notification...");
}
} 
```

**主班**

```
public class Main {
public static void main(String[] args) {
// TODO Auto-generated method stub
Activity a = new Activity();
OtherClass o = new OtherClass();
a.doSomeWork(a.mButton);
a.doSomeWork(a.mCheckBox);
}
} 
```

从上面的代码可以看出，我们有一个名为 events 的接口，它基本上列出了我们的应用程序可能发生的所有事件。Widget 类是所有 UI 组件（如 Button、Checkbox）的基类。这些 UI 组件是实际从框架代码接收事件的对象。Widget 类实现了事件接口，并且它有两个嵌套接口，即 OnClickEventListener 和 OnLongClickEventListener

这两个接口负责监听 Widget 派生的 UI 组件（如 Button 或 Checkbox）上可能发生的事件。因此，如果我们将此示例与前面使用 Java 接口的 Callback 示例进行比较，这两个接口作为 Callback 接口工作。所以上层代码（Here Activity）实现了这两个接口。并且每当一个小部件发生事件时，都会调用更高级别的代码（或在更高级别的代码中实现的这些接口的方法，这里是Activity）。

现在让我讨论一下回调和事件监听器模式之间的基本区别。正如我们提到的，使用回调，被调用者只能通知一个调用者。但是在 EventListener 模式的情况下，应用程序的任何其他部分或类都可以注册可能发生在 Button 或 Checkbox 上的事件。这种类的例子是OtherClass。如果你看OtherClass的代码，你会发现它已经将自己注册为Activity中定义的Button中可能发生的ClickEvent的监听器。有趣的是，除了 Activity（调用者）之外，每当 Button 上发生点击事件时，也会通知这个 OtherClass。

* * *

## 回答 #18

> 赞同：3
> 
> 时间：2018-05-24T10:14:16.040

回调函数是您传递（作为引用或指针）给某个函数或对象的函数。此函数或对象将在以后的任何时间（可能多次）出于任何目的调用此函数：

*   通知任务结束
*   请求两个项目之间的比较（如在 c qsort() 中）
*   报告进程的进度
*   通知事件
*   委托对象的实例化
*   委派一个区域的绘画

...

因此，将回调描述为在另一个函数或任务结束时调用的函数过于简化（即使它是一个常见的用例）。

* * *

## 回答 #19

> 赞同：2
> 
> 时间：2009-05-05T10:34:03.550

一个重要的使用领域是您将其中一个函数注册为句柄（即回调），然后发送消息/调用某个函数来完成某些工作或处理。现在处理完成后，被调用的函数会调用我们注册的函数（即现在回调完成），从而表明我们处理完成。
[该](http://en.wikipedia.org/wiki/Callback_(computer_science))维基百科链接以图形方式很好地解释了。

* * *

## 回答 #20

> 赞同：1
> 
> 时间：2015-04-26T20:21:58.917

回调函数也称为高阶函数，是作为参数传递给另一个函数的函数，回调函数在父函数内部被调用（或执行）。

```
$("#button_1").click(function() {
  alert("button 1 Clicked");
}); 
```

这里我们将一个函数作为参数传递给 click 方法。而click方法将调用（或执行）我们传递给它的回调函数。

* * *

## 回答 #21

> 赞同：1
> 
> 时间：2018-01-08T12:56:00.000

**回调函数** 作为参数传递给另一个函数的函数。

```
function test_function(){       
 alert("Hello world");  
} 

setTimeout(test_function, 2000); 
```

**注意：**在上面的示例中，test_function 用作 setTimeout 函数的参数。

* * *

## 回答 #22

> 赞同：-1
> 
> 时间：2022-02-20T20:03:59.267

回调是作为参数或参数传递给另一个函数的函数。 **为什么我们需要一个回调函数？** 我们使用回调，因此我们不必等待响应。

# c# - 带有 IIS 6 的 MVC

> ID：824246
> 
> 赞同：1
> 
> 时间：2009-05-05T10:21:09.960
> 
> 标签：c#, .net, asp.net, asp.net-mvc

我已经阅读了有关此问题的几篇文章，但似乎仍然无法让 MVC 在 IIS 6 上运行。我已将 .mvc 映射到 IIS 中的 aspnet_isapi.dll 但是当我浏览到看起来映射的 URL 时得到 404像这样

```
RouteTable.Routes.MapRoute("action", "api.mvc/{controller}/{action}", new {action = "Index"}); 
```

然后我浏览到 //localhost/Web.Site/api.mvc/Users/List 但返回 404

同样发生在

//localhost/Web.Site/api.mvc/Users/

我有一个带有 List 和 Index 的 UsersController，它们都返回 ViewAction

还有什么我需要做的吗？或者我错过了什么

干杯

还.............

我应该指出，我重定向网站中的默认页面是有效的

例如，我背后的默认代码有

```
 HttpContext.Current.RewritePath(Request.ApplicationPath, false);
        IHttpHandler httpHandler = new MvcHttpHandler();
        httpHandler.ProcessRequest(HttpContext.Current); 
```

因此默认的“/”请求确实通过 global.asax.cs 中的 this 正确路由

```
 RouteTable.Routes.MapRoute("default", "", new {controller="Home", action = "Index" }); 
```

不确定这是否对任何人有帮助

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2009-05-05T10:22:48.227

您是否取消选中扩展映射上的“验证该文件存在”框？

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-05-05T23:51:07.423

尝试删除你的 default.aspx 页面并确保你的 web.config 中有这个：

```
<httpModules>
    <add name="UrlRoutingModule" type="System.Web.Routing.UrlRoutingModule, System.Web.Routing"/>
</httpModules> 
```

# vmware - 使用 HTTP 代理配置 VMWare Server 2.0

> ID：824255
> 
> 赞同：0
> 
> 时间：2009-05-05T10:23:37.223
> 
> 标签：vmware, vmware-server

我已经使用来宾操作系统（Ubuntu Linux）配置了 VMWare 2.0 服务器，并且我的主机操作系统是 Windows XP。

我的 XP 机器通过 HTTP 代理连接到 Internet。我希望 VMWare 中的客户操作系统也可以访问 Internet。创建的 VM 将网络适配器设置为 NAT。我还没有真正为这个虚拟机指定任何其他网络设置（只是按照向导）。

当我尝试在来宾操作系统中打开网站时，它会要求我进行 HTTP 身份验证。使用主机操作系统时，我不必这样做。

有谁知道可能出了什么问题？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2009-06-04T21:54:37.710

如果您的网络上有 HTTP 代理，则必须设置来宾操作系统和来宾中的应用程序才能像使用主机应用程序和主机操作系统一样使用它。

# jquery - 如何在单选按钮上禁用 jquery 日期选择器

> ID：824256
> 
> 赞同：7
> 
> 时间：2009-05-05T10:23:40.220
> 
> 标签：jquery, html, css

我是 jQuery 的新手。任何帮助，将不胜感激

我有两个单选按钮和两个文本框，我在其中使用 jquery 显示日期。

当我点击 Radio1 然后在两个文本框中我应该能够选择日期但是当我点击 Radio2 然后我不应该能够在 text2 字段中选择日期。应该禁用 text2 字段，并且 jquery 日期选择器不应该工作。

我已禁用 text2 字段，但日期功能仍在工作。

--

## **我的代码在这里**

```
<script language='javascript'>
<!-- //
function setReadOnly(obj)
{
if(obj.value == "yes")
{
document.forms[0].text2.style.backgroundColor = "#ffffff";
document.forms[0].text2.readOnly = 0;
document.forms[0].text2.value = "";

} else {
document.forms[0].text2.style.backgroundColor = "#eeeeee";
document.forms[0].text2.readOnly = 1;
document.forms[0].text2.value = "Not applicable!";
document.forms[0].number = disbaled;

}
}
// -->
</script>
<script> 
$(document).ready(function() {
    $("#text1").datepicker
    ({
        showOn: 'button', buttonImage: 'images/cal.gif', buttonImageOnly: true,
        dateFormat: 'dd-mm-yy',
        numberOfMonths: 2,
        minDate:0

    })
    $("#text2").datepicker
    ({
        showOn: 'button', buttonImage: 'images/cal.gif', buttonImageOnly: true,
        dateFormat: 'dd-mm-yy',
        numberOfMonths: 2,
        minDate:1

    })
})
</script> 
</head>
<body>
<form>
<input type=radio name="update" value="yes" checked onclick="setReadOnly(this)">
Radio1 <br />
<input type=radio name="update" value="no" onclick="setReadOnly(this)">
Radio2 <br />
<input name="text1" type="text">
<input name="text2" type="text">
<select name="number">
<option value="11">11</option>
<option value="12">12</option>
</select>
</form> 
```

* * *

## 回答 #1

> 赞同：15
> 
> 时间：2009-05-05T10:52:30.917

在 jQuery 方式中，您必须将 setReadOnly 函数代码中的代码更改为：

```
function setReadOnly(obj){
   if(obj.value == "yes"){
     $('#text2').css('backgroundColor','#ffffff');
     $('#text2').removeAttr('readOnly');
     $('#text2').val('');
     $('#text2').datepicker('enable');
     $('#number').removeAttr('disabled');
   } 
   else {
     $('#text2').css('backgroundColor','#eeeeee');
     $('#text2').attr('readonly','readonly');
     $('#text2').val('Not applicable!');
     $('#text2').datepicker('disable');
     $('#number').attr('disabled',true);
   }
} 
```

**编辑：**虽然上面的代码工作得很好，正如@Deviant 所指出的那样，相关的方法可以链接起来以充分利用 jQuery 的强大功能。

```
function setReadOnly(obj){
   if(obj.value == "yes"){
     $('#text2').css('backgroundColor','#ffffff')
                .removeAttr('readonly')
                .val('')
                .datepicker('enable');
     $('#number').removeAttr('disabled');
   } 
   else {
     $('#text2').css('backgroundColor','#eeeeee')
                .attr('readonly','readonly')
                .val('Not applicable!')
                .datepicker('disable');
     $('#number').attr('disabled',true);
   }
} 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-05-05T10:51:33.820

`setReadOnly()`在您的函数中尝试以下操作

```
function setReadOnly(obj) {
    $("#text1").datepicker('disable');
    $("#text2").datepicker('disable');
} 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-11-06T16:26:01.450

datepicker 在焦点上调用。下面的代码将根据您的情况停止此操作

```
 $("#text2").bind('focus', function (e) {
               var value =  $('input[name=update]:checked').val();
               if (value == "no")
                   e.stopImmediatePropagation();                    
            }); 
```

# delphi - Delphi中的YAML解析器？

> ID：824257
> 
> 赞同：13
> 
> 时间：2009-05-05T10:23:41.233
> 
> 标签：delphi, parsing, yaml

Delphi 中是否有任何 YAML 解析器或 YAML 序列化库？

* * *

## 回答 #1

> 赞同：8
> 
> 时间：2012-07-24T14:24:26.903

我最近在 BitBucket 上启动了一个 Delphi-YAML 项目：

[https://bitbucket.org/OCTAGRAM/delphi-yaml](https://bitbucket.org/OCTAGRAM/delphi-yaml)

至少，我已经运行了一些东西，但是缺少许多测试，并且可能隐藏了许多错误。

* * *

## 回答 #2

> 赞同：7
> 
> 时间：2009-05-05T11:59:55.887

我不知道完整的 YAML 实现，但[JSON](http://www.json.org/)（一个子集）变得非常流行，甚至在 JSON 站点上列出了一些 Delphi 库。Delphi 2009 甚至在 DataSnap 中使用（稍微修改过的版本？）JSON。

[http://sourceforge.net/projects/lkjson](http://sourceforge.net/projects/lkjson)

[http://www.progdigy.com/?page_id=6](http://www.progdigy.com/?page_id=6)

[http://sourceforge.net/projects/is-webstart/](http://sourceforge.net/projects/is-webstart/)

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2009-05-05T20:26:49.117

可能是时候在 Delphi 中实现 YAML 解析器了……

从 PyYAML 复制代码（但 Python 是一种动态类型语言）

或者看看用静态类型语言 (Java) 编写的 SnakeYAML

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2009-05-06T09:08:55.930

Free Pascal 也有一些 json 库。

我把这样的东西弄乱了，以便与 PHP 交互一次。这是代码：

[http://www.stack.nl/~marcov/phpser.zip](http://www.stack.nl/~marcov/phpser.zip)

请注意，它比可用的库更能证明概念。

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2009-05-06T14:29:37.670

这个开源 C# YAML 解析器看起来可以作为 Delphi 实现的起点：

[YamlDotNet - 一个用于解析和发出 YAML 的 .NET 库](http://yamldotnet.sourceforge.net/)

# c# - 将 wpf 元素树序列化为 Xaml 的最佳方法？

> ID：824263
> 
> 赞同：5
> 
> 时间：2009-05-05T10:26:11.807
> 
> 标签：c#, .net, wpf, xaml

将 wpf 元素树序列化为 xaml 以便获得设计时表示的最佳方法是什么？

XamlWriter.Save 有严重的限制，它只能提供运行时表示

可能微软不希望任何人不费吹灰之力地构建一个定制的 xaml 设计器:(

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-05-14T13:51:33.643

据我了解，没有直接的方法可以从可视化树中获取 xaml 的设计时表示。:)

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-05-14T13:35:29.830

您可以研究 Mole 的源代码并创建自己的代码来为您完成。

[Mole For Visual Studio - 带有编辑功能 - 可视化所有项目类型](http://www.codeproject.com/KB/macros/MoleForVisualStudioEdit.aspx)

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-05-21T12:21:34.760

我们有一个使用自定义 XAML 序列化程序的 XAML 设计器产品。事实上，这对我们来说是最有用的解决方案。但是，使用 .Net 4，有很多很棒的选择（和助手）可以准确地完成该任务。所以，如果你不害怕一点betaness，我会开始看那里。

看看[Guy Burstein](http://blogs.msdn.com/bursteg/archive/2009/05/18/xaml-in-net-4-0-serialization-and-deserialization-using-xamlservices.aspx)是怎么说的。

* * *

## 回答 #4

> 赞同：-1
> 
> 时间：2009-05-14T13:15:12.123

只需取消剪辑 xml 单元消除器并将两个部分数组过程重新路由到 wpf 树中。然后将对象创建为时间线。

简单的

# html - CSS/HTML 阴影应该停在文本框的末尾

> ID：824264
> 
> 赞同：0
> 
> 时间：2009-05-05T10:26:24.503
> 
> 标签：html, css

我的网站有问题。我希望阴影在我的文本框的末尾停止。

[![影子问题](https://i.stack.imgur.com/Kjq0K.jpg)](https://i.stack.imgur.com/Kjq0K.jpg)

HTML

```
<body>
<div id="shadow" class="floatfix">

<div id="shadowleft"></div>
<div id="shadowtop"><img src="img/shadowcornerleft.png" alt="hoek" id="shadowcornerleft" /><img src="img/shadowcornerright.png" alt="hoek" id="shadowcornerright" /></div>
<div id="shadowright"></div>
<div id="content"> 
```

这是我的 CSS 代码：

```
#shadow
{
margin-left: auto;
margin-right: auto;
margin-top: 75px;
width: 974px;
}

#shadowleft
{
position: absolute;
height: 100%;
width: 27px;
margin-top: 42px;
background-image: url("img/shadowleft.png");
background-position: top left;
background-repeat: repeat-y;
}

#shadowright
{
position: absolute;
height: 100%;
width: 27px;
margin-top: 12px;
margin-left: 947px;
background-image: url("img/shadowright.png");
background-position: top right;
background-repeat: repeat-y;
}

#shadowtop
{
width: 892px;
height: 30px;
margin-left: auto;
margin-right: auto;
margin-top: 45px;
background-image: url("img/shadowtop.png");
background-position: 0 0;
background-repeat: repeat-x;
}

#shadowcornerleft
{
position: relative;
left: -42px;
top: 0;
}

#shadowcornerright
{
position: relative;
left: 850px;
top: 0;
}

#content
{
width: 920px;
margin-left: auto;
margin-right: auto;
background-color: white;
border-bottom: 1px solid #cccccc;
} 
```

我认为我有这个问题是因为“身高：100%”。但我不知道如何解决它。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-05-05T11:40:31.923

有一种更简单的方法可以做到这一点。制作一个 960 像素宽 x 10 像素高的新背景图像，在其两侧都有阴影。（您可能需要调整宽度以在中间获得 920 像素的白色，而阴影在两侧）

使用您的`#shadow`div 添加该背景，`#content`例如：

```
#shadow
{
width: 960px;
margin-left: auto;
margin-right: auto;
background: url(shadow-sides.png) repeat-y left top;
} 
```

或者，您可以通过添加到它和 IE6 hack 来使您的`#content`div 伸展：`min-height: 100%;`

```
* html #content { height: 100%; } 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-05-05T10:29:21.330

100% 阴影高度没有计算 100% 的高度，因此它使用自动模式。到目前为止，我看到了 3 种解决问题的方法，但它们都不是应该的那样好：

*   在父 div 上设置固定高度（*如果内容扩展则不好*）
*   使用 3x3 表格（*但人们再次说不要使用表格进行布局*）
*   使用双面阴影背景图像填充内容 div。1px 高 974px 宽 bg 图像，带有重复-y；（*如果站点宽度发生变化，则不是很优雅*）

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-05-05T16:26:45.073

id 说你的 HTML 是错误的。自我关闭 div 是不好的做法

将它们包裹在您的内容周围并使用负边距和背景位置来获得跨越流体内容高度的正确效果

这有点 sudo，因为它是从我的另一个网站上撕下来的，但是应该给你基本的应该如何做

```
<div id="header">
<div class="wrapper">
<div class="inner">
...
</div>
</div>
</div>

    #header {
height:100%;
background:transparent url(../img/left-gradient.png) repeat-y scroll left center;
margin:0 auto;
max-width:60em;
min-width:40em;
padding-left:7px;
text-align:left;
width:60em;
}

#header .wrapper {
background:transparent url(../img/right-gradient.png) repeat-y scroll right center;
padding-right:7px;
}

#header .inner {
background-color:#FFFFFF;
} 
```

# html - HTMLParser 只转换文件的第一行

> ID：824265
> 
> 赞同：2
> 
> 时间：2009-05-05T10:27:03.677
> 
> 标签：html, itext, data-conversion

我正在使用 iText for .NET 将 HTML 转换为 PDF。
我正在使用 HtmlParser 将 HTML 页面转换为 PDF，但问题是 Htmlparser 似乎只将第一行转换为 pdf，HTML 文件中的所有其他行都没有转换为 PDF。

这是代码

```
Document document = new Document();
        final = new Document();

        StreamWriter writer = new StreamWriter("fck.txt");
        writer.WriteLine(FCKeditor1.Value);
        writer.Close();
        // Changing the extension of txt file to html file
        File.Move("C:\\Program Files\\Microsoft Visual Studio 9.0\\Common7\\IDE\\fck.txt", "C:\\Program Files\\Microsoft Visual Studio 9.0\\Common7\\IDE\\fck.html");
        PdfWriter writer1 = PdfWriter.GetInstance(final, new FileStream("final1.pdf", FileMode.Create));

        final.Open();
        HtmlParser.Parse(final, "fck.html");
        final.Close();
        File.Delete("C:\\Program Files\\Microsoft Visual Studio 9.0\\Common7\\IDE\\fck.html"); 
```

所以请帮助我提前感谢你的帮助

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2009-06-04T17:38:14.103

我用

```
StreamReader tempReader = new StreamReader(tempFile);

        ArrayList p = HTMLWorker.ParseToList(tempReader,st); 

        for (int k = 0; k < p.Count; k++) 
        {
            documento.Add((IElement)p[k]); 
        }

        tempReader.Dispose();
        documento.Close(); 
```

并且工作正常。但我把处置放在最后

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-05-05T11:13:57.917

哦，我终于得到了解决方案，而不是使用 htmlparser 类，我现在使用了 htmlworker 类，这是新代码

```
ArrayList p = HTMLWorker.ParseToList(new StreamReader("fck.html"), st);
for (int k = 0; k < p.Count; k++)
{
    final.Add((IElement)p[k]);
}
final.Close(); 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2011-04-29T14:32:44.313

> 错误 1 ​​无法将类型“System.Collections.Generic.List”隐式转换为“System.Collections.ArrayList”

像这样使用它：

```
List<IElement> htmlarraylist = HTMLWorker.ParseToList(new StreamReader(tempFile),new StyleSheet());
                foreach (IElement element in htmlarraylist)
                {
                    document.Add(element);
                } 
```

# c# - 有没有人有一个使用 SubSonic 的简单示例网站的链接？

> ID：824267
> 
> 赞同：0
> 
> 时间：2009-05-05T10:27:45.203
> 
> 标签：c#, sql-server, subsonic

我正在开发一个新的管理网站来更新几个表。（目前）不涉及复杂的逻辑。

该网站将使用 VS 2008 C#（3.5 框架）构建，并将具有 SQL Server 2008 数据库。

我们决定研究使用 SubSonic，并且我已经设置了基本的脚手架来输入测试数据。

有谁知道我在哪里可以找到一个简单的示例，显示使用 SubSonic 时的标准选择/插入/更新/删除代码以及我们如何最好地利用它？

谢谢！

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2009-05-05T11:03:17.113

SubSonic 项目在其网站上有一些代码示例（例如，[选择查询](http://subsonicproject.com/querying/select-queries/)、[使用活动记录](http://subsonicproject.com/active-record/using-active-record/)和[存储过程](http://subsonicproject.com/querying/stored-procedures/)。Google 也提供了[大量示例](http://www.google.se/search?q=subsonic+example)。

# c# - WCF 服务是否公开属性？

> ID：824268
> 
> 赞同：12
> 
> 时间：2009-05-05T10:28:09.803
> 
> 标签：c#, wcf

在实现 WCF 服务所需的接口中，我使用`[ServiceContract()]`属性声明主类，并使用`[OperationContract()]`.

如何公开公共属性？谢谢

* * *

## 回答 #1

> 赞同：22
> 
> 时间：2009-05-11T22:44:37.877

由于属性的*get*部分是一种方法，因此这在技术上是可行的，但正如前面的答案/评论中所述，这可能是不可取的；只是将其发布在这里以获取一般知识。

**服务合约：**

```
[ServiceContract]
public interface IService1
{
    string Name
    {
        [OperationContract]
        get;
    }
} 
```

**服务：**

```
public class Service1 : IService1
{
    public string Name
    {
        get { return "Steve"; }
    }
} 
```

**从您的客户端代码访问：**

```
var client = new Service1Client();
var name = client.get_Name(); 
```

* * *

## 回答 #2

> 赞同：14
> 
> 时间：2009-05-05T10:29:18.460

你不能。这不是它的工作原理。仅方法。

* * *

## 回答 #3

> 赞同：4
> 
> 时间：2009-05-05T10:58:06.610

属性是组件接口的面向对象方面。WCF 是关于**服务**的，您必须在其中考虑和设计组件之间的交互顺序。

由于往返成本、潜在的昂贵状态管理和版本控制挑战，面向对象不能很好地扩展到分布式场景（您的代码在多个服务器甚至多个进程中执行）。但是，OO 仍然是设计服务内部的好方法，尤其是在它们很复杂的情况下。

* * *

## 回答 #4

> 赞同：4
> 
> 时间：2012-10-26T11:06:18.613

您可以公开属性，但您必须使用`[DataContract]`属性并且可以将属性声明为`[DataMember]`属性的属性。

* * *

## 回答 #5

> 赞同：2
> 
> 时间：2013-10-24T22:57:40.863

请不要将属性公开为 Web 方法。这在 HTTPS 中不起作用。我花了很多时间来识别和解决这个问题。最好的方法是在 WCF 中编写一个具体的返回方法。

# html - HTML转义-Reg表达式？

> ID：824274
> 
> 赞同：6
> 
> 时间：2009-05-05T10:29:56.913
> 
> 标签：html, regex, string, escaping

我想 HTML 自动和逻辑地转义一个特定的短语，该短语当前是一个用引号突出显示的单词的语句。在声明中，引号或英寸标记也可用于描述距离。

这句话可以是：

> 保罗说“它错过了我们大约一英尺”。事实上，它只有大约 9 英寸。

为了逃避这句话真的应该是

```
<pre>Paul said &ldquo;It missed us by about a foot&rdquo;.  
In fact it was only about 9&prime;.</pre> 
```

这使

```
<pre>Paul said “It missed us by about a foot”. 
     In fact it was only about 9″.</pre> 
```

我想不出一个示例短语也可以添加到“转义”中，但那可能就在那里！

我正在寻找有关如何识别在运行时用哪些转义值替换 " 字符的帮助。该短语只是一个示例，它可以是任何东西，但应该正确形成，即如果出现开头和结尾引号，则会出现我们要正确地转义文本。

我会使用正则表达式在文本中查找带引号的短语，即句号之前的两个“”字符，然后替换第一个然后替换第二个。和

```
&ldquo; 
```

然后

```
&rdquo; 
```

如果我找到一个“用一个”替换它，
除非它是在一个我用它替换它的数字之后

```
&Prime; 
```

我将如何处理一个句子中的多个引号？

```
“它只是错过了”保罗说“一英尺”。  
```

这真的会难倒我......

```
<pre>"It just missed" Paul said "by 9" almost".</pre> 
```

以上内容应在正确转义时读取。（这次我展示的是实际角色）

```
“它只是错过了”，保罗说“差点 9 点”。
```

显然是一个边缘案例，但我想知道是否有可能在不了解内容的情况下在运行时逃避这种情况？如果对更明显的短语没有帮助，将不胜感激。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2009-05-05T10:50:32.993

我会分两次这样做：

第一遍搜索任何紧跟在数字前面的 "s 并进行替换：

`s/([0-9])"/\1&Prime;/g`

根据您正在处理的文本，您可能希望/需要扩展此正则表达式以识别拼写为单词的数字；为了简单起见，我只检查了数字。

处理完所有这些后，第二遍就可以轻松转换成对的 "s，如您所描述的：

`s/"([^"]*)"/&ldquo;\1&rdquo;/g`

注意使用`[^"]*`而不是`.*`- 我们希望找到两组双引号，它们之间有任意数量的*非双引号*字符。通过添加该限制，处理带有多个引用部分的字符串不会有任何问题。（这也可以使用 non-greedy 来完成`.*?`，但是否定字符类更清楚地说明了您的意图，并且在大多数正则表达式实现中，效率更高。）

当然，字符串中某处的杂散、不匹配的 " 或第一次传递时遗漏的英寸标记仍然会导致问题，但如果不实现对内容的理解，就无法避免这种可能性。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-05-05T10:49:25.353

你所描述的基本上是一个隐藏的马尔可夫模型，

[http://en.wikipedia.org/wiki/Hidden_​​Markov_model](http://en.wikipedia.org/wiki/Hidden_Markov_model)

您有一组输入符号（您的原始文本和模棱两可的标点符号）和一组输出符号（原始文本和更细粒度的标点符号），但没有以编程方式真正观察两者之间联系的好方法。您可以编写一些规则来涵盖一些边缘情况，但这基本上不适用于多引号情况。在这种情况下，出于同样的原因，您不能真正使用正则表达式，但是使用一个嗯，以及一堆训练文本，您可能会做出一些很好的猜测。

抱歉，如果您要为部署做好准备，这可能不是很有帮助，但是输入比输出有更大的歧义，所以您唯一的选择是考虑上下文，这基本上意味着一组非常冗长的规则，或某种机器学习方法。

不过有趣的问题 - 看看你能得到什么样的表现会很好。也许有人已经在上面写过论文？

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2009-05-05T10:49:37.007

> 我想知道是否有可能在不了解内容的情况下在运行时逃避这种情况？

考虑到您正在向当前编码在其他文本中的标点符号添加语义含义......不，不是真的。

正则表达式至少是其中一部分最简单的工具。我建议寻找 /\d+"/ 英寸数字的情况。但对于引号分隔符，在你寻找任何其他特殊情况或短语之后，使用匹配对的算法可能更容易，比如括号和括号：标记和计数。然后在真实世界的输入上进行测试和细化。

但我真的要问：为什么？

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2009-05-05T10:55:35.260

我不确定是否有可能在不理解句子含义的情况下做到这一点。我倾向于怀疑它。

我的第一次尝试如下。

*   从左到右穿过字符串
*   交替用左右双引号替换双素数，但如果左边有数字，则用双素数替换
*   如果字符串末尾的引号不平衡，则返回直到找到带有双引号的数字并根据前面的双引号将双引号更改为左双引号或右双引号。

我很确定你很容易失败这个策略。但这仍然是一个简单的例子——当你必须处理嵌套引号时，工作就开始了。

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2009-05-05T13:15:22.647

我知道这是不可能的，但你考虑过[Mechanical Turk](https://www.mturk.com/mturk/welcome)吗？这是人类擅长的问题，而目前的计算机却很糟糕。选择正确的标点符号需要理解句子的含义，因此正则表达式对于边缘情况必然会失败。

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2009-05-05T10:48:12.533

你可以试试这样的。首先用这个正则表达式替换引号：

```
"((?:[^"\d]+|\d"?)*)" 
```

比英寸标志：

```
(\d+)" 
```

这是 JavaScript 中的一个示例：

```
'"It just missed" Paul said "by 9" almost"'.replace(/"((?:[^"\d]*|\d["']?)+)"/g, "&ldquo;$1&rdquo;").replace(/(\d+)"/g, "$1&Prime;"); 
```

# web-services - 使用初始化参数在 glassfish 中部署 WebService

> ID：824276
> 
> 赞同：0
> 
> 时间：2009-05-05T10:30:23.167
> 
> 标签：web-services, parameters, initialization, glassfish, jax-ws

我已经使用 JAX-WS API 创建了一个 WebService。该服务使用 Endpoint 类运行没有任何问题。

```
main(String args[])
{
(...)
MyService service=new MyService();
service.setParam1("limit=100");
service.setParam2("hello");
service.setParam3("max-value=10");
Endpoint endpoint = Endpoint.create(service);
endpoint.publish("http://localhost:8090/ws");
(...)
} 
```

现在，我想在 glassfish 中部署这项服务。但是，正如我在示例中所写，我想使用一些参数来初始化我的服务。我怎样才能做到这一点？我应该使用其他 API 吗？

提前谢谢了

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2009-05-07T06:57:53.647

好的，我终于找到了答案：使用`javax.xml.ws.WebServiceContext`是解决方案。查看其他答案[如何从 JAX-WS Web 服务中访问 ServletContext？](https://stackoverflow.com/questions/261348)

# asp.net-mvc - 为什么 Html.ActionLink 呈现“？Length=4”

> ID：824279
> 
> 赞同：317
> 
> 时间：2009-05-05T10:31:14.633
> 
> 标签：asp.net-mvc

我很困惑为什么这段代码

```
Html.ActionLink("About", "About", "Home", new { hidefocus = "hidefocus" }) 
```

导致此链接：

```
<a hidefocus="hidefocus" href="/Home/About?Length=4">About</a> 
```

这`hidefocus`部分是我的目标，但`?Length=4`从哪里来？

* * *

## 回答 #1

> 赞同：340
> 
> 时间：2009-05-05T10:45:48.670

Length=4 来自尝试序列化字符串对象。您的代码正在运行此`ActionLink`方法：

```
public static string ActionLink(this HtmlHelper htmlHelper, string linkText, string actionName, object routeValues, object htmlAttributes) 
```

这需要一个`string`用于 routeValues 的对象“Home”，MVC 管道搜索公共属性将它们转换为路由值。在`string`对象的情况下，唯一的公共属性是`Length`，并且由于没有使用 Length 参数定义的路由，它会将属性名称和值作为查询字符串参数附加。您可能会发现，如果您从不在该页面上的页面运行`HomeController`它，则会引发有关缺少`About`操作方法的错误。尝试使用以下内容：

```
Html.ActionLink("About", "About", new { controller = "Home" }, new { hidefocus = "hidefocus" }) 
```

* * *

## 回答 #2

> 赞同：199
> 
> 时间：2010-11-02T19:19:10.070

我解决这个问题的方法是在匿名声明 () 之前的第四个参数中添加一个 null，`new {}`以便它使用以下方法重载：(linkText、actionName、controllerName、routeValues、htmlAttributes)：

```
Html.ActionLink("About", "About", "Home", null, new { hidefocus = "hidefocus" }) 
```

* * *

## 回答 #3

> 赞同：89
> 
> 时间：2012-05-26T20:00:42.610

您忘记添加 HTMLAttributes 参数。

这将在没有任何更改的情况下工作：

```
Html.ActionLink("About", "About", "Home", new { hidefocus = "hidefocus" },null) 
```

* * *

## 回答 #4

> 赞同：29
> 
> 时间：2009-05-05T10:43:02.187

ActionLink 的参数不正确，它试图使用“Home”值作为路由值，而不是匿名类型。

我相信你只需要添加`new { }`or`null`作为最后一个参数。

编辑：只需重新阅读帖子并意识到您可能希望将 null 指定为倒数第二个参数，而不是最后一个。

* * *

## 回答 #5

> 赞同：5
> 
> 时间：2014-06-15T13:48:31.013

```
Html.ActionLink("About", "About", "Home", new { hidefocus = "hidefocus" }, new { }) 
```

这将采用重载：字符串链接文本、字符串 actionName、字符串控制器名称、对象 routeValues、对象 htmlAttributes

* * *

## 回答 #6

> 赞同：3
> 
> 时间：2012-05-10T16:08:55.253

只需删除“Home”（控制器名称），代码将是：

```
Html.ActionLink("About", "About", new { hidefocus = "hidefocus" }) 
```

* * *

## 回答 #7

> 赞同：3
> 
> 时间：2015-12-08T12:24:41.477

请使用带有五 (5) 个参数的右重载方法。例子：

```
@using (@Ajax.BeginForm("Register", "Account", null,
    new AjaxOptions
    {
        HttpMethod = "POST",
        OnSuccess = "OnSuccess",
        OnFailure = "OnFailure",
        OnBegin = "OnBegin",
        OnComplete = "OnComplete"
    }, new { @class = "form-login" })) 
```

* * *

## 回答 #8

> 赞同：1
> 
> 时间：2013-11-24T20:33:36.210

正如乔纳森·沃特尼在评论中指出的那样，这也适用于

> Html.BeginForm()

方法。就我而言，我在*Create.cshtml*中针对相应控制器 + Create 操作的发布请求，并且有

```
using (Html.BeginForm("Create")) {
  @Html.AntiForgeryToken()
  ...
} 
```

渲染时将查询字符串**“？Length = 6”**添加到表单操作中。由 roryf 批准的答案提示并实现“创建”的字符串长度为 6，我最终通过删除显式操作规范解决了这个问题：

```
using (Html.BeginForm()) {
      @Html.AntiForgeryToken()
      ...
    } 
```

* * *

## 回答 #9

> 赞同：1
> 
> 时间：2015-05-19T17:15:42.630

使用属性名称：

```
 @Html.ActionLink(linkText: "SomeText", actionName: "SomeAction", controllerName: "SomeControllerName", routeValues: new { parameterName = parameterValue}, htmlAttributes: null) 
```

* * *

## 回答 #10

> 赞同：1
> 
> 时间：2021-04-21T17:01:00.283

这工作得很好

```
@Html.ActionLink("Informationen", "About", "Home", new { area = "" }, new { @class = "nav-link" }) 
```

补充道`new { area = "" }`。

* * *

## 回答 #11

> 赞同：0
> 
> 时间：2018-08-09T15:47:40.303

也许其他人也有同样的问题，需要通过*HTMLAttributes* parm提供**类**值。这是我的解决方案：

 *```
@Html.ActionLink("About", "About", new { controller = "Home", area = "" }, new { hidefocus = "hidefocus", @class = "nav-item nav-link" })
```

* * *

## 回答 #12

> 赞同：0
> 
> 时间：2020-04-17T14:03:47.630

搜索我的问题的答案让我来到了这里，基本上是选择正确的重载，`@Html.ActionLink` [![在此处输入图像描述](https://i.stack.imgur.com/TzsM4.png)](https://i.stack.imgur.com/TzsM4.png) 这很重要。
我选择了一个不存在的重载（*没有*最后*一个* `null`），并且***`MVC`***没有这样的重载，导致一个类似于 OP 提到的错误 URL。

个人***说明：***您可以*`use`*匿名类型并不意味着您可以使用任何不存在的*重载*？-***确定：*** *必须* *定义*！
*- 在 MVC 5.2 时代来到这里*

# c# - WPF 等效于 TextRenderer

> ID：824281
> 
> 赞同：15
> 
> 时间：2009-05-05T10:31:17.113
> 
> 标签：c#, .net, wpf

我曾经`TextRenderer`测量过字符串的长度，因此可以适当地调整控件的大小。WPF 中是否有等价物或者我可以简单地使用`TextRendered.MeasureString`？

* * *

## 回答 #1

> 赞同：21
> 
> 时间：2009-05-08T16:20:00.643

谢谢吉舒，

阅读您的链接，我想出了以下两者都为我工作：

```
 /// <summary>
    /// Get the required height and width of the specified text. Uses FortammedText
    /// </summary>
    public static Size MeasureTextSize(string text, FontFamily fontFamily, FontStyle fontStyle, FontWeight fontWeight, FontStretch fontStretch, double fontSize)
    {
        FormattedText ft = new FormattedText(text,
                                             CultureInfo.CurrentCulture,
                                             FlowDirection.LeftToRight,
                                             new Typeface(fontFamily, fontStyle, fontWeight, fontStretch),
                                             fontSize,
                                             Brushes.Black);
        return new Size(ft.Width, ft.Height);
    }

    /// <summary>
    /// Get the required height and width of the specified text. Uses Glyph's
    /// </summary>
    public static Size MeasureText(string text, FontFamily fontFamily, FontStyle fontStyle, FontWeight fontWeight, FontStretch fontStretch, double fontSize)
    {
        Typeface typeface = new Typeface(fontFamily, fontStyle, fontWeight, fontStretch);
        GlyphTypeface glyphTypeface;

        if(!typeface.TryGetGlyphTypeface(out glyphTypeface))
        {
            return MeasureTextSize(text, fontFamily, fontStyle, fontWeight, fontStretch, fontSize);
        }

        double totalWidth = 0;
        double height = 0;

        for (int n = 0; n < text.Length; n++)
        {
            ushort glyphIndex = glyphTypeface.CharacterToGlyphMap[text[n]];

            double width = glyphTypeface.AdvanceWidths[glyphIndex] * fontSize;

            double glyphHeight = glyphTypeface.AdvanceHeights[glyphIndex]*fontSize;

            if(glyphHeight > height)
            {
                height = glyphHeight;
            }

            totalWidth += width;
        }

        return new Size(totalWidth, height);
    } 
```

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2009-05-05T10:50:55.240

看看[FormattedText 类](http://msdn.microsoft.com/en-us/library/system.windows.media.formattedtext_methods.aspx)

如果您需要更精细的控制，则需要下降到 GlyphTypeface 类型的[AdvanceWidths](http://msdn.microsoft.com/en-us/library/system.windows.media.glyphtypeface.advancewidths.aspx)成员。在这里找到了一个[类似的讨论](http://social.msdn.microsoft.com/Forums/en-US/wpf/thread/a450b0aa-7086-4145-9eff-a779571b6187/)，其中包含一个看起来可能有效的代码片段。

**更新**：看起来这可能是[WPF 中测量文本](https://stackoverflow.com/questions/632445/measuring-text-in-wpf)的副本.. OP 请确认。

# c# - .net 应用程序的负载平衡或故障转移服务器

> ID：824284
> 
> 赞同：1
> 
> 时间：2009-05-05T10:33:03.847
> 
> 标签：c#, load-balancing, failovercluster

场景我有用 c#.net 编写的服务。

现在在我的生产环境中，我希望此服务位于 2 台不同的服务器上，用于负载平衡或其中一台服务器的故障转移。

因此，例如，如果一台服务器死机，则服务会继续在另一台服务器上运行并且用户不会受到影响，或者如果站点负载过重，用户会被重定向到不同的服务器。

对于在不同服务器上重定向的用户来说不是问题，我们有可以检查服务是否正在运行的软件。在这种情况下如何进行会话管理？

我们怎样才能做到这一点？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2009-12-13T18:03:29.103

当然，您可以随时使用自己的会话管理服务，但我认为这不是您想要的。

我有使用[NCache](http://www.alachisoft.com/ncache/ "NCache")进行会话管理的经验，它运行良好。

微软也有[Velocity](http://www.microsoft.com/downloads/details.aspx?FamilyId=B24C3708-EEFF-4055-A867-19B5851E7CD2&displaylang=en "速度")，但我不确定它是否完整。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2014-11-26T17:11:28.530

非常老的问题，但仍然可以通过 Google 搜索。从 Windows 2012 开始，有一个称为集群共享任务的功能。可能还不成熟，因为它只能通过 PowerShell 进行管理，但也许是一个好的开始。检查这个[MSDN 帖子](http://blogs.msdn.com/b/clustering/archive/2012/05/31/10312527.aspx)。我迫不及待地想亲自尝试一下。

# c++ - What does C++ struct syntax "a : b" mean

> ID：824295
> 
> 赞同：44
> 
> 时间：2009-05-05T10:36:35.993
> 
> 标签：c++, data-structures, syntax, struct

If I have a C++ struct, defining a 64bit data word such as..

```
struct SMyDataWord
{
    int Name : 40;
    int Colour : 24;
}; 
```

What does the `: 40` syntax mean... does it mean that the first 40 bits are reserved for the Name and the remaining 24 bits for the Colour?

This is how it appears to be being used, but I've not come across it before.

* * *

## 回答 #1

> 赞同：28
> 
> 时间：2009-05-05T10:39:49.387

Bitfields, carried over from C. `Name` is 40 bits wide, `Colour` is 24 bits wide. Your struct therefore has at least 64 bits. On my system 64 bits would be 8 bytes.

* * *

## 回答 #2

> 赞同：10
> 
> 时间：2018-04-08T20:51:29.407

Here `sizeof` nicely demonstrates what's going on under the hood:

```
#include <iostream>
#include <climits>

struct bc_1 {
   int a : 1;
   int b : 1;
};

struct bc_2 {
   int a : 31;
   int b : 1;
};

struct bc_3 {
   int a : 32;
   int b : 1;
};

struct bc_4 {
   int a : 31;
   int b : 2;
};

struct bc_5 {
   int a : 32;
   int b : 32;
};

struct bc_6 {
   int a : 40;
   int b : 32;
};

struct bc_7 {
   int a : 63;
   int b : 1;
};

int main(int argc, char * argv[]) {
    std::cout << "CHAR_BIT = " << CHAR_BIT;
    std::cout << " => sizeof(int) = " << sizeof(int) << std::endl;

    std::cout << "1,  1:  " << sizeof(struct bc_1) << std::endl;
    std::cout << "31, 1:  " << sizeof(struct bc_2) << std::endl;
    std::cout << "32, 1:  " << sizeof(struct bc_3) << std::endl;
    std::cout << "31, 2:  " << sizeof(struct bc_4) << std::endl;
    std::cout << "32, 32: " << sizeof(struct bc_5) << std::endl;
    std::cout << "40, 32: " << sizeof(struct bc_6) << std::endl;
    std::cout << "63, 1:  " << sizeof(struct bc_7) << std::endl;
} 
```

What follows depends on your compiler and OS, and possibly on your hardware. On macOS with gcc-7 (with a `CHAR_BIT` = 8, a 32 bit `int` (i.e. half of 64 bit `long`) has `sizeof(int)` = 4) this is the output I see:

```
CHAR_BIT = 8 => sizeof(int) = 4
1,  1:  4
31, 1:  4
32, 1:  8
31, 2:  8
32, 32: 8
40, 32: 12
63, 1:  8 
```

This tells us several things: if both fields of `int` type fit into a single `int` (i.e. 32 bits in the example above), the compiler allocates only a single `int`'s worth of memory (`bc_1` and `bc_2`). Once, a single `int` can't hold the bitfields anymore, we add a second one (`bc_3` and `bc_4`). Note that `bc_5` is at capacity.

Interestingly, we can "select" more bits than allowed. See `bc_6`. Here g++-7 gives a warning:

```
bitfields.cpp::30:13: warning: width of 'bc_6::a' exceeds its type
     int a : 40;
             ^~ 
```

Note that: clang++ explains this in better detail

```
bitfields.cpp:30:9: warning: width of bit-field 'a' (40 bits) exceeds the width of its type; value will be truncated to 32 bits [-Wbitfield-width]
    int a : 40;
    ^ 
```

However it seems that under the hood, the compiler allocates another `int`'s worth of memory. Or at the very least, it determines the correct size. I guess the compiler is warning us not to access this memory as `int a = bc_6::a` (I would wager that `int a` would then only have the first 32 bits of field `bc_6::a`...). This is confirmed by `bc_7` whose total size is that of two `int`s, but the first field covers most of them.

Finally replacing `int` with `long` in the example above behaves as expected:

```
CHAR_BIT = 8 => sizeof(long) = 8
1,  1:  8
31, 1:  8
32, 1:  8
31, 2:  8
32, 32: 8
40, 32: 16
63, 1:  8 
```

* * *

## 回答 #3

> 赞同：9
> 
> 时间：2009-05-05T10:40:26.623

Yes, that is the syntax for [bitfields](https://docs.microsoft.com/en-us/cpp/c-language/c-bit-fields?redirectedfrom=MSDN&view=msvc-160). They are commonly used to define structs that map onto hardware registers. There are some things to keep in mind if you decide to use them, one is that you can't know how the compiler does the layout, ordering and padding in the actual bytes making up the fields can and will differ among compilers (and perhaps with the same compiler but with different optimization settings, too).

* * *

## 回答 #4

> 赞同：7
> 
> 时间：2009-05-05T10:40:41.613

That's a bitfield definition.

Name is an integer that's able to store exactly 40 bits of information. Colour can store 24 bits.

This is often done to save some space in often needed structures, or compress code down to a size that's easy to handle for the CPU (in your case 64 bits. Fit's exactly into a CPU register on a 64 bit machine).

The code that accesses the bitfields will execute a tad slower though.

* * *

## 回答 #5

> 赞同：3
> 
> 时间：2009-05-05T10:51:10.920

[Use them judiciously](http://www.informit.com/guides/content.aspx?g=cplusplus&seqNum=131):

> Remember that almost everything about bit fields is implementation dependent. For example, whether bits are stored left-to-right or right-to-left depends on the actual hardware architecture. Furthermore, each compiler uses a different member alignment model, which is why the size of the optimized BillingRec is 12 bytes rather than 9\. You cannot take a bit field's address nor can you create an arrays of bits. Finally, on most implementations the use of bit fields incurs speed overhead. Therefore, when you optimize your code, measure the effect of a certain optimization and its tradeoffs before you decide to use it.

# unix - 在 ksh 中取消进程

> ID：824300
> 
> 赞同：3
> 
> 时间：2009-05-05T10:38:03.993
> 
> 标签：unix, ksh

“disown”命令在 bash 中有效，但在 ksh 中无效。

如果我在 ksh 中启动了一个进程，我怎么能“否认”它，所以我可以退出我的 shell。（我知道nohup，但是这个过程已经开始了！）

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2009-05-09T21:51:23.860

ksh93 支持 disown 命令。此外，某些版本的 nohup 允许您使用 -p 选项而不是命令来指定进程 ID。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2011-11-22T00:06:15.917

在 ksh 中，只运行不带 -h 选项的 disown。而已。

从`ksh(1)`手册：

> ```
> disown [ job... ]
>     Causes the shell not to send a HUP signal to each given job, or all active
>     jobs if job is omitted, when a login shell terminates. 
> ```

# html - 为什么即使在 html 源代码中编码，html 属性也会返回为“htmldecoded”？

> ID：824305
> 
> 赞同：0
> 
> 时间：2009-05-05T10:39:26.610
> 
> 标签：html, dom, html-encode

我使用 html 属性标题来设置一些这样的提示：

```
 <a href... title="Go to next chapter">Go</a> 
```

然后 jquery 插件遍历所有 [title] 属性并制作漂亮的工具提示。为上面的链接创建了一个非常简化的新 div

```
<div style="position:absolute...">Go to next chapter</div> 
```

问题是，用户可以编辑标题，所以他可以写任何他想写的东西。一开始以为html编码没问题，结果发现我错了。如果我有

```
<a id="a" title="&lt;script&gt;alert(10);&lt;/script&gt">Go</a> 
```

然后工具提示 div 看起来像这样：

```
<div style="position:absolute..."><script>alert(10)</script></div> 
```

1）为什么浏览器在查询title属性的值时会解码它的值？

2）我该如何解决？（我知道一种解决方案是双 html 编码，但这很糟糕）

如何测试它：考虑这段代码

```
<html>  
 <body>  
  <!-- encoding once, this doesn't work -->
  <a id="a" title="&lt;script&gt;alert(10);&lt;/script&gt">atitle</a>  
  <!-- encoding twice, this works -->
  <a id="b" title="&amp;lt;script&amp;gt;alert(10);&amp;lt;/script&amp;gt">btitle</a>  

  <script>  
   function w(x){ document.write(x.attributes["title"].value);}  
   w(a);  // shows alert
   w(b);  // outputs it correctly into the page
  </script>  
 </body>  
</html> 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-05-05T10:49:12.140

1）属性值是解码后的值——如果你仔细想想，这是唯一有意义的方法。如果您将 javascript 值设置为“\n”然后提醒它，您想要返回“\n”还是真正的换行符？标题属性是文本...您只是碰巧必须对其进行 HTML 编码来编写它。

2）您可以对其进行双重编码，或者您可以使用文本节点：

```
var node = document.createTextNode(x.attributes['title'].value);
document.appendChild(node); 
```

这是首选方式，然后蜘蛛/非 JavaScript 浏览器将看到正确的标题属性。

# java - Grails查询关联问题

> ID：824306
> 
> 赞同：3
> 
> 时间：2009-05-05T10:39:45.063
> 
> 标签：java, grails, hql, criteria, grails-orm

我在为以下域类编写查询时遇到问题：

```
class Person {
  static hasMany = [memberships: Membership]
}

class Membership {

    static belongsTo = [person: Person, group: Group]

    Date joinDate = new Date();
    Group group;
    Person person;
}

class Group {
     static hasMany = [memberships: Membership]
} 
```

基本上，我想找到属于组列表的所有人员（假设组 id 是`(1,2)`。这里的技巧是该人必须是两个组的成员。我更喜欢条件查询，但 HQL 也可以.

请注意，使用类似的查询`group.id in (1,2)`不起作用，因为它可以是任何组，而不是**两者**。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-05-06T17:05:51.633

这是我简单的 HQL 方法：

```
Person.executeQuery("FROM Person x WHERE x IN (SELECT m.person from Membership m WHERE m.group = :group1) AND x IN (SELECT m.person from Membership m WHERE m.group = :group2)", [ group1: Group.get(1), group2: Group.get(2) ]) 
```

干杯

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-05-07T19:20:54.437

也许您不需要查询。在 Person 类中，memberships 是 Membership 对象的列表。您可以在不进行任何查询的情况下查找对象是否在集合（列表）中。像这样的东西应该可以完成这项工作。

```
if(Person.memberships.contains(Membership.findByPersonAndGroup(person1,group1)) && Person.memberships.contains(Membership.findByPersonAndGroup(person1,group2))){
  ...do something...
} 
```

可能另一种解决方案更简单，但我认为这只是另一种选择。

干杯

[Groovy 集合](http://groovy.codehaus.org/Collections)

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-05-12T18:05:34.797

有趣的问题。不确定以前的解决方案在匹配组的数量上是否通用 - 在到目前为止的情况下，我认为它固定为 2。尽管可能有一种方法可以使它们可变。

我在 grails 留言板上描述的另一种方式 - [http://www.nabble.com/has-many-through-relationship-query---GORM--td23438096.html](http://www.nabble.com/has-many-through-relationship-query---GORM--td23438096.html)

包括作者 Robert Fischer 对“Grails Persistence with GORM and GSQL”的评论。

@chadsmall

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2012-02-01T08:37:10.470

这是另一种避免必须以编程方式将子查询附加到 WHERE 子句的方法：

询问：

```
SELECT count(person.id) AS numPeople, person 
FROM Person as person 
INNER JOIN 
person.memberships AS mships
WITH mships.group.id IN (:groupIds) 
GROUP BY person.id 
HAVING COUNT(person.id) = (:numOfGroupIds) 
```

还有一些示例值：

```
[
  groupIds: [8,9,439,86843]
  numOfGroupIds: 4
] 
```

此查询中直到 GROUP BY 的部分会抓取与*任何*组匹配的所有人员。然后，通过按人分组并检查结果数是否等于列表中的组数，您可以验证此人是所有指定组的成员。

# c# - 使用 c# 启动 Outlook

> ID：824311
> 
> 赞同：5
> 
> 时间：2009-05-05T10:42:45.290
> 
> 标签：c#, .net, outlook

我可以让 C# 在代码中启动 Outlook 吗？

在 VB6 中，我们使用对象 'Outlook.Application' 并写入：'

```
Set oOutlook = CreateObject("Outlook.Application") 
Set oNameSpace = oOutlook.GetNamespace("MAPI") 
Set oInbox = oNameSpace.Folders(1) 
 'Set oInbox = oInbox.Folders("Inbox")
oInbox.Display 
 'oOutlook.Quit 'Close All Outlook copies 
```

从链接复制/粘贴：[http ://www.ozgrid.com/forum/showthread.php?t=73886](http://www.ozgrid.com/forum/showthread.php?t=73886)

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2009-05-05T10:55:08.710

`System.Diagnostics.Process`只会启动一个进程。

要执行选择文件夹等其他操作，您需要使用 Microsoft Visual Studio Tools for Office (VSTO)。这是它的参考[。](http://msdn.microsoft.com/en-us/library/microsoft.office.interop.outlook.aspx)例如：

```
var outlook = new Microsoft.Office.Interop.Outlook.ApplicationClass();
outlook.Quit(); 
```

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2009-05-05T10:46:06.343

如果你只是想开始展望；使用[System.Diagnostics.Process](http://msdn.microsoft.com/en-us/library/system.diagnostics.process.aspx)将是最简单的方法。:)

* * *

## 回答 #3

> 赞同：4
> 
> 时间：2009-05-05T11:00:53.190

您可以使用它的 ProgID 来获取类型和激活器

```
Type objectType = Type.GetTypeFromProgID("Outlook.Application");
object outlook = Activator.CreateInstance(objectType); 
```

但是在 C# 中使用它会丢失所有类型信息（即没有 IntelliSense），并且您需要调用一些丑陋的方法来使用 LateBinding 调用操作（Google for Type.Invoke）

其他选项是添加对 Microsoft.Office.Interop.Outlook.ApplicationClass 的引用，这样您就可以编译时间类型信息并以通常的方式为 Outlook 创建一个实例

```
using Microsoft.Office.Interop.Outlook;
Microsoft.Office.Interop.Outlook.ApplicationClass outlook 
     = new Microsoft.Office.Interop.Outlook.ApplicationClass(); 
```

或者你可以使用我的[后期绑定助手](http://code.google.com/p/latebindinghelper)库并像这样使用它

```
Invoker outlook = BindingFactory.CreateAutomationBinding("Outlook.Application");
outlook.Method("Quit").Invoke(); 
```

这个没有 Intellisense，但至少该库将使您免于对 Type.Invoke 的丑陋调用，并为您提供流畅的界面。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2017-02-08T17:28:41.263

这有效（您可能必须将路径更改为运行应用程序的机器上的路径）：

```
public static void StartOutlookIfNotRunning()
{
    string OutlookFilepath = @"C:\Program Files (x86)\Microsoft Office\Office12\OUTLOOK.EXE";
    if (Process.GetProcessesByName("OUTLOOK").Count() > 0) return;
    Process process = new Process();
    process.StartInfo = new ProcessStartInfo(OutlookFilepath);
    process.Start();
} 
```

# sql-server-2005 - 无法使用 osql 连接到 SQL Server

> ID：824315
> 
> 赞同：0
> 
> 时间：2009-05-05T10:44:06.037
> 
> 标签：sql-server-2005

我有一个连接到 SQL Server 2005 默认实例的脚本。但我正在连接，而是收到以下消息

```
[SQL Native Client]Named Pipes Provider: Could not open a connection to SQL Server [53].
[SQL Native Client]Login timeout expired
[SQL Native Client]An error has occurred while establishing a connection to the server. When connecting to SQL Server 2005, this failure may be caused by the fact that under the default settings SQL Server does not allow remote connections. 
```

该脚本的内容是：

```
osql -E -S <servername> -i D:\scripts\script1.sql -o D:\scripts\script1.txt 
```

我从 SQL Server 配置管理器查看了网络连接。TCP/IP 已启用，但命名管道已禁用。

我的问题是这个错误的可能原因和解决方案是什么？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2009-05-05T11:25:36.453

尝试 osql -E -S(local) 或 osql -E -S。我还没有弄清楚为什么有时它会起作用，而其他时候却不起作用。

# nhibernate - NHibernate 在拦截器中添加未映射的列

> ID：824316
> 
> 赞同：1
> 
> 时间：2009-05-05T10:44:51.307
> 
> 标签：nhibernate, iinterceptor

我正在尝试使用 NHibernate 保存映射的实体，但我对数据库的插入失败，因为基础表的列不允许空值并且未映射到我的域对象中。它没有被映射的原因是因为有问题的列支持遗留应用程序并且与我的应用程序无关 - 所以我不想用遗留属性污染我的实体。

我知道我可以在课堂上使用私有字段 - 但这对我来说仍然令人讨厌。我[读过](https://stackoverflow.com/questions/579885/unmapped-columns-in-nhibernate)我可以使用 NHibernate 拦截器并覆盖 OnSave() 方法以在保存我的实体之前添加到新列中。事实证明这很困难，因为我不知道如何将 Nhibernate.type.IType 的实例添加到我的拦截器 OnSave 的 types 参数中。

我的实体大致如下所示：

```
public class Client
{
    public virtual int Id { get; set; }
    public virtual int ParentId { get; set; }
    public virtual string Name { get; set; }
    public virtual string Phone { get; set; }
    public virtual string Email { get; set; }
    public virtual string Url { get; set; }
} 
```

还有我的拦截器

```
 public class ClientInterceptor : EmptyInterceptor
{

    public override bool OnSave(object entity, object id, object[] state, string[] propertyNames, NHibernate.Type.IType[] types)
    {
        if (entity is Client)
        {
            /*
              manually add the COM_HOLD column to the Client entity
            */
            List<string> pn_list = propertyNames.ToList();
            pn_list.Add("COM_HOLD");
            propertyNames = pn_list.ToArray();

            List<Object> _state = state.ToList();
            _state.Add(false);
            state = _state.ToArray();

            //somehow add an IType to types param ??

         }
         return base.OnSave(entity, id, state, propertyNames, types);
    }
} 
```

有人对如何正确执行此操作有任何想法吗？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-05-05T11:12:34.893

就个人而言，我不会做这么复杂的。我会添加私有属性并为其分配一个默认值 - 完成。您还可以考虑数据库中的默认值，然后您无需执行任何其他操作。

```
private virtual bool COM_HOLD 
{ 
  get { return false; } 
  set { /* make NH happy */ } 
} 
```

在为此编写拦截器之前，我会考虑编写一个数据库触发器。因为使用拦截器，您正在“污染”您的数据访问层。它*可能会*使其不稳定，并且您*可能*会遇到奇怪的问题。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-05-05T16:11:02.927

我不能肯定地说，因为我从来没有真正这样做过（比如 Stefan，我也更喜欢只添加一个私有属性），但是你可以只添加一个`NHibernate.Type.BooleanType`到`types`数组中吗？

```
List<IType> typeList = types.ToList();
typeList.Add(new BooleanType());
types = typesList.ToArray(); 
```

**编辑**

是的，看起来你是对的；这些类型有一个`internal`构造函数。我做了一些挖掘，发现`TypeFactory`：

> 如果默认的 IType 足够好，应用程序应该在 NHibernate.NHibernateUtil 上使用静态方法和常量。例如，TypeFactory 应该仅在 String 需要长度为 300 而不是 255 时使用。此时 NHibernate.String 不会为您提供正确的 IType。而是使用 TypeFactory.GetString(300) 并保留一个包含对 IType 的引用的局部变量。

所以看起来你想要的是`NHibernateUtil`：

> 提供对所有 NHibernate 内置类型的访问。IType 实例可用于将值绑定到查询参数。也是新 Blob 和 Clob 的工厂。

```
typeList.Add(NHibernateUtil.Boolean); 
```

# mysql - MYSQL 8 小时超时问题

> ID：824320
> 
> 赞同：4
> 
> 时间：2009-05-05T10:47:31.317
> 
> 标签：mysql

我正在使用 MYSQL 5.0 和 Tomcat 5.5。8 小时后，MYSQL 默认关闭，关闭所有空闲连接，因此我收到 SQL 异常。此问题的任何解决方案

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2009-05-05T10:48:52.873

您使用的是哪个连接池？大多数允许定期执行心跳命令以防止连接空闲。

编辑：查看[DBCP 配置页面](http://commons.apache.org/dbcp/configuration.html)，我认为您应该设置一个合适的（便宜的）`validationQuery`。然后，您可以告诉 DBCP 在可能驱逐空闲连接时对此进行测试（`testWhileIdle`），或者告诉它在返回连接之前进行测试（`testOnBorrow`）。第一个会（希望！）让你的空闲连接保持活跃；第二个不会，但不会返回断开的连接（即，如果需要，是否会创建一个新的连接）。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2009-05-05T10:50:09.860

您的意思是在它们空闲时保持连接处于活动状态吗？我不是 mySql 方面的专家，但在我一直使用的数据库中，仅在需要时保持连接打开，然后关闭它被认为是一种很好的做法。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2009-05-05T10:52:28.747

我不知道如何增加超时但我想应该有一个设置..你为什么不在需要时创建连接，并在使用它后关闭它而不是依赖于创建的连接？

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2011-10-26T18:06:14.060

使用 MySQL，默认情况下，一个打开的连接（通常在连接池中等待）将在 8 小时不活动后关闭。您可以通过在 my.cnf 或我们的 mysql 命令行中配置 wait_timeout 变量来更改此时间为 8 小时

请参阅： http: [//dev.mysql.com/doc/refman/5.0/en/server-system-variables.html#sysvar_wait_timeout](http://dev.mysql.com/doc/refman/5.0/en/server-system-variables.html#sysvar_wait_timeout) http://dev.mysql.com/doc/refman/5.0/en/gone-away .html

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2015-12-23T05:46:42.223

这个问题几年前就有人问过了，但我觉得有正确答案就好了。我有同样的问题，要解决我不得不稍微调整一下配置。这对我有用。继续[https://people.apache.org/~fhanik/jdbc-pool/jdbc-pool.html](https://people.apache.org/~fhanik/jdbc-pool/jdbc-pool.html)了解更多信息。下面的代码处理了一切。有办法优化这些值，但我稍后会处理这些。

```
<Resource name="jdbc/database" 
               auth="Container" 
               type="javax.sql.DataSource"
               maxActive="100" 
               maxIdle="30" 
               maxWait="10000"
          username="username" password="password" 
          driverClassName="com.mysql.jdbc.Driver"
          url="jdbc:mysql:///"
          factory="org.apache.tomcat.jdbc.pool.DataSourceFactory" jdbcInterceptors="org.apache.tomcat.jdbc.pool.interceptor.ConnectionState;org.apache.tomcat.jdbc.pool.interceptor.StatementFinalizer"
          testWhileIdle="true"
          testOnBorrow="true"
          testOnReturn="false"
          validationQuery="SELECT 1"
          validationInterval="30000"`enter code here`
          timeBetweenEvictionRunsMillis="30000"
          minIdle="10" `enter code here`
          initialSize="10"
          removeAbandonedTimeout="60"
          removeAbandoned="true"
          logAbandoned="true"
          minEvictableIdleTimeMillis="30000" 
          jmxEnabled="true"         
           /> 
```

# apache-flex - Flex 中的线性树

> ID：824323
> 
> 赞同：0
> 
> 时间：2009-05-05T10:48:20.927
> 
> 标签：apache-flex, actionscript

> ```
> <mx:Script>
>     <![CDATA[
>         private function openAllNodes():void {
>             tree.openItems = dp..node;
>         }
> 
>         private function closeAllNodes():void {
>             tree.openItems = [];
>         }
>     ]]>
> </mx:Script>
> 
> <mx:XML id="dp">
>     <root>
>         <node label="Parent 1">
>             <node label="Child 1" />
>             <node label="Child 2">
>                 <node label="Grandchild 1" />
>                 <node label="Grandchild 2" />
>             </node>
>             <node label="Child 3" />
>             <node label="Child 4" />
>         </node>
>     </root>
> </mx:XML>
> 
> <mx:ApplicationControlBar dock="true">
>     <mx:Button label="Open all nodes" click="openAllNodes();" />
>     <mx:Button label="Close all nodes" click="closeAllNodes();" />
> </mx:ApplicationControlBar>
> 
> <mx:Tree id="tree"
>         dataProvider="{dp}"
>         showRoot="false"
>         labelField="@label"
>         width="200" /> 
> ```

除非或以其他方式单击我的父列表，否则子列表或下一个列表必须处于禁用状态。

我点击子 1，然后只有子 2 必须能够选择。

请帮我。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2009-05-05T12:19:22.907

听起来您可能想要扩展树类并覆盖一些方法来实现您的特殊功能。查看覆盖 drawItem、mouseClickHandler 和可能的 expandItem 函数。

# php - 查询的输出显示为空

> ID：824329
> 
> 赞同：0
> 
> 时间：2009-05-05T10:49:26.693
> 
> 标签：php, sql, mysql

我正在尝试查找字段 ARTICLE_NO 是某个数字的文件列表。目前，我有一个文件表，其中包含 ARTICLE_NO、FILENAME 和 USERNAME 列。有一条记录，其值分别为 1、x.txt 和 user。$pk 在我的 php 代码中分配给 1 。但是，下面的代码只产生 NULL，我不确定为什么。

```
$filesQuery = "SELECT FILENAME FROM FILES WHERE ARTICLE_NO = ?"; 

if ($getFiles = $con->prepare($filesQuery)) {
    $getFiles->bind_param("s", $pk);
    $getFiles->execute();
    $getFiles->bind_result($FILENAME);
    $files = array();

    while ($getFiles->fetch()) {
         $filenames = array(
         'FILENAME' => $FILENAME,
          );
$files[] = $filenames;
        }
}
var_dump($files['FILENAME']);
    foreach ($files as $filenames)
    {
    $filesList = '<p><a href="./files/'. $files['FILENAME'] .'">'. $files['FILENAME'] .'</a>' . "\n"; 
    } 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2009-05-05T11:06:22.473

您正在访问错误构建的数组。当处理来自数据库的 1 个结果行时，$files 是一个包含 1 个其他数组的数组，如下所示：

```
$files = array ( 0 => array ( 'FILENAME' => 'x.txt' ) ); 
```

因此，要访问 FILENAME 下的值，您需要使用：

```
var_dump($files[0]['FILENAME']); 
```

或者

```
foreach($files as $file_data) { echo $file_data['FILENAME']; } 
```

# c# - 是否应该将实体框架上下文放入 Using 语句？

> ID：824330
> 
> 赞同：65
> 
> 时间：2009-05-05T10:49:31.203
> 
> 标签：c#, entity-framework

实体框架上下文对象实现了一个 Dispose() 方法，该方法“释放对象上下文使用的资源”。它的真正作用是什么？总是把它放在 using {} 语句中会是一件坏事吗？我已经看到它在有和没有 using 语句的情况下都被使用。

我将专门从 WCF 服务方法中使用 EF 上下文，创建上下文，执行一些 linq 并返回答案。

**编辑：**似乎我不是唯一对此感到疑惑的人。另一个问题是 Dispose() 方法内部到底发生了什么。有人说它关闭了连接，有些文章说没有。这是怎么回事？

* * *

## 回答 #1

> 赞同：35
> 
> 时间：2009-05-05T11:06:29.743

如果您创建上下文，则必须稍后将其释放。是否应该使用`using`语句取决于上下文的生命周期。

1.  如果您在方法中创建上下文并仅在此方法中使用它，您应该真正使用该`using`语句，因为它为您提供异常处理而无需任何额外代码。

2.  如果您使用上下文的时间更长——即生命周期不受方法执行时间的限制——您不能使用该`using`语句，您必须`Dispose()`自己调用并注意始终调用它。

对象上下文有什么作用`Dispose()`？

我没有看代码，但至少我希望它关闭与其底层套接字或传输机制使用的任何资源的数据库连接。

* * *

## 回答 #2

> 赞同：5
> 
> 时间：2010-11-11T19:43:36.297

每个[编程实体框架](https://rads.stackoverflow.com/amzn/click/com/0596807260)：“您可以显式处理 ObjectContext 或等待垃圾收集器完成这项工作。”

所以简而言之，虽然 using 语句不是必需的，但最好的做法是，如果您知道您已完成使用 ObjectContext，因为资源会立即释放，而不是等待垃圾收集。

* * *

## 回答 #3

> 赞同：4
> 
> 时间：2009-05-05T11:06:13.270

由于您不知道垃圾收集器何时处理项目，因此如果您知道何时完成处理，最好将实现 IDisposable 的对象包装在*using 块中。*

* * *

## 回答 #4

> 赞同：3
> 
> 时间：2014-04-22T18:50:09.583

EF5 及之前版本

```
 using { ...
            // connecction open here.

            ...
            context.Blogs.Add(blog); 
            context.SaveChanges();   // query etc now opens and immediately closes 

            ...
            context.Blogs.Add(blog); 
            context.SaveChanges();   // query etc now opens and immediately closes 
   } 
```

EF6 及以后版本

```
 using {
        // connecction open here.

        ...
        context.Blogs.Add(blog); 
        context.SaveChanges(); 

        // The underlying store connection remains open for the next operation  

        ...
        context.Blogs.Add(blog); 
        context.SaveChanges(); 

        // The underlying store connection is still open 

   } // The context is disposed – so now the underlying store connection is closed 
```

参考：http: [//msdn.microsoft.com/en-us/data/dn456849#open5](http://msdn.microsoft.com/en-us/data/dn456849#open5)

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2009-05-05T10:54:33.157

始终，如果您实例化一个实现 IDisposable 的类，那么您有责任在其上调用 Dispose。除了一种情况，这意味着一个*using*块。

* * *

## 回答 #6

> 赞同：1
> 
> 时间：2009-05-05T17:16:38.260

处置时，ObjectContext 会处置其他拥有的对象。

包括诸如包装实际数据库连接的EntityConnection之类的东西，即通常是SqlConnection。

因此，如果 SqlConnection 处于打开状态，它将在您处理 ObjectContext 时关闭。

* * *

## 回答 #7

> 赞同：1
> 
> 时间：2013-11-07T21:20:40.407

我真的为 ADO.net 和 EF v.6 测试了这个东西，并观察了 SQL 表中的连接

```
select * from sys.dm_exec_connections 
```

要测试的方法如下所示：

1) ADO.net 使用

```
 using(var Connection = new SqlConnection(conString))
  {
    using (var command = new SqlCommand(queryString, Connection))
    {    
       Connection.Open();
       command.ExecuteNonQueryReader();
       throw new Exception()  // Connections were closed after unit-test had been 
       //finished.  Expected behaviour
     }
  } 
```

2) ADO.net 不使用

```
var Connection = new SqlConnection(conString);
using (var command = new SqlCommand(queryString, Connection))
{
    Connection.Open();
     command.ExecuteNonQueryReader();
    throw new Exception() // Connections were NOT closed after unit-test had been finished

     finished.  I closed them manually via SQL.  Expected behaviour
    } 
```

1) EF 与使用。

```
 using (var ctx = new TestDBContext())
    {
        ctx.Items.Add(item);
        ctx.SaveChanges();
        throw new Exception() // Connections were closed, as expected.

     } 
```

2) 不使用 EF

```
 var ctx = new TestDBContext();             
 ctx.Items.Add(item);
 ctx.SaveChanges();
 throw new Exception() // Connections WERE successfully closed, as NOT expected. 
```

我不知道为什么会这样，但是 EF 自动关闭了连接。此外，所有使用 EF 的存储库和 UnitOfWork 模式都不使用 using。这对我来说很奇怪，因为 DBContext 是 Disposable 类型，但这是事实。

也许在微软他们做了一些新的处理？

* * *

## 回答 #8

> 赞同：0
> 
> 时间：2013-03-27T12:36:07.853

我注意到（尽管仅在一个应用程序中）显式处理导致 mscorlib 中的线程中止异常在应用程序代码之前被捕获，但至少在我的情况下会导致明显的性能下降。尚未对此问题进行任何重要研究，但如果您这样做，可能值得考虑。只需观察您的 DEBUG 输出，看看您是否得到相同的结果。

* * *

## 回答 #9

> 赞同：0
> 
> 时间：2013-06-10T09:39:54.007

如果 Dispose 关闭与 DB 的连接，那么调用它是个坏主意。例如，在 ADO.NET 中，连接位于连接池中，并且在超时或应用程序池停止之前永远不会关闭。

# c# - wcf json 网络服务

> ID：824331
> 
> 赞同：10
> 
> 时间：2009-05-05T10:49:32.543
> 
> 标签：c#, .net, wcf, json

创建 JSON Web 服务的最佳方式是什么？我们有另一个使用 Java 的团队，他们坚持使用 JSON 完成所有通信。我更喜欢使用 WCF 而不是任何 3rd 方框架。

我发现了这个博客：[http](http://www.west-wind.com/weblog/posts/164419.aspx) ://www.west-wind.com/weblog/posts/164419.aspx ，它表明微软的实现存在缺陷，因为特定于 M$ 的废话。

* * *

## 回答 #1

> 赞同：13
> 
> 时间：2009-05-06T21:42:17.803

如果您使用 WCF 和 3.5 框架，那就再简单不过了。当您使用 WebGet 属性标记 OperationContracts 时，只需将 ResponseFormat 参数设置为 WebMessageFormat.Json。当服务以 REST 方式访问时，它将使用 DataContractJsonSerializer 返回数据。

将要 JSON 序列化的 POCO 标记为 [DataContract] 并将每个可序列化成员标记为 [DataMember] 非常有帮助。否则，正如 Rick 在他的博客文章中指出的那样，你最终会得到时髦的 JSON。

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2010-08-18T03:54:54.187

[我在ServiceStack](http://www.servicestack.net)中维护了 WCF 的成熟开源替代方案，这是一个现代的、代码优先的、模型驱动的、WCF 替代 Web 服务框架，[鼓励使用代码和远程最佳实践](https://gist.github.com/1386381)来创建简洁、DRY、[高性能、可扩展的 REST Web 服务](http://www.servicestack.net/benchmarks/)。

它包括[.NET 最快的 JSON 序列化](http://www.servicestack.net/benchmarks/#burningmonk-benchmarks)器，并自动支持 JSON、JSONP、[CORS](https://stackoverflow.com/questions/8211930/servicestack-rest-api-and-cors/8215777#8215777)标头以及 form-urlencoded/multipart-formdata。在线演示是一个很好的开始，因为它们都使用 Ajax。

此外，没有 XML 配置或代码生成，您的“一次性编写”C# Web 服务提供开箱即用的所有[JSON、XML、SOAP、JSV、CSV、HTML](http://www.servicestack.net/ServiceStack.Northwind/)端点，自动使用钩子插入如果需要，在您自己的[内容类型中。](http://www.servicestack.net/ServiceStack.Northwind/vcard-format.htm)

它还包括[通用同步/异步服务客户端](http://www.servicestack.net/ServiceStack.Hello/#clients)，提供快速、类型化的客户端/服务器端对端通信网关。

这是创建简单 Web 服务所需的所有代码的完整示例，无需任何配置即可自动注册，并[在预定义和自定义 REST-ful 路由上的所有 Web 数据格式上](http://www.servicestack.net/ServiceStack.Hello/#predefinedroutes)可用：

```
public class Hello {
    public string Name { get; set; }
}

public class HelloResponse {
    public string Result { get; set; }
}

public class HelloService : IService<Hello> {
    public object Execute(Hello request)
    {
        return new HelloResponse { Result = "Hello, " + request.Name };
    }
} 
```

可以在 C# 中使用以下行调用上述服务（无需任何构建步骤/代码生成）：

```
var client = new JsonServiceClient(baseUrl);
var response = client.Send<HelloResponse>(new Hello { Name = "World!" });
Console.WriteLine(response.Result); // => Hello, World 
```

在 jQuery 中：

```
$.getJSON('hello/World!', function(r){ 
    alert(r.Result); 
}); 
```

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2013-03-05T15:21:59.637

> 创建 JSON Web 服务的最佳方式是什么？我们有另一个使用 Java 的团队，他们坚持使用 JSON 完成所有通信。我更喜欢使用 WCF 而不是任何 3rd 方框架。

下面是一个易于遵循的演练，它将引导您完成设置您的第一个 WCF 服务，然后将其链接到 SQL Server 数据库的过程。

[http://mikesknowledgebase.com/pages/Services/WebServices-Page1.htm](http://mikesknowledgebase.com/pages/Services/WebServices-Page1.htm)

它使用 Microsoft 钟爱的*Northwind* SQL Server 数据库，并展示了如何编写一个简单的 JSON WCF Web 服务来读取和写入它的数据。

![在此处输入图像描述](https://i.stack.imgur.com/Jf70I.jpg)

哦，然后它展示了如何使用 JavaScript 或 iOS 应用程序使用 JSON 数据。

祝你好运 ！

* * *

## 回答 #4

> 赞同：-4
> 
> 时间：2009-08-24T09:18:28.737

我最终使用了[JayRock](http://jayrock.berlios.de/)。它是一项了不起的技术，可以正常工作。如果您没有正确配置它，您不会从这个废话 WCF 中获得任何 NullReferenceExceptions。

# flash - SWFObject v2 - 如何在 IE7 中删除烦人的“点击激活”消息？

> ID：824346
> 
> 赞同：-1
> 
> 时间：2009-05-05T10:53:24.300
> 
> 标签：flash, swfobject

我正在使用 SWFObject 版本 2，并使用其动态发布功能。嵌入 flash 的典型 JavaScript 代码（基于其文档页面中的特色示例）：

```
swfobject.embedSWF(.. 
```

但是，在 IE7 中，我总是看到“点击激活”消息。我听说 SWFObject 应该解决这个问题，但是，我现在对它的经验让我不敢苟同。我很高兴被证明是错误的。

任何建议，如何消除这个问题？非常感谢使用 SWFObject 的示例 JavaScript 代码和/或页面 URL。

谢谢。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-05-05T14:05:34.383

按照[文档中详细说明的步骤](http://code.google.com/p/swfobject/wiki/documentation)操作，您应该会很成功。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-06-17T05:54:47.490

大约一年前，微软取消了点击激活“功能”（微软与 EOLAS 达成和解，允许微软停止要求点击激活插件）。如果您仍然遇到点击激活消息，您可能需要获取最新的 IE 安全补丁。

SWFObject 1.x 解决了这个问题，但是 SWFObject 2.x 不再解决这个问题，因为微软已经发布了它的浏览器补丁。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2011-04-17T04:40:17.613

添加 CSS

```
object {
    display:block;
} 
```

# javascript - 如何在不重新加载页面的情况下修改 URL？

> ID：824349
> 
> 赞同：2776
> 
> 时间：2009-05-05T10:54:05.763
> 
> 标签：javascript, html, url, url-rewriting, friendly-url

有没有办法可以在不重新加载页面的情况下修改当前页面的 URL？

如果可能，我想访问# 哈希**之前的部分。**

我只需要更改域**之后**的部分，所以我不违反跨域策略。

```
 window.location.href = "www.mysite.com/page2.php";  // Sadly this reloads 
```

* * *

## 回答 #1

> 赞同：2291
> 
> 时间：2010-07-28T15:30:31.523

这现在可以在 Chrome、Safari、Firefox 4+ 和 Internet Explorer 10pp4+ 中完成！

有关更多信息，请参阅此问题的答案： *[Updating address bar with new URL without hash or reloading the page](https://stackoverflow.com/questions/3338642/updating-address-bar-with-new-url-without-hash-or-reloading-the-page)*

例子：

```
 function processAjaxData(response, urlPath){
     document.getElementById("content").innerHTML = response.html;
     document.title = response.pageTitle;
     window.history.pushState({"html":response.html,"pageTitle":response.pageTitle},"", urlPath);
 } 
```

然后，您可以使用`window.onpopstate`来检测后退/前进按钮导航：

```
window.onpopstate = function(e){
    if(e.state){
        document.getElementById("content").innerHTML = e.state.html;
        document.title = e.state.pageTitle;
    }
}; 
```

* * *

要更深入地了解操纵浏览器历史记录，请参阅[这篇 MDN 文章](https://developer.mozilla.org/en-US/docs/Web/Guide/API/DOM/Manipulating_the_browser_history)。

* * *

## 回答 #2

> 赞同：753
> 
> 时间：2010-08-17T13:59:35.013

HTML5 引入了[`history.pushState()`](https://developer.mozilla.org/en-US/docs/Web/API/History/pushState)和[`history.replaceState()`](https://developer.mozilla.org/en-US/docs/Web/API/History/replaceState)方法，分别允许您添加和修改历史条目。

```
window.history.pushState('page2', 'Title', '/page2.php'); 
```

[从这里](https://developer.mozilla.org/en-US/docs/Web/API/History_API/Working_with_the_History_API)阅读更多相关信息

* * *

## 回答 #3

> 赞同：181
> 
> 时间：2012-11-19T10:32:31.463

如果您想更改 url 但不想将条目添加到浏览器历史记录中，也可以使用 HTML5 **replaceState ：**

```
if (window.history.replaceState) {
   //prevents browser from storing history with each change:
   window.history.replaceState(statedata, title, url);
} 
```

这将“破坏”后退按钮功能。这在某些情况下可能是必需的，例如图片库（您希望后退按钮返回到图库索引页面，而不是返回浏览您查看的每张图片），同时为每张图片提供自己的唯一网址。

* * *

## 回答 #4

> 赞同：164
> 
> 时间：2015-06-10T18:25:35.763

这是我的解决方案（newUrl 是您要替换为当前 URL 的新 URL）：

```
history.pushState({}, null, newUrl); 
```

* * *

## 回答 #5

> 赞同：116
> 
> 时间：2009-05-05T10:57:05.867

**注意：如果您使用的是 HTML5 浏览器，则应忽略此答案。从其他答案中可以看出，这现在是可能的。**

如果不重新加载页面，就无法在浏览器中修改[URL 。](http://en.wikipedia.org/wiki/Uniform_resource_locator)URL 表示最后加载的页面是什么。如果您更改它（`document.location`），那么它将重新加载页面。

一个明显的原因是，您在其上编写了一个`www.mysite.com`看起来像银行登录页面的网站。然后你把浏览器的网址栏改成`www.mybank.com`. 用户将完全不知道他们真的在看`www.mysite.com`.

* * *

## 回答 #6

> 赞同：90
> 
> 时间：2009-05-13T22:14:44.193

```
parent.location.hash = "hello"; 
```

* * *

## 回答 #7

> 赞同：49
> 
> 时间：2017-07-02T08:03:02.443

在现代**浏览器和 HTML5**中，有一个名为`pushState`on window的方法`history`。这将更改 URL 并将其推送到历史记录而不加载页面。

你可以像这样使用它，它需要 3 个参数，1）状态对象 2）标题和 URL）：

```
window.history.pushState({page: "another"}, "another page", "example.html"); 
```

这将更改 URL，但不会重新加载页面。此外，它不会检查页面是否存在，因此如果您执行一些对 URL 做出反应的 JavaScript 代码，您可以像这样使用它们。

此外，还有`history.replaceState()`一个完全相同的事情，除了它会修改当前历史而不是创建一个新历史！

您也可以创建一个函数来检查是否`history.pushState`存在，然后像这样继续其余的：

```
function goTo(page, title, url) {
  if ("undefined" !== typeof history.pushState) {
    history.pushState({page: page}, title, url);
  } else {
    window.location.assign(url);
  }
}

goTo("another page", "example", 'example.html'); 
```

此外，您可以更改不会重新加载页面的`#`for 。这就是Angular根据标签`<HTML5 browsers`用来做[SPA的方式......](https://en.wikipedia.org/wiki/Single-page_application)

改变`#`很容易，像这样：

```
window.location.hash = "example"; 
```

你可以像这样检测它：

```
window.onhashchange = function () {
  console.log("#changed", window.location.hash);
} 
```

* * *

## 回答 #8

> 赞同：28
> 
> 时间：2012-11-21T11:09:02.650

正如 Vivart 和 geo1701 已经提到的，HTML5 replaceState 就是答案。但是，并非所有浏览器/版本都支持它。 [History.js](https://github.com/balupton/history.js)包装了 HTML5 状态特性，并为 HTML4 浏览器提供了额外的支持。

* * *

## 回答 #9

> 赞同：27
> 
> 时间：2014-01-24T08:49:08.117

在 HTML5 之前我们可以使用：

```
parent.location.hash = "hello"; 
```

和：

```
window.location.replace("http:www.example.com"); 
```

此方法将重新加载您的页面，但 HTML5 引入了`history.pushState(page, caption, replace_url)`不应该重新加载您的页面。

* * *

## 回答 #10

> 赞同：24
> 
> 时间：2011-04-19T11:43:59.900

如果您尝试做的是允许用户为页面添加书签/共享页面，并且您不需要它是完全正确的 URL，并且您没有将哈希锚用于其他任何事情，那么您可以分两次执行此操作部分; 你使用的位置。hash 上面讨论的，然后在主页上进行检查，以查找其中包含 hash 锚点的 URL，并将您重定向到后续结果。

例如：

1.  用户开启`www.site.com/section/page/4`

2.  用户执行一些操作将 URL 更改为`www.site.com/#/section/page/6`（使用哈希）。假设您已将第 6 页的正确内容加载到页面中，因此除了散列之外，用户不会受到太大干扰。

3.  用户将此 URL 传递给其他人，或将其添加为书签

4.  其他人或同一用户在以后访问`www.site.com/#/section/page/6`

5.  上的代码`www.site.com/`将用户重定向到`www.site.com/section/page/6`，使用如下内容：

    if (window.location.hash.length > 0){ window.location = window.location.hash.substring(1); }

希望这是有道理的！在某些情况下，这是一种有用的方法。

* * *

## 回答 #11

> 赞同：19
> 
> 时间：2015-10-27T08:33:13.017

下面是在不重新加载页面的情况下更改 URL 的功能。它仅支持 HTML5。

```
 function ChangeUrl(page, url) {
        if (typeof (history.pushState) != "undefined") {
            var obj = {Page: page, Url: url};
            history.pushState(obj, obj.Page, obj.Url);
        } else {
            window.location.href = "homePage";
            // alert("Browser does not support HTML5.");
        }
    }

  ChangeUrl('Page1', 'homePage'); 
```

* * *

## 回答 #12

> 赞同：15
> 
> 时间：2019-11-29T09:48:00.910

您可以在应用程序的任何位置使用这个漂亮而简单的功能来执行此操作。

```
function changeurl(url, title) {
    var new_url = '/' + url;
    window.history.pushState('data', title, new_url);

} 
```

您不仅可以编辑 URL，还可以更新标题。

* * *

## 回答 #13

> 赞同：13
> 
> 时间：2009-05-05T10:58:53.303

如果您不只是更改 URL 片段，则任何位置更改（或`window.location`或）都将导致对该新 URL 的请求。`document.location`如果您更改 URL，则您更改 URL。

如果您不喜欢当前使用的 URL，请使用服务器端 URL 重写技术，例如[Apache 的 mod_rewrite 。](http://httpd.apache.org/docs/2.2/mod/mod_rewrite.html)

* * *

## 回答 #14

> 赞同：11
> 
> 时间：2009-12-13T22:57:11.873

您可以添加锚标记。我在我的网站上使用它，以便我可以使用 Google Analytics 跟踪人们在页面上访问的内容。

我只需添加一个锚标记，然后添加我要跟踪的页面部分：

```
var trackCode = "/#" + urlencode($("myDiv").text());
window.location.href = "http://www.piano-chords.net" + trackCode;
pageTracker._trackPageview(trackCode); 
```

* * *

## 回答 #15

> 赞同：9
> 
> 时间：2013-09-05T13:55:24.220

正如 Thomas Stjernegaard Jeppesen 所指出的，您可以在用户浏览您的 Ajax 链接和应用程序时使用[History.js修改 URL 参数。](https://github.com/browserstate/history.js)

自那个答案以来已经过去了将近一年，History.js 成长并变得更加稳定和跨浏览器。现在它可用于管理 HTML5 兼容以及许多仅支持 HTML4 的浏览器中的历史状态。[在这个演示](http://browserstate.github.io/history.js/demo/?state=1)中，您可以看到它如何工作的示例（以及能够尝试其功能和限制。

如果你在如何使用和实现这个库方面需要任何帮助，我建议你看一下演示页面的源代码：你会发现它很容易做到。

最后，有关使用哈希（和 hashbang）可能存在的问题的全面解释，请查看Benjamin Lupton 的[此链接](https://github.com/browserstate/history.js/wiki/Intelligent-State-Handling)。

* * *

## 回答 #16

> 赞同：8
> 
> 时间：2015-08-15T11:55:32.923

`history.pushState()`从 HTML 5 History API使用。

有关更多详细信息，请参阅[HTML5 历史 API](http://diveintohtml5.info/history.html)。

* * *

## 回答 #17

> 赞同：8
> 
> 时间：2020-07-18T06:34:31.907

您的新网址。

```
let newUrlIS =  window.location.origin + '/user/profile/management'; 
```

从某种意义上说，调用 pushState() 类似于设置 window.location = "#foo"，因为两者都会创建并激活与当前文档关联的另一个历史记录条目。但是 pushState() 有几个优点：

```
history.pushState({}, null, newUrlIS); 
```

您可以查看根目录：[https ://developer.mozilla.org/en-US/docs/Web/API/History_API](https://developer.mozilla.org/en-US/docs/Web/API/History_API)

* * *

## 回答 #18

> 赞同：1
> 
> 时间：2021-01-10T15:02:21.397

这段代码对我有用。我在 ajax 的应用程序中使用了它。

```
history.pushState({ foo: 'bar' }, '', '/bank'); 
```

一旦使用 ajax 将页面加载到 ID 中，它会自动更改浏览器 url 而无需重新加载页面。

这是下面的ajax函数。

```
function showData(){
    $.ajax({
      type: "POST",
      url: "Bank.php", 
      data: {}, 
      success: function(html){          
        $("#viewpage").html(html).show();
        $("#viewpage").css("margin-left","0px");
      }
    });
  } 
```

示例：从任何页面或控制器，如“仪表板”，当我点击银行时，它会使用 ajax 代码加载银行列表，而无需重新加载页面。此时，浏览器 URL 不会更改。

```
history.pushState({ foo: 'bar' }, '', '/bank'); 
```

但是当我将此代码用于 ajax 时，它会更改浏览器 url 而无需重新加载页面。这是下面的完整 ajax 代码。

```
function showData(){
        $.ajax({
          type: "POST",
          url: "Bank.php", 
          data: {}, 
          success: function(html){          
            $("#viewpage").html(html).show();
            $("#viewpage").css("margin-left","0px");
            history.pushState({ foo: 'bar' }, '', '/bank');
          }
        });
      } 
```

* * *

## 回答 #19

> 赞同：0
> 
> 时间：2020-06-09T23:07:19.513

**这就是您无需重新加载即可导航的全部内容**

```
// add setting without reload 
location.hash = "setting";

// if url change with hash do somthing
window.addEventListener('hashchange', () => {
    console.log('url hash changed!');
});

// if url change do somthing (dont detect changes with hash)
//window.addEventListener('locationchange', function(){
//    console.log('url changed!');
//})

// remove #setting without reload 

history.back();
```

* * *

## 回答 #20

> 赞同：-6
> 
> 时间：2021-08-05T17:55:21.400

简单地使用，它不会重新加载页面，而只是 URL ：

```
$('#form_name').attr('action', '/shop/index.htm').submit(); 
```

# c# - C# 和蓝牙编程

> ID：824357
> 
> 赞同：10
> 
> 时间：2009-05-05T10:57:21.963
> 
> 标签：c#, bluetooth

如何才能做到这一点？

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2010-10-17T22:39:14.500

[http://inthehand.com/content/32feet.aspx](http://inthehand.com/content/32feet.aspx)

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-04-10T21:14:38.617

蓝牙编程需要添加 32feet api。

# language-agnostic - 何时升级到新版本的语言或框架？

> ID：824367
> 
> 赞同：3
> 
> 时间：2009-05-05T11:00:19.290
> 
> 标签：language-agnostic, technical-debt

当出现新版本的框架或语言（例如 .NET 3.5、SQL2008）时，人们在何时采用/升级时采取什么方法？

一般来说，开发人员会尽快说（他们希望在他们的简历中提供，从管理的角度来看，给他们想要的东西会激发他们的动力），但在商业上通常很少有激励（很少有客户需要最新版本）并且从成本的角度来看（重新测试，培训）通常有一个抑制因素。

我特别想到了多年来存在和发展的“正在进行的”系统和项目（例如在软件公司中），而采用“新项目使用新技术”的方法是行不通的。

人们是否受到特定需求的驱动（需要使用新功能，潜在或现有客户要求支持），他们是否正式评估它（在这种情况下，标准是什么）或者他们是否将升级作为例行公事（在这种情况下 - 前沿与前沿）？

人们是否认为不使用最新版本的东西应该被视为技术债务并进行管理？

或者“如果它没有坏就不要修复它”是一种有效的方法吗？

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2009-05-05T11:15:24.573

阅读[技术债务](https://stackoverflow.com/search?q=technical+debt)。这是一个简单的成本效益决定。

“如果它没有坏就不要修理它”是一个常见的管理政策，它说“明天的美元不如今天的那么值钱，所以不要计划未来的改进。” 最终，技术债务累积到产品无法再跛行的程度。

最常见的断点是不再支持基础架构的某些部分。到那时，增量变化是不可能的。

从头开始重塑是一项新的资本投资。修复现有代码是一项费用。账户迫使管理层做出技术上疯狂的决定。

对于开源软件，它需要仔细的技术管理，因为 Oracle/Sun 没有正式的“支持日落”公告。糟糕的技术管理当然会导致技术破产。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2009-05-05T11:08:41.140

我们着眼于**支持生命周期成本**。旧版本支持多长时间，费用是多少？与大型机环境相比，Windows 和 Java 等平台的发展速度往往更快，在这些平台上开展业务的部分成本是执行定期升级。在一个理性的世界里，就是这样！

新版本可以具有我们需要的杀手级功能——但这在企业开发中很少见。新版本的主要正面卖点（与过期支持等负面卖点相反）往往是**更高的开发人员效率**，这很难衡量。与此相反，正如您所指出的，必须考虑再培训的成本，不仅是针对初始开发人员，而且至关重要的是，对于维护。在每次升级中，一些应用程序往往会因为过于关键而无法退役，而且过于昂贵/脆弱而无法升级。随着时间的推移，您必须支持的平台和版本的**数量**会增加总体技术债务（无论其年龄如何）。

升级到新版本的另一个标准（您注意到）是**吸引和留住员工**的能力。在当前的经济阶段，这是次要的，但仍然不能完全忽视。您希望至少拥有一批热情且知识渊博的开发人员。

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2009-05-05T11:19:10.977

我认为关键问题是如果您从不升级平台/语言版本，您的应用程序是否会长期存在。如果你觉得不行，不如趁早升级，只会越来越难。

想想在需要完全重写之前，您的应用程序应该积极开发多长时间。如果你从不打算重写它，我会不断升级。考虑一下，如果您使用的是过时的技术，那么找到最好的开发人员将变得多么困难。考虑一下新的框架/语言功能如何在长期内加速您的开发过程，但会带来一些短期的痛苦。

* * *

## 回答 #4

> 赞同：2
> 
> 时间：2009-05-05T14:29:02.783

当你真的需要。.NET 1.0 很糟糕，1.1 是一个不错的升级，但是使用 VS2003 进行 Web 开发并不是那么顺利。VS2005 和 .NET 2.0 改善了情况——我看到仍然有许多开发人员和公司坚持使用 .NET 2.0。以前的版本非常新鲜，2.0 版是成熟的技术。那么，如果您对 1.1 感到满意，您为什么要升级呢？如果您现在对 2.0 感到满意，为什么要升级到 3.5 或 4.0？

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2009-05-05T11:02:15.027

当升级的好处（更多功能或您需要的错误修复）超过所涉及的风险/成本（新问题、破坏现有代码）时。

* * *

## 回答 #6

> 赞同：1
> 
> 时间：2009-05-05T13:48:23.410

当您为基于 Microsoft 的平台（如适用于 Windows 的 Windows Forms 应用程序或适用于 Windows Server 的 ASP.NET Web 应用程序）进行开发时，迁移的最佳时机是每两个主要版本的操作系统。例如，如果您的应用程序是为 Windows 2000 开发的，你应该迁移到Vista，虽然XP可以忽略。同样，如果它是为 XP SP2 设计的，您可以放心地忽略 Vista 并以 Win 7 为目标。通常微软从不中断（或很少中断）增量操作系统更新。因此，在今天的操作系统上运行的应用程序肯定会在下一个操作系统上运行。但从来没有在它后面的那个上。（如果跑了M$怎么能赚钱？？？）

资料来源：Self... Windows 开发人员超过 5 年）

* * *

## 回答 #7

> 赞同：1
> 
> 时间：2018-01-20T11:46:31.527

我正在尽快升级阵营（尽管我可能会在新版本发布后等待一个月，以防万一出现未解决的问题）。您需要考虑以下几点：

**1\. 安全发布**

许多告诉我它是否没有损坏并没有修复它的人，也是那些在发布安全补丁时会闭上两只眼睛的人。想想Equifax。

对我来说，至少在一个框架的安全支持版本上是一种道德责任。我们有责任保护客户的数据。

**2\. 吸引和留住人才**

有很多关于所使用的编程语言或框架如何无关紧要的讨论。但根据我的经验，最简洁的 Web 应用程序代码和设计通常是由对所使用的框架和编程语言充满热情的人编写的，因为他们拥有丰富的经验和专业知识。

如果您坚持使用非常旧的版本，这些人不太可能长期留在您的公司或加入您的公司。请考虑一下您的开发人员的幸福。

**3\. 新版本提供的更新、更简单的方法**

很多时候，较新版本的框架会使过去的困难变得容易得多。如果我们不升级，我们就会错过好的新包/功能，并且我们以旧的令人沮丧的方式编写代码，因为我们知道有一种更简单的方法可以实现相同的功能。当需要升级时，我们可能最终不得不再次改变新的方式。那么为什么不升级并使用新的更好的方式并浪费更少的时间呢？

# algorithm - 给定从 1 到 2^32-1 的数字，缺少一个。如何最佳地找到丢失的数字？

> ID：824373
> 
> 赞同：11
> 
> 时间：2009-05-05T11:01:49.177
> 
> 标签：algorithm

您将获得 2^32-2 个唯一数字，范围从 1 到 2^32-1。不可能将所有数字都放入内存（因此排序不是一种选择）。您被要求找到丢失的号码。解决这个问题的最佳方法是什么？

* * *

假设您不能使用大整数并且仅限于 32 位整数。

`int`s 通过标准输入传入。

* * *

## 回答 #1

> 赞同：32
> 
> 时间：2009-05-05T11:13:02.973

*主要编辑：*相信我会让事情变得比他们必须的要困难得多。

### 异或所有。

我在这里假设数字是 1 到 2 ^(32) - 1 （*含*）。这应该使用 1 个额外的 32 位内存位置。

*编辑：*我以为我可以摆脱魔法。呃，好吧。

## 解释：

对于那些知道汉明码如何工作的人来说，这是同样的想法。

基本上，对于从 0 到 2 ^n - 1 的所有数字，该数字的每个位位置正好有 2 ^((n - 1) 个1。)因此，对所有这些数字进行异或运算实际上应该给出 0。但是，由于缺少一个数字，因此该特定列将给出 1，因为在该位位置有奇数个 1。

*注意：*虽然我个人更喜欢使用 ** 运算符进行求幂，但我已将其更改为 ^，因为这是 OP 使用的。不要将 ^ 与 xor 混淆。

* * *

## 回答 #2

> 赞同：12
> 
> 时间：2009-05-05T11:06:40.973

使用您最喜欢的大整数库添加您放弃的所有数字，然后从 1 到 2^32-1 的所有数字的总和中减去该总数，该总和是从[算术级数公式的总和获得的](http://en.wikipedia.org/wiki/Arithmetic_progression)

* * *

## 回答 #3

> 赞同：4
> 
> 时间：2009-05-05T11:22:23.450

使用按位运算符 XOR。以下是 JavaScript 中的示例：

```
var numbers = [6, 2, 4, 5, 7, 1]; //2^3 exclude one, starting from 1
var result = 0;

//xor all values in numbers
for (var i = 0, l = numbers.length; i < l; i++) {
    result ^= numbers[i]; 
}

console.log(result); //3

numbers[0] = 3; //replace 6 with 3
//same as above in functional style
result = numbers.reduce(function (previousValue, currentValue, index, array) {return currentValue ^= previousValue;});

console.log(result); //6 
```

在 C# 中也是如此：

```
int[] numbers = {3, 2, 4, 5, 7, 1};

int missing = numbers.Aggregate((result, next) => result ^ next);

Console.WriteLine(missing); 
```

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2009-05-05T11:07:19.147

假设您可以获得 Size() ，您可以使用一些二进制方法。选择一组数字 n 其中 n< 2^32 -2 / 2。然后得到一个计数。丢失的一方应报告较低的计数。反复执行该过程，然后您将得到答案

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2019-01-12T17:11:17.600

# iphone - iPhone 无法取消选择 UITableViewCell

> ID：824375
> 
> 赞同：1
> 
> 时间：2009-05-05T11:03:06.303
> 
> 标签：iphone, objective-c, macos

我有一个继承自 UITableViewController 的 RootViewController 类。当用户取消选择单元格时，我想启用/禁用工具栏上的某些按钮。

如何捕获取消选择事件？

```
-(void)tableView:(UITableView *)tableView deselectRowAtIndexPath:(NSIndexPath *)indexPath animated:(BOOL)animated
{
    if(indexPath.row <= rowNumber)
    {
        [viewButtton setEnabled:NO];
        [editButtton setEnabled:NO];
    }
} 
```

我尝试使用这种方法，但它似乎根本没有执行。任何想法如何做到这一点？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-05-05T14:12:44.617

我不认为有一个 deselectRowAtIndexPath 事件，有一个方法可以调用来取消选择 indexPath，但是查看 SDK 我在 UITableViewDelegate 中没有看到这个事件：http: [//developer.apple.com/ iPhone/library/documentation/UIKit/Reference/UITableViewDelegate_Protocol/Reference/Reference.html](http://developer.apple.com/iPhone/library/documentation/UIKit/Reference/UITableViewDelegate_Protocol/Reference/Reference.html)。

您可以在 didSelectRowAtIndexPath: 事件期间启用/禁用工具栏上的某些按钮吗？

-罗格

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-05-05T15:14:21.410

这仅在当前的 beta SDK 中，这意味着它可能有错误/更改/不受支持...

我确实注意到您的方法声明与 SDK 不匹配（至少，我拥有的版本）。

尝试删除`animated:(BOOL)animated`；我认为它不适用于这里。

请参阅第 ~345 行`UITableView.h`，和/或右键单击`didDeselectRowAtIndexPath`并“跳转到定义”，您可能会在其中找到应如何定义委托方法。

也就是说，如果您的目标只是“在选择单元格时启用/禁用某些按钮”，

```
- (NSIndexPath *)tableView:(UITableView *)tableView willSelectRowAtIndexPath:(NSIndexPath *)indexPath; 
```

应该可以正常工作。这将在他们选择单元格之后和取消选择之前发生。“取消选择”对动画的作用比用户交互更多。我认为您想要使用取消选择的唯一原因可能是确保您的事件仅在选择单元格不再突出显示后才发生的美学价值。

# java - 如何路由到最近的 RMI 服务器？

> ID：824379
> 
> 赞同：1
> 
> 时间：2009-05-05T11:04:14.303
> 
> 标签：java, database, replication, client-server, rmi

继续我的问题[如何提高客户端服务器架构应用程序的性能](https://stackoverflow.com/questions/792807/how-to-improve-the-performance-of-client-server-architecture-application)

我决定维护一个集中式数据库和几个从服务器-数据库配置。我计划使用[Symmetric DS](http://symmetricds.codehaus.org/)在从属数据库和主数据库之间进行复制。每个服务器-数据库配置都将安装在离客户端更近的位置。理想情况下，出于显而易见的原因，我希望来自客户端的请求路由到最近的从服务器数据库。由于我使用 RMI 连接到服务器，我想知道当前是否有任何产品/API 可用，这可以解决这个问题？

除上述解决方案之外的任何其他解决方案都受到高度重视:)

注意：重构客户端代码绝对是一种选择，但由于应用程序非常庞大，它存在巨大的风险（可能会破坏现有代码）、耗时且昂贵。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-05-05T11:40:26.917

看看分布式和一致性哈希：

[http://en.wikipedia.org/wiki/Distributed_hash_table#Keyspace_partitioning](http://en.wikipedia.org/wiki/Distributed_hash_table#Keyspace_partitioning) [http://en.wikipedia.org/wiki/Consistent_hashing](http://en.wikipedia.org/wiki/Consistent_hashing)

准系统，您将设置一致散列的变体，该变体将采用客户端的标识符（代替“密钥”）并定位最近的服务器。这里的额外好处是，如果其中一个从属服务器出现故障，您的基础设施将透明地路由到下一个最近的服务器。

# html - 如何在 Internet Explorer 中更改选定的文本颜色？

> ID：824383
> 
> 赞同：5
> 
> 时间：2009-05-05T11:05:21.227
> 
> 标签：html, css, internet-explorer

我在许多博客中看到，当我们选择文本时，文本的背景颜色会发生变化，而不是通常的蓝色。[该技术](http://www.quirksmode.org/css/selection.html) 适用于 Firefox 和 Safari，是否有任何方法可用于 Internet Explorer？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-05-05T19:54:48.990

它不能在 IE 中使用纯 CSS 完成，而且我也不知道有任何预打包的 JS 可以完成这项工作。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2014-05-24T05:17:18.580

这？

```
<style>
::selection {color:red;background:yellow;}
::-moz-selection {color:red;background:yellow;}
</style> 
```

[http://www.w3schools.com/cssref/tryit.asp?filename=trycss3_selection](http://www.w3schools.com/cssref/tryit.asp?filename=trycss3_selection)

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-06-01T07:37:20.507

据我所知，IE 不支持。除非有一些我不知道的聪明的黑客。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2009-06-01T23:53:55.540

我认为很难模仿

*   您可以尝试为所选文本设置背景颜色，但默认的蓝色突出显示可能会破坏您的效果
*   当有人选择大量文本并快速更改其选择时，浏览器可能会在某些系统上阻塞。

我认为你应该为支持它的浏览器使用 CSS，并耐心等待 IE 采用它。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2012-11-09T19:33:11.117

你可以随时删除它。

```
 if (window.getSelection) {
          if (window.getSelection().empty) {  // Chrome
            window.getSelection().empty();
          } else if (window.getSelection().removeAllRanges) {  // Firefox
            window.getSelection().removeAllRanges();
          }
        } else if (document.selection) {  // IE?
          document.selection.empty();
        } 

```

# mysql - 将mysql存储过程转换为mssql

> ID：824384
> 
> 赞同：0
> 
> 时间：2009-05-05T11:05:31.460
> 
> 标签：mysql, sql-server, dynamic, sql-order-by

我需要在 mysql 中使用动态订单查询，我已经通过 mysql 中的字符串连接成功地实现了这一点，如下所示：

set @stmt_text := **concat** ('select * from abc order by ', **sorder** );

从@stmt_text 准备stmt_handle；

执行stmt_handle；

解除分配准备stmt_handle；

我需要一种类似的方法来在 mssql 中转换它

有任何想法吗？？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-05-05T11:10:20.840

是的，只需像这样运行它：

```
execute ('select * from abc order by ' + @sorder); 
```

但是不要忘记，如果您通过用户输入获得它，则需要验证 sorder 变量（以停止 sql-injections）

# javascript - 如何轻松地同时使用 Ajax、perl 和 JSON？

> ID：824385
> 
> 赞同：4
> 
> 时间：2009-05-05T11:05:44.923
> 
> 标签：javascript, html, ajax, perl, json

我正在尝试使用 Ajax 制作网页。

例子：

1.  我创建了一个触发简单帖子的 Perl/CGU 文件；

    文件：..test.cgi?name=Thomas

    回短信：你的名字是托马斯！

2.  我创建了一个可以使用帖子的 html 文件，但是页面必须重新加载。我使用文本输入和按钮。

如何轻松地同时使用 Ajax、Perl 和 JSON？这就是它应该如何协同工作，但是如何？

Html + Ajax/JavaScript CALL Perl + "JSON-perl-string" RETURN-TO Ajax CONVERT-JSON -> Html

* * *

## 回答 #1

> 赞同：12
> 
> 时间：2009-05-05T11:43:32.523

对于 JSON，请尝试[CPAN JSON 模块](http://search.cpan.org/~makamaka/JSON-2.14/lib/JSON.pm)。

对于使用 XMLHttpRequest，我推荐这些来自 IBM 的精彩教程。

[精通 Ajax，第 1 部分：Ajax 简介](http://www.ibm.com/developerworks/web/library/wa-ajaxintro1.html?S_TACT=105AGX08&S_CMP=EDU)

您可能最感兴趣的两篇文章是这两篇：

[精通 Ajax，第 10 部分：使用 JSON 进行数据传输](http://www.ibm.com/developerworks/web/library/wa-ajaxintro10/index.html?S_TACT=105AGX08&S_CMP=EDU)

[精通 Ajax，第 11 部分：服务器端的 JSON](http://www.ibm.com/developerworks/web/library/wa-ajaxintro11.html?S_TACT=105AGX08&S_CMP=EDU)

[您可以使用此搜索链接](http://www.ibm.com/developerworks/views/web/libraryview.jsp?search_by=Mastering+Ajax)获取整个 11 Part 系列。

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2009-05-05T11:56:02.290

您只需要让您的应用程序返回 JSON（您可以为此使用 CPAN 上的[JSON模块）而不是 HTML。](http://search.cpan.org/perldoc?JSON)这意味着您需要 application/json 的 Content-type 标头而不是 text/html，然后您需要在 Javascript 中使用该 JSON（使用 jQuery 或 Prototype 之类的 Javascript 库是您最好的选择）。

* * *

## 回答 #3

> 赞同：3
> 
> 时间：2009-05-06T01:58:22.953

jquery 通过其 API 提供了非常简单的 ajax 和 JSON 支持，它为您处理所有 XMLHttpRequest 对象。[jQuery](http://jquery.com/)

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2009-05-05T11:34:48.160

如果您的主要目标是避免刷新以更新页面，您可以尝试使用 XML 中的 XMLHttpRequest 对象编写远程脚本。

更多关于这个[here](http://www.mousewhisperer.co.uk/ajax_page.html)。

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2013-04-29T20:32:58.950

试试新的 CPAN 模块[Yote](http://madyote.com)。它通过 JSON rpc 将 javascript 对象绑定到 perl。

这是客户端上的一个示例：

**服务器**

```
package Hello;
use base 'Yote::AppRoot';

sub hello {
  return "Hello World";

1; 
```

**客户**

```
$.yote.init();
var hello_app = $.yote.fetch_app('Hello');

alert( hello_app.hello() );
   // outputs "Hello World" 
```

# c# - 如何在 c# 中使用 SharpSVN 库设置 SVN 提交的作者

> ID：824386
> 
> 赞同：3
> 
> 时间：2009-05-05T11:05:49.667
> 
> 标签：c#, svn, sharpsvn

我使用来自 CollabNET 的 SharpSvn 库。我想在提交时设置修订作者，但我总是以我的 Windows 用户名提交。

这对我不起作用：

```
System.Net.NetworkCredential oCred = new
    System.Net.NetworkCredential("user"​, "pass");
client.Authentication.DefaultCredentials = oCred; 
```

我也试过：

```
client.SetProperty("", "svn:author", "user"); 
```

但我得到一个错误，即目标（第一个参数）不好。

那么你能告诉我如何在c#中设置提交到颠覆存储库的用户（作者）吗？

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2009-05-05T13:32:48.097

这一切都取决于您如何连接到存储库，因为存储库负责将用户名添加到修订版。（它通常会复制连接的凭据，但不必这样做）。

当您使用 file:/// 存储库（通常不推荐使用 - 请参阅[The Subversion Book](http://svnbook.red-bean.com/)）时，您可以直接在提交时解决此问题。

```
using (SvnClient client = new SvnClient())
{
    client.Authentication.Clear(); // Clear predefined handlers

    // Install a custom username handler
    client.Authentication.UserNameHandlers +=
        delegate(object sender, SvnUserNameEventArgs e)
        {
            e.UserName = "MyName";
        };

    SvnCommitArgs ca = new SvnCommitArgs { LogMessage = "Hello" }
    client.Commit(dir, ca);
} 
```

如果您连接到远程存储库，则可以在存储库中安装 pre-revprop-change 挂钩时更改修订的作者（请参阅[The Subversion Book](http://svnbook.red-bean.com/)）

```
using (SvnClient client = new SvnClient())
{
    client.SetRevisionProperty(new Uri("http://my/repository"), 12345,
                              SvnPropertyNames.SvnAuthor,
                              "MyName");

    // Older SharpSvn releases allowed only the now obsolete syntax
    client.SetRevisionProperty(
        new SvnUriTarget(new Uri("http://my/repository"), 12345),
        SvnPropertyNames.SvnAuthor,
        "MyName");

} 
```

[2009-08-14] 最近的 SharpSvn 版本也允许这样做：

```
using (SvnRepositoryClient rc = new SvnRepositoryClient())
{
   SvnSetRevisionPropertyRepositoryArgs ra;
   ra.CallPreRevPropChangeHook = false;
   ra.CallPostRevPropChangeHook = false;
   rc.SetRevisionProperty(@"C:\Path\To\Repository", 12345,
                         SvnPropertyNames.SvnAuthor, "MyName", ra);
} 
```

最后一个示例假设直接文件访问存储库，但它绕过存储库挂钩以获得最佳性能。

# mobile - 从手机连接到数码相机？

> ID：824401
> 
> 赞同：0
> 
> 时间：2009-05-05T11:10:08.033
> 
> 标签：mobile

一位客户（摄影师）问我，是否可以为手机编写某种软件，以便他可以将其物理连接到他的专业数码相机（佳能或尼康）并将照片（或子集）传输到手机。

我试图从一开始就不对手机平台（Symbian、Windows Mobile 等）施加限制，所以我故意将这种限制排除在外。

有人可以给我一些提示吗？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-05-05T11:13:27.200

***您需要在相机和手机之间建立连接：***

*   某些 Windows 移动设备具有**USB-Host-Function**，因此您可以通过 USB 电缆连接读卡器或相机本身并从设备中读取文件。我从未听说过支持 USB 主机的 symbian 设备，但可能有一些。

*   如果相机支持**蓝牙或红外**，您可以使用这些协议来传输文件，因为大多数手机都支持这一点。

如果您有连接（以及您的平台的协议支持），则可以轻松编写一个应用程序将文件从设备传输到您的手机。您可以使用任何支持的语言（java for j2me、python (symbian)、.net (windows mobile)）编写此应用程序

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-05-05T11:45:39.197

我的数码相机将照片保存到存储卡中。我可以简单地将存储卡从相机中取出，插入我的 Windows Mobile 手机，然后在手机上查看照片。

# iphone - iPhone GPS 性能

> ID：824403
> 
> 赞同：3
> 
> 时间：2009-05-05T11:10:21.903
> 
> 标签：iphone, gps

我正在编写一个依赖于获取设备位置的 iPhone 应用程序。管理层要求我生成有关 GPS 在城市（高层建筑）和建筑物内的表现的数据。

是否有任何开发人员有关于 GPS 可靠性和回退到蜂窝/wifi 塔三角测量的数据？

管理友好的信息最好，但我可以翻译的原始数据也很好。

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2009-05-05T11:18:17.187

为了确定物体的位置，GPS 系统必须从至少三颗卫星接收无线电信号。

> GPS 精度受多种因素影响，包括卫星位置、无线电信号中的噪声、大气条件和信号的天然障碍。噪声可能会在 1 到 10 米范围内产生误差，并且是由接收器附近的物体或相同频率的物体产生的静电或干扰造成的。云和其他大气现象，以及卫星和接收器之间的山脉或建筑物等物体也会产生误差，有时可达 30 米。

从[这里](http://findarticles.com/p/articles/mi_m0BPW/is_8_19/ai_n28069237/)：

> 城市峡谷的多径和掩蔽效应会降低 GPS 测距的准确性，并增加在密集城市地区运行的接收器的几何精度衰减。在为车辆设计的 GPS 应用中，这些现象对精度的影响可以降低，这要归功于有助于平均多路径的用户速度以及地图匹配的使用。但行人并不能从相同的环境中受益，而且在人口密集的城市地区，基于 GPS 的行人定位精度和完整性不足。在市中心地区对各种带有集成 GPS 接收器的大众市场终端进行的测试表明，在 50 到 100 米之间的圆形误差概率 (CEP) 性能为 95%。

维基文章：[全球定位系统](http://en.wikipedia.org/wiki/Global_Positioning_System)

# fiddler - 如何禁用提琴手

> ID：824409
> 
> 赞同：14
> 
> 时间：2009-05-05T11:12:46.640
> 
> 标签：fiddler

我知道这将是一个更少的编程问题，但仍然......

我怎样才能完全禁用提琴手。我转到选项->连接并取消选中所有复选框，禁用文件->捕获流量，转到 IE 并禁用 Fiddler 插件，转到连接并删除所有代理，仍然是我的所有页面（在 IE 和 chrome 上，FF 很好）去通过提琴手。如果 Fiddler 不会破坏那么多，一切都会好的，尤其是在发送大量文件时。当我尝试完全卸载提琴手时，所有页面都完全停止工作

那么如何在 IE 中禁用 Fiddler 或在整个系统中更好。

这已经让我发疯了几个星期:(

* * *

## 回答 #1

> 赞同：15
> 
> 时间：2009-05-05T12:19:20.830

我尽量不发布我自己问题的答案。但我决定这次去做。经过两周的努力，今天我把所有的注意力都放在了这个问题上。

似乎在 VPN 中设置了代理。我不知道您可以将代理设置为 VPN 连接。在网络设置中转到您的 VPN 连接，然后在那里代理和禁用 Fiddler

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2009-05-05T11:24:34.770

我不知道 Fiddler 可以自行运行，而无需您启动它。在我看来，如果你没有看到 Fiddler，那么它就不存在。

这可能就是为什么它让你疯狂地试图禁用它——它不存在。

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2010-08-27T12:04:54.963

您可以完全卸载 fiddler，但您必须进入 fiddler 文件夹本身（默认为 \Program Files\Fiddler2），其中会找到 uninst.exe。这将完全删除它。否则，您可以从 Firefox 的附加组件菜单中禁用它。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2012-05-24T09:33:33.787

我发现您需要在 Internet Explorer 设置中禁用该插件。

Internet 属性 -> 程序 -> 管理加载项

# java - mysql驱动jar不被识别

> ID：824415
> 
> 赞同：0
> 
> 时间：2009-05-05T11:15:02.763
> 
> 标签：java, mysql, jdbc, driver

我在 jar 文件中有一个令牌类文件。令牌类文件是使用 jdbc 从数据库中检索数据的类。但是，当我调用 jar 文件时，它似乎无法识别外部 mysql 驱动程序 jar 文件。

错误指向这一行 Class.forName(driver);。

我已经在 ant 构建文件和我能想到的每个类路径中引用了 mysql 驱动程序。

```
 <mkdir dir="build/server/dist"/>
    <jar destfile="build/server/dist/VNCOverHTTPServer.jar" basedir="build/server/classes">
        <manifest>
            <attribute name="Main-Class" value="jhttpserver.JHttpServer"/>
            <attribute name="Class-path" value="lib/servlet.jar lib/mysql-connector-java-5.1.7-bin.jar config/"/>
        </manifest>
    </jar> 
```

没有任何工作？任何帮助，将不胜感激。

谢谢

java.lang.ClassNotFoundException：java.net.URLClassLoader.findClass(URLClassLoader.java:188) 的 java.security.AccessController.doPrivileged(Native Method) 的 java.net.URLClassLoader$1.run(URLClassLoader.java:200) 的 mysql在 java.lang.ClassLoader.loadClass(ClassLoader.java:316) 在 sun.misc.Launcher$AppClassLoader.loadClass(Launcher.java:288) 在 java.lang.ClassLoader.loadClass(ClassLoader.java:251) 在 java。 lang.ClassLoader.loadClassInternal(ClassLoader.java:374) at java.lang.Class.forName0(Native Method) at java.lang.Class.forName(Class.java:169) at socksviahttp.server.token.getConnection(token. java:58) 在 socksviahttp.server.token.exists(token.java:75) 在 socksviahttp.server.ServletSocks.doPost(ServletSocks.java:328) 在 javax.servlet.http.HttpServlet.service(HttpServlet.java:760 ) 在 javax.servlet.http.HttpServlet.service(HttpServlet.java:853) 在 jhttpserver.JHttpServerThread.run(JHttpServerThread.java:217)

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-05-05T12:16:29.933

注册 mysql 驱动程序的行大致如下：

```
Class.forname("com.mysql.jdbc.Driver"); 
```

类加载器错误似乎是针对一个朴素的“mysql”类，而不是包引用的类。通常只有在动态加载类而不指定完整的类名时才会看到此错误。

你用什么来加载mysql驱动类？如果它是一个弹簧配置文件，那么您可能在配置文件中没有完整的类名。

我刚刚注意到小写的“类路径”。它应该是“类路径”

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-05-05T11:31:00.510

当您运行 jar 文件时，可以通过双击它或从命令行运行）：

```
java -jar VNCOverHTTPServer.jar 
```

然后在您的 jar 所在的目录中，应该有一个包含所需 jar 的 lib 文件夹。是这样吗？

**更新：**从您的错误报告中可以明显看出您正在使用 URLClassLoader 加载 mysql 类。在类路径中添加 jar 文件无济于事，您需要通过 URL 链接使该类可用。

# c# - 使用智能手机上的 RIL Audio 进行音频反馈

> ID：824416
> 
> 赞同：1
> 
> 时间：2009-05-05T11:15:10.033
> 
> 标签：c#, audio, sip, feedback, ril

我们正在开发 SIP 软电话，当我们从一部电话呼叫另一部电话时，我们会收到音频反馈。但是，当我们从普通的 SIP 电话（软件或硬件）呼叫我们的应用程序时，一切正常 - 只有当使用该应用程序从一部电话呼叫另一部电话时。下面是我们用来初始化 RIL Audio 的代码：

```
 public static void InitRILAudio()
    {
        IntPtr res;
        RILRESULTCALLBACK result = new RILRESULTCALLBACK(f_result);
        RILNOTIFYCALLBACK notify = new RILNOTIFYCALLBACK(f_notify);

        res = RIL_Initialize(1, result, notify, (0x00010000 | 0x00020000 | 0x00080000), 0, out hRil);

        if (res != IntPtr.Zero)
            return;

        RILAUDIODEVICEINFO audioDeviceInfo = new RILAUDIODEVICEINFO();
        audioDeviceInfo.cbSize = 16;
        audioDeviceInfo.dwParams = 0x00000003;      //RIL_PARAM_ADI_ALL;
        audioDeviceInfo.dwRxDevice = 0x00000001;    //RIL_AUDIO_HANDSET;
        audioDeviceInfo.dwTxDevice = 0x00000001;    //RIL_AUDIO_HANDSET;

        res = RIL_SetAudioDevices(hRil, audioDeviceInfo);
    } 
```

我们将 SipEk ( [http://voipengine.googlepages.com/sipeksdk](http://voipengine.googlepages.com/sipeksdk) ) 用于 SIP 堆栈。基本上我们只是使用来自 SDK 的回调委托来处理音频内容。有没有其他人遇到过这样的音频反馈循环问题？使用 RIL Audio 还是 SipEk？有什么建议么？

提前致谢！

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-05-13T14:29:10.197

反馈意味着您没有使用回声消除（线路和/或声学，取决于它是否用作免提电话），或者如果您使用了，则表示您的系统延迟（抖动缓冲区、网络、编码/解码等） ) 大于回声消除器的处理能力。错误位置的过度增益/削波也会破坏任何回声消除器（它们不喜欢非线性效果）。

听起来您只是将音频转储到其他层。SipEk 只是 pjsip 的包装器，但我假设您是通过 Microsoft RIL/etc 而不是通过 pjmedia 来做音频的。你需要对你的音频路径有一个很好的理解——东西在哪里被采样，是否/如何消除声学/线路回声，回声尾是什么，如何编码和打包，如何接收，抖动缓冲，丢失- 隐藏、解码和回放。

# c# - 如何将数据绑定到 ASP.NET 3.5 中的通用列表？

> ID：824419
> 
> 赞同：0
> 
> 时间：2009-05-05T11:15:44.057
> 
> 标签：c#, asp.net

我想将我的 ListView 控件绑定到一个通用的对象列表？

我以为我可以编码：

> listView1.DataSource = fCol.ToList; listView1.DataBind();

我得到一个无法转换为对象的错误。

我确定在 Windows 编程中您使用 BindingSource 对象。是否有等效的网络表单？

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2009-05-05T11:30:05.833

您缺少 ToList() 调用末尾的括号。

# .net - 如何为我的 .net 应用程序提供辅助位置以查找依赖程序集？

> ID：824427
> 
> 赞同：2
> 
> 时间：2009-05-05T11:18:18.467
> 
> 标签：.net

我确信这是在另一个问题的某个地方提出的，但那里使用的措辞显然不够通用，不容易找到。

如何告诉我的 Windows 窗体应用程序它可以找到运行时可能需要的程序集的辅助位置？我不是在谈论使用反射来发现插件，而是已经编译到程序集中但可能位于子目录中而不是与调用程序集并排的依赖项。

* * *

## 回答 #1

> 赞同：9
> 
> 时间：2009-05-05T11:22:01.267

您可以通过应用程序配置文件执行此操作：`assemblyBinding`元素，更准确地说 - `probing`：

```
<configuration>
   <runtime>
      <assemblyBinding xmlns="urn:schemas-microsoft-com:asm.v1">
         <probing privatePath="bin;bin2\subbin;bin3"/>
      </assemblyBinding>
   </runtime>
</configuration> 
```

这将强制运行时在 、 和 目录中查找程序集`bin`，所有`bin2`这些都是应用程序基目录的子目录。`bin2\subbin``bin3`

# mysql - 打开的数据库连接数

> ID：824428
> 
> 赞同：12
> 
> 时间：2009-05-05T11:18:23.163
> 
> 标签：mysql

谁能知道在 MYSQL 5.0 中获取正在使用的数据库连接数的方法

* * *

## 回答 #1

> 赞同：24
> 
> 时间：2009-05-05T11:22:16.430

```
SHOW STATUS WHERE variable_name = 'Threads_connected' 
```

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2009-05-05T11:23:48.483

[12.5.5.31。显示 PROCESSLIST 语法](http://dev.mysql.com/doc/refman/5.1/en/show-processlist.html)

显示有多少人连接到服务器。

* * *

## 回答 #3

> 赞同：3
> 
> 时间：2015-08-27T09:45:44.417

```
Number of open connections can be found out by using below query:
   mysql -e 'SHOW STATUS WHERE variable_name LIKE "Threads_%" OR variable_name = "Connections"'

   +-------------------+-------+
   | Variable_name     | Value |
   +-------------------+-------+
   | Connections       | 862   |
   | Threads_cached    | 0     |
   | Threads_connected | 10    |
   | Threads_created   | 26    |
   | Threads_running   | 1     |
   +-------------------+-------+ 
```

# xml - 从没有 XSL 的 ASP 查询 xml

> ID：824430
> 
> 赞同：1
> 
> 时间：2009-05-05T11:19:03.473
> 
> 标签：xml, asp-classic

我有一些非常简单的 XML：

```
<properties>
<property>
    <name>BobFish</name>
    <explaination>Bob is a fish.</explaination>
</property>
<property>
    <name>DaveFish</name>
    <explaination>Dave is a fish.</explaination>
</property> 
```

我想查询是否来自 ASP。就像是：

```
Response.Write (GetExplaination("BobFish")) 
```

这是我到目前为止的功能：

```
Function GetExplaination(strXMLFile, strName)

 'Declare local variables
 Dim objXML
 Dim objNode

 set objXML = Server.CreateObject("Microsoft.XMLDOM")
 objXML.load(strXMLFile)
 Set objNode = objXML.SelectSingleNode("properties/property[name='" & strName & "']")

    GetExplaination = "Nothing Yet"

End Function 
```

所以我有 objNode 包含我需要的数据。如何从中提取“说明”字段？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-05-05T11:25:04.427

首先将路径添加到您的解释节点以获取它，而不是整个属性节点。

```
Set objNode = objXML.SelectSingleNode("properties/property[name='" & strName & "']/explanation") 
```

接下来返回节点的内部文本以获取您之后的文本

```
GetExplaination = objNode.Text 
```

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2009-05-05T11:28:14.323

```
Function GetExplaination(strXMLFile, strName)
  Dim objXML
  Dim objNode
  Dim strXPath

  Set objXML = CreateObject("Microsoft.XMLDOM")
  objXML.load(strXMLFile)

  ''// enclose in single- or double quotes accordingly
  If InStr(strName, "'") > 0 And InStr(strName, """") = 0 Then
    strName = """" & strName & """"
  ElseIf InStr(strName, "'") = 0 And InStr(strName, """") > 0 Then
    strName = "'" & strName & "'"
  Else
    ''// both single and double quotes in a string are unsupported
    strName = "''"  
  End If

  strXPath = "/properties/property[name = " & strName & "]/explaination"
  Set objNode = objXML.SelectSingleNode(strXPath)

  If Not objNode Is Nothing Then
    GetExplaination = objNode.Text
  End If    
End Function 
```

...

```
Response.Write GetExplaination("Fish.xml", "DaveFish") 
```

我不建议您每次查找单个属性时都加载文档。预先加载和解析文档，并将文档引用传递给函数而不是文件路径。

# jquery - 在 javascript 函数中使用 $.post，不能为变量赋值？

> ID：824431
> 
> 赞同：1
> 
> 时间：2009-05-05T11:19:04.550
> 
> 标签：jquery, post, variables, global

我试图在函数中使用 $.post，获取结果，然后根据 $.post 回调的结果返回函数 true 或 false。但是，回调似乎发生在父函数的返回事件之后。

这是 ret 变量始终未定义的当前代码，但如果我在 $.post 回调中警告（）它，它会返回正确的结果；

```
function elementExists(key, type, path, appid, pid){
    var ret;
    $.post('?do=elExists', {key: key, type: type, path: path, appid: appid, pid: pid},function(data){
        ret = data;                         
    });

    alert(ret);
    return ret;

} 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-05-05T11:23:44.617

正如您发现的那样，帖子是异步完成的。如果您希望它是同步的，则需要使用该[`ajax`](http://docs.jquery.com/Ajax/jQuery.ajax#options)方法并将`async`参数设置为 false。但是，最好承认 post 是异步的并构建您的代码，以便回调执行的操作独立于调用 post 的方法。显然，您确实想做除警报之外的其他事情，但在不知道什么情况下很难建议您如何重构它。

**编辑**：我知道您的代码正在检查是否存在某些东西，但它是出于某种目的而检查的。如果我们知道目的是什么，那么可能会建议如何在回调中完成它，以便可以重构方法。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-05-05T11:21:07.477

```
function elementExists(key, type, path, appid, pid){
        $.post('?do=elExists', {key: key, type: type, path: path, appid: appid, pid: pid},function(data){
           alert(data);
        });
  } 
```

函数（数据）是一个回调（异步），你不能返回这样的值。

在调用页面完成之前不会调用回调，但是在调用 $.post 后会立即执行“return ret”

如果你想设置它 syncronous set async : false

请参阅文档 [http://docs.jquery.com/Ajax/jQuery.post#urldatacallbacktype](http://docs.jquery.com/Ajax/jQuery.post#urldatacallbacktype)

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-05-05T11:22:11.077

问题是您的代码异步执行。也就是说，alert(ret) 实际上是在 ret = data 之前调用的，这发生在 Ajax 请求完成时。

您可以使用[async](http://docs.jquery.com/Ajax/jQuery.ajax)选项使您的 ajax 调用同步（不推荐），或者重新设计您的代码。

# sharepoint - 用户配置文件导入 - 不仅仅是搜索库

> ID：824440
> 
> 赞同：1
> 
> 时间：2009-05-05T11:21:29.003
> 
> 标签：sharepoint

在 AD 中，我们有这两个 OU：

*   OU=帐户 - 标准用户
*   OU=帐户 - 受限用户

我们的用户配置文件导入连接中的搜索库包含以下内容：

*   OU=Accounts - 标准用户,DC=in,DC=company,DC=com

导入非常适合这个单一的 OU。

我尝试建立第二个连接，但 SharePoint 不允许多个连接到同一个域。

**如何配置导入/连接以从两个 OU 中提取？**

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-05-05T14:07:09.870

您可以将搜索基础上移到两个 OU 之上的级别，然后更改您的过滤器，使其仅提取设置了某些字段的用户 AD 对象。例如，此过滤器将获取所有用户对象，其中名字和姓氏字段都设置为：

```
(&(objectCategory=Person)(objectClass=user)(givenName=*)(sn=*)) 
```

# sql - 调试 MS SQL 存储过程

> ID：824447
> 
> 赞同：5
> 
> 时间：2009-05-05T11:23:17.813
> 
> 标签：sql, visual-studio, tsql, debugging, stored-procedures

我在 Visual Studio 2008 中让存储过程调试工作时遇到问题：当我开始调试时，我在输出窗口中收到这些成功消息，但是实际的存储过程窗口没有显示。

```
Auto-attach to process '[1640] [SQL] stagsql' on machine 'stagsql' succeeded.
The thread 'stagsql [67]' (0xf80) has exited with code 0 (0x0).
The thread 'stagsql [67]' (0xf80) has exited with code 0 (0x0).
The thread 'stagsql [69]' (0x908) has exited with code 0 (0x0).
The thread 'stagsql [69]' (0x908) has exited with code 0 (0x0).
The thread 'stagsql [69]' (0x908) has exited with code 0 (0x0).
The thread 'stagsql [69]' (0x908) has exited with code 0 (0x0).
Running [dbo].[uspCGetXYZ] ( @nLieferantId = 161616, @nStrukturId = -1, @nPageIndex = 1, @nPageSize = 16, @sSortColumn = arLangname, @nSortAscending = 1 ). 
```

Visual Studio 进入“调试模式”，但该过程根本不显示。

我做的步骤：

*   在项目设置中启用 SQL 调试
*   在服务器资源管理器中打开 SQL 连接
*   在连接上启用 CLR/SQL 调试
*   右键单击该过程并选择“步入存储过程”

或者我试图打开程序并在那里设置一个断点，它没有帮助。

有任何想法吗？如前所述，连接存在，但 Visual Studio 无法打开过程代码。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2010-09-17T17:31:50.787

无论如何，您是否选择了“**显示实际执行计划**”？我发现如果单击该按钮，调试将无法运行，尽管我一生都无法弄清楚为什么会出现这种情况。

我还没有提交关于 Connect 的错误，但如果有人知道它，我很乐意为它投票。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-05-05T12:19:11.223

该解决方案是数据库解决方案吗？你去新建->解决方案->其他->数据库吗？

创建数据库解决方案然后设置连接首选项后，您应该能够使用服务器资源管理器编辑并单步执行存储过程。请验证这仍然会导致问题吗？

~~你用的是速成版吗？~~

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-06-09T12:32:29.490

请参阅[使用 sql server 2005 的表调试过程](http://ysgitdiary.blogspot.com/2009/06/debugging-procedure-with-table-for-sql.html)。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2009-09-21T19:09:07.613

你能看到那个存储过程背后的代码吗？如果它保存为“WITH ENCRYPTION”，您可能无法看到代码，然后您将需要 proc 的原始源代码来调试它。

* * *

## 回答 #5

> 赞同：-1
> 
> 时间：2009-06-10T11:58:31.447

我不认为你可以像在普通的 VS 应用程序中那样在其中设置断点。

但是，您可以创建一个用于记录的临时表，并在每一行向该临时表中添加一个新条目。

# c# - 如何为 vs2003 链接 .NET 2.0 f/w 环境

> ID：824453
> 
> 赞同：0
> 
> 时间：2009-05-05T11:24:28.093
> 
> 标签：c#, .net, visual-studio

vs2003 在 1.1 框架下运行。现在安装 2.0 框架。现在我如何链接 .NET 2.0 库，以便 VS2003 具有 2.0 库的智能。我该怎么做？如果可以，我该怎么做

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-05-05T11:26:28.040

您将需要使用针对 .NET 2.0 开发的 Visual Studio 版本（即 VS 2005 或 VS 2008）。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-05-05T11:25:24.503

对不起，你不能那样做。VS2003 永远不会了解 .NET 2.0。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-05-05T11:26:06.903

不，这是不可能的。您不能在 .NET 1.x 应用程序中使用 .NET 2.0+ 程序集。

# python - wxPython中的应用程序停靠图标

> ID：824458
> 
> 赞同：1
> 
> 时间：2009-05-05T11:25:19.837
> 
> 标签：python, macos, wxpython

在 Mac OS X 上的 wxPython 中，可以在启动应用程序时显示自定义图标。现在，当我启动我编写的应用程序时，Dock 中会显示一个空白的白色图标。我将如何改变它？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-05-05T11:30:43.507

我在我的设置文件中有这个来添加一个图标：

```
from setuptools import setup

APP = ['MyApp.py']
DATA_FILES = []
OPTIONS = {'argv_emulation': True, 
    'iconfile': 'MyAppIcon.icns' }

setup(
    app=APP,
    data_files=DATA_FILES,
    options={'py2app': OPTIONS},
    setup_requires=['py2app'],
) 
```

我认为您必须使用 icns 文件。我使用[img2icns](http://www.img2icnsapp.com/)创建了一个。

# c# - 如何处理文件上传弹出窗口

> ID：824461
> 
> 赞同：0
> 
> 时间：2009-05-05T11:26:03.517
> 
> 标签：c#, watin

我正在使用 WatiN 测试工具 我有一个场景，我需要通过弹出窗口上传文件，我正在 c#.net 中编写脚本。当我点击一个单选按钮时，会出现一个弹出窗口，我需要上传文件并点击上传按钮。请给我一些解决方案。

感谢您

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-05-05T11:30:05.333

在这里询问和回答[Watin - 如何使用弹出页面测试网站](https://stackoverflow.com/questions/657250/watin-how-to-test-site-with-popup-pages)

# php - 从查询中增长链接列表

> ID：824466
> 
> 赞同：0
> 
> 时间：2009-05-05T11:27:24.827
> 
> 标签：php, sql, mysql, html

我有以下代码，它将从表中检索文件名并链接到它。我想要做的是拥有它，以便我稍后可以参考 $filesList，它将包含一个 html 代码块，其中包含指向与文件一样多的文件的链接。

我认为添加到前面的变量是最简单的方法，但它实际上输出了无意义的代码：`0test.sh"&gt;test.sh`

```
if ($getFiles = $con->prepare($filesQuery)) {
    $getFiles->bind_param("s", $pk);
    $getFiles->execute();
    $getFiles->bind_result($FILENAME);
    $files = array();

    while ($getFiles->fetch()) {
         $filename = array(
         'FILENAME' => $FILENAME,
          );
           $files[] = $filename;
        }
}
$filesList = '';
foreach ($files as $filenames)
    {

    $filesList = $filesList + '<p><a href="./files/'. $filenames['FILENAME'] .'">'. $filenames['FILENAME'] .'</a>' . "\n"; 
  }; 
```

Sureley 我不需要一个数组来做我想做的事吗？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-05-05T11:34:15.293

您需要将该代码更改为：

```
$filesList = '';
foreach ($files as $filenames)
{
    $filesList .= '<p><a href="./files/'. $filenames['FILENAME'] .'">'. $filenames['FILENAME'] ."</a></p>\n"; 
}; 
```

这有帮助吗？您不能与 连接`+`。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-05-05T11:35:09.580

我立即发现的一件事是您有 $filesList = $filesList + ... 使用点而不是 + 符号。

试试这个

```
`$filesList = $filesList . "<p><a href=\"./files/{$filenames['FILENAME']}\">{$filenames['FILENAME']}</a>";` 
```

* * *

 `## 回答 #3

> 赞同：-1
> 
> 时间：2009-05-05T11:35:58.533

你有没有尝试过这样的事情？（未经测试的代码，因为我不在家）

```
if ($getFiles = $con->prepare($filesQuery)) {
$getFiles->bind_param("s", $pk);
$getFiles->execute();
$getFiles->bind_result($FILENAME);
$files = array();

while ($getFiles->fetch()) {
   $filesList = $filesList + '<p><a href="./files/'. $FILENAME .'">'.   $FILENAME .'</a>' . "\n";    
} 
```

# apache-flex - 将事件添加到菜单选项

> ID：824469
> 
> 赞同：1
> 
> 时间：2009-05-05T11:28:17.053
> 
> 标签：apache-flex, actionscript

//动作脚本代码

> 导入 mx.controls.Menu；导入 flash.events.MouseEvent；
> 
> ```
>  private var menu12:Menu;
> 
>         private function init():void {
>             menu12 = new Menu();
>             menu12.labelField = "@label";
>             menu12.dataProvider = xmlDP;
>             menu12.showRoot = false;
>             menu12.width = popUpButton.width;
>             popUpButton.popUp = menu12;
>         } 
> ```

// XML 信息

```
 <menu1 label="Some introduction" />
        <menu2 label="Disabled State (disabled)." enabled="false" />
        <sep1 type="separator" />
        <menu3 label="parent">
            <menu4 label="child1" />
        </menu3>
        <menu5 label="parent (disabled)" enabled="false">
            <menu6 label="child1" />
            <menu7 label="child2" />
            <menu8 label="child3" />
        </menu5>
        <menu9 type="separator" />
        <menu10 type="separator" />
        <menu11 id="leftButton" label="Left" type="radio" groupName="radioGroup" toggled="true" enabled="true"  />
        <menu12 id="rightButton" label="Right" type="radio" groupName="radioGroup" enabled="false" />
        <menu13 id="popupButton" label="Popup" type="radio" groupName="radioGroup" enabled="false" />

    </root> 
```

// 零件

```
<mx:PopUpButton id="popUpButton"
            label="Please select an item"
            openAlways="true"
            creationComplete="init();" /> 
```

如何将 addevents 添加到 popupButton 中的菜单。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-05-05T15:48:15.307

这就是我的做法......

为每个 XML 项添加一个属性以存储每个菜单项的事件名称：

```
<menu4 label="child1" eventName="child1Event" /> 
```

并在父组件初始化时为每个已知事件添加一个事件监听器：

```
private function init():void
{
    menu12 = new Menu();
    ...

    addEventListener("child1Event", child1EventHandler);
}

private function child1EventHandler(event:Event):void
{
    ....
} 
```

（您甚至可以解析 XML 以动态添加事件侦听器

```
private function init():void
{
    menu12 = new Menu();
    ...

    addEventListener("child1Event", 
        function(event:Event)
        {
            alert(event.type);
        }
        );
} 
```

添加 itemClick 事件处理程序：

```
private function popUpButton_itemClickHandler(event:MenuEvent):void
{
    if (event.item.@eventName != null)
        dispatchEvent(new Event(event.item.@eventName));
}

<mx:PopUpButton id="popUpButton"
        label="Please select an item"
        openAlways="true"
        creationComplete="init();" 
        itemClick="popUpButton_itemClickHandler(event);" /> 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-05-05T12:33:35.650

添加

`menu12.addEventListener(MenuEvent.ITEM_CLICK,itemClickHandler);`

在你的 init 函数的末尾，然后添加监听器函数

`private function itemClickHandler(event:MenuEvent):void{}`

到你的脚本。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-05-05T12:58:12.500

我不认为您可以按照您想要的方式将事件处理程序放在特定的 XML 节点上。您必须查看传入的事件才能知道应该运行哪个处理程序。看看 Theo Hultberg 的守卫概念，让过滤代码更干净：

[http://blog.iconara.net/2008/03/30/separating-event-handling-from-event-filtering/](http://blog.iconara.net/2008/03/30/separating-event-handling-from-event-filtering/)

# asp.net - asp.net Wizard控件中的ViewState问题

> ID：824480
> 
> 赞同：1
> 
> 时间：2009-05-05T11:33:14.763
> 
> 标签：asp.net

我们正在使用 ASP.NET (2.0) 向导控件，用户在每个向导步骤中填写几个字段。

我们发现，有时由于某些奇怪的原因，在“回发”到另一个步骤时，先前填充的步骤中的字段值会丢失。

这个问题似乎是随机发生的；有时某些字段值会保留，而其他字段值会丢失。

页面和所有控件的 EnableViewState 为 true。

我们在看什么？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2014-03-31T13:00:42.980

使用更新面板时会发生这类事情。在这种情况下，您需要更新更新面板。

# c# - 如何从 Dictionary 中检索前 n 个元素 ?

> ID：824494
> 
> 赞同：9
> 
> 时间：2009-05-05T11:40:08.493
> 
> 标签：c#, dictionary

有没有办法从 C# 中的 Dictionary 中检索前 n 个元素？

* * *

## 回答 #1

> 赞同：17
> 
> 时间：2009-05-05T11:45:57.853

字典*本身*没有排序，你不能依赖“第一个”的实际含义。来自 MSDN：“对于枚举......返回项目的顺序未定义。”

根据您的平台版本，您可能能够使用[OrderedDictionary](http://msdn.microsoft.com/en-us/library/system.collections.specialized.ordereddictionary.aspx)，并且创建为 Dictionary 的自定义后代类并不是特别复杂的事情。

* * *

## 回答 #2

> 赞同：12
> 
> 时间：2009-05-05T11:42:48.300

请注意， a 没有明确的顺序`Dictionary`，因此尽管以下代码将返回`n`项目，但不能保证框架将如何确定`n`要返回的项目。

```
using System.Linq;

yourDictionary.Take(n); 
```

上面的代码返回一个`IEnumerable<KeyValuePair<TKey,TValue>>`包含`n`项目。您可以轻松地将其转换为`Dictionary<TKey,TValue>`这样的：

```
yourDictionary.Take(n).ToDictionary(); 
```

* * *

## 回答 #3

> 赞同：12
> 
> 时间：2014-07-23T00:36:25.777

通常省略强制转换到字典是行不通的：

```
dictionary = dictionary.Take(n); 
```

像这样的简单案例也不会：

```
dictionary = dictionary.Take(n).ToDictionary(); 
```

最可靠的方法是显式转换：

```
dictionary = dictionary.Take(n).ToDictionary(kvp => kvp.Key, kvp => kvp.Value); 
```

* * *

## 回答 #4

> 赞同：6
> 
> 时间：2009-05-05T11:46:36.543

您不能真正从 a 中获取前 N 个元素，`Dictionary<TKey,TValue>`因为它不是有序集合。所以它真的没有First，Last等的概念......但正如其他人指出的那样，如果你只想取N个元素而不管顺序如何，LINQ take函数工作正常

```
var map = GetTheDictionary();
var firstFive = map.Take(5); 
```

* * *

## 回答 #5

> 赞同：3
> 
> 时间：2009-05-05T11:42:51.653

例如可以使用Linq吗？

```
 var dictionary = new Dictionary<string, int>();

 /// Add items to dictionary

 foreach(var item in dictionary.Take(5))
 {
      // Do something with the first 5 pairs in the dictionary
 } 
```

# reporting-services - 远程 SSRS 的 ASPX 中的 ReportViewer 错误

> ID：824500
> 
> 赞同：0
> 
> 时间：2009-05-05T11:41:05.667
> 
> 标签：reporting-services, reportviewer, ssrs-2008

我收到以下错误：

> 在远程模式下，报表查看器控件需要启用会话状态或在配置文件中指定报表服务器连接信息。

`Windows 2008 server`, `IIS 7`,`Dot Net 3.5`

`sessionState=InProc`

重新启动后，我仍然收到错误消息。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2009-05-05T18:14:46.453

您是否在 Web 服务的 Config 文件中设置了报表服务器连接信息？

看看[http://msdn.microsoft.com/en-us/library/ms251661.aspx](http://msdn.microsoft.com/en-us/library/ms251661.aspx)

在远程模式下工作，您需要指定报表查看器的报表服务连接字符串才能正常工作。

# java - 当我移动 Web 服务时，所有硬编码的 URI 会发生什么情况？

> ID：824501
> 
> 赞同：1
> 
> 时间：2009-05-05T11:41:06.447
> 
> 标签：java, web-services, wsdl, migration, jax-ws

我正在使用 JAX-WS 开发一个测试 WS，并且演示工作正常，但是如果我尝试将它移到生产环境中，我的代码上会出现很多测试环境的 URL。例如：

```
com.mycompany.testserver.ws.writer.WriterInterface service = new com.mycompany.testserver.ws.writer.WriterInterface();

QName portQName = new QName("http://testserver.mycompany.com/ws/writer.php", "WriterInterfacePort");

String req = "SOME_XML_HERE";

try { // Call Web Service Operation

    Dispatch<Source> sourceDispatch = null;
    sourceDispatch = service.createDispatch(portQName, Source.class, Service.Mode.PAYLOAD);
    Source result = sourceDispatch.invoke(new StreamSource(new StringReader(req)));
} catch (Exception ex) [
//do stuff here
} 
```

移动此类应用程序的最佳做法是什么？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-05-05T11:43:31.837

从配置文件中读取连接 URL。您可能还希望拥有一个强类型配置对象，该对象将缓存该值，以便只需要读取一次。然后，当您将应用程序从测试转移到生产时，您只需要更新配置文件。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-05-05T11:43:47.047

最常见的做法是将 URL 存储在配置文件中，而不是硬编码，并为测试和生产设置单独的配置。

引入集成代理或服务注册中心往往是矫枉过正。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-05-05T13:39:20.950

您确实应该避免将 URL 硬编码到代码中。有多种方法可以避免这种情况。即使您没有可用的配置文件功能，您至少应该将此数据存储在每个声明它的类顶部的字符串中。

无需告诉您（但我想我是）您现在遇到了为什么您从未对 URL / 配置数据进行硬编码的原因。

# assembly - PIC汇编器中的银行如何切换？

> ID：824505
> 
> 赞同：2
> 
> 时间：2009-05-05T11:41:46.927
> 
> 标签：assembly, switch-statement, pic, bank

我对 PIC 汇编器中的银行切换感到困惑......这适用于在 usart 上放置一个“Q”：

```
bsf PORTB,1         ;Set Transmit DIR (PORTB (0x6) not mirrored in other banks)
movlw 'Q'           ;'Q' to work reg
movwf TXREG         ;work reg to TXREG (TXREG (0x19) not mirrored in other banks)
clrwdt              ;Clear watchdog
btfss TXSTA,TRMT    ;Wait until 'Q' is shifted (TXSTA is 0x18, not mirrored)
goto $-2
bcf PORTB,1         ;Set Recive DIR 
```

这同样有效：

```
BCF 0x3, 0x5        ;Switch to bank 0
BCF 0x3, 0x6
bsf PORTB,1         ;Set Transmit DIR
movlw 'Q'           ;'Q' to work reg
movwf TXREG         ;work reg to TXREG 
BSF 0x3, 0x5        ;Switch to bank 1
clrwdt              ;Clear watchdog
btfss TXSTA,TRMT    ;Wait until 'Q' is shifted
goto $-2
BCF 0x3, 0x5        ;Switch to bank 0
bcf PORTB,1         ;Set Recive DIR 
```

我已经检查过编译器在我不看的时候没有做任何银行切换……什么时候必须切换银行？

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2009-05-05T12:06:49.740

最好只使用 BANKSEL 自动进行银行切换。这是一个特殊的汇编器指令，告诉汇编器切换到正确的库。因此，如果您想访问 PORTB，请在使用之前使用 BANKSEL(PORTB)。

PS：PORTB 在 PIC16 系列的 BANK0 中，而不是代码中的 BANK1。

* * *

## 回答 #2

> 赞同：5
> 
> 时间：2012-10-11T18:08:03.593

我也发现银行选择很难理解。

我正在使用 PIC12F1822 开始一个项目，因为它们具有 I2C 功能。研究背景就像解开一缕线，每一根线都需要费一番功夫才能弄清楚。我设法提取的线程之一是对“BANKSEL”指令的解释。

背景。有几十个 SFR - 特殊功能寄存器 - 协助设备操作，映射到较低的数据存储器。因为它们太多了，所以它们被组织成 32 个库，编号为 0 到 31，每个库有 32 个 SFR。*SFR 以（位） bbbbbfffffff*的形式顺序编号，其中*bbbbb*是存储库编号，*ffffffff*是存储库中的偏移量。它们的值在 PIC 的 .INC 文件中定义，并且序列中有许多间隙。请注意，对于 bank 0 到 30 中的 SFR 偏移，只需 5 位就足够了，但对于 bank 31，则需要 7 位。

当访问这些 SFR 之一时，其 Bank 编号必须在 BSR 寄存器中，该寄存器由“MOVLB”汇编指令设置。为方便起见，可以在每次访问 SFR 之前使用指令“BANKSEL”。（在其他 PIC 中，STATUS 寄存器中的位保存银行编号）成功测试后，可以删除任何多余的 BANKSEL。我的困惑（在建立这一点之后——文档中的信息稀疏而分散）是这个指令是如何工作的。当然，它在生成任何代码之前由汇编程序进行评估，这是我的测试代码来检查它，使用 EQU 进行计算并解释它（注意 locn 是“位置”，即指令的地址.):

```
 ;BANKSEL is a directive that does the equivalent of 
        ;       movlb  (<SFRname> & 0XF0) >> 7

        ;For example TRISA is defined in P12F1822.INC as:

        ;-----Bank1------------------
        TRISA            EQU  H'008C' 

   Assembler:
   Locn   Resulting value     Line  Original code line content ";" is a comment
   ~~~~   ~~~~~~~~~~~~~~~     ~~~~~ ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
                              00047 ; Test of equivalent of BANKSEL directive          
          0000008C            00048 selbank equ TRISA
          00000080            00049 selbnk1 equ selbank & 0XF80 ; Extract bank no. ..
          00000001            00050 selbnk2 equ selbnk1 >> 7 ; .. move it to the right
          0000000C            00051 selbnk3 equ TRISA & 0XF80 >> 7 
        [ Operator precedence: >> (bit shift right) higher than & (bitwise AND) ]
          0000000C            00052 selbnk4 equ TRISA & (0XF80 >> 7) ; default
          00000001            00053 selbnk5 equ (TRISA & 0XF80) >> 7 ; as needed`
                     . . .
   006C   0021                00100 movlb  1           ; Should be same as next line
   006D   0021                00101 banksel TRISA 
```

* * *

## 回答 #3

> 赞同：3
> 
> 时间：2009-05-08T15:32:32.050

首先，您使用的是哪个图片设备，因为这确实会产生细微的差别。还有你使用的是哪个编译器。

但是，您的代码工作的原因是因为您需要对 uart 进行 tx 操作的所有操作都在 bank 0 中。您对端口 b 的写入什么也没做我猜您想切换 trisb 并且在 bank 1 中但是uart 可以控制写入端口 B 的引脚，它本身没有任何作用。在您的第二个示例中，您正在轮询您认为是 TXSTA 的内容，但那是在银行 0 而不是银行 1 中。我猜您通过轮询错误的位置而幸运，并且该位始终处于正确状态，因此循环终止。

当我进行传输时，我更喜欢先看看 uart 是否为空，然后等到它是空的，然后发送 char。除非您想使用中断来获取下一个字符，否则无需等待它完成传输。

因此，这两条代码都有效，因为当您执行 movwf TXREG 时，您都处于银行 0 中。其余的由硬件为您处理。

编辑：现在我知道你在 TXSTA 中正确的部分在银行 1 中。你通过我是因为你有一个地址为 0x18 的注释，它应该是 0x98。在第一个示例中，您正在轮询 RCSTA 位 1，它是 OERR 而不是 TXSTA。因此，如果它正在工作，这意味着 OERR=1 很有可能，我通常在对接收进行任何操作时将其清除。

# c++ - 为什么空表达式在 C/C++ 中是合法的？

> ID：824512
> 
> 赞同：17
> 
> 时间：2009-05-05T11:43:07.360
> 
> 标签：c++, c, language-design

```
int main()
{
  int var = 0;; // Typo which compiles just fine
} 
```

* * *

## 回答 #1

> 赞同：34
> 
> 时间：2009-05-05T12:01:46.037

定义时怎么`assert(foo == bar);`编译成空`NDEBUG`？

* * *

## 回答 #2

> 赞同：13
> 
> 时间：2009-05-05T12:04:43.283

这是 C 和 C++ 表达[NOP](http://en.wikipedia.org/wiki/NOP)的方式。

* * *

## 回答 #3

> 赞同：9
> 
> 时间：2009-05-05T11:46:19.897

我不是语言设计师，但我给出的答案是“为什么不呢？” 从语言设计的角度来看，人们希望规则（即语法）尽可能简单。

更不用说“空表达式”有用途，即

对于 (i = 0; i < INSANE_NUMBER; i++);

将死等待（不是一个很好的用途，但仍然有用）。

编辑：正如对此答案的评论中指出的那样，任何值得其盐的编译器都可能*不会*忙于等待这个循环，并将其优化掉。但是，如果在 for 头本身（除了 i++）中有更有用的东西，我已经看到（奇怪地）通过数据结构遍历完成，那么我想你仍然可以构造一个空主体的循环（通过使用 /滥用“for”结构）。

* * *

## 回答 #4

> 赞同：9
> 
> 时间：2009-05-05T12:18:46.433

你希望能够做类似的事情

```
while (fnorble(the_smurf) == FAILED)
    ; 
```

并不是

```
while (fnorble(the_smurf) == FAILED)
    do_nothing_just_because_you_have_to_write_something_here(); 
```

*但！*请不要在同一行写空语句，如下所示：

```
while (fnorble(the_smurf) == FAILED); 
```

这是混淆读者的好方法，因为很容易错过分号，因此认为下一行是循环的主体。请记住：编程实际上是关于交流——不是与编译器，而是与其他将阅读您的代码的人。（或者和自己一起，三年后！）

* * *

## 回答 #5

> 赞同：9
> 
> 时间：2011-12-10T20:26:28.093

好的，我将把它添加到您可能实际使用的最坏情况中：

```
for (int yy = 0; yy < nHeight; ++yy) {
    for (int xx = 0; xx < nWidth; ++xx) {
        for (int vv = yy - 3; vv <= yy + 3; ++vv) {
            for (int uu = xx - 3; uu <= xx + 3; ++uu) {
                if (test(uu, vv)) {
                    goto Next;
                }
            }
        }
    Next:;
    }
} 
```

* * *

## 回答 #6

> 赞同：8
> 
> 时间：2009-05-05T11:49:48.453

显然，我们可以这样说

```
for (;;) {
  // stuff
} 
```

没有那个谁能活？

* * *

## 回答 #7

> 赞同：8
> 
> 时间：2009-05-05T11:58:40.647

老实说，我不知道这是否是真正的原因，但我认为更有意义的是从编译器实现者的角度来考虑它。

大部分编译器是由分析特殊语法类的自动化工具构建的。有用的语法允许空语句似乎很自然。当它不改变代码的语义时，检测这样的“错误”似乎是不必要的工作。空语句不会做任何事情，因为编译器不会为这些语句生成代码。

在我看来，这只是“不要修复没有损坏的东西”的结果......

* * *

## 回答 #8

> 赞同：2
> 
> 时间：2009-05-05T11:48:01.983

最常见的情况可能是

```
int i = 0;
for (/* empty */; i != 10; ++i) {
    if (x[i].bad) break;
}
if (i != 10) {
    /* panic */
} 
```

* * *

## 回答 #9

> 赞同：2
> 
> 时间：2015-03-04T17:32:09.270

使用时`;`，还请注意一件事。还行吧：

```
a ? b() : c(); 
```

但是，这不会编译：

```
a ? b() : ; ; 
```

* * *

## 回答 #10

> 赞同：1
> 
> 时间：2018-06-10T06:04:10.173

已经有很多好的答案，但还没有看到生产环境样本。

[这](http://cvsweb.openbsd.org/cgi-bin/cvsweb/src/lib/libc/string/strlen.c?rev=1.7&content-type=text/x-cvsweb-markup)是 FreeBSD 的实现`strlen`：

```
size_t
strlen(const char *str)
{
    const char *s;

    for (s = str; *s; ++s)
        ;
    return (s - str);
} 
```

* * *

## 回答 #11

> 赞同：0
> 
> 时间：2009-05-05T11:48:17.990

```
while (1) {
    ;  /* do nothing */
} 
```

有时你想坐着什么也不做。事件/中断驱动的嵌入式应用程序或当您不希望函数退出时，例如在设置线程和等待第一次上下文切换时。

例如： http: [//lxr.linux.no/linux+v2.6.29/arch/m68k/mac/misc.c#L523](http://lxr.linux.no/linux+v2.6.29/arch/m68k/mac/misc.c#L523)

# windows - 如何快速开发不依赖其他运行时的 Windows 应用程序？

> ID：824513
> 
> 赞同：0
> 
> 时间：2009-05-05T11:43:11.730
> 
> 标签：windows, rad

我是一名 C# 开发人员，我了解 .NET 如何使开发 Windows 应用程序变得更容易。类型安全、内存管理和出色的 IDE 只是让开发 .NET 应用程序变得轻而易举的几件事。不幸的是，这些应用程序要求用户在安装应用程序本身之前安装 .NET 框架。这可能会使用户感到困惑并吓跑潜在客户。

是否有任何其他开发环境可以让人们像在 C# 中一样轻松地开发 Windows 应用程序，但无需事先安装其他运行时？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2009-05-05T11:50:41.320

Embarcadero Delphi 是另一个不错的候选者[http://www.codegear.com/products/delphi](http://www.codegear.com/products/delphi)

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2009-05-08T15:34:57.817

还有一个免费的多平台 Delphi 类似，Lazarus，请参阅[http://lazarus.freepascal.org](http://lazarus.freepascal.org) 不太完善但免费且非常强大。（源代码与Delphi高度兼容）

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-05-05T11:45:46.793

你看过[RealBasic](http://www.realsoftware.com/realbasic/)了吗？

# c# - 我可以使用office 2007 窗口样式吗？

> ID：824518
> 
> 赞同：0
> 
> 时间：2009-05-05T11:43:33.523
> 
> 标签：c#, .net, wpf

我喜欢 Office 2007 的窗口边框（它在 Windows XP 中的外观）。有没有办法在我的 WPF 应用程序中使用相同的边框？

也许它包含在 RibbonX 中，但是当我只想拥有相同的边框样式时，整个包对我的应用程序来说似乎很重。

如果这一切都不可能，有人可以给我一些关于如何在 WPF 中设计自己的边框的建议。在这个主题上找不到太多有用的信息..

谢谢

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-05-05T11:45:53.300

您可能会发现[这篇](http://blog.opennetcf.com/ayakhnin/PermaLink,guid,23a7be17-d833-4e45-b498-34ef04d98cb2.aspx)文章很有趣，因为它向您展示了如何使用 windows 样式来获取 Office 2007 的结果。

它有一个带有 XAML 的示例源代码项目，用于演示圆角窗口角和窗口渐变。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-05-05T12:04:30.510

您可以直接从 Microsoft 获得免费的 Office 功能区 Beta。我已经用它作为 WPF 程序了。如果你习惯了它并没有那么难，而且很有趣。也许它会帮助您解决您的想法。

[http://www.uxpassion.com/2008/11/download-free-wpf-ribbon-windows-scenic-office-2007-style/](http://www.uxpassion.com/2008/11/download-free-wpf-ribbon-windows-scenic-office-2007-style/)

[http://windowsclient.net/wpf/wpf35/wpf-35sp1-ribbon-walkthrough.aspx](http://windowsclient.net/wpf/wpf35/wpf-35sp1-ribbon-walkthrough.aspx)

# c# - 如何使用 Expression Blend 编辑在 Visual Studio 中创建的 DataTemplate？

> ID：824539
> 
> 赞同：8
> 
> 时间：2009-05-05T11:54:09.503
> 
> 标签：c#, wpf, expression-blend

对于**那些在实际项目中使用 Expression Blend**和 Visual Studio 的人，请帮助我了解**您如何在日常开发/设计任务中使用 Blend 和 Visual Studio**，这是一个真实的场景：

我在 Visual Studio 中创建了以下简单的 WPF 应用程序。它显示了一个客户对象列表，其中包含一个以简单的橙色框显示客户**的 DataTemplate 。**

我现在想通过使用 Expression Blend**在这个 DataTemplate 中添加一些 pizazz 。**

我**在 Expression Blend 中打开项目，**认为我将看到可以更改颜色的橙色框，当我将鼠标悬停在它们上时创建动画，调整它的大小等。但是，**我在 Expression Blend 中看到的只是一个完全空白的盒子**。

所以我明白：

*   Expression Blend**似乎无法理解我的数据来自 ViewModel**，因此不会显示它。这是 Blend 的一个限制，还是我需要以某种方式更改我的代码，以便 Blend 可以解释运行时将输出的数据？
*   我正在使用具有“示例数据”功能的 Expression Blend 3。**使用此示例数据功能的最佳方法是什么，**以便即使它无法解释 C# 并理解 ViewModel 属性将从 ViewModel 属性中输出的数据来填充列表框，我怎样才能让它至少产生一些虚拟数据以便我可以操作 DataTemplate？

**XAML：**

```
<Window x:Class="TestStringFormat234.Window1"
    xmlns="http://schemas.microsoft.com/winfx/2006/xaml/presentation"
    xmlns:x="http://schemas.microsoft.com/winfx/2006/xaml"
    Title="Window1" Height="300" Width="300">
    <Window.Resources>
        <DataTemplate x:Key="DataTemplateCustomers">
            <Border CornerRadius="5" Background="Orange" Padding="5" Margin="3">
                <StackPanel Orientation="Horizontal">
                    <TextBlock>
                    <TextBlock.Text>
                        <MultiBinding StringFormat="{}{0} {1} (hired on {2:MMM dd, yyyy})">
                            <Binding Path="FirstName"/>
                            <Binding Path="LastName"/>
                            <Binding Path="HireDate"/>
                        </MultiBinding>
                    </TextBlock.Text>
                    </TextBlock>
                </StackPanel>
            </Border>
        </DataTemplate>
    </Window.Resources>
    <Grid>
        <ListBox ItemsSource="{Binding GetAllCustomers}"
                 ItemTemplate="{StaticResource DataTemplateCustomers}">
        </ListBox>
    </Grid>
</Window> 
```

**代码背后：**

```
using System.Windows;
using System.Collections.ObjectModel;
using System;

namespace TestStringFormat234
{
    public partial class Window1 : Window
    {
        public Window1()
        {
            InitializeComponent();
            DataContext = new CustomerViewModel();
        }
    }

    //view model
    public class CustomerViewModel
    {
        public ObservableCollection<Customer> GetAllCustomers {
            get {
                ObservableCollection<Customer> customers = new ObservableCollection<Customer>();
                customers.Add(new Customer { FirstName = "Jim", LastName = "Smith", HireDate = DateTime.Parse("2007-12-31") });
                customers.Add(new Customer { FirstName = "Jack", LastName = "Jones", HireDate = DateTime.Parse("2005-12-31") });
                return customers;
            }
        }
    }

    //model
    public class Customer
    {
        public string FirstName { get; set; }
        public string LastName { get; set; }
        public DateTime HireDate { get; set; }
    }
} 
```

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2009-05-07T07:31:29.727

我只是想通了，所以请允许我回答我自己的问题。

我阅读了[Laurent 的 Bugnion 启发性文章，](http://www.galasoft.ch/mydotnet/articles/article-2007091401.html)结果发现我只需要调整上面的代码，以便我可以看到来自我的 ViewModel 的数据显示在 Expression Blend GUI 中，并且能够在 Blend 中编辑 DataTemplate，保存它，然后然后在 Visual Studio 中继续编辑。

基本上更改是：（1）从后面的代码中取出 DataContext 语句，（2）在 XAML 中添加“本地”命名空间，（3）在 XAML 中定义一个本地数据提供者（“TheDataProvider”），（4）绑定到它直接来自 ListBox。

以下是在 Expression Blend 和 Visual Studio 中完整运行的代码：

**XAML：**

```
<Window
    xmlns="http://schemas.microsoft.com/winfx/2006/xaml/presentation"
    xmlns:x="http://schemas.microsoft.com/winfx/2006/xaml"
    xmlns:local="clr-namespace:TestStringFormat234"
    xmlns:d="http://schemas.microsoft.com/expression/blend/2008" xmlns:mc="http://schemas.openxmlformats.org/markup-compatibility/2006" x:Name="window" x:Class="TestStringFormat234.Window1"
    Title="Window1" Height="300" Width="300" mc:Ignorable="d">
    <Window.Resources>
        <local:CustomerViewModel x:Key="TheDataProvider"/>

        <DataTemplate x:Key="DataTemplateCustomers">
            <Border CornerRadius="5" Padding="5" Margin="3">
                <Border.Background>
                    <LinearGradientBrush EndPoint="1.007,0.463" StartPoint="-0.011,0.519">
                        <GradientStop Color="#FFF4EEEE" Offset="0"/>
                        <GradientStop Color="#FFA1B0E2" Offset="1"/>
                    </LinearGradientBrush>
                </Border.Background>
                <StackPanel Orientation="Horizontal">
                    <TextBlock>
                    <TextBlock.Text>
                        <MultiBinding StringFormat="{}{0} {1} (hired on {2:MMM dd, yyyy})">
                            <Binding Path="FirstName"/>
                            <Binding Path="LastName"/>
                            <Binding Path="HireDate"/>
                        </MultiBinding>
                    </TextBlock.Text>
                    </TextBlock>
                </StackPanel>
            </Border>
        </DataTemplate>
    </Window.Resources>
    <Grid >
        <ListBox 
            ItemsSource="{Binding Path=GetAllCustomers, Source={StaticResource TheDataProvider}}"
            ItemTemplate="{StaticResource DataTemplateCustomers}" />
    </Grid>
</Window> 
```

**代码背后：**

```
using System.Windows;
using System.Collections.ObjectModel;
using System;

namespace TestStringFormat234
{
    public partial class Window1 : Window
    {
        public Window1()
        {
            InitializeComponent();
        }
    }

    //view model
    public class CustomerViewModel
    {
        public ObservableCollection<Customer> GetAllCustomers {
            get {
                ObservableCollection<Customer> customers = new ObservableCollection<Customer>();
                customers.Add(new Customer { FirstName = "Jim", LastName = "Smith", HireDate = DateTime.Parse("2007-12-31") });
                customers.Add(new Customer { FirstName = "Jack", LastName = "Jones", HireDate = DateTime.Parse("2005-12-31") });
                return customers;
            }
        }
    }

    //model
    public class Customer
    {
        public string FirstName { get; set; }
        public string LastName { get; set; }
        public DateTime HireDate { get; set; }
    }
} 
```

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2009-10-05T13:45:40.467

我有一篇关于这个问题的博客文章：[http ://www.robfe.com/2009/08/design-time-data-in-expression-blend-3/](http://www.robfe.com/2009/08/design-time-data-in-expression-blend-3/)

我的帖子都是关于在混合中显示数据，*而*不必在运行时显示甚至创建该数据。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-04-30T13:23:00.797

如果想要让 Blend 和 Visual Studio 仅在设计模式下查看 datacontext 的内容，则可以使用页面上的调试选项进行定义。例如，我的页面（在代码隐藏中）将其数据上下文绑定到我的 nampespace WP8TestBed 中的 MainVM，通过将主页属性上的信息通知为 d:DataContext，它仅在设计时使用（我可以使用绑定到它向导），并且在运行时也不会创建视图模型的新实例。

这是示例，需要所有这些命名空间（d、mc 和我的 ViewModel（MainVM）所在的本地）：

```
<phone:PhoneApplicationPage
x:Class="WP8TestBed.MainPage"
...
xmlns:d="http://schemas.microsoft.com/expression/blend/2008"
xmlns:mc="http://schemas.openxmlformats.org/markup-compatibility/2006" 
xmlns:local="clr-namespace:WP8TestBed"
mc:Ignorable="d"
Name="Primary"
d:DataContext="{d:DesignInstance local:MainVM}"> 
```

# php - calling setTimeout from a form with quotes

> ID：824541
> 
> 赞同：1
> 
> 时间：2009-05-05T11:55:06.710
> 
> 标签：php, javascript, html

I have a html form for uploading a file, which is as follows:

```
$uploadhtml = htmlspecialchars(json_encode("<form action='up.php' method='post'
enctype='multipart/form-data'>
<label for='file'>Filename:</label>
<input type='file' name='file' id='file'/> 
<br />
<input type='hidden' name='pk' value='".$pk."'>
<input type='hidden' name='username' value='".$USERNAME."'>
<input type='submit' name='submit' value='Submit' onclick= />
</form>"), ENT_QUOTES); 
```

I would like to know if it is possible to call the s`etTimeout` function to update a particular layer, like follows:

```
onclick="setTimeout('updateLayer("text", "ff", "ok"))',1250);" 
```

`updateLayer` takes 3 variables as arguments, how would I specify them as parameters within quotes?

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2009-05-05T12:04:39.650

Something like this:

```
onclick="setTimeout(function() { updateLayer('text', 'ff', 'ok'); } ),1250);" 
```

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2009-05-05T12:09:43.443

You can also backslash the quotes. Note that this only works with " qoutes and not ' quotes in php, but works with both quotes in javascript:

```
onclick="setTimeout(function() { updateLayer(\"text\", \"your's\", \"ok\"); } ),1250);" 
```

# .net - 关于 SourceSafe 许可证

> ID：824543
> 
> 赞同：0
> 
> 时间：2009-05-05T11:56:00.060
> 
> 标签：.net, visual-sourcesafe

如果我有 VisualStudio 2005 和 2008 的许可证

我也有 SourceSafe 的许可证？还是我需要买？

从哪里可以得到一个？

提前致谢

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-05-05T12:09:18.453

“您在安装 VSS 的每台机器上都需要 VSS 许可证。如果您决定使用专用的“服务器”机器来托管 VSS 数据库，那么是的，您也需要该机器的许可证。”

[http://social.msdn.microsoft.com/forums/en-US/vssourcecontrol/thread/1e43c9fe-3ac1-4287-97ad-d1c93e3c140b](http://social.msdn.microsoft.com/forums/en-US/vssourcecontrol/thread/1e43c9fe-3ac1-4287-97ad-d1c93e3c140b)

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-05-05T12:16:21.463

请注意，VSS 经常因其缺点而受到批评。您可能需要考虑另一个 VCS，例如 SVN 或 git。

参见例如 [我如何说服我的团队放弃 sourcesafe 并迁移到 SVN？](https://stackoverflow.com/questions/115493/how-do-i-convince-my-team-to-drop-sourcesafe-and-move-to-svn)

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-05-05T12:41:45.160

您是否通过 MSDN 获得许可？如果是这样，那么“Visual Studio Professional with MSDN Premium”或“Visual Studio Professional with MSDN Professional”订阅[包括 VSS 的许可证](http://msdn.microsoft.com/en-gb/subscriptions/subscriptionschart.aspx)。

但是，我也重复这些建议以查看其他产品。我的偏好是[VisualSVN Server](http://www.visualsvn.com/server/) + [TortoiseSVN](http://tortoisesvn.tigris.org/)（客户端）

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2009-05-05T12:12:06.963

你真正需要的是一个[真正的源代码控制系统](https://stackoverflow.com/questions/16073/alternatives-to-visual-sourcesafe-that-integrate-with-visual-studio)。

我在这里不是开玩笑或不屑一顾。SourceSafe 总比没有好，但实际上任何其他 SCCS 都比 SourceSafe 好——MS 没有在内部使用它是有原因的（例如数据库损坏的高风险、文件共享的低效使用、不支持分支）。TFS 相当不错（一个**被**MS 狗食了），许多人对 Subversion 发誓。还有很多其他工具，其中许多与 VS 集成得一样好。

# asp.net - Javascript 和 ASP.NET 2.0：如何在客户端的 Javascript 代码中知道页面是否有效（在进行验证后）？

> ID：824545
> 
> 赞同：0
> 
> 时间：2009-05-05T11:56:06.067
> 
> 标签：asp.net, javascript, validation, client-side

我需要知道所有客户端验证器检查是否成功，或者一个或多个验证器是否无效。

我想客户端应该有一个变量（如服务器上的对应 Page.IsValid），它报告页面是否有效。我对吗？

有人有什么想法吗？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-05-05T12:00:57.380

在客户端检查 Page_IsValid 全局变量，[这里有详细信息](http://msdn.microsoft.com/en-us/library/yb52a4x0(VS.80).aspx)

# c# - 为什么 Visual Studio 默认不创建公共类？

> ID：824555
> 
> 赞同：54
> 
> 时间：2009-05-05T12:02:04.133
> 
> 标签：c#, visual-studio

在 Visual Studio 中，当您添加一个新类时，它总是在没有修饰符的情况下创建，这使得类成为内部类。

```
class MyClass
{
} 
```

我希望我的课程默认创建为公共课程。

为什么默认是内部的？

你更喜欢什么？

* * *

## 回答 #1

> 赞同：39
> 
> 时间：2009-05-05T12:07:19.097

默认情况下创建类`internal`对我来说非常有意义：对自己保密，只明确公开真正需要公开的部分：其他一切都只是实现细节，不应该对外界可见。

如果您想测试您的`internal`类，.NET 2.0 及更高版本引入了一个名为[InternalsVisibleToAttribute](http://msdn.microsoft.com/en-us/library/system.runtime.compilerservices.internalsvisibletoattribute.aspx)的新属性，它

> 指定通常仅在当前程序集中可见的类型对另一个程序集可见。

如果这真的让您烦恼，请参阅`%ProgramFiles%\Microsoft Visual Studio 8\Common7 IDE\ItemTemplates\CSharp\1033\Class.zip`。这是一个模板，您可以根据自己的需要进行更改。ReSharper 具有类似的功能，但可以从 UI 中直接访问。

* * *

## 回答 #2

> 赞同：33
> 
> 时间：2013-05-27T21:58:41.797

在默认情况下为 Visual Studio 2012 创建公共类：

编辑这个文件：`C:\Program Files (x86)\Microsoft Visual Studio 11.0\Common7\IDE\ItemTemplates\CSharp\Code\1033\Class\Class.cs`

（视觉工作室 2022 `C:\Program Files\Microsoft Visual Studio\2022\Community\Common7\IDE\ItemTemplates\CSharp\Code\1033\Class`：）

看起来像这样：

```
using System;
using System.Collections.Generic;
$if$ ($targetframeworkversion$ >= 3.5)using System.Linq;
$endif$using System.Text;
$if$ ($targetframeworkversion$ >= 4.5)using System.Threading.Tasks;
$endif$
namespace $rootnamespace$
{
    public class $safeitemrootname$
    {
    }
} 
```

更多信息：[http ://aaron-hoffman.blogspot.com/2013/05/edit-default-visual-studio-2012-item.html](http://aaron-hoffman.blogspot.com/2013/05/edit-default-visual-studio-2012-item.html)

* * *

## 回答 #3

> 赞同：5
> 
> 时间：2009-05-05T12:03:12.633

C# 倾向于将所有内容默认为必要的最小范围。这是一个很好的约定，并在 Skeet 的书中引用（[C# In Depth](http://www.manning.com/skeet/) , p 224 “Note/Trivia”）：

> *[属性是]唯一需要“私有”的*地方——在 C# 中的其他任何地方，任何给定情况下的默认访问修饰符都是可能的最私有的。换句话说，如果可以将某些东西声明为私有，那么完全省略访问修饰符将默认它是私有的。这是语言设计的一个很好的元素，因为它很难意外地出错：如果你想让某些东西比它更公开，当你尝试使用它时你会注意到它。

* * *

## 回答 #4

> 赞同：2
> 
> 时间：2009-05-05T12:09:36.080

我更喜欢它原来的样子。这样，您必须有意识地决定您希望它公开。这很像争论，您是希望您的计算机默认向外界开放，还是您更愿意自己配置它以访问互联网。

这两种方法都有其优点，其中一种具有重大的潜在安全隐患，我认为您应该意识到并做出有意识的决定，而不仅仅是自动发生。

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2009-05-05T12:03:29.030

因为在 C# 中，默认情况下一个类是内部的。因此，VisualStudio 遵循 C# 规范。

以下文章介绍了 C# 中的访问修饰符和默认可见性。

[http://msdn.microsoft.com/en-us/library/ms173121.aspx](http://msdn.microsoft.com/en-us/library/ms173121.aspx)

* * *

## 回答 #6

> 赞同：1
> 
> 时间：2009-05-05T12:04:22.320

有趣的是，这只发生在 C# 中——在 vb.net 中，默认情况下你会得到一个公共类。

就个人而言，默认情况下我更喜欢公共类，因为通常其他类需要访问它。（虽然我的大部分工作都在数据层中）

* * *

## 回答 #7

> 赞同：1
> 
> 时间：2009-05-05T12:05:39.710

您可以更改 C# 类的模板 - 通常位于“C:\Program Files (x86)\Microsoft Visual Studio 9.0\VC#”

甚至创建自己的模板。

* * *

## 回答 #8

> 赞同：1
> 
> 时间：2009-05-05T12:09:56.517

我个人更喜欢它，它迫使你积极思考你想公开哪些课程。

它最终会默认你进入一个有希望的更清洁的 API 设计，因此更好更友好的软件。您不想公开代码的内部工作，如果一切都默认为公开，这将不可避免地发生。

这有点主观，我个人更喜欢关闭一切，只打开我不需要的东西，反之亦然。

* * *

## 回答 #9

> 赞同：0
> 
> 时间：2011-10-07T22:23:45.677

在所有代码领域中，尽可能限制事物是一种很好的做法。如果没有特别的理由，一切都应该是私有的、只读的（更好的是 const）和静态的。如果变量、方法或属性可以是私有的，请将其设为私有。如果它不能是私有的，但可以被保护，则使其受到保护。如果它可以是只读的，请将其设为只读。如果它可以是静态的，就让它成为静态的。类也是如此：默认情况下它们应该是内部的，并且只有在您确定这是您希望导出的类时才公开。

# c# - 在 C# 中禁用控件接收事件

> ID：824558
> 
> 赞同：0
> 
> 时间：2009-05-05T12:02:44.350
> 
> 标签：c#, winforms, .net-2.0, controls

我有一个包含*大量控件*的对话框。每个控件都将在**加载序列**期间填充，并且可能需要一段时间才能完全填充。同时，我**不想**让用户点击任何控件。换句话说，我想禁用控件接收事件并且我不想禁用控件（因为它可能看起来很奇怪）。另外，我不想定期订阅和取消订阅事件。有什么办法可以阻止控件在短时间内收听事件？

苏达桑·斯里尼瓦桑

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2009-05-05T12:19:12.860

禁用控件的全部意义在于向用户传达该控件不能在特定时间使用的信息。这是用户已经学习并习惯的约定，因此我建议您遵循该约定。不这样做可能会使用户感到困惑。

最简单的方法是禁用控件所在的容器，而不是禁用每个控件。更好的方法（或者至少是我更喜欢的方法）是有一个方法可以根据 UI 所处的状态来控制控件的`Visible`和`Enabled`属性。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2009-05-05T12:11:45.327

最简单的方法是将控制群体移出加载事件（如果可能）。然后在 Load 中执行以下操作：

```
private bool _LoadComplete;

void OnFormLoad(Object sender, EventArgs e)
{
    _LoadComplete = true;
    InitializeControls();
    _LoadComplete = false;
}

void InitializeControls()
{
    // Populate Controls
}

void OnSomeControlEvent()
{
    if (_LoadComplete)
    {
         // Handle the event
    }
} 
```

*编辑*其他几个想法：

*   设置 Application.Cursor = WaitCursor（通常不允许点击，但不是 100% 保证）
*   创建一个“Spinner”控件，让用户知道屏幕正忙。加载时将其带到前面，使其位于顶部并覆盖所有其他控件。完成加载后，将其设置为 visible = false 并显示其他控件

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2009-05-05T12:06:57.443

不幸的是，我知道的唯一方法是拥有一个类变量（称为 _loading 之类的东西）并在每个控制处理程序中执行以下操作：

```
If (! _loading )
{
    ...
} 
```

完成加载后，在您的加载代码集中`_loading = true;`。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2009-05-05T12:15:10.357

如果您只想禁用用户输入，则可以将表单的`Enabled`属性设置为 false。

这具有阻止用户输入任何表单控件的效果，而不改变控件的外观；这是该方法内部使用的技术`ShowDialog`。

# cgi - CGI : 502 Bad Gateway CGI 不符合 CGI/1.1。

> ID：824559
> 
> 赞同：1
> 
> 时间：2009-05-05T12:03:04.693
> 
> 标签：cgi

我在 HTM 页面中有一个表单，在按下提交按钮后，调用 index.cgi ！

```
#!/usr/bin/sh

export LD_LIBRARY_PATH=$LD_LIBRARY_PATH:/nastools/pysqlite2/pysqlite2
export PYTHONPATH=$PYTHONPATH:/nastools/pysqlite2/:/path/impo
export PATH=/nastools/python64/bin/:$PATH

python /remote/path/impo/manager.py 2>&1 
```

我只想运行存储在文件夹 /remote/path/impo 中的 manager.py ！

我完全被这个愚蠢的错误发疯了，找不到解决它的方法......

有什么建议吗？？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-05-05T12:45:12.003

谢谢 NineBarry，但我发现了问题......在尝试使用 CGI 脚本之后肯定很好：

```
#!/bin/sh
echo Content-type: text/html
echo
echo
echo "<HTML>"
echo "<HEAD>"
echo "</HEAD>"
echo "<BODY>"
echo "<H2>Users logged in are:</H2>"
echo "<PRE>"
who
echo "</PRE>"
echo "</BODY>"
echo "</HTML>" 
```

我偶然记得我没有设置访问权限！！！！我在上面浪费了 2 个小时......我只用 chmod 777 name.cgi 修复了它......

如果我浪费了你们的时间，向你们所有人道歉！

再见

# ruby - Ruby 是否执行尾调用优化？

> ID：824562
> 
> 赞同：93
> 
> 时间：2009-05-05T12:03:12.650
> 
> 标签：ruby, functional-programming, tail-recursion

函数式语言导致使用递归来解决很多问题，因此其中许多执行尾调用优化（TCO）。TCO 导致从另一个函数（或自身，在这种情况下，此功能也称为尾递归消除，它是 TCO 的子集）调用函数，作为该函数的最后一步，不需要新的堆栈帧，这减少了开销和内存使用。

Ruby 显然从函数式语言中“借用”了一些概念（lambda、map 等函数等），这让我很好奇：Ruby 是否执行尾调用优化？

* * *

## 回答 #1

> 赞同：131
> 
> 时间：2009-05-05T13:21:34.130

不，Ruby 不执行 TCO。但是，它*也不*执行 TCO。

Ruby 语言规范没有提及 TCO。它没有说你必须这样做，但也没有说你*不能*这样做。你不能*依赖*它。

这与 Scheme 不同，Scheme 中语言规范*要求*所有实现*都**必须*执行 TCO。但它也与 Python 不同，Guido van Rossum 在 Python 中多次明确表示（上一次是几天前）Python 实现*不应该*执行 TCO。

Yukihiro Matsumoto 很同情 TCO，他只是不想强迫*所有*实现都支持它。不幸的是，这意味着您不能依赖 TCO，否则，您的代码将不再可移植到其他 Ruby 实现。

因此，一些 Ruby 实现执行 TCO，但大多数不执行。例如，YARV 支持 TCO，尽管（目前）您必须明确取消注释源代码中的一行并重新编译 VM，以激活 TCO——在未来的版本中，它将默认启用，在实现证明之后稳定的。Parrot 虚拟机本身支持 TCO，因此 Cardinal 也可以很容易地支持它。CLR 对 TCO 有一些支持，这意味着 IronRuby 和 Ruby.NET 可能会做到这一点。鲁比尼乌斯也可能做到这一点。

但是 JRuby 和 XRuby 不支持 TCO，而且它们可能不会，除非 JVM 本身获得对 TCO 的支持。问题是这样的：如果你想有一个快速的实现，和Java的快速无缝集成，那么你应该与Java堆栈兼容，并尽可能使用JVM的堆栈。您可以很容易地使用蹦床或显式延续传递样式实现 TCO，但是您不再使用 JVM 堆栈，这意味着每次您想调用 Java 或从 Java 调用 Ruby 时，都必须执行某种转换，很慢。因此，XRuby 和 JRuby 选择了速度和 Java 集成，而不是 TCO 和延续（基本上有相同的问题）。

这适用于希望与某些不支持原生 TCO 的主机平台紧密集成的所有 Ruby 实现。例如，我猜 MacRuby 也会遇到同样的问题。

* * *

## 回答 #2

> 赞同：43
> 
> 时间：2012-11-12T19:46:40.507

**更新：**这里对 Ruby 中的 TCO 进行了很好的解释：http: [//nithinbekal.com/posts/ruby-tco/](http://nithinbekal.com/posts/ruby-tco/)

**更新：**您可能还想查看**tco_method** gem：[http ://blog.tdg5.com/introducing-the-tco_method-gem/](http://blog.tdg5.com/introducing-the-tco_method-gem/)

在 Ruby MRI（1.9、2.0 和 2.1）中，您可以通过以下方式打开 TCO：

```
RubyVM::InstructionSequence.compile_option = {
  :tailcall_optimization => true,
  :trace_instruction => false
} 
```

有一个提议在 Ruby 2.0 中默认开启 TCO。它还解释了随之而来的一些问题：[**尾调用优化：默认启用？**](http://bugs.ruby-lang.org/issues/6602)

链接的简短摘录：

> 通常，尾递归优化包括另一种优化技术——“调用”到“跳转”翻译。在我看来，很难应用这种优化，因为在 Ruby 的世界中识别“递归”是很困难的。
> 
> 下一个例子。“else”子句中的 fact() 方法调用不是“尾调用”。

```
def fact(n) 
  if n < 2
    1 
 else
   n * fact(n-1) 
 end 
end 
```

> 如果你想在 fact() 方法上使用尾调用优化，你需要改变 fact() 方法如下（继续传递风格）。

```
def fact(n, r) 
  if n < 2 
    r
  else
    fact(n-1, n*r)
  end
end 
```

* * *

## 回答 #3

> 赞同：12
> 
> 时间：2009-05-05T12:09:19.607

它可以具有但不保证：

[https://bugs.ruby-lang.org/issues/1256](https://bugs.ruby-lang.org/issues/1256)

* * *

## 回答 #4

> 赞同：4
> 
> 时间：2014-03-12T20:26:14.560

TCO 也可以通过在编译前调整 vm_opts.h 中的几个变量来编译： [https ://github.com/ruby/ruby/blob/trunk/vm_opts.h#L21](https://github.com/ruby/ruby/blob/trunk/vm_opts.h#L21)

```
// vm_opts.h
#define OPT_TRACE_INSTRUCTION        0    // default 1
#define OPT_TAILCALL_OPTIMIZATION    1    // default 0 
```

* * *

## 回答 #5

> 赞同：2
> 
> 时间：2014-05-02T20:54:59.670

这建立在 Jörg 和 Ernest 的答案之上。基本上它取决于实施。

我无法得到 Ernest 对 MRI 工作的回答，但这是可行的。我发现[这个例子](https://bugs.ruby-lang.org/issues/9114)适用于 MRI 1.9 到 2.1。这应该打印一个非常大的数字。如果您没有将 TCO 选项设置为 true，您应该会收到“堆栈太深”错误。

```
source = <<-SOURCE
def fact n, acc = 1
  if n.zero?
    acc
  else
    fact n - 1, acc * n
  end
end

fact 10000
SOURCE

i_seq = RubyVM::InstructionSequence.new source, nil, nil, nil,
  tailcall_optimization: true, trace_instruction: false

#puts i_seq.disasm

begin
  value = i_seq.eval

  p value
rescue SystemStackError => e
  p e
end 
```

# java - 将 CSV 文件作为 DB 表读入 Java

> ID：824565
> 
> 赞同：2
> 
> 时间：2009-05-05T12:03:59.027
> 
> 标签：java, jdbc, csv

我发现了许多关于使用 Java 读取 CSV 的帖子，他们所指向的 API 在读取 CSV 文件时都采用了面向行的方法。类似于“当你得到一行时，获取每一列的值”。

我很欣赏更高级别的 API，比如在 Perl 中，DBI 允许您在 CSV 上使用 SQL，就像它在数据库表中一样。否则我将不得不自己实现很多访问逻辑。

有这样的API吗？我错过了什么吗？有一些关于 JDBC 驱动程序的参考资料，但大多数是过去 5 年没有更新的项目。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-05-05T12:31:07.170

您可以使用[HSQL](http://hsqldb.org/)来执行此操作，请参阅[文档](http://hsqldb.org/doc/guide/ch06.html)中的以下链接和准确描述该内容的[博客文章。](http://www.java-community.de/archives/14-Use-HSQLDB-to-manipulate-CSV-data.html)

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-05-05T12:16:56.483

您可以[试一试 H2Database](http://www.h2database.com/html/tutorial.html#csv) - 它的重量相当重，但至少它得到了维护。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-05-05T12:37:34.610

您是否试图避免使用常规数据库来访问 CSV？如果您愿意使用数据库系统，MySQL 支持 CSV 作为其表类型之一。

* * *

## 回答 #4

> 赞同：-1
> 
> 时间：2009-05-05T12:14:40.390

是的，带有 CSV 驱动程序的 JDBC。您可以尝试自己实现或尝试类似[HXTT](http://www.hxtt.com/text.html)

# sql-server - 在不知道约束名称的情况下删除外键？

> ID：824584
> 
> 赞同：35
> 
> 时间：2009-05-05T12:09:51.337
> 
> 标签：sql-server

我使用以下命令创建了一个表：

```
create table Table1(
    Id int Not Null 
        Foreign key 
        references Table2(Id)  
        on delete cascade 
        on update cascade,
    UserName nvarchar(150),
    TimeInSeconds int Not Null 

    primary key(Id,TimeInSeconds)
); 
```

但现在我想删除外键。由于我没有给出我不能使用的约束名称：

```
Alter table <tablename>
drop foreign key <foreign key name> 
```

有什么办法吗？请帮忙。

* * *

## 回答 #1

> 赞同：33
> 
> 时间：2009-05-05T12:19:25.667

您可以在中找到约束的名称`INFORMATION_SCHEMA.TABLE_CONSTRAINTS`

```
select CONSTRAINT_NAME
from INFORMATION_SCHEMA.TABLE_CONSTRAINTS
where TABLE_NAME = 'Table1' 
```

* * *

## 回答 #2

> 赞同：31
> 
> 时间：2014-08-13T15:59:15.890

与 Ed's Answer 类似，但您可以使用它来根据表和列名选择键名。

这样，您可以在脚本中运行它，或者作为子查询来删除约束。

```
SELECT CONSTRAINT_NAME
FROM INFORMATION_SCHEMA.KEY_COLUMN_USAGE
WHERE TABLE_NAME =  'post'
AND COLUMN_NAME =  'userID' 
```

* * *

## 回答 #3

> 赞同：14
> 
> 时间：2015-08-06T22:40:36.337

由于我遇到了一些问题，因此扩展了答案。另外，我声明了 2 个外键，所以我添加了一个可选键来保留，如果它为空，它将被忽略：

```
declare @name varchar(255),
     @table varchar(255) = 'mytable',
     @column varchar(255) = 'mykeycolumn',
     @validkey varchar(255) =  'mykeyIwanttokeep'

SELECT @name = CONSTRAINT_NAME
FROM INFORMATION_SCHEMA.KEY_COLUMN_USAGE
WHERE TABLE_NAME = @table
    AND COLUMN_NAME =  @column
    AND (CONSTRAINT_NAME != @validkey or @validkey is null)

declare @sql varchar(1023) = 'alter table ' + @table + ' drop ' + @name 

exec (@sql) 
```

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2017-01-20T17:36:21.190

SQL Server 选项：

```
DECLARE @foreignkey varchar(100)
DECLARE @tablename varchar(100)
DECLARE @command nvarchar(1000)

DECLARE db_cursor CURSOR FOR
SELECT fk.name, t.name
FROM sys.foreign_keys fk
JOIN sys.tables t ON t.object_id = fk.parent_object_id
WHERE t.name IN (
    'table_1_name_here',
    'table_2_name_here'
)

OPEN db_cursor
FETCH NEXT FROM db_cursor INTO @foreignkey, @tablename
WHILE @@FETCH_STATUS = 0
BEGIN
    SELECT @command = 'ALTER TABLE ' + @tablename + ' DROP CONSTRAINT ' + @foreignkey
    EXECUTE(@command)
    FETCH NEXT FROM db_cursor INTO @foreignkey, @tablename
END
CLOSE db_cursor
DEALLOCATE db_cursor 
```

SQL 将您关心的表的所有约束选择到游标中，然后将它们一一删除。您只需要知道要从中删除它们的表的名称。

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2022-02-12T13:52:42.513

要删除外键，请使用以下命令：

1.  `SHOW CREATE TABLE table_name;`
2.  `ALTER TABLE table_name DROP FOREIGN KEY table_name_ibfk_3;` （“table_name_ibfk_3”是为未命名约束分配的约束外键名称）。它因人而异。
3.  `ALTER TABLE table_name DROP column_name`.

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2009-05-05T12:24:54.173

如果您只查看企业管理器/管理工作室中的表格，您将能够看到密钥列表并从那里删除它。

* * *

## 回答 #7

> 赞同：0
> 
> 时间：2019-10-11T19:34:50.970

**没关系，下面是 Postgres 语法。如果问题在标题中有 sql server 会更好，因为我没有注意到标签**

您还可以使用删除并重新添加父表上的主键`cascade`。这将删除引用该表的任何外键，而您无需知道外键名称。

```
ALTER TABLE parent_table
DROP CONSTRAINT 'pk_id' CASCADE

-- add back pk
ALTER TABLE parent_table
ADD CONSTRAINT 'pk_id' PRIMARY KEY (id) 
```

**警告：**您首先要检查所有依赖项，如果还有其他表，则需要添加回它们的外键。这确实允许您在添加外键时正确命名它们。由于阻塞事务，这种方法在高事务系统中也可能不可行。

* * *

## 回答 #8

> 赞同：-2
> 
> 时间：2012-02-29T16:42:29.363

你可以放：

**> 显示创建表表名；**

您将看到如何创建表...列、类型...等。你可以看到你的约束名称。

# c# - 如何映射集合 在NHibernate？

> ID：824587
> 
> 赞同：4
> 
> 时间：2009-05-05T12:10:20.447
> 
> 标签：c#, visual-studio-2008, nhibernate

我有一个类 Contact（基类），一个名为 Customer 的类和一个名为 Supplier 的类。客户和供应商类都派生自 Contact。

客户与订单有 0..n 关系。我想在客户上有一个 Collection 属性，并将其在 NHibernate 中映射到其相应的表。

这是如何在 NHibernate（版本 2.0.1 GA）中完成的？

（ps：使用.NET 3.5 SP1，VS2008 SP1）

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2009-05-05T12:14:49.423

这样做是这样的：

像这样创建你的类：

```
public class Customer  : Contact
{
   private ISet<Order> _orders = new HashedSet<Order>();

   public Collection<Order> Orders
   {
      return new List<Order>(_orders);
   }

   // NOrmally I would return a ReadOnlyCollection<T> instead of a Collection<T>
   // since I want to avoid that users add Orders directly to the collection.
   // If your relationship is bi-directional, then you have to set the other
   // end of the association as well, in order to hide this for the programmer
   // I always create add & remove methods (see below)

   public void AddOrder( Order o )
   {
      if( o != null && _orders.Contains(o) == false )
      {
         o.Customer = this;
         _orders.Add(o);
      }
   }
} 
```

在您的映射中，您指定：

```
<set name="Orders" table="OrdersTable" access="field.camelcase-underscore" inverse="true">
   <key column="..." />
   <one-to-many class="Order" .. />
</set> 
```

既然你使用继承，你肯定应该看看 NHibernate 中关于继承映射的不同可能性，并选择最适合你情况的策略： [继承映射](http://www.nhforge.org/doc/nh/en/index.html#inheritance)

关于集合和包语义： - 当您将集合映射为集合时，您可以确定映射集合中的所有实体都是唯一的。也就是说，NHibernate 将确保在重构​​实例时，集合不会包含重复项。- 当您将集合映射为一个包时，当从数据库加载对象时，您的集合可能会多次包含相同的实体。

*   集合是被视为一个整体的不同对象的集合。一组（字母）的有效示例是：{ a, b, c, d }。每个字母只出现一次。
*   Bag 是集合的泛化。bag 的成员可以拥有多个成员资格，而 set 的每个成员只有一个成员资格。一个有效的袋子示例是 { a, a, a, b, c, c, d, ...}。字母 a 和 c 在 Bag 中出现了不止一次。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-05-05T13:04:16.387

如果您不喜欢使用 Iesi 集合中的集合，另一种解决方案

```
public class Customer  : Contact
{
   public ICollection<Order> Orders
   {
      get; private set;

   }
} 
```

像这样的映射：

```
<bag name="Orders" table="Customer_Orders" >
   <key column="Customer_FK" />
   <composite-element>
     <property name="OrderNumber" />
     <property name="OrderName" />
     <!-- ... -->
   </composite-element>
</set> 
```

# c# - 地址匹配密钥算法

> ID：824588
> 
> 赞同：6
> 
> 时间：2009-05-05T12:11:00.383
> 
> 标签：c#, algorithm, tsql, join, street-address

我在两个单独的表中有一个地址列表，这些表稍微偏离了我需要能够匹配的位置。例如，可以通过多种方式输入相同的地址：

*   110 测试街
*   110 测试街
*   110测试街

虽然很简单，但你可以想象更复杂的场景中的情况。我正在尝试开发一种简单的算法，该算法能够将上述地址作为密钥进行匹配。

例如。关键可能是“11TEST” - 110 的前两个，Test 的前两个和街头变体的前两个。完整匹配键还包括邮政编码的前 5 个，因此在上面的示例中，完整键可能看起来像“11TEST44680”。

我正在寻找一种有效算法或资源的想法，我可以在开发它时考虑考虑。任何想法都可以是伪代码或您选择的语言。

我们只关心美国地址。事实上，我们只查看来自俄亥俄州和密歇根州的 250 个邮政编码的地址。我们也无法使用任何邮政软件，尽管我们愿意接受具有成本效益的解决方案的想法（它基本上是一次性使用）。请注意，这是来自政府来源的数据的初始转储，因此在我构建应用程序时，有关用户如何清理它的建议很有帮助，但我希望通过能够匹配地址来获得最好的初始数据尽可能最好。

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2009-05-05T13:52:57.707

正如我们所说，我正在研究一个类似的算法，它应该在我完成时处理加拿大、美国、墨西哥和英国的地址。我面临的问题是它们以 3 字段明文格式在我们的数据库中 [恕我直言，认为*这*是个好主意的人应该被枪杀]，因此尝试处理农村路线、一般交付、大容量接收器、多个国家，省与州与县，邮政编码与邮政编码，拼写错误绝非易事。

仅拼写错误就不是一件小事 - 特别是当您到达使用法语名称的国家时 - 匹配 Saint、Sainte、St、Ste、Saints、Saintes、Sts、Stes、Grand、Grande、Grands、Grandes 有或没有句点或连字符名称的较大部分导致性能问题永无止境 - 特别是当 St 可能表示圣人*或*街道并且可能或可能未在正确的上下文中输入时（即女性与男性）。如果地址大部分输入正确但省份或邮政编码不正确怎么办？

开始搜索的一个地方是[**Levenstein 距离算法**](http://en.wikipedia.org/wiki/Levenstein_Distance)，我发现它对于消除大部分拼写错误非常有用。之后，主要是搜索关键字并与邮政数据库进行比较。

我真的很想与目前正在开发工具的任何人合作，也许我们可以互相帮助达成一个共同的解决方案。我已经是其中的一部分，并且已经克服了到目前为止我提到的所有问题，让其他人解决同样的问题将非常有助于激发想法。

干杯 - [本在 afsinc dot ca]

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2009-05-05T15:47:27.290

如果您不想开发一个，而是使用使用此处提到的许多技术的现成产品，请参阅：[http ://www.melissadata.com/dqt/matchup-api.htm](http://www.melissadata.com/dqt/matchup-api.htm)

*免责声明：我在公司的发展和工作中发挥了作用。*

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2009-05-05T12:22:04.460

在英国，我们会使用：

*   房屋名称或编号（其中名称包括公寓楼的单位编号）
*   邮政编码

您当然应该使用邮政编码，但在美国，与英国的邮政编码相比，我相信您的邮政编码覆盖的区域非常广泛。因此，您需要使用街道和城市。

您的示例不会区分 11 Test Street、110 - 119 Test Street 等。

如果您的公司可以访问地址查找系统，我将通过该系统运行所有数据，以便以一致的格式获取数据，可能带有可用于匹配的地址键。

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2009-05-05T13:45:08.457

如果我要对此进行破解，我会使用预定义的操作顺序将每个地址字符串转换为树。

例如。110 测试街 Apt 3\. 任何地方 加利福尼亚州 90210 =>

1.  获取地址类型。例如，街道地址与乡村路线地址有不同的格式，并且因国家/地区而异。
2.  鉴于这是一个街道地址，获取表示街道类型的字符串并将其转换为枚举（eBoulevard、eRoad 等）
3.  鉴于这是街道地址，提取街道名称（以小写形式存储）
4.  鉴于这是街道地址，请提取街道号码
5.  鉴于这是街道地址，请查找任何公寓号码（可以在带有破折号的街道号码之前，可以在“Apt.”之后，等等......）

    ```
     eStreet  //1.an enum of possible address types eg. eStreet, eRuralRoute,...
          |
       eStreet        //2.an enum of street types eg. eStreet, eBlvd, eWay,...
       /   |   \ 
    ```

    姓名号码 | | 测试 110 3

例如。RR#3 任何地方加利福尼亚 90210 =>

1.  获取地址类型：农村路线
2.  鉴于这是一个农村路由地址，获取路由号

    ```
     eRuralRoute 
          |
          3 
    ```

您需要对国家/地区和邮政编码信息执行类似的操作。

然后比较生成的树。

这使得比较非常简单，但是生成树的代码非常棘手。你会想在成千上万的地址上测试它的废话。如果您只关心美国地址，您的问题会更简单；已经提到的英国地址完全不同，加拿大地址中可能包含法语（例如 Place D'Arms、Rue Laurent 等......）

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2010-05-21T14:55:50.497

如果贵公司编写自己的地址规范化工具具有成本效益，那么我建议从[USPS 地址标准](http://pe.usps.com/cpim/ftp/pubs/Pub28/pub28.pdf)开始。或者，有许多供应商提供服务器端工具和 Web 服务来规范、更正和验证地址。

我的公司为此目的使用[AccuMail Gold](http://www.google.com/search?q=accumail%20gold)，因为它不仅仅是标准化和更正地址。当我们考虑到即使是一周工资的成本来开发内部工具时，购买现成产品的选择也是显而易见的。

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2009-05-05T12:29:35.347

如果您不选择使用现有系统，一个想法是执行以下操作：

*   从地址行中提取数字
*   用空格替换常见的街头单词
*   创建匹配字符串

即：“运河街 555 号”：

*   提取编号给出“555”+“运河街”
*   替换街道词给出“555”+“运河”
*   创建匹配字符串给出“555Canal”

“Canal st 555”会给出相同的匹配字符串。

街头词语是指您的语言中“street”的词语和缩写，例如“st”、“st.”、“blv”、“ave”、“avenue”等，所有这些都从字符串中删除。

通过提取数字并将它们从字符串中分离出来，它们是第一个还是最后一个都没有关系。

* * *

## 回答 #7

> 赞同：0
> 
> 时间：2009-05-05T13:56:11.723

**对主键使用标识**，这将始终是唯一的，并且以后合并重复项会更容易。

强制使用用户界面输入正确的数据。让他们在自己的文本框中输入每个组件。在自己的框中输入门牌号，在自己的框中输入街道名称，在自己的框中输入城市，从选择列表中输入州等。这将使查找匹配项更容易

有两个过程“保存”

*   初始保存后，进行搜索以查找匹配项，向它们提供可能匹配项的列表以及新的匹配项。
*   在他们选择新的保存后，如果他们选择现有的，则使用该 ID

清理数据。尝试去掉“street”、“st”、“drive”等，并将其存储为 StreetType char(1)，该字符使用 FK 到包含正确缩写的表中，以便您可以构建街道。

研究 SOUNDEX 和 DIFFERENCE

我曾在维护邮件列表的大公司工作过，他们并没有尝试自动完成，他们使用人员从重复中过滤掉新的，因为这很难做到。计划合并功能，以便您可以在重复出现时手动合并它们，并通过 PK 波动值。

您可能会查看 google maps api，看看您是否可以传入您的地址并获得匹配项。我不熟悉，这只是猜测。

# entity-framework - 如何将水晶报表绑定到实体框架？

> ID：824591
> 
> 赞同：6
> 
> 时间：2009-05-05T12:11:37.713
> 
> 标签：entity-framework, crystal-reports

如何将 Crystal Reports 绑定到实体框架实体？

我确实没有找到解决方法。

（而且我还没有足够的分数来对现有问题进行投票）

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2013-01-07T09:35:32.160

至于我，我阅读了下面的链接

[http://aspalliance.com/2049_Use_LINQ_to_Retrieve_Data_for_Your_Crystal_Reports.2](http://aspalliance.com/2049_Use_LINQ_to_Retrieve_Data_for_Your_Crystal_Reports.2)

它告诉我如何链接 EntityFramework 和 Crystal Report。

至于后面的代码......

```
 protected void Page_Load(object sender, EventArgs e)
 {
        Report.CrystalReport1 _Rpt = new Report.CrystalReport1();            

        List<Test> list_Test = new List<Test>();
        using (tempdbEntities _tempdbEntities = new tempdbEntities()) {
            list_Test = _tempdbEntities.Tests.ToList();
        }

        _Rpt.SetDataSource(list_Test);
        CrystalReportViewer1.ReportSource = _Rpt;
        CrystalReportViewer1.RefreshReport();

} 
```

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-03-16T11:43:14.160

创建水晶报表

您现在可以使用 XSD 文件创建报告。

1.  右键单击项目并选择 AddàNew Item...</p>

2.  从 Visual C# 模板列表中选择“Reporting”，然后选择 Crystal Reports 模板。

3.  将文件名更改为 UserAccountReport.rpt 并单击添加按钮。

4.  将出现 Crystal Reports 库对话框。选择“作为空白报告”并单击“确定”按钮。

5.  在 Field Explorer 窗口中，右键单击 Database Fields 节点并从弹出菜单中选择“Database Expert...”。

6.  应出现“数据库专家”对话框。

7.  单击“创建新连接”旁边的加号

8.  单击“ADO.NET (XML)”旁边的加号

9.  应出现 ADO.NET (XML) 对话框。单击带有三个点的按钮以浏览到您在上述步骤中创建的 UserAccountSchema.xsd 文件。

10.  单击完成按钮。

11.  您应该在 ADO.NET (XML) 节点下看到 UserAccountSchema。单击此节点，然后单击“>”按钮将其移至 Selected Tables 列表。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2009-05-05T17:41:45.050

不确定你的问题。

我知道这对你现在没有帮助（对不起）......

但是，您可能会觉得有趣的是，EF 和 Sql Reporting Services 团队的长期目标之一是允许客户针对实体框架模型（或 EDM）使用 Reporting Services。

# http - 无法终止隔离适配器中的 BizTalk 实例

> ID：824596
> 
> 赞同：4
> 
> 时间：2009-05-05T12:13:38.210
> 
> 标签：http, adapter, biztalk, messages, biztalk2006r2

谁能解释我如何删除服务实例？
- 我有一些 BizTalk 控制台显示为“正在运行”
- 它们都在隔离适配器中
- 尝试使用完全停止选项执行停止...
- 尝试终止实例选项...
- 甚至尝试删除BizTalk 应用程序

但他们还在那里？？

* * *

*我的错，应用程序删除确实删除了它们，一定是忘记刷新了*

* * *

事件日志有错误...

*接收位置“/foanite/BTSHTTPReceive.dll”的“HTTP”适配器的请求响应在可以传递响应之前超时。*

但我仍然不明白为什么终止不起作用

* * *

## 回答 #1

> 赞同：9
> 
> 时间：2009-05-29T11:35:36.267

如果您在隔离主机中运行接收位置，通常需要执行*iisreset*才能删除它们。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2018-09-13T09:24:52.310

如果 IISReset 没有帮助（通常没有帮助），则使用 BizTalk Health Monitor。

*   从左侧和树状视图中选择“维护”
*   对于任务类型，选择“删除”和“终止单个实例（硬终止）”
*   粘贴从 BizTalk 管理控制台获取的实例 ID
*   点击“执行任务”

# sql-server - 帮助查找从最后两条记录返回的值的差异（增量）

> ID：824597
> 
> 赞同：0
> 
> 时间：2009-05-05T12:13:58.910
> 
> 标签：sql-server, common-table-expression

我正在使用 MS SQL 2005，并创建了一个 CTE 查询来返回最后两条记录的值。然后我用它来查找返回的两个数字的增量。我有各种各样的工作查询，但我在获取除 delta 数字之外的任何内容时遇到问题。

这是我的查询：

```
;with data as(
    SELECT 
        NetObjectID,
        RawStatus,
        RowID,
        rn 
    from(   
        SELECT 
            CustomPollerAssignmentID AS NetObjectID,
            RawStatus,
            RowID,
            row_number() over(order by DateTime desc)as rn 
        FROM CustomPollerStatistics_Detail 
        WHERE
            (CustomPollerAssignmentID='a87f531d-4842-4bb3-9d68-7fd118004356')
    ) x where rn<=2
)
SELECT 
    case when 
        max(case rn when 1 then RawStatus end) > max(case rn when 2 then RawStatus end) 
    then 
        max(case rn when 1 then RawStatus end) - max(case rn when 2 then RawStatus end) 
    else 
        max(case rn when 2 then RawStatus end) - max(case rn when 1 then RawStatus end) 
    end as Delta
from data having 
(SELECT 
    case when 
        max(case rn when 1 then RawStatus end) > max(case rn when 2 then RawStatus end) 
    then 
        max(case rn when 1 then RawStatus end) - max(case rn when 2 then RawStatus end) 
    else 
        max(case rn when 2 then RawStatus end) - max(case rn when 1 then RawStatus end) 
    end
from data) >= 1 
```

我所追求的是返回 Delta 和 NetObjectID。每次我尝试，我都会得到错误。 `data.NetObjectID is invalid in the select list because it is not contained in either an aggregate function or the group by clause.`

如果我尝试将 group by 等添加到查询的末尾，我会收到更多错误，抱怨“组”这个词。

我对 SQL 比较陌生，我边走边学。任何帮助将不胜感激。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2009-05-05T12:23:41.820

抱歉，我在这里很新，我不确定 CTE 查询，但是看起来在您定义数据之后，您正在选择 case ... as Delta FROM...。这意味着您的选择语句中只有 Delta。再次，对不起，如果我离基地很远。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-05-05T13:56:32.533

看看这样的事情是否可行。

```
;with data as
(    
    SELECT         
        NetObjectID,        
        RawStatus,        
        RowID,        
        rn     
    from
    (               
        SELECT                 
            CustomPollerAssignmentID AS NetObjectID,                
            RawStatus,                
            RowID,                
            row_number() over(order by DateTime desc)as rn         
        FROM CustomPollerStatistics_Detail         
        WHERE                
        (
            CustomPollerAssignmentID='a87f531d-4842-4bb3-9d68-7fd118004356'
        )    
    ) x 
    where rn<=2
)
select
    NetObjectID,
    max(RawStatus)-min(RawStatus) as Delta
from data
group by NetObjectID 
```

# jboss - Jboss 5.0 EJB 3.0 异步代理

> ID：824598
> 
> 赞同：1
> 
> 时间：2009-05-05T12:14:14.993
> 
> 标签：jboss, asynchronous, ejb

在 [http://www.java2s.com/Code/Java/EJB3/EJBtutorialfromJBossAsynchronouscall.htm](http://www.java2s.com/Code/Java/EJB3/EJBtutorialfromJBossAsynchronouscall.htm) 我找到了一个示例，展示了如何以异步方式调用 ejb 方法。您是否在 Jboss AS 上的 EJB 3.0 中使用异步代理，它是否可以正常工作？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2010-05-13T20:39:22.283

这取决于版本。最新版本的 jboss ejb jar 不适用于链接的示例。
见： http: [//www.mastertheboss.com/en/jboss-server/219-ejb-31-tutorial.html](http://www.mastertheboss.com/en/jboss-server/219-ejb-31-tutorial.html) [http://javahowto.blogspot.com/2010/03/simple-asynchronous-methods-in-ejb -31.html](http://javahowto.blogspot.com/2010/03/simple-asynchronous-methods-in-ejb-31.html)

# vbscript - 1 vbs 中的 2 个命令有问题

> ID：824599
> 
> 赞同：-1
> 
> 时间：2009-05-05T12:14:28.160
> 
> 标签：vbscript

我对一个简单的 vbScript 有一点问题。该脚本必须一个接一个地运行 2 个动作。

```
Option Explicit

Dim WshShell
Dim Yesterday
Dim resultat
Dim commande
Dim Jour

Set WshShell = WScript.CreateObject("WScript.Shell")

Yesterday =  DateAdd("d", -2, Date())
resultat = "00001"
resultat = resultat & Right(Year(Yesterday), 2)
Jour = (Datepart("y", Yesterday))

If ((Jour < 100) and (Jour > 9)) Then resultat = resultat & "0" & Jour

If (Jour < 10) Then resultat = resultat & "00" & Jour

If (Jour >= 100) Then resultat = resultat & Jour

resultat = """(&(objectClass=eTGlobalUser)(eTSuspended=0)(eTRoleDN=*)(eTUpdateDate>=" & resultat & "))"""

commande = GetScriptPath() & "PharosGDH.exe /ldapfilter:" & resultat & " /conso"
WshShell.Run commande, 5, true
commande2 = GetScriptPath() & "PharosGDH.exe /all /auditPharos
WshShell.Run commande2, 5, true
WScript.Quit 1

Function GetScriptPath()
    GetScriptPath = Left(WScript.ScriptFullName, InStrRev(WScript.ScriptFullName, "\"))
End Function 
```

有人可以告诉我有什么问题吗？

抱歉，副本/过去缺少声明，并且 Windows 只是默默地关闭，之后我看到结果不是它应该是的！

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-05-05T12:32:17.477

这是您的实际代码吗？其中至少有两个语法错误：

第一个语法错误：

```
commande2 = GetScriptPath() & "PharosGDH.exe /all /auditPharos 
```

行尾缺少双引号：

```
commande2 = GetScriptPath() & "PharosGDH.exe /all /auditPharos" 
```

第二个语法错误：

```
Dim resultat
Dim commande
Dim Jour 
```

使用了变量“commande2”，但未声明。采用：

```
Dim resultat
Dim commande
Dim commande2
Dim Jour 
```

如果这不能解决您的问题，正如其他人所说，请告诉我们，问题是什么：错误消息？错误的行为？

# 第二次尝试

也许在执行它们之前显示使用的命令，以便能够检查它们是否包含正确的内容：

```
commande = GetScriptPath() & "PharosGDH.exe /ldapfilter:" & resultat & " /conso"
WshShell.Popup commande
WshShell.Run commande1, 5, true
commande2 = GetScriptPath() & "PharosGDH.exe /all /auditPharos"
WshShell.Popup commande
WshShell.Run commande2, 5, true
WScript.Quit 1 
```

# java - 保存双向多对多

> ID：824600
> 
> 赞同：11
> 
> 时间：2009-05-05T12:14:35.977
> 
> 标签：java, jpa

我有两个以以下方式注释的实体类

```
@Entity
class A {
   @ManyToMany(mappedBy="A", cascade=CascadeType.ALL)
   private List<B> b;
 ..
}

@Entity
class B {
   @ManyToMany(cascade=CascadeType.ALL)
   private List<A> a;
 ..
} 
```

如果我存储“B”类的实例，则关系存储在数据库中，“A”类中的 getter 将返回 B 的正确子集。但是，如果我对“A”中的 B 列表进行更改，这些更改不会存储在数据库中吗？

我的问题是，我怎样才能使任一类的更改“级联”到另一个类？

编辑：我尝试了删除 mappedBy 参数和定义 JoinTable（和列）的不同变体，但我一直无法找到正确的组合。

* * *

## 回答 #1

> 赞同：16
> 
> 时间：2009-05-21T20:20:43.610

最短的答案似乎是你不能，这是有道理的。在双向多对多关联中，一侧必须为主，用于将更改持久化到基础连接表。由于 JPA 不会维护关联的双方，因此您最终可能会遇到一旦存储在数据库中就无法重新加载的内存情况。例子：

```
A a1 = new A();
A a2 = new A();
B b = new B();
a1.getB().add(b);
b.getA().add(a2); 
```

如果可以保持此状态，您将在连接表中得到以下条目：

```
a1_id, b_id
a2_id, b_id 
```

但是在加载时，JPA 怎么知道您打算只让 b 知道 a2 而不是 a1 ？那不应该知道 b 的 a2 呢？

这就是为什么您必须自己维护双向关联（并且即使在内存中也无法访问上述示例）并且 JPA 将仅根据其一侧的状态持续存在。

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2009-05-05T14:00:25.113

您是否指定了反向连接列？

```
@Entity
class A {
   @ManyToMany(mappedBy="A", cascade=CascadeType.ALL)
   private List <B> b;
   ..
}

@Entity 
class B { 
   @ManyToMany 
   @JoinTable (
       name="A_B",
       joinColumns = {@JoinColumn(name="A_ID")},
       inverseJoinColumns = {@JoinColumn(name="B_ID")}
   )
   private List<A> a; 
   .. 
} 
```

假设有一个名为 A_B 的连接表，其中包含 A_ID 和 B_ID 列。

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2012-08-24T23:45:26.717

> 由于关系是双向的，因此应用程序更新关系的一侧，另一侧也应该得到更新，并保持同步。在 JPA 中，就像在 Java 中一般**，维护关系是应用程序或对象模型的责任。**如果您的应用程序添加到关系的一侧，那么它必须添加到另一侧。
> 
> 这可以通过处理双方关系的对象模型中的 add 或 set 方法来解决，因此应用程序代码无需担心。有两种方法可以解决这个问题，您可以仅将关系维护代码添加到关系的一侧，并且仅使用一侧的setter（例如使另一侧受保护），或者将其添加到双方并确保避免无限循环。

资料来源：[OneToMany#Getters_and_Setters](http://en.wikibooks.org/wiki/Java_Persistence/OneToMany#Getters_and_Setters)

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2009-05-05T12:24:18.183

您是否尝试过像这样将 mappedBy 参数添加到 B 类的 A 字段中

```
@Entity
class B {
   @ManyToMany(cascade=CascadeType.ALL, mappedBy = "b")
   private List<A> a;
 ..
} 
```

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2010-04-27T09:03:47.920

A_M的回答可能有一个小错误。在我看来应该是：

```
   @实体
   B类{
   @ManyToMany
   @JoinTable (
       名称="A_B",
       joinColumns = {@JoinColumn(name="B_ID")},
       inverseJoinColumns = {@JoinColumn(name="A_ID")}
   )
   私人名单a；
   ..
}

```

# .net - C# 设计器中的用户控件显示错误

> ID：824613
> 
> 赞同：0
> 
> 时间：2009-05-05T12:18:06.793
> 
> 标签：.net, visual-studio-2008, user-controls

我在 C# (ASP.NET) 设计器中创建了一个用户控件。它工作正常（当我编译/运行时）并且不会出现任何错误。我在 GridView 中使用它，如果这有区别的话。

有时，当我在设计器中（针对页面，而不是控件）时，它会给我一个红色框并告诉我它无法显示用户控件。切换到源视图然后返回到设计器（通常可以解决此类问题）不起作用，但关闭并重新打开 VS（2008 Professional）可以。

这不是一个大问题，但它很烦人。关于这里可能发生的事情或我能做些什么的任何想法？

谢谢。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-05-05T12:21:23.807

我在继承表单或用户控件时遇到了同样的问题，似乎 Visual Studio 在继承方面遇到了问题，特别是深度继承

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-05-05T12:51:44.733

关闭设计器视图并重新打开它怎么样，之后它会起作用吗？如果所有成员变量都没有初始化，我就会遇到这样的问题。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2009-05-05T12:54:20.607

听起来正在发生的事情是有几个用户遇到了错误，但还没有报告。因此，微软没有修复它。

结果是更多的用户遇到了这个错误，但不报告它......

如果您有可重现的错误，请创建一个能够可靠重现它的小样本，然后在[http://connect.microsoft.com/visualstudio/](http://connect.microsoft.com/visualstudio/)提交错误报告。

否则，其他人会遇到该错误，...

# php - htmlspecialchars 的问题

> ID：824622
> 
> 赞同：1
> 
> 时间：2009-05-05T12:20:41.717
> 
> 标签：php, javascript

我正在从以下 php 代码生成链接。链接出现在浏览器中，生成的 html 代码看起来不错，但是链接不可点击。我已经在 IE 和 FF 中对此进行了测试，并尝试使用 FireBug 进行查看，但无济于事。

生成我的表单的代码

```
$uploadhtml = htmlspecialchars(json_encode("<form action='up.php' method='post'
enctype='multipart/form-data'>
<label for='file'>Filename:</label>
<input type='file' name='file' id='file'/> 
<br />
<input type='hidden' name='pk' value='".$pk."'>
<input type='hidden' name='username' value='".$USERNAME."'>
<input type='submit' name='submit' value='Submit' onclick=\"setTimeout(function() { 
updateByPk('Layer2', '".$pk."', '".$brand."', '".$pg."'); } ),1250);\" />
</form>"), ENT_QUOTES); 
```

生成的html代码：

```
 <a onclick="makewindows(&#39;&quot;<form action=&#39;up.php&#39; method=&#39;
post&#39;\r\nenctype=&#39;multipart\/form-data&#39;>\r\n<label for=&#39;
`file&#39;>Filename:<\/label>\r\n<input type=&#39;file&#39; name=&#39;file&#39; id=&#39;`file&#39;\/> \r\n<br \/>\r\n<input type=&#39;hidden&#39; name=&#39;pk&#39; value=&#39;
380118179930&#39;>\r\n<input type=&#39;hidden&#39; name=&#39;username&#39; value=&#39;
janmaybach&#39;>\r\n<input type=&#39;submit&#39; name=&#39;submit&#39; value=&#39;
Submit&#39; onclick=\&quot;setTimeout(function() { updateByPk(&#39;Layer2&#39;, 
&#39;380118179930&#39;, &#39;Ed Hardy&#39;, &#39;1&#39;); } ),1250);\&quot; 
\/>\r\n<\/form>&quot;&#39;); return false;" href="#">Upload files</a> 
```

我想这是一个 JavaScript 错误，但我不知道如何查明它？

编辑：没有 ENT_QUOTES 的 html 代码：

```
<a href="#" onclick="makewindows('&quot;<form action='up.php' method='post'\r
\nenctype='multipart\/form-data'>\r\n<label for='file'>Filename:<\/label>\r\n<input 
type='file' name='file' id='file'\/> \r\n<br \/>\r\n<input type='hidden' name='pk' 
value='380118185183'>\r\n<input type='hidden' name='username' value='janmaybach'>\r
\n<input type='submit' name='submit' value='Submit' onclick=\&quot;setTimeout(function() 
{ updateByPk('Layer2', '380118185183', 'Ed Hardy', '1'); } ),1250);\&quot; 
\/>\r\n<\/form>&quot;'); return false;">Upload files</a> 
```

它仍然不可点击......，一切似乎都被正确引用了？

当我尝试不使用 htmlspecial 字符时，会生成以下 html 输出：

```
<input type='submit' name='submit' value='Submit' onclick=" settimeout(function()="" {="" updatebypk(="" layer2="" 380118179930="" ed="" hardy="" ,="" 1="" );="" }="" ),1250);="">
'); return false;"&gt;Upload files</a> 
```

* * *

## 回答 #1

> 赞同：13
> 
> 时间：2009-05-05T12:29:52.850

正如对问题的评论中所说，这绝对是可怕的代码，你正在承受后果。主要问题是代码级别的数量：呈现 Javascript 的服务器代码，呈现 HTML 的服务器代码 - 并且差异在每个级别都出现并相互干扰。

为了改善这种情况，有一个单独的带有表单的 PHP 页面，并让您的弹出链接打开该页面 - 不需要 Javascript。如果您真的想不惜一切代价避免拥有该单独的页面，至少要有在页面标题（非动态）中生成表单的Javascript函数，并且链接仅包含对该函数的调用，其中您的变量为参数。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-05-05T12:25:54.857

您的函数中的参数`makewindows`未引用。您的引号已转义 ( `%#39`)。替换它，`'`你就完成了。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2009-05-05T12:30:30.603

您的 ENT_QUOTES 标志搞砸了输出。如果您仔细观察，您会发现 HTML 输出中没有实际的引号 - 只是转义的实体。做一个不使用 htmlspecialchars() 的测试。您应该使用反斜杠转义引号，或者最好还是不显眼地添加 javascript 功能。jQuery 可能会帮助您实现这一目标[http://jquery.com](http://jquery.com)

# .net - .Net 正则表达式崩溃 aspnet_wp.exe

> ID：824626
> 
> 赞同：1
> 
> 时间：2009-05-05T12:22:51.743
> 
> 标签：.net, regex

我遇到了以下问题，想知道是否有人能明白为什么这会导致我的 .net 工作进程（aspnet_wp.exe）崩溃：

```
 Dim pattern As String = "\{\{IF\(((?!\)}})(.))+,,,((\s)*(?!\)}})(.))+\)}}"
  Dim mc As RegularExpressions.MatchCollection = Regex.Matches(txtContent.Text, pattern) 
```

如果找到匹配项，则绝对可以正常工作，例如

```
<h3>Title</h3>
<p>Top paragraph.</p>

{{IF(1=2,,, <p></p>)}} 
```

但是，如果没有找到匹配项，它似乎会钉住我的 cpu 并运行很长一段时间，例如，如果在最后两个花括号之前缺少最后一个括号：

```
<h3>Title</h3>
<p>Top paragraph.</p>

{{IF(1=2,,, <p></p>}} 
```

是不是太贪心了，一直在寻找！？谢谢！

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2009-05-05T12:40:43.853

问题很容易识别：[“灾难性回溯”](http://www.regular-expressions.info/catastrophic.html)。

每次你看到“如果匹配存在，它就起作用，如果不存在匹配则永远存在”的现象，你可以确定这是原因。

我建议使用不同的正则表达式来减少回溯。[原子分组](http://www.regular-expressions.info/atomic.html)有助于将回溯步骤保持在最低限度：

```
Dim pattern As String = "\{\{IF\((?>(?:(?!,,,).)+),,,(?>(?:(?!\)\}\}).)+)\}\}"
Dim mc As RegularExpressions.MatchCollection = Regex.Matches(txtContent.Text, pattern) 
```

模式（不知道我是否捕获了您需要的所有内容 - 在您认为合适的地方添加括号）：

```
\{\{IF\(                # "{{IF("
(?>(?:(?!,,,).)+)       # atomic group: any char up to the ",,,"
,,,                     # ",,,"
(?>(?:(?!\)\}\}).)+)    # atomic group: any char up to the ")}}"
\)\}\}                  # ")}}" 
```

# wxpython - wxpython ogl 包拖动事件

> ID：824628
> 
> 赞同：2
> 
> 时间：2009-05-05T12:23:52.037
> 
> 标签：wxpython, wxwidgets

我正在 wxpython 中测试 ogl 包。

我想拖动一个形状。当我拖动它时，我希望第二个形状同时移动。问题是我没有找到移动/拖动事件。仅移动前和移动后事件。

我能想到的唯一解决方案是隐藏第二个形状，并在拖动完成后在新位置重新绘制它。

ogl 包是否不再维护？

欧尔扬·彼得森

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2009-05-05T13:44:02.937

在 2.8 版之前，OGL 是wxWidgets中的*contrib目录的一部分；**contrib*已在主干中删除，不再是 wxWidgets 的一部分。[您现在可以在 wxCode](http://wxcode.sourceforge.net/showcomp.php?name=ogl)上找到OGL ，但它的状态也显示为未维护。

如果您还没有开始使用 OGL，最好不要这样做。

# windows - 用于报告按键的 Windows 程序

> ID：824631
> 
> 赞同：0
> 
> 时间：2009-05-05T12:24:07.730
> 
> 标签：windows, debugging, keyboard, virtualization, keypress

**问题：**我在虚拟机和时髦的键盘设置中使用 Windows 作为客户操作系统。我需要一种方法来解决键盘热键组合无法正常工作的情况。

**问题：**有没有人知道当我在已安装的键盘上按下某个键或组合键时，它可以快速轻松地在屏幕上显示按键窗口所认为的内容？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-05-05T12:29:53.770

[**键盘绝地**](http://weblogs.asp.net/rosherove/archive/2007/06/03/train-to-be-a-keyboard-master-with-keyboard-jedi.aspx)看起来像它会做你所追求的。

# c# - 实体框架中的同表关系

> ID：824635
> 
> 赞同：9
> 
> 时间：2009-05-05T12:25:48.460
> 
> 标签：c#, entity-framework

是否可以将表映射到自身的关联？

例如

```
Table:  
ConditionId  
ConditionName 
... 
...  
ParentConditionId 
```

我们可以有许多 ParentConditionId，每个映射到相同的 ConditionId。

我尝试了一对多映射，但是当没有孩子时出现错误。

* * *

## 回答 #1

> 赞同：16
> 
> 时间：2009-05-05T13:47:16.690

是的，有可能。将 FK 放入您的数据库中，向导将正确映射它。确保 ParentConditionId 可以为空。

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2009-05-05T15:23:12.560

看看可以在[这里](http://weblogs.asp.net/zeeshanhirani/archive/2008/12/18/my-christmas-present-to-the-entity-framework-community.aspx)下载的教程。它详细解释了如何建模自引用表。

# c# - ASP.NET C# OnMouseOver 事件使 ListBox 出现和消失

> ID：824636
> 
> 赞同：1
> 
> 时间：2009-05-05T12:25:52.750
> 
> 标签：c#, asp.net, listbox, visibility, onmouseover

我有一个包含列表框和按钮的网络表单。当 onmousover 事件触发时，列表框会出现；但是在页面加载时，列表框不应该是可见的。我有以下代码（请原谅背景颜色的变化）：

```
Button2.Attributes.Add("onmouseout", 
                       "this.style.backgroundColor='Blue', 
                       ListBox3.style.display ='none'");
Button2.Attributes.Add("onmouseover", 
                       "this.style.backgroundColor='Red',
                       ListBox3.style.display='block'"); 
```

此代码在 listbox.visible 设置为 true 时有效。不幸的是，当页面加载时，列表框总是可见的，这是我想要避免的。当我将列表框设置为可见 = false 时，上面的代码不起作用。我搞砸了回发并使用了 if 语句，例如 if (button = red), display=block; 然而，无济于事。我被困在这一点上。有谁知道我需要做些什么才能使上述代码正常工作？我是 ASP.NET 的新手，所以我不知道我是否还必须对 html 做一些事情。另外，有趣的一点是，代码的背景色部分完美无缺。

我真的很感谢大家的帮助。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2009-05-05T12:32:33.437

在服务器端代码中设置 Listbox visible="false" 时，不会呈现列表框的 HTML 并将其发送到客户端。因此，您需要确保列表框被呈现，但设置为在页面加载时不可见，或者通过

*   具有使列表框不可见的初始 CSS 样式

或者

*   在 DOM 加载后，使用客户端上的 JavaScript 将其设置为不可见。

另请查看此[显示与可见性文章](http://www.devx.com/tips/Tip/13638)

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-05-05T13:18:35.573

您可以使用 jQuery javascript 库轻松完成此操作。

而不是你的代码，你会有类似的东西：

```
$('#buttonid').hover(function(){
   $(this).css('background','blue');
   $('#listboxid').hide('fast');
}, function(){
   $(this).css('background','red');
   $('#listboxid').show('fast');
}); 
```

悬停的第一个功能是鼠标悬停，第二个功能是鼠标悬停。您还可以对其显示和隐藏进行动画处理，使其看起来更流畅。

# macros - 可变递归预处理器宏 - 有可能吗？

> ID：824639
> 
> 赞同：46
> 
> 时间：2009-05-05T12:26:20.910
> 
> 标签：macros, c-preprocessor

我遇到了一个小小的理论问题。在我维护的一段代码中，有一组宏，例如

```
#define MAX_OF_2(a, b)       (a) > (b) ? (a) : (b)
#define MAX_OF_3(a, b, c)    MAX_OF_2(MAX_OF_2(a, b), c)
#define MAX_OF_4(a, b, c, d) MAX_OF_2(MAX_OF_3(a, b, c), d)
...etc up to MAX_OF_8 
```

我想做的是用这样的东西替换它们：

```
/* Base case #1, single input */
#define MAX_OF_N(x)      (x)

/* Base case #2, two inputs */
#define MAX_OF_N(x, y)   (x) > (y) ? (x) : (y)

/* Recursive definition, arbitrary number of inputs */
#define MAX_OF_N(x, ...) MAX_OF_N(x, MAX_OF_N(__VA_ARGS__)) 
```

...当然，这不是有效的预处理器代码。

*忽略这种特殊情况可能应该使用函数而不是预处理器宏来解决*，是否可以定义可变参数 MAX_OF_N() 宏？

为清楚起见，最终结果应该是一个宏，它接受任意数量的参数并计算出其中最大的一个。我有一种奇怪的感觉，这应该是可能的，但我不知道如何。

* * *

## 回答 #1

> 赞同：45
> 
> 时间：2011-02-19T03:31:18.117

可以编写一个宏来计算调用它的参数数量。（我找不到第一次看到它的地方的链接。）所以你可以编写 MAX_OF_N() ，它可以随心所欲地工作，但你仍然需要所有编号的宏，直到某个限制：

```
#define MAX_OF_1(a)         (a)         
#define MAX_OF_2(a,b)       max(a, b)

#define MAX_OF_3(a,...)    MAX_OF_2(a,MAX_OF_2(__VA_ARGS__))
#define MAX_OF_4(a,...)    MAX_OF_2(a,MAX_OF_3(__VA_ARGS__))
#define MAX_OF_5(a,...)    MAX_OF_2(a,MAX_OF_4(__VA_ARGS__))
...
#define MAX_OF_64(a,...)   MAX_OF_2(a,MAX_OF_63(__VA_ARGS__))

// NUM_ARGS(...) evaluates to the literal number of the passed-in arguments.
#define _NUM_ARGS2(X,X64,X63,X62,X61,X60,X59,X58,X57,X56,X55,X54,X53,X52,X51,X50,X49,X48,X47,X46,X45,X44,X43,X42,X41,X40,X39,X38,X37,X36,X35,X34,X33,X32,X31,X30,X29,X28,X27,X26,X25,X24,X23,X22,X21,X20,X19,X18,X17,X16,X15,X14,X13,X12,X11,X10,X9,X8,X7,X6,X5,X4,X3,X2,X1,N,...) N
#define NUM_ARGS(...) _NUM_ARGS2(0, __VA_ARGS__ ,64,63,62,61,60,59,58,57,56,55,54,53,52,51,50,49,48,47,46,45,44,43,42,41,40,39,38,37,36,35,34,33,32,31,30,29,28,27,26,25,24,23,22,21,20,19,18,17,16,15,14,13,12,11,10,9,8,7,6,5,4,3,2,1,0)

#define _MAX_OF_N3(N, ...) MAX_OF_ ## N(__VA_ARGS__)
#define _MAX_OF_N2(N, ...) _MAX_OF_N3(N, __VA_ARGS__)
#define MAX_OF_N(...)      _MAX_OF_N2(NUM_ARGS(__VA_ARGS__), __VA_ARGS__) 
```

现在`MAX_OF_N(a,b,c,d,e)`将评估为`max(a, max(b, max(c, max(d, e))))`. （我已经在 gcc 4.2.1 上测试过。）

请注意，基本情况 ( `MAX_OF_2`) 在展开式中不会多次重复其参数（这就是我`max`在此示例中放置的原因），这一点至关重要。否则，每个级别的扩展长度都会加倍，因此您可以想象使用 64 个参数会发生什么:)

* * *

## 回答 #2

> 赞同：13
> 
> 时间：2009-05-05T13:06:27.583

您可能会考虑这种作弊，因为它不是递归的，并且不会在预处理器中完成工作。它使用 GCC 扩展。它只适用于一种类型。然而，它是一个可变参数 MAX_OF_N 宏：

```
#include <iostream>
#include <algorithm>

#define MAX_OF_N(...) ({\
        int ra[] = { __VA_ARGS__ }; \
        *std::max_element(&ra[0], &ra[sizeof(ra)/sizeof(int)]); \
    })

int main() {
    int i = 12;
    std::cout << MAX_OF_N(1,3,i,6);
} 
```

哦，是的，而且由于初始化器列表中的潜在变量表达式，我认为在 C89 中不能使用它的等效项（使用它自己的函数来避免 std::max_element）。但我也不确定可变参数宏是否在 C89 中。

这是我认为绕过“只有一种类型”限制的东西。不过，它变得有点毛茸茸：

```
#include <iostream>
#include <algorithm>

#define MAX_OF_N(x, ...) ({\
        typeof(x) ra[] = { (x), __VA_ARGS__ }; \
        *std::max_element(&ra[0], &ra[sizeof(ra)/sizeof(ra[0])]); \
    })

int main() {
    int i = 12;
    std::cout << MAX_OF_N(i+1,1,3,6,i);
} 
```

* * *

## 回答 #3

> 赞同：12
> 
> 时间：2009-05-05T12:29:35.317

不，因为预处理器只对文件进行一次“滑动”。没有办法让它递归地定义宏。

我见过的唯一代码*不是*可变参数，而是使用用户必须传递的默认值：

```
x = MAX_OF_8 (a, b, -1, -1, -1, -1, -1, -1) 
```

假设所有值都是非负的。

内联函数至少应该为 C++ 提供相同的功能。正如您所说，最好留给具有类似于`printf()`.

* * *

## 回答 #4

> 赞同：7
> 
> 时间：2009-05-21T16:00:23.947

我认为，即使你可以递归地扩展宏，你的方法在效率方面也会有一点问题......当宏被扩展时，如果`MAX_OF_[N-1]`更大，那么你必须从头开始重新评估它。

这是一个愚蠢而愚蠢的答案，可能没有人会喜欢 xD

## 文件“source.c”

```
#include "my_macros.h"
... 
```

## 文件“生成文件”

```
myprogram: source.c my_macros.h
 gcc source.c -o myprogram

my_macros.h: make_macros.py
 python make_macros.py > my_macros.h 
```

## 文件“make_macros.py”

```
def split(l):
    n = len(l)
    return l[:n/2], l[n/2:]

def gen_param_seq(n):
    return [chr(i + ord("A")) for i in range(n)]

def make_max(a, b):
    if len(a) == 1:
        parta = "("+a[0]+")"
    else:
        parta = make_max(*split(a))

    if len(b) == 1:
        partb = "("+b[0]+")"
    else:
        partb = make_max(*split(b))

    return "("+parta +">"+partb+"?"+parta+":"+partb+")"

for i in range(2, 9):
    p = gen_param_seq(i)
    print "#define MAX_"+str(i)+"("+", ".join(p)+") "+make_max(*split(p)) 
```

那么你将定义那些漂亮的宏：

```
#define MAX_2(A, B) ((A)>(B)?(A):(B))
#define MAX_3(A, B, C) ((A)>((B)>(C)?(B):(C))?(A):((B)>(C)?(B):(C)))
#define MAX_4(A, B, C, D) (((A)>(B)?(A):(B))>((C)>(D)?(C):(D))?((A)>(B)?(A):(B)):((C)>(D)?(C):(D)))
#define MAX_5(A, B, C, D, E) (((A)>(B)?(A):(B))>((C)>((D)>(E)?(D):(E))?(C):((D)>(E)?(D):(E)))?((A)>(B)?(A):(B)):((C)>((D)>(E)?(D):(E))?(C):((D)>(E)?(D):(E))))
#define MAX_6(A, B, C, D, E, F) (((A)>((B)>(C)?(B):(C))?(A):((B)>(C)?(B):(C)))>((D)>((E)>(F)?(E):(F))?(D):((E)>(F)?(E):(F)))?((A)>((B)>(C)?(B):(C))?(A):((B)>(C)?(B):(C))):((D)>((E)>(F)?(E):(F))?(D):((E)>(F)?(E):(F))))
#define MAX_7(A, B, C, D, E, F, G) (((A)>((B)>(C)?(B):(C))?(A):((B)>(C)?(B):(C)))>(((D)>(E)?(D):(E))>((F)>(G)?(F):(G))?((D)>(E)?(D):(E)):((F)>(G)?(F):(G)))?((A)>((B)>(C)?(B):(C))?(A):((B)>(C)?(B):(C))):(((D)>(E)?(D):(E))>((F)>(G)?(F):(G))?((D)>(E)?(D):(E)):((F)>(G)?(F):(G))))
#define MAX_8(A, B, C, D, E, F, G, H) ((((A)>(B)?(A):(B))>((C)>(D)?(C):(D))?((A)>(B)?(A):(B)):((C)>(D)?(C):(D)))>(((E)>(F)?(E):(F))>((G)>(H)?(G):(H))?((E)>(F)?(E):(F)):((G)>(H)?(G):(H)))?(((A)>(B)?(A):(B))>((C)>(D)?(C):(D))?((A)>(B)?(A):(B)):((C)>(D)?(C):(D))):(((E)>(F)?(E):(F))>((G)>(H)?(G):(H))?((E)>(F)?(E):(F)):((G)>(H)?(G):(H)))) 
```

最好的一点是......它有效^_^

* * *

## 回答 #5

> 赞同：5
> 
> 时间：2009-05-05T12:32:37.790

如果您在 C++ 中走这条路，请查看[模板元编程](http://aszt.inf.elte.hu/~gsd/halado_cpp/ch06s04.html)。它不漂亮，它可能无法解决您的确切问题，但它会处理递归。

* * *

## 回答 #6

> 赞同：4
> 
> 时间：2012-03-27T22:33:49.227

首先，宏不会递归扩展。虽然，宏可以通过为每个递归级别创建一个宏然后推导出递归级别来进行重入。但是，所有这些重复和推导递归都由[Boost.Preprocessor](http://www.boost.org/doc/libs/1_49_0/libs/preprocessor/doc/index.html)库处理。因此，您可以使用高阶折叠宏来计算最大值：

```
#define MAX_EACH(s, x, y) BOOST_PP_IF(BOOST_PP_GREATER_EQUAL(x, y), x, y)
#define MAX(...) BOOST_PP_SEQ_FOLD_LEFT(MAX_EACH, 0, BOOST_PP_VARIADIC_TO_SEQ(__VA_ARGS__)) 

MAX(3, 6, 8) //Outputs 8
MAX(4, 5, 9, 2) //Outputs 9 
```

现在，这将理解 0-256 之间的文字数字。它不适用于 C++ 变量或表达式，因为 C 预处理器不理解 C++。它只是纯文本替换。但是 C++ 提供了一种称为“函数”的功能，该功能适用​​于 C++ 表达式，您可以使用它来计算最大值。

```
template<class T>
T max(T x, T y)
{
    return x > y ? x : y;
}

template<class X, class... T>
auto max(X x, T ... args) -> decltype(max(x, max(args...)))
{
    return max(x, max(args...));
} 
```

现在，上面的代码确实需要 C++11 编译器。如果您使用 C++03，您可以创建函数的多个重载以模拟可变参数。此外，我们可以使用预处理器为我们生成这个重复的代码（这就是它的用途）。所以在 C++03 中，你可以这样写：

```
template<class T>
T max(T x, T y)
{
    return x > y ? x : y;
}

#define MAX_FUNCTION(z, n, data) \
template<class T> \
T max(T x, BOOST_PP_ENUM_PARAMS(n, T x)) \
{ \
    return max(x, max(BOOST_PP_ENUM_PARAMS(n, x)));\
}

BOOST_PP_REPEAT_FROM_TO(2, 64, MAX_FUNCTION, ~) 
```

* * *

## 回答 #7

> 赞同：0
> 
> 时间：2021-06-15T13:35:14.770

[这里](https://stackoverflow.com/a/13459454/2806862)有一个很好的递归示例

“hack”是在预处理器中设置一个中间步骤，使其认为在给定步骤中定义不会被其他任何东西替换。

# .net - 有人可以解释 DaylightSavingsRule 在“EndMonth”之后如何具有“StartMonth”吗？

> ID：824641
> 
> 赞同：1
> 
> 时间：2009-05-05T12:28:41.887
> 
> 标签：.net, timezone, dst

使用 C#（.NET 框架），我正在遍历所有 TimeZones 及其 AdjustmentRules... 并且对于“毛里求斯标准时间”{(GMT+04:00) Port Louis)} - 调整规则如下：

```
IsFixed = false;
DaylightTransitionStart.Month = 10;
DaylightTransitionEnd.Month = 1; 
```

据我了解，'IsFixed=false' 意味着我*不*使用“StartDate”和“EndDate”字段......但是，我需要使用 DaylightTransitionStart 和 End 来动态确定时间是在白天时间还是不是。

**这里的问题是，对于大约 30 个转换规则，“StartMonth”在“EndMonth”之后**

DaylightSavingsTime 如何从“2008 年 10 月”*开始*并在“2008 年 1 月”结束？

请帮助我理解这一点......一旦我克服了这个障碍，我应该有一个完整的“在任何时间与 UTC 之间转换，所有历史的任何时区”SQL 函数编写。

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2009-05-05T12:32:12.580

一段时间在逻辑上不可能在它开始之前结束，但也许你假设这些月份指的是同一年的月份，而实际上 OCT 可能是在 2008 年，而 JAN 是在 2009 年。

把它想象成一个循环链表。

[DaylightTime](http://msdn.microsoft.com/en-us/library/system.globalization.daylighttime_members.aspx)类使用[DateTime](http://msdn.microsoft.com/en-us/library/system.datetime.aspx)作为夏令时的开始和结束，因此都指定了一年。

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2009-05-05T12:32:14.390

赤道以南的国家不是这样吗？

* * *

## 回答 #3

> 赞同：3
> 
> 时间：2009-05-05T12:36:56.453

有个东西叫南半球。也许你听说过。

在澳大利亚，夏令时从 10 月左右开始，到 3 月左右结束（在有夏令时的州）。

* * *

## 回答 #4

> 赞同：2
> 
> 时间：2009-05-05T12:33:22.343

可能在南半球，DST 于 10 月开始，在澳大利亚的某些地区于 3 月结束

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2009-05-05T12:32:17.883

两个不同的年份。例如 09 年开始 10 年结束

# linux - 如何允许使用 SSH 将文件上传到主目录之外？

> ID：824647
> 
> 赞同：0
> 
> 时间：2009-05-05T12:30:13.490
> 
> 标签：linux, ssh

我正在运行 Fedora 8 Core 服务器。SSH 已启用，我可以在端口 22 上使用 Transmit（FTP 客户端）登录。登录后，我可以成功地将文件上传到用户主目录。在主目录之外，我只能浏览文件，不能上传/更改任何内容。如何允许将文件上传到用户主目录之外的特定目录？

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2009-05-05T12:34:59.640

一个简单的方法是授予用户对您希望他们能够上传到的文件夹的权限，然后从他们的主文件夹添加一个符号链接（链接 -s）到目标。

你也可以只使用

```
scp file user@server:/path 
```

这将允许您上传到您有权访问的任何目录

*   file 是要复制的文件
*   用户和服务器应该很明显
*   /path 是您有权访问的服务器上的任何目标路径；所以 /home/user/ 可能是您的默认主文件夹

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-05-05T12:33:28.863

您需要使这些目录可由适当的用户或（更容易）该用户的组写入。这当然是一个巨大的安全漏洞，所以要小心。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-05-05T12:35:34.973

您好，请授予 FTP 用户对您要上传文件的目录的写入权限。

# linq - 如何在linq to sql中获取第二条记录

> ID：824648
> 
> 赞同：18
> 
> 时间：2009-05-05T12:30:20.180
> 
> 标签：linq, linq-to-sql

我有一张汇率表。我需要获取当前汇率和以前的汇率，然后比较结果。

我可以使用`FirstOrDefault`.

当我使用时`ElementAtOrDefault`，此错误显示“不支持查询运算符'ElementAtOrDefault'”。如何获得第二条记录？

* * *

## 回答 #1

> 赞同：39
> 
> 时间：2009-05-05T12:31:46.463

你可以试试这个：

```
var query=data.Skip(1).Take(1); 
```

* * *

## 回答 #2

> 赞同：8
> 
> 时间：2012-06-27T16:19:01.627

如果元素不存在，则 Take() 返回 null（因此等效于 FirstOrDefault()）。

如果您希望像 First() 那样抛出异常（因为第二个元素不存在），请使用：

```
Skip(1).Single() 
```

* * *

## 回答 #3

> 赞同：8
> 
> 时间：2013-04-16T07:39:42.400

试试这个简单的实现，这可能很有用

```
var query= (from p in db.Person where p.Person == person_id select p);
var firstResult = query.First();
var secondResult = query.Skip(1).Take(1).Single();
var thirdResult = query.Skip(2).Take(1).Single(); 
```

* * *

## 回答 #4

> 赞同：5
> 
> 时间：2012-07-27T14:38:41.000

这里没有明确提到一个细节：`FirstOrDefault`返回一个`Element`，`Skip(1).Take(1)`返回一组 1 个元素；即返回的类型`Skip(1).Take(1)`是`IEnumerable`，而`FirstOrDefault`不是。

* * *

## 回答 #5

> 赞同：3
> 
> 时间：2009-05-05T12:31:20.180

如果你使用

```
.Take(2) 
```

你会得到第一个和第二个。

编辑-如果您需要第一个和第二个，那么上面的方法比运行两次查询更有效：

```
.Take(1)
.Skip(1).Take(1) 
```

* * *

## 回答 #6

> 赞同：1
> 
> 时间：2009-05-05T12:31:54.623

选择前 2 个，然后选择第二个元素。

* * *

## 回答 #7

> 赞同：1
> 
> 时间：2013-09-27T06:10:59.347

```
Collection.ElementAt(1) 
```

将获取集合中的第二条记录。

* * *

## 回答 #8

> 赞同：1
> 
> 时间：2019-05-08T14:26:08.760

正如约翰安德森已经指出的那样，`Skip(1).Take(1)`返回`IEnumerable`大小为 1 的值。

为了获得第二个条目本身或一个`null`（即没有例外），我使用以下内容：

```
var secondEntry = collection?.Skip(1)?.FirstOrDefault(); 
```

它可能不适用于您的特定情况，但可能对其他用例有用。

* * *

## 回答 #9

> 赞同：0
> 
> 时间：2009-05-05T12:32:02.377

使用 .Skip(1) 方法

# c# - 在 ASP.NET 中加载某些内容时某种形式的进度条？

> ID：824657
> 
> 赞同：1
> 
> 时间：2009-05-05T12:32:12.797
> 
> 标签：c#, asp.net, sql, vb.net, ajax

有没有一种简单的方法可以在 ASP.NET 中的表单上显示某种形式的进度条，表明代码正忙于在后台运行（意味着思考）？就像默认的IE一样，顶部有一个小窗口，它在思考时会移动......

我以前用 Ajax 做过这件事，但工作量很大，而且我的网站不是启用 Ajax 的网站。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-05-05T12:40:28.970

我相信[JQuery UI](http://jqueryui.com/)有一个进度条组件，可能值得一看。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-05-05T13:56:38.150

我一直在使用 jQuery 插件[BlockUI](http://malsup.com/jquery/block/)。很容易设置并且看起来很酷，尤其是与[jgrowl](http://stanlemon.net/projects/jgrowl.html)一起使用时。

# windows - 免注册 COM 无法在 Windows Server 2003 上运行

> ID：824662
> 
> 赞同：2
> 
> 时间：2009-05-05T12:32:36.837
> 
> 标签：windows, com, registration, side-by-side

我已经为我的 COM 服务器 DLL 和客户端应用程序创建了必要的清单，以便在 Windows XP 中免注册。我已经测试了各种组合（有和没有注册），并且在所有情况下，如果清单存在，客户端应用程序会看到库的并行版本，如果没有（或 COM 错误），则看到已注册的如果根本没有注册）。我已经在我的 Windows XP 开发机器上进行了测试，并将文件（DLL、客户端 EXE 和每个清单）提供给同事，他们也在自己的 Windows XP 机器上成功运行了所有内容。清单是外部 XML 文件，而不是嵌入式资源。到现在为止还挺好。

但是，当我将文件复制到 Windows Server 2003 机器时，它不起作用。我得到一个静默失败，但在应用程序事件日志中出现应用程序错误（见下文）。如果我取消注册 DLL 并删除清单，我会收到类似的错误（在命令提示符下无声，但在事件日志中出现应用程序错误）。显然在查找注册时存在一些问题。我已经在我们公司可以访问的每台 Windows Server 2003 机器上复制了这个。根据有关并行/免注册 COM 的 Microsoft 文档，它应该适用于 Windows XP 及更高版本，以及 Windows Server 2003 及更高版本。

需要明确的是，相同的客户端在相同的 Windows Server 2003 机器上针对相同 COM DLL 的*注册*（*即*使用 regsvr32）版本在我尝试用于免注册 COM 的相同登录凭据下完美运行。换句话说，不存在伪装成免注册 COM 问题的内在问题 - 当服务器在注册表中全局注册时，此客户端和服务器运行良好。

有人对如何进一步调查有任何想法吗？我不是 Windows Server 方面的专家，但是否可能需要更改某些策略设置才能启用此支持？如果我能找到必要的更改，我们的技术支持/基础设施人员可能不会这样做，但我不能依赖他们来研究这个问题，因为他们已经被淹没了。

万一它很重要（我认为它不应该，但你永远不知道）DLL 是用 Delphi 2007 编写的，而客户端是用 Visual C++ 编写的。

```
事件类型：信息
事件源：应用程序错误
活动类别：(100)
事件 ID：1004
日期：2009 年 5 月 2 日
时间：上午 8:07:45
用户：不适用
计算机：***服务器名称****
描述：
报告排队错误：故障应用程序***程序名称***.exe，版本0.0.0.0，故障模块***程序名称***.exe，版本0.0.0.0，故障地址0x0002ac9e。

有关详细信息，请参阅 http://go.microsoft.com/fwlink/events.asp 上的帮助和支持中心。

```

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2009-05-05T17:02:52.430

要查找的一件事是 exe 是否具有内部清单。在 XP 中，exe 清单搜索顺序是外部的，然后是内部的。在 Server 2003 及更高版本中，顺序是内部的，然后是外部的。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-05-05T13:43:18.307

对于在 Delphi 7 中创建的 COM 服务器，如果未注册 COM 服务器并且客户端应用程序在受限用户帐户下启动，我会看到类似的问题，因为 Delphi 的 COM 实现总是试图更新注册信息，即使 DLL 的 RegisterServer 函数是没有显式调用。

要查看这是否是一个问题，请尝试在具有不受限制的管理权限的帐户上运行客户端应用程序。

MSDN 提到，在 Windows 2003 下，免注册 COM 服务器的问题应在系统事件日志的特定部分中详细说明：

> 在解决免注册 COM 问题时，Windows Server 2003 上的事件查看器是您的朋友。当 Windows XP 或 Windows Server 2003 检测到配置错误时，它通常会显示一个错误消息框，标题为您已启动的应用程序并包含消息“此应用程序无法启动，因为应用程序配置不正确。重新安装应用程序可能会解决此问题问题。” 我建议，每当您看到此消息时，您会在 Windows Server 2003 上重现该问题，请查阅系统事件日志并从 SideBySide 源中查找事件。我不建议您在这些情况下查看 Windows XP 事件日志的原因是它总是包含诸如“ 为 [path][application filename].Manifest 生成激活上下文失败。参考错误消息：操作成功完成”，这无助于识别问题。 [http://msdn.microsoft.com/en-us/library/ms973913.aspx#rfacomwalk_topic6](http://msdn.microsoft.com/en-us/library/ms973913.aspx#rfacomwalk_topic6)

此外，如果可能，请告诉我们您使用的清单文件的文件名和内容。

# c# - 我可以使 NumericUpDown 控件的最大值不受限制，而不是在其 Maximum 属性中指定一个值吗？

> ID：824664
> 
> 赞同：20
> 
> 时间：2009-05-05T12:32:52.127
> 
> 标签：c#, .net, winforms, controls

正如标题所说，有没有办法使 NumericUpDown 控件的最大值不受限制，而不必指定其 Maximum 属性的特定值？

* * *

## 回答 #1

> 赞同：38
> 
> 时间：2009-05-05T12:34:24.820

将 NumericUpDown 最大值属性设置为它所表示的数据类型的 MaxValue 属性。

* * *

## 回答 #2

> 赞同：19
> 
> 时间：2009-05-05T12:38:59.257

```
NumericUpDown1.Maximum = Decimal.MaxValue; 
```

* * *

## 回答 #3

> 赞同：11
> 
> 时间：2009-05-05T12:41:20.047

您不能将属性设置为无限或无限或类似的东西，但您可以使用您正在使用的数据类型的 MaxValue（Integer.MaxValue、Decimal.MaxValue 等），这将为您提供尽可能远的范围，而无需引发溢出错误。

# sharepoint - 默认视图中的可过滤 SPFIeldUrl

> ID：824666
> 
> 赞同：0
> 
> 时间：2009-05-05T12:33:25.463
> 
> 标签：sharepoint, moss, wss, field

我在我的列表中添加了一个带有 GUI 的超链接（SPFieldUrl 类）列（字段）。

可惜，但在查看列表时我无法过滤这些值。
[alt text http://img5.imageshack.us/img5/5126/ss20090505152613.png](http://img5.imageshack.us/img5/5126/ss20090505152613.png)
（它读取您无法过滤此列类型）

除了创建自定义视图之外，还有什么方法可以通过单击列轻松过滤？

谢谢你。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2009-05-06T03:02:31.473

根据您使用 url 的方式，您可能能够对计算的列执行某些操作。

另一种选择是使用文本字段而不是 url 字段 - url 字段类型实际上是两个字段的组合，因此您可以通过分别创建这两个字段来获得所需的内容。

# unit-testing - 将 Silverlight 单元测试与 Visual Studio 2008 测试结果面板集成？

> ID：824668
> 
> 赞同：0
> 
> 时间：2009-05-05T12:33:33.123
> 
> 标签：unit-testing, silverlight, visual-studio-2008, tdd

我想从 Visual Studio 运行我的 Silverlight 单元测试，而不是在浏览器中打开我的 Silverlight 测试应用程序的新实例。

显然这是可能的（[http://www.jeff.wilcox.name/2008/09/rc0-new-test-features/](http://www.jeff.wilcox.name/2008/09/rc0-new-test-features/) - 搜索“Visual Studio Team Test log provider output”）......但我没有不明白你是如何启用它的，有人知道怎么做吗？

如果这些测试可以从“在解决方案中运行所有测试”按钮 (Ctrl+R, A) 运行，那就太好了。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-05-05T17:47:05.753

您引用的博客文章明确指出，这只是输出，并未将 Silverlight UT 与 Visual Studio Team Testing System 集成。它将简单地输出为 TRX 格式，然后可以在 Visual Studio 中的该窗口中打开该格式。您仍然无法从 vsmdi 运行 Silverlight 测试，您需要从 Web 浏览器测试工具中运行它们。

我同意如果测试可以从“在解决方案中运行所有测试”按钮运行会很棒，但目前的工具无法做到这一点。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-11-16T02:38:15.073

我[写了一篇](http://flatlinerdoa.spaces.live.com/blog/cns!17124D03A9A052B0!629.entry)关于如何让 Silverlight 测试框架输出 Visual Studio“TestResults.trx”日志文件的博文。我在其他任何地方都找不到有关如何执行此操作的任何信息。

# business-logic - 跨不同编程语言共享通用业务逻辑的策略

> ID：824673
> 
> 赞同：4
> 
> 时间：2009-05-05T12:34:47.207
> 
> 标签：business-logic, cross-language, metalanguage, dataflex

拥有在 Visual Dataflex 中实现的具有复杂业务逻辑的单一业务应用程序，我们面临着跨编程语言维护业务逻辑的挑战，因为某些功能是用其他编程语言（主要是 .NET）编写的。

因此，我正在寻找跨不同编程语言实现“同步”业务逻辑的策略，以避免不匹配。避免重复是一个优点，但这可以通过自动化测试来弥补。

编辑：SOA 是一个很好的建议。但是那些服务不够快的情况呢？

编辑 2：对使用[元语言](http://en.wikipedia.org/wiki/Metalanguage)有什么建议吗？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2009-05-05T12:50:37.370

看起来您正在寻找面向[服务的体系结构 (SOA)。](http://en.wikipedia.org/wiki/Service-oriented_architecture) 使用 SOA，您可以将业务逻辑定义为服务，可以从任何程序以任何语言调用。当业务逻辑改变时，改变你的服务，所有使用它的行为都会改变。SOA 还最大限度地减少了代码重复，因为逻辑只出现在一个地方（服务）。

# c# - 关于 ComponentModel 和反射

> ID：824676
> 
> 赞同：4
> 
> 时间：2009-05-05T12:35:35.253
> 
> 标签：c#, reflection

我有一个接受任何对象的函数，然后它从它作为输入的属性或字段中获取值。

它目前看起来像这样：

```
private string GetFieldValue(object o, Field f)
{
 //field.name is name of property or field
        MemberInfo[] mi = o.GetType().GetMember(field.name, MemberTypes.Field | MemberTypes.Property,
            BindingFlags.Instance | BindingFlags.Static | BindingFlags.Public | BindingFlags.NonPublic | 
            BindingFlags.ExactBinding );

        if (mi.Length == 0) throw new ArgumentException("Field", "Can't find member: " + f.name);

        Object value;
        if (mi[0].MemberType == MemberTypes.Property)
             value = ((PropertyInfo)mi[0]).GetValue(o, null);
        else value = ((FieldInfo)mi[0]).GetValue(o); 
```

今天我读到了 System.ComponentModel 和它的 XXXDescriptor 类。当有性能问题时，两个框架（反射和组件模型）之间有什么区别。使用 ComponentModel 重写上述内容会获得更好的性能或灵活性吗？我所知道的这两者之间的唯一区别是 CM 对虚拟属性的支持。

泰。

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2009-05-05T12:46:53.823

不同之处在于 ComponentModel 是对原始类的抽象。这意味着您可以定义**不存在**的属性- 实际上，这正是如何`DataView`/`DataRowView`将列公开为数据绑定的属性。使用 ComponentModel，即使在 1.1 中，您也可以获得类似“动态”的东西。

您可能认为这意味着 ComponentModel 更慢；但实际上，您可以利用这种抽象来获得收益...... [HyperDescriptor](http://www.codeproject.com/KB/cs/HyperPropertyDescriptor.aspx)正是这样做的 - 使用`Reflection.Emit`编写直接 IL 来表示属性，提供比反射或 vanilla ComponentModel 更快的访问。

但是请注意，默认情况下，ComponentModel 仅限于属性（而不是字段）。您可以通过即时`PropertyDescriptor`外观来做到这一点，但这不是一个好主意。ComponentModel 中的“只写”属性也没有太多位置。

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2009-05-05T12:44:21.957

~~`TypeDescriptor`(in `System.ComponentModel`) 在内部缓存，因此它可以具有更好的性能，尽管没有什么能阻止您向上述代码添加缓存。~~ `TypeDescriptor`使用反射，尽管它允许您扩展对象并添加不受“真实”属性和事件支持的属性和事件。`TypeDescriptor`但是，不支持字段。

如果我是你，并且我不关心`TypeDescriptor`的可扩展性特性，~~并且我很乐意在 之上添加你自己的缓存`GetMember`，~~那么我会坚持反射。

**编辑：**标准反射自 2.0 起缓存了`MemberInfo`对象——请参阅 MSDN [“使用 .NET：避免更快应用程序的常见性能陷阱”](http://msdn.microsoft.com/en-gb/magazine/cc163759.aspx)。

# c# - 如何使用 LINQ 搜索 varchar 字段以构建推荐列表

> ID：824677
> 
> 赞同：1
> 
> 时间：2009-05-05T12:35:49.387
> 
> 标签：c#, sql-server, linq, linq-to-sql

我正在尝试使用表达式树构建一个 LINQ 查询来执行以下操作：

我的 ItemCode 表中有一个名为 Labels 的字段，该字段中包含的数据示例是“lamps lighting chandelier”。

我想允许用户输入一些文本，即“红灯”，并能够搜索项目代码的标签字段，其中文本包含“红灯”或“灯”的表格。

我正在尝试向用户推荐选择，虽然这很基本，但这是一个很好的第一步……只需要一些帮助来构建查询。

我使用 CSLA 作为我的框架，这是我目前拥有的代码示例：

```
IQueryable<Data.ItemCode> query = ctx.DataContext.ItemCodes;

//
// ItemCodeId
//
if (criteria.Name != null)
     query = query.Where(row => row.ItemCodeId.Contains(criteria.ItemCodeId));
//
// Name
//
if (criteria.Name != null)
     query = query.Where(row => row.Name.Contains(criteria.Name));

var data = query.Select(row => ItemCodeInfo.FetchItemCodeInfo(row));

this.AddRange(data); 
```

提前致谢！

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-05-05T12:41:06.380

编辑：更新以反映您的示例代码

假设您的 Criteria 对象有一个名为 Labels 的字段，它是搜索字符串（例如“Red Lamp”），那么：

```
var rows = query.ToList() // work around for local sequences error
           .Where(row => row.Labels.Split(' ')
                         .Intersect(Criteria.Labels.Split(' '))
                         .Count()>0);
this.AddRange(rows); 
```

这将选择标签字段包含条件搜索字符串中的任何单词的行。它假定标签字段和条件字符串中的单词都由空格分隔。它不会进行部分单词匹配，例如，如果提供的搜索字符串是“红灯”，它将找不到带有“红灯”标签的记录

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-07-04T11:56:53.507

这是不可能的。

[http://social.msdn.microsoft.com/Forums/en-US/linqtosql/thread/d2791ad4-3897-4fc0-80e9-72ebc4822898](http://social.msdn.microsoft.com/Forums/en-US/linqtosql/thread/d2791ad4-3897-4fc0-80e9-72ebc4822898)

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-05-05T13:04:06.667

```
String searchString = "red LAMP";

String[] searchStringParts = searchString.
   ToUpperInvariant().
   Split(new Char[] {' '}, StringSplitOptions.RemoveEmptyEntries);

IEnumerable<ItemCode> resultSet = itemCodes.
   Where(itemCode => searchStringParts.
      Any(part => itemCode.Labels.ToUpperInvariant().Contains(part))); 
```

这将适用于 LINQ to Object。`ToUpperInvariant()`由于调用，可能不使用 LINQ to SQL 。在这种情况下，您可以省略规范化（导致搜索质量差）或存储规范化的标签。或者您可以添加一个`ToList()`调用，获取所有项目并在客户端计算机上进行处理。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2009-11-15T12:16:04.717

我们已决定您使用此高级功能的存储过程路线。感谢大家的投入！

# wpf - XBAP 深度链接。可能的安全威胁？

> ID：824688
> 
> 赞同：0
> 
> 时间：2009-05-05T12:40:57.083
> 
> 标签：wpf, security, xbap

我有一个 XBAP WPF 应用程序，它在 Frame 内显示各种页面。我正在考虑允许深度链接到这个应用程序。这样用户就可以链接到[http://myhost/myapp.xbap?page=MyPage 之](http://myhost/myapp.xbap?page=MyPage)类的东西，然后当应用程序加载时，我会自动将 MyPage.xaml 设置为我的主框架的来源。

我想我对如何实现这一目标有所了解。我不知道我是否应该对此类参数进行任何清理以防止可能的安全漏洞？或者在 WPF 的这种情况下它不是问题吗？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2009-05-05T12:50:13.770

我认为这完全取决于您如何处理 XAML 的动态加载。如果您只是直接从参数构建 XAML 文件名，您可能会允许用户在您的应用程序中加载他们想要的任何 XAML（包括您可能不希望用户访问的任何内容，如果这在您的应用。

您可能想要考虑使用某种映射文件将参数映射到 XAML 文件。这样，您可以检查以确保参数有效并且用户只能访问您希望授予他们访问权限的 XAML 元素。

除此之外......祝你好运！

# linq - LINQ：结果的类型是什么？

> ID：824694
> 
> 赞同：2
> 
> 时间：2009-05-05T12:41:46.817
> 
> 标签：linq

我从类型化的数据集中进行了简单的选择：

```
var productlist = from prds in dsProducts.sk_products.AsEnumerable()
                          join prdcat in dsProducts.sk_productscategories.AsEnumerable() on prds.Field<int>("productid") equals prdcat.Field<int>("productid") where prdcat.Field<int>("categoryid") == categoryid
                          select prds; 
```

其中 productlist 是数据集的 sk_products 数据表中的记录集。我想编写一个函数来更多地过滤记录，在其中一个列上有一个不同的：

```
 public List<string, string> GetDistinctManufacturerList(? productlist, int manufacturerid)
    {
       manufacturers = from prdz in productlist where prdz.Field<int>("manufacturerid") == manufacturerid select prdz; [...]
    } 
```

我应该使用什么类型的对象来引用变量*productlist*？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-05-05T12:44:51.893

它是一个 IEnumberable< *selected data type* > -*所选数据类型*可以是匿名类型，或者在这种情况下，将是您的数据集类型类。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-05-05T12:45:08.507

我猜是这样的`IEnumerable<Product>`。正如 ck[所说](https://stackoverflow.com/questions/824694/linq-what-is-the-type-of-a-result/824697#824697)， Product 是您的 LINQ 数据类的名称。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-05-05T12:45:36.930

在您的第一个示例中...将鼠标悬停在 Visual Studio 中的“var”一词上，它将显示“类型”。

如果它类似于 'anonymouse{blahblah}'...，那么您可能必须创建一个要将其转换为的类，以便可以将其用作函数参数。

# iphone - 我总是必须在 -viewDidLoad 方法中调用 [super viewDidLoad] 吗？

> ID：824695
> 
> 赞同：53
> 
> 时间：2009-05-05T12:43:02.273
> 
> 标签：iphone, viewdidload

在 Apple 的 scrollView 示例中，他们没有这样称呼。我一直认为这是*必须*的。我为什么要这样称呼？

* * *

## 回答 #1

> 赞同：49
> 
> 时间：2009-05-05T13:01:55.160

如果您要覆盖该方法，您仍然应该在超级中调用该方法。即使超类今天没有对它做任何事情，Apple 可能有一天会改变实现，你的代码会神秘地停止工作。如果您真的不需要在该方法中执行任何操作，请将其完全排除在代码之外，超级方法将照常运行，无需您进行任何干预。

* * *

## 回答 #2

> 赞同：29
> 
> 时间：2009-09-11T02:20:13.160

不，您*不需要*调用 [super viewDidLoad]。**编辑：但请阅读以下内容，因为我认为您绝对*应该*。**

让我们在这里实事求是：Apple 不会通过决定他们当前未处理的事件突然需要做一些开发人员可能或可能不想停止的事情来破坏数千个应用程序，包括那些基于他们发布的示例代码的应用程序。至关重要的是，如果您不需要不同的行为，则不要停止该事件。

**编辑：**在观看了 Apple 如何处理兼容性额外一年之后，我现在建议学习和使用正确的模式。虽然我怀疑您的应用程序二进制文件是否会突然停止工作，但很明显 iPhone 会检测到您的二进制文件是针对哪个 SDK 构建的，并基于此修改一些操作系统行为。

Apple 可能有一天会要求在未来的一些 SDK 上遵循特定的模式。在您使用最新的 Xcode + SDK 重建之前，这不会影响您，但是您会在没有任何源代码更改的情况下获得这些中断。学习并遵循模式以确保安全。

* * *

## 回答 #3

> 赞同：18
> 
> 时间：2009-05-05T12:56:14.690

正如 Markus 所说， UIViewController 在其 viewDidLoad 方法中没有做任何事情，所以你不必调用它。然而，这是一个好习惯，以防你改变你的继承结构，突然从 UIViewController 继承的类现在继承了在 viewDidLoad 方法*中*做某事的东西。

* * *

## 回答 #4

> 赞同：11
> 
> 时间：2014-10-21T11:33:12.977

假设您有 2 个班级，一个父母和一个孩子。子继承自父。他们有一个名为 greet 的方法，它返回一个字符串。

下面是父方法的样子：

代码：

```
-(NSString *)greet {
   return @"Hello";
} 
```

我们希望孩子向父母学习。所以我们用 super 来表达妈妈的问候方式，但也有我们自己的小补充。

代码：//从父级继承

```
-(NSString *)greet {
  NSString *parentGreeting = [super greet];
  return [parentGreeting stringByAppendingString:@", Mommy"]
} 
```

所以现在父母打招呼“你好”，孩子打招呼“你好，妈妈”。稍后，如果我们将父母的问候语更改为只返回“Hi”，那么两个类都会受到影响，您将有“Hi”和“Hi, Mommy”。

super 用于调用超类定义的方法。它用于访问已被子类覆盖的方法，以便类可以将自己的代码包装在其父类实现的方法周围。如果您要进行任何类型的继承，这将非常方便。

* * *

## 回答 #5

> 赞同：10
> 
> 时间：2011-02-14T19:34:13.603

Apple 的 viewDidLoad 文档没有说明您应该调用 [super viewDidLoad]，所以我会按照 Apple 的说法。但是请注意，对于 viewDidAppear 等其他类似方法，您必须调用 [super viewDidAppear]。

* * *

## 回答 #6

> 赞同：9
> 
> 时间：2009-05-05T12:54:44.850

您不必调用 [super viewDidLoad]

据我所知，超类（UIViewController）中的 viewDidLoad 只是一个空函数，当使用 nib 文件初始化 ViewController 时会调用它。

所以如果你需要做任何初始化，你应该重写这个函数并将你的代码放在那里。

* * *

## 回答 #7

> 赞同：5
> 
> 时间：2014-07-06T01:33:52.957

刚刚注意到，如果您不在这些函数中调用 super，Xcode 6 的静态分析器会发出警告。所以看起来苹果现在肯定希望我们给它打电话。

* * *

## 回答 #8

> 赞同：0
> 
> 时间：2015-06-20T11:04:31.400

虽然在 xCode 7 Beta/Swift 2 中 super.viewDidLoad 不会编译。该错误表明它仅在 osx 10.10 中可用，并且自动修复会执行此操作

```
if #available(OSX 10.10, *){
super.viewDidLoad()}
else
{
// Fallback on earlier versions
}
// My code
} 
```

# asp.net - 禁用 IE6 客户端的 GZIP 压缩

> ID：824704
> 
> 赞同：6
> 
> 时间：2009-05-05T12:47:01.997
> 
> 标签：asp.net, vb.net, iis-7, internet-explorer-6, compression

如果用户的浏览器是 IE6（它会在较大站点的几个页面中挂起浏览器 5 分钟），我们需要有条件地禁用 GZIP 压缩。服务器是 IIS7 并且已打开静态内容的压缩 - 如果用户代理不是 Mozilla/4.0，则希望该压缩继续工作。ASPX 代码示例有人吗？或者，有条件地重定向到另一个站点上的同一页面的代码（可以创建另一个禁用压缩的虚拟站点）但需要传递所有参数（GET/POST）。

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2009-05-05T13:23:23.970

如果请求来自 IE5/IE6 ，请尝试拦截浏览器的请求以停止声明对 Gzip 的支持。我相信 ISAPI 重写可用于 IIS。

请注意：这并不要求您拥有单独的 gzip 和非 gzip 页面。这可能是比您的建议更好的方法，因为它从源头上解决了问题。

# iphone - TextView 上方的 iPhone TableView：TableView 不响应事件

> ID：824711
> 
> 赞同：0
> 
> 时间：2009-05-05T12:49:45.393
> 
> 标签：iphone

考虑 iPhone 中的常规形式：

1.有一个组合框。

2.combobox下面有一个TextView。（没有重叠）

3.单击组合框时，选项TableView打开并与TextView重叠。

4.TableView在TextView之上。

5.当触摸TableView中的某个单元格时，TextView响应，TableView没有得到事件。

现在我看到响应者链是自下而上的。所以TextView得到事件是因为它的深度比TableView低。

解决此问题的最佳方法是什么？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2009-05-05T14:43:22.250

可以将您的 TextView 设置为 TableView 的代表吗？

如果您使用像 didSelectRowAtIndexPath 这样的事件方法，那么您的代表可能没有正确分配。如果您使用触摸事件，则 tableview 可能未启用多点触控。

# iphone - 如何迭代一组内的图像资源？

> ID：824713
> 
> 赞同：0
> 
> 时间：2009-05-05T12:50:33.847
> 
> 标签：iphone, uikit

在我的“组和文件”中，我创建了类似的东西：

图片 > gui 图片 > foo 图片 > foo > bar

现在我想遍历放置在 images > foo > bar 中的所有图像。那可能吗？恐怕不是，因为系统在加载文件时从不关心“文件夹”。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-05-05T16:06:02.910

如果您的图像位于 .app 包的子文件夹中，您可以为该文件夹创建一个 nsbundle 并调用 pathsForResourcesOfType 以获取路径的 nsareay。

# perl - 如何使用 Perl 整理和汇总文件中的记录？

> ID：824715
> 
> 赞同：1
> 
> 时间：2009-05-05T12:50:53.470
> 
> 标签：perl, sed, awk, unix

我有以下格式的文本文件：

```
211B1 CUSTOMER|UPDATE|  
211B2 CUSTOMER|UPDATE|  
211B3 CUSTOMER|UPDATE|  
211B4 CUSTOMER|UPDATE|  
211B5 CUSTOMER|UPDATE|  
567FR CUSTOMER|DELETE|  
647GI CUSTOMER|DELETE| 
```

我想要一个处理文本文件并报告以下内容的脚本：

*   为 Acct 找到的列 CUSTOMER 的“更新”：211B1,211B2,211B3,211B4,211B5
*   为 Acct 找到的列 CUSTOMER 的“DELETE”：5675FR,6470GI

我可以编写简单的解决方案，但这对我来说似乎有点复杂，希望得到帮助或指导。

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2009-05-05T12:58:27.197

## 整理.pl

```
#!/usr/bin/perl

use strict;

my %actions;
while (<>) {
    my ($key, $fld, $action) = /^(\w+) (.+?)\|(.+?)\|/ or die "Failed on line $.!";
    push @{$actions{$action}{$fld}}, $key;
}

foreach my $action (keys %actions) {
    foreach my $fld (keys %{$actions{$action}}) {
        print "\"$action\" for column $fld found for Acct's: " . join(",", @{$actions{$action}{$fld}}), "\n";
    }
} 
```

像这样使用：

```
perl collate.pl < input.txt > output.txt 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-05-05T13:04:59.193

```
#!/usr/bin/perl

use strict;
use warnings;

my %data;

while ( my $line = <DATA> ) {
    next unless $line =~ /\S/;
    my ($acct, $col, $action) = split /\s|\|/, $line;
    push @{ $data{$action}->{$col} }, $acct;
}

for my $action ( keys %data ) {
    for my $col ( keys %{ $data{$action} } ) {
        print qq{"$action" for column $col found for acct's: },
              join q{,}, @{ $data{$action}->{$col} }, "\n";    
    }

}
__DATA__
211B1 CUSTOMER|UPDATE|  
211B2 CUSTOMER|UPDATE|  
211B3 CUSTOMER|UPDATE|  
211B4 CUSTOMER|UPDATE|  
211B5 CUSTOMER|UPDATE|  
567FR CUSTOMER|DELETE|  
647GI CUSTOMER|DELETE| 
```

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2009-05-05T13:01:05.537

使用 awk：

```
echo '211B1 CUSTOMER|UPDATE|  
211B2 CUSTOMER|UPDATE|  
211B3 CUSTOMER|UPDATE|  
211B4 CUSTOMER|UPDATE|  
211B5 CUSTOMER|UPDATE|  
567FR CUSTOMER|DELETE|  
647GI CUSTOMER|DELETE|' | awk -F '[ |]' '
    BEGIN {
        upd="";del=""
    } {
      if ($3 == "UPDATE") {upd = upd" "$1};
      if ($3 == "DELETE") {del = del" "$1};
    } END {
        print "Updates:"upd; print "Deletes:"del
    }' 
```

产生：

```
Updates: 211B1 211B2 211B3 211B4 211B5
Deletes: 567FR 647GI 
```

它基本上只是将每一行分成三个字段（使用`-F`选项），并根据“命令”维护它附加到的更新和删除列表。

`BEGIN`and在所有行处理之前和之后运行，`END`因此它们是初始化和最终输出。

我将其放入脚本中以使其更容易。我将其保留为命令行工具，因为这就是我通常调试 awk 脚本的方式。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2009-05-11T22:13:42.903

另一个 awk 版本，虽然代码值的顺序相反，并且在每行的末尾有一个额外的“，”

```
 BEGIN { FS="[ |]" }

{
        key = $3 " for column " $2
        MAP[ key ] = $1 "," MAP[ key ]
}

END {
        for ( item in MAP ) {
                print item " found for Acct's: " MAP[ item ]
        }
} 
```

* * *

## 回答 #5

> 赞同：-2
> 
> 时间：2009-05-05T12:59:51.217

根据您的问题，您可以这样做：

```
perl -i.bak -pe'if(/^211B[1-5]/){s/CUSTOMER/UPDATE/}elsif(/^(5675FR|6470GI)/){s/CUSTOMER/DELETE/}' filename 
```

尽管我现在注意到示例中的最后两个帐号不同，并且第二列已经具有这些值...

# database - 从 .bak 文件恢复 sql 数据库时出错

> ID：824727
> 
> 赞同：1
> 
> 时间：2009-05-05T12:55:34.520
> 
> 标签：database, sql-server-2005, restore

当我使用 Microsoft SQL Server Management Studio 还原 SQL 数据库时，它失败并给我以下消息：

[![恢复错误](https://i.stack.imgur.com/W562r.jpg)](https://i.stack.imgur.com/W562r.jpg)

> 标题：Microsoft SQL Server 管理工作室
> 
> 服务器“app1”的恢复失败。(Microsoft.SqlServer.Smo)
> 
> 如需帮助，请单击： http: [//go.microsoft.com/fwlink ?ProdName=Microsoft+SQL+Server&ProdVer=9.00.1399.00&EvtSrc=Microsoft.SqlServer.Management.Smo.ExceptionTemplates.FailedOperationExceptionText&EvtID=Restore+Server&LinkId=20476](http://go.microsoft.com/fwlink?ProdName=Microsoft+SQL+Server&ProdVer=9.00.1399.00&EvtSrc=Microsoft.SqlServer.Management.Smo.ExceptionTemplates.FailedOperationExceptionText&EvtID=Restore+Server&LinkId=20476)
> 
> - - - - - - - - - - - - - - - 附加信息：
> 
> 执行 Transact-SQL 语句或批处理时发生异常。(Microsoft.SqlServer.ConnectionInfo)
> 
> * * *
> 
> 无法为此操作选择文件或文件组“SilosFollow_log”。RESTORE DATABASE 异常终止。（Microsoft SQL Server，错误：3219）
> 
> 如需帮助，请单击： http: [//go.microsoft.com/fwlink ?ProdName=Microsoft+SQL+Server&ProdVer=09.00.1399&EvtSrc=MSSQLServer&EvtID=3219&LinkId=20476](http://go.microsoft.com/fwlink?ProdName=Microsoft+SQL+Server&ProdVer=09.00.1399&EvtSrc=MSSQLServer&EvtID=3219&LinkId=20476)
> 
> - - - - - - - - - - - - - - - 纽扣：
> 
> 好的

注意数据库所有者不是备份用户名。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-05-05T12:58:40.597

配置还原时，请确保您没有使用当前正在运行的数据库（可能是您要在其上还原的数据库）使用的数据/日志文件。

它使数据目录变得一团糟，但是当我恢复数据库时，我给我的数据/日志文件一个版本号，这样我就不会遇到这个问题。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-05-05T13:04:35.513

您确定 SilosFollow_log 是数据库备份而不是事务日志备份吗？

为了恢复事务日志备份，您必须首先恢复完整的数据库备份和任何差异备份。然后您可以依次还原事务日志备份。

# php - 我什么时候应该使用 Perl CGI 而不是 PHP（反之亦然）？

> ID：824730
> 
> 赞同：17
> 
> 时间：2009-05-05T12:56:15.813
> 
> 标签：php, perl, cgi, cpan

出于爱好目的，我在提供 PHP 和 Perl CGI 的托管服务器上拥有一个共享空间。我在几个地方读过 CGI 脚本现在已经过时了，我认为主要是因为性能问题（比如[PHP 或 vanilla Perl CGI 更快吗？](https://stackoverflow.com/questions/313083/is-php-or-vanilla-perl-cgi-faster)）。

但是由于我刚刚开始学习 Perl，我不想浪费时间在 PHP 中实现在 Perl 中更容易（或唯一可能）的解决方案。

还有样板问题，我知道 CPAN（即存在，还不是内容），但不熟悉 PHP 库（尽管我毫不怀疑它们存在）。我不准备第 10 ^ 10 次从头开始编写登录过程或基本用户管理。

在这一点上，我也不奢侈浪费大量时间研究爱好项目，所以我想，让我们向专家寻求一个先机。

* * *

## 回答 #1

> 赞同：34
> 
> 时间：2009-05-05T15:18:03.710

CGI 的“过时”特性实际上仅在您正在处理具有大量页面浏览量的大型复杂网站时才会考虑。

许多人认为 CGI 已过时，但并不真正了解 CGI 是什么。有一种普遍的误解认为 CGI 本质上是一种基于 Perl 的技术。许多人攻击 CGI 是为了平息对 Perl 的狂热攻击，以支持他们支持的任何语言。如果您想成为一名真正的技术专家，您需要了解基本问题并根据实际情况做出选择。

CGI 是一个带有网络服务器的接口，它允许您以任何语言编写交互式页面——[甚至是 befunge](http://quadium.net/funge/name.bf)。当服务器收到对由 CGI 脚本控制的页面的请求时，服务器会运行该脚本并将结果返回给请求者。

如果您的编程语言在每次执行时都需要加载 VM、解释器或编译器，那么每次访问您的页面时都需要此启动时间。

FastCGI、mod_php、mod_perl 等 CGI 加速器始终将解释器/VM 保留在内存中，可以保持库加载，甚至缓存脚本中的字节码以减少脚本启动开销。

如果您正在制作一个简单的、个人的或爱好的网站，CGI 就可以了。PHP 也将如此。

如果您的站点需要增长到需要更快的技术，您可以迁移到 mod_perl、FastCGI 或其他 CGI 加速技术。

您使用什么语言应该由它提供的工具以及它们如何满足您的需求来决定。

1.  列出你需要的能力。
2.  列出破坏交易的清单。
3.  现在对照这两个列表检查每个可能的工具集。
4.  哪一个出来最好？测试一下。
5.  很烂吗？把它从你的清单上划掉，然后回到第 4 步。

另外，我建议不要使用[befunge](http://en.wikipedia.org/wiki/Befunge)。仅仅因为它是可能的，并不意味着你应该使用它。

* * *

**更新：** 正如 mpeters 所指出的，mod_perl、mod_php、mod_ruby 等不仅仅是 CGI 加速器；它们提供对 Apache API 的访问。它们充当 CGI 加速器，但可以做很多、很多、更多的事情。

FastCGI 是一个纯 CGI 加速器。

**更新 2：** PHP 和 CGI​​ 不是相互排斥的。 [PHP 可以作为 CGI 安装](http://us3.php.net/security.cgi-bin)。PHP 经常与 FastCGI 一起使用。

* * *

## 回答 #2

> 赞同：9
> 
> 时间：2009-05-05T13:15:29.417

对于决定将什么用于业余爱好，这是一个相当主观的问题。在研究了 PHP 之后，我决定将 Perl 作为一种爱好来学习，并且不喜欢我无法阅读大部分 PHP 并且被内置函数列表吓倒的事实。

我做的前几件事是用于联系表格的 CGI 脚本和相册生成器。我使用的是便宜的共享托管计划，并且没有遇到任何性能问题，因此性能问题从未发挥作用。

相反，comp.lang.perl.misc 和 CPAN 的存在确保了我永远不会重新考虑不深入研究 PHP 的决定。

同时，我意识到我网站上的大部分内容在生成后都是静态的，所以现在我编写 Perl 脚本来离线生成内容。

所以，我的答案是，选择一个小项目，任何事情都可以，然后使用 Perl 和适当的 CPAN 模块来实现它，看看你是否喜欢它。

* * *

## 回答 #3

> 赞同：5
> 
> 时间：2009-05-22T00:09:44.740

从扩展的角度来看，您使用 PHP 还是 Perl 是没有意义的，就像用 PHP 和 C 编写的 web 应用程序之间的区别是没有意义的一样。如果差异真的很重要，我们都会编写 C 或汇编。

PHP 很慢，但这并没有阻止 Wikipedia、Facebook 和 Yahoo 广泛使用它。

从扩展的角度来看，您选择哪种语言并不重要有两个主要原因：

1.  使用像 Squid 这样的缓存反向代理。通过卸载 apache 的大部分工作负载，您可以显着减少 CGI 调用负载。
2.  扩展您的网络层很容易。它很难扩展您的数据库层。您始终可以将另一个网络服务器添加到场。如果您可以使用 mod_php 每秒处理 1000 个请求，而使用 CGI 每秒可以处理 500 个请求，如果开发 CGI 更便宜、更快，那就去做吧。您将需要两倍的网络头，但要么：
    1.  您处于网络的底层 90%，并且无论如何只需要一个网络服务器。
    2.  您处于网络的前 10%，并且需要多个网络服务器——但您有足够的流量来证明额外成本是合理的。

选择您和您的团队可以最有效地开发的语言。

* * *

## 回答 #4

> 赞同：3
> 
> 时间：2009-05-22T09:56:56.227

[这是一个使用Squatting](http://search.cpan.org/dist/Squatting/) web 微框架在 CGI 下运行的简单“hello world”示例：

```
use strict;
use warnings;

{
    package MyApp;
    use base 'Squatting';
    use base 'Squatting::On::CGI';
}

{ 
    package MyApp::Controllers;
    use Squatting ':controllers';

    our @C = (
        C(
            Index => [ '/' ],
            get   => sub { 
                my ( $self ) = @_;
                my $v = $self->v;
                $v->{say} = 'hello world!';
                $self->render( 'hello' );
            },
        ),
    );
}

{
    package MyApp::Views;
    use Squatting ':views';
    use HTML::AsSubs;

    our @V = (
        V(  'html',

            layout => sub { 
                my ( $self, $v, @yield ) = @_;
                html (
                    head ( title( 'My CGI App' ) ),
                    body ( @yield ),
                )->as_HTML;
            },

            hello => sub {
                my ( $self, $v ) = @_;
                p ( $v->{say} );
            },
        ),
    );
}

use CGI;
my $q = CGI->new;
MyApp->init;
MyApp->relocate('/cgi-bin/myapp.cgi');
MyApp->cgi($q); 
```

另存为“myapp.cgi”并放入您的 cgi-bin。

* * *

## 回答 #5

> 赞同：2
> 
> 时间：2009-05-05T13:13:39.623

我在网站上同时使用 Perl 和 PHP - 由于历史原因，主要是 Perl 在工作中和 PHP 在家里；我认为他们之间没有太多选择。

如果您的页面大部分是固定的 HTML 并且只有少量计算，那么 PHP 会更容易一些，因为它无论如何都嵌入在 HTML 中。

我发现 PHP 比 Perl 更规范，因此有时也更受限制。PEAR 与 CPAN 非常相似——我认为没有那么大，但是 CPAN 太大了，以至于它里面有很多渣滓。

高温高压

科林

* * *

## 回答 #6

> 赞同：2
> 
> 时间：2009-05-06T13:17:58.997

如果您使用托管，在许多情况下 PHP 也将作为 CGI 运行。如果你不想运行 FastCGI 或 mod_perl，你可以使用[CGI::Application framework](http://search.cpan.org/dist/CGI-Application/)。CGI::Application 也可以使用 FastCGI 或 mod_perl 运行，但与 Catalyst 不同的是，它也可以作为 CGI 运行。Catalyst 和 CGI​​::Application 都可以使用它们自己的 Web 服务器运行。

* * *

## 回答 #7

> 赞同：1
> 
> 时间：2009-05-05T14:25:11.747

PHP 和 Perl 都有自己的时刻，但这确实是主观的。Perl 在 CPAN 上有大量可用的框架，即使在纯 CGI 环境中，它也可以与 PHP 一样好或更好地工作。同时，PHP 拥有大量的追随者，以及大量开箱即用的功能，使网站编程变得简单。对我来说，选择归结为个人喜好。我个人更喜欢使用 Perl，而不是试图找到所有在 PHP 中做事的函数式方法。祝你好运！

* * *

## 回答 #8

> 赞同：1
> 
> 时间：2009-05-05T15:54:37.523

使用[Template Toolkit](http://template-toolkit.org)试用[Catalyst](http://www.catalystframework.org/)。

```
sub hello :Path('/hello') :Args(0) {
    my ( $self, $c ) = @_;

    # Hello World
    $c->response->body( $c->welcome_message );
} 
```

```
<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01 Strict//EN">
<html>
  <头部>
    <title>[% title %]</title>
  </head>
  <正文>
    <div id="header">
      <a href="/index.html" class="logo" alt="主页"></a>
      <h1 class="headline">[% title %]</h1>
    </div>

    [％ 内容 ％]

    <div id="页脚">
      <div id="版权">
        ＆复制; [%版权%]
      </div>
    </div>
  </正文>
</html>

```

# java - 在 JSF 应用程序中使用 Spring AOP

> ID：824733
> 
> 赞同：1
> 
> 时间：2009-05-05T12:58:02.517
> 
> 标签：java, spring, jsf, aop

考虑一个带有托管 bean FooBean.java 的 JSF Web 应用程序。我在 faces-config.xml 文件中声明了这个“FooBean”。现在，如果我想为 FooBean 的方法添加 Spring AOP 建议，我该怎么做？

*   我应该添加一个 applicationContext.xml 文件并在其中声明托管 bean 吗？
*   或者即使我没有在 Spring 配置文件中声明托管 bean，它也会起作用吗？

注意：我创建了一个 Aspect bean 并在切面 bean 中定义了一个像 @Pointcut("within(dummy.web.reporting..*)") 的切入点。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2009-05-05T14:16:26.230

您可以从 web.xml 中加载常规的 spring 上下文 xml 文件，如下所示：

```
<context-param>
   <param-name>contextConfigLocation</param-name>
   <param-value>/WEB-INF/classes/spring-context.xml</param-value>
</context-param> 
```

然后，您可以在此处以常规 spring 方式定义您的托管 bean，您仍然可以在 jsps 中通过 id 引用这些 bean。

您还可以在您的系统中使用所有标准 Spring AOP 内容`spring-context.xml`

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2011-11-03T04:43:10.450

我在 Spring JSF 应用程序中大量使用 Spring AOP，我宁愿建议您通过 Spring 容器加载 JSF bean，并让 Spring 管理 bean 的范围。在这种情况下，所有 bean 都将由 Spring 容器加载，因此实现 Spring AOP 将变得非常容易。

有关此类 Spring-JSF 集成的更多信息 [http://xebee.xebia.in/2011/10/31/spring-jsf-integration-made-easy-clean-using-spring-annotations/](http://xebee.xebia.in/2011/10/31/spring-jsf-integration-made-easy-clean-using-spring-annotations/)

# c# - 隐式输入；为什么只是局部变量？

> ID：824739
> 
> 赞同：23
> 
> 时间：2009-05-05T12:59:14.840
> 
> 标签：c#, .net, variables, implicit-typing

有谁知道或关心推测为什么隐式类型仅限于局部变量？

```
var thingy = new Foo(); 
```

但为什么不...

```
var getFoo() {
    return new Foo(); 
} 
```

* * *

## 回答 #1

> 赞同：43
> 
> 时间：2009-05-05T13:01:21.993

Eric Lippert 写了一篇关于这个主题的完整博客文章。

*   [https://docs.microsoft.com/en-us/archive/blogs/ericlippert/why-no-var-on-fields](https://docs.microsoft.com/en-us/archive/blogs/ericlippert/why-no-var-on-fields)

总之，主要问题是需要对 C# 编译器进行重大的重新架构才能做到这一点。目前以单程方式处理声明。这将需要多次传递，因为能够在推断变量之间形成循环。VB.NET 也有大致相同的问题。

* * *

## 回答 #2

> 赞同：7
> 
> 时间：2009-05-05T14:30:35.370

Jared 在他的回答中有一个很棒的链接，指向一个很棒的话题。

我认为它没有明确回答这个问题。

**为什么不？**

```
var getFoo() {
    return new Foo(); 
} 
```

这样做的原因是：

**如果什么？**

```
class Foo {}

var GetFoo() {
   return GetBar(); 
}

var GetBar() {
  return GetBaz(); 
}

var GetBaz() {
   return new Foo();
} 
```

您可以推断出`GetFoo`将要返回`Foo`，但您必须跟踪该方法及其**子项所做的****所有**调用，以推断类型。就目前而言，C# 编译器并非旨在以这种方式工作。在推断类型的代码可以运行之前，它需要在流程的早期使用方法和字段类型。

 **在纯粹的美学层面上，我发现方法上的 var 定义混淆了事物。**它是我认为明确总是**有帮助的一个地方，它通过意外返回导致您的签名和大量其他相关方法签名更改的类型来保护您免于自责。更糟糕的是，如果您返回返回对象的方法的值并且碰巧很幸运，您甚至可能在不知道自己这样做的情况下更改了方法链的所有签名。

我认为 var 方法最好留给像 Ruby 这样的动态语言

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2009-05-05T13:04:17.713

因为它更容易做到。如果您要推断所有类型，则需要像 Hindley Milner 类型推断系统这样的东西，它将把您钟爱的 C# 变成 Haskel 派生语言。

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2009-05-05T13:23:15.263

从本质上讲，您遇到的问题是 C#（到目前为止）是一种静态类型的语言。定义为 var 的局部变量仍然是静态类型的，但在语法上是隐藏的。另一方面，返回 var 的方法有很多含义。它更像是一个使用接口，使用 var 并没有任何收获。

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2010-05-05T11:41:23.660

您可以在 vs 2010 **Dynamic中使用**

```
Dynamic getFoo() { 
    return new Foo();  
} 
```

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2009-05-05T13:02:01.570

我认为这是因为隐含类型的范围更广，因此比单一方法的范围更容易引起问题。

# delphi - AlphaBlend 子窗体

> ID：824741
> 
> 赞同：0
> 
> 时间：2009-05-05T13:00:22.997
> 
> 标签：delphi, forms, parent, alphablending

我正在寻找一种 AlphaBlend 子窗体的方法，如果可能的话，使用分层窗口，因为它后面会有交互式控件。

问题是我在常规 TForm 中有一个组件，它绘制多个可视层（绘图、图片......）。在某些时候我需要在这个表单上（就地）实例化一个编辑器控件，这个控件将涉及我的控件之外的各种标准输入控件（编辑框、复选框等），但是我想覆盖正在使用 Alpha 混合编辑的图层前面的图层（并`WS_EX_TRANSPARENT`使其点击通过）。

我首先想到的是为此使用子表单（无边界`TForm`s 是组件的父级），并且效果很好，直到 AlphaBlended TForm 根本不进行 alphablend，但一旦成为父级就会变得不透明......

然后，我尝试取消 alphablended 表单的父级，将其设置为 fsStayOnTop，并通过对相关事件做出反应，将其保持在屏幕上的组件前面，这可行，但这并不是一个真正令人满意的解决方案：alphablended StayOnTop 表单是也在应用程序的其他模态和非模态形式之前，如果用户决定将它们移动到组件前面......

那么，关于让子表单成为字母混合的方式的任何其他想法？（或表现得像这样）

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-05-05T13:29:36.390

根据 MSDN，您不走运，因为[*WS_EX_LAYERED*不能用于子窗口](http://msdn.microsoft.com/en-us/library/ms632599.aspx#layered)。

当您的表单/应用程序失去焦点时，也许您可​​以隐藏所有编辑器表单，这至少可以防止它们位于其他窗口之上。不过，还是不太满意……

# javascript - 将 HTML 字符串动态插入到文档的 HEAD 中

> ID：824742
> 
> 赞同：3
> 
> 时间：2009-05-05T13:00:36.113
> 
> 标签：javascript, html, dom

我需要在当前文档 DOM 的标签中插入一个 HTML 字符串`<head>`，一种方法是：创建一个 div 元素，填充其 innerHTML，逐项复制到您的`<head>`元素中。但是这些方法在 IE/Opera 中不起作用，原因如下，尽管在 FF3中，以下**两种**方法都可以正常工作，并且浏览器会处理添加的 STYLE/SCRIPT 元素。

有没有其他方法可以直接插入字符串`<head>`并处理这些项目？

* * *

（为什么他们在 IE/Opera 中失败）

方法 1 -因为 innerHTML 无法解析/忽略字符串中的 META、STYLE、SCRIPT 元素而**失败**

```
insertHtml = function(parentElem,htmlStr){

   var frag = document.createDocumentFragment();
   var temp = document.createElement('div');
   temp.innerHTML = htmlStr;

   // at this point, temp.childNodes.length=0

   while (temp.firstChild) {
       frag.appendChild(temp.firstChild);
   }
   // use native DOM methods to insert the fragment
   parentElem.insertBefore(frag, parentElem.childNodes[0]);
} 
```

* * *

方法 2 -**失败**，因为添加的 STYLE/SCRIPT 元素没有被浏览器处理

```
 document.getElementsByTagName("head")[0].innerHTML = htmlStr
 // although this populates the <head> tag successfully 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-05-05T13:26:32.107

这是一个解决问题的愚蠢技巧。在 htmlStr 中添加一个非空字符串标签（node.nodeType === 3），一切都会正常工作：

```
var insertHtml = function(parentElem, htmlStr){

   var frag = document.createDocumentFragment();
   var temp = document.createElement('div');
   temp.innerHTML = "hack" + htmlStr;

   while (temp.firstChild) {
       if (temp.firstChild.nodeType === 1) {
            // add only element nodes
            frag.appendChild(temp.firstChild);
       } else {
            // remove the hack string
            temp.removeChild(temp.firstChild);
       }
   }

   parentElem.insertBefore(frag, parentElem.childNodes[0]);
} 
```

# unit-testing - VS08 TFS 单元测试 vs Gallio/MbUnit

> ID：824746
> 
> 赞同：0
> 
> 时间：2009-05-05T13:01:36.330
> 
> 标签：unit-testing, tfs, gallio

我正在考虑在工作中添加单元测试。我过去使用过 MbUnit，并且在 Gallio 框架中有一些示例 UT。我们使用的是自带测试套件的 VS08。使用 VS08 TFS UT 与 Gallio 的优缺点是什么？关于使用哪个框架的一般建议是什么？

谢谢！

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-05-05T13:32:00.830

Visual Studio Team System 附带的单元测试套件就足够了，但我想说只有在您使用成熟的 TFS 实现并且打算使用 TFS 进行持续集成构建时才使用它。我可以看到 MS 的单元测试套件的唯一好处是它与 TFS 构建很好地集成，并且可以提供一些不错的报告。

也就是说，如果您只使用 Visual Studio 并且将使用 CruiseControl.NET 或 TeamCity 进行 CI 构建，我建议使用 MbUnit 或 NUnit.Net。总的来说，我认为大多数开源单元测试框架都具有类似的功能，因此您选择哪一个可能并不是什么大问题。

# testing - 测试数据生成工具

> ID：824750
> 
> 赞同：1
> 
> 时间：2009-05-05T13:02:04.973
> 
> 标签：testing, test-data

是否有任何工具可以根据特定要求生成测试数据？

例如大小、文件类型

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-05-06T10:31:08.493

[http://www.webresourcesdepot.com/test-sample-data-generators/](http://www.webresourcesdepot.com/test-sample-data-generators/)

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-05-05T13:10:37.823

那么，更大的背景是什么？在特定领域通常有专门的工具。我*主要*了解 MS 技术，其中“data dude”可以进行数据库测试数据生成，并且（不相关的）PEX 可以使用分析来查找进入您不常见代码分支的数据......但对于更具体的场景，您可能需要编写自己的工具。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-05-05T13:12:08.317

你的问题很开放...

通过搜索“语料库”一词，您可以找到一些对许多领域的测试有用的数据，通常与自然语言相关。

如果想生成随机数据，去破解一个 Perl 脚本......但是：

*   谨防计算机生成的随机性会伤害您（[http://en.wikipedia.org/wiki/Random_number_generator](http://en.wikipedia.org/wiki/Random_number_generator)）。
*   当您知道您的计算结果应该是什么时，测试数据非常有用，否则您不知道您的测试是否成功。

我见过很多人生成大量数据来测试他们的代码的*性能*，而忘记检查结果是否正确。

如果您足够幸运有可能进行往返，例如使用压缩/解压缩，随机数据生成可以提供有用并捕获您不会想到的极端情况

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2009-05-05T22:50:33.560

这是一个非常开放的问题。尽管测试数据肯定想要测试特定的测试用例，因此正如 Marc 所说，编写自己的工具可能是一种更好的方法，但我怀疑通用工具能否满足您的需求。但是，如果您解释您的情况，可能会更容易提供帮助。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2012-07-30T09:39:26.663

这个问题是非常开放的。但是我在自动化我的测试用例和测试数据时多次遇到这个问题。如果这是您正在寻找的上下文，我的回答可以帮助您。

对于测试数据生成工具，您可能想看看[Grid tools suite](http://www.grid-tools.com/)。它们具有一组功能和应用程序，可以生成所需格式的测试数据并将其存储在本地 mySQL 表/excel 中。

请注意，这不是免费工具，它涉及许可费用。

# algorithm - 将用户帐户分配到 N 个表

> ID：824754
> 
> 赞同：1
> 
> 时间：2009-05-05T13:03:39.587
> 
> 标签：algorithm, hash, distribution

有数百万个用户帐户，我想将他们的数据分发到数据库的 N 个表（user_1，user_2，...，user_N）中。用户帐号由 3~8 个字符组成。所以，我想要一个返回表后缀的函数

```
 int getTableSuffix(String userAccount); 
```

结果是从 1 到 N 的均匀分布。

你知道这项工作有什么便宜的哈希算法吗？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-05-05T13:13:50.967

您可以取前 1-3 个字符的 ascii 值并找到这些字符的乘积以返回您的号码。

或者，您实际上可以使用字符作为表前缀，例如。用户_AA、用户_AB等

但是，您使用什么数据库存储这些数据？在大多数现代数据库中，您应该不需要创建多个表来存储相同的数据。即使有数百万条记录。表上的良好索引应该足以解决您可能遇到的任何性能问题。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-05-05T13:52:04.993

目前尚不清楚您是在寻找字符串散列函数，还是基于字符串的分区方法。

一个好的字符串散列函数使用每个字符，并考虑字符的位置。例如，djb2 使用这样的东西（伪代码）：

```
hash = 5381
foreach (ch in str) 
  hash = hash * 33 + ch 
```

无论您的哈希是什么，都使用模运算按表的数量进行分区：

```
table = hash % count 
```

我建议使用数据库的内置分区功能（如果有的话）。

# javascript - Firefox 3.5 不允许使用 Javascript 创建 OBJECT 标签？

> ID：824755
> 
> 赞同：0
> 
> 时间：2009-05-05T13:04:01.457
> 
> 标签：javascript, firefox

Firefox 3.5 不允许使用 Javascript (document.write) 创建 java OBJECT 标签？

此技术适用于*所有*其他浏览器和较旧的 firefox。

这是新的安全限制吗？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-05-05T13:51:10.597

我测试了对象标签的javascript创建和java的普通对象标签。似乎 3.5 beta 4 中存在一个错误，它没有显示对象标签的插件信息消息。

它与javascript无关。

# polymorphism - 多态性是重载的另一个术语吗？

> ID：824763
> 
> 赞同：20
> 
> 时间：2009-05-05T13:04:41.003
> 
> 标签：polymorphism, overloading, terminology

多态性是重载的另一个术语吗？

* * *

## 回答 #1

> 赞同：43
> 
> 时间：2009-05-05T13:06:21.390

不; 重载是使用不同数量的参数或具有其他类型的参数创建具有相同名称的方法。

多态性是关于跨各种类型（都具有相同的“基本类型”）更改特定方法的实现/功能。

重载：

```
public class TestClass
{
    public void DoSomething( int a, int b ) {}

    public void DoSomething( int a, int b, string x ) {}
} 
```

多态性：

```
public abstract class Base
{
    public abstract DoSomething();
}

public class A : Base
{
    public override DoSomething()
    {
         Console.WriteLine("I am A");
    }
}

public class B : Base
{
     public override DoSomething()
     {
         Console.WriteLine("I am B");
     }
} 
```

* * *

## 回答 #2

> 赞同：10
> 
> 时间：2009-05-05T13:08:35.690

多态性和方法重载之间的区别在于确定要执行的实际方法的时间。这样做的原因是当方法被重载时，例如：

```
account = new BankAccount();
account = new BankAccount(1000); 
```

编译器可以通过方法签名来判断使用哪个构造函数，包括提供的参数的数量和类型。在程序运行之前，在编译时选择使用的方法称为早期绑定。另一方面，当我们使用诸如 x.getMeasure() 之类的多态方法调用时，实际调用的 getMeasure() 方法取决于 x 所指的对象类型。因为在程序运行之前不会构造对象，所以调用的方法是在运行时确定的。因此，虚拟机，而不是编译器选择了合适的方法。这种方法选择称为后期绑定。

* * *

## 回答 #3

> 赞同：5
> 
> 时间：2009-05-05T13:16:47.357

不。

**[多态性](http://en.wikipedia.org/wiki/Polymorphism_%28computer_science%29)**是一种编程语言功能，它允许使用统一接口处理不同数据类型的值。参数多态性的概念适用于数据类型和函数。可以计算或应用于不同类型值的函数称为多态函数。可以看起来是通用类型的数据类型（例如，具有任意类型元素的列表）被指定为多态数据类型，就像进行这种专门化的通用类型一样。

**[方法重载](http://en.wikipedia.org/wiki/Method_overloading)**是各种编程语言（如 Ada、C#、C++、D 和 Java）中的一种功能，它允许创建多个具有相同名称的方法，这些方法在输入类型和类型方面彼此不同。函数的输出。

方法重载不应与类型多态性或虚函数相混淆。其中，在运行时选择正确的方法。

资料来源：维基百科。

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2009-05-05T13:13:54.600

不它不是。

**重载**是指创建具有相同名称但参数不同的方法或运算符，并且 - 根据语言 - 不同的返回类型。

**覆盖**是指在派生类中重新实现具有相同签名的方法并启用多态性 - 在运行时根据对象的实际类型决定要调用的覆盖方法的实现。

```
class BaseClass
{
     public void DoStuff(Int32 value) { } // Overloading

     public void DoStuff(String value) { } // Overloading

     public virtual void DoOtherStuff(String value) { }
}

class DerivedClass : BaseClass
{
    public override void DoOtherStuff(String value) { } // Overriding
} 
```

使用示例

```
BaseClass instance = null;

if (condition)
{
    instance = new BaseClass();
}
else
{
    instance = new DerivedClass();
}

// Using overloads
instance.DoStuff(4);
instance.DoStuff("four");

// Polymorphism - it depends on the actual type of the object
// referenced by the variable 'instance' if BaseClass.DoOtherStuff()
// or DerivedClass.DoOtherStuff() will be called at runtime.
instance.DoOtherStuff("other stuff"); 
```

# wpf - WPF PathGeometry/RotateTransform 优化

> ID：824766
> 
> 赞同：0
> 
> 时间：2009-05-05T13:05:59.533
> 
> 标签：wpf, xaml, optimization, rotatetransform

渲染/旋转 WPF 三角形时出现性能问题

如果我显示了一个 WPF 三角形并且它将围绕中心点旋转一定程度，我可以通过以下两种方式之一进行：

1.  以编程方式确定后端中的点及其偏移量，使用 XAML 将它们简单地放置在它们所属的画布上，如下所示：

    ```
    <Path Stroke="Black">
       <Path.Data>
          <PathGeometry>
             <PathFigure StartPoint ="{Binding CalculatedPointA, Mode=OneWay}">
                <LineSegment Point="{Binding CalculatedPointB, Mode=OneWay}" />
                <LineSegment Point="{Binding CalculatedPointC, Mode=OneWay}" />
                <LineSegment Point="{Binding CalculatedPointA, Mode=OneWay}" />
             </PathFigure>
          </PathGeometry>
       </Path.Data>
    </Path> 
    ```

2.  每次都生成“相同”的三角形，然后使用 RenderTransform (Rotate) 将其放在它所属的位置。在这种情况下，旋转计算被混淆了，因为我无法访问它们是如何完成的。

    ```
    <Path Stroke="Black">
       <Path.Data>
          <PathGeometry>
             <PathFigure StartPoint ="{Binding TriPointA, Mode=OneWay}">
                <LineSegment Point="{Binding TriPointB, Mode=OneWay}" />
                <LineSegment Point="{Binding TriPointC, Mode=OneWay}" />
                <LineSegment Point="{Binding TriPointA, Mode=OneWay}" />
             </PathFigure>
          </PathGeometry>
       </Path.Data>
       <Path.RenderTransform>
          <RotateTransform CenterX="{Binding Centre.X, Mode=OneWay}" 
                           CenterY="{Binding Centre.Y, Mode=OneWay}"
                           Angle="{Binding Orientation, Mode=OneWay}" />
       </Path.RenderTransform>
    </Path> 
    ```

我的问题是哪个更快？

我知道我应该自己测试它，但是我如何测量具有这种粒度的对象的渲染时间。我需要能够计算表单的实际渲染时间有多长，但由于我不是开始重绘的人，所以我不知道如何捕获开始时间。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2009-08-26T19:59:47.500

您可以像这样覆盖表单的 OnPaint 方法（伪代码）：

```
private void OnPaint(...)
{
    // Start timer

    base.OnPaint(...);

    // Stop timer
 } 
```

还是我太天真了？

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-05-06T20:54:56.030

您是否尝试过使用[WPF 性能工具](http://msdn.microsoft.com/en-us/library/aa969767.aspx)中包含的 Perforator 或 Visual Profiler ？从文档看来，这些工具应该能够为您提供您正在寻找的信息。您必须以第一种方式构建应用程序，使用这些工具对其进行测试，记下性能信息，然后使用第二种方式构建的应用程序重新进行比较。

# unit-testing - 对通用 API 的 BDD 场景的建议？

> ID：824767
> 
> 赞同：2
> 
> 时间：2009-05-05T13:06:09.270
> 
> 标签：unit-testing, bdd

我正在为我的应用程序的 API 部分整理受 BDD 启发的单元测试。（是的，我知道，BDD 应该是关于域并与西装交谈，但我宁愿先在不太明显的东西上尝试 BDD）

*   **普通用途。** 开发人员使用具有普通参数值的 API 方法。

*   **极端使用**。开发人员使用异常大/小参数调用 API。例如， zip() 方法传递了一个 2 GB 的文件。

*   **API 滥用。**开发人员使用疯狂的参数调用 API——疯狂的程序员会将日期传递给整数参数，对吧？——参数被遗忘，等等。

*   **恶意黑客攻击**。开发人员并不关心 API 的用途，而是寻找执行任意代码的方法。测试将包括 JavaScript、SQL，只是为了看看我们是否可以让它们在任何地方执行。

还有其他我应该考虑的情况吗？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-05-06T19:54:53.460

当然，总是有更多的场景需要考虑。坦率地说，有一个实际上无限的场景池。这是一个非常开放的问题。

对于恶意黑客攻击场景，你应该只关心明显的缓冲区溢出点，然后坚持测试确认的安全漏洞，以免意外重新打开它们。并且无论何时你确实得到了一个确认的漏洞，寻找代码中使用类似编程技术和模式的每个地方，并抢先测试/修复它们。然而，在很多情况下，模糊测试会给你带来更好的结果。自动化测试是处理安全问题的重要组成部分，但绝不应该是工具箱中的主要工具。

其他需要考虑的事情可能是特定于数据的。例如，在解析日期时，请务必处理 2/29/2009 或 9/31/2009 之类的内容。如果可以，请尝试处理 1/1/1900 和 12/31/2038（您的图书馆可能不允许您）。

您可以做的一件事是检查您正在进行的所有库调用的文档，找出在哪些条件下引发了哪些异常，并故意尝试查找将触发这些异常的输入，然后确保您有测试验证是否处理了这些异常，或者在库代码的情况下，记录了这些异常。

代码覆盖工具和代码变异还可以帮助您识别以前没有被覆盖的场景。

# jsp - 使用 Jboss Portal，如何在 jsp 中检索页面属性？

> ID：824777
> 
> 赞同：0
> 
> 时间：2009-05-05T13:10:43.203
> 
> 标签：jsp, properties, jboss-portal

使用**Jboss 门户**，如何在 jsp 中检索页面属性？

我已经在以下位置声明了我的页面`*-object.xml file`：

```
<page>
  <page-name>MyPage</page-name>
  <properties>
    <property>
      <name>layout.id</name>
      <value>generic</value>
    </property>
    <property>
      <name>hidePanel</name>
      <value>true</value>
    </property>
  </properties>
</page> 
```

我想访问`hidePanel`.jsp 文件中的属性`generic layout`。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2009-05-06T08:40:43.517

我找到了答案。

从 jsp 中检索页面属性：

```
<%
  PageResult pageResult = (PageResult) request.getAttribute("PAGE");
  boolean hidePanel = Boolean.valueOf(pageResult.getProperty("hidePanel")));
%> 
```

# java - Spring的@Required注解推荐用法

> ID：824778
> 
> 赞同：11
> 
> 时间：2009-05-05T13:10:59.163
> 
> 标签：java, spring

我看到Spring有一个`@Required`注释来标记必须设置的bean中的成员变量。

有使用它的最佳实践吗？

例如，在构造函数中设置这些值并明确要求这些参数是否更好（尤其是在 Spring 之外使用时）？

谢谢！

* * *

## 回答 #1

> 赞同：13
> 
> 时间：2009-05-05T13:37:06.010

虽然没有直接引用**@Required**注释，但 Martin Fowler 提供了[这个建议](http://martinfowler.com/articles/injection.html#ConstructorVersusSetterInjection)......

他更喜欢在构造函数中而不是在 setter 中设置对象值，因为它会“*让您清楚地说明在明显的位置创建有效对象的含义*”，同时它还“*允许您清楚地隐藏任何不可变的字段通过简单地不提供设置器*“。

# c# - 这个接口的最佳名称是什么？

> ID：824781
> 
> 赞同：2
> 
> 时间：2009-05-05T13:11:46.837
> 
> 标签：c#, .net

我有一个接口，它定义了将实体持久保存到数据存储的能力。我很难想出它的名字。有任何想法吗？

```
public interface IInterfaceForDefiningADataPersistenceOperation<T>
{
    void Store(T entity);
} 
```

* * *

## 回答 #1

> 赞同：15
> 
> 时间：2009-05-05T13:13:01.873

`IRepository`?

* * *

## 回答 #2

> 赞同：8
> 
> 时间：2009-05-05T13:13:31.777

怎么样`IFooRepository`，`Foo`一些基础实体或描述产品在哪里。如果它真的是通用的，那么也许只是`IRepository<T>`

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2009-05-05T13:13:37.347

```
public interface IPersistenceStrategy<T> 
```

我迈出了一大步，并说您正在使用[策略模式](http://en.wikipedia.org/wiki/Strategy_pattern)，以便根据您提供的策略以不同的方式持久化事物。

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2009-05-05T13:14:51.917

你不喜欢这些吗？

*   持久化操作
*   IDataStore 操作
*   IEntityStore操作

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2009-05-05T13:24:34.387

持久实体

然后你可以派生类 MyNewPersistenceThing ： IPersistEntities

* * *

## 回答 #6

> 赞同：1
> 
> 时间：2009-05-05T14:09:18.557

我会选择 IStorable

* * *

## 回答 #7

> 赞同：0
> 
> 时间：2009-05-05T13:15:06.843

接口不是定义一组操作，而不是“操作”吗？

* * *

## 回答 #8

> 赞同：0
> 
> 时间：2009-05-05T13:23:46.450

网关

然后实现是（例如）：UserGateway、ArticleGateway 等等

* * *

## 回答 #9

> 赞同：0
> 
> 时间：2009-05-05T14:42:05.777

如果您的界面遵循[存储库模式](http://martinfowler.com/eaaCatalog/repository.html)，那么我将使用 IRepository。

如果不是，那么也许[IDataMapper](http://martinfowler.com/eaaCatalog/dataMapper.html)更合适。

# java - 将 3rd 方库安装到托管的 Maven 存储库的最佳实践？

> ID：824782
> 
> 赞同：6
> 
> 时间：2009-05-05T13:11:48.303
> 
> 标签：java, maven-2

假设您有一个使用 3rd 方库的项目，例如[Google 的 Analytics Data API (gdata)](http://code.google.com/apis/gdata/)，目前似乎没有部署到任何知名或流行的 Maven 公共存储库/索引中。这不是什么大问题，因为我可以将工件部署到本地托管的 Nexus 存储库中。

但是，Maven 社区中是否有任何最佳实践来说明我应该如何在我的 POM 中命名这个库的“坐标”，因为尚未在公共存储库中为它设置标准？

例如，我应该在我的 POM 中将其称为

```
<dependency>
    <groupId>com.google</groupId>
    <artifactId>gdata-analytics</artifactId>
    <version>1.0</version>
</dependency> 
```

还是有一些更好/更标准的方法让我想出`artifactId`？

（而且，为什么像谷歌这样的几十个库的提供者不努力将它们托管到主流的公共 Maven 存储库/索引中？这不是让人们更容易使用它们，从而驱动领养？）

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2009-05-05T13:50:40.067

我已经使用 Maven 大约一年了，从未遇到过“标准”命名约定。我通常会完全按照您的操作进行操作，尽管我尝试使版本号尽可能接近“真实”版本号，以免在部署多个版本时出现混淆。

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2009-05-05T14:38:01.513

你所做的很合理。一些额外的点：

*   当 Maven 从 Nexus 获取工件时，该工件被命名为 artifactId-version。GroupId 令人讨厌地被省略了。因此，当工件被移动时（例如，复制到 Web 应用程序中的 WEB-INF/lib 中），您的 jar 文件将显示为“ **gdata-analytics-1.0** ”。这通常不是问题。但是，如果工件名称很常见，例如“util”，您可能希望在 artifactId 中包含组信息，例如使用“com.google”的 groupId**和“** **com.google.gdata-analytics** ”的 artifactId 。是的，重复很烦人，但它在文件系统和搜索中产生了最大的清晰度。我实际上遇到了一个问题，两个不同的 groupIds 都有一个“ **core-1.0**" jar，并且一个在构建时被复制到 lib 目录时覆盖了另一个。

*   我支持 MattK 的建议，即将您的 Maven versionId 与工件众所周知的任何版本对齐。

*   如果您遵循 Dominic 的建议，在 groupId 前加上您自己的公司名称（例如 acme），可能会更容易利用 Nexus 的路由功能。它将确保对内部工件的请求不会传播到 Maven Central 并最终出现在它们的日志中（如果您的 groupId 是“ **acme.secret.project** ”，这可能很重要！

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2009-05-05T14:18:55.380

我倾向于在 groupId 前面加上我自己常用的 groupId。这清楚地表明这是我上传的东西，以防万一它泄露给整个世界。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2009-05-05T17:07:58.203

许多 sourceforge 项目在 groupid 中使用项目名称，例如：

GroupId net.sf.json-lib ArtifactId json-lib

这在 google 示例中可能是合适的，因为有很多 google 工件。

请记住，您可以使用分类标记来区分相同版本但为不同目的而构建的两个 jar，例如不同的 JVM。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2009-07-09T05:00:01.920

你可能很幸运：谷歌有他们自己的项目的 Maven 存储库。请参阅此页面：[说明](http://code.google.com/p/google-maven-repository/wiki/ProjectSetup)

我有一些专有的 Jar 文件，所以我必须在每个工作站上加载它们（我们还没有公司共享 repo）。我将它们放在 /lib 目录中的源代码树中（并不总是一个好主意），并添加了一个包含 mvn install-file 命令的小 .BAT 文件（或 .sh 脚本）以首先加载我的本地机器的 repo我建造的时间。如果我必须更新这些 jar，我也会更新“load.bat”文件，然后重新运行它。在我的情况下，我不希望这种情况每年发生一次以上，也许更少。

# ruby-on-rails - Rails 应用程序随机崩溃并出现错误“脚本标题过早结束”

> ID：824783
> 
> 赞同：13
> 
> 时间：2009-05-05T13:12:04.573
> 
> 标签：ruby-on-rails, passenger, dreamhost

我在 DreamHost 上托管 Ruby on Rails 2.0.2 应用程序。它位于 Apache 2 服务器上，运行在 Phusion Passenger 之上。

该应用程序经常返回一个 500 错误“Rails 应用程序无法正常启动”，但时间是随机的。当应用程序处于较高负载时似乎会发生这种情况，但我无法确认这一点。它每天只有大约 2,000 次浏览量，所以我认为负载应该不是问题。

Apache 日志将这 500 个响应与错误相关联：“脚本标头过早结束”。只看今天上午 9 点的日志，错误出现的频率高达每分钟三到四次。这显然是不可接受的。

不太常见的是，应用程序会抛出一个带有堆栈跟踪和错误“Broken pipe”的 Phusion Passenger 页面。

Rails 日志没有列出任何这些错误。

这发生在 DreamHost 上托管的登台和实时站点上，但我无法在本地开发服务器上复制它。

所以我想真正的问题是：**我从哪里开始调试这个问题？**

* * *

## 回答 #1

> 赞同：9
> 
> 时间：2009-05-06T23:22:45.550

事实证明，我只是在 DreamHost 共享服务器上达到了内存上限。

我在一个帐户下运行多个 Rails 应用程序，其中许多只是用于测试和原型设计。Rails 使用大量内存，所以我很快就达到了我的分配。支持人员告诉我“我检查了我们的日志，它在过去三天里杀死了你的一个 ruby​​ 进程 2325 次”。*哎呀。*

解决方案：尽量不要在共享环境中运行 Rails，如果可以的话。我将很快将我的至少一个应用程序切换到 VPS 主机。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-05-05T15:11:57.657

您是否正在运行最新版本的乘客（撰写本文时为 2.2.2）。我自己有一些错误，但大多数（如果不是全部）在升级我的乘客安装后消失了。

如果这不是答案，您可以随时尝试将您的 rails 版本升级到 2.3 并查看问题是否仍然存在。

# c# - C#：如何获取一个类型的所有公共（获取和设置）字符串属性

> ID：824802
> 
> 赞同：68
> 
> 时间：2009-05-05T13:15:28.903
> 
> 标签：c#, reflection

我正在尝试创建一种方法，该方法将遍历泛型对象列表并替换其所有类型的属性，该类型的属性`string`要么为`null`空，要么为空。

如何做到这一点的好方法？

我有这种......外壳......到目前为止：

```
public static void ReplaceEmptyStrings<T>(List<T> list, string replacement)
{
    var properties = typeof(T).GetProperties( -- What BindingFlags? -- );

    foreach(var p in properties)
    {
        foreach(var item in list)
        {
            if(string.IsNullOrEmpty((string) p.GetValue(item, null)))
                p.SetValue(item, replacement, null);
        }
    }
} 
```

那么，我如何找到一个类型的所有属性：

*   类型的`string`

*   已公开`get`

*   已公开`set`

    ?

* * *

我做了这个测试课：

```
class TestSubject
{
    public string Public;
    private string Private;

    public string PublicPublic { get; set; }
    public string PublicPrivate { get; private set; }
    public string PrivatePublic { private get; set; }
    private string PrivatePrivate { get; set; }
} 
```

以下不起作用：

```
var properties = typeof(TestSubject)
        .GetProperties(BindingFlags.Instance|BindingFlags.Public)
        .Where(ø => ø.CanRead && ø.CanWrite)
        .Where(ø => ø.PropertyType == typeof(string)); 
```

如果我打印出我到达那里的那些属性的名称，我会得到：

> 公共公共公共私人私人公共

换句话说，我得到的两个属性太多了。

* * *

***注意**：这可能会以更好的方式完成......使用嵌套的 foreach 和反射等等......但是如果您有任何好的替代想法，请告诉我，因为我想学习！*

* * *

## 回答 #1

> 赞同：114
> 
> 时间：2009-05-05T13:28:31.460

你的代码重写了。不使用 LINQ 也不使用 var。

```
public static void ReplaceEmptyStrings<T>(List<T> list, string replacement)
{
    PropertyInfo[] properties = typeof(T).GetProperties(BindingFlags.Public | BindingFlags.Instance);

    foreach (PropertyInfo p in properties)
    {
        // Only work with strings
        if (p.PropertyType != typeof(string)) { continue; }

        // If not writable then cannot null it; if not readable then cannot check it's value
        if (!p.CanWrite || !p.CanRead) { continue; }

        MethodInfo mget = p.GetGetMethod(false);
        MethodInfo mset = p.GetSetMethod(false);

        // Get and set methods have to be public
        if (mget == null) { continue; }
        if (mset == null) { continue; }

        foreach (T item in list)
        {
            if (string.IsNullOrEmpty((string)p.GetValue(item, null)))
            {
                p.SetValue(item, replacement, null);
            }
        }
    }
} 
```

* * *

## 回答 #2

> 赞同：14
> 
> 时间：2009-05-05T13:21:04.117

您将使用 找到这些属性`BindingFlags.Public | BindingFlags.Instance`。然后，您需要通过检查 CanWrite 和 CanRead 属性来检查每个 PropertyInfo 实例，以确定它们是否可读和/或可写。

更新：代码示例

```
PropertyInfo[] props = yourClassInstance.GetType().GetProperties(BindingFlags.Public | BindingFlags.Instance);
for (int i = 0; i < props.Length; i++)
{
    if (props[i].PropertyType == typeof(string) && props[i].CanWrite)
    {
        // do your update
    }
} 
```

* * *

在您更新后，我对其进行了更详细的研究。如果您还检查 GetGetMethod 和 GetSetMethod 返回的 MethodInfo 对象，我认为您将达到目标；

```
 var properties = typeof(TestSubject).GetProperties(BindingFlags.Instance | BindingFlags.Public)
        .Where(ø => ø.CanRead && ø.CanWrite)
        .Where(ø => ø.PropertyType == typeof(string))
        .Where(ø => ø.GetGetMethod(true).IsPublic)
        .Where(ø => ø.GetSetMethod(true).IsPublic); 
```

默认情况下，这两个方法只返回公共 getter 和 setter（在这种情况下会冒 NullReferenceException 的风险），但`true`如上传递会使它们也返回私有的。然后您可以检查`IsPublic`（或`IsPrivate`）属性。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2009-05-05T13:25:13.090

如果您不指定任何绑定标志，您将获得公共的实例属性——这就是您想要的。但随后您将需要检查 PropertyInfo 对象上的 PropertyType 是否为 String 类型。除非您事先知道，否则您还需要检查该属性是否如@Fredrik 指示的那样可读/可写。

```
using System.Linq;

public static void ReplaceEmptyStrings<T>(List<T> list, string replacement)
{
    var properties = typeof(T).GetProperties()
                              .Where( p => p.PropertyType == typeof(string) );
    foreach(var p in properties)
    {
        foreach(var item in list)
        {
            if(string.IsNullOrEmpty((string) p.GetValue(item, null)))
                p.SetValue(item, replacement, null);
        }
    }
} 
```

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2010-05-03T08:25:38.477

[http://jefferytay.wordpress.com/2010/05/03/simple-and-useful-tostring/](http://jefferytay.wordpress.com/2010/05/03/simple-and-useful-tostring/)

对于一个 tostring 覆盖方法，它允许您获取该类的所有属性

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2009-05-05T13:19:44.307

BindingFlags.Public | BindingFlags.Instance 应该这样做

获取设置方法（）

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2009-05-05T13:25:11.237

我建议一种不同的方法：[AOP](http://en.wikipedia.org/wiki/Aspect-oriented_programming)。
您可以拦截设置器并将所需的值设置为有效值。使用[PostSharp](http://www.postsharp.org/)，这很容易。

* * *

## 回答 #7

> 赞同：0
> 
> 时间：2009-05-05T13:45:36.037

我同意其他答案，但我更喜欢重构搜索本身以便使用 Linq 轻松查询，因此查询可能如下：

```
 var asm = Assembly.GetExecutingAssembly();
        var properties = (from prop
                              in asm.GetType()
                                .GetProperties(BindingFlags.Public | BindingFlags.Instance)
                          where 
                            prop.PropertyType == typeof (string) && 
                            prop.CanWrite && 
                            prop.CanRead
                          select prop).ToList();
        properties.ForEach(p => Debug.WriteLine(p.Name)); 
```

我以 Assembly 类型为例，它没有读/写字符串属性，但如果相同的代码搜索只是读取属性，结果将是：

*   代码库
*   转义代码库
*   全名
*   地点
*   图像运行时版本

哪些是**字符串** **只读程序**集类型属性

# c# - 让 DataContractSerializer 以两种不同的方式序列化同一个类？

> ID：824804
> 
> 赞同：2
> 
> 时间：2009-05-05T13:15:52.507
> 
> 标签：c#, .net, wcf

我正在使用 DataContractSerializer 将标有 DataMember 属性的对象属性和字段序列化为 xml。

现在，同一个类有另一个用例，我需要序列化其他属性和其他字段。

有没有办法添加可用于我的其他序列化场景的“另一个 DataMemberAttribute”？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-05-05T13:36:14.843

不，基本上。

如果要使用现有的`DataContractSerializer`，则必须维护 DTO 类的第二个版本并在它们之间转换数据。

如果您正在编写自己的序列化代码，则选项：

*   声明您自己的`[DataMember]`-style 属性并在运行时在您自己的序列化代码中解释它们
*   使用“伙伴班”
*   使用外部元数据（例如文件）
*   使用基于代码的配置（即通过 DSL）

实际上，我希望第一个将是最简单的选择。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-05-07T00:23:17.433

在过去的类似场景中，我们采用了面向对象的方法，并创建了一个从主类扩展的新类。为了帮助您使用 DataContractSerializer 实现继承，请查看[KnownTypeAttribute](http://msdn.microsoft.com/en-us/library/system.runtime.serialization.knowntypeattribute.aspx)

在您对问题的评论之一中，

> 如果同一个类实现多个接口，某些数据元素可能只与其中一个接口相关。

如果在您的场景中是这种情况，那么您的数据服务合同可能应该只公开接口，而不是类？

例如，如果您有这样的课程：

```
[DataContract]
public class DataObject : IRed, IBlue 
```

那么您有两个操作合同，一个用于 IRed，一个用于 IBlue，而不是让您的操作合同公开 DataObject。这消除了对自定义序列化代码的需要。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-05-06T21:59:51.130

有办法做到这一点，但这是一个丑陋的黑客。

`DataContractSerializer`可以序列化实现`IXmlSerializable`接口的对象。您可以实现接口并创建自己的`ReadXml(XmlReader reader)`方法`WriteXml(XmlWriter writer)`和可以以不同方式序列化对象的方法。

请注意，您必须在类本身中嵌入一个标志，以确定序列化对象的方式。（没有办法告诉使用`DataContractSerializer`哪种模式，所以标志必须包含在对象本身中。）

正如@Marc 建议的那样，DTO 类的第二个版本会更干净。

# windows - 在 Windows 中切断/终止 tcp 连接

> ID：824818
> 
> 赞同：7
> 
> 时间：2009-05-05T13:19:17.223
> 
> 标签：windows, tcp, connection, kill

我想看看程序在连接断开时如何响应。除了禁用网卡之外，有没有办法在 Windows 中切断 tcp 连接而不杀死进程或拥有连接的线程？

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2009-05-05T13:41:15.377

我发现最接近产生操作系统错误的方法是使用[TcpView 之](http://technet.microsoft.com/en-us/sysinternals/bb897437.aspx)类的东西来查看打开的套接字并切断它们。我不确定它究竟做了什么来切断连接，但它确实以应用程序可以看到的方式关闭它。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2009-05-05T13:43:23.267

[SysInternals](http://www.microsoft.com/technet/sysinternals)的 TCPView可让您关闭连接（并查看所有打开的连接）。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-05-05T13:22:03.847

我见过的一件事是以可以远程切断连接的方式编写网络代码。我曾经做过的一个产品就是这样写的。我们甚至进行了一组随机断开连接的酷刑测试。该产品旨在进行交易，并且了解其行为方式具有启发性。

当然，我们随后发现了一个客户，其网络实际上一直在断开连接，并且很高兴我们进行了如此艰苦的测试。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2009-05-05T13:40:24.723

为什么不直接拔掉网线？

# php - 过滤 PHP 的 $_SERVER['PHP_SELF']

> ID：824822
> 
> 赞同：0
> 
> 时间：2009-05-05T13:20:12.480
> 
> 标签：php, security

我需要过滤不可靠的 $_SERVER['PHP_SELF'] 变量。这是一个好方法吗：

```
function filterPhpSelf($str) 
{
    $phpself = basename(__FILE__);
    $str = substr($str, 0, strpos($str,$phpself)) . $phpself;
    return $unsafeStr;
} 
```

$str 是 $_SERVER['PHP_SELF']？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-05-05T13:54:08.310

1）如果运行，您的代码将引发错误。

2)`$_SERVER['PHP_SELF']`不是不安全的。不安全地使用它是不安全的。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-05-05T14:07:23.363

是的，那会做。虽然你会想要改变：

```
return $unsafeStr; 
```

至

```
return $str; 
```

# wpf - 如何减少 WPF 应用程序的 CPU 使用率？

> ID：824832
> 
> 赞同：4
> 
> 时间：2009-05-05T13:21:43.833
> 
> 标签：wpf, performance, cpu

大约 30 分钟后，我的 WPF 应用程序使用了高 CPU 使用率，然后我中断了应用程序以找出哪些代码使用了高 CPU 使用率，但我什么也没得到。

Visual Studio 2008 无法显示当前正在运行的代码，但我在“调用堆栈”面板中找到了这个：

```
[在睡眠中，等待，或加入]
mscorlib.dll!System.Threading.WaitHandle.WaitAny(System.Threading.WaitHandle[] waitHandles, int millisecondsTimeout, bool exitContext) + 0x8f 字节
System.dll!System.Net.TimerThread.ThreadProc() + 0x2f9 字节    
mscorlib.dll!System.Threading.ThreadHelper.ThreadStart_Context（对象状态）+ 0x66 字节   
mscorlib.dll!System.Threading.ExecutionContext.Run(System.Threading.ExecutionContext executionContext, System.Threading.ContextCallback 回调, 对象状态) + 0x6f 字节    
mscorlib.dll!System.Threading.ThreadHelper.ThreadStart() + 0x44 字节   

```

这是什么？CPU使用率高有什么问题？以及如何降低 CPU 使用率？

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2009-05-15T03:03:58.340

我们使用“WPF 性能分析工具”/Visual Profile 来找出哪些事件占用 CPU 最多。Tick(TimeManager.Tick()) 占用了应用程序大约 40% 的 CPU 使用率。然后我们将所有的 Animation-Controls 一个一个地删除，最后，我们发现有一个故事板会在大约 30 分钟后增加 CPU 使用率。

然后我们改变了形式：

```
 calendarStoryboard.Begin(txtMessage, HandoffBehavior.Compose, true); 
```

到

```
 calendarStoryboard.Begin(txtMessage, HandoffBehavior.SnapshotAndReplace, true); 
```

这个问题是固定的。关于 HandoffBehavior 的更多信息请参考 msdn：

[http://msdn.microsoft.com/en-us/library/system.windows.media.animation.handoffbehavior.aspx](http://msdn.microsoft.com/en-us/library/system.windows.media.animation.handoffbehavior.aspx)

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-05-05T13:32:21.327

你应该看看其他线程，我认为显示线程的切换在 Visual Studio 的调试菜单中。“[在睡眠、等待或加入中”意味着线程不能做任何事情，因为它正在等待另一个线程完成它的操作。

它可能会在某个地方陷入无限循环，无论是有意还是无意（故意，例如某些 UI 事物不断重绘，如动画或其他东西）无论它是什么，它都不在堆栈中显示的当前线程中。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2009-05-05T13:34:13.320

您有一些选项可以跟踪您的问题。我将从 Visual Studio 2008 中的性能向导开始。您可以在分析菜单上找到它。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2009-05-05T13:27:00.200

我不是 WPF 专家，但您在此处显示的调用堆栈可能不是您的问题。该线程正在等待其他一些同步对象并且没有做任何工作。VS 无法显示正在运行的代码的原因是因为它在本机代码中等待（一旦您调用 WaitAny()，我相信您调用了执行实际等待的本机 OS 构造）。

您的 WPF 进程中是否有任何其他线程正在运行可能会占用 CPU 时间？

# javascript - 打开 jQuery 对话框时如何保留文本选择

> ID：824833
> 
> 赞同：2
> 
> 时间：2009-05-05T13:21:54.457
> 
> 标签：javascript, jquery, html, selection

使用 jQuery 的对话框，我遇到了以下怪癖（在 FF3 中测试）：

1.  用户选择文本
2.  在代码中，打开一个 jQuery 对话框
3.  BUG：文本被取消选中

（文本可以在文本区域中，也可以只是页面上的 HTML）

所以，对我来说，这似乎是一个有趣（和烦人）的错误或怪癖，但也许有一个很好的解释。最让我感兴趣的是，打开对话框后如何保留此文本选择？

这是一些代码：

```
function getSelectedText() {
 var t;
 if (d.getSelection) t = d.getSelection();
 else if(d.selection) t = d.selection.createRange();
 if (t.text != undefined) t = t.text;
 if (!t || t=='') {
  var a = d.getElementsByTagName('textarea');
  for (var i = 0; i < a.length; ++i) {
   if (a[i].selectionStart != undefined && a[i].selectionStart != a[i].selectionEnd) {
    t = a[i].value.substring(a[i].selectionStart, a[i].selectionEnd);
    break;
   }   
  }   
 }   
 return t;
}

 $("#dialog").dialog({
    autoOpen: false,
    bgiframe: false,
    height: 60,
    width: 80,
    modal: false,
    show: 'highlight',
    title: 'wc'});
 alert(getSelectedText()); // Text is here      
 $("#dialog").dialog("open");
 alert(getSelectedText()); // Text is not selected here :( damn! 
```

谢谢！

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-05-26T04:54:58.130

jQuery 对话框将获得用户的关注（您应该会看到在对话框中选择的按钮之一）。浏览器只有 1 个焦点，因此您会丢失他们选择的任何内容。

您应该在执行对话框之前检索用户选择的开始和结束位置，然后在对话框消失后重新选择它。

我没有任何用于获取和设置用户选择的示例代码，但是网络搜索应该会找到一些。

就像是 ：

```
$("dialog").focus(function() {
  // save the selection
}).blur(function() {
  // set the text selection
}); 
```

[已编辑（Nickolay）：有关更多代码，请参阅[焦点更改时保持文本选择]](https://stackoverflow.com/questions/1592637/keep-text-selection-when-focus-changes/1592906#1592906)

# php - PHP5 中是否可以使用“调用”样式的回调？

> ID：824834
> 
> 赞同：0
> 
> 时间：2009-05-05T13:22:03.053
> 
> 标签：php, callback, invoke

诸如“array_map”之类的 PHP 函数接受一个回调，它可以是一个简单的函数，也可以是一个类或对象方法：

```
$array2 = array_map('myFunc', $array); 
```

或者

```
$array2 = array_map(array($object, 'myMethod'), $array); 
```

但是是否有一种语法可以将迭代中绑定的方法传递给当前对象（如 Prototype.js 中的“invoke”）？以便可以使用以下内容：

```
$array2 = array_map('myMethod', $array); 
```

具有以下效果

```
foreach($array as $obj) $array2[] = $obj->myMethod(); 
```

显然我可以使用这种形式，或者我可以编写一个包装函数来进行调用，甚至可以内联。但由于“myMethod”已经是一种方法，它似乎正在绕着房子走，不得不做其中的一个。

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2009-05-05T13:57:26.167

不是现在。当 php 5.3 出现时，您可以使用以下语法：

```
$array2 = array_map(function($obj) { return $obj->myMethod(); }, $array); 
```

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2009-05-05T13:58:09.563

```
function obj_array_map($method, $arr_of_objects) {
    $out = array();
    $args = array_slice(func_get_args(), 2);
    foreach ($arr_of_objects as $key => $obj) {
        $out[$key] = call_user_func_array(Array($obj, $method), $args);
    }
    return $out;
}

// this code
$a = Array($obj1, $obj2);
obj_array_map('method', $a, 1, 2, 3);

// results in the calls:
$obj1->method(1, 2, 3);
$obj2->method(1, 2, 3); 
```

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2009-05-05T13:57:33.327

基本上，没有。没有特殊的语法可以使这更容易。

我可以想到在 PHP 5.3 中执行此操作的一种更好的方法，因为在 PHP 中做事的方法总是不止一种，但我想说它不一定比你的*foreach*示例*更好：*

 *```
$x = array_reduce(
    $array_of_objects, 
    function($val, $obj) { $val = array_merge($val, $obj->myMethod()); return $val; },
    array() 
); 
```

跟着你的 foreach 去吧:)

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2009-05-05T14:32:57.657

```
<?php

// $obj->$method(); works, where $method is a string containing the name of the
// real method
function array_map_obj($method, $array) {
    $out = array();

    foreach ($array as $key => $obj)
        $out[$key] = $obj->$method();

    return $out;    
}

// seems to work ...

class Foo {
    private $y = 0;
    public function __construct($x) {
        $this->y = $x;
    }
    public function bar() {
        return $this->y*2;
    }
}

$objs = array();
for ($i=0; $i<20; $i++)
    $objs[] = new Foo($i);

$res = array_map_obj('bar', $objs);

var_dump($res);

?> 
```

瞧！

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2009-05-05T14:41:02.083

这是一个有点愚蠢的答案，但您可以继承 ArrayObject 并使用它而不是普通数组：

```
<?php

class ArrayTest extends ArrayObject {
    public function invokeMethod() {
        $result = array();
        $args = func_get_args();
        $method = array_shift($args);
        foreach ($this as $obj) {
            $result[] = call_user_func_array(array($obj, $method), $args);
        }
        return $result;
    }
}

//example class to use
class a { 
    private $a;
    public function __construct($a) { 
        $this->a = $a; 
    }

    public function multiply($n) {
        return $this->a * $n;
    }
 }

//use ArrayTest instance instead of array
$array = new ArrayTest();
$array[] = new a(1);
$array[] = new a(2);
$array[] = new a(3);

print_r($array->invokeMethod('multiply', 2)); 
```

输出这个：

```
Array
(
    [0] => 2
    [1] => 4
    [2] => 6
) 
```

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2009-05-05T14:59:38.870

`create_function()`在等待 PHP 5.3 时，我会使用... 为 array_map 创建一个临时函数

```
$func = create_function('$o', '$o->myMethod();');
array_map($func, $objects); 
```

# c# - 从 IIS 6.0 中的自定义 404 页面提交时，为什么 POST 数据会丢失？

> ID：824837
> 
> 赞同：1
> 
> 时间：2009-05-05T13:22:59.523
> 
> 标签：c#, iis, .net-3.5, post, http-status-code-404

我在 .NET 3.5 中构建了一个自定义 404 CMS 系统，虽然发布数据在 IIS 5.1 和 6.0 中本地工作，但它在生产 IIS 6.0 服务器上不起作用。我逐项比较了 IIS 6.0 站点设置，它们几乎相同，唯一的区别无关紧要。

我验证了表单在每种情况下都发布到“ [http://domain/folder/folder/page.resource](http://domain/folder/folder/page.resource) ”（代码在SVN中）并且提交时没有发生重定向（我抛出异常以确保） . 服务器的一些调试信息：

```
IIS 5.1 (my computer, works):
ServerVariables["REQUEST_METHOD"]="POST"
Request.TotalBytes = 1600
Request.QueryString.Count = 1 (NOTE: contains "404;http://domain:80/folder/folder/page.resource" in each case)
Request.Form.Count = 109

IIS 6.0 (test server, works):
ServerVariables["REQUEST_METHOD"]="GET" (NOTE: IIS 6.0 reads this as "GET" instead of "POST")
Request.TotalBytes = 1600
Request.QueryString.Count = 1
Request.Form.Count = 109

IIS 6.0 (production server, does not work):
ServerVariables["REQUEST_METHOD"]="GET"
Request.TotalBytes = 0 (NOTE: should be ~1600)
Request.QueryString.Count = 1
Request.Form.Count = 0 (NOTE: should be 109) 
```

有没有人有任何想法？我已经阅读过 POST 数据未在 IIS 7.0 中提交的 404 页，但在 6.0 中没有。我的表格是这种格式：

```
<form id="GolfRegistration" name="GolfRegistration" method="POST" action="/folder/folder/page.resource" onSubmit="return CalculateAmount();">
<input type="button" value="Submit" onClick="if(ValidateInput()){submit(GolfRegistration);}">
</form> 
```

仅对于 IIS 5.1，我在“IIS > 网站 > 属性 > 主目录选项卡 > 配置按钮 > 添加”中设置了 .resource 扩展名以使用 GET、HEAD 和 POST。这可以防止我在提交时收到 405 错误。

编辑：我将 POST 更改为 GET，并且在所有 3 种情况下它都正确提交了数据，所以这不是表单问题。不幸的是，我无法在查询字符串中传递变量（有 109 个）。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-05-22T18:27:27.380

我遇到了同样的问题，不幸的是，答案似乎是“这是一个功能”。

在此处阅读更多信息： *好的，我尝试发布指向问题描述的链接，但它显示“新用户无法发布链接”。因此，我能做的最好的事情是：在 Google 上搜索“IIS 6：404/405 自定义错误处理程序中缺少表单发布数据”（确保它在引号中），至少在我写这篇文章的时候，最上面的结果应该是我所指的页面。*

总之，正在发生的事情是：

1) 你不存在的 URL 被 POST'd 到（例如，mydomain.com/somepage） 2) IIS 接收到请求，注意到 somepage 不存在，然后它向你的错误处理程序发起第二个请求，并且该请求的方法在内部是 GET。并且您的任何 POST 数据都不会传递。

这就留下了一个问题，即为什么你们都*在*IIS 6 上取得了成功——这让我感到困惑。

无论如何，请阅读上面的链接了解更多信息。

顺便说一句，我在 IIS 6/Windows2003 上运行 PHP，我发现了一个有趣的解决方法。虽然 PHP 没有从 IIS 接收 POST 变量（如您所料），但 PHP 仍然可以访问由“php://input”标识的原始输入流，它可以从中读取*原始*请求正文。这将包含原始格式的 POST 变量——我能够使用 PHP 的 parse_str() 函数从原始字符串中获取 POST 变量。

因此，在 ASP.NET 中*可以*做类似的事情。你试过检查 Request.InputStream 吗？如果我的记忆正确，那将为您提供一个可以读取的流。也许它会有原始的 POST 数据？

-乔什

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-05-05T13:34:19.530

尝试暂时将表单方法更改为**GET**。这应该告诉您是否正在发送任何数据以及正在发送什么数据。

我之前遇到过类似的问题，最终是脚本生成正在发送的内容的问题，而不是数据发送时的问题。

# c# - 如何使用 LINQ 获取列表中的下一个活动项

> ID：824852
> 
> 赞同：1
> 
> 时间：2009-05-05T13:27:36.253
> 
> 标签：c#, .net, linq

我有一个小问题，我想用 linq 在列表中找到下一个“活动”项目。然后下一个“活动”项目由 startDate 和 EndDate 定义。这是一个示例列表。

```
 //-- Create Lists of turns    
    IList<Turn> turns= new List<Turn>(){ 
                new Turn(){Name = "Turn 1", StartDate = DateTime.Parse("2009-05-01"), EndDate = DateTime.Parse("2009-05-01") }
         ,      new Turn(){Name = "Turn 2", StartDate = DateTime.Parse("2009-06-01"), EndDate = DateTime.Parse("2009-06-01") }
         ,      new Turn(){Name = "Turn 3", StartDate = DateTime.Parse("2009-07-01"), EndDate = DateTime.Parse("2009-07-02") }
         ,      new Turn(){Name = "Turn 4", StartDate = DateTime.Parse("2009-08-01"), EndDate = DateTime.Parse("2009-08-03") }
    }

//-- Get the next Turn by DateTime.
DateTime toDay = DateTime.Parse("2009-06-02");

//-- Should return the "Turn 3" item...
Turn turn = (from item in turns
            where .....
            select turn).FirstOrDefault<Turn>(); 
```

是否有一个很好的解决方案可以通过在 Turn 上使用 startDate/endDate 属性来找到下一个回合。我尝试按 startdate 对列表进行第一次排序，然后在列表中找到第一个，但如果有更“安全”的方法来获取它，我会发现它不需要按正确顺序列出的列表来找到正确的转弯。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-05-05T14:10:03.123

你可以这样做。

```
Turn turn = turns
  .Where(t => t.StartDate >= toDay)
  .OrderBy(t => t.StartDate)
  .FirstOrDefault(); 
```

Where 调用是可选的 - 它的目标是减少必须订购的商品数量。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-05-05T13:41:25.737

我想你只是想要：

```
var turn = turns.SkipWhile(t => t.EndDate < today).FirstOrDefault(); 
```

这将返回包含或在给定日期之后的第一轮`today`，您似乎正在寻找它。当然，它还假设您的`turns`列表已经排序。

**编辑：**看来我错过了关于您不想对列表进行排序的信息。我仍然不能完全确定选择适当转弯所需的条件，这将使我能够改进查询。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-05-05T14:05:47.317

你为什么不只得到今天之后开始日期的第一个项目？我添加了一个显式`OrderBy()`调用，以确保列表已排序。当然，如果您知道它已排序，则可以将其省略。

```
turns.OrderBy(t => t.StartDate).FirstOrDefault(t => t.StartDate > today); 
```

**更新**

我错过了你的最后几行。是的，您可以在不明确对列表进行排序的情况下执行此操作。您必须在列表中搜索开始日期在今天之后的项目，并且不能有开始日期在今天之后但在当前项目之前的项目。但这确实会减慢搜索速度，因为您必须查看每个项目的整个列表，使事情成为 O(n²)。

```
turns.Single(t => 
    t.StartDate > today &&
    turns.All(u => u.StartDate <= today || u.StartDate > t.StartDate)) 
```

这假设匝是不重叠的。如果它们重叠，您必须使用`First`代替`Single`或添加额外的约束来获得唯一的结果。**最后：使用排序解决方案——这个解决方案绝不比排序和获取第一个项目更安全。**

# sql - “选择”是否总是按主键排序？

> ID：824855
> 
> 赞同：17
> 
> 时间：2009-05-05T13:28:44.753
> 
> 标签：sql, database, oracle, primary-key

对所有 DBA 来说，一个基本的简单问题。

当我进行选择时，是否始终保证我的结果将按主键排序，还是应该使用“order by”指定它？

我使用 Oracle 作为我的数据库。

* * *

## 回答 #1

> 赞同：44
> 
> 时间：2009-05-05T13:29:23.597

不，如果您不使用“order by”，则无法保证任何订购。事实上，您不能保证从一个查询到下一个查询的顺序是相同的。请记住，SQL 以基于集合的方式处理数据。现在，一个或另一个数据库实现可能碰巧以某种方式提供排序，但您永远不应该依赖它。

* * *

## 回答 #2

> 赞同：6
> 
> 时间：2009-05-05T13:30:44.153

> 当我进行选择时，是否始终保证我的结果将按主键排序，还是应该使用“order by”指定它？

不，到目前为止还不能保证。

```
SELECT  *
FROM    table 
```

很可能会使用`TABLE SCAN`根本不使用主键的。

您可以使用提示：

```
SELECT  /*+ INDEX(pk_index_name) */
        *
FROM    table 
```

，但即使在这种情况下，也不能保证排序：如果使用`Enterprise Edition`，查询可能会并行化。

这是一个问题，因为`ORDER BY`不能在`SELECT`子句子查询中使用，也不能这样写：

```
SELECT  (
        SELECT  column
        FROM    table
        WHERE   rownum = 1
        ORDER BY
                other_column
        )
FROM    other_table 
```

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2009-05-05T13:32:39.877

不，除非您使用 ORDER BY，否则无法保证订购。

获取行的顺序取决于访问方法（例如全表扫描、索引扫描）、表的物理属性、表中每一行的逻辑位置以及其他因素。即使您不更改查询，这些都可能发生变化，因此为了保证结果集中的顺序一致，ORDER BY 是必要的。

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2009-05-05T13:31:04.543

它取决于您的数据库，也取决于索引字段。

例如，在我的用户表中，每个用户都有唯一的 varchar(20) 字段 - 登录名和主键 - id。

并且“Select * from users”返回按登录排序的行集。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2009-05-05T13:31:50.313

如果您需要特定的顺序，请使用 ORDER BY 专门声明它。

如果表没有主键怎么办？

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2009-05-05T13:31:50.487

如果您希望结果按特定顺序排列，请始终指定顺序

# ruby-on-rails - Rails - 从对象哈希创建选择标签

> ID：824857
> 
> 赞同：18
> 
> 时间：2009-05-05T13:29:16.717
> 
> 标签：ruby-on-rails

我需要从哈希中可用的值创建一个选择框。

例如，我有一个“事物”，而“事物”有多种状态字段：

```
1 => 'State A'
2 => 'State B' 
```

可通过事物上的方法获得。

如何从中构建选择标签？

* * *

## 回答 #1

> 赞同：55
> 
> 时间：2009-05-05T14:59:20.620

正如施罗克韦尔所说：

`Hash.each |a|`返回形式为 的数组`a = [key, value]`，因此对于散列`@status_fields`，您可以编写：

```
<%= collection_select('thing', 'status', @status_fields, :first, :last) %> 
```

或者，如果您希望键显示在选择列表中并且值指向选择列表值，则：

```
<%= collection_select('thing', 'status', @status_fields, :last, :first) %> 
```

这将选择 thing.status 给出的选项，如果返回 nil 则不选择

如果您只想创建任何不绑定到对象的选择，请使用

```
<%= select_tag('name', options_from_collection_for_select(@status_fields, :first, :last, '2')) %> 
```

其中“2”是所需选择的索引

PS：我没有足够的声誉来修改原始帖子或对其发表评论

* * *

## 回答 #2

> 赞同：8
> 
> 时间：2009-05-05T13:41:18.933

你可以做类似的事情

```
select "foo", "bar", @hash_object 
```

或者

```
select "foo", "bar", @hash_object.map { |h| [h.key, h.value] } 
```

我可能会先反转您的哈希值以使关键点指向值

* * *

## 回答 #3

> 赞同：7
> 
> 时间：2009-05-05T13:38:53.183

[select helper 方法](http://api.rubyonrails.org/classes/ActionView/Helpers/FormOptionsHelper.html#M001592)将接受表单中的哈希，`{ text_displayed_in_select => select_value }`因此您可能希望[反转](http://www.ruby-doc.org/core-1.8.7/classes/Hash.html#M000187)该哈希。

* * *

* * *

## 回答 #4

> 赞同：4
> 
> 时间：2009-05-05T13:43:30.490

`Hash.each |a|`返回形式为 的数组`a = [key, value]`，因此对于散列`@status_fields`，您可以编写：

```
<%= collection_select('thing', 'status', @status_fields, :first, :last) %> 
```

或者，如果您希望键显示在选择列表中并且值指向选择列表值，则：

```
<%= collection_select('thing', 'status', @status_fields, :last, :first) %> 
```

# user-interface - HSQLDB 管理器？

> ID：824861
> 
> 赞同：11
> 
> 时间：2009-05-05T13:30:16.607
> 
> 标签：user-interface, hsqldb

我在 Java 中尝试过 SQLite，但由于 JDBC 驱动程序，速度很慢。然后我尝试了HSQLDB，认为速度不错，但是我找不到一个很好的HSQLDB管理工具，例如用于MySQL的phpMyAdmin或用于SQLite的[SQLite Manager](https://addons.mozilla.org/en-US/firefox/addon/5817)。

我想使用管理器工具为单元测试准备测试数据，或者在做一些小实验后使用管理器工具来导航数据。

有什么好的工具吗？

* * *

## 回答 #1

> 赞同：12
> 
> 时间：2011-01-10T21:04:47.157

以下是您可以查看的其他一些建议：

*   松鼠 SQL [http://squirrel-sql.sourceforge.net/](http://squirrel-sql.sourceforge.net/)
*   执行查询[http://executequery.org/](http://executequery.org/)
*   Razor SQL（付费）[http://www.razorsql.com/](http://www.razorsql.com/)

Razor 拥有最好的功能集，但需要付费。其他人擅长不同的事情，值得一试。

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2009-05-05T13:51:39.877

只有在 HSQLDB 服务器模式下运行时，这才有意义。如果您在内存或文件模式下运行，那么您要么无法从另一个进程访问数据库，要么这样做会锁定它。

在服务器模式下，您可以使用任何通用客户端。JDBC 驱动程序是 hsqldb.jar 本身。

* * *

## 回答 #3

> 赞同：3
> 
> 时间：2009-05-05T13:33:59.373

其实HSQL自带管理工具（不是超级）。见[http://hsqldb.org/doc/guide/apf.html](http://hsqldb.org/doc/guide/apf.html)

* * *

## 回答 #4

> 赞同：2
> 
> 时间：2009-05-05T13:50:26.340

我用过松鼠 SQL。它是任何 JDBC 数据库的通用客户端。

见：[http ://squirrel-sql.sourceforge.net/](http://squirrel-sql.sourceforge.net/)

# iphone - iPhone - 切换视图时出现黑屏

> ID：824863
> 
> 赞同：0
> 
> 时间：2009-05-05T13:30:51.220
> 
> 标签：iphone, memory, memory-management, uiviewcontroller

我有一个使用向下钻取视图、标签栏等的应用程序。我还使用 UIImagePicker 以及 Route-Me 来支持映射。通常，应用程序运行良好。但是，我发现如果我执行大量活动然后在视图之间切换，我最终会出现一个空白屏幕并且我的视图不会被绘制。我的预感是这与记忆有关，但我怎么能确定呢？有没有人遇到过类似的情况？你是怎么改正的？我可以寻找什么？谢谢你提供的所有帮助！

史蒂夫

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2009-05-14T05:08:28.377

我遇到了这个确切的问题......在处理我的 UIView 切换的方法中，我检查了 ([newViewController.view superview] == nil) 它是在空白期间！所以我去使用 [[NewViewController alloc] initWithNibName:@"NewView" bundle:nil] 重新初始化它

希望这可以帮助！

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-05-05T15:08:14.000

您的视图可能正在后台卸载。如果您可以访问论坛，这里有一个很好的帖子： [https ://devforums.apple.com/message/56191](https://devforums.apple.com/message/56191)

基本上，您需要期望在应用程序的另一部分中，iphone 可能会卸载不活动的视图（请参阅 viewDidUnload 方法）。当您切换到该视图时，它将再次调用 viewDidLoad。

# language-agnostic - 如何确定我的 CPU 是 32 位还是 64 位？

> ID：824877
> 
> 赞同：11
> 
> 时间：2009-05-05T13:33:28.267
> 
> 标签：language-agnostic, processor

如何确定我的处理器是 32 位还是 64 位（使用您选择的语言）？我想知道英特尔和 AMD 处理器的这一点。

* * *

## 回答 #1

> 赞同：20
> 
> 时间：2009-05-05T13:38:24.917

视窗，C/C++：

```
#include <windows.h>

SYSTEM_INFO sysInfo, *lpInfo;
lpInfo = &sysInfo;
::GetSystemInfo(lpInfo);
switch (lpInfo->wProcessorArchitecture) {
case PROCESSOR_ARCHITECTURE_AMD64:
case PROCESSOR_ARCHITECTURE_IA64:
    // 64 bit
    break;
case PROCESSOR_ARCHITECTURE_INTEL:
    // 32 bit
    break;
case PROCESSOR_ARCHITECTURE_UNKNOWN:
default:
    // something else
    break;
} 
```

* * *

## 回答 #2

> 赞同：8
> 
> 时间：2009-05-05T14:43:50.843

C#，与操作系统无关

```
sizeof(IntPtr) == 4 ? "32-bit" : "64-bit" 
```

这有点粗略，但基本上可以告诉您 CLR 是以 32 位还是 64 位运行的，这很可能是您需要知道的。例如，CLR 可以在 64 位处理器上作为 32 位运行。

有关详细信息，请参阅此处：[如何使用 .NET 检测 Windows 64 位平台？](https://stackoverflow.com/questions/336633/how-to-detect-windows-64-bit-platform-with-net)

* * *

## 回答 #3

> 赞同：4
> 
> 时间：2009-05-05T15:14:46.963

这里棘手的一点是你可能有一个 64 位的 CPU，但一个 32 位的操作系统。如果您关心这种情况，它将需要一个 asm 存根来询问 CPU。如果没有，您可以轻松询问操作系统。

* * *

## 回答 #4

> 赞同：2
> 
> 时间：2009-06-05T11:40:31.753

在 .NET 中，您可以通过查看 IntPtr 结构的 Size 属性来区分 x86 和 x64。IntPtr.Size属性以字节为[单位](http://msdn.microsoft.com/en-us/library/system.intptr.size(vs.71).aspx)返回，每个字节 8 位，因此它在 32 位 CPU 上等于 4，在 64 位 CPU 上等于 8。由于我们谈论的是 32 位和 64 位处理器而不是 4 字节或 8 字节处理器，所以我喜欢以位进行比较，这样可以更清楚地了解发生了什么。

C＃

```
if( IntPtr.Size * 8 == 64 )
{
    //x64 code
} 
```

电源外壳

```
if( [IntPtr]::Size * 8 -eq 64 )
{
    #x64 code 
} 
```

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2009-06-05T11:17:19.383

VBScript，Windows：

```
Const PROCESSOR_ARCHITECTURE_X86 = 0
Const PROCESSOR_ARCHITECTURE_IA64 = 6
Const PROCESSOR_ARCHITECTURE_X64 = 9

strComputer = "."

Set oWMIService = GetObject("winmgmts:" & _
    "{impersonationLevel=impersonate}!\\" & strComputer & "\root\cimv2")

Set colProcessors = oWMIService.ExecQuery("SELECT * FROM Win32_Processor")

For Each oProcessor In colProcessors
  Select Case oProcessor.Architecture
    Case PROCESSOR_ARCHITECTURE_X86
      ' 32-bit
    Case PROCESSOR_ARCHITECTURE_X64, PROCESSOR_ARCHITECTURE_IA64
      ' 64-bit
    Case Else
      ' other
  End Select
Next 
```

Windows Script Host 的另一种可能的解决方案，这次是在 JScript 中并使用 PROCESSOR_ARCHITECTURE 环境变量：

```
var oShell = WScript.CreateObject("WScript.Shell");
var oEnv = oShell.Environment("System");
switch (oEnv("PROCESSOR_ARCHITECTURE").toLowerCase())
{
  case "x86":
    // 32-bit
  case "amd64":
    // 64-bit
  default:
    // other
} 
```

* * *

## 回答 #6

> 赞同：1
> 
> 时间：2009-06-05T11:52:48.530

在 Python 中：

```
In [10]: import platform
In [11]: platform.architecture()
Out[11]: ('32bit', 'ELF') 
```

像往常一样，非常整洁。但我很确定这些函数会返回构建 exec 的平台，而不是它运行的平台。一些极客在 64 位计算机上运行 32 位版本的可能性仍然很小。

您可以拥有更多信息，例如：

```
In [13]: platform.system()
Out[13]: 'Linux'

In [19]: platform.uname()
Out[19]: 
('Linux',
 'asus-u6',
 '2.6.28-11-generic',
 '#42-Ubuntu SMP Fri Apr 17 01:57:59 UTC 2009',
 'i686',
 '') 
```

等等。

这看起来更像是实时数据:-)

* * *

## 回答 #7

> 赞同：0
> 
> 时间：2009-05-05T14:39:44.503

我在想，在 64 位处理器上，指针是 64 位的。因此，与其检查处理器功能，不如使用指针以编程方式“测试”它。它可以像创建具有两个连续指针的结构然后检查它们的“步幅”一样简单。

* * *

## 回答 #8

> 赞同：0
> 
> 时间：2009-06-05T11:41:25.933

C#代码：

```
int size = Marshal.SizeOf(typeof(IntPtr));
if (size == 8)
{
 Text = "64 bit";
}
else if (size == 4)
{
 Text = "32 bit";
} 
```

* * *

## 回答 #9

> 赞同：0
> 
> 时间：2009-06-05T12:29:12.013

在linux中，您可以通过阅读来确定“位数”

```
/proc/cpuinfo 
```

例如。

```
cat /proc/cpuinfo | grep flags 
```

如果它包含

```
lm 
```

标记它是 x86 64 位 CPU（即使您安装了 32 位 linux）

不确定这是否适用于非 x86 CPU 以及 PPC 或 ARM。

# asp.net - 通过不工作订购

> ID：824895
> 
> 赞同：1
> 
> 时间：2009-05-05T13:38:54.120
> 
> 标签：asp.net, vb.net, subsonic, sql-order-by

我正在使用带有 gridview 的 objectdatasource 从我的 orm 类中获取数据，但我无法正确排序。我正在使用下面的代码，但它不像我在下面指定的那样按降序排列。我错过了什么？使用亚音速 2.1

```
<DataObjectMethod(DataObjectMethodType.Select, True)> Public Function FetchByPatID(ByVal PatientID As Object) As VisitCollection

    Dim coll As VisitCollection = New VisitCollection().Where("PatientID", PatientID).Load()
    **OrderBy.Desc(Visit.DosColumn)**
    Return coll

End Function 
```

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2009-05-05T14:32:23.210

作为查询的一部分，order by 对数据库执行。它需要在调用 .Load() 方法之前添加。

```
Dim coll As VisitCollection = New VisitCollection().Where("PatientID", PatientID).OrderByDesc(Visit.Columns.DosColumn).Load() 
```

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2009-05-05T17:24:46.837

拉诺莫尔是正确的。您必须在实际执行命令之前指定 OrderBy，因为排序是在数据库上完成的。

如果您使用的是 SubSonic 2.1，我更喜欢添加的新语法，这使得查询更具可读性

```
SubSonic.Select.AllColumnsFrom(Of Visit)().Where(Visit.PatientIDColumn).isEqualTo(PatientID).OrderByDesc(Visit.DosColumn.ColumnName).ExecuteAsCollection(Of VisitCollection)() 
```

# .net - 在 .NET WinForms 应用程序中实现对“业务对象”的简单搜索的建议？

> ID：824905
> 
> 赞同：1
> 
> 时间：2009-05-05T13:41:36.047
> 
> 标签：.net, winforms, search

在 .NET WinForms 应用程序中为“业务对象”提供简单搜索功能的最佳方法是什么？

我所说的“简单搜索”是指类似于 Vista + Windows 7 的“搜索框”，它位于几乎每个窗口的右上角，用于搜索该窗口的内容（没什么花哨的，可能也没有“高级”搜索 -把事情简单化）。

“业务对象”是指基于类的对象，例如“客户”和“地址”（主要是您简单的普通联系信息）。

我考虑过“滚动我自己的”简单搜索，也许让我的类实现一个“包含”功能，这样我就可以询问每个对象是否“包含”用户的任何搜索词（然后建立某种简单的排名根据匹配的单词数）。

我也研究了 Lucene.NET，但它似乎对我的需求过于复杂 - 必须建立一个索引（并更新和维护它）。

建议？想法？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-05-05T14:02:52.550

我不知道“最好”的方式（如果我这样做了，我会在谷歌工作）。不过，鉴于此，我确实在几个月前的概念验证/客户演示中实现了类似的东西，这起到了作用。请注意，我能够非常有效地限制问题域，尤其是立即可搜索数据集的大小，因此性能不是问题。

我创建了一个`FilterableListView` [`UserControl`](http://msdn.microsoft.com/en-us/library/system.windows.forms.usercontrol.aspx). 我[`ListView`](http://msdn.microsoft.com/en-us/library/system.windows.forms.listview.aspx)在 Detail 模式下使用了 a，我在其[`TextBox`](http://msdn.microsoft.com/en-us/library/system.windows.forms.textbox.aspx)上方直接放置了 a，并使用平台互操作给它一些[CueText](http://msdn.microsoft.com/en-us/library/bb761639.aspx)（类似于“Filter”或“Search”）。然后，如果自过滤器框的最后一个事件以来有 0.5 秒的延迟，我会`ListView`从后台线程（使用我的实现的等效项）更新 的内容。[`SafeInvoke`](https://stackoverflow.com/questions/714666/is-it-appropriate-to-extend-control-to-provide-consistently-safe-invoke-begininvo/714680)[`TextChanged`](http://msdn.microsoft.com/en-us/library/system.windows.forms.control.textchanged.aspx)

我对 中指定字段的内容进行了简单的、不区分大小写的子字符串匹配`ListView`，它快速、简单且有效。我发现 Linq to Objects*非常*有用。

对于更适合生产的实现，我会做一些更好的事情：

1.  在执行搜索之前，使用双击速度计算适当的延迟。
2.  提供回调机制来执行搜索，而不是将其构建到控件中。也许像`IFilterable`接口之类的东西？

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-05-05T13:57:16.510

我会在每个类上实现一个简单的接口，它只返回一个描述实例的搜索词列表。然后，您可以获得所有对象，询问他们的搜索词并根据用户提供的搜索词对它们进行排名。

这接近于您的 Contains 接口理念，但将更多逻辑排除在业务类之外。您甚至可以通过反射检查对象，并且可能只是将一些用户属性添加到属性中，以向搜索引擎提供一些提示，哪些属性要包含在搜索中。

但请注意，您必须评估对所有对象的每次搜索。如果您使用复杂的排名功能，这将变得非常慢，超过大约一百个左右的对象。使用反射会使事情变得更糟。

另一个要解决的问题是如何以有意义的方式处理搜索结果。如果您有很多不同的类，那么显示结果并将用户导航到应用程序中他可以对这些对象执行某些操作的位置可能是一项非常重要的任务。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-05-05T14:02:20.757

我认为您在每个对象中使用“包含”方法的方法非常有用。

您可以为对象的成员赋予“**权重**”，以便如果 contains 方法找到匹配项，则返回某种“**分数**”。

其他要考虑的事情是比赛是否是**一场完整**的比赛......并为该分数分配或多或少的分数。

如果您搜索多种类型的对象......您可能可以为主要对象（更多以业务为中心的对象）分配**更高的值**，以便为它们提供更多优先级。

只是想法...

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2009-05-05T14:14:28.170

只要您没有太多对象，就可以通过循环遍历每个对象来执行您所描述的操作。您可以使用正则表达式而不仅仅是包含，以赋予它更多的灵活性。包含将为您提供对象上的匹配，而不仅仅是对象内部属性的字符串值。匹配字符串可能对您更有用。

您可以做的一件事是在您的对象中创建一个方法，该方法只是您要搜索的该对象中所有字符串的串联字符串。然后应用正则表达式来搜索该方法产生的值。它很容易不会成为性能最好的解决方案，但它会快速而简单。就像我说的，只要你没有太多的对象就可以了。

# windows - 在同一台机器上创建对象时，CoCreateInstance() 和 CoGetClassObject() 有什么区别？

> ID：824907
> 
> 赞同：8
> 
> 时间：2009-05-05T13:43:12.347
> 
> 标签：windows, com, interop, com-interop

我知道 CoCreateInstance 为给定的类 id 找到 COM 服务器，为该 id 创建对象实例并从该对象实例中检索接口。CoGetClassObject() 为类 id 找到 COM 服务器，为该类 id 创建类工厂的实例，并检索可用于创建实际对象的类工厂接口。

当用于在同一台机器上创建对象时，这些函数还有什么不同？它们的工作方式是否相同，但只会导致在完全相同的 COM 服务器中调用不同的代码？

* * *

## 回答 #1

> 赞同：11
> 
> 时间：2009-05-05T13:47:18.810

CoGetClassObject 本质上为您返回一个指向特定接口的工厂的指针。在底层，CoCreateInstance 使用 CoGetClassObject。调用 CoGetClassObject 的优点是，如果您想创建特定对象的许多实例，它允许您只需要创建一次类工厂。

CoGetClassObject 上的 MSDN 部分简要讨论了如何利用此功能。

*   [http://msdn.microsoft.com/en-us/library/ms684007(VS.85).aspx](http://msdn.microsoft.com/en-us/library/ms684007(VS.85).aspx)

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-12-09T11:02:46.923

除了 JaredPar 所说的之外，还有一个场景 - CoGetClassObject 返回一个类工厂（在 inproc 服务器的情况下调用 DLL 的 DLLGetClassObject 导出函数）。类工厂用于实例化 coclass。CoCreateInstance 在内部调用 CoGetClassObject，获取所需的类工厂，然后使用它来实例化您请求的 coclass。调用 CoCreateInstance 时，不能延迟创建 coclass。有时创建 coclass 的成本可能很高，您希望延迟它的创建，但仍然可以访问类工厂，以便您可以按需实例化 coclass。

# c# - 我可以告诉 CLR 通过引用在 AppDomains 之间编组不可变对象吗？

> ID：824912
> 
> 赞同：12
> 
> 时间：2009-05-05T13:43:58.927
> 
> 标签：c#, .net, clr, remoting, appdomain

在 .NET 中的 AppDomain 之间编组对象时，CLR 将序列化对象（如果它具有`Serializable`属性）或生成代理（如果它继承自`MarshalByRef`）

但是，对于字符串，CLR 只会将对字符串对象的引用传递到新的 AppDomain。CLR 仍然确保完整性，因为 .NET 字符串是不可变的，并且第二个 AppDomain 对字符串的任何更改都不会影响原始对象。

这让我想到了我的问题：有没有办法告诉 CLR 我的自定义类型是不可变的，当用于远程处理时，它应该像处理字符串类一样传递对对象的引用？

* * *

## 回答 #1

> 赞同：8
> 
> 时间：2009-05-06T06:59:04.370

编组实际上[相当棘手](http://blogs.msdn.com/cbrumme/archive/2003/06/01/51466.aspx)。

您描述的行为称为“marshal-by-bleed”，运行时使用它来编组字符串（有时）和编组 System.Threading.Thread ALWAYS。

据我所知，您无法控制这一点（文章中提到您可以定义自定义编组行为，但我找不到任何文档），您可能会传递一个 IntPtr 并使用不安全的代码来模拟这个，但对我来说，这听起来像是一个巨大的黑客攻击。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-05-05T13:53:00.920

我不这么认为，不。我相信这和原语一样，是由运行时直接处理的。

* * *

## 回答 #3

> 赞同：-1
> 
> 时间：2009-05-05T20:12:09.807

在 .NET Remoting 中只有两种封送语义：按值封送 (SerializableAttribute) 和按引用封送 (MarshalByRef)。

正如您所提到的，字符串是按值编组的，因为 System.String 是用 SerializableAttribute 装饰的。

如果您想在应用程序域之间传递您的对象并且您只想要一个副本（远程应用程序域中的对象的更改不会影响本地应用程序域中的对象），那么您想要的是在您的类上使用 SerializableAttribute。

希望这可以帮助。

# javascript - 如何重构这个 jQuery 代码？

> ID：824914
> 
> 赞同：2
> 
> 时间：2009-05-05T13:44:19.660
> 
> 标签：javascript, jquery

下面的代码是一个简单的时事通讯注册小部件。

我敢肯定有办法让它更简洁，有什么想法吗？

```
var email_form = $('.widget_subscribe form'); 
var email_submit = $('.widget_subscribe .submit');
var email_link = $('.widget_subscribe .email');

// Hide the email entry form when the page loads
email_form.hide();

// Show the form when the email link is clicked
$(email_link).click( function () {
    $(this).toggle();
    $(email_form).toggle();
    return false;
});

// Hide the form when the form submit is clicked
$(email_submit).click( function () {
    $(email_link).toggle();
    $(email_form).toggle();
});

// Clear/reset the email input on focus 
$('input[name="email"]').focus( function () {
    $(this).val("");
    }).blur( function () {
        if ($(this).val() == "") {
            $(this).val($(this)[0].defaultValue);
        }
}); 
```

* * *

## 回答 #1

> 赞同：11
> 
> 时间：2009-05-05T14:01:19.743

你在这里有一些类似的代码。

```
// Show the form when the email link is clicked
$(email_link).click( function () {
        $(this).toggle();
        $(email_form).toggle();
        return false;
});

// Hide the form when the form submit is clicked
$(email_submit).click( function () {
        $(email_link).toggle();
        $(email_form).toggle();
}); 
```

它可以被重构，所以相似性是显而易见的。

```
// Show the form when the email link is clicked
$(email_link).click( function () {
        $(email_link).toggle();
        $(email_form).toggle();
        return false;
});

// Hide the form when the form submit is clicked
$(email_submit).click( function () {
        $(email_link).toggle();
        $(email_form).toggle();
}); 
```

因此，您可以将切换链接和表单包装成一个函数。

```
var toggleEmailLinkAndForm = function () {
        $(email_link).toggle();
        $(email_form).toggle();
}   

$(email_link).click(toggleEmailLinkAndForm);
$(email_submit).click(toggleEmailLinkAndForm); 
```

正如其他人指出的那样，您可以删除多余的 $()s。

```
var toggleEmailLinkAndForm = function () {
        email_link.toggle();
        email_form.toggle();
}   

email_link.click(toggleEmailLinkAndForm);
email_submit.click(toggleEmailLinkAndForm); 
```

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2009-05-05T13:48:49.400

它已经很简洁了，你可以做的不多。

任何你有 $(email_submit) 的地方都可以有 email_submit，因为你已经将它包装在 $() 中（这使它成为一个 jquery 对象）。

例如：

```
email_submit.click( function () {
    email_link.toggle();
    email_form.toggle();
}); 
```

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2009-05-05T14:34:02.303

我最喜欢 Patrick McElhaney Code。

```
toggleEmailLinkAndForm() {
    email_link.toggle();
    email_form.toggle();
}   

email_link.click(toggleEmailLinkAndForm);
email_submit.click(toggleEmailLinkAndForm); 
```

重构的一部分并不过分。我不建议创建一个额外的点击事件来调用另一个点击事件。重构的重点是可读性和灵活性。您也可以使用 jQuery 方法“add”来缩小代码，但它会变得更难阅读。

```
email_link.add(email_submit).click(function(){
    email_link.add(email_form).toggle();
}); 
```

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2009-05-05T14:16:24.340

就像帕特里克说的（+1），你也可以跳过额外的功能：

```
email_submit.click(function () {
    email_link.toggle();
    email_form.toggle();
});
email_link.click(function () {
    email_submit.click(); //calls the click function already subscribed
    return false;
}); 
```

# java - 我需要下载什么才能开始使用 Spring 框架开发应用程序？

> ID：824917
> 
> 赞同：2
> 
> 时间：2009-05-05T13:45:13.713
> 
> 标签：java, spring

我需要开始使用 Spring 框架开发应用程序，并且想知道我需要下载哪些工具才能启动和运行。

在[SpringSource](http://www.springsource.com/download/community?project=)网站上，我看到所有这些应用程序都需要下载，我想知道，我真的需要所有这些吗？我应该使用什么版本，尤其是对于 Spring Framework？

*   春天框架
*   SpringSource dm 服务器示例
*   春季安全
*   春季网络流
*   春季网络服务
*   弹簧动态模块
*   弹簧集成
*   春季批次
*   春天.NET
*   春天的 Java 配置
*   春季 LDAP
*   弹簧扩展
*   春季IDE
*   Spring BlazeDS 集成
*   SpringSource 捆绑器
*   春季ROO

我还需要下载哪些其他应用程序（例如 Struts、Glassfish、Apache 等）？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-05-05T14:46:35.347

这取决于你想用 Spring 做什么。通常是 Web 应用程序。如果是这样，您只需要两件事：

*   Spring 框架（依赖最少）；和
*   servlet 容器（例如 Tomcat）或成熟的应用程序服务器（例如 Glassfish、JBoss）。

其他一切都是可选的。我相信唯一需要的依赖是 Apache Commons 日志记录。根据您使用的功能，您可能需要更多功能。

如果是这样，这里有一个 [tutorial][1]，它创建了一个准系统 Spring MVC 项目。周围有无数其他主题和其他主题。

完全可以在例如 Swing 应用程序中使用 Spring，在这种情况下您显然不需要 servlet 容器。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-05-05T14:05:04.713

它主要取决于您需要 Spring 来做什么。实际上，Spring 的每一部分都可以与其他部分分开使用。您可能只将它用于 IOC，在这种情况下您不需要，例如 MVC 和 Servlet 等...

最简单的方法是从[http://www.springsource.com/download/community?project=Spring%20Framework下载主包](http://www.springsource.com/download/community?project=Spring%20Framework)

您可以从任何 IDE 使用 Spring

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2009-05-05T13:49:10.523

SpringSource 所需要的只是 Spring 框架。

Spring 3.0 即将推出，但现在，请使用当前的生产版本 2.5.6.SEC01。

您可以从一个简单的 servlet 容器（例如：Tomcat）开始，而不是一个成熟的应用程序服务器（例如：JBoss、Glassfish）。

Spring 框架捆绑了用于 Web 开发的 jar - 即：spring-web 和 spring-webmvc。

有关使用 Spring MVC 的简单示例，请参见[#117535](https://stackoverflow.com/questions/116978/can-anyone-recommend-a-simple-java-web-app-framework/117535#117535)。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2009-05-05T13:59:05.960

最好的方法是在您的项目中使用 Maven。基本上你所要做的就是编辑你的 pom.xml 文件并告诉它你想使用 Spring。然后当你编译你的代码时，Maven 会自动从他们的公共存储库中下载你需要的 Spring 库。

这是一个例子： http: [//pookey.co.uk/blog/archives/63-Getting-started-with-Maven-and-Spring.html](http://pookey.co.uk/blog/archives/63-Getting-started-with-Maven-and-Spring.html)

# xml - 是否有任何理由使用 SGML 而不是 XML？

> ID：824918
> 
> 赞同：8
> 
> 时间：2009-05-05T13:45:21.623
> 
> 标签：xml, comparison, sgml

据我了解，XML 是 SGML 的一个子集，旨在简化它并鼓励更广泛的使用。

我想最有用的特性都被引入了 XML，但是 SGML 中是否有足够强大的特性来激励使用它而不是 XML（并接受复杂性的开销）？

* * *

## 回答 #1

> 赞同：9
> 
> 时间：2009-09-26T20:50:05.713

SGML 的一个优点是，如果您手动编辑它，您可以以各种方式缩写标签。您能做什么取决于您使用的 DTD 的 SGML 声明。例如，在 DocBook 中，您可以编写 <literal>foo</> 之类的东西。在 HTML 中，您可以省略结束标签，这就是您可以编写 <p>foo ... <p>bar 而不关闭标签的原因。或者你可以完全省略标签，这就是为什么 <body> 在 HTML 中是可选的。

但是 XML 的发明正是因为所有这些变体使得解析 SGML 变得相当复杂。现在，您可能会发现比 SGML 编辑器更强大的 XML 编辑器。

就处理而言，这两种形式是等价的，因为您可以来回转换，但在某些极端情况下除外。

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2009-05-05T13:53:16.770

不会。使用 SGML 的唯一原因是，如果您在 SGML 已经成为生产流程一部分的出版行业工作。（可能还有其他行业，但这是我唯一有经验的行业）。

另一种看待这个问题的方式是，即使 SGML 中有一些不错的功能，除非您可以清楚地显示使用 SGML 的经济利益（参见“出版行业”），否则不值得为这些工具付费。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2009-05-05T13:52:31.777

除非您有特定的应用程序，否则无法回答。您可以使用 SGML 获得更好的索引和搜索，但我还没有发现它比 XML 更好的选择。我确定他们在那里，我只是还没有找到他们。

获胜因素是 XML 在多个平台上的呈现成熟度。SGML 不存在相同的兼容性。但是，如果您可以控制环境，那可能不是一个因素。XML 似乎只是提供了 90% 的功能，而复杂性要低得多。

# java - Spring Security：关于如何处理 GrantedAuthority 的建议

> ID：824919
> 
> 赞同：1
> 
> 时间：2009-05-05T13:45:27.973
> 
> 标签：java, spring, spring-security

当谈到 Spring Security 应用程序中的 GrantedAuthority 对象时，我有一个担忧。我正在寻找一种处理事情的好方法。首先，我试图描述我的担忧，如果有任何事实错误，请毫不犹豫地指出，我将不胜感激。

Spring Security 使用 GrantedAuthority 实例在应用程序的不同部分充当授权令牌。

默认情况下，GrantedAuthority 可以将自身呈现为字符串。当使用*@Secured("ROLE_NAME")*保护方法，或使用 Spring XML 配置*保护 URL*或以编程方式检查*HttpServletRequest 请求*时，如*if(request.isUserInRole("ROLE_NAME")) {..}*您用于指定要检查的权限的字符串。

我想知道在应用程序的几个地方使用静态字符串的含义。如果更改了角色名称，开发人员必须查找所有旧字符串并更新它们。如果缺少一个字符串，则不会出现编译时错误，只会在运行时出现问题。

在 Spring Security 应用程序中处理 GrantedAuthority 对象时，您认为最好的方法是什么？你的解决方案有什么优点和缺点？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-05-05T15:47:06.527

First off, if possible, only do your checks at a particular place in the application (e.g. an HTTP interceptor at the beginning of the request), and using only one of the mentioned approaches. This is a good practice since you will be able to know authoritatively when a user becomes authorized.

If this is not possible, use enums for the role names and only compare on the enums. Therefore, if you wanted to locate all usages in the application it's a simple search.

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-05-05T14:00:14.410

我认为这里没有什么大问题。GrantedAuthority 不太可能更改密钥。只是不要将您的角色命名为 ROLE_A。

此外，我个人更喜欢 XML 安全配置而不是注解。一般来说，将任何相关配置保存在一个地方看起来是个好主意。

* * *

## 回答 #3

> 赞同：-1
> 
> 时间：2009-05-05T14:01:09.120

在 Spring 和其他框架（尤其是对于动态语言）中，使用“约定优于配置”。如果您可以自己定义角色名称，您很容易发现需要更多的代码行。

所以坚持约定。始终使用以下 3 个角色，ROLE_ANONYMOUS、ROLE_ADMIN 和 ROLE_USER。如果您需要另一个，请相应地命名并在所有场合使用它。文档很重要。

单元测试也被导入。在编译器未捕获错误的情况下，它可以帮助您。

# java - 我需要下载哪些应用程序才能开始使用 Spring 框架开发应用程序？

> ID：824921
> 
> 赞同：1
> 
> 时间：2009-05-05T13:45:41.483
> 
> 标签：java, spring

我需要开始使用 spring 框架开发应用程序，并且想知道我需要下载哪些工具才能启动并运行。

在[springsource](http://www.springsource.com/download/community?project=)网站上，我看到所有这些应用程序要下载，我想知道我真的需要所有这些吗？我应该使用什么版本，尤其是对于 Spring Framework？

```
* Spring Framework 
* SpringSource dm Server Samples
* Spring Security 
* Spring Web Flow 
* Spring Web Services 
* Spring Dynamic Modules
* Spring Integration
* Spring Batch
* Spring.NET
* Spring JavaConfig
* Spring LDAP
* Spring Extensions
* Spring IDE
* Spring BlazeDS Integration
* SpringSource Bundlor
* Spring ROO 
```

我还需要下载哪些其他应用程序（例如 strut、glassfish、apache 等）

加思

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-05-05T13:48:49.073

你只需要两件事：

*   Spring 框架（依赖最少）；和
*   servlet 容器（例如 Tomcat）或成熟的应用程序服务器（例如 Glassfish、JBoss）。

其他一切都是可选的。

我相信唯一需要的依赖是 Apache Commons 日志记录。根据您使用的功能，您可能需要更多功能。

你没有说你真正想用 Spring 做什么，但我假设 - 因为这是最常见的情况 - 它是构建 Web 应用程序。如果是这样，这里有一个创建准系统 Spring MVC 项目的[教程。](http://maestric.com/en/doc/java/spring)周围有无数其他主题和其他主题。

# python - Python中关键字参数的初始化

> ID：824924
> 
> 赞同：0
> 
> 时间：2009-05-05T13:47:27.703
> 
> 标签：python, initialization, arguments, instantiation

为什么会出现以下情况：

```
class A(object):
    def __init__(self, var=[]):
        self._var = var
        print 'var = %s %s' % (var, id(var))

a1 = A()
a1._var.append('one')

a2 = A() 
```

导致：

```
var = [] 182897439952
var = ['one'] 182897439952 
```

我不明白为什么在使用可选关键字参数时它不使用列表的新实例，谁能解释一下？

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2009-05-05T13:51:21.267

函数定义中的空列表在创建函数本身时创建一次。它不是在每次调用函数时都创建的。

如果您每次都想要一个新的，请执行以下操作：

```
class A(object):
    def __init__(self, var=None):
        if var is None:
            var = []
        self._var = var 
```

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2009-05-05T13:52:56.100

这是完全错误的。您不能（有意义地）在函数声明中提供可变对象作为默认值。

```
class A(object):
    def __init__(self, var=[]):
        self._var = var
        print 'var = %s %s' % (var, id(var)) 
```

你必须做这样的事情。

```
class A(object):
    def __init__(self, var=None):
        self._var = var if var is not None else []
        print 'var = %s %s' % (var, id(var)) 
```

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2009-05-05T13:55:20.663

> 函数定义中的空列表在创建函数本身时创建一次。它不是在每次调用函数时都创建的。

确切地。要解决此问题，请在函数定义中分配 None 并在函数体中检查 None：

```
class A(object):
    def __init__(self, var=None):
        if var is None:
            var = []
        self._var = var
        print 'var = %s %s' % (var, id(var)) 
```

# c# - 将 ctrl+c 发送到 c# 中的 cmd.exe 进程

> ID：824925
> 
> 赞同：3
> 
> 时间：2009-05-05T13:47:56.250
> 
> 标签：c#, .net, winforms, cmd

我目前正在为自己编写一个小的 C# 备份程序。我正在为界面使用标准的 Windows 窗体，并将 cmd.exe 作为新进程调用，然后在这个新进程中使用 XCOPY。一切都很好，除了我想添加的最后一个功能，即中断操作的能力。

在本机命令提示符下，我可以使用 ctrl+c 干净地完成此操作，但尽我所能，我无法使用 winforms 和进程方法复制此功能。我已经尝试重定向标准输入并使用它来发送 consolespecialkeys.ControlC 到进程，我还尝试发送 0x03 和“/x03”，我在其他论坛帖子上读到的都是 ctrl+c 的十六进制代码. 我发送的任何内容都没有注册，退出进程会杀死用户界面，但会让 xcopy.exe 在后台工作。手动杀死 xcopy.exe 会导致它留下一半复制和损坏的文件，而不是在命令提示符下使用 ctrl+c 发生的事情。

我错过了一些非常明显的东西吗？我是 C# 的新手，所以我会举手承认这很可能是我的速度很慢，或者误解了该过程如何与 cmd.exe 一起工作。然而，由于进程支持标准输入重定向，它似乎应该工作......至少对我来说。我已经把我的代码的基本大纲放在下面，以防它帮助确定我在哪里搞砸了。

```
string XCopyArguments = "\"" + dir.FullName + "\" \"" + destination + "\" /D /S /I /E";  
Process XCopyProcess = new Process();  
ProcessStartInfo XCopyStartInfo = new ProcessStartInfo(); 
XCopyStartInfo.FileName = "CMD.exe ";  
XCopyStartInfo.RedirectStandardError = true;
XCopyStartInfo.RedirectStandardOutput = true;
XCopyStartInfo.RedirectStandardInput = true;
XCopyStartInfo.UseShellExecute = false;
XCopyStartInfo.CreateNoWindow = true;
XCopyStartInfo.Arguments = " /D /c XCOPY " + XCopyArguments;
XCopyProcess.EnableRaisingEvents = true;
XCopyProcess.StartInfo = XCopyStartInfo;
XCopyProcess.Start();                
XCopyProcess.WaitForExit(15000);
int ExitCode = XCopyProcess.ExitCode;
if (ExitCode > 0 & !XCopyProcess.HasExited)
{
XCopyProcess.Kill();
}
XCopyProcess.Dispose(); 
```

非常感谢任何人都可以提供的任何帮助。

* * *

## 回答 #1

> 赞同：14
> 
> 时间：2009-05-05T14:01:28.073

我不想成为一个 besserwisser，但我认为你最好在你的程序中进行复制。使用 System.IO 命名空间中的 File、Directory 和其他类，非常简单，让您可以完全控制报告进度、取消操作等。

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2009-05-05T14:37:35.460

是的，在 .NET 中进行操作会更容易。但是，我还需要将 ctrl-c 发送到一个进程，但我没有那个选项。

那么我们能得到这个问题的答案吗？

**编辑：**我是否必须发布副本才能获得答案？不，@j0rd4n 没有回答这个问题。

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2009-12-08T22:05:06.917

就像其他人说的那样，有更好的方法来完成这项特定任务。但是，这并不能回答您的问题。我使用与您在此处展示的技术类似的技术来自动执行各种任务，并且发现它非常有用。有时事情会变得非常糟糕，您希望在事情变得更糟之前摆脱这个过程。;p

这是您的示例的问题：

XCopyStartInfo.CreateNoWindow = true;

将其设置为 false，然后它将处理 XCopyProcess.CloseMainWindow() 和 XCopyProcess.Close()。比使用 Kill() 干净得多。

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2009-05-05T14:01:56.840

它需要更少的代码行来循环子目录和文件并一个一个地复制它们，然后你就不必担心控制另一个进程......

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2009-05-19T04:05:46.713

抱歉，它在 VB.NET 中。

```
Declare Function GenerateConsoleCtrlEvent Lib "kernel32" ( _
                    ByVal dwCtrlEvent As Integer, _
                    ByVal dwProcessGroupId As Integer _
                    ) As Integer

Private Const CTRL_C_EVENT As Integer = 0

Private Sub SendCtrlC()
    GenerateConsoleCtrlEvent(CTRL_C_EVENT, 0)

    ' send a Ctrl-C to this process
    GenerateConsoleCtrlEvent(CTRL_C_EVENT, currentpid)

    ' send a Ctrl-C to the cmd process
    GenerateConsoleCtrlEvent(CTRL_C_EVENT, cmdpid)
End Sub 
```

* * *

## 回答 #6

> 赞同：1
> 
> 时间：2012-01-23T23:46:04.177

我已经成功地将 CTRL-C 组合发送到使用 SW_HIDE 创建的 cmd.exe 进程——即隐藏的 cmd.exe 窗口。

该技术是使用 EnumWindows 来识别进程并获取它的窗口句柄（即使它不可见，它仍然具有处理消息的句柄）。

接下来，我使用 PostMessage 将 ctrl-c 组合发布到进程。这与用户在窗口处于活动状态时按下“ctrl-c”具有相同的效果。

要从 C# 执行此操作，您可能需要访问[http://pinvoke.net/](http://pinvoke.net/) - 在 C# 中编写 Win32 API 函数原型时的救星。

* * *

## 回答 #7

> 赞同：0
> 
> 时间：2009-05-05T14:02:23.987

如果您想以这种方式处理复制，则必须手动终止该进程。在上面的代码中，您正在调用 XCopyProcess.WaitForExit(...)。这是一个阻塞调用，因此父 C# 进程将在该点停止，直到子进程完成或时间间隔已过。

您可以做的不是阻塞，而是可以在循环中休眠，定期检查用户是否已通过您的 C# UI 请求终止进程。如果您收到此事件，则显式终止该进程。否则，您将等待另一个时间间隔，直到该过程完成。

**编辑：**不过，我确实同意其他评论。直接从 .NET 框架复制，而不是使用 xcopy。

# mysql - 可以有一个与数据库无关的 SQL 查询来获取前 N 行吗？

> ID：824931
> 
> 赞同：1
> 
> 时间：2009-05-05T13:49:14.360
> 
> 标签：mysql, database, oracle, database-agnostic

我们希望能够使用 SQL 查询选择前 N 行。目标数据库可以是 Oracle 或 MySQL。有没有一种优雅的方法？（不用说，我们在这里处理已排序的数据。）

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-05-05T13:50:58.270

不，语法不同。

但是，您可以创建视图：

```
/* Oracle */

CREATE VIEW v_table
AS
SELECT  *
FROM    (
        SELECT  *
        FROM    table
        ORDER BY
                column
        )
WHERE   rownum <= n

/* MySQL */

CREATE VIEW v_table
AS
SELECT  *
FROM    table
ORDER BY
        column
LIMIT   n 
```

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2009-05-06T11:21:56.983

要从该表中获得前 5 名得分手：

```
CREATE TABLE people
             (id      int, 
              name    string, 
              score   int) 
```

试试这个 SQL：

```
SELECT id, 
       name, 
       score
FROM   people  p
WHERE  (SELECT COUNT(*) 
        FROM   people p2
        WHERE  p2.score  > p.score 
       ) <=4 
```

我相信这应该适用于大多数地方。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2009-05-05T13:58:20.983

我认为即使在 mysql 和 mssql 之间也是不可能的。我做了一个模拟这种行为的选项：

1.  创建具有自动递增 int 列的视图；说'PagingHelperID'
2.  编写如下查询：`SELECT columns FROM viewname WHERE PagingHelperID BETWEEN startindex AND stopindex`

这将使订购变得困难，您将需要为您打算检索数据的每个订单提供不同的视图。

您还可以在根据数据库进行查询时动态“重写”您的 sql，并为重写器定义您自己的方法，但我认为没有任何“好的”方法可以做到这一点。

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2009-05-05T14:00:22.477

如果表上有唯一键是...

```
Select * From Table O
Where (Select Count(*) From Table I
       Where [UniqueKeyValue] < O.UniqueKeyValue)  < N 
```

如果您希望“Top”定义基于其他逻辑而不是唯一键，则可以替换您自己的标准...

编辑：如果定义“Top”含义的“排序”基于非唯一列或列集，那么您仍然可以使用它，但您不能保证您能够准确地获得 N记录出来...

```
 Select * From Table O
  Where (Select Count(*) From Table I
         Where nonUniqueCol < O.nonUniqueCol) < 10 
```

如果记录 8、9、10、11 和 12 在 [nonUniqueCol] 中都具有相同的值，那么查询将要么只生成 7 条记录，（带有 '<'）...，要么 12（如果你使用 '< =')

注意：由于这涉及相关的子查询，因此对于非常大的表来说，性能可能是一个问题......

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2021-08-20T07:59:35.120

从 MySQL 8 开始，您可以使用`ROW_NUMBER()`过滤以统一、符合标准的语法获取`LIMIT`(MySQL) 或(Oracle) 的语义：`FETCH`

```
SELECT t.a, t.b, t.c, t.o
FROM (
  SELECT a, b, c, o, ROW_NUMBER() OVER (ORDER BY o)
  FROM x
) t
WHERE rn <= :limit
ORDER BY o 
```

但这可能比使用供应商特定的语法效率低，所以如果你有一些抽象的方法`LIMIT`（`FETCH`例如使用像[jOOQ](https://www.jooq.org)或[Hibernate](https://hibernate.org)这样的 ORM ，甚至是一些模板语言），那应该是首选。

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2009-05-05T14:22:24.967

仔细研究后，最大的问题是 MySQL 不符合 ISO SQL:2003 标准。如果是这样，您将拥有这些方便的窗口函数：

```
SELECT * from
(   SELECT
    RANK() OVER (ORDER BY <blah>) AS ranking,
    <rest of columns here>,
    FROM <table>
)
WHERE ranking <= <N> 
```

唉，MySQL（和其他模仿它的行为，例如 SQLite）不这样做，因此整个限制问题。

[从 Wikipedia ( http://en.wikipedia.org/wiki/Window_function_(SQL)#Limiting_result_rows](http://en.wikipedia.org/wiki/Window_function_(SQL)#Limiting_result_rows) )查看这个片段

# c# - 加载 XML 时数据无效错误

> ID：824932
> 
> 赞同：1
> 
> 时间：2009-05-05T13:49:20.583
> 
> 标签：c#, xml, dom

我正在尝试加载一个非常基本的 XML 文档，但是每次到达 LoadXml(string url) 行时，程序都会崩溃并报告异常（“根级别的数据无效。第 1 行，位置 1”XmlException）。

```
XmlDocument xmldoc = new XmlDocument();
xmldoc.LoadXml(@"C:\Websites\TestHarness\TestHarness\TestHarness\ExampleXml.xml");     
XmlNode node = xmldoc.DocumentElement; 
```

我的 XML 看起来像这样（这是来自 W3Schools 的示例 xml 文档，它可以在 IE 中正常打开）：

```
<note>
    <to>Tove</to>
    <from>Jani</from>
    <heading>Reminder</heading>
    <body>Don't forget me this weekend!</body>
</note> 
```

这完全按照原样粘贴，没有空格。

我看不出这段代码有什么问题，堆栈跟踪并没有告诉我太多，我怀疑某处存在环境问题。有没有人有任何想法？

编辑： XML 的格式不正确。XML 与此处的示例文档相同：[http ://w3schools.com/xml/default.asp](http://w3schools.com/xml/default.asp)

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2009-05-05T13:54:28.013

使用`Load()`而不是`LoadXml()`.

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-05-05T13:59:06.363

是的，您正在将文件名加载为 xml。但是您也缺少 xml 编码.... Xml 格式不允许任何这样的文本。该xml应该这样写：

```
<note>
    <to>Tove</to>
    <from>Jani</from>
    <heading>Reminder</heading>
    <body>Don&#39;t forget me this weekend!</body>
</note> 
```

这是一个在线编码的[好工具。](http://coderstoolbox.net/string/)

希望这可以帮助... ：）

# f# - List 中所有项目的特定属性的总和

> ID：824934
> 
> 赞同：3
> 
> 时间：2009-05-05T13:49:37.527
> 
> 标签：f#

举个例子，

我有一堂课

```
public class SomeItem
{
    public string Name;
    public DateTime Published;
    public uint16 Size;
} 
```

我有一个`List<SomeItem>`，我想计算所有项目的总大小。
在 C# 中，我会简单地写

```
var totalSize = items.Sum((i) => i.Size); 
```

我查看了 F# 中的 List 函数，但它们总是抱怨类型。

你会怎么用 F# 写这个？

（我试过搜索引擎，但搜索引擎对 F# 的支持很糟糕）

* * *

## 回答 #1

> 赞同：8
> 
> 时间：2009-05-05T13:59:24.943

假设你有一个 type 的值`IEnumerable<Item>`，你可以`sum_by`从`Seq`模块中使用：

```
let totalSize = items |> Seq.sum_by (fun (i : Item) -> i.Size) 
```

请注意，F# 的`Microsoft.FSharp.Collections.List<T>`类型与您可能习惯 from的类型不同`System.Collections.Generic.List<T>`，并且它们不可互换。但是，`Seq`模块中的方法适用于 any `IEnumerable<T>`，并且`IEnumerable<T>`在 F# 和 C# 之间是相同的。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2009-05-05T13:57:19.177

```
let totalSize = items |> List.sum_by (fun i -> i.Size) 
```

LINQ 在 F# 中也可以正常工作，但最好使用上面的列表解析，因为它更多地属于函数式传统（并且由于它不使用而执行得稍微快一些`IEnumerable<T>`）。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2009-05-05T13:55:28.980

这是 F# 和其他函数式语言中的“折叠”。查找 Seq.fold 的示例。

# mysql - MySQL 性能 DELETE 还是 UPDATE？

> ID：824936
> 
> 赞同：10
> 
> 时间：2009-05-05T13:50:24.093
> 
> 标签：mysql, performance

我有一个超过 10^7 行的 MyISAM 表。向其中添加数据时，我必须在最后更新约 10 行。删除它们然后插入新的更快，还是更新这些行更快？应该更新的数据不是索引的一部分。索引/数据碎片呢？

* * *

## 回答 #1

> 赞同：23
> 
> 时间：2009-05-05T13:57:58.660

`UPDATE`速度要快得多。

当您`UPDATE`时，表记录只是被新数据重写。

当你`DELETE`时，索引应该被更新（记住，你删除了整行，而不仅仅是你需要修改的列）并且数据块可能会被移动（如果你达到了`PCTFREE`限制）

而这一切都必须在`INSERT`.

这就是为什么您应该始终使用

```
INSERT ... ON DUPLICATE KEY UPDATE 
```

而不是`REPLACE`.

前一个是`UPDATE`在密钥违规的情况下的操作，而后一个是`DELETE`/ `INSERT`。

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2009-05-05T13:55:37.060

更新速度更快。您还可以使用 INSERT ON DUPLICATE KEY UPDATE

```
INSERT INTO table (a,b,c) VALUES (1,2,3)
  ON DUPLICATE KEY UPDATE c=c+1; 
```

有关更多详细信息，请阅读更新[文档](http://dev.mysql.com/doc/refman/5.0/en/insert-on-duplicate.html)

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2009-09-14T12:10:38.357

与其为了性能而删除或更新数据，我会考虑分区。

[http://dev.mysql.com/doc/refman/5.1/en/partitioning-range.html](http://dev.mysql.com/doc/refman/5.1/en/partitioning-range.html)

这将允许您保留历史数据，而不会降低性能。

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2009-05-05T13:55:50.523

逻辑上 DELETE+ADD = 2 个动作，UPDATE = 1 个动作。还在 auto_increment 上删除和添加新的更改记录 ID，因此如果这些记录的关系会被破坏，或者也需要更新。我会去更新。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2009-05-05T14:10:29.490

只要搜索条件在索引中，使用 Column='something' 的更新就应该使用索引（无论是查找还是扫描都是完全不同的问题）。

如果您经常进行这些更新但在条件列上没有索引，我建议您在您正在使用的列上创建一个索引。这应该有助于加快速度。

# sql-server - 无法通过固定名称解析 SQL Server CE 提供程序工厂

> ID：824938
> 
> 赞同：0
> 
> 时间：2009-05-05T13:50:32.343
> 
> 标签：sql-server, ado.net, machine.config

这行代码

```
DbProviderFactory factory = DbProviderFactories.GetFactory("Microsoft.SqlServerCe.Client"); 
```

抛出此异常

> System.Configuration.ConfigurationErrorsException：未能找到或加载注册的 .Net Framework 数据提供程序。

虽然我的 machine.config 文件包含以下部分

```
<system.data>
  <DbProviderFactories>
    <add name="OracleClient Data Provider" invariant="System.Data.OracleClient" description=".Net Framework Data Provider for Oracle" type="System.Data.OracleClient.OracleClientFactory, System.Data.OracleClient, Version=2.0.0.0, Culture=neutral, PublicKeyToken=b77a5c561934e089" />
    <add name="SqlClient Data Provider" invariant="System.Data.SqlClient" description=".Net Framework Data Provider for SqlServer" type="System.Data.SqlClient.SqlClientFactory, System.Data, Version=2.0.0.0, Culture=neutral, PublicKeyToken=b77a5c561934e089" />
    <add name="SQL Server CE Data Provider" invariant="Microsoft.SqlServerCe.Client" description=".NET Framework Data Provider for Microsoft SQL Server 2005 Compact Edition" type="Microsoft.SqlServerCe.Client.SqlCeClientFactory, Microsoft.SqlServerCe.Client, Version=9.0.242.0, Culture=neutral, PublicKeyToken=89845dcd8080cc91" />
  </DbProviderFactories>
</system.data> 
```

我错过了什么吗？我应该看看别的地方吗？像代码一样`DbProviderFactory factory = SqlCeProviderFactory.Instance`工作正常。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-05-27T14:16:48.623

有[多个 SQL Server CE 安装](http://support.microsoft.com/kb/920700)。[Visual Studio 工具](http://www.microsoft.com/downloads/details.aspx?FamilyId=877C0ADC-0347-4A47-B842-58FB71D159AC&displaylang=en)提供服务器资源管理器和设计组件，并将 SQL Server CE DLL 放置在 Visual Studio 的本地位置。我需要安装[运行时](http://www.microsoft.com/downloads/details.aspx?familyid=85e0c3ce-3fa1-453a-8ce9-af6ca20946c3)才能在 machine.config 文件中注册数据提供程序。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-09-28T20:46:22.970

在 Visual Studio 2012 中，默认的**ProviderName**是`System.Data.SqlServerCe.4.0`.

这让*我*可以按名称找到工厂：

```
String providerName = "System.Data.SqlServerCe.4.0";

DbProviderFactory factory = DbProviderFactories.GetFactory(providerName);
if (factory == null)
   throw new Exception("Unable to locate factory for " + providerName);

DbConnection conn = factory.CreateConnection();
conn.ConnectionString = connectionString;
conn.Open(); 
```

> **注意**：任何代码都会发布到公共领域。无需归属。

# .net - .Net 的 RSS/Atom 解析库

> ID：824949
> 
> 赞同：3
> 
> 时间：2009-05-05T13:52:15.070
> 
> 标签：.net, parsing, rss, atom-feed

我正在尝试找到一个可以读取给定 RSS/Atom 提要的库，并且可以猜测其格式并将其抽象为项目列表。

这个想法是构建一个可以接收任何提要的简单 RSS 阅读器。

我知道 PHP 有几个库可以做到这一点，但我找不到任何 .Net 版本。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2009-05-05T14:04:39.517

如果您使用的是 3.5，则可以使用[System.ServiceModel.Syndication](http://msdn.microsoft.com/en-us/library/system.servicemodel.syndication.aspx)命名空间中的类

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2009-05-05T13:55:20.663

我相信[ASP.NET RSS Toolkit 可以满足](http://www.codeplex.com/ASPNETRSSToolkit)您的需求。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2009-05-05T13:55:29.307

[Argotic](http://argotic.codeplex.com/)是一个非常全面的内容联合框架。

# java - Lucene 性能

> ID：824973
> 
> 赞同：6
> 
> 时间：2009-05-05T13:56:41.283
> 
> 标签：java, performance, lucene

您能否建议 lucene 性能应遵循的步骤。尤其是大数据（大约 1TB 的 pdf 文件要编入索引）

* * *

## 回答 #1

> 赞同：9
> 
> 时间：2009-05-05T14:35:02.330

1.  阅读[缩放 Lucene 和 Solr](http://www.lucidimagination.com/Community/Hear-from-the-Experts/Articles/Scaling-Lucene-and-Solr)。
2.  从 Lucene 定义您的需求（例如：您正在索引 PDF - 您是否需要存储全文，只是为了使其可搜索，还是根本不需要？）
3.  做一个小规模的实验——索引几个文档，看看检索是否足够好。
4.  尝试对整个事物进行索引（考虑论文中关于快速索引和索引检索速度的提示） - 检索是否足够好？性能是否足够好？
5.  迭代。

* * *

## 回答 #2

> 赞同：6
> 
> 时间：2009-05-05T17:08:01.263

请查看有关[优化 Lucene 性能](https://stackoverflow.com/questions/668441/optimizing-lucene-performance/668875)问题的提示。由于您正在处理大量数据，因此您还需要观察索引创建性能。Lucene Wiki 上提供了一些[提高索引性能](http://wiki.apache.org/lucene-java/ImproveIndexingSpeed)和[搜索性能](http://wiki.apache.org/lucene-java/ImproveSearchingSpeed)的技巧。

# javascript - 如何使用 Jquery 更新收音机的值

> ID：824974
> 
> 赞同：0
> 
> 时间：2009-05-05T13:56:42.330
> 
> 标签：javascript, jquery

我有这个用于收音机的 HTML 代码：

```
<input type='radio' name='a_27' value='Yes' id='a_27_0' />

<input type='radio' name='a_27' value='No' id='a_27_1' /> 
```

我正在尝试使用以下代码设置收音机的选定值：

```
var field="a_" + this.id;
$('[name="' + field + '"]').val(this.value);
console.log("name is " + field + ", val is " + this.value); 
```

但是它不起作用，运行时没有任何反应。这是第 3 行之后出现的 Firebug 控制台的输出：

> name 是 a_27，val 是 Yes

有任何想法吗？

我更喜欢一种同样适用的方法`<select>s`，因此我不需要为收音机和选择编写额外/单独的代码。

编辑：我注意到一个奇怪的问题，尽管我的 html 代码给出了不同的值（是/否），但在 firebug 中，它显示两个收音机都具有值“是”。如果我选择否并单击保存，javascript 函数仍会收到“是”而不是“否”。难道我做错了什么？

编辑2：完整功能：

```
function processMultiOptAnswers()
{
    $.each(multiOpts,function()
        {
            var field="a_" + this.id;
            console.log("name is " + field + ", val is " + this.value);

            $('[name="' + field + '"]').val(this.value);
        }
    );
} 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2009-05-05T14:00:36.017

如果不同，您的日志应该`this.value`是不同的。

```
$('[name="' + field + '"]').val(this.value);
console.log("name is " + field + ", val is " + $('[name="' + field + '"]').val()); 
```

使其被选中

```
$('[name="' + field + '"]').attr("checked", "checked"); 
```

我没有对此进行测试，但您可能必须从其他属性中删除该属性。

# html - jsf 消息：添加链接

> ID：824985
> 
> 赞同：3
> 
> 时间：2009-05-05T13:59:10.780
> 
> 标签：html, jsf, richfaces

目前在 JSF 中，包含在消息（`rich:messages`标记）中的所有 HTML 都被转义并仅显示为标记。例如，在我的支持 bean 中，我有：

```
createMessage("Title created successfully with product number: <a href=\"http://www.example.com\">" + product.getProductNumber() + "</a>."); 
```

where`createMessage()`只是一个辅助函数，它将新消息添加到 faces 上下文，然后可以在我的`rich:messages`标签中查看。

创建此消息后，我的消息仅显示转义的 HTML：

```
Title created successfully with product number: <a href="http://www.example.com">1234</a>. 
```

有什么办法可以避免这种情况，而只是在消息中提供一个实际链接？

提前致谢

〜扎克

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2009-05-06T13:57:21.743

一个快速的解决方案是创建一个新的渲染器。

我已经为***h:messages***这样做了，因为我想将不同严重性的消息分成单独的 div。如果您不想使用默认渲染器，那么这是一个不错的选择。

您将覆盖/扩展的标准类是：

```
public class MessagesRenderer extends HtmlBasicRenderer 
```

您只需使用不会转义文本的 ResponseWriter。具体类是转义文本的 HtmlResponseWriter。您可以扩展它并覆盖

```
public void writeText(Object text, String componentPropertyName) 
```

这样它就不会使用 HtmlUtils。

然后只需将新渲染器添加到 faces-config.xml

```
<render-kit>
    <renderer>
        <component-family>javax.faces.Messages</component-family>
        <renderer-type>javax.faces.Messages</renderer-type>
        <renderer-class>com.mypackage.MessagesRenderer</renderer-class>
    </renderer>
</render-kit> 
```

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2009-05-05T22:44:12.420

听起来您需要创建自己的`rich:messages`具有`escape`属性的版本，例如`h:outputText`，因此您可以禁用 HTML 转义。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-11-11T19:25:40.490

如果您使用的是 jquery，则可以取消转义 xml 字符：

```
<script type="text/javascript">
         //<![CDATA[
        $(document).ready(function() {
            $(".esc").each(function(i) {
                var h = $(this).html();                
                h = h.replace(/&lt;/gi, "<");
                h = h.replace(/&gt;/gi, ">");
                $(this).html(h);
            });
        });
        //]]> 
     </script> 
```

# python - 为什么 Tkinter 使用 canvas.create_image 中断？

> ID：824988
> 
> 赞同：1
> 
> 时间：2009-05-05T13:59:47.487
> 
> 标签：python, python-imaging-library, tkinter, tk

我有一个正在运行的 python GUI 应用程序，我打算在 Windows 和 Mac 上使用它。Tkinter 上的文档不是最好的，而且 google-fu 让我失望了。

简而言之，我正在做：

```
c = Canvas(
    master=frame,
    width=settings.WINDOW_SIZE[0],
    height=settings.WINDOW_SIZE[1],
    background=settings.CANVAS_COLOUR
)
file = PhotoImage(file=os.path.join('path', 'to', 'gif'))
c.create_bitmap(position, image=file)
c.pack()
root.mainloop() 
```

如果我注释掉 create_bitmap 行，应用程序绘制得很好。如果我重新评论它，我会收到以下错误：

`_tkinter.TclError: unknown option "-image"`

这很奇怪。根据python 测试（即导入_tkinter、Tkinter 和doing `Tk()`），Tkinter 很好。我已经在我的 Windows 设置（XP SP3，Python 2.6）上安装了 PIL，想象它正在做一些低级别的繁重工作。似乎不是；我仍然收到上述错误。

完整的堆栈跟踪，不包括我已经粘贴的代码，是：

```
File "C:\Python26\lib\lib-tk\Tkinter.py", line 2153, in create_bitmap
return self._create('bitmap', args, kw)
File "C:\Python26\lib\lib-tk\Tkinter.py", line 2147, in _create
*(args + self._options(cnf, kw)))) 
```

任何人都能够阐明任何启示？

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2009-05-05T16:05:38.730

Tk 有两种类型的图形，位图和图像。图像有两种风格，位图和照片。位图和位图类型的图像不是一回事，这会导致文档混乱。PhotoImage 创建一个类型为 photo 的图像，并且在画布中需要一个图像对象，因此正如您已经得出的结论，解决方案是使用 create_image。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2009-05-05T15:41:44.993

简短的回答：当您打算使用 create_image 时，不要使用 create_bitmap。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-05-06T07:44:52.293

该`create_bitmap()`方法没有`image`参数；相反，它有一个[`bitmap`](http://infohost.nmt.edu/tcc/help/pubs/tkinter/create_bitmap.html)论点。

您得到的错误来自于在 Tkinter 中，一个 Tcl 解释器正在运行，嵌入在 Python 进程中，并且所有 GUI 交互在 Python 和 Tcl 之间来回进行；因此，您得到的错误来自 Tcl 回复“我不知道 .create_bitmap 调用中的任何 -image 选项”这一事实。

无论如何，就像 Jeff 所说，您可能需要该`create_image`方法。

# git - Git/gitosis：如何检查用户名和电子邮件的有效性？

> ID：824990
> 
> 赞同：12
> 
> 时间：2009-05-05T14:00:19.153
> 
> 标签：git, gitosis

我已经安装了 git 和 gitosis，当某些东西被推入存储库时，我需要添加一个检查用户名是否有效。

我认为 pre-receive 钩子是放置这个的正确钩子，但是我无法找到 gitosis 进入存储库的真实用户名和电子邮件地址（由 git config user.name 和 git config user.name 设置的那些）。电子邮件）来自环境变量。LOGNAME 和 USER 都是 'git'。gitosis 如何检测到这些信息，我也可以在预接收挂钩中找到它吗？

* * *

## 回答 #1

> 赞同：9
> 
> 时间：2009-05-05T14:28:30.723

嗯，从我从钩子中收集到的内容中，更新了[`githooks(5)`](http://git-scm.com/docs/githooks)refs 。`pre-receive``stdin`

```
#!/bin/sh

while read old new name; do
    email=$(git log -1 --pretty=format:%ae $new)
    # check email
done 
```

您需要检查电子邮件地址（可能有不止一行数据）并相应地退出脚本，即`exit 0`成功和`exit 1`失败。

* * *

## 回答 #2

> 赞同：5
> 
> 时间：2009-05-06T13:19:56.840

好的，我们设法完成了工作，Bombe 上面的回复很有帮助。这是如何完成的：

*   我将 os.environ['GITOSIS_USER'] = user 添加到 Gitosis/Serve.py，函数 Main() 并重新安装它。
*   然后我创建了以下预接收脚本：

`hooks/pre-receive`

 ````
#!/usr/bin/perl

my $user = $ENV{'GITOSIS_USER'};

if ($user !~ m/^[^@]+@[^@]+$/ ) {
  print STDERR "Unknown user. Not running under Gitosis?\n";
  exit 1;
}

my $fail = 0;

while(<STDIN>) {
  if (m/^([0-9a-f]+)\s+([0-9a-f]+)\s+(\S+)$/) {

    my $oldver = $1;
    my $curver = $2;
    my $ref = $3;

    my $ret = open (FH, "-|", "git", "rev-list", '--pretty=format:%H:%ae:%ce',$

    if ($ret) {
      # great and less brakets hidden in HTML: &gt;FH&lt;
      while (<FH>) {
        chomp;
        my $line = $_;
         if ($_ !~ m/commit /) {
          my ($rev, $author, $committer) = split(":", $line);
          if ( $author ne $user && $committer ne $user ) {
            print STDERR "Unauthorized commit: $rev\n";
            $fail++;
          }
        }
      }
    }
  }
}

if ($fail) {
  exit 1;
}

 exit 0; 
````  `这意味着用户名必须与用于为 gitosis 密钥环创建 ssh 密钥的用户名相同。

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2009-09-08T08:49:43.453

该脚本在几个方面被破坏。首先，open() 行被切断。在我修复它之后，脚本在第一个 while() 时进入了无限循环，甚至没有尝试调用 git-rev-list。

在朋友们的帮助下，我设法对其进行了一些修饰：

`hooks/pre-receive`

 ````
#!/usr/bin/perl

my $user = $ENV{'GITOSIS_USER'};

if ($user !~ m/^[^@]+@[^@]+$/ ) {
  print STDERR "Unknown user. Not running under Gitosis?\n";
  exit 1;
}

my $fail = 0;

while(<STDIN>) {
  if (m/^([0-9a-f]+)\s+([0-9a-f]+)\s+(\S+)$/) {

    my $oldver = $1;
    my $curver = $2;
    my $ref = $3;

    my $ret = open (FH, "-|", "git", "rev-list", '--    pretty=format:%H:%ae:%ce',"$oldver..$curver");

    if ($ret) {
      while (<FH>) {
        chomp;
        my $line = $_;
        if ($_ !~ m/commit /) {
          my ($rev, $author, $committer) = split(":", $line);
          if ( $author ne $user && $committer ne $user ) {
            print STDERR "Unauthorized commit: $rev\n";
            print STDERR "You must specify Author and Committer.\n";
            print STDERR "Specified a/c: $author / $committer\n";
            print STDERR "Expected user: $user\n";
            $fail++;
          }
        }
      }
    }
  }
}

if ($fail) {
  exit 1;
}

exit 0; 
````  `* * *

## 回答 #4

> 赞同：1
> 
> 时间：2009-05-06T09:57:49.290

在 serve.py 的 ~line 202 添加 os.environ['WHATVER_USER']=user 应该可以解决问题...

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2012-11-27T10:08:13.187

您可以检查`<gitosis-path>/.ssh/authorized_keys`并查看：

```
command="gitosis-serve name@server",... 
```

阅读手册`sshd`并发现：在`command="command"`您可以添加`environment="NAME=value"`选项来为您的公共 ssh 密钥设置所需的用户名之后。并且不需要`Gitosis/Serve.py`编辑。

默认情况下禁用环境处理，并通过以下`PermitUserEnvironment`选项控制：

```
sudo echo "PermitUserEnvironment yes" >> /etc/ssh/sshd_config 
```

# html - 使用 Div 标签重新设计表格（动态宽度）

> ID：824991
> 
> 赞同：2
> 
> 时间：2009-05-05T14:00:21.057
> 
> 标签：html, css, css-tables

我想显示一个具有经典设计的 html 页面。页眉、页脚、内容和右侧的栏。

出于某种原因，我不喜欢内容的固定宽度。在宽屏幕上，您应该能够调整页面大小，使其填满屏幕，或者使其非常小以并排显示两个页面。

我也想使用 div 标签而不是表格布局。使用 div 标签给了我以下优势（有人告诉我）：

*   可以在等待“右”栏时呈现内容
*   在手机上，Div 标签可以在彼此下方显示，而不是并排显示。

我的测试/调试 html 如下所示：

```
<!-- Create content with DIV tags -->
<div id="head" style="background-color:aqua">This is the header</div>
<div id="body" style="float:left;">
    <p>Lorem ipsum dolor sit amet, consectetur adipiscing elit. Vivamus sodales sagittis sem, at bibendum nunc aliquet non. Maecenas condimentum, libero pharetra suscipit sodales, dui diam laoreet velit, at lacinia nisl erat sed turpis. Quisque lobortis consequat elementum. Suspendisse non interdum est. In velit felis, rhoncus tincidunt tincidunt sit amet, laoreet eu ligula. Nulla facilisi. Sed ornare facilisis pulvinar. Integer viverra arcu eu turpis dictum vitae tincidunt magna scelerisque. Nunc laoreet pulvinar odio, quis rutrum libero consectetur non. Donec molestie, felis volutpat condimentum iaculis, orci arcu feugiat sapien, accumsan scelerisque sapien orci sed urna. Curabitur et turpis sit amet diam vulputate egestas. </p>
</div>
<div id="right" style="background-color:orange; float:right; width:10em;">
    <p>Lorem ipsum dolor sit amet, consectetur adipiscing elit.</p>
</div>
<div id="tail" style="background-color:lime;clear:both;">This is the Footer</div>

<p>&nbsp;</p>

<!-- Create content with TABLE tag -->
<div id="t-head" style="background-color:aqua">This is the header</div>
<table cellpadding="0" cellspacing="0">
    <tr><td>
        <p>Lorem ipsum dolor sit amet, consectetur adipiscing elit. Vivamus sodales sagittis sem, at bibendum nunc aliquet non. Maecenas condimentum, libero pharetra suscipit sodales, dui diam laoreet velit, at lacinia nisl erat sed turpis. Quisque lobortis consequat elementum. Suspendisse non interdum est. In velit felis, rhoncus tincidunt tincidunt sit amet, laoreet eu ligula. Nulla facilisi. Sed ornare facilisis pulvinar. Integer viverra arcu eu turpis dictum vitae tincidunt magna scelerisque. Nunc laoreet pulvinar odio, quis rutrum libero consectetur non. Donec molestie, felis volutpat condimentum iaculis, orci arcu feugiat sapien, accumsan scelerisque sapien orci sed urna. Curabitur et turpis sit amet diam vulputate egestas. </p>
    </td><td valign="top" style="background-color:orange; width:10em;">
        <p>Lorem ipsum dolor sit amet, consectetur adipiscing elit.</p>
    </td></tr>
</table>
<div id="t-tail" style="background-color:lime;clear:both;">This is the Footer</div> 
```

这段代码的输出在这里：

[![div 与表格](https://i.stack.imgur.com/d4VXt.png)](https://i.stack.imgur.com/d4VXt.png)
[（来源：[vantslot.be](http://www.vantslot.be/images/StackOverflow/Example-TableDiv.png)）]

（文字无所谓，只有布局，所以我把它缩小了一点）。

顶部布局使用 div：**错误**

底部布局使用表格：**好**

## 我的问题/问题

如何将“右”栏定位在内容的右侧，同时保持内容的动态宽度，而不使用表格布局？

我真正想要的是右窗格出现在内容的右侧，但是当浏览器太小（< 20em）时，它可以显示在它下面。这对于表格是不可能的，所以我更喜欢 div 解决方案。

在最终的网站中，页眉/页脚/内容和右侧的内容将动态生成，因此我无法对高度进行硬编码。

## 编辑

谢谢所有的答案，这真的帮助我前进。

我看到这里有什么“错误”。我将*右*窗格放在*内容*窗格之后。如果我将右窗格放在内容窗格之前，它会正确呈现（在向内容添加边距后）。

这对于 html 的流程来说有点不合逻辑。由于内容比右窗格中的内容更重要，我希望它在右窗格之前发送给客户端。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-05-05T14:25:14.693

这将允许您的右侧固定宽度列适合您另一列的边距，因此位于同一行：

```
#right
{
    float:right; 
    width:18em;
}

#body
{
    margin-right: 20em; //IE calculates padding into the width, so you need a buffer unless you set body's padding to 0
} 
```

现在，body 的 div（默认为 100% 屏幕宽度）将是流动的，而您的右列将是固定宽度。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-05-05T14:09:17.930

在右栏中添加 clear:both。要管理在主要内容区域底部浮动的高度，请使用[clearfix](http://www.positioniseverything.net/easyclearing.html)。另外，既然您希望右列浮动在左列下方，那么没有必要浮动左列？

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-05-05T14:37:10.657

试试这个代码：

```
<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Strict//EN" 

"http://www.w3.org/TR/xhtml1/DTD/xhtml1-strict.dtd">
    <html xmlns="http://www.w3.org/1999/xhtml" xml:lang="en" lang="en">
    <head>
    <title>Пример</title>
    <style type="text/css">
      html,body{
        margin:0;
        padding:0;
      }

      #header{
        height:150px;
        min-width:600px;
        background:#FFEF97
        }

      #menu{
        width:250px;
        float:right;
        background:#FFC597
        }

      #info{
        min-width:350px;
        background: red;
        }

      #footer{
        height:20px;
        min-width:600px;
        background:#B9CC8A;
        clear:both
      }

      #body{
        width: expression(((document.documentElement.clientWidth
        || document.body.clientWidth) < 600)?
        "600px" : "100%")
        }
    </style>
    </head>
    <body>
    <div id="body">
    <div id="header">HEADER</div>
    <div id="menu">MENU (side bar)</div>
    <div id="info">INFO (central pane)</div>

    <div id="footer">FOOTER</div>
    </div>
    </body>
    </html> 
```

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2009-05-15T12:55:30.430

尚未测试（尚未），但我想我已经找到了问题的解决方案。

[http://www.alistapart.com/articles/holygrail/](http://www.alistapart.com/articles/holygrail/)

该解决方案允许混合固定布局和流动布局（我从提出这个问题中学到的术语）。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2009-05-05T14:21:49.447

试试下面的 CSS 片段：

```
display: table; 
```

# ruby-on-rails - 如何在 RubyOnRails 中使用“充当嵌套集”创建可排序接口

> ID：824996
> 
> 赞同：6
> 
> 时间：2009-05-05T14:00:51.960
> 
> 标签：ruby-on-rails, ruby, scriptaculous, nested-sets

我一直在实现一些不错的交互式界面，可以在我的 m rails 应用程序中为使用`acts_as_list`. 我有一个排序函数，在每次拖放后使用 sortable_element script.aculo.us 函数调用并设置每条记录的位置。

这是在拖放完成后处理排序的控制器操作示例：

```
 def sort
    params[:documents].each_with_index do |id, index|
      Document.update_all(['position=?', index+1], ['id=?', id])
    end
  end 
```

`acts_as_nested_set`现在我正在尝试对嵌套集 ( )的模型做同样的事情。界面交互类型示例： http: [//script.aculo.us/playground/test/functional/sortable_tree_test.html](http://script.aculo.us/playground/test/functional/sortable_tree_test.html)

我被困在如何编写控制器操作以在拖放完成时处理排序。

到目前为止，我已将 :tree=>true 参数添加到可排序的 _element 函数中，该函数似乎发送了一个哈希列表，但似乎我仍然缺少有关整个嵌套顺序的信息......

我确定这之前已经完成并且不想尝试重新发明轮子，但我似乎找不到任何控制器操作的示例 <-> 视图与 js 函数设置来处理可排序 `acts_as_nested_set`

任何有关在 ruby​​onrails 中创建交互式可排序嵌套集的帮助将不胜感激！

谢谢，

约翰

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2010-11-01T14:41:17.877

[一个很好的解决方案，来自http://henrik.nyh.se/2008/11/rails-jquery-sortables](http://henrik.nyh.se/2008/11/rails-jquery-sortables)的一个 sql-query

```
# in your model:

def self.order(ids)
  update_all(
    ['ordinal = FIND_IN_SET(id, ?)', ids.join(',')],
    { :id => ids }
  )
end 
```

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2010-09-05T01:01:01.920

在此处查看示例应用程序 - [http://github.com/matenia/jQuery-Awesome-Nested-Set-Drag-and-Drop](http://github.com/matenia/jQuery-Awesome-Nested-Set-Drag-and-Drop)

这是一种 hacky 方式，但它基本上是先排序，然后保存顺序。使用nestedsortables、serializelist和2个动作遍历树

PS：我知道这个问题已经有一年多了，但希望上面的链接可以帮助其他人来这里。

编辑：添加了 Rails3 示例和一些更简洁的代码。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2009-05-25T23:49:02.620

刚发现这个：

**`sortable_element_for_nested_set`**在github上

看起来它会完成这项工作，但是我在尝试实现它时遇到了一些错误。它基本上使 javascript 返回被移动元素的 id，然后遍历元素并返回其新的父级、左值和右值。不敢相信这么长时间才写出这样的东西！幸运的是，就在我需要它的时候：）

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2010-11-02T11:58:51.860

这是我项目中的一段代码，可以解决问题：

[http://gist.github.com/659532](http://gist.github.com/659532)

```
 def reorder_children(ordered_ids)
    ordered_ids = ordered_ids.map(&:to_i)
    current_ids = children.map(&:id)
    unless current_ids - ordered_ids == [] && ordered_ids - current_ids == []
      raise ArgumentError, "Not ordering the same ids that I have as children. My children: #{current_ids.join(", ")}. Your list: #{ordered_ids.join(", ")}. Difference: #{(current_ids - ordered_ids).join(', ')} / #{(ordered_ids - current_ids).join(', ')}" 
    end
    j = 0
    transaction do
      for new_id in ordered_ids
        old_id = current_ids[j]
        if new_id == old_id
          j += 1
        else
          Category.find(new_id).move_to_left_of(old_id)
          current_ids.delete(new_id)
        end
      end
    end
  end 
```

您在父级上调用它，它会对子级进行排序。

您只需传入从 Sortable 获得的值，如下所示：

```
 def reorder
    @category.reorder_children(params[:categories])
    render :nothing => true
  end 
```

希望这可以帮助。

//拉尔斯

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2011-08-23T13:35:40.913

[the_sortable_tree](https://github.com/the-teacher/the_sortable_tree)

Rails 3.1+ 的可排序嵌套集

梦见嵌套集的拖放？它应该与 JQuery 一起使用？这是解决方案！``***`****