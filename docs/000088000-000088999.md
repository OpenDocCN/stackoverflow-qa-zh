# StackOverflow 问答 000088000-000088999

# unit-testing - 对可以具有随机行为的方法进行单元测试

> ID：88007
> 
> 赞同：4
> 
> 时间：2008-09-17T21:46:18.377
> 
> 标签：unit-testing, random

今天下午我遇到了这种情况，所以我想问问你们是做什么的。

我们有一个用于用户密码重置的随机密码生成器，在修复它的问题时，我决定将例程移到我的（缓慢增长的）测试工具中。

我想测试生成的密码是否符合我们制定的规则，但当然函数的结果将是随机的（或者，好吧，是伪随机的）。

你们会在单元测试中做什么？生成一堆密码，检查它们都通过并认为足够好？

* * *

## 回答 #1

> 赞同：8
> 
> 时间：2008-09-17T21:56:08.400

单元测试每次运行时都应该做同样的事情，否则你可能会遇到单元测试只是偶尔失败的情况，这可能是调试的真正痛苦。

尝试每次都用相同的种子播种伪随机器（在测试中，即——不是在生产代码中）。这样，您的测试每次都会生成相同的输入集。

如果你不能控制种子并且没有办法阻止你正在测试的函数被随机化，那么我猜你被一个不可预测的单元测试困住了。:(

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2008-09-17T21:57:49.987

该函数是一个假设，即对于所有输入，输出都符合规范。单元测试是试图证伪该假设。所以是的，在这种情况下你能做的最好的事情就是产生大量的输出。如果它们都通过了您的规范，那么您可以合理地确定您的功能按规定工作。

考虑将随机数生成器放在这个函数之外并向它传递一个随机数，使函数具有确定性，而不是让它直接访问随机数生成器。这样，您可以在测试工具中生成大量随机输入，将它们全部传递给您的函数，然后测试输出。如果失败，请记录该值是什么，以便您拥有记录在案的测试用例。

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2008-09-17T21:58:42.323

除了测试一些以确保它们通过之外，我还会编写一个测试以确保*违反*规则的密码失败。

代码库中是否有任何东西检查生成的密码以确保它们足够随机？如果没有，我可能会考虑创建逻辑来检查生成的密码，对其进行测试，然后您可以声明随机密码生成器正在工作（因为“坏”密码不会出现）。

一旦掌握了该逻辑，您就可以编写一个集成类型测试，该测试将生成大量密码并将其传递给逻辑，此时您就会了解随机密码生成的“好”程度。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2008-09-17T21:53:20.090

好吧，考虑到它们是随机的，没有真正的方法可以确定，但是测试 100 000 密码应该可以消除大多数疑问:)

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2008-09-17T21:56:20.567

您还可以查看突变测试（Java 的[Jester ，Ruby 的](http://jester.sourceforge.net/)[Heckle](http://glu.ttono.us/articles/2006/12/19/tormenting-your-tests-with-heckle)）

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2008-09-17T21:57:10.160

您可以使用常数值播种随机数生成器，以获得非随机结果并测试这些结果。

* * *

## 回答 #7

> 赞同：0
> 
> 时间：2008-09-17T21:59:44.490

我假设用户输入的密码符合与随机生成的密码相同的限制。因此，您可能需要一组静态密码来检查已知条件，然后您将有一个循环来执行动态密码检查。循环的大小不是很重要，但它应该足够大，以便您从生成器中获得温暖的模糊感觉，但又不能太大，以至于您的测试需要永远运行。如果随着时间的推移出现任何问题，您可以将这些案例添加到静态列表中。

但从长远来看，弱密码不会破坏您的程序，密码安全性掌握在用户手中。因此，您的首要任务是确保动态生成和强度检查不会破坏系统。

* * *

## 回答 #8

> 赞同：0
> 
> 时间：2008-09-17T22:03:21.157

在不知道您的规则是什么的情况下很难确定，但假设它们类似于“密码必须至少为 8 个字符，其中至少有一个大写字母、一个小写字母、一个数字和一个特殊字符”，那么它就是即使用蛮力检查足够数量的生成密码来证明算法是正确的也是不可能的（因为这将需要超过 8^70 = 1.63x10^63 的检查，具体取决于您指定使用的特殊字符的数量，这需要非常，很长时间才能完成）。

最终，您所能做的就是尽可能多地测试密码，如果有任何违反规则，那么您就知道算法是不正确的。最好的办法可能是让它在一夜之间运行，如果早上一切顺利，你可能会没事。

如果您想在生产中加倍确定，请实现一个外部函数，该函数在循环中调用密码生成函数并根据规则检查它。如果失败，则记录一个指示此错误的错误（因此您知道需要修复它）并生成另一个密码。继续，直到你得到一个符合规则的。

* * *

## 回答 #9

> 赞同：0
> 
> 时间：2008-09-17T22:15:24.390

以我的拙见，您不希望有时通过有时失败的测试。有些人甚至可能认为这种测试不是单元测试。但主要的想法是当你看到绿条时确保该功能是正常的。

牢记这一原则，您可以尝试执行合理的次数，以使错误正确的机会几乎为零。然而，一个单一的测试失败将迫使你进行更广泛的测试，而不是调试失败。

* * *

## 回答 #10

> 赞同：0
> 
> 时间：2008-10-01T14:26:52.507

使用固定的随机种子或使其可重现（即：从当天派生）

* * *

## 回答 #11

> 赞同：0
> 
> 时间：2018-02-14T11:27:16.693

首先，为您的 PRNG 使用种子。您的输入不再是随机的并且消除了不可预测的输出问题——即现在您的单元测试是确定性的。

然而，这并不能解决测试实现的问题，但这里有一个示例，说明如何测试依赖于随机性的典型方法。

想象一下，我们已经实现了一个函数，它需要一组红色和蓝色弹珠并随机挑选一个，但是可以为概率分配一个权重，即 2 和 1 的权重意味着红色弹珠被选中的可能性是蓝色弹珠。

我们可以通过将一个选项的权重设置为零并验证在所有情况下（在实践中，对于大量测试输入）我们*总是*得到例如蓝色弹珠来测试这一点。颠倒权重应该会得到相反的结果（所有红色弹珠）。

这并不能保证我们的函数按预期运行（如果我们传入相同数量的红色和蓝色弹珠并具有相同的权重，我们是否总是在大量试验中得到 50/50 的分布？）但实际上它是往往就足够了。

# apache - 让 apache 自动剥离 www.?

> ID：88011
> 
> 赞同：4
> 
> 时间：2008-09-17T21:46:39.590
> 
> 标签：apache, redirect

出于各种原因，例如 cookie、SEO 以及为了简单起见，我想让 apache 自动将任何对[http://www.foobar.com/anything](http://www.foobar.com/anything)的请求重定向到[http://foobar.com/anything](http://foobar.com/anything)。我能想到的最好的方法是基于 mod_rewrite 的怪物，有没有一些简单的方法可以告诉它“将域 ABC 的所有请求重定向到 XYZ”？

PS：我发现[这个有点相关的问题](https://stackoverflow.com/questions/50931/redirecting-non-www-url-to-www)，但它是针对 IIS 的，并且与我想要的相反。而且它仍然很复杂。

* * *

## 回答 #1

> 赞同：9
> 
> 时间：2008-09-17T21:49:59.583

这很简单：

```
<VirtualHost 10.0.0.1:80>
        ServerName www.example.com
        Redirect permanent / http://example.com/
</VirtualHost> 
```

根据需要调整主机名和 IP :)

* * *

## 回答 #2

> 赞同：7
> 
> 时间：2009-03-30T16:00:53.173

更简单，更容易地从站点复制到站点：

```
RewriteCond %{HTTP_HOST} ^www\.(.+)$
RewriteRule ^(.*)$ http://%1/$1 [R=301,L] 
```

* * *

## 回答 #3

> 赞同：4
> 
> 时间：2008-09-17T21:49:49.147

如果你像我们一样使用 mod_rewrite，那就很简单了；）

这是来自我的实时网站的 .htaccess 的一部分：

```
RewriteEngine on

# Catches www.infinite-labs.net and redirects to the
# same page on infinite-labs.net to normalize things.

RewriteCond %{HTTP_HOST} ^www\.infinite-labs\.net$
RewriteRule ^(.*)$ http://infinite-labs.net/$1 [R=301,L] 
```

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2008-09-17T21:52:23.743

使用带有一些 mod_rewrite 规则的 .htaccess 文件：

```
RewriteEngine On
RewriteRule ^www.SERVERNAME(.*) http://SERVERNAME$1 [L,QSA] 
```

我不确定那里的语法是否正确`$1`，但有据可查。l 向浏览器发送一个location: header，QSA表示Query String Append。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2008-09-17T21:50:06.400

既然您提到使用 mod_rewrite，我建议在您的 .htaccess 中使用一个简单的规则 - 对我来说似乎并不可怕:)

```
RewriteCond %{HTTP_HOST} ^www\.foobar\.com$ [NC]
RewriteRule ^(.*)$ http://foobar.com/$1 [L,R=301] 
```

* * *

## 回答 #6

> 赞同：-1
> 
> 时间：2008-09-17T21:49:01.770

```
RewriteEngine On
RewriteCond %{HTTP_HOST} ^www.domain.com$ [NC]
RewriteRule ^(.*)$ http://domain.com/$1 [R=301,L] 
```

这应该够了吧。

# c# - C#：将设置导入/导出文件

> ID：88030
> 
> 赞同：2
> 
> 时间：2008-09-17T21:48:51.800
> 
> 标签：c#, .net, visual-studio, visual-studio-2005

从应用程序内部将应用程序内部设置导入/导出到文件的最佳方法是什么？

我有 Settings.settings 文件，winform UI 绑定到设置文件，我想导入/导出设置，类似于 Visual Studio 导入/导出设置功能。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2008-09-17T22:07:18.543

如果您使用的是 Settings.settings 文件，它会保存到配置文件中。通过在更新设置后调用 YourNamespace.Properties.Settings.Save()，它们将被保存到配置文件中。

但是，我不知道您所说的“多组设置”是什么意思。如果设置是用户设置，则每个用户都有自己的一组设置。如果您对单个用户有多组设置，您可能不应该使用 .settings 文件；相反，您将要使用数据库。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2008-09-17T21:52:07.330

您可以使用绑定到表单的 DataSet。您可以保存/恢复它。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2008-09-17T21:52:12.153

您可以只使用部分，还是出于特定原因拆分到其他文件？

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2008-09-17T22:12:41.527

我使用的一种久经考验的方法是设计一个设置容器类。这个容器类可以有不同类型的设置类别的子类。它运行良好，因为您通过属性名称引用您的“设置”，因此如果将来发生变化，您将收到编译时错误。它也是可扩展的，因为您始终可以通过向各个设置类添加更多属性来创建新设置，并将默认值分配给将在旧版本的应用程序中不存在特定设置时使用的属性的私有变量。保存新容器后，新设置也将保留。另一个优点是 XML 明显的人机/计算机可读性，这对设置非常有用。

要保存，请将容器对象序列化为 XML 数据，然后将数据写入文件。要加载，请从文件中读取数据并反序列化回您的设置容器类。

通过标准 C# 代码进行序列化：

```
public static string SerializeToXMLString(object ObjectToSerialize)
MemoryStream mem = new MemoryStream();          
System.Xml.Serialization.XmlSerializer ser = new System.Xml.Serialization.XmlSerializer(ObjectToSerialize.GetType());
ser.Serialize(mem,ObjectToSerialize);                       
ASCIIEncoding ascii = new ASCIIEncoding();
return ascii.GetString(mem.ToArray()); 
```

通过标准 C# 代码反序列化：

```
public static object DeSerializeFromXMLString(System.Type TypeToDeserialize, string xmlString)
byte[] bytes = System.Text.Encoding.UTF8.GetBytes(xmlString);
MemoryStream mem = new MemoryStream(bytes);         
System.Xml.Serialization.XmlSerializer ser = new System.Xml.Serialization.XmlSerializer(TypeToDeserialize);
return ser.Deserialize(mem); 
```

可序列化设置类的最后一个好处是因为它是一个对象，您可以使用 IntelliSense 快速导航到特定设置。

注意：实例化设置容器类后，应使其成为另一个静态管理类的静态属性（如果需要，可以将其称为 SettingsManager）此管理类允许您从应用程序中的任何位置访问您的设置（因为它是静态的) 并且您还可以使用静态函数来处理类的加载和保存。

# java - java 集合的不可修改包装器是否使它们成为线程安全的？

> ID：88036
> 
> 赞同：19
> 
> 时间：2008-09-17T21:49:09.320
> 
> 标签：java, multithreading, collections, unmodifiable

我需要使 ArrayList 的 ArrayLists 线程安全。我也不能让客户对收藏进行更改。不可修改的包装器会使其线程安全，还是我需要在集合上使用两个包装器？

* * *

## 回答 #1

> 赞同：10
> 
> 时间：2008-09-17T21:54:55.327

这取决于。包装器只会阻止对其包装的集合进行更改，而不是对集合中的对象进行更改。如果您有一个 ArrayList 的 ArrayList，则需要单独包装全局 List 及其每个元素 List，并且您可能还必须为这些列表的内容做一些事情。最后，您必须确保原始列表对象未更改，因为包装器仅防止通过包装器引用进行更改，而不是对原始对象进行更改。

在这种情况下，您不需要同步包装器。

* * *

## 回答 #2

> 赞同：5
> 
> 时间：2008-09-18T09:44:09.243

在一个相关主题上——我看到几个回复建议使用同步集合来实现线程安全。使用集合的同步版本并不能使其“线程安全”——尽管在组合两个操作时每个操作（插入、计数等）都受到互斥锁的保护，但不能保证它们会自动执行。例如，以下代码不是线程安全的（即使使用同步队列）：

```
if(queue.Count > 0)
{
   queue.Add(...);
} 
```

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2008-09-17T21:52:17.830

不可修改的包装器仅防止对其应用的列表结构进行更改。如果此列表包含其他列表，并且您有线程试图修改这些嵌套列表，那么您将无法避免并发修改风险。

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2008-09-17T21:53:53.753

从查看 Collections 源，看起来 Unmodifiable 不会**使其**同步。

```
static class UnmodifiableSet<E> extends UnmodifiableCollection<E>
                 implements Set<E>, Serializable;

static class UnmodifiableCollection<E> implements Collection<E>, Serializable; 
```

同步类包装器中有一个互斥对象来执行同步部分，因此看起来您需要同时使用两者来获取两者。或者自己动手！

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2008-09-17T23:51:55.967

我相信，因为 UnmodifiableList 包装器将 ArrayList 存储到最终字段，所以包装器上的任何读取方法都会看到该列表，因为它是在构造包装器时，只要在创建包装器后未修改列表，并且作为只要包装器内的可变 ArrayLists 没有被修改（包装器无法防止）。

* * *

## 回答 #6

> 赞同：1
> 
> 时间：2008-09-18T19:54:30.693

根据定义，不可变对象是线程安全的（假设没有人保留对原始集合的引用），因此**不需要**同步。

使用 Collections.unmodifiableList() 包装外部 ArrayList 可防止客户端更改其内容（从而使其线程安全），但内部 ArrayLists 仍然是可变的。

使用 Collections.unmodifiableList() 包装内部 ArrayLists 也可以防止客户端更改其内容（从而使它们成为线程安全的），这正是您所需要的。

让我们知道此解决方案是否会导致问题（开销、内存使用等）；其他解决方案可能适用于您的问题。:)

编辑：当然，如果列表被修改，它们不是线程安全的。我认为不会进行进一步的编辑。

* * *

## 回答 #7

> 赞同：1
> 
> 时间：2008-09-21T13:08:47.733

如果不可修改的视图被安全地发布，那么它将是线程安全的，并且在不可修改的视图发布后，可修改的原始视图永远不会被修改（包括递归包含在集合中的所有对象！）。

如果您想继续修改原始内容，那么您可以创建集合的对象图的防御性副本并返回不可修改的视图，或者使用固有的线程安全列表开始，并返回不可修改的视图那。

如果您之后仍打算访问未同步的列表，*则不能返回不可修改的列表（同步列表（列表））；*如果可变状态在多个线程之间共享，则*所有*线程在访问该状态时必须在*相同*的锁上同步。

* * *

## 回答 #8

> 赞同：0
> 
> 时间：2008-09-17T21:58:12.997

这是必要的，如果：

1.  仍然有对原始可修改列表的引用。
2.  该列表可能会通过迭代器访问。

如果您打算仅按索引从 ArrayList 中读取，则可以假设这是线程安全的。

如有疑问，请选择同步包装器。

* * *

## 回答 #9

> 赞同：0
> 
> 时间：2008-09-17T21:59:13.803

不确定我是否理解您要做什么，但我会说大多数情况下的答案是“不”。

如果您设置了 ArrayList 和两者的 ArrayList，则外部和内部列表在创建后永远不能更改（并且在创建期间只有一个线程可以访问内部和外部列表），它们可能是包装器的线程安全（如果两者，外部和内部列表的包装方式使得修改它们是不可能的）。ArrayLists 上的所有只读操作很可能是线程安全的。但是，Sun 不**保证**它们是线程安全的（也不适用于只读操作），所以即使它现在可能工作，它也可能在未来中断（如果 Sun 创建一些内部数据缓存以便更快地访问例子）。

# wix - .msi 文件能否自行安装（可能通过自定义操作）？

> ID：88078
> 
> 赞同：9
> 
> 时间：2008-09-17T21:52:40.420
> 
> 标签：wix, windows-installer

我想构建一个 MSI，在其安装过程中，它将自身连同其包含的文件/组件一起部署到 TargetDir。

因此 MyApp.msi 在其文件表中包含 MyApp.exe 和 MyAppBootstrapperEmpty.exe（没有资源）。

用户启动 MyAppBootstrapperPackaged.exe（包含 MyApp.msi 作为资源，从某处的 Internet 或电子邮件或其他方式获得）。MyAppBootStrapperPackaged.exe 将 MyApp.msi 提取到一个临时文件夹并通过 msiexec.exe 执行它。

msiexec.exe 进程完成后，我想要 MyApp.msi、MyBootstrapperEmpty.exe（以及 %ProgramFiles%\MyApp 文件夹中的 MyApp.exe，以便 MyApp.exe 在运行时可以确保访问 MyApp.msi（用于创建以下 -提到的包装内容）。

MyAppBootstrapper*.exe 可以尝试将 MyApp.msi 复制到 %ProgramFiles%\MyApp 文件夹，但需要提升才能这样做，并且不允许通过 Windows Installer 卸载过程（从添加/删除程序或其他方式）将其删除，这应该保留。

显然（我认为这很明显 - 我错了吗？）我不能将 MSI 作为文件包含在我的媒体/CAB（鸡和蛋场景）中，所以我相信必须在安装之前通过自定义操作来完成过程中，将原始 MSI 添加到 MSI DB 的媒体/CAB 和文件表中的适当条目。这可以做到吗？如果可以，怎么做？

考虑一个内容分发模型，其中内容文件只能与应用程序一起分发。内容由最终用户在运行时通过应用程序生成，并打包成一个可分发的 EXE，其中包括应用程序和内容。

MyApp 的安装程序必须保持为 MSI，但可以由 Bootstrapper EXE 执行。安装的 MyApp.exe 必须同时访问 MyApp.msi 和 EXE 将由应用程序在运行时从基础（空）MyAppBootstrapper.exe（也由 MSI 安装）以及由应用程序创建的内容“组装”最终用户。EXE 的资源 MSI 必须与用于安装正在执行运行时打包的 App 的资源 MSI 相同。

WIX 不能与 MyApp 一起安装。

在运行/打包时不能有网络依赖（即不能通过 Web 服务进行打包 - 必须在本地完成）。

我熟悉（并使用）自定义操作（托管和非托管，通过 DTF 和其他方式）。

* * *

## 回答 #1

> 赞同：9
> 
> 时间：2009-02-18T00:52:54.280

像这样向你的 wxs 添加一个未压缩的媒体：

```
<Media Id='2'/> 
```

然后创建一个带有 File 元素的组件，如下所示：

```
<File Source='/path/to/myinstaller.msi' Compressed='no' DiskId='2' /> 
```

这将使安装程序在安装介质上查找名为“myinstaller.msi”的文件，该文件与正在安装的 msi 位于同一文件夹中。上面的源路径应该指向一个虚拟文件，它只是为了安抚wix。

**编辑**：以下示例 test.wxs 演示了它的工作原理。它会生成一个 test.msi 文件，该文件会自行安装到 c:\program files\test。请注意，您需要将虚拟 test.msi 文件与 text.wxs 放在同一文件夹中以安抚wix。

```
<?xml version='1.0' encoding='utf-8'?>
<Wix xmlns='http://schemas.microsoft.com/wix/2006/wi'>
   <Product
         Name='ProductName'
         Id='*'
         Language='1033'
         Version='0.0.1'
         Manufacturer='ManufacturerName' >
      <Package
            Keywords='Installer'
            Description='Installer which installs itself'
            Manufacturer='ManufactererName'
            InstallerVersion='100'
            Languages='1033'
            Compressed='yes'
            SummaryCodepage='1252'/>

      <Media Id='1' Cabinet='test.cab' EmbedCab='yes'/> 
      <Media Id='2' /> 

      <Directory Id='TARGETDIR' Name="SourceDir">
         <Directory Id='ProgramFilesFolder'>
            <Directory Id='TestFolder' Name='Test' >
               <Component Id="InstallMyself">
                  <File Source="./test.msi" Compressed="no" DiskId="2" />
               </Component>
            </Directory>
         </Directory>
      </Directory>

      <Feature
            Id='Complete'
            Display='expand'
            Level='1'
            Title='Copy msi file to program files folder'
            Description='Test'>

         <ComponentRef Id="InstallMyself" />
      </Feature>

   </Product>
</Wix> 
```

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2008-09-18T04:42:54.443

让一个 .MSI 包从“内部”启动另一个 .MSI 包称为*嵌套安装*，这很[糟糕](http://blogs.msdn.com/windows_installer_team/archive/2006/05/12/595950.aspx "坏juju")（参见规则 20）。Windows Installer 有一些用于管理当前安装的全局数据，它不能很好地同时处理多个安装。出于同样的原因，如果您开始一个安装，然后在第一个仍在进行中时尝试启动另一个，您通常会看到一个弹出窗口，显示“另一个正在进行中的安装，请等到它完成”。

您可以拥有一个程序，通常称为引导程序（我认为这就是您所指的），它本身不是安装包，但*包含*一个安装包（例如 .MSI 或 .EXE）作为资源，可能被压缩。引导程序的操作是将资源提取/扩展为文件，通常在`%TEMP%`目录中，然后启动提取的 .EXE 或在提取的 .MSI 上运行 MSIEXEC。如果您需要在主包之前安装先决条件，则引导程序可以包含多个资源并一一提取+安装它们。或者您可以将多个软件包作为单独的文件发送，并让引导程序直接从分发媒体中一个一个地执行/安装它们，或者将它们复制到目标机器并从那里运行一系列安装，或者......

WiX 本身没有安装，没有。它是一个可以用来构建 .MSI 包的工具。WiX 项目的愿望清单上有一个通用的引导程序，但尚未实施。还有其他可用的引导程序，例如[这个](http://msdn.microsoft.com/en-us/magazine/cc163899.aspx "这个")。

您不需要自定义操作——事实上，由于引导程序本身并不是 Windows Installer 安装包，因此“自定义操作”对它没有任何意义。而且，如果您对 CA 足够熟悉以了解托管/非托管/DTF，那么您就可以尽可能避免自定义操作。（咧嘴笑）

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2008-09-19T23:01:07.607

我认为您的引导程序将 MSI 文件提取到某个预定义位置而不是临时文件夹要容易得多。例如，到 C:\Documents and Settings\All Users\Application Data\My Company\My Product Install Cache。安装完成后，引导程序会留下 MSI 文件。如果在某个阶段用户决定重新安装您的产品，Windows Installer 将能够找到源 MSI 文件。

此外，将此文件的路径添加到[RemoveFile 表中](http://msdn.microsoft.com/en-us/library/aa371201.aspx)，以便在卸载时将其删除。您可以为此使用WiX 中的[RemoveFile 元素](http://wix.sourceforge.net/manual-wix2/wix_xsd_removefile.htm)。

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2008-09-17T22:31:22.447

因此，如果我理解，那么我想我会让应用程序创建一个包含内容文件的转换 (MST) 并将其应用于基本 MSI。我仍然不相信我明白了。:)

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2008-11-18T23:18:37.673

我会将 MSI 缓存路径配置到已知位置。

然后在运行时，如果您需要“编辑”MSI 使用 VBScript 或类似的。

但是，我仍然问为什么！？！

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2009-05-08T15:43:54.613

我还在研究一种部署多个 MSI 文件的方法。我有一个 bootstrapper.exe 程序，它捆绑 MSI 文件并一次运行一个。这解决了我在大多数情况下的问题。

它没有解决的情况是安装的 GPO（全局策略对象）分发。GPO 需要一个 dot-msi 文件来运行安装。

要做到这一点，这就是我所做的，它几乎解决了这个问题（但不完全）。我将 dot-msi 文件放在安装程序的文件表中，并将我的引导程序放在二进制表中，并通过在 InstallExecuteSequence 中的 InstallFinalize 之后插入的自定义操作运行它。当然，引导程序将无法运行其他 MSI，因为顶级 MSI 拥有 _MSIExecute 互斥锁。

走得更远一点很容易。我将引导程序返回控制权交给顶级安装程序并继续。然后我添加了一个 WaitForSingleObject 调用来等待顶级安装完成，然后引导程序可以继续完成安装。

我的问题是 GPO 安装发生在启动时，顶层安装在子安装程序完成之前完成，GPO 重新启动机器。

当安装可能稍后实际失败时，顶层安装也会返回成功状态。

我仍在寻找一种方法来阻止顶级安装完成，直到引导程序完成。

# .net - 在 .net 桌面应用程序中启用或禁用功能的最佳方法是什么

> ID：88082
> 
> 赞同：0
> 
> 时间：2008-09-17T21:53:03.070
> 
> 标签：.net, user-controls

它可以在编译时或在运行时使用配置文件。有没有比简单（和许多）if 语句更优雅的方法？

我特别针对特定功能的 UI 控件集。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2008-09-17T21:55:12.020

除非您的程序必须挤出 100% 的性能，否则请使用配置文件。它会让你的代码更干净。

如果一个选项改变了代码的许多部分，不要写很多条件，写一个条件来选择你委托给哪个类。例如，如果偏好选择 TCP 与 UDP，则让您有条件地实例化一个 TcpProvider 或 UdpProvider，您的代码的其余部分将使用它们，而无需担心或大惊小怪。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2008-09-18T01:20:54.663

编译器指令没有那么灵活，但在某些情况下它们是合适的。

例如，默认情况下，当您在 VS.NET 中以 DEBUG 模式编译时，定义了一个“DEBUG”符号......所以你可以这样做

```
void SomeMethod()
{
    #if DEBUG
    //do something here
    #else
    //do something else
    #endif

} 
```

这将导致仅编译其中一个块，具体取决于是否定义了 DEBUG 符号。

此外，您可以在项目属性 -> 构建 -> 条件编译符号中定义其他符号。

或者，通过命令行编译器使用 /define: 开关

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2008-09-17T21:55:22.957

也许我假设太多了，但是：

```
switch (setting) {
  case "development": 
     dostuff;
     break
  case "production":
     dootherstuff;
     break;
  default:
     dothebeststuff;
     break;
} 
```

# sharepoint - 配置搜索设置时出现 MOSS 2007 SSL 错误

> ID：88087
> 
> 赞同：1
> 
> 时间：2008-09-17T21:53:37.390
> 
> 标签：sharepoint, moss, 64-bit

当我们单击共享服务提供者的“搜索设置”时，我们收到以下错误消息：“身份验证失败，因为远程方已关闭传输流。”</p>

这是一个新的服务器环境，有两个 Web 前端、一个数据库服务器和一个索引服务器，都运行 Windows 2003 x64。

是否有人对这是否与 64 位有关，或者可能导致错误的原因有任何想法。

以下是 ULS 的完整详细信息：

> 2008 年 9 月 17 日 16:30:34.13 w3wp.exe (0x0E84) 0x030C 搜索服务器通用 MS 搜索管理 86x4 高 将搜索应用程序 Web 服务 URL 配置为“ [https://mushni-sptwb04q:56738/Shared%20Services%20Portal/搜索/SearchAdmin.asmx](https://mushni-sptwb04q:56738/Shared%20Services%20Portal/Search/SearchAdmin.asmx) '。
> 
> 2008 年 9 月 17 日 16:30:34.14 w3wp.exe (0x0E84) 0x030C Search Server Common MS Search Administration 86ze High Exception 在 Search Admin Web 服务代理（客户端）中捕获。System.Net.WebException：基础连接已关闭：发送时发生意外错误。---> System.IO.IOException: 身份验证失败，因为远程方已关闭传输流。在 System.Net.Security.SslState.StartReadFrame(Byte[] buffer, Int32 readBytes, AsyncProtocolRequest asyncRequest) 在 System.Net.Security.SslState.StartReceiveBlob(Byte[] buffer, AsyncProtocolRequest asyncRequest) 在 System.Net.Security.SslState。 System.Net.Security.SslState 处的 ForceAuthentication（Boolean receiveFirst，Byte[] 缓冲区，AsyncProtocolRequest asyncRequest）。
> 
> 09/17/2008 16:30:34.14* w3wp.exe (0x0E84) 0x030C Search Server Common MS Search Administration 86ze High ...mpilerServices.RuntimeHelpers.ExecuteCodeWithGuaranteedCleanup(TryCode code, CleanupCode backoutCode, Object userData) at System.Threading.ExecutionContext .Run(ExecutionContext executionContext, ContextCallback callback, Object state) at System.Net.TlsStream.ProcessAuthentication(LazyAsyncResult result) at System.Net.TlsStream.Write(Byte[] buffer, Int32 offset, Int32 size) at System.Net.PooledStream .Write(Byte[] buffer, Int32 offset, Int32 size) at System.Net.ConnectStream.WriteHeaders(Boolean async) --- End of internal exception stack trace --- at System.Web.Services.Protocols.WebClientProtocol。GetWebResponse(WebRequest request) at System.Web.Services.Protocols.HttpWebClientProtocol.GetWebResponse(WebRequest request) at System.Web.Services.Protocols.SoapHt...
> 
> 2008 年 9 月 17 日 16:30:34.14* w3wp.exe (0x0E84) 0x030C 搜索服务器通用 MS 搜索管理 86ze 高 ...tpClientProtocol.Invoke（字符串方法名，对象 [] 参数）在 Microsoft.Office.Server.Search。 Administration.SearchWebServiceProxy.RunWithSoapExceptionHandling[T](String methodName, Object[] 参数)

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2008-09-17T23:32:39.570

我猜你在索引服务器中发现了这个异常，对吧？

您是否可以从索引服务器浏览到“ [https://mushni-sptwb04q:56738/Shared%20Services%20Portal/Search/SearchAdmin.asmx](https://mushni-sptwb04q:56738/Shared%20Services%20Portal/Search/SearchAdmin.asmx) ”？

似乎未在前端服务器上正确配置 SSL。这可能会解决您的问题：

1.  移除前端服务器的 SSL 证书
2.  从场中删除索引服务器
3.  将搜索和索引角色移动到前端之一
4.  将索引服务器加入场
5.  将索引/搜索角色添加到索引服务器
6.  将 SSL 证书（您可以使用 SelfSSL 生成）应用于两个前端

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-02-12T23:14:49.843

小心使用 SelfSSL，最好使用使用 SSLDiag。SelfSSL 有一个错误，如果您使用它将证书分配给同一个盒子上的多个站点，则只有最后一个站点可以工作。您可以像这样从命令行运行 SslDiag：

ssldiag /selfssl /V:999 /N:CN=<主机名> /S:<siteId>

使用元数据库资源管理器找到它的一面。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2008-09-17T22:12:03.493

可能是 SSL 问题。
请查看配置文件设置，在访问同一 SSP 的用户配置文件设置时是否遇到任何错误？

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2008-10-29T20:53:25.317

我有同样的问题。“Office Server Web Services”（以下简称 OSWS）站点可通过我的应用服务器上的 HTTP 访问，但不能通过 HTTPS 访问。我尝试从哪里访问 HTTPS URL 并不重要，它只是完全失败（阅读：没有 HTTP 错误代码）。

但是，我想出了更多的信息。当应用服务器加入场时，它为 OSWS 提供了一个与场的其余部分不同的站点标识符。我尝试更改站点标识符，但没有奏效。我还尝试安装 IIS 诊断工具包。这让我看到了 MOSS 在机器加入农场时安装的证书。感兴趣的行是这一行：

```
#WARNING: AcquireCredentialsHandle failed with error -2146893043(0x8009030d) 
```

不幸的是，微软似乎在证书中嵌入了一些信息，这些信息会阻止我使用 SelfSSL 或类似工具。这是主题（适当擦洗）：

```
CN={hostname},L=951338967,OU=SharePoint,O=Microsoft 
```

“L”参数匹配给定站点的原始（和不正确的）站点标识符，而不是与场的其余部分匹配的标识符。

我的下一步是看看我是否可以生成看起来合适的东西并使用 winhttpcertcfg.exe 安装它

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2008-10-30T16:55:38.103

我们还使用 .net 3.5 sp1 运行 x64 windows 和 moss 2007，同样的问题。我怀疑这是罪魁祸首。

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2008-12-14T20:52:31.017

要解决此问题，请下载 IIS6 资源工具包并运行以下命令 Selfssl /s:(Office Server Web Services 站点的 IIS ID) /v:9999

干杯，

-伊万

# frame-rate - 每秒有多少游戏更新？

> ID：88093
> 
> 赞同：4
> 
> 时间：2008-09-17T21:54:23.050
> 
> 标签：frame-rate

我应该以什么更新速率运行我的固定速率游戏逻辑？

我过去每秒使用 60 次更新，但这很难，因为它不是每秒更新的偶数 (16.666666)。我目前的游戏使用 100，但对于大多数事情来说，这似乎有点过分了。

* * *

## 回答 #1

> 赞同：10
> 
> 时间：2008-09-17T22:02:24.017

以上都不是。为了尽可能流畅的游戏玩法，您的游戏应该是基于时间的，而不是帧锁定的。帧锁定适用于简单的游戏，您可以在其中调整逻辑并锁定帧速率。它不适用于现代 3D 标题，其中帧率在整个板上跳跃并且屏幕可能不是垂直同步的。

你需要做的就是弄清楚一个对象应该走多快（即每秒虚拟单位），计算自上一帧以来的时间量，缩放虚拟单位的数量以匹配已经过去的时间量，然后将这些值添加到对象的位置。瞧！基于时间的运动。

* * *

## 回答 #2

> 赞同：8
> 
> 时间：2008-09-18T00:15:27.020

我曾经维护一个 Quake3 mod，这是用户问题的持续来源。

Q3 默认使用 20 个“每秒滴答声”——图形子系统会进行插值，因此您可以在屏幕上获得流畅的运动。我最初认为这太低了，但结果很好，而且真的没有多少游戏比 q3 动作更快

我个人会选择“对约翰·卡马克来说足够好，对我来说足够好”

* * *

## 回答 #3

> 赞同：5
> 
> 时间：2008-09-17T22:09:10.643

我喜欢 50 用于固定费率的电脑游戏。我真的分不清 50 和 60 之间的区别（如果你正在制作一个可以/关心你的游戏，你可能应该是 100）。

您会注意到问题是“固定速率游戏逻辑”而不是“绘制循环”。为清楚起见，代码将类似于：

```
while(1) 
{ 
  while(CurrentTime() < lastUpdate + TICK_LENGTH) 
  { 
     UpdateGame(); 
     lastUpdate += TICK_LENGTH;
  } 

  Draw();
} 
```

问题是 TICK_LENGTH 应该是什么？

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2008-09-17T21:58:00.703

请记住，除非您的代码被测量到循环，否则不是每个游戏循环都会花费相同的毫秒数来完成 - 所以 16.6666 不合理并不是问题，因为无论如何您都需要时间和补偿。此外，它不是每秒 16.6666 次更新，而是您的游戏循环应该瞄准的平均毫秒数。

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2008-09-17T22:00:49.370

这些变量通常最好通过猜测和检查策略找到。

以与刷新无关的方式实现您的游戏逻辑（例如，将 ms/update 公开为变量，并在任何计算中使用它），然后尝试刷新直到它起作用，然后将其保留在那里。

作为一个短期的解决方案，如果你想要一个均匀的更新率但不关心每秒更新的均匀性，15ms 接近 60 次更新/秒。如果两者都适用，那么最接近的选项是 20 毫秒或 50 次更新/秒，这可能是您将获得的最接近的值。

在任何一种情况下，我都会简单地将时间视为双倍（或高分辨率的长），并将您的游戏的速率作为变量提供，而不是对它们进行硬编码。

* * *

## 回答 #6

> 赞同：1
> 
> 时间：2008-09-17T22:01:36.140

理想的情况是以与显示器相同的刷新率运行。这样，您的视觉效果和游戏更新就不会彼此同步或不同步。每个帧不会持续整数毫秒这一事实对您来说并不重要；为什么这是个问题？

* * *

## 回答 #7

> 赞同：1
> 
> 时间：2008-09-17T22:03:46.103

我通常使用 30 或 33。这通常足以让用户感受到流量，并且足够稀有而不会过多地占用 CPU。

* * *

## 回答 #8

> 赞同：1
> 
> 时间：2008-09-17T22:06:01.527

通常我不会限制游戏的 FPS，而是更改我的所有逻辑以将最后一帧经过的时间作为输入。

就固定利率而言，除非您出于任何原因需要高利率，否则您应该使用 25/30 之类的方式。这应该是足够的速率，并且将使您的游戏在 CPU 使用上更轻一些。

* * *

## 回答 #9

> 赞同：1
> 
> 时间：2011-08-21T01:35:39.177

您的引擎应该同时“滴答”（更新）并以 60fps 的速度绘制垂直同步 (vsync)。这个刷新率足以提供：

1.  低输入延迟带来响应感，
2.  即使在玩家和场景快速移动的情况下也能保持流畅的动作。

如果需要，游戏物理和渲染器都应该能够丢帧，但要优化您的游戏以尽可能接近这个 60hz 标准。此外，像 AI 这样的一些子系统可以接近 10-20fps，并确保您的物理在帧到帧的时间增量上进行插值，如下所示： http: [//gafferongames.com/game-physics/fix-your-时间步长/](http://gafferongames.com/game-physics/fix-your-timestep/)

# .net - 您如何保证为 ASPNET 用户分配正确的默认目录权限？

> ID：88094
> 
> 赞同：1
> 
> 时间：2008-09-17T21:54:24.173
> 
> 标签：.net, asp.net, visual-studio

每次设置新的开发箱时，我似乎都会犯这个错误。有没有办法确保您不必为 ASPNET 用户手动分配权限？我通常安装 .Net，然后是 IIS，然后是 Visual Studio，但似乎我仍然必须手动为 ASPNET 用户分配权限才能让一切正常运行。我的安装顺序错了吗？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2008-09-17T21:57:26.803

安装 IIS，然后安装 .NET。.NET 安装将自动向 IIS 注册所需的东西。

如果您先安装 .NET，请运行以下命令：

```
%windir%\Microsoft.NET\Framework\v2.0.50727\aspnet_regiis.exe -i 
```

运行注册部分，以及

```
%windir%\Microsoft.NET\Framework\v2.0.50727\aspnet_regiis.exe -ga userA 
```

为 userA 设置安全权限

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2008-09-17T21:58:19.313

如果您先安装 IIS，然后安装 .Net，就可以了。

在您的场景中 - 使用[Aspnet_regiis.exe -qa*用户*](http://msdn.microsoft.com/en-us/library/k6h9cz8h(VS.80).aspx)（不适用于 .Net < 2.0）

# c# - 你知道 C# 的 Bulked/Batched Flows 库吗

> ID：88096
> 
> 赞同：1
> 
> 时间：2008-09-17T21:54:36.453
> 
> 标签：c#, workflow, workflow-foundation, bulkinsert

我正在处理一个具有 peek 性能要求的项目，因此我们需要批量（批处理？）几个操作（例如将数据持久化到数据库）以提高效率。

但是，我希望我们的代码保持易于理解的流程，例如：

```
input = Read();
parsed = Parse(input);
if (parsed.Count > 10)
{
   status = Persist(parsed);
   ReportSuccess(status);
   return;
}
ReportFailure(); 
```

我在这里寻找的功能是自动让 Persist() 批量发生（并且异步进行），但对其用户的行为就好像它是同步的（用户应该阻止直到批量操作完成）。我希望实现者能够实现 Persist(ICollection)。

我研究了基于流的编程，对此我并不十分熟悉。[我在这里](http://www.jpaulmorrison.com/fbp/)看到了一个 C# 中的 fbp 库，并与 Microsoft 的 Workflow Foundation 进行了一些合作，但我的印象是两者都对我的需要来说太过分了。您将使用什么来实现批量流动行为？

请注意，我希望获得与我编写的代码完全相同的代码（易于理解和调试），因此涉及产量或配置以将流相互连接的解决方案不足以满足我的目的。此外，[链接](http://en.wikipedia.org/wiki/Chain-of-responsibility_pattern) 不是我要寻找的 - 我不想先构建一个链然后运行它，我想要看起来好像它是一个简单流程的代码（“Do A, Do B, if C then做 D")。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-04-27T18:14:17.630

常见问题 - 而不是调用 Persist，我通常将命令（或沿这些行的 smt）加载到 Persistor 类中，然后在循环完成后我调用 Persistor.Persist 来持久化批处理。

只是一些指针 - 如果您正在生成 sql，那么您添加到持久化器的命令可以以某种方式表示您的查询（使用内置对象、自定义对象或只是查询字符串）。如果您正在调用存储过程，则可以使用命令将内容附加到一段 xml，当您调用 persist 方法时，这些内容将传递给 SP。

希望它有所帮助 - 很确定这有一个模式，但不知道名字:)

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2008-09-17T22:02:36.417

我不知道这是否是您需要的，因为它是基于 sqlserver 的，但是您是否尝试过查看[SSIS](http://en.wikipedia.org/wiki/SQL_Server_Integration_Services)和/或[DTS](http://en.wikipedia.org/wiki/Data_Transformation_Services)？

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-05-17T03:02:29.607

如何使用`BackgroundWorker`该类将每个项目异步保存在单独的线程上？例如：

```
using System;
using System.Collections;
using System.Collections.Generic;
using System.ComponentModel;
using System.Threading;

class PersistenceManager
{
   public void Persist(ICollection persistable)
   {
      // initialize a list of background workers
      var backgroundWorkers = new List<BackgroundWorker>();

      // launch each persistable item in a background worker on a separate thread
      foreach (var persistableItem in persistable)
      {
         var worker = new BackgroundWorker();
         worker.DoWork += new DoWorkEventHandler(worker_DoWork);
         backgroundWorkers.Add(worker);
         worker.RunWorkerAsync(persistableItem);
      }

      // wait for all the workers to finish
      while (true)
      {
         // sleep a little bit to give the workers a chance to finish
         Thread.Sleep(100);

         // continue looping until all workers are done processing
         if (backgroundWorkers.Exists(w => w.IsBusy)) continue;

         break;
      }

      // dispose all the workers
      foreach (var w in backgroundWorkers) w.Dispose();
   }

   void worker_DoWork(object sender, DoWorkEventArgs e)
   {
      var persistableItem = e.Argument;
      // TODO: add logic here to save the persistableItem to the database
   }
} 
```

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2009-05-03T02:38:47.750

您可以做的一件简单的事情是创建一个 MemoryBuffer，您可以在其中推送消息，只需将它们添加到列表中并返回。这个 MemoryBuffer 有一个 System.Timers.Timer 定期调用并执行“实际”更新。

可以在位于[http://www.fantail.net.nz/wordpress/?p=5](http://www.fantail.net.nz/wordpress/?p=5)的 Syslog 服务器 (C#) 中找到一个这样的实现，其中 syslog 消息被批量定期记录到 SQL Server。

如果推送到数据库的信息很重要，这种方法可能不太好，如果出现问题，您将丢失 MemoryBuffer 中的消息。

# wpf - 如何使用 NAnt 编译 WPF 控件

> ID：88121
> 
> 赞同：2
> 
> 时间：2008-09-17T21:56:57.243
> 
> 标签：wpf, nant, baml

我有一个 WPF 项目，我正在尝试为它设置一个 NAnt 构建脚本。问题是，当它尝试编译 WPF 控件时，不会像从 Visual Studio 中构建时那样生成 .g.cs 文件。我正在使用 csc 构建任务。

从我的阅读看来，当 Visual Studio 构建时，它会执行一个生成 .g.cs 文件的预构建步骤。是否可以通过 NAnt 做到这一点？

我发现这篇关于 WPF、.g.cs 和 baml 的帖子：[http ://stuff.seans.com/2008/07/13/hello-wpf-world-part-2-why-xaml/](http://stuff.seans.com/2008/07/13/hello-wpf-world-part-2-why-xaml/)

有任何想法吗？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2008-09-17T21:59:03.773

您可能想尝试使用[msbuild 任务](http://nantcontrib.sourceforge.net/release/0.85-rc4/help/tasks/msbuild.html)

# visual-studio-2008 - VS2008 安装项目会更新 Net 3.5 SP1 吗？

> ID：88136
> 
> 赞同：3
> 
> 时间：2008-09-17T21:58:34.210
> 
> 标签：visual-studio-2008, setup-project, .net-3.5

我刚开始使用 Net 3.5 SP1 中包含的 WPF WebBrowser。我构建了我的安装项目（在迁移到 3.5 SP1 之前我一直在使用它）并将其安装在测试机器上，但 WebBrowser 不可用。

我必须做什么才能确保 setup.exe/msi 组合检查并安装 SP1？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2008-09-17T22:14:38.277

打开安装项目的属性，然后单击 Prerequesites 按钮。然后检查要安装的先决条件。

![执照](https://i.stack.imgur.com/arDF8.png)

然后您可以定义用户如何获取前置请求。

这是框架版本信息的链接和 Scott Hanselman 博客的摘录：

> 在线/下载体验 在 3.5 SP1 .NET Framework 上获得具有合理 Internet 连接性的用户的最佳方式是使用 2.7 Meg“引导程序”。这将检测他们需要什么并只下载他们需要的内容。如上表所示，x86 机器的最坏情况约为 60 兆。
> 
> 什么是“客户资料”？对于 XP 上的 .NET 3.5 SP1，客户端配置文件是一个更小的安装选项。它是小型的 277k 引导程序。当它在没有安装 .NET Framework 的 Windows XP SP2 机器上运行时，它将下载一个 28 兆的有效负载并为您提供一个特定于客户端的 .NET 3.5 子集。如果客户端配置文件引导程序在具有任何版本的 .NET 的计算机上运行，​​它将与 3.5 SP1 Web 安装程序相同，并检测它需要下载的内容，然后去获取它。客户端配置文件部署指南中有更多详细信息。

[http://www.hanselman.com/blog/CommentView.aspx?guid=af453d70-64b3-417e-9492-d115f929195d](http://www.hanselman.com/blog/CommentView.aspx?guid=af453d70-64b3-417e-9492-d115f929195d)

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2008-09-17T22:13:56.280

在我回答我自己的问题的路上。双击检测到的依赖项中的 Microsoft .net Framework 可以选择版本。

现在的问题是**3.5.30729**还是**3.5 SP1 Client**哪个合适？

**编辑：** 3.5.30729 有效。对两者之间的区别有什么想法吗？

**编辑：**双击上面的 .NET Framework 将 .NET Framework 显示为启动条件。这是我更改版本的地方。（我会添加一个屏幕截图，但我在 URL 上没有截图，只有在我的桌面上。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2008-09-17T22:15:19.350

在设置项目中，添加一些启动条件。此页面向您展示了具体情况：http: [//jelle.druyts.net/2005/04/09/CheckingForNET11ServicePack1InAnMSI.aspx](http://jelle.druyts.net/2005/04/09/CheckingForNET11ServicePack1InAnMSI.aspx)

# c# - 如何一次性获取所有文件属性，包括作者、标题、mp3 标签等

> ID：88181
> 
> 赞同：3
> 
> 时间：2008-09-17T22:03:43.653
> 
> 标签：c#, .net, vb.net, perl, filesystems

我想将 windows 文件夹中文件的所有元数据（包括高级摘要属性）写入 csv 文件。有没有办法收集所有属性？我看到 mp3 文件与 jpg 文件相比有一组不同的属性。（C＃）

这也可以是脚本（vb、perl）

更新：通过查看 libextractor（谢谢），我可以看到这可以通过为不同类型的文件编写不同的插件来实现。我收集这个元数据不是一个简单的集合......

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2008-09-17T22:27:03.723

在 Perl 中，您可以使用[MP3::Tag](http://search.cpan.org/author/ILYAZ/MP3-Tag/Tag.pm)或[MP3::Info](http://search.cpan.org/author/DANIEL/MP3-Info-1.23/Info.pm)

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2008-09-17T22:16:43.153

[如果您可以使用](http://www.codeproject.com/KB/vb/mp3id3v1.aspx)VB.Net：http://www.codeproject.com/KB/vb/mp3id3v1.aspx

如果您可以使用 C++/.Net： http: [//www.codeproject.com/KB/audio-video/mp3fileinfo.aspx](http://www.codeproject.com/KB/audio-video/mp3fileinfo.aspx)

对于任何一个（假设 C++）被编译为 .Net，您都可以使用 Reflector 反汇编二进制文件并将其转换为 C#。首先与各自的作者核对他们的许可证（通常代码项目文章是在像 CPOL 这样的开放许可证下）。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2008-09-17T22:08:02.690

在图书馆？如果您的软件是 GPL，请尝试[libextractor 。](http://gnunet.org/libextractor/)

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2008-09-17T22:17:50.703

好的，在澄清编辑之后，我建议查看 .Net 中可用的内省。但是，我会警告您，如果您放弃自省并为您希望看到的文件类型定义所需的特定属性，我认为您将获得更令人满意的结果。

由于脚本是有效的，那么如果这是我要解决的问题，我会使用 Powershell，因为 .net 内省已经融入其中。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2008-09-18T03:51:37.000

从 jpeg 文件（exif 数据）中添加所有数据可能不值得。我会从这些文件中手动挑选我想要的属性。

# visual-assist - 任何其他工具/插件，如 VisualAssist 会改变我的生活 (MSVS)？

> ID：88190
> 
> 赞同：3
> 
> 时间：2008-09-17T22:05:21.963
> 
> 标签：visual-assist

几年前我被介绍给 VisualAssist，对我来说没有回头路了。还有其他我错过的工具吗？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2008-09-19T14:07:37.127

如果你是 vim 用户，[ViEmu](http://www.viemu.com)是必不可少的。它是一个可用于 Visual Studio（SQL Server 和 Office，尽管单独出售）的插件，可将编辑器转换为 Vim。

同一家公司的另一个插件是[Codekana](http://www.codekana.com)。在目前的版本中，它大大修饰了代码结构，并使阅读代码更加愉快。根据与作者的几次聊天，他也计划将其扩展到其他领域。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2008-09-19T14:19:08.330

[BeyondCompare](http://www.scootersoftware.com/)：改变生活的文件夹和文件差异，具有许多可安装的扩展，用于其他文件类型。不知道没有它我会怎么做。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2008-09-19T13:57:19.957

安装 VisualAssist 后，我​​开始使用 WinMerge，这也大大简化了我的生活。

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2008-09-17T22:35:07.243

在我用于开发的每台计算机上都安装了一些东西：

*   [ExamDiff](http://www.prestosoft.com/edp_examdiffpro.asp)是我发现的最好的轻量级差异程序。
*   [Tortoise SVN](http://tortoisesvn.tigris.org/)是最好的版本控制客户端
*   [当你的公司强加给你时， Perforce](http://www.perforce.com/)是一种让你的生活变得更糟的方法。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2008-09-19T14:12:47.830

我拥有所有这些工具并定期使用它们。

*   [锐器](http://www.jetbrains.com/resharper/)
*   [CodeRush/重构专业版！](http://www.devexpress.com/Products/Visual_Studio_Add-in/Coding_Assistance/)
*   [依赖](http://www.ndepend.com/)
*   [加里奥/MbUnit](http://www.gallio.org/)

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2008-09-17T22:20:08.403

我尝试了一段时间的[Resharper 。](http://www.jetbrains.com/resharper/)它很棒，但对我的口味来说太贵了，试用期结束时我无法让我的雇主购买它。你可以看看。

# architecture - 使用 ORM 时，如何安全地跨层发送加载的实体

> ID：88192
> 
> 赞同：1
> 
> 时间：2008-09-17T22:05:47.110
> 
> 标签：architecture, orm

当系统有 N 层时，并且使用 ORM 时，如何跨层发送加载的实体？

你使用 DTO 吗？

当不使用 DTO 直接发送实体时，如何防止未初始化的延迟加载关系错误？

注意：这不是“应该使用 N 层吗？” 问题。我假设系统已经有 N 层。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2008-09-17T22:12:53.070

好吧，我不知道是否有更好的方法，但是当我们使用 Hibernate 时，我们只是关闭延迟加载，以便它加载所有内容。这样做显然要花费更多，但我不确定如何摆脱 Hibernate 将创建的延迟加载方法。

如果 Containers 有不经常使用的数据集，那么它们将不会被加载，并且由请求 UI 表单来调用它并发送它以进行更新。（我们构建了更新类来一起传递所有信息）

对于加载大量容器的 UI 表单，我们只需创建特殊类并填写我们需要的内容。它们是一种不用于持久性的只读容器。

可能有更好的方法..但我正在学习:)

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2008-09-19T22:11:44.123

我只是想找到使用 ORM 的方法。

这是一个吸引人的概念。像您一样，我不希望应用程序中的其他层知道 ORM 存在。

我目前正在查看的是使用我设计的接口和使用部分类（C#/.net 的东西，没有部分类，我想我会编写一个包装器）将接口的实现添加到生成的类型上由 ORM。

就延迟加载/延迟执行而言，这对应用程序也应该是不可见的。这是 ORM 提供的一项很好的服务，我很高兴它提供了，但我的应用程序不需要知道或关心它。因此，如果 ORM 没有向您隐藏它，那么我会再次查看一个处理此问题的包装器，以便应用程序不需要知道或关心。

# python - 为 Mercurial Hook 设置环境变量

> ID：88194
> 
> 赞同：1
> 
> 时间：2008-09-17T22:05:56.470
> 
> 标签：python, shell, mercurial, mercurial-hook

我正在尝试调用一个 shell 脚本，该脚本通过一个 mercurial 钩子在我们的服务器上设置一堆环境变量。当一个新的变更组进来时，shell 脚本会被很好地调用，但是环境变量并没有传递到对 shell 脚本的调用。

我在存储库上的 hgrc 文件如下所示：

```
[hooks]
changegroup = shell_script
changegroup.env = env 
```

我可以看到 shell 脚本的输出，然后是 env 命令的输出，但是 env 命令不包含 shell 脚本设置的新环境变量。

我已经验证了 shell 脚本在单独运行时可以正常工作，但是在 mercurial 钩子的上下文中运行时，它没有正确设置环境。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2008-09-17T22:09:08.617

Shell 脚本不能修改它们的环境。

[http://tldp.org/LDP/abs/html/gotchas.html](http://tldp.org/LDP/abs/html/gotchas.html)

> 脚本不能将变量导出回其父进程、shell 或环境。正如我们在生物学中学到的，子进程可以从父进程继承，反之则不行

```
$ cat > eg.sh 
export FOO="bar";
^D
$ bash eg.sh 
$ echo $FOO; 

$ 
```

此外，问题更大，因为您有多个 bash 调用

```
bash 1 -> hg -> bash 2 ( shell script ) 
             -> bash 3 ( env call ) 
```

这就像认为我可以在一个 php 脚本中设置一个变量，然后只需通过一个接一个地运行就可以神奇地得到另一个。

# version-control - 您如何将您的办公室转变为构建自动化？

> ID：88211
> 
> 赞同：2
> 
> 时间：2008-09-17T22:09:49.643
> 
> 标签：version-control, build-automation, visual-sourcesafe

标题应该说明一切，然后我可以在 Joel 测试中再巩固 2 个刻度。

我已经使用 makefile 和 python 脚本实现了构建自动化，并且我了解基础知识和选项。

但是，作为阅读博客的新人，我如何才能让我的团队相信它的内在功效呢？

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2008-09-17T22:15:18.960

请求宽恕，而不是许可。

让它私下工作（看起来就像你拥有的那样），然后展示它的优势。

总能吸引人们的一件事是使用 CruiseControl 的 Tray 实用程序——当人们通过系统托盘看到构建成功时，他们会喜欢它。（这是假设您在 Windows 环境中，CruiseControl 将与您现有的系统等一起工作）

注意：如果请求宽恕而不是许可会导致立即终止，您可能不想执行上述操作。您可能还想在其他地方寻找工作。你的旅费可能会改变。

* * *

## 回答 #2

> 赞同：5
> 
> 时间：2008-09-17T22:19:16.393

实现[构建灯](http://alt.pluralsight.com/wiki/default.aspx/Craig/BuildLightsCode.html)......我们用熔岩灯做了类似的事情，它是一个巨大的成功。为了获得额外的奖励分数，请给每个开发人员在他们的办公桌上亮起红灯，并在构建中断时亮起正确的灯。

* * *

## 回答 #3

> 赞同：3
> 
> 时间：2008-09-17T22:17:10.657

拿起一台旧的备用电脑，把它放在办公室的角落里。设置它以构建您的项目。编写一个小脚本：

1.  获取所有文件的最新版本。
2.  如果有文件更改，构建
3.  有故障时通知您。

当你休息时，富有同情心地把它修好。

考虑添加一个步骤来运行单元测试。

如果你能避免因为人们的错误而责骂他们，很快人们就会对你到达后构建的可靠性印象深刻。从那里建造。

诀窍是花很少的时间为您的团队创造很多价值，而不会惹恼任何人。

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2008-09-17T22:25:13.790

设置一个自动生成器。一旦你让它自动构建和运行测试，你说服其他人节省自己的时间就没有关系了:)

如果您使用 git 进行版本控制，这里有一个自动生成器，它会自动找到导致测试失败的确切签入：http: [//github.com/apenwarr/gitbuilder/](http://github.com/apenwarr/gitbuilder/)

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2008-09-19T20:58:31.023

我会拿一个备用的盒子，安装一个持续集成服务器（ Java 世界中的[Hudson](http://hudson-ci.org)或[CruiseControl](http://cruisecontrol.sourceforge.net)），并设置一个工作，每次有人签入一些代码时构建你的应用程序。

您可以尝试说服您的同事，也可以等到有人破坏构建。在后一种情况下，只需发送以下电子邮件：

```
to: all developers

Guys,

I've just noticed that I can build our software using the 
latest version because of the following error:

    ...

I you want to be notified by our continuous 
build system (attached is the mail I received when
it failed to build our application), just let me know. 
```

通常不需要那么长时间，直到每个人都在名单上

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2008-09-17T22:20:06.173

我会将自动构建设置为每晚的过程，这样它每天晚上都会抓取最新的代码修订版，构建它并生成报告。现在，您每天早上都会知道构建是否损坏，如果是，您可以通知团队。如果损坏的构建对您的项目来说是一个很大的问题，那么人们可能会首先开始找您了解同步到最新代码是否安全，因为您将是任何一天都倾向于知道是否或不是构建被破坏（顺便说一句，一套自动化的单元测试也有助于解决这个问题）。运气好的话，人们会开始意识到你的每晚构建是一件有用的事情，你可以将你的每日构建报告设置为一封发送出去的电子邮件。

* * *

## 回答 #7

> 赞同：0
> 
> 时间：2008-09-17T22:28:10.973

James Shora 有两个很好的链接：

对于硬件 [http://jamesshore.com/Blog/Continuous-Integration-on-a-Dollar-a-Day.html](http://jamesshore.com/Blog/Continuous-Integration-on-a-Dollar-a-Day.html)

对于“人类软件” [http://jamesshore.com/Change-Diary/](http://jamesshore.com/Change-Diary/)

（他如何做到这一点的历史。阅读很长，但改变组织更难）

* * *

## 回答 #8

> 赞同：0
> 
> 时间：2008-09-18T14:57:31.017

当团队定期需要构建时，这很容易。您指定一名团队成员（定期轮换）进行构建。如果构建过程足够复杂，团队将自行提出一种至少部分自动化构建的方法。在最坏的情况下，您必须自己自动化构建，但没有人会反对自动化。

* * *

## 回答 #9

> 赞同：0
> 
> 时间：2008-09-19T21:06:17.430

示范是最好的，也是唯一能改变任何拒绝以不同方式做事的人的想法的方法。

在这里，我们展示了自动化构建是多么有用，因为 QA 能够直接从构建服务器获取绿灯构建，并在没有开发人员任何指示的情况下安装和测试。他们能够继续工作，他们知道它至少通过了它的单元测试。它有助于集成测试和开发，减少系统中出现错误的时间。

# java - 查找 Java 类文件版本之间的差异

> ID：88216
> 
> 赞同：8
> 
> 时间：2008-09-17T22:11:03.807
> 
> 标签：java, decompiling

我正在使用来自商业供应商的大型 Java Web 应用程序。我从供应商那里收到了一个新的 .class 文件形式的补丁，它应该可以解决我们在使用该软件时遇到的问题。过去，应用来自该供应商的补丁会导致出现新的且完全不相关的问题，因此我想在将其应用到测试实例之前了解所做的更改。

我有两个并排的 .class 文件，一个是从当前运行的版本中提取的，一个是来自供应商的更新的。 [JAD](http://www.kpdus.com/jad.html)和[JReversePro](http://jreversepro.blogspot.com/)都反编译和反汇编（分别）这两个版本到相同的输出。但是，.class 文件的大小不同，我看到 .class 的输出存在差异`od -x`，因此它们绝对不相同。

我还可以采取哪些其他步骤来确定这两个文件之间的差异？

* * *

结论：

感谢您的好评。由于`javap -c`这两个类文件的输出也相同，因此我将得出结论认为 Davr 是正确的，并且供应商给了我一个安慰剂。虽然出于这个原因我接受了 Davr 的回答，但正是 Chris Marshall 和 John Meagher 让我开始使用 javap，所以感谢你们三个。

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2008-09-17T22:13:10.277

有可能他们只是用新版本的java编译器编译，或者使用不同的优化设置等，所以功能相同，代码相同，但输出字节码略有不同。

* * *

## 回答 #2

> 赞同：6
> 
> 时间：2008-09-17T22:21:27.510

如果您正在寻找 API 级别的差异，那么[javap](http://java.sun.com/j2se/1.4.2/docs/tooldocs/windows/javap.html)工具会很有帮助。它将输出方法签名，这些签名可以输出到纯文本文件并使用普通的差异工具进行比较。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2008-09-17T22:16:42.700

您可以尝试在反编译的源代码上使用 diff 工具（例如 SourceGear 的免费 DiffMerge 工具）。这应该会发现文件差异，尽管它可能会发现“无关紧要”的差异，例如，如果变量在两个版本中的命名不同。

[http://www.sourcegear.com/diffmerge/](http://www.sourcegear.com/diffmerge/)

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2008-09-17T22:20:13.300

您可以使用 javap（在 $JDK_HOME/bin 中）来反编译 java .class 文件。它会告诉你（例如）类文件版本等等

# sql - 存储过程 - 将消息传递回用户应用程序的最佳方式

> ID：88222
> 
> 赞同：6
> 
> 时间：2008-09-17T22:12:27.470
> 
> 标签：sql, sql-server, tsql, raiserror

我想知道人们对在存储过程中使用 RAISERROR 将用户消息（即与业务相关的消息，而不是错误消息）传回应用程序的想法。

我公司的一些高级开发人员一直在使用这种方法，并在我们的 C# 代码中捕获 SqlException 来获取消息并将它们显示给用户。我对这种方法不满意，想知道其他人如何处理来自存储过程的这些类型的用户消息。

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2008-09-17T22:24:15.383

我已经这样做了，但它通常是为了传递业务“错误”消息，本质上是一个数据配置必须到位，无论出于何种原因，标准 FK 约束都无法强制执行。

如果它们实际上是“错误”，我对此没有太大问题。如果它正在插入一条记录并使用 RAISERROR 抛出（“您已成功注册 XYZ！”），那么您就有问题了。如果是这样的话，我可能会想出一个使用 out 参数的团队/部门/公司开发标准。

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2008-09-17T22:39:13.770

像这样使用 RAISERROR 真的不是一个好主意。这就像使用异常作为流控制逻辑一样，这通常是不受欢迎的。

为什么不使用 OUT 参数呢？这正是他们的目的。我想不出不支持 OUT 参数的数据库或客户端 API。

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2008-09-18T00:12:44.873

使您的存储过程返回 2 组数据。第一个可以包含实际返回的数据，然后第二个可以返回文本消息。然后，您的应用程序代码可以在需要的地方使用数据，然后显示返回的任何消息。

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2009-06-16T07:15:47.207

回答这么老的问题是不是很糟糕？随便...

对于您的日常状态消息，这将是一件坏事，我几乎同意上面的每个答案。然而，我已经看到这非常有效地用于显示长批次的进度。有关示例，请参阅Jens K[从批处理和存储过程中获取反馈/进度。](http://blogs.msdn.com/jenss/archive/2009/05/11/getting-feedback-progress-from-batches-and-stored-procedures.aspx)你必须有一个非常核心的理由去做它，但是当你需要它时，你**需要**它并且它很棒。

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2009-06-16T07:24:23.353

仅当情况异常并且您没有处理逻辑时才应抛出异常。引发和捕获异常也很昂贵。

避免使用异常，除非

1.  情况异常
2.  您没有处理异常情况的逻辑

使用输出参数或返回多个结果集来传递来自存储过程的信息。

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2008-09-17T22:20:50.150

我会尽量避免让我的存储过程返回业务相关消息，因为根据定义，这些消息可能应该在业务逻辑层中处理/生成。

例外应该是例外的（不经常）。我只会将 RAISEERROR 用于错误（例如，嘿，我试图导入所有这些数据，其中一行有愚蠢的数据，所以我回滚了事务）。您还需要非常小心所引发错误的严重性，这可能会对错误的传播方式以及连接发生的情况产生巨大影响。

如果这还不够，请尝试使用返回值或输出变量。

* * *

## 回答 #7

> 赞同：0
> 
> 时间：2008-09-17T22:22:44.810

我想如果您不介意检查列，那么您可以根据发生的情况返回不同的内容。

如果一切正常，则正常返回数据。如果有问题，请返回一个结果，其中包含一个名为 Error 的列，该列描述了什么是错误的。在处理数据之前检查该列的列名并采取相应措施。

如果你真的反对 RAISERROR，那我就别想了。

* * *

## 回答 #8

> 赞同：0
> 
> 时间：2008-09-17T22:26:45.657

我使用 raiseerror 从多个嵌套存储过程的深处返回，但是存储过程的最后一层总是在被引发到调用语言（在我们的例子中是通过 JDBC 的 Java）之前捕获异常。最外层的存储过程 catch 被转换为要传输到 JDBC 调用的 XML 消息，按照我们的约定，根元素必须包含一个反馈属性。反馈属性的值始终具有 ok、alert 或 error 的装饰器。好的意思是继续，这里没什么可看的。警报意味着继续，但向用户显示其余的反馈。错误意味着平底船，请致电服务台。

* * *

## 回答 #9

> 赞同：0
> 
> 时间：2008-09-18T09:29:58.933

我会使用存储过程中的 RETURN 值，如下所示：

```
CREATE PROCEDURE checkReturnValue
AS
BEGIN
    DECLARE @err AS INT
    SET @err = 0

    IF (rand() < 0.5)
    BEGIN
        SET @err = 1
    END

    SELECT * FROM table

    PRINT @err

    RETURN @err
END 
```

检查调用存储过程的应用程序中的 RETURN 值。

* * *

## 回答 #10

> 赞同：0
> 
> 时间：2008-09-22T22:38:08.510

仅当“业务”错误消息是数据库错误消息时，为了满足数据库级别的基本低级业务需求而设置的数据库约束正在被违反。

它不应该用于高级业务逻辑，在数据库层应该避免使用它。数据库层总是最慢的变化，所以只有非常缓慢变化和不变的业务逻辑应该在那里。

因此，对于非活动/禁用客户的订单消息可能是肯定的，但对于在 90 天内有余额的客户的订单则不是。第一条规则可能是永久性的，第二条规则可能是可配置的，取决于企业每月的突发奇想。

* * *

## 回答 #11

> 赞同：0
> 
> 时间：2008-09-22T22:43:17.143

我们在发生错误时引发错误，并在输出变量或返回值中返回状态信息。

* * *

## 回答 #12

> 赞同：0
> 
> 时间：2008-10-08T21:56:33.130

您应该使用 SQL 存储过程输出参数。

来自[http://msdn.microsoft.com/en-us/library/ms378108.aspx](http://msdn.microsoft.com/en-us/library/ms378108.aspx)：

```
CREATE PROCEDURE GetImmediateManager
   @employeeID INT,
   @msg varchar(50) OUTPUT
AS
BEGIN
   SELECT ManagerID 
   FROM HumanResources.Employee 
   WHERE EmployeeID = @employeeID

   SELECT @msg = 'here is my message'
END 
```

* * *

## 回答 #13

> 赞同：-1
> 
> 时间：2008-09-17T22:17:47.473

如果不能更早地检查/捕获它，则可能很难做其他任何事情。

我不得不在我编写并用作插入/更新表的约束的过程中编写 raiseerror，因为它是数据的“最后一站”，我必须在那里检查它。

我认为一般来说，如果你从数据库中得到错误。它很痛苦，而且很难不费力气地向用户提供“好的”反馈，但有时你只是不知道，直到你插入/更新：P

* * *

## 回答 #14

> 赞同：-2
> 
> 时间：2008-09-17T22:21:50.787

我亵渎神明的 2 美分：

基于文本的消息在 Web 上运行得非常好，例如 HTTP。创建、发送、调试系统很容易，其中消息以人类可读的文本完成。

所以，你的 SQL Server 层和它上面的层之间的消息传递可能是同样的事情。使用文本作为消息传递的一部分可能会使您的开发更加敏捷，调试更加容易。也许高级开发人员是务实的，您也许应该对先入为主的正确性概念持开放态度。

辩论设计选择本身的优点，而不是基于正确性的概念。（软件开发也有时尚）

# c# - 页面索引不起作用

> ID：88231
> 
> 赞同：0
> 
> 时间：2008-09-17T22:13:03.740
> 
> 标签：c#

帮帮我..我的页面索引在 Visual Studio 中不起作用。我的页面加载如下：

```
protected void Page_Load(object sender, EventArgs e)
        {
            if (!Page.IsPostBack)
            {
                CustomerView.DataSource = Customer.GetAll();
                CustomerView.DataBind();
            }
        }

protected void CustomerView_PageIndexChanging(object sender, System.Web.UI.WebControls.GridViewPageEventArgs e)
        {
            int newPageNumber = e.NewPageIndex + 1;
            CustomerView.DataSource = Customer.GetAll();
            CustomerView.DataBind();
        } 
```

我做错了什么我的页面索引无法正常工作。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2008-09-17T22:30:00.377

试试这个。我认为您必须手动设置 GridView 的 PageIndex 属性。

```
protected void CustomerView_PageIndexChanging(object sender, System.Web.UI.WebControls.GridViewPageEventArgs e)
{
    CustomerView.PageIndex = e.NewPageIndex;
    CustomerView.DataSource = Customer.GetAll();
    CustomerView.DataBind();
} 
```

# exception - 处理“java.lang.OutOfMemoryError: PermGen space”错误

> ID：88235
> 
> 赞同：1236
> 
> 时间：2008-09-17T22:13:48.277
> 
> 标签：exception, memory-leaks, out-of-memory, java-6, permgen

最近我在我的 Web 应用程序中遇到了这个错误：

> java.lang.OutOfMemoryError: PermGen 空间

它是运行在 Tomcat 6 和 JDK 1.6 上的典型 Hibernate/JPA + IceFaces/JSF 应用程序。显然，这可能会在重新部署应用程序几次后发生。

是什么原因造成的，可以做些什么来避免它？我该如何解决这个问题？

* * *

## 回答 #1

> 赞同：570
> 
> 时间：2008-09-17T22:17:16.973

解决方案是在启动 Tomcat 时将这些标志添加到 JVM 命令行：

```
-XX:+CMSClassUnloadingEnabled -XX:+CMSPermGenSweepingEnabled 
```

您可以通过关闭 tomcat 服务，然后进入 Tomcat/bin 目录并运行 tomcat6w.exe 来做到这一点。在“Java”选项卡下，将参数添加到“Java 选项”框。单击“确定”，然后重新启动服务。

如果您收到错误*，则指定的服务不作为已安装的服务存在，*您应该运行：

```
tomcat6w //ES//servicename 
```

其中***servicename***是在 services.msc 中查看的服务器名称

资料来源：orx 对[Eric 的敏捷答案](https://web.archive.org/web/20160124133922/http://www.jroller.com/agileanswers/entry/preventing_java_s_java_lang)的评论。

* * *

## 回答 #2

> 赞同：251
> 
> 时间：2009-05-07T15:15:28.253

你最好尝试**`-XX:MaxPermSize=128M`**而不是`-XX:MaxPermGen=128M`。

我无法说出这个内存池的确切用途，但它与加载到 JVM 中的类的数量有关。（因此为 tomcat 启用类卸载可以解决问题。）如果您的应用程序在运行时生成和编译类，则更有可能需要比默认值更大的内存池。

* * *

## 回答 #3

> 赞同：153
> 
> 时间：2008-12-05T11:43:23.000

多次部署后发生的应用服务器 PermGen 错误很可能是由容器对旧应用的类加载器的引用引起的。例如，使用自定义日志级别类将导致应用服务器的类加载器持有引用。您可以使用现代 (JDK6+) JVM 分析工具（例如 jmap 和 jhat）来检测这些类加载器间泄漏，以查看哪些类继续保存在您的应用程序中，并重新设计或消除它们的使用。通常的嫌疑人是数据库、记录器和其他基本框架级别的库。

请参阅[Classloader 泄漏：可怕的“java.lang.OutOfMemoryError: PermGen space”异常](http://frankkieviet.blogspot.ca/2006/10/classloader-leaks-dreaded-permgen-space.html)，尤其是其[后续帖子](http://frankkieviet.blogspot.ca/2006/10/how-to-fix-dreaded-permgen-space.html)。

* * *

## 回答 #4

> 赞同：69
> 
> 时间：2012-01-04T02:26:08.003

人们常犯的错误是认为堆空间和永久空间是相同的，这根本不是真的。您可能在堆中剩余大量空间，但在 permgen 中仍然可能耗尽内存。

PermGen 中 OutofMemory 的常见原因是 ClassLoader。每当一个类被加载到 JVM 中时，它的所有元数据以及 Classloader 都保存在 PermGen 区域中，当加载它们的 Classloader 准备好进行垃圾收集时，它们将被垃圾收集。如果 Classloader 存在内存泄漏，那么它加载的所有类都将保留在内存中，并在您重复几次后导致 permGen 内存不足。经典的例子是[Java.lang.OutOfMemoryError:PermGen Space in Tomcat](http://javarevisited.blogspot.com/2012/01/tomcat-javalangoutofmemoryerror-permgen.html)。

现在有两种方法可以解决这个问题：
1.查找内存泄漏的原因或者是否有内存泄漏。2\. 使用 JVM 参数和.
增加 PermGen Space 的大小。`-XX:MaxPermSize``-XX:PermSize`

您还可以查看Java[中 Java.lang.OutOfMemoryError](http://javarevisited.blogspot.com/2011/09/javalangoutofmemoryerror-permgen-space.html)的 2 解决方案以获取更多详细信息。

* * *

## 回答 #5

> 赞同：43
> 
> 时间：2008-09-18T03:29:11.950

使用 Sun JVM 的命令行参数`-XX:MaxPermSize=128m`（显然将 128 替换为您需要的任何大小）。

* * *

## 回答 #6

> 赞同：39
> 
> 时间：2009-03-11T22:19:22.253

尝试`-XX:MaxPermSize=256m`，如果它仍然存在，请尝试`-XX:MaxPermSize=512m`

* * *

## 回答 #7

> 赞同：29
> 
> 时间：2013-03-03T10:05:44.410

我在使用 eclipse ide时向**VM Arguments**[添加了](https://stackoverflow.com/a/835269/432903) `-XX: MaxPermSize = 128m`（您可以试验哪个效果最好） 。在大多数 JVM 中，[默认 PermSize](http://javarevisited.blogspot.com/2011/09/javalangoutofmemoryerror-permgen-space.html)约为**64MB**，如果项目中有太多类或大量字符串，则会耗尽内存。

 ****对于 Eclipse，它也在[answer](https://stackoverflow.com/a/4350922/432903)中进行了描述。

**第 1 步**：双击**服务器**选项卡中的 tomcat 服务器

![在此处输入图像描述](https://i.stack.imgur.com/l6N8V.png)

**第 2**步：**打开启动 Conf**并添加`-XX: MaxPermSize = 128m`到现有**VM 争论的末尾**。

![在此处输入图像描述](https://i.stack.imgur.com/wiImH.png)

* * *

## 回答 #8

> 赞同：23
> 
> 时间：2011-06-09T09:39:03.733

在部署和取消部署复杂的 Web 应用程序时，我也一直在努力解决这个问题，并认为我会添加一个解释和我的解决方案。

当我在 Apache Tomcat 上部署应用程序时，会为该应用程序创建一个新的 ClassLoader。然后使用 ClassLoader 加载应用程序的所有类，并且在取消部署时，一切都应该很好地消失。然而，实际上它并不那么简单。

在 Web 应用程序的生命周期中创建的一个或多个类包含一个静态引用，该引用沿线某处引用 ClassLoader。由于引用最初是静态的，所以再多的垃圾收集都不会清理这个引用——ClassLoader 以及它加载的所有类都将保留下来。

在几次重新部署之后，我们遇到了 OutOfMemoryError。

现在这已成为一个相当严重的问题。我可以确保在每次重新部署后重新启动 Tomcat，但这会关闭整个服务器，而不仅仅是重新部署的应用程序，这通常是不可行的。

因此，我在代码中组合了一个解决方案，该解决方案适用于 Apache Tomcat 6.0。我没有在任何其他应用程序服务器上进行过测试，并且必须强调，**如果不修改任何其他应用程序服务器，这很可能无法正常工作**。

我还想说，我个人讨厌这段代码，**如果可以将现有代码更改为使用正确的关闭和清理方法，那么没有人应该将其用作“快速修复”**。唯一应该使用的情况是，如果您的代码依赖于一个外部库（在我的情况下，它是一个 RADIUS 客户端），它不提供清理其自己的静态引用的方法。

无论如何，继续使用代码。这应该在应用程序取消部署时调用 - 例如 servlet 的 destroy 方法或（更好的方法）ServletContextListener 的 contextDestroyed 方法。

```
//Get a list of all classes loaded by the current webapp classloader
WebappClassLoader classLoader = (WebappClassLoader) getClass().getClassLoader();
Field classLoaderClassesField = null;
Class clazz = WebappClassLoader.class;
while (classLoaderClassesField == null && clazz != null) {
    try {
        classLoaderClassesField = clazz.getDeclaredField("classes");
    } catch (Exception exception) {
        //do nothing
    }
    clazz = clazz.getSuperclass();
}
classLoaderClassesField.setAccessible(true);

List classes = new ArrayList((Vector)classLoaderClassesField.get(classLoader));

for (Object o : classes) {
    Class c = (Class)o;
    //Make sure you identify only the packages that are holding references to the classloader.
    //Allowing this code to clear all static references will result in all sorts
    //of horrible things (like java segfaulting).
    if (c.getName().startsWith("com.whatever")) {
        //Kill any static references within all these classes.
        for (Field f : c.getDeclaredFields()) {
            if (Modifier.isStatic(f.getModifiers())
                    && !Modifier.isFinal(f.getModifiers())
                    && !f.getType().isPrimitive()) {
                try {
                    f.setAccessible(true);
                    f.set(null, null);
                } catch (Exception exception) {
                    //Log the exception
                }
            }
        }
    }
}

classes.clear(); 
```

* * *

## 回答 #9

> 赞同：20
> 
> 时间：2016-03-22T07:15:00.880

`java.lang.OutOfMemoryError: PermGen`空间消息表明永久代在内存中的区域已用完。

任何 Java 应用程序都可以使用有限的内存量。您的特定应用程序可以使用的确切内存量是在应用程序启动期间指定的。

**Java 内存被分成不同的区域，如下图所示：**

[![在此处输入图像描述](https://i.stack.imgur.com/AkDxx.png)](https://i.stack.imgur.com/AkDxx.png)

**元空间：一个新的内存空间诞生了**

JDK 8 HotSpot JVM 现在使用本机内存来表示类元数据，称为 Metaspace；类似于 Oracle JRockit 和 IBM JVM。

**好消息是，这意味着不再有`java.lang.OutOfMemoryError: PermGen`空间问题，并且您不再需要使用[Java_8_Download](http://www.oracle.com/technetwork/java/javase/downloads/jdk8-downloads-2133151.html)或更高版本来调整和监视此内存空间。**

* * *

## 回答 #10

> 赞同：17
> 
> 时间：2008-09-17T22:23:45.773

或者，您可以切换到 JRockit，它处理 permgen 的方式与 sun 的 jvm 不同。它通常也具有更好的性能。

[http://www.oracle.com/technetwork/middleware/jrockit/overview/index.html](http://www.oracle.com/technetwork/middleware/jrockit/overview/index.html)

* * *

## 回答 #11

> 赞同：17
> 
> 时间：2014-09-03T14:46:44.263

## 1) 增加 PermGen 内存大小

可以做的第一件事是使永久代堆空间的大小更大。这不能使用通常的 –Xms（设置初始堆大小）和 –Xmx（设置最大堆大小）JVM 参数来完成，因为如上所述，永久代堆空间与常规 Java 堆空间完全分开，并且这些参数设置这个常规 Java 堆空间的空间。但是，可以使用类似的参数（至少对于 Sun/OpenJDK jvms）来使永久代堆的大小更大：

```
 -XX:MaxPermSize=128m 
```

默认为 64m。

## 2) 启用扫描

另一种解决这个问题的方法是允许卸载类，这样你的 PermGen 就永远不会用完：

```
-XX:+CMSClassUnloadingEnabled -XX:+CMSPermGenSweepingEnabled 
```

过去，类似的东西对我来说很神奇。不过有一件事，在使用这些方面有一个显着的性能折衷，因为 permgen 扫描会为您提出的每个请求或类似的东西发出额外的 2 个请求。您需要在使用与权衡之间取得平衡。

您可以找到此错误的详细信息。

[http://faisalbhagat.blogspot.com/2014/09/java-outofmemoryerror-permgen.html](http://faisalbhagat.blogspot.com/2014/09/java-outofmemoryerror-permgen.html)

* * *

## 回答 #12

> 赞同：14
> 
> 时间：2010-12-03T23:40:58.193

我遇到了我们在这里谈论的问题，我的场景是 eclipse-helios + tomcat + jsf，而您正在做的是将一个简单的应用程序部署到 tomcat。我在这里展示了同样的问题，解决如下。

在 eclipse 中转到**服务器**选项卡中，双击我的案例 tomcat 7.0 中的注册服务器，它会打开我的文件服务器一般注册信息。在**“常规信息”**部分单击**“打开启动配置”**链接，这将在最后添加这两个条目的 VM 参数中的“参数”选项卡中打开服务器选项的执行

```
-XX: MaxPermSize = 512m
-XX: PermSize = 512m 
```

并准备好。

* * *

## 回答 #13

> 赞同：14
> 
> 时间：2014-08-04T13:01:13.207

现在最简单的答案是使用 Java 8。

它不再专门为 PermGen 空间保留内存，允许 PermGen 内存与常规内存池混合。

`-XXPermGen...=...`请记住，如果您不希望 Java 8 抱怨它们不执行任何操作，则必须删除所有非标准JVM 启动参数。

* * *

## 回答 #14

> 赞同：8
> 
> 时间：2013-03-20T10:08:37.177

1.  从 Tomcat 的 bin 目录中打开 tomcat7w 或在开始菜单中键入 Monitor Tomcat（打开一个带有各种服务信息的选项卡式窗口）。
2.  在 Java 选项文本区域中添加以下行：

    ```
    -XX:MaxPermSize=128m 
    ```

3.  将初始内存池设置为 1024（可选）。
4.  将最大内存池设置为 1024（可选）。
5.  单击确定。
6.  重新启动 Tomcat 服务。

* * *

## 回答 #15

> 赞同：7
> 
> 时间：2014-09-15T05:51:56.853

由于使用了大空间而不是 jvm 提供的空间来执行代码，因此发生 Perm gen space 错误。

在 UNIX 操作系统中，这个问题的最佳解决方案是更改 bash 文件的一些配置。以下步骤可解决问题。

`gedit .bashrc`在终端上运行命令。

创建`JAVA_OTPS`具有以下值的变量：

```
export JAVA_OPTS="-XX:PermSize=256m -XX:MaxPermSize=512m" 
```

保存 bash 文件。在终端上运行命令 exec bash。重新启动服务器。

我希望这种方法可以解决您的问题。如果您使用低于 8 的 Java 版本，有时会出现此问题。但是，如果您使用 Java 8，则永远不会出现问题。

* * *

## 回答 #16

> 赞同：5
> 
> 时间：2011-06-06T09:20:45.637

此外，如果您在 webapp 中使用 log4j，请查看 log4j[文档](http://logging.apache.org/log4j/1.2/faq.html#a3.6)中的此段落。

似乎如果您正在使用`PropertyConfigurator.configureAndWatch("log4j.properties")`，当您取消部署您的 webapp 时会导致内存泄漏。

* * *

## 回答 #17

> 赞同：5
> 
> 时间：2012-07-12T12:48:00.643

如果您有真正的内存泄漏，增加永久代大小或调整 GC 参数将无济于事。如果您的应用程序或它使用的某个 3rd 方库泄漏类加载器，唯一真正且永久的解决方案是找到此泄漏并修复它。有许多工具可以帮助您，最近的一个是[Plumbr](http://plumbr.eu)，它刚刚发布了具有所需功能的新版本。

* * *

## 回答 #18

> 赞同：4
> 
> 时间：2008-09-18T02:09:46.433

[jrockit](/questions/tagged/jrockit "显示标记为“jrockit”的问题")也为我解决了这个问题；然而，我注意到 servlet 的重启时间要差得多，所以虽然它在生产中更好，但它在开发中有点拖累。

* * *

## 回答 #19

> 赞同：4
> 
> 时间：2009-07-01T04:54:18.507

我有 Hibernate+Eclipse RCP 的组合，尝试使用`-XX:MaxPermSize=512m`and `-XX:PermSize=512m`，它似乎对我有用。

* * *

## 回答 #20

> 赞同：4
> 
> 时间：2010-04-28T04:51:04.503

设置`-XX:PermSize=64m -XX:MaxPermSize=128m`。以后你也可以尝试增加`MaxPermSize`。希望它会工作。我也一样。仅设置`MaxPermSize`对我不起作用。

* * *

## 回答 #21

> 赞同：4
> 
> 时间：2011-12-08T14:51:19.740

我尝试了几个答案，最终唯一完成的工作是 pom 中编译器插件的配置：

```
<plugin>
    <groupId>org.apache.maven.plugins</groupId>
    <artifactId>maven-compiler-plugin</artifactId>
    <version>2.3.2</version>
    <configuration>
        <fork>true</fork>
        <meminitial>128m</meminitial>
        <maxmem>512m</maxmem>
        <source>1.6</source>
        <target>1.6</target>
        <!-- prevent PermGen space out of memory exception -->
        <!-- <argLine>-Xmx512m -XX:MaxPermSize=512m</argLine> -->
    </configuration>
</plugin> 
```

希望这个有帮助。

* * *

## 回答 #22

> 赞同：3
> 
> 时间：2009-03-11T22:24:55.407

内存的配置取决于您的应用程序的性质。

你在做什么？

处理的交易量是多少？

您要加载多少数据？

等等

等等

ETC

也许您可以分析您的应用程序并开始从您的应用程序中清理一些模块。

> *显然，这可能在重新部署应用程序几次后发生*

Tomcat 有热部署，但它消耗内存。尝试不时重启你的容器。您还需要知道在生产模式下运行所需的内存量，这似乎是进行该研究的好时机。

* * *

## 回答 #23

> 赞同：3
> 
> 时间：2010-09-19T12:31:54.587

他们说 Tomcat 的最新版本（6.0.28 或 6.0.29）可以更好地处理重新部署 servlet 的**任务**。

* * *

## 回答 #24

> 赞同：3
> 
> 时间：2011-03-19T11:38:19.997

我遇到了完全相同的问题，但不幸的是，没有一个建议的解决方案真正适合我。该问题在部署期间没有发生，我也没有进行任何热部署。

在我的情况下，在我的网络应用程序执行期间，每次都在同一时间发生问题，同时连接（通过休眠）到数据库。

[这个链接](http://jroller.com/agileanswers/entry/preventing_java_s_java_lang)（前面也提到过）确实提供了足够的内部来解决问题。将 jdbc-(mysql)-driver 从 WEB-INF 移到 jre/lib/ext/ 文件夹中似乎已经解决了这个问题。这不是理想的解决方案，因为升级到较新的 JRE 需要您重新安装驱动程序。可能导致类似问题的另一个候选者是 log4j，因此您可能也想移动它

* * *

## 回答 #25

> 赞同：3
> 
> 时间：2016-01-05T01:04:17.280

在这种情况下，第一步是检查 GC 是否允许从 PermGen 中卸载类。标准 JVM 在这方面相当保守——类生来就是为了永远存在。所以一旦加载，即使没有代码再使用它们，类也会留在内存中。当应用程序动态创建大量类并且生成的类在较长时间内不需要时，这可能会成为一个问题。在这种情况下，允许 JVM 卸载类定义会很有帮助。这可以通过在启动脚本中添加一个配置参数来实现：

```
-XX:+CMSClassUnloadingEnabled 
```

默认情况下，它设置为 false，因此要启用它，您需要在 Java 选项中显式设置以下选项。如果启用 CMSClassUnloadingEnabled，GC 也会清除 PermGen 并删除不再使用的类。请记住，此选项仅在使用以下选项启用 UseConcMarkSweepGC 时才有效。因此，当运行 ParallelGC 或者，上帝禁止，串行 GC 时，请确保您已通过指定以下方式将 GC 设置为 CMS：

```
-XX:+UseConcMarkSweepGC 
```

* * *

## 回答 #26

> 赞同：3
> 
> 时间：2016-04-25T17:13:23.303

为 Tomcat 分配更多内存不是正确的解决方案。

正确的解决方案是在上下文被销毁并重新创建（热部署）后进行清理。解决方案是阻止内存泄漏。

如果您的 Tomcat/Webapp 服务器告诉您取消注册驱动程序 (JDBC) 失败，请取消注册它们。这将阻止内存泄漏。

您可以创建一个 ServletContextListener 并在 web.xml 中对其进行配置。这是一个示例 ServletContextListener：

```
import java.sql.Driver;
import java.sql.DriverManager;
import java.sql.SQLException;
import java.util.Enumeration;

import javax.servlet.ServletContextEvent;
import javax.servlet.ServletContextListener;

import org.apache.log4j.Logger;

import com.mysql.jdbc.AbandonedConnectionCleanupThread;

/**
 * 
 * @author alejandro.tkachuk / calculistik.com
 *
 */
public class AppContextListener implements ServletContextListener {

    private static final Logger logger = Logger.getLogger(AppContextListener.class);

    @Override
    public void contextInitialized(ServletContextEvent arg0) {
        logger.info("AppContextListener started");
    }

    @Override
    public void contextDestroyed(ServletContextEvent arg0) {
        logger.info("AppContextListener destroyed");

        // manually unregister the JDBC drivers
        Enumeration<Driver> drivers = DriverManager.getDrivers();
        while (drivers.hasMoreElements()) {
            Driver driver = drivers.nextElement();
            try {
                DriverManager.deregisterDriver(driver);
                logger.info(String.format("Unregistering jdbc driver: %s", driver));
            } catch (SQLException e) {
                logger.info(String.format("Error unregistering driver %s", driver), e);
            }

        }

        // manually shutdown clean up threads
        try {
            AbandonedConnectionCleanupThread.shutdown();
            logger.info("Shutting down AbandonedConnectionCleanupThread");
        } catch (InterruptedException e) {
            logger.warn("SEVERE problem shutting down AbandonedConnectionCleanupThread: ", e);
            e.printStackTrace();
        }        
    }
} 
```

在这里你在你的 web.xml 中配置它：

```
<listener>
    <listener-class>
        com.calculistik.mediweb.context.AppContextListener 
    </listener-class>
</listener> 
```

* * *

## 回答 #27

> 赞同：2
> 
> 时间：2010-09-20T17:40:48.570

“他们”是错误的，因为我正在运行 6.0.29 并且即使在设置了所有选项之后也有同样的问题。正如蒂姆豪兰上面所说，这些选择只会推迟不可避免的事情。它们允许我在遇到错误之前重新部署 3 次，而不是每次重新部署。

* * *

## 回答 #28

> 赞同：2
> 
> 时间：2010-11-18T12:48:24.007

如果您在 Eclipse IDE 中遇到此问题，即使在设置了参数 `--launcher.XXMaxPermSize`、`-XX:MaxPermSize`等之后，如果您仍然遇到相同的错误，则很可能是 Eclipse 使用了错误版本的 JRE，该版本可能已由某些人安装第三方应用程序并设置为默认值。这些有缺陷的版本不获取 PermSize 参数，因此无论您设置什么，您仍然会不断收到这些内存错误。因此，在您的 eclipse.ini 中添加以下参数：

```
-vm <path to the right JRE directory>/<name of javaw executable> 
```

还要确保在 Eclipse 的首选项中将默认 JRE 设置为正确的 java 版本。

* * *

## 回答 #29

> 赞同：2
> 
> 时间：2010-11-29T19:36:41.637

对我有用的唯一方法是使用 JRockit JVM。我有 MyEclipse 8.6。

JVM 的堆存储由运行的 Java 程序生成的所有对象。Java 使用`new`运算符创建对象，新对象的内存在运行时在堆上分配。垃圾收集是自动释放程序不再引用的对象所包含的内存的机制。

* * *

## 回答 #30

> 赞同：2
> 
> 时间：2015-09-04T09:33:38.783

我有类似的问题。我的是基于 JDK 7 + Maven 3.0.2 + Struts 2.0 + Google GUICE 依赖注入的项目。

每当我尝试运行**`mvn clean package`**命令时，它都会显示以下错误并且发生**“BUILD FAILURE”**

> **org.apache.maven.surefire.util.SurefireReflectionException：java.lang.reflect.InvocationTargetException；嵌套异常是 java.lang.reflect.InvocationTargetException: null java.lang.reflect.InvocationTargetException Caused by: java.lang.OutOfMemoryError: PermGen space**

我尝试了上述所有有用的提示和技巧，但不幸的是没有一个对我有用。下面逐步描述了对我有用的方法：=>

1.  转到你的 pom.xml
2.  搜索 `<artifactId>maven-surefire-plugin</artifactId>`
3.  添加一个新`<configuration>`元素，然后添加`<argLine>`子元素，其中传递`-Xmx512m -XX:MaxPermSize=256m`如下所示 =>

***`<configuration> <argLine>-Xmx512m -XX:MaxPermSize=256m</argLine> </configuration>`***

希望它有所帮助，快乐的编程:)

* * *

## 回答 #31

> 赞同：1
> 
> 时间：2012-09-01T07:32:49.767

您还可以通过执行以下操作来解决此问题：

```
rm -rf <tomcat-dir>/work/* <tomcat-dir>/temp/* 
```

清除*工作*目录和*临时*目录可使 Tomcat 干净启动。

* * *

## 回答 #32

> 赞同：0
> 
> 时间：2016-10-02T15:27:47.013

如果有人在 netbeans 中遇到同样的错误，那么这就是我修复它的方法。

**在 Netbeans 中：**

转到服务选项卡->在服务器上右键->选择属性->转到平台选项卡->内部 vm 选项类型 -Xms1024m

就我而言，我给了 -Xms4096m

这是屏幕截图：

[![在此处输入图像描述](https://i.stack.imgur.com/PrpdN.png)](https://i.stack.imgur.com/PrpdN.png)

* * *

## 回答 #33

> 赞同：0
> 
> 时间：2022-01-05T17:15:35.167

在尝试调试 JBoss 应用程序时，谁在 IntelliJ 中遇到了同样的问题：我刚刚将此添加`-XX: MaxPermSize = 128m`到运行/调试配置中的 VM 选项中。您可以将其增加到 256m 以更有效地保证工作。

# java - 运行时未从 .jar 文件中提取的文件

> ID：88243
> 
> 赞同：2
> 
> 时间：2008-09-17T22:14:40.180
> 
> 标签：java, ant, build, jar

我更新了我的 ant build.xml 文件以包含一个新文件和一个新文件夹。创建 .jar 后，我通过“解压缩\提取”检查它们是否存在于 jar 中，并且它们在那里。

但是在执行 .jar 时，文件夹或文件都不会被提取。

我错过了一步吗？

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2008-09-17T22:21:40.787

查看[getResourceAsStream](http://mindprod.com/jgloss/getresourceasstream.html)。它将使您不必从 jar 文件中提取文件。除非那是你的目标。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2008-09-17T22:17:36.647

您的应用程序应该能够直接从 jar 中使用该文件，而无需提取它。还是你的意思是别的？

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2008-09-17T22:18:35.990

您是否正在做一些特定的事情来提取 jar 文件？我问是因为执行它们时通常不会提取 jar 文件。

如果您运行“java -jar myJar.jar”或“java -cp myJar.jar com.example.MyMainClass”，则不会提取引用的 jar 文件。Java 将直接从 jar 文件中加载您的类和资源，而无需提取它。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2008-12-08T18:56:29.257

如果您使用[One-JAR](http://one-jar.sourceforge.net)包装您的应用程序，您可以在 Manifest 文件中指定一个属性来提取您想要的文件（请参阅[One-Jar-Expand](http://one-jar.sourceforge.net/index.php?page=introduction&file=manifest)清单属性）。

作为奖励，您还可以将任何依赖库与您的代码一起包装，创建一个可分发的 jar。

# asp.net - 跨网站使用相同的 App_Code 类

> ID：88252
> 
> 赞同：1
> 
> 时间：2008-09-17T22:15:34.560
> 
> 标签：asp.net, app-code

假设您有一个包含两个网站项目（网站 A 和网站 B）的解决方案。现在，在网站 A 的 App_Code 文件夹中，在 ClassX.cs 文件中定义了一个 X 类。如果网站 B 也需要访问 ClassX.cs，你会怎么做？

有没有办法在 App_Code 文件夹之间共享这个文件？假设将文件移动到公共库是不可能的。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2008-09-18T03:01:15.373

具有“假设将文件移动到公共库是不可能的”的限制。您可以这样做的唯一方法是使用 NTFS 连接点创建一个符号链接，以便在两个文件夹中拥有相同的 .cs 文件。

这是一个糟糕的选择（出于版本控制的原因）......将其移动到公共库是最好的选择。

这是关于 NTFS 连接点的维基百科条目 [http://en.wikipedia.org/wiki/NTFS_junction_point](http://en.wikipedia.org/wiki/NTFS_junction_point)

这是一个创建它们的工具 [http://technet.microsoft.com/en-us/sysinternals/bb896768.aspx](http://technet.microsoft.com/en-us/sysinternals/bb896768.aspx)

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2008-09-17T22:21:57.993

请不要使用这些邪恶的网站项目。请改用 Web 应用程序项目，将您的共享类打包到一个库项目中，并从您的所有 Web 应用程序中引用它。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2008-09-17T22:29:55.353

将您的共享类打包到一个库（DLL）中，然后从每个站点右键单击添加引用并选择您创建的库。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2008-09-17T22:33:12.927

我不相信有办法不将 ClassX 移动到新的代码库项目中。.NET 要求程序集的所有依赖项与程序集本身或 GAC 存在于同一文件夹中，以便自动检测。

您可以尝试通过反射类手动加载程序集，尽管它有点笨拙。

最好的解决方案，如果您有时间并愿意承担它，将采用 JRoppert 的解决方案，将其移至 Web 应用程序项目。然后，您可以使用 Web 引用（与 VS 中的常规引用一样好）来引用 ClassX。

高温高压

# python - 您如何配置 Django 以进行简单的开发和部署？

> ID：88259
> 
> 赞同：116
> 
> 时间：2008-09-17T22:16:43.763
> 
> 标签：python, django

在进行[Django](http://en.wikipedia.org/wiki/Django_(web_framework))开发时，我倾向于使用[SQLite](http://en.wikipedia.org/wiki/SQLite) ，但在实时服务器上，通常需要更健壮的东西（例如[MySQL](http://en.wikipedia.org/wiki/MySQL) / [PostgreSQL](http://en.wikipedia.org/wiki/PostgreSQL)）。总是对 Django 设置进行其他更改：不同的日志记录位置/强度、媒体路径等。

您如何管理所有这些更改以使部署成为一个简单、自动化的过程？

* * *

## 回答 #1

> 赞同：86
> 
> 时间：2008-09-17T22:27:35.390

**更新：** [django-configurations](http://django-configurations.readthedocs.org/en/latest/)已经发布，对于大多数人来说，这可能是比手动操作更好的选择。

如果您更愿意手动执行操作，我之前的回答仍然适用：

我有多个设置文件。

*   `settings_local.py`- 特定于主机的配置，例如数据库名称、文件路径等。
*   `settings_development.py`- 用于开发的配置，例如`DEBUG = True`.
*   `settings_production.py`- 用于生产的配置，例如`SERVER_EMAIL`。

我将这些都与一个`settings.py`首先导入的文件联系在一起`settings_local.py`，然后是另外两个中的一个。它通过`settings_local.py`-`DEVELOPMENT_HOSTS`和`PRODUCTION_HOSTS`. `settings.py`调用`platform.node()`以查找正在运行的机器的主机名，然后在列表中查找该主机名，并根据在哪个列表中找到主机名来加载第二个设置文件。

这样，您真正需要担心的唯一一件事就是使`settings_local.py`文件与特定于主机的配置保持同步，而其他一切都会自动处理。

[在这里](http://github.com/JimDabell/lojban-website/tree/master/lojban)查看一个示例。

* * *

## 回答 #2

> 赞同：26
> 
> 时间：2008-09-18T03:45:38.247

就个人而言，我为项目使用了一个 settings.py，我只是让它查找它所在的主机名（我的开发机器的主机名以“gabriel”开头，所以我只有这个：

```
import socket
if socket.gethostname().startswith('gabriel'):
    LIVEHOST = False
else: 
    LIVEHOST = True 
```

然后在其他部分我有类似的东西：

```
if LIVEHOST:
    DEBUG = False
    PREPEND_WWW = True
    MEDIA_URL = 'http://static1.grsites.com/'
else:
    DEBUG = True
    PREPEND_WWW = False
    MEDIA_URL = 'http://localhost:8000/static/' 
```

等等。可读性差一点，但它工作正常并且不必处理多个设置文件。

* * *

## 回答 #3

> 赞同：25
> 
> 时间：2008-09-18T10:57:14.793

在 settings.py 的末尾，我有以下内容：

```
try:
    from settings_local import *
except ImportError:
    pass 
```

这样，如果我想覆盖默认设置，我只需将 settings_local.py 放在 settings.py 旁边。

* * *

## 回答 #4

> 赞同：11
> 
> 时间：2008-09-17T22:29:30.783

我有两个文件。`settings_base.py`其中包含常见/默认设置，并已签入源代码管理。每个部署都有一个单独的`settings.py`，它`from settings_base import *`在开始时执行，然后根据需要覆盖。

* * *

## 回答 #5

> 赞同：7
> 
> 时间：2010-07-08T07:38:28.410

我发现的最简单的方法是：

1) 使用默认**settings.py**进行本地开发和 2) 创建一个**production-settings.py**，开头为：

```
import os
from settings import * 
```

然后只需覆盖生产中不同的设置：

```
DEBUG = False
TEMPLATE_DEBUG = DEBUG

DATABASES = {
    'default': {
           ....
    }
} 
```

* * *

## 回答 #6

> 赞同：2
> 
> 时间：2011-07-27T15:20:25.783

有点相关，对于部署 Django 本身与多个数据库的问题，你可能想看看[Djangostack](http://bitnami.org/stack/djangostack)。您可以下载一个完全免费的安装程序，允许您安装 Apache、Python、Django 等。作为安装过程的一部分，我们允许您选择要使用的数据库（MySQL、SQLite、PostgreSQL）。在内部自动化部署时，我们广泛使用安装程序（它们可以在无人值守模式下运行）。

* * *

## 回答 #7

> 赞同：1
> 
> 时间：2011-08-13T00:16:52.940

好吧，我使用这个配置：

在 settings.py 的末尾：

```
#settings.py
try:
    from locale_settings import *
except ImportError:
    pass 
```

在 locale_settings.py 中：

```
#locale_settings.py
class Settings(object):

    def __init__(self):
        import settings
        self.settings = settings

    def __getattr__(self, name):
        return getattr(self.settings, name)

settings = Settings()

INSTALLED_APPS = settings.INSTALLED_APPS + (
    'gunicorn',)

# Delete duplicate settings maybe not needed, but I prefer to do it.
del settings
del Settings 
```

* * *

## 回答 #8

> 赞同：1
> 
> 时间：2008-09-18T01:59:37.847

除了 Jim 提到的多个设置文件之外，我还倾向于将两个设置放入我的 settings.py 文件顶部`BASE_DIR`并`BASE_URL`设置为代码的路径和站点基础的 URL，所有其他设置都修改将自己附加到这些。

`BASE_DIR = "/home/sean/myapp/"` 例如`MEDIA_ROOT = "%smedia/" % BASEDIR`

因此，在移动项目时，我只需要编辑这些设置，而不是搜索整个文件。

我还建议查看 Fabric 和[Capistrano](http://en.wikipedia.org/wiki/Capistrano)（Ruby 工具，但它可用于部署 Django 应用程序），它们有助于远程部署的自动化。

* * *

## 回答 #9

> 赞同：1
> 
> 时间：2009-10-06T18:22:51.197

我在外部目录中有我的 settings.py 文件。这样，它就不会被检查到源代码控制中，也不会被部署覆盖。我把它和任何默认设置一起放在我的 Django 项目下的 settings.py 文件中：

```
import sys
import os.path

def _load_settings(path):    
    print "Loading configuration from %s" % (path)
    if os.path.exists(path):
    settings = {}
    # execfile can't modify globals directly, so we will load them manually
    execfile(path, globals(), settings)
    for setting in settings:
        globals()[setting] = settings[setting]

_load_settings("/usr/local/conf/local_settings.py") 
```

*注意：如果您不能信任 local_settings.py，这是非常危险的。*

* * *

## 回答 #10

> 赞同：1
> 
> 时间：2018-02-22T22:02:53.753

这么多复杂的答案！

每个 settings.py 文件都附带：

```
BASE_DIR = os.path.dirname(os.path.dirname(os.path.abspath(__file__))) 
```

我使用该目录来设置 DEBUG 变量，如下所示（用你的开发代码所在的目录重新放置）：

```
DEBUG=False
if(BASE_DIR=="/path/to/my/dev/dir"):
    DEBUG = True 
```

然后，每次移动 settings.py 文件时，DEBUG 将为 False，它是您的生产环境。

每次您需要与开发环境中的设置不同的设置时，只需使用：

```
if(DEBUG):
    #Debug setting
else:
    #Release setting 
```

* * *

## 回答 #11

> 赞同：0
> 
> 时间：2012-03-14T02:04:30.470

我使用环境：

```
if os.environ.get('WEB_MODE', None) == 'production' :
   from settings_production import *
else :
   from settings_dev import * 
```

我相信这是一种更好的方法，因为最终您需要为您的测试环境进行特殊设置，并且您可以轻松地将其添加到此条件中。

* * *

## 回答 #12

> 赞同：0
> 
> 时间：2008-09-20T15:37:23.877

我认为这取决于站点的大小，是否需要停止使用 SQLite，我已经在几个较小的实时站点上成功地使用了 SQLite，并且运行良好。

* * *

## 回答 #13

> 赞同：0
> 
> 时间：2018-05-10T21:38:54.010

这是一篇较旧的帖子，但我认为如果我添加此有用的`library`内容，它将简化事情。

使用[django 配置](https://github.com/jazzband/django-configurations)

### 快速开始

```
pip install django-configurations 
```

然后在项目的 settings.py 或您用于存储设置常量的任何其他模块中对包含的configurations.Configuration 类进行子类化，例如：

```
# mysite/settings.py

from configurations import Configuration

class Dev(Configuration):
    DEBUG = True 
```

将`DJANGO_CONFIGURATION`环境变量设置为您刚刚创建的类的名称，例如`~/.bashrc`：

`export DJANGO_CONFIGURATION=Dev`

和`DJANGO_SETTINGS_MODULE`往常一样将环境变量添加到模块导入路径中，例如在 bash 中：

`export DJANGO_SETTINGS_MODULE=mysite.settings`

*或者*`--configuration`，在使用 Django 管理命令时按照 Django 的默认命令行选项提供该`--settings`选项，例如：

`python manage.py runserver --settings=mysite.settings --configuration=Dev`

为了使 Django 能够使用您的配置，您现在必须修改您的**manage.py**或**wsgi.py**脚本以使用 django-configurations 的相应启动器功能版本，例如，使用 django-configurations 的典型**manage.py**如下所示：

```
#!/usr/bin/env python

import os
import sys

if __name__ == "__main__":
    os.environ.setdefault('DJANGO_SETTINGS_MODULE', 'mysite.settings')
    os.environ.setdefault('DJANGO_CONFIGURATION', 'Dev')

    from configurations.management import execute_from_command_line

    execute_from_command_line(sys.argv) 
```

请注意，在第 10 行中，我们没有使用 common 工具`django.core.management.execute_from_command_line`，而是使用`configurations.management.execute_from_command_line`.

这同样适用于您的**wsgi.py**文件，例如：

```
import os

os.environ.setdefault('DJANGO_SETTINGS_MODULE', 'mysite.settings')
os.environ.setdefault('DJANGO_CONFIGURATION', 'Dev')

from configurations.wsgi import get_wsgi_application

application = get_wsgi_application() 
```

这里我们不使用默认`django.core.wsgi.get_wsgi_application`函数，而是使用`configurations.wsgi.get_wsgi_application`.

而已！您现在可以将您的项目与**manage.py**和您最喜欢的启用 WSGI 的服务器一起使用。

* * *

## 回答 #14

> 赞同：0
> 
> 时间：2021-06-13T15:27:40.820

为什么要把事情搞得这么复杂？我从 PHP/Laravel 背景进入 Django。我使用`.env`，您可以轻松配置它。

安装这个包

```
django-environ 
```

现在，在您所在的文件夹中`settings.py`，创建一个文件`.env`（确保将此文件放在 gitignore 中）

在`.env`文件中，放置环境变量，如调试设置状态、密钥、邮件凭据等示例快照`.env`

```
SECRET_KEY="django-insecure-zy%)s5$=aql=#ox54lzfjyyx!&uv1-q0kp^54p(^251&_df75i"

DB_NAME=bugfree
DB_USER=postgres
DB_PASSWORD=koushik
DB_PORT=5433
DB_HOST=localhost

APP_DEBUG=True # everything is string here 
```

在设置中，确保使用此实例化它

```
import environ
env = environ.Env()
environ.Env.read_env() 
```

现在您可以从`.env`文件中导入值并将它们放在您想要的任何位置。中的一些例子`settings.py`

```
SECRET_KEY = env('SECRET_KEY')
DEBUG = bool(env('APP_DEBUG', False)) 
```

您也可以像这样输入默认值

```
env('DB_NAME', 'default value here') 
```

**提示** 您可以在您创建`.env.example`文件的同一文件夹中创建另一个，`.env`并且您可以拥有一个模板`.env`并且您可以提交该`.example`文件。它可以帮助未来的开发人员轻松了解那里有哪些环境变量。 `.env.example`会是这样的

```
SECRET_KEY=VALUE_HERE

DB_NAME=VALUE_HERE
DB_USER=VALUE_HERE
DB_PASSWORD=VALUE_HERE
DB_PORT=VALUE_HERE
DB_HOST=VALUE_HERE

EMAIL_HOST=VALUE_HERE
EMAIL_PORT=VALUE_HERE
EMAIL_HOST_USER=VALUE_HERE
EMAIL_HOST_PASSWORD=VALUE_HERE
DEFAULT_FROM_EMAIL=VALUE_HERE 
```

* * *

## 回答 #15

> 赞同：-2
> 
> 时间：2016-12-22T14:36:42.840

事实上，您可能应该考虑为您的开发和生产环境使用相同（或几乎相同）的配置。否则，“嘿，它在我的机器上工作”之类的情况会时不时发生。

因此，为了使您的部署自动化并消除这些 WOMM 问题，只需使用[Docker](https://www.docker.com/)即可。

# java - 你如何让 selenium 识别页面加载？

> ID：88269
> 
> 赞同：10
> 
> 时间：2008-09-17T22:18:29.250
> 
> 标签：java, selenium

在某些未知情况下，当使用 open 方法时，selenium 不会检测到页面已加载。我正在使用 Java API。例如（此代码不会产生此错误。我不知道会有外部可见页面。）：

```
Selenium browser = new DefaultSelenium("localhost", 4444, "*firefox", "http://www.google.com");
browser.start();
browser.open("http://www.google.com/webhp?hl=en");
browser.type("q", "hello world"); 
```

发生错误时，对“打开”的调用会超时，即使您可以清楚地看到在超时发生之前页面已成功加载。增加超时没有帮助。对“类型”的调用从未发生，也没有取得任何进展。

发生此错误时，如何让 selenium 识别页面已加载？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2011-11-10T11:54:17.383

我最近遇到了这个问题。

所有基于 JS 的解决方案都不太适合我拥有的 ICEFaces 2.x + Selenium 2.x/Webdriver 组合。

我所做的和对我有用的如下：

在屏幕的一角，有连接活动指示器。

```
 <ice:outputConnectionStatus id="connectStat"
                                        showPopupOnDisconnect="true"/> 
```

在我的 Java 单元测试中，我等到它的“空闲”图像再次出现：

```
private void waitForAjax() throws InterruptedException {
    for (int second = 0;; second++) {
        if (second >= 60) fail("timeout");
        try { 
            if ("visibility: visible;".equals(
                selenium.getAttribute("top_right_form:connectStat:connection-idle@style"))) { 
                break;
            }
        } catch (Exception e) {

        }
        Thread.sleep(1000);
    }
} 
```

如果不需要在页面上显示此指示器，您可以在生产构建中禁用此指示器的呈现，或者使用空的 1x1 gif 作为其图像。

100% 工作（使用弹出窗口、推送消息等）并使您从为每个元素分别指定 waitForElement(...) 的地狱中解脱出来。

希望这可以帮助某人。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2014-08-08T03:21:35.953

也许这会对你有所帮助......

考虑以下方法在名为 Functions.java 的页面中

```
public static void waitForPageLoaded(WebDriver driver) {

         ExpectedCondition<Boolean> expectation = new
    ExpectedCondition<Boolean>() {
            public Boolean apply(WebDriver driver) {
              return ((JavascriptExecutor)driver).executeScript("return document.readyState").equals("complete");
            }
          };

          WebDriverWait wait = new WebDriverWait(driver,30);
          try {
                  wait.until(expectation);
          } catch(Throwable error) {
                  Assert.assertFalse(true, "Timeout waiting for Page Load Request to complete.");
          }
     } 
```

您可以将此方法调用到您的函数中。由于是静态方法，可以直接用类名调用。

```
public class Test(){
    WebDriver driver;

    @Test
    public void testing(){
         driver = new FirefoxDriver();
         driver.get("http://www.gmail.com");
         Functions.waitForPageLoaded(driver);
   }
} 
```

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2008-09-18T19:44:28.830

使用 'openAndWait' 代替 'open' 就可以了。

从[网站](http://www.openqa.org/)：

> 许多动作可以用“AndWait”后缀调用，例如“clickAndWait”。这个后缀告诉 Selenium 该操作将导致浏览器调用服务器，并且 Selenium 应该等待新页面加载。

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2008-09-17T22:25:05.287

当我进行 Selenium 测试时，我会等待查看某个元素是否可见（waitForVisible），然后执行我的操作。我通常会尝试在我输入的元素之后使用一个元素。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2008-09-18T12:41:09.380

在使用 Selenium 测试带有 iFrame 的应用程序时，我遇到了类似的问题。基本上，似乎一旦加载了主页面（包含 iframe 的页面），Selenium 就无法确定 iframe 内容何时完成加载。

通过查看您尝试加载的链接的来源，似乎有一些 Javascript 在页面加载后会创建额外的页面元素。我不能确定，但​​这可能是导致问题的原因，因为它似乎与我在上面遇到的情况相似。

您在加载静态页面时是否遇到相同类型的错误？（即，带有直接 html 的东西）

如果您无法获得更好的答案，请尝试 selenium 论坛，它们通常非常活跃，而且 Selenium 开发人员确实会回答好的问题。

[http://clearspace.openqa.org/community/selenium_remote_control](http://clearspace.openqa.org/community/selenium_remote_control)

此外，如果您还没有尝试过，请在调用 open 之后添加对 browser.WaitForPageToLoad("15000") 的调用。我发现在每次页面转换之后执行此操作会使我的测试更加可靠，即使从技术上讲它不应该是必需的。（当 Selenium 检测到页面实际上已经加载时，它会继续，所以实际的超时变量并不是真正的问题......

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2008-09-17T22:25:27.970

启用“multiWindow”功能解决了这个问题，但我不清楚原因。

SeleniumServer(int port, boolean slowResources, boolean multiWindow)

```
SeleniumServer server = new SeleniumServer(4444, false, true); 
```

任何澄清都会有所帮助。

* * *

## 回答 #7

> 赞同：0
> 
> 时间：2013-04-21T09:22:08.883

不是一个完美的解决方案，但我正在使用这种方法

```
$t1 = time(); // current timestamp
$this->selenium->waitForPageToLoad(30);
$t2 = time();

if ($t2 - $t1 >= 28) {
    // page was not loaded
} 
```

因此，这是一种检查页面是否在指定时间内未加载，因此未加载。

* * *

## 回答 #8

> 赞同：0
> 
> 时间：2013-09-18T11:15:51.430

如果您的页面没有 AJAX，请尝试寻找页面的页脚（我也使用 Junit `fail("")`，您可以`System.err.println()`改用）：

```
 element.click();
    int timeout =120; 
    // one loop = 0.5 sec, co it will be one minute 
    WebElement myFooter = null;

    for(int i=0; i<timeout; i++){
      myFooter = driver.findElement(By.id("footer"));
      if(myFooter!= null){
        break;
      }
      else{
        timeout--;
      }
}
if(timeout==0 && myFooter == null){
  fail("ERROR! PAGE TIMEOUT");
} 
```

* * *

## 回答 #9

> 赞同：0
> 
> 时间：2013-09-18T11:22:20.513

另一个想法是修改 AJAX API（在 AJAX 操作之后添加一些文本）。ajax 动作完成后，在返回之前，将不可见字段设置为 TRUE，selenium 会找到它并读取为绿灯

在 html 中：

```
<input type='hidden' id="greenlight"> 
```

在硒中

```
if(driver.findElement(By.id("greenlight")).getAttr("value").equals("TRUE")){
    // do something after page loading
} 
```

# coldfusion - 在 ColdFusion 8 中，您可以使用 cfscript 将函数声明为私有吗？

> ID：88274
> 
> 赞同：4
> 
> 时间：2008-09-17T22:19:12.337
> 
> 标签：coldfusion, coldfusion-8

通常，您使用 cfscript 创建一个函数，例如：

```
<cfscript>
    function foo() { return "bar"; }
</cfscript> 
```

有没有办法将其声明为私有函数，仅可用于同一 cfc 中的其他方法？

我知道你可以用标签做到这一点：

```
<cffunction name="foo" access="private">
    <cfreturn "bar">
</cffunction> 
```

但我不想重写这个已经用 cfscript 编写的大型函数。

* * *

## 回答 #1

> 赞同：15
> 
> 时间：2008-09-17T22:30:36.367

不在 ColdFusion 8 中。不过，它是在 CF9 中添加的。

你不需要重写整个函数，你可以这样做：

```
<cffunction name="foo" returntype="string" output="false" access="private">
    <cfscript>
        return "bar";
    </cfscript>
</cffunction> 
```

如果您有权访问 CF9，则新语法为：

```
private string function foo() output="false" {
    return "bar";
} 
```

# php - 示例/如何使用 Exchange 03 Webdav 和 PHP 创建日历约会？

> ID：88276
> 
> 赞同：6
> 
> 时间：2008-09-17T22:19:17.377
> 
> 标签：php, calendar, ms-office, exchange-server, webdav

我已经尝试解决这个问题大约两个星期了。我可以在人们的文件夹中创建电子邮件项目，阅读文件夹，所有这些东西，但对于我的生活，我无法使用日历来处理任何事情。

我可以提供我发送到 WebDav 的 XML 示例，但希望有人已经做到了这一点并有一个示例？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2008-09-18T13:28:25.740

几年前我在一个 Java 程序中做过这个，我做的方式是把一个 VCALENDAR 文档放到文件夹中。一个怪癖是 VCALENDAR 必须包含在 RFC822 消息中。它是 WebDAV、电子邮件和 iCAL/VCAL 的奇怪组合，但当时它在 Link2Exchange 托管的 Exchange 2003 上运行。

我确信有一种更简单的方法，但这对我有用。下面我展示了发生的事情的 tcpdump 数据包跟踪。您可能应该在自己的 Outlook/Entourage 客户端上使用 ngrep/tcpdump 来查看它的作用。

请注意，“Cal2”是我的测试日历文件夹的名称。您将使用“日历”作为主日历文件夹。

```
T 10.0.1.95:59741 -> 66.211.136.9:80 [AP]
PUT /exchange/yourname.domainname.com/Cal2/CC1.1163646061548.0.eml HTTP/1.1.
translate: f.
Content-Type: message/rfc822.
Pragma: no-cache.
Accept: */*.
Cache-Control: no-cache.
Authorization: Basic NOYOUCANTSEEMYPASSWORDYOUBASTARDS.
User-Agent: Jakarta Commons-HttpClient/2.0final.
Host: e1.exmx.net.
Cookie: sessionid=29486b50-d398-4f76-9604-8421950c7dcd:0x0.
Content-Length: 478.
Expect: 100-continue.
.

T 66.211.136.9:80 -> 10.0.1.95:59741 [AP]
HTTP/1.1 100 Continue.
.

T 10.0.1.95:59741 -> 66.211.136.9:80 [AP]
content-class: urn:content-classes:appointment.
Content-Type: text/calendar;.
.method=REQUEST;.
.charset="utf-8".
Content-Transfer-Encoding: 8bit.
.
BEGIN:VCALENDAR.
BEGIN:VEVENT.
UID:E1+1382+1014+495066799@I1+1382+1014+6+495066799.
SUMMARY:Voice Architecture Leads Meeting.
PRIORITY:5.
LOCATION:x44444 pc:6879.
DTSTART:20061122T193000Z.
DTEND:20061122T203000Z.
DTSTAMP:20061110T074856Z.
DESCRIPTION:this is a description.
SUMMARY:this is a summary.
END:VEVENT.
END:VCALENDAR.

T 66.211.136.9:80 -> 10.0.1.95:59741 [AP]
HTTP/1.1 201 Created.
Date: Thu, 16 Nov 2006 03:00:16 GMT.
Server: Microsoft-IIS/6.0.
X-Powered-By: ASP.NET.
MS-Exchange-Permanent-URL: http://e1.exmx.net/exchange/yourname.yourdomain.com/-FlatUrlSpace-/122cda661de1da48936f9
44bda4dde6e-3af8a8/122cda661de1da48936f944bda4dde6e-3f3383.
Location: http://e1.exmx.net/exchange/yourname.yourdomain.com/Cal2/CC1.1163646061548.0.eml.
Repl-UID: <rid:122cda661de1da48936f944bda4dde6e0000003f3383>.
Content-Type: text/html.
Content-Length: 110.
Allow: OPTIONS, TRACE, GET, HEAD, DELETE, PUT, COPY, MOVE, PROPFIND, PROPPATCH, SEARCH, SUBSCRIBE, UNSUBSCRIBE, PO
LL, BDELETE, BCOPY, BMOVE, BPROPPATCH, BPROPFIND, LOCK, UNLOCK.
ResourceTag: <rt:122cda661de1da48936f944bda4dde6e0000003f3383122cda661de1da48936f944bda4dde6e0000003f4671>.
GetETag: "122cda661de1da48936f944bda4dde6e0000003f4671".
MS-WebStorage: 6.5.7638.
Cache-Control: no-cache. 
```

.

```
T 66.211.136.9:80 -> 10.0.1.95:59741 [AP]
<body><h1>/exchange/yourname.yourdomain.com/Cal2/CC1.1163646061548.0.eml was created successfully</h1></body>. 
```

您可以使用 Cadaver 之类的工具通过 WebDAV 查询对象的属性来验证它是否有效，如下所示：

```
dav:/exchange/yourname@yourdomain.com/Cal2/> propget CC1.1163646061548.0.eml
  Fetching properties for `CC1.1163646061548.0.eml':
  textdescription = this is a description
  contentclass = urn:content-classes:appointment
  supportedlock = <lockentry><locktype><transaction><groupoperation></groupoperation></transaction></locktype><locks
  cope><local></local></lockscope></lockentry>
  permanenturl = http://e1.exmx.net/exchange/yourname@yourdomain.com/-FlatUrlSpace-/122cda661de1da48936f944bda4dde6e-
  3af8a8/122cda661de1da48936f944bda4dde6e-3f3383
  getcontenttype = message/rfc822
  id = AQEAAAAAOvioAQAAAAA/M4MAAAAA
  mid = -8992774761696198655
  uid = E1+1382+1014+495066799@I1+1382+1014+6+495066799
  isfolder = 0
  resourcetype = 
  method = PUBLISH
  getetag = "122cda661de1da48936f944bda4dde6e0000003f4671"
  lockdiscovery = 
  outlookmessageclass = IPM.Appointment
  creationdate = 2006-11-16T03:00:16.549Z
  outlookmessageclass = IPM.Appointment
  creationdate = 2006-11-16T03:00:16.549Z
  ntsecuritydescriptor = CAAEAAAAAAABAC+MMAAAAEwAAAAAAAAAFAAAAAIAHAABAAAAARAUAL8PHwABAQAAAAAABQcAAAABBQAAAAAABRUAAAC
  nkePD6LEa8iIT/+gqDAAAAQUAAAAAAAUVAAAAp5Hjw+ixGvIiE//oAQIAAA==
  dtstamp = 2006-11-10T07:48:56.000Z
  lastmodified = 2006-11-16T03:00:16.565Z
  dtstart = 2006-11-22T19:30:00.000Z
  location = x44444 pc:6879
  duration = 3600
  htmldescription = <!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 3.2//EN">
  <HTML>
  <HEAD>

  <META NAME="Generator" CONTENT="MS Exchange Server version 6.5.7638.1">
  <TITLE>this is a summary</TITLE>
  </HEAD>
  <BODY>
  <!-- Converted from text/plain format -->

  <P><FONT SIZE=2>this is a description</FONT>
  </P>

  </BODY>
  </HTML>
  ishidden = 0
  parentname = http://e1.exmx.net/exchange/yourname@yourdomain.com/Cal2/
  meetingstatus = TENTATIVE
  subject = this is a summary
  getcontentlength = 631
  normalizedsubject = this is a summary
  isstructureddocument = 0
  repl-uid = rid:122cda661de1da48936f944bda4dde6e0000003f3383
  timezoneid = 0
  displayname = CC1.1163646061548.0.eml
  href = http://e1.exmx.net/exchange/yourname@yourdomain.com/Cal2/CC1.1163646061548.0.eml
  nomodifyexceptions = 1
  patternend = 2006-11-22T20:30:00.000Z
  isreadonly = 0
  instancetype = 0
  uid = AQEAAAAAPzODAAAAAAAAAAAAAAAA
  getlastmodified = 2006-11-16T03:00:16.565Z
  created = 2006-11-16T03:00:16.549Z
  sensitivity = 0
  dtend = 2006-11-22T20:30:00.000Z
  hasattachment = 0
  iscollection = 0
  read = 1
  resourcetag = rt:122cda661de1da48936f944bda4dde6e0000003f3383122cda661de1da48936f944bda4dde6e0000003f4671
  patternstart = 2006-11-22T19:30:00.000Z
  priority = 0
  sequence = 0 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-09-13T16:27:00.757

看看这个 [http://golemlab.wordpress.com/2009/09/13/php-owa-2003-calendar-fun/](http://golemlab.wordpress.com/2009/09/13/php-owa-2003-calendar-fun/)

# ubuntu - Parallels下的时间同步Ubuntu服务器

> ID：88289
> 
> 赞同：0
> 
> 时间：2008-09-17T22:21:13.173
> 
> 标签：ubuntu, virtual-machine, parallels

我已将 Ubuntu Server (8.04) 安装到 Parallels 中，发现系统时间/时钟运行得很快，以至于随着时间的推移会增加数小时。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2008-09-17T22:22:21.173

使用[NTP 服务](http://en.wikipedia.org/wiki/Network_Time_Protocol)保持同步怎么样？

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2008-09-17T22:22:17.633

您可能只想安装 ntpd，它在真实服务器上运行良好，也应该在虚拟服务器上发挥作用。另一种可能性是检查 Parallels 是否具有“将访客时钟同步到主机时钟”之类的配置选项。

# .net - F# 中的宏支持

> ID：88302
> 
> 赞同：23
> 
> 时间：2008-09-17T22:22:28.087
> 
> 标签：.net, f#, functional-programming, lisp, clojure

在阅读了 Practical Common Lisp 之后，我终于明白了宏有什么大不了的，并且我一直在为 .NET 平台寻找一种支持它的语言。.NET 有一些 lisp 方言，但据我所知，所有这些方言要么非常 beta，要么被废弃。最近我的兴趣被 Clojure 激发了，但它是针对 java 平台的，虽然可能可以使用 ikvm，但它并没有感觉到一些集成。尤其是当你想做 WPF 之类的东西时。

最近我一直听到关于 F# 的耳语，如果我能找到有关宏支持的任何信息，我试图查看文档，但没有找到。那么有人知道吗？

谢谢 ：）

* * *

## 回答 #1

> 赞同：13
> 
> 时间：2008-09-17T23:29:25.430

[http://nemerle.org/](http://nemerle.org/)上的Nemerle是一种 .NET 语言（也支持单声道），它支持许多函数式编程范式，同时在视觉上接近 C#。它具有广泛的宏支持。

* * *

## 回答 #2

> 赞同：12
> 
> 时间：2008-09-17T22:26:48.747

嗯，F# 是基于 OCaml 的，而 OCaml 有一个相当[广泛的宏系统](http://www.ocaml-tutorial.org/camlp4_3.10)。鉴于 F# 和 OCaml 在句法和语义上的相似性，您可以将 Ocaml 宏系统移植到 F#。

除了窃取 Ocaml 的宏系统之外，我不知道 F# 的固定宏系统。

* * *

## 回答 #3

> 赞同：7
> 
> 时间：2008-09-17T22:23:45.993

没有。F# 没有宏。

* * *

## 回答 #4

> 赞同：6
> 
> 时间：2008-09-17T23:58:15.483

你看过[布](http://Boo.CodeHaus.Org/)吗？虽然 Boo 没有宏，但它有一个开放的编译器管道，这是用于语法元编程的宏的一个很好的替代品。

[编辑] 如评论中所述，Boo现在*确实*有宏。

* * *

## 回答 #5

> 赞同：4
> 
> 时间：2008-09-17T23:19:09.820

*但可怕的是，那些 ocaml 示例中的语法看起来晦涩难懂*

在那里，您遇到了与 Lisp 相同的基本语法权衡。如果您想要类似 lisp 的宏的强大功能，您往往要么最终使用类似 lisp 的语言语法，要么您的宏语法看起来与您的常规语法完全不同......这两种方法都没有错，只是选择不同

* * *

## 回答 #6

> 赞同：4
> 
> 时间：2010-11-07T01:10:35.843

我想我应该指出，现在有一个非常活跃的[Clojure](https://github.com/richhickey/clojure-clr/wiki/) .NET/Mono 端口。Clojure 支持 LISP 样式的宏，如问题中所述。

正如其他人所说，此时（2010 年末）F# 不支持宏。

* * *

## 回答 #7

> 赞同：3
> 
> 时间：2010-09-01T13:03:39.030

> 最近我一直听到关于 F# 的耳语，如果我能找到有关宏支持的任何信息，我试图查看文档，但没有找到。那么有人知道吗？

F# 不支持宏，而且不太可能永远支持。

* * *

## 回答 #8

> 赞同：2
> 
> 时间：2010-06-23T11:41:57.213

使用 F# 引号怎么样？

[http://tomasp.net/blog/fsquotations.aspx](http://tomasp.net/blog/fsquotations.aspx)

* * *

## 回答 #9

> 赞同：1
> 
> 时间：2008-09-19T10:18:47.123

这可能与您想要的相反，但是您了解[RDNZL](http://www.weitz.de/rdnzl/)吗？它是一个外来函数接口 (FFI)，可让您从 Lisp 代码中调用 .NET 库。

它们很可能远不如任何 Common Lisp 或 Scheme 实现成熟，但有用于 .NET 的 Lisp 方言：[L#](http://www.lsharp.org/)和[DotLisp](http://dotlisp.sourceforge.net/dotlisp.htm)。

* * *

## 回答 #10

> 赞同：1
> 
> 时间：2008-12-12T00:28:33.560

.net 有两个积极开发的 Lisp

[IronScheme](http://www.codeplex.com/IronScheme) - 基于 DLR 的方案实现

[Xronos](http://www.bitbucket.org/stefanrusek/xronos/wiki/Home) - 基于 DLR 的 clojure 端口

* * *

## 回答 #11

> 赞同：1
> 
> 时间：2017-02-18T15:29:21.930

我目前正在研究 F# 中元编程的可能性。如果我们将宏定义为扩展为代码的文本模板，那么有两种明显的方法：

1.  T4 模板。F# 有实现：[https ://github.com/kerams/Templatus](https://github.com/kerams/Templatus)

2.  我在某处看到从字符串调用 F# 到单独的程序集，然后加载程序集。

# http - 如何在不重定向的情况下将 cookie 添加到 Seaside 响应？

> ID：88306
> 
> 赞同：5
> 
> 时间：2008-09-17T22:23:22.123
> 
> 标签：http, cookies, seaside, redirectwithcookies

我正在 Seaside 中制作一个小型 Web 应用程序。我有一个登录组件，在用户登录后，我想在下一个组件呈现自身时发送一个 cookie。有没有办法获取处理响应的对象，以便我可以在它将输出的标头中添加一些内容？

我试图避免使用 WASession>>redirectWithCookies 因为重定向似乎很笨拙，因为我想设置一个 cookie。

是否已经存在另一种方法来添加将在下一个响应时发出的 cookie？

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2008-09-18T07:20:58.587

目前没有在请求处理的操作/回调阶段添加 cookie 的内置方法。这很可能是一个缺陷，并在此问题中注明：[http ://code.google.com/p/seaside/issues/detail?id=48](http://code.google.com/p/seaside/issues/detail?id=48)

这目前计划在 Seaside 2.9 中修复，但我不知道它是否会被向后移植到 2.8。

请记住，动作和渲染阶段之间已经存在（默认情况下）重定向，以防止刷新重新触发回调，因此在总体方案中，在这种情况下再进行一次重定向并不是*那么*糟糕。

如果您仍想进一步挖掘，请查看 WARenderContinuation>>handleRequest:。这就是触发回调处理并开始重定向或呈现阶段的地方。

**编辑添加：**

该问题现已修复，并且（在最新的开发代码中）您现在可以随时将 cookie 添加到当前响应中。只需访问当前请求上下文中的响应对象并添加 cookie。例如，您可能会执行以下操作：

```
self requestContext response addCookie: aCookie 
```

这不太可能向后移植到 Seaside 2.8，因为它需要对处理响应的方式进行相当大的转变。

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2008-09-18T07:14:24.657

我刚刚深入研究了这个问题，答案似乎是否定的。具体来说，没有办法获得来自 WARenderCanvas 的响应或它可以访问的任何东西（它保存在 WARenderingContext 上，它保存在 WAHtmlStreamDocument 上，它保存在响应的*流*上，但不是响应本身）。我认为让上下文访问当前响应是合理的，正是为了能够在其上设置标题，但您问是否已经有办法，所以：没有。

也就是说，Seaside 做了很多额外的重定向，而且它似乎对用户体验没有太大影响，所以也许要做的就是不要再担心它看起来很笨拙，而顺应已经存在的 API 流程那里 ：）

# ruby - 如何在 Ruby 中生成随机字符串

> ID：88311
> 
> 赞同：804
> 
> 时间：2008-09-17T22:24:44.803
> 
> 标签：ruby, random, passwords

我目前正在为“A”..“Z”生成一个 8 字符的伪随机大写字符串：

```
value = ""; 8.times{value  << (65 + rand(25)).chr} 
```

但它看起来并不干净，并且不能作为参数传递，因为它不是单个语句。为了获得混合大小写的字符串“a”..“z”加上“A”..“Z”，我将其更改为：

```
value = ""; 8.times{value << ((rand(2)==1?65:97) + rand(25)).chr} 
```

但它看起来像垃圾。

有没有人有更好的方法？

* * *

## 回答 #1

> 赞同：1022
> 
> 时间：2008-09-17T22:29:05.073

```
(0...8).map { (65 + rand(26)).chr }.join 
```

我花了太多时间打高尔夫球。

```
(0...50).map { ('a'..'z').to_a[rand(26)] }.join 
```

最后一个更令人困惑，但更灵活，浪费更少的周期：

```
o = [('a'..'z'), ('A'..'Z')].map(&:to_a).flatten
string = (0...50).map { o[rand(o.length)] }.join 
```

如果要生成一些随机文本，请使用以下命令：

```
50.times.map { (0...(rand(10))).map { ('a'..'z').to_a[rand(26)] }.join }.join(" ") 
```

此代码生成 50 个单词长度小于 10 个字符的随机单词字符串，然后用空格连接

* * *

## 回答 #2

> 赞同：842
> 
> 时间：2009-10-25T00:32:57.200

为什么不使用 SecureRandom？

```
require 'securerandom'
random_string = SecureRandom.hex

# outputs: 5b5cd0da3121fc53b4bc84d0c8af2e81 (i.e. 32 chars of 0..9, a..f) 
```

SecureRandom 还具有以下方法：

*   base64
*   随机字节
*   随机数

见：[http ://ruby-doc.org/stdlib-1.9.2/libdoc/securerandom/rdoc/SecureRandom.html](http://ruby-doc.org/stdlib-1.9.2/libdoc/securerandom/rdoc/SecureRandom.html)

* * *

## 回答 #3

> 赞同：268
> 
> 时间：2010-08-26T07:34:56.553

我使用它来生成具有保证最大长度的随机 URL 友好字符串：

```
string_length = 8
rand(36**string_length).to_s(36) 
```

它生成小写 az 和 0-9 的随机字符串。它不是很可定制，但它又短又干净。

* * *

## 回答 #4

> 赞同：178
> 
> 时间：2009-01-29T20:20:42.053

该解决方案为激活码生成一串易于阅读的字符；我不希望人们将 8 与 B、1 与 I、0 与 O、L 与 1 等混淆。

```
# Generates a random string from a set of easily readable characters
def generate_activation_code(size = 6)
  charset = %w{ 2 3 4 6 7 9 A C D E F G H J K M N P Q R T V W X Y Z}
  (0...size).map{ charset.to_a[rand(charset.size)] }.join
end 
```

* * *

## 回答 #5

> 赞同：135
> 
> 时间：2011-08-28T18:21:57.950

其他人也提到了类似的东西，但这使用了 URL 安全功能。

```
require 'securerandom'
p SecureRandom.urlsafe_base64(5) #=> "UtM7aa8"
p SecureRandom.urlsafe_base64 #=> "UZLdOkzop70Ddx-IJR0ABg"
p SecureRandom.urlsafe_base64(nil, true) #=> "i0XQ-7gglIsHGV2_BNPrdQ==" 
```

结果可能包含 AZ、az、0-9、“-”和“_”。如果填充为真，也使用“=”。

* * *

## 回答 #6

> 赞同：110
> 
> 时间：2018-01-30T12:17:40.417

从 Ruby 2.5 开始，它真的很容易`SecureRandom.alphanumeric`：

```
len = 8
SecureRandom.alphanumeric(len)
=> "larHSsgL" 
```

它生成包含 AZ、az 和 0-9 的随机字符串，因此应该适用于大多数用例。它们是随机安全生成的，这也可能是一个好处。

* * *

这是将其与获得最多投票的解决方案进行比较的基准：

```
require 'benchmark'
require 'securerandom'

len = 10
n = 100_000

Benchmark.bm(12) do |x|
  x.report('SecureRandom') { n.times { SecureRandom.alphanumeric(len) } }
  x.report('rand') do
    o = [('a'..'z'), ('A'..'Z'), (0..9)].map(&:to_a).flatten
    n.times { (0...len).map { o[rand(o.length)] }.join }
  end
end 
```

* * *

```
 user     system      total        real
SecureRandom   0.429442   0.002746   0.432188 (  0.432705)
rand           0.306650   0.000716   0.307366 (  0.307745) 
```

所以`rand`解决方案只需要大约 3/4 的时间`SecureRandom`。如果您生成大量字符串，这可能很重要，但如果您只是不时创建一些随机字符串，我总是会选择更安全的实现，因为它也更容易调用和更明确。

* * *

## 回答 #7

> 赞同：53
> 
> 时间：2012-01-04T16:41:23.317

```
[*('A'..'Z')].sample(8).join 
```

生成一个随机的 8 个字母字符串（例如 NVAYXHGR）

```
([*('A'..'Z'),*('0'..'9')]-%w(0 1 I O)).sample(8).join 
```

生成一个随机的 8 个字符的字符串（例如 3PH4SWF2），不包括 0/1/I/O。红宝石 1.9

* * *

## 回答 #8

> 赞同：31
> 
> 时间：2009-07-12T21:40:46.857

我不记得我在哪里找到的，但对我来说，这似乎是最好的和最少的过程密集型：

```
def random_string(length=10)
  chars = 'abcdefghjkmnpqrstuvwxyzABCDEFGHJKLMNPQRSTUVWXYZ0123456789'
  password = ''
  length.times { password << chars[rand(chars.size)] }
  password
end 
```

* * *

## 回答 #9

> 赞同：28
> 
> 时间：2012-07-13T00:34:57.853

```
require 'securerandom'
SecureRandom.urlsafe_base64(9) 
```

* * *

## 回答 #10

> 赞同：26
> 
> 时间：2013-07-11T14:36:07.180

如果要指定长度的字符串，请使用：

```
require 'securerandom'
randomstring = SecureRandom.hex(n) 
```

它将生成一个随机长度的字符串，`2n`其中包含`0-9`和`a-f`

* * *

## 回答 #11

> 赞同：15
> 
> 时间：2014-09-29T19:51:02.673

`Array.new(n){[*"0".."9"].sample}.join`，`n=8`在你的情况下。

广义：`Array.new(n){[*"A".."Z", *"0".."9"].sample}.join`等。

来自：“[生成伪随机字符串AZ，0-9](https://stackoverflow.com/questions/26076011/rails-generate-pseudo-random-string-a-z-0-9/26076063#26076063) ”。

* * *

## 回答 #12

> 赞同：12
> 
> 时间：2014-11-19T06:12:15.510

这是长度为 8 的随机字符串的一行简单代码：

```
 random_string = ('0'..'z').to_a.shuffle.first(8).join 
```

您还可以将其用于长度为 8 的随机密码：

```
random_password = ('0'..'z').to_a.shuffle.first(8).join 
```

* * *

## 回答 #13

> 赞同：11
> 
> 时间：2008-09-17T22:40:34.640

```
require 'sha1'
srand
seed = "--#{rand(10000)}--#{Time.now}--"
Digest::SHA1.hexdigest(seed)[0,8] 
```

* * *

## 回答 #14

> 赞同：11
> 
> 时间：2010-07-24T21:04:08.310

红宝石 1.9+：

```
ALPHABET = ('a'..'z').to_a
#=> ["a", "b", "c", "d", "e", "f", "g", "h", "i", "j", "k", "l", "m", "n", "o", "p", "q", "r", "s", "t", "u", "v", "w", "x", "y", "z"]

10.times.map { ALPHABET.sample }.join
#=> "stkbssowre"

# or

10.times.inject('') { |s| s + ALPHABET.sample }
#=> "fdgvacnxhc" 
```

* * *

## 回答 #15

> 赞同：8
> 
> 时间：2012-10-15T06:51:24.093

这是长度为 8 的随机密码的一个简单代码：

```
rand_password=('0'..'z').to_a.shuffle.first(8).join 
```

* * *

## 回答 #16

> 赞同：8
> 
> 时间：2013-03-30T14:30:32.087

请注意：`rand`对于攻击者来说是可预测的，因此可能不安全。如果用于生成密码，您绝对应该使用 SecureRandom。我使用这样的东西：

```
length = 10
characters = ('A'..'Z').to_a + ('a'..'z').to_a + ('0'..'9').to_a

password = SecureRandom.random_bytes(length).each_char.map do |char|
  characters[(char.ord % characters.length)]
end.join 
```

* * *

## 回答 #17

> 赞同：7
> 
> 时间：2010-01-08T23:17:16.813

我喜欢使用的另一种方法：

```
 rand(2**256).to_s(36)[0..7] 
```

`ljust`如果您对正确的字符串长度真的很偏执，请添加：

```
 rand(2**256).to_s(36).ljust(8,'a')[0..7] 
```

* * *

## 回答 #18

> 赞同：7
> 
> 时间：2012-04-19T00:25:43.200

```
SecureRandom.base64(15).tr('+/=lIO0', 'pqrsxyz') 
```

来自设计的东西

* * *

## 回答 #19

> 赞同：6
> 
> 时间：2011-06-20T13:48:42.053

我认为这是简洁、清晰和易于修改的良好平衡。

```
characters = ('a'..'z').to_a + ('A'..'Z').to_a
# Prior to 1.9, use .choice, not .sample
(0..8).map{characters.sample}.join 
```

### 轻松修改

例如，包括数字：

```
characters = ('a'..'z').to_a + ('A'..'Z').to_a + (0..9).to_a 
```

大写十六进制：

```
characters = ('A'..'F').to_a + (0..9).to_a 
```

对于一个真正令人印象深刻的字符数组：

```
characters = (32..126).to_a.pack('U*').chars.to_a 
```

* * *

## 回答 #20

> 赞同：5
> 
> 时间：2012-05-27T10:27:32.977

只是在这里添加我的美分......

```
def random_string(length = 8)
  rand(32**length).to_s(32)
end 
```

* * *

## 回答 #21

> 赞同：5
> 
> 时间：2014-08-22T22:53:52.870

您可以[`String#random`](https://github.com/rubyworks/facets/blob/126a619fd766bc45588cac18d09c4f1927538e33/lib/core/facets/string/random.rb)从 Ruby Gem 的 Facets 中使用`facets`。

它基本上是这样做的：

```
class String
  def self.random(len=32, character_set = ["A".."Z", "a".."z", "0".."9"])
    characters = character_set.map { |i| i.to_a }.flatten
    characters_len = characters.length
    (0...len).map{ characters[rand(characters_len)] }.join
  end
end 
```

* * *

## 回答 #22

> 赞同：5
> 
> 时间：2015-09-18T16:12:49.150

此解决方案需要外部依赖，但似乎比其他解决方案更漂亮。

1.  安装 gem [faker](https://github.com/stympy/faker)
2.  `Faker::Lorem.characters(10) # => "ang9cbhoa8"`

* * *

## 回答 #23

> 赞同：4
> 
> 时间：2010-08-07T20:16:09.540

我最近正在做这样的事情，从 62 个字符中生成一个 8 字节的随机字符串。字符为 0-9、az、AZ。我有一个数组，就像循环 8 次并从数组中选择一个随机值一样。这是在 Rails 应用程序中。

```
str = ''
8.times {|i| str << ARRAY_OF_POSSIBLE_VALUES[rand(SIZE_OF_ARRAY_OF_POSSIBLE_VALUES)] } 
```

奇怪的是我得到了很多重复。现在随机这几乎不会发生。62^8 是巨大的，但在数据库中的 1200 个左右的代码中，我有很多重复项。我注意到它们发生在彼此的小时边界上。换句话说，我可能会在 12:12:23 和 2:12:22 或类似的时间看到一个重复...不确定时间是否是问题所在。

此代码在 ActiveRecord 对象的创建之前。在创建记录之前，此代码将运行并生成“唯一”代码。数据库中的条目总是可靠地生成，但是代码（`str`在上面的行中）经常被重复。

我创建了一个脚本来运行上述行的 100000 次迭代，延迟很小，因此希望每小时看到某种重复模式需要 3-4 小时，但什么也没看到。我不知道为什么在我的 Rails 应用程序中会发生这种情况。

* * *

## 回答 #24

> 赞同：4
> 
> 时间：2011-04-20T19:58:17.800

鉴于：

```
chars = [*('a'..'z'),*('0'..'9')].flatten 
```

单个表达式，可以作为参数传递，允许重复字符：

```
Array.new(len) { chars.sample }.join 
```

* * *

## 回答 #25

> 赞同：4
> 
> 时间：2013-11-28T18:18:17.813

我最喜欢的是`(:A..:Z).to_a.shuffle[0,8].join`。请注意，shuffle 需要 Ruby > 1.9。

* * *

## 回答 #26

> 赞同：3
> 
> 时间：2008-09-18T02:35:00.163

我认为到目前为止，我最喜欢雷达的回答。我会像这样调整一下：

```
CHARS = ('a'..'z').to_a + ('A'..'Z').to_a
def rand_string(length=8)
  s=''
  length.times{ s << CHARS[rand(CHARS.length)] }
  s
end 
```

* * *

## 回答 #27

> 赞同：3
> 
> 时间：2011-10-04T19:55:02.713

```
''.tap {|v| 4.times { v << ('a'..'z').to_a.sample} } 
```

* * *

## 回答 #28

> 赞同：3
> 
> 时间：2012-02-10T20:50:25.963

由 3 个范围组成的随机字符串的 2 种解决方案：

```
(('a'..'z').to_a + ('A'..'Z').to_a + (0..9).to_a).sample(8).join

([*(48..57),*(65..90),*(97..122)]).sample(8).collect(&:chr)*"" 
```

### 每个范围中的一个字符。

如果您需要每个范围内至少一个字符，例如创建一个包含一个大写、一个小写字母和一个数字的随机密码，您可以执行以下操作：

```
( ('a'..'z').to_a.sample(8) + ('A'..'Z').to_a.sample(8) + (0..9).to_a.sample(8) ).shuffle.join 
#=> "Kc5zOGtM0H796QgPp8u2Sxo1" 
```

* * *

## 回答 #29

> 赞同：3
> 
> 时间：2012-05-03T15:49:14.453

我的 2 美分：

```
 def token(length=16)
    chars = [*('A'..'Z'), *('a'..'z'), *(0..9)]
    (0..length).map {chars.sample}.join
  end 
```

* * *

## 回答 #30

> 赞同：3
> 
> 时间：2013-12-03T04:01:18.713

我只是写了一个小 gem`random_token`来为大多数用例生成随机令牌，享受吧~

[https://github.com/sibevin/random_token](https://github.com/sibevin/random_token)

* * *

## 回答 #31

> 赞同：2
> 
> 时间：2008-09-17T22:48:38.460

我们一直在我们的代码中使用它：

```
class String

  def self.random(length=10)
    ('a'..'z').sort_by {rand}[0,length].join
  end

end 
```

支持的最大长度是 25（无论如何我们只使用默认值，所以没有问题）。

有人提到，如果你想完全避免产生冒犯性的话，'a'..'z' 是次优的。我们的想法之一是删除元音，但你最终还是会得到 WTFBBQ 等。

* * *

## 回答 #32

> 赞同：2
> 
> 时间：2008-09-18T00:53:41.403

使用此方法，您可以传入任意长度。它被设置为默认值 6。

```
def generate_random_string(length=6)
  string = ""
  chars = ("A".."Z").to_a
  length.times do
    string << chars[rand(chars.length-1)]
  end
  string
end 
```

* * *

## 回答 #33

> 赞同：2
> 
> 时间：2011-02-22T04:08:30.597

试试这个

```
def rand_name(len=9)
  ary = [('0'..'9').to_a, ('a'..'z').to_a, ('A'..'Z').to_a]
  name = ''

  len.times do
    name << ary.choice.choice
  end
  name
end 
```

我喜欢该线程的答案，确实非常有帮助！但如果我可以说，它们都不符合我的要求，也许是 rand() 方法。这对我来说似乎不正确，因为我们已经有了 Array#choice 方法。

* * *

## 回答 #34

> 赞同：2
> 
> 时间：2011-08-24T09:42:14.530

这是另一种方法：

*   它使用安全随机数生成器而不是 rand()
*   可用于 URL 和文件名
*   包含大写、小写字符和数字
*   可以选择不包含不明确的字符 I0l01

需求`require "securerandom"`

```
def secure_random_string(length = 32, non_ambiguous = false)
  characters = ('a'..'z').to_a + ('A'..'Z').to_a + ('0'..'9').to_a

  %w{I O l 0 1}.each{ |ambiguous_character| 
    characters.delete ambiguous_character 
  } if non_ambiguous

  (0...length).map{
    characters[ActiveSupport::SecureRandom.random_number(characters.size)]
  }.join
end 
```

* * *

## 回答 #35

> 赞同：2
> 
> 时间：2012-07-03T14:23:56.553

如果您在 UNIX 上，并且仍然必须在没有 Rails 的情况下使用 Ruby 1.8（没有 SecureRandom），您也可以使用这个：

```
random_string = `openssl rand -base64 24` 
```

请注意，这会产生新的 shell，这非常慢，只能推荐用于脚本。

* * *

## 回答 #36

> 赞同：2
> 
> 时间：2014-08-18T08:01:42.050

另一个适用于 Ruby 1.8+ 并且速度很快的技巧是：

```
>> require "openssl"
>> OpenSSL::Random.random_bytes(20).unpack('H*').join
=> "2f3ff53dd712ba2303a573d9f9a8c1dbc1942d28" 
```

它得到你随机的十六进制字符串。类似的方式你应该能够生成base64字符串（'M *'）。

* * *

## 回答 #37

> 赞同：1
> 
> 时间：2012-04-24T05:45:19.717

这是基于其他一些答案，但它增加了一些复杂性：

```
def random_password
  specials = ((32..47).to_a + (58..64).to_a + (91..96).to_a + (123..126).to_a).pack('U*').chars.to_a
  numbers  = (0..9).to_a
  alpha    = ('a'..'z').to_a + ('A'..'Z').to_a
  %w{i I l L 1 O o 0}.each{ |ambiguous_character| 
    alpha.delete ambiguous_character 
  }
  characters = (alpha + specials + numbers)
  password = Random.new.rand(8..18).times.map{characters.sample}
  password << specials.sample unless password.join =~ Regexp.new(Regexp.escape(specials.join))
  password << numbers.sample  unless password.join =~ Regexp.new(Regexp.escape(numbers.join))
  password.shuffle.join
end 
```

本质上，它确保密码长度为 8 - 20 个字符，并且至少包含一个数字和一个特殊字符。

* * *

## 回答 #38

> 赞同：1
> 
> 时间：2016-02-24T11:51:09.550

```
10.times do 
  alphabet = ('a'..'z').to_a
  string += alpha[rand(alpha.length)]
end 
```

* * *

## 回答 #39

> 赞同：1
> 
> 时间：2016-05-19T20:11:32.073

对于设计secure_validatable，您可以使用它

(0...8).map { ([65, 97].sample + rand(26)).chr }.push(rand(99)).join

* * *

## 回答 #40

> 赞同：1
> 
> 时间：2018-08-08T15:26:39.403

这是@Travis R 答案的改进：

```
 def random_string(length=5)
    chars = 'abdefghjkmnpqrstuvwxyzABDEFGHJKLMNPQRSTUVWXYZ'
    numbers = '0123456789'
    random_s = ''
    (length/2).times { random_s << numbers[rand(numbers.size)] }
    (length - random_s.length).times { random_s << chars[rand(chars.size)] }
    random_s.split('').shuffle.join
  end 
```

在@Travis R 回答字符和数字在一起，所以有时`random_string`可能只返回数字或只返回字符。通过这种改进，至少有一半`random_string`是字符，其余的是数字。以防万一您需要带有数字和字符的随机字符串

* * *

## 回答 #41

> 赞同：0
> 
> 时间：2008-09-17T22:28:35.700

把你的第一个变成一个陈述：

```
(0...8).collect { |n| value  << (65 + rand(25)).chr }.join() 
```

* * *

## 回答 #42

> 赞同：0
> 
> 时间：2010-05-25T20:01:17.107

```
`pwgen 8 1`.chomp 
```

* * *

## 回答 #43

> 赞同：0
> 
> 时间：2013-04-03T14:18:55.440

如果需要，创建一个空字符串或前缀：

```
myStr = "OID-" 
```

使用此代码用随机数填充字符串：

```
begin; n = ((rand * 43) + 47).ceil; myStr << n.chr if !(58..64).include?(n); end while(myStr.length < 12) 
```

笔记：

```
(rand * 43) + 47).ceil 
```

它将生成 48-91 (0,1,2..Y,Z) 的随机数

```
!(58..64).include?(n) 
```

它用于跳过特殊字符（因为我不想包含它们）

```
while(myStr.length < 12) 
```

它将生成总共 12 个字符的长字符串，包括前缀。

样本输出：

```
"OID-XZ2J32XM" 
```

* * *

## 回答 #44

> 赞同：0
> 
> 时间：2013-07-30T14:30:21.643

这是一个灵活且允许重复的解决方案：

```
class String
  # generate a random string of length n using current string as the source of characters
  def random(n)
    return "" if n <= 0
    (chars * (n / length + 1)).shuffle[0..n-1].join  
  end
end 
```

例子：

```
"ATCG".random(8) => "CGTGAAGA" 
```

您还可以允许某个字符更频繁地出现：

```
"AAAAATCG".random(10) => "CTGAAAAAGC" 
```

说明：上述方法采用给定字符串的字符并生成足够大的数组。然后它对其进行洗牌，获取前 n 个项目，然后加入它们。

* * *

## 回答 #45

> 赞同：0
> 
> 时间：2014-04-26T12:22:23.387

```
Array.new(8).inject(""){|r|r<<('0'..'z').to_a.shuffle[0]}  # 57
(1..8).inject(""){|r|r<<('0'..'z').to_a.shuffle[0]}        # 51
e="";8.times{e<<('0'..'z').to_a.shuffle[0]};e              # 45
(1..8).map{('0'..'z').to_a.shuffle[0]}.join                # 43
(1..8).map{rand(49..122).chr}.join                         # 34 
```

* * *

## 回答 #46

> 赞同：0
> 
> 时间：2016-08-31T09:58:52.833

```
a='';8.times{a<<[*'a'..'z'].sample};p a 
```

或者

```
8.times.collect{[*'a'..'z'].sample}.join 
```

* * *

## 回答 #47

> 赞同：0
> 
> 时间：2018-11-06T12:14:35.390

使用 'SafeRandom' Gem [GithubLink](https://github.com/rpatil/safe_random)

它将提供为 Rails2、Rails 3、Rails 4、Rails 5 兼容生成随机值的最简单方法。

* * *

## 回答 #48

> 赞同：-1
> 
> 时间：2008-09-17T22:32:34.643

这几乎是丑陋的，但也许是朝着正确方向迈出的一步？

```
 (1..8).map{|i| ('a'..'z').to_a[rand(26)]}.join 
```

* * *

## 回答 #49

> 赞同：-1
> 
> 时间：2009-07-21T04:20:31.033

在 ruby​​ 1.9 中，可以使用 Array 的选择方法，该方法从数组中返回随机元素

* * *

## 回答 #50

> 赞同：-11
> 
> 时间：2008-09-17T22:29:33.467

我不知道 ruby​​，所以我不能给你确切的语法，但我会用可接受的字符列表设置一个常量字符串，然后使用子字符串运算符从中挑选一个随机字符。

这里的好处是，如果字符串应该是用户可输入的，那么您可以排除容易混淆的字符，如 l 和 1 和 i、0 和 O、5 和 S 等。

# python - 如何使用 assertRaises() 对 python 类的 __init__() 方法进行单元测试？

> ID：88325
> 
> 赞同：31
> 
> 时间：2008-09-17T22:26:37.467
> 
> 标签：python, unit-testing, exception

我有一堂课：

```
class MyClass:
def __init__(self, foo):
    if foo != 1:
        raise Error("foo is not equal to 1!") 
```

一个单元测试应该确保传递给构造函数的不正确的参数正确地引发了一个错误：

```
def testInsufficientArgs(self):
    foo = 0
    self.assertRaises((Error), myClass = MyClass(Error, foo)) 
```

但我得到...

```
NameError: global name 'Error' is not defined 
```

为什么？我应该在哪里定义这个错误对象？我认为它是作为默认异常类型内置的，不是吗？

* * *

## 回答 #1

> 赞同：29
> 
> 时间：2008-09-17T22:29:33.013

此示例中的“错误”可以是任何异常对象。我想您可能已经阅读了一个代码示例，该示例将其用作元语法占位符来表示“适当的异常类”。

所有异常的基类称为'Exception'，它的大多数子类都是所涉及的错误类型的描述性名称，例如'OSError'、'ValueError'、'NameError'、'TypeError'。

在这种情况下，适当的错误是“ValueError”（foo 的值是错误的，因此是 ValueError）。我建议在您的脚本中将 'Error' 替换为 'ValueError'。

这是您尝试编写的代码的完整版本，我正在复制所有内容，因为您在原始示例中有一个奇怪的关键字参数，您似乎正在与作业混为一谈，并且我正在使用“failUnless”功能name 因为这是函数的非别名名称：

```
class MyClass:
    def __init__(self, foo):
        if foo != 1:
            raise ValueError("foo is not equal to 1!")

import unittest
class TestFoo(unittest.TestCase):
    def testInsufficientArgs(self):
        foo = 0
        self.failUnlessRaises(ValueError, MyClass, foo)

if __name__ == '__main__':
    unittest.main() 
```

输出是：

```
.
----------------------------------------------------------------------
Ran 1 test in 0.007s

OK 
```

单元测试库“unittest”中存在其他单元测试框架修复的缺陷。您会注意到，不可能从调用上下文中访问异常对象。如果要解决此问题，则必须在 UnitTest 的子类中重新定义该方法：

这是它的一个使用示例：

```
class TestFoo(unittest.TestCase):
    def failUnlessRaises(self, excClass, callableObj, *args, **kwargs):
        try:
            callableObj(*args, **kwargs)
        except excClass, excObj:
            return excObj # Actually return the exception object
        else:
            if hasattr(excClass,'__name__'): excName = excClass.__name__
            else: excName = str(excClass)
            raise self.failureException, "%s not raised" % excName

    def testInsufficientArgs(self):
        foo = 0
        excObj = self.failUnlessRaises(ValueError, MyClass, foo)
        self.failUnlessEqual(excObj[0], 'foo is not equal to 1!') 
```

我已经从 python2.5 的 unittest.py 中复制了 failUnlessRaises 函数，并对其稍作修改。

* * *

## 回答 #2

> 赞同：6
> 
> 时间：2008-09-17T22:32:16.657

这个怎么样：

```
class MyClass:
    def __init__(self, foo):
        if foo != 1:
            raise Exception("foo is not equal to 1!")

import unittest

class Tests(unittest.TestCase):
    def testSufficientArgs(self):
        foo = 1
        MyClass(foo)

    def testInsufficientArgs(self):
        foo = 2
        self.assertRaises(Exception, MyClass, foo)

if __name__ == '__main__':
    unittest.main() 
```

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2008-09-17T22:30:21.110

我认为您正在考虑[Exception](http://docs.python.org/lib/module-exceptions.html)。将描述中的错误一词替换为异常，您应该一切顺利:-)

# asp.net - elmah 是否也处理捕获的异常

> ID：88326
> 
> 赞同：55
> 
> 时间：2008-09-17T22:26:45.610
> 
> 标签：asp.net, .net, exception-handling, elmah

即使异常没有冒泡到应用程序，[ELMAH](http://elmah.github.io/)是否也会记录异常？我想在发生异常时弹出一条消息并仍然记录异常。目前我一直在尝试捕获块并吐出消息，但这变得乏味。

* * *

## 回答 #1

> 赞同：129
> 
> 时间：2009-05-08T19:33:36.887

ELMAH has been updated to support a new feature called [Signaling](https://code.google.com/p/elmah/wiki/DotNetSlackersArticle#Error_Signaling).

This allows you to handle exceptions how you want, while still logging them to ELMAH.

```
try
{
    int i = 5;
    int j = 0;
    i = i / j; //Throws exception
}
catch (Exception ex)
{
    MyPersonalHandlingCode(ex);
    ErrorSignal.FromCurrentContext().Raise(ex); //ELMAH Signaling
} 
```

Re-throwing exceptions can be a bad practice as it makes it difficult to trace the flow of an application. Using Signaling is a much better approach if you intended to handle the error in some fashion and simply want to document it.

Please check out this excellent guide by [DotNetSlackers on ELMAH](http://dotnetslackers.com/articles/aspnet/ErrorLoggingModulesAndHandlers.aspx)

* * *

## 回答 #2

> 赞同：6
> 
> 时间：2012-12-13T00:23:09.420

过滤器是处理这个问题的最干净的方法。在此处检查此解决方案[https://stackoverflow.com/a/5936867/965935](https://stackoverflow.com/a/5936867/965935)

# release - 哪个更好：发布有缺陷的功能还是根本不发布该功能？

> ID：88339
> 
> 赞同：12
> 
> 时间：2008-09-17T22:28:54.047
> 
> 标签：release, release-management

这是一个哲学问题。我正在向我的软件添加一个小功能，我认为大多数用户都会使用它，但他们使用该软件的时间可能只有 10%。换句话说，该软件在没有它 3 个月的情况下还可以，但有 4 或 5 个用户要求它，我同意它应该在那里。

问题是，由于我正在使用的平台的限制（可能是我大脑的限制），“我能做的最好的”仍然有一些非关键但明显的错误 - 假设编码的功能是可用的但在某些情况下“有点不稳定”。

该怎么办？有 90% 的功能真的“聊胜于无”吗？我知道我会收到一些我无法修复的错误报告：我应该告诉客户什么？我应该接受未答复的功能请求或未答复的错误报告吗？

* * *

## 回答 #1

> 赞同：12
> 
> 时间：2008-09-17T22:34:29.727

确保人们知道，你知道，存在问题。有错误。并为他们提供一种简单的方法来提供反馈。

与最初建议该功能的“4 或 5 个用户”进行“封闭测试”怎么样？

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2008-09-17T22:32:42.117

总会有未答复的功能请求和错误报告。发布它，但在可能的情况下包含一个包含“已知问题”和解决方法的自述文件。

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2008-09-17T22:34:45.077

您需要从用户的角度考虑这一点——这会减少挫败感吗？错误的代码通常比缺少功能更令人沮丧。

* * *

## 回答 #4

> 赞同：2
> 
> 时间：2008-09-17T22:36:08.083

完美主义者可能会回答“不要这样做”。

商务人士可能会回答“做”。

我想平衡在哪里取决于你。如果错误不严重，我会倾向于将功能放在那里。大多数用户不会以与您相同的方式看待您的软件。你是一个工匠/艺术家，这意味着你比普通人更挑剔。

有什么方法可以让 4 到 5 个请求该功能的人获得测试版？然后，一旦你得到他们的反馈，就可能清楚做出哪个决定。

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2008-09-30T08:06:06.860

如果现在需要一个功能，而不是一个有效的功能。您可能需要发货。

但是在这种情况下：

*   确保记录错误和后果（对用户和其他开发人员）。
*   请务必将错误添加到您的错误跟踪数据库中。
*   如果您编写单元测试（我希望如此），请确保在发布之前编写突出显示错误的测试。这意味着当您将来修复错误时，您无需记住它们就知道它们在哪里以及它们是什么。
*   安排工作尽快修复错误。在编写新代码之前，您确实会修复错误，不是吗？

* * *

## 回答 #6

> 赞同：1
> 
> 时间：2008-09-30T08:16:56.633

如果错误可能导致死亡或可能丢失用户的文件，则不要发布它。

如果错误可能导致应用程序自行崩溃，则将其与警告一起发送（自述文件或其他内容）。如果崩溃可能导致应用程序损坏他们正在使用此应用程序编辑的用户文件，则每次启动应用程序时都会显示警告，并提醒他们先备份文件。

如果错误会导致蓝屏死机，那么要非常小心将其发送给谁。

* * *

## 回答 #7

> 赞同：1
> 
> 时间：2008-09-17T22:43:03.340

我不希望编码人员将已知问题交付给测试，更不用说发布给客户了。

请注意，我相信对错误的零容忍。有趣的是，我发现通常是开发人员/测试人员最热衷于消除所有错误——通常是项目经理和/或客户愿意接受错误。

如果您必须发布代码，请记录您知道的每个功能/错误，并承诺修复每个功能/错误。

您为什么不发布更多有关您正在使用的平台的限制的信息，也许这里的一些聪明人可以帮助您列出错误列表。

* * *

## 回答 #8

> 赞同：1
> 
> 时间：2008-09-17T22:33:22.053

准确地记录不稳定并运送它。
确保用户可能会*看到*并*理解*您的不稳定文档。

您甚至可以与请求该功能的用户讨论决定：做一些市场调查。

只是因为你现在不能修复它，并不意味着你将来不能。事情会改变的。

* * *

## 回答 #9

> 赞同：1
> 
> 时间：2008-09-17T22:33:36.640

将您现在拥有的内容标记为“测试版”并将其发送给那些要求它的人。获得他们对它的工作情况的反馈，解决他们抱怨的任何问题，然后你应该准备好将它推广给更大的用户群体。

* * *

## 回答 #10

> 赞同：1
> 
> 时间：2008-09-17T22:36:02.030

尽早发布，经常发布，不断重构。

我的意思是，不要让它阻止你发货，但也不要放弃解决问题。

无法解决不稳定是代码库中存在问题的标志。花更多的时间重构而不是添加功能。

* * *

## 回答 #11

> 赞同：1
> 
> 时间：2008-09-17T22:36:55.633

我想这取决于你的标准。对我来说，有缺陷的代码还没有准备好生产，所以不应该发布。您能否提供一个包含已知问题列表的测试版，以便用户知道在某些条件下会发生什么？他们从使用新功能中受益，但也知道它并不完美（使用他们自己的风险）。这可能会让请求该功能的 4 或 5 个客户暂时满意，从而让您有更多时间修复错误（如果可能）并稍后发布到生产环境中供大众使用。

只是一些想法取决于你的情况。

* * *

## 回答 #12

> 赞同：1
> 
> 时间：2008-09-17T22:39:17.733

要看。关于错误，它们的严重性以及您认为修复它们需要付出多少努力。在截止日期以及您认为可以延长多少时间。关于其余代码以及客户可以用它做多少。

* * *

## 回答 #13

> 赞同：0
> 
> 时间：2008-09-30T08:54:31.130

来自必须为其用户安装错误软件的人 - 不要在启用该功能的情况下发布它。

如果您记录它并不重要，最终用户会在他们第一次遇到该错误时忘记该错误，并且该错误将成为他们无法完成工作的关键。

* * *

## 回答 #14

> 赞同：0
> 
> 时间：2008-09-17T22:44:17.923

您需要回答的一个重要问题是，根据您提出的设计，您的功能是否能够解决真正的业务需求。然后只需使实现与设计相匹配 - 通过将“错误”定义为不属于功能的预期行为的一部分（应该由设计涵盖）来使“错误”成为非错误。

这归结为一个非常真实的路径选择：一个错误是不是不能正常工作，不是预期行为和设计的一部分？还是仅当不按照预期行为工作时才出现错误？

我坚信后者；错误是不能按照预期工作的方式工作的事情。实现应该捕获设计，应该捕获业务需求。如果实现用于解决设计未涵盖的不同业务需求，则错误在于设计，而不是实现；因此它不是一个错误。

根据我的经验，前一种态度在程序员中是最常见的。这也是用户查看软件问题的方式。然而，从软件开发的角度来看，采用这种观点并不是一个好主意，因为它会导致您修复不是错误而是设计缺陷的错误，而不是重新设计解决方案以满足业务需求。

* * *

## 回答 #15

> 赞同：0
> 
> 时间：2008-09-17T22:34:50.240

如果它没有破坏其他任何东西，为什么不发货呢？听起来您与客户的关系很好，所以想要这个功能的人会很高兴得到它，即使它不是完全在那里，而那些不想要它的人也不会在意。此外，您将获得大量反馈以在下一个版本中改进它！

# visual-studio - 如何在 Visual Studio 2005 中获得错误标记代码的 Intellisense？

> ID：88343
> 
> 赞同：0
> 
> 时间：2008-09-17T22:29:17.103
> 
> 标签：visual-studio, visual-studio-2005

当我尝试在 VS 2005 上编译代码但它失败时，导致错误的行带有蓝色下划线，并且将鼠标悬停在它上面会显示错误消息。很好，但是您看不到对象类型或其他内容，因为 Intellisense 将显示错误消息，而不是对象信息。

在这张图片中，我想看看`DateTime.Subtract()`返回什么类型，但 VS 坚持显示错误消息：

[替代文字 http://img502.imageshack.us/img502/6962/vs2005errordl7.png](http://img502.imageshack.us/img502/6962/vs2005errordl7.png)

**一旦你受够了**错误信息，有谁知道如何消除错误信息？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2008-10-04T21:51:50.473

将行的第一部分（“DateTime duracao =”）剪切到剪贴板，然后您应该能够将鼠标悬停在“减去”上并查看返回类型。不理想，但我发现自己一直在这样做！

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2008-10-23T03:45:44.793

选择“Build|Clean Solution”——这会清理中间文件和其他东西。更重要的是，它还清除了错误消息列表，恢复了 Intellisense 的正常行为。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2008-09-17T22:31:00.233

括号内的 ctrl-空格

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2008-09-17T22:46:09.293

我刚刚发现相当于鼠标悬停的是`View -> IntelliSense -> Quick Info`. 如果这里没有出现解决方案，我将使用快捷方式`Ctrl+K, Ctrl+I`。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2008-10-30T22:16:32.543

由于 duracao 是一个日期时间，并且错误消息是“无法将**时间跨度**转换为**日期时间”** - 您已经可以看到减法函数正在返回一个时间跨度

# c# - 什么是最好的 C# 到 VB.net 转换器？

> ID：88359
> 
> 赞同：43
> 
> 时间：2008-09-17T22:30:34.230
> 
> 标签：c#, vb.net, converter

在网上搜索我的 VB.net 问题的解决方案时，我经常会找到有关特定主题的有用文章，但代码是 C#。这不是什么大问题，但是手动将其转换为 VB 需要一些时间。有一些网站提供从 C# 到 VB 的代码转换器，反之亦然，但在代码转换后修复所有缺陷几乎和我自己做一样耗时。

直到现在我正在使用[http://labs.developerfusion.co.uk/convert/csharp-to-vb.aspx](http://labs.developerfusion.co.uk/convert/csharp-to-vb.aspx)

你知道更好的吗？

* * *

## 回答 #1

> 赞同：23
> 
> 时间：2008-09-17T22:36:41.547

Telerik 有[一个很好的转换器](http://converter.telerik.com/)，它基于 SharpDevelop，多年来运行良好，尽管它多年来没有更新（因为它基于 SharpDevelop）。

我最近也遇到了一个[基于 roslyn 的转换器](http://web.archive.org/web/20180312203225/http://roslyncodeconverter.azurewebsites.net:80/)。我不知道它工作得如何或维护得如何，但由于它是开源的，你可以随时 fork 并根据需要更新它。

* * *

## 回答 #2

> 赞同：18
> 
> 时间：2008-09-17T22:35:33.437

如果找不到好的转换器，可以随时编译 c# 代码并使用[Reflector](http://www.red-gate.com/products/reflector/)中的反汇编器来查看 Visual Basic 代码。一些变量名会改变。

* * *

## 回答 #3

> 赞同：13
> 
> 时间：2012-11-15T13:51:19.287

我目前最常使用这两个：

[http://converter.telerik.com/](http://converter.telerik.com/)

[http://www.carlosag.net/tools/codetranslator/](http://www.carlosag.net/tools/codetranslator/)

但在其他方面也取得了一些成功：

[http://converter.atomproject.net/](http://converter.atomproject.net/)

[http://www.dotnetspider.com/convert/Csharp-To-Vb.aspx](http://www.dotnetspider.com/convert/Csharp-To-Vb.aspx)

[http://www.developerfusion.com/tools/convert/csharp-to-vb/](http://www.developerfusion.com/tools/convert/csharp-to-vb/)

* * *

## 回答 #4

> 赞同：12
> 
> 时间：2008-09-17T22:40:18.213

[SharpDevelop](http://www.icsharpcode.net/OpenSource/SD/)有一个内置的 C# 和 VB.NET 之间的转换器。不是完美的想法（例如 VB.NET 中的可选值在 C# 中没有等效值，因此必须编辑转换器方法的签名），但您可以节省一些时间，因为您在 IDE 中进行所有操作而不是网页（复制 C# 代码、粘贴、点击按钮、复制 VB.NET 代码、粘贴到 IDE 上：P）

* * *

## 回答 #5

> 赞同：11
> 
> 时间：2008-09-22T10:27:59.733

我认为最好的办法是学习足够的其他语言，以便您可以手动重写，在某些方面存在一些相当困难的差异，我不确定转换器是否能很好地处理。例如，比较我从 C# 到 VB 的以下翻译：

```
public class FileSystemEventSubscription : EventSubscription
{
    private FileSystemWatcher fileSystemWatcher;

    public FileSystemEventSubscription(IComparable queueName, 
        Guid workflowInstanceId, FileSystemWatcher fileSystemWatcher) : base(queueName, workflowInstanceId)
    {
        this.fileSystemWatcher = fileSystemWatcher;
    } 
```

变成

```
Public Class FileSystemEventSubscription
    Inherits EventSubscription  
    Private myFileSystemWatcher As FileSystemWatcher
    Public Sub New(ByVal QueueName As IComparable, ByVal WorkflowInstanceID As Guid, ByVal Watcher As FileSystemWatcher)
        MyBase.New(QueueName, WorkflowInstanceID)
        Me.myFileSystemWatcher = Watcher
    End Sub 
```

C# 来自自定义活动框架示例，恐怕我已经失去了它的链接。但它包含一些看起来很讨厌的继承（从 VB 的角度来看）。

* * *

## 回答 #6

> 赞同：5
> 
> 时间：2014-05-07T08:48:35.877

[我正在使用名为Language Convert](http://visualstudiogallery.msdn.microsoft.com/cc8da841-f978-4c3e-8397-c820bd57298c)的免费 Visual Studio 2012 插件

它在 2010/2012 上完美运行，不幸的是还没有在 VS 2013 上运行。

转换不是 100% 准确，但绝对是非常有帮助的，第一次启动有点棘手，请检查下图：![在此处输入图像描述](https://i.stack.imgur.com/5CQ8H.gif)

* * *

## 回答 #7

> 赞同：4
> 
> 时间：2008-09-17T22:40:11.820

最后我检查了一下，[SharpDevelop](http://www.icsharpcode.net/OpenSource/SD/)有一个，它也是开源的。

* * *

## 回答 #8

> 赞同：3
> 
> 时间：2008-09-27T16:53:29.303

您可以将您的 DLL 或 EXE 加载到 Redgate（以前是 Lutz Roeder 的）的[.Net Reflector](http://www.red-gate.com/products/reflector/)中，选择您的方法，然后从语言组合中选择所需的语言。所选方法的代码将以所选语言显示。

我希望这有帮助。

* * *

## 回答 #9

> 赞同：3
> 
> 时间：2012-03-28T18:28:03.017

你可以试试这个[转换器](http://converter.atomproject.net/)。有 C# 到 VB 和 VB 到 C# 的功能。

希望这可以帮助。

* * *

## 回答 #10

> 赞同：2
> 
> 时间：2008-09-17T22:54:46.103

Carlos Aguilar Mares 已经有一个在线转换器大约 40 个永远 -[代码翻译器，](http://www.carlosag.net/Tools/CodeTranslator/Default.aspx) **但我同意 Reflector 是更好的答案。**

* * *

## 回答 #11

> 赞同：2
> 
> 时间：2008-09-18T09:42:26.780

虽然没有回答你的问题，但我会说我一直处于类似的位置。

当我真正开始使用 .NET 时，我意识到 C# 中的代码示例很尴尬，但是在我的第一个项目几周​​后（在我更加熟悉 .NET 框架和 VB.NET 本身之后），我发现它是必须对 C# 代码进行逆向工程，这很有趣，有时也是有益的。不仅在语法方面，而且还学习方法上的细微差别——在这方面保持开放的心态很有用。

随着我对该框架的了解越来越多，我坚持使用 VB.NET，但不久之后，我将深入研究 C#，以期成为“多语言”。

* * *

## 回答 #12

> 赞同：2
> 
> 时间：2008-09-22T09:56:42.320

目前我使用我在 CodeProject ( [http://www.codeproject.com/KB/cs/Code_convert_add-in.aspx](http://www.codeproject.com/KB/cs/Code_convert_add-in.aspx) ) 上找到的 VS2005 插件；它使用外部服务（[http://www.carlosag.net/Tools/CodeTranslator/](http://www.carlosag.net/Tools/CodeTranslator/)）来执行翻译。

有时，当我离线时，我会使用转换器工具 ( [http://www.kamalpatel.net/ConvertCSharp2VB.aspx](http://www.kamalpatel.net/ConvertCSharp2VB.aspx) )。

* * *

## 回答 #13

> 赞同：1
> 
> 时间：2008-09-27T16:41:05.977

http://www.developerfusion.com/tools/convert/csharp-to-vb/ （新[网址](http://www.developerfusion.com/tools/convert/csharp-to-vb/)）上的那个现在支持.NET 3.5 语法（再次感谢#develop 家伙），并将自动复制结果到你的剪贴板:)

# c# - 有没有一种优雅的方式来使用 ASP.NET 验证器来比较复选框和文本框？

> ID：88361
> 
> 赞同：4
> 
> 时间：2008-09-17T22:30:56.973
> 
> 标签：c#, .net, asp.net, validation

我有一个 Asp.Net 中继器，其中包含一个文本框和一个复选框。我需要添加客户端验证，以验证选中复选框时，文本框只能接受零值或空白值。

我想使用一个或多个 Asp.Net 的验证器控件来完成此操作，为客户端错误提供一致的显示（服务器端错误由另一个子系统处理）。

Asp:CompareValidator 似乎不够灵活，无法执行这种复杂的比较，所以我只看 Asp:CustomValidator。

我遇到的问题是似乎没有任何方法可以将自定义信息传递到验证函数中。这是一个问题，因为复选框和文本框的 ClientId 在运行时对我来说是未知的（因为它们是中继器的一部分）。

所以......我的选择似乎是：

1.  以某种方式将文本框和复选框传递给 CustomValidator（似乎不可能）。
2.  根据 CustomValidator 传入的参数，通过 JavaScript 查找 TextBox。这甚至可能吗？ ClientId 不明确怎么办？
3.  完全忘记验证，并发出自定义 JavaScript（允许我将两个 ClientId 都传递给自定义函数）。

关于什么可能是更好的实现方式的任何想法？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2008-09-17T22:38:54.303

我认为最好的方法是在新类中继承 BaseValidator，并将这些 ID 作为属性传递给您的控件。您应该能够在验证器中解析 ID，而无需知道在运行时生成的完整客户端 ID。您应该首先在服务器上验证数据，然后在客户端上验证。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2008-09-17T22:34:50.770

不能把 CustomValidator 放在中继器里面吗？如果没有，您可以在绑定转发器和用户 FindControl() 时动态创建它

```
protected MyDataBound(object sender, RepeaterItemEventArgs e) {
  (CheckBox)cb = (CheckBox)e.Item.FindControl("myCheckboxName");
  (TextBox)tb = (TextBox)e.Item.FindControl("myTextBox");
} 
```

...或类似的东西。我在脑海中完成了代码。

# sql-server - SQLServer tempDB 无限增长

> ID：88381
> 
> 赞同：0
> 
> 时间：2008-09-17T22:34:25.390
> 
> 标签：sql-server, database

我们有几个*“生产环境”*（每台三台服务器，我们的系统版本相同。每台都有一个 SQL Server 数据库作为生产数据库）。

在其中一种环境中，*tempdb*事务日志开始快速无限增长，我们找不到原因。相同版本的 SO、SQL Server、应用程序。环境没有变化。

有人知道如何弄清楚发生了什么，或者如何解决这个问题？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2008-09-17T22:40:40.600

您可能处于完全恢复模式模式 - 如果您正在执行定期备份，您可以将其更改为简单，它将在备份后减小日志的大小。

这是[更多信息](http://support.microsoft.com/kb/873235)。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2008-09-17T22:42:01.143

您是否尝试过运行 Profiler？这将允许您查看服务器上所有正在运行的查询。这可能会让您对在 tempdb 中创建项目的内容有所了解。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-06-01T04:55:56.363

好的，我想这个问题和我的一样。tempdb 增长很快。常见的原因是程序员创建了过程，并使用了临时表。当我们创建这些表，或者其他操作，如触发器、dbcc 命令时，它们都使用 tempdb。创建临时表，sqlserver会为表分配空间，如GAM、SGAM或IAM，但sqlserver必须保证物理一致性，所以每次只能一个人做，其他对象必须等待。这导致 tempdb 快速增长。我从MS那里找到了解决方案，大概就是这样，希望能帮到你： 1.为tempdb创建数据文件，数量与CPU相同，ec：你的主机有16cpu，你需要为tempdb创建16个日期文件。并且每个文件必须具有相同的大小。2.你需要监控这些文件，确保它们没有满。3.如果这些文件空间不够大，

我的英语不好，如果你不能解决它，使用程序 sp_helpfile ，检查它。并将结果粘贴到此处。当我在新加坡时，我发现了这种情况。祝你好运。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2008-09-17T22:43:19.813

最好的办法是启动 SQL Server Profiler 并查看发生了什么。在“Writes”列或 Spool 运算符中寻找高值，这些都可能导致高温使用。

如果只是事务日志在增长，那么试试这个，打开的事务会阻止日志在运行时被缩小。这应该在 tempdb 中运行：

```
DBCC OPENTRAN 
```

# user-interface - 我从哪里开始学习 GUI 编程？

> ID：88382
> 
> 赞同：21
> 
> 时间：2008-09-17T22:34:29.570
> 
> 标签：user-interface

我对 C/C++、Java、Python 等编程语言有很好的了解。但他们大多是在大学/高中教室环境中学习的，其中最好的用户界面是带编号的菜单。你知道的，标准数据结构，各种算法的实现，文件处理等等。

我现在想做的是进入 GUI 编程。我不确定我问的方法是否正确，但我正在考虑使用 WIMP 范例（Windows 图标菜单指针）。我想放置按钮和表单。事件驱动编程，我相信是正确的词，我的应用程序等待用户点击某些东西，输入某些东西等。

鉴于我的背景，从哪里开始比较好？我正在查看以下要求 -

1> 最好是跨平台。2> 大量的文档、教程和示例代码，如果可能的话，我可以从中学习 3> 一个好的 GUI 构建器工具，我可以在其中以我希望它们显示的方式拖放内容。

有什么想法或建议让我开始吗？

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2008-09-17T22:47:31.880

我会试试这本书[About face: Essential of User Interface Design](https://rads.stackoverflow.com/amzn/click/com/1568843224)，它集中在 UI 的设计实践以及考虑到用户目标的设计上，也就是说，用户想要完成什么，试图让你远离“开发人员 GUI 设计”。

它还回顾了微软、苹果和其他公司关于 GUI 设计的一些历史。诸如 MacOsX 的默认设置（通常位于接受和取消按钮的位置等）以及其下方的原因。

我还将查找 Microsoft 的[Office 2007 UI 设计指南](http://www.microsoft.com/downloadS/details.aspx?FamilyID=68fc3e77-871c-4b14-915c-1cb029e63cca&displaylang=en)，因为它可能“将成为一件事”。

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2008-09-17T22:41:09.507

[Shoes](http://shoesrb.com/) for Ruby 是跨平台的，非常简单，是对构建窗口和处理其中发生的事件的简要介绍。也很有趣:)

* * *

## 回答 #3

> 赞同：3
> 
> 时间：2008-09-17T23:46:38.930

有大量语言和 UI 框架特定资源可供对构建应用程序 UI 感兴趣的人使用。然而，在深入研究特定技术之前，有很多关于人机交互以及它如何应用于用户界面设计的知识。一些参考资料：

*   [http://www.useit.com/](http://www.useit.com/)
*   [日常用品的设计（书）](https://rads.stackoverflow.com/amzn/click/com/0465067107)
*   [http://worrydream.com/MagicInk](http://worrydream.com/MagicInk/)（需要一段时间才能加载，但**非常**值得）

在研究*了什么*是好的 UI 之后，是时候探索*如何*：

*   [Mozilla XULRunner](http://developer.mozilla.org/en/XULRunner)
*   如果你决定使用[Java Swing](http://java.sun.com/docs/books/tutorial/ui/index.html)，我强烈推荐[相关的布局管理器](http://www.onjava.com/pub/a/onjava/2002/09/18/relativelayout.html)

当然有很多选择，包括[QT](http://en.wikipedia.org/wiki/Qt_(toolkit))、[Fltk](http://www.fltk.org/)和[SWT](http://www.developer.com/java/other/article.php/3330861)

* * *

## 回答 #4

> 赞同：3
> 
> 时间：2008-09-17T22:43:01.530

您正在寻找[Qt](http://trolltech.com/products/qt)。它是一个跨平台的 C++ GUI 框架，它包括您所要求的一切以及更多。

只要您使用 GPL，开源项目就可以免费使用它。

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2008-09-17T22:41:45.903

我最近也在想同样的事情。 [Qt](http://trolltech.com/products/qt)似乎是一个很好的跨平台 GUI 框架，而 Python 似乎是一种很好的工作语言。

所以[PyQt](http://wiki.python.org/moin/PyQt)是我的（未受过教育的）建议。它确实包括一个拖放式 GUI 设计工具。

* * *

## 回答 #6

> 赞同：1
> 
> 时间：2008-09-17T23:16:05.367

看看[Glade](http://glade.gnome.org)和[Gtk](http://www.gtk.org)。两者都非常易于使用。Glade 是 GUI 构建器，而 Gtk 是工具包。它既是跨平台的，也是跨语言的。您可以加载几乎任何语言的 Glade 文件。这是一个[Glade/Gtk 教程](http://www.micahcarrick.com/12-24-2007/gtk-glade-tutorial-part-1.html)

* * *

## 回答 #7

> 赞同：0
> 
> 时间：2008-09-17T22:41:56.620

鉴于您已经了解 Java，您应该在[这里](http://java.sun.com/docs/books/tutorial/uiswing/ "这里")查看 Swing API ，它提供了一组非常强大的包，可用于创建复杂的 GUI。此外，它的跨平台，有大量的文档，它可以与 Netbeans IDE 一起使用。

* * *

## 回答 #8

> 赞同：0
> 
> 时间：2008-09-17T22:42:49.223

Java 的 Swing API 是跨平台的并且相对简单，而 NetBeans 是一个很好的 GUI 构建器。

* * *

## 回答 #9

> 赞同：0
> 
> 时间：2008-09-17T22:39:54.317

我会研究 C# .NET 开发及其[WinForms](http://en.wikipedia.org/wiki/Windows_Forms) API。使用它为 Windows 编写 GUI 桌面应用程序比使用 Win32 API 容易得多。如果它仍然相关，您以后可以随时轻松进入 Win32 API 内容。

对于跨平台解决方案，请查看[Gtk+](http://www.gtk.org/)，也许是[PyGtk](http://www.pygtk.org/)。另一个不错的是[WxWidgets](http://www.wxwidgets.org/)。

如果您想变得非常时髦，请查看为 Ruby 设计的[鞋子](http://shoooes.net/)。

* * *

## 回答 #10

> 赞同：0
> 
> 时间：2008-09-17T22:40:24.393

许多年前，我使用 Visual Basic 在这方面取得了最快的进展。我认为它仍然很容易上手，并且代码/运行/调试周期非常高效，你会很快学到很多有用的东西。大量文档，以及您想要的所有其他好东西......

* * *

## 回答 #11

> 赞同：0
> 
> 时间：2013-03-10T18:20:01.483

Netbeans 是跨平台的，虽然它以 Java 开发人员为中心，但您可以轻松安装插件以使用 C/C++、Ruby 等。我用它来开发 Swing GUI 程序，因为它有一个非常简单的界面，用于简单的拖放图形用户界面创建。有很多关于使用 Java Swing 进行开发的优秀文档，而且我确信也有很多关于使用 Netbeans 的文档。

# emacs - 如何在 Emacs 中复制整行？

> ID：88399
> 
> 赞同：169
> 
> 时间：2008-09-17T22:36:33.030
> 
> 标签：emacs, text, editor, editing, command

我在 VIM 上看到[了同样的问题](https://stackoverflow.com/questions/73319/duplicate-a-whole-line-in-vim#73357)，我自己也想知道如何为 Emacs 做这件事。在 ReSharper 中，我使用 CTRL-D 来执行此操作。在 Emacs 中执行此操作的最少命令数是多少？

* * *

## 回答 #1

> 赞同：156
> 
> 时间：2008-09-17T23:42:30.577

我用

```
C-a C-SPACE C-n M-w C-y 
```

分解为

*   `C-a`: 将光标移动到行首
*   `C-SPACE`：开始选择（“设置标记”）
*   `C-n`: 移动光标到下一行
*   `M-w`: 复制区域
*   `C-y`：粘贴（“猛拉”）

之前所提

```
C-a C-k C-k C-y C-y 
```

等同于同一件事 (TMTOWTDI)

*   `C-a`: 将光标移动到行首
*   `C-k`：剪切（“杀死”）该行
*   `C-k`: 剪切换行符
*   `C-y`: paste ("yank") （我们回到第一格）
*   `C-y`: 再次粘贴（现在我们有两个副本）

与您的编辑器相比，这些都非常冗长`C-d`，但在 Emacs 中始终存在自定义。`C-d`默认情况下是绑定`delete-char`的，那么`C-c C-d`呢？只需将以下内容添加到您的`.emacs`：

```
(global-set-key "\C-c\C-d" "\C-a\C- \C-n\M-w\C-y") 
```

（@Nathan 的 elisp 版本可能更可取，因为如果更改任何键绑定，它不会中断。）

当心：某些 Emacs 模式可能会回收`C-c C-d`做其他事情。

* * *

## 回答 #2

> 赞同：102
> 
> 时间：2008-09-18T00:08:14.463

除了前面的答案，您还可以定义自己的函数来复制一行。例如，将以下内容放入您的 .emacs 文件将使 Cd 复制当前行。

```
(defun duplicate-line()
  (interactive)
  (move-beginning-of-line 1)
  (kill-line)
  (yank)
  (open-line 1)
  (next-line 1)
  (yank)
)
(global-set-key (kbd "C-d") 'duplicate-line) 
```

* * *

## 回答 #3

> 赞同：75
> 
> 时间：2008-09-17T22:42:50.890

将光标放在行上，如果不是在开头做`CTRL`- `A`，那么：

`CTRL`-`K`

`CTRL`-`K`

`CTRL`-`Y`

`CTRL`-`Y`

* * *

## 回答 #4

> 赞同：54
> 
> 时间：2009-06-15T21:23:57.237

我的复制行的函数版本与撤消配合得很好，并且不会弄乱光标位置。这是[1997 年 11 月在 gnu.emacs.sources 中讨论](http://groups.google.com/group/gnu.emacs.sources/browse_thread/thread/c5f2992c108abd76/2810ac8f4fca534c?lnk=gst&q=steiner#2810ac8f4fca534c)的结果。

```
(defun duplicate-line (arg)
  "Duplicate current line, leaving point in lower line."
  (interactive "*p")

  ;; save the point for undo
  (setq buffer-undo-list (cons (point) buffer-undo-list))

  ;; local variables for start and end of line
  (let ((bol (save-excursion (beginning-of-line) (point)))
        eol)
    (save-excursion

      ;; don't use forward-line for this, because you would have
      ;; to check whether you are at the end of the buffer
      (end-of-line)
      (setq eol (point))

      ;; store the line and disable the recording of undo information
      (let ((line (buffer-substring bol eol))
            (buffer-undo-list t)
            (count arg))
        ;; insert the line arg times
        (while (> count 0)
          (newline)         ;; because there is no newline in 'line'
          (insert line)
          (setq count (1- count)))
        )

      ;; create the undo information
      (setq buffer-undo-list (cons (cons eol (point)) buffer-undo-list)))
    ) ; end-of-let

  ;; put the point in the lowest line and return
  (next-line arg)) 
```

然后你可以定义 CTRL-D 来调用这个函数：

```
(global-set-key (kbd "C-d") 'duplicate-line) 
```

* * *

## 回答 #5

> 赞同：52
> 
> 时间：2010-07-08T18:10:45.787

而不是`kill-line`( `C-k`)`C-a` `C-k` `C-k` `C-y` `C-y` 使用[`kill-whole-line`](http://www.gnu.org/software/emacs/manual/html_node/emacs/Killing-by-Lines.html)命令：

```
C-S-Backspace
C-y
C-y 
```

优于的优点`C-k`包括点在线上的位置无关紧要（不像`C-k`需要在线的开头），它还会杀死换行符（再次`C-k`没有做）。

* * *

## 回答 #6

> 赞同：29
> 
> 时间：2011-01-17T19:31:22.300

这是执行此操作的另一个功能。我的版本没有触及杀伤环，光标最终出现在原来的新行上。如果区域处于活动状态（瞬态标记模式），它将复制该区域，否则默认复制该行。如果给定前缀 arg，它还将制作多个副本，如果给定负前缀 arg，它将注释掉原始行（这对于测试不同版本的命令/语句同时保留旧版本很有用）。

```
(defun duplicate-line-or-region (&optional n)
  "Duplicate current line, or region if active.
With argument N, make N copies.
With negative N, comment out original line and use the absolute value."
  (interactive "*p")
  (let ((use-region (use-region-p)))
    (save-excursion
      (let ((text (if use-region        ;Get region if active, otherwise line
                      (buffer-substring (region-beginning) (region-end))
                    (prog1 (thing-at-point 'line)
                      (end-of-line)
                      (if (< 0 (forward-line 1)) ;Go to beginning of next line, or make a new one
                          (newline))))))
        (dotimes (i (abs (or n 1)))     ;Insert N times, or once if not specified
          (insert text))))
    (if use-region nil                  ;Only if we're working with a line (not a region)
      (let ((pos (- (point) (line-beginning-position)))) ;Save column
        (if (> 0 n)                             ;Comment out original with negative arg
            (comment-region (line-beginning-position) (line-end-position)))
        (forward-line 1)
        (forward-char pos))))) 
```

我必须`C-c d`：

```
(global-set-key [?\C-c ?d] 'duplicate-line-or-region) 
```

这不应该被模式或任何东西重新分配，因为`C-c`后面跟着一个（未修改的）字母是为用户绑定保留的。

* * *

## 回答 #7

> 赞同：19
> 
> 时间：2009-02-15T15:35:39.520

Nathan 对您的 .emacs 文件的添加是可行的方法，但可以通过替换来稍微简化

```
 (open-line 1)
  (next-line 1) 
```

和

```
 (newline) 
```

屈服

```
(defun duplicate-line()
  (interactive)
  (move-beginning-of-line 1)
  (kill-line)
  (yank)
  (newline)
  (yank)
)
(global-set-key (kbd "C-d") 'duplicate-line) 
```

* * *

## 回答 #8

> 赞同：9
> 
> 时间：2014-09-27T00:45:45.143

从 melpa 安装重复的东西：

Mx 软件包安装 RET 重复的东西

并将此键绑定添加到[初始化文件](https://www.gnu.org/software/emacs/manual/html_node/elisp/Init-File.html#Init-File)：

(global-set-key (kbd "Mc") '重复的东西)

* * *

## 回答 #9

> 赞同：5
> 
> 时间：2008-10-03T17:25:47.827

我已经`copy-from-above-command`绑定了一个键并使用它。它由 XEmacs 提供，但我不了解 GNU Emacs。

> `copy-from-above-command' 是一个交互式编译的 Lisp 函数
> -- 从 "/usr/share/xemacs/21.4.15/lisp/misc.elc" (copy-from-above-command & optional ARG) 加载
> 
> 文档：**从上一个非空行复制字符**，从点上方开始。复制 ARG 字符，但不要超过该行的末尾。如果没有给出参数，则复制该行的整个其余部分。复制的字符在点之前插入到缓冲区中。

* * *

## 回答 #10

> 赞同：5
> 
> 时间：2009-06-06T10:35:36.397

我不太记得行复制在其他任何地方是如何工作的，但作为前 SciTE 用户，我喜欢 SciTE-way 的一件事：它不会触及光标位置！所以上面所有的食谱对我来说都不够好，这是我的嬉皮版本：

```
(defun duplicate-line ()
    "Clone line at cursor, leaving the latter intact."
    (interactive)
    (save-excursion
        (let ((kill-read-only-ok t) deactivate-mark)
            (toggle-read-only 1)
            (kill-whole-line)
            (toggle-read-only 0)
            (yank)))) 
```

请注意，在过程中实际上没有任何东西被杀死，留下标记和当前选择完好无损。

顺便说一句，当有这个漂亮的'n'clean kill-whole-line thingy（CS-backspace）时，为什么你们这么喜欢摇晃光标？

* * *

## 回答 #11

> 赞同：4
> 
> 时间：2008-09-17T22:39:04.927

因为我不知道，我将用慢球开始这一轮高尔夫：

ctrl-k, y, y

* * *

## 回答 #12

> 赞同：4
> 
> 时间：2009-02-15T17:57:38.150

您可能希望在 .emacs 中拥有的东西是

```
(setq kill-whole-line t) 
```

每当您调用kill-line（即通过Ck）时，它基本上会杀死整行加上换行符。然后无需额外代码，您只需执行 Ca Ck Cy Cy 即可复制该行。它分解为

```
C-a go to beginning of line
C-k kill-line (i.e. cut the line into clipboard)
C-y yank (i.e. paste); the first time you get the killed line back; 
    second time gives the duplicated line. 
```

但是，如果您经常使用它，那么专用键绑定可能是一个更好的主意，但是仅使用 Ca Ck Cy Cy 的优点是您可以在其他地方复制该行，而不是在当前行下方。

* * *

## 回答 #13

> 赞同：4
> 
> 时间：2009-06-30T07:58:01.127

' 我写了我自己的版本`duplicate-line`，因为我不想搞砸杀戮戒指。

```
 (defun jr-duplicate-line ()
    "EASY"
    (interactive)
    (save-excursion
      (let ((line-text (buffer-substring-no-properties
                        (line-beginning-position)
                        (line-end-position))))
        (move-end-of-line 1)
        (newline)
        (insert line-text))))
  (global-set-key "\C-cd" 'jr-duplicate-line) 
```

* * *

## 回答 #14

> 赞同：4
> 
> 时间：2016-12-01T08:21:41.973

有一个名为[Avy](https://github.com/abo-abo/avy)的包它有命令 avy-copy-line。当您使用该命令时，窗口中的每一行都会获得字母组合。然后你只需要输入组合，你就会得到那条线。这也适用于地区。然后你只需要输入两个组合。

在这里你可以看到界面：

[![在此处输入图像描述](https://i.stack.imgur.com/63mnV.png)](https://i.stack.imgur.com/63mnV.png)

* * *

## 回答 #15

> 赞同：3
> 
> 时间：2008-09-17T23:12:41.617

```
C-a C-k C-k C-y C-y 
```

* * *

## 回答 #16

> 赞同：3
> 
> 时间：2009-05-20T21:12:31.200

默认值是可怕的。但是，您可以扩展 Emacs 使其像 SlickEdit 和 TextMate 一样工作，即在未选择文本时复制/剪切当前行：

```
(transient-mark-mode t)
(defadvice kill-ring-save (before slick-copy activate compile)
  "When called interactively with no active region, copy a single line instead."
  (interactive
   (if mark-active (list (region-beginning) (region-end))
     (message "Copied line")
     (list (line-beginning-position)
           (line-beginning-position 2)))))
(defadvice kill-region (before slick-cut activate compile)
  "When called interactively with no active region, kill a single line instead."
  (interactive
   (if mark-active (list (region-beginning) (region-end))
     (list (line-beginning-position)
           (line-beginning-position 2))))) 
```

将上述内容放入`.emacs`. 然后，要复制一行，`M-w`. 要删除一行，`C-w`. 要复制一行，`C-a M-w C-y C-y C-y ...`.

* * *

## 回答 #17

> 赞同：3
> 
> 时间：2010-07-08T22:01:31.350

我喜欢 FraGGod 的版本，除了两件事：（1）它不检查缓冲区是否已经是只读的`(interactive "*")`，（2）如果最后一行是空的，它在缓冲区的最后一行失败（因为你在这种情况下无法终止该行），使您的缓冲区保持只读状态。

我进行了以下更改以解决该问题：

```
(defun duplicate-line ()
  "Clone line at cursor, leaving the latter intact."
  (interactive "*")
  (save-excursion
    ;; The last line of the buffer cannot be killed
    ;; if it is empty. Instead, simply add a new line.
    (if (and (eobp) (bolp))
        (newline)
      ;; Otherwise kill the whole line, and yank it back.
      (let ((kill-read-only-ok t)
            deactivate-mark)
        (toggle-read-only 1)
        (kill-whole-line)
        (toggle-read-only 0)
        (yank))))) 
```

* * *

## 回答 #18

> 赞同：3
> 
> 时间：2013-11-27T17:01:06.947

使用最近的 emacs，您可以在行中的任何位置使用 Mw 来复制它。所以它变成：

```
M-w C-a RET C-y 
```

* * *

## 回答 #19

> 赞同：3
> 
> 时间：2015-06-22T10:07:12.483

当在没有活动区域的情况下以交互方式调用时，COPY (Mw) 改为一行：

```
(defadvice kill-ring-save (before slick-copy activate compile)
  "When called interactively with no active region, COPY a single line instead."
  (interactive
   (if mark-active (list (region-beginning) (region-end))
     (message "Copied line")
     (list (line-beginning-position)
           (line-beginning-position 2))))) 
```

在没有活动区域的情况下以交互方式调用时，改为 KILL (Cw) 一行。

```
(defadvice kill-region (before slick-cut activate compile)
  "When called interactively with no active region, KILL a single line instead."
  (interactive
   (if mark-active (list (region-beginning) (region-end))
     (message "Killed line")
     (list (line-beginning-position)
           (line-beginning-position 2))))) 
```

此外，在相关说明中：

```
(defun move-line-up ()
  "Move the current line up."
  (interactive)
  (transpose-lines 1)
  (forward-line -2)
  (indent-according-to-mode))

(defun move-line-down ()
  "Move the current line down."
  (interactive)
  (forward-line 1)
  (transpose-lines 1)
  (forward-line -1)
  (indent-according-to-mode))

(global-set-key [(meta shift up)]  'move-line-up)
(global-set-key [(meta shift down)]  'move-line-down) 
```

* * *

## 回答 #20

> 赞同：3
> 
> 时间：2016-07-12T20:20:46.750

无论如何，我看到了非常复杂的解决方案......

```
(defun duplicate-line ()
  "Duplicate current line"
  (interactive)
  (kill-whole-line)
  (yank)
  (yank))
(global-set-key (kbd "C-x M-d") 'duplicate-line) 
```

* * *

## 回答 #21

> 赞同：2
> 
> 时间：2008-09-17T22:40:53.423

`ctrl`- `k`, `ctrl`- `k`, (位置到新位置) `ctrl`-`y`

添加`ctrl`-`a`如果您不是从行首开始。第二个`ctrl`-`k`是抓住换行符。如果您只想要文本，可以将其删除。

* * *

## 回答 #22

> 赞同：2
> 
> 时间：2008-09-17T22:48:35.387

@[Kevin Conner]：据我所知，非常接近。唯一要考虑的另一件事是打开在`kill-whole-line`Ck 中包含换行符。

* * *

## 回答 #23

> 赞同：2
> 
> 时间：2016-09-22T15:38:50.133

此功能应与 JetBrains 的实现相匹配，即按行或区域复制，然后按预期保留点和/或活动区域：

只是围绕交互式表单的包装器：

```
(defun wrx/duplicate-line-or-region (beg end)
  "Implements functionality of JetBrains' `Command-d' shortcut for `duplicate-line'.
   BEG & END correspond point & mark, smaller first
   `use-region-p' explained: 
   http://emacs.stackexchange.com/questions/12334/elisp-for-applying-command-to-only-the-selected-region#answer-12335"
  (interactive "r")
  (if (use-region-p)
      (wrx/duplicate-region-in-buffer beg end)
    (wrx/duplicate-line-in-buffer))) 
```

这就是所谓的，

```
(defun wrx/duplicate-region-in-buffer (beg end)
  "copy and duplicate context of current active region
   |------------------------+----------------------------|
   |        before          |           after            |
   |------------------------+----------------------------|
   | first <MARK>line here  | first line here            |
   | second item<POINT> now | second item<MARK>line here |
   |                        | second item<POINT> now     |
   |------------------------+----------------------------|
   TODO: Acts funky when point < mark"
  (set-mark-command nil)
  (insert (buffer-substring beg end))
  (setq deactivate-mark nil)) 
```

或这个

```
(defun wrx/duplicate-line-in-buffer ()
  "Duplicate current line, maintaining column position.
   |--------------------------+--------------------------|
   |          before          |          after           |
   |--------------------------+--------------------------|
   | lorem ipsum<POINT> dolor | lorem ipsum dolor        |
   |                          | lorem ipsum<POINT> dolor |
   |--------------------------+--------------------------|
   TODO: Save history for `Cmd-Z'
   Context: 
   http://stackoverflow.com/questions/88399/how-do-i-duplicate-a-whole-line-in-emacs#answer-551053"
  (setq columns-over (current-column))
  (save-excursion
    (kill-whole-line)
    (yank)
    (yank))
  (let (v)
    (dotimes (n columns-over v)
      (right-char)
      (setq v (cons n v))))
  (next-line)) 
```

然后我把这个绑定到 meta+shift+d

```
(global-set-key (kbd "M-D") 'wrx/duplicate-line-or-region) 
```

* * *

## 回答 #24

> 赞同：2
> 
> 时间：2018-01-18T20:51:31.977

这是复制当前行的功能。使用前缀参数，它将多次复制该行。例如，`C-3 C-S-o`将复制当前行三次。不改变杀戮戒指。

```
(defun duplicate-lines (arg)
  (interactive "P")
  (let* ((arg (if arg arg 1))
         (beg (save-excursion (beginning-of-line) (point)))
         (end (save-excursion (end-of-line) (point)))
         (line (buffer-substring-no-properties beg end)))
    (save-excursion
      (end-of-line)
      (open-line arg)
      (setq num 0)
      (while (< num arg)
        (setq num (1+ num))
        (forward-line 1)
        (insert line))
      )))

(global-set-key (kbd "C-S-o") 'duplicate-lines) 
```

* * *

## 回答 #25

> 赞同：2
> 
> 时间：2019-10-03T14:18:15.620

如果您使用的是 Spacemacs，您可以简单地使用`duplicate-line-or-region`, 绑定到：

```
SPC x l d 
```

* * *

## 回答 #26

> 赞同：2
> 
> 时间：2020-09-06T15:06:09.707

Melpa 上有一个名为“move-dup”的软件包可以帮助您。

免责声明：我是该软件包的作者。

* * *

## 回答 #27

> 赞同：1
> 
> 时间：2014-06-08T11:42:47.250

我根据自己的喜好写一篇。

```
(defun duplicate-line ()
  "Duplicate current line."
  (interactive)
  (let ((text (buffer-substring-no-properties (point-at-bol) (point-at-eol)))
        (cur-col (current-column)))
    (end-of-line) (insert "\n" text)
    (beginning-of-line) (right-char cur-col)))
(global-set-key (kbd "C-c d l") 'duplicate-line) 
```

但是我发现当当前行包含多字节字符（例如 CJK 字符）时，这会有一些问题。如果您遇到此问题，请尝试以下操作：

```
(defun duplicate-line ()
  "Duplicate current line."
  (interactive)
  (let* ((text (buffer-substring-no-properties (point-at-bol) (point-at-eol)))
         (cur-col (length (buffer-substring-no-properties (point-at-bol) (point)))))
    (end-of-line) (insert "\n" text)
    (beginning-of-line) (right-char cur-col)))
(global-set-key (kbd "C-c d l") 'duplicate-line) 
```

* * *

## 回答 #28

> 赞同：1
> 
> 时间：2018-09-29T05:23:56.640

我无法相信所有这些复杂的解决方案。这是两次击键：

`<C-S-backspace>`运行命令 kill-whole-line

`C-/`运行命令撤消

所以`<C-S-backspace> C-/`要“复制”一整行（杀死和撤消）。

当然，您可以将其与数字和负 args 结合起来，以向前或向后终止多行。

* * *

## 回答 #29

> 赞同：1
> 
> 时间：2018-12-07T13:24:43.227

正如其他答案中提到的，将击键绑定到 lisp 代码比将它们绑定到另一个击键更好。使用@mw 的答案，代码会复制该行并将标记移动到新行的末尾。此修改将标记位置保持在新行的同一列：

```
fun duplicate-line ()
  (interactive)
  (let ((col (current-column)))
    (move-beginning-of-line 1)
    (kill-line)
    (yank)
    (newline)
    (yank)
    (move-to-column col))) 
```

* * *

## 回答 #30

> 赞同：0
> 
> 时间：2010-08-10T07:04:49.250

使用前缀参数，以及（我希望）什么是直观的行为：

```
(defun duplicate-line (&optional arg)
  "Duplicate it. With prefix ARG, duplicate ARG times."
  (interactive "p")
  (next-line 
   (save-excursion 
     (let ((beg (line-beginning-position))
           (end (line-end-position)))
       (copy-region-as-kill beg end)
       (dotimes (num arg arg)
         (end-of-line) (newline)
         (yank)))))) 
```

光标将停留在最后一行。或者，您可能希望指定一个前缀以一次复制接下来的几行：

```
(defun duplicate-line (&optional arg)
  "Duplicate it. With prefix ARG, duplicate ARG times."
  (interactive "p")
  (save-excursion 
    (let ((beg (line-beginning-position))
          (end 
           (progn (forward-line (1- arg)) (line-end-position))))
      (copy-region-as-kill beg end)
      (end-of-line) (newline)
      (yank)))
  (next-line arg)) 
```

我发现自己经常使用这两种方法，使用包装函数来切换前缀参数的行为。

和一个键绑定： `(global-set-key (kbd "C-S-d") 'duplicate-line)`

* * *

## 回答 #31

> 赞同：0
> 
> 时间：2012-08-25T04:15:36.620

```
;; http://www.emacswiki.org/emacs/WholeLineOrRegion#toc2
;; cut, copy, yank
(defadvice kill-ring-save (around slick-copy activate)
  "When called interactively with no active region, copy a single line instead."
  (if (or (use-region-p) (not (called-interactively-p)))
      ad-do-it
    (kill-new (buffer-substring (line-beginning-position)
                                (line-beginning-position 2))
              nil '(yank-line))
    (message "Copied line")))
(defadvice kill-region (around slick-copy activate)
  "When called interactively with no active region, kill a single line instead."
  (if (or (use-region-p) (not (called-interactively-p)))
      ad-do-it
    (kill-new (filter-buffer-substring (line-beginning-position)
                                       (line-beginning-position 2) t)
              nil '(yank-line))))
(defun yank-line (string)
  "Insert STRING above the current line."
  (beginning-of-line)
  (unless (= (elt string (1- (length string))) ?\n)
    (save-excursion (insert "\n")))
  (insert string))

(global-set-key (kbd "<f2>") 'kill-region)    ; cut.
(global-set-key (kbd "<f3>") 'kill-ring-save) ; copy.
(global-set-key (kbd "<f4>") 'yank)           ; paste. 
```

将上面的 elisp 添加到您的 init.el 中，您现在可以获得剪切/复制整行功能，然后您可以 F3 F4 复制一行。

* * *

## 回答 #32

> 赞同：0
> 
> 时间：2013-11-11T21:23:10.217

最简单的方法是 Chris Conway 的方法。

```
C-a C-SPACE C-n M-w C-y 
```

这是 EMACS 规定的默认方式。在我看来，最好使用标准。我总是小心翼翼地在 EMACS 中自定义自己的键绑定。EMACS 已经足够强大了，我认为我们应该尽量适应它自己的键绑定。

虽然有点冗长，但是当你习惯了它，你可以做的很快，会发现这很有趣！

* * *

## 回答 #33

> 赞同：0
> 
> 时间：2018-10-30T18:59:39.353

相对于 Chris Conway 选择的答案，这感觉更自然。

（全局设置键 "\Cc\Cd" "\Ca\C- \Cn\Mw\Cy\Cp\Ce"）

这允许您通过简单地重复 \Cc\Cd 键击来多次复制一行。

* * *

## 回答 #34

> 赞同：-1
> 
> 时间：2008-09-17T22:39:02.600

我通常使用：

```
Ctl-Space（设置标记）
移动到行尾
Ctl-K 杀线
Ctl-Y * 2（拉回线）
```

不过可能有更好的方法：P

# c# - ISS 错误 CS0433：名称冲突

> ID：88403
> 
> 赞同：0
> 
> 时间：2008-09-17T22:38:04.507
> 
> 标签：c#, asp.net, iis-6

在我们的应用程序中，我们多次遇到错误，我们收到错误 CS0433，它抱怨两个单独的 dll 中的名称冲突。这是一个用 C# 使用 webforms 开发的 ASP.NET 应用程序。它总是抱怨 A TimeLog 页面。有人有解决此错误的建议吗？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2008-09-17T22:40:51.940

[我在 MSDN 中找到了描述此错误的链接。](http://social.msdn.microsoft.com/Forums/en-US/msbuild/thread/aa9f90e8-534d-4e74-b656-99187eb3f281/)

总而言之，页面的文件名（TimeLogTab.aspx）和代码中的类（公共类 TimeLogTab）之间可能会发生命名冲突。

该链接建议重命名其中之一。我将课程更改为 Time_LogTab，错误消失了。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2008-11-10T14:32:06.063

该错误可能会间歇性发生：我正在为 VS 2005 Web 应用程序项目使用“发布网站”，其中“发布前删除所有现有文件”，然后 XCOPY-Deploy 到目标 IIS 文件夹（不会删除现有文件那里）。今天我第一次遇到这个错误（几周以来没有新的 .ascx/.aspx 文件），但简单地重新编译和重新部署同一个项目就解决了这个问题。

唯一的区别：第二次，我首先点击了导致问题的页面。现在我想知道确切的点击顺序是否真的很重要，或者任意不幸的点击顺序是否会有效地使 ASP.NET 站点崩溃？

# xml - 在 AIML 中，使用元素的 XSD 有效方式是什么 ?

> ID：88417
> 
> 赞同：1
> 
> 时间：2008-09-17T22:40:14.860
> 
> 标签：xml, validation, xsd, aiml

在 Atomic.aiml 文件中，部分带[注释的 ALICE AIML 文件](http://www.alicebot.org/aiml/aaa/Atomic.aiml)中，有很多这样的类别：

```
<category>
    <pattern>ANSWER MY QUESTION</pattern>
    <template>
        Please try asking 
        <set name="it">your question</set> 
        another way.
    </template>   
</category> 
```

[根据AIML XSD](http://docs.aitools.org/aiml/schema/AIML.xsd) ，此代码无效；验证器说*内容模型中不允许有字符数据*（关于set 元素内的**问题字符数据）。**如果我删除**您的问题**，错误就会消失，但是“它”将无法正确定义。

如何修复上面的代码以使其通过验证？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2008-09-18T08:07:57.023

您正在使用哪个验证器，因为以下完整文件根据 Xerces 进行验证？

```
<aiml xmlns="http://alicebot.org/2001/AIML-1.0.1" version="1.0.1">
  <category>
    <pattern>ANSWER MY QUESTION</pattern>
    <template>
       Please try asking
       <set name="it">your question</set>
       another way.
    </template>
  </category>
</aiml> 
```

# java - 如何检测是否在 Swing 中切换了大写锁定？

> ID：88434
> 
> 赞同：17
> 
> 时间：2008-09-17T22:42:25.103
> 
> 标签：java, swing

我正在尝试为我的工作场所建立一个更好的用户名/密码字段，并且希望能够在他们的大写锁定时进行投诉。

这可能吗？如果是这样，我希望在客户键入他们的第一个字母之前检测到它。

是否有非平台特定的方法来做到这一点？

* * *

## 回答 #1

> 赞同：26
> 
> 时间：2008-09-17T22:45:48.670

试试这个，从 java.awt.Toolkit 返回一个布尔值：

```
Toolkit.getDefaultToolkit().getLockingKeyState(KeyEvent.VK_CAPS_LOCK) 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2008-09-17T22:47:21.707

这是关于类 [http://java.sun.com/j2se/1.5.0/docs/api/java/awt/Toolkit.html#getLockingKeyState(int)的一些信息](http://java.sun.com/j2se/1.5.0/docs/api/java/awt/Toolkit.html#getLockingKeyState(int))

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2011-07-04T17:03:17.710

除了 Nick 的回答之外，为了在用户按键之前对这种情况做出反应，您可以侦听文本输入组件的焦点事件，并在组件接收焦点时测试大写锁定。

# ruby - Ruby 项目

> ID：88438
> 
> 赞同：0
> 
> 时间：2008-09-17T22:42:44.963
> 
> 标签：ruby, desktop-application

最近，我一直在编写很多 Web 内容，rails。我总能找到一个网站来编码，但我有点厌烦它。最近学习了很多 Java 和 C 课程，所以我对桌面应用程序编程有点兴趣。

问题：我一辈子都想不出为桌面编码的东西。我只是想不出任何我可以编码但还没有下载的东西。那我该怎么办？我需要一些可以设定为目标的项目建议。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2008-09-17T22:44:24.023

我想说你应该浏览 github 或其他一些开源站点，找到一个你可以贡献的现有的年轻或老项目。也许有些东西刚刚起步，或者也许有一个成熟的项目可以进行一些改进。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2008-09-17T22:46:05.533

我发现要完成一个项目，它需要是我热爱的事情。我觉得你需要找到自己的项目，恐怕。

不过，总是有[Netflix 奖](http://www.netflixprize.com/)！

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2008-09-17T22:48:02.003

我会写一个[光线追踪器](http://www.cs.unc.edu/~rademach/xroads-RT/RTarticle.html)。

哎呀，对不起......你正在寻找一个原创的想法。:) 光线追踪器仍然很酷，而且很容易上手。也许您会在开发游戏时对游戏产生想法。

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2008-09-17T22:51:20.293

访问[shoooes.net](http://www.shoooes.net)获取简单有趣的 UI 工具包，然后[访问-shoebox.org](http://www.the-shoebox.org)了解人们正在使用它做的各种事情。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2008-09-17T22:50:55.693

如果你能制作一个 Ruby [ANSI](http://en.wikipedia.org/wiki/ANSI_art)（和[xbin](http://en.wikipedia.org/wiki/XBIN)、idf 和 adf...）编辑器，我会爱你的。因为这意味着您将编写 ANSI 解析例程，我希望您将其发布到开源社区。

...但这是一个自私的答案。哦，一个跨平台的编辑器也不错（虽然[TundraDraw](http://sourceforge.net/projects/tundradraw/)有点照顾）。

# apache-flex - Flex 框架 - 如何判断用户是否正在使用缓存框架？

> ID：88448
> 
> 赞同：5
> 
> 时间：2008-09-17T22:43:34.977
> 
> 标签：apache-flex, flash, framework-caching

我有一个使用 Flex 部署的面向公众的应用程序。我想切换到使用缓存框架（.swz），但需要知道对于我的用户群这是否是一个有效的解决方案（大多数用户只会访问该站点一次，它只是不值得）。

我想要做的是跟踪用户是否在该会话期间加载了 .swz/.swf 文件 - 或者他们是否正在使用他们之前从我或其他站点下载的缓存版本。如果说 80% 的用户正在下载框架 .swz，那么我不妨嵌入 cutdown 框架。但如果 60% 的用户已经拥有该框架，我宁愿允许使用该缓存版本。

我现在最好的解决方案是查看 Web 服务器日志并计算 .swz 文件的下载量与我的主应用程序 .swf 文件的加载次数。这是笨拙和痛苦的，我什至还没有努力去做。

我似乎找不到任何指示加载了哪些 .swz 或 .swf 文件的信息。如果我能确定这一点，我想跟踪当前的用户会话。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2008-10-11T20:29:39.017

我的建议是无论您的用户群如何，都使用缓存框架。事实是，你不会孤军奋战，它得到回报只是时间问题（即使是回访）。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2008-09-18T07:44:59.590

这可能不是您想要的解决方案，但只是为了帮助您进行日志解析，您可以使用它从日志中获取每个计数（假设您在 linux 服务器上）：

```
grep -c \.swz web_log_dir/* 
grep -c \.swf web_log_dir/* 
```

# design-patterns - 将 UI 包装器传递给视图有什么好处吗

> ID：88454
> 
> 赞同：2
> 
> 时间：2008-09-17T22:45:33.617
> 
> 标签：design-patterns, oop

我见过的大多数 MVC 示例都像这样将视图实例传递给控制器

```
public class View  
{  
Controller controller = new Controller(this);  
} 
```

传递一个只提供对控制器感兴趣的属性和事件的访问的类有什么好处，如下所示：

```
public class UIWrapper
{
private TextBox textBox;

public TextBox TextBox
{
get {return textBox;}
}

public UIWrapper(ref TextBox textBox)
{
this.textBox = textBox;
}

public class View
{
UIWrapper wrapper = new UIWrapper(this);
Controller controller = new Controller(wrapper)
} 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2008-09-17T23:25:48.247

[Jeremy Miller](http://codebetter.com/blogs/jeremy.miller/archive/2007/07/25/the-build-your-own-cab-series-table-of-contents.aspx)有一系列关于MVC/MVP triad 的文章。特别是您可能对[第 6 部分](http://codebetter.com/blogs/jeremy.miller/archive/2007/06/04/build-your-own-cab-part-6-view-to-presenter-communication.aspx)感兴趣，它详细介绍了视图和控制器之间的通信。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2008-09-18T00:01:42.123

这取决于您的架构。如果您都在同一层，那么您可以不使用包装器，尽管我可能会将 View 实现的接口传递给 Controller。在功能上，从耦合的角度来看，接口方法和包装器方法是等价的。

但是，如果 UI 位于一层而控制器位于另一层，则传递/序列化整个 View 对象可能会很尴尬，甚至效率低下。在这种情况下，您可能希望来回传递 DTO，这将更容易序列化并且可能更有效。

我倾向于使用 DTO 方法，因为如果您的架构扩展，您需要做的就是序列化和反序列化。

此外，如果您的视图很复杂并且有大量数据要与控制器来回传递，那么您可能会开始使用[Introduce Parameter Object](http://www.refactoring.com/catalog/introduceParameterObject.html)来对抗 Long Parameter List 的气味，这本质上是一个 DTO。

One more thing for you to chew on: for a complicated View, Controller will end up needing to map lots of pieces of data to various text boxes and other UI controls in the View. The same thing in reverse: View ends up grabbing data from a lot of controls and passing them to various methods in your Controller.

I like separating these two. I give Views a DTO and I consider it the View's job to know where to "plug in" and "plug out" each piece of data. Both View and Controller are now coupled only to the DTO, as far as data is concerned anyway.

# fogbugz - 如何在 FogBugz 6 中表示功能与任务？

> ID：88455
> 
> 赞同：8
> 
> 时间：2008-09-17T22:45:40.930
> 
> 标签：fogbugz

在 FogBugz 6 中，我如何表示“功能”与“任务”的概念？正如Fog Creek Software（制造 FogBugz）的所有者[Joel Spolsky 所定义的](http://www.joelonsoftware.com/articles/fog0000000245.html)，功能本质上是一种用户可见的能力。为了估计实现某个功能的时间，开发人员应该将实现分解为简短的任务（最多 2 天），以确保他们考虑每个步骤。

FogBugz 只有案例。我不知道它们是否应该对应于功能或任务。 [一些 FogBugz 文档](http://www.fogcreek.com/FogBugz/learnmore.html?section=PredictShipDates#hist_EnteringFeatures)表明每个案例都是一个任务，这很好，除非无法将给定功能的所有任务组合在一起。考虑到在 FogBugz 6 之前，Joel 提倡使用将每个功能的所有任务分组的电子表格，这尤其奇怪。但他自己的软件似乎并没有有意义地支持这种分组。

我意识到我引用的 Joel 文章包含指向稍后文章的免责声明。然而，后面的文章并没有解决这个问题，事实上它根本没有讨论特性与任务，考虑到 Joel 在第一篇文章中对这些概念的倡导程度，这令人惊讶。

* * *

## 回答 #1

> 赞同：8
> 
> 时间：2008-09-24T14:52:56.413

[回应 AviD 对 Joel 的评论/问题](https://stackoverflow.com/questions/88455/how-do-i-represent-features-v-tasks-in-fogbugz-6/406118#406118)：

> 那么，如果您在下一个版本中有 10 个新功能，每个功能需要 5 个任务来实现，您建议创建 10 个版本吗？我如何定义这些是即将发布的版本中包含的功能/“版本”？

以下是我们在开发过程中如何处理这个特定问题：

1.  首先，我们制定了定期发布时间表：每月内部发布和每季度外部发布。这个时间表永远不会改变，但任务分配/功能完成会改变。这对于简化我们的人际交流非常重要：不要试图与日历争论。
2.  主要功能（在您的示例中为“10 个新功能”）被转换为案例（例如，案例 101 到案例 110）。
3.  作为主要功能的子组件的每个任务也被创建为一个子案例，其中描述了是什么使这部分工作成为大图的重要组成部分。以前，在 Fogbugz 6 中，我们通过允许它为我们搜索文本来使用“另见”功能（例如，“这是案例 101 的子组件”）。这实际上是同一件事，但不那么美观。
4.  现在我们已经将工作分解为最有用的级别，我们将实际的开发人员带入讨论。每个任务和主要功能都单独分配给特定的开发人员。
5.  开发人员通过选择他们认为可以承诺的适当内部发布日期来确定他们何时可以完成分配的工作。
6.  在这一点上，我们对每个版本将完成的工作有了一个粗略的草图。随着工作人员实际估计他们完成工作所需的时间、启用基于证据的调度等，进一步的改进仍在继续。

不过，对于 AviD 的问题，他将通过上面的第 5 步解决发布分配问题。

但是，我认为第 6 点是最有趣的，因为这是您真正获得稳定时间表的地方。例如，如果开发人员在估计更大的任务时遇到困难，他们会进一步将其分解为子案例。请注意，我对“最佳有用性”的评估与真正需要完成工作的人有什么不同（可能有很大差异）。

这也是开发人员可以联系其他人并说“我可以完成大部分工作，但如果 X 可以帮助我完成这个小部分 Y，那将真的很有帮助。” 这实际上是我完成大部分开发任务的地方：在这个过程中，我个人坐在多个地方，从大型计划会议到其他人没有时间做的小任务。

*PS：将这个答案的评分高于乔尔的评分作为个人目标.... ;-)*

*PPS：我最初的反应现在被事件所克服，因为 Fogbugz 7 有可爱的子任务。项目经理喜欢这些报告。*

* * *

## 回答 #2

> 赞同：8
> 
> 时间：2009-01-02T05:38:13.030

对于 FogBugz 6.0 及更早版本：

为每个工作项（任务）创建一个案例。FogBugz 称它们为“功能”，只是为了将它们与错误区分开来，但您确实希望每个任务都有一个案例。

对一堆任务进行分组的最佳方式是创建一个发布（Fix-For）并将所有任务分配给该发布。

* * *

## 回答 #3

> 赞同：5
> 
> 时间：2008-09-24T14:58:18.117

[在FogBugz 论坛](http://support.fogcreek.com/?fogbugz)中提问可能会更好

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2008-10-14T15:23:32.440

我们使用项目组合来实现您的分组目标。我们通常还会设置一个项目“停车”Wiki，其中可以放置指向开发案例、技术文档、系统要求、用户文档、资源的外部链接等的链接。它为与该项目相关的所有内容提供了一个很好的“一站式商店”。

作为该 Wiki 的一部分，我们将设置两个特定项目。一个与大型总体目标/大纲相关，类似于可能对应于您的项目管理图表/诸如此类的内容。一个与每个功能的开发任务有关，因为它们被分解成更小且更易于管理的块。然后，您可以，如前所述，用例链接既可以引用另一个项目中的“主”案例，也可以引用项目 Wiki 本身，以便您可以快速轻松地返回所有与项目相关的信息，这些信息在一处。

您可以使用 FogBugz 完成一堆不同的组织结构，您只需有时以不同的方式处理事情，以应对每种情况。

希望有帮助。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2008-09-17T22:54:46.713

哈哈，那篇文章有免责声明，但我明白你在说什么。

我们使用 Fogbugz，我知道的唯一“功能”在类别下，我认为您不能将其与子任务相关联。

如果您只是想在案例文本中引用它，您可以输入“案例 N”是此任务的功能。

这种听起来更像是在项目管理领域，而不是用于跟踪错误的软件。

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2008-09-17T22:58:02.477

这是一个很好的问题，我自己也问过这个问题。我们目前在 5 名开发人员的小组中测试了fogbugz 45 天，并且我们目前为主要功能创建了一个“发布”。事实上，我们并没有发布它，而是在准备好时一起发布多个版本。

在fogbugz 中肯定应该有某种高级任务分组。

# kvm - libvirt 的 KVM/QEMU 网络 TAP 问题

> ID：88460
> 
> 赞同：5
> 
> 时间：2008-09-17T22:46:14.487
> 
> 标签：kvm, qemu, libvirt

我正在尝试将 libvirt 与 virsh 一起使用来管理我的 kvm/qemu 虚拟机。我遇到的问题是让它与公共 IP 一起工作。服务器正在运行 ubuntu 8.04。

libvirt 不断尝试将其运行为：

```
/usr/bin/kvm -M pc -m 256 -smp 3 -monitor pty -no-acpi \ 
  -drive file=/opt/virtual-machines/calculon/root.qcow2,if=ide,boot=on \ 
  -net nic,vlan=0,model=virtio -net tap,fd=10,vlan=0 -usb -vnc 127.0.0.1:0 
```

哪个启动，但没有任何网络访问权限（ping 无处可去）。在没有 fd=10 的情况下运行它可以正常工作，kvm 为我创建了必要的 TAP 设备并在主机内部运行网络。我看到的所有设置指南都集中在设置伪装上，而我只想要一个简单的网桥和未经过滤的网络访问（来宾和主机都必须使用公共 IP）。

在主机上运行 ifconfig 给出了这个，桥是在我的 /etc/network/interfaces 文件中手动设置的。：

```
br0   Link encap:Ethernet  HWaddr 00:1e:c9:3c:59:b8
      inet addr:12.34.56.78  Bcast:12.34.56.79  Mask:255.255.255.240
      inet6 addr: fe80::21e:c9ff:fe3c:59b8/64 Scope:Link
      UP BROADCAST RUNNING MULTICAST  MTU:1500  Metric:1
      RX packets:3359 errors:0 dropped:0 overruns:0 frame:0
      TX packets:3025 errors:0 dropped:0 overruns:0 carrier:0
      collisions:0 txqueuelen:0
      RX bytes:180646 (176.4 KB)  TX bytes:230908 (225.4 KB)

eth0  Link encap:Ethernet  HWaddr 00:1e:c9:3c:59:b8
      inet6 addr: fe80::21e:c9ff:fe3c:59b8/64 Scope:Link
      UP BROADCAST RUNNING MULTICAST  MTU:1500  Metric:1
      RX packets:6088386 errors:0 dropped:0 overruns:0 frame:0
      TX packets:3058 errors:0 dropped:0 overruns:0 carrier:0
      collisions:0 txqueuelen:1000
      RX bytes:680236624 (648.7 MB)  TX bytes:261696 (255.5 KB)
      Interrupt:33 
```

任何帮助将不胜感激。

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2008-09-18T07:20:17.433

我遵循了[https://help.ubuntu.com/community/KVM](https://help.ubuntu.com/community/KVM)上的桥接网络指南，并在 /etc/network/interfaces 中有以下内容：

```
auto eth0
iface eth0 inet manual

auto br0
iface br0 inet static
        address 192.168.0.10
        network 192.168.0.0
        netmask 255.255.255.0
        broadcast 192.168.0.255
        gateway 192.168.0.1
        bridge_ports eth0
        bridge_fd 9
        bridge_hello 2
        bridge_maxage 12
        bridge_stp off 
```

我没有更改任何 libvirt 网络设置，并且我的 kvm 映像启动如下：

```
/usr/bin/kvm -M pc -no-kqemu -m 256 -smp 1 -monitor pty -boot c -hda \
    /libvirt/apt.img -net nic,macaddr=00:16:3e:77:32:1d,vlan=0 -net \
    tap,fd=11,script=,vlan=0 -usb -vnc 127.0.0.1:0 
```

然后我像往常一样在 kvm 映像中指定静态网络设置。自从我遵循指南以来，一切正常。

尽管在设备下，我在 /etc/libvirt/qemu/ 的 xml 文件中确实有以下设置：

```
<interface type='bridge'>
  <mac address='00:16:3e:77:32:1d'/>
  <source bridge='br0'/>
</interface> 
```

* * *

## 回答 #2

> 赞同：-2
> 
> 时间：2008-10-22T07:10:37.313

我猜你的 Tap 设备应该显示在 ifconfig 中。

运行“brctl show”

它将显示桥接和隧道设备连接。

您可能必须输入 iptable 条目显示所有数据包都将通过网桥路由

iptables -I 输入 -i br0 -j 接受

# java - Eclipse 中是否有用于将标签应用于文件的插件？

> ID：88471
> 
> 赞同：2
> 
> 时间：2008-09-17T22:48:40.473
> 
> 标签：java, eclipse-plugin

我已经搜索过这样的插件，但没有找到。我需要一个工具来“标记”我的 java 文件。类似于 stackoverflow 上的标记。

我希望能够根据我正在处理的项目/任务对我的文件进行分组。Mylyn 有一点帮助，但它会根据各种因素动态地更改上下文（与任务关联的资源列表）。

我只想为我的工作区中的所有文件提供一个基本的标记工具。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2008-09-17T23:18:44.190

[http://taggerplugin.sourceforge.net/](http://taggerplugin.sourceforge.net/)

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2008-09-18T22:56:28.993

我建议使用标签接口对它们进行标记——这些将在签入和不同的工作区中持续存在。

就像是

```
public interface Observer {}  // no required methods 
```

然后当你想将一个类标记为观察者时，你做

```
public class SomeClass implements Observer {...} 
```

然后，在 Eclipse 中，您可以在标记接口（在本例中为观察者）上打开层次结构视图并查看实现它的所有内容。

您也可以使用注释进行标记。

在这两种情况下，您还可以编写反映您的代码库的代码来查找标记类。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2008-09-17T23:20:59.083

有一个名为[Resource Tagger](http://www.eclipseplugincentral.com/Web_Links-index-req-viewlink-cid-818.html)的插件可以做你正在寻找的东西。请报告您发现的作品。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2015-03-24T18:09:37.483

有点晚了，但您可以尝试使用 eclipse 工作集对源文件进行分组。根据需要创建尽可能多的工作集并向每个工作集添加文件；之后，您必须使用资源管理器选择或取消选择 workingSet 选项在文件组之间切换

！

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2008-12-08T01:10:15.803

由于您已经在使用 Mylyn，请尝试右键单击要“标记”的文件并选择“标记为地标”。然后，地标文件将保留在您的上下文中。

# linq - 如何在 LINQ-to-Entities 3.5 中执行“值在哪里”

> ID：88473
> 
> 赞同：20
> 
> 时间：2008-09-17T22:50:23.103
> 
> 标签：linq, linq-to-entities

有人知道如何使用 LINQ-to-Entities 应用“值中的位置”类型条件吗？我尝试了以下方法，但它不起作用：

```
var values = new[] { "String1", "String2" };  // some string values

var foo = model.entitySet.Where(e => values.Contains(e.Name)); 
```

我相信这在 LINQ-to-SQL 中有效吗？有什么想法吗？

* * *

## 回答 #1

> 赞同：19
> 
> 时间：2008-09-17T23:23:31.653

**更新：**找到了如何做到这一点。EF 会在数据库上生成相应的 SQL。我不确定这是否仅适用于 EF4，但我从 Entity Framework 4.0 Recipes 获得了提示

* * *

```
var listOfIds=GetAListOfIds();
var context=CreateEntityFrameworkObjectContext();
var results = from item in context.Items
              where listOfIds.Contains(item.Category.Id)
              select item;
//results contains the items with matching category Ids 
```

此查询在服务器端生成正确的 in 子句。我尚未使用 EF 3.5 对其进行测试，但它确实适用于 EF4。

**注意：**传入 in 子句的值不是参数，因此请确保验证输入。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2008-09-18T03:34:30.630

[Linq to Entities 不支持 Contains](http://msdn.microsoft.com/en-us/library/bb738638.aspx)有点遗憾。

IN 和 JOIN 不是同一个运算符（按 IN 过滤永远不会改变查询的基数）。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2008-09-18T20:05:02.167

EF 目前不支持包含。

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2010-03-30T07:00:29.703

供参考：

如果您使用的是 ESql，则可以在操作中使用。我没有 VS 2008，但代码应该如下所示：

```
var ids = "12, 34, 35";
using (context = new Entites())
{
    var selectedProducts = context.CreateQuery<Products>(
        String.Format("select value p from [Entities].Products as p 
                       where p.productId in {{{0}}}", ids)).ToList();
    ...
} 
```

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2011-01-21T14:00:22.323

对于在查询数据时要使用表达式的情况，可以使用以下扩展方法（改编自[http://social.msdn.microsoft.com/forums/en-US/adodotnetentityframework/thread/095745fe-dcf0- 4142-b684-b7e4a1ab59f0/](http://social.msdn.microsoft.com/forums/en-US/adodotnetentityframework/thread/095745fe-dcf0-4142-b684-b7e4a1ab59f0/)）：

```
using System;
using System.Collections.Generic;
using System.Linq;
using System.Linq.Expressions;
using System.Data.Objects;

namespace Sample {
    public static class Extensions {
        public static IQueryable<T> ExtWhereIn<T, TValue>(this ObjectQuery<T> query,
                    Expression<Func<T, TValue>> valueSelector,
                    IEnumerable<TValue> values) {
            return query.Where(BuildContainsExpression<T, TValue>(valueSelector, values));
        }
        public static IQueryable<T> ExtWhereIn<T, TValue>(this IQueryable<T> query,
            Expression<Func<T, TValue>> valueSelector,
            IEnumerable<TValue> values) {
            return query.Where(BuildContainsExpression<T, TValue>(valueSelector, values));
        }
        private static Expression<Func<TElement, bool>> BuildContainsExpression<TElement, TValue>(
                Expression<Func<TElement, TValue>> valueSelector, IEnumerable<TValue> values) {
            if (null == valueSelector) { throw new ArgumentNullException("valueSelector"); }
            if (null == values) { throw new ArgumentNullException("values"); }
            ParameterExpression p = valueSelector.Parameters.Single();
            // p => valueSelector(p) == values[0] || valueSelector(p) == ...
            if (!values.Any()) {
                return e => false;
            }
            var equals = values.Select(value => (Expression)Expression.Equal(valueSelector.Body, Expression.Constant(value, typeof(TValue))));
            var body = equals.Aggregate<Expression>((accumulate, equal) => Expression.Or(accumulate, equal));
            return Expression.Lambda<Func<TElement, bool>>(body, p);
        }
    }
    class Program {
        static void Main(string[] args) {
            List<int> fullList = new List<int>();
            for (int i = 0; i < 20; i++) {
                fullList.Add(i);
            }

            List<int> filter = new List<int>();
            filter.Add(2);
            filter.Add(5);
            filter.Add(10);

            List<int> results = fullList.AsQueryable().ExtWhereIn<int, int>(item => item, filter).ToList();
            foreach (int result in results) {
                Console.WriteLine(result);
            }
        }
    }       
} 
```

使用扩展非常简单（如您在示例中所见）。要在数据库对象上使用它，假设您通过多个 id 过滤名为“Product”的表，您可以执行以下操作：

```
class Product {
    public int Id { get; set; }
    /// ... other properties
}

List<Product> GetProducts(List<int> productIds) {    
    using (MyEntities context = new MyEntities()) {
        return context.Products.ExtWhereIn<Product, int>(product => product.Id, productIds).ToList();
    }
} 
```

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2008-09-17T22:52:57.670

是的，它确实转换为 SQL，它会生成一个标准的 IN 语句，如下所示：

```
SELECT [t0].[col1]
FROM [table] [t0]
WHERE [col1] IN ( 'Value 1', 'Value 2') 
```

* * *

## 回答 #7

> 赞同：0
> 
> 时间：2008-09-17T22:54:57.633

使用 where 方法并不总是有效

```
var results = from p in db.Products

             where p.Name == nameTextBox.Text

             select p; 
```

# git - 尝试通过防火墙从 github 加载文件非常慢。任何解决方法的建议？

> ID：88476
> 
> 赞同：22
> 
> 时间：2008-09-17T22:50:45.320
> 
> 标签：git, github, firewall

我有点犹豫要不要发布这个，因为我不完全确定我在做什么。任何帮助都会很棒。

我在一台带有防火墙/过滤器的计算机上。我可以毫无困难地下载文件。但是，当我尝试从 Github 克隆文件时，计算机只是挂起。没发生什么事。它在文件夹中创建了一个 git 文件，但没有加载关键文件。对于上下文，我正在开发 Rails 应用程序，尝试加载 Restful Authentication。

你们有人处理过这个吗？让克隆工作有什么建议吗？禁用防火墙可能是一种选择，但如果我可以在不经过该过程的情况下做某事，我将不胜感激。

* * *

## 回答 #1

> 赞同：24
> 
> 时间：2008-09-17T23:07:41.503

Github 支持使用 9418 端口上的 git 协议和 80 端口上的 HTTP 进行克隆。使用后者非常慢（[参考](http://github.com/blog/92-http-cloning)）。您应该在防火墙上打开端口 9418 或使用 HTTP 克隆。

* * *

## 回答 #2

> 赞同：18
> 
> 时间：2010-07-28T20:17:39.813

或者...只需将“git://”前缀更改为“http://”

* * *

## 回答 #3

> 赞同：6
> 
> 时间：2010-03-04T20:44:24.390

如果你被防火墙屏蔽了并且想要 git [更新：HTTP(S) 现在几乎和 ssh 一样快，但是如果 SSH 是访问 repo 的唯一方式，这个信息仍然有用]，并且有ssh 访问没有防火墙的机器，然后使用 ssh 隧道。

为此，请在一个窗口中运行它，然后让它运行：

```
$ ssh username@some_host_not_firewalled -L9418:github.com:9418 
```

然后无论您在哪里使用前一个命令：

```
$ git clone git://github.com/jruby/jruby.git 
```

改用这个：

```
$ git clone git://localhost/jruby/jruby.git 
```

如果您修改（全局）git 配置，则[可以自动完成此翻译：](https://stackoverflow.com/a/1723531/834250)

```
$ git config --global url.git://localhost/.insteadOf git://github.com/ 
```

* * *

## 回答 #4

> 赞同：4
> 
> 时间：2008-09-17T22:54:40.740

该`git://`协议使用端口 9418，因此您应该确保您的防火墙允许到该端口的出站连接。

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2010-09-22T16:29:59.743

我正在使用 git clone git@ssh.github.com:xxx.user/xxx.proj

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2015-12-20T08:23:31.297

```
git config --global url."https://".insteadOf git:// 
```

完毕！

# air - Adobe AIR 可以显示 SVG 吗？

> ID：88481
> 
> 赞同：5
> 
> 时间：2008-09-17T22:51:27.610
> 
> 标签：air, svg

我看到 Adob​​e AIR 使用 WebKit 作为其渲染器，并且我看到 WebKit（至少是最新版本）具有一些 SVG 支持。这是否意味着（并且有人专门尝试过）Adobe AIR 应用程序可以在 HTML 页面上呈现 SVG？

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2008-10-23T00:15:25.357

如果它很有帮助（而且您还不知道），Flex 可以在~~运行时~~编译时嵌入 SVG，从而有效地将其转换为 SWF 格式并将其作为资源嵌入。

```
[Embed(source="assets/frog.svg")]
[Bindable]
public var SvgAsset:Class; 
```

Adobe 的[嵌入资产文章](http://www.adobe.com/devnet/flex/quickstart/embedding_assets/#EmbeddingSvgFiles)中的更多信息。

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2008-12-04T00:12:40.400

如果 ActionScript 2：使用**com.itechnica.svg** (PathToArray) 库在 SWF 运行时加载 SVG 并显示它们*（使用 XML 进行 SVG 解析）*：

[在 Flash 中使用**SVG 路径数据**](http://flash-creations.com/notes/sample_svgtoflash.php)**，右侧窗格**中的下载按钮。

 *** * *

如果 ActionScript 3：使用 **com.zavoo.svg** (SvgPath) 库在 SWF 运行时加载 SVG 并显示它们*（使用 RegExp 进行 SVG 解析）*：

[**SvgLoad**和**SvgDraw**](http://labs.zavoo.com/content/flex/DrawSvg/srcview/index.html)[的源代码，](http://labs.zavoo.com/content/flex/DrawSvg/srcview/index.html)左下角的下载按钮**。**

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2011-01-15T15:56:39.037

**不**，根据 Adob​​e AIR 开发人员中心文章[AIR 2.5 中的 HTML、HTML5、CSS 和 JavaScript 有哪些新变化？](http://www.adobe.com/devnet/air/ajax/articles/air_and_webkit.html).

> **SVG**
> 
> 最近引起极大兴趣的另一个功能是对 SVG 的支持。虽然存在于 WebKit 中，但当前版本的 Adob​​e AIR 不支持 SVG。
> 
> 不包括它的主要原因是运行时大小问题（添加它会使运行时大小增加 15% 到 20%）。最初，关于 AIR 的主要痛点是运行时的大小、与操作系统和原生 API 的集成、对标签和新 CSS 属性的支持以及 JavaScript 性能。这些优先事项，再加上对 SVG 图形兴趣减少的趋势，导致当前版本的 Adob​​e AIR 中不包含对 SVG 的支持。
> 
> 然而，对由 HTML5 画布和更快的 JavaScript 引擎提供支持的富 JavaScript 应用程序重新产生的兴趣增加了通过 SVG 对可编写脚本的矢量图形的请求数量。因此，可以考虑为下一个 AIR 版本添加对 SVG 图形的支持。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2008-09-17T22:57:40.810

Adobe AIR 只能在 Adob​​e 更新其 WebKit 版本（AIR 的 HTML 渲染引擎）并在其 WebKit 版本中启用 SVG 支持后才能支持 SVG。可能是一个商业决定不（即Flash）。

# javascript - 通过查看 self[name] 来判断是否定义了 Javascript 函数 - 这是一个好方法吗？

> ID：88485
> 
> 赞同：4
> 
> 时间：2008-09-17T22:52:35.377
> 
> 标签：javascript

[这是This Question](https://stackoverflow.com/questions/85815/how-to-tell-if-a-javascript-function-is-defined)的后续问题。

我喜欢（并理解）那里的解决方案。但是，在我正在使用的代码中，使用了另一种解决相同问题的方法：

```
function exist(sFN) {
    if(self[sFN]) return true;
    return false;
} 
```

它似乎工作正常，虽然我不明白如何。它有效吗？如何？这种方法有什么缺点？我应该从另一个问题切换到解决方案吗？

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2008-09-17T22:55:17.257

试试这个：

```
function exist(sFN) {
 return (typeof sFN == 'function');
} 
```

* * *

## 回答 #2

> 赞同：6
> 
> 时间：2008-09-17T23:00:13.987

您的条件是检查“self”对象中是否存在“sFN”属性。任何不为 null、未定义、0 和 "" 的内容都将评估为真。

正如其他人所说，您可以使用 typeof 或 instanceof 来查看它是否实际上是一个函数。

查看您的链接示例，您应该阅读 JavaScript 中 ==/!= 和 ===/!== 之间的区别。简短的回答： ("" == null) 是真的， ("" === null) 是假的。

* * *

## 回答 #3

> 赞同：3
> 
> 时间：2008-09-17T22:55:15.683

只需使用`typeof`.

```
typeof(foobar)  // -> undefined
typeof(alert)   // -> function 
```

但是，您不能基于 typeof 定义函数，因为您需要传递一个可能不存在的标识符。因此，如果您定义`function isfun(sym) { return typeof(sym) }`，然后尝试调用`isfun(inexistent)`，您的代码会抛出。

有趣的`typeof`是它是一个操作符，而不是一个函数。因此，您可以使用它来检查未定义的符号而无需抛出。

* * *

如果你假设一个函数在全局范围内（即不在闭包内），你可以定义一个函数来检查它，如下所示：

```
function isfun(identifier) {
  return typeof(window[identifier]) == 'function';
} 
```

在这里，您传递一个字符串作为标识符，因此：

```
isfun('alert');   // -> true
isfun('foobar');  // -> false 
```

* * *

### 关闭？

这是在闭包中定义的函数的示例。在这里，打印的值为**`false`**，这是错误的。

```
(function closure() { 
  function enclosed() {}
  print(isfun('enclosed'))
})() 
```

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2008-09-18T02:26:43.490

仅供参考：typeof 存在（或曾经）一个很好的陷阱。

FF2 为 typeof(/pattern/) 返回“函数”。FF3、IE7 和 Chrome 都返回相同代码的“对象”。（我无法验证其他浏览器。）

假设所有使用 FF2 的人都升级了，那么你就很清楚了。但是，这可能是一个牵强的假设。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2008-09-17T23:10:43.663

你不能真正将它包装在一个方法中，但它是如此简单，真的没有必要。

```
function bob()
{}

if( typeof bob == "function" )
    alert( "bob exists" );

if( typeof dave != "function" )
    alert( "dave doesn't" ); 
```

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2008-10-26T09:43:44.470

Object.prototype.toString.apply(value) === '[对象函数]'

* * *

## 回答 #7

> 赞同：-1
> 
> 时间：2008-10-23T06:14:02.980

我在某处（[此处](http://www.electrictoolbox.com/check-javascript-function-exists/)和[此处](http://bytes.com/forum/thread90633.html)）读到函数是窗口对象的属性，因此您可以执行以下操作：

```
if (window.my_func_name) {
    my_func_name('tester!');
} 
```

或弹出窗口：

```
if (window.opener.my_func_name) {
    my_func_name('tester!');
} 
```

那么一个完整的解决方案：

```
function function_exists(func_name) {
    var eval_string;
    if (window.opener) {
        eval_string = 'window.opener.' + func_name;
    } else {
        eval_string = 'window.' + func_name;
    }
    return eval(eval_string + ' ? true : false');
} 
```

# wpf - 获取 wpf WriteableBitmap 的 DrawingContext

> ID：88488
> 
> 赞同：22
> 
> 时间：2008-09-17T22:53:25.453
> 
> 标签：wpf, bitmap, drawing

有没有办法为 a 获得 a `DrawingContext`（或类似的东西）`WriteableBitmap`？即允许您调用简单的`DrawLine`/ `DrawRectangle`/etc 种方法，而不是直接操作原始像素。

* * *

## 回答 #1

> 赞同：22
> 
> 时间：2009-05-15T16:54:57.797

我发现sixlettervariables 的解决方案是最可行的。但是，缺少“drawingContext.Close()”。根据 MSDN，“必须先关闭 DrawingContext，然后才能呈现其内容”。结果是以下效用函数：

```
public static BitmapSource CreateBitmap(
    int width, int height, double dpi, Action<DrawingContext> render)
{
    DrawingVisual drawingVisual = new DrawingVisual();
    using (DrawingContext drawingContext = drawingVisual.RenderOpen())
    {
        render(drawingContext);
    }
    RenderTargetBitmap bitmap = new RenderTargetBitmap(
        width, height, dpi, dpi, PixelFormats.Default);
    bitmap.Render(drawingVisual);

    return bitmap;
} 
```

然后可以像这样轻松地使用它：

```
BitmapSource image = ImageTools.CreateBitmap(
    320, 240, 96,
    drawingContext =>
    {
        drawingContext.DrawRectangle(
            Brushes.Green, null, new Rect(50, 50, 200, 100));
        drawingContext.DrawLine(
            new Pen(Brushes.White, 2), new Point(0, 0), new Point(320, 240));
    }); 
```

* * *

## 回答 #2

> 赞同：18
> 
> 时间：2009-04-28T12:00:34.557

如果您不介意使用[`System.Drawing`](http://msdn.microsoft.com/en-us/library/system.drawing.aspx)，可以执行以下操作：

```
var wb = new WriteableBitmap( width, height, dpi, dpi, 
                              PixelFormats.Pbgra32, null );
wb.Lock();
var bmp = new System.Drawing.Bitmap( wb.PixelWidth, wb.PixelHeight,
                                     wb.BackBufferStride, 
                                     PixelFormat.Format32bppPArgb, 
                                     wb.BackBuffer );

Graphics g = System.Drawing.Graphics.FromImage( bmp ); // Good old Graphics

g.DrawLine( ... ); // etc...

// ...and finally:
g.Dispose(); 
bmp.Dispose();
wb.AddDirtyRect( ... );
wb.Unlock(); 
```

* * *

## 回答 #3

> 赞同：5
> 
> 时间：2008-09-17T23:02:32.560

我想知道同样的事情，因为目前我正在做类似的事情：

```
DrawingVisual drawingVisual = new DrawingVisual();
using (DrawingContext drawingContext = drawingVisual.RenderOpen())
{
   //
   // ... draw on the drawingContext
   //
   RenderTargetBitmap bmp = new RenderTargetBitmap(width, height, dpi, dpi, PixelFormats.Default);
   bmp.Render(drawingVisual);
   image.Source = bmp;
} 
```

我正在尝试使用 WriteableBitmap 来允许对像素缓冲区进行多线程访问，目前无论是 DrawingContext 还是 RenderTargetBitmap 都不允许这样做。也许某种基于您从 RenderTargetBitmap 检索到的内容的 WritePixels 例程会起作用？

* * *

## 回答 #4

> 赞同：4
> 
> 时间：2008-09-22T20:09:47.213

看来[这个词是 no](http://social.msdn.microsoft.com/forums/en-US/wpf/thread/84299fec-94a1-49a1-b3bc-ec48b8bdf04f/)。

* * *

为了将来参考，我们计划使用WPF的可[写位图扩展端口。](http://writeablebitmapex.codeplex.com/)

对于使用纯现有代码的解决方案，下面提到的任何其他建议都可以使用。

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2017-06-07T23:26:14.387

解决此问题的另一种方法是使用 a`RenderTargetBitmap`作为后备存储，就像在`WriteableBitmap`示例中一样。然后，您可以随时创建并向其发出 WPF 绘图命令。例如：

```
// create the backing store in a constructor
var backingStore = 
      new RenderTargetBitmap(200,200,97,97,PixelFormats.Pbgra32);
myImage.Source = backingStore;

// whenever you want to update the bitmap, do:
var drawingVisual = new DrawingVisual();
var drawingContext = drawingVisual.RenderOpen();
{
    // your drawing commands go here
    drawingContext.DrawRectangle(
            Brushes.Red, new Pen(),
            new Rect(this.RenderSize));
}
Render(drawingContext);
drawingContext.Close();
backingStore.Render(drawingVisual); 
```

如果你想重绘`RenderTargetBitmap`每一帧，你可以捕捉到这个`CompositionTarget.Rendering`事件，像这样：

```
CompositionTarget.Rendering += MyRenderingHandler; 
```

# browser - 什么时候浏览器被认为是“死的”？

> ID：88489
> 
> 赞同：20
> 
> 时间：2008-09-17T22:54:25.653
> 
> 标签：browser

**请记住，我不是在寻找当前要支持的浏览器列表，而是在寻找逻辑方法来制作该列表，并以某种硬统计数据为后盾。**

自从我上一份网络工作以来已经有一段时间了，我决定从头开始做这个最新的网站。现在我必须*再次*决定在浏览器方面支持什么。当然，我有一份我想支持的清单，但进入该清单的决定对我来说似乎有点武断。我在哪里可以获得浏览器使用情况的可靠图片，以及切断旧版本浏览器的支持似乎是一个好点？

* * *

## 回答 #1

> 赞同：26
> 
> 时间：2008-09-17T23:04:06.240

浏览器并没有完全消亡大约十年。您必须意识到的第一件事是您*将*有一些访问者使用您不支持的浏览器。问题不在于哪些浏览器没有死，而是哪些浏览器值得支持（好处）相对于这样做所需的工作（成本）。

我从未见过我愿意推荐的浏览器统计数据，它们似乎都是蛇油。我认为合适的经验法则是，如果使用该浏览器的人也经常在其他网站上遇到问题，则该浏览器不值得支持。换句话说，“坚持其他人都支持的东西”。为此，[雅虎的分级浏览器支持](http://developer.yahoo.com/yui/articles/gbs/index.html)很有用。

最终，最佳选择取决于您的个人情况，并且会随着时间而改变。例如，[37signals 最近放弃了对 Internet Explorer 6 的支持，](http://37signals.blogs.com/products/2008/07/basecamp-phasin.html)而[Facebook 正慢慢朝着同一个方向发展](http://www.kryogenix.org/days/2008/08/27/facebook-doesnt-really-support-ie6)。这还不是大多数组织可以做出的决定，但是再过一两年，你会看到更多的组织效仿。现在，这是一个大胆的步骤，您可能无法证明这一点，但请给它时间。

不要陷入认为支持尽可能多的浏览器自动是最佳选择的陷阱——这可能是因为您浪费时间在与五个人使用的浏览器兼容时对您的访问者造成了伤害。改善您拥有的其他数百万用户的体验。

此外，值得考虑的是，您可以“正式”不支持浏览器。例如，我过去做过的一件事是使用仅适用于 Internet Explorer 5.5 及更低版本的 JavaScript（通过条件注释）来自动删除样式表、JavaScript 并用它们的`alt`文本替换图像。如果没有这些措施，由于 Internet Explorer 的许多布局错误，该网站将无法阅读，但有了它，该网站至少可以正常工作，即使“支持”它的工作量太大。

* * *

## 回答 #2

> 赞同：9
> 
> 时间：2008-09-17T23:07:41.970

最简单的方法是注册[Google Analytics](http://www.google.com/analytics/)并将其跟踪代码添加到您的网站（有许多类似的服务，但 Google 的服务是我发现的最好的）。它为您提供有关访问您网站的人使用哪些浏览器的详细统计信息。

一旦你有了几个月的数据，你就可以开始决定你将支持哪些浏览器。我为一家主流网络公司工作，他们想让我们的网站为尽可能多的用户服务，因此我们认为任何市场份额超过 0.5% 的浏览器都在我们的测试矩阵中。但是，其他站点可能会选择仅在 IE 和 Firefox 等主流浏览器上支持和测试。

作为粗略的指南，您将看到的主要浏览器是 IE 6 和 7，以及 Firefox 2 和 3。这应该覆盖 90% 以上的受众，因此是前几个月的一个很好的起点。然后使用您的分析数据并就潜在收入（或您试图实现的任何目标）是否值得为支持其他浏览器而付出额外努力做出业务决策。

**2008 年 9 月 18 日添加：**

诚然，这种方法的一个问题是，如果您对某些浏览器类型的支持太差，以至于您的网站无法使用它们，那么它可能会扭曲统计数据，因为这些人将不再回来，因此这些浏览器似乎有较低用户的百分比。

要确定是否发生这种情况，您可以使用 Google Analytics 对每种浏览器类型和版本的详细行为细分。这会为您提供跳出率、网站平均停留时间、每次访问的页面以及新访问的百分比。如果给定浏览器类型和版本的数据明显比其他浏览器差（即跳出率较高、网站停留时间较短、每次访问的页面较低或新访问的百分比较高），那么您的网站*可能*' 不能很好地支持该浏览器，如果您有更好的支持，您可能会获得更多用户。

在这一点上，这些数字仍然会让您对浏览器的重要性有一个*合理*的感觉（即，如果您不支持 Google Chrome 并且它显示为您流量的 2%，那么它不会跃升至 20%只是因为您添加了支持），因此您可以使用该浏览器查看您的网站有多糟糕，并判断您是否添加了支持；有时这可能只涉及修复最糟糕的问题，让网站不完美但可用，直到浏览器获得更高比例的用户，或退出测试状态。

* * *

## 回答 #3

> 赞同：3
> 
> 时间：2008-09-17T23:04:14.133

你可以看看雅虎的方式！支持[分级浏览器支持](http://developer.yahoo.com/yui/articles/gbs/)的浏览器。

* * *

## 回答 #4

> 赞同：2
> 
> 时间：2008-09-17T22:57:13.027

当（a）只有极少数人使用它并且（b）您不关心（卖给？教育？无论您的业务是什么）这么少比例的人时，浏览器就死了。

* * *

## 回答 #5

> 赞同：2
> 
> 时间：2008-09-18T02:26:55.923

不幸的是，你不会找到一个**好的**答案。即使您为您的网站访问者找到了一些关于浏览器版本的硬统计数据，也几乎可以肯定这并不能告诉您您需要知道什么。

您需要知道的不是“我的访问者中有多少百分比使用浏览器 X”，而是“我的收入中有多少百分比来自使用浏览器 X 的访问者”。使用旧版 IE 访问您网站的人可能是一家想要购买网站许可证的大公司的总经理；您上个月使用 Firefox 3 的 10k 访问者可能是想要抄袭您的论文文档的大学生。

真的，您需要了解您的市场——而不仅仅是原始浏览器统计数据。如果您通过向图形设计师出售东西来支付账单，那么坚如磐石的 Safari 支持比您从事销售 Visual Studio 插件的工作要重要得多。没用，我知道！

* * *

## 回答 #6

> 赞同：2
> 
> 时间：2008-09-18T03:22:28.690

有 2 个*主要*目标群体。（不过还有很多其他的）

第 1 组是使用 Webkit（例如 Safari）、Presto（例如 Opera）、KHTML（例如 Konqueror）或 Gecko（例如 Firefox）的浏览器。这些浏览器都应该获得相同的标记、CSS 和 Javascript 代码（因为它们都属于同一组符合标准的浏览器）。如果您绝对必须并且有资源这样做，请仅解决其中之一中的错误。相反，在每个版本的最新稳定版本中进行测试（在您开发时，他们可以相互检查预期的行为是什么）并（在检查了每晚的错误后）文件错误报告。同样，如果可以，请避免针对特定浏览器的解决方法。相反，从一开始就计划一个跨浏览器兼容的解决方案。

使用 Group #1，您不必担心旧版本（如果有的话）。

第 2 组是使用 Trident 的浏览器（例如 IE）。定位您关心的 IE 版本，但仍然只能解决最严重的错误。

另外，不要拒绝您未正式支持的浏览器。让他们自生自灭，而不是阻止他们（有意或通过糟糕的浏览器检测）。

另外，请记住，在查看市场份额百分比时，请尝试计算出它们所代表的数字，以便您可以了解使用该浏览器的潜在访问者有多少。1% 或 5% 可能看起来不多，但这仍然意味着数百万。

最重要的是，倾听游客的声音。如果您收到有关某个浏览器的多项投诉，请尽可能调查一下。即使它是针对市场份额低的浏览器，如果它是一个微不足道的修复，你也应该这样做。

绝对没死的有：IE6（开始推）、IE7、IE8、最新的Opera 9.x、最新的FF 3.x、最新的Safari 3.x等功能差不多的。FF 2.x 也没有死，Win9X 用户需要它（如果他们不想使用 Opera）

* * *

## 回答 #7

> 赞同：1
> 
> 时间：2008-09-17T23:00:35.420

另请参阅[此主题](https://stackoverflow.com/questions/69830/which-browsers-your-applications-officially-supports)

* * *

## 回答 #8

> 赞同：1
> 
> 时间：2008-09-17T23:11:13.990

你应该使用一个很好的 UI 框架来解决大多数浏览器之间的兼容性问题，比如 YUI!、jQuery 等等......

就个人而言，我推荐YUI！

* * *

## 回答 #9

> 赞同：1
> 
> 时间：2008-09-17T23:20:15.170

尝试在本地回答这个问题，考虑你的听众。例如，当我开发自己的博客引擎时，我的主要诉求是 .NET 开发人员。我希望它能够解释我主要开发的浏览器。从那时起，我考虑了市场份额并尝试确保对所有其他浏览器的“合理”支持水平。例如，即使是 .NET 开发人员偶尔也会使用 Firefox，甚至可能是 Opera。Safari 和 Chrome 现在也是可能的。所以我目前的支持水平按以下顺序排列：

*   它必须在 Internet Explorer 7 中完美运行。我打算构建的所有功能都在那里
*   它必须在 Internet Explorer 6、Firefox 3.0、Opera 9+ 和 Safari for Windows 中合理运行，并非一切都必须完美无缺，但也不能看起来非常丑陋

其他我不关心的。我只是没有时间和愿意的努力来支持一切。

如何确定是否要考虑支持其他浏览器或继续支持上述浏览器之一？我只看市场份额和谁在访问我的页面的统计数据。如果有人快死了，或者我有一段时间没见过他们，那么我认为支持下降了。

所以简而言之，我会简单地对你自己做一个关于浏览器的声明，这些浏览器必须完美然后合理地运行你的代码，并随着浏览器世界的变化而定期更新。对于您的网站的第一次运行，只需考虑您的受众，对于后续更新，您的统计数据应该足以告诉您。

* * *

## 回答 #10

> 赞同：0
> 
> 时间：2008-09-17T22:58:29.730

我的（非常糟糕的）解决方案是从 w3schools 获取统计数据，并以此为基础做出决定。虽然这些数字并不是很糟糕，但它们是有偏差的，因为该网站的浏览者更有可能具有升级意识。此外，它没有提供除 FF 之外的任何浏览器版本的细分。

* * *

## 回答 #11

> 赞同：0
> 
> 时间：2008-09-17T23:01:05.433

如果您纯粹按照标准构建，则某些浏览器将无法正确呈现，因为没有浏览器支持所有标准。您必须选择一些浏览器并在其中测试您的网站。

不要试图太过流血。如果您必须使用一些最先进的 CSS，那么您必须期望它不会 100% 工作。

* * *

## 回答 #12

> 赞同：0
> 
> 时间：2008-09-17T23:19:06.000

你真的打算用这份清单做什么？您是否打算阻止不支持的浏览器？如果用户破解了 User-Agent 响应怎么办？

像其他人一样，我强烈建议使用 Yahoo 的“分级浏览器”之类的东西，如果可能的话，利用 YUI 或其他库，这样您就不必自己动手了。

* * *

## 回答 #13

> 赞同：0
> 
> 时间：2008-09-17T23:21:13.873

<1% 的市场份额不是标准——特别是如果浏览器是新的。

对我来说，< IE6 已经死了，而我使用的 HTML 猴子希望它已经死了。< FF2 已死。Opera 很不错。< Safari 2 已死，但大多数人现在都在为 Saf 3 设计。

所以它是：IE6,7,8 FF 2,3 Saf 3,4 Chrome（基本上是 Saf4）

但是根据您的应用程序，以及您认为您将获得多少人持有机器，您可以放弃 IE6，这将使您的生活变得更加轻松。

* * *

## 回答 #14

> 赞同：0
> 
> 时间：2008-09-19T02:12:07.573

我会说 IE6 及以下版本已经死了......但许多人仍然坚持使用它。

这个网站有一个很好的每个浏览器的实时列表和它的实际年龄。

[http://webbugtrack.blogspot.com/2008/08/browser-life-statuses.html](http://webbugtrack.blogspot.com/2008/08/browser-life-statuses.html)

* * *

## 回答 #15

> 赞同：0
> 
> 时间：2010-02-24T12:56:45.740

我会使用[http://browser-update.org/](http://browser-update.org/)默认值，目前说以下内容已死：

IE <= 6 FF <= 2.0 Op <= 10.01 Sf <= 2.0

* * *

## 回答 #16

> 赞同：-1
> 
> 时间：2008-09-17T22:55:32.250

我的意见（一直是）按照标准构建它，然后让浏览器正确呈现它。

* * *

## 回答 #17

> 赞同：-2
> 
> 时间：2008-09-17T22:57:39.623

从市场份额最高的浏览器开始，然后从那里开始。

如果您在访问您网站的浏览器上有现有指标，请使用这些指标而不是一般市场份额。

* * *

## 回答 #18

> 赞同：-2
> 
> 时间：2008-09-17T23:11:11.777

市场份额小于 1% 者。

* * *

## 回答 #19

> 赞同：-3
> 
> 时间：2008-09-17T22:58:22.103

我同意 Unkwntech。

您应该尝试使网站同时兼容 IE 和 Firefox

* * *

## 回答 #20

> 赞同：-3
> 
> 时间：2008-09-18T07:49:20.237

这很简单 - 大多数用户在购买 PC 时一直使用随 PC 一起提供的浏览器（想想你的妈妈）。当它预装的机器不再用于互联网访问时，浏览器就死了……这可能是大约 5 年。随着新 PC 的价格下降并且它们更多地成为消费电子产品，那么这个时期将会下降，因为人们会很容易地购买新 PC

# c# - 在 ASP.NET C# 中引发异常

> ID：88490
> 
> 赞同：24
> 
> 时间：2008-09-17T22:54:32.533
> 
> 标签：c#, .net, exception

`throw;`只是说和`throw ex;`假设`ex`是你正在捕捉的例外有区别吗？

* * *

## 回答 #1

> 赞同：44
> 
> 时间：2008-09-17T22:55:37.443

`throw ex;`将擦除您的堆栈跟踪。除非您要清除堆栈跟踪，否则不要这样做。只需使用`throw;`

* * *

## 回答 #2

> 赞同：18
> 
> 时间：2008-09-17T23:10:45.863

这是一个简单的代码片段，有助于说明差异。不同之处在于 throw ex 将重置堆栈跟踪，就好像“ `throw ex;`”行是异常的来源一样。

代码：

```
using System;

namespace StackOverflowMess
{
    class Program
    {
        static void TestMethod()
        {
            throw new NotImplementedException();
        }

        static void Main(string[] args)
        {
            try
            {
                //example showing the output of throw ex
                try
                {
                    TestMethod();
                }
                catch (Exception ex)
                {
                    throw ex;
                }
            }
            catch (Exception ex)
            {
                Console.WriteLine(ex.ToString());
            }

            Console.WriteLine();
            Console.WriteLine();

            try
            {
                //example showing the output of throw
                try
                {
                    TestMethod();
                }
                catch (Exception ex)
                {
                    throw;
                }
            }
            catch (Exception ex)
            {
                Console.WriteLine(ex.ToString());
            }

            Console.ReadLine();
        }
    }
} 
```

输出（注意不同的堆栈跟踪）：

> `System.NotImplementedException: The method or operation is not implemented.`
> `at StackOverflowMess.Program.Main(String[] args) in Program.cs:line 23`
> 
> `System.NotImplementedException: The method or operation is not implemented.`
> `at StackOverflowMess.Program.TestMethod() in Program.cs:line 9`
> `at StackOverflowMess.Program.Main(String[] args) in Program.cs:line 43`

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2008-09-17T23:03:26.833

你有两个选择抛出；或将原始异常作为新异常的内部异常抛出。取决于你需要什么。

# perl - 现在如何用替代品替换 $*=1 $* 不再受支持

> ID：88518
> 
> 赞同：7
> 
> 时间：2008-09-17T22:58:36.907
> 
> 标签：perl, migrate

我是一个完整的 perl 新手，正在使用 perl 5.10 运行 perl 脚本并收到以下警告：

```
$* is no longer supported at migrate.pl line 380. 
```

谁能描述一下 $* 做了什么以及现在推荐的替代品是什么？或者，如果您可以向我指出描述这一点的文档，那就太好了。

我正在运行的脚本是将源代码数据库从 vss 迁移到 svn，可以在这里找到： [http ://www.x2systems.com/files/migrate.pl.txt](http://www.x2systems.com/files/migrate.pl.txt)

使用它的两个代码片段是：

```
 $* = 1;
    $/ = ':';

    $cmd = $SSCMD . " Dir -I- \"$proj\"";
    $_ = `$cmd`;

    # what this next expression does is to merge wrapped lines like:
    #    $/DeviceAuthority/src/com/eclyptic/networkdevicedomain/deviceinterrogator/excep
    #    tion:
    # into:
    #    $/DeviceAuthority/src/com/eclyptic/networkdevicedomain/deviceinterrogator/exception:
    s/\n((\w*\-*\.*\w*\/*)+\:)/$1/g;

    $* = 0; 
```

然后是一些方法：

```
 $cmd = $SSCMD . " get -GTM -W -I-Y -GL\"$localdir\" -V$version \"$file\" 2>&1";
            $out = `$cmd`;

            # get rid of stupid VSS warning messages
            $* = 1;
            $out =~ s/\n?Project.*rebuilt\.//g;
            $out =~ s/\n?File.*rebuilt\.//g;
            $out =~ s/\n.*was moved out of this project.*rebuilt\.//g;
            $out =~ s/\nContinue anyway.*Y//g;
            $* = 0; 
```

非常感谢，

*   罗里

* * *

## 回答 #1

> 赞同：13
> 
> 时间：2008-09-17T23:04:49.590

从[perlvar](http://perldoc.perl.org/perlvar.html#%24*)：

> 在现代 Perl 中不推荐使用 $*，在模式匹配中被 /s 和 /m 修饰符取代。

如果您可以访问匹配的位置，只需将其添加到末尾：

```
 $haystack =~ m/.../sm; 
```

如果您只能访问字符串，则可以将表达式括在

```
 qr/(?ms-ix:$expr)/; 
```

或者在你的情况下：

```
s/\n((\w*\-*\.*\w*\/*)+\:)/$1/gsm; 
```

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2008-09-17T23:04:15.600

从[perlvar 的 Perl 5.8 版本](http://perldoc.perl.org/5.8.8/perlvar.html)：

> 设置为非零整数值以在字符串中进行多行匹配 [...] 在现代 Perl 中不推荐使用 $*，在模式匹配中由 /s 和 /m 修饰符取代。

虽然使用 /s 和 /m 要好得多，但您需要为每个正则表达式设置修饰符（适当地！）。

perlvar 还说*“这个变量只影响 ^ 和 $ 的解释。”* 这给人的印象是它仅相当于 /m 而不是 /s。

请注意，这`$*`是一个全局变量。因为对它的更改不是用`local`关键字进行的，所以它将影响程序中的**所有**正则表达式，而不仅仅是块中跟随它的那些。这将使正确更新脚本变得更加困难。

* * *

## 回答 #3

> 赞同：4
> 
> 时间：2008-09-17T23:11:00.323

从[perldoc perlvar](http://perldoc.perl.org/5.8.8/perlvar.html#%24%2a)：

> ### `$*`
> 
> 设置为非零整数值以在字符串中进行多行匹配，0（或未定义）告诉 Perl 它可以假设字符串包含单行，以优化模式匹配。`$*`当为 0 或未定义时，包含多个换行符的字符串上的模式匹配会产生令人困惑的结果。默认未定义。（助记符：`*`匹配多个事物。）此变量仅影响 和 的`^`解释`$`。即使在`$* == 0`.
> 
> 在现代 Perl 中不推荐使用 of `$*`，取而代之的是模式匹配中的`/s`and`/m`修饰符。
> 
> Assigning a non-numerical value to `$*` triggers a warning (and makes `$*` act as if `$* == 0`), while assigning a numerical value to `$*` makes that an implicit int is applied on the value.

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2008-09-17T23:02:14.947

它打开多行模式。自 perl 5.0（从 1994 年开始）以来，正确的方法是将 a*`m`*和/或*`s`*修饰符添加到您的正则表达式中，如下所示

```
 s/\n?Project.*rebuilt\.//msg 
```

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2008-09-17T23:07:20.410

这基本上是一种说法，在后续的正则表达式（s/// 或 m//）中，^ 或 $ 断言应该能够在嵌入字符串的换行符之前或之后匹配。

推荐的等效项是正则表达式末尾的 m 修饰符（例如，s/\n((\w*-*.*\w*/*)+:)/$1/gm;）。

# asp.net - 将十进制值转换为货币字符串以在 HTML 中显示的最佳方法

> ID：88522
> 
> 赞同：2
> 
> 时间：2008-09-17T22:59:54.377
> 
> 标签：asp.net, browser, localization, currency

我想在我的在线商店中显示我的产品的价格。我目前正在做：

```
<span class="ourprice">
     <%=GetPrice().ToString("C")%>
</span> 
```

其中 GetPrice() 返回小数。所以这目前返回一个值，例如“£12.00”

我认为输出“12.00 英镑”的正确 HTML 是“ `&pound;12.00`”，因此尽管这在大多数浏览器中渲染得很好，但某些浏览器 (Mozilla) 将其显示为 12.00 美元。

（服务器在英国，本地化在 web.config 中进行了适当设置）。

以下是改进，还是有更好的方法？

```
<span class="ourprice">
     <%=GetPrice().ToString("C").Replace("£","&pound;")%>
</span> 
```

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2008-09-17T23:03:10.500

试试这个，它将使用您为应用程序设置的语言环境：

```
<%=String.Format("{0:C}",GetPrice())%> 
```

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2008-09-17T23:06:35.390

采用

```
GetPrice().ToString("C", CultureInfo.CreateSpecificCulture("en-GB")) 
```

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2008-09-18T10:23:18.557

£ 符号 (U+00A3) 和 html 实体 & #163; 和 & 磅; 应该都在浏览器中呈现相同的内容。

如果浏览器无法识别 £，它可能无法识别实体版本。它在 ISO 8859-1 (Latin-1) 中，所以如果 Mozilla 浏览器无法呈现它（我的 FF 当然可以），我会感到惊讶。

如果您看到 $ 符号，则可能有两件事： 1\. 浏览器默认语言是 en-us 2\. Asp.net 正在执行自动区域设置切换。默认的 web.config 设置类似于

```
<globalization   culture="auto:en-us"  uiCulture="auto:en-US" /> 
```

由于您（几乎可以肯定）想要仅限英国的价格，只需在 web.config 中指定区域设置：

```
 <globalization   culture="us"  uiCulture="en-gb" /> 
```

（或在页面级别：）

```
 <%@Page Culture="en-gb" UICulture="en-gb" ..etc... %> 
```

此后，String.Format("{0:C}",GetPrice()) 和 GetPrice().ToString("C") 等字符串格式将使用 en-GB 语言环境，因为 asp.net 将 currentCulture 设置为你

（尽管如果您偏执，可以在重载中指定 en-gb 文化）。

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2008-09-17T23:07:21.113

您可以编写一个函数来执行从价格到字符串的转换。这样，您就可以对输出进行大量控制。

语言环境的问题在于它依赖于 Web 服务器，而不是依赖于 Web 浏览器。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2008-09-17T23:06:20.210

如果您需要明确说明本地化，您可以使用 CultureInfo 并将其传递给字符串格式化程序。

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2008-09-17T23:46:51.627

只需使用十进制值的 ToString("C2") 属性。在 web.config 中设置您的全球化 - 保持简单。

# c# - 业务对象、验证和异常

> ID：88541
> 
> 赞同：38
> 
> 时间：2008-09-17T23:04:21.090
> 
> 标签：c#, validation, exception, business-objects

我一直在阅读一些关于异常及其使用的问题和答案。似乎是一种强烈的观点，即只应针对异常、未处理的情况提出异常。所以这让我想知道验证如何与业务对象一起工作。

假设我有一个带有 getter/setter 对象属性的业务对象。假设我需要验证该值是否在 10 到 20 之间。这是一个业务规则，因此它属于我的业务对象。所以这对我来说似乎意味着验证代码在我的设置器中。现在我将 UI 数据绑定到数据对象的属性。用户输入5，所以规则需要失败，不允许用户移出文本框。. UI 是数据绑定到属性的，因此将调用 setter、检查规则并失败。如果我从我的业务对象中提出一个异常说规则失败，那么 UI 会接受它。但这似乎与异常的首选用法背道而驰。鉴于它是一个二传手，你真的不会有二传手的“结果”。

那么验证应该如何工作呢？

编辑：我可能在这里使用了一个过于简单的例子。像上面的范围检查这样的事情可以由 UI 轻松处理，但如果验证更复杂，例如业务对象根据输入计算一个数字，如果计算出的数字超出范围，它应该被拒绝。这是更复杂的逻辑，不应该出现在 UI 中。

还考虑基于已输入的字段输入的进一步数据。例如，我必须在订单上输入一个项目以获得某些信息，如现有库存、当前成本等。用户可能需要此信息来决定进一步输入（例如要订购多少个单位），或者可能需要它来订购以进行进一步验证。如果项目无效，用户是否应该能够输入其他字段？重点是什么？

* * *

## 回答 #1

> 赞同：18
> 
> 时间：2008-09-25T12:35:51.680

您想深入研究一下[Paul Stovell](http://www.paulstovell.com/)在数据验证方面的出色工作。[他在这篇文章](http://www.codeproject.com/KB/cs/DelegateBusinessObjects.aspx)中一次总结了自己的想法。我碰巧分享了他对此事的看法，我在[自己的库](http://salamanca.nourysolutions.com/road/index.php?post/2008/08/26/Inside-the-libraries-I-%3A-Data-Rules)中实现了这一点。

用 Paul 的话来说，这是在 setter 中抛出异常的缺点（基于`Name`属性不应为空的示例）：

> *   有时您实际上需要一个空名称。例如，作为*“创建帐户”*表单的默认值。
> *   如果您依靠它在保存之前验证任何数据，您将错过数据已经无效的情况。我的意思是，如果您从数据库中加载一个空名称的帐户并且不更改它，您可能永远不会知道它是无效的。
> *   如果您不使用数据绑定，则必须编写大量带有`try/catch`块的代码来向用户显示这些错误。在用户填写表单时尝试在表单上显示错误变得非常困难。
> *   我不喜欢为非异常的事情抛出异常。用户将帐户名称设置为*“Supercalafragilisticexpialadocious”*不是一个例外，而是一个错误。这当然是个人的事情。
> *   很难获得所有已被破坏的规则的列表。例如，在某些网站上，您会看到*“必须输入姓名。必须输入地址。必须输入电子邮件”之*类的验证消息。要显示它，您将需要很多`try/catch`块。

以下是替代解决方案的基本规则：

> 1.  拥有无效的业务对象并没有错，只要您不尝试持久化它。
> 2.  任何和所有被破坏的规则都应该可以从业务对象中恢复，以便数据绑定以及您自己的代码可以查看是否存在错误并适当地处理它们。

* * *

## 回答 #2

> 赞同：9
> 
> 时间：2008-09-18T02:14:50.897

假设您有单独的验证和持久化（即保存到数据库）代码，我会执行以下操作：

1.  UI 应该执行验证。不要在这里抛出异常。您可以提醒用户注意错误并阻止保存记录。

2.  您的数据库保存代码应该为错误数据抛出无效参数异常。在这里这样做是有意义的，因为此时您无法继续进行数据库写入。理想情况下，这不应该发生，因为 UI 应该阻止用户保存，但您仍然需要它来确保数据库一致性。此外，您可能会从没有 UI 数据验证的 UI（例如批量更新）以外的地方调用此代码。

* * *

## 回答 #3

> 赞同：8
> 
> 时间：2008-09-18T04:33:28.850

我一直很喜欢 Rocky Lhotka 在[CSLA 框架](http://www.lhotka.net/cslanet/)中的方法（正如 Charles 所提到的）。通常，无论是由 setter 驱动还是通过调用显式 Validate 方法，BrokenRule 对象的集合都由业务对象在内部维护。UI 只需要检查对象上的 IsValid 方法，该方法反过来检查 BrokenRules 的数量，并适当地处理它。或者，您可以轻松地让 Validate 方法引发 UI 可以处理的事件（可能是更简洁的方法）。您还可以使用 BrokenRules 列表以摘要形式或在相应字段旁边显示错误消息以供使用。尽管 CSLA 框架是用 .NET 编写的，但整体方法可以用于任何语言。

在这种情况下，我不认为抛出异常是最好的主意。我绝对遵循这样的思想流派，即异常应该用于特殊情况，而简单的验证错误则不是。在我看来，引发 OnValidationFailed 事件将是更干净的选择。

顺便说一句，我从来不喜欢在字段处于无效状态时不让用户离开的想法。在许多情况下，您可能需要暂时离开该字段（可能先设置其他字段），然后再返回并修复无效字段。我认为这只是不必要的不​​便。

* * *

## 回答 #4

> 赞同：5
> 
> 时间：2008-09-18T03:38:00.137

您可能希望将验证移到 getter 和 setter 之外。您可以有一个名为 IsValid 的函数或属性来运行所有验证规则。t 将使用所有“Broken Rules”填充字典或哈希表。这个字典会暴露给外界，你可以用它来填充你的错误信息。

这是 CSLA.Net 中采用的方法。

* * *

## 回答 #5

> 赞同：4
> 
> 时间：2008-09-18T00:29:53.567

Exceptions should not be thrown as a **normal** part of validation. Validation invoked from within business objects is a last line of defense, and should only happen if the UI fails to check something. As such they can be treated like any other runtime exception.

Note that here's a difference between defining validation rules and applying them. You might want to define (ie code or annotate) your business rules in your business logic layer but invoke them from the UI so that they can handled in a manner appropriate to that particular UI. The manner of handling will vary for different UI's, eg form based web-apps vs ajax web-apps. Exception-on-set validation offers very limited options for handling.

Many applications duplicate their validation rules, such as in javascript, domain object constraints and database constraints. Ideally this information will only be defined once, but implementing this can be challenge and requires lateral thinking.

* * *

## 回答 #6

> 赞同：3
> 
> 时间：2008-09-25T12:08:12.167

我倾向于相信业务对象在传递违反其业务规则的值时应该抛出异常。然而，winforms 2.0 数据绑定架构似乎相反，因此大多数人都支持这种架构。

我同意 shabbyrobe 的最后一个回答，即业务对象应该被构建为可用并在多个环境中正常工作，而不仅仅是 winforms 环境，例如，业务对象可以用于 SOA 类型的 Web 服务、命令行界面、asp .net 等。在所有这些情况下，该对象应正确运行并保护自己免受无效数据的影响。

一个经常被忽视的方面是在管理 1-1、1-n 或 nn 关系中的对象之间的协作时会发生什么，这些是否也接受添加无效的协作者并只维护一个应该检查或应该检查的无效状态标志它积极拒绝添加无效的协作。我不得不承认，我深受 Jill Nicola 等人的流线型对象建模 (SOM) 方法的影响。但还有什么是合乎逻辑的。

接下来是如何使用 Windows 窗体。我正在考虑为这些场景的业务对象创建一个 UI 包装器。

* * *

## 回答 #7

> 赞同：3
> 
> 时间：2008-09-17T23:41:21.453

也许您应该考虑同时进行客户端和服务器端验证。如果有任何东西通过客户端验证，那么如果您的业务对象无效，您可以随意抛出异常。

我使用的一种方法是将自定义属性应用于描述验证规则的业务对象属性。例如：

```
[MinValue(10), MaxValue(20)]
public int Value { get; set; } 
```

然后可以处理属性并用于自动创建客户端和服务器端验证方法，以避免重复业务逻辑的问题。

* * *

## 回答 #8

> 赞同：3
> 
> 时间：2008-09-17T23:50:49.090

我肯定会提倡客户端和服务器端验证（或在各个层进行验证）。这在跨物理层或进程进行通信时尤其重要，因为抛出异常的成本变得越来越昂贵。此外，您等待验证的链条越往下，浪费的时间就越多。

至于是否使用异常进行数据验证。我认为可以在流程中使用异常（尽管仍然不是优选的），但在流程之外，调用一个方法来验证业务对象（例如在保存之前）并让该方法返回操作的成功以及任何验证**错误**。错误不是异常的。

Microsoft 在验证失败时从业务对象中抛出异常。至少，企业库的验证应用程序块是这样工作的。

```
using Microsoft.Practices.EnterpriseLibrary.Validation;
using Microsoft.Practices.EnterpriseLibrary.Validation.Validators;
public class Customer
{
  [StringLengthValidator(0, 20)]
  public string CustomerName;

  public Customer(string customerName)
  {
    this.CustomerName = customerName;
  }
} 
```

* * *

## 回答 #9

> 赞同：3
> 
> 时间：2008-09-18T03:40:27.807

您的业​​务对象应该为错误的输入抛出异常，但在正常程序运行过程中绝不应该抛出这些异常。我知道这听起来很矛盾，所以我会解释一下。

每个公共方法都应验证其输入，并在输入不正确时抛出“ArgumentException”。（私有方法应该使用“Debug.Assert()”验证它们的输入以简化开发，但这是另一回事。）这条关于验证公共方法（当然还有属性）输入的规则对于应用程序的每一层都是正确的.

软件接口的要求当然应该在接口文档中说明，而调用代码的工作就是确保参数正确并且永远不会抛出异常，这意味着 UI 需要验证在将输入交给业务对象之前。

虽然上面给出的规则几乎不应该被打破，但有时业务对象验证可能非常复杂，并且不应该将这种复杂性强加到 UI 上。在这种情况下，BO 的接口最好允许它接受的内容有一些余地，然后提供一个显式的 Validate(out string[]) 谓词来检查属性并就需要更改的内容提供反馈。但是请注意，在这种情况下，仍然存在明确定义的接口要求，并且不需要抛出异常（假设调用代码遵循规则）。

遵循后一种系统，我几乎从不对属性设置器进行早期验证，因为这种软化使属性的使用变得复杂，（但在问题中给出的情况下，我可能会）。（顺便说一句，请不要仅仅因为其中包含错误数据而阻止我从字段中跳出。当我无法在表单周围跳动时，我会感到幽闭恐惧症！我会在一分钟内返回并修复它，我保证！好吧，我现在感觉好多了，对不起。）

* * *

## 回答 #10

> 赞同：3
> 
> 时间：2008-09-18T04:59:27.243

这取决于您将执行哪种验证以及在何处执行。我认为可以轻松保护应用程序的每一层免受不良数据的影响，而且这样做太容易了，不值得。

考虑一个多层应用程序和每一层的验证要求/设施。中间层，对象，是这里似乎有待讨论的层。

*   **数据库**
    通过列约束和引用完整性保护自己免受无效状态的影响，这将导致应用程序的数据库代码抛出异常

*   **对象**
    ？

*   **ASP.NET/Windows Forms**
    使用验证器例程和/或控件来保护表单的状态（不是对象）*而不*使用异常（winforms 不附带验证器，但是 msdn 上有一个很好的系列[描述了如何实现它们](http://msdn.microsoft.com/en-us/library/ms951078.aspx)）

假设您有一张包含酒店房间列表的表格，每一行都有一个称为“床位”的床位数列。该列最合理的数据类型是无符号小整数*。您还有一个普通的 ole 对象，它具有一个名为“Beds”的 Int16* 属性。问题是您可以将 -4555 粘贴到 Int16 中，但是当您将数据持久保存到数据库时，您将得到一个异常。这很好 - 我的数据库不应该被允许说酒店房间的床位少于零，因为酒店房间的床位*不能*少于零。

* 如果您的数据库可以表示[它](http://msdn.microsoft.com/en-us/library/cbf1574z(VS.80).aspx)，但我们假设它可以

关于对象是否应该代表您的业务实体，或者它们是否应该代表您的表单状态存在一些混淆。当然，在 ASP.NET 和 Windows 窗体中，窗体完全能够处理和验证自己的状态。如果您在 ASP.NET 表单上有一个文本框，将用于填充相同的 Int16 字段，您可能已经在页面上放置了一个 RangeValidator 控件，该控件在输入分配给您的对象之前对其进行测试。它会阻止您输入小于零的值，并且可能会阻止您输入大于例如 30 的值，希望这足以满足您可以想象的最严重跳蚤出没的旅馆的需求。在回发时，您可能会在*之前检查页面的 IsValid 属性*构建你的对象，从而防止你的对象代表少于零的床，并防止你的 setter 被调用一个它不应该持有的值。

但是您的对象仍然*能够*表示少于零的床位，并且再次，如果您在不涉及集成了验证的层（您的表单和数据库）的场景中使用该对象，那么您就不走运了。

为什么你会在这种情况下？这一定是一组非常*特殊*的情况！因此，您的 setter 在收到无效数据时需要抛出异常。它永远不应该被抛出，但它可以被抛出。您可能正在编写一个 Windows 窗体来管理对象以替换 ASP.NET 窗体并忘记在填充对象之前验证范围。您可以在根本没有用户交互的计划任务中使用该对象，并且该对象保存到数据库的不同但相关的区域，而不是对象映射到的表。在后一种情况下，您的对象可以进入无效状态，但直到其他操作的结果开始受到无效值的影响时您才会知道。如果您正在检查它们并抛出异常，那就是。

* * *

## 回答 #11

> 赞同：3
> 
> 时间：2008-12-29T17:09:51.733

正如 Paul Stovell 的[文章](http://www.codeproject.com/KB/cs/DelegateBusinessObjects.aspx)所提到的，您可以通过实现 IDataErrorInfo 接口在业务对象中实现无错误验证。这样做将允许[WinForm 的 ErrorProvider](http://www.codegod.de/WebAppCodeGod/objectdatasource-and-idataerrorinfo-with-winforms-AID427.aspx)和[WPF 与验证规则的绑定](http://blogs.msdn.com/wpfsdk/archive/2007/10/02/data-validation-in-3-5.aspx)通知用户错误。验证对象属性的逻辑存储在一个方法中，而不是存储在每个属性获取器中，并且您不必求助于 CSLA 或验证应用程序块等框架。

就阻止用户将焦点移出文本框而言：首先，这通常不是最佳实践。用户可能希望无序填写表单，或者，如果验证规则依赖于多个控件的结果，则用户可能必须填写一个虚拟值才能离开一个控件来设置另一个控件。也就是说，这可以通过将 Form 的`AllowValidate`属性设置为其默认值`EnableAllowFocusChange` 并订阅 Control.Validating 事件来实现：

```
 private void textBox1_Validating(object sender, CancelEventArgs e)
    {
        if (textBox1.Text != String.Empty)
        {
            errorProvider1.SetError(sender as Control, "Can not be empty");
            e.Cancel = true;
        }
        else
        {
            errorProvider1.SetError(sender as Control, "");
        }
    } 
```

使用存储在业务对象中的规则进行此验证有点棘手，因为在焦点更改和数据绑定业务对象更新之前调用了 Validating 事件。

* * *

## 回答 #12

> 赞同：1
> 
> 时间：2008-09-17T23:38:07.560

在您的情况下抛出异常很好。您可以将这种情况视为真正的例外，因为某些东西正试图将整数设置为字符串（例如）。业务规则对您的视图缺乏了解意味着他们应该将这种情况视为例外并将其返回给视图。

在将输入值发送到业务层之前是否验证输入值取决于您，我认为只要您在整个应用程序中遵循相同的标准，那么您最终将获得干净且可读的代码。

您可以使用上面指定的 spring 框架，只是要小心，因为链接文档中的大部分都指示编写非强类型的代码，IE 您可能会在运行时遇到无法在编译时获取的错误。这是我尽量避免的事情。

我们目前这样做的方式是，我们从屏幕上获取所有输入值，将它们绑定到数据模型对象，如果值错误则抛出异常。

* * *

## 回答 #13

> 赞同：1
> 
> 时间：2008-09-18T03:21:48.460

如果数据无效，您是否考虑过在 setter 中引发事件？这将避免引发异常的问题，并消除显式检查对象是否存在“无效”标志的需要。您甚至可以传递一个参数来指示哪个字段验证失败，以使其更易于重用。

如果需要，事件的处理程序应该能够将焦点重新放在适当的控件上，并且它可以包含通知用户错误所需的任何代码。此外，您可以简单地拒绝连接事件处理程序，并在需要时随意忽略验证失败。

* * *

## 回答 #14

> 赞同：1
> 
> 时间：2008-09-18T00:24:36.920

In my experience, validation rules are seldom universal across all screens/forms/processes in an application. Scenarios like this are common: on the add page, it may be ok for a Person object not to have a last name, but on the edit page it must have a last name. That being the case I've come to believe that validation should happen outside of an object, or the rules should be injected into the object so the rules can change given a context. Valid/Invalid should be an explicit state of the object after validation or one that can be derived by checking a collection for failed rules. A failed business rule is not an exception IMHO.

* * *

## 回答 #15

> 赞同：1
> 
> 时间：2008-09-17T23:17:04.477

您可能想考虑[一下 Spring 框架采用的方法](http://static.springframework.org/spring/docs/2.5.x/reference/validation.html)。如果您使用的是 Java（或 .NET），则可以按原样使用 Spring，但即使您不是，您仍然可以使用该模式；您只需要编写自己的实现即可。

* * *

## 回答 #16

> 赞同：0
> 
> 时间：2008-09-17T23:12:08.823

我认为这是一个可以抛出异常的例子。您的属性可能没有任何上下文来纠正问题，因为这样的异常是正常的，调用代码应该处理这种情况，如果可能的话。

* * *

## 回答 #17

> 赞同：0
> 
> 时间：2008-09-17T23:15:48.613

如果输入超出业务对象实现的业务规则，我会说这是业务对象未处理的情况。因此我会抛出一个异常。即使在您的示例中设置器会“处理” 5，但业务对象不会。

但是，对于更复杂的输入组合，需要验证方法，否则您最终会得到分散在各处的相当复杂的验证。

在我看来，您必须根据允许/不允许输入的复杂性来决定采用哪种方式。

* * *

## 回答 #18

> 赞同：0
> 
> 时间：2009-08-27T00:51:16.643

我认为这取决于你的商业模式有多重要。如果你想走 DDD 的路，你的模型是最重要的。因此，您希望它始终处于有效状态。

在我看来，大多数人都试图用域对象做太多事情（与视图通信、持久化到数据库等），但有时你需要更多的层和更好的关注点分离，即一个或多个视图模型。然后，您可以在视图模型上应用无异常验证（对于不同的上下文，验证可能会有所不同，例如，Web 服务/网站/等）并将异常验证保留在您的业务模型中（以防止模型被破坏）。您将需要一个（或多个）应用程序服务层来将您的视图模型与您的业务模型映射。业务对象不应被通常与特定框架相关的验证属性所污染，例如 NHibernate Validator。

# performance - Perl：为什么 if 语句比“and”慢？

> ID：88546
> 
> 赞同：2
> 
> 时间：2008-09-17T23:05:00.323
> 
> 标签：performance, perl

在 Perl 中，条件可以表示为

```
if (condition) { do something } 
```

或作为

```
(condition) and do { do something } 
```

有趣的是，第二种方式似乎快了大约 10%。有谁知道为什么？

* * *

## 回答 #1

> 赞同：18
> 
> 时间：2008-09-18T09:18:35.200

以下关于 deparse 的一些评论：

首先，不要使用 B::Terse，它已经过时了。B::Concise 一旦你习惯了它就会给你更好的信息。

其次，您已经使用给定的文字代码运行它，因此条件被视为碰巧为真的裸词，因此布尔检查在两种情况下都被优化掉了，这违背了目的。

第三，没有额外的操作码 - “null”表示已优化掉的操作码（完全在执行树之外，但仍在解析树中。）

这是这两种情况的简明执行树，显示它们相同：

```
$ perl -MO=Concise,-exec -e'($condition) and do { do something }'
1  <0> enter 
2  <;> nextstate(main 2 -e:1) v
3  <#> gvsv[*condition] s
4  <|> and(other->5) vK/1
5      <$> const[PV "something"] s/BARE
6      <1> dofile vK/1
7  <@> leave[1 ref] vKP/REFC
-e syntax OK
$ perl -MO=Concise,-exec -e'if ($condition) { do something }'
1  <0> enter 
2  <;> nextstate(main 3 -e:1) v
3  <#> gvsv[*condition] s
4  <|> and(other->5) vK/1
5      <$> const[PV "something"] s/BARE
6      <1> dofile vK/1
7  <@> leave[1 ref] vKP/REFC
-e syntax OK 
```

* * *

## 回答 #2

> 赞同：11
> 
> 时间：2008-09-18T03:52:07.700

这只是表明，如果您不知道如何进行正确的代码分析，请不要做这些事情。这两种方法的速度差异在相同的 Big O() 速度范围内（正如@Leon Timmermans 操作码分析所证明的那样）——基准测试只会显示基于其他本地条件的差异，不一定是您的代码。

@Svante 说“and”更快，@shelfoo 说“if”更快。

我的意思是真的...... 1000 万次循环的百分之七秒变化？从统计学上讲，这不是更快或更慢……那是相等的。

与其查看像这样的微小时序，不如学习代码重构和大 O() 表示法……如何减少代码中的循环数……最重要的是，如何使用代码分析器来查看真正的瓶颈是。不要担心统计上微不足道的东西。;)

* * *

## 回答 #3

> 赞同：11
> 
> 时间：2008-09-17T23:17:01.293

我已经对它进行了解析，它真的不应该更快。第一个操作码树是

```
LISTOP (0x8177a18) leave [1] 
    OP (0x8176590) enter 
    COP (0x8177a40) nextstate 
    LISTOP (0x8177b20) scope 
        OP (0x81779b8) null [174] 
        UNOP (0x8177c40) dofile 
            SVOP (0x8177b58) const [1] PV (0x81546e4) "something" 
```

第二个的操作码树是

```
LISTOP (0x8177b28) leave [1] 
    OP (0x8176598) enter 
    COP (0x8177a48) nextstate 
    UNOP (0x8177980) null 
        LISTOP (0x8177ca0) scope 
            OP (0x81779c0) null [174] 
            UNOP (0x8177c48) dofile 
                SVOP (0x8177b60) const [1] PV (0x81546e4) "something" 
```

我真的不明白后者怎么会更快。它执行更多操作码！

* * *

## 回答 #4

> 赞同：3
> 
> 时间：2008-09-18T03:55:06.133

在平均之前你做了多少测试？非常非常小的偏差在统计上是不显着的！速度在测试之间略有不同的原因有很多。

* * *

## 回答 #5

> 赞同：2
> 
> 时间：2008-09-18T00:35:39.717

根据基准，第二个稍慢。可能它与条件有关，但这是一个非常简单的情况的结果：

```
 use Benchmark;

timethese(10000000, {
    'if' => '$m=5;if($m > 4){my $i=0;}',
    'and' => '$m=5; $m > 4 and do {my $i =0}',
}); 

```

结果：

```
 Benchmark: timing 10000000 iterations of Name1, Name2...
     if:  3 wallclock secs ( 2.94 usr +  0.01 sys =  2.95 CPU) @ 3389830.51/s (n=10000000)
     and:  3 wallclock secs ( 3.01 usr +  0.01 sys =  3.02 CPU) @ 3311258.28/s (n=10000000) 

```

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2008-09-18T15:34:33.173

它也可能取决于 Perl 的版本。你没有提到的。无论如何，差异不足以担心。所以使用任何更有意义的东西。

# c++ - 在 Python 中，您如何使用诸如 C++ 的标记化输入？

> ID：88554
> 
> 赞同：2
> 
> 时间：2008-09-17T23:06:21.943
> 
> 标签：c++, python, input

在*C++*中，我可以接受这样的输入：

```
cin >> a >> b >> c; 
```

并且`a`可以`int`，`b`可以`float`，并且可以是任何东西......我如何在*python*`c`中做同样的事情？

 *`input()`而且`raw_input()`，我使用它们的方式似乎并没有给我想要的结果。

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2008-09-17T23:12:21.930

您通常不应该`input()`在生产代码中使用。如果你想要一个`int`然后是一个`float`，试试这个：

```
>>> line = raw_input().split()
>>> a = int(line[0])
>>> b = float(line[1])
>>> c = " ".join(line[2:]) 
```

这一切都取决于您到底想要完成什么，但请记住可读性很重要。晦涩的单行代码可能看起来很酷，但面对可维护性，请尝试选择明智的东西:)

（PS：不要忘记检查错误`try: ... except (ValueError, IndexError):`）

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2008-09-17T23:35:49.297

由于 C++ cin 是从 sys.stdin 读取的，因此您通常会执行类似以下的操作。

```
import sys
tokens= sys.stdin.read().split()
try:
   a= int(token[0])
   b= float(token[1])
except ValueError, e:
   print e # handle the invalid input 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2008-09-17T23:12:46.217

根据您在做什么，[getopt](http://docs.python.org/lib/module-getopt.html)模块之类的东西可能很有用，但仅在某些情况下，我不确定它是否适用于您的情况。

# c++ - C++派生类问题

> ID：88558
> 
> 赞同：1
> 
> 时间：2008-09-17T23:06:49.383
> 
> 标签：c++, inheritance

我正在用 C++ 制作游戏，但我的派生类有问题。我有一个名为 GameScreen 的基类，它有一个没有语句的虚拟 void draw() 函数。我还有一个名为 MenuScreen 的派生类，它也有一个虚拟 void draw() 函数和一个来自 MenuScreen 的名为 TestMenu 的派生类，它也有一个 void draw() 函数。在我的程序中，我有一个 GameScreen 列表，我有一个 GameScreen 迭代器通过调用每个 GameScreens draw() 函数。

问题是我在 GameScreen 列表中放置了一个 TestMenu 对象。不是迭代器调用 TestMenu 的 draw() 函数，而是调用 GameScreen 类的 draw() 函数。有谁知道我如何调用 TestMenu 的 draw() 函数而不是 GameScreen 中的函数。

这是功能：

```
// Tell each screen to draw itself.
//gsElement is a GameScreen iterator
    //gsScreens is a list of type GameScreen
void Draw()
{
    for (gsElement = gsScreens.begin(); gsElement != gsScreens.end(); gsElement++)
    {
        /*if (gsElement->ssState == Hidden)
            continue;*/

        gsElement->Draw();
    }
} 
```

这是我的课程的副本：

```
class GameScreen {
public:
    string strName;
    bool bIsPopup;
    bool bOtherScreenHasFocus;
    ScreenState ssState;
    //ScreenManager smScreenManager;

    GameScreen(string strName){
        this->strName = strName;
    }

    //Determine if the screen should be drawn or not
    bool IsActive(){
        return !bOtherScreenHasFocus && 
            (ssState == Active);
    }

    //------------------------------------
    //Load graphics content for the screen
    //------------------------------------
    virtual void LoadContent(){
    }

    //------------------------------------
    //Unload content for the screen
    //------------------------------------
    virtual void UnloadContent(){
    }

    //-------------------------------------------------------------------------
    //Update changes whether the screen should be updated or not and sets
    //whether the screen should be drawn or not.
    //
    //Input:
    //  bOtherScreenHasFocus - is used set whether the screen should update
    //  bCoveredByOtherScreen - is used to set whether the screen is drawn or not
    //-------------------------------------------------------------------------
    virtual void Update(bool bOtherScreenHasFocus, bool bCoveredByOtherScreen){
        this->bOtherScreenHasFocus = bOtherScreenHasFocus;

        //if the screen is covered by another than change the screen state to hidden
        //else set the screen state to active
        if(bCoveredByOtherScreen){
            ssState = Hidden;
        }
        else{
            ssState = Active;
        }
    }

    //-----------------------------------------------------------
    //Takes input from the mouse and calls appropriate actions
    //-----------------------------------------------------------
    virtual void HandleInput(){
    }

    //----------------------
    //Draw content on screen
    //----------------------
    virtual void Draw(){
    }

    //--------------------------------------
    //Deletes screen from the screen manager
    //--------------------------------------
    void ExitScreen(){
        //smScreenManager.RemoveScreen(*this);
    }
};

class MenuScreen: public GameScreen{
public:
    vector <BUTTON> vbtnMenuEntries; 

    MenuScreen(string strName):GameScreen(strName){
    }

    virtual void Update(bool bOtherScreenHasFocus, bool bCoveredByOtherScreen){
        GameScreen::Update(bOtherScreenHasFocus, bCoveredByOtherScreen);

        for(unsigned int i = 0; i < vbtnMenuEntries.size(); i++){
            vbtnMenuEntries[i].IsPressed();
        }
    }

    virtual void Draw(){
        GameScreen::Draw();

        for(unsigned int i = 0; i < vbtnMenuEntries.size(); i++)
            vbtnMenuEntries[i].Draw();
    }

};

class testMenu : public MenuScreen{
public:
    vector<OBJECT> test;
    //OBJECT background3();
//  OBJECT testPic(512, 384, buttonHover.png, 100, 40, 100, 40);
//  BUTTON x(256, 384, buttonNormal.png, buttonHover.png, buttonPressed.png, 100, 40, test());
    bool draw;

    testMenu():MenuScreen("testMenu"){
        OBJECT background3(1, 1, 0, TEXT("background.png"), 1, 1, 1024, 768);
        OBJECT testPic(512, 384,0, TEXT("buttonHover.png"), 1, 1, 100, 40);
        test.push_back(background3);
        test.push_back(testPic);
        //background3.Init(int xLoc, int yLoc, int zLoc, LPCTSTR filePath, int Rows, int Cols, int Width, int Height)
        //test.push_back(background3);
    //  vbtnMenuEntries.push_back(x);
        draw = false;
    }

    void Update(bool bOtherScreenHasFocus, bool bCoveredByOtherScreen){
        MenuScreen::Update(bOtherScreenHasFocus, bCoveredByOtherScreen);
        //cout << "X" << endl;
        /*if(MouseLButton == true){
            testMenu2 t;
            smManager.AddScreen(t);
        }*/
    }

    void Draw(){
        //background3.Draw();
        test[0].Draw();
        test[1].Draw();
        MenuScreen::Draw();
    ///*if(draw){*/
    //  testPic.Draw();
    //}
}

/*void test(){
    draw = true;
}*/

}; 
```

* * *

## 回答 #1

> 赞同：9
> 
> 时间：2008-09-17T23:18:40.447

如果 gsScreens 是对象列表而不是指针列表（如您的代码所示），那么您不会存储您认为存储在其中的内容。

发生的事情是 -- 不是将 TestMenu 放入列表中，而是使用编译器生成的复制构造函数构造一个新的 MenuScreen 并将此 MenuScreen 放入列表中。

C++ 通过指针实现多态，所以如果你没有指针，你就不会得到多态行为。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2008-09-18T06:57:47.613

要获得您所追求的多态行为并同时使用 a `std::vector<>`，您必须将*指向*基类类型的指针存储在向量中，而不是存储*values*。此外，您必须记住在向量超出范围之前释放它们的内存。

例如：

```
#include <vector>
#include <algorithm>

struct Base
{
    virtual void Foo() = 0;
    virtual ~Base() { }
};

struct Derived1 : public Base
{
    void Foo() { }
};

struct Derived2 : public Base
{
    void Foo() { }
};

struct delete_ptr
{
    template <typename T>
    void operator()(T& p)
    {
        delete p;
        p = 0;
    }
};

int wmain(int, wchar_t*[])
{
    std::vector<Base*> items;
    items.push_back(new Derived1);
    items.push_back(new Derived2);

    Base& first = items.front();
    first.Foo(); // Will boil down to Derived1::Foo().

    Base& last = items.back();
    last.Foo(); // Will boil down to Derived2::Foo().

    std::for_each(items.begin(), items.end(), delete_ptr())
}; 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2008-09-18T07:05:11.450

[Curt](https://stackoverflow.com/questions/88558/c-derived-class-problems#88620)是绝对正确的，但我只想提供更多信息。

这个问题（存储基类对象，而不是指针）有时被称为“切片”。

另外，我倾向于使用以下宏：

```
#define DISALLOW_COPYING(X) \
    private: \
        X(const X &); \
        const X& operator= (const X& x) 
```

然后你把它放在你的类定义中的某个地方：

```
class Foo {
    // ...
    DISALLOW_COPYING(Foo);
}; 
```

如果另一个类尝试复制该对象，您将收到编译器错误（因为这些方法被声明为私有）。如果类本身尝试复制对象，您将收到链接器错误（因为方法没有实现）。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2008-09-18T16:51:04.363

Boost（www.boost.org，一个我推荐任何使用 C++ 编码的人的库）提供了一个不可复制的基类，可以做到这一点；这样你就不需要丑陋的宏了。

# php - 如何从 drupal 中的 cron 作业创建节点？

> ID：88566
> 
> 赞同：7
> 
> 时间：2008-09-17T23:08:32.000
> 
> 标签：php, drupal, drupal-6

在 drupal 4.7 的自定义模块中，我将一个节点对象组合在一起并将其传递给 node_save($node) 以创建节点。这个 hack 似乎不再适用于 drupal 6。虽然我确信这个 hack 可以修复，但我很好奇是否有一个标准的解决方案来创建没有表单的节点。在这种情况下，数据是从另一个网站上的自定义提要中提取的。

* * *

## 回答 #1

> 赞同：12
> 
> 时间：2008-09-18T06:09:19.913

实现这一点的最佳实践方法是利用 drupal_execute。drupal_execute 将运行标准验证和基本节点操作，以便事情按照系统预期的方式运行。drupal_execute 有其怪癖，比简单的 node_save 稍微不那么直观，但是，在 Drupal 6 中，您可以通过以下方式使用 drupal_execute。

```
 $form_id = 'xxxx_node_form'; // where xxxx is the node type
$form_state = array();
$form_state['values']['type'] = 'xxxx'; // same as above
$form_state['values']['title'] = 'My Node Title';
// ... repeat for all fields that you need to save
// this is required to get node form submits to work correctly
$form_state['submit_handlers'] = array('node_form_submit');

$node = new stdClass();
// I don't believe anything is required here, though 
// fields did seem to be required in D5

drupal_execute($form_id, $form_state, $node); 

```

* * *

## 回答 #2

> 赞同：9
> 
> 时间：2009-01-18T03:57:42.813

node_save() 在 Drupal 6 中仍然可以正常工作；您需要一些特定的数据才能使其正常工作。

```
$node = new stdClass();
$node->type = 'story';
$node->title = 'This is a title';
$node->body = 'This is the body.';
$node->teaser = 'This is the teaser.';
$node->uid = 1;
$node->status = 1;
$node->promote = 1;

node_save($node); 
```

“状态”和“提升”很容易被忽略——如果您不设置它们，节点将保持未发布和未提升状态，您只能在进入内容管理屏幕时看到。

* * *

## 回答 #3

> 赞同：6
> 
> 时间：2008-09-18T00:19:55.730

我不知道实用地创建节点的标准 API。但这就是我从构建一个可以执行您尝试执行的操作的模块中收集到的信息。

1.  确保设置了重要字段：uid、名称、类型、语言、标题、正文、过滤器（请参阅`node_add()`和`node_form()`）
2.  传递节点，`node_object_prepare()`以便其他模块可以添加到 $node 对象。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2008-09-18T09:00:44.650

我发现的另一个答案是使用drupal 核心中 blogapi 模块中[的示例](http://api.drupal.org/api/function/blogapi_blogger_new_post/6)。它在核心中的事实让我更加相信它将在未来的版本中继续工作。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2008-09-18T14:14:53.943

上面有一些很好的答案，但是在将摄取的提要项转换为节点的具体示例中，您还可以采用使用 simplefeed 模块（[http://wwww.drupal.org/project/simplefeed](http://wwww.drupal.org/project/simplefeed)）的方法。该模块使用 simplepie 引擎来摄取提要并将每个提要中的单个项目转换为节点。我意识到这并没有专门解决从 cron 创建节点的问题，但它可能是一个更容易解决您的问题的整体问题。

# regex - 正则表达式捕获和替换可以与 Apache DirectoryMatch 指令一起使用吗？

> ID：88570
> 
> 赞同：5
> 
> 时间：2008-09-17T23:09:47.707
> 
> 标签：regex, apache

有谁知道是否可以在 Apache 的 DirectoryMatch 指令中使用正则表达式捕获？我想做类似以下的事情：

```
<DirectoryMatch ^/home/www/(.*)>
    AuthType Basic
    AuthName $1
    AuthUserFile /etc/apache2/svn.passwd
    Require group $1 admin
</DirectoryMatch> 
```

但到目前为止，我还没有成功。

具体来说，我正在尝试为 Apache 2.0 中的服务器上的各个目录/虚拟主机创建基于组的 HTTP 身份验证。

例如，指向 /home/www/a 的站点 A 将对组 admin 和组 a 中的所有用户可用，位于 /home/www/b 的站点 b 将对组 admin 和组 b 中的所有用户可用，等等. 我想根据目录名称保留所有内容，以便我可以轻松地将 htpasswd 用户添加到正确的组并尽可能自动化，但当然欢迎其他解决问题的建议。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2008-09-18T10:43:08.617

你可以从一个完全不同的角度来解决这个问题：启用 perl 模块，你可以在你的 httpd.conf 中包含一个小的 perl 脚本。然后你可以做这样的事情：

```
<Perl>
my @groups = qw/ foo bar baz /;
foreach ( @groups ) {
    push @PerlConfig, qq| <Directory /home/www/$_> blah </Directory> |;
}
</Perl> 
```

这样，您甚至可以从数据库中读取您的群组和其他信息，或者通过简单地查找 /home/www 或其他任何您喜欢的内容。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2008-09-17T23:33:49.163

您尝试执行的操作与[per-user home directory](http://httpd.apache.org/docs/2.0/howto/public_html.html)非常相似。Apache 处理这些问题的方式是通过文件系统权限和[.htaccess 文件](http://httpd.apache.org/docs/1.3/howto/htaccess.html)。我不相信有任何方法可以在随附的指令（AuthName 等）中使用正则表达式捕获。

# c# - 并排运行 SharpDevelop 3.0 和 Visual Studio 2008 有什么问题吗？

> ID：88571
> 
> 赞同：2
> 
> 时间：2008-09-17T23:10:14.447
> 
> 标签：c#, visual-studio, sharpdevelop

我被要求帮助几个朋友正在从事的一个爱好项目，他们正在使用 SharpDevelop 3.0（我认为是 Beta 2，但它可能是 Beta 1）我安装和使用这个 IDE 有什么麻烦吗假设我安装了 Visual Studio 2008？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2008-09-17T23:13:27.527

我一点问题都没有，事实上，sharpdevelop 中的一些工具（如 vb.net -> c# 转换器）非常好用。

此外，sharpdevelop 还包含一些很好的库，它们也很方便（比如用于 zip 文件的 sharpziplib）

我现在实际上安装了 VS2005、VS2008、SharpDevelop 和 VisualStudio 6，而且 MS 的工具比#develop 存在更多的兼容性问题。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2008-09-17T23:14:10.490

他们一起表现得很好，我已经安装了 2003、2005 和 2008 的 SharpDevelop。完全没有问题。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2008-09-18T03:32:16.983

我有一段时间没有安装 SharpDevelop，但是当我安装时遇到的唯一问题是我无法轻松共享解决方案文件。如果您不介意有两种不同的解决方案，那么应该没有问题。

# c++ - 我应该在 C++ 中使用异常说明符吗？

> ID：88573
> 
> 赞同：129
> 
> 时间：2008-09-17T23:10:25.147
> 
> 标签：c++, function, exception, throw, specifier

在 C++ 中，您可以通过使用异常说明符来指定函数可能会或可能不会抛出异常。例如：

```
void foo() throw(); // guaranteed not to throw an exception
void bar() throw(int); // may throw an exception of type int
void baz() throw(...); // may throw an exception of some unspecified type 
```

由于以下原因，我对实际使用它们表示怀疑：

1.  编译器并没有真正以任何严格的方式强制执行异常说明符，因此好处并不大。理想情况下，您希望得到一个编译错误。
2.  如果一个函数违反了异常说明符，我认为标准行为是终止程序。
3.  在 VS.Net 中，它将 throw(X) 视为 throw(...)，因此对标准的遵守并不强。

你认为应该使用异常说明符吗？
请回答“是”或“否”，并提供一些理由来证明您的回答是正确的。

* * *

## 回答 #1

> 赞同：101
> 
> 时间：2008-09-18T00:26:36.477

不。

以下是几个例子：

1.  模板代码不可能用异常规范编写，

    ```
    template<class T>
    void f( T k )
    {
         T x( k );
         x.x();
    } 
    ```

    副本可能会抛出，参数传递可能会抛出，并且`x()`可能会抛出一些未知的异常。

2.  异常规范倾向于禁止可扩展性。

    ```
    virtual void open() throw( FileNotFound ); 
    ```

    可能演变成

    ```
    virtual void open() throw( FileNotFound, SocketNotReady, InterprocessObjectNotImplemented, HardwareUnresponsive ); 
    ```

    你真的可以写成

    ```
    throw( ... ) 
    ```

    第一个不可扩展，第二个过于雄心勃勃，第三个才是真正的意思，当您编写虚函数时。

3.  旧代码

    当你编写依赖于另一个库的代码时，你真的不知道当出现可怕的错误时它会做什么。

    ```
    int lib_f();

    void g() throw( k_too_small_exception )
    { 
       int k = lib_f();
       if( k < 0 ) throw k_too_small_exception();
    } 
    ```

    `g`将终止，当`lib_f()`抛出。这（在大多数情况下）不是您真正想要的。`std::terminate()`永远不应该被调用。让应用程序因未处理的异常崩溃（您可以从中检索堆栈跟踪）总是比静默/暴力死亡要好。

4.  编写返回常见错误并在特殊情况下抛出的代码。

    ```
    Error e = open( "bla.txt" );
    if( e == FileNotFound )
        MessageUser( "File bla.txt not found" );
    if( e == AccessDenied )
        MessageUser( "Failed to open bla.txt, because we don't have read rights ..." );
    if( e != Success )
        MessageUser( "Failed due to some other error, error code = " + itoa( e ) );

    try
    {
       std::vector<TObj> k( 1000 );
       // ...
    }
    catch( const bad_alloc& b )
    { 
       MessageUser( "out of memory, exiting process" );
       throw;
    } 
    ```

然而，当您的库只是抛出您自己的异常时，您可以使用异常规范来说明您的意图。

* * *

## 回答 #2

> 赞同：42
> 
> 时间：2008-09-17T23:21:40.283

避免 C++ 中的异常规范。您在问题中给出的原因是一个很好的开始。

请参阅 Herb Sutter 的[“A Pragmatic Look at Exception Specifications”](http://www.gotw.ca/publications/mill22.htm)。

* * *

## 回答 #3

> 赞同：14
> 
> 时间：2008-09-18T03:38:37.047

我认为标准的例外约定（对于 C++）
异常说明符是 C++ 标准中的一个实验，大部分都失败了。
例外是 no throw 说明符很有用，但您还应该在内部添加适当的 try catch 块以确保代码与说明符匹配。Herb Sutter 有一个关于这个主题的页面。[得到82](http://www.gotw.ca/gotw/082.htm)

此外，我认为值得描述异常保证。

这些基本上是关于对象状态如何受到在该对象上转义方法的异常影响的文档。不幸的是，编译器没有强制执行或以其他方式提及它们。
[提升和例外](http://www.boost.org/community/exception_safety.html)

## 例外保证

### 无保证：

> 异常转义方法后无法保证对象的状态
> 在这些情况下，不应再使用对象。

### 基本保证：

> 在几乎所有情况下，这应该是方法提供的最低保证。
> 这保证了对象的状态被很好地定义并且仍然可以被一致地使用。

### 强有力的保证：（又名交易保证）

> 这保证了方法将成功完成，
> 否则将抛出异常并且对象状态不会改变。

### 无投掷保证：

> 该方法保证不允许任何异常传播到该方法之外。
> 所有的析构函数都应该做出这个保证。
> | NB 如果在异常已经传播时异常从析构函数中转义
> | 应用程序将终止

* * *

## 回答 #4

> 赞同：8
> 
> 时间：2008-09-18T03:26:36.903

当您违反异常规范时，gcc 将发出警告。我所做的是使用宏仅在“lint”模式下使用异常规范，明确编译以检查以确保异常与我的文档一致。

* * *

## 回答 #5

> 赞同：7
> 
> 时间：2008-09-18T20:29:26.790

唯一有用的异常说明符是“throw()”，如“不抛出”。

* * *

## 回答 #6

> 赞同：4
> 
> 时间：2008-10-20T19:17:40.467

异常规范在 C++ 中并不是非常有用的工具。但是，如果与 std::unexpected 结合使用，/is/ 对它们很有用。

我在一些项目中所做的是带有异常规范的代码，然后调用 set_unexpected() 函数，该函数将抛出我自己设计的特殊异常。此异常在构造时获得回溯（以特定于平台的方式）并从 std::bad_exception 派生（以允许在需要时传播它）。如果它像通常那样导致终止（）调用，则回溯由what（）打印（以及导致它的原始异常；不难找到），所以我得到了我的合同在哪里的信息违反，例如抛出什么意外的库异常。

如果我这样做，我绝不允许传播库异常（std 异常除外）并从 std::exception 派生我的所有异常。如果库决定抛出，我将捕获并转换为我自己的层次结构，让我始终控制代码。出于显而易见的原因，调用依赖函数的模板函数应该避免异常规范；但无论如何，很少有带有库代码的模板化函数接口（很少有库真正以有用的方式使用模板）。

* * *

## 回答 #7

> 赞同：3
> 
> 时间：2008-09-17T23:13:54.500

如果您编写的代码将被那些宁愿查看函数声明而不是任何注释的人使用，那么规范将告诉他们他们可能想要捕获哪些异常。

否则，我发现使用任何东西都不是特别有用，只是`throw()`表明它不会引发任何异常。

* * *

## 回答 #8

> 赞同：3
> 
> 时间：2008-09-19T01:49:04.413

否。如果您使用它们并且抛出了您未指定的异常，无论是由您的代码还是由您的代码调用的代码，那么默认行为是立即终止您的程序。

此外，我相信它们的使用在当前的 C++0x 标准草案中已被弃用。

* * *

## 回答 #9

> 赞同：3
> 
> 时间：2010-03-01T15:13:31.590

如果编译器知道函数永远不会抛出异常（或至少承诺永远不会抛出异常），“throw()”规范允许编译器在进行代码流分析时执行一些优化。拉里·奥斯特曼（Larry Osterman）在这里简要谈到了这一点：

[http://blogs.msdn.com/larryosterman/archive/2006/03/22/558390.aspx](http://blogs.msdn.com/larryosterman/archive/2006/03/22/558390.aspx)

* * *

## 回答 #10

> 赞同：2
> 
> 时间：2008-09-17T23:12:59.617

通常我不会使用异常说明符。但是，如果任何其他异常来自所讨论的函数，程序肯定无法*纠正*，那么它可能很有用。在所有情况下，请确保清楚地记录该函数可能会出现哪些异常。

是的，从具有异常说明符的函数抛出的未指定异常的预期行为是调用 terminate()。

我还将注意到 Scott Meyers 在更有效的 C++ 中解决了这个主题。他的 Effective C++ 和 More Effective C++ 是强烈推荐的书籍。

* * *

## 回答 #11

> 赞同：2
> 
> 时间：2008-09-17T23:17:13.243

是的，如果您喜欢内部文档。或者也许编写一个其他人将使用的库，这样他们就可以在不查阅文档的情况下知道发生了什么。扔或不扔可以被认为是 API 的一部分，几乎就像返回值一样。

我同意，它们对于在编译器中强制 Java 风格的正确性并没有真正有用，但总比没有或随意的评论好。

* * *

## 回答 #12

> 赞同：2
> 
> 时间：2008-09-17T23:26:58.773

它们对于单元测试很有用，因此在编写测试时，您知道函数失败时会抛出什么，但编译器中没有围绕它们的强制措施。我认为它们是 C++ 中不需要的额外代码。无论您选择哪一个，您都应该确定的是，您在整个项目和团队成员中遵循相同的编码标准，以便您的代码保持可读性。

* * *

## 回答 #13

> 赞同：0
> 
> 时间：2009-12-21T17:11:39.740

来自文章：

[http://www.boost.org/community/exception_safety.html](http://www.boost.org/community/exception_safety.html)

> “众所周知，编写异常安全的通用容器是不可能的。” 这种说法经常在参考 Tom Cargill [4] 的一篇文章时听到，他在该文章中探讨了通用堆栈模板的异常安全问题。在他的文章中，嘉吉提出了许多有用的问题，但遗憾的是未能提出解决他的问题的方法。1 他最后指出，解决方案可能是不可能的。不幸的是，他的文章被许多人视为这种猜测的“证据”。自发布以来，已经有许多异常安全通用组件的示例，其中包括 C++ 标准库容器。

事实上，我可以想办法让模板类异常安全。除非您无法控制所有子类，否则无论如何您都可能遇到问题。为此，可以在您的类中创建定义各种模板类抛出的异常的 typedef。这认为问题总是在事后解决，而不是从一开始就设计它，我认为真正的障碍是这种开销。

* * *

## 回答 #14

> 赞同：-2
> 
> 时间：2008-10-20T19:22:28.850

异常规范 = 垃圾，询问任何 30 岁以上的 Java 开发人员

# pdf - PDF文件的结构？

> ID：88582
> 
> 赞同：80
> 
> 时间：2008-09-17T23:11:33.757
> 
> 标签：pdf

对于一个小项目，我必须解析 pdf 文件并获取其中的特定部分（一个简单的字符链）。我想使用 python 来做到这一点，我发现了几个能够以某种方式做我想做的事情的库。

但是现在经过一些研究，我想知道 pdf 文件的真正结构是什么，有谁知道网上是否有规范或一些解释？我在 adobe 上找到了一个链接，但它似乎是一个死链接:(

* * *

## 回答 #1

> 赞同：48
> 
> 时间：2008-09-17T23:13:19.867

这是 Adob​​e 参考资料的链接

[http://www.adobe.com/devnet/pdf/pdf_reference.html](http://www.adobe.com/devnet/pdf/pdf_reference.html)

您应该知道 PDF 仅与演示有关，而不是结构。解析并不容易。

* * *

## 回答 #2

> 赞同：44
> 
> 时间：2014-08-12T15:31:26.117

我发现[GNU Introduction to PDF](https://web.archive.org/web/20141010035745/http://gnupdf.org/Introduction_to_PDF)有助于理解结构。它包括一个易于阅读的[示例 PDF 文件](https://web.archive.org/web/20140624182842/http://www.gnupdf.org/images/d/db/Hello.pdf)，他们详细描述了该文件。

其他有用的链接：

*   [PDF 简洁的书](http://www.syncfusion.com/Content/downloads/ebook/PDF_Succinctly.pdf)更长，并且有有用的图片。
*   [PDF](http://www.adobe.com/content/dam/Adobe/en/technology/pdfs/PDF_Day_A_Look_Inside.pdf)内部介绍是一个不那么深入的演示文稿，但提供了一个快速的概述并且有很多图片。

* * *

## 回答 #3

> 赞同：24
> 
> 时间：2008-09-18T13:26:55.773

当我第一次开始使用 PDF 时，我发现[PDF 参考](http://www.adobe.com/devnet/pdf/pdf_reference.html)非常难以浏览。它可能会帮助您了解文件结构的概述可以在语法中找到，Adobe 所说的文档结构是对象结构而不是文件结构。这也可以在语法中找到。操作符的描述隐藏在附录 A 中——对于理解内容流中发生的事情非常有用。如果您曾经为使用色彩空间而感到痛苦，您会发现它隐藏在图形中！希望这些提示能帮助您比我更快地找到东西。

如果您使用的是 windows，[pdftron CosEdit](http://www.pdftron.com/cosedit)允许您浏览对象结构以了解它。有一个免费的演示版可让您检查文件但不能保存它。

* * *

## 回答 #4

> 赞同：10
> 
> 时间：2008-09-17T23:18:21.197

[这是 PDF 1.7](http://www.adobe.com/devnet/acrobat/pdfs/pdf_reference.pdf)的原始参考，这里是[描述 PDF](http://www.planetpdf.com/developer/article.asp?ContentID=navigating_the_internal_struct)文件结构的文章。如果您使用 Vim，则[pdftk 插件](http://www.accesspdf.com/article.php?story=20041130152129869)是一种探索文档的好方法，其原始形式几乎没有，而[pdftk](http://www.accesspdf.com/index.php?topic=pdftk)实用程序本身（及其 GPL 源代码）是一种将文档分开的好方法。

* * *

## 回答 #5

> 赞同：7
> 
> 时间：2009-07-09T07:13:14.460

我正在尝试做几乎相同的事情。PDF 参考是一个非常难以阅读的文档。[我认为本教程](http://www.planetpdf.com/developer/article.asp?ContentID=navigating_the_internal_struct&page=0)是一个更好的开始。

* * *

## 回答 #6

> 赞同：6
> 
> 时间：2011-07-30T03:54:15.950

这可能有助于阐明一点：（来自 PDF32000.book 的第 11 页）

> 最好将 PDF 语法理解为四个部分，如图 1 所示：
> 
> • 对象。PDF 文档是由一小组基本类型的数据对象组成的数据结构。子条款 7.2，“词汇约定”描述了用于编写对象和其他句法元素的字符集。7.3 节“对象”描述了对象的语法和基本属性。第 7.3.8 节“流对象”提供了最复杂的数据类型流对象的完整细节。
> 
> • 文件结构。PDF 文件结构决定了对象在 PDF 文件中的存储方式、访问方式以及更新方式。这种结构独立于对象的语义。第 7.5 节“文件结构”描述了文件结构。第 7.6 节“加密”描述了一种文件级机制，用于保护文档的内容免受未经授权的访问。
> 
> • 文档结构。PDF 文档结构指定如何使用基本对象类型来表示 PDF 文档的组件：页面、字体、注释等。第 7.7 节“文档结构”描述了整个文档结构；后面的条款解决了组件的详细语义。
> 
> • 内容流。PDF 内容流包含描述页面或其他图形实体外观的指令序列。这些指令虽然也表示为对象，但在概念上与表示文档结构的对象不同，并单独描述。第 7.8 节“内容流和资源”讨论 PDF 内容流及其相关资源。

看起来浏览 PDF 文件需要的不仅仅是简单的努力。

* * *

## 回答 #7

> 赞同：5
> 
> 时间：2013-09-17T11:54:14.020

如果您想使用 Python 解析 PDF，请查看[PDFMINER](http://www.unixuser.org/~euske/python/pdfminer/)。这是迄今为止解析 PDF 文件的最佳库。

* * *

## 回答 #8

> 赞同：4
> 
> 时间：2014-03-02T03:44:13.667

Didier 有一个解析 PDF 的工具：

[http://didierstevens.com/files/software/pdf-parser_V0_4_3.zip](http://didierstevens.com/files/software/pdf-parser_V0_4_3.zip)

或在这里：

[http://blog.didierstevens.com/programs/pdf-tools/](http://blog.didierstevens.com/programs/pdf-tools/)列出了几个相关的 pdf 分析工具。

另一个工具在这里：

[http://mshahzadlatif.wordpress.com/2011/09/28/view-pdf-structure-using-adobe-acrobat-or-a-free-tool-called-pdfxplorer/](http://mshahzadlatif.wordpress.com/2011/09/28/view-pdf-structure-using-adobe-acrobat-or-a-free-tool-called-pdfxplorer/)

* * *

## 回答 #9

> 赞同：2
> 
> 时间：2008-09-19T02:51:42.237

从 PDF 中提取文本是一个难题，因为 PDF 具有这种面向布局的结构。你可以看到我在 CPAN 上勉强成功的尝试的[文档和源代码](http://search.cpan.org/perldoc?getpdftext.pl)（我的实现是在 Perl 中）。PDF 数据结构非常酷且设计精良，但写起来比读起来容易。

* * *

## 回答 #10

> 赞同：2
> 
> 时间：2010-08-24T16:52:37.777

获得一些线索的一种方法是创建一个包含空白页的 PDF 文件。我的电脑上有CutePDF Writer，并制作了一页的空白写字板文档。打印成 .pdf 文件，然后使用记事本打开 .pdf 文件。

接下来，使用此文件的副本并删除可能感兴趣的文本行或文本块，然后在 Acrobat Reader 中重新加载。您会惊讶于制作一个有效的一页 PDF 文档所需的信息是如此之少。

我正在尝试制作一个电子表格来从代码创建一个 PDF 表单。

* * *

## 回答 #11

> 赞同：2
> 
> 时间：2018-12-17T08:06:36.833

您需要 PDF 参考手册才能开始阅读有关 PDF 文件的详细信息和结构的信息。我建议从 1.7 版开始。

在 Windows 上，我使用免费工具[PDF Analyzer](https://www.winking.be/en/products/pdfanalyzer)来查看 PDF 文件的内部结构。这将有助于您在阅读参考手册时理解。

[![在此处输入图像描述](https://i.stack.imgur.com/u6kcS.png)](https://i.stack.imgur.com/u6kcS.png)

*（本人隶属于PDF Analyzer，无意推广）*

* * *

## 回答 #12

> 赞同：0
> 
> 时间：2019-07-26T12:28:13.493

要从 PDF 中提取文本，请在 Linux、BSD 等机器上尝试此操作，或者在 Windows 上使用 Cygwin：

```
pdfinfo -layout some_pdf_file.pdf 
```

创建一个名为的纯文本文件`some_pdf_file.txt`。PDF 文件布局越简单，.txt 文件输出就越简单。

十六进制字符经常出现在 .txt 文件输出中，并且在文本编辑器中看起来很奇怪。这些十六进制字符通常表示 PDF 中的单引号和双引号、项目符号、连字符等。

要查看十六进制字符出现的上下文，请运行此 grep 命令，并将原始 PDF 放在手边，以查看代码在 PDF 中表示的字符：

```
grep -a --color=always "\\\\[0-9][0-9][0-9]" some_pdf_file.txt 
```

这将提供文档中不同八进制代码的唯一列表：

```
grep -ao "\\\\[0-9][0-9][0-9]" some_pdf_file.txt|sort|uniq 
```

要将这些十六进制字符转换为等价的 ASCII 字符，可以使用 grep、sed 和 bc 的组合，我将尽快发布该过程。

# python - 如何将字符串拆分为列表？

> ID：88613
> 
> 赞同：36
> 
> 时间：2008-09-17T23:17:12.150
> 
> 标签：python, string, list, split

如果我有这个字符串：

> 2+24*48/32

创建此列表的最有效方法是什么：

> ['2', '+', '24', '*', '48', '/', '32']

* * *

## 回答 #1

> 赞同：51
> 
> 时间：2008-09-21T16:25:42.300

碰巧您要拆分的令牌已经是 Python 令牌，因此您可以使用内置`tokenize`模块。它几乎是一条线；这个程序：

```
from io import StringIO
from tokenize import generate_tokens

STRING = 1
print(
    list(
        token[STRING]
    for token in generate_tokens(StringIO("2+24*48/32").readline)
    if token[STRING]
    )
) 
```

产生这个输出：

```
['2', '+', '24', '*', '48', '/', '32'] 
```

* * *

## 回答 #2

> 赞同：36
> 
> 时间：2008-09-17T23:25:56.403

You can use `split` from the `re` module.

[re.split(pattern, string, maxsplit=0, flags=0)](http://docs.python.org/library/re.html#re.split)

> Split string by the occurrences of pattern. If capturing parentheses are used in pattern, then the text of all groups in the pattern are also returned as part of the resulting list.

Example code:

```
import re
data = re.split(r'(\D)', '2+24*48/32') 
```

* * *

\D

> When the UNICODE flag is not specified, \D matches any non-digit character; this is equivalent to the set [^0-9].

* * *

## 回答 #3

> 赞同：18
> 
> 时间：2008-09-17T23:54:14.090

这看起来像是一个解析问题，因此我不得不提出一个基于解析技术的解决方案。

虽然您似乎想要“拆分”这个字符串，但我认为您真正想要做的是“标记化”它。标记化或词法分析是解析之前的编译步骤。我在编辑中修改了我的原始示例，以在此处实现适当的递归体面解析器。这是手动实现解析器的最简单方法。

```
import re

patterns = [
    ('number', re.compile('\d+')),
    ('*', re.compile(r'\*')),
    ('/', re.compile(r'\/')),
    ('+', re.compile(r'\+')),
    ('-', re.compile(r'\-')),
]
whitespace = re.compile('\W+')

def tokenize(string):
    while string:

        # strip off whitespace
        m = whitespace.match(string)
        if m:
            string = string[m.end():]

        for tokentype, pattern in patterns:
            m = pattern.match(string)
            if m:
                yield tokentype, m.group(0)
                string = string[m.end():]

def parseNumber(tokens):
    tokentype, literal = tokens.pop(0)
    assert tokentype == 'number'
    return int(literal)

def parseMultiplication(tokens):
    product = parseNumber(tokens)
    while tokens and tokens[0][0] in ('*', '/'):
        tokentype, literal = tokens.pop(0)
        if tokentype == '*':
            product *= parseNumber(tokens)
        elif tokentype == '/':
            product /= parseNumber(tokens)
        else:
            raise ValueError("Parse Error, unexpected %s %s" % (tokentype, literal))

    return product

def parseAddition(tokens):
    total = parseMultiplication(tokens)
    while tokens and tokens[0][0] in ('+', '-'):
        tokentype, literal = tokens.pop(0)
        if tokentype == '+':
            total += parseMultiplication(tokens)
        elif tokentype == '-':
            total -= parseMultiplication(tokens)
        else:
            raise ValueError("Parse Error, unexpected %s %s" % (tokentype, literal))

    return total

def parse(tokens):
    tokenlist = list(tokens)
    returnvalue = parseAddition(tokenlist)
    if tokenlist:
        print 'Unconsumed data', tokenlist
    return returnvalue

def main():
    string = '2+24*48/32'
    for tokentype, literal in tokenize(string):
        print tokentype, literal

    print parse(tokenize(string))

if __name__ == '__main__':
    main() 
```

括号处理的实现留给读者作为练习。这个例子将在加法之前正确地进行乘法运算。

* * *

## 回答 #4

> 赞同：18
> 
> 时间：2008-09-18T02:39:38.903

```
>>> import re
>>> re.findall(r'\d+|\D+', '2+24*48/32=10')

['2', '+', '24', '*', '48', '/', '32', '=', '10'] 
```

匹配连续的数字或连续的非数字。

每个匹配项都作为列表中的一个新元素返回。

根据使用情况，您可能需要更改正则表达式。例如，如果您需要匹配带小数点的数字。

```
>>> re.findall(r'[0-9\.]+|[^0-9\.]+', '2+24*48/32=10.1')

['2', '+', '24', '*', '48', '/', '32', '=', '10.1'] 
```

* * *

## 回答 #5

> 赞同：6
> 
> 时间：2008-09-19T07:37:18.587

这是一个解析问题，因此 regex 和 split() 都不是“好”的解决方案。请改用解析器生成器。

我会仔细研究[pyparsing](http://pyparsing.wikispaces.com/)。[Python Magazine](http://pymag.phparch.com/)中也有一些关于 pyparsing 的不错的文章。

* * *

## 回答 #6

> 赞同：5
> 
> 时间：2008-09-17T23:25:52.833

> > > s = "2+24*48/32"
> > > 
> > > p = re.compile(r'(\W+)')
> > > 
> > > p.split(s)

* * *

## 回答 #7

> 赞同：4
> 
> 时间：2008-09-17T23:21:58.800

Regular expressions:

```
>>> import re
>>> splitter = re.compile(r'([+*/])')
>>> splitter.split("2+24*48/32") 
```

You can expand the regular expression to include any other characters you want to split on.

* * *

## 回答 #8

> 赞同：4
> 
> 时间：2008-09-18T03:07:27.947

另一个解决方案是完全避免编写这样的计算器。编写 RPN 解析器要简单得多，并且没有使用中缀符号编写数学所固有的任何歧义。

```
import operator, math
calc_operands = {
    '+': (2, operator.add),
    '-': (2, operator.sub),
    '*': (2, operator.mul),
    '/': (2, operator.truediv),
    '//': (2, operator.div),
    '%': (2, operator.mod),
    '^': (2, operator.pow),
    '**': (2, math.pow),
    'abs': (1, operator.abs),
    'ceil': (1, math.ceil),
    'floor': (1, math.floor),
    'round': (2, round),
    'trunc': (1, int),
    'log': (2, math.log),
    'ln': (1, math.log),
    'pi': (0, lambda: math.pi),
    'e': (0, lambda: math.e),
}

def calculate(inp):
    stack = []
    for tok in inp.split():
        if tok in self.calc_operands:
            n_pops, func = self.calc_operands[tok]
            args = [stack.pop() for x in xrange(n_pops)]
            args.reverse()
            stack.append(func(*args))
        elif '.' in tok:
            stack.append(float(tok))
        else:
            stack.append(int(tok))
    if not stack:
        raise ValueError('no items on the stack.')
    return stack.pop()
    if stack:
        raise ValueError('%d item(s) left on the stack.' % len(stack))

calculate('24 38 * 32 / 2 +') 
```

* * *

## 回答 #9

> 赞同：1
> 
> 时间：2012-01-14T16:21:15.617

```
>>> import re
>>> my_string = "2+24*48/32"
>>> my_list = re.findall(r"-?\d+|\S", my_string)
>>> print my_list

['2', '+', '24', '*', '48', '/', '32'] 
```

这会成功的。我以前遇到过这种问题。

* * *

## 回答 #10

> 赞同：0
> 
> 时间：2008-09-18T00:45:18.117

我确定蒂姆的意思是

```
splitter = re.compile(r'([\D])'). 
```

如果您完全复制他所记录的内容，您只会得到`digits`不是`operators`.

* * *

## 回答 #11

> 赞同：0
> 
> 时间：2010-08-19T00:38:43.097

这并不能完全回答问题，但我相信它可以解决您想要实现的目标。我会将其添加为评论，但我还没有这样做的权限。

我个人会直接使用 exec 来利用 Python 的数学功能：

> 表达式 = "2+24*48/32"
> **exec** "结果 = " + 表达式
> **打印**结果
> 38

# algorithm - 您可以使用什么算法来查找字符串中的重复短语？

> ID：88615
> 
> 赞同：8
> 
> 时间：2008-09-17T23:18:08.827
> 
> 标签：algorithm, language-agnostic, parsing

给定一个任意字符串，找到重复短语的有效方法是什么？我们可以说短语必须长于一定长度才能被包含在内。

理想情况下，您最终会得到每个短语的出现次数。

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2008-09-18T15:38:29.467

**理论上**

*   *[后缀数组](http://en.wikipedia.org/wiki/Suffix_array)*是“最佳”答案，因为它可以实现为使用线性空间和时间来检测任何重复的子字符串。然而 - 天真的实现实际上需要时间 O(n^2 log n) 来对后缀进行排序，并且如何将其减少到 O(n log n) 并不完全明显，更不用说 O(n)，尽管您可以阅读如果您愿意，请参阅相关文件。
*   *[后缀树](http://en.wikipedia.org/wiki/Suffix_tree)*可能比后缀数组占用更多的内存（尽管仍然是线性的），但更容易实现快速构建，因为您可以在向树中添加内容时使用类似基数排序的想法（请参阅维基百科链接名称以获取详细信息）。
*   *[KMP 算法](http://en.wikipedia.org/wiki/Knuth-Morris-Pratt_algorithm)*也需要注意，它专门用于快速搜索较长字符串中的特定子字符串。如果您只需要这种特殊情况，只需使用 KMP，无需先构建足够的索引。

**在实践中**

我猜您正在分析实际自然语言（例如英语）单词的文档，并且您实际上想对您收集的数据做一些事情。

在这种情况下，您可能只想对一些小的 n 进行快速的[n-gram](http://en.wikipedia.org/wiki/N-gram)分析，例如 n=2 或 3。例如，您可以通过去除标点符号、大写字母、和词干提取（运行，同时运行 -> 'run'）以增加语义匹配。然后只需为每个相邻的单词构建一个哈希映射（例如 C++ 中的 hash_map，python 中的字典等）到它的出现次数。最后，您会得到一些非常有用的数据，这些数据编码起来非常快，而且运行起来也不会很慢。

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2008-09-17T23:49:14.413

就像前面提到的那样，后缀树是完成这项工作的最佳工具。我最喜欢的后缀树网站是[http://www.allisons.org/ll/AlgDS/Tree/Suffix/](http://www.allisons.org/ll/AlgDS/Tree/Suffix/)。它在一页上列举了后缀树的所有漂亮用途，并`js`嵌入了一个测试应用程序来测试字符串并通过示例工作。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2008-09-17T23:23:52.993

[后缀树](http://en.wikipedia.org/wiki/Suffix_tree)是实现这一点的好方法。那篇文章的底部有不同语言实现的链接。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2008-09-17T23:33:24.467

就像 jmah 所说，您可以为此使用后缀树/后缀数组。

[您可以在此处](http://pine.cs.yale.edu/pinewiki/StringAlgorithms)使用一种算法的描述（参见第 3.1 节）。

您可以在他们引用的书（Gusfield，1997 年）中找到更深入的描述，该书[位于 google 图书上](http://books.google.com/books?id=STGlsyqtjYMC&pg=PA152&lpg=PA152&dq=gusfield+7.14.4&source=web&ots=kiN7ABH-u9&sig=j5h8GJmUUWvlzehTUrP2QJjx4Ns&hl=en&sa=X&oi=book_result&resnum=1&ct=result#PPA151,M1)。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2009-02-24T01:40:49.483

假设给定排序数组 A，其中包含 n 个条目 (i=1,2,3,...,n)

```
Algo(A(i))
{
  while i<>n
  {
    temp=A[i];
    if A[i]<>A[i+1] then
    {     
      temp=A[i+1];
      i=i+1;
      Algo(A[i])
    }
    else if A[i]==A[i+1] then
      mark A[i] and A[i+1] as duplicates
  }
} 
```

该算法在 O(n) 时间运行。

# sharepoint - 如何在 SharePoint WebPart 中包含 JavaScript 文件？

> ID：88618
> 
> 赞同：0
> 
> 时间：2008-09-17T23:18:22.727
> 
> 标签：sharepoint, web-parts

我们有一个中等大小的 .js 文件，我们将其包含在我们的 Web 框架中，我将其移植到 SharePoint。但是，我不确定如何进行此操作或最佳实践是什么。这是针对其他客户端项目将使用的框架解决方案，因此最好是自包含和可部署的，而不是需要手动将文件部署到网络服务器。

我目前的想法是将 JavaScript 放入嵌入式资源，然后使用脚本管理器写出文件。这看起来合理吗？或者有人有其他建议吗？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2008-09-17T23:25:14.470

嵌入资源是最好的方式，您不需要使用 ScriptManager 来呈现它（因为 AJAX 未在 SharePoint 上配置 OoB），您可以将其呈现为任何其他客户端脚本资源（通过 ClientScriptManager）。

最好的想法是有一个 if ContainsScriptManager else UsClientScriptManager 样式。这样你就可以两全其美

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2008-09-18T15:15:55.967

你可以把它扔进一个文档库。

如果要将 Web 部件打包到共享点解决方案中，则可以将其作为模块（VSEWSS 项）包含在内。您的清单文件将如下所示：

```
<TemplateFiles>
  <TemplateFile Location="LAYOUTS\somescript.js" />
</TemplateFiles> 
```

网上有很多关于如何做到这一点的信息。我喜欢图像、css 和 javascript 的 doc 库选项，因为每次我对某些样式或脚本进行细微调整时，我不必重建并等待 SP 进行 JIT 编译 30 秒。我只是从文档库中直接在 SPDesigner 中编辑这些内容。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2011-11-21T20:23:44.953

在您的项目中创建资源映射文件夹并将 js 文件放在那里，并将 js 文件的引用指定为 _layout/jsfilename.js，此 js 文件将与您的项目一起部署到您将部署它的任何位置。

# embedded - 学习嵌入式编程的最佳平台？

> ID：88626
> 
> 赞同：24
> 
> 时间：2008-09-17T23:19:25.873
> 
> 标签：embedded, arm, avr

我正在寻找学习嵌入式编程（主要是 C，但我也希望复习我的 ASM），我想知道最好的平台是什么。我在使用 Atmel AVR 并使用 stk500 对其进行编程方面有一些经验，并且发现这相对容易。我特别喜欢 AVR Studio 和可让您查看寄存器状态的调试器。

但是，如果我要花时间学习，我宁愿学习工业中流行的东西。我在想ARM，除非有人有更好的建议。

我还会寻找一些参考资料，我在 ARM 网站上找到了书籍部分，如果其中一本在技术上比另一本更好，我将不胜感激。

我要寻找的最后一件事是原型/编程板，例如具有一些按钮等的 STK500。

谢谢=]

* * *

## 回答 #1

> 赞同：25
> 
> 时间：2008-09-17T23:27:53.060

“嵌入式编程”是一个非常广泛的术语。AVR 在该类别中表现不错，但它比 ARM 低了一步，因为它使用起来更简单，功能也更弱。

如果您只想玩 ARM，请购买 Nintendo DS 或 Gameboy Advance。与内部硬件（大规模生产的奇迹）相比，它们非常便宜，并且它们都有基于 gcc 的[免费开发工具链](http://www.devkitpro.org/)，可以编译到它们。

如果你想玩嵌入式 linux，[BeagleBoard](http://beagleboard.org/)是个不错的选择，只需 150 美元，而且它有很多功能。

我个人认为 AVR 最适合较小的 8 位平台，而 ARM 最适合更大、更强大的 32 位平台。像许多 AVR 粉丝一样，我不喜欢 PIC。它在几乎所有方面似乎都更糟。还要避免任何需要您编写任何类型的 BASIC 的东西。

* * *

## 回答 #2

> 赞同：10
> 
> 时间：2008-09-17T23:26:10.583

如果您只是想玩弄它，我建议您使用 Arduino 平台（[http://www.arduino.cc](http://www.arduino.cc)）。它基于 ATmega168 或 ATmega8，具体取决于版本。它使用类 C 语言并拥有自己的 IDE。

* * *

## 回答 #3

> 赞同：8
> 
> 时间：2008-11-07T14:06:17.440

我自己在嵌入式编程领域工作了 9 年，在 TI MSP430、Atmel AVR（几种口味）方面有经验，很快就会使用 ARM。

我的建议是在处理器中选择具有一些额外功能的东西，例如以太网控制器和 CAN 控制器，如果可以的话，甚至可以购买两个或三个。嵌入式设备很好用，但是一旦它们可以通过 CAN 与其他类似设备通信或连接到网络，它们就会变得更有趣。

* * *

## 回答 #4

> 赞同：7
> 
> 时间：2008-09-18T00:24:45.577

ADI 的[Blackfin](http://en.wikipedia.org/wiki/Blackfin)是另一种选择，因为它是一种非常简单的编程架构，但如果您选择走这条路线，也可以做一些相当重要的 DSP 工作。汇编语言也很理智，这也很有帮助。

Blackfin [STAMP](http://blackfin.uclinux.org/gf/project/stamp)板价格便宜（我上次检查时约为 100 美元），它们支持免费的 GCC 工具和 uClinux。

无论您选择哪种架构，我都绝对建议您首先下载工具链\SDK 并查看示例项目和教程——通常有一点玩。您通常可以通过仿真对架构非常熟悉，甚至无需接触任何硬件。

* * *

## 回答 #5

> 赞同：6
> 
> 时间：2008-09-17T23:30:06.533

ARM 拥有广泛使用的嵌入式平台中最好的指令集，让您可以自由地学习为嵌入式平台编写软件的一般原则，而不会陷入诸如非正交寄存器或分支延迟槽之类的奇怪细节中。有很多仿真器——ARM 自己的，虽然不是免费的，但是是周期精确的；种类繁多的基于 ARM 的可编程硬件既便宜又容易获得。

* * *

## 回答 #6

> 赞同：6
> 
> 时间：2008-09-18T00:44:47.790

TI [MSP430](http://focus.ti.com/mcu/docs/mcuprodoverview.tsp?sectionId=95&tabId=140&familyId=342)是学习如何编程微控制器的绝佳平台。TI 有多种**[免费工具](http://focus.ti.com/mcu/docs/mcuprodmsptoolsw.tsp?sectionId=95&tabId=1203&familyId=342&toolTypeId=1#software)**和一些[便宜的评估板](http://focus.ti.com/docs/toolsw/folders/print/ez430-f2013.html)（起价 20 美元）。此外，它是一款低功耗的现代微控制器。

* * *

## 回答 #7

> 赞同：2
> 
> 时间：2008-09-17T23:27:26.510

一个不错的选择是 Microchip 的 PIC18

*   它在互联网上有很多材料、文档、教程和项目

*   免费的 IDE 和编译器。

*   您可以在几分钟内拉出自己的 Flash 编写器。（尽管要使调试器工作，您需要更加努力）

*   如果您是学生（或有学生电子邮件地址），Microchip 将向您发送免费的样品芯片。所以基本上你几乎可以拥有一个完整的开发环境。

*   PIC在业界相当普遍。出于某种原因，特别是作为机器人的控制器，尽管它们可以做的更多。

* * *

## 回答 #8

> 赞同：2
> 
> 时间：2008-09-17T23:31:57.483

[如今， Arduino](http://www.arduino.cc/)似乎是初学者的首选平台，尽管还有很多其他平台。我个人喜欢[Olimex](http://www.olimex.com/)板，但它们并不适合初学者。

[Microchip](http://www.microchip.com/)的 PIC 系列 CPU 也非常适合初学者，特别是如果您想使用汇编程序进行编程。

顺便说一句，Assembler 的使用没有以前那么多了。嵌入式的一般规则是，如果您有 4k 或更多的内存，请使用 C。您可以获得可移植性，并且可以更快地开发代码。

我想这取决于你的技能水平和你想用芯片做什么。我通常选择可用的外围设备使用哪个嵌入式芯片。如果你想要一个 USB 端口，找一个内置 USB 的，如果你想要模拟到数字的，找一个带有 ADC 等的。如果你有一个简单的应用程序，使用 8 位，但如果你需要认真的数字嘎吱嘎吱，去32位。

* * *

## 回答 #9

> 赞同：2
> 
> 时间：2008-09-18T13:37:18.603

我想推荐 TI 的 beagleboard。它上面有一个Omap3。那是一个 Cortex-A8 ARM11 CPU、一个 C64x+ DSP 和一个视频加速器。

该板不需要昂贵的 jtag 设备。只需一根串行电缆和一张 SD 卡即可开始使用。董事会只需 150 美元，社区非常活跃。

www.beagleboard.org

* * *

## 回答 #10

> 赞同：1
> 
> 时间：2008-09-17T23:31:21.120

你的问题已经在[这个问题](https://stackoverflow.com/questions/45247/how-do-i-get-started-in-embedded-programing)中得到了回答。

除此之外，嵌入式处理器行业非常细分，它没有像英特尔/x86 那样的“桌面”处理器行业的主要参与者。ARM 处理器确实占有很大的份额，我相信 MIPS 也是如此，并且有许多更小、更具体的微控制器，如可用的芯片（如 TI 的 MSP430 等）。

至于文档，我的日常工作是进行嵌入式开发，而我们（作为软件开发人员）可以访问的文档相当稀少。最好的办法是使用处理器制造商网站上提供的文档。

* * *

## 回答 #11

> 赞同：1
> 
> 时间：2008-09-18T00:13:28.973

查看[Processing](http://processing.org/)以及相关的 Arduino 和接线板。

* * *

## 回答 #12

> 赞同：1
> 
> 时间：2008-09-19T18:43:08.930

如果你只是想玩得开心，那就试试 Parallax Propeller 芯片吧。HYDRA 游戏平台看起来很爆炸。现在有一个 100 美元的 C 编译器。

我从 BASIC 邮票开始，通过 SX 芯片和 PIC 向上移动到 8051，然后是 68332，各种 DSP，FPGA 软处理器等。

8051 在现实世界中更有用……事情不会消失。他们有大量的衍生品和疯狂的东西。（远离 DS80C400）能源行业绝对充满了它们。

从微小的东西开始。如果您有外部 RAM 和大量寄存器……那和 SBC 有什么区别？

* * *

## 回答 #13

> 赞同：1
> 
> 时间：2009-02-13T21:42:51.927

很多个月前，我使用过 68HC05 和 Z80 等 8 位处理器，以及后来的 AVR 和 MSP430（16 位）。然而，最近的项目都在 ARM7 上。几家制造商提供各种颜色和尺寸的 ARM 控制器（嗯，不是真的颜色）。

ARM(7) 正在取代 8 位架构：它的性能更高（32 位 RISC 的指令周期比大多数 8 位更快），具有更多内存并且可用于多种 IO 配置。我使用 NXP LPC2000 控制器，它们也很便宜（< 1 美元 32 位！）。

如果你在欧洲[http://www.olimex.com/dev/index.html](http://www.olimex.com/dev/index.html)有一些不错的低成本开发板。也适用于世界其他地方:-)

* * *

## 回答 #14

> 赞同：0
> 
> 时间：2008-09-17T23:24:59.480

要测试一个有趣的项目，请查看[xgamestation](http://www.xgamestation.com/)

但是对于更工业用的单芯片解决方案编程，请看[PIC](http://www.samengstrom.com/nxl/1669/pic_programming_page.en.html)

* * *

## 回答 #15

> 赞同：0
> 
> 时间：2008-09-17T23:34:38.147

对于我的计算机体系结构课程，我必须同时使用 PIC 和 AVR；在我看来，PIC 更容易使用，但这可能是因为这是我们使用最多的东西，而且我们有最多的时间来适应它。我们可能只使用了几次 AVR，所以我无法完全掌握它，但它也没有过于复杂，或者至少没有比另一个更令人沮丧。

我认为您也可以从 Microchip 的网站订购微处理器样品，这样您也可以开始使用吗？

* * *

## 回答 #16

> 赞同：0
> 
> 时间：2008-10-25T13:09:30.527

二是：

Arduino平台[http://www.arduino.cc](http://www.arduino.cc)

高温高压

* * *

## 回答 #17

> 赞同：0
> 
> 时间：2009-04-08T07:04:28.017

为了学习，你不能越过 AVR。这些芯片很便宜，而且它们可以使用零外部组件运行——它们还提供足够的电流来直接从端口驱动 LED。

你可以从一个便宜的编程器开始，比如lady-ada的[USBTinyISP](http://www.ladyada.net/make/usbtinyisp/)（一套22美元），它可以从USB端口为你的电路板供电5V。获取免费工具 WinAVR（基于 GCC）和 AVRStudio，并立即启动一个小型项目。

是的，AVR 有局限性——但为微控制器开发软件主要是为了管理资源和应对这些问题。在为强大的 ARM 平台制作业余爱好者项目时，您不太可能遇到堆栈空间、RAM 或 ROM 不足等问题。

也就是说，ARM 也是一个在业界广泛使用的出色平台，但是，对于学习，我强烈推荐 AVR。

* * *

## 回答 #18

> 赞同：0
> 
> 时间：2010-01-25T23:43:32.520

我建议 Microchip 的 PIC18F 系列。我刚开始使用 RealICE 在线仿真器为他们开发，但 pickit2 是一个物美价廉的调试器。您也可以对 AVR 这么说，但该设备在整个网络上都有大量的追随者。由于所有与 PIC 相关的喋喋不休，我能够在几天内运行一个有缺陷但功能齐全的嵌入式 USB 设备。

我唯一不喜欢 PIC 的地方是很多示例代码与演示板紧密相连。这会使您很难删除您需要的部分，并且仍然有一个可以为您的应用程序构建和运行的应用程序。

* * *

## 回答 #19

> 赞同：0
> 
> 时间：2010-07-14T11:57:06.247

德州仪器 (TI) 以非常低的价格发布了一个非常有趣的开发套件：[eZ430-Chronos 开发工具](http://focus.ti.com/docs/toolsw/folders/print/ez430-chronos.html)包含一个 MSP430，带有显示屏和运动手表中的各种传感器，包括一个 USB 调试编程器和一个 USB 无线电接入点[，售价 50 美元](http://www.ti-estore.com/Merchant2/merchant.mvc?Screen=PROD&Product_Code=EZ430-Chronos-868)

还有[一个包含](http://processors.wiki.ti.com/index.php/EZ430-Chronos)大量信息的wiki。

我已经为 eZ430-Chronos 套件[创建了一个 stackexchange 提案](http://area51.stackexchange.com/proposals/13122/ti-ez430-chronos-development-tool?referrer=YppEIivQP8lCxT7Iq4t4JA2)。

* * *

## 回答 #20

> 赞同：0
> 
> 时间：2012-03-06T15:01:44.807

您应该尝试从[Embedded Artists](http://www.embeddedartists.com/products/kits)提供的开发人员工具包中学习。拿到套件后，查看他们的教学视频和 NXP 提供的视频，虽然没有说的那么详细，但涵盖了很多内容。学习 ARM 作为你的第一个架构并尝试做一些实际的事情的问题是：

*   你需要购买开发。成套工具。
*   你需要一[本好书](https://rads.stackoverflow.com/amzn/click/com/1558608745)来学习 ARM 汇编，因为迟早你会遇到 ARM 启动代码，这对初学者来说是一笔不小的数目。我提到的这本书也涵盖了一些 C 编程。
*   将上面提到的书与您的特定处理器的用户指南结合起来，就像[这样](http://www.nxp.com/documents/user_manual/UM10326.pdf)。确保你明白这一点，因为结合上面的书学习这是学习你的 ARM proc 的唯一方法。详细地。
*   如果你想从 ARM 汇编转换到 C 编程，你需要阅读这[本书](https://rads.stackoverflow.com/amzn/click/com/0905705807)，它涵盖了不同的 ARM 处理器，但对 C 初学者来说更容易。不利的一面是它没有解释任何 ARM 程序集，但这就是您需要第一本书的原因。

没有简单的方法。

* * *

## 回答 #21

> 赞同：0
> 
> 时间：2012-03-07T15:28:46.877

mikroElektronika 有不错的 ARM**[板](http://www.mikroe.com/eng/categories/view/16/arm-development-tools)**和 C、Pascal 和 Basic**[编译器](http://www.mikroe.com/eng/categories/view/96/arm-compilers)**，可以满足您的需求。

# ruby - 你如何在 Ruby webapps 中进行性能测试？

> ID：88629
> 
> 赞同：7
> 
> 时间：2008-09-17T23:19:39.273
> 
> 标签：ruby, performance, testing

我一直在研究人们测试他们的应用程序的方式，以便决定在哪里进行缓存或应用一些额外的工程工作，到目前为止，httperf 和一个简单的 sesslog 非常有帮助。

您在项目中应用了哪些工具和技巧？

* * *

## 回答 #1

> 赞同：9
> 
> 时间：2008-09-17T23:29:31.810

我使用 httperf 来获得高级别的性能视图。

Rails 有一个内置的性能脚本，它使用 ruby​​-prof gem 来分析 Rails 堆栈深处的调用。有一个很棒的[Railscast](http://railscasts.com/) on [Request Profiling](http://railscasts.com/episodes/98-request-profiling)使用这种技术。

[NewRelic](http://newrelic.com/)有一些非常酷的分析工具，可以提供近乎实时的数据。他们只是把它变成了一个免费的“精简版”。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2008-09-18T01:43:44.200

我使用[jmeter](http://jakarta.apache.org/jmeter/)进行基于会话的测试 - 它允许对您想要访问的页面、要注入的参数、要通过的循环等进行非常细粒度的控制。它非常适合模拟您的站点可以处理多少真实用户，而不仅仅是性能测试一组静态 url。通过在具有可公开访问 IP 的计算机上加载 jmeter-server，您可以很容易地在多台计算机上分发测试。我发现任何一台机器可以同时向服务器抛出的用户/线程数量存在一些限制（这取决于测试），但是 jmeter 帮助我的团队将我们的应用程序容量提高到了 6 倍。

它没有任何花哨的图形——我实际上使用我自己的内部图形和 gruff，可以对某些页面和操作的请求时间进行性能分析。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2008-09-18T13:53:52.263

[我正在评估一个名为Jiffy](http://code.google.com/p/jiffy-web/)的新开源网页检测和测量套件。它不是特别适用于 ruby​​，它适用于所有类型的 webapps

还有一个用于在浏览器中呈现指标的[Jiffy Firebug 扩展](http://billwscott.com/jiffyext/)。

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2009-06-25T20:51:50.127

我还建议您查看 Browser Mob 进行负载测试。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2008-09-21T09:41:41.727

我的一位同事也对此发表了一些[有趣的想法](http://www.dcmanges.com/blog/rails-performance-tuning-workflow)。

# sql-server - Kerberos Delegation for Clients Ouside the Firewall

> ID：88646
> 
> 赞同：2
> 
> 时间：2008-09-17T23:23:40.403
> 
> 标签：sql-server, internet-explorer, iis, kerberos, delegation

I am trying to run a SQL Server Reporting Services where the data for the report is on a SQL Server database that's on a different server. Integrated Authentication is turned on for both the Report Server and the report. I have confirmed that Kerberos delegation is working fine by using Internet Explorer to run the report from inside the network.

However, when I open the report server through the firewall, I cannot run the report. I get the following error: An error has occurred during report processing. Cannot create a connection to data source 'frattoxppro2'. Login failed for user 'NT AUTHORITY\ANONYMOUS LOGON'.

Does Kerberos authentication *not* work outside a firewall?

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2008-09-19T20:22:48.813

Kerberos 需要到 KDC 的端口 88 连接，在这种情况下，很可能是您的 DC。

您可能想要查看的是 HTTPS + 基本身份验证 + 协议转换，以获取基本身份验证并将其转换为基于 DC 的 Kerberos 票证，以进行委派和后端身份验证。

*   [具有约束委派技术补充的协议转换](http://msdn.microsoft.com/en-us/library/aa480585.aspx)

*   [如何：在 ASP.NET 中使用协议转换和约束委派](http://msdn.microsoft.com/en-us/library/ms998355.aspx)

不是最容易设置的，但是当它工作时，它工作得非常好。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2008-09-17T23:35:03.123

I'm not really in a position to tell you why kerberos isn't working for you, but did have a alternative suggestion for your configuration. You can use ISA services to expose the reporting server rather than simply poking a hole in your firewall. This is something our company has done successfully - it republishes the reporting services site so the browsers are talking to ISA, not directly to the server. ISA Services is quite happy to pass through your credentials as well.

# sql-server - 使用 Notification Services 在 SQL Server Reporting Services 中获取通知的最佳方式

> ID：88651
> 
> 赞同：2
> 
> 时间：2008-09-17T23:24:41.710
> 
> 标签：sql-server, reporting-services, notificationservices

[是否可以使用SQL Server Reporting Services](http://www.microsoft.com/sql/technologies/reporting/default.mspx)获取通知？举例来说，我有一份我想要通过邮件发送的报告，例如突然显示超过 10 行或某个特定值降至 100 000 以下。我需要将通知服务绑定到其中吗？我该怎么做？

请提供尽可能多的技术细节，因为我以前从未使用过[通知服务](http://www.microsoft.com/sql/technologies/notification/default.mspx)。

有人还告诉我，通知服务已被 Sql Server 2008 中的报告服务中的新功能所取代——是这样吗？

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2008-10-27T10:10:04.413

我同意 Simon re Notification Services

此外，除非您使用企业版，否则数据驱动的 SSRS 订阅不可用（如果您使用 SharePoint 集成模式，则不可用）。

另一种方法是创建一个运行 proc 的代理作业。proc 可以检查您需要的条件并在满足条件时启动订阅：

```
exec ReportServer.dbo.AddEvent @EventType='TimedSubscription', @EventData='xxxxxxxx-xxxx-xxxx-xxxx-xxxxxxxxxxxxx' 
```

其中@EventData 是 dbo.Subscriptions 中订阅的 ID。

这将在 [dbo].[Event] 中删除一行。该服务每分钟轮询该表几次以启动订阅。

确实，这与您设置新订阅时发生的情况相去甚远，甚至可能更容易在报表服务器站点中创建订阅，找到创建了哪个代理作业（具有 GUID 名称的那些）并编辑 T- SQL。

希望这可以帮助

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2008-09-18T07:44:04.147

我不会走 ntofications 服务路线——它几乎是 SQL Server 的一个已弃用的功能，即使它在未来存在，它也会停滞不前。所以不要建立对它的依赖。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2008-10-17T03:30:15.700

根据您的需要，数据驱动的 SSRS 订阅通过电子邮件向您发送报告可能会起作用。 [http://msdn.microsoft.com/en-us/library/ms159150(SQL.90).aspx](http://msdn.microsoft.com/en-us/library/ms159150(SQL.90).aspx)

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2008-10-21T01:33:02.610

使用 SSRS 订阅向您的数据驱动报告发送邮件

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2012-09-07T19:30:55.237

数据驱动订阅由多个部分组成。数据驱动订阅的固定方面是在您创建订阅时定义的，其中包括以下内容：

为其定义订阅的报告（订阅始终与单个报告相关联）。用于分发报告的传递扩展。您可以指定报表服务器电子邮件传递、文件共享传递、用于预加载缓存的空传递提供程序或自定义传递扩展。您不能在单个订阅中指定多个交付扩展。订阅者数据源。定义订阅时，您必须指定包含订阅者数据的数据源的连接字符串。不能在运行时动态指定订阅者数据源。定义订阅时必须指定用于选择订阅者数据的查询。您不能在运行时更改查询。

# c# - 为 SOAP/XML 序列化 HashTable 的最佳方法是什么？

> ID：88682
> 
> 赞同：1
> 
> 时间：2008-09-17T23:28:57.257
> 
> 标签：c#, .net, xml, serialization

使用 SOAP/XML 序列化 HashTable（或最好通过字符串索引器导航的数据）的最佳方法是什么？

假设我有一个`Foo`具有属性的`Bar[] Bars`。一个`Bar`对象有一个键和一个值。默认情况下，这会序列化为以下 XML：

```
<Foo>
  <Bars>
    <Bar key="key0" value="value0"/>
    ...
  </Bars>
</Foo> 
```

对于 JSON，这将序列化为：

```
{"Foo":["Bars":[{"Key":"key0","Value":"key1} ... ]}]} 
```

我真正想要的是这个序列化以更好地反映底层关系。例如，

```
<Foo>  
  <Bars>  
    <Key0 value="value0"/>
    <Key1 value="value1"/>
    ...
  </Bars>
</Foo> 
```

我意识到以这种方式序列化到 SOAP 存在一些挑战，但是提供更好地反映这一点的模式的最佳方法是什么？

我已经尝试创建一个 BarsCollection 对象并在其上定义自定义序列化，但它似乎并没有真正调用该对象的序列化。例如

```
void ISerializable.GetObjectData(SerializationInfo info, StreamingContext context) {  
  foreach (Bar bar in Bars){           
    info.AddValue(bar.Key. bar);
  }
} 
```

有什么建议么？这里的最佳做法是什么？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2008-09-18T00:25:39.803

我真的不认为你想要的东西能更好地反映结构。要为此定义一个模式（想想 XSD），您必须提前知道所有潜在的键，因为您表明您希望每个键都是单独的自定义类型。从概念上讲，Bars 是一个包含 Key0、Key1 类型对象的对象数组，每个 KeyN 类都包含一个 value 属性。我相信第一次序列化其实是对底层结构的最好体现。它“工作”更像你在 JSON 中想要的那样的原因是你失去了打字——一切都只是一个对象。如果您不关心类型，为什么不直接使用 JSON？

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2008-09-17T23:34:34.433

ISerializable 不用于 xml 序列化；它用于二进制序列化。你会更好地实现 IXmlSerializable。

但我认为 KeyedCollection 的序列化更像您的想法。除了你永远不会得到 <key0 ... /> <key1 ... /> 因为元素映射到类。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2008-09-17T23:47:12.377

您可以在 SOAP 扩展中传递哈希表。这样，您可以以任何您喜欢的方式对其进行序列化。尽管对此有自定义代码，但必须在客户端和服务器上。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2008-09-18T13:46:10.550

我认为您缺少 SOAP 协议的基本密钥。

我真正喜欢 SOAP 协议的一件事是，您可以在 WSDL 文件中定义任意对象（连同方法），并使用 SOAP 协议将这些对象从一端传递到另一端。您不必在一端序列化数据，然后在另一端反序列化它。

# macos - what's the best app to draw UI wireframes on the mac? (And why)

> ID：88691
> 
> 赞同：10
> 
> 时间：2008-09-17T23:30:27.783
> 
> 标签：macos, user-interface, wireframe

I want to draw user interfaces for web and desktop applications.

I need something less print-oriented than omnigraffle. think pixels!

Also, need good building blocks (aka stencils). Form elements, tableviews, etc.

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2008-09-18T10:19:51.230

I've been playing around with [Balsamiq Mockups](http://www.balsamiq.com/ "Balsamiq Mockups") and it's OK for basic wireframes. I still prefer pen and paper sketches that are later refined in Photoshop when working on my own, but Balsamiq is useful when working in a team.

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2012-10-25T13:31:11.360

[WireframeSketcher 线框工具](http://wireframesketcher.com)在 Mac 上带有快速和原生的 UI。它也适用于视网膜显示器。有一个大型的内置控件库和额外的模板可用。

![Mac 上的 WireframeSketcher 屏幕截图](https://i.stack.imgur.com/qwlXJ.png)

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2008-09-17T23:45:21.863

我非常喜欢[Omnigraffle](http://www.omnigroup.com/applications/Omnigraffle/)，它带有用于 UI 设计的[模板。](http://v1.garrettdimon.com/resources/templates-stencils-for-visio-omnigraffle)更多的 UI 模板[也可用](http://graffletopia.com/categories/user-interface)。

您还可以查看有关此主题的[其他一些](http://stackoverflow.com/questions/33643) [stackoverflow](http://stackoverflow.com/questions/55363) [问题。](http://stackoverflow.com/questions/86234)

* * *

## 回答 #4

> 赞同：2
> 
> 时间：2008-09-18T01:15:48.263

老实说，我发现 Interface Builder 与使用带有（上述）模板的 Omnigraffle 对桌面应用程序 UI 进行原型设计一样快。

另外好处是您可以查看*所有*可用的控件。

* * *

## 回答 #5

> 赞同：2
> 
> 时间：2010-01-14T07:57:25.770

Axure 刚刚在 Alpha 版中发布了 Axure RP 5.6 for mac。非常适合网站和应用程序。[http://axure.com/CS/blogs/axure/archive/2009/12/22/6104.aspx](http://axure.com/CS/blogs/axure/archive/2009/12/22/6104.aspx)

您还可以将 OmniGraffle 与来自 Konigi.com 的免费 Web UX 模板配对

* * *

## 回答 #6

> 赞同：2
> 
> 时间：2009-12-12T12:30:37.890

说到 Illustrator，InDesign 实际上更好，因为您可以进行多页布局并使用母版页作为标题/导航等常量...

* * *

## 回答 #7

> 赞同：1
> 
> 时间：2008-09-24T03:46:57.420

所有这些答案，都没有人提到他们的祖父？

使用 Adob​​e Illustrator！

在图层中创建您自己的模板/可重用组件并在文档之间共享。

* * *

## 回答 #8

> 赞同：1
> 
> 时间：2010-03-07T01:12:45.730

记号笔和纸先。

然后如果有必要，可能插画家会展示细节特写。

* * *

## 回答 #9

> 赞同：0
> 
> 时间：2008-09-22T19:56:14.157

除了 Interface Builder，您将不得不从其他地方获取标准的 UI 控件模板或自己制作它们。

我一直在使用[Lineform](http://www.freeverse.com/apps/app/?id=6020)，结果证明它非常擅长以像素为单位指定尺寸（只需在 Lineform Preferences 中选择“Points / Pixels”作为测量单位）。这是我在旧版本的 OmniGraffle 中遇到的麻烦（虽然最近没有使用它）。

* * *

## 回答 #10

> 赞同：-3
> 
> 时间：2008-09-18T01:24:36.323

试试[Skitch](http://www.skitch.com/)。这似乎是在 Mac 上进行简单绘图和图像处理的最佳秘密之一。我最近在 TMO Geek Gab 播客上听说了它。

# graph-theory - 关系理论如何以我在学习时关心的方式应用？

> ID：88703
> 
> 赞同：2
> 
> 时间：2008-09-17T23:33:37.587
> 
> 标签：graph-theory, relational, finite-automata, discrete-mathematics

所以我正在从麻省理工学院的 OpenCourseWare 学习离散数学课程，我想知道......我看到了关系和图形之间的联系，但还不足以“拥有”它。我也在 SQL 中实现了一个简单的状态机，所以我很好地理解了图表，只是没有更严格地研究关系和集合是如何应用的。我是否应该遵循 Yegge 的思路，只浏览那些我不喜欢摸索的东西，等我学到更多东西后再回来？我希望能够更好地分析我每天创建的图形结构（听起来很有趣），并且我想确保我现在没有传递有价值的信息。

（编辑：我想更好地了解不同的集合和关系属性如何与图论等事物相关，以及基本图论如何与集合/关系相关。）

有什么好的资源可以让我了解更多信息吗？我正在使用 Rosen 的第 5 版离散数学及其应用，以防万一。

谢谢！

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2008-09-18T03:52:29.477

哇，4 小时，无人接听；我在学校也有过类似的经历，但只是学会了这些东西，后来才弄清楚它对我有什么好处。事实证明它非常有用，所以让我们看看这是否有帮助 -

数据库被正式定义为一组关系，但它也是一个图；每个表是一个节点，每列是一个连接到表的节点，每一行是一个连接到表的节点，每个字段是一个连接到行的节点，表之间的关系互连节点，外键关系互连行，查询约束（where 子句）和连接互连节点和节点集，等等。

SQL 查询可以被可视化为遍历由数据库关系和值形成的图并在每个节点上执行操作。在查询执行计划器所做的事情的底层，它将查询分解为一组基本操作，并将它们排列在最有效的图中。

对数据库的更新也可以被认为是图形操作，例如，更新订单行项目行中的数量会将更改传播到订单行中的总计，这会将更改传播到客户行中的 TotalSales，等等.

许多常见问题演变为图遍历问题。曾经使用谷歌地图获取到某个地方的路线吗？

# deployment - 报告服务部署

> ID：88710
> 
> 赞同：33
> 
> 时间：2008-09-17T23:35:07.223
> 
> 标签：deployment, reporting-services

我需要创建一个可重复的流程来部署 SQL Server Reporting Services 报表。我不赞成使用 Visual Studio 或 Business Development Studio 来做到这一点。脚本部署的 rs.exe 方法似乎也相当笨拙。有没有人有一种非常优雅的方式来部署报告。这里的关键是我希望这个过程完全自动化。

* * *

## 回答 #1

> 赞同：33
> 
> 时间：2008-09-18T09:04:57.777

我们使用 rs.exe，一旦我们开发了脚本，我们就不需要再碰它了，它就可以工作了。

这是源代码（我手动对其进行了轻微修改以删除敏感数据而没有机会对其进行测试，希望我没有破坏任何东西），它部署了各种语言的子目录中的报告和相关图像。还创建了数据源。

```
'=====================================================================
'  File:      PublishReports.rss
'
'  Summary: Script that can be used with RS.exe to 
'           publish the reports.
'
'  Rss file spans from beginnig of this comment to end of module
' (except of "End Module").
'=====================================================================

Dim langPaths As String() = {"en", "cs", "pl", "de"}
Dim filePath As String = Environment.CurrentDirectory

Public Sub Main()

    rs.Credentials = System.Net.CredentialCache.DefaultCredentials

    'Create parent folder
    Try
        rs.CreateFolder(parentFolder, "/", Nothing)
        Console.WriteLine("Parent folder created: {0}", parentFolder)
    Catch e As Exception
        Console.WriteLine(e.Message)
    End Try

    PublishLanguagesFromFolder(filePath)

End Sub

Public Sub PublishLanguagesFromFolder(ByVal folder As String)
    Dim Lang As Integer
    Dim langPath As String

    For Lang = langPaths.GetLowerBound(0) To langPaths.GetUpperBound(0)
        langPath = langPaths(Lang)

        'Create the lang folder
        Try
            rs.CreateFolder(langPath, "/" + parentFolder, Nothing)
            Console.WriteLine("Parent lang folder created: {0}", parentFolder + "/" + langPath)
        Catch e As Exception
            Console.WriteLine(e.Message)
        End Try

        'Create the shared data source
        CreateDataSource("/" + parentFolder + "/" + langPath)

        'Publish reports and images
        PublishFolderContents(folder + "\" + langPath, "/" + parentFolder + "/" + langPath)
    Next 'Lang
End Sub

Public Sub CreateDataSource(ByVal targetFolder As String)
    Dim name As String = "data source"

    'Data source definition.
    Dim definition As New DataSourceDefinition
    definition.CredentialRetrieval = CredentialRetrievalEnum.Store
    definition.ConnectString = "data source=" + dbServer + ";initial catalog=" + db
    definition.Enabled = True
    definition.EnabledSpecified = True
    definition.Extension = "SQL"
    definition.ImpersonateUser = False
    definition.ImpersonateUserSpecified = True
    'Use the default prompt string.
    definition.Prompt = Nothing
    definition.WindowsCredentials = False
    'Login information
    definition.UserName = "user"
    definition.Password = "password"

    Try
    'name, folder, overwrite, definition, properties 
        rs.CreateDataSource(name, targetFolder, True, definition, Nothing)
    Catch e As Exception
        Console.WriteLine(e.Message)
    End Try

End Sub

Public Sub PublishFolderContents(ByVal sourceFolder As String, ByVal targetFolder As String)
    Dim di As New DirectoryInfo(sourceFolder)
    Dim fis As FileInfo() = di.GetFiles()
    Dim fi As FileInfo

    Dim fileName As String

    For Each fi In fis
        fileName = fi.Name
        Select Case fileName.Substring(fileName.Length - 4).ToUpper
            Case ".RDL"
                PublishReport(sourceFolder, fileName, targetFolder)
            Case ".JPG", ".JPEG"
                PublishResource(sourceFolder, fileName, "image/jpeg", targetFolder)
            Case ".GIF", ".PNG", ".BMP"
                PublishResource(sourceFolder, fileName, "image/" + fileName.Substring(fileName.Length - 3).ToLower, targetFolder)
        End Select
    Next fi
End Sub

Public Sub PublishReport(ByVal sourceFolder As String, ByVal reportName As String, ByVal targetFolder As String)
    Dim definition As [Byte]() = Nothing
    Dim warnings As Warning() = Nothing

    Try
        Dim stream As FileStream = File.OpenRead(sourceFolder + "\" + reportName)
        definition = New [Byte](stream.Length) {}
        stream.Read(definition, 0, CInt(stream.Length))
        stream.Close()
    Catch e As IOException
        Console.WriteLine(e.Message)
    End Try

    Try
   'name, folder, overwrite, definition, properties 
        warnings = rs.CreateReport(reportName.Substring(0, reportName.Length - 4), targetFolder, True, definition, Nothing)

        If Not (warnings Is Nothing) Then
            Dim warning As Warning
            For Each warning In warnings
                Console.WriteLine(warning.Message)
            Next warning
        Else
            Console.WriteLine("Report: {0} published successfully with no warnings", targetFolder + "/" + reportName)
        End If
    Catch e As Exception
        Console.WriteLine(e.Message)
    End Try
End Sub

Public Sub PublishResource(ByVal sourceFolder As String, ByVal resourceName As String, ByVal resourceMIME As String, ByVal targetFolder As String)
    Dim definition As [Byte]() = Nothing
    Dim warnings As Warning() = Nothing

    Try
        Dim stream As FileStream = File.OpenRead(sourceFolder + "\" + resourceName)
        definition = New [Byte](stream.Length) {}
        stream.Read(definition, 0, CInt(stream.Length))
        stream.Close()
    Catch e As IOException
        Console.WriteLine(e.Message)
    End Try

    Try
    'name, folder, overwrite, definition, MIME, properties 
        rs.CreateResource(resourceName, targetFolder, True, definition, resourceMIME, Nothing)
        Console.WriteLine("Resource: {0} with MIME {1} created successfully", targetFolder + "/" + resourceName, resourceMIME)
    Catch e As Exception
        Console.WriteLine(e.Message)
    End Try
End Sub 
```

这是调用 rs.exe 的批处理：

```
SET ReportServer=%1
SET DBServer=%2
SET DBName=%3
SET ReportFolder=%4

rs -i PublishReports.rss -s %ReportServer% -v dbServer="%DBServer%" -v db="%DBName%" -v parentFolder="%ReportFolder%" >PublishReports.log 2>&1

pause 
```

* * *

## 回答 #2

> 赞同：8
> 
> 时间：2010-05-03T15:39:19.110

我使用了[@David](https://stackoverflow.com/questions/88710/reporting-services-deployment/91077#91077)提供的脚本，但我必须添加一些代码（我将其作为答案输入，因为这对于评论来说太长了。

问题是：如果报表定义中的报表已经附加了一个“共享数据源”，那么这绝不会与脚本中创建的数据源相同。

从“CreateReport”方法发出的警告中也可以看出这一点：

> 数据集“”是指共享数据源“”，未在报表服务器上发布。

所以数据源必须在之后明确设置。我进行了以下代码更改：

我添加了一个全局变量：

```
Dim dataSourceRefs(0) As DataSource 
```

在 CreateDataSource 方法结束时，该变量被填充：

```
Dim dsr As New DataSourceReference
dsr.Reference = "/" + parentFolder + "/" + db
Dim ds As New DataSource
ds.Item = CType(dsr, DataSourceDefinitionOrReference)
ds.Name = db
dataSourceRefs(0) = ds 
```

在 PublishReport 方法中，该数据源被显式设置（在调用 CreateReport 之后）：

```
rs.SetItemDataSources(targetFolder + "/" + reportName.Substring(0, reportName.Length - 4), dataSourceRefs) 
```

请注意，最后一次调用仅为 RS 2005 或更高版本。如果要将报表加载到 RS 2000 服务器上，则必须使用 Set *Report* DataSources 代替：

```
rs.SetReportDataSources(targetFolder + "/" + reportName.Substring(0, reportName.Length - 4), dataSourceRefs) 
```

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2008-09-17T23:41:39.253

嗯，不是很优雅。我们创建了自己的工具，该工具使用了reportingservices2005 Web 服务。我们发现这是获得我们想要的最可靠的方式。

它并没有那么难，并且可以让您扩展它以执行其他操作，例如根据需要创建数据源和文件夹。

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2010-04-16T07:12:58.583

我强烈推荐[RSScripter](http://www.sqldbatips.com/showarticle.asp?ID=62)。如概述中所述：

> Reporting Services Scripter 是一个 .NET Windows 窗体应用程序，它支持对所有 Microsoft SQL Server Reporting Services 目录项进行脚本编写和传输，以帮助将它们从一台服务器传输到另一台服务器。它还可用于轻松地将大量项目从一个 Reporting Services 文件夹移动到同一服务器上的另一个文件夹。根据所选的脚本选项，Reporting Services Scripter 还可以传输所有目录项属性，例如描述、历史记录选项、执行选项（包括报告特定和共享计划）、订阅（正常和数据驱动）和服务器端报告参数。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2008-09-17T23:38:05.767

我知道您说您不赞成 Business Development Studio 执行此操作，但我发现内置工具非常可靠且易于使用。

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2008-09-18T00:18:52.800

您是否研究过任何持续集成解决方案，例如 CruiseControl.NET？如果您能够使用 rs.exe 部署报告，那么您可以在 CruiseControl 中设置一个自动化流程，以便在计时器或修改报告时构建和部署您的报告。

* * *

## 回答 #7

> 赞同：0
> 
> 时间：2018-10-22T14:15:31.577

在我们的环境中，我们在带有版本控制的 VS 中进行开发，然后部署到 DEV SSRS。验证报告后，我们使用 ReportSync 程序将报告从 部署`ReportServer DEV`到`ReportServer PROD`. RS.EXE 脚本仍然占有一席之地，但我发现 ReportSync 是一种更简单、更灵活的报告推广方式。

**报告同步：**

**`ReportSync`**是一个免费下载和使用的开源程序。它非常适合批量下载报告，甚至可以将报告从一台服务器推送到另一台服务器。

* * *

如何获得下载程序？

*   从 Github 下载源代码文件[：Phires/ReportSynch](http://github.com/phires/reportsync)，运行 VS，打开解决方案文件（.SLN），编译程序，从*C:\Temp\reportsync-master\bin\Release*找到可执行文件（.EXE）文件夹。最后，将 .EXE 保存在某个地方供您定期使用

*   [如果我不是报告的所有者，如何将 SSRS 报告复制到新服务器](https://stackoverflow.com/questions/5336576/how-do-i-copy-ssrs-reports-to-a-new-server-if-i-am-not-the-owner-of-the-reports)--> nunespascal 的 ReportSync 回答

如何部署报告？

1.  运行可执行文件，界面将启动。
2.  使用`SOURCE`和`DESTINATION`对话选择`single report`、`multiple reports`或`entire folder of reports`。您可以选择任何您想要的目标文件夹。（提示：如果您想在同一台服务器上复制报告，您甚至可以针对同一台服务器。）
3.  做出选择后，按`Sync button`
4.  转到目标服务器，并通过查看 Changed By Date 来验证更改是否生效。

这个工具非常方便，但我注意到了一些怪癖。例如`when I want to update just one report that already exists in the destination`，这里是我必须选择的——[ `Source:Report> Target:Folder> Sync`]。警告：您可能认为您会选择目标服务器报告来更新它，但我已经尝试过了，但报告没有得到更新。

* * *

ReportSync 还能做什么？

*   还有一个`Export`功能，它非常适合简单地将所有 RDL 文件转储到一个文件夹中供我访问。如果您需要迁移服务器、将文件添加到 VS 解决方案项目或对所有文件执行其他任何操作，这将很有帮助。

*   在我的测试中，该程序**不会**迁移其他内容——订阅、共享数据源、共享数据集。它仅适用于报告文件。

我知道这篇文章很旧，但我在研究 RS.EXE 脚本时遇到了它，所以我想我会回答这个问题。

# graphics - 如何使用 ImageMagick 将图标连接成单个图像？

> ID：88711
> 
> 赞同：42
> 
> 时间：2008-09-17T23:35:10.143
> 
> 标签：graphics, bitmap, imagemagick, css-sprites

我想在网站上使用[CSS 精灵](http://alistapart.com/articles/sprites)而不是单独的图像文件，用于大量相同大小的小图标。如何使用[ImageMagick](http://www.imagemagick.org/)将它们连接（平铺）成一张大图像？

* * *

## 回答 #1

> 赞同：59
> 
> 时间：2012-05-18T15:00:57.363

[转换](http://www.imagemagick.org/script/convert.php)比蒙太奇效果好得多。它垂直或水平排列图像并保持 png 透明度。

```
convert *.png -append sprites.png (append vertically)
convert *.png +append sprites.png (append horizontally) 
```

* * *

## 回答 #2

> 赞同：31
> 
> 时间：2008-09-17T23:37:28.530

在您链接的页面上，[“蒙太奇”](http://www.imagemagick.org/script/montage.php)是您想要的工具。它将获取一堆图像并将它们连接/平铺成单个输出。这是我在使用该工具之前制作的示例图像：（ [来源：][[davr.org](http://davr.org/ds2/demos2/index.png)][）][![替代文字](https://i.stack.imgur.com/8rCKY.png "蒙太奇示例")](https://i.stack.imgur.com/8rCKY.png "蒙太奇示例")

* * *

## 回答 #3

> 赞同：24
> 
> 时间：2011-11-18T18:57:05.320

您正在寻找：

```
montage -background transparent -geometry +4+4 *.png sprite.gif 
```

* * *

## 回答 #4

> 赞同：5
> 
> 时间：2010-09-15T17:49:49.260

我喜欢这个用于自动生成精灵/css 的脚本。“[使用 Bash 和 Imagemagick 构建 CSS 精灵](http://jaymz.eu/2010/05/building-css-sprites-with-bash-imagemagick/)”

*   Waybackmashine 中的文章副本[https://web.archive.org/web/20150529041037/http://jaymz.eu/blog/2010/05/building-css-sprites-with-bash-imagemagick](https://web.archive.org/web/20150529041037/http://jaymz.eu/blog/2010/05/building-css-sprites-with-bash-imagemagick)

*   脚本复制[http://blog.kupriyanov.com/2011/01/solvedbuilding-css-sprites-with-bash.html](http://blog.kupriyanov.com/2011/01/solvedbuilding-css-sprites-with-bash.html)

# c# - 将 DLL 加载到单独的 AppDomain

> ID：88717
> 
> 赞同：32
> 
> 时间：2008-09-17T23:36:42.137
> 
> 标签：c#, .net, appdomain

我想动态加载一个或多个 DLL，以便它们以与我的主应用程序不同的安全性或基本路径运行。如何将这些 DLL 加载到单独的 AppDomain 并从中实例化对象？

* * *

## 回答 #1

> 赞同：35
> 
> 时间：2008-09-18T14:29:27.043

进一步来说

```
AppDomain domain = AppDomain.CreateDomain("New domain name");
//Do other things to the domain like set the security policy

string pathToDll = @"C:\myDll.dll"; //Full path to dll you want to load
Type t = typeof(TypeIWantToLoad);
TypeIWantToLoad myObject = (TypeIWantToLoad)domain.CreateInstanceFromAndUnwrap(pathToDll, t.FullName); 
```

如果一切正常（没有抛出异常），您现在已将 TypeIWantToLoad 实例加载到新域中。您拥有的实例实际上是一个代理（因为实际对象位于新域中），但您可以像使用普通对象一样使用它。

注意：据我所知，TypeIWantToLoad 必须继承自 MarshalByRefObject。

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2008-09-17T23:50:12.213

如果您的目标是 3.5，则可以利用新的[托管可扩展性框架](http://code.msdn.microsoft.com/mef) 为您处理所有繁重的工作。

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2008-09-17T23:46:48.007

您可以使用[AppDomain.CreateInstance](http://msdn.microsoft.com/en-us/library/44s54yc4.aspx)方法来执行此操作。您需要调用返回的 ObjectHandle 的 Unwrap 方法以获取实际对象。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2008-09-17T23:50:47.890

使用 AppDomain.Create( ... ) 创建一个新的 Appdomain。创建 AppDomain 后，将 DLL 加载到该 AppDomain 中。

使用 Create* 查看 Appdomain 的所有方法。有某些东西，如 CreateInstanceAndUnwrap 等。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2008-09-18T00:27:05.727

如前所述，使用 AppDomain.CreateDomain 创建一个新的应用程序域。然后，您可以使用 Load 方法将程序集加载到其中，甚至可以使用 ExecuteAssembly 方法执行程序集。您可以使用 GetAssemblies 查看是否已加载程序集。还要注意，一旦加载了程序集，就无法卸载它。您将需要卸载域。

# ios - Objective-C 和 Cocoa 的类似 CPAN/gem 的存储库？

> ID：88736
> 
> 赞同：8
> 
> 时间：2008-09-17T23:41:47.147
> 
> 标签：ios, objective-c, macos, cocoa

有没有像 Perl、Ruby、Python 等一样有用的 Objective-C / Cocoa 库的集中存储库？

在构建我的第一个 iPhone 应用程序时，我发现自己实现了一些非常基本的功能，这些功能只需在 Ruby 中快速“安装”即可。

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-04-14T13:03:30.643

有一个项目！它被称为**CocoaPods**！

主页：[http ://cocoapods.org/](http://cocoapods.org/)

来源：[https ://github.com/CocoaPods/CocoaPods](https://github.com/CocoaPods/CocoaPods)

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2008-09-18T00:20:08.397

不幸的是没有:(但是有一些非常有用的网站。我发现最好的网站之一是[cocoadev.com](http://www.cocoadev.com/)，因为它包含许多关于许多更晦涩的类的有用信息，通常包括代码片段来做一些非常酷的事情 :) 也许我们（可可社区）应该考虑建立这样的东西！

哦，我只记得这个网站[cocoadevcentral.com](http://www.cocoadevcentral.com/)也非常适合从可可开始。

* * *

## 回答 #3

> 赞同：3
> 
> 时间：2008-09-18T06:42:36.853

丹尼尔提到[了 http://cocoadev.com](http://cocoadev.com)。

更具体地说，请查看[http://www.cocoadev.com/index.pl?ObjectLibrary](http://www.cocoadev.com/index.pl?ObjectLibrary)。

“这个页面用于跟踪可重用的 Cocoa 类，这些类可以很容易地混合、匹配并放入现有的 Cocoa 项目中以添加有用的功能。”

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2008-09-18T15:20:28.543

我会对您必须实现什么样的“基本功能”感兴趣。提供的库中实际上已经有很多了，我想知道您是否只是没有找到已经存在的功能......

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2010-12-14T16:28:29.843

Mac OS 和 iOS 有一个新的可重用代码索引：[Cocoa Objects](http://cocoaobjects.com)

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2008-09-18T00:20:32.263

我可能在这里感到困惑或遗漏了一些东西......但是苹果不提供所有应该提供您正在寻找的所有非常基本功能的 Foundation / Cocoa / AppKit / CoreAudio / Qtkit / etc 库吗？

除了 xcode 附带或在 Apple 开发网站上提供的内容外，没有针对 Cocoa 的集中式存储库。

* * *

## 回答 #7

> 赞同：0
> 
> 时间：2008-09-18T06:24:48.347

谷歌代码也有一些客观的 C 东西。这取决于你在寻找什么......

* * *

## 回答 #8

> 赞同：0
> 
> 时间：2008-09-19T14:59:10.560

另请参阅 GitHub，许多有用的 Objective-C 项目，尤其是 iPhone。例如，参见 activerecord 和 cocoaoniguruma。

[http://github.com/search?q=objective-c](http://github.com/search?q=objective-c)

[http://github.com/search?q=objc](http://github.com/search?q=objc)

* * *

## 回答 #9

> 赞同：0
> 
> 时间：2008-09-22T06:14:13.853

谷歌有[谷歌 mac 工具箱，](http://code.google.com/p/google-toolbox-for-mac/)它让我开始对我的 iPhone 应用程序进行单元测试，这是我发现的主要缺失。

# java - 将 jmockit 期望与匹配器和原始类型一起使用

> ID：88743
> 
> 赞同：5
> 
> 时间：2008-09-17T23:43:39.683
> 
> 标签：java, unit-testing, mocking, jmockit

我正在使用 jmockit 进行单元测试（使用 TestNG），并且我在使用 Expectations 类来模拟一个使用匹配器将原始类型（布尔值）作为参数的方法时遇到了麻烦。这是一些说明问题的示例代码。

```
/******************************************************/
import static org.hamcrest.Matchers.is;

import mockit.Expectations;

import org.testng.annotations.Test;

public class PrimitiveMatcherTest {
  private MyClass obj;

  @Test
  public void testPrimitiveMatcher() {
    new Expectations(true) {
      MyClass c;
      {
        obj = c;
        invokeReturning(c.getFoo(with(is(false))), "bas");
      }
    };

    assert "bas".equals(obj.getFoo(false));

    Expectations.assertSatisfied();
  }

  public static class MyClass {
    public String getFoo(boolean arg) {
      if (arg) {
        return "foo";
      } else {
        return "bar";
      }
    }
  }
}
/******************************************************/ 
```

包含对 invokeReturning(...) 的调用的行会引发 NullPointerException。

如果我将此调用更改为不使用匹配器，如下所示：

```
invokeReturning(c.getFoo(false), "bas"); 
```

它工作得很好。这对我没有好处，因为在我的真实代码中，我实际上是在模拟一个多参数方法，我需要在另一个参数上使用匹配器。在这种情况下，Expectations 类要求**所有**参数都使用匹配器。

我很确定这是一个错误，或者可能无法将 Matchers 与原始类型一起使用（这会让我感到难过）。有没有人遇到过这个问题，并且知道如何解决它？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2008-09-18T04:52:00.053

所以问题似乎出在 Expectations.with() 中：

```
 protected final <T> T with(Matcher<T> argumentMatcher)
   {
      argMatchers.add(argumentMatcher);

      TypeVariable<?> typeVariable = argumentMatcher.getClass().getTypeParameters()[0];

      return (T) Utilities.defaultValueForType(typeVariable.getClass());
   } 
```

对 typeVariable.getClass() 的调用没有达到作者的预期，对 Utilities.defaultValueFor 类型的调用返回 null。将原始布尔值反自动装箱是 NPE 的来源。

我通过将 invokeReturning(...) 调用更改为：

```
invokeReturning(withEqual(false)), "bas"); 
```

我不再在这里使用匹配器，但它足以满足我的需要。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2008-09-18T01:33:25.600

问题是期望使用和匹配器不支持原始类型的组合。

Matchers 代码依赖于 Generic，它基本上不支持原始类型。通常，Matchers 的使用更多是为了匹配值；使用 Java 5 中的自动装箱/拆箱功能，这通常不是问题。

但是 JMockit 的期望没有使用它来匹配值，它使用它来进行某种解析以确定方法调用签名类型。在这种情况下，匹配器将导致布尔类型，而您的方法是原始类型。所以它失败了正确地模拟它。

很抱歉，我无法告诉您任何解决方法。也许其他人可以提供帮助。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2009-06-17T21:45:26.630

我更改了 JMockit（版本 0.982），以便“with(is(false))”和其他类似变体现在按预期工作（它不再返回 null，而是内部匹配器中的实际参数值）。

# asp.net-mvc - 什么是 ASP.Net MVC？

> ID：88763
> 
> 赞同：15
> 
> 时间：2008-09-17T23:49:04.680
> 
> 标签：asp.net-mvc, model-view-controller

当我第一次听说 StackOverflow，听说它是用 ASP.Net MVC 构建的时候，我有点困惑。我认为 ASP.Net 一直是 MVC 架构的一个例子。您拥有提供视图的 .aspx 页面、提供控制器的 .aspx.vb 页面，并且您可以创建另一个类作为模型。[在Microsoft 这篇文章](http://msdn.microsoft.com/en-us/library/ms998540.aspx)中描述了在 ASP.Net 中使用 MVC 的过程。

所以我的问题是。ASP.Net MVC 提供了哪些常规 ASP.Net（甚至早在 ASP.Net 1.1）无法提供的功能？它只是花哨的 URL？MS 能够将自己与 Ruby On Rails 等新技术进行比较，并说“我们也可以做到”，这仅仅是为了吹嘘自己的权利吗？ASP.Net MVC 是否提供了更多内容，而不是 File->New 菜单中的几个额外模板？

我现在可能听起来很怀疑和消极，所以我会停下来。但我真的很想知道 ASP.Net MVC 实际提供了什么。另外，如果有人能告诉我为什么它是 Model-View-Controller 而不是按照 View-Controller-Model 或 Model-Control-View 层的顺序，这取决于你是从上到下，反之亦然，我会真的很感激。

编辑

此外，可能值得指出的是，我也从未真正关心过 Web 表单（AKA 服务器控件）模型。我只很少使用它，从未在工作中使用过。

* * *

## 回答 #1

> 赞同：14
> 
> 时间：2008-09-17T23:56:12.090

.aspx 不符合 MVC 模式，因为在后面的代码（“控制器”）之前调用了 aspx 页面（“视图”）。

这意味着控制器对视图具有“硬依赖”，这非常违反 MVC 原则。

MVC 的核心优势之一是它允许您在不实例化真实视图的情况下测试控制器（其中包含大量逻辑）。在 .aspx 世界中，您根本无法做到这一点。

单独测试控制器比必须实例化整个 asp.net 管道（应用程序、请求、响应、视图状态、会话状态等）要快得多。

* * *

## 回答 #2

> 赞同：7
> 
> 时间：2008-09-18T09:43:30.570

Scott Guthrie 在这篇文章“ [ASP.NET MVC 框架](http://weblogs.asp.net/scottgu/archive/2007/10/14/asp-net-mvc-framework.aspx)”中解释了它

> *   默认情况下，它可以清晰地分离关注点、可测试性和 TDD。MVC 框架内的所有核心契约都是基于接口的并且易于模拟（它包括基于接口的 IHttpRequest/IHttpResponse 内在函数）。您可以对应用程序进行单元测试，而无需在 ASP.NET 进程中运行控制器（使单元测试更快）。你可以使用任何你想做的单元测试框架来做这个测试（包括 NUnit、MBUnit、MS Test 等）。
>     
>     
> *   它具有高度可扩展性和可插拔性。MVC 框架中的所有内容都经过设计，以便可以轻松替换/自定义（例如：您可以选择插入自己的视图引擎、路由策略、参数序列化等）。它还支持使用现有的依赖注入和 IOC 容器模型（Windsor、Spring.Net、NHibernate 等）。
>     
>     
> *   它包括一个非常强大的 URL 映射组件，使您能够使用干净的 URL 构建应用程序。URL 不需要在其中包含扩展名，并且旨在轻松支持 SEO 和 REST 友好的命名模式。例如，我可以轻松地将 /products/edit/4 URL 映射到上面项目中 ProductsController 类的“编辑”操作，或者将 /Blogs/scottgu/10-10-2007/SomeTopic/ URL 映射到“ BlogEngineController 类的 DisplayPost" 操作。
>     
>     
> *   MVC 框架支持使用现有的 ASP.NET .ASPX、.ASCX 和 .Master 标记文件作为“视图模板”（这意味着您可以轻松使用现有的 ASP.NET 功能，如嵌套母版页、<%= %> 片段、声明性服务器控件、模板、数据绑定、本地化等）。但是，它不使用现有的回发模型与服务器进行交互。相反，您会将所有最终用户交互路由到 Controller 类 - 这有助于确保关注点和可测试性的清晰分离（这也意味着没有基于 MVC 的视图的视图状态或页面生命周期）。
>     
>     
> *   ASP.NET MVC 框架完全支持现有的 ASP.NET 功能，如表单/Windows 身份验证、URL 授权、成员资格/角色、输出和数据缓存、会话/配置文件状态管理、健康监控、配置系统、提供程序架构等。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2008-09-17T23:58:02.613

首先，它使得创建具有明确定义的职责分离的可测试网站变得非常容易。使用新的 MVC 框架创建有效的 XHTML UI 也容易得多。

我已经使用第二个 CTP（我认为他们现在是五个）开始在网站上工作，并且之前创建了一些 Web 应用程序，我不得不说它比使用服务器控制模型好数百倍。

当您不知道自己在做什么时，服务器控件很好。当您开始了解 Web 应用程序应该如何运行时，您就开始与它们作斗争。最终，您必须编写自己的代码来克服当前控件的缺点。正是在这一点上，MVC 开始大放异彩。这甚至没有考虑您网站的可测试性......

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2008-09-18T00:12:43.220

不再有自动生成的 html ID！任何做任何类型的 javascript 的人都会欣赏这个事实。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2008-09-17T23:54:18.317

ASP.Net 与它的代码背后*几乎*是MVC - 但不是 - 一个重要的事情是代码隐藏直接绑定到 aspx 的 - 这是 MVC 的一个重要组成部分。如果您将代码隐藏视为控制器 - 应该与视图完全分离。新的 .NET MVC 完善了这一点 - 并带来了一个完整的 MVC 框架。虽然已经有 .NET 的现有版本（请参阅 Spring.NET）。

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2008-09-18T00:10:40.417

我浏览了几个简单的例子，比如[这个](http://www.asp.net/learn/mvc/tutorial-01-vb.aspx)。我可以看出区别。但是，我并没有真正看到 MVC 如何将视图与控制器分离。该视图仍然引用控制器中的内容。我确实看到了它如何使测试变得更加容易，并且至少在 MVC 中，控制器对视图一无所知。而且您不必处理视图来调用控制器中的方法。我可以看到这是一个相当大的飞跃，尽管乍一看它可能看起来并不多。

我同意@Will 关于对抗服务器控制的看法。我从来没有在实际使用过它们的情况下工作过，但是我认识的很多人都遇到了很多限制。

* * *

## 回答 #7

> 赞同：0
> 
> 时间：2008-09-18T09:36:29.633

关于 ASP.net MVC 与 ASP.net Web 表单的文章

[http://weblogs.asp.net/shijuvarghese/archive/2008/07/09/asp-net-mvc-vs-asp-net-web-form.aspx](http://weblogs.asp.net/shijuvarghese/archive/2008/07/09/asp-net-mvc-vs-asp-net-web-form.aspx)

# xml - 将 XML 展平为 HTML 表格

> ID：88773
> 
> 赞同：6
> 
> 时间：2008-09-17T23:51:53.487
> 
> 标签：xml, xslt, xpath

必须有一种通用的方法来转换一些分层的 XML，例如：

```
<element1 A="AValue" B="BValue">
   <element2 C="DValue" D="CValue">
      <element3 E="EValue1" F="FValue1"/>
      <element3 E="EValue2" F="FValue2"/>
   </element2>
   ...
</element1> 
```

进入扁平化的 XML (html)，沿途拾取选定的属性，并为成为列标题的属性提供不同的标签。

```
<table>
   <tr>
     <th>A_Label</th>
     <th>D_Label</th>
     <th>E_Label</th>
     <th>F_Label</th>
   </tr>
   <tr>
     <td>AValue</td>
     <td>DValue</td>
     <td>EValue1</td>
     <td>FValue1</td>
   </tr>
   <tr>
     <td>AValue</td>
     <td>DValue</td>
     <td>EValue2</td>
     <td>FValue2</td>
   </tr>
<table> 
```

好的，由于属性重新标记，因此没有通用解决方案，但您希望得到我的意思。我刚刚开始研究所有 XSLT/XPATH 的东西，所以我会及时解决它，但任何线索都会很有用。

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2008-09-18T00:19:31.657

我不能 100% 确定您要做什么，但如果您的 element1、element2 和 element3 嵌套一致，此解决方案可能会起作用。

```
<xsl:stylesheet version="1.0" xmlns:xsl="http://www.w3.org/1999/XSL/Transform"
    xmlns:msxsl="urn:schemas-microsoft-com:xslt" exclude-result-prefixes="msxsl">
    <xsl:output method="xml" indent="yes"/>

    <xsl:template match="/">
        <table>
            <xsl:apply-templates select="//element3"></xsl:apply-templates>
        </table>
    </xsl:template>

    <xsl:template match="element3">
        <tr>
            <td><xsl:value-of select="../../@A"/></td>
            <td><xsl:value-of select="../../@B"/></td>
            <td><xsl:value-of select="../@C"/></td>
            <td><xsl:value-of select="../@D"/></td>
            <td><xsl:value-of select="@E"/></td>
            <td><xsl:value-of select="@F"/></td>
        </tr>
        <xsl:apply-templates select="*"></xsl:apply-templates>
    </xsl:template>

</xsl:stylesheet> 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-08-02T15:09:58.873

我需要一个类似的 XSLT，但深度未知，这就是我的做法。

首先，为生成的 HTML table/def 列表添加一个包装器，并调用模板 mode="puke" 来展平我们的 XML 树：

```
<xsl:element name="div">
    <xsl:attribute name="class" select="puke" />
    <xsl:apply-templates select="$notice" mode="puke" />
</xsl:element> 
```

在这里，我们匹配每个节点以显示其内容（例如 text()）及其属性。我们递归地执行此操作。我使用 dl/dt/dd 因为我的源代码树是一个复杂的树，它不能被展平为 .

```
<!-- @description: 
    Display all field from the notice so the customer can tell what he want
-->
<xsl:template match="node()" mode="puke">
<xsl:message>
    puking : <xsl:value-of select="local-name( . )" />
</xsl:message>
    <xsl:element name="dl">
        <xsl:element name="dt">
            <xsl:attribute name="class">tagName</xsl:attribute> 
            <xsl:value-of select="local-name( . )" />
        </xsl:element>
        <xsl:element name="dd">
            <xsl:attribute name="class">tagText</xsl:attribute>
            <xsl:value-of select="text()" /></xsl:element> 
        <xsl:element name="dl">
            <xsl:attribute name="class">attr</xsl:attribute>
            <!-- display attribute -->
            <xsl:apply-templates select="@*" />
        </xsl:element>
    </xsl:element>
    <!-- recursive call on node() -->
    <xsl:apply-templates select="./*" mode="puke" />    
</xsl:template> 
```

匹配给定节点的属性并显示它们。

CSS 用于格式化生成的 HTML：

```
<style>
.puke {
    background-color: #BDD6DE;
    clear: both;
}
.tagName, .attrName {
    float: left;
}
.tagText, .attrText {
    clear: right;
}
</style> 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2008-09-18T00:17:37.107

我们已经有一个从 Oracle 数据库读取的 Pro*C 程序，它调用一个 perl 脚本，该脚本又执行一些 Java 从上述数据库中提取 XML 格式的数据，以调用一个批处理文件来执行一些 vbscript 将文件通过 FTP 传输到其他一些服务器。我真的希望在 Fortran 中有所作为。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2008-09-18T05:54:24.740

原来的问题需要澄清：

*   原始问题中的 BValue 和 CValue 会发生什么？为什么它们不应该成为扁平结构的一部分？
*   XML 文档中的所有元素是否都有 2 个属性，或者这完全是任意的？
*   是否只有 3 种类型的元素，它们是否总是嵌套，如示例中所示？
*   您的 element1 可以自己重复还是这是您的文档的根元素？

在 XSLT 中，可以编写非常通用的转换器，但是当您可以考虑任何已知限制时，编写样式表来转换文档通常要容易得多。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2008-09-18T09:47:04.460

我使用了以下模板的扩展版本来展平结构化 XML。警告：原始版本中有一些特定于案例的代码（它实际上将 XML 转换为 CSV），我只是剥离了这些代码，我没有测试这个版本。

它的基本工作方式应该很清楚：它打印没有节点子节点的所有内容，否则递归调用具有子节点的 node() 上的模板。我认为它不能像现在一样正确处理属性和注释，但这应该不难解决。

```
<?xml version="1.0" encoding="UTF-8"?>

<!-- XSL template to flatten structured XML, before converting to CSV. -->
<xsl:stylesheet version="1.0"
    xmlns:xsl="http://www.w3.org/1999/XSL/Transform">

    <xsl:output method="xml" indent="yes" encoding="UTF-8"/>

    <xsl:strip-space elements="*" /> 

    <xsl:template match="/">
        <xsl:apply-templates select="//yourElementsToFlatten"/>
    </xsl:template>

    <xsl:template match="//yourElementsToFlatten">
        <xsl:apply-templates select="@*|node()"/>
    </xsl:template>

    <xsl:template match="@*|node()">
        <xsl:choose>
            <!-- If the element has multiple childs, call this template 
                on its children to flatten it-->
            <xsl:when test="count(child::*) > 0">
                <xsl:apply-templates select="@*|node()"/>
            </xsl:when>
            <xsl:otherwise>
                <xsl:copy>
                    <xsl:value-of select="text()" />
                </xsl:copy>
            </xsl:otherwise>
        </xsl:choose>
    </xsl:template>

</xsl:stylesheet> 
```

# asp.net - sql server 离线时禁用（礼貌地）一个网站

> ID：88775
> 
> 赞同：3
> 
> 时间：2008-09-17T23:52:01.053
> 
> 标签：asp.net, sql, maintenance

我在一所大学工作，一直在开发一个 ASP.NET 站点，其中包含许多关于学生、出勤统计的报告……数据的基础是一个 MSSQL 服务器数据库，它是我们学生管理系统的后端。这在星期四早上有一个定期维护期，持续时间未知（取决于必须做什么）。

大多数员工都知道这一点，但不太经常使用的用户似乎永远在给我打电话。在维护期间禁用站点的最简单方法是什么显然我可以尝试数据库查询来测试它是否已启动但不确定将所有用户重定向到“网站因维护而关闭”消息的最佳方法，请记住，他们本可以在网站关闭之前开始会话。

希望可以在全球范围内而不是在每个页面上实现一些东西。

* * *

## 回答 #1

> 赞同：12
> 
> 时间：2008-09-17T23:53:48.817

将名为“app_offline.htm”的 html 文件拖放到虚拟目录的根目录中。就那么简单。

[Scott Guthrie](http://weblogs.asp.net/scottgu/archive/2006/04/09/442332.aspx)关于这个主题和友好的错误。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2008-09-17T23:57:49.417

您可以向已登录的人显示一条消息，说“该站点将在 xxx 分钟内关闭以进行维护”，然后运行一项服务以在 xxx 分钟后将所有人注销。然后在每个页面都可以访问的地方设置一个标志，并在每个页面（或只是模板页面）的顶部测试是否设置了该标志，如果是，则将重定向标头发送到站点已关闭以进行维护页面。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2008-09-18T00:01:05.977

如果用户已经在站点内导航，或者如果他从书签/外部链接到特定页面访问站点，“offline.html”页面将无法工作。

我使用的解决方案是使用相同的地址（IP 或主机标头）创建第二个网站，但默认情况下将其禁用。当网站关闭时，脚本会停用“真实”网站并启用“维护”网站。当它重新联机时，另一个脚本切换回“真实”网站。

“维护”网站位于不同的根目录中，只有一个页面包含消息（以及任何所需的图像/css 文件）

为了在任何页面上显示相同的消息，“维护”网站设置了一个 404 错误处理程序，它将任何请求重定向到相同的“网站因维护而停机”页面。

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2008-09-18T00:14:07.287

当站点关闭并且有人试图访问它时，现在会发生什么？ADO.NET 是否会引发您可以捕获的特定异常，然后重定向到“网站关闭”页面？

您可以将“Global.asax”文件添加到项目中，并在其代码隐藏中添加“Application_Error”事件处理程序。每当从您的网络应用程序的任何地方抛出异常并且未被捕获时，它都会触发。例如，在 C# 中：

```
protected void Application_Error(object sender, EventArgs e)
{
    Exception e = Server.GetLastError().GetBaseException();
    if(e is SqlException)
    {    
        Server.ClearError();
        Server.Transfer("~/offline.aspx");
    }
} 
```

您还可以检查异常的 Number 属性，但我不确定哪个数字表示它无法连接到数据库服务器。您可以在它关闭时对其进行测试，找到 SQL 错误号并在线查找它是否是您真正想要检查的具体内容。

**编辑：**我明白你在说什么，petebob。

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2008-09-18T00:39:18.880

我建议在 Application_PreRequestHandlerExecute 中进行，而不是在发生错误后进行。一般来说，如果您知道您的数据库不可用，最好不要进入正常处理。我通常使用类似下面的东西

```
void Application_PreRequestHandlerExecute(Object sender, EventArgs e)
{
 string sPage = Request.ServerVariables["SCRIPT_NAME"];
 if (!sPage.EndsWith("Maintenance.aspx", StringComparison.OrdinalIgnoreCase))
 {
  //test the database connection
  //if it fails then redirect the user to Maintenance.aspx
  string connStr = ConfigurationManager.ConnectionString["ConnectionString"].ConnectionString;
  SqlConnection conn = new SqlConnection(connStr);
  try
  {
   conn.Open();
  }
  catch(Exception ex)
  {
   Session["DBException"] = ex;
   Response.Redirect("Maintenance.aspx");
  }
  finally
  {
   conn.Close();
  }
 }
} 
```

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2008-09-18T00:24:16.123

感谢到目前为止的回复，我应该指出我不是负责维护的人，也不是一直都可以访问 IIS。此外，我更喜欢我什么都不做的选项，因为我有点懒惰。

我知道一种方法是检查每一页上的标志，但我希望避免它。我能不能对 global.asax 页面做点什么，事实上，我认为发布已经吸引了我的大脑：

想我可以在 Application_BeginRequest 中放入一些代码来检查 SQL 状态然后重定向：

```
HttpContext context = HttpContext.Current;
     if (!isOnline())
     {
        context.Response.ClearContent();
        context.Response.Write("<script language='javascript'>" + 
"top.location='" + Request.ApplicationPath + "/public/Offline.aspx';</scr" + "ipt>");
     } 
```

或者类似的东西可能不完美，还没有测试，因为我不在工作。评论赞赏。

* * *

## 回答 #7

> 赞同：0
> 
> 时间：2008-09-18T00:41:05.413

每个页面上的数据库检查的稍微更优雅的版本是在 Global.asax 文件中进行检查，或者创建一个所有其他页面都继承自的母版页。

拥有一个在线站点和一个离线站点的建议非常好，但只有当您在服务器上管理的站点数量有限时才真正适用。

**编辑：**该死的，这些建议的其他答案是在我加载页面后出现的。我需要记得在回复之前刷新:)

* * *

## 回答 #8

> 赞同：0
> 
> 时间：2008-09-18T00:44:45.390

詹姆斯代码忘记关闭连接，应该是：

```
try
{
   conn.Open();
}
catch(Exception ex)
{
   Session["DBException"] = ex;
   Response.Redirect("Maintenance.aspx");
}
finally
{
   conn.Close();
} 
```

# .net - 您认为 ASP.NET MVC 会与 ASP.NET Webforms 竞争吗？

> ID：88787
> 
> 赞同：12
> 
> 时间：2008-09-17T23:55:57.753
> 
> 标签：.net, asp.net, asp.net-mvc

您认为 ASP.NET MVC 是否会在 Microsoft Web 开发市场中占有重要的份额？还是会更像市场的 10-15%？

* * *

## 回答 #1

> 赞同：14
> 
> 时间：2008-09-17T23:59:50.223

哦是的。它将把 Web 表单从水中吹走——我们已经看到了真正的 MVC 框架在 Java 世界中的价值。在 MS 世界里——这确实是一个需要填补的空白。

作为一个前 Java/Struts 的老兄——我发现在 Web 表单中做当前的工作非常令人沮丧——因为我知道那里有一些工具可以让我的生活变得如此轻松。

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2008-09-18T00:18:46.527

MVC is great but won't become a real contender as a replacement for Web Forms until it includes it's own rich control set. As you probably already know, some of the existing controls do work with it but many don't. Regardless of this though, I still love using it.

* * *

## 回答 #3

> 赞同：4
> 
> 时间：2008-09-18T00:36:29.417

嗯，.NET 一直无法完全对抗 Visual Basic 6 的惯性（我仍然看到一些商店刚刚*开始*转向 .NET），所以必须考虑 ASP.NET Webforms 的惯性以及它目前是如何部署到各处的。

毫无疑问，ASP.NET MVC 将得到广泛采用，但它会由有架构意识的类型推动：一些经理和节奏不太快的开发人员不会在意。

* * *

## 回答 #4

> 赞同：3
> 
> 时间：2008-09-18T00:01:54.850

我不这么认为。两种解决方案的目的和目标不同，APS.NET Web Forms更像是一个平台，而MVC是架构框架，所以这个问题有点奇怪。在我看来，MVC 结合良好的 AJAX 支持和正确的服务器端模型结构可能是开发 Web 应用程序子范围的更方便的方法，但 Web 窗体不会消失，它们将在下一个版本中进一步改进。

干杯。

* * *

## 回答 #5

> 赞同：3
> 
> 时间：2008-09-18T00:03:25.113

我认为最终，MVC 将拥有 MS-web-market 100% 的份额。它只是更好。

* * *

## 回答 #6

> 赞同：3
> 
> 时间：2008-09-18T00:32:46.277

As Ty said, there won't be a lot of adoption until the controls are there. I do think it will surpass webforms once they are. The webform model falls too pieces once you need to do something complicated and it is difficult to test. The ability to unit test MVC is HUGE, but people just don't know what they are missing yet.

I think that ASP.NET MVC is the best of ASP classic (lots of rendering control) and ASP.NET (the ability to have real architectures and lack of spaghetti code).

* * *

## 回答 #7

> 赞同：2
> 
> 时间：2008-09-17T23:59:07.137

由于 webforms 安装基础，我认为这将是一个缓慢的开始。随着单元测试和标记控制开始对**更多人变得越来越重要，**我认为您开始看​​到迁移。我怀疑它是否会达到 Web 平台 MS 安装基础的 100%，但在接下来的几年中它将稳步上升。会有粉丝会说这将主宰行星切片面包，但这是不现实的。有了这个，我希望不必长时间使用 Webforms。

> **编辑：** 现在我们处于 Beta 1，我们***开始***看到组件供应商开始发布一些东西。看起来首先是 Telerik[在 ASP.NET MVC 中使用他们的 ASP.NET Ajax 控件](http://blogs.telerik.com/AtanasKorchev/Posts/08-11-06/ASP_NET_Ajax_Controls_in_ASP_NET_MVC.aspx?ReturnURL=%2fAtanasKorchev%2fPosts.aspx)

* * *

## 回答 #8

> 赞同：2
> 
> 时间：2008-09-18T14:10:32.893

我的猜测是，微软真的必须站出来说“MVC 是你应该做 Web 应用程序的*唯一*方式”，然后企业才会大规模地使用它。所以不，就目前而言，用户群很小。

* * *

## 回答 #9

> 赞同：1
> 
> 时间：2008-09-19T13:24:02.097

我认为更多的人了解模型视图控制器的重要性以及简单页面控制器的局限性，这就是 ASP.Net 表单的真正含义。

正如有人指出的那样，问题出在 Visual Basic 人身上——你认识的人来自经典的 ASP 经验，从未见过任何单元测试和/或基于 MVC 的 Java/Ruby/PHP 开发。我相信这是大多数.NET 开发人员。我在某处读到世界上有 600 万 VB 开发人员。猜猜，这些人现在在做什么？

来自 Java/Ruby/PHP 商店的人，已经习惯了 MVC 应用程序，肯定会适应 MS MVC 框架。

* * *

## 回答 #10

> 赞同：0
> 
> 时间：2008-09-26T11:54:24.413

我认为对于那些在代码隐藏范式之外没有经验的人来说，网络表单满足了安全/舒适的需求。我并不是说这很糟糕，因为对于商业中的许多任务来说，目标是完成某件事并接受它。不幸的是，商业是关于结果的，很多时候你被迫忽略方法。

另一方面，当情况确实需要页面之间的复杂交互时，Webforms 会引入如此多的复杂性以及所有变通方法。注册脚本块只是为了能够触发 javascript？当您想与 Windows 进行客户端通信时怎么办？MS 应该花一些时间来增强他们的 javascript 调试工具集，甚至可能在 MSDN 上提供一系列关于 JSON / JQuery 的内容。只是一些想法。

* * *

## 回答 #11

> 赞同：0
> 
> 时间：2009-09-08T18:26:24.983

MVC 真正有意义的地方在于，如果您已经了解 HTTP 和 Rest 的基本概念。如果您真的想利用自定义 JavaScript 并拥有高度域用户优化的体验。如果您喜欢使用所有拖放控件进行 Web 表单开发，并且对您的用户体验和 Atlas 更新面板感到满意，那么您真的应该坚持下去。

MVC 适用于希望轻松利用 .NET 服务器端和自定义客户端的我们其他人。它适用于那些拥有网页设计师和想要构建自定义 HTML 的人，就像我们拥有那些有成就的程序员一样。

如果您是一个孤独的人（可能是 IT 人员），为您的 Intranet 为前台工作，您可能会更好地使用网络表单。这确实是 webforms 和 .NET 的亮点。一些较新的工具 EF 和 MVC 对团队和更大规模的开发具有广告价值。

所以不，我认为它们是相辅相成的。

* * *

## 回答 #12

> 赞同：0
> 
> 时间：2008-09-26T12:46:25.833

我认为 MVC 将在企业级应用程序中流行起来，与小型夫妻应用程序相比，可测试性和灵活性更为重要。

没有计划逐步淘汰经典的代码隐藏模型，我觉得由于大多数人都习惯了这种技术，所以很多人很可能会继续使用它。

如果一个人没有使用 MVC 的经验，那么这可能是一种范式转变。我没有看到很多人蜂拥而至。我认为 80% 的代码隐藏和 20% 的 MVC 百分比是正确的。

由于代码隐藏模型已经存在了这么长时间，我敢打赌有很多程序员只对经典的代码隐藏事件生命周期有经验。

* * *

## 回答 #13

> 赞同：0
> 
> 时间：2008-09-18T04:58:29.180

我认为喜欢这种开发模型的开发人员会采用它，但我更喜欢 Web 表单，因为生命周期提供了一种创建可重用控件的好方法。

您还可以使用 webforms 保持 MVC 开发风格，并能够为所有代码创建单元测试，因此可测试并不是 MVC 更好的真正理由。

* * *

## 回答 #14

> 赞同：0
> 
> 时间：2008-09-18T12:56:21.370

我的猜测是，如果您对 TDD、REST、编写自己的 HTML 等感兴趣，MVC 是“经典”Webform 编程的替代解决方案。目前开发者仍然喜欢 D&D 的开发风格，因为它允许快速开发应用程序，即使这样它也变得无法维护。随着越来越多的人开始采用敏捷方法，并且对编写可维护的软件而不是开发快速而肮脏的应用程序更感兴趣，MVC 将获得更多的用户群。在一次演讲中，我记得 ScottH 说他们认为 MVC 会浮动 5-10%，

* * *

## 回答 #15

> 赞同：0
> 
> 时间：2008-09-19T12:56:22.163

我最近才开始使用 MS 的 MVC 框架。随着 Preview 5 的发布，我开始深入了解它。让人们使用它的最大障碍是缺乏示例和有用的参考资料。

该框架本身是一种很好的使用体验，尤其是与 jQuery 和 nUnit 结合使用时。从 OO 的角度来看，您的网站设计变得更加自然，我认为，一旦学习曲线随着广泛可用的优质入门材料而减少，那么它将成为使用 MS 产品进行 Web 开发的主要架构。

* * *

## 回答 #16

> 赞同：0
> 
> 时间：2009-04-07T12:18:10.347

## [仔细研究 ASP.NET MVC 的 5 个理由](http://weblogs.asp.net/dwahlin/archive/2009/04/06/5-reasons-you-should-take-a-closer-look-at-asp-net-mvc.aspx)

# c# - 您如何看待在 C# 中使用属性作为对象初始值设定项？

> ID：88791
> 
> 赞同：3
> 
> 时间：2008-09-17T23:57:35.643
> 
> 标签：c#

我想知道人们对在 C# 中使用属性作为对象初始化器的想法。由于某种原因，它似乎打破了构造函数的基本原理。

一个例子...

```
public class Person
{
    string firstName;
    string lastName;

    public string FirstName
    {
      get { return firstName; }
      set { firstName = value; }
    }

    public string LastName
    {
      get { return lastName; }
      set { lastName= value; }
    }
} 
```

然后用.....做对象初始化

```
Person p = new Person{ FirstName = "Joe", LastName = "Smith" };
Person p = new Person{ FirstName = "Joe" }; 
```

* * *

## 回答 #1

> 赞同：10
> 
> 时间：2008-09-18T00:01:33.277

您在这里看到的是编译器提供的一些语法糖。在引擎盖下它真正做的是这样的：

**Person p = new Person(FirstName = "Joe", LastName = "Smith");**

```
Person _p$1 = new Person();
_p$1.FirstName = "Joe";
_p$1.LastName = "Smith";
Person p = _p$1; 
```

所以恕我直言，你并没有真正打破任何构造函数的基础，而是使用了一个很好的语言工件来简化可读性和可维护性。

* * *

## 回答 #2

> 赞同：6
> 
> 时间：2008-09-18T00:11:48.807

对象初始值设定项绝不会取代构造函数。构造函数定义了为了创建类的实例而必须遵守的契约。

C# 语言中对象初始值设定项的主要动机是支持[匿名类型](http://msdn.microsoft.com/en-us/library/bb397696.aspx)。

```
var v = new { Foo = 1, Bar = "Hi" };
Console.WriteLine(v.Bar); 
```

* * *

## 回答 #3

> 赞同：4
> 
> 时间：2008-09-18T00:00:17.070

恕我直言，它很甜。大多数对象都使用默认构造函数进行了更新，并且必须在它们准备好运行之前设置一些属性；所以对象初始值设定项可以更容易地针对大多数对象进行编码。

* * *

## 回答 #4

> 赞同：2
> 
> 时间：2008-09-18T00:15:12.463

由于您已经在使用新的 C# 语法，因此不妨也使用自动属性，只是为了让您的代码更加甜美：

而不是这个：

```
string firstName;

public string FirstName
{
  get { return firstName; }
  set { firstName = value; }
} 
```

用这个：

```
public string FirstName { get; set; } 
```

* * *

## 回答 #5

> 赞同：2
> 
> 时间：2008-09-18T00:15:34.773

构造函数应该只真正具有构造对象*所需的参数。*对象初始化器只是为属性赋值的一种便捷方式。我尽可能使用对象初始化器，因为我认为这是一种更简洁的语法。

* * *

## 回答 #6

> 赞同：1
> 
> 时间：2008-09-18T00:04:11.337

我认为总的来说它很有用，尤其是在与自动属​​性一起使用时。当属性做的不仅仅是获取/设置时，它可能会令人困惑。希望这将导致更多的方法，并减少属性的滥用。

* * *

## 回答 #7

> 赞同：1
> 
> 时间：2008-09-18T00:40:40.797

不是你原来的问题，但仍然......

你的类声明可以写成：

```
public class Person
{
    public string FirstName { get; set; }
    public string LastName {get; set; }
} 
```

如果是我的代码，我可能会有一个 Name 对象，其中包含 First 和 Last 字段。

* * *

## 回答 #8

> 赞同：0
> 
> 时间：2008-09-18T00:05:13.953

从语言集成查询（linq）返回的投影类也非常必要

```
var qry = from something in listofsomething
          select new {
                        Firstname = something.FirstName,
                        Lastname = something.Surname
                      } 
```

* * *

## 回答 #9

> 赞同：0
> 
> 时间：2008-09-18T00:12:06.217

对象初始化器有助于降低编码复杂性，因为您不需要创建六个不同的构造函数来为属性提供初始值。在我的书中，任何减少冗余代码的事情都是积极的。

我相信该功能被添加到语言中的主要原因是支持LINQ 的[匿名类型](http://msdn.microsoft.com/en-us/library/bb397696.aspx)。

* * *

## 回答 #10

> 赞同：0
> 
> 时间：2008-09-18T00:14:02.780

添加到 Nescio 的想法 - 我建议在代码审查中积极寻找属性访问器中昂贵的透明操作，例如 DB 往返。

* * *

## 回答 #11

> 赞同：0
> 
> 时间：2008-09-18T00:27:29.970

如果要强制使用构造函数，可以将对象的默认无参数构造函数设置为私有，并只保留一些强制构造函数：

```
public class SomeObject
{
    private SomeObject()
    {}

    public SomeObject(string someString) //enforced constructor
    {}

    public string MyProperty { get; set; }
 } 
```

使用上面的定义，这会引发错误：

```
var myObject = new SomeObject { MyProperty = "foo" } //no method accepts zero arguments for constructor 
```

当然，这不能适用于所有情况。例如，序列化要求您有一个非私有的默认构造函数。

* * *

## 回答 #12

> 赞同：0
> 
> 时间：2008-09-19T20:52:20.537

我对他们不满意。我认为它们在构造函数中没有一席之地，或者 MS 应该返回并重构它们以允许您以私人方式使用它们。如果我构造一个对象，我想传入一些 PRIVATE 数据。我希望它从外部世界设置一次，仅此而已。使用对象初始化器，您可以修改传递给构造函数的值。

也许将来他们会改变这一点。

# visual-studio-2008 - VS2008 项目负载崩溃

> ID：88797
> 
> 赞同：3
> 
> 时间：2008-09-17T23:59:12.393
> 
> 标签：visual-studio-2008

启动 VS2008 后，我无法加载任何现有项目。当我尝试打开现有项目时，VS2008 会崩溃。尝试在 VS 中加载浮动窗口时似乎崩溃了，但我不知道是哪一个。

当我在崩溃的实例上启动调试器时，我收到以下消息，这不是很有用。

devenv.exe 中 0x00740078 处的未处理异常：0xC0000005：访问冲突写入位置 0x7e429ed9。

我以前安装过 SP1，但现在已将其删除。我也使用过 Resharper 4.0，但也卸载了它，但问题仍然存在。

有没有人有关于如何解决 VS2008 崩溃问题的提示？我真的不想重新安装产品。

作为一种解决方法，我发现如果我创建一个新的类库项目，它会因为写入受保护的内存错误而失败。如果我尝试创建另一个新的类库项目，它将工作，然后我可以加载现有项目。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2008-09-18T00:40:23.073

您还可以尝试使用 /ResetSettings 参数（它将重置您拥有的任何自定义设置）或使用 /SafeMode 标志运行 devenv.exe。/SafeMode 不会帮助您解决问题，但它至少会将问题缩小到安全模式和常规模式之间的不同之处。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2008-09-18T00:06:00.380

尝试重命名：
projectName.csproj.user 文件
solutionName.suo 文件
solutionName.ncb 文件
...并查看项目是否打开。

# mysql - 如何使用 mysql 二进制日志从删除数据库命令中恢复？

> ID：88800
> 
> 赞同：8
> 
> 时间：2008-09-17T23:59:56.667
> 
> 标签：mysql, database, recovery

如何恢复使用“drop database”命令删除的 mysql 数据库？我可以访问二进制日志，这应该使这种类型的回滚成为可能。

* * *

## 回答 #1

> 赞同：9
> 
> 时间：2008-09-18T00:15:01.200

文档很烂。它暗示 DROP DATABASE 是可恢复的，但仅在我不熟悉[http://dev.mysql.com/doc/refman/5.0/en/binary-log.html的奇怪情况下](http://dev.mysql.com/doc/refman/5.0/en/binary-log.html)

根据 Docs，binlog 只是基于给定参考点执行的一系列命令。所以当你执行“DROP DATABASE”时，而不是“哦，他正在删除数据库，我们现在应该备份以防万一”，它只是在最后一个 binlog 中写入了一个“DROP DATABASE”。恢复并不像倒放磁带那么简单。

您需要做的是从上次已知良好状态恢复数据库，并应用在该恢复点和 DROP 命令之间发生的二进制日志。

[http://dev.mysql.com/doc/refman/5.0/en/recovery-from-backups.html](http://dev.mysql.com/doc/refman/5.0/en/recovery-from-backups.html)

如何确定使用哪些二进制日志，尚不清楚。

没有什么比拥有完整的文件系统备份更好的了。你至少应该有这些可以回退。

* * *

## 回答 #2

> 赞同：5
> 
> 时间：2008-09-18T00:02:48.140

如果您没有数据库的备份，那么您就不走运了。*删除*数据库是永久性的。

* * *

## 回答 #3

> 赞同：5
> 
> 时间：2008-09-18T00:20:20.533

假设您有备份，二进制日志会保存自该备份以来发生的内容。使用 mysqlbinlog 实用程序，您可以执行以下操作：

mysqlbinlog the_log_file > update.sql

尽管我认为您可能必须编辑该文件以删除您不想再次执行的任何内容（例如 drop database 语句）。

祝你好运！

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2013-10-03T09:11:29.900

没有备份没有派对。

所以我会回答：

为了再也不会遇到这种情况，请安装超简单且功能强大的 automysqlbackup（如果您使用的是 linux）：

sudo apt-get install automysqlbackup

配置它：

sudo nano /etc/default/automysqlbackup

然后将其内容自动上传到 Dropbox、ubuntu 之一或类似的。

只有这样才能快乐地生活:)

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2015-02-09T14:58:32.390

只是为了补充 Kent Fredric 的回答，`drop database`如果您在数据库创建后使用二进制日志记录，则可以回滚命令。

# php - 天花板函数的 PHP 代码

> ID：88831
> 
> 赞同：1
> 
> 时间：2008-09-18T00:09:17.550
> 
> 标签：php, excel, perl, ceil

有没有人编写过 PHP（或 Perl）函数来获得 Excel 风格的上限？

* * *

## 回答 #1

> 赞同：8
> 
> 时间：2012-04-10T15:17:49.437

This should be the answer, from php.net comments:

```
// MS Excel function: Ceiling( number, significance ) 

// duplicates m$ excel's ceiling function
if( !function_exists('ceiling') )
{
    function ceiling($number, $significance = 1)
    {
        return ( is_numeric($number) && is_numeric($significance) ) ? (ceil($number/$significance)*$significance) : false;
    }
}

echo ceiling(0, 1000);     // 0
echo ceiling(1, 1);        // 1000
echo ceiling(1001, 1000);  // 2000
echo ceiling(1.27, 0.05);  // 1.30 
```

* * *

## 回答 #2

> 赞同：7
> 
> 时间：2008-09-18T00:23:17.063

*"Microsoft Excel's ceiling function does not follow the mathematical definition, but rather as with (int) operator in C, it is a mixture of the floor and ceiling function: for x ≥ 0 it returns ceiling(x), and for x < 0 it returns floor(x). This has followed through to the Office Open XML file format. For example, CEILING(-4.5) returns -5\. A mathematical ceiling function can be emulated in Excel by using the formula "-INT(-value)" (please note that this is not a general rule, as it depends on Excel's INT function, which behaves differently that most programming languages)."* - from [wikipedia](http://en.wikipedia.org/wiki/Ceiling_function)

If php's built in ceil function isn't working right you could make a new function like

```
function excel_ceil($num){
    return ($num>0)?ceil($num):floor($num);
} 
```

Hope that helps

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2008-09-18T00:11:07.823

抱歉，不太清楚“Excel 风格”是什么，但 PHP 有一个[ceil](http://us3.php.net/ceil)函数。

# session - 会话外观核心 J2EE 模式的优点和缺点是什么？

> ID：88833
> 
> 赞同：8
> 
> 时间：2008-09-18T00:10:13.100
> 
> 标签：session, jakarta-ee, design-patterns, facade

会话外观核心 J2EE 模式的优点和缺点是什么？

它背后的假设是什么？

这些假设在特定环境中是否有效？

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2008-09-18T00:13:43.530

Session Facade 是一种奇妙的模式——它实际上是 Business Facade 模式的一个特定版本。这个想法是将业务功能绑定到离散的捆绑包中 - 例如 TransferMoney()、Withdraw()、Deposit()... 这样您的 UI 代码就可以根据业务操作而不是低级别的数据访问或其他细节来访问事物它不应该担心。

特别是会话外观——您使用会话 EJB 作为业务外观——这是很好的原因，您可以利用所有 J2EE 服务（身份验证/授权、事务等）...

希望有帮助...

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2008-09-18T23:16:40.163

会话外观模式的主要优点是您可以将 J2EE 应用程序按业务功能划分为逻辑组。会话外观将由 UI 中的 POJO（即业务委托）调用，并具有对适当数据访问对象的引用。例如 PersonSessionFacade 将由 PersonBusinessDelegate 调用，然后它可以调用 PersonDAO。PersonSessionFacade 上的方法至少会遵循 CRUD 模式（创建、检索、更新和删除）。

通常，大多数会话外观都是作为无状态会话 EJB 实现的。或者，如果您在 Spring 领域使用 AOP 进行事务，则可以创建一个服务 POJO，它可以作为事务管理器的所有连接点。

SessionFacade 模式的另一个优点是任何具有一点经验的 J2EE 开发人员都会立即了解您。

SessionFacade 模式的缺点：它假定特定的企业架构受到 J2EE 1.4 规范的限制（有关这些批评，请参阅 Rod Johnson 的书籍）。最具破坏性的缺点是它比必要的复杂。在大多数企业*Web*应用程序中，您将需要一个 servlet 容器，而 Web 应用程序中的大部分压力将在处理 HttpRequest 或数据库访问的层上。因此，似乎不值得将 servlet 容器部署在与 EJB 容器不同的进程空间中。即对 EJB 的远程调用带来的痛苦多于收获。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2008-09-21T23:31:47.797

Rod Johnson 声称您想要使用 Session Facade 的主要原因是如果您正在执行容器管理的事务 - 这对于更现代的框架（如 Spring）是不必要的。

他说，如果你有业务逻辑 - 把它放在 POJO 中。（我同意 - 我认为它是一种更面向对象的方法 - 而不是实现会话 EJB。） [http://forum.springframework.org/showthread.php?t=18155](http://forum.springframework.org/showthread.php?t=18155)

很高兴听到相反的论点。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2008-09-22T02:06:01.093

似乎每当您谈论任何与 J2EE 相关的事情时——在幕后总是有一大堆假设——人们以一种或另一种方式假设——然后导致混乱。（我可能也可以使问题更清楚。）

假设 (a) 我们想通过 EJB 规范严格地使用容器管理事务，那么

会话外观是一个好主意——因为它们抽象出低级别的数据库事务，以便能够提供更高级别的应用程序事务管理。

假设 (b) 您的意思是会话外观的一般架构概念 - 那么

将服务和消费者解耦并在此之上提供一个友好的界面是一个好主意。计算机科学通过“添加额外的间接层”解决了许多问题。

Rod Johnson 写道：“具有远程接口的 SLSB 为基于 RMI 构建的分布式应用程序提供了一个非常好的解决方案。然而，这是少数要求。经验表明，除非有需求，否则我们不想使用分布式架构。我们仍然可以如有必要，通过在良好的协同定位对象模型之上实现远程处理外观来为远程客户端提供服务。” （Johnson, R“没有 EJB 的 J2EE 开发”p119。）

假设 (c) 您认为 EJB 规范（尤其是会话外观组件）是对良好设计领域的破坏，那么：

Rod Johnson 写道：“总的来说，在 Spring 应用程序中使用本地 SLSB 的理由并不多，因为 Spring 提供了比 EJB 更强大的声明式事务管理，而 CMT 通常是使用本地 SLSB 的主要动机。所以你可能根本不需要 EJB 层。” [http://forum.springframework.org/showthread.php?t=18155](http://forum.springframework.org/showthread.php?t=18155)

在 Web 服务器的性能和可扩展性是主要关注点的环境中 - 并且成本是一个问题 - 然后会话外观架构看起来不那么有吸引力 - 直接与数据库对话可能更简单（尽管这更多地是关于分层。）

# php - PHP 中的 PDF 拼版

> ID：88836
> 
> 赞同：2
> 
> 时间：2008-09-18T00:10:55.110
> 
> 标签：php, pdf, imposition

我正在寻找一个`PHP`允许我创建 print-ready 的库`PDF`。拼版应包括 1-up、4-up、24-up 等布局和裁剪标记。

`FPDF`，`TCPDF`并且`PHP's`包含`PDF`的​​库允许我创建图像并将其放在 PDF 上，但更高级的布局和裁剪标记有点超出我的能力。

提前致谢！

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2008-09-18T01:06:35.303

我们成功使用了 DOMPDF [http://www.digitaljunkies.ca/dompdf/](http://www.digitaljunkies.ca/dompdf/) - 只需定义您想要以常规 HTML 格式打印的内容，然后将文档传递给 DOMPDF，它就会从中创建一个 PDF。

比使用基于矢量的解决方案要方便得多，这些解决方案需要您在页面上自行布局（如 FPDF）。使用 HTML 进行布局！这要容易得多。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2009-01-14T23:57:33.257

正如其他人所提到的，我强烈推荐 DOMPDF 或 PDFLib。

DOMPDF 支持 XHTML 和 CSS2.1，并允许您从 HTML 呈现 PDF 页面。

PDFlib+PDI 将允许您合并 PDF 文档或附加页面、放置图像、文本等。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2008-09-18T00:14:56.630

[http://www.pdflib.com/download/](http://www.pdflib.com/download/)

这是一个您没有提到的库，它将允许使用 php 创建 PDF。希望够用了。

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2009-02-05T13:16:13.013

**phpLiveDocx**完全符合您的要求。它非常易于使用，并允许您使用 PHP 中的数据填充在文字处理器中创建的模板。[在http://www.phplivedocx.org/articles/brief-introduction-to-phplivedocx/](http://www.phplivedocx.org/articles/brief-introduction-to-phplivedocx/)了解更多信息

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2008-09-18T00:16:25.643

我在[PDFLib](http://www.pdflib.com/)上取得了很大的成功，它是一个非常强大的库，带有 PHP（和 C、C#、Perl 等）绑定。

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2008-09-18T00:35:24.647

FPDF 一直对我有用。那里有很多强大的功能，你只需要坚持下去就能找到它。

ImageEPS 类扩展对于准备打印非常有用，尽管它并非没有问题（因为它是一个相当旧的扩展并且不很好地支持 .ai 和 .eps 文件，尽可能向后兼容。）

您可以使用绘图功能生成裁剪标记。

页眉和页脚设置有点违反直觉，但它有效。( [http://www.fpdf.org/en/tutorial/tuto2.htm](http://www.fpdf.org/en/tutorial/tuto2.htm) )

页面的方向和大小很容易设置。（[http://www.fpdf.org/en/doc/fpdf.htm](http://www.fpdf.org/en/doc/fpdf.htm)）

Multicell 对于动态生成的内容来说是一个非常有用的功能，尽管没有办法处理构建它的溢出。您必须有一些方法来计算字符并将数据传递到复杂布局的块中。

我相信论坛中有分页的扩展。( [http://www.fpdf.org/en/script/script86.php](http://www.fpdf.org/en/script/script86.php) )

再加上我是个吝啬鬼:)

# java - 如何在 Java 中将字符串与 UTF8 字节数组相互转换

> ID：88838
> 
> 赞同：276
> 
> 时间：2008-09-18T00:11:21.117
> 
> 标签：java, string, encoding, character-encoding

在 Java 中，我有一个字符串，我想将它编码为一个字节数组（在 UTF8 或其他编码中）。或者，我有一个字节数组（在一些已知的编码中），我想将它转换为 Java 字符串。我如何进行这些转换？

* * *

## 回答 #1

> 赞同：412
> 
> 时间：2008-09-18T00:16:39.560

从字符串转换为字节[]：

```
String s = "some text here";
byte[] b = s.getBytes(StandardCharsets.UTF_8); 
```

从 byte[] 转换为 String：

```
byte[] b = {(byte) 99, (byte)97, (byte)116};
String s = new String(b, StandardCharsets.US_ASCII); 
```

当然，您应该使用正确的编码名称。我的示例使用了两种最常见的编码 US-ASCII 和 UTF-8。

* * *

## 回答 #2

> 赞同：100
> 
> 时间：2010-08-02T09:53:47.513

这是一个避免为每次转换执行字符集查找的解决方案：

```
import java.nio.charset.Charset;

private final Charset UTF8_CHARSET = Charset.forName("UTF-8");

String decodeUTF8(byte[] bytes) {
    return new String(bytes, UTF8_CHARSET);
}

byte[] encodeUTF8(String string) {
    return string.getBytes(UTF8_CHARSET);
} 
```

* * *

## 回答 #3

> 赞同：19
> 
> 时间：2008-09-18T00:13:15.603

```
String original = "hello world";
byte[] utf8Bytes = original.getBytes("UTF-8"); 
```

* * *

## 回答 #4

> 赞同：15
> 
> 时间：2008-09-18T11:32:38.390

您可以直接通过[String(byte[], String)](http://java.sun.com/javase/6/docs/api/java/lang/String.html)构造函数和 getBytes(String) 方法进行转换。Java 通过[Charset](http://java.sun.com/javase/6/docs/api/java/nio/charset/Charset.html)类公开可用的字符集。JDK 文档[列出了支持的编码](http://java.sun.com/javase/6/docs/technotes/guides/intl/encoding.doc.html)。

90% 的时间，此类转换是在流上执行的，因此您将使用[Reader](http://java.sun.com/javase/6/docs/api/java/io/InputStreamReader.html) / [Writer](http://java.sun.com/javase/6/docs/api/java/io/OutputStreamWriter.html)类。您不会在任意字节流上使用 String 方法进行增量解码 - 您可能会遇到涉及多字节字符的错误。

* * *

## 回答 #5

> 赞同：13
> 
> 时间：2013-10-19T20:38:27.857

我的 tomcat7 实现接受字符串为 ISO-8859-1；尽管 HTTP 请求的内容类型。在尝试正确解释像 'é' 这样的字符时，以下解决方案对我有用。

```
byte[] b1 = szP1.getBytes("ISO-8859-1");
System.out.println(b1.toString());

String szUT8 = new String(b1, "UTF-8");
System.out.println(szUT8); 
```

当试图将字符串解释为 US-ASCII 时，字节信息没有被正确解释。

```
b1 = szP1.getBytes("US-ASCII");
System.out.println(b1.toString()); 
```

* * *

## 回答 #6

> 赞同：8
> 
> 时间：2015-05-11T14:32:09.047

作为替代方案，可以使用来自 Apache Commons的[StringUtils 。](https://commons.apache.org/proper/commons-codec/apidocs/org/apache/commons/codec/binary/StringUtils.html)

```
 byte[] bytes = {(byte) 1};
 String convertedString = StringUtils.newStringUtf8(bytes); 
```

或者

```
 String myString = "example";
 byte[] convertedBytes = StringUtils.getBytesUtf8(myString); 
```

如果您有非标准字符集，则可以相应地使用[getBytesUnchecked()](https://commons.apache.org/proper/commons-codec/apidocs/org/apache/commons/codec/binary/StringUtils.html#getBytesUnchecked(java.lang.String,%20java.lang.String))或[newString()](https://commons.apache.org/proper/commons-codec/apidocs/org/apache/commons/codec/binary/StringUtils.html#newString(byte[],%20java.lang.String))。

* * *

## 回答 #7

> 赞同：4
> 
> 时间：2015-05-12T18:10:59.377

我无法发表评论，但不想开始新的话题。但这行不通。一个简单的往返：

```
byte[] b = new byte[]{ 0, 0, 0, -127 };  // 0x00000081
String s = new String(b,StandardCharsets.UTF_8); // UTF8 = 0x0000, 0x0000,  0x0000, 0xfffd
b = s.getBytes(StandardCharsets.UTF_8); // [0, 0, 0, -17, -65, -67] 0x000000efbfbd != 0x00000081 
```

在编码之前和之后我需要 b[] 相同的数组，它不是（这个引用到第一个答案）。

* * *

## 回答 #8

> 赞同：3
> 
> 时间：2016-07-01T07:12:28.340

为了将一系列字节解码为普通的字符串消息，我终于使用 UTF-8 编码使用此代码：

```
/* Convert a list of UTF-8 numbers to a normal String
 * Usefull for decoding a jms message that is delivered as a sequence of bytes instead of plain text
 */
public String convertUtf8NumbersToString(String[] numbers){
    int length = numbers.length;
    byte[] data = new byte[length];

    for(int i = 0; i< length; i++){
        data[i] = Byte.parseByte(numbers[i]);
    }
    return new String(data, Charset.forName("UTF-8"));
} 
```

* * *

## 回答 #9

> 赞同：1
> 
> 时间：2012-07-14T23:54:39.653

如果您使用 7 位 ASCII 或 ISO-8859-1（一种非常常见的格式），那么您根本不必创建新的[java.lang.String](http://docs.oracle.com/javase/7/docs/api/java/lang/String.html)。简单地将字节转换为 char 的性能要高得多：

完整的工作示例：

```
for (byte b : new byte[] { 43, 45, (byte) 215, (byte) 247 }) {
    char c = (char) b;
    System.out.print(c);
} 
```

如果您**不**使用Ä、Æ、Å、Ç、Ï、Ê 等*扩展字符，***并且**可以确定唯一传输的值是前 128 个 Unicode 字符，那么此代码也适用于 UTF-8 和扩展 ASCII （如 cp-1252）。

* * *

## 回答 #10

> 赞同：1
> 
> 时间：2016-01-15T12:18:47.550

```
Charset UTF8_CHARSET = Charset.forName("UTF-8");
String strISO = "{\"name\":\"א\"}";
System.out.println(strISO);
byte[] b = strISO.getBytes();
for (byte c: b) {
    System.out.print("[" + c + "]");
}
String str = new String(b, UTF8_CHARSET);
System.out.println(str); 
```

* * *

## 回答 #11

> 赞同：0
> 
> 时间：2013-07-01T09:30:56.900

```
//query is your json   

 DefaultHttpClient httpClient = new DefaultHttpClient();
 HttpPost postRequest = new HttpPost("http://my.site/test/v1/product/search?qy=");

 StringEntity input = new StringEntity(query, "UTF-8");
 input.setContentType("application/json");
 postRequest.setEntity(input);   
 HttpResponse response=response = httpClient.execute(postRequest); 
```

* * *

## 回答 #12

> 赞同：0
> 
> 时间：2015-05-12T12:32:15.560

```
Reader reader = new BufferedReader(
    new InputStreamReader(
        new ByteArrayInputStream(
            string.getBytes(StandardCharsets.UTF_8)), StandardCharsets.UTF_8)); 
```

* * *

## 回答 #13

> 赞同：-9
> 
> 时间：2010-02-19T00:04:18.700

太晚了，但我刚刚遇到了这个问题，这是我的解决方法：

```
private static String removeNonUtf8CompliantCharacters( final String inString ) {
    if (null == inString ) return null;
    byte[] byteArr = inString.getBytes();
    for ( int i=0; i < byteArr.length; i++ ) {
        byte ch= byteArr[i]; 
        // remove any characters outside the valid UTF-8 range as well as all control characters
        // except tabs and new lines
        if ( !( (ch > 31 && ch < 253 ) || ch == '\t' || ch == '\n' || ch == '\r') ) {
            byteArr[i]=' ';
        }
    }
    return new String( byteArr );
} 
```

# algorithm - 用于在图中找到哈密顿游走的多项式时间算法

> ID：88850
> 
> 赞同：5
> 
> 时间：2008-09-18T00:13:29.893
> 
> 标签：algorithm, np-complete

是否有用于在图中找到哈密顿步行的多项式时间算法？

我的算法是 N 阶乘，而且非常慢。

* * *

## 回答 #1

> 赞同：21
> 
> 时间：2008-09-18T02:19:55.270

通常，由于哈密顿路径问题的（决策版本）是 NP 完全的，因此您不能希望获得一个多项式时间算法来寻找哈密顿路径。您可以使用通常的 N 稍微加快速度！→ N ² 2 ^N动态规划技巧（计算 hp[v][w][S] = “对于每个子集 S 和每两个顶点 v 和w 在其中使用 DP），但这仍然是指数级的。

然而，有许多特殊类型的图始终存在哈密顿路径，并且很容易找到它们（参见 Posa、Dirac、Ore 等的工作）

例如，以下情况是正确的：*如果图的每个顶点的度数至少为 n/2*，则图具有哈密顿路径。事实上，如果你做得更聪明，你可以在 O(n ^(2 ) 或 IIRC 甚至 O(n log n) 中找到一个。)
[粗略的草图：首先，只需连接某个“哈密顿”循环中的所有顶点，不管边是否真的在图中。现在，对于实际上不在图中的循环的每条边 (v,w)，请考虑循环的其余部分：v...w。由于 deg(v)+deg(w)>=n，列表中存在连续的 x,y（按此顺序），因此 w 是 x 的邻居，v 是 y 的邻居。[证明：考虑{w的所有邻居的集合}和{v的邻居列表中所有后继者的集合}；它们必须相交。] 现在将你的循环 [v...xy...wv] 改为 [vy...wx...v]，它至少少了一个无效边，所以你最多需要n 次迭代以获得真正的哈密顿循环。更多细节[在这里](http://cgm.cs.mcgill.ca/~perouz/cs251/documents/solutions6/solutions6.html)。]

顺便说一句：如果您要查找的只是包含每条*边*一次的游走，则称为欧拉游走，对于具有它的图（奇数度的顶点数为 0 或 2），可以很容易地在多项式中找到时间（快）。

* * *

## 回答 #2

> 赞同：17
> 
> 时间：2008-09-18T00:18:30.380

你刚刚问了[百万美元的问题](http://en.wikipedia.org/wiki/P_versus_NP)。找到一条汉密尔顿路径是一个 NP 完全问题。一些 NP 难题可以使用动态规划在多项式时间内解决，但（据我所知）这不是其中之一。

* * *

## 回答 #3

> 赞同：3
> 
> 时间：2008-09-18T00:16:46.907

NP完全了。但是，如果您确实找到了一个好方法，请告诉我，我会告诉您如何致富。

* * *

## 回答 #4

> 赞同：2
> 
> 时间：2008-09-18T00:33:04.293

为最短找到更好的算法是不可能的，因为它是 NP 困难的。但是你可以尝试一些启发式方法，也许你可能想查阅你的讲义；）。

为了降低复杂性，您可以使用贪心算法找到一个短的（ish）步行。

* * *

## 回答 #5

> 赞同：2
> 
> 时间：2010-04-25T21:01:27.920

嗯..这取决于你的定义是什么。哈密​​顿路径肯定是 NP 完全的。但是，可以在 O(p^2logp) 或 O(max(c^2plogp , |E|)) 只要你的图满足狄拉克首先猜想和高见泽证明的某个条件。参见 Takamizawa (1980) “在图中寻找短闭合跨步游走的算法”。

保罗

* * *

## 回答 #6

> 赞同：1
> 
> 时间：2008-09-20T00:45:35.173

根据您正在使用的图形的生成方式，您可以通过执行贪婪路径扩展然后在卡住时进行随机边缘交换来获得针对随机实例的预期多项式时间。

这对于保证具有哈密顿游走的随机生成的相对稀疏的图非常有效。

* * *

## 回答 #7

> 赞同：1
> 
> 时间：2010-10-16T14:25:39.387

我的查询：证明在图 G 中寻找哈密顿循环的搜索问题 RHAM 是自约的搜索问题 R 是自约的，如果它是库克可约化为决策问题
`SR={ x : R(x) ≠ ∅ }`

# java - Java VM 是否在内存中移动对象，如果是，如何移动？

> ID：88852
> 
> 赞同：15
> 
> 时间：2008-09-18T00:13:57.990
> 
> 标签：java, memory-management, garbage-collection, jvm

Java 虚拟机是否曾经移动内存中的对象，如果是，它如何处理对移动对象的更新引用？

我问是因为我正在探索以分布式方式（即跨多个服务器）存储对象的想法，但出于效率原因，我需要能够在服务器之间移动对象。对象需要能够包含指向彼此的指针，甚至指向远程服务器上的对象。我正在尝试考虑更新对移动对象的引用的最佳方法。

到目前为止，我的两个想法是：

1.  在对象的生命周期内保持一个不会移动的引用间接，如果对象移动，我们会更新它。但是 - 这些间接是如何管理的？
2.  为每个对象保留一个反向引用列表，这样我们就知道如果对象被移动，必须更新什么。当然，这会产生性能开销。

我会对有关这些方法的反馈以及对替代方法的任何建议感兴趣。

* * *

## 回答 #1

> 赞同：11
> 
> 时间：2008-09-18T01:43:45.467

参考上面关于走堆的评论。

不同的 GC 有不同的方法。

通常在遍历堆时复制收集器，它们不会遍历堆中的所有对象。相反，他们在堆中遍历 LIVE 对象。这意味着如果它可以从“根”对象访问，则该对象是活动的。

因此，在这个阶段无论如何都必须接触所有活动对象，因为它将它们从旧堆复制到新堆。一旦活动对象的副本完成，旧堆中剩下的要么是已复制的对象，要么是垃圾。此时旧堆可以完全丢弃。

这种收集器的两个主要好处是它在复制阶段压缩堆，并且它只复制活对象。这对许多系统很重要，因为使用这种收集器，对象分配非常便宜，实际上只是增加一个堆指针。当 GC 发生时，不会复制任何“死”对象，因此它们不会减慢收集器的速度。事实证明，在动态系统中，临时垃圾比长期存在的垃圾要多得多。

此外，通过遍历活动对象图，您可以看到 GC 如何“了解”每个对象，并跟踪它们以在复制期间执行任何地址调整目的。

这不是深入讨论 GC 机制的论坛，因为它是一个不平凡的问题，但这是复制收集器如何工作的基础知识。

分代复制 GC 会将“较旧”的对象放在不同的堆中，并且最终收集的频率低于“较新”的堆。理论是持久的对象被提升到老年代并且被收集的越来越少，从而提高了整体 GC 性能。

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2008-09-18T00:40:29.643

您追求的关键字是“压缩垃圾收集器”。JVM 允许使用一个，这意味着可以重新定位对象。请查阅您的 JVM 手册以了解您的手册是否如此，并查看是否有任何命令行选项会影响它。

解释压缩的概念上最简单的方法是假设垃圾收集器冻结所有线程，重新定位对象，在堆和堆栈中搜索对该对象的所有引用，并使用新地址更新它们。实际上它比这更复杂，因为出于性能原因，您不希望在线程停止的情况下执行完整扫描，因此增量垃圾收集器将尽其所能为压缩做准备。

如果您对间接引用感兴趣，可以从研究 Java 中的弱引用和软引用开始，以及各种 RPC 系统使用的远程引用。

* * *

## 回答 #3

> 赞同：3
> 
> 时间：2008-09-30T06:06:39.503

我很想知道更多关于您的要求。正如另一个答案所暗示的那样，兵马俑可能正是您正在寻找的。

然而，Terracotta 提供的内容与您所要求的内容之间存在细微差别，因此我进行了调查。

不同之处在于，就您而言，Terracotta 不提供对对象的“远程”引用——事实上，在使用 Terracotta 时，完全没有 RMI、JMS 等的整个“远程”概念。

相反，在 Terracotta 中，所有对象都驻留在大型虚拟堆中。线程，无论是节点 1，还是节点 2、节点 3、节点 4 等，都可以访问虚拟堆中的任何对象。

无需学习特殊的编程或特殊的 API，“虚拟”堆中的对象与本地堆中的对象具有完全相同的行为。

简而言之，Terracotta 提供的是一个针对多个 JVM 的编程模型，其操作与针对单个 JVM 的编程模型完全相同。单独节点中的线程的行为就像单个节点中的线程一样——对象突变、同步、等待、通知在节点之间的行为与跨线程的行为完全相同——没有区别。

此外，与之前的任何解决方案不同，对象引用是跨节点维护的——这意味着您可以使用 ==。这都是在集群中维护 Java 内存模型的一部分，这是使“常规”Java（例如 POJO、同步、等待/通知）工作的基本要求（如果您不/不能保留这些都不起作用整个集群的对象身份）。

So the question comes back to you to further refine your requiements - for what purpose do you need "remote" pointers?

* * *

## 回答 #4

> 赞同：2
> 
> 时间：2008-09-18T00:27:15.820

（实际上）任何垃圾收集系统都必须在内存中移动对象以更密集地打包它们并避免碎片问题。

你正在看的是一个非常大而复杂的主题。我建议您阅读现有的远程对象样式 API：.NET 远程处理和更进一步的技术，如[CORBA](http://www.omg.org/gettingstarted/corbafaq.htm)

由于必须处理分布式系统中存在的所有故障模式，任何跟踪引用的解决方案都将变得复杂。JVM 不必担心会因为网络交换机出现故障而突然发现它看不到一半的堆。

当您深入研究设计时，我认为很多问题将归结为您希望如何处理不同的失败案例。

**回复评论：**

您的问题涉及以分布式方式存储对象，这正是 .NET 远程处理和 CORBA 解决的问题。诚然，这两种技术都不支持这些对象的迁移（AFAIK）。但它们都广泛处理对象身份的概念，这是任何分布式对象系统的关键部分：系统的不同部分如何知道他们正在谈论哪些对象。

我对 Java 垃圾收集器的细节并不太熟悉，而且我确信 Java 和 .NET 垃圾收集器有很多复杂性，以在对应用程序影响最小的情况下实现最高性能。

但是，垃圾收集的基本思想是：

*   VM 停止所有线程运行托管代码
*   它从一组已知的“根”执行可达性分析：静态变量、所有线程上的局部变量。对于它找到的每个对象，它都遵循对象内的所有引用。
*   任何未被可达性分析识别的对象都是垃圾。
*   然后可以将仍然活着的对象在内存中向下移动以密集地打包它们。这意味着对这些对象的任何引用也必须使用新地址进行更新。通过控制何时会发生垃圾收集，VM 能够保证没有对象引用“空中”（即保存在机器寄存器中）会导致问题。
*   一旦该过程完成，VM 将再次启动线程执行。

作为此过程的改进，VM 可以执行分代垃圾收集，其中根据对象的“年龄”维护单独的堆。对象从堆 0 开始，如果它们在多次 GC 中存活，则迁移到堆 1 并最终迁移到堆 2（依此类推 - .NET 仅支持 3 代）。这样做的好处是 GC 可以非常频繁地运行堆 0 集合，而不必担心做工作来证明长期存在的对象（最终在堆 2 中）仍然存在（它们几乎可以肯定是） .

还有其他改进来支持并发垃圾收集，以及在调度 GC 时实际执行非托管代码的线程的详细信息，这给该领域增加了更多的复杂性。

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2008-09-18T03:24:05.020

听起来您正在寻找分布式缓存，例如 terracotta 或 oracle 的 java 对象缓存（以前称为 tangersol）。

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2008-09-30T16:23:56.213

If you are willing to go that deep down, you can take a look to JBoss Cache architecture docs and grab some of its source code as reference.

This is not exactly what you described, but it works very similar.

Here's the link.

[http://www.jboss.org/jbosscache/](http://www.jboss.org/jbosscache/)

I hope this helps.

# java - Maven Jdepend report contains no data

> ID：88879
> 
> 赞同：3
> 
> 时间：2008-09-18T00:20:04.573
> 
> 标签：java, maven-2, maven-plugin, jdepend

I'm running the jdepend maven plugin on my project and whether I run "mvn site:site" or "mvn jdepend:generate" the report that gets generated says "There are no package used." There are no errors in the maven output. Other plugins (cobertura, findbugs, etc.) run fine. My pom is configured like this:

```
<reporting>
    <plugins>
        <plugin>
            <groupId>org.codehaus.mojo</groupId>
            <artifactId>jdepend-maven-plugin</artifactId>
        </plugin> 
```

Any ideas?

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2008-09-18T06:36:29.800

您是否尝试运行“mvn -U -cpu site:site”来更新所有 maven 依赖项？也许这个问题最好在 Maven 论坛中提出:)

# css - YUI 自动完成在 IE7 中的其他页面元素下呈现

> ID：88883
> 
> 赞同：1
> 
> 时间：2008-09-18T00:20:49.847
> 
> 标签：css, internet-explorer-7, yui, z-index

我现在正在处理一个页面，该页面有一列带有性感阴影和角落的框，以及使用[此处](http://www.schillmania.com/content/projects/even-more-rounded-corners/)的示例。我不得不承认，我并不完全理解 CSS 是如何工作的，但它*看起来*很棒。

最上面的框内是用于搜索的文本类型输入。该搜索框连接到[YUI 自动完成](http://developer.yahoo.com/yui/autocomplete/)小部件。

在 Mac 上的 Firefox3、Windows 上的 FF2、Mac 上的 Safari 中一切正常。在 WinXP 上的 IE7 中，自动完成建议呈现在圆角框下方，使除第一个框之外的所有内容都无法阅读（尽管您仍然可以在框之间看到足够多的窥视，我很满意 IE7 确实收到了不止一个建议）。

我可以从哪里着手解决问题？

FF2 在 WinXP 上的成功是这样的：

![替代文字](https://farm4.static.flickr.com/3042/2866012663_f5db805775_o.jpg)

以下是 IE7 中失败的样子：

![替代文字](https://farm4.static.flickr.com/3105/2866012677_7535c1485f_o.jpg)

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2008-12-11T06:28:27.780

杰里米，

很抱歉这么晚了，但希望答案对你未来的项目有用。

这里的问题是，只要有一个具有 position:relative 的元素，IE 就会创建一个新的堆叠顺序，这意味着 z-index 本身并不是唯一的控制因素。您可以在此处阅读有关此内容的更多信息：

[http://therealcrisp.xs4all.nl/meuk/IE-zindexbug.html](http://therealcrisp.xs4all.nl/meuk/IE-zindexbug.html)

为了解决这个问题，如果我正确理解了您的问题，请将 position:relative 应用于包装整个自动完成实现的容器（然后将 position:absolute 应用于您的结果容器）。这应该在 IE 中为那些允许它们浮动到另一个位置的元素创建一个独立的堆叠顺序：页面稍后出现的相对堆栈。

问候， 埃里克

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2009-08-26T17:13:22.157

我最终实施的工作解决方案是基于一遍又一遍地阅读[这个解释。](http://aplus.rs/lab/z-pos/)

在底层 HTML 中，所有蓝色圆角元素都是 DIV，它们都是同级元素（同一个 DIV 的所有子元素）。

自动完成 div 本身的 z-index（它是圆角容器 div 的曾曾孙）可以任意高，它不会解决这个问题，因为 IE 本质上是渲染搜索的全部内容“Vital Stats”框的全部内容下方的框，因为两者都有默认的 z-index，并且 Vital Stats稍后*在**HTML*中。

诀窍是给这些兄弟DIV（蓝色圆角容器）中的每一个递减z-index，并标记所有它们的位置：相对。所以包含搜索框的蓝色 div 是 z-index:60，“Vital Stats”框是 z-index:50，“Tags”是 z-index:40，以此类推。

因此，更一般地，找到正在重叠的元素和正在重叠的元素的共同祖先。在共同祖先的直接子代上，按照您希望内容显示的顺序应用 z-index。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2008-09-18T00:28:04.353

我并不*完全*理解导致问题的设置，但您可能想探索 YUI 自动完成对象的 useIFrame 属性——它在自动完成字段下方分层了一个 iframe 对象，它允许该字段然后浮动在对象上方在 IE 的错误布局中掩盖了它。

[http://developer.yahoo.com/yui/docs/YAHOO.widget.AutoComplete.html#property_useIFrame](http://developer.yahoo.com/yui/docs/YAHOO.widget.AutoComplete.html#property_useIFrame)

但是文档说这在 5.5 < IE < 7 中很重要，所以这可能不是您遇到的问题。同样，在不完全了解您正在使用的设置的情况下，您可能还想尝试使用自动完成字段和周围块级元素的各种[z-index值。](http://developer.mozilla.org/en/Understanding_CSS_z-index)

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2008-09-18T00:34:46.270

确保自动完成 div 的 z-index 比构成圆角框的 div 大。我相信微软将顶部元素的 z-index 设置为 20000 或 100000。这样做可能是明智的。

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2009-02-18T00:05:31.010

我有一个类似的问题，我基本上只是通过更改不同 div 的 z-index 来修复它。只需按照应该显示的顺序为每个 div 设置更高的数字。

# .net - "Error Creating Window Handle"

> ID：88904
> 
> 赞同：36
> 
> 时间：2008-09-18T00:26:30.033
> 
> 标签：.net, winforms, handles

We're working on a very large .NET WinForms composite application - not CAB, but a similar home grown framework. We're running in a Citrix and RDP environment running on Windows Server 2003\.

We're starting to run into random and difficult to reproduct "Error creating window handle" error that seems to be an old fashion handle leak in our application. We're making heavy use of 3rd Party controls (Janus GridEX, Infralution VirtualTree, and .NET Magic docking) and we do a lot of dynamic loading and rendering of content based on metadata in our database.

There's a lot of info on Google about this error, but not a lot of solid guidance about how to avoid issues in this area.

Does the stackoverflow community have any good guidance for me for building handle-friendly winforms apps?

* * *

## 回答 #1

> 赞同：33
> 
> 时间：2008-09-18T00:44:28.510

我已经找到了很多关于 UI 没有按预期在 WinForms 中卸载的问题。

以下是一些一般性提示：

*   很多时候，控件将继续使用，因为控件事件未正确删除（工具提示提供程序在这里给我们造成了非常大的问题）或控件未正确处理。
*   在所有模态对话框周围使用“使用”块以确保它们被释放
*   有一些控件属性会在必要之前强制创建窗口句柄（例如设置 TextBox 控件的 ReadOnly 属性将强制实现控件）
*   使用[.Net Memory profiler](http://memprofiler.com/Default.aspx)之类的工具来获取创建的类的计数。此工具的较新版本还将跟踪 GDI 和 USER 对象。
*   尽量减少使用 Win API 调用（或其他 DllImport 调用）。如果您确实需要使用互操作，请尝试以使 using/Dispose 模式正常工作的方式包装这些调用。

* * *

## 回答 #2

> 赞同：11
> 
> 时间：2016-10-25T05:30:26.430

# 了解此错误

突破 Windows 的限制：USER 和 GDI 对象——Mark Russinovich 第 1 部分： [https ://blogs.technet.microsoft.com/markrussinovich/2010/02/24/pushing-the-limits-of-windows-user-and -gdi-objects-part-1/](https://blogs.technet.microsoft.com/markrussinovich/2010/02/24/pushing-the-limits-of-windows-user-and-gdi-objects-part-1/)

# 解决此错误

您需要能够重现该问题。这是记录执行该步骤的一种方法[https://stackoverflow.com/a/30525957/495455](https://stackoverflow.com/a/30525957/495455)。

找出造成这么多句柄的最简单方法是打开 TaskMgr.exe。在 TaskMgr.exe 中，您需要使 USER Object、GDI Object 和 Handles 列可见，如图所示，为此选择 View Menu > Select Columns：

[![在此处输入图像描述](https://i.stack.imgur.com/LzZDm.png)](https://i.stack.imgur.com/LzZDm.png)

完成导致问题的步骤并观察用户对象计数增加到大约 10,000 或 GDI 对象或句柄达到其限制。

当您看到对象或句柄增加（通常显着）时，您可以通过单击暂停按钮来停止 Visual Studio 中的代码执行。

然后只需按住 F10 或 F11 即可浏览代码，观察对象/句柄计数何时急剧增加。

到目前为止我发现的最好的工具是来自 NirSoft 的 GDIView，它分解了 GDI 句柄字段：

[![在此处输入图像描述](https://i.stack.imgur.com/XgUIs.png)](https://i.stack.imgur.com/XgUIs.png)

我将其追踪到设置 DataGridViews“Filter Combobox”列位置和宽度时使用的代码：

```
If Me.Controls.ContainsKey(comboName) Then
    cbo = CType(Me.Controls(comboName), ComboBox)
    With cbo
        .Location = New System.Drawing.Point(cumulativeWidth, 0)
        .Width = Me.Columns(i).Width
    End With
    'Explicitly cleaning up fixed the issue of releasing USER objects.
    cbo.Dispose()
    cbo = Nothing  
End If 
```

在我的情况下（上图），解决方案是**明确地处理**和清理解决了释放 USER 对象的问题。

这是堆栈跟踪：

> 在 System.Windows.Forms.Control.CreateHandle() 在 System.Windows.Forms.ComboBox.CreateHandle() 在 System.Windows.Forms.Control.get_Handle() 在 System.Windows.Forms.ComboBox.InvalidateEverything() 在 System .Windows.Forms.ComboBox.OnResize(EventArgs e) 在 System.Windows.Forms.Control.OnSizeChanged(EventArgs e) 在 System.Windows.Forms.Control.UpdateBounds(Int32 x, Int32 y, Int32 宽度, Int32 高度, Int32 clientWidth, Int32 clientHeight) 在 System.Windows.Forms.Control.UpdateBounds(Int32 x, Int32 y, Int32 width, Int32 height) 在 System.Windows.Forms.Control.SetBoundsCore(Int32 x, Int32 y, Int32 width, Int32 height) , BoundsSpecified 指定) 在 System.Windows.Forms.ComboBox.SetBoundsCore(Int32 x, Int32 y, Int32 宽度, Int32 高度, BoundsSpecified 指定) 在 System.Windows.Forms.Control.SetBounds(Int32 x, Int32 y,Int32 宽度，Int32 高度，BoundsSpecified 指定）在 System.Windows.Forms.Control.set_Width（Int32 值）

[以下是Fabrice](https://weblogs.asp.net/fmarguerie/cannot-create-window-handle-desktop-heap)的一篇有用文章的症结所在，该文章帮助我解决了限制：

**“创建窗口句柄时出错”**
当我正在为客户端开发的大型 Windows 窗体应用程序被积极使用时，用户经常会收到“创建窗口句柄时出错”异常。

除了应用程序消耗过多资源（这是我们已经在解决的一个单独的问题）这一事实之外，我们还难以确定哪些资源正在耗尽以及这些资源的限制是什么。我们首先考虑关注 Windows 任务管理器中的 Handles 计数器。那是因为我们注意到某些进程倾向于消耗比正常情况下更多的这些资源。然而，这个计数器并不是一个好的计数器，因为它会跟踪文件、套接字、进程和线程等资源。这些资源被命名为内核对象。

我们应该关注的其他类型的资源是 GDI 对象和用户对象。您可以在 MSDN 上获得这三类资源的概览。

**用户对象**
窗口创建问题与用户对象直接相关。

我们试图确定应用程序可以使用的用户对象的限制。每个进程有 10,000 个用户句柄的配额。这个值可以在注册表中更改，但是在我们的例子中，这个限制并不是真正的阻碍。另一个限制是每个 Windows 会话 66,536 个用户句柄。这个限制是理论上的。在实践中，您会注意到它无法到达。在我们的例子中，在当前会话中的用户对象总数达到 11,000 个之前，我们遇到了可怕的“创建窗口句柄时出错”异常。

**桌面堆**
然后我们发现了真正的罪魁祸首：它是“桌面堆”。默认情况下，交互式用户会话的所有图形应用程序都在所谓的“桌面”中执行。分配给此类桌面的资源是有限的（但可配置）。

注意：用户对象消耗了桌面堆的大部分内存空间。这包括窗户。关于Desktop Heap的更多信息，可以参考NTDebugging MSDN博客上发表的非常好的文章：

**真正的解决方案是什么？变绿！**
增加桌面堆是一种有效的解决方案，但这不是最终的解决方案。真正的解决方案是消耗更少的资源（在我们的例子中是更少的窗口句柄）。我可以猜到你对这个解决方案有多失望。这真的是我能想到的全部吗？好吧，这里没有什么大秘密。唯一的出路就是瘦。拥有不太复杂的 UI 是一个好的开始。这对资源有好处，对可用性也有好处。下一步是避免浪费，保护资源并回收利用！

以下是我们如何在我的客户的应用程序中执行此操作：

我们使用 TabControls 并动态创建每个选项卡的内容，当它变得可见时；我们使用可展开/可折叠的区域，并且仅在需要时再次用控件和数据填充它们；我们尽快释放资源（使用 Dispose 方法）。当一个区域被折叠时，可以清除它的子控件。选项卡隐藏时也是如此；我们使用 MVP 设计模式，这有助于实现上述目标，因为它将数据与视图分开；我们使用布局引擎、标准的 FlowLayoutPanel 和 TableLayoutPanel 或自定义引擎，而不是创建嵌套面板、GroupBoxes 和拆分器的深层层次结构（一个空的拆分器本身会消耗三个窗口句柄......）。如果您需要构建丰富的 Windows 窗体屏幕，以上只是提示您可以做什么。那里' 毫无疑问，您可以找到其他方法。在我看来，您应该做的第一件事是围绕用例和场景构建应用程序。这有助于仅显示给定时间和给定用户所需的内容。

当然，另一种解决方案是使用不依赖句柄的系统...... WPF 有人吗？

* * *

## 回答 #3

> 赞同：9
> 
> 时间：2016-12-10T21:22:23.917

当我将 NativeWindow 子类化并手动调用 CreateHandler 时，我遇到了这个错误。问题是我忘记在覆盖的 WndProc 版本中添加 base.WndProc(m)。它导致了同样的错误

* * *

## 回答 #4

> 赞同：5
> 
> 时间：2012-01-13T07:12:31.410

我遇到了这个异常，因为无限循环创建了新的 UI 控件并设置了它的属性。循环多次后，更改控件可见属性时抛出此异常。我发现用户对象和 GDI 对象（来自任务管理器）都很大。

我想您的问题与这些 UI 控件耗尽系统资源的原因类似。

* * *

## 回答 #5

> 赞同：4
> 
> 时间：2008-09-18T00:47:39.953

我在工作中使用 Janus Controls。就处置自己而言，它们非常有问题。我建议您确保正确处理它们。此外，与它们的绑定有时不会释放，因此您必须手动取消绑定对象以释放控件。

* * *

## 回答 #6

> 赞同：3
> 
> 时间：2016-09-03T05:51:08.860

我在向面板中添加控件时遇到了这个异常，因为面板中的子控件没有被清除。如果在面板中处理子控件，则修复错误。

```
For k = 1 To Panel.Controls.Count
    Panel.Controls.Item(0).Dispose()
Next 
```

* * *

## 回答 #7

> 赞同：0
> 
> 时间：2016-09-23T20:58:23.427

我遇到了相同的 .Net 运行时错误，但我的解决方案不同。

**我的场景：** 从返回 DialogResult 的弹出对话框中，用户将单击一个按钮来发送电子邮件消息。我添加了一个线程，因此在后台生成报告时 UI 不会锁定。这种情况最终得到了那个不寻常的错误消息。

**导致问题的代码：** 此代码的问题是线程立即启动并返回，这导致返回的 DialogResult 会在线程可以正确地从字段中获取值之前处理对话框。

```
private void Dialog_SendEmailSummary_Button_Click(object sender, EventArgs e)
{
    SendSummaryEmail();
    DialogResult = DialogResult.OK;
}

private void SendSummaryEmail()
{
    var t = new Thread(() => SendSummaryThread(Textbox_Subject.Text, Textbox_Body.Text, Checkbox_IncludeDetails.Checked));
    t.Start();
}

private void SendSummaryThread(string subject, string comment, bool includeTestNames)
{
    // ... Create and send the email.
} 
```

**这种情况** 的修复：修复是在将值传递给创建线程的方法之前获取并存储这些值。

```
private void Dialog_SendEmailSummary_Button_Click(object sender, EventArgs e)
{
    SendSummaryEmail(Textbox_Subject.Text, Textbox_Body.Text, Checkbox_IncludeDetails.Checked);
    DialogResult = DialogResult.OK;
}

private void SendSummaryEmail(string subject, string comment, bool includeTestNames)
{
    var t = new Thread(() => SendSummaryThread(subject, comment, includeTestNames));
    t.Start();
}

private void SendSummaryThread(string subject, string comment, bool includeTestNames)
{
    // ... Create and send the email.
} 
```

* * *

## 回答 #8

> 赞同：0
> 
> 时间：2019-05-01T18:36:57.553

当我开始在我的 WinForm 应用程序中使用线程时发生了同样的错误，我使用堆栈跟踪来查找引发错误的原因，并发现基础设施的 UltraDesktopAlert 组件在这背后，所以我以不同的方式调用它，错误现在消失了。

```
 this.Invoke((MethodInvoker)delegate
{
    //call your method here
}); 
```

完整的代码将如下所示。

```
private void ultraButton1_Click(object sender, EventArgs e)
{
    Task.Factory.StartNew(() => myMethod1());
}

void myMethod1()
{
    //my logic

    this.Invoke((MethodInvoker)delegate
    {
        ultraDesktopAlert1.Show($"my message header", "my message");
    });

    //my logic
} 
```

我也无法使用 GDI 实用程序来查找我的应用程序创建了多少句柄，但我的应用程序（64 位）在其列表中不可用。另一种解决方案是将桌面堆值更改`SharedSection=1024,20480,768`为以下位置 HKEY

```
Computer\HKEY_LOCAL_MACHINE\SYSTEM\CurrentControlSet\Control\Session Manager\SubSystems 
```

但我的已经具有相同的值。只有调用方法委托对我有用。希望这有帮助。

* * *

## 回答 #9

> 赞同：0
> 
> 时间：2020-09-23T14:56:01.957

就我而言，我是压倒一切`WndProc(ref Message m)`但没有打电话`base.WndProc(ref m)`；

# php - Zend Framework - ErrorHandler 似乎没有按预期工作

> ID：88918
> 
> 赞同：4
> 
> 时间：2008-09-18T00:30:04.550
> 
> 标签：php, zend-framework

这是我第一次使用 Zend 框架。我正在尝试遵循[快速入门](http://framework.zend.com/docs/quickstart/introduction)教程。在我到达[Error Controller 和 View](http://framework.zend.com/docs/quickstart/create-an-error-controller-and-view)部分之前，一切都按预期工作。当我导航到一个不存在的页面时，我没有收到错误页面，而是得到了致命错误屏幕转储（这很荣耀）：

> 致命错误：在 /home/.fantasia/bcnewman/foo.com/library/Zend/Controller/Dispatcher/Standard.php:249 堆栈跟踪：#0 / home/.fantasia/bcnewman/foo.com/library/Zend/Controller/Front.php(946): Zend_Controller_Dispatcher_Standard->dispatch(Object(Zend_Controller_Request_Http), Object(Zend_Controller_Response_Http)) #1 /home/.fantasia/bcnewman/foo .com/public/index.php(42): Zend_Controller_Front->dispatch() #2 {main} 在 /home/.fantasia/bcnewman/foo.com/library/Zend/Controller/Dispatcher/Standard.php 上线249

我不相信这是由我的语法错误引起的（从教程中复制并粘贴了示例文件的内容），我相信我的应用程序目录结构是正确的：

```
./application
./application/controllers
./application/controllers/IndexController.php
./application/controllers/ErrorHandler.php
./application/views
./application/views/scripts
./application/views/scripts/index
./application/views/scripts/index/index.phtml
./application/views/scripts/error
./application/views/scripts/error/error.phtml
./application/bootstrap.php
./public
./public/index.php 
```

最后，`IndexController`and`index.phtml`视图确实有效。

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2008-09-18T02:44:37.143

你有ErrorHandler.php。它应该是 ErrorController.php。控制器都需要按照 NameController.php 的格式命名。由于您没有正确命名它，调度程序无法找到它。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2008-09-18T02:00:31.290

假设您已将 ErrorController 插件加载到前端控制器中，请确保在引导程序中您没有以下设置：

```
$frontController->throwExceptions(true); 
```

如果设置了此项，则将*始终*抛出异常，无论您是否设置了错误控制器。

# gdb - 什么是启发式栅栏？

> ID：88923
> 
> 赞同：5
> 
> 时间：2008-09-18T00:31:54.873
> 
> 标签：gdb

为什么 gdb 似乎“命中”了它？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2008-09-18T00:36:50.650

根据[this page](http://www.delorie.com/gnu/docs/gdb/gdb_179.html)，GDB正在目标代码中向后搜索以查找函数的开头，并且达到了强制限制。如果您可以将栅栏柱限制设置为 0 或增加它，您可能会避免错误，但运行时间会更长。

# git - 使用 git grep 通过文件的先前版本？

> ID：88929
> 
> 赞同：29
> 
> 时间：2008-09-18T00:34:23.963
> 
> 标签：git

是否有一个命令可以让我检查该字符串`"xyz"`是否曾经在`foo.c`存储库中的文件中并打印它们在哪些修订中找到？

* * *

## 回答 #1

> 赞同：39
> 
> 时间：2008-09-18T00:46:52.013

这将打印 diff 包含 xyz 的任何提交

```
git log -Sxyz foo.c 
```

* * *

## 回答 #2

> 赞同：7
> 
> 时间：2018-07-23T20:15:53.077

这将打印 diff 包含 xyz 的任何提交。请注意将`--`文件名与命令的其余部分分开。

```
git log -Sxyz -- foo.c 
```

没有`--`，我得到这个错误：

```
fatal: ambiguous argument 'foo.c': unknown revision or path not in the working tree.
Use '--' to separate paths from revisions, like this:
'git <command> [<revision>...] -- [<file>...]' 
```

我原本想评论[CaptainPicard的答案](https://stackoverflow.com/a/89008/9020923)以添加更正，但我还没有足够的声誉。如果有人想编辑该答案以提及此更正，我将很乐意记下此答案。

# vim - lining up function parameter lists with vim

> ID：88931
> 
> 赞同：13
> 
> 时间：2008-09-18T00:34:39.203
> 
> 标签：vim, editor, whitespace

When defining or calling functions with enough arguments to span multiple lines, I want vim to line them up. For example,

```
def myfunction(arg1, arg2, arg, ...
               argsN-1, argN) 
```

The idea is for argsN-1 to have its 'a' lined up with args1.

Does anyone have a way to have this happen automatically in vim? I've seen the align plugin for lining equal signs (in assignment statements) and such, but I'm not sure if it can be made to solve this problem?

* * *

## 回答 #1

> 赞同：11
> 
> 时间：2008-09-18T01:23:48.993

以前的海报有，但是忘记了`set`

```
:set cino=(0<Enter> 
```

从`:help cinoptions-values`

```
The 'cinoptions' option sets how Vim performs indentation.  In the list below,
"N" represents a number of your choice (the number can be negative).  When
there is an 's' after the number, Vim multiplies the number by 'shiftwidth':
"1s" is 'shiftwidth', "2s" is two times 'shiftwidth', etc.  You can use a
decimal point, too: "-0.5s" is minus half a 'shiftwidth'.  The examples below
assume a 'shiftwidth' of 4.

...

    (N    When in unclosed parentheses, indent N characters from the line
          with the unclosed parentheses.  Add a 'shiftwidth' for every
          unclosed parentheses.  When N is 0 or the unclosed parentheses
          is the first non-white character in its line, line up with the
          next non-white character after the unclosed parentheses.
          (default 'shiftwidth' * 2).

            cino=                     cino=(0 >
              if (c1 && (c2 ||          if (c1 && (c2 ||
                          c3))                     c3))
                  foo;                      foo;
              if (c1 &&                 if (c1 &&
                      (c2 || c3))           (c2 || c3))
                 {                         { 
```

* * *

## 回答 #2

> 赞同：7
> 
> 时间：2008-09-18T01:12:12.623

我相信你必须发出命令：

```
:set cino=(0 
```

这当然是在使用 cindent 的时候。

编辑：我错过了“设置”

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2008-09-18T14:27:43.507

试试 Align [http://www.vim.org/scripts/script.php?script_id=294](http://www.vim.org/scripts/script.php?script_id=294)和 AutoAlign [http://www.vim.org/scripts/script.php?script_id=884](http://www.vim.org/scripts/script.php?script_id=884)脚本。

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2008-09-18T22:11:04.703

使用特定于语言的外部工具作为 Vim 过滤器可能会获得一些好处。例如，如果你可以编写一个[Perltidy](http://perltidy.sf.net)配置文件来生成你想要的格式（看起来你想要**-lp -vtc=2**标志），然后你可以通过它来管道你现有的 Vim 缓冲区

```
:!/path/to/tidy -config /path/to/configfile 
```

如果你要经常运行这种命令，你可以通过在你的 .vimrc 中加入如下内容来定义一个命令：

```
command -range=% Tidy <line1>,<line2>!/path/to/tidy -config /path/to/configfile 
```

# python - 为什么 PEP-8 指定最大行长度为 79 个字符？

> ID：88942
> 
> 赞同：279
> 
> 时间：2008-09-18T00:36:24.520
> 
> 标签：python, coding-style, pep8

为什么在这个千年里 Python [PEP-8](http://www.python.org/dev/peps/pep-0008/)应该指定[最大行长度](https://www.python.org/dev/peps/pep-0008/#maximum-line-length)为 79 个字符？

几乎所有的代码编辑器都可以处理更长的行。如何包装应该是内容消费者的选择，而不是内容创建者的责任。

在这个时代坚持 79 个字符是否有任何（合法的）充分理由？

* * *

## 回答 #1

> 赞同：155
> 
> 时间：2010-05-08T09:29:40.410

PEP-8 的大部分价值在于阻止人们争论无关紧要的格式规则，并继续编写良好的、格式一致的代码。当然，没有人真的认为 79 是最佳的，但是将其更改为 99 或 119 或任何您喜欢的线长都没有明显的好处。我认为选择是这样的：遵循规则并找到一个值得争取的理由，或者提供一些数据来证明可读性和生产力如何随行长而变化。后者将非常有趣，并且我认为很有可能改变人们的想法。

* * *

## 回答 #2

> 赞同：120
> 
> 时间：2008-09-18T00:37:11.117

保持您的代码人类可读，而不仅仅是机器可读。许多设备一次只能显示 80 个字符。此外，通过能够将多个窗口并排设置，使屏幕较大的人更容易进行多任务处理。

可读性也是强制行缩进的原因之一。

* * *

## 回答 #3

> 赞同：55
> 
> 时间：2008-09-18T00:44:24.827

我是一名每天必须处理大量代码的程序员。开源和内部开发的内容。

作为一名程序员，我发现一次打开许多源文件很有用，并且经常在我的（宽屏）显示器上组织我的桌面，以便两个源文件并排放置。我可能会同时在两者中进行编程，或者只是阅读其中一种并在另一种中进行编程。

当其中一个源文件的宽度大于 120 个字符时，我感到不满意和沮丧，因为这意味着我不能在一行屏幕上轻松地放置一行代码。它打乱了换行的格式。

我说“120”，因为这是我对代码宽的程度感到恼火的程度。在这么多字符之后，为了便于阅读，您应该跨行拆分，更不用说编码标准了。

我在编写代码时考虑了 80 列。这只是为了当我确实泄漏到那个边界时，这并不是一件坏事。

* * *

## 回答 #4

> 赞同：40
> 
> 时间：2008-09-18T01:53:00.340

我相信那些学习排版的人会告诉你，每行 66 个字符应该是最可读的长度宽度。即便如此，如果您需要通过 ssh 会话远程调试机器，大多数终端默认为 80 个字符，79 个字符刚好合适，在这种情况下尝试使用更广泛的字符会变得非常痛苦。您还会对使用 vim + screen 作为日常环境的开发人员数量感到惊讶。

* * *

## 回答 #5

> 赞同：20
> 
> 时间：2008-09-18T00:47:09.017

以默认大小打印等宽字体（在 A4 纸上）为 80 列 x 66 行。

* * *

## 回答 #6

> 赞同：14
> 
> 时间：2009-05-16T15:16:18.040

这就是我喜欢 80 个字符的原因：在工作中，我使用 Vim 并在一个运行在 1680x1040 的监视器上一次处理两个文件（我想不起来了）。如果这些行不再存在，即使使用自动换行，我也无法读取文件。不用说，我讨厌处理其他人的代码，因为他们喜欢排长队。

* * *

## 回答 #7

> 赞同：6
> 
> 时间：2008-09-18T00:39:19.427

由于空格在 Python 中具有语义含义，因此某些自动换行方法可能会产生不正确或模棱两可的结果，因此需要有一些限制来避免这些情况。自从我们使用电传打字机以来，标准的行长为 80 个字符，因此 79 个字符似乎是一个相当安全的选择。

* * *

## 回答 #8

> 赞同：3
> 
> 时间：2008-09-18T00:40:22.153

我同意贾斯汀的观点。详细地说，过长的代码行更难被人类阅读，有些人的控制台宽度可能每行只能容纳 80 个字符。

样式推荐是为了确保您编写的代码可以在尽可能多的平台上被尽可能多的人阅读，并且尽可能舒适。

* * *

## 回答 #9

> 赞同：-3
> 
> 时间：2009-04-19T10:11:14.857

因为如果你把它推到第 80 列之后，这意味着要么你正在编写一个非常长且复杂的代码行，而且做得太多（所以你应该重构），或者你缩进太多（所以你应该重构）。

# c# - 是否有任何理由不将 pdb 与您的应用程序一起提供？

> ID：88950
> 
> 赞同：7
> 
> 时间：2008-09-18T00:37:26.327
> 
> 标签：c#, .net

由于您可以使用反射器对 .Net 应用程序进行逆向工程，因此是否有任何理由不将 pdb 文件与应用程序一起提供？如果您确实将它们与它一起发布，那么您的堆栈跟踪将包含问题所在的行号，这在它崩溃时很有用。

请为每条评论输入 1 个投票理由。

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2009-06-23T12:28:28.813

运送 pdb 不会给用户带来任何额外的便利。因此，没有理由将 pdb 文件与应用程序一起发送。除了 pdb 文件通常有很大的大小。

您应该使用本地 Microsoft 符号服务器来快速访问与错误报告对应的 pdb 文件，而不是发送 pdb 文件。[在这里](http://msdn.microsoft.com/en-us/library/ms681417(VS.85).aspx)您可以找到如何使用符号服务器的详细说明。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2008-09-18T01:42:02.303

大多数人都想发布一个优化的版本。但是，如果您发布带有优化构建的 pdb，则您获得的源代码行号可能会关闭。

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2008-09-18T00:38:05.000

将 PDB 与您的应用程序一起提供可以更轻松地进行逆向工程，因为它包含局部变量/对象名称、函数原型等。

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2008-09-18T00:48:12.073

反射器可以获得 .NET 应用程序的 MSIL 代码的高级版本，但这并不意味着它一定是可用/可破解的......如果没有私有名称，很多代码对于随意阅读是没有意义的变量和函数以及 .NET Reflector 在没有 PDB 文件的情况下无法访问的其他内容。

显然，如果您使用任何体面的混淆器（我个人喜欢 {smartassembly}，但因为它缺乏交叉混淆），那么您将失去其所有保护，只是为了增加行号的价值，这不是一个非常公平的权衡。

无论如何，行号被高估了！

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2008-09-18T00:42:31.587

你为什么要运送超出你需要的东西？

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2008-09-18T00:43:44.267

除了它们在任何严肃的项目中都非常沉重的事实之外？不，如果您不介意人们对您的软件进行逆向工程，那是没有理由的。

# c++ - 初始化对象时 {0} 是什么意思？

> ID：88957
> 
> 赞同：259
> 
> 时间：2008-09-18T00:38:36.153
> 
> 标签：c++, c

什么时候`{0}`用来初始化一个对象，是什么意思？我在任何地方都找不到任何引用`{0}`，并且由于花括号，Google 搜索没有帮助。

示例代码：

```
SHELLEXECUTEINFO sexi = {0}; // what does this do?
sexi.cbSize = sizeof(SHELLEXECUTEINFO);
sexi.hwnd = NULL;
sexi.fMask = SEE_MASK_NOCLOSEPROCESS;
sexi.lpFile = lpFile.c_str();
sexi.lpParameters = args;
sexi.nShow = nShow;

if(ShellExecuteEx(&sexi))
{
    DWORD wait = WaitForSingleObject(sexi.hProcess, INFINITE);
    if(wait == WAIT_OBJECT_0)
        GetExitCodeProcess(sexi.hProcess, &returnCode);
} 
```

没有它，上面的代码将在运行时崩溃。

* * *

## 回答 #1

> 赞同：311
> 
> 时间：2008-09-18T00:39:34.043

这里发生的事情称为**聚合**初始化。这是 ISO 规范第 8.5.1 节中聚合的（缩写）定义：

> 聚合是没有用户声明的构造函数、没有私有或受保护的非静态数据成员、没有基类和虚函数的数组或类。

现在，`{0}`像这样初始化一个聚合基本上是`0`整个事情的一个技巧。这是因为在使用聚合初始化时，**您不必指定所有成员**，并且规范要求默认初始化所有未指定的成员，这意味着设置`0`为简单类型。

以下是规范中的相关报价：

> 如果列表中的初始化器少于聚合中的成员，则每个未显式初始化的成员都应默认初始化。例子：
> 
> ```
> struct S { int a; char* b; int c; };
> S ss = { 1, "asdf" }; 
> ```
> 
> `ss.a`使用、 和形式 的表达式的值进行初始化`1`，即 .`ss.b``"asdf"``ss.c``int()``0`

[您可以在此处](http://www.open-std.org/jtc1/sc22/wg21/docs/papers/2012/n3337.pdf#page=207)找到有关此主题的完整规范

* * *

## 回答 #2

> 赞同：91
> 
> 时间：2008-09-18T02:25:34.117

需要注意的一件事是，这种技术不会将填充字节设置为零。例如：

```
struct foo
{
    char c;
    int  i;
};

foo a = {0}; 
```

不一样：

```
foo a;
memset(&a,0,sizeof(a)); 
```

在第一种情况下，c 和 i 之间的填充字节未初始化。你为什么要关心？好吧，如果您将此数据保存到磁盘或通过网络或其他方式发送，您可能会遇到安全问题。

* * *

## 回答 #3

> 赞同：20
> 
> 时间：2008-09-30T15:37:18.227

请注意，空的聚合初始化器也可以工作：

```
SHELLEXECUTEINFO sexi = {};
char mytext[100] = {}; 
```

* * *

## 回答 #4

> 赞同：11
> 
> 时间：2009-04-09T13:17:24.820

回答为什么`ShellExecuteEx()`会崩溃：你的`SHELLEXECUTEINFO`“sexi”结构有很多成员，你只是初始化其中的一些。

例如，该成员`sexi.lpDirectory`可能指向任何地方，但`ShellExecuteEx()`仍会尝试使用它，因此您将遇到内存访问冲突。

当您包含该行时：

```
SHELLEXECUTEINFO sexi = {0}; 
```

在进行结构设置的其余部分之前，您要告诉编译器在初始化您感兴趣的特定成员之前将**所有**`ShellExecuteEx()`结构成员清零。知道如果`sexi.lpDirectory`为零，它应该忽略它。

* * *

## 回答 #5

> 赞同：9
> 
> 时间：2014-09-05T20:21:39.440

`{0}`是 C 和 C++ 中任何（完整对象）类型的有效初始化程序。*这是用于将对象初始化为零*的常用习语（继续阅读以了解其含义）。

对于标量类型（算术和指针类型），大括号是不必要的，但它们是明确允许的。引用 ISO C 标准的[N1570 草案](http://www.open-std.org/jtc1/sc22/wg14/www/docs/n1570.pdf)，第 6.7.9 节：

> 标量的初始值设定项应为单个表达式，可选择用大括号括起来。

它将对象初始化为零（`0`对于整数，`0.0`对于浮点，对于指针的空指针）。

对于非标量类型（结构、数组、联合），`{0}`指定对象的*第一个*元素初始化为零。对于包含结构、结构数组等的结构，这是递归应用的，因此第一个标量元素根据类型设置为零。与任何初始化程序一样，任何未指定的元素都设置为零。

中间大括号 ( `{`, `}`) 可以省略；例如，这两个都是有效且等效的：

```
int arr[2][2] = { { 1, 2 }, {3, 4} };

int arr[2][2] = { 1, 2, 3, 4 }; 
```

这就是为什么您不必编写例如`{ { 0 } }`第一个元素是非标量的类型的原因。

所以这：

```
some_type obj = { 0 }; 
```

是初始化`obj`为零的简写方式，这意味着如果它是整数，如果它是浮点，则将每个标量子对象`obj`设置为，或者如果它是指针，则设置为空指针。`0``0.0`

规则与 C++ 类似。

在您的特定情况下，由于您正在为`sexi.cbSize`等等分配值，因此很明显这`SHELLEXECUTEINFO`是一个结构或类类型（或者可能是一个联合，但可能不是），所以并非所有这些都适用，但正如我所说`{ 0 }`的是一个常见的可以在更一般的情况下使用的成语。

这*并不*（不一定）等同于使用`memset`将对象的表示设置为全位为零。浮点`0.0`和空指针都不一定表示为全位为零，并且`{ 0 }`初始化程序不一定将填充字节设置为任何特定值。但是，在大多数系统上，它可能会产生相同的效果。

* * *

## 回答 #6

> 赞同：7
> 
> 时间：2008-09-18T01:05:58.927

我也用它来初始化字符串，例如。

```
char mytext[100] = {0}; 
```

* * *

## 回答 #7

> 赞同：3
> 
> 时间：2008-09-18T00:42:55.393

自从我在 c/c++ 中工作以来已经有一段时间了，但是 IIRC，同样的快捷方式也可以用于数组。

* * *

## 回答 #8

> 赞同：2
> 
> 时间：2013-05-14T03:23:23.673

我一直想知道，**为什么**你应该使用类似的东西

```
struct foo bar = { 0 }; 
```

这是一个测试用例来解释：

检查.c

```
struct f {
    int x;
    char a;
} my_zero_struct;

int main(void)
{
    return my_zero_struct.x;
} 
```

我使用编译`gcc -O2 -o check check.c`然后输出符号表`readelf -s check | sort -k 2`（这是在 x64 系统上的 ubuntu 12.04.2 上使用 gcc 4.6.3）。摘抄：

```
59: 0000000000601018     0 NOTYPE  GLOBAL DEFAULT  ABS __bss_start
48: 0000000000601018     0 NOTYPE  GLOBAL DEFAULT  ABS _edata
25: 0000000000601018     0 SECTION LOCAL  DEFAULT   25 
33: 0000000000601018     1 OBJECT  LOCAL  DEFAULT   25 completed.6531
34: 0000000000601020     8 OBJECT  LOCAL  DEFAULT   25 dtor_idx.6533
62: 0000000000601028     8 OBJECT  GLOBAL DEFAULT   25 my_zero_struct
57: 0000000000601030     0 NOTYPE  GLOBAL DEFAULT  ABS _end 
```

这里重要的部分是，`my_zero_struct`在`__bss_start`. C 程序中的“.bss”部分是在调用**之前设置为零的内存部分，请参见** [.bss 上的维基百科](http://en.wikipedia.org/wiki/.bss)。`main`

如果将上面的代码更改为：

```
} my_zero_struct = { 0 }; 
```

然后生成的“检查”可执行文件至少与 ubuntu 12.04.2 上的 gcc 4.6.3 编译器看起来**完全相同；**`my_zero_struct`仍在该部分中，因此在调用`.bss`之前它将自动初始化为零。`main`

注释中的提示，`memset`可能初始化“完整”结构也不是一种改进，因为该`.bss`部分被完全清除，这也意味着“完整”结构设置为零。

**可能**是C 语言标准没有提及这些，但在现实世界的 C 编译器中，我从未见过不同的行为。

* * *

## 回答 #9

> 赞同：0
> 
> 时间：2020-06-22T13:45:06.323

将整个结构初始化为空/零/空值是语法糖。

**长版**

```
SHELLEXECUTEINFO sexi;
sexi.cbSize = 0;
sexi.fMask = 0;
sexi.hwnd = NULL;
sexi.lpVerb = NULL;
sexi.lpFile = NULL;
sexi.lpParameters = NULL;
sexi.lpDirectory = NULL;
sexi.nShow = nShow;
sexi.hInstApp = 0;
sexi.lpIDList = NULL;
sexi.lpClass = NULL;
sexi.hkeyClass = 0;
sexi.dwHotKey = 0;
sexi.hMonitor = 0;
sexi.hProcess = 0; 
```

**简洁版本**

```
SHELLEXECUTEINFO sexi = {0}; 
```

那不是更容易吗？

这也很好，因为：

*   您不必寻找每个成员并对其进行初始化
*   您不必担心以后添加新成员时可能不会初始化它们
*   你不必[打电话`ZeroMemory`](https://devblogs.microsoft.com/oldnewthing/20050628-07/?p=35183)

* * *

## 回答 #10

> 赞同：-5
> 
> 时间：2014-09-05T19:49:36.633

{0} 是一个**匿名数组**，其元素为 0。

这用于将**数组的一个或所有元素初始化为 0。**

例如 int arr[8] = {0};

在这种情况下， arr 的所有元素都将被初始化为 0。

# database - 防止不良数据输入

> ID：88962
> 
> 赞同：4
> 
> 时间：2008-09-18T00:39:52.047
> 
> 标签：database, postgresql, web-applications

将数据验证完全委托给数据库引擎约束是一种好习惯吗？

验证来自应用程序的数据并不能防止来自另一个软件的无效插入（可能由另一个团队用另一种语言编写）。使用数据库约束可以减少需要担心无效输入数据的点。

如果你把验证同时放在数据库和应用程序中，维护变得很无聊，因为你必须为谁知道有多少应用程序更新代码，增加了人为错误的可能性。

从自由软件项目中查看代码，我只是看不到这样做太多。

* * *

## 回答 #1

> 赞同：11
> 
> 时间：2008-09-18T00:43:18.870

在输入时验证。在将其放入数据库之前再次验证。并具有数据库约束以防止错误输入。尽管如此，您可以打赌，不良数据仍会进入您的数据库，因此请在使用时再次验证它。

似乎每天都有一些网络应用程序被黑客入侵，因为他们使用 Javascript 以表单或更糟的方式进行了所有验证，人们找到了绕过它的方法。你必须提防这种情况。

偏执狂？我？没有，只是经历过。

* * *

## 回答 #2

> 赞同：5
> 
> 时间：2008-09-18T01:00:37.863

在可能的情况下，最好在数据库中指定验证规则，并使用或编写一个框架，使这些规则冒泡到您的前端。ASP.NET 动态数据对此有所帮助，并且有一些商业库可以使其更加容易。

这既可以用于简单的输入验证（如数字或日期），也可以用于受外键约束的相关数据。

总而言之，这个想法是在一个地方（大多数时候是数据库）定义规则，并在其他层中有代码来执行这些规则。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2008-09-18T00:44:29.117

将逻辑留给数据库的缺点是增加了特定服务器的负载。Web 和应用程序服务器相对容易向外扩展，但数据库需要特殊技术。作为一般规则，将尽可能多的计算逻辑放入应用程序层并保持与数据库的交互尽可能简单是一个好主意。

话虽如此，您的应用程序可能不需要担心如此严重的可伸缩性问题。如果您*确定*在可预​​见的将来数据库服务器负载不会成为问题，那么请继续对数据库进行约束。您是非常正确的，这通过将验证逻辑保留在中心位置来改善整个系统的组织性和简单性。

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2008-09-18T01:01:44.927

除了带有输入的 SQL 注入之外，还有其他问题。每当接受用户输入时，您都应该采取最防御的姿态。例如，用户可能能够将指向图像的链接输入到文本框中，这实际上是一个运行令人讨厌的 PHP 脚本。

如果您的应用程序设计得很好，您就不必费力地检查所有输入。例如，您可以使用为您处理大部分工作的 Forms API，以及执行相同操作的数据库层。

这是基本检查漏洞的好资源：

[http://ha.ckers.org/xss.html](http://ha.ckers.org/xss.html)

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2008-09-18T01:06:41.093

当数据到达您的数据库以为您的用户和应用程序提供有意义的验证时，为时已晚。您不希望您的数据库进行*所有*验证，因为这会减慢速度，并且数据库不能清楚地表达逻辑。同样，随着您的成长，您将编写更多应用程序级别的事务来补充您的数据库事务。

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2008-09-18T00:43:14.503

我会说这可能是一种不好的做法，具体取决于查询失败时会发生什么。例如，如果您的数据库可能会抛出由应用程序智能处理的错误，那么您可能会没事。

另一方面，如果您没有在您的应用程序中进行任何验证，您可能没有任何不良数据，但您可能会让用户认为他们输入了未保存的内容。

* * *

## 回答 #7

> 赞同：0
> 
> 时间：2008-09-18T00:44:16.717

在不影响其他目标的情况下，在数据库端实施尽可能多的数据验证。例如，如果速度是一个问题，您可能需要考虑*不*使用外键等。此外，某些数据验证只能在应用程序端执行，例如，确保电子邮件地址具有有效域。

* * *

## 回答 #8

> 赞同：0
> 
> 时间：2008-09-18T00:52:58.177

从数据库进行数据验证的另一个缺点是，您通常不会在每种情况下都以相同的方式进行验证。事实上，它通常取决于应用程序逻辑（用户角色），有时您可能希望完全绕过验证（cron 作业和维护脚本）。

* * *

## 回答 #9

> 赞同：0
> 
> 时间：2008-09-18T02:17:21.797

我发现在应用程序中而不是在数据库中进行验证效果很好。当然，所有的交互都需要通过你的应用程序。如果您有其他应用程序可以处理您的数据，那么您的应用程序将需要支持某种 API（希望是 REST）。

* * *

## 回答 #10

> 赞同：0
> 
> 时间：2008-09-25T18:56:13.263

我认为没有一个正确的答案，这取决于您的使用情况。

如果您将拥有一个使用率非常高的系统，并且数据库性能可能会成为瓶颈，那么您可能希望将验证的责任转移到前端，这样更容易与多台服务器一起扩展。

如果您有多个应用程序与数据库交互，那么您可能不想跨多个应用程序复制和维护验证规则，那么数据库可能是更好的地方。

您可能想要一个更流畅的输入屏幕，它不仅会在用户尝试保存记录时向用户发出验证警告，也许您希望在输入数据并且失去焦点后验证字段；甚至在用户键入时，在验证失败/通过时更改字体颜色。

与约束相关的还有可疑数据的警告。在我的应用程序中，我在数据库中有严格的限制（例如，某人无法在出生日期之前开始工作），但随后在前端对可能正确但可疑的数据发出警告（例如八年-老开始工作）。

# .net - .Net 中的异步文件 IO

> ID：88971
> 
> 赞同：7
> 
> 时间：2008-09-18T00:41:05.803
> 
> 标签：.net, windows, winapi, file-io, asynchronous

我正在用 C# 构建一个玩具数据库，以了解有关编译器、优化器和索引技术的更多信息。

我想在将页面带入缓冲池的（至少读取）请求之间保持最大并行度，但我对如何在 .NET 中最好地实现这一点感到困惑。

以下是一些选项以及我遇到的问题：

1.  用途`System.IO.FileStream`及`BeginRead`方法

    但是，文件中的位置不是 的参数`BeginRead`，它是`FileStream`（通过`Seek`方法设置）的属性，所以我一次只能发出一个请求，并且必须在持续时间内锁定流。（或者我是吗？文档不清楚如果我只在`Seek`and`BeginRead`调用之间持有锁但在调用之前释放它会发生什么`EndRead`。有人知道吗？）我知道该怎么做，我只是不确定它是最好的办法。

2.  似乎还有另一种方式，以`System.Threading.Overlapped`结构和 P\Invoke 为 中心`ReadFileEx`在 kernel32.dll 中的函数。

    不幸的是，缺乏样本，尤其是在托管语言中。这条路线（如果它可以工作的话）显然还涉及`ThreadPool.BindHandle`线程池中的方法和IO完成线程。我的印象是这是在 Windows 下处理这种情况的认可方式，但我不明白，我找不到对初学者有帮助的文档的入口点。

3.  还有什么？

4.  在评论中，雅各布建议`FileStream`为飞行中的每一次阅读创建一个新的。

5.  将整个文件读入内存。

    如果数据库很小，这将起作用。代码库很小，还有很多其他的低效率，但数据库本身不是。我还想确保我正在做处理大型数据库所需的所有簿记（事实证明这是复杂性的很大一部分：分页、外部排序......）我担心它可能也是容易不小心作弊。

**编辑**

澄清为什么我对解决方案 1 持怀疑态度：从 BeginRead 到 EndRead 一直持有一个锁意味着我需要阻止任何想要启动读取的人，因为另一次读取正在进行中。这感觉不对，因为启动新读取的线程可能（通常）能够在结果可用之前做更多的工作。（实际上，仅仅写这篇文章就让我想到了一个新的解决方案，我把它作为一个新的答案。）

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2008-09-18T00:48:58.857

我不确定我明白为什么选项 1 不适合你。请记住，您不能让两个不同的线程同时尝试使用同一个 FileStream - 这样做肯定会给您带来问题。BeginRead/EndRead 旨在让您的代码在发生潜在昂贵的 IO 操作时继续执行，而不是启用对文件的某种多线程访问。

所以我建议你先寻找然后做一个beginread。

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2008-09-18T01:27:41.480

我们所做的是在 C++/CLI 中围绕 I/O 完成端口、ReadFile 和 GetQueuedCompletion 状态编写一个小层，然后在操作完成时回调到 C#。我们选择了这条路线而不是 BeginRead 和 c# 异步操作模式，以提供对用于从文件（或套接字）读取的缓冲区的更多控制。与每次读取时在堆上分配新字节 [] 的纯托管方法相比，这是一个相当大的性能提升。

另外，在互联网上有更多使用 IO 完成端口的完整 C++ 示例

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2008-09-18T00:52:14.700

如果您首先将资源（文件数据或其他）加载到内存中，然后跨线程共享它会怎样？因为它是一个小数据库。- 你不会有那么多问题要处理。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2008-09-18T01:12:55.867

使用方法#1，*但是*

1.  当一个请求进来时，获取锁 A。用它来保护一个挂起的读取请求队列。将其添加到队列中并返回一些新的异步结果。如果这导致第一次添加到队列中，请在返回之前调用第 2 步。在返回之前释放锁 A。

2.  当读取完成（或由步骤 1 调用）时，获取锁 A。使用它来保护从队列中弹出读取请求。获取锁 B。用它来保护`Seek`-> `BeginRead`->`EndRead`序列。释放锁 B. 更新第 1 步为此读取操作创建的异步结果。（读取操作完成后，再次调用它。）

这解决了不阻塞任何线程的问题，该线程仅仅因为另一个读取正在进行中而开始读取，但仍然对读取进行排序，以便文件流的当前位置不会被弄乱。

# java - 在 Java 中产生条件编译时错误

> ID：88991
> 
> 赞同：0
> 
> 时间：2008-09-18T00:44:01.380
> 
> 标签：java, c++, compiler-construction, templates

我不是指编译错误，因为我犯了语法错误或其他什么。在 C++ 中，我们可以根据条件创建编译时错误，如下例所示：

```
template<int> struct CompileTimeError;
template<> struct CompileTimeError<true> {};

#define STATIC_CHECK(expr, msg) { CompileTimeError<((expr) != 0)> ERROR_##msg; (void)ERROR_##msg; }

int main(int argc, char* argv[])
{
    STATIC_CHECK(false, Compile_Time_Failure);
    return 0;
} 
```

在 VS 2005 中，这将输出：

```
------ Build started: Project: Test, Configuration: Debug Win32 ------
Compiling...
Test.cpp
f:\temp\test\test\test.cpp(17) : error C2079: 'ERROR_Compile_Time_Failure' uses undefined struct 'CompileTimeError<__formal>'
        with
        [
            __formal=0
        ]
Build log was saved at "file://f:\temp\Test\Test\Debug\BuildLog.htm"
Test - 1 error(s), 0 warning(s)
========== Build: 0 succeeded, 1 failed, 0 up-to-date, 0 skipped ========== 
```

有没有办法在Java中实现这一点？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2008-09-18T00:48:24.863

如果不使用单独的工具，就无法在 Java 中基于编译时逻辑生成任何操作。从技术上讲，*可以*在 Java 上使用 C 预处理器，但您必须小心它对底层语言的内置假设。如果我是你，我会找到一种更好的方法来完成你试图用这个编译时错误做的任何事情。如有必要，您甚至可以编写自己的预处理器（可能使用[APT](http://java.sun.com/j2se/1.5.0/docs/guide/apt/GettingStarted.html)），如果它真的如此不可避免的话。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2008-09-18T06:45:29.093

在 Java 中无法做到这一点，与在 C++ 中为您工作的方式不同。

您也许可以使用注释，并在编译之前或之后运行[apt来检查您的注释。](http://java.sun.com/j2se/1.5.0/docs/guide/apt/GettingStarted.html)

例如：

```
@MyStaticCheck(false, "Compile Time Error, kind-of")
public static void main(String[] args) {
    return;
} 
```

然后编写自己的 AnnotationProcessorFactory 来查找 @MyStaticCheck 注释，并对参数进行处理。

注意：我没有玩太多 apt，但是文档使它看起来非常可行。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2008-09-18T08:54:27.363

正如上面的 Matt Quail 所回答的，注释与[XDoclet](http://xdoclet.sourceforge.net/xdoclet/index.html)一起适合满足您的需求。这种组合允许进行相当多的预处理、代码生成等。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2012-06-21T12:57:44.187

虽然这个问题是前段时间提出的，但我决定发布我的答案，因为我（在一定程度上）解决了一个稍微相似的问题。

我的任务的具体要求需要从单个核心库构建两个具有不同功能集的应用程序（并且未链接的未使用的东西）。功能集的选择是通过`public static final boolean`标志进行的。问题是我想确保在每个应用程序中，它是使用核心库中设置的正确标志构建的。并且在启用了不正确的功能的情况下，应用程序不应该编译给出编译时错误。

到目前为止，我发现的唯一解决方案是在库中声明最终变量以及标志：`public static final int functionSet1 = 0;`等。

在应用程序包中，我添加了一个带有检查的虚拟类

```
ConditionalBuild.functionSet1 = 1; 
```

在所有 functionSetX 变量中，只有一个在特定构建中成为非最终变量。因此，只有一个应用程序可以通过构建过程而不会出现错误。有没有更好的方法来实现这一目标？请在评论中告诉我。*******