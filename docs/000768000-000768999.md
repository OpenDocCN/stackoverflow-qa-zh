# StackOverflow 问答 000768000-000768999

# timezone - 如何在注册表单中检测用户时区？

> ID：768007
> 
> 赞同：8
> 
> 时间：2009-04-20T12:15:02.353
> 
> 标签：timezone, autofill

时区可能很难从几十个选项中选择。我想让这个过程更简单。我在野外看到了一些可以做最好猜测的形式。我盯着解决方案，但没有任何运气。有人知道怎么做吗？

* * *

## 回答 #1

> 赞同：10
> 
> 时间：2009-04-20T12:19:37.663

**Javascript：**

```
var today = new Date();

alert( today.getTimezoneOffset() ); 
```

这将给出偏移量 (GMT-X)，而不是实际的时区名称。请记住，相同的 GMT 偏移量可以对应多个时区，并且还必须考虑夏令时。然而，这可能是最容易开始的地方，没有让用户从下拉列表中选择他们的时区。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2009-04-20T12:21:59.247

您可以尝试通过将用户的 IP 地址与一系列列表相匹配来检测用户所在的国家/地区。有不同的方法可以实现这一点，但最好的方法是使用[这个 API](http://www.iptoc.nl.ae/)。

使用示例如下：[http](http://nl.ae/iptocapi.php?type=1&ip=00.00.00.00) ://nl.ae/iptocapi.php?type=1&ip=00.00.00.00 。这将返回该 IP 地址的国家代码。然后很容易将国家代码与时区匹配。

以这种方式找到时区后，您可以将其用作下拉框中的默认值。

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2010-05-17T21:14:43.193

我在这里找到了一个更好、更强大的解决方案： [http](http://www.onlineaspect.com/2007/06/08/auto-detect-a-time-zone-with-javascript/) ://www.onlineaspect.com/2007/06/08/auto-detect-a-time-zone-with-javascript/ 。

正如作者解释的那样，`Date.getTimezoneOffset()`是不一致的。

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2009-04-20T12:20:29.983

您可以使用[JavaScript](https://web.archive.org/web/1/http://articles.techrepublic%2ecom%2ecom/5100-10878_11-6016329.html)或多或少可靠地确定时区偏移量。据我所知，HTTP 不提供任何方法来确定服务器上的客户端时区。

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2009-04-20T12:21:37.533

使用 Javascript：

```
<input type="hidden" id="visitorTZ" name="visitorTZ" />
<script type="text/javascript">
    d = new Date();
    document.getElementById('visitorTZ').value = d.getTimezoneOffset()/60; 
</script> 
```

# .net - 去掉所有空格？

> ID：768014
> 
> 赞同：0
> 
> 时间：2009-04-20T12:17:10.367
> 
> 标签：.net, regex, whitespace, bandwidth

从 .Net 网站中去除所有空格的最佳方法是什么？我找到了这个网站[空白删除 - 4Wall 艺术网站](http://www.4wall.co.uk/)

如果您查看源代码，它显然是一个 .net 站点，但所有不需要的选项卡和空格都被删除了。现在我搜索了一下，页面渲染上的正则表达式似乎是最好的方法，但是有人有任何例子吗？或者关于这是否是最好的方法有任何相互矛盾的意见？该站点上的 html 源代码已降至 ~30kb，这是我正在努力实现的目标！

谢谢，史蒂夫

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2009-04-20T12:29:53.940

[如果您还没有在 IIS](http://www.microsoft.com/technet/prodtechnol/WindowsServer2003/Library/IIS/d52ff289-94d3-4085-bc4e-24eb4f312e0e.mspx?mfr=true)中打开 gzip/deflate 压缩，您会做得更好。如果您尝试减少网络流量并提高性能，则压缩具有更大的效果，然后删除空白。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-04-20T14:09:50.003

您几乎不应该尝试在 HTML 上使用正则表达式（请参阅[Can you provide some examples of why it is hard to parse XML and HTML with a regex?](https://stackoverflow.com/questions/701166) for why）。对于解析器来说，这确实是一项工作（请参阅[What is the best way to parse the best way to parse html in C#?](https://stackoverflow.com/questions/56107) for HTML parser for C#）。你想要做的伪代码是

```
print tag and attributes with minimal spaces
if tag is in list of tags whose contents can be to modified
    strip redundant whitspace from contents
print contents
print end tag 
```

不应修改其内容的标记的一个示例是 pre 标记。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-04-21T01:50:14.890

好吧，如果你真的想要，你可以使用 bash 'sed' 和 perl 正则表达式将达到同样的效果：

重击：

```
cat yourhtmlfile.html | sed 's_\ +_\ _g' > newReducedFile.html 
```

那应该达到你想要的。它将一个或多个空格变成一个空格。这应该会从您的文件中删除大部分不必要的空白。对于 .net 网站，您可以使用 perl 或 python。有windows版本。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2009-04-21T08:34:15.650

如果您真的觉得需要删除空白一个开始的地方是看看[http://www.codeproject.com/KB/aspnet/WhitespaceFilter.aspx](http://www.codeproject.com/KB/aspnet/WhitespaceFilter.aspx)，我强调这应该只是一个开始的地方不要只需复制文章中的代码，因为作者显然没有很好地掌握正则表达式，他们以非常低效的方式使用了很多。

它如何显示使用过滤器修改所有页面的输出的技术。

# .net - ASP.Net URL 重写和身份验证

> ID：768017
> 
> 赞同：0
> 
> 时间：2009-04-20T12:17:25.890
> 
> 标签：.net, asp.net, authentication, url-rewriting

我有一个使用 .Net 2.0 框架的 Web 应用程序。整个网站仅限于使用 Windows 身份验证的经过身份验证的用户。这些规则在 web.config 文件中设置如下：

```
<location path="/">
    <system.web>
        <authorization>
            <allow roles="CustomerAdministrator, Manager"/>
            <deny users="*"/>
        </authorization>
    </system.web>
</location>
<location path="Path/To/Public/File.aspx">
    <system.web>
        <authorization>
            <allow users="*"/>
        </authorization>
    </system.web>
</location>
[...] 
```

如上所示，我有一个想要公开的页面。到目前为止，一切正常。我们最近为更好的 url 添加了 url 重写，所以我为公共页面设置了重写规则：

```
<RewriterConfig>
    <Rules>
        <RewriterRule>
            <LookFor>~/Public</LookFor>
            <SendTo><![CDATA[~/Path/To/Public/File.aspx]]></SendTo>
        </RewriterRule>
    </Rules>
</RewriterConfig> 
```

现在，当通过其直接 url 访问公共页面时，它可以按预期工作（不需要身份验证），但是当我尝试通过其重写的 url 访问该页面时，它会要求身份验证。

有谁知道我的这个问题来自哪里？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2009-04-20T12:23:51.927

您是否尝试过更改您的位置标签以使用 /Public URL？

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-05-13T12:13:00.323

我确实发现了问题。我正在使用我的一些同事在网上找到的一个项目，问题来自于它在's活动`URLRewriter`中注册自己的事实。虽然这适用于表单身份验证，但不适用于我正在使用的 Windows 身份验证。`HttpApplication``AuthorizeRequest`

为了解决这个问题，我只需要改变它，让它注册到`BeginRequest`事件中（如评论中所写...... RTFM......）。

# c# - 我可以像对待列表框一样对待流程布局面板吗

> ID：768018
> 
> 赞同：0
> 
> 时间：2009-04-20T12:17:34.377
> 
> 标签：c#, winforms, listbox, flowlayoutpanel

有没有办法拥有一个选定的项目并检测它何时发生变化。

想要拥有列表框类型行为但我没有字符串的推荐最佳实践是什么，我有想要从上到下列出的用户控件。

flowlayoutpanel 是执行此操作的正确方法，还是有任何其他方法可以为我提供列表框行为和事件。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-04-20T12:31:45.870

您可以在用户控件中的控件上使用 GotFocus 事件来确定它们何时获得焦点。

或者，您可以使用 DataGridView 控件，将 UserControls 添加到其上的自定义列中。MSDN上有[一篇](http://msdn.microsoft.com/en-us/library/system.windows.forms.idatagridvieweditingcontrol(VS.80).aspx)关于这个的文章，基本上你在你的用户控件中实现了IDataGridViewEditingControl接口。

# html - 为什么无论内容大小如何，我的 CSS（显然）都会强制显示滚动条？

> ID：768020
> 
> 赞同：1
> 
> 时间：2009-04-20T12:17:55.980
> 
> 标签：html, css, layout

对于这里的代码粘贴很长，我深表歉意，但这已经困扰了我好几个小时了。我正在努力将我的整个网站移植到一个新模板中，并且我正在尝试使各个区域和事物更具大小意识，以便我可以将它们中的大部分包含在可调整大小的可停靠窗口和事物中，这是一个非常简洁的概念工作得很好。无论如何，我有一页带有外部样式表，我一生都无法弄清楚。无论内容的垂直大小如何，它都会在底部显示一个滚动条和 20 像素的额外空白页。我检查并重新检查，但我所有的 div 似乎都是独立的，唯一真正的奇数位（边缘，涉及负定位）在删除时不能解决问题。

这是我在页面上使用的 HTML（它是动态生成的，这是我登录时的转储）

```
<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
<title>Objectives</title>
<script type="text/javascript" src="windows/jquery.js"></script>
<link href="windows/windows.css" rel="stylesheet" type="text/css">
<!-- Page Scripts -->

<!-- Generic "always on" scripts -->
<script type="text/javascript">
$(document).ready(function(){
   //Make that backgroud !ugly
   $("body").css("background-color","#000000");
   $("html").css("background-color","#000000");

   //Make all the tags open in new windows. Hee hee hee... good luck there
   $("a").click(function () {
    var url = $(this).attr("href");

    //Build the URL based on a select few modifications.
    if (url.charAt(0) == '?')
        url = "/"+url;

    //Grab the value of action for the string
    var type = url.substr(url.indexOf("action=") + 7);
    if (type.indexOf("&") != -1)
        var type = type.substr(0, type.indexOf("&"));

    parent.spawnNewWindow(url+'&noframe=none', document.title, type);
    return false;
   });

});

</script>

<script language="Javascript" type="text/javascript">
$(document).ready(function(){
    $(".tierPickerShown").click(function () { 
          $(this).parent(".tier").addClass("hideme");
    });
    $(".tierPickerHidden").click(function () { 
          $(this).parent(".tier").removeClass("hideme");
    });
});

</script>

</head>
<body>

    <div class="tier">
        <div class="tierCorner top left"></div>
        <div class="tierCorner top right"></div>
        <div class="tierCorner bottom left"></div>
        <div class="tierCorner bottom right"></div>
        <div class="tierEdgeTop"></div>
        <div class="tierEdgeMiddle"></div>

        <div class="tierEdgeBottom"></div>

        <div class="tierPickerShown"></div><div class="tierPickerHidden"></div>
        <div class="tierMarker"></div>
        <div class="tierTitle">Tier 1</div>
        <div class="tierSpacer"></div>

    <div class="tierItem">
        <div class="tierCheckbox tierActiveCheckbox "></div>
        <div class="tierObjective">Choose a Nova and devote your clan to that Nova.</div>

        <div class="tierUnderline"></div>
        <div class="tierReward">+5 Treasure&nbsp;&nbsp;&nbsp;</div>
        <div class="tierSpacer"></div>
    </div>

    <div class="tierItem">
        <div class="tierCheckbox tierActiveCheckbox "></div>
        <div class="tierObjective">Win an attack with a mage that has an item equipped.</div>
        <div class="tierUnderline"></div>

        <div class="tierReward">+10 Treasure&nbsp;&nbsp;&nbsp;</div>
        <div class="tierSpacer"></div>
    </div>

    <div class="tierItem">
        <div class="tierCheckbox"></div>
        <div class="tierObjective">Steal at least 2 treasure from another player in a single attack.</div>
        <div class="tierUnderline"></div>
        <div class="tierReward">+10 Treasure&nbsp;&nbsp;&nbsp;</div>

        <div class="tierSpacer"></div>
    </div>

    <div class="tierItem">
        <div class="tierCheckbox tierActiveCheckbox "></div>
        <div class="tierObjective">Complete 2 jobs.</div>
        <div class="tierUnderline"></div>
        <div class="tierReward">+25 Treasure&nbsp;&nbsp;&nbsp;</div>
        <div class="tierSpacer"></div>

    </div>

    <div class="tierItem">
        <div class="tierCheckbox tierActiveCheckbox "></div>
        <div class="tierObjective">Win an attack on a player who is devoted to a different Nova than you are.</div>
        <div class="tierUnderline"></div>
        <div class="tierReward">+10 Treasure&nbsp;&nbsp;&nbsp;</div>
        <div class="tierSpacer"></div>
    </div>

    <div class="tierItem">
        <div class="tierCheckbox tierActiveCheckbox "></div>
        <div class="tierObjective">Become a member of a guild.</div>
        <div class="tierUnderline"></div>
        <div class="tierReward">+15 Treasure&nbsp;&nbsp;&nbsp;</div>
        <div class="tierSpacer"></div>
    </div>

    <div class="tierItem">

        <div class="tierCheckbox"></div>
        <div class="tierObjective">Recruit at least one (1) new player to the game using the Invite system. The player must verify their account to qualify for the objective.</div>
        <div class="tierUnderline"></div>
        <div class="tierReward">+200 Treasure&nbsp;&nbsp;&nbsp;</div>
        <div class="tierSpacer"></div>
    </div>

    </div>

    <div class="tier">

        <div class="tierCorner top left"></div>
        <div class="tierCorner top right"></div>
        <div class="tierCorner bottom left"></div>
        <div class="tierCorner bottom right"></div>
        <div class="tierEdgeTop"></div>
        <div class="tierEdgeMiddle"></div>
        <div class="tierEdgeBottom"></div>

        <div class="tierPickerShown"></div><div class="tierPickerHidden"></div>
        <div class="tierMarker"></div>

        <div class="tierTitle">Tier 2</div>
        <div class="tierSpacer"></div>

    <div class="tierItem">
        <div class="tierCheckbox tierActiveCheckbox "></div>
        <div class="tierObjective">Be in first place after 3 days, or attack someone who has joined the Light Team.</div>
        <div class="tierUnderline"></div>
        <div class="tierReward">+10 Treasure&nbsp;&nbsp;&nbsp;Title Awarded: Recruit</div>

        <div class="tierSpacer"></div>
    </div>

    <div class="tierItem">
        <div class="tierCheckbox tierActiveCheckbox "></div>
        <div class="tierObjective">Be in second place after 3 days, or attack someone who has joined the Dark Team.</div>
        <div class="tierUnderline"></div>
        <div class="tierReward">+10 Treasure&nbsp;&nbsp;&nbsp;Title Awarded: Recruit</div>

        <div class="tierSpacer"></div>
    </div>

    <div class="tierItem">
        <div class="tierCheckbox"></div>
        <div class="tierObjective">Donate at least 25 Treasure to your Guild</div>
        <div class="tierUnderline"></div>
        <div class="tierReward"></div>
        <div class="tierSpacer"></div>

    </div>

    <div class="tierItem">
        <div class="tierCheckbox tierActiveCheckbox "></div>
        <div class="tierObjective">Win an attack on someone between 12 AM and 8 AM.</div>
        <div class="tierUnderline"></div>
        <div class="tierReward"></div>
        <div class="tierSpacer"></div>
    </div>

    <div class="tierItem">
        <div class="tierCheckbox"></div>
        <div class="tierObjective">Steal at least 10 treasure from another player in a single attack.</div>
        <div class="tierUnderline"></div>
        <div class="tierReward"></div>
        <div class="tierSpacer"></div>
    </div>

    <div class="tierItem">

        <div class="tierCheckbox"></div>
        <div class="tierObjective">Win an attack on a player who has at least 5 levels of Defense on each of his Mages at home.</div>
        <div class="tierUnderline"></div>
        <div class="tierReward"></div>
        <div class="tierSpacer"></div>
    </div>

    <div class="tierItem">
        <div class="tierCheckbox tierActiveCheckbox "></div>

        <div class="tierObjective">Win an attack on someone on a Weekend.</div>
        <div class="tierUnderline"></div>
        <div class="tierReward"></div>
        <div class="tierSpacer"></div>
    </div>

    </div>

    <div class="tier">
        <div class="tierCorner top left"></div>

        <div class="tierCorner top right"></div>
        <div class="tierCorner bottom left"></div>
        <div class="tierCorner bottom right"></div>
        <div class="tierEdgeTop"></div>
        <div class="tierEdgeMiddle"></div>
        <div class="tierEdgeBottom"></div>

        <div class="tierPickerShown"></div><div class="tierPickerHidden"></div>
        <div class="tierMarker"></div>
        <div class="tierTitle">Tier 3</div>

        <div class="tierSpacer"></div>

    <div class="tierItem">
        <div class="tierCheckbox"></div>
        <div class="tierObjective">Be the highest ranked [Team] Recruit after 1 week, or win an attack on an enemy Cleric</div>
        <div class="tierUnderline"></div>
        <div class="tierReward">Title Awarded: Cleric</div>
        <div class="tierSpacer"></div>
    </div>

    </div>
    </body>
</html> 
```

这是相应的 CSS 样式表。这是 windows.css：

```
/* Body information for the windower, to theme the whole thingy. */

@import url('/tier.css');

html, body {
    width: 100%;
    height: 100%;
    padding: 0px;
    margin: 0px;
    background-color: #FFFFFF; /* Yes, the same color as the text. jQuery will change this to black for us, so it's a good
                    indicator of any syntax errors in the javascript. */
    color: #DEDEDE;

    /* May be changed later, to be theme-specific */
    font-family: Trebuchet MS, sans-serif;  
    font-weight: bold;
    font-size: 14px;

}

a {
    color: #FFFFFF;
    text-decoration: none;
}

a:hover {
    text-decoration: underline;
}

/* Windowing Information Here */

/* OMITTED - Doesn't seem relevant, the classes here aren't used */ 
```

问题代码：tier.css

```
.tier {
    position: relative;
    width: 90%;
    margin-bottom: 25px;
    margin-top: 20px;
    margin-left: auto;
    margin-right: auto;
}

/* Classes to describe the shower/hider thing. One class for each state-- hidden and shown. The 
   respective class is shown based on whether or not its parent has the "hideme" class.          */

.tierPickerShown {
    position: relative;
    display: block;
    float: left;
    width: 24px;
    height: 24px;
    margin: 4px;
    z-index: 5;
    background-image: url('images/show_me_shown.png');
}

.tierPickerShown:hover {
    background-image: url('images/show_me_shown_hover.png');
}

.tierPickerHidden {
    position: relative;
    display: none;
    float: left;
    width: 24px;
    height: 24px;
    margin: 4px;
    z-index: 5;
    background-image: url('images/show_me_hidden.png');
}

.tierPickerHidden:hover {
    background-image: url('images/show_me_hidden_hover.png');
}

.tier.hideme .tierPickerShown {
    display: none;
}

.tier.hideme .tierPickerHidden {
    display: block;
}

/* Container for a tier objective. Holds the checkbox and the text elements. */
.tierItem {
    position: relative;
    width: auto;
    z-index: 5;
}

.tier.hideme .tierItem {
    display: none;
}

.tierCheckbox {
    float: left;
    width: 32px;
    height: 32px;
    margin-left: 8px;
    margin-right: 8px;
    background-image: url('images/checkbox.png');
}

.tierActiveCheckbox {
    background-image: url('images/checkbox_checked.png');
}

.tierObjective {
    margin-left: 54px;
    margin-bottom: 3px;
}

.tierUnderline {
    /* this is just WRONG */
    width: 200px;
    height: 2px;
    margin-left: 54px;
    background-color: #000000;
}

.tierReward {
    margin-left: 54px;
    font-size: 0.7em;
}

.tierSpacer {
    /* Empty div, designed to make sure there's some breathing room below the floated content. */
    clear: both;
    width: 100%;
    height: 5px;
}

.tierTitle {
    font-size: 2.0em;
    padding-left: 54px;
    z-index: 5;
}

.tierMarker {
    float: left;
    background-image: url('images/tier_incomplete.png');
    width: 48px;
    height: 32px;
}

.tierMarkerComplete {
    background-image: url('images/tier_complete.png');
}

/* Aesthetics Stuff */

.tierCorner {
    background-image: url('images/tier_round.png');
    width: 9px;
    height: 9px;
    position: absolute; 
}

.tierCorner.top.left {
    top: -9px;
    left: -9px;
    background-position: 0px 0px;
}

.tierCorner.bottom.left {
    bottom: -9px;
    left: -9px;
    background-position: 0px -9px;
}

.tierCorner.top.right {
    top: -9px;
    right: -9px;
    background-position: -9px 0px;
}

.tierCorner.bottom.right {
    bottom: -9px;
    right: -9px;
    background-position: -9px -9px;
}

.tierEdgeMiddle {
    position: absolute;
    left: -9px;
    right: -9px;
    height: 100%;
    background-image: url('images/tier_bg.png');
    z-index: 2;
}

.tierEdgeTop {
    position: absolute;
    width: 100%;
    top: -9px;
    height: 9px;
    background-image: url('images/tier_bg.png');
}

.tierEdgeBottom {
    position: absolute;
    width: 100%;
    bottom: -9px;
    height: 9px;
    background-image: url('images/tier_bg.png');
} 
```

我为半差的 CSS 安排道歉，到处都有很多重复的东西，但我更愿意在我去缩小这个代码节之前了解是什么使它自动滚动身体区域。有没有人看到我在这里失踪的明显明显的东西？我可以对那个页面做的唯一一件事就是省略 tier.css，这让它看起来很糟糕。

[如果您愿意，我已经设置了一个实时版本，因此您可以在这里](http://www.darknovagames.com/this_is_a_test.html)看到它的外观、图像、滚动条和所有内容。

谢谢，如果有人能指出我错过了什么，这将使我恢复几个小时的睡眠。

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2009-04-20T12:26:26.647

将身体高度降低 100% windows.css 解决了 Firefox 上的问题，这可能会给你一个开始寻找的地方。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-12-28T20:51:58.623

以防其他人偶然发现：当浮动 div 神秘地导致滚动条出现时，我做了一个溢出：隐藏在我的页面主体上。当然，只有当您可以确定查看者将在与您相同大小的窗口中查看您的页面时，您才能执行此操作。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2009-04-20T12:30:32.487

与其尝试理解样式表的混乱和 html，我更喜欢使用安装了 Firebug 插件的 Firefox。Firebug 允许您检查页面元素，它会向您显示应用于该元素的样式。您还可以动态更改样式以查看它如何影响布局。

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2009-04-21T16:19:21.180

我想我已经弄清楚了，尽管它仍然没有任何意义。.tier 类包含单独的层组（并且是 body 的唯一直接后代），其顶部边距为 20px。删除它也会删除页面底部的幻影空间，使滚动条消失。然而，它也将我的层推到了页面顶部，所以我用一个垫片来弥补这一点。我不喜欢它，但这是我让它工作并看起来像我想要的那样的唯一方法。

我无法解释为什么 margin-top 会在容器区域的底部产生额外的空间，在这种情况下是 body。也许这是一个渲染错误？奇怪的是，这将是所有实现中的一个错误。如果有人能对这个特定修复程序的工作原理有所了解，那将是最有帮助的。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2009-04-20T13:24:05.447

您的代码是“divitis”的经典示例，并且比它需要的复杂得多：所有内容都是 div 并使用太多类 - 这使得在出现此类问题时更难调试（即使使用 Firebug/WDT） .

有时，仅仅简化一个页面就足以消除奇怪的古怪行为，所以这始终是我推荐的第一件事。这是一些更好的代码的（*非常快速*的）示例。
它可能不是你想要的完美契合，但比使用 div 更好地开始。

```
<!DOCTYPE html>
<html>
<head>
    <title>Objectives</title>

    <style type="text/css">
        * {margin:0;border-width:0;padding:0;}

        html
        {
            background: black;
            color:#DEDEDE;
            font: 14px Trebuchet MS bold;
        }

        .tier
        {
            width: 90%;
            margin: 20px auto 25px;
            padding: 0.5em;

            background: #404040;
            border-radius: 9px;
            -moz-border-radius: 9px;
            -webkit-border-radius: 9px;
        }

        .tier .picker
        {
            background: none;
            float: left; clear: left;
        }

        .tier h2
        {
            font-size: 2em;
            padding-left: 54px;
            margin: 0.1em 0;
        }

        .tier ul
        {
            list-style: none;
        }

        .tier ul li
        {
            margin-bottom: 5px;
        }

        .tier ul li .checkbox
        {
            width: 32px;
            height: 32px;
            margin: 0 8px;

            float: left; clear: left;
        }

        .tier ul li p
        {
            float: none; clear: right;
            margin-left: 48px;
        }

        .tier ul li p.reward
        {
            font-size: 0.7em;

            width: 200px;
            border-top: solid 2px black;
            margin-top: 4px;
        }

        .tier ul li p.reward .title
        {
            margin-left: 2em;
        }
    </style>
    <script type="text/javascript" src="jquery-1.3.2.min.js"></script>
    <script type="text/javascript">
        $j = jQuery.noConflict();

        $j(document).ready(init);

        function init()
        {
            $j('.picker').toggle
            (
                function()
                {
                    $j(this).siblings('ul').hide();
                    $j(this).children('img').attr('src','images/show_me_hidden.png').attr('alt','>');
                }
            ,
                function()
                {
                    $j(this).siblings('ul').show();
                    $j(this).children('img').attr('src','images/show_me_shown.png').attr('alt','v');
                }
            );
        }

    </script>
</head>
<body>
    <h1>Objectives</h1>

    <div class="tier">

        <button type="button" class="picker">
            <img src="images/show_me_shown.png" alt="v" />
        </button>

        <h2>Tier 1</h2>
        <ul>
            <li>
                <img class="checkbox" src="images/checkbox_checked.png" alt="*" title="Completed" />
                <p class="objective">Choose a Nova and devote your clan to that Nova.</p>
                <p class="reward">+5 Treasure</p>
            </li>
            <li>
                <img class="checkbox" src="images/checkbox_checked.png" alt="*" title="Completed" />
                <p class="objective">Win an attack with a mage that has an item equipped.</p>
                <p class="reward">+10 Treasure</p>
            </li>
            <li>
                <img class="checkbox" src="images/checkbox.png" alt=" " title="Uncompleted" />
                <p class="objective">Steal at least 2 treasure from another player in a single attack.</p>
                <p class="reward">+10 Treasure</p>
            </li>
        </ul>
    </div>

    <div class="tier">

        <button type="button" class="picker">
            <img src="images/show_me_shown.png" alt="v" />
        </button>

        <h2>Tier 2</h2>
        <ul>
            <li>
                <img class="checkbox" src="images/checkbox_checked.png" alt="*" title="Completed" />
                <p class="objective">Be in first place after 3 days, or attack someone who has joined the Light Team.</p>
                <p class="reward">+10 Treasure <span class="title">Title Awarded: Recruit</span></p>
            </li>
        </ul>
    </div>

</body>
</html> 
```

# .net-3.5 - SSL (https) 上的简单 HttpWebRequest 在 C# 下找不到 404

> ID：768030
> 
> 赞同：5
> 
> 时间：2009-04-20T12:22:38.280
> 
> 标签：.net-3.5, ssl, httpwebrequest

我想对一个安全连接上的 php 编写的 Web 服务进行 POST。以下代码只是我经过几个小时的反复试验后编写的测试控制台应用程序。本质上，我发现了一些使用 HttpWebRequest 的不同方法，但它们都是一样的。

在网络浏览器上使用“http”测试我的 URI，应该返回一个空白的 html（带有一个空的正文）。这在浏览器**和我的代码中**都可以正常工作。

我继续尝试了[http://www.google.com](http://www.google.com)，然后我得到了谷歌……（如预期的那样）。当我将 URI 从 http 更改为 https 时，就会出现问题。**在网络浏览器**上使用“https”测试我的 URI ，返回相同的空白 html（这是预期的）。但是当我在代码中尝试相同的 URI 时，我得到一个 404 Not Found。

这是简单的代码（和 URI）（取消注释第二个以尝试 https）：

```
try
{
  string lcUrl = "http://servicios.mensario.com/enviomasivo/apip/";
  //string lcUrl = "https://servicios.mensario.com/enviomasivo/apip/";

  // *** Establish the request
  HttpWebRequest loHttp = (HttpWebRequest)WebRequest.Create(lcUrl);

  // *** Set properties
  loHttp.Timeout = 10000;     // 10 secs
  loHttp.Method = "POST"; // I added this for testing, but using GET or commenting this out doesn't change anything.

  // Retrieve request info headers ******** HERE I GET THE EXCEPTION **********
  HttpWebResponse loWebResponse = (HttpWebResponse)loHttp.GetResponse();

  // All this code only works when lcUrl is NOT https.
  Encoding enc = Encoding.GetEncoding(1252);  // Windows default Code Page

  StreamReader loResponseStream = new StreamReader(loWebResponse.GetResponseStream(), enc);

  string lcHtml = loResponseStream.ReadToEnd();

  loWebResponse.Close();
  loResponseStream.Close();
}
catch ( WebException ex )
{
  if ( ex.Status == WebExceptionStatus.ProtocolError )
  {
    HttpWebResponse response = ex.Response as HttpWebResponse;
    if ( response != null )
    {
      // Process response
      Console.WriteLine(ex.ToString());
    }
  }
}
Console.Read();
return; 
```

例外是：

> System.Net.WebException：远程服务器返回错误：（404）未找到。在 System.Net.HttpWebRequest.GetResponse()

**注意**：这里显示的http url是我必须使用的真实网址，它不属于我，而是属于另一家公司。

如果响应正常，则 lcHtml 应包含以下内容：

```
<html>
<head>
 <title></title>
</head>

<body>
</body>
</html> 
```

因为在发布这个问题之前我用谷歌搜索和*StackOverflow*了**很多**，我发现了一些想法。一种是添加“忽略证书”代码：

```
System.Net.ServicePointManager.ServerCertificateValidationCallback += delegate( object sender, System.Security.Cryptography.X509Certificates.X509Certificate certificate, System.Security.Cryptography.X509Certificates.X509Chain chain, System.Net.Security.SslPolicyErrors sslPolicyErrors )
  {
      return true; // **** Always accept
  }; 
```

这似乎并没有改变什么。

其他用户说 SSL 协议类型可能是错误的......所以我尝试了这两个无济于事：

```
 ServicePointManager.SecurityProtocol = SecurityProtocolType.Tls;
 ServicePointManager.SecurityProtocol = SecurityProtocolType.Ssl3; 
```

有任何想法吗？

**更新** 我回去创建了一个简单的控制台应用程序。*唯一*的代码是这样的：

```
WebRequest req = WebRequest.Create("http://servicios.mensario.com/enviomasivo/apip/");
WebResponse resp = req.GetResponse(); 
```

这样可行。没有错误。

但是，如果我将 URI 更改为 https：

```
WebRequest req = WebRequest.Create("https://servicios.mensario.com/enviomasivo/apip/");
WebResponse resp = req.GetResponse(); 
```

我收到一个错误（继续尝试）。

*然而* [，这个](http://www.mensario.com/SEMPROTP/SDK/saldo.php)php 代码似乎可以工作。我看到的唯一不同的**相关**代码行是：

```
curl_setopt($ch, CURLOPT_SSL_VERIFYPEER, 0); 
```

西班牙语评论说：“有了这个，我们可以忽略 SSL 证书”。

我认为这是关键。但是

```
System.Net.ServicePointManager.ServerCertificateValidationCallback… 
```

……东西，似乎没有同样的效果。

提前致谢。

* * *

## 回答 #1

> 赞同：10
> 
> 时间：2009-04-21T18:24:47.573

在使用 fiddler 和 firefox 进行一些实验后，您的 URL 似乎是问题所在。对我来说，这给出了 404：

[https://servicios.mensario.com/enviomasivo/apip/](https://servicios.mensario.com/enviomasivo/apip/)

这不会：

[https://servicios.mensario.com/enviomasivo/apip](https://servicios.mensario.com/enviomasivo/apip)

注意，结尾的斜线。此外，您发布的 php 示例也没有结尾斜杠。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-04-20T17:58:53.727

你可以试试这里描述的技巧：http: [//oregonstate.edu/~reeset/blog/archives/166](http://oregonstate.edu/~reeset/blog/archives/166)

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-04-21T14:58:13.030

这看起来不是代码的问题，因为您提供的 URL 似乎无论如何都具有有效的 SSL 证书。

[用“ https://www.google.com](https://www.google.com) ”尝试你的两行代码段是可行的，所以我建议设置一个像 Fiddler 这样的网络调试代理来比较在 servicios.mensario.com/enviomasivo 上使用 HTTP 和 HTTPS 时的 HTTP 请求字段/api。您是否在该站点上使用反向代理？

# c# - SerialPort.Write() - 如何停止写入？

> ID：768032
> 
> 赞同：1
> 
> 时间：2009-04-20T12:22:45.923
> 
> 标签：c#, serial-port, blocking

我正在使用`SerialPort`该类在 C# 中进行开发。 `SerialPort.Write()`是一种阻塞方法。当我想停止写作时，如何退出这个方法？我用一个线程来写。当我想停止写入但 COM 端口继续写入时，我中止了这个线程。

有任何想法吗？

非常感谢。

对不起我的基本英语。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-04-20T12:50:18.367

Serial Port 的 Stream 和 UART 都会做缓冲。

最好的方法是发送小包（行）并中断写入线程，让最后一个发送包出去。如果您可以以文明的方式停止写入，那么还有 DiscardWriteBuffer() 方法。

如果小包不是一个选项，您至少可以将 WriteBufferSize 设置为较小的值（但 > 0）。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2010-02-03T11:27:02.893

打破使用阻塞`SerialPort.Write()`状态 `SerialPort.DiscardOutBuffer()`。这会导致一个`IOException`问题，但只要您可以干净地摆脱阻塞状态就可以了。

# boost-asio - 谁使用 Boost ASIO？

> ID：768038
> 
> 赞同：10
> 
> 时间：2009-04-20T12:24:03.673
> 
> 标签：boost-asio

我想知道Boost ASIO有多受欢迎。它是否被用于任何流行的网络密集型软件？

* * *

## 回答 #1

> 赞同：13
> 
> 时间：2013-01-21T21:21:50.227

用于管理 IBM [Blue Gene/Q](http://en.wikipedia.org/wiki/Blue_Gene#Blue_Gene.2FQ)超级计算机的系统软件广泛使用 Boost.Asio。如果您有兴趣，可以在 Eclipse Public License (EPL) 下获得源[代码。](https://repo.anl-external.org/viewvc/bgq-driver/V1R2M0/)

![蓝色基因/Q](https://i.stack.imgur.com/MLOoL.jpg)

* * *

## 回答 #2

> 赞同：10
> 
> 时间：2010-01-02T06:46:42.903

[http://think-async.com/Asio/WhoIsUsingAsio](http://think-async.com/Asio/WhoIsUsingAsio)

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2013-01-03T12:35:06.933

Boost 广泛用于严肃的网络软件，例如 HPX 使用 boost 库。HPX 在 C++11 中实现，并利用了 20 多个 Boost 和候选 Boost 库。看看[http://cppnow.org/session/hpx-a-c11-parallel-runtime-system/](http://cppnow.org/session/hpx-a-c11-parallel-runtime-system/)

此外，有关更多详细信息，您可以参考[Android 和 iOS 的官方“Boost library”支持？](https://stackoverflow.com/questions/14036311/official-boost-library-support-for-android-and-ios)描述如何将这些部署在智能手机操作系统上。

希望能帮助到你！

# sql - 查询中的多个 where 子句失败

> ID：768040
> 
> 赞同：0
> 
> 时间：2009-04-20T12:24:59.023
> 
> 标签：sql, mysql

我正在尝试从我的表中选择以下查询：

```
SELECT ARTICLE_NO, USERNAME, ACCESSSTARTS, ARTICLE_NAME, 
date_format(str_to_date(ACCESSSTARTS, '%d.%m.%Y %k:%i:%s'), '%d %m %Y' ) AS shortDate 
FROM AUCTIONS WHERE SUBCAT = 'fake' and USERNAME = 'testuser' ORDER BY 
str_to_date(ACCESSSTARTS, '%d.%m.%Y %k:%i:%s'), article_no limit 0, 10 
```

我得到 0 个结果。

然而，两者

```
SELECT ARTICLE_NO, USERNAME, ACCESSSTARTS, ARTICLE_NAME, 
date_format(str_to_date(ACCESSSTARTS, '%d.%m.%Y %k:%i:%s'), '%d %m %Y' ) AS shortDate 
FROM AUCTIONS WHERE SUBCAT = 'fake' ORDER BY 
str_to_date(ACCESSSTARTS, '%d.%m.%Y %k:%i:%s'), article_no limit 0, 10 
```

和

```
SELECT ARTICLE_NO, USERNAME, ACCESSSTARTS, ARTICLE_NAME, 
date_format(str_to_date(ACCESSSTARTS, '%d.%m.%Y %k:%i:%s'), '%d %m %Y' ) AS shortDate 
FROM AUCTIONS WHERE USERNAME = 'testuser' ORDER BY 
str_to_date(ACCESSSTARTS, '%d.%m.%Y %k:%i:%s'), article_no limit 0, 10 
```

返回预期的结果集。为什么他们不一起工作？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-04-20T12:28:50.493

我认为，“假”和“测试用户”的组合没有结果？（你的意思是OR吗？）

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2009-04-20T12:29:00.947

WHERE SUBCAT = 'fake' 和 USERNAME = 'testuser'

应该：

WHERE SUBCAT = 'fake'**或**USERNAME = 'testuser'

这将返回您所追求的两个结果，对吗？

编辑：对不起，误读了这些字段。将“SUBCAT”列添加到您的查询中，这样您就可以查看每个查询有多少次出现，并确保在应用两个 where 子句之前组合会产生结果。

# sql - SQL 阅读器说不存在值，查询似乎很好

> ID：768052
> 
> 赞同：1
> 
> 时间：2009-04-20T12:28:21.043
> 
> 标签：sql, vb.net

我正在使用 VB 开发一个 ASP.NET 应用程序，并在 VB 中使用 SQL 命令和连接来获取页面的数据。我将这两个部分都初始化为：

```
travelQuery.CommandText = "SELECT [StartLoc], [EndLoc],[TravelTime], [AvgSpeed], [Distance]  FROM [TravelTimes] WHERE [TripNum] = '" + lblTrip.Text + "'"
travelConnection.ConnectionString = "..."

 eventQuery.CommandText = "SELECT [IncdntDate], [Roadway],..." 
```

等等，就像那样。我省略了 eventQuery，因为它可以正常工作。旅行查询和事件查询也具有相同的连接字符串。程序执行事件查询，然后如果返回的 RdwyID 值之一适合某个范围，则执行 travelQuery。

我在代码中将 RdwyID 设置为 187 以强制它提取并发布旅行时间，当我尝试运行它时它会崩溃，说没有值。这是我使用的确切代码。我用 eventQuery 以完全相同的方式做事，它工作得很好。我确保正确打开和关闭连接。时间被正确地声明为一个对象数组。

我正在检查查询的 TripNum 是数据库内的一个常量值，其数据类型为文本。

```
Dim rdwyID As Integer
'rdwyID = events(9) - where the value is pulled from usually'
rdwyID = 187

 If (rdwyID >= 186 And rdwyID <= 225)
     FillWithTime("2", travelReader, time, newCell)

Private Sub FillWithTime(ByVal TripNum As String, ByRef travelReader As SqlDataReader, ByRef TimeData() As Object, ByRef Cell As System.Web.UI.WebControls.TableCell)

    lblTrip.Text = TripNum
    travelReader = travelQuery.ExecuteReader()
    travelReader.Read()
    travelReader.GetValues(TimeData)

    Cell.Text += "From: " + TimeData(0).ToString().Substring(9) + "<br />"
    Cell.Text += "To: " + TimeData(1).ToString().Substring(9) + "<br />"
    Cell.Text += "Travel Time: " + TimeData(2).ToString() + " minutes <br />"
    Cell.Text += "Average Speed: " + TimeData(3).ToString() + " MPH <br />"
    Cell.Text += "Distance: " + TimeData(4).ToString() + " miles <br />"

End Sub 
```

感谢您提供的任何帮助或建议。

编辑：按照您所说的进行更改，并且执行阅读器的 if 语句评估为假。我对与读者合作一无所知，什么样的条件会使其失败？谢谢一堆。

编辑 2：检查计数以匹配条件返回零，并直接检查返回 15。非常感谢。是时候弄清楚为什么在地球上它不匹配了……

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2009-04-20T12:40:50.090

我想你可以尝试这样的事情

```
 travelQuery.CommandText = "SELECT [StartLoc], [EndLoc],[TravelTime], [AvgSpeed], [Distance]  FROM [TravelTimes] WHERE [TripNum] = @trip"
    ' Assuming trip as integer
    travelQuery.CommandParameters.Add(@trip, Convert.ToInt32(lblTrip.Text)) 
```

此外，如果 lblTrip.Text 不是数字，上面的代码将引发错误，因此您将使用 int.TryParse 或类似的东西。

此外，在阅读器中，检查阅读

```
If (travelReader.Read()) Then Begin
End If 
```

这样，如果读者在读取数据时遇到问题，您就不会引发错误。

**编辑 1**

出于测试目的，请先检查此

```
travelQuery.CommandText = "SELECT COUNT(*) FROM [TravelTimes] WHERE [TripNum] = @trip" 
```

然后这个

```
travelQuery.CommandText = "SELECT COUNT(*) FROM [TravelTimes]" 
```

第一个将为您提供满足您条件的行，第二个将为您提供表的总行数，这样您就可以确定问题是阅读器还是数据源（db）

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-04-20T12:59:03.793

如果您使用的是 SQL Server：尝试使用 SQL Server Profiler 查看实际提交到服务器的查询。我的 gess 将是 lblTrip.Text 尚未设置。

# java - 在 Spring AOP 中避免就地切入点表达式

> ID：768063
> 
> 赞同：4
> 
> 时间：2009-04-20T12:30:37.200
> 
> 标签：java, spring, aop

我正在使用 Spring AOP。我给出的切入点如下：

```
@Pointcut("execution(* com.demo.Serviceable+.*(..))")
public void serviceMethodCalls() {
} 
```

是否可以避免 Spring AOP 中的就地切入点表达式？

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2009-04-23T08:19:57.027

这取决于您使用 Spring 选择的 AOP 样式。当您坚持使用基于注释的方法时，除了具有位于外部类中的表达式的常量之外，您能得到的东西不多。

这是由于基于 @Aspect 注释的 AOP 样式专用于 colocate *where*和*what*。您可以通过使用抽象方法并将切入点绑定到它来以某种方式获得一些可配置性。

```
@Aspect
public abstract class MyAspect {

  protected abstract pointcut();

  @Before("pointcut()")
  public void myAdviceMethod() {
    // Advice code goes here
  }
}

public class ConcreteAspect extends MyAspect {

  @Pointcut("execution(* com.acme.*.*(..))")
  protected pointcut() {
  )
} 
```

这是可能的，但对我来说似乎相当尴尬，因为实现者必须知道该`@Pointcut`方法*需*要这样做。如果她忘记放置它，它将完全崩溃。

如果您需要灵活地将建议和切入点分开，您最好坚持使用基于 XML 的配置（例如，请参阅[Spring 文档](http://static.springframework.org/spring/docs/2.5.x/reference/aop.html#aop-schema)）。

中间的一种人是可以将您的切入点与自定义注释联系起来，并让用户决定将其放置在哪里，从而决定何时应用您的建议。[Spring 文档（第 6.2.3.4 章）](http://static.springframework.org/spring/docs/2.5.x/reference/aop.html#aop-pointcuts)提供了更多信息。

问候，奥利

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2016-10-07T10:12:24.737

以下是使用 Java Config 定义可配置 Spring AOP Advice 的方法：

```
@Configuration
public class ConfigurableAdvisorConfig {

    @Value("${pointcut.property}")
    private String pointcut;

    @Bean
    public AspectJExpressionPointcutAdvisor configurabledvisor() {
        AspectJExpressionPointcutAdvisor advisor = new AspectJExpressionPointcutAdvisor();
        advisor.setExpression(pointcut);
        advisor.setAdvice(new MyAdvice());
        return advisor;
    }
}

class MyAdvice implements MethodInterceptor {

    @Override
    public Object invoke(MethodInvocation invocation) throws Throwable {
        System.out.println("Before method");
        Object result = invocation.proceed();
        System.out.println("After method");
        return result;
    }
} 
```

`pointcut.property`然后可以在您的`application.properties`文件中定义

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2009-04-20T12:43:10.443

这是你想要的吗？基于代理的 aop：[http](http://static.springframework.org/spring/docs/2.5.x/reference/aop-api.html) ://static.springframework.org/spring/docs/2.5.x/reference/aop-api.html 示例

```
<bean id="settersAndAbsquatulateAdvisor" 
class="org.springframework.aop.support.RegexpMethodPointcutAdvisor">
<property name="advice">
    <ref local="beanNameOfAopAllianceInterceptor"/>
</property>
<property name="patterns">
    <list>
        <value>.*set.*</value>
        <value>.*absquatulate</value>
    </list>
</property> 
```

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2010-01-09T10:41:40.627

在 Spring2.X 中引入了切入点表达式，它有效地允许您匹配到您想要编织建议的位置。

您也可以使用 Spring1.X 的老式方式，即通过 spring 配置 xml 创建一个 ProxyFactoryBean（由 1 个目标对象和可能的多个建议组成），如下所示。这样，您就不需要弄乱切入点表达式了。但是，这样做的缺点是您只能将建议编织到一个目标对象而不是多个目标对象中。

下面是一个典型的例子：

```
<bean id="personTarget" class="com.mycompany.PersonImpl">
    <property name="name"><value>Tony</value></property>
    <property name="age"><value>51</value></property>
</bean>

<bean id="myAdvisor" class="com.mycompany.MyAdvisor">
    <property name="someProperty"><value>Custom string property value</value></property>
</bean>

<bean id="person" 
    class="org.springframework.aop.framework.ProxyFactoryBean">
    <property name="proxyInterfaces"><value>com.mycompany.Person</value></property>

    <property name="target"><ref local="personTarget"/></property>
    <property name="interceptorNames">
        <list>
            <value>myAdvisor</value>
        </list>
    </property>
</bean> 
```

# c# - 从 Windows 应用程序显示命令提示符消息（或控制台消息）

> ID：768064
> 
> 赞同：0
> 
> 时间：2009-04-20T12:30:43.313
> 
> 标签：c#, .net

我正在开发一个 windows 应用程序，我想在执行 windows 应用程序时在命令提示符下显示一些状态消息，我该怎么做`cmd.exe`才能通过 windows 代码运行。但我不知道如何在命令提示符下显示一些消息或者是否有任何方法可以`Console.WriteLine("Message")`通过 Windows 应用程序执行某些操作。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-04-20T14:03:03.687

控制台和 Windows 应用程序不能很好地混合，完整的解释和变通方法见这个链接：

[http://blogs.msdn.com/oldnewthing/archive/2009/01/01/9259142.aspx](http://blogs.msdn.com/oldnewthing/archive/2009/01/01/9259142.aspx)

# data-structures - 在arraylist中保存堆栈

> ID：768065
> 
> 赞同：0
> 
> 时间：2009-04-20T12:31:16.620
> 
> 标签：data-structures, shared-libraries

我想知道如何将堆栈保存在数组列表中？

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2009-04-20T12:35:40.290

在 C# 3.0 中，您可以：

```
var list = stack.ToList();  // Returns List<T> 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-04-20T12:36:38.603

```
System.Collections.Generic.Stack<int> myStack = new Stack<int>();
System.Collections.ArrayList myList = new System.Collections.ArrayList(myStack); 
```

# .net - .NET 上 x86/x64/ia64 内存模型之间的差异

> ID：768078
> 
> 赞同：5
> 
> 时间：2009-04-20T12:37:18.617
> 
> 标签：.net, x86, 64-bit, memory-model, itanium

我正在寻找有关 x86/x64/ia64 上 .NET CLR/JIT 使用的内存模型之间差异的参考。我知道 x86 和 ia64 之间存在一些差异（指令重新排序、指令删除等），但我还没有找到关于 x86 和 x64 之间差异的参考。

我有一个针对一些非常严格的延迟数字的应用程序，并且此时只能在 x86 上运行，并且可能在 x64 上运行（绝对不是在 ia64 上）。我想知道我是否可以依赖 x86 JIT 实现的一些工件并且在 x64 上仍然相对安全，或者我是否应该对更松散的 ia64 JIT 进行编程（这将需要更多字段是易变的，并且在几个地方）。

在此先感谢您的任何指点。

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2009-04-20T12:49:14.470

关于 .NET 内存模型的两篇文章（比 ECMA 模型更强，顺便说一句）：

*   [万斯·莫里森](http://msdn.microsoft.com/en-gb/magazine/cc163715.aspx)（详细）
*   [Joe Duffy](http://www.bluebytesoftware.com/blog/2007/11/10/CLR20MemoryModel.aspx)（基于上述的一套规则）

Joe Duffy 的书[Concurrent Programming on Windows](https://rads.stackoverflow.com/amzn/click/com/032143482X)也是有关该主题的重要信息来源。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-04-20T12:48:53.223

.NET 内存模型在 ECMA 规范 ISO/IEC-23271 中指定。特别是在第一部分：概念和架构，第 12.6 章“内存模型和优化”中。

该标准定义了 JIT 可能在其中运行的边界。如果您想对架构保持中立，则应遵循该标准并且不使用 x86/x64 JIT 的任何细节。

此外，x64 是 x86 的演进，它主要由附加指令、寄存器和一些扩展 (SSE2) 组成，被定义为所有 x64 兼容处理器的基线。内存模型几乎没有变化，除了额外的地址空间和额外的寻址模式（指令指针相关数据访问）。因此，针对 x86 JIT 进行优化也应该在 x64 上产生良好的结果。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-04-20T13:24:42.763

这可能对你来说太低了，但如果你依赖它作为硬件非阻塞指令，一些较旧的 AMD 64 位 cpu 没有 CMPXCHG16B ( [Source )。](http://en.wikipedia.org/wiki/X86-64#Differences_between_AMD64_and_Intel_64)

[此外，C++ 的内存模型](http://www.justsoftwaresolutions.co.uk/threading/intel-memory-ordering-and-c++-memory-model.html)似乎也发生了变化，这可能是相关的，因此如果您正在执行非常低级的代码，您可能需要密切关注。

CLR“指定”的内存模型是微软内部持续争论的话题（至少早在[2003 年](http://blogs.msdn.com/cbrumme/archive/2003/05/17/51445.aspx)就公开讨论过）。作为旁注，Chris Brumme 在那篇文章中指出，x64 的模型与 x86 相同，我认为对于 CLR 托管代码而言这是一个准确的陈述。

除非您的目标用户明确包含 Itanium，否则我认为仅包含一个后备、较慢但简单且安全，该架构的实现就足以保证正确性。这样就无需指出您的软件在该平台上已损坏，只需说明它以较慢的回退模式运行即可。如果人们随后想认真使用该平台，您可以编写*更*宽松的模型。

Note that the x64 JIT is different to the x86 JIT (significantly so since 3.5 SP1) so any Release Mode testing on one is not representative of the other and vice versa. Test as appropriate.

# asp.net - 如何获取可见设置为 false 的 ASP.NET 控件以折叠控件之间的区域？

> ID：768086
> 
> 赞同：1
> 
> 时间：2009-04-20T12:41:12.510
> 
> 标签：asp.net

我在页面上有一些控件，这些控件在页面加载时是不可见的。

但是根据用户输入，应该可以看到许多控件。我已经做到了。

但是我的页面看起来有点脏，因为有时很多控件是不可见的。所以丢失了很多空间。

我该如何管理？

Visual Studio 2008 中是否有任何特定选项可以执行此操作，以便自动调整丢失的空间？

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2009-04-20T12:44:14.483

您如何设置控件的可见性？可见性设置和显示设置之间存在差异。

这个链接很好地解释了它：[可见性与显示](http://www.devx.com/tips/Tip/13638)

如果您专门谈论 ASP.NET 控件...请记住，为任何控件设置 Visible="false" 会导致 ASP.NET 根本不呈现控件，因此如果您需要切换可见性，它并不太有用在客户端。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-04-20T12:47:25.490

您可以将 Invisible 控件包装在`Panel`控件或`UserControl`. 这样，您可以使整个面板控件不可见，并用它隐藏空白。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-04-20T12:47:36.907

您如何切换控件的可见性？如果`false`在 Page_Load 中将服务器控件的 Visibility 设置为，它根本不会呈现，也不会占用它可能占用的任何空间。但是，如果您使用 Javascript 来切换可见性，请确保切换`display`控件的 CSS 属性，而不是`visibility`属性。

答案还取决于您的 HTML 标记。

# c# - 在 WCF 服务中共享常量

> ID：768087
> 
> 赞同：1
> 
> 时间：2009-04-20T12:41:55.953
> 
> 标签：c#, .net, wcf, web-services, constants

我有某些包含特殊字符的字符串，因此它们不能作为枚举成员在 WCF 服务中共享。（实际上，它们是配置值的键。）

我希望能够在客户端传递密钥并取回配置值。如果有变化，我只想在一个地方更改配置键。

常量将是理想的，因为它们可以在整个解决方案中作为强引用进行更改，并且可以通过服务引用更新来更新底层值。

目前我能想到两种可能的解决方案：

1.  创建一个共享程序集并将常量放在那里
2.  在服务中共享常量。

问题是，我无法让 datacontractserializer 序列化常量。这有可能吗？共享程序集是我唯一的选择吗？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-04-20T12:49:40.257

如果是我，我会将我的配置值保存在外部配置文件中。您可以将键/值对存储在配置文件中，然后允许所有程序集访问该文件。这样，配置值可以在不重新编译程序集的情况下更改，并且可以同时从任何服务访问。

# c# - 对链表进行排序

> ID：768095
> 
> 赞同：11
> 
> 时间：2009-04-20T12:44:59.193
> 
> 标签：c#, algorithm, data-structures, linked-list

我用 C# 编写了一个基本的链表类。它有一个 Node 对象，它（显然）代表列表中的每个节点。

该代码不使用 IEnumerable，但是，我可以实现排序功能吗？我使用的语言是 C#。C#中有这样的例子吗？

我正在使用此[示例](http://www.c-sharpcorner.com/UploadFile/jeradus/UsingLinkedListInCS11102005005525AM/UsingLinkedListInCS.aspx)：

谢谢

* * *

## 回答 #1

> 赞同：23
> 
> 时间：2009-04-20T13:33:02.727

## 功能快速排序和合并排序

这是一个以函数式风格编写的带有快速排序和合并排序方法的链表：

```
class List
{
    public int item;
    public List rest;

    public List(int item, List rest)
    {
        this.item = item;
        this.rest = rest;
    }

    // helper methods for quicksort

    public static List Append(List xs, List ys)
    {
        if (xs == null) return ys;
        else return new List(xs.item, Append(xs.rest, ys));
    }

    public static List Filter(Func<int,bool> p, List xs)
    {
        if (xs == null) return null;
        else if (p(xs.item)) return new List(xs.item, Filter(p, xs.rest));
        else return Filter(p, xs.rest);
    }

    public static List QSort(List xs)
    {
        if (xs == null) return null;
        else
        {
            int pivot = xs.item;
            List less = QSort(Filter(x => x <= pivot, xs.rest));
            List more = QSort(Filter(x => x > pivot, xs.rest));
            return Append(less, new List(pivot, more));
        }
    }

    // Helper methods for mergesort

    public static int Length(List xs)
    {
        if (xs == null) return 0;
        else return 1 + Length(xs.rest);
    }

    public static List Take(int n, List xs)
    {
        if (n == 0) return null;
        else return new List(xs.item, Take(n - 1, xs.rest));
    }

    public static List Drop(int n, List xs)
    {
        if (n == 0) return xs;
        else return Drop(n - 1, xs.rest);
    }

    public static List Merge(List xs, List ys)
    {
        if (xs == null) return ys;
        else if (ys == null) return xs;
        else if (xs.item <= ys.item) return new List(xs.item, Merge(xs.rest, ys));
        else return new List(ys.item, Merge(xs, ys.rest));
    }

    public static List MSort(List xs)
    {
        if (Length(xs) <= 1) return xs;
        else
        {
            int len = Length(xs) / 2;
            List left  = MSort(Take(len, xs));
            List right = MSort(Drop(len, xs));
            return Merge(left, right);
        }
    }

    public static string Show(List xs)
    {
        if(xs == null) return "";
        else return xs.item.ToString() + " " + Show(xs.rest);
    }
} 
```

## 使用配对堆的功能堆排序

奖励：堆排序（使用功能配对堆）。

```
class List
{
    // ...

    public static Heap List2Heap(List xs)
    {
        if (xs == null) return null;
        else return Heap.Merge(new Heap(null, xs.item, null), List2Heap(xs.rest));
    }

    public static List HSort(List xs)
    {
        return Heap.Heap2List(List2Heap(xs));
    }
}

class Heap
{
    Heap left;
    int min;
    Heap right;

    public Heap(Heap left, int min, Heap right)
    {
        this.left = left;
        this.min = min;
        this.right = right;
    }

    public static Heap Merge(Heap a, Heap b)
    {
        if (a == null) return b;
        if (b == null) return a;

        Heap smaller = a.min <= b.min ? a : b;
        Heap larger = a.min <= b.min ? b : a;
        return new Heap(smaller.left, smaller.min, Merge(smaller.right, larger));
    }

    public static Heap DeleteMin(Heap a)
    {
        return Merge(a.left, a.right);
    }

    public static List Heap2List(Heap a)
    {
        if (a == null) return null;
        else return new List(a.min, Heap2List(DeleteMin(a)));
    }
} 
```

对于实际使用，您希望在不使用递归的情况下重写辅助方法，并且可能使用像内置列表一样的可变列表。

如何使用：

```
List xs = new List(4, new List(2, new List(3, new List(1, null))));
Console.WriteLine(List.Show(List.QSort(xs)));
Console.WriteLine(List.Show(List.MSort(xs)));
Console.WriteLine(List.Show(List.HSort(xs))); 
```

## 链表的命令式就地快速排序

要求提供就地版本。这是一个非常快速的实现。我从上到下编写了这段代码，并没有寻找机会让代码变得更好，即每一行都是我想到的第一行。这非常难看，因为我使用 null 作为空列表 :) 缩进不一致等。

此外，我仅在一个示例中测试了此代码：

```
 MList ys = new MList(4, new MList(2, new MList(3, new MList(1, null))));
        MList.QSortInPlace(ref ys);
        Console.WriteLine(MList.Show(ys)); 
```

神奇的是它第一次工作！我很确定这段代码包含错误。不要追究我的责任。

```
class MList
{
    public int item;
    public MList rest;

    public MList(int item, MList rest)
    {
        this.item = item;
        this.rest = rest;
    }

    public static void QSortInPlace(ref MList xs)
    {
        if (xs == null) return;

        int pivot = xs.item;
        MList pivotNode = xs;
        xs = xs.rest;
        pivotNode.rest = null;
        // partition the list into two parts
        MList smaller = null; // items smaller than pivot
        MList larger = null; // items larger than pivot
        while (xs != null)
        {
            var rest = xs.rest;
            if (xs.item < pivot) {
                xs.rest = smaller;
                smaller = xs;
            } else {
                xs.rest = larger;
                larger = xs;
            }
            xs = rest;
        }

        // sort the smaller and larger lists
        QSortInPlace(ref smaller);
        QSortInPlace(ref larger);

        // append smaller + [pivot] + larger
        AppendInPlace(ref pivotNode, larger);
        AppendInPlace(ref smaller, pivotNode);
        xs = smaller;
    }

    public static void AppendInPlace(ref MList xs, MList ys)
    {
        if(xs == null){
            xs = ys;
            return;
        }

        // find the last node in xs
        MList last = xs;
        while (last.rest != null)
        {
            last = last.rest;
        }
        last.rest = ys;
    }

    public static string Show(MList xs)
    {
        if (xs == null) return "";
        else return xs.item.ToString() + " " + Show(xs.rest);
    }
} 
```

* * *

## 回答 #2

> 赞同：10
> 
> 时间：2009-04-20T12:47:50.510

当然，您可以使用普通链表实现排序功能。[合并排序](http://en.wikipedia.org/wiki/Merge_sort)可能是一个适合尝试的算法，它相当简单。

* * *

## 回答 #3

> 赞同：8
> 
> 时间：2009-04-20T12:59:05.977

最简单的选择可能是提取数据，以已经支持排序的机制（数组`List<T>`或`IEnumerable<T>`通过 LINQ）对其进行排序，然后使用排序后的数据重新构建链表。

如果您想编写自己的排序算法，那么您可能会发现它`Comparer<T>.Default`很有用（假设您使用的是泛型）。这应该允许您比较任何属于`IComparable<T>`或的项目`IComparable`。

顺便说一句 - 请注意 .NET 已经包含`LinkedList<T>`等；如果这只是为了学习等，那么很好;-p

* * *

## 回答 #4

> 赞同：3
> 
> 时间：2017-11-10T19:29:03.427

有些人（包括我）可能想[`LinkedList<T>`从 .net 库中排序。](https://msdn.microsoft.com/en-us/library/he2s3bh7(v=vs.110).aspx)

最简单的方法是使用 Linq，排序并最终创建一个新的链表。但这会产生垃圾。对于小型收藏，这不是问题，但对于大型收藏，它可能没有那么有效。

对于想要进行某种程度优化的人，这里是 .net 双向链表的通用就地快速排序实现。

此实现不拆分/合并，而是检查每个递归的边界节点。

```
/// <summary>
/// in place linked list sort using quick sort.
/// </summary>
public static void QuickSort<T>(this LinkedList<T> linkedList, IComparer<T> comparer)
{
    if (linkedList == null || linkedList.Count <= 1) return; // there is nothing to sort
    SortImpl(linkedList.First, linkedList.Last, comparer);
}

private static void SortImpl<T>(LinkedListNode<T> head, LinkedListNode<T> tail, IComparer<T> comparer)
{
    if (head == tail) return; // there is nothing to sort

    void Swap(LinkedListNode<T> a, LinkedListNode<T> b)
    {
        var tmp = a.Value;
        a.Value = b.Value;
        b.Value = tmp;
    }

    var pivot = tail;
    var node = head;
    while (node.Next != pivot)
    {
        if (comparer.Compare(node.Value, pivot.Value) > 0)
        {
            Swap(pivot, pivot.Previous);
            Swap(node, pivot);
            pivot = pivot.Previous; // move pivot backward
        }
        else node = node.Next; // move node forward
    }
    if (comparer.Compare(node.Value, pivot.Value) > 0)
    {
        Swap(node, pivot);
        pivot = node;
    }

    // pivot location is found, now sort nodes below and above pivot.
    // if head or tail is equal to pivot we reached boundaries and we should stop recursion.
    if (head != pivot) SortImpl(head, pivot.Previous, comparer);
    if (tail != pivot) SortImpl(pivot.Next, tail, comparer);
} 
```

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2009-05-13T15:04:05.070

这可能不是最好的解决方案，但它就像我能想到的一样简单。如果有人能想到一些更简单但仍然很快的东西，我很想听听。
抱歉，它应该翻译成 C++。

```
List * SortList(List * p_list)
{
     if(p_list == NULL || p_list->next == NULL) 
          return p_list;

     List left, right;
     List * piviot = p_list;
     List * piviotEnd = piviot;
     List * next = p_list->next;
     do
     {
              p_list = next;
              next = next->next;
              //FIGURE OUT WHICH SIDE I'M ADDING TO.
              if(p_list->data > piviot->data ) 
                  right.InsertNode(p_list);
              else if(p_list->data < piviot->data)
                  left.InsertNode(p_list);
              else
              {   //we put this in it's own list because it doesn't need to be sorted
                  piviotEnd->next = p_list;
                  piviotEnd= p_list;
              }  
     }while(next);

     //now left contains values < piviot and more contains all the values more
     left.next = SortList(left.next);
     right.next = SortList(right.next);

     //add the piviot to the list then add the rigth list to the full list
     left.GetTail()->next = piviot;
     piviotEnd->next = right.next;

     return left.next;
} 
```

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2011-10-20T16:38:17.847

```
for(int i=0; i<counter;i++)
{
  while(current.next!=null)
  {
    if(current.elemen>current.next.element)
    {
      Swap(current.elment,current.next.element);
    }
    current=current.next;
  }
} 
```

increment counter when you add or insert elements to your linked lists

* * *

## 回答 #7

> 赞同：0
> 
> 时间：2016-11-22T11:33:56.960

如果您想真正利用您正在使用链表的事实，而不是解决它，我建议您使用插入排序。

通常插入排序不是很有效 -`O(n^2)`在最坏的情况下，但使用链表可以将其改进为`O(n log n)`

伪：

```
for i in range (1,n):
    item = arr[i]
    location = binary_search(l=root, r=i, value=item.val)  // O(log i)
    insert_item_before(arr[location], item) // O(1) 
```

在常规算法中，插入部分采用`O(i)`，因为我们可能需要移动所有大于 的项目`item`。因为链表使我们能够在不移动的情况下进行插入，所以我们可以使用二分搜索来搜索位置，因此插入部分只需要`O(log i)`

注意：通常插入排序`O(n)`在最好的情况下具有性能（如果数组已排序）。不幸的是，这里不是这种情况，因为二进制搜索总是需要一些`O(log n)`步骤。

* * *

## 回答 #8

> 赞同：0
> 
> 时间：2017-06-18T09:40:52.280

```
public LinkedListNode<int> Sort2(LinkedListNode<int> head, int count)
    {
        var cur = head;
        var prev = cur;
        var min = cur;
        var minprev = min;

        LinkedListNode<int> newHead = null;
        LinkedListNode<int> newTail = newHead;

        for (int i = 0; i < count; i++)
        {
            cur = head;
            min = cur;
            minprev = min;

            while (cur != null)
            {
                if (cur.Value < min.Value)
                {
                    min = cur;
                    minprev = prev;
                }
                prev = cur;
                cur = cur.Next;
            }

            if (min == head)
                head = head.Next;
            else if (min.Next == null)
                minprev.Next = null;
            else
                minprev.Next = minprev.Next.Next;

            if (newHead != null)
            {
                newTail.Next = min;
                newTail = newTail.Next;
            }
            else
            {
                newHead = min;
                newTail = newHead;
            }
        }
        return newHead;
    } 
```

# java - 在文本文件中维护外部数据库

> ID：768105
> 
> 赞同：-2
> 
> 时间：2009-04-20T12:47:48.810
> 
> 标签：java, database, logging, network-programming, text-files

维护基于 txt 的数据库文件的最简单方法是什么，该文件允许程序在执行期间写入新条目或编辑现有条目。

具体来说，程序必须能够在登录时存储客户端、IP 和端口，并在客户端注销时相应地删除，而不使用链表等“内部”方法。

编辑：首先感谢建议，但是我忘记提及的文件中有一个限制，该文件必须为 .txt 格式。

确切的格式是

> 用户名 IP 地址 端口号
> 
> 爱丽丝 122.33.44.23 1045
> 
> 鲍勃 121.23.12.34 1078

哪些不同的字段必须用 a 分隔

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-04-20T12:51:20.177

您可能想查看[JSON](http://www.json.org/java/)、[Yaml等数据序列化方法或](http://jyaml.sourceforge.net/)[SQLite](http://www.zentus.com/sqlitejdbc/)等轻量级（基于文件但非人类可读的）数据库。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2009-04-20T13:40:48.013

正如其他几位海报所建议的那样，安装数据库将为您带来某些东西，例如事务安全性和扩展存储内容的可能性（目前，您只需要 IP/端口，但也许稍后您会存储更多东西，也许更永久？）

但是，如果您的要求仍然像您所说的那样简单，那么我将有争议地建议使用 SQL 数据库*不是*最简单的解决方案（尽管，正如我所说，对于某些要求，数据库确实可以购买你某些事情）。

一个非常简单的解决方案是简单地创建一个目录，每次客户端登录时，您都会在其中创建一个文件，该文件的名称编码您想要的信息（或识别信息的哈希，并在文件中存储额外信息）。然后，当客户端注销时，您删除该文件。您需要注意的问题包括当您的应用程序异常退出时会发生什么，如果您有超过几千个客户端，则会在多个目录中拆分（如果您的文件太多，Windows 似乎会变得很笨）一个目录，尽管原则上您应该能够存储任意数量的文件），并管理文件系统“问题”（病毒检查程序正在访问文件，就像您需要删除...）。

这个简单的解决方案实际上并不像听起来那么糟糕：归档系统实际上是为了有效地访问和索引事物而设计的，就像数据库一样。

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2009-04-20T16:11:41.427

最简单的方法是将其保存在某种数据库中。您尚未指定文件格式的要求，但显而易见的选择是 CSV 文本格式。

H2 数据库尤其支持[CSV 表](http://www.h2database.com/html/tutorial.html#csv)。

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2009-04-20T12:59:54.070

我也会使用具有将数据存储在文本文件中的模式的 hsql

[http://hsqldb.org/](http://hsqldb.org/)

db 文本文件仍然不是一个简单的 txt 文件，它包含一些带有数据的 sql 语句。[http://hsqldb.org/web/hsqlDocsFrame.html](http://hsqldb.org/web/hsqlDocsFrame.html)

示例 TEXT 数据库文件：

```
INSERT INTO YOUR_TABLE VALUES('CLIENT1','xyz', .....)
INSERT INTO YOUR_TABLE VALUES('CLIENT2','xyz', .....) 
```

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2009-04-20T13:25:34.197

我使用[JAXB](http://java.sun.com/developer/technicalArticles/WebServices/jaxb/)将中等大小的数据结构（例如列表）序列化为 XML 文件并返回。好处：

*   JAXB 是 Java SE 6 的一部分，不需要额外的库。
*   （反）序列化大约需要两行代码。
*   XML 是人类可读的。

当然，它不能替代任何真实的数据库。例如，数据中的任何更改都会迫使您重写整个文件——但对于小文件来说，这并不重要。有时需要的是简单性。

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2009-04-20T12:52:19.753

您可以使用 JDBC-ODBC 桥驱动程序并链接到基于文本的 ODBC 连接。

之后，您可以只使用 JDBC 来选择、插入、更新或删除文件上的条目。

但即使这样可行，我还是建议您使用[HSQL](http://hsqldb.org/)、[SQLite](http://www.sqlite.org/)或任何其他轻量级数据库。它将更快，更可靠。

祝你好运。

* * *

## 回答 #7

> 赞同：0
> 
> 时间：2009-04-20T13:13:43.243

它不是 Java，但 MySQL 支持 CSV 表类型。 [http://dev.mysql.com/doc/refman/5.1/en/csv-storage-engine.html](http://dev.mysql.com/doc/refman/5.1/en/csv-storage-engine.html)

MySQL 会处理所有困难的事情，例如锁定和多访问，但会给您留下一个无需 MySQL 即可直接读取的文件。

* * *

## 回答 #8

> 赞同：0
> 
> 时间：2009-04-20T13:24:24.370

我建议[JavaDB](http://developers.sun.com/javadb/)。许多功能，例如可用的嵌入式支持和移动支持。

# c# - ComboBox：选定的值保持焦点（蓝色）

> ID：768107
> 
> 赞同：4
> 
> 时间：2009-04-20T12:48:25.940
> 
> 标签：c#, .net

我制作了一个小示例程序来说明我的问题。该程序由一个表格组成，其中一个 TableLayoutPanel：tableLayoutPanel1，一个 NumericUpDown：硬币和一个 Button：翻转。当按下翻转时，tableLayoutPanel1 会动态填充 coin.Value 行。每行由一个 ComboBox 组成，其中包含“Heads”和“Tails”项。通过为每一行绘制一个随机数来选择这些项目之一。代码如下：

```
 namespace WindowsApplication1
    {
      public partial class Form1 : Form
      {
        public Form1()
        {
          InitializeComponent();     
        }

        private void draw_Click(object sender, EventArgs e)
        {
          tableLayoutPanel1.Controls.Clear();
          string[] results = { "Heads", "Tails" };
          int nCoins = Convert.ToInt32(coins.Value);
          Random random = new Random();
          for(int i = 0; i < nCoins; i++) {
            ComboBox coin = new ComboBox();
            coin.Items.AddRange(results);
            coin.SelectedIndex = random.Next(0, 2);
            tableLayoutPanel1.Controls.Add(coin, 0, i);
          }
       }
    }
 } 
```

我的问题是每个 ComboBox 中的选定项目都有焦点，即蓝色。我该如何阻止这种情况发生？我试过打电话 coin.SelectionLength = 0; 但这不起作用:-(。

提前谢谢任何答案！

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2009-04-20T13:08:20.260

您应该像这样将 DropDownStyle 设置为 DropDownList。然后，即使它具有焦点，它也永远不会显示蓝色突出显示，因为文本不可编辑（无论如何这是您想要的）。

```
coin.DropDownStyle = ComboBoxStyle.DropDownList; 
```

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2009-10-08T09:32:56.273

尝试这个：

```
public class CustomComboBox : ComboBox
{
    private const int WM_SIZE = 0x0005;

    protected override void WndProc(ref Message m)
    {
        base.WndProc(ref m);

        // A fix for ComboBoxStyle.DropDown mode.
        if (DropDownStyle == ComboBoxStyle.DropDown
            && (m.Msg & WM_SIZE) == WM_SIZE)
        {
            Select(0, 0);
        }
    }
} 
```

[请参阅：组合框调整大小奇数](http://social.msdn.microsoft.com/forums/en-US/winforms/thread/e04e9308-bff5-4fbb-8cd6-0b2cd957aa68/)

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2009-04-20T12:54:31.620

在设置所选项目之前尝试放置：

```
coin.CanFocus = false; 
```

或者在设置所选项目后通过聚焦其他内容来“模糊”元素：

```
coin.TopLevelControl.Focus(); 
```

**编辑1**：我不确定这是否适合您的情况，但我对此进行了测试，它似乎可以满足您的要求，或者主要是；您必须单击列表中的一个项目才能触发 SelectedIndexChanged 事件，但它仍然更接近：

**编辑 2**：我从编辑 1 中删除了代码。我认为现在可以使用了！

```
using System;
using System.Windows.Forms;

namespace WindowsFormsApplication1
{
    public partial class Form1 : Form
    {
        public Form1()
        {
            InitializeComponent();
            button1.Click += new EventHandler(button1_Click);
        }

        private void button1_Click(object sender, EventArgs e)
        {
            tableLayoutPanel1.Controls.Clear();
            string[] results = { "Heads", "Tails" };
            int nCoins = Convert.ToInt32(coins.Value);
            Random random = new Random();
            for (int i = 0; i < nCoins; i++)
            {
                ComboBox coin = new ComboBox();
                coin.SelectedIndexChanged += new System.EventHandler(this.comboBox1_SelectedIndexChanged);
                coin.Items.AddRange(results);
                coin.SelectedIndex = random.Next(0, 2);
                tableLayoutPanel1.Controls.Add(coin, 0, i);
            }
        }

        private void comboBox1_SelectedIndexChanged(object sender, EventArgs e)
        {
            this.ActiveControl = null;
        }

    }
} 
```

关键在`this.ActiveControl = null;`SelectedIndexChanged 事件的 " " 行。快乐编码！

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2018-12-02T15:46:40.910

只需对所有在调整大小时不想选择 Text 的 ComboBox 使用以下代码：

```
/// <summary>
/// Stop resizing of the Form from selecting ComboBox's text.
/// </summary>
/// <param name="sender"></param>
/// <param name="e"></param>
/// <remarks>Used for all ComboBox'es</remarks>
private void cbo_Resize(object sender, EventArgs e)
{
    ((ComboBox)sender).Select(0, 0);
} 
```

# wpf - 在 WPF/Silverlight 中是否可以绑定到类似 HTML 的 TableControl？

> ID：768124
> 
> 赞同：1
> 
> 时间：2009-04-20T12:53:21.373
> 
> 标签：wpf, silverlight, binding, itemscontrol

鉴于以下类别和子类别：

1.  动画（全家福、Calvin & Hobes、The Boondocks、Duck Tales、Looney Toons、Pink & The Brain）
2.  芝麻街（Oscar、Ernie & Bert、Kermit de Frog、Elmo、Cookie Monster、Grover）

我正在寻找一种将其（动态）呈现为行和列的方法，如下所示：

```
-------------------------------------------------- --
| 动画 |
-------------------------------------------------- --
| 居家男人 | 卡尔文和霍布斯 | 贫民窟 |
-------------------------------------------------- --
| 鸭子故事 | 鲁尼卡通 | 小指与大脑 |
-------------------------------------------------- --
| 芝麻街 |
-------------------------------------------------- --
| 奥斯卡 | 厄尼和伯特 | 克米特蛙 |
-------------------------------------------------- --
| 埃尔莫 | 饼干怪兽 | 格罗弗 |
-------------------------------------------------- --

```

P/S：我知道列表控件（ItemsControl、DataGrid、ListView 等），但似乎没有一个符合这个标准。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-04-20T13:21:59.040

您需要做的是创建一个查询，以某种方式按类别对您的项目进行分组（您已经拥有它，或者您可以使用 linq 通过 Group By ... Into 查询创建您的层次结构）。

然后，您可以使用绑定到查询结果的 ItemsControl，使用包含标题的 ItemTemplate 和另一个 ItemsControl 显示数据，后者的 ItemsPanelTemplate 设置为 WrapPanel 或 UniformGrid。

假设您设法在以下类中获取数据（抱歉，这里是 VB，但如果您需要，C# 不会太远）：

```
Public Class Category

    Private _Name As String
    Public Property CategoryName() As String
        Get
            Return _Name
        End Get
        Set(ByVal value As String)
            _Name = value
        End Set
    End Property

    Private _SubCategories As New List(Of SubCategory)
    Public Property SubCategories() As List(Of SubCategory)
        Get
            Return _SubCategories
        End Get
        Set(ByVal value As List(Of SubCategory))
            _SubCategories = value
        End Set
    End Property

End Class

Public Class SubCategory

    Private _Name As String
    Public Property SubCategoryName() As String
        Get
            Return _Name
        End Get
        Set(ByVal value As String)
            _Name = value
        End Set
    End Property

End Class

<ItemsControl ItemsSource="{Binding QueryResult}">
        <ItemsControl.ItemTemplate>
            <DataTemplate>
                <Border BorderThickness="1"
                        BorderBrush="Black">

                    <Grid>
                    <Grid.RowDefinitions>
                        <RowDefinition Height="Auto" />
                        <RowDefinition Height="Auto" />                            
                    </Grid.RowDefinitions>
                        <Border BorderThickness="1"
                                BorderBrush="Black">
                            <TextBlock Margin="2"
                                       Text="{Binding CategoryName}" />
                        </Border>
                            <ItemsControl Grid.Row="1"
                                          ItemsSource="{Binding SubCategories}">
                                <ItemsControl.ItemTemplate>
                                    <DataTemplate>
                                        <Border BorderThickness="1"
                                                BorderBrush="Black">

                                            <TextBlock Margin="2"
                                                       Text="{Binding SubCategoryName}" />
                                        </Border>
                                    </DataTemplate>
                                </ItemsControl.ItemTemplate>
                                <ItemsControl.ItemsPanel>
                                    <ItemsPanelTemplate>
                                        <UniformGrid Columns="3" />
                                    </ItemsPanelTemplate>
                                </ItemsControl.ItemsPanel>
                            </ItemsControl>
                    </Grid>
                </Border>
            </DataTemplate>
        </ItemsControl.ItemTemplate>
    </ItemsControl> 
```

这是一个非常粗糙的模板，您必须修改边框才能获得所需的内容，但这可以解决问题。

# windows-mobile - 防止 Pocket-PC 进入横向模式

> ID：768125
> 
> 赞同：2
> 
> 时间：2009-04-20T12:53:26.333
> 
> 标签：windows-mobile, compact-framework

我有一个仅适用于纵向模式的 Windows Mobile 应用程序（用 C# 编写）。无论如何以编程方式阻止系统自动将我的应用程序旋转到横向模式而无需更改 Windows Mobile 系统设置？

平台：Windows Mobile 6.1 Professional

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2009-04-20T15:18:19.010

这是一个坏、坏、坏的主意。该设备是用于运行多个应用程序的通用设备。该平台*不*应该成为您的应用程序的奴隶。这就像说您有一个只能以 640x480 运行的桌面应用程序，因此您应该能够将某人的 PC 锁定到该分辨率。

更好的解决方案是要么实际修复你的软件（喘气）以支持两个方向（你知道也有不同的分辨率以及方形屏幕设备，对吧？）或者让你的应用程序至少弹出某种的消息框，以在选择不支持的分辨率或方向时通知用户兼容性。

至于“如何”去做——你不能。旋转由显示驱动程序处理，特别是通过使用 DRVESC_SETSCREENROTATION 调用[ExtEscape](http://msdn.microsoft.com/en-us/library/ms908408.aspx)。在 PB 附带的标准[GPEFlat 驱动程序](http://msdn.microsoft.com/en-us/library/ms894677.aspx)中，它依次调用 DynRotate 并继续调用 SetRotation（您可以查看 eval 版本中的公共源代码，您真的想知道它是如何工作的）。

缺点是要拦截该调用，您必须创建一个替换显示驱动程序，或者至少创建一些作为驱动程序插入的垫片，然后再调用现有的驱动程序。这些都不会在托管代码中发生。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-04-20T13:09:32.673

不，即使有它也会涉及钩子，这在嵌入式设备上是一个非常非常糟糕的主意。

但是您*可以*将屏幕方向更改为您喜欢的任何方向，因为您显然知道它应该是什么。有关更多详细信息，请参阅[开发屏幕方向感知应用程序](http://msdn.microsoft.com/en-us/library/ms839354.aspx)->[更改屏幕方向](http://msdn.microsoft.com/en-us/library/ms839354.aspx#screen_orientation_awareness_topic2)。

编辑：刚刚意识到你被 C# / .NETCF 卡住了。不知道框架的那一部分，但我会在这里留下答案以供参考，也许它会为您指明正确的方向。当然，在 tat 文章中解释的概念仍然有效。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-04-20T13:26:01.980

什么版本的windows mobile？

您的应用程序是否将仅由可以控制硬件的受控用户组（例如内部公司应用程序）使用？

Windows mobile 支持不同的屏幕尺寸和方向。例如，设备可以设计为纵向、方形或横向屏幕。如果您不控制运行它的硬件，则设计为仅以纵向模式运行的软件可能会导致问题。

如果您确实想设置纵向模式，可以通过调用

```
SystemSettings.ScreenOrientation = ScreenOrientation.Angle0; 
```

这会将整个设备设置为纵向模式。如果您确实选择继续执行此操作，我建议您在表单激活事件中设置方向并在调整大小事件中检查方向。如果有人将其更改为横向，则当您的应用程序获得焦点时，这会将设备重置回纵向。

在应用程序启动时存储初始方向并在应用程序退出时将设备重新设置为此也可能很有用。

# oracle - 如何在数据库中归档日志文件？

> ID：768130
> 
> 赞同：0
> 
> 时间：2009-04-20T12:55:00.447
> 
> 标签：oracle, plsql

我需要有关在数据库中执行归档日志文件的帮助，而不是在下面的执行语句中逐个插入每个日志，有没有一种方法可以将所有日志一次包含在脚本中的一个语句中？

```
EXECUTE DBMS_LOGMNR.ADD_LOGFILE(LOGFILENAME => '/u02/arch/1_50662_581101112.arc'
,OPTIONS => DBMS_LOGMNR.NEW);
EXECUTE DBMS_LOGMNR.ADD_LOGFILE(LOGFILENAME => '/u02/arch/1_50706_581101112.arc' 
```

我需要挖掘一千多条日志以获得报告，并且将它们一一包含是不可行的。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2009-04-20T13:14:22.787

使用 SQL 和 sqlplus 将命令生成到假脱机文件

```
spool c:\temp\log.sql

    select 'EXECUTE DBMS_LOGMNR.ADD_LOGFILE(LOGFILENAME =>'''||name||'''||,OPTIONS =>   DBMS_LOGMNR.NEW);' 
from  v$archived_log;

spool off 
```

然后在sqlplus中执行spool文件

```
start c:\temp\log.sql 
```

编辑

有时使用匿名 PL/SQL 块更容易：

```
declare
begin
    for c in (select name from v$archived_log where name is not null)
    loop    
      EXECUTE IMMEDIATE 'begin DBMS_LOGMNR.ADD_LOGFILE(:1); end;' 
        USING c.name;    
    end loop;
end;
/ 
```

# jquery - Ajax 中的 jQuery 弹出窗口

> ID：768132
> 
> 赞同：0
> 
> 时间：2009-04-20T12:55:23.910
> 
> 标签：jquery, ajax, popup

我正在使用 jQuery 和[Ajax](http://en.wikipedia.org/wiki/Ajax_%28programming%29)。单击超链接时，要在弹出菜单中加载的关联文档可以正常工作。当我使用 Ajax 时，问题就来了。

### 我的代码

```
//index.html
....
jQuery.ajax({
    type: 'POST',
    url: ' my.php',
    data: 'one=' + one,

    success: function(data){
        jQuery("#another").load("load.html");

        //Pop up code for the Load.html
        jQuery("a[rel='pop']").click(function (e) {
            e.preventDefault();
            var features =  "height=700,width=800,scrollTo,resizable=1,scrollbars=1,location=0";
            newwindow=window.open(this.href, 'Popup', features);
            return false;
        });
    }//Success
}); //Ajax 
```

策略：看到超链接后，需要在弹窗中显示相关内容。

### 加载.html

```
<a href="pdf/file1.pdf" id="pop" rel="pop"> click 1.</a>
<a href="pdf/file2.pdf" rel="pop">click2</a> 
```

由于`Load.html`动态加载`index.html`，所有标签都与 PDF 文件的链接相关联，`load.html`文件不会在弹出窗口中显示文档。如何更改我的代码以执行上述输出？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-04-21T15:15:17.777

我认为您遇到的问题是您没有等待`load.html`通过 ajax 完成加载的内容。您需要为该调用设置回调，以便正确使用它的内容。

做这个：

```
//index.html
....
jQuery.ajax({
     type:'POST',
     url:' my.php',
     data:'one='+one,
     success: function(data){
         jQuery("#another").load("load.html", function() { 
             //pop up code for the Load.html
             jQuery("a[rel='pop']").click(function (e) {
                 e.preventDefault();
                 var features = "height=700,width=800,scrollTo,resizable=1,scrollbars=1,location=0";
                 newwindow=window.open(this.href, 'Popup', features);
                 return false;
             });//click
         }//load
     });//success
});//ajax 
```

据我了解，这应该可以解决您的问题。

# visual-studio-2005 - Visual Studio 2005 中网页中的元标记

> ID：768138
> 
> 赞同：0
> 
> 时间：2009-04-20T12:57:25.700
> 
> 标签：visual-studio-2005

在 Visual Studio 2003 中，元标记列在 head 部分本身中。

我在哪里可以找到 Visual Studio 2005 的 aspx 页面中的元标记？

也可以像在 Visual Studio 2005 中一样将 Visual Studio 2003 中的 html 解析器更改为 XHTML 解析器。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-04-20T13:18:15.930

解析/设计视图在 Visual Studio 2005 中被重写，在 2003 年无法获得该功能。元标记应始终进入头部，Visual Studio 2005 只是不添加所有这些默认元标记，如 Visual Studio 2003做了（这是一件好事）。

以下是有关 HTML 文件结构的更多信息：

[http://www.w3.org/TR/html401/struct/global.html](http://www.w3.org/TR/html401/struct/global.html)

# internet-explorer - IE 只能通过打印预览正确打印？

> ID：768140
> 
> 赞同：-1
> 
> 时间：2009-04-20T12:57:35.840
> 
> 标签：internet-explorer, printing

有没有人遇到过 Internet Explorer 无法正确打印页面的问题，除非我通过打印预览？如果我直接点击打印，或者页面上的打印按钮，它会打印两页，第一页只有标题，第二页是空白的。

如果我通过打印预览，它会显示页面的正确格式，如果我从打印预览打印，它也会正确打印出来。

该页面确实有一些特定于打印的 CSS，但我不明白这将如何导致问题？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2010-02-17T21:12:21.750

我遇到了同样的问题。添加以下元数据强制它回到 IE7 标准渲染模式为我修复了它。

```
< meta http-equiv=X-UA-Compatible" content="IE=7"> 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-04-20T12:58:54.073

可能是打印预览将 Letter 显示为默认值但当您点击打印时它使用 A4 作为默认值的问题。（A4 为 210x297，字母较大）

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-08-18T17:33:26.443

这里同样的问题。在 IE7 中正确打印了数千页，然后升级到 IE8，除非我进行打印预览，否则只打印第一页。已为我的打印工作切换到 Mozzilla。（PS 它确实可以正确打印一些多页网站，但不是我为使用 IE7 打印了数千页的网站）。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2010-03-02T16:04:12.013

我也遇到过同样的问题。打印预览是我发现的唯一解决方法。您如何向 Microsoft 提交错误请求？

# sharepoint - SharePoint - 以编程方式添加列表项并设置 ID

> ID：768156
> 
> 赞同：3
> 
> 时间：2009-04-20T13:01:41.647
> 
> 标签：sharepoint, sharepoint-2007

我需要在 sharepoint 中创建列表项，还需要设置 ID 字段。但是，尝试执行此操作时出现错误，因为它是只读的。以编程方式在共享点列表中创建项目时，有没有办法可以设置 ID 列值？

作为旁注，我需要这样做的原因是因为我需要将项目添加到两个共享点列表中，其中第二个使用第一个的 id 列作为查找。

谢谢

卡姆兰

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2009-04-20T16:13:11.000

正如您已经提到的，列表项的 ID 被标记为只读。我认为没有办法解决这个问题。

我认为最简单的解决方案是在第二个列表中添加一个新列，该列表使用第一个 ID 列进行查找。那么列表一和列表二中的项目仍然有两个不同的 ID，但您可以通过列表二中的第二列引用它们。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2017-06-28T11:14:48.220

我正在处理类似的项目，我选择坚持使用 OOB Id 字段，只是为两个列表自定义了带有自定义表单的新编辑和显示表单，还删除了所有列表项并重新索引了两个列表，这对我来说是自定义的新表单在两个列表中创建了列表项，视图和显示表单仅基于 listItem Id 字段加载了 listItem。
这样做的需要是在创建项目时某些字段应该是可编辑的，而有些字段在这两个列表中不那么分开并分别管理权限。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2020-09-03T14:40:36.310

我在遥远的过去使用 ReserveListItemId 完成了此操作，您可以在其中增加下一个列表项 ID 指针，然后再创建一个。

[https://docs.microsoft.com/en-us/previous-versions/office/sharepoint-server/jj862551(v=office.15)](https://docs.microsoft.com/en-us/previous-versions/office/sharepoint-server/jj862551(v=office.15))

这里的文档毫无价值，但我很确定这是你的起点。

# c# - .NET Compact 框架 (C#)：将复选框添加到列表框

> ID：768157
> 
> 赞同：1
> 
> 时间：2009-04-20T13:01:43.473
> 
> 标签：c#, compact-framework, listbox, checkbox

我想将复选框控件添加到列表框控件。

列表框必须包含几个任务，我必须检查之前是否打开过任务。

我有一个代码示例，但它将复选框添加为对象，而不是控件

```
while (reader.Read())   
{                    
   CheckBox c = new CheckBox().Enabled = false;
   c.Text = reader.GetString(0) + ". " + reader.GetString(1);

   try 
   { 
      if (int.Parse(reader.GetString(2)) > 1) c.Checked = true; 
   } 
   catch(Exception ex)    
   {

      MessageBox.Show(ex.Message);    
   }    
   listTasks.Items.Add(c);
} 
```

有人可以帮我吗

谢谢，鲁本

* * *

## 回答 #1

> 赞同：12
> 
> 时间：2009-04-20T13:11:50.827

Compact Framework 不支持 CheckedListBox 控件。您可以使用将[CheckBoxes](http://msdn.microsoft.com/en-us/library/system.windows.forms.listview.checkboxes.aspx)属性设置为 true的[ListView 。](http://msdn.microsoft.com/en-us/library/system.windows.forms.listview.aspx)

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-04-20T13:07:04.677

列表框仅支持字符串 ListItems 的集合。

以这种方式向其添加复选框将导致出现 checkbox.ToString() 值。

您可能想查看“CheckedListBox”控件，但我不确定 CompactFramework 中是否存在该控件。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2011-11-15T03:43:16.100

[Resco Mobileforms Toolkit](http://www.resco.net/developer/mobileformstoolkit/details.aspx?comp=SmartGrid&p=WindowsMobile)允许您执行此操作。该软件包不是，但它确实具有此功能（以及使 CF 应用程序感觉比标准 Windows Mobile 应用程序好得多的一些其他有用的位）。

*注意我知道这个问题很久以前就被问过了，但我们最近被要求为其中一种设备编写新软件，所以我认为即使您不再需要解决这个问题，还有其他可能会受益的问题由此。*

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2011-11-15T14:15:25.903

使用库存控件的唯一其他选择是使用 Panel 并手动执行布局，并将 AutoScroll 设置为 true。您可以将 Panel 子类化以公开您自己的 Add/Remove 类型方法，以便在添加和删除 Items 时执行布局。您可以使用类似下面的样本来布局列表。使用这种方法，您现在可以使用任何类型的控件来组成列表，但您会失去 ListBox 的编程便利性。我想您可以在必要时将此类功能添加到 Panel 子类中。

```
 public static void VerticalListLayoutStrategy(Panel panel)
    {
        int top = 0;
        foreach (Control control in panel.Controls)
        {
            control.Location = new Point(0, top);
            control.Width = panel.ClientSize.Width;
            top += control.Height;
        }
    } 
```

# mono - 有人使用 uClibc 为 MIPS 64 交叉编译 Mono 吗？

> ID：768160
> 
> 赞同：5
> 
> 时间：2009-04-20T13:04:23.107
> 
> 标签：mono, mips, embedded-linux, uclibc

我正在尝试为 MIPS 静态交叉编译 Mono。我能够编译 Mono，但它总是与它的依赖项动态链接，即使我为编译器指定了静态。

我写了一个测试程序，我可以用我的工具链静态编译它并在目标平台上运行它。我不确定我是否遗漏了某些东西，或者这是不可能的。我使用[buildroot](http://buildroot.uclibc.org/)构建了我的工具链。

**编辑**

为了让事情更清楚一点，我想用它的依赖项静态编译单声道。mono 依赖的依赖项是：GLib、pkg-config 和 gettext。我相信 GLib 是一个直接依赖项，而 GLib 依赖于 pkg-config 和 gettext。

如果需要，我可以发布我的环境变量和配置命令。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-04-22T20:05:06.777

为了获得完全静态链接的 Mono，您必须首先将其所有依赖项（及其递归依赖项）构建为静态库。只有这样你才能构建一个真正静态的 Mono。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-07-22T13:16:16.720

好吧，自从我尝试这个已经有一段时间了，但我想报告我学到的东西。一方面，我发现 MIPS 处理器是 64 位的，而不是 32 位的，就像我最初告诉我的目标嵌入式设备一样。其次，当我研究这个时，Mono 还没有 MIPS 64 位支持。经过一番研究，我看到[N-iX](http://www.n-ix.com)的一个小组正在移植 Mono 以支持基于已经完成的 32 位端口的 MIPS 64 位架构。64 位端口正在为一家名为[SiCortex, Inc.](http://sicortex.com)的公司完成，N-iX 正试图将他们的补丁应用到主要的 Mono 开发主干。您可以查看此[论坛主题](http://www.nabble.com/-PATCH--Mono-port-to-the-MIPS-64-bit-to23175539ef1367.html#a23175539)以获取更多信息。我发帖说我想帮助测试，但我从来没有得到回应。

至于静态编译 Mono，我了解到 Mono 使用[libtool](http://www.gnu.org/software/libtool/)将其库链接在一起。在尝试静态编译之前，我需要了解有关此工具的更多信息。在得知 Mono 还不支持 MIPS 64 位后，我停下了脚步。我还需要查看 64 位端口补丁是否曾经应用于 Mono。

我希望这有帮助。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-09-08T11:10:41.507

在最近的一个 stackoverflow 播客中，Miguel 说他们将 Mono 移植到 iPhone，我认为使用了很多静态。虽然不是 64 位，但它表明可以对 Mono 做一些讨厌的事情。

# crystal-reports - 水晶报表配置工具

> ID：768166
> 
> 赞同：4
> 
> 时间：2009-04-20T13:06:09.953
> 
> 标签：crystal-reports

我有一个包含 50 个奇数子报表的 Crystal 报表，每个子报表都有大量参数。将它从一个数据库切换到另一个数据库需要很长时间，因为 Crystal Reports IDE 坚持要求您为每个子报表输入所有参数。

我想知道是否可以在 C# 中编写一个快速工具来查看 rpt 文件中所有子报告的当前数据库配置，最好是切换到不同的数据库。

不幸的是（或幸运的是）我对 Crystal 对象模型没有太多经验——有人知道从哪里开始吗？

谢谢，乔恩。

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2009-04-20T13:32:28.407

这应该可以完成这项工作。显然在需要的地方替换密码和用户名。

```
Private Sub ProcessFile(ByVal FileName As String)
        Dim CR As Engine.ReportDocument = Nothing
        Try
            CR = New Engine.ReportDocument
            CR.Load(FileName, CrystalDecisions.Shared.OpenReportMethod.OpenReportByDefault)

            'Recurse thru Report
            RecurseAndRemap(CR)
            'Save File
            CR.SaveAs("OutPutFilePath")

        Catch ex As Exception
            MessageBox.Show(ex.Message)
        Finally
            If Not CR Is Nothing Then
                CR.Close()
                CR.Dispose()
            End If
        End Try
    End Sub

    Private Sub RecurseAndRemap(ByVal CR As Engine.ReportDocument)
        For Each DSC As CrystalDecisions.Shared.IConnectionInfo In CR.DataSourceConnections
            DSC.SetLogon("YourUserName", "YourPassword")
            DSC.SetConnection("YouServerName", "YourDatabaseName", False)
        Next

        CR.SetDatabaseLogon("YourUserName", "YourPassword")

        For Each Table As Engine.Table In CR.Database.Tables
            Table.LogOnInfo.ConnectionInfo.UserID = "YourUserName"
            Table.LogOnInfo.ConnectionInfo.Password = "YourPassword"
        Next

        If Not CR.IsSubreport Then
            For Each SR As Engine.ReportDocument In CR.Subreports
                RecurseAndRemap(SR)
            Next
        End If
    End Sub 
```

希望能帮助干杯本

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-04-20T13:27:45.703

在 VB6 中我们使用类似 next 的东西（旧代码的脏复制粘贴，从 CR6 逐步更新到 CR9），也许你可以得到一些想法：

```
For Each tmpTable In Report.Database.Tables
  Set CPProperties = tmpTable.ConnectionProperties
  CPProperties.DeleteAll
  CPProperties.Add "Provider", "SQLOLEDB"
  CPProperties.Add "Data Source", mServerName
  CPProperties.Add "Initial Catalog", mBaseName
  CPProperties.Add "User ID", mUserID
  CPProperties.Add "Password", mPassword
  CPProperties.Add "Server Name", mServerName
  CPProperties.Add "Server Type", "OLEDB"
  CPProperties.Add "DataBase", mBaseName
  tmpTable.SetTableLocation tmpTable.Location, "", ""
Next tmpTable
For Each tmpSection In Report.Sections
    For Each tmpObject In tmpSection.ReportObjects
        If TypeName(tmpObject) = "ISubreportObject" Then
            Set tmpReport = tmpObject.OpenSubreport()
            For Each tmpTable In tmpReport.Database.Tables
              Set CPProperties = tmpTable.ConnectionProperties
              CPProperties.DeleteAll
              CPProperties.Add "Provider", "SQLOLEDB"
              CPProperties.Add "Data Source", mServerName
              CPProperties.Add "Initial Catalog", mBaseName
              CPProperties.Add "User ID", mUserID
              CPProperties.Add "Password", mPassword
              CPProperties.Add "Server Name", mServerName
              CPProperties.Add "Server Type", "OLEDB"
              CPProperties.Add "DataBase", mBaseName
              tmpTable.SetTableLocation tmpTable.Location, "", ""
            Next tmpTable
        End If
    Next tmpObject
Next tmpSection 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-04-20T13:28:12.037

一些实验似乎解决了这个问题：

```
 private void Form1_Load(object sender, EventArgs e)
    {
        ReportDocument rd = new ReportDocument();
        rd.Load("Report.rpt");

        Explore(rd);

        foreach (ReportDocument sr in rd.Subreports)
        {
            Explore(sr);
        }
    }

    private void Explore(ReportDocument r)
    {
        foreach (IConnectionInfo con in r.DataSourceConnections)
        {
            if (!r.IsSubreport)
                Console.WriteLine("Main Report");
            else
                Console.WriteLine(r.Name);
            Console.WriteLine(con.DatabaseName);
            Console.WriteLine("-");
        }
    } 
```

# c# - DataGridView 反复重新创建列

> ID：768170
> 
> 赞同：4
> 
> 时间：2009-04-20T13:07:55.470
> 
> 标签：c#, .net, winforms, datagridview

在控件上分配属性时遇到问题`DataSource`。`DataGridView`My`DataSource`是 a `DataTable`，`DefaultView`并且正如预期的那样，列会自动在 中创建，`DataGridView`以匹配`DataTable`我分配时的列。

接下来发生的事情是，这些列似乎被`DataGridView`. 为什么会发生这种情况？

在表单的构造函数中：

```
//A DataTable is created with 5 columns
//The DataTable is populated with some rows.

myDgv.AutoGenerateColumns = true;
myDgv.DataSource = myDataTable.DefaultView;
// myDgv.ColumnAdded event is fired 5 times.
// WHY: myDgv.ColumnRemoved event is fired 5 times.
// WHY: myDgv.ColumnAdded event is fired 5 times.
// WHY: myDgv.ColumnRemoved event is fired 5 times.
// WHY: myDgv.ColumnAdded event is fired 5 times. 
```

* * *

**编辑：添加了一个（希望）自包含的示例。如果我在事件处理程序中设置断点，我会点击“添加”一次 6 次，点击“删除”一次 4 次。DataTable 包含 2 列，我从不要求在我的代码中删除任何列。**

```
using System;
using System.Collections.Generic;
using System.ComponentModel;
using System.Data;
using System.Drawing;
using System.Linq;
using System.Text;
using System.Windows.Forms;

namespace asdasdgf
{
    public class Form1 : Form
    {
        public Form1()
        {
            InitializeComponent();

            DataTable dt = new DataTable();
            dt.Columns.Add("Col1", typeof(int));
            dt.Columns.Add("Col2", typeof(string));

            foreach (int i in Enumerable.Range(0, 10))
            {
                var row = dt.NewRow();
                row["Col1"] = i;
                row["Col2"] = "stackoverflow";
                dt.Rows.Add(row);
            }

            dataGridView1.ColumnAdded += new DataGridViewColumnEventHandler(dataGridView1_ColumnAdded);
            dataGridView1.ColumnRemoved += new DataGridViewColumnEventHandler(dataGridView1_ColumnRemoved);

            dataGridView1.DataSource = dt.DefaultView;
        }

        void dataGridView1_ColumnRemoved(object sender, DataGridViewColumnEventArgs e)
        {
            // Break here
        }

        void dataGridView1_ColumnAdded(object sender, DataGridViewColumnEventArgs e)
        {
            // Break here
        }

        // Form1.Designer.cs contents:
        #region Windows Form Designer generated code
        private System.ComponentModel.IContainer components = null;
        private System.Windows.Forms.DataGridView dataGridView1;

        protected override void Dispose(bool disposing)
        {
            if (disposing && (components != null))
            {
                components.Dispose();
            }
            base.Dispose(disposing);
        }

        /// <summary>
        /// Required method for Designer support - do not modify
        /// the contents of this method with the code editor.
        /// </summary>
        private void InitializeComponent()
        {
            this.dataGridView1 = new System.Windows.Forms.DataGridView();
            ((System.ComponentModel.ISupportInitialize)(this.dataGridView1)).BeginInit();
            this.SuspendLayout();
            // 
            // dataGridView1
            // 
            this.dataGridView1.ColumnHeadersHeightSizeMode = System.Windows.Forms.DataGridViewColumnHeadersHeightSizeMode.AutoSize;
            this.dataGridView1.Location = new System.Drawing.Point(12, 41);
            this.dataGridView1.Name = "dataGridView1";
            this.dataGridView1.Size = new System.Drawing.Size(240, 150);
            this.dataGridView1.TabIndex = 0;
            // 
            // Form1
            // 
            this.AutoScaleDimensions = new System.Drawing.SizeF(6F, 13F);
            this.AutoScaleMode = System.Windows.Forms.AutoScaleMode.Font;
            this.ClientSize = new System.Drawing.Size(284, 264);
            this.Controls.Add(this.dataGridView1);
            this.Name = "Form1";
            this.Text = "Form1";
            ((System.ComponentModel.ISupportInitialize)(this.dataGridView1)).EndInit();
            this.ResumeLayout(false);

        }

        #endregion
    }
} 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-04-20T13:47:01.710

我有一个应用程序使用 DataGridView 来显示 DataTable 的内容，但我将它们链接如下：

```
dataGridView.DataSource = dataTable; 
```

你能试试这个吗？

编辑：

我在自动生成的代码中也有以下内容：

```
this.dataGridView.EditMode = System.Windows.Forms.DataGridViewEditMode.EditProgrammatically; 
```

不知道为什么这会有所作为。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-04-20T13:21:39.977

如果 myDgv.DataSource 已经设置为至少可以解释某些添加/删除操作的内容。当列在设计时已经存在时，同上。

因此，请确保您的网格是空的，并且在设计器中清除了 DataSource 属性。

**额外的：**

我运行了示例代码并可以确认它，但您可以通过将代码从构造函数移动到正常的 Form_Load 事件来减少（减半）疯狂。无论如何，这是正确的方法，我看到太多人混淆了ctor和Load。

但是每列仍然有 2 个添加和 1 个删除操作，恐怕我们将不得不订阅一些 DataGrid 的低效率。（DataSource.set() 中的某处）

**附加2：**

显然 AutoGenerateColumns 默认为 true，不能直接从属性窗口设置。我通过在设计时设置（然后清除）数据源来清除它。然后，使用清除的 AutoGenerateColumns 属性，

```
dataGridView1.AutoGenerateColumns = true;
dataGridView1.DataSource = dt.DefaultView; 
```

仅产生两个 Add 事件。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2009-04-20T14:04:09.890

几个月前在工作中，我们正在构建一个 Grid 控件，该控件将具有内置过滤功能（类似于 excel）。最初我们使用 datagridview 并围绕它构建。你现在提出的这个问题是我们这边的第一大刺！由于我们在下面使用了 DGV，并连接到它的事件以触发我们需要做的各种事情，这绝对是一场噩梦。DGV 是一个很好的控制，但在幕后它做了一些不稳定的嘘**！一天结束时最好的解决方法是自己自动生成列。是的，这很痛苦，但至少我们可以完全控制。

不过，在我们的最终版本中，我们最终一起解决了这些问题，并采用了继承路线。我们从 DGV 继承下来，它让我们的生活变得更加轻松。现在，我不确定您要在这里完成什么，但是如果您要构建自己的网格，请先尝试继承！至于你的问题的答案，你没有做错任何事。datagridview 就是这样古怪。如果您没有围绕 DGV 构建控件，并且只需要这些事件，我说尽量远离添加/删除的列。看看您是否可以改用 bindingcompleted 。

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2009-04-24T12:59:10.533

经过大量的摆弄，这似乎是要走的路。

在表单的`Load`事件处理程序中：

```
dgv.AutoGenerateColumns = false;
dgv.DataSource = myDataSource; 
```

在表单的`Shown`事件处理程序中：

```
dgv.AutoGenerateColumns = true; 
```

`ColumnAdded`为每列提供一次触发事件的期望结果，并且`ColumnRemoved`根本不触发事件。（如果在事件处理程序中设置了 AutoGenerateColumns = true `Load`，它将执行这种烦人的添加-删除-添加舞蹈。）

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2012-03-21T19:10:41.070

我有一个解决方案！选择窗体或用户控件并将 Localizable 属性的值更改为 true。编辑 resx 文件并禁止 UserAddedColumn 条目。然后选择您的数据网格并选择“修改列”。禁止自动添加的所有列。将 Localizable 的值重置为 false。这样做自动添加的列永远不会回到我的网格上。

也许您需要保存表单/用户控件并在每个操作之间关闭设计选项卡。

# python - 在赋值中提供后备值的最 Pythonic 方式是什么？

> ID：768175
> 
> 赞同：29
> 
> 时间：2009-04-20T13:10:00.693
> 
> 标签：python

在 Perl 中，能够分配一个对象通常很好，但如果要分配的变量是“undef”，请指定一些备用值。例如：

```
my $x = undef;
my $y = 2;
my $a = $x || $y; 
```

在这之后，

```
$a == 2 
```

如果值 x 为 None，是否有一种简洁的方法可以在 Python 中实现这一点，或者完全...

```
if x is not None
    a = x
else
    a = y 
```

...成为实现这一目标的最 Pythonic 方式？

编辑：抱歉，正如几位评论者所指出的那样，我并没有真正谈论未定义的值，而是 Perl 中的“undef”，这并不是一回事。但最初措辞的问题并没有说明这一点。

* * *

## 回答 #1

> 赞同：52
> 
> 时间：2009-04-20T13:13:49.623

从 2.5 开始：

**如果**您只想依靠无：

```
a = x if x is not None else y 
```

如果您还想使用空字符串`false`，`0`等等：

```
a = x if x else y 
```

或者

```
a = x or y 
```

* * *

至于未定义（从未定义，又名未绑定）：

```
try:
  a = x 
except NameError:
  a = y 
```

或者更骇人听闻（我真的不建议这样做，但它很短）：

```
a = vars().get('x',y) 
```

* * *

## 回答 #2

> 赞同：6
> 
> 时间：2009-04-20T13:15:59.070

首先，您可以使用三元组来全力以赴：

```
a = y if x is None else x 
```

但这并不能解决您的问题。您想要做的是更紧密地实施：

```
try:
    a = x
except:
    a = y 
```

* * *

## 回答 #3

> 赞同：4
> 
> 时间：2009-04-20T16:26:17.913

只是对您的 Perl 示例进行一些吹毛求疵：

```
my $x = undef; 
```

这个冗余代码可以缩短为：

```
my $x; 
```

以下代码并没有按照您所说的那样做：

```
my $a = $x || $y; 
```

*当 $x 为false*时，这实际上将 $y 分配给 $a 。假值包括`undef`、零和空字符串。要仅测试定义性，您可以执行以下操作（从 Perl 5.10 开始）：

```
my $a = $x // $y; 
```

* * *

## 回答 #4

> 赞同：3
> 
> 时间：2009-04-20T15:05:27.530

我非常相信没有“pythonic”的方法可以做到这一点，因为这不是pythonic的模式。控制不应该在优雅的代码中到达未定义的变量引用。有类似的想法是pythonic。最明显的：

```
def myRange(start, stop=None):
    start, stop = (0, start) if stop is None else (start, stop)
    ... 
```

重要的是它`stop`在范围内定义，但调用者不必显式传递它，只是它采用了它的默认值，改变了参数的语义，这实际上导致第一个参数是可选的而不是其次，即使没有这个聪明的技巧，语言也不允许这样做。

话虽如此，这样的事情可能会在不使用 try-catch 块的情况下遵循前提。

```
a = locals().get('x', y) 
```

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2009-04-20T13:14:24.537

有python的三元运算：

```
a = x if x is not None else y 
```

在 2.5 及更高版本中可用。

* * *

## 回答 #6

> 赞同：1
> 
> 时间：2009-04-20T13:15:27.683

我认为这会有所帮助，因为问题归结为检查是否定义了变量：
[检查该变量是否在 python 中定义的简单方法？](https://stackoverflow.com/questions/750298/easy-way-to-check-that-variable-is-defined-in-python)

* * *

## 回答 #7

> 赞同：0
> 
> 时间：2009-04-20T14:49:03.277

大多数依赖 if 语句的解决方案不适用于 x 为 0 或负数的情况。

```
>>> x = 0
>>> y = 2
>>> a = x or y
>>> a
2
>>> 
```

如果您提前知道变量的名称，您可以像这样查找：

```
if 'x' in dir():
    a = x 
except:
     a =y 
```

然而，这个解决方案对我来说似乎有点草率。我相信最好的方法是使用 try except 块，如下所示：

```
try:
    a = x
else:
    a = y 
```

* * *

## 回答 #8

> 赞同：0
> 
> 时间：2009-04-20T18:40:33.300

重写的一种方法...

```
if x is not None
    a = x
else
    a = y 
```

..是：

```
x = myfunction()

if x is None:
    x = y

print x 
```

或者，使用异常（可能更多 Python'y，取决于代码在做什么 - 如果它返回 None 因为有错误，使用异常可能是正确的方法）：

```
try:
    x = myfunction()
except AnException:
    x = "fallback"

print x 
```

话虽如此，您的原始代码确实没有任何问题：

```
if x is not None
    a = x
else
    a = y 
```

它很长，但我发现它比以下任一单行代码更容易阅读（并且更 Pythonic）：

```
a = x if x is not None else y
a = x or y 
```

* * *

## 回答 #9

> 赞同：-1
> 
> 时间：2009-04-20T13:14:30.103

如果它是函数的参数，您可以这样做：

```
def MyFunc( a=2 ):
    print "a is %d"%a

>>> MyFunc()
...a is 2
>>> MyFunc(5)
...a is 5 
```

**[编辑]**对于downvoters.. if/else 位对于解决方案是不必要的 - 只是添加以使结果清晰。编辑它以删除 if 语句是否使它更清晰？

# visual-studio - VS 2008 设计师“找不到类型....”

> ID：768179
> 
> 赞同：2
> 
> 时间：2009-04-20T13:11:31.093
> 
> 标签：visual-studio, visual-studio-2008, compact-framework

我在移动桌面应用程序 .NET 3.5 中的 Visual Studio 2008 中遇到此错误。

找不到类型“MyNamespace.MyType”。请确保引用了包含此类型的程序集。如果此类型是您的开发项目的一部分，请确保该项目已成功构建。

这在打开表单时显示。它无法引用的类型是属于同一项目的用户控件。命名空间没有任何问题。这令人抓狂——项目构建得很好。

此外，引用的控件不是本文中的泛型类：[在 Windows 窗体设计器中加载窗体时出现“找不到类型”错误](https://stackoverflow.com/questions/9314/could-not-find-type-error-loading-a-form-in-the-designer)

**更新：**现在以后它似乎正在工作。这似乎是一个零星的问题......

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-04-20T13:15:33.207

是在 Form.designer.cs/vb 文件中导致问题的实际行吗？有时，名称限定问题会导致您看到的错误。尝试打开设计器文件并更改名称，如下所示

C＃

```
global::MyNamespace.MyType 
```

VB.Net

```
Global.MyNamespace.MyType 
```

之后，重建并重新打开设计器

# c++ - C/C++：如何将 6 位 ASCII 转换为 7 位 ASCII

> ID：768182
> 
> 赞同：2
> 
> 时间：2009-04-20T13:12:48.533
> 
> 标签：c++, c, ascii

我有一组 6 位代表 7 位 ASCII 字符。如何从我拥有的 6 位中获得正确的 7 位 ASCII 码？只需附加一个零并执行按位或？

谢谢你的帮助。

伦纳特

* * *

## 回答 #1

> 赞同：8
> 
> 时间：2009-04-20T13:15:12.037

ASCII 本质上是一个 7 位字符集，所以你所拥有的不是“6 位 ASCII”。哪些角色构成了您的角色集？最简单的解码方法可能是这样的：

```
char From6Bit( char c6 ) {
    // array of all 64 characters that appear in your 6-bit set
    static SixBitSet[] = { 'A', 'B', ... }; 
    return SixBitSet[ c6 ];
} 
```

脚注：6 位字符集在旧的 DEC 硬件上非常流行，其中一些，如 DEC-10，具有 36 位架构，其中 6 位字符有意义。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2009-04-20T13:16:59.397

您必须告诉我们您的 6 位字符集的外观，我认为没有标准。

进行反向映射的最简单方法可能是只使用查找表，如下所示：

```
static const char sixToSeven[] = { ' ', 'A', 'B', ... }; 
```

这假设空间编码为（二进制）000000，大写 A 编码为 000001，依此类推。

`sixToSeven`您使用其中一个 6 位字符进行索引，然后取回本地 7 位字符。

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2009-04-20T13:51:35.007

I can't imagine why you'd be getting old DEC-10/20 SIXBIT, but if that's what it is, then just add 32 (decimal). SIXBIT took the ASCII characters starting with space (32), so just add 32 to the SIXBIT character to get the ASCII character.

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2009-04-20T13:41:21.427

The only recent 6-bit code I'm aware of is base64\. This uses four 6-bit printable characters to store three 8-bit values (6x4 = 8x3 = 24 bits).

The 6-bit values are drawn from the characters:

```
ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/ 
```

which are the values 0 thru 63\. Four of these (say `UGF4`) are used to represent three 8-bit values.

```
UGF4 = 010100 000110 000101 111000
     = 01010000 01100001 01111000
     = Pax 
```

If this is how your data is encoded, there are plenty of snippets around that will tell you how to decode it (and many languages have the encoder and decoder built in, or in an included library). Wikipedia has a good article for it [here](http://en.wikipedia.org/wiki/Base64).

If it's *not* base64, then you'll need to find out the encoding scheme. Some older schemes used other lookup methods of the shift-in/shift-out (SI/SO) codes for choosing a page within character sets but I think that was more for choosing extended (e.g., Japanese DBCS) characters rather than normal ACSII characters.

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2009-04-20T13:19:33.617

如果我要给你一个比特的值，并且我声称它是从 Windows XP 中获取的，你能重建整个操作系统吗？

你不能。你丢失了信息。除非您对丢失的*内容*有所了解，否则无法重建它。如果您知道，例如，最高有效位被切断，那么您可以将其设置为零，并且您已经正确地重建了至少一半的字符。

如果您知道 'a' 和 'z' 在 6 位编码中是如何表示的，则可以通过将它们与它们的 7 位表示进行比较来猜测删除的内容。

# ruby-on-rails - 在 Rails 测试套件中使用工厂的优点和缺点？

> ID：768183
> 
> 赞同：2
> 
> 时间：2009-04-20T13:12:56.707
> 
> 标签：ruby-on-rails, ruby, testing, refactoring, factories

我目前正在查看一个庞大的 Rails 测试套件。我无法详细说明，但整个套件（单元/功能/某些集成）的运行时间可以超过 5 分钟。

我们完全依赖于固定装置，我们没有像我们应该做的那样嘲笑和存根。

我们接下来的几个 sprint 将完全专注于测试套件，既提高覆盖率，编写更好的测试，最重要的是编写更高效的测试。

因此，除了在我们的测试中进行更多的嘲笑和存根之外，我们正在考虑用最有可能的 Factory Girl 替换我们的固定装置。我看到很多快乐的人在做类似的情况，但一直找不到关于搬到工厂的任何缺点的好资源。在使用来自各种资源的基准时，我看到了一些较慢的基准，但无法确定为什么工厂很好，这就是为什么您可能不想使用它们的原因。

谁能告诉我为什么或为什么我不应该使用工厂？

谢谢！

* * *

## 回答 #1

> 赞同：11
> 
> 时间：2009-04-20T18:30:56.490

奥列格的回答很好，但让我提供一个同时使用两者的人的观点。

Fixtures have sort of been the whipping boy of the Rails community for a while. Everyone understands the drawbacks of fixtures, but no one is really championing their strengths. In my experience, factories by themselves can easily become just as difficult to maintain as fixtures (it really depends on the schema, but I digress). The real strength of factories is in selective replacement of fixture-based pain. Let's talk about a couple specifics.

The first issue is performance. If you can test most of your app without hitting the database then you will see a significant speed up, but for most applications I don't think it's wise to test without hitting the database entirely. At some point you want to test the whole stack. Every time you mock or stub you are making an assumption about an interface that may contain subtle bugs. So, assuming that you need to hit the database on some significant percentage of tests, transactional fixtures (you *are* using transactional fixtures right?) could well be much much faster than instantiating a whole environment for every test.

I'd say, with the size of your test suite that you really need to look towards [Continuous Integration](https://stackoverflow.com/questions/220668/continuous-integration-for-ruby-on-rails) to scale your development to the next level. No matter how much you speed them up, it's still a long time for developers to wait. Maybe look at [autotest](http://www.zenspider.com/ZSS/Products/ZenTest/) as well to help at the individual level. But ultimately CI is going to allow you to maintain testing discipline without sacrificing developer agility.

The place where fixtures really shine is in functional/integration testing. The way I look at it is that the fixtures should set up a healthy base state for the app to be tested. Most unit tests don't really need this. You can get very good unit coverage using factories. However when it comes to functional testing, any given page may be hitting dozens of models. I don't want to set up all that stuff in each test. As I construct ever more complex scenarios, I'm getting closer and closer to recreating a global data state which is *exactly* what fixtures were designed to do in the first place.

One controversial belief I hold is that all else being equal, I prefer one functional test to 20 unit tests (using Rails parlance). Why? Because the functional test proves that the end result that is sent to the user is correct. The unit tests are great for getting at nuances of functionality, but at the end of the day, you could still have a bug along an interface that breaks your entire site. Functional tests are what give me the confidence hitting deploy without actually loading up the page in my browser. I know that I could stub everything out and test both interfaces and get the same coverage, but if I can test the whole stack in one simple test at the expense of a little CPU, I'd much rather do that.

So what are my best practices for fixtures?

*   Set up a handful for every model to cover the broadest categories of data
*   When adding a major new feature that cuts across many models and controllers, add some new fixtures to represent the major states
*   Avoid editing old fixtures except for adding/removing fields
*   Use factories for more smaller/more localized variations
*   Use factories for testing pagination or other mass creation that is only needed for a few tests

Also, let me recommend [Jay Fields' blog](http://blog.jayfields.com/) for really good pragmatic testing advice. The thing I like most about Jay's blog is that he always acknowledges that testing is very project-specific, and what works for one project does not necessarily work for another. He's short on dogma and long on pragmatism.

* * *

## 回答 #2

> 赞同：6
> 
> 时间：2009-04-20T14:33:10.663

为良好的测试套件设置实体之间的所有依赖关系可能存在一些问题。无论如何，它仍然比维护很多固定装置要容易得多。

夹具：

*   难以维持关系（尤其是多对多）；
*   由于更多的数据库命中，测试套件运行时通常较慢；
*   测试对模式的变化非常敏感。

工厂：

*   您在当前单元测试中将未测试的所有内容存根；
*   您准备要与工厂一起测试的实体。这是工厂展示其真正优势的地方——设置新的测试用例很容易，因为您不需要为此维护大量的 YAML 文件；
*   你专注于测试。如果测试需要改变场景，你不要改变你的心态。只要存根合理且工厂易于定制，就可以了。

因此，工厂似乎是一个不错的选择。我看到的唯一可能的缺点是：

*   您从固定装置迁移所花费的时间；
*   保持一组理智的场景可能需要一些努力。

# ruby-on-rails - 上帝与莫尼特

> ID：768184
> 
> 赞同：59
> 
> 时间：2009-04-20T13:13:01.917
> 
> 标签：ruby-on-rails, ruby, monitoring, monit, god

哪一个用于过程监控，为什么？

* * *

## 回答 #1

> 赞同：50
> 
> 时间：2009-04-21T00:15:19.003

上帝的内存泄漏非常严重，所以我为我的 VPS 选择了 Monit。Monit 经常以大约 2MB 的 RAM 运行，而我在 Ruby 1.8.6 上运行的上帝安装在大约 36 小时内泄漏到大约 60MB 的 RAM。我不想监控我的系统监控工具，所以我放弃了上帝并转到 Monit 并且绝对没有问题。

* * *

## 回答 #2

> 赞同：48
> 
> 时间：2009-04-20T14:03:18.490

两种解决方案都很好，它们都有一些优点和缺点。

上帝的配置文件是用 Ruby 编写的，所以你基本上可以做 Ruby 允许你做的所有事情，而且它有很多东西。Monit 必须使用自己的语法进行配置，通常没问题，但限制更多。无论如何，您也可以使用 Ruby 生成监控配置（作为部署策略的一部分）。

此外，monit 使用的资源更少，因此如果您使用 VPS 或只是没有任何备用内存，则 monit 可能是更好的选择。就个人而言，我更喜欢上帝，因为它更具可配置性。

[这是关于上帝](http://railscasts.com/episodes/130-monitoring-with-god)的非常好的截屏视频。对此截屏视频的评论中也有很多反馈。

* * *

## 回答 #3

> 赞同：22
> 
> 时间：2009-04-29T00:51:33.953

上帝有很多问题，包括：

1.  它泄漏内存
2.  停止和重新启动进程时遇到问题

我在[http://blog.bradgessler.com/use-monit-with-rails-not-god上写了一篇关于它的文章](http://blog.bradgessler.com/use-monit-with-rails-not-god "Use Monit with Rails, Not God")

The only real problem with monit (if its a problem) is that the configuration files can get a bit verbose if you're running large clusters, but this could be solved with a templating system.

* * *

## 回答 #4

> 赞同：8
> 
> 时间：2009-04-24T18:28:06.250

甚至让上帝在我专用的 Ubuntu 服务器上运行我也遇到了很多问题。我最终只是放弃了。Monit 可能不是 Ruby，但它基本上没有麻烦。

* * *

## 回答 #5

> 赞同：6
> 
> 时间：2011-02-20T01:16:26.637

To anyone finding this post going forward, you might also consider [bluepill](https://github.com/arya/bluepill) as an alternative to God. While I'd hope that God has addresses its memory issues in the past two years, I know bluepill was set out from the beginning to run on a small footprint. While still not as small as monit, bluepill's footprint is very reasonable (~16 MB VIRT, 13 MB RES for me).

* * *

## 回答 #6

> 赞同：4
> 
> 时间：2010-09-01T20:47:54.923

Monit has its own issues:

*   Empty PID files cause issues.
*   If you have multiple levels of dependencies it starts up top level apps when lower level dependencies are started. This might be great for some use-cases, but its not particularly flexible.

At the moment I find it pretty annoying. Fortunately you can kinda kludge your way through the dependencies with their 'groups' feature, but its not particularly satisfying. Anyway, thats my take on v5.1.1

# php - 检查数据库中的空值 - 失败

> ID：768186
> 
> 赞同：3
> 
> 时间：2009-04-20T13:13:32.057
> 
> 标签：php, mysql

我正在从数据库中检索 3 个字段，默认情况下，只有用户名字段会有内容。其他信息将从用户应用程序中添加。如果字段中没有条目，我想将该字段显示为“无信息”。我试图同时使用 empty() 和 is_null() 都无济于事。$row['firstname'] 和 $row['lastname'] 的 var_dump 在这两种情况下都返回 NULL。

```
<?php
  if (isset($_GET["subcat"]))
  $subcat = $_GET["subcat"];
if (isset($_GET["searchstring"])) {
    $searchstring = $_GET["searchstring"];
}
$con = mysqli_connect("localhost","user","password", "database");
if (!$con) {
    echo "Can't connect to MySQL Server. Errorcode: %s\n". mysqli_connect_error();
    exit;
}
$table = 'USERS';
$brand = '%' . $searchstring . '%';
$rows = getRowsByArticleSearch($brand, $table);
echo "<table border='0' width='100%'><tr>" . "\n";
echo "<td width='15%'>Username</td>" . "\n";
echo "<td width='15%'>Firstname</td>" . "\n";
echo "<td width='15%'>Surname</td>" . "\n";
echo "</tr>\n";
foreach ($rows as $row) {
    if (is_null($row['firstname']) || $row['firstname'] == "") {
        $row['firstname'] == "No Info";
    }
    if ($row['lastname'] == null || $row['lastname'] == "") {
        $row['firstname'] == "No Info";
    }
    var_dump($row['firstname']);
    var_dump($row['lastname']);
    echo '<tr>' . "\n";
    echo '<td><a href="#" onclick="updateByUser(\''. $row['username'] .'\',\''.$subcat.'\')">'.$row['username'].'</a></td>' . "\n";
    echo '<td><a href="#" onclick="updateByUser(\''. $row['username'] .'\', \''.$subcat.'\')">'.$row['firstname'].'</a></td>' . "\n";
    echo '<td><a href="#" onclick="updateByUser(\''. $row['username'] .'\', \''.$subcat.'\')">'.$row['lastname'].'</a></td>' . "\n";
    echo '</tr>' . "\n";
}
echo "</table>\n";
function getRowsByArticleSearch($searchString, $table) {
    $con = mysqli_connect("localhost","user","password", "database");
    $recordsQuery = "SELECT username, firstname, lastname FROM $table WHERE lower(username) LIKE ? ";
    if ($getRecords = $con->prepare($recordsQuery)) {
        $getRecords->bind_param("s", $searchString);
        $getRecords->execute();
        $getRecords->bind_result($username, $firstname, $lastname);
        $rows = array();
        while ($getRecords->fetch()) {
            $row = array(
                            'username' => $username,
                            'firstname' => $firstname,
                            'lastname' => $lastname,
                        );
            $rows[] = $row;
        }
        return $rows;
    } else {
        print_r($con->error);
    }
} 
```

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2009-04-20T14:04:40.530

打开 display_errors 并将 error_reporting 设置为 E_ALL（在 php.ini 或 htaccess 中）。这应该揭示任何不明显的错误。

尝试以下方法检查是否为空：

```
<?php
if(!isset($row['...']) || empty($row['...']))
{
    $row['firstname'] = 'No Info';
}
?> 
```

另外，**请注意您使用 '==' 将 $row 设置为 'No Info'**。这样做是返回“真”（或 1）。使用单个“=”来设置变量。

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2009-04-20T14:00:07.000

首先和你的主要问题：

您在 $row['firstname'] == "No Info"; 中使用比较运算符 而不是赋值运算符 $row['firstname'] **=** "No Info";

其他问题：

*   为什么要建立两次连接？还是实际上多次？找到一种方法让你的函数知道连接！
*   将连接分解为包含。
*   如果可以直接访问返回的数组，为什么要这样做 while 循环？

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2009-04-20T13:41:29.773

有两件事要尝试...

```
if($row['field'] === NULL) { }

if(isset($row['field'])) { } 
```

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2017-12-14T11:27:58.020

**您可以使用is_null**属性 检查空数据。有关更多详细信息，请参阅此链接[http://php.net/manual/en/function.is-null.php](http://php.net/manual/en/function.is-null.php)

```
is_null($row['field']) 
```

采用

```
if(is_null($rows['field'])){
   // Code Here
}else{
  //code here
} 
```

# ascii - 使用 JAVACC 识别扩展字符

> ID：768189
> 
> 赞同：4
> 
> 时间：2009-04-20T13:13:43.663
> 
> 标签：ascii, javacc, extended-ascii

我正在使用 JavaCC 创建语法并且遇到了一个小问题。我试图允许生成的编译器识别 ASCII 扩展集中的任何有效字符。在查看了相同的 JavaCC 示例（主要是显示 JavaCC Grammer 本身的示例）之后，我设置了以下标记来识别我的字符：

```
< CHARACTER:

  (   (~["'"," ","\\","\n","\r"])
    | ("\\"
        ( ["n","t","b","r","f","\\","'","\""]
        | ["0"-"7"] ( ["0"-"7"] )?
        | ["0"-"3"] ["0"-"7"] ["0"-"7"]
        )
      )
  )

> 
```

如果我正确理解这一点，它应该匹配所有 ASCII 字符的八进制表示，从 0-377（涵盖扩展 ASCII 集中的所有 256 个字符）。这对所有键盘字符（az、0-9、?、./ 等）甚至大多数特殊字符（©、¬®）都按预期执行。但是，每当我尝试解析“商标”符号 (™) 时，我的解析器都会不断抛出 End of File 异常，表明它无法识别该符号。是否有一些明显的方法可以增强我对字符的定义以允许商标符号被接受？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2011-12-07T14:10:19.253

我在识别文本文件的特殊符号（CP1252 或 ISO-8859-1 编码）时遇到了类似的问题，该文件在解析之前被读取到字符串中。我的解决方案是添加`UNICODE_INPUT`到语法标题：

```
options {
  UNICODE_INPUT=true;
} 
```

工作就像微风一样。

有关 JavaCC 选项的更多信息：http: [//javacc.java.net/doc/javaccgrm.html](http://javacc.java.net/doc/javaccgrm.html)

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-04-20T17:06:19.220

事实证明，我希望我的语法接受所有有效的 Unicode 字符而不是 ASCII 字符，™ 符号是 Unicode 规范的一部分，而不是 ASCII 扩展字符集中的一部分。如下所述将我的令牌更改为有效字符解决了我的问题：（有效的 unicode 格式为 - U+00FF）

```
< CHARACTER:(   (~["'"," ","\\","\n","\r"])
| ("\\"
    ( ["n","t","b","r","f","\\","'","\""]
    | ["u","U"]["+"]["0"-"9","a"-"f","A"-"F"]["0"-"9","a"-"f","A"-"F"]["0"-"9","a"-"f","A"-"F"]["0"-"9","a"-"f","A"-"F"]
    )
  ) )> 
```

# nhibernate - 如何在 nHiberate 中创建只读会话？

> ID：768191
> 
> 赞同：16
> 
> 时间：2009-04-20T13:14:07.670
> 
> 标签：nhibernate

是否可以在 nHibernate 中创建只读连接？

只读：nHibernate 不会隐式或显式清除对底层数据库的任何更改。

关闭休眠连接时，它会自动清除对持久对象的更改。

将刷新模式设置为*从*不是一种方法——但它是可逆的（即某些代码可以重置刷新模式）。

* * *

## 回答 #1

> 赞同：14
> 
> 时间：2009-04-20T19:13:58.587

我认为您已经找到了解决方案，将刷新模式设置为从不。是的，它是可变的，但即使不是，代码也可以简单地创建另一个具有不同刷新模式的会话。

我认为适当的解决方案是*建议*只读`session.FlushMode = FlushMode.Never`并通过使用与仅具有 SELECT 权限的数据库的连接（或适合您的情况的任何内容）来*强制执行它。*维护单独的 ISessionFactory 工厂可能有助于通过允许类似`ReadOnlySessionFactory.Create()`.

* * *

## 回答 #2

> 赞同：6
> 
> 时间：2011-03-24T03:51:41.010

查看 NHibernate 3.1 GA 中可用的只读实体 [https://nhibernate.jira.com/browse/NH-908](https://nhibernate.jira.com/browse/NH-908)

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2015-07-29T12:43:57.000

NHibernate 中有一个较新的只读特性（我不知道是哪个版本，但它肯定在 3.3.0 中）。您可以使用以下方法将会话设置为只读：

```
session.DefaultReadOnly = true 
```

它禁用旧值的缓存，从而提高性能和内存消耗。

[NHibernate 参考文档](http://nhibernate.info/doc/nhibernate-reference/index.html)中有一个[关于只读实体](http://nhibernate.info/doc/nhibernate-reference/readonly.html)的章节。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2012-10-02T14:14:52.060

累积更新，只是从不刷新对我来说似乎是一个糟糕的解决方案。我发布了一个类似的问题。提供的解决方案使用了不同的方法。所有事件都设置为空，因此被忽略。我的感觉是，这是一种更好的方法。

我很惊讶这并不容易做到。我喜欢使用扩展方法 .AsNoTracking() 的实体框架方法，它确保只读查询保持这种状态。

[如何使用 Fluent NHibernate 创建一个不累积更新的 NHibernate 只读会话？](https://stackoverflow.com/questions/12667634/fluent-nhibernate-read-only-session)

# javascript - 访问未发送表单的值以用于 remote_function

> ID：768198
> 
> 赞同：0
> 
> 时间：2009-04-20T13:15:35.140
> 
> 标签：javascript, ruby-on-rails, ajax, rjs

我很好奇如何以干净的方式解决这个问题。我已经阅读了一些论坛帖子，但无法做一些有效的事情。

我有一个下拉列表——在更改时——应该更改 remote_function 的值。只有在启用了相应的单选按钮时才需要调用 remote_function。

```
select: download <-- should affect rjs call to get a list
select: upload <-- same thing.. 

o all  <-- hides list
o selected <-- rjs call to get a list
o none <-- hides list 
```

目前，它看起来像这样：

选择

```
form.select :is_download, {'Download' => true, 'Upload' => false} 
```

收音机

```
f.radio_button   :queue, 'selection', 
               { :onchange => remote_function( :url => { :action => 'show_queue' },
                 :with => "'is_download=[VALUE_SHOULD_BE_HERE]&id=#{@range.id}'" ) } 
```

目标： RJS 进行一些处理，并根据选择项的值从本地或远程将列表放入 div。

我对任何提示、链接或解决方案感到高兴。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-04-21T08:04:15.957

自己解决了。

我制作了两个单选按钮而不是选择，并将页面重新加载到包含所需参数的 onchange 中。

# php - 如何启用soap扩展

> ID：768204
> 
> 赞同：1
> 
> 时间：2009-04-20T13:17:03.827
> 
> 标签：php

是否可以在不编译 php dist 的情况下在 php 中启用soap扩展？我正在使用带有内置 php 解释器的 Mac OS X 10.5+。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-04-20T13:20:53.443

据我所知，您需要编译它，因为它是核心功能。但是您可以尝试将预编译的 php 包复制到现有的包上，以放置已编译的 soap 二进制文件，并将信息加载到适当的文件中。不要忘记进行备份！

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-04-21T00:40:16.570

如果你真的不想编译它，你可以使用 PEAR 的 NuSoap。

但如果我是你，我会编译它，nusoap 与内置的肥皂不兼容，而且很难兼顾。做对了，从 PHP5 SOAP 库开始。

艾伦

# php - 阿贾克斯问题？使用 activexobjects

> ID：768210
> 
> 赞同：5
> 
> 时间：2009-04-20T13:18:55.163
> 
> 标签：php, ajax, activex

我不断收到以下错误：

> 未捕获的异常：[异常...“组件返回失败代码：0x80004005 (NS_ERROR_FAILURE) [nsIXMLHttpRequest.send]”nsresult:“0x80004005 (NS_ERROR_FAILURE)”位置：“JS 框架 :: [http://site/cms/js/interface .js](http://site/cms/js/interface.js) :: doAjaxCall :: 第 300 行”数据：无]

> 未捕获的异常：[异常...“组件返回失败代码：0x80004005 (NS_ERROR_FAILURE) [nsIXMLHttpRequest.send]”nsresult:“0x80004005 (NS_ERROR_FAILURE)”位置：“JS 框架 :: [http://site/cms/js/interface .js](http://site/cms/js/interface.js) :: doAjaxCall :: 第 300 行”数据：无]

第 0 行

这是 doAjaxCall 的函数

```
function doAjaxCall(cmd,params) {
  var postdata='cmd='+cmd+'&params='+params;

  var a=sajax_init_object();
  if (a) {
    a.open("POST","ajax_handler.php", false);
    a.setRequestHeader("Content-Type", "application/x-www-form-urlencoded");
    a.send(postdata);                      <====Line 300
      document.body.style.cursor="default";

    if(a.readyState == 4) {
      return a.responseText;
    } else {
      alert("We where unable to execute the ajax call.");
    }
  }

function sajax_init_object() {
    var A;
    try {
        A=new ActiveXObject("Msxml2.XMLHTTP");
    } catch (e) {
        try {
            A=new ActiveXObject("Microsoft.XMLHTTP");
        } catch (oc) {
            A=null;
        }
    }
    if(!A && typeof XMLHttpRequest != "undefined")
        A=new XMLHttpRequest();
    if (!A)
        alert("Could not create connection object.");
    return A;
} 
```

有任何想法吗？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2010-10-17T14:33:19.713

由于 Javascript 的安全限制，无法通过 XMLHttpRequest 从远程域检索信息。我想你需要一个代理！

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2011-12-22T14:02:43.187

这是由于 MIME 类型：application/x-www-form-urlencoded

它适用于某些浏览器。它不适用于基于 Gecko 的浏览器（例如 Firefox）

在以下位置查看更多详细信息：[http ://ajaxpatterns.org/Talk:XMLHttpRequest_Call](http://ajaxpatterns.org/Talk%3aXMLHttpRequest_Call)

# php - PHP“漂亮的打印”HTML（不整洁）

> ID：768215
> 
> 赞同：30
> 
> 时间：2009-04-20T13:21:03.753
> 
> 标签：php, html, format, tidy

我正在使用 PHP 中的 DOM 扩展来构建一些 HTML 文档，并且我希望输出的格式很好（带有新行和缩进），以便它可读，但是，从我所做的许多测试中：

1.  "formatOutput = true" 对 saveHTML() 根本不起作用，只有 saveXML()
2.  即使我使用了 saveXML()，它仍然只适用于通过 DOM 创建的元素，而不是包含在 loadHTML() 中的元素，即使是“preserveWhiteSpace = false”

*如果有人知道不同，我真的很想知道他们是如何让它工作的。*

所以，我有一个 DOM 文档，我正在使用 saveHTML() 来输出 HTML。由于它来自 DOM，我知道它是有效的，因此无需“整理”或以任何方式验证它。

我只是在寻找一种方法来从我从 DOM 扩展收到的输出中获得格式良好的输出。

*注意。正如您可能已经猜到的那样，我不想使用 Tidy 扩展作为 a) 它做的更多我也需要它（标记已经有效）并且 b) 它实际上对 HTML 内容进行了更改（例如HTML 5 文档类型和一些元素）。*

**跟进：**

好的，在下面的答案的帮助下，我弄清楚了为什么 DOM 扩展不起作用。尽管给定的示例有效，但它仍然无法与我的代码一起使用。[在此](http://uk3.php.net/manual/en/domdocument.savexml.php#76867)评论的帮助下，我发现如果您有任何 isWhitespaceInElementContent() 为 true 的文本节点，则不会应用超出该点的格式。无论preserveWhiteSpace 是否为假，都会发生这种情况。解决方案是删除所有这些节点（尽管我不确定这是否会对实际内容产生不利影响）。

* * *

## 回答 #1

> 赞同：33
> 
> 时间：2009-04-20T14:04:47.207

你是对的，HTML 似乎没有缩进（[其他人也很困惑](http://bugs.php.net/bug.php?id=27783)）。XML 可以工作，即使是加载了代码。

```
<?php
function tidyHTML($buffer) {
    // load our document into a DOM object
    $dom = new DOMDocument();
    // we want nice output
    $dom->preserveWhiteSpace = false;
    $dom->loadHTML($buffer);
    $dom->formatOutput = true;
    return($dom->saveHTML());
}

// start output buffering, using our nice
// callback function to format the output.
ob_start("tidyHTML");

?>
<html>
    <head>
    <title>foo bar</title><meta name="bar" value="foo"><body><h1>bar foo</h1><p>It's like comparing apples to oranges.</p></body></html>
<?php
// this will be called implicitly, but we'll
// call it manually to illustrate the point.
ob_end_flush();
?> 
```

结果：

```
<!DOCTYPE html PUBLIC "-//W3C//DTD HTML 4.0 Transitional//EN" "http://www.w3.org/TR/REC-html40/loose.dtd">
<html>
<head>
<title>foo bar</title>
<meta name="bar" value="foo">
</head>
<body>
<h1>bar foo</h1>
<p>It's like comparing apples to oranges.</p>
</body>
</html> 
```

与 saveXML() 相同 ...

```
<?xml version="1.0" standalone="yes"?>
<!DOCTYPE html PUBLIC "-//W3C//DTD HTML 4.0 Transitional//EN" "http://www.w3.org/TR/REC-html40/loose.dtd">
<html>
  <head>
    <title>foo bar</title>
    <meta name="bar" value="foo"/>
  </head>
  <body>
    <h1>bar foo</h1>
    <p>It's like comparing apples to oranges.</p>
  </body>
</html> 
```

可能忘记在 loadHTML 之前设置 preserveWhiteSpace=false？

> [免责声明：我从tyson clugg/php 手动注释](http://www.php.net/manual/en/domdocument.savehtml.php#52139)中窃取了大部分演示代码。懒我。

* * *

> **更新：**我现在记得几年前我尝试过同样的事情并遇到了同样的问题。我通过应用一个肮脏的解决方法来解决这个问题（不是性能关键）：我只是以某种方式在 SimpleXML 和 DOM 之间转换，直到问题消失。我想转换摆脱了那些节点。也许用 dom 加载，用 导入`simplexml_import_dom`，然后输出字符串，再次用 DOM 解析它，*然后*打印出来。据我记得这有效（但它*真的很*慢）。

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2020-05-24T18:58:24.043

结果：

```
<!DOCTYPE html>
<html>
    <head>
        <title>My website</title>
    </head>
</html> 
```

请考虑：

```
function indentContent($content, $tab="\t"){
    $content = preg_replace('/(>)(<)(\/*)/', "$1\n$2$3", $content); // add marker linefeeds to aid the pretty-tokeniser (adds a linefeed between all tag-end boundaries)
    $token = strtok($content, "\n"); // now indent the tags
    $result = ''; // holds formatted version as it is built
    $pad = 0; // initial indent
    $matches = array(); // returns from preg_matches()
    // scan each line and adjust indent based on opening/closing tags
    while ($token !== false && strlen($token)>0){
        $padPrev = $padPrev ?: $pad; // previous padding //Artis
        $token = trim($token);
        // test for the various tag states
        if (preg_match('/.+<\/\w[^>]*>$/', $token, $matches)){// 1\. open and closing tags on same line - no change
            $indent=0;
        }elseif(preg_match('/^<\/\w/', $token, $matches)){// 2\. closing tag - outdent now
            $pad--;
            if($indent>0) $indent=0;
        }elseif(preg_match('/^<\w[^>]*[^\/]>.*$/', $token, $matches)){// 3\. opening tag - don't pad this one, only subsequent tags (only if it isn't a void tag)
            foreach($matches as $m){
                if (preg_match('/^<(area|base|br|col|command|embed|hr|img|input|keygen|link|meta|param|source|track|wbr)/im', $m)){// Void elements according to http://www.htmlandcsswebdesign.com/articles/voidel.php
                    $voidTag=true;
                    break;
                }
            }
            $indent = 1;
        }else{// 4\. no indentation needed
            $indent = 0;
        }

        if ($token == "<textarea>") {
            $line = str_pad($token, strlen($token) + $pad, $tab, STR_PAD_LEFT); // pad the line with the required number of leading spaces
            $result .= $line; // add to the cumulative result, with linefeed
            $token = strtok("\n"); // get the next token
            $pad += $indent; // update the pad size for subsequent lines
        } elseif ($token == "</textarea>") {
            $line = $token; // pad the line with the required number of leading spaces
            $result .= $line . "\n"; // add to the cumulative result, with linefeed
            $token = strtok("\n"); // get the next token
            $pad += $indent; // update the pad size for subsequent lines
        } else {
            $line = str_pad($token, strlen($token) + $pad, $tab, STR_PAD_LEFT); // pad the line with the required number of leading spaces
            $result .= $line . "\n"; // add to the cumulative result, with linefeed
            $token = strtok("\n"); // get the next token
            $pad += $indent; // update the pad size for subsequent lines
            if ($voidTag) {
                $voidTag = false;
                $pad--;
            }
        }           

    return $result;
}

//$htmldoc - DOMdocument Object!

$niceHTMLwithTABS = indentContent($htmldoc->saveHTML(), $tab="\t");

echo $niceHTMLwithTABS; 
```

将产生具有以下内容的 HTML：

*   基于“级别”的缩进
*   块级元素后的换行符
*   而内联和自闭合元素不受影响

该函数（这是我使用的类的一种方法）主要基于：[https ://stackoverflow.com/a/7840997/7646824](https://stackoverflow.com/a/7840997/7646824)

* * *

## 回答 #3

> 赞同：-1
> 
> 时间：2012-08-13T14:37:01.340

您可以使用[htmLawed](http://www.bioinformatics.org/phplabware/internal_utilities/htmLawed/index.php)库的[hl_tidy](http://www.bioinformatics.org/phplabware/sourceer/sourceer.php?&Sfs=htmLawed.php&Sl=.%2Finternal_utilities%2FhtmLawed)函数的代码。

```
// indent using one tab per indent, with all HTML being within an imaginary div
$out = hl_tidy($in, 't', 'div') 
```

# ajax - iframe 与 ajax

> ID：768222
> 
> 赞同：15
> 
> 时间：2009-04-20T13:22:16.047
> 
> 标签：ajax, iframe

假设我有一些选项卡（例如 jquery 选项卡）并且我想在每个选项卡中动态加载一些页面，我可以通过两种方式做到这一点

1.  使用 jquery ajax 选项卡（基本上用 ajax 数据填充 div）或
2.  每个选项卡都可以包含一个 iframe 和加载到其中的页面。

**Q1**。我认为两种用户方法之间没有区别，有吗？

**Q2**。我认为 iframe 方式更好，因为 iframe 可以加载任何页面，但有时将 ajax 数据加载到 div 中可能无法按预期工作。

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2009-04-20T13:32:50.153

一方面，在包含的页面（或 ajax 调用）中出现错误可能更好地使用 ajax 方法来处理。使用 iframe，您只会在页面中间收到丑陋的 404 或 500 错误。但是使用 ajax，您可以检测到错误并显示更用户友好的错误消息。

它还取决于您要加载到页面中的数据。如果您控制正在加载的 html，则可以避免或修复任何可能出现的显示问题。如果您需要加载您无法控制的页面，最好（或必须）使用 iframe。

任何一种方法都可能涉及可访问性问题，但我对此还不够熟悉，无法确定哪种方法最适合屏幕阅读器等。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2009-04-20T13:34:47.060

如果页面是您的内容，并且您可以控制样式表以及每个人访问的所有内容......然后选择第一个选项。您可以设计一些东西，这样您就不必多次检索共享内容。

如果页面超出您的控制（外部网站等），则将它们加载到 iFrame 中。您不必担心页面是否正确呈现等。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2011-03-31T12:46:35.020

通过混合 iframe 和 ajax，如果您的加载页面（页面 iframe 尝试加载）没有立即响应以产生一个空白块，则 iframe 可能会由于渲染而在大多数浏览器中停止其他 ajax 请求。

另一方面，iframe 更强大，你可以拥有堆栈框架，尤其是透明背景，而不用担心它的宽度或高度，它看起来就像没有框架的同一个页面。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2010-08-02T13:02:27.677

使用 iframe，如果从外部站点加载内容并且事先不知道宽度和高度，您可能会遇到滚动条问题。使用 ajax 和 DOM 操作，您将不会遇到这个问题。

这是我在特定情况下抛弃 iFrame 的唯一原因。报告从远程站点加载到 iframe 中的宽度和高度的非常hacky 的解决方案根本不值得麻烦。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2011-08-29T09:09:27.380

请注意您的源内容在哪里。如果它在您的域中，您可以使用 iframe 或 ajax 调用。但是，如果它位于不同的域中，则由于其“跨站点脚本”保护，您将无法使用 ajax。

我认为这是在 iframe 和 ajax 调用之间进行选择的主要方面。

# asp.net - ASP.NET 和对象

> ID：768223
> 
> 赞同：0
> 
> 时间：2009-04-20T13:22:28.527
> 
> 标签：asp.net, oop, object

假设我有一个类 Person，带有一个 string[] nickNames，其中 Person 可以存储 0 个或多个昵称。我想创建一个 asp.net 页面，用户可以在其中添加/编辑/删除昵称。
问题是 - 我如何在回发之间保留 Person 对象？我查询数据库并创建对象，然后将其显示在表单上，​​但随后用户可以选择编辑/删除该对象的字段。一旦页面显示人员的字段，我如何更新该对象用户所做的更改，存储到数据库？

谢谢！

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-04-20T13:28:37.527

好吧，如果您的 Person 对象是可序列化的，您可以将其存储在 ViewState 中，如果没有，您可以将其粘贴在 Session 中，但听起来您可能对数据持久性普遍缺乏了解

根据您的实现，以及您是手动编码还是使用内置的 DataSource/DataAdapter 控件，有很多方法可以做到这一点。

您可以查看一些基本的 ASP.NET/ADO.NET 教程，为您指明正确的方向

[http://aspnet101.com/aspnet101/tutorials.aspx?id=17](http://aspnet101.com/aspnet101/tutorials.aspx?id=17)

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-04-20T13:24:38.880

再次查询对象（您可以将其存储在会话变量中，但不会扩展），在回发时收集并应用来自用户的更改。

# class - C# - 为什么我不能投射列表 到从 List 继承的类 ?

> ID：768225
> 
> 赞同：0
> 
> 时间：2009-04-20T13:23:44.187
> 
> 标签：class, inheritance, list, compact-framework, c#-2.0

我有一个对象，我将其称为 MyObject。它是一个控制特定数据行的类。

然后我有一个集合类，称为 MyObjectCollection：

```
public class MyObjectCollection : List<MyObject> {} 
```

为什么我不能执行以下操作：

```
List<MyObject> list = this.DoSomethingHere();
MyObjectCollection collection = (MyObjectCollection)list; 
```

提前致谢。

**编辑：错误是 InvalidCastException**

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2009-04-20T13:28:08.823

我的猜测是它`DoSomethingHere`不会返回`MyObjectCollection`.

让我们在这里摆脱所有泛型等，因为它们不相关。这就是我怀疑你正在尝试做的事情：

```
public static object CreateAnObject()
{
    return new object();
}

object o = CreateAnObject();
string s = (string) o; 
```

这将失败（在执行时），这是正确的。

要将其带回您的代码，除非在执行时`DoSomethingHere` *实际*返回 a ，否则强制转换将失败。`MyObjectCollection`

* * *

## 回答 #2

> 赞同：5
> 
> 时间：2009-04-20T13:29:12.847

因为 a`List<MyObject>`不是 MyObjectCollection。反之亦然：您可以将 MyObjectCollection 转换为 List 因为 MyObjectCollection 继承自`List<MyObject>`IS A ，因此，出于所有意图和目的，IS A `List<MyObject>`。

您唯一能做的就是在 MyObjectCollection 上定义一个构造函数，该构造函数将 Ienumerable 作为参数并使用另一个中的数据初始化自身，但这将创建一个包含相同数据的新对象：

```
public class MyObjectCollection : List<MyObject> 
{
  public MyObjectCollection(IEnumerable<MyObject> items)
  {
    Addrange(items); 
  }
} 
```

更新：如评论中所述，如果 DoSomething 实际上返回 MyObjectCollection 的实例，您可以在运行时成功转换。如果是这样，则该对象实际上是一个 MyObjectCollection，并且强制转换是完全合法的。

我不得不说，在我看来，上扬这样的事情是不好的做法。如果函数返回 List，则不应依赖 List 的特定实现。如果您拥有该函数，则修改 DoSomething 的返回类型并返回 MyObjectCollection，或者将其作为列表处理。

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2009-04-20T13:28:26.263

在不知道DoSomething() 中*究竟*创建了什么的情况下，我们必须假设：

您对 .Net 中的继承存在误解。

你有

```
A : B

B DoSomething() 
{
    return new B();
}
// then this is
B b = new B();
A a = (A)b; 
```

显然 b 是 B 但不是 A。B 可能*看起来*很像 A 但事实并非如此（如果您遍历 b 的父系，您将在任何地方都找不到 A）

无论所涉及的泛型如何，这都是正确的（尽管有时可能会导致某些可以工作的东西在 c# 4.0 中看不到共同矛盾的情况）

或者

```
A : B

B DoSomething() 
{
    return new A();
}
// then this is
B b = new A();
A a = (A)b; 
```

在没有泛型的情况下*将*起作用。

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2009-04-20T13:28:57.620

你不能这样做，因为（我猜）从**DoSomethingHere**返回的列表实例不是从**MyObjectCollection派生的**

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2009-04-20T13:33:07.783

您可以创建一个隐式运算符，允许您在对象和列表之间进行转换。您将需要一个构造函数，它接受一个列表和返回底层列表的属性。

```
public static implicit operator List<MyObject>(MyObjectCollection oCollection)
{
  //Convert here
  return MyObjectCollection.BaseList;
}

public static implicit operator MyObjectCollection(List<MyObject> oList)
{
  //Convert here
  return new MyObjectCollection(oList);
} 
```

# web-services - Web 服务上的杰出字段 (BizTalk)

> ID：768230
> 
> 赞同：1
> 
> 时间：2009-04-20T13:24:40.097
> 
> 标签：web-services, biztalk, field

如何访问 Web 服务调用返回的消息中的字段？

我找到了 Richard Seroters[博客文章](http://blogs.msdn.com/richardbpi/archive/2006/11/09/setting-promoted-distinguished-fields-on-biztalk-web-messages.aspx)，但它说要通过 Reference.map 钻取到 Reference.xsd ...
- 问题是，我没有 Reference.xsd
- 我确实有 Reference.map 和子 Reference .odx
- 我也有 wsdl，但没有迪斯科

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-04-22T14:42:27.630

似乎...

*如果该方法包含原始数据类型以外的其他内容，则在 Reference.map 下还会有一个 Reference.xsd 文件。添加此引用后，我们将能够创建消息以与将类型定义为 Web 消息并选择适当模式的 Web 服务进行通信。*

而我正在与之交谈的 Web 服务只返回一个字符串，尽管实际上是 XML

从这篇[博文](http://geekswithblogs.net/evankoch/archive/2007/09/26/115647.aspx)

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-04-21T17:20:38.630

我很困惑为什么您没有由 BizTalk 代理生成的 XSD？您当然可以使用允许您将字段设置为提升属性或可区分字段的属性标记生成的代理代码类。如果你没有，我不确定你能做到。看看[这里](http://blogdoc.biztalk247.com/article.aspx?page=a4f1434e-2dab-463d-963c-d3308ab13d58)。

-布莱恩

# asp.net-mvc - 如何使用 ASP.NET MVC 中的基本控制器创建强类型母版页

> ID：768236
> 
> 赞同：20
> 
> 时间：2009-04-20T13:25:43.977
> 
> 标签：asp.net-mvc, controller, master-pages, viewmodel

按照[NerdDinners](http://weblogs.asp.net/scottgu/archive/2009/03/10/free-asp-net-mvc-ebook-tutorial.aspx)示例，我有兴趣创建一个强类型的母版页。为了实现这一点，我使用了一个基本控制器来检索母版页的数据。所有其他控制器都继承这个类。同样，我有`ViewModels`母版页和任何其他视图。视图`ViewModel`类继承自母版页的`ViewModel`.

### 问题

子控制器应如何确保将母版页的数据传递给视图而不设置`ViewModel`与母版页本身相关的属性？

我的母版页将显示许多按钮，这些按钮在 XML 文件中确定，因此`Buttons`是我要填充的类。

**MasterPage ViewModel 代码片段**

```
using System.Collections.Generic;

namespace Site1.Models
{
    public class MasterViewModel
    {
        public List<Button> Buttons{set; get;}
    }
} 
```

**看法`ViewModel`**

```
namespace Site1.Models
{
    public class View1ViewModel : MasterViewModel
    {
        public SomeDataClass SomeData { get; set; }
    }
} 
```

### 基本控制器

```
using System.Collections.Generic;
using System.Web.Mvc;
using Site1.Models;

namespace Site1.Controllers
{
    public abstract class BaseController : Controller
    {
        protected MasterViewModel model = new MasterViewModel();

        public BaseController()
        {
            model.Buttons = new List<Button>();
            //populate the button classes (doesn't matter how)
            PopulateButtons(model.Buttons);
        }
    }
} 
```

**视图的控制器：**

```
using System.Web.Mvc;

namespace Site1.Controllers
{
    public class View1Controller : BaseController
    {
        public ActionResult Index()
        {
            Models.View1ViewModel viewModel = new Models.View1ViewModel();
            SomeDataClass viewData = new SomeDataClass()
            //populate data class (doesn't matter how)
            PopulateDataClass(viewData);
            viewModel.SomeData = viewData;
            //I WANT TO ELIMINATE THE FOLLOWING LINE!
            viewModel.Buttons = model.Buttons;
            return View("Index", viewModel);
        }
    }
} 
```

母版页继承`System.Web.Mvc.ViewMasterPage<Site1.Models.MasterViewModel>`.

视图继承`System.Web.Mvc.ViewMasterPage<Site1.Models.View1ViewModel>`.

* * *

## 回答 #1

> 赞同：17
> 
> 时间：2009-04-20T15:31:19.620

您可以创建一个操作后执行过滤器，该过滤器查找该类型的模型并相应地设置属性，可能通过调用基本控制器函数。然后，您将过滤器放在基类上，所有操作都会自动看到它。

动作过滤器属性获取控制器的`ViewModel`，并将其传递给控制器​​的`SetModel`函数：

```
using System.Web.Mvc;
using Site1.Controllers;

namespace Site1.Models
{
    public class MasterAttribute : ActionFilterAttribute
    {
        public override void OnActionExecuted(ActionExecutedContext filterContext)
        {
            base.OnActionExecuted(filterContext);

            MasterViewModel viewModel = (MasterViewModel)((ViewResultBase)filterContext.Result).ViewData.Model;

            BaseController controller = (BaseController)filterContext.Controller;
            controller.SetModel(viewModel);
        }
    }
} 
```

**此功能被添加到`BaseController`：**

```
public void SetModel(MasterViewModel childViewModel)
{
    childViewModel.Buttons = model.Buttons;
} 
```

* * *

## 回答 #2

> 赞同：6
> 
> 时间：2009-04-27T04:40:15.760

与其创建属性，不如直接覆盖 Controller.OnActionExecuted 并将初始化代码放在那里？似乎简单一些。

# emacs - 交互式 Emacs Lisp 函数用于交换两个单词

> ID：768243
> 
> 赞同：5
> 
> 时间：2009-04-20T13:27:22.180
> 
> 标签：emacs, elisp, swap

我第一次涉足 emacs lisp 的古怪世界是一个函数，它接受两个字符串并将它们相互交换：

```
(defun swap-strings (a b)
  "Replace all occurances of a with b and vice versa"
  (interactive "*sFirst Swap Word: \nsSecond Swap Word: ")
  (save-excursion
    (while (re-search-forward (concat a "\\|" b) nil t)
      (if (equal (match-string 0) a)
      (replace-match b)
    (replace-match a))))) 
```

这有效 - 但我坚持以下几点：

*   每次更换前如何提示用户确认？（我不能`perform-replace`上班）
*   如何转义字符串`a`，`b`如果它们包含任何正则表达式字符，它们不会被解释为正则表达式？

编辑：我已经使用了一段时间的最终可复制粘贴代码是：

```
(defun swap-words (a b)
  "Replace all occurances of a with b and vice versa"
  (interactive "*sFirst Swap Word: \nsSecond Swap Word: ")
  (save-excursion
    (while (re-search-forward (concat (regexp-quote a) "\\|" (regexp-quote b)))
      (if (y-or-n-p "Swap?") 
      (if (equal (match-string 0) a)
          (replace-match (regexp-quote b))
        (replace-match (regexp-quote a))))
      ))) 
```

不幸的是，它不像 I-search 那样突出显示页面上即将到来的匹配项。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2009-04-20T13:53:27.017

用于`y-or-n-p`第一个：`(when (y-or-n-p "Swap?") do stuff`

`regexp-quote`对于第二个：`(regexp-quote your-string)`

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-04-20T14:42:30.580

`regexp-quote`已经[提到过](https://stackoverflow.com/questions/768243/interactive-emacs-lisp-function-to-swap-two-words-with-eachother/768349#768349)。

至于确认，如果您想在*每次*更换之前询问用户，您可以选择`query-replace-regexp`完全符合您的要求。

（而且你仍然可以处理 Emacs 的内置[transponse 函数](http://www.cs.cmu.edu/cgi-bin/info2www?(emacs)Transpose)。）

# sharepoint - 组合不同的列表数据并在 Web 部件中显示

> ID：768247
> 
> 赞同：1
> 
> 时间：2009-04-20T13:28:12.787
> 
> 标签：sharepoint, list, wss, web-parts

让我解释一下我现在的情况

我有一个 SharePoint 网站，可以说它是 MAIN，而一个子网站可以称之为 SUBMAIN

在 MAIN 中，我有一个名为“a”的列表，在 subMAIN 中，我有一个名为“b”的列表

两个列表都有完全相同的列，

我需要在主页的一个 webpart 中显示两个列表的内容（例如按修改日期排序），我知道这可能有一些方法，但无法做到。

目前我在内容查询 webpart 中只显示列表“a”的内容（我已经改变了它的显示方式并添加到它的水平 merquee）所以如果我能以某种方式添加列表“b”的内容也会很好相同的内容查询 webpart（但如果在内容查询 webpart 中不可能的话，至少让我知道我还有哪些其他选项）

感谢您的帮助

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-04-20T14:42:39.033

如果您使用 SharePoint Designer 执行此操作，请查看[此博客](http://blah.winsmarts.com/2007-10-Performing_joins_between_SharePoint_lists.aspx)。

如果您正在构建自己的 Web 部件，我将对 SPList 对象执行两个查询。然后，您可以根据需要对结果进行聚合、排序等。如果您不熟悉 SPList，可以[在此处](http://msdn.microsoft.com/en-us/library/ms456030.aspx)查看 MSDN 概述。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-04-20T15:52:08.760

我已经构建了 Web 部件来显示来自 2 个不同列表的项目，并且我做了类似于 Scott Price 建议的事情。我为每个列表使用了一个 SPQuery 对象，并使用它来获取 DataTable 对象，然后我可以将这些对象与 Repeaters 和 DataLists 之类的东西一起使用。你可以合并你的两个表并做类似的事情。

对我来说最大的技巧是在 webpart 中为 DataBinding 设置自定义模板。为此，我创建了一个自定义类来实现 ITemplate 接口，然后在事件处理程序中从模板类中为每个项目发出 HTML。然后，您只需创建模板类的一个实例并将其设置为 DataList 的 ItemTemplate 属性。

[这篇文章](http://professionalaspnet.com/archive/2006/06/15/Useing-ITemplate-in-the-Data-Controls.aspx)和[这篇](http://blog.developers.ie/cgreen/archive/2006/01/10/1850.aspx)文章更好地解释了这种方法，但好处是您可以完全控制标记，并且可以随意设置样式。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-04-20T22:49:45.650

如果您不想编写自己的解决方案，可以考虑在 codeplex 上使用这个 webpart：

[http://rssaggregator.codeplex.com/](http://rssaggregator.codeplex.com/)

它实际上是一个 RSS 聚合器，但由于所有 SharePoint 列表都有内置的 RSS 源，因此您也可以使用它来聚合来自不同站点的 SharePoint 列表。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2009-06-10T17:36:16.523

另一种方法是 SLAM，[SharePoint 列表关联管理器](http://slam.codeplex.com)，这是我公司创建并积极支持的一个开源项目。SLAM 将允许您将这两个列表配置为自动同步到 SQL 表，此时您可以创建查询以连接两者。如果您有根据内容类型构建的两个列表（因为它们具有相同的字段），您实际上可以抨击内容类型并将两个列表都放在同一个 SQL 表中。

# python - 是否有任何可用的 pywin32 odbc 连接器文档？

> ID：768250
> 
> 赞同：1
> 
> 时间：2009-04-20T13:28:34.313
> 
> 标签：python, windows, odbc, pyodbc

网络上有什么好的 pywin32 odbc 连接器文档和教程？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2009-04-20T13:46:49.793

备择方案：

*   egenix.com 的[mxODBC](http://egenix.com)（如果您需要 ODBC）
*   [pyODBC](http://code.google.com/p/pyodbc)
*   [sqlalchemy](http://www.sqlalchemy.org/)和 DB-API 2.0 模块（不是 ODBC），但它可能是更好的选择

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2009-04-20T13:54:05.423

答案是：'没有一个'。但是，这里有一个示例显示如何打开连接并发出查询，以及如何从结果集中获取列元数据。DB API 2.0 规范可以在[PEP 249 中找到。](http://www.python.org/dev/peps/pep-0249/)

```
import dbi, odbc

SQL2005_CS=TEMPLATE="""\
Driver={SQL Native Client};
Server=%(sql_server)s;
Database=%(sql_db)s;
Trusted_Connection=yes;
"""

CONN_PARAMS = {'sql_server': 'foo',
               'sql_db': 'bar'}

query = "select foo from bar"

db = odbc.odbc(SQL2005_CS_TEMPLATE % CONN_PARAMS)
c = db.cursor()
c.execute (query)
rs = c.fetchall()  # see also fetchone() and fetchmany()
# looping over the results
for r in rs:
    print r

#print the name of column 0 of the result set
print c.description[0][0]

#print the type, length, precision etc of column 1.
print c.description[1][1:5]

db.close() 
```

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2009-06-21T05:21:01.927

我发现的唯一“文档”是与 pywin32 软件包一起安装的单元测试。它似乎概述了一般功能。我在这里找到了它：

python 目录\Lib\site-packages\win32\test\test_odbc.py

我还应该指出，我相信它实现了 Python 数据库 API 规范 v1.0，在此处记录：

[http://www.python.org/dev/peps/pep-0248/](http://www.python.org/dev/peps/pep-0248/)

请注意，该规范也有 V2.0（参见 PEP-2049）

附带说明一下，我一直在尝试使用 pywin32 odbc，但是我遇到了我正在使用的 ODBC 驱动程序间歇性崩溃的问题。我最近搬到了 pyodbc 并且我的问题得到了解决。

# c# - C# 中的匈牙利符号

> ID：768255
> 
> 赞同：34
> 
> 时间：2009-04-20T13:30:03.217
> 
> 标签：c#, naming-conventions

在使用 C# 之前，C++ 是我的主要编程语言。匈牙利的记谱法深深地印在了我的心里。

我在没有阅读 C# 书籍或其他语言指南的情况下使用 C# 完成了一些小项目。在那些小的 c# 项目中，我使用了类似的东西

```
private string m_strExePath; 
```

直到我从 SO 中读到一些内容：

> 不要使用匈牙利符号。

所以为什么？我是唯一在我的 C# 代码中有 m_strExePath 或 m_iNumber 的人吗？

* * *

## 回答 #1

> 赞同：51
> 
> 时间：2009-04-20T13:42:26.480

Joel Spolsky 有一篇关于这个主题的非常好的[文章。](http://www.joelonsoftware.com/articles/Wrong.html)快速总结是在实践中使用了两种类型的匈牙利符号。

第一个是“Systems Hungarian”，您可以在其中使用前缀指定变量类型。诸如字符串的“str”之类的东西。这几乎是无用的信息，尤其是因为现代 IDE 无论如何都会告诉您类型。

第二个是“Apps Hungarian”，您可以在其中使用前缀指定变量的*用途*。最常见的例子是使用“m_”来表示成员变量。如果正确完成，这将非常有用。

我的建议是避免像瘟疫一样使用“Systems Hungarian”，但在有意义的地方绝对使用“Apps Hungarian”。我建议阅读 Joel 的文章。这有点啰嗦，但解释得比我好得多。

这篇文章最有趣的部分是匈牙利符号的最初发明者 Charles Simonyi 创建了“Apps Hungarian”，但他的论文被严重误解，结果产生了“Systems Hungarian”的可憎性。

* * *

## 回答 #2

> 赞同：34
> 
> 时间：2009-04-20T13:36:44.090

在进行用户界面设计时，我发现保持匈牙利符号非常有用。文本框、标签和下拉列表等项目更容易快速理解，而且您经常会得到重复的控件名称：

```
lblTitle = Label
txtTitle = TextBox
ddlTitle = DropDownList 
```

对我来说，这更容易阅读和解析。否则，由于 IDE，特别是 Visual Studio 的进步，匈牙利表示法不适合。

此外，Joel on Software 有一篇与匈牙利符号相关的优秀文章，标题为：[Making Wrong Code Look Wrong ，它](http://www.joelonsoftware.com/articles/Wrong.html)**为**匈牙利符号提供了一些很好的论据。

* * *

## 回答 #3

> 赞同：30
> 
> 时间：2009-04-20T13:33:41.337

你不是唯一的人，但我会说这相对不常见。就我个人而言，我不是匈牙利符号的粉丝，至少不是简单意义上的重述声明中已经存在的类型信息。（“真正的”匈牙利符号的粉丝会解释这种差异——它从来没有让我如此困扰，但我明白他们的意思。如果你使用一个通用前缀来表示长度单位和重量单位，你不会意外为长度变量分配权重值，即使两者都可能是整数。）

但是，对于私人成员，您几乎可以做任何您想做的事情 - 与您的团队同意命名约定应该是什么。重要的一点是，如果您希望您的*API*适合 .NET 的其余部分，请不要在您的公共成员（包括参数）中使用匈牙利符号。

* * *

## 回答 #4

> 赞同：21
> 
> 时间：2009-04-20T13:32:22.400

不，你不是唯一一个这样做的人。人们普遍认为，匈牙利符号不是在 C# 中命名事物的最佳方式（IDE 处理了很多匈牙利符号试图解决的问题）。

* * *

## 回答 #5

> 赞同：13
> 
> 时间：2009-04-20T13:56:48.553

匈牙利符号在*任何*语言中都是一个可怕的错误。你也不应该在 C++ 中使用它。命名您的变量，以便您知道它们的用途。不要将它们命名为重复 IDE 无论如何都可以为您提供的类型信息，并且这些信息可能会发生变化（并且通常无论如何都无关紧要。如果您知道某物是计数器，那么它是否是 int16、32 或64\. 你知道它作为一个计数器，因此，任何对计数器有效的操作都应该是有效的。X/Y 坐标的参数相同。它们是坐标。不管它们是浮点数还是浮点数双打。知道一个值是否以重量、距离或速度为单位可能是相关的。它是一个浮点数并不重要。）。

事实上，匈牙利符号只是一种误解。发明者打算用它来描述变量的“概念”类型（它是坐标、索引、计数器还是窗口？）

阅读他的描述的人认为他所说的“类型”是指实际的编程语言类型（int、float、以零结尾的字符串、char 指针）

这从来都不是本意，这是一个可怕的想法。它复制了 IDE 可以更好地提供的信息，这些信息一开始并不是那么相关，因为它鼓励您在尽可能低的抽象级别上进行编程。

> 所以为什么？我是唯一拥有 `m_strExePath`或`m_iNumber`在我的 C# 代码中的人吗？

不，不幸的是没有。告诉我，`exePath`如果*不是*字符串会怎样？作为您的代码的读者，为什么我需要知道它是一个字符串？知道它是可执行文件的路径还不够吗？`m_iNumber`只是名字不好。*这是哪个*号码？这是为了什么？你刚才已经告诉我两次了，它是一个数字，但我还是不知道这个数字是什么意思。

* * *

## 回答 #6

> 赞同：10
> 
> 时间：2009-04-20T13:42:53.577

你当然不是唯一的人，但我确实希望你是下降趋势的一部分:)

匈牙利符号的问题在于它试图通过命名约定来实现类型系统。这是非常有问题的，因为它是一个只有人工验证的类型系统。项目中的每个人都必须同意同一组标准，进行严格的代码审查，并确保为所有新类型分配适当且正确的前缀。简而言之，不可能保证与足够大的代码库的一致性。在这一点上没有一致性，你为什么要这样做？

此外，工具不支持匈牙利符号。从表面上看，这似乎是一个愚蠢的评论，但可以考虑重构。匈牙利命名约定系统中的每次重构都必须伴随着大规模重命名，以确保维护前缀。批量重命名容易受到各种细微错误的影响。

与其使用名称来实现类型系统，不如仅依赖类型系统。它具有自动验证和工具支持。较新的 IDE 使发现变量类型（智能感知、悬停提示等）变得更加容易，并真正消除了对匈牙利符号的最初需求。

* * *

## 回答 #7

> 赞同：6
> 
> 时间：2009-04-20T13:40:14.643

匈牙利符号的一个缺点是开发人员在早期编码期间经常更改变量的类型，这需要变量的名称也随之更改。

* * *

## 回答 #8

> 赞同：5
> 
> 时间：2009-04-20T13:37:24.370

除非您使用的是文本编辑器而不是 VS IDE，否则匈牙利表示法几乎没有价值，它会阻碍而不是提高可读性

* * *

## 回答 #9

> 赞同：5
> 
> 时间：2009-04-20T14:46:27.903

匈牙利符号的真正价值可以追溯到 C 编程和指针的弱类型特性。基本上，过去最简单的跟踪类型的方法是使用匈牙利语。

在像 C# 这样的语言中，类型系统会告诉您所有您需要知道的信息，而 IDE 会以非常用户友好的方式向您提供这些信息，因此根本不需要使用匈牙利语。

至于不使用它的充分理由，有很多。首先，在 C# 以及 C++ 和许多其他语言中，您经常创建自己的类型，那么“MyAccountObject”类型的匈牙利语是什么？即使您可以决定合理的匈牙利符号，它仍然会使实际变量名称稍微难以阅读，因为您必须在开始时跳过“LPZCSTR”（或其他）。更重要的是维护成本，如果您从 List 开始并更改为另一种类型的集合（我目前似乎经常这样做）怎么办？然后，您需要重命名所有使用该类型的变量，这一切都没有真正的好处。如果您刚开始使用一个体面的名字，您就不必担心这一点。

在您的示例中，如果您创建或使用了一些更有意义的类型来保存路径（例如路径），那么您需要将您的更改`m_strExePath`为`m_pathExePath`，这很痛苦，在这种情况下实际上并不是很有帮助。

* * *

## 回答 #10

> 赞同：3
> 
> 时间：2009-04-20T13:40:55.097

我目前看到任何形式的匈牙利符号的唯一两个领域是：

*   类成员变量，带有前导下划线（例如`_someVar`）
*   WinForms 和 WebForms 控件名称（`btn`用于按钮、`lbl`标签等）

成员变量的前导下划线似乎会在我们这里停留一段时间，但我希望看到匈牙利语在控制名称上的流行度会减弱。

* * *

## 回答 #11

> 赞同：3
> 
> 时间：2009-04-20T14:16:04.137

大多数匈牙利符号描述变量是什么（指针，或指向指针的指针，或指针的内容等），以及它指向的东西是什么（字符串等）。

我发现 C# 中的指针很少使用，尤其是在没有非托管/pinvoke 调用的情况下。此外，没有使用 void* 的选项，因此匈牙利语无需描述它。

我（以及 C# 领域中的大多数其他人）使用的匈牙利语的唯一剩余部分是在私有字段之前加上`_`;`_customers`

* * *

## 回答 #12

> 赞同：2
> 
> 时间：2016-12-09T06:20:22.297

匈牙利表示法首次在[BCPL](https://en.wikipedia.org/wiki/BCPL)编程语言中得到了主要应用。BCPL 是*Before C Programming Language*的缩写，是一种古老的（设计于 1966 年），无类型语言，一切都是*单词*。在这种情况下，匈牙利符号可以帮助进行肉眼类型检查。

从那以后已经过去很多年了……

这是最新的[Linux 内核文档](https://www.kernel.org/doc/html/latest/process/coding-style.html)所说的（我的粗体）：

> 将函数的类型编码到名称中（所谓的匈牙利符号）是大脑受损**的 - 编译器无论如何都知道类型并且可以检查这些类型**，它只会让程序员感到困惑。

另请注意，有两种类型的匈牙利符号：

*   **系统匈牙利表示法**：前缀编码**物理**数据类型。

*   **Apps 匈牙利表示法**：前缀编码**逻辑**数据类型。

由于类型检查冗余而不再推荐使用 Systems Hungarian 表示法，而这又是由于编译器功能的进步。但是，如果编译器不为您检查逻辑数据类型，您仍然可以使用 Apps Hungarian 表示法。根据经验，匈牙利表示法是好的，当且仅当它描述了其他情况下不可用的语义。

* * *

## 回答 #13

> 赞同：1
> 
> 时间：2009-04-20T13:32:45.520

如果匈牙利符号在您和您的团队以及您的公司的内心深处，请务必使用它。就我可以从博客和书籍中阅读的内容而言，它不再被认为是最佳实践。

* * *

## 回答 #14

> 赞同：1
> 
> 时间：2009-04-20T13:33:12.603

如果您将指针放在 VS 中的变量上，它会告诉您它是什么类型的变量，因此没有理由使用这些神秘的变量名称，尤其是来自其他语言的人可能需要维护代码和这将成为轻松阅读的障碍。

* * *

## 回答 #15

> 赞同：0
> 
> 时间：2013-09-10T01:57:03.510

这是关于效率的。为变量分配错误的值浪费了多少时间。拥有准确的变量声明是为了提高效率。这是关于可读性。它关于遵循现有模式。如果你想要创意，就做用户界面设计，做系统架构。如果你的编程，它应该被设计成让你的团队成员工作更轻松：不是你的。效率提高 2% 就是每年多一周。那是40个小时。人类生产力的提高是通过复合效率来实现的。

* * *

## 回答 #16

> 赞同：0
> 
> 时间：2009-04-20T14:09:52.407

在像 C# 这样的语言中，变量名称长度的许多限制不存在，而在像 C 和 C++ 这样的语言中曾经存在过，并且 IDE 为确定变量的类型提供了出色的支持，匈牙利表示法是多余的。

代码应该是不言自明的，所以像 m_szName 这样的名称可以用 this.name 替换。并且 m_lblName 可以是 nameLabel 等。重要的是要保持一致并创建易于阅读和维护的代码 - 这是任何命名约定的目标，因此您应该始终根据此决定使用什么约定。我觉得匈牙利表示法不是最易读或最易维护的，因为它可能过于简洁，需要对前缀含义有一定的了解，并且不是语言的一部分，因此难以实施和检测当名称不再与基础类型匹配时。

`this`相反，我喜欢通过引用成员、引用静态变量的类名以及不使用局部变量的前缀来替换 Apps Hungarian（前缀如 m_） 。而不是 System Hungarian（包括变量名称中的变量类型），我更喜欢描述变量的用途，例如 nameLabel、nameTextBox、count 和 databaseReference。

* * *

## 回答 #17

> 赞同：0
> 
> 时间：2009-04-20T16:43:54.407

在某些时候，您可能拥有房产

```
public string ExecutablePath { ... } 
```

（并不是说您也应该尽量避免使用“Exe”之类的缩写）。在这种情况下，您的问题可能在很多时候都没有实际意义，因为您可以使用 C# 3.0 的自动属性

```
public string ExecutablePath { get; set; } 
```

您现在不再需要为后备存储变量命名。没有名字，没有关于命名约定的问题/辩论。

显然，自动实现的属性并不总是合适的。

* * *

## 回答 #18

> 赞同：0
> 
> 时间：2013-01-20T02:40:45.897

这取决于。

在方法/类中的变量/对象名称中添加数据类型的描述是否*足够重要？*

**System Hungarian Notation > Apps Hungarian Notation**

如果您正在使用具有许多全局变量或/和处理精确数据类型和大小的较低 API 的过程语言（例如 C）进行设计（例如`<stdint.h>`，使用 40 多种不同数据类型符号来描述的 C 语言`int`），System Hungarian Notation更有帮助。

但是请注意，许多现代程序员认为在变量名中添加类型信息是很丰富的，因为许多现代 IDE 都有非常方便的工具（例如Eclipse的[Outline](http://help.eclipse.org/juno/topic/org.eclipse.platform.doc.user/images/ref-8.png)、Xcode的[Symbol Navigator 、Visual Studio 的](https://s3-ap-northeast-1.amazonaws.com/booksikindle/html/Beginning%20IOS%205%20Development1/images/00019.jpg)[Visual AssistX](http://www.atmel.no/webdoc/atmelstudio/images/vaview.gif)等）。System Hungarian Notation 在早期的编程（例如 FORTRAN、C99）中被广泛使用，当时类型信息作为 IDE 的工具并不容易获得。

**System Hungarian Notation < Apps Hungarian Notation**

如果您正在使用更高级别的类或方法（例如，C# 应用程序的用户定义驱动程序类/方法），则标注简单数据类型可能不足以描述变量/对象。因此，在这种情况下，我们使用 Apps Hungarian Notation。

例如，如果您的方法的目的是检索可执行路径并在未找到时显示错误消息，而不是指出它是 的类型`string`，我们会记录更重要的信息来描述变量/对象，以便程序员更好地理解变量/对象的目的：

```
private string mPathExe;
private string msgNotFound; 
```

* * *

## 回答 #19

> 赞同：0
> 
> 时间：2019-11-15T05:09:27.723

我不在乎，我总是使用 Hungarian 和 Pascal/Camel Case 的组合。

不是针对数据类型，而是针对控件。因为 txtName 是不言自明的。有些人会把它命名为 NameTextBox 太长了。lblAge、txtName、rdoTrue、cboCities、lstAccountInfo。不错，快速，紧凑对于变量，普通变量和属性的 Pascal 案例。“firstName = txtFName.Text”（说真的，如果你看不到它并意识到它是一个文本框，sheez）。然后我将使用 Camel Case 作为方法

```
public void PrintNames (string fName, string lName)
{
    lblFullName.Text=fName + " " + lName;
} 
```

所以是的，我使用匈牙利案，所以起诉我。没有人可以说他们不知道这些变量是什么，我喜欢能够非常快速地看到而不必将鼠标悬停在变量的类型或控件上。当我第一次开始编程时，我对每个变量都使用了全部大写，所以这是一个进步。可惜，不要将左花括号放在行尾。好看又对称。

# javascript - 用 ActiveX 替换 Word 文档中的文本？

> ID：768260
> 
> 赞同：0
> 
> 时间：2009-04-20T13:31:23.090
> 
> 标签：javascript, ms-word, activex, replace

我想使用 ActiveX 和 JavaScript 替换 Word 文档中的一些字符串，现在我有这样的东西：

```
var text = Selection.Text;
Selection.Text = text.replace('somesting','somevalue'); 
```

但在那之后，我失去了所有的形成。如果我在 WinWord 中录制宏，我会得到：

```
With Selection.Find
    .Text = "somestring"
    .Replacement.Text = "somevalue"
    .Forward = True
    .Wrap = wdFindContinue
    .Format = False
    .MatchCase = False
    .MatchWholeWord = False
    .MatchWildcards = False
    .MatchSoundsLike = False
    .MatchAllWordForms = False
End With
Selection.Find.Execute
Selection.Find.Execute Replace:=wdReplaceAll 
```

那么，如何用 JS 重写最后一个字符串呢？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-04-20T15:56:26.783

```
Selection.Find.Execute('somestring',
                       false,
                       false,
                       false,
                       false,
                       false,
                       wdFindContinue,
                       false,
                       false,
                       'somevalue'
                       wdReplaceAll,
                       false,
                       false,
                       false,
                       false); 
```

您还应该有一些单词常量，例如：

```
var wdReplaceAll = 2;
var wdFindContinue = 1; 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-12-09T11:09:32.393

如果文本少于 256 个字符，则效果很好。有关解决方法，请参阅文章 ID：212543 [http://support.microsoft.com/kb/212543](http://support.microsoft.com/kb/212543)。

谢谢，曼朱

# java - 如何使用 Java 代码检查客户端浏览器中是否启用了 JavaScript

> ID：768262
> 
> 赞同：5
> 
> 时间：2009-04-20T13:31:33.167
> 
> 标签：java, javascript

任何人都可以帮助我检查是否使用 Java 代码在客户端浏览器中启用了 JavaScript。

* * *

## 回答 #1

> 赞同：11
> 
> 时间：2009-04-20T13:43:00.690

假设您正在编写 Java Web 应用程序，我成功使用的一种技术是在页面加载时让访问的第一个页面（通常是登录表单）写入会话 cookie。然后让表单提交的 Java 代码检查该 cookie 的存在。

在客户端：

```
<script type="text/javascript">
  function createCookie(name, value, days) {
    var expires = "";
    if (days) {
      var date = new Date();
      date.setTime(date.getTime() + (days * 24 * 60 * 60 * 1000));
      expires = "; expires=" + date.toGMTString();
    }
    var cookie = name + "=" + value + expires + "; path=" + "/";
    document.cookie = cookie;
  }
  createCookie("JavaScriptEnabledCheck", 1, 0);
</script> 
```

在服务器上：

```
/**
 * Returns <code>true</code> if the session cookie set by the login form
 * is not present.
 * 
 * @param request The HTTP request being processed
 * @return <code>true</code> if JavaScript is disabled, otherwise <code>false</code>
 */
private boolean isJavaScriptDisabled(HttpServletRequest request)
{
  boolean isJavaScriptDisabled = true;
  Cookie[] cookies = request.getCookies();

  if (cookies != null)
  {
    for (int i = 0; i < cookies.length; i++)
    {
      if ("JavaScriptEnabledCheck".equalsIgnoreCase(cookies[i].getName()))
      {
        isJavaScriptDisabled = false;
        break;
      }
    }
  }

  return isJavaScriptDisabled;
} 
```

* * *

## 回答 #2

> 赞同：5
> 
> 时间：2009-04-20T18:45:12.757

在您的表单中，您可以输入如下代码：

```
<noscript>
  <input type="hidden" name="JavaScript" value="false" />
</noscript> 
```

仅当浏览器关闭脚本时才应提交该参数。在您的 Java 应用程序中，您可以像这样检查它：

```
boolean javaScript = request.getParameter("JavaScript") == null; 
```

* * *

## 回答 #3

> 赞同：3
> 
> 时间：2009-04-20T13:39:13.790

如果执行表单提交，您可以在表单中放置一个隐藏的输入并使用 javascript（来自 OnSubmit）填写其值并在服务器端进行检查。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2009-04-20T13:34:26.827

一个简单的事情是从页面进行回调，例如 AJAX 调用。我认为没有其他方法可以确定这一点，至少不是普遍的。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2009-04-20T13:39:07.080

您是要在小程序中在服务器端还是在客户端执行此操作？

如果浏览器不支持 javascript（或已将其关闭），则它们极不可能支持 Java 小程序。

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2010-06-22T14:39:29.500

如果您有 PHP 支持，只需复制并粘贴下面的代码。

```
<noscript> 
  <input type="hidden" name="JavaScript" value="false" /> 
</noscript> 
/*This code is developed by Lankeshwer(nick name only) and can be used as open source by anyone*/
<?PHP
if($_POST['JavaScript']!='false'){
 echo "<run your javascript code here>";} //replace this line with your actual javascript code
else
 echo "<html><head><meta http-equiv="refresh" content="0;url=www.kharida.com"></head</html>";
?> 
```

祝你好运，别忘了打开你的代码

# javascript - 你的 .conkerorrc 是什么样的？

> ID：768263
> 
> 赞同：5
> 
> 时间：2009-04-20T13:31:47.410
> 
> 标签：javascript, firefox, configuration, emacs, conkeror

[Conkeror](http://conkeror.org/)改变了我浏览网页的方式：它基本上是 Emacs + Firefox，在[.conkerrorc](http://conkeror.org/ConkerorRC)中使用基于 javascript 的配置，而不是在 .emacs 中使用 elisp 配置。

多年来，我通过从其他人那里获得的点点滴滴，建立了一个庞大的 .emacs 自定义库。我刚从 Conkeror 开始，但它使用 JS（比 Elisp 更广为人知）的事实一定意味着那里有一些令人惊奇的东西。

愿意分享你的作品吗？**我对与 Django 生成的页面（或其他动态网页）进行良好交互的东西特别感兴趣。**

例如，我喜欢基于 Conkeror 的操作记录器，它让我可以浏览网站并查找错误，然后通过一次按键立即保存并提交操作序列作为错误报告。通过包含复制错误所需的 JS 操作，它将成为最终的测试工具——甚至比 Selenium 更好，因为它完全由键盘驱动。

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2011-04-11T10:55:16.960

这是我的：

```
// homepage = "http://www.google.com";

// set default webjump
read_url_handler_list = [read_url_make_default_webjump_handler("google")];
// possibly valid URL
function possibly_valid_url (str) {
    return (/[\.\/:]/.test(str)) &&
        !(/\S\s+\S/.test(str)) &&
        !(/^\s*$/.test(str));
}

// page modes
require("page-modes/google-search-results.js"); // google search results
require("page-modes/wikipedia.js");     // wikipedia mode

// webjumps
define_webjump("gmail", "https://mail.google.com"); // gmail inbox
define_webjump("twitter", "http://twitter.com/#!/search/%s", $alternative = "https://twitter.com/");  // twitter
define_webjump("w3schools", "http://www.w3schools.com"); // w3schools site
define_webjump("w3search", "http://www.google.com/search?sitesearch=www.w3schools.com&as_q=%s"); // w3schools search
define_webjump("jquery", "http://docs.jquery.com/Special:Search?ns0=1&search=%s"); // jquery
define_webjump("archwiki", "https://wiki.archlinux.org/index.php?search=%s"); // arch wiki
define_webjump("stackoverflow", "http://stackoverflow.com/search?q=%s", $alternative = "http://stackoverflow.com/"); // stackoverflow
define_webjump("sor", "http://stackoverflow.com/search?q=[r]+%s", $alternative = "http://stackoverflow.com/questions/tagged/r"); // stackoverflow R section
define_webjump("stats", "http://stats.stackexchange.com/search?q=%s"); // stats
define_webjump("torrentz", "http://torrentz.eu/search?q=%s"); // torrentz
define_webjump("avaxsearch", "http://avaxsearch.com/avaxhome_search?q=%s&a=&c=&l=&sort_by=&commit=Search"); // avaxsearch
define_webjump("imdb", "http://www.imdb.com/find?s=all;q=%s"); // imdb
define_webjump("duckgo", "http://duckduckgo.com/?q=%s", $alternative = "http://duckduckgo.com"); // duckduckgo
define_webjump("blekko", "http://blekko.com/ws/%s", $alternative = "http://blekko.com/"); // blekko
define_webjump("youtube", "http://www.youtube.com/results?search_query=%s&aq=f", $alternative = "http://www.youtube.com"); // youtube
define_webjump("duckgossl", "https://duckduckgo.com/?q=%s"); // duckduckgo SSL
define_webjump("downforeveryoneorjustme", "http://www.downforeveryoneorjustme.com/%s"); // downforeveryoneorjustme
define_webjump("urbandictionary", "http://www.urbandictionary.com/define.php?term=%s"); // urban dictionary
define_webjump("rts", "http://rts.rs");             // RTS
define_webjump("facebook", "http://www.facebook.com");      // facebook homepage

// tab bar
require("new-tabs.js");

// clicks in new buffer
require("clicks-in-new-buffer.js");
// Set to either OPEN_NEW_BUFFER(_BACKGROUND)
clicks_in_new_buffer_target = OPEN_NEW_BUFFER_BACKGROUND; // Now buffers open in background.

// history webjump
define_browser_object_class(
    "history-url", null, 
    function (I, prompt) {
        check_buffer (I.buffer, content_buffer);
        var result = yield I.buffer.window.minibuffer.read_url(
            $prompt = prompt,  $use_webjumps = false, $use_history = true, $use_bookmarks = false);
        yield co_return (result);
    });

interactive("find-url-from-history",
            "Find a page from history in the current buffer",
            "find-url",
            $browser_object = browser_object_history_url);

interactive("find-url-from-history-new-buffer",
            "Find a page from history in the current buffer",
            "find-url-new-buffer",
            $browser_object = browser_object_history_url);

define_key(content_buffer_normal_keymap, "h", "find-url-from-history-new-buffer");
define_key(content_buffer_normal_keymap, "H", "find-url-from-history");

// load session module
require("session.js");
session_auto_save_auto_load = true; // auto-load session

// don't open download buffer automatically
remove_hook("download_added_hook", open_download_buffer_automatically);

// don't show clock
remove_hook("mode_line_hook", mode_line_adder(clock_widget));

// add favicons
require("favicon");
add_hook("mode_line_hook", mode_line_adder(buffer_icon_widget), true);
read_buffer_show_icons = true;

// add content handlers
content_handlers.set("application/pdf", content_handler_save); // pdf
// torrent
// mp3
// ogg

function define_switch_buffer_key (key, buf_num) {
    define_key(default_global_keymap, key,
               function (I) {
           switch_to_buffer(I.window,
                                    I.window.buffers.get_buffer(buf_num));
               });
}
for (let i = 0; i < 10; ++i) {
    define_switch_buffer_key(String((i+1)%10), i);
}

function enable_scrollbars (buffer) {
    buffer.top_frame.scrollbars.visible = true;
}
add_hook("create_buffer_late_hook", enable_scrollbars); 
```

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2010-02-11T07:45:59.097

由于似乎没有其他人对发布实际回复感兴趣，所以我会的。

```
function my_title_format (window) {
   return 'conkeror {'+get_current_profile()+'}'+window.buffers.current.description;
} 
```

当我使用多个配置文件时，我发现在窗口标题中包含配置文件名称很有帮助。现在我使用[StumpWM](http://www.nongnu.org/stumpwm/)并且不太看窗口列表，这对我没有多大帮助，但它在其他窗口管理器中非常有帮助。

```
define_key(content_buffer_normal_keymap, "C-x C-c", "confirm-quit");
can_kill_last_buffer = false; 
```

这两个使我不会通过关闭最后一个缓冲区来意外关闭 conkeror 窗口。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2009-04-24T15:05:08.983

好吧，我在这里真的帮不上你，但我只想说，虽然我是一个 emacs 人，但我放弃了 Conkeror 以获得[vimperator](http://vimperator.org)，因为恕我直言，浏览体验要好得多！

* * *

## 回答 #4

> 赞同：-2
> 
> 时间：2009-05-01T03:55:13.463

Conkeror 只是带有 Emacs 键绑定的 Firefox。我不认为它是，也不打算成为像 Emacs 那样功能齐全的环境。

它允许您使用陈旧的 Emacs 肌肉记忆，从而促进您的浏览体验。并让您将手更多地放在键盘上，而不是一直从键盘跳到鼠标。

所以我不认为它真的有能力做一些你想象的事情。

它的发展也相当缓慢，可能人手不足。例如，您会发现无法使用最常见的 Firefox 插件/扩展。Firebug、Greasemonkey、Gears 等

对于一些浏览任务，我确实喜欢它：它具有阅读 Reddit、Google Reader 和其他让事情变得更容易的特殊模式。

但我也同意 binOr 的观点，即 vimperator 更好，即使你是一个 emacs 人。如果您使用 VIM 当然会有所帮助。

# javascript - Telerik - 将 JavaScript 文件包含在页面底部

> ID：768267
> 
> 赞同：0
> 
> 时间：2009-04-20T13:32:34.430
> 
> 标签：javascript, performance, telerik

[建议将 JavaScript 文件包含在](http://developer.yahoo.com/performance/rules.html)页面底部。我正在使用在页面顶部发出 JavaScript 的 Telerik Rad Ajax 控件。有没有办法强制它在页面底部发出 JavaScript 包含？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-04-20T22:10:26.400

解决此问题的方法可能是使用[JQuery](http://jquery.com/)异步加载脚本，如下所示：

```
 $(function () {
  $.getScript("script.js", function () { // You may skip the second argument
    alert("Done loading");
  });
}); 
```

你也可以像这样等待一段时间：

```
 $(function () {
  setTimeout(function () {
    $.getScript("script.js");
  }, 500);
}); 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-04-20T22:15:38.447

如果将**RadAjaxManager**作为标记中的最后一个控件，它将在页面底部发出 JavaScript。

但是，就包含对 scriptresource.axd(s) 的引用的位置而言。没有设置可以改变它。

# javascript - 如何使用javascript计算文件的md5哈希

> ID：768268
> 
> 赞同：111
> 
> 时间：2009-04-20T13:32:42.697
> 
> 标签：javascript, md5

有没有办法在使用 Javascript 上传到服务器之前计算文件的 MD5 哈希？

* * *

## 回答 #1

> 赞同：103
> 
> 时间：2009-04-20T13:36:36.917

虽然有MD5 算法的[JS 实现，但](http://pajhome.org.uk/crypt/md5/)**较旧的浏览器通常无法从本地文件系统读取文件**。

我是在 2009 年写的。那么新的浏览器呢？

**使用支持[FileAPI](http://www.w3.org/TR/FileAPI/)的浏览器，您*可以*读取文件的内容**`<input>`- 用户必须通过元素或拖放来选择它。截至 2013 年 1 月，以下是主要浏览器的堆叠方式：

*   FF 3.6 支持[FileReader](https://developer.mozilla.org/en/DOM/FileReader)，FF4 支持更多基于文件的功能
*   Chrome 从 7.0.517.41[版本开始支持 FileAPI](http://googlechromereleases.blogspot.com/2010/10/stable-channel-update.html)
*   Internet Explorer 10 具有部分[FileAPI 支持](http://msdn.microsoft.com/en-us/ie/hh272905#_HTML5FileAPI)
*   Opera 11.10[部分支持 FileAPI](http://dev.opera.com/articles/view/the-w3c-file-api/)
*   Safari - 我找不到一个好的官方来源，但[这个网站建议部分支持 5.1，完全支持 6.0](http://caniuse.com/fileapi)。另一篇文章报告[了与旧版 Safari 的一些不一致之处](http://www.thebuzzmedia.com/html5-drag-and-drop-and-file-api-tutorial/)

**如何？**

请参阅[下面 Benny Neugebauer 的答案，](https://stackoverflow.com/a/21458021/6521)它使用[CryptoJS 的 MD5 函数](https://github.com/sytelus/CryptoJS/blob/v3.1.2/rollups/md5.js)

* * *

## 回答 #2

> 赞同：33
> 
> 时间：2012-01-17T00:55:47.290

我制作了一个实现增量 md5 的库，以便有效地散列大文件。基本上，您以块的形式读取文件（以保持低内存）并逐步散列它。您在自述文件中获得了基本用法和示例。

请注意，您需要 HTML5 FileAPI，因此请务必检查它。测试文件夹中有一个完整的示例。

[https://github.com/satazor/SparkMD5](https://github.com/satazor/SparkMD5)

* * *

## 回答 #3

> 赞同：30
> 
> 时间：2014-01-30T13:36:18.447

[使用CryptoJS 的 MD5 函数](https://github.com/sytelus/CryptoJS/blob/v3.1.2/rollups/md5.js)和[HTML5 FileReader API](http://blog.teamtreehouse.com/reading-files-using-the-html5-filereader-api)计算 MD5 哈希非常容易。以下代码片段显示了如何读取二进制数据并从拖入浏览器的图像中计算 MD5 哈希：

```
var holder = document.getElementById('holder');

holder.ondragover = function() {
  return false;
};

holder.ondragend = function() {
  return false;
};

holder.ondrop = function(event) {
  event.preventDefault();

  var file = event.dataTransfer.files[0];
  var reader = new FileReader();

  reader.onload = function(event) {
    var binary = event.target.result;
    var md5 = CryptoJS.MD5(binary).toString();
    console.log(md5);
  };

  reader.readAsBinaryString(file);
}; 
```

我建议添加一些 CSS 以查看拖放区域：

```
#holder {
  border: 10px dashed #ccc;
  width: 300px;
  height: 300px;
}

#holder.hover {
  border: 10px dashed #333;
} 
```

可以在此处找到有关拖放功能的更多信息：[File API 和 FileReader](http://html5demos.com/file-api)

我在 Google Chrome 版本 32 中测试了该示例。

* * *

## 回答 #4

> 赞同：14
> 
> 时间：2016-07-18T10:10:44.187

## HTML5 +[`spark-md5`](https://github.com/satazor/js-spark-md5)和[`Q`](https://github.com/kriskowal/q)

假设您使用现代浏览器（支持 HTML5 File API），以下是计算大文件的**MD5 哈希**的方法（它将计算可变块的哈希）

```
function calculateMD5Hash(file, bufferSize) {
  var def = Q.defer();

  var fileReader = new FileReader();
  var fileSlicer = File.prototype.slice || File.prototype.mozSlice || File.prototype.webkitSlice;
  var hashAlgorithm = new SparkMD5();
  var totalParts = Math.ceil(file.size / bufferSize);
  var currentPart = 0;
  var startTime = new Date().getTime();

  fileReader.onload = function(e) {
    currentPart += 1;

    def.notify({
      currentPart: currentPart,
      totalParts: totalParts
    });

    var buffer = e.target.result;
    hashAlgorithm.appendBinary(buffer);

    if (currentPart < totalParts) {
      processNextPart();
      return;
    }

    def.resolve({
      hashResult: hashAlgorithm.end(),
      duration: new Date().getTime() - startTime
    });
  };

  fileReader.onerror = function(e) {
    def.reject(e);
  };

  function processNextPart() {
    var start = currentPart * bufferSize;
    var end = Math.min(start + bufferSize, file.size);
    fileReader.readAsBinaryString(fileSlicer.call(file, start, end));
  }

  processNextPart();
  return def.promise;
}

function calculate() {

  var input = document.getElementById('file');
  if (!input.files.length) {
    return;
  }

  var file = input.files[0];
  var bufferSize = Math.pow(1024, 2) * 10; // 10MB

  calculateMD5Hash(file, bufferSize).then(
    function(result) {
      // Success
      console.log(result);
    },
    function(err) {
      // There was an error,
    },
    function(progress) {
      // We get notified of the progress as it is executed
      console.log(progress.currentPart, 'of', progress.totalParts, 'Total bytes:', progress.currentPart * bufferSize, 'of', progress.totalParts * bufferSize);
    });
}
```

```
<script src="https://cdnjs.cloudflare.com/ajax/libs/q.js/1.4.1/q.js"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/spark-md5/2.0.2/spark-md5.min.js"></script>

<div>
  <input type="file" id="file"/>
  <input type="button" onclick="calculate();" value="Calculate" class="btn primary" />
</div>
```

* * *

## 回答 #5

> 赞同：11
> 
> 时间：2020-08-06T15:43:52.267

以下片段显示了一个示例，它可以在读取和散列文件时归档 400 MB/s 的吞吐量。

它使用了一个名为[hash-wasm](https://www.npmjs.com/package/hash-wasm)的库，该库基于 WebAssembly，并且比仅 js 的库更快地计算哈希。截至 2020 年，所有现代浏览器都支持 WebAssembly。

```
const chunkSize = 64 * 1024 * 1024;
const fileReader = new FileReader();
let hasher = null;

function hashChunk(chunk) {
  return new Promise((resolve, reject) => {
    fileReader.onload = async(e) => {
      const view = new Uint8Array(e.target.result);
      hasher.update(view);
      resolve();
    };

    fileReader.readAsArrayBuffer(chunk);
  });
}

const readFile = async(file) => {
  if (hasher) {
    hasher.init();
  } else {
    hasher = await hashwasm.createMD5();
  }

  const chunkNumber = Math.floor(file.size / chunkSize);

  for (let i = 0; i <= chunkNumber; i++) {
    const chunk = file.slice(
      chunkSize * i,
      Math.min(chunkSize * (i + 1), file.size)
    );
    await hashChunk(chunk);
  }

  const hash = hasher.digest();
  return Promise.resolve(hash);
};

const fileSelector = document.getElementById("file-input");
const resultElement = document.getElementById("result");

fileSelector.addEventListener("change", async(event) => {
  const file = event.target.files[0];

  resultElement.innerHTML = "Loading...";
  const start = Date.now();
  const hash = await readFile(file);
  const end = Date.now();
  const duration = end - start;
  const fileSizeMB = file.size / 1024 / 1024;
  const throughput = fileSizeMB / (duration / 1000);
  resultElement.innerHTML = `
    Hash: ${hash}<br>
    Duration: ${duration} ms<br>
    Throughput: ${throughput.toFixed(2)} MB/s
  `;
});
```

```
<script src="https://cdn.jsdelivr.net/npm/hash-wasm"></script>
<!-- defines the global `hashwasm` variable -->

<input type="file" id="file-input">
<div id="result"></div>
```

* * *

## 回答 #6

> 赞同：8
> 
> 时间：2011-04-20T03:32:09.817

您需要使用 FileAPI。它在最新的 FF 和 Chrome 中可用，但在 IE9 中不可用。获取上面建议的任何 md5 JS 实现。我已经尝试过了并放弃了它，因为 JS 太慢了（大图像文件需要几分钟）。如果有人使用类型化数组重写 MD5，可能会重新访问它。

代码看起来像这样：

```
HTML:     
<input type="file" id="file-dialog" multiple="true" accept="image/*">

JS (w JQuery)

$("#file-dialog").change(function() {
  handleFiles(this.files);
});

function handleFiles(files) {
    for (var i=0; i<files.length; i++) {
        var reader = new FileReader();
        reader.onload = function() {
        var md5 = binl_md5(reader.result, reader.result.length);
            console.log("MD5 is " + md5);
        };
        reader.onerror = function() {
            console.error("Could not read the file");
        };
        reader.readAsBinaryString(files.item(i));
     }
 } 
```

* * *

## 回答 #7

> 赞同：5
> 
> 时间：2010-06-04T11:58:40.653

> 除了无法在 JS 中访问文件系统之外，我根本不会信任客户端生成的校验和。因此在任何情况下都必须在服务器上生成校验和。– Tomalak 2009 年 4 月 20 日 14:05

在大多数情况下这是无用的。您希望在客户端计算 MD5，以便您可以将其与在服务器端重新计算的代码进行比较，如果它们不同，则得出上传错误的结论。我需要在处理大型科学数据文件的应用程序中执行此操作，其中接收未损坏的文件是关键。我的案例很简单，因为用户已经通过他们的数据分析工具计算了 MD5，所以我只需要通过文本字段向他们询问。

* * *

## 回答 #8

> 赞同：3
> 
> 时间：2012-11-29T11:16:24.790

要获取文件的哈希，有很多选项。通常的问题是获取大文件的哈希真的很慢。

我创建了一个小库来获取文件的哈希，文件开头为 64kb，结尾为 64kb。

实时示例： http: [//marcu87.github.com/hashme/](http://marcu87.github.com/hashme/)和库：[https ://github.com/marcu87/hashme](https://github.com/marcu87/hashme)

* * *

## 回答 #9

> 赞同：2
> 
> 时间：2009-04-20T13:36:43.780

互联网上有几个脚本可以创建 MD5 哈希。

来自 webtoolkit 的那个很好，[http://www.webtoolkit.info/javascript-md5.html](http://www.webtoolkit.info/javascript-md5.html)

虽然，我不相信它会访问本地文件系统，因为访问是有限的。

* * *

## 回答 #10

> 赞同：2
> 
> 时间：2019-09-03T06:01:19.520

希望您现在已经找到了一个好的解决方案。如果没有，下面的解决方案是基于[js-spark-md5的 ES6 Promise 实现](https://github.com/satazor/js-spark-md5)

```
import SparkMD5 from 'spark-md5';

// Read in chunks of 2MB
const CHUCK_SIZE = 2097152;

/**
 * Incrementally calculate checksum of a given file based on MD5 algorithm
 */
export const checksum = (file) =>
  new Promise((resolve, reject) => {
    let currentChunk = 0;
    const chunks = Math.ceil(file.size / CHUCK_SIZE);
    const blobSlice =
      File.prototype.slice ||
      File.prototype.mozSlice ||
      File.prototype.webkitSlice;
    const spark = new SparkMD5.ArrayBuffer();
    const fileReader = new FileReader();

    const loadNext = () => {
      const start = currentChunk * CHUCK_SIZE;
      const end =
        start + CHUCK_SIZE >= file.size ? file.size : start + CHUCK_SIZE;

      // Selectively read the file and only store part of it in memory.
      // This allows client-side applications to process huge files without the need for huge memory
      fileReader.readAsArrayBuffer(blobSlice.call(file, start, end));
    };

    fileReader.onload = e => {
      spark.append(e.target.result);
      currentChunk++;

      if (currentChunk < chunks) loadNext();
      else resolve(spark.end());
    };

    fileReader.onerror = () => {
      return reject('Calculating file checksum failed');
    };

    loadNext();
  }); 
```

* * *

## 回答 #11

> 赞同：0
> 
> 时间：2011-07-31T11:33:54.433

使用当前的 HTML5 应该可以计算二进制文件的 md5 哈希，但我认为之前的步骤是将二进制数据 BlobBuilder 转换为字符串，我正在尝试执行此步骤：但没有成功。

这是我尝试过的代码：[Converting a BlobBuilder to string, in HTML5 Javascript](https://stackoverflow.com/questions/6886933/converting-a-blobbuilder-to-string-in-html5-javascript)

* * *

## 回答 #12

> 赞同：-3
> 
> 时间：2009-04-20T13:37:52.107

我不相信 javascript 中有一种方法可以访问文件上传的内容。因此，您无法查看文件内容来生成 MD5 和。

但是，您可以将文件发送到服务器，然后服务器可以发回 MD5 和或发回文件内容.. 但这是很多工作，可能不值得为您的目的。

# c++ - 如何在 Qt 中的主线程和工作线程之间同步？

> ID：768276
> 
> 赞同：1
> 
> 时间：2009-04-20T13:33:55.830
> 
> 标签：c++, multithreading, qt, synchronization

我有这个设计。我无法达到我所需要的：

*   B 继承自 A。
*   A 继承自 QThread。

我的目标是在完成任务后重新启动（重新运行）到“工作”线程。我打算为这种方法调用工作线程析构函数，因为它从堆中获取内存。我需要清理所有相关变量。

我怎样才能做到这一点？

```
int main()
{
   // re-start start
    A* worker = B::getInstance();  
    worker->start();
   // re-start end

    return a.exec();
} 
```

编写 for 循环不是解决方案。因为，我需要学习完全停止工作线程。我尝试使用 worker->wait()。但它不起作用。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-04-20T18:57:25.130

使用`QThread`'s 信号[`finished()`](http://doc.trolltech.com/4.5/qthread.html#finished)怎么样？

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-04-20T14:12:45.767

我不完全理解您的问题，但是如果您分配线程并且在完成后必须重新启动它，您可以执行以下操作：

去检查：

*   要么在工作线程完成时在工作线程中设置一个变量，然后让主线程轮询该变量以进行设置。发生这种情况时，意味着线程已完成。
*   或者，让您的工作线程调用 postEvent() 以便将用户定义的事件发布到事件队列中。然后这个事件将被主线程收集，并采取相应的行动。

重新启动：

*   要么完全丢弃工作线程对象并创建一个新对象
*   或者在调用的私有 cleanup() 方法中使用清理代码：
    *   你运行线程（它做的第一件事）
    *   在析构函数中
    *   如果您想授予这种可能性，请将其公开并手动使用（危险，如果在线程运行时调用）

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-04-20T14:13:32.163

RAII（Resource Acquisition Is Initialization）中的一般规则是获取资源的代码负责确保它被释放。因此，您的工作线程应该在释放它获得的所有资源后终止。

主程序的一般风格将是：

*   初始化需要初始化的
*   在“永远”循环中，
*   初始化工作线程。
*   让它自由运行。
*   主线程可以完成其委托工作（将任务交给工作人员）
*   或者只是等待工人完成
*   并重复。

或者，主线程仍然可以在永久循环中运行，但会识别可委托任务何时到达，然后初始化工作线程并为其分配特定任务。这允许与不完整的可委派任务一样多的工作线程。您可能需要限制数量，以免有太多未完成的任务。

# visual-studio - 如何在 Visual Studio Pre-build 事件命令行中删除文件

> ID：768282
> 
> 赞同：63
> 
> 时间：2009-04-20T13:35:27.603
> 
> 标签：visual-studio, command-line, build-process, pre-build-event

我正在尝试`$(TargetDir)`在构建项目之前删除我在 Visual Studio 中的文件。

你必须如何格式化命令行来解决我遇到的这个问题？ ![替代文字](https://farm4.static.flickr.com/3575/3459516474_65f59767d4_o.png)

* * *

## 回答 #1

> 赞同：86
> 
> 时间：2009-04-20T13:41:16.030

尝试

```
cd $(TargetDir)
del *.tif 
```

正如 jvenema 指出的那样，您的 $(TargetDir) 正在扩展为文件夹名称中包含空格的路径，这破坏了删除命令。

* * *

## 回答 #2

> 赞同：30
> 
> 时间：2011-08-17T18:14:26.023

我最终使用`rd /s /q "$(TargetDir)"`清理目录。据我所知，它正在工作。

* * *

## 回答 #3

> 赞同：17
> 
> 时间：2009-04-20T13:36:25.887

尝试在目录周围添加引号。

* * *

## 回答 #4

> 赞同：13
> 
> 时间：2011-10-17T21:25:35.807

`del "$(TargetDir)*.tif"`由于目录路径中有空格，您必须编写。

* * *

## 回答 #5

> 赞同：9
> 
> 时间：2018-03-08T22:04:47.147

老问题，但有几件事：

```
del "$(TargetDir)*.tif" /q 
```

1) /q 代表安静。否则，del cmd 会提示“...Are you sure (Y/N)?” 构建不喜欢的。

2）正如许多人指出的那样，在targetDir周围的“”是目标目录中可能的空间。

* * *

## 回答 #6

> 赞同：-2
> 
> 时间：2017-04-20T23:47:35.927

wmic 进程在哪里`name='chromedriver.exe' delete`

# seo - 搜索引擎优化阅读材料和参考请求

> ID：768290
> 
> 赞同：3
> 
> 时间：2009-04-20T13:36:52.110
> 
> 标签：seo, reference

搜索引擎优化 (SEO) 似乎是我越来越多地遇到的一个话题，我想了解更多关于它的信息。

然而，似乎很难找到任何关于它的可靠信息。SEO 上的[维基百科页面](http://en.wikipedia.org/wiki/Search_engine_optimization)有一些一般信息和一点历史，但没有什么具体的。

[谷歌搜索任何](http://www.google.ca/search?q=search+engine+optimization)面向 SEO 的东西似乎主要返回 SEO 服务以供出租。

有没有人有一些文章、书籍或参考资料，他们可以指出我可以帮助加深对 SEO 的了解？

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2009-04-20T13:38:42.307

首先阅读 Google 的[SEO 入门指南](http://www.google.com/webmasters/docs/search-engine-optimization-starter-guide.pdf)。

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2009-04-21T14:55:03.210

[seomoz](http://www.seomoz.org)是一个很好的资源。您还可以在 YouTube 上搜索 SEO，并且有一些很棒的介绍性视频。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2011-10-24T07:49:29.977

希望对您的SEO有很大帮助。[SEO](http://allanpollett.com/index.html) [链接1](http://www.seocompany.ca/seo/seo-techniques.html) [SEO链接2](http://searchengineland.com/21-essential-seo-tips-techniques-11580) [SEO链接3 SEO链接4](http://www.theseomethod.com/) [SEO链接5](http://www.seotechniques.co.uk/) [SEO链接6](https://webmasters.stackexchange.com/)

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2013-11-24T06:54:29.460

试试这个你会得到一些好的材料

[搜索引擎优化材料](http://www.vhghorecha.in/seo-650006-material/ "搜索引擎优化材料")

# php - 使用地址条码编辑和创建东西？

> ID：768291
> 
> 赞同：1
> 
> 时间：2009-04-20T13:37:15.463
> 
> 标签：php, http-get

我该如何做，以便我可以在 .php 所在地址的末尾做一个事情，然后告诉它做某些事情。例如拉起这样的页面：

sampardee.com/index.php?page=whatever

帮助？

我还能用这个做什么？

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2009-04-20T13:43:27.087

这通常通过全局 php 数组 $_GET 来实现。您可以将其用作关联数组来“获取”您在 url 中命名的任何变量。例如您上面的网址：

```
//this gives the $page variable the value 'whatever'
$page = $_GET['page'];

if($page == 'whatever'){
//do whatever
}
elseif($page == 'somethingelse'){
//do something else
} 
```

查看 php 文档以获取更多信息：

[$_GET 文档](http://us3.php.net/manual/en/reserved.variables.get.php)

这里有一个教程：

[使用 QUERY_STRING 和 _GET 的教程](http://www.keithjbrown.co.uk/vworks/php/php_p2.php)

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-04-20T14:37:31.793

对 Brett 代码的一个小改进：

```
if (array_key_exists('page', $_GET) === false)
{
    $_GET['page'] = 'defaultPage';
}

$page = $_GET['page'];

// ... Brett Bender's code here 
```

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2009-04-20T15:38:43.970

**如果您使用 URL 将信息发送到另一个页面，则通常使用**$_GET 。****

 ****如果您从表单发送信息，通常使用**$_POST 。****

 **如果您需要编写代码以便它可以接受使用这两种方法发送的信息，您可以使用**$_REQUEST**。确保检查正在发送的信息，特别是如果您将其与数据库一起使用。

从您的问题来看，您似乎正在使用它在页面上显示不同的内容？

也许您想使用类似**开关**的东西来只允许使用某些页面名称？

IE

> $pageName=$_REQUEST['page'];
> 
> switch($pageName){
> case 'home':$include='home.php';break;
> case 'about':$include='about.php';break;
> 案例默认值：$include='error.php';break;
> }
> 包括（$包括）；

这是一个*非常*简化的示例，但除非 $page 变量是 home 或 about，否则网站将显示错误页面。

希望能帮助到你！

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2009-04-20T13:41:16.577

我不太确定你在问什么，但我认为你在问如何使用 GET 请求。

对任何 PHP 页面发出 GET 请求，如下所示：www.mysite.com/page.php?key1=value1&key2=value2

现在，在 PHP 中，您将能够看到 key1 -> value1、key2 -> value2。

从 PHP 中访问 GET 哈希，如下所示： $myVal1 = $_GET['key1'] #resolves to "value1" $myVal2 = $_GET['key2'] #resolves to "value2"

从这里开始，使用您认为合适的 GET 变量。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2009-04-20T13:42:18.417

将页面参数添加到 URL 的系统称为 HTTP GET（不同于 HTTP POST，以及其他一些不太常用的方法）。

看看这个[W3 学校](http://www.w3schools.com/PHP/php_get.asp)关于 GET 在 PHP 中的页面，并了解如何获取参数并在您的 PHP 代码中使用它们。

玩得开心！

# jquery - 具有自定义单元格颜色的 jqGrid

> ID：768299
> 
> 赞同：6
> 
> 时间：2009-04-20T13:39:41.777
> 
> 标签：jquery, grid, jqgrid

在 jqGrid（jquery 网格[http://www.trirand.com/blog/](http://www.trirand.com/blog/)）中是否有可能具有自定义单元格文本颜色，例如在价格列中，如果价格 > 100 美元，我想要红色，如果价格 < 50 美元，我想要绿色，否则为灰色？

更一般地做

1.  jqGrid 提供了更改网格单元格视图的钩子，例如，我可以在价格列的单元格创建或修改时注册回调。

2.  或者是否可以有单独的模型和视图（客户端），例如从服务器我可以为每行发送两个数据，即如何显示和显示什么

编辑：所以这是一个显示示例格式化程序的示例，它根据值对单元格进行着色

```
function infractionInFormatter(el, cellval, opts)
{
    $(el).html(cellval).css('color',infraction_color_map[cellval]);
}

colModel :[ 
    ...
    {name:'date', index:'date', width:120, date:true}, 
    {name:'inf_out', index:'inf_out', width:60, formatter:infractionInFormatter,},
    ...
], 
```

* * *

## 回答 #1

> 赞同：8
> 
> 时间：2009-04-20T15:27:38.240

是的，你可以这么做。编写[自定义格式化程序](http://www.secondpersonplural.ca/jqgriddocs/_2kn0mlo1p.htm)。这只是您在 colModel 中传递引用的函数。您会在函数中获得对最终单元格选择器的引用，因此您可以使用 jQuery 执行的任何操作都可以在格式化程序中执行。包括更改颜色/样式。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2010-09-24T10:44:42.107

您还可以在 colModel 中指定类：

```
colModel: [
           {
            name:'field_x', 
            index:'field_x',  
            align: 'left',  
            width:  35, 
            classes: 'cvteste'
           },
          .....
          ] 
```

* * *

## 回答 #3

> 赞同：-1
> 
> 时间：2010-07-08T09:56:35.980

如果单元格具有 xxx 值，我将设置红色背景颜色，如果值为 yyy，则设置绿色背景。

我写了这段代码：

```
.....
colModel:[
    {name:'id',index:'id', width:15,hidden:true, align:"center"},
    {name:'title',index:'title', width:150, align:"center"},
    {name:'start',index:'start', width:350, align:"center", sorttype:"date"},
    {name:'fine',index:'fine', width:350, align:"center", sorttype:"date"},
    {name:'completed',index:'completed', width:120, align:"center",formatter:infractionInFormatter},        
    ],
..... 
```

这个函数就像你的例子：

```
function infractionInFormatter(el, cellval, opts)
        {
            .....
        } 
```

我必须如何设置它？

非常感谢。

# wpf - WPF MVVM：ResourceDictionary 的约定优于配置？

> ID：768304
> 
> 赞同：7
> 
> 时间：2009-04-20T13:40:26.923
> 
> 标签：wpf, mvvm

* * *

**更新**

本着 StackOverflow 的 wiki 精神，这里有一个更新：

我在下面添加了 Joe White 的 IValueConverter 建议。它就像一个魅力。

我已经编写了一个“快速入门”示例，它使用一些廉价的字符串替换来自动映射 ViewModels->Views。如果没有找到代表 ViewModel 的 View，则默认为“正在建设中”页面。我将这种方法称为“WPF MVVM White”，因为这是 Joe White 的想法。这是几个屏幕截图。

第一张图片是“[SomeControlName]ViewModel”的案例，基于**纯命名约定**，有一个对应的“[SomeControlName]View” 。第二种情况是 ModelView 没有任何视图来表示它。不再有长 ViewModel 到 View 映射的 ResourceDictionaries。现在是纯粹的命名约定。

![Wpf Mvvm 白色](https://i.stack.imgur.com/vnZOm.jpg)

我在这里发布了该项目的下载： [Mvvm.White.Quickstart.zip](https://dl.dropbox.com/u/19646117/Mvvm.White.Quickstart.zip)

* * *

**原帖**

我在周末阅读了 Josh Smith关于 WPF MVVM的[精彩 MSDN 文章。](http://msdn.microsoft.com/en-us/magazine/dd419663.aspx)它注定会成为经典。

我花了一段时间才理解要求 WPF 呈现**ViewModel**的魔力。

这就像说“这是一个类，WPF。去找出使用哪个 UI 来呈现它。”

对于那些错过这个魔法的人，WPF 可以通过在 ResourceDictionary 映射中查找 ModelView 的View**并****拉出**相应的**View**来做到这一点。（向下滚动到[图 10 提供视图](http://msdn.microsoft.com/en-us/magazine/dd419663.aspx)）。

 ****我立即跳出来的第一件事是已经有一个强大的命名约定：

```
classNameView  ("View" suffix)
classNameViewModel ("ViewModel" suffix) 
```

我的问题是：

由于[ResourceDictionary](http://msdn.microsoft.com/en-us/library/system.windows.resourcedictionary.aspx)可以以编程方式进行操作，我想知道是否有人设法使用 Regex.Replace 整个东西，**所以查找是自动的**，并且任何新的 View/ViewModels 都通过它们的命名约定得到解决？

[编辑] 我想象的是对 ResourceDictionary 的钩子/拦截。

...还考虑在启动时使用互操作提取`*View$`和`*ViewModel$`类名在代码中构建 DataTemplate 字典的方法：

```
//build list
foreach ....
    String.Format("<DataTemplate DataType=\"{x:Type vm:{0} }\"><v:{1} /></DataTemplate>", ...) 
```

* * *

## 回答 #1

> 赞同：17
> 
> 时间：2009-04-25T16:53:06.530

与其编写代码显式地向 ResourceDictionary 添加内容，不如按需生成正确的视图？您可以使用 ValueConverter 执行此操作。

您的资源将如下所示：

```
<Views:ConventionOverConfigurationConverter x:Key="MyConverter"/>
<DataTemplate DataType="{x:Type ViewModels:ViewModelBase}">
    <ContentControl Content="{Binding Converter={StaticResource MyConverter}}"/>
</DataTemplate> 
```

您仍然需要一个 DataTemplate 资源，但只要您的 ViewModel 都有一个公共基类，您只需要一个 DataTemplate 来处理所有这些。

然后定义值转换器类：

```
public class ConventionOverConfigurationConverter : IValueConverter
{
    public object Convert(object value, Type targetType, object parameter,
        CultureInfo culture)
    {
        // value is the ViewModel. Based on its GetType(), build a string
        // with the namespace-qualified name of the view class, then:
        return Activator.CreateInstance(Type.GetType(viewName));
    }
    public object ConvertBack(object value, Type targetType,
        object parameter, CultureInfo culture)
    {
        throw new NotSupportedException();
    }
} 
```

您需要做的就是在 Convert 中编写逻辑，这取决于您的 View 和 ViewModel 是否在同一个命名空间中。

* * *

## 回答 #2

> 赞同：-1
> 
> 时间：2009-05-01T14:55:03.190

我决定做几乎相同的事情，所以我将我的 DataTemplates 直接加载到 ResourceDictionary 使用

```
 private void RegisterResources()
    {
        ResourceDictionary dictionary = new ResourceDictionary();
        dictionary.Source = new Uri("pack://application:,,,/StartupModule;Component/UIResources.xaml");
        Application.Current.Resources.MergedDictionaries.Add(dictionary);
    } 
```

其中 UIResources 文件是一个 ResourceDictionary xamls 文件，其中包含我们所有的 DataTemplates

# python - windows上从python连接odbc的常用方法？

> ID：768312
> 
> 赞同：23
> 
> 时间：2009-04-20T13:41:50.960
> 
> 标签：python, windows, odbc, pywin32, pyodbc

我应该使用什么库从 Windows 上的 python 连接到 odbc？就 odbc 而言，pywin32 有什么好的替代方案吗？

我正在寻找有据可查、健壮、积极维护等[`pyodbc`](https://github.com/mkleehammer/pyodbc)看起来不错的东西——还有其他的吗？

* * *

## 回答 #1

> 赞同：26
> 
> 时间：2009-04-20T14:26:37.810

你已经建议了**pyodbc**，我同意你的看法。

在我的经验中，它给了我最少的问题；我使用[了 pymssql](http://pymssql.sourceforge.net/)和[adodbapi](http://adodbapi.sourceforge.net/)，当它们抛出异常/创建问题时，我换掉了代码并用 pyodbc 替换它，它要么解决了问题，要么给出了更好的错误消息，以便我可以更快地调试。

值得一提的是，我主要使用它来连接**MSSQL Server 数据库**。

* * *

## 回答 #2

> 赞同：17
> 
> 时间：2009-04-20T13:47:27.840

我使用[SQLAlchemy](http://www.sqlalchemy.org)进行所有 python 数据库访问。我强烈推荐 SQLAlchemy。

SA 在连接到 SQL 服务器数据库时在后台使用 pyodbc。它使用其他 DBAPI 库连接到其他数据库，例如 cx_Oracle。

一个简单的示例，使用 SQLAlchemy，就像您通常使用 DBAPI 模块一样：

```
import sqlalchemy

engine = sqlalchemy.create_engine('sqlite:///database.db')
for r in engine.execute('SELECT * FROM T'):
    print(r.OneColumn, r.OtherColumn) 
```

但 SQLAlchemy 的真正价值在于它的[ORM](http://www.sqlalchemy.org/docs/05/ormtutorial.html)和[SQL 表达式语言](http://www.sqlalchemy.org/docs/05/sqlexpression.html)。看看，值得努力学习使用。

* * *

## 回答 #3

> 赞同：7
> 
> 时间：2012-09-26T04:19:18.490

另一种选择是用纯 Python 编写的[pypyodbc 。](https://github.com/jiangwen365/pypyodbc/)它可以看作是对 pyodbc 模块的重新实现——只有大约 1800 行代码，有利于维护。

这是[在 Python 中访问 mssql 的 Hello World 示例](https://github.com/jiangwen365/pypyodbc/wiki/A-Hello-World-script-of-pypyodbc)。

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2010-08-25T09:43:51.150

我在工作中使用 pyodbc，它从来没有让我失望（我们有各种 dbs）。它强大且快速。

它得到积极维护，python 3 版本即将推出。

如果您想要具有付费支持的“企业”软件，您可以使用[mxODBC](http://www.egenix.com/products/python/mxODBC/)。

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2017-04-12T11:11:48.400

您可以[试一试 turbodbc](https://github.com/blue-yonder/turbodbc)。从 1.1.1 版本开始，正式支持 Windows。很有可能它比 pyodbc 更快。

* * *

## 回答 #6

> 赞同：-3
> 
> 时间：2011-12-27T01:59:41.623

[pyodbc](https://github.com/mkleehammer/pyodbc)现在支持 Python 3 ！

# winapi - 检测桌面是否被锁定

> ID：768314
> 
> 赞同：6
> 
> 时间：2009-04-20T13:42:14.173
> 
> 标签：winapi, desktop

> **可能重复：**
> [如何以编程方式确定我的工作站是否被锁定？](https://stackoverflow.com/questions/44980/how-can-i-programmatically-determine-if-my-workstation-is-locked)

确定当前登录用户是否锁定桌面的最佳方法是什么？我查看了 MSDN，找不到任何 API 调用来检测这一点。我错过了什么，还是没有我可以使用的简单电话？

* * *

## 回答 #1

> 赞同：15
> 
> 时间：2009-04-20T21:25:45.617

答案取决于您是否想知道桌面*现在*是否被锁定，或者您是否想在桌面被锁定（并且可能是解锁）时收到通知。这还取决于您计划如何接收所述通知。

*   如果您真的想要一次性测试，那么[这里](https://stackoverflow.com/questions/44980/how-can-i-programmatically-determine-if-my-workstation-is-locked/44987#44987)的答案使用[`OpenDesktop()`](http://msdn.microsoft.com/en-us/library/ms684303(VS.85).aspx)并[`SwitchDesktop()`](http://msdn.microsoft.com/en-us/library/ms686347(VS.85).aspx)打开默认桌面的句柄并激活它 - 如果失败，那么这是桌面现在被锁定的好兆头。

*   如果您想要关于锁定/解锁的通知，并且您有一个带有窗口和消息泵的用户模式应用程序，那么您需要调用[`WTSRegisterSessionNotification()`](http://msdn.microsoft.com/en-us/library/aa383841(VS.85).aspx)并捕获`WM_WTSSESSION_CHANGE`消息。

*   如果您需要通知，并且您作为 Windows 服务运行，那么您可以通过调用`SetServiceStatus()`并添加[`SERVICE_ACCEPT_SESSIONCHANGE`](http://msdn.microsoft.com/en-us/library/ms685996(VS.85).aspx)到`dwControlsAccepted`您的状态结构来注册会话更改事件。然后，您将收到对您自己的服务控制[`HandlerEx()`](http://msdn.microsoft.com/en-us/library/ms683241(VS.85).aspx)函数的回调，并将其`dwControl`设置为`SERVICE_CONTROL_SESSIONCHANGE`。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-04-20T13:47:29.510

您可以挂钩[WM_WTSSESSION_CHANGE](http://msdn.microsoft.com/en-us/library/aa383828(VS.85).aspx)消息

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-04-20T13:47:53.317

您可以将[WTSRegisterSessionNotification](http://msdn.microsoft.com/en-us/library/aa383841(VS.85).aspx) 与 WTS_SESSION_LOCK 一起使用

* * *

## 回答 #4

> 赞同：-1
> 
> 时间：2009-04-20T18:29:31.157

以前的答案是错误的（状态更改）
使用 WTS api（已锁定）
它由 Windows 内部使用。始终在[Win32 组](http://news://nntp.aioe.org/comp.os.ms-windows.programmer.win32)上查看 Windows 内部 (MS)

# sql-server - sp_spaceused 和 DataLength SQL Server 之间的区别

> ID：768320
> 
> 赞同：4
> 
> 时间：2009-04-20T13:43:23.653
> 
> 标签：sql-server, sql-server-2005, datalength

当我使用 SP_SpaceUsed N'<TableName>' 时，我有一个单行表，它给我的数据为 16 KB

当我使用 dataLength 时，如下所示：-

```
选择 ClientID ,
(0 + isnull(datalength(ClientID), 1) +
isnull（数据长度（LeadID），1）+
isnull（数据长度（公司名称），1）+
isnull（数据长度（网站），1）+
isnull(datalength(EmployeeCount), 1) +
isnull（数据长度（收入），1）+
 isnull（数据长度（地址），1）+
isnull（数据长度（城市），1）+
isnull（数据长度（状态），1）+
isnull(数据长度(邮编), 1) +
isnull(数据长度(CountryID), 1) +
isnull（数据长度（电话），1）+
isnull（数据长度（传真），1）+
isnull（数据长度（时区），1）+
isnull（数据长度（SicNo），1）+
isnull（数据长度（SicDesc），1）+
 isnull（数据长度（研究分析），1）+
isnull(数据长度(SourceID), 1) +
isnull(数据长度(BasketID), 1) +
isnull(datalength(PipelineStatusID), 1) +
isnull（数据长度（SurveryID），1）+
isnull（数据长度（NextCallDt），1）+
isnull（数据长度（CurrentRecStatus），1）+
 isnull(数据长度(AssignedUserID), 1) +
isnull(数据长度(AssignedDate), 1) +
isnull（数据长度（TotValueAmt），1）+
isnull（数据长度（删除），1）+
isnull（数据长度（发布），1）+
isnull（数据长度（LegendID），1）+
isnull(数据长度(Inserted_Date), 1) +
 isnull（数据长度（Inserted_By），1）+
isnull(数据长度(Updated_Date), 1) +
isnull（数据长度（Updated_By），1））
as rowsize from TempLeadHeader order by rowsize desc

```

它给出行大小 167 我猜这是以字节为单位

我想知道为什么结果会出现这种差异

提前致谢

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2009-04-20T14:09:01.393

sp_spaceused 计算页面使用的空间，即 8k 块。请记住，表还包括占用空间的索引等内容。更不用说页面上的数据永远不会满，除非填充因子是 100%

datalength 会告诉你你的列有多少字节

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2009-04-20T14:20:48.510

您将 1 行与一个表进行比较，您必须对每一行求和，即使那样它也不会相同，因为您没有显示标题信息和索引数据

你也可以做这样的事情

```
dbcc showcontig ('TempLeadHeader') with tableresults 
```

然后查看最小、最大和平均记录大小列

# ruby-on-rails - 在多个 Rails 应用程序中重用 Ruby 代码

> ID：768322
> 
> 赞同：2
> 
> 时间：2009-04-20T13:44:14.447
> 
> 标签：ruby-on-rails, ruby, plugins, mercurial, reusability

我在 Ruby 中开发了一个简单的库，需要在几个 Rails 应用程序中使用它（其中一些尚未构建）。在需要时轻松将此 Ruby 库添加到多个 Rails 应用程序的最佳方法是什么？我们的团队正在运行 Ubuntu，我们的存储库是 Mercurial。

我应该使用...

1.  导轨插件？这将是我的第一选择，但它似乎不支持 Mercurial？
2.  红宝石？
3.  自定义 Rake 脚本？
4.  其他选择？？

任何指针将不胜感激！

* * *

## 回答 #1

> 赞同：11
> 
> 时间：2009-04-20T13:55:44.653

Ruby 已经建立了代码共享机制，即 RubyGems。[珠宝商](http://github.com/technicalpickles/jeweler/tree/master)使宝石创作变得容易。我建议你检查一下。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2009-04-20T14:37:39.217

制作 gem 或插件。我认为宝石更好，更易于管理。

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2009-04-20T19:25:53.767

我的经验法则：

如果它不依赖于rails，那就让它成为一个宝石。
如果它依赖于 Rails，请将其作为插件。

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2009-04-20T17:27:00.467

制作一个 Rails 插件。从某种意义上说，它不“支持” Mercurial，因为您无法`script/plugin install $REPO_URL`让它自动运行，但如果它是供您自己使用的，那么您将不会错过该功能。

# iphone - iPhone，向下滑动帮助屏幕

> ID：768326
> 
> 赞同：2
> 
> 时间：2009-04-20T13:46:18.297
> 
> 标签：iphone, objective-c

我喜欢许多 iPhone 应用程序中使用的效果，其中半透明的帮助屏幕从当前视图的顶部（或底部）滑动以显示提示或提示。该屏幕通常有一个关闭按钮以及“不再显示”按钮。

在当前视图上滑动视图以获得这种效果的最佳方法是什么？有人可以指出我的任何代码示例吗？

谢谢

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2009-04-20T14:17:28.940

你会想从主视图控制器做这样的事情..

```
-(void)showHelp
{
     HelpViewController *controller = [[HelpViewController alloc]init];
     [self presentModalViewController:controller animated:YES];
     [controller release];
} 
```

并且完成按钮将回调主控制器或使用

```
- (void)dismissModalViewControllerAnimated:(BOOL)animated 
```

这是[UIViewController](http://developer.apple.com/iphone/library/documentation/UIKit/Reference/UIViewController_Class/Reference/Reference.html)类的文档。您需要的方法可以在那里找到。

不再显示功能意味着您必须将他们的选择保存到 NSUserDefaults 或其他地方（sqllite，文件系统）。然后你可以在你的应用程序启动时读回它以确定你是否应该调用 showHelp。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-04-20T17:01:49.513

根据您的描述，并查看[iPhone Human Interface Guidelines](http://developer.apple.com/iphone/library/documentation/UserExperience/Conceptual/MobileHIG/ModalViews/ModalViews.html#//apple_ref/doc/uid/TP40006556-CH11-SW1)，您需要[UIActionSheet](http://developer.apple.com/iphone/library/documentation/UIKit/Reference/UIActionSheet_Class/Reference/Reference.html) ，因为默认情况下模式视图不是半透明的。

`UIActionSheet`也可以更好地使用您想要的东西。您应该能够在一行中实现您的目标。

# forms - Safari：按下 Enter 键时使用 xhrPost 提交表单

> ID：768334
> 
> 赞同：0
> 
> 时间：2009-04-20T13:48:10.787
> 
> 标签：forms, safari, submit, xmlhttprequest

我已将 JavaScript 函数绑定到表单的提交按钮，导致表单通过 xhrPost 请求（使用 Dojo）提交。但是，当用户在 Safari 中点击“Enter”时，表单会以通常的方式提交。

有什么方法可以阻止 Safari 在按下 Enter 键时提交表单？我可以以某种方式将我的 JavaScript 函数绑定到 enter 键吗？

提前非常感谢！

——安德烈亚斯

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-07-17T03:38:06.857

`false`您是否从处理程序返回值`onsubmit`？这就是阻止正常表单提交所需的全部内容（前提是启用了 Javascript）。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-04-20T22:53:55.920

这可能是由于提交处理程序代码中的错误 - 如果那里有异常，Safari 将照常提交表单。检查 Safari 控制台是否显示任何错误。

当`<input>`元素在`<form>`标签之外时，我也遇到过类似的问题。仔细检查一下，也许。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-06-11T19:31:59.193

我解决这个问题的方法是禁用“Enter”键。不是很优雅，仍在​​寻找更好的方法。

`$('form').keypress(function (e){ if((e.which==13){ return false; }});`

# c# - 为 64 位操作系统包装 32 位 dll 以使用 regsvr32.exe

> ID：768336
> 
> 赞同：9
> 
> 时间：2009-04-20T13:48:58.837
> 
> 标签：c#, asp-classic, dllregistration

我们目前正在将我们的网站从 Windows 2003（32 位）转移到 Windows 2008（64 位）并且遇到了问题。

我们的一个网站使用支付网关 HSBC CPI，它需要注册一个 DLL (regsvr32.exe)，然后在一个经典的 asp 网站中使用这个 DLL。问题是 DLL 是 32 位 DLL，因此它不会在 Windows 2008 操作系统中注册。

有没有办法可以将这个 32 位 dll 包装在 ac#.net 项目中，以便公开它的方法并可以在操作系统中注册？

任何帮助将不胜感激。

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2009-04-20T13:55:03.673

您可以使用 C:\Windows\SysWOW64 文件夹中的 regsvr32.exe 注册 DLL。

但是，由于您不能混合 64/32 位代码，您必须创建一个在 x86 中运行的 C# 服务（请参阅项目属性、平台目标），然后您可以通过 WCF 从您的 x64 Web 应用程序使用该服务。

一个更简单的选择是向 HSBC 索要 x64 dll。

* * *

## 回答 #2

> 赞同：6
> 
> 时间：2010-09-10T21:18:35.967

如果要注册使用 VC++ 或 Visual Basic 6.0 创建的 32 位 COM dll，则必须按照以下步骤操作，而无需对代码进行任何更改。它也不需要进行任何编译，您也不必在 WOW 模式下运行 IIS。几年前我遇到过这个问题，我解决了这个问题，它对我来说很好。

设想：

让我假设您有一个供应商提供的第 3 方 32 位 COM DLL。该 DLL 在 32 位操作系统上运行良好，当您移至 x64 环境时，即使您尝试通过 regsv32 注册它，它也无法运行。

还让我假设 DLL 的名称是“ASXUpload.DLL”。我将在下面提供的解决方案中使用此名称。

解决方案

请按照以下步骤操作：

1.  首先，如果您已经在 x64 操作系统中注册了 DLL，请取消注册 DLL。为此，只需在运行命令“regsvr32 /u”中键入以下内容，例如“regsvr32 /u C:\MyDLL\ASXUpload.DLL”。如果您已经从 x64 操作系统注销 DLL，则无需运行此步骤。

2.  还要确保您没有将 DLL 保存在通常为 C:\Windows 的 Windows 文件夹中。对于此示例，我将 DLL 保存在以下文件夹 C:\MyDLL 中。

3.  现在我们需要使用 Microsoft 的 Component Services 添加 COM+ 组件。要启动组件服务，请转到控制面板/管理工具/组件服务。一旦进入组件服务，深入到计算机，然后是我的电脑，然后是 COM+ 应用程序。然后右键单击 COM+ 应用程序并选择“新建”->“应用程序”。

4.  在“欢迎使用 COM 应用程序安装向导”屏幕上，单击“下一步 >”。

5.  单击“创建空应用程序”按钮。

6.  输入名称。由于我的 DLL 名称是 ASXUpload.dll，所以我将名称输入为“ASXUpload”。当询问“库或服务器”时，选择“服务器”。

7.  单击“下一步>”按钮，然后选择“此用户”。

8.  输入用户或单击浏览以选择用户。单击浏览更安全，以确保使用正确的域和拼写。输入密码并确认密码。警告，如果需要，请务必包含域/用户名。点击“完成”。（注意：我们推荐“此用户”，否则，必须有人登录服务器才能运行 DLL。）。就我而言，我选择了域管理员帐户。您还可以添加服务帐户。如果您不确定，请咨询您的系统管理员。

9.  现在将出现“添加应用程序角色”屏幕。不要添加任何内容，只需单击“下一步>”按钮。

10.  现在出现“将用户添加到角色”屏幕。不要添加任何内容，只需单击“下一步>”按钮。

11.  现在您将看到在组件服务 -> 计算机 -> 我的电脑 -> COM+ 应用程序 -> 您将看到新添加的应用程序。在此示例中，应用程序名称将是“ASXUpload”。现在通过单击“+”图标深入了解新添加的应用程序“ASXUpload”，您将看到“组件”。

12.  现在右键单击“组件”，然后选择“新建组件”。在“欢迎使用 COM 应用程序安装向导”屏幕上，单击“下一步 >”。

13.  单击“安装新组件”，然后选择要注册的 DLL。在这种情况下，它将是“C:\MyDLL\ASXUpload.DLL”。

14.  选择 DLL 后，您会看到它会显示找到的组件。单击“下一步>”按钮继续，最后单击“完成”按钮完成。

15.  现在是棘手的部分。右键单击您添加的应用程序，您将在组件服务 -> 计算机 -> 我的电脑 -> COM+ 应用程序下找到该应用程序。在我的例子中，应用程序名称是“ASXUpload”。右键单击应用程序后选择“属性”。应用程序属性窗口将打开。单击“安全”选项卡。在“安全”选项卡中，确保未选中“授权”部分下的“强制执行此应用程序的访问检查”复选框。

在“安全级别”部分下，选择单选按钮“仅在进程级别执行访问检查。安全属性不会包含在对象上下文中。COM+ 安全调用上下文将不可用。”</p>

确保未选中“应用限制策略”选项。

将“模拟级别”设置为“匿名”</p>

16.  如果要从 Web 应用程序访问 DLL，请确保添加 IUSR 和 IWAM 帐户。为此，请转到 COM+ 应用程序 -> 应用程序名称（在本例中为 ASXUpload）-> 角色 -> CreateOwner -> 用户。右键单击用户并添加 Internet Information Server 使用的 IUSR 和 IWAM 帐户。

17.  还要对保存 DLL 的文件夹设置 NTFS 权限。在这种情况下，我将 DLL 保存在文件夹 C:\MyDLL 中。现在右键单击文件夹“MyDLL”并转到安全选项卡，然后添加 IUSR 和 IWAM 帐户。

这就是您需要做的所有事情，并且您应该能够使用 DLL。

我在过去曾在生产环境中工作过的两个不同组织中使用过这种技术两次，并且没有任何问题。首先我在 2005 年尝试过，然后在 2008 年再次使用它。

如果您遇到任何问题，请告诉我。

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2009-11-24T17:16:03.830

我们在 HSBC Cpi 接口上遇到了同样的问题。

HSBC 不提供 .Net 包装器，并且无法从 64 位应用程序调用 COM 包装器。

这使得从 64 台服务器（可能覆盖 25% 的新生产服务器）上部署它几乎是不可能的。

我们查看了列出的一些方法，但它们似乎需要做很多工作。最后经过一番折腾，我们想出了自己的实现，看起来像这样。

使用以下 Java 代码获取中间哈希

```
import java.io.Console;
import java.lang.*;
import java.util.*;
import com.clearcommerce.CpiTools.security.HashGenerator;
import com.clearcommerce.CpiTools.security.SecCrypto;
import javax.xml.bind.annotation.adapters.HexBinaryAdapter;
import java.io.ByteArrayOutputStream;
import java.io.IOException;
import java.security.GeneralSecurityException;
import java.util.Vector;
import javax.crypto.Mac;
import javax.crypto.spec.SecretKeySpec;

public class Extract {

    /**
     * @param args
     */
    public static void main(String[] args) {
        // TODO Auto-generated method stub
        try
        {
            String encryptedKey = "<YOUR SECRET KEY HERE>";
            if (args.length == 1)
                encryptedKey = args[0];

            HexBinaryAdapter hb = new HexBinaryAdapter();
            SecCrypto sc = new SecCrypto();

            byte abyte0[] = sc.decryptToBinary(encryptedKey);
            System.out.println("New Secret Base64 Encoded : " + new String(Base64Coder.encode(abyte0)));
            System.out.println("New Secret Hex Encoded    : " + hb.marshal(abyte0));
            return;
        }
        catch(Exception ex)
        {
            System.out.println("Error:" + ex.getMessage());
        }
    }
} 
```

然后使用以下 .net 代码计算哈希

```
using System;
using System.Collections.Generic;
using System.Text;

namespace HsbcIntergration
{
    internal static class CpiHashing
    {
        <USE THE VALUE RETURNED FROM THE JAVA CODE HERE>
        private static readonly byte[] _secret = new byte[] { 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00 };

        public static string ComputeHash(List<string> inputList)
        {
            return ComputeHash(inputList, _secret);
        }

        public static string ComputeHash(List<string> inputList, byte[] secretData)
        {
            List<string> orderedDataToHash = new List<string>(inputList);
            orderedDataToHash.Sort(StringComparer.Ordinal);

            StringBuilder sb = new StringBuilder();
            foreach (string s in orderedDataToHash)
                sb.Append(s);

            List<byte> dataToHash = new List<byte>();
            dataToHash.AddRange(Encoding.ASCII.GetBytes(sb.ToString()));
            dataToHash.AddRange(secretData);

            System.Security.Cryptography.HMAC sha = System.Security.Cryptography.HMACSHA1.Create();
            sha.Key = secretData;
            return Convert.ToBase64String(sha.ComputeHash(dataToHash.ToArray(), 0, dataToHash.Count));
        }
    }
} 
```

# iphone - 为什么 UIWebView 不断检测电话号码？

> ID：768337
> 
> 赞同：7
> 
> 时间：2009-04-20T13:49:05.137
> 
> 标签：iphone, cocoa-touch, uiwebview

我有一个未选中检测电话号码的 UIWebView。但是，它不断强调本文中的数字：

```
Version: 2.1 3.19.2009 
```

文本不在锚点或任何东西中。有没有办法强制 UIWebView 不检测电话号码？

* * *

## 回答 #1

> 赞同：18
> 
> 时间：2010-02-25T06:38:15.743

尝试

```
webview.dataDetectorTypes = UIDataDetectorTypeNone; 
```

* * *

## 回答 #2

> 赞同：11
> 
> 时间：2009-04-20T14:29:24.747

Interface Builder 的 UIWebView 属性面板似乎有问题；“检测电话号码”复选框似乎没有任何影响。在运行时检查 UIWebView 的检测电话号码属性表明它实际上没有被 IB 修改。

目前，将代码中的检测电话号码属性设置为“否”可以正常工作。问题仅在于 IB 调色板。

除非我们都缺少某些东西，否则这是一个错误。我建议在[http://bugreport.apple.com/](http://bugreport.apple.com/)上提交它。此外，如果您想让其他开发人员看到它，您可以在[http://openradar.appspot.com/上发布它。](http://openradar.appspot.com/)

* * *

## 回答 #3

> 赞同：7
> 
> 时间：2017-04-27T17:36:32.897

## Swift 3+ 以编程方式

```
webView.dataDetectorTypes = [] 
```

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2011-07-22T06:47:50.093

```
[webview setDetectsPhoneNumbers:NO]; 
```

它会为你工作......

# c# - 正确评估表达式

> ID：768338
> 
> 赞同：2
> 
> 时间：2009-04-20T13:49:42.610
> 
> 标签：c#, expression

我在别人的代码中遇到了以下表达式。我认为这是一个糟糕的代码，原因有很多（尤其是因为它没有考虑到 bool.TrueString 和 bool.FalseString），但我很好奇编译器将如何评估它。

```
private bool GetBoolValue(string value)
{
    return value != null ? value.ToUpper() == "ON" ? true : false : false;
} 
```

**编辑** 顺便说一句，表达式不是从内向外评估的吗？在这种情况下，在调用 value.ToUpper() 之后检查 value != null 的意义何在，这将引发空引用异常？

我认为以下是正确的（故意）冗长的版本（我永远不会这样 :D ）：

```
if (value != null)
{
    if (value.ToUpper() == "ON") 
    {
        return true;
    }
    else        // this else is actually pointless
    {
        return false;
    }
}
else
{
    return false;
} 
```

可以缩短为：

```
return value != null && value.ToUpper == "ON"; 
```

这是对表达式的正确重写吗？

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2009-04-20T14:17:38.017

看起来该方法旨在处理来自`checkbox`HTML 元素的值。如果未为复选框指定值，则`"on"`默认使用该值。如果未选中该复选框，则表单数据中根本没有任何值，因此从中读取键`Request.Form`会给出空引用。

在这种情况下，该方法是正确的，尽管由于使用了`if-condition-then-true-else-false`反模式，它非常可怕。此外，它应该被赋予一个更适合其特定用途的名称，例如`GetCheckboxValue`.

您对方法的重写是正确且合理的。由于该值不依赖于文化，因此将值转换为大写不应使用当前文化。因此，比您建议的更好的重写将是：

```
return value != null && value.ToUpperInvariant == "ON"; 
```

（文化独立的方法也比使用特定文化的方法快一点，所以没有理由不使用它们。）

> 顺便说一句，表达式不是从内向外计算的吗？

如果是方法调用，以便实际评估所有表达式，它们会，因为必须进行内部调用来评估外部调用的参数。

但是，条件表达式的第二个和第三个操作数只有在使用时才会被计算，因此表达式是从外部和内部计算的。首先评估最外面的条件以确定它将评估哪些操作数。

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2009-04-20T13:52:27.470

你是正确的，在你的重写和你断言这种简洁的尝试是不好的，因为它会导致混乱。

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2009-04-20T13:57:11.313

那么第一个是双嵌套的三元运算符

```
return (value != null) ? [[[value.ToUpper() == "ON" ? true : false]]] : false; 
```

[[[ ]]] 中的位是三元表达式的第一个结果，当第一个条件为真时评估它，因此您正在阅读/断言它是正确的

但它的丑陋如地狱，在当前状态下非常不可读/不可维护。我肯定会把它改成你最后的建议

边注：

做的人

```
if(X == true) 
   return true;
else
   return false; 
```

代替

```
 return X; 
```

应该取出并射击;-)

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2009-04-20T14:10:21.657

您是否正在寻找速度或可读性和组织？执行速度，您缩短的示例可能是最好的方法。

多花几毫秒，您可以将此实用程序方法重写为扩展方法，如下所示：

```
public static bool ToBoolean(this string value)
{

    // Exit now if no value is set
    if (string.IsNullOrEmpty(value)) return false;

    switch (value.ToUpperInvariant())
    {
        case "ON":
        case "TRUE":
            return true;
    }

    return false;

} 
```

...然后您将按如下方式使用它：

```
public static void TestMethod()
{
    bool s = "Test".ToBoolean();
} 
```

编辑：实际上，我错了......快速性能测试表明扩展方法比内联方法**更快。**我的测试来源如下，以及我电脑上的输出。

```
[Test]
public void Perf()
{

    var testValues = new string[] {"true", "On", "test", "FaLsE", "Bogus", ""};
    var rdm = new Random();
    int RunCount = 100000;
    bool b;
    string s;

    Stopwatch sw = Stopwatch.StartNew();
    for (var i=0; i<RunCount; i++)
    {
        s = testValues[rdm.Next(0, testValues.Length - 1)];
        b = s.ToBoolean();
    }
    Console.Out.WriteLine("Method 1: {0}ms", sw.ElapsedMilliseconds);

    sw = Stopwatch.StartNew();
    for (var i = 0; i < RunCount; i++)
    {
        s = testValues[rdm.Next(0, testValues.Length - 1)];
        b = s != null ? s.ToUpperInvariant() == "ON" ? true : s.ToUpperInvariant() == "TRUE" ? true : false : false;
    }
    Console.Out.WriteLine("Method 2: {0}ms", sw.ElapsedMilliseconds);

} 
```

输出：

```
Method 1: 21ms
Method 2: 30ms 
```

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2009-04-20T13:55:14.000

我以与您相同的方式阅读原始表达。所以我认为你缩短的表达是正确的。如果 value 为 null 它永远不会到达第二个条件，所以对我来说它看起来很安全。

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2009-04-20T13:58:16.817

我也讨厌这样的结构：

```
if (value.ToUpper() == "ON") 
{
    return true;
}
else        // this else is actually pointless
{
    return false;
} 
```

正如您所注意到的，这是一种冗长而复杂（不是说愚蠢）的写作方式：

```
return value.ToUpper() == "ON"; 
```

你的提议很好，简短而正确。

* * *

## 回答 #7

> 赞同：0
> 
> 时间：2009-04-20T14:24:06.270

另一种选择：

```
return string.Equals( value, "ON", StringComparison.OrdinalIgnoreCase ); 
```

# c++ - 哪些开源 COM 实现适用于嵌入式系统？

> ID：768339
> 
> 赞同：0
> 
> 时间：2009-04-20T13:50:04.387
> 
> 标签：c++, com, open-source, embedded

我正在考虑在具有有限 C++ 编译器的嵌入式（非 Windows）系统中使用 COM 接口，并且我正在寻找使用简单 C++ 的开源 COM 实现，特别是很少或不使用模板并且不使用异常（是的，我知道 COM 不使用异常，但实现可以在内部使用它们）。

在这一点上，我主要在寻找所有核心 COM 类型的 C++ 定义，即 IUnknown、IDispatch、VARIANT 等，以及一些用于智能指针、BSTR 等的辅助类。对实现 QueryInterface 和 IDispatch 的某种程度的支持可能很好，但我我自己也可以这样做。我想找到一个 ITypeInfo 实现，而 DCOM 的嵌入式实现会很有吸引力。

我知道我可以使用 Microsoft 随 Visual Studio 提供的源代码，但我宁愿避免使用它，因为引入很多我不需要的定义很复杂，而且我想避免在非计算机上使用它时可能出现的任何法律问题-Windows 平台。我也非常熟悉 ATL，由于编译器的限制，我不能使用这种大量模板化的方法。我在 COM 和 DCOM 方面拥有丰富的经验，因此我可以自己编写所有的定义和辅助类，如果需要，我什至可以编写自己的 DCOM 系统。但如果有的话，我宁愿使用现有的开源实现。你有什么建议？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-04-20T18:22:04.157

几年前，我正在考虑启动 COM/DCOM 的 FOSS 实现，但没有成功，主要是因为我认为开源社区中的任何人都不会对此感兴趣。Software AG 的专有实现（称为 EntireX DCOM），我认为您不会感兴趣。

至于开源项目，除了 Samba 和 Wine 的实现以及 Mozilla 中的 XPCOM 之外，还有[OpenCOM](http://www.comp.lancs.ac.uk/computing/research/mpg/reflection/opencom.php)。他们已经在[SourceForge 上](http://opencomc.sourceforge.net/)发布了他们的代码。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-04-20T17:12:20.797

我所知道的最接近的开源实现是 Mozilla 的[XPCOM](http://www.mozilla.org/projects/xpcom/)（它与 Microsoft 的 COM 不完全相同，但非常相似）。但是我不确定是否仍然可以独立构建它，因为[提供的说明](http://developer.mozilla.org/en/docs/Standalone_XPCOM)现在已经过时了。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2009-04-20T17:42:38.213

我建议看看[Wine](http://www.winehq.org/)。源代码是 C 语言，而不是 C++，因此避免了完全 C++ 支持、C++ 模板等的任何和所有问题。Wine 还实现了许多（大多数？）标准接口。

例如，[LoadTypeLib](http://msdn.microsoft.com/en-us/library/ms221027.aspx)（返回[ITypeInfo](http://msdn.microsoft.com/en-us/library/ms221696.aspx?ppud=4)实现）的源代码位于[dlls/oleaut32/typelib.c:383](http://source.winehq.org/git/wine.git?a=blob;f=dlls/oleaut32/typelib.c;h=a0af8473c4e63fe3f85ae660e006c6c18cab8ffb;hb=HEAD#l383)中。 [ITypeInfo::AddressOfMember](http://msdn.microsoft.com/en-us/library/ms221544.aspx)位于[typelib.c:6742](http://source.winehq.org/git/wine.git/?a=blob;f=dlls/oleaut32/typelib.c;h=a0af8473c4e63fe3f85ae660e006c6c18cab8ffb;hb=HEAD#l6742)（在 ITypeInfo_fnAddressOfMember 中）。

（看到 COM 用 C 实现有点奇怪，但 COM 正是出于这个原因定义了*二进制*标准，因此 COM 组件可以用任何语言实现，而不会限制使用语言......）

# windows - 从可执行文件设置变量

> ID：768347
> 
> 赞同：1
> 
> 时间：2009-04-20T13:53:09.810
> 
> 标签：windows, batch-file, cmd

我在带有两个参数的批处理文件中运行可执行文件；

`cmd /k ""executable" "param1" "param2""`

这将返回一个我想要启动的字符串。我不知道如何在变量中设置这个返回值，然后在 IE 中启动它。

有任何想法吗？

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2009-04-20T14:32:09.077

如果返回的字符串包含一行，您可以使用它**`FOR /F`**来设置环境变量的值。例如：

**`s1.cmd`**

```
echo this is a one line string 
```

**`s2.cmd`**

```
@SETLOCAL
@ECHO OFF
for /f "tokens=*" %%a in ('cmd /c s1.cmd') do set MY_VAR=%%a
echo got: %MY_VAR%
ENDLOCAL 
```

**结果**

```
C:\> s2.cmd
got: this is a one line string

C:\> 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-04-20T14:55:30.500

您可以使用以下语法将可执行文件的输出捕获到变量中：

```
FOR /F "tokens=*" %%i in ('%~dp0YOUR_APP.exe') do SET TOOLOUTPUT=%%i 
```

[来源](http://weblogs.asp.net/lorenh/archive/2006/03/24/silly-batch-file-tricks-redirecting-stdout-into-an-evironment-variable-and-dp0.aspx "来源")

然后你可以像这样将值传递给 IE：

```
START "YOUR_WINDOW_NAME" /MAX /D"C:\Program Files\Internet Explorer\" iexplore %TOOLOUTPUT% 
```

我认为确定 url 的应用程序代码太复杂而无法直接在批处理文件中复制，或者可执行文件的源代码已经丢失。如果不是，我个人更希望在批处理文件本身中显示逻辑。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-04-20T13:55:04.937

`start %1 %2`

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2009-04-20T14:08:27.387

编辑：Romulo A. Ceccon 发布[了一个更好的解决方案](https://stackoverflow.com/questions/768347#768524)，它不涉及任何文件系统访问和肮脏的技巧。将其留在这里以供参考（如果您需要 9x 兼容性，它也适用于 command.com），但请更喜欢 Romulo 的解决方案。

* * *

通过使用从模板动态生成的中间帮助脚本来检查您设置的环境变量。您将需要某处的写入权限，否则无法完成（Windows 命令外壳语言非常非常有限。）

`helper.tpl`让我们使用以下内容调用您的帮助脚本模板：

```
set INTERMEDVAR= 
```

确保它`helper.tpl`只有一行（没有尾随 CRLF！），并确保在等号后没有任何空格。

现在，在您的主脚本中，将命令的输出捕获到一个临时文件中（我们称之为`my_output_file.tmp`）：

```
cmd /k ""executable" "param1" "param2"" > my_output_file.tmp 
```

然后将帮助模板的内容和输出一起复制到你的帮助脚本中，我们称之为`my_helper_script.cmd`：

```
copy /b helper.tpl + my_output_file.tmp my_helper_script.cmd 
```

然后在当前上下文中评估帮助脚本：

```
call my_helper_script.cmd 
```

现在 INTERMEDVAR 变量设置为“可执行文件”输出的第一行（如果它输出多行，则您自己...）您现在可以调用 IE：

```
start iexplore.exe "%INTERMEDVAR%" 
```

并且不要忘记清理创建的文件：

```
del /q /f my_output_file.tmp my_helper_script.cmd 
```

当并行调用多次时，这显然不起作用 - 您必须使用当前 cmd.exe 的 PID（例如）参数化临时文件和帮助脚本名称，以便它们不会覆盖彼此的输出，但原则是一样的。

但是，如果您可以获得真正的外壳，请使用它。cmd.exe 极其繁琐。

# c++ - 使用 Boost::Signals 进行 C++ 事件的完整示例

> ID：768351
> 
> 赞同：63
> 
> 时间：2009-04-20T13:53:36.127
> 
> 标签：c++, boost-signals

我知道 boost.org 上的教程解决了这个问题： [Boost.org Signals Tutorial](http://www.boost.org/doc/libs/1_38_0/doc/html/signals/tutorial.html)，但是这些示例并不完整，而且有些过于简化。那里的示例没有显示包含文件，并且代码的某些部分有点模糊。

**这是我需要的：**
ClassA 引发多个事件/信号
ClassB 订阅这些事件（多个类可以订阅）

在我的项目中，我有一个较低级别的消息处理程序类，该类将事件引发到业务类，该业务类对这些消息进行一些处理并通知 UI (wxFrames)。我需要知道这些都是如何连接起来的（什么顺序，谁打电话给谁，等等）。

* * *

## 回答 #1

> 赞同：94
> 
> 时间：2009-04-21T00:55:30.340

下面的代码是您所要求的最小工作示例。 `ClassA`发出两个信号；`SigA`不发送（并接受）任何参数，`SigB`发送一个`int`. `ClassB`有两个函数将`cout`在调用每个函数时输出。在示例中，有一个`ClassA`( `a`) 的实例和两个`ClassB`(`b`和`b2`) 的实例。 `main`用于连接和触发信号。值得注意的是，`ClassA`它们`ClassB`彼此一无所知（即它们不受*编译时限制*）。

```
#include <boost/signal.hpp>
#include <boost/bind.hpp>
#include <iostream>

using namespace boost;
using namespace std;

struct ClassA
{
    signal<void ()>    SigA;
    signal<void (int)> SigB;
};

struct ClassB
{
    void PrintFoo()      { cout << "Foo" << endl; }
    void PrintInt(int i) { cout << "Bar: " << i << endl; }
};

int main()
{
    ClassA a;
    ClassB b, b2;

    a.SigA.connect(bind(&ClassB::PrintFoo, &b));
    a.SigB.connect(bind(&ClassB::PrintInt, &b,  _1));
    a.SigB.connect(bind(&ClassB::PrintInt, &b2, _1));

    a.SigA();
    a.SigB(4);
} 
```

输出：

```
富
酒吧：4
酒吧：4

```

为简洁起见，我采用了一些您通常不会在生产代码中使用的快捷方式（特别是访问控制松懈，您通常会将信号注册“隐藏”在 KeithB 示例中的函数后面）。

似乎大部分的困难在于`boost::signal`习惯使用`boost::bind`. 一开始*有点*想不通！对于一个更棘手的示例，您也可以使用*to*`bind` hook up `ClassA::SigA`with`ClassB::PrintInt`即使`SigA`不发出：*`int`*

 *```
a.SigA.connect(bind(&ClassB::PrintInt, &b, 10)); 
```

希望有帮助！

* * *

## 回答 #2

> 赞同：12
> 
> 时间：2009-04-20T21:13:54.367

这是我们代码库中的一个示例。它被简化了，所以我不保证它会编译，但它应该很接近。Sublocation 是您的 A 类，而 Slot1 是您的 B 类。我们有许多这样的插槽，每个插槽都订阅不同的信号子集。使用这种方案的优点是 Sublocation 对任何插槽一无所知，插槽不需要成为任何继承层次结构的一部分，只需要为它们关心的插槽实现功能。我们使用它通过非常简单的界面将自定义功能添加到我们的系统中。

子定位.h

```
class Sublocation 
{
public:
  typedef boost::signal<void (Time, Time)> ContactSignal;
  typedef boost::signal<void ()> EndOfSimSignal;

  void endOfSim();
  void addPerson(Time t, Interactor::Ptr i);

  Connection addSignalContact(const ContactSignal::slot_type& slot) const;
  Connection addSignalEndOfSim(const EndOfSimSignal::slot_type& slot) const;    
private:
  mutable ContactSignal fSigContact;
  mutable EndOfSimSignal fSigEndOfSim;
}; 
```

子定位.C

```
void Sublocation::endOfSim()
{
  fSigEndOfSim();
}

Sublocation::Connection Sublocation::addSignalContact(const ContactSignal::slot_type& slot) const
{
  return fSigContact.connect(slot);
}

Sublocation::Connection Sublocation::addSignalEndOfSim(const EndOfSimSignal::slot_type& slot) const
{
  return fSigEndOfSim.connect(slot);
}

Sublocation::Sublocation()
{
  Slot1* slot1 = new Slot1(*this);
  Slot2* slot2 = new Slot2(*this);
}

void Sublocation::addPerson(Time t, Interactor::Ptr i)
{
  // compute t1
  fSigOnContact(t, t1);
  // ...
} 
```

插槽1.h

```
class Slot1
{
public:
  Slot1(const Sublocation& subloc);

  void onContact(Time t1, Time t2);
  void onEndOfSim();
private:
  const Sublocation& fSubloc;
}; 
```

插槽1.C

```
Slot1::Slot1(const Sublocation& subloc)
 : fSubloc(subloc)
{
  subloc.addSignalContact(boost::bind(&Slot1::onContact, this, _1, _2));
  subloc.addSignalEndSim(boost::bind(&Slot1::onEndSim, this));
}

void Slot1::onEndOfSim()
{
  // ...
}

void Slot1::onContact(Time lastUpdate, Time t)
{
  // ...
} 
```

* * *

## 回答 #3

> 赞同：6
> 
> 时间：2009-04-20T14:17:20.983

你看过[boost/libs/signals/example](http://svn.boost.org/svn/boost/trunk/libs/signals/example/)吗？

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2012-11-28T12:57:49.250

QT 之类的 Boost 提供了自己的信号和插槽实现。以下是其实现的一些示例。

命名空间的信号和插槽连接

考虑一个名为 GStreamer 的命名空间

```
 namespace GStremer
 {
  void init()
  {
  ....
  }
 } 
```

以下是如何创建和触发信号

```
 #include<boost/signal.hpp>

 ...

 boost::signal<void ()> sigInit;
 sigInit.connect(GStreamer::init);
 sigInit(); //trigger the signal 
```

类的信号和插槽连接

考虑一个名为 GSTAdaptor 的类，其函数名为 func1 和 func2，具有以下签名

```
void GSTAdaptor::func1()
 {
 ...
 }

 void GSTAdaptor::func2(int x)
 {
 ...
 } 
```

以下是如何创建和触发信号

```
#include<boost/signal.hpp>
 #include<boost/bind.hpp>

 ...

 GSTAdaptor g;
 boost::signal<void ()> sigFunc1;
 boost::signal<void (int)> sigFunc2;

 sigFunc1.connect(boost::bind(&GSTAdaptor::func1, &g); 
 sigFunc2.connect(boost::bind(&GSTAdaptor::func2, &g, _1));

 sigFunc1();//trigger the signal
 sigFunc2(6);//trigger the signal 
```

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2016-11-24T13:43:23.053

当使用更新的 boost (fe 1.61) 编译 MattyT 的示例时，它会发出警告

```
error: #warning "Boost.Signals is no longer being maintained and is now deprecated. Please switch to Boost.Signals2\. To disable this warning message, define BOOST_SIGNALS_NO_DEPRECATION_WARNING." 
```

因此，要么您定义 BOOST_SIGNALS_NO_DEPRECATION_WARNING 来抑制警告，要么您可以通过相应地更改示例轻松切换到 boost.signal2：

```
#include <boost/signals2.hpp>
#include <boost/bind.hpp>
#include <iostream>

using namespace boost::signals2;
using namespace std; 
```

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2021-10-13T05:37:16.343

以上答案与signal2相同的答案很好，应该重写：

```
#include <boost/signals2.hpp>
#include <boost/bind.hpp>
#include <iostream>

using namespace boost;
using namespace std;

struct ClassA
{
    signals2::signal<void ()>    SigA;
    signals2::signal<void (int)> SigB;
};

struct ClassB
{
    void PrintFoo()      { cout << "Foo" << endl; }
    void PrintInt(int i) { cout << "Bar: " << i << endl; }
};

int main()
{
    ClassA a;
    ClassB b, b2;

    a.SigA.connect(bind(&ClassB::PrintFoo, &b));
    a.SigB.connect(bind(&ClassB::PrintInt, &b,  _1));
    a.SigB.connect(bind(&ClassB::PrintInt, &b2, _1));

    a.SigA();
    a.SigB(4);
} 
```

# asp.net-mvc - 在 ASP.NET MVC 中使用 DotNetOpenId 记住我

> ID：768367
> 
> 赞同：13
> 
> 时间：2009-04-20T13:58:41.947
> 
> 标签：asp.net-mvc, openid, dotnetopenauth

在 ASP.NET MVC 中使用 DotNetOpenAuth 3 并实现 RememberMe 工具...

我发现即使我在 FormsAuthentication.RedirectFromLoginPage 和 FormsAuthentication.SetAuthCookie 中将 createPersistentCookie 设置为 true，*一旦 ASP.NET 会话超时*，用户也不会被记住。

如果我检查 cookie，我发现它被标记为持久性并且将来确实有到期日期，我假设是因为我将 web.config FORMS 超时设置为几年后。无论如何，如果用户关闭浏览器并重新打开它，它们会被正确记住——只要 ASP 会话没有超时。

[Scott Hanselmann 的一篇较早的帖子](http://www.hanselman.com/blog/WeirdTimeoutsWithCustomASPNETFormsAuthentication.aspx)让我想知道这是否是因为 FormsAuthentication 试图更新身份验证票证，并且可能是在一个不起作用的 OpenId 模型中，但我在 web.config 中设置了 FORMS SlidingExpiration="false" 无论如何我认为强制使用持久 cookie 会使这些东西变得无关紧要。

我还想知道为什么 DotNetOpenId MVC 示例不包含 RememberMe 复选框 - 也许它有些棘手？

另一方面，在 StackOverflow 上，我看到我在会话中被自动记住了。想知道他们是否使用 DotNetOpenId 以外的其他东西来进行 OpenId 身份验证。

还有其他人在 ASP.NET MVC 中使用 DotNetOpenId 成功完成了 RememberMe 吗？有什么技巧吗？

[更新]

感谢您的帮助，安德鲁。原来这与 DotNetOpenId 无关。

读完[这篇](http://www.codeproject.com/KB/aspnet/machineKey.aspx)文章后，我收集到我的托管服务提供商可能会定期回收应用程序池，这导致身份验证票证加密是使用新的机器密钥完成的。

根据前面的链接文章，我在 Web.Config 的 System.Web 下添加了以下内容，它解决了这个问题：

```
<machineKey
    validationKey="(generated a new key to place here)"     
    decryptionKey="(generated a new key to place here)"
    validation="SHA1"
    decryption="AES" /> 
```

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2009-04-22T02:11:21.180

我仍然认为 cookie 名称应该匹配......但这里有别的东西。

听起来您是在说，只要您在 web.config 文件中的超时时间很大，那么一切正常。但是一旦你缩短它，你的持久 cookie 不会超过超时值。这个论坛主题帮助我回答了这个问题： [http ://forums.asp.net/p/1010241/1347970.aspx#1347970](http://forums.asp.net/p/1010241/1347970.aspx#1347970)

似乎 web.config 中的超时会影响所有 cookie。它说明身份验证票的持续时间。所有 auth cookie 都有这个“生存时间”超时，无论它们是否“持久”。所以持久性cookies和非持久性cookies的区别在于前者会在不同的浏览器会话中持续存在，而后者会在浏览器关闭时（提前）死掉。

那有意义吗？

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2009-04-22T02:02:07.770

您的 web.config 文件中的 cookie 名称与您的控制器对 FormsAuthentication.SetAuthCookie 的调用是否匹配？这可能是 DNOI 示例中的错误，但我怀疑如果您的 web.config 文件中有 cookie 名称（如 DNOI 示例那样），那么您可能必须将 cookie 名称设置为 SetAuthCookie 或 RedirectFromLoginPage 的第三个参数. 否则，forms auth 无法识别您设置为登录 cookie 的持久 cookie。

# gcc - make 和 gcc 有什么区别？

> ID：768373
> 
> 赞同：42
> 
> 时间：2009-04-20T14:00:00.073
> 
> 标签：gcc, makefile, compiler-construction

[文章](http://linuxhelp.blogspot.com/2006/04/steps-to-compile-c-c-programs-using.html)最后一句话引起了我的注意

> [F] 或有兴趣学习 C/C++ 编程的 C/C++ 开发人员和学生，而不是 Linux 用户。这是因为在 GNU/Linux 中使用“make”命令可以简化源代码的编译。

我一直使用 gcc 来编译我的 C/C++ 程序，而 javac 来编译我的 Java 程序。我只使用 make 通过 configure/make/make install 将程序安装到我的计算机上。

看来您显然可以使用命令 make 编译所有程序。

**make 和 gcc 有什么区别？**

* * *

## 回答 #1

> 赞同：72
> 
> 时间：2009-04-20T14:01:56.543

嗯... gcc 是一个编译器，make 是一个帮助构建程序的工具。差异是巨大的。你永远不能纯粹使用 make 来构建程序；它不是编译器。是什么让它引入了一个单独的“规则”文件，描述了如何从源代码到完成的程序。然后它解释这个文件，找出需要编译的内容，并为你调用 gcc。这对于具有成百上千个源代码文件的大型项目以及跟踪编译器选项、包含路径等内容非常有用。

* * *

## 回答 #2

> 赞同：19
> 
> 时间：2009-04-20T14:01:36.620

**gcc**编译和/或链接单个文件。它支持多种语言，但不知道如何将多个源文件组合成一个重要的、正在运行的程序——您通常需要至少两次 gcc 调用（编译和链接）才能创建最简单的程序。

GCC 上的维基百科页面将其描述为“编译器系统”：

> GNU Compiler Collection（通常缩写为 GCC）是由 GNU 项目生产的支持各种编程语言的编译器系统。

**make**是一个“构建工具”，它以特定顺序调用编译器（可能是 gcc）来编译多个源并将它们链接在一起。它还跟踪由源代码编译产生的各种源文件和目标文件之间的依赖关系，并且仅对自上次构建以来已更改的组件执行操作。

[GNUmake](http://www.gnu.org/software/make/)是 make 的一种流行实现。来自 GNUmake 的描述如下：

> Make 是一个工具，它控制从程序的源文件生成程序的可执行文件和其他非源文件。
> 
> Make 获取有关如何从名为 makefile 的文件构建程序的知识，该文件列出了每个非源文件以及如何从其他文件计算它。

* * *

## 回答 #3

> 赞同：14
> 
> 时间：2009-04-20T14:16:22.997

gcc 是一个 C 编译器：它采用 C 源文件并创建机器代码，以未链接的目标文件的形式或作为实际的可执行程序，它已链接到所有目标模块和库。

make 对于控制项目的构建过程很有用。一个典型的 C 程序由几个模块 (.c) 和头文件 (.h) 组成。在更改任何内容后总是编译所有内容会很耗时，因此 make 旨在仅编译更改后需要重新编译的部分。

它通过遵循程序员创建的规则来做到这一点。例如：

```
foo.o: foo.c foo.h
    cc -c foo.c 
```

该规则告诉 make 文件 foo.o 依赖于文件 foo.c 和 foo.h，如果它们中的任何一个发生更改，则可以通过运行第二行的命令来构建它。（上面不是实际的语法：make 想要由 TAB 字符缩进的命令，在这种编辑模式下我无法做到这一点。但想象一下它就在那里。）

make 从通常称为 Makefile 的文件中读取其规则。由于这些文件（传统上）是手工编写的，因此 make 有很多魔力可以让您缩短规则。例如，它知道 foo.o 可以从 foo.c 构建，并且它知道这样做的命令是什么。因此，上述规则可以缩短为：

```
foo.o: foo.h 
```

一个由三个模块组成的小程序可能有一个像这样的 Makefile：

```
mycmd: main.o foo.o bar.o
    $(CC) $(LDFLAGS) -o mycmd main.o foo.o bar.o
foo.o: foo.h bar.h
bar.o: bar.h 
```

make 可以做的不仅仅是编译程序。一个典型的 Makefile 将有一个规则来清除不需要的文件：

```
clean:
    rm -f *.o core myapp 
```

另一条规则可能会运行测试：

```
check: myapp
    ./myapp < test.input > test.output
    diff -u test.correct test.output 
```

Makefile 可能会“构建”文档：例如，运行一个工具来将文档从某种标记语言转换为 HTML 和 PDF。

Makefile 可能有一个安装规则，用于将它构建的二进制程序复制到用户或系统管理员希望它安装的任何位置。

等等。由于 make 是通用且强大的，它通常用于自动化从解压缩源 tarball 到软件可供用户使用的整个过程。

如果你想全面了解make，还有很多东西要学。make 的 GNU 版本有特别好的文档：[http](http://www.gnu.org/software/make/manual/) ://www.gnu.org/software/make/manual/有各种形式的文档。

* * *

## 回答 #4

> 赞同：5
> 
> 时间：2009-04-20T14:04:12.277

[Make](http://www.gnu.org/software/make/)经常*使用* [gcc](http://gcc.gnu.org/)来编译大量的 C 或 C++ 文件。

* * *

## 回答 #5

> 赞同：4
> 
> 时间：2009-04-20T14:01:53.907

Make 是一种工具，可通过执行最少的必要工作来构建各种系统组件之间存在依赖关系的任何复杂系统。

如果你想知道 make 可以用来做什么，[GNU make 手册](http://www.gnu.org/software/make/manual/make.html)非常好。

* * *

## 回答 #6

> 赞同：4
> 
> 时间：2009-04-20T14:07:40.443

`make`使用`Makefile`当前目录中的 a 将一组规则应用于其输入参数。Make 还知道一些默认规则，因此即使`Makefile`在当前目录中找不到（或类似的）文件，它也会执行。为`cpp`文件执行的规则恰好`gcc`在许多系统上调用。

请注意，您不是`make`使用*输入*文件名而是使用反映*输出的**规则名称*进行调用。因此调用将努力执行默认构建文件的规则（例如基于源代码文件.*`make xyz``xyz``xyz``xyz.cpp`*

 ** * *

## 回答 #7

> 赞同：4
> 
> 时间：2009-04-20T14:32:17.827

[make](http://www.gnu.org/software/make/manual/make.html)本质上是一个用于构建代码的专家系统。您为事物的构建方式以及它们所依赖的内容设置了规则。然后，Make 可以查看所有文件的时间戳，并随时准确地确定需要重建的内容。

[gcc](http://gcc.gnu.org/)是“gnu 编译器集合”。它支持多种语言（C、C++、Ada 等，具体取决于您的设置），但它仍然只是 make 可用于构建系统的众多工具中的一种。

* * *

## 回答 #8

> 赞同：3
> 
> 时间：2009-04-20T14:05:00.513

您可以使用 make 编译您的 C 和 C++ 程序，方法是在您的 makefile 中调用 gcc 或 g++ 来完成所有编译和链接步骤，让您使用一个简单的命令完成所有这些步骤。它不是编译器的替代品。

* * *

## 回答 #9

> 赞同：3
> 
> 时间：2009-04-20T14:10:22.047

`gcc`是一个像`javac`. 你给它源文件，它给你一个程序。

`make`是一个构建工具。它需要一个文件来描述如何根据文件之间的依赖关系构建项目中的文件，因此当您更改一个源文件时，您不必重新构建所有内容（就像您使用构建脚本一样）。`make`通常用于`gcc`实际编译源文件。

* * *

## 回答 #10

> 赞同：3
> 
> 时间：2009-04-20T14:11:37.347

'gcc' 是编译器——实际上将源代码转换为可执行文件的程序。你必须告诉它源代码在哪里，输出什么，以及其他各种东西，比如库和选项。

“make”更像是一种用于编译程序的脚本语言。这是一种隐藏编译源代码的所有细节（所有那些你必须通过编译器的参数）的方法。您可以在 Makefile 中编写一次上述所有详细信息，因此您不必每次都为每个文件键入它。它还会做一些漂亮的事情，比如只重新编译已更新的源文件，并处理依赖项（如果我重新编译这个文件，我将需要重新编译那个文件。）

* * *

## 回答 #11

> 赞同：1
> 
> 时间：2014-12-17T14:01:31.053

最大的区别是 make 是图灵完整的（[makefiles 图灵完整吗？](https://stackoverflow.com/questions/3480950/are-makefiles-turing-complete)）而 gcc 不是。

* * *

## 回答 #12

> 赞同：0
> 
> 时间：2021-09-17T15:04:02.897

我们以`gcc`编译器为例。它只知道如何将给定的`.cpp`文件编译成`.o`给定编译成功所需的文件（即.h 文件等依赖项）。

但是，这些依赖关系会创建一个图。例如，`b.o`可能需要`a.o`在编译过程中，这意味着它需要事先独立编译。

作为程序员，您是否想要跟踪所有这些依赖项并运行它们`.o`以构建您的目标文件？

当然不是。你想要一些东西来为你完成这项任务。

这些是构建工具 - 有助于使构建过程（即构建像 .o 文件这样的工件）更容易的工具。一种这样的工具是`make`.

我希望能澄清区别:)

# delphi - WSDL 导入器生成故障服务器

> ID：768375
> 
> 赞同：4
> 
> 时间：2009-04-20T14:00:27.390
> 
> 标签：delphi, soap, wsdl, delphi-2007

我一直在尝试建立一个肥皂服务器来实现（这是正确的术语吗？）第三方制定的 wsdl 规范。我使用了 Delphi 的 wsdl 导入器。（部分）生成的代码如下所示：

```
miniPortType = interface(IInvokable)
['{824D172A-9C1F-D202-5B21-4C324553BCF0}']

  // Cannot unwrap: 
  // - Input element wrapper name does not match operation's name
  function miniService(const aMessage: MiniMessageType): MiniAnswerType; stdcall;
end; 
```

调用时，服务器会说“*接口'miniPortType'不支持名为'MiniMessageType'的方法*”。

我只能通过使函数的名称和消息的主要元素的名称相同来使其工作。

我认为应该可以有不同的名称。至少soapUI 没有抱怨。我实际上别无选择，只能按原样实施 wsdl。有人知道我该如何解决这个问题吗？

我正在使用德尔福 2007。

谢谢，米尔。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-04-20T14:18:00.653

如果我没记错的话，SOAP 接口实际上是在定义底部的“表”中定义的，它是用来在通信中进行 Delphi 类型和 SOAP 类型之间的转换的。过去，我通过手动更改表构建调用“纠正”了这种事情，但您必须小心，并且可能还需要在适当的位置修改 SOAP 文本以使其完全适合。

# java - 如何播放从服务器发送的波形文件？

> ID：768387
> 
> 赞同：3
> 
> 时间：2009-04-20T14:04:08.923
> 
> 标签：java

我使用客户端和服务器方法发送波形文件。

收到后如何在客户端播放此文件？

这是用于发送波形文件的服务器代码：

```
import java.lang.*;
import java.io.*;
import java.net.*;

class Server {
//D:\Documents and Settings\Desktop\gradpro\test1
    static final String OUTPUTFILENAME = "C:\\Documents and Settings\\Administratore\\Desktop\\gradpro\\test1\\s1.wav";
    static final int PORT       = 8811;

    public static void main(String args[]) {

        System.out.println("New server running...\n\n");

        // Infinite loop, innit
        while ( true ) {

            try {
                //Create a socket
                ServerSocket srvr = new ServerSocket(PORT);
                Socket skt = srvr.accept();

                //Create a file output stream, and a buffered input stream
                FileOutputStream fos = new FileOutputStream(OUTPUTFILENAME);
                BufferedOutputStream out = new BufferedOutputStream(fos);
                BufferedInputStream in = new BufferedInputStream( skt.getInputStream() );

                //Read, and write the file to the socket
                int i;
                while ((i = in.read()) != -1) {
                    out.write(i);
                    //System.out.println(i);
                    System.out.println("Receiving data...");
                }
                out.flush();
                in.close();
                out.close();
                skt.close();
                srvr.close();
                System.out.println("Transfer complete.");
            }
            catch(Exception e) {

                System.out.print("Error! It didn't work! " + e + "\n");
            }

            //Sleep...
            try {
                Thread.sleep(1000);
            } catch (InterruptedException ie) {
                System.err.println("Interrupted");
            }

        } //end infinite while loop
    }

} 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-04-20T14:09:24.793

查看`[javax.sound.sampled](http://java.sun.com/products/java-media/sound/doc-sampled.html)`API。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-04-20T14:11:27.567

您可以使用[AudioClip](http://java.sun.com/javase/6/docs/api/java/applet/Applet.html#newAudioClip(java.net.URL))类来播放 WAV 文件；或者，您可以使用[Java Sound API](http://java.sun.com/docs/books/tutorial/sound/index.html)。

# asp.net - ASP.NET Base64 字符串损坏

> ID：768390
> 
> 赞同：0
> 
> 时间：2009-04-20T14:04:20.373
> 
> 标签：asp.net, httpwebrequest, asp.net-3.5

我将一个对象从一个 asp.net 页面传递到另一个页面。我将对象编码为 Base64 字符串并将其作为 POST 参数传递。但是，当接收页面读取 POST 值时，如果 Base64 字符串中有 + 号，则将其替换为换行符。例如：

```
 ...AABDEDS+DFEAED... 
```

变成

```
 ...AABDEDS
 DFEAED... 
```

我将发送页面中编码后的 Base64 字符串与接收页面中解码之前的字符串进行了比较，这是唯一的区别。在将 base64 字符串写入请求流之前，我尝试了 HtmlEncoding() ，但这没有效果，所以这似乎是接收端的问题。

有任何想法吗？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-04-20T14:06:34.987

使用[UrlEncode](http://msdn.microsoft.com/en-us/library/zttxte6w.aspx)。+ 是保留字符，需要进行编码。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-04-20T14:09:12.953

当您在参数中传递 base64 字符串时，您需要对其进行 URL 编码（以便字符正确出现）。采用：

```
System.Web.HttpServerUtility.UrlEncode(base64String); 
```

[HttpServer.UrlEncode 方法（字符串）（System.Web）](http://msdn.microsoft.com/en-us/library/zttxte6w.aspx)

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-04-20T14:09:53.263

+ 符号是一个特殊的 URL 字符，它自己计算为 URL 中的空格。

您需要`Server.URLEncode`在一侧使用 base64 字符串（这会将 Plus 变成 %2B 并`Server.URLDecode`在另一侧

# asp.net-mvc - RESTful Web 应用程序中的标识列和安全性

> ID：768395
> 
> 赞同：0
> 
> 时间：2009-04-20T14:05:08.423
> 
> 标签：asp.net-mvc, security, model-view-controller, rest

**问题**

在 RESTful Web 应用程序中使用时，自动增量标识列是否应该具有非默认种子/增量？

**背景**

我正在开发我的第一个 ASP.NET MVC 应用程序并尝试保持我的 url RESTful。该应用程序没有单独的管理网站。我使用属性来控制谁可以访问站点的哪些部分，以及根据他们在系统中的角色，当前用户可以看到哪些菜单项。我（大部分）遵循 ActiveRecord DB 模式并为我的表（包括用户表）使用合成 id，其中 id 是自动生成的标识列。

今天早上我突然想到，在 RESTful 应用程序中为身份列使用默认种子存在一个微妙的安全风险。如果您假设管理 ID，尤其是最强大的 ID，通常首先在应用程序中创建，那么它们将是系统中编号最小的 ID。虽然实际上并没有在应用程序中打开一个漏洞，但使用种子/增量的默认值可以使破解者更容易通过使用 RESTful 操作（例如 ChangePassword - 这是其中之一）定位低编号的 id 来攻击高价值目标ASP.NET MVC 站点模板中的开箱即用操作）。

我是否应该将设置一个非默认种子至少添加到我的用户表到我的安全最佳实践库中？这样做的效果值得吗？还是我太偏执了？作为一个相关问题，我是否应该更改帐户相关操作的开箱即用模板名称。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2009-04-20T14:07:51.177

我的建议是使用 GUID 而不是自动递增 ID。这完全摆脱了“猜测游戏”。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-04-20T14:24:25.460

我一直对使用 Guid 持怀疑态度；然而，正如 Lucerno 所指出的，它确实有助于减少猜谜游戏，具体取决于 Guid 的生成和使用方式。例如，使用 SQL Server 顺序生成的 Guid 不会阻止猜谜游戏。

如果你有一个域模型并且你使用像 nHibernate 这样的 ORM 甚至滚动你自己的，那么指南也非常方便。因为它极大地简化了插入反向引用的复杂性，因为所有对象都可以在早期被赋予它们的 id。

话虽如此，如果您的 ID 包含在 URL 中，它们应该被视为非常公开的数据。即使通过 HTTPS，狡猾的攻击也可以获取整个 URL。如果您的页面请求任何第三方内容（例如 Google 分析），则 url 查询字符串和所有内容将作为引荐来源发送给第三方。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-04-20T14:27:08.447

将登录用户保留在服务器端的会话中，而不是将其传递给客户端——这样客户端就永远无法在恶意查询中更改用户 ID。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2009-08-23T12:53:36.863

我已经决定，现在，我将通过更改自动增量列的默认种子来解决风险。这并不难，也不会改变应用程序的特性或 ActiveRecord 模式。由于这些列也用于外键关系，因此我希望将它们保留为整数以提高索引效率。

我不打算更改默认操作，除非不同的动词更有意义。让界面直观比将操作隐藏在一个晦涩的名称后面更重要。

# php - 动态命名变量？

> ID：768396
> 
> 赞同：0
> 
> 时间：2009-04-20T14:05:46.643
> 
> 标签：php, sql, mysql

我有一张包含各种拍卖的表格，其中每条记录都有一个用户名和一个类别。很可能会有多个具有相同用户名和类别的记录。有四种不同类型的类别。

我想知道，鉴于下面准备好的查询，是否有可能让第二个绑定参数成为循环遍历包含 4 个类别的数组的结果，并且是否可以将结果动态分配给数组？

```
$countAuctionsQuery = "select COUNT(USERNAME, SUBCAT) from AUCTIONS where username = ? AND SUBCAT = ?";

    if ($getRecords = $con->prepare($countAuctionsQuery)) 
        {
        $getRecords->bind_param("ss", $username, $subcat);
        $getRecords->execute();        
        $getRecords->bind_result($numRecords);
         } 
```

编辑：

数据示例

```
Auctions

username    itemnumber  cost    category
------------------------------------------------
fredx       222     $33 fake
fredx       123     $43 fake
timo        765     $54 fake
fredx       987     $99 sold
bobk        233     $77 fake
wenx        11      $12 ok
fredx       23      $31 ok
fredx       723     $73 fake
wenx        44      $88 ok 
```

因此，对于用户名 fredx 和类别 fake，应该返回 3。

对于用户名 fredx 和已售类别，应返回 1

对于用户名 timo 和类别 fake，应返回 1

对于用户名 wenx 和类别 ok，应返回 2。

我希望能够像这样打印出来：

```
Fake items: $numfake items or category['fake']
OK items: $numok items or category['ok']
Sold items: $numsold items or category['sold'] 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2009-04-20T14:11:47.737

用这个：

```
SELECT  subcat, COUNT(*)
FROM    AUCTIONS
WHERE   username = ?
GROUP BY
        subcat 
```

并在循环中获取结果：

```
$countAuctionsQuery = $query;

if ($getRecords = $con->prepare($countAuctionsQuery)) {
    $getRecords->bind_param("s", $username);
    $getRecords->execute();        
    $getRecords->bind_result($subcat, $numRecords);
    while ($getRecords->fetch()) {
        print "$subcat items: $numRecords items of category['$subcat']";
    }
} 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-04-21T03:53:35.420

试试这个：

```
function getCategoryCount($user, $conn) {
    $result = array();
    $query = "SELECT category, COUNT(id) AS count FROM Auctions
              WHERE username=? GROUP BY category";
    $stmt = $conn->prepare($query);
    $stmt->bind_param('s',$user);
    $stmt->execute();
    $stmt->bind_result($cat, $count);
    while ($stmt->fetch()) {
        $result[$cat] = $count;
    }
    return $result;
} 
```

您可以像这样使用该功能：

```
$count = getCategoryCount('fred', $con);
print $count['fake']; // prints '3' 
```

相反，您也可以这样做：

```
$query = "SELECT category, COUNT(id) AS count FROM Auctions
          WHERE username=? GROUP BY category";
$stmt = $con->prepare($query);
$stmt->bind_param('s',$user);
$user = 'fred';
$stmt->execute();
$stmt->bind_result($cat, $count);
while ($stmt->fetch()) {
    ${'num'.$cat} = $count;
}

print $numfake;
print $numok;
print $numsold; 
```

# c# - 绑定数据更改时Winforms列表框不更新

> ID：768400
> 
> 赞同：5
> 
> 时间：2009-04-20T14:07:24.033
> 
> 标签：c#, winforms, multithreading, data-binding, listbox

下图显示了我的代码是如何工作的。当我按下按钮 2 时，列表框会更新，但当我按下按钮 1 时不会。为什么？

[![伪代码](https://i.stack.imgur.com/8tMEQ.gif)](https://i.stack.imgur.com/8tMEQ.gif)

问题线程相关吗？如果是，我应该在哪里添加对 (Begin)Invoke 的调用？

需要注意的一件有趣的事情是，如果我先按下按钮 1，然后按下按钮 2，那么当我单击按钮 2 时，会显示由按钮 1 单击生成的数据。因此，doFoo 生成的数据似乎在某处缓冲，然后在我按下 button2 后推送到列表框。

**编辑：**

我尝试将 AddNumber 添加到表单代码中，并在 listBox1.InvokeRequired 返回 true 时添加对 Invoke 的调用。这解决了问题，但不是最好的设计。我不希望 GUI 不得不“担心”如何将项目添加到作为模型一部分的列表中。

如何保留添加到列表类内部列表的逻辑，同时在列表更改时仍更新 gui？

**编辑2：**

既然我们已经确认这是一个线程问题，我已经更新了图像以更准确地反映我正在处理的实际代码的设计。

虽然 Lucero 的建议仍然可以解决问题，但我希望得到一些不需要表单来了解有关 dll 或 CDllWrapper 的任何内容。

模型（ListBoxDataBindingSource 等）应该对视图（列表框、按钮、标签等）一无所知

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-04-20T14:15:12.110

我的猜测是这是因为更新消息在错误的线程上处理。背景：每个线程都有自己的消息队列。默认情况下，发布到消息队列中的消息将与调用者位于同一线程中。因此，回调可能会在错误的线程上发布消息。

试试这个：将 AddNumber() 方法移动到表单并使用 Invoke()（由 Control 继承）将项目添加到正确的线程中。这可能会解决这个问题。

**编辑**以反映您的跟进：UI 不必知道您的组件。您需要的只是将项目添加到列表和 UI 之间的适当同步，因为 UI 更新只有在线程匹配时才会起作用。因此，您可能希望将 Control 提供给包装 BindingList 的类，然后对列表本身执行 Invoke。这使得列表担心触发 UI 线程上的更新，并且确实消除了 UI 和外部组件在正确线程上调用处理程序的担心。

像这样：

```
internal class ListBoxDataBindingSource {
  private readonly Control uiInvokeControl;
  private readonly BindingList<Item> list = new BindingList<Item>();

    public ListBoxDataBindingSource(Control uiInvokeControl) {
      if (uiInvokeControl == null) {
            throw new ArgumentNullException("uiInvokeControl");
      }
        this.uiInvokeControl = uiInvokeControl;
        CDIIWrapper.setFP(AddNumber);
    }

    public void AddNumber(int num) {
      Item item = new Item(num.ToString());
        if (uiInvokeControl.InvokeRequired) {
            uiInvokeControl.Invoke(list.Add, item);
        } else {
            list.Add(item);
        }
    }

    private BindingList<Item> List {
        get {
            return list;
        }
    }
} 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2011-01-30T09:26:29.020

我知道这是旧的，虽然我有一个非常相似的问题。

这是解决方案：[BindingList 未更新绑定 ListBox](https://stackoverflow.com/questions/4823481/bindinglist-not-updating-bound-listbox)。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-04-20T14:41:29.880

不要让 setFP 将回调设置为 lbDataBindingSource.AddNumber，而是在代码中创建一个私有方法来处理回调，然后从该回调中调用 lbDataBindingSource.AddNumber。

```
void MyForm_Load(object sender, EventArgs e)
{
    //...

    cdll.setFP(FPCallback);
}

private void FPCallback(int num)
{
    lbDataBindingSoruce.AddNumber(num);
} 
```

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2014-06-25T07:17:53.593

我需要调用我的视图模型来向绑定列表添加东西，所以我需要编写一个匿名函数

参考 Lucero 的回答和以下帖子： [Invoke 调用中的匿名方法](https://stackoverflow.com/questions/253138/anonymous-method-in-invoke-call)

我的代码：

```
listBox.Invoke((Action)delegate
{
    MyViewModel.AddItem(param1, param2);
}); 
```

# shell - 模拟警告作为错误的Shell脚本？

> ID：768401
> 
> 赞同：0
> 
> 时间：2009-04-20T14:07:36.793
> 
> 标签：shell, compilation, stdout, compiler-warnings, stderr

一些编译器允许您将警告设置为错误，这样您就永远不会留下任何编译器警告，因为如果您这样做，代码将无法构建。这是一件好事。

不幸的是，一些编译器*没有*警告作为错误的标志。

我需要编写一个提供该功能的 shell 脚本或包装器。

大概它解析编译控制台输出并在有任何编译器警告（*或错误*）时返回失败，否则返回成功。“失败”也意味着（我认为）不应该产生目标代码。

什么是您可以编写的最短、最简单的 UNIX/Linux shell 脚本，它满足上述显式要求，以及以下隐含要求，否则其行为就像编译器一样： - 接受所有标志、选项、参数 - 支持 stdout 和 stderr 的重定向- 按照指示生成目标代码和链接

关键词：优雅，满足*所有*要求。

额外的功劳：易于合并到 GNU make 文件中。

谢谢你的帮助。

===线索===这个解决不同问题的方法，使用shell函数（？），[将文本附加到 bash 中的stderr重定向](https://stackoverflow.com/questions/420278/append-text-to-stderr-redirects-in-bash)，可能会出现。想知道如何邀请[litb](https://stackoverflow.com/users/34509/litb)的朋友“非常了解 bash”来解决我的问题？

===回答状态===

感谢[查理马丁](https://stackoverflow.com/users/35092/charlie-martin)的简短回答，但不幸的是，这就是我开始的。不久前，我使用它，将其发布以供办公室使用，并在几个小时内向我指出了它最严重的缺点：它将通过编译而没有警告，但只有错误。这真的很糟糕，因为那时我们正在交付编译器*肯定*不会工作的目标代码。简单的解决方案也不满足列出的其他要求。

感谢[Adam Rosenfield](https://stackoverflow.com/users/9530/adam-rosenfield)的速记，以及[Chris Dodd](https://stackoverflow.com/users/29759/chris-dodd)将 pipefail 引入解决方案。*Chris 的*回答看起来最接近，因为我认为 pipefail 应该确保如果编译实际上因错误而失败，我们将得到应有的失败。克里斯，管道故障是否适用于所有外壳？对上面列出的其他隐含要求有什么想法吗？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2010-07-29T13:32:16.387

用交换 stdout 和 stderr 流的“make”函数替换 make 命令怎么样：

```
# cf. http://codesnippets.joyent.com/posts/show/8769
unset -f make
function make() { 
   command make "${@}" 3>&2 2>&1 1>&3 3>&- | tee /dev/stderr | \
        grep -E -i --line-buffered 'error|warning' | \
        head -n 1 > stderr_make.log && { echo; return 1; }
   return 0 
} 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-04-20T21:51:06.867

这应该可以解决问题：

```
$ if compile-command |& tee /dev/tty | grep -q 'Warning'; then false; else true; fi 
```

该`|&`构造是简写`2>&1 |`（即，它同时重定向`stdout`和重定向`stderr`到管道中）。放入`tee /dev/tty`管道可确保您仍能在控制台上看到编译器的输出，如果未发现任何警告，则将其管道`grep -q 'Warning'`化将使退出状态为 1，如果发现任何警告，则退出状态为 0。最后，将其包装在 an 中会`if ...; then false; else true; fi`反转退出状态，因此如果未找到警告（成功），则退出状态为 0，如果发现任何警告（失败），则退出状态为 1。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-04-20T14:58:36.687

嗯。

> $ (编译命令 2>&1 | grep '警告') && 退出 1

这不是很有帮助，但您指定了“最短”。当然，必须修改“警告”字符串以匹配编译器。

更好的版本是通过 grep 管道输出，查找警告并设置标志，然后如果设置了标志，则打印有关发现警告的消息并退出，返回代码设置为 0 以外的值。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2009-04-20T22:08:19.463

只要您使用 bash，例如：

```
set -o pipefail; compile-command 2>&1 | if grep -q -i warning; then exit 1; fi 
```

应该做的伎俩

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2010-07-30T09:37:56.557

这是另一个版本的“make”函数（用于 Bash），它也可以记录标准输出：

```
# cf. http://wiki.bash-hackers.org/howto/redirection_tutorial
unset -f make
function make() {    # logs stdout & stderr
  { 
     { 
        command make "${@}" 3>&- | 
           tee stdout_make.log 2>&3 3>&- 
     } 2>&1 >&4 4>&- | 
        grep -E -i --line-buffered 'error|warning' 2>&3 3>&- | 
           head -n 1 > stderr_make.log && 
              { echo; cat stderr_make.log; echo; return 1; }
  } 3>&2 4>&1 

  return 0 
} 
```

# sharepoint - 使用 MOSS Publishing Infrastructure 支持长期运行的操作

> ID：768410
> 
> 赞同：3
> 
> 时间：2009-04-20T14:09:23.420
> 
> 标签：sharepoint, moss

我过去曾在 MOSS (SharePoint) 的发布基础结构中使用过长时间运行操作功能，我很好奇是否有人知道这是否是在 SharePoint 中进行自定义长时间运行操作的受支持技术。

使用此技术时，您从 Microsoft.SharePoint.Publishing.Internal.LongRunningOperationJob 继承，这似乎表明它不支持自定义使用，但我似乎记得（也许我梦到了？）长时间运行的进程是苔藓。

有任何想法吗？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-04-21T05:05:45.700

SharePoint 计时器作业在 MSDN 杂志四月版 [http://msdn.microsoft.com/en-us/magazine/dd569748.aspx中进行了描述](http://msdn.microsoft.com/en-us/magazine/dd569748.aspx)

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-04-20T20:28:42.587

好问题柯克！我最近还体验到需要在 SharePoint 中实现长时间运行的作业。但是 LongRunningOperationJob 不是一个选项，因为它还需要使用普通的 WSS 3.0 部署。我最终只是从 Web 请求中生成了一个新线程，并重定向到一个 ASPX 页面，其中启用了 AJAX 的进度条每隔一秒更新一次。它运行良好，可以根据需要运行。唯一的缺点是 IISRESET 会永远杀死它。另一种可能性是使用自定义 SharePoint 计时器作业来实施长时间运行的作业。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2010-01-31T21:49:12.740

SPLongOperation 是一种执行长时间运行操作的非常简单的方法。比 Publishing.LongRunningOperationJob 简单得多，并且使用相同的基础架构。

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2010-08-20T16:15:09.130

有没有想过微软如何在 SharePoint 2007 中创建漂亮的长时间运行的进程窗口？

SPLongOperation 是要使用的类。它有2个重要的方法

开始和结束；

所有长时间运行的代码都放在开始和结束之间。

下面是一个示例类。

它几乎很简单，而且可以正常工作:-)

```
using System;
using System.Web;
using System.Web.UI.WebControls;
using Microsoft.SharePoint;
namespace CreateLongOperation
{
public class LongRun : System.Web.UI.Page
{
  protected Button buttonOk;

  protected void Page_Load(object sender, EventArgs e)
  {
     buttonOk.Click += new EventHandler(buttonOk_Click);
  }

  void buttonOk_Click(object sender, EventArgs e)
  {
     SPLongOperation operation = new SPLongOperation(this.Page);

     operation.Begin();

     // do long operation code here...
     System.Threading.Thread.Sleep(6000);

     operation.End("http://sps/_layouts/Mynewpage.aspx");
  }
 }
} 
```

# flash - SWF 转图片

> ID：768413
> 
> 赞同：1
> 
> 时间：2009-04-20T14:09:36.040
> 
> 标签：flash

目前我正在使用[SWFToImage](http://www.bytescout.com/swftoimage.html)将我在 swf 中动态生成的图表转换为图像。但是当需要同时创建多个图像时，它会崩溃很多。

是否有更好的解决方案可用于从 SWF 文件生成图像？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2009-04-20T14:14:53.297

如果您要摆脱闪存以仅使用图像，则可能需要考虑使用非闪存图表生成器。它会更快/高效/可靠。

如果闪光灯被某人实际使用，请忽略这一点。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-04-21T00:12:09.757

根据您是否能够修改 SWF 的源，您可以点击按钮，从舞台内容创建一个 BitmapData 对象，然后将该数据编码为图像格式。然后，您将使用 AIR 将其保存到桌面或使用服务器端语言将其保存到服务器，这同样取决于您的要求。如果这个方向听起来合理，我可以进一步详细说明。

回复评论：是的，你是对的，你也可以轻松地加载外部 SWF。

以下是您需要做的粗略概述：

加载外部 SWF 就像这样简单：

```
var loader:Loader = new Loader();

var urlRequest:URLRequest = new URLRequest("url-to-external.swf");

loader.load(urlRequest); 
```

然后将外部 SWF 内容复制到 BitmapData 对象中（可能在某些事件中，例如单击按钮）：

```
var bitmapData:BitmapData = new BitmapData(loader.width, loader.height);
bitmapData.draw(loader); 
```

但是，根据源 SWF 的外观，它可能需要一些额外的工作。您可能特别需要考虑加载的 SWF 中内容的 (x,y) 坐标，因为它们可能会创建绘制到 BitmapData 对象的偏移量。

[然后，您可以使用来自AS3 核心库](http://code.google.com/p/as3corelib/)的 PNGEncoder 类使用 BitmapData 对象创建图像文件，例如 PNG 。

# php - 管理电子邮件附件时，理论上好的 MAX_SIZE 是多少？

> ID：768419
> 
> 赞同：1
> 
> 时间：2009-04-20T14:10:37.397
> 
> 标签：php, email, pdf, email-attachments

我正在开发网站的一部分，在该网站上生成 PDF，将它们附加到电子邮件中并将其发送出去。现在，我没有跟踪要附加到电子邮件的所有 PDF 的当前大小总和，但我怀疑有一次我应该这样做。

我的问题归结为：在管理电子邮件附件时应该采用什么好的理论上的*MAX_SIZE 。*

例如，当我生成的 PDF 的大小总和达到*MAX_SIZE 时*，我会将这些 PDF 添加到电子邮件中，然后将其发送出去。然后我会创建一个新电子邮件，将剩余的 PDF 附件添加到其中并发送出去。重复广告，直到所有 PDF 都发送完毕。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-04-20T14:12:12.523

GMail[有 20MB 的限制](http://mail.google.com/support/bin/answer.py?hl=en&answer=8770)。我发现这对于一般用途来说是公平的。

大小不会太大，以至于大多数连接都需要永远，但足够大，可以发送整个 PDF 文档。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2009-04-20T14:14:36.527

使用标准*的雅虎！邮件*帐户，您最多只能发送或接收 10MB 的附件，所以如果您有网络邮件用户，那么我会考虑发送超过 10MB 的下载链接。我不知道其他电子邮件提供商的限制是多少。

编辑：
[此页面](http://www.liewcf.com/blog/archives/2007/06/gmail-increase-maximum-attachment-size/)指出*Hotmail*也限制为 10MB。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2009-04-20T14:13:38.793

我会走得更低。5 兆。仍然有很多人没有宽带。

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2009-04-20T14:22:48.583

鉴于您所看到的答案和我的经验，归结为了解您的用户。

您的用户在您的 Intranet 上吗？检查用户集的附件策略。用户在互联网上的任何地方吗？然后我建议您检查您的用户群并确定您愿意冒险拒绝的百分比阈值。

例如，如果你有 50% 的 AOL 用户、20% 的 gmail 用户、20% 的 hotmail、5% 的 yahoo、5% 的杂项。- 你可以争辩说你愿意冒 5% 的电子邮件被拒绝的风险 - 所以请采用 AOL、gmail、hotmail 和 yahoo 允许的最小大小。

您可能会考虑的另一件事是确保您有办法监控因附件大小而被拒绝的邮件 - 然后与这些人沟通，让他们知道他们需要更大的附件限制才能使用您的服务。

等等等等……总之，分解问题，研究可接受的容差，并尝试以不降低主要受众体验的方式处理异常值。

祝你好运，-詹姆斯

# java - Java 访问 pci-modem

> ID：768420
> 
> 赞同：0
> 
> 时间：2009-04-20T14:10:55.397
> 
> 标签：java, com, communication, modem, pci-bus

我的笔记本电脑中有一个 pci 调制解调器，我试图运行一个打开端口并对其进行配置的程序。我在执行此操作时遇到异常，我认为它看不到端口，即使它在 COM3 上。有没有办法在java中做到这一点？

我得到的错误是 noClassDefFoundError。它说找不到 SerialPortEventListener 类。我正在使用 rxtxcomm。我尝试使用 javax.comm 但它也找不到端口。

非常感谢

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-04-20T14:13:49.697

NoClassDefFoundError 表示您的类路径中缺少 JAR 文件，特别是包含 SerialPortEventListener 类的文件。检查你的类路径。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-04-20T14:31:17.470

您是否按照rxtxcomm的[安装说明进行操作？](http://www.captain.at/howto-java-serial-port-javax-comm-rxtx.php)请注意，您必须处理一个库和一个 jar 文件。您需要为原生组件指定系统库路径。

如果找到适当的 .jar，您可能会发现“找不到类定义” *，*但找不到要加载的相应本机库。

# php - 如何在 PHP 中进行重定向？

> ID：768431
> 
> 赞同：1440
> 
> 时间：2009-04-20T14:13:22.583
> 
> 标签：php, redirect, http-status-code-301, http-redirect

是否可以通过使用 PHP 将用户重定向到不同的页面？

假设用户去`www.example.com/page.php`并且我想将他们重定向到`www.example.com/index.php`，如果不使用元刷新，我将如何做到这一点？可能吗？

这甚至可以保护我的页面免受未经授权的用户的侵害。

* * *

## 回答 #1

> 赞同：1902
> 
> 时间：2009-04-20T14:19:24.067

现有答案的摘要加上我自己的两分钱：

## 1\. 基本答案

您可以使用该`header()`函数发送新的 HTTP 标头，但这必须在任何 HTML 或文本之前发送到浏览器（`<!DOCTYPE ...>`例如，在声明之前）。

```
header('Location: '.$newURL); 
```

## 2\. 重要细节

**死（）**或**退出（）**

```
header("Location: https://example.com/myOtherPage.php");
die(); 
```

为什么你应该使用`die()`or `exit()`: [The Daily WTF](https://thedailywtf.com/Articles/WellIntentioned-Destruction.aspx)

**绝对或相对 URL**

自 2014 年 6 月起，可以使用绝对 URL 和相对 URL。请参阅[RFC 7231](https://greenbytes.de/tech/webdav/rfc7231.html#header.location)，它取代了旧的[RFC 2616](https://www.w3.org/Protocols/rfc2616/rfc2616-sec14.html#sec14.30)，其中只允许使用绝对 URL。

**状态码**

PHP 的“Location”-header 仍然使用[HTTP 302](https://en.wikipedia.org/wiki/HTTP_302) -redirect 代码，这是一种“临时”重定向，可能不是您应该使用的重定向。您应该考虑[301](https://en.wikipedia.org/wiki/HTTP_301)（永久重定向）或[303](https://en.wikipedia.org/wiki/HTTP_303)（其他）。

注意：[W3C 提到](https://www.w3.org/Protocols/rfc2616/rfc2616-sec10.html#sec10.3.4)303 标头与“许多 HTTP/1.1 之前的用户代理不兼容。当前使用的浏览器都是 HTTP/1.1 用户代理。对于许多其他用户代理，如蜘蛛和机器人，情况并非如此。

## 3\. 文档

HTTP 标头和`header()`PHP 中的函数

*   [PHP手册说什么](https://www.php.net/manual/en/function.header.php)
*   [维基百科说什么](https://en.wikipedia.org/wiki/List_of_HTTP_headers#Responses)
*   [W3C 怎么说](https://www.w3.org/Protocols/rfc2616/rfc2616-sec14.html#sec14.30)

## 4\. 替代品

您可以使用`http_redirect($url);`需要安装[PECL 包 pecl](https://pecl.php.net/package/pecl_http)的替代方法。

## 5\. 辅助函数

此函数不包含 303 状态代码：

```
function Redirect($url, $permanent = false)
{
    header('Location: ' . $url, true, $permanent ? 301 : 302);

    exit();
}

Redirect('https://example.com/', false); 
```

这更灵活：

```
function redirect($url, $statusCode = 303)
{
   header('Location: ' . $url, true, $statusCode);
   die();
} 
```

## 6\. 解决方法

如前所述`header()`，重定向仅在写出任何内容之前起作用。[如果在 HTML](https://stackoverflow.com/questions/8028957/warning-headers-already-sent-in-php)输出中调用它们通常会失败。然后，您可以使用 HTML 标头解决方法（不是很专业！），例如：

```
 <meta http-equiv="refresh" content="0;url=finalpage.html"> 
```

甚至是 JavaScript 重定向。

```
window.location.replace("https://example.com/"); 
```

* * *

## 回答 #2

> 赞同：143
> 
> 时间：2009-04-20T14:14:11.130

使用该[`header()`函数](http://www.php.net/manual/en/function.header.php)发送[HTTP`Location`标头](http://en.wikipedia.org/wiki/List_of_HTTP_headers#Responses)：

```
header('Location: '.$newURL); 
```

与某些人的想法相反，`die()`与重定向无关。**仅**当您想重定向**而不是**正常执行时才使用它。

文件*example.php*：

```
<?php
    header('Location: static.html');
    $fh = fopen('/tmp/track.txt', 'a');
    fwrite($fh, $_SERVER['REMOTE_ADDR'] . ' ' . date('c') . "\n");
    fclose($fh);
?> 
```

三个处决的结果：

```
bart@hal9k:~> cat /tmp/track.txt
127.0.0.1 2009-04-21T09:50:02+02:00
127.0.0.1 2009-04-21T09:50:05+02:00
127.0.0.1 2009-04-21T09:50:08+02:00 
```

Resuming - 强制`die()`/`exit()`是一些与实际 PHP 无关的都市传说。它与客户“尊重”标头无关`Location:`。无论使用何种客户端，发送标头都不会停止 PHP 执行。

* * *

## 回答 #3

> 赞同：123
> 
> 时间：2009-04-20T14:19:11.010

```
function Redirect($url, $permanent = false)
{
    if (headers_sent() === false)
    {
        header('Location: ' . $url, true, ($permanent === true) ? 301 : 302);
    }

    exit();
}

Redirect('http://www.google.com/', false); 
```

别忘了`die()`/ `exit()`！

* * *

## 回答 #4

> 赞同：108
> 
> 时间：2014-06-27T07:24:59.483

Output JavaScript from PHP using echo, which will do the job.

```
echo '<script type="text/javascript">
           window.location = "http://www.google.com/"
      </script>'; 
```

You can't really do it in PHP unless you buffer the page output and then later check for redirect condition. That might be too much of a hassle. Remember that headers are the first thing that is sent from the page. Most of the redirect is usually required later in the page. For that you have to buffer all the output of the page and check for redirect condition later. At that point you can either redirect page user header() or simply echo the buffered output.

For more about buffering (advantages)

[What is output buffering?](https://stackoverflow.com/questions/2832010/what-is-output-buffering)

* * *

## 回答 #5

> 赞同：107
> 
> 时间：2017-04-13T12:44:35.100

> **1.没有标题**

在这里你不会遇到任何问题

```
 <?php echo "<script>location.href='target-page.php';</script>"; ?> 
```

> **2.使用header函数`exit()`**

```
<?php 
     header('Location: target-page.php');
     exit();
?> 
```

但是，如果您使用标头功能，那么有时您会收到**“标头已发送的警告”**来解决在发送标头之前不回显或打印的问题，或者您可以简单地使用标头功能`die()`或`exit()`在标头功能之后。

> **3\. 使用标头函数`ob_start()`和`ob_end_flush()`**

```
<?php
ob_start(); //this should be first line of your page
header('Location: target-page.php');
ob_end_flush(); //this should be last line of your page
?> 
```

* * *

## 回答 #6

> 赞同：57
> 
> 时间：2009-04-20T14:24:47.457

这些答案中的大多数都忘记了一个**非常**重要的步骤！

```
header("Location: myOtherPage.php");
die(); 
```

离开那条重要的第二条线可能会让你最终出现在[The Daily WTF](http://thedailywtf.com/Articles/WellIntentioned-Destruction.aspx)上。问题是浏览器不必尊重页面返回*的*标题，因此忽略标题，页面的其余部分将在没有重定向的情况下执行。

* * *

## 回答 #7

> 赞同：34
> 
> 时间：2016-05-16T13:12:55.453

利用：

```
<?php header('Location: another-php-file.php'); exit(); ?> 
```

或者，如果您已经打开了 PHP 标记，请使用以下命令：

```
header('Location: another-php-file.php'); exit(); 
```

您还可以重定向到外部页面，例如：

```
header('Location: https://www.google.com'); exit(); 
```

确保包含`exit()`或包含`die()`.

* * *

## 回答 #8

> 赞同：25
> 
> 时间：2016-09-09T10:48:33.533

您可以使用会话变量来控制对页面的访问并授权有效用户：

```
<?php
    session_start();

    if (!isset( $_SESSION["valid_user"]))
    {
        header("location:../");
        exit();
    }

    // Page goes here
?> 
```

[http://php.net/manual/en/reserved.variables.session.php](http://php.net/manual/en/reserved.variables.session.php)。

最近，我受到网络攻击并决定，我需要了解试图访问管理面板或保留部分 Web 应用程序的用户。

因此，我在文本文件中添加了 IP 地址和用户会话的日志访问权限，因为我不想打扰我的数据库。

* * *

## 回答 #9

> 赞同：19
> 
> 时间：2014-01-15T04:21:54.140

其中许多答案是正确的，但他们假设您有一个绝对 URL，但事实可能并非如此。如果您想使用**相对 URL**并生成其余部分，那么您可以执行以下操作...

```
$url = 'http://' . $_SERVER['HTTP_HOST'];            // Get the server
$url .= rtrim(dirname($_SERVER['PHP_SELF']), '/\\'); // Get the current directory
$url .= '/your-relative/path-goes/here/';            // <-- Your relative path
header('Location: ' . $url, true, 302);              // Use either 301 or 302 
```

* * *

## 回答 #10

> 赞同：18
> 
> 时间：2015-01-12T11:03:32.137

使用以下代码：

```
header("Location: /index.php");
exit(0); 
```

* * *

## 回答 #11

> 赞同：17
> 
> 时间：2009-04-20T14:14:41.643

`header( 'Location: http://www.yoursite.com/new_page.html' );`

* * *

## 回答 #12

> 赞同：14
> 
> 时间：2011-04-28T21:31:36.370

我已经回答了这个问题，但我会再做一次，因为与此同时我了解到如果您在 CLI 中运行（重定向不会发生，因此不应该`exit()`）或者您的网络服务器是将 PHP 作为 (F)CGI 运行（它需要预先设置的`Status`标头才能正确重定向）。

```
function Redirect($url, $code = 302)
{
    if (strncmp('cli', PHP_SAPI, 3) !== 0)
    {
        if (headers_sent() !== true)
        {
            if (strlen(session_id()) > 0) // If using sessions
            {
                session_regenerate_id(true); // Avoids session fixation attacks
                session_write_close(); // Avoids having sessions lock other requests
            }

            if (strncmp('cgi', PHP_SAPI, 3) === 0)
            {
                header(sprintf('Status: %03u', $code), true, $code);
            }

            header('Location: ' . $url, true, (preg_match('~^30[1237]$~', $code) > 0) ? $code : 302);
        }

        exit();
    }
} 
```

我还处理了支持不同 HTTP 重定向代码（`301`、`302`和）的问题`303`，`307`正如我在上一个答案的评论中所解决的那样。以下是说明：

*   **301** - 永久移动
*   **302** - 找到
*   **303** - 见其他
*   **307** - 临时重定向 (HTTP/1.1)

* * *

## 回答 #13

> 赞同：12
> 
> 时间：2018-02-13T09:26:52.680

要将访问者重定向到另一个页面（在条件循环中特别有用），只需使用以下代码：

```
<?php
    header('Location: mypage.php');
?> 
```

在这种情况下，`mypage.php`是您希望将访问者重定向到的页面地址。该地址可以是绝对地址，也可以包含以下格式的参数：`mypage.php?param1=val1&m2=val2)`

**相对/绝对路径**

在处理相对或绝对路径时，最好从服务器的根目录 (DOCUMENT_ROOT) 选择绝对路径。使用以下格式：

```
<?php
    header('Location: /directory/mypage.php');
?> 
```

如果目标页面位于另一台服务器上，则包含完整的 URL：

```
<?php
    header('Location: http://www.ccm.net/forum/');
?> 
```

**HTTP 标头**

根据 HTTP 协议，HTTP 标头必须发送`before`任何类型的内容。这意味着在标题之前不应该发送任何字符——甚至是空格！

**临时/永久重定向**

默认情况下，上述重定向类型是临时的。这意味着搜索引擎（例如 Google 搜索）在编制索引时不会考虑重定向。

如果您想通知搜索引擎某个页面已永久移动到另一个位置，请使用以下代码：

```
<?
    header('Status: 301 Moved Permanently', false, 301);
    header('Location: new_address');
?> 
```

例如，此页面有以下代码：

```
<?
    header('Status: 301 Moved Permanently', false, 301);
    header('Location: /pc/imprimante.php3');
    exit();
?> 
```

当您单击上面的链接时，您将自动重定向到此页面。此外，它是永久重定向（状态：301 永久移动）。因此，如果您在 Google 中输入第一个 URL，您将自动被重定向到第二个重定向链接。

**PHP代码解读**

位于 header() 之后的 PHP 代码将由服务器解释，即使访问者移动到重定向中指定的地址也是如此。在大多数情况下，这意味着您需要一个方法来遵循`header()`函数的`exit()`功能，以减少服务器的负载：

```
<?
    header('Status: 301 Moved Permanently', false, 301);
    header('Location: address');
    exit();
?> 
```

* * *

## 回答 #14

> 赞同：9
> 
> 时间：2017-06-08T06:34:37.683

是的，可以使用 PHP。我们将重定向到另一个页面。

试试下面的代码：

```
<?php
    header("Location:./"); // Redirect to index file
    header("Location:index.php"); // Redirect to index file
    header("Location:example.php");
?> 
```

* * *

## 回答 #15

> 赞同：9
> 
> 时间：2017-08-18T06:46:30.547

利用：

```
<?php
    header('Location: redirectpage.php');
    header('Location: redirectpage.php');
    exit();
    echo "<script>location.href='redirectpage.php';</script>";
?> 
```

这是一个常规的普通 PHP 重定向，但您可以通过以下代码在几秒钟后创建一个重定向页面：

```
<?php
    header('refresh:5;url=redirectpage.php '); // Note: here 5 means 5 seconds wait for redirect.
?> 
```

* * *

## 回答 #16

> 赞同：7
> 
> 时间：2009-04-20T20:25:12.033

在语义网的前夜，正确性是需要考虑的事情。不幸的是，PHP 的“Location”-header 仍然使用[HTTP 302](http://en.wikipedia.org/wiki/HTTP_302) -redirect 代码，严格来说，这并不是最好的重定向代码。它应该使用的那个是[303](http://en.wikipedia.org/wiki/HTTP_303)那个。

W3C 非常友好地[提到](http://www.w3.org/Protocols/rfc2616/rfc2616-sec10.html#sec10.3.4)303 标头与“许多 HTTP/1.1 之前的用户代理”不兼容，这相当于当前使用没有浏览器。所以，302是遗物，*不*应该使用。

...或者您可以像其他人一样忽略它...

* * *

## 回答 #17

> 赞同：7
> 
> 时间：2015-03-12T09:42:18.447

您可以使用一些 JavaScript 方法，如下所示

1.  `self.location="http://www.example.com/index.php";`

2.  `window.location.href="http://www.example.com/index.php";`

3.  `document.location.href = 'http://www.example.com/index.php';`

4.  `window.location.replace("http://www.example.com/index.php");`

* * *

## 回答 #18

> 赞同：7
> 
> 时间：2021-01-07T16:01:09.370

要在 php 中重定向，请使用：

`<?php header('Location: URL'); exit; ?>`

* * *

## 回答 #19

> 赞同：7
> 
> 时间：2017-11-28T01:04:54.573

是的，您可以使用[header()](http://us3.php.net/manual/en/function.header.php)函数，

```
header("Location: http://www.yourwebsite.com/user.php"); /* Redirect browser */
exit(); 
```

最好的做法是在函数之后立即调用[exit()](http://php.net/manual/en/function.exit.php)`header()`函数以避免下面的代码执行。

根据文档，`header()`必须在发送任何实际输出之前调用。

* * *

## 回答 #20

> 赞同：6
> 
> 时间：2009-04-20T14:23:17.973

就像这里的其他人所说，发送位置标头：

```
header( "Location: http://www.mywebsite.com/otherpage.php" ); 
```

但是您需要在将任何其他输出发送到浏览器之前执行此操作。

另外，如果您要使用它来阻止未经身份验证的用户访问某些页面，就像您提到的那样，请记住，某些用户代理[会忽略这一点](http://thedailywtf.com/Articles/WellIntentioned-Destruction.aspx)并继续在当前页面上，所以您需要死（ ) 发送后。

* * *

## 回答 #21

> 赞同：6
> 
> 时间：2017-01-28T14:48:31.727

以下是我的想法：

恕我直言，重定向传入请求的最佳方法是使用位置标头，即

```
<?php
    header("Location: /index.php");
?> 
```

一旦执行此语句并发送输出，浏览器将开始重新定向用户。但是，请确保在发送标头之前没有任何输出（任何 echo / var_dump），否则会导致错误。

尽管这是实现最初要求的快速而肮脏的方法，但最终会成为 SEO 灾难，因为这种重定向总是被解释为 301 / 302 重定向，因此搜索引擎将始终看到您的索引页面作为重定向页面，而不是登录页面/主页。

因此，它将影响网站的 SEO 设置。

* * *

## 回答 #22

> 赞同：5
> 
> 时间：2017-04-09T08:37:42.293

使用 PHP 重定向的最佳方法是以下代码...

```
 header("Location: /index.php"); 
```

确保之后没有代码可以工作

```
header("Location: /index.php"); 
```

所有代码必须在上述行之前执行。

认为，

**情况1：**

```
echo "I am a web developer";
header("Location: /index.php"); 
```

它将正确重定向到该位置（index.php）。

**案例二：**

```
return $something;
header("Location: /index.php"); 
```

上面的代码不会重定向到该位置（index.php）。

* * *

## 回答 #23

> 赞同：5
> 
> 时间：2021-06-14T10:14:22.050

您可以尝试使用

```
header('Location:'.$your_url) 
```

更多信息可以参考[php官方文档](https://www.php.net/manual/en/function.header.php)

* * *

## 回答 #24

> 赞同：4
> 
> 时间：2020-03-15T07:52:05.200

## 使用标头功能进行路由

```
<?php
     header('Location: B.php');
     exit();
?> 
```

假设我们想从**A.php**文件路由到**B.php**而我们必须借助`<button>`or `<a>`。让我们看一个例子

```
<?php
if(isset($_GET['go_to_page_b'])) {
    header('Location: B.php');
    exit();

}
?>

<p>I am page A</p>
<button name='go_to_page_b'>Page B</button> 
```

B.php

```
<p> I am Page B</p> 
```

* * *

## 回答 #25

> 赞同：4
> 
> 时间：2018-08-03T13:26:57.703

**1.使用`header`，内置PHP函数**

a) 不带参数的简单重定向

```
<?php
   header('Location: index.php');
?> 
```

b) 使用 GET 参数重定向

```
<?php
      $id = 2;
      header("Location: index.php?id=$id&msg=succesfully redirect");
  ?> 
```

**2\. 在 PHP 中使用 JavaScript 重定向**

a) 不带参数的简单重定向

```
<?php
     echo "<script>location.href='index.php';</script>";
 ?> 
```

b) 使用 GET 参数重定向

```
<?php
     $id = 2;
     echo "<script>location.href='index.php?id=$id&msg=succesfully redirect';</script>";
   ?> 
```

* * *

## 回答 #26

> 赞同：3
> 
> 时间：2018-01-04T07:30:17.283

我们可以通过两种方式做到这一点：

1.  当用户访问[https://bskud.com/PINCODE/BIHAR/index.php](https://bskud.com/PINCODE/BIHAR/index.php)然后重定向到[https://bskud.com/PINCODE/BIHAR.php](https://bskud.com/PINCODE/BIHAR.php)

    通过以下 PHP 代码

    ```
    <?php
        header("Location: https://bskud.com/PINCODE/BIHAR.php");
        exit;
    ?> 
    ```

    将上述代码保存在[https://bskud.com/PINCODE/BIHAR/index.php](https://bskud.com/PINCODE/BIHAR/index.php)

2.  当任何条件为真时，重定向到另一个页面：

    ```
    <?php
        $myVar = "bskud";
        if ($myVar == "bskud") {
    ?>

    <script> window.location.href="https://bskud.com";  </script>

    <?php
        }
        else {
            echo "<b>Check the website name again</b>";
        }
    ?> 
    ```

* * *

## 回答 #27

> 赞同：2
> 
> 时间：2022-01-03T16:34:17.957

```
header("Location: https://www.example.com/redirect.php"); 
```

> 直接重定向到此链接*https://www.example.com/redirect.php*

```
$redirect = "https://www.example.com/redirect.php";
header("Location: $redirect"); 
```

> 首先获取*$redirect*值，然后重定向到 [value]，例如：*https ://www.example.com/redirect.php*

* * *

## 回答 #28

> 赞同：2
> 
> 时间：2020-01-13T05:21:08.670

**我喜欢数秒后的那种重定向**

```
<?php

header("Refresh: 3;url=https://theweek.com.br/índex.php"); 
```

* * *

## 回答 #29

> 赞同：2
> 
> 时间：2017-11-20T19:10:01.680

利用：

```
<?php
    $url = "targetpage"
    function redirect$url(){
        if (headers_sent()) == false{
            echo '<script>window.location.href="' . $url . '";</script>';
        }
    }
?> 
```

* * *

## 回答 #30

> 赞同：2
> 
> 时间：2018-01-28T22:17:07.200

有多种方法可以做到这一点，但如果您愿意`php`，我建议您使用该`header()`功能。

**基本上**

```
$your_target_url = “www.example.com/index.php”;
header(“Location : $your_target_url”);
exit(); 
```

如果你想让它更上一层楼，最好在函数中使用它。这样，您就可以在其中添加身份验证和其他检查元素。

让我们通过检查用户的级别来尝试。

因此，假设您已将用户的权限级别存储在名为`u_auth`.

在里面`function.php`

```
<?php
    function authRedirect($get_auth_level,
                          $required_level,
                          $if_fail_link = “www.example.com/index.php”){
        if ($get_auth_level != $required_level){
            header(location : $if_fail_link);
            return false;
            exit();
        }
        else{
            return true;
        }
     }

     . . . 
```

然后，您将为要验证的每个页面调用该函数。

喜欢在`page.php`或任何其他页面。

```
<?php

    // page.php

    require “function.php”

    // Redirects to www.example.com/index.php if the
    // user isn’t authentication level 5
    authRedirect($_SESSION[‘u_auth’], 5);

    // Redirects to www.example.com/index.php if the
    // user isn’t authentication level 4
    authRedirect($_SESSION[‘u_auth’], 4);

    // Redirects to www.someotherplace.com/somepage.php if the
    // user isn’t authentication level 2
    authRedirect($_SESSION[‘u_auth’], 2, “www.someotherplace.com/somepage.php”);

    . . . 
```

参考;

*   [http://php.net/manual/en/function.header.php](http://php.net/manual/en/function.header.php)

* * *

## 回答 #31

> 赞同：1
> 
> 时间：2020-01-09T13:21:27.177

试试这个

```
 $url = $_SERVER['HTTP_REFERER'];
 redirect($url); 
```

* * *

## 回答 #32

> 赞同：0
> 
> 时间：2017-10-13T10:56:05.223

如果您在 Apache 上运行，您还可以使用 .htaccess 进行重定向。

```
Redirect 301 / http://new-site.com/ 
```

* * *

## 回答 #33

> 赞同：0
> 
> 时间：2016-11-15T10:15:19.373

您可以尝试使用 PHP`header`函数进行重定向。您将需要设置输出缓冲区，以便您的浏览器不会向屏幕抛出重定向警告。

```
ob_start();
header("Location: " . $website);
ob_end_flush(); 
```

# sql - 查找多个已知 ID 项的替代 SQL 方法？

> ID：768436
> 
> 赞同：16
> 
> 时间：2009-04-20T14:13:52.130
> 
> 标签：sql

在一个表中查找多个已知 ID 的问题是否有更好的解决方案：

```
SELECT * FROM some_table WHERE id='1001' OR id='2002' OR id='3003' OR ... 
```

我可以拥有数百个已知项目。想法？

* * *

## 回答 #1

> 赞同：29
> 
> 时间：2009-04-20T14:18:53.303

```
SELECT * FROM some_table WHERE ID IN ('1001', '1002', '1003') 
```

如果您的已知 ID 来自另一个表

```
SELECT * FROM some_table WHERE ID IN (
    SELECT KnownID FROM some_other_table WHERE someCondition 
) 
```

* * *

## 回答 #2

> 赞同：9
> 
> 时间：2009-04-20T14:19:12.867

第一个（天真的）选项：

```
SELECT * FROM some_table WHERE id IN ('1001', '2002', '3003' ... ) 
```

但是，我们应该能够做得更好。 `IN`当您有很多项目时，这是非常糟糕的，并且您提到了数百个这样的 id。是什么创造了它们？他们来自哪里？你能写一个返回这个列表的查询吗？如果是这样的话：

```
SELECT *
FROM some_table 
INNER JOIN ( your query here) filter ON some_table.id=filter.id 
```

* * *

## 回答 #3

> 赞同：3
> 
> 时间：2009-04-20T14:17:56.177

请参阅[SQL Server 2005 中的数组和列表](http://www.sommarskog.se/arrays-in-sql-2005.html)

* * *

## 回答 #4

> 赞同：2
> 
> 时间：2009-04-20T14:19:52.177

众所周知，OR 在 SQL 中的速度很慢。

您的问题缺乏细节，但根据您的要求和约束，我会使用您的 ID 构建一个查找表并使用 EXISTS 谓词：

```
select t.id from some_table t 
where EXISTS (select * from lookup_table l where t.id = l.id) 
```

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2009-04-20T14:18:56.347

对于一组固定的 ID，您可以执行以下操作：

```
SELECT * FROM some_table WHERE id IN (1001, 2002, 3003); 
```

对于每次都更改的集合，您可能希望创建一个表来保存它们，然后查询：

```
SELECT * FROM some_table WHERE id IN 
  (SELECT id FROM selected_ids WHERE key=123); 
```

另一种方法是使用集合——其语法取决于您的 DBMS。

最后，总是有这种“笨拙”的方法：

```
SELECT * FROM some_table WHERE '|1001|2002|3003|' LIKE '%|' || id || '|%'; 
```

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2009-04-20T14:22:28.193

在`Oracle`中，我总是将`id`'s 放入 a`TEMPORARY TABLE`中以执行大量`SELECT`的 's 和`DML`操作：

```
CREATE GLOBAL TEMPORARY TABLE t_temp (id INT)

SELECT  *
FROM    mytable
WHERE   mytable.id IN
        (
        SELECT  id
        FROM    t_temp
        ) 
```

`Oracle`您可以使用集合类型在单个客户端-服务器往返中填充临时表。

* * *

## 回答 #7

> 赞同：0
> 
> 时间：2009-04-20T18:16:37.087

我们在为 MS SQL Server 7 编写的应用程序中遇到了类似的问题。虽然我不喜欢使用的解决方案，但我们不知道有什么更好的...

据我所知，2008 年存在“更好”的解决方案，但我们有零客户使用它:)

我们创建了一个表值用户定义函数，它接受一个以逗号分隔的 ID 字符串，并返回一个 ID 表。然后 SQL 读取得相当好，而且都不是动态的，但仍然存在令人讨厌的双重开销：
1\. 客户端将 ID 连接到字符串中
2\. SQL Server 解析字符串以创建 ID 表

有很多方法可以将 '1,2,3,4,5' 转换为 ID 表，但使用该函数的存储过程最终看起来像......

```
CREATE PROCEDURE my_road_to_hell @IDs AS VARCHAR(8000)
AS
BEGIN

   SELECT
      *
   FROM
      myTable
   INNER JOIN
      dbo.fn_split_list(@IDs) AS [IDs]
         ON [IDs].id = myTable.id

END 
```

* * *

## 回答 #8

> 赞同：0
> 
> 时间：2009-04-20T18:27:07.387

最快的是将ids放在另一个表中并JOIN

```
SELECT some_table.* 
FROM some_table INNER JOIN some_other_table ON some_table.id = some_other_table.id 
```

其中 some_other_table 只有一个字段（id），所有值都是唯一的

# c# - 在 C# 中查找特定类型的成员字段

> ID：768439
> 
> 赞同：0
> 
> 时间：2009-04-20T14:14:11.490
> 
> 标签：c#

我正在尝试在大型代码库中查找特定类型（例如小部件）的所有成员字段（但不是局部变量）。

我正在使用 VS2005，但不介意非 vs 解决方案。

如果我使用 C++，我可以将搜索限制在头文件中，但这在 c# 中不起作用

我可以搜索“Widget m_”，但可能会丢失未正确命名的字段。

还有其他想法吗？

* * *

更多信息：

我的 WidgetManager 中有一个明确的 Widget 列表。任何其他类都可以有一个指向 Widget 的指针。如果我从我的 WidgetManager 中删除一个 Widget，我希望将指向该小部件的所有其他指针（无论它们在解决方案中的什么位置）设置为 null。

从我的 WidgetManager 中删除 Widget 时会引发“destroyed”事件。我正在考虑在所有存储对小部件的引用的类中捕获该事件，并在删除小部件时将它们的引用设置为 null。我最初问题的重点是验证我是否找到了所有参考资料。

如果有人能想到更好的方法，请告诉我。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-04-20T14:15:49.660

使用反射来检查编译的 dll。遍历所有类型并找到引用该类型的所有属性..

**编辑**

这是一个示例，可查找在当前应用程序域中公开字符串的所有属性。

```
public static void Main(string[] args)
{
    printAllPublicPropertiesInCurrentAppDomain(typeof(string));
}

private static void printAllPublicPropertiesInCurrentAppDomain(Type typeToFind)
{
    foreach (Assembly assembly in AppDomain.CurrentDomain.GetAssemblies())
    {
        foreach (Type type in assembly.GetTypes())
        {
            foreach (PropertyInfo info in type.GetProperties())
            {
                if (info.PropertyType == typeToFind)
                {
                    Console.WriteLine("Assembly: {0}, Type: {1}, Property: {2}", assembly.GetName().Name, type.Name, info.Name);
                }
            }
        }
    }
} 
```

**编辑 2**

我不确定 GetProperties 默认返回什么，但它确实有一个允许您指定 BindingFlags 的重载。您可以指定：

```
type.GetProperties(BindingFlags.Instance | BindingFlags.Static | BindingFlags.Public | BindingFlags.NonPublic) 
```

对于所有公共或私有实例和静态属性。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-04-20T14:15:39.333

代码库是一种解决方案吗？如果是这样，请转到该类型，右键单击该类型的名称并选择“查找所有引用”。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-04-20T14:18:04.740

我想为此利用现有的编译器，否则您必须至少实现 C# 解析器的一个子集才能获得相当可靠的答案。另外，就个人而言，我想避免加载所涉及的程序集并使用反射，因为这可能会导致副作用。

[NDepend](http://www.ndepend.com/)提供了一种[代码查询语言](http://www.ndepend.com/CQL.htm)，可以让您回答这个以及更复杂的问题。不是免费的，但很好。

我认为[Cecil](http://www.mono-project.com/Cecil)可以用于已编译的程序集，需要做更多的工作。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2009-04-20T14:18:43.943

您正在寻找的功能在 VS 2005 中不存在。可用的最接近的功能是“查找所有引用”，但这将包括您说过要排除的局部变量引用。

找到这些字段后，您能告诉我们更多关于您想要做什么的信息吗？如果只是用于计数，则可以使用反射来查找所有字段并获得准确的计数。如果它涉及更多的东西，比如源代码更改，你可能不得不使用某种解析器。

# php - 为什么使用 filter_input() 更好？

> ID：768442
> 
> 赞同：21
> 
> 时间：2009-04-20T14:14:30.303
> 
> 标签：php, security, filter

这应该是一个基本问题，但为什么最好使用这样的东西：

```
$pwd = filter_input(INPUT_POST, 'pwd'); 
```

而不仅仅是：

```
$pwd = $_POST['pwd']; 
```

PS：我知道过滤器扩展可以与更多参数一起使用，以提供额外的清理级别。

* * *

## 回答 #1

> 赞同：15
> 
> 时间：2009-04-20T14:30:44.867

它不是。 `$_GET`, `$_POST`,`$_COOKIE`和[使用默认过滤器](http://www.php.net/manual/en/filter.configuration.php)`$_REQUEST`过滤。没有附加参数也使用默认过滤器。所以根本没有区别。`filter_input(INPUT_POST, 'pwd')`

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2009-04-20T14:17:44.850

从客户端发送的任何数据（例如 POST 数据）都应该进行清理和转义（甚至更好地进行完整性检查），以确保它不会杀死您的网站。

[SQL 注入](http://en.wikipedia.org/wiki/SQL_injection)和[跨站点脚本](http://en.wikipedia.org/wiki/Cross-site_scripting)是无法清理用户发送数据的两个最大威胁。

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2014-06-23T14:29:18.487

这不是更好。

请参阅 filter_input [http://www.php.net//manual/en/function.filter-input.php上的文档](http://www.php.net//manual/en/function.filter-input.php)

并单击“过滤器类型”链接。 [http://www.php.net/manual/en/filter.filters.php](http://www.php.net/manual/en/filter.filters.php)

我只使用过整数过滤器......

```
$user_id = filter_input(INPUT_POST, 'user_id', FILTER_SANITIZE_NUMBER_INT);
$user = abs($user_id); // To get rid of any +/- 
```

# java - 在 Java 中，为按位运算假设一定大小的原始类型是否安全？

> ID：768447
> 
> 赞同：4
> 
> 时间：2009-04-20T14:15:30.800
> 
> 标签：java, 64-bit

鉴于 Java 的“一次编写，随处运行”范式以及 Java 教程为所有原始数据类型提供了明确的位大小而没有丝毫暗示这取决于任何东西的事实，我会说，是的，an`int`始终是 32 位.

但是有什么注意事项吗？[语言规范](http://java.sun.com/docs/books/jls/third_edition/html/typesValues.html#4.2.1)定义了值范围，但没有说明内部表示，我猜它可能不应该。但是，我有一些代码对**假设为 32 位宽度****的变量进行按位运算`int`**，我想知道该代码在所有架构上是否安全。

这类问题是否有很好的深入资源？

* * *

## 回答 #1

> 赞同：13
> 
> 时间：2009-04-20T14:16:40.580

无论原生架构如何，Java 代码总是像 int 是 32 位一样工作。

在规范中，还有[一部分](http://java.sun.com/docs/books/jls/third_edition/html/typesValues.html#85587)是关于表示的明确部分：

> 整数类型为 byte、short、int 和 long，其值分别为 8 位、16 位、32 位和 64 位有符号二进制补码整数，以及 char，其值为 16 位无符号整数表示 UTF-16 代码单元

* * *

## 回答 #2

> 赞同：6
> 
> 时间：2009-04-20T14:28:41.877

虽然 Java 原语的行为在语言规范中完全准确地指定，但有一个警告：在 64 位架构上，整数可能是字对齐的，这意味着整数数组（或任何非 64 位原语type) 占用的内存是 32 位架构的两倍。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2009-04-20T14:23:05.727

是的，Java 中没有 sizeof 运算符。

根据 Bruce Eckel*在 Java 中的思考*：

*   `short`: 16 位
*   `int`: 32 位
*   `long`: 64 位

这些值在架构之间没有变化。

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2009-04-20T14:24:05.617

您可能还会检查[JVM 规范](http://java.sun.com/docs/books/jvms/second_edition/html/VMSpecTOC.doc.html)：每个按位操作都会获取它的操作码（ISHL、IOR、IAND 等）

* * *

## 回答 #5

> 赞同：-1
> 
> 时间：2009-04-20T14:36:07.507

这不是一个答案，因为已经有一个很好的答案，但我想我要指出的是，Java 如此但不适用于 C 或 C++ 的原因是 Java 编译为虚拟机（Java VM或 JVM）。因为 JVM 运行相同的字节码并具有相同的内部结构，无论它在哪台机器上，它似乎在每台机器上都具有相同的原始类型大小。C 和 C++ 没有尝试模拟任何特定的行为，而是受制于各种机器上的处理器实现的奇思妙想。

# database - 如何在闪存中在计算机上创建数据库？

> ID：768456
> 
> 赞同：0
> 
> 时间：2009-04-20T14:17:01.063
> 
> 标签：database, actionscript-3

我想在 actionscipt 3.0 中创建一个应用程序，允许用户听音乐并阅读音乐的描述。为此，我想应该有一个文本位和音乐所在的数据库，然后在按下正确的按钮时快速获取信息。该数据库将包含多达 100 个曲目和文本位。

该应用程序将在没有互联网连接的支架上运行。

在 actionscript 3.0 中执行此操作的最简单方法是什么？

如果你们中的任何人熟悉 UML 并认为这可能有助于理解问题，那么这里是用例和流程图：

[替代文字 http://img135.imageshack.us/img135/1498/flowchart2.jpg](http://img135.imageshack.us/img135/1498/flowchart2.jpg)

[替代文字 http://img27.imageshack.us/img27/1000/usercase.jpg](http://img27.imageshack.us/img27/1000/usercase.jpg)

提前致谢。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-04-20T14:32:17.937

完成您所要求的工作的最简单方法可能是将文件存储在将要运行应用程序的机器上的目录中，然后设计一个 XML 结构来存储您的数据。XML 在运行时很容易加载到 Flash 中，并且很容易编辑。

您的另一个选择是在机器上运行数据库服务器，创建在本地运行的 Web 服务并从数据库中推/拉数据，然后从 Flash 应用程序中调用这些服务。

第一个选项绝对是最简单的，应该能够提供您所需要的。第二种更适合分布式 Flash 应用程序，在这种应用程序中，您需要一个用于客户端的中央数据存储库。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-04-20T15:52:10.367

如果您正在构建[AIR](http://www.adobe.com/fr/products/air/)应用程序，则可以使用集成的 SQLITE 数据库。但是，我同意贾斯汀的观点，最简单的方法是使用 XML 文件。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-04-20T16:08:22.120

您可能可以考虑使用[“本地共享对象”](http://en.wikipedia.org/wiki/Local_Shared_Object)，这是一种 cookie，容量更大（默认为 100Kb，但您可以更改它）。与已经提出的其他解决方案相比，它具有*不需要*任何 Web 服务器的优点。

# javascript - 将回调 onSuccess 返回值提升为 Caller Function 返回值

> ID：768457
> 
> 赞同：6
> 
> 时间：2009-04-20T14:17:02.887
> 
> 标签：javascript, ajax, jquery

我有一个 javascript 函数，它调用一个通用函数来对服务器进行 ajax 调用。我需要从 ajax 调用的回调函数中检索结果（真/假），但我得到的结果始终是“未定义”。

没有我所有逻辑的通用函数的超级简化版本将是：

```
function CallServer(urlController) {
    $.ajax({
        type: "POST",
        url: urlController,
        async: false,
        data: $("form").serialize(),
        success:
            function(result) {
                if (someLogic)
                   return true;
                else
                   return false;
            },
        error:
            function(errorThrown) {
                return false;
            }
    });
} 
```

调用它的函数将类似于：

```
function Next() {
        var result = CallServer("/Signum/TrySave");
        if (result == true) {
            document.forms[0].submit();
        }
    } 
```

“结果”变量始终是“未定义”，调试它我可以看到正在执行回调函数的“返回真”行。

关于为什么会发生这种情况的任何想法？如何将回调函数的返回值*冒泡*到 CallServer 函数？

谢谢

* * *

## 回答 #1

> 赞同：16
> 
> 时间：2009-04-20T14:54:44.840

以防万一您想采用异步方式（这是一个更好的解决方案，因为它在执行请求时不会冻结您的浏览器），下面是代码：

```
function CallServer(urlController, callback) {
    $.ajax({
        type: "POST",
        url: urlController,
        async: true,
        data: $("form").serialize(),
        success:
            function(result) {
                var ret = ( someLogic );
                callback(ret);
            },
        error:
            function(errorThrown) {
                return false;
            }
    });
}

function Next() {
    CallServer("/Signum/TrySave", function(result) {
        if (result == true) {
            document.forms[0].submit();
        }
    });
} 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-04-20T14:33:35.873

我通常将任何要在成功时执行的代码放在回调函数本身中。我认为`CallServer()`实际上并没有从回调本身接收返回值。

尝试类似：

```
function CallServer(urlController) {
    $.ajax({
        type: "POST",
        url: urlController,
        async: false,
        data: $("form").serialize(),
        success:
            function(result) {
                if (someLogic)
                   document.forms[0].submit();
                else
                   // do something else
            },
        error:
            function(errorThrown) {
                // handle error
            }
    });
} 
```

编辑：我对 jQuery 不太熟悉，所以我可能完全错了（我是基于其他框架的行为，比如 YUI 和没有任何框架的 AJAX 调用）。如果是这样，只需对此答案投反对票并发表评论，我将删除此答案。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-04-20T14:47:05.263

刚刚找到了怎么做:) 声明一个变量并从回调函数中相应地更新它。之后我可以返回该变量。我为未来的读者放置代码：

```
function CallServer(urlController) {
    var returnValue = false;
    $.ajax({
        type: "POST",
        url: urlController,
        async: false,
        data: $("form").serialize(),
        success:
            function(result) {
                if (someLogic){
                    returnValue = true;
                    return;
                }
            },
        error:
            function(errorThrown) {
                alert("Error occured: " + errorThrown);
            }
        });

        return returnValue;
} 
```

# visual-c++ - Visual Studio 2005 C++ 运行时新异常

> ID：768471
> 
> 赞同：0
> 
> 时间：2009-04-20T14:19:23.367
> 
> 标签：visual-c++, debugging, release, new-operator

我有一个带有调试和发布版本的 VS 2005 C++ 项目。我尝试了以下 4 件事：

1.  通过 Visual Studio 构建一个 Debug 可执行文件，并通过 Visual Studio 运行它。
2.  在`cd`'ing 到`vstudio/debug`.
3.  通过 Visual Studio 构建 Release 可执行文件，并通过 Visual Studio 运行它。
4.  在`cd`'ing 到`vstudio/release`.

前3个全部成功：程序运行完成。

然而，第四个在运行时崩溃。调试显示罪魁祸首是对`malloc()`operator 内部的调用`new()`。相关上下文如下所示：

```
template<typename T> class Foo {
    ...
    static void bar() {
        ...
        T* ptr = new T();
        ...
    }
    ...
} 
```

如果有人能想到任何会导致我描述的四分之三症状的问题，将不胜感激。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-04-20T14:27:27.450

您可能有一个损坏的堆。这可能是由于指针写入分配的内存之外造成的。

在调试模式下不会发生这种情况的一个可能原因是您只覆盖了堆上的调试信息（在发布模式下不存在）。

我不了解您的环境，但您可能应该使用 BoundsChecker 之类的工具来查找错误。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-04-20T14:39:12.677

我的第一个猜测是 cygwin 为您的程序构建使用的某些 Windows DLL 提供了替换 DLL。

测试这一点的一个好方法是尝试在 Windows 命令 shell (cmd.exe) 下运行，看看是否会遇到相同的错误。

# python - Tkinter-Monitor-Window 的类方法

> ID：768474
> 
> 赞同：0
> 
> 时间：2009-04-20T14:19:59.807
> 
> 标签：python, tkinter, class-method

我想实现一个向用户报告正在进行的计算的监视器窗口。为此，我写了一个小类。但是因为我想以一种简单的方式在不同的模块中使用它，所以我想用类方法来实现它。这允许在没有实例的情况下以下列方式使用它：

```
from MonitorModule import Monitor
Monitor.write("xyz") 
```

此外，如果我在其他模块中使用它，则**other_module.py中的****Monitor.write()**的输出将显示在同一窗口中。

 **我可以在每个模块中导入它以将特定输出重定向到同一监视器。我让它工作了，除了一件我不明白的小事。我无法使用我编写的特定处理程序关闭监视器窗口。我可以使用非类方法方式但不能使用处理程序作为类方法。

看代码：

```
import Tkinter
class Monitor_non_classmothod_way(object):
  def __init__(self):
    self.mw = Tkinter.Tk()
    self.mw.title("Messages by NeuronSimulation")
    self.text = Tkinter.Text(self.mw, width = 80, height = 30)
    self.text.pack()
    self.mw.protocol(name="WM_DELETE_WINDOW", func=self.handler)
    self.is_mw = True
  def write(self, s):
    if self.is_mw:
      self.text.insert(Tkinter.END, str(s) + "\n")
    else:
      print str(s)
  def handler(self):
    self.is_mw = False
    self.mw.quit()
    self.mw.destroy()

class Monitor(object):
  @classmethod
  def write(cls, s):
    if cls.is_mw:
      cls.text.insert(Tkinter.END, str(s) + "\n")
    else:
      print str(s)
  @classmethod
  def handler(cls):
    cls.is_mw = False
    cls.mw.quit()
    cls.mw.destroy()
  mw = Tkinter.Tk()
  mw.title("Messages by NeuronSimulation")
  text = Tkinter.Text(mw, width = 80, height = 30)
  text.pack()
  mw.protocol(name="WM_DELETE_WINDOW", func=handler)
  close = handler
  is_mw = True

a = Monitor_non_classmothod_way()
a.write("Hello Monitor one!")
# click the close button: it works
b = Monitor()
Monitor.write("Hello Monitor two!")
# click the close button: it DOESN'T work, BUT:
# >>> Monitor.close()
# works... 
```

因此，classmethod 似乎有效，并且似乎可以以正确的方式访问！任何想法，出了什么问题，它不适用于按钮？

干杯，菲利普

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2009-04-21T18:28:20.153

您不需要大量的类方法只是为了使跨多个模块使用对象变得容易。

而是考虑在模块导入时创建一个实例，如下所示：

```
import Tkinter

class Monitor(object):

  def __init__(self):
    self.mw = Tkinter.Tk()
    self.mw.title("Messages by NeuronSimulation")
    self.text = Tkinter.Text(self.mw, width = 80, height = 30)
    self.text.pack()
    self.mw.protocol(name="WM_DELETE_WINDOW", func=self.handler)
    self.is_mw = True

  def write(self, s):
    if self.is_mw:
      self.text.insert(Tkinter.END, str(s) + "\n")
    else:
      print str(s)

  def handler(self):
    self.is_mw = False
    self.mw.quit()
    self.mw.destroy()

monitor = Monitor() 
```

**其他模块.py**

```
from monitor import monitor
monitor.write("Foo") 
```

# c - 寻找文件的开头

> ID：768475
> 
> 赞同：2
> 
> 时间：2009-04-20T14:20:29.820
> 
> 标签：c, file-io

我有一个小代码块，应该将文本附加到文件的开头。但是它仍然只添加到文件的末尾。我认为倒带将指针设置为文件的前面，因此当我使用 fprintf 添加文本时，它应该添加到前面。我怎样才能改变这个？

```
fp = fopen("Data.txt", "a");
rewind(fp);
fprintf(fp, "%s\n", text);
fclose(fp); 
```

*text 是要添加到文件前面的 char 数组*

* * *

## 回答 #1

> 赞同：13
> 
> 时间：2009-04-20T14:22:06.197

1）不要以附加模式打开。

当您以追加模式打开时，所有写入都将转到文件末尾，而不管查找位置如何。

[http://www.opengroup.org/onlinepubs/009695399/functions/fopen.html](http://www.opengroup.org/onlinepubs/009695399/functions/fopen.html)

> 打开带有附加模式的文件（a 作为模式参数中的第一个字符）将导致所有后续对该文件的写入都被强制到当时的当前文件结尾，而不管对 fseek() 的干预调用。

2）没有“a”的打开仍然不会做你想要的。使用 ANSI/POSIX 文件操作插入文件是不可能的，因为鉴于大多数文件系统存储数据的方式，插入不是一个简单的操作。

您需要打开一个新文件，写入新数据，然后附加旧文件，否则您需要乱七八糟地以块的形式向前移动数据。与在末尾追加相比，这两种选择对于大文件来说效率都非常低，更不用说如果您需要程序或机器能够在不损坏数据的情况下意外死机，那么容易出错。因此，如果这是一个日志文件或类似文件，则可能值得重新设计，以便您可以将新数据写入最后，然后在您从日志中准备报告时将其全部反转。

* * *

## 回答 #2

> 赞同：5
> 
> 时间：2009-04-20T14:50:33.837

您可以**替换**文件中的数据，但除了文件末尾之外，您不能在任何地方添加或插入它。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-04-24T03:01:56.427

只需使用您的数据创建一个新文件，然后将旧数据附加到您创建的此文件中。

# javascript - 在javascript中设置环境变量

> ID：768477
> 
> 赞同：6
> 
> 时间：2009-04-20T14:21:03.860
> 
> 标签：javascript, environment, batch-file, wsh

如何在调用另一个程序的 WSH jscript 文件中设置环境变量？这是简化的测试用例：

```
envtest.js
----------
var oShell = WScript.CreateObject("WScript.Shell");
var oSysEnv = oShell.Environment("SYSTEM");
oSysEnv("TEST_ENV_VAR") = "TEST_VALUE";
oExec = oShell.Run("envtest.bat", 1, true);    

envtest.bat
-----------
set
pause 
```

我希望在变量列表中看到 TEST_ ENV _VAR，但它不存在。怎么了？

编辑：

如果有人可以生成一个工作代码示例，我会将其标记为正确答案。:)

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2009-06-02T05:59:36.743

问题不在于您的代码，而在于流程的执行。完整的系统变量被分配给正在执行的进程。因此，您的子进程也具有相同的变量集。

您的代码示例效果很好。它将变量添加到 SYSTEM 环境。

因此，您不仅需要为您的系统设置变量，还需要为您的流程设置变量。

这是代码。

```
var oShell = WScript.CreateObject("WScript.Shell");
var oSysEnv = oShell.Environment("SYSTEM");
oSysEnv("TEST1") = "TEST_VALUE";
var oSysEnv = oShell.Environment("PROCESS");
oSysEnv("TEST1") = "TEST_VALUE";
oExec = oShell.Run("envtest.bat", 1, true); 
```

一旦你创建了系统变量。

它将为当前进程分配新创建的变量。因此，您的子进程可以在执行“SET”命令时获取该变量。

对不起，我的英语不好。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2009-05-12T15:59:25.220

如果您只需要一个子进程来查看变量，则可能需要 4 个“集合”（系统、用户、易失性和进程）

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-04-21T06:34:31.010

您正在获取系统环境变量。我怀疑您根本没有修改它们的权限；您可以尝试将其更改为用户环境变量。

另外我不知道参数`Environment()`是否区分大小写。MS 的文档使用`"System"`而不是`"SYSTEM"`. 可能会有所不同，但我不确定。

# cruisecontrol.net - 巡航控制合并？

> ID：768482
> 
> 赞同：0
> 
> 时间：2009-04-20T14:22:42.827
> 
> 标签：cruisecontrol.net

我已经成功地将 IDE 中存在的编译日志很好地提取到了某个 xml 文件中。因此，为了合并它，我`ccnet.config`在发布者任务中的文件中使用该`<merge>` 部分提到了它。

但是当我强制构建时，我能够`output.xml`正确获取文件，但在窗口中抛出一个错误`ccnet.config`，它无法合并，因为该文件当前被其他进程使用。请看下面：

> [VSAT:ERROR] 发布者抛出异常：ThoughtWorks.CruiseControl.Core.CruiseC ontrolException：无法读取文件内容：C:\ThreePartition\outp ut.xml ---> System.IO.IOException：进程无法访问'C:\ThreeP artition\output.xml' 文件，因为它正被另一个进程使用。

您能建议任何可以成功完成合并的方法吗？我在`ccnet.config`下面粘贴了整个文件。

```
 <project name="VSAT">
                <sourcecontrol type="filtered">
                 <sourceControlProvider type="filesystem">
                 <repositoryRoot>C:\ThreePartition</repositoryRoot>
                 <autoGetSource>true</autoGetSource>
                  <ignoreMissingRoot>false</ignoreMissingRoot>
                 </sourceControlProvider>
                <exclusionFilters>
                 <pathFilter>
                <pattern>C:\ThreePartition\wrSbc750gx_ThreePartition\**</pattern>
                </pathFilter>
                <pathFilter>
               <pattern>C:\ThreePartition\*.txt</pattern>
                </pathFilter>
                <pathFilter>
               <pattern>C:\ThreePartition\*.xml</pattern>
                </pathFilter>
            </exclusionFilters>
           </sourcecontrol>
          <triggers>
           <intervalTrigger name="continuous" seconds="240"
            buildCondition="IfModificationExists" />
         </triggers>
        <tasks>
        <nant>
       <executable>C:\Nant-0.85\bin\NAnt.exe</executable>
       <buildFile>nant.build</buildFile>
       </nant>
        </tasks>
       <publishers>
      <merge>
        <files>
           <file>C:\ThreePartition\output.xml</file>

          </files>
        </merge>
       <xmllogger logDir="C:\Program Files\CruiseControl.NET\server\DF2.0-CI
       \Logfiles" />

      <email from="BuildAdmin@server.com"
      mailhost="smtp.servermail.com" includeDetails="TRUE">
   <users>
     user name="Maddy" group="buildmaster"
     address="Mymail@server.com"/>
    </users>
 <groups>
 <group name="buildmaster" notification="always"/>
 <group name="developers" notification="change"/>
 </groups>
 </email>
 </publishers>
 </project>
 </cruisecontrol> 
```

* * *

我刚刚将发布者部分放在下面以获得更好的视图

```
 <publishers>
      <merge>
     <files>
              <file>C:\ThreePartition\output.xml</file>                 
         </files>
    </merge>
    <email from="BuildAdmin@server.com" mailhost="smtp.server.com" includeDetails="TRUE">
            <users>
          <user name="Maddy" group="buildmaster" address="Maddy.@server.com"/>
            </users>
            <groups>                        <group name="buildmaster" notification="always"/>
                    <group name="developers" notification="change"/>
            </groups>
    </email> 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-07-23T00:10:10.640

一些想法：

*   消除将写入该文件的其他明显应用程序：其他 CCNet 项目、其他 CCNet 实例（例如，您是否可能从命令行运行服务和某些东西？），或者可能是您的源代码控制。
*   如果您没有连接到 NAnt，请尝试 MSBuild 并查看是否遇到相同的错误。如果您所做的只是编译，则可以将 .sln 或 .csproj 作为参数直接传递给 MSBuild。
*   确保您使用的是最新版本的 CCNet - 他们会定期发布我认为相当重大的错误修复。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-01-29T11:23:34.760

说的是什么：问题是当 CC.net 试图合并时哪个进程打开了你的 xml——也许 Process Explorer 可能有用？如果您将 xml 输出复制到单独的文件并合并它，它可能会起作用。

# c# - ComboBox 中的慢速滚动

> ID：768489
> 
> 赞同：3
> 
> 时间：2009-04-20T14:23:57.770
> 
> 标签：c#, winforms, combobox, scroll

我有一个问题，即在 toolStripComboBox 和常规 ComboBox 中滚动都非常慢。

使用箭头键和鼠标滚轮都会发生这种情况。但是，如果我使用滚动条，它会按预期运行。

这是工具条组合框：

```
 // 
        // toolStripComboBoxDeild
        // 
        this.toolStripComboBoxDeild.AutoCompleteMode = System.Windows.Forms.AutoCompleteMode.SuggestAppend;
        this.toolStripComboBoxDeild.AutoCompleteSource = System.Windows.Forms.AutoCompleteSource.ListItems;
        this.toolStripComboBoxDeild.DropDownWidth = 121;
        this.toolStripComboBoxDeild.Items.AddRange(new object[] {
        "Allir"});
        this.toolStripComboBoxDeild.Margin = new System.Windows.Forms.Padding(1, 0, 8, 0);
        this.toolStripComboBoxDeild.MaxDropDownItems = 24;
        this.toolStripComboBoxDeild.Name = "toolStripComboBoxDeild";
        this.toolStripComboBoxDeild.Size = new System.Drawing.Size(200, 52);
        this.toolStripComboBoxDeild.SelectedIndexChanged += new System.EventHandler(this.toolStripComboBoxDeild_SelectedIndexChanged); 
```

我正在使用 SqlDataReader 将其余数据添加到组合框中（不使用数据集，因为我习惯使用 sqlreader）。

和常规组合框：

```
// 
        // comboBox1
        // 
        this.comboBox1.AutoCompleteMode = System.Windows.Forms.AutoCompleteMode.SuggestAppend;
        this.comboBox1.AutoCompleteSource = System.Windows.Forms.AutoCompleteSource.ListItems;
        this.comboBox1.FlatStyle = System.Windows.Forms.FlatStyle.System;
        this.comboBox1.FormattingEnabled = true;
        this.comboBox1.Location = new System.Drawing.Point(77, 17);
        this.comboBox1.Name = "comboBox1";
        this.comboBox1.Size = new System.Drawing.Size(221, 21);
        this.comboBox1.TabIndex = 1;
        this.comboBox1.SelectedIndexChanged += new System.EventHandler(this.comboBox1_SelectedIndexChanged); 
```

有没有人遇到过这个问题？如果是这样，你做了什么来解决它？

## **编辑**

将事件处理程序更改为 SelectionChangeCommitted 解决了有关箭头键的问题，但没有解决鼠标部分的问题。

鼠标滚动行为仅在鼠标悬停在下拉列表上时才会出现异常。当我在不移动鼠标的情况下单击组合框向下箭头并应用滚轮时，列表会按预期滚动。

## 编辑 2

找出鼠标滚动的问题，原来是“联想鼠标套件”软件和/或驱动程序。卸载它，现在一切都很好。

感谢 Jeff Yates 向我展示了 SelectionChangeCommitted 事件。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2009-04-20T14:36:59.813

当您使用键盘时，[所选索引会发生变化](http://msdn.microsoft.com/en-us/library/system.windows.forms.combobox.selectedindexchanged.aspx)。使用滚轮时，鼠标下的项目会发生变化，这也会导致[SelectedIndexChanged](http://msdn.microsoft.com/en-us/library/system.windows.forms.combobox.selectedindexchanged.aspx)事件。因此，如果您的事件处理程序在索引更改时很密集，它将减慢滚动速度，因为每次选定索引更改时（即每次使用鼠标或键盘滚动时）它都会运行。You should use [SelectionChangeCommitted](http://msdn.microsoft.com/en-us/library/system.windows.forms.combobox.selectionchangecommitted.aspx) to handle when the selection changes instead as this will only fire once the combo is closed.

**更新**
所以，当组合没有被下拉时，你使用鼠标滚轮吗？如果是这种情况，那么它仍然是选择更改处理，因为轮子的每次滚动都会更改提交的选择。下拉组合时滚动不会执行此操作。

我建议您使用计时器添加某种选择过滤器。每次提交选择时，您都会启动（并重新启动）计时器。只有当计时器触发时，您才会真正处理选择更改。这样，您可以使用鼠标滚轮滚动，而不会每次都产生选择惩罚。当然，请确保在计时器触发时停止计时器。

# esb - 企业服务总线术语

> ID：768492
> 
> 赞同：10
> 
> 时间：2009-04-20T14:24:19.657
> 
> 标签：esb, servicebus

任何人都可以在初级到中级级别解释[企业服务总线](http://en.wikipedia.org/wiki/Enterprise_service_bus)上下文中的“总线”、“传输”和“端点”的术语吗？我现在是一名拥有几年经验的 C# 开发人员，但才刚刚开始使用 ESB。

看起来“总线”实际上是一个可以发送和接收消息的队列。我很好。但是，我正在使用[NServiceBus](http://www.nservicebus.com/)处理一些现有代码，我认为如果我理解“端点”和“传输”术语，我的理解就会有很大的飞跃。

* * *

## 回答 #1

> 赞同：9
> 
> 时间：2009-04-20T19:32:12.053

让我试着向你澄清这些术语：

**ESB 架构上下文中的总线**不应被视为用于消息调度的简单队列。为了允许集成不同的服务，ESB 提供了更多功能。ESB 的重要附加功能：

*   路由。根据消息内容或端点规范，消息可以路由到不同的服务。
*   不同格式之间的消息转换/中介
*   传输协议转换。ESB 应该能够无缝集成使用不同传输协议（JMS、HTTP/S、纯 TCP 等）的应用程序
*   消息增强。在进一步处理之前，可以使用缺失的数据来丰富消息。
*   安全
*   管理和监控

这些功能由在 ESB 中运行的服务提供。**服务通过端点**相互连接——统一的、唯一的“地址”。在端点之间分派的消息使用统一**传输**（封装消息有效负载的方法/协议）。本机使用不同传输的应用程序需要通过合适的适配器连接到 ESB - 将提供必要的传输转换的服务。通过这种方式，使用 ESB 的应用程序彼此分离，并且不需要自己提供转换。

当然，这些只是对术语的非常简短的描述。请记住，企业服务总线只是特定类型的架构（或概念）的流行语，但它没有以任何方式标准化。因此，具体的实现可能彼此非常不同。如果您对标准化 ESB 感兴趣，可以看看 JBI（Java 业务集成）。JBI avalable 有几个开源实现，其中包括[Apache ServiceMix](http://servicemix.apache.org/)、[Mule](http://www.mulesource.org/display/MULE/Home)、[OpenESB](https://open-esb.dev.java.net/)。Manning 出版的“ [Open Source ESBs in Action](http://www.esbinaction.com/) ”一书中很好地介绍了 ESB 技术。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-05-13T01:36:19.633

我建议查看与企业应用程序集成 (EAI) 相关的资源，它围绕 ESB 以及用于集成解决方案的各种模型和模式。认为它是 ESB 架构的 GoF：

[http://www.enterpriseintegrationpatterns.com/](http://www.enterpriseintegrationpatterns.com/)

和

[http://www.enterpriseintegrationpatterns.com/toc.html](http://www.enterpriseintegrationpatterns.com/toc.html)

所有这些模式都会让您了解人们使用 ESB 来实现什么，并且这些模式对于提供自己动手的 ESB 集成的常见缺陷很有用。通过那本书和从中获取资料的人，我学到了很多东西。

# delphi - Delphi - 如何将狂欢报告导出到 Excel

> ID：768502
> 
> 赞同：1
> 
> 时间：2009-04-20T14:27:27.137
> 
> 标签：delphi, rave-reports

我有一份 50 页的好评报告

我需要生成一个包含第 1 到 50 页的 PDF 报告，并且

生成具有第 1 页到第 3 页的 Excel 电子表格

我正在使用 Delphi 2006 Rave 报告 6.5 和 gnostice v2.5

**问题：**

如何将报告的前 3 页导出到 Excel？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-04-21T15:31:19.767

你不能。Rave 不直接支持 excel。

将您的数据转储到 Excel 可以打开的 csv 文件中。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-02-08T21:26:53.703

您可以使用 ESB RaveViewer（免费工具） [http://www.esbconsult.com/raveaddons/esbraveviewer.htm](http://www.esbconsult.com/raveaddons/esbraveviewer.htm)

# python - 测试正在安装的 Python 模块依赖项

> ID：768504
> 
> 赞同：7
> 
> 时间：2009-04-20T14:27:40.507
> 
> 标签：python, reflection, import, module, python-module

给定模块的名称，如何测试是否安装了一组模块。例如

```
modules = set(["sys", "os", "jinja"])

for module in modules:
  # if test(module exists):
  #   do something 
```

虽然可以将测试写成：

```
try:
  import sys
except ImportError:
  print "No sys!" 
```

这对我正在做的事情来说有点麻烦。有没有动态的方法来做到这一点？

我试过 eval("import %s"%module) 但抱怨编译错误。

我很感激你的想法和建议。谢谢你。

* * *

## 回答 #1

> 赞同：8
> 
> 时间：2009-04-20T14:43:12.823

您可以[`__import__()`](http://docs.python.org/library/functions.html)像这样使用该功能::

```
for module in modules:
    try:
        __import__(module)
    except ImportError:
        do_something() 
```

您还可以使用[`imp.find_module`](http://docs.python.org/library/imp.html)来确定是否可以在*不*导入模块的情况下找到它::

```
import imp
for module in modules:
    try:
        imp.find_module(module)
    except ImportError:
        do_something() 
```

哦，你不能使用的原因`eval()`是因为`import`它是一个语句，而不是一个表达式。如果你*真的*想要，你*可以*使用，虽然我不推荐它::`exec`

 *```
for module in modules:
    try:
        exec 'import ' + module
    except ImportError:
        do_something() 
```

* * *

## 回答 #2

> 赞同：6
> 
> 时间：2009-04-20T14:31:51.480

这有什么问题？

```
modules = set(["sys", "os", "jinja"])
for m in modules:
    try:
        __import__(m)
    except ImportError:
        # do something 
```

以上使用该[`__import__`](http://docs.python.org/library/functions.html#__import__)功能。此外，它正在严格测试它是否存在 - 它实际上并未将导入保存在任何地方，但您可以轻松修改它来做到这一点。

* * *

## 回答 #3

> 赞同：5
> 
> 时间：2010-07-14T16:05:14.747

值得了解 find_module 方法和`__import__`方法之间的权衡：

*   `__import__('foo')`无论您是否保存对导入模块的引用，都会触发加载模块的任何副作用。这可能是好的，也可能不是。
*   `find_module('foo')`不会引发任何副作用，因此它应该始终是安全的。
*   如果找到模块但在加载时存在其他问题（例如 SyntaxError、NameError ......），则两种方法都无法正常工作
*   根据您处理失败的方式，如果找到了 foo 但 foo 导入了*未*`__import__('foo')`找到的 bar，则简单地包装在 try/except 中会给您带来误导性的结果。
**   `find_module()`无法处理带点的名称，因此如果您需要检查是否可以导入“foo.bar.bat.baz”，则必须根据[文档对 find_module 和 load_module 进行多次调用。](http://docs.python.org/library/imp.html)*

 ** * *

## 回答 #4

> 赞同：2
> 
> 时间：2009-04-20T14:43:22.467

```
modules = set(["sys", "os", "jinja"])
try:
  for module in modules:
    __import__(module)
  doSomething()
except ImportError, e:
    print e 
```

# c# - 终结者有什么用？

> ID：768506
> 
> 赞同：9
> 
> 时间：2009-04-20T14:27:43.627
> 
> 标签：c#, .net, vb.net, finalizer

我已经在 .NET 中编程了四年（主要是 C#），并且我广泛使用 IDiposable，但我还没有发现需要终结器。终结者有什么用？

* * *

## 回答 #1

> 赞同：11
> 
> 时间：2009-04-20T14:30:50.873

终结器是确保正确清理某些内容的最后尝试，通常保留给包装**非托管**资源的对象，例如不会被垃圾收集的非托管句柄等。

编写终结器确实很少见。幸运的是（与 不同`IDisposable`），终结器不需要传播；因此，如果您有一个`ClassA`带有终结器的 a 和一个`ClassB`which wraps `ClassA`，则`ClassB`不需要终结器 - 但很可能两者都`ClassA`将`ClassB`实现`IDisposable`.

对于托管代码，`IDisposable`通常就足够了。即使您没有正确清理，最终托管对象也会被收集（假设它们已被释放）。

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2009-04-20T14:36:45.290

终结器仅用于释放**非托管**资源，例如 GDI 位图句柄。如果您不分配任何非托管资源，那么您不需要终结器。一般来说，在终结器中触摸任何**托管**对象都是一个坏主意，因为不能保证终结的顺序。

另一种使用终结器的有用技术是在应用程序需要这样做时断言 Dispose 已被调用。这可以帮助捕获 DEBUG 构建中的编码错误：

```
void Dispose()
{
  GC.SuppressFinalize(this);
}
#if DEBUG
~MyClass()
{
  Debug.Fail("Dispose was not called.");
}
#endif 
```

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2009-04-20T14:31:02.043

终结器是一种释放不受垃圾收集器控制的资源的机制，例如非托管句柄。虽然`Dispose`可能会这样做，但不能保证消费者会调用​​它。

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2009-04-20T14:30:38.050

终结器用于清理未处理的资源。

IE，没有任何东西强制你调用 Dispose()，但是垃圾收集器会自动调用终结器。

不应依赖此功能，因为无法保证垃圾收集何时（或是否）到达您的对象。

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2009-04-20T14:37:33.477

维基百科[说](http://en.wikipedia.org/wiki/Finalizer)：

> ...终结器是一段代码，可确保在获取的资源...不再使用时采取某些必要的操作[因为拥有的对象已被垃圾收集]

如果您在编写 IDisposables 时没有使用终结器，那么您很可能会发生内存泄漏，因为无法保证所有者实际上会调用 Dispose()。

MS 自己建议您将与此类似的内容写入您的实施者：

```
 public void Dispose()
    {
        this.Dispose(true);
    }

    protected virtual void Dispose(bool disposing)
    {
        if (!this.isDisposed)
        {
            if (disposing)
            {
                GC.SuppressFinalize(this);
            }
        }
        //Dispose of resources here
        this.isDisposed = true;
    }

    ~DisposableSafe()
    {
        this.Dispose(false);
    }

    private bool isDisposed = false; 
```

就个人而言，我无法忍受复制粘贴，所以我倾向于将其包装在一个抽象类中以供重用。

# c# - 突出显示消息框中的文本

> ID：768508
> 
> 赞同：2
> 
> 时间：2009-04-20T14:29:01.907
> 
> 标签：c#, text, message, highlight

我需要显示一个消息框，但用户需要能够突出显示和复制消息框中的文本。我将如何实现这一目标？仅供参考，在 C# 中。

* * *

## 回答 #1

> 赞同：9
> 
> 时间：2009-04-20T14:31:31.370

当消息框处于活动状态时，当用户按 CTRL+C 时，Windows 具有复制消息框文本的隐藏功能。

如果您需要允许用户突出显示文本，那么您需要创建一个自定义消息框来执行此操作。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-04-20T16:02:21.840

这是我用来创建自定义 MessageBox 的一些代码。下面是 MessageBox 类：

```
'  A custom MessageBox class
'  Written to allow custom button text, specifically to allow for bilingual messageboxes
'
Public Class CustomMessageBox

  'Variables
  Private _btn1Return As DialogResult
  Private _btn2Return As DialogResult
  Private _btn3Return As DialogResult

  'Enumerate system icons
  Enum SystemIcons
    ErrorIcon = 1
    WarningIcon = 2
    QuestionIcon = 3
    InformationIcon = 4
  End Enum

  'Enumerate possible button combinations
  Enum ButtonTypes
    YesNo = 1
    YesNoCancel = 2
    Ok = 3
    OkCancel = 4
  End Enum

  'Enumerate possible default buttons
  Enum DefaultButton
    Button1 = 1
    Button2 = 2
    Button3 = 3
  End Enum

#Region "Constructor"
  'Constructor
  Public Sub New(ByVal text As String, ByVal caption As String, ByVal buttons As ButtonTypes, ByVal icon As SystemIcons, ByVal defaultButton As DefaultButton)
    InitializeComponent()
    Me.Text = caption
    Me.msgBoxText.Text = text
    SetupIcon(icon)
    SetupButtons(buttons, defaultButton)
  End Sub
#End Region

#Region "Functions"
  'Set text and return values of all buttons.  Also set focus to default button.
  Private Sub SetupButtons(ByVal buttons As Integer, ByVal defaultButton As Integer)
    Select Case buttons
      Case 1
        msgBoxButton1.Text = My.Resources.Caption_Yes
        _btn1Return = Windows.Forms.DialogResult.Yes
        msgBoxButton2.Text = My.Resources.Caption_No
        _btn2Return = Windows.Forms.DialogResult.No
        msgBoxButton3.Visible = False
      Case 2
        msgBoxButton1.Text = My.Resources.Caption_Yes
        _btn1Return = Windows.Forms.DialogResult.Yes
        msgBoxButton2.Text = My.Resources.Caption_No
        _btn2Return = Windows.Forms.DialogResult.No
        msgBoxButton3.Text = My.Resources.Caption_Cancel
        _btn3Return = Windows.Forms.DialogResult.Cancel
      Case 3
        msgBoxButton1.Text = My.Resources.Caption_OK
        _btn1Return = Windows.Forms.DialogResult.OK
        msgBoxButton2.Visible = False
        msgBoxButton3.Visible = False
      Case 4
        msgBoxButton1.Text = My.Resources.Caption_OK
        _btn1Return = Windows.Forms.DialogResult.OK
        msgBoxButton2.Text = My.Resources.Caption_Cancel
        _btn2Return = Windows.Forms.DialogResult.Cancel
        msgBoxButton3.Visible = False
    End Select

    'Set focus to specified default button
    Select Case defaultButton
      Case 1
        msgBoxButton1.Focus()
      Case 2
        msgBoxButton2.Focus()
      Case 3
        msgBoxButton3.Focus()
    End Select

  End Sub

  'Display specified icon
  Private Sub SetupIcon(ByVal iconValue As Integer)
    Dim icon As Icon = Nothing
    Select Case iconValue
      Case 1
        icon = System.Drawing.SystemIcons.Error
      Case 2
        icon = System.Drawing.SystemIcons.Warning
      Case 3
        icon = System.Drawing.SystemIcons.Question
      Case 4
        icon = System.Drawing.SystemIcons.Information
    End Select

    Me.msgBoxIcon.Image = icon.ToBitmap
  End Sub
#End Region

#Region "Events"
  'Set return value when button is clicked.
  Private Sub msgBoxButton1_Click(ByVal sender As System.Object, ByVal e As System.EventArgs) Handles msgBoxButton1.Click
    Me.DialogResult = _btn1Return
    Me.Close()
  End Sub

  'Set return value when button is clicked.
  Private Sub msgBoxButton2_Click(ByVal sender As System.Object, ByVal e As System.EventArgs) Handles msgBoxButton2.Click
    Me.DialogResult = _btn2Return
    Me.Close()
  End Sub

  'Set return value when button is clicked.
  Private Sub msgBoxButton3_Click(ByVal sender As System.Object, ByVal e As System.EventArgs) Handles msgBoxButton3.Click
    Me.DialogResult = _btn3Return
    Me.Close()
  End Sub
#End Region

End Class 
```

这是与之关联的设计器代码：

```
<Global.Microsoft.VisualBasic.CompilerServices.DesignerGenerated()> _
Partial Class CustomMessageBox
    Inherits System.Windows.Forms.Form

    'Form overrides dispose to clean up the component list.
    <System.Diagnostics.DebuggerNonUserCode()> _
    Protected Overrides Sub Dispose(ByVal disposing As Boolean)
        Try
            If disposing AndAlso components IsNot Nothing Then
                components.Dispose()
            End If
        Finally
            MyBase.Dispose(disposing)
        End Try
    End Sub

    'Required by the Windows Form Designer
    Private components As System.ComponentModel.IContainer

    'NOTE: The following procedure is required by the Windows Form Designer
    'It can be modified using the Windows Form Designer.  
    'Do not modify it using the code editor.
    <System.Diagnostics.DebuggerStepThrough()> _
    Private Sub InitializeComponent()
    Me.msgBoxText = New System.Windows.Forms.Label
    Me.msgBoxIcon = New System.Windows.Forms.PictureBox
    Me.TableLayoutPanel1 = New System.Windows.Forms.TableLayoutPanel
    Me.msgBoxButton1 = New System.Windows.Forms.Button
    Me.msgBoxButton3 = New System.Windows.Forms.Button
    Me.msgBoxButton2 = New System.Windows.Forms.Button
    CType(Me.msgBoxIcon, System.ComponentModel.ISupportInitialize).BeginInit()
    Me.TableLayoutPanel1.SuspendLayout()
    Me.SuspendLayout()
    '
    'msgBoxText
    '
    Me.msgBoxText.AutoSize = True
    Me.msgBoxText.Cursor = System.Windows.Forms.Cursors.Cross
    Me.msgBoxText.Dock = System.Windows.Forms.DockStyle.Fill
    Me.msgBoxText.FlatStyle = System.Windows.Forms.FlatStyle.Flat
    Me.msgBoxText.Location = New System.Drawing.Point(59, 0)
    Me.msgBoxText.MaximumSize = New System.Drawing.Size(245, 0)
    Me.msgBoxText.Name = "msgBoxText"
    Me.msgBoxText.Padding = New System.Windows.Forms.Padding(0, 10, 0, 10)
    Me.msgBoxText.Size = New System.Drawing.Size(39, 33)
    Me.msgBoxText.TabIndex = 6
    Me.msgBoxText.Text = "Label1"
    '
    'msgBoxIcon
    '
    Me.msgBoxIcon.Dock = System.Windows.Forms.DockStyle.Left
    Me.msgBoxIcon.Location = New System.Drawing.Point(0, 0)
    Me.msgBoxIcon.Name = "msgBoxIcon"
    Me.msgBoxIcon.Padding = New System.Windows.Forms.Padding(15, 10, 0, 0)
    Me.msgBoxIcon.Size = New System.Drawing.Size(59, 53)
    Me.msgBoxIcon.TabIndex = 4
    Me.msgBoxIcon.TabStop = False
    '
    'TableLayoutPanel1
    '
    Me.TableLayoutPanel1.AutoSize = True
    Me.TableLayoutPanel1.ColumnCount = 5
    Me.TableLayoutPanel1.ColumnStyles.Add(New System.Windows.Forms.ColumnStyle(System.Windows.Forms.SizeType.Percent, 50.0!))
    Me.TableLayoutPanel1.ColumnStyles.Add(New System.Windows.Forms.ColumnStyle)
    Me.TableLayoutPanel1.ColumnStyles.Add(New System.Windows.Forms.ColumnStyle)
    Me.TableLayoutPanel1.ColumnStyles.Add(New System.Windows.Forms.ColumnStyle)
    Me.TableLayoutPanel1.ColumnStyles.Add(New System.Windows.Forms.ColumnStyle(System.Windows.Forms.SizeType.Percent, 50.0!))
    Me.TableLayoutPanel1.Controls.Add(Me.msgBoxButton1, 1, 0)
    Me.TableLayoutPanel1.Controls.Add(Me.msgBoxButton3, 3, 0)
    Me.TableLayoutPanel1.Controls.Add(Me.msgBoxButton2, 2, 0)
    Me.TableLayoutPanel1.Dock = System.Windows.Forms.DockStyle.Bottom
    Me.TableLayoutPanel1.GrowStyle = System.Windows.Forms.TableLayoutPanelGrowStyle.FixedSize
    Me.TableLayoutPanel1.Location = New System.Drawing.Point(0, 53)
    Me.TableLayoutPanel1.Name = "TableLayoutPanel1"
    Me.TableLayoutPanel1.Padding = New System.Windows.Forms.Padding(0, 0, 0, 10)
    Me.TableLayoutPanel1.RowCount = 1
    Me.TableLayoutPanel1.RowStyles.Add(New System.Windows.Forms.RowStyle)
    Me.TableLayoutPanel1.Size = New System.Drawing.Size(305, 39)
    Me.TableLayoutPanel1.TabIndex = 5
    '
    'msgBoxButton1
    '
    Me.msgBoxButton1.AutoSize = True
    Me.msgBoxButton1.Location = New System.Drawing.Point(34, 3)
    Me.msgBoxButton1.Name = "msgBoxButton1"
    Me.msgBoxButton1.Size = New System.Drawing.Size(75, 23)
    Me.msgBoxButton1.TabIndex = 0
    Me.msgBoxButton1.Text = "Button1"
    Me.msgBoxButton1.UseVisualStyleBackColor = True
    '
    'msgBoxButton3
    '
    Me.msgBoxButton3.AutoSize = True
    Me.msgBoxButton3.Location = New System.Drawing.Point(196, 3)
    Me.msgBoxButton3.Name = "msgBoxButton3"
    Me.msgBoxButton3.Size = New System.Drawing.Size(75, 23)
    Me.msgBoxButton3.TabIndex = 2
    Me.msgBoxButton3.Text = "Button3"
    Me.msgBoxButton3.UseVisualStyleBackColor = True
    '
    'msgBoxButton2
    '
    Me.msgBoxButton2.AutoSize = True
    Me.msgBoxButton2.Location = New System.Drawing.Point(115, 3)
    Me.msgBoxButton2.Name = "msgBoxButton2"
    Me.msgBoxButton2.Size = New System.Drawing.Size(75, 23)
    Me.msgBoxButton2.TabIndex = 1
    Me.msgBoxButton2.Text = "Button2"
    Me.msgBoxButton2.UseVisualStyleBackColor = True
    '
    'CustomMessageBox
    '
    Me.AutoScaleDimensions = New System.Drawing.SizeF(6.0!, 13.0!)
    Me.AutoScaleMode = System.Windows.Forms.AutoScaleMode.Font
    Me.AutoSize = True
    Me.ClientSize = New System.Drawing.Size(305, 92)
    Me.Controls.Add(Me.msgBoxText)
    Me.Controls.Add(Me.msgBoxIcon)
    Me.Controls.Add(Me.TableLayoutPanel1)
    Me.FormBorderStyle = System.Windows.Forms.FormBorderStyle.FixedDialog
    Me.MaximizeBox = False
    Me.MinimizeBox = False
    Me.Name = "CustomMessageBox"
    Me.SizeGripStyle = System.Windows.Forms.SizeGripStyle.Hide
    Me.StartPosition = System.Windows.Forms.FormStartPosition.CenterScreen
    Me.Text = "MessageBox"
    Me.TopMost = True
    CType(Me.msgBoxIcon, System.ComponentModel.ISupportInitialize).EndInit()
    Me.TableLayoutPanel1.ResumeLayout(False)
    Me.TableLayoutPanel1.PerformLayout()
    Me.ResumeLayout(False)
    Me.PerformLayout()

  End Sub
  Friend WithEvents msgBoxText As System.Windows.Forms.Label
  Friend WithEvents msgBoxIcon As System.Windows.Forms.PictureBox
  Friend WithEvents TableLayoutPanel1 As System.Windows.Forms.TableLayoutPanel
  Friend WithEvents msgBoxButton1 As System.Windows.Forms.Button
  Friend WithEvents msgBoxButton3 As System.Windows.Forms.Button
  Friend WithEvents msgBoxButton2 As System.Windows.Forms.Button
End Class 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-04-20T14:31:28.267

我认为使用默认文本控件并不容易，但您可以尝试[icsharpcode texteditor](http://www.codeproject.com/KB/edit/TextEditorControl.aspx)或[Alsing 的文本编辑器控件](http://code.google.com/p/alsing/)

我已经将 icsharpcode 用于类似的东西，它很容易使用。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2009-04-20T14:33:20.617

创建一个自定义消息框并使用一个禁用的 TextBox 并设置适当的样式来显示消息。

根据 Jhonny 的评论：创建一个新表单，并使用 ShowDialog 显示它

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2009-04-20T15:57:29.900

将新表单添加到您的项目中。在 Visual Studio 中，您可以通过转到项目 -> 添加 Windows 窗体来执行此操作。

修改表单，直到您觉得它看起来与标准窗口对话框足够接近。您需要更改的一些属性：

*   窗体边框样式
*   起始位置
*   最大化框
*   最小化框
*   显示图标
*   显示任务栏

为表单的标签使用只读文本框。并将文本框的 BorderStyle 设置为 None。

最后，使用表单的 ShowDialog() 方法将其显示为模式对话框。

PS。您还应该使用大量文本对其进行测试。您可能必须设置表单的自动调整大小模式并将文本框设置为多行并换行。

我希望这会有所帮助。

# matlab - 在 MATLAB 中创建的 GUI 中显示已编辑图片的问题

> ID：768510
> 
> 赞同：3
> 
> 时间：2009-04-20T14:29:35.540
> 
> 标签：matlab, user-interface, matlab-guide

我有一个使用 MATLAB GUIDE 创建 GUI 的任务，但在显示已编辑的图片时遇到问题。我需要有编辑图片的按钮（例如，删除红色、蓝色、绿色组件并旋转）并显示该编辑过的图片。我`imshow`用来显示编辑后的图片，但它显示在一个新窗口中并关闭了我正在运行的 GUI。任何人都可以帮忙吗？

我一直在努力解决这个问题，并尝试了许多不同的方法来解决这个问题，但都没有奏效。但是，我使用的是 MATLAB 7.0.1，而 7.7.0 可能会针对此问题进行更新。

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2009-04-20T14:35:34.527

当你第一次用 绘制图像时[`imshow`](https://www.mathworks.com/help/images/ref/imshow.html)，让它返回它创建的图像对象的句柄：

```
A = (the initial matrix of image data);
hImage = imshow(A); 
```

然后，要使用新数据更新图像，请尝试以下操作，而不是`imshow`再次调用：

```
B = (modification of the original image matrix A);
set(hImage, 'CData', B); 
```

使用该[`set`](https://www.mathworks.com/help/matlab/ref/set.html)命令将更改您已经创建的图像对象（可以在[此处](https://www.mathworks.com/help/matlab/ref/image-properties.html)找到图像对象属性列表）。

或者，您还可以在调用中添加其他参数，`imshow`以告诉它要在哪个轴对象中绘制图像：

```
hAxes = (the handle to an axes object);
imshow(A, 'Parent', hAxes); 
```

* * *

**编辑：**

[解决您在函数之间共享 GUI 数据的额外问题，您应该在此处](https://www.mathworks.com/help/matlab/creating_guis/share-data-among-callbacks.html)查看 MATLAB 文档。如前所述，有几种不同的方法可以在 GUI 中涉及的不同函数之间传递数据：嵌套函数（在 SO 中提到），使用对象[的](https://stackoverflow.com/q/272511/52738)“UserData”属性（在 SO 中提到[）](https://stackoverflow.com/q/704391/52738)，或使用函数[`setappdata`](https://www.mathworks.com/help/matlab/ref/setappdata.html)/[`getappdata`](https://www.mathworks.com/help/matlab/ref/getappdata.html)或[`guidata`](https://www.mathworks.com/help/matlab/ref/guidata.html)。该`guidata`选项可能最适合与在 GUIDE 中制作的 GUI 一起使用。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-04-21T22:32:04.780

GUI m 文件函数自动将图像数据分配给名为`hObject`. 完成图像更改后，您必须将新数据重新分配给`hObject`：

```
hObject = imshow(newimagedata) 
```

不要忘记通过以下方式更新并保存此操作：

```
guidata(hObject, handles) 
```

# .net - 枚举值的通用数组？

> ID：768511
> 
> 赞同：1
> 
> 时间：2009-04-20T14:29:37.177
> 
> 标签：.net, enums

我目前正在 VB.NET 中编写一个辅助函数来将枚举值数组转换为 CSV，但我遇到了一些困难......

如果我想让我的函数足够通用以处理我传递给它的任何枚举，我不确定我的函数应该采取什么类型的争论。

这是我到目前为止所得到的：

```
Public Shared Function EnumArrayToCSV(ByVal values() As System.Enum) As String
    Dim result As Generic.List(Of String) = New Generic.List(Of String)

    For i As Integer = 0 To values.GetUpperBound(0)
        result.Add(Convert.ToInt32(values(i)))
    Next i

    Return String.Join(",", result.ToArray)
End Function 
```

我意识到这个论点是不正确的，因为我正在使用一系列枚举。理想情况下，我想使用一组通用的枚举值。

任何人都可以帮忙吗？

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2009-04-20T14:36:21.983

```
Public Shared Function CSVFromEnumValues(Of T)(ByVal values As IEnumerable(Of T)) As String
    Dim sb As New StringBuilder()

    Dim delimiter As String = ""
    For Each item As T In values
        sb.Append(delimiter).Append(Convert.ToInt32(item).ToString())
        delimiter = ","
    Next item

    return sb.ToString()
End Function 
```

关于此代码的一些注释：

*   我开始更喜欢[`TypeFromType()`而不是`TypeToType()`命名约定](http://jcoehoorn.vox.com/library/post/datatable-to-json-and-naming-conventions.html)，因为它将类型放在包含它们的变量附近而不是相反。
*   此代码将接受一个数组。它还将接受列表或您能想到的大多数其他集合。这是一件好事——它使您的代码更加强大和灵活。
*   此代码不限于枚举值，但枚举值只是一种类型。它们的值没有什么特别之处。这真的不是一件坏事。它仍然适用于枚举值，因此您可以很好地使用它。它适用于其他项目不一定是一个缺陷。

# visual-studio-2008 - 如何在 VS 2008 中创建 MSI 以将证书安装到客户端计算机上的 Trusted Publisher 存储中？

> ID：768512
> 
> 赞同：3
> 
> 时间：2009-04-20T14:30:19.063
> 
> 标签：visual-studio-2008, installation, wix, windows-installer, certificate

创建 VS 2008 MSI 设置和部署文件以将自定义创建的证书/密钥安装到客户端计算机上需要哪些步骤？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-04-20T18:35:25.760

1.  正确的方法是使用 Wix3 而不是 Visual Studio 部署项目，Wix 具有非常强大的[证书元素。](http://wix.sourceforge.net/manual-wix3/iis_xsd_certificate.htm)
2.  如果您仍想使用 Visual Studio 部署项目，请查看有关如何使用 C# 安装证书的[答案。](https://stackoverflow.com/questions/308554/install-certificates-in-to-the-windows-local-user-certificate-store-in-c/313876#313876)您需要在[Installer 类](http://msdn.microsoft.com/en-us/library/system.configuration.install.installer.aspx)中扭曲此代码，并[在部署项目中对其进行排序](http://www.devcity.net/Articles/339/1/article.aspx)。

# c# - 如何获取组合框中的项目数？

> ID：768513
> 
> 赞同：21
> 
> 时间：2009-04-20T14:30:21.577
> 
> 标签：c#, .net, winforms, combobox

如何获取组合框中列出的项目数？

* * *

## 回答 #1

> 赞同：38
> 
> 时间：2009-04-20T14:32:43.240

尝试

```
var count = comboBox.Items.Count; 
```

* * *

## 回答 #2

> 赞同：19
> 
> 时间：2009-04-20T14:32:39.027

您应该引用`Count`该[`Items`](http://msdn.microsoft.com/en-us/library/system.windows.forms.combobox.items.aspx)属性。

```
myComboBox.Items.Count 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2019-07-04T13:10:55.167

```
comboBox.Items.Count; 
```

对我不起作用。

我用 ：

```
comboBox->count(); 
```

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2020-12-10T06:41:56.910

```
Variable_name_JComboBox.getComponentCount() 
```

# asp.net - 为什么我的完全限定域名请求 url 会被 Cassini Web 服务器转换为 IP 地址请求 url？

> ID：768514
> 
> 赞同：0
> 
> 时间：2009-04-20T14:30:22.607
> 
> 标签：asp.net, browser, dns, cassini

我有一个 Web 应用程序，它依赖于保留[FQDN](http://en.wikipedia.org/wiki/FQDN)的浏览器客户端才能使其工作，但发生的情况是，在多个浏览器中，我看到 url 被转换为 ip 地址 url（包含正确的 IP 地址）正在通过来自 Web 服务器的重定向进行更改。

托管资源的 Web 服务器是 Cassini，HttpRequest 类[Url 属性](http://msdn.microsoft.com/en-us/library/system.web.httprequest.url.aspx)返回 URL 中的 IP 地址，而不是 FQDN。

关于如何改变这种行为的任何建议？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-04-20T14:44:54.037

这可能是您的 Web 服务器中的错误配置。在 apache 中（例如），可以在使用`ServerName`指令执行某些重写过程时设置要使用的规范主机名。一种常见的情况是 Web 服务器在 URL 的末尾添加斜杠（“ [http://example.com/path”→“http://192.168.1.1/path/](http://192.168.1.1/path/) [”](http://example.com/path)）。

我建议看看 curl 发生了什么。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-04-20T14:54:43.653

这不是 DNS 问题，而是 Web 服务器配置问题。

是的，DNS 用于将 URL 的主机名部分转换为 IP 地址。

但是，该 IP 地址永远不会出现在浏览器栏中*，除非 Web 服务器通过发送重定向告诉它*。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2009-04-21T17:30:34.113

感谢所提供的有用信息，我能够将此问题追溯到作为 Cassini 实现的一部分的 .NET Framework的[HttpWorkerRequest抽象类的不完整实现。](http://msdn.microsoft.com/en-us/library/system.web.httpworkerrequest(VS.71).aspx)Cassini 实现未能覆盖 GetServerName，并且基本实现返回的是 IP 地址而不是域名。

# php - 在 PHP 中使用函数？

> ID：768528
> 
> 赞同：0
> 
> 时间：2009-04-20T14:32:18.280
> 
> 标签：php, function

如何使用 PHP 简单地调用函数？

假设我创建了：

```
function sam(){
 echo "Hello World!;
 exit();
} 
```

我将如何启动该功能？

* * *

## 回答 #1

> 赞同：15
> 
> 时间：2009-04-20T14:43:22.917

**这是一个技巧问题吗？**

我注意到的第一件事是您缺少报价：

```
function sam(){ echo "Hello World!; exit(); } 
```

.. 应该 ..

```
function sam(){ echo "Hello World!"; exit(); } 
```

*（我看到你在我提到上述内容后通过添加引用修复了你的帖子）。*

接下来，在您的情况下，函数 echo 是结果，然后**退出整个脚本**（*它不只是像您假设的那样退出函数*），因此除了此之外您无能为力：

```
<?php

function sam(){ 
  echo "Hello World!"; 
  exit(); 
}

sam();
// anything here on down will not execute or render!

?> 
```

但是，如果您的功能更真实，就像这样：

```
function sam() {
  return "Hello World!";
} 
```

..那么你可以做任何这些（以及更多）..

```
$s = sam();
echo $s;
$s = "Say it: " . sam();
echo $s; 
```

* * *

## 回答 #2

> 赞同：13
> 
> 时间：2009-04-20T14:34:22.563

像这样 -

```
sam(); 
```

* * *

## 回答 #3

> 赞同：8
> 
> 时间：2009-04-20T14:37:12.403

阅读[有关函数的 PHP 手册](http://docs.php.net/manual/en/language.functions.php)。请注意，这[`exit`](http://docs.php.net/exit)不仅会退出函数，还会退出整个脚本。因此，在此调用之后不会执行任何其他操作。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2009-04-20T14:47:08.570

```
<?php

sam();

?> 
```

帮助自己到 php.net

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2009-04-20T14:57:47.673

我刚刚开始在 PHP 中使用 OOP 技术，我发现网上很难找到的一个简单信息是，如果你想将你的函数作为你需要使用的对象的一部分来调用`$this->functionName();`

IE

```
class newInstance {
    function helloWorld(){
      echo 'Hello world';
    }
}

$object = new newInstance();
$object->helloWorld; 
```

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2009-04-20T14:35:01.533

好吧，我想：

`sam();`

* * *

## 回答 #7

> 赞同：-1
> 
> 时间：2009-04-20T16:54:24.913

除了此处的其他答案之外，我认为您使用 exit() 的意图实际上已被[return 构造](http://php.net/return)满足。[有关返回值](http://us.php.net/manual/en/functions.returning-values.php)的更多信息。

但是，在您的示例中，没有理由使用它，因为一旦函数结束并且没有指定其他返回值，PHP 函数会自动返回 void。

您希望使用 return 停止函数继续执行的示例：

```
function foo($bar) {
  if ($bar < 10) {
    return;
  }

  return $bar * 10;
}
print foo(1); // Prints nothing
print foo(20); // Prints 200 
```

我无法告诉您这个特定示例具有哪些实际应用程序，但它显示了一种有用的情况，您可能希望缩短功能。

另一个显示简单函数中不需要 return 的示例：

```
function foo($bar) {
  print $bar * 10;
}

foo(20); // Prints 200
print foo(20); // Also prints 200, but since the function does not return anything, the print statement on this line does nothing. 
```

您可能还想[查看函数的 PHP.net 手册部分](http://us.php.net/manual/en/language.functions.php)。希望这可以帮助。

# javascript - Flash文件链接

> ID：768531
> 
> 赞同：0
> 
> 时间：2009-04-20T14:32:45.453
> 
> 标签：javascript, html, flash

我有一个 Flash 文件菜单，但在将其链接到我的其他网页时遇到问题，代码如下。

```
<div id="flashcontent">
<a href="http://www.Yahoo.com.com">Home</a>|
<a href="http://www.gmail.com">Products</a>|
<a href="Home.htm">Downloads</a>|
<script type="text/javascript">
var so = new SWFObject("10.swf","10","170","415","8","#3D596C"); 
so.addParam("allowScriptAccess","always"); so.write("flashcontent");
</script> 
```

如您所见，前两个链接有效，但我链接到 http 的第三个链接无效。有人请帮助我如何为我的本地目录页面编写这个。谢谢

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-04-20T14:42:00.800

可能该文件位于更深的目录中`/mydirectory/page`，而下载链接位于`/Home.htm`. 这是一个很好的资源。

[http://www.compugoddess.com/relvsabs.htm](http://www.compugoddess.com/relvsabs.htm)

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-04-20T14:41:24.247

尝试

```
<a href="/Home.htm">Downloads</a> 
```

# javascript - 如何使用 javascript 在页面之间发送值？

> ID：768532
> 
> 赞同：2
> 
> 时间：2009-04-20T14:33:08.107
> 
> 标签：javascript, jquery

我目前正在使用 javascript 代码使表格中的整行可点击。单击该行后，将运行一个函数，我想知道我可以使用什么来重定向到 PHP 页面，并且最好随它一起发送一个 post 变量。我的猜测是 AJAX，但我不确定它如何或是否会起作用。

> **Javascript**

```
function DoNav(theUrl) {
    document.location.href = theUrl;
}; 
```

> **HTML**

```
<tr onclick="DoNav('myphpscript.php');"> 
```

我可以访问 jQuery，所以这也是一个选项。任何帮助表示赞赏，谢谢！

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2009-04-20T14:42:51.217

如果您需要 POST 数据（不使用 GET），一个简单的选择是动态创建一个表单元素，将输入元素附加到您需要的值并提交它。如果你使用 jQuery，你可以这样做：

```
$(function() { 
    $('tr').click(function() {
        var mail_id = /* get the mail id of this row... not sure where since I dont' have the HTML */
        $('body').append('<form method="post" action="myphpscript.php" id="donavform" style="display:none;"></form>');
        $('#donavform').append('<input type="hidden" name="mid" value="'+mail_id+'" />');
        $('#donavform').submit();
    });
}); 
```

~~希望这是有道理的。如果没有，请告诉我！~~没关系...

**说明：** 第一行是一个 jQuery 快捷方式，表示“当文档完成加载时......”因此，当页面完成加载时，我将给文档中的*所有* 元素附加一个事件监听器。单击其中一个元素时，我们可以提取与该特定表行相关的邮件 ID（以及您需要的任何其他内容）。所以，如果你有这样的 HTML：

```
<!-- 8435 is the mail ID in this example. -->
<tr id="row3">8435</tr> 
```

然后我们可以像这样提取 mail_id 变量：

```
var mail_id = $(this).html(); 
```

现在，我们将在 HTML 正文的末尾附加一个隐藏的表单元素（我们把它放在哪里并不重要，因为它是隐藏的……所以，结尾很好）。在这个表单元素中，我们将方法设置为 POST 并将操作设置为您需要 POST 到的任何 php 文件。我还设置了一个 ID，以便在下一步中轻松引用它。

我现在将使用其 ID 选择新创建的表单元素，并使用适当的名称值对向其附加一个新的隐藏输入元素。

```
$('#donavform').append('<input type="hidden" name="mid" value="'+mail_id+'" />'); 
```

最后，我将使用~~jQuery~~ JavaScript 提交方法来触发表单上的提交事件。这基本上相当于按普通表单上的“提交”按钮。

试一试，它应该可以完美运行。

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2009-04-20T14:36:32.030

如果您要去一个新页面，只需像往常一样提交表单。将数据放入表单字段（如果需要，隐藏）。不需要 Ajax、jQuery 或任何其他魔法，除非您想留在同一页面上并在后台发布。

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2009-04-20T14:39:15.610

如果数据量不是很大，请使用查询字符串...

<tr onclick="DoNav('myphpscript.php **?key=value** ');">

或者，如果您需要自然的 HTTP 帖子，您可以使用 Javascript 以编程方式提交表单...

```
onclick="document.forms[0].submit();" 
```

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2009-04-20T14:43:06.867

您可以在 cookie 中发送数据。有一个不错的 jQuery 插件，可以帮助在 jQuery 命名空间中设置 cookie。

[http://plugins.jquery.com/project/cookie](http://plugins.jquery.com/project/cookie)

# c# - C# 类对象

> ID：768538
> 
> 赞同：0
> 
> 时间：2009-04-20T14:33:32.787
> 
> 标签：c#, class, object

我有一个我在下面使用的课程。我正在将这个类用于我的 Windows 应用程序。但是，当我从我的应用程序 ReadInConfig() 调用该方法时，它会成功读取并填充数据表，并分配 _sip_ip 地址。

在我的 Windows 应用程序中，我有以下内容。但是，它没有给我分配的 sip_ip。

```
ConfigSIP readIn = new ConfigSIP();
readIn.ReadInConfig();
string sip_ip = readIn.sip_ip(); // Get nothing here. 
```

我认为数据表分配的 _sip_ip 与执行此 readIn.sip_ip(); 是不同的对象；

有什么办法可以解决这个问题吗？

非常感谢，

```
public class ConfigSIP
{
    private string _sip_ip;

        // Fill the data table and assign the sip ip.
    public void ReadInConfig()
    {
        DataTable dt = new DataTable("Admin");
        dt.ReadXmlSchema(@"C:\Config.xml");
        dt.ReadXml(@"C:\Config.xml");

        _sip_ip = dt.Rows[0]["Sip_ip"].ToString();
    }

        // Return the sip ip address.
    public string sip_ip()
    {
        return _sip_ip;
    }
} 
```

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2009-04-20T14:35:07.023

您忘记调用 ReadInConfig：

```
ConfigSIP readIn = new ConfigSIP();
readIn.ReadInConfig();
string sip_ip = readIn.sip_ip(); 
```

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2009-04-20T14:35:43.857

如果您的代码被逐字复制，您的客户端代码不会调用 ReadInConfig() 方法。所以字符串永远不会被填充。

# c# - 关于c#优化器的问题

> ID：768543
> 
> 赞同：0
> 
> 时间：2009-04-20T14:34:33.423
> 
> 标签：c#, rename, optimization

如果我写：

```
SomeType simpleName = classWithLongName.otherLongName; 
```

然后使用“simpleName”而不是“classWithLongName.otherLongName”，这会以任何方式改变程序（例如性能方面）吗？

编译器对此做了什么？它是否在我使用“simpleName”的任何地方复制+粘贴“classWithLongName.otherLongName”。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-04-20T14:42:33.373

不，C# 编译器不会将对“”的调用转换为`simpleName`与复制和粘贴“ `classWithLongName.otherLongName`”相同。差异可能是深刻的或只是语义上的，但您正在做的是将值从 classWithLongName.otherLongName 分配给 simpleName。该类型是值类型还是引用类型将确切地确定如果您操作该值会发生什么以及会发生什么，但您并没有在这样做时创建函数指针或委托。

它是否会对性能产生影响真的不是这里可以回答的问题，只能说它不会产生负面影响。我们不能说它是否会产生积极影响，因为这取决于你打电话时实际发生的情况`classWithLongName.otherLongName`。如果这是一项昂贵的操作，那么这可能会使其更快，但缺点是`classWithLongName.otherLongName`如果您将其值缓存在`simpleName`.

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-04-20T14:37:33.307

这取决于“otherLongName”实际上在做什么。如果它是一个属性，那么区别在于执行该属性几次或只执行一次。这可能会或可能不会显着改变程序的行为，具体取决于它在做什么。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-04-20T14:54:08.990

这是关于实例或类的问题吗？

例如

```
namespace MyCompany.MyApp.LongNamespaceName
{
    public class MyClassWithALongName {

        public SomeType AnInstanceProperty {get;set;}

        public static SomeType AStaticProperty {get { ... }}
    }
} 
```

现在：

```
//this gets the static property
SomeType simpleName = MyClassWithALongName.AStaticProperty; 
```

或者：

```
MyClassWithALongName anInstanceWithALongName = new MyClassWithALongName();

//this gets the instance property
SomeType simpleName = anInstanceWithALongName.AnInstanceProperty; 
```

这些将以不同的方式表现。

不过这里还有另一种情况，您可以为类的实际名称创建一个别名：

```
using simpleName = MyCompany.MyApp.LongNamespaceName.MyClassWithALongName;

...
simpleName anInstance = new simpleName (); 
```

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2009-04-20T14:41:01.847

`classWithLongName.otherLongName`如果编译器知道该值在课程中不会改变，则只有在您始终键入“”时，才允许编译器缓存该值并自行重新使用它。但是，这种情况很少见。

因此，如果 " `classWithLongName.otherLongName`" 确实执行了一些计算，通常可以通过按照您的建议手动将其缓存在局部变量中来获得更好的性能。但是，请记住，您正在使用缓存值，并且原始值或属性的更改不会反映在您的缓存值上。

然而，名称的长度只是元数据，对运行时性能没有任何影响，因为名称在编译期间已经解析为内部句柄。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2009-04-20T15:11:29.823

*   如果 classWithLongName.otherLongName 是一个属性，那么对 simpleName 的更改将不会更改 classWithLongName.otherLongName。

*   如果 classWithLongName.otherLongName 是值类型的公共数据成员（字段），则对 simpleName 的更改不会更改 classWithLongName.otherLongName。

*   如果 classWithLongName.otherLongName 是引用类型的公共数据成员（字段），那么对 simpleName 的更改将更改 classWithLongName.otherLongName。

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2009-04-20T15:12:04.860

假设您的类型是对象（引用）类型，那么*simpleName最终将包含对**classWithLongName.otherLongName*返回的对象的引用。如果您随后要对该对象的属性进行大量调用，那么您可能会获得性能改进，特别是如果*otherLongName*是属性而不是字段时。

* * *

## 回答 #7

> 赞同：-1
> 
> 时间：2009-04-20T14:39:13.160

你总是可以让它成为一个函数。

```
SomeType simpleName() { return classWithLongName.otherLongName; } 
```

# mysql - ER_WARN_FIELD_RESOLVED 是什么意思？

> ID：768553
> 
> 赞同：4
> 
> 时间：2009-04-20T14:36:22.793
> 
> 标签：mysql, database

当 EXPLAIN EXTENDED 后的 SHOW WARNINGS 显示

> 注 1276 SELECT #2 的字段或引用“test.foo.bar”已在 SELECT #1 中解决

这到底是什么意思，它有什么影响？就我而言，它阻止了 MySQL 使用看起来非常好的索引。但这与修复特定查询无关（因为它是一个不相关的测试）。

我找到了[http://dev.mysql.com/doc/refman/5.0/en/error-messages-server.html](http://dev.mysql.com/doc/refman/5.0/en/error-messages-server.html)但是

```
错误：1276 SQLSTATE：HY000 (ER_WARN_FIELD_RESOLVED)
消息：SELECT #%d 的字段或引用“%s%s%s%s%s”已在 SELECT #%d 中解决
```

解释的不多吗？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2022-01-28T09:39:53.580

您可能希望使用 JSON 格式的 EXPLAIN，使用：

```
EXPLAIN FORMAT=JSON SELECT ... 
```

它让您更好地了解 MySQL 如何解释查询，JSON 结构是分层的。但结果很大程度上取决于查询和表结构。

在我的情况下，警告在 EXISTS 子查询中非常好的 WHERE 子句中。这个过度简化的查询仍然会产生警告：

```
EXPLAIN SELECT a.id
FROM a
WHERE a.id = 1
AND EXISTS(SELECT 1 FROM c WHERE c.id = a.id) 
```

我发现，EXPLAIN 有问题`c.id = a.id`，因为我已经确定了`a.id = 1`，所以根据我的古老 MySQL 5.7.9，正确的 EXISTS 将是：

```
EXISTS(SELECT 1 FROM c WHERE c.id = 1) 
```

# mysql - MySQL 架构：空列与连接

> ID：768561
> 
> 赞同：2
> 
> 时间：2009-04-20T14:37:01.793
> 
> 标签：mysql, database, database-design, architecture, normalization

我有一个应用程序，我将在其中重复事件。因此，一个事件可以按天、“每 n 天”、“按周”、“每 n 周的 Mon/Tue/Wed/etc”和“按月”、“每 n 个月的 1 日、2 日、3 日等”重复。

从表格设计的角度来看，处理这个问题的最佳方法是什么？我可以想到两种方法，但我不确定哪一种更好。

1) 5 列用于上述情况，1 列用于日情况，2 列用于周和月。无论哪个未被使用，都将为空。在我的应用程序中，我可以看到空值并选择忽略它们。

2）有第二个表，比如 events_dateinfo 或其他东西，我会加入查询。

似乎选项 2 可能更“规范化”，什么不是，但是对于这样一个简单的事情，它会让你觉得过分吗？此外，如果我选择选项 2，是否有办法将行转换为列 - 即，为特定事件选择 2 周属性并将它们视为列？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-04-20T20:23:47.047

如果我理解正确的事件可以有超过 1 个时间表（这就是你想要“将行转换为列”的原因）。

在这种情况下，您不需要 2 个而是 3 个表；第三个必须是联结表。如果您将来需要使用此方案，您可以轻松添加新的时间表。所以，像这样：

```
table events (event_id, event_name, description)
table schedules (sch_id, schedule)
table event_schedule (event_id, sch_id) 
```

据我所知，MySQL 中没有 PIVOT 可能性，但您可以在 SELECT 中使用 GROUP_CONCAT() 函数；每个事件将是一行，一个事件的所有时间表将在一列中。

```
SELECT e.event_name AS Event, GROUP_CONCAT( s.schedule SEPARATOR ', ') AS Schedule
         FROM events e 
    (LEFT) JOIN event_schedule es
    ON e.event_id = es.event_id
    JOIN schedules s
    ON s.sch_id = es. sch_id
         GROUP BY e.event_name; 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-04-20T14:40:30.210

我更愿意处理这个标准化的，一个表中的事件，以及另一个表中的事件重复。

以适当的方式处理索引，您可以通过视图处理对数据的请求，或者如果数据变大，作为带有触发器的审计表。

# c# - 如何保证点击远程网页中链接的推荐人的唯一性（“Request.UserHostAddress”无法正常工作）？

> ID：768570
> 
> 赞同：0
> 
> 时间：2009-04-20T14:38:32.337
> 
> 标签：c#, asp.net

我们可以`Request.UserHostAddress`用来捕获引荐来源IP地址（例如谁点击了链接），但您知道这样我们无法确保用户的唯一性！此 ip 在 NAT 环境中无法正常工作，因为它可能引用了数百台机器。
我正在寻找一种可行的方法来检测**真正**有多少人点击了指定的链接。
我想`UserHostAddress`帮不了我。

**那么，有没有办法从用户的操作系统或浏览器中获取一些独特的数据？**
**（考虑到该链接不在我自己的应用程序中。它在远程页面中）**

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2009-04-20T14:52:40.820

Grzenio 的回答是正确的；我将详细说明一下。确保客户向您发送独特的东西的唯一方法是您先将其发送给客户，并确保您确保它是独特的。创建 GUID 并将其设置在 cookie 中是一种方法。如果您关心欺骗，请先加密 GUID。

客户没有义务拥有独特的东西，IP 地址被明确设计为**不能**识别客户计算机。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-04-20T14:58:06.673

如果无法设置 cookie，则无法保证您能够区分用户。谷歌分析和所有其他网络分析程序使用 IP、cookie 或用户 ID 来区分用户。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2009-04-20T14:42:47.583

如果此链接来自您拥有的网页，您可以在父页面上设置唯一的 cookie。

# sql - 每年需要更改数据库架构。应该使用哪种策略？

> ID：768578
> 
> 赞同：2
> 
> 时间：2009-04-20T14:39:28.887
> 
> 标签：sql, schema, versioning, obsolete

我们公司每年都会举办一个会议/展台，参与者可以在这里展示他们的产品。

我们有一个网络应用程序，让参与者可以注册会议。他们可以输入公司名称、帐单信息等信息。

似乎参与者需要输入哪些信息的要求每年都在变化。

IE ，一年参与者可能需要输入他们想要的展位大小，明年不再需要，依此类推。一年，您可能只需要输入所需的 m^2 总数，而第二年，您可能需要添加所需的长度、高度和楼层数。

多年来，这导致数据库模式变得非常疯狂。现在，我们的数据库中有很多“过时”的字段和表，并且开始看起来很混乱。由于历史原因，我们不能只是将模式重置为每年的基础。我们可能需要一些旧会议的数据。

所以：有没有人知道我们如何处理这个问题？我能想到的唯一解决方案是

*   为每个会议版本我们的数据库，即
*   将所有“变化”信息存储为 xml

如果有人对如何处理不断发展的数据库和处理过时的数据有一些好的文献，那就太好了！

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2009-04-20T14:46:36.420

尽管我不想这么说，但这可能是实体-属性-值结构最有效的情况。

[http://en.wikipedia.org/wiki/Entity-Attribute-Value_model](http://en.wikipedia.org/wiki/Entity-Attribute-Value_model)

请注意，这不是一个可以轻易使用的模型，它存在重大问题。但这正是它旨在解决的问题。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-04-20T14:51:13.350

我会考虑对所有扩展数据使用名称-值方法。本质上，您逐年定义静态数据。这将是诸如公司信息之类的东西，例如地址的定义不会年复一年地改变。这些将被正常建模。

然后，您将定义一个表格，该表格将包含您拥有的所有问题的主文件，并将以某种方式链接以告诉您这些问题的有效年份。此表还可能指示有关问题的其他属性，这些属性可以让您在其之上动态创建 GUI。诸如用于验证数据类型等的正则表达式之类的东西。

这是一种非常幼稚的方法，即使这样做也不会是我建模的最终状态（我可能会有另一张表将一年与一个问题相关联，这也是我将公司联系起来的方法。这样我们可以一遍又一遍地重复使用问题）。

[![注意：我有一张照片要一起去，我也需要找到一个上传它的地方……我会尽快编辑](https://i.stack.imgur.com/hTXvb.png)](https://i.stack.imgur.com/hTXvb.png)

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-04-20T15:04:24.957

“我们的数据库中现在有很多‘过时的’字段和表，而且开始看起来很混乱。由于历史原因，我们不能只是将架构重置为每年的基础。我们可能需要一些来自旧会议的数据。”

如果您可能需要它们，它们并不过时。

但是，我会一般地对前端进行编码。这意味着拥有一个可以处理任何形式的展台区域配置的系统（在您给出的示例中），如果应该发生的话，将来可能会更多。

如果您有“standarea”（m^2 中的面积）、“standsize”（长度、宽度、高度等）之类的表格 - 那么您的模型中就会有对象来匹配这些（StandArea、StandSize） - 这些都可以扩展一个通用的基类 StandData。

一年一张表获取数据集，第二年另一张表获取数据。您的 DAO 将尝试从每个表中加载每个对象（通过 parent、err、stand_uid 字段），然后将“ConferenceApplication”对象中的 StandData 字段设置为它发现的任何内容。

另一种选择是将所有可能的字段放在一个表中，并允许它们为空。

# string - 在动作脚本中拆分字符串？

> ID：768579
> 
> 赞同：0
> 
> 时间：2009-04-20T14:40:02.643
> 
> 标签：string, actionscript, actionscript-2

如何在 actionscript 中完成此操作（c# 中的示例）：

```
string[] arr = { "1.a", "2.b", "3.d", "4.d", "5.d" };
int countD = 0;

for (int i = 0; i < arr.Length; i++)
{
    if (arr[i].Contains("d")) countD++;
} 
```

我需要计算字符串数组中的一个字符

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-04-20T14:49:36.163

试试这个：

```
for(var i:int = 0; i < arr.Length; i++)
{
    if(arr[i].indexOf("d") != -1)
        countD++;
} 
```

使用 indexOf 而不是包含。如果字符不在字符串中，它将返回 -1，否则字符串至少包含一个实例。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-04-20T14:48:26.417

`match`在 javascript 字符串上 使用该函数。[http://www.cev.washington.edu/lc/CLWEBCLB/jst/js_string.html](http://www.cev.washington.edu/lc/CLWEBCLB/jst/js_string.html)

对不起，工作方式相同。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-04-20T15:04:56.593

找到了：

```
var searchString:String = "Lorem ipsum dolor sit amet.";
var index:Number;

index = searchString.indexOf("L");
trace(index); // output: 0

index = searchString.indexOf("l");
trace(index); // output: 14

index = searchString.indexOf("i");
trace(index); // output: 6

index = searchString.indexOf("ipsum");
trace(index); // output: 6

index = searchString.indexOf("i", 7);
trace(index); // output: 19

index = searchString.indexOf("z");
trace(index); // output: -1 
```

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2009-04-22T18:30:12.123

这里有四种方法......（嗯，3.something）

```
var myString:String = "The quick brown fox jumped over the lazy "
           + "dog. The quick brown fox jumped over the lazy dog.";
var numOfD:int = 0;

// 1# with an array.filter
numOfD = myString.split("").filter(
            function(s:String, i:int, a:Array):Boolean {
                return s.toLowerCase() == "d"
            }
        ).length;

trace("1# counts ", numOfD); // output 1# counts 4

// 2# with regex match
numOfD = myString.match(/d/gmi).length;
trace("2# counts ", numOfD); // output 2# counts 4

// 3# with for loop
numOfD = 0;
for (var i:int = 0; i < myString.length; )
    numOfD += (myString.charAt(++i).toLocaleLowerCase() == "d");
trace("3# counts ", numOfD); // output 3# counts 4

// 4# with a new prototype function (and regex)
String['prototype'].countOf = 
    function(char:String):int { 
        return this.match(new RegExp(char, "gmi")).length;
    };
// -- compiler 'strict mode' = true
numOfD = myString['countOf']("d");
trace("4# counts ", numOfD); // output 4# counts 4
// -- compiler 'strict mode' = false
numOfD = myString.countOf("d");
trace("4# counts ", numOfD); // output 4# counts 4 
```

# excel - Excel 公式：根据日期输入显示总计

> ID：768583
> 
> 赞同：0
> 
> 时间：2009-04-20T14:40:31.317
> 
> 标签：excel, spreadsheet

我有一个电子表格，其中有两列代表已处理记录的数量和处理记录的日期。在某些情况下，可以分批处理记录，因此文档看起来像这样：

33 2009
年 4 月 1 日 22 2009年 4 月 1
日 12 2009 年 4 月 2 日
13 2009年 4 月 4 日
36 2009 年 4 月 4 日

我正在尝试添加一组包含日期的新列，并自动显示该日期的记录总数：

2009 年 4 月 1 日 55 2009 年 4 月 2
日 12
2009 年 4 月 3 日 0
2009 年 4 月 4 日 49

我知道如何在算法上执行此操作，并且我可能可以在 Excel 之外操作电子表格，但我正在尝试在实时电子表格中执行此操作，并且对如何将其关闭感到有些困惑。

有任何想法吗？

谢谢！IVR 复仇者

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-04-20T14:49:23.370

SUMIF 功能对您有用吗？SUMIF([range],[criteria],[sum_range]) 我认为您可以设置 range = 第一个列表中包含日期的单元格集，条件将是包含第二个列表中日期的单元格，而 sum_range 将是计入您的第一个列表的第一列。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2009-04-20T16:27:42.090

我建议使用数据透视表。将日期放入行区域，并将“总和”记录放入数据区域。列区域中没有任何内容。

数据透视表将比公式解决方案更具动态性，因为它只会显示存在的日期。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-04-20T15:33:55.307

假设您的日期在 B 列中并且要累积的数字在 A 中，您可以尝试这样的操作：

```
 | A  |   B      |    C                D
1 | 33 | 4/1/2009 | =MIN(B:B) | {=SUM(IF(B1:B5=C1,A1:A5,0))} |
2 | 22 | 4/1/2009 | =C1+1     | {=SUM(IF(B1:B5=C2,A1:A5,0))} |
3 | 12 | 4/2/2009 | =C2+1     | {=SUM(IF(B1:B5=C3,A1:A5,0))} |
4 | 13 | 4/4/2009 | =C3+1     | {=SUM(IF(B1:B5=C4,A1:A5,0))} |
5 | 36 | 4/4/2009 | =C4+1     | {=SUM(IF(B1:B5=C5,A1:A5,0))} | 
```

请注意 {} 表示数组公式（使用 Control-Shift-Enter 输入）对于任何重要的数据量，它的堆比 SUMIF() 快。

我倾向于为 A1:A5 和 B1:B5 部分定义动态名称，例如

```
=OFFSET(A1,0,0,COUNT(A:A),1) 
```

这样我就不必继续修正我的公式了。

还有一个手动元素：例如，为额外的日期添加新行 - 这可能是一个小 VBA 的好地方。或者，如果您可以避免显示过去 90 天的总数，那么您可以修复使用的行数。

# c++ - 为什么我的 Visual Studio Win32 项目需要安装 .NET 3.5 SP1？

> ID：768585
> 
> 赞同：5
> 
> 时间：2009-04-20T14:41:15.200
> 
> 标签：c++, visual-studio, winapi, installation

使用 Visual Studio 2008，我创建了一个 C++ [Win32](http://en.wikipedia.org/wiki/Windows_API)项目。为了发布该程序，我在同一个解决方案中创建了一个 Visual Studio 安装项目。

setup.exe 提示我的用户安装 .NET 3.5 SP1，这通常需要 15 分钟以上的安装时间，并且只允许管理员级别的帐户。如果他们不这样做，就会出现“错误框架”的错误。我对我的项目中需要 .NET 3.5 SP1 的内容感到困惑。我怀疑只是因为那是我的电脑所在的框架......有没有办法扩大它将运行的框架？

代码主要是 Win32 API 调用。以防万一，这是我的依赖项和#includes：

```
gdiplus.lib
comctl32.lib
Winmm.lib
d3d9.lib 
```

（安装项目自动添加了comdlg32.dll，然后告诉我排除它。）

```
#include <windows.h>
#include <tchar.h>
#include <stdio.h>
#include <stdlib.h>
#include <iostream>
#include <fstream>
#include <string.h>

#include <commctrl.h>
#include <process.h>
#include <sstream>
#include <math.h>
#include <d3d9.h>
#include <time.h>
#include <gdiplus.h> 
```

我的猜测是，在 windows.h 的某个地方，有一个 WIN_VER 或类似的版本设置设置为 .NET 3.5 SP1，这就是依赖项的来源。如果是这种情况，我需要定义一个不同的版本，我很想听听每个人关于做/不做/如何做的建议，以及我可以走多远才能最大限度地融入。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2009-04-20T14:44:32.960

您是否检查了安装程序项目的先决条件？（右键单击 ->*属性*；先决条件按钮）。

在我创建的测试项目中，默认选择了 .NET 框架（我假设它实际上并不分析正在安装的项目，因为它默认也不包含 C++ 运行时库。）

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2009-04-20T14:44:38.110

在 VS 2008 中，默认的目标框架是 .NET 3.5。

对于 Common Properties 页面上的 C++，有一个“Targeted Framework”下拉菜单，但在我创建的测试项目中它是灰色的，因此在项目创建后似乎无法更改。

我创建了第二个 C++ 项目并从“新项目”对话框中选择了 2.0 模板，并且在“目标框架”中有 2.0。

因此，如果您想针对较低版本的框架，看起来您必须首先正确地创建您的项目。

编辑：至于您应该针对哪个版本的框架 - 这一切都取决于（！）

您需要使用 3.0 或 3.5 的任何功能吗？如果没有，那就去2.0。如果你这样做了，那么选择那个并接受下载。我不能说任何类别的用户安装特定版本的可能性有多大。随着时间的推移，他们将越来越有可能安装 3.5，因为其他应用程序将需要它。

* * *

## 回答 #3

> 赞同：3
> 
> 时间：2010-11-30T02:36:40.677

就我而言，我解决了 UI 会让我遇到的所有问题，先决条件、通用属性……没关系，仍然想要 .NET 3.5。

于是，我在slickedit中打开vdproj文件，直接修改。改变了

```
 "ExternalPersistence"
    {
        "LaunchCondition"
        {
            "{A06ECF26-33A3-4562-8140-9B0E340D4F24}:_38ABBBBC51344AFFA38F2922DFFFE5B5"
            {
            "Name" = "8:.NET Framework"
            "Message" = "8:[VSDNETMSG]"
            "Version" = "8:3.5.30729"
            "AllowLaterVersions" = "11:FALSE"
            "InstallUrl" = "8:http://go.microsoft.com/fwlink/?LinkId=76617"
            }
        }
    } 
```

到

```
 "ExternalPersistence"
    {
    } 
```

它不再要求 .NET 3.5

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2009-04-20T14:47:19.633

好吧，对于 C# 项目，如果您在解决方案资源管理器中右键单击项目文件，然后转到属性，您可以在“应用程序”选项卡上更改目标框架。C++ 项目属性中可能有类似的东西。

# c++ - 定义中的 const value 参数而不是声明中的参数真的是 C++ 吗？

> ID：768588
> 
> 赞同：3
> 
> 时间：2009-04-20T14:41:46.353
> 
> 标签：c++, solaris, language-features

这类似于（但不同于）[这个问题](https://stackoverflow.com/questions/117293/use-of-const-for-function-parameters "与这个问题相切")。

下面是一些简单的测试代码来说明我在 Sun CC 中发现的一些奇怪之处：

```
//---------------main.cpp
#include "wtc.hpp"

int main(int, char**)
{
  testy t;
  t.lame(99);
  return 0;
}
//--------------wtc.hpp
#ifndef WTC_HPP_INCLUDED
#define WTC_HPP_INCLUDED

class testy
{
public:
  void lame(int );
};

#endif 

//---------------wtc.cpp
#include <iostream>
#include "wtc.hpp"

void testy::lame(const int a)
{
  std::cout << "I was passed " << a << "\n";
}

//---------------makefile
#CXX=CC
CXX =g++
#CXXFLAGS= -g 
CXXFLAGS= -g3 -Wall -Werror

OBJECTS=$(patsubst %.cpp,%.o,$(wildcard *.cpp))

all : $(OBJECTS)
    $(CXX) $(CXXFLAGS) -o $@ $^

.PHONY: clean
clean :
    rm *.o 
```

当它使用 g++ 编译时，它会编译、链接并执行您在运行时所期望的操作。您还可以添加 ++a; 在 testy::lame() 中，编译器会抱怨更改只读变量（应该如此）。

但是，当我使用 CC 编译时，出现以下链接器错误：

```
CC -g   -c -o main.o main.cpp
CC -g   -c -o wtc.o wtc.cpp
CC -g -o all main.o wtc.o
Undefined                       first referenced
 symbol                             in file
void testy::lame(int)               main.o
ld: fatal: Symbol referencing errors. No output written to all
make: *** [all] Error 1 
```

用 nm 和 C++filt 检查目标代码，我发现 g++ 版本创建了一个 testy::lame(int) 符号，而 CC 创建了 testy::lame(const int) ，因此出现链接器错误。

我在 Stroustrup 的书中查到了它，但找不到提到的这种技术（并不意味着它不存在！）；那么这真的是一个编译器错误，还是只是一个在 Solaris 之外的其他地方都可以使用的 hack？

* * *

## 回答 #1

> 赞同：25
> 
> 时间：2009-04-20T14:48:08.600

这看起来像是`CC`. C++ 标准说（在 13.1 可重载声明中）：

> 仅在存在或不存在 const 和/或 volatile 方面不同的参数声明是等效的。也就是说，在确定声明、定义或调用哪个函数时，将忽略每个参数类型的 const 和 volatile 类型说明符。

但是有`const`/`volatile`修饰符可以参与重载，正如标准稍后提到的那样：

> 只有参数类型说明最外层的 const 和 volatile 类型说明符以这种方式被忽略；隐藏在参数类型规范中的 const 和 volatile 类型说明符很重要，可用于区分重载函数声明。

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2009-04-20T14:47:43.953

'const int' 参数中的 'const' 应该被编译器忽略。但是，声明和定义之间的区别至少可以说是糟糕的风格。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2009-04-20T14:48:26.463

我的理解是这是允许的，因为它对调用者没有什么影响。不是 const 的函数，而是一个参数，您正在定义中进行添加。因此，您实际添加的 const 仅影响实现

看到这个[问题](https://stackoverflow.com/questions/706059/mismatch-between-constructor-definition-and-declaration)。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2009-04-20T14:43:39.080

我总是匹配`const`声明和定义。这将减少任何问题，因为签名会匹配。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2009-04-20T15:21:39.660

`const`is对`void func1(const int)`函数没有任何影响，因为 int 是按值传递的——创建了 int 的副本，并且该副本仅在函数调用期间存在。您是否更改该副本与任何事情无关。

您可能对 in很重要`void func2(const char*)`这一事实感到困惑。`const`但你必须认识到，不同于`void func3(char* const)`. 前者是指向的字符不能改变；在后者中，它是（不相关的）'const'的指针

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2012-09-22T00:19:01.370

请参阅 Alexandrescu #15 的 C++ 编码标准。这应该按照他的方式工作。const 防止函数的实现者更改输入变量。IMO 变量应在函数内保持不变。如果您需要一个变量，请声明一个。优化器将为您摆脱它。

```
int temp = a; 
```

由于这在这里不起作用，我建议我的班级在原型和实现中都使用 (const int a)。我非常喜欢使用适用于所有编译器的技术。

* * *

## 回答 #7

> 赞同：-2
> 
> 时间：2009-04-20T14:45:16.877

是的，const int 与 int 不同。

# windows-mobile - 需要一种简单的方法来显示来自 .NET Compact Framework 上的地址的地图

> ID：768602
> 
> 赞同：0
> 
> 时间：2009-04-20T14:44:02.883
> 
> 标签：windows-mobile, compact-framework, mapping

是否有任何简单且免费的方法可以显示从 .NET Compact Framework 中的地址开始的位置地图。

我可以从我的应用程序中打开 IE Mobile。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-04-29T16:01:51.067

**编辑**：我错过了您原始问题中的限定词“免费”，所以这不起作用。我很抱歉。

您可以使用 Virtual Earth API 来获取地图并用图钉装饰它。我在这里的一个小项目中使用它：http: [//www.codeproject.com/KB/mobile/WiMoWifiPosition.aspx](http://www.codeproject.com/KB/mobile/WiMoWifiPosition.aspx)

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-04-20T14:51:29.187

[Google Map API](http://code.google.com/apis/maps/)，在 IE 中打开链接以显示位置。

注意：这显然需要互联网访问。

# asp.net - 自定义服务器控件：在 ASPX 代码上以声明方式指定事件

> ID：768607
> 
> 赞同：1
> 
> 时间：2009-04-20T14:45:15.957
> 
> 标签：asp.net, custom-server-controls

我目前正在开发几个自定义 ASPX 服务器控件。当然，这些控件也会公开事件。现在一种可能性是在代码中注册一个处理程序，更具体地说是在自定义服务器控件所在的页面中......比如

```
protected void Page_Load(object sender, EventArgs e)
{
   myCustomControl.Click += new ....
} 
```

但是我如何必须在我的服务器控件代码中公开事件我可以直接在 ASPX 代码（来自属性编辑器）上声明这些事件处理程序，就像你可以在按钮的单击事件上做的一样？

非常感谢，

朱里

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2009-04-20T14:53:45.280

你就是这样做...

如果您的 ASCX 控件上有一个名为 PropertyChanged 的​​公共事件

那么它将在您的控件上以 OnPropertyChanged 的​​形式以声明方式提供

```
<ctl:MyControl ID="abc" runat="server" OnPropertyChanged="abc_PropertyChanged" /> 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-04-20T14:47:16.747

您是否尝试过将它们设为公开活动？

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-04-20T14:56:39.843

这篇 MSDN 文章很好地解释了如何做到这一点，不幸的是它比看起来应该的要复杂。

[1]： http: [//msdn.microsoft.com/en-us/library/aa719907](http://msdn.microsoft.com/en-us/library/aa719907(VS.71).aspx/) (VS.71).aspx/ 《.NET Framework 开发者指南》

# sql - SqlCeReplication 冲突 - 错误 28634

> ID：768619
> 
> 赞同：0
> 
> 时间：2009-04-20T14:47:57.290
> 
> 标签：sql, replication, windows-ce, sql-server-ce

**错误写入消息文件失败与**SQL 2000 服务器**上的发布端冲突**之间是否存在任何联系？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-05-24T09:33:36.900

来自 28634 的文档：写入设备上的消息文件失败。该错误通常来自内存不足。虽然设备上似乎有足够的可用内存，但可能没有足够的连续内存。尝试关闭其他应用程序或热启动设备。

所以这应该是固定的......我相信与冲突无关，

# javascript - 如何在 JavaScript 中处理 DOM 元素以避免内存泄漏

> ID：768621
> 
> 赞同：28
> 
> 时间：2009-04-20T14:48:08.600
> 
> 标签：javascript, jquery, dom, memory-management, memory-leaks

我有一个应用程序，允许用户在没有回发的情况下查看特定案例的详细信息。每次用户从服务器请求数据时，我都会拉下以下标记。

```
<form name="frmAJAX" method="post" action="Default.aspx?id=123456" id="frmAJAX">
<div>
<input type="hidden" name="__VIEWSTATE" id="__VIEWSTATE" />
</div>
<div>
<input type="hidden" name="__EVENTVALIDATION" id="__EVENTVALIDATION" />
</div>
<div id="inner">
<!-- valid info here --!>
</div>
</form> 
```

接下来，我将上面的内容和 innerHTML 放到一个新的 DOM 元素中，如下所示：

```
 success: function(xhtml) {
        var tr = document.createElement('tr');
        var td = document.createElement('td');
        var container = document.createElement('div');

        obj.parentNode.parentNode.parentNode.insertBefore(tr, obj.parentNode.parentNode.nextSibling);

        td.appendChild(container);
        container.innerHTML = xhtml;
        tr.appendChild(td); 
```

但在上面之后，我使用一些 jQuery 来删除讨厌的 aspnet 垃圾

```
$('form:eq(1)').children().each(
    function() {
        if ($('form:eq(1)').find('div').filter(function() { return $(this).attr('id') == ''; }).remove());
    }
);

//Capture the remaining children
var children = $('form:eq(1)').children();

// Remove the form
$('form:eq(1)').remove();

// append the correct child element back to the DOM
parentObj.append(children); 
```

我的问题是——使用[IESieve](http://home.orange.nl/jsrosman/)时，我注意到没有实际泄漏，但 DOM 元素的数量不断增加（因此内存使用量）。

我可以在客户端改进什么来真正清理这个烂摊子？注意 - IE7/8 都显示了这些结果。

**编辑**：我终于完成了这项工作，并决定写一篇带有完整源代码的简短[博客文章。](http://toranbillups.com/blog/archive/2009/04/21/Cleanup-for-dynamically-generated-DOM-elements-in-IE/)

* * *

## 回答 #1

> 赞同：13
> 
> 时间：2009-04-20T15:50:19.560

棘手的部分是找出对违规节点的引用仍然存在的位置。

你这样做很困难——你将所有的标记添加到页面，然后删除你不想要的东西。我会这样做：

```
var div = document.createElement('div');
// (Don't append it to the document.)

$(div).html(xhtml);

var stuffToKeep = $(div).find("form:eq(1)> *").filter(
  function() {
    return $(this).attr('id') !== '';
  }
);

parentObj.append(stuffToKeep);

// Then null out the original reference to the DIV to be safe.
div = null; 
```

这不能保证阻止泄漏，但这是一个好的开始。

* * *

## 回答 #2

> 赞同：7
> 
> 时间：2011-10-08T06:31:25.090

```
function discardElement(element) {
    var garbageBin = document.getElementById('IELeakGarbageBin');
    if (!garbageBin) {
        garbageBin = document.createElement('DIV');
        garbageBin.id = 'IELeakGarbageBin';
        garbageBin.style.display = 'none';
        document.body.appendChild(garbageBin);
    }
    // move the element to the garbage bin 
    garbageBin.appendChild(element);
    garbageBin.innerHTML = '';
} 
```

[来源](http://social.msdn.microsoft.com/Forums/en-US/iewebdevelopment/thread/c76967f0-dcf8-47d0-8984-8fe1282a94f5/)

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2009-04-20T15:02:47.520

`remove()`及其同类仅从 DOM 中删除元素。它们仍然存在于记忆中的某个地方。

这是 AJAX 和 Web 2.0 的一个已知问题。除了设计您的网站以确保您偶尔刷新页面以清除内容之外，您几乎无能为力。

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2011-07-21T12:42:15.737

我认为“不断增长的内存消耗”有些误解。它与浏览器内部的内存管理（以及通常在 Windows 上）有关，而不是与您的 JS 代码有关。内存管理器通常会一直分配（或避免释放），直到他们不得不这样做。在基于页面文件和内存映射的系统上，分配和释放内存非常耗时。

因此，即使您的节点是从实际的文档结构和 DOM 中释放出来的，也几乎没有任何方法可以从 Windows 本身“实时”测量它。

试试这个：

1.  启动任务管理器，切换到进程选项卡并查看浏览器的内存

2.  加载分配 100.000 个节点的 HTML 文档，观察内存消耗增长

3.  单击页面中的按钮，释放所有节点。请注意，在内存释放方面几乎没有发生任何事情。

4.  现在最小化浏览器窗口，然后再次最大化它。在 90% 的情况下，如果不使用，浏览器现在会转储内存，您将看到它实际消耗了多少。

您可以让浏览器消耗 500 兆字节的内存（不是上面提到的示例），但是当您最小化和最大化它时，它会释放所有内容，突然间它只使用 50 兆字节。

# svn - 如何编辑和提交来自 Subversion 存储库的单个文件？

> ID：768631
> 
> 赞同：5
> 
> 时间：2009-04-20T14:51:26.970
> 
> 标签：svn, tortoisesvn

使用 TortoiseSVN（命令行解决方案也可以），无需在存储库端创建文件夹，签出单个文件、编辑和签入注释的步骤是什么？

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2009-04-20T14:56:58.860

AFAIK 您无法从 SVN 获取单个文件的副本，工作副本始终是一个目录。因此，您需要检查整个文件夹才能编辑有问题的文件，然后提交。

前一段时间（不到 3 个月）就是这种情况，我怀疑从那时起它已经改变了。

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2009-04-20T14:54:27.320

1.  在需要工作副本的 Windows 资源管理器中右键单击。
2.  选择*签出*。它可能在 TortoiseSVN 的菜单中。
3.  输入 URL 并接受以获取工作副本。
4.  对文件进行更改。
5.  右键单击工作副本。选择提交。

**或者**

请参阅 Stack Overflow 问题*[Checkout one file from Subversion](https://stackoverflow.com/questions/122107)*。

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2009-04-20T15:01:41.627

要签出单个文件，您仍然需要签出其父目录。从命令行，签出`https://svn.example.com/trunk/myfolder/index.html`：

```
svn co https://svn.example.com/trunk/myfolder/ --depth empty
svn up myfolder/index.html 
```

现在，您可以像往常一样编辑和提交此文件，而无需检查其他任何内容。

TortoiseSVN 在其 svn checkout 菜单选项中还包括“结帐深度”；但是，我不知道如何让 Tortoise`svn up filename`处理不存在的文件。

* * *

## 回答 #4

> 赞同：2
> 
> 时间：2010-07-27T23:01:52.670

TortoiseSVN 可以做到这一点，但您还必须签出父目录：

1.  创建没有内容的目录的工作副本（使用结帐深度“仅此项目”）
2.  单击新的工作副本并右键单击以选择存储库浏览器（*TortoiseSVN* -> *Repo-browser*）
3.  右键单击存储库浏览器中选择的文件，然后选择“将项目更新到修订版”

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2017-08-10T09:24:46.763

您有一个要提交的文件**single.txt 。**

正确的程序是：

```
cd /path/destination_directory
svn up
svn commit single.txt -m "Insert here a commit message" 
```

希望这会有所帮助。

# python - 解析 .py 文件，读取 AST，修改它，然后写回修改后的源代码

> ID：768634
> 
> 赞同：191
> 
> 时间：2009-04-20T14:51:55.720
> 
> 标签：python, compiler-construction, abstract-syntax-tree

我想以编程方式编辑 python 源代码。基本上我想读取一个`.py`文件，生成[AST](http://en.wikipedia.org/wiki/Abstract_syntax_tree)，然后写回修改后的 python 源代码（即另一个`.py`文件）。

有一些方法可以使用标准的 Python 模块来解析/编译 Python 源代码，例如[`ast`](http://docs.python.org/library/ast.html)或[`compiler`](http://docs.python.org/library/compiler.html). 但是，我认为它们中的任何一个都不支持修改源代码的方式（例如删除此函数声明），然后将修改后的 python 源代码写回。

更新：我想这样做的原因是我想为 python 编写一个[突变测试库](http://en.wikipedia.org/wiki/Mutation_testing)，主要是通过删除语句/表达式，重新运行测试并查看什么中断。

* * *

## 回答 #1

> 赞同：80
> 
> 时间：2009-04-20T17:04:21.707

[Pythoscope](https://github.com/mkwiatkowski/pythoscope)对它自动生成的测试用例执行此操作，就像用于 python 2.6 的[2to3](http://docs.python.org/library/2to3.html)工具一样（它将 python 2.x 源代码转换为 python 3.x 源代码）。

这两个工具都使用[lib2to3](http://svn.python.org/projects/python/trunk/Lib/lib2to3/)库，它是 python 解析器/编译器机制的实现，当它从源代码 -> AST -> 源代码往返时，它可以保留源代码中的注释。

如果您想进行更多重构（如转换），rope 项目可能会满足您的需求[。](https://github.com/python-rope/rope)

[ast](http://docs.python.org/library/ast.html)模块是您的另一个选择，并且有[一个较旧的示例说明如何将语法树“解析”回代码](https://svn.python.org/projects/python/trunk/Demo/parser/unparse.py)（使用解析器模块）。但是该`ast`模块在对代码进行 AST 转换然后转换为代码对象时更有用。

redbaron项目也可能很合适（ht Xavier Combelle [）](https://redbaron.readthedocs.org/en/latest/)

* * *

## 回答 #2

> 赞同：60
> 
> 时间：2009-04-20T17:05:41.967

内置 ast 模块似乎没有转换回源的方法。但是，这里的[codegen](https://pypi.python.org/pypi/codegen/1.0)模块为 ast 提供了一个漂亮的打印机，可以让你这样做。例如。

```
import ast
import codegen

expr="""
def foo():
   print("hello world")
"""
p=ast.parse(expr)

p.body[0].body = [ ast.parse("return 42").body[0] ] # Replace function body with "return 42"

print(codegen.to_source(p)) 
```

这将打印：

```
def foo():
    return 42 
```

请注意，您可能会丢失确切的格式和注释，因为它们不会被保留。

但是，您可能不需要。如果您只需要执行替换的 AST，您只需在 ast 上调用 compile() 并执行生成的代码对象即可。

* * *

## 回答 #3

> 赞同：20
> 
> 时间：2016-09-09T13:52:09.240

在另一个答案中，我建议使用该`astor`包，但后来我发现了一个更新的 AST 非解析包，名为[`astunparse`](https://github.com/simonpercivall/astunparse)：

```
>>> import ast
>>> import astunparse
>>> print(astunparse.unparse(ast.parse('def foo(x): return 2 * x')))

def foo(x):
    return (2 * x) 
```

我已经在 Python 3.5 上对此进行了测试。

* * *

## 回答 #4

> 赞同：20
> 
> 时间：2020-08-02T04:00:50.213

花了一段时间，但 Python 3.9 有这个： [https://docs.python.org/3.9/whatsnew/3.9.html#ast](https://docs.python.org/3.9/whatsnew/3.9.html#ast) [https://docs.python.org/3.9/library/ast.html#ast.unparse](https://docs.python.org/3.9/library/ast.html#ast.unparse)

```
ast.unparse(ast_obj) 
```

> 反解析一个 ast.AST 对象并生成一个字符串，其代码如果用 ast.parse() 解析回来，将产生一个等效的 ast.AST 对象。

* * *

## 回答 #5

> 赞同：19
> 
> 时间：2009-04-20T16:44:53.280

您可能不需要重新生成源代码。当然，这对我来说有点危险，因为您实际上并没有解释为什么您认为需要生成一个充满代码的 .py 文件；但：

*   如果您想生成人们将实际使用的 .py 文件，也许这样他们就可以填写表格并获得有用的 .py 文件以插入到他们的项目中，那么您不想将其更改为 AST 并且回来，因为你会失去~~所有的格式（想想那些通过将相关的行组合在一起使 Python 如此可读的空行）~~（[ast 节点有`lineno`和`col_offset`属性](http://docs.python.org/py3k/library/ast.html#ast.AST.lineno)）注释。相反，您可能希望使用模板引擎（例如[Django 模板语言](http://docs.djangoproject.com/en/dev/topics/templates/#topics-templates)，旨在使模板甚至文本文件变得容易）来自定义 .py 文件，或者使用 Rick Copeland 的[MetaPython](http://code.google.com/p/metapython/)扩展。

*   如果您在编译模块期间尝试进行更改，请注意您不必一直回到文本；您可以直接编译 AST，而不是将其转回 .py 文件。

*   但在几乎所有情况下，您可能都在尝试做一些动态的事情，像 Python 这样的语言实际上非常容易，而无需编写新的 .py 文件！如果您扩展您的问题以让我们知道您实际想要完成什么，新的 .py 文件可能根本不会参与答案；我已经看到数百个 Python 项目在做数百个现实世界的事情，而且没有一个项目需要编写 .py 文件。所以，我必须承认，我有点怀疑你是否找到了第一个好的用例。:-)

**更新：**既然您已经解释了您要做什么，我还是很想对 AST 进行操作。您将希望通过删除而不是文件的行来进行变异（这可能导致半语句简单地因 SyntaxError 而死），而是整个语句——还有什么比在 AST 中更好的地方来做到这一点？

* * *

## 回答 #6

> 赞同：12
> 
> 时间：2017-01-23T08:14:03.070

在模块的帮助下，解析和修改代码结构当然是可能的，`ast`稍后我将在一个示例中展示它。`ast`但是，仅使用模块是不可能写回修改后的源代码的。还有其他模块可用于此工作，例如[此处](http://svn.python.org/view/python/trunk/Demo/parser/unparse.py?view=markup)的一个。

注意：下面的示例可以被视为关于模块使用的介绍性教程，`ast`但更全面的模块使用指南`ast`可在[Green Tree snakes 教程](https://greentreesnakes.readthedocs.io/en/latest/tofrom.html)和[模块的](https://docs.python.org/2/library/ast.html)[官方文档中`ast`](https://docs.python.org/2/library/ast.html)找到。

**简介`ast`：**

```
>>> import ast
>>> tree = ast.parse("print 'Hello Python!!'")
>>> exec(compile(tree, filename="<ast>", mode="exec"))
Hello Python!! 
```

您可以通过简单地调用 API 来解析 python 代码（以字符串表示）`ast.parse()`。这将返回抽象语法树 (AST) 结构的句柄。有趣的是，您可以编译回这个结构并如上所示执行它。

另一个非常有用的 API 是以`ast.dump()`字符串形式转储整个 AST。它可以用来检查树形结构，对调试很有帮助。例如，

*在 Python 2.7 上：*

```
>>> import ast
>>> tree = ast.parse("print 'Hello Python!!'")
>>> ast.dump(tree)
"Module(body=[Print(dest=None, values=[Str(s='Hello Python!!')], nl=True)])" 
```

*在 Python 3.5 上：*

```
>>> import ast
>>> tree = ast.parse("print ('Hello Python!!')")
>>> ast.dump(tree)
"Module(body=[Expr(value=Call(func=Name(id='print', ctx=Load()), args=[Str(s='Hello Python!!')], keywords=[]))])" 
```

请注意 Python 2.7 与 Python 3.5 中 print 语句的语法差异以及各自树中 AST 节点类型的差异。

* * *

**如何修改代码使用`ast`：**

现在，让我们看一个按`ast`模块修改python代码的例子。修改AST结构的主要工具是`ast.NodeTransformer`类。每当需要修改 AST 时，他/她需要从中继承子类并相应地编写节点转换。

对于我们的示例，让我们尝试编写一个简单的实用程序，将 Python 2 、 print 语句转换为 Python 3 函数调用。

**打印语句到 Fun 调用转换器实用程序：print2to3.py：**

```
#!/usr/bin/env python
'''
This utility converts the python (2.7) statements to Python 3 alike function calls before running the code.

USAGE:
     python print2to3.py <filename>
'''
import ast
import sys

class P2to3(ast.NodeTransformer):
    def visit_Print(self, node):
        new_node = ast.Expr(value=ast.Call(func=ast.Name(id='print', ctx=ast.Load()),
            args=node.values,
            keywords=[], starargs=None, kwargs=None))
        ast.copy_location(new_node, node)
        return new_node

def main(filename=None):
    if not filename:
        return

    with open(filename, 'r') as fp:
        data = fp.readlines()
    data = ''.join(data)
    tree = ast.parse(data)

    print "Converting python 2 print statements to Python 3 function calls"
    print "-" * 35
    P2to3().visit(tree)
    ast.fix_missing_locations(tree)
    # print ast.dump(tree)

    exec(compile(tree, filename="p23", mode="exec"))

if __name__ == '__main__':
    if len(sys.argv) <=1:
        print ("\nUSAGE:\n\t print2to3.py <filename>")
        sys.exit(1)
    else:
        main(sys.argv[1]) 
```

可以在小示例文件上试用此实用程序，例如下面的一个，它应该可以正常工作。

**测试输入文件：py2.py**

```
class A(object):
    def __init__(self):
        pass

def good():
    print "I am good"

main = good

if __name__ == '__main__':
    print "I am in main"
    main() 
```

请注意，上述转换仅用于`ast`教程目的，在实际情况下，您必须查看所有不同的场景，例如`print " x is %s" % ("Hello Python")`.

* * *

## 回答 #7

> 赞同：6
> 
> 时间：2013-09-21T21:22:17.983

我最近创建了相当稳定（核心经过很好的测试）和可扩展的代码，它从`ast`树生成代码：[https](https://github.com/paluh/code-formatter) ://github.com/paluh/code-formatter 。

我将我的项目用作小型 vim 插件（我每天都在使用）的基础，所以我的目标是生成非常漂亮且可读的 python 代码。

PS 我尝试过扩展`codegen`，但它的架构是基于`ast.NodeVisitor`接口的，所以格式化程序（`visitor_`方法）只是函数。我发现这种结构非常有限且难以优化（在长且嵌套的表达式的情况下，保留对象树并缓存一些部分结果更容易 - 以其他方式，如果您想搜索最佳布局，您可以达到指数复杂性）。**但是** `codegen`，mitsuhiko 的每一部作品（我读过）都写得非常好，简洁。

* * *

## 回答 #8

> 赞同：6
> 
> 时间：2019-09-12T15:45:26.237

如果你在 2019 年看到这个，那么你可以使用这个[libcs​​t](https://libcst.readthedocs.io/en/latest/index.html) 包。它的语法类似于 ast。这就像一个魅力，并保留了代码结构。对于必须保留注释、空格、换行符等的项目，它基本上很有帮助。

如果您不需要关心保留注释、空格和其他内容，那么 ast 和[astor](https://astor.readthedocs.io/en/latest/)的组合效果很好。

* * *

## 回答 #9

> 赞同：5
> 
> 时间：2016-08-17T15:50:17.897

建议[的其他答案之一](https://stackoverflow.com/a/769202)`codegen`似乎已被[`astor`](https://github.com/berkerpeksag/astor). [`astor`PyPI 上](https://pypi.python.org/pypi/astor)的版本（撰写本文时为 0.5 版）似乎也有点过时，因此您可以`astor`按如下方式安装开发版本。

```
pip install git+https://github.com/berkerpeksag/astor.git#egg=astor 
```

然后您可以使用`astor.to_source`将 Python AST 转换为人类可读的 Python 源代码：

```
>>> import ast
>>> import astor
>>> print(astor.to_source(ast.parse('def foo(x): return 2 * x')))
def foo(x):
    return 2 * x 
```

我已经在 Python 3.5 上对此进行了测试。

* * *

## 回答 #10

> 赞同：2
> 
> 时间：2016-12-14T02:39:21.973

我们有类似的需求，这里的其他答案没有解决。因此我们为此创建了一个库[ASTTokens](https://github.com/gristlabs/asttokens)，它采用由[ast](https://docs.python.org/2/library/ast.html)或[astroid](https://www.astroid.org/)模块生成的 AST 树，并用原始源代码中的文本范围对其进行标记。

它不会直接修改代码，但这并不难在上面添加，因为它确实告诉您需要修改的文本范围。

例如，这将函数调用包装在 中`WRAP(...)`，保留注释和其他所有内容：

```
example = """
def foo(): # Test
  '''My func'''
  log("hello world")  # Print
"""

import ast, asttokens
atok = asttokens.ASTTokens(example, parse=True)

call = next(n for n in ast.walk(atok.tree) if isinstance(n, ast.Call))
start, end = atok.get_text_range(call)
print(atok.text[:start] + ('WRAP(%s)' % atok.text[start:end])  + atok.text[end:]) 
```

产生：

```
def foo(): # Test
  '''My func'''
  WRAP(log("hello world"))  # Print 
```

希望这可以帮助！

* * *

## 回答 #11

> 赞同：2
> 
> 时间：2021-07-30T18:55:48.633

不幸的是，上面的答案都没有真正满足这两个条件

*   保持周围源代码的句法完整性（例如，保留注释，其余代码的其他类型的格式）
*   实际使用 AST（不是 CST）。

我最近编写了一个小工具包来进行纯 AST 的重构，称为[refactor](https://github.com/isidentical/refactor)。例如，如果您想将所有`placeholder`s替换为`42`，您可以简单地编写这样的规则；

```
class Replace(Rule):

    def match(self, node):
        assert isinstance(node, ast.Name)
        assert node.id == 'placeholder'

        replacement = ast.Constant(42)
        return ReplacementAction(node, replacement) 
```

它将找到所有可接受的节点，用新节点替换它们并生成最终形式；

```
--- test_file.py
+++ test_file.py

@@ -1,11 +1,11 @@

 def main():
-    print(placeholder * 3 + 2)
-    print(2 +               placeholder      + 3)
+    print(42 * 3 + 2)
+    print(2 +               42      + 3)
     # some commments
-    placeholder # maybe other comments
+    42 # maybe other comments
     if something:
         other_thing
-    print(placeholder)
+    print(42)

 if __name__ == "__main__":
     main() 
```

* * *

## 回答 #12

> 赞同：1
> 
> 时间：2010-03-09T04:51:50.723

[程序转换系统](http://en.wikipedia.org/wiki/Program_transformation)是一种工具，它解析源文本、构建 AST，允许您使用源到源的转换来修改它们（“如果你看到这种模式，用那个模式替换它”）。此类工具非常适合对现有源代码进行突变，即“如果您看到此模式，请用模式变体替换”。

当然，您需要一个程序转换引擎，它可以解析您感兴趣的语言，并且仍然进行模式导向的转换。我们的[DMS Software Reengineering Toolkit](http://www.semanticdesigns.com/Products/DMS/DMSToolkit.html)是一个可以做到这一点的系统，它可以处理 Python 和各种其他语言。

有关 Python准确[捕获评论的 DMS 解析 AST 示例，](https://stackoverflow.com/a/22118379/120163)请参阅此SO 答案。DMS 可以更改 AST，并重新生成有效文本，包括注释。您可以要求它使用自己的格式约定（您可以更改这些约定）来漂亮地打印 AST，或者执行“保真打印”，它使用原始行和列信息来最大程度地保留原始布局（新代码的布局中的一些更改插入是不可避免的）。

要使用 DMS 为 Python 实现“突变”规则，您可以编写以下代码：

```
rule mutate_addition(s:sum, p:product):sum->sum =
  " \s + \p " -> " \s - \p"
 if mutate_this_place(s); 
```

此规则以语法正确的方式将“+”替换为“-”；它在 AST 上运行，因此不会触及碰巧看起来正确的字符串或注释。“mutate_this_place”的额外条件是让您控制这种情况发生的频率；你不想改变程序中的*每个*地方。

您显然需要更多这样的规则来检测各种代码结构，并用变异版本替换它们。DMS 很乐意应用一组规则。然后对变异的 AST 进行漂亮打印。

* * *

## 回答 #13

> 赞同：1
> 
> 时间：2018-08-11T05:22:58.897

我曾经为此使用 baron，但现在已切换到 parso，因为它与现代 python 是最新的。它工作得很好。

我还需要这个用于突变测试仪。[用 parso 制作一个真的很简单，在https://github.com/boxed/mutmut](https://github.com/boxed/mutmut)查看我的代码

# c# - .NET Compact Framework 中带有 POST 参数的异步 WebRequest

> ID：768641
> 
> 赞同：9
> 
> 时间：2009-04-20T14:54:28.897
> 
> 标签：c#, .net, compact-framework

我正在尝试在 .NET Compact Framework 上执行异步 HTTP(S) POST，但似乎无法正常工作。

这就是我正在做的事情：

```
private void sendRequest(string url, string method, string postdata) {
    WebRequest rqst = HttpWebRequest.Create(url);
    CredentialCache creds = new CredentialCache();
    creds.Add(new Uri(url), "Basic", new NetworkCredential(this.Uname, this.Pwd));
    rqst.Credentials = creds;
    rqst.Method = method;
    if (!String.IsNullOrEmpty(postdata)) {
        rqst.ContentType = "application/xml";
        byte[] byteData = UTF8Encoding.UTF8.GetBytes(postdata);
        rqst.ContentLength = byteData.Length;
        using (Stream postStream = rqst.GetRequestStream()) {
            postStream.Write(byteData, 0, byteData.Length);
            postStream.Close();
        }
    }
    ((HttpWebRequest)rqst).KeepAlive = false;
    rqst.BeginGetResponse(DataLoadedCB, rqst);
}

private void DataLoadedCB(IAsyncResult result) {
    WebRequest rqst = ((WebRequest)(((BCRqst)result.AsyncState).rqst));
    WebResponse rsps = rqst.EndGetResponse(result);

    /* ETC...*/
} 
```

...但由于某种原因，我在 DataLoadedCB 的第二行得到了一个 WebException：

“此请求需要缓冲数据以使身份验证或重定向成功。”

当我执行简单的 HTTP GET 时，完全相同的代码可以完美运行，但是当我输入一些 POST 参数时，一切都失败了。

有任何想法吗？

* * *

## 回答 #1

> 赞同：12
> 
> 时间：2009-04-21T07:59:09.213

我一直很开心！我找到了我的问题的答案！！！

这条小线起到了作用：

```
((HttpWebRequest)rqst).AllowWriteStreamBuffering = true; 
```

# asp.net - 处置和完成属性集合？

> ID：768642
> 
> 赞同：0
> 
> 时间：2009-04-20T14:54:32.797
> 
> 标签：asp.net, vb.net, finalizer

我正在查看我刚刚继承的一些 vb.net 代码，但无法理解为什么原始开发人员会这样做。

基本上，每个“域”类都是属性的集合。并且每一个都实现了 IDisposable.Dispose，并覆盖了 Finalize()。没有基类，所以每个都只是扩展对象。

Dispose 将每个私有 var 设置为 Nothing，或在属性是另一个域对象时调用 _private.Dispose。有一个私有 var 可以跟踪处置状态，而 Dispose 中的最后一件事是 GC.suppressFinalize(Me)

Finalize 只调用 Me.Dispose 和 MyBase.Finalize。

这有什么好处吗？有什么害处吗？没有非托管资源，没有数据库连接，似乎不需要这个。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2009-04-20T15:03:01.933

这让我觉得是 VB6 模式。

我敢打赌，这家伙是直接来自 VB6，也许是在 .NET 的早期，当时这些模式还没有被广泛理解。

还有一种情况是在调用 Dispose 时将内部引用设置为无用：当成员被标​​记为 Withevents 时。没有它，当它真的不应该再这样做时，您可能会遇到未收集的对象处理事件。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-04-20T15:00:20.333

在我看来，这是根本不需要的东西，尤其是在没有非托管资源和数据连接的情况下。

如果您碰巧能够清理并发布代码，我们可能会获得更多的洞察力，但实际上我看不出需要它。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-04-20T15:04:12.650

根据对象的大小以及创建/销毁它们的频率，可以确保 GC 可以尽早发生。

可能是这种模式在其他项目中使用过，并且在不理解为什么首先使用它的情况下继续使用。[猴子园丁](http://www.qualitydigest.com/inside/standards-column/fable-monkey-gardeners)

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2009-04-20T15:07:18.960

我能看到的唯一原因——这充其量是可疑的——是如果这些东西在“食物链”中被创造和处理得更高，并且这些领域类别中的一些有可能具有在某些时候是有限的或非托管的资源。

即使那是粗略的......听起来有人来自非托管背景并且正在寻找相当于管理您的内存的.NET并且遇到了`IDisposable`界面。

# c# - 如何确保控件在滚动控件中时可见？

> ID：768645
> 
> 赞同：1
> 
> 时间：2009-04-20T14:54:57.507
> 
> 标签：c#, windows-mobile, compact-framework

我有一个带有几个标签页的标签控件。我还挂钩了 InputPanel.EnabledChanged 事件，以便在启用输入面板时 tabcontrol 调整大小。我想做的是确保在调整标签页大小时具有焦点的控件可见。实现这一目标的最佳方法是什么。请注意，我使用的是 .NET Compact Framework。

谢谢，B先生

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-05-14T19:46:54.397

您需要/可能需要在此处跟踪几件事：

• 当前滚动位置
• 当他们点击时被点击元素的位置（我假设是一个文本框）

请注意，InputPanel 的 EnabledChanged 事件非常容易处理（我假设你已经完成了）：检查 InputPanel 的 Enabled 状态并对 tabcontrol 的 Height 执行 += 或 -= ，这样 InputPanel 就不会覆盖任何内容。

我的理解是，您的问题实际上是确定文本框的位置，因为您最坏的情况是当 tabcontrol 调整大小时它将被移出屏幕。

我相信（不是 100% 确定）调整 tabcontrol 的大小将使 tabcontrol 内容的顶部保持可见，并且您必须向下滚动才能看到 InputPanel 现在“覆盖”的任何内容。

您想要在 EnabledChanged 事件中做的是找出被点击的控件的位置（或被点击的屏幕坐标 - 对您来说最容易的）。如果它属于 (ClientSize.Height-InputPanel.Bounds.Height,ClientSize.Height) 的危险区域，则需要调整滚动。

这是半 C# 半伪代码，但您应该能够看到我要使用它的位置：

int yOffset = 轻按控件的顶部 y 坐标；
if ( yOffset > ClientSize.Height-inputPanel.Bounds.

   点scrollPosition = AutoScrollPosition;
   scrollPosition.Y = scrollPosition.Y - yShift;
   AutoScrollPosition = 滚动位置；
简而言之，它的作用是检查您的 InputPanel 是否会覆盖所需的控件，如果是，则向上滚动yShift

像素，其中 yShift 可能是 inputPanel 的整个高度，或者仅足以勉强显示您的控制（无论您想要什么）。
• .NET CF 似乎对设置无效滚动规则非常宽容。如果您只能向上滚动 10 个像素并且告诉它向上滚动 100，它将在 10 处停止。
• 屏幕坐标 (0,0) 是可见屏幕的左上角 - 不是正在显示的表单。如果您假设 (0,0) 是表单的顶部，您可能会被绊倒。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-04-21T13:49:35.800

我想到的唯一方法是通过屏幕上的当前控件位置来计算。

# user-controls - 如何使 MasterPage 中的 UserControl 对所有子页面都公开

> ID：768655
> 
> 赞同：1
> 
> 时间：2009-04-20T14:58:26.360
> 
> 标签：user-controls, master-pages

我有一个已添加到 web.config 的 UserControl

```
<add tagPrefix="BCF" src="~/controls/MyMessageBox.ascx" tagName="error"/> 
```

并添加到我的母版页

```
<BCF:error ID="BCError" runat="server" Visible="false" /> 
```

现在我需要能够从使用该母版页的所有子页面中引用此控件及其公共属性。我这样做是我的 BasePage OnLoad 事件

```
public UserControl BCError;
BCError = (UserControl)Master.FindControl("BCError"); 
```

问题是，虽然我可以在 .aspx 页面中做到这一点

```
BCError.Visible = true; 
```

我不能引用我放入的任何控件属性？比如 ShowError .. 如果我这样做

```
BCError.ShowError = "Error Message"; 
```

我只是得到一个错误说

**“System.Web.UI.UserControl”不包含“ShowInfo”的定义，也没有扩展方法“ShowInfo”**

你能指出我正确的方向吗！

这是用户控件的代码...我可以在后面的母版页代码中使用属性（如果我将控件直接放入其中，则可以在页面中使用）但不能在后面的子页面代码中使用它们？它甚至没有显示智能感知中的属性或包装方法？

```
 using System;
using System.Collections;
using System.Configuration;
using System.Data;
using System.Linq;
using System.Web;
using System.Web.Security;
using System.Web.UI;
using System.Web.UI.HtmlControls;
using System.Web.UI.WebControls;
using System.Web.UI.WebControls.WebParts;
using System.Xml.Linq;

public partial class MyMessageBox : System.Web.UI.UserControl
{
    #region Properties
    public bool ShowCloseButton { get; set; }

    #endregion

    #region Load
    protected void Page_Load(object sender, EventArgs e)
    {
        if (ShowCloseButton)
            CloseButton.Attributes.Add("onclick", "document.getElementById('" + MessageBox.ClientID + "').style.display = 'none'");
    }
    #endregion

    #region Wrapper methods
    public void ShowError(string message)
    {
        Show(MessageType.Error, message);
    }

    public void ShowInfo(string message)
    {
        Show(MessageType.Info, message);
    }

    public void ShowSuccess(string message)
    {
        Show(MessageType.Success, message);
    }

    public void ShowWarning(string message)
    {
        Show(MessageType.Warning, message);
    } 
    #endregion

    #region Show control
    public void Show(MessageType messageType, string message)
    {
        CloseButton.Visible = ShowCloseButton;
        litMessage.Text = message;

        MessageBox.CssClass = messageType.ToString().ToLower();
        this.Visible = true;
    } 
    #endregion

    #region Enum
    public enum MessageType
    {
        Error = 1,
        Info = 2,
        Success = 3,
        Warning = 4
    } 
    #endregion
} 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2009-04-20T15:07:06.573

好的，我想我大致复制了你的描述，我删除了我原来的答案，因为它已经偏离了。

我发现，当您希望内容页面引用母版页中正在使用的用户控件并且该控件是可访问的而不能访问时，您将收到一个错误，指示您需要引用特定的程序集，然后您会得到错误表明不存在这种类型的方法。

通过将子页面上的注册页面指令添加到用户控件解决了这个问题。即使使用 web.config 或页面上定义的控件，我也重现了这一点。在这两种情况下，我仍然必须在内容页面上明确添加注册。

这对我来说没有意义，但它允许我的代码编译和工作。试一试让我知道。

完成此操作后，您可以引用控件，例如

```
this.Master.MessageBox.ShowInfo(); 
```

这假定您在母版页上有一个名为 MessageBox 的公共属性。

# 编辑

我还发现，如果您在主页面和内容页面上都注册控件而不使用 web.config，这会更好。

# 编辑

如果您不希望您的子页面引用用户控件，则您的另一个选项是在母版页上公开方法，例如 ShowInfo()，它将委托给用户控件。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-04-20T17:17:08.163

您需要将其声明为您的控件类型才能访问它的属性。

```
public MyMessageBox BCError;
BCError = (MyMessageBox )Master.FindControl("BCError"); 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2010-04-20T17:53:43.900

尝试在从母版页继承的页面中使用它：

```
<%@ MasterType VirtualPath="~/MasterPageName.Master" %> 
```

# html - 小工具/小部件管理器

> ID：768659
> 
> 赞同：3
> 
> 时间：2009-04-20T14:59:21.943
> 
> 标签：html, asp.net-mvc

有谁知道我可以在 ASP.NET MVC 网站上使用的任何预装的小工具/小部件管理框架（沿着 iGoogle 等）（大概是通过 jQuery 等加载 div）？

特别是，如果已经有一些不错的东西可用，我宁愿不写所有的选择/位置代码。（我希望自己编写实际的小部件/内容等......）

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2009-04-20T21:07:59.157

我一直在等着看你是否得到了这个问题的答案，因为这也是我感兴趣的事情。你还没有，我会告诉你我知道的（它可能没那么有用，但它可能会让你开始......）

我在以前的项目中使用了基于[ExtJS 门户演示](http://extjs.com/deploy/dev/examples/portal/portal.html)的东西——尽管根据部署场景会涉及一些许可成本，此外，它变得非常缓慢和繁琐，而且定制起来相当棘手——默认设置因为 ext 工具集是让 ui 完全由 javascript 构建，而不是由标记构建，虽然可以强制它在现有标记之上工作，但它似乎比它需要的更困难。除此之外，它最终运行良好，并且付费版本的支持非常好。

我还实现了一个基于[jquery-ui sortable](http://jqueryui.com/demos/sortable/)的小部件/门户屏幕，效果非常好 - 基本实现非常快速和简单，但是编写代码来保存和加载门户设置花费的时间比我想要的要多。

如果我现在正在做一个类似的项目，我想我会[改为评估它](http://www.trilancer.com/jpolite/#t1)——粗略一看，它看起来还不错，而且它是开源的——它是用 jquery-ui 可排序的，所以核心应该足够坚固，而且稍微不均匀假设它使用标准的 jquery-ui 可排序选项，演示版上的动画应该很容易分类。从外观上看，它也具有加载/保存门户设置的功能，因此这应该意味着更少的手工编码。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-04-20T22:21:16.420

我过去使用过 Telerik RadDock，发现它非常好。它呈现在 div 中，并且相对容易设置样式。

如果您在商业上使用它，它不会花费太多。

[http://demos.telerik.com/aspnet-ajax/dock/examples/overview/defaultcs.aspx](http://demos.telerik.com/aspnet-ajax/dock/examples/overview/defaultcs.aspx)

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2009-08-05T14:23:18.653

[http://net.tutsplus.com/tutorials/javascript-ajax/inettuts/](http://net.tutsplus.com/tutorials/javascript-ajax/inettuts/)

这家伙整理了一个很棒的教程，介绍了如何实现 iGoogle 之类的拖放小部件界面。甚至链接到一个工作示例。

# asp.net - 如果我用匿名对象填充 GridView，如何获取它们的属性？

> ID：768660
> 
> 赞同：1
> 
> 时间：2009-04-20T14:59:29.277
> 
> 标签：asp.net, linq, gridview

我有一个通过 LINQ 表达式填充的 GridView。
像这样的东西：

```
GridView1.DataSource = from c in customers, o in c.Orders, 
  total = o.Total where total >= 2000 select new {id = c.CustomerID, 
  order = o.OrderID, total = total}; 
```

在其*RowCreated*方法中，我尝试获取一个属性，例如 id，但它没有已知类型：

```
object element = e.Row.DataItem;
int id = element.id; // It's bad!!!!!! 
```

我能怎么做？
谢谢！！

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2009-04-20T15:03:44.040

命名你的类型！

```
public class GridType
{
    public int Id {get; set:} . . etc
} 
```

然后在linq中，

```
. . . select new GridType {...etc} 
```

然后在 RowCreated 方法中，将数据项转换为 GridType，您就可以访问它的属性。

否则，您正在寻找 C# 不做的鸭子类型。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2009-04-20T15:03:32.683

你需要使用反射。

```
Type t = element.GetType();
int id = 0;

foreach (PropertyInfo p in t.GetProperties())
{
    // Not very nice but finds an integer property called "id"
    if (p.PropertyType == typeof(int) && p.Name == "id")
    {
       id = (int)p.GetValue(element, null);
    }
} 
```

使用 Linq：

```
Type t = element.GetType();
int id = 0;
var pt = new List<PropertyInfo>();
pt.AddRange(t.GetProperties());
id = (int)pt.Where(p => p.PropertyType == typeof(int) && p.Name == "id").First().GetValue(element, null); 
```

但不确定它是否读得更好，尤其是 Type.GetProperties 返回一个数组，该数组必须转换为 List 才能获取 Linq 方法。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2009-04-20T15:05:03.443

如果您想使用匿名对象，这是您必须付出的代价：当您离开声明对象的范围时，您会失去强类型。我建议明确声明您的类型，除非您想使用[DataBinder.Eval](http://msdn.microsoft.com/en-us/library/4hx47hfe.aspx) ...

# c# - C# 检查或强制命名约定

> ID：768663
> 
> 赞同：5
> 
> 时间：2009-04-20T15:01:19.630
> 
> 标签：c#, naming-conventions

我从以前的开发人员那里继承了一些程序，他对变量、方法和类的命名有些草率，大写不同，有时还使用下划线。

Visual Studio 中是否有程序或方法来验证每个变量、方法、属性、常量、类的命名......我可以使用标准的 C# 约定。

* * *

## 回答 #1

> 赞同：15
> 
> 时间：2009-04-20T15:03:07.550

你可以看看 Microsoft StyleCop 和 FXCop

* * *

## 回答 #2

> 赞同：7
> 
> 时间：2009-04-20T15:07:23.623

为此，我使用了 ReSharper 4.5，它具有这样的优势，它允许您在编写代码时看到不一致的代码。

您还可以使用 NDepend 和 CQL 以非常精细和灵活的方式检查您的约定。作为构建脚本的一部分，它非常棒。

这两种工具都需要花钱，都值得。

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2009-04-20T15:03:29.047

您正在寻找的是[StyleCop](http://code.msdn.microsoft.com/sourceanalysis)。

它读取源代码以确保遵守某些规则。

FxCop 用于读取编译后的代码，一般不用于这种风格检查。

* * *

## 回答 #4

> 赞同：2
> 
> 时间：2009-04-20T15:04:08.467

看看 StyleCop / CodeStyleEnforcer

他们会突出显示转向架，但您需要自己修复它们

[http://code.msdn.microsoft.com/sourceanalysis](http://code.msdn.microsoft.com/sourceanalysis)

[http://joel.fjorden.se/static.php?page=CodeStyleEnforcer](http://joel.fjorden.se/static.php?page=CodeStyleEnforcer)

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2009-04-20T15:03:07.910

[FXCop](http://msdn.microsoft.com/en-us/library/bb429476.aspx)拥有这些以及更多。

* * *

## 回答 #6

> 赞同：1
> 
> 时间：2009-04-20T15:04:20.167

[FXCop](http://msdn.microsoft.com/en-us/library/bb429476.aspx)和[StyleCop](http://code.msdn.microsoft.com/sourceanalysis)可用于检查是否符合最佳实践和标准。

* * *

## 回答 #7

> 赞同：0
> 
> 时间：2009-04-20T15:03:55.100

[FxCop](http://msdn.microsoft.com/en-us/library/bb429476.aspx)将完成这项工作（或更新的[代码分析](http://code.msdn.microsoft.com/codeanalysis)）。

* * *

## 回答 #8

> 赞同：0
> 
> 时间：2009-04-20T15:04:47.077

这听起来像是一份工作：

[风格警察](http://code.msdn.microsoft.com/sourceanalysis)

从网站：

> StyleCop 分析 C# 源代码以强制执行一组样式和一致性规则。它可以从 Visual Studio 内部运行或集成到 MSBuild 项目中

* * *

## 回答 #9

> 赞同：0
> 
> 时间：2009-04-20T15:13:07.200

正如其他人所说：FxCop 和 StyleCop。ReSharper 4.5 还具有可配置的命名约定。这样做的好处是它会突出显示错误命名的项目并为您提供一个带有建议名称的弹出窗口。我不是 100% 确定，但我认为这也可以在 ReSharper 的“代码清理”功能期间运行（如果不是，如果可以的话，那就太好了！）

当然，一旦您编辑并更正了名称，它们只会在那个时间点正确。为了确保它们现在和永远正确，请将 FxCop/StyleCop 集成到您的持续集成环境中。这将抓住那些标榜规则和规定的顽皮的反社会开发者（你为他们提供什么**社区服务**取决于你，但它通常涉及成为甜甜圈和/或咖啡购买者，直到其他人搞砸！）

# xml - xslt：如何使用 xslt 创建具有多列和多行的表？

> ID：768665
> 
> 赞同：3
> 
> 时间：2009-04-20T15:01:31.063
> 
> 标签：xml, xslt

我将如何获取这个 xml 并为每个“部分”元素创建一个包含一列的表，然后使用 xslt 显示该列中的所有“文档”元素？

```
<Documents>
  <Section>
  <SectionName>Green</SectionName>
    <Document>
      <FileName>Tier 1 Schedules</FileName>     
    </Document>
    <Document>
      <FileName>Tier 3 Schedules</FileName>      
    </Document>
    <Document>
      <FileName>Setback Schedule</FileName>    
    </Document>
    <Document>
      <FileName>Tier 2 Governance</FileName>    
    </Document>
 </Section>
 <Section>
 <SectionName>MRO/Refurb</SectionName>
   <Document>
     <FileName>Tier 2 Governance</FileName>    
   </Document>
 </Section> 
```

谢谢，艾尔

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2009-04-20T16:58:58.380

**该解决方案不使用递归，并重点介绍了一些有用的 XSLT 技术，例如 Muenchian 分组、键、查找最大值和无递归迭代。**

**这种转变**：

```
<xsl:stylesheet version="1.0"
 xmlns:xsl="http://www.w3.org/1999/XSL/Transform">
    <xsl:output omit-xml-declaration="yes" indent="yes"/>

    <xsl:strip-space elements="*"/>

    <xsl:key name="kSectsByValue" match="SectionName"
         use="."/>

    <xsl:key name="kDocBySect" match="Document"
         use="../SectionName"/>

    <xsl:variable name="vCols" select=
       "/*/*/SectionName
                [generate-id()
                =          
                 generate-id(key('kSectsByValue',.)[1])
                 ]"/>

    <xsl:variable name="vMaxRows">
             <xsl:for-each select="$vCols">
               <xsl:sort data-type="number" order="descending"
                    select="count(key('kDocBySect', .))"      />
               <xsl:if test="position() = 1">
                 <xsl:value-of select="count(key('kDocBySect', .))"/>
               </xsl:if>
             </xsl:for-each>
    </xsl:variable>

    <xsl:template match="/">
             <table>
               <tr>
                 <xsl:apply-templates select="$vCols"/>
               </tr>

               <xsl:for-each select=
                 "(/*/*/Document)[not(position() > $vMaxRows)]">                   
                 <tr>

                   <xsl:variable name="vPos" select="position()"/>

                   <xsl:for-each select="$vCols">
                     <td>
                       <xsl:value-of select=
                           "../Document[$vPos]/FileName"/>
                     </td>
                   </xsl:for-each>

                 </tr>
              </xsl:for-each>
            </table>

    </xsl:template>

    <xsl:template match="SectionName">
            <td>
              <xsl:value-of select="." />
            </td>   
    </xsl:template>
</xsl:stylesheet> 
```

**当应用于原始 XML 文档时（更正为格式正确）：**

```
<Documents>
    <Section>
        <SectionName>Green</SectionName>
        <Document>
            <FileName>Tier 1 Schedules</FileName>
        </Document>
        <Document>
            <FileName>Tier 3 Schedules</FileName>
        </Document>
        <Document>
            <FileName>Setback Schedule</FileName>
        </Document>
        <Document>
            <FileName>Tier 2 Governance</FileName>
        </Document>
    </Section>
    <Section>
        <SectionName>MRO/Refurb</SectionName>
        <Document>
            <FileName>Tier 2 Governance</FileName>
        </Document>
    </Section>
</Documents> 
```

**产生所需的结果**：

```
<table>
   <tr>
      <td>Green</td>
      <td>MRO/Refurb</td>
   </tr>
   <tr>
      <td>Tier 1 Schedules</td>
      <td>Tier 2 Governance</td>
   </tr>
   <tr>
      <td>Tier 3 Schedules</td>
      <td/>
   </tr>
   <tr>
      <td>Setback Schedule</td>
      <td/>
   </tr>
   <tr>
      <td>Tier 2 Governance</td>
      <td/>
   </tr>
</table> 
```

**请注意**：

1.  **我们使用[Muenchian 方法进行分组](http://en.wikipedia.org/wiki/Muenchian_grouping)**以查找所有不同的列名，而不是依赖于它们在 XML 文档中是唯一的。

2.  **[键](http://www.w3.org/TR/xslt#key)用于**Muenchian 分组和查找属于列的所有项目。

3.  **找到最大行数**并将其保存在变量中`$vMaxRows`

4.  **我们迭代 N 次**以生成表的 N 行——**不使用递归**！

5.  **通过将`N`**模板应用于在其列中具有位置的**所有列项来输出第 - 行**`N`。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-04-20T16:00:53.607

这是一种可能的解决方案：

```
<xsl:variable name="vCountRows">
  <xsl:apply-templates select="Documents/Section[1]" mode="findmax" />
</xsl:variable>

<xsl:variable name="vCountCols" select="count(Documents/Section)" />

<xsl:template match="/Documents">
  <table r="{$vCountRows}" s="{$vCountCols}">
    <thead>
      <xsl:call-template name="create-thead" />
    </thead>
    <tbody>
      <xsl:call-template name="create-tr" />
    </tbody>
  </table>
</xsl:template>

<xsl:template name="create-thead">
   <tr>
    <xsl:apply-templates select="Section" />
  </tr>    
</xsl:template>

<xsl:template match="Section">
  <th><xsl:value-of select="SectionName" /></th>
</xsl:template>

<xsl:template name="create-tr">
  <xsl:param name="row" select="1" />

  <tr>
    <xsl:call-template name="create-td">
      <xsl:with-param name="row" select="$row" />
    </xsl:call-template>
  </tr>

  <xsl:if test="$row &lt; $vCountRows">
    <xsl:call-template name="create-tr">
      <xsl:with-param name="row" select="$row + 1" />
    </xsl:call-template>
  </xsl:if>

</xsl:template>

<xsl:template name="create-td">
  <xsl:param name="col" select="1" />
  <xsl:param name="row" select="1" />

  <td>
    <xsl:value-of select="Section[$col]/Document[$row]/FileName" />
  </td>

  <xsl:if test="$col &lt; $vCountCols">
    <xsl:call-template name="create-td">
      <xsl:with-param name="col" select="$col + 1" />
      <xsl:with-param name="row" select="$row" />
    </xsl:call-template>
  </xsl:if>
</xsl:template>

<xsl:template match="Section" mode="findmax">
  <xsl:variable name="c" select="count(Document)" />
  <xsl:variable name="next" select="following-sibling::Section[count(Document) &gt; $c][1]" />

  <xsl:choose>    
    <xsl:when test="$next">
      <xsl:apply-templates select="$next" mode="findmax" />
    </xsl:when>
    <xsl:otherwise>
      <xsl:value-of select="$c" />
    </xsl:otherwise>
  </xsl:choose>
</xsl:template> 
```

根据您的输入，它会产生：

```
<table>
  <thead>
    <tr>
      <td>Green</td>
      <td>MRO/Refurb</td>
    </tr>
  </thead>
  <tbody>
    <tr>
      <td>Tier 1 Schedules</td>
      <td>Tier 2 Governance</td>
    </tr>
    <tr>
      <td>Tier 3 Schedules</td>
      <td></td>
    </tr>
    <tr>
      <td>Setback Schedule</td>
      <td></td>
    </tr>
    <tr>
      <td>Tier 2 Governance</td>
      <td></td>
    </tr>
  </tbody>
</table> 
```

一般的方法是这样的：

1.  找出我们将获得多少行（这发生在 中`<xsl:template match="Section" mode="findmax">`，它递归地找到具有最大`<Document>`节点数的部分
2.  找出我们将获得多少列（通过计算`<Section>`s 的数量）
3.  调用创建 a 的模板`<tr>`，并不断调用自身，直到创建了所有必要的行
4.  在这个模板中，调用了第二个模板，这个模板创建了`<td>`s。它一直调用自己，直到达到最大列数（从步骤 2 开始）

算法：

*   使用递增的列号和行号作为索引
*   使用递归来实现一对一的索引增量（因为在 XSLT 中实际上不可能增加一个变量）
*   为文档较少的部分创建正确数量的空单元格

存在一个更有效的版本（可能使用`<xsl:key>`s），我将进一步优化我的版本。

# google-app-engine - 如何在不丢失现有实体的情况下将 Model 类型的实体更改为 Polymodel？

> ID：768670
> 
> 赞同：5
> 
> 时间：2009-04-20T15:02:23.980
> 
> 标签：google-app-engine, django-models

我正在为 Django 使用 App Engine 和 App Engine 补丁

我的模型中定义了一个类，它继承自`db.Model`. 我现在已将其更改为`polymodel.PolyModel`. 进行更改后，我现有的实体不再可检索。有没有办法访问它们或转换它们？

更改实体类种类的推荐过程是什么？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-04-20T21:49:47.073

使用 gaebar、google 应用引擎备份和恢复解决。虽然这不一定是大型数据存储的最佳解决方案..

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2009-05-14T12:21:19.990

迁移数据的麻烦让您想知道您是否总是想从所有新实体的 polymodel 开始。答案：不。如此[处](http://groups.google.com/group/google-appengine-python/browse_thread/thread/dab45bb7a53d3e36#)所述。

# python - 如何防止从 Django 应用程序执行系统调用的任意命令？

> ID：768677
> 
> 赞同：5
> 
> 时间：2009-04-20T15:03:41.497
> 
> 标签：python, django, security

我正在开发一个 Django 应用程序，它必须对服务器上的外部程序进行系统调用。在为系统调用创建命令时，应用程序从表单中获取值并将它们用作调用的参数。我想这意味着人们基本上可以使用虚假参数并编写任意命令以供 shell 执行（例如，只需放置一个分号，然后`rm -rf *`）。

这是不好的。虽然大多数用户不是恶意的，但这是一个潜在的安全问题。如何处理这些潜在的利用点？

**编辑**（澄清）：用户将看到一个表单，该表单由每个参数和选项的各个字段分开。但是，某些字段将作为开放文本字段提供。所有这些字段都被组合并馈送到`subprocess.check_call()`. 但是，从技术上讲，这与仅向用户提供命令提示符并没有太大的区别。这必须相当普遍，所以其他开发人员会做些什么来清理输入，以免他们得到[Bobby Tables](http://xkcd.com/327/)。

* * *

## 回答 #1

> 赞同：11
> 
> 时间：2009-04-20T15:14:47.397

根据我对这个问题的理解，我假设您没有让用户指定要在 shell 上运行的命令，而只是这些命令的参数。在这种情况下，您可以通过使用模块而*不是*使用shell来避免[shell注入](http://en.wikipedia.org/wiki/Code_injection#Shell_Injection)攻击（即在构造函数中指定使用默认参数。[`subprocess`](http://docs.python.org/library/subprocess.html)*`shell=False``subprocess.Popen`*

 *哦，*永远不要*用于`os.system()`包含来自用户的任何输入的任何字符串。

* * *

## 回答 #2

> 赞同：6
> 
> 时间：2009-04-20T15:16:21.357

通过从不信任用户。来自网络浏览器的任何数据都应被视为已污染。并且绝对不要尝试通过 JS 或限制可以在 FORM 字段中输入的内容来验证数据。在将其传递给外部应用程序之前，您需要在服务器上进行测试。

**编辑后更新：**无论您如何将表单呈现给前端的用户，后端都应该将其视为来自一组文本框，周围有大闪烁的文本，上面写着“在此处插入您想要的任何内容！”

* * *

## 回答 #3

> 赞同：4
> 
> 时间：2009-04-20T15:52:19.833

为此，您必须执行以下操作。如果您不知道“选项”和“参数”是什么，请阅读[optparse 背景](http://docs.python.org/library/optparse.html#background)。

每个“命令”或“请求”实际上都是模型的一个实例。使用某人可能提供的所有参数定义您的请求模型。

1.  对于简单的选项，您必须提供一个包含特定 CHOICES 列表的字段。对于“开”或“关”的选项（`-x`在命令行中），您应该提供一个 CHOICE 列表，其中包含两个人类可理解的值（“Do X”和“Do not do X”。）

2.  对于具有值的选项，您必须提供一个接受选项值的字段。您必须编写一个带有此字段验证的表单。我们稍后会回到选项值验证。

3.  对于参数，您有第二个模型（第一个模型带有 FK）。这可能与单个 FilePath 字段一样简单，也可能更复杂。同样，您可能还必须提供一个表单来验证此模型的实例。

选项验证因选项类型而异。您必须将可接受的值缩小为尽可能窄的字符集，并编写一个绝对确定只传递有效字符的解析器。

您的选项将属于与 optparse 中的选项类型相同的类别——string、int、long、choice、float 和 complex。请注意，int、long、float 和 complex 已经在 Django 的模型和表单中定义了验证规则。Choice 是一种特殊的字符串，已经被 Django 的模型和表单支持。

剩下的是“字符串”。定义允许的字符串。为这些字符串编写一个正则表达式。使用正则表达式进行验证。大多数情况下，您永远不能接受任何形式的引号（`"`或`'``）。

最后一步。您的模型有一个方法可以将命令作为字符串序列发出，所有这些都准备好了`subprocess.Popen`。

* * *

**编辑**

这是我们应用程序的支柱。这很常见，我们有一个带有多个表单的模型，每个表单都用于运行一个特殊的批处理命令。该模型非常通用。表单是构建模型对象的非常具体的方法。这就是 Django 设计的工作方式，它有助于适应 Django 深思熟虑的设计模式。

任何“可用作开放文本字段”的字段都是错误的。每个“打开”的字段都必须有一个正则表达式来指定允许的内容。如果你不能正式化一个正则表达式，你必须重新考虑你在做什么。

不能用正则表达式约束的字段绝对不能是命令行参数。时期。在使用之前，它必须存储到文件到数据库列中。

* * *

**编辑**

像这样。

```
class MySubprocessCommandClass( models.Model ):
    myOption_1 = models.CharField( choice = OPTION_1_CHOICES, max_length=2 )
    myOption_2 = models.CharField( max_length=20 )
    etc.
    def theCommand( self ):
        return [ "theCommand", "-p", self.myOption_1, "-r", self.myOption_2, etc. ] 
```

您的表单是此模型的 ModelForm。

您不必`save()`使用模型的实例。我们保存它们，以便我们可以创建一个准确记录运行内容的日志。

* * *

## 回答 #4

> 赞同：3
> 
> 时间：2009-04-20T15:08:15.073

答案是，不要让用户输入 shell 命令！没有任何借口允许执行任意 shell 命令。

此外，如果您确实必须允许用户为外部命令提供参数，请不要使用 shell。在 C 中，您可以使用`execvp()`直接向命令提供参数，但是使用 django，我不确定您将如何执行此操作（但我确信有办法）。当然，您仍然应该做一些参数清理，特别是如果该命令有可能造成任何伤害。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2009-04-20T15:08:44.883

根据您的命令范围，您可以自定义表单，以便在单独的表单字段中输入参数。您可以更轻松地解析拟合值的那些。另外，请注意反引号和其他特定于 shell 的内容。

# iphone - 将 webview 请求抛出到另一个 webview

> ID：768702
> 
> 赞同：0
> 
> 时间：2009-04-20T15:09:57.970
> 
> 标签：iphone, cocoa-touch, uiwebview

我有一个 UIViewController，里面有一个 UIWebView (webview1)。网页视图只有几行文本，但里面确实有一个链接。我不想在这个狭小的空间中打开指向外部网站的链接，而是将其发送到 webview2，这将是一个全屏。目标是将网络请求保留在我的应用程序中，而不是 Safari 中。我不想为 webview2 创建另一个控制器，而是使用 webview1 的控制器。

在 Webview1Controller 控制器中，我在 webViewLoad 中执行此操作：

```
webview1.delegate = self; 
```

这是我将 Web 请求交给 webview2 的地方，效果很好：

```
- (BOOL)webView:(UIWebView *)webView shouldStartLoadWithRequest:(NSURLRequest *)request navigationType:(UIWebViewNavigationType)navigationType{

myapp *delegate = [[UIApplication sharedApplication] delegate];
Webview1Controller *webview1Controller = [[Webview1Controller alloc] initWithNibName:@"webview2" bundle:nil];
//self.view = webview2;'
[delegate.navigationController pushViewController: webview1Controller animated:YES];
[webview1Controller.webview2 loadRequest:request];
[webview1Controller release];
return YES;
} 
```

在 Interface Builder 中，我将 webview2.xib 文件的 Owner 类设置为 Webview1Controller。它的“视图”和 webview2outlet 已连接。我在 Webview1Controller 中有一个名为 webview2outlet 的 IBOutlet。

当我回到 webview1 时，它也加载了相同的请求。有没有办法阻止 webview1 加载任何东西？如果我在上述方法中返回 NO，webview1 将不会呈现我的内容。

一种解决方案是在 viewWillAppear 上重新加载 webview1 内容，这很有效。但是有更好的方法吗？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-04-20T15:57:05.017

`NO`从委托方法返回。

关于您的评论，我认为您想要做的是让您的委托方法检查哪个 webview 正在调用您的控制器：

```
- (BOOL)webView:(UIWebView *)webView shouldStartLoadWithRequest:(NSURLRequest *)request navigationType:(UIWebViewNavigationType)navigationType{
    if (webView == webview1) {
        Webview1Controller *webview1Controller = [[Webview1Controller alloc] initWithNibName:@"webview2" bundle:nil];
        [self.navigationController pushViewController:webview1Controller animated:YES];
        [webview1Controller.webview2 loadRequest:request];
        [webview1Controller release];
        return NO;
    }
    else {
        return YES;
    }
} 
```

（还要注意，UIViewController 有一个`navigationController`属性，因此您可以使用它而不是通过您的应用程序委托获取它）。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-04-20T16:52:32.513

如果您加载请求的副本而不是原始请求，然后返回 NO，会发生什么情况？

```
- (BOOL)webView:(UIWebView *)webView shouldStartLoadWithRequest:(NSURLRequest *)request navigationType:(UIWebViewNavigationType)navigationType{

    myapp *delegate = [[UIApplication sharedApplication] delegate];
    Webview1Controller *webview1Controller = [[Webview1Controller alloc] initWithNibName:@"webview2" bundle:nil];
    //self.view = webview2;'
    [delegate.navigationController pushViewController: webview1Controller animated:YES];
    [webview1Controller.webview2 loadRequest:[[request copy] autorelease]];
    [webview1Controller release];
    return NO;
} 
```

# c - 很棒的 C 教程？

> ID：768704
> 
> 赞同：5
> 
> 时间：2009-04-20T15:11:00.403
> 
> 标签：c, linux, ubuntu, gnome

我真的很想学习C。什么是好的教程？

* * *

## 回答 #1

> 赞同：31
> 
> 时间：2009-04-20T15:13:46.837

[C 编程语言](https://rads.stackoverflow.com/amzn/click/com/0131103628)（通常称为“K&R”）几乎被普遍认为是学习 C 的最佳资源。

* * *

## 回答 #2

> 赞同：5
> 
> 时间：2009-04-20T20:35:41.103

虽然“The C Programming Language”当然是一本很棒的书，并且是对 C 语言的很好的介绍，但它有几个缺点：

*   它有点过时了，第二版（最后一版）只涵盖了现在已经 20 岁的 C89。虽然 C99（当前标准）并未得到普遍支持，但它的许多特性得到了许多实现的支持，并且接触它们很有用。
*   它并不全面。它没有详细介绍许多标准库函数，也没有深入探讨某些复杂性。
*   The text assumes you are already an experienced programmer and has a very terse style which doesn't work well for everyone.

If you are looking for a more beginner-friendly, comprehensive, or up-to-date book, I would strongly recommend [C Programming: A Modern Approach, 2nd Ed](https://rads.stackoverflow.com/amzn/click/com/0393979504). It covers every aspect of the language and the standard library in depth, including C99, and is extremely well-written. While the list price is rather high, it usually isn't difficult to find a copy for around $60 USD.

* * *

## 回答 #3

> 赞同：4
> 
> 时间：2009-04-20T15:16:03.213

官方 GNOME 开发人员指南：http: [//oreilly.com/catalog/9781593270308/](http://oreilly.com/catalog/9781593270308/)

* * *

## 回答 #4

> 赞同：3
> 
> 时间：2009-04-20T15:17:15.487

教程起初可能是半有用的，但我总是通过实际开发有用的代码来学习一门语言。

我建议您查看一些[Gnome Love Projects](http://live.gnome.org/GnomeLove)。对于有兴趣加入 gnome 开发社区的人来说，它们通常是较小的任务。他们将帮助您习惯开发环境，并提交补丁以及他们使用的样式和约定。大多数人也会教你一些你不知道的关于 C 的东西。

* * *

## 回答 #5

> 赞同：2
> 
> 时间：2009-04-20T15:44:54.347

[C书](http://publications.gbdirect.co.uk/c_book/)是一本很好的免费电子书。

* * *

## 回答 #6

> 赞同：1
> 
> 时间：2009-04-20T15:12:23.003

这是一个资源。[http://www.physics.drexel.edu/courses/Comp_Phys/General/C_basics/](http://www.physics.drexel.edu/courses/Comp_Phys/General/C_basics/)

* * *

## 回答 #7

> 赞同：1
> 
> 时间：2009-04-20T15:23:35.333

您可以参考旨在补充 K&R 的[C Programming Notes 。](http://www.eskimo.com/~scs/cclass/krnotes/top.html)

* * *

## 回答 #8

> 赞同：0
> 
> 时间：2009-04-20T15:15:58.237

它更像是一个*常见问题*而不是教程，但它非常有用：[C - faq](http://c-faq.com/index.html)。

关于 Gnome 编程：[Gnome 指南](http://developer.gnome.org/doc/guides/programming-guidelines/book1.html)

以下是每个 C 程序员都需要的一些工具：

*   [海合会](http://gcc.gnu.org/)
*   [gdb - 调试器](http://www.gnu.org/software/gdb/)
*   [瓦尔格林德](http://www.valgrind.org/)
*   [gprof - 分析器](http://www.cs.utah.edu/dept/old/texinfo/as/gprof.html)

* * *

## 回答 #9

> 赞同：0
> 
> 时间：2009-04-20T18:32:34.740

始终避免使用教程（由孩子编写，为孩子编写）阅读 KR

* * *

## 回答 #10

> 赞同：0
> 
> 时间：2009-04-20T18:38:55.690

我会认真建议您查看 Bruce Eckel 免费提供的“ [Thinking in C](http://mindview.net/CDs/ThinkingInC/beta3) ”，这是对 C 系列编程语言的基于闪存的介绍：

> 一个基于 Flash 的视听研讨会，向您介绍 C 语言的基础知识，帮助您学习基于 C 的语言，如 C++、Java 和 C#。

# java - 具有硬件加速 3D 图形的 Java 小程序？OpenGL 和/或 DirectX

> ID：768705
> 
> 赞同：4
> 
> 时间：2009-04-20T15:11:04.020
> 
> 标签：java, opengl, 3d, applet, directx

我用谷歌搜索找不到这个问题的明确答案。

如果我想要一个 Web 小程序，Java 中是否有一个库可以利用客户端机器上的硬件加速图形驱动程序，例如 OpenGL 和 Directx？我正在想象在小程序启动之前编写一些驱动程序检测代码来检测 3D 图形功能。

我意识到有很多 Java 3D 库，但无法弄清楚这一点。

我的印象是你可以做到这一点，但找不到它。

当我问的时候，Flash 和 Silverlight 怎么样？我以为他们所有的 3D 图形都是软件渲染的？

编辑：

我看到问题的答案是肯定的，Java 确实有 3D 硬件支持。感谢您提供所有信息！

我想我真正的问题是（我在做什么）：

1）这在多大程度上支持充分使用？例如，您可以使用 DirectX 或 OpenGL 着色器吗？我可能希望缺少一些功能，因为这往往会抽象出一些东西。我可以制作一个 GPUID 程序或一个实用程序来详细列出客户端的 GPU 功能吗？

2）实用吗？我可以将像 Quake 这样的旧 3D 游戏移植到 Java 小程序并获得不错的性能吗？（当然取决于客户端系统）

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2009-04-20T15:15:23.480

[applet-launcher 项目](https://applet-launcher.dev.java.net/)应该有帮助：

> JNLPAppletLauncher 是一个通用的基于 JNLP 的小程序启动器类，用于部署使用包含本机代码的扩展库的小程序。它允许小程序非常轻松地使用**Java 3D、JOGL 和 JOAL**等扩展，只需在`<applet>`标签中添加几个附加参数，就可以在 Java SE 版本早至 1.4.2 上使用。

JOGL 在这里有一个示例小程序[，](https://jogl-demos.dev.java.net/applettest.html) ​​Java3D 在[这里](https://java3d.dev.java.net/applets/)有两个示例。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2009-04-20T17:39:20.000

DirectX 是一个专有的 Microsoft 3D 系统，所以除非你确定你只会在 Microsoft 系统上运行，否则我会避免使用 DirectX。

JOGL 和 Java3D 非常不同。JOGL 是 OpenGL 之上的一个薄层，具有暗示的所有优点和缺点。Java3D 是一个完整的场景图系统。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2011-01-23T07:37:30.433

完全可以编写访问 3D 硬件的 Java 小程序。env3d 项目 ( [http://env3d.org](http://env3d.org) ) 就是这样——一个生成 3D 加速 3D 小程序的 java 3D 引擎。网站上有很多示例程序来演示在浏览器中使用硬件加速 3D。唯一的要求是必须安装 Java，并且用户必须明确允许 applet 访问本地资源的权限。

Env3D 基于 lwjgl，一个用于 Java 的 opengl/游戏包装器。它甚至支持着色器和其他高级功能。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2009-04-20T17:45:16.537

还需要注意的是，在 Java 的新版本中（我认为是 1.6 版本 10？）对 windows 的图形管道进行了重大改进。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2009-04-20T15:14:56.977

Java 从 1.5 开始就支持硬件加速图形。

请参阅发布说明以[了解如何操作](http://java.sun.com/j2se/1.5.0/docs/guide/2d/new_features.html#img)。注意：这是二维的。

对于 3D，J2SE 有[Java3D](http://java.sun.com/javase/technologies/desktop/java3d/)。

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2009-04-20T15:50:59.433

Flash 支持伪 3D，但不支持任何类型的 OpenGL 加速全场景 3D（基本上只是透视变形效果）。还有一些面向软件的解决方案（例如，Papervision3D）。

Silverlight 将在今年晚些时候发布的 3.0 版本中支持伪 3D。据我所知，目前还没有全 3D 的计划。

据推测，JavaFX 计划的后续版本计划支持 3D，这将（如果有的话）大大改善对小程序的支持。

* * *

## 回答 #7

> 赞同：0
> 
> 时间：2009-09-16T12:50:28.690

你不会有着色器，我上次检查过；您基本上会在您可能认为是 DX5 或 DX6 级别功能的基础上获得一个场景图 API，具体取决于您在做什么。

# multithreading - 在不同平台上使用 sqlite 和文件锁定是否存在已知问题？

> ID：768708
> 
> 赞同：4
> 
> 时间：2009-04-20T15:12:16.203
> 
> 标签：multithreading, sqlite, file-io, cross-platform

我正在使用 sqlite 对专有文件进行索引，并且将使用多个线程（使用不同的 sqlite 句柄）访问数据库以进行读取和写入。

我知道 sqlite 锁定文件是为了为读者/作者提供并发性，并且依赖于 OS 文件 api 进行锁定。

这在 windows 和 linux 上都很好，但在 solaris 和 hpux 上，我对咨询锁定在那里的工作方式不太有信心。

有谁知道 sqlite 在这些平台上的并发性能如何？

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2009-04-20T20:40:22.793

根据我的经验（尽管基于有些过时的 SQLite 版本，即 3.0.x - 3.2.x），当存在某种争用时，您不希望依赖 SQLite 的默认锁定实现（即使它只是多个线程在同一个过程）。

主要问题是 SQLite 只是休眠了一小会儿，然后在文件被锁定时重试（直到忙等待超时到期）——这很可能导致应用程序中出现“数据库锁定”错误。除了 SQLite 自己的锁定之外，我实现的解决方法是使用我自己的锁定（在多线程进程中使用互斥锁）。

# pdf-generation - 下载 MSDN 文档的任何部分并转换为 pdf 的工具或方法？

> ID：768712
> 
> 赞同：2
> 
> 时间：2009-04-20T15:12:58.307
> 
> 标签：pdf-generation, msdn

阅读在线 MSDN 文档是了解更多关于 .NET 和其他 MS 技术的好方法。但是有时我需要在离线模式下阅读它，比如使用电子阅读器时。

是否有工具、软件或一些代码可用于下载 MSDN 库的一部分并将其转换为 pdf，从 msdn 文档中的 url 开始？

假设我想下载有关 WCF 的整个部分，并且该工具会智能地下载 MSDN 的那部分并将其转换为 pdf？不需要遵循文档中的超链接。它们通常指向主要部分中的其他子部分，并且在此过程中会被下载。

**更新：**
应用程序和代码可在[http://soofflinereader.codeplex.com/获得](http://soofflinereader.codeplex.com/)

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-03-01T14:43:51.360

将 html 转换为 pdf 书的解决方案非常简单： [https ://sitereader.codeplex.com/](https://sitereader.codeplex.com/)

**用法：**
下载release build并执行如下图：
*Fluid.SiteReader.Console msdn ms731190*

将转换路径[http://msdn.microsoft.com/en-us/library/ms731190.aspx](http://msdn.microsoft.com/en-us/library/ms731190.aspx)下的所有文档，并根据所述页面的标题创建一个 pdf。

**注意：**
将使用名为“temp”的子文件夹作为工作文件夹，请检查配置文件以获取更多详细信息。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-04-20T15:17:17.407

请参阅[此论坛](http://bytes.com/groups/net-c/659332-msdn-help-pdf-doc-format)上的答案。可能对你有帮助。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-04-20T15:20:17.073

对于单个条目，您可以：

[从http://sourceforge.net/projects/pdfcreator/](http://sourceforge.net/projects/pdfcreator/)安装 PDFCreator

然后它将为您提供一个虚拟打印机驱动程序，该驱动程序看起来像普通打印机。

从浏览器中的打印选项将您的文档打印为 pdf 文件（或实际上提供的任何其他格式）。

不知道任何简单的方法来获取更大的小节。

[如果您以这种方式打印多个部分，则可以使用http://www.accesspdf.com/pdftk/](http://www.accesspdf.com/pdftk/)将它们合并为一个 pdf 。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2011-02-02T18:22:40.033

我花钱请人为我创造了一个。

# .net - 从 Xml 创建一个类型

> ID：768717
> 
> 赞同：0
> 
> 时间：2009-04-20T15:13:54.107
> 
> 标签：.net, xml, reflection, reflection.emit

我有一个这样的 xml

我想解析 xml，用 spscified 属性构建一个动态类。我找到了一些使用 system.reflection.emit 命名空间的指针，但我是否总是必须创建一个程序集和模块才能定义类型？我可以只创建一个类型并定义属性吗？

```
<Root>
<type>
<name>mytype</name>
 <properties>
  <property>
    <name>property1</name>
    <value>2</value>
    <datatype>int</datatype>
  </property>
  <property>
    <name>property3</name>
    <value>2.5</value>
    <datatype>double</datatype>
  </property>
  <property>
    <name>property4</name>
    <value>hello world</value>
    <datatype>string</datatype>
  </property>
 </properties>
</type>
</Root> 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2009-04-20T15:18:30.400

类型必须始终存在于程序集中 - 因此您必须在内存中创建程序集。您可能会发现使用 CodeDom 模型来定义类型更容易一些。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-04-30T22:49:11.657

[此示例](http://msdn.microsoft.com/en-us/library/system.reflection.emit.propertybuilder.aspx)显示创建一个 AssemblyBuilder，然后是 ModuleBuilder，然后是 TypeBuilder。从那里你必须定义属性。您必须创建具有与 get 和 set 访问器匹配的返回和参数的方法。该示例显示了使用字段进行存储的标准 get/set 操作的基本实现。如果您需要更多，则必须学习 CIL 才能启动。

完成后调用 TypeBuilder.CreateType 和可能的 AssemblyBuilder.Save 如果您希望保存以供将来使用。

至于您对创建程序集的担忧。定义动态程序集和模块并不是什么大不了的事。只需几行即可。

# iphone - 如何让 UIToolbar 字体与 UINavigation Controller 匹配？

> ID：768729
> 
> 赞同：4
> 
> 时间：2009-04-20T15:16:22.010
> 
> 标签：iphone, uinavigationcontroller, uilabel, uitoolbar

使用[以下帖子](https://stackoverflow.com/questions/333441/adding-a-uilabel-to-a-uitoolbar)，我能够将 UILabel 添加到 UIToolbar，但是，它看起来很糟糕。任何人都知道如何让文本大小/颜色/阴影与 UINavigationController 的标题相匹配？

导航控制器

[替代文本 http://www.codingwithoutcomments.com/uploads/Picture1.png](http://www.codingwithoutcomments.com/uploads/Picture1.png)

带有 UILabel

[替代文本的 UIToolbar http://www.codingwithoutcomments.com/uploads/Picture2.png](http://www.codingwithoutcomments.com/uploads/Picture2.png)

我需要采取哪些步骤才能使它们匹配？

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2009-04-30T20:33:49.483

您可能还想添加阴影？

```
itemLabel.shadowColor = [UIColor colorWithRed:0 green:0 blue:0 alpha:0.5];
itemLabel.shadowOffset = CGSizeMake(0, -1.0); 
```

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2011-06-08T06:25:16.600

显然问题是关于 iPhone，但如果有人想知道，这里是 iPad 的数字：

```
 titleLabel.font = [UIFont boldSystemFontOfSize:20.0];
    titleLabel.shadowOffset = CGSizeMake(0, 1);
    titleLabel.shadowColor = [UIColor colorWithWhite:1.f alpha:.5f];
    titleLabel.textColor = [UIColor colorWithRed:113.f/255.f green:120.f/255.f blue:127.f/255.f alpha:1.f];
    titleLabel.backgroundColor = [UIColor clearColor];
    titleLabel.text = @"Title"; 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-04-20T18:51:00.153

```
UILabel * itemLabel = [[UILabel alloc] initWithFrame:rectArea];
itemLabel.text = @"Item";   
itemLabel.textColor = [UIColor whiteColor];
itemLabel.font = [UIFont boldSystemFontOfSize:22.0]; 
```

# asp.net-mvc - 模型绑定和 GET 请求？

> ID：768731
> 
> 赞同：10
> 
> 时间：2009-04-20T15:16:33.913
> 
> 标签：asp.net-mvc, model-binding, http-get

在 html 表单中有大量的模型绑定示例，但我想知道是否可以，如果可以，如何使用模型绑定来处理 ActionLinks/GET 请求。

所以，给定以下模型

```
public class Lurl
{
  public string Str {get;set;}
  public char Chr {get;set;}
  public double Dbl {get;set;}
} 
```

和以下路线（我不确定这将如何形成；我展示它是为了展示我希望 URL 如何展示属性 Str、Chr 和 Dbl）

```
routes.MapRoute(
    "LurlRoute",
    "Main/Index/{str}/{chr}/{dbl}",
    new
    {
        controller = "Main",
        action = "Index",
        lurl = (Lurl)null
    }
); 
```

我想在我的控制器中以这种方式使用它

```
[AcceptVerbs(HttpVerbs.Get)]
public ActionResult Index(Lurl lurl)
{
  /* snip */
} 
```

在我的页面中以这种方式（两种可能的选择；还有更多吗？）

```
<div class="links">
  <%Html.ActionLink("Link one", "Index", new { lurl = Model })%><br />
  <%Html.ActionLink("Link two", "Index", 
         new { str = Model.Str, chr = Model.Chr, dbl = Model.Dbl })%>
</div> 
```

模型绑定基础设施可以做到这一点吗？如果是这样，需要对我的样品做些什么才能让它们发挥作用？

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2009-04-20T21:55:54.920

我认为您必须选择任一类作为参数方法

```
[AcceptVerbs(HttpVerbs.Get)]
public ActionResult Index(Lurl lurl)
{
   /* snip */
} 
```

或作为参数的属性方法

```
[AcceptVerbs(HttpVerbs.Get)]
public ActionResult Index(string str, char chr, double dbl)
{
    /* snip */
} 
```

...虽然在类中作为参数方法，您可以使用“UpdateModel”方法。您可以传入要使用该方法更新的参数白名单，以防万一您只想更新模型中的几个值。

另外，在您的 MapRoute 中，lurl 将映射到您的路由路径中的哪个参数？我很确定那里必须存在一对一的相关性。

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2009-04-21T01:44:55.947

您还可以使用[自定义模型绑定器](http://weblogs.asp.net/scottgu/archive/2008/10/16/asp-net-mvc-beta-released.aspx#four)。也读[这个](http://www.singingeels.com/Articles/Model_Binders_in_ASPNET_MVC.aspx)。

# php - DOM：获取文档中的所有文本节点（PHP）

> ID：768737
> 
> 赞同：5
> 
> 时间：2009-04-20T15:18:05.673
> 
> 标签：php, dom, text, traversal

我有以下 (PHP) 代码遍历整个 DOM 文档以获取所有文本节点。这是一个有点丑陋的解决方案，我相信一定有更好的方法......那么，有吗？

```
$skip = false;
$node = $document;
$nodes = array();
while ($node) {
    if ($node->nodeType == 3) {
        $nodes[] = $node;
    }
    if (!$skip && $node->firstChild) {
        $node = $node->firstChild;
    } elseif ($node->nextSibling) {
        $node = $node->nextSibling;
        $skip = false;
    } else {
        $node = $node->parentNode;
        $skip = true;
    }
} 
```

谢谢。

* * *

## 回答 #1

> 赞同：13
> 
> 时间：2009-04-20T15:32:37.713

您需要的 XPath 表达式是`//text()`. 尝试将其与[`DOMXPath::query`](http://us2.php.net/manual/en/domxpath.query.php). 例如：

```
$xpath = new DOMXPath($doc);
$textnodes = $xpath->query('//text()'); 
```

# c# - DataGrid ButtonColumns 的 null 元素 ID

> ID：768738
> 
> 赞同：1
> 
> 时间：2009-04-20T15:18:10.477
> 
> 标签：c#, asp.net, javascript

我的一个页面中有一些 JavaScript，可以避免用户双击表单上的按钮并在异步回发期间导致重复提交的问题：

`var prm = Sys.WebForms.PageRequestManager.getInstance(); prm.add_initializeRequest(InitializeRequest); prm.add_endRequest(EndRequest);`

 ````
var btn;

function InitializeRequest(sender, args) {
  document.body.style.cursor = "wait";
  var btnId = args._postBackElement.id;
  btn = document.getElementById(btnId);
  if (btn != null && (btn.type == "button" || btn.type == "submit"))
    btn.disabled = true;
}

function EndRequest(sender, args) {
  document.body.style.cursor = "default";
  if (btn != null) btn.disabled = false;
} 
````  `这不适用于 DataGrid ButtonColumns。document.getElementById(btnId) 为这些返回 null。

如果我使用 TemplateColumn 并在里面放一个 Button 控件，那效果很好。

查看为 DataGrid 呈现的 HTML，我可以看到 ASP.NET 没有为 ButtonColumn 输出 onclick，但它为 TemplateColumn 内的 Button 输出了 onclick：

**按钮栏：**

```
<输入类型="提交"
  name="ctl00$placeholderContent$dgCommittees$ctl03$ctl00"
  值="编辑" />

```

**TemplateColumn 中的按钮：**

```
<输入类型="提交"
  name="ctl00$placeholderContent$dgCommittees$ctl03$cmdDelete"
  值="删除"
  onclick="return confirm('你确定要删除这个委员会吗？');
    WebForm_DoPostBackWithOptions(
     new WebForm_PostBackOptions("ctl00$placeholderContent$dgCommittees$ctl03$cmdDelete", "", true, "", "", false, false))"
  id="ctl00_placeholderContent_dgCommittees_ctl03_cmdDelete" />

```

显然是“我如何使这项工作？”的答案。是简单地将我所有的 ButtonColumns 替换为 TemplateColumns 中的按钮。

我很好奇是否有人知道*为什么*ASP.NET 以这种方式呈现 ButtonColumns，以及是否有某种方法可以让它与 Buttons 一样呈现它们。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-04-20T21:43:52.720

MS 有一个绑定字段的标准实现，它不为 ButtonColumn 创建的按钮设置 ID 或属性。

更具体地说，每当网格创建单元格和子顺序按钮时，它都会调用 InitializeCell：

```
public override void InitializeCell(TableCell cell, int columnIndex, ListItemType itemType)
{
    base.InitializeCell(cell, columnIndex, itemType);
    if ((itemType != ListItemType.Header) && (itemType != ListItemType.Footer))
    {
        WebControl child = null;
        if (this.ButtonType == ButtonColumnType.LinkButton)
            ...
        else
        {
            child = new Button {
                Text = this.Text,
                CommandName = this.CommandName,
                CausesValidation = this.CausesValidation,
                ValidationGroup = this.ValidationGroup
            };
        }
        ...
        cell.Controls.Add(child);
    }
} 
```

如您所见，这就是按钮的全部内容。

如果您希望它具有 ID 和“onclick”属性，您可以使用如下内容：

```
protected void grid_RowCreated(object sender, GridViewRowEventArgs e)
{
    if (e.Row.RowType == DataControlRowType.DataRow)
    {
        //assuming that a first cell is a ButtonField
        //note that in edit mode a button may be at some other index that 0
        Button btn = e.Row.Cells[0].Controls[0] as Button;
        if (btn != null)
        {
            btn.OnClientClick = "return confirm('are you sure?')";
            btn.ID = "myButtonX";
        }
    }
} 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-04-20T21:27:46.363

我建议您使用[JQuery](http://jquery.com/)在按钮上添加事件处理程序。这是一个示例：

```
 function onclick () {
  alert("1");
}
$(function () {
  $("input[type='submit']").click(onclick);
}); 
```

当 DOM 准备好时，此代码会将`onclick`函数附加到所有类型元素的`onclick`事件。`input``submit`

不显眼的[JavaScript](http://en.wikipedia.org/wiki/Unobtrusive_JavaScript)技术可能会让您感兴趣。

我想提一下微软支持 JQuery，他们将在即将发布的 Visual Studio 版本中支持它。欲了解更多信息，请访问[http://live.visitmix.com/](http://live.visitmix.com/)。

# java - 托管 javadoc？

> ID：768741
> 
> 赞同：13
> 
> 时间：2009-04-20T15:18:30.867
> 
> 标签：java, open-source, hosting, javadoc, bitbucket

[我有一个托管在bitbucket](http://bitbucket.org/)上的开源项目。Bitbucket 不提供对大量小文件（即 javadocs）的托管。我在哪里可以发布 javadocs？Javadocs 必须是可浏览的，而不是作为单个存档。

* * *

## 回答 #1

> 赞同：15
> 
> 时间：2014-08-08T17:59:22.227

如果您的开源项目已发布到中央 maven 存储库，那么您可以使用[javadoc.io](http://www.javadoc.io)来托管您的 javadoc。

您的 javadoc 将位于：[http](http://www.javadoc.io/doc/) : //www.javadoc.io/doc/$groupId/$artifactId

例如：[http ://www.javadoc.io/doc/org.springframework/spring-core](http://www.javadoc.io/doc/org.springframework/spring-core)

我觉得这很方便，因为当中央 maven repo 发布了较新版本时，javadoc.io 会自动获取最新版本。

* * *

## 回答 #2

> 赞同：5
> 
> 时间：2014-01-09T20:36:23.037

在 BitBucket 上做吧！您可以在那里[托管一个静态文件网站](https://confluence.atlassian.com/bitbucket/publishing-a-website-on-bitbucket-cloud-221449776.html)。

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2009-04-20T15:26:38.743

[amazon s3](http://aws.amazon.com/s3/)，但它不是免费的。

# asp.net-mvc - asp.net mvc 部分视图

> ID：768748
> 
> 赞同：0
> 
> 时间：2009-04-20T15:19:30.600
> 
> 标签：asp.net-mvc

看来我对局部视图的使用理解不太对。

我正在尝试添加从数据库构建的部分视图并在母版页中使用部分视图。

使用 NerdDinner 项目（非常适合 mvc）我添加了以下内容：

视图\共享\晚餐.ascx"：

```
<%@ Control Language="C#" Inherits="System.Web.Mvc.ViewUserControl<IEnumerable<NerdDinner.Models.Dinner>>" %>
<ul>
    <% foreach (var dinner in Model) { %>
        <li>
            <a href="/Dinners/Details/<%=dinner.DinnerID %>"><%= Html.Encode(dinner.Title) %></a> 
        </li>
<% } %>
</ul> 
```

在 "Views\Shared\Site.Master" 中：

```
<%@ Master Language="C#" Inherits="System.Web.Mvc.ViewMasterPage" %>
...
<% Html.RenderPartial("dinners"); %> 
```

上述内容当前仅在晚餐对象当前作为列表可用的页面上起作用（例如站点/晚餐）。有没有办法以优雅和 mvc 的方式做到这一点，或者这是否需要巧妙的妥协？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-04-20T15:21:48.723

为什么你的主人有它？我会在您的主人中添加另一个占位符，然后将其添加到有意义的地方。我觉得母版页应该与细节一样不可知。如果您希望它出现在所有晚餐页面上，只需将原始页面设为嵌套主控。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2009-04-20T15:30:52.787

这是，IMO，ASP.NET MVC 的最大限制之一 - 管理跨多个视图的共享数据（在将部分 ascx 视图呈现为字符串之后！）。如果你谷歌或在 stackoverflow 上搜索“管理共享视图数据 asp.net mvc”之类的东西，你会得到大量带有各种选项的结果，但没有一个是真正完美的。Microsoft 的 MVC 团队已经承认这是一个问题，并希望在未来的版本中包含一个标准解决方案。

根据您管理数据访问的方式，最简单的方法可能是创建一个基本 Controller 类并在构造函数或内部`OnActionExecuting`() 中检索您需要的部分数据。

我选择的选项是`Html.RenderAction()`在 MvcContrib 项目中使用辅助方法。它基本上使您能够从视图中调用操作方法并呈现响应。这不是很好，因为它需要您的视图对控制器有更多的了解，但它提供了一个简单的短期解决方案，不需要您连接任何额外的代码。

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2009-04-20T19:03:36.067

[stephan Walther 网站上的](http://stephenwalther.com/blog/archive/2008/08/12/asp-net-mvc-tip-31-passing-data-to-master-pages-and-user-controls.aspx)本教程处理了这个问题。如果您使用一个抽象基类，其中填充了晚餐对象并从中继承，它将始终可用，但您必须知道它始终存在，即使您不需要它;)。

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2009-04-20T18:02:13.937

我使用的一种方法是创建一个辅助方法并在您的母版页中使用它。

```
公共静态无效 RenderDinners（这个 HtmlHelper 助手）
{
    helper.RenderAction<DinnersController>(c => c.Dinners());
}

```

```
<%@ Master Language="C#" Inherits="System.Web.Mvc.ViewMasterPage" %>
...
<% Html.RenderDinners(); %>

```

如您所见，助手调用了 DinnersController 上的 Dinners Action 方法。

```
公共行动结果晚餐（）
{
   ...吃晚饭并放在视图中
   返回晚餐（查看）；
}

```

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2009-04-20T15:52:02.440

在我看来，partialview 似乎天生就有缺陷。它根据定义有意地创建模块耦合并破坏内聚。

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2009-04-20T16:36:46.233

我同意丹尼尔，即使你的控件没有显示在每个页面上，它显示在其中的一些页面上，你应该只创建你的主模板作为模板

# java - 为什么 gwt 会越来越受欢迎？

> ID：768749
> 
> 赞同：5
> 
> 时间：2009-04-20T15:19:31.270
> 
> 标签：java, apache-flex, gwt, ria

在过去的 6 个月中，我注意到 GWT 的受欢迎程度急剧增加。更多证据可以在这里看到：

[http://www.indeed.com/jobtrends?q=gwt&l=](http://www.indeed.com/jobtrends?q=gwt&l=)

有人可以解释原因吗？

* * *

## 回答 #1

> 赞同：8
> 
> 时间：2009-04-20T15:20:01.130

我认为这基本上有三个原因：

1.  有机增长 - 你用过 GWT 吗？我不了解大多数人，但对我来说，GWT 网站上的营销材料都不是很有说服力。然后我遇到了一个需要与谷歌地图和应用引擎集成的小型个人项目。我决定尝试 GWT，因为这些工具让它变得如此简单。使用它一次，即使是一个非常普通的项目也完全改变了我的想法。我怀疑这意味着在过去的 6 个月里，该框架已经有了很多口碑传播。
2.  成熟度 - 早期版本并没有被谷歌大量使用（有点狗食），而且边缘有点粗糙。最新版本似乎已经解决了大多数成长中的痛苦问题（尽管编译时间仍然太长，imo），并将其变成了一个可靠、可用的框架。
3.  样式 - 他们已经开始包含一组默认皮肤。我认为这有助于他们的演示在最近的版本中看起来更加令人印象深刻，而过去有些人对项目采取的“没有开箱即用的样式”方法感到困惑。

不过，如果其中任何一个适用于 Java 商店之外，我会感到非常震惊。我根本没有看到 GWT 进入非 Java 环境，我认为他们目前的方向使得非 Java 成功的可能性更小。

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2009-04-20T16:58:52.640

我想说jsight的回答是一个很好的解释。

我看过 Flex、Rails 和 GWT。这三者都在同一个空间中，Flex 生产 Flash RIA，GWT 和 Rails 为 HTML 做同样的事情。

与 Flex 合作后，有很多值得喜欢的地方，但也有一些严重的琐碎问题，对我而言，主要的一个是将 HTML 集成到 Flex 应用程序中的困难——这不是一项简单的任务，很少有项目可以避免这种情况。

另一方面，GWT 最初是令人望而生畏的，因为它是基于 Java 的，并且与 Flex 在 Flex Builder 中提供的那种拖放编辑器不同。

但是 GWT Designer（由 Instantiations 提供）与 GWT 世界中的 Flex Builder 相当好，对于具有 Swing 技能的 Java 程序员来说，GWT 的体系结构不需要太多的了解。

更不用说大量的 Java 程序员，他们可以将 GWT 作为他们现有 Java 工具集的简单附加组件推销给他们的经理。

此外，谷歌品牌也不会受到伤害。

就企业内的可销售性而言，Java 工具总是比 Actionscript 或 Ruby on Rails 更容易销售。很难确定事情的发展方向，但我希望看到这三者的持续增长。这些天每个人都想要RIA。

* * *

## 回答 #3

> 赞同：3
> 
> 时间：2009-04-23T14:34:41.243

我认为最近发布的 GAE，意味着 GWT RPC 可以免费使用（*），会有所帮助。

(*) 与以前一样，除非您有权访问 java servlet 容器（或使用其中一个桥接库在非 java 服务器上运行 RPC），否则您将无法托管使用 RPC 的 GWT 应用程序。

* * *

## 回答 #4

> 赞同：2
> 
> 时间：2009-04-27T15:20:40.400

我提出了 Matt Raible 效应。请参阅：[http ://raibledesigns.com/rd/entry/ajax_framework_analysis_results](http://raibledesigns.com/rd/entry/ajax_framework_analysis_results)

说真的，我认为基于这个人的博客做出技术堆栈决策的人数非常多。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2012-02-22T04:43:53.200

当然，有很多人太害怕或太懒（或其他什么）而无法学习与他们习惯不同的东西，所以这绝对是一个因素。如果 Java 开发人员是什么，那它就是懒惰而且便宜。GWT 在这些方面胜过许多其他 RIA 的东西。了解 Java 和 Swing 的人不想学习 JavaScript、C# (Silverlight)、ActionScript (Flex) 或 JavaFX（那东西还活着吗？），这需要他们付出一些*努力*。

它还对谷歌所触及的任何事物都具有僵尸般的接受度。（虽然我个人更喜欢 Apple 接触的任何东西，但至少 Google 尊重开发者的选择。）

# javascript - Flash ExternalInterface 嗅探器

> ID：768756
> 
> 赞同：3
> 
> 时间：2009-04-20T15:20:25.857
> 
> 标签：javascript, flash, externalinterface

我想查看 Flash 对象在我的浏览器上对 Javascript 进行的所有调用。是否有 ExternalInterface 嗅探器？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2009-04-20T15:32:32.207

我认为您也许可以使用[Charles](http://www.charlesproxy.com/)来做到这一点，但不是 100% 肯定。您也可以使用 Firebug 中的脚本面板，也许？

不要含糊不清，我只是现在没有能力验证我的建议:)

# svn - 如何连接到远程 svn 服务器？

> ID：768766
> 
> 赞同：0
> 
> 时间：2009-04-20T15:23:07.737
> 
> 标签：svn, tortoisesvn, ssh, version

这是当前的设置。

**家用电脑**---/*互联网*/--->**工作代理服务器**--/*局域网*/--> **SVN 服务器**

*   运行 Windows XP 的家用电脑。
*   运行 fedora-core 的工作代理服务器（我可以通过 ssh 连接到它）。
*   SVN 服务器位于运行 Windows XP 的办公室局域网内。

我想从家用 PC 连接到工作 svn 服务器提交更改、更新和签出。

我可以毫无问题地通过隧道连接到我的 Work SVN PC（不是服务），我目前将其与 VNC 一起使用（使用 PuTTY）。

目前使用 Tortoisesvn 作为客户端。

谢谢你的帮助！

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-04-20T15:36:35.520

您需要在 PuTTY 中配置一个隧道端口，以便连接到家用 PC 上的 localhost:someport，PuTTY 将在两者之间建立隧道所有流量。

根据 SVN 服务器设置，您需要使用端口 80 ( `http:`)、443 ( `https:`) 或 3690 ( `svn:`)。

[本教程](http://oldsite.precedence.co.uk/nc/putty.html)有些过时，但仍然适用于此。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-04-20T15:56:54.067

假设您的工作代理机器可以访问 SVN 服务器，您将使用常规 SSH 设置这样的隧道：`ssh -L localport:svnserver:svnport username@proxyserver`。您可能需要通过使用 Ben S 提供的链接来找出 PuTTY 的等效选项。设置隧道后，所有 SVN 操作都将`localport`在本地计算机上进行，因此您需要设置 Tortoise 以将该端口上的本地计算机视为 SVN 服务器（使用新的结帐或a`svn switch --relocate`在现有的工作副本上。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-04-25T01:15:51.570

以前的答案可能是正确的，但比必要的要复杂。如果您使用语法 svn+ssh://user@host/path/to/repository 指定存储库，只要满足以下要求，就会处理隧道详细信息：

*   您可以 ssh 到保存存储库的服务器
*   您将能够在此服务器上运行“svnserve”
*   你的 Windows 客户端机器上有 ssh 或类似的命令行实用程序

最后一项可能涉及一些额外的工作。我通过以下方式取得了成功：

1.  安装 Cygwin（使用 'openssh' + 'openssl' 包）
2.  将以下行添加到 SVN 'config' 文件 (*) 的 [tunnels] 部分：“ssh = /cygwin/bin/ssh -q”（行首*没有*空格）。

(*) 您可以在 c:\Documents and Settings\user\Application Data\Subversion 中找到它，或者转到 TortoiseSVN 设置 > 常规菜单，然后单击“编辑”按钮。

# java - 如何在 servlet 刷新期间获取先前的值

> ID：768768
> 
> 赞同：2
> 
> 时间：2009-04-20T15:23:46.847
> 
> 标签：java, servlets

我有一个servlt。我正在使用以下代码进行刷新。

res.addHeader("刷新", "10");

但在我使用表格阅读日期之前。

第一次，它工作正常。但是 10 秒后，在刷新期间我收到空指针异常，因为日期为空。

即使在刷新后如何获取日期的先前值。

在此先感谢，马赫斯

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-04-20T16:45:09.770

将值放入会话中是一种有效的选择。

另一种选择是，在第一次提交时，向包含先前提交日期的表单添加一个隐藏字段。刷新时，隐藏字段将被提交，因此日期仍将是请求参数的一部分。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-04-20T15:46:03.843

最简单的解决方案可能是在会话中保存日期。

如果请求（发布）中存在该值，则将该值存储在会话中。

session.setAttribute("queryDate",theDate);

重新加载时，检查 getParameter() 是否返回 null 并使用 getAttribute() 使用会话中的日期。

# visual-studio - 如何在不使用 ReSharper 的情况下突出显示 Visual Studio 中的活动行？

> ID：768772
> 
> 赞同：4
> 
> 时间：2009-04-20T15:26:01.893
> 
> 标签：visual-studio

如何在 Visual Studio 2005 和/或 2008 中突出显示活动行？我希望像其他 IDE 和文本编辑器（例如 Eclipse 和 UltraEdit）那样突出显示当前行。ReSharper[可以做到这一点](http://www.jetbrains.com/resharper/features/screenshots/40/assistance_highlight_current_line.png)，但需要额外付费。

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2009-04-20T15:28:08.177

[SlickEdit Gadgets](http://www.slickedit.com/index.php?option=com_content&view=article&id=78&Itemid=90)有一个免费的“线尺”小工具可以做到这一点。

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2010-12-07T22:33:31.637

使用 Productivity Power Tools 扩展升级到 Visual Studio 2010。我知道——不回答这个问题；再说一次，写问题时，这不是一个选择。:)

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2009-04-20T15:28:35.977

你不能开箱即用

使用 resharper 或其他具有此功能的插件是您唯一的选择。

# javascript - JavaScript 中的正则表达式验证（测试）

> ID：768774
> 
> 赞同：0
> 
> 时间：2009-04-20T15:26:27.620
> 
> 标签：javascript, regex

似乎正则表达式问题很常见，因为每个问题似乎都适用于特定情况。话虽如此，这是我的具体情况......

我需要验证员工 ID 是两种特定格式之一。第一种格式（也是我可靠工作的格式）是（不带引号）： "A000000" ，其中 "A" 可以是任何字母字符，而 "0" 可以是 0 到 9 之间的任何数字。另一个要求因为这是只需要员工 id 的前两个位置，这意味着用户可以输入“A0”并且它会验证（这个员工 id 被用于 SQL 语句的 LIKE - ...SID LIKE “A0%” . 再次，这是我通过使用...

`[A-Z]{1}\d{1,6}`

第二种格式给我带来了麻烦。上面的要求相同，只需要输入字符串的前两个位置，其他任何内容都是可选的，但如果输入，则必须遵守指定的格式。格式为（不含引号）：“000000A”。我遇到问题的部分是确保如果输入的数字超过两位，接下来输入的三到六个值是数字，如果输入最后一个值，那么它必须是一个字符。所以有效的输入可能是......

“00”或“000”或“0000”或“00000”或“000000”或“000000A”，但不是“0”或“0A”或“00A”或“000A”等，或“0000000”。到目前为止，这是我对这种格式的了解...

`\d{2}(\d{1,4})?[A-Z]{0,1}`

问题是这允许在位置 3 到 6 的任何位置输入字母字符。它不允许前两个位置有任何字母字符（好），也不允许第七个（最后一个）位置有任何数字字符（好）。只是那些可选的第三到第六个字符允许使用字母字符，这让我很伤心。

我希望这是足够的信息（或者可能不是太多）。任何帮助将不胜感激。谢谢！！！

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-04-20T15:32:56.200

试试这个表达式：

```
(\d{2,5}|\d{6}[A-Z]?) 
```

这匹配 2 到 5 位数字 ( `\d{2,5}`) 或 6 位数字和可选字母 ( `\d{6}[A-Z]?`)。如果您想要完全匹配，请使用`^`和`$`锚点来标记开始和结束：

```
^(\d{2,5}|\d{6}[A-Z]?)$ 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-04-20T15:30:48.170

对于第一个，`{1}`是多余的：

> [AZ][0-9]{1,6}

对于第二个，也许是这样的：

> \d{2}\d{0,1}\d{0,1}\d{0,1}\d{0,1}[AZ]{0,1}

# c# - 使用 VirtualPathProvider 处理简单的静态文件

> ID：768775
> 
> 赞同：4
> 
> 时间：2009-04-20T15:26:35.293
> 
> 标签：c#, .net, asp.net

我们正在使用自定义 VirtualPathProvider 来提供来自基于 ASP.NET 的网站的文件。为了提供静态文件，如图像、css 和脚本，我们明确声明 StaticFileHandler 应该用于具有此扩展名的文件。像这样：

```
<add verb="GET" path="*.jpg" type="System.Web.StaticFileHandler"></add> 
```

**所有这一切似乎都是合乎逻辑的并且有效，除了一个事实 - 使用此处理程序提供的所有虚拟文件都以“Cache-Control：private”**标头进入客户端。这不是我对静态文件的期望。

**有什么好方法可以使这些文件可缓存吗？**

附加信息：

1.  是的，可以在一个简单的 HttpModule 中为所有“.js”文件添加缓存标头，但这不是一个好方法。
2.  我找到[了这篇文章](http://nathanaeljones.com/11081_Using_a_custom_VirtualPathProvider_can_cause_OutOfMemoryExceptions)，这似乎与我们的问题有关。它指的是[KB947461](http://support.microsoft.com/default.aspx/kb/947461#appliesto)。但是不清楚，是不是这个补丁还没有应用到框架上？差不多一年过去了。以及在哪里得到它，如果没有。

**更新**：看起来.NET Framework 3.5 SP1 中包含来自[KB947461的补丁。](http://support.microsoft.com/default.aspx/kb/947461#appliesto)我们已经安装了它。

**更新 2**：现在我们已经结束了这个 HttpModule，如果当前处理程序是 StaticFileHandler，它会添加缓存头。但这绝对是一个拐杖。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2011-07-14T20:09:38.947

令人难以置信的是内置的不这样做。这看起来很有希望：[http ://code.google.com/p/talifun-web/wiki/StaticFileHandler](http://code.google.com/p/talifun-web/wiki/StaticFileHandler)

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-06-26T22:22:43.250

在 IIS、网站属性和缓存选项卡中尝试活动缓存。就我而言，效果很好。

# java - Java：如何干净地处理大量字段及其封装？

> ID：768783
> 
> 赞同：10
> 
> 时间：2009-04-20T15:28:39.360
> 
> 标签：java, encapsulation, getter

假设我的任务是编写某种 RPG。这意味着，例如，我要跟踪 a及其统计数据，例如智力、伤害加成或生命值。~~`Character`~~ `GameCharacter`

我非常害怕在项目结束时我最终可能会处理大量字段 - 对于每个字段，我都必须确保它们遵循一组非常相似的约束和行为（例如，我希望它们限制在最小值和最大值之间；我希望能够区分“基本值”和“临时奖金”；我希望能够在不通过 setter 和 getter 的情况下增加和减少两者） . 突然之间，对于每个字段，我都需要一个（两个？）getter 和四个 setter，也许还需要几个重置器！即使对于 10 个字段，这也意味着很多方法都相似，eek。

对于 DRYness，我已经开始将在`Field`类中处理这些统计数据的逻辑封装起来，这样我就可以编写诸如`intelligence.applyBonus(10)`or之类的代码`hitpoints.get()`（它会注意返回的值在范围内）等。我什至花了这么长的时间来创建类将这些字段组合在一起，但这不是现在的重点。

现在，我在“插入”时遇到了这个问题`Field`：`GameCharacter`大多数 Java 教科书都说每个类都应该有带有公共 getter 和 setter 的私有字段。这在理论上听起来不错，而且我已经围绕`int`;建立了一个完整的课程。但是，当您发现自己调用 getter 来获取... getter 时，这个想法听起来并不可靠：

```
thisCharacter.getIntelligence().get() //eeek 
```

我宁愿直接访问该字段。也许这是我的 Python/VB [1] “背景”，但对我来说它更干净、更清晰、更直接：

```
thisCharacter.intelligence.get() 
```

公共领域的（理论上）问题是我放弃了对它的所有控制；例如，在代码库中的某个其他点，不幸的是，可能会发生以下情况：

```
thisCharacter.intelligence = somethingThatReallyIsNull; 
```

听起来像是一个微妙的错误……但是……我的意思是，我真的应该担心吗？我从来没有打算`Field`直接分配 [2]，我已经在 J​​avadoc 中记录了这不是应该做的事情，但我仍然是新来的，所以我有点被撕裂了。

所以我想听听你对这个话题的看法。封装的优势是否如此巨大，以至于我应该继续使用 getter getter 和 setter getter 等等……还是我应该采取健康措施进行封装并将其`Field`作为一个`public`领域？

* * *

[1] 是的，我知道。我一直在努力忘记。但是我们最近也看到了一些 C# 和 man，属性并不甜。那好吧。

[2] 构造函数除外！getter 不会把我从错误的构造函数中拯救出来。

* * *

## 回答 #1

> 赞同：17
> 
> 时间：2009-04-20T17:17:17.040

听起来你在考虑`if(player.dexterity > monster.dexterity) attacker = player`. 你需要多想`if(player.quickerThan(monster)) monster.suffersAttackFrom(player.getCurrentWeapon())`。不要乱用简单的统计数据，表达你的实际意图，然后围绕他们应该做的事情设计你的课程。无论如何，统计数据都是一种逃避。你真正关心的是一个玩家是否可以做一些动作，或者他们的能力/能力与一些参考。考虑“玩家角色是否足够强大”（`player.canOpen(trapDoor)`）而不是“角色是否至少有 50 点力量”。

* * *

## 回答 #2

> 赞同：8
> 
> 时间：2009-04-20T15:32:21.897

我的经验是，在您需要*大量*字段的情况下，字段的数量、性质、命名和类型非常灵活，并且可能在项目的整个生命周期中发生变化，您可能需要某种地图而不是字段.

例如，有一个从键到值的属性映射。

提供获取和设置属性的公开调用，但不要让每个人都使用它们（或确保它们不使用）。相反，创建类来表示您感兴趣的每个属性，并且该类提供用于操作该属性的所有功能。例如，如果你有力量，你可以有一个初始化为特定 Player 对象的“StrengthManipulation”类，然后提供 getter、setter（都带有适当的验证和例外），也许还有诸如用奖金计算力量等.

这样做的一个好处是您可以将属性的使用与玩家类分离。所以如果你现在添加一个智力属性，你就不必处理和重新编译所有只操纵力量的东西。

至于直接访问字段，这是一个坏主意。当您在 VB 中访问一个字段时（至少在旧 VB 中），您通常会调用属性 getter 和 setter，而 VB 只是为您隐藏 () 调用。我的观点是你必须适应你所使用的语言的约定。在 C、C++、Java 等语言中，您有字段，也有方法。调用方法应始终使用 () 来表明这是一个调用，并且可能会发生其他事情（例如，您可能会遇到异常）。无论哪种方式，Java 的好处之一是其更精确的语法和风格。

VB 到 Java 或 C++ 就像发短信到研究生院的科学写作。

顺便说一句：一些可用性研究表明，最好不要给构造函数提供参数，而是在需要时构造和调用所有设置器。

* * *

## 回答 #3

> 赞同：4
> 
> 时间：2009-04-20T15:41:04.043

Steve Yegge 有一篇非常有趣（如果很长）的博客文章涵盖了这些问题：[通用设计模式](http://steve-yegge.blogspot.com/2008/10/universal-design-pattern.html)。

* * *

## 回答 #4

> 赞同：2
> 
> 时间：2009-04-20T15:33:12.237

在我看来，“thisCharacter”很可能有一个“情报”对象来处理幕后的情报，但我质疑这是否应该公开。您应该只公开 thisCharacter.applyInt 和 thisCharacter.getInt 而不是处理它的对象。不要像那样公开你的实现。

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2009-04-20T15:34:45.180

将您的字段保密！你永远不想暴露太多的 API。在未来的版本中，您始终可以将私有内容公开，但不能反过来。

想想好像你会把它变成下一个 MMORPG。你会有很多错误、错误和不必要的邪恶的余地。确保不可变属性是最终的。

想一想 DVD 播放器，它具有简约的界面（播放、停止、菜单），但内部却具有这样的技术性。你会想要隐藏程序中所有不重要的东西。

* * *

## 回答 #6

> 赞同：1
> 
> 时间：2009-04-20T15:38:31.910

听起来您的主要抱怨不是 setter/getter 方法的抽象，而是使用它们的语言语法。即，您更喜欢 C# 样式属性之类的东西。

如果是这种情况，那么 Java 语言可以为您提供的东西相对较少。直接字段访问很好，直到您需要切换到 getter 或 setter，然后您将进行一些重构（如果您控制整个代码库，可能还可以）。

当然，如果 Java 平台是必需的，但语言不是，那么还有其他选择。例如，Scala 具有非常好的属性语法，以及许多其他可能对此类项目有用的特性。最重要的是，它在 JVM 上运行，因此您仍然可以获得与使用 Java 语言编写它相同的可移植性。:)

* * *

## 回答 #7

> 赞同：1
> 
> 时间：2009-04-20T15:45:52.720

您在这里似乎拥有的是复合模型的单层。

您可能希望添加向模型添加抽象的方法，而不仅仅是将其作为一组较低级别的模型。

这些字段应该是最终的，因此即使您将它们公开，也不会意外分配`null`给它们。

所有 getter 都存在“get”前缀，因此它可能更像是最初的外观而不是新问题。

* * *

## 回答 #8

> 赞同：1
> 
> 时间：2009-04-20T17:22:28.340

> 封装的优势是如此巨大，以至于我应该继续使用 getter getter 和 setter getter 等等......还是我应该采取健康措施进行封装并将 Field 作为公共领域？

IMO，封装与在私有字段周围包装 getter/setter 无关。在小剂量或编写通用库时，权衡是可以接受的。但是，如果在您所描述的系统中不加以检查，则它是一种[反模式](http://www.javaworld.com/javaworld/jw-09-2003/jw-0905-toolbox.html)。

getter/setter 的问题在于它们在具有这些方法的对象与系统的其余部分之间创建了过于紧密的耦合。

真正封装的优点之一是它减少了对 getter 和 setter 的需求，将您的对象与过程中的系统其余部分解耦。

与其用 setIntelligence 暴露 GameCharacter 的实现，为什么不给 GameCharacter 一个更好地反映它在游戏系统中的角色的接口呢？

例如，而不是：

```
// pseudo-encapsulation anti-pattern
public class GameCharacter
{
  private Intelligence intelligence;

  public Intelligence getIntelligence()
  {
    return intelligence
  }

  public void setIntelligence(Intelligence intelligence)
  {
    this.intelligence = intelligence;
  }
} 
```

为什么不试试这个？：

```
// better encapsulation
public class GameCharacter
{
  public void grabObject(GameObject object)
  {
    // TODO update intelligence, etc.
  }

  public int getIntelligence()
  {
    // TODO
  }
} 
```

甚至更好：

```
// still better
public interface GameCharacter
{
  public void grabObject(GameObject object); // might update intelligence
  public int getIntelligence();
}

public class Ogre implements GameCharacter
{
  // TODO: never increases intelligence after grabbing objects
} 
```

换句话说，一个 GameCharacter 可以抓取 GameObjects。每个 GameCharacter 抓取相同 GameObject 的效果可以（并且应该）有所不同，但细节完全封装在每个 GameCharacter 实现中。

请注意 GameCharacter 现在如何负责处理自己的智能更新（范围检查等），例如，当它抓取 GameObjects 时会发生这种情况。二传手（以及你注意到它的并发症）已经消失了。根据具体情况，您也许可以完全放弃 getIntelligence 方法。Allen Holub 将这个想法推向了[合乎逻辑的结论](http://www.javaworld.com/javaworld/jw-09-1999/jw-09-toolbox.html)，但这种方法似乎并不常见。

* * *

## 回答 #9

> 赞同：0
> 
> 时间：2009-04-20T16:56:56.467

除了 Uri 的回答（我完全支持），我想建议您考虑在 data.xml 中定义属性映射。这将使您的程序非常灵活，并且会排除很多您甚至没有意识到您不需要的代码。

例如，一个属性可以知道它绑定到屏幕上的哪个字段，它绑定到数据库中的哪个字段，当属性更改时要执行的操作列表（重新计算命中百分比可能适用于强度和 dex... )

这样做，您没有每个属性的代码来将类写入数据库或将其显示在屏幕上。您只需遍历属性并使用其中存储的信息。

同样的事情也适用于技能——事实上，属性和技能可能来自同一个基类。

走上这条路之后，你可能会发现自己有一个非常严肃的文本文件来定义属性和技能，但添加新技能就像这样简单：

```
Skill: Weaving
  DBName: BasketWeavingSkill
  DisplayLocation: 102, 20  #using coordinates probably isn't the best idea.
  Requires: Int=8
  Requires: Dex=12
  MaxLevel=50 
```

在某些时候，添加这样的技能不需要任何代码更改，这一切都可以很容易地在数据中完成，并且所有数据都存储在附加到类的单个技能对象中。当然，您可以以相同的方式定义操作：

```
Action: Weave Basket
  text: You attempt to weave a basket from straw
  materials: Straw
  case Weaving < 1
    test: You don't have the skill!
  case Weaving < 10
    text: You make a lame basket
    subtract 10 straw
    create basket value 8
    improve skill weaving 1%
  case Weaving < 40
    text: You make a decent basket
    subtract 10 straw
    create basket value 30
    improve skill weaving 0.1%
  case Weaving < 50
    text: You make an awesome basket!
    subtract 10 straw
    create basket value 100
    improve skill weaving 0.01%
  case Weaving = 50
    text: OMG, you made the basket of the gods!
    subtract 10 straw
    create basket value 1000 
```

虽然这个例子非常先进，但你应该能够想象它是如何在完全没有代码的情况下完成的。想象一下，如果你的“属性/技能”实际上是成员变量，那么在没有代码的情况下做这样的事情会有多困难。

* * *

## 回答 #10

> 赞同：0
> 
> 时间：2009-04-22T17:11:32.793

Consider using a "modeling" framework, such as Eclipse's EMF. This involves defining your objects using something like Eclipse EMF editor, or in plain XML, or in Rational Rose. It's not as difficult as it sounds. You define attributes, constraints etc. Then the framework generates the code for you. It adds @generated tags to parts it added such as getter and setter methods. You can customize the code, and later edit it either by hand or via some GUI, and regenerate the java files.

# php - cakephp isAuthorized() 没有被调用

> ID：768785
> 
> 赞同：5
> 
> 时间：2009-04-20T15:30:39.870
> 
> 标签：php, authentication, cakephp

我正在尝试使用 isAuthorized() 方法来检查管理员标志，但该函数似乎从未被调用。即使我将函数设置为始终返回 false，它也允许任何用户。似乎它没有被调用。

除了设置 $this->Auth->authorize = 'controller' 之外，我还需要做些什么吗？

来自 /app/app_controller.php

```
class AppController extends Controller
{

var $components = array('Auth');

function beforeFilter()
{
    $this->Auth->loginAction = array('controller' => 'users', 'action' => 'login');
    $this->Auth->loginRedirect = array('controller' => 'pages', 'display' => 'home');
    $this->Auth->logoutRedirect = '/';
    $this->Auth->authorize = 'controller';
    $this->Auth->userScope = array('User.active' => 1);
}

function isAuthorized()
{
    if (strpos($this->action, "admin_") != false)
    {
        if ($this->Auth->user('isAdmin') == '0')
        {
            return false;
        }
    }
    return true;
}
} 
```

* * *

## 回答 #1

> 赞同：12
> 
> 时间：2009-04-20T17:01:08.280

您应该检查是否覆盖了其他控制器中的 Auth 设置。

首先，要验证`isAuthorized()`是否被调用，请尝试在其中放入一个简单`debug($this); die;`的。

如果它没有死，你可能会在其他控制器中覆盖它（你错过了`parent::isAuthorized()`调用）。

如果不是这样，那么您可能正在使用`beforeFilter()`.

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2011-12-01T09:46:10.893

除了 Hannibal Lecter 博士的回答之外，如果您遇到此问题，还有另一个可能的原因（就像我一样......）：

如果您的控制器名为**tests_controller**，则 Auth-Component 的 startUp 方法会在不启动身份验证的情况下中止（至少在 cakePHP 1.3.10 中 - 尚未检查 2.x）。因此，请确保您**永远不要将控制器命名为 tests_controller** ...

摘自 cake\libs\controller\components\auth.php

```
function startup(&$controller) {
    $isErrorOrTests = (
        strtolower($controller->name) == 'cakeerror' ||
        (strtolower($controller->name) == 'tests' && Configure::read() > 0)
    );
    if ($isErrorOrTests) {
        return true;
    }
... 
```

* * *

## 回答 #3

> 赞同：-4
> 
> 时间：2009-04-20T15:43:31.477

您需要确保“Auth”在该控制器的组件数组中：

```
$this->components[] = 'Auth'; 
```

将它放在构造函数中，它应该可以工作（当然，除非它没有）。祝你好运！

# c# - Pocket IE 抛出 ODBC 错误，但桌面浏览器不会

> ID：768790
> 
> 赞同：1
> 
> 时间：2009-04-20T15:31:14.767
> 
> 标签：c#, asp.net, internet-explorer, mobile

我有一个相当简单的 CRUD Web 应用程序 (C#/ASP.NET)，它在 Firefox、IE7 和 Chrome 中运行良好。（我正在我们的开发服务器上访问和测试应用程序。）

当我通过 Pocket PC 设备连接到开发站点并执行完全相同的步骤时，我收到一个 ODBC 错误。不幸的是，当我单步执行代码时（再一次，在我的桌面上），我无法复制错误。相同的环境，不同的浏览器。所有代码都是服务器端的，所以我不知道为什么我会得到不同的结果。

我已经用 Pocket PC 模拟器运行了代码，它运行良好。只有当我通过实际设备访问该站点时才会发生这种情况。我有类似的页面，访问在 Pocket PC 设备上没有此问题的同一个 ODBC 数据库。

有人见过这样的东西吗？我难住了。

编辑：这是 ODBC 错误的文本。错误代码“38121”指的是无效的订单号，即使我确定订单号不是无效的。（我在桌面上使用与手持设备上相同的订单号。）如果需要，我也可以发布堆栈跟踪。

****错误 [HY000] [CA][IDMS ODBC 驱动程序][IDMS]DB001075 C-4M321：过程 LOEPU041 异常 38121 ?**

双重编辑：将其归结为用户错误。数据库要求所有参数都以大写形式输入。在我的机器上，我习惯于输入全部大写的订单号。由于掌上电脑的键盘很糟糕，我总是用小写字母输入。一个简单的 ToUpper() 修复了它。天哪，我觉得自己很笨。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2009-04-20T15:41:55.850

*   检查在请求处理程序中是否按预期提交了值

*   检查值是否正确传递给数据库语句

*   实施服务器端错误记录/跟踪

*   记住错误消息的文本

# awk - 任何人都知道如何在 Windows 上制作一个独立的 Awk/Gawk 程序

> ID：768793
> 
> 赞同：1
> 
> 时间：2009-04-20T15:31:51.943
> 
> 标签：awk, executable, gawk

我正在使用 awk 脚本进行一些相当繁重的解析，这些解析可能在未来重复使用，但我不确定我对 unix 不友好的同事是否愿意安装 awk/gawk 来进行解析. 有没有办法从我的脚本创建一个独立的可执行文件？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-04-20T15:37:46.250

据我所知，Cygwin Toolkit 中有一个独立的 awk.exe。

您可以将其与您分发给同事的任何文件捆绑在一起。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-10-14T07:16:56.013

我不知道使用 AWK 制作自包含二进制文件的方法。但是，如果您喜欢 AWK，那么您可能会喜欢 Python，并且有多种方法可以制作自包含的 Python 程序。例如，[Py2Exe](http://www.py2exe.org/)。

这是 Python 的一个简单示例：

```
# comments are introduced by '#', same as AWK

import re  # make regular expressions available

import sys  # system stuff like args or stdin

# read from specified file, else read standard input
if len(sys.argv) == 2:
    f = open(sys.argv[1])
else:
    f = sys.stdin

# Compile some regular expressions to use later.
# You don't have to pre-compile, but it's more efficient.
pat0 = re.compile("regexp_pattern_goes_here")
pat1 = re.compile("some_other_regexp_here")

# for loop to read input lines.
# This assumes you want normal line separation.
# If you want lines split on some other character, you would
# have to split the input yourself (which isn't hard).
# I can't remember ever changing the line separator in my AWK code...
for line in f:
    FS = None  # default: split on whitespace
    # change FS to some other string to change field sep
    words = line.split(FS)

    if pat0.search(line):
        # handle the pat0 match case
    elif pat1.search(line):
        # handle the pat1 match case
    elif words[0].lower() == "the":
        # handle the case where the first word is "the"
    else:
        for word in words:
            # do something with words 
```

与 AWK 不同，但易于学习，实际上比 AWK 更强大（该语言具有更多功能，并且有许多“模块”可以导入和使用）。Python没有像

```
/pattern_goes_here/ {
    # code goes here
} 
```

AWK 中的功能，但您可以简单地拥有一个 if/elif/elif/else 链，其中包含要匹配的模式。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-04-20T15:34:53.933

它必须是自给自足的吗？您可以编写一个小的可执行文件，该可执行文件将使用正确的参数调用 awk 并将结果通过管道传输到用户选择的文件或标准输出 - 无论哪个适合您的同事。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2009-04-20T15:55:40.793

GnuWin32 中的 MAWK — [http://gnuwin32.sourceforge.net/packages/mawk.htm](http://gnuwin32.sourceforge.net/packages/mawk.htm)

另一个有趣的替代方案，Java 实现 — [http://sourceforge.net/projects/jawk/](http://sourceforge.net/projects/jawk/)

# c# - 将日志记录添加到 asp.net 动态数据应用程序

> ID：768804
> 
> 赞同：2
> 
> 时间：2009-04-20T15:32:51.223
> 
> 标签：c#, asp.net, logging, dynamic-data

我试图找出将日志记录添加到动态数据应用程序的最佳方法是什么？我将 DD 用于管理界面，我需要记录用户所做的所有操作。例如，我想在 PageTemplates\ListDetails 的代码隐藏中添加一些东西，但想知道是否有更好的方法......对于数据访问，我正在使用带有 Sqlite 的实体框架。

很感谢任何形式的帮助！

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-04-22T08:25:44.807

如果您希望将用户信息添加到审计跟踪中，您可以执行以下两项操作之一：

1.  在您的数据库中使用 SPROCS 进行 CRUD 操作并传入用户信息
2.  以部分类的形式将业务逻辑添加到您的模型中

请参阅链接： [如何：在保存更改时执行业务逻辑（实体框架）](https://login.live.com/login.srf?wa=wsignin1.0&rpsnv=10&checkda=1&ct=1240388641&rver=5.5.4177.0&wp=MCLBI&wlcxt=msdn%24msdn%24msdn&wreply=http:%2F%2Fmsdn.microsoft.com%2Fen-us%2Flibrary%2Fcc716714.aspx&lc=1033&id=254354) [如何使用 ADO.NET 实体框架映射存储过程](http://blogs.msdn.com/adonet/archive/2007/09/14/how-to-map-stored-procedures-using-the-ado-net-entity-framework.aspx)

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-04-20T15:37:35.253

您可以尝试使用 Enterprise Library Logging Block。

[http://www.codeproject.com/KB/architecture/GetLoggingWithEntLib.aspx](http://www.codeproject.com/KB/architecture/GetLoggingWithEntLib.aspx)

[http://msdn.microsoft.com/en-us/library/cc309506.aspx](http://msdn.microsoft.com/en-us/library/cc309506.aspx)

# zedgraph - 用 Zedgraph 重新映射鼠标控件？

> ID：768810
> 
> 赞同：4
> 
> 时间：2009-04-20T15:33:45.637
> 
> 标签：zedgraph

我正在使用 ZedGraph，我想通过`Ctrl`用鼠标左键按住并拖动框而不是用鼠标中键单击并拖动来缩放到选定区域。

默认行为是仅使用鼠标左键进行缩放并使用鼠标中键进行平移，但我已经切换了这两个操作。

有谁知道如何通过单击并使用左键拖动（不按住Ctrl）来调用平移并通过按住`Ctrl`然后单击并使用左键拖动来调用缩放？

* * *

## 回答 #1

> 赞同：10
> 
> 时间：2009-04-21T16:30:55.787

ZedGraphControl 允许通过控件的属性控制平移和缩放。仅使用鼠标左键启用平移：

```
zg1.PanButtons = MouseButtons.Left;
zg1.PanModifierKeys = Keys.None; 
```

并使用 Ctrl+鼠标左键启用缩放：

```
zg1.ZoomButtons = MouseButtons.Left;
zg1.ZoomModifierKeys = Keys.Control; 
```

设计器属性窗口似乎不想让您只为修饰键指定 Control，因此您必须将其放入代码中 - 例如 Form 的 Load 事件处理程序。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-04-21T14:59:29.000

你有没有通过代码尝试使用：

zg.GraphPane.XAxis.Scale.Min = xxxx;
zg.GraphPane.XAxis.Scale.Max = yyyy;

//和

zgc.ScrollGrace = 0.1;

# apache-flex - Flex：以编程方式展开 AdvancedDataGrid 树列

> ID：768812
> 
> 赞同：3
> 
> 时间：2009-04-20T15:34:14.637
> 
> 标签：apache-flex, tree, advanceddatagrid

有谁知道如何以编程方式扩展 Flex 中 AdvancedDataGrid 树列的节点？如果我使用的是一棵树，我会使用这样的东西：

```
dataGrid.expandItem(treeNodeObject, true); 
```

但我似乎无权访问 AdvancedDataGrid 中的此属性。

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2009-04-20T16:09:22.837

AdvancedDataGrid 也有一个 expandItem() 方法：

[http://livedocs.adobe.com/flex/3/langref/mx/controls/AdvancedDataGrid.html#expandItem()](http://livedocs.adobe.com/flex/3/langref/mx/controls/AdvancedDataGrid.html#expandItem())

* * *

## 回答 #2

> 赞同：5
> 
> 时间：2009-04-20T16:21:41.340

复制在上述 url 中找到的示例并调用此函数：

```
private function openMe():void
{
    var obj:Object = gc.getRoot();
    var temp:Object = ListCollectionView(obj).getItemAt(0);
    myADG.expandItem(temp,true);
} 
```

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2009-04-20T19:23:48.047

您还可以通过使用游标遍历 dataProvider 来打开节点。以下是我在指定级别打开所有节点的方法：

```
 private var dataCursor:IHierarchicalCollectionViewCursor;

    override public function set dataProvider(value:Object):void
    {
        super.dataProvider = value;

        /* The dataProvider property has not been updated at this point, so call 
            commitProperties() so that the HierarchicalData value is available. */
        super.commitProperties();

        if (dataProvider is HierarchicalCollectionView)
            dataCursor = dataProvider.createCursor();
    }

    public function setOpenNodes(numLevels:int = 1):void
    {
        dataCursor.seek(CursorBookmark.FIRST);

        while (!dataCursor.afterLast)
        {
            if (dataCursor.currentDepth < numLevels)
                dataProvider.openNode(dataCursor.current);
            else
                dataProvider.closeNode(dataCursor.current);

            dataCursor.moveNext();
        }

        dataCursor.seek(CursorBookmark.FIRST, verticalScrollPosition);

        // Refresh the data provider to properly display the newly opened nodes
        dataProvider.refresh();
    } 
```

* * *

## 回答 #4

> 赞同：2
> 
> 时间：2012-09-25T13:28:42.147

想在这里补充一点，尽管 AdvancedDataGrid 有一个`expandAll()`方法，但它有一个名为 的属性`displayItemsExpanded`，设置为`true`将展开所有节点。

为了扩展特定的孩子，可以使用`expandChildrenOf()`和`expandItem()`方法，这可以从上面给出的链接中验证。

# asp.net - 在中继器控件中实现功能链接

> ID：768818
> 
> 赞同：3
> 
> 时间：2009-04-20T15:35:34.993
> 
> 标签：asp.net, repeater

我正在我的 Web 应用程序中实现一个中继器来显示数据。我想在类似于 GridView 中的内置功能的列中添加功能操作链接。任何人都可以给我所需的步骤吗？我假设我将为每一行添加一个 LinkBut​​ton 控件，以某种方式将 OnClick 事件处理程序设置为指向相同的方法，并以某种方式将行上的唯一标识符作为参数传递。

谢谢！

* * *

## 回答 #1

> 赞同：8
> 
> 时间：2009-04-20T15:53:56.540

我猜这就是你想要的。

```
 <asp:Repeater ID="rpt" runat="server">
        <ItemTemplate>
            <asp:LinkButton ID="lbtn" runat="server" OnCommand="lbtn_Command" 
            CommandArgument='<%# DataBinder.Eval(Container.DataItem, "KeyIDColumn") %>' ></asp:LinkButton>
        </ItemTemplate>
    </asp:Repeater> 
```

然后在你的代码后面

```
protected void lbtn_Command(object sender, CommandEventArgs e)
{
    int id = Convert.ToInt32(e.CommandArgument);
} 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-04-20T15:39:01.723

使用链接按钮。这样，您可以在后面的代码中处理 OnClick 事件。

* * *

## 回答 #3

> 赞同：-1
> 
> 时间：2009-04-20T15:46:32.813

首先，您将在标记中设置链接按钮的 onclick。然后，您需要为转发器实现 ItemDataBound 事件。

```
 if (e.Item.ItemType == ListItemType.Item || e.Item.ItemType == ListItemType.AlternatingItem)
    {
         SomeObject obj = e.Item.DataItem as SomeObject; // w/e type of item you are bound to
         var linkButton = e.Item.FindControl("linkButtonId") as LinkButton;
         if(linkButton != null)
         {
              //either set a custom attribute or maybe append it on to the linkButton's ID
              linkButton.Attributes["someUniqueId"] = obj.SomeID;
         }
    } 
```

然后在点击事件中

```
void lb_Click(object sender, EventArgs e)
{
    LinkButton lb = sender as LinkButton;
    if (lb != null)
    {
        // obviously do some checking to ensure the attribute isn't null
        // and make it the correct datatype.
        DoSomething(lb.Attributes["someUniqueId"]);
    }
} 
```

# ruby - 如何优化这段 ruby 代码以更快地运行？

> ID：768821
> 
> 赞同：3
> 
> 时间：2009-04-20T15:37:28.093
> 
> 标签：ruby, optimization

[它是埃拉托色尼筛法](http://en.wikipedia.org/wiki/Sieve_of_Eratosthenes)的一个实现。

```
class PrimeGenerator
  def self.get_primes_between( x, y)
    sieve_array = Array.new(y) {|index|
      (index == 0 ? 0 : index+1)
    }

    position_when_we_can_stop_checking = Math.sqrt(y).to_i
    (2..position_when_we_can_stop_checking).each{|factor|
      sieve_array[(factor).. (y-1)].each{|number|
        sieve_array[number-1] = 0 if isMultipleOf(number, factor)
      }
    }

    sieve_array.select{|element| 
      ( (element != 0) && ( (x..y).include? element) )
    }
  end
  def self.isMultipleOf(x, y)
    return (x % y) == 0
  end
end 
```

现在我这样做是为了“提交问题的解决方案，因为你有时间杀死”网站。我选择 ruby​​ 作为我的 impl 语言。但是我被宣布超时。我做了一些基准测试

```
require 'benchmark'
Benchmark.bmbm do |x|
  x.report ("get primes") { PrimeGenerator.get_primes_between(10000, 100000)}
  end 
```

ruby 1.9.1p0（2009-01-30 修订版 21907）[i386-mswin32]

```
L:\Gishu\Ruby>ruby prime_generator.rb
Rehearsal ----------------------------------------------
get primes  33.953000   0.047000  34.000000 ( 34.343750)
------------------------------------ total: 34.000000sec

                 user     system      total        real
get primes  33.735000   0.000000  33.735000 ( 33.843750) 
```

ruby 1.8.6 (2007-03-13 补丁级别 0) [i386-mswin32]

```
Rehearsal ----------------------------------------------
get primes  65.922000   0.000000  65.922000 ( 66.110000)
------------------------------------ total: 65.922000sec

                 user     system      total        real
get primes  67.359000   0.016000  67.375000 ( 67.656000) 
```

所以我在 C# 2.0 / VS 2008 --> **722 毫秒中重做了这件事**

所以现在这促使我思考这是我的实现有问题还是语言之间的性能差异如此之大？（我对 1.9 Ruby VM 感到惊讶……直到我不得不将它与 C# 进行比较：）

**更新：** 毕竟是我的“put-eratosthenes-to-shame-adaptation” :)**消除不必要的循环迭代**是主要的优化。如果有人对细节感兴趣..你可以在[这里](http://madcoderspeak.blogspot.com/2009/04/i-wrote-up-small-program-to-find-prime.html)阅读；无论如何，这个问题太长了。

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2009-04-20T16:18:20.023

我会先看看你的内循环。`sieve_array[(factor).. (y-1)]` 每次执行时都会创建一个新数组。相反，请尝试用正常的索引循环替换它。

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2009-04-20T16:59:29.283

显然，每台计算机都会以不同的方式进行基准测试，但我能够通过使用 each 块删除数组上的循环，并通过检查内部循环，使我的机器（Ruby 1.8.6）上的运行速度提高大约 50 倍更少的数字。

```
factor=2
while factor < position_when_we_can_stop_checking 
    number = factor
    while number < y-1
      sieve_array[number-1] = 0 if isMultipleOf(number, factor)
      number = number + factor; # Was incrementing by 1, causing too many checks
    end
  factor = factor +1
end 
```

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2009-04-20T15:54:40.033

埃拉托色尼筛法可以很好地作为寻找素数的说明性方法，但我会稍微不同地实现它。本质是您不必检查已知素数的倍数的数字。现在，除了使用数组来存储这些信息，您还可以创建一个包含所有连续素数的列表，直到您要检查的数字的平方根，然后通过素数列表来检查素数就足够了。

如果您考虑一下，这将执行您在图像上所做的操作，但是以更“虚拟”的方式。

**编辑：**快速破解我的意思（不是从网上复制的；））：

```
 public class Sieve {
    private readonly List<int> primes = new List<int>();
    private int maxProcessed;

    public Sieve() {
      primes.Add(maxProcessed = 2); // one could add more to speed things up a little, but one is required
    }

    public bool IsPrime(int i) {
      // first check if we can compare against known primes
      if (i <= primes[primes.Count-1]) {
        return primes.BinarySearch(i) >= 0;
      }
      // if not, make sure that we got all primes up to the square of i
      int maxFactor = (int)Math.Sqrt(i);
      while (maxProcessed < maxFactor) {
        maxProcessed++;
        bool isPrime = true;
        for (int primeIndex = 0; primeIndex < primes.Count; primeIndex++) {
          int prime = primes[primeIndex];
          if (maxProcessed % prime == 0) {
            isPrime = false;
            break;
          }
        }
        if (isPrime) {
          primes.Add(maxProcessed);
        }
      }
      // now apply the sieve to the number to check
      foreach (int prime in primes) {
        if (i % prime == 0) {
          return false;
        }
        if (prime > maxFactor) {
          break;
        }
      }
      return true;
    }
  } 
```

在我的慢速机器上使用大约 67 毫秒.... 测试应用程序：

```
class Program {
    static void Main(string[] args) {
        Stopwatch sw = new Stopwatch();
        sw.Start();
        Sieve sieve = new Sieve();
        for (int i = 10000; i <= 100000; i++) {
            sieve.IsPrime(i);
        }
        sw.Stop();
        Debug.WriteLine(sw.ElapsedMilliseconds);
    }
} 
```

* * *

## 回答 #4

> 赞同：2
> 
> 时间：2009-04-20T17:02:20.290

我不知道它的速度比较，但这是一个相当小且简单的 SoE 实现，对我来说很好用：

```
def sieve_to(n)
  s = (0..n).to_a
  s[0]=s[1]=nil
  s.each do |p|
    next unless p
    break if p * p > n
    (p*p).step(n, p) { |m| s[m] = nil }
  end
  s.compact
end 
```

可能还有一些进一步的小加速，但我认为它非常好。

它们并不完全相同，因此您的 10_000 到 1_000_000 将等同于

```
sieve_to(1_000_000) - sieve_to(9_999) 
```

或非常近似的东西。

无论如何，在 WinXP 上，使用 Ruby 1.8.6（和相当大的 Xeon CPU）我得到了这个：

```
require 'benchmark'
Benchmark.bm(30) do |r|
  r.report("Mike") { a = sieve_to(10_000) - sieve_to(1_000) } 
  r.report("Gishu") { a = PrimeGenerator.get_primes_between( 1_000, 10_000) }
end 
```

这使

```
 user     system      total        real
Mike                            0.016000   0.000000   0.016000 (  0.016000)
Gishu                           1.641000   0.000000   1.641000 (  1.672000) 
```

（我停止运行 100 万个案例，因为我厌倦了等待）。

所以我会说这是你的算法。;-)

不过，C# 解决方案几乎可以保证速度快几个数量级。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2009-04-20T16:24:40.943

我还要注意，根据我的经验，Ruby 在 Windows 系统上比在 *nix 上慢得多。当然，我不确定你有什么速度的处理器，但是在我的 Ubuntu 机器上用 Ruby 1.9 运行这段代码大约需要 10 秒，而 1.8.6 需要 30 秒。

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2009-04-20T16:31:25.590

用 ruby​​-prof 对其进行基准测试。它可以吐出诸如 kcachegrind 之类的工具可以查看的内容，以查看您的代码在哪里运行缓慢。

然后，一旦您使 ruby​​ 变得快速，请使用 RubyInline 为您优化方法。

# asp.net-mvc - UrlHelper 扩展方法调用编码未执行

> ID：768828
> 
> 赞同：2
> 
> 时间：2009-04-20T15:39:00.240
> 
> 标签：asp.net-mvc, extension-methods, urlhelper

我为 ASP.NET MVC UrlHelper 创建了一个简单的扩展方法。它不接受任何参数，因为它的工作是从配置中查找样式表文件的名称并将 URL 返回到样式表。扩展方法大致如下：

```
public static string SiteStylesheet(this UrlHelper urlHelper)
{
    var scriptFilename = UserInterfaceConfiguration.GetSection()
                             .Mvc.SiteStylesheet;
    return urlHelper.Content(string.Format("~/Assets/Scripts/{0}",
                                           scriptFilename));
} 
```

我像这样使用它：

```
<link href="<%= Url.SiteStylesheet() %>" rel="Stylesheet" type="text/css" /> 
```

但是，该方法没有被执行，并且呈现以下内容：

```
href="../Views/Shared/%3C%25=%20Url.SiteStylesheet()%20%25%3E" 
```

正如你所看到的，扩展方法没有被执行，而整个事情只是被编码了。如果我更改方法签名以接受参数：

```
public static string SiteStylesheet(this UrlHelper urlHelper, string dummy) 
```

然后执行扩展方法，输出如预期：

```
href="/Assets/Stylesheets/FluidCMS.css" 
```

那么我的问题是这是设计使然，还是 ASP.NET MVC Web 窗体视图引擎中的错误？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2009-04-20T17:16:06.343

当我遇到这个问题时，是因为我的扩展方法位于 web.config 中未指定的命名空间中。

```
<add namespace="Your.Extension.Method.Namespace"/> 
```

它在 configuration\system.web\pages\namespaces 下

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2009-07-22T18:11:02.173

这个问题已经出现过很多次了。问题的根源在于 <head> 标记具有 runat="server"，这导致解析器将标记视为服务器标记。

最简单的解决方法是从 head 标记中删除 runat="server"。您失去的是使链接 URL 相对于当前页面的逻辑，但是由于您无论如何都在使用帮助程序，因此您不需要这样做。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-04-28T14:28:05.090

我想你发现了一个错误！

我试过了，发现这只发生在母版页的头部，并且只发生在`<link>`标签中（`<script>`标签渲染得很好）。

问题显然是 de href 属性中的文本未正确解释为代码块。

这超越了 ASP.NET MVC。我在一个经典的 Web 窗体 ASP.NET 站点的母版页中尝试了它，但问题仍然存在。这似乎是 Web 窗体渲染引擎中的错误或类似的东西。

# apache-flex - 重新创建 Flex 3 场景

> ID：768830
> 
> 赞同：0
> 
> 时间：2009-04-20T15:39:47.960
> 
> 标签：apache-flex, flex3, state

有谁知道我如何重置/重新初始化 flex 3 中的状态？

假设我有以下代码：

```
<mx:states>
    <mx:State name="Scene1">
        <mx:AddChild>
            <Scenes:Scene1 id="scene1"></Scenes:Scene1>
        </mx:AddChild>
    </mx:State>
    <mx:State name="Scene2">
        <mx:AddChild>
            <Scenes:Scene2 id="scene2" models="{models}"></Scenes:Scene2>
        </mx:AddChild>
    </mx:State>
</mx:states> 
```

每次我从 1 到 2 或 2 到 1 时，我都不想重新创建整个状态。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2009-04-20T16:00:15.370

我不确定这是您要查找的内容，但是此代码将呈现您在上面定义的状态：

```
// this shows Scene1
this.currentState = "Scene1";

// this shows Scene2
this.currentState = "Scene2"; 
```

那是你要找的吗？

# c# - .NET：关于 AssemblyVersion，什么定义了二进制兼容性？

> ID：768832
> 
> 赞同：8
> 
> 时间：2009-04-20T15:40:22.920
> 
> 标签：c#, .net, clr, gac

对强名称程序集进行哪些更改需要更改 AssemblyVersionAttribute？显然，以可能需要客户端必须进行代码更改的方式更改公共 api 需要增加 AssemblyVersion。但是对于不需要在客户端更改代码的公共 API 的更改呢？例如：

*   添加公共类或接口？
*   将公共成员添加到公共类或接口？（编辑：drscroogemcduck 在下面正确指出，将成员添加到接口会影响所有实现者。愚蠢的我。）
*   增加班级成员的知名度？

在 MSDN 上的某个地方（或者，知道 MS，在一些 MSSE 的个人博客上）必须有明确的文档。但我根本找不到它。请帮忙！

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2013-04-16T21:10:25.487

回应 Martijn 的赏金：

关于二进制兼容性的最佳参考资料在社区 Wiki 上。

[.NET 中 API 破坏性更改的明确指南](https://stackoverflow.com/questions/1456785/a-definite-guide-to-api-breaking-changes-in-net)

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2009-04-20T15:43:10.230

这很容易......只要类型保持不变（在其公共或受保护的布局中）并且方法签名没有改变（添加方法或类型很好），JIT 应该能够很好地链接 DLL。

也就是说，我认为即使它*确实*有效，你*也不应该这样*做。如果需要，制作一个新版本并使用策略将旧版本映射到新版本。否则，您会直接将自己带回 DLL 地狱……而且我很确定您不希望这样。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2009-04-20T15:52:38.087

向接口添加方法不应该是好的，因为旧的提供者不会实现新方法。

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2012-05-30T03:55:31.323

Microsoft 在服务包版本中的 .NET 库中添加了新方法/类，而不会更改 AssemblyVersion（仍然是 2.0.0.0 / 3.0.0.0）。Microsoft 仅更改 AssemblyFileVersion。例如，在 .NET 2.0 SP1 中，添加了 DateTimeOffset 结构。

是否应该向我们推荐这种做法，因为 Microsoft 这样做？这令人困惑。

# c# - 如何计算两个日期时间之间的月数？

> ID：768835
> 
> 赞同：2
> 
> 时间：2009-04-20T15:41:25.290
> 
> 标签：c#, datetime

要求：

*   计算两个日期之间的月数：receiveDate 和 dueDate。
*   乐观和悲观的计算都需要

假设：

*   dueDate 将始终是该月的最后一天。

我已经算出了悲观的计算方法（意思是逾期一天算一整月：

```
if(receiveDate > dueDate)
    receiveDate.Month - dueDate.Month + (receiveDate.Year - dueDate.Year) * 12; 
```

在互联网上进行搜索发现了几个类似的例子来证实这一点。

现在，我的直觉告诉我，乐观的计算结果将是一样的减去一个月，但由于某种原因，它感觉不对。我是在正确的轨道上还是我错过了什么？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-04-20T15:47:29.083

你是对的; 如果您正在寻找两个日期之间的*完整*`receiveDate`月数，则减去 1（假设不属于该月的最后一天，在这种情况下，您将有 0 天的余数）将得到您您的答案。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-04-20T15:46:25.903

如果您不需要在微积分中保留月份中的几天，我认为这是要走的路。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-05-22T16:07:42.680

您的公式计算从 receivedDate 月份的第一个月到 dueDate 月份的第一个月之间的月数。由于 TimeSpan 中的大多数时间元素都表示为 TotalXXX，因此它们省略了 TotalMonths 和 TotalYears 似乎很奇怪。

我认为这是因为每个月没有固定的天数，所以很难知道在如何表达小数余数方面什么最有意义。

我的公式是这样的...

```
 int nMonthDiff_FirstToFirst = DateTime.Now.Month - testDate.Month + ((DateTime.Now.Year - testDate.Year)* 12);

double dMonthDiff = (double)nMonthDiff_FirstToFirst + (DateTime.Now - testDate.AddMonths(nMonthDiff_FirstToFirst)).TotalDays / (double)DateTime.DaysInMonth(DateTime.Now.Year, DateTime.Now.Month); 

```

所以我所做的基本上是像你一样得到月差（月初到月初），然后我将 testDate 按月差预测到未来。然后用那个 TimeSpan 我得到 TotalDays 并将其除以该月的天数。因此，我代表的是当月剩余天数的小数部分。

因此，如果您要在 2012 年 5 月 5 日 -> 2012 年 6 月 3 日进行，那么当还没有整整一个月时，您的公式将返回 1 表示月差。在我的公式中，预计日期的 TotalDays 将产生负的小数天数，并且当添加到“第一个月到第一个月”的差异时，它会根据需要进行计算。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2013-11-12T08:59:07.377

我正在做这个额外的检查以获得准确的月份数：

numberOfMonths = receiveDate.Month - dueDate.Month + (receiveDate.Year - dueDate.Year) * 12; if (receiveDate.Day > dueDate.Day) numberOfMonths--;

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2016-06-07T10:53:32.490

```
int GetMonthsCount(DateTime dtStart, DateTime dtEnd)
{
    return (int)Math.Round((dtEnd - dtStart).TotalMonths);
} 
```

# delphi - 印地 9 和印地 10 有什么区别？

> ID：768836
> 
> 赞同：3
> 
> 时间：2009-04-20T15:41:55.180
> 
> 标签：delphi, delphi-2007, indy

我负责将 Delphi 2007 应用程序移植到 C#，并且完全没有使用 Delphi 的经验。我想知道 Delphi 包括的两个 Indy 版本之间有什么区别 - Indy 9 和 Indy 10。此时我什至不知道 Indy 是什么。有人可以帮我吗？它们只是 Delphi 库的不同版本吗？使用其中一种有何影响？

谢谢！

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2009-04-20T15:51:29.180

Indy 是 Internet Direct 的缩写，它是一个用于网络的开源库。它最常用于做与互联网相关的事情，比如发送电子邮件等。

如果您从使用 Indy 8 或 9 的旧版（例如 Delphi 7）应用程序移植，您会发现在 Delphi 2007 中使用 Indy 9 将是一个更容易的移植。***如果您不在乎***，请使用 Indy 10，因为它对库进行了许多重大改进，并且还有一些重大的架构更改。

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2009-04-20T15:51:11.460

查看 Indy 10 文档，特别是*Indy.Sockets 版本 10 中的新增功能*和*对象层次结构的更改部分*

[http://www.indyproject.org/docsite/html](http://www.indyproject.org/docsite/html)

* * *

## 回答 #3

> 赞同：3
> 
> 时间：2009-04-20T17:32:58.797

Indy 是一个 winsock 包装器，它为网络/互联网编程（ftp、telnet、http 等）提供阻塞套接字行为。

Indy 10 是 Indy 9 的更新版本，虽然这些更改可能会改进架构，但它们删除了一些功能并移动了一些东西。如果您的程序使用了被移动或移除的部分，那么移植到 Indy 10 将会很痛苦。

如果您从 Delphi 迁移到 C#，那么您会发现 Indy 的 C# 版本与 Delphi 版本非常不同。至少当我看着它时。

* * *

## 回答 #4

> 赞同：3
> 
> 时间：2009-05-31T10:15:59.787

一些细节：

*   Indy10 在 D2005 中已经存在，尽管版本 D2005 和 D2006 允许选择安装哪一个。
*   .... 没关系，在任何情况下始终安装最新和最好的以获得最新的修复程序。
*   Indy10 内部比较好，但是因为他们拆分成几个模块，初学者手动编译时经常会遇到问题。Indy 开发人员的工作方式大致是强加给用户的，我认为回想起来这是不必要的，因为在实践中必须将所有包作为一个整体进行更新。
*   Indy10 是便携式的。indy9 Kylix 支持只不过是一种 hack。
*   两者都适用于 FPC/Lazarus，但 Indy9 仅适用于 win32。Indy10 也适用于 Unix、OS X、win64 和 wince。在 lazarus 上，Indy10 端口通常更好。
*   上次我用它做大量工作时，Indy10 的例子不如 indy9 的例子。
*   Indy10 陷入了 .NET 的泥潭，与 indy9 相比，零拷贝明显少得多。这在 Indy10 的一生中变得更糟。
*   Indy10 的一些最初目标（例如对非常高的连接数的光纤支持）没有实现。不过，随着（平均）可用内存的巨大增加，无论如何都需要重新评估对光纤的需求，而且我也不知道微软现在如何看待光纤。

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2009-04-20T15:44:35.000

Indy Delphi 是 Delphi 的一个库（Tcomponent），代表了 WinSock 的真正力量。它提供了用于 Tunelling、TCP/UDP 连接等等的组件。

官方页面是： http: [//www.indyproject.org](http://www.indyproject.org) 你会在那里找到你需要的一切。

Indy 9 是旧版本的 Indy 库。Indy 10 与 Delphi 2009 一起于 2008 年问世。图书馆的整个结构在 Indy 10 中发生了变化。

在我看来，印地9更好。

* * *

## 回答 #6

> 赞同：1
> 
> 时间：2013-03-28T18:22:31.247

[BorCon 2004 Programming Tracks](http://conferences.embarcadero.com/borcon2004/delphi)包括 Chad Hower 的一篇文章，升级[到 Indy 10](http://conferences.embarcadero.com/article/32160)。

> 摘要：本次会议涵盖了对 Indy 10 所做的更改以及如何快速移植现有代码。它还涵盖了 Indy 10 的优势以及为什么应该移植代码。虽然展示了性能和其他演示，但本次会议是一个实用的概述，并不关注演示代码。

内容：

*   升级到印地 10
*   印地 10 状态
*   安装并发版本
*   兼容性
*   移民
*   主要变化和增加

# c# - 正确使用对象属性

> ID：768841
> 
> 赞同：0
> 
> 时间：2009-04-20T15:43:16.533
> 
> 标签：c#, .net, oop, properties

下面是我创建的一个类，用于在我的美化数据输入和检索应用程序中跟踪当前人员。一旦他们选择了一个人，它就会调用构造函数，然后调用数据库来填写所有其余信息。此外，在整个计划中，他们将能够改变各个领域。

考虑到这一点，我是否正确设置了以下内容？我对属性和使用对象跨多种形式存储数据缺乏经验，我将不胜感激。

谢谢！

```
class CurrentPerson
{
    public string FirstName { get; set; }
    public string LastName { get; set; }
    public string MiddleName { get; set; }
    public string SuffixID { get; set; }
    public string TitleID { get; set; }
    public string SocialSn { get; set; }
    public string BirthDate { get; set; }
    public string Gender { get; set; }
    public string DlNumber { get; set; }
    public string DlStateID { get; set; }
    public string PrimaryRace { get; set; }
    public string SecondaryRace { get; set; }
    public string EmailAddress { get; set; }
    public string MaritalStatus { get; set; }
    public string InsertProgram { get; set; }
    public string InsertUserID { get; set; }
    public string UpdateProgram { get; set; }
    public string UpdateUserID { get; set; }
    public string LockID { get; set; }

    public int PersonID { get; set; }
    public int ClientID { get; set; }
    public int ResidencyCountyID { get; set; }
    public int ResponsibilityCountyID { get; set; }

    public bool HispanicOriginFlag { get; set; }
    public bool CitizenFlag { get; set; }
    public bool VeteranFlag { get; set; }

    public DateTime DeathDate { get; set; }
    public DateTime InsertDateTime { get; set; }
    public DateTime UpdateDateTime { get; set; }

    // Put the default Constructor back in
    public CurrentPerson(){}

    // Custom Constructor that needs the PersonID
    public CurrentPerson(int pID)
    {
        PersonID = pID;

        // Methods to get rest of data here
    }
} 
```

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2009-04-20T15:46:35.277

是的，看起来不错。顺便说一句，您也可以在 get/set 上设置访问权限，使其仅公开读/写

```
public DateTime DeathDate
{
    get;
    private set;
} 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-04-20T15:46:53.047

这在技术上很好。他们都被宣布得很好。

但是，通常，对于 DB 应用程序，您不希望使用自动属性，因为属性设置器通常是进行某些验证的好地方，并且可能将属性/对象标记为“脏”并需要进行某种保存。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2009-04-20T15:47:43.527

auto 属性始终是 get 和 set，因此您无法控制属性集（将实例标记为脏，或其他）。因此，虽然这是一个可接受的仅作为数据实体的类，但我通常发现自动属性很少真正适用。

# c++ - unicode 窗口中的非 unicode WM_CHAR

> ID：768844
> 
> 赞同：2
> 
> 时间：2009-04-20T15:43:34.333
> 
> 标签：c++, windows, winapi, dll, unicode

我编写了一个 DLL，它导出了一个使用`RegisterClassExW`和创建窗口的函数`CreateWindowExW`。每条消息都是通过

```
GetMessageW(&msg, wnd_handle, 0, 0);
TranslateMessage(&msg);
DispatchMessageW(&msg); 
```

还有一个加载DLL并调用函数的程序。

尽管使用 Unicode 窗口创建方法，`wParam`但`WM_CHAR`消息中的始终包含 ASCII 字符，即使我键入了一些非 ASCII 符号或使用 Alt+(code)。不是 UTF-16，而是`wParam`在 'A' 和 'z' 之间包含一些 ASCII 字符。这`WndProc`是 DLL 中的静态函数。

当所有与窗口相关的代码都在一个程序中时，不会出现此问题。

有没有办法`WM_CHAR`在 DLL 的窗口中始终包含 Unicode 消息？

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2009-05-22T19:36:09.123

问题出在消息检索过程中。我使用`GetMessage()`了我的窗口句柄而不是 0，`GetMessageW(&msg, wnd_handle, 0, 0)`而不是`GetMessageW(&msg, 0, 0, 0)`.
这样，`WM_INPUTLANGCHANGEREQUEST`消息被吞下，语言环境仍然是英语。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2009-04-30T21:56:38.380

您的方法似乎应该有效。

您是否有可能调用 ANSI DefWindowProc 而不是宽版本？这会将 a`WM_UNICHAR`转换为 ANSI`WM_CHAR`消息。也许这可以解释你所看到的。

作为一个实验，我会`WM_UNICHAR`直接处理这些消息，然后看看当时的数据是什么样子的。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-04-20T16:53:37.190

我不是 100% 确定，但它可能会有所帮助：

查看您实现调用 DLL 函数的代码的项目的设置。确保字符集也是 UNICODE，而不是多字节：

（转到项目属性，然后转到常规部分，并将字符集选项设置为“使用 Unicode 字符集”）。我假设您使用的是 Visual Studio 2003 或更高版本。

# c# - 需要帮助在 datagridview 中编辑多个单元格

> ID：768851
> 
> 赞同：1
> 
> 时间：2009-04-20T15:44:45.390
> 
> 标签：c#, datagridview, cell

我正在尝试支持在 datagridview 上编辑多个单元格。我几乎完成了，因为它在编辑完成后正确地将内容复制到其他单元格。我现在正在做的是捕获按下的第一个键。

当我只编辑一个单元格时，使用 EditOnKeystrokeOrF2 可以正常工作。However, when multiple cells are selected, I am capturing the Keydown event and manually calling BeginEdit. 但是，当我这样做时，按下的键不包含在编辑中。

我怎样才能将第一个键按到我的单元格中？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-04-20T19:23:38.377

我做了一些额外的实验，并找到了一种方法来实现这一点。这有点草率，但它确实有效。

```
private int _keyValue;
private Boolean _checkKeyValue = false;

private void Grid1_CellBeginEdit(object sender, DataGridViewCellCancelEventArgs e)
{
    DataGridViewCell cell = Grid1.Rows[e.RowIndex].Cells[e.ColumnIndex];

    if (_checkKeyValue)
    {
        _checkKeyValue = false;

        if (value != -1)
        {
            cell.Value = _keyValue;
        }
    }   
}

private void Grid1_KeyDown(object sender, KeyEventArgs e)
{
    if (Grid1.SelectedCells.Count > 1)
        {
            _checkKeyValue = true;
            _keyValue = (int)e.KeyValue;
            Grid1.BeginEdit(false);
        }
} 
```

通过注册 CellBeginEdit 事件，我可以将值放入其中。我对 _keyValue 进行了一些其他处理以使其成为一个数字，但这与其余部分无关。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-04-20T15:54:02.903

可能将密钥标记为未处理就足够了。

```
private void dataGridView_KeyDown(Object sender, KeyEventArgs keyEventArgs)
{
   keyEventArgs.Handled = false;
} 
```

# c++ - TinyXML：如何解析文件指针

> ID：768853
> 
> 赞同：0
> 
> 时间：2009-04-20T15:45:12.363
> 
> 标签：c++, tinyxml

我正在尝试将文件指针popen 的输出连接到TinyXML 的输入。

根据主页，最好的方法是使用 parse 方法：

```
C style input:

    * based on FILE*
    * the Parse() and LoadFile() methods 
```

我相信我需要使用 TIXML_USE_STL 来实现这一点。我该如何寻找示例并导入它？

删除后的回复指出我在文档上的正确方向

[http://www.grinninglizard.com/tinyxmldocs/index.html](http://www.grinninglizard.com/tinyxmldocs/index.html)

谢谢。

现在，我只需要弄清楚如何链接和导入它。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-04-20T15:48:21.967

我对 TinyXML 不是很熟悉，但是`LoadFile()`在它的重载版本中不起作用，它需要一个`FILE *`?

[http://www.grinninglizard.com/tinyxmldocs/classTiXmlDocument.html#a12](http://www.grinninglizard.com/tinyxmldocs/classTiXmlDocument.html#a12)

**编辑：**啊，问题是 TinyXML 不支持从流中读取（参见上面的链接）。然后，您唯一的选择是将流手动读入缓冲区并将其传递给 TinyXML 的`Parse()`.

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2010-07-20T15:26:14.787

您可以将文件数据读入某个缓冲区（例如**SomeCharBuffer**），将空终止符附加到它并执行

```
TiXmlDocument doc;  
doc.Parse(SomeCharBuffer); 
```

# java - 从帧率代码中得到奇怪的结果

> ID：768857
> 
> 赞同：0
> 
> 时间：2009-04-20T15:46:22.003
> 
> 标签：java, counter, frame-rate

我试图将我的游戏保持在 60 fps，但我的代码却得到了奇怪的结果，例如“2-8000 fps” 为什么不保持在 60？

```
public static void main(String[] args) {

        joglplat m = new joglplat();
        while(true){
            long startTime = System.nanoTime() / 1000000;
                try
            {
                //                 123456: 6 zeros => 16ms
                long nsToSleep = 16000000 - (System.nanoTime() - lastFrame);
                System.out.println("ns: " + nsToSleep);
                lastFrame = System.nanoTime();

                if(nsToSleep > 0)
                {
                   System.out.println("ns2: " + (nsToSleep/1000));
                   System.out.println("ns3: " + (nsToSleep%1000));
                   Thread.sleep(nsToSleep/16000000, (int)(nsToSleep % 1000));
                }
                else
                {
                   Thread.yield();  // Only necessary if you want to guarantee that
                                    // the thread yields the CPU between every frame
                }

            }

            catch(Exception e){
                e.printStackTrace();
            }

            m.controls();
            m.update();
            m.repaint();
            System.out.println("framerate: " + (System.nanoTime() / 1000000  - startTime));
        }
    } 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-04-20T15:55:55.863

我怀疑这是由 Thread.sleep() 的不准确引起的：

> 使当前执行的线程休眠（停止执行）指定的毫秒数加上指定的纳秒数，具体取决于系统计时器和调度程序的精度和准确性。该线程不会失去任何监视器的所有权。

有什么理由必须像这样保持帧率吗？也许您可以更全面地解释您要完成的工作？

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-04-20T16:01:54.210

您的输出是程序运行的秒数，而不是帧率。您应该将帧数（您没有收集）除以总运行时间。

要获得帧数，只需在游戏循环之外添加一个新变量，然后每次通过...

```
public static void main(String[] args) {
    long frames = 0;
    joglplat m = new joglplat();
    while(true){
        frames++;
        // other code here
        System.out.println("framerate: " + ((System.nanoTime() / 1000000  - startTime) / frames ) );
    }
} 
```

但是请注意，这将为您提供整个程序执行过程中的平均帧速率。您还有两个选择是获得瞬时帧率和过去 N 帧的平均帧率。

所有样式合二为一（未经测试/未编译，因此可能会有一些错误，但应该让您朝着正确的方向开始）：

```
public static void main(String[] args) {
    long startTime = System.nanoTime();
    long lastFrameTime = startTime;
    long frames = 0;
    int framesToAverage = 10;
    long[] frameTimes = new long[framesToAverage];
    joglplat m = new joglplat();
    while(true){
        // logic here
        long currentFrameDuration = System.nanoTime() - lastFrame;
        lastFrameTime = System.nanoTime();
        long instantFramerate = currentFrameDuration / 1000000;
        int currentFrameIndex = frames % frameTimes.length;
        frameTimes[currentFrameIndex] = currentFrameDuration;
        frames++;
        long averageFramerate = ( ( lastFrameTime - startTime) / frames ) / 1000000;
        long instantFramerate = currentFrameDuration / 1000000;
        if( frames > frameTimes.length ) { // if it isn't, we don't have enough data yet
            int firstFrameIndex = currentFrameIndex + 1;
            if( firstFrameIndex > frameTimes.length ) {
                firstFrameIndex = 0;
            }
            long averageFrameratePerN = ( ( frameTimes[currentFrameIndex] - frameTimes[firstFrameindex] ) / frameTimes.length ) / 1000000;
        }

        // yield/sleep here
    }
} 
```

# dependency-injection - 还有哪些其他 IoC 容器具有类似 IInitializable 的功能？

> ID：768861
> 
> 赞同：3
> 
> 时间：2009-04-20T15:46:49.443
> 
> 标签：dependency-injection, inversion-of-control, ioc-container, object-lifetime

我在之前的项目中一直在使用 Castle Windsor，我非常喜欢它。对于我当前的项目，我希望使用不同的 IoC 容器。Castle Windsor 自 2007 年以来没有发布任何新版本，并且仍然没有 1.0 版，因此很难证明在商业环境中使用它是合理的。

我喜欢 Castle Windsor 的一件事是，在设置了所有依赖项之后，您可以让容器在您的服务上调用 Initialize 方法，只需让服务实现即可`IInitializable`。我经常使用这个。它使进行属性注入而不是构造函数注入变得容易，并且可以清理代码和进行相当多的测试。

我一直在寻找 StructureMap、AutoFac、Unity 和 Spring.Net 作为替代方案，但其中只有 Spring.Net 支持类似的东西，它会自动调用一个`Init()`方法。不幸的是，Spring.Net 并不真正支持我想要使用 IoC 容器的方式（它基于字符串键而不是接口声明注入，因此它的自动装配支持也受到限制）

我是否错过了我查看的 IoC 容器中的类似功能？我使用 IoC 容器的方式是否有问题？或者是否有其他 IoC 容器支持 IIinitializable 或 Init() 之类的东西？

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2009-04-20T16:10:01.213

Autofac 可以做到——他们称之为[Startable](http://code.google.com/p/autofac/wiki/Startable)

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2009-04-20T16:13:56.210

使用 StructureMap，您可以执行以下操作：

```
ForRequestedType<IFoo>()
  .TheDefaultIsConcreteType<Foo>()
  .OnCreation(x => x.Init()); 
```

它不像在你的类上实现一个“初始化”接口那么容易，但这也意味着你不需要通过从一个 DI 容器特定接口继承来将你的类实现与你选择的 DI 容器联系起来（虽然我不确定现实中有多少问题）。

我相信构造函数注入现在更常用，并且属性注入被广泛视为无法让 DI 容器为您执行对象构造的情况（例如 ASP.NET 网络表单）的后备方案。不过我可能错了，这只是我对这个问题的看法！

你真的认为属性注入“清理代码和测试相当多”吗？这很有趣，因为我的想法正好相反——我认为构造函数注入更“干净”，我猜这可能仅仅是因为我通常这样做，所以这就是我习惯的方式。:)

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2011-03-17T06:20:45.750

LinFu.IOC 有它——它叫做 IInitialize。你可以在这里找到它：github.com/philiplaureano/LinFu

* * *

## 回答 #4

> 赞同：2
> 
> 时间：2009-04-21T13:01:55.523

Castle 可能有一段时间没有发布任何版本，但它仍在积极开发中。[你可以在这里](http://builds.castleproject.org/cruise/index.castle)获得最新的（相当稳定的）构建。

很快就会有正式的 v2.0 版本。如果您知道它很好，为什么不使用您已经知道的东西？

# java - 简单 Java2D 应用程序中的可怕性能

> ID：768871
> 
> 赞同：4
> 
> 时间：2009-04-20T15:50:02.757
> 
> 标签：java, performance, java-2d

我昨天刚刚完成了第 14 届 Ludum Dare 48 小时游戏制作比赛的[参赛作品](http://tametick.com/fwod/) ，并决定在 java 中使用 java2d 进行图形制作。

我对 API 不是很熟悉，也没有做过很多图形编程，但是我的游戏很小（只有十几个非常小的移动物体）所以我以为我可以天真地编程它仍然没有性能问题。

不用说，我错了。游戏在大多数情况下都运行良好，但一旦屏幕上移动的“敌人”太多或分辨率太高，它就会开始明显变慢。

我已经确定性能瓶颈是屏幕绘图功能，当这些功能被注释掉时，游戏速度非常快。

有人可以告诉我我在这里可能做错了什么吗？（非常短的）源代码位于[此处](http://github.com/ido/ludum-dare-2009/tree/master)，其中大部分是[Main](http://github.com/ido/ludum-dare-2009/blob/b3e8d300227c52f890ad72f9708a5e717a903386/src/Main.java)类，通常怀疑是在[内部游戏循环中调用的](http://github.com/ido/ludum-dare-2009/blob/b3e8d300227c52f890ad72f9708a5e717a903386/src/Main.java#L285)[draw()](http://github.com/ido/ludum-dare-2009/blob/b3e8d300227c52f890ad72f9708a5e717a903386/src/Main.java#L123)函数。

我已经使用[BufferStrategy](http://github.com/ido/ludum-dare-2009/blob/b3e8d300227c52f890ad72f9708a5e717a903386/src/Main.java#L337)来更新屏幕，所以除非我做错了，否则这不应该是问题。

在此先感谢，伊多。

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2009-04-20T16:15:23.010

一些观察，尽管我认为它们中的任何一个都不会有太大帮助。

主要的是您正在绘制 AWT 线程。覆盖 paintComponent() 并改为在对象上调用 repaint()。否则，这可能会导致各种问题。

您每帧都重新创建颜色。这可能是也可能不是您要缓存的内容之一。我不认为为你的颜色设置一个常量可能会搞砸 GCing，并且当你以后想要重用颜色时会让事情变得更容易。

您每帧重绘整个窗口。您只需要重新绘制更改的部分。

你不需要画背景。设置背景颜色，让父母处理一切。

作为一种设计，身体应该负责绘制自己。他们的主人应该通知他们需要绘制而不是绘制它们。

身体每次都重新创建它们的状态。考虑让他们在不同时间之间存储它并根据需要对其进行变异。您可能会花费大量时间在 drawCircleBody() 中进行三角计算

需要考虑的是设置一个计时器，而不是在 while 循环中使用睡眠。这将使您获得更一致的帧速率，但您需要确保您实际上可以履行您的义务（或者如果您错过截止日期，则将多个帧合并为一个），否则您最终会创建太多线程。

考虑使用[SwingWorker](http://java.sun.com/javase/6/docs/api/javax/swing/SwingWorker.html)进行计算，然后在 done() 方法中更新状态，通过调用 repaint() 完成。

这些只是一些事情。您应该尝试看看哪些有效，哪些无效。自从我完成 Java 图形绘制以来已经有一段时间了。

* * *

## 回答 #2

> 赞同：6
> 
> 时间：2009-04-20T16:02:57.563

您的代码不遵循单线程规则：

[http://java.sun.com/products/jfc/tsc/articles/threads/threads1.html](http://java.sun.com/products/jfc/tsc/articles/threads/threads1.html)

我不确定这是否会导致您所看到的特定性能问题，但它是一个很大的潜在问题，imo。

* * *

## 回答 #3

> 赞同：6
> 
> 时间：2009-04-20T16:03:12.633

好吧，简单地看一下您的 draw() 函数，您似乎正在声明许多新对象（尤其是在 drawPolygonBody 中）。尝试重用对象，而不是每次都声明一个新对象。

编辑： instanceof 有开销。将 Body 扩展为具有绘制自身的 draw(Graphics g) 函数会是一个更好的主意。例如：

```
public class Circle extends Body
{
    // override
    public void draw(Graphics g)
    {
        ...
    }
}

...

void drawBody(Body body) 
{
    body.draw();
} 
```

* * *

## 回答 #4

> 赞同：4
> 
> 时间：2009-04-20T16:04:52.113

您是否尝试过对其进行分析以查看绘图功能中的瓶颈在哪里*？*

光看它很难说太多，但我想知道为什么你在 drawPolygonBody 中绘制和填充多边形。
此外，在 drawBoxBody 中，您分别绘制四条线，而不仅仅是调用 drawRect()。

# java - “通用”一词的最佳解释是什么？

> ID：768876
> 
> 赞同：2
> 
> 时间：2009-04-20T15:51:54.827
> 
> 标签：java, objective-c, generics, terminology

我正在寻找一个很好的解释，也许有一些例子。在我的理解中，当它可以用于多种目的时，它是“通用的”。但我可能错了...

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2009-04-20T15:55:18.440

词根与“属”相同——表示描述一组相关事物的所有成员。

在编程术语中，这意味着您正在描述共享一个共同模式或模板的整个集合，只有很小的变化。对于程序员来说，C++ 模板和 Java 泛型或多或少是同一件事：一种说法是“无论底层类型是什么，我都希望能够做这些事情”。实现方法不同，但思路是一样的。

所以这个想法本身就有点笼统。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2009-04-20T16:02:09.140

一个使用对比的例子。

具体：StringCollection 是.Net 中的一个集合，只能保存字符串。

Generic：Generic.List(Of T) 是 .Net 中的一个集合，可以保存任何数据类型 T。

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2009-04-20T16:14:32.277

您想要一个“通用”定义，还是在特定上下文中？

在一般意义上，“通用”描述了一个过程或结构，它本身并不强制执行必须在其中调用它的严格上下文。同时，它必须对其上下文有足够的了解才能有意义。例如，用于添加数字的通用结构不会关心是否给定浮点或整数参数，但会难以添加 Q + Pi。

在某种程度上，这是面向对象编程的基础。然而，许多编程语言在更严格的意义上使用术语“通用”。在这些语言中，泛型类可以在运行时强类型化到任何实现订阅者知道如何与之交互的已知“接口”（一般意义上......）的类。语言在如何实现和支持这一点上存在很大差异，因此除非您预先确定所需的语言，否则具体示例可能无法提供更多洞察力。

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2009-04-20T16:00:02.140

泛型的另一个名称是参数化类。我相信 UML 使用这个术语。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2009-04-20T16:02:01.560

*泛型*类用于*特定*目的

# c# - 我可以使用 Sync Framework 同步移动、桌面和 Web 服务器数据库吗？

> ID：768888
> 
> 赞同：4
> 
> 时间：2009-04-20T15:54:34.620
> 
> 标签：c#, sql-server, sql-server-ce, microsoft-sync-framework, syncservices

我正在使用 Sync Framework v1（其中包括 ADO.NET v2 的同步服务）和移动 v1 的同步服务。

我可以将移动设备上的 SQL Compact Edition 数据库同步到台式 PC 上的 SQL Express。

我还可以使用 WCF 将 SQL CE 数据库从台式 PC 同步到 Web 服务器上的 SQL Server 数据库。

我想在移动设备对接时从移动设备同步到桌面，然后让桌面 PC 与网络服务器同步（桌面计算机上的副本以防网络连接不可靠）。

理想情况下，无论如何我都想避免使用 SQL Express，因为我希望移动和桌面设置尽可能简单。

不幸的是，似乎无法将这些部分组合在一起以建立我需要的连接，因为：

1.  移动设备同步到 PC 上的 SQL Express，我无法从 SQL Express 同步到 SQL 服务器。
2.  同步到 SQL 服务器必须来自 SQL CE，我无法将移动设备同步到桌面上的 SQL CE

这是不可能的，还是可能有大量代码（自定义 SyncProviders 和手工制作的更新语句等），还是我错过了一些明显的东西？

谢谢你的时间！标记。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-04-20T16:21:05.383

我正在为实时应用程序使用相同的基本设置，并且运行良好。我让移动设备使用 Web 服务与服务器同步（WCF 也可以），我让桌面应用程序同步有点[像这样](http://msdn.microsoft.com/en-us/sync/bb887608.aspx)，一切都很顺利。

一般来说，让客户端与服务器同步是一个坏主意，然后再与服务器同步，因为这样您必须管理更多状态，而常用工具和指南对您没有多大帮助。

我还建议不要使用 sql 合并复制，除非您认为自己是管理 SQL 的专家，因为如果您现在不是专家，那么等您*觉得*安全使用它时，您就会成为专家。

需要注意的是，如果您愿意花时间和精力制作自己的 Sync Framework 提供程序，那么您会发现几乎没有什么是您做不到的。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-04-20T16:04:55.110

我想“预期”模式是在桌面上使用 SQl Express 并使用合并复制到服务器。

我不希望您可以将桌面上的 SqlCe 用作 Sync 框架的“服务器”端。除其他外，SqlCe 是单用户，不适用于 SyncAgent。即使它在您的情况下似乎可行。

可能的工作是让移动与服务器同步，桌面也与服务器同步。但我意识到这并不能解决您的连接问题，并且可能会使 PC 上的副本变得多余。

# sql-server - 将分层数据导出为 XML

> ID：768891
> 
> 赞同：0
> 
> 时间：2009-04-20T15:55:26.007
> 
> 标签：sql-server, xml

我们的数据库包含分层的“项目”。每个项目在单独的表中都有详细信息。例如，项目可以是文件夹或文件。现在我想将项目的子项导出到 XML。出于性能原因，我想在 SP 中执行此操作。当然，可以编写基于游标的 SP，但游标往往很慢。更好的是**CTE** (with ...) 和**FOR XML**，但我不知道如何结合 CTE 和 FOR XML 包括详细表信息。

DDL

```
create table items (
   itemid integer,
   parent_itemid integer
)

create table folder (
   folderid integer,
   itemid integer,
   foldername varchar(50),
   [..]

create table file (
   fileid integer,
   itemid integer,
   filename varchar(50),
   [..] 
```

XML 导出

```
<folder id="1" foldername="Top-Folder">
 <folder id="2" foldername="Sub-Folder">
   <file id="10" filename="Subdoc.doc"/>
 </folder> 
 <file id="10" filename="Doc1.doc"/>
 <file id="11" filename="Doc2.doc"/>
</folder> 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-04-20T16:06:28.507

也许这会有所帮助：[Create XML Files Out Of SQL Server With SSIS And FOR XML Syntax](http://blogs.lessthandot.com/index.php/DataMgmt/DBProgramming/create-xml-files-out-of-sql-server-with-)

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-04-20T16:01:45.507

如果数据适合内存，请将 3 个表（相关块）导出为您喜欢的编程语言，然后组装树。或者，将表格转储为文本文件，例如 .CSV 格式，然后扫描这些文件。

我会使用 Perl，但 Ruby 或 Python 也可能是不错的选择。或者您自己选择/必要的语言。

逃离数据库，剩下的应该是相当直接的。除了“提取时刻”方面，报告转储不需要事务。取出数据，然后在闲暇时细细品味。

# c# - 无法加载文件或程序集'log4net

> ID：768903
> 
> 赞同：8
> 
> 时间：2009-04-20T15:59:16.603
> 
> 标签：c#, .net, web-config, log4net

好的，在将我们的一个 Web 应用程序部署到我们的实时服务器时，我遇到了一个非常奇怪的问题。

我们的应用程序使用 log4net 大量记录大量操作，在部署几个小时后，我们得到以下异常。

无法加载文件或程序集 'log4net, Version=1.2.9.0, Culture=neutral, PublicKeyToken=b32731d11ce58905' 或其依赖项之一。访问被拒绝。

这是我使用的相关 web.config 添加。

```
<configSections>
    <section name="log4net" type="log4net.Config.Log4NetConfigurationSectionHandler, log4net"/>
  </configSections>

<log4net>
    <appender name="ErrorLogFileAppender" type="log4net.Appender.RollingFileAppender">
      <param name="File" value="D:\SomeLocation\Errorlog"/>
      <param name="AppendToFile" value="true"/>
      <param name="RollingStyle" value="Size"/>
      <param name="maxSizeRollBackups" value="-1" />
      <param name="maximumFileSize" value="100MB" />
      <layout type="log4net.Layout.PatternLayout">
        <param name="ConversionPattern" value="%d [%t] %-5p %c [%x] - %m%n"/>
      </layout>
      <filter type="log4net.Filter.LevelRangeFilter">
        <param name="LevelMin" value="FATAL" />
        <param name="LevelMax" value="FATAL" />
      </filter>
    </appender>
    <appender name="BookingLogFileAppender" type="log4net.Appender.RollingFileAppender">
      <param name="File" value="D:\SomeLocation\BookingInfoLog"/>
      <param name="AppendToFile" value="true"/>
      <param name="RollingStyle" value="Size"/>
      <param name="maxSizeRollBackups" value="-1" />
      <param name="maximumFileSize" value="100MB" />
      <layout type="log4net.Layout.PatternLayout">
        <param name="ConversionPattern" value="%d [%t] %-5p %c [%x] - %m%n"/>
      </layout>
      <filter type="log4net.Filter.LevelRangeFilter">
        <param name="LevelMin" value="INFO" />
        <param name="LevelMax" value="FATAL" />
      </filter>
    </appender>
    <root>
      <level value="ALL"/>
      <appender-ref ref="BookingLogFileAppender"/>
      <appender-ref ref="ErrorLogFileAppender"/>
    </root>

  </log4net> 
```

它在我们的本地机器和开发服务器上运行良好，但不是在现场。

顺便说一句，在 web.config 更新或应用程序池回收之后，JIT 编译器在服务器上运行后似乎会中断，甚至只是很长一段时间！

**更新：**我们的实时服务器从一个共享位置运行所有网站。我设法在从共享运行应用程序的另一台服务器上复制了这个问题。将站点设置为从本地驱动器运行时，问题消失了，但我们的托管要求我们从共享运行。为什么 log4net 会从共享运行权限问题的任何想法。应用程序再次运行，直到发生另一个 JIT 编译

* * *

## 回答 #1

> 赞同：8
> 
> 时间：2011-11-04T17:02:31.470

当我们迁移到 VS 2010 和 .NET 4.0 时，我们也遇到了这个问题，我们根本不使用 log4net，但我怀疑我们使用的其他东西（可能是 Crystal Reports？）而且我还怀疑我们使用了一个 dll也是一个 32 位 dll，因为当我将 IIS 中应用程序池的高级设置下的“启用 32 位应用程序”选项更改为“真”时，一切都恢复了。

* * *

## 回答 #2

> 赞同：6
> 
> 时间：2009-04-21T16:42:10.940

可能会问显而易见的问题，但我假设您的 bin 文件夹中的 log4net.dll 是正确的版本？

如果您有多个项目引用同一 DLL 的不同版本，则后面的项目将 DLL 复制到先前版本上的情况并不少见。

假设您需要支持多个 log4net 副本，我能想到的最佳解决方案是向您的配置添加探测并将此版本放在另一个文件夹中。

[http://msdn.microsoft.com/en-us/library/823z9h8w.aspx](http://msdn.microsoft.com/en-us/library/823z9h8w.aspx)

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2009-04-21T11:56:49.517

检查您在编译时绑定的版本（您的文件参考）和运行时使用的版本（首先查看 GAC，然后查看本地）

通常，GAC 中的版本与您作为文件参考的版本不同。请检查这个。

同时清理 ASP.NET 临时目录并执行 IIS 重启（cmd 提示符 -> iisreset）

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2011-12-09T22:13:14.650

我敢打赌，您的 JIT 编译器对共享没有写访问权限。JIT 编译器似乎不时地重新编译整个站点，也许是在它被回收时。

一种选择是部署预先构建的站点。这样就不用重新编译了。另一种选择是您将 JIT 编译器的写入权限授予您的共享。很可能它与运行您的 Web 服务的用户是同一用户，例如。SYSTEM、NETWORK SERVICE 或 LOCAL SERVICE 组或 IIS_* 用户之一...

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2020-04-22T14:37:02.680

我遇到了同样的问题，如果您使用 GIT，这可能会对您有所帮助。

问题原来是我的 Log4net.dll 文件位于名为**log**的文件夹中。.gitignore 配置文件（默认情况下）排除所有名为 log 的文件夹。

# c# - 命名空间和子命名空间

> ID：768905
> 
> 赞同：21
> 
> 时间：2009-04-20T15:59:38.273
> 
> 标签：c#, namespaces

有没有办法使用命名空间，然后让它自动使用所有子命名空间？

例子：

```
namespace Root.Account
{
//code goes here
}

namespace Root.Orders
{
//code goes here
}

//New File:
using Root; 
```

为了让我使用 Root.Account 中的代码，我需要将 using Root.Account 添加到我的代码中。

我希望能够只说 using Root 并让它选择任何子命名空间类以供使用。

如果这是有道理的，这可能吗？

谢谢

* * *

## 回答 #1

> 赞同：28
> 
> 时间：2009-04-20T16:04:10.337

不，在树下没有任何*工作*。但是，您不需要包含 using 指令来*上*树。换句话说，如果您使用：

```
namespace Root.Orders
{
    // Code
} 
```

那么其中的任何类型`Root`都已经可见。

* * *

## 回答 #2

> 赞同：9
> 
> 时间：2009-04-20T16:07:26.773

不，`using`C# 中的指令[不允许](http://msdn.microsoft.com/en-us/library/sf0df423(VS.80).aspx)这样做：

> 创建 using 指令以使用命名空间中的类型，而无需指定命名空间。using 指令不允许您访问嵌套在您指定的命名空间中的任何命名空间。

然而，VB.NET[支持](http://msdn.microsoft.com/en-us/library/7f38zh8x(VS.71).aspx)更接近于`Imports`语句的行为：

> Imports 语句提供的元素的范围取决于您在使用 Imports 语句时的具体程度。例如，如果只指定了一个命名空间，则该命名空间的所有唯一命名的成员以及该命名空间内的模块成员都可以无条件使用。如果同时指定了命名空间和该命名空间的元素名称，则只有该元素的成员才可用，无需限定。

也就是说，如果你说

```
Imports Root 
```

然后你就可以说`Orders.Whatever`。

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2009-04-20T17:15:52.113

从您陈述原始问题的方式来看，听起来您可能会或可能不会意识到仅使用以下内容：

```
using Root; 
```

稍后澄清代码的方式是：

```
Account.Class obj = new Account.Class();
Orders.Class obj = new Orders.Class(); 
```

您不必使用 Root.Account 来访问代码，与 Root.Orders 相同。除此之外，没有办法自动递归地使用命名空间。我认为这会导致滥用 System;

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2009-04-20T16:01:29.797

不，不是。=)

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2009-04-20T16:02:36.830

.NET/C# 不支持这种形式的命名空间使用。

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2021-03-19T12:04:33.133

如果我理解正确，您的层次结构如下所示

```
namespace Root
{
  namespace Root.Account
  {
     public class A{}
  }

  namespace Root.Orders
  {
    public class B{}
  }
} 
```

你能做的是

```
using Root = Root; 
```

然后访问子命名空间中的类，例如

```
var myClassA = Root.Account.A(); 
```

或者

```
var myClassB = Root.Orders.B(); 
```

For further info, you can read the [Microsoft docs about namespaces](https://docs.microsoft.com/en-us/dotnet/csharp/language-reference/language-specification/namespaces).

* * *

## 回答 #7

> 赞同：-2
> 
> 时间：2015-08-24T10:48:18.413

命名空间就像一个对象容器。它们可能包含联合、结构、类、委托和接口。Asp.net C# 中命名空间的主要重要性是用于创建程序的分层组织。

了解更多博客... [http://asp-net-by-parijat.blogspot.in/2015/08/what-is-namespace-in-c-need-of.html](http://asp-net-by-parijat.blogspot.in/2015/08/what-is-namespace-in-c-need-of.html)

# iphone - UIToolBar - 禁用按钮

> ID：768918
> 
> 赞同：11
> 
> 时间：2009-04-20T16:03:06.063
> 
> 标签：iphone, cocoa-touch

在我的应用程序中，我有一个工具栏，并且在某个时候我想禁用或启用一些按钮。最简单的方法是什么？如何访问 UIToolbar 的 items 属性？

这是我的代码：

```
-(void)addToolbar {
    NSMutableArray *buttons = [[NSMutableArray alloc] init]; 

    //Define space
    UIBarButtonItem *flexibleSpaceItem; 
    flexibleSpaceItem = [[UIBarButtonItem alloc] initWithBarButtonSystemItem: UIBarButtonSystemItemFlexibleSpace target:nil action:NULL]; 

    //Add "new" button
    UIBarButtonItem *newButton = [[UIBarButtonItem alloc]
                                  initWithTitle:@"New" style:UIBarButtonItemStyleBordered target:self action:@selector(new_clicked)];
    [buttons addObject:newButton];
    [newButton release];

    //Add space
    [buttons addObject:flexibleSpaceItem];

    //Add "make active" button
    UIBarButtonItem *activeButton = [[UIBarButtonItem alloc]
                                  initWithTitle:@"Make Active" style:UIBarButtonItemStyleBordered target:self action:@selector(make_active_clicked)];
    [buttons addObject:activeButton];
    [activeButton release];

    [buttons addObject:flexibleSpaceItem];

    //Add "edit" button
    UIBarButtonItem *editButton = [[UIBarButtonItem alloc]
                                  initWithTitle:@"Edit" style:UIBarButtonItemStyleBordered target:self action:@selector(edit_clicked)];
    [buttons addObject:editButton];
    [editButton release];

    [flexibleSpaceItem release];

    [toolBar setItems:buttons];
    [buttons release];
} 
```

先感谢您。

* * *

## 回答 #1

> 赞同：14
> 
> 时间：2009-04-20T16:15:04.460

最简单的方法是将引用保存`UIBarButtonItem`为实例变量。

```
# header file
UIBarButtonItem *editButton; 
```

然后你的代码变成

```
# .m file
editButton = [[UIBarButtonItem alloc]
               initWithTitle:@"Edit"
               style:UIBarButtonItemStyleBordered
               target:self
               action:@selector(edit_clicked)];
[buttons addObject:editbutton]; 
```

现在在任何实例方法的任何地方，禁用按钮都很简单：

```
editButton.enabled = NO; 
```

也不要`release`立即这样做，因为这个类现在拥有按钮对象。所以`release`它在`dealloc`方法中代替。

* * *

## 回答 #2

> 赞同：6
> 
> 时间：2013-03-29T18:40:46.563

[快速枚举](http://developer.apple.com/library/ios/documentation/cocoa/conceptual/ProgrammingWithObjectiveC/FoundationTypesandCollections/FoundationTypesandCollections.html#//apple_ref/doc/uid/TP40011210-CH7-SW28)救援！

```
- (void) setToolbarButtonsEnabled:(BOOL)enabled
{
    for (UIBarButtonItem *item in self.toolbarItems)
    {
        item.enabled = !enabled;
    }
} 
```

# java - ORA-01654: 无法扩展索引

> ID：768920
> 
> 赞同：29
> 
> 时间：2009-04-20T16:03:23.553
> 
> 标签：java, oracle, cluster-computing

召集所有 Oracle 大师！

我正在对 WebSphere 上经过良好测试的应用程序进行集群处理。在此之前，有问题的应用程序从队列中处理了 1k 条 JMS 消息大约完成了一半。

```
---- Begin backtrace for Nested Throwables
java.sql.SQLException: ORA-01654: unable to extend index DABUAT.INDEX1 by 128 in tablespace DABUAT_TBLSP

    at oracle.jdbc.driver.DatabaseError.throwSqlException(DatabaseError.java:112)
    at oracle.jdbc.driver.T4CTTIoer.processError(T4CTTIoer.java:331)
    at oracle.jdbc.driver.T4CTTIoer.processError(T4CTTIoer.java:288)
    at oracle.jdbc.driver.T4C8Oall.receive(T4C8Oall.java:745) 
```

我在网上快速浏览了一下，发现了一些关于为什么会发生这种情况的可能建议，如果有人能清楚地解释为什么现在我的应用程序已经被集群化了，我将不胜感激。

问候卡尔

* * *

## 回答 #1

> 赞同：46
> 
> 时间：2009-04-20T16:08:36.643

您的磁盘空间不足。

增加你的`TABLESPACE`：

```
ALTER TABLESPACE DABUAT_TBLSP
ADD DATAFILE 'C:\FolderWithPlentyOfSpace\DABUAT_TBLSP001.DBF' 
SIZE 4M
AUTOEXTEND ON NEXT 4M
MAXSIZE 64G;

-- Put your own size parameters here 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2018-08-18T11:34:42.030

如果您使用的是 ASM，那么您可以添加以下评论

您可以运行以下命令来获取数据文件的大小

```
SELECT
    file_name,
    bytes / 1024 / 1024 mb
FROM
    dba_data_files
WHERE
    tablespace_name = 'APP_DATA'
ORDER BY
    file_name;

FILE_NAME mb
------------------------------------------------------------ -------
+DATA/SID/datafile/app_data.dbf 20000
+DATA/SID/datafile/app_data.dbf 28100 
```

调整大小和添加

```
+DATA/path/indx_operational_00.dbf

alter database datafile '+DATA/path/indx_operational_00.dbf' resize 3000m; 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2021-06-08T17:30:50.297

我发现这个问题在将大型数据库的一小部分迁移到 Docker 中的测试数据库时有同样的错误。

在我的情况下，问题只是将系统表空间用于用户表，这是 Oracle 映像中的默认设置。使用命令创建自定义表空间后

```
create tablespace mytablespace datafile '/u01/app/oracle/oradata/XE/mytablespace.dbf' size 500M autoextend on next 250M maxsize 10G;` 
```

（以及在该表空间中创建所有表和索引）问题消失了。不需要特别摆弄数据文件。

# c# - “新”还是“新”

> ID：768922
> 
> 赞同：7
> 
> 时间：2009-04-20T16:04:11.180
> 
> 标签：c#, .net, new-operator, allocation

`new`声明对象时何时使用关键字，何时不使用，是否有一个经验法则？

```
List<MyCustomClass> listCustClass = GetList(); 
```

或者

```
List<MyCustomClass> listCustClass = new List<MyCustomClass>();
listCustClass = GetList(); 
```

* * *

## 回答 #1

> 赞同：43
> 
> 时间：2009-04-20T16:06:14.233

在第二种情况下，您在第一行创建一个新对象只是为了在第二行将其丢弃。完全没有必要。

* * *

## 回答 #2

> 赞同：18
> 
> 时间：2009-04-20T16:05:52.173

在这种情况下，只有您的第一个示例有意义，因为在第二种情况下，您将立即将创建的列表替换为方法返回的列表。将列表初始化为新的空列表在您添加到该列表的情况下或当您调用以填充列表的方法可能会以某种方式导致空值时是有意义的，否则您会期望一个空列表.

我可能会对新的空列表使用初始化的示例。

```
List<MyCustomClass> listCustClass = new List<MyCustomClass>();
listCustClass.AddRange( GetList() ); 
```

或者

```
List<MyCustomClass> listCustClass = new List<MyCustomClass>();
try
{
    listCustClass = GetList();
}
catch (SqlException)
{
}
return listCustClass; 
```

* * *

## 回答 #3

> 赞同：8
> 
> 时间：2009-04-20T16:18:01.940

在您的场景中，对象的实际创建似乎是在您的`GetList()`方法中执行的。因此，您的第一个示例将是正确的用法。

创建时，您`List<MyCustomClass>`的存储在堆中，您`listCustClass`只是对该新对象的引用。当您将 listCustClass 设置为`GetList()`的引用指针时，`listCustClass`将被丢弃并替换为指向任何`GetList()`返回的引用指针（可能为空）。发生这种情况时，您的原始`List<MyCustomClass>`文件仍在堆中，但没有对象指向它，因此它只是在浪费资源，直到垃圾收集器出现并清理它。

总结一下，每次你创建一个新对象然后放弃它，就像第二个例子一样，你实际上是在通过用无用的信息填充堆来浪费内存。

* * *

## 回答 #4

> 赞同：3
> 
> 时间：2009-04-20T16:06:30.270

您使用`new`关键字来构造对象的新实例。从您的问题中不清楚该`GetList`方法的作用，但大概是创建一个新列表（从而将`new`关键字移动到其他地方）或返回一个现有列表（*有人*在某个时候使用创建`new`）。

* * *

## 回答 #5

> 赞同：3
> 
> 时间：2009-04-20T16:09:37.063

new 关键字基本上用于在堆上分配空间。如果您正在创建值类型（结构等），则不必使用 new 关键字。但是，引用变量在使用之前必须是新的。

在您上面的示例中，似乎 GetList() 正在返回一个类型为 List 的引用，该引用将在函数内的某处创建（新建）。因此，在这种情况下，新建是没有意义的。

* * *

## 回答 #6

> 赞同：2
> 
> 时间：2009-04-20T16:06:23.997

如果你可以内联它而不失去你正在完成的事情的意义和清晰度，那么无论如何，内联。

编辑：而且，因为我经常内联，我什至没有考虑过孤立对象引用。多哈。=)

* * *

## 回答 #7

> 赞同：1
> 
> 时间：2009-04-20T16:07:44.523

没有经验法则，但有一个常识，您可以在大多数情况下应用。

对象在创建时需要实例化。您的`GetList()`函数表面上返回一个（创建的）IList，因此第二个代码片段是完全不必要的（您实例化一个 IList 并在下一行有效地丢弃它）。

然而，第一个片段是完全合适的。

* * *

## 回答 #8

> 赞同：0
> 
> 时间：2009-04-20T16:07:06.197

不要以“我应该在声明时使用 new ”的方式来考虑它。

在分配时使用 new （可以是声明的一部分）。

第一个例子是正确的，第二个是对运行时资源的无谓浪费。

* * *

## 回答 #9

> 赞同：0
> 
> 时间：2009-04-20T16:09:18.267

在 C# 中，所有类的实例都必须使用`new`关键字创建。如果您没有`new`在当前上下文中使用，那么您要么有一个空引用，要么您正在调用一个`new`用于实例化类的函数。

在这种情况下，GetList() 似乎`new`用于创建一个新列表。

# php - 用于将 HTML4 转换为 XHTML 的 PHP 库？

> ID：768923
> 
> 赞同：4
> 
> 时间：2009-04-20T16:04:16.280
> 
> 标签：php, html, xhtml

我需要在 PHP5 中将 HTML4 输入转换为有效的 XHTML（严格）以进行进一步处理（例如 SAX）。有什么建议么？

* * *

## 回答 #1

> 赞同：11
> 
> 时间：2009-04-20T16:08:51.167

[PHP Tidy 扩展](http://php.net/tidy)应该能够完成这项工作。

这是一篇关于它的好文章：[使用 Tidy PHP Extension 整理 HTML 代码](https://lukaszwrobel.pl/blog/tidying-up-html-code-with-tidy-php-extension/)。

# iphone - 如何在 iPhone 上使用 python api？

> ID：768941
> 
> 赞同：1
> 
> 时间：2009-04-20T16:07:44.993
> 
> 标签：iphone, python, objective-c

有一个“ [Python 中的非官方 Plurk API](http://code.google.com/p/plurkapipy/) ”。 [Plurk](http://www.plurk.com/)是一个类似推特的网站。

我可以使用 Objective-C 的 API(python) 吗？或者我必须移植它们？

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2009-04-20T16:10:23.817

Apple 的 iPhone 开发者许可证禁止使用解释代码的应用程序。所以，不幸的是，python 出来了。

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2009-04-20T16:16:28.920

在我看来，一种选择是试试这个[this](http://www.saurik.com/id/5)。

或者，[ths plurk api](http://code.google.com/p/plurkapipy/source/browse/trunk/plurkapi.py)（它实际上更像是一个 python 自动抽象而不是 API）不是很大，并且不太可能需要很长时间才能移植。除了是非常简单的代码。作者完成了所有的工作，定义了 url 和相关的函数等等。

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2009-04-20T16:10:18.717

iPhone SDK 不允许您运行任何 Python 代码。您需要将其转换为 C、C++、Objective-C 或 ObjectiveC++。

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2010-03-28T17:04:01.623

嗯，Plurk 现在有了官方 API，我写了一个 Objective-C 库来连接 Plurk。也许您有兴趣尝试一下。

[http://github.com/zonble/ObjectivePlurk](http://github.com/zonble/ObjectivePlurk)

* * *

## 回答 #5

> 赞同：-6
> 
> 时间：2009-04-20T16:52:32.873

不幸的是，您只能做 Apple 允许您做的事情（他们非常有控制力）。然而，如果你越狱你的设备（这违反了你与 Apple 的使用协议），你可以用我认为是一个了不起的设备做很多很多事情（不幸的是，Apple 限制了它的真正可能性）。

# .net - 集成（Selenium）测试后回滚数据库

> ID：768944
> 
> 赞同：11
> 
> 时间：2009-04-20T16:08:25.617
> 
> 标签：.net, testing, selenium, integration-testing

有没有人对从 Selenium 等集成测试框架中回滚数据库事务的最佳实践或首选方式有任何建议？

这是我们目前的情况：我们有一个带有许多单元测试的 .net Web 项目，这些单元测试在我们的单元测试环境中运行良好 - 每个测试都继承一个父类，它在 [SetUp] 中打开一个事务，并在 [SetUp] 中回滚事务[拆解]。每次测试后，我们的单元测试数据库都会恢复到原始状态。

但是，一旦我们进入集成环境，情况就会发生变化。我们的持续集成服务器会自动编译我们的提交并将它们推送到测试服务器，以便服务器始终运行在最新的代码上。我们还设置了一个 Selenium 实例来自动化用户与站点的交互。selenium 测试基本上与现有的 Selenium 服务器通信，并告诉服务器诸如“启动浏览器并转到[http://testsite/TestPage.aspx](http://testsite/TestPage.aspx) - 将文本 'abc' 输入带有 id 'def' 的表单字段 - 断言新页面包含文本“xyz””

每个测试都以与我们的普通单元测试类似的方式运行，但有一个重要的例外：Selenium 所做的任何更改都是在完全不同的线程/应用程序中完成的，因此我们不能（我*认为我们不能，至少）在测试拆解中回滚它们。

我们还没有为此找到一个好的解决方案。现在我们正在使用 SqlCommand 执行 sql 语句来备份数据库，然后在测试结束时，我们将数据库设置为单用户，删除当前数据库并恢复旧副本 - 这不太理想，因为这有效地杀死了附加到数据库的应用程序，并要求我们再次重新初始化应用程序。

这是以前解决过的问题吗？任何建议都会很棒。

谢谢！

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2009-04-20T16:18:41.533

我们在每次测试之前运行一个 drop/create-table 脚本。这是相当快的，并确保以前的测试没有留下任何东西。

PS：我们正在使用 NHibernate，它动态创建这个脚本并在内存中的 Sqlite 上运行测试，它的速度非常快。但是如果我们切换到 SqlServer，它仍然非常快。

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2009-04-26T18:21:29.273

这是一个棘手的问题，而且每个应用程序的解决方案通常都是独一无二的。在主要框架采用“推荐方法”之前，这将继续是一种痛苦。

我最好的建议：在您的应用程序开始时计划这种用法。包括在从应用程序下方重置数据库后清理的 API（即：重置缓存）。

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2011-12-06T19:38:33.870

有一个名为[Amnesia](http://amnesia.codeplex.com/)的项目（[更多文档](http://amnesia.codeplex.com/wikipage?title=Integration)，[最新代码](https://github.com/vc3/Amnesia)）是专门为这种情况设计的。它简化了[使用 MSDTC TransactionScope 回滚测试更改](http://graemehill.ca/high-performance-database-rollback-in-automated-tests-with-sql-server)的过程。（使用将需要在大多数应用程序中对数据访问进行适度侵入性更改，尤其是那些尚未使用 MSDTC 的应用程序。）

# sql - LTRIM(RTRIM(COALESCE(TextField,''))) 不好吗？

> ID：768946
> 
> 赞同：1
> 
> 时间：2009-04-20T16:08:39.390
> 
> 标签：sql, sql-server, performance, tsql

我有一个非常高流量的表，`char(50)`其中包含一个参与多个索引的字段。该`char(50)`字段允许 NULLS，在这种情况下，NULL 值被认为与我的目的的非 NULL、零长度字符串相同。

我也忽略了前导和尾随空格，虽然我在插入数据之前清理了数据，但它也可能通过我无法控制的方式插入。

我有一个存储过程，用于将数据从一个表复制到主表，它需要高性能。我需要在插入新数据之前删除重复记录，并且我正在使用[此线程](https://stackoverflow.com/questions/714590/most-efficient-t-sql-delete-for-many-rows)中讨论的方法来执行删除。

我的删除语句如下所示（简化）：

```
delete masterTable
from masterTable t
    join incomingDataTable inc on
    (
        LTRIM(RTRIM(COALESCE(inc.TextField,''))) = 
             LTRIM(RTRIM(COALESCE(t.TextField,'')))
    )
where LTRIM(RTRIM(COALESCE(t.TextField,''))) <> '' 
```

我[读过](http://msdn.microsoft.com/en-us/library/aa964133(SQL.90).aspx)像 LTRIM(RTRIM(...)) 这样的结构是不好的。我的删除语句可以改进吗？如果可以，如何改进？

**编辑：** 为了澄清，`TextField`确实参与了两个表的索引。 **EDIT2：** 在两个表中都`TextField`定义为。`char(50)`它不是类型`TEXT`。

* * *

## 回答 #1

> 赞同：8
> 
> 时间：2009-04-20T16:16:53.630

你需要：

1.  `masterTable`使用表达式创建计算列`LTRIM(RTRIM(COALESCE(TextField,'')))`
    *   在该列上建立索引并
    *   在联接中使用此列。

现在你的表的设计方式不可能使这个查询对索引友好。

如果您无法更改表结构但可以估计`LEADING`空格数，则可以使用[**此处**](http://explainextended.com/2009/03/24/article-aware-title-filtering-internationalization/)描述的方法。

但是，此解决方案远不如在计算列上创建索引有效。

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2009-04-20T16:12:27.853

这很糟糕，因为您的 JOIN 必须扫描整个索引，这是因为您的条件不是*[SARGable](https://web.archive.org/web/20170222053424/https://en.wikipedia.org/wiki/Sargable "搜索参数 ABLE")*

您还确定是 TEXT 数据类型吗？最后我检查了你不能对 Text 数据类型列使用 LTRIM 或 RTRIM 吗？

作为对 char 对 varchar 评论的回应，运行这个

```
declare @v varchar(50),@v2 char(50)
select @v ='a',@v2 = 'a'

select datalength(@v),datalength(@v2) 
```

* * *

## 回答 #3

> 赞同：3
> 
> 时间：2009-04-20T16:38:37.960

我建议将该数据类型更改为 VARCHAR(50) - 最多大约 10 个字符，CHAR(x) 可能有意义，因为它更快一点并且开销更少 - 但是有 50 个字符，除非所有列都被完全使用到50 个字符，这是一个主要开销，特别是因为该列也用于索引。

将其更改为 VARCHAR(50) 可能会显着减少表所需的空间（取决于您的数据量和实际使用的 50 个字符的数量），并且所涉及的所有索引也会变得更小 - 加上你不再需要这些 COALESCE、LTRIM、RTRIM 的东西了 :-)

马克

* * *

## 回答 #4

> 赞同：2
> 
> 时间：2009-04-20T16:11:50.600

我认为在 SQL Server 中，您可以将填充字符串与非填充字符串匹配，从而节省您在 LTRIM/RTRIM 上的工作量，但我不是 100% 的...

但是，整理数据是 ETL 的一部分，需要在数据到达目的地之前完成。您可能会发现在大型数据集上，创建数据的临时副本、重新处理、索引它，然后进行所需的匹配会更快。

* * *

## 回答 #5

> 赞同：2
> 
> 时间：2009-04-20T16:16:50.540

我相信 SQLMenace 是正确的。

如何向表中添加一个**INSERT/UPDATE 触发器**以保证该列上没有空格？

如果列是 VARCHAR，SQL Server 将自动忽略结束空格。不过，前导空格仍然很重要。

实际上，在执行 JOIN 之前，SQL Server 不会自动将两列都填充到 CHAR(50) 吗？（隐式转换。）

* * *

## 回答 #6

> 赞同：2
> 
> 时间：2009-04-20T17:07:09.187

如果每次使用时都必须修剪数据，则它不应该是 char 数据类型，而应该是 varchar 数据类型。每当您每次查询字段时都必须使用函数时，您的数据库设计就有问题。

您可能会发现此讨论很有帮助： [SQL 中的 CHAR 数据类型是否已过时？你什么时候使用它？](https://stackoverflow.com/questions/758699/is-the-char-datatype-in-sql-obsolete-when-do-you-use-it/760511#760511)

# assembly - MIX 中的除法是如何工作的？

> ID：768948
> 
> 赞同：6
> 
> 时间：2009-04-20T16:08:51.713
> 
> 标签：assembly, division, knuth, taocp

有人可以向我解释 MIX 中的除法（来自 Knuth 的 TAOCP）是如何逐字节工作的吗？

```
rA = |-| . . . .0| 

rX = |+|1235|0|3|1| 
```

存储位置 1000 包含`|-|0|0|0|2|0|`.

执行操作时

```
DIV 1000 
```

寄存器变成

```
rA = |+|0|617|?|?|

rX = |-|0|0|0|?|1| 
```

`rA`现在我理解了和上的符号`rX`，但是填充的字节的顺序是什么`rAX`以及完成了哪些划分？

如果 DIV 1000 导致每个位除以 2，那么我希望

```
rAX = |+|617|0|1|0|-|0|1|0|1|1| 
```

其中`rA`包含除法结果和`rX`余数（从右侧填充）。

我可能在这里遗漏了一些东西，Knuth 似乎认为我应该能够自己弄清楚（因此关于它的 10 级问题，我也没有得到），但是有人可以在这里帮助我吗？

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2009-04-21T07:40:58.197

所以我自己想通了。

如果您手动进行除法，通过将字节转换为单个数字，您将得到 -210,501,825（如果您使用的是最小的字节 - 在 Knuths 书中是 6 位（！））。将其除以 -128，即使用相同字节大小的位置 1000 中的值。

商为 1644545，余数为 65，符号为正，因为两个数字都是负数。如果您将 1644545 存储在 rA 中，将 65 存储在 rX 中，您将得到

```
|+|0|6|17|32|01|
|-|0|0|0|1|1| 
```

使用最小的字节大小（包含 64 个数字）。由于 Knuth 在他的示例中从未假设特定的字节大小，因此 rX 有许多问号。rX 的符号始终是 rA 的前一个符号。

编辑：我使用了非常方便的[MixEmul](http://www.xs4all.nl/~rbergen/mixemul.html)实用程序来玩弄 MIX 的寄存器。这是在 .NET 中完成的非常好的 MIX 实现

# sharepoint - 无法删除自定义 SharePoint Webpart DLL

> ID：768949
> 
> 赞同：1
> 
> 时间：2009-04-20T16:09:11.947
> 
> 标签：sharepoint, web-parts

我创建了几个自定义 Web 部件并将 DLL 放在 /bin 文件夹中进行测试。我现在想从 /bin 文件夹中删除 DLL，但我不断收到以下错误：

无法删除 xxxxx：访问被拒绝 确保磁盘未满或未写保护，并且文件当前未在使用中。

我可以重命名 DLL 文件，因此它们没有完全锁定，但是如果我这样做了，我会收到错误无法加载文件或程序集 'xxxxxx' 或其依赖项之一。找到的程序集的清单定义与程序集引用不匹配。（来自 HRESULT 的异常：0x80131040）在加载站点时显示在浏览器中。

有任何想法吗？

谢谢，

查理

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2009-04-20T16:45:55.667

它们可能被 IIS 锁定。试试这个：
iisreset /stop
（删除它们）
iisreset /start

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2011-08-28T09:22:13.870

打开windows任务管理器。结束名为“cisv”的进程。这对我有用。

# c# - 两个 DataGridView；排列列

> ID：768958
> 
> 赞同：3
> 
> 时间：2009-04-20T16:11:06.107
> 
> 标签：c#, .net, winforms, datagridview

我目前正在从事的项目有两个`datagridviews`旨在比较相似数据的两个版本（相同的列数和名称）。我想调整所有列的大小，使它们符合两个标准：

1）自动调整大小以适应数据（这很容易）

2) 所以列被排列成这样，对于任何列 COL, `gridA[COL].Width = Max(gridA[COL].Width`, `gridB[COL].Width`), 并且对于`gridB[COL].Width`

我遇到的问题是，当您进行自动调整大小时，该`Width`属性不会显示实际宽度（我猜它会显示自动调整大小之前的宽度）。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-04-20T16:54:29.483

我找到了另一种调整列大小的方法，可以进行更多控制。我不敢相信我第一次错过了它。

可以使用该`DataGridViewColumn.GetPreferredWidth(...)`方法获取自动调整宽度。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-04-20T16:13:42.543

对于自动调整大小，有 FillWeight 属性。

如果将两个 gridviews 的 AutoSizeColumnsMode 都设置为 Fill，则可以从第一个读取 FillWeight 并将其应用于第二个。不过，您可能必须为所有列执行此操作。

# html - Handling a (possibly paginated) list of items, like to toggle a value based on a single click?

> ID：768959
> 
> 赞同：2
> 
> 时间：2009-04-20T16:11:24.080
> 
> 标签：html, forms, webforms

Assuming of course we're working with HTML Forms and GET/POST data, backend language agnostic. Asker is most fluent with PHP and Python.

Example: Tracking event attendance, there is an HTML page for the event administration that lists all available People. There is a column next to each name with a graphic/widget representing their attendance for the event. **What's the best way to update the Attendance status for a Person on the list?**

One method I initially thought of was simply to use a Checkbox for attendance. However, unchecked boxes aren't sent along with form data. The underlying logic would have to toggle the Attendance status to FALSE/OFF/Not Attending for any Person ID not sent along with the form. This breaks if the list is paginated!

The second method I thought about was using a graphic/button next to each name. Is it appropriate that each button be a submit button? As in: Is is allowed that a form element have multiple submit buttons? Or should each button/Person be wrapped in it's own form element?

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-04-20T16:14:22.310

A fairly simple fix is to go with your checkbox method, but add a couple of hidden form elements that store values for the minimum/maximum values that are going to be submitted. That way your logic can handle "missing" checkboxes as "off" without breaking everyone that isn't on the page.

I don't recommend having multiple submit elements in a single form. If you want to go another direction, you could look into having a link (textual/graphic/button) on each row that uses ajax to toggle the attendance for that row's person. That way nothing ever has to be explicitly "submitted" by the user. As they toggle on the interface, updates happen in the background.

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-04-20T17:32:05.117

Just like with any other "Edit Record" or "Delete This Row" button, the toggle buttons could be a Submit button/graphic element with the unique record ID (or whatever the case) to Update/Toggle/Delete in the `value` attribute.

The form handler would only need to check the `value` of the submit button (which may need a unique `name` attribute).

Please correct me if I'm wrong, but I believe that this is okay and valid in at least HTML4 and XHTML1\.

# java - 同时运行2个线程

> ID：768966
> 
> 赞同：3
> 
> 时间：2009-04-20T16:13:40.953
> 
> 标签：java, multithreading, network-programming, simultaneous-calls

在 IM 客户端的情况下。我已经制作了 2 个单独的线程来处理发送数据包（通过 std io）和接收数据包。问题是如何让这 2 个线程同时运行，以便我可以在不断提示输入的同时随时准备好接收数据包？

我已经尝试设置一个计时器，但数据总是丢失接收。

* * *

## 回答 #1

> 赞同：21
> 
> 时间：2009-04-20T16:16:22.833

没有更多细节，很难给出完整的答案。不过，这里是启动两个线程的代码：

```
Thread thread1 = new Thread () {
  public void run () {
    // ... your code here
  }
};
Thread thread2 = new Thread () {
  public void run () {
    // ... your code here
  }
};
thread1.start();
thread2.start(); 
```

* * *

## 回答 #2

> 赞同：7
> 
> 时间：2009-04-20T16:17:02.863

好吧，除非您拥有多处理器计算机，否则它们不会*同时*运行，但这通常不是问题。将会发生的情况是，每个线程都会或多或少地获得一个时间片。

如果您丢失 I/O，那么真正的问题可能不是线程。你能告诉我们你是怎么读这些东西的吗？

* * *

## 回答 #3

> 赞同：7
> 
> 时间：2009-04-20T16:23:23.083

我认为您可能错过了线程、流或两者的重要内容:-)

您可以像这样开始一个新线程：

```
myThread.start();

```

线程将被启动，并且 jvm 将自动执行 run() 方法。

如果线程运行方法正在从流中读取，并且它是唯一的读取，则它不会“错过”该流中的任何内容。

# android - 在 startActivity() 上传递一个 Bundle？

> ID：768969
> 
> 赞同：185
> 
> 时间：2009-04-20T16:13:49.767
> 
> 标签：android, android-activity, bundle

将捆绑包传递给从当前活动启动的活动的正确方法是什么？共享属性？

* * *

## 回答 #1

> 赞同：457
> 
> 时间：2009-05-04T09:23:57.347

你有几个选择：

1）使用意图[中的](http://developer.android.com/reference/android/content/Intent.html)[捆绑包](http://developer.android.com/reference/android/os/Bundle.html)：

```
Intent mIntent = new Intent(this, Example.class);
Bundle extras = mIntent.getExtras();
extras.putString(key, value); 
```

2) 创建一个新的捆绑包

```
Intent mIntent = new Intent(this, Example.class);
Bundle mBundle = new Bundle();
mBundle.putString(key, value);
mIntent.putExtras(mBundle); 
```

3）使用Intent的[putExtra()](http://developer.android.com/reference/android/content/Intent.html#putExtra(java.lang.String,%20java.lang.String[]))快捷方式

```
Intent mIntent = new Intent(this, Example.class);
mIntent.putExtra(key, value); 
```

然后，在启动的 Activity 中，您将通过以下方式阅读它们：

```
String value = getIntent().getExtras().getString(key) 
```

***注意：****对于所有基本类型、Parcelables 和 Serializables，Bundles 都有“get”和“put”方法。我只是将字符串用于演示目的。*

* * *

## 回答 #2

> 赞同：21
> 
> 时间：2009-04-20T16:25:29.130

您可以使用 Intent 中的 Bundle：

```
Bundle extras = myIntent.getExtras();
extras.put*(info); 
```

或整个捆绑包：

```
myIntent.putExtras(myBundle); 
```

这是你要找的吗？

* * *

## 回答 #3

> 赞同：17
> 
> 时间：2015-03-19T05:39:21.237

**将数据从一个Activity传递到android中的Activity**

意图包含操作和可选的附加数据。可以使用意图`putExtra()`方法将数据传递给其他活动。数据作为 extras 传递，并且是`key/value pairs`. 键始终是字符串。作为值，您可以使用原始数据类型 int、float、chars 等。我们还可以将**`Parceable and Serializable`**对象从一个活动传递到另一个活动。

```
Intent intent = new Intent(context, YourActivity.class);
intent.putExtra(KEY, <your value here>);
startActivity(intent); 
```

**从 android 活动中检索捆绑数据**

**`getData()`**您可以使用Intent 对象上的方法检索信息 。可以通过该方法检索Intent对象**。****`getIntent()`**

```
 Intent intent = getIntent();
  if (null != intent) { //Null Checking
    String StrData= intent.getStringExtra(KEY);
    int NoOfData = intent.getIntExtra(KEY, defaultValue);
    boolean booleanData = intent.getBooleanExtra(KEY, defaultValue);
    char charData = intent.getCharExtra(KEY, defaultValue); 
  } 
```

* * *

## 回答 #4

> 赞同：7
> 
> 时间：2018-02-19T07:31:04.473

您可以使用 Bundle 将值从一个活动传递到另一个活动。在您当前的活动中，创建一个捆绑包并为特定值设置捆绑包并将该捆绑包传递给意图。

```
Intent intent = new Intent(this,NewActivity.class);
Bundle bundle = new Bundle();
bundle.putString(key,value);
intent.putExtras(bundle);
startActivity(intent); 
```

现在在您的 NewActivity 中，您可以获取此捆绑包并检索您的价值。

```
Bundle bundle = getArguments();
String value = bundle.getString(key); 
```

您还可以通过意图传递数据。在您当前的活动中，像这样设置意图，

```
Intent intent = new Intent(this,NewActivity.class);
intent.putExtra(key,value);
startActivity(intent); 
```

现在在您的 NewActivity 中，您可以像这样从意图中获取该值，

```
String value = getIntent().getExtras().getString(key); 
```

* * *

## 回答 #5

> 赞同：3
> 
> 时间：2018-09-11T14:29:18.823

**写下这是你正在进行的活动：**

```
Intent intent = new Intent(CurrentActivity.this,NextActivity.class);
intent.putExtras("string_name","string_to_pass");
startActivity(intent); 
```

在 NextActivity.java

```
Intent getIntent = getIntent();
//call a TextView object to set the string to
TextView text = (TextView)findViewById(R.id.textview_id);
text.setText(getIntent.getStringExtra("string_name")); 
```

这对我有用，你可以试试。

来源：[https ://www.c-sharpcorner.com/article/how-to-send-the-data-one-activity-to-another-activity-in-android-application/](https://www.c-sharpcorner.com/article/how-to-send-the-data-one-activity-to-another-activity-in-android-application/)

# wix - 如何使用自定义操作安装第三方 MSI？

> ID：768971
> 
> 赞同：0
> 
> 时间：2009-04-20T16:13:57.990
> 
> 标签：wix, windows-installer

我有一个 Visual FoxPro 安装程序 (exe)，我想使用 WiX 自定义操作启动它。但是，我认为 VFP 安装程序是 MSI 的包装程序，因为我收到“错误 1500”，这似乎表示我正在尝试同时运行两个安装程序。

如何从我自己的 MSI 引导这个第三方 MSI？

我目前正在 InstallExecuteSequence 中启动 VFP 安装程序。我尝试在 InstallUiSequence 中运行它，但我从 ShellExec 调用我自己的安装程序，因此它不会运行 InstallUiSequence。

任何指针将不胜感激。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-04-20T16:34:17.987

当前版本的 MSI 在技术上是不可行的。推荐通过引导程序安装额外的 MSI。

请在此处查看我对相关问题的回答：[Wix and .NET Framework (prerequisites)](https://stackoverflow.com/questions/427775/wix-and-net-framework-pre-requisites)

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-04-20T16:23:44.797

你真的不能，如果你试图“解决”它，那将是一个坏主意。如果您确实需要这种功能，请使用[NISI](http://nsis.sourceforge.net/Main_Page)之类的工具来调用 3rd-party MSI，然后再调用您的。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-07-24T21:18:48.513

我已经用 Orca 打开了一个 MSI，并将其保存为 MSM（合并模块），然后将其添加到 Visual Studio 设置项目（遗憾的是不是 WiX）中，并且它工作正常。

我很确定 Orca 带有 Visual Studio，但谷歌应该会给你很好的结果来下载它。

尝试将 MSM 添加到您的 WiX 项目中，并让我们知道会发生什么。

# c# - DateTime.AddDays 的准确性如何？

> ID：768975
> 
> 赞同：3
> 
> 时间：2009-04-20T16:14:33.963
> 
> 标签：c#, datetime, rounding

由于 DateTime.AddDays() 需要一个`double`参数，我担心当您添加天数时，可能会出现一些舍入错误。例如，假设我有以下循环：

```
DateTime Now = DateTime.Today;
for (int i = 0; i < 365; ++i)
{
    Now = Now.AddDays(1);
    // do something
} 
```

我担心现在可能会从午夜开始逐渐消失。我总是很想做这样的事情，这可能会慢一点，但可以缓解我的偏执：

```
for (int i = 0; i < 365; ++i)
{
    Now = Now.AddDays(1.01).Date;
    // do something
} 
```

* * *

## 回答 #1

> 赞同：11
> 
> 时间：2009-04-20T16:21:08.360

由于`DateTime`将日期内部存储为 64 位整数，其中一个刻度表示 100 纳秒，因此不存在出错的风险。一天有 864,000,000,000 个刻度，`Double`精度至少为 15 位。因此，当四舍五入到刻度时，每个错误都会消失，因为如果等于一天，`Double`则分辨率比一个刻度更高。`1.0`

这不适用于`AddYears()`，因为如果等于一年，`Double`则没有足够的精度来表示一个刻度。`1.0`但是，如果您查看`DateTime`该类，您会发现设计尊重这一事实 -`AddMonths()`并且`AddYears()`具有整数和非浮点参数。

要检查这一点，只需执行以下代码。

```
DateTime now = DateTime.Now;

// Displays 864000000000 
Console.WriteLine(now.AddDays(1.0).Ticks - now.Ticks); 
```

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2009-04-20T16:24:01.367

一般来说，我认为你担心用双精度四舍五入是正确的，因为并非所有实数都可以用双精度表示——例如，如果你将一天的 1/3 相加 3 次，你可能不会得到正好提前一天。但是，在这种情况下，1 是一个绝对可以表达的数字，因为您只是将它乘以另一个也绝对可以用双精度表达的数字（一天中的刻度数），您应该没问题。第二个样本可能是矫枉过正。

例子：

```
DateTime now = DateTime.Today;
for (int i = 0; i < 7; ++i )
{
    for (int j = 0; j < 7; ++j )
    {
         now = now.AddDays( 1 / 7.0 );
    }
}
Console.WriteLine( DateTime.Today);
Console.WriteLine( now ); 
```

结果（2009 年 4 月 20 日）

```
4/20/2009 12:00:00 AM
4/26/2009 11:59:59 PM 
```

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2009-04-20T16:22:42.273

天数乘以一个整数（刻度），然后添加到`DateTime`. 当您传入一个整数时，您最终会添加整数个刻度。

另一方面，我不知道 .NET 对闰秒做了什么......我怀疑它使用了一个非常简单的模型，不会打扰它们，让你的代码没问题。

不要忘记添加时区会增加额外的复杂性 - 在本地添加一天可能会增加多于或少于一天的 UTC，反之亦然。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2009-04-20T16:20:11.077

你说的远离午夜是什么意思？

运行时，第一个代码的最后日期为 4/20/2010 12:00:00 AM。
我认为这就是你所期望的。不是吗？

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2009-04-20T16:20:15.073

在您的示例中，我将 1 天添加到 DateTime 变量 100,000 次，但仍然以具有午夜时间值的日期结束。似乎没有理由担心。

我确信他们正在四舍五入到时间刻度，这消除了漂移的任何问题。

# sharepoint - SharePoint：如何将自定义母版页应用于 Sharepoint 内置搜索结果页面 (OSSSearchResults.aspx)

> ID：768979
> 
> 赞同：1
> 
> 时间：2009-04-20T16:15:32.150
> 
> 标签：sharepoint, master-pages

SharePoint：如何将自定义母版页应用于 Sharepoint 内置搜索结果页面 (OSSSearchResults.aspx)

我已经应用了共享点站点来使用我自己的自定义母版页，但是搜索结果页面（OSSSearchResults.aspx）没有选择我的母版页。

谁能帮我？

非常感谢。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2009-04-20T16:23:07.280

您可以使用分配母版页的自定义开发的 HTTPModule 来执行此操作。这[是描述这种技术的一页](http://sharepointmagazine.net/technical/development/customizing-application-master-pages-masterpages-and-sharepoint-part-5-of-6)。

# entity-framework - 如何使用创建查询方法在实体框架中动态创建插入查询？

> ID：768980
> 
> 赞同：1
> 
> 时间：2009-04-20T16:15:34.397
> 
> 标签：entity-framework, entity

我正在使用类似上面的示例代码，但是当我尝试执行它时，它说查询语法错误，并且在关键字 into 附近的查询语法中存在错误...

```
System.Data.Objects.ObjectParameter[] opc=new System.Data.Objects.ObjectParameter[1];  //sample
opc[0]=new System.Data.Objects.ObjectParameter("columnname","columnvaluetoinsert")
string strQuery="insert into tablename(columnname)values(@columnname)";
var query1 = entities.CreateQuery<System.Data.Objects.DataClasses.EntityObject>(strQuery, opc);
query1.Execute(System.Data.Objects.MergeOption.NoTracking); 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2009-09-01T10:04:05.113

现在四个多月后，我可以回答这个问题了……

```
string tableName = "yourTableName";
string PrimaryColName = "PrimarykeyName";

using(Entities entities = new Entities) 
{ 
  string sQuery= " select value " + tableName + " from " + tableName + " as " + tableName; 
 sQuery += " where ";
 sQuery += tableName + ".PrimaryColName " = " + lngMasterId;

 System.Data.Objects.ObjectQuery query = new System.Data.Objects.ObjectQuery(sMasterTableName, entities); 
 //where entities is the object of your objectContext class :) 
 return query.First();//do whatever you want with the result 
} 
```

在告诉以自定义匿名格式给出结果`"value"`之后`"select"`

# search - 在 Solr 的过滤器查询中使用函数

> ID：768981
> 
> 赞同：1
> 
> 时间：2009-04-20T16:16:04.207
> 
> 标签：search, solr, filtering

我想在搜索之前过滤我的结果集。我知道正确的方法是使用过滤器查询（fq）参数。但是，我想根据在字段上执行的函数的输出进行过滤。

我有一个“评级”字段，它是一个介于 1 到 ~75000 之间的整数。上限可能会改变。我想过滤到“评分”最高的前 500 个项目。在 SQL 中，这将类似于：

```
... ORDER BY rating DESC LIMIT 500 
```

我想我可以通过使用函数 rord(rating) 降序来获得 solr 中的文档，所以基本上我想做：

```
fq=rord(rating):[0 TO 500] 
```

但这似乎不可能。有谁知道我还能做什么？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2009-04-21T08:00:36.043

感谢 Solr 邮件列表中的 Yonik Seeley：

> Solr 1.4 现在可以对任意函数进行范围查询：http: [//lucene.apache.org/solr/api/org/apache/solr/search/FunctionRangeQParserPlugin.html](http://lucene.apache.org/solr/api/org/apache/solr/search/FunctionRangeQParserPlugin.html)
> 
> 请注意 ord() 和 rord() 在 Solr 1.4 主干中无法正常工作。Lucene 已更改为在 MultiReader 中搜索每个段，因此您当前将在该段中获得 ord() 或 rord()，而不是在整个索引中。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-04-20T22:50:59.517

[在 solr-user 邮件列表中交叉发布，由 Yonik 回答](http://lucene.472066.n3.nabble.com/Using-a-function-in-a-filter-query-td496718.html)。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2009-04-20T21:17:49.130

除非我遗漏了什么，否则您不能按评级字段排序，然后简单地取前 500 个。这与您的 SQL 示例相同。

# c++ - 如何在类中正确使用结构？

> ID：768982
> 
> 赞同：3
> 
> 时间：2009-04-20T16:16:13.460
> 
> 标签：c++, winapi, class, struct

使用：VS2008、Win32、C/C++

我正在尝试将整个对话窗口封装到一个类中以实现可重用性。有点像自定义控件。在这样做时，我将我的单独函数移动到一个类中。以下结构设计虽然给我带来了问题，但 Visual Studio 输出：错误 C2334 '{'。

这是一个简单的消息地图布局。但我似乎无法逃脱这个 C2334 错误。:(

这是我的课程代码片段。

```
class CScrollingListDlg
{
private:

LRESULT DoCommandMain (HWND hWnd, UINT wMsg, WPARAM wParam, LPARAM lParam);
LRESULT DoPaintMain   (HWND hWnd, UINT wMsg, WPARAM wParam, LPARAM lParam);
LRESULT DoAnimationTimer (HWND hWnd, UINT wMsg, WPARAM wParam, LPARAM lParam);
LRESULT DoHandleTouch (HWND hWnd, UINT wMsg, WPARAM wParam, LPARAM lParam);
LRESULT DoDestroyMain (HWND hWnd, UINT wMsg, WPARAM wParam, LPARAM lParam);

//
// message maps
//
// Generic defines and data types.
struct decodeUINT {
    UINT Code;
    LRESULT (*Fxn)(HWND, UINT, WPARAM, LPARAM);
};

struct decodeCMD {
    UINT Code;
    LRESULT (*Fxn)(HWND, WORD, HWND, WORD);
};

// WM_Message dispatch table for MainWndProc.

//
// ***  error C2334 '{'  ***
//
const struct decodeUINT MainMessages[] = {
    WM_PAINT,   DoPaintMain,
    WM_DESTROY, DoDestroyMain,
    WM_QUIT,    DoDestroyMain,
    WM_COMMAND, DoCommandMain,
};

}; 
```

我在这里想念什么？

谢谢。

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2009-04-20T16:22:25.190

您不能在类声明中初始化数组成员。您应该只声​​明 MainMessages，然后在类的构造函数中对其进行初始化。

我还建议使用 std::vector 而不是数组。这样，decodeUINT 声明变为：

```
std::vector<decodeUINT> MainMessages; 
```

并在构造函数中，使用 std::vector::push_back 方法插入内容。

如果您需要访问由向量管理的内存，请使用 &MainMessages[0]。

* * *

## 回答 #2

> 赞同：5
> 
> 时间：2009-04-20T16:38:47.477

您不能以`static`这种方式为非成员指定初始化器——您通常需要声明数组，然后在构造函数中填充它......除此之外，实际上没有办法`const`在 C++ 中初始化成员数组（参见[这个线程](https://stackoverflow.com/questions/161790/initialize-a-const-array-in-a-class-initializer-in-c)） .

如果您准备`MainMessages`在所有实例中共享`CScrollingListDlg`（我怀疑这一直是您的意图），您应该这样做`static`，在这种情况下，您可以声明：

```
static const decodeUINT MainMessages[];  // "struct" keyword unnecessary 
```

在 的类定义内`CScrollingListDlg`，然后在类外定义：

```
const CScrollingListDlg::decodeUINT CScrollingListDlg::MainMessages[] = {
    WM_PAINT,   DoPaintMain,
    WM_DESTROY, DoDestroyMain,
    WM_QUIT,    DoDestroyMain,
    WM_COMMAND, DoCommandMain,    // The comma *is* allowed -- thanks Josh!
}; 
```

为了使其实际编译，您还需要 make `DoPaintMain()`、`DoDestroyMain()`等`static`- 就目前而言，它们都是隐式采用`this`指针的每个对象方法，因此它们实际上不能包含在函数中类型的指针`LRESULT (*Fxn)(HWND, UINT, WPARAM, LPARAM)`。（您可以将它们保留为非静态方法并将指针类型更改为指向`decodeUINT`成员函数的指针类型，但这可能不是您想要的。）

**[编辑：感谢 Josh 的一些有用的评论！]**

# java - JPOX JDO 和 Castor JDO 与 Hibernate 持久性的比较

> ID：768991
> 
> 赞同：0
> 
> 时间：2009-04-20T16:18:03.003
> 
> 标签：java, hibernate, persistence, jdo, castor-jdo

这些框架（JPOX JDO 和 Cater JDO）的工作原理与 Hibernate 相似吗？他们是否使用配置数据以及反射和泛型的组合？有哪些主要的架构差异？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2009-04-22T13:16:57.587

Castor JDO 不是“JDO”（Java 数据对象）。它仍然执行持久性，但不符合任何“标准”，因此在命名时会产生误导，他们知道这一点。JPOX 为持久性实现了 JDO 和 JPA 标准。DataNucleus 前段时间取代了 JPOX，是 Google AppEngine 采用的持久化方案。DataNucleus 允许 JDO/JPA 注释/XML 并支持泛型。Hibernate 是 JPA 的一个实现

——安迪（数据[核](http://www.datanucleus.org)）

# java - 如何最好地从数据库或 servlet 上下文中初始化常量？

> ID：768994
> 
> 赞同：2
> 
> 时间：2009-04-20T16:18:55.293
> 
> 标签：java, database, servlets, initialization, constants

我们在应用程序的接口中声明了常量，就像这样。

```
public interface IConstants
{
    public static final String FEVER="6";
    public static final String HEADACHE="8";
} 
```

我们现在要从数据库（或应用程序 servlet 上下文）中填充这些常量值（6 和 8）。

存储在查找表中的数据库值已经在应用程序会话中可用（在 servlet 上下文属性中），因此我不必每次都进行数据库调用。

我们如何做到这一点？

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2009-04-20T17:48:25.360

鉴于您不想过多地更改现有代码，最简单的方法是：

```
public interface IConstants {
    public static final String FEVER = getConstFromDatabase("FEVER");
    public static final String HEADACHE = getConstFromDatabase("HEADACHE");
} 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-04-20T17:18:52.670

你确定你需要吗？！

如果无论如何在添加新疾病时需要添加新代码，那么将“常量”设为数据驱动的静态（非最终）全局变量几乎没有意义。（这只会使事情复杂化。）

*   如果您担心数据库和代码之间的不匹配，您可以在启动应用程序时验证数据库和常量是否匹配。您在表格中定义了疾病并且正在使用某种参照完整性，对吗？

*   如果您确实认为您需要一种数据驱动的方法，那么您可能根本不需要任何“已知疾病”字段，因为代码不应该真正依赖这些。在这种情况下，每种疾病都应该是具有身份和其他属性的适当对象。

*   如果您需要对某些类型进行特殊处理，您可能应该再次返回枚举...

*   如果您有许多疾病（可能是动态添加的）并且只有几种类型 - 几种疾病由相同的代码以相同的方式处理；在疾病表和代码中添加一个类型作为疾病类型的枚举（或常量），并使用它来运行不同的逻辑。

*   如果每种疾病实际上都有很多复杂性，那么尝试为每种疾病编写一个类可能是个好主意。（然后你可以用子类和所有的东西做一个适当的 O/R 事情......）

自 java 5 以来，接口 enum cludge 不是必需的，因为您可以获得两个枚举并在需要时进行静态导入。

（使用枚举时，验证数据库更简单，因为您可以免费获得枚举。）

您的字段可能应该位于名为 Disease 或 SickDude 的类中，而不是巨大的全局常量类中。（例如，日历中的字段）。可能作为他们“所属”类中的内部公共枚举。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2009-04-20T16:29:03.817

由于常量值保存在数据库中，最好的方法是创建一个枚举类型并通过它使它们可用。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2009-04-20T16:30:03.083

要使它们根据数据源而变化，您需要为它们提供某种数据结构。

您可以定义一个 bean 来保存值（带有 getter/setter 的字段），或者使用映射来存储这些值。

您可能应该将此视为配置问题，而不是常量问题。从编程的角度来看，常量确实是有意的。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2009-04-20T16:24:42.660

作为*常量*，你不能随便。

使用这些成员创建一个类，保护 setter（或从构造函数中设置它们）并提供 getter 方法。

更多详情：

好的，首先，您不能轻易地从数据库中初始化常量，因为它们必须在定义时进行初始化。

相反，创建一个类似这样的类：

```
public class Constants {
    private static final String FEVER ;
    private static final String HEADACHE ;

    public Constants(String fever, String headache){
        if(FEVER == null){
            FEVER = fever;
            HEADACHE = headache;
         } else {
            // Do something; shouldn't be resetting these.
         }
    }

    public String getFever(){ return FEVER; }
    public String getHeadache(){ return HEADACHE; }
} 
```

现在，当你*构建*这个类时，你设置了 FEVER 和 HEADACHE。由于它们是静态的，因此只有一个值；由于您只有吸气剂并且它们是私有的，因此没有人可以重置它们；而且由于它们是最终的，没有人可以在你背后偷偷继承。`***************