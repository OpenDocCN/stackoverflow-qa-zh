# StackOverflow 问答 12467000-12467999

# r - 将随机后缀附加到文件名时，download.file() 失败

> ID：12467001
> 
> 赞同：1
> 
> 时间：2012-09-17T20:56:44.567
> 
> 标签：r, caching, download, browser-cache

我正在尝试在位于多个代理后面的远程服务器上下载 R 中的文件。某些东西 - 我无法弄清楚是什么 - 导致文件在我尝试在该服务器上访问它时被缓存返回，无论我是通过 R 还是只是通过 Web 浏览器。

我尝试`cacheOK=FALSE`在`download.file`通话中使用，但没有效果。

每[有没有办法强制浏览器刷新/下载图像？](https://stackoverflow.com/questions/1431512/is-there-a-way-to-force-browsers-to-refresh-download-images)我尝试在 URL 的末尾添加一个随机后缀：

```
download.file(url = paste("http://mba.tuck.dartmouth.edu/pages/faculty/ken.french/ftp/F-F_Research_Data_Factors_daily.zip?",
                          format(Sys.time(), "%d%m%Y"),sep=""), 
              destfile = "F-F_Research_Data_Factors_daily.zip", cacheOK=FALSE) 
```

这会产生例如以下 URL：

```
http://mba.tuck.dartmouth.edu/pages/faculty/ken.french/ftp/F-F_Research_Data_Factors_daily.zip?17092012 
```

当从远程服务器上的 Web 浏览器访问时，它确实返回了文件的最新版本。但是，当`download.file`在 R 中访问时，这会返回一个损坏的 zip 存档。WinRAR 和 R 的`unzip`函数都抱怨 zip 文件已损坏。

```
unzip("F-F_Research_Data_Factors_daily.zip")
1: In unzip("F-F_Research_Data_Factors_daily.zip") :
internal error in unz code 
```

我不明白为什么通过 R 下载此文件会导致返回损坏的文件，而通过 Web 浏览器下载则没有问题。

任何人都可以提出一种从 R 中击败缓存的方法（对此我不抱希望），或者为什么`download.file`不喜欢我的 URL 并在其末尾添加 ?someRandomString 的原因？

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-09-17T21:34:54.020

如果你使用它会起作用`mode="wb"`

```
download.file(url = paste("http://mba.tuck.dartmouth.edu/pages/faculty/ken.french/ftp/F-F_Research_Data_Factors_daily.zip?",format(Sys.time(),"%d%m%Y"),sep=""), 
          destfile = "F-F_Research_Data_Factors_daily.zip", mode='wb', cacheOK=FALSE) 
```

# java - 如何在spring mvc中处理多个动态表单

> ID：12467005
> 
> 赞同：3
> 
> 时间：2012-09-17T20:57:08.720
> 
> 标签：java, spring, spring-mvc

我必须有 4 个对象、组、部分和问题及其选项。每个组都有不同的部分，部分有多个问题，问题有选项。现在我必须设计表单输入系统，以便逐步覆盖每个组和部分。我在spring mvc中做这一切。

你能告诉我一个方法，我该如何解决这个问题？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-09-17T22:32:06.607

由于简单的列表绑定，您肯定可以在 Spring MVC 中做到这一点。

Spring MVC 提供了很大的自由度，所以基本上如果你只使用这个框架，你将不得不从头开始想出一个解决方案。
这是一个用例和一个解决方案。实施起来有点困难，因为它是从头开始的。随意调整它以适应您的特定需求，添加您想要的任何花哨的 UI 框架，但您应该有一个大致的想法。您可以跳到第三部分快速回答。

假设您想在一个页面中创建/编辑一个组：

*   你想编辑/添加部分到组
*   您想在任何部分编辑/添加问题
*   您想编辑/添加任何问题的选项

**一、页面设计：**

1.  您有一个带有一个大表单的 JSP 组页面（这只是一个示例）
2.  会有按钮来添加嵌套的东西。单击时，一些 javascript 将显示一个空白表单，允许包含这些东西的信息。这个空白表单本身将有按钮来添加嵌套嵌套的东西，等等（直到这些东西是一个选项）。
3.  对于您想要显示/编辑的现有内容，设计是相同的，除了表单不会是空白的
4.  您可以判断您是在创建还是编辑当前组（页面上下文或 javascript/html 技巧）。
5.  借助一些 javascript/jQuery，您可以在组内“拖放”*现有部分*的列表

**二、代码设计：**

1.  你有一个对应于 JSP 的 GroupController
2.  Group 对象有一个`List<Section> sections`属性，Section 对象有一个`List<Questions> questions`属性，等等。
3.  你有方法 createGroup 和 editGroup
4.  在提交 JSP 表单并调用 createGroup 或 editGroup 时，您可以知道该组的提交元素是否已经存在，因此您可以决定在数据库中添加或编辑/更新它们。所有这些逻辑都可以在另一个类中完成，例如 Spring 服务。
5.  您始终提供*现有部分*的可能列表（通过在两种方法中将此列表添加到模型中，或者更好的是，通过[使用 @ModelAttribute 注释的单个方法](https://stackoverflow.com/a/12124253/400545)）。这个列表可以在另一个类中计算（一个服务/DAO/两者都在最后挖掘数据库）。

**三、魔术：将 JSP 表单与 Java 控制器绑定：**

在页面中，您将拥有一个`<form:form commandName="group">`，而在​​控制器方法参数中，您将拥有一个`@ModelAttribute("group") Group group`.

现在，要提交第一个选项的名称，您将在 JSP 中有这个：

```
<form:input path="sections[0].questions[0].options[0].name" /> 
```

（或某些 javascript 生成的 html 中的等价物）。

# python - 如何从 techmeme 之类的博客/文章中获取标题？

> ID：12467007
> 
> 赞同：0
> 
> 时间：2012-09-17T20:57:17.133
> 
> 标签：python, flask-sqlalchemy

我正在创建一种新闻聚合器，我想创建一个程序（Python）来正确检测标题并显示它。我该怎么做呢？这是机器学习问题吗？

我将不胜感激任何可以为我指明正确方向的文章或书籍。

我过去的尝试包括 BeautifulSoup 和 Requests 模块。我应该检查任何其他开源模型吗？

谢谢你，费尔南多

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-09-17T21:26:08.980

抓取网页的直接方法需要人工学习——查看页面，确定您认为的标题，找出它们是如何标记的，然后使用像 BeautifulSoup 这样的解析器来查找这些标签。例如，目前 Techmeme 上的 1 级标题被标记为：

```
<DIV CLASS="ii"> 
```

2级标题是：

```
<STRONG CLASS="L1"> 
```

在您的程序获取页面并匹配您感兴趣的标签后，查看它们是否识别出您要查找的内容。如果遗漏了某些标题，请在搜索列表中添加其他标签。如果您得到误报（点击不是标题的链接），将它们清除将需要额外的页面相关逻辑。逆向工程没有魔法，只需繁重的工作和测试以及定期重新验证，以确保网站管理员没有对您进行任何操作。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-09-18T20:00:21.040

玩了一会儿后，我发现这个效果最好：

使用 BeautifuSoup 和 Requests 模块

```
r = requests.get('http://example.com')
soup = BeautifulSoup(r.text)

if soup.findAll('title'):
  title = soup.find('title')
  print title.renderContents() 
```

结果是标题文本应该使用正则表达式稍微清理一下。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-09-17T21:11:28.390

也许解析他们的 RSS\Atom 提要会容易得多。谷歌很容易提供这些链接[http://wiki.python.org/moin/RssLibraries](http://wiki.python.org/moin/RssLibraries)和[http://pypi.python.org/pypi/Atomisator/1.3](http://pypi.python.org/pypi/Atomisator/1.3)

但这些都是纯 XML，所以你可以使用内置的[urllib](http://docs.python.org/library/urllib2.html)和 XML（[DOM](http://docs.python.org/library/xml.dom.html)或[SAX](http://docs.python.org/library/xml.sax.html)）库

# iphone - 如何加快从 Web 服务加载图像的速度？

> ID：12467009
> 
> 赞同：1
> 
> 时间：2012-09-17T20:57:22.540
> 
> 标签：iphone, objective-c, ios, performance

我是 iPhone 开发的新手。在我的应用程序中，我保留了一个滚动视图，并使用 JSON 解析从 Web 服务加载了图像。不幸的是，加载它们需要太多时间。您对如何加快（下载）加载有任何建议吗？

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-09-17T21:03:45.457

好吧，您可以采取许多路线来加快图像加载速度，但我最推荐的一件事是利用 AFNetworking 的`"UIImageView+AFNetworking"`类别，您可以在此处找到：

[http://afnetworking.com/](http://afnetworking.com/)

它可以快速加载图像并且不会占用主线程。如果您想要在下载时显示预加载器图像，您也可以这样做。

这真的很容易：

```
[imageView setImageWithURL:[NSURL URLWithString:@"…"]]; 
```

# mongodb - 寻找支持 CAS 的 CA 键值存储

> ID：12467011
> 
> 赞同：0
> 
> 时间：2012-09-17T20:57:25.333
> 
> 标签：mongodb, replication, consistency, voldemort

我正在寻找一种支持一致性、可用性和比较和设置的持久键值存储。

它将部署在三个节点上，并且必须在一个（任何）节点关闭时可操作。如果整个集群离线（例如由于电源问题）然后又重新在线，它不应该丢失任何数据。此外，我希望系统不会打扰系统管理员，除非两个节点已关闭。当然，希望尽可能快。最重要的特性是一致性：如果报告保存了某些内容，则它不会因失败而丢失。

我探索了 MongoDB 的[文档](http://docs.mongodb.org/manual/core/replication/#rollbacks)，在一些罕见的情况下它需要手动干预，但这不是可选的。

我查看的另一个系统是[伏地魔](http://www.project-voldemort.com/voldemort/)。我假设它通过以下设置满足我的要求：

```
<replication-factor>3</replication-factor>
<required-reads>2</required-reads>
<required-writes>2</required-writes> 
```

但它没有提供关于复制和一致性的全面文档，所以我无法验证我的假设。

您是否有适合我要求的存储体验？你能给我推荐点什么吗？

PS我不打算存储大量信息，因此可以省略分片。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-09-17T21:26:48.867

如果您使用带有“多数”写入关注点的 MongoDB，那么您将永远不会丢失数据，也永远不会有回滚。

“多数”（或三节点副本集中的“2”）的写入关注将执行相当于伏地魔中的“必需写入”2。

参考：

*   [http://docs.mongodb.org/manual/applications/replication/#replica-set-write-concern](http://docs.mongodb.org/manual/applications/replication/#replica-set-write-concern)
*   [http://docs.mongodb.org/manual/reference/command/getLastError/](http://docs.mongodb.org/manual/reference/command/getLastError/)

# wpf - XamDataGrid CellValuPresenter 工具提示样式

> ID：12467012
> 
> 赞同：1
> 
> 时间：2012-09-17T20:57:27.410
> 
> 标签：wpf, binding, infragistics

我正在尝试为我的 XamDataGrid 创建一个样式，以便我可以根据悬停的当前单元格确定要在工具提示中显示的值。

我正在尝试以下内容：

```
<Style x:Key="MyCVPStyle" TargetType="{x:Type igDP:CellValuePresenter}">
        <Setter Property="ToolTip">
            <Setter.Value>
                <StackPanel>
                    <ListView ItemsSource="{Binding RelativeSource={...}, Path=Field, Converter={StaticResource MyFieldConverter}}">
... 
```

样式的 DataContext 设置为 DataRecord。我遇到的问题是我不知道如何访问单元格值呈现器的实际字段。

我尝试将源设置为：

```
{Binding RelativeSource={RelativeSource AncestorType={x:Type igDP:CellValuePresenter}}, Path=Field 
```

但失败并出现绑定错误：

```
System.Windows.Data Error: 4 : Cannot find source for binding with reference 'RelativeSource FindAncestor, AncestorType='Infragistics.Windows.DataPresenter.CellValuePresenter', AncestorLevel='1''. BindingExpression:Path=Field; DataItem=null; target element is 'ListView' (Name=''); target property is 'ItemsSource' (type 'IEnumerable') 
```

如何访问/绑定到 CellValuePresenter.Field 以便我可以将该值传递给我的转换器？

作为参考，我有其他 CellValuePresenter 样式在我访问字段时可以正常工作。例如，这里的第二个绑定参数是 Field，通过引用 Self 来访问：

```
<Setter Property="BorderThickness">
  <Setter.Value>
    <MultiBinding Converter="{StaticResource BorderThicknessConverter}">
      <MultiBinding.Bindings>
        <Binding Path="DataItem" />
        <Binding RelativeSource="{RelativeSource Self}" Path="Field" />
      </MultiBinding.Bindings>
    </MultiBinding>
  </Setter.Value>
</Setter> 
```

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-09-18T03:09:03.213

您可以使用 ToolTip 的 PlacementTarget 属性，即 CellValuePresenter，并将其设置为 ListView 绑定到的 DataContext：

```
<Setter Property="ToolTip">
    <Setter.Value>
        <ToolTip DataContext="{Binding RelativeSource={RelativeSource Self}, Path=PlacementTarget}">
            <StackPanel>
                <ListView ItemsSource="{Binding Path=Field, Converter={StaticResource MyFieldConverter}}"></ListView>
            </StackPanel>
        </ToolTip>
    </Setter.Value>
</Setter> 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2014-03-20T15:08:43.757

我找到了一个我觉得更直接的替代解决方案。

创建以下样式（我相信您尝试将 ItemsSource 绑定到的属性名为 Field）

```
<Style x:Key="MyCVPStyle" TargetType="{x:Type igDP:CellValuePresenter}">
    <Setter Property="ToolTip">
        <Setter.Value>
            <StackPanel>
                <ListView ItemsSource="{Binding Path=Cells[Field].Value}" />
            </StackPanel>
        </Setter.Value>
    </Setter>
</Style> 
```

但这确实要求您拥有将 ItemsSource 绑定到 FieldLayout.Fields 中定义的字段。您可能希望将该字段的可见性设置为折叠。我还包括了应用了工具提示样式的字段。

```
<igDP:Field Label="Value" Name="Value" >
    <igDP:Field.Settings>
        <igDP:FieldSettings CellValuePresenterStyle="{StaticResource ResourceKey=MyCVPStyle}" />
    </igDP:Field.Settings>
</igDP:Field>
<igDP:Field Label="Field" Name="Field" Visibility="Collapsed" /> 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-09-17T22:54:35.410

您可以为 XamDataGrid 中的不同字段使用不同的样式，以便已经为特定字段设置了每种样式。

绑定失败的原因是工具提示显示在弹出窗口中，因此它是另一个窗口，而不是与 CellValuePresenter 位于同一可视树中。

# jquery - show hide jQuery 显示所有隐藏的 tr

> ID：12467013
> 
> 赞同：0
> 
> 时间：2012-09-17T20:57:29.070
> 
> 标签：jquery, show

嘿伙计们，我正在与这个论坛合作，我想隐藏类别列表，当您单击 th 时，它将显示 tr 文件。这将是更多的主题讨论。

jQuery-

```
<script type="text/javascript"> 
$(document).ready(function() { 
$(".slidingDiv").hide(); 
$('.show_hide').click(function() { 
    $('.slidingDiv').slideToggle();
}); 
});

</script> 
```

然后继承人我正在使用的html。

```
<table rules="groups" class="highlight" width="100%" border="0" cellspacing="1" cellpadding="0">
<tr>
  <left>    <th colspan="{catrow.tablehead.INC_SPAN}" nowrap="nowrap" width="100%" style="cursor:pointer;" class="secondarytitle show_hide">&nbsp;{catrow.tablehead.L_FORUM}&nbsp;</th></left>
</tr>
<!-- END tablehead -->
<!-- BEGIN cathead -->
<tr class="highlight">
    <!-- BEGIN inc -->
    <td class="{catrow.cathead.inc.INC_CLASS}" width="46"><img src="{SPACER}" height="0" width="46" /></td>
    <!-- END inc -->
    <td class="{catrow.cathead.CLASS_CAT}" colspan="{catrow.cathead.INC_SPAN}" width="100%">
        <h{catrow.cathead.LEVEL} class="hierarchy">
            <span class="cattitle">
                <a class="cattitle" title="{catrow.cathead.CAT_DESC}" href="{catrow.cathead.U_VIEWCAT}">{catrow.cathead.CAT_TITLE}</a>
            </span>
        </h{catrow.cathead.LEVEL}>
    </td>
    <td class="{catrow.cathead.CLASS_ROWPIC}" colspan="3" align="right">&nbsp;</td>
</tr>
<!-- END cathead -->
<!-- BEGIN forumrow -->
<tr class="slidingDiv">
    <!-- BEGIN inc -->
    <td class="{catrow.forumrow.inc.INC_CLASS}" width="46"><img src="{SPACER}" height="0" width="46" alt="." /></td>
    <!-- END inc -->
    <td class="{catrow.forumrow.INC_CLASS}" align="center" valign="middle">
        <img title="{catrow.forumrow.L_FORUM_FOLDER_ALT}" src="{catrow.forumrow.FORUM_FOLDER_IMG}" alt="{catrow.forumrow.L_FORUM_FOLDER_ALT}" />
    </td>
    <td class="row1 over" colspan="{catrow.forumrow.INC_SPAN}" valign="top" width="100%" height="50">
        <table width="100%"><tbody><tr><td><h{catrow.forumrow.LEVEL} class="hierarchy">
        <span class="forumlink"> 
```

它可以工作，除非我单击它显示所有 tr 文件。我希望它在单击时显示一个。现在我可以给它们贴上标签

```
$('#category tr').click(function(){ 
```

除了它使用 php 文件或其他东西并在有人创建新类别时自动生成，所以这是不可能的。我正在与一个网站合作创建论坛。所以我知道我可以使用 jQuery 无法访问 php 文件。有人可以帮我处理 jQuery

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-09-17T21:17:22.227

这样的事情应该做：

```
$(".slidingDiv").hide(); 

$('.show_hide').click(function() { 
    $(this).closest('tr').siblings('.slidingDiv').slideToggle();
}); 
```

的使用`this`将允许您找到与被点击的`.slideingDiv`相关的适当的。`.show_hide`

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-09-17T21:38:19.400

"filter()" 方法也可用于针对所有 tr 进行复杂测试

您可以将过滤器函数作为参数传递...

此函数必须返回一个布尔值，它将确定是否必须过滤当前节点

```
$('.show_hide').click(function() { 
    $('.slidingDiv').filter(function(i,e){
        // Ex: return whether the current tr has a particular descendant 
        return (!!$(this).find('span.foo').length);
    }).slideToggle();
}); 
```

# android - 如何处理android中的互联网连接问题

> ID：12467016
> 
> 赞同：0
> 
> 时间：2012-09-17T20:57:47.757
> 
> 标签：android

我已经研究了这里的大部分问题，但没有找到可行的解决方案。

我正在设计一个高度使用互联网连接的应用程序。我永远需要从 Web 服务请求/接收信息。

我已经尝试过使用互联网的所有代码

```
 try
    {
       //use of internet here
    }
   catch (Exception e)
   {
          //Alert dialog that states internet connection is down
   } 
```

但这似乎不起作用。由于某种原因，这里没有捕获异常。

我尝试了一种解决方法，我在这里找到了一个解决方案。用于：

```
 public static boolean isOnline(Context context) {
    ConnectivityManager cm =(ConnectivityManager)context.getSystemService(Context.CONNECTIVITY_SERVICE);
    NetworkInfo netInfo = cm.getActiveNetworkInfo();
    if (netInfo != null && netInfo.isConnectedOrConnecting()) {
        return true;
    }
    return false;
} 
```

并像这样使用它：

```
 if (Utilities.IsOnline(context))
         {
          //Code that uses internet
         } 
```

如果在 IsOnline 检查后立即丢失连接会发生什么？我该如何治疗这种情况？谢谢！

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-09-17T21:14:14.683

检查后检查互联网是否出现故障的唯一方法`isOnline`是注册一个[`BroadcastReceiver`](http://developer.android.com/reference/android/content/BroadcastReceiver.html)监听网络连接更改的监听器。[在这个答案](https://stackoverflow.com/questions/1783117/network-listener-android)中有一个完整的代码示例。

我建议，如果您还没有这样做，请在其中运行您的代码，[`AsyncTask`](http://developer.android.com/reference/android/os/AsyncTask.html)以便它可以运行自己的循环（或一系列语句）并检查每个循环/迭代/计算的连接状态，如果断开连接则停止。

# jquery - 在 IE9 中，当 async 参数指定为 null 时，jQuery.ajax 不会调用回调

> ID：12467019
> 
> 赞同：0
> 
> 时间：2012-09-17T20:58:15.630
> 
> 标签：jquery, ajax, asynchronous, internet-explorer-9

我花了一段时间试图理解为什么我的 jQuery.ajax 调用没有调用回调函数，即使我可以在网络上看到 POST 请求成功。

我的代码看起来像这样：

```
var invokeService = function (url, action, parameters, callback, async, errorFn) {
    var jqXhr = $.ajax({
        async:async,
        type:'POST',
        cache:false,
        url:url + '?action=' + action,
        contentType:'application/json; charset=utf-8',
        data:$.toJSON(parameters),
        done:callback,
        fail:errorFn
    });
}; 
```

我这样称呼它：

```
invokeService(serviceUrl, 'ActionFn', {param:'one'}, successFn, null, failFn); 
```

我无法弄清楚为什么我的回调在其他浏览器上被调用，但不是 IE9。

我发布了我找到的答案，以便将来如果它发生，我可以再次找到它，因为我在这里找不到答案......

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-09-17T20:58:15.630

我发现当您在 IE9 中时，`async`参数`$.ajax`不喜欢传入空值。

我将代码更改为显式使用or`true`参数，它开始工作：`false``async`

```
var invokeService = function (url, action, parameters, callback, errorFn) {
    var jqXhr = $.ajax({
        async:true, //<--- In my case I could just hard code it, probably even remove this param.
        type:'POST',
        cache:false,
        url:url + '?action=' + action,
        contentType:'application/json; charset=utf-8',
        data:$.toJSON(parameters),
        done:callback,
        fail:errorFn
    });
}; 
```

# css - CSS3 过渡延迟

> ID：12467023
> 
> 赞同：1
> 
> 时间：2012-09-17T20:58:20.563
> 
> 标签：css, css-transitions

有没有办法通过纯 CSS 设置序列转换延迟。

在 JS 中，我会使用诸如 for 循环和计数器之类的东西来错开延迟值。这可以在 CSS 中使用

还有一种方法可以在过渡速记上设置多个属性。下面的示例仅显示顶部，当我尝试放置其他内容时它不起作用。

单一物业

```
 -moz-transition: top 0.3s ease-out 0s; 
```

多个属性

```
 -moz-transition: top left bottom 0.3s ease-out 0s; 
```

**第二个问题不如第一个重要。**

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-09-17T21:07:26.593

这里有两个问题，但是对于第二个问题，您可以改用长手版本：

```
-moz-transition-property: top, left, bottom;
-moz-transition-duration:0.3s
etc. 
```

对于问题 1，您并不清楚您在问什么——您已经意识到您可以设置延迟，那么您想要做的事情是通过添加延迟无法解决的吗？

老实说，您极有可能不得不将 JS 用于更复杂的事情，因为通常需要一些在 CSS 中无法完成的逻辑。

# javascript - jQuery 扩展原型

> ID：12467026
> 
> 赞同：1
> 
> 时间：2012-09-17T20:58:40.347
> 
> 标签：javascript, jquery

嗨，我对 jQuery 和 JavaScript 比较陌生，并且对`$.extend`. 我`extend`用来覆盖扩展“基类”的类的原型。让我们调用基类和`Parent`子类/扩展类`A`和`B`. 现在，当我使用它时，Prototype 的内容`$.extend(true, A.prototype, {someObject: {extraKey: 'value'}});`似乎也发生了变化，如果多个对象/类从父级继承，则会导致非常奇怪的行为。此外，仅当使用“深度”扩展时才会发生这种情况。`Parent``someObject`

我设法通过使用各自的原型扩展一个空对象，然后使用扩展的返回值作为新原型来避免这个问题。例如`A.prototype = $.extend(true, {}, A.prototype, {someObject: {extraKey: 'value'}});`

为了显示问题，我创建了这个小 jsfiddle：http: [//jsfiddle.net/x8UtF/12/](http://jsfiddle.net/x8UtF/12/)

实际问题：有没有办法绕过空的物体和东西`extend(true, X.prototype, {});`

* * *

## 回答 #1

> 赞同：8
> 
> 时间：2012-09-17T22:10:56.650

所以，当你这样做时：

```
$.extend( true, A.prototype, {
    someObject: {Aone: 1, Atwo: 2}
}); 
```

结果会发生这种情况：

1.  属性`"Aone"`, 和`"Atwo"`将被分配给`Parent.prototype.someObject`, 而不是`A.prototype.someObject`（此时不存在事件）。
2.  将创建该属性`A.prototype.someObject`，并将其值设置为`Parent.prototype.someObject`。

因此，`A.prototype.someObject`和`Parent.prototype.someObject`都将引用同一个对象：

```
A.prototype.someObject === Parent.prototype.someObject // true 
```

当然，这*不是*你想要的。

* * *

话虽这么说，我担心你的模式不好。`A.prototype`应该*继承*自`Parent.prototype`，但您将值从**复制**`Parent.prototype.someObject`到`A.prototype.someObject`。

另外，您当前的解决方案：

```
A.prototype = $.extend( true, {}, A.prototype, {
    someObject: {Aone: 1, Atwo: 2}
}); 
```

不直观。破译代码在做什么并不容易。我建议重新评估该模式。（当然，您可以向 Stack Overflow 寻求帮助。）

# c - ANSI C - 使用 typedef 为指针类型分配替代名称的好处

> ID：12467027
> 
> 赞同：4
> 
> 时间：2012-09-17T20:58:42.610
> 
> 标签：c

> **可能重复：**
> [typedef 类型和相同类型的指针的正确方法是什么？](https://stackoverflow.com/questions/3465976/what-is-the-right-way-to-typedef-a-type-and-the-same-types-pointer)

我最近在我的项目中使用了 Libxml2，并注意到它使用如下 typedef：

```
typedef struct _xmlNode xmlNode
typedef xmlNode * xmlNodePtr 
```

第一个 typedef 的好处是显而易见的。但是我不确定为什么要为 xmlNode * 分配一个替代名称。**对我来说，使用xmlNode ***比使用**xmlNodePtr**更明确和可读，但我可能会遗漏一些东西。

这个 typedef 会解决什么问题，又会带来什么好处呢？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-09-17T21:05:58.510

C API 通常提供*不透明的句柄*，这会阻止消费者询问它们是什么并试图戳进去。这些句柄是指针这一事实无关紧要，对消费者来说应该无关紧要，她也不应该为额外的星号带来的词汇混乱负担。

例如，完全可以通过定义句柄来编写 C++ 绑定：

```
typedef void * MyHandle; 
```

现在我们给幸福的 C 消费者一些功能：

```
MyHandle create_gizmo();
void destroy_gizmo(MyHandle);
int do_magic(MyHandle, int, int); 
```

就那么简单。用户立即看到如何使用它：

```
#include "MagicAPI.h"

MyHandle h = create_gizmo();

submit_result(do_magic(h, 12, 91));

destroy_gizmo(h); 
```

C++ 库开发人员只需解开句柄并填充 API 函数（当然是声明的`extern "C"`）：

```
#include "MagicAPI.h"
#include "SuperGizmo.hpp"

MyHandle create_gizmo() { return static_cast<MyHandle>(new SuperGizmo); }

void destroy_gizmo(MyHandle h) { delete static_cast<SuperGizmo *>(h); }

int do_magic(MyHandle h, int a, int b)
{
    return static_cast<SuperGizmo *>(h)->foo(a, b);
} 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-09-17T21:05:24.687

对于某些人来说，名称中带有“ptr”的 typedef 比使用普通指针语法的声明更具可读性和“自然性”。如果你喜欢写作

```
foo* p; 
```

代替

```
foo *p; 
```

那么指针 typedef 可能会吸引您，因为它专门避免了写入错误

```
foo* p, q; 
```

当你的意思是

```
foo *p, *q; 
```

相反，你可以写

```
fooptr p, q; 
```

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-09-17T21:18:50.260

> 这个 typedef 会解决什么问题，又会带来什么好处呢？

我的观点是 typedefing 对象指针是不好的，不应该这样做。

首先，它通过隐藏声明的对象是指针类型来改变 C 语言的语法。

第二种类型限定符 ( `const`and `volatile`) 不能穿透 typedef。

如果我们以您的为例：

```
typedef struct _xmlNode xmlNode;
typedef xmlNode * xmlNodePtr; 
```

现在无法声明对象，因此指针对象`const`使用`xmlNodePtr`别名。

```
const xmlNodePtr xp; 
```

手段`xp`不是。`const`_`*xp`

```
const xmlNode x = /* ... */;
const xmlNodePtr xp = &x;  // Error! 
```

顺便说一句，在 Linux 内核编码风格中，他们还建议不要使用`typedef`指针：

> “将 typedef 用于结构和指针是*错误的。”*

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2012-09-17T21:23:11.773

有一些区别。

首先，如果您在一行中执行多个声明，则以下两个片段是等效的：

```
char *c1, *c2, *c3, *c4;

typedef char * charPtr;
charPtr c1, c2, c3, c4; // I don't need to repeat the unary * everywhere 
```

这在一定程度上很有用，因为您可能会在尝试执行以下操作时遇到语义问题：

```
char * c1, c2, c3, c4; // declares one char pointer and three chars 
```

其次，它们可以极大地简化函数指针类型的定义，这为几乎无限的丑陋和肮脏提供了机会。

```
float (*someCrazyFunction)(float(*)(), float) = foo; // WTF is this

typedef float (*crazyFunction)(float(*)(), float);
crazyFunction myCrazyFunction = foo; // easier to deal with 
```

[这是一个演示所有这些行为的ideone。](http://ideone.com/QoAqN)

# python - 处理 wxWidgets 事件期间的一个有趣错误

> ID：12467031
> 
> 赞同：0
> 
> 时间：2012-09-17T20:59:02.830
> 
> 标签：python, events, wxwidgets

我正在使用 wxWidgets 库编写一些 Windows 应用程序，并且我坚持了一些有趣的事情：

```
 def HandleDblclick (self, event):
        self.ItemActivation (event.GetItem ())

    def HandleKeydown (self, event):
        keyc = event.GetKeyCode ()
        if keyc == 13:
            self.ItemActivation (event.GetItem ())
        elif keyc == 32:
            self.ItemSelection (event.GetItem ())
        self.sbar.SetStatusText (str (keyc) + " was pressed.")

    def HandleRclick (self, event):
        self.ItemSelection (event.GetItem ()) 
```

（是的，它是 Python）。ItemActivation() 和 ItemSelection() 做了所有的脏活。但只有当我按下鼠标按钮时。当我输入一个密钥时，我得到以下输出：

```
File "C:\Python27\lib\site-packages\wx-2.8-msw-unicode\wx\_controls.py", line 5315, in GetItemPyData
return _controls_.TreeCtrl_GetItemPyData(*args, **kwargs)
wx._core.PyAssertionError: C++ assertion "param" failed at ..\..\src\msw\treectrl.cpp(1083) in wxTreeCtrl::SetItemData(): failed to change tree items data 
```

我正在尝试编写 TreeCtrl。有趣的是，尽管树扩展错误（输入键），但项目选择（空格）根本不起作用。

发生了什么事，为什么？我认为 wxWidgets 尝试处理该事件两次，一次使用他们的默认处理程序，两次使用我的。但如果我是正确的，如何禁用 wx.TreeCtrl 的默认键盘事件处理？

提前致谢。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-09-18T09:29:35.980

首先，尝试自己在任何本机控件中处理键盘是个*坏主意。*只需完全删除您的`EVT_KEY_DOWN`处理程序并进行处理`EVT_TREE_ITEM_ACTIVATED`。这可以保证在所有平台上都有效，这与从本机控件中窃取事件不同，后者可能真的希望自己拥有它。

其次，关于`SetItemData()`失败的错误似乎与您显示的代码没有任何关系，因为它根本没有调用此函数。因此，您不能向我们展示所有相关部分。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-09-18T09:59:11.653

这就是为什么这个错误很有趣。我不设置任何数据项；我实际上尝试接收它。臭名昭著的行是我的两个脏活函数中的第一行：

```
ikey = self.GetPyData (item) 
```

我真的不知道发生了什么以及为什么 wxWidgets 引擎会尝试将一些数据分配给项目。我向 Google 叔叔询问了这个错误，但我没有得到可用的信息。

感谢您对键盘处理的评论。

# jakarta-ee - Spring容器未获取DBCP数据源

> ID：12467032
> 
> 赞同：0
> 
> 时间：2012-09-17T20:59:04.183
> 
> 标签：jakarta-ee, spring-mvc, datasource, apache-commons-dbcp

**背景**

我是春天的新手。我正在使用 Spring MVC 3 和 Springsource 的 spring 工具套件。我正在运行他们提供的示例 Spring 模板。我正在为我的数据源使用 Apache DBCP。

**问题**

我已经能够使用注释注入 bean，但我无法让容器获取我在 servlet-context.xml 文件中定义的数据源。内容如下。如果我自动连接我的数据源，那么在任何使用它的地方都会得到一个空指针异常，表明没有注入依赖项。这适用于我尝试自动装配的任何其他类。我很确定这与我在 XML 文件中定义 bean 的方式有关，但我已经看到了几种不同的方法，所以我不确定什么适合我的版本。

```
<?xml version="1.0" encoding="UTF-8"?> 
```

http://www.springframework.org/schema/mvc/spring-mvc-3.0.xsd [http://www.springframework.org/schema/beans](http://www.springframework.org/schema/beans) http://www.springframework.org/schema/beans/spring- beans-3.0.xsd [http://www.springframework.org/schema/context](http://www.springframework.org/schema/context) http://www.springframework.org/schema/context/spring-context-3.0.xsd">

```
<!-- DispatcherServlet Context: defines this servlet's request-processing infrastructure -->

<!-- Enables the Spring MVC @Controller programming model -->
<annotation-driven />

<!-- Handles HTTP GET requests for /resources/** by efficiently serving up static resources in the ${webappRoot}/resources directory -->
<resources mapping="/resources/**" location="/resources/" />

<!-- Resolves views selected for rendering by @Controllers to .jsp resources in the /WEB-INF/views directory -->
<beans:bean class="org.springframework.web.servlet.view.InternalResourceViewResolver">
    <beans:property name="prefix" value="/WEB-INF/views/" />
    <beans:property name="suffix" value=".jsp" />
</beans:bean>

<beans:bean id="dataSource" class="org.apache.commons.dbcp.BasicDataSource" destroy-method="close">
    <beans:property name="driverClassName" value="org.mysql.jdbc"/>
    <beans:property name="url" value="jdbc:mysql://localhost:3306/mydb"/>
    <beans:property name="username" value="root"/>
    <beans:property name="password" value="admin"/>
</beans:bean>   

<context:component-scan base-package="com.mycompany.myapp2" /> 
```

服务器返回的部分错误是

> java.lang.NoClassDefFoundError: org/apache/commons/pool/KeyedObjectPoolFactory

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-09-18T03:37:53.990

KeyedObjectPoolFactory 是 commons-pool 工件的一部分

在你的 pom 上添加这个。

```
<dependency>
    <groupId>commons-pool</groupId>
    <artifactId>commons-pool</artifactId>
    <version>1.6</version>
</dependency> 
```

# jquery - One() 不能与 AJAX 一起使用？

> ID：12467033
> 
> 赞同：9
> 
> 时间：2012-09-17T20:59:06.273
> 
> 标签：jquery, ajax

我的页面上有三个 div 框在每个 div 框中，我按下一个删除按钮，可以从代码中删除 div 框。同一事件中的 ajax 请求会根据按下的 div 框向服务器发送一个唯一编号。为了防止在删除按钮上调用多个单击事件，我使用了 one() 事件。但是在我快速单击按钮的罕见事件中，它会触发该事件两次，并且我看到数据库收到重复的数字。我认为 one() 可以防止这种情况发生。我的 jquery 代码可能有什么问题导致它触发两次？我的代码如下。

HTML 中的示例按钮

```
<input id="delete_post_3" type="button" value="X"> 
```

jQuery 代码

```
$('#delete_post_1').one('click', function() {
    var session_user_id = <? php echo $session_user_id; ?> ;
    var number = 1;
    $.post('ajax_delete_post.php', {
        user_id: session_user_id,
        number: number
    }, function() {
        $('#post_1').remove();
    });
});

$('#delete_post_2').one('click', function() {
    var session_user_id = <? php echo $session_user_id; ?> ;
    var number = 2;
    $.post('ajax_delete_post.php', {
        user_id: session_user_id,
        number: number
    }, function() {
        $('#post_2').remove();
    });
});

$('#delete_post_3').one('click', function() {
    var session_user_id = <? php echo $session_user_id; ?> ;
    var number = 3;
    $.post('ajax_delete_post.php', {
        user_id: session_user_id,
        number: number
    }, function() {
        $('#post_3').remove();
    });
}); 
```

更新：根据请求，我将对整个页面的代码进行简要说明。

```
<script>

//when document is ready, loads jquery code that allows any div boxes that currently   
//exist on the page to have a click event that will delete the box. this is the same 
//code seen above in my example.

</script>

<form>
//form to fill out info
</form>

<script>
//ajax post sent when form button clicked
$.post('ajax_file.php', {data: data}, function(data){

//in here div box is created

<script>

//duplicated jquery code from top of page. without it the div box delete button does 
//not work

</script>

});

</script> 
```

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-09-23T00:59:19.830

我不知道这个问题是否已排序，但鉴于评论中的所有反馈，您似乎绑定`one`了两次，而且似乎也基于您在`user23875`答案中留下的评论，您知道这一点。

如果你绑定事件两次，它会执行两次，就这么简单。

如果您完全知道您绑定了两次事件，为什么不先尝试取消绑定任何先前附加的事件。

```
$('#delete_post_1').off('click').one('click', function() {
...
$('#delete_post_2').off('click').one('click', function() {
...
$('#delete_post_3').off('click').one('click', function() { 
```

除非您还重新渲染完整的 HTML 两次，否则以上将确保您只附加了一次单击事件。

正如`user23875`已经指出的那样，您肯定在脚本中做了一些时髦的事情。

你应该尽可能地分离你的代码，以确保你只打算运行的代码只会被调用，依此类推。

希望以上内容能解决这个问题。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-09-17T21:21:55.890

好吧，首先检查您是否在回显`<`之间没有空格……这可能是一个可能的解决方案，其余接缝是正确的。`php``session_user_id`

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-09-17T21:29:58.800

你能试试这个代码并检查控制台是否触发两次？

```
$('#delete_post_3').on('click', function(event) {
    var session_user_id = <?php echo $session_user_id;?> ;
    var number = 3;
    $.post('ajax_delete_post.php', {
        user_id: session_user_id,
        number: number
    }, function() {
        $('#post_3').remove();
    })
    $(this).off(event);
}) 
```

## 编辑

尝试最后一件事：引号

```
"user_id": session_user_id,
"number": number 
```

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2012-09-21T00:26:05.247

您如何`'.disabled'`在单击时向按钮添加一个类，并让单击事件`:not(.disabled)`在事件选择器上有一个？

例子：

`$('#delete_post_1:not(.disabled)').one('click', function() { $(this).addClass('disabled'); var session_user_id = <? php echo $session_user_id; ?> ; var number = 1; $.post('ajax_delete_post.php', { user_id: session_user_id, number: number }, function() { $('#post_1').remove(); }); });`

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2012-09-24T11:41:49.080

根据我在您的文档中的理解：

```
<script>
   //if #delete_post_1 exists in the page, it receives a "once" event handler to delete #post_1
</script>

<form>
</form>

<script>
$.post('ajax_file.php', {data: data}, function(data){
   //if the request succeeds, this html code is loaded into the DOM
<script>
       //are you sure that you do not bind a *second* "once" event handler to #delete_post_1 ?
</script>
});

</script> 
```

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2012-09-24T11:44:28.893

您似乎正在使用同步调用问题。将所有代码从 click 函数删除到新函数。单击时调用该函数。也使用异步ajax请求。

* * *

## 回答 #7

> 赞同：0
> 
> 时间：2012-09-27T06:20:36.607

你应该锁定你的帖子，也许把所有东西都放在一个这样的函数中：

```
 var locker = 0;
        $('.delete_post').on('click', function() {
        if (locker == 0)
        {
        locker = 1;
        var session_user_id = <? php echo $session_user_id; ?> ;
        var number = $(this).attr('id');
        $.post('ajax_delete_post.php', {
        user_id: session_user_id,
        number: number
        }, function() {
        $('#'+number).remove();
        locker = 0
        });
        }
        }); 
```

您的输入内容当然应该是这样的：

```
<input id="3" class="delete_post" type="button" value="X">
 <input id="2" class="delete_post" type="button" value="X">
  <input id="1" class="delete_post" type="button" value="X"> 
```

* * *

## 回答 #8

> 赞同：0
> 
> 时间：2012-09-27T20:56:42.760

每次添加更多按钮时停止绑定事件，而是使用事件委托仅绑定一次。

```
var session_user_id = <? php echo $session_user_id; ?> ;
$("#someparentelement").on( "click", "button[id^=delete_post]:not(.handled)", function(){
    var theid = this.id.replace(/delete_post_/i,"");
    $(this).addClass("handled");
    $.post('ajax_delete_post.php', {
        user_id: session_user_id,
        number: theid
    }, function() {
        $('#post_' + theid).remove();
    });
}); 
```

小注意，我怀疑你不需要 pass `user_id`，php 应该能够将它从会话中拉出来。

编辑：糟糕，`.one`delegated 总体上仍然只触发一个事件，而不是每个孩子一个。更新为类似`.on`功能。

[http://jsfiddle.net/JPULH/](http://jsfiddle.net/JPULH/)

**重要**
不要将此代码放在会执行多次的位置。

* * *

## 回答 #9

> 赞同：0
> 
> 时间：2012-09-27T22:12:08.553

我知道您的问题是关于找出您的 one() 不起作用的原因。但看起来，在讨论过程中，我们都确定您最终创建了多个 one() 声明。我们现在还知道，您声明的每个 one() 都会执行一次，这对您的情况来说是不希望的。虽然该发现在技术上回答了您的问题，但我相信您的问题没有解决。我在想也许你对问题的处理方法可以修改并最终制作了这个 JS 小提琴：

[http://jsfiddle.net/sEvAn/45/](http://jsfiddle.net/sEvAn/45/)

我的建议要点：

1.  将您的点击事件绑定到 OUTER div 包装器（在我的示例中为“#post_list”）。这允许您始终检测删除按钮的点击，即使是通过 ajax 调用新创建/添加到您的 DOM 的帖子。
2.  在每个按钮上包含自定义 data-postid 属性，以便轻松确定需要删除的帖子 ID。
3.  在我的示例中，我使用了一个缓慢的 fadeOut 来模拟一个缓慢的 ajax 调用。但重点是展示如何使用完成回调函数来做其他事情（比如删除已成功删除的 DOM 元素。

差不多就是这样。这是我第一次尝试回答有关 stackoverflow 的问题，所以希望对您有所帮助！

# python - MySQL寻找现有的Windows路径

> ID：12467034
> 
> 赞同：0
> 
> 时间：2012-09-17T20:59:10.993
> 
> 标签：python, mysql, mysql-python

我正在存储有关从二进制文件中读取的文件的信息。我正在使用 mysql 来存储信息。其中一列是文件的绝对路径。此代码将定期运行，因此我想检查此特定文件之前是否未解析过。

我正在尝试执行：

```
path = os.path.join(root,f)

sql = "SELECT * FROM %s WHERE Filepath = %s" % ("tntfiles", path) 
```

但无济于事。我收到一条错误消息：“1064，“您的 SQL 语法有错误”

我尝试在路径周围使用 ` 执行相同的查询：

```
path = "`" + path + "`'" 
```

但我得到：“1064，“您的 SQL 语法有错误”

我不确定我在做什么，因为我可以执行类似的查询

```
"SELECT * FROM %s WHERE Id = %s" % ("tntfiles","1") 
```

它工作得很好。

谢谢

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-09-20T20:40:14.690

```
path = os.path.join(root,f)

sql = "SELECT * FROM tntfiles WHERE Filepath = %s"
cursor.execute(sql, (path,)) 
```

否则，您的路径值可能无法正确引用特殊字符（尽管这不太可能），或者可能未正确编码（更可能是 Unicode 和非 ASCII 数据）。

如果您绝对必须能够替换不同的表名：

```
sql = "SELECT * FROM %s WHERE Filepath = %%s" % ("tntfiles",)
cursor.execute(sql, (path,)) 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-09-17T21:04:52.357

MySQL 需要用 ' 或 " 包围字符串 - 所以只需将代码更改为

```
"SELECT * FROM %s WHERE Filepath = '%s'" % ("tntfiles", path) 
```

# php - php mysql 显示名称一次而不是输入的次数

> ID：12467035
> 
> 赞同：0
> 
> 时间：2012-09-17T20:59:17.437
> 
> 标签：php, mysql

我有这个查询，但它返回作者的名字它在数据库中存在的次数..

> $query = "SELECT bauthor FROM info WHERE Cat1 = 'novel'"; $result = MySQL_query($query);

我希望作者的名字显示一次，他的书的数量必须在括号中......例如作者的名字是 aaaaa，他已经写了 20 本书，所以当我运行这个查询时，它显示 mw 他的名字 20 次但是我希望它是这样的 aaaa(20)

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2012-09-17T21:01:12.107

如果没有您的完整架构，我将无能为力，但请尝试使用`COUNT`带有`GROUP BY`子句的功能，例如

```
SELECT bauthor, COUNT(books) AS numbooks FROM info WHERE ... GROUP BY bauthor 
```

编辑：请参阅此 SQLFiddle 示例：[http ://sqlfiddle.com/#!2/bb5f5/1/0](http://sqlfiddle.com/#!2/bb5f5/1/0)

# android - 如何在 Android 应用程序中实现具有占空比的加速度计

> ID：12467038
> 
> 赞同：-1
> 
> 时间：2012-09-17T20:59:30.220
> 
> 标签：android

我正在尝试对 Android 手机上的加速度计进行占空比，但我不确定实现它的正确方法是什么。更具体地说，我想分配一个占空比百分比 x%，这意味着加速度计将在 x% 的时间内被激活，并在 1-x% 的时间内休息。我正在考虑使用两个 TimerTask，但我也想知道其他选项。

谢谢！

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-09-17T21:02:23.930

您需要一个定时器，它可以在一个周期 T 内提供开启脉冲和关闭脉冲。占空比 = Ton / Ton + Toff 因此，如果您有一个定时器可以在该周期内产生这些脉冲，那么您就完成了。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-09-22T18:16:32.690

您可以使用 Handler.postDelayed() 进行计时（您可以调用 postDelayed，延迟在采样窗口长度和睡眠窗口长度之间交替）。对于此解决方案（以及使用 TimerTask 的解决方案！），您将需要保留唤醒锁定，因为一旦设备进入睡眠模式，计时器将不会唤醒您的设备。

因此，如果您想在后台感应，这将快速耗尽电池！在这种情况下，您必须使用 AlarmManager 定期唤醒您的设备，然后仅在采样窗口长度期间获取唤醒锁。

# c# - 使用插入查询将员工图像与其他信息一起上传到 SQL 数据库

> ID：12467043
> 
> 赞同：0
> 
> 时间：2012-09-17T20:59:56.353
> 
> 标签：c#, image, insert

我在使用 c# 将我的员工照片上传到数据库时遇到问题。我有一个员工输入屏幕表格。在该表格上有关于员工的各种信息，例如（姓名、地址、薪水、入职日期、出生日期、图像、手机号码等）。

我的插入查询在没有图像的情况下运行良好。这是我的代码示例。

```
 query = "insert into tbl_emp values('" + txtempid.Text + "','" + txtempname.Text + "','"+ cmbSex.Text +"','"
                + cmbDepartment.Text +"','" + cmbEmpDesig.Text + "','" + cmbemptyp.Text + "','" 
                + txtsalary.Text + "','"+ txtParmanentAdd.Text +"','"+ txtPresentAdd.Text +"','"
                + txtContactNo.Text +"','"+ txtEmailAdd.Text +"','"+ dateBirth.Text +"','" 
                + dateJoin.Text + "','"+ txtCardNo.Text +"')";
           con.executeCmd_Sql(query); 
```

请建议我如何插入图像以及这些其他信息。提前致谢 ：）

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-09-17T21:12:40.170

（假设您使用的是 ASP.NET 网络表单）.aspx：

```
 <asp:Image runat="server" ID="img" ImageUrl="~/Chrysanthemum.jpg" /> 
```

代码隐藏（.cs）：

```
 string pic = img.ImageUrl; 
```

将实际图片（如二进制数据）保存到数据库中并不是真正的最佳实践。这就是为什么您通常只会获取图片的路径（如`"~/mypicture.jpg"`）并将其作为字符串保存在数据库中。所以基本上，您所要做的就是在`pic`查询中传递字符串。

不相关：但您的查询对 SQL 注入非常开放。我建议您阅读此[链接](http://en.wikipedia.org/wiki/SQL_injection)

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-09-17T21:12:00.463

插入图像很容易。您只需要将图像转换为字节数组。看看这个代码片段示例：

```
private void updatedata()
{

    //use filestream object to read the image.

    //read to the full length of image to a byte array.

    //add this byte as an oracle parameter and insert it into database.

    try
    {

        //proceed only when the image has a valid path

        if (imagename != "")
        {

            FileStream fs;

            fs = new FileStream(@imagename, FileMode.Open, FileAccess.Read);

            //a byte array to read the image

            byte[] picbyte = new byte[fs.Length];

            fs.Read(picbyte, 0, System.Convert.ToInt32(fs.Length));

            fs.Close();

            //open the database using odp.net and insert the data

            string connstr = @"Data Source=.;Initial Catalog=TestImage;
            Persist Security Info=True;User ID=sa";

            SqlConnection conn = new SqlConnection(connstr);

            conn.Open();

            string query;

            query = "insert into test_table(id_image,pic) values(" + 
            textBox1.Text + "," + " @pic)";

            SqlParameter picparameter = new SqlParameter();

            picparameter.SqlDbType = SqlDbType.Image;

            picparameter.ParameterName = "pic";

            picparameter.Value = picbyte;

            SqlCommand cmd = new SqlCommand(query, conn);

            cmd.Parameters.Add(picparameter);

            cmd.ExecuteNonQuery();

            MessageBox.Show("Image Added");

            cmd.Dispose();

            conn.Close();

            conn.Dispose();

            Connection();

        }

    }

    catch (Exception ex)
    {

        MessageBox.Show(ex.Message);

    }

} 
```

如果您需要更多信息，请查看[该网站](http://www.redmondpie.com/inserting-in-and-retrieving-image-from-sql-server-database-using-c/)，该网站解释了您需要了解的所有信息。我从该站点粘贴到此处的此代码片段。

# php - 我正在使用 PHP 开发这款基于文本的游戏，但在第 22 行遇到错误

> ID：12467045
> 
> 赞同：-2
> 
> 时间：2012-09-17T21:00:01.043
> 
> 标签：php, debugging

我的错误是`unexpected T_STRING, expecting '(' on line 22`，但我没有看到任何`(`丢失。

谁能向我解释这里发生了什么？我在第 22 行之前错过了什么吗？

这是我的代码：

```
<?php

class Room { 
  protected $description = "";
  protected $name = "";
  protected $rooms = array(
   "ne" => NULL,
   "n" => NULL,
   "nw" => NULL,
   "e" => NULL,
   "c" => NULL,
   "w" => NULL,
   "se" => NULL,
   "s" => NULL,
   "sw" => NULL 
   );

  public function __construct ($n = "", $desc = "") { 
    $this->description = $desc;
    $this->name = $n;
  } 

  public function get Description () {
    return $this->description; 
  }

  public function get Name () {
    return $this->name; 
  }

  public function set Room ($direction = "c", $room) {
    $this->rooms[$direction] = $room; return True; 
  }

  public function getNewRoom ($direction = "") {
    return $this->rooms[$direction]; 
  } 
}

$start Room = new Room ("First Room", "A small room. There is a door to the north.");
$second Room = new Room ("Second Room", "A short hallway that ends in a dead end. There is a door to the south.");
$start Room->set Room("n", $second Room);
$second Room->set Room("s", $first Room);
$current Room = $start Room;

$play = True; 

while ($play) {
  print $current Room->get Name();
  print $current Room->get Description();

  $input = readline("(Enter your command. Type QUIT to quit.) >");

  if ($input == "QUIT") {
    $play = False; 
  } else { 
    if ($input == 'nw' || 
        $input == 'n' || 
        $input == 'né' || 
        $input == 'e' || 
        $input == 'e' || 
        $input == 'e' || 
        $input == 'e' || 
        $input == 'e' || 
        $input == 'e') 
    { 
      $current Room = $current Room->getNewRoom($input); 
    }
  } 

}

?> 
```

* * *

## 回答 #1

> 赞同：10
> 
> 时间：2012-09-17T21:02:33.973

您的许多方法的名称中都有空格。

```
public function get Description () {
public function get Name () {
public function set Room ($direction = "c", $room) { 
```

这些是不允许的。您必须使用一个单词的名称：

```
public function getDescription () { // For example 
```

然后，以同样的方式调用它：

```
print $currentRoom->getDescription(); 
```

同样的事情必须适用于变量。

```
$current Room = $start Room; // Not allowed
$currentRoom = $startRoom; // Good! 
```

# html - 将 a 的 bgcolor 保持在定义的高度/宽度约束内

> ID：12467046
> 
> 赞同：2
> 
> 时间：2012-09-17T21:00:12.227
> 
> 标签：html, css, html-table

我的任务是为我们的 HTML 时事通讯创建一个干净的模板，并分发给大约 70k 订阅者。正如预期的那样，他们希望它在尽可能多的电子邮件客户端中保持一致，因此我遵循广泛建议的 HTML 电子邮件实践并使用嵌套表和内联样式。

我正在尝试为`bgcolor`每个`<td>`显示图像设置一个 - 原因是如果有人关闭了他们的电子邮件客户端上的图像，他们仍然能够看到表格单元格的形状（以及他们的经验仍然会有点视觉），但我很难将 bgcolor 保持在单元格内，它似乎渗入了单元格之间的空间。这是一个例子：

```
 <tr>
     <td width="200" height="200" bgcolor="#CCCCCC">
       <img src="image.png" height="200" width="200" alt="Image!">
    </td>
  </tr> 
```

从这段代码中，当图像可见时，背景不是在图像下不可见，因为它们都是 200x200，我看到大约 10px 的灰色向下推入图像的底部和右侧并侵入周围的空白区域细胞。发生了什么事，我该如何解决？

编辑：这是它在做什么的图像：

[![](../Images/05993b0b6a59cbd87670840c8f144f64.png)](https://i.stack.imgur.com/4C3bZ.jpg)

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-09-17T21:01:45.727

您是否在表格标签上设置了`cellpadding`和属性？`cellspacing`

[http://www.w3schools.com/tags/att_table_cellspacing.asp](http://www.w3schools.com/tags/att_table_cellspacing.asp)

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-09-17T21:33:22.567

您是否将表格的css样式设置为border-collapse？像这样：

```
<table style="border-collapse: collapse;"> 
```

如果这没有效果，并且图像上没有边距，您是否尝试将填充设置为 0？

# jquery - JQuery 表验证

> ID：12467048
> 
> 赞同：0
> 
> 时间：2012-09-17T21:00:17.220
> 
> 标签：jquery, html, validation, dynamic-tables

我的页面上有一个动态表格设置，并且正在使用[这个](http://docs.jquery.com/Plugins/Validation)插件来验证我的整个表单。[这](http://jsfiddle.net/dCQqQ/2/)是我的表的代码。

我不知道为什么它不能在小提琴上工作，但它在网站上工作得很好。但是功能不是问题，我想知道如何使用验证插件来验证表输入。

 `* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-09-17T22:31:41.300

验证插件基于类。因此，要确保每个输入都有一个值，请将 class="required" 添加到输入中。从那里您可以将特定类型的验证（如 class="required email"）添加到电子邮件字段，以确保电子邮件字段具有值并且该值采用可接受的电子邮件格式。

根据插件的文档，您可能会遇到 像您 这样[复杂的字段名称的问题。](http://docs.jquery.com/Plugins/Validation#Fields_with_complex_names_.28brackets.2C_dots.29)

这应该让你开始[http://jsfiddle.net/dCQqQ/5/](http://jsfiddle.net/dCQqQ/5/)`

# php - 通过 PHP 修改 XML 并输出 xml（几乎就像过滤提要一样）

> ID：12467053
> 
> 赞同：2
> 
> 时间：2012-09-17T21:01:01.620
> 
> 标签：php, xml, xml-parsing

在 PHP 中，我必须过滤这个 rss 提要并输出新的 rss 提要。阅读提要，查看 dc:creator== badcreatorname 的位置并删除该项目并将提要以相同的顺序放置。

我怎么做？请帮忙。

```
<?xml version="1.0"?>
<rss version="2.0" xmlns:dc="http://purl.org/dc/elements/1.1/">
    <channel>
        <title>LInk.com title</title>
        <link>http://link.com</link>
        <description>Link.com</description>
        <image>
            <url>http://www.link.com/media/feedlogo.gif</url>
            <title>link.com</title>
            <link>http://link.com</link>
        </image>
        <language>en-us</language>
        <copyright>Copyright 2012 </copyright>
        <generator>Generator</generator>

        <item>
            <title><![CDATA[Title goes here]]></title>
            <link><![CDATA[http://link.com/]]></link>
            <guid isPermaLink="true"><![CDATA[http://link.com/]]></guid>
            <description><![CDATA[ Desc]]></description>
            <dc:creator><![CDATA[badcreatorname]]></dc:creator>
            <pubDate>Mon, 17 Sep 2012 15:16:00 EST</pubDate>
            <dc:identifier>898980</dc:identifier>
            <category domain="category"><![CDATA[cat]]></category>
            <category domain="blogger:name"><![CDATA[cat]]></category>
            <enclosure url="pic" length="" type="image/jpeg"/>
        </item>
        <item>
            <title><![CDATA[Title1 goes here]]></title>
            <link><![CDATA[http://link1.com/]]></link>
            <guid isPermaLink="true"><![CDATA[http://link1.com/]]></guid>
            <description><![CDATA[ Desc1]]></description>
            <dc:creator><![CDATA[goodcreatorname]]></dc:creator>
            <pubDate>Mon, 17 Sep 2012 15:16:00 EST</pubDate>
            <dc:identifier>8989801</dc:identifier>
            <category domain="category"><![CDATA[cat]]></category>
            <category domain="blogger:name"><![CDATA[cat]]></category>
            <enclosure url="pic" length="" type="image/jpeg"/>
        </item>
    </channel>
</rss> 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-09-17T21:23:46.127

```
<?php
// Load our XML document
$doc = new DOMDocument();
$doc->load('feed.xml');

// Create an XPath object and register our namespaces so we can
// find the nodes that we want    
$xpath = new DOMXPath($doc);
$xpath->registerNamespace('p', 'http://purl.org/dc/elements/1.1/');

// Find the <item> nodes that have a badcreatorname in there
$nodes = $xpath->query("/rss/channel/item[p:creator/text()[ . = 'badcreatorname' ]]");

// Remove the offending nodes from the DOM
for ($i = 0; $i < $nodes->length; $i++) {
    $node = $nodes->item($i);
    $node->parentNode->removeChild($node);
}

// Write our updated XML back to a new file
$doc->save('feedout.xml');

// Or if you want to send the XML content to stdout:
echo $doc->saveXML();
?> 
```

# c# - 如何获取光标坐标？

> ID：12467054
> 
> 赞同：0
> 
> 时间：2012-09-17T21:01:04.457
> 
> 标签：c#, asp.net

如何从`asp.net c#`所有页面`<div>`区域中获取光标坐标并发送到`<asp:TextBox ID="TextBox1" runat="server"></asp:TextBox>`

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-09-17T21:03:31.360

假设您想要鼠标光标位置，您可以使用 javascript 执行此操作。

查看

*   [JavaScript 光标位置](http://hartshorne.ca/2006/01/23/javascript_cursor_position/)
*   [Javascript中的鼠标光标位置？](https://stackoverflow.com/questions/3248785/mouse-cursor-position-in-javascript)

### 更新

如果你想使用 jQuery，你可以这样做。

```
jQuery(document).ready(function(){
   $(document).mousemove(function(e){
      $('#TextBox1').val(e.pageX +', '+ e.pageY);
   }); 
}) 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-09-17T21:07:19.837

您可以尝试使用此代码

```
<asp:TextBox id="tbx" runat="server" onchange="javascript:GetCursoCoordinate(this)"/>

function GetCursoCoordinate(textbox) 
{
    textbox = textbox || window.event;
    var result= {x:0, y:0};
    if (textbox.pageX || textbox.pageY) 
    {
        result.x = textbox.pageX;
        result.y = textbox.pageY;
    } 
    else 
    {
        var a = document.documentElement;
        var b = document.body;
        result.x = textbox.clientX + (a.scrollLeft || b.scrollLeft) - (a.clientLeft || 0);
        result.y = textbox.clientY + (a.scrollTop || b.scrollTop) - (a.clientTop || 0);
    }
    return result;
} 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-09-17T21:08:05.237

如果您使用 jQuery，获取光标位置很容易。只需[阅读此页面](http://docs.jquery.com/Tutorials%3aMouse_Position)，它就会解释一切。它还有一个活生生的例子向你展示一个例子。

# html - 如何对齐段落旁边的图像

> ID：12467062
> 
> 赞同：6
> 
> 时间：2012-09-17T21:01:38.270
> 
> 标签：html, css

像这样的东西...

[此处为图片] [此处为段落]

而不是我现在拥有的。

[图片在这里]

[此处的段落]

# HTML

```
 <p> <div class="polaroid">
     <img src="Me1.jpeg" title="Me" alt="Me" align="left" />
    <p class="polo">That's Me!!!</p>
       </div></p>
    </div>

    <div class="blocker03">
    <p class="description">
 blah blah blah blahblah blahblah blahblah blahblah blahblah blahblah blahblah blah
  blah blahblah blahblah blahblah blahblah blahblah blahblah blahblah blahblah blah
    blah   blahblah blahblah blahblah blahblah blah</p>
    </div> 
```

## CSS

```
.blocker03 {
 width:470px;
 padding-left:60px;
 margin:0 0 10px 25px;
 font-size:12px;
 display:inline-block;
  }

.polaroid {
postion: relative;
float: right;
border: 3px solid #C6930A;
border-style:dotted;
background: #66594C;
width: 140px;
padding: 5px;
margin: 5px;
text-align: center; 
-moz-box-shadow: 1px 1px 3px #222;
-moz-transform: rotate(-5deg);
-webkit-box-shadow: 1px 1px 3px #222;
-webkit-transform: rotate(-5deg);
box-shadow: 1px 1px 3px #222;
-o-transform: rotate(-5deg);
transform: rotate(-5deg);
    } 
```

* * *

## 回答 #1

> 赞同：10
> 
> 时间：2012-09-17T21:06:08.580

所以你有一些草率的代码，但是看看这个 jsfiddle 的例子，使用`float`：

[http://jsfiddle.net/tH2qc/](http://jsfiddle.net/tH2qc/)

根据您的代码，这里有一些松散的东西：

[http://jsfiddle.net/zZkpw/](http://jsfiddle.net/zZkpw/)

* * *

## 回答 #2

> 赞同：5
> 
> 时间：2015-02-03T13:05:59.753

当这可以正常工作时，这不是有点矫枉过正：

```
<p><img src="*[your image]" align="right" valign="middle" vspace="5" hspace="5"/>[your text]</p> 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-09-17T21:06:59.683

试试这个

```
<div style="float:left;width:800px" id="container">
    <div id="rightContainer" style="float:left;width:100px;">
        <img src="Me1.jpeg" title="Me" alt="Me" align="left" />
        <p class="polo">That's Me!!!</p>
    </div>
    <div id="leftContainer" style="float:right;width:600px;">
        <p class="description"> blah blah blah blahblah blahblah blahblah</p>
    </div>
</div> 
```

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2012-09-17T21:07:49.377

这将起作用：

```
.polaroid img, .polaroid p{
   float:left;
   display:inline;
} 
```

# android - 从广播接收器更新 UI

> ID：12467077
> 
> 赞同：0
> 
> 时间：2012-09-17T21:03:17.247
> 
> 标签：android

我正在使用bump android sdk。我有一个广播接收器，我想根据不同的意图过滤器更新我的 ui 中的一些元素。例如

```
else if (action.equals(BumpAPIIntents.NOT_MATCHED)) {
                Log.i("Bump Test", "Not matched.");
                BumpTest inst = BumpTest.instance();
                if(inst != null) {

                    inst.UpdateMyText("testing");
                } 
```

问题是即使在 logcat 我可以看到日志条目 textview 更新方法似乎没有被调用

难道我做错了什么？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-09-17T21:41:16.647

不允许您从其他线程（例如调用 BroadcastReceiver 的线程）更新 UI。您必须使用一个简单的[AsyncTask](http://developer.android.com/reference/android/os/AsyncTask.html)类。创建它的唯一目的是在执行需要很长时间才能完成的操作后更新 UI。将诸如从 Internet 请求资源之类的事情放在 AsyncTask 中是个好主意，因为它不会阻止 UI 线程执行。好的副作用是当它完成时它会在你的主程序中调用一个函数，并且这个调用是在 UI 线程上完成的。

# database - 在不打开应用程序外壳的情况下关闭 Access 数据库的 VBA 代码

> ID：12467080
> 
> 赞同：11
> 
> 时间：2012-09-17T21:03:39.317
> 
> 标签：database, ms-access, vba, ms-access-2003

我目前正在使用`Application.Quit`它打开 MS Access 应用程序的外壳。

在针对目标应用程序处理调用函数之后，我的应用程序的每个实例都保持打开状态；即使特定的数据库实例已关闭。

**如何使用 VBA 以编程方式关闭数据库“shell”应用程序窗口？**

这是如何创建变量以及如何关闭它的示例：

```
Dim appAccess As New Access.Application

' Do stuff here...

appAccess.CloseCurrentDatabase 
```

* * *

## 回答 #1

> 赞同：9
> 
> 时间：2012-09-17T22:22:36.157

根据文档：[Application.Quit与](http://msdn.microsoft.com/en-us/library/office/ff844963.aspx)[DoCmd.Quit](http://msdn.microsoft.com/en-us/library/office/ff191887.aspx)做同样的事情。即

> Quit 方法退出 Microsoft Access。在退出之前，您可以选择多个选项之一来保存数据库对象。

您可以尝试使用`acQuitSaveNone`“退出 Microsoft Access 而不保存任何对象”的参数或 2 调用它们中的任何一个。经过进一步审查，添加了`Application.Quit`as`DoCmd.Quit`以[实现 Access 95 的向后兼容性](http://msdn.microsoft.com/en-us/library/aa221549%28office.11%29.aspx)（请参阅退出方法的备注，因为它适用于 DoCmd 对象。）如果您有权限，执行其中任何一个操作仍应在关闭时自动压缩，这可能是你炮弹的原因。

如果这对你不起作用，这里有一个有点极端的建议。将其保存为 vbscript 文件，并在真正完成 Access 后调用它。这将终止 Windows pc 上的所有 MSAccess 进程，无需压缩和修复。

```
strComputer = "."
Set objWMIService = GetObject("winmgmts:" _
    & "{impersonationLevel=impersonate}!\\" & strComputer & "\root\cimv2")
Set colProcessList = objWMIService.ExecQuery _
    ("SELECT * FROM Win32_Process WHERE Name = 'msaccess.exe'")
For Each objProcess in colProcessList
    objProcess.Terminate()
Next 
```

调用用实际路径替换 [vbspath] 的脚本。如果路径有空格，请确保使用双引号并将其放在引号中：

```
shell "cscript [vbspath]" 
```

* * *

## 回答 #2

> 赞同：6
> 
> 时间：2012-09-17T21:51:35.970

我总是用`DoCmd.Quit acQuitSaveAll`.
这至少在 Access 2000、2003 和 2010 中有效（这就是我*看到*它有效的地方）。

* * *

## 回答 #3

> 赞同：6
> 
> 时间：2014-01-10T16:53:32.923

您需要针对实例变量执行 Application.Quit。

例如，

```
Dim appAccess As New Access.Application

' Do stuff here...

appAccess.Application.Quit 
```

* * *

## 回答 #4

> 赞同：5
> 
> 时间：2012-09-17T21:07:18.487

`Access.Quit`为我工作。也许试试那个而不是`Application.Quit`？

如果这不能解决问题，您的问题可能在其他地方，在这种情况下，请告诉我们更多关于这个项目的信息。

* * *

## 回答 #5

> 赞同：3
> 
> 时间：2014-09-25T21:23:59.920

DoCmd.Quit acQuitSaveAll，终于工作了。我之前尝试了所有其他选项，但外壳仍然挂起。

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2015-06-03T11:55:31.960

将窗体切换到设计视图。将表单的`BorderStyle`属性设置为`None`。在**视图**菜单上，单击**表单视图**。请注意，表单的标题栏已完全删除。

# google-analytics - 谷歌分析集成突然显示没有报告数据但实时显示流量

> ID：12467083
> 
> 赞同：1
> 
> 时间：2012-09-17T21:03:42.353
> 
> 标签：google-analytics, google-analytics-api

我们使用谷歌分析已经有一段时间了。它对于实时流量和历史报告都非常有用。

突然在 9 月 5 日，我们的报告显示流量为零（使用标准报告概览选项卡）。

![在此处输入图像描述](../Images/6cc47eb26d3f4319566da39fc9db3456.png)

这看起来很奇怪，因为您可以看到实时选项卡中的流量几乎是恒定的。

其他人在集成 Google 分析时遇到过这个问题吗？我们有一个过滤器，只有来自我们主域 (app.domain.com) 的流量才会显示。即使在删除它之后，我们在报告中也一无所获。

![在此处输入图像描述](../Images/f55f21195bbb7bb7933e369948c5abbe.png)

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-09-17T22:28:44.777

检查该配置文件上的过滤器。进入右上角的管理并检查配置文件上的过滤器选项卡。

过滤器不适用于实时数据。

因此，您在这里看到的是从配置文件中过滤掉的数据，但仍会实时显示。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2014-07-25T08:52:24.607

这可能是一些不同的事情

1.  谷歌的一个临时故障 - 这发生在我身上（这就是我进入这个页面的方式）。我可以在实时视图中看到流量，但在报告中什么也看不到。**解决方法：**耐心等待 - 大约 12 小时后问题自行解决。
2.  配置文件问题 - 您可能设置了一个配置文件，其中的过滤器阻止了比您预期更多的流量。**解决方法：**尝试设置一个未应用过滤器的单独配置文件（如果您还没有）。请记住，配置文件过滤器通过在流量到达您的报告之前剥离或操纵流量来工作。上面的答案是不正确**的——实时视图确实考虑了过滤器**。你可以很容易地测试这个，改变过滤器，你会看到它在实时视图中生效
3.  标签已从您的页面中删除**修复：**如果您使用的是 GTM，您应该能够检查这一点。或者，如果不检查您知道正在获得流量的页面上的 HTML 页面源
4.  最后 - 你可能没有得到任何流量 :)

# jquery - jQuery添加类不起作用

> ID：12467087
> 
> 赞同：0
> 
> 时间：2012-09-17T21:03:59.157
> 
> 标签：jquery, syntax

嘿，我这里有这段代码，它假设添加类名“cboxElement”

```
$(".wpcart_gallery a:first").addClass("cboxElement"); 
```

但它不起作用。

我的标题中有正确的 Jquery 文件，我已经将它包围起来`jQuery('document').ready(function($){......});`，它适用于我的所有其他 Jquery，但添加类调用除外。

这是我试图将课程添加到...

```
<div class="wpcart_gallery" style="text-align:center; padding-top:5px;">
<a class="thickbox" href="DSC_0037.jpg" rev="DSC_0037.jpg"></a>
</div> 
```

有人知道为什么这不起作用吗？我是 jquery 的新手

这也在wordpress中，因此`jQuery('document')`

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-09-17T21:27:15.997

代码：

```
$(document).ready(function() {
    $(".wpcart_gallery a:first").addClass("cboxElement");
} 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-09-17T21:22:04.487

正如 Zoltran 在 jsFiddle 上指出和演示的[那样](http://jsfiddle.net/3Fbnv/1)，您列出的代码至少在某些情况下有效。当 .ready() 执行时，您添加类的 div 元素是否可能还不存在？我建议添加这一行：

```
console.log("container:", $(".wpcart_gallery"), "link:", $(".wpcart_gallery a:first")); 
```

在您的 .addClass() 代码之后，然后查看调试控制台（例如[Chrome 的网络检查器](https://developers.google.com/chrome-developer-tools/)）。你看到你的元素还是未定义的？如果您看到 undefined ，则很有可能您的 .addClass() 代码在其作用的元素准备好之前正在运行。如果您确实获得了元素，则您的样式（或代码的其他部分）可能会覆盖/撤消您的更改。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-09-17T21:22:08.073

我假设您的选择器返回多个或 null。您的 html 中可能还有其他元素具有相同的选择器。正如 Zoltan 所指出的，它应该可以工作。尝试打印到 consol.log($(".wpcart_gallery a:first")); 在 firefox 或 chrome 中并使用 firebug 对其进行调试，这可能会给您一些指示问题出在哪里。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2012-09-20T05:22:16.233

试试这个小伙伴......

```
jQuery('document').ready(function($){

  jQuery(".wpcart_gallery a:first").addClass('cboxElement');

}); 
```

# html - 如何使用 `content_for?` 方法实现动态布局列？

> ID：12467088
> 
> 赞同：0
> 
> 时间：2012-09-17T21:03:59.633
> 
> 标签：html, css, ruby-on-rails, ruby-on-rails-3

我正在使用 Ruby on Rails 3。我想使用该`content_for?`方法呈现布局，以便“有条件地”生成具有适当 CSS 属性的 HTML 代码。也就是说，我想实现具有以下功能的布局：

*   如果`content_for`存在左列，则布局有 2 列（具有固定宽度的*左列*和具有剩余宽度的*内容列）；*
*   如果`content_for`左列*不*存在，则布局有 1 列（全宽的*内容列）。*

如何在`/app/views/layouts/application.html.erb`文件中实现它？你有什么建议吗？

*注意*：希望我正在寻找布局的示例实现（还包括 Ruby on Rails 方法、HTML 和 CSS 代码）。

* * *

**奖励**：*在**内容列*块内，如果存在右列，我想“有条件地”显示*右列*`content_for`。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-09-17T21:07:59.943

您可能想要检查，如果给定参数产生了内容`content_for?`，它会返回。`true`看[`content_for?`](http://api.rubyonrails.org/classes/ActionView/Helpers/CaptureHelper.html#method-i-content_for-3F)

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-09-17T21:55:24.617

您可以使用相邻 ( `+`) 或后续 ( `~`) 同级选择器根据左列是否可见有条件地对内容列应用边距。

对于您的奖励问题，您应该将 content 列的内容放在一个内部包装 div 中，然后使用`:nth-last-child`检查右列是否可见并有条件地在那里应用边距：

**CSS**：

```
.page {
  position: relative;
}

.page .left-column {
  background: lavender;
  left: 0;
  position: absolute;
  top: 0;
  width: 180px;
}

.page .content-column { background: orange; }

.page .content-column > .inner-wrap { background: rgba(255,255,255,0.3); }

.page .left-column + .content-column {
  margin-left: 200px;
}

.page .content-column .right-column {
  background: lime; 
  position: absolute;
  right: 0;
  top: 0;
  width: 90px;
}

.page .content-column > .inner-wrap:nth-last-child(2) {
  margin-right: 100px;
} 
```

**HTML**：

```
<div class="page">

  <% if content_for?(:left_column) %>
    <div class="left-column">
      <%= yield(:left_column) %>
    </div>
  <% end %>

  <div class="content-column">
    <div class="inner-wrap">
      <%= yield(:content_column) %>
    </div>

    <% if content_for?(:right_column) %>
      <div class="right-column">
        <%= yield(:right_column) %>
      </div> 
    <% end %>          
  </div>

</div> 
```

渲染布局预览：http: [//jsbin.com/icurey/8/edit](http://jsbin.com/icurey/8/edit)

# algorithm - 匈牙利戒指拼图

> ID：12467089
> 
> 赞同：1
> 
> 时间：2012-09-17T21:04:04.823
> 
> 标签：algorithm, vb6, heuristics

我很难为匈牙利指环谜题找到一个可接受的启发式方法。我计划使用 IDA* 算法来解决并正在用 Visual Basic 编写程序。我所缺乏的是如何实现难题的实际解决。我已经将左右环实现到它们自己的数组中，并且具有顺时针和逆时针旋转每个环的功能。我不是要代码，只是在某个地方开始。

这是2个环形数组：

```
Dim leftRing(19) As Integer 
' leftRing(16) is bottom intersection and leftRing(19) is top intersection
Dim rightRing(19) As Integer
' rightRing(4) is top intersection and rightRing(19) is bottom intersection 
```

在数组中，我将以下值存储为每种颜色的值：红色值 = 1 黄色 = 2 蓝色 = 3 和黑色 = 4

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-09-17T21:21:54.750

我建议分别计算每个环中的“错误” - 需要更换多少球才能解决环（1 个 9 色，1 个 10 色，一个 9 色中的一个单独的球）。一次旋转最多可以固定两个球，然后需要另一个旋转来固定另外两个。分别计算每个环的距离 = 2n-1，其中 n 是坏位置数量的一半，并取其中较大的一个。在寻找错误最少的位置时，您可以遍历所有 20 个位置，但我想有一种更好的方法来计算这个指标（除了简单的修剪）。

更新：与 Gareth Reed 的讨论指向以下启发式：

对于每个环，分别计算：

1.  颜色变化的次数。目标量为每圈三色变化，一次最多可消除四色变化。此指标归功于 Gareth。
2.  不同颜色的计数，忽略了它们的位置。应该有：10个10色球、9个9色球和1个9色球。一次最多可以更改 2 种颜色。

第二个启发式可以分为三个部分：

1.  应该有 10 个 10 球和 10 个 9 球。超过十个的球需要更换。
2.  应该只有一种颜色的 10 球。次要颜色的球需要更换。
3.  应该只有一个 9 色球。其他颜色的球需要更换。如果都是同色，且9色不缺，则需多换一球。

取两者中较大的一个。请注意，您将需要交替使用环，因此实际上需要 2n-1 次移动来进行 n 次替换。如果两个估计值相等，或者较大的一个是最新移动的环，则添加一个额外的。第一步不会改善其中一个戒指。

修剪所有旋转相同环两次的移动（假设移动度量允许大旋转）。这些已经被探索过了。

这应该避免所有大的局部最小值。

# ios - UIAutomation 无法加载插件

> ID：12467090
> 
> 赞同：3
> 
> 时间：2012-09-17T21:04:33.050
> 
> 标签：ios, instruments, ui-automation, xcode-instruments, xcrun

我设置了一个项目，以便在构建过程完成时目标之一启动 UIAutomation。Instruments 从 Python 脚本启动，最终在 bash 上调用通常的“xcrun Instruments ...”命令。

它工作了很长时间没有问题。将 Xcode 升级到 4.4 后，我开始看到“无法加载 XXX 定位器插件”。错误信息。任何想法从哪里开始追踪问题？

任何线索都会有所帮助！提前致谢。

![仪器输出](../Images/e8c06c9f24e1873a299b2801d9c3129c.png)

# python - 在 Windows 7 64 位 PC 上安装 PIL

> ID：12467091
> 
> 赞同：4
> 
> 时间：2012-09-17T21:04:33.253
> 
> 标签：python, windows-7, installation, python-imaging-library

Python 本身可以正常工作，但是当我尝试向其中添加 PIL 时，安装会显示错误消息：

> 需要python 2.7版本，在注册表中找不到

我能做些什么？

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2013-02-14T13:24:46.860

这个问题之前已经看到了，确实python和windows注册表已经成为这个库的问题，你在下面的地址上创建一个新的自己的注册表`HKEY_LOCAL_MACHINE\SOFTWARE\Wow6432Node\Python\PythonCore\2.7\InstallPath`，然后复制并粘贴那里的值`HKEY_LOCAL_MACHINE\SOFTWARE\Python\PythonCore\2.7\InstallPath`

看这里了解更多详情

[在 64 位 Windows 上安装 SetupTools](https://stackoverflow.com/questions/3652625/installing-setuptools-on-64-bit-windows)

# python - 检测鼠标光标是否被任何其他应用程序隐藏或可见

> ID：12467092
> 
> 赞同：3
> 
> 时间：2012-09-17T21:04:33.190
> 
> 标签：python, c, windows, mouse

我想检测鼠标当前是否隐藏，这通常由 Windows 上的 3D 应用程序完成。这似乎比听起来更棘手，因为我找不到任何方法来做到这一点。

最好我想使用 Python 来做到这一点，但如果那不可能，我可以求助于 C。谢谢！

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-09-17T21:15:39.343

该[`GetCursorInfo`](http://msdn.microsoft.com/en-us/library/windows/desktop/ms648389%28v=vs.85%29.aspx)函数返回一个[`CURSORINFO`](http://msdn.microsoft.com/en-us/library/windows/desktop/ms648381%28v=vs.85%29.aspx)结构，该结构具有一个`flags`包含全局游标状态的字段。这会做你需要的吗？我对Python不熟悉，所以我不知道你是否可以从Python调用这个函数。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-09-17T21:23:02.207

您需要调用该[`GetCursorInfo`](http://msdn.microsoft.com/en-us/library/windows/desktop/ms648389%28v=vs.85%29.aspx)函数。这可以使用[pywin32 库](http://sourceforge.net/projects/pywin32/)直接完成。或者，如果您不想安装外部 Python 库，则可以使用该[`ctypes`模块](http://docs.python.org/library/ctypes.html)直接从 User32.dll 访问该函数。

例子：

```
import ctypes

# Argument structures
class POINT(ctypes.Structure):
    _fields_ = [('x', ctypes.c_int),
                ('y', ctypes.c_int)]

class CURSORINFO(ctypes.Structure):
    _fields_ = [('cbSize', ctypes.c_uint),
                ('flags', ctypes.c_uint),
                ('hCursor', ctypes.c_void_p),
                ('ptScreenPos', POINT)]

# Load function from user32.dll and set argument types
GetCursorInfo = ctypes.windll.user32.GetCursorInfo
GetCursorInfo.argtypes = [ctypes.POINTER(CURSORINFO)]

# Initialize the output structure
info = CURSORINFO()
info.cbSize = ctypes.sizeof(info)

# Call it
if GetCursorInfo(ctypes.byref(info)):
    if info.flags & 0x00000001:
        pass  # The cursor is showing
else:
    pass  # Error occurred (invalid structure size?) 
```

# java - “this”如何从已发布的内部类中逃脱

> ID：12467101
> 
> 赞同：4
> 
> 时间：2012-09-17T21:05:51.010
> 
> 标签：java, escaping, this

我正在阅读 Java Concurrency in Practice 一书。在第 3.2 节中，它讨论了在发布内部类时转义外部类。现在我正在寻找使它成为可能的语法。假设我们有：

```
public class ThisEscape {

    public Integer i = 47;

    public ThisEscape(EventSource source) {
        source.registerListener(
            new EventListener() {
                public void onEvent(Event e) {
                    doSomething(e);
                }
        });
    }
} 
```

如果我对转义外部类的理解是正确的，我假设可以`EventSource`以某种方式访问`EventListener`​​封闭类（在这种情况下`ThisEscape`）。假设我们实现`EventSource`如下：

```
public class EventSource {

    public void registerListener(EventListener listener) {
        // How does it have access to enclosing class of the listener variable i?
    }

} 
```

我们如何才能访问公共`i`变量`registerListener`？

* * *

刚刚发现一个错字。将“`EventSource`封闭类”替换为“`EventListener`封闭类”。幸运的是，每个人都得到了正确的版本。

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-09-17T21:14:50.000

通过注册`ThisEscape`发布`EventListener`。
但*同时*它隐式地发布了封闭`ThisEscape`实例，因为内部类实例包含*对封闭类的隐藏引用*。
书中有解释。继续阅读。
这个例子说明了如何*在*施工过程`this`中逃生。 我能在句法上描述的最接近的是：

 *```
public class ThisEscape {

    public Integer i = 47;

    public ThisEscape(EventSource source) {
            source.registerListener(
                    new EventListener() {
                            ThisEscape outerRef = ThisEscape.this;//added by compiler
                            public void onEvent(Event e) {
                                    doSomething(e);
                            }
                    });
            }
    } 
```

也许这里的朋友可以给出更准确/准确的技术语法。
但是编译器添加了一些额外的代码，以便内部类可以访问外部类的成员，如您所见。
这里的问题是发布的对象正在构建中，即没有完全构建，这绝对不是您想要的。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-09-17T21:49:54.423

在 Java 中，当您定义内部类时，它会自动将父级添加到内部类的所有构造函数中，包括默认的无参数构造函数，并将其分配给隐藏字段。这是您可以在内部类中引用父类的字段的方式。您可以在类的字节码表示中看到这一点：

```
public class test/ThisEscape {

  // compiled from: ThisEscape.java
  // access flags 0x0
  INNERCLASS test/ThisEscape$1 null null

  // access flags 0x1
  public Ljava/lang/Integer; i

  // access flags 0x1
  public <init>(Ltest/EventSource;)V
      L0
    LINENUMBER 8 L0
    ALOAD 0
    INVOKESPECIAL java/lang/Object.<init> ()V
   L1
    LINENUMBER 6 L1
    ALOAD 0
    BIPUSH 47
    INVOKESTATIC java/lang/Integer.valueOf (I)Ljava/lang/Integer;
    PUTFIELD test/ThisEscape.i : Ljava/lang/Integer;
   L2
    LINENUMBER 9 L2
    ALOAD 1
    NEW com/kcp/ko/pm/ThisEscape$1
    DUP
    ALOAD 0
    INVOKESPECIAL test/ThisEscape$1.<init> (Lcom/kcp/ko/pm/ThisEscape;)V
    INVOKEVIRTUAL test/EventSource.registerListener (Lcom/kcp/ko/pm/EventListener;)V
   L3
    LINENUMBER 17 L3
    RETURN
   L4
    LOCALVARIABLE this Ltest/ThisEscape; L0 L4 0
    LOCALVARIABLE source Ltest/EventSource; L0 L4 1
    MAXSTACK = 4
    MAXLOCALS = 2
} 
```

注意公共`test/ThisEscape$1.<init> (Ltest/ThisEscape;)V`构造函数

当在另一个类的构造函数中定义内部类时，这会导致一个问题（在书中突出显示）。本质上，您将“泄漏”对部分初始化类的引用。

你的逃跑情况有点不对劲。该`this`参数通过 EventListener 匿名内部类的定义进行转义。要访问`i`EventListener 类的导出版本中的变量，您需要执行以下操作：

```
public class ThisEscape {

    public Integer i = 47;

    public ThisEscape(EventSource source) {
        source.registerListener(new ExportedEventListener(this));
    }
}

public class ExportedEventListener implements EventListener{

    private ThisEscape thisEscape;

    public ExportedEventListener(ThisEscape thisEscape){
        this.thisEscape = thisEscape;
    }

    public void onEvent(Event e) {
        System.out.println("i: " + thisEscape.i);
    }
} 
```

但这仍然不是线程安全的。

[相关问题](https://stackoverflow.com/questions/5129592/reference-of-enclosing-object-escape-through-anonymous-class-java)

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-09-17T21:15:24.087

想象一下`EventSource`是这样写的：

```
public class EventSource {
    public void registerListener(EventListener listener) {
        listener.onEvent(null);
    }
} 
```

出于内存模型的目的，它不能直接访问`ThisEscape`对象并不重要。（它可能 - 反射，`EventListener`在同一个包中的某些方法，由同一个包中的某些方法启用，等等。）重要的`ThisEscape`是正在以某种方式访问​​的字段，这可能是线程不安全的。*

# javascript - 如何在 mongoose.js 中获取最新和最旧的记录（或者只是它们之间的时间跨度）

> ID：12467102
> 
> 赞同：67
> 
> 时间：2012-09-17T21:05:56.043
> 
> 标签：javascript, node.js, mongoose, timespan

## 基本问题

我有一堆记录，我需要获取最新的（最近的）和最旧的（最近的）。

谷歌搜索时，我发现[了这个主题](https://groups.google.com/forum/?fromgroups=#!searchin/mongoose-orm/oldest/mongoose-orm/z93TqQ2lHJ0/PdBpnZ-HPVEJ)，在那里我看到了几个查询：

```
// option 1
Tweet.findOne({}, [], { $orderby : { 'created_at' : -1 } }, function(err, post) {
  console.log( post );
});
// option 2
Tweet.find({}, [], {sort:[['arrival',-1]]}, function(err, post) {
  console.log( post );
}); 
```

不幸的是，他们都错误：

```
TypeError: Invalid select() argument. Must be a string or object. 
```

该链接也有这个：

```
Tweet.find().sort('_id','descending').limit(15).find(function(err, post) {
  console.log( post );
}); 
```

还有一个错误：

```
TypeError: Invalid sort() argument. Must be a string or object. 
```

那么我怎样才能得到这些记录呢？

## 时间跨度

更理想的是，我只想要最旧和最新记录之间的时间差（秒？），但我不知道如何开始进行这样的查询。

这是架构：

```
var Tweet = new Schema({
    body: String
  , fid: { type: String, index: { unique: true } }
  , username: { type: String, index: true }
  , userid: Number
  , created_at: Date
  , source: String
}); 
```

我很确定我有最新版本的 mongoDB 和 mongoose。

## 编辑

这就是我根据 JohnnyHK 提供的答案计算时间跨度的方法：

```
var calcDays = function( cb ) {
  var getOldest = function( cb ) {
    Tweet.findOne({}, {}, { sort: { 'created_at' : 1 } }, function(err, post) {
      cb( null, post.created_at.getTime() );
    });
  }
    , getNewest = function( cb ) {
    Tweet.findOne({}, {}, { sort: { 'created_at' : -1 } }, function(err, post) {
      cb( null, post.created_at.getTime() );
    });
  }

  async.parallel({ 
    oldest: getOldest
  , newest: getNewest
  }
    , function( err, results ) {
      var days = ( results.newest - results.oldest ) / 1000 / 60 / 60 / 24;
      // days = Math.round( days );
      cb( null, days );
    }
  );
} 
```

* * *

## 回答 #1

> 赞同：129
> 
> 时间：2012-09-17T21:16:48.703

Mongoose 3.x 抱怨`[]`您[`findOne`](https://mongoosejs.com/docs/api/model.html#model_Model.findOne)调用中的参数，因为选择要包含的字段的参数不再支持数组格式。

试试这个来找到最新的：

```
Tweet.findOne({}, {}, { sort: { 'created_at' : -1 } }, function(err, post) {
  console.log( post );
}); 
```

将 更改`-1`为 a`1`以查找最旧的。

但是因为您没有使用任何字段选择，所以将几个调用链接在一起会更干净一些：

```
Tweet.findOne().sort({created_at: -1}).exec(function(err, post) { ... }); 
```

甚至将字符串传递给[`sort`](http://mongoosejs.com/docs/api.html#query_Query-sort)：

```
Tweet.findOne().sort('-created_at').exec(function(err, post) { ... }); 
```

* * *

## 回答 #2

> 赞同：49
> 
> 时间：2019-02-18T06:15:55.890

### 快速简单 - 一条线解决方案

得到**`10 latest documents`**

```
MySchema.find().sort({ _id: -1 }).limit(10) 
```

得到**`10 oldest documents`**

```
MySchema.find().sort({ _id: 1 }).limit(10) 
```

如果您想根据其他属性进行排序，即`createdAt`获取最旧或最新的。它类似于上面的查询。

```
MySchema.find().sort({ createdAt: -1 }).limit(10)  // 10 latest docs
MySchema.find().sort({ createdAt: 1 }).limit(10) // 10 oldest docs 
```

* * *

## 回答 #3

> 赞同：14
> 
> 时间：2017-10-21T07:36:59.917

对于版本 ~3.8 mongoose

找到最后一个条目

```
model.findOne().sort({ field: 'asc', _id: -1 }).limit(1) 
```

或使用

```
model.findOne().sort({ field: -_id }).limit(1) 
```

* * *

## 回答 #4

> 赞同：5
> 
> 时间：2018-12-17T17:01:41.657

```
collectionName.findOne().sort({$natural: -1}).limit(1).exec(function(err, res){
    if(err){
        console.log(err);
    }
    else{
        console.log(res);
    }
} 
```

这将为您提供数据库中记录的最后一个文档。只需遵循相同的概念。

* * *

## 回答 #5

> 赞同：3
> 
> 时间：2021-04-04T13:53:48.243

```
await Model.find().sort({$natural:-1}).limit(1); //for the latest record
await Model.find().sort({$natural:1}).limit(1); //for the oldest record 
```

这个对我有用。使用 mongodb 自然顺序[https://docs.mongodb.com/manual/reference/operator/meta/natural/](https://docs.mongodb.com/manual/reference/operator/meta/natural/)

* * *

## 回答 #6

> 赞同：1
> 
> 时间：2018-10-12T03:24:43.707

我们有一个称为 sort 的方法，使用它我们**可以获得第一个元素（旧文档），这意味着 1 用于排序字段**或**最后一个元素（新文档），这意味着 -1 用于**集合的排序字段。

* * *

## 回答 #7

> 赞同：0
> 
> 时间：2021-12-15T11:24:10.243

这是异步的答案 - 等待

```
const olderDoc: any = await Model.findOne().sort({ createdAt: 1 }).lean().exec()
console.log('olderDoc', olderDoc)

const newerDoc: any = await Model.findOne().sort({ createdAt: -1 }).lean().exec()
console.log('newerDoc', newerDoc) 
```

* * *

## 回答 #8

> 赞同：0
> 
> 时间：2022-02-02T19:37:08.400

最好的方法是有一个这样的异步函数：

```
async function findLastElement () {
    return await Mymodel.findOne().sort('-_id');
} 
```

这样你就得到了最后一个元素并确保了可重用性。

# c++ - 这有联锁吗？C++

> ID：12467105
> 
> 赞同：0
> 
> 时间：2012-09-17T21:06:02.470
> 
> 标签：c++, multithreading, concurrency, thread-safety, interlocked

请注意 - 这些构建适用于 VS2008/VS2010 构建，我不能使用任何 11 个构造。

想象一下，我有订阅者在听某个发布者。我的发布者有一个订阅者指针容器。在我的 void detach(ISubscriber *) 中，我不会锁定订阅者列表，而是将指针“NULL”出来，因为没有更好的词，对于那个订阅者。

```
//My container in the publisher.  Inserts to not invalidate, removals only invalidate iterators pointing to the removed element, for this reason we NULL
Container<ISubscriber *> myContainer;

Now in the publisher...
void NotifySubscribers(){
   foreach(subscriber in container){
      if(subscriber)//This is my problem
         subscriber->notify()
   }
} 
```

第 3 行 - 测试指针并指向有效对象。在执行第 4 行之前，另一个线程将订阅者设为 NULL。第 4 行 - 繁荣。

我的问题，有没有一种方法可以使用某种互锁的东西，使测试和调用是原子的。

例如，对于析构函数中的引用计数对象，类似这样的工作

```
 RefCountObject::~RefCountObject(){
    if(InterlockedDecrement(&m_count) == 0)
      delete m_data;
 } 
```

在这里，参考计数器自动递减并针对零进行测试，然后只有当等于零时，才会释放数据。

有没有办法让我根据指针的有效性来调用函数？

编辑1：我需要根据评论澄清一点，并感谢您的回复。发布者不负责订阅者的“内存释放”，因此不会有泄漏。在通知之后，发布者将通过一个循环，通过删除无效的订阅者来清理容器。

现在至于订阅者自己。当他们分离时，他们只是从听发布者分离。它们本身将存在于静态对象中（这是我们需要的合同）。为什么？因为我们不能在通知期间持有锁。唯一的其他选择是使用 Share_Ptr，由于未来的版本控制，决定不将其合并到此 DLL 中。

我创建了一个手写的 shared_ptr，但后来我突然想到，任何对未包含在资源管理类中的对象的引用都会落入同样的陷阱，只是推动订阅者必须确保不这样做的“要求”引用在其实现所述订阅者中的任何悬空引用。

这让我们回到刚才的说法，订阅者不能被“释放”，目前所有将使用它的客户端都是静态对象。我们只是在展望未来。一些用户是遗留应用程序，不容易引入 enabled_shared_from_this 等。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-09-17T21:14:30.623

> 有没有办法我可以使用某种互锁的东西，使测试和调用是原子的。

对于测试，是的，会有办法。你只想比较一个指针。

打电话，我怀疑。您将需要一个守卫在呼叫周围，即关键部分。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-09-17T23:40:41.870

您可以使用“智能指针”策略对指针进行延迟归零。只要有人引用了指针，由互锁引用计数确定，就保持指针有效；当计数变为零时，它是安全的。

# php - mysql_connect 到 PDO 连接

> ID：12467108
> 
> 赞同：0
> 
> 时间：2012-09-17T21:06:10.817
> 
> 标签：php, pdo, mysql-connect

我一直在尝试将 mysql_connect 连接转换为 PDO 连接但没有成功，这就是我所拥有的：

```
$host = 'localhost';
        $user = 'root';
        $pwd = '';
        $db = 'jdlferreira';
        $connection = mysql_connect($host, $user, $pwd) or die("Could not connect");
        mysql_select_db($db) or die("Could not select database");

        $query = "SELECT COUNT(*) FROM blog";
        $result = mysql_query($query) or die(mysql_error());
        $num_rows = mysql_fetch_row($result);

        $pages = new Paginator;
        $pages->items_total = $num_rows[0];
        $pages->mid_range = 9; // Number of pages to display. Must be odd and > 3
        $pages->paginate();

        $query = "SELECT id, title, resume, date
            FROM blog
            ORDER BY date DESC $pages->limit";
        $result = mysql_query($query) or die(mysql_error());

        while ($row = mysql_fetch_row($result)) {
//do stuff
} 
```

我试图用 PDO 做什么：

```
include_once 'inc/db.inc.php';
        $db = new PDO(DB_INFO, DB_USER, DB_PASS);
        mysql_select_db("jdlferreira") or die("Could not select database");

        $query = "SELECT COUNT(*) FROM blog";
        $result = mysql_query($query) or die(mysql_error());
        $num_rows = mysql_fetch_row($result);

        $pages = new Paginator;
        $pages->items_total = $num_rows[0];
        $pages->mid_range = 9; // Number of pages to display. Must be odd and > 3
        $pages->paginate();

        $query = "SELECT id, title, resume, date
            FROM blog
            ORDER BY date DESC $pages->limit";
        $result = mysql_query($query) or die(mysql_error());

        while ($row = mysql_fetch_row($result)) {
//do stuff
} 
```

我收到“无法选择数据库”错误，我真的不关心“或死”的情况，我只想让这个连接在 PDO 上正常工作，任何帮助都会很棒。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-09-17T21:08:46.837

您不能使用 PDO，然后期望使用`mysql_*`它们不相关的功能。

不需要像 pdo 那样选择一个数据库，因为它包含在 DSN 中，它是构造函数的第一个参数：

```
$db = new PDO('mysql:host=localhost;dbname=jdlferreira', DB_USER, DB_PASS); 
```

然后你需要使用 PDO 接口与 DB 交互，而不是 mysql 的：

```
 $stmt = $db->prepare("SELECT COUNT(*) FROM blog");
    $stmt->execute();
    $num_rows = $stmt->fetchColumn();
    $stmt->closeCursor();

    $pages = new Paginator;
    $pages->items_total = $num_rows;
    $pages->mid_range = 9; // Number of pages to display. Must be odd and > 3
    $pages->paginate();

    $query = "SELECT id, title, resume, date
        FROM blog
        ORDER BY date DESC $pages->limit";
    $stmt = $db->prepare($query);
    $stmt->execute();

    while ($row = $stmt->fetch(PDO::FETCH_ASSOC)) {
      // do stuff
    } 
```

# ios - TWRequest performRequestWithHandler 没有错误，但是什么也没发生

> ID：12467110
> 
> 赞同：4
> 
> 时间：2012-09-17T21:06:19.217
> 
> 标签：ios, twitter, request, twrequest

我正在尝试在 iOS 5 上使用 Twitter 框架进行共享用户将选择要使用的帐户，因此应用程序将使用所选帐户进行共享。

但是，谁分享却`performRequestWithHandler`一无所获`error``null`

我的代码：

```
for (int i = 0; i < [_accountsArray count]; i++) {
//searching for a selected account
            if ([[[_accountsArray objectAtIndex:i] username] isEqualToString:[self getUserName]]) {
                actualUser = [_accountsArray objectAtIndex:i];
                TWRequest *sendTweet = [[TWRequest alloc] initWithURL:[NSURL URLWithString:@"https://upload.twitter.com/1/statuses/update_with_media.json"]
                                                            parameters:nil
                                                        requestMethod:TWRequestMethodPOST];

                [sendTweet addMultiPartData:[text dataUsingEncoding:NSUTF8StringEncoding] withName:@"status" type:@"multipart/form-data"];
                ACAccountStore *account = [[ACAccountStore alloc] init];

                [sendTweet setAccount:[account.accounts objectAtIndex:i]];
                NSLog(@"%@",sendTweet.account);

                [sendTweet performRequestWithHandler:^(NSData *responseData, NSHTTPURLResponse *urlResponse, NSError *error) {

                    NSLog(@"responseData: %@\n",  responseData);
                    NSLog(@"urlResponse: %@\n", urlResponse);
                    NSLog(@"error: %@",error);

                }];
            }
        } 
```

任何人都可以帮助我吗？

谢谢

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-10-20T18:14:58.520

现在在 iOS 中发送推文非常容易。昨晚我更新了我的应用程序，不再使用旧技术，而是使用新的 SLComposeViewController 技术。下面是我在我的应用程序中的一段代码，它允许用户发送带有附加图像的推文。基本上完全相同的代码可用于发布到 facebook。请尝试改用此代码。它还应该允许用户选择他们从哪个帐户发送推文（我也相信这个“​​默认帐户”发送设置隐藏在某个地方的手机设置中）。

```
if ([SLComposeViewController isAvailableForServiceType:SLServiceTypeTwitter]) {
        SLComposeViewController *mySLComposerSheet = [SLComposeViewController composeViewControllerForServiceType:SLServiceTypeTwitter];
        [mySLComposerSheet setInitialText:@"Sample Tweet Text"];

        //Add the image the user is working with
        [mySLComposerSheet addImage:self.workingImage];

        //Add a URL if desired
        //[mySLComposerSheet addURL:[NSURL URLWithString:@"http://google.com"]];

        //Pop up the post to the user so they can edit and submit
        [self presentViewController:mySLComposerSheet animated:YES completion:nil];

        //Handle the event
        [mySLComposerSheet setCompletionHandler:^(SLComposeViewControllerResult result) {
            switch (result) {
                case SLComposeViewControllerResultCancelled:
                    NSLog(@"Tweet Canceled");
                case SLComposeViewControllerResultDone:
                    NSLog(@"Tweet Done");
                    break;
                default:
                    break;
            }
        }];

    } else {
        //Can't send tweets, show error
        NSLog(@"User doesn't have twitter setup");
    } 
```

# php - 如果 mysql_insert_id 同时从不同的地方和不同的浏览器调用会发生什么？

> ID：12467111
> 
> 赞同：1
> 
> 时间：2012-09-17T21:06:33.463
> 
> 标签：php, mysql-insert-id

也许我对 mysql_insert_id 有一些愚蠢的问题......

我需要在 mysql_query("INSERT INTO") 之后使用 mysql_insert_id 获取查询的最后插入 ID。

mysql_insert_id 检索上一个查询生成的Id，但我的问题是……

一个名为 test.php 的 php 文件，代码如下

```
mysql_query("INSERT INTO table (FirstName, LastName) VALUES ('" . $_POST['FirstName'] . "', '" . $_POST['LastName'] . "'); ")
$lastId = mysql_insert_id();
...continues some code using $lastId 
```

如果 test.php 文件同时从不同的地方和不同的浏览器调用会发生什么？或者如果同时调用包含 INSERT INTO 查询的其他 php 文件会发生什么？

实际上 Id 取回了 mysql_insert_id() ？我们与罕见的概率有关吗？

我不知道我是否可以理解...

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-09-17T21:14:18.827

PHP[手册](http://php.net/manual/en/function.mysql-insert-id.php)指出 的值`mysql_insert_id()`仅返回最近生成的`AUTO_INCREMENT`值：

> MySQL SQL 函数的值`LAST_INSERT_ID()`始终包含最近生成的`AUTO_INCREMENT`值，并且不会在查询之间重置。

MySQL[手册](http://dev.mysql.com/doc/refman/5.5/en/information-functions.html#function_last-insert-id)声明它将`AUTO_INCREMENT`基于每个连接返回最后一个：

> *生成的 ID 在每个连接的基础*上在服务器中维护。这意味着函数返回给给定客户端的值是为影响*该客户端*列的`AUTO_INCREMENT`最近语句生成的第一个值。此值不会受到其他客户端的影响，即使它们生成自己的值。这种行为确保每个客户端都可以检索自己的 ID，而不用担心其他客户端的活动，也不需要锁或事务。`AUTO_INCREMENT`*`AUTO_INCREMENT`*

 *此外，您应该停止使用`mysql_`函数，因为它们已被[弃用](http://www.deprecatedphp.com/mysql)。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-09-17T21:15:33.273

每个客户端都将坐在一个单独的连接上。`mysql_insert_id()`将根据传递的/当前连接获取`id`最后一个查询的。`insert`因此，您不必担心多个脚本会导致问题。

此外，根据您上面提供的代码，您的脚本容易受到 SQL 注入攻击。逃避您的用户输入，甚至更好的是，使用 PDO/MySQLi。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-09-17T21:09:22.213

您从连接上的最后一个查询中取回自动增量 ID。它不会交叉连接，因此两个脚本同时运行没有任何危害。

旁注：如果可以选择，请使用 mysqli 或 PDO 库，而不是已弃用的 mysql 库。*

# php - 使用 php 从 zip 中仅提取特定的文件类型

> ID：12467113
> 
> 赞同：1
> 
> 时间：2012-09-17T21:06:37.280
> 
> 标签：php, file, types, unzip

我正在创建一个简单的 web 应用程序，我的学生可以使用它来将他们的项目（作为 .zip 文件）上传到我的服务器。此应用程序采用 .zip > 解压缩 > 显示指向其网络项目的链接。

我正在使用这样的 php 函数来提取 zip 文件：

```
function openZip($file_to_open) {  
    global $target;  

    $zip = new ZipArchive();  
    $x = $zip->open($file_to_open);  
    if($x === true) {  
        $zip->extractTo($target);  
        $zip->close();  

        unlink($file_to_open);  
    } else {  
         die("There was a problem. Please try again!"); 
    } 
} 
```

是否可以检查要提取的文件的类型并只允许解压缩特定的文件类型？并不是说我不信任我的学生……只是想确保没有恶意软件进入我的服务器。

我的学生将上传简单的 Web 项目，所以我只想允许提取 .html、.css 和 .js（以及图像文件类型和目录）。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-09-17T21:27:42.100

查看[ZipArchive::getFromName](http://php.net/manual/en/ziparchive.getfromname.php)以按文件名从 Zip 中提取 1 个文件。您可能还想看看[ZipArchive::getFromIndex](http://php.net/manual/en/ziparchive.getfromindex.php)

```
$zip = new ZipArchive;
if ($zip->open('test1.zip') === TRUE)
{
    echo $zip->getFromName('testfromfile.php');
    $zip->close();
}
else
{
    echo 'failed';
} 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-09-17T21:58:57.543

你总是可以像这样尝试[finfo_file()](http://www.php.net/manual/en/function.finfo-file.php)：

```
$finfo = finfo_open(FILEINFO_MIME_TYPE);
echo finfo_file($finfo, "yourfile.zip");
finfo_close($finfo); 
```

# text - 我需要帮助查找此代码中的文本并修复它？

> ID：12467114
> 
> 赞同：0
> 
> 时间：2012-09-17T21:06:38.800
> 
> 标签：text, review

当我使用此代码时，我无法在浏览器中找到文本，请有人帮我告诉我我的错误我似乎找不到问题，它都是简单的 html 和 css

```
<html>
    <head>  <title>Header example</title>

    </head>
<style>
body {background: green; 
    height:100%;
    margin:0; padding:0;
    }

#header1 {z-index:2; 
    position:fixed; top:0; left:0; 
    width:100%; height:30%;
    }

p1 {background:#FFFF00;
    position:absolute; top: 80%; left: 5%; 
    height: 40%; width: 100%;
}
</style>
</head>

<body>
<body oncontextmenu="return false;">

        <div id="header1"> <img src="Head_img.gif" width="100%" height="100%" />
        </div>

    <div id="p1">
<p Text text text text text text text textText text text text text text text text Text text text text text text text text </p>
    </div>
</body>

</html> 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-09-17T21:11:33.530

```
<p> Text text text text text text text textText text text text text text text text Text text text text text text text text </p> 
```

不是

```
<p Text text text text text text text textText text text text text text text text Text text text text text text text text </p> 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-09-17T21:16:18.397

五个主要问题：

*   **你没有`<!DOCTYPE>`**
*   你有两个`<body>`开始标签。
*   你有两个`</head>`结束标签。
*   您的`<style>`块有点在`<head>`标签中。
*   您永远不会正确打开`<p>`标签。

一个小问题：

*   您的`<img />`标签应该有一个`alt`属性，其中包含一些描述该图像中内容的文本。

此代码应该可以工作：

```
<!DOCTYPE html>

<html>
<head>
  <title>Header example</title>
  <style type="text/css">
body {background: green; 
    height:100%;
    margin:0; padding:0;
    }
  #header1 {z-index:2; 
    position:fixed; top:0; left:0; 
    width:100%; height:30%;
    }
  p1 {background:#FFFF00;
    position:absolute; top: 80%; left: 5%; 
    height: 40%; width: 100%;
  }
  </style>
</head>

<body>
  <div id="header1"><img src="Head_img.gif" width="100%" height="100%"></div>

  <div id="p1">
    <p>Text text text text text text text textText text text text text text text text Text text text text text text text text</p>
  </div>
</body>
</html> 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-09-17T21:09:10.967

那么你的`<p>`元素没有任何结束`>`......

```
<p Text 
```

应该

```
<p> Text 
```

# java - IDE 是否在运行之前识别所有编译错误？

> ID：12467115
> 
> 赞同：1
> 
> 时间：2012-09-17T21:06:47.457
> 
> 标签：java, netbeans

我最近一直在想一些事情。它是关于像 netbeans 这样的 IDE 在我们输入代码时向我们显示的错误（假设是 java）。我想知道 IDE 是否能够在我们输入时识别所有编译时错误? 这意味着如果我们使用 IDE 运行代码，我们应该只得到运行时错误吗？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-09-17T21:10:20.487

如果 IDE 支持它，它会在您单击“编译”之前告诉您代码中的所有错误。这适用于所有 IDE，如果我没记错的话，有些还会给你编译器本身返回的任何错误。

这实际上完全取决于您的 IDE、设置，有时还取决于编译器。

希望这可以帮助。:)

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-09-17T21:09:16.253

它基于您所指的 IDE 及其设置。

不`EditPlus`。不显示任何编译时错误。

Eclipse/Netbeans，根据设置输出会有所不同。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-09-17T21:09:30.160

> 这意味着如果我们使用 IDE 运行代码，我们应该只得到运行时错误吗？

这取决于 IDE。例如，在 Eclipse 中，如果在您尝试运行代码时出现任何编译时错误，它会对此发出警告，但如果您愿意，仍允许您继续。此时，任何成功编译的代码都将正常执行——但任何*无法*编译的方法或类都将失败表示为生成的代码抛出的异常。抛出异常的确切位置取决于编译失败的类型。

*一般来说*，大多数时候你应该运行编译没有任何错误的代码。虽然 Eclipse 的“伪造”功能有时很方便，但在我看来，养成使用它的习惯而不是随时修复错误将是一个坏主意。

编辑：如果问题是“我是否总是知道是否有任何编译时错误”，那么是的，假设您不会盲目地忽略 Eclipse 给您的警告。我不知道有任何 IDE 可以*让*您在其中运行带有编译时错误的代码。（当然，您还应该查看错误视图，或者您的 IDE 碰巧提供的任何内容。）

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2012-09-17T21:15:21.167

这很简单：

如果您的 IDE 有能力，它会查看您编写的内容并查看它是否符合规范但是......

某些时候，您编写的内容将无法检查，即将对象显式转换为您传入错误类型（即 typecastexception）的类型。

编译器可以知道一些东西，即

```
int a = "abc"; // obviously wrong because "abc" is a string and not an int(eger) and COMPILE time 
```

无法知道某些事情（编辑：如果您将 true 传递给 findTheRunTimeError，您将收到 RUNTIME 错误）

```
int a;

public someFunction(object passedIn, bool findTheRuntimeError)
{
     if(!findTheRuntimeError)
     {
          return;
     }
     a = (string)passedIn;// obviously wrong cast because passedIn is cast to a string which is not an int(eger) and RUNTIME
} 
```

现在编译器有办法知道将要传递和转换的内容，因此它始终是运行时错误。

* * *

## 回答 #5

> 赞同：-2
> 
> 时间：2012-09-17T21:14:31.353

在您键入时，您的 IDE 会在您完成一个单词或类似内容后编译您的代码。这样，它就能够向您显示编码错误，例如不存在的变量或其他编译时错误。您的 IDE 使用您配置的 Java 编译器来执行此操作。当您尝试在命令行上使用 javac 编译不正确的代码时，它还会为您提供有关错误的信息。IDE 执行相同的操作，解析从 javac 获取的信息并在代码中突出显示它们。

# perl - 添加到 Perl 哈希会产生令人费解的结果

> ID：12467116
> 
> 赞同：1
> 
> 时间：2012-09-17T21:06:59.237
> 
> 标签：perl, debugging, hashmap

我对 Perl 有点陌生，这个错误让我困惑了几天。对于这个特定的问题，我很难在 Google 上找到任何东西。我会尽可能清楚地呈现“线索”。我正在使用 Perl v5.16.1。我的代码中的相关行是：

```
my %result = ();

...

$result{'TABLENAME'} = $tableName;

...

for my $i (1..$numberOfColumns) {
    $result{$columnNames[$i-1]} = $columnValues[$i-1];
} 
```

在我的测试中，`$numberOfColumns`是 7。问题是 for 循环没有像我预期的那样创建键值对。我会解释。我尝试使用 Perl 的调试器和`perl -d`. 下面的调试器输出显示在最后一行之前一切正常。

```
 DB<2> c 219
testcode::testsub(modules/testcode.pm:219):
219:        $result{'TABLENAME'} = $tableName;

  DB<3> c 239
testcode::testsub(modules/testcode.pm:239):
239:        for my $i (1..$numberOfColumns) {

  DB<4> p %result
TABLENAMEmyowntableitis

  DB<5> p $result{TABLENAME}
myowntableitis

  DB<6> s
testcode::testsub(modules/testcode.pm:240):
240:            $result{$columnNames[$i-1]} = $columnValues[$i-1];

  DB<6> p $i
1

  DB<7> p $columnNames[0]
id

  DB<8> p $columnValues[0]
1

  DB<9> s
testcode::testsub(modules/testcode.pm:240):
240:            $result{$columnNames[$i-1]} = $columnValues[$i-1];

  DB<9> p $i
2

  DB<10> p %result
TABLENAMEmyowntableitisid
1

  DB<11> p $result{TABLENAME}
    myowntableitis

  DB<12> p $result{id}

  DB<13> 
```

我希望最后一个`p $result{id}`返回 1 而不是什么都没有。有谁知道这里会发生什么？

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-09-17T21:20:21.350

如果我们查看`DB<10>`，我们会看到`1`打印在下一行：

```
DB<10> p %result
TABLENAMEmyowntableitisid
1 
```

这意味着`$result{"id\n"} eq "1"`, 并且您正在使用未定义的键。

风格说明：`foreach`当然，可以使用两个数组来构建哈希。但是话又说回来，Perl 有*slices*，这让生活变得更容易（除非你正在处理难以置信的大量数据）

```
@result{@columnNames} = @columnValues; 
```

（假设`@columnNames <= @columnValues`）

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-09-17T21:15:19.730

问题是`columnnames[0]`设置为`"id\n"`而不只是`id`. 注意 id 后面的换行符。我猜你是从文件中读取这些而不是删除换行符。值也是如此。添加到您的循环中：

```
chomp $columnNames[$i-1];
chomp $columnValues[$i-1]; 
```

那应该可以解决您的问题。或者，您可以从文件中读取这些值。

附带说明一下，习惯上将循环计数器作为索引本身。那是从`0`到`$numberOfColumns - 1`或（甚至到`$#columnNames`）循环。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-09-17T21:15:30.790

如果`$result{id}`为空，`$result{"id\n"}`返回什么？你可能没有[大吃大喝](http://p3rl.org/chomp)。

# scala - 定义简单 Stream 时奇怪的 Scala 行为

> ID：12467125
> 
> 赞同：1
> 
> 时间：2012-09-17T21:07:52.727
> 
> 标签：scala

为什么是6？我想定义序列（5、6、...）。如何正确使用“val”而不是“def”？

```
scala> val f: Stream[Int] = 5 #:: f map { _ + 1 }
f: Stream[Int] = Stream(6, ?) 
```

我正在使用 scala 2.9.2

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-09-17T21:10:33.280

您需要一些括号来告诉它应用`map`to `f`，而不是 5：

```
scala> val f: Stream[Int] = 5 #:: (f map { _ + 1 })
f: Stream[Int] = Stream(5, ?)

scala> f.take(5).toList
res2: List[Int] = List(5, 6, 7, 8, 9) 
```

# android - TCP 端口号 - 安卓手机 USB 连接

> ID：12467129
> 
> 赞同：0
> 
> 时间：2012-09-17T21:08:24.943
> 
> 标签：android, android-emulator

如何获取 USB 连接的 Android 手机的 TCP 端口号。我可以做这个

```
 netstat -an |find /i "listening" 
```

但随后它列出了所有监听端口，我怎么知道我的手机正在监听哪个端口。请问有人吗？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-09-18T20:41:02.913

也许我误解了您在这里尝试做什么，但是如果您的手机是通过 USB 连接的，那么它没有打开 TCP 端口，它是通过 USB 设备寻址的。查看 API 提供的 AdbTest 示例程序。

您可以让[Adb 通过 wifi 连接](http://developer.android.com/guide/topics/connectivity/usb/index.html)（请参阅本页的 bootom），但我相信在大多数情况下，这需要有根设备。

# mongodb - 使用 Mongo Spring 数据与 Mongo 的控制台（日期）查询日期

> ID：12467130
> 
> 赞同：0
> 
> 时间：2012-09-17T21:08:26.883
> 
> 标签：mongodb, spring-data, spring-data-mongodb

在 MongoDB 上使用 Spring Data 查询日期时，序列化的 DBObject 可能类似于 {"start" : { "$lt" : {"$date" : "2012-08-06T16:19:14.044Z"}}} ，这在 Spring Data 的上下文中是有效的，但是该查询在 Mongo 的控制台中没有结果。在控制台中，这确实返回了预期的结果 {"start" : { "$lt" : ISODate("2012-08-06T16:19:14.044Z")}}}。

那么是什么让 Spring Data 和 Mongo 的控制台中的查询有所不同呢？谢谢

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-09-17T21:46:47.600

您无法在 shell 中从 Spring Data 运行“序列化”查询。“序列化”查询以标准 JSON 显示，而不是包含 ISODate() 等的扩展 JSON，并且它与 shell 不兼容。

[http://www.mongodb.org/display/DOCS/Mongo+Extended+JSON](http://www.mongodb.org/display/DOCS/Mongo+Extended+JSON)

# iis-7 - 在没有 IISReset 的情况下更新后使 Sharepoint 使用新版本的 GAC 程序集

> ID：12467137
> 
> 赞同：0
> 
> 时间：2012-09-17T21:09:10.097
> 
> 标签：iis-7, sharepoint-2007, gac

我们在一些 SharePoint 站点中使用了一些 asp.net UserControl 库。有时我们会更改 UserControls 的程序集，或者有时它所依赖的某些程序集会发生变化（例如日志程序集）。我们在 GAC 中有这些程序集。当我们用新版本的程序集替换当前版本时，代码更改在执行 iisreset 之前不会生效。就像 SharePoint 实际使用的程序集缓存在磁盘或内存中的其他位置一样？如果我是唯一一个使用 SharePoint 网站的人，那么 iisreset 就可以了，但如果有其他用户使用该网站进行数据输入或其他开发，那真的会搞砸他们。有人可以解释我在这里看到的情况并告诉我是否有办法强制程序集从 GAC 重新加载，这样我就可以在没有 iisreset 的情况下看到我的代码更改？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-09-18T09:00:31.603

SharePoint 使用缓存版本的 DLL，并且重置 iis 是唯一的方法。其他选项是将您的 DLL 放在 Bin 文件夹中，这将导致应用程序池重新加载程序集。Sharepoint 开发的一般建议是每个开发人员都有自己的安装了 Sharepoint 的 VM。

# java - 如何让我的应用程序不挂在设备上

> ID：12467139
> 
> 赞同：0
> 
> 时间：2012-09-17T21:09:11.667
> 
> 标签：java, android, multithreading, arraylist, android-asynctask

一般来说，我是 android 开发和软件编程的新手，我相信我的应用程序中存在线程问题。该应用程序所做的是根据对 api 的两次查询搜索两组结果，并将每组结果存储在自己的列表中。将生成一个新列表，其中仅包含两个列表中的元素。该应用程序在我桌面上的虚拟设备中运行，但挂在我的 Galaxy Nexus 上。我为此使用了arraylist，但我想知道hashset是否会更快地完成这种类型的操作。以下是我的主要活动。getfirst 和 secondID 以及 getfirst 和 secondtitle 在 asynctask 中完成，以防止 networkonmainthread 异常。这是线程这个应用程序的最佳方式吗？谢谢你的帮助。

```
 @Override
public void onCreate(Bundle savedInstanceState) {
    super.onCreate(savedInstanceState);
    setContentView(R.layout.totlayout);

    //set the UI elements
    searchOne = (EditText) findViewById(R.id.searchOne);
    searchTwo = (EditText) findViewById(R.id.searchTwo);

    findMovies = (Button) findViewById(R.id.findMovies);

    searchOne.setOnKeyListener(new View.OnKeyListener() {

        @Override
        public boolean onKey(View v, int keyCode, KeyEvent event) {
            // TODO Auto-generated method stub
            //make person search url1
            final StringBuilder personSearchURLOne = new StringBuilder(getName.getName1(searchOne)); 
            searchURLOne = personSearchURLOne.toString();
            return false;
        }
    });

    searchTwo.setOnKeyListener(new View.OnKeyListener() {

        @Override
        public boolean onKey(View v, int keyCode, KeyEvent event) {
            // TODO Auto-generated method stub
            //make person search url2
            final StringBuilder personSearchURLTwo = new StringBuilder(getName.getName2(searchTwo));
            searchURLTwo = personSearchURLTwo.toString();

            return false;
        }
    }); 
}
public void getData(String searchURLOne, String searchURLTwo){
    try{
        //get ID 1 
        idOne = new getFirstID().execute(searchURLOne).get();
        Log.d("JSONArray idOne", idOne.toString());

       //get ID 2
       idTwo = new getSecondID().execute(searchURLTwo).get();
       Log.d("JSONArray idTwo", idTwo.toString());

       //make credit search url1
       final StringBuilder creditURLOne = new StringBuilder(buildCreditURL.getCreditURLOne(idOne));
       final String creditOne = creditURLOne.toString(); 
       Log.d("creditOne contains", creditOne);

       //make credit search url2
       final StringBuilder creditURLTwo = new StringBuilder(buildCreditURL.getCreditURLTwo(idTwo));
       final String creditTwo = creditURLTwo.toString();

       //get array of tiles for credit url 1 
       titleOne = new getFirstTitle().execute(creditOne).get();
       Log.d("titleOne Contains", titleOne.toString());

       //get array of titles for credit url 2
       titleTwo = new getSecondTitle().execute(creditTwo).get();

       //parse out common films into new array 
       myCommonFilms = new ArrayList<String>(commonFilms.getCommonFilms(titleOne, titleTwo));
    }
    catch(InterruptedException e){
        e.printStackTrace();
    }catch(ExecutionException e){
        e.printStackTrace();
    }

}
public void displayResults(View view) throws InterruptedException, ExecutionException{
    //do something in response to button
    getData(searchURLOne, searchURLTwo);
    Intent intent = new Intent(this, DisplayResultsActivity.class).putStringArrayListExtra("myCommonFilmsList", myCommonFilms);
    startActivity(intent);
}

@Override
public boolean onCreateOptionsMenu(Menu menu) {
    getMenuInflater().inflate(R.menu.totlayout, menu);
    return true;
}
} 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-09-17T22:19:39.023

这似乎阻止了 UI 线程：

```
 titleOne = new getFirstTitle().execute(creditOne).get(); 
```

最好使用一个新线程来完成长时间的工作，一旦完成，通知 UI 线程有关新数据的信息。

您可以使用 asyncTask 让您更轻松。如果您更喜欢普通线程，请使用[`handler`](http://developer.android.com/reference/android/os/Handler.html)（并使用[handler.post](http://developer.android.com/reference/android/os/Handler.html#post%28java.lang.Runnable%29)）或[`runOnUiThread`](http://developer.android.com/reference/android/app/Activity.html#runOnUiThread%28java.lang.Runnable%29)在线程完成后使用。

如果您使用 hanlder ，请不要忘记在线程本身之外创建它。

作为一个新的 android 开发者，你应该观看 google IO 视频。他们可以提供很多帮助。观看 2010 年至 2012 年的视频。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-09-17T21:18:38.357

我认为这是正确的方法：使用 AsyncTask 是一种防止您的应用程序冻结 UI 的简单方法。

但我真的不明白以下行的作用。

```
idOne = new getFirstID().execute(searchURLOne).get(); 
```

事实上，我以前从未见过它。无论如何，您在 ArrayList 中管理多少条记录？10, 100, 1000, 1 000 000 ?

如果您正在处理大量记录，您的手机将需要一定的时间来完成操作，您将无法减少它。如果集合太大，唯一的解决方案是尝试直接在服务器上或在构建 ArrayList 时尝试减少它。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-09-17T21:58:56.030

我不一定要关注 AsyncTask 的创建位置和执行位置，但将整个 getData 方法放在 AsyncTask 上似乎是个好主意。除此之外，如果它可以在设备上运行但不能在设备上运行，我的第一个怀疑是网络访问。确保您的设备不仅可以访问互联网，还可以访问运行远程查询所需的服务。很常见的误解是，手机不能像我们的台式机一样看到相同的主机。此外，如果您的手机在 Wifi 上漫游，请检查 Wifi 网络是否允许访问该服务。远程查询服务是 Web 服务吗？它是您尝试运行的 DBMS SQL 调用吗？查询是否需要特定的网络端口？

# language-agnostic - 将二维图中的 N 个点分成 2 组

> ID：12467147
> 
> 赞同：1
> 
> 时间：2012-09-17T21:09:52.640
> 
> 标签：language-agnostic, 2d, computational-geometry

假设在**二维图**中有**N 个点**。每个点都有一些**权重**。我需要画一条直线，这样直线将点分成两组，这样总权重（总权重该组中的点）重量较小的部分尽可能多。我的任务是找到这个值。如何去做？

 ****注意：没有三点在同一条线上。

这不是作业或任何比赛的一部分。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-09-18T00:53:31.203

您可以扫描所有角度和偏移量，直到找到最佳解决方案。

为了便于计算，我将使用一个简单的[旋转矩阵](http://en.wikipedia.org/wiki/Rotation_matrix)旋转所有点，以将这些点与扫描线对齐，这样您只需查看它们的 x 坐标。

您只需要检查半个圆，然后扫描线自身就会翻倍，假设您使用的是弧度，而不是度数，那就是 0 到 PI 的角度。还假设可以从数据中读取点作为具有 x、y 和权重值的某种对象。

伪代码：

```
Initialize points from input data
Initialize bestDifference to sum(weights of points)
Initialize bestAngle to 0
Initialize bestOffset to 0
Initialize angleStepSize to an arbitrary small value (e.g. PI/100)

For angle = 0:angleStepSize:PI
    Initialize rotatedpoints from points and rotationMatrix(angle)

    For offset = (lowest x in rotatedpoints) to (highest x in rotatedpoints)
        weightsLeft = sum of the weights of all nodes with x < offset
        weightsRight = sum of the weights of all nodes with x > offset
        difference = abs(weightsLeft - weightsRight)
        If difference < bestDifference 
            bestAngle = angle
            bestOffset = offset
            bestDifference = difference

    Increment angle by stepsize
Return bestAngle, bestOffset, bestDifference 
```

这是一个粗略的 Paint 图像来阐明我的方法：

![2dgraph 图像](../Images/8af95bfc651159b969f838de10db2198.png)****

# javascript - 当包含页面处于怪癖模式时，iframe 不会以 ie9 模式呈现

> ID：12467151
> 
> 赞同：10
> 
> 时间：2012-09-17T21:10:10.830
> 
> 标签：javascript, html, iframe, internet-explorer-9, quirks-mode

我在以怪癖模式运行的页面中有一个 iframe（我无法控制包含页面），并且我需要我的页面以与现代浏览器功能兼容的模式呈现。

包含的页面大量使用了较新的 JavaScript 功能（尤其是漂亮的数组函数）和 SVG 渲染。虽然我可以很容易地填充数组函数，但我不能强制 svg 渲染。

需要明确的是，内页不是在怪癖模式下运行的——我已经指定了一个 doctype 和 ie=edge < meta > 标签。好像是在使用ie8渲染模式~~（很难确定）~~

问题示例如下：http: [//stevesspace.com/quirks/quirks.html](http://stevesspace.com/quirks/quirks.html) - 在 chrome 中加载它以查看预期输出，并在 IE9 或 10 中检查实际输出。

编辑：我在示例中添加了文档模式和兼容模式，我可以确认它使用的是 IE8 文档模式。

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2012-09-20T21:39:26.957

我最终使用了对象标签而不是 iframe，它似乎在现代浏览器中都可以正常工作。

```
<object type="text/html" data="http://example.com"></object> 
```

事实证明，您不能在 IE9 中使用 javascript 修改 URL，但这没什么大不了的 - 删除/添加新的对象元素同样适用。

**更新：** 此标记也可以在 iframe 指向的中间页面中，并且一切正常 **更新 2：** 此解决方案在 IE10 中不起作用

# jquery - 在 ASP.NET Web 窗体 4.5 中捆绑 JQuery

> ID：12467155
> 
> 赞同：6
> 
> 时间：2012-09-17T21:10:20.127
> 
> 标签：jquery, asp.net, visual-studio-2012, webforms, bundling-and-minification

我使用 Visual Studio 2012 和内置模板（在 Add -> New Project 下）创建了一个全新的 ASP.NET Web Forms Web 应用程序项目。在默认提供的 Site.Master 页面中，我看到一些针对 JQuery 的标记，包含在下面。

给定以下标记，ASP.NET 如何找出包含 JQuery 所需的路径？

```
<asp:ScriptManager runat="server">
    <Scripts>
        <%--Framework Scripts--%>
        <asp:ScriptReference Name="MsAjaxBundle" />
        <asp:ScriptReference Name="jquery" />
        <asp:ScriptReference Name="jquery.ui.combined" />
        <asp:ScriptReference Name="WebForms.js" Assembly="System.Web" Path="~/Scripts/WebForms/WebForms.js" />
        <asp:ScriptReference Name="WebUIValidation.js" Assembly="System.Web" Path="~/Scripts/WebForms/WebUIValidation.js" />
        <asp:ScriptReference Name="MenuStandards.js" Assembly="System.Web" Path="~/Scripts/WebForms/MenuStandards.js" />
        <asp:ScriptReference Name="GridView.js" Assembly="System.Web" Path="~/Scripts/WebForms/GridView.js" />
        <asp:ScriptReference Name="DetailsView.js" Assembly="System.Web" Path="~/Scripts/WebForms/DetailsView.js" />
        <asp:ScriptReference Name="TreeView.js" Assembly="System.Web" Path="~/Scripts/WebForms/TreeView.js" />
        <asp:ScriptReference Name="WebParts.js" Assembly="System.Web" Path="~/Scripts/WebForms/WebParts.js" />
        <asp:ScriptReference Name="Focus.js" Assembly="System.Web" Path="~/Scripts/WebForms/Focus.js" />
        <asp:ScriptReference Name="WebFormsBundle" />
        <%--Site Scripts--%>
    </Scripts>
</asp:ScriptManager> 
```

我在任何地方都看不到将 jquery 解析为“~/Scripts/jquery-1.7.1.js”的配置文件或代码。我看到一个 packages.config 文件，但它没有明确描述必须以某种方式计算的路径。

有谁知道在运行时如何解析 JQuery 的 javascript 文件的路径？

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-09-17T22:09:58.457

在 Microsoft.ScriptManager.WebForms PreAppStartCode 中，它具有：

```
 System.Web.UI.ScriptManager.ScriptResourceMapping.AddDefinition("WebFormsBundle", new ScriptResourceDefinition
        {
            Path = "~/bundles/WebFormsJs",
            CdnPath = "http://ajax.aspnetcdn.com/ajax/4.5/6/WebFormsBundle.js",
            LoadSuccessExpression="window.WebForm_PostBackOptions",
            CdnSupportsSecureConnection = true
        }); 
```

这与脚本参考中的声明挂钩：

`<asp:ScriptReference Name="WebFormsBundle" />`

并且还会进行重复数据删除，因为 ScriptReference 路径与应该在 BundleConfig.cs 中注册的包内文件的路径相同

# svn - 扩展 SVN 以处理 ZIP 或其他文件类型中的文件

> ID：12467158
> 
> 赞同：0
> 
> 时间：2012-09-17T21:10:43.153
> 
> 标签：svn, tortoisesvn, zip, file-comparison

在过去的几个月里，我一直在编辑一些在 SVN 下的 nuget 包。有没有办法扩展 SVN，以便当您尝试比较从一个文件版本到另一个文件版本的更改时，它可以处理 zip 文件中的文件？

Nuget 包基本上是一个具有特定结构的文件夹，其中填充了不同的基于纯文本的文件（xml、txt 等）并以`.nupkg`.对于文件比较工具，[`WinMerge`](http://winmerge.org/)在我的情况下，SVN会先解包，然后将内容的根文件夹（`./`如果需要，也可以是自己生成的文件夹）传递给文件比较工具。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-09-18T08:12:01.417

您的意思是在客户端比较存档文件。您可以在 TortoiseSVN 中设置自定义差异查看器，而不是内置工具。

你需要做两件事：

1.  一个可以区分 zip 中文件的工具。一个例子是带有[存档支持的](http://manual.winmerge.org/Configuration.html)[WinMerge](http://winmerge.org/)（第 8 节）
2.  在 TortoiseSVN 中将此工具设置为您的默认差异/合并查看器。右键单击 Windows 资源管理器或桌面 -> TortoiseSVN -> 外部程序

# mediaelement.js - 隐藏全屏媒体元素

> ID：12467169
> 
> 赞同：1
> 
> 时间：2012-09-17T21:11:46.877
> 
> 标签：mediaelement.js

如何从 Flash 视频控制面板隐藏全屏选项？我在 IE 7-8 和 Safari 中播放的 flash 版本。我可以删除使用其他格式的浏览器的全屏按钮，没问题。我试过`<param name="allowfullscreen" value="false" />`在我的`object`标签内使用，但没有效果。

是否有任何简单的方法来自定义 Flash 视频控件。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-08-06T17:58:14.123

您可以在启动播放器时检查浏览器版本并在 mediaelement 播放器配置中显示/隐藏全屏图标。

```
$('video, audio').mediaelementplayer({
    // if the <video width> is not specified, this is the default
    defaultVideoWidth: 480,
    // if the <video height> is not specified, this is the default
    defaultVideoHeight: 270,
    // if set, overrides <video width>
    videoWidth: -1,
    // if set, overrides <video height>
    videoHeight: -1,
    // width of audio player
    audioWidth: 30,
    // height of audio player
    audioHeight: 400,
    // initial volume when the player starts
    startVolume: 0.8,
    // useful for <audio> player loops
    loop: false,
    // enables Flash and Silverlight to resize to content size
    enableAutosize: false,
    // the order of controls you want on the control bar (and other plugins below)
    //We are not showing "fullscreen" control in IE8 or lower as it does not work in IE8
    features: ( navigator.appVersion.indexOf('MSIE 8.0') > 0 || navigator.appVersion.indexOf('MSIE 7.0') > 0) ? ["playpause", "progress", "current", "duration", "tracks", "volume"] : ["playpause", "progress", "current", "duration", "tracks", "volume", "fullscreen"],

    //...
    //Other configurations go here
    //...
}); 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-09-18T00:36:34.427

`fullscreen`从功能配置参数中删除怎么样：

```
features: ['playpause','progress','current','duration','tracks','volume'] 
```

请参阅[http://mediaelementjs.com/上的第 4 节](http://mediaelementjs.com/)

# nuget - NuGet 包还原无法使用自定义源提示输入凭据

> ID：12467174
> 
> 赞同：6
> 
> 时间：2012-09-17T21:12:42.717
> 
> 标签：nuget

我在我的解决方案中启用了 NuGet 包还原。我正在使用 nuget.exe 版本 2.0.30828.5。对于普通公共源中的包，NuGet 包还原工作正常。也就是说，如果“Packages”目录中没有任何内容并且我的本地 NuGet 缓存 (C:\Users\{username}\AppData\Local\NuGet\Cache) 是清晰的，则 NPR 可以完美运行。

但是，当我们尝试将 NPR 用于自定义提要中的包时（自定义提要具有基本身份验证），我们会得到以下信息：

```
EXEC : warning : Unable to prompt for credentials. Consult NuGet's help documentation for ways to specify credentials.
c:\<localpath>\.nuget\nuget.targets(80,9): error : Unable to find version '2.0.1.0' of package '<packageName>'.
c:\<localpath>\.nuget\nuget.targets(80,9): error MSB3073: The command ""c:\<localpath>\.nuget\nuget.exe" install "c:\<localpath>\packages.config" -source ""  -RequireConsent -o "c:\<localpath>\packages"" exited with code 1. 
```

当我查看 NuGet 代码以及反编译 nuget.exe 以找到字符串**“无法提示输入凭据。请参阅 NuGet 的帮助文档以了解指定凭据的方法”**时，我在那里看到它，但坦率地说，我无法确定谁是利用该错误消息。

当我们添加包时（从 NuGet UI 或包管理器控制台），它会提示输入凭据并且工作正常。这只是包还原的问题。

我尝试运行此命令：

```
NuGet.exe source Update -Name {feedname} -UserName {myusername} -Password {mypassword} 
```

但得到相同的结果。

有谁知道如何使用基本身份验证为自定义 NuGet 提要指定凭据以进行 NuGet 包还原？

**2012 年 9 月 18 日更新**

我有关于这个问题的更新。我观察到，当我运行**nuget.exe source Update...**命令时，它会将部分添加到 NuGet.config 文件中，该文件位于我的解决方案本地的 .nuget 文件夹中。然后我在运行构建时运行了 procmon.exe，发现该文件没有被查看！相反，它在“C:\Users{username}\AppData\Roaming\NuGet”目录中寻找 NuGet.config 文件。然后，我将本地 NuGet.config 文件中的部分复制/粘贴到 \AppData\Roaming\NuGet 目录中的 NuGet.config 文件中，并且成功了！

所以......问题是，这个过程的**正确**最佳实践是什么？

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2012-09-18T17:55:38.373

我现在有这个工作。这就是我为了让它工作而做的。首先，它出现了命令：

```
NuGet.exe source Update -Name {feedname} -UserName {myusername} -Password {mypassword} 
```

是正确的方法。需要注意的是，当您运行“nuget.exe 源更新”命令时，nuget.exe 将在与正在执行的 nuget.exe 相同的目录中查找 NuGet.config 文件（如果存在）。**如果**存在，它将在那里存储更改。如果它不**存在**，它会将更改存储在位于 %AppData%\NuGet 目录中的 NuGet.config 文件中。

另外需要注意的是，当包还原作为构建的一部分执行时，**它只**查看 %AppData%\NuGet 目录中的 NuGet.config 文件，而忽略与 nuget 相同目录中的 NuGet.config 文件.exe 正在执行（我不确定这是错误还是故意）。

因此，您应该使用 nuget.exe 运行此命令，该目录中*没有*NuGet.config 文件，以确保更改存储在 %AppData%\NuGet 目录中正确的 NuGet.config 文件中。

# android - 线程和侦听器实例问题

> ID：12467177
> 
> 赞同：0
> 
> 时间：2012-09-17T21:12:56.783
> 
> 标签：android

我在某些手机中的线程和`onclick监听器实例有一个奇怪的行为（奇怪的是它不是由android版本，在带有android 4.03的GalaxyII中测试它并且工作，在带有3.2的Samsumg Galaxy Tab中工作正常并且在一个HTC EVO Design 4G with android 4.03 and a HTC EVO 4G with android 2.3.3 不起作用）所以这里是问题：

我有一个异步类，它调用 Web 服务并阻塞屏幕，直到服务完成，然后线程通知 UI 服务调用已完成，因此 UI 显示一个模态屏幕`addView(GenerateView)`，对活动进行操作。这很好用，直到我需要避免触发操作的按钮中的多次单击，因为多个视图正在添加到活动中。所以我实现了`OnClickListener`这样的自定义：

```
public abstract class OnOneClickListener implements OnClickListener {
    private boolean clickable;

    public OnOneClickListener(){
        clickable = true;
    }

   public final void onClick(View v) {
       if (clickable) {
           clickable = false;
           onOneClick(v);
       }
   }

   public abstract void onOneClick(View v);

   public void reset() {
       clickable = true;
   }
} 
```

因此，我实现了 custom `onclick`，阻止了按钮的可点击性，调用了 Web 服务，当它在创建并返回视图的函数中完成时，以模态窗口调用的形式添加到活动中，`reset()`并允许再次单击按钮。该函数通过参数接收类的实例。这就像前面提到的手机中的魅力，但在 HTC 中，当我调试时可以看到该`OnOneClickListener()`函数修改了可点击变量并且该`reset()`函数看不到它！它也以另一种方式发生，比如如果在类的两个不同实例中调用函数并且它不是！这只是我在 HTC 和线程方面遇到的一个问题，最令人难以置信的一个。

所以这是我的问题：

*   HTC 和线程有一些已知问题吗？
*   有什么解决办法吗？？（我正在使用 AsyncTask 进行调用，直到现在它都运行良好）

事实上，你能告诉我的任何能帮助我理解失败在哪里的东西都会非常有帮助，因为它让我发疯。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-09-17T21:51:07.317

你很幸运，它可以在某些手机上运行，​​因为它不是必须的。如果您更改`clickable`一个线程上的字段，则应显式同步另一个线程以查看更改。

尝试制作`clickable`字段`volatile`。Jeremy Manson 有一篇[很棒的](http://jeremymanson.blogspot.com/2008/11/what-volatile-means-in-java.html)关于`volatile`Java 并发的文章和其他优秀的文章。

I also suggest you to implement what you want the other way - just make the button disabled on first click until your web service gives you a result. Disabled button is a clear message to user that you handled the click and are doing something while it is disabled.

Check also [Happened-before](http://en.wikipedia.org/wiki/Happened-before) term on Wikipedia.

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-09-17T22:09:02.673

as long as you run all of the enable/disable of the clicking functionality on the UI thread , this should work fine .

anyway , you already have a built in API function that is called "[setClickable](http://developer.android.com/reference/android/view/View.html#setClickable%28boolean%29)" . why won't you use it ?

# php - 使用 php zend 框架读取 pdf 元数据。错误

> ID：12467178
> 
> 赞同：0
> 
> 时间：2012-09-17T21:12:58.593
> 
> 标签：php, zend-framework, pdf, metadata, zend-pdf

在上传到服务器之前，我需要阅读 pdf 元数据。我在任何地方都找不到为此编写的任何 php 类。有趣的是有一个`pdf_set_info()`功能但没有`pdf_get_info()`

现在我正在尝试使用 Zend 独立 pdf 解析器来实现这一点，这是我的代码

```
<?php
set_include_path(implode(PATH_SEPARATOR, array('path/to/Zend/library',get_include_path(),)));
require_once 'Zend/Loader/Autoloader.php';
Zend_Loader_Autoloader::getInstance();

$pdf = new Zend_Pdf("my_file.pdf");

?> 
```

这会引发一个例外“文件不是 PDF”。

```
Fatal error: Uncaught exception 'Zend_Pdf_Exception' with message 'File is not a PDF.'
in Zend/library/Zend/Pdf/Parser.php:396 Stack trace: #0 Zend/library/Zend/Pdf.php(318):
Zend_Pdf_Parser->__construct('my_file.pdf', Object(Zend_Pdf_ElementFactory_Proxy), false)
#1 Zend/zend.php(15): Zend_Pdf->__construct('my_file.pdf') #2 {main} thrown in Zend/library/Zend/Pdf/Parser.php on line 396 
```

我的 pdf 没有版权或锁定，它是`here http://69.49.225.82/pdf/my_file.pdf`

我用 zend [ZendFramework-1.12.0-minimal.tar.gz试过这个](http://packages.zendframework.com/releases/ZendFramework-1.12.0/ZendFramework-1.12.0-minimal.tar.gz)

# c# - 线程跨类添加项列表框

> ID：12467181
> 
> 赞同：2
> 
> 时间：2012-09-17T21:13:08.747
> 
> 标签：c#, multithreading, listbox

我有线程与类结合的问题。对于我的问题，我制作了一个简单的代码来解释我的问题。

```
using System;
using System.Collections.Generic;
using System.ComponentModel;
using System.Data;
using System.Drawing;
using System.Linq;
using System.Text;
using System.Windows.Forms;
using System.Threading;

namespace RemoteMonitorServer
{
    public partial class RemoteMonitor : Form
    {
        Thread cThread;
        Server cServer;

        public RemoteMonitor()
        {
            InitializeComponent();
        }

        private void Form1_Load(object sender, EventArgs e)
        {
            WriteLog("Programm started!");

            cServer = new Server();
            cThread = new Thread(new ThreadStart(cServer.StartServer));
            cThread.IsBackground = true;
            cThread.Start();
        }

        public void WriteLog(string sText)
        {
            MessageBox.Show(sText);
            listBox1.Items.Add(sText);
        }
    }
} 
```

该类具有以下代码：

```
using System;
using System.Collections.Generic;
using System.Linq;
using System.Text;

namespace RemoteMonitorServer
{
    class Server
    {
        public void StartServer()
        {
            RemoteMonitor cTest = new RemoteMonitor();

            cTest.WriteLog("Thread started!");
        }
    }
} 
```

现在，当我启动这段代码时，列表框确实得到“程序已启动！” 但不是“线程开始！”。虽然我收到两条 MessageBox 消息，但我相信该方法正在被调用。Visual Studio 2010 中没有错误，有人可以告诉我我在这里做错了什么吗？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-09-17T22:47:35.490

```
public delegate void RunAtFormThreadCallBack(Control control, RunningAtFormThread method);
private void RunAtFormThread(Control control, RunningAtFormThread method)
{

        if (control.InvokeRequired)
        {
            var callback = new RunAtFormThreadCallBack(RunAtFormThread);
            control.Invoke(callback, new object[] { control, method });
        }
        else
            method.Invoke();
} 
```

用法：

```
RunAtFormThread(listBox1, delegate
                            {
   // executing at control thread...
   listBox1.Items.Add(sText); 
   MessageBox.Show(sText);
}); 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-09-17T21:25:29.587

您可以使用[SynchronizationContext](http://msdn.microsoft.com/en-us/library/system.threading.synchronizationcontext.aspx)将您的调用同步到 UI。

```
// get a sync context
private readonly SynchronizationContext _sync = SynchronizationContext.Current; 
```

然后，将方法发送到线程池以排队工作：

```
 public void WriteLog(string sText)
    {
        _sync.Send((state) => {
           MessageBox.Show(sText);
           listBox1.Items.Add(sText);
        }, null);
    } 
```

在我提供的链接上阅读更多内容，以了解`Send`和方法之间的区别以及上面示例中对象`Post`的用途。`state`

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-09-18T14:56:01.013

好的，我终于明白了，它与RemoteMonitor的实例有关：

```
using System;
using System.Collections.Generic;
using System.ComponentModel;
using System.Data;
using System.Drawing;
using System.Linq;
using System.Text;
using System.Windows.Forms;
using System.Threading;

namespace RemoteMonitor
{
    public partial class RemoteMonitor : Form
    {
        Thread cThread;
        Server cServer;

        public RemoteMonitor()
        {
            InitializeComponent();   
        }

        private void RemoteMonitor_Load(object sender, EventArgs e)
        {
            WriteLog("Programm started!");

            cServer = new Server();
            cThread = new Thread(() => cServer.StartServer(this));
            cThread.Start();
        }

        public void WriteLog(string sText)
        {
            if (InvokeRequired)
            {
                Action action = () => lsbLogger.Items.Add(sText);
                lsbLogger.Invoke(action);
            }
            else
            {
                lsbLogger.Items.Add(sText);
            }
        }
    }
} 
```

和班级：

```
using System;
using System.Collections.Generic;
using System.Linq;
using System.Text;
using System.Threading;

namespace RemoteMonitor
{
    class Server
    {
        public void StartServer(RemoteMonitor cRemoteMonitor)
        {
            cRemoteMonitor.WriteLog("Thread started!");
        }
    }
} 
```

它就像一个魅力，感谢您的回答和评论！

# c# - 什么是 JsonUtility，为什么我的代码使用它？

> ID：12467182
> 
> 赞同：1
> 
> 时间：2012-09-17T21:13:11.437
> 
> 标签：c#, json, wcf, web-services, webmethod

我在`JsonUtility.GenerateIndentedJsonText = true`编写的 Web 服务中有一个 Web 方法。但我不知道为什么使用 JsonUtility。没有 JsonUtility 代码运行良好。

那么，在这种情况下，JsonUtility.GenerateIntentedText 有什么用呢？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-09-18T00:02:05.663

我最好的猜测是您的服务正在使用[JSON for .NET](http://sourceforge.net/projects/csjson/)，这是一个现在用于在 .NET 中处理 JSON 的非活动项目（很有趣）。它使用 System.Net.Json 命名空间。

JsonUtility 主要包含一堆与格式相关的东西（引号、转义+非转义字符串等）。GenerateIndentedText 标志只是意味着库生成的任何 JSON（即，当您在任何 JsonObjects 上使用 WriteTo 时）都将被缩进。缩进不会影响 JSON 的功能，因此除了影响人类可读性之外，将其关闭或打开并不重要。

# c# - winform 应用程序的内存使用情况

> ID：12467184
> 
> 赞同：0
> 
> 时间：2012-09-17T21:13:14.320
> 
> 标签：c#, memory

我有一个可以动态添加到 devexpress 选项卡控件的表单。当您第一次单击选项卡时，控件就在那里。您可以根据需要添加其他内容。每个都有一个删除按钮。但是，如果您单击添加按钮，它会在正在运行的进程下添加大约 30 MB。当您在其中删除一个时，MB 将保留在内存中。

我的删除代码：

```
MyCustom temp = this._UIList[idx] as MyCustom;
if (this._UIList.Count == 1)
{
temp.Clear();
}
else
{
if (temp != null)
    {
        this._UIList.RemoveAt(idx);
            this._UIList.TrimToSize();
            this.pnlInner.Controls.Remove(temp);
            temp.CleanUP();
            temp.Dispose();
            //now reshuffle all the note controls
            ReshuffleMyCustomControls();
    }
} 
```

任何方向都会非常有帮助。谢谢。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-09-17T21:32:02.503

确保删除所有已连接的事件处理程序。他们可以将引用保存在内存中。

对于您连接的任何事件，您都必须执行以下操作：

```
 stripevents(AddressOf Any_Control_ValChanged)
    stripevents(AddressOf Any_EnterControl)
    stripevents(AddressOf Any_LeaveControl)
    stripevents(AddressOf ButtonClick)

Sub stripevents(ByVal eh As EventHandler)
    [Delegate].RemoveAll(eh, eh)
End Sub 
```

# clojure - 使用 ClojureScript 生成 HTML

> ID：12467185
> 
> 赞同：4
> 
> 时间：2012-09-17T21:13:17.077
> 
> 标签：clojure, clojurescript

我正在尝试使用 clojure.browser.dom 生成以下 HTML 片段，但它看起来与打嗝不同，

```
<div data-role="controlgroup">
<a href="index.html" data-role="button">Yes</a>
<a href="index.html" data-role="button">No</a>
<a href="index.html" data-role="button">Maybe</a>
</div> 
```

生成 HTML 元素的正确表示法是什么？使用，

```
[:div {:data-role "controlgroup"} ...] 
```

不生成，

```
<div data-role="controlgroup"> 
```

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2013-01-28T12:26:04.247

还可以看看[dommy](https://github.com/prismatic/dommy)，它本质上是 murtaza52 建议的 crate 的优化版本（打嗝的 cljs 版本）。

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2012-09-18T17:45:16.370

看看 crate - [https://github.com/ibdknox/crate](https://github.com/ibdknox/crate) - 它是 cljs 的一个端口。

另请查看 enfocus ，它是 enlive 的实现 - [https://github.com/cgrand/enlive](https://github.com/cgrand/enlive)

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-09-17T21:58:09.273

[在https://github.com/flurfunk/flurfunk-web](https://github.com/flurfunk/flurfunk-web)上查看 Flurfunk 的 Web 前端。他们似乎已经推出了自己的 ClojureScript 库来生成 html，并且界面在本质上看起来类似于打嗝。

[这是来自https://github.com/flurfunk/flurfunk-web/blob/master/src/cljs/flurfunk/web/core.cljs](https://github.com/flurfunk/flurfunk-web/blob/master/src/cljs/flurfunk/web/core.cljs)的片段：

```
(ns flurfunk.web.core
  (:require [flurfunk.web.dom-helpers :as dom]))
(defn- create-dom []
  (dom/build [:div#content
               [:h1
                 [:a {:href "http://flurfunk.github.com"} title]]
               [:div#messages
                 [:div#message-input
                   [:div
                     [:label "Your name:"]
                     [:input#author-name-input {:type "text"}]]
                   [:textarea#message-textarea]
                   [:button#send-button "Send message"]
                   [:div#waiting-indication]]
                 [:div#hidden-channels
                   [:label "Hidden channels:"]
                   [:ul#hidden-channel-list]]
                 [:div#message-list]]
               [:button#load-more-button "Load more messages"]])) 
```

# java - Java Spring WS org.springframework.ws.soap.saaj.SaajSoapEnvelopeException：无法访问信封

> ID：12467186
> 
> 赞同：6
> 
> 时间：2012-09-17T21:13:16.877
> 
> 标签：java, spring

我正在经历不同环境中弹簧 ws 的奇怪行为。以下适用于本地 tomcat 7.0.29 上的 Soap UI，但确实返回下面提到的错误。

servlet.xml：

```
<bean id="propertyPlaceholder"
    class="org.springframework.beans.factory.config.PropertyPlaceholderConfigurer">
    <property name="locations">
        <value>classpath:ws.properties</value>
    </property>
    <property name="systemPropertiesModeName" value="SYSTEM_PROPERTIES_MODE_FALLBACK" />
    <property name="searchSystemEnvironment" value="true" />
</bean>

<bean
    class="org.springframework.ws.transport.http.WsdlDefinitionHandlerAdapter">
    <property name="transformLocations" value="true" />
</bean>

<bean
    class="org.springframework.ws.transport.http.WebServiceMessageReceiverHandlerAdapter">
    <property name="messageFactory">
        <bean class="org.springframework.ws.soap.saaj.SaajSoapMessageFactory" />
    </property>
</bean>

<bean id="payloadMapping"
    class="org.springframework.ws.server.endpoint.mapping.PayloadRootAnnotationMethodEndpointMapping">
    <property name="interceptors">
        <list>
            <ref local="validatingInterceptor" />
        </list>
    </property>
</bean>

<bean id="validatingInterceptor"
    class="org.springframework.ws.soap.server.endpoint.interceptor.PayloadValidatingInterceptor"
    autowire="byName">
    <property name="schema" value="/xsd/schema.xsd" />
    <property name="validateRequest" value="true" />
    <property name="validateResponse" value="true" />
</bean>

<bean
    class="org.springframework.ws.soap.server.endpoint.SoapFaultAnnotationExceptionResolver" />

<bean id="defaultHandlerMapping"
    class="org.springframework.web.servlet.handler.BeanNameUrlHandlerMapping" />

<bean id="baseWsdlDefinition" abstract="true"
    class="org.springframework.ws.wsdl.wsdl11.DefaultWsdl11Definition">
    <property name="requestSuffix" value="Request" />
    <property name="responseSuffix" value="Response" />
</bean>

<bean id="sampleJaxbMarshaller" class="org.springframework.oxm.jaxb.Jaxb2Marshaller">
    <property name="classesToBeBound">
        <list>
            <value>com.db.vhs.ws.jaxb.PlacementRequest</value>
            <value>com.db.vhs.ws.jaxb.PlacementResponse</value>... 
```

schem.xsd：

```
<xs:annotation>

    <xs:appinfo>

        <jaxb:globalBindings>

            <jaxb:javaType name="java.util.Date" xmlType="xs:dateTime"
                parseMethod="javax.xml.bind.DatatypeConverter.parseDateTime"
                printMethod="javax.xml.bind.DatatypeConverter.printDateTime" />

        </jaxb:globalBindings>

    </xs:appinfo>

</xs:annotation>

<!-- getClusterRequest -->

<xs:element name="getClusterRequest">
    <xs:complexType>
        <xs:sequence>
            <xs:element name="id" type="xs:long" />
        </xs:sequence>
    </xs:complexType>
</xs:element>

<xs:element name="getClusterResponse">
    <xs:complexType>
        <xs:sequence>
            <xs:element name="id" type="xs:long" />
            <xs:element name="Vcenter" type="xs:string" />
            <xs:element name="NAME" type="xs:string" />
            <xs:element name="MOREF" type="xs:string" />
            <xs:element name="OVERALLSTATUS" type="xs:string" />
            <xs:element name="COLLECTIONDATE" type="xs:dateTime" />
            <xs:element name="DPMENABLED" type="xs:int" />
            <xs:element name="DRSENABLED" type="xs:int" />
            <xs:element name="HAENABLED" type="xs:int" />
            <xs:element name="NUMCPUCORES" type="xs:int" />
            <xs:element name="NUMHOSTS" type="xs:int" />
            <xs:element name="TOTALCPU" type="xs:long" />
            <xs:element name="TOTALMEMORY" type="xs:long" />
            <xs:element name="VDatacenterID" type="xs:long" />
        </xs:sequence>
    </xs:complexType>
</xs:element>

<xs:element name="placementRequest">
    <xs:complexType>
        <xs:sequence>
            <xs:element name="request_header" type="header" />
            <xs:element name="request_body" type="requestBody" />
        </xs:sequence>
    </xs:complexType>
</xs:element>

<xs:complexType name="header">
    <xs:sequence>
        <xs:element name="request_id" type="xs:string" />
        <xs:element name="uuid" type="xs:string" />
        <xs:element name="type" type="xs:string" />
        <xs:element name="request_type">
            <xs:simpleType>
                <xs:restriction base="xs:int">
                    <xs:minInclusive value="0" />
                    <xs:maxInclusive value="1" />
                </xs:restriction>
            </xs:simpleType>
        </xs:element>
    </xs:sequence>
</xs:complexType>

<xs:complexType name="requestBody">
    <xs:sequence>
        <xs:choice>
            <xs:element name="cluster_request" type="clusterRequest" />
            <xs:element name="region_request" type="regionRequest" />
        </xs:choice>
    </xs:sequence>
</xs:complexType>

<xs:complexType name="clusterRequest">
    <xs:sequence minOccurs="0" maxOccurs="unbounded">
        <xs:element name="cluster" type="xs:string" />
    </xs:sequence>
</xs:complexType>

<xs:complexType name="regionRequest">
    <xs:sequence>
        <xs:element name="region" type="xs:string" />
        <xs:element name="OS" type="xs:string" />
        <xs:element name="clusterProductType">
            <xs:simpleType>
                <xs:list itemType="xs:string" />
            </xs:simpleType>
        </xs:element>
        <xs:element name="class">
            <xs:simpleType>
                <xs:restriction base="xs:int">
                    <xs:minInclusive value="0" />
                    <xs:maxInclusive value="3" />
                </xs:restriction>
            </xs:simpleType>
        </xs:element>
        <xs:element name="class_type">
            <xs:simpleType>
                <xs:restriction base="xs:int">
                    <xs:minInclusive value="0" />
                    <xs:maxInclusive value="2" />
                </xs:restriction>
            </xs:simpleType>
        </xs:element>
        <xs:element name="subnet" type="xs:string" />
    </xs:sequence>
</xs:complexType>

<xs:element name="placementResponse">
    <xs:complexType>
        <xs:sequence>
            <xs:element name="response_header" type="header" />
            <xs:element name="response_body" type="responseBody" />
        </xs:sequence>
    </xs:complexType>
</xs:element>

<xs:complexType name="responseBody">
    <xs:sequence>
        <xs:element name="class">
            <xs:simpleType>
                <xs:restriction base="xs:int">
                    <xs:minInclusive value="0" />
                    <xs:maxInclusive value="3" />
                </xs:restriction>
            </xs:simpleType>
        </xs:element>
        <xs:element name="capacity">
            <xs:complexType>
                <xs:sequence minOccurs="0" maxOccurs="unbounded">
                    <xs:element name="cluster">
                        <xs:complexType>
                            <xs:sequence>
                                <xs:element name="cluster_name" type="xs:string"></xs:element>
                                <xs:element name="v_center" type="xs:string"></xs:element>
                                <xs:sequence minOccurs="0" maxOccurs="unbounded">
                                    <xs:element name="storage" type="storage"></xs:element>
                                </xs:sequence>
                                <xs:sequence minOccurs="0" maxOccurs="unbounded">
                                    <xs:element name="host" type="host"></xs:element>
                                </xs:sequence>
                                <xs:element name="class_type" type="xs:int"></xs:element>
                                <xs:element name="timestamp" type="xs:string"></xs:element>
                            </xs:sequence>
                        </xs:complexType>
                    </xs:element>
                </xs:sequence>
            </xs:complexType>
        </xs:element>
    </xs:sequence>
</xs:complexType>

<!-- complex types for response ngp -->

<xs:complexType name="storage">
    <xs:sequence>
        <xs:element name="data_store_name" type="xs:string" />
        <xs:element name="total_storage" type="xs:long" />
        <xs:element name="allocated_storage" type="xs:long" />
        <xs:element name="storage_class" type="xs:string" />
    </xs:sequence>
</xs:complexType>

<xs:complexType name="host">
    <xs:sequence>
        <xs:element name="host_name" type="xs:string" />
        <xs:sequence minOccurs="0" maxOccurs="unbounded">
            <xs:element name="port_group_name" type="portgroup" />
        </xs:sequence>
        <xs:element name="physical_cpus" type="xs:int" />
        <xs:element name="allocated_cpus" type="xs:int" />
        <xs:element name="available_cpu_size" type="xs:long" />
        <xs:element name="average_cpu_usage" type="xs:double" />
        <xs:element name="max_cpu_usage" type="xs:double" />
        <xs:element name="physical_memory" type="xs:long" />
        <xs:element name="allocated_memory" type="xs:long" />
        <xs:element name="average_memory_usage" type="xs:double" />
        <xs:element name="max_memory_usage" type="xs:double" />
        <xs:element name="number_of_vms" type="xs:int" />
    </xs:sequence>
</xs:complexType>

<xs:complexType name="portgroup">
    <xs:sequence>
        <xs:element name="name" type="xs:string" />
        <xs:element name="subnet" type="xs:string" />
    </xs:sequence>
</xs:complexType> 
```

第一种方法适用于两种环境，第二种 (placementRequest) 返回：

```
<html><head><title>Apache Tomcat/7.0.29 - Error report</title><style><!--H1 {font-family:Tahoma,Arial,sans-serif;color:white;background-color:#525D76;font-size:22px;} H2 {font-family:Tahoma,Arial,sans-serif;color:white;background-color:#525D76;font-size:16px;} H3 {font-family:Tahoma,Arial,sans-serif;color:white;background-color:#525D76;font-size:14px;} BODY {font-family:Tahoma,Arial,sans-serif;color:black;background-color:white;} B {font-family:Tahoma,Arial,sans-serif;color:white;background-color:#525D76;} P {font-family:Tahoma,Arial,sans-serif;background:white;color:black;font-size:12px;}A {color : black;}A.name {color : black;}HR {color : #525D76;}--></style> </head><body><h1>HTTP Status 500 - Request processing failed; nested exception is org.springframework.ws.soap.saaj.SaajSoapEnvelopeException: Could not access envelope: Unable to create envelope from given source: ; nested exception is com.sun.xml.internal.messaging.saaj.SOAPExceptionImpl: Unable to create envelope from given source: </h1><HR size="1" noshade="noshade"><p><b>type</b> Exception report</p><p><b>message</b> <u>Request processing failed; nested exception is org.springframework.ws.soap.saaj.SaajSoapEnvelopeException: Could not access envelope: Unable to create envelope from given source: ; nested exception is com.sun.xml.internal.messaging.saaj.SOAPExceptionImpl: Unable to create envelope from given source: </u></p><p><b>description</b> <u>The server encountered an internal error (Request processing failed; nested exception is org.springframework.ws.soap.saaj.SaajSoapEnvelopeException: Could not access envelope: Unable to create envelope from given source: ; nested exception is com.sun.xml.internal.messaging.saaj.SOAPExceptionImpl: Unable to create envelope from given source: ) that prevented it from fulfilling this request.</u></p><p><b>exception</b> <pre>org.springframework.web.util.NestedServletException: Request processing failed; nested exception is org.springframework.ws.soap.saaj.SaajSoapEnvelopeException: Could not access envelope: Unable to create envelope from given source: ; nested exception is com.sun.xml.internal.messaging.saaj.SOAPExceptionImpl: Unable to create envelope from given source: 
```

org.springframework.web.servlet.FrameworkServlet.processRequest(FrameworkServlet.java:583) org.springframework.web.servlet.FrameworkServlet.doPost(FrameworkServlet.java:511) javax.servlet.http.HttpServlet.service(HttpServlet.java: 641）javax.servlet.http.HttpServlet.service（HttpServlet.java:722）

**根本原因**

```
org.springframework.ws.soap.saaj.SaajSoapEnvelopeException：无法访问信封：无法从给定源创建信封：；嵌套异常是 com.sun.xml.internal.messaging.saaj.SOAPExceptionImpl：无法从给定源创建信封：
org.springframework.ws.soap.saaj.SaajSoapMessage.getEnvelope(SaajSoapMessage.java:107)
org.springframework.ws.soap.AbstractSoapMessage.getSoapBody(AbstractSoapMessage.java:36)
org.springframework.ws.soap.AbstractSoapMessage.getPayloadSource(AbstractSoapMessage.java:46)
org.springframework.ws.server.endpoint.mapping.PayloadRootAnnotationMethodEndpointMapping.getLookupKeyForMessage(PayloadRootAnnotationMethodEndpointMapping.java:57)
org.springframework.ws.server.endpoint.mapping.AbstractMethodEndpointMapping.getEndpointInternal(AbstractMethodEndpointMapping.java:56)
org.springframework.ws.server.endpoint.mapping.AbstractEndpointMapping.getEndpoint(AbstractEndpointMapping.java:83)
org.springframework.ws.server.MessageDispatcher.getEndpoint(MessageDispatcher.java:248)
org.springframework.ws.server.MessageDispatcher.dispatch(MessageDispatcher.java:201)
org.springframework.ws.server.MessageDispatcher.receive(MessageDispatcher.java:168)
org.springframework.ws.transport.support.WebServiceMessageReceiverObjectSupport.handleConnection(WebServiceMessageReceiverObjectSupport.java:88)
org.springframework.ws.transport.http.WebServiceMessageReceiverHandlerAdapter.handle(WebServiceMessageReceiverHandlerAdapter.java:57)
org.springframework.web.servlet.DispatcherServlet.doDispatch(DispatcherServlet.java:875)
org.springframework.web.servlet.DispatcherServlet.doService(DispatcherServlet.java:807)
org.springframework.web.servlet.FrameworkServlet.processRequest(FrameworkServlet.java:571)
org.springframework.web.servlet.FrameworkServlet.doPost(FrameworkServlet.java:511)
javax.servlet.http.HttpServlet.service(HttpServlet.java:641)
javax.servlet.http.HttpServlet.service(HttpServlet.java:722)

```

**根本原因**

```
com.sun.xml.internal.messaging.saaj.SOAPExceptionImpl：无法从给定源创建信封：
com.sun.xml.internal.messaging.saaj.soap.EnvelopeFactory.createEnvelope(EnvelopeFactory.java:114)
com.sun.xml.internal.messaging.saaj.soap.ver1_1.SOAPPart1_1Impl.createEnvelopeFromSource(SOAPPart1_1Impl.java:70)
com.sun.xml.internal.messaging.saaj.soap.SOAPPartImpl.getEnvelope(SOAPPartImpl.java:122)
org.springframework.ws.soap.saaj.Saaj13Implementation.getEnvelope(Saaj13Implementation.java:169)
org.springframework.ws.soap.saaj.SaajSoapMessage.getEnvelope(SaajSoapMessage.java:103)
org.springframework.ws.soap.AbstractSoapMessage.getSoapBody(AbstractSoapMessage.java:36)
org.springframework.ws.soap.AbstractSoapMessage.getPayloadSource(AbstractSoapMessage.java:46)
org.springframework.ws.server.endpoint.mapping.PayloadRootAnnotationMethodEndpointMapping.getLookupKeyForMessage(PayloadRootAnnotationMethodEndpointMapping.java:57)
org.springframework.ws.server.endpoint.mapping.AbstractMethodEndpointMapping.getEndpointInternal(AbstractMethodEndpointMapping.java:56)
org.springframework.ws.server.endpoint.mapping.AbstractEndpointMapping.getEndpoint(AbstractEndpointMapping.java:83)
org.springframework.ws.server.MessageDispatcher.getEndpoint(MessageDispatcher.java:248)
org.springframework.ws.server.MessageDispatcher.dispatch(MessageDispatcher.java:201)
org.springframework.ws.server.MessageDispatcher.receive(MessageDispatcher.java:168)
org.springframework.ws.transport.support.WebServiceMessageReceiverObjectSupport.handleConnection(WebServiceMessageReceiverObjectSupport.java:88)
org.springframework.ws.transport.http.WebServiceMessageReceiverHandlerAdapter.handle(WebServiceMessageReceiverHandlerAdapter.java:57)
org.springframework.web.servlet.DispatcherServlet.doDispatch(DispatcherServlet.java:875)
org.springframework.web.servlet.DispatcherServlet.doService(DispatcherServlet.java:807)
org.springframework.web.servlet.FrameworkServlet.processRequest(FrameworkServlet.java:571)
org.springframework.web.servlet.FrameworkServlet.doPost(FrameworkServlet.java:511)
javax.servlet.http.HttpServlet.service(HttpServlet.java:641)
javax.servlet.http.HttpServlet.service(HttpServlet.java:722)

```

**根本原因**

```
javax.xml.transform.TransformerException：org.xml.sax.SAXParseException：根元素之前的文档中的标记必须格式正确。
com.sun.org.apache.xalan.internal.xsltc.trax.TransformerImpl.transform(TransformerImpl.java:719)
com.sun.org.apache.xalan.internal.xsltc.trax.TransformerImpl.transform(TransformerImpl.java:313)
com.sun.xml.internal.messaging.saaj.util.transform.EfficientStreamingTransformer.transform(EfficientStreamingTransformer.java:393)
com.sun.xml.internal.messaging.saaj.soap.EnvelopeFactory.createEnvelope(EnvelopeFactory.java:102)
com.sun.xml.internal.messaging.saaj.soap.ver1_1.SOAPPart1_1Impl.createEnvelopeFromSource(SOAPPart1_1Impl.java:70)
com.sun.xml.internal.messaging.saaj.soap.SOAPPartImpl.getEnvelope(SOAPPartImpl.java:122)
org.springframework.ws.soap.saaj.Saaj13Implementation.getEnvelope(Saaj13Implementation.java:169)
org.springframework.ws.soap.saaj.SaajSoapMessage.getEnvelope(SaajSoapMessage.java:103)
org.springframework.ws.soap.AbstractSoapMessage.getSoapBody(AbstractSoapMessage.java:36)
org.springframework.ws.soap.AbstractSoapMessage.getPayloadSource(AbstractSoapMessage.java:46)
org.springframework.ws.server.endpoint.mapping.PayloadRootAnnotationMethodEndpointMapping.getLookupKeyForMessage(PayloadRootAnnotationMethodEndpointMapping.java:57)
org.springframework.ws.server.endpoint.mapping.AbstractMethodEndpointMapping.getEndpointInternal(AbstractMethodEndpointMapping.java:56)
org.springframework.ws.server.endpoint.mapping.AbstractEndpointMapping.getEndpoint(AbstractEndpointMapping.java:83)
org.springframework.ws.server.MessageDispatcher.getEndpoint(MessageDispatcher.java:248)
org.springframework.ws.server.MessageDispatcher.dispatch(MessageDispatcher.java:201)
org.springframework.ws.server.MessageDispatcher.receive(MessageDispatcher.java:168)
org.springframework.ws.transport.support.WebServiceMessageReceiverObjectSupport.handleConnection(WebServiceMessageReceiverObjectSupport.java:88)
org.springframework.ws.transport.http.WebServiceMessageReceiverHandlerAdapter.handle(WebServiceMessageReceiverHandlerAdapter.java:57)
org.springframework.web.servlet.DispatcherServlet.doDispatch(DispatcherServlet.java:875)
org.springframework.web.servlet.DispatcherServlet.doService(DispatcherServlet.java:807)
org.springframework.web.servlet.FrameworkServlet.processRequest(FrameworkServlet.java:571)
org.springframework.web.servlet.FrameworkServlet.doPost(FrameworkServlet.java:511)
javax.servlet.http.HttpServlet.service(HttpServlet.java:641)
javax.servlet.http.HttpServlet.service(HttpServlet.java:722)

```

**根本原因**

```
org.xml.sax.SAXParseException：文档中根元素之前的标记必须格式正确。
com.sun.org.apache.xerces.internal.parsers.AbstractSAXParser.parse(AbstractSAXParser.java:1231)
com.sun.org.apache.xerces.internal.jaxp.SAXParserImpl$JAXPSAXParser.parse(SAXParserImpl.java:522)
org.xml.sax.helpers.XMLFilterImpl.parse(XMLFilterImpl.java:333)
com.sun.org.apache.xalan.internal.xsltc.trax.TransformerImpl.transformIdentity(TransformerImpl.java:636)
com.sun.org.apache.xalan.internal.xsltc.trax.TransformerImpl.transform(TransformerImpl.java:707)
com.sun.org.apache.xalan.internal.xsltc.trax.TransformerImpl.transform(TransformerImpl.java:313)
com.sun.xml.internal.messaging.saaj.util.transform.EfficientStreamingTransformer.transform(EfficientStreamingTransformer.java:393)
com.sun.xml.internal.messaging.saaj.soap.EnvelopeFactory.createEnvelope(EnvelopeFactory.java:102)
com.sun.xml.internal.messaging.saaj.soap.ver1_1.SOAPPart1_1Impl.createEnvelopeFromSource(SOAPPart1_1Impl.java:70)
com.sun.xml.internal.messaging.saaj.soap.SOAPPartImpl.getEnvelope(SOAPPartImpl.java:122)
org.springframework.ws.soap.saaj.Saaj13Implementation.getEnvelope(Saaj13Implementation.java:169)
org.springframework.ws.soap.saaj.SaajSoapMessage.getEnvelope(SaajSoapMessage.java:103)
org.springframework.ws.soap.AbstractSoapMessage.getSoapBody(AbstractSoapMessage.java:36)
org.springframework.ws.soap.AbstractSoapMessage.getPayloadSource(AbstractSoapMessage.java:46)
org.springframework.ws.server.endpoint.mapping.PayloadRootAnnotationMethodEndpointMapping.getLookupKeyForMessage(PayloadRootAnnotationMethodEndpointMapping.java:57)
org.springframework.ws.server.endpoint.mapping.AbstractMethodEndpointMapping.getEndpointInternal(AbstractMethodEndpointMapping.java:56)
org.springframework.ws.server.endpoint.mapping.AbstractEndpointMapping.getEndpoint(AbstractEndpointMapping.java:83)
org.springframework.ws.server.MessageDispatcher.getEndpoint(MessageDispatcher.java:248)
org.springframework.ws.server.MessageDispatcher.dispatch(MessageDispatcher.java:201)
org.springframework.ws.server.MessageDispatcher.receive(MessageDispatcher.java:168)
org.springframework.ws.transport.support.WebServiceMessageReceiverObjectSupport.handleConnection(WebServiceMessageReceiverObjectSupport.java:88)
org.springframework.ws.transport.http.WebServiceMessageReceiverHandlerAdapter.handle(WebServiceMessageReceiverHandlerAdapter.java:57)
org.springframework.web.servlet.DispatcherServlet.doDispatch(DispatcherServlet.java:875)
org.springframework.web.servlet.DispatcherServlet.doService(DispatcherServlet.java:807)
org.springframework.web.servlet.FrameworkServlet.processRequest(FrameworkServlet.java:571)
org.springframework.web.servlet.FrameworkServlet.doPost(FrameworkServlet.java:511)
javax.servlet.http.HttpServlet.service(HttpServlet.java:641)
javax.servlet.http.HttpServlet.service(HttpServlet.java:722)

```

**note** Apache Tomcat/7.0.29 日志中提供了根本原因的完整堆栈跟踪。

### Apache Tomcat/7.0.29

pom.xml：

```
<dependency>
        <groupId>org.springframework</groupId>
        <artifactId>spring-context</artifactId>
        <version>3.1.2.RELEASE</version>
    </dependency>
    <dependency>
        <groupId>org.hibernate</groupId>
        <artifactId>hibernate-entitymanager</artifactId>
        <version>4.1.2</version>
    </dependency>
    <dependency>
        <groupId>org.springframework</groupId>
        <artifactId>spring-core</artifactId>
        <version>3.1.2.RELEASE</version>
    </dependency>
    <dependency>
        <groupId>org.springframework</groupId>
        <artifactId>spring-orm</artifactId>
        <version>3.1.2.RELEASE</version>
    </dependency>
    <dependency>
        <groupId>org.springframework</groupId>
        <artifactId>spring-jdbc</artifactId>
        <version>3.1.2.RELEASE</version>
    </dependency>
    <dependency>
        <groupId>org.apache.tomcat</groupId>
        <artifactId>tomcat-jdbc</artifactId>
        <version>7.0.29</version>
    </dependency>
    <dependency>
        <groupId>org.springframework.ws</groupId>
        <artifactId>spring-ws-core-tiger</artifactId>
        <version>1.5.7</version>
    </dependency>
    <dependency>
        <groupId>org.springframework.ws</groupId>
        <artifactId>spring-ws-core</artifactId>
        <version>1.5.7</version>
    </dependency>
    <dependency>
        <groupId>com.sun.xml.messaging.saaj</groupId>
        <artifactId>saaj-impl</artifactId>
        <version>1.3</version>
    </dependency>
    <dependency>
        <groupId>xerces</groupId>
        <artifactId>xercesImpl</artifactId>
        <version>2.8.1</version>
    </dependency>
    <dependency>
        <groupId>org.apache.ws.commons.schema</groupId>
        <artifactId>XmlSchema</artifactId>
        <version>1.4.2</version>
    </dependency>
    <dependency>
        <groupId>javax.xml.bind</groupId>
        <artifactId>jaxb-api</artifactId>
        <version>2.2</version>
    </dependency>
    <dependency>
        <groupId>com.oracle</groupId>
        <artifactId>ojdbc6</artifactId>
        <version>11.2.0.2.0</version>
    </dependency>
    <dependency>
        <groupId>com.cloudbees.thirdparty</groupId>
        <artifactId>vijava</artifactId>
        <version>5.0.0</version>
    </dependency>
    <dependency>
        <groupId>org.slf4j</groupId>
        <artifactId>slf4j-log4j12</artifactId>
        <version>1.6.4</version>
    </dependency>
    <dependency>
        <groupId>commons-codec</groupId>
        <artifactId>commons-codec</artifactId>
        <version>1.6</version>
    </dependency>
    <dependency>
        <groupId>commons-configuration</groupId>
        <artifactId>commons-configuration</artifactId>
        <version>1.7</version>
    </dependency>
    <dependency>
        <groupId>dom4j</groupId>
        <artifactId>dom4j</artifactId>
        <version>1.6.1</version>
    </dependency>
    <dependency>
        <groupId>org.hibernate</groupId>
        <artifactId>hibernate-core</artifactId>
        <version>4.1.2</version>
    </dependency>
</dependencies> 
```

我读到可能是网络服务器覆盖了 Maven 依赖项？或者您对如何解决这个问题有什么建议？如果有人可以提供帮助，将不胜感激！！！

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-07-07T16:20:05.753

我刚刚解决了同样的问题。

在我的情况下，问题出在与 HTTPS 一起使用的旧 spring-ws 版本中。

升级到最新版本（2.1.3）有所帮助。

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2012-10-31T11:23:18.357

I had the same error as you. I've found the solution here: [http://mmmsoftware.blogspot.com.es/2009/06/xml-namespace-error-with-spring-ws.html](http://mmmsoftware.blogspot.com.es/2009/06/xml-namespace-error-with-spring-ws.html)

Basically you have to use upper versions of **xalan** and **xercesimpl**. My pom's dependencies look like this:

```
<project ...>
 ...
<dependencies>

             ...

    <dependency>
        <groupId>jaxen</groupId>
        <artifactId>jaxen</artifactId>
        <version>1.1.3</version>
        <scope>compile</scope>
        <exclusions>
            <exclusion>
                <artifactId>maven-cobertura-plugin</artifactId>
                <groupId>maven-plugins</groupId>
            </exclusion>
            <exclusion>
                <artifactId>maven-findbugs-plugin</artifactId>
                <groupId>maven-plugins</groupId>
            </exclusion>
            <exclusion>
                <artifactId>xalan</artifactId>
                <groupId>xalan</groupId>
            </exclusion>
            <exclusion>
                <artifactId>xercesImpl</artifactId>
                <groupId>xerces</groupId>
            </exclusion>
        </exclusions>
    </dependency>

             ...

    <dependency>
        <groupId>xalan</groupId>
        <artifactId>xalan</artifactId>
        <version>2.7.0</version>
        <type>jar</type>
        <scope>compile</scope>
        <exclusions>
            <exclusion>
                <artifactId>xml-apis</artifactId>
                <groupId>xml-apis</groupId>
            </exclusion>
        </exclusions>
    </dependency>
    <dependency>
        <groupId>xerces</groupId>
        <artifactId>xercesImpl</artifactId>
        <version>2.9.1</version>
        <type>jar</type>
        <scope>compile</scope>
        <exclusions>
            <exclusion>
                <artifactId>xml-apis</artifactId>
                <groupId>xml-apis</groupId>
            </exclusion>
        </exclusions>
    </dependency>
</dependencies>
 ...
</project> 
```

I hope it helps you.

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2017-07-12T05:04:17.867

我有这个问题

我创建了在其中写入信封汤的 xml 文件。并通过 curl 运行它，如下所示：

curl --header "Content-Type: text/xml;charset=UTF-8" --header "SOAPAction:urn:LoginRequest" --data @loginRequest.xml [http://.....:8080/.. ./LoginRequest.asmx](http://.....:8080/.../LoginRequest.asmx)

然后它返回上异常。

在我的情况下，问题是 loginRequest.xml 中的额外行

我只是删除了多余的行，它已修复:)

# php - 使用 IMAP 和 PHP 保存附件服务器

> ID：12467188
> 
> 赞同：3
> 
> 时间：2012-09-17T21:13:27.343
> 
> 标签：php, imap

现在我正在使用此代码从我的服务器获取电子邮件。

```
<?php
$imap = imap_open($server, $username, $password) or die("Connection Error");
$message_count = imap_num_msg($imap);
for ($i = 1; $i <= $message_count; ++$i){

    $header = imap_header($imap, $i);
    //print_r($header);

    $email[$i]['fromaddress'] = $header->from[0]->personal;
    $email[$i]['to'] = $header->to[0]->mailbox;
    $email[$i]['subject'] = $header->subject;
    $email[$i]['message_id'] = $header->message_id;
    $email[$i]['date'] = $header->udate;

    $from = $email[$i]['fromaddress'];
    $from_email = $email[$i]['from'];
    $to = $email[$i]['to'];
    $subject = $email[$i]['subject'];

    echo $from_email . '</br>';
    echo $to . '</br>';
    echo $subject . '</br>';

    imap_setflag_full($imap, $i, "\\Seen");
    imap_mail_move($imap, $i, 'Trash');
}

imap_close($imap);

?> 
```

我也希望能够获取附件并将​​它们保存到我服务器上的文件夹中，并在输出中显示指向这些附件的链接。完成此任务的最简单方法是什么？

* * *

## 回答 #1

> 赞同：24
> 
> 时间：2012-09-18T13:58:35.190

我实际上能够通过以下方式让它完全按照我的意愿行事：

```
<?php

function getFileExtension($fileName){
   $parts=explode(".",$fileName);
   return $parts[count($parts)-1];
}

$imap = imap_open($server, $username, $password) or die("imap connection error");
$message_count = imap_num_msg($imap);
for ($m = 1; $m <= $message_count; ++$m){

    $header = imap_header($imap, $m);
    //print_r($header);

    $email[$m]['from'] = $header->from[0]->mailbox.'@'.$header->from[0]->host;
    $email[$m]['fromaddress'] = $header->from[0]->personal;
    $email[$m]['to'] = $header->to[0]->mailbox;
    $email[$m]['subject'] = $header->subject;
    $email[$m]['message_id'] = $header->message_id;
    $email[$m]['date'] = $header->udate;

    $from = $email[$m]['fromaddress'];
    $from_email = $email[$m]['from'];
    $to = $email[$m]['to'];
    $subject = $email[$m]['subject'];

    echo $from_email . '</br>';
    echo $to . '</br>';
    echo $subject . '</br>';

    $structure = imap_fetchstructure($imap, $m);

    $attachments = array();
    if(isset($structure->parts) && count($structure->parts)) {

        for($i = 0; $i < count($structure->parts); $i++) {

            $attachments[$i] = array(
                'is_attachment' => false,
                'filename' => '',
                'name' => '',
                'attachment' => ''
            );

            if($structure->parts[$i]->ifdparameters) {
                foreach($structure->parts[$i]->dparameters as $object) {
                    if(strtolower($object->attribute) == 'filename') {
                        $attachments[$i]['is_attachment'] = true;
                        $attachments[$i]['filename'] = $object->value;
                    }
                }
            }

            if($structure->parts[$i]->ifparameters) {
                foreach($structure->parts[$i]->parameters as $object) {
                    if(strtolower($object->attribute) == 'name') {
                        $attachments[$i]['is_attachment'] = true;
                        $attachments[$i]['name'] = $object->value;
                    }
                }
            }

            if($attachments[$i]['is_attachment']) {
                $attachments[$i]['attachment'] = imap_fetchbody($imap, $m, $i+1);
                if($structure->parts[$i]->encoding == 3) { // 3 = BASE64
                    $attachments[$i]['attachment'] = base64_decode($attachments[$i]['attachment']);
                }
                elseif($structure->parts[$i]->encoding == 4) { // 4 = QUOTED-PRINTABLE
                    $attachments[$i]['attachment'] = quoted_printable_decode($attachments[$i]['attachment']);
                }
            }
        }
    }

    foreach ($attachments as $key => $attachment) {
        $name = $attachment['name'];
        $contents = $attachment['attachment'];
        file_put_contents($name, $contents);
    }

    //imap_setflag_full($imap, $i, "\\Seen");
    //imap_mail_move($imap, $i, 'Trash');
}

imap_close($imap);

?> 
```

# php - 使用 SQL LIKE 子句

> ID：12467191
> 
> 赞同：0
> 
> 时间：2012-09-17T21:14:03.880
> 
> 标签：php, mysql

我想将一个变量连接到我的 LIKE 子句中。我相信我做错了。我能做些什么？

```
$query2= "SELECT user_id FROM interests WHERE interest LIKE     
'%'".$interest."'%'"; 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-09-17T21:15:18.357

引号的定位是错误的。检查 % 符号周围的单引号。

`$query2= "SELECT user_id FROM interests WHERE interest LIKE '%".$interest."%'";`

您之前拥有的是 '%' $interest '%' 而不是 '% $interest %' 这正是您想要的。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-09-17T21:16:14.660

这是将变量连接成字符串的正确方法：

```
$query2 = "SELECT user_id FROM interests WHERE interest LIKE '%" . $interest. "%'"; 
```

之后有额外的单引号`LIKE`。

但是，您应该使用使用`mysqli_`或 PDO 的预准备语句。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-09-17T21:16:27.000

删除之后的单引号`%`。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2012-09-17T21:20:19.150

删除多余的引号，不要忘记转义外部输入（或使用准备好的语句）。

```
$query2= "SELECT user_id FROM interests WHERE interest LIKE '%".
         mysqli_real_escape_string($interest)."%'"; 
```

# usb - 为设备手动设置 USB 传输类型

> ID：12467192
> 
> 赞同：1
> 
> 时间：2012-09-17T21:14:06.330
> 
> 标签：usb, kinect, openni, libusb, point-cloud-library

我尝试在 ARM 板（Pandaboard）上运行 Asus xtion，并且我已经安装并使用了 openni 提供的示例（例如 NiSimpleRead）。为了让这些示例在这个平台上运行，需要进行一些调整，其中之一是将 UsbInterface 手动设置为同步（在 GlobalDefaults.ini 中）。但在那之后一切顺利

现在我想使用 PCL（基于 openni）来抓取一些帧，但 PCL 不起作用。我相信 pcl 尝试自行设置 USB 接口（它可能使用 XnUSBLinux.cpp 通用）并尝试绕过 GlobalDefaults.ini，分别不使用我手动设置的 USB 接口。

我的问题是我是否可以将设备的 USB 接口选项设置为全局同步？或者我如何更改 XnUSBLinux.cpp 以使其运行。

这是 lsusb -v 的输出（简化为华硕设备部分）并显示了两个操作选项（批量和同步）

```
Bus 001 Device 006: ID 1d27:0600
Device Descriptor:
  bLength                18
  bDescriptorType         1
  bcdUSB               2.00
  bDeviceClass            0 (Defined at Interface level)
  bDeviceSubClass         0
  bDeviceProtocol         0
  bMaxPacketSize0        64
  idVendor           0x1d27
  idProduct          0x0600
  bcdDevice            0.01
  iManufacturer           2 PrimeSense
  iProduct                1 PrimeSense Device
  iSerial                 0
  bNumConfigurations      1
  Configuration Descriptor:
    bLength                 9
    bDescriptorType         2
    wTotalLength           69
    bNumInterfaces          1
    bConfigurationValue     1
    iConfiguration          0
    bmAttributes         0x80
      (Bus Powered)
    MaxPower              500mA
    Interface Descriptor:
      bLength                 9
      bDescriptorType         4
      bInterfaceNumber        0
      bAlternateSetting       0
      bNumEndpoints           3
      bInterfaceClass       255 Vendor Specific Class
      bInterfaceSubClass      0
      bInterfaceProtocol      0
      iInterface              0
      Endpoint Descriptor:
        bLength                 7
        bDescriptorType         5
        bEndpointAddress     0x81  EP 1 IN
        bmAttributes            1
          Transfer Type            Isochronous
          Synch Type               None
          Usage Type               Data
        wMaxPacketSize     0x0b70  2x 880 bytes
        bInterval               1
      Endpoint Descriptor:
        bLength                 7
        bDescriptorType         5
        bEndpointAddress     0x82  EP 2 IN
        bmAttributes            1
          Transfer Type            Isochronous
          Synch Type               None
          Usage Type               Data
        wMaxPacketSize     0x135c  3x 860 bytes
        bInterval               1
      Endpoint Descriptor:
        bLength                 7
        bDescriptorType         5
        bEndpointAddress     0x83  EP 3 IN
        bmAttributes            1
          Transfer Type            Isochronous
          Synch Type               None
          Usage Type               Data
        wMaxPacketSize     0x1040  3x 64 bytes
        bInterval               1
    Interface Descriptor:
      bLength                 9
      bDescriptorType         4
      bInterfaceNumber        0
      bAlternateSetting       1
      bNumEndpoints           3
      bInterfaceClass       255 Vendor Specific Class
      bInterfaceSubClass      0
      bInterfaceProtocol      0
      iInterface              0
      Endpoint Descriptor:
        bLength                 7
        bDescriptorType         5
        bEndpointAddress     0x81  EP 1 IN
        bmAttributes            2
          Transfer Type            Bulk
          Synch Type               None
          Usage Type               Data
        wMaxPacketSize     0x0200  1x 512 bytes
        bInterval               1
      Endpoint Descriptor:
        bLength                 7
        bDescriptorType         5
        bEndpointAddress     0x82  EP 2 IN
        bmAttributes            2
          Transfer Type            Bulk
          Synch Type               None
          Usage Type               Data
        wMaxPacketSize     0x0200  1x 512 bytes
        bInterval               1
      Endpoint Descriptor:
        bLength                 7
        bDescriptorType         5
        bEndpointAddress     0x83  EP 3 IN
        bmAttributes            2
          Transfer Type            Bulk
          Synch Type               None
          Usage Type               Data
        wMaxPacketSize     0x0200  1x 512 bytes
        bInterval               1
Device Qualifier (for other device speed):
  bLength                10
  bDescriptorType         6
  bcdUSB               2.00
  bDeviceClass            0 (Defined at Interface level)
  bDeviceSubClass         0
  bDeviceProtocol         0
  bMaxPacketSize0        64
  bNumConfigurations      1
Device Status:     0x0000
  (Bus Powered) 
```

在如何手动设置一个选项方面获得您的帮助会很棒。

# asp.net - Web 服务器如何知道何时是回发或何时是初始请求？

> ID：12467199
> 
> 赞同：1
> 
> 时间：2012-09-17T21:14:34.207
> 
> 标签：asp.net, web, client-server

很简单。在 Web 客户端（Web 浏览器）向 Web 服务器发送请求后，Web 客户端期待并接收来自 Web 服务器的响应。之后（从提交开始）Web 客户端将一些数据发送到 Web 服务器（回发）。但是，在内部，Web 服务器如何知道什么是回发或网页的第一次请求（可能是 HTTP 请求中的一些标志？）？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-09-17T21:15:54.443

HTTP 有很多动词，例如`POST`and `GET`。`GET`就像输入网址一样。`POST`通常用于表格。

如果页面方法是`POST`，则应该设置（在 ASP.NET 中）。

```
if (Page.IsPostBack)
{

} 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-09-17T21:41:08.603

如果我们只是在谈论 IIS/服务器 - 那么它*不能（就它自己而言）*。第*一个请求*可以是任何动词（`GET`,`POST`或您允许的任何其他动词）。

如果我们谈论的是 ASP.NET Web 表单页面，您*可以假设*（但不是 100%）“第一个”请求是一个`GET`和一个“回发”，本质上术语本身就是一个`POST`. 但就像上面一样，您可以创建一个 ASP.Net 页面，将 a`POST`作为**它的**第一个请求。

作为开发人员，您可以创建方法来识别“第一个请求”，但您可以定义它。这可能是您强制执行流程的方式。动词真的与识别“第一个（http）请求”没有任何关系......

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-09-17T21:33:22.900

虽然只是整个故事的一部分，但这可能是`System.Web.UI.Page`课程中最相关的摘录：

在方法中`ProcessRequestMain(bool includeStagesBeforeAsyncPoint, bool includeStagesAfterAsyncPoint)`：

```
if (this._requestValueCollection != null) {
    [..]
    text2 = this._requestValueCollection["__CALLBACKID"];
    if (text2 != null && this._request.HttpVerb == HttpVerb.POST)
    {
        this._isCallback = true;
    }
[..]
} 
```

显然，ASP.NET 在 post 参数中传输加密`__CALLBACKID`，并检查 HTTP 请求消息中是否设置了 POST 动词。

# python - 如何通知 Python/Tornado 客户端已关闭选项卡/浏览器？

> ID：12467204
> 
> 赞同：4
> 
> 时间：2012-09-17T21:15:09.510
> 
> 标签：python, connection, chat, tornado

我一直在寻找有关此问题的解决方案，但没有骰子。

编辑：我没有指出我正在尝试制作聊天服务器。所以人们登录，他们的 id 被附加到一个`users`和一个`listeners`列表中。他们开始聊天。但是，当其中一个尝试关闭选项卡或浏览器时，用户将永远不会从两个列表中删除，因此他/她会保持登录状态。

Edit2：我认为上面的编号有点混乱，所以我把脚本中的部分也贴在了底部。

到目前为止，我已经尝试了 on_connection_close() 函数（它永远不会被触发，我不知道为什么），该`on_finish()`函数（每次`finish()`调用 a 时都会被触发）所以也不符合要求.

现在我想出了一些涉及该`on_finish()`功能的解决方案：

1.  每当调用`UpdateHandler`类的`post()`函数时，就会`self.done = 0`设置。
2.  就在`finish()`函数被触发之前，我设置了`self.done = 1`.
3.  现在该函数被调用，我在控制台上`on_finish()`打印它是 1。`self.done`
4.  在同一个`on_finish()`函数中，我做了一个`IF` `self.done = 1`语句，正如预期的那样，它返回`TRUE`和 Tornado 的`io_loop.add_timeout`参数`time.time()+3`（以便它休眠 3 秒以确保用户导航到网站内的另一个页面或完全离开网站）和回调最终将被调用。
5.  3 秒后，我想检查是否`self.done`仍然等于 1，或者用户是否仍在网站上，那么它肯定是 0。

顺便说一句，服务器每 30 秒完成一次连接，然后向用户发送通知以启动新连接，以便连接永远不会自行超时。当客户端关闭浏览器并且 30 秒长超时到期时，服务器会尝试发送通知，如果客户端仍在我的网站上，那么它将启动一个新连接，从而调用`post()`我上面提到的 UpdateHandler 类中的函数，从而设置变量`self.done`回到 0。（这就是为什么我给了`io_loop.add_timeout`3 秒的余量。）

现在已经解决了，我想继续尝试看看它是如何工作的。我启动服务器并打开浏览器导航到正确的 url 并观察服务器如何响应（通过`print`在脚本中放置一些语句）。当用户保持连接时，我可以看到在 post() 调用（当时显示`self.done = 0`）之后它会休眠 3 秒，然后调用回调函数，但是这个打印出来`self.done = 1`很奇怪。

我知道这不是最有效的方法，但它是我能想出的唯一解决方案，它甚至没有按预期工作。

结论：

我希望有人有一个很好的选择，或者甚至是我的理论中我错过的一点，这会破坏整个事情。我真的很想知道如何让 Tornado 知道客户端关闭浏览器而不等待 30 秒超时完成。也许通过ping开放连接或其他方式。我看了`TORNADIO`一点，但不太喜欢它。如果可能的话，我想在纯 Tornado 中做到这一点。

我会尽快提交代码，我已经尝试了半个小时来查看“如何格式化”等，但是当我尝试提交我的编辑时，它给出了一个错误。

*   您的帖子似乎包含未正确格式化为代码的代码。请使用代码工具栏按钮或 CTRL+K 键盘快捷键将所有代码缩进 4 个空格。如需更多编辑帮助，请单击 [?] 工具栏图标。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-09-23T01:20:43.730

我已经有这个问题 5 - 6 天了，终于发现了问题所在，嗯.. 不完全是，但它已经解决了！我一直在互联网上搜索，但一无所获。我在上面的帖子中说过，我记得几个月前我尝试相同的脚本时它确实有效，但`nginx`当时我从未提到过使用。我一直在使用 Apache + mod_proxy 苦苦挣扎，但我不知道问题出在哪里，`apache`但是当我`nginx`再次尝试时，它就成功了！

如果你有同样的问题（on_connection_close 没有被解雇） "TRY" `nginx`。也感谢您的帮助@Nikolay。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2016-09-21T16:57:26.577

有处理选项卡/浏览器关闭事件的`on_close()`方法。`tornado.websocket.WebSocketHandler`这是一个例子：

```
from tornado.websocket import WebSocketHandler

class MyWebsocketHandler(WebSocketHandler):
    ...

    def on_close(self):
        self.application.database.abort() 
```

和[参考](http://www.tornadoweb.org/en/stable/websocket.html?highlight=WebSocketHandler#tornado.websocket.WebSocketHandler.on_close)页。

# forms - Spring表单解码撇号不正确

> ID：12467214
> 
> 赞同：2
> 
> 时间：2012-09-17T21:15:46.360
> 
> 标签：forms, spring, spring-mvc, encoding, character-encoding

我有一个用户通常复制并粘贴到的表单。当副本和过去有撇号时，它们都会变成问号。比如有人刚刚复制粘贴了这篇文章的标题：

[http://brooklynheightsblog.com/archives/47796](http://brooklynheightsblog.com/archives/47796)

当用户以常规形式进行复制和粘贴时，会发生此问题。但是，我也有通过 JSON 提交的 ajax，当以这种方式完成时，撇号可以从相同的精确复制和粘贴中获得。此方法使用 Jackson json 消息转换器。

此外，我检查了编码的表单数据，看起来还不错：

```
Atlantic+Avenue%E2%80%99s+Sahadi%E2%80%99s+Preps+For+Wall-To-Wall+%28To+Wall%29+Expansion 
```

我尝试使用在线解码器，文本解码得很好。

任何人都知道会导致这种情况的表单提交发生了什么？

谢谢！

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-09-21T01:17:36.560

这是因为被复制的撇号不是标准的 ascii 撇号。这是一个特殊的符号，像 word 这样的程序用来使撇号看起来更好看。您需要将这些符号转换为普通符号。可以在浏览器或服务器上执行此操作。

这可能是您的解决方案：[Converting MS word quotes and apostrophes](https://stackoverflow.com/questions/2826191/converting-ms-word-quotes-and-apostrophes)

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-09-21T01:16:17.927

您需要在 web.xml 中包含一个过滤器

```
<filter>
    <filter-name>characterEncodingFilter</filter-name>
    <filter-class>org.springframework.web.filter.CharacterEncodingFilter</filter-class>
    <init-param>
        <param-name>encoding</param-name>
        <param-value>UTF-8</param-value>
    </init-param>
    <init-param>
        <param-name>forceEncoding</param-name>
        <param-value>true</param-value>
    </init-param>
</filter> 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-09-21T12:27:38.423

您是否尝试过使用这些属性？

```
<form method="post" enctype="application/x-www-form-urlencoded" accept-charset="UTF-8" ... /> 
```

# android - 如何缩短拒绝连接的时间？

> ID：12467215
> 
> 赞同：1
> 
> 时间：2012-09-17T21:15:49.857
> 
> 标签：android, apache-httpclient-4.x

有时我的服务器不工作，HttpClient 在连接被拒绝之前尝试连接大约 180 秒。有什么办法可以缩短这个时间吗？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-09-17T22:30:44.813

这应该适用于android：

```
int socketTimeoutMS = 120000;
new DefaultHttpClient().getParams().setIntParameter("SO_TIMEOUT", socketTimeoutMS); 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-09-17T21:25:45.077

尝试设置超时值？

整数 timeoutMs = new Integer(5 * 1000); messageSender.getHttpClient().getParams().setSoTimeout(timeoutMs);

# cakephp - CakePHP ACL。一动作多权限

> ID：12467216
> 
> 赞同：0
> 
> 时间：2012-09-17T21:15:51.900
> 
> 标签：cakephp, authentication, acl

我是 CakePHP 新手，但熟悉其他 PHP 框架。我正在尝试找出实现以下 ACL 设置的“蛋糕方式”。

我目前已将 ACL 配置为[Simple Acl 教程](http://book.cakephp.org/2.0/en/tutorials-and-examples/simple-acl-controlled-application/simple-acl-controlled-application.html)。当我想将组限制为特定操作时，这非常有用。

但是，如果我有一个操作，例如编辑，并且我希望根据您要编辑的用户是哪个组来限制编辑操作。

组“用户”中的用户将被拒绝访问编辑操作。
如果他们正在编辑的用户在组“用户”中，则将允许组“版主”中的用户进行编辑。
如果他们正在编辑的用户在组“用户”或“版主”中，则将允许组“管理员”中的用户进行编辑。

我很难理解我的用户和组表与 aco 和 aro 不同的事实，以及我应该如何建立这种关系，这样它就不会在未来让我绊倒。

我开始尝试创建一个路由索引函数，让你跳到不同的最终操作；edit_user、edit_mod、edit_admin 然后我可以使用 ACL 锁定它们，但我不确定是否有更好的方法来组织它。

非常感谢，
皮特

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-09-17T21:33:56.353

你可以像这样建立你的权限：

阿罗：

*   用户
    *   版主
        *   行政
    *   其他类型的成员 1
    *   其他类型的成员 2

亚科：

*   用户控制器
    *   编辑动作
        *   编辑用户
            *   编辑版主
                *   编辑管理员
            *   编辑一些其他类型的成员 1
            *   编辑其他类型的成员 2

然后你可以说：

1.  版主*有权*编辑用户：版主和管理员都可以编辑任何类型的成员
2.  版主*无权*编辑版主：版主和管理员都不能编辑版主
3.  管理员*有权*编辑版主：管理员可以编辑版主和管理员
4.  等等

# coding-style - 迭代的变更列表

> ID：12467219
> 
> 赞同：0
> 
> 时间：2012-09-17T21:16:06.720
> 
> 标签：coding-style

我听说在迭代中更改您正在迭代的列表并不是一种好的风格。

示例（伪代码）：

```
for (int i = 0; i < someList.length(); i++) {
  someList.getAt(i).doSomething();
} 
```

这是为什么？会不会有什么副作用？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-09-17T21:20:09.807

复印一份。改变它，围绕原来的迭代。

否则迭代器将不知道所做的更改。更多在这里：

[迭代时修改列表](https://stackoverflow.com/questions/1637807/modifying-list-while-iterating)

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-09-17T21:20:54.593

像这样的东西会更好。

```
for_each(E item in somelist)
{
     item.doSomeThing();
} 
```

E/Item 可以是任何东西（客户、整数、双打）

# wordpress - 让 Drupal 用户进入 WordPress

> ID：12467220
> 
> 赞同：0
> 
> 时间：2012-09-17T21:16:08.607
> 
> 标签：wordpress, drupal, content-management-system

我有一个 Drupal 站点，其中有一个 WordPress 站点。

我想知道如何在 WordPress 站点中获取 drupal 站点的用户信息？

事实上，如果您是 www.mydrupalsite.com 的用户，我如何将用户信息传递给 www.mydrupalinfo.com/wordpress。?

感谢您的回答！

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-09-18T09:14:17.247

You need to fill the wordpress table users (**wp_users** if you´re using the standard wordpress prefix) with the data of the "**users**" table of your Drupal database. Just make sure you **don't delete** the admin users of your wordpress site. You can try this WordPress plugin though: [http://wordpress.org/extend/plugins/external-database-authentication/](http://wordpress.org/extend/plugins/external-database-authentication/) which can help you use an external database (drupal DB) for authentication on WordPress

# java - JAVA：排序数组列表 > 在多个列上

> ID：12467226
> 
> 赞同：0
> 
> 时间：2012-09-17T21:16:21.837
> 
> 标签：java, sorting, matrix, arraylist, multiple-columns

首先，我在发帖之前确实做了功课搜索。与那里发布的问题相比，我的要求似乎略有不同。

我有一个`ArrayList<ArrayList<Integer>>`如下形式的矩阵

```
| id1 | id2 | score |
|-----|-----|-------|
| 1   | 3   | 95%   |
| 1   | 2   | 100%  |
| 1   | 4   | 85%   |
| 1   | 5   | 95%   |
| 2   | 10  | 80%   |
| 2   | 15  | 99%   | 
```

我想按列对矩阵进行排序（首先使用分数，然后使用 id1）。我已经以排序方式获得了 id1。这意味着我还需要首先使用 score 对具有相同 id1 的所有记录进行排序，然后使用 id2 对所有记录进行排序。这样做的原因是在每个 id1 中创建 id2 的排名。上述示例的结果将是：

```
| q_id | d_id | rank | score |
|------|------|------|-------|
| 1    | 2    | 1    | 100%  |
| 1    | 3    | 2    | 95%   |
| 1    | 5    | 3    | 95%   |
| 1    | 4    | 4    | 85%   |
| 2    | 15   | 1    | 99%   |
| 2    | 10   | 2    | 80%   | 
```

如何使用一些内置的集合方法在 Java 中实现这一点？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-09-17T21:35:33.990

我不确定你所描述的实际上是一个矩阵。在我看来，它就像一组三胞胎。

考虑为矩阵的每个“行”创建一个包装类：

```
class Triplet implements Comparable<Triplet> {
    private int id1;
    private int id2;
    private int score;

    // getters / setters here

    @Override
    int compareTo(Triplet that) {
        // if I understood correctly, you want to sort by score, then id1, then id2.
        int result = this.score - that.getScore();
        if (result == 0) {
            result = this.id1 - that.getId1();
            if (result == 0) {
                result = this.id2 - that.getId2();
            }
        }

        return result;
    }
} 
```

然后将您的“矩阵”表示为`ArrayList<Triplet>`并像往常一样进行排序。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-09-17T21:24:18.680

创建一个包含每个 ArrayList 行的所有列/字段的对象。然后使用 Comparator 接口并使用 Collections.sort()。

您可以查看[http://docs.oracle.com/javase/7/docs/api/java/util/Collections.html#sort%28java.util.List,%20java.util.Comparator%29](http://docs.oracle.com/javase/7/docs/api/java/util/Collections.html#sort%28java.util.List,%20java.util.Comparator%29)

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-09-17T21:26:44.953

一个适当的 OO 解决方案是将其声明为

```
class Bucket {
    int val1;
    int val2;
    int percent;
}

List<Bucket> myList = ... 
```

并提供一个`Comparator`以您想要的方式排序元素

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2012-09-17T21:28:46.923

首先，您最好将数据保存在普通旧 Java 对象 (POJO) 中，而不是整数列表列表中。

从您的示例中，您的数据似乎具有三个元素：两个 id 和一个分数。POJO 可能是这样的：

```
public class Record() {
    private int id1;
    private int id2;
    private double score; // percent, so double from 0.0 to 1.0

    public Record(int id1, int id2, double score) {
        this.id1=id1;
        this.id2=id2;
        this.score=score;
    }
    // getters and setters
} 
```

然后，您只需拥有一个`List<Record>`.

根据我对您问题的了解，您想先按 id1 排序，然后按 id2 排序。那正确吗？这看起来需要[基数排序](http://en.wikipedia.org/wiki/Radix_sort)（链接是维基百科）。

伪代码将是这样的：

1.  循环遍历每条记录并将它们分类到“桶”中`id1`。每个“桶”可以是一个`List<Record>`，并且应该包含所有`Record`具有相同 id1 的对象，没有特定的顺序。
2.  循环遍历每个存储桶并按`id2`.
3.  将所有存储桶重新组合在一起，保持顺序。

您需要使用 和 之类的方法来更新对象`Record`，以便高效、干净地实现它。`public int compareId1(Record other)``public int compareId2(Record other)`

# c# - 从后台线程通过 id 访问 Ribbons

> ID：12467228
> 
> 赞同：1
> 
> 时间：2012-09-17T21:16:31.773
> 
> 标签：c#, windows, ms-word, ms-office, ribbon

我正在做一个配置一些库的 Word 2007 插件。因此，在未配置这些库之前，某些按钮仍处于禁用状态。

如何从配置这些库的后台线程访问任何功能区元素？

如何使用`Office API`，我可以使用元素 ID 作为参数访问元素？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-09-18T12:46:37.307

我们不能直接访问元素。所有更改都应使用回调完成。办公室存储在缓存中的值。如果其他线程更改了此值，则该线程应使用[InvalidateControl](http://msdn.microsoft.com/en-us/library/office/aa433553%28v=office.12%29.aspx)方法使元素缓存无效。

# python - 如何在表单上显示文本并使其成为指向 django 中某个 URL 的链接

> ID：12467239
> 
> 赞同：0
> 
> 时间：2012-09-17T21:17:38.663
> 
> 标签：python, django, forms

目前我正在使用 django 并使用 Forms。我只需要显示一些没有来自表单而不是模板的任何字段的动态文本。例如。就像在 html 中一样，它可以通过

一些文字

，但是我们如何从 django 表单中编写此文本，因为它是动态的，我不能立即将其放在模板上。

这可能是一个非常愚蠢的问题，但作为一个新手，我真的很挣扎。谢谢

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-09-17T21:21:16.310

您可以访问模板中的变量

```
{{variable}} 
```

有关详细信息，请参阅[https://docs.djangoproject.com/en/dev/ref/templates/api/#basics上的文档](https://docs.djangoproject.com/en/dev/ref/templates/api/#basics)

# javascript - 确定 JavaScript e.keyCode 是否为可打印（非控制）字符

> ID：12467240
> 
> 赞同：65
> 
> 时间：2012-09-17T21:17:41.383
> 
> 标签：javascript, keycode

我只想知道`keyCode`对应于可输入字符的 JavaScript 范围；或者，不可键入（控制）字符的范围，如退格、转义、命令、移位等，所以我可以忽略它们。

我问的原因是调用`String.fromCharCode()`导致控制键出现奇怪的字符。例如，我得到左命令的“[”，左箭头的“％”。这样的怪事。

* * *

## 回答 #1

> 赞同：96
> 
> 时间：2012-09-17T21:50:45.770

Keydown 将为您提供按下的键的 keyCode，无需任何修改。

```
$("#keypresser").keydown(function(e){
    var keycode = e.keyCode;

    var valid = 
        (keycode > 47 && keycode < 58)   || // number keys
        keycode == 32 || keycode == 13   || // spacebar & return key(s) (if you want to allow carriage returns)
        (keycode > 64 && keycode < 91)   || // letter keys
        (keycode > 95 && keycode < 112)  || // numpad keys
        (keycode > 185 && keycode < 193) || // ;=,-./` (in order)
        (keycode > 218 && keycode < 223);   // [\]' (in order)

    return valid;
}); 
```

只有数字键、字母键和空格键具有相关的键码，`String.fromCharCode`因为它使用 Unicode 值。

Keypress 将是输入文本的 charCode 表示。请注意，如果由于按键而没有“打印”任何文本，则不会触发此事件。

```
$("#keypresser").keypress(function(e){
    var charcode = e.charCode;
    var char = String.fromCharCode(charcode);
    console.log(char);
}); 
```

[http://jsfiddle.net/LZs2D/1/](http://jsfiddle.net/LZs2D/1/)将演示这些是如何工作的。

KeyUp 的行为类似于 KeyDown。

* * *

## 回答 #2

> 赞同：21
> 
> 时间：2018-04-02T13:39:40.460

仅作为背景，每当您按下字符键时，“keypress”事件都会为您提供一个*charCode*属性。

```
Editor.addEventListener('keypress', function(event){
    if (event.charCode) {
        //// character key
        console.log( String.fromCharCode(event.charCode) ); /// convert charCode to intended character.
    } else {
        //// control key
    } 
```

然而，“keypress”事件并没有捕捉到每一次击键——在“keypress”事件之前会触发几个键。

相反，“keydown”事件将捕获每个击键，但它没有*charCode*属性。那么我们如何判断它是否是字符键呢？检查每个击键是否*keyCode*在多个范围的上下限内并不是最有效的。我怀疑 ASCII 范围之外的字符也存在问题。

我的方法是检查事件“key”属性的长度。“key”属性是“keyCode”的替代方法，用于确定按下了哪个键。对于**控制**键，“key”属性是**描述性**的（例如“rightArrow”、“F12”、“return”等）。对于**字符**键，字符键的“key”属性就是**字符**（例如“a”、“A”、“~”、“\”等）。因此，对于每个字符键，“键”属性的长度将为 1；而控制字符的长度将大于 1。

```
Editor.addEventListener('keydown', function(event){
    if (event.key.length == 1){ 
        //// character key
    } else {
        //// control key
    }
}) 
```

* * *

## 回答 #3

> 赞同：18
> 
> 时间：2019-11-01T11:59:22.040

我注意到所有长度为 1 的字符（'A'、'B'、数字、符号）都是可打印的，所以我只使用。我也将此解决方案用于非英语字符：

```
if(e.key.length==1)
    print(); 
```

* * *

## 回答 #4

> 赞同：4
> 
> 时间：2012-09-17T21:21:11.330

`keyCodes`这篇文章有一个列表`Javascript`：

[http://www.cambiaresearch.com/articles/15/javascript-char-codes-key-codes](http://www.cambiaresearch.com/articles/15/javascript-char-codes-key-codes)

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2019-08-07T23:34:24.793

您也可以为此使用 RegEx：

```
$(".input").keyup(function (event) {
    if (event.key.match(/^[\d\w]$/i)) {
      // put function to trigger when a digit or a word character is pressed here
    } 
```

该`i`标志使表达式不区分大小写。

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2021-12-18T07:52:24.780

截至 2021 年，一个简单的方法是通过[`InputEvent`](https://developer.mozilla.org/en-US/docs/Web/API/InputEvent)'s.

这仅适用于`<input>`、`<select>`和`<textarea>`，这应该是大多数情况：

```
function handleInput(event) {
  if (event.inputType === 'insertText' || event.inputType === 'insertCompositionText') {
    console.log('Input Detected', event.data)
  }
}

element.oninput = handleInput
// or
element.addEventListener('input', handleInput) 
```

该`insertCompositionText`属性允许我们检测一些[预先组合的字符](https://en.wikipedia.org/wiki/Precomposed_character)。

`<input>`对于,`<select>`和以外的标签`<textarea>`，我们可以使用带有Tim Perry 提到的修复的`keydown`event with ：`event.key.length`

```
function handleKeydown(event) {
  if([...event.key].length === 1 && !event.ctrlKey && !event.metaKey) {
    console.log('Key Detected', event.key)
  }
}
element.onkeydown = handleKeydown
// or
element.addEventListener('keydown', handleKeydown) 
```

尽管如此，我相信在识别一些预先组合的字符和其他怪癖时，两者都会遇到困难。

# xml - REST 和链接：中间立场？

> ID：12467241
> 
> 赞同：1
> 
> 时间：2012-09-17T21:17:42.040
> 
> 标签：xml, rest, standards

我一直想知道 REST 中的链接能走多远。考虑有作者的书籍，但书籍和作者之间显然存在多对多的关系（一本书可以由多个作者写，作者可以写多本书）。

因此，假设我们有一个 rest 调用`http://server/book/21`，它将返回一本书 XML，其中包含有关作者的信息。现在，既然书是一种资源，而作者是一种资源，那么 XML 不应该直接包含所有作者信息。它应该包含指向作者信息的链接。但是下面两个例子中哪一个更被广泛接受？

（请原谅我糟糕的格式化 XML，我对手写 XML 的经验并不丰富）

```
<book>
  <title>Some Book</title>
  <authors>
    <author link="http://server/author/82">Some Guy</author>
    <author link="http://server/author/51">Some Other Guy</author>
  </authors>
</book> 
```

然后，作者链接将返回更多信息：

```
<author>
  <name>Some Guy</name>
  <dateOfBirth>some time</dateOfBirth>
</author> 
```

或者：

```
<book>
  <title>Some Book</title>
  <authors>http://server/book/21/authors</authors>
</book> 
```

哪里`http://server/book/21/authors`返回：

```
<authors>
  <author link="http://server/author/82">Some Guy</author>
  <author link="http://server/author/51">Some Other Guy</author>
</authors> 
```

然后每个都再次返回前一个`<author>`示例。

我问的原因基本上是因为在我的工作中他们采用了第二种方法，在我看来，客户必须采取更多步骤才能到达他们想去的地方。此外，对于“您总是需要”（作者姓名）的基本信息，您必须采取额外的步骤。另一方面，这种方式`book`资源只返回关于这本书的信息（没有其他信息），而要获取其他信息，您必须访问其他资源。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-09-17T21:26:00.697

这个问题听起来更像是“你的偏好是什么”类型的问题。所以这是我的 2 美分：

在我看来，在原始 xml 中包含作者姓名将是最好的主意。这将允许客户端应用程序显示可热链接的作者姓名列表，而无需第二次休息请求。当图书资源出现时，作者姓名很可能总是显示。如果我是你，我会更关注实用性，而不是担心其余资源的“理论”正确性。如果那有意义的话。

您不必在原始 xml 资源中包含所有作者的信息。而是显示图书资源以及在需要时/如果需要时查找有关作者的更多信息的实用方法。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-09-17T21:26:47.930

只要一直做下去......

两者都可能看起来不错，但我实际上把钱放在了第二种方法上，这种方法更灵活，可以以一致的方式支持未来的 API 增长。这是因为您可能拥有多个不同对象与主对象的关系。用大量指向不同对象的链接来获取单个对象可能会很痛苦。此外，它将返回的对象的大小限制为仅返回核心“书籍”信息，而不是与其相关的其他各种对象，即使它们看起来不可分割。为每个资源选择最小的有用组件，至少减少后端不必要的负载以及未真正使用的关系。

当然，在这个例子中，很难看出限制对象中的关系信息的重要性，因为大多数书籍最多只有几个作者，但对于您通过 REST 公开的所有对象，情况是否如此？想象一下，如果这是一家“书店”，而关系是“客户”。如果您只想要商店地址和电话号码，您还需要拉回完整的客户列表并使其成为对象的一部分，这对各方来说不是很浪费吗？因此，您为这个新案例破例，不将客户作为链接返回，但对于商店部门之类的另一件事，您决定将它们作为链接包含在内？现在你有一个不一致的，你的客户需要了解每个对象的返回方式，因为它们都不符合相同的模式。

如果在整个 API 中普遍采用相同的方法，那么第二个方法也可以保持关系模型的整洁。任何对象的关系都可以通过以下方式访问：

```
 http://server/object/<object_id>/<relationshipName> 
```

# xml - 基于 XML 元素值的 XSLT 分组

> ID：12467246
> 
> 赞同：1
> 
> 时间：2012-09-17T21:18:18.420
> 
> 标签：xml, xslt, xpath, saxon

我的输入 XML 文件看起来像

```
<test-message>
      <segment id="MSH"/>
      <segment id="SFT"/>
      <segment id="PID"/>
      <segment id="NTE"/>
      <segment id="NK1"/>
      <segment id="PV1"/>
      <segment id="ORC"/>
      <segment id="OBR"/>
      <segment id="NTE"/>
      <segment id="OBX"/>
      <segment id="NTE"/>
      <segment id="SPM"/>
   </test-message> 
```

在我上面的输入 XML 文件元素**段**中，**id="ORC"**是可选的

我想根据 id="ORC" 的元素段或 id="OBR" 的元素段**对**我**的****输入****XML**文件进行分组

 ********对于上面的输入 XML 文件，当存在 id="ORC" 的元素段**时，我希望得到以下结果

 **```
<message-group>
    <test-message>
          <segment id="MSH"/>
          <segment id="SFT"/>
          <segment id="PID"/>
          <segment id="NTE"/>
          <segment id="NK1"/>
          <segment id="PV1"/>
</test-message>
<test-message>
          <segment id="ORC"/>
          <segment id="OBR"/>
          <segment id="NTE"/>
          <segment id="OBX"/>
          <segment id="NTE"/>
          <segment id="SPM"/>
       </test-message>
</message-group> 
```

**对于上面的输入 XML 文件，当不存在 id="ORC" 的**元素段时，我希望得到以下结果

 **```
<message-group>
    <test-message>
          <segment id="MSH"/>
          <segment id="SFT"/>
          <segment id="PID"/>
          <segment id="NTE"/>
          <segment id="NK1"/>
          <segment id="PV1"/>
</test-message>
<test-message>
          <segment id="OBR"/>
          <segment id="NTE"/>
          <segment id="OBX"/>
          <segment id="NTE"/>
          <segment id="SPM"/>
       </test-message>
</message-group> 
```

我可以使用 XSLT (2.0) 模板或函数来处理上述情况吗

注意：我正在使用 XSLT 2.0 和 saxon 解析器

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-09-18T04:23:15.200

**这种转变**：

```
<xsl:stylesheet version="2.0" xmlns:xsl="http://www.w3.org/1999/XSL/Transform">
 <xsl:output omit-xml-declaration="yes" indent="yes"/>

 <xsl:template match="/*">
  <message-group>
   <xsl:for-each-group select="*" group-starting-with=
   "segment[@id='ORC'][not(preceding-sibling::segment[1][@id='OBR'])]
  | segment[@id='OBR'][not(preceding-sibling::segment[1][@id='ORC'])]

   ">

      <test-message><xsl:sequence select="current-group()"/></test-message>
   </xsl:for-each-group>
  </message-group>
 </xsl:template>
</xsl:stylesheet> 
```

**应用于提供的 XML 文档时：**

```
<test-message>
      <segment id="MSH"/>
      <segment id="SFT"/>
      <segment id="PID"/>
      <segment id="NTE"/>
      <segment id="NK1"/>
      <segment id="PV1"/>
      <segment id="ORC"/>
      <segment id="OBR"/>
      <segment id="NTE"/>
      <segment id="OBX"/>
      <segment id="NTE"/>
      <segment id="SPM"/>
</test-message> 
```

**产生想要的正确结果：**

```
<message-group>
   <test-message>
      <segment id="MSH"/>
      <segment id="SFT"/>
      <segment id="PID"/>
      <segment id="NTE"/>
      <segment id="NK1"/>
      <segment id="PV1"/>
   </test-message>
   <test-message>
      <segment id="ORC"/>
      <segment id="OBR"/>
      <segment id="NTE"/>
      <segment id="OBX"/>
      <segment id="NTE"/>
      <segment id="SPM"/>
   </test-message>
</message-group> 
```

**当在此 XML 文档上应用相同的转换（如上）时（“ORC”不存在）：**

```
<test-message>
      <segment id="MSH"/>
      <segment id="SFT"/>
      <segment id="PID"/>
      <segment id="NTE"/>
      <segment id="NK1"/>
      <segment id="PV1"/>
      <segment id="OBR"/>
      <segment id="NTE"/>
      <segment id="OBX"/>
      <segment id="NTE"/>
      <segment id="SPM"/>
</test-message> 
```

**再次产生所需的正确结果**：

```
<message-group>
   <test-message>
      <segment id="MSH"/>
      <segment id="SFT"/>
      <segment id="PID"/>
      <segment id="NTE"/>
      <segment id="NK1"/>
      <segment id="PV1"/>
   </test-message>
   <test-message>
      <segment id="OBR"/>
      <segment id="NTE"/>
      <segment id="OBX"/>
      <segment id="NTE"/>
      <segment id="SPM"/>
   </test-message>
</message-group> 
```

当在此 XML 文档上应用相同的转换时（“OBR”不存在）：

```
<test-message>
      <segment id="MSH"/>
      <segment id="SFT"/>
      <segment id="PID"/>
      <segment id="NTE"/>
      <segment id="NK1"/>
      <segment id="PV1"/>
      <segment id="ORC"/>
      <segment id="NTE"/>
      <segment id="OBX"/>
      <segment id="NTE"/>
      <segment id="SPM"/>
</test-message> 
```

**再次产生所需的正确结果**：

```
<message-group>
   <test-message>
      <segment id="MSH"/>
      <segment id="SFT"/>
      <segment id="PID"/>
      <segment id="NTE"/>
      <segment id="NK1"/>
      <segment id="PV1"/>
   </test-message>
   <test-message>
      <segment id="ORC"/>
      <segment id="NTE"/>
      <segment id="OBX"/>
      <segment id="NTE"/>
      <segment id="SPM"/>
   </test-message>
</message-group> 
```

**最后，当 'ORC' 和 'OBR' 都存在时，但 'OBR' 在 'ORC' 之前**：

```
<test-message>
      <segment id="MSH"/>
      <segment id="SFT"/>
      <segment id="PID"/>
      <segment id="NTE"/>
      <segment id="NK1"/>
      <segment id="PV1"/>
      <segment id="OBR"/>
      <segment id="ORC"/>
      <segment id="NTE"/>
      <segment id="OBX"/>
      <segment id="NTE"/>
      <segment id="SPM"/>
</test-message> 
```

**再次产生正确的、想要的结果**：

```
<message-group>
   <test-message>
      <segment id="MSH"/>
      <segment id="SFT"/>
      <segment id="PID"/>
      <segment id="NTE"/>
      <segment id="NK1"/>
      <segment id="PV1"/>
   </test-message>
   <test-message>
      <segment id="OBR"/>
      <segment id="ORC"/>
      <segment id="NTE"/>
      <segment id="OBX"/>
      <segment id="NTE"/>
      <segment id="SPM"/>
   </test-message>
</message-group> 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-09-17T22:59:21.217

有两种相当简单的方法很快就会浮现在脑海中。

(1) 在您的模板中`test-message`，包括两个`test-message`输出元素，每个元素都包含一条`apply-templates`指令。给`apply-templates`一个参数来区分第一次和第二次调用。

说，类似（未测试）：

```
<xsl:template match="test-message">
  <test-message>
    <xsl:apply-templates>
      <xsl:with-param name="flag" select="1"/>
    </xsl:apply-templates>
  </test-message>
  <test-message>
    <xsl:apply-templates>
      <xsl:with-param name="flag" select="2"/>
    </xsl:apply-templates>
  </test-message>
</xsl:template> 
```

在 for 的模板中`segment`，如果 (a) $flag = 1 并且此段和任何前面的兄弟段的 id 都不是`OBR`or `ORC`，或者如果 (b) $flag = 2 并且此段或一些，则写出元素的副本前面的兄弟段有这样一个`id`. 就像是

```
<xsl:template match="segment">
  <xsl:param name="flag"/>
  <xsl:if test="(
                  $flag = 1 
                  and not(@id = ('ORC', 'OBR'))
                  and not(preceding-sibling::segment
                         [@id=('ORC','OBR')])
                ) or (
                  $flag = 2 
                  and ((@id = ('ORC', 'OBR'))
                       or preceding-sibling::segment
                         [@id=('ORC','OBR')]
                )">
    <xsl:copy-of select="."/>
 </xsl:if> 
```

(2)`test-message`如上制作模板，但添加`select="./segment[1]"`到对`xsl:apply-templates`.

然后使模板`segment`完成其工作，然后在其紧随其后的兄弟上重复出现。为了保持逻辑简单，我们区分几种情况：首先，`$flag=1`我们还没有看到 OBR 或 ORC：复制当前元素并继续。

```
<xsl:template match="segment">
  <xsl:param name="flag"/>
  <xsl:choose>
    <xsl:when test="$flag=1 and not(@id=('OBR', 'ORC'))">
      <xsl:copy-of select="."/>
      <xsl:if test="not(@id=('OBR','ORC'))">
         <xsl:apply-templates select="following-sibling::*[1]">
            <xsl:with-param name="flag" select="$flag"/>
         </xsl:apply-templates>
      </xsl:if>
    </xsl:when> 
```

其次，`$flag = 1`我们现在遇到的是 OBR 或 ORC。不要复制当前元素，不要继续；第一个`test-message`元素现已完成。

```
 <xsl:when test="$flag=1 and @id=('OBR', 'ORC')">
      <!--* do nothing, stop recursion *-->
    </xsl:when> 
```

第三，`$flag = 2`我们还没有遇到过OBR或ORC。继续前进。

```
 <xsl:when test="$flag=2 and not(@id=('OBR', 'ORC'))">
      <!--* don't copy yet, keep looking for OBR/ORC *-->
      <xsl:apply-templates select="following-sibling::*[1]">
        <xsl:with-param name="flag" select="$flag"/>
      </xsl:apply-templates>
    </xsl:when> 
```

第四，`$flag = 2`我们现在遇到的是 OBR 或 ORC。复制当前元素并继续；将标志切换到第三个值，这意味着我们在第二个`test-message`元素中，我们看到了 OBR 或 ORC：

```
 <xsl:when test="$flag=2 and @id=('OBR', 'ORC')">
      <xsl:copy-of select="."/>
      <xsl:apply-templates select="following-sibling::*[1]">
        <xsl:with-param name="flag" select="3"/>
      </xsl:apply-templates>
    </xsl:when> 
```

最后，如果`$flag = 3`那时我们只是复制当前元素并继续。

```
 <xsl:when test="$flag=3">
      <xsl:copy-of select="."/>
      <xsl:apply-templates select="following-sibling::*[1]">
        <xsl:with-param name="flag" select="3"/>
      </xsl:apply-templates>
    </xsl:when>
  </xsl:choose>
</xsl:template> 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-09-18T08:11:57.800

如果您总是将序列分成两组，那么我想我会这样做：

```
<xsl:variable name="split" select="segment[@id=('ORC', 'OBR')][1]"/>
<test-message>
  <xsl:copy-of select="$split/preceding-sibling::*"/>  
</test-message>
<test-message>
  <xsl:copy-of select="$split, $split/following-sibling::*"/>  
</test-message> 
```**********

# c# - 如何在 MVC 3 中访问 Request.Form 集合中未验证的项目

> ID：12467249
> 
> 赞同：5
> 
> 时间：2012-09-17T21:18:22.273
> 
> 标签：c#, asp.net-mvc, asp.net-mvc-3, httpwebrequest

我正在使用带有 .NET 4.0 的 ASP.NET MVC 3。我有一个模型，其中一个属性要求允许 HTML 内容。我已将该`AllowHtml`属性放在我的模型属性上，该属性允许在该属性上使用 HTML。这本身就有效。

我还在我网站的其他部分使用[Uploadify flash 上传器。](http://www.uploadify.com/)由于闪存和会话的[问题，我正在使用一些类似于](http://www.uploadify.com/documentation/uploadify/using-sessions-with-uploadify/)[swfupload 示例](http://code.google.com/p/swfupload/source/browse/swfupload/trunk/samples/samples/asp.net/Global.cs.asax)中的代码的代码来允许我的文件上传访问会话数据。基本上我`Request.Form`直接在`Application_BeginRequest`处理程序中访问集合。

我遇到的问题是，当提出允许 HTML 的表单时，我会`HttpRequestValidationException`在处理程序中的代码`Application_BeginRequest`访问`Request.Forms[key]`集合时得到一个。

就像我一开始说的，我已经尝试过这个`AllowHtml`属性。我还尝试使用该`ValidateInput(false)`属性在操作和控制器级别禁用验证，但我相信我在请求生命周期中还为时过早，无法应用。无论如何，在`Request.Form`不禁用整个站点的请求验证的情况下，是否可以访问包含“潜在危险”数据的集合？

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2012-09-17T21:29:31.097

您问这样的问题：[在 ASP MVC 3 RC 和 .NET 4 中使用 Request.Unvalidated() 验证请求](https://stackoverflow.com/questions/4392186/validate-request-with-request-unvalidated-in-asp-mvc-3-rc-and-net-4)？

```
Request.Unvalidated().Params[""] 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2016-11-03T17:21:29.950

为了记录，这样做的另一种方法是创建一个未经验证的对象：

```
var unvalidatedRequest = System.Web.Helpers.Validation.Unvalidated(Request); 
```

然后你只需要访问`unvalidatedRequest`对象而不是重复点击`Unvalidated()`。

该[`Validation.Unvalidated`](https://msdn.microsoft.com/en-us/library/system.web.helpers.validation_methods(v=vs.111).aspx)方法有各种重载。

# xml - XML 和重音字符

> ID：12467252
> 
> 赞同：1
> 
> 时间：2012-09-17T21:18:48.310
> 
> 标签：xml, encoding, utf-8, xquery, non-ascii-characters

我正在从这个[网站](http://www.worldfootball.net/)提取数据。我确实为我的 xml 使用了 UTF-8，与网站的字符集相同，所以我真的不明白为什么数据编码不正确。

例如，从[这个页面](http://www.worldfootball.net/spieler_profil/astrit-ajdarevic/)我得到`Astrit AjdareviÄ&#135;`代替`Astrit Ajdarević`，而`Standard LiÃ¨ge`不是`Standard Liège`等等......

详情：**如何提取？**

好吧，我正在使用[WebHarvest](http://web-harvest.sourceforge.net/)在解析之前将 html 页面转换为有效的 xml。

因此，对于上面的示例，我使用`//div[2]/div[1]/div[2]/div[2]/div[2]/table/tbody/tr[1]/td[2]/text()`get`Astrit AjdareviÄ&#135;`和`//*[@id="site"]//div[contains(./div/h2, 'Spieler')]//tbody/tr[2]/td[position()=3]`to get `Standard LiÃ¨ge`...

我希望这能回答你的问题 ：）

* * *

**解决方案：**

```
<html-to-xml>
     <http url="${link}" charset="utf-8"/>
</html-to-xml> 
```

感谢 mactwixs <3

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-09-18T07:59:50.187

您可能需要在 Web-Harvest 配置文件中将 UTF-8 设置为默认值，否则它不会被设置为默认值。还要确保您拥有最新版本的 Web-Harvest (2.1)

请参阅以下内容：

[手动 - 配置](http://web-harvest.sourceforge.net/manual.php)

[手册 - HTTP 配置](http://web-harvest.sourceforge.net/manual.php#http)

[类似的支持请求](http://sourceforge.net/p/web-harvest/discussion/591299/thread/9a6328bb/)

[您的浏览器解析](http://webdesign.about.com/library/bl_htmlcodes.htm)的HTML还需要：

```
<meta http-equiv="content-type" content="text/html;charset=utf-8" /> 
```

如果这些都不起作用，我建议在 sourceforge 上提出支持请求。

# java - java泛型类强制转换

> ID：12467255
> 
> 赞同：3
> 
> 时间：2012-09-17T21:19:06.890
> 
> 标签：java, class, generics

您好，我有带有值的哈希图：

```
 private static final LinkedHashMap<Class<? extends Annotation> , Class<? extends AGenerator<?>>> annotationGeneratorMap = new LinkedHashMap<Class<? extends Annotation>, Class<? extends AGenerator<?>>>(); 
```

我的数字生成器看起来像：

```
public abstract class NumericGenerator<T extends Number> extends AGenerator<T>{

public NumericGenerator(Field field) {
    super(field);
    // TODO Auto-generated constructor stub
}

public T random() {
    // TODO Auto-generated method stub
    return null;
}

  } 
```

当我需要将此类放入 hashmap 时，我遇到了问题：

```
annotationGeneratorMap.put(GenerateNumeric.class, NumericGenerator.class); 
```

**而在eclipse中我有错误该方法不适用于参数???**

但 ：

```
 annotationGeneratorMap.put(GenerateNumeric.class, (Class<? extends AGenerator<?>>) NumericGenerator.class); 
```

并且@SuppressWarnings("unchecked") 很好..:/

我可以在不铸造的情况下做到这一点吗？`(Class<? extends AGenerator<?>>) NumericGenerator.class`

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-09-17T21:40:05.457

`Class<? extends AGenerator>`改为使用

```
LinkedHashMap<
    Class<? extends Annotation>, 
    Class<? extends AGenerator> > annotationGeneratorMap = new LinkedHashMap<>() 
```

在 Java 中，类可以表示原始类型，但不能表示泛型类型。

有类`List`，但没有类`List<String>`。

所以你可以声明`Class<? extends List>`，它与`ArrayList.class`等兼容，因为原始类型`ArrayList`是`List`.

但`Class<? extends List<?>>`没有多大意义，因为没有类是`List<?>`.

多亏了擦除。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-09-17T22:11:21.807

以下在版本上编译没有错误`1.7.0_02`：

```
import java.util.*;
import java.lang.annotation.*;

interface AGenerator<T> {}

interface A extends Annotation {}
class X implements AGenerator<X> {}

class E7 {
    private static final LinkedHashMap<Class<? extends Annotation>, 
        Class<? extends AGenerator<?>>> annotationGeneratorMap 
        = new LinkedHashMap<Class<? extends Annotation>, 
                            Class<? extends AGenerator<?>>>();

    void foo() {
        annotationGeneratorMap.put(A.class, X.class);
    }

} 
```

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-09-17T21:57:22.923

编译时间检查不允许您这样做，除非您当然将其转换。

有关泛型类型的信息在运行时丢失，而不是编译时丢失。

# ruby-on-rails - PostgreSQL rake db：迁移错误

> ID：12467258
> 
> 赞同：1
> 
> 时间：2012-09-17T21:19:38.433
> 
> 标签：ruby-on-rails, postgresql, rake

刚开始一个新的应用程序

```
rails <appname> new -d postgresql 
```

我最近安装了 Postgres，这是我第一次尝试将它与应用程序一起使用。我生成了一大堆模型，然后运行 ​​rake db:migrate 并得到以下错误：

```
rake aborted!
could not connect to server: Permission denied
Is the server running locally and accepting
connections on Unix domain socket "/var/pgsql_socket/.s.PGSQL.5432"? 
```

这是否意味着我错误地安装了 Postgres？知道我应该解决什么吗？或者问题是否与尝试一次迁移多个模型有关？对不起，如果这是一个愚蠢的问题。我是 Rails 和 postgres 的新手。

----- 我的数据库.YML -----

```
development:
  adapter: postgresql
  encoding: unicode
  database: <appname>_development
  pool: 5
  username: <appname>
  password:

  # Connect on a TCP socket. Omitted by default since the client uses a
  # domain socket that doesn't need configuration. Windows does not have
  # domain sockets, so uncomment these lines.
  #host: localhost
  #port: 5432

  # Schema search path. The server defaults to $user,public
  #schema_search_path: myapp,sharedapp,public

  # Minimum log levels, in increasing order:
  #   debug5, debug4, debug3, debug2, debug1,
  #   log, notice, warning, error, fatal, and panic
  # The server defaults to notice.
  #min_messages: warning

# Warning: The database defined as "test" will be erased and
# re-generated from your development database when you run "rake".
# Do not set this db to the same as development or production.
test:
  adapter: postgresql
  encoding: unicode
  database: <appname>_test
  pool: 5
  username: <appname>
  password:

production:
  adapter: postgresql
  encoding: unicode
  database: <appname>_production
  pool: 5
  username: <appname>
  password: 
```

--- 执行 initdb /usr/local/var/postgres -E utf8 ---

得到以下内容：

```
initdb /usr/local/var/postgres -E utf8
The files belonging to this database system will be owned by user "sashafklein".
This user must also own the server process.

The database cluster will be initialized with locale en_US.UTF-8.
The default text search configuration will be set to "english".

initdb: directory "/usr/local/var/postgres" exists but is not empty
If you want to create a new database system, either remove or empty
the directory "/usr/local/var/postgres" or run initdb
with an argument other than "/usr/local/var/postgres". 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-09-17T21:23:46.043

您是否创建了 config/database.yml？

这基本上保存了 Postgres 的连接信息

看起来像这样

```
development:
  adapter: postgresql
  encoding: unicode
  database: <appname>_development
  pool: 5
  username: <username>
  password: <password> 
```

# asp.net-mvc - 在 MVC 中的会话中存储项目的问题

> ID：12467259
> 
> 赞同：0
> 
> 时间：2012-09-17T21:19:39.603
> 
> 标签：asp.net-mvc

我有一个客户页面，用户可以在该页面上为客户输入多个位置。我正在使用 Telerik ajax 网格来显示位置，当添加新位置时，我将其添加到会话并返回到网格。最后，当用户提交时，将插入客户和所有使用 customerid 作为参考键的位置。当用户进入创建/编辑页面并成功提交或发生任何异常时，我正在清除会话。问题是当用户为一个用户添加位置然后打开另一个选项卡以创建另一个用户时，所有位置都会为前一个用户清除。由于会话，正在发生此问题。某些视图状态将是特定于页面的。但是对于 ajax 网格操作，viewdata/viewbag 不起作用。关于如何实现这一点的任何想法。提前致谢。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-09-17T21:36:57.280

将您当前处理的 customerID 存储在路由值中。

有一份客户名单。在列表中，每个具有表单的客户都有一个链接

```
/{controller}/{action}/{id}

/customer/edit/1 
```

Telerik Controls 在这里无法帮助您。从在视图中呈现客户的普通循环开始更容易。

# javascript - 使用javascript的按钮位置问题

> ID：12467265
> 
> 赞同：0
> 
> 时间：2012-09-17T21:20:25.813
> 
> 标签：javascript, jquery

我有以下两行代码。show1 和 show2 是我的 JSP 页面上的按钮，根据下面的代码定位。但是，按钮 show2 显示在按钮 show1 的下方。如何解决这个问题。

```
 document.getElementById('show1').style.marginTop="33%";

  document.getElementById('show2').style.marginTop="33%"; 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-09-17T21:23:41.127

确保您正在使用`position: absolute;`它们中的每一个。

```
document.getElementById('show1').style.position = 'absolute';
document.getElementById('show2').style.position = 'absolute'; 
```

# php - 如何使用 Doctrine 在 Symfony 1.4 中进行 postInsert？

> ID：12467272
> 
> 赞同：0
> 
> 时间：2012-09-17T21:21:05.263
> 
> 标签：php, symfony-1.4, doctrine-1.2

我有一个表（称为表 A）需要在创建表 A 记录时创建多个附加子记录。删除表 A 记录应该删除表 B 记录。

删除记录很容易使用`ON DELETE CASCADE`in `schema.yml`，但添加记录并不是那么简单。覆盖`Doctrine_Record::postInsert`不会这样做，因为表 A 记录还没有 ID。覆盖`Doctrine_Form`save 也不会这样做。

是`EventListener`要走的路还是数据库触发器？如果是前者，你有例子吗？如果是后者，可以以某种方式指定触发器`schema.yml`吗？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-09-17T22:32:25.293

你确定这`postInsert`不起作用吗？

我在我的一个项目中使用了这个片段（在里面`Table.class.php`）：

```
public function postInsert($event)
{
  $dispatcher = ProjectConfiguration::getActive()->getEventDispatcher();
  $dispatcher->notify(new sfEvent($this, 'item.new', array(
    'item' => $this
  )));
} 
```

我传播了一个关于新项目的活动。然后，我在我的配置中捕获了这个事件：

```
class frontendConfiguration extends sfApplicationConfiguration
{
  public function configure()
  {
    // [....]
    $this->dispatcher->connect('item.new', array('shareEvents', 'postToSocial')); 
```

在我的`shareEvents`课堂上，我可以毫无问题地访问项目 ID：

```
class shareEvents
{
  static public function postToSocial(sfEvent $event)
  {
    $item = $event['item'];

    $queue = new AutopostQueue();
    $queue->setItemId($item->getId());
    $queue->save(); 
```

顺便说一句，您也可以在触发器中执行操作。但我不认为你可以在内部定义触发器，`schema.yml`因为 Doctrine 解析它以生成模型、表单等。但是你可以`trigger.sql`在目录中定义一个文件`/data/sql`，它会在你调用时自动加载：

```
php symfony doctrine:insert-sql 
```

# apache-flex - 如何获取命名空间前缀？

> ID：12467273
> 
> 赞同：0
> 
> 时间：2012-09-17T21:21:07.730
> 
> 标签：apache-flex, flex4.5

有没有办法从类或类实例（不是 XML 的对象）中获取命名空间前缀？例如，在 MXML 中，您可以将某些内容声明为 s:Button 或 local:MyComponent。当给定对象时，是否有一些调用或方法会返回“s”或“local”值？

例如，如果我有 TextInput 类并且我想在运行时显示样式继承，我可以执行以下操作：

```
s|TextInput {

   fontFamily:Arial;
}

s|TextArea#myTextArea {

   color:red;

}

local|MyComponent.myBoldStyle {
   fontWeight: bold;

} 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-09-19T01:06:10.500

命名空间是编译时值。除非您将源代码加载为 XML 文档并将其作为 XML 处理，否则您将无法在运行时检索这些值

# python - 金字塔订户谓词不起作用

> ID：12467275
> 
> 赞同：3
> 
> 时间：2012-09-17T21:21:11.273
> 
> 标签：python, pyramid

我正在使用 Pyramid 1.4a1 并且我有这个订阅者谓词：

```
class RouteName(object):
    '''
    Subscriber predicate to check against route name.
    '''

    def __init__(self, value, config):
        self.value = value
        self.config = config

    def text(self):
        return 'route_name = %s' % self.value
    phash = text

    def __call__(self, event):
        route_name = event.request.matched_route.name
        return route_name == self.value 
```

我像这样添加它：

```
config.add_subscriber_predicate('route_name', RouteName) 
```

但是，每当我尝试使用它时，就像这样：

```
@subscriber(ContextFound, route_name='user.register')
def check_invitation(event):
    # Check invitation token before running registration view code ... 
```

我得到这个回溯：

```
Traceback (most recent call last):
  File "/Workspace/Personal/project/.env/bin/pserve", line 8, in <module>
    load_entry_point('pyramid==1.4a1', 'console_scripts', 'pserve')()
  File "/Workspace/Personal/project/.env/local/lib/python2.7/site-packages/pyramid/scripts/pserve.py", line 47, in main
    return command.run()
  File "/Workspace/Personal/project/.env/local/lib/python2.7/site-packages/pyramid/scripts/pserve.py", line 290, in run
    relative_to=base, global_conf=vars)
  File "/Workspace/Personal/project/.env/local/lib/python2.7/site-packages/pyramid/scripts/pserve.py", line 318, in loadapp
    return loadapp(app_spec, name=name, relative_to=relative_to, **kw)
  File "/Workspace/Personal/project/.env/local/lib/python2.7/site-packages/PasteDeploy-1.5.0-py2.7.egg/paste/deploy/loadwsgi.py", line 247, in loadapp
    return loadobj(APP, uri, name=name, **kw)
  File "/Workspace/Personal/project/.env/local/lib/python2.7/site-packages/PasteDeploy-1.5.0-py2.7.egg/paste/deploy/loadwsgi.py", line 272, in loadobj
    return context.create()
  File "/Workspace/Personal/project/.env/local/lib/python2.7/site-packages/PasteDeploy-1.5.0-py2.7.egg/paste/deploy/loadwsgi.py", line 710, in create
    return self.object_type.invoke(self)
  File "/Workspace/Personal/project/.env/local/lib/python2.7/site-packages/PasteDeploy-1.5.0-py2.7.egg/paste/deploy/loadwsgi.py", line 146, in invoke
    return fix_call(context.object, context.global_conf, **context.local_conf)
  File "/Workspace/Personal/project/.env/local/lib/python2.7/site-packages/PasteDeploy-1.5.0-py2.7.egg/paste/deploy/util.py", line 56, in fix_call
    val = callable(*args, **kw)
  File "/Workspace/Personal/project/project/__init__.py", line 49, in main
    return config.make_wsgi_app()
  File "/Workspace/Personal/project/.env/local/lib/python2.7/site-packages/pyramid/config/__init__.py", line 955, in make_wsgi_app
    self.commit()
  File "/Workspace/Personal/project/.env/local/lib/python2.7/site-packages/pyramid/config/__init__.py", line 629, in commit
    self.action_state.execute_actions(introspector=self.introspector)
  File "/Workspace/Personal/project/.env/local/lib/python2.7/site-packages/pyramid/config/__init__.py", line 1083, in execute_actions
    tb)
  File "/Workspace/Personal/project/.env/local/lib/python2.7/site-packages/pyramid/config/__init__.py", line 1075, in execute_actions
    callable(*args, **kw)
  File "/Workspace/Personal/project/.env/local/lib/python2.7/site-packages/pyramid/config/adapters.py", line 53, in register
    order, preds, phash = predlist.make(self, **predicates)
  File "/Workspace/Personal/project/.env/local/lib/python2.7/site-packages/pyramid/config/util.py", line 264, in make
    pred = predicate_factory(val, config)
pyramid.exceptions.ConfigurationExecutionError: <type 'exceptions.TypeError'>: object.__new__() takes no parameters
  in:
  Line 80 of file /Workspace/Personal/project/.env/local/lib/python2.7/site-packages/pyramid/events.py:
    config.add_subscriber(wrapped, iface, **self.predicates) 
```

我也有一个以相同方式注册的自定义视图谓词，它工作得很好，所以我不知道我在这里做错了什么。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-09-18T20:25:50.420

我认为您的代码中某处有错字。以下应用程序在 1.4a1 下工作。如果您访问/它打印检查。如果您访问 /another，它不会：

```
from wsgiref.simple_server import make_server
from pyramid.config import Configurator
from pyramid.events import subscriber, ContextFound
from pyramid.view import view_config

class RouteName(object):
    '''
    Subscriber predicate to check against route name.
    '''

    def __init__(self, value, config):
        self.value = value
        self.config = config

    def text(self):
        return 'route_name = %s' % self.value

    phash = text

    def __call__(self, event):
        route_name = getattr(event.request.matched_route, 'name', None)
        return route_name == self.value

@subscriber(ContextFound, route_name='home')
def check(event):
    print 'checked'

@view_config(renderer='string', route_name='home')
def home(request):
    return 'home'

@view_config(renderer='string', route_name='another')
def another(request):
    return 'another'

if __name__ == '__main__':
    config = Configurator()
    config.add_subscriber_predicate('route_name', RouteName)
    config.add_route('home', '/')
    config.add_route('another', '/another')
    config.scan()
    app = config.make_wsgi_app()
    server = make_server('0.0.0.0', 8080, app)
    server.serve_forever() 
```

# c++ - 专门针对几个可能的参数（类型名）的类

> ID：12467279
> 
> 赞同：2
> 
> 时间：2012-09-17T21:21:16.250
> 
> 标签：c++, templates, c++11

我有一个模板类，唯一的模板参数是 typename。

```
template<typename T>
class Reader{
    ...
} 
```

现在我想为每个整数类型专门化它，比如：

```
template<typename T - integral>
class Reader{
    //another code
} 
```

我怎样才能做到这一点？

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-09-17T21:23:46.230

您可以只使用一个额外的默认布尔参数：

```
template<typename T, bool IsIntegral = std::is_integral<T>::value>
class Reader{ // primary template, used for non-integrals
    ...
}

template<typename T>
class Reader<T, true> { // specialization for integral types
    ...
} 
```

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2012-09-17T23:54:14.743

在类似的情况下，我使用了针对所有特殊类型专门化类模板的蛮力方法。我意识到这些是相当多的，而且很快就会变得相当痛苦。然而，将有趣的成员分解到一个由所有专业共享的基类中工作得相当好。在我使用这种方法的情况下，我通常在类中只有静态成员，即构造函数未被继承的事实不是问题（C++ 2011 支持也继承构造函数的语法，但同时点是保持记谱法）：

```
template <typename T> class Reader { ... };

template <typename T> class IntReader { /* special version for integers */ };
// to bool or not bool?
template <> class Reader<wchar_t>: public IntReader<wchar_t> {};
template <> class Reader<char>: public IntReader<char> {};
template <> class Reader<char16_t>: public IntReader<char16_t> {};
template <> class Reader<char32_t>: public IntReader<char32_t> {};
template <> class Reader<signed char>: public IntReader<signed char> {};
template <> class Reader<signed short>: public IntReader<signed short> {};
template <> class Reader<signed int>: public IntReader<signed int> {};
template <> class Reader<signed long>: public IntReader<signed long> {};
template <> class Reader<signed long long>: public IntReader<signed long long> {};
template <> class Reader<unsigned char>: public IntReader<unsigned char> {};
template <> class Reader<unsigned short>: public IntReader<unsigned short> {};
template <> class Reader<unsigned int>: public IntReader<unsigned int> {};
template <> class Reader<unsigned long>: public IntReader<unsigned long> {};
template <> class Reader<unsigned long long>: public IntReader<unsigned long long> {}; 
```

诚然，我们的整数类型太多了！拥有**六种**不同的角色类型有点荒谬。

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2012-09-18T18:18:31.837

您可以使用虚拟`std::true_type`参数

```
template<typename T, typename = std::true_type>
class Reader {

};

template<typename T>
class Reader<T, std::integral_constant<bool, 
                  std::is_integral<T>::value> > {
  // ...
}; 
```

顺便说一句，您会看到这种模式与`void`而不是`true_type`一起使用，专业化经常使用`enable_if`和更复杂（以及涉及 SFINAE）的条件。

# python - 如何告诉 Python 在 pylab.show() 之后结束？

> ID：12467280
> 
> 赞同：1
> 
> 时间：2012-09-17T21:21:32.190
> 
> 标签：python, plot, matplotlib

我使用 Pylab 在 Python 中生成了一个绘图：

```
pylab.plot(x, y)
pylab.show() 
```

但是现在脚本在完成时似乎被阻止了。当我用`CTRL`+打破它时`C`，脚本结束，关闭绘图窗口。如何告诉 Python 不要阻塞？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-09-17T22:13:18.913

如果需要，您应该使用`plt.ion()`（打开交互模式）和更高版本`plt.draw()`。plt 是 matplotlib.pyplot （我认为通过 pylab 也可以看到。*）

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-09-17T21:51:56.857

您是否希望程序结束（不阻塞，将控制权返回给终端）并保持绘图窗口打开？

如果是这样，并且如果使用 unix，您可以分叉一个子进程，并使用[os.setsid](http://docs.python.org/library/os.html#os.setsid)与子进程作为会话负责人进行新会话：

```
import matplotlib.pyplot as plt
import numpy as np
import os

pi = np.pi
arctan = np.arctan

if os.fork():
    # Parent
    pass
else:
    # Child
    os.setsid()
    x = np.linspace(-10,10,100)
    plt.plot(x,arctan(x))
    plt.show() 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-09-17T22:29:58.680

我同意 sega_sai 的回答。但是，（至少我所看到的是）有时在显示情节之后，它会进入“无响应”模式，无论如何你只需要终止该过程。最好的选择（如果您已经安装了 IPython）是使用“--pylab”选项（“ipython --pylab”）启动 IPython。[请注意，我的经验是在 Windows 7 机器上。]

# django - 为表单集中的字段创建动态标签

> ID：12467282
> 
> 赞同：0
> 
> 时间：2012-09-17T21:21:49.943
> 
> 标签：django, django-forms, formsets

我有一个表格如下

```
class InstructorCourseCertificationForm(forms.Form):
    Course = forms.BooleanField()
    SubjectExpert = forms.BooleanField(label='Subject Expert') 
```

我需要创建一个表单集，并根据我拥有的课程列表动态设置课程字段的标签。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-09-17T22:57:02.273

根据我需要动态字段的经验，我通常最终将数据存储在数据库中，然后根据数据库中的数据，生成动态表单。换句话说，我不创建后来自定义的基于类，而是使用 python 的函数`forms.Form`从头开始创建一个类。`type`

我认为这在一个例子中可能会更清楚。假设您有一个模型`Course`，其中包含一个`name`字段：

```
class Course(models.Model):
    name = models.CharField(max_length=64) 
```

因此，您可以通过向模型添加方法从头开始创建表单：

```
class Course(models.Model):
    ...
    def certificate_form_class(self):

        # assuming the name can only have spaces
        # if not, then more normalizing has to be done
        form_name = self.name.title().replace(' ', '')

        bases = (forms.Form,)

        fields = {
            'Course': forms.BooleanField(label=self.name),
            'SubjectExpert': forms.BooleanField(label='Subject Expert')
        }

        form_class = type(form_name, bases, fields)

        return form_class 
```

然后您可以按如下方式使用它：

```
course = Course.objects.get(...)
certificate_form_class = course.certificate_form_class()
certificate_form = certificate_form_class()
# use it as a regular form 
```

有人可能会争辩说，此时您正在混合表单和模型，在这种情况下，您可以在其中创建一个辅助函数，`forms.py`该函数将获取`Course`模型的一个实例，然后从中创建一个证书表单。但无论哪种方式，这个想法都是相同的。

一个警告是，此时，您不能保证这些字段会按顺序排列。在这种情况下，您应该使用`OrderedDict`from`collections`而不是`dict`( `{}`) 来定义字段。

不确定这种方法的效果如何，`FormSets`但也许它可以给你一些想法。

# mysql - 显示多于一行的键的所有行

> ID：12467288
> 
> 赞同：0
> 
> 时间：2012-09-17T21:22:27.140
> 
> 标签：mysql, join, in-subquery

```
Table kal
id integer primary key
init char 4 indexed
job char4

id  init job
--+----+------
1 | aa | job1
2 | aa | job2
3 | bb | job1
4 | cc | job3   
5 | cc | job5 
```

我想显示 init 超过一行的所有行：

```
id  init job
--+----+------
1 | aa | job1
2 | aa | job2
4 | cc | job3   
5 | cc | job5 
```

我试过了：

```
select * from kal where init in (select init from kal group by init having 
count(init)>2); 
```

实际上，该表有 60000 行，查询是

```
count(init)<40, 
```

但这需要大量时间，phpmyadmin 和我的耐心都用完了。

两个都

```
select init from kal group by init having count(init)>2) 
```

和

```
select * from kal where init in ('aa','bb','cc') 
```

“无时间”运行，不到 0.02 秒。

我尝试了不同的子查询，但都需要“无限”时间，超过几分钟；我实际上从来没有让他们完成。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-09-17T21:31:02.963

你试过了`EXISTS`吗？

```
select *
from yourtable t1
where exists (select count(*)
              from yourtable t2
              where t1.init = t2.init
              group by t2.init
              having count(*) >= 2); 
```

# 见[SQL Fiddle with Demo](http://sqlfiddle.com/#!2/3d1fb/9)

甚至这样：

```
select *
from yourtable t1
left join
(
  select count(*) cnt, init
  from yourtable
  group by init
) t2
  on t1.init = t2.init
where t2.cnt > 1 
```

# 见[SQL Fiddle with Demo](http://sqlfiddle.com/#!2/3d1fb/12)

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-09-17T21:28:34.147

这是一个示例，您可以[看到它](http://sqlfiddle.com/#!2/4ac49/1)的实际效果：

**询问**

```
SELECT a.id, a.init, a.job
FROM kal a
INNER JOIN
  (SELECT init, COUNT(init) 
  FROM kal
  GROUP BY init
  HAVING COUNT(init) > 1) b ON b.init = a.init 
```

**结果**

```
| 身份证 | 初始化 | 工作 |
--------------------
| 1 | 啊 | 工作1 |
| 2 | 啊 | 工作2 |
| 4 | 抄送| 工作3 |
| 5 | 抄送| 工作5 |
```

# macos - 首次在 OS X Lion Server 上设置开放目录主机：LDAP 问题

> ID：12467290
> 
> 赞同：0
> 
> 时间：2012-09-17T21:22:33.533
> 
> 标签：macos, directory, ldap

我们有一个作为开放目录主机运行的服务器。到目前为止，一切都很好：用户可以通过 VPN 或客户端计算机上的网络帐户访问他们的数据。但是，LDAP 日志始终报告错误。我附上了下面的日志：

```
Sep 12 13:01:54 server slapd[61]: conn=6890 op=27: attribute "entryCSN" index add failure
Sep 12 13:01:56 server slapd[61]: Entry (uid=untitled_1,cn=users,dc=server,dc=speirhunter,dc=private): object class 'posixAccount' requires attribute 'homeDirectory'
Sep 12 13:01:56 server slapd[61]: entry failed schema check: object class 'posixAccount' requires attribute 'homeDirectory'
Sep 12 13:04:55 server slapd[61]: => bdb_idl_delete_key: c_get failed: DB_LOCK_DEADLOCK: Locker killed to resolve a deadlock (-30994)
Sep 12 13:04:55 server slapd[61]: conn=6916 op=23: attribute "entryCSN" index delete failure
Sep 12 13:04:56 server slapd[61]: Entry (uid=untitled_1,cn=users,dc=server,dc=speirhunter,dc=private): object class 'posixAccount' requires attribute 'homeDirectory'
Sep 12 13:04:56 server slapd[61]: entry failed schema check: object class 'posixAccount' requires attribute 'homeDirectory'
Sep 12 13:12:43 server slapd[61]: => nestedgroup_getgroup result (16)
Sep 12 13:41:11 server slapd[61]: => bdb_idl_delete_key: c_get failed: DB_LOCK_DEADLOCK: Locker killed to resolve a deadlock (-30994)
Sep 12 13:41:11 server slapd[61]: conn=7113 op=15: attribute "entryCSN" index delete failure
Sep 12 13:41:12 server slapd[61]: Entry (uid=untitled_1,cn=users,dc=server,dc=speirhunter,dc=private): object class 'posixAccount' requires attribute 'homeDirectory'
Sep 12 13:41:12 server slapd[61]: entry failed schema check: object class 'posixAccount' requires attribute 'homeDirectory'
Sep 12 14:17:48 server slapd[61]: => nestedgroup_getgroup result (16)
Sep 12 14:29:46 server slapd[61]: => nestedgroup_getgroup result (16)
Sep 12 14:30:55 server slapd[61]: => nestedgroup_getgroup result (16)
Sep 12 14:31:26: --- last message repeated 2 times ---
Sep 12 14:36:30 server slapd[61]: => nestedgroup_getgroup result (16)
Sep 12 14:38:56: --- last message repeated 2 times ---
Sep 12 14:39:37 server slapd[61]: => nestedgroup_getgroup result (16)
Sep 12 14:40:34: --- last message repeated 2 times ---
Sep 12 14:40:34 server slapd[61]: => nestedgroup_getgroup result (16)
Sep 12 14:43:21 server slapd[61]: => nestedgroup_getgroup result (16)
Sep 12 14:51:47 server slapd[61]: => nestedgroup_getgroup result (16)
Sep 12 14:54:35: --- last message repeated 2 times ---
Sep 12 14:54:35 server slapd[61]: connection_read(22): no connection!
Sep 12 15:35:49 server slapd[61]: => nestedgroup_getgroup result (16)
Sep 12 15:36:27: --- last message repeated 2 times ---
Sep 12 16:45:10 server slapd[62]: @(#) $OpenLDAP: slapd 2.4.23 (Feb 25 2012 19:47:01) $
                root@melodie.apple.com:/private/var/tmp/OpenLDAP/OpenLDAP-186.4~2/servers/slapd
Sep 12 16:45:10 server slapd[62]: daemon: SLAP_SOCK_INIT: dtblsize=8192
Sep 12 16:45:11 server slapd[62]: bdb_monitor_db_open: monitoring disabled; configure monitor database to enable
Sep 12 16:45:11 server slapd[62]: slapd starting
Sep 12 16:45:11 server slapd[62]: daemon: posting com.apple.slapd.startup notification
Sep 12 16:53:06 server slapd[62]: => bdb_idl_delete_key: c_get failed: DB_LOCK_DEADLOCK: Locker killed to resolve a deadlock (-30994)
Sep 12 16:53:06 server slapd[62]: conn=1216 op=19: attribute "entryCSN" index delete failure
Sep 12 16:53:07 server slapd[62]: Entry (uid=untitled_1,cn=users,dc=server,dc=speirhunter,dc=private): object class 'posixAccount' requires attribute 'homeDirectory'
Sep 12 16:53:07 server slapd[62]: entry failed schema check: object class 'posixAccount' requires attribute 'homeDirectory'
Sep 12 17:09:40 server slapd[62]: => bdb_idl_delete_key: c_get failed: DB_LOCK_DEADLOCK: Locker killed to resolve a deadlock (-30994)
Sep 12 17:09:40 server slapd[62]: conn=1366 op=19: attribute "entryCSN" index delete failure
Sep 12 17:09:41 server slapd[62]: Entry (uid=untitled_1,cn=users,dc=server,dc=speirhunter,dc=private): object class 'posixAccount' requires attribute 'homeDirectory'
Sep 12 17:09:41 server slapd[62]: entry failed schema check: object class 'posixAccount' requires attribute 'homeDirectory'
Sep 12 17:11:25 server slapd[62]: Entry (uid=sadmin,cn=users,dc=server,dc=speirhunter,dc=private): object class 'posixAccount' requires attribute 'homeDirectory'
Sep 12 17:11:25 server slapd[62]: entry failed schema check: object class 'posixAccount' requires attribute 'homeDirectory'
Sep 12 17:19:53 server slapd[62]: => bdb_idl_delete_key: c_get failed: DB_LOCK_DEADLOCK: Locker killed to resolve a deadlock (-30994)
Sep 12 17:19:53 server slapd[62]: conn=1420 op=788: attribute "entryCSN" index delete failure
Sep 12 17:19:54 server slapd[62]: Entry (uid=untitled_1,cn=users,dc=server,dc=speirhunter,dc=private): object class 'posixAccount' requires attribute 'homeDirectory'
Sep 12 17:19:54 server slapd[62]: entry failed schema check: object class 'posixAccount' requires attribute 'homeDirectory'
Sep 12 18:19:30 server slapd[62]: <= bdb_substring_candidates: (altSecurityIdentities) not indexed
Sep 12 18:21:21 server slapd[62]: => bdb_idl_delete_key: c_get failed: DB_LOCK_DEADLOCK: Locker killed to resolve a deadlock (-30994)
Sep 12 18:21:21 server slapd[62]: conn=2057 op=55: attribute "entryCSN" index delete failure
Sep 12 18:21:22 server slapd[62]: Entry (uid=untitled_1,cn=users,dc=server,dc=speirhunter,dc=private): object class 'posixAccount' requires attribute 'homeDirectory'
Sep 12 18:21:22 server slapd[62]: entry failed schema check: object class 'posixAccount' requires attribute 'homeDirectory'
Sep 12 18:25:09 server slapd[62]: => bdb_idl_delete_key: c_get failed: DB_LOCK_DEADLOCK: Locker killed to resolve a deadlock (-30994)
Sep 12 18:25:09 server slapd[62]: conn=2095 op=61: attribute "entryCSN" index delete failure
Sep 12 18:25:10 server slapd[62]: Entry (uid=untitled_1,cn=users,dc=server,dc=speirhunter,dc=private): object class 'posixAccount' requires attribute 'homeDirectory'
Sep 12 18:25:10 server slapd[62]: entry failed schema check: object class 'posixAccount' requires attribute 'homeDirectory' 
```

任何人都可以阐明这意味着什么，以及一些可能的原因吗？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-09-17T21:56:31.590

您发布了许多错误消息。首先，您可以尝试降低 slapd.conf 中的详细程度，如果您需要工作的所有内容都可以正常工作，我不在乎。其次，如果你真的需要解决这些问题，你需要检查每个问题——这里显示的一些问题与无效的索引配置有关，其中一些需要修复嵌套组概念的问题，还有一些与模式不匹配对象有关。你打开模式检查了吗？AFAIR 来自一些 slapd 版本，默认情况下它是打开的。你用什么版本？

使用 slaptest 实用程序测试您的数据库和/或配置文件的一致性，并使用 slapcat 转储数据库，在发生错误后第一次尝试恢复后，您可能已经意识到了这一点。您提出的一些错误可能会影响转储数据库，导致无法转储。也可以使用 slapindex 检查/重建索引。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-09-17T21:57:18.323

其中一个问题很容易发现：

```
Entry (uid=untitled_1,cn=users,dc=server,dc=speirhunter,dc=private): object class 'posixAccount' requires attribute 'homeDirectory'

entry failed schema check: object class 'posixAccount' requires attribute 'homeDirectory' 
```

您有一个不完整的类条目，`posixAccount`因为它没有指定`homeDirectory`属性。posix 帐户通常称为*user*。此类条目是打开目录等效于`/etc/passwd`. 但是该条目缺少主目录字段（属性，在 LDAP 用语中）。

因为它`untitled_1`可能是一些虚假的条目。您可能想要添加 homeDirectory 属性或完全删除该条目。您可能还想追查它是如何到达那里的以及它是如何以无效格式到达那里的（您有创建它的工具吗？那个 untitled_1 来自哪里？）

# git - Gitolite git clone 需要 ssh 密码

> ID：12467293
> 
> 赞同：4
> 
> 时间：2012-09-17T21:23:05.327
> 
> 标签：git, ssh, github, gitolite

在 Ubuntu 服务器上使用 Gitolite。有一个我正在处理的项目，我需要 git 命令的特定语法。

效果很好：

```
git clone gitolite@servername:testing.git 
```

要求输入密码

```
git clone ssh://gitolite@servername/home/gitolite/repositories/testing.git 
```

一个接一个地从同一个盒子里跑出来。我可以输入密码，它可以工作。但我需要自动工作。听起来像是 ssh pub/private 密钥的问题。有任何想法吗？

**更新**：文件权限有问题。不确定too命令之间的区别。但是`/var/log/auth.log`显示了一些错误

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-09-17T21:28:40.900

您需要使用类似的行设置 ~gitolite/.ssh/authorized_keys

```
command="/home/gitolite/bin/gl-auth-command <USERNAME>",no-port-forwarding,no-X11-forwarding,no-agent-forwarding,no-pty ssh-rsa AAAA...KEY.HERE...ZZZZ== user@label 
```

包含与此相关信息的随机 URL（请参阅页面底部）

[http://www.geekgumbo.com/2011/10/18/ssh-and-the-gitolite-installation-part-2/](http://www.geekgumbo.com/2011/10/18/ssh-and-the-gitolite-installation-part-2/)

确保根据 SSH 要求更改 ~gitolite/.ssh/authorized_keys 的所有权：

```
chown gitolite: ~gitolite/.ssh/authorized_keys
chmod go-w ~gitolite/.ssh/authorized_keys 
```

编辑：反映您将“git”更改为“gitolite”系统用户名的编辑。

使用以下命令测试您从客户端的访问：

```
ssh -l gitolite -i <file_id_rsa_foobar> -v -o PasswordAuthentication=no -T <host> 
```

在我的本地系统上添加 -T 似乎需要获取横幅（输入借口错误）：

```
....
debug1: Authentications that can continue: publickey
debug1: Next authentication method: publickey
debug1: Offering RSA public key: /home/username/.ssh/id_rsa_foobar
debug1: Authentications that can continue: publickey
debug1: Next authentication method: publickey
debug1: Offering DSA public key: /home/username/.ssh/id_dsa_foobar
debug1: Remote: Forced command: /home/gitolite/bin/gl-auth/command <username>
....
hello <username> this is gitolite vX.X.XX-g0123abcd running on git X.X.X
the gitolite config gives you the following access:
    R   W    mydir/project1
.... 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-09-17T21:31:11.430

如果第一个版本有效，则意味着公钥已在名为 ' `gitolite`':的帐户下发布`~gitolite/.ssh/authorized_keys`。

您遇到的权限问题在此处描述：“[为 Gerrit 和 Hudson 创建 SSH 密钥](https://stackoverflow.com/questions/3712443/creating-ssh-keys-for-gerrit-and-hudson/3712619#3712619)”：请注意， .ssh 的*所有*父目录不应具有组或其他的写权限：`/home`, `/home/yourUser`, `/home/yourUser/.ssh`。

另外，您永远不应该使用 repo 的完整路径克隆 gitolite repo：`servername/home/gitolite/repositories/testing.git`是错误的（并且会完全绕过 gitolite）。
`servername:testing.git`是正确的。

来自[gitolite V2 文档](http://sitaramc.github.com/gitolite/g2/sts.html#ssh_troubleshooting_common_ssh_problems_)：

> 以下问题表明您的 pubkey 正在绕过 gitolite 并直接进入 shell
> 
> 运行`git clone git@server:repositories/reponame`（注意`repositories/`URL 中的存在）有效。
> 
> [正确的 gitolite 密钥只会让你 git clone `git@server:reponame`(注意没有`repositories/`)]

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-10-16T09:12:49.203

还有一件事要尝试：如果 AllowGroups 正在用于服务器上的 sshd，请检查 git-user 是否包含在其中一个组中。

# c# - C# 创建具有自定义属性的基本表单

> ID：12467295
> 
> 赞同：2
> 
> 时间：2012-09-17T21:23:15.920
> 
> 标签：c#, winforms, base, inheritance

我遇到了一个小问题，即定义的自定义属性值没有保留在继承的形式中。

我的基本形式的代码是：

```
namespace ContractManagement.Forms
{
    public partial class BaseForm : Form
    {
        public BaseForm()
        {
            InitializeComponent();
        }

        public Boolean DialogForm
        {
            get
            {
                return TitleLabel.Visible;
            }
            set
            {
                TitleLabel.Visible = value;
                CommandPanel.Visible = value;
            }
        }

        protected override void OnTextChanged(EventArgs e)
        {
            base.OnTextChanged(e);
            TitleLabel.Text = Text;
        }
    }
} 
```

然后以继承这个的形式，我有：

```
namespace ContractManagement.Forms
{
    public partial class MainForm : Forms.BaseForm
    {
        public MainForm()
        {
            InitializeComponent();
        }
    }
} 
```

出于某种原因，尽管我在 MainForm 中为 DialogForm 设置了什么，但在运行时它会恢复为 True。

这个网站上有另一个帖子提到了这一点，但我不明白它解释了什么。

我还想创建一个允许我隐藏 ControlBox 的属性，那么如何添加它呢？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-09-17T22:21:12.290

我相信我现在已经做到了：

```
namespace ContractManagement.Forms
    {
        public partial class BaseForm : Form
        {
            private Boolean DialogStyle;
            private Boolean NoControlButtons;

            public BaseForm()
            {
                InitializeComponent();
                TitleLabel.Visible = DialogStyle = true;
                ControlBox = NoControlButtons = true;
            }

            public Boolean DialogForm
            {
                get
                {
                    return DialogStyle;
                }
                set
                {
                    DialogStyle = TitleLabel.Visible = value;
                    DialogStyle = CommandPanel.Visible = value;
                }
            }

            public Boolean ControlButtons
            {
                get
                {
                    return NoControlButtons;
                }
                set
                {
                    NoControlButtons = ControlBox = value;
                }
            }

            protected override void OnTextChanged(EventArgs e)
            {
                base.OnTextChanged(e);
                TitleLabel.Text = Text;
            }
        }
    } 
```

# php - 一个简单的 php 可更新节点

> ID：12467298
> 
> 赞同：1
> 
> 时间：2012-09-17T21:23:40.350
> 
> 标签：php, javascript, mysql

尽我所能解释它..我有一个带有简单 div 的 html 页面，例如“新闻”部分。被 divwrap 等包围。我见过几个具有完整 mysql/php 和用户登录功能的站点，论坛。问题是社区有一个管理控制面板，您可以在其中重新定位节点、添加节点或创建一个页面上的新文章从旧的帖子..等..全部与mysql的强大功能集成在1中。我知道使用用户登录等简单社区功能的教程。我想创建一个简单的过程，业余用户可以从中登录网站并简单地添加文章，非常类似于博客。目前正在寻找建议，我可以搜索 ..maybe 教程或 JavaScript 替代品？或者也许是用于在网上搜索 tuts 的正确搜索语法？

# python - 当我将 Python Flask Web 应用程序提交到 Heroku 时，为什么会得到这么多文件？

> ID：12467304
> 
> 赞同：0
> 
> 时间：2012-09-17T21:24:00.877
> 
> 标签：python, git, heroku, flask

我正在关注 Heroku 上的 Python/Flask 教程：[https ://devcenter.heroku.com/articles/python](https://devcenter.heroku.com/articles/python)

这些是我采取的步骤：

```
heroku login
mkdir MyFlaskApp
python virtualenv.py MyFlaskApp --distribute
source MyFlaskApp/bin/activate
cd MyFlaskApp
pip install Flask
pip freeze > requirements.txt
foreman start
git init
git add .
git commit -m "First commit"
heroku create MyFlaskApp
git push heroku master 
```

但是，当我执行 git add & commit 时，我得到了很多文件。在教程中，`git push heroku master`报告`Counting objects: 10`，但我得到`Counting objects: 425`.

可能是什么问题呢？

我看到的唯一区别是教程没有提到导航到应用程序的文件夹（例如`cd MyFlaskApp`）。

**更新：**`MyFlaskApp`这是我在完成上述步骤后在文件夹中的文件夹结构：

```
bin/
include/
lib/
Procfile
app.py
requirements.txt
.gitignore 
```

**更新 2：**我的`.gitignore`文件（如教程中所示）：

```
venv
*.pyc 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-09-17T22:02:28.943

您实际上是在本地目录中创建 virtualenv。你要么想在 venv 目录中创建它，要么将以下三个项目中的每一个添加到你的 .gitignore 中：

```
bin
include
lib 
```

# asp.net - 在哪里存储用户登录信息？

> ID：12467310
> 
> 赞同：-1
> 
> 时间：2012-09-17T21:24:32.317
> 
> 标签：asp.net

我写了一个示例并在我的主机上进行了测试（它是共享的）。并在我的网络配置中放置一个 machineKey。我创建存储数据的树类型：

```
 protected void Page_Load(object sender, EventArgs e)
    {
        if (!Page.IsPostBack)
        {   
            Session["x"] = "A";
            HttpContext.Current.Application.Add("y", "B");
            Application["z"] = "C";
        }
    } 
```

并将按钮放在我的表单上并在其事件中写入：

```
 protected void Button1_Click(object sender, EventArgs e)
       {
          try
          {
             Label1.Text = Session["x"].ToString();
         }
         catch (Exception err)
         {
             Label1.Text = err.Message;
         }

        try
        {
              Label2.Text = HttpContext.Current.Application["y"].ToString();
        }
        catch (Exception err)
        {
            Label2.Text = err.Message;

        }

        try
        {
            Label3.Text =  Application["z"].ToString();
        }
        catch (Exception err)
        {
            Label3.Text = err.Message;
        }

    } 
```

当 iis 随时回收并丢弃任何缓存/内存内容时，我丢失了所有类型的所有数据。所有返回的对象引用未设置为对象的实例。

用户来想登录，现在我如何以及在哪里可以存储正确用户的 id 或用户名，直到 iis 回收我有我的数据并且可以实现用户已登录？cookie 是否可以很好地存储这些数据，例如用户的用户名和密码？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-09-17T21:31:03.177

您需要考虑使用更持久的位置来存储该信息，例如 SQL Server。[这篇 Microsoft 文章](http://support.microsoft.com/kb/317604)介绍了如何配置您的站点以使用 SQL Server 存储会话状态。

还有很多其他博客文章解释了如何做到这一点，所以你不会摸不着头脑:)

编辑：好的，查看[可用的会话状态模式](http://msdn.microsoft.com/en-us/library/ms178586%28v=vs.100%29.aspx)，您可能需要查看`StateServer`模式，因为它确实支持在网络场环境中运行的 ASP.NET 站点。

作为参考，[本文](http://support.microsoft.com/kb/325056)介绍了如何在 Web 场中使用 SQL Server 会话状态。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-09-17T21:45:53.590

如果您可以将文件存储在服务器上，您可以尝试使用基于文件的会员系统提供程序

[http://madskristensen.net/post/XML-membership-provider-for-ASPNET-20.aspx](http://madskristensen.net/post/XML-membership-provider-for-ASPNET-20.aspx)

# c# - Xml 解析错误：十六进制值是无效字符

> ID：12467312
> 
> 赞同：1
> 
> 时间：2012-09-17T21:24:54.313
> 
> 标签：c#, xml, xml-parsing, httpwebrequest, xmldocument

我尝试使用以下代码获取 xml 文件：

```
HttpWebRequest webReq = (HttpWebRequest)WebRequest.Create(url);
HttpWebResponse response = (HttpWebResponse)webReq.GetResponse();
string xml = string.Empty;
using (StreamReader sr = new StreamReader(response.GetResponseStream()))
{
    xml = sr.ReadToEnd();
}

XmlDocument xmlDoc = new XmlDocument();
//xml = xml.Replace((char)(0x1F), ' ');
xmlDoc.LoadXml(xml); 
```

但我得到如下异常：

```
' ', hexadecimal value 0x1F, is an invalid character. Line 1, position 1. 
```

因此，根据stackoverflow上的许多类似问题，我尝试添加此注释行，但随后出现异常：

```
Data at the root level is invalid. Line 1, position 2. 
```

怎么了？

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-09-17T21:54:02.143

假设应用于 XML 的压缩是 GZip，您可以像这样解压缩 XML：

```
HttpWebRequest webReq = (HttpWebRequest)WebRequest.Create(url);
HttpWebResponse response = (HttpWebResponse)webReq.GetResponse();
string xml = string.Empty;
using (GZipStream gzip = new GZipStream(response.GetResponseStream(), CompressionMode.Decompress))
using (StreamReader sr = new StreamReader(gzip))
{
  xml = sr.ReadToEnd();
}

XmlDocument xmlDoc = new XmlDocument();
//xml = xml.Replace((char)(0x1F), ' ');
xmlDoc.LoadXml(xml); 
```

如果 GZipStream 无法解压缩 XML，则必须将其替换为适当的解压缩流。

# django - django 1.3 模板标签 url 意外结果

> ID：12467313
> 
> 赞同：0
> 
> 时间：2012-09-17T21:25:01.520
> 
> 标签：django, templates, url, templatetag

模板：

```
 <!-- Images slide as a row starts -->
            <!-- power.views.IMAGE_SLIDES_ROW returns image_slider_row/   -->
            {% url power.views.IMAGE_SLIDES_ROW %} 
            <!-- Images as a row Ends --> 
```

网址配置：

```
 url(r'^image_slider_row/', views.images_slider_row_func, name='image_slider_row'), 
```

看法 ：

```
def images_slider_row(request):
    print "Debug-1"
    return render_to_response('images_slider_row.html', {}) 
```

实际上我期待**“images_slider_row_func”**会在 url 标签执行时被调用，但它没有发生，它在浏览器中显示以下字符串

> **/images_slider_row/**

我错过了什么还是我误解了这个概念？请帮我解决这个问题。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-09-17T21:31:24.543

基本上，该`url`方法采用与访问的 URL 匹配的正则表达式的参数、要调用的函数（在本例中为 images_slider_row_func）以及关键字 arg`name`可用于在调用网址“宏”。

但是，django 在访问 URL“/images_slider_row/”时应该尝试访问函数“images_slider_row_func”（注意这里的区别！）

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-09-18T03:19:54.443

用于`<a href="{% url image_slider_row %}">foo bar</a>`您的示例，模板`url`标签期望`name`您的参数`urls.py`

# iphone - 增加 UITabBarItem 文本的字体大小

> ID：12467316
> 
> 赞同：0
> 
> 时间：2012-09-17T21:25:13.373
> 
> 标签：iphone, ios, cocoa-touch, uitabbarcontroller, uitabbaritem

我有一个 UITabBarController，里面有 4 个标签栏项目。我没有任何图像可以放在那里。如果可能的话，我希望文本看起来更大并跨越两行以补偿图像。现在看起来有点奇怪。

任何线索如何实现这一目标。

# php - Jquery 插件 Combogrid 不起作用

> ID：12467318
> 
> 赞同：1
> 
> 时间：2012-09-17T21:25:26.590
> 
> 标签：php, javascript, jquery

我的网站上有一个搜索框，可以在其中按姓名、电子邮件、城市、州或国家/地区搜索注册用户。我尝试使用 Jquery 的 Combogrid 插件在该搜索框上实现自动建议功能：http: [//combogrid.justmybit.com/](http://combogrid.justmybit.com/)。我已经非常努力地让它正常工作，但无论如何它似乎永远不会工作。

我有一个 php 文件“server.php”，它以 JSON 格式发送数据，该插件使用它来呈现包含表格形式数据的自动建议网格。我从 Server.php 文件中复制了 JSON 输出并将其放入文本文件中。当我将资源文件的 URL 设置为此文本文件时，该插件工作正常，但当我将其设置为该 PHP 文件时无法工作。我知道我遗漏了一些东西，需要你的帮助来修补它。

**这是我的 Combogrid 的配置**

```
<script>
jQuery(document).ready(function(){
$('#switcher').themeswitcher({
    loadTheme:"Smoothness"
});
    $( "#project" ).combogrid({
    url: 'http://localhost/combogrid-1.6.2/server.php',

sord: "asc",    
debug:true,
sidx: "id",
rememberDrag: true,
rows: 10,
alternate: true,
replaceNull: true,
    colModel: [{'columnName':'name','width':'25','label':'Name'}, {'columnName':'country','width':'25','label':'Country'},{'columnName':'state','width':'25','label':'State'}, {'columnName':'city','width':'25','label':'City'}],
    select: function( event, ui ) {
        $( "#project" ).val( ui.item.name );

        document.location.href=ui.item.link;

        return false;
    }
}); 
```

});

**服务器.PHP**

```
<?php
$page = $_GET['page']; 
// get the requested page

$limit = $_GET['rows']; 
// get how many rows we want to have into the grid

$sidx = $_GET['sidx']; 
// get index row - i.e. user click to sort

$sord = $_GET['sord'];

$searchTerm = $_GET['searchTerm'];

// get thedirection

if(!$sidx) $sidx =1;

if ($searchTerm=="") {
$searchTerm="%"; 
} 
else 
{
$searchTerm = "%" . $searchTerm . "%";
}

$dbhost = "localhost";
$dbuser = "root";

$dbpassword = "";
$database = "userinfo";

// connect to the database

$db = mysql_connect($dbhost, $dbuser, $dbpassword) or die("Connection Error: " .   mysql_error());

mysql_select_db($database) or die("Error conecting to db.");

$result = mysql_query("SELECT COUNT(*) AS count FROM userdata WHERE first like '$searchTerm'");

$row = mysql_fetch_array($result,MYSQL_ASSOC);

$count = $row['count'];

if( $count >0 ) {

$total_pages = ceil($count/$limit);
}
else {
$total_pages = 0;
}

if ($page > $total_pages) 
$page=$total_pages;

$start = $limit*$page - $limit;
// do not put $limit*($page - 1)

if($total_pages!=0) $SQL = "SELECT * FROM userdata WHERE first like '$searchTerm'  ORDER BY $sidx $sord LIMIT $start , $limit";
else $SQL = "SELECT * FROM userdata WHERE first like '$searchTerm'  ORDER BY $sidx $sord";

$result = mysql_query( $SQL ) or die("Couldn t execute query.".mysql_error());

$response->page = $page;

$response->total = $total_pages;

$response->records = $count;

$i=0;

while($row = mysql_fetch_array($result,MYSQL_ASSOC)) 
{$response->rows[$i]['name']=$row['first'];

$response->rows[$i] ['cell']=array($row['first'],$row['country'],$row['state'],$row['city']);

$response->rows[$i]['name']=$row['first'];

$response->rows[$i]['country']=$row['country'];

$response->rows[$i]['state']=$row['state'];

$response->rows[$i]['city']=$row['city'];    
 $response->rows[$i]=array("name"=>$row["first"],"country"=>$row['country'],"state"=>$row['state'],"city"=>$row['city']);  $i++;
}        
  echo json_encode($response);

$myFile = "testFile.txt";
$fh = fopen($myFile, 'w') or die("can't open file");
//$stringData = "{$_GET['page']} {$_GET['rows']} {$_GET['sidx'] } {$_GET['sord']}   {$_GET['searchTerm']}";
$stringData =$SQL." ".json_encode($response);
fwrite($fh, $stringData);
?> 
```

# sql - 按数字分解 SQL 结果

> ID：12467322
> 
> 赞同：0
> 
> 时间：2012-09-17T21:25:42.863
> 
> 标签：sql, oracle, oracle11g

如何根据数量将以下列表转换为多行但按项目分组？

当前结果。

```
ITEM     QTY
-----    ----
12345     1
12346     2
12347     3 
```

这是想要的结果

```
ITEM     QTY
-----    ----
12345     1
12346     1
12346     1
12347     1
12347     1
12347     1 
```

这是查询

```
SELECT a.item,sum(b.qty) as qty

FROM table1 a, table2 b 
WHERE a.item_id = b.item_id 
group by a.item
order by a.item_id 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-09-17T21:57:04.907

您可以通过将 应用于`rownum`记录来做到这一点：

```
select t1.item, qty / qty as qty
from yourtable t1
left join
(
  select rownum rn, item
  from yourtable
) t2
  on t1.qty >= t2.rn
order by t1.item 
```

# 见[SQL Fiddle with Demo](http://sqlfiddle.com/#!4/53e00/32)

# css - CSS渐变跨浏览器

> ID：12467325
> 
> 赞同：0
> 
> 时间：2012-09-17T21:26:03.453
> 
> 标签：css, gradient

我从这个 URL 生成了这个 CSS：http: [//ie.microsoft.com/testdrive/graphics/cssgradientbackgroundmaker/default.html](http://ie.microsoft.com/testdrive/graphics/cssgradientbackgroundmaker/default.html)

```
/* IE10 Consumer Preview */ 
background-image: -ms-radial-gradient(center bottom, circle closest-corner, #FFFFFF 0%, #BCD2E3 100%);

/* Mozilla Firefox */ 
background-image: -moz-radial-gradient(center bottom, circle closest-corner, #FFFFFF 0%, #BCD2E3 100%);

/* Opera */ 
background-image: -o-radial-gradient(center bottom, circle closest-corner, #FFFFFF 0%, #BCD2E3 100%);

/* Webkit (Safari/Chrome 10) */ 
background-image: -webkit-gradient(radial, center bottom, 0, center bottom, 487, color-stop(0, #FFFFFF), color-stop(1, #BCD2E3));

/* Webkit (Chrome 11+) */ 
background-image: -webkit-radial-gradient(center bottom, circle closest-corner, #FFFFFF 0%, #BCD2E3 100%);

/* W3C Markup, IE10 Release Preview */ 
background-image: radial-gradient(circle closest-corner at center bottom, #FFFFFF 0%, #BCD2E3 100%); 
```

我怎样才能使它在旧浏览器中很好地降级并使用图像而不是渐变？

这是我当前的带有背景图像的 CSS，另外，我的图像当前是 1600X144，我希望渐变的中心相应地居中。：

```
.navbar .navbar-inner {
    -webkit-box-shadow: 0 1px 0 rgba(255, 255, 255, 0.4), 0 0 10px rgba(239, 24, 3, 0.1);
    -moz-box-shadow: 0 1px 0 rgba(255, 255, 255, 0.4), 0 0 10px rgba(239, 24, 3, 0.1);
    box-shadow: 0 1px 0 rgba(255, 255, 255, 0.4), 0 0 10px rgba(239, 24, 3, 0.1);
    background: url(../images/bgHeader2.png);
} 
```

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-09-17T21:29:49.977

对于旧浏览器，生成的代码已经降级：它们将使用`background-image: url(bgHeader2.png);`属性值并忽略渐变属性，因为它们无法解析它们（这就是属性的顺序很重要的原因）。

除了生成的代码非常冗长之外，我看不到任何错误。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-09-17T21:33:23.307

其他人提到您的示例应该可以正常工作和降级，所以我不会深入讨论。

至于您关于使渐变图像居中的旁注。控制背景图像位置的最简单方法是通过[`background-position`](https://developer.mozilla.org/en-US/docs/CSS/background-position)属性。

不知道你如何不定位你的背景，但一个疯狂的猜测是这样的：

```
background-position: center center; 
```

您也可以直接在后台属性中执行此操作：

```
background: url(../images/bgHeader2.png) center center; 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-09-17T21:30:42.970

你确定只使用`background: ....`而不是更好`background-image:`吗（我不知道这是否有帮助，但如果你检查[ColorZilla](http://www.colorzilla.com/gradient-editor/)，它会显示一个支持旧浏览器的示例。但是渐变应该在 IE6 中工作......

# sql-server - T-SQL DML：如何更改/添加现有 XML 节点的父节点？

> ID：12467326
> 
> 赞同：0
> 
> 时间：2012-09-17T21:26:06.590
> 
> 标签：sql-server, xml, tsql, xquery

我的数据库中有几个 XML 需要更新。这是它们的简单表示：

```
<root>
  <child1>blah</child1>
</root> 
```

我需要`<child1>`用另一个元素包装以获得这样的结构：

```
<root>
  <child1Root>
    <child1>blah</child1>
  </child1Root>
</root> 
```

看起来很简单，但我不是 T-SQL 和 DML 专家。

注意：如果有人想知道为什么要更新，答案是下面的 XML 不能使用 DataContractSerializer 反序列化。它可以使用 XmlSerializer 和 XmlArray 属性进行反序列化，但不能使用 DCS：

```
<root>
  <child1>blah</child1>
  <child2>blah</child2>
</root> 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-09-18T13:32:36.580

如果您的实际代码与您的示例一样简单，那么您可以这样做：

```
DECLARE @yourTable TABLE ( yourXML XML )

INSERT INTO @yourTable ( yourXML )
VALUES 
    ( '<root><child1>blah1</child1></root>' ),
    ( '<root><child1>blah2</child1></root>' )

UPDATE @yourTable
SET yourXML = yourXML.query('root/child1').query('<root><child1Root>{.}</child1Root></root>') 

SELECT * FROM @yourTable 
```

如果您的真实 XML 有点复杂，那么您可能需要将其分解。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-09-17T21:42:59.890

蛮力方法：

```
DECLARE @myDoc xml       
SET @myDoc = '
<root>       
    <child1>blah</child1>       
</root>'       
SELECT @myDoc       

DECLARE @child1 xml;
SET @child1 = @myDoc.query('/root/child1')
SELECT @child1

SET @myDoc.modify('       
insert <child1Root />
into (/root)[1]') 
SELECT @myDoc       

SET @myDoc.modify('       
insert sql:variable("@child1")
into (/root/child1Root)[1]') 
SELECT @myDoc       

SET @myDoc.modify('       
delete /root/child1') 
SELECT @myDoc 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-09-18T02:25:04.040

这是一个工作示例。鉴于有效的 XML 具有严格的规则，我想不出字符串操作不起作用的原因。至少，作为字符串搜索关键的“<”不应该存在于 XML 标记名称之外。

```
-- create a sample table variable with a few variations
declare @T table (sample xml)
insert @T select '
<root>
  <child1>blah</child1>
</root>'
insert @T select '
<root>
  <child1>blah1</child1>
  <child1>blah2</child1>
</root>'
insert @T select '
<root>
  <child1>
    blah1
    <child2>blah2</child2>
  </child1>
</root>'
insert @T select '
<root>
<child0>
  <child1>
    <child4>
      <child3>blah2</child3>
    </child4>
  </child1>
</child0>
</root>'

-- peek at the content
select * from @T

-- perform the replacements as many times as required
-- note that the string "stackoverflow123" is expected to NEVER
--    exist in your data, or use another string if it does!
while @@rowcount > 0
begin
    update T
    set sample = stuff(X.A, Y.B, Z.C - Y.B + 9, '<child1Root>'+
        replace(replace(
            SUBSTRING(X.A, Y.B, Z.C - Y.B + 9),
            '<child1>','<stackoverflow123>'),
            '</child1>','</stackoverflow123>')
                +'</child1Root>')
    from @T T
    cross apply (
        select convert(varchar(max),sample)) X(A)
    cross apply (
        select patindex('%<child1>%</child1>%', X.A)) Y(B)
    cross apply (
        select charindex('</child1>', X.A, Y.B+1)) Z(C)
    where Z.C > 0
end

-- finally revert the placeholder string back to "child1"
update @T
set sample = replace(convert(varchar(max),sample), 'stackoverflow123', 'child1')

-- inspect the finished product
select * from @T 
```

# javascript - 这是 Javascript（Tabify 和基本 JS）冲突吗？

> ID：12467328
> 
> 赞同：1
> 
> 时间：2012-09-17T21:26:17.150
> 
> 标签：javascript

出于某种原因，当我在下面运行我的其他脚本时，tabify [http://unwrongest.com/projects/tabify/](http://unwrongest.com/projects/tabify/)不起作用。如果我删除了对 tabify 实例的调用之上的所有内容，它工作正常。这对我来说似乎是基本的 js，不确定是什么导致 tabify 无法运行。

```
 <script type="text/javascript">
    $(document).ready(function () {
    var $temp = $('h1').html();
    var myLabel = document.getElementById("mySpan");
    myLabel.innerHTML = $temp;
    document.getElementById('myInput').value= $temp;
    $('#tabmenu').tabify();
    $('#tabmenu2').tabify();
    });

    </script> 
```

# css - 页脚不会粘在底部

> ID：12467330
> 
> 赞同：1
> 
> 时间：2012-09-17T21:26:37.743
> 
> 标签：css, footer

当没有足够的内容时，我的页脚不会粘在页面底部，例如，当有人搜索没有结果时，页脚会显示在屏幕中间而不是停留在底部页。

我已经阅读了所有其他帖子，但似乎代码与我的不同。

这是页脚 CSS 代码：

```
 .footer {
    padding: 10px 0;
     }

      #footercontainer {
    clear:both; 
    width:100%; 
    position:relative; 
    height:250px;
    bottom:0;

    }
#footer {
    clear:both; 
    padding-top:0px; 
    width:100%; 
    position:absolute; 
    bottom:0;
    left:0;
}

#footer img {
    border:none; 
    text-align:center;
}

#footermiddlecontent {
    width:973px;
     margin-left:auto; 
     margin-right:auto;

     }
#footermiddlecontent p {
    font-size:14px;

    }
#footermiddlecontent a {
    font-size:12px; 
    font-family:arial;

    }
#footerbottom p {
    text-align:center; 
    padding-top:5px; 
    font-size:12px; 
    font-family:arial;

    }
#footerbottom a {
    font-family:arial;

    } 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-09-23T17:07:26.330

看起来您需要使用[CSS Sticky Footer](http://www.cssstickyfooter.com/)。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-09-17T21:31:59.883

您是否尝试过使用 position:fixed

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2015-01-21T14:52:50.150

您需要将 html、body 和任何其他父元素设置为 100% 高度。如果您可以发布构成页面的其余 HTML 和 CSS，我可以尝试为您提供更多帮助。

# c# - ConnectionString 连接后丢失密码。打开

> ID：12467335
> 
> 赞同：63
> 
> 时间：2012-09-17T21:27:00.033
> 
> 标签：c#, ado.net

我正在使用 ADO.NET 从服务器上的数据库中获取一些信息，
所以这就是我所做的：

```
string conStr = "Data Source=myServer\SQLEXPRESS;Initial Catalog=DBName;User ID=myUser;Password=myPassword";

SqlConnection conn = new SqlConnection(conStr);

conn.Open();
// do stuff
conn.Close(); 
```

但是在调用**Open**方法后，我注意到**conn.ConnectionString**正在丢失密码，所以它变成：

```
"Data Source=myServer\SQLEXPRESS;Initial Catalog=DBName;User ID=myUser;" 
```

这会导致任何 SqlCommand 后记出现异常
如何解决这个问题？
注意：奇怪的是并不总是发生
编辑：我认为它与它自己的命令没有任何关系，但无论如何

```
SqlCommand command = new SqlCommand("select GetDate()", conn);
SqlDataReader reader = command.ExecuteReader(); 
```

* * *

## 回答 #1

> 赞同：90
> 
> 时间：2012-09-17T22:32:05.703

出于安全原因，这是设计使然。来自[MSDN](https://docs.microsoft.com/en-us/dotnet/api/system.data.sqlclient.sqlconnection.connectionstring?redirectedfrom=MSDN&view=dotnet-plat-ext-6.0#remarks)：

> ConnectionString 类似于 OLE DB 连接字符串，但不相同。与 OLE DB 或 ADO 不同，返回的连接字符串与用户设置的 ConnectionString 相同，如果 Persist Security Info 值设置为 false（默认值），则减去安全信息。**除非将 Persist Security Info 设置为 true，否则用于 SQL Server 的 .NET Framework 数据提供程序不会在连接字符串中保留或返回密码。**

* * *

## 回答 #2

> 赞同：61
> 
> 时间：2013-01-29T16:42:26.357

查看连接字符串，为了将密码保留在 ConnectionString 属性中**，您必须将密码添加`"Persist Security Info=true;"`到连接字符串本身**。

以下示例将删除密码：

```
string conStr = "Data Source=localhost;Initial Catalog=MyDatabase;User Id=MyUser;Password=MyPassword";
SqlConnection conn = new SqlConnection(conStr);
conn.Open();
conn.Close();
Console.WriteLine(conn.ConnectionString); 
```

以下示例将密码保存在`conn.ConnectionString`：

```
string conStr = "Persist Security Info=True;Data Source=localhost;Initial Catalog=MyDatabase;User Id=MyUser;Password=MyPassword";
SqlConnection conn = new SqlConnection(conStr);
conn.Open();
conn.Close();
Console.WriteLine(conn.ConnectionString); 
```

它是在连接字符串本身而不是在`SqlConnection`对象中设置的属性，我将它放在连接字符串的开头，这样您就不必滚动查看它，它可以在连接字符串中的任何位置，我通常会看到它在末尾。

就像其他人所说的那样，如果您需要这样做，您很可能没有完全按照预期使用 SqlConnection 对象。

* * *

## 回答 #3

> 赞同：7
> 
> 时间：2014-02-14T22:32:19.607

您可能想要添加自己的验证，但这将采用标准 SqlConnection（没有持久安全性）并访问私有 ConnectionOptions 属性以检索连接字符串。

```
public static string SqlConnectionToConnectionString(SqlConnection conn)
{
    System.Reflection.PropertyInfo property = conn.GetType().GetProperty("ConnectionOptions", System.Reflection.BindingFlags.Instance | System.Reflection.BindingFlags.NonPublic);
    object optionsObject = property.GetValue(conn, null);
    System.Reflection.MethodInfo method = optionsObject.GetType().GetMethod("UsersConnectionString");
    string connStr = method.Invoke(optionsObject, new object[] { false }) as string; // argument is "hidePassword" so we set it to false
    return connStr;
} 
```

请注意，如果 MS 更改底层实现，这可能会中断，因为我们正在使用反射。我不建议这是最好的方法，但这是一种方法。

# c# - 替换 ObservableCollection？

> ID：12467337
> 
> 赞同：3
> 
> 时间：2012-09-17T21:27:06.980
> 
> 标签：c#, .net, thread-safety, observablecollection

我正在寻找一个`ObservableCollection`线程安全的替代品，在 UI 线程上引发事件，最好有一个`AddRange`方法。我在这里和其他地方看到过一些实现，但我更喜欢经过测试和验证的实现，而且我不必自己维护。

那么任何人都可以向我指出这样的替代品，最好通过 NuGet 获得？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-09-17T21:42:04.000

对于线程安全集合，请检查[System.Collections.Concurrent](http://msdn.microsoft.com/en-us/library/system.collections.concurrent.aspx)命名空间。ConcurrentStack 有一个 PushRange 方法，可以在栈顶插入多个对象。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2013-01-28T20:44:03.417

您可以尝试使用 Microsoft 的[BulkObservableCollection](http://msdn.microsoft.com/en-us/library/dd867973.aspx)，尽管我不确定他们为什么将它放在如此奇怪的命名空间中！当我尝试在 VS2012 中“添加引用...”时没有看到它，必须手动浏览到 C:\Windows\Microsoft.NET\assembly\GAC_MSIL

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-09-17T21:59:38.027

您可以尝试这里描述的一种：

[http://deanchalk.com/2010/02/01/thread-safe-dispatcher-safe-observable-collection-for-wpf/](http://deanchalk.com/2010/02/01/thread-safe-dispatcher-safe-observable-collection-for-wpf/)

这是博客文章中的完整实现。它可作为源（来自该页面）提供，因此它可能不符合您的测试/验证标准。

我没有使用过它，所以我不能保证它工作得如何（或没有）。

更新：旧链接已损坏。我用当前链接替换了它。Dean Chalk 实际上是 SO 的成员，所以这里有一个指向他的 SO 个人资料的链接，以防它再次中断：

[https://stackoverflow.com/users/328848/dean-chalk](https://stackoverflow.com/users/328848/dean-chalk)

# java - javamail 发送的邮件被视为垃圾邮件

> ID：12467339
> 
> 赞同：3
> 
> 时间：2012-09-17T21:27:10.363
> 
> 标签：java, jakarta-mail, email-spam

我正在尝试开发一个发送邮件的应用程序。它运作良好，但如果我从 Gmail 向 hotmail 发送电子邮件，它会被视为垃圾邮件。这是一段描述smtp服务器参数的代码

```
Properties props = new Properties();
        props.put("mail.smtp.auth", "true");
        props.put("mail.smtp.starttls.enable", "true");
        props.put("mail.smtp.host", "smtp.gmail.com"); // pour hotmail -> smtp.live.com
        props.put("mail.smtp.port", "587");

        Session session = Session.getInstance(props,
          new javax.mail.Authenticator() {
            protected PasswordAuthentication getPasswordAuthentication() {
                return new PasswordAuthentication(emailFrom, password);
            }
          }); 
```

请问有什么想法吗？谢谢你。

# c++ - 从 Objective-C 类调用 C++ 构造函数

> ID：12467341
> 
> 赞同：10
> 
> 时间：2012-09-17T21:27:14.020
> 
> 标签：c++, objective-c

如何从 Objective-C 类中调用 C++ 构造函数？

```
class CppClass {
public:
    CppClass(int arg1, const std::string& arg2): _arg1(arg1), _arg2(arg2) { }

    // ...
private:
    int _arg1; std::string _arg2;
};

@interface ObjC: NSObject {
    CppClass _cppClass;
}
@end

@implementation ObjC

- (id)init
{
    self = [super init];
    if ( self )
    {
         // what is the syntax to call CppClass::CppClass(5, "hello") on _cppClass?
    }
    return self;
}
@end 
```

* * *

## 回答 #1

> 赞同：9
> 
> 时间：2012-09-17T21:29:50.287

当我最终遇到默认构造函数没有剪切它的情况时，我将实例变量设为指针，然后`new`在`init`方法和方法`delete`中使用`dealloc`。

实际上，为 Objective-C 实例变量调用默认构造函数是一个相对较新的事情。

没有 Objective-C 语言的规范，更不用说 Objective-C++ 扩展的规范了。Apple 确实发布了一份名为[The Objective-C Programming Language](https://developer.apple.com/library/mac/documentation/Cocoa/Conceptual/ObjectiveC/ObjC.pdf)的文档，但它几乎没有提到 C++，所以当你需要澄清一些不明显的事情时，你经常会自己离开。不过，[Clang](http://clang.llvm.org/) [邮件列表中](http://lists.cs.uiuc.edu/mailman/listinfo/cfe-dev)的人通常更了解。

* * *

## 回答 #2

> 赞同：5
> 
> 时间：2012-09-17T21:38:59.773

如果您需要一个基于堆栈的 C++ 类作为 obj-c 类的 ivar，那么您不能将任何参数传递给构造函数。该类将作为 obj-c 对象分配的一部分构建。您可以在您的 中使用赋值运算符`-init`，或者您可以以其他方式修改您的嵌入对象（例如使用成员函数等）。

如果类绝对需要用参数构造，那么你不能使用基于堆栈的对象，而必须在堆上分配它`new`（然后`delete`在你的 中删除它`-dealloc`）。

* * *

## 回答 #3

> 赞同：3
> 
> 时间：2018-09-15T01:14:17.973

如果您已经在 ObjC 中使用 C++，不妨将其设为智能指针，这样您就不必担心添加清理位。

```
#include <memory>

@interface ObjC: NSObject {
    std::unique_ptr<CppClass> _cppClass;
}
@end

@implementation ObjC

- (id)init
{
    self = [super init];
    if ( self )
    {
         _cppClass.reset(new CppClass(5, "hello"));
    }
    return self;
}
@end 
```

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2012-09-17T22:32:52.757

只是为了好玩——我找到了一个使用模板的部分解决方案，但我怀疑你会得到很多“真实世界”的里程......

```
template <int X, const char Y[]>
class CPPClass
{
    int _x;
    const char * _string ;

public:
    CPPClass();
};

template <int X, const char Y[]>
CPPClass<X, Y>::CPPClass()
: _x(X)
, _string(Y)
{

}

extern const char kHelloWorld[] = "hello world";

@interface MyObject : NSObject
{
    CPPClass<5, kHelloWorld> thing;
}

@end 
```

请注意，`int`模板参数可以是文字，但`const char[]`模板参数必须在具有外部链接的变量中声明..（根据*clang*）

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2021-05-08T03:48:21.803

另一种解决方案是创建一个包装器`CppClass`，并在该包装器中提供构造函数参数，例如：

```
class CppClass {
public:
    CppClass(int arg1, const std::string& arg2): _arg1(arg1), _arg2(arg2) { }

    // ...
private:
    int _arg1; std::string _arg2;
};

namespace {

struct CppClassWrapper {
    CppClass innerClass { 5, "hello" };
};

}

@interface ObjC: NSObject {
    CppClassWrapper _cppWrapper;
}
@end

@implementation ObjC

- (id)init
{
    self = [super init];
    if ( self )
    {
         // use _cppWrapper.innerClass
    }
    return self;
}
@end 
```

* * *

## 回答 #6

> 赞同：-1
> 
> 时间：2012-09-17T21:36:50.103

我还没有尝试过，但为了好玩，我只想重复一下：

首先这看起来是错误的：

```
@interface ObjC: NSObject {
  CppClass _cppClass;
}
@end 
```

看你在 obj c 类的接口中声明一个基于堆栈的类。

尝试

```
CppClass *_cppClass; 
```

然后只要您在文件中包含 CppClass

你应该因为 obj C 与 C 和 C++ 的互操作能够创建一个实例

```
_cppClass = new CppClass(pass constructor args here 
```

我不建议将 C++ 类放在同一个文件中

在 obj C 项目中，您需要一个 .mm 文件 - 不确定 CPP 的声明是否包含在其中。不能。

因此，您需要为您的 C++ 类提供一个单独的标头和 impl，就像通常那样，您只需在您的 obj 类中包含 CPP 标头和代码 CPP。

我可能离这里很远，还没有尝试过，但是只要你遵守规则，obj C 似乎就能优雅地调用 C 和 C++。

# c - 服务器卡在选择并从客户端缓冲区连续读取

> ID：12467344
> 
> 赞同：3
> 
> 时间：2012-09-17T21:27:29.457
> 
> 标签：c, sockets

我正在尝试使用 Select 调用的客户端服务器代码。但是，一旦我从客户端发送到服务器，服务器就会不断地从客户端发送的缓冲区中读取数据，即使客户端在 Ist 数据包之后没有发送任何内容。我在哪里做错了？

下面是代码片段：

```
fd_set readSet,master_list_read;
FD_ZERO(&master_list_read);
FD_SET(STDIN, &master_list_read);//stdin manually trigger reading
FD_SET(sockfd, &master_list_read);//tcp socket

struct timeval tv;
int retval;
tv.tv_sec = 10;
tv.tv_usec = 0;
while(1)
{ 
bool idle=false;
char *buffer=NULL;
int n;

tv.tv_sec = 10;
readSet=master_list_read;
retval = select(sockfd+1, &readSet, NULL, NULL,&tv);
if (retval == -1) 
{
    perror("Error in select\n");
    exit(4);
}
else if(retval==0)
{ 
    printf("*********SEND SUCCESSFUL******\n");
}       
else 
{   
if(FD_ISSET(0, &readSet))
{
    bzero(buf,256);
    fgets(buf,256,stdin); 
    if (send(sockfd, buffer,n, 0) == -1) perror("error in sending MSG to server\n");
}

else  if (FD_ISSET(sockfd, &readSet))  // receives data from server,print it on StdOutput
{  
    bzero(buf,256);
    int nbytes = recv(sockfd, buf, 256,0);
    if(nbytes<=0)
    {
        perror("recv error from server \n");
        exit(0);
    }
}

} //END OF ELSE 
} //end of while
close(sockfd);          
return 0; 
```

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2012-09-17T22:44:53.433

循环中的`select()`调用保持不变。这意味着稍后 FD_ISSET() 检查成功。`while(1)``readSet`

解决方案很简单：在每次迭代时清除 fd_set：

```
FD_ZERO(&master_list_read);
FD_SET(STDIN, &master_list_read);
FD_SET(sockfd, &master_list_read);
// only now the select() returns what you need
retval = select(sockfd+1, &master_list_read, NULL, NULL,&tv);

// use the master_list_read later 
```

简单地复制 fd_set 并不能解决问题。

# ember.js - Ember.js：折叠/延迟昂贵的观察者或计算属性

> ID：12467345
> 
> 赞同：7
> 
> 时间：2012-09-17T21:27:30.740
> 
> 标签：ember.js

在 Ember 应用程序中，假设您有一个观察者或一个观察数组的属性，如下所示：

```
topContributor: (function() {
  // ... loop over articles (hence slow) ...
}).property('articles.@each.author') 
```

更新`articles`数组，例如通过 ember-data，总共会重复触发属性函数`articles.length`。

当所有更改都完成并且运行循环被刷新时，有没有办法将更新折叠成一个惰性更新？

* * *

## 回答 #1

> 赞同：10
> 
> 时间：2012-09-17T22:47:02.043

感谢@wagenet 和@krisselden 提供以下建议：

目前，虽然绑定被延迟（惰性），但观察者和扩展计算属性会立即触发。将来，它们[也可能会被推迟](http://emberjs.com/blog/2012/10/25/ember-1-0-pre2/)。

同时，您可以使用[Ember.run.once](http://emberjs.com/api/classes/Ember.run.html#method_once)作为一种解决方法来安排延迟函数调用，该函数调用只会运行一次。我想，计算属性可以很容易地变成观察者以遵循相同的模式。这是一个例子：

```
updateTopContributor: function() {
  // ... loop over articles (hence slow) ...
  this.set('topContributor', ...);
},

_updateTopContributorObserver: (function() {
  Ember.run.once(this, 'updateTopContributor');
}).observes('articles.@each.author') 
```

# c++ - 在 C++ 中，是什么导致了这两个函数之间的差异？

> ID：12467346
> 
> 赞同：0
> 
> 时间：2012-09-17T21:27:35.380
> 
> 标签：c++, operator-overloading

所以我为我在课堂上写的 ADT 编写了这两个版本的重载赋值运算符。当我将它们与同一个 ADT 的重载 ostream << 运算符结合使用时，我看到了不同的结果。为什么？是因为我将内存释放到另一个缓冲区，我收到了这个问题吗？

```
void Text::operator= (const Text &other) { 
if (this != &other) {
    delete [] buffer;
    bufferSize = other.bufferSize;
    buffer = new char[bufferSize + 1];
    strcpy(buffer, other.buffer);
    }
}

 void Text::operator= (const Text &other) { 
if (this != &other) {
    delete [] buffer;
    bufferSize = other.bufferSize;
    buffer = new char[bufferSize + 1];
    for (int i = 0; i < bufferSize; i++) {
         buffer[i] = other.buffer[i];
     }
} 
```

这是我重载的 ostream <<,

```
ostream & operator << (ostream &output, const Text &outputText) {
output << outputText.buffer;
return output;
} 
```

差异是这样发生的：

第一个输出：`Hey Jude`

第二个输出：`Hey Jude(random garbage)`

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2012-09-17T21:29:33.843

第二个代码片段不附加终止空终止符，因此垃圾（`strcpy()`复制终止空）。您需要在`for`循环后显式添加空终止符：

```
buffer[bufferSize] = 0; 
```

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-09-17T21:29:36.000

小技巧：

```
buffer = new char[bufferSize + 1](); 
```

这：

```
strcpy(buffer, other.buffer); 
```

还复制空终止字符。这：

```
 for (int i = 0; i < bufferSize; i++) {
     buffer[i] = other.buffer[i];
 } 
```

没有，因为它在`bufferSize+1`你跳过的位置。

我可能会迭代到位置`bufferSize+1`而不是值初始化数组。

好吧，放弃那个，我会用 a`std::string`代替。这样，您就不必担心复制、分配或破坏。

# php - Symfony2 vhost 不会重定向到 app.php

> ID：12467348
> 
> 赞同：2
> 
> 时间：2012-09-17T21:27:47.417
> 
> 标签：php, apache, symfony, routing

我已经在我的服务器（Ubuntu 12.04，blog.dck.me）上推送了我的 Symfony 应用程序，当我继续时，没问题，但是当您尝试阅读一篇文章时，您会遇到 404 错误，然后如果您添加应用程序.php 首先是 URL，它可以工作！

这不是规则问题，我为这个文件夹修复了 777。我清除了产品缓存。我用 php app/console router:debug --env=prod 检查了路由，没关系，我有所有路由。我检查了很多很多我的虚拟主机，当我将 DirectoryIndex 更改为 app_dev.php 时，页面会打印一个 javascript 警报，指示“无法加载工具栏”..

我的虚拟主机：

```
<VirtualHost *:80>
ServerName blog.dck.me
DocumentRoot /var/www/blog/web
DirectoryIndex app.php
<Directory "/var/www/blog/web">
    DirectoryIndex app.php
    Options -Indexes FollowSymLinks SymLinksifOwnerMatch
    AllowOverride All
    Allow from All
    </Directory>
</VirtualHost> 
```

我希望你能得到更多的想法。

谢谢你。

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-09-18T22:42:01.950

如果 www.sitename.com/app.php 有效，那么这不是 symfony 的问题，并且您的 vhost 没问题。.htaccess 也很好，你不需要设置 `DirectoryIndex app.php`

您是否检查过 mod_rewrite 已启用？在你的控制台上试试这个：

```
 apachectl -t -D DUMP_MODULES | grep rewrite 
```

如果您没有结果，那么您需要启用它在 httpd.conf 上添加该行

```
 LoadModule rewrite_module modules/mod_rewrite.so 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-09-18T21:09:32.533

就在这里 ：

```
<IfModule mod_rewrite.c>
  RewriteEngine On
  RewriteCond %{REQUEST_FILENAME} !-f
  RewriteRule ^(.*)$ app.php [QSA,L]
</IfModule> 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-09-17T22:52:27.600

修改你的虚拟主机文件后，你有没有重新启动你的网络服务器？

例如，对于 apache，

```
sudo apachectl graceful 
```

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2013-03-01T22:49:42.113

经过多次，我找到了解决方案！问题出在我的 username.conf (/etc/apache2/users) 中，在此文件中缺少关键字“FollowSymLinks”。

```
<Directory "/Users/DCK/Sites/">
   Options FollowSymlinks Indexes Multiviews
   AllowOverride All
   Order allow,deny
   Allow from all
</Directory> 
```

# asp.net - ASP.Net MVC 跟踪显示 75 秒我无法解释

> ID：12467349
> 
> 赞同：3
> 
> 时间：2012-09-17T21:28:01.640
> 
> 标签：asp.net, performance, trace

我注意到在我公司的一个网站上使用用户帐户的页面的渲染时间很长。我在本地打开了跟踪并从我的开发机器上访问了他的帐户，并且它是我找不到的 75 秒的渲染。我添加了对主文件和子文件的跟踪`aspx`，但即使在子页面中的最后一段代码（foreach）被调用之后，还有 75 秒的时间发生了一些事情。

跟踪结果。

半秒是有道理的（清理一些东西，我不知道是什么），但是 75 没有意义。

![追踪结果](../Images/2c855d170d623a1481d7b58f462d680b.png)

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-09-17T22:30:19.637

我认为您确实在视图中有一些代码需要一些时间，但是 ASP.NET MVC 渲染本身可能会花费 76 秒。

当您有几个使用路由的 Html 帮助程序（通常是操作链接）并且您在路由表中有大量条目时，可能会发生这种情况。尝试在移除大部分帮助程序的情况下呈现页面，以检查是否是这种情况。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-10-11T17:16:26.967

确保已关闭已实例化且具有 IDisposable 接口的每个对象。

# javascript - 倒计时永远不会达到 0 并给出负值

> ID：12467351
> 
> 赞同：0
> 
> 时间：2012-09-17T21:28:09.227
> 
> 标签：javascript

我有一个倒计时脚本，但我有 2 个问题。1\. 我的倒计时永远不会达到 0 并停止，所以我得到一个连续的负数。2\. 计数器只显示 chrome 而不是 firefox 或 internet explorer。如何解决这两个问题？

```
var sec, min, hr, day, timer, expireDate;

sec = 1000;
min = 60 * 1000;
hr = 60 * 60 * 1000;
day = 24 * 60 * 60 * 1000;
timer;
expireDate = new Date('Mon Sep 17 2012 14:26:00 GMT-0700');

timer = setInterval(function() {
    var currentDate, countdown, days, hours, minutes, seconds;
    currentDate = new Date();
    countdown = expireDate - currentDate;
    if (countdown === 0 ) {
        window.clearInterval(timer); 
        document.getElementById('countdown').innerHTML = 'EXPIRED!';
    }

    days = Math.floor(countdown / day);
    hours = Math.floor((countdown % day) / hr);
    minutes = Math.floor((countdown % hr) / min);
    seconds = Math.floor((countdown % min) / sec);
    console.log(countdown);
    document.getElementById('countdown').innerHTML = days + " " + hours + " " + minutes + " " + seconds;
}, 1000);​ 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-09-17T21:30:57.087

在这两行中：

```
currentDate = new Date();
countdown = expireDate - currentDate; 
```

您将当前时间和预期时间之间的差值精确*到毫秒*！

如果它没有达到完全正确的值，它将直接超过它。

`===`将测试更改为`<=`

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-09-17T21:35:08.417

正如其他人所说，您应该使用`< 0`.

此外，一旦满足过期条件，您将立即覆盖`EXPIRED!`标签，因此您将永远看不到它。您需要将 后面的代码移动`if`到中，`else`或者简单地在`if`.

```
if (countdown <= 0 ) {
    window.clearInterval(timer); 
    document.getElementById('countdown').innerHTML = 'EXPIRED!';
} else {
    days = Math.floor(countdown / day);
    hours = Math.floor((countdown % day) / hr);
    minutes = Math.floor((countdown % hr) / min);
    seconds = Math.floor((countdown % min) / sec);
    console.log(countdown);
    document.getElementById('countdown').innerHTML = days + " " + hours + " " + minutes + " " + seconds;
} 
```

最后，它无法在 IE 中运行的原因可能是`console.log`. 如果您当时没有打开控制台，IE 将失败。只需删除该`console.log`行，这在 IE 中就可以正常工作。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-09-17T21:32:12.127

您正在将时间与毫秒进行比较！你必须非常幸运才能完成这项工作：

```
currentDate = new Date();
countdown = expireDate - currentDate; 
```

尝试：

```
if (countdown < 0 ) { 
```

# sql - SQL 中的嵌套查询

> ID：12467354
> 
> 赞同：12
> 
> 时间：2012-09-17T21:28:16.437
> 
> 标签：sql, nested

我的查询的目标是返回国家名称及其国家元首，如果它的国家元首的名称以 A 开头，并且该国家的首都有超过 100,000 人使用嵌套查询。

这是我的查询：

```
SELECT country.name as country, 
       (SELECT country.headofstate 
        from country 
        where country.headofstate like 'A%')      
from country, city 
where city.population > 100000; 
```

我试过反转它，将它放在 where 子句等中。我没有得到嵌套查询。我只是收到错误，例如“子查询返回多行”等。如果有人可以帮助我如何订购它，并解释为什么它需要以某种方式，那就太好了。

* * *

## 回答 #1

> 赞同：16
> 
> 时间：2012-09-17T21:46:22.910

如果必须“嵌套”，这将是完成工作的一种方法：

```
SELECT o.name AS country, o.headofstate 
FROM   country o
WHERE  o.headofstate like 'A%'
AND   (
    SELECT i.population
    FROM   city i
    WHERE  i.id = o.capital
    ) > 100000 
```

不过， A`JOIN`会比相关子查询更有效。有没有可能，给你这个任务的人自己没有跟上进度？

* * *

## 回答 #2

> 赞同：8
> 
> 时间：2012-09-17T21:30:38.133

您需要`join`这两个表，然后在`where`子句中过滤结果：

```
SELECT country.name as country, country.headofstate 
from country
inner join city on city.id = country.capital
where city.population > 100000
and country.headofstate like 'A%' 
```

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2012-09-17T21:46:45.333

在我看来，嵌套查询的唯一位置是在 WHERE 子句中，例如

```
SELECT country.name, country.headofstate
FROM country 
WHERE country.headofstate LIKE 'A%' AND 
country.id in (SELECT country_id FROM city WHERE population > 100000) 
```

除此之外，我必须同意 Adrian 的观点：为什么要使用嵌套查询？

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2014-06-25T12:00:47.940

下面的查询应该可以帮助您实现您想要的。

```
select scountry, headofstate from data 
where data.scountry like 'a%'and ttlppl>=100000 
```

# objective-c - 使用带有 ARC 的 TBXML 从 url 解析大型 xml 文件时出现内存泄漏

> ID：12467363
> 
> 赞同：0
> 
> 时间：2012-09-17T21:28:47.040
> 
> 标签：objective-c, xml, automatic-ref-counting, tbxml

我正在使用 TBXML 解析来自 url 的 XML 文件，并且我打开了 ARC。但我得到以下代码的内存泄漏：

```
- (void)readXmlFromUrl:(NSString*)url
{
    NSURL *aUrl = [NSURL URLWithString:url];
    NSData *data = [[NSData alloc] initWithContentsOfURL:aUrl];
    TBXML *tbxml = [[TBXML alloc] initWithXMLData:data];
//    data = nil;
//    NSLog(@"Reading from %@", url);
    // If TBXML found a root node, process element and iterate all children
    if (tbxml.rootXMLElement) {
        NSLog(@"Root Found");
        [self traverseElement:tbxml.rootXMLElement];
    }

//    data = nil;
//    aUrl = nil;
//    tbxml = nil;
//    NSLog(@"Retain count for TBXML %d", tbxml.retainCount);
} 
```

我附上了内存泄漏的图像。提前致谢 ![在此处输入图像描述](../Images/cd3e869fdee6e365d124f467825d0deb.png)

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-09-17T21:32:15.967

不是泄漏，但可能是静态分析器中的错误。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-09-17T22:03:59.600

我的回答是假的，没有看到你在使用 ARC

# php - 如何在联系表单中使用 input type="tel"

> ID：12467364
> 
> 赞同：1
> 
> 时间：2012-09-17T21:29:10.340
> 
> 标签：php, html, contact-form

PHP新手在这里尝试使用简单的联系表格。我拥有的字段是：“姓名”、“电子邮件”、“电话”和“消息”。我试图弄清楚如何处理“电话”字段 - 我希望它输出到与“消息”相同的位置，以便在收到电子邮件时将消息和电话号码都输出到电子邮件的正文。我该怎么做呢？

```
 if( isset( $_POST['submit'] ) ) : 
        wp_mail( get_option( 'admin_email' ), 
        'Website Contact Form',
        ( isset($_POST['message'] ) ? $_POST['message'] : '(blank)' ), 
        'From: ' . ( isset( $_POST['from_name'] ) ? $_POST['from_name'] : 'Website Contact Form' ) . ' <' . ( isset( $_POST['from_email'] ) ? $_POST['from_email'] : get_option( 'admin_email' ) ). '>' . "\r\n" );
    $output = '<p>Thank you! Your message has been sent.</p>'; 
    else : 
        $output = '
<form action="" method="post"><ul>
    <li>
        <label for="from_name">Name</label>
        <input type="text" name="from_name" id="from_name" />
    </li>
    <li>
        <label for="from_email">Email</label>
        <input type="email" name="from_email" id="from_email" />
    </li>
    <li>
        <label for="from_tel">Phone</label>
        <input type="tel" name="from_tel" id="from_tel" />
    </li>
    <li>
        <textarea name="message" id="message"></textarea>
    </li>
    <li class="submit">
        <input name="submit" type="submit" value="Say Hello!" />
    </li>
</ul></form>';
    endif;
    return $output; 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-09-18T02:33:38.677

[您可以使用此](https://stackoverflow.com/questions/3090862/how-to-validate-phone-number-using-php)验证您的电话号码。

在前端，您可以使用[JavaScript 掩码](http://www.webresourcesdepot.com/javascript-input-masks/)使您的输入字段看起来很性感。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-09-17T21:30:38.180

没有什么像，只需在删除连字符、大括号等（如果有）之后仅对数字`type=tel`使用和验证它。`type=text`

```
$_POST['tel'] = str_replace(array('-','(',')', ' ', '+'), '', $_POST['tel']);
if( is_numeric($_POST['tel']) === FALSE )
  echo 'Telephone # should consist of only numbers.'; 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-09-18T00:52:46.323

或者，使用三个输入类型=文本

```
(____) ___ - _____ 
```

并将它们与php合并在一起。

# facebook - FB 墙贴 - 消息发布（已发送帖子和通知。）/ 链接帖子（已发布但未发送通知）

> ID：12467379
> 
> 赞同：1
> 
> 时间：2012-09-17T21:30:08.273
> 
> 标签：facebook, facebook-wall

这是代码，当帖子没有在“链接字段”上包含链接时，此代码工作得很好，可以在“字段消息”中发送带有或不带有链接的消息 在字段消息中发布的链接看起来像一个可点击的文本链接（http://www.mylinkposted.com/withoutmetadata/），您可以发送如下帖子：

> 嗨，我终于完成了我的新网站
> 
> [http://mywebsite.com](http://mywebsite.com)
> 
> 根据您的经验，我将等待一些反馈。

但是，如果在“链接字段”中写入（复制）链接，它将从中提取元数据，并且帖子将包括描述，标题，标题，图像，来源......如果用户有帖子，它将看起来像在其他用户提要/墙上分享了一个链接，上面有所有的帖子参数，看起来很不错，但是通知它没有进入通知流，看起来真的很垃圾，只是发布而不发送通知，你认为什么可以解决这个问题问题？

```
                $app_id = "xxxxxxxxxxxxxxxx";

                $app_secret = "xxxxxxxxxxxxxxxxxxxxxxxxxxxxxx";

                $site_url = "http://www.xxxxxxxxxxxxxxx.com/app00/index.php";

                尝试{
                    include_once "src/facebook.php";
                }catch（异常 $e）{
                    错误日志（$e）；
                }

                $facebook = 新的 Facebook（数组（
                    'appId' => $app_id,
                    '秘密' => $app_secret,
                    ));

                $user = $facebook->getUser();

                如果（$用户）{

                    尝试{        
                        $user_profile = $facebook->api('/me');
                    }catch(FacebookApiException $e){
                        错误日志（$e）；
                        $用户=空；
                    }

                }

                如果（$用户）{
                    // 获取注销地址
                    $logoutUrl = $facebook->getLogoutUrl();
                }别的{
                    // 获取登录地址
                    $loginUrl = $facebook->getLoginUrl(数组(
                        '范围' => '发布流用户组'，
                        'redirect_uri' => $site_url,
                        ));
                }

                如果（$用户）{

                    $查询=数组（
                        数组（'方法' => 'GET'，'relative_url' => '/'.$user），
                        array('method' => 'GET', 'relative_url' => '/'.$user.'/friends'),
                        数组（'方法' => 'GET'，'relative_url' => '/'.$user.'/groups'），
                        array('method' => 'GET', 'relative_url' => '/'.$user.'/likes'),
                        );

                    尝试{
                        $batchResponse = $facebook->api('?batch='.json_encode($queries), 'POST');
                    }catch（异常 $o）{
                        错误日志（$o）；
                    }

                    //细绳。解码用作 PHP 数组。
                    $user_info = json_decode($batchResponse[0]['body'], TRUE);
                    $friends_list = json_decode($batchResponse[1]['body'], TRUE);
                    $groups = json_decode($batchResponse[2]['body'], TRUE);
                    $pages = json_decode($batchResponse[3]['body'], TRUE);

                    if(isset($_POST['submit_x'])){
                        if($_POST['message'] || $_POST['link'] || $_POST['picture']) {
                            $body = 数组（
                                '消息' => $_POST['消息'],
                                '链接' => $_POST['链接'],
                                );

                            $batchPost=array();

                            $i=1;
                            $标志=1；
                            foreach($_POST as $key => $value) {
                                if(strpos($key,"id_") === 0) {
                                    $batchPost[] = array('method' => 'POST', 'relative_url' => "/$value/feed", 'body' => http_build_query($body));
                                    如果（$i++ == 50）{
                                        尝试{
                                            $multiPostResponse = $facebook->api('?batch='.urlencode(json_encode($batchPost)), 'POST');                          
                                        }catch(FacebookApiException $e){
                                            错误日志（$e）；
                                            echo("批量发布失败");
                                        }
                                        $标志=0；
                                        未设置（$batchPost）；
                                        $i=1;
                                    }
                                }
                            }
                            如果（isset（$batchPost））{
                                尝试{
                                    $multiPostResponse = $facebook->api('?batch='.urlencode(json_encode($batchPost)), 'POST');
                                }catch(FacebookApiException $e){
                                    错误日志（$e）；
                                    echo("批量发布失败");
                                }
                                $标志=0；
                            }

                        }
                        别的 {
                            $标志=2；
                        }
                    }
                }

```

# c# - 如何使用 WinAPI 以快速的方式逐像素处理图像？

> ID：12467380
> 
> 赞同：7
> 
> 时间：2012-09-17T21:30:08.943
> 
> 标签：c#, .net, windows, winapi, graphics

所以，我用 GUI、C# 制作了一些简单的图像处理程序。例如，我想更改 HSV 颜色模型中的图像颜色，将每个像素从 RGB 转换回来。

我的程序通过用户选择加载一些图片，并使用其图形上下文在表单的一个面板中显示它。然后用户可以通过移动滚动条、单击按钮、选择某些图像区域等来处理这张图片。当他这样做时，我需要实时逐像素更改所有图片。所以，我写了类似的东西：

```
for (int x = 0; x < imageWidth; x++)
    for (int y = 0; y < imageHeight; y++)
        Color c = g.GetPixel(x, y);
        c = some_process_color_function_depending_on_user_controls(c);
        g.SetPixel(x, y) 
```

即使我在内存中（不在屏幕上）使用图形，GetPixel 和 SetPixel 函数的工作速度也很慢（所以，由于我的程序运行速度很慢，我对其进行了分析，并解释说这两个函数最多会减慢我的程序）。因此，当用户移动滑块或选中复选框时，我无法在一段时间内处理大图片。

请帮忙！我该怎么做才能让我的程序更快？我不同意将其他第三方库用于图形或更改编程语言！

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2012-09-17T21:32:46.280

是的，Get/SetPixel 函数非常慢。请改用[Bitmap.LockBits()](http://msdn.microsoft.com/en-us/library/5ey6h79d%28v=vs.80%29.aspx) / [UnlockBits()](http://msdn.microsoft.com/en-us/library/system.drawing.bitmap.unlockbits%28v=vs.80%29.aspx)。它返回原始位数据供您操作。

从 msdn 参考：

```
private void LockUnlockBitsExample(PaintEventArgs e)
{

    // Create a new bitmap.
    Bitmap bmp = new Bitmap("c:\\fakePhoto.jpg");

    // Lock the bitmap's bits.  
    Rectangle rect = new Rectangle(0, 0, bmp.Width, bmp.Height);
    System.Drawing.Imaging.BitmapData bmpData = 
        bmp.LockBits(rect, System.Drawing.Imaging.ImageLockMode.ReadWrite,
        bmp.PixelFormat);

    // Get the address of the first line.
   IntPtr ptr = bmpData.Scan0;

    // Declare an array to hold the bytes of the bitmap.
    // This code is specific to a bitmap with 24 bits per pixels.
    int bytes = bmp.Width * bmp.Height * 3;
    byte[] rgbValues = new byte[bytes];

    // Copy the RGB values into the array.
    System.Runtime.InteropServices.Marshal.Copy(ptr, rgbValues, 0, bytes);

    // Set every red value to 255\.  
    for (int counter = 2; counter < rgbValues.Length; counter+=3)
        rgbValues[counter] = 255;

    // Copy the RGB values back to the bitmap
    System.Runtime.InteropServices.Marshal.Copy(rgbValues, 0, ptr, bytes);

    // Unlock the bits.
    bmp.UnlockBits(bmpData);

    // Draw the modified image.
    e.Graphics.DrawImage(bmp, 0, 150);

} 
```

# python - 如何完成 django-userena 和 social auth 的集成

> ID：12467383
> 
> 赞同：2
> 
> 时间：2012-09-17T21:30:24.923
> 
> 标签：python, django, django-socialauth

我认为 django userena 是一次又一次地重新发明轮子的用户注册信息的好选择。

我想以某种方式将 userena 与 social-auth 集成。但无论我做什么，我都无法完成整合它们。

那么如何整合这两个认证系统。

任何想法或帮助将不胜感激......

亲切的问候

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-09-19T20:38:54.890

我不太明白你在想什么。但是，请考虑到这一点：

1 Userena 提供与用户连接的抽象模型。使用源代码中的示例：

```
from django.db import models
from django.utils.translation import ugettext_lazy as _
from django.contrib.auth.models import User

from userena.models import UserenaLanguageBaseProfile

import datetime

class Profile(UserenaLanguageBaseProfile):
    """ Default profile """
    GENDER_CHOICES = (
        (1, _('Male')),
        (2, _('Female')),)

    user = models.OneToOneField(User,
                                unique=True,
                                verbose_name=_('user'),
                                related_name='profile') 

    gender = models.PositiveSmallIntegerField(_('gender'),
                                              choices=GENDER_CHOICES,
                                              blank=True,
                                              null=True)
    website = models.URLField(_('website'), blank=True, verify_exists=True)
    location =  models.CharField(_('location'), max_length=255, blank=True)
    birth_date = models.DateField(_('birth date'), blank=True, null=True)
    about_me = models.TextField(_('about me'), blank=True) 
```

如您所见， userena 提供了一个抽象类，将用户作为一对一字段。

另一方面，django-social-auth 知道如何使用不同的社交服务进行身份验证，并在数据库中填充表 auth_user。由 django-social-auth 更改的其他表是 django-session 和 social_auth_usersocialauth。这意味着 django social auth 知道如何进行身份验证、处理会话并聚合诸如令牌之类的额外数据。

如果您的想法只是使用 userena 向用户添加额外的数据，这可以以[更简单的形式](https://github.com/pennersr/django-allauth)完成。

我可以说在以下情况下使用 userena：

*   你需要大头照（图片）
*   您需要为每个用户添加语言
*   您需要使用 https
*   您需要通过电子邮件确认帐户（这有点与使用社交身份验证相冲突，不是吗？）
*   需要对配置文件的用户权限进行一些基本管理。

update: If you want to have both auth, take a look at this [nice project](https://github.com/pennersr/django-allauth).

# javascript - 将新函数推入数组 - Javascript

> ID：12467384
> 
> 赞同：0
> 
> 时间：2012-09-17T21:30:29.923
> 
> 标签：javascript, arrays, class, function

我不能让它工作：

```
var global_variables = {
    players: []
}; 

var player = function(properties){
    this.width = properties.width;                            
    this.height = properties.height;
    this.position = properties.position;
    this.position.x = properties.position.x;
    this.position.y = properties.position.y;
}

function load_players(){
    global_variables.players.push(
        [
            new player(
                {
                    width: 10,
                    height: 10,
                    position: {
                        x: 50,
                        y: 50
                    },
                    colour: '#ff0000'
                }
            )
        ]
    );
}

 function init(){ 
    var ctx = load_canvas();
    load_players();

    for(a in global_variables.players){
        var _this = global_variables.players[a];
        alert(_this.colour);
    }
} 
```

alert(_this.colour) 只是提醒未定义。有任何想法吗？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-09-17T21:38:23.790

您从中获得`undefined`的`_this.colour`原因有两个：

1.  您没有`colour`在构造函数中设置属性
2.  不是将每个新玩家推入数组，而是推入一个包含新玩家的单元素数组。也就是说，您正在创建一个数组数组。

将此添加到构造函数中：

```
 this.colour = properties.colour; 
```

`load_players()`然后从函数中删除方括号：

```
function load_players(){
    global_variables.players.push(        
            new player({
                    width: 10,
                    height: 10,
                    position: {
                        x: 50,
                        y: 50
                    },
                    colour: '#ff0000'
            })
    );
} 
```

演示：http: [//jsfiddle.net/ZACnC/](http://jsfiddle.net/ZACnC/)

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-09-17T21:39:27.157

1.  您在调用之前尝试循环`init`
2.  您正在推送包装在数组中的播放器实例。你只是想推动玩家。
3.  不要`for ... in ...`在数组上使用。使用常规循环或`forEach`像我一样使用。
4.  您从未真正将`colour`属性设置为您的实例。

[http://jsfiddle.net/GLsR2/](http://jsfiddle.net/GLsR2/)

这是小提琴的代码：

```
var global_variables = {
    players: []
}; 

var player = function(properties){
    this.width = properties.width;                            
    this.height = properties.height;
    this.position = properties.position;
    this.position.x = properties.position.x;
    this.position.y = properties.position.y;
    this.colour = properties.colour;
}

function load_players(){
    global_variables.players.push(
        new player(
                {
                    width: 10,
                    height: 10,
                    position: {
                        x: 50,
                        y: 50
                    },
                    colour: '#ff0000'
                }
            )
      );
}

init();

global_variables.players.forEach(function(player) {
   alert(player.colour); 
});

function init(){ 
    load_players();
} 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-09-17T21:37:56.833

当你推到 时`global_variables.players`，你推的是一个包含对象的数组`new Player`，而不是对象本身。

`[]`使用时不需要`.push`.

```
function load_players(){
    global_variables.players.push(
        new player({
            width: 10,
            height: 10,
            position: {
                x: 50,
                y: 50
            },
            colour: '#ff0000'
        })
    );
} 
```

PS 不要`for...in`用于数组。只需使用普通的`for`.

```
for(var a = 0, len = global_variables.players.length; a < len; a++){
    var _this = global_variables.players[a];
    alert(_this.colour);
} 
```

PPS 您需要添加`this.colour = properties.colour;`到您的`player`构造函数。

# ruby-on-rails - 将多个 FactorGirl 模型与一个主“公司”模型相关联

> ID：12467386
> 
> 赞同：0
> 
> 时间：2012-09-17T21:30:35.573
> 
> 标签：ruby-on-rails, ruby, cucumber, factory-bot

我在 RSPEC 中使用过很多次工厂女孩，但这个月我的任务是在我们的测试套件中实现 Cucumber 故事。我想我可能有一个我不太确定的问题。

我们的“主要”帐户模型称为“公司”。用户、员工等等等等都属于这个。一些直接通过 f/k 其他通过委托。我们使用 factory-girl 的旧方式设置了许多使用 Factory girl 构建的模型的实例变量。

即在“spec_helper.rb”中

```
@grade_system = FactoryGirl.create(:grade_system)
@asset_size = FactoryGirl.create(:asset_size)
@asset_size.grades.create!(FactoryGirl.attributes_for(:grade))
@company = FactoryGirl.create(:company, :asset_size => @asset_size, :grade_system => @grade_system) 
```

这是相当愚蠢的国际海事组织。

尝试使用“已定义属性：关联”的正确关联修复工厂时，我不断收到错误消息。我猜是因为使用属于员工的工厂创建的用户都使用具有关联的工厂构建：公司，导致冲突。但这不是唯一的例子。我想我的问题是，这种情况的最佳做法是什么。我觉得如果我可以剔除一家公司并将其分配给所有需要它的工厂，这可能会起作用，或者将所有适当的关联塞入公司工厂，但无法使用 FactoryGirl 建立用户.build（：用户）。.... 或者我只是错过了关联如何运作的要点？

```
FactoryGirl.define do
  factory :company do

   sequence(:name)                    { |n|  "Company#{n}" }
   sequence(:subdomain)               { |n| "subdomain#{n}" }  
   first_time_setup                   false

   non_exempt_multiplier              1.2
   exempt_multiplier                  1.2
   executive_multiplier               1.2

   primary_contact_first_name         'Jarrett'
   primary_contact_last_name          'Green'
   primary_contact_email              'tes@test.com'
   primary_contact_phone              '(555) 555-5555'
   hours_considered_part_time         30
   hours_considered_full_time         40

   association :industry
   association :grade_system
   association :asset_size

 end
end

######################################

FactoryGirl.define do
  require 'faker'
  factory :employee do

    association :company
    association :position
    association :branch

    first_name                Faker::Name.first_name
    last_name                 'Smith'
    pay_basis                 'salary'
    current_salary            10000.00
    date_in_position          (Date.today)
    sequence(:internal_id)    { |n| n }  

    user
  end
end

############################################################

FactoryGirl.define do
  factory :user do
    association :company 
    sequence(:login)          {|l|  "user#{l}@test.com"}
    sequence(:first_name)     {|fn| "UserFirstName#{fn}"}
    sequence(:last_name)      {|ln| "UserLastName#{ln}"}
    password                  'thisisthepassword'
    password_confirmation     'thisisthepassword'
  end
end 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-09-18T12:59:28.490

处理这个问题的一个有趣的方法是使用 Fixtures 作为父记录，然后在工厂中定义它们。为每个模型创建一个有效的夹具，然后您可以在工厂定义中分配它，如下所示：

```
association : grade_system { GradeSystem.find(12345678) } 
```

其中数字是灯具的 ID。

这种方法有一些好处。首先，它很快，因为您不会在每次创建子记录时都创建父记录，夹具在测试运行开始时加载一次并始终保持不变。其次，这很简单，每个灯具都有一个`id`基于灯具名称的编号 - 每次运行总是相同的，因此您可以放心`find`直接使用 - 它们还可以轻松链接关联，因此您无需创建建厂时父母的父母。第三，它很灵活，如果需要在创建或构建工厂时进行测试，您始终可以传入另一个父级。

您可以避免大多数与固定装置有关的问题，因为您只创建每种类型中的一种以用作父母。

# comparison - 将一个字符与 Ada 中的一组字符进行比较

> ID：12467390
> 
> 赞同：1
> 
> 时间：2012-09-17T21:30:42.647
> 
> 标签：comparison, character, range, ada, letter

我正在使用 Ada 并获取和 int，我需要通过将其转换回并针对字符进行测试来检查它是否是转换为 int 的字符。问题是我不想打字

```
if intToChar(popped) = 'a' | 'A' | 'b' | 'B' | (etc.) 
then 
```

我是 Ada 的新手，所以我想知道是否有更简单的方法来代替输入 52 ors。我尝试了几件事，但没有成功。

我想知道我是否可以使用诸如字符范围'a'..'Z'之类的东西（另外，'a'..'Z'是否得到整个字母表？或者可能是'A'..'z'？），但我知道这些是值，而不是在类型中使用时的实际字符。

我也可以创建一个函数来检查，但我只需要在代码中的一个位置执行此操作，所以我在这里缺少的快捷方式会很好。我还可以使用一个函数来检查一个变量是否是一个字符，如果它包含在 Ada 中。

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-09-17T22:09:54.843

找到 Ada.Characters.Handling.Is_Letter()

* * *

## 回答 #2

> 赞同：5
> 
> 时间：2012-09-18T01:56:40.990

你真的不需要地图：

```
Subtype Uppercase is Character Range 'A'..'Z';
Subtype Lowercase is Character Range 'a'..'z';

If C in Uppercase or C in Lowercase then
  ...
End if; 
```

当然，对于更复杂的检查，地图 {或集合} 是要走的路。

# php - preg_replace 删除模式之间字符串的多个不同部分

> ID：12467392
> 
> 赞同：1
> 
> 时间：2012-09-17T21:30:55.237
> 
> 标签：php, regex, preg-replace

**这是我抓取的字符串的一小部分：**

SEPVALAjazz(音乐)SEPVALC5.59SEPVALAlatin(music)SEPVALAcountry(music)SEPVALC6.70SEPVALArock(music)SEPVALC5.89SEPVALAdance(music)SEPVALAworld(music)SEPVALC6.70

我用正则表达式操作了字符串以插入“SEPVALA”和“SEPVALC”值。我希望删除文本中出现的模式**“SEPVALA”**和**“(music)SEPVALA”**之间的字符串。在上面的示例中，这将删除“latin”和“dance”。

**期望的结果是：**

SEPVALAjazz(音乐)SEPVALC5.59SEPVALAcountry(音乐)SEPVALC6.70SEPVALArock(音乐)SEPVALC5.89SEPVALAworld(音乐)SEPVALC6.70

**我目前正在实施的代码是：**

$pattern="/SEPVALA(.+?)\(音乐\)SEPVALA/";

$replacement="SEPVALA";

$newstring=preg_replace($pattern, $replacement, *$originalstring* );

但是，这会删除太多的字符串，因为正则表达式引擎会拾取第一个**“SEPVALA”**并从这一点向前删除所有内容，直到**“（音乐）SEPVALA” （应该这样做！）我需要一种从****“**向后扫描”的方法**(music)SEPVALA"**删除有问题的文本并在下一个**"SEPVALA"**处停止，然后继续前进到**"(music)SEPVALA"**的下一个匹配项，依此类推。或任何其他方法来实现这一点。非常感谢。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-09-17T21:39:09.983

尝试用空字符串替换以下模式：

```
SEPVALA((?!SEPVAL[AC]).)+(?<=\(music\))(?=SEPVALA) 
```

示例：[http ://www.rubular.com/r/ZCfJQ4ey2O](http://www.rubular.com/r/ZCfJQ4ey2O)

说明：这是通过匹配`SEPVALA`，然后一次匹配一个字符，直到匹配`SEPVALA`或`SEPVALC`可以匹配，通过使用带有重复的负前瞻来工作。至此，我们已经在or`SEPVALA`之前匹配了 from ，所以我们只需要确保之前匹配的字符是，接下来的字符是。`SEPVALA``SEPVALC``(music)``SEPVALA`

完整代码：

```
$pattern="/SEPVALA((?!SEPVAL[AC]).)+(?<=\\(music\\))(?=SEPVALA)/";
$replacement="";
$newstring=preg_replace($pattern, $replacement, $originalstring); 
```

# asp.net-mvc-3 - Dapper 不填充字段并引发异常

> ID：12467404
> 
> 赞同：1
> 
> 时间：2012-09-17T21:31:24.847
> 
> 标签：asp.net-mvc-3, dapper

我正在从 ActiveRecord 切换到 Dapper。我有一个包含几个字段的简单项目类：

*   标识（整数）
*   名称（字符串）
*   秘密（指导）
*   OwnerId（指导）

我最初尝试使用 Dapper 导致了以下代码：我正在使用 Dapper，如下所示：

```
List<Project> projects = new List<Project>();
using (var conn = MvcApplication.GetSqlConnection()) // new connection
{
    projects = conn.Query<Project>("SELECT * FROM Projects p WHERE p.OwnerId = (SELECT UserId FROM aspnet_Users WHERE LoweredUserName=@userName)", new { userName = User.Identity.Name.ToLower() }).ToList();
}
return View(projects); 
```

此查询导致`DataException: Error parsing column 0 (Id=11 - Int16)`. 内部异常是`InvalidCastException: Specified cast is not valid.`

由于 Dapper 使用页面上的示例均未提及`SELECT *`，因此我尝试像这样修改我的查询：

```
 projects = conn.Query<Project>("SELECT OwnerId = (SELECT UserId FROM aspnet_Users WHERE LoweredUserName=@userName)", new { userName = User.Identity.Name.ToLower() }).ToList(); 
```

当我调试时，虽然我的数据库中有两个项目，但我只得到一个；并且那个名称为 null 。

奇怪的。我究竟做错了什么？我觉得 Dapper 没有正确地将字段（DB）映射到字段（类）。我正在使用最新的 NuGet 版本。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-09-18T17:06:47.933

您看到的不同之处在于下一个（1.12？）版本中的关键特性。从历史上看，dapper 一直非常挑剔数据必须是完全匹配的，如果数据是 double 但字段/属性是浮点数，或者数据很长并且字段/属性是 int，它会抱怨（抛出） . 在待定版本中，有额外的代码可以检测到这一点并*作为生成的 IL 的一部分进行*补偿（不是通过 Convert.ChangeType - 太慢了）。

这一变化的一个关键驱动因素是一些数据库以非常不同的方式返回一些相当简单的值。对于某些数据库的用户来说，映射他们的类型通常是有问题的。

Tl;博士：我很高兴新功能对你有用。它应该很快就会发布。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-09-18T09:48:32.913

Dapper 只会映射 SQL 的结果，因此您需要从要映射的表中选择。

```
List<Project> projects = new List<Project>();
using (var conn = MvcApplication.GetSqlConnection()) // new connection
{
    projects = conn.Query<Project>("SELECT * FROM Projects Where OwnerId = (SELECT UserId FROM aspnet_Users WHERE LoweredUserName=@userName)", new { userName = User.Identity.Name.ToLower() }).ToList();
}
return View(projects); 
```

硅

# javascript - webview android上的drawImage html5/javascript

> ID：12467405
> 
> 赞同：1
> 
> 时间：2012-09-17T21:31:24.580
> 
> 标签：javascript, android, html, android-webview

我正在尝试使用 html5/javascript 在画布上绘制图像。在浏览器中打开正常，但在 web 视图中，模拟器 QVGA (320x240) 打开错误。

这是我的代码：

```
img.src = 'bobs.jpg';  
  img.onload = function() {
    ctx.drawImage(img,0,0, img.width, img.height);
} 
```

[这是模拟器的打印屏幕](https://lh3.googleusercontent.com/-Uk3_QFTwMYo/UFeWBClHHVI/AAAAAAAAAJQ/anBfTCr4VXw/w417-h554-p-k/erro.png)

为什么会发生此错误？为什么图像不能完整显示？

# sql-server - 使用双引号的 unicode 字符串文字

> ID：12467406
> 
> 赞同：1
> 
> 时间：2012-09-17T21:31:25.673
> 
> 标签：sql-server, sql-server-2008, tsql, unicode-literals

在 SQL Server 中，我们这样表示 unicode 字符串文字：

```
declare @s nvarchar(max)
select @s = N'test' 
```

但是，我们也可以使用双引号......所以我们应该能够做到这一点：

```
set quoted_identifier off
declare @s nvarchar(max)
select @s = N"test" 
```

但我错了：

> 消息 102，级别 15，状态 1，第 2 行“测试”附近的语法不正确。

什么是正确的形式？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-09-17T22:01:12.720

在 T-SQL 中，您可以使用双引号在 SELECT 语句中指定列的名称，同样可以使用方括号 []。

相比

```
select 1 as "value x"
select 1 as [value x] 
```

两者都会产生一个名为`value x`.

对于字符串文字，只能使用 '' 和 N''。

**尼古拉评论后**更新****

 **T-SQL 常量上的[MSDN 页面](http://msdn.microsoft.com/en-us/library/ms179899.aspx)仅提到“字符串常量”的 QUOTED_IDENTIFIER/双引号/单引号行为，但“Unicode 字符串”部分仅指`N''`符号。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-09-17T22:17:59.727

不能使用双引号在 T-SQL 中分隔 Unicode 字符串。

所以呢？您要解决的问题是什么？

您仍然可以通过将单引号加倍来在 Unicode 字符串中嵌入单引号。

```
SELECT N'This isn''t a problem' 
```**

# grails - 使用 Hibernate Filters Plugin 软删除 Grails 中的实体

> ID：12467407
> 
> 赞同：3
> 
> 时间：2012-09-17T21:31:30.213
> 
> 标签：grails, grails-orm, soft-delete, hibernate-filters

我正在寻找一种方法来避免从数据库中删除我的用户，而是将它们标记为已删除并且不要将它们带回查询中。

我找到了这个插件[http://grails.org/plugin/hibernate-filter](http://grails.org/plugin/hibernate-filter)，它是完成任务的好工具。

但是当我尝试实施我的解决方案时，我遇到了同样的问题，这些问题的解决方案在互联网上没有（或者我无法找到）。

所以，接下来，我描述一下我解决软删除问题的方法。

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-09-17T21:31:30.213

在此示例中，我将让我的类 User 将其 delete() 方法作为软删除来处理，将属性 lowDate 设置为在 User 实例上调用 delete() 时的实际日期。这个想法是 GORM 查询将忽略具有 lowDate != null 的用户。

1）安装休眠过滤器插件。在插件页面查找依赖项：http: [//grails.org/plugin/hibernate-filter](http://grails.org/plugin/hibernate-filter)。看看文档。

2）将以下内容添加到数据源：

```
import org.grails.plugin.hibernate.filter.HibernateFilterDomainConfiguration

environments {
    development {
    dataSource {
        ...    
        configClass = HibernateFilterDomainConfiguration
    }
    }
    test {
    dataSource {
        ...
        configClass = HibernateFilterDomainConfiguration
    }
    }
    production {
    dataSource {
        ...
        configClass = HibernateFilterDomainConfiguration
    }
    }   
} 
```

3）在课堂上定义你的过滤器：

```
class User {
    ...
    String email
    Date lowDate
    static hibernateFilters = {
        deletedFilter(condition:'low_date is null', default:true)
    }
    static constraints = {
        ...
        lowDate nullable: true
    }
    ...
} 
```

注意：看看我定义条件的方式。它接收到的值是 sql，因此请注意将属性命名为数据库上的属性，而不是类上的名称。

这将使 GORM 方法避免让 lowDate 不同于 null 的用户。

4）以一种避免物理删除的方式定义beforeDelele：

```
class User {
    ...
    def beforeDelete() {
        SecUser.executeUpdate("update SecUser su set lowDate = :lowDate where email = :email",
                                [lowDate: new Date(), email: email])
        return false
    }
} 
```

注意：我尝试了一种更简单的方法来实现 beforeDelete()

```
def beforeDelete() {
    this.lowDate = new Date()
    this.save()
    return false
} 
```

但是当在 beforeDelete 内部调用 save() 时，调用了 beforeDelete 的 save 方法等等，生成了 StackOverflow。我不知道为什么会这样。

5) 在 BootStrap 上启用过滤器：

```
class BootStrap {
    ...
    def init = { servletContext ->
        User.enableHibernateFilter('deletedFilter')
        environments {
            ...
        }
    }
...
} 
```

就是这样，它现在显示工作。为了测试功能，这里有一些示例 spock 测试：

注意：'build' 方法来自 build-test-data 插件。

```
class UserIntegrationSpec extends IntegrationSpec {

    def 'it should not find users marked as deleted'(){
        given: 'some users with lowDate and some withOut lowDate (=null)'
            User.build(firstName:'delUser1', lowDate: new Date())
            User.build(firstName:'user1')
            User.build(firstName:'delUser2', lowDate: new Date())
            User.build(firstName:'user2')
            def users = User.list()
        expect: 'it should only find the ones with lowDate == null'
            users.size() == 2
            users.every { it.firstName == 'user1' || it.firstName == 'user2' }      
    }

    def 'it should only delete users logically' (){
        given: 'a persisted user'
            def user = User.build(firstName: 'logiDelUser')
        when: 'user.delete() is called'
            user.delete(failOnError:true, flush:true)
            def deletedUser
            def users 
            User.withoutHibernateFilters(){
                users = User.list()
                deletedUser = User.find { firstName == 'logiDelUser' }
            }
        then: 'it should not delete the user from the DB, but set a low date instead'
            users.size() != 0
            deletedUser.lowDate != null
            deletedUser.firstName == 'logiDelUser' 
    }
} 
```

希望这会有所帮助！

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2014-02-02T03:53:32.730

在 GORM 中对实体进行软删除的另一种方法是使用以下插件：

[http://grails.org/plugin/logical-delete](http://grails.org/plugin/logical-delete)

它使用“已删除”标志将实体标记为已删除，并且不会显示在查询中。此插件使用[Hibernate 过滤器插件](http://grails.org/plugin/hibernate-filter)

# javascript - 更改 url 时动画 gif 冻结

> ID：12467419
> 
> 赞同：0
> 
> 时间：2012-09-17T21:32:04.020
> 
> 标签：javascript, css, redirect, animated-gif

当用户搜索一个词并且页面被重定向到结果页面时，我想显示一个动画 gif。问题是动画 gif 在重定向发生时冻结。有解决方法吗？也许 css3 动画而不是动画 gif？

谢谢。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-09-17T21:35:46.743

解决此问题的一个技巧是将图像设置为每隔几毫秒“重新加载”一次。这给出了 gif 仍在动画中的效果。

```
setTimeout('document.images["myImageId"].src="../images/ajax-loader.gif"', 200); 
```

# rspec - 设计、Rspec 和测试在 RegistrationsController 中获得“新”

> ID：12467423
> 
> 赞同：0
> 
> 时间：2012-09-17T21:32:17.200
> 
> 标签：rspec, devise

我收到以下错误：

```
 1) RegistrationsController has an registration page load up successfully
     Failure/Error: response.code.should == 200
       expected: 200
            got: "404" (using ==)
     # ./spec/controllers/registrations_controller_spec.rb:6:in `block (2 levels) in ' 
```

从此代码：

```
 require 'spec_helper'

describe RegistrationsController do
  it "has an registration page load up successfully" do
    get :new
    response.code.should == 200
  end
end 
```

我可以在浏览器中成功访问该页面。

在我得到不可避免的“你不应该测试他们的代码”评论之前，我正在尝试测试我的自定义注册页面，这给了我同样的错误，所以我想我会检查 /register 页面的控制路线，这是我的登录页面。

关于为什么我没有得到 200 而是 404 的想法？调试提示？我可以发布任何你需要的帮助和感激。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-09-19T00:56:09.293

原来你在访问任何设计路由的测试中需要这个，因为它不使用路由器，或者 rspec 不使用或类似的东西......[在这里](https://github.com/plataformatec/devise/wiki/How-To:-Controllers-and-Views-tests-with-Rails-3-%28and-rspec%29)

```
 require 'spec_helper'

describe RegistrationsController do
  it "has an registration page load up successfully" do
    @request.env["devise.mapping"] = Devise.mappings[:user] #assuming your using :user routes
    get :new
    response.code.should == 200
  end
end 
```

把它放在别的地方是不够的，但是当你在他们自己的路线上摇摆不定时，把它扔在那里。

# c++ - Libsox + portaudio

> ID：12467427
> 
> 赞同：0
> 
> 时间：2012-09-17T21:32:37.713
> 
> 标签：c++, audio, portaudio

这次我只是问，如何使用 portaudio 和 libsox 流式传输歌曲？

我看到了有关如何使用 libaudiodecoder 进行操作的文档，但现在我想知道是否可以使用 libsox 进行操作。

非常感谢！

# .net - 表值参数：以小块发送数据

> ID：12467431
> 
> 赞同：0
> 
> 时间：2012-09-17T21:33:11.443
> 
> 标签：.net, sql-server-2008, stored-procedures, table-variable

我正在从 csv 文件中读取数据并将数据作为表变量发送到存储过程。从我到目前为止的测试来看，我能够在 3 分 30 秒内处理 300k 条记录。该文件可能包含多达数百万条记录。我想知道一次性将所有这些记录发送到存储过程是否是个好主意，或者我应该分批发送它们，比如 500k？我已将命令超时设置为 1800。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-09-17T22:45:06.630

使用 IEnumerable SqlDataRecord 的示例
它的工作方式类似于反向数据读取器

注意我排序。这是通过聚集索引。索引的碎片化绝对会降低加载速度。第一个实现使用插入值（未排序），在 12 小时的运行中，这个版本实际上快了 100 倍。我还在加载结束时禁用了 PK 和重新索引以外的索引。从长远来看，我得到大约 500 行/秒。你的样本是 1400 / 秒，太棒了。如果你开始看到退化，那么需要注意的事情。

```
public class DocFTSinXsCollection : List<DocFTSinX>, IEnumerable<SqlDataRecord>
{
    // used by TVP for fast insert
    private int sID;
    private IEnumerable<DocFTSinX> docFTSinXs;
    IEnumerator<SqlDataRecord> IEnumerable<SqlDataRecord>.GetEnumerator()
    {
        //todo fix the order in 3 to sID, wordID1, workID2
        var sdr = new SqlDataRecord(
        new SqlMetaData("wordID1", System.Data.SqlDbType.Int),
        new SqlMetaData("wordID2", System.Data.SqlDbType.Int),
        new SqlMetaData("sID", System.Data.SqlDbType.Int),
        new SqlMetaData("Delta", System.Data.SqlDbType.Int));
        foreach (DocFTSinX oh in docFTSinXs.OrderBy(x => x.Word1).ThenBy(x => x.Word2))
        {
            sdr.SetInt32(0, oh.Word1);
            sdr.SetInt32(1, oh.Word2);
            sdr.SetInt32(2, sID);
            sdr.SetInt32(3, (Int32)oh.Delta);
            yield return sdr;
        }
    }

    public DocFTSinXsCollection(int SID, IEnumerable<DocFTSinX> DocFTSinXs)
    {
        sID = SID;
        docFTSinXs = DocFTSinXs;
        //Debug.WriteLine("DocFTSinXsCollection DocFTSinXs " + DocFTSinXs.Count().ToString());
    }
} 
```

其他要考虑的工具是 SQLBulkCopy .NET 类和 Drapper。

OP询问如何分批执行。

```
 while (true)
 {
     // if no more break;
     // fill list or datatable with next 100000
     // send list or datatable to db
 } 
```

# racket - 我的动画地方图像程序有什么问题？

> ID：12467436
> 
> 赞同：2
> 
> 时间：2012-09-17T21:33:30.253
> 
> 标签：racket

我一直在研究球拍中的这段代码，以根据您在火箭电影中输入的角度使火箭上升。我认为我的数学有问题，因为动画场景中的火箭一直朝错误的方向飞去。我似乎无法弄清楚到底出了什么问题。唯一可行的方向是 20 度。火箭图像本身位于 90 度角。有人可以帮我解决我研究的地方图像公式吗？我不知道怎么了。

谢谢你的时间。

```
#lang racket
(require 2htdp/image)
(require 2htdp/universe)
(require rackunit)

;; (make−takeoff angle) −&gt; (−&gt; natural−number/c image?)
;; angle : exact−integer?

(define make-takeoff
    (lambda (angle)
        (let ([side-length 400])
            (let ([the−background (square side-length "solid" "white")]
                  [the-rocket .]
                  [the-velocity (/ side-length 100)])
                (lambda (frame)
                    (place-image
                        (rotate angle the-rocket)
                        (- 375 (* (cos (- 90 angle)) (* frame the-velocity)))  
                        (- 375 (* (sin (- 90 angle)) (* frame the-velocity)))  
                        the−background))))))

;; (rocket−movie angle) −&gt; natural−number/c
;; angle : exact−integer?
(define rocket-movie
    (lambda (angle)
        (animate (make-takeoff angle)))) 
```

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-09-17T21:49:39.550

请原谅我的迂腐，但你*真的，真的*需要将你的“起飞”功能分解成更小的部分。特别是，如果您编写了一个接受角度和框架的“rocket-x”函数，您可以为它编写测试用例，并自己找出问题所在。如果您在执行此操作时遇到任何问题，请告诉我。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-09-19T19:08:30.990

注意：[*cos*](http://docs.racket-lang.org/reference/generic-numbers.html#%28def._%28%28quote._~23~25kernel%29._cos%29%29)和[*sin*](http://docs.racket-lang.org/reference/generic-numbers.html#%28def._%28%28quote._~23~25kernel%29._sin%29%29)函数以**弧度**工作，而不是度数。您的计算似乎假设了度数，这应该可以解释为什么您会看到奇怪的值。

（另一方面，假设它们以度为单位，[*旋转*](http://docs.racket-lang.org/teachpack/2htdpimage.html#%28def._%28%28lib._2htdp/image..rkt%29._rotate%29%29)确实适用于数字。所以请注意：数字可能意味着不同的东西，具体取决于上下文。）

# c# - 检查 StorageFile 的 ImageProperties 是否具有 DateTaken 属性的正确方法是什么？

> ID：12467439
> 
> 赞同：1
> 
> 时间：2012-09-17T21:33:42.547
> 
> 标签：c#, windows-8, microsoft-metro, exif

我想知道文件是否具有 ImageProperties.DateTaken 属性。

文档说：

> 如果未设置 date 属性，则此值默认为 0，这可能会被翻译成不同编程语言的误导性日期。例如，在 JavaScript 中，0 转换为 1600 年 12 月 16 日。您应该始终检查此属性是否为实际值，而不是 0。

我应该如何检查“日期为零”？我注意到在 C# 中，如果文件没有 DateTaken 属性，则 DateTaken 是 1601 年 1 月 1 日（有趣的是，它与文档中关于 JavaScript 中“零”日期的说法不同）。

有没有比 1/1/1601 更好的方法？

# ios - 如何在我的键盘上添加自定义按钮？

> ID：12467441
> 
> 赞同：2
> 
> 时间：2012-09-17T21:33:56.430
> 
> 标签：ios, xcode, uikeyboard

我想在我的应用程序中使用这样的键盘：

![谷歌浏览器应用](../Images/874f3b08fc465dd1601122f28578ec50.png)

如何实现这一点？如何添加具有几个突击队的行？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-09-17T21:38:44.753

[`inputAccessoryView`](http://developer.apple.com/library/ios/documentation/uikit/reference/UIResponder_Class/Reference/Reference.html#//apple_ref/occ/instp/UIResponder/inputAccessoryView)通过实现for 来添加按钮[`UIResponder`](http://developer.apple.com/library/ios/#documentation/uikit/reference/UIResponder_Class)。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-09-17T21:56:58.307

我所做的是从头开始创建一个键盘。`UIViews`在底部的拳头视图中使用两个和按钮。在这些按钮上设置禁用用户交互，然后在此处使用此代码：

```
-(void)touchesBegan:(NSSet *)touches withEvent:(UIEvent *)event{
    UITouch *touch = [touches anyObject];
    CGPoint touchPoint = [touch locationInView:keyboardView];
    //here loops all labels
    for(UIButton *keyButton in keyboardView.subviews){
        if (CGRectContainsPoint(keyButton.frame,touchPoint)&&keyButton.enabled) {
            keyButton.highlighted = YES;
            for(UIButton *bigKey in keyboardTextView.subviews){
                if (bigKey.currentTitle==keyButton.currentTitle) {
                    bigKey.hidden=NO;
                }
                else{
                    bigKey.hidden=YES;
                }
            }
        }
        else if(!CGRectContainsPoint(keyButton.frame,touchPoint)){
            keyButton.highlighted = NO;
        }
    }
}
- (void)touchesMoved:(NSSet *)touches withEvent:(UIEvent *)event{
    UITouch *touch = [touches anyObject];
    CGPoint touchPoint = [touch locationInView:keyboardView];
    //here loops all labels
    for(UIButton *keyButton in keyboardView.subviews){
        if (CGRectContainsPoint(keyButton.frame,touchPoint)&&keyButton.enabled) {
            keyButton.highlighted = YES;
            for(UIButton *bigKey in keyboardTextView.subviews){
                if (bigKey.currentTitle==keyButton.currentTitle) {
                    bigKey.hidden=NO;
                }
                else{
                    bigKey.hidden=YES;
                }
            }
        }
        else if(!CGRectContainsPoint(keyButton.frame,touchPoint)){
            keyButton.highlighted = NO;
        }
    }
}
- (void)touchesEnded:(NSSet *)touches withEvent:(UIEvent *)event{
    UITouch *touch = [touches anyObject];
    CGPoint touchPoint = [touch locationInView:keyboardView];
    for(UIButton *keyButton in keyboardView.subviews){
        keyButton.highlighted = NO;
        if(CGRectContainsPoint(keyButton.frame,touchPoint) && keyButton.enabled == YES){
            keyButton.enabled = NO;
            letterUsedString=keyButton.currentTitle;
            // right here you can use the letter Used String.
        }
    }
    for(UIButton *bigKey in keyboardTextView.subviews){
        bigKey.hidden=YES;
    }
} 
```

您只需要两个`IBOutlets`视图`keyboardTextView`和键盘视图。我将上传一些文件，以便您可以看到我的键盘。所以第一个视图是您按下的按钮，按钮背景中的图像。第二个视图是突出显示的按钮。如果您实现该代码并将两者连接起来`IBOutlets`，它将像键盘一样工作。任何无法识别的变量都会添加到您的`.h`. 当我按下按钮时，我突出显示了它们，这改变了图像：

![这](../Images/d21bde10abd0c84f295c917efa581579.png)

到 ：

![这](../Images/4d6a63b9567286498207c07d49d4752c.png)

然后我在图片上方的放大按钮将是：

![这。](../Images/e9524516e0ee6e749907a40cb1a66a84.png)

只需按您想要的方式放置按钮，然后将放大的按钮放在上方。放大的按钮视图是可见的，但在您按下之前，里面的所有按钮都是隐藏的。我希望我的代码有帮助，你必须自己做故事板。

# lua - 在 Lua 中使用 busted 无法访问模块

> ID：12467442
> 
> 赞同：0
> 
> 时间：2012-09-17T21:33:58.270
> 
> 标签：lua, lua-busted

我是 Lua 的初学者，我想在我的开发人员中使用单元测试。我决定使用[busted](http://olivinelabs.com/busted)一个简单易用的框架来做到这一点。

```
require "yaci"
require "busted"

foo = {}
foor.bar = newclass( "foo.bar" )
function foo.bar:doSomething() return "foo bar" end

describe("Unit tests for Foo.Bar", function()

    it("A first test", function()

        local to_test = foo.bar()
        local text = to_test:doSomething()

        local a = { test = say }
        local b = { test = "foo bar" }
        assert.same( a, b )

    end)

end 
```

但是 foo.bar 看起来无法访问......

```
attempt to index global 'foo' (a nil value) 
```

在他们之外`describe`是没有问题的。

有人可以解释一下为什么 foo.bar 无法访问`describe`吗？

谢谢

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-09-18T12:37:09.800

最有可能的是，describe 函数设置了传递函数的环境，以防止它干扰其他代码文件。

# c# - 从 Internet Explorer 渲染图像

> ID：12467446
> 
> 赞同：3
> 
> 时间：2012-09-17T21:34:56.650
> 
> 标签：c#, javascript, html, internet-explorer, screenshot

我正在尝试从 Internet Explorer 保存完整的渲染图像。

不幸的是，我不能使用 WinForm 组件“WebBrowser”或第三方组件，如 HtmlCapture.Net 或在线服务或类似的东西，因为我有几个限制。但我仍然希望使用 IE 足以解决我的任务。

我的代码的主要部分如下所示：

```
 SHDocVw.WebBrowser wb = GetBrowser();
      wb.DocumentComplete += wb_DocumentComplete2;
      wb.Navigate(_url);

      private void wb_DocumentComplete2(object pDisp, ref object URL)
    {
        var iwb2 = (IWebBrowser2) pDisp;
        var document = (IHTMLDocument2) iwb2.Document;

        if (heightsize > 0 && widthsize > 0)
        {
            IntPtr _hwnd = IntPtr.Zero;
            try
            {
                _hwnd = new IntPtr(iwb2.HWND);
            }
            catch (Exception e)
            {
            }

            if (_hwnd != IntPtr.Zero)
            {
                //Start here
                RECTL r = new RECTL
                              {
                                  top = 0,
                                  left = 0,
                                  bottom = heightsize,
                                  right = widthsize
                              };
                IViewObject ivo = document as IViewObject;
                if (ivo != null)
                {
                    using (Bitmap bmp = new Bitmap(widthsize, heightsize))
                    {
                        using (Graphics g = Graphics.FromImage(bmp))
                        {
                            //get the handle to the device context and draw
                            IntPtr hdc = g.GetHdc();
                            ivo.Draw(DVASPECT.DVASPECT_CONTENT, 1, IntPtr.Zero, IntPtr.Zero, IntPtr.Zero, hdc, ref r, ref r, IntPtr.Zero, 0);
                            g.ReleaseHdc(hdc);
                        }
                        String filename = @"C:\" + Guid.NewGuid() + ".png";
                        bmp.Save(filename, ImageFormat.Png);
                    }
                }
            }
        }
    } 
```

但我总是只得到黑色图像。

我也尝试使用 BitBlt，但如果网页太大，图像的底部是黑色的，据我所知，这是因为 BltBit 的性质，它假设只复制窗口的可见部分。CopyFromScreen 出于同样的原因不起作用。

[除了这个](https://stackoverflow.com/questions/6142121/c-sharp-capturing-direct-3d-screen)解决方案，我还有其他选择吗？

无论如何，如果有人给我任何建议或正确的方向如何做到这一点，我真的很感激。

## **更新：**

我试过了。像那样

```
using (Graphics graphics = Graphics.FromImage(new Bitmap(Width,Height)))
        {
            IntPtr hdcDestination = graphics.GetHdc();
            tagRECT lprcBounds = new tagRECT(0, 0, Width, Height);
            tagRECT lprcWBounds = new tagRECT(0, 0, Width, Height);
            int i = viewObject.Draw(1, 1, IntPtr.Zero, IntPtr.Zero, hdcDestination, IntPtr.Zero, lprcBounds, lprcWBounds, IntPtr.Zero, 0);
            IntPtr hdcMemory = Helper.Gdi32.CreateCompatibleDC(hdcDestination);
            IntPtr bitmap = Helper.Gdi32.CreateCompatibleBitmap(hdcDestination, Width, Height);
            if (bitmap != IntPtr.Zero)
            {
                IntPtr hOld = Helper.Gdi32.SelectObject(hdcMemory, bitmap);
                Helper.Gdi32.BitBlt(hdcMemory,0, 0,Width, Height, hdcDestination, 0, 0, Helper.Gdi32.SRCCOPY);
                Helper.Gdi32.SelectObject(hdcMemory, hOld);
                Helper.Gdi32.DeleteDC(hdcMemory);
                graphics.ReleaseHdc(hdcDestination);
                Image img = Image.FromHbitmap(bitmap);
                String filename = @"C:\" + Guid.NewGuid() + ".png";
                img.Save(filename, ImageFormat.Png);
            }
        } 
```

但我在这里也没有成功。

我也尝试使用**IHTMLElementRender**，但此转换失败：

```
IHTMLElement element = (IHTMLElement) document.body; // Okay, element isn't null
IHTMLElementRender render = (IHTMLElementRender) element; //Fails! 
```

无论如何，这里是完整的代码，我认为它与 Winforms 的 WebBrowser 控件一起工作得很好。

```
private void OnDocumentComplete(object sender, DWebBrowserEvents2_DocumentCompleteEvent e)
{
    IHTMLDocument2 document = (IHTMLDocument2) this.axWebBrowser1.Document;
    if (document != null)
    {
          IHTMLElement element = (IHTMLElement) document.body;
          if (element != null)
          {
              IHTMLElementRender render = (IHTMLElementRender) element;
              if (render != null)
              {
                    using (Graphics graphics = this.pictureBox1.CreateGraphics())
                    {
                        IntPtr hdcDestination = graphics.GetHdc();
                        render.DrawToDC(hdcDestination);
                        IntPtr hdcMemory = GDI32.CreateCompatibleDC(hdcDestination);
                        IntPtr bitmap = GDI32.CreateCompatibleBitmap(
                              hdcDestination, 
                              this.axWebBrowser1.ClientRectangle.Width, this.axWebBrowser1.ClientRectangle.Height
                              );

                        if (bitmap != IntPtr.Zero)
                        {
                              IntPtr hOld = (IntPtr) GDI32.SelectObject(hdcMemory, bitmap);
                              GDI32.BitBlt(
                                  hdcMemory,
                                  0, 0,
                                  this.axWebBrowser1.ClientRectangle.Width, this.axWebBrowser1.ClientRectangle.Height,
                                  hdcDestination,
                                  0, 0,
                                  (int) GDI32.TernaryRasterOperations.SRCCOPY
                                  );
                              GDI32.SelectObject(hdcMemory, hOld);
                              GDI32.DeleteDC(hdcMemory);
                              graphics.ReleaseHdc(hdcDestination);

                              this.pictureBox.Image = Image.FromHbitmap(bitmap);
                        }
                    }
              }
          }
    }
} 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2014-03-21T19:37:17.053

如果您想要一个临时屏幕截图来查看您想要的页面，请尝试截取当前活动，然后将其输出为图像按钮并为 Screen1.class 添加 onclicklistener

```
View  content = findViewById(R.id.blankview);
getScreen();
}

private void getScreen(){
Bitmap bitmap = content.getDrawingCache();
File file = new File("/sdcard/test.png");
try 
{
    file.createNewFile();
    FileOutputStream ostream = new FileOutputStream(file);
    bitmap.compress(CompressFormat.PNG, 100, ostream);
    ostream.close();
} 
catch (Exception e) 
{
    e.printStackTrace();
} 
```

}

或者或者/两者兼而有之

```
View v = view.getRootView();
v.setDrawingCacheEnabled(true);
Bitmap b = v.getDrawingCache();
String extr =     Environment.getExternalStorageDirectory().toString();
File myPath = new File(extr, getString(R.string.free_tiket)+".jpg");
FileOutputStream fos = null;
try {
fos = new FileOutputStream(myPath);
b.compress(Bitmap.CompressFormat.JPEG, 100, fos);
fos.flush();
fos.close();
    MediaStore.Images.Media.insertImage(getContentResolver(), b, "Screen", "screen");
} catch (FileNotFoundException e) {
// TODO Auto-generated catch block
e.printStackTrace();
} catch (Exception e) {
// TODO Auto-generated catch block
e.printStackTrace(); 
```

}

# ios - 2 秒后显示和淡入 UIImageView

> ID：12467454
> 
> 赞同：27
> 
> 时间：2012-09-17T21:35:43.043
> 
> 标签：ios, xcode, animation, uiimage, fadeout

我正在我的 iPhone 游戏中开发一个通知系统，并希望在屏幕上弹出一个图像并在 2 秒后自动淡出。

1.  用户单击调用方法“popupImage”的按钮
2.  图像出现在屏幕上的指定位置，不需要淡入
3.  图像在屏幕上停留 2 秒后自行淡出。

有没有办法做到这一点？提前谢谢。

* * *

## 回答 #1

> 赞同：57
> 
> 时间：2012-09-17T22:06:50.300

为此使用`UIView`专用方法。

所以想象一下你已经`UIImageView`准备好了，已经创建并添加到主视图中，但只是隐藏了。您的方法只需使其可见，并在 2 秒后启动动画以将其淡出，方法是将其“alpha”属性从 1.0 设置为 0.0（在 0.5 秒动画期间）：

```
-(IBAction)popupImage
{
    imageView.hidden = NO;
    imageView.alpha = 1.0f;
    // Then fades it away after 2 seconds (the cross-fade animation will take 0.5s)
    [UIView animateWithDuration:0.5 delay:2.0 options:0 animations:^{
         // Animate the alpha value of your imageView from 1.0 to 0.0 here
         imageView.alpha = 0.0f;
     } completion:^(BOOL finished) {
         // Once the animation is completed and the alpha has gone to 0.0, hide the view for good
         imageView.hidden = YES;
     }];
} 
```

就那么简单！

* * *

## 回答 #2

> 赞同：12
> 
> 时间：2015-02-25T17:20:04.747

**斯威夫特 2**

```
self.overlay.hidden = false
UIView.animateWithDuration(2, delay: 5, options: UIViewAnimationOptions.TransitionFlipFromTop, animations: {
    self.overlay.alpha = 0
}, completion: { finished in
    self.overlay.hidden = true
}) 
```

**斯威夫特 3, 4, 5**

```
self.overlay.isHidden = false
UIView.animate(withDuration: 2, delay: 5, options: UIView.AnimationOptions.transitionFlipFromTop, animations: {
    self.overlay.alpha = 0
}, completion: { finished in
    self.overlay.isHidden = true
}) 
```

`overlay`我的形象的出路在哪里。

* * *

## 回答 #3

> 赞同：3
> 
> 时间：2017-09-11T18:32:48.233

Swift 3 版本的**@AliSoftware**的答案

```
imageView.isHidden = false
imageView.alpha = 1.0

UIView.animate(withDuration: 0.5, delay: 2.0, options: [], animations: {

            self.imageView.alpha = 0.0

        }) { (finished: Bool) in

            self.imageView.isHidden = true
        } 
```

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2012-09-17T21:46:02.633

就在这里。[在这里](http://developer.apple.com/library/ios/documentation/uikit/reference/uiview_class/uiview/uiview.html#//apple_ref/occ/clm/UIView/animateWithDuration%3aanimations%3a)查看`UIView`基于块的动画。并以谷歌为例。

```
+ (void)animateWithDuration:(NSTimeInterval)duration animations:(void (^)(void))animations 
```

您也可以启动[计时器](http://developer.apple.com/library/mac/documentation/cocoa/reference/foundation/Classes/NSTimer_Class/Reference/NSTimer.html#//apple_ref/occ/clm/NSTimer/scheduledTimerWithTimeInterval%3atarget%3aselector%3auserInfo%3arepeats%3a)

```
+ (NSTimer *)scheduledTimerWithTimeInterval:(NSTimeInterval)seconds target:(id)target selector:(SEL)aSelector userInfo:(id)userInfo repeats:(BOOL)repeats 
```

# java - Android中带有editText的AlertDialog

> ID：12467457
> 
> 赞同：0
> 
> 时间：2012-09-17T21:35:49.980
> 
> 标签：java, android, android-dialog

我需要在alertDialog 中放入一个editText。据我所知，据我所知，[我](http://developer.android.com/guide/topics/ui/dialogs.html#AlertDialog)需要创建一个自定义对话框。这真的是将editText放入alertDialog的唯一方法吗？我不想采取超出完成简单任务所需的步骤。最后应该是这样的：

```
------------------------
-Please enter your name-
- [                   ]-
-         (Save)       -
------------------------ 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-09-17T21:39:45.180

```
AlertDialog.Builder alert = new AlertDialog.Builder(this);

alert.setTitle("Title");
alert.setMessage("Message");

// Set an EditText view to get user input 
final EditText input = new EditText(this);
alert.setView(input); 
```

这样您就不必创建新的自定义对话。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-09-17T21:41:22.163

是的，这是目前执行此操作的正确（并且可能是唯一）方法。

像这样的东西：

```
final EditText input = new EditText(this);
AlertDialog.Builder alert = new AlertDialog.Builder(this)
    .setTitle("Please enter your name")
    .setView(input) // Use our EditText
    .setPositiveButton("Save", new DialogInterface.OnClickListener() {
        public void onClick(DialogInterface dialog, int which) {
            // Save value of `input.getText()`
        }
    }).show(); 
```

这是我不时使用的[此博客](http://www.androidsnippets.com/prompt-user-input-with-an-alertdialog)中代码的自定义版本。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-10-04T07:43:23.083

你不仅可以放EditText，还可以放任何你想要的东西。只需为您想要放置的内容创建一个 XML 布局，然后按照链接中所示使用它：-

[如何获得自定义的警报对话框，如图所示？](https://stackoverflow.com/questions/12721828/how-to-get-customized-alert-dialog-like-the-one-shown-in-image/12721965#12721965)

请参阅我给出的答案（Aamir Shah）

希望解释是有用的......

# c# - 手动运行 Xna 内容管道时检测到 PInvokeStackImbalance

> ID：12467458
> 
> 赞同：1
> 
> 时间：2012-09-17T21:35:58.013
> 
> 标签：c#, xna

所以我正在运行这段代码

```
 static readonly string[] PipelineAssemblies =
        {
            "Microsoft.Xna.Framework.Content.Pipeline.FBXImporter" + XnaVersion,
            "Microsoft.Xna.Framework.Content.Pipeline.XImporter" + XnaVersion,
            "Microsoft.Xna.Framework.Content.Pipeline.TextureImporter" + XnaVersion,
            "Microsoft.Xna.Framework.Content.Pipeline.EffectImporter" + XnaVersion,
            "Microsoft.Xna.Framework.Content.Pipeline.XImporter" + XnaVersion,
            "Microsoft.Xna.Framework.Content.Pipeline.AudioImporters" + XnaVersion,
            "Microsoft.Xna.Framework.Content.Pipeline.VideoImporters" + XnaVersion,

        }; 
```

中间有更多代码.....

```
 // Register any custom importers or processors.
        foreach (string pipelineAssembly in PipelineAssemblies)
        {
            _buildProject.AddItem("Reference", pipelineAssembly);
        } 
```

中间有更多代码.....

```
 var execute = Task.Factory.StartNew(() => submission.ExecuteAsync(null, null), cancellationTokenSource.Token);
        var endBuild = execute.ContinueWith(ant => BuildManager.DefaultBuildManager.EndBuild());

        endBuild.Wait(); 
```

基本上尝试使用代码构建内容项目......如果您删除 XImporter、AudioIMporters 和 VideoImporters，这很有效，但是我收到以下错误：

检测到 PInvokeStackImbalance 消息：对 PInvoke 函数 'Microsoft.Xna.Framework.Content.Pipeline!Microsoft.Xna.Framework.Content.Pipeline.UnsafeNativeMethods+AudioHelper::GetFormatSize' 的调用使堆栈不平衡。这可能是因为托管 PInvoke 签名与非托管目标签名不匹配。检查 PInvoke 签名的调用约定和参数是否与目标非托管签名匹配。

堆栈跟踪 ![堆栈跟踪](../Images/09197c517619682296334e2c51877b91.png)

我尝试过的事情：

1.  打开不安全代码
2.  添加大量日志记录（找到 dll 以防您想知道）
3.  不同的 wav 和 Mp3 文件（以防万一）
4.  同步构建

更新：不仅有一个错误，还有一些指向不同方法的类似错误将更新... 更新 2：这个问题可能与我用来构建内容项目的目标有关。

# ruby-on-rails - 更改设计中的错误消息

> ID：12467459
> 
> 赞同：0
> 
> 时间：2012-09-17T21:36:05.603
> 
> 标签：ruby-on-rails, ruby, ruby-on-rails-3, devise

我正在尝试更改设计中的特定错误消息，但在语言环境中看不到它

当用户第二次访问通过电子邮件发送的确认链接时会发生此错误：

“确认令牌无效”

有任何想法吗？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-09-16T21:39:01.670

这可能取决于您的设计版本，但我可以在我的设计语言环境文件中看到这一点：

```
errors:
  messages:
    already_confirmed: "was already confirmed, please try signing in" 
```

另外，请查看[这个问题](https://stackoverflow.com/questions/808547/fully-custom-validation-error-message-with-rails)和[Devise wiki](https://github.com/plataformatec/devise/wiki/_pages)。他们都是一个巨大的帮助。

# android - 多个 apk，Google TV 和 Android 手机/平板电脑应用的单一列表在 Play 商店

> ID：12467464
> 
> 赞同：2
> 
> 时间：2012-09-17T21:36:31.657
> 
> 标签：android, google-play, google-tv, android-market-filtering

我有一个 Android 手机/平板电脑 apk，目前在 Play 商店中，并且在其清单文件中有这些设置：

```
package="com.company.xyz"
android:versionCode="0803010008"
android:versionName="01.00.08" >

<uses-sdk
    android:minSdkVersion="8"
    android:targetSdkVersion="8" />

<uses-permission android:name="android.permission.INTERNET" />
<uses-permission android:name="android.permission.ACCESS_NETWORK_STATE" />
<uses-permission android:name="android.permission.RECEIVE_BOOT_COMPLETED" />
<uses-permission android:name="android.permission.WAKE_LOCK" />

<uses-library
    android:name="com.adobe.flashplayer"
    android:required="true" />

<supports-screens
    android:anyDensity="true"
    android:largeScreens="true"
    android:normalScreens="true"
    android:smallScreens="false"
    android:xlargeScreens="true" />

<uses-feature
    android:name="android.hardware.touchscreen"
    android:required="true" /> 
```

我已经为 GoogleTV 上传了另一个 apk，它与之前的 apk 具有相同的包名称 com.company.xyz，并且在其清单文件中具有以下设置：

```
package="com.company.xyz"
android:versionCode="1203010001"
android:versionName="01.00.01" >

<uses-sdk
    android:minSdkVersion="12"
    android:targetSdkVersion="12" />

<uses-permission android:name="android.permission.INTERNET" />
<uses-permission android:name="android.permission.ACCESS_NETWORK_STATE" />
<uses-permission android:name="android.permission.WAKE_LOCK" />

<uses-feature
    android:name="android.hardware.touchscreen"
    android:required="false" />

<uses-feature
    android:name="com.google.android.tv"
    android:required="true" />

<supports-screens
    android:largeScreens="true"/>

<uses-configuration android:reqFiveWayNav="true" /> 
```

Google TV apk 从未出现在 GTV 盒子上的 Play 商店中，因此我使用以下设置更新了它的清单，其他一切都保持不变

```
package="com.company.xyz"
android:versionCode="1203010002"
android:versionName="01.00.02" >

<supports-screens
    android:largeScreens="true"
    android:normalScreens="false"
    android:smallScreens="false"
    android:xlargeScreens="false" /> 
```

此时，由于 Play 商店错误“错误：新 APK 版本低于以前的 APK 版本”，我无法保存应用程序，即使 GoogleTV APK 的版本代码高于手机/平板电脑版本。有人对此有解决方案吗？

谢谢！

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-09-18T12:51:43.573

这些解决方案是由 Google TV DevRel 团队提出的。

我不小心在 libs 下添加了 armeabi 文件夹。这让 Google TV Play 商店认为该应用使用了 NDK 并且该应用被过滤掉了。

我必须做出的另一个改变是更换

```
<supports-screens
   android:largeScreens="true"
   android:normalScreens="false"
   android:smallScreens="false"
   android:xlargeScreens="false" /> 
```

和

```
<supports-screens android:largeScreens="true"/> 
```

并创建更新版本的 apk。设置所有支持屏幕属性会使大型设备选择错误的 apk。

在此之后，我上传并激活了 1203010003，然后停用了旧版本 1203010001 和 1203010002。然后我能够成功保存 apk，而不会遇到“错误：新 APK 版本低于以前的 APK 版本”

希望这对其他人有帮助！

# asp.net-mvc-3 - 无法通过模型和 viewbag 元素正确使用 DropDownListFor

> ID：12467465
> 
> 赞同：1
> 
> 时间：2012-09-17T21:36:34.300
> 
> 标签：asp.net-mvc-3, razor

我在`ViewBag`元素中设置了一个位置列表，如下所示：

```
 public ActionResult Create()
    {
        var db = new ErrorReportingSystemContext();
        IEnumerable<SelectListItem> items = db.Locations
          .AsEnumerable()
          .Select(c => new SelectListItem
          {
              Value =c.id.ToString(),
              Text = c.location_name
          });
        ViewBag.locations = items;
        return View();
    } 
```

我试图从这样的视图中获取 ViewBag.locations 的值

```
 @Html.DropDownListFor(model => model.location_fk_id, ViewBag.locations);
    //@Html.DropDownListFor(model => model.location_fk_id, @ViewBag.locations);
    //@Html.DropDownListFor(model => model.location_fk_id, "locations"); 
```

但无济于事。我该如何使用它？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-09-17T21:39:53.207

如果你这样做，你只需要投射它：

```
@Html.DropDownListFor(model => model.location_fk_id, (IEnumerable<SelectListItem>)ViewBag.locations) 
```

# objective-c - 如何通过单击图像进行导航？

> ID：12467469
> 
> 赞同：0
> 
> 时间：2012-09-17T21:37:05.110
> 
> 标签：objective-c, ios

在我的应用程序中，我为每个图像动态创建了 imageView，并将它们放在滚动视图中。如何通过单击每个图像来生成执行导航操作的事件？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-09-17T21:54:00.793

**快速且易于实施**

并使用. `UITapGestureRecognizer`_`UIImageView``addGestureRecognizer`

```
UITapGestureRecognizer *singleTap = [[UITapGestureRecognizer alloc] initWithTarget:self action:@selector(imageViewTapped:)];
singleTap.numberOfTapsRequired = 1;
singleTap.numberOfTouchesRequired = 1;
[theImageView addGestureRecognizer:singleTap];
[theImageView setUserInteractionEnabled:YES]; 
```

现在点击视图时会触发以下内容：

```
- (void)imageViewTapped:(UIGestureRecognizer *)gestureRecognizer {
    NSLog(@"%@", [gestureRecognizer view]);
} 
```

**替代解决方案**

```
-(void)touchesBegan:(NSSet *)touches withEvent:(UIEvent *)event {
    if ([[touches anyObject] view] == theImageView)
    {
        // ImageView tapped.
    }
} 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-09-17T21:55:16.607

**使用`UIGestureRecognizer`**. 在您的情况下，只需`UITapGestureRecognizer`在每个`UIImageView`. **不要忘记打开`userInteractionEnabled`**您`UIImageView`的电源，以便考虑水龙头。

```
UITapGestureRecognizer* tapGR = [[UITapGestureRecognizer alloc] initWithTarget:self action:@selector(imageViewAction:)];
[imageView addGestureRecognizer:tapGR];
imageView.userInteractionEnabled = YES;

-(void)imageViewAction:(UITapGestureRecognizer*)tapGR
{
    UIImageView* imageView = tapGR.view;
    // Do something with your imageView
} 
```

**阅读[iOS 的事件处理指南（Apple Doc）](http://developer.apple.com/library/ios/documentation/EventHandling/Conceptual/EventHandlingiPhoneOS/GestureRecognizers/GestureRecognizers.html#//apple_ref/doc/uid/TP40009541-CH6-SW1)**，了解有关手势识别器如何工作以及如何使用它们以及示例和内容的详细信息。这份 Apple 指南非常值得一读，其中包含非常有用的概念和解释。

# iphone - 在 CSS3 中均匀分布菜单选项卡

> ID：12467470
> 
> 赞同：0
> 
> 时间：2012-09-17T21:37:09.253
> 
> 标签：iphone, html, css

如何在 CSS3 中均匀分布菜单选项卡。有三个标签和一个标签，标签二和三之间的间隙明显比标签一和标签二更大？

[对齐顶部 http://www.kerrydeaf.com/tabs_uneven.png](http://www.kerrydeaf.com/tabs_uneven.png "工具提示")

```
 ul.tabsmenu{ padding:5px 0 0 0; position:relative; bottom:-1px;}
  ul.tabsmenu li a{ width:31.2%; float:left; padding:12px 0 12px 0; margin:0 2% 0 0;color:#000000;text-align:center; 
  -moz-border-radius-topleft:5px;-webkit-border-top-left-radius:5px;-khtml-border-top-left-radius:5px;
  -moz-border-radius-topright:5px;-webkit-border-top-right-radius:5px;-khtml-border-top-right-radius:5px;
  background:-moz-linear-gradient(top, #ececec 0%, #ffffff 100%);background: 
  -webkit gradient(linear, 0% 0%, 0% 100%, from(#ececec), to(#ffffff)); }
  ul.tabsmenu li:last-child a{ float:right; margin:0 0 0 0;}
  ul.tabsmenu li.active a{border-bottom-color:#fff; color:#48c4d2; 
  font-weight:bold; background: -moz-linear-gradient(top, #e4f6f8 0%, #ffffff 100%);background: -webkit-gradient(linear, 0% 0%, 0% 100%, from(#e4f6f8), to(#ffffff)); }
  .tabcontent{ padding:5% 4%; clear:both; border:1px #bfeaf0 solid; margin:0 0 15px 0; /* ddd darker grey. border:1px #bfeaf0 solid; */
  -moz-border-radius-bottomleft:5px;-webkit-border-bottom-left-radius:5px;-khtml-border-bottom-left-radius:5px;
   -moz-border-radius-bottomright:5px;-webkit-border-bottom-right-radius:5px;-khtml-border-bottom-right-radius:5px; 
```

}

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-09-17T23:41:06.870

用于`inline-block`列表项并在除第一个之外的所有项上设置左边距。左边距的值为`(100% - 3*31.2%)/2 = (100% - 93.6%)/2 = 6.4%/2 = 3.2%`

# [演示](http://codepen.io/thebabydino/pen/gwJEj)

```
<ul class='tabsmenu'>
  <li><a href='#'>Tab one</a></li>
  <li><a href='#'>Tab two</a></li>
  <li class='active'><a href='#'>Tab three</a></li>
</ul>
<ul class='tabcontent'>
  <li><!-- content--></li>
  <li><!-- content--></li>
  <li><!-- content--></li>
</ul> 
```

**CSS**：

```
.tabsmenu{
  padding: 0;
  margin: 0 0 -1px;
  list-style: none;
  text-align: center;
}
.tabsmenu li {
  box-sizing: border-box;
  display: inline-block;
  width: 31.2%;
  border-radius: 5px 5px 0 0;
  background: linear-gradient(#ececec, #fff);
}
.tabsmenu li:not(:first-child) { margin-left: 3.2%; }
.tabsmenu li.active {
  border: solid 1px #bfeaf0;
  border-bottom: solid 1px #fff;
  background: linear-gradient(#e4f6f8, #fff);
  font-weight: bold;
}
.tabsmenu a {
  display: block;
  padding: 12px 0 12px 0;
  color: #000;
  text-decoration: none;
}
.tabsmenu li.active a { color:#48c4d2; }
.tabcontent{
  padding: 5% 4%;
  border: solid 1px #bfeaf0;
  border-radius: 0 0 5px 5px;
  margin: 0 0 15px 0;
} 
```

* * *

或浮动列表项。变化不大：

```
.tabsmenu{
  overflow: hidden;
  padding: 0;
  margin: 0 0 -1px;
  list-style: none;
  text-align: center;
}
.tabsmenu li {
  box-sizing: border-box;
  float: left;
  width: 31.2%;
  border-radius: 5px 5px 0 0;
  background: linear-gradient(#ececec, #fff);
} 
```

* * *

或者使用绝对定位。既然你有每个的宽度，那么你可以很容易地绝对定位它们。将第一个放在`left`( `left: 0`) 处，第三个放在 处`right`，第二个放在`50% - (31.2% / 2) = 50% - 15.6% = 34.%`任一`left`或`right`( `left: 34.4%`) 处。

# [演示](http://codepen.io/thebabydino/pen/LAyCi)

**CSS**改变了第一种方法：

```
.tabsmenu{
  position: relative;
  height: 28px;
  list-style: none;
  text-align: center;
}
.tabsmenu li {
  position: absolute;
  width: 31.2%;
  border-radius: 5px 5px 0 0;
  background: linear-gradient(#ececec, #fff);
}
.tabsmenu li:first-child { left: 0; }
.tabsmenu li:nth-child(2) { left: 34.4%; }
.tabsmenu li:last-child { right: 0; } 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-09-21T15:59:20.480

你的 CSS 中有这个：

```

    ul.tabsmenu li:last-child a{ float:right; 边距：0 0 0 0;}

```

如果您的容器比带有边距的 3 个选项卡更宽，那么它只会在这个选项卡上显示更大的间隙。不要把它浮动到右边——而是把它们都放在左边，要么计算出这些盒子模型的大小并做数学运算，要么使用 box-sizing:border-box 和 33% 的宽度作为选项卡。注意要小心，因为边距不包括在盒子大小中，只有边框和填充所以减少到说 30% 是安全的。

# python - django mysql所有数据消失

> ID：12467471
> 
> 赞同：1
> 
> 时间：2012-09-17T21:37:37.747
> 
> 标签：python, mysql, django

我有一个 django 代码的 git 存储库。Python 2.6 版和 django 1.4 版。今天不小心从我的家用电脑上尝试使用 python 2.7.3 启动 django 应用程序，但发生了一些奇怪的事情。我丢失了数据表中的所有数据。我不确定版本冲突是原因还是其他原因。我怎样才能找出为什么桌子是空的？会不会是mysql的问题？调试这个的最佳策略是什么？数据不是那么重要，但我不希望这种情况再次发生。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-09-17T21:53:08.760

> 我怎样才能找出为什么桌子是空的？会不会是mysql的问题？调试这个的最佳策略是什么？数据不是那么重要，但我不希望这种情况再次发生。

`log`我认为没有彻底调试 Django 安装的唯一方法是通过以下设施将 MySQL 设置为记录所有内容`my.cnf`：

```
[mysqld]
log            = /var/log/mysql/queries.log 
```

然后恢复数据，然后重新启动 MySQL 以使日志记录生效，并再次尝试使用 Python 2.7.4。数据应该会再次消失，但这次您会看到在日志文件中发出了哪些命令。

有了这些命令，您可以尝试查看它们在 Django 代码中的位置。

完全消失看起来像是对模型结构的重新创建，这意味着系统不知何故无法识别数据存在。我不知道任何导致此问题的 Python 或 Django 问题。

您确定您不只是发出刷新/重置命令吗？

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-09-17T21:50:26.130

我不完全明白你的意思

> 今天不小心从我的家用电脑上尝试使用 python 2.7.3 启动 django 应用程序，但发生了一些奇怪的事情”

但是有可能您设法在一个不知道它已经运行过的系统上运行了syncdb？syncdb 不保留任何数据。

如果您计划进行架构更改，您应该考虑使用[South](http://south.aeracode.org/)进行迁移。

# java - REST 是 API，还是：REST 与 Java 接口？

> ID：12467476
> 
> 赞同：4
> 
> 时间：2012-09-17T21:38:04.977
> 
> 标签：java, xml, api, rest, standards

我和一位同事讨论过，他真的很喜欢 REST，但我仍然必须相信它的好处。

我的主要问题是，从消费应用程序的角度来看，我并没有真正将 REST 视为 API 或一般接口。让我详细说明。我们有两个应用程序，其中一个使用 RESTful API 调用另一个。这是使用 JAX-RS 和 RESTeasy 实现的。但是，使用 RESTeasy，基于接口生成 REST 客户端也非常简单。

假设这是一个处理书籍和作者的系统。应用程序需要知道一本书，让我们假设它已经知道一些 ID。

*   在 REST 中，它会调用例如`http://server/book/21`，返回任意有效负载并将其反序列化为`Book`对象。
*   使用 RESTeasy 客户端，我们有一个`BookService`带有方法的接口`Book getBook(int bookId)`，我们只需调用`getBook(21)`并返回一个`Book`对象。

我要说明的一点是，这`BookService`是一个定义明确的接口，您（作为程序员）可以很容易地看到它期望的参数是一个标识符，它将返回一个`Book`对象。使用“just REST”，我们访问一些 URL，我们得到返回的任意数据。没有明确定义的接口，如果不知道来自服务器的内部 URL 信息，您不知道如何构建 URL，您必须“手动”解析 XML（希望使用 XSD）。

另一件事。我提到了书籍和作者。

使用接口时，您可以只有一个`BookService`返回`Book`s 和一个`AuthorService`返回`Author`s。A`Book`可以有一个属性`authorId`，您可以`Author`通过调用`Author getAuthor(int authorId)`.

使用 REST 时，您调用图书 URL 并返回有关作者的一些信息，包括作者的链接。然后，您可以点击链接以获取有关作者的更多信息。但是你怎么知道在哪里可以找到这个链接呢？并且出现了与之前相同的问题：如何构建链接，我如何知道如何解析返回数据？

当将两者混合时，可能会发生奇怪的事情。如果我只想`Book`通过 id 获取，我可能会调用`BookService`（它在内部以任何方式转换为 REST 调用）并获得一个不错的`Book`对象。但是，如果我想获取作者信息，我有 this `String authorLink`，我必须按照它来获取我的`Author`对象。但相反，当我的起点是 an`Author`并使用 检索它时`AuthorService`，我会在指向书籍对象的字符串 (URL) 集合中获得作者所写书籍的链接。

那么为什么 REST 被认为是一种 API？为什么我应该更喜欢 REST 而不是定义明确的 (Java) 接口？以及如何将两者混合？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-09-17T21:58:33.407

无论出于何种原因，没有人以 Roy Fielding 设想的方式使用 REST。所以这是不切实际的。对于懒惰的人来说，这足以不必考虑它。

显然，业界痴迷于为 RPC 发明不同的名称。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-09-17T21:41:23.507

在您选择的搜索引擎上查看[超媒体 API](http://designinghypermediaapis.com/)。

有一些很好的文献可以解释你如何“知道”要调用什么，有什么请求。特别是[HATEOS](http://en.wikipedia.org/wiki/HATEOAS)。

为什么选择超媒体 API？REST 是一个相当松散和淡化的术语。经常执行不正确。最近出现了试图消除这种混淆的热潮，因此出现了“新”术语。正确完成后，您将获得 REST（请参阅超媒体 API）服务的强大功能，该服务具有您熟悉的在 Java/.NET 中使用强类型服务（ala SOAP、RPC）之类的漂亮样式界面

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-09-17T21:43:13.717

REST 不是 API，而更像是一种架构。REST 用于通过现有的 HTTP 协议在 2 个不同的系统之间进行通信。REST 对很多事情都很有意义，也许在你的情况下你不需要使用它。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2012-09-17T22:35:20.987

如果您考虑有关构建分布式应用程序/系统的工具的 REST（架构而非设计或编码风格），而不是使用众所周知且经过验证的概念（在万维网上）来管理应用程序状态的主要意图，那么使用它是有意义的在某些情况下。

当您想将一些处理/计算从一个应用程序移动到某个远程主机（比如说检索书籍列表）时，您可以通过将方法调用（GetBooks）序列化为 SOAP 消息来做到这一点，然后将该消息添加到 http 请求等中。 . 或者您可以调用 GET /books.. 在某些情况下，使用 ti 以第二种方式便宜得多。如果我提到了一些其他的东西，比如资源缓存，它是基础设施的一部分，而不是当你想要相同资源的不同表示时，它是显式实现的或灵活性，那么它甚至会更有意义。

如果某些服务使用 REST 风格并且编写得很仔细（就像任何 API 一样），那么它很容易理解和使用。这些类型的服务也可以很容易地从没有像 JAX-WS 或 WCF 这样的框架的不同类型的客户端（javascript、php、..）中使用。

为简化起见，您可以将 REST 服务视为书架，您可以从中获取一些书籍（资源），您可以在其中发布新书或放置您获得的书籍.. 如果每个资源在问题域方面有意义，并且如果资源表示包含指向相关资源的链接，而不是我看不到理解/使用它的问题。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2012-09-18T01:54:07.230

您误解了 REST 的关键部分。在一个设计良好的 RESTful 系统中，有两件事必须有很好的文档记录：

1.  用于开始与系统交互的入口点（或“酷”URI）
2.  在请求中发送并在响应中返回的有效负载数据的模式（在 HTTP 术语中，这些是媒体类型）

**只要给我这两件事**，我就能为你的 RESTful API 构建一个客户端。从#1 开始并使用#2 的知识来找到解决系统API“超链接”的方法，我将能够找到我需要的资源。

了解您的系统`Book`表示将允许我进行 GET 调用来检索并理解它，或者进行 POST 或 PUT 调用来创建一个。HTTP 开箱即用地支持这些动词，我只需要知道通过网络发送的内容（#2 告诉我）。

如果我不喜欢 XML，我可以尝试询问服务器是否可以使用 JSON，而 HTTP 支持开箱即用的那种内容协商。

REST 不是独角兽制造的魔法粉，它不会仅仅因为被使用就能解决你的问题。然而，它是一种常识性架构，它试图利用现有的经过充分验证、易于理解、可扩展和灵活的技术和方法。

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2012-09-18T11:12:47.400

`ReST`是一种架构风格，而不是 API。

使用 ReST 获得的一些优势

1.  多响应类型能力（例如：JSON、XML） ReST 不像 SOAP 那样绑定到 XML
2.  使用 JSON 使您的有效负载轻量级并且您的服务更快
3.  更容易开发和测试
4.  ReST 使用纯 HTTP，因此没有与代理相关的问题

关于服务定义，您可以`wadl`为您的 ReST 服务生成一个文件以查看完整选项。大多数服务器会自动生成这些。无论是 SOAP 还是 ReST，服务都需要有很好的文档记录。您可以查看[LinkedIn ReST API](https://developer.linkedin.com/documents/profile-api)。

我看到 SOAP 的唯一优势是 SOAP 可以提供的安全特性。但并非所有应用程序都需要这种级别的安全性。

* * *

## 回答 #7

> 赞同：0
> 
> 时间：2012-09-17T22:08:59.847

简而言之，REST API 对于其他编程语言是灵活的。

我不熟悉 RESTEasy，但熟悉 RESTful 服务。REST 没有标准。大多数 REST 服务都会发布如何与其 REST API 交互。可用的 URL（资源）、要发送的内容类型以及将返回的类型。好的也会公布会返回什么http状态码以及如何处理错误。在您的情况下，我想知道 REST Easy 客户端在做什么。它只是将 API 调用转换为 HTTP 请求并为开发人员处理所有事情吗？

我们记录我们的 REST API 调用并提供一个包含所有模型的 jar 文件。这些模型使用 JAXB 注释，因此开发人员无需了解有关从服务返回的 XML 或 JSON 的所有信息。也就是说，如果他们使用 Java 和我们的模型。发布和记录 API 的好处是其他语言的开发人员可以使用该服务，前提是他们可以发出 HTTP 请求。这允许开发人员以几乎任何编程语言开发客户端应用程序。（最近似乎有更多的 C# 实现）。

除了提供模型的 jar 文件外，我们还在我们的文档中为非 Java 开发人员提供了 XSD。

# php - 如何获取图像裁剪的坐标

> ID：12467480
> 
> 赞同：0
> 
> 时间：2012-09-17T21:38:23.473
> 
> 标签：php, javascript, image

我正在尝试实现 YUI 图像裁剪器。我对 Javascript 几乎一无所知——显然很难理解它是如何工作的。谁能指出我正确的方向，以便能够获取图像裁剪区域的坐标，以便我可以将这些传递给 PHP 脚本以在将图像保存到文件之前进行裁剪。到目前为止，我得到了我想要裁剪的图像以及我可以拖动并使用手柄来放大和缩小的裁剪区域：

```
<script>
// Create a YUI sandbox on your page.
YUI().use('node', 'event', function (Y) {
// The Node and Event modules are loaded and ready to use.

var imgCrop = new YAHOO.widget.ImageCropper('crop1',
 { 
           minHeight: 100,
           minWidth: 200,
           initHeight: 100,
           initWidth: 200
        });

        var cropArea = imgCrop.getCropCoords();

});
</script>

<?php

<img src='$approve' id='crop1' />

?> 
```

任何提示和指针将不胜感激，因为使用 YUI 被证明是困难的。谢谢

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-09-17T22:01:04.983

首先，您可以使用 PHP 裁剪图像，那么为什么还要麻烦您不熟悉的语言呢？

其次，您裁剪图像的目的是什么？缩略图？

这是一个您可能会从中受益的示例。这将创建原始图像的 100x100（调整大小和裁剪）缩略图。

```
if(preg_match('/[.](jpg)$/', $tfile)) {
    $image = imagecreatefromjpeg($ufile);
} else if (preg_match('/[.](gif)$/', $tfile)) {
    $image = imagecreatefromgif($ufile);
} else if (preg_match('/[.](png)$/', $tfile)) {
    $image = imagecreatefrompng($ufile);
}
$oldx = imagesx($image);
$oldy = imagesy($image);
if ($oldx > $oldy) {
    $offx = ($oldx-$oldy)/2;
    $offy = 0;
    $oldx = $oldy;
} elseif ($oldy > $oldx) {
    $offx = 0;
    $offy = ($oldy-$oldx)/2;
    $oldy = $oldx;
} else {
    $offx = 0;
    $offy = 0;
}
$newim = imagecreatetruecolor(100, 100);
imagecopyresampled($newim, $image, 0, 0, $offx, $offy, 100, 100, $oldx, $oldy); 
```

# java - 使用 LocalServiceUtils 将用户组添加到角色 - Liferay 5.2.3

> ID：12467487
> 
> 赞同：1
> 
> 时间：2012-09-17T21:38:46.560
> 
> 标签：java, liferay, roles, usergroups

我正在寻找一种将用户组添加到角色的方法。我在 API 或 liferay 论坛中找不到解决方案。用户组可能有类似的事情吗？

```
GroupLocalServiceUtil.addRoleGroups(portalrole.getRoleId(), grouplist); 
```

它仅适用于团体。RoleLocalServiceUtil、UserGroupLocalServiceUtil 等没有这样的一些方法。

环境：Liferay。5.2.3

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-02-28T17:51:56.543

以这种方式尝试

```
UserGroup ug = UserGroupLocalServiceUtil.getUserGroup(PortalUtil.getCompanyId(request), "your_user_group_name");

long [] ugIds = {ug.getGroup().getGroupId()};

GroupLocalServiceUtil.addRoleGroups(yourRoleId, ugIds ); 
```

# centos - PHP-FPM 进程保持 MongoDB 连接状态

> ID：12467488
> 
> 赞同：1
> 
> 时间：2012-09-14T20:11:22.420
> 
> 标签：centos, nginx, php, mongodb

对于我们服务器堆栈的相关部分，我们正在运行：

*   NGINX 1.2.3
*   PHP-FPM 5.3.10 和 PECL mongo 1.2.12
*   MongoDB 2.0.7
*   CentOS 6.2

当 MongoDB 服务器消失（崩溃、被杀死等）时，我们会遇到一些奇怪但可预测的行为。即使`try/catch`在连接代码周围有一个块，即：

```
try
{
    $mdb = new Mongo('mongodb://localhost:27017');
}
catch (MongoConnectionException $e)
{
    die( $e->getMessage() );
}

$db = $mdb->selectDB('collection_name'); 
```

根据已经连接到 mongo 的 PHP-FPM 工作人员，连接状态被缓存，导致进一步的异常未处理，因为`$mdb`无法使用连接处理程序。令人不安的是，在`try`相当长的一段时间内，最多 15 分钟后，当 php-fpm 进程死亡/重生时——我假设——时，它并没有持续失败。

本质上，行为是，当您遇到尚未连接到 mongo 的工作人员时，您会收到上面的 die 消息，而当您连接到已连接的工作人员时，您会收到未处理的异常，`$mdb->selectDB('collection_name');`因为 catch 没有运行。

当 PHP 是单个进程时，即通过带有 mod_php 的 Apache，这种行为不会发生。只是为了后代，此时回到 Apache/mod_php 不是我们的选择。

有没有办法解决这种行为？我不希望不同 php-fpm 进程之间的连接状态不一致。

**编辑：** 当我等待驱动程序在这方面得到修复时，我当前的解决方法是进行快速轮询以确定驱动程序是否可以处理请求，然后加载或不加载 MongoDB 库/运行查询（如果它无法连接） /询问：

```
try
{
    // connect
    $mongo = new Mongo("mongodb://localhost:27017");

    // try to do anything with connection handle
    try
    {
        $mongo->YOUR_DB->YOUR_COLLECTION->findOne();
        $mongo->close();
        define('MONGO_STATE', TRUE);
    }
    catch(MongoCursorException $e)
    {
        $mongo->close();
        error_log('Error connecting to MongoDB: ' . $e->getMessage() );
        define('MONGO_STATE', FALSE);
    }
}
catch(MongoConnectionException $e)
{
    error_log('Error connecting to MongoDB: ' . $e->getMessage() );
    define('MONGO_STATE', FALSE);
} 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-09-15T13:35:27.360

PHP mongo 驱动程序连接代码在 1.3 版本中进行了大修，在撰写本文时目前处于 beta2 版本。根据您的描述，您的问题可能会通过以下修复得到解决：

[https://jira.mongodb.org/browse/PHP-158](https://jira.mongodb.org/browse/PHP-158)

[https://jira.mongodb.org/browse/PHP-465](https://jira.mongodb.org/browse/PHP-465)

发布后，您将能够在此处查看完整的修复列表：

[https://jira.mongodb.org/browse/PHP/fixforversion/10499](https://jira.mongodb.org/browse/PHP/fixforversion/10499)

或者，也可以在[PECL 网站上](http://pecl.php.net/package/mongo/1.3.0beta2)。如果您可以测试 1.3 并确认您的问题仍然存在，那么我相信驱动程序开发人员很乐意在 1.3.0 发布之前收到您的来信，特别是如果它很容易重现的话。

# ruby - Why is ruby not raising the exception?

> ID：12467490
> 
> 赞同：1
> 
> 时间：2012-09-17T21:38:56.253
> 
> 标签：ruby, exception-handling

I have the following code:

```
require 'open-uri'

class CustomException < StandardError;end

def file
  f = Kernel.open('http://i.dbastatic.dk/images/2/68/500656768_20012012182407_0401_2.jpg')
  return f
rescue => e
  raise CustomException.new(e.message)
end 
```

Now if I do the following:

```
begin
  file.body
rescue CustomException
  puts "rescued it!"
end 
```

I get:

> NoMethodError: undefined method `body' for nil:NilClass

Instead of the the CustomException with the 404 error message from open uri. The strange thing is, that if I instead do:

```
begin
  f = file
  f.body
rescue CustomException
  puts "rescued it!"
end 
```

Then it works, I get the CustomException, that I can catch, before it's trying to do the .body. I don't get why? And how can I change the file-method to do as I expect?

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-09-17T21:48:20.610

Just a little modification to show the problem:

```
require 'open-uri'

def file
  f = Kernel.open('fill_in_some_url_that_returns_a_404')
  return f
rescue => e
  puts e.message
  1 ##<<---- inserted
end

file.body 
```

No you get a `undefined method 'body' for 1:Fixnum`

Explanation: Your method does the `puts e.message`, but it does not return a result (or in other words: it returns `nil`.)

With `file.body` you call `file` (with the result `nil`). and on this result you call `body`. But this does not exist for `nil`. So you get the error `undefined method 'body' for nil:NilClass`

If I try

```
f = file
f.body 
```

I get the same error.

Are you sure, you use the same url in both calls? If you can open your url, the you retrun a valid object.

* * *

Actually I can't see your problem without more code.

You could check your code for one thing:

If you define a variable *and* a method `file`, then you get the variable. See example below. Perhaps this is the problem.

```
file = nil
def file
  1
end

file.body   #undefined method `body' for nil:NilClass (NoMethodError)
file().body #undefined method `body' for 1:Fixnum (NoMethodError) 
```

To be sure to get the method you can try `file()`.

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-09-17T23:12:19.853

I think you've confused yourself. The only code you've shown that seems to illustrate the problem is this:

```
require 'open-uri'

class CustomException < StandardError;end

def file
  f = Kernel.open('http://www.google.com/blahblah')
  return f
rescue => e
  raise CustomException.new(e.message)
end

begin
  file.body
rescue CustomException
  puts "rescued it!"
end 
```

Well, I ran that code, and I got "rescued it!" Isn't that what one would expect? I never get `NoMethodError: undefined method body for nil:NilClass` and I don't believe that you do, either, with the code you show.

So what's the problem, really? Is it that the 404 message isn't getting passed out to stdout? If that's what you wanted, you should have written:

```
require 'open-uri'

class CustomException < StandardError;end

def file
  f = Kernel.open('http://www.google.com/blahblah')
  return f
rescue => e
  raise CustomException.new(e.message)
end

begin
  file.body
rescue CustomException => e
  puts "rescued it!", e.message
end 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-09-17T22:17:52.243

This is probably what you want:

```
require 'open-uri'

def file(url)
 begin
  Kernel.open(url)
 rescue => e
  puts e.message
 end
end 
```

Let's try a valid url first:

```
f = file('http://www.google.com/')
puts f.read if !f.nil? 
```

And now let's try it with a url that returns a 404:

```
f = file('http://www.google.com/blahblah')
puts f.read if !f.nil? 
```

Edit: Your code raises two errors when called on non-existing URLs. The 'file' method raises a OpenURI::HTTPError, while the 'body' method will raise a NoMethodError because it's called on nil. In your first usage example, you raise those two errors in one statement. In the second usage example, the errors are sequential. Still, they should yield the same result and they do for me.

# regex - 正则表达式解析小说文本

> ID：12467499
> 
> 赞同：0
> 
> 时间：2012-09-17T21:39:29.407
> 
> 标签：regex, file-io

我正在尝试从包含小说文本的文件中读取。我想阅读每个连续的单词，但当然，小说中有标点符号这一事实使这变得困难。

我只需要阅读小说中的单词，因此请忽略“，”“！”之类的字符。和“？”，但我需要包含某些非字母字符，例如实际上是单词一部分的撇号。

我对正则表达式不是很好，但我的感觉是这个正则表达式只抓取字符，但不考虑撇号：

```
[^A-Za-z]+ 
```

谁能帮我得到一个正则表达式，它将用单词分隔，忽略标点符号，但保留撇号和其他构成单词的字符？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-09-17T21:49:14.073

您的模式应如下所示：

`\b[a-zA-Z]+[\']*[a-zA-Z]*\b`

它考虑了单词边界并允许使用 1 个撇号。其他特殊字符可以放在第二组方括号中。

* * *

## 回答 #2

> 赞同：-1
> 
> 时间：2012-09-17T21:44:46.917

`[]`只需在括号内包含您想要包含的其他特殊字符。某些字符可能需要转义。我在下面为您添加了撇号：

```
/([^A-Za-z']+)/ 
```

# php - 是否有一个 AJAX / php 库来创建类似配置器的页面（多选和动态预览）？

> ID：12467500
> 
> 赞同：0
> 
> 时间：2012-09-17T21:39:34.167
> 
> 标签：php, ajax, web-applications

我想构建一个网页（后端是通常的 LAMP 堆栈），它的行为应该类似于某种配置器。将向用户呈现多项选择（单选按钮，类似于功能，即所有选项同时可见并且活动的选项被突出显示），他的选择将决定页面上将呈现哪些进一步的多项选择，等等遍历某种决策树。

除此之外，同一页面将包含某种输出，这些输出将随着用户所做的每一个选择而不断更新（使用服务器生成的内容）。

是否有一些库或其他软件（在 php 端或浏览器端）可以帮助我全部或部分实现这个东西？

*[我只知道jQuery，我正在学习并开始第一次使用它，前端和后端都没有太多其他内容]*

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-09-17T22:21:18.490

这与链式选择非常相似，但将选择标签更改为单选标签。但你也想要一些额外的输出..

首先尝试本教程，将选择输入更改为单选，并学习一些 jQuery 以了解如何获得所需的额外输出。

[http://www.script-tutorials.com/creating-ajaxy-chained-selects-with-jquery/](http://www.script-tutorials.com/creating-ajaxy-chained-selects-with-jquery/)

# jquery - 如何让我的 D3 地图缩放到某个位置？

> ID：12467504
> 
> 赞同：5
> 
> 时间：2012-09-17T21:39:47.763
> 
> 标签：jquery, zooming, d3.js, pan

我正在使用 D3，到目前为止，我已经能够调整叶绿素示例以仅绘制特定状态。这涉及简单地删除所有其他多边形数据，以便留下我需要的状态。

我从这个开始： ![在此处输入图像描述](../Images/dcab0f28c854b20dc6ea39f040bdbc58.png)

然后对此进行了调整： ![在此处输入图像描述](../Images/d87edca5a2f5dc315bb59d7d9b062f5a.png)

但是，我想做的是在创建时自动平移/缩放地图，以便状态在显示器的前面和中心，如下所示： ![在此处输入图像描述](../Images/8d70dc497e75ef3ce3d4e1c2270983bc.png)

我是否通过 D3 库执行此操作？或一些独立的代码（我目前使用 d3 运行 jquery-svgpan 以允许手动平移/缩放）以实现这一点？

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-09-19T16:49:49.437

我发现，解决这个问题的最简单方法是根据您要缩放到的状态的边界框，对`g`包含状态的元素（在示例中）设置一个变换：`#states`

```
// your starting size
var baseWidth = 600;

d3.selectAll('#states path')
    .on('click', function(d) {
        // getBBox() is a native SVG element method
        var bbox = this.getBBox(),
            centroid = [bbox.x + bbox.width/2, bbox.y + bbox.height/2],
            zoomScaleFactor = baseWidth / bbox.width,
            zoomX = -centroid[0],
            zoomY = -centroid[1];

        // set a transform on the parent group element
        d3.select('#states')
            .attr("transform", "scale(" + scaleFactor + ")" +
                "translate(" + zoomX + "," + zoomY + ")");
    }); 
```

你可以在这里做更多的事情来清理它 - 为最终缩放留出一些余量，检查是否应该根据宽度或高度进行缩放，根据缩放更改笔触宽度，动画过渡等 - 但这就是基本概念。

# android - 按下主页按钮后，android线程暂停/恢复没有响应

> ID：12467511
> 
> 赞同：0
> 
> 时间：2012-09-17T21:40:13.067
> 
> 标签：android, multithreading, resume, pausing-execution

我正在制作我的第一个 android 游戏，但我的游戏线程有问题。问题是，当我暂停它并按返回或主页按钮时，我得到一个错误。“活动（在我的应用游戏中）没有响应。我的代码：

```
public class GameLoopThread extends Thread {
static final long FPS = 10;
private GameView view;
private boolean running = false;

private Object mPauseLock;
private boolean mPaused;

public GameLoopThread(GameView view) {
    this.view = view;
}

public void setRunning(boolean run) {
    running = run;
    mPauseLock = new Object();
    mPaused = false;

}

@Override
public void run() {
    long ticksPS = 1000 / FPS;
    long startTime;
    long sleepTime;
    while (running) {
        Canvas c = null;
        startTime = System.currentTimeMillis();
        try {
            c = view.getHolder().lockCanvas();
            synchronized (view.getHolder()) {
                view.onDraw(c);
            }
        } finally {
            if (c != null) {
                view.getHolder().unlockCanvasAndPost(c);
            }
        }
        sleepTime = ticksPS - (System.currentTimeMillis() - startTime);
        try {
            if (sleepTime > 0)
                sleep(sleepTime);
            else
                sleep(10);
        } catch (Exception e) {
        }

        synchronized (mPauseLock) {
            while (mPaused) {
                try {
                    mPauseLock.wait();
                } catch (InterruptedException e) {
                }
            }
        }

    }

}

/**
 * Call this on pause.
 */
public void onPause() {
    synchronized (mPauseLock) {
        mPaused = true;
    }
}

/**
 * Call this on resume.
 */
public void onResume() {
    synchronized (mPauseLock) {
        mPaused = false;
        mPauseLock.notifyAll();
     }
   }
  } 
```

我究竟做错了什么？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2017-09-17T08:39:46.213

首先，您是否尝试在应用程序运行时按下电源按钮？如果在您尝试后重新打开应用程序时应用程序仍在运行，那么您的线程代码和表面类就可以了。要解决您的问题（**主页按钮部分**），请将此方法添加到您的 appcompatactivity。

```
public class Game extends AppCompatActivity {
public int i = 0;

@Override
protected void onCreate(Bundle savedInstanceState) {
    super.onCreate(savedInstanceState);

    requestWindowFeature(Window.FEATURE_NO_TITLE);
    getWindow().setFlags(WindowManager.LayoutParams.FLAG_FULLSCREEN,WindowManager.LayoutParams.FLAG_FULLSCREEN);

    setContentView(new YourSurfaceGame(this,"player1"));
}
//Add this override method to your appcompatactivity
@Override
protected void onStart() {
    super.onStart();
    //Re-declare your surface game class is the main solution here
    setContentView(new YourSurfaceGame(this,"player1"));
}

@Override
protected void onPause() {
    super.onPause();
}
} 
```

我花了几个小时才解决了按钮主页问题，尽管当我比较按下主页和电源按钮时我发现了一些奇怪的东西。如果您尝试此代码并开始注意到您的所有游戏进度都消失了，那么[https://www.tutorialspoint.com/android/android_shared_preferences.htm](https://www.tutorialspoint.com/android/android_shared_preferences.htm)就是答案。

我对其他游戏应用程序做了同样的事情，我的结论是正确的。按下主页或电源按钮后，游戏会暂停。实际上，如果您使用线程作为扩展，您会发现这个问题，而当您在主线程类中使用 timertask 作为扩展时，情况就不同了。不过，我以前从未尝试过。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-09-17T21:43:38.273

很可能您的应用程序在恢复时尝试启动已停止的线程。这会导致错误并导致您的应用程序崩溃。

查看您的 Logcat 日志以进行检查。

# android - 使用 DropBox Android API 替换 DropBox 上的文件

> ID：12467512
> 
> 赞同：0
> 
> 时间：2012-09-17T21:40:12.723
> 
> 标签：android, dropbox

我正在开发一个 android 项目并尝试添加下拉框功能。我已经完成了所有工作，我可以成功上传和下载文件而没有任何问题，但是如果我上传一个已经存在的文件，我需要替换它，目前它只会在最后添加一个数字。

例如，我正在上传一个名为 MyFile.txt 的文件。如果我尝试再次上传此文件，而不是替换文件，它将上传为 MyFile(1).txt 和下一次 MyFile(2).txt 等等。

下面是我用来上传文件的代码。

```
File file = new File(Environment.getExternalStorageDirectory() + "/MyApp/dropbox_sync.xml");
FileInputStream inputStream = new FileInputStream(file);
Entry newEntry = mDBApi.putFile("android_sync.xml", inputStream, file.length(), null, null); 
```

如何为每次上传替换此文件，或者我必须使用 API 删除文件然后执行上传。感谢您的任何帮助，您可以提供。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-09-17T22:34:21.597

`putFileOverwrite`可能是你要找的东西？

```
public DropboxAPI.Entry putFileOverwrite(java.lang.String path,
                                     java.io.InputStream is,
                                     long length,
                                     ProgressListener listener)
                              throws DropboxException 
```

将文件上传到 Dropbox。上传将覆盖文件的任何现有版本。

# php - 如何从 PHP 输出 XML 并让它“很好地”显示？

> ID：12467513
> 
> 赞同：0
> 
> 时间：2012-09-17T21:40:13.043
> 
> 标签：php, xml, soap, soap-client

我正在使用 php 的 SOAPClient 类发出 SOAP 请求并获取 SOAP 响应，但我需要在页面上显示请求和响应 xml 以进行调试。问题是，我不知道怎么做。

我可以使用 __getLastRequest() 和 __getLastResponse() 方法来获取 xml 字符串，但我还没有找到一种很好地打印出来的方法。我确实发现 echo'ing`<xmp>[xmlstringhere]</xmp>`将适当的 xml 标签放入字符串中，但没有任何换行符，这是一个问题，因为 xml 响应是巨大的。如果我能在适当的地方换行，并进行适当的缩进，事情就会很顺利。

到目前为止，我一直不得不复制输出的 xml，将其保存为 .xml 文件，然后打开它。有没有办法通过 php 以可读格式输出内容？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-09-17T21:42:59.657

尝试`echo '<pre>' . $client->__getLastRequest() . '</pre>';`

# c++ - 简单的线程安全和快速的内存池实现？

> ID：12467514
> 
> 赞同：0
> 
> 时间：2012-09-17T21:40:37.983
> 
> 标签：c++, multithreading, performance, lock-free

在重新考虑设计并从稻田中获得一些输入之后，我想出了类似的东西，但我想知道它的正确性，当我运行它时似乎很好......这个想法是预分配的对象继承自以下内容：

```
struct Node
{
    void* pool;
}; 
```

这样，我们在每个分配的对象中注入一个指向它的池的指针，以便稍后释放它。然后我们有：

```
template<class T, int thesize>
struct MemPool
{
    T* getNext();
    void free(T* ptr);

    struct ThreadLocalMemPool
    {
        T* getNextTL();
        void freeTL();

        int size;
        vector<T*> buffer;
        vector<int> freeList;
        int freeListIdx;
        int bufferIdx;
        ThreadLocalMemPool* nextTlPool; //within a thread's context a linked list
    };

    int size;
    threadlocal ThreadLocalMemPool* tlPool; //one of these per thread
}; 
```

所以基本上我说它`MemPool<Cat, 100>`给了我一个内存池，对于它的每个线程，`getNexts`它都会实例化一个线程本地内存池。尺寸我在内部四舍五入到最接近的 2 次方，以便轻松取模（为简单起见，我将其省略）。因为`getNext()`对于每个线程都是本地的，所以它不需要锁定，我尝试使用原子作为释放部分，如下所示：

```
T* ThreadLocalMemPool::getNextTL()
{
    int iHead = ++bufferIdx % size;
    int iTail = freeListIdx % size;

    if (iHead != iTail)  // If head reaches tail, the free list is empty.
    {
        int & idx = freeList[iHead];
        while (idx == DIRTY) {}
        return buffer[idx];
    }
    else
    {
        bufferIdx--; //we will recheck next time
        if (nextTLPool)
            return nextTLPool->getNextTL();
        else
            //set nextTLPool to a new ThreadLocalMemPool and return getNextTL() from it..
    }
}

void ThreadLocalMemPool::free(T* ptr)
{
    //the outer struct handles calling this in the right ThreadLocalMemPool

    //we compute the index in the pool from which this pool came from by subtracting from
    //its address the address of the first pointer in this guys buffer
    int idx = computeAsInComment(ptr);

    int oldListIdx = atomic_increment_returns_old_value(freeListIdx);
    freeList[oldListIdx % size] = idx;
} 
```

现在，这个想法是`freeListIdx`总是落后`bufferIdx`于池中，因为你不能（我假设正确使用）释放超过你分配的更多。对 free 的调用会同步它们将缓冲区索引返回到空闲列表的顺序，并且 getNext 将在循环返回时接收到这一点。我一直在考虑它，并没有看到逻辑上有任何语义上的错误，它看起来是正确的还是有一些微妙的东西可以破坏它？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-09-17T22:34:05.937

线程安全问题需要锁定。如果您想放松这一点，您需要只有一个线程使用池的约束。如果您使用我将在下面描述的循环空闲列表，则可以将其扩展到两个线程，条件是一个线程负责分配，另一个线程负责释放。

至于在没有任何其他管理的情况下使用向量，这是一个坏主意……一旦您开始变得支离破碎，您的分配就会受到打击。

实现这一点的一个好方法是分配一个大的 T 块。然后制作一个足够大的循环队列以指向这些块中的每一个。那是你的“自由名单”。您可能只是选择使用索引。如果将每个池限制为 65536 个项目，则可以选择 unsigned short 以节省空间（实际上是 65535 以允许高效的循环队列管理）

通过使用循环队列，您可以在不考虑碎片的情况下进行恒定时间分配和释放。您还知道您的池何时已满（即空闲列表为空），您可以创建另一个池。显然，当您创建一个池时，您需要填写空闲列表。

所以你的班级看起来像这样：

```
template<class T, size_t initSize>
class MemPool
{
    vector<T> poolBuffer;              // The memory pool
    vector<unsigned short> freeList;   // Ring-buffer (indices of free items)
    unsigned short nHead, nTail;       // Ring-buffer management
    int nCount;                        // Number of elements in ring-buffer
    MemPool<T,initSize> *nextPool;     // For expanding memory pool

    // etc...
}; 
```

现在，对于锁定。如果您可以访问原子递增和递减指令并且相当小心，则可以使用线程安全维护空闲列表。唯一需要的互斥锁是当你需要分配一个新的内存池时。

我改变了我原来的想法。您有点需要两个原子操作，并且您需要一个保留的索引值（0xffff）来为队列上的非原子操作旋转：

```
// I'll have the functions atomic_incr() and atomic_decr().  The assumption here
// is that they do the operation and return the value as it was prior to the
// increment/decrement.  I'll also assume they work correctly for both int and
// unsigned short types.
unsigned short atomic_incr( unsigned short & );
int atomic_incr( int & );
int atomic_decr( int & ); 
```

所以分配是这样的：

```
T* alloc()
{
    // Check the queue size.  If it's zero (or less) we need to pass on
    // to the next pool and/or allocate a new one.
    if( nCount <= 0 ) {
        return alloc_extend();
    }

    int count = atomic_decr(nCount);
    if( count <= 0 ) {
        T *mem = alloc_extend();
        atomic_incr(nCount);     // undo
        return mem;
    }

    // We are guaranteed that there is at least 1 element in the list for us.
    // This will overflow naturally to achieve modulo by 65536\.  You can only
    // deal with queue sizes that are a power of 2\.  If you want 32768 values,
    // for example, you must do this: head &= 0x7fff;
    unsigned short head = atomic_incr(nHead);

    // Spin until the element is valid (use a reference)
    unsigned short & idx = freeList[head];
    while( idx == 0xffff );

    // Grab the pool item, and blitz the index from the queue
    T * mem = &poolBuffer[idx];
    idx = 0xffff;

    return mem;
}; 
```

上面使用了一个新的私有成员函数：

```
T * alloc_extend()
{
    if( nextPool == NULL ) {
        acquire_mutex_here();
        if( nextPool == NULL ) nextPool = new MemPool<T>;
        release_mutex_here();
        if( nextPool == NULL ) return NULL;
    }
    return nextPool->alloc();
} 
```

当你想释放时：

```
void free(T* mem)
{
    // Find the right pool to free from.
    if( mem < &poolBuffer.front() || mem > &poolBuffer.back() )
    {
        if( nextPool ) nextPool->free(mem);
        return;
    }

    // You might want to maintain a bitset that indicates whether the memory has
    // actually been allocated so you don't corrupt your pool here, but I won't
    // do that in this example...

    // Work out the index.  Hope my pointer arithmetic is correct here.
    unsigned short idx = (unsigned short)(mem - &poolBuffer.front());

    // Push index back onto the queue.  As with alloc(), you might want to
    // use a mask on the tail to achieve modulo.
    int tail = atomic_incr(nTail);
    freeList[tail] = idx;

    // Don't need to check the list size.  We assume everything is sane. =)
    atomic_incr(nCount);
} 
```

Notice I used the value 0xffff, effectively as a NULL. The setting, clearing and spinning on this value are there to prevent a race situation. You cannot guarantee that it is safe to leave old data in the queue when multiple threads may be calling `free` while you have other threads calling `alloc`. Your queue will be cycling through, but the data in it might not be set yet.

Instead of indices, of course, you could just use pointers. But that is 4 bytes (or 8 bytes on a 64-bit application) and the memory overhead might not be worth it, depending on the data size you are pooling. Personally, I would use pointers, but for some reason it seemed easier to use indices in this answer.

# java - Maven 找不到 org.springframework.ws:spring-ws:1.5.8

> ID：12467515
> 
> 赞同：2
> 
> 时间：2012-09-17T21:41:01.210
> 
> 标签：java, spring, maven, version, spring-ws

当我们尝试使用 org.springframework.wspring-ws 作为 maven 项目中的依赖项时：

```
<dependency>
    <groupId>org.springframework.ws</groupId>
    <artifactId>spring-ws</artifactId>
    <version>1.5.8</version>
</dependency> 
```

没有找到。查看[repo](http://search.maven.org/#artifactdetails%7Corg.springframework.ws%7Cspring-ws%7C1.5.8%7Cpom)，pom 和 jar 都在那里，但是 jar 的名称中有 -all ，例如`spring-ws-1.5.8-all.jar`.

我的问题：首先，如何在 maven pom 中使用它作为依赖项？第二，为什么这个文件是这样命名的？

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-09-18T01:24:08.417

你可以这样做：

```
<dependency>
    <groupId>org.springframework.ws</groupId>
    <artifactId>spring-ws</artifactId>
    <version>1.5.8</version>
    <classifier>all</classifier>
</dependency> 
```

不知道为什么他们有那个分类器。看起来这个库没有其他分类器，所以没有意义。看起来现在有这个库的更高版本：http: [//mvnrepository.com/artifact/org.springframework.ws](http://mvnrepository.com/artifact/org.springframework.ws)

看起来他们已经重新安排了一些东西，所以分类器对于最新版本来说是多余的。

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2012-09-18T04:08:22.280

虽然已经有一个接受的答案，但我仍然想提供一些额外的信息，因为接受的答案提供了一些可能不正确的东西。

您不应该使用 spring-ws-ver-all 作为依赖项。在 Maven 世界中，您应该使用实际的工件作为依赖项（例如 spring-ws-core 等）。

不使用这样的 uber jar 作为依赖的原因之一是，它可能会导致依赖解析出现问题。

例如，假设您依赖于 2 个工件，A 和 B。A 依赖于 spring-ws-core 版本 1.0，B 依赖于 spring-ws-core 版本 1.1。通常，Maven 将解析为在您的类路径中只有一个版本的 spring-ws-core。

However, if A is depending on spring-ws-all (which is the uber jar), Maven have no way to know that is spring-ws-all and spring-ws-core is something conflicting, and you will probably encounter problem because you have both classes from spring-ws 1.0 (from spring-ws-all) and 1.1 (from spring-ws-core).

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-09-17T22:50:52.223

### 如何在 maven pom 中使用它作为依赖项？

~~转到您的 Maven 本地存储库`~/.m2/repository/org/springframework/ws/spring-ws/1.5.8`，将 jar 文件名更改为`spring-ws-1.5.8.jar`.~~ **使用 Lithium 的答案中提到的配置，**或者使用独立的模块 jars spring-ws-core、spring-ws-security 等，而不是这个多合一的 jar。

### 为什么这个文件是这样命名的？

查看源代码[spring-ws/tags/spring-ws-1.5.8](https://fisheye.springsource.org/browse/spring-ws/tags/spring-ws-1.5.8)，它使用 maven-assembly-plugin （[pom.xml line 519](https://fisheye.springsource.org/browse/spring-ws/tags/spring-ws-1.5.8/pom.xml?hb=true)），它使用一个程序集描述符（[src/assembly/all.xml](https://fisheye.springsource.org/browse/spring-ws/tags/spring-ws-1.5.8/src/assembly/all.xml?hb=true)）来构建最终版本，<id>all</id> 被附加到 pom.version 1.5.8 作为[分类器](http://maven.apache.org/plugins/maven-assembly-plugin/assembly-mojo.html#classifier)。

~~我认为这是他们构建脚本中的错误。~~

# html - 当我的主页只是 `/` 时，如何为我的主页设置 HTML5 离线后备？

> ID：12467522
> 
> 赞同：1
> 
> 时间：2012-09-17T21:41:22.427
> 
> 标签：html, offline-caching, cache-manifest, application-cache

作为一个现代数据库驱动的网站，我们的主页只是简单地`/`代替了`/index.html`. 但是当我尝试为我们的主页设置离线后备时，它（按照规范的预期）为网站上的每个资源设置了后备。除了改变回家的道路外，有没有办法防止这种情况发生？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2014-02-13T15:13:47.903

我有同样的问题”。经过 3 个小时的摆弄，我得出了我个人的结论，即应用程序缓存不能仅使用“/”以预测方式工作。

# ios - GWT、mgwt 和视网膜显示

> ID：12467525
> 
> 赞同：3
> 
> 时间：2012-09-17T21:41:35.443
> 
> 标签：ios, gwt, cordova, retina-display, mgwt

我已经实现了一个基于[mgwt](http://mobilegwt.appspot.com/showcase/)和 PhoneGap 的 iOS 应用程序。

我有一张图片

```
<g:Image url="resources/img/topMenuTitle.png"></g:Image> 
```

和两个相应的文件`topMenuTitle.png`（320 像素 x 40 像素）和`topMenuTitle@2x.png`（640 像素 x 80 像素）。

我不知道应用时在视网膜显示中显示图像的最佳方式是什么（即，`topMenuTitle@2x.png`在设备支持视网膜显示时加载等`topMenuTitle.png`）。

到目前为止，我尝试使用[`retina.js`](http://retinajs.com/)但它没有用。我的猜测是 Retinajs 在页面加载的那一刻处理图片，它不处理稍后会显示的图像。

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-09-18T03:41:00.920

对于 mgwt，有一个延迟绑定变量 mgwt.os。它可以有不同的值：

```
<define-property name="mgwt.os" values="iphone, ipad, retina, ipad_retina, android, android_tablet, blackberry, desktop" /> 
```

您可以使用该变量并在您的应用程序中使用不同的资源。看一下在 mgwt 中进行主题化的方式，看看如何提供不同的图像：

[http://code.google.com/p/mgwt/wiki/Styling](http://code.google.com/p/mgwt/wiki/Styling)

如果您正在寻找一种简单的方法来加载图像，您可以执行以下操作：

```
OsDetection d = MGWT.getOsDetection();

Image img = null;
if(d.isRetina() || isIPadRetina()){
  img = new Image("retinaurl");
}else{
  img = new Image("nonretinaurl");
} 
```

当然，更好的方法是使用延迟绑定，但这对于代码中的某些图像是可以的。

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2012-09-17T21:59:19.023

使用延迟绑定。这是一个例子：

[http://retina.teknonsys.com/](http://retina.teknonsys.com/)

# c# - 重击 - Windows 7

> ID：12467526
> 
> 赞同：0
> 
> 时间：2012-09-17T21:41:52.947
> 
> 标签：c#, interop, 16-bit

我正在尝试编写一个非常简单的 thunk，它可以从 16 位 FoxPro 中使用，最终调用 64 位闪亮的 WCF 客户端。

我知道我不能在它们之间传递复杂的数据类型，所以我只想传递一个将写入数据的文件名。

问题是我什至无法让thunk工作。我从

[http://www.codeproject.com/Articles/29727/Generic-Thunk-of-Windows](http://www.codeproject.com/Articles/29727/Generic-Thunk-of-Windows)

但呼吁

```
ghKernelDll = LoadLibrary("kernel.dll"); 
```

返回空值。如果我把 kernel32 放在那里没问题，但这是意料之中的 - 对吧？是因为我在闪亮的 64 桌面上运行这个应用程序吗？我需要什么才能完成这项工作？

谢谢！

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-09-17T22:03:58.553

嗯，这可能与[16 位代码不能在 64 位版本的 Windows 上运行](http://support.microsoft.com/kb/282423)这一事实有关。事实上，据我所知，`kernel.dll`在 64 位 Windows 中甚至不存在。

# php - 需要在赋值前声明属性

> ID：12467529
> 
> 赞同：0
> 
> 时间：2012-09-17T21:42:08.760
> 
> 标签：php, properties, declaration, error-reporting

以下在 php 中是合法的。

```
class Foo{
    function setBar($bar){
        $this->bar = $bar;
    }
} 
```

有没有办法在使用前生成属性`Foo#bar`未声明的通知？我厌倦了浪费时间调试错别字。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-09-17T21:51:05.180

我认为这就是你所追求的：

```
class Foo
{    
  function setBar( $bar )
  {
    $this->bar = $bar;
  }

  public function __set( $name, $value )
  {
    throw new Exception( 'Can not set property ' . $name );
  }    
}

$foo = new Foo();
$foo->setBar( 'bar' ); 
```

这里发生的是，当调用超出范围的类属性时，会调用魔术 __get 或 __set。在那里你可以决定如何处理这种情况。

# orbeon - orbeon xform重复元素问题

> ID：12467535
> 
> 赞同：0
> 
> 时间：2012-09-17T21:42:32.503
> 
> 标签：orbeon, xforms

我正在尝试使用添加按钮在运行/运行时添加一个重复元素。当我单击添加按钮时，我收到错误“功能索引使用不在范围内的重复 id 'employee-repeat'”。我不确定我是否在表单中正确引用了重复元素。这是完整的 x 来自 。

```
 `<xhtml:html xmlns:soap="http://schemas.xmlsoap.org/soap/envelope/"
        xmlns:xxforms="http://orbeon.org/oxf/xml/xforms"
        xmlns:saxon="http://saxon.sf.net/"
        xmlns:xi="http://www.w3.org/2001/XInclude"
        xmlns:xs="http://www.w3.org/2001/XMLSchema"
        xmlns:xxi="http://orbeon.org/oxf/xml/xinclude"
        xmlns:sql="http://orbeon.org/oxf/xml/sql"
        xmlns:xforms="http://www.w3.org/2002/xforms"
        xmlns:exforms="http://www.exforms.org/exf/1-0"
        xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance"
        xmlns:xhtml="http://www.w3.org/1999/xhtml"
        xmlns:fr="http://orbeon.org/oxf/xml/form-runner"
        xmlns:ev="http://www.w3.org/2001/xml-events">
<xhtml:head>
    <xhtml:title>U Form</xhtml:title>
    <xforms:model id="fr-form-model">
       <xforms:instance id="fr-form-instance">
            <form>
                <section-1>
                    <hello/>
                </section-1>
            </form>
        </xforms:instance>

        <xforms:bind id="fr-form-binds" nodeset="instance('fr-form-instance')">
            <xforms:bind id="section-1-bind" nodeset="section-1">
                <xforms:bind id="hello-bind" nodeset="hello" name="hello"/>
            </xforms:bind>
        </xforms:bind>

        <xforms:instance id="fr-form-metadata" xxforms:readonly="true">
            <metadata>
                <application-name>gvhd</application-name>
                <form-name>test</form-name>
                <title xml:lang="en">Untitled Form</title>
                <description xml:lang="en"/>
                <author/>
                <logo mediatype="" filename="" size=""/>
            </metadata>
        </xforms:instance>

        <xforms:instance id="fr-form-attachments">
            <attachments>
                <css mediatype="text/css" filename="" size=""/>
                <pdf mediatype="application/pdf" filename="" size=""/>
            </attachments>
        </xforms:instance>

        <xforms:instance id="fr-form-resources" xxforms:readonly="true">
            <resources>
                <resource xml:lang="en">
                    <section-1>
                        <label>Section1</label>
                        <help/>
                    </section-1>
                    <hello>
                        <label>hello</label>
                        <hint/>
                        <help/>
                        <alert/>
                    </hello>
                </resource>
            </resources>
        </xforms:instance>

        <xforms:instance id="employees-instance">
            <employees>
                <employee>
                    <first-name>Alice</first-name>
                </employee>
                <employee>
                    <first-name>Bob</first-name>
                </employee>
                <employee>
                    <first-name>Marie</first-name>
                </employee>
            </employees>
        </xforms:instance>

        <xforms:instance id="fr-service-request-instance" xxforms:exclude-result-prefixes="#all">
            <request/>
        </xforms:instance>

        <xforms:instance id="fr-service-response-instance" xxforms:exclude-result-prefixes="#all">
            <response/>
        </xforms:instance>

    </xforms:model>
</xhtml:head>
<xhtml:body>
    <fr:view>
        <xforms:label ref="instance('fr-form-metadata')/title"/>
        <fr:body>
            <fr:section id="section-1-section" bind="section-1-bind">
                <xforms:label ref="$form-resources/section-1/label"/>
                <xforms:help ref="$form-resources/section-1/help"/>
                <fr:grid columns="2">
                    <xforms:repeat nodeset="instance('employees-instance')/employee" id="employee-repeat">
                              <xhtml:tr>
                            <xhtml:td>
                                <xforms:output ref="first-name"/>
                            </xhtml:td>
                            <xhtml:td>
                                <xforms:output ref="first-name"/>
                            </xhtml:td>
                        </xhtml:tr>
                                                  </xforms:repeat>
                    <xhtml:tr>
                        <xhtml:td>
                            <xforms:input bind="hello-bind" id="hello-control">
                                <xforms:label ref="$form-resources/hello/label"/>
                                <xforms:hint ref="$form-resources/hello/hint"/>
                                <xforms:help ref="$form-resources/hello/help"/>
                                <xforms:alert ref="$fr-resources/detail/labels/alert"/>
                            </xforms:input>
                        </xhtml:td>
                        <xhtml:td/>
                    </xhtml:tr>
                    <xhtml:tr>
                        <xhtml:td>
                            <xforms:trigger>
                                <xforms:label>Add</xforms:label>
                                <xforms:insert ev:event="DOMActivate" context="instance('fr-form-instance')" nodeset="instance('employees-instance')/employee" at="index('employee-repeat')"
                                               position="after"/>
                            </xforms:trigger>
                        </xhtml:td>
                        <xhtml:td/>
                    </xhtml:tr>
                </fr:grid>
            </fr:section>
        </fr:body>
    </fr:view>
</xhtml:body> 
```

`

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-09-18T09:08:33.580

我已在 Orbeon Sandbox 中运行此代码，但无法重现上述错误。我几乎没有与未声明的变量相关的错误，一旦我声明了变量，表单就会正常呈现，并且我能够添加新行。

但是，从技术上讲，我看到您`index('employee-repeat')`在重复循环之外的 Add 触发器中使用了重复索引，因此您可能遇到了该错误。为了更好地提供帮助，请告诉我您是如何运行这些表单的。

**更新：**根据 OP 评论，这里是更新。

它很容易纠正它。你不应该使用`index('employee-repeat')`.

1.  如果您想在上次使用时添加新行`at=last()`或

2.  如果您想在第一次使用时添加`at=1`或

3.  如果您想在中间添加（您想要的位置），然后将`Add`链接移动到重复中，对于每一行，您将拥有 `Add`在所需位置添加新行的链接。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-09-19T06:29:14.317

您的示例似乎适用于最新的 Orbeon Forms 代码。它运行没有错误，并且“Marie Marie”在按下*添加*按钮时被添加。你用[Orbeon Forms 4.0 M10](http://blog.orbeon.com/2012/08/orbeon-forms-40-m10.html)试过了吗？

（请注意，4.0 M10 是一个*里程碑版本*，它还不是 4.0 最终版本。）

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-09-20T06:50:34.713

根据原始 XF 1.1 建议 Kaipa M Sarma 先生的陈述是正确的，一旦您决定在重复控件之外使用触发按钮，请提及相应的索引，如 last() 或 index = 1 。否则，如果您需要在中间或任何位置插入，您决定在重复中使用按钮 ..

# java - java.lang.NoClassDefFoundError - 使用外部库运行 java 文件

> ID：12467539
> 
> 赞同：2
> 
> 时间：2012-09-17T21:43:07.860
> 
> 标签：java, classpath

我是 java 新手，曾在 netBeans 中使用过它，但从未尝试从终端编译或运行它。所以，我的问题可能看起来很幼稚。我有一个这种结构的目录：

`Folder X`包含：几个文件和一个名为`esa-lucene`.

`esa-lucene`是一个包含三个文件夹的目录`src, lib, web`：

```
.classpath, lib, .project, .settings, src, web 
```

我正在尝试运行`ESAWikipediaIndexer.java`此子目录中存在的 java 文件“”：

```
X/esa-lucene/src/edu/wiki/index/ESAWikipediaIndexer.java 
```

我 cd 进入`Folder X`并使用它：

```
java -cp esa-lucene.jar edu.wiki.index.ESAWikipediaIndexer 
```

但它给了我这个错误：

```
Exception in thread "main" java.lang.NoClassDefFoundError: edu/wiki/index/ESAWikipediaIndexer
Caused by: java.lang.ClassNotFoundException: edu.wiki.index.ESAWikipediaIndexer
    at java.net.URLClassLoader$1.run(URLClassLoader.java:217)
    at java.security.AccessController.doPrivileged(Native Method)
    at java.net.URLClassLoader.findClass(URLClassLoader.java:205)
    at java.lang.ClassLoader.loadClass(ClassLoader.java:321)
    at sun.misc.Launcher$AppClassLoader.loadClass(Launcher.java:294)
    at java.lang.ClassLoader.loadClass(ClassLoader.java:266)
Could not find the main class: edu.wiki.index.ESAWikipediaIndexer. Program will exit. 
```

我还检查了 .classpath 它包含：

```
<?xml version="1.0" encoding="UTF-8"?>
<classpath>
    <classpathentry kind="src" path="src"/>
    <classpathentry kind="con" path="org.eclipse.jdt.launching.JRE_CONTAINER"/>
    <classpathentry kind="lib" path="lib/servlet-api.jar"/>
    <classpathentry kind="lib" path="web/WEB-INF/lib/lucene-analyzers-3.0.0.jar"/>
    <classpathentry kind="lib" path="web/WEB-INF/lib/lucene-core-3.0.0.jar"/>
    <classpathentry kind="lib" path="web/WEB-INF/lib/mysql-connector-java-5.1.12-bin.jar"/>
    <classpathentry kind="lib" path="web/WEB-INF/lib/trove-2.1.0.jar"/>
    <classpathentry kind="output" path="bin"/>
</classpath> 
```

我也检查了`lib`and`web/WEB-INF/lib/`文件夹，所有必需的外部库（jar 文件）也存在于这个文件夹中。

我搜索以找到任何解决方案并尝试了几件事，但都没有奏效。不知道如何使它工作！

顺便说一句，显然人们以前使用过这个包，我也刚刚下载使用它，但到目前为止还没有成功。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-09-17T21:59:21.893

看起来您指的是 Eclipse 类路径和 .project 文件。既然如此，为什么不尝试在 Eclipse 中运行它。

但是，由于您在此处手动运行它，因此未使用类路径文件中的类路径条目。您还可以告诉我们 ESAWikipediaIndexer.java 的 .class 文件在哪里。如果您运行以下命令

> java -cp */esa-lucene.jar edu.wiki.index.ESAWikipediaIndexer

从它所在的目录，它应该可以工作。您还需要在上述命令中提供 esa-lucene.jar 的完整路径或相对路径。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-09-17T22:11:55.373

正如其他人所提到的，您需要确保 ESAWikipediaIndexer.class 文件位于 esa-lucene.jar 中或位于运行 java 命令的目录中的 edu/wiki/index 文件夹结构中。这是你可以做的。查看 jar 文件以确保其中存在 edu/wiki/index 文件夹结构。您可以使用 jar -tvf esa-lucene.jar 或者如果您在 Windows 上，则将 esa-lucene.jar 复制到 esa-lucene.zip 并双击打开它。如果那不是您的 ESAWikipediaIndexer.class 所在的位置，那么它可能位于项目根目录的 bin、build、classes 或 target 文件夹下。许多 IDE 输出到诸如构建/类之类的东西。如果存在类输出，则在上述命令中将构建/类添加到类路径中，例如：java -cp build/classes:esa-lucene.jar edu.wiki.index。

# mysql - SQL JOIN，还是两个选择？

> ID：12467540
> 
> 赞同：0
> 
> 时间：2012-09-17T21:43:08.463
> 
> 标签：mysql, sql, select, join

我正在使用 MYSQL 数据库。

我有以下内容：

```
tbl1

ID(p) | FID(p)
1     7
2     7
2     8
7     2
3     9

tbl2

DATA(p) | ID(f)
AAA      7
BBB      7
CCC      8 
```

我需要从 tbl1 (7, 8) 中选择 ID = 2 的所有 FID 然后我需要选择 ID = 第一个查询结果的所有数据（返回 AAA、BBB、CCC）

这可以在一个或两个查询中完成吗？如果您能指出正确的操作员的方向，我可以解决。

谢谢！

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-09-17T21:46:36.667

```
SELECT b.DATA 
FROM tbl1 a
LEFT JOIN tbl2 b ON b.ID = a.FID
WHERE a.ID = 2 
```

将返回：

```
AAA
BBB
CCC
```

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-09-17T21:45:38.937

正确的运算符是`JOIN`。祝你好运。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-09-17T21:46:43.207

我不太清楚需要加入什么，但类似：

```
SELECT * FROM tbl2 INNER JOIN (SELECT * FROM tbl1 WHERE ID=2) a ON a.FID=tbl2.ID 
```

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2012-09-17T21:49:31.280

您可以使用“INNER JOIN”从多个表中选择多个字段。

```
SELECT T1.FID, T2.DATA
FROM tbl1 T1 
WHERE T1.ID = 2
INNER JOIN tbl2 T2
ON T1.ID = T2.ID 
```

# javascript - 如何检查字符串是否为浮点数？

> ID：12467542
> 
> 赞同：46
> 
> 时间：2012-09-17T21:43:16.067
> 
> 标签：javascript, parsing

我传入了一个名为 value 的参数。我想知道 value 是否是浮点数。到目前为止，我有以下内容：

```
if (!isNaN(value))
{
    alert('this is a numeric value but not sure if it is a float.');
} 
```

如何更进一步，将字符串转换为可以计算为浮点数的东西？

* * *

## 回答 #1

> 赞同：46
> 
> 时间：2012-09-17T22:00:16.960

像这样：

```
if (!isNaN(value) && value.toString().indexOf('.') != -1)
{
    alert('this is a numeric value and I\'m sure it is a float.');
}​ 
```

* * *

## 回答 #2

> 赞同：37
> 
> 时间：2012-09-17T21:49:37.410

您可以使用该`parseFloat`功能。

如果传递的值以浮点数开头，则函数返回转换为浮点数的值，否则返回 NaN。

就像是：

```
function beginsWithFloat(val) {
  val = parseFloat(val);
  return ! isNaN(val);
}
console.log(beginsWithFloat("blabla")); // shows false
console.log(beginsWithFloat("123blabla")); // shows true
```

* * *

## 回答 #3

> 赞同：16
> 
> 时间：2014-02-09T20:29:00.793

以下功能还检查格式。例如 JavaScript 本机`parseInt`和`parseFloat`函数也解析包含非数字字符的字符串，并且上面的函数具有此结果。

```
// For example, following code will work
var n = parseInt('123asd');
n == 123 
```

这些函数将返回`false`此类字符串。

```
function isFloat(val) {
    var floatRegex = /^-?\d+(?:[.,]\d*?)?$/;
    if (!floatRegex.test(val))
        return false;

    val = parseFloat(val);
    if (isNaN(val))
        return false;
    return true;
}

function isInt(val) {
    var intRegex = /^-?\d+$/;
    if (!intRegex.test(val))
        return false;

    var intVal = parseInt(val, 10);
    return parseFloat(val) == intVal && !isNaN(intVal);
} 
```

* * *

## 回答 #4

> 赞同：10
> 
> 时间：2013-07-03T05:02:16.433

检查字符串是整数还是浮点数

```
function isFloat(n) {
    return parseFloat(n.match(/^-?\d*(\.\d+)?$/))>0;
}

//alert(isFloat("3.444")); 
```

* * *

## 回答 #5

> 赞同：5
> 
> 时间：2013-08-08T12:56:41.840

```
Number.prototype.isFloat = function() {
    return (this % 1 != 0);
} 
```

那么你也能

```
var floatValue = parseFloat("2.13");
var nonFloatValue = parseFloat("11");

console.log(floatValue.isFloat()); // will output true
console.log(nonFloatValue.isFloat()); // will output false 
```

像这样的值`2.00`在 JS 中不能真正被认为是浮点数，或者更确切地说，*每个数字都是 JS 中的浮点数*。

* * *

编辑：忘了提到扩展内置类型的原型被认为是一个坏事（有充分的理由），并且不鼓励在生产环境中使用它。您仍然可以将此检查实现为普通函数

* * *

## 回答 #6

> 赞同：5
> 
> 时间：2016-08-07T11:06:08.483

就我而言，一个非常简单的正则表达式就可以了。

我需要验证用户的输入是否是有效的货币价值。我只是用了——

```
/^[0-9]+(\.)?[0-9]*$/.test(number) 
```

之间的一切`//`都是正则表达式。

`/^`表示匹配从单词的开头开始，`$/`表示匹配以单词结束。如果你认为这个词不能以字母开头，`0`那么表达就像`[1-9][0-9]*`

`[0-9]+`表示单词必须以至少一个数字开头。

*注：`*`表示零个或多个，`+`表示一个或多个，`?`表示一个或无。*

到这里，表达式是`/^[1-9][0-9]*$/`，这将只验证整数。

要测试我们需要`\.`与表达式一起使用的数字中的句点 (.)。`.`是一个匹配所有内容的特殊字符，`\.`只会匹配句点。

最后，另一个字符类`[0-9]*`将匹配零个或多个数字。

**测试用例**

```
/^[0-9]+(\.)?[0-9]$/.test("21.38a") // ==> false
/^[0-9]+(\.)?[0-9]$/.test("21.38") // ==> true
/^[0-9]+(\.)?[0-9]$/.test("y2781.68") // ==> false
/^[0-9]+(\.)?[0-9]$/.test("2781r.68") // ==> false 
```

* * *

## 回答 #7

> 赞同：4
> 
> 时间：2017-07-24T10:09:55.167

用这个：

```
var isNumber = /^\d+\.\d+$/.test(value); 
```

* * *

## 回答 #8

> 赞同：3
> 
> 时间：2017-05-29T00:02:01.007

```
function checkFloat(value) {
    let parsed = Number.parseFloat(value);
    return (!Number.isNaN(parsed)) && (!Number.isInteger(parsed))
} 
```

* * *

## 回答 #9

> 赞同：2
> 
> 时间：2014-02-18T04:41:11.583

检查字符串是否为浮点数（避免使用 int 值）

```
function isFloat(n) {
   if( n.match(/^-?\d*(\.\d+)?$/) && !isNaN(parseFloat(n)) && (n%1!=0) )
      return true;
   return false;
}

var nonfloat = isFloat('12'); //will return false
var nonfloat = isFloat('12.34abc'); //will return false
var float = isFloat('12.34'); //will return true 
```

* * *

## 回答 #10

> 赞同：1
> 
> 时间：2012-09-17T22:26:57.430

只有`value`作为字符串传入，我们才能完全确定它是否使用小数点。因为`1.0`（作为数字）导致（作为字符串）结果`1`完全相同。从那里我们可以找到它是否包含小数点，. 所以我们需要将参数作为字符串传递。`"1.0"``"1.0"``.``value`

[`value`如果是字符串，以下将起作用]

```
if ( value.indexOf('.') > -1 ) { // value is a floating point

} 
```

`value.toString()`不会转向`1.0`（`"1.0"`相反，它只会将其转向`1`），因此通过字符串传递是最好的选择，因为它保留了所有字符。

如果您不想使用字符串，则无法将其捕获`1.0`为浮点值。如果要测试*数字*是否为浮点值，请使用以下命令：

[以下不适用于 1.0、1.00 等。]

```
if ( value >>> 0 !== x ) { // value is a floating point

} 
```

注意：您还应该检查`!isNaN(value)`（我忽略了它以专注于更改）。

* * *

## 回答 #11

> 赞同：1
> 
> 时间：2015-03-31T09:36:35.913

如果您需要检查 value 是 int 还是 float：

```
function isFloatOrInt(n) {
    return !isNaN(n) && n.toString().match(/^-?\d*(\.\d+)?$/);
} 
```

* * *

## 回答 #12

> 赞同：1
> 
> 时间：2017-02-28T11:15:59.623

此函数返回字符串的数值，无论是 int 还是 float

```
function getNumericVal(str) {
    if(isNaN(str)) return;
    try {return parseFloat(str);} 
    catch(e) {return parseInt(str);}
} 
```

* * *

## 回答 #13

> 赞同：0
> 
> 时间：2015-11-12T13:45:08.610

直截了当：

```
if (parseFloat(value).toString() === value.toString()) {
    ...
} 
```

* * *

## 回答 #14

> 赞同：0
> 
> 时间：2018-01-02T14:43:43.567

使用这个 jquery 代码

```
 <script>
    $(document).ready(function () {
        $(".allow_only_float").keypress(function (e) {

            if (e.which != 46 && e.which != 8 && e.which != 0 && (e.which < 48 || e.which > 57)) {
                e.preventDefault();//return false;
            }
            var avg = $('#<%=txtAverage.ClientID%>').val();
            var idx = avg.indexOf(".");
            if (idx > -1 && e.which == 46) {
                e.preventDefault();//return false;
            }
        });
    });
    </script>
<body>
    <input type='text' class='allow_only_float'>
</body> 
```

* * *

## 回答 #15

> 赞同：0
> 
> 时间：2021-01-11T23:36:32.427

```
function isFloat(inputString) {
    const parsed = parseFloat(inputString);

    return !isNaN(parsed) && parsed.toString() === inputString;
}

isFloat('.4') // false
isFloat('1.4') // true
isFloat('1.') // false
isFloat('1') // true
isFloat('asd') // false
isFloat('123asd') // false 
```

* * *

## 回答 #16

> 赞同：-3
> 
> 时间：2021-06-05T18:24:19.653

```
if (!isNaN(value) && String(value).includes('.')) {
    alert("it's a float");
    let newFloatValue = parseFloat(value)
} 
```

# asp.net - 是否有推荐的方法来使用 ASP.NET Web API 返回图像

> ID：12467546
> 
> 赞同：86
> 
> 时间：2012-09-17T21:43:39.607
> 
> 标签：asp.net, asp.net-web-api, image

返回具有 2 个参数（x 和 y 用于调整大小）的图像的最佳方法是什么。

例如

```
~/api/image12345/200/200 
```

将返回 200 x 200 jpg/png/或 gif

我应该返回一个`System.Drawing.Image`对象还是手动定义`HTTPReponseMessage.Content`？

* * *

## 回答 #1

> 赞同：151
> 
> 时间：2012-09-17T23:49:24.120

您不应该返回 a `System.Drawing.Image`，除非您还添加了一个知道如何将其转换为适当字节的格式化程序，它不会像您期望的那样将自身序列化为图像字节。

一种可能的解决方案是返回一个`HttpResponseMessage`存储在其内容中的图像（如下所示）。请记住，如果您想要问题中显示的 URL，则需要一个映射 {imageName}、{width} 和 {height} 参数的路由。

```
public HttpResponseMessage Get(string imageName, int width, int height)
{
    Image img = GetImage(imageName, width, height);
    using(MemoryStream ms = new MemoryStream())
    {
        img.Save(ms, System.Drawing.Imaging.ImageFormat.Png);

        HttpResponseMessage result = new HttpResponseMessage(HttpStatusCode.OK);
        result.Content = new ByteArrayContent(ms.ToArray());
        result.Content.Headers.ContentType = new MediaTypeHeaderValue("image/png");

        return result;
    }
} 
```

但是同样，如果您在很多地方都这样做，那么走格式化程序路线可能是“推荐”的方式。与编程中的几乎所有内容一样，答案将取决于您的场景。

* * *

## 回答 #2

> 赞同：20
> 
> 时间：2012-09-24T05:49:50.133

图像很重。ASP.NET WebForms、HttpHandlers、MVC 和 Web API在提供静态文件方面都做得非常*糟糕。*IIS 在这方面做得*非常*好 - 通常效率提高 20-100 倍。

如果您想获得良好的性能，*最迟*在 PostAuthorizeRequest 期间执行 URL 重写，以便 IIS 可以获取并提供文件。是的，这意味着 HttpModule 级别的事件处理。

[免责声明：我是以下文章和开源项目的作者]

如果您正在对图像进行动态处理，请查看[这篇关于要避免的图像处理陷阱的文章](http://nathanaeljones.com/163/20-image-resizing-pitfalls/)，并考虑查看[ImageResizer](http://imageresizing.net)。它具有出色的磁盘缓存（使用 IIS 静态文件处理），并且易于连接到任何类型的图像生成。如果您需要更高级，它还具有 AForge、FreeImage 和 WIC 的可选绑定。

# c++ - 检索回调 URL

> ID：12467547
> 
> 赞同：0
> 
> 时间：2012-09-17T21:44:00.270
> 
> 标签：c++, libcurl, curlpp

我正在使用[cURLpp](http://www.curlpp.org/)将请求从桌面客户端发送到服务器，该服务器通常使用一些 json 元素进行响应。然后，我可以解析该元素以获取我需要的信息，并将其显示给我的用户，而不会发生意外。但是，该服务器通常只处理来自网站的请求，因此在一种情况下，服务器需要用户进行交互，然后执行到网页的重定向并在 url 片段中发送我需要的令牌。通常，我会使用`var Token = window.location.hash.substring(1);`回调页面上的类似内容来检索此令牌。可以使用 curlpp 来检索带有令牌的 url 吗？如果不是，我如何将其发送到我的应用程序？

# javascript - How to save a signature captured by svg file (Present in HTML-Form)

> ID：12467554
> 
> 赞同：2
> 
> 时间：2012-09-17T21:44:50.137
> 
> 标签：javascript, html, iframe

I am using a svg file in a iframe to get the user's Signature , which is implemented in a form, It works fine, but how can i save the signature at my server ? Is there any way to catch the data (" the signature" ) either in the same svg file loadable or any image ?

I am using HTML/ Javascript only .

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-09-17T21:49:50.960

您需要从 svg 读取路径数据，然后在提交表单之前将该值设置为表单中的隐藏字段。

这是一个最小的例子： http: [//mcc.id.au/2010/signature.html](http://mcc.id.au/2010/signature.html)

* * *

## 回答 #2

> 赞同：-1
> 
> 时间：2012-09-17T21:49:20.023

如果它真的是 SVG，那么只需将其转换为 XML 文件并使用 svg 文件扩展名命名。到 XML 的转换只需要在第一行添加一个 XML pragma。

# c# - 列表视图中的多个列

> ID：12467557
> 
> 赞同：1
> 
> 时间：2012-09-17T21:45:23.140
> 
> 标签：c#, winforms, listview, listbox, listviewitem

我正在用 C# 编写以下代码以在 listView 的多列中显示数据，但它只显示数组的第一个元素，

```
ListViewItem item = new ListViewItem(new []{txtTitle.Text,txtRatings.Value.ToString(),cmbGenre.Text});
lstMovie.Items.Add(item); 
```

列表视图中的输出只是第一个元素。我如何获得所有三个元素。

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-09-17T22:20:04.437

数据已插入，但 listview 未显示，请将 listView 的 View 属性设置为 Details

```
lstView.View = View.Details; 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-09-17T22:02:39.833

在尝试填充列表视图之前，您是否已将 3 列添加到列表视图中？就像是：

```
lstMovie.Columns.Add("Title");
lstMovie.Columns.Add("Ratings");
lstMovie.Columns.Add("Genre"); 
```

# facebook - How do you run heroku toolbar

> ID：12467562
> 
> 赞同：0
> 
> 时间：2012-09-17T21:45:50.543
> 
> 标签：facebook, heroku

I have just downloaded the Heroku Toolbelt yet I can see nothing on my PC or in the Program files directory that indicates how to run the toolbelt. Also Facebook now require secure browsing yet I don't want to pay for a SSL certificate as my apps are for learning code only. I would be very grateful if someone could explain how I run the toolbelt - last time I installed it it seemed ok. Also how does Heroku know which app I am uploading?

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-09-17T21:50:02.443

好吧，工具带是一个命令行界面，因此您需要启动命令提示符。

要运行工具带（在 Windows 7 中或使用“[从此处打开命令提示符](http://www.petri.co.il/add_command_prompt_here_shortcut_to_windows_explorer.htm)”Microsoft Powertoys）创建一个空文件夹，按住 Shift + 鼠标右键单击，选择“在此处打开命令窗口”。然后（假设工具带安装在您的路径中）运行

```
heroku login 
```

接着

```
heroku create 
```

这将创建一个用于编码的工作目录。当您运行时`git push heroku master`，它会将您的工作代码发送到您的实例。阅读[本指南](http://www.petri.co.il/add_command_prompt_here_shortcut_to_windows_explorer.htm)以了解更多高级用法。

至于您的第三个问题，它会根据您运行它时所在的当前目录知道。我不会考虑与其他 2 相关的第二个问题，所以如果您想要一个明确的答案，我建议将其作为一个单独的问题提出。

# xcode - Xcode 按到用户位置的距离对 CLLocations 进行排序

> ID：12467565
> 
> 赞同：0
> 
> 时间：2012-09-17T21:45:57.720
> 
> 标签：xcode, distance, cllocation

在我花了很多时间谷歌搜索之后，我决定在这里问。我希望有一个人可以帮助我。

在我的项目中，我有一些 CLLocations，其中每个都有名称。现在我想要一个列表，可能是一个表格视图或类似的东西，用户可以看到哪些位置是最近的。我怎样才能做到这一点？有没有简单的方法可以做到这一点？

希腊人谷

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-09-17T22:40:56.493

确定距离只是代数：

```
#include <math.h>
double distance = sqrt(pow(myLat - theirLat, 2.0) + pow(myLong - theirLong, 2.0)); 
```

对所有距离进行排序并显示您想要的方式。

从中创建一个 UITableView 是一个更大的讨论，你可能应该读一本书或参加 iTunesU 上的免费斯坦福课程或其他东西。

# sql - 在多个参数和条件下检测 SQL 岛

> ID：12467567
> 
> 赞同：3
> 
> 时间：2012-09-17T21:46:03.943
> 
> 标签：sql, postgresql, gaps-and-islands

**(PostgreSQL 8.4)我**[在 Stack Overflow 上](https://stackoverflow.com/questions/12451489/filtering-out-duplicate-subsequent-records-in-a-select)对 SQL gaps-and-islands 有了很好的介绍，但我仍然有一个问题。许多孤岛检测 CTE 基于时间戳的运行顺序和一些标志，当它改变时会破坏序列。但是如果“中断”条件稍微复杂一点呢？

```
CREATE TABLE T1
(
  id SERIAL PRIMARY KEY,
  val INT,   -- some device
  status INT -- 0=OFF, 1=ON
);

INSERT INTO T1 (val, status) VALUES (10, 1);
INSERT INTO T1 (val, status) VALUES (10, 0);
INSERT INTO T1 (val, status) VALUES (11, 1);
INSERT INTO T1 (val, status) VALUES (11, 1);
INSERT INTO T1 (val, status) VALUES (10, 0);
INSERT INTO T1 (val, status) VALUES (12, 1);
INSERT INTO T1 (val, status) VALUES (13, 1);
INSERT INTO T1 (val, status) VALUES (13, 0);
INSERT INTO T1 (val, status) VALUES (13, 1); 
```

在这种情况下，`val`表示一个设备，并且`status`是`ON`或`OFF`。我想使用以下逻辑选择记录`1`、、、`3`和`6`。`7``9`

1.  # 10 次打开 -- 好的，新序列，包含在 SELECT 中

2.  # 10 关闭 - 正确结束序列，忽略行

3.  # 11 开启 -- 好的，新序列，包含在 SELECT 中

4.  # 11 开启——重复，忽略行

5.  # 10 关闭——#10 没有打开，忽略

6.  # 12 打开 -- 好的，隐式关闭 #11，包含在 SELECT 中

7.  # 13 打开 -- 好的，隐式关闭 #12，包含在 SELECT 中

8.  # 13 关闭——正确结束序列，忽略行

9.  # 13 开启 -- 好的，新序列，包含在 SELECT 中

基本上，一次只能开启一个设备，“中断”条件是：

*   new.val = running.val AND new.status = 0
*   new.val <> running.val AND new.status = 1

我正在寻找 CTE 形式的东西，*请不要使用光标*。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-09-17T22:08:11.830

## 回答更新的问题

```
SELECT *
FROM  (
   SELECT *
         ,lag(val, 1, 0) OVER (PARTITION BY status ORDER BY id) last_val
         ,lag(status) OVER (PARTITION BY val ORDER BY id) last_status
   FROM   t1
   ) x
WHERE  status = 1
AND    (last_val <> val OR last_status = 0) 
```

### 如何？

和之前一样，但是这次结合了两个窗口函数。如果 ..
1\. 最后打开的设备是*不同*的，则打开设备符合条件。
2\. 或同一设备在其最后一次进入时已被*关闭。*分区第一行的极端情况`NULL`无关紧要，因为该行已经符合*1。*

* * *

## 回答问题的原始版本。

如果您的我正确理解了您的任务，这个简单的查询就可以完成这项工作：

```
SELECT *
FROM  (
   SELECT *
         ,lag(val, 1, 0) OVER (ORDER BY id) last_on
   FROM   t1
   WHERE  status = 1
   ) x
WHERE  last_on <> val 
```

根据请求返回第 1、3、6、7 行。

### 如何？

根据您的描述，子查询忽略所有关闭，因为这只是噪音。留下打开设备的条目。其中，只有那些条目被取消资格，其中相同的设备已经打开（最后一个条目打开）。为此使用[窗口函数`lag()`](http://www.postgresql.org/docs/current/interactive/functions-window.html#FUNCTIONS-WINDOW-TABLE)。特别是我`0`默认提供覆盖第一行的特殊情况 - 假设没有设备带有`val = 0`.
如果有，请选择另一个不可能的数字。
如果没有数字是不可能的，则将特殊情况保留为`NULL`with`lag(val) OVER ...`并在外部查询中检查：

```
WHERE last_on IS DISTINCT FROM val 
```

# python - Python：加快重复执行的 eval 语句的方法？

> ID：12467570
> 
> 赞同：23
> 
> 时间：2012-09-17T21:46:30.620
> 
> 标签：python, eval

在我的代码中，我`eval`用来评估用户给出的字符串表达式。有没有办法编译或以其他方式加速这个语句？

```
import math
import random

result_count = 100000
expression = "math.sin(v['x']) * v['y']"

variable = dict()
variable['x'] = [random.random() for _ in xrange(result_count)]
variable['y'] = [random.random() for _ in xrange(result_count)]

# optimize anything below this line

result = [0] * result_count

print 'Evaluating %d instances of the given expression:' % result_count
print expression

v = dict()
for index in xrange(result_count):
    for name in variable.keys():
        v[name] = variable[name][index]
    result[index] = eval(expression) # <-- option ONE
    #result[index] = math.sin(v['x']) * v['y'] # <-- option TWO 
```

为了快速比较，选项 ONE 在我的机器上需要 2.019 秒，而选项 2 只需要 0.218 秒。当然，Python 有一种方法可以做到这一点，而无需对表达式进行硬编码。

* * *

## 回答 #1

> 赞同：37
> 
> 时间：2012-09-17T22:05:32.140

你也可以欺骗python：

```
expression = "math.sin(v['x']) * v['y']"
exp_as_func = eval('lambda: ' + expression) 
```

然后像这样使用它：

```
exp_as_func() 
```

速度测试：

```
In [17]: %timeit eval(expression)
10000 loops, best of 3: 25.8 us per loop

In [18]: %timeit exp_as_func()
1000000 loops, best of 3: 541 ns per loop 
```

* * *

作为旁注，如果`v`不是全局的，您可以像这样创建 lambda：

```
exp_as_func = eval('lambda v: ' + expression) 
```

并称之为：

```
exp_as_func(my_v) 
```

* * *

## 回答 #2

> 赞同：20
> 
> 时间：2012-09-17T22:01:22.783

[`compiler.compile()`](https://docs.python.org/2.7/library/compiler.html)您可以通过使用for Python 2 或[`compile()`](https://docs.python.org/3/library/functions.html?highlight=compile#compile)for Python 3提前编译表达式来避免开销：

```
In [1]: import math, compiler

In [2]: v = {'x': 2, 'y': 4}

In [3]: expression = "math.sin(v['x']) * v['y']"

In [4]: %timeit eval(expression)
10000 loops, best of 3: 19.5 us per loop

In [5]: compiled = compiler.compile(expression, '<string>', 'eval')

In [6]: %timeit eval(compiled)
1000000 loops, best of 3: 823 ns per loop 
```

只要确保只编译一次（在循环之外）。正如评论中提到的，`eval`在用户提交的字符串上使用时，请确保您对接受的内容非常小心。

* * *

## 回答 #3

> 赞同：5
> 
> 时间：2012-09-18T09:16:13.320

我认为您正在优化错误的结果。如果你想对很多数字执行相同的操作，你应该考虑使用 numpy：

```
import numpy
import time
import math
import random

result_count = 100000
expression = "sin(x) * y"

namespace = dict(
    x=numpy.array(
        [random.random() for _ in xrange(result_count)]),
    y=numpy.array(
        [random.random() for _ in xrange(result_count)]),
    sin=numpy.sin,
)
print ('Evaluating %d instances '
       'of the given expression:') % result_count
print expression

start = time.time()
result = eval(expression, namespace)
numpy_time = time.time() - start
print "With numpy:", numpy_time

assert len(result) == result_count
assert all(math.sin(a) * b == c for a, b, c in
           zip(namespace["x"], namespace["y"], result)) 
```

为了让您了解可能的收益，我使用通用 python 和 lambda 技巧添加了一个变体：

```
from math import sin
from itertools import izip

start = time.time()
f = eval("lambda: " + expression)
result = [f() for x, y in izip(namespace["x"], namespace["y"])]
generic_time = time.time() - start
print "Generic python:", generic_time
print "Ratio:", (generic_time / numpy_time) 
```

这是我的老化机器上的结果：

```
$ python speedup_eval.py 
Evaluating 100000 instances of the given expression:
sin(x) * y
With numpy: 0.006098985672
Generic python: 0.270224094391
Ratio: 44.3063992807 
```

加速没有我预期的那么高，但仍然很重要。

# c++ - 如何在不调用实现定义的行为的情况下将二进制数据写入文件？

> ID：12467576
> 
> 赞同：4
> 
> 时间：2012-09-17T21:47:05.630
> 
> 标签：c++, c

我正在编写这样的程序来将一些字节写入文件。

```
#include <fstream>

int main()
{
    char buffer[4] = {0, 0, 255, 255};
    std::ofstream f("foo.txt", std::ios_base::binary);
    f.write(buffer, sizeof buffer);
    f.close();
    return 0;
} 
```

这工作正常，并在我的系统上给了我预期的结果。

```
$ g++ -std=c++11 -pedantic -Wall -Wextra signedness.cc
$ ./a.out
$ cat foo.txt
$ od -t x1 foo.txt 
0000000 00 00 ff ff
0000004 
```

等效的 C 代码将是：

```
#include <stdio.h>

int main()
{
    char buffer[4] = {0, 0, 255, 255};
    FILE *f = fopen("bar.txt", "wb");
    fwrite(buffer, sizeof *buffer, sizeof buffer, f);
    fclose(f);
    return 0;
} 
```

该程序也可以正常工作，并在我的系统上提供预期的输出。

我想知道上述将字节写入文件的方式是否可以。

[C++ n3242.pdf](http://www.open-std.org/jtc1/sc22/wg21/docs/papers/2011/n3242.pdf)的第 4.7 节（积分转换）在第 3 点中提到：

> 如果目标类型是有符号的，则如果它可以在目标类型（和位域宽度）中表示，则该值不变；否则，该值是实现定义的。

[C n1256.pdf](http://www.open-std.org/JTC1/SC22/WG14/www/docs/n1256.pdf)的第 6.3.1.3 节（有符号和无符号整数）在第 3 点中提到：

> 否则，新类型是有符号的，值不能在其中表示；结果是实现定义的，或者引发了实现定义的信号。

从这些摘录中，当我将 255 分配为最后两个字节时，我的程序似乎调用了实现定义的行为，`char buffer[4]`因为 255 不能用`char`类型表示。如果我对此是正确的，那么将这四个字节写入文件的正确方法是什么？更改`buffer`from的类型在 C++ 中`char`似乎`unsigned char`没有帮助，因为 ofstream 的`write()`函数仍然需要第一个参数 to 的 type `const char*`。

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-09-17T22:25:12.530

请记住，这`ofstream`只是`std::basic_ofstream<char>`.

当您不希望将事物视为 时`char`，只需使用`std::basic_ofstream<unsigned char>`or `std::basic_ofstream<uint8_t>`。

但最终，iostream 是为格式化的 I/O 制作的。该 API 对于二进制 I/O 来说是可怕的（因为它不需要`void*`），而且速度也非常慢。此外，每个字符都由一个“平面”转换，因此很难保证输入字节和磁盘上的字节之间的 1:1 对应关系。 `basic_filebuf`稍微好一点，但不多。即使在 C++ 中，使用`fopen`and`fwrite`仍然是一种完全有效的方法。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-09-17T21:51:59.203

诚然，255 不能用有符号`char`类型表示，但您没有分配 255，您分配的是`FF`，它代表`-1`.

您想使用`uint8_t`中定义的`stdint.h`，或者至少使用`unsigned char`。

* * *

## 回答 #3

> 赞同：-1
> 
> 时间：2012-09-17T22:19:56.313

“实现定义”是 C++ 国际标准的语言，它是一个准法律文件，旨在涵盖所有可能的情况。

因此它可以在 char 为 9 位的机器上运行，因此它在处理二进制数据和文件的行为中固有，某些方面将由实现定义。根据标准的规定，您必须研究每台目标机器的文档，并确保在每种情况下都能实现您需要的行为。

在现实世界中，每个现代通用 CPU 都有 8 位字节并使用 2s 补码算法，因此除非您针对非常特定的情况，否则无需担心。

# webstorm - 如何在本地服务器上使用 Webstorm 的 LiveEdit

> ID：12467579
> 
> 赞同：1
> 
> 时间：2012-09-17T21:47:25.160
> 
> 标签：webstorm

我让我的本地服务器指向一个 URL，例如：www.thing.com。

我可以让 Webstorm 的 LiveEdit 功能像这样工作吗？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-09-18T07:42:24.213

应该会在下次插件更新中支持，[见相关bug](http://youtrack.jetbrains.com/issue/WI-13227)。

# node.js - 如何使用带有选项的 Node.js zlib 模块？

> ID：12467584
> 
> 赞同：8
> 
> 时间：2012-09-17T21:48:16.477
> 
> 标签：node.js, zlib

我需要使用 zlib 在极端压缩级别压缩 Node.js 中的缓冲区。输出的标头应该是 78 DA。除非我遗漏了什么，否则 Node.js 文档并没有真正描述如何使用 zlib.Deflate 类。它不接受任何参数。

[http://nodejs.org/api/zlib.html#zlib_class_zlib_deflate](http://nodejs.org/api/zlib.html#zlib_class_zlib_deflate)

* * *

## 回答 #1

> 赞同：10
> 
> 时间：2012-09-17T21:58:43.650

使用`zlib.` `createGzip`/`createDeflate`获取您需要的压缩器实例，其中包含对象中的选项。

如果你想在内存中做这一切：

```
var zlib = require('zlib');

// create a new gzip object
var gzip = zlib.createGzip({
    level: 9 // maximum compression
}), buffers=[], nread=0;

// attach event handlers...

gzip.on('error', function(err) {
    gzip.removeAllListeners();
    gzip=null;
});

gzip.on('data', function(chunk) {
    buffers.push(chunk);
    nread += chunk.length;
});

gzip.on('end', function() {
    var buffer;
    switch (buffers.length) {
        case 0: // no data.  return empty buffer
            buffer = new Buffer(0);
            break;
        case 1: // only one chunk of data.  return it.
            buffer = buffers[0];
            break;
        default: // concatenate the chunks of data into a single buffer.
            buffer = new Buffer(nread);
            var n = 0;
            buffers.forEach(function(b) {
                var l = b.length;
                b.copy(buffer, n, 0, l);
                n += l;
            });
            break;
    }

    gzip.removeAllListeners();
    gzip=null;

    // do something with `buffer` here!
});

// and finally, give it data to compress
gzip.write(inputBuffer);
gzip.end(); 
```

当然，如果您要处理大量数据，请将输出流式传输到文件中，而不是在内存中缓冲所有内容。

# python - pub/sub 数据库和客户端编程数据库有什么区别？

> ID：12467586
> 
> 赞同：1
> 
> 时间：2012-09-17T21:48:22.243
> 
> 标签：python, mongodb, redis, publish-subscribe

我有两个`NoSQL DBMS`：`MongoDB`和`Redis`：

`Redis`有著名的`PubSub`，具有最适合从to转换`MongoDB`的最接近的逻辑，并且由于使用 in并且例如，如果用户添加或删除产品，则更改的是 的长度，因此，代码可以在这里写成,`RDBMS``SQL``NOSQL``MongoDB``python` `Dictionaries``Lists``list``notificator`

那么在`Redis`这里使用的好处在哪里呢？

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2012-09-18T12:06:25.973

我在操作日志上使用了 Redis pub-sub 和 Mongodb 可尾游标（这是一个上限集合 - 请参阅[http://denormalised.com/home/mongodb-pub-sub-using-the-replication-oplog](https://web.archive.org/web/20120825040938/http://denormalised.com/home/mongodb-pub-sub-using-the-replication-oplog.html) .html和[http://blog.mongodb.org/post/29495793738/pubsub-with-mongodb](http://blog.mongodb.org/post/29495793738/pubsub-with-mongodb)）来鞭打我自己的。主要区别在于您是否要使用 Mongo 构建自己的发布-订阅逻辑。从表面上看，pub-sub 似乎很简单，但与任何事情一样，它有很多你必须编程的边缘情况。Redis 的 pub-sub 已经为您完成了大部分管道工作，因此您可以担心高级编码问题并将低级内容留给已经解决问题的系统。

Mongo 对 Redis 的最大胜利在于，您可以更好地控制如何构建 pub-sub，因此如果您有特殊需求，它可能是更好的选择。例如，使用 Redis（开箱即用），如果客户端断开连接，然后在 10 分钟后重新连接，那么在这中间的几分钟内，它会丢失消息，并且无法取回它们。使用 Mongo，客户端可以返回并获取这些消息（需要注意的是它必须从头到尾读取整个封顶集合） - 请记住，您将必须跟踪传递给每个客户端的最后一条消息，等等。有Redis 的变通方法，以便它可以实现这一点 - 请参阅[Redis Pub/Sub with Reliability](https://stackoverflow.com/questions/6192177/redis-pub-sub-with-reliability)作为示例。

如果您需要速度并支持大量客户端和大量订阅渠道，那么 Redis 是您的最佳选择。在我提到的实现中，Redis 是迄今为止最快的，能够处理最多的客户端。当然，这可能反映了我们的 Pub-Sub 实现存在问题，而不是反映 mongo 的一般性能。虽然，我们确实遇到了 Mongo 中全局写入锁定的问题，该问题已在最新版本（2.2？）中得到缓解。

总而言之，如果您需要专门的东西，Mongo 可能是您的正确选择。但是，如果您想要直接的消息传递，即开箱即用的大负载，我不会尝试重新发明轮子，而是使用 Redis。

# git - 从 R 调用 git

> ID：12467591
> 
> 赞同：3
> 
> 时间：2012-09-17T21:49:14.463
> 
> 标签：git, r, system

我尝试从 R 控制台调用 git 命令，但被卡住了。我在 MINGW32 中使用 git bash 版本 1.7.11，路径是 C:\Windows\SysWOW64\cmd.exe /c ""C:\Program Files (x86)\Git\bin\sh.exe" --login -i “..操作系统是Windows 7。

```
script <- "C:\\Users\\Kay\\Dropbox\\R-Scripts\\test.R"
system(paste("git add", script), intern=TRUE)
system(paste('"C:\\Program Files (x86)\\Git\\bin\\sh.exe\"',
             'cd theBioBucket-Archives'), intern=TRUE)
system(paste('"C:\\Program Files (x86)\\Git\\bin\\sh.exe\"',
             'git add', script), intern=TRUE)
system(paste("git commit -a -m", "'", "autocommit", "'"), intern=TRUE)

[1] "/usr/bin/sh: cd: No such file or directory"
attr(,"status")
[1] 127
Warnmeldung:
Ausführung von Kommando '"C:\Program Files (x86)\Git\bin\sh.exe" cd theBioBucket-Archives' ergab Status 127 
```

我也试过：

```
system("C:\\Windows\\SysWOW64\\cmd.exe /c \"\"C:\\Program Files (x86)\\Git\\bin\\sh.exe\" git status", intern=TRUE)
[1] "Der Befehl \"\"C:\\Program Files (x86)\\Git\\bin\\sh.exe git status\" ist entweder falsch geschrieben oder"
[2] "konnte nicht gefunden werden."                                                                             
attr(,"status")
[1] 1
Warnmeldung:
Ausführung von Kommando 'C:\Windows\SysWOW64\cmd.exe /c ""C:\Program Files (x86)\Git\bin\sh.exe" git status' ergab Status 1 
```

也没有运气..

编辑 19.09.2012，我的环境：

```
> Sys.getenv("PATH")
[1] "C:\\Program Files (x86)\\AMD APP\\bin\\x86_64;C:\\Program Files (x86)\\AMD APP\\bin\\x86;C:\\Program Files\\Common Files\\Microsoft Shared\\Windows Live;C:\\Program Files (x86)\\Common Files\\Microsoft Shared\\Windows Live;C:\\Windows\\system32;C:\\Windows;C:\\Windows\\System32\\Wbem;C:\\Windows\\System32\\WindowsPowerShell\\v1.0\\;C:\\Program Files (x86)\\Windows Live\\Shared;C:\\Program Files (x86)\\ATI Technologies\\ATI.ACE\\Core-Static;C:\\Program Files\\MiKTex\\miktex\\bin\\"
> normalizePath(R.home("bin"))
[1] "C:\\Program Files\\R\\R-2.15.1\\bin\\x64"
> shell("R --version")
Der Befehl "R" ist entweder falsch geschrieben oder
konnte nicht gefunden werden.
Warnmeldungen:
1: Ausführung von Kommando 'C:\Windows\system32\cmd.exe /c R --version' ergab Status 1 
2: In shell("R --version") :
  'R --version' Ausführung mit Fehlerkode 1 fehlgeschlagen 
```

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-09-18T07:32:30.640

我认为创建子外壳行不通。加“ `cd: No such file or directory`”表示外壳没有正确的 PATH 设置。

最好按照[此 R 脚本](http://r.789695.n4.nabble.com/Update-MS-Windows-PATH-variable-based-on-a-R-script-td3633623.html)[`git-cmd.bat`](https://github.com/msysgit/msysgit/blob/devel/git-cmd.bat)的示例设置正确的 PATH（如果需要，还可以设置其他环境变量，如 中所做的那样），然后查看直接调用命令是否有效。`git`

OP 提到了[yihui 脚本](https://github.com/yihui/lyx/blob/master/add-R-path-win.R)：

```
## put R's bin path to the system PATH variable under Windows
R.bin = normalizePath(R.home("bin"))
sys.path = Sys.getenv("PATH")
if ((shell("R --version") != 0) || !grepl(R.bin, sys.path, fixed = TRUE)) {
    system(paste("setx PATH \"", R.bin, ";", sys.path, "\"", sep = ""))
} 
```

并确认它使用正确`PATH`（请参阅“[如何在 Windows XP 中使用环境变量](http://best-windows.vlaurie.com/environment-variables.html)”）：

> 我使用了 yihui 的脚本，我`PATH`现在包含 git ..first try 显示现在可以调用 git！

# c# - 设置对 System.Data.Sqlite 的引用的正确方法

> ID：12467594
> 
> 赞同：0
> 
> 时间：2012-09-17T21:49:28.900
> 
> 标签：c#, sqlite, system.data.sqlite

我的解决方案包含几个项目。其中之一（DataBaseProject）正在使用 Sqlite，因此我添加了对 System.Data.Sqlite 的引用并将“本地复制”设置为 TRUE。DataBaseProject 由 MainProject 引用。在 MainProject bin 文件夹中构建后，只有 DataBaseProject.dll 但缺少 System.Data.Sqlite.dll。如何设置项目，System.Data.Sqlite.dll 将在 MainProject 的 bin 文件夹中？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-09-17T21:51:32.587

您还必须将引用添加到 MainProject，或者如您所说，复制到其 bin 文件夹中。

# ruby-on-rails - 使用 if 条件语句的未定义方法错误

> ID：12467605
> 
> 赞同：0
> 
> 时间：2012-09-17T21:50:00.247
> 
> 标签：ruby-on-rails, ruby

我有一个助手可以检查用户是否登录：

```
def signed_in?
  !current_user.nil?
end 
```

我还有一个助手，它允许视图和控制器通过检查会话来访问用户对象：

```
def current_user
  @current_user ||= User.find_by_session(session[:user_id])
end 
```

在我的一个控制器中，拉起用户对象可以正常工作

```
 def index
    @households = current_user.households.all
    @household = current_user.households.build

    respond_to do |format|
      format.html
      format.xml { render xml: @households }
    end
  end 
```

然而，当另一个控制器尝试调用家庭关系时，它会阻塞 current_user 助手：

```
def home
  @households = current_user.households.all
  @household = current_user.households.build

  respond_to do |format|
    format.html
    format.xml { render xml: @households }
  end
end 
```

错误：

```
undefined method `households' for nil:NilClass 
```

我很困惑，找不到与这个特定主题相关的任何帖子。不过，我是 Rails 新手。我是否以错误的方式问这个问题？

提前致谢。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-09-17T22:22:51.947

问题不在于第二个控制器无法使用 current_user 辅助方法，而是您的 current_user 方法没有找到用户并返回 nil。然后您尝试在返回的 nil 对象上调用家庭方法。

如果 current_user 方法在该控制器中不可用，您将看到如下错误消息：

```
undefined local variable or method `current_user' for #<YourController:0x1057870e8> 
```

这意味着您的逻辑流程存在缺陷。会话参数在遇到该方法时尚未设置，或者已设置但设置为不存在的 user_id。

尝试添加：

```
def home
  @households = (logged_in? ? current_user.households.all : nil)
  @household  = (logged_in? ? current_user.households.build : nil)

  respond_to do |format|
    format.html
    format.xml { render xml: @households }
  end
end 
```

将 nil 替换为您的后备数据应该是什么。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-09-17T23:06:07.223

可能刚刚发现您的 current_user 方法返回 nil 的原因。您按会话而不是 ID 搜索。尝试这个：

```
def current_user
  @current_user ||= User.find(session[:user_id])
end 
```

或者，如果您想更明确：

```
def current_user
  @current_user ||= User.find_by_id(session[:user_id])
end 
```

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-09-17T22:05:21.580

尝试将模块包含到您的第二个控制器中。

例如，辅助模块如下所示：

```
module UserHelper
  def current_user
    @current_user ||= User.find_by_session(session[:user_id])
  end
end 
```

然后将其包含到您的控制器中：

```
class YourController < ApplicationController
  include UserHelper

  def home
    @households = current_user.households.all
    @household = current_user.households.build

    respond_to do |format|
      format.html
      format.xml { render xml: @households }
    end
  end
end 
```

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2012-09-18T14:19:42.923

我不想跳到这里回答我自己的问题，但是我在这方面遇到了很长时间的麻烦，以至于我希望任何有同样问题的人都能够解决这个问题。事实证明，这是本页上的许多答案以及 Michael Hartl 的教程书的混合体。我正在使用辅助方法，但没有将辅助方法包括在`application_controller.rb`：

```
class ApplicationController < ActionController::Base
  include ControllerAuthentication
  include SessionsHelper
... 
```

我还在验证用户是否已登录以在我的视图中显示动态内容`home.html.erb`：

```
<% if signed_in? %>
  <!-- show the user dashboard -->
... 
```

但我在控制器上没有这样的验证`static_pages_controller.rb`：

```
def home
  if signed_in?
  @households = current_user.households.all 
  @household  = current_user.households.build 
end 
```

由于所有这些，错误：

```
undefined method `households' for nil:NilClass 
```

在用户未登录并试图访问`root_path`. 在其他情况下，我可以重定向，但我希望用户在登录时看到主页上的动态内容，如果未登录，则看到静态登录页面。

感谢大家的帮助！

# python - Django 1.1 TemplateSyntaxError - 无法导入 *.static.views

> ID：12467607
> 
> 赞同：0
> 
> 时间：2012-09-17T21:50:13.350
> 
> 标签：python, django, django-1.1

我正在尝试将使用 Django 1.1 的旧服务器中的站点导入到新服务器上。出于兼容性原因，我一直无法升级到新版本的 Django。

当我尝试查看 localhost:8080/admin/ 时，我能够访问登录屏幕，但在那之后我遇到了 TemplateSyntaxError。它给我的具体错误是：

> /admin/ 处的 TemplateSyntaxError
> 
> 渲染时捕获 ViewDoesNotExist：无法导入 cmldb.static.views。错误是：没有名为 static.views 的模块

错误是完全正确的 - 没有模块 cmldb.static。urls.py 文件中有一个对 cmldb.static.views 的引用，但是当我更改此值时，我遇到了相同的错误。此外，我从中导入的站点具有相同的 urls.py 文件，但该项目中也没有 cmldb.static 模块，尽管该站点运行良好。

回溯显示位于 Django 包中的所有文件，而不是位于我的 cmldb 包中的任何文件，因此我不确定要发布哪些代码（如果有）。我的主要困惑是哪个文件实际上导致了这个错误。

错误是：

> 在模板 /usr/local/lib/python2.7/dist-packages/django/contrib/admin/templates/admin/base.html 中，第 30 行出错

内容如下：

> 30 {% url django-admindocs-docroot as docsroot %}

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-09-17T23:00:52.957

I'm still unsure as to where the reference to cmldb.static.views originated from, but I discovered that there was a missing folder in my svn database that solved the problem. The cmldb.static.views module is now in place, and the site is up and running.

# css - 在一列设计中垂直居中 div

> ID：12467609
> 
> 赞同：0
> 
> 时间：2012-09-17T21:50:40.933
> 
> 标签：css, html, scroll

经过长时间的中断后，我回到了 html/css，需要一些帮助。

背景：当用户与固定导航栏交互时，我使用 1 列布局和 jQuery 将页面自动滚动到各种 div。

问题：当您在垂直分辨率比我的笔记本电脑或移动设备更大的屏幕上查看页面时，您可以一次看到所有或部分不同的 div 部分。

问题：有没有办法垂直分隔 div，以便滚动功能类似于我使用链接到不同文件的传统导航栏？换句话说，我不想一次看到所有的 div，只看到用户点击的那个。

多谢！

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-09-18T00:07:32.333

```
<div id="content">
    <div class="container">
        <div class="pseudopage">
            foo
        </div>
    </div>
</div> 
```

使用该基本结构（重复“容器” div），您可以执行以下操作：

```
​#content{
    border: 1px solid black;
    height: DESIRED_HEIGHT;
    width: DESIRED_WIDTH;
    overflow:hidden;
}

.container {          
    height:100%;
    width:100%;
    text-align:center;
}

.pseudopage {
    vertical-align:middle;  
    display:inline-block;
    margin:px;
}
div.container:before{
    content: '';        
    height:100%;
    width: 0px;
    margin:0px;
    vertical-align:middle;
    display:inline-block;
} 
```

享受！此外，#content div 很可能是页面的主体，但您必须记住设置高度。（专业提示 - 如果您将 的高度设置`html`为 100% 和`body`100%，那么您将填满屏幕。）

# javascript - 基于 Html5 的加载进度 HUD

> ID：12467612
> 
> 赞同：0
> 
> 时间：2012-09-17T21:50:51.810
> 
> 标签：javascript, jquery, html, hud

只是想知道是否有人可以为基于 SPA 的 html 页面（用 asp.net mvc 编写）推荐一个好的加载 HUD？

作为一个基于 SPA 的网络应用程序，我希望能够在客户端页面的数据被加载到页面中时为用户提供某种类型的基于 UI 的反馈。我喜欢新的 Windows Azure 门户中的 HUD。这是它的快照（在快照中很难看到，但中心的图像会旋转，直到加载页面内容）： ![在此处输入图像描述](../Images/fac8927b46fdeb1c5ca469aebd29cbac.png)

任何意见，将不胜感激。

谢谢

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-09-17T22:03:47.180

有一个很好的选择 @ [http://preloaders.net/](http://preloaders.net/)和[http://ajaxload.info/](http://ajaxload.info/)和

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-09-17T22:05:05.497

只需显示和隐藏一个 gif，就像[http://ajaxload.info/](http://ajaxload.info/)中的那些。

# jquery-mobile - 使部分文本字段只读jquery mobile

> ID：12467613
> 
> 赞同：0
> 
> 时间：2012-09-17T21:50:54.750
> 
> 标签：jquery-mobile

是否可以在 jquery 移动文本框中有一部分文本是只读的？

如果以下括号是我的文本框，我希望“快乐”这个词是不可触碰的

```
[happy...................] 
```

换句话说，人们应该能够删除所有这些期间，直到他们到达 y。有没有可能？

谢谢！

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-09-18T02:26:05.340

我想你可能想尝试这样的事情：

**JS/jQuery 代码：**

```
// Your untouchable string
var my_string = "happy";

$(function () {

    // The following function makes sure that when the user is typing, //
    // the user won't touch the word "happy"
    $("#my_input").keyup(function () {
        var string = $(this).val();

        if(string.length >= my_string.length) {
            if(string.substring(0, my_string.length) != my_string) {
                // This part makes sure that the user won't modify the word "happy"
                $(this).val(my_string+string.substring(my_string.length+1, string.length));
            }
        } else {
            // This part makes sure that the user won't typed:
            //   - before the word "happy" (eg: "Zhappy")
            //   - inside the word "happy" (eg: "hapZpy")
            $(this).val(my_string);
        }
    });
}); 
```

**HTML（示例）：**

```
<body>
    <div data-role="page">
        <div data-role="content">

            <!-- The value of your input is initially set to your untouchable string -->
            <input id="my_input" type="text" value="happy"/>
        </div>
    </div>
</body> 
```

希望这可以帮助。

# php - Zend Framework 不会连接到 MySQL 数据库

> ID：12467618
> 
> 赞同：1
> 
> 时间：2012-09-17T21:51:17.700
> 
> 标签：php, mysql, database, zend-framework

我正在开始一个新项目，并使用我首选的 PHP Zend 框架和 MySQL 数据库设置。

由于某种原因，我无法正确设置 Zend_Db_Adapter，因此它将成功连接到数据库。我已经在 MySQL 中设置了我的数据库，并且可以使用 mysql_connect() 连接到它，但不能使用我过去项目中使用的代码？真的很奇怪！

这是我正在使用的代码...

```
require_once 'Zend/Registry.php';
require_once 'Zend/Db/Adapter/Pdo/Mysql.php';

// Set the database connection information
$params = array('host' =>'localhost',
                'username'  =>'root',
                'password'  =>'12345',
                'dbname'    =>'testdb');

// Assign the database connection to the registry
$db = new Zend_Db_Adapter_Pdo_Mysql($params);
$db->setFetchMode(Zend_Db::FETCH_OBJ);
Zend_Registry::set('db',$db); 
```

请记住，当我使用 mysql_connect() 时，上述参数可以正常工作，但是每当我尝试使用上述参数时，都会出现控制器异常错误？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-09-27T19:30:15.153

尝试使用 application.ini 方法：

```
resources.db.adapter = "pdo_mysql"
resources.db.params.host = "localhost"
resources.db.params.username = "root"
resources.db.params.password = "12345"
resources.db.params.dbname = "testdb" 
```

然后，如果你想在 bootstrap 中连接，你可以手动进行（bootstrap 最终会自己调用它）：

```
$this->bootstrap('db'); 
```

然后访问 $db 适配器：

```
$db = Zend_Db_Table::getDefaultAdapter(); 
```

无论如何，如果您更喜欢您的方法，请向我们发送有关异常的更多数据。

# c - 回溯时如何获取文件名和行号？

> ID：12467619
> 
> 赞同：0
> 
> 时间：2012-09-17T21:51:22.710
> 
> 标签：c, windows, winapi, backtrace

我从下面的帖子中看到了一种很好的获取符号名称的方法。

[Win32 - C 代码的回溯](https://stackoverflow.com/questions/5693192/win32-backtrace-from-c-code)

但是如何获取文件名和行号。我尝试使用 SymGetLineFromAddr64 但无法获得此调试信息。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-09-17T22:43:46.037

如果您无法获得此调试信息，并且您的代码是正确的，那么问题可能出在选项上。您需要`SYMOPT_LOAD_LINES`加载此信息：

```
SymSetOptions(SYMOPT_LOAD_LINES); 
```

然后，假设您正在使用您提供的链接中的代码，它将是这样的：

```
DWORD  dwDisplacement;
IMAGEHLP_LINE64 line;

SymGetLineFromAddr64(process, (DWORD64)stack[i], &dwDisplacement, &line); 
```

现在您可以访问这些`line`成员（来自[IMAGEHLP_LINE64 结构](http://msdn.microsoft.com/en-us/library/windows/desktop/ms680190.aspx)）：

```
DWORD   LineNumber;
PTSTR   FileName; 
```

# ruby - jekyll 再生失败，带有 unicode 帖子

> ID：12467632
> 
> 赞同：3
> 
> 时间：2012-09-17T21:53:08.323
> 
> 标签：ruby, jekyll

我尝试使用**unicode**帖子（使用**utf-8编码的****俄罗斯**文本）重新生成我的**jekyll**博客，但由于以下原因无法这样做：

 ******```
D:\Dropbox\projects\blog>jekyll
Configuration from D:/Dropbox/projects/blog/_config.yml
Building site: . -> ./_site
C:/Ruby193/lib/ruby/1.9.1/rexml/text.rb:131:in `=~': incompatible encoding regexp match (UTF-8 regexp with IBM437 string) (Encoding::Compati
bilityError)
    from C:/Ruby193/lib/ruby/1.9.1/rexml/text.rb:131:in `!~'
    from C:/Ruby193/lib/ruby/1.9.1/rexml/text.rb:131:in `check'
    … 
```

[***pastebin 上的完整错误日志***](http://pastebin.com/zLRc5Bt5)

我的 _config.yml：***[（pastebin 上的完整配置）](http://pastebin.com/C7zTQ1zp)***

```
safe:        false
auto:        false
server:      false
server_port: 4000
baseurl:    /
… 
```

我检查了**[[安装 RDoc 时出错 ...]](https://stackoverflow.com/questions/7897101/error-installing-rdoc-documentation-incompatible-encoding-regexp-match)**和**[[heroku 安装问题]](http://tinkeringruby.blogspot.com/2012/01/heroku-installation.html)**，解决方案对我没有帮助。

我将提供任何补充信息来解决这个问题

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-12-04T01:27:07.147

**`chcp 65001`**没有在我的系统上运行，然后 jekyll 立即返回。

解决此错误的一种简单方法是避免帖子和页面的文件名中出现非 ASCII 字符。文件内容本身可以是 UTF-8 没有问题，如果它不以 BOM 开头。

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2012-10-10T20:12:36.120

[**`chcp 65001`**](https://github.com/mojombo/jekyll/issues/201#issuecomment-3758617)在 cmd 中每次运行 jekyll 之前都会帮助我。但我认为这不是完整的解决方案

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2013-09-28T22:07:53.423

使用以下修复：[https ://github.com/bradleywright/jekyll/commit/576f97e2610ef3259a3ea778537d244bc438da20](https://github.com/bradleywright/jekyll/commit/576f97e2610ef3259a3ea778537d244bc438da20)

它对我有用。这只是一行的更改，因此它强制以 utf-8 读取文件******

# nsis - SetAutoClose 没有按预期工作

> ID：12467634
> 
> 赞同：0
> 
> 时间：2012-09-17T21:53:26.813
> 
> 标签：nsis

```
!insertmacro MUI_PAGE_WELCOME

!define MUI_LICENSEPAGE_CHECKBOX
!insertmacro MUI_PAGE_LICENSE "license.txt"

!insertmacro MUI_PAGE_COMPONENTS
; Directory page
!insertmacro MUI_PAGE_DIRECTORY
;Confirmation Page
Page custom Confirmationpage
; Instfiles page
!insertmacro MUI_PAGE_INSTFILES
; Finish page
!insertmacro MUI_PAGE_FINISH 
```

这就是我一开始在 setup.nsi 文件中的内容。在安装结束时，我提示用户安装其他软件。如果用户选择安装第二个软件，初始软件（正在安装）应该会在安装完成后立即消失并消失。在这里我试图设置

```
SetAutoClose true 
```

但它忽略了我的 SetAutoClose 设置并打开了完成页面，提示用户点击完成（我不想要）。任何人都可以帮助我吗？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-09-17T22:57:01.180

仅当 instfiles 是最后一页时，自动关闭才有效。

如果您不想根据某些条件显示完成页面，只需调用`quit`一个部分或跳过该页面：

```
Var NoFinishPage

!insertmacro MUI_PAGE_INSTFILES
!define MUI_PAGE_CUSTOMFUNCTION_PRE maybeskipfinish
!insertmacro MUI_PAGE_FINISH
!insertmacro MUI_LANGUAGE English

Section "Other software"
ExecWait '"c:\foo\bar.exe" /baz'
StrCpy $NoFinishPage 1
SectionEnd

Function maybeskipfinish
${If} $NoFinishPage = 1
    Abort
${EndIf}
FunctionEnd 
```

# ruby-on-rails - rails rspec 请求 @cookies 和 @set_cookies

> ID：12467635
> 
> 赞同：4
> 
> 时间：2012-09-17T21:53:33.253
> 
> 标签：ruby-on-rails, cookies, rspec

我需要从 rspec 向控制器发送一个 cookie 请求。我使用 request.cookies['remember_token'] = 'foo' 来设置所需的 cookie，但是控制器以某种方式接收到先前请求留下的错误值。

例如，我设置 cookie 并在规范中发送 put 请求：

```
before do
  request.cookies['remember_token'] = 'foo'
  put 'update', calendar_id: cal.id, id: @day.id, comment: 'Test comment!'
end 
```

*将 request.inspect*放入控制器显示以下内容：

```
@set_cookies={"remember_token"=>"bar"}, @cookies={"remember_token"=>"foo"} 
```

似乎 @set_cookies={"remember_token"=>"bar"} 是从之前在同一规范中提出的请求中留下的。当我在控制器中访问 c​​ookies['remember_token'] 时，它返回来自 @set_cookies 的值，而不是 @cookies。

@set_cookies 是什么，我做错了什么？

# android - 许多线程一个处理程序和很少的经验

> ID：12467638
> 
> 赞同：0
> 
> 时间：2012-09-17T21:53:48.327
> 
> 标签：android, multithreading, synchronization, handler

我试图列出连接到 wifi 的本地机器。做到这一点的简单方法是 ping 从 abc1 到 abc255 的每个 IP，但我们都知道这需要“永远”。

因此我想使用线程！

我所拥有的是一个**MainActivity**，其中包含：

```
list = (ListView) findViewById(R.id.list);
ipList.add("Nothing yet");

adapter = new ArrayAdapter<String>(this, R.layout.simplerow, ipList);
list.setAdapter(adapter);

networkList = new NetworkList(); //This is the shared list between the Threads

for(int i = 1; i<255; i++){  //Tries to ping the range of IP's

    Ping ping = new Ping(localIP + i, networkList)
    new Thread(ping).start();
} 
```

**Ping**类实现了 Runnable：

```
public void run() {
  try {
    InetAddress address = InetAddress.getByName(IP);

    if(address.isReachable(2000)){
        synchronized(networkList){
            networkList.addIP(address.getHostAddress());
            MainActivity.handler.sendEmptyMessage(0); //probably wrong
        }
    }
  } catch (Exception e) {}
} 
```

我不确定同步的用法是否正确，但请稍等！**NetworkList**类是同步内容发生的地方：

```
public synchronized void addIP( String IP ){
    foundIPs.add(IP);
}

public synchronized ArrayList<String> getIPList(){
    return foundIPs;
} 
```

好的。回到**MainActivity**：

这可能是非常错误的，但它是我设法做到的：

```
 handler = new Handler() {
        public void sendEmptyMessage(android.os.Message msg) {
            adapter.clear();
            synchronized(networkList){
                ipList = networkList.getIPList();
            }
            adapter.notifyDataSetChanged();
        }
    }; 
```

这里有什么问题？我希望在线程得到 ping 响应时立即更新列表。换句话说，我希望看到 ListView 在找到新 IP 时展开，而不仅仅是在 ping 过程完成时检索完整列表。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-09-17T21:58:42.643

我认为问题在于适配器本身没有获得对新 IP 地址列表的引用，因此它可能会查看没有条目的最旧列表。

我可以通过查看代码看到它：

```
adapter = new ArrayAdapter<String>(this, R.layout.simplerow, ipList);
...
ipList = networkList.getIPList(); 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-09-17T22:37:31.640

随着`ipList = networkList.getIPList();`您创建一个新列表，阵列适配器对此一无所知。您应该直接在适配器上进行调用，例如 ArrayAdapter.add 或 ArrayAdapter.addAll()。

# scala - 从“Scala 第 2 版编程”一书中解释 scala 嵌套函数

> ID：12467639
> 
> 赞同：0
> 
> 时间：2012-09-17T21:53:58.533
> 
> 标签：scala

下面代码中 <- 子句的含义是什么？像作业吗？

```
class Nested {

  var filesHere = (new java.io.File(".")).listFiles()

  def fileLines(file: java.io.File) =
    scala.io.Source.fromFile(file).getLines().toList

  def grep(pattern: String) =
    for (
      file <- filesHere 
      if (file.getName.endsWith(".scala"));
      line <- fileLines(file) 
      if line.trim().matches(pattern)
    ) println(file + ": " + line.trim)

} 
```

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-09-17T21:56:23.010

它不太像赋值：更像是一个 for-each 循环，但更好。你可以在[这里](http://www.scala-lang.org/node/111)阅读。

```
scala> for(i <- List(1,2,3,4)) println(i)
1
2
3
4 
```

`i`所以这基本上说，对于集合中的每个单独项目`List(1,2,3,4)`，调用`println(i)`.

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-09-17T21:57:24.447

我发音`<-`为“in”。所以我会把代码读作“对于filesHere中的每个文件......”。运算符的作用与`:`Java foreach 循环中的运算符相同。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2014-05-21T11:18:16.490

我认为这是“for each ... from”语法，所以我会阅读您的示例

```
for (
  file <- filesHere
  ...
) 
```

如：“对于来自filesHere的每个文件”

# objective-c - 替换 NSMutableString/NSString 的一部分的简单方法

> ID：12467642
> 
> 赞同：5
> 
> 时间：2012-09-17T21:54:01.990
> 
> 标签：objective-c, str-replace

我是 iPhone 开发的新手（使用 iOS 5），我正在尝试`:`用 NSMutableString 中的空格替换。一个小时以来我一直在努力解决这个问题，它迫使我使用 `replaceOccurrencesOfString:@":" withString:@" " options:nil range:;`（我认为我可以在没有选项和范围的情况下使用它）。我已经尝试了几乎所有东西（尤其是`range`参数），但它一直在抱怨各种东西，例如`bad receiver type`.

关于如何实现这一目标的任何建议？

* * *

## 回答 #1

> 赞同：11
> 
> 时间：2012-09-17T21:57:14.703

这是您调用`replaceOccurrencesOfString:`以产生所需效果的方式：

```
[myString replaceOccurrencesOfString:@":"
                          withString:@" "
                             options:NSLiteralSearch
                               range:NSMakeRange(0, myString.length)]; 
```

# flash - 在 SWF 对象中播放 FLV 视频

> ID：12467643
> 
> 赞同：0
> 
> 时间：2012-09-17T21:54:08.457
> 
> 标签：flash, embed, flv, swfobject

问题是：我必须重做网站，尽可能少用闪存。旧网站使用带有透明背景的 flv 视频文件的 swf 对象。我有 flv 视频，但我无法将其嵌入页面。有没有办法使用下面的代码或类似的东西来做到这一点？或者我必须创建嵌入视频的新 swf 对象？

```
<script type="text/javascript">
        var flashvars = {};
        var params = {
            allowScriptAccess:'sameDomain',
            wmode: "transparent",
            scale: "allowscale"
        };
        var attributes = {
        id:'logo',
        name:'logo'
        };
        swfobject.embedSWF("logo.flv", 
                       "flash_content", 
                       "126px", "117px", "9.0.0", 
                       "expressInstall.swf", 
                        flashvars, 
                        params, 
                        attributes);
</script> 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-09-18T19:51:18.517

SWFObject 不是视频播放器，它是将 SWF 文件嵌入 HTML 文档的实用工具。FLV 文件只有在加载到基于 SWF 的播放器时才能播放。

您需要构建一个可以加载/播放 FLV 的 SWF（网上有很多[教程](http://flashartist.wordpress.com/2008/09/16/how-to-create-a-custom-flv-player/)），或者使用 3rd 方视频播放器，例如[Flowplayer](http://flowplayer.org/)。

# php - 如何使用 PHP 处理大量数据？

> ID：12467644
> 
> 赞同：0
> 
> 时间：2012-09-17T21:54:18.857
> 
> 标签：php, codeigniter, phpexcel

我的 Web 应用程序允许用户导入 excel 文件并将文件中的数据写入 mysql 数据库。问题是，当 excel 文件有很多条目，甚至 1000 行时，我得到一个错误，说 PHP 内存不足。这发生在读取文件时。我在 php.ini 文件中为 PHP 分配了 1024MB。

我的问题是，如何在 PHP 中导入如此大的数据。

我正在使用 CodeIgniter。为了阅读 excel 文件，我正在使用[这个](http://code.google.com/p/php-excel-reader/)库。

* * *

解决了。我使用 CSV 而不是 xls。我可以在几秒钟内导入 10,000 行数据。谢谢大家的帮助。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-09-17T22:11:36.010

正如其他人所说，1000条记录并不多。确保一次处理一个记录，或者一次处理几个记录，并且在完成该行或重用变量后，每次迭代使用的变量超出范围。

如果您可以通过将 excel 文件导出到 csv 来避免处理它们的必要性，那就更好了，因为您不需要这样的库（它可能有也可能没有自己的内存问题）。

如果需要，不要害怕增加内存使用量，这可以解决问题，有时购买内存是最便宜的选择。并且不要让 1 GB 吓到您，对于这样一个简单的任务来说已经很多了，但是如果您有足够的内存并且这就是您需要做的一切，那么它就足够了。

另外，如果您使用的是旧版本的 PHP，请尝试更新到 PHP 5.4，它比以前的版本更好地处理内存。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-09-18T11:53:07.270

Instead of inserting one a time in a loop. Insert 100 row at a time.

You can always run

```
INSERT INTO myTable (clo1, col2, col2) VALUES 
(val1, val2), (val3, val4), (val5, val6) ...... 
```

This way number of network transaction will reduce thus reducing resource usage.

# maven - 如何在 Gradle 构建脚本中指定 Maven 属性？

> ID：12467649
> 
> 赞同：9
> 
> 时间：2012-09-17T21:55:11.413
> 
> 标签：maven, gradle

我正在从 Maven3 迁移到 Gradle，并且以这种形式对 Spring 有传递依赖：

```
<dependency>
   <groupId>org.springframework</groupId>
   <artifactId>spring-jdbc</artifactId>
   <version>${supported-spring-version}</version>
</dependency> 
```

我无法更改依赖项的 pom.xml，那么如何解决此传递依赖项？这里有两个问题。

1.  如何以 Gradle 将其用于依赖关系解析的方式声明属性？
2.  如何声明无效 Gradle 语法的属性（例如，supported-spring-version）？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-09-18T15:37:55.900

`System.setProperty("supported-spring-version", "3.0")`广告 1.在 Gradle 构建中设置 Java 系统属性（例如）可能会完成这项工作。

广告 2\. 您没有将其声明为 Groovy 属性。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-09-17T23:02:00.483

有关详细信息，请查看： http: [//gradle.org/docs/current/userguide/artifact_dependencies_tutorial.html](http://gradle.org/docs/current/userguide/artifact_dependencies_tutorial.html)

在 gradle 中声明依赖的语法如下：

```
dependencies {
    compile group: 'org.springframework', name: 'spring-jdbc', version: '${supported-spring-version}'
    testCompile group: 'junit', name: 'junit', version: '4.+'
} 
```

要设置 support-spring-version 属性，您可以使用本教程中描述的 config.groovy 文件：http: [//mrhaki.blogspot.com/2009/11/gradle-goodness-using-properties-for.html](http://mrhaki.blogspot.com/2009/11/gradle-goodness-using-properties-for.html)

# c++ - 来自基类 C++ 的可互换派生类方法

> ID：12467657
> 
> 赞同：1
> 
> 时间：2012-09-17T21:56:19.413
> 
> 标签：c++

我很确定这是一个长期 c++ 用户的简单问题，这应该是一个模式，或者问题应该以任何其他方式解决，但鉴于我是 Python 开发人员和 C++ 的新手，我不知道它是怎么回事通常完成。

假设我有一个类，我想在其中存储一个指向对象的指针，该对象可以是尊重接口的两个不同类中的一个，例如：

```
class AllPlayers
{
  public:
  virtual void play();
};

class VlcPlayer: public AllPlayers
{
  public:
  virtual void play();
};

class Mplayer: public AllPlayers
{
  public:
  virtual void play();
};

class MyMediaPlayer
{
  public:
  MyMediaPLayer(int playerType);
  AllPlayers m_player;
};

MyMediaPlayer::MyMediaPlayer(int PlayerType)
{
  if (PlayerType == 0) {
    VlcPlayer tmp_player;
    m_player = static_cast<AllPlayers> (tmp_player);
  }
  else {
    Mplayer tmp_player;
    m_player = static_cast<AllPlayers> (tmp_player);
  }
}

MyMediaPlayer test(0);
test.play(); 
```

首先，我知道这行不通，这似乎很正常，但我怎么能得到这种效果呢？我想拥有一个类的成员，我将使用相同的方法，使用接口实现，并且我想避免每次我要使用其中一个时都尝试强制转换为每个派生类他的方法。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-09-17T22:06:42.857

C++ 是基于值的，也就是说，如果你创建了一个给定类型的对象，你就真的拥有了这个类型的对象。这不能很好地与动态多态性一起使用。要获得动态多态性，您可以使用指针或对实际对象的引用。为了获得直接的生命周期，您通常会在堆栈上分配相应的对象（如果您曾经使用指向基的指针释放派生类型的对象，请确保您的基类具有虚拟析构函数）。有了这个，你应该已经准备好了：只需通过指向基类的指针调用基类的虚函数：当你覆盖派生类中的函数时，这就是被调用的函数。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-09-17T22:17:22.580

如果你写

```
AllPlayers m_player; 
```

那将是一个实例，`AllPlayers`并且**不能**是从它派生的类的实例。

您应该改为使用指针并在堆栈上分配类。

例如：类 MyMediaPlayer { public: MyMediaPLayer(int playerType); 〜我的媒体播放器（）；所有玩家 m_player; };

```
MyMediaPlayer::MyMediaPlayer(int PlayerType)
{
  if (PlayerType == 0) {
    m_player = new VlcPlayer;
  }
  else {
    m_player = new Mplayer;
  }
}

MyMediaPlayer::~MyMediaPlayer()
{
  if (0 != m_player) {
    delete m_player;
    m_player = 0;
  }
} 
```

正如@xception 所建议的那样，使用 of`unique_ptr`可以使您不必编写代码来释放实例。

正如@DietmarKühl 正确指出的那样，您应该始终在根类（本身不派生自其他类的基类）中声明一个虚拟析构函数，就像`AllPlayers`.

```
class AllPlayers
{
  public:
  virtual ~AllPlayers();
  virtual void play(); // note: this should probably be pure virtual.
}; 
```

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-09-17T22:21:20.567

这不起作用的原因通俗地称为对象拼接。（或者，对于那些哈利波特读者来说，对象拼接）

让我们看一个例子：

```
class Foo
{
public:
    int bob;
    float fred;

    // Foo(const Foo& otherfoo); // implicit copy constructor
};

class Bar : public Foo
{
public:
    double gabe; // gabe newell is fat
    char steve;  // steve jobs is thin

    // Bar(const Bar& otherbar); // implicit copy constructor
};

int main()
{
    Foo f;
    Bar b;

    f.bob = 10;
    f.fred = 1.5;

    b.bob = 15;
    b.fred = 2.5;
    b.gabe = 1.77245385091; // sqrt(pi)
    b.steve = -4;

    f = Foo(b);
    return 0;
} 
```

这是合法有效的。问题是，Foo 的隐式复制构造函数被调用，而 Foo 的复制构造函数对 Bar 是什么一无所知。只是它包含了 Foo 所拥有的一切，以及一些额外的无关紧要的废话。因此，只有 Foo 的数据被保留；酒吧独有的数据被拼接掉。

重要的是要注意这是定义的行为：它完全按照您的指示行事。基类的子类和基类之间的转换是隐式的。此外，复制构造函数的行为是隐式的。

同样重要的是要注意，在底层，C++ 指针和引用以相同的方式工作。通过引用将 Bar 传递给 Foo 的复制构造函数是非常明智的，这种通过引用传递不会产生对象的副本。这与使用指针相同。

实际的拼接是复制构造函数咬得比它可以咀嚼的更多的直接结果。它得到一个状态比预期更多的对象，它唯一的选择是忽略额外的状态。

使用 python，这不会发生，因为所有内容都隐式存储为引用类型。由于您只使用引用（对象本身被抽象出来），因此您永远不会有机会意外拼接对象。

# sql - 在特定列上汇总具有 0 值的两列

> ID：12467666
> 
> 赞同：0
> 
> 时间：2012-09-17T21:56:57.700
> 
> 标签：sql, crystal-reports, report, crystal-reports-2008

我确定这是相当不寻常的情况，我似乎无法找到解决方案。

我正在尝试报告 SQL DB 表；该表有一个名为 sample_bucket 的字段，它定义了用作样本的大小，在这个表中我们有 size01-size24 列。此外，我们还有另一个名为“类型”的字段，我需要在类型 A 和 B 之间进行选择。

我在两个“公式字段”上使用了以下代码来根据 sample_bucket 的内容提取 sizeXX，如下所示：

公式1：

```
if {zzpom.Type}= "A" and {zzpom.SAMPLE_BK}=1 then {zzpom.SIZE01}
else
if {zzpom.Type}= "A" and {zzpom.SAMPLE_BK}=2 then {zzpom.SIZE02}
else
.
.
if {zzpom.Type}= "A" and {zzpom.SAMPLE_BK}=24 then {zzpom.SIZE24}
else 0 
```

并且

公式2：

```
if {zzpom.Type}= "B" and {zzpom.SAMPLE_BK}=1 then {zzpom.SIZE01}
else
if {zzpom.Type}= "B" and {zzpom.SAMPLE_BK}=2 then {zzpom.SIZE02}
else
.
.
if {zzpom.Type}= "B" and {zzpom.SAMPLE_BK}=24 then {zzpom.SIZE24}
else 0 
```

我过滤了，`{formula1}<>0 or {formula2}<>0`但是当我运行报告时，我得到两列而不是一列：

```
公式1 公式2 | 公式1 公式2  
  6.5 0 | 0 12
```

我试图总结报告，但看起来 CR 在传播中运行这些公式！

我需要将这两列合并到：

```
公式1 公式2  
  6.5 12
```

任何帮助将不胜感激！

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-09-18T02:18:26.000

如果这是在 CR 内，那么我猜这些公式位于单独的公式字段中。我会将公式合并到一个字段中。

```
if ({zzpom.Type}= "A" or {zzpom.Type}= "B") and {zzpom.SAMPLE_BK}=1 then {zzpom.SIZE01}
else if ({zzpom.Type}= "A" or {zzpom.Type}= "B") and {zzpom.SAMPLE_BK}=2 then {zzpom.SIZE02} 
```

# xml - 使用 XML Schema 验证 userId

> ID：12467669
> 
> 赞同：0
> 
> 时间：2012-09-17T21:57:09.930
> 
> 标签：xml, schema

是否可以使用 XML Schema 验证 job_position 中的 userId 以仅匹配“person”元素中提供的值？

```
<person id="1">
<firstName>Jo</firstName>
<lastName>Smi</lastName>
</person>
<person id="2">
<firstName>John</firstName>
<lastName>Smith</lastName>
</person> 
<job_position>
  <userId>1</userId> <!-- This is valid -->
  <position>Manager</position>
</job_position>
<job_position>
  <userId>2</userId> <!-- This is valid -->
  <position>Programmer</position>
</job_position>
<job_position>
  <userId>3</userId> <!-- This is Invalid -->
  <position>Systems Analyst</position>
</job_position> 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-09-17T23:35:43.643

您需要在元素上声明一个`key`约束，并在. 这两者都需要在元素上声明，其中所有ID 都必须是唯一的，并且所有值都需要引用一个人。通常，这将是您希望用作文档元素的元素。`person``userId``person``job_position/userId`

```
<xs:key name="user-id">
  <xs:selector xpath=".//person"/>
  <xs:field xpath="./@id"/>
</xs:key>
<xs:keyref refer="user-id" name="user-id-ref">
  <xs:selector xpath=".//job_position/userId"/>
  <xs:field xpath="."/>
</xs:keyref> 
```

* * *

## 回答 #2

> 赞同：-1
> 
> 时间：2012-09-17T22:36:23.393

您可以使用

```
<xs:element name="userId">
  <xs:simpleType>
    <xs:restriction base="xs:integer">
      <xs:enumeration value="1"/>
      <xs:enumeration value="2"/>
    </xs:restriction>
  </xs:simpleType>
</xs:element> 
```

更多示例参考：[http ://www.w3schools.com/schema/schema_facets.asp](http://www.w3schools.com/schema/schema_facets.asp)

# vba - 防止跨实例按下按钮

> ID：12467670
> 
> 赞同：1
> 
> 时间：2012-09-17T21:57:13.487
> 
> 标签：vba, ms-access-2007

我创建了一个数据库/应用程序，单击特定按钮时会在其中创建报告。刚才，两个人竟然同时按下了按钮，引起了各种不好。

有没有办法让一个按钮在被一个人点击后在多个实例中不可见？或者以某种方式锁定数据库，这样在第一个点击的人完成之前什么都做不了？

我有一个解决方案（基本上是一个停止报告创建的全局检查变量），但现在我想知道是否可以完成其他两个选项中的任何一个。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-09-17T22:56:23.463

在这里了解更多关于你的架构真的很有帮助。什么数据库？你用什么语言写过你的应用程序？并发阅读通常是大多数多用户数据库的一个重要且基本的特性。

借用 Daniel Cook 的一般概念，也许需要解释一下：不要让按钮直接运行报告。让它运行一个小子例程，首先检查一个特殊用途的表，在该表中，您表示报告“运行”，其中包含一条具有开始日期时间和结束日期时间的新记录。如果表中存在没有（空）结束日期的记录，则报告必须仍在运行，因此，不要开始报告，而是关闭按钮。否则，插入同一个表，然后开始运行报表。在该按钮上添加一个定期的、不太频繁的回调来执行相同的检查，你得到了一些接近的东西，但不是“实时的”，但应该在大多数架构中工作（不知道任何关于会话管理功能）。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-09-19T15:33:40.937

这是我所做的：

```
 If DLookup("PayLock", "table", "pkID=1") Then 'it's locked - exit
        MsgBox "Someone else has already started the pay process.", vbOKOnly
        Exit Sub
    Else
        blah blah blah...... 
```

表中的“PayLock”字段包含检查变量。在“Else”之后是单击按钮时要运行的实际代码。

仅供参考，因为他们被问到：

*   它是拆分数据库
*   有多个用户
*   是的，报告只是读取数据并将其导出到 Excel 电子表格中。

看起来这是唯一可行的解​​决方案，但似乎不优雅。我不断发现，解决我缺乏知识的方法是解决问题的实际方法……

# c# - 限制 DevExpress TextEdit 和 MemoEdit 控件的输入长度

> ID：12467674
> 
> 赞同：3
> 
> 时间：2012-09-17T21:57:23.817
> 
> 标签：c#, winforms, devexpress

我有一个项目，其中包含一些 3rd-party 控件。我的表单中有一个 TextEdit 和一个 MemoEdit，我想限制用户可以输入的字符数。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-09-17T22:02:27.820

您可以等待最新版本，但有一些解决方法，例如屏蔽、辅助属性和/或文本更改事件上的字符计数。以下是一些解决方法的链接：

掩码解决方法：http: [//www.devexpress.com/Support/Center/p/Q250641.aspx](http://www.devexpress.com/Support/Center/p/Q250641.aspx)

助手属性解决方法：http: [//www.devexpress.com/Support/Center/p/S131769.aspx](http://www.devexpress.com/Support/Center/p/S131769.aspx)

文本更改/字符数：[http ://www.qtcentre.org/threads/6776-Text-edit-and-maxLength](http://www.qtcentre.org/threads/6776-Text-edit-and-maxLength)

# outlook - custom ribbon not appearing in outlook when when running a build in vs

> ID：12467678
> 
> 赞同：20
> 
> 时间：2012-09-17T21:57:34.197
> 
> 标签：outlook, vsto, add-in, ribbon, outlook-addin

I followed [this](http://msdn.microsoft.com/en-us/library/bb608590.aspx) tutorial, but when I build then run my project in visual studio a ribbon tab does not appear. I'm using outlook 2010 if that helps.

* * *

## 回答 #1

> 赞同：76
> 
> 时间：2012-09-28T00:50:40.577

Turns out you need to set the ribbontype property to Microsoft.Outlook.Explorer for it to show up. This is not the default value for that field, and no msdn tutorial seems to tell you to make that change.

* * *

## 回答 #2

> 赞同：6
> 
> 时间：2014-10-06T18:12:19.367

[http://msdn.microsoft.com/en-us/library/bb398246.aspx](http://msdn.microsoft.com/en-us/library/bb398246.aspx)

I used this link on MSDN to fix the error. Simply says that you need to set the RibbonType property for which occurrences you want the ribbon visible/usable.

* * *

## 回答 #3

> 赞同：4
> 
> 时间：2016-10-23T21:28:22.003

This can also happen if your code previously used the [Ribbon XML](https://msdn.microsoft.com/en-us/library/aa942866.aspx) mechanism before switching to the [Ribbon Designer](https://msdn.microsoft.com/en-us/library/bb386089.aspx) mechanism, and you have inadvertently left a `CreateRibbonExtensibilityObject` override in place:

```
protected override Microsoft.Office.Core.IRibbonExtensibility CreateRibbonExtensibilityObject()
{
  return new MyRibbon(); 
} 
```

Once you remove this override, your Ribbon Designer customizations will load as expected.

* * *

## 回答 #4

> 赞同：3
> 
> 时间：2016-03-08T23:02:47.097

Old post but it didn't give me an answer. In my case the add In was simply not showing anymore after some development time for no explicit reason.

The solution was to re-enable the AddIn in Excel. It probably happened one of the time Excel was asking me "Excel is having trouble with this AddIn, disable it ?" that appeared sometimes when deploying (F5).

To reenable it go to Excel -> File -> options -> AddIns

* * *

## 回答 #5

> 赞同：3
> 
> 时间：2018-10-11T10:38:35.230

You have to select the correct ribbontype property, if you are mapping your ribbon to new mail compose tab then you have to select Microsoft.Outlook.Explorer.Compose, if you are mapping to reading mail then you have to select Microsoft.Outlook.Explorer.Read and so on.

* * *

## 回答 #6

> 赞同：1
> 
> 时间：2017-03-17T16:06:55.817

If previously you run the solution resulting in an error, an office application may still run hidden and prevent showing the Add-In. Stop VisualStudio, check taskmanager for orphan Office processes, kill these.

# jquery - JQuery 验证下拉列表

> ID：12467682
> 
> 赞同：29
> 
> 时间：2012-09-17T21:58:05.297
> 
> 标签：jquery, html, validation, drop-down-menu, jquery-validate

我正在使用[此处](http://docs.jquery.com/Plugins/Validation)的验证插件。我正在尝试强制用户在下拉列表中选择一个选项，所以这是我的 html 列表：

```
Select the best option<br/>
<select name="dd1" id="dd1">
<option value="none">None</option>
<option value="o1">option 1</option>
<option value="o2">option 2</option>
<option value="o3">option 3</option>
</select> <br/><br/>​ 
```

这是jquery验证的东西：

```
$("#everything").validate({
    onsubmit: true,
    rules: {
     dd1: {
      required: {
        depends: function(element) {
            return $("#dd1").val() == "none";
        }
      }
    },
    messages: {
     dd1: {
      required: "Please select an option from the list, if none are appropriate please select 'Other'",
     },
    }
}); 
```

我没有看到任何问题，但即使我从下拉列表中选择无并单击提交，它也不会验证它，因此不会显示任何消息。谁能告诉我我做错了什么？

* * *

## 回答 #1

> 赞同：74
> 
> 时间：2012-09-17T22:35:24.297

状态的[文档](http://docs.jquery.com/Plugins/Validation/Methods/required#dependency-callback)`required()`：

> 要强制用户从选择框中选择一个选项，请提供一个空选项，例如`<option value="">Choose...</option>`

通过`value="none"`在您的`<option>`标签中，您可以防止进行验证调用。您还可以删除您的自定义验证规则，从而简化您的代码。这是一个 jsFiddle 显示它的实际操作：

[http://jsfiddle.net/Kn3v5/](http://jsfiddle.net/Kn3v5/)

如果您无法将`value`属性更改为空字符串，我不知道该告诉您什么...我找不到任何方法来验证它。

* * *

## 回答 #2

> 赞同：8
> 
> 时间：2014-03-04T04:55:10.277

众所周知，jQuery validate 插件在 Select 字段为空值时会使其无效。为什么我们不在需要时将其值设置为空白。

是的，您可以使用一些**预定义的值**来验证选择字段。

```
$("#everything").validate({
    rules: {
        select_field:{
            required: {
                depends: function(element){
                    if('none' == $('#select_field').val()){
                        //Set predefined value to blank.
                        $('#select_field').val('');
                    }
                    return true;
                }
            }
        }
    }
}); 
```

我们可以为选择字段设置空白值，但在某些情况下我们不能。例如：使用为您生成下拉字段的函数，而您无法控制它。

我希望它有所帮助，因为它对我有帮助。

* * *

## 回答 #3

> 赞同：3
> 
> 时间：2014-12-01T16:58:12.323

这是我的解决方案：

我在 select 标签中添加了**required ：**

```
 <div class="col-lg-10">
                <select class="form-control" name="HoursEntry" id="HoursEntry" required>
                    <option value="">Select.....</option>
                    <option value="0.25">0.25</option>
                    <option value="0.5">0.50</option>
                    <option value="1">1.00</option>
                    <option value="1.25">1.25</option>
                    <option value="1.5">1.50</option>
                    <option value="2">2.00</option>
                    <option value="2.25">2.25</option>
                    <option value="2.5">2.50</option>
                    <option value="3">3.00</option>
                    <option value="3.25">3.25</option>
                    <option value="3.5">3.50</option>
                    <option value="4">4.00</option>
                    <option value="4.25">4.25</option>
                    <option value="4.5">4.50</option>
                    <option value="5">5.00</option>
                    <option value="5.25">5.25</option>
                    <option value="5.5">5.50</option>
                    <option value="6">6.00</option>
                    <option value="6.25">6.25</option>
                    <option value="6.5">6.50</option>
                    <option value="7">7.00</option>
                    <option value="7.25">7.25</option>
                    <option value="7.5">7.50</option>
                    <option value="8">8.00</option>
                </select> 
```

* * *

## 回答 #4

> 赞同：3
> 
> 时间：2018-05-16T12:33:46.303

完成它的最简单方法是添加`required`到您的`select`

```
Select the best option
<br/>

<select name="dd1" id="dd1" required>
<option value="none">None</option>
<option value="o1">option 1</option>
<option value="o2">option 2</option>
<option value="o3">option 3</option>
</select> 

<br/><br/>​ 
```

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2016-03-30T08:33:15.600

```
 <div id="msg"></div>
<!-- put above tag on body to see selected value or error -->
<script>
    $(function(){
        $("#HoursEntry").change(function(){
            var HoursEntry = $("#HoursEntry option:selected").val();
            console.log(HoursEntry);
            if(HoursEntry == "")
            {
                $("#msg").html("Please select at least One option");
                return false;
            }
            else
            {
                $("#msg").html("selected val is  "+HoursEntry);
            }
        });
    });
</script> 
```

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2014-12-17T05:15:42.047

```
$(document).ready(function(){
$("#HoursEntry").change(function(){
var HoursEntry = $(#HoursEntry option:selected).val();
if(HoursEntry == "")
{
$("#HoursEntry").html("Please select");
return false;
}
});
}); 
```

* * *

## 回答 #7

> 赞同：-1
> 
> 时间：2016-07-11T05:57:58.813

我稍微修改了你的代码。这是一个工作版本（对我来说）：

```
 <select name="dd1" id="dd1">
       <option value="none">None</option>
       <option value="o1">option 1</option>
       <option value="o2">option 2</option>
       <option value="o3">option 3</option>
    </select>  
    <div style="color:red;" id="msg_id"></div>

<script>
    $('#everything').submit(function(e){ 
        var department = $("#msg_id");
        var msg = "Please select Department";
            if ($('#dd1').val() == "") {
                department.append(msg);
                e.preventDefault();
                return false;
            }
        });
 </script> 
```

# javascript - JQuery 在链接前添加文本

> ID：12467687
> 
> 赞同：3
> 
> 时间：2012-09-17T21:58:37.480
> 
> 标签：javascript, jquery, syntax

我有一个带有链接和子链接的无序列表。我想`'»'`在列表中的子链接前面添加一个字符。我可能可以通过 CSS 来做到这一点，`list-style-image:url`但我宁愿只有文本。到目前为止，我已经尝试了 prepend，但没有取得多大成功。

HTML：

```
<nav>
<ul>
    <li><a href="#">link 1</a></li>
    <li><a href="#">link 2</a></li>
    <ul>
        <li><a href="#">sublink link 1</a></li>
        <li><a href="#">sublink link 2</a></li>
    </ul>
    <li><a href="#">link 3</a></li>
</ul>
</nav> 
```

我正在使用这段代码：

```
 $("ul li li").each(function() {
    $(this).closest('li').prepend("»").html();
   }); 
```

如果我删除一级列表项并将其添加到所有列表项，那么它可以工作，但在网络检查器中查看，`»`角色周围仍然有引号。我还尝试了最接近的东西的各种化身，`li a`但也没有什么不同。我没有收到任何语法错误，所以不确定我做错了什么。

我[这里有一个小提琴](http://jsfiddle.net/highrockmedia/E9gSV/3/)。

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-09-17T22:01:57.947

为什么不是一些CSS？

```
ul ul li:before {
 content: '»';   
} 
```

使用 JavaScript 来修改 UI 是一种资源浪费。这是主观的，不知道您的实际用例。

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2012-09-17T22:02:08.773

您的选择器不正确，也没有必要使用`html`和`each`方法。

```
$("ul ul li").prepend("»"); 
```

* * *

## 回答 #3

> 赞同：3
> 
> 时间：2012-09-17T22:05:09.467

你有一个不正确的选择器`ul li li`，暗示有一个`li`直接在一个内，`li`但在两者之间有另一个`ul`。

此外，您不需要使用 a `.each`，因为 jQuery 将返回对匹配选择器的元素集的引用。

```
$("ul ul li").prepend("»"); 
```

### [演示](http://jsfiddle.net/FranWahl/E9gSV/10/)

请注意，CSS 解决方案`Aknosis`看起来非常酷。

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2012-09-17T22:03:35.853

我认为这就是您所需要的：

```
 $("ul ul li").prepend("» "); 
```

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2012-09-17T22:02:15.700

尝试：

```
 $("ul li").each(function() {
    $(this).prepend("»").html();
 }); 
```

# javascript - 为什么这个变量未定义或未返回？

> ID：12467690
> 
> 赞同：0
> 
> 时间：2012-09-17T21:58:48.697
> 
> 标签：javascript, google-maps-api-3

我有以下代码：

```
/*
 * converts a string to geolocation and returns it
 */

function stringToLatLng(string){
    if(typeof string == "string"){
        geocoder = new google.maps.Geocoder();
        geocoder.geocode( { 'address': string}, function(results, status) {
           if (status == google.maps.GeocoderStatus.OK) {
              console.log("LatLng: "+results[0].geometry.location);
              return results[0].geometry.location;
           } else {
              console.log("Geocode was not successful for the following reason: " + status);
           }
        });
   }
} 
```

LatLng 将正确的位置打印到控制台，但是当我写这个时：

```
var pos = stringToLatLng('New York');
            console.log(pos); 
```

我`undefined`回来。这是为什么？谢谢

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-09-17T22:10:02.930

像这样的东西：

```
function stringToLatLng(strloc, callback){
    if(typeof string == "string"){
        geocoder = new google.maps.Geocoder();
        geocoder.geocode( { 'address': strloc}, function(results, status) {
           if (status == google.maps.GeocoderStatus.OK) {
              callback.call({}, results[0].geometry.location);
           } else {
              console.log("Geocode was not successful for the following reason: " + status);
           }
        });
   }
}

stringToLatLng('New York', function(pos){
    console.log(pos);
}); 
```

在您的代码中，当您返回时，实际上是从 function(results, status){..} 函数返回，而不是 stringToLatLng 函数，正如评论中所说的那样，它是一个异步调用，因此您必须使用回调。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-09-17T22:17:22.020

```
var latitude = results[0].geometry.location.lat();
var longitude = results[0].geometry.location.lng(); 
```

参考： [从地址到纬度和经度数字的 Javascript 地理编码不起作用](https://stackoverflow.com/questions/5984179/javascript-geocoding-from-address-to-latitude-and-longitude-numbers-not-working)

# matlab - 使用 MATLAB 在 x 上对函数 f(x) 进行数值积分，其中 f(x) 有另一个参数 y，它是一个向量

> ID：12467693
> 
> 赞同：3
> 
> 时间：2012-09-17T21:59:08.197
> 
> 标签：matlab, vector, integration, numerical

我想对一个向量进行数值积分，该向量表示一个函数 f(x) 在 Matlab 中由边界 x0 和 x1 指定的 x 范围内。我想检查积分的输出是否正确并且收敛。

有 quad 和 quadl 函数可以很好地识别所需的误差容限，但它们需要输入参数是函数，而不是函数的结果向量。还有一个 trapz 函数，我们可以在其中输入两个向量 x 和 f(x)，然后它根据向量 x 使用的间距计算 f(x) 关于 x 的积分。但是，没有任何方法可以使用 trapz 来调整 quad 和 quadl 中的容差并确保答案收敛。

我不能使用quad和quadl函数的主要问题是f（x）是以下等式：f（x）= sum（exp（-1/2 *（xy））），总和超过y，其中 y 是长度为 n 的向量，x 是每次都给函数 f(x) 的元素。因此，向量 y 中的所有元素都从元素 x 中减去，然后计算对 y 的总和，得到 f(x) 值。这是针对 x 的 m 个值完成的，其中 m 不等于 n。

当我按照 Matlab 手册中的说明使用 quadl 时，其中 f(x) 在单独的函数 .m 文件中定义，然后在主调用文件中定义，我使用 Q = quadl(@f,x0,x1,tolerance,X,是）；这里 X 是长度为 m 的向量，Y 是长度为 L 的向量。Matlab 给出错误：“??? Error using ==> minus Matrix dimensions must agree.” 在我在 .m 函数文件中定义函数 f(x) 的那一行。f(x) = sum(exp(-1/2 *(xy)))

我假设问题是Matlab将x和y视为向量，当它们彼此相减时应该具有相同的长度，而需要的是每次从向量X中的单个元素中减去向量Y。

您能否推荐一种解决此问题的方法，并通过控制公差的方法成功地将 f(x) 与 x 进行数值积分？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-09-18T15:01:58.650

从它的[文档](http://www.mathworks.com/help/matlab/ref/quad.html)中`quad`说：

> 函数 y = fun(x) 应该接受向量参数 x 并返回向量结果 y，即在 x 的每个元素处计算的被积函数。

所以每次我们调用函数时，我们都需要计算每个给定的被积函数`x`。

此外，要使用常量 vector 参数化函数调用`Y`，我建议使用匿名函数调用。[这里](http://www.mathworks.com/products/matlab/examples.html?file=/products/demos/shipping/matlab/anondemo.html#1)有一个合理的演示。以下是我在 Matlab 中实现您的问题的方法：

```
function Q = test_num_int(x0,x1,Y)
  Q = quad(@(x) myFun(x,Y),x0,x1);
end

function fx = myFun(x,Y)
  fy = zeros(size(Y));
  fx = zeros(size(x));
  for jj=1:length(fx)
    for ii=1:length(Y)
      fy(ii) = exp(-1/2 *(x(jj)-Y(ii)));
    end
    fx(jj) = sum(fy);
  end
end 
```

然后我调用该函数并得到以下输出：

```
Y = 0:0.1:1;
x0 = 0;
x1 = 1;
Q = test_num_int(x0,x1,Y)

Q =

   11.2544 
```

下限和上限以及常量数组的输入显然只是虚拟值，但积分很快收敛，几乎立即收敛。希望这可以帮助！

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2016-09-02T18:50:41.163

我相信以下方法也会起作用：

```
y = randn(10,1); 
func = @(x) sum(exp(-1/2 *(x-y)));
integral(func,0,1,'ArrayValued',true) 
```

# recursion - Backbone.js/Rails 模型与自身的子集合

> ID：12467694
> 
> 赞同：0
> 
> 时间：2012-09-17T21:59:13.750
> 
> 标签：recursion, backbone.js

假设：

```
Model Foo:
    -> id
    -> name
    -> description
    -> children[] 
```

其中 children 是`Foo`s 的集合。每个`Foo`都可以有零个或多个孩子，所有孩子都具有与父母相同的基本结构。

在 Backbone.js 中为此执行视图/模板的正确方法是什么？如果这有什么不同的话，我正在构建一个 Rails 应用程序。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-09-19T17:19:11.300

我最终使用了类似于此处描述的内容：[Run Template in Template (recursion) within underscore.js 模板引擎](https://stackoverflow.com/questions/8067291/run-template-in-template-recursion-within-underscore-js-template-engine)，但我使用的是 CoffeeScript，所以它略有不同：

风景：

```
# foo.js.coffee

class MyApp.Views.Foo extends Backbone.View

template: JST['foo']

inititalize: ->
    #init stuff

render: =>
    templateFn = @template
    $(@el).html(@template(model: @model, templateFn: templateFn))
    @ 
```

遗嘱内部`@model`有共享父级结构的子级。

模板：

```
# foo.jst.eco
<%# other output stuff here %>

<%# there is a 'components' attribute that contains the children %>
<% if @model.get('components') : %>
<%# recursive output of components %>
    <% for e in @model.get('components') : %>
        <% foo = new MyApp.Models.Foo() %>
        <% foo.set(e) %>
        <%# note the - instead of = below... in my case the JSON contains HTML entities %>
        <%- @templateFn(model: component, templateFn: @templateFn) %>
    <% end %>
<% end %> 
```

# c# - 从Excel表格中逐行导入数据的有效方法，将其移交给SQL数据库中的各个表端

> ID：12467698
> 
> 赞同：0
> 
> 时间：2012-09-17T21:59:33.033
> 
> 标签：c#, excel, openxml

我需要将数千条记录从 Excel 工作表中提取到 SQL 中。我构建了一个 Windows 客户端前端，允许用户选择要上传的 Excel 文件（模板化），然后逐行处理数据。我尝试使用 SSIS，但由于我是全新的，所以我在那里运气不佳。想知道我是否可以在相同的导入中有效地使用普通的旧 C# 代码，并且在最佳时间这样做？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-09-17T22:05:55.073

作为一个快速提示，为了给您指明一个有希望的方向，我建议您使用 excel 数据的数组副本。您甚至可以将它们复制到内存/生成指向它们的指针，这可能会提高您的性能。

# .net - Nhibernate Queryover 子查询和 whereexists 有 2 个条件

> ID：12467699
> 
> 赞同：1
> 
> 时间：2012-09-17T21:59:36.507
> 
> 标签：.net, fluent-nhibernate, queryover

考虑以下对象结构。

```
Product
id : int
name : string
attribute : list of Attribute

Attribute
id : int
name: string
value : string
product_id : int 
```

问题是：使用 QueryOver 如何形成子查询以返回具有以下条件的所有产品：

选择同时具有属性的所有产品：

属性名称=“颜色”值=“红色”和属性名称=“大小”值=“XXL”？

*编辑：*示例 sql：

```
select * from Product p where
exists (select id from attribute where name = 'Color' and value = 'Red' and product_id = p.id)
and
exists (select id from attribute where name = 'Size' and value = 'XXL' and product_id = p.id) 
```

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-09-19T13:06:57.450

使用计算属性匹配的子查询是最简单的 IMO

```
Product productAlias = null

// get the count of matching Attributes
var subquery = QueryOver.Of<Product>()
    .Where(p = > p.Id == productAlias.Id)
    .JoinQueryOver(p => p.Attributes)  
        .Where(a => (a.Name == "Color" && a.Value == "Red") || (a.Name == "Size" && a.Value == "XXL"))
    .Select(Projections.RowCount());

// get the Products where all match
var results = session.QueryOver(() => productAlias)
    .WithSubquery.WhereValue(2).Eq(subquery)
    .List(); 
```

如果 Attribute 类上有 Property Product，则可以缩短子查询

# c# - WP7 - 你能监控位置变化吗？

> ID：12467703
> 
> 赞同：1
> 
> 时间：2012-09-17T21:59:58.037
> 
> 标签：c#, windows-phone-7, windows-phone

有没有很好的方法来监控手机的位置？我正在开发一个应用程序，可让您签入地点，但如果用户的手机离开该地点，我想自动签出用户。因此应用程序需要每 10 或 15 分钟唤醒一次，无论手机是否被锁定，并将其当前位置与上次签到的位置进行比较。如果不相同，它会检查用户.

挑战在于，当用户离开位置时手机可能会被锁定，我不想等到用户解锁手机，或者更糟糕的是，打开应用程序来更新位置。

在 WP7 中有没有好的方法来做到这一点？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-09-17T22:14:12.767

您将需要使用[GeoCoordinateWatcher](http://msdn.microsoft.com/en-us/library/system.device.location.geocoordinatewatcher%28v=vs.92%29.aspx)和[后台任务 API](http://msdn.microsoft.com/en-us/library/windowsphone/develop/hh202942%28v=vs.92%29.aspx)。在后台任务中使用它会导致它使用缓存的位置数据。此缓存每 15 分钟更新一次。

> 此 API 用于获取设备的地理坐标，支持在后台代理中使用，但它使用缓存的位置值而不是实时数据。缓存的位置值由设备每 15 分钟更新一次。

[——MSDN](http://msdn.microsoft.com/en-us/library/hh202962%28v=VS.92%29.aspx) _

# java - 静态缓存 - 两个“实例”

> ID：12467707
> 
> 赞同：0
> 
> 时间：2012-09-17T22:00:14.840
> 
> 标签：java, caching

我有一个应用程序，我需要两个静态缓存，一个是短期的，一个是长期的。

所以我有一个看起来像这样的抽象类。我的想法是创建两个继承自这个抽象类的类，从而获得我的两个静态类。

但是，我突然想到，我正在创建 3 个对象，而我可能只需要一个对象。但我不知道该怎么做。我想要某种工厂课程吗？

有人可以在这里提出一个合适的模式吗？

```
public abstract class myCache {
    static Map<String, Object> ObjectCache = new ConcurrentHashMap<String, Object>();

    public void put(String Key, T cmsObject) {
    //
    }

      public xxx static get(String objectKey, Class<T> type) {
    //
    }
} 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-09-18T02:22:55.593

```
public abstract class myCache {

    static ConcurrentMap<Class<?>,Map<String, Object>> ObjectCache = new ConcurrentHashMap<Class<?>,Map<String, Object>>();

    {
         ObjectCache.putIfAbsent(getClass(),new ConcurrentHashMap<String,Object>());
    }

    public void put(String Key, Object cmsObject) {
         ObjectCache.get(this.getClass()).put(key,cmsObject);
    }

    public Object get(String objectKey) {
         return ObjectCache.get(this.getClass()).get(key);
    }
} 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-09-18T02:29:27.007

你的设计有缺陷：

*   缓存就是缓存 - 让缓存类负责缓存...**仅**
*   除非对象的数量很大（1000 个），否则不要让“创建的对象数量”影响您的设计
*   只有缓存类的*用户*需要知道或关心缓存的使用方式

因此：

```
public class MyClass {

    private static MyCache shortTermCache = new MyCache();
    private static MyCache longTermCache = new MyCache();

} 
```

您可以考虑将生存时间参数传递给您的缓存类构造函数，让它在一定时间后管理清除。

# android - 测试Jsoup（Eclipse+Android编程）

> ID：12467715
> 
> 赞同：1
> 
> 时间：2012-09-17T22:01:26.430
> 
> 标签：android, eclipse, jsoup

我正在 Jsoup 中迈出第一步。出去阅读食谱（http://jsoup.org/cookbook/）并尝试了一些未成功的示例。

```
 import org.jsoup.Jsoup;
import org.jsoup.nodes.Document;
import org.jsoup.nodes.Element;
import org.jsoup.select.Elements;

public static void main(String[] args) {

    Document doc = Jsoup.connect("http://en.wikipedia.org").get();
    Elements newsHeadlines = doc.select("#mp-itn b a");

} 
```

我收到以下错误：

```
Exception in thread "main" java.lang.IllegalArgumentException: usage: supply url to fetch
    at org.jsoup.helper.Validate.isTrue(Validate.java:45)
    at org.jsoup.examples.HtmlToPlainText.main(HtmlToPlainText.java:26) 
```

我对Java编程很陌生，所以请怜悯:)

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-09-17T22:26:40.903

你用的是什么版本的 Jsoup？在 PC 上使用 Jsoup 1.6.3 测试了代码，运行良好。

看起来你没有运行你的`main()`-Method，但是来自 jar 中的 jsoup 示例中的一个。

顺便提一句。您没有使用课程：

```
// your package here

import org.jsoup.Jsoup;
import org.jsoup.nodes.Document;
import org.jsoup.nodes.Element;
import org.jsoup.select.Elements;

public class Main
{
    public static void main(String[] args)
    {
        Document doc = Jsoup.connect("http://en.wikipedia.org").get();
        Elements newsHeadlines = doc.select("#mp-itn b a");

    }
} 
```

确保您运行此类，而不是示例中的类（右键单击您的类-> 运行为-> java 应用程序）。

# django - django-paypal 信号更新

> ID：12467717
> 
> 赞同：0
> 
> 时间：2012-09-17T22:01:36.573
> 
> 标签：django, django-paypal

我一直在通过 django-paypal 文档选择自己的方式，并且当我从沙盒模拟器发送 IPN 时，我得到了连接信号。

我可以：

```
UserProfile.objects.update(has_paid=True) 
```

我也可以这样做：

```
UserProfile.objects.update(middle_name=sender.custom) # sender.custom set to "Lyndon" on IPN 
```

每个人都可以免费获得一年。不是我想要的……我想做的是

```
up = UserProfile.objects.get(user=ipn_obj.custom)
up.has_paid = False
up.save() 
```

但在这种情况下，我会在即时付款通知 (IPN) 模拟器上收到服务器错误 (500) 消息。

```
IPN delivery failed. HTTP error code 500: Internal Server Error 
```

我的数据库中仍然有一个 Paypal IPN，它将显示为未标记且付款状态为“已完成”。但是，信号没有连接。

我只是在这里没有得到一些东西（或多个东西！）。任何指针都非常感谢。

吨

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-09-29T20:32:21.157

尝试使用它，

```
UserProfile.objects.filter(user=ipn_obj.custom).update(has_paid=False) 
```

对于那种你无法理解问题所在的错误，请使用 ipdb：

你应该安装ipdb，

```
$ pip install ipdb 
```

并运行转到不起作用的代码并添加，

```
import ipdb; ipdb.set_trace() 
```

当您在本地运行（我的意思是使用 runserver）并发出请求以使该代码段运行时，您将在上述行之后看到跟踪。

请注意，接下来使用“n”并继续在 ipdb 上使用“c”。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-09-21T21:28:31.637

如果我注意会有所帮助...

```
up = UserProfile.objects.get(user.username=ipn_obj.custom) 
```

用户。**用户名**...

# android - android水平垂直滚动布局与中心

> ID：12467725
> 
> 赞同：0
> 
> 时间：2012-09-17T22:02:34.327
> 
> 标签：android, xml, centering, horizontalscrollview

我需要在 xml 中创建类似的东西[，](http://i.imgur.com/iE8M9.png)但是不可能用子水平滚动视图在滚动视图中居中内部对象。

这是代码示例：

```
<ScrollView
    android:id="@+id/scrollView1"
    android:layout_width="fill_parent"
    android:layout_height="0dp"
    android:layout_weight="5"
    android:fillViewport="true" >

    <HorizontalScrollView
        android:id="@+id/horizontalScrollView1"
        android:layout_width="fill_parent"
        android:layout_height="fill_parent" >

        <RelativeLayout
            android:layout_width="fill_parent"
            android:layout_height="fill_parent" >

            <TableLayout
                android:id="@+id/matrix_table"
                android:layout_width="fill_parent"
                android:layout_height="fill_parent"
                android:layout_centerHorizontal="true"
                android:layout_centerVertical="true" >

                <!-- auto generated rows -->

            </TableLayout>

        </RelativeLayout>

    </HorizontalScrollView>

</ScrollView> 
```

这是[意想不到的结果](http://i.imgur.com/WOLpr.png)

谢谢！

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-09-17T22:16:33.690

将子视图设置为`fill_parent`在 ScrollViews 中效果不佳。相反，您应该将子视图尺寸设置为`wrap_content`并使用`layout_gravity`：

```
<HorizontalScrollView
    android:layout_width="fill_parent"
    android:layout_height="fill_parent" >

    <TableLayout
        android:layout_width="wrap_content"
        android:layout_height="wrap_content"
        android:layout_gravity="center" >
    ...

</HorizontalScrollView> 
```

# java - 斐波那契数类型

> ID：12467729
> 
> 赞同：0
> 
> 时间：2012-09-17T22:03:00.333
> 
> 标签：java, types, fibonacci

我写了一个计算斐波那契数的程序。最初，由于资源问题，我无法输入大量数字，但现在在我重新编写后，它运行速度很快。但是，如果我使用**ints**，一旦我输入大数字，数字就会变成负数。我尝试使用**long**，但它们也很快环绕。如果你不明白我的意思，那么这段代码应该解释一下：

```
`System.out.println("The 536th fibonacci number: "fib(536));`
`*The 536th fibonacci number: -8757250051716203595*` 
```

显然，在这种情况下，负数是没有意义的，所以我想知道如何才能使它**始终**有效——无论如何都不要回绕。

编辑：问题解决了！

```
import java.math.BigInteger;
public static BigInteger fib(int n)
{
    return fib2h(n,BigInteger.ONE,BigInteger.ONE);
}

public static BigInteger fibh(int n,BigInteger o,BigInteger p)
{
    if(n==1) return o;
    return fib2h(n-1,p,o.add(p));
} 
```

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2012-09-17T22:07:06.743

您可以从 java.math尝试[BigInteger 。](http://docs.oracle.com/javase/7/docs/api/java/math/BigInteger.html)

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-09-17T22:06:06.017

[BigInteger](http://docs.oracle.com/javase/1.4.2/docs/api/java/math/BigInteger.html)将帮助您实现您想要的。

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2012-09-17T22:22:20.230

您可以尝试以下（迭代）：

```
public static BigInteger fib(int n) {
    BigInteger a = BigInteger.ONE;
    BigInteger b = BigInteger.ONE;
    BigInteger c;
    for (int i = 3; i <= n; i++) {
         c = a.add(b);
         a = b;
         b = c;
    }
    return b;
} 
```

[在http://blog.paulvargas.org/numeros-fibonacci/](http://blog.paulvargas.org/numeros-fibonacci/)中查看更多信息

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2012-09-17T22:09:49.283

你可以使用[java.lang.BigInteger](http://docs.oracle.com/javase/7/docs/api/java/math/BigInteger.html)类

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2012-09-19T00:34:01.547

我解决了我的问题！我做了什么：

```
import java.math.BigInteger;
public static BigInteger fib(int n)
{
    return fib2h(n,BigInteger.ONE,BigInteger.ONE);
}

public static BigInteger fibh(int n,BigInteger o,BigInteger p)
{
    if(n==1) return o;
    return fib2h(n-1,p,o.add(p));
} 
```

# app-config - 如何在 INI 配置文件中设置布尔值？

> ID：12467731
> 
> 赞同：30
> 
> 时间：2012-09-17T22:03:13.390
> 
> 标签：app-config, ini

我已经看到了多种用于在 INI 文件中设置布尔值的方法：

*   `variable = true`
*   `variable = 1`
*   `variable = on`
*   `variable = yes`

哪种方式是最规范、最常见和/或首选的方式？

* * *

## 回答 #1

> 赞同：16
> 
> 时间：2018-01-13T12:17:19.430

INI 文件没有规范，但不管它值多少钱，我将列出我所知道的语言的一些实现的行为。

Python 的内置`configparser`模块提供了一个[`getboolean`](https://docs.python.org/3/library/configparser.html#configparser.ConfigParser.getboolean)行为如下：

> 接受的值...是`'1'`, `'yes'`, `'true'`, and `'on'`，它们会导致该方法返回`True`，以及`'0'`, `'no'`, `'false'`, and `'off'`，会导致它返回`False`。

[`parse_init_file`](http://php.net/manual/en/function.parse-ini-file.php)另一方面，在 PHP中：

> 字符串值*"true"*、*"on"*和*"yes"*被转换为**TRUE**。*"false"*、*"off"*、*"no"*和*"none"*被认为是**FALSE**。

同时，.NET 没有对 INI 解析的内置支持，但其最流行的 INI 解析库[ini-parser](https://github.com/rickyah/ini-parser)不提供对值的自动解析的任何支持，并将它们全部作为字符串返回。它的[*Getting Started*](https://github.com/rickyah/ini-parser#getting-started)示例显示了使用 .NET 解析布尔值[`Boolean.Parse`](https://docs.microsoft.com/en-us/dotnet/api/system.boolean.parse)，它将接受字符串`"true"`和`"false"`（任何大小写）并在给出其他任何内容时抛出异常。

总之：INI解析器的不同实现之间在这个问题上绝对没有一致性。

我会推荐：

*   如果您只打算使用一个解析器来解析您的 INI，请检查该解析器的行为并制作您的 INI 以适应其特定的实现。
*   如果您需要支持广泛的解析器（例如，为了语言互操作性），那么要么完全放弃 INI 作为一种格式，要么完全避免使用某些解析器理解的任何魔术布尔值，而是坚持使用`1`and `0`。

* * *

## 回答 #2

> 赞同：5
> 
> 时间：2012-09-17T23:26:12.713

这取决于 ini 文件的解析器。这些值始终是字符串。

**true/false**：在 C# 中，我可以将 true 和 false 字符串直接转换为 bool。等于可读性和易于转换。更少的代码。

**0/1**：在转换为 bool 之前，我必须将字符串 0 和 1 转换为 int。较小的 ini 文件大小。可读性较差。更多代码。

**是/否和开/关**我将不得不使用 if/switch 语句。可读。更多代码。

**我的首选方式是真/假。**对象序列化为真/假，即使它存储为 0/1，您也可以将真/假与 sql 位类型一起使用。所以唯一的缺点是尺寸在大多数情况下可能很小。

# join - 产生 RIGHT JOIN 输出的 Doctrine DQL？

> ID：12467732
> 
> 赞同：1
> 
> 时间：2012-09-17T22:03:14.857
> 
> 标签：join, doctrine, doctrine-orm, dql

我正在尝试返回所有成员的列表，如果他们有会员号，还包括他们的会员号。

模型设置如下：
成员类：

```
class Member {
    /**
     * @Id @Column(type="integer")
     * @GeneratedValue(strategy="AUTO")
     */
    protected $id;

    /** @Column(type="string", length=255) */
    protected $email = '';
} 
```

会员等级：

```
class Membership {

   /** @Id @Column(type="integer") 
    * @GeneratedValue(strategy="AUTO")
    */
   protected $id;

   /** @OneToOne(targetEntity="Member") */
   protected $member = 0;

   /** @Column(type="integer") */
   protected $membership_number = 0;
} 
```

我想创建一个返回所有成员的查询，并且如果该成员存在，还显示一个成员编号。

无法弄清楚如何做到这一点。

下面的查询选择了所有具有会员资格的成员，但不是我需要的。右连接不起作用，所以我不知道该怎么做。

```
$this->_em->createQuery("SELECT m, mb FROM Membership mb JOIN mb.member m"); 
```

# ios - 将 splitviewcontroller 与情节提要一起使用？

> ID：12467733
> 
> 赞同：0
> 
> 时间：2012-09-17T22:03:17.960
> 
> 标签：ios, xcode, ipad

我在故事板中创建了一个拆分视图控制器，顶部有一个导航栏。I also have a master view with a tableview that when selected displays the correct view in the detail view controller.

如何更新 splitview 控制器的导航栏标题？我知道我可以通过“self.navigationItem.rightBarButtonItem”访问主导航栏，但是如何从该文件访问主导航栏？

谢谢

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-09-18T03:29:40.327

如果您在顶部有一个导航栏，那么您可以像这样设置标题：

```
self.title = @"this is my title"; 
```

如果您的标题是固定的并且没有更改，那么只需将该行添加到您的 viewDidLoad 方法或您将在视图中设置项目的任何位置。

如果您尝试以编程方式设置标题，那么这取决于您在尝试设置标题时所在的视图控制器。在上面的示例中，它将为您所在的视图控制器设置它。

如果你想设置相反的视图控制器导航栏，你有几种方法可供选择，具体取决于你想要更新它的时间。

通常，尽管您会直接使用委托或间接使用 splitViewController.viewControllers 数组来引用相反的视图控制器。

听起来您已经参考了详细视图控制器。如果是这样，并且您想从 master 更改其标题，您可以这样做：

```
[self.detailViewController setTitle:@"New Title"]; 
```

希望有帮助，一切都好

# ocaml - ocamlmktop 与 oasis

> ID：12467734
> 
> 赞同：4
> 
> 时间：2012-09-17T22:03:25.087
> 
> 标签：ocaml

我在向 ocamlmktop 添加库时遇到问题。

我有一个目录*com*，其中有一个目标文件*com/com.cma*。

如果我在*com目录中运行***ocamlmktop com.cma -o top**，那么生成的可执行文件*top*似乎有库；即，我可以输入“Com.foo;;” 它将在模块 Com 中给出 foo 的类型签名。

 **但是，如果我在com 上面的目录中运行 ocamlmktop *com* **/com.cma -o top**，那么生成的可执行文件似乎没有库；即，它响应“Com.foo;;” 带有“错误：未绑定的模块 Com”。

 *有没有办法包含来自不同文件夹的库，还是我需要将所有 .cma 文件放在同一个文件夹中？

另外，我正在使用 OASIS 构建系统；我可以通知 OASIS 我想要这些库的顶层吗？

编辑：

我找到了部分解决方案：ocamlc -pack a/a.cmo b/b.cmo -o Everything.cmo，然后是 ocamlmktop Everything.cmo -o top；但是，这需要复制所有库并强制它们成为单个超级模块的子模块。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-09-18T11:29:19.543

不能使用上面目录中的toplevel 的原因是toplevel 不包含接口文件（.cmi），当用户访问某个模块时，toplevel 需要在磁盘上找到它们。`-I com`所以，要么用switch加载 toplevel ，要么在加载 issue 之后加载`#directory "com";;`。

NB OASIS 应该支持在下一个版本（0.4.0）中本地构建顶层。***

# php - 使用mysql和php查找存储数据的表名

> ID：12467738
> 
> 赞同：1
> 
> 时间：2012-09-17T22:03:45.310
> 
> 标签：php, mysql

我有一个带有 8 个表的数据库，它们打算通过加入它们来搜索 ID 号，但我想检索表的名称以在 php 中使用...

```
if($tablename == 'accounts'){
     echo 'value found in accounts';
} 
```

mysql查询会是什么？

（我不需要加入等方面的帮助，只需获取表名以及如何将其存储在 $tablename 中）

谢谢

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-09-17T22:06:49.533

```
SELECT table_name FROM INFORMATION_SCHEMA.TABLES
  WHERE table_schema = 'db_name' 
```

[19.12。INFORMATION_SCHEMA TABLES 表](http://dev.mysql.com/doc/refman/5.0/en/tables-table.html)

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-09-17T22:11:43.150

如果您一开始不知道表名，如何在表中搜索数据？

所以我想你已经知道表名，不需要像`SHOW TABLES`; 你有例如 a`WHERE`的形式

```
WHERE (table1.field LIKE '%search%' OR table2.field2 LIKE '%search%' OR ...) 
```

并且一旦检索到一行，您就知道它匹配，但您不知道匹配发生在哪里。并且运行八个直接查询而不是一个 JOINed 不是一种选择。

如果是这种情况，您必须用一个标志来补充您的 SELECTed 字段，以告诉您您需要什么：

```
SELECT ..., CASE
    WHEN accounts.field1 LIKE '%search%' THEN 'accounts'
    WHEN customers.name LIKE '%search%' THEN 'customers'
    ...
    END AS wtf FROM <rest of your query> 
```

然后在 PHP 中检索行时，您将只使用该字段：

```
print "Value found in {$row['wtf']}"; 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-09-17T22:06:58.817

'SHOW TABLES' 公平，它还在 mysql 上使用吗？:)

# python - 如何用 fromiter 构造一个 np.array

> ID：12467743
> 
> 赞同：4
> 
> 时间：2012-09-17T22:04:02.437
> 
> 标签：python, numpy

我正在尝试`np.array`通过从 python 生成器中采样来构造一个，每次调用`next`. 这是一些示例代码：

```
import numpy as np
data = np.eye(9)
labels = np.array([0,0,0,1,1,1,2,2,2])

def extract_one_class(X,labels,y):
""" Take an array of data X, a column vector array of labels, and one particular label y.  Return an array of all instances in X that have label y """

    return X[np.nonzero(labels[:] == y)[0],:]

def generate_points(data, labels, size):
""" Generate and return 'size' pairs of points drawn from different classes """

     label_alphabet = np.unique(labels)
     assert(label_alphabet.size > 1)

     for useless in xrange(size):
         shuffle(label_alphabet)
         first_class = extract_one_class(data,labels,label_alphabet[0])
         second_class = extract_one_class(data,labels,label_alphabet[1])
         pair = np.hstack((first_class[randint(0,first_class.shape[0]),:],second_class[randint(0,second_class.shape[0]),:]))
         yield pair

points = np.fromiter(generate_points(data,labels,5),dtype = np.dtype('f8',(2*data.shape[1],1))) 
```

该`extract_one_class`函数返回一个数据子集：属于一个类标签的所有数据点。我想得到**积分**`np.array`。_ `shape = (size,data.shape[1])`目前上面的代码片段返回一个错误：

```
ValueError: setting an array element with a sequence. 
```

`fromiter`声明返回一维数组的文档。还有一些人以前使用 fromiter 在 numpy 中构造记录数组（例如[http://iam.al/post/21116450281/numpy-is-my-homeboy](http://iam.al/post/21116450281/numpy-is-my-homeboy)）。

假设我可以以这种方式生成一个数组，我是否偏离了标准？还是我的 numpy 不太对劲？

* * *

## 回答 #1

> 赞同：9
> 
> 时间：2012-09-18T08:50:27.113

正如您所注意到的，文档[`np.fromiter`](http://docs.scipy.org/doc/numpy/reference/generated/numpy.fromiter.html)解释了该函数创建一维数组。您将无法以这种方式创建 2D 数组，而 @unutbu 返回您之后重塑的 1D 数组的方法是肯定的。

但是，您确实可以使用 创建结构化数组`fromiter`，如下所示：

```
>>> import itertools
>>> a = itertools.izip((1,2,3),(10,20,30))
>>> r = np.fromiter(a,dtype=[('',int),('',int)])
array([(1, 10), (2, 20), (3, 30)], 
      dtype=[('f0', '<i8'), ('f1', '<i8')]) 
```

但是，看，`r.shape=(3,)`实际上`r`只是一维记录数组，每条记录由两个整数组成。因为所有字段都相同`dtype`，所以我们可以将其`r`视为 2D 数组

```
>>> r.view((int,2))
array([[ 1, 10],
       [ 2, 20],
       [ 3, 30]]) 
```

所以，是的，您可以尝试使用`np.fromiter`like `dtype`：`[('',int)]*data.shape[1]`您将获得一个长度为 1D 的数组`size`，然后您可以将该数组视为`((int, data.shape[1]))`. 您可以使用浮点数而不是整数，重要的是所有字段都具有相同的数据类型。

如果你*真的*想要它，你可以使用一些相当复杂`dtype`的 . 考虑例如

```
r = np.fromiter(((_,) for _ in a),dtype=[('',(int,2))]) 
```

在这里，您得到一个具有 1 个字段的一维结构化数组，该字段由 2 个整数组成的数组组成。请注意使用`(_,)`确保每个记录作为元组传递（否则`np.fromiter`阻塞）。但是你需要那种复杂性吗？

另请注意，由于您事先知道数组的长度（它是`size`），因此您应该使用`counter`可选参数 of`np.fromiter`以提高效率。

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2012-09-17T22:24:21.267

您可以修改`generate_points`以产生单个浮点数而不是 np.arrays，用于`np.fromiter`形成一维数组，然后用于`.reshape(size, -1)`使其成为二维数组。

```
points = np.fromiter(
    generate_points(data,labels,5)).reshape(size, -1) 
```

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2015-06-04T14:29:34.043

根据此处的一些建议，我想出了一个相当通用的替代品`numpy.fromiter()`，可以满足 OP 的要求：

```
import numpy as np
def fromiter(iterator, dtype, *shape):
    """Generalises `numpy.fromiter()` to multi-dimesional arrays.

    Instead of the number of elements, the parameter `shape` has to be given,
    which contains the shape of the output array. The first dimension may be
    `-1`, in which case it is inferred from the iterator.
    """
    res_shape = shape[1:]
    if not res_shape:  # Fallback to the "normal" fromiter in the 1-D case           
        return np.fromiter(iterator, dtype, shape[0])

    # This wrapping of the iterator is necessary because when used with the
    # field trick, np.fromiter does not enforce consistency of the shapes
    # returned with the '_' field and silently cuts additional elements.
    def shape_checker(iterator, res_shape):
        for value in iterator:
            if value.shape != res_shape:
                raise ValueError("shape of returned object %s does not match"
                                 " given shape %s" % (value.shape, res_shape))
            yield value,

    return np.fromiter(shape_checker(iterator, res_shape),
                       [("_", dtype, res_shape)], shape[0])["_"] 
```

# sql - 左外连接不起作用？

> ID：12467744
> 
> 赞同：37
> 
> 时间：2012-09-17T22:04:22.347
> 
> 标签：sql, join, reporting-services

我有一个使用 LEFT OUTER JOIN 从三个表中提取数据的查询，用于两个连接。我需要查询返回最左边的（Salesrep 表）信息，即使两个右表（分别为处方者和处方）中没有相应的数据。当我在 WHERE 子句中不带日期参数运行此查询时，我得到了预期的回报，但是一旦我包含日期参数，我就没有返回任何内容，因为销售代表没有匹配的数据。我至少需要查看查询中请求的 salesrep 表列。

这是查询...非常感谢任何帮助。

```
SELECT  salesrep.salesrepid as SalesRepID,
        salesrep.fname as SalesrepFName,
        salesrep.lname as SalesRepLName,
        salesrep.fname+' '+salesrep.lname as SalesRepFullName,
        prescriber.dea_no as PDeaNo,
        prescriber.lname+', '+prescriber.fname as DocName,
        CONVERT(VARCHAR(8), prescriptions.filldate, 1) as FillDate,
        prescriptions.drugname as DrugName,
        prescriptions.daysupply as Supply,
        prescriptions.qtydisp as QtyDisp,
        prescriptions.rx_no as Refill,
        prescriptions.copay as Sample,
        ROUND(prescriptions.AgreedToPay-(prescriptions.AgreedToPay*.07),2) as AgreedToPay,
        prescriptions.carrierid as CarrierID
FROM    salesrep
  LEFT OUTER JOIN prescriber on salesrep.salesrepid = prescriber.salesrepid
  LEFT OUTER JOIN prescriptions on prescriber.dea_no = prescriptions.dea_no
  WHERE salesrep.salesrepid = 143 AND
        prescriptions.filldate >= '09-01-12' AND
        prescriptions.filldate <= '09-17-12'
ORDER BY prescriptions.filldate 
```

* * *

## 回答 #1

> 赞同：77
> 
> 时间：2012-09-17T22:07:23.790

您应该将约束`prescriptions.filldate`移到连接`ON`条件中，并将其从`where`子句中删除：

```
LEFT OUTER JOIN prescriptions ON prescriber.dea_no = prescriptions.dea_no
                             AND prescriptions.filldate >= '09-01-12'
                             AND prescriptions.filldate <= '09-17-12' 
```

否则，不存在的条目以s in`prescriptions`结尾，并且该子句将它们丢弃。`null``prescriptions.filldate``WHERE`

* * *

## 回答 #2

> 赞同：17
> 
> 时间：2012-09-17T22:17:20.810

[在这里](http://mssqlworld.blogspot.com/2012/04/observing-true-experts-indifferent.html)，您可以找到有关查询处理阶段的简要说明（这对于大多数 DBMS 来说很常见）。你会在那里发现，对于 OUTER JOIN：

1.  产生第一个笛卡尔连接，
2.  比对生成行子集的结果集执行 ON 条件，
3.  之后，外部行在内表的连接列上附加了 NULL，
4.  在该结果上应用 WHERE 子句执行过滤。

当您将条件放在触及外部表行的 WHERE 子句中时，它们都会被丢弃。您应该简单地将该条件放在 ON 子句中，因为该条件是在附加外部行之前评估的。

所以，这些条件：

```
prescriptions.filldate >= '09-01-12' AND
prescriptions.filldate <= '09-17-12' 
```

应移至 ON 子句。

* * *

## 回答 #3

> 赞同：3
> 
> 时间：2019-12-04T08:31:39.500

这个[小提琴](https://www.db-fiddle.com/f/mtrr6WYvQLSEShaRyKXwKr/0)可用于说明：

> 放置在 ON 子句中的限制在连接之前处理，而放置在 WHERE 子句中的限制在连接之后处理。

请注意，内连接无关紧要，但外连接很重要。[文档](https://www.postgresql.org/docs/11/queries-table-expressions.html#QUERIES-FROM)中的更多详细信息

* * *

**表t1**

```
| num | name |
| --- | ---- |
| 1   | a    |
| 2   | b    |
| 3   | c    | 
```

* * *

**表 t2**

```
| num | value |
| --- | ----- |
| 1   | xxx   |
| 3   | yyy   |
| 5   | zzz   | 
```

* * *

**ON 子句中的连接条件**

```
SELECT * FROM t1 
LEFT JOIN t2 ON t1.num = t2.num AND t2.value = 'xxx'; 
```

```
| num | name | num | value |
| --- | ---- | --- | ----- |
| 1   | a    | 1   | xxx   |
| 2   | b    |     |       |
| 3   | c    |     |       | 
```

* * *

**WHERE 子句中的连接条件**

```
SELECT * FROM t1 
LEFT JOIN t2 ON t1.num = t2.num 
WHERE t2.value = 'xxx'; 
```

```
| num | name | num | value |
| --- | ---- | --- | ----- |
| 1   | a    | 1   | xxx   | 
```

* * *

[在 DB Fiddle 上查看](https://www.db-fiddle.com/f/mtrr6WYvQLSEShaRyKXwKr/0)

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2012-09-17T22:11:32.930

这是因为您的`prescriptions.filldate`不等式正在过滤掉`salesrep`列中没有值的`prescriptions.filldate`行。

因此，如果有空值（右表中没有匹配的数据），那么包括 salesrep 数据在内的整行都会被日期过滤器过滤掉——因为`null`它不在两个日期之间。

# c# - 为什么其他 Web 项目显示我已登录？

> ID：12467751
> 
> 赞同：1
> 
> 时间：2012-09-17T22:05:13.047
> 
> 标签：c#, asp.net

我正在处理两个独立的 Web 项目，但对它们都使用相同的身份验证方案。这是我的登录代码的一部分：

```
public void Login(string username, string password, bool staySignedIn)
{
    if (this.IsLockedOut(username))
    {
        this._view.ShowMessage("Your account has been locked!");
        return;
    }
    else if (!this.IsApproved(username))
    {
        if (!string.IsNullOrEmpty(this.webContext.CurrentUserID))
        {
            this.membershipService.ChangeApprove(this.webContext.CurrentUserIdFromQuery);
            this.DoLogin(username, password, staySignedIn);
        }
        else
            this._view.ShowMessage("Your account is not activated yet");
    }
    else
        this.DoLogin(username, password, staySignedIn);
}

private void DoLogin(string username, string password, bool staySignedIn)
{
    try
    {
        FormsAuthentication.SetAuthCookie(username, staySignedIn);
        if (!string.IsNullOrEmpty(this.webContext.GetReturnUrl))
            this.redirector.GotoUrl(this.webContext.GetReturnUrl);
        else this.redirector.GotoProfileDefault();
    }
    catch (Exception ex)
    {
        this.logger.PrintToLogFile(ex, false);
        this._view.ShowMessage("Some error code");
    }
} 
```

在 project1 中，我有 3 个用户：user1、user2 和 user3，而 project2 中没有用户。我的问题是：当我以 user1 身份登录到 web project1 时，如果 web project2 在浏览器中查看，它显示我也以 user1 身份登录，并且在 project1 中使用相同的用户数据。有些事情就像我在两个网站上都登录一样。我不知道为什么。你能给我什么建议吗？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-09-17T22:10:33.933

我想网络项目是在 localhost 中运行的。我错了吗？我想您可以访问测试请求此 url`http://localhost:XXXx`因此，当您为一个网站存储了登录 cookie 时，如果另一个网站也在 localhost 域中运行，则该站点会检查您已有的 cookie。

我建议您在测试每个站点之前删除会话和 cookie。

其他好方法是在您的本地 Web 服务器中创建假域，并编辑主机文件以将域指向 127.0.0.1 并测试在导航器中编写的每个和不同假域的站点

# iphone - iphone/ipad 发展向前

> ID：12467752
> 
> 赞同：2
> 
> 时间：2012-09-17T22:05:16.430
> 
> 标签：iphone, ios, ipad

我即将开发我的第一个 iOS 应用程序，就操作系统支持而言，我应该针对 iOS 6 还是 iOS 5 构建？当新的 iOS 即将发布时，典型的行业惯例是什么？另外，向后兼容性如何？我的意思是，如果我为 5 构建，运行 6 的用户是否也能够在从 App Store 下载它时安装和运行它？此外，对于 iPhone 和 iPad 用户的新 iOS 版本，升级与不升级的典型统计数据是什么。任何关于这个主题的博客/参考资料或个人经验都会很棒！

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-09-17T22:20:56.933

您交付此应用程序的时间表是什么？除非您想利用 iOS 6 的特定功能，否则在短期内可能会更好地针对 iOS 6，但要注意不要使用 iOS 6 功能。这将能够在大多数设备上安装和运行。

如果您为 5 构建，它应该仍然能够在 iOS 6 上运行。

iOS 的升级速度相当快。请参阅我在此问题中的回答：

[iOS 6 发布后继续支持 iOS 4.x 是否值得？](https://stackoverflow.com/questions/11679412/is-it-worth-it-to-continue-supporting-ios-4-x-when-ios-6-is-released/11679604#11679604)

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-09-17T22:24:20.213

您可能会使用 iOS6 **SDK**快速进行开发。

但是**使用 iOS6 SDK 并不意味着你的应用程序只能兼容 iOS6**。这仅意味着您将能够使用 iOS6 中存在的所有方法，包括以前 API 中已经存在的方法（例如 iOS5 中），**以及**iOS6 中引入的新 API。

因此，即使您使用 iOS6 SDK，只要您使用 iOS5 中已经存在的方法（大多数方法），您的应用程序也将与 iOS5 和 iOS6 兼容。

*   如果您使用 iOS5 中已经存在并且仍然存在于 iOS6 中的方法（这是 SDK 的大多数方法），您的应用程序将在 iOS5 和 iOS6 中运行。但是您不会利用 iOS6 中引入的 iOS5 中不存在的新功能，因为 iOS5 用户在他们的操作系统中不会拥有这些功能。
*   您可以使用 iOS6 中引入但 iOS5 中不存在的新方法，但是您要么放弃对 iOS5 的支持，要么在使用之前确保检查方法的可用性。例如，如果您打算拥有一个使用某些仅在 iOS6 中引入而在 iOS5 中不存在的类或方法的按钮，请首先检查该类或方法的可用性，只有在可用时才调用它. 如果类/方法在他的操作系统版本中不可用，您可以通知用户此功能对他不可用，鼓励他升级其操作系统版本。

有关更多信息，**我强烈建议您阅读Apple 文档中的[SDK 兼容性指南](http://developer.apple.com/library/ios/#DOCUMENTATION/DeveloperTools/Conceptual/cross_development/Introduction/Introduction.html)**，其中解释了一切：SDK 版本与您支持的操作系统版本之间的差异，如何检查是否新引入的方法可以在最新的SDK中使用（即如果用户正在运行iOS5，则防止使用iOS5中不存在的方法），等等。

# asp.net - .aspx 扩展名的自定义 404 页面错误

> ID：12467757
> 
> 赞同：4
> 
> 时间：2012-09-17T22:05:49.597
> 
> 标签：asp.net, .net, http-status-code-404, episerver

我一直在尝试让我的网络应用程序重定向到自定义 404 页面。它适用于所有 url，除非它们具有“.aspx”扩展名

服务器是 Windows Server 2008，以下是我在 web.config 中的设置（以 google.com 为例）：

```
<customErrors defaultRedirect="http://www.google.com" mode="On" redirectMode="ResponseRedirect"></customErrors>

<httpErrors errorMode="Custom">
<clear />
<remove statusCode="500" subStatusCode="-1" />
<remove statusCode="404" subStatusCode="-1" />
<error statusCode="404" prefixLanguageFilePath="" path="/404-Page/" responseMode="ExecuteURL" />
<error statusCode="500" prefixLanguageFilePath="" path="/404-Page/" responseMode="ExecuteURL" />
</httpErrors> 
```

HTTP 错误再次适用于除“.aspx”扩展之外的所有内容

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-09-17T22:42:12.327

该`customErrors`元素提供有关 ASP.NET 应用程序的自定义错误消息的信息。尝试将`error`子元素添加到`customErrors`要捕获的特定 HTTP 错误代码的元素中。

```
<error statusCode="404" redirect="error404.htm"/> 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-09-19T07:05:32.007

我在 IIS6 中遇到了类似的问题。我最终在 global.asax 的 Application_Error 中处理它。为了使它工作，我必须将 404 自定义页面设置为不存在的 aspx 页面（如果我将其设置为现有的 aspx 页面，它将被 EPiServer 的内部错误处理吞没......）

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-09-26T18:48:03.403

为了解决这个问题，我们最终不得不创建一个模块来劫持任何错误并将用户转移到我在 web.config 中设置的自定义 404 页面（在 下`customErrors`）。每当应用程序出现错误时，该模块都会添加一个事件处理程序：

```
 public void Init(HttpApplication context)
    {
        context.Error += new EventHandler(FileNotFound_Error);
    } 
```

该函数`FileNoteFound_Error`进行重定向。

# linux - 将帧缓冲区映射到 X 窗口

> ID：12467766
> 
> 赞同：1
> 
> 时间：2012-09-17T22:06:43.533
> 
> 标签：linux, framebuffer, xorg

是否有任何简单的 hack 或现有应用程序可以显示现有的帧缓冲设备（例如`/dev/fb0`在 X 窗口中？因此可以同时监视多个帧缓冲应用程序或不时查看它们而无需离开桌面。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-12-22T13:24:30.000

x11vnc 不应该能够做到这一点吗？

```
x11vnc -rawfb map:/dev/fb0@1024x768x32 
```

# java - 如何使用 FileUploadPlugin 在 XWiki 中创建带有进度条的自定义 FileUpload

> ID：12467778
> 
> 赞同：1
> 
> 时间：2012-09-17T22:08:19.100
> 
> 标签：java, file-upload, progress-bar, xwiki

任何人都有关于如何在 XWiki 中使用进度条创建自定义 FileUpload 的任何想法或代码（更好）`FileUploadPlugin`？

我想要的是如何立即从 XWiki 服务器端获取进度数据？

谢谢

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-09-18T02:38:57.347

这种方法目前无法实现，服务器端部分不公开任何进度 API。

但是，如果您对在浏览器中显示上传进度感兴趣，这[已经在](http://jira.xwiki.org/browse/XWIKI-8132)最近实现（4.2 Milestone 3）。这个想法是浏览器已经跟踪上传的进度，并定期触发 JavaScript 事件。但这仅适用于实现[XMLHttpRequest 版本 2 规范](http://www.w3.org/TR/XMLHttpRequest/)的现代浏览器，除了 Internet Explorer 9 及更低版本（IE10 确实实现了它）之外，[几乎所有浏览器都使用了该规范。](http://caniuse.com/xhr2)

但是，如果您确实想实现自己的服务器端进度组件，则必须修改[FileUploadPlugin](https://github.com/xwiki/xwiki-platform/blob/70d4e7522e2cfc86c67305fa398d939cadce78de/xwiki-platform-core/xwiki-platform-oldcore/src/main/java/com/xpn/xwiki/plugin/fileupload/FileUploadPlugin.java#L245)以添加自定义进度侦听器，该侦听器已由内部使用的 Apache commons-fileupload 库支持。您如何使用该进度侦听器取决于您要对进度事件执行的操作。

# iphone - iPhone：单独的描边和填充不起作用

> ID：12467779
> 
> 赞同：0
> 
> 时间：2012-09-17T22:08:24.447
> 
> 标签：iphone, ios, cocoa-touch, core-graphics

我有以下代码：

```
 if (self.graphic.fillColor)
    {
        CGContextSetFillColorWithColor(context, self.graphic.fillColor);
        CGContextDrawPath(context, kCGPathFill);
    }

    if (self.graphic.strokeColor)
    {
        CGContextSetStrokeColorWithColor(context, self.graphic.strokeColor);
        CGContextSetLineWidth(context, self.graphic.strokeWidth);
        CGContextDrawPath(context, kCGPathStroke);
    } 
```

在某个实例中，我正在加载一个具有 a`fillColor`和 a的图形对象`strokeColor`。当我这样做时，填充已完成，但根本没有绘制笔画（我已经仔细检查过分配笔画值是否有任何错误，一切看起来都很好）。为什么是这样？如果你同时做这两个，你需要同时做，即合二为一`CGContextDrawPath`吗？

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-09-17T22:13:26.193

当您调用`CGContextDrawPath`时，CoreGraphics 会绘制（填充或描边）`CGPathRef`您之前添加到上下文中的 ，**然后`CGPathRef`从该上下文**中删除它是否已被使用。

因此，如果您已经调用`CGContextDrawPath`了您的第一个“if”条件，您只需将您的内容重新添加`CGPathRef`到您的上下文中，然后才能再次绘制它。

* * *

此外，仅当您需要填充或描边（或两者）并且如果两者都没有`fillColor`也不`strokeColor`是 nil 时不要添加它（如果您需要构建/添加您的路径，则将您的路径添加到您的上下文会更有效）不会填充或抚摸它）。

正如您自己指出的那样，无论如何，同时填充和描边都有一个常量，称为`kCGPathFillStroke`. 因此，您的代码可能如下所示：

```
// Don't draw anything if both colors are nil
if (self.graphic.fillColor || self.graphic.strokeColor)
{
  // Build and add your CGPathRef here
  CGPathRef path = ...
  CGContextAddPath(context, path);

  // Then either fill, stroke, or fillstroke the path.
  CGPathDrawingMode mode;
  if (self.graphic.fillColor)
  {
    CGContextSetFillColorWithColor(context, self.graphic.fillColor);
    mode = kCGPathFill;
  }
  if (self.graphic.strokeColor)
  {
    CGContextSetStrokeColorWithColor(context, self.graphic.strokeColor);
    CGContextSetLineWidth(context, self.graphic.strokeWidth);
    // if we also have a fillcolor, use fillstroke mode. Else just use stroke.
    mode = (self.graphic.fillColor) ? kCGPathFillStroke : kCGPathStroke;
  }
  CGContextDrawPath(context, mode);
} 
```

那样：

*   如果你只有`fillColor`没有`strokeColor`，你只会设置填充颜色和使用`kCGPathFill`。
*   如果你只有`strokeColor`和没有`fillColor`，你只会设置描边颜色和线条，并使用`kCGPathStroke`
*   如果您指定了两种颜色，您将设置填充颜色、描边颜色和线条，并使用`kCGPathFillStroke`.

# php - Ajax 成功泄漏到其他选择器

> ID：12467780
> 
> 赞同：-1
> 
> 时间：2012-09-17T22:08:37.367
> 
> 标签：php, jquery, ajax

[http://tinyns.com/wtf.php](http://tinyns.com/wtf.php)

我正在使用 jQuery Typist 来显示服务器基准测试结果。我将结果保存在数据库中，并通过 ajax.php 中的 ajax 调用它们。

问题是，结果是相互“输入”的。

```
<!DOCTYPE html PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN">

<html>
<head>

    <script src="http://code.jquery.com/jquery-latest.min.js" type=
    "text/javascript"></script>
    <script src=
    "https://raw.github.com/davidcrawford/typist-jquery/master/jquery.typist.js"
    type="text/javascript"></script>
    <script>
    $.ajax({
    url: "ajax.php?who=theirs",
    async: false,
    success: function(q) {
        $('#opp').typist({
            height: 75
        });
         $('#whoa').typist('prompt')
        .typist('type', 'dd if=' + q['if'] + ' of=/home/output.img bs=' + q['bs'] + 'k count=' + q['count'] + 'k')
        .typist('wait', 2000)
        .typist('speed', 'fast')
        .typist('echo', q['recordsIn'] + ' records in')
        .typist('echo', q['recordsOut'] + ' records in')
        .typist('echo', q['bytesCopied'] + ' bytes (' + q['mathMegs'] + ' MB) copied, ' + q['time'] + ' s, ' + q['speed'] + ' MB/s');    
    }
});
$.ajax({
    url: "ajax.php?who=us",
    async: false,
    success: function(q) {
        $('#whoa').typist({
            height: 75
        });
        $('#whoa').typist('prompt')
        .typist('type', 'dd if=' + q['if'] + ' of=/home/output.img bs=' + q['bs'] + 'k count=' + q['count'] + 'k')
        .typist('wait', 2000)
        .typist('speed', 'fast')
        .typist('echo', q['recordsIn'] + ' records in')
        .typist('echo', q['recordsOut'] + ' records in')
        .typist('echo', q['bytesCopied'] + ' bytes (' + q['mathMegs'] + ' MB) copied, ' + q['time'] + ' s, ' + q['speed'] + ' MB/s');
    }
});
</script>
    <title></title>
</head>

<body>
    <a href="#" id="doTests" name="doTests">#doTests</a>

    <h1>#opp</h1><br>
    <br>

    <div id="opp" style="font-size:15px;"></div><br>
    <br>
    <br>

    <h1>#whoa</h1><br>
    <br>

    <div id="whoa" style="font-size:15px;"></div>
</body>
</html> 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-09-17T22:15:55.423

[https://github.com/davidcrawford/typist-jquery/issues/2](https://github.com/davidcrawford/typist-jquery/issues/2)

似乎打字员插件在一页中不支持多个呼叫。

# java - Slick 变得非常慢，但只能绘制矩形

> ID：12467785
> 
> 赞同：1
> 
> 时间：2012-09-17T22:09:47.163
> 
> 标签：java, performance, frame-rate, slick2d, rectangles

几天以来，我一直在使用 slick for java，但遇到了一个严重的问题。如果我使用 800x600 的解决方案运行一个完全空的应用程序（它只显示 fps），我会得到 700 到 800 之间的 fps 计数。如果我现在将一个包含 13300 个条目的数组绘制为绿色和白色矩形网格，则 fps 下降到70左右。

随着数组中的条目越来越多，它变得非常慢。例如，在 1024x768 的解决方案和具有 21760 个条目的数组中，fps 下降到 40。

我如何绘制一个条目：

```
public void draw(Graphics graphics){
    graphics.setColor(new Color(getColor().getRed(), getColor().getGreen(), getColor().getBlue(), getColor().getAlpha()));

    graphics.fillRect(getPosition().x, getPosition().y, getSize().x, getSize().y);

    Color_ARGB white = new Color_ARGB(Color_ARGB.ColorNames.WHITE);
    graphics.setColor(new Color(white.getRed(), white.getGreen(), white.getBlue(), white.getAlpha()));
} 
```

这就是我绘制完整数组的方式：

```
public void draw(Graphics graphics) {
    for (int ix = 0; ix < getWidth(); ix++) {
        for (int iy = 0; iy < getHeight(); iy++) {
            getGameGridAt(ix, iy).draw(graphics);
        }
    }
} 
```

在我看来，21760 并没有那么多。我的代码有什么问题吗，或者是因为太慢而无法绘制这么多矩形？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-09-17T22:17:00.763

您只想绘制屏幕上的矩形。如果您的屏幕边界在 x 方向上从 0 到 1024，在 y 方向上从 0 到 768，那么您只想遍历这些边界内的矩形，然后只绘制这些矩形。我无法想象您正在尝试在这些边界内绘制 21760 个矩形。

如果是，那么尝试创建一个静态矩形，然后尝试在您需要绘制它的所有不同位置绘制该 ONE，而不是每次都创建一个新矩形。例如，在我正在制作的游戏中，我可能有 1000 个“草”图块，但所有 1000 个图块共享相同的静态纹理。所以我只需要引用一个图像，而不是每个图块都创建自己的图块。

每个矩形仍然可以具有唯一的状态。只需创建自己的矩形类并拥有一个包含 5*5 图像的静态最终图像。每个矩形在需要绘制时都会使用该图像。您仍然可以为每个矩形拥有独特的属性。例如，私有 Vector2f 位置、私有布尔 isAlive 等

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-09-17T22:13:47.807

您可能无法比这更快地绘制单个矩形。

每秒渲染数百万个多边形的游戏使用顶点缓冲区对象 (VBO)。为此，您可能需要针对 OpenGL API (LWJGL) 本身而不是包装器进行编码。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-09-17T22:16:25.257

由于您只重复使用几种颜色，因此为每一种颜色创建一个新的 Color 对象肯定会很慢......对于使用的每种不同颜色只使用一次 new 并将可重复使用的颜色存储在您班级的某处，而不是用那些调用函数，不断分配和释放内存非常慢。

虽然这可能不如不使用 new 每次都有好处，但是您是否考虑过缓存所有这些函数调用的结果并将代码重写为

```
public void draw(Graphics graphics) {
    int ixmax = getWidth();
    int iymax = getHeight();
    for (int ix = 0; ix < ixmax; ix++) {
        for (int iy = 0; iy < iymax; iy++) {
            getGameGridAt(ix, iy).draw(graphics);
        }
    }
} 
```

或者，如果您不想声明新变量

```
public void draw(Graphics graphics) {
    for (int ix = getWidth() - 1; ix >= 0; ix--) {
        for (int iy = getHeight() - 1; iy >= 0; iy--) {
            getGameGridAt(ix, iy).draw(graphics);
        }
    }
} 
```

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2012-09-17T22:28:24.307

不确定 Slick 是否允许，但如果这个东西看起来像棋盘格……你可以只画 4 个矩形，抓住它们并将生成的图像用作整个图像的纹理。我什至不是 Java 程序员，只是想提出一个解决方案。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2012-09-18T09:34:00.630

刚刚在另一个答案中注意到你有一个整体大小的网格（5x5）......在这种情况下，最快的方法似乎是将每个项目绘制一个像素（你可以直接在内存中使用 2-维数组）并将其缩放到 500% 或将其用作纹理并用它绘制一个矩形，并使用它达到您想要的最终大小......应该非常快。很抱歉之前的答案造成的所有混乱，你应该从一开始就更清楚地说明你在做什么。如果缩放和纹理不可用，您仍然可以使用类似这样的东西在内存中绘制（用 c++ 编写，请自行翻译成 java）

```
for( int x = 0; x < grid.width(); x++ ) {
   for( int y = 0; y < grid.height(); y++ ) {
      image[x*5][y*5] = grid.color[x][y];
      image[x*5][y*5 + 1] = grid.color[x][y];
      image[x*5][y*5 + 2] = grid.color[x][y];
      image[x*5][y*5 + 3] = grid.color[x][y];
      image[x*5][y*5 + 4] = grid.color[x][y];
   }
   memcpy(image[x*5+1], image[x*5], grid.height() * sizeof(image[0][0]) );
   memcpy(image[x*5+2], image[x*5], grid.height() * sizeof(image[0][0]) );
   memcpy(image[x*5+3], image[x*5], grid.height() * sizeof(image[0][0]) );
   memcpy(image[x*5+4], image[x*5], grid.height() * sizeof(image[0][0]) );
} 
```

我不确定，但也许对于图形，x 和 y 的表示顺序可能与此处使用的顺序相反，因此如果是这种情况，请相应地更改代码（只要运行几次迭代，您就会明白这一点） ，您的数据的结构也可能有所不同，但我认为这个想法应该很清楚。

# ios - 用一些数据初始化新的 UIDocument

> ID：12467791
> 
> 赞同：0
> 
> 时间：2012-09-17T22:10:03.173
> 
> 标签：ios, uidocument

我一直在这里阅读有关 UIDocument 和 UIManagedDocument 的所有内容，因为 UIManagedDocument 有更多帮助，它是 UIDocument 的子类，但我无法弄清楚我需要做什么。

当用户点击我的应用程序的添加按钮来创建新文档时，我需要创建文档并在其中预填充几个项目。只要我单步执行调试器，我的代码就可以正常工作，但是在全速情况下，这两个项目不会进入文档。

我在我的 AppDelegate 中存储了对文档的引用，并定义了一个宏以简化代码中的阅读：

```
#define SelectedDocument [(AppDelegate *)[[UIApplication sharedApplication] delegate] selectedDocument] 
```

所以在处理添加请求时，我的代码是这样的：

```
GnKDocument *tmp = [[GnKDocument alloc] initWithFileURL:fileURL];
[(AppDelegate *)[[UIApplication sharedApplication] delegate] setSelectedDocument:tmp];
[SelectedDocument saveToURL:fileURL forSaveOperation:UIDocumentSaveForCreating completionHandler:^(BOOL success) {
    if (success) {
        [SelectedDocument openWithCompletionHandler:^(BOOL success) {
            if (success) {
                [SelectedDocument setDateCreated:[NSDate date]];
                NSString *c1UUID = [SelectedDocument appendChapterWithName:@"Chapter 1"
                                                               withColor:kChapterColorYellow];
                NSString *p1c1UUID = [SelectedDocument appendPageWithParent:c1UUID
                                                                       withName:@"Page 1"
                                                                      withColor:kPageColorRed];
                NSLog(@"Just added Page 1 as %@ to chapter %@", p1c1UUID, c1UUID);
                [SelectedDocument closeWithCompletionHandler:^(BOOL success) {
                 }];
            }
     }
 }]; 
```

我的 UIDocument 子类中的两个附加调用完成它们的工作，然后调用

```
[self updateChangeCount:UIDocumentChangeDone]; 
```

作为一个测试步骤，我重写了该方法，只是为了注销正在进行的更改：

```
- (void)updateChangeCount:(UIDocumentChangeKind)change
{
     [super updateChangeCount:change];
     NSLog(@"GnKDocument recording a change");
} 
```

我做事的顺序正确吗？我应该将呼叫分派到各个队列吗？

1.  初始化实例
2.  保存以进行创建
3.  打开它（将我的初始项目添加到它）
4.  做我的补充
5.  关闭它（根据文档， closeWithCompletionHandler: 异步保存任何更改）。

同样，如果我在每次调用（saveToURL:、openWithCompletionHandler: 和 closeWithCompletionHandler）处设置断点并“跳过”这些调用，然后运行以进入完成处理程序，则文档最终会按我的意图保存在磁盘上。如果我禁用断点并再次运行，则会在磁盘上创建文档并记录更改，但关闭的文件不包含我的两个初始元素。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-09-19T03:58:49.887

在很长一段时间里，我认为差异在于代码执行的速度是创建还是避免了竞争条件。但是在调查这种可能性时，我在任何关键事件发生的地方都添加了许多 NSLog 语句......问题就消失了。所以这显然不是时间问题。回顾 NSLog 语句的内容，我意识到一些值被延迟加载，在 NSLog 语句中引用它们的行为导致它们被加载。同样，在单步执行代码时，我怀疑“打印...的描述”命令具有相同的效果（也许）。

因此，在我的例子中，UIDocument 子类构建了一个包含两个文件的文件包装器，一个用于有关文档的元数据，另一个用于实际文档数据。有一个测试来验证文档中的最小正确性，并且该测试使用了元数据文件中的值，这些值本来是要延迟加载但从未被访问过，因此该测试确定该文件无效并设置了所有初始值再一次，清除了我在文件中预填充的两个项目。

# ios - 如何在 iOS 6 上设置状态栏色调？

> ID：12467794
> 
> 赞同：23
> 
> 时间：2012-09-17T22:10:18.727
> 
> 标签：ios, ios6

如 Apple 2012 年 9 月的主题演讲所示，iOS 6 中不同应用程序的状态栏色调不同。例如，Safari 和 Maps 使用黑色状态栏，而 Mail 为其添加了蓝色色调。

是否可以设置该色调，或者至少将其强制为黑色？

* * *

## 回答 #1

> 赞同：28
> 
> 时间：2012-09-17T23:59:53.910

您可以从 Comradsky 提到的 plist 或 xcode 4.5 中执行此操作，他们在项目摘要中为它添加了一个选项。

![在此处输入图像描述](../Images/15ce8f2144738ee9365018a82b5d5038.png)

## 更新：

几个人被这个答案弄糊涂了。澄清一下，您不能将状态栏色调设置为您想要的任何颜色。上面描述的只是在启动期间更改状态栏色调并选择 iOS 6 默认状态栏颜色行为（从导航栏中选择底部一行像素的颜色）。

* * *

## 回答 #2

> 赞同：11
> 
> 时间：2012-11-17T14:44:58.557

我刚刚找到了怎么做！

1.  在“项目摘要”的“状态栏”中，将“样式”和“着色”设置为“默认”。
2.  然后，跳到您的 xib 或故事板中，并`UINavigationBar`在状态栏下方添加一个。
3.  将`UINavigationBar`“样式”设置为“默认”，然后选择您选择的“着色”。
4.  跑！:-)

如果像我一样，您不想`UINavigationBar`在界面中看到任何内容，那么您要做的就是将`UINavigationBar`所有对象放在后面，或者将“Alpha”设置为零。

* * *

## 回答 #3

> 赞同：8
> 
> 时间：2013-06-20T09:23:16.087

你可以用一种棘手的方式做到这一点..

*   在项目摘要中，从下拉菜单中选择状态栏样式黑色半透明。
*   在`application: didFinishLaunchingWithOptions:`输入以下代码行：

    `self.window.backgroundColor = [UIColor greenColor];`//示例颜色

这对我来说可以。

* * *

## 回答 #4

> 赞同：2
> 
> 时间：2012-09-20T09:46:28.400

色调似乎是由应用标题栏底部像素行的平均颜色决定的。

见这里： [http ://www.cultofmac.com/173928/how-ios-6s-cool-new-adaptive-status-bar-works/](http://www.cultofmac.com/173928/how-ios-6s-cool-new-adaptive-status-bar-works/)

* * *

## 回答 #5

> 赞同：2
> 
> 时间：2012-10-10T15:17:24.533

这很容易做到：只需在 .xib/storyboard 中放置一个 UINavigationBar，确保样式是默认的。然后添加一个色调。无论有多少视图，使用不同颜色的 UINavigationBar，您的状态栏都会改变其颜色。

* * *

## 回答 #6

> 赞同：1
> 
> 时间：2012-09-17T23:22:12.727

在 iOS 5 中没有办法。你可以改变你的栏样式。在 iOS 6 中，您可以在 info.plist 中执行此操作：

> 现在可以在应用的 Info.plist 文件中设置状态栏色调参数。您可以这样做以确保状态栏颜色与您的应用在启动期间的导航栏颜色相匹配。要设置状态栏色调，请将 UIStatusBarTintParameters 键添加到 Info.plist 文件中。此键的值是一个字典，其中包含描述应用程序在启动时具有的导航栏的适当值。字典里面应该是 UINavigationBar 键，它的值也是一个字典。该字典包含初始导航栏的样式（使用 Style 键）以及它是否是半透明的（使用 Translucent 键）。如果您的导航栏使用它们，您还可以指定其色调颜色（使用 TintColor 键）或自定义背景图像的名称（使用 BackgroundImage 键）。

[在此处查看此链接](http://www.bgr.com/2012/07/16/ios-6-download-beta-3-change-log/) 编辑：您也可以在项目摘要中执行此操作。

# c# - 为什么我的 DGV.MinimumWidth 被忽略？

> ID：12467795
> 
> 赞同：0
> 
> 时间：2012-09-17T22:10:19.897
> 
> 标签：c#, winforms, datagridview, datagridviewcolumn

使用此代码：

```
const int COMMENTS_COLUMN_DESIRED_WIDTH = 412;
...
dgv.Columns[COMMENTS_COLUMN].DefaultCellStyle.WrapMode = DataGridViewTriState.True;
                dgv.Columns[COMMENTS_COLUMN].MinimumWidth = COMMENTS_COLUMN_DESIRED_WIDTH; 
```

... COMMENTS 列按我的意愿换行，但在宽度可能为 120 像素之后，距离 412 还很远。为什么它在达到其 MinimumWidth 值之前就换行了？

数据不包含发生换行的换行符。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-09-17T22:19:42.533

我将 AutoSizeColumnsMode 从“AllCells”更改为“None”，这样就成功了。

# asp.net-mvc - 根据环境改变 autofac 组件的 asp.net mvc 最佳实践

> ID：12467796
> 
> 赞同：1
> 
> 时间：2012-09-17T22:10:19.923
> 
> 标签：asp.net-mvc, asp.net-mvc-4, inversion-of-control, autofac, webdeploy

我有一个 asp.net mvc 4 应用程序，它使用由 autofac 解析的简单依赖项。在这种情况下，依赖项是一个 IEmailSender，我想根据开发、测试和生产构建来改变它的实现。例如，开发（调试）构建将使用一种实现发送电子邮件，但生产使用说亚马逊 SES 来发送电子邮件。

根据环境改变 global.asax 文件中的容器依赖项的最佳实践方法是什么？我知道我可以将 web.config 转换与 web deploy 一起使用，然后读取 web.config 值以确定环境，然后根据环境“切换”构建配置，但也许有更好的方法？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-09-17T22:22:19.917

我会推荐您使用 Web 配置和环境转换描述的方式，因为这是它的主要目的 - 确定不同环境中的行为。您还可能最终获得更多仅调试（测试）和发布（生产）的环境。

另一种方法是使用[条件构建语句](http://msdn.microsoft.com/en-us/library/aa664622%28v=vs.71%29.aspx)，例如`[Conditional("DEBUG")]`. 但是我不推荐这种方法，因为如果你突然有了一个新环境，你很快就会用完构建配置。

# java - com.fasterxml.jackson.core.JsonParseException：意外字符

> ID：12467801
> 
> 赞同：4
> 
> 时间：2012-09-17T22:11:08.753
> 
> 标签：java, json, jersey, jax-rs, jackson

我正在使用[Jersey](http://jersey.java.net/)使用 Java (JAX-RS) 构建 REST API，并使用 Jackson 作为 JSON 处理器。当我尝试将 json 数据发布到服务时，我收到以下错误：

```
Sep 17, 2012 9:43:35 PM com.sun.jersey.spi.container.ContainerResponse mapMappableContainerException
SEVERE: The exception contained within MappableContainerException could not be mapped to a response, re-throwing to the HTTP container
com.fasterxml.jackson.core.JsonParseException: Unexpected character ('h' (code 104)): expected a valid value (number, String, array, object, 'true', 'false' or 'null')
 at [Source: org.mortbay.jetty.HttpParser$Input@549b6976; line: 1, column: 2]
    at com.fasterxml.jackson.core.JsonParser._constructError(JsonParser.java:1284)
    at com.fasterxml.jackson.core.base.ParserMinimalBase._reportError(ParserMinimalBase.java:588)
    at com.fasterxml.jackson.core.base.ParserMinimalBase._reportUnexpectedChar(ParserMinimalBase.java:509)
    at com.fasterxml.jackson.core.json.UTF8StreamJsonParser._handleUnexpectedValue(UTF8StreamJsonParser.java:2094)
    at com.fasterxml.jackson.core.json.UTF8StreamJsonParser._nextTokenNotInObject(UTF8StreamJsonParser.java:612)
    at com.fasterxml.jackson.core.json.UTF8StreamJsonParser.nextToken(UTF8StreamJsonParser.java:498)
    at com.fasterxml.jackson.databind.ObjectReader._initForReading(ObjectReader.java:997)
    at com.fasterxml.jackson.databind.ObjectReader._bind(ObjectReader.java:883)
    at com.fasterxml.jackson.databind.ObjectReader.readValue(ObjectReader.java:471)
    at com.fasterxml.jackson.jaxrs.json.JacksonJsonProvider.readFrom(JacksonJsonProvider.java:443)
    at com.sun.jersey.spi.container.ContainerRequest.getEntity(ContainerRequest.java:483)
    at com.sun.jersey.server.impl.model.method.dispatch.EntityParamDispatchProvider$EntityInjectable.getValue(EntityParamDispatchProvider.java:123)
    at com.sun.jersey.server.impl.inject.InjectableValuesProvider.getInjectableValues(InjectableValuesProvider.java:46)
    at com.sun.jersey.server.impl.model.method.dispatch.AbstractResourceMethodDispatchProvider$EntityParamInInvoker.getParams(AbstractResourceMethodDispatchProvider.java:153)
    at com.sun.jersey.server.impl.model.method.dispatch.AbstractResourceMethodDispatchProvider$ResponseOutInvoker._dispatch(AbstractResourceMethodDispatchProvider.java:203)
    at com.sun.jersey.server.impl.model.method.dispatch.ResourceJavaMethodDispatcher.dispatch(ResourceJavaMethodDispatcher.java:75)
    at com.sun.jersey.server.impl.uri.rules.HttpMethodRule.accept(HttpMethodRule.java:302)
    at com.sun.jersey.server.impl.uri.rules.ResourceClassRule.accept(ResourceClassRule.java:108)
    at com.sun.jersey.server.impl.uri.rules.RightHandPathRule.accept(RightHandPathRule.java:147)
    at com.sun.jersey.server.impl.uri.rules.RootResourceClassesRule.accept(RootResourceClassesRule.java:84)
    at com.sun.jersey.server.impl.application.WebApplicationImpl._handleRequest(WebApplicationImpl.java:1480)
    at com.sun.jersey.server.impl.application.WebApplicationImpl._handleRequest(WebApplicationImpl.java:1411)
    at com.sun.jersey.server.impl.application.WebApplicationImpl.handleRequest(WebApplicationImpl.java:1360)
    at com.sun.jersey.server.impl.application.WebApplicationImpl.handleRequest(WebApplicationImpl.java:1350)
    at com.sun.jersey.spi.container.servlet.WebComponent.service(WebComponent.java:416)
    at com.sun.jersey.spi.container.servlet.ServletContainer.service(ServletContainer.java:538)
    at com.sun.jersey.spi.container.servlet.ServletContainer.service(ServletContainer.java:716)
    at javax.servlet.http.HttpServlet.service(HttpServlet.java:717)
    at com.google.inject.servlet.ServletDefinition.doServiceImpl(ServletDefinition.java:278)
    at com.google.inject.servlet.ServletDefinition.doService(ServletDefinition.java:268)
    at com.google.inject.servlet.ServletDefinition.service(ServletDefinition.java:180)
    at com.google.inject.servlet.ManagedServletPipeline.service(ManagedServletPipeline.java:93)
    at com.google.inject.servlet.FilterChainInvocation.doFilter(FilterChainInvocation.java:85)
    at com.googlecode.objectify.cache.AsyncCacheFilter.doFilter(AsyncCacheFilter.java:59)
    at com.google.inject.servlet.FilterChainInvocation.doFilter(FilterChainInvocation.java:82)
    at quotes.auth.BraceletFilter.doFilter(BraceletFilter.java:58)
    at quotes.util.AbstractFilter.doFilter(AbstractFilter.java:48)
    at com.google.inject.servlet.FilterChainInvocation.doFilter(FilterChainInvocation.java:82)
    at com.google.appengine.tools.appstats.AppstatsFilter.doFilter(AppstatsFilter.java:141)
    at com.google.inject.servlet.FilterChainInvocation.doFilter(FilterChainInvocation.java:82)
    at com.googlecode.objectify.cache.AsyncCacheFilter.doFilter(AsyncCacheFilter.java:59)
    at com.googlecode.objectify.ObjectifyFilter.doFilter(ObjectifyFilter.java:49)
    at com.google.inject.servlet.FilterChainInvocation.doFilter(FilterChainInvocation.java:82)
    at com.google.inject.servlet.ManagedFilterPipeline.dispatch(ManagedFilterPipeline.java:120)
    at com.google.inject.servlet.GuiceFilter$1.call(GuiceFilter.java:132)
    at com.google.inject.servlet.GuiceFilter$1.call(GuiceFilter.java:129)
    at com.google.inject.servlet.GuiceFilter$Context.call(GuiceFilter.java:206)
    at com.google.inject.servlet.GuiceFilter.doFilter(GuiceFilter.java:129)
    at org.mortbay.jetty.servlet.ServletHandler$CachedChain.doFilter(ServletHandler.java:1157)
    at com.google.appengine.tools.development.HeaderVerificationFilter.doFilter(HeaderVerificationFilter.java:35)
    at org.mortbay.jetty.servlet.ServletHandler$CachedChain.doFilter(ServletHandler.java:1157)
    at com.google.appengine.api.blobstore.dev.ServeBlobFilter.doFilter(ServeBlobFilter.java:60)
    at org.mortbay.jetty.servlet.ServletHandler$CachedChain.doFilter(ServletHandler.java:1157)
    at com.google.apphosting.utils.servlet.TransactionCleanupFilter.doFilter(TransactionCleanupFilter.java:43)
    at org.mortbay.jetty.servlet.ServletHandler$CachedChain.doFilter(ServletHandler.java:1157)
    at com.google.appengine.tools.development.StaticFileFilter.doFilter(StaticFileFilter.java:125)
    at org.mortbay.jetty.servlet.ServletHandler$CachedChain.doFilter(ServletHandler.java:1157)
    at com.google.appengine.tools.development.BackendServersFilter.doFilter(BackendServersFilter.java:97)
    at org.mortbay.jetty.servlet.ServletHandler$CachedChain.doFilter(ServletHandler.java:1157)
    at org.mortbay.jetty.servlet.ServletHandler.handle(ServletHandler.java:388)
    at org.mortbay.jetty.security.SecurityHandler.handle(SecurityHandler.java:216)
    at org.mortbay.jetty.servlet.SessionHandler.handle(SessionHandler.java:182)
    at org.mortbay.jetty.handler.ContextHandler.handle(ContextHandler.java:765)
    at org.mortbay.jetty.webapp.WebAppContext.handle(WebAppContext.java:418)
    at com.google.appengine.tools.development.DevAppEngineWebAppContext.handle(DevAppEngineWebAppContext.java:94)
    at org.mortbay.jetty.handler.HandlerWrapper.handle(HandlerWrapper.java:152)
    at com.google.appengine.tools.development.JettyContainerService$ApiProxyHandler.handle(JettyContainerService.java:370)
    at org.mortbay.jetty.handler.HandlerWrapper.handle(HandlerWrapper.java:152)
    at org.mortbay.jetty.Server.handle(Server.java:326)
    at org.mortbay.jetty.HttpConnection.handleRequest(HttpConnection.java:542)
    at org.mortbay.jetty.HttpConnection$RequestHandler.content(HttpConnection.java:938)
    at org.mortbay.jetty.HttpParser.parseNext(HttpParser.java:755)
    at org.mortbay.jetty.HttpParser.parseAvailable(HttpParser.java:218)
    at org.mortbay.jetty.HttpConnection.handle(HttpConnection.java:404)
    at org.mortbay.io.nio.SelectChannelEndPoint.run(SelectChannelEndPoint.java:409)
    at org.mortbay.thread.QueuedThreadPool$PoolThread.run(QueuedThreadPool.java:582) 
```

这是我尝试发布的 json 数据：

```
{"id":null,"name":"Jack"} 
```

有什么想法可以解决这个问题吗？提前致谢。

**编辑：**

这是 POST 方法：

```
@POST
@Consumes(MediaType.APPLICATION_JSON)
public Response createModelInstance(Category model, @Context UriInfo uriInfo) {

    ofy().save().entity(model);
    URI uri = uriInfo.getAbsolutePathBuilder().clone().path(model.getId().toString()).build();
    Response response = Response.created(uri).build();

    return response;
} 
```

这是`Category`模型：

```
@Entity
@NoArgsConstructor
public class Category {

    @Getter
    @Id
    Long id;

    @Getter
    @Setter
    String name;

    public Category(String name) {
        this.name = name;
    }
} 
```

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-09-18T19:26:08.483

问题是`@Context`应该作为第一个参数而不是第二个参数传递。

# twitter-bootstrap - Twitter Bootstrap 词缀：无法固定

> ID：12467805
> 
> 赞同：3
> 
> 时间：2012-09-17T22:11:27.083
> 
> 标签：twitter-bootstrap

我正在使用最新版本的 Twitter Bootstrap 并尝试在我的网站上的 div 上实现 Affix：

```
<div id="sectiontwo" class="affix-top" data-spy="affix" data-offset-top="1000">
<div class="row sectiontwo">
<div class="span4">
<hr>
<h4>Join Headline/h4>
<hr>
</div>
</div>
</div><!--#sectiontwo--> 
```

但我收到奇怪的行为：

*   **在 Chrome 中：**
    我无法“固定”它。相反，它会在我滚动时滚动页面。

*   **在 Firefox 中：**
    我也不能“固定”它，但当它滚动时，它会跳跃并将自己固定到底部。

我想要它做的是在触发词缀部分后将自己固定到窗口的顶部。据我了解，这就是它在 Twitter Bootstrap 文档网站上的工作方式。

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2012-09-29T01:09:42.170

首先，`data-offset-top="1000"`是在词缀插件启动之前用户需要滚动的距离（以像素为单位）。

在您的情况下，用户需要滚动 1000 像素，然后词缀插件才会更改您的 div 的显示。

其次，我相信词缀插件会将你的 div 的类（滚动 1000px 后）`.affix-top`从`.affix`

由于引导程序已经将类设置`.affix`为`position: fixed`您需要做的就是在您的 css 中添加定位，例如`top: 40px;`

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-04-04T02:40:41.993

我有同样的问题并通过删除“数据偏移顶部”来解决它

# ruby-on-rails - 连接到多个数据库时，Rails 从其他请求返回结果。

> ID：12467809
> 
> 赞同：4
> 
> 时间：2012-09-17T22:11:43.073
> 
> 标签：ruby-on-rails, ruby, nginx, unicorn, multiple-databases

在运行 nginx 和 unicorn 的服务器上，我将 rails 配置为连接到两个不同的数据库。即使在轻负载下，对访问第二个 rails 数据库的端点的 Web 请求也会返回来自其他请求的结果。

例如，如果同时调用`http://example.com/user/111/address`and `http://example.com/user/222/address`，有时用户 222 的地址将在两个调用中返回，有时它会在两个调用中返回用户 111 的地址。

地址的端点是非常基本的。

```
class UserController < ApplicationController
  before_filter :load_user

  def address
    address = @user.address
    render json: address, status: 200 
  end 

  private 

  def load_user
    @user = User.find params[:id]
  end 
end 
```

模型`User`和`Address`都访问第二个数据库并从连接到该数据库的基类继承：

```
class OtherDbActiveRecord < ActiveRecord::Base
  self.abstract_class = true
  establish_connection "#{Rails.env}_other_db"
  # Prevent creation of new records and modification to existing records
  def readonly?
    return true
  end

  # Prevent objects from being destroyed
  def before_destroy
    raise ActiveRecord::ReadOnlyRecord
  end
end

class User < OtherDbActiveRecord
  has_one :address
end 

class Address < OtherDbActiveRecord
  belongs_to :user 
end 
```

是否有连接到我缺少的第二个数据库的步骤？什么可能导致 ActiveRecord 返回不同查询的结果？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-09-17T23:17:46.740

OtherDbActiveRecord 是单个对象。每个 ruby​​ 类都是一个对象，而且它是一个单独的对象。当您调用建立连接时，它会将那个（一个）对象的状态设置为给定的连接。

尝试让每个具有不同类名的重复类。

```
class User < ActiveRecord::Base
end

class UserOther < OtherDbActiveRecord
end

class Address < ActiveRecord::Base
end

class Address Other < OtherDbActiveRecord
end 
```

# symfony - Symfony - 数据库驱动登录，包括密码

> ID：12467814
> 
> 赞同：0
> 
> 时间：2012-09-17T22:12:30.200
> 
> 标签：symfony

我也是 Symfony 2 的新手，需要帮助。我正在关注本教程：[http ://symfony.com/doc/current/cookbook/security/entity_provider.html](http://symfony.com/doc/current/cookbook/security/entity_provider.html)

它有助于创建一个登录系统，我已经设法让它大部分工作。然而，在本教程中，它只解释了验证使用和电子邮件地址或用户名。它没有提到检查密码是否真的可以，或者如何告诉 Doctrine 使用哪种加密算法或必须涉及盐。

如果还有另一篇文章我应该读到有人也可以指出我，或者如果有人可以向我解释如何做这些事情，我将不胜感激:)

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-09-18T07:17:40.477

user-mgmt 的一个不错的实现是 [https://github.com/FriendsOfSymfony/FOSUserBundle](https://github.com/FriendsOfSymfony/FOSUserBundle)及其文档

用在很多项目中，自己在bundle里面挖掘的时候学到了很多

# nlp - Mark V. Shaney 仍然是生成文本的最佳方式吗？

> ID：12467817
> 
> 赞同：5
> 
> 时间：2012-09-17T22:13:11.587
> 
> 标签：nlp

我想获取大型文档并生成类似于它们的文本。我知道 Markv Chains 曾与[Mark V Shaney](http://en.wikipedia.org/wiki/Mark_V_Shaney)一起使用过。现在有更好的方法吗，还是这种方法基本上仍然是最好的？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-01-22T09:05:05.377

我不确定马尔可夫链是否是生成文本的最佳方法，但这肯定是一种简单的方法。

[在深度语言处理](http://en.wikipedia.org/wiki/Deep_linguistic_processing)中有另一种方法，使用语义到语法生成器，例如[ACE Parser/Generator](http://sweaglesw.org/linguistics/ace/)。[也许你可以通过他们的演示站点](http://erg.delph-in.net/logon)测试深度语法的生成能力。在演示站点上解析句子后，可以选择生成相似句子。

# .net - 如何在 .NET2 项目中使用 EMGU

> ID：12467818
> 
> 赞同：0
> 
> 时间：2012-09-17T22:13:14.987
> 
> 标签：.net, opencv, .net-2.0, emgucv

我正在使用 .NET2

我需要在我的项目中使用 EMGU 库。

但是当我尝试附加 EMGU DLL 时，我得到了这个按摩：

![在此处输入图像描述](../Images/0ce2fe2bd933379d41faa6714354593f.png)

我怎么能理解 .NET2 不支持 EMGU。

任何想法如何在 .NET2 项目中使用 EMGU。

先感谢您。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-09-24T05:48:01.560

`Emgu CV 2.0``.NET 3.5`至少需要

[Emgu 版本历史](http://www.emgu.com/wiki/index.php/Version_History#Emgu.CV-2.0.0.0_Alpha)

# struct - 错误 C3767：候选函数无法访问 Visual Studio 2010

> ID：12467821
> 
> 赞同：2
> 
> 时间：2012-09-17T22:13:26.460
> 
> 标签：struct, c++-cli

我收到此错误：

```
error C3767: 'phys1::point::get_prev': candidate function(s) not accessible 
```

这是我的代码

物理层

```
using namespace System;

namespace phys1 {

  typedef struct position{
    int x;
    int y;
  } pos;

 public ref class point{
   public:
     point(float speed, float gr);
   public:  
     pos get_prev();
   public: 
     pos get_next();
 };
} 
```

物理cpp

```
// This is the main DLL file.
#include "phys.h"

using namespace System;

namespace phys1 {
     ...
  static pos point::get_prev(){
    pos point;
    point.x=x;
    point.y=y;
    return point;
  }
    ...
} 
```

我尝试在库中使用的结构是否有问题？我可以用另一种方式构建它吗？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-09-17T22:19:54.030

您正在混合 C++ 语法和 C++/CLI 语法。“结构”是本机定义（C++ 定义）。

要声明“结构”，您最好使用“值结构”结构。

“不可访问”错误也可能是由于“位置”被隐式声明为“私有”。

在此处查看有关托管类型声明的更多信息：http: [//www.codeproject.com/Articles/17741/C-CLI-in-Action-Declaring-CLR-types](http://www.codeproject.com/Articles/17741/C-CLI-in-Action-Declaring-CLR-types)

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-09-17T22:18:45.200

如果您尝试`pos`跨程序集边界传递类型值，则它应该是公共托管类型。 `public value struct pos`最适合您正在做的事情。

默认情况下，本机类型在程序集边界上不可见`#pragma`，使它们可见的更多是杂物，而不是真正的解决方案。只需使用元数据制作一个适当的 .NET 类型。

# c# - 计算所有重复项并确定字符串数组每个重复出现的平均时间

> ID：12467822
> 
> 赞同：0
> 
> 时间：2012-09-17T22:13:28.057
> 
> 标签：c#

我有一个包含如下数据的数组（字符串和时间数据用逗号分隔）：

array[0]= 通道 1, 01:05:36

数组[1]= 通道 2, 02:25:36

数组[2]= 第 1 组，22:25:36

数组 [3]= 网络，41:40:09

数组[4]= LossOf，03:21:17

数组[5]= LossOf，01:13:28

数组[6]= 通道 1, 04:25:36

数组[7]= 通道 2, 00:25:36

. . . 数组[xxx]= xxx, xxx

我想计算所有重复项并确定每个重复项的平均时间，如下所示：

Item1，Channel 1，2次出现，每次出现的平均时间约为xx分钟

Item2，Channel 2，2次出现，每次出现的平均时间约为xx分钟

Item3，LossOf，2次出现，每次出现平均时间约xx分钟

时间格式为 hh:mm:ss

这是我到目前为止所做的，它只给了我重复的总次数：

```
public void CountDuplicates(string[] myStringArray)
{
  //count duplicates
  ArrayList list = new ArrayList();
  int  loopCnt=0;

  foreach (string item in myStringArray)
  {
    if (!String.IsNullOrEmpty(myStringArray[loopCnt]) == true)
      list.Add(item);
    loopCnt++;
  }

  loopCnt = 0;
  Dictionary<string, int> distinctItems = new Dictionary<string, int>();
  foreach (string item in list)
  {
    if (!distinctItems.ContainsKey(item))
    {
      distinctItems.Add(item, 0);
      loopCnt++;
    }
    distinctItems[item] += 1;
  }
  foreach (KeyValuePair<string, int> distinctItem in distinctItems)
  {
    txtDisplayResults.AppendText("Alarm Error: " + distinctItem.Key + ",  How many times: " + distinctItem.Value + "\r\n");
  }
} 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-09-17T22:31:33.517

也许是这样：

一个通道类来保存你的价值观

```
class Channel
{
    public String Name { get; set; }
    public TimeSpan Duration { get; set; }
} 
```

你的样本数据

```
var array = new[]{
    "Channel 1, 01:05:36",
    "Channel 2, 02:25:36",
    "Group 1, 22:25:36",
    "Network, 41:40:09",
    "Loss of, 03:21:17",
    "Loss of, 01:13:28",
    "Channel 1, 04:25:36",
    "Channel 2, 00:25:36",
}; 
```

查询

```
var channelGroups = array.Select(s =>
{
    var tokens = s.Split(new[] { ',' }, StringSplitOptions.RemoveEmptyEntries);
    var tsTokens = tokens[1].Split(':');
    return new Channel()
    {
        Name = tokens[0],
        Duration = new TimeSpan(
            int.Parse(tsTokens[0]),  // hours
            int.Parse(tsTokens[1]),  // minutes
            int.Parse(tsTokens[2]))  // seconds
    };
})
.GroupBy(c => c.Name)
.Select(g => new
{
    Channel = g.Key,
    Count = g.Count(),
    Average = g.Average(c => c.Duration.TotalMinutes)
}); 
```

输出：

```
foreach(var group in channelGroups)
{
   Console.WriteLine("Channel:[{0}] Count:[{1}] Average:[{2}]"
                    , group.Channel, group.Count, group.Average);
} 
```

演示：http: [//ideone.com/6dF6s](http://ideone.com/6dF6s)

```
Channel:[Channel 1] Count:[2] Average:[165.6]
Channel:[Channel 2] Count:[2] Average:[85.6]
Channel:[Group 1] Count:[1] Average:[1345.6]
Channel:[Network] Count:[1] Average:[2500.15]
Channel:[Loss of] Count:[2] Average:[137.375] 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-09-17T22:34:26.793

喜欢以下帮助？

```
var regex=new Regex(@"^(?<item>.*), (?<hours>\d{2}):(?<minutes>\d{2}):(?<seconds>\d{2})$");
var result=array.Select(a=> regex.Match(a)).Where(a=>a.Success)
           .Select (a => new { 
                               item=a.Groups["item"].Value,
                               time=decimal.Parse(a.Groups["hours"].Value)*60 + 
                                    decimal.Parse(a.Groups["minutes"].Value) +
                                    decimal.Parse(a.Groups["seconds"].Value)/60
                              })
           .GroupBy (a => a.item)
           .Select (a =>new {item=a.Key, duplicates=a.Count(),time=a.Average (b => b.time)} ); 
```

格式化为字符串，然后您可以执行以下操作：

```
var resultString=result.Aggregate(new StringBuilder(),(sb,a)=>sb.AppendFormat("Item: {0}, # of occurences: {1}, Average Time: {2:0.00}\r\n",a.item,a.duplicates,a.time)).ToString(); 
```

`resultString`现在将是您要查找的字符串。

编辑——请求使用字典后，由于元组不可用，您需要定义一个类来保存临时数据。我使用了公共字段，但您可以轻松扩展以使用私有字段周围的属性

```
public class Data { 
   public int Occurrences;
   public decimal Time;

   public Data(int occurrences, decimal time) {
     this.Occurrences=occurrences;
     this.Time=time;
   }
}

var regex=new Regex(@"^(?<item>.*), (?<hours>\d{2}):(?<minutes>\d{2}):(?<seconds>\d{2})$");
var dict = new Dictionary<string,Data>();

foreach (var entry in array) {
    if (regex.IsMatch(entry)) {
      var match=regex.Match(entry);
      var item=match.Groups["item"].Value;
      var time=decimal.Parse(match.Groups["hours"].Value)*60 + 
                                        decimal.Parse(match.Groups["minutes"].Value) +
                                        decimal.Parse(match.Groups["seconds"].Value)/60;
      if (dict.ContainsKey(item)) {
        dict[item].Occurrences++;
                dict[item].Time+=time);
      } else {
        dict[item]=new Data(1,time);
      }
    }
}

StringBuilder sb=new StringBuilder();
foreach (var key in dict.Keys) {
    sb.AppendFormat("Item: {0}, # of occurences: {1}, Average Time: {2:0.00}\r\n", key, dict[key].Occurrences, dict[key].Time / dict[key].Occurrences);
}
var resultString=sb.ToString(); 
```

# javascript - 锚点在某些页面上不起作用

> ID：12467824
> 
> 赞同：0
> 
> 时间：2012-09-17T22:13:35.710
> 
> 标签：javascript, html, navigation, anchor

这是我正在开发的网站：http: [//defend-foreclosure.com](http://defend-foreclosure.com)

如果您访问[http://defend-foreclosure.com/law.html](http://defend-foreclosure.com/law.html)并单击导航中“法律”的下拉链接，您会发现锚点工作得很好。它将每个部分的标题隐藏在标题后面，但我通过将以下脚本添加到我的 html 文件来解决此问题。

```
<script>
  $().ready(function(){
    // Fixing Anchor links nav leaving the destination text hidden under Header    
    $(window).hashchange(function() {
      var hash = "#" + location.hash.replace(/[^A-Za-z0-9_\-]/g, "");
      if (hash && $(hash).offset()) {
        var pos = $(hash).offset().top - 55;
        $(window).scrollTop(pos);
      }
    });
  });
</script> 
```

当我尝试从 law.html 以外的任何页面导航到其中一个锚点时，就会出现问题。我认为这与仅适用于 .haschange 的脚本有关，而不是普遍适用。

如果您回到家、关于或联系，并尝试单击下拉列表中的一个锚点，您会注意到它仍然会切断导航下部分的标题。有谁知道我怎样才能使它在所有页面上正常工作？

编辑：

如果我在 .haschange 之外添加以下代码，然后是一个警报，它会正常工作，发出警报，然后一旦我单击确定，它就会搞砸并再次隐藏标题。

```
<script>
    var hash = "#" + location.hash.replace(/[^A-Za-z0-9_\-]/g, "");
          if (hash && $(hash).offset()) {
            var pos = $(hash).offset().top - 55;
            $(window).scrollTop(pos);
          }
</script> 
```

编辑：我在我的 law.html 页面上将脚本缩小到以下 3 行。

```
<script>
    var shiftWindow = function() { scrollBy(0, -50) };
    if (location.hash) shiftWindow();
    window.addEventListener("hashchange", shiftWindow);
</script> 
```

这使得该功能只有在 law.html 页面上才能正常工作。从另一个页面单击导航中的锚点时，我仍然无法使其工作。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-09-17T23:33:53.427

这并不漂亮，但 chrome 似乎在页面加载事件之后触发了它的页面定位。所以我发现的唯一方法是超时

```
<script>
    $(function(){
        setTimeout(function(){
            var shiftWindow = function() { scrollBy(0, -50) };
            if (location.hash) shiftWindow();
            window.addEventListener("hashchange", shiftWindow);
        },10);
    })
</script> 
```

您也可以取消设置 id（浏览器找不到滚动的位置）并手动滚动，但之后您需要重置 id，如果您不使用超时，则没有 after

编辑 ：

为了能够将此功能与其他事件一起使用，您需要绝对滚动，因为在某些浏览器事件流中并不完全相同，可能会触发两次：

```
<script>
    $(function(){
        setTimeout(function(){
            var shiftWindow = function() { 
                var hash = "#" + location.hash.replace(/[^A-Za-z0-9_\-]/g, "");
                if (hash && $(hash).offset()) {
                    var pos = $(hash).offset().top - 55;
                    $(window).scrollTop(pos);
                }
             };
            if (location.hash) shiftWindow();
            window.addEventListener("hashchange", shiftWindow);
        },10);
    })
</script> 
```

# azure - 是否可以暂停和恢复 Windows Azure 服务器？

> ID：12467825
> 
> 赞同：10
> 
> 时间：2012-09-17T22:13:36.790
> 
> 标签：azure, suspend

我有一个每天只运行 1-2 小时的程序。有没有办法暂停 Azure 服务器，这样我就不用付钱了，然后再恢复它？暂停然后恢复的速度有多快？

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2015-01-21T02:05:47.693

在这里澄清一下，Azure 不再对停止的 VM 收费。计费变更于 2013 年在 Scott Guthrie 的博客上宣布：[停止的 VM 不收费](http://weblogs.asp.net/scottgu/windows-azure-announcing-major-improvements-for-dev-test-in-the-cloud)。

这意味着您可以使用门户或 API 来停止 VM，而无需释放资源 - 同时避免收费。

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2012-09-17T22:34:28.387

不确定您是要求 Window Azure 云服务还是 Windows Azure 虚拟机，但您确定可以直接在 Windows 门户上或使用基于 Powershell 或 REST 的服务管理 API 停止/启动这些 Azure 虚拟机。Windows Azure 门户不提供安排停止/重新启动的方法，因此您必须自己手动执行或使用某些 3rd 方服务（即 AzureWatch 等）来执行此操作。

注意：即使您关闭了虚拟机或云服务，如果您想这样做以节省成本，您仍然需要付费，然后您需要删除服务或虚拟机。重新启动/重新启动不需要很长时间，因为 VM 已经配置并准备好运行，所以现在是打开预配置 VM 的时候了。

如果您想在自己的应用程序中使用 REST API 来停止/启动，这里有一些帮助：

*   虚拟机：http: [//msdn.microsoft.com/en-us/library/windowsazure/jj157206.aspx](http://msdn.microsoft.com/en-us/library/windowsazure/jj157206.aspx)
*   云服务：http: [//msdn.microsoft.com/en-us/library/windowsazure/gg441298.aspx](http://msdn.microsoft.com/en-us/library/windowsazure/gg441298.aspx)

如果要使用 Powershell 停止/启动 Azure VM，请在下面查找“Start-AzureVM”和“Stop-AzureVM”cmdlet：

[http://msdn.microsoft.com/en-us/library/windowsazure/jj152841.aspx](http://msdn.microsoft.com/en-us/library/windowsazure/jj152841.aspx)

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2016-11-16T20:06:10.703

为了省钱，我对我的 Azure Windows VM 进行了远程桌面，然后单击了关机。然后，在我的 Azure 仪表板 ( [https://manage.windowsazure.com](https://manage.windowsazure.com) ) > VIRTUAL MACHINES > STATUS 它从正在运行更改为已停止。

但后来我读到这并没有停止计费。于是我去了微软 Azure > 虚拟机（经典） > 看到状态是已停止。但这并不意味着计费停止。我单击“停止”命令，它更改为停止（解除分配），这意味着没有（或接近 0）计费。

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2020-04-23T14:36:34.317

屏幕截图说明了一切......所以只有“解除分配”的虚拟机不会被计费！

[![在此处输入图像描述](../Images/4513b2a12d4fa77c62a5dd9b4b952519.png)](https://i.stack.imgur.com/2CPNt.png)

还有一件事要补充。与*已删除*的VM 不同，已*解除分配*的VM 仍附加有虚拟磁盘，这会消耗存储空间并因此产生成本。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2020-07-21T21:18:47.893

如果您的意思是“暂停”状态，您可以使用您的计算机实现我认为今天在 Azure 上不可用。例如，谷歌云刚刚在测试版中发布了该功能[https://cloud.google.com/compute/docs/instances/suspending-an-instance](https://cloud.google.com/compute/docs/instances/suspending-an-instance)

# c# - 多级父子排序

> ID：12467827
> 
> 赞同：4
> 
> 时间：2012-09-17T22:13:48.943
> 
> 标签：c#, asp.net, linq, hierarchical-data

我有一个物品清单

*   ID 名称 ParentID
*   1 abc 0 (level1)
*   2 定义 1
*   3吉1
*   4 jkl 0
*   5 个月 2
*   6 pqr 5
*   7 一个 1
*   8 大众 0

我希望列表排序为

abc, aaa, def, mno, ghi, jkl, vwx,

那就是我想要父母（名字的升序），它的孩子（名字的升序），孩子的子孩子（孩子的升序）等等，直到最后一级，然后是父母。我有

```
sections = new List<section>( from section in sections
                     group section by section.ParentID into children
                     orderby children.Key
                     from childSection in children.OrderBy(child => child.Name)
                     select childSection); 
```

但将列表排序为 abc、jkl、vwx、aaa、def、ghi、mno、pqr

任何人都可以让我知道我哪里出错了。

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-09-17T22:20:21.813

这是使用堆栈的完整解决方案。这绝对可以改进，但它是通用算法。

```
public class Section
{
    public int ID { get; set; }
    public string Name { get; set; }
    public int ParentID { get; set; }
}
class Program
{
    static void Main(string[] args)
    {
        var sections = new List<Section>
            {
                new Section { ID = 1, Name = "abc", ParentID = 0 },
                new Section { ID = 2, Name = "def", ParentID = 1 },
                new Section { ID = 3, Name = "ghi", ParentID = 1 },
                new Section { ID = 4, Name = "jkl", ParentID = 0 },
                new Section { ID = 5, Name = "mno", ParentID = 2 },
                new Section { ID = 6, Name = "pqr", ParentID = 5 },
                new Section { ID = 7, Name = "aaa", ParentID = 1 },
                new Section { ID = 8, Name = "vwx", ParentID = 0 }
            };

        sections = sections.OrderBy(x => x.ParentID).ThenBy(x => x.Name).ToList();
        var stack = new Stack<Section>();

        // Grab all the items without parents
        foreach (var section in sections.Where(x => x.ParentID == default(int)).Reverse())
        {
            stack.Push(section);
            sections.RemoveAt(0);   
        }

        var output = new List<Section>();
        while (stack.Any())
        {
            var currentSection = stack.Pop();

            var children = sections.Where(x => x.ParentID == currentSection.ID).Reverse();

            foreach (var section in children)
            {
                stack.Push(section);
                sections.Remove(section);
            }
            output.Add(currentSection);
        }
        sections = output;
    } 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-09-17T22:21:25.730

首先按子名称排序，然后按父 ID 排序组，否则，您现在得到的输出是绝对正确的，因为一旦记录被分组，它们仅在分组内排序。

# java - Spring MVC，在@service层处理错误并发送到jsp

> ID：12467831
> 
> 赞同：3
> 
> 时间：2012-09-17T22:15:03.827
> 
> 标签：java, validation, spring-mvc, service, multi-layer

我寻求在 Spring mvc 应用程序的 @service 层中处理错误验证的最佳方法。

我有一个@Controller 和一个@Service 类。

我的控制器：

```
public String saveProduct(Product product) {
    myService.saveProduct(product);
    return "view";
} 
```

我的服务：

```
public void saveProduct(Product product) {
    // some validation here
    myDao.save(product);
} 
```

现在假设验证导致2或3个错误（颜色不合适，供应商无法立即交付产品，等等......），我必须同时显示所有这些错误。

如何将这些错误传输到我的控制器，然后传输到我的 jsp ？使用“错误”对象？包含所有这些错误的异常？

我已经看过这里：[将错误从服务层传递回视图，](https://stackoverflow.com/questions/3224749/passing-errors-back-to-the-view-from-the-service-layer)但我找不到方便的答案。我真的必须为每个错误创建未经检查的异常吗？如果我有 20 或 30 个错误怎么办？

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-12-08T04:23:24.107

最后我创建了一个自定义异常来处理功能错误：

```
public class ServiceException extends Exception {  
    private List<String> errors = new ArrayList<>();
    (...)
} 
```

我还使用以下方法创建了一个 ValidationErrorsHelper 类：

```
public static void rejectErrors(final BindingResult result, final List<String> errors) {
    if (errors != null) {
        for (final String error : errors) {
            result.reject(error);
        }
    }
} 
```

在我的控制器类中，我捕获了异常：

```
try {
    this.myService.myFunction(...);
} catch (final ServiceException e) {
    ValidationErrorsHelper.rejectErrors(result, e.getErrors());
} 
```

这是我能找到的最好方法。如果有更好的建议，我会全力以赴！

# sql - 生成唯一的字母数字 ID

> ID：12467833
> 
> 赞同：2
> 
> 时间：2012-09-17T22:15:18.907
> 
> 标签：sql, sql-server, tsql

我的想法是为我的表在 SQL 服务器中为我的表生成一个唯一的 ID，所以我使用 Newid 函数来执行此操作，然后将结果截断为 8 个字符。我的问题是这个代码我确定有一个唯一的 ID 吗？或者也许不是这里的代码：

```
DECLARE @r varchar(8) 

SELECT @r = coalesce(@r, '') + n 
FROM (SELECT top 8 CHAR(number) n 
   FROM master..spt_values 
   WHERE type = 'P' AND 
      (number between ascii(0) and ascii(9) 
         OR number between ascii('A') and ascii('Z') 
         OR number between ascii('a') and ascii('z')) 
   ORDER BY newid()) a 

DECLARE @id varchar(10)  
SET @id=CONVERT(varchar(8), @r)  
DECLARE @myid varchar(10) 

SELECT @myid=SUBSTRING(@r,1,2)+'-'+SUBSTRING(@r,3,3)+'-'+SUBSTRING(@r,6,3)  

PRINT 'Value of @myid is: '+ @myid 
```

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-09-17T22:32:54.997

NEWID() 产生一个 v4 GUID。在该 GUID 方案中，前 8 个字节可以是任何十六进制数字 0-F，并且将完全由随机生成的数据组成。不能保证是唯一的；事实上，没有 v4 GUID 保证是唯一的，只是随机位（128 个中的 112 个）可以表示 5.19*个十亿*数之一，因此它们中的任何两个在同一系统中匹配的几率是无穷小的。只有前 8 个字节，您将只有 2^32 个组合，这可能看起来仍然很多（40 亿分之一），但由于生日问题，在生成了很少的 77,000 个之后，您有 50-50 个镜头在生成副本时。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-09-17T23:16:34.040

我认为这是一个坏主意，一次插入多行并保持唯一值会遇到问题。但是，只是为了好玩，这里有一些代码可以用 8 个字母数字字符递增一个字符串（假设值应该从 0-9 运行，然后是 AZ）：

```
DECLARE @s varchar(20)= '00-0Z-0Z-ZZ'; --INPUT
DECLARE @n char(36) = '0123456789ABCDEFGHIJKLMNOPQRSTUVWXYZ';
DECLARE @pos tinyint;
SET @s = REPLACE(@s,'-',''); --REMOVE DASHES
SET @pos = LEN(@s);
WHILE @pos > 0
BEGIN
    IF SUBSTRING(@s,@pos,1) = 'Z'
    BEGIN
        SET @s = STUFF(@s,@pos,1,'0');
        SET @pos = @pos - 1;
    END
    ELSE
    BEGIN
        SET @s = STUFF(@s,@pos,1,SUBSTRING(@n,
                                CHARINDEX(SUBSTRING(@s,@pos,1),@n)+1,1))
        SET @pos = 0
    END

END
SET @s =  SUBSTRING(@s,1,2) + '-' 
        + SUBSTRING(@s,3,2) + '-' 
        + SUBSTRING(@s,5,2) + '-' 
        + SUBSTRING(@s,7,2) -- Replace Dashes

SELECT @s --OUTPUT 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-09-17T22:31:03.097

如果我理解正确，SQL Server 的 NewId 会生成一个[GUID（全局唯一标识符）](http://en.wikipedia.org/wiki/Globally_unique_identifier)，它是一个 128 位值，通常以 32 个字符的十六进制字符串表示。

由于是有限的，它当然不能保证唯一性，因为*只有*2^128 个可能的值。但这是一个足够大的空间，碰撞很少见。

如果将其截断为 8 个字符（我假设您的意思是十六进制表示中的 8 个字符），则会大大降低唯一性的可能性，因为有 2^32 个可能的值。

当然不能保证唯一性。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2014-08-08T07:28:49.743

```
create or replace FUNCTION "GEN1_9A_Z" ( start_val varchar2)
   return varchar2
-----------------------------------------------------------------------------------------------------------   
-----------------------------------------------------------------------------------------------------------
-- GEN1_9A_Z generate next unique alphanumeric string with size 3 -- (0..9A..Z) --
                -- Return 0 when error or end (ZZZ). --
-----------------------------------------------------------------------------------------------------------
-----------------------------------------------------------------------------------------------------------
-- 001,002,..,009,00A,00B,..,00Z,
-- 010,011,..,019,01A,01B,..,01Z,
-- .............................
-- 090,091,..,099,09A,09B,..,09Z,
-- 0A0,0A1,.................,0AZ,
-- 0B0,0B1,.................,0BZ,
-- .............................
-- 0Z0,0Z1,.................,0ZZ,
-- 100,101,.................,10Z,
-- 110,111,.................,11Z,
-- .............................
-- 990,991,.................,99Z,
-- 9A0,9A1,.................,9AZ,
-- .............................
-- 9Z0,9Z1,.................,9ZZ,
-- A00,A01,.................,A0Z,
-- A10,A11,.................,A1Z,
-- .............................
-- A90,A91,.................,A9Z,
-- AA0,AA1,.................,AAZ,
-- AB0,AB1,.................,ABZ,
-- ..............................
-- AZ0,AZ1,.................,AZZ,
-- B00,B01,.................,B0Z,
-- ..............................
-- ..............................
-- ZZ0,ZZ1,.................,ZZZ ---- END!!!

------------------------- generate 46656 unique alphanumeric. ( 000 - ZZZ ) --------------------------------
-----------------------------------------------------------------------------------------------------------
-----------------------------------------------------------------------------------------------------------
is 
   start_value varchar2(3);
   return_val  varchar2(3);
begin

if length(start_val) <= 3 then

  start_value := lpad(upper(start_val),3,'0');

  select 
  (case 
    when p1= 0 and p2 = 0 and p3 = 0 and v3 != '9'                                 then lpad(to_char(start_value+1),3,'0') 
    when p1= 0 and p2 = 0 and p3 = 0 and v3  = '9'                                 then v1||v2||chr(65) 
    when p1= 0 and p2 = 0 and p3 = 1 and ASCII(v3) between 65 and 89               then v1||v2||chr(ASCII(v3)+1)
    when p1= 0 and p2 = 0 and p3 = 1 and v2 != '9' and v3 = 'Z'                    then v1||chr(ASCII(v2)+1)||'0'
    when p1= 0 and p2 = 0 and p3 = 1 and v2  = '9' and v3 = 'Z'                    then v1||chr(65)||'0'
    when p1= 0 and p2 = 1 and p3 = 0 and v3 != '9'                                 then v1||v2||chr(ASCII(v3)+1)
    when p1= 0 and p2 = 1 and p3 = 0 and v3  = '9'                                 then v1||v2||chr(65)
    when p1= 0 and p2 = 1 and p3 = 1 and v3 != 'Z'                                 then v1||v2||chr(ASCII(v3)+1)
    when p1= 0 and p2 = 1 and p3 = 1 and ASCII(v2) between 65 and 89  and v3 = 'Z' then v1||chr(ASCII(v2)+1)||'0'
    when p1= 0 and p2 = 1 and p3 = 1 and v1 != '9' and v2 = 'Z' and v3 = 'Z'       then chr(ASCII(v1)+1)||'0'||'0'
    when p1= 0 and p2 = 1 and p3 = 1 and v1  = '9' and v2 = 'Z' and v3 = 'Z'       then chr(65)||'00'
    when p1= 1 and p2 = 0 and p3 = 0 and v3 != '9'                                 then v1||v2||chr(ASCII(v3)+1)
    when p1= 1 and p2 = 0 and p3 = 0 and v3  = '9'                                 then v1||v2||chr(65)
    when p1= 1 and p2 = 0 and p3 = 1 and v3 != 'Z'                                 then v1||v2||chr(ASCII(v3)+1)
    when p1= 1 and p2 = 0 and p3 = 1 and v2 != '9' and v3 = 'Z'                    then v1||chr(ASCII(v2)+1)||'0'
    when p1= 1 and p2 = 0 and p3 = 1 and v2  = '9' and v3 = 'Z'                    then v1||chr(65)||'0'
    when p1= 1 and p2 = 1 and p3 = 0 and v3 != '9'                                 then v1||v2||chr(ASCII(v3)+1)
    when p1= 1 and p2 = 1 and p3 = 0 and v3  = '9'                                 then v1||v2||chr(65) 
    when p1= 1 and p2 = 1 and p3 = 1 and v3 != 'Z'                                 then v1||v2||chr(ASCII(v3)+1)
    when p1= 1 and p2 = 1 and p3 = 1 and v2 != 'Z' and v3 = 'Z'                    then v1||chr(ASCII(v2)+1)||'0' 
    when p1= 1 and p2 = 1 and p3 = 1 and v1 != 'Z' and v2 = 'Z' and v3 = 'Z'       then chr(ASCII(v1)+1)||'00'  
    else '0' 
  end)
  into return_val
  from 
      (
      select 
       NVL(LENGTH(TRIM(TRANSLATE(substr(start_value,1,1), ' +-.0123456789',' '))),0) p1,
       NVL(LENGTH(TRIM(TRANSLATE(substr(start_value,2,1), ' +-.0123456789',' '))),0) p2,
       NVL(LENGTH(TRIM(TRANSLATE(substr(start_value,3,1), ' +-.0123456789',' '))),0) p3,
       NVL(substr(start_value,1,1),0) v1,
       NVL(substr(start_value,2,1),0) v2,
       NVL(substr(start_value,3,1),0) v3,
       start_value
        from  dual
  );
else 
    return_val := '0';
end if;
return return_val;
end; 
```

# jquery-mobile - 使 jquery 移动文本字段与文本在同一行

> ID：12467836
> 
> 赞同：5
> 
> 时间：2012-09-17T22:15:42.627
> 
> 标签：jquery-mobile

有没有办法使用 jQuery Mobile 执行以下操作？

```
Hello [________________________] 
```

而不是 jQuery Mobile 当前所做的，将这两个放在多行：

```
Hello

[________________________] 
```

目前我正在创建我的文本和文本输入，如下所示：

```
<div id="customTagEntryDiv">
  <span id="userTag">Hello</span>
  <input type="text" name="customTagField" id="customTagField" value=""  />
  </div> 
```

* * *

## 回答 #1

> 赞同：18
> 
> 时间：2012-09-18T00:52:16.760

是的，您可以，您需要使用现场容器，带有`data-role="fieldcontain"`.

**例如：**

```
<div data-role="fieldcontain">
    <label for="name">Text Input:</label>
    <input type="text" name="name" id="name" value=""  />
</div> 
```

使用上面的代码，您应该得到如下内容：

> 文本输入：[ ***_* __ *_* __ *_* __ *_* __** ]

而不是这样的：

> 文本输入：
> [ ***_* __ *_* __ *_* __ *_* __** ]

您可以将这种“格式”用于多种类型的元素：文本输入、单选按钮、选择菜单等。但是，我认为如果您的文本太长，在这种情况下，元素可能会自动转到下一行。 ..

* * *

**鉴于你的例子**，你可能想尝试这样的事情：

```
<div id="customTagEntryDiv" data-role="fieldcontain">
    <label id="userTag" for="customTagField">Hello</label>
    <input type="text" name="customTagField" id="customTagField" value=""  />
</div> 
```

* * *

**查看在线文档以获取更多信息：http:** [//jquerymobile.com/demos/1.1.1/docs/forms/textinputs/](http://jquerymobile.com/demos/1.1.1/docs/forms/textinputs/)

希望这可以帮助。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-10-23T18:39:07.263

float:left 可以解决问题。请参阅此示例，其中包含正常和小型字段的行：

[http://jsfiddle.net/den232/WzH3Y/](http://jsfiddle.net/den232/WzH3Y/)

```
 .floatleft {
    float:left;
 }
.floatright {
    float:right;
 }
.forceinline{  /* Prevent fieldcontain from doing a BLOCK thing */
    display:inline !important;
}
.textwidth {  /* limit width of input fields */
    width:80px;
}
.closespacing { /* controls spacing between elements */
    margin:0px 5px 0px 0px;
 }
.bigselect {   /* centers select with big buttons */
    padding: 0px;
    margin:2px 5px 0px 0px;
 }
.biginputheight {   /* matches text input height to big buttons */
    padding-top:10px !important;
    padding-bottom:12px !important;
}
.miniinputheight { /* matches text input height to minibuttons */
    padding-top:5px !important;
    padding-bottom:5px !important;
}
<div data-role="page" class="type-home"> 
```

```
<ul data-role="listview">
  <li  data-role="fieldcontain">first LI line</li>
  <li  data-role="fieldcontain">

    <div class='floatleft closespacing'>
        Big Buttons<br>More Text
    </div>

    <div  class='floatleft textwidth'>
      <input type="text" placeholder="left" class='biginputheight'></input>
    </div>  

    <div  class='floatright textwidth'>
      <input type="text" placeholder="right" class='biginputheight'></input>
    </div>  

  </li>
  <li  data-role="fieldcontain">

    <div class='floatleft closespacing'>    
        Small Buttons
    </div>

    <div  class='floatleft textwidth'>
      <input type="text" placeholder="e2" class='miniinputheight'></input>
    </div>  

    <div class='floatright closespacing'>
      <div  class='floatright closespacing'>    
        e3 Text<br>on right
      </div>
      <div  class='floatright textwidth'>
        <input type="text" placeholder="e3" class='miniinputheight'></input>
      </div>  
    </div>
  </li>
  <li  data-role="fieldcontain">last LI line</li>

</ul><!-- /listview --> 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2017-10-21T19:21:24.313

这不再有效：

```
<div data-role="fieldcontain"></div> 
```

老式桌子效果很好：

```
<table>
    <tr>
        <td>Label #1:</td>
        <td><input type="text"></td>
    </tr>
</table> 
```

# xcode - 如何判断 Xcode 的 Exception Breakpoint 发生了什么异常？

> ID：12467837
> 
> 赞同：0
> 
> 时间：2012-09-17T22:15:43.540
> 
> 标签：xcode, debugging, xcode4

我在 Xcode 4 中添加了异常断点，它在抛出某种异常的行上中断。但它没有记录任何错误信息。如果应用程序没有记录任何内容，我如何判断是什么异常导致了中断？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-09-17T22:34:11.193

异常本身不会被记录。当您看到记录了异常时，这是因为记录该异常的通用 try-catch 处理程序正在捕获该异常。这种情况发生的时间晚于抛出异常的那一刻，此时堆栈已经展开，并且没有关于它被抛出的位置的更多信息。

一旦抛出异常，在任何堆栈展开或其他任何事情发生之前，断点就会停止执行。您应该查看堆栈和堆栈跟踪以找出抛出什么异常、在哪里以及为什么被抛出。

# oracle - 使用 ALTER SESSION SET CURRENT_SCHEMA 后在 Oracle 表空间中创建索引

> ID：12467840
> 
> 赞同：2
> 
> 时间：2012-09-17T22:15:49.283
> 
> 标签：oracle, oracle11g

我正在尝试复制一个问题，即有人报告在使用`ALTER SESSION SET CURRENT_SCHEMA`调用后未能在正确的表空间中创建索引。

作为系统连接并调用 ddl.sql：

```
sqlplus system/pass@//host/sid @ddl 
```

ddl.sql 包含：

```
-- setup schema a and user a
@new-db/a_schema_setup
-- setup schema b and user b
@new-db/b_schema_setup

-- creates tables and indexes in schema a
ALTER SESSION SET CURRENT_SCHEMA=a;
@new-db/a_ddl

-- creates tables and indexes in schema b
ALTER SESSION SET CURRENT_SCHEMA=b;
@common/b_ddl 
```

b_ddl.sql 包含 DDL 语句，例如

```
CREATE TABLE X (...);

CREATE UNIQUE INDEX IDX_X_PK ON X(ID); 
```

在什么情况下不会在为模式`a`或定义的表空间中创建索引`b`？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-09-17T23:12:54.197

当语句包含显式模式时，不使用当前模式。

```
CREATE TABLE c.X (...); 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-09-18T08:05:26.980

当您在索引创建语句中明确设置表空间时，例如

```
CREATE INDEX table_name_i1
ON table_name (column_one, column_two)
TABLESPACE indexes
/ 
```

这将覆盖您在数据库或架构级别设置的默认值。

您可以（如 Brian 所说）为索引使用具有不同表空间设置的嵌入式模式（但无论如何这些都不会在模式 a 或 b 中）或者`ALTER USER b DEFAULT TABLESPACE x`在脚本中有一个（奇怪但可以设置它来创建索引，然后将其设置回来，例如）。

# ruby - Ruby on Rails 映射现有表的 BigDecimal 字段

> ID：12467842
> 
> 赞同：1
> 
> 时间：2012-09-17T22:16:01.607
> 
> 标签：ruby, ruby-on-rails-3

我为现有表创建了一个 rails 模型类。一些表字段是在 Postgres DB 中定义为 numeric(19,2) 的十进制字段。当我打开 rails 控制台并像这样获取其中一个对象时：

```
 ExistingTableModel.first.total
 #<BigDecimal:4bfd250,'0.692E3',9(18)> 
```

所以，我得到一个 BigDecimal 9(18) 。这是一个问题，因为当我进行求和之类的事情时，由于四舍五入，结果并不好。

如何强制 rails 将这些字段映射到具有 2 位小数的 BigDecimal？

谢谢！

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-09-17T22:32:00.823

您可以覆盖属性访问器。假设您有一个带有属性 foo numeric(19,2) 的旧 Postgres 表

```
model ExistingTableModel < ActiveRecord::Base
  def foo
    read_attribute(:foo).round(2)
  end
end 
```

这将使对 foo 属性的每次访问都舍入到小数点后 2 位的精度。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-09-17T22:33:19.073

使用模型相关表格列中的精度和比例选项。

从文档：

> 精度是有效位数，而小数位数是小数点后可以存储的位数。例如，数字 123.45 的精度为 5，小数位数为 2。精度为 5，小数位数为 2 的小数的范围可以从 -999.99 到 999.99。

PostgreSQL::precision [1..infinity],:scale [0..infinity]。没有默认值。

[完整的 API 参考](http://api.rubyonrails.org/classes/ActiveRecord/ConnectionAdapters/TableDefinition.html)

# opengl - Vala OpenGL glGenTexture

> ID：12467843
> 
> 赞同：0
> 
> 时间：2012-09-17T22:16:10.530
> 
> 标签：opengl, sdl, vala

```
colors = surface->format->BytesPerPixel;
if (colors == 4) {   // alpha
    if (surface->format->Rmask == 0x000000ff)
        texture_format = GL_RGBA;
    else
        texture_format = GL_BGRA;
} else {             // no alpha
    if (surface->format->Rmask == 0x000000ff)
        format = GL_RGB;
    else
        format = GL_BGR;
}

glGenTextures(1, &texture);
glBindTexture(GL_TEXTURE_2D, texture); 
glTexImage2D(GL_TEXTURE_2D, 0, colors, surface->w, surface->h, 0,
                    texture_format, GL_UNSIGNED_BYTE, surface->pixels); 
```

我正在尝试将在 Stack Overflow 上找到的代码转换为 Vala。但是，我遇到了 glGenTextures 的问题。

第一部分很简单：

```
 int texture_format;
    uchar colors = screen.format.BytesPerPixel;
    if (colors == 4) {
        if (screen.format.Rmask == 0x000000ff) {
            texture_format = GL_RGBA;
        } else {
            texture_format = GL_BGRA;
        }
    } else {
        if (screen.format.Rmask == 0x000000ff) {
            texture_format = GL_RGB;
        } else {
            texture_format = GL_BGR;
        }
    } 
```

不过，这部分我不知道如何转换： glGenTextures(1, &texture);

我试过了：

```
 GL.GLuint[] texture = {};
    glGenTextures (1, texture); 
```

我有：

```
.vala:46.27-46.33: error: Argument 2: Cannot pass value to reference or output parameter 
```

我也试过：

```
GL.GLuint[] texture = {};
glGenTextures (1, out texture); 
```

我有：

```
ERROR:valaccodearraymodule.c:1183:vala_ccode_array_module_real_get_array_length_cvalue: assertion failed: (_tmp48_) 
```

我试过了：

```
glGenTextures (1, &texture); 
```

我有：

```
.vala:46.27-46.34: error: Argument 2: Cannot pass value to reference or output parameter 
```

我尝试了各种其他类似的东西，有什么想法吗？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-09-17T23:37:21.003

好像绑定错了。根据[glGenTextures 手册页](http://www.opengl.org/sdk/docs/man/xhtml/glGenTextures.xml)，Vala 绑定应该类似于：

```
public static void glGenTextures ([CCode (array_length_pos = 0.9)] GL.GLuint[] textures); 
```

调用它的正确方法是：

```
GL.GLuint[] textures = new GL.GLuint[1];
glGenTextures (textures);
// your texture is textures[0] 
```

当然，对于您正在查看只需要单个纹理的用例来说，这不是很好，但这没什么大不了的。问题是你必须在堆上分配一个数组......我不怀疑这是一个对性能敏感的代码区域，所以我可能不会打扰，但你总是可以创建一个替代版本：

```
[CCode (cname = "glGenTextures")]
public static void glGenTexture (GL.GLsizei n, out GL.GLuint texture); 
```

然后你可以打电话给

```
GL.GLuint texture;
glGenTexture (1, out texture); 
```

尽管您只能使用此版本来生成单个纹理，但您仍然必须手动传递第一个参数。

# ruby-on-rails - Rails 命名空间模型与非命名空间模型冲突

> ID：12467847
> 
> 赞同：4
> 
> 时间：2012-09-17T22:16:33.437
> 
> 标签：ruby-on-rails, activerecord, namespaces

我在 rails 3.2.6 中有两个类：

*   models/foo.rb 中的类 Foo（默认情况下在表 foos 中）
*   模型/bar/foo.rb 中的类 Bar::Foo （设置`self.table_name`为`bar_foos`）

当我进入控制台时，我得到：

```
> Bar::Foo
=> Bar::Foo(id: ...)
> Foo # or ::Foo
LoadError: expected models/bar/foo.rb to define Foo 
```

怎么了？

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-09-23T00:53:42.447

我们在 IRC 中解决了这个问题，但核心问题是存在一个`config.autoload_paths`包含`models/**`作为加载路径的 glob 集。

Rails 的自动加载器会迭代加载路径，并添加常量名称。一旦它找到一个存在的文件，它就会尝试加载它，然后如果常量不可用则抛出异常。

所以，发生的事情是 Rails 有一个加载路径列表，例如：

```
/models/bar/
/models/ 
```

它正在迭代路径，并会在 处找到匹配项`/models/bar/foo.rb`，然后加载该匹配项（使其`Bar::Foo`可用，但不可用），然后由于不可用`Foo`而引发异常。`Foo`

这种情况下的解决方案是删除该`autoload_paths`设置，这样 Rails 就不会为根级常量找到要加载的错误文件。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-09-23T00:52:16.067

原来 config/applications.rb 中的这一行是问题所在：

```
 config.autoload_paths += Dir[Rails.root.join('app', 'models', '{**}')] 
```

通过显式设置自动加载，Rails 感到困惑；它没有通过适当的命名空间来查看 models/ 下，而是查看了它拥有的第一个自动加载文件（错误地是 models/bar/foo.rb）并发现（true）它未能定义 Foo（它定义了 Bar::福）。

所以很明显，Rails 3 已经知道在模型/子目录中查找命名空间模型。

感谢 freenode 上的 Antiarc #RubyOnRails 帮助解决这个问题。

# ruby - 捆绑安装：错误：无法为 RedCloth、bcrypt-ruby 构建 gem 原生扩展

> ID：12467849
> 
> 赞同：0
> 
> 时间：2012-09-17T22:16:47.917
> 
> 标签：ruby, centos, bundler, centos6

我仅在单个 CentOS 6 VM 映像上收到捆绑安装错误，但不知道为什么 extconf.rb 无法**仅通过 bundler**正常运行。

我在 RedCloth 和 bcrypt-ruby 中都看到了这一点，而 gem_make.out 只包含一行：

```
/usr/local/rvm/rubies/ree-1.8.7-2012.02/bin/ruby extconf.rb 
```

我能够通过运行安装 RedCloth `gem install RedCloth -v '4.2.8'`，但随后遇到了与**bcrypt-ruby**相同的问题。

我尝试运行`cd /usr/local/rvm/gems/ree-1.8.7-2012.02@rujoisxk/gems/bcrypt-ruby-2.1.4 && ruby ext/mri/extconf.rb`，它成功创建了一个 Makefile。我想知道为什么会这样

```
$ bundle install --verbose

[...SNIP...]

Fetching from: http://rubygems.org/quick/Marshal.4.8/bcrypt-ruby-2.1.4.gemspec.rz
HTTP Redirection
Fetching from: http://production.cf.rubygems.org/quick/Marshal.4.8/bcrypt-ruby-2.1.4.gemspec.rz
HTTP Success
Installing bcrypt-ruby (2.1.4) with native extensions 
Gem::Installer::ExtensionBuildError: ERROR: Failed to build gem native extension.

        /usr/local/rvm/rubies/ree-1.8.7-2012.02/bin/ruby extconf.rb 

        Gem files will remain installed in /usr/local/rvm/gems/ree-1.8.7-2012.02@rujoisxk/gems/bcrypt-ruby-2.1.4 for inspection.
        Results logged to /usr/local/rvm/gems/ree-1.8.7-2012.02@rujoisxk/gems/bcrypt-ruby-2.1.4/ext/mri/gem_make.out
        Extension: ext/mri/extconf.rb
        /usr/local/rvm/rubies/ree-1.8.7-2012.02/lib/ruby/site_ruby/1.8/rubygems/installer.rb:557:in `build_extensions'
        /usr/local/rvm/rubies/ree-1.8.7-2012.02/lib/ruby/site_ruby/1.8/rubygems/installer.rb:509:in `each'
        /usr/local/rvm/rubies/ree-1.8.7-2012.02/lib/ruby/site_ruby/1.8/rubygems/installer.rb:509:in `build_extensions'
        /usr/local/rvm/rubies/ree-1.8.7-2012.02/lib/ruby/site_ruby/1.8/rubygems/installer.rb:180:in `install'
        /usr/local/rvm/gems/ree-1.8.7-2012.02@global/gems/bundler-1.2.0/lib/bundler/source.rb:90:in `install'
        /usr/local/rvm/gems/ree-1.8.7-2012.02@global/gems/bundler-1.2.0/lib/bundler/rubygems_integration.rb:82:in `preserve_paths'
        /usr/local/rvm/gems/ree-1.8.7-2012.02@global/gems/bundler-1.2.0/lib/bundler/source.rb:89:in `install'
        /usr/local/rvm/gems/ree-1.8.7-2012.02@global/gems/bundler-1.2.0/lib/bundler/installer.rb:106:in `install_gem_from_spec'
        /usr/local/rvm/gems/ree-1.8.7-2012.02@global/gems/bundler-1.2.0/lib/bundler/rubygems_integration.rb:97:in `with_build_args'
        /usr/local/rvm/gems/ree-1.8.7-2012.02@global/gems/bundler-1.2.0/lib/bundler/installer.rb:105:in `install_gem_from_spec'
        /usr/local/rvm/gems/ree-1.8.7-2012.02@global/gems/bundler-1.2.0/lib/bundler/installer.rb:89:in `run'
        (__FORWARDABLE__):3:in `each'
        (__FORWARDABLE__):3:in `__send__'
        (__FORWARDABLE__):3:in `each'
        /usr/local/rvm/gems/ree-1.8.7-2012.02@global/gems/bundler-1.2.0/lib/bundler/installer.rb:88:in `run'
        /usr/local/rvm/gems/ree-1.8.7-2012.02@global/gems/bundler-1.2.0/lib/bundler/installer.rb:14:in `install'
        /usr/local/rvm/gems/ree-1.8.7-2012.02@global/gems/bundler-1.2.0/lib/bundler/cli.rb:230:in `install'
        /usr/local/rvm/gems/ree-1.8.7-2012.02@global/gems/bundler-1.2.0/lib/bundler/vendor/thor/task.rb:27:in `send'
        /usr/local/rvm/gems/ree-1.8.7-2012.02@global/gems/bundler-1.2.0/lib/bundler/vendor/thor/task.rb:27:in `run'
        /usr/local/rvm/gems/ree-1.8.7-2012.02@global/gems/bundler-1.2.0/lib/bundler/vendor/thor/invocation.rb:120:in `invoke_task'
        /usr/local/rvm/gems/ree-1.8.7-2012.02@global/gems/bundler-1.2.0/lib/bundler/vendor/thor.rb:275:in `dispatch'
        /usr/local/rvm/gems/ree-1.8.7-2012.02@global/gems/bundler-1.2.0/lib/bundler/vendor/thor/base.rb:408:in `start'
        /usr/local/rvm/gems/ree-1.8.7-2012.02@global/gems/bundler-1.2.0/bin/bundle:14
        /usr/local/rvm/gems/ree-1.8.7-2012.02@global/gems/bundler-1.2.0/lib/bundler/friendly_errors.rb:4:in `with_friendly_errors'
        /usr/local/rvm/gems/ree-1.8.7-2012.02@global/gems/bundler-1.2.0/bin/bundle:14
        /usr/local/rvm/gems/ree-1.8.7-2012.02@global/bin/bundle:23:in `load'
        /usr/local/rvm/gems/ree-1.8.7-2012.02@global/bin/bundle:23
        An error occurred while installing bcrypt-ruby (2.1.4), and Bundler cannot continue.
        Make sure that `gem install bcrypt-ruby -v '2.1.4'` succeeds before bundling.
        /usr/local/rvm/gems/ree-1.8.7-2012.02@global/gems/bundler-1.2.0/lib/bundler/installer.rb:128:in `install_gem_from_spec'
        /usr/local/rvm/gems/ree-1.8.7-2012.02@global/gems/bundler-1.2.0/lib/bundler/installer.rb:89:in `run'
        /usr/local/rvm/gems/ree-1.8.7-2012.02@global/gems/bundler-1.2.0/lib/bundler/installer.rb:88:in `run'
        /usr/local/rvm/gems/ree-1.8.7-2012.02@global/gems/bundler-1.2.0/lib/bundler/installer.rb:14:in `install'
        /usr/local/rvm/gems/ree-1.8.7-2012.02@global/gems/bundler-1.2.0/lib/bundler/cli.rb:230:in `install'
        /usr/local/rvm/gems/ree-1.8.7-2012.02@global/gems/bundler-1.2.0/lib/bundler/vendor/thor/task.rb:27:in `send'
        /usr/local/rvm/gems/ree-1.8.7-2012.02@global/gems/bundler-1.2.0/lib/bundler/vendor/thor/task.rb:27:in `run'
        /usr/local/rvm/gems/ree-1.8.7-2012.02@global/gems/bundler-1.2.0/lib/bundler/vendor/thor/invocation.rb:120:in `invoke_task'
        /usr/local/rvm/gems/ree-1.8.7-2012.02@global/gems/bundler-1.2.0/lib/bundler/vendor/thor.rb:275:in `dispatch'
        /usr/local/rvm/gems/ree-1.8.7-2012.02@global/gems/bundler-1.2.0/lib/bundler/vendor/thor/base.rb:408:in `start'
        /usr/local/rvm/gems/ree-1.8.7-2012.02@global/gems/bundler-1.2.0/bin/bundle:14
        /usr/local/rvm/gems/ree-1.8.7-2012.02@global/gems/bundler-1.2.0/lib/bundler/friendly_errors.rb:4:in `with_friendly_errors'
        /usr/local/rvm/gems/ree-1.8.7-2012.02@global/gems/bundler-1.2.0/bin/bundle:14
        /usr/local/rvm/gems/ree-1.8.7-2012.02@global/bin/bundle:23:in `load'
        /usr/local/rvm/gems/ree-1.8.7-2012.02@global/bin/bundle:23 
```

# javascript - 同一页面上有多个Requirejs

> ID：12467850
> 
> 赞同：2
> 
> 时间：2012-09-17T22:16:49.373
> 
> 标签：javascript, requirejs, js-amd

我为我们的客户做一个嵌入代码，所以客户可以有多个嵌入我们的代码（不能在 iframe 上做）。我想尝试 requirejs 来做到这一点，所以我的问题是，如果我在同一页面上有多个 requirejs，都使用不同的路径+垫片加载不同的 js，它们的 oncomplete 功能会起作用吗？

就像客户在主要内容上（在特定页面上的 cms 上）

```
<script src="myexample.com/video.js?key=123"></script> 
```

并在侧边栏上（在所有页面上的 cms 上）

```
<script src="myexample.com/content.js?key=123"></script> 
```

所以我的 video.js 会有

```
require.config({path: { video : '' }..., shim : {} ....});
require(['video','utils'], function(){ do something on video }); 
```

并且 content.js 会有

```
require.config({path: { content : '' }..., shim : {} ....});
require(['content','dom'], function(){ do something on content }); 
```

从我从这里开始[https://groups.google.com/forum/?fromgroups=#!topic/requirejs/MwQ-CNHxGKc](https://groups.google.com/forum/?fromgroups=#!topic/requirejs/MwQ-CNHxGKc)似乎不可能执行这两个函数，这意味着它只会处理其中一个.

如果在 requirejs 中不可能，有人可以将我指向其他可能的 amd 加载器。谢谢

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-09-18T08:02:35.430

您可以使用一个具有最小功能的加载器来启动您的两个模块：

```
require(['video','content'], function(video, content){
   video.start();
   content.start();
}); 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2014-01-13T22:51:20.140

看看 Shootitlive 如何使用他们的小部件解决它

*   可以将任意参数传递给每个嵌入
*   嵌入代码很短
*   它异步加载
*   一个页面上可以有多个播放器

[http://shootitlive.com/2012/07/developing-an-embeddable-javascript-widget/](http://shootitlive.com/2012/07/developing-an-embeddable-javascript-widget/)

# android - 从 AsyncTask 获取结果

> ID：12467851
> 
> 赞同：0
> 
> 时间：2012-09-17T22:16:55.870
> 
> 标签：android, android-asynctask, commonsware

我正在尝试使用 AsyncTask 下载字符串并返回该字符串。我想使用 AsyncTask 因为它可能需要一段时间。

一个问题是，我在 Internet 上找不到返回任何类型值的 AsyncTask 示例。所以我拿了Commonsware书中的例子，修改为返回一个值，得到的值如下：

```
String mystr = new AddStringTask().execute().get(); 
```

虽然这行得通，但似乎这行代码正在等待返回值，因此是同步的。必须有某种方法可以让 AddStringTask 的结果触发事件。

这是怎么做的？谢谢，加里

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-09-17T22:25:08.050

An`AsyncTask`不能返回值，因为要获得返回值，您必须在任务完成之前等待。那会让事情变得`AsyncTask`毫无意义。

相反，您应该将代码移入[`onPostExecute()`](http://developer.android.com/reference/android/os/AsyncTask.html)（如果您担心的话，它会在 UI 线程上运行）。这是您处理返回的值的地方`doInBackground()`，通常会更新 UI 或显示错误消息。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-09-17T22:34:02.253

此外，如果您想实现更通用的 AsyncTask，您可以实现类似以下的内容来划分活动内的代码。

```
@Override
protected void onPostExecute(Bitmap r){
    if (r != null) {
        processListeners(r);
    }
}

protected void processListeners(Object data) {
    for (final AsyncTaskDone l : listeners) l.finished(data);
}

public void addAsyncTaskListener (final AsyncTaskDone l){
    listeners.add(l);
} 
```

其中 AsyncTaskListener 是一个接口，其中一个名为 finished 的函数在 Activity 中实现，就像 onClickListener 一样。

# jquery - 为什么我在使用多个切换时遇到问题？

> ID：12467858
> 
> 赞同：0
> 
> 时间：2012-09-17T22:17:49.873
> 
> 标签：jquery, toggle, fade, slide

在我的网站上，如果您单击某个按钮，它会同时切换 fadeToggle 和 slideToggle。如果您单击不同的按钮，则执行完全相同的操作，但内容不同。但是，如果您同时按下两者，它们最终会不同步。一个是切换的，另一个不是。

新闻信息和 THEN 客户，它弄乱了切换。它们变得不同步。

有没有办法避免这种重叠？

这是jQuery：

```
 <script type="text/javascript">
  $(document).ready(
    function(){

        $('#stop').click(function (e) { 
    e.preventDefault(); });

         $('#information').click(function() {
   $("#projectwrap").slideToggle('slow'); 
   $("#us").fadeToggle('slow');
   });

      $('#clients').click(function() {
   $("#projectwrap").slideToggle('slow'); 
   $("ul").fadeToggle('slow');
   });

});
</script> 
```

如果你很困惑，我也是！

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-09-17T22:39:22.950

## *[jsBin 演示](http://jsbin.com/irutiz/5/edit)*

合乎逻辑的问题是您要`#projectwrap`同时切换`#information`并`#clients`单击！根本没有意义的是，您不能再单击该`#title`元素来查看主要内容。这是一个糟糕的*UX*（用户体验）。

您应该使用这个 HTML 结构：`.toggler`为所有可点击元素添加一个类，并在内部元素上切换状态`.content`！

```
<div id="stop"> 

  <div id="clients">
    <h2 class="toggler">clients</h2>
    <div class="content" style="display:none;">
      <ul>
        <li>list</li>
        <li>list</li>
        <li>list</li>
        <li>list</li>
      </ul>  
    </div>
  </div>

  <div id="projectwrap">
    <h1 class="toggler">projectwrap</h1>
    <div class="content">
      <p>text here.........</p>
    </div>
  </div>

  <div id="information">
    <h2 class="toggler">info</h2>
    <div class="content" style="display:none;">
       about us..........
     </div>
  </div>

</div> 
```

现在我们将使用 jQuery 搜索可点击`.next('.content')`元素！

jQuery：

```
$('#stop').click(function (e) { 
     e.preventDefault();
});

$('.toggler').click(function() {
  var $nextContent = $(this).next('.content');
  var nextContIsHidden = $nextContent.is(':hidden');
  if(nextContIsHidden){
    $('.content:visible').slideUp('slow'); // hide all visible
    $nextContent.slideDown('slow');    
  }else{                          // if we're clicking the title of the visible one
    $nextContent.slideUp('slow'); // if is already visible hide it
    $('#projectwrap .content').slideDown('slow'); // and slide the main content
  }
}); 
```

# jquery - Chrome 上的音频 jQuery 和 currentTime

> ID：12467863
> 
> 赞同：1
> 
> 时间：2012-09-17T22:18:16.970
> 
> 标签：jquery, google-chrome, audio

我正在尝试获取 HTML 音频标签的 currentTime。以下代码适用于 Firefox，但不适用于 Google Chrome。
我的代码有什么问题？

```
var audio = $('#audio'),
    totalTime = audio.attr('data-duration'),
    startTime = Math.floor(Math.random() * totalTime);
audio[0].currentTime = startTime; // No Chrome support at this point 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-09-20T20:56:18.973

我改用[SoundManager](http://www.schillmania.com/projects/soundmanager2/) 2。文档有点棘手，但现在一切正常。

# api - Web 应用程序应该如何使用我的公共 API

> ID：12467867
> 
> 赞同：7
> 
> 时间：2012-09-17T22:18:29.197
> 
> 标签：api, http, oauth

我正在为服务开发一个公共 HTTP 后端 API。最重要的是，有一个让用户登录的网络应用程序，应该使用后端 API 来满足用户请求。API 支持 OAuth2，Web 应用程序是单页应用程序，带有大量 javascript。

我关心的是浏览器和网络应用程序应该如何与 API 对话。我找到了两种可能的方法。

### 浏览器直接使用API

当用户输入他的凭据进行登录时，Web 应用程序将它们传递给 API 并获得一个 OAuth access_token，它直接传递给浏览器并存储在一些 cookie 中。然后，对 API 的每个请求都是通过 JSONP 直接从浏览器发出的。当用户注销时，Web 应用程序会销毁会话。

### 浏览器与 Web 应用程序对话，后者与 API 对话

当用户输入他的凭据进行登录时，Web 应用程序会将它们传递给 API 并获得 OAuth access_token。使用用户创建会话，并且 access_token 存储在会话中。当浏览器需要与 API 通信时，它会通过 Web 应用程序。Web 应用程序在会话中使用访问令牌，调用 API，并将响应传递给浏览器。

两种方式在性能和安全性权衡方面各有利弊。你怎么看？

PS：据我所知，twitter 直接从浏览器使用它的公共 API，但通过会话 cookie 进行身份验证。这意味着他们的 API 也支持 cookie 会话？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-11-17T10:27:08.747

Dan,

The options you mentioned are the commonly used options. You have a presentation layer(UI) and a business layer(API) Which one to choose is a question of how many layers you want in your application based on the complexity and extendability you may need in future. You may want to introduce a middle layer if there is a big gap between your API layer and your UI. If the gap is high you will want a layer for the extra processing , abstracting the complexities and to keep your UI layer clutter free.

But if all you need, is a simple processing in your UI layer on top of API layer go for Option 1

# sql - 如何组合两个数据列？

> ID：12467872
> 
> 赞同：1
> 
> 时间：2012-09-17T22:19:06.557
> 
> 标签：sql, sql-server-2008-r2

我有这个 SQL 语句我想结合 'date' 和 'dayOfWeek' 列

```
 SELECT CONVERT(date,startTimeStamp) AS DATE
      , datename(dw,CONVERT(date,startTimeStamp)) as dayOfWeek
      ,CONVERT(time,[startTimeStamp])AS StartTime
      ,CONVERT(time,[endTimeStamp])AS EndTime
      ,DATEDIFF(HH,[startTimeStamp] ,[endTimeStamp])
  FROM [TaskManagementSystem_DB].[dbo].[Timesheet_entry] 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-09-17T22:25:00.343

听起来你想要这个：

```
SELECT CONVERT(date,startTimeStamp) AS DATE
      , datename(dw,CONVERT(date,startTimeStamp)) as dayOfWeek
      ,cast(datename(dw,CONVERT(date, startTimeStamp)) as varchar(50)) -- add this
        + ' ' +                                                     -- add this
        CONVERT(varchar(50),CONVERT(date,startTimeStamp)) FullDate -- add this
      ,CONVERT(time,[startTimeStamp])AS StartTime
      ,CONVERT(time,[endTimeStamp])AS EndTime
      ,DATEDIFF(HH,[startTimeStamp] ,[endTimeStamp])
  FROM [TaskManagementSystem_DB].[dbo].[Timesheet_entry] 
```

要将字段连接在一起，您必须`cast()`将它们连接到相同的数据类型，类似于：

```
select cast(datename(dw,CONVERT(date, getdate())) as varchar(50)) 
  + ' ' +
  CONVERT(varchar(50) ,getdate()) newdate 
```

# 见[SQL Fiddle with Demo](http://sqlfiddle.com/#!3/2f5cf/6)

# javascript - 切换复选框值

> ID：12467873
> 
> 赞同：1
> 
> 时间：2012-09-17T22:19:21.353
> 
> 标签：javascript, jquery, html, handlebars.js, mustache

我正在尝试使用以下代码切换复选框的值：

```
<div class="control-group">
        <label class="control-label checkbox" for="IsViewAsWebpage">
            {{#if this.IsViewAsWebpage}}
                <input type="hidden" id="IsViewAsWebpage" name="IsViewAsWebpage" value="true"/> 
                <input type="checkbox" class="enable-checkbox" checked /> 
            {{else}}
                <input type="hidden" id="IsViewAsWebpage" name="IsViewAsWebpage" value="false"/> 
                <input type="checkbox" class="enable-checkbox" /> 
            {{/if}}
            <span>View as Webpage</span>
        </label>
    </div>

'click .enable-checkbox': function (e) {
                if (e.currentTarget.parentElement.htmlFor == "IsViewAsWebpage") {
                     this.$('#IsViewAsWebpage').is(':checked');
            }

        } 
```

我知道我在点击功能中遗漏了一些东西。我基本上想在用户单击它时切换复选框值。有人可以指出我正确的方向吗？谢谢你。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-09-17T22:48:50.550

如果您想在单击复选框时使用 handlebars.js 切换内容，则需要在每次对复选框进行修改时调用 handlebars 来替换您的内容

```
$(".enable-checkbox").change(function (e) {
    if($(this).parent().attr("for") == "IsViewAsWebpage") {
        var checked = $(this).is(":checked");
        IsViewAsWebpage = checked;
        $("#yourcontainer").html(Handlebars.compile(yourtemplatesource));
    }

} 
```

那么你的 IsViewAsWebpage 变量应该是全局的，你的胡子条件应该是：

```
{{#if IsViewAsWebpage}} 
```

但这很复杂……只需使用 Esthete 解决方案，它将为您节省大量时间。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-09-17T22:35:02.407

当您的复选框被点击时，它将切换。这就是复选框的工作方式。

如果您希望在`value`切换复选框时更改隐藏的输入，我认为您想要的是：

```
$(".enable-checkbox").change(function (e) {
    if($(this).parent().attr("for") == "IsViewAsWebpage") {
        var checked = $(this).is(":checked"); // Returns true/false.
        $('#IsViewAsWebpage').attr("value", checked); // Sets true/false.
    }        
}); 
```

# php - 大容量共享媒体服务器PHP/mySQL重命名文件的实用方法

> ID：12467874
> 
> 赞同：0
> 
> 时间：2012-09-17T22:19:25.123
> 
> 标签：php, mysql, guid, uuid

好的，我正在开发各种共享系统/服务。人们可以在那里将自己的媒体上传到服务器。我在大部分构建中使用 PHP 和 mySQL，目前使用的是单一服务器环境。但是我需要它是可扩展的，因为我打算在接下来的 6 个月内将媒体移动到服务器集群，将站点/服务留在自己的服务器上。无论如何，这是一个静音点。

我的目标或希望是提出一个风险极低的命名约定，在上传时重命名文件时几乎不可能与另一个文件发生冲突。迄今为止，我已经阅读了许多概念，发现 UUID (GUID) 是满足我所有需求的最佳选择，因为它有很多可能性，我认为我永远无法达到这么多共享图像。

我的问题是提出了一个生成 UUID 更可取的 v3 或 v5 的函数（我知道它们是相同的，但 v5 目前并未 100% 符合 UUID 的标准）。对 UUID 及其约束知之甚少，这使得它们在以后尝试对它们进行正则表达式时或如果需要时是独一无二的和/或有效的，我似乎无法提出可行的解决方案。我也不知道我应该真正使用 v3 还是 v5。或v4。因此，我正在寻找有关将返回所需版本 UUID 类型的函数的建议和帮助。

省着气我还没有尝试过任何事情，因为我现在不知道从哪里开始。有了这个，我打算将这些文件保存在许多文件夹中，以抵消由大型目录列表引起的负载。所以我也在降低我在那里发生碰撞的风险。我还将这些名称存储在数据库中，其中关联的文件夹和其他信息与每个图像相关联，所以我看到的另一个问题是，当我为要重命名的文件随机生成 UUID 时，我不想查询多个数据库在发生冲突的情况下，我实际上可能希望每个函数调用返回 5 个 UUID，并查看我的查询中是否有匹配项，而我的查询中将使用第一个没有匹配项的匹配项。

无论如何，我知道这是很多阅读，我知道它没有代码，希望你们中的很多人最终不会因为阅读太多而投反对票，并假设这是一个糟糕的问题/讨论。因为我很想知道如何从一开始就解决这个问题，这样我就可以尽可能少地根据需要扩大规模。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-09-17T22:36:04.607

> 我的目标或希望是提出一个风险极低的命名约定，在上传时重命名文件时几乎不可能与另一个文件发生冲突。迄今为止，我已经阅读了许多概念，并发现 UUID (GUID) 是满足我所有需求的最佳选择，因为它具有如此多的可能性，以至于我认为我永远无法达到这么多共享图像。

您可以构建一个由以下组成的数字（然后您将其实现为 UUID）：

*   日期 (YYYYMMDD)
*   服务器 (NNN)
*   当天上传到该服务器的图像计数器

这个数字永远不会产生任何冲突，因为它总是递增，并且可以扩展到一千台服务器。假设您每天在每台服务器上最多获得一百万张图像，这大约是 43 位信息。添加其他 32 个随机数，以便无法猜测 UUID（平均少于 2^31 次尝试）。您还剩下大约 50 多位以允许进一步扩展。

或者您可以将一些数字存储在 BCD 中以使它们易于阅读：

```
20120917-0172-4123-8456-7890d0b931b9 
```

可能是图像 1234567890，随机 d0b931b9，于 2012 年 9 月 17 日上传到服务器 0172。

该方案甚至可以兼作“目录传播”方案：一旦图像具有映射到 20120917-125-00001827-d0b931b9 的 UUID，这意味着服务器 125，您可以将其存储在名为 d0/b9 的目录结构中/31/b9/20120917-125-00001827.jpg。

命名约定确保唯一性，随机位确保目录结构是“扁平的”（填充均匀，没有目录比其他目录更满），优化检索时间。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-09-17T22:36:35.190

如果您要在数据库中存储对每个文件的引用.. 为什么不使用 MySQL `auto_increment`id 来命名您的文件？如果将数据库扩展到集群，ID 仍然是唯一的（作为 PK，它*必须*是唯一的！），那么为什么要在 UUID 生成和其他东西上浪费宝贵的 CPU 时间呢？这不是 UUID 的用途。

我会选择最简单的方法（不过，我已经在许多其他系统中看到过）：

1.  上传文件
2.  上传成功后，插入数据库引用（路径由 确定`3.`）；获取`auto_increment`_`$ID`
3.  将文件重命名为`${YEAR}/{$MONTH}/${DAY}/{$ID}`
    （如果您需要更细化的路径，当每天上传的文件过多时进行调整）
4.  重命名失败时，删除数据库引用并显示错误消息
5.  使用文件系统中的实际路径更新数据库引用

# .htaccess - 基于文本的 301 重定向到新的 url

> ID：12467876
> 
> 赞同：0
> 
> 时间：2012-09-17T22:19:36.277
> 
> 标签：.htaccess, mod-rewrite, redirect, http-status-code-301

我的 URL 有点问题。我希望你能帮帮我！

我有这个网址：

```
http://www.domain.com/search.html?page=shop.product_details&flypage=vmj_softy.tpl&product_id=1408&category_id=1028 
```

这需要重定向到：

```
http://www.domain.com/search.html?page=shop.product_details&flypage=vmj_color_plus.tpl&product_id=1408&category_id=1028 
```

唯一需要改变的是 flypage=vmj_softy 到 flypage=vmj_color_plus

产品 ID 和类别 ID 必须是字符串（必须在所有产品上更改）

我想我需要为此使用 apaches mod_rewrite，但我已经尝试了一切，但我无法让它工作！

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-09-17T22:25:03.113

尝试将其放入文档根目录的 htaccess 文件中：

```
RewriteEngine On
RewriteCond %{QUERY_STRING} ^page=shop.product_details&flypage=vmj_softy.tpl(.*)$
RewriteRule ^/?search.html$ /search.html?page=shop.product_details&flypage=vmj_color_plus.tpl%1 [L,R=301] 
```

# c# - WCF 服务对流端点的服务调用在第三次调用时失败

> ID：12467880
> 
> 赞同：1
> 
> 时间：2012-09-17T22:19:47.417
> 
> 标签：c#, wcf, stream, wcf-endpoint

快速概述我在这里得到的东西：

WCF Soap 服务通过 HTTPS 运行，消息凭证类型为证书。我有 2 个我使用的端点（除了 mex），1 个用于我的正常服务调用，另一个用于流文件。这是我的服务的 web.config（编辑了一些项目名称）：

```
<bindings>
  <wsHttpBinding>
    <binding name="wsHttpEndpointBinding">
      <security mode="TransportWithMessageCredential">
        <message clientCredentialType="Certificate" />
      </security>
    </binding>
  </wsHttpBinding>
  <basicHttpBinding>
      <binding name="streamBinding" transferMode="Streamed" messageEncoding="Mtom" maxReceivedMessageSize="2147483646">
          <security mode="TransportWithMessageCredential">
              <message clientCredentialType="Certificate" />
          </security>
      </binding>
  </basicHttpBinding>        
</bindings>
<services>
  <service behaviorConfiguration="Services.Behavior" name="MyInterface">
    <endpoint address="" binding="wsHttpBinding" bindingConfiguration="wsHttpEndpointBinding" name="wsHttpEndpoint" contract="IMyInterface" />
    <endpoint address="stream" binding="basicHttpBinding" bindingConfiguration="streamBinding" name="streamEndpoint" contract="IMyInterface" />
    <endpoint address="mex" binding="mexHttpBinding" contract="IMetadataExchange" />
  </service>
</services>
<behaviors>
  <serviceBehaviors>
    <behavior name="Service.Behavior">
      <serviceMetadata httpGetEnabled="false" httpsGetEnabled="true" />
      <serviceDebug includeExceptionDetailInFaults="true" />
      <dataContractSerializer maxItemsInObjectGraph="2147483646" />
      <serviceCredentials>
        <serviceCertificate findValue="CN=Server.Temp.Dev" />
      </serviceCredentials>
    </behavior>
  </serviceBehaviors>
</behaviors> 
```

该服务有一个我正在测试的方法 DownloadDocument。这是签名：

DocumentDownloadResponse 下载文档（DocumentDownloadRequest 请求）；

值得注意的是，当传入的数据无效时，服务会抛出异常，DownloadDocument 会捕获这些异常并在响应对象中传回错误消息。

DocumentDownloadRequest 如下所示：

```
[MessageContract]
public class DocumentDownloadRequest
{
    [MessageHeader]
    public string SecurityToken { get; set; }

    [MessageHeader]
    public string LoginName { get; set; }

    [MessageHeader]
    public string DocumentId { get; set; }
} 
```

并下载文档响应：

```
[MessageContract]
public class DocumentDownloadResponse : ServiceResponse<Stream>
{
    public DocumentDownloadResponse()
    {
        Data = Stream.Null;
    }

    [MessageHeader(MustUnderstand = true)]
    public bool Success { get; set; }

    [MessageHeader(MustUnderstand = true)]
    public string ErrorMessage { get; set; }

    [MessageBodyMember(Order = 1)]
    public Stream Data { get; set; }
} 
```

这是我从客户端调用它的方式：

```
 var soapServiceClient = new SoapServiceClient("streamEndpoint");
        bool success;
        Stream stream;
        string errorMessage =
            soapServiceClient.DownloadDocument(documentId, loginName, securityToken, out success, out stream);

        serviceClient.Close(); 
```

其中 SecurityToken 和 LoginName 是需要验证的项目。奇怪的是，在我的测试客户端中，当我使用有效数据调用 DownloadDocument 时，我能够完美地下载文件任意多次。但是，如果我传入无效的 LoginName 或 SecurityToken，我会收到指示数据不正确的错误消息（如预期的那样）。但是，如果我传入 3 次无效数据，客户端就会超时。在本地运行服务我没有遇到这个问题，一切都按预期运行。奇怪的是，当我打开提琴手运行时，我没有遇到这个问题。当我在我的开发服务器上运行该服务时，我遇到了问题。

开发服务器上的配置与我在本地运行的配置相匹配。使用 SvcTraceTool 我没有看到任何错误，只是它只记录了前 2 个成功的调用，而不是失败的那个。它几乎让我觉得端点只是以某种方式关闭了自己。

悬崖：

1) 具有 2 个端点的服务，其中一个是流式传输（我关心的那个）。2) 能够使用流式端点调用方法来下载具有有效数据的文件 3) 服务正确捕获坏数据 2 次，第 3 次挂起。SvcTraceTool 中没有日志，客户端超时。

有任何想法吗？

谢谢

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-10-12T18:13:34.150

为了回答罗德里戈，我想我会发布更多细节：

首先，将生成的代理类包装成这样的东西，以正确处理错误：

```
public class ProxyWrapper<TServiceClientType, TResultType>
    where TServiceClientType : class, ICommunicationObject
{
    private static string _endPoint;

    public ProxyWrapper(string endPoint = "")
    {
        _endPoint = endPoint;
    }

    public TResultType Wrap(Func<string, TServiceClientType> constructWithEndpoint,
                                    Func<TServiceClientType, TResultType> codeBlock)
    {
        TResultType result = default(TResultType);
        TServiceClientType client = default(TServiceClientType);
        try
        {
            client = constructWithEndpoint(_endPoint);
            result = codeBlock(client);
            client.Close();
        }
        catch (Exception)
        {
            if (client != null)
            {
                client.Abort();
            }
            throw;
        }
        return result;
    }
} 
```

然后我有一个围绕服务调用的客户端类。这是 DownloadDocument 方法：

```
 public MyServiceResponse<Stream> DownloadDocument(string loginName,
                                                            string documentId)
    {

        var proxyWrapper = new MyProxyWrapper<DocumentDownloadResponse>(StreamEndpoint);
        DocumentDownloadResponse response =
            proxyWrapper.Wrap((client) =>
            {
                Stream data;
                bool success;
                string errorMessage = client.DownloadDocument(documentId, loginName,
                                                              out success,
                                                              out data);
                return new DocumentDownloadResponse
                {
                    Data = data,
                    Success = success,
                    ErrorMessage = errorMessage
                };
            });

        var result = new MyServiceResponse<Stream>
        {
            Success = response.Success,
            ErrorMessage = response.ErrorMessage
        };

        if (!response.Success)
        {
            result.Data = null;
            response.Data.Close();
        }
        else
        {
            result.Data = response.Data;
        }

        return result;
    } 
```

注意：MyProxyWrapper 继承自 ProxyWrapper 并指定 WCF 客户端代理类。现在实际的调用如下所示：

```
var myClient = new MyClient();
var downloadDocumentResponse = myClient.DownloadDocument(someId);
                                using (
                                    Stream output =
                                        File.OpenWrite(someFilePath))
                                {
                                    downloadDocumentResponse.Data.CopyTo(output, 2048);
                                    downloadDocumentResponse.Data.Close();
                                } 
```

请注意我在流上调用 .Close() 的两个区域，一次是在写入文件之后，一次是 response.Success == false。

# python - 如何记录在代码块中执行的所有导入？

> ID：12467883
> 
> 赞同：4
> 
> 时间：2012-09-17T22:19:53.003
> 
> 标签：python

我正在编写一个测试套件，而我正在测试的代码过度使用延迟的模块导入。所以有可能对同一个方法有 5 个不同的输入，这最终可能会导入 5 个额外的模块。我想做的是设置测试，以便我可以断言使用一个输入运行该方法会导致一个导入，而不会导致其他 4 个。

我有一些关于如何开始的想法，但到目前为止还没有一个成功的。我已经有一个自定义导入器，我可以将日志记录代码放在导入器中。但这不起作用，因为 import 语句只运行一次。无论模块之前是否已导入，我都需要执行日志语句。只是运行`del sys.modules['modname']`也不起作用，因为它在测试代码中运行，并且我无法在正在测试的代码中重新加载模块。

我尝试的下一件事是子类`dict`化来进行监控，并用这个子类替换 sys.modules。这个子类有一个重新实现的`__getitem__`方法，但是调用`import module`似乎不会触发`__getitem__`子类中的调用。我也不能直接分配给`sys.modules.__getitem__`，因为它是只读的。

我想要做的甚至可能吗？

**更新**

nneonneo 的答案似乎仅在 的实现与`logImports()`使用它的模块位于同一模块中时才有效。如果我创建一个包含此功能的基本测试类，它就会出现问题。首先是它找不到 just `__import__`，错误如下：

```
#     old_import = __import__
# UnboundLocalError: local variable '__import__' referenced before assignment 
```

当我将其更改为 时`__builtin__.__import__`，出现另一个错误：

我的单元测试.py：

```
import unittest
class TestCase(unittest.TestCase):
    def logImports(self):
        old_import = __builtins__.__import__
        def __import__(*args, **kwargs):
            print args, kwargs
            return old_import(*args, **kwargs)

        __builtins__.__import__ = __import__ 
```

测试.py：

```
import myunittest
import unittest
class RealTest(myunittest.TestCase):
    def setUp(self):
        self.logImports()
    def testSomething(self):
        import unittest
        self.assertTrue(True)
unittest.main()

#     old_import = __builtins__.__import__
# AttributeError: 'dict' object has no attribute '__import__' 
```

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-09-17T22:33:20.520

尝试

```
old_import = __import__
def __import__(*args, **kwargs):
    print args, kwargs
    return old_import(*args, **kwargs)

__builtins__.__import__ = __import__ 
```

这完全覆盖`__import__`，允许您监视`import`.

* * *

## 回答 #2

> 赞同：-1
> 
> 时间：2021-05-17T15:15:07.837

基于先前的答案，在 Python 3 中，我在以下方面取得了成功。

```
import builtins
old_import = __import__

def importWithLog(*args, **kwargs):
    print(args[0]) # This is the module name
    print(args, kwargs)
    return old_import(*args, **kwargs)

builtins.__import__ = importWithLog

# Rest of the code goes here.
import time
import myModule
... 
```

# java - “重命名”文件项

> ID：12467887
> 
> 赞同：2
> 
> 时间：2012-09-17T22:20:16.800
> 
> 标签：java, immutability, fileitem

从业务角度来看，这就是问题所在

我们有许多人们使用的共享文件夹，我们称之为`//shared/the/drive`。但是，我们的服务器可能将此共享驱动器称为其他名称，这可能是`//ir83pn3br8mwhonamesthesethingsanyway/the/drive`因为网络组坚持使用令人难以置信的混乱服务器名称。对于大多数服务器来说，使用简单的名称就可以了，但是在这个服务器上，它就不能正常工作了。所以我们的问题的创可贴是，在我们的代码中，就像“哦，你正在使用`shared`- 我们将用`stupid name from networking`.

好的 - 现在进入更技术性的方面：

我有一个`FileItem`（Apache commons FileUpload 模块）对象，它可能有一个 name `//shared/the/drive/stuff/plans.doc`。我需要创建一个`FileItem`引用`//stupidname/the/drive/stuff/plans.doc`。我应该怎么办？

我应该在 JSP 中编辑请求对象吗？这听起来是个坏主意。

我应该使用反射来编辑 FileItem 对象吗？这听起来像是一个更糟糕的主意。

我不是前端人员（请注意我在哪些标签中投票......哈哈），真的......更像是一个服务器老兄......这只是掉到了我的盘子里。是否可以在文本框到达请求之前拦截它，将更改移动到客户端？

我不可能是第一个遇到这个问题的人。我不是一定要寻找代码（我会介意吗？不，我不会。）而是一种通用的方法，即什么会起作用，和/或这种事情（改变用户输入的内容）是如何在 '最好的做法是最受欢迎的。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-09-18T01:30:05.017

在处理分布式文件系统时，有一个用户可以看到和处理的“假路径”和一个代表实际节点的后端路径并不罕见，该节点允许您在收到的请求的上下文中操作文件。

您在网络上点击的每个页面都不会由您在浏览器中键入的物理 URL 表示。CMS系统中的CDN上的文件是从数据库中动态创建的……无论如何。

无需破解任何对象。您只需用另一个包含它们的瞬态属性的对象包装它们，例如这次我将在哪里访问该文件。

# php - Facebook 提要：年龄限制页面的永久用户身份验证令牌

> ID：12467890
> 
> 赞同：3
> 
> 时间：2012-09-17T22:20:50.723
> 
> 标签：php, facebook-graph-api

这曾经是一件相对简单的事情（不像一年前那么简单，现在更不简单了）。警告：我不精通 Facebook API——我不构建应用程序；我只是建立网站，并且每隔一段时间需要显示一个简单的（但对于 facebook 小部件来说太自定义了）显示 facebook 页面的提要。通常没问题，但是……</p>

我通常只使用客户端令牌——只生成一次并将其永久存储为变量。但是对于这个站点，访问提要需要用户访问令牌，因为它是有年龄限制的（酒精站点）。之前这样做的方法是只生成一个带有“offline_access”的令牌，我可以将它永久地存储为一个变量。但offline_access 已被弃用。

据我了解，现在我唯一的选择是长期访问令牌。但这些必须每六十天延长一次。

我想要做的就是显示一个提要——我不希望用户除了看到提要之外什么都做——永远不会被提示登录等。我当然不希望我自己或我的客户必须这样做每两个月生成一个新令牌。

是否有一些简单、永久（我的意思是，直到 facebook 再次更改规则）的方式来做到这一点？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-09-17T23:11:17.543

离线访问功能仍处于启用状态，但已被弃用，并将（很快）被删除。

Facebook 不提供此功能的完全替代品。唯一要做的就是生成一个长期令牌并在它即将到期时重新生成它。

换句话说（正如 Facebook 所设想的那样，我猜）：如果用户超过 60 天没有访问您的网站，那么他们不再感兴趣，您将无法再访问他们的数据。

如果不是这种情况，您可以不时更新令牌。由于您知道令牌的到期日期（API 将其与令牌一起返回），您可以存储它并检查显示连接对话框的最佳机会。即使 60 天的延迟已过期，您也可以在他们回来时获取新令牌，而无需再次请求权限。

您可以将其完全视为“记住我”cookie。它旨在提供舒适，而不是规避安全策略：它的不可撤销性（通过简单的方式）会导致隐私和安全问题。

# asp.net-mvc - VS 2012 Asp.net MVC 更改在运行网站时不会出现

> ID：12467891
> 
> 赞同：1
> 
> 时间：2012-09-17T22:20:52.470
> 
> 标签：asp.net-mvc, visual-studio, visual-studio-2012

升级到 VS 2012 后，我在我的 javascript 类中所做的任何更改似乎都不会生效，直到我刷新浏览器缓存并重新运行之后。即更改javascript行，单击f5运行网站，更改不存在。

这在 VS 2010 甚至 VS 2012 RC 中都没有发生过。会有缓存这个的设置吗？

谢谢

# sql-server - SQL Server：将表名作为参数传递到变量表中

> ID：12467897
> 
> 赞同：0
> 
> 时间：2012-09-17T22:21:23.360
> 
> 标签：sql-server, stored-procedures, parameters

我有一个存储过程，我使用 while 循环从表中进行选择，然后根据索引号将结果插入到多行的变量表中。我希望能够将表名作为参数传递，但我不知道如何。我把商店程序放在这里，看看你们能不能帮帮我。谢谢！

```
USE [Enrollment] GO SET ANSI_NULLS ON GO SET QUOTED_IDENTIFIER ON GO

ALTER PROCEDURE [dbo].[Enrollment_By_Objective] --exec Enrollment_By_Objective @TableName = 'Students'

@TableName VARCHAR (50)

AS

BEGIN

SET NOCOUNT ON

DECLARE @EO_CODE INT 
       ,@EO_NAME VARCHAR(100) 
       ,@DHC INT
       ,@PCA INT
       ,@PC INT
       ,@SE INT
       ,@COA INT
       ,@CO INT
       ,@NCL INT

DECLARE @EnrollmentData TABLE 
(
     EnrollmentObjective NVARCHAR(100)
    ,DistinctHeadCount INT
    ,ProgramCompletersAll INT
    ,ProgramCompleters INT
    ,StillEnrolled INT
    ,CompletedObjectiveAll INT
    ,CompletedObjective INT
    ,NonCompletedLeavers INT
)

SET @EO_CODE = 1
WHILE (@EO_CODE <= 10)
    BEGIN
        SET @EO_NAME = @EO_CODE
        SET @DHC = (SELECT COUNT (*) FROM(SELECT DISTINCT StudentID FROM **@TableName** WHERE IndexEnrollmentObjective = @EO_CODE) X)
        SET @PCA = (SELECT COUNT (*) FROM(SELECT DISTINCT StudentID FROM Students WHERE ExitCode = 'P' AND IndexEnrollmentObjective = @EO_CODE) X)
        SET @PC = (SELECT COUNT (*) FROM(SELECT DISTINCT StudentID FROM Students WHERE ExitCode = 'P' AND Outcome IN ('R', 'E', 'I') AND IndexEnrollmentObjective = @EO_CODE) X)
        SET @SE = (SELECT COUNT (*) FROM(SELECT DISTINCT StudentID FROM Students WHERE ExitCode IS NULL  AND IndexEnrollmentObjective = @EO_CODE) X)
        SET @COA = (SELECT COUNT (*) FROM(SELECT DISTINCT StudentID FROM Students WHERE ExitCode IN ('C', 'N', 'S') AND IndexEnrollmentObjective = @EO_CODE) X)
        SET @CO = (SELECT COUNT (*) FROM(SELECT DISTINCT StudentID FROM Students WHERE ExitCode IN ('C', 'N', 'S') AND Outcome IN ('R', 'E', 'I')  AND IndexEnrollmentObjective = @EO_CODE) X)
        SET @NCL = (SELECT COUNT (*) FROM(SELECT DISTINCT StudentID FROM Students WHERE ExitCode NOT IN ('C', 'N', 'P','S')  AND IndexEnrollmentObjective = @EO_CODE) X)

        INSERT INTO @EnrollmentData
            SELECT @EO_NAME, @DHC, @PCA, @PC, @SE, @COA, @CO, @NCL
            WHERE @DHC > 0

        SET @EO_CODE = @EO_CODE + 1
    END

UPDATE @EnrollmentData
SET EnrollmentObjective = 
(
    SELECT
        CASE WHEN EnrollmentObjective = '1' THEN 'Certificate Seekers'
             WHEN EnrollmentObjective = '2' THEN 'Occupational Upgrade'
             WHEN EnrollmentObjective = '3' THEN 'Senior Citizen'
             WHEN EnrollmentObjective = '4' THEN 'Bad Data'
             WHEN EnrollmentObjective = '5' THEN 'Apprenticeship'
             WHEN EnrollmentObjective = '6' THEN 'Basic Skills'
             WHEN EnrollmentObjective = '7' THEN 'Life Long Learning'
             WHEN EnrollmentObjective = '8' THEN 'Assessment'
             WHEN EnrollmentObjective = '9' THEN 'Secondary'
             WHEN EnrollmentObjective = '10' THEN 'Job Re-entry'
             ELSE EnrollmentObjective 
        END
)

SELECT * FROM @EnrollmentData
END 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-09-18T01:50:55.887

使用动态 SQL 生成语句，然后使用带有输出参数的 sp_executeSQL 来检索结果。

仅供参考，请不要子查询一个简单的 COUNT DISTINCT，只需如下所示：

```
declare @sql nvarchar(max)
set @sql = N'select @DHC = count(distinct studentid) from ' + @TableName + ' where IndexEnrollmentObjective = @EO_CODE'
exec sp_executesql @sql, N'@DHC int output,@EO_CODE INT', @DHC output, @EO_CODE 
```

这 3 条线去你有线的地方

```
SET @DHC = (SELECT COUNT (*) FROM(SELECT DISTINCT StudentID FROM **@TableName** WHERE IndexEnrollmentObjective = @EO_CODE) X) 
```

# nginx - Nginx - 密码保护不起作用

> ID：12467900
> 
> 赞同：17
> 
> 时间：2012-09-17T22:21:52.863
> 
> 标签：nginx

我已按照说明进行操作，但仍然无法使用密码保护我的网站。这就是我的 app-nginx.config 的样子：

```
server {
    listen       80;
    server_name  Server_Test;
    auth_basic            "Restricted";
    auth_basic_user_file  /usr/local/nginx/conf/htpasswd;

...

} 
```

我哪里错了？我从一个教程网站复制并粘贴了这个。

* * *

## 回答 #1

> 赞同：18
> 
> 时间：2012-09-17T22:43:59.500

确保 Nginx 可以访问密码文件。auth_basic_user_file 的路径是相对于`nginx.conf`. 因此，如果您`nginx.conf`位于，`/usr/local/nginx`您可以将指令更改为：

```
auth_basic_user_file  conf/htpasswd; 
```

并且文件必须是可读的。

> 这个文件应该可以被工作人员读取，从非特权用户运行。例如。当 nginx 从 www 运行时，您可以将权限设置为：
> 
> ```
> chown root:nobody htpasswd_file
> chmod 640 htpasswd_file 
> ```

-- 来自[http://wiki.nginx.org/HttpAuthBasicModule](http://wiki.nginx.org/HttpAuthBasicModule)

* * *

## 回答 #2

> 赞同：9
> 
> 时间：2017-05-25T13:45:18.490

刚刚让我的 nginx 服务器工作，甚至配置它来保护我的根文件夹访问。我想与您分享我的发现，并在此过程中对本页中的问题给出一个很好且有效的答案。

作为 nginx 的新用户（版本 1.10.0 - Ubuntu）。我遇到的第一个问题是知道文件位置，所以这里是关键位置：

**了解您的位置：**

主文件夹位置： `/etc/nginx`

默认站点位置：`/var/www/`甚至`/ver/www/html/`（`html`文件夹内将是**index.html**文件 - 希望您知道从那里做什么。）

**配置文件：**

主要配置文件：`/etc/nginx/nginx.conf`

当前站点**服务器**配置：（`/etc/nginx/sites-enabled`在第一次安装时，那里有一个名为 的文件`default`，您需要使用`sudo`它才能更改它（例如 `sudo vi default`：）

**添加密码：**

所以，既然 e 知道播放器（无论如何都是静态的开箱即用网站），让我们将一些文件放在“html”文件夹中，并为其添加密码保护。

要设置密码，我们需要做 2 件事： 1\. 创建一个密码文件（有尽可能多的用户，但我会选择 1）。2\. 配置当前服务器（'default'）来限制这个页面，并使用1中的文件来启用密码保护。

**1.让我们创建一个密码：**

我想为此使用的行是：（ `sudo htpasswd -c /etc/nginx/.htpasswd john`您将收到输入并重新输入密码的提示）您可以在此处的一行中执行此操作： `sudo htpasswd -c /etc/nginx/.htpasswd john [your password]`

我将解释命令的每个部分：

*   `sudo htpasswd`- 使用更高的权限进行操作。
*   `-c` - for：创建文件（将另一个用户添加到现有用户跳过此参数）
*   `/etc/nginx/.htpasswd`- 创建的文件的名称（文件夹 /etc/nginx 中的“.htpsswd”）
*   `john`是用户名（在提示的“用户”字段中输入）
*   `password`是此特定用户名所需的密码。（提示时..）

通常该`htpasswd`命令对您不起作用，因此您必须安装它的包：

使用：（`sudo apt-get install apache2-utils`如果失败请尝试使用并重`sudo apt-get update`试）

**2.让我们配置服务器使用这个文件进行身份验证**

让我们使用这一行来编辑当前（默认）服务器 conf 文件：

`sudo vi /etc/nginx/sites-enabled/default`（你不必使用'vi'，但我喜欢它..）

删除大部分注释后文件看起来像这样 (#)

```
# Default server configuration
#
server {
    listen 80 default_server;
    listen [::]:80 default_server;

    root /var/www/html;

    # Add index.php to the list if you are using PHP
    index index.html index.htm index.nginx-debian.html;

    server_name _;

    location / {
        # First attempt to serve request as file, then
        # as directory, then fall back to displaying a 404.
        try_files $uri $uri/ =404;
    }

} 
```

我们需要在块中添加两行位置（'/' 指向站点的根文件夹），所以它看起来像这样：

```
 location / {
        # First attempt to serve request as file, then
        # as directory, then fall back to displaying a 404.
        try_files $uri $uri/ =404;

        auth_basic "Restricted Content";
        auth_basic_user_file /etc/nginx/.htpasswd;
     } 
```

我将解释这些新行：

*   `auth_basic "Restricted Content";`- 定义访问管理的类型
*   `auth_basic_user_file /etc/nginx/.htpasswd;`- 将我们创建的文件 (/etc/nginx/.htppasswd) 定义为此身份验证的密码文件。

让我们重新启动服务并享受受密码保护的网站：

`sudo service nginx restart`

*中提琴*- 享受...

这里有一些更棒的教程：

[很好的解释](https://www.digitalocean.com/community/tutorials/how-to-set-up-password-authentication-with-nginx-on-ubuntu-14-04)

[另一个goo教程](https://www.digitalocean.com/community/tutorials/how-to-set-up-http-authentication-with-nginx-on-ubuntu-12-10)

# rest - soapUI：带有文件附件的多部分/表单数据 REST 请求

> ID：12467901
> 
> 赞同：23
> 
> 时间：2012-09-17T22:22:01.457
> 
> 标签：rest, testing, soapui

我正在使用soapUI 来测试REST Web 服务。有没有办法在多部分请求中附加带有其他参数的文件？我在面板中看到了附件选项卡，但我无法为该附件指定一个参数名称，以便服务器可以识别。这没有帮助。

* * *

## 回答 #1

> 赞同：46
> 
> 时间：2012-10-15T17:58:28.253

我找到了，但忘记在这里发布了。它不是那么直观。

1.  在您的 REST 请求中，如果您可以看到附件选项卡，请打开它并使用 + 按钮添加附件。该文件的名称将显示完整路径。例如`C:\temp\my-file.csv`
2.  在您的参数选项卡中，添加一个参数并为其命名。该参数的值将是`file:C:\temp\my-file.csv`
3.  在 SoapUI 5.x 和更高版本中，您必须选中“Post QueryString”复选框。没有这个，文件将不会与请求一起发送。

应该是这样的。附加文件时，如果在要求缓存文件时选择“是”，则不必在上面的步骤 2 中指定完整路径。文件参数的值应该是`file:my-file.csv`

* * *

## 回答 #2

> 赞同：-4
> 
> 时间：2015-07-15T15:30:39.207

选择 mediatype 作为 application/json 然后将 json 字符串添加到其中。它将作为有效负载发送到服务器。通常这个请求是 POST 或 PUT 类型的

# python - Parsing python source into html - quotes

> ID：12467903
> 
> 赞同：1
> 
> 时间：2012-09-17T22:22:15.107
> 
> 标签：python, html, string, parsing

I'm working on a tool that parses python source code into a nice html file. Basically, it read a python file line by line, looks at the line to determine what's in it and then adds the right `<span>` tags with colors, line breaks and whatnot.

I got the general structure of the program, now I'm making all the functions that actually read a string and return an HTML enriched string.

I'm stuck on parsing strings that have quotes in them ie.:

```
x = 'hello there'  
if x == 'example "quotes" inside quotes' and y == 'another example': 
```

My work so far has been enumerating a string to get the indices of single-quotes, return them as a list and then two while loops that put the right html tags in the right places. It seemed to work fine when there was a single quote in the string, but all hell broke loose when I introduced two quotes on a line, or quotes inside quotes or finally - a string made up of '\''.

It seems this route is a dead end. I'm now thinking of turning to `.split()`, `shlex`, or `re` and breaking down the string into a list and trying to work with that.
I would really appreciate tips, pointers, and any advice.

Edit: Also, to make it clearer, I need to put HTML tags in the right places in a string. Working with string indices didn't give much results with more complex strings.

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-09-17T22:26:47.863

[Colorize Python source using the built-in tokenizer](http://code.activestate.com/recipes/52298/) is an example for this kind of code (which uses `cgi.escape`). See if it fits your needs!

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-09-17T22:41:43.777

You could use `tokenize.generate_tokens`:

```
import tokenize
import token
import io

text = '''
x = 'hello there'  
if x == 'example "quotes" inside quotes' and y == 'another example': pass
'''

tokens = tokenize.generate_tokens(io.BytesIO(text).readline)
for toknum, tokval, (srow, scol), (erow, ecol), line in tokens:
    tokname = token.tok_name[toknum]
    print(tokname, tokval) 
```

yields

```
('NL', '\n')
('NAME', 'x')
('OP', '=')
('STRING', "'hello there'")
('NEWLINE', '\n')
('NAME', 'if')
('NAME', 'x')
('OP', '==')
('STRING', '\'example "quotes" inside quotes\'')
('NAME', 'and')
('NAME', 'y')
('OP', '==')
('STRING', "'another example'")
('OP', ':')
('NAME', 'pass')
('NEWLINE', '\n')
('ENDMARKER', '') 
```

From here, you can output appropriate HTML based on the type (`tokname`) of each token.

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-09-17T22:30:37.323

Something like cgi.escape is probably what you want. There are also tools like BeautifulSoup and Pygments that do something every similar to what you're making, you may want to leverage them.

# hibernate - 简单的休眠自我参考 - 父子关联

> ID：12467904
> 
> 赞同：0
> 
> 时间：2012-09-17T22:22:18.590
> 
> 标签：hibernate, parent-child

**课程**

```
class Bean {

private List<Radicacion> getReferencias() {
    List<Radicacion> refs = DAO.findAll(Radicacion.class);
    return refs;   
}

private Radicacion getRadicacion() {  
    Radicacion r = DAO.findById(Radicacion.class, new Integer(33) );
    return r;
}

private void guardarDependencias() {
    Iterator<Radicacion> itRad = getReferencias().iterator();
    while (itRad.hasNext()){
        Radicacion ref = itRad.next();          
        getRadicacion().getRadicacions().add(ref);
        ref.setReferencia(getRadicacion());             
    }
}
} 
```

////////

```
class Radicacion {
@OneToMany(cascade = CascadeType.ALL, fetch = FetchType.LAZY, mappedBy = "referencia")
public List<Radicacion> getRadicacions() {
    return this.radicacions;
}
public void setRadicacions(List<Radicacion> radicacions) {
    this.radicacions = radicacions;
}

    @ManyToOne(cascade = CascadeType.ALL, fetch = FetchType.LAZY)
@JoinColumn(name = "referencia_asociada")
public Radicacion getReferencia() {
    return this.referencia;
}
public void setReferencia(Radicacion radicacion) {
    this.referencia = referencia;
}           

} 
```

**问题**

我需要 getReferencias() 方法提供的所有 Radicacion 对象最终都在 getRadicacion().getReferencias() 集合中。

每当我打电话给guardarDependencias（用英语保存依赖项）时，什么都没有发生。原始的 getRadicacion.getReferencias() 保持不变。

**需要思考的事情**

*   如果我插入 DAOBase.merge(ref); 在迭代中，它不会产生任何 sql 输出。这让我觉得 ref 已经作为持久性加载了，那么为什么当我将链接设置为 getRadicacion() 时，hibernate 无法更新其状态？

*   如果我插入 System.out.println(HibernateUtil.getCurrentSession().contains(ref)); 在迭代器中，它打印出 true。

*   如果我创建其他关联，持久性工作正常。问题可能与自引用有关。

谢谢你的帮助

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-09-18T07:07:09.347

您的代码表明您希望将所有 Radicacions （您通过 (DAO.findAll(Radicacion.class) 获得的所有 Radicacion 添加到 ID 为 33 的 Radicacion 中。Radicacion 也是自引用的，即它具有对自身的引用以及Radicacion 集合（父子关系）

您应该检查的第一件事是，如果方法 guardarDependencies 在事务中运行？我没有看到任何事务管理代码。如果在会话使用期间没有输出 sql（并且您期望它），那么首先怀疑它是否在事务下运行。

您还可以在 DEBUG 模式下运行 Hibernate 并查看幕后发生的情况。解决根本问题非常有帮助

# wordpress - WordPress 插件无法使用自定义主题

> ID：12467908
> 
> 赞同：0
> 
> 时间：2012-09-17T22:22:33.453
> 
> 标签：wordpress, plugins, slider, social

我想知道为什么我使用的大约 25% 的插件有问题。我创建了自己的自定义主题，当我切换到 211 标准主题时，插件就可以工作了。

为了使插件正常运行，wordpress 是否需要在代码中包含某些特定内容？我知道这可能含糊不清，但我遵循了一个说明如何制作自定义主题的教程。他们没有说还有什么需要做的。

插件目前有问题....有人使用过这个滑块插件吗？： [http ://wordpress.org/extend/plugins/arscode-social-slider-free/](http://wordpress.org/extend/plugins/arscode-social-slider-free/)

当我单击“预览”时，它可以在 WordPress 管理页面内工作，但不能在实际站点上工作。

这是我正在开发的网站：http: [//glassdoctordenvermetro.com/](http://glassdoctordenvermetro.com/)

我不确定这是否是某种 javascript 冲突或插件需要的不仅仅是“保存设置”。

任何指导将不胜感激。我已经为此工作了好几天，大多数 Wordpress 帮助论坛都没有答案或解决方案就结束了。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-09-17T23:36:30.343

有点离题，但是您如何制作自定义主题？如果您从原始主题中删除了导致代码无声中断的任何内容，那可能是一个问题。

为了省去从头开始创建一个全新主题（不是指子主题）的麻烦，我通常会复制 211 并将其重命名为我的主题名称，对我的 styles.css 执行相同操作，以便 WordPress 将其检测为新主题主题。这样，您就可以使用所有的 211 功能，并且可以从那里进行自定义。

这是一个开始，因为我们的信息很少

# asp.net-mvc - 让 WebApi 和 Areas 玩得很好

> ID：12467911
> 
> 赞同：1
> 
> 时间：2012-09-17T22:22:52.163
> 
> 标签：asp.net-mvc, asp.net-mvc-4, asp.net-mvc-areas

我正在使用 Martin Deviller 的[教程](http://blogs.infosupport.com/asp-net-mvc-4-rc-getting-webapi-and-areas-to-play-nicely)来让 MVC4 的 Web API 与区域一起工作。我相信我已经完全按照说明进行操作，但是 GetControllerType 在访问“http://localhost/API/user”时会引发以下异常：

```
Value cannot be null. Parameter name: controllerType 
```

有没有人有任何想法可能导致这种情况？这是我放置在我的区域注册文件中的内容：

```
context.MapHttpRoute(
    name: "API_default",
    routeTemplate: "API/{controller}/{id}",
    defaults: new { id = RouteParameter.Optional }
); 
```

提前致谢。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-09-17T22:44:53.090

我看到您正在尝试在没有该区域的情况下访问应用程序的路由。您是否需要区域？

如果您尝试按照示例进行操作，则区域注册将使 url “http://localhost/administration/API/user”。这行得通吗？

```
 context.Routes.MapHttpRoute(
        name: "Administration_DefaultApi",
        routeTemplate: "Administration/api/{controller}/{id}",
        defaults: new { id = RouteParameter.Optional }
    ); 
```

# c# - 多个调用等待同一个异步任务

> ID：12467913
> 
> 赞同：2
> 
> 时间：2012-09-17T22:23:10.597
> 
> 标签：c#, asynchronous, windows-runtime, task, .net-4.5

基本上，我的应用程序中有很多地方，为了做一些事情，我需要确保下载产品图像。我想把这个调用集中到一个地方，所以我确保只下载一次。我想在我的课堂上这样做：

```
private IAsyncOperation<bool> _downloadCoverTask;

internal IAsyncOperation<bool> DownloadCoverAsync()
{
    if (this._downloadCoverTask == null)
    {
        this._downloadCoverTask = this._cloudProduct.Image.DownloadAsync();
    }

    return this._downloadCoverTask;
} 
```

_cloudProduct.Image.DownloadAsync() 是一种实际进行图像下载的方法（它也恰好位于我无法控制的库中）。

所以在我需要下载图像的代码中，我做

```
await product.DownloadCoverAsync();
// do stuff with the image 
```

我第一次调用它时可以正常工作，但第二次调用它时我得到异常“在不允许时分配了一个委托”。我也没有得到任何堆栈跟踪或任何东西。

这会被称为一堆地方，但我希望他们都会等待同一个任务，然后在完成后继续。如果它已经完成，我希望它会立即返回。有可能我误解了，这不是它的工作原理吗？

（是的，我[之前](https://stackoverflow.com/questions/12332790/)发布过这个，但没能得到答案，我认为这个问题更好地总结了这个问题。还有[这个问题](https://stackoverflow.com/questions/9557009/)，但它使用 TPL 并且似乎有一个更复杂的目标。）

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-09-17T22:39:44.647

尝试使用 a`Task<bool>`而不是`IAsyncOperation<bool>`. 您可以使用[`AsTask`](http://msdn.microsoft.com/en-us/library/hh779752.aspx)扩展方法获取任务。

# wcf - 什么是有效的 WCF MSMQ 方法返回类型？

> ID：12467914
> 
> 赞同：1
> 
> 时间：2012-09-17T22:23:14.967
> 
> 标签：wcf

出于某种原因，我在 WCF MSMQ 上找到的所有示例都显示 void 作为方法的返回类型。这只是巧合吗？如果不是，为什么？什么是有效的返回类型？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-09-17T23:12:32.313

没有用于发送到 MSMQ 端点上的 WCF 服务的有效返回类型。

因为您正在写入队列而不是直接与服务通信，所以通信通道不可用于服务发送响应。此外，写入队列的主要好处之一是服务可能在消息发送时甚至没有运行，一旦服务再次激活，消息就会被拾取。

如果在发送到服务时没有抛出异常，那么您知道该消息至少已添加到消息队列中。

# postgresql - 你可以在 Heroku 中拥有多个生产数据库吗？

> ID：12467915
> 
> 赞同：1
> 
> 时间：2012-09-17T22:23:28.373
> 
> 标签：postgresql, heroku

在 Heroku 中，是否有可能拥有多个“生产”Postgres 数据库？换句话说，假设（无论出于何种原因），我想要一个“crane”实例和一个“kappa”实例。看起来 Heroku 似乎很乐意让我给他们钱 :) 但是，它似乎不想让我这样做。我错过了什么吗？是新的仪表板/用户界面不让我吗？我是否必须为新数据库创建一个单独的应用程序？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-09-17T23:27:23.147

是的，您应该能够配置多个生产数据库，但是它们随后会通过配置名称中的颜色进行区分。为了添加两个，您将：

```
heroku addons:add heroku-postgresql:crane
heroku addons:add heroku-postgresql:kappa 
```

# common-lisp - 如何将关键字转换为适合访问插槽的符号？

> ID：12467916
> 
> 赞同：6
> 
> 时间：2012-09-17T22:23:46.213
> 
> 标签：common-lisp

我有一堂有很多插槽的课。我还有一个构建器函数来创建该类的对象，以便将以下列表传递`'(:id "john" :name "John Doe" :age 42)`给该函数将构造一个具有这些插槽值的新对象。我将使用该函数生成多个对象，使用列表列表。

如何将关键字 like 转换为可以使用`:id`的插槽名称`SLOT-VALUE`？

谢谢。

* * *

## 回答 #1

> 赞同：10
> 
> 时间：2012-09-18T06:21:45.310

如果关键字是类的*initargs*，那么您可以`MAKE-INSTANCE`通过以下方式调用`APPLY`：

```
(defclass person ()
  ((id   :initarg :id  )
   (name :initarg :name)
   (age  :initarg :age )))

CL-USER > (mapcar
           (lambda (initargs)
             (apply #'make-instance 'person initargs))
           '((:id "john" :name "John Doe" :age 42)
             (:id "mary" :name "Mary Doe" :age 42)))

(#<PERSON 402027AB7B> #<PERSON 402027AC33>) 
```

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2012-09-17T23:50:29.113

和函数将对您有所帮助`find-symbol`。`symbol-name`如果`defclass`和`slot-value`发生在同一个包中，您可以按如下方式使用这些函数：

```
(defclass person ()
  ((id :initarg :id)
   (name :initarg :name)
   (age :initarg :age)))

(slot-value (make-instance 'person :id "john" :name "John Doe" :age 42)
            (find-symbol (symbol-name :id))) 
```

如果`defclass`和`slot-value`发生在两个不同的包中，您需要给出发生`find-symbol`的包的名称`defclass`：

```
(in-package #:common-lisp-user)

(defpackage #:foo
  (:use #:common-lisp)
  (:export #:person))

(defpackage #:bar
  (:use #:common-lisp #:foo))

(in-package #:foo)

(defclass person ()
  ((id :initarg :id)
   (name :initarg :name)
   (age :initarg :age)))

(in-package #:bar)

(slot-value (make-instance 'person :id "john" :name "John Doe" :age 42)
            (find-symbol (symbol-name :id) 'foo)) 
```

* * *

> **`(find-symbol name &optional (package (sane-package)))`**
> 
> 功能：返回 PACKAGE 中名为 STRING 的符号。如果找到这样的符号，则第二个值是 :INTERNAL、:EXTERNAL 或 :INHERITED 以指示如何访问该符号。如果没有找到符号，那么这两个值都是 NIL。

> **`(symbol-name symbol)`**
> 
> 功能：以字符串形式返回 SYMBOL 的名称。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2017-07-18T19:50:54.213

我意识到这已经很老了，但我认为这里最重要的一点是：

**不要这样用`slot-value`！**

要获取访问器，请使用`:accessor`or`:reader`插槽选项，并将值传递给构造函数，请使用`:initarg`：

```
(defclass foo ()
  ((bar :accessor foo-bar :initarg :bar))) 
```

这意味着：创建一个 getter 方法和一个名为 的 setf 扩展器`foo-bar`，并使用一个名为`:bar`to的关键字参数`make-instance`来初始化此插槽的值。

现在您可以像这样实例化这样的对象：

```
(make-instance 'foo :bar "quux") 
```

或者，如果你得到一个 initargs 的属性列表（正如 Rainer 已经展示的那样）：

```
(let ((initargs (list :bar "quux"))) ; getting this from somewhere
  (apply #'make-instance 'foo initargs)) 
```

然后你可以得到这样的值：

```
(foo-bar some-foo) 
```

并`setf`像往常一样设置它：

```
(setf (foo-bar some-foo) "wobble") 
```

如果使用`:reader`而不是`:accessor`，则不允许设置。这对于传达不变性的意图通常很有用。

`Slot-value`确实适用于对象生命周期中的特殊情况，例如在玩弄`initialize-instance`. 那是一个高级话题。

* * *

## 回答 #4

> 赞同：-1
> 
> 时间：2017-07-18T14:41:31.760

我对 CL 这种愚蠢的解决方案是：

```
(defun locate-symbol
       (inst kw)
  (let* ((slot-name (symbol-name kw))
         (slot-def (find slot-name
                         (clos:compute-slots (class-of inst))
                         :test #'(lambda (name sd)
                                   (string= name
                                            (symbol-name (clos:slot-definition-name sd)))))))
    (if slot-def
        (clos:slot-definition-name slot-def)
      (error "Can't find a slot definition named ~s." slot-name))))

(defun gets
       (self slot-name)
  "Get a value of a slot by its name (keyword)"
  (slot-value self (locate-symbol self slot-name)))

(defun sets!
       (self slot-name value)
  "Set a value of a slot by its name (keyword)"
  (setf (slot-value self (locate-symbol self slot-name))
        value)) 
```

所以现在你可以这样做：

```
(defvar obj (make-instance '<some-class>))
(sets! obj :some-slot "some value")
(format t "-> ~a~%" (gets obj :some-slot)) 
```

# c# - 打开在 TextEdit 中写入 Web 导航器的网站链接

> ID：12467917
> 
> 赞同：0
> 
> 时间：2012-09-17T22:23:47.287
> 
> 标签：c#, winforms

我的表单中有一个 TextEdit 来编写一些网站地址，当我单击一个按钮以打开该网站（在 TextEdit 中编写）进入网络导航器时，我想要。

我怎样才能做到这一点 ？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-09-17T22:26:46.263

只需将 URL 从`TextEdit`to传递给`Process.Start`：

```
Process.Start("http://www.google.com"); 
```

它将在默认浏览器中打开。

# python - django中的通用列表视图+站点范围的数据？

> ID：12467919
> 
> 赞同：0
> 
> 时间：2012-09-17T22:24:02.927
> 
> 标签：python, django

我有一个非常适合`ListView`Django 的视图。像这样：

```
url(r'^$',
    ListView.as_view(
        queryset=Poll.objects.order_by('-pub_date')[:5],
        context_object_name='latest_poll_list',
        template_name='polls/views/index.html')), 
```

但是，我在视图页面上也想显示来自另一个模型的内容。该模型仅包含一行数据。它是站点范围的，包含页脚文本页面标题等。

什么是最好的解决方案？理想情况下，我想保留通用模型方法。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-09-18T00:48:38.167

有几种方法可以解决这个问题。观点绝对不是正确的地方。

**模板标签** 使用[模板](https://docs.djangoproject.com/en/1.4/howto/custom-template-tags/#writing-custom-template-tags)标签的一种方法是作为迷你视图。无论您是从另一个模型请求数据，还是呈现包含的模板。

因为您也可以将参数传递到模板标签中，所以它们可以由上下文自定义。

**上下文处理器** 对于更简单的信息，[上下文处理器](https://docs.djangoproject.com/en/1.4/ref/templates/api/#writing-your-own-context-processors)运行良好。我不会对数据太复杂，因为它是全球性的，可以减慢每个请求。

另一方面，我也会质疑你的单排模型。我的猜测是这是为了允许用户编辑。如果用户访问它，请期待所有可能的方式来搞砸它。例如，添加更多行。有几个 Django 应用程序可用于管理用户可编辑的设置，它们可能很有用。如果数据不会经常更改，我会将其设置为实际设置，或者将其放入模板片段并 {% include %} 它。

# javascript - 使用 ajax 设置 html5 媒体源

> ID：12467922
> 
> 赞同：6
> 
> 时间：2012-09-17T22:24:20.277
> 
> 标签：javascript, ajax, html

我需要帮助我从外部服务器获取的音频文件的身份验证标头。所以现在我尝试使用 ajax，我可以很好地抓取文件，但我不能将它们设置为我的播放器的媒体源。您如何将 ajax 加载的文件设置为音频源？

**编辑**

最后修复它，以防有人以这种方式回来。

```
if (this.mAudioPlayer.canPlayType("audio/mpeg")) {
    this.mExtension = '.mp3';
}else if (this.mAudioPlayer.canPlayType("audio/ogg")) {
    this.mExtension = '.ogg';
} else if (this.mAudioPlayer.canPlayType("audio/mp4")) {
    this.mExtension = '.m4a'; 
}

this.CreateAudioData = function() {

    //downloading audio for use in data:uri
    $.ajax({
        url: aAudioSource + this.mExtension + '.txt',
        type: 'GET',
        context: this,
        async: false,
        beforeSend: function(xhr) {xhr.setRequestHeader('Authorization', window.userId);},
        success: this.EncodeAudioData,
        error: function(xhr, aStatus, aError) { HandleError('Audio Error: ' + aStatus); }
    });
};

this.EncodeAudioData = function(aData) {
    //this.mAudioData = base64_encode(aData);
    this.mAudioData = aData;

    if (this.mExtension == '.m4a') {
        Debug("playing m4a");
        this.mAudioSrc = "data:audio/mp4;base64," + this.mAudioData;
    } else if (this.mExtension == '.ogg') {
        Debug("playing ogg");
        this.mAudioSrc = "data:audio/ogg;base64," + this.mAudioData;
    } else if (this.mExtension == '.mp3') {
        Debug("playing mp3");
        this.mAudioSrc = "data:audio/mp3;base64," + this.mAudioData;
    }

};

this.play = function() {

    if (this.mAudioPlayer.src != this.mAudioSrc) {
        this.mAudioPlayer.src = this.mAudioSrc;
    }
    this.mAudioPlayer.load();
    this.mAudioPlayer.play();
}; 
```

必须做 asynch:false，否则我会得到一小块音频而不是全部。尽管最终删除了异步使调试更容易。

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-09-18T07:20:57.673

您实际上是在下载文件，还是以 base64 编码格式（即作为数据 URI）返回它？

通过 JavaScript 更改音频元素的来源非常简单。

```
<audio id="myAudio" controls /> 
```

然后，一旦你有了来源，：

```
var audio = document.getElementById("myAudio");
audio.src = myAudioFile;
audio.type = "type/ogg"; // ony showing an OGG example here 
```

* * *

## 回答 #2

> 赞同：-1
> 
> 时间：2012-11-26T20:00:52.387

```
if (this.mAudioPlayer.canPlayType("audio/mpeg")) {
    this.mExtension = '.mp3';
}else if (this.mAudioPlayer.canPlayType("audio/ogg")) {
    this.mExtension = '.ogg';
} else if (this.mAudioPlayer.canPlayType("audio/mp4")) {
    this.mExtension = '.m4a'; 
}

this.CreateAudioData = function() {

//downloading audio for use in data:uri
$.ajax({
    url: aAudioSource + this.mExtension + '.txt',
    type: 'GET',
    context: this,
    async: false,
    beforeSend: function(xhr) {xhr.setRequestHeader('Authorization', window.userId);},
    success: this.EncodeAudioData,
    error: function(xhr, aStatus, aError) { HandleError('Audio Error: ' + aStatus); }
  });
};

this.EncodeAudioData = function(aData) {
  //this.mAudioData = base64_encode(aData);
  this.mAudioData = aData;

  if (this.mExtension == '.m4a') {
    Debug("playing m4a");
    this.mAudioSrc = "data:audio/mp4;base64," + this.mAudioData;
  } else if (this.mExtension == '.ogg') {
    Debug("playing ogg");
    this.mAudioSrc = "data:audio/ogg;base64," + this.mAudioData;
  } else if (this.mExtension == '.mp3') {
    Debug("playing mp3");
    this.mAudioSrc = "data:audio/mp3;base64," + this.mAudioData;
  }

};

this.play = function() {

   if (this.mAudioPlayer.src != this.mAudioSrc) {
       this.mAudioPlayer.src = this.mAudioSrc;
   }
    this.mAudioPlayer.load();
    this.mAudioPlayer.play();
}; 
```

必须做 asynch:false，否则我会得到一小块音频而不是全部。尽管最终删除了异步使调试更容易。

# bash - sed/awk/bash 用外部文件内容替换两个字符串之间的文本

> ID：12467930
> 
> 赞同：2
> 
> 时间：2012-09-17T22:25:13.307
> 
> 标签：bash, replace, sed, awk

我正在寻找编写一个脚本/命令，它将采用 inputFile1，在其中查找特定的开始和结束字符串，并将它们之间的所有文本替换为 inputFile2 的全部内容。

理想情况下，但不是强制性的，这应该可以在不需要转义特殊字符的情况下工作，因此我可以将字符串放入脚本调用的变量中（这样我可以轻松地多次重复使用它）。

例如，我有文件*inputYes.txt*的内容：

```
DummyOne
Start
That
What
Yes
End
DummyTwo 
```

和*inputNo.txt*的内容：

```
This
Why
Not 
```

我希望脚本在*inputYes.txt*中搜索字符串*Start*和*End*，并将其间的所有文本替换为*inputNo.txt*的内容，然后写入文件。

所以运行它之后，*inputYes.txt*应该是

```
DummyOne
Start
This
Why
Not
End
DummyTwo 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-09-17T22:27:56.493

```
sed '/end_string/rinputFile2
/start_string/,/end_string/d' inputFile1 
```

# java - 搜索对话框不显示

> ID：12467931
> 
> 赞同：0
> 
> 时间：2012-09-17T22:25:23.380
> 
> 标签：java, android, search, dialog

我想在我的 android 项目中实现一个搜索对话框。而且我不明白向用户显示搜索对话框时缺少什么。这是假设启动搜索的 Activity 的清单：

```
<activity
        android:name=".ArrowsActivity"
        android:label="@string/title_activity_main" >
        <intent-filter>
            <action android:name="android.intent.action.MAIN" />
            <category android:name="android.intent.category.LAUNCHER" />
        </intent-filter>
        <meta-data android:name="android.app.default_searchable"
               android:value=".Searchable" />
    </activity> 
```

这是可搜索活动的清单：

```
 <activity
        android:name=".Searchable"
        android:launchMode="singleTop"
        android:label="@string/title_activity_searchable" >
        <intent-filter>
             <action android:name="android.intent.action.SEARCH" />
        </intent-filter>
         <meta-data android:name="android.app.searchable"
               android:resource="@xml/searchable"/>
    </activity> 
```

这是可搜索的.xml：

```
<?xml version="1.0" encoding="utf-8"?>
<searchable xmlns:android="http://schemas.android.com/apk/res/android"
  android:hint="@string/search_hint" 
  android:label="@string/search_label">
</searchable> 
```

可搜索类：

```
public class Searchable extends ListActivity {

@Override
public void onCreate(Bundle savedInstanceState) {
    super.onCreate(savedInstanceState);
    setContentView(R.layout.activity_searchable);
    handleIntent(getIntent());
}
@Override
protected void onNewIntent(Intent intent) {
    setIntent(intent);
    handleIntent(intent);
}

private void handleIntent(Intent intent) {
    if (Intent.ACTION_SEARCH.equals(intent.getAction())) {
      String query = intent.getStringExtra(SearchManager.QUERY);
    //  doMySearch(query);
    }
}

@Override
public boolean onCreateOptionsMenu(Menu menu) {
    getMenuInflater().inflate(R.menu.activity_searchable, menu);
    return true;
} 
```

}

**SO..**我如何向用户弹出搜索框>我错过了什么？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-09-17T22:47:10.793

只需在[`onSearchRequested()`](http://developer.android.com/reference/android/app/Activity.html#onSearchRequested%28%29)某处调用，这将启动清单中声明的​​搜索活动。

# reporting-services - 如何在 Report Builder 3.0 中为多值参数设置多个默认值

> ID：12467932
> 
> 赞同：1
> 
> 时间：2012-09-17T22:25:40.290
> 
> 标签：reporting-services, reportbuilder3.0

我有一个从返回 Id (UNIQUEIDENTIFIER) 列和标签 (VARCHAR) 列的查询填充的多值参数。我将参数设置为 Text 类型，使用 Id 作为**Value 字段**，Label 作为**Label 字段**，它工作正常。

现在我想设置一些默认值，以便在运行报告时，默认检查这些值。在**默认值**选项卡中，我尝试输入不带引号、带单引号和带双引号的 Id 值，以及尝试不带引号、带单引号和带双引号的标签值。但是，在所有情况下，我运行报告时都不会检查任何项目。

我不想**从查询中获取值**，我想**指定值**。我怎样才能使这项工作？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-09-18T09:41:44.117

我也遇到了这个问题，不支持为唯一标识符指定默认值（我找不到任何来源来支持这一点，只是我自己的经验）。

是否有特定原因不能使用**Get values from a query**？

解决方案 user1578107 地址也将起作用，使用转换将 varchar(36) 传递给您的参数：

```
select convert(varchar(36),Id)
from table 
```

# user-controls - 从 Sitecore 子布局（用户控件）的代码隐藏设置 Page.Title 不起作用

> ID：12467934
> 
> 赞同：0
> 
> 时间：2012-09-17T22:25:46.043
> 
> 标签：user-controls, sitecore, title, code-behind, page-title

我在从用户控件（子布局）的代码隐藏中为页面设置 Page.Title 时遇到问题。

我们有一个布局，MainLayout.aspx。我可以从这个页面的代码隐藏中设置页面标题，它工作正常。但是，如果在此之后，我尝试在 MySublayout1 的代码隐藏中设置页面标题，则会为 Page.Title 属性设置新值，但更改不会反映在页面上。

我已经尝试将代码从 Page_Load 移动到页面和控件的 OnInit 事件，但似乎没有任何效果。知道为什么这不起作用吗？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-09-18T18:43:51.587

最好的方法是创建一个新的渲染或子布局来渲染页面的 -section。因此，您可以在子布局中设置文字或 sc:text 控件中的值，而不是仅从代码隐藏中设置 Page.Title。通过这种方式，您可以根据当前的 Sitecore 项目一次性设置更多属性，例如元关键字和元描述。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-09-21T20:25:22.687

我会将以下内容添加到其中的布局或子布局中：

```
<head runat="server" id="_Head">
    <title><sc:FieldRenderer ID="frTitle" runat="server" FieldName="title" /></title>
</head> 
```

还要确保调用`DataBind();`或设置`Sitecore.Context.State.DataBind`为 true。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-03-04T14:18:01.617

你可以简单地使用这个：

<title> <%=Sitecore.Context.Item["PageTitleFieldName"] %> </title>

从给定字段呈现页面标题效果很好。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2012-09-17T23:36:52.953

如果您希望 Sublayout 覆盖 Layout 中设置的标题，您可以将 Layout 中的代码移动到`Page_Init`并`Page_Load`在您的 Sublayout 中使用。

如果这不起作用，那么您的子布局可能无法访问页面。您可以尝试使用`WebUtil.CurrentPage.Title`访问当前页面标题。它可能还需要您在 head 和 title 元素上设置 runat="server" ，如下所示：

```
<head runat="server">
    <title runat="server"></title> 
```

# xml - 使用 VS2010 在 .NET 中自定义 Outlook 2007 功能区；insertBeforeMso 动态函数

> ID：12467937
> 
> 赞同：1
> 
> 时间：2012-09-17T22:26:16.513
> 
> 标签：xml, vsto, ribbon, outlook-addin, vb.net-2010

谁能帮我获得打开的 Outlook 项目窗口的第一个选项卡 idMso 值？我需要在功能区 xml 文件中动态设置它，因为我发现将每个项目窗口添加到 xml 代码中是多余的。如果有人有现有的解决方案可以分享，那就太好了。

谢谢

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-09-19T05:14:21.493

解决了:)

只需在运行时编辑 GetCustomUI 的返回字符串，但首先捕获资源管理器项

```
Public Function GetCustomUI(ByVal ribbonID As String) As String Implements Office.IRibbonExtensibility.GetCustomUI
    Dim strResText As String = ""
    Dim strGetRes As String = ""

    Select Case ribbonID

        Case "Microsoft.Outlook.Appointment"

            strGetRes = GetResourceText("OutlookAddIn.Ribbon1.xml")
            strResText = strGetRes.Replace("TabNewMailMessage", "TabAppointment") 'default value of it is TabNewMailMessage

        Case Else

            strResText = GetResourceText("OutlookAddIn.Ribbon1.xml")

    End Select
    Return strResText
End Function 
```

原始 XML 字符串：

```
<tab id="customTab" label="myCustomTab" insertBeforeMso="TabNewMailMessage" visible="true"> 
```

约会项目窗口上的新 XML 字符串：

```
<tab id="customTab" label="myCustomTab" insertBeforeMso="TabAppointment" visible="true"> 
```

# c# - Facebook random error “An error occurred. Please try again later”

> ID：12467938
> 
> 赞同：1
> 
> 时间：2012-09-17T22:26:28.833
> 
> 标签：c#, facebook, facebook-javascript-sdk, facebook-c#-sdk

EDIT: It seems that I can only make 2 posts per day. If I remove the Logout step I can post as much as I want.

I've looked at many other “An error occurred. Please try again later” threads on here and haven't seen exactly my issue so I feel it does warrant its own thread.

I have an app thats sole purpose is to schedule and post messages to Facebook. This app has been working great. As flawless as a FB app can run. I was asked to force the user to relog in every post for security reasons so the first step is to use the javascript SDK to log the user out, then proceed to logging them in and prompting them for their information.

This also works, most of the time... For some unknown reason I randomly get the “An error occurred. Please try again later” page after I enter my FB login credentials.

So the flow is:

User configures the post. User hits 'send now.' We log the user out. We attempt to authenticate the user. The user is prompted by FB for their UN/PW. The user submits this information. “An error occurred. Please try again later”</p>

Once this starts it continues until I give up. Trying again later does indeed eventually work however whatever is broken needs to be fixed.

It's important to note that there have been no code changes in the project at all between when it works and when it starts throwing the “An error occurred. Please try again later” error. The exact same code works for One, two or three posts and then FB decides it just wont let me do anything anymore.

I do notice that when it stops working it stops prepopulating my e-mail address when prompted to log in. However when it works it will prepopulate that field.

Has anyone seen what I've described?

Yes we have sandbox disabled. Yes the domain matches up. Everything is configured correctly enough that it works when it wants to.

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-09-21T17:35:05.777

So it seems that the problem was resulting from me being logged in to the main browser page but calling FB.logout() from a page within an iFrame.

# svg - 如何重新创建 svg 使用 d34raphael 的元素？

> ID：12467943
> 
> 赞同：1
> 
> 时间：2012-09-17T22:26:52.053
> 
> 标签：svg, raphael, d3.js

我知道[拉斐尔](http://raphaeljs.com/)可以创建路径，但不能创建线条。我知道[d3](http://d3js.org/)可以同时创建两者。

我想创建一个盒须图，类似于[这个](http://mbostock.github.com/d3/ex/box.html)，但水平而不是垂直。我有以下形式的 json 数据：

```
{
    "lowestValue":"53",
    "lowerQuartile":"63",
    "medianValue":"73",
    "upperQuartile":"80",
    "highestValue":"99",
    "targetValue":"80"
},
... 
```

如何使用[d34raphael](http://webmonarch.github.com/d34raphael/)或纯 raphael 创建一个（或多个）盒须图，以便在 IE7/IE8 中正确显示？

这是最终目标的图片：

![图表](../Images/68047cda3b043dcfef8fd6105214baa3.png)

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-09-17T23:13:42.377

路径是如此相似的原语，以至于使用原始 Raphael 重新创建这样的图形似乎很容易（这些天这似乎越来越成为我的偏好）。考虑这样一个效用函数：

```
function whisker( paper, x, y, width, height, data )
{
    var x1 = x + data.lowestValue * width / 100, x2 = x + data.highestValue * width / 100;
    var outer_range = paper.path( [ "M", x1, y + height * 0.25, "L", x1, y + height * 0.75, "M", x1, y + height / 2, "L", x2, y + height / 2, "M", x2, y + height / 4, "L", x2, y + height * 0.75 ] ).attr( { fill : 'none', stroke: 'gray' } );
    var inner_range = paper.rect( x + ( width * data.lowerQuartile / 100 ), y, width * ( data.upperQuartile - data.lowerQuartile ) / 100, height, 0 ).attr( { fill: 'lightgray', stroke: 'black' } );
    var median = paper.path( [ "M", x + width * data.medianValue / 100, y, "L", x + width * data.medianValue / 100, y + height ] ).attr( { fill: 'none', stroke: 'black' } );;
    var target = paper.circle( x + ( width * data.targetValue / 100 ), y + height / 2, height / 4 ).attr( { fill: 'black' } );
} 
```

第六个参数就是你的 json 数据。当然，您需要增加每个胡须的 y 值。这是我网站上的[代码。](http://voidblossom.com/tests/whiskers.php)

# ruby-on-rails - globalize3 翻译 gem：我该如何处理不需要翻译的属性（在编写迁移时）？

> ID：12467957
> 
> 赞同：0
> 
> 时间：2012-09-17T22:28:40.230
> 
> 标签：ruby-on-rails, ruby-on-rails-3, translation, globalize3

globalize3 gem 的 github 页面[https://github.com/svenfuchs/globalize3](https://github.com/svenfuchs/globalize3)清楚地概述了如何使用您想要多次翻译的字符串和文本属性来准备模型的迁移。例如：

```
 class CreatePosts < ActiveRecord::Migration
   def up
     create_table :posts do |t|
     t.timestamps
   end
   Post.create_translation_table! :title => :string, :text => :text
 end
 def down
   drop_table :posts
   Post.drop_translation_table!
 end
 end 
```

如果我有某些不需要翻译的属性怎么办——例如保存 user_id 或其他整数值属性。我是否将它们写在下面作为 Post.create_translation_table 的一部分！声明，还是将它们留在 create_table :posts 部分的上方？

EG 哪个是正确的：

```
 def up
    create_table :posts do |t|
      #put it here as t.integer :user_id?
    end
    Post.create_translation_table! :title => string, :text => :text #user_id dec here?
 end 
```

谢谢！

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-09-17T22:55:22.273

快速回答：是的，您对待未翻译的属性就像对待任何其他 activerecord 模型中的属性一样，所以：

```
create_table :posts do |t|
  t.integer :user_id
end 
```

是正确的。

所做的是`create_translation_table`创建一个名为 的*单独*表`post_translations`，它将在其中存储已翻译属性的各个翻译以及特定翻译的语言环境和`posts`表中父记录的 id。

如果您在`schema.rb`运行迁移后查看，您将看到两个表，其中一个带有`user_id`（和时间戳，始终需要）：

```
create_table "posts", :force => true do |t|
  t.integer  "user_id"
  t.datetime "created_at",                 :null => false
  t.datetime "updated_at",                 :null => false
end 
```

以及另一个用于翻译属性翻译的表，该表是由您`create_translation_table`在迁移中调用创建的：

```
create_table "post_translations", :force => true do |t|
  t.integer  "post_id"
  t.string   "locale"
  t.string   "title"
  # any other translated attributes would appear here
  t.datetime "created_at",  :null => false
  t.datetime "updated_at",  :null => false
end 
```

你可能会问，为什么 globalize3 会创建一个单独的表呢？为什么不将它们与父记录放在同一个表中（例如，以表格`title_en`等形式`title_es`）？还有其他翻译 gem 可以做到这一点，例如[traco](https://github.com/barsoom/traco)。但问题是，如果您将翻译放在父记录中，那么您必须*事先*指定您将支持的语言环境，因为您需要为每个语言环境中的属性创建列。如果添加新的语言环境，则必须迁移数据库以支持它们。

另一方面，使用 globalize3 解决方案，您不必事先决定要支持哪些语言环境，因为翻译表中的每条已翻译记录都附加了一个语言环境——您不会在任何地方“硬编码”支持的语言环境。这是处理问题的一种非常优雅的方式，并且是 globalize3 流行的基础，但一开始可能会有点混乱，因为 gem 必须做一些诡计才能使它*看起来*像属性附加到模型 ( `Post`)而它们实际上是附加到另一个类的，`Post::Translation`.

无论如何，这比你要求的要多，但是有用的东西要知道。

# android - 为什么不调用 Finish() 立即关闭我的活动？

> ID：12467959
> 
> 赞同：0
> 
> 时间：2012-09-17T22:28:44.430
> 
> 标签：android, android-activity

所以这是我的场景。

1.  Activity1 启动 - 我的初始屏幕显示
2.  用户单击登录按钮
3.  登录活动运行 - 登录屏幕显示
4.  用户输入用户名和密码，点击提交按钮
5.  如果 userid 和 Passwod 有效，则执行到 FeaturesMenu 活动的 StartActivity，得到第 7 步
6.  Userid 和 Password 无效，在 SignOn Screen 视图中的 textview 中设置消息，输入更正并单击提交按钮或单击取消按钮并调用 Finish()。
7.  FeatureMenu Activity 运行并显示按钮列表供用户单击。
8.  用户单击按钮以列出来自 SQLite DB、光标的血压读数。
9.  运行 BloodPressList 活动的 StartAcitvity。
10.  然后将光标绑定到 customCrusor 适配器和列表视图
11.  与 BloodPressure List Activity 关联的屏幕按天显示每个读数条目的行列表。如果没有数据返回到光标，则显示空白屏幕。在任何一种情况下，屏幕底部都会显示一个标记为“完成”的按钮。
12.  当用户单击完成按钮时，血压列表活动屏幕应消失，功能菜单屏幕应返回。这样用户现在可以选择其他一些功能。顺便说一句，“完成”按钮除了调用 Finish() 之外什么都不做。实际发生的是血压列表活动屏幕闪烁并保持显示。当我再次单击完成时，它最终消失并显示功能菜单。

是什么赋予了？为什么对 Finish 的调用没有立即将我带回功能菜单。为什么我需要点击两次完成按钮？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-09-17T22:32:30.690

您必须有两个血压列表活动实例。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-09-17T22:40:22.417

听起来您正在启动 ListActivity 的两个实例，我的猜测是您在步骤 8-9 或步骤 11 中做了一些奇怪的事情。但是您必须为我们发布一些代码才能真正帮助您。

# .net - 使用 MSBuild 命令行指定发布版本作为项目的程序集版本

> ID：12467960
> 
> 赞同：15
> 
> 时间：2012-09-17T22:28:53.010
> 
> 标签：.net, msbuild, clickonce

我有一个从 DOS 命令行运行的简单批处理文件，用于构建发布[ClickOnce](http://en.wikipedia.org/wiki/ClickOnce)项目的小型 C# 应用程序。一行是这样的：

```
msbuild MyApp.csproj /t:publish /property:PublishDir="deploy/" 
```

这当前发布了应用程序，但它使用了我在 Visual Studio 的“发布”选项卡中设置的*发布版本。*我希望能够在命令行设置发布版本，具体来说，我想使用项目的*组装版本*。就像是：

```
msbuild MyApp.csproj /t:publish /property:PublishDir="deploy/" /property:PublishVersion="$(Proj.AssemblyVersion)" 
```

我希望不创建自定义任务，因为这只是一个临时解决方案，稍后我将用更合适的构建系统替换它。

或者，我查看了使用带有标志的[Mage 命令行工具](http://msdn.microsoft.com/en-us/library/acz3y3te.aspx)`-Update`更新已发布的清单版本，但我不知道如何在不使用[PowerShell](http://en.wikipedia.org/wiki/Windows_PowerShell)或某些需要的程序的情况下从项目或构建的程序集中检索程序集版本号被下载。如果我可以使用 Visual Studio 附带的东西，那也可以。

* * *

## 回答 #1

> 赞同：14
> 
> 时间：2012-09-19T06:38:46.487

尝试将此添加到您的 .csproj 文件中。目标将从输出程序集中检索版本并在发布之前更新 ApplicationVersion：

```
<Target Name="AfterCompile">
  <GetAssemblyIdentity AssemblyFiles="$(TargetPath)">
    <Output TaskParameter="Assemblies" ItemName="fooAssemblyInfo"/>
  </GetAssemblyIdentity>
  <PropertyGroup>
    <ApplicationVersion>%(fooAssemblyInfo.Version)</ApplicationVersion>
  </PropertyGroup>
</Target> 
```

动态获取程序集名称可能有更好的方法，但出于您的目的，它应该可以解决问题。

归功于此`GetAssemblyIdentity`语法的答案： [https ://stackoverflow.com/a/443364/266882](https://stackoverflow.com/a/443364/266882)

**发问者编辑：**

请参阅下面的评论以获取更新。

* * *

## 回答 #2

> 赞同：12
> 
> 时间：2014-07-24T15:34:40.790

```
msbuild xxx.csproj /target:clean;publish /property:ApplicationVersion=1.2.3.4 
```

* * *

## 回答 #3

> 赞同：10
> 
> 时间：2014-07-24T20:01:20.150

为了正确更新部署清单中声明的​​版本，您需要在“AfterCompile”步骤而不是“BeforePublish”步骤修改 ApplicationVersion，因为应用程序清单是在构建时生成的。但是您不能依赖 $(TargetPath) 属性指向程序集，而是使用以下路径：$(ProjectDir)obj\$(ConfigurationName)\$(TargetFileName)

因此，这是您可以添加到 .csproj 文件中的更新后的 Target 代码片段：

```
<Target Name="AfterCompile">
  <GetAssemblyIdentity AssemblyFiles="$(ProjectDir)obj\$(ConfigurationName)\$(TargetFileName)">
     <Output TaskParameter="Assemblies" ItemName="AssemblyInfo" />
  </GetAssemblyIdentity>
  <PropertyGroup>
    <ApplicationVersion>%(AssemblyInfo.Version)</ApplicationVersion>
  </PropertyGroup>
</Target> 
```

# playframework - 在 WebSphere 8 上播放 1.2.x

> ID：12467965
> 
> 赞同：2
> 
> 时间：2012-09-17T22:30:02.407
> 
> 标签：playframework, websphere, javassist

我想将一个简单的 Play (1.2.4) 应用程序部署到 WebSphere 8。我让该应用程序在 Windows 上本地运行。两者都是 Java 1.6。我使用以下方法创建了一个 WAR 文件：

```
play clean
play war --zip -o c:\sampleapp 
```

然后修改生成的 web.xml 以定义我的服务器数据源，再次构建 war 文件并部署。在部署期间，它从 web.xml 中找到了我的资源引用，并将其绑定到 WAS 定义的数据源。然后我将类加载器顺序更改为“最后一个父级”（基于 Play 部署选项页面和其他线程）。然后我启动了应用程序，没有任何错误。

我有一个类，它使用标记为@OnApplicationStart 的方法扩展 play.jobs.Job。当我通过 WAS 控制台启动新安装的应用程序时，它会启动并执行此方法，该方法连接到数据源并加载一些数据并将其放入缓存中。

当我尝试访问我的第一个控制器时，问题就出现了，我得到了这个错误：

```
[9/17/12 16:19:48:132 CDT] 00000022 servlet       I com.ibm.ws.webcontainer.servlet.ServletWrapper init SRVE0242I: [sampleapp] [/sampleapp] [play]: Initialization successful.
[9/17/12 16:19:48:773 CDT] 00000022 SystemOut     O 16:19:48,772 ERROR ~

@6bl9mfbm1
Internal Server Error (500)

Execution exception (In /app/controllers/Application.java around line 41)
RuntimeException occured : play.mvc.Scope$Session

play.exceptions.JavaExecutionException: play.mvc.Scope$Session
        at play.mvc.ActionInvoker.invoke(ActionInvoker.java:231)
        at play.server.ServletWrapper$ServletInvocation.execute(ServletWrapper.java:557)
        at play.Invoker$Invocation.run(Invoker.java:278)
        at play.server.ServletWrapper$ServletInvocation.run(ServletWrapper.java:548)
        at play.Invoker.invokeInThread(Invoker.java:68)
        at play.server.ServletWrapper.service(ServletWrapper.java:142)
        at javax.servlet.http.HttpServlet.service(HttpServlet.java:668)
        at com.ibm.ws.webcontainer.servlet.ServletWrapper.service(ServletWrapper.java:1214)
        at com.ibm.ws.webcontainer.servlet.ServletWrapper.handleRequest(ServletWrapper.java:774)
        at com.ibm.ws.webcontainer.servlet.ServletWrapper.handleRequest(ServletWrapper.java:456)
        at com.ibm.ws.webcontainer.servlet.ServletWrapperImpl.handleRequest(ServletWrapperImpl.java:178)
        at com.ibm.ws.webcontainer.filter.WebAppFilterManager.invokeFilters(WebAppFilterManager.java:1027)
        at com.ibm.ws.webcontainer.webapp.WebApp.handleRequest(WebApp.java:3703)
        at com.ibm.ws.webcontainer.webapp.WebGroup.handleRequest(WebGroup.java:304)
        at com.ibm.ws.webcontainer.WebContainer.handleRequest(WebContainer.java:962)
        at com.ibm.ws.webcontainer.WSWebContainer.handleRequest(WSWebContainer.java:1662)
        at com.ibm.ws.webcontainer.channel.WCChannelLink.ready(WCChannelLink.java:195)
        at com.ibm.ws.http.channel.inbound.impl.HttpInboundLink.handleDiscrimination(HttpInboundLink.java:452)
        at com.ibm.ws.http.channel.inbound.impl.HttpInboundLink.handleNewRequest(HttpInboundLink.java:511)
        at com.ibm.ws.http.channel.inbound.impl.HttpInboundLink.processRequest(HttpInboundLink.java:305)
        at com.ibm.ws.http.channel.inbound.impl.HttpICLReadCallback.complete(HttpICLReadCallback.java:83)
        at com.ibm.ws.tcp.channel.impl.AioReadCompletionListener.futureCompleted(AioReadCompletionListener.java:165)
        at com.ibm.io.async.AbstractAsyncFuture.invokeCallback(AbstractAsyncFuture.java:217)
        at com.ibm.io.async.AsyncChannelFuture.fireCompletionActions(AsyncChannelFuture.java:161)
        at com.ibm.io.async.AsyncFuture.completed(AsyncFuture.java:138)
        at com.ibm.io.async.ResultHandler.complete(ResultHandler.java:204)
        at com.ibm.io.async.ResultHandler.runEventProcessingLoop(ResultHandler.java:775)
        at com.ibm.io.async.ResultHandler$2.run(ResultHandler.java:905)
        at com.ibm.ws.util.ThreadPool$Worker.run(ThreadPool.java:1659)
Caused by: java.lang.RuntimeException: play.mvc.Scope$Session
        at javassist.runtime.Desc.getClassType(Desc.java:156)
        at javassist.runtime.Desc.getType(Desc.java:122)
        at javassist.runtime.Desc.getType(Desc.java:78)
        at controllers.Application.connected(Application.java:41)
        at controllers.Application.index(Application.java:49)
        at play.mvc.ActionInvoker.invokeWithContinuation(ActionInvoker.java:548)
        at play.mvc.ActionInvoker.invoke(ActionInvoker.java:502)
        at play.mvc.ActionInvoker.invokeControllerMethod(ActionInvoker.java:478)
        at play.mvc.ActionInvoker.invokeControllerMethod(ActionInvoker.java:473)
        at play.mvc.ActionInvoker.invoke(ActionInvoker.java:161)
        ... 28 more 
```

这是我的相关控制器代码：

```
public class Application extends Controller {

    @Before(unless={"login","index"})
    static void addUser() {
        User user = connected();
        if(user != null) {
            flash.put("user", user);
//          renderArgs.put("user", user);
        } else {
            flash.error("Please log in.");
            index();
        }

    }

    static User connected() {
//        if(renderArgs.get("user") != null) {
//            return renderArgs.get("user", User.class);
//        }
        String username = session.get("user");   // Line 41 - Error!
        if(username != null) {
            return User.find("byUsername", username).first();
        } 
        return null;
    }

    public static void index() {
        if(connected() != null) {
            Download.index(1);
        }
        render();
    }  
    ..
    ..
} 
```

该错误似乎来自会话引用。请注意，引用 renderArgs 的注释行在活动时也会导致类似的错误。

javassist 是否在某处没有正确“增强”？我尝试用最新版本替换 javassist jar，结果相同。

我正在努力让 Play 在这里的“企业”中发挥作用，所以我真的很喜欢这个工作。截至 2012 年 9 月，我无法判断 Play 是否在 WAS8 上成功运行。我会考虑 Play 2 (java)，但它似乎**绝对**不支持 WAS，并且插件 play2war 看起来也不支持 WAS。愚蠢的是，我们不能没有 WAS，但这是我们企业的现实。

**更新**：
我现在也尝试了 Play 1.2.5 并创建了一个新应用程序，并在 Application.index 方法中添加了一行 session.get("x") 。部署了war文件并在第一次访问时遇到了同样的错误。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-09-18T22:08:17.817

抱歉，我没有针对您的问题的具体解决方案。

但是，请考虑以下线索作为线索。

*   [WebSphere Application Server 和 Play!Framework](https://groups.google.com/forum/?fromgroups=#!searchin/play-framework/websphere$20Yan/play-framework/dB9DGM7wLrI/JHhOT_0uyPAJ)
*   [如何将 Play 应用程序部署到 Websphere 7](https://stackoverflow.com/questions/9388217/how-to-deploy-play-app-to-websphere-7)

但是，您也可以尝试邮件列表 (play-framework@googlegroups.com)，看看是否有人有解决方案或遇到同样的问题。您也可以通过邮件列表搜索。

不过一般来说，建议在生产中也使用播放服务器，因为它已经足够好了。如果你愿意，你也可以把 apache/nginx 放在前面。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-01-31T18:38:54.273

也许这个问题可以通过调整 WebSphere 中的类加载器设置来解决。如果想到这一点让您不寒而栗，并且您希望 WAS 不会妨碍您，您可以尝试这种解决方法。

创建一个与此类似的启动作业：

```
@OnApplicationStart
public class Startup extends Job {

    public void doJob() {
        javassist.runtime.Desc.useContextClassLoader = true;
    }
} 
```

# spring - 当我已经有集成测试时，我应该为 CRUD 操作编写单元测试吗？

> ID：12467966
> 
> 赞同：9
> 
> 时间：2012-09-17T22:30:07.297
> 
> 标签：spring, hibernate, unit-testing, integration-testing, crud

在我们最近的项目中，Sonar 抱怨测试覆盖率低。我们注意到它默认不考虑集成测试。除了您可以配置 Sonar，因此它会考虑它们（JaCoCo 插件）之外，当您使用集成测试覆盖所有服务和数据库层时，我们在团队中讨论了是否真的需要编写单元测试的问题反正。

我对集成测试的意思是，我们所有的测试都针对我们在生产中使用的相同类型的专用 Oracle 实例运行。我们不嘲笑任何东西。如果一个服务依赖于另一个服务，我们使用真实的服务。我们在运行测试之前需要的数据，我们通过一些使用我们的服务/存储库（DAO）的工厂类来构建。

因此，从我的角度来看 - 为简单的 CRUD 操作编写集成测试，尤其是在使用 Spring Data/Hibernate 等框架时并不是一件大事。有时它甚至更容易，因为您不会想到要模拟什么以及如何模拟。

**那么，为什么我要为我的 CRUD 操作编写单元测试，而这些单元测试的可靠性不如我可以编写的集成测试呢？**

我看到的唯一一点是集成测试将花费更多时间来运行，项目越大。因此，您不想在签入前全部运行它们。但我不太确定这是否如此糟糕，如果你有一个带有 Jenkins/Hudson 的 CI 环境可以完成这项工作。

所以 - 任何意见或建议都非常感谢！

* * *

## 回答 #1

> 赞同：11
> 
> 时间：2012-09-18T00:39:00.620

如果您的大多数服务只是简单地传递到您的 daos，并且您的 daos 只调用 Spring 上的方法，`HibernateTemplate`那么`JdbcTemplate`您是正确的，单元测试并不能真正证明您的集成测试已经证明的任何事情。然而，由于所有常见的原因，进行单元测试是有价值的。

由于单元测试只测试单个类，在没有磁盘或网络访问的内存中运行，并且从不真正测试多个类一起工作，它们通常是这样的：

*   服务单元测试模拟 daos。
*   Dao 单元测试模拟数据库驱动程序（或 spring 模板）或使用嵌入式数据库（在 Spring 3 中超级简单）。

要对刚刚通过 dao 的服务进行单元测试，您可以像这样模拟：

```
@Before
public void setUp() {
    service = new EventServiceImpl();
    dao = mock(EventDao.class);
    service.EventDao = dao;
}

@Test
public void creationDelegatesToDao() {
    service.createEvent(sampleEvent);
    verify(dao).createEvent(sampleEvent);
}

@Test(expected=EventExistsException.class)
public void creationPropagatesExistExceptions() {
    doThrow(new EventExistsException()).when(dao).createEvent(sampleEvent);
    service.createEvent(sampleEvent);
}

@Test
public void updatesDelegateToDao() {
    service.updateEvent(sampleEvent);
    verify(dao).updateEvent(sampleEvent);
}

@Test
public void findingDelgatesToDao() {
    when(dao.findEventById(7)).thenReturn(sampleEvent);
    assertThat(service.findEventById(7), equalTo(sampleEvent));

    service.findEvents("Alice", 1, 5);
    verify(dao).findEventsByName("Alice", 1, 5);

    service.findEvents(null, 10, 50);
    verify(dao).findAllEvents(10, 50);
}

@Test
public void deletionDelegatesToDao() {
    service.deleteEvent(sampleEvent);
    verify(dao).deleteEvent(sampleEvent);
} 
```

但这真的是个好主意吗？这些 Mockito 断言断言调用了一个 dao 方法，而不是它做了预期的事情！您将获得您的覆盖率数字，但您或多或少地将您的测试绑定到 dao 的实现。哎哟。

现在这个例子假设服务没有真正的业务逻辑。通常，这些服务除了 dao 调用之外还有业务逻辑，你肯定必须测试这些。

现在，对于单元测试 daos，我喜欢使用嵌入式数据库。

```
private EmbeddedDatabase database;
private EventDaoJdbcImpl eventDao = new EventDaoJdbcImpl();

@Before
public void setUp() {
    database = new EmbeddedDatabaseBuilder()
            .setType(EmbeddedDatabaseType.H2)
            .addScript("schema.sql")
            .addScript("init.sql")
            .build();
    eventDao.jdbcTemplate = new JdbcTemplate(database);
}

@Test
public void creatingIncrementsSize() {
    Event e = new Event(9, "Company Softball Game");

    int initialCount = eventDao.findNumberOfEvents();
    eventDao.createEvent(e);
    assertThat(eventDao.findNumberOfEvents(), is(initialCount + 1));
}

@Test
public void deletingDecrementsSize() {
    Event e = new Event(1, "Poker Night");

    int initialCount = eventDao.findNumberOfEvents();
    eventDao.deleteEvent(e);
    assertThat(eventDao.findNumberOfEvents(), is(initialCount - 1));
}

@Test
public void createdEventCanBeFound() {
    eventDao.createEvent(new Event(9, "Company Softball Game"));
    Event e = eventDao.findEventById(9);
    assertThat(e.getId(), is(9));
    assertThat(e.getName(), is("Company Softball Game"));
}

@Test
public void updatesToCreatedEventCanBeRead() {
    eventDao.createEvent(new Event(9, "Company Softball Game"));
    Event e = eventDao.findEventById(9);
    e.setName("Cricket Game");
    eventDao.updateEvent(e);
    e = eventDao.findEventById(9);
    assertThat(e.getId(), is(9));
    assertThat(e.getName(), is("Cricket Game"));
}

@Test(expected=EventExistsException.class)
public void creatingDuplicateEventThrowsException() {
    eventDao.createEvent(new Event(1, "Id1WasAlreadyUsed"));
}

@Test(expected=NoSuchEventException.class)
public void updatingNonExistentEventThrowsException() {
    eventDao.updateEvent(new Event(1000, "Unknown"));
}

@Test(expected=NoSuchEventException.class)
public void deletingNonExistentEventThrowsException() {
    eventDao.deleteEvent(new Event(1000, "Unknown"));
}

@Test(expected=NoSuchEventException.class)
public void findingNonExistentEventThrowsException() {
    eventDao.findEventById(1000);
}

@Test
public void countOfInitialDataSetIsAsExpected() {
    assertThat(eventDao.findNumberOfEvents(), is(8));
} 
```

尽管大多数人可能将其称为集成测试，但我仍然将其称为单元测试。嵌入式数据库驻留在内存中，并在测试运行时启动和删除。但这依赖于嵌入式数据库看起来与生产数据库相同的事实。会是这样吗？如果不是，那么所有这些工作都毫无用处。如果是这样，那么，正如您所说，这些测试所做的事情与集成测试不同。但是我可以按需运行它们，`mvn test`并且我有信心进行重构。

因此，无论如何我都会编写这些单元测试并满足我的覆盖目标。当我编写集成测试时，我断言 HTTP 请求会返回预期的 HTTP 响应。是的，它包含了单元测试，但是，嘿，当你练习 TDD 时，无论如何你都会在实际的 dao 实现之前编写这些单元测试。

如果您在 dao 之后编写单元测试，那么编写它们当然没有乐趣。TDD 文献中充满了关于如何在您的代码感觉像是在工作并且没有人愿意这样做之后编写测试的警告。

TL;DR：您的集成测试将包含您的单元测试，从这个意义上说，单元测试并没有增加真正的测试价值。但是，当您拥有高覆盖率的单元测试套件时，您就有信心进行重构。但是当然，如​​果 dao 只是简单地调用 Spring 的数据访问模板，那么您可能不会进行重构。但你永远不知道。最后，尽管如此，如果单元测试首先以 TDD 风格编写，那么无论如何你都会拥有它们。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-09-18T01:09:46.937

如果您计划将层暴露给项目之外的其他组件，您只需要单独对每个层进行单元测试。对于 Web 应用程序，可以调用存储库层的唯一方式是通过服务层，而可以调用服务层的唯一方式是通过控制器层。所以测试可以在控制器层开始和结束。对于后台任务，这些都是在服务层调用的，所以这里需要测试一下。

如今，使用真实数据库进行测试的速度非常快，因此，如果您设计好设置/拆卸，就不会太慢地降低测试速度。但是，如果有任何其他依赖项可能会很慢或有问题，那么应该对这些依赖项进行模拟/存根。

这种方法将为您提供：

*   良好的覆盖范围
*   现实测试
*   最小的努力
*   最少的反思努力

但是，隔离测试层确实允许您的团队更多地同时工作，因此一个开发人员可以做存储库，另一个可以为一个功能提供服务，并产生独立测试的工作。

当结合硒/功能测试时，总会有双重覆盖，因为您不能单独依赖它们，因为它们运行速度太慢。但是，功能测试不一定需要覆盖所有代码，只要代码已经被单元/集成测试覆盖，仅核心功能就足够了。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2019-11-27T19:28:22.490

我认为除了高端集成测试之外，进行更细粒度的测试（我不会在这里故意使用单元测试这个词）测试有两个优点。

1）冗余，将层覆盖在多个地方就像一个开关。如果一组测试（集成测试 f.ex.）未能找到错误，则第二层可能会捕获它。我将在这里与必须冗余的电气开关进行比较。您有一个主开关和一个专用开关。

2）假设您有一个调用外部服务的进程。由于一个或另一个原因（错误），原始异常得到消费者，并且不携带有关错误技术性质的信息的异常到达集成测试。集成测试将捕获错误，但您将不知道错误是什么或它来自哪里。进行更细粒度的测试可以增加指出正确方向的机会是什么和哪里失败了。

我个人认为测试中一定程度的冗余并不是一件坏事。

在您的特定情况下，如果您使用内存数据库编写 CRUD 测试，您将有机会测试您的 Hibernate 映射层，如果您使用 Cascading 或 fetching 等东西，这可能会非常复杂......

# plone - 在 Plone 中对视图的 HTTP 响应应用 plone.app.caching 操作

> ID：12467967
> 
> 赞同：1
> 
> 时间：2012-09-17T22:30:15.957
> 
> 标签：plone

我有一个自定义视图返回 AJAX 的 JSON 有效负载：

```
class DataSource(grok.CodeView):
    """
    Generate JSON array needed to populate the fields
    """
    grok.context(ISiteRoot)
    grok.name("dgftreeselect-test-data")

    def render(self):
        self.request.response.setHeader("Content-type", "application/json")
        return json.dumps(SAMPLE_DATA) 
```

我想对生成的 HTTP 响应应用 plone.app.caching 的*中等缓存操作。*

用 Python 表达我的意图的最短和最漂亮的方式是什么？

如果它更简单……那么直接说“在浏览器/前端代理中缓存 24 小时”。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-09-18T07:16:45.927

您想在 ZCML 中执行此操作，例如

```
 <cache:rulesetType
      name="my.package.DataSource"
      title="My data source view"
      description="Contains data stuff"
      />

  <cache:ruleset
    ruleset="my.package.DataSource"
    for=".browser.DataSource"
    /> 
```

然后，您可以使用 Plone UI 或 registry.xml 导入将 my.package.DataSource 映射到您想要的操作（例如适度缓存）。

有关如何定义规则集并将视图映射到它们，请参阅[http://pypi.python.org/pypi/z3c.caching/2.0a1 ；](http://pypi.python.org/pypi/z3c.caching/2.0a1)[http://pypi.python.org/pypi/plone.app.caching](http://pypi.python.org/pypi/plone.app.caching)了解如何管理 Plone 的规则集。

# java - 使用java代码进行binhex解码

> ID：12467973
> 
> 赞同：0
> 
> 时间：2012-09-17T22:31:01.690
> 
> 标签：java, decoding

> **可能重复：**
> [在 java 中解码 Base64 数据](https://stackoverflow.com/questions/469695/decode-base64-data-in-java)

我有一个将从某个位置下载的 java 文件。这些文件是 BinHex 编码的。是否有任何可用的 jar 文件可以在 java 代码中用于解码 binhex 文件？

请帮我。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-09-17T22:49:31.323

Apache commons 有一个名为[BCodec](http://commons.apache.org/codec/apidocs/org/apache/commons/codec/net/BCodec.html)的类，它允许指定自定义字符序列进行编码。也许您可以根据自己的需要进行调整？

无论如何，Base64 和 BinHex 背后的机制非常相似，您可以学习[这个类](http://commons.apache.org/codec/apidocs/org/apache/commons/codec/binary/Base64.html)并根据您的需要对其进行更新。我认为修改 char 序列可能就足够了。

编辑：

这是作为 BlowfishJ 库一部分的[BinConverter的实现。](https://github.com/coderslagoon/BlowfishJ/blob/8e60dd6cdf08f7b2c835969dce632377dc189d3e/src/blowfishj/BinConverter.java)

# android - Facebook：将 URL 从移动浏览器分享到 Facebook 应用程序

> ID：12467975
> 
> 赞同：2
> 
> 时间：2012-09-17T22:31:03.877
> 
> 标签：android, iphone, facebook, mobile, share

我有一个博客，每篇文章都可以通过标准的 FB 分享 url 引用。当用户点击分享该网址时，它会将他们重定向到他们做出最终分享承诺的 Facebook 网站。这对于用户通常已经登录到他们的计算机的桌面体验非常有用。

但是，如果用户在他们的移动设备上，他们更有可能登录到他们的移动应用程序而不是移动浏览器，我想利用这一点：有没有一种方法可以将用户转发到他们的移动 FB当他们分享一个网址时应用程序？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-09-17T22:53:53.523

通过这样做，您可以使用 Android 意图。

```
Intent i = new Intent(Intent.ACTION_SEND);
i.setType("text/plain");
i.putExtra(Intent.EXTRA_TEXT, "http://www.url.com");
startActivity(Intent.createChooser(i, "Share URL")); 
```

从选择器中选择 Facebook 将使用 URL 预填充帖子，用户可以编写消息并从本机 Facebook 应用程序共享 URL。

# html - 将图像添加到 HTML5 中的按钮

> ID：12467990
> 
> 赞同：1
> 
> 时间：2012-09-17T22:32:37.930
> 
> 标签：html, css

我正在制作一个 HTML5 视频播放器，但我需要在我的按钮上放一个播放图标，并且旧方法不再有效。另外，我不能使用`background-image:url('Filename');`，因为我也有渐变，当我添加`background-image`它时，它会覆盖我的渐变。有什么建议么？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-09-17T22:36:57.867

你可以做 twitter bootstrap 所做的事情，并`<i class="some-icon-class"></i>`在内容中使用 an 来轻松添加图标。

该`<i>`标签的 CSS 设置为具有特定高度和宽度的块，并具有背景图像。

他们像这样使用它：

```
<button ...><i class="plus-icon"></i> Add New Item</button> 
```

看看： http: [//getbootstrap.com/2.3.2/base-css.html#icons](http://getbootstrap.com/2.3.2/base-css.html#icons)

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-09-17T22:44:30.610

您尚未指定您的按钮元素标签到底是什么。但既然你说“html5”，我会假设你使用的是实际的“按钮”标签。也许试试这个：

```
<button onClick="eventHandler();"><img src="button_image.png" /></button> 
```

或者，也许您正在寻找不使用 img 标签且所有样式都严格在 CSS 中的“更合适”的 html5？

# ruby - ruby 中的字符编码

> ID：12467994
> 
> 赞同：1
> 
> 时间：2012-09-17T22:32:56.937
> 
> 标签：ruby, character-encoding, nokogiri

我正在使用 Nokogiri 解析来自一个荷兰站点的一些数据，并将数据保存到 csv 中。但数据显示不正确。例如，在表单 thre 上是 Einddatum1 空白空间，但是当我在保存之前将其打印到控制台时显示为“\u00A0”。其他字符串也无法正确显示，例如“Univ\u00E9 Zorg Geregeld Polis”。

```
{:Bsn=>"112511111",
 :Verzekerde=>"VerzekerdeAHM Andes-Faasse",
 :Pakketnaam1=>"Univ\u00E9 Zorg Geregeld Polis",
 :Verzekerdennummer1=>"1234987654",
 :Begindatum1=>"01 jan 2012",
 :Einddatum1=>"\u00A0",
 } 
```

也许这个 html 页面的标题可能是相关的：

```
<!doctype html>
<!-- paulirish.com/2008/conditional-stylesheets-vs-css-hacks-answer-neither/ -->
<!--[if lt IE 7 ]> <html class="no-js ie6" lang="en"> <![endif]-->
<!--[if IE 7 ]>    <html class="no-js ie7" lang="en"> <![endif]-->
<!--[if IE 8 ]>    <html class="no-js ie8" lang="en"> <![endif]-->
<!--[if (gte IE 9)|!(IE)]><!--> <html class="no-js" lang="en"> <!--<![endif]-->
<head id="Head1"><meta charset="utf-8" />

    <!-- Always force latest IE rendering engine (even in intranet)
         Remove this if you use the .htaccess -->
    <meta http-equiv="X-UA-Compatible" content="IE=edge" /><title>
    Verzekeringsrecht controleren
</title><meta http-equiv="cache-control" content="no-cache" /><meta http-equiv="content-language" content="nl-NL" /> 
```

它看起来像是 utf-8，但这些字符有问题。如何正确编码它们？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-09-18T13:04:34.983

然后该行将读取`:Pakketnaam1=>"Univé Zorg Geregeld Polis",`

那是应该存在的吗，并且您的控制台编码没有定义，所以 Ruby 在打印它们时不知道如何显示 Unicode 字符，还是应该有更多的文本？

# asp.net - asp.net 资源.resx

> ID：12467996
> 
> 赞同：0
> 
> 时间：2012-09-17T22:33:03.887
> 
> 标签：asp.net

我的网络应用程序有 Resource.resx 用于我的网站名称约定。一切正常。我将 Lblcompany 作为名称，将“test”作为值

现在，我有单独的 wcf 项目，并在那里添加了我的 Web 应用程序引用。我的问题。如何从 resource.resx 调用内容，就像我需要调用 Lblcompany 并获取在这种情况下为“测试”的值？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-09-17T22:36:55.497

它们是不同的应用程序（网站和 wcf），因此您需要复制并编译 wcf 项目中的 resource.resx。

# c++ - 将函数指针作为参数传递给 std::bind 中的另一个函数

> ID：12467997
> 
> 赞同：5
> 
> 时间：2012-09-17T22:33:08.760
> 
> 标签：c++, c++11, stdbind

我试图将传入的函数包装在 try-catch 子句中，以便我可以捕获它抛出的异常并在重新抛出之前进行一些清理。我已经编写了复制我的编译错误的示例代码。

```
#include <functional>
#include <iostream>
#include <queue>
#include <string.h>
#include <stdexcept>

using namespace std;

void foo(int a){
    throw runtime_error("died");
}

template<class F,class ...Args>
void gen(F&& f,Args&&... args){
    auto wrap = [](F f,Args... args){

        try{
            f(args...);
        }catch(exception& e){
            std::cout << "Caught exception" <<std::endl;
        }

    };

    auto bound = std::bind(wrap, std::forward<F> (f),
                           std::forward<Args>(args)...);

    bound();
}

int main()
{

    gen(foo,5);

    return 0;
} 
```

我似乎无法弄清楚如何将函数指针传递给 lambda 表达式或绑定调用。似乎在调用bound() 时报错。有人可以提供一些建议或告诉我是否有什么误解吗？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-09-17T23:24:57.793

您的问题实际上很简单：推导的类型`F&&`恰好是`void(int)`而不是`void(*)(int)`. 但是，不能复制函数，但可以复制函数指针。也就是说，有一个字符可以解决您的问题：

```
gen(&foo, 5); 
```

传递指向函数而不是函数的指针。

# c# - 循环遍历数据库项、求和值并解析不需要的文本

> ID：12467998
> 
> 赞同：-1
> 
> 时间：2012-09-17T22:33:12.457
> 
> 标签：c#, windows-phone-7, parsing, loops, sum

我想知道每个循环。我所拥有的是每个项目的几列，我想循环遍历它并从名称为“英寸”的每一列中取出值。

现在到值不仅是数字而且是字母的部分，例如“1英寸”。

所以我有 3 件物品，分别是“1 英寸”、“5 英寸”和“10 英寸”。

所以我想取出“英寸”（我猜是解析）并将这三个加在一起，所以总和是 16。

如果对于 windows phone 本地数据库 c#

我有一个 ViewModel 和一个模型。模型中的列如下所示

```
 private string _itemSpring;

    [Column]
    public string ItemSpring
    {
        get { return _itemSpring; }
        set
        {
            if (_itemSpring != value)
            {
                NotifyPropertyChanging("ItemSpring");
                _itemSpring = value;
                NotifyPropertyChanged("ItemSpring");
            }
        }
    } 
```

然后我通过带有连接字符串到数据库的视图模型查看它，

```
// LINQ to SQL data context for the local database.
    public ToDoDataContext toDoDB;

    // Class constructor, create the data context object.
    public ToDoViewModel(string toDoDBConnectionString)
    {
        toDoDB = new ToDoDataContext(toDoDBConnectionString);
    } 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-09-18T04:16:38.583

如果你的3个物品是这样的，

```
string[] items = { "1 inch", "5 inch", "10 inch" };
int totalCount = 0;
foreach(var item in items)
{
   string[] substrings = item.split(' ');
   totalCount += int.Parse(substrings[0]);
}
string finalString = totalCount + " inch"; 
```

更新：我不明白您是在询问如何从数据库中检索数据或如何处理从数据库中获取的数据。

假设第二种情况，检查以下答案

从数据库中获取数据并将其转换为 List 或 ObservableCollection，然后您可以使用以下查询来获取您想要的内容。

```
foreach(var item in ItemsList)
totalCount += double.Parse(item.ItemSize.Split(' ')[0]); 
```

或其他

```
foreach(var item in ItemsList)
totalCount += double.Parse(item.ItemSize.Replace(" inch", "")); 
```