# StackOverflow 问答 000688000-000688999

# ios - 如何判断您的代码是在 iPhone 还是 iPhone3G 上运行？

> ID：688001
> 
> 赞同：22
> 
> 时间：2009-03-27T00:01:29.077
> 
> 标签：ios, iphone

我正在尝试确定我的代码是在 iPhone 还是 iPhone3G 上运行。我的第一次尝试是在 UIKit 中使用 UIDevice 类，但 iPhone 和 iPhone3G 都返回相同的响应：

```
NSLog([[UIDevice currentDevice] name]); // Name of the phone as named by user
NSLog([[UIDevice currentDevice] uniqueIdentifier]); // A GUID like string
NSLog([[UIDevice currentDevice] systemName]); // "iPhone OS" 
NSLog([[UIDevice currentDevice] systemVersion]); // "2.2.1"
NSLog([[UIDevice currentDevice] model]); // "iPhone" on both devices
NSLog([[UIDevice currentDevice] localizedModel]); // "iPhone" on both devices 
```

这些是 UIDevice 允许您查询的唯一参数。

我在 Foundation Framework 中看了一些，但还没有找到合适的调用。

我确定有一些硬件我可以查询（例如位置服务中的某些东西），但这似乎是一个 hack。有谁知道确定这一点的简单方法？

* * *

## 回答 #1

> 赞同：21
> 
> 时间：2009-03-27T01:19:37.657

iPhone 运行 OS X。 [以下是](http://www.cocoadev.com/index.pl?MacintoshModels)在 Macintosh 桌面上确定硬件平台的方法。 [这是](http://arstechnica.com/apple/guides/2009/03/iphone-dev-determining-your-platform.ars)在 iPhone 上的方法。这是完全相同的事情。

简而言之，`sysctlbyname("hw.machine", str, sz, 0, 0)`将平台名称写入`str`. 这恰好分别是 iPhone 和 iPhone 3G 的“iPhone1,1”或“iPhone1,2”。

* * *

## 回答 #2

> 赞同：6
> 
> 时间：2009-03-27T00:43:51.733

我不是 iPhone 开发人员，但检查底层平台而不是平台功能几乎总是错误的选择。如果 iPhone 获得了您需要的功能，您仍然无法运行。您也有可能在下一代 iPhone 4.0（或其他任何名称）上做出错误的决定。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-03-27T00:49:38.337

我的猜测是 iPhone 上的某些功能不在您的软件所关注的 iPhon3G 上。我的建议是查询该特定硬件，而不是根据平台更改软件行为。

例如。而不是通过询问这是一个关于 GPS 可用性的 iPhone 或 iPhone3G 查询来检查 GPS 的可用性，然后从那里开始。这样你的代码就可以在任何平台上运行（iphone/ipod touch/iphone 3G）

# javascript - 如何创建浏览器插件？

> ID：688002
> 
> 赞同：6
> 
> 时间：2009-03-27T00:01:42.663
> 
> 标签：javascript, plugins

我必须创建一个插件，当用户将鼠标悬停在某些术语上时必须显示信息。谁能告诉我如何做的方向？

我对创建插件没有太多想法。我知道我想做的事情可以通过java脚本来完成。但是可以将 java 脚本文件安装为浏览器插件吗？对此的任何想法将不胜感激！谢谢！

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2009-03-27T00:19:36.630

您要做的是创建一个[userscript](http://userscripts.org/)。这正是您所描述的：作为插件安装在浏览器中的一段 javascript 代码。

支持用户脚本：

1.  通过 Firefox 使用[Greasemonkey](https://addons.mozilla.org/en-US/firefox/addon/748)
2.  通过 IE[使用自己的 Greasemonkey 版本](http://www.gm4ie.com/)
3.  [Google Chrome 原生（很快）](http://dev.chromium.org/developers/design-documents/user-scripts)
4.  [Opera 原生](http://www.opera.com/browser/tutorials/userjs/)
5.  甚至通过[Safari](http://www.simplehelp.net/2007/11/14/how-to-run-greasemonkey-scripts-in-safari/)

因此，几乎所有主流浏览器都提供支持。

用户脚本是您尝试做的最简单的解决方案。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-01-24T20:26:57.587

[Kango](https://stackoverflow.com/questions/2561998/how-do-i-develop-browser-plugins-with-cross-platform-and-cross-browser-compatibi)的内容脚本类似于用户脚本，可能[更好地支持所有浏览器](http://en.wikipedia.org/wiki/Greasemonkey#Compatibility)，并且如果自托管，可以[一键安装](https://stackoverflow.com/questions/9382252/how-to-create-a-link-button-on-a-web-site-to-download-and-install-browser-extens)扩展程序（以及用户脚本） ，而不是单独安装 Greasemonkey。

# mysql - 只需要从日期时间字段按日期从 MySQL 数据库中获取记录

> ID：688013
> 
> 赞同：0
> 
> 时间：2009-03-27T00:06:59.390
> 
> 标签：mysql, datetime

这看起来很简单，但它一直让我头疼。我的事件表中有一个名为“date_time”的列，它的类型是日期时间。

我需要编写一个按天获取事件的查询。

表格示例

```
============================
| id |      date_time      |
============================
| 5  | 2009-03-27 14:16:00 |
============================ 
```

现在我需要获取 ID = 5 的事件，除了我只有一个日期（unix 时间戳）可以使用。我尝试了很多事情，例如转换为 mysql 格式并在 2009-03-27 00:00:00 和 2009-03-28 00:00:00 之间进行选择，但我无法让它工作。

做这个的最好方式是什么？

非常感谢。

* * *

## 回答 #1

> 赞同：8
> 
> 时间：2009-03-27T00:09:49.477

```
SELECT * FROM table
WHERE date_time BETWEEN '2009-03-27 00:00:00' AND '2009-03-27 23:59:59' 
```

应该这样做。

或者，试试这个：

```
SELECT * FROM table WHERE DATE(date_time) = '2009-03-27' 
```

[DATE()](http://dev.mysql.com/doc/refman/5.1/en/date-and-time-functions.html#function_date)函数提取日期时间列的日期部分。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-03-27T00:12:50.187

```
select * from table WHERE date(date_time) = '2009-03-27' works for me 
```

如果你有一个 unix 时间戳，你也可以这样做

```
select * from table WHERE UNIX_TIMESTAMP(date_time) = your_timestamp 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-03-27T01:18:46.533

如果时间戳包含小数秒，则 BETWEEN 不安全。这总是安全的：

```
SELECT *
FROM table
WHERE date_time >= '2009-03-26 00:00:00' AND date_time < '2009-03-27 00:00:00' 
```

# sql - 将 XML 导入 SQL Server

> ID：688015
> 
> 赞同：6
> 
> 时间：2009-03-27T00:07:29.950
> 
> 标签：sql, sql-server, xml, tsql

我可以找到很多关于如何将某些类型的 XML 数据导入 SQL Server 2005 的示例。但是我得到了以下格式的数据（使用 ID 重复“行”和“单元格”而不是命名的标签等：

```
<?xml version="1.0"?> <rows>
    <row id='1'>
        <cell id='category'>Simple</cell>
        <cell id='query'>summary</cell>
        <cell id='clientsfound'>6</cell>
        <cell id='eligibleclients'>11</cell>
        <cell id='percentage'>55</cell>
        <cell id='days'>0</cell>
    </row>

    <row id='2'>
        <cell id='category'>Complex</cell>
        <cell id='query'>details</cell>
        <cell id='clientsfound'>4</cell>
        <cell id='eligibleclients'>6</cell>
        <cell id='percentage'>67</cell>
        <cell id='days'>5</cell>
    </row>

    ...
     </rows> 
```

理想情况下，我想将它加载到一个表中，例如：

```
CREATE TABLE [dbo].[QueryResults](
    [UserString] [varchar](50) NULL,
    [ImportStamp] [timestamp] NULL,
    [RowID] [int] NULL,
    [Category] [nchar](10) NULL,
    [Query] [nchar](10) NULL,
    [ClientsFound] [int] NULL,
    [EligibleClients] [int] NULL,
    [Percentage] [int] NULL,
    [Days] [int] NULL
) 
```

有人可以为我提供一个示例或指向在线教程吗？

* * *

## 回答 #1

> 赞同：9
> 
> 时间：2009-03-27T07:05:44.000

xml 在内部应该是 "" 而不是 '，不是吗？

无论如何，您可以本地解析 XML 数据类型。sp_xml_preparedocument 坦率地说是危险的，因为内存使用的开销。

```
DECLARE @foo XML;

SET @foo = N'<?xml version="1.0"?>
<rows>
    <row id="1">
        <cell id="category">Simple</cell>
        <cell id="query">summary</cell>
        <cell id="clientsfound">6</cell>
        <cell id="eligibleclients">11</cell>
        <cell id="percentage">55</cell>
        <cell id="days">0</cell>
    </row>
    <row id="2">
        <cell id="category">Complex</cell>
        <cell id="query">details</cell>
        <cell id="clientsfound">4</cell>
        <cell id="eligibleclients">6</cell>
        <cell id="percentage">67</cell>
        <cell id="days">5</cell>
    </row>
</rows>';

SELECT
    x.item.value('@id', 'int') AS RowID,
    y.item.value('(./cell[@id="category"])[1]', 'nchar(10)') AS category,
    y.item.value('(./cell[@id="query"])[1]', 'nchar(10)') AS query,
    y.item.value('(./cell[@id="clientsfound"])[1]', 'int') AS clientsfound,
    y.item.value('(./cell[@id="eligibleclients"])[1]', 'int') AS eligibleclients,
    y.item.value('(./cell[@id="percentage"])[1]', 'int') AS percentage,
    y.item.value('(./cell[@id="days"])[1]', 'int') AS days
FROM
    @foo.nodes('/rows/row') x(item)
    CROSS APPLY
    x.item.nodes('.') AS y(item) 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-03-27T02:45:35.560

您可以使用 OPENXML 和 XQUERY 来完成。

```
DECLARE @XMLdoc XML
DECLARE @idoc int
SELECT @XMLdoc = '<?xml version="1.0"?>
  <rows>
    <row id="1">
        <cell id="category">Simple</cell>
        <cell id="query">summary</cell>
        <cell id="clientsfound">6</cell>
        <cell id="eligibleclients">11</cell>
        <cell id="percentage">55</cell>
        <cell id="days">0</cell>
    </row>
    <row id="2">
        <cell id="category">Complex</cell>
        <cell id="query">details</cell>
        <cell id="clientsfound">4</cell>
        <cell id="eligibleclients">6</cell>
        <cell id="percentage">67</cell>
        <cell id="days">5</cell>
    </row>
  </rows>'

-- Create an internal representation of the XML document.
EXEC sp_xml_preparedocument @idoc OUTPUT, @XMLDoc

INSERT INTO QueryResults (RowID,Category,Query,ClientsFound,EligibleClients,Percentage,Days)
SELECT  id,
        overflow.value('(/row/cell[@id="category"])[1]', 'nchar(10)'),
        overflow.value('(/row/cell[@id="query"])[1]', 'nchar(10)'),
        overflow.value('(/row/cell[@id="clientsfound"])[1]', 'int'),
        overflow.value('(/row/cell[@id="eligibleclients"])[1]', 'int'),
        overflow.value('(/row/cell[@id="percentage"])[1]', 'int'),
        overflow.value('(/row/cell[@id="days"])[1]', 'int')
FROM OPENXML (@idoc, '/rows/row',10)
WITH (id int '@id',
    overflow xml '@mp:xmltext' --the row xml node
)

-- Release resources allocated for the XML document.
EXEC sp_xml_removedocument @idoc

SELECT * FROM QueryResults 
```

结果：

```
UserString  ImportStamp        RowID  Category  Query    ClientsFound EligibleClients Percentage  Days
----------- ------------------ ------ --------- -------- ------------ --------------- ----------- ----
NULL        0x000000000000C1CA 1      Simple    summary  6            11              55          0
NULL        0x000000000000C1CB 2      Complex   details  4            6               67          5 
```

我不确定您希望在“UserString”中填充什么，但您可以稍后对其进行排序。

希望这能为您的问题提供合适的解决方案。

-- 对不起 gbn，关于 sp_xml_preparedocument，您可能是对的。我只是从我们与 Microsoft SDC 团队合作的项目中获得的一些类似的存储过程中采用了这种方法，因此认为它是安全的。无论如何，您的方法可能更清洁。

# php - 如何使用通配符搜索从 CakePHP 的脚手架中获取列表？

> ID：688016
> 
> 赞同：0
> 
> 时间：2009-03-27T00:08:38.620
> 
> 标签：php, cakephp

我有一个为 CakePHP 构建的脚手架，但需要有一种方法让用户在文本框中输入部分姓氏，单击按钮并将人员列表过滤到通配符搜索。

我正在为示例代码而苦苦挣扎。有人有吗？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2009-03-27T00:25:40.920

您需要查看 CakePHP 提供的 findby 方法。

除了标准的 findAll() 之外，您还有许多“神奇”的 findby 方法，它们允许您在表中指定要搜索的列：

```
$this->User->findBySurname($surname); 
```

您还有 findBySql(statement) 允许您使用自定义 SQL 语句。您可以使用它来执行 LIKE 语句，如下所示：

```
$users = $this->User->findBySql("SELECT * FROM USERS u WHERE u.SURNAME LIKE '%" . $surname . "%' ORDERBY SURNAME"); 
```

这将为您返回匹配用户的列表，然后您可以将其显示给用户。这不是最有效的查询，但它有效。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-03-27T02:31:19.637

视图/用户/index.ctp

```
<fieldset>
    <legend>Filter users</legend>
    <?php
        echo $form->create('User', array('action' => 'index'));
        echo $form->input('surname', array('div' => false));
        echo $form->submit('Filter', array('div' => false));
        echo $form->end();
    ?>
</fieldset> 
```

控制器/users_controller.php

```
public function index($surname = null) {
    // post-redirect-get 
    if ($this->data['User']['surname']) {
       $this->redirect(array('id' => $this->data['User']['surname']));
    }
    // conditions
    $conditions = null;
    if ($surname) {
        $conditions = array('surname LIKE' => '%' . $surname . '%');
    }
    // find
    $users = $this->Users->find('all', array('conditions' => $conditions));
    // set
    $this->set(compact('users'));
} 
```

# c# - 使用 AppDomain 实例化 DLL 中的类

> ID：688026
> 
> 赞同：0
> 
> 时间：2009-03-27T00:12:06.287
> 
> 标签：c#, asp.net, assemblies, appdomain, createinstance

我有一个网站，可以根据用户需求即时编译一个类并将 dll（名为 Equation.dll）存放在网站的子目录中。管理员可以随时重新编译。但是，一旦创建了类的实例，就会显示消息“该进程无法访问该文件，因为它正被另一个进程使用”。

据我了解，解决此问题的唯一方法是从不同的 AppDomain 创建实例。下次管理员需要重新编译时，我需要卸载这个 AppDomain 并且（我认为）一切都会好起来的。（也许我的假设是错误的？）

坦率地说，我无法创建此类的实例来挽救我的生命。诚然，我在这里有点不知所措......所以我在任何事情上都在摇摆不定。此时我的片段是：

```
AppDomainSetup ads = new AppDomainSetup();
ads.PrivateBinPath = HttpContext.Current.Server.MapPath("~/equationcache/");
ads.ApplicationBase = HttpContext.Current.Server.MapPath("~/equationcache/");
AppDomain appDomain = AppDomain.CreateDomain("EquationDomain", null, ads);

Object wrapper = appDomain.CreateInstance("Equation, Version=0.0.0.0, Culture=neutral, PublicKeyToken=null", "Cnn.CostModel.Business.CalculationEngine"); 
```

“equationcache”文件夹是 dll 被编译到的位置（尽管我为了好玩而尝试将它放在“bin”中，但也没有成功）。调用中的程序集名称似乎是正确的（并且它适用于 appDomain.Load）。调用中的类型名称似乎是正确的。根据日志，会发生以下情况：

```
=== Pre-bind state information ===
LOG: User = xxx\xxx
LOG: DisplayName = Cnn.CostModel, Version=1.0.0.0, Culture=neutral, PublicKeyToken=null
 (Fully-specified)
LOG: Appbase = file:///C:/Users/xxx/Documents/Visual Studio     2008/Projects/CnnCostModel/CnnCostModels/equationcache/
LOG: Initial PrivatePath = C:\Users\xxx\Documents\Visual Studio 2008\Projects\ACnnCostModel\CnnCostModels\equationcache\Calling assembly : Equation, Version=0.0.0.0, Culture=neutral, PublicKeyToken=null.
LOG: This bind starts in default load context.
LOG: No application configuration file found.
LOG: Using machine configuration file from C:\Windows\Microsoft.NET\Framework\v2.0.50727\config\machine.config.
LOG: Policy not being applied to reference at this time (private, custom, partial, or location-based assembly bind).
LOG: Attempting download of new URL file:///C:/Users/xxx/Documents/Visual Studio 2008/Projects/CnnCostModel/CnnCostModels/equationcache/Cnn.CostModel.DLL.
LOG: Attempting download of new URL file:///C:/Users/xxx/Documents/Visual Studio 2008/Projects/CnnCostModel/CnnCostModels/equationcache/Cnn.CostModel/Apa.CostModel.DLL.
LOG: Attempting download of new URL file:///C:/Users/xxx/Documents/Visual Studio 2008/Projects/CnnCostModel/CnnCostModels/equationcache/Cnn.CostModel.EXE.
LOG: Attempting download of new URL file:///C:/Users/xxx/Documents/Visual Studio 2008/Projects/CnnCostModel/CnnCostModels/equationcache/Cnn.CostModel/Cnn.CostModel.EXE. 
```

我不明白为什么它在“equationcache”目录中寻找不同形式的“Cnn.CostModel”。诚然，调用代码位于 bin 文件夹中的“Cnn.CostModel.dll”中。我需要做什么才能获取“Equation.dll”文件？

还是我完全偏离了这项努力？非常沮丧。任何帮助将不胜感激。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-03-27T00:46:30.090

我对 AppDomains 本身了解不多，但是您的基本问题听起来很像[MEF](http://www.codeplex.com/MEF)旨在解决的问题。我不确定它是否会满足您的特定要求，但 Glenn Block 对[这篇文章](http://ayende.com/Blog/archive/2008/10/05/reading-mef-code.aspx)的评论似乎表明它会。如果您当前的架构不太远，也许值得一看。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2010-03-26T17:27:43.700

你错过了一份工作。您已经创建了新的 appdomain，但是在您可以在那里实例化一个类之前，您必须将该类所在的程序集加载到您的新 AppDomain 中，然后您可以尝试从中创建一个实例。

从您的示例看起来，方程式是您需要加载的程序集的名称，您要创建的类的名称是什么？

Rick Strahl 有一些关于如何做这一切的好信息，我从中学到了：

[http://www.west-wind.com/WebLog/posts/601200.aspx](http://www.west-wind.com/WebLog/posts/601200.aspx)

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-03-27T00:35:45.547

您看到的是 .NET 试图绑定您的调用 DLL (Cnn.CostModel.dll)。我猜 Equation.dll 引用了您的主 dll 中的某些类型，这就是您创建的 AppDomain 尝试加载它的原因。

# javascript - 如何让我的 JavaScript 引用外部定义的 var 进行验证？

> ID：688031
> 
> 赞同：2
> 
> 时间：2009-03-27T00:12:51.387
> 
> 标签：javascript, validation, myeclipse

我有一个带有几个外部 JavaScript 文件的 HTML 文件。这是一个示例，从真实的 HTML 和 JavaScript 文件中进行了一些简化：

```
<head>
  <title>Control Page</title>
  <script language="JavaScript" src="control.js"></script>
  <script language="JavaScript">
    var myWindow;
    var controlForm;

    function onPageLoad() {
      myWindow     = document.getElementById('iframe1');
      controlForm  = document.getElementById('ControlForm');
    }
  </script>
</head>
<body onLoad="onPageLoad()">
  ....
</body>
</html> 
```

然后在我的 JavaScript 文件中`control.js`：

```
function messageArrival(message) {
    chatwindow.contentWindow.document.write(message)
}

function makeNetMeetingCall() {
  controlForm.Status.value = ....
}

.... 
```

我的问题：当我验证外部 JavaScript 文件时，它抱怨主 HTML 文件中定义的变量，因为它们没有在`*.js`文件中的任何地方声明。例如，MyEclipse 的 JavaScript 编辑器抱怨它看到使用的变量未在任何可见范围内定义。如何在 JavaScript 文件中声明这些变量，以便清楚地知道这些变量应该在外部定义，类似于`extern`C 中的“”。

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2009-03-27T00:20:49.230

这听起来更像是 MyEclipse 的 JS 编辑器的问题，而不是您的 JS。

不幸的是，我不熟悉 MyEclipse。但是，我确实知道一个很好的 JS 验证器[JSLint](http://www.jslint.com/)，它通过让您在注释中定义全局变量来解释它们：

```
/*global getElementByAttribute, breakCycles, hanoi */ 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-03-27T00:24:39.580

您可以在 control.js 文件的全局范围内声明变量。

```
var controlForm;
function makeNetMeetingCall() {
 // ...
} 
```

这不会干扰最终定义这些对象的代码，因为它首先执行。但即使没有，如果没有初始化程序，它也不会覆盖任何东西。

如果您需要有关覆盖的证据，只需在 JS shell 中执行此操作：

```
$ js
js> var x = 1;
js> print( x );
1
js> var x;
js> print( x );
1
js> 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-03-27T00:19:48.907

实际上，问题在于您的“IDE”不知道它们。它没有将 HTML 页面 JS 变量与外部 javascript 文件连接起来。解决此问题的一种方法是将变量声明放入外部 javascript 文件中。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2009-03-27T00:20:22.180

您需要在包含 controls.js 脚本之前声明变量：

```
<script language="JavaScript">
var myWindow;
var controlForm;
function onPageLoad() {
   myWindow     = document.getElementById('iframe1');
   controlForm  = document.getElementById('ControlForm');
}
</script>
<script language="JavaScript" src="control.js"></script> 
```

这应该可以阻止 eclipse 抱怨，但执行方式是一样的。

# c# - 接受枚举项并返回枚举值（不是索引）的 C# 函数

> ID：688036
> 
> 赞同：4
> 
> 时间：2009-03-27T00:17:47.147
> 
> 标签：c#, function, enums, generics

说我有以下声明：

```
public enum Complexity { Low = 0, Normal = 1, Medium = 2,  High = 3 }
public enum Priority { Normal = 1, Medium = 2,  High = 3, Urgent = 4 } 
```

我想对其进行编码，以便我可以获得枚举值（而不是索引，就像我之前提到的那样）：

```
//should store the value of the Complexity enum member Normal, which is 1
int complexityValueToStore = EnumHelper.GetEnumMemberValue(Complexity.Normal); 
//should store the value 4
int priorityValueToStore = EnumHelper.GetEnumMemberValue(Priority.Urgent); 
```

这个可重用的函数应该是什么样子的？

蒂亚！-仁

* * *

## 回答 #1

> 赞同：15
> 
> 时间：2009-03-27T00:19:57.750

**修改后的答案（问题澄清后）**

不，没有什么比演员表更干净的了。它比方法调用提供更多信息，更便宜，更短等。它的影响与您可能希望的一样低。

请注意，如果您想编写一个通用方法来进行转换，您还必须指定将其转换为什么：枚举可以基于`byte`或`long`例如。通过加入演员表，你明确地说出你想把它转换成什么，它就是这样做的。

**原始答案**

你所说的“索引”到底是什么意思？你的意思是数值吗？只需投射到`int`. 如果您的意思是“枚举中的位置”，则必须确保这些值按数字顺序排列（因为这是`Enum.GetValues`给出的 - 而不是声明顺序），然​​后执行：

```
public static int GetEnumMemberIndex<T>(T element)
    where T : struct
{
    T[] values = (T[]) Enum.GetValues(typeof(T));
    return Array.IndexOf(values, element);
} 
```

* * *

## 回答 #2

> 赞同：8
> 
> 时间：2009-03-27T00:19:46.583

您可以通过强制转换找到枚举的整数值：

```
int complexityValueToStore = (int)Complexity.Normal; 
```

* * *

## 回答 #3

> 赞同：4
> 
> 时间：2010-02-09T07:39:22.070

我所知道的最通用的方法是`value__`使用反射来读取该字段。这种方法不对枚举的基础类型做任何假设，因此它将适用于不基于`Int32`.

```
public static object GetValue(Enum e)
{
    return e.GetType().GetField("value__").GetValue(e);
}

Debug.Assert(Equals(GetValue(DayOfWeek.Wednesday), 3));                //Int32
Debug.Assert(Equals(GetValue(AceFlags.InheritOnly), (byte) 8));        //Byte
Debug.Assert(Equals(GetValue(IOControlCode.ReceiveAll), 2550136833L)); //Int64 
```

注意：我只使用 Microsoft C# 编译器对此进行了测试。很遗憾，似乎没有内置的方法来做到这一点。

* * *

## 回答 #4

> 赞同：2
> 
> 时间：2009-03-27T03:10:21.710

我意识到这不是您所要求的，但您可能会欣赏它。

我发现如果你知道枚举的最小值是什么，你可以在没有强制转换的情况下找到枚举的整数值：

```
public enum Complexity { Low = 0, Normal = 1, Medium = 2,  High = 3 }

int valueOfHigh = Complexity.High - Complexity.Low; 
```

这不适用于优先级，除非您添加了一些最小值 0，或者添加了 1：

```
public enum Priority { Normal = 1, Medium = 2,  High = 3, Urgent = 4 }

int valueOfUrgent = Priority.Urgent - Priority.Normal + 1; 
```

我发现这种技术比转换为 int 在美学上更具吸引力。

我不确定如果你有一个基于字节或长的枚举会发生什么——我怀疑你会得到字节或长的差异值。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2009-03-27T00:21:34.393

如果你想要这个值，你可以将枚举转换为 int。这将设置 complexValueToStore == 1 和 priorityValueToStore == 4。

如果要获取索引（即：Priority.Urgent == 3），可以使用[Enum.GetValues](http://msdn.microsoft.com/en-us/library/system.enum.getvalues.aspx)，然后在该列表中找到当前枚举的索引。但是，返回的列表中枚举的顺序可能与您的代码中的不同。

但是，第二种选择首先违背了 Enum 的目的 - 您试图使用离散值而不是列表和索引。如果这是您想要的，我会重新考虑您的需求。

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2014-02-07T20:46:58.013

这是解决您的问题的最简单方法：

```
public static void GetEnumMemberValue<T>(T enumItem) where T : struct 
{
    return (int) Enum.Parse(typeof(T), enumItem.ToString());
} 
```

这个对我有用。

# c++ - 如何构建 std::vector 然后对它们进行排序？

> ID：688039
> 
> 赞同：38
> 
> 时间：2009-03-27T00:19:25.100
> 
> 标签：c++, string, sorting, vector

我有一堆需要排序的字符串。我认为 std::vector 是最简单的方法。但是，我以前从未使用过向量，因此需要一些帮助。

我只需要按字母数字对它们进行排序，没什么特别的。实际上， string::compare 函数会起作用。

之后，我如何遍历它们以验证它们是否已排序？

这是我到目前为止所拥有的：

```
std::sort(data.begin(), data.end(), std::string::compare);

for(std::vector<std::string>::iterator i = data.begin(); i != data.end(); ++i)
{
    printf("%s\n", i.c_str);
} 
```

* * *

## 回答 #1

> 赞同：72
> 
> 时间：2009-03-27T00:26:15.053

你可以做

```
std::sort(data.begin(), data.end()); 
```

它会对你的字符串进行排序。然后通过它们检查它们是否有序

```
if(names.empty())
    return true; // empty vector sorted correctly
for(std::vector<std::string>::iterator i=names.begin(), j=i+1; 
        j != names.end(); 
        ++i, ++j)
    if(*i > *j)
        return false;
return true; // sort verified 
```

特别是，`std::string::compare`不能用作比较器，因为它没有做`sort`它想做的事情：如果第一个参数小于第二个参数，则返回 true，否则返回 false。如果您`sort`像上面那样使用，它只会使用`operator<`，这将完全做到这一点（即使`std::string`其返回`first.compare(second) < 0`）。

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2009-03-27T00:25:14.820

究竟是什么问题？似乎一切都已经存在了。

但是，您可能应该使用`std::cout << *i << std::endl;`

1.  `i`是一个迭代器 == 指向容器中数据的指针，所以`*`需要
2.  `c_str()`是函数`std::string`而不是变量

您的代码中的问题与您的问题无关？

给你的一些提示：

*   `std::vector`还覆盖`[]`运算符，因此您可以省去迭代器的麻烦并将其像数组一样使用（从`0`到迭代`vector.size()`）。
*   您可以改用`std::set`它，它在插入时自动排序（二叉树），因此您可以节省额外的排序。
*   使用仿函数使您的输出更加有趣：`copy(V.begin(), V.end(), ostream_iterator<std::string>(cout, "\n"));`

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2009-03-27T00:33:09.280

**对于排序使用：**
`std::sort` 或`std::vector< std::string>::sort(..)`方法。
**要检查它是否已排序：**
用于`std::is_sorted`检查已排序 - [http://www.sgi.com/tech/stl/is_sorted.html](http://www.sgi.com/tech/stl/is_sorted.html)
或
`std::adjacent_find( v.begin(), v.end(), std::greater< std::string >() ) == v.end()`

对于您的情况，您可以使用默认比较器

**已编辑：**
`std::is_sorted`不是标准的 stl 函数，它在 sgi stl 实现中定义。
感谢@Brian Neal 的说明。

* * *

## 回答 #4

> 赞同：2
> 
> 时间：2009-03-27T00:41:22.990

[litb](https://stackoverflow.com/questions/688039/how-can-i-build-a-stdvectorstdstring-and-then-sort-them/688068#688068)是正确的，一如既往。

我只是想指出一个更普遍的观点——*任何*可以与 < 进行比较的东西都可以用 std::sort 进行排序。我有时会将 operator< 成员函数潜入结构中，这样我就可以做到这一点。

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2009-03-27T02:22:56.257

您可以使用 a `std::set`，它自然是一个已排序的容器。

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2015-11-21T03:09:46.113

***对字符串进行排序：***

```
using namespace std; // to avoid using std everywhere 
std::sort(data.begin(), data.end()); // this will sort the strings 
```

***检查向量是否排序：***

```
if(vec.empty())
    return true; // empty vector is sorted correctly
for(std::vector< std::string>::iterator i=vec.begin(), j=i+1; j != vec.end(); ++i, ++j)
    if(*i > *j)  return false;
return true; // sort verified 
```

***C++11 检查排序向量的方法：*** `std::is_sorted(vec.begin(),vec.end())`

***现在打印排序后的向量：***

```
 for(std::vector< std::string>::iterator i = vec.begin(); i != vec.end(); ++i)
{
    std::cout<< *i <<std::endl;
} 
```

* * *

## 回答 #7

> 赞同：0
> 
> 时间：2018-03-17T05:24:16.227

尝试使用comaprator：

```
 #include <cmath>
 #include <cstdio>
 #include <vector>
 #include <iostream>
 #include <algorithm>
 using namespace std;

//comparing function only sorts if string size is equal and keeps the larger integgers at last.
bool myfunction (string i,string j) 
{ 
int n=i.length();
int m=j.length();
if(n==m)
    return (i<j);

return n<m;   
  }

int main() {
int n;
cin>>n;
vector <string> arr(n);
for(int i=0;i<n;i++)
    cin>>arr[i];

sort(arr.begin(),arr.end(),myfunction);

for(int i=0;i<n;i++)
    cout<<arr[i]<<endl;

return 0;
 } 
```

# visual-studio - Windows XP 上的 Visual Studio

> ID：688045
> 
> 赞同：2
> 
> 时间：2009-03-27T00:19:50.467
> 
> 标签：visual-studio, memory, windows-xp

我需要在 Windows XP 上运行一些视觉工作室，它似乎占用了大量内存。我也在运行 resharper，这是一个内存猪。

我正在运行 32 位 XP。在我达到操作系统达到其极限的地步之前，我可以在我的机器中放入多少内存。

此外，运行多个视觉工作室的任何其他方式都不会降低性能。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2009-03-27T00:22:41.130

32 位操作系统的 RAM 限制为 4 GB，这对您来说可能不够，也可能不够。另外，我认为如果您安装 4 GB，Windows 会显示 3 GB 的 RAM。

如果可以的话，我建议你切换到 64 位并升级到 8 GB。

**更新：**请参阅 Jeff 关于该主题的博客文章：[伙计，我的 4 GB RAM 在哪里？](http://www.codinghorror.com/blog/archives/000811.html)

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-03-27T00:25:01.233

32 位 WinXP 可以看到的最大内存量在 3 到 4 GB 之间，具体取决于您的芯片组。

当我安装了 resharper 时，我也遇到了运行多个 VS 实例的问题。您唯一能做的就是运行具有更多内存的 64 位 XP，或者不使用 resharper（这很糟糕）。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2009-03-27T00:53:20.807

32 位 Windows 内核将 4GB 虚拟寻址空间划分为 2GB/2GB 分区。如果您将 /3GB 开关提供给 NTLDR，它将提供 1GB 内核空间/3GB 用户模式空间。请注意，这并不意味着您不能编写软件来利用具有 32 位 CPU 并同时寻址超过 4GB*的*机器。

一种解决方法是使用硬件支持的功能来访问银行或“窗口”中的剩余内存，因为 CPU 仍然可以同时看到最多 4GB 的可寻址空间。一些数据库和 GIS 软件提供了这种可能性。这称为物理地址扩展，允许使用（不是一次寻址）高达 64GB 的 36 位地址。WinXP 提供 AWE，一个建立在 PAE 之上的 API。

这就是理论。对于使用 Visual Studio，您可以获得完整的 4GB 系统或升级到具有更多 RAM 的 64 位操作系统。*仅*当 VS 提供 64 位版本时才这样做。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2009-03-27T00:59:31.743

> “此外，运行多个视觉工作室的任何其他方式都不会出现如此缓慢的性能。”

+1 技巧：您应该使用**RAM 磁盘**（[下载](http://www.mydigitallife.info/2007/05/27/free-ramdisk-for-windows-vista-xp-2000-and-2003-server/)）来加速 I/O。

如果您正在使用 - 并且希望这样做 - 源代码管理系统（即 Subversion），您必须在那里签出您的项目。VS.NET 进行大量 I/O 调用，并且 RAM 磁盘比真实磁盘快得多。

**警告！**如果您关闭计算机，RAM 磁盘就会消失。

# c# - Microsoft 消息队列 - 优先级标志或单独的队列？

> ID：688050
> 
> 赞同：6
> 
> 时间：2009-03-27T00:21:20.573
> 
> 标签：c#, .net, multithreading, msmq

我在 C# 中实现了一个系统，该系统使用 Microsoft 消息队列 ( `System.Messaging`) 在相​​关进程之间进行通信。本质上，许多*Sender*服务生成要放入队列的消息，并且许多*Receiver*进程监视队列并在它们到达时获取这些消息。

我刚刚被告知有些消息需要优先于其他消息。

消息可能会一波又一波地出现，并且可能会有大量消息一次性放入队列（比如一千左右），因此在处理最终消息之前可能会有延迟。

我最初的想法是有第二个*优先级*消息队列，它也被不同线程中的每个*接收器*进程监视。此队列中的消息会少得多，因此延迟会更少。

然后我偶然发现了该`Message.Priority`物业。

所以：

我应该使用这个优先级标志而不是实现另一个队列吗？它会成功且有效地将这些消息跳到其他消息之前吗？如果是这样，如果有的话，可能会出现什么情况和副作用？

还是我应该坚持原来的计划并为优先消息实施另一个队列？

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2009-03-27T00:30:40.020

我应该使用这个优先级标志而不是实现另一个队列吗？**是**的。

它会成功且有效地将这些消息跳到其他消息之前吗？**是**的。

如果是这样，如果有的话，可能会出现什么情况和副作用？**没有，MSMQ 被设计为以这种方式工作**。

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2011-06-06T13:30:46.813

显然不需要消息优先级 - [http://www.udidahan.com/2008/01/30/podcast-message-priority-you-arent-gonna-need-it\](http://www.udidahan.com/2008/01/30/podcast-message-priority-you-arent-gonna-need%5C%20-it/)。Udi 讨论了几种不同的可能架构以及使用多个端点而不是使用 msmq 消息优先级来设置基础架构的方法。他还提到，打开消息优先级会增加服务器上的内存使用量。

# .net - 您如何管理存储在 SVN 中并随每次构建而更改的 AssemblyInfo.cs

> ID：688051
> 
> 赞同：6
> 
> 时间：2009-03-27T00:21:33.207
> 
> 标签：.net, msbuild, build-process, assemblyinfo

我有以下场景：通过 IDE 和构建脚本构建应用程序。构建脚本用于初始设置（获取依赖项、设置环境）、生成二进制文件和持续集成过程。我希望二进制文件在构建时将月份和日期作为 AssemblyFileVersion，并在修订时使用 svn 修订。这会导致 AssemblyInfo.cs 在每个修订版上都发生变化，从而在源代码控制日志中产生大量噪音。我可以忽略这些文件，但作为设置的一部分，我需要重新生成这些文件。

我想知道是否有人有任何其他想法，或者您在这种情况下会做什么。

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2009-03-27T16:46:19.020

现在，我确定了一个受 Andy White 回答启发的解决方案：

*   AssemblyInfo.cs 由来自[http://msbuildtasks.tigris.org/的](http://msbuildtasks.tigris.org/ "MSBuild Community Tasks")*AssemblyInfo*任务生成，并保存在源代码控制树之外。
*   版本是 [major].[minor].[month][day].[svn revision]。主要和次要是手动设置的，其他由构建脚本管理。[社区任务](http://msbuildtasks.tigris.org/ "MSBuild 社区任务")包包括获取工作副本 svn 修订版和日期所需的两项任务。

不足之处：

*   当有人签出新副本时，必须运行构建脚本的*设置*目标，否则 Visual Studio 将抱怨缺少文件。这是我想在将来消除的问题。

* * *

## 回答 #2

> 赞同：5
> 
> 时间：2009-03-27T00:24:44.947

我认为 AssemblyInfo.cs 的一个常见做法是在构建过程中动态生成它，而不是保留一个静态文件。

通过生成，您可以使用任何您想要的任意/可配置的设置。

我相信 NAnt 有一个`<asminfo>`为此目的的任务。我猜 MSBuild 也有类似的东西。或者您可以编写一个自定义文件生成脚本并使用它将自定义 AssemblyInfo.cs 推入您的构建中。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2009-03-27T00:50:59.923

我们仅在 RTM/RTW/GA/(Whatever:) 发布构建后更新主干上的 AssemblyInfo。

我们的 Nightly/Beta/RC/QA/(Whatever:) 构建只需将更新的 AssemblyInfo.cs*的副本*（来自 CI 服务器上的工作副本）复制到相应的分支或标签中。我们使用 Subversion，您可以在具有未提交更改的工作副本上进行分支/标记。

这使我们能够在分支或标签中为 Nightly/Beta 构建保留正确版本的 AssemblyInfo，并且仅在最终版本发生后才触摸主干中的 AssemblyInfo。构建服务器有一个开关，告诉它在这种类型的构建中将其提交到主干。

FWIW，我们从 MSBuild 脚本驱动它，为每个项目类型设置的属性使用不同的值，从我们的构建服务器 (CruiseControl.NET) 传递。

[编辑] 另请注意，开发人员的 AssemblyInfo 版本没有更新（除非他们手动更改它），因此他们不会在每次构建时收到修改后的 AssemblyInfo 的噪音。我们让开发人员控制*Major.Minor*，构建服务器控制*Build*，我们将 Revision for QA 留给他们自己的系统（因为无论如何它都会被 WiX/MSI 忽略）。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2009-03-27T00:25:24.743

如果您不将更改后的 AssemblyInfo.cs 重新检查到源代码管理中，那么为什么会有噪音？

我建议对整个构建使用单个 AssemblyFileVersion 值，并且您可以签入包含该版本的单个文件，和/或使用版本号标记构建。这样，您就不会觉得需要签入多个修改过的 AssemblyInfo.cs 文件。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2009-05-21T14:51:40.077

我们还使用生成步骤来创建 AssemblyInfo.[cs|vb] 文件，尽管我们只是使用文件的模板副本作为源，然后使用一个小的 Perl 脚本来解析该模板、替换版本字符串并生成最终输出。

这个系统的问题是 VB 项目似乎不断地加载 AssemblyInfo 文件，这意味着项目在第一次加载时会出错，甚至在 PreBuild 步骤可以运行以创建 AssemblyInfo.vb 文件之前。我们还没有找到解决这个问题的方法——如果有人有见识，我很想听听......

# c++ - 在预编译的头文件中放什么？(MSVC)

> ID：688053
> 
> 赞同：39
> 
> 时间：2009-03-27T00:22:06.263
> 
> 标签：c++, visual-c++, precompiled-headers

预编译头文件的最佳候选者是什么？我可以将 STL 和 Boost 标头放在那里，即使它们有模板？这会减少编译时间吗？另外，减少编译时间的最佳 IDE 设置是什么？

* * *

## 回答 #1

> 赞同：51
> 
> 时间：2009-03-27T00:40:14.583

快速回答：STL 和 Boost 头文件确实属于预编译的头文件，即使这些头文件定义了模板类。

在生成预编译的头文件时，编译器会解析头文本（一项重要任务！），并将其转换为针对编译器进行优化的二进制格式。

即使在编译其他 .cpp 文件时会实例化模板类，它们也会从预编译头中的信息实例化，这对于编译器来说读取速度要快得多。

* * *

*（后来补充）*

**不**应该包含在预编译头文件中的一件事是作为项目的一部分并且经常更改的文件，即使每个 .CPP 文件都包含这些文件。

原因是这样的——预编译头的生成可能需要很长时间，因为boost、stl和windows库都非常大。

你可能有一个所有东西都使用的简单文件（例如“StringDefs.h”）。如果 StringDefs.h 包含在 stdafx.h 中，并且一个开发人员接触了 StringDefs.h，那么每个开发人员都必须等到*整个预编译头文件*重新编译。如果将 StringDefs.h 排除在预编译头文件之外，并与每个 .CPP 文件一起解析，速度会快得多。

* * *

## 回答 #2

> 赞同：6
> 
> 时间：2009-03-27T00:56:43.310

Andrew Shepherd 回答的一个补充。将预编译的头文件用于项目外部的头文件，用于不经常更改的文件。如果您一直在更改当前项目中的头文件，则可能不值得预编译它们。

* * *

## 回答 #3

> 赞同：4
> 
> 时间：2010-02-21T18:58:26.723

I've written an article on techniques that reduce the compilation time. Among these techniques a post on precompiled header and its application can be found [here](http://cheind.wordpress.com/2010/02/21/reducing-compilation-time-precompiled-header/). It also has a section on best practices that you may find interesting. CMake scripts that handle it transparently are included.

* * *

## 回答 #4

> 赞同：-1
> 
> 时间：2009-03-27T00:47:44.953

将任何内容放在该项目中的大多数 .cpp 文件无论如何都会包含的预编译头文件中。这适用于任何头文件，真的。这允许编译器解析这些文件一次，然后在同一项目的所有 .cpp 文件中重用该信息。

# web-services - IIS Active Directory 两次握手打嗝

> ID：688057
> 
> 赞同：1
> 
> 时间：2009-03-27T00:23:12.377
> 
> 标签：web-services, iis, authentication, .net-2.0

我有一个 .NET 2.0 click-once 应用程序，它连接到 Windows 2003 R2 64 位上的 IIS Web 服务。IIS 使用集成 Windows 身份验证进行设置。

因此，每当对 IIS Web 服务进行 Web 服务调用时，都会发生两次握手：

客户请求 #1

> 获取员工名单

服务器响应 #1 <- 401

```
HTTP/1.1 401 Unauthorized
WWW-Authenticate: Negotiate
WWW-Authenticate: NTLM 
```

客户请求 #2

> 请求标题...

服务器响应 #2 <- 200

> 收到的数据

然而，最近，服务器响应 #1 有时（占调用的 20%）会花费大量时间（例如 25 到 30 秒）。

我该如何调试这个问题？这是 Active Directory 问题还是域控制器问题？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2009-04-02T13:18:26.007

由于客户端将尝试通过 IUSR 获得访问权限，因此将始终进行两次握手。我不确定您是否不能发生这种情况，但请确保匿名身份验证已关闭，并且您在进入的过程中明确提供了凭据。

# objective-c - 有没有办法将 NSArray 传递给需要可变数量参数的方法，例如 +stringWithFormat：

> ID：688070
> 
> 赞同：4
> 
> 时间：2009-03-27T00:27:44.597
> 
> 标签：objective-c, cocoa, macos

一些上下文：我正在尝试清理我的一些 FMDB 代码。我的一张表有很多列，我需要使用的 FMDB 中的方法是一个需要可变数量参数的方法，类似于 NSString 的类方法`+stringWithFormat:`。

一个例子：

```
[db executeUpdate:@"insert into test (a, b, c, d, e) values (?, ?, ?, ?, ?)" ,
@"hi'", // look!  I put in a ', and I'm not escaping it!
[NSString stringWithFormat:@"number %d", i],
[NSNumber numberWithInt:i],
[NSDate date],
[NSNumber numberWithFloat:2.2f]]; 
```

当一个表只有 5 列时，它并没有那么糟糕，但是当一个列有 20+ 列时，它开始变得毛茸茸。

我想做的是创建一个包含所有数据库抽象信息的字典并动态构建这些查询。我的问题是......在Objective-C中我如何伪造那个期望可变数量参数的方法，而不是把它交给一个NSArray？

相关资料：

[我如何编写一个接受可变数量参数的方法，例如 NSString 的 +stringWithFormat:？](http://developer.apple.com/qa/qa2005/qa1405.html)

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2009-03-27T03:15:29.373

（编辑：这在 GCC 时代有效。从 Xcode 4.6 开始，它不在 Clang 之下。）

* * *

将数组中的对象放入 C 数组中，然后将其视为 varargs 列表：

```
//The example input array
int i = 42;
NSArray *array = [NSArray arrayWithObjects:
    [NSString stringWithFormat:@"number %d", i],
    [NSNumber numberWithInt:i],
    [NSDate date],
    [NSNumber numberWithFloat:2.2f],
    nil];

//The example destination (using NSString so anyone can test this)
NSString *string = nil;

//The intermediary C array
NSObject **arrayObjects = malloc(sizeof(NSObject *) * [array count]);
if (arrayObjects) {
    //Fill out the C array.
    [array getObjects:arrayObjects];

    //Use the C array as a va_list.
    string = [[[NSString alloc] initWithFormat:@"%@ %@ %@ %@" arguments:(va_list)arrayObjects] autorelease];

    free(arrayObjects);
}

NSLog(@"string: %@", string); 
```

输出：

```
2009-03-26 20:10:07.128 NSArray-varargs[606:10b] string: number 42 42 2009-03-26 20:10:07 -0700 2.2 
```

在您的情况下，您将使用该`-[FMDatabase executeUpdate:arguments:]`方法。

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2009-03-27T00:34:18.467

在 FMDatabase 上创建一个接受数组并进行更新的类别可能更容易。您应该能够复制大部分 executeUpdate 来执行此操作。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2009-03-27T00:40:17.750

我认为 NSInvocation 可能会做你想做的事情。

调用 setArgumentForIndex 时要小心，因为参数 0 和 1 是 Obj-C 填充的隐含参数，其中 arg 2 是您传递的第一个“真实”参数。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2009-03-27T00:34:34.720

这可能不是您要查找的示例。但在这种情况下，我会将您的字符串值放入一个数组中，然后使用 [theArray componentsJoinedByString:@","] 将它们转换为您的 sql 参数列表。

# apache-flex - Linux 下的 Adob e Flex Apache 模块

> ID：688073
> 
> 赞同：0
> 
> 时间：2009-03-27T00:31:06.070
> 
> 标签：apache-flex, apache, adobe

我正在尝试从这里使用 Linux 下的 Adob​​e Flex Apache (2.2) 模块 - [`http://labs.adobe.com/wiki/index.php/Flex_Module_for_Apache_and_IIS`](http://labs.adobe.com/wiki/index.php/Flex_Module_for_Apache_and_IIS)（手动安装）。我有一个完美运行的 Apache 系统，带有 Ubuntu 8.10 和 Sun JDK v6 update 10，所以安装它与支持工具无关。

**我不知道如何使这个 apache 模块工作。**

我的`httpd.conf`节目是这样的：

```
LoadModule flex_module /usr/lib/apache2/modules/mod_flex.so
AddHandler flex .mxml 
```

mod_flex.so 位于正确的位置。

我有/usr/bin/compiler.sh：

```
#!/bin/sh
java  -Djava.awt.headless=true -ms128M -mx256M -jar "/home/jamie/Adobe_Flex_Builder_Linux/flexc.jar" ${*} 2>&1 
```

（你到底为什么要硬编码这个位置？）。这个 shell 脚本被执行（例如，如果我放一个`echo "hi!" >> /tmp/log.txt`，它就会出现）。

但是，它只是返回给浏览器一个空白页面。所以模块正在做某事，它只是没有正确地做。

编译器配置文件（我把它放在与 compiler.sh 相同的目录中，作为 flexc.jar 和正在编译的 .mxml 文件参考：

```
flex_config=/home/jamie/Adobe_Flex_Builder_Linux/sdks/3.0.0/frameworks/flex-config.xml
flex_lib=/home/jamie/Adobe_Flex_Builder_Linux/sdks/3.0.0/frameworks 
```

现在，有时我设法将错误输出到浏览器中 - 它抱怨无法找到类 flash.localization.ILocalizer。

我已经设法通过编辑 flexc.jar 中的清单以指向 Adob​​e 的 3.0.0 Flex SDK 中的必要 jar 文件来消除该错误（我确实尝试将 CLASSPATH 环境变量设置为指向必要的 jar，但是那没有用）现在，我最新的错误是：

服务器发生错误。服务器错误是：'服务器线程发生错误；嵌套异常是：java.lang.NoClassDefFoundError: flex2/linker/SimpleMovie'

这显示在浏览器中格式良好的“编译结果”页面中，所以很明显，现在我让编译器尝试编译 mxml，但由于缺少 mxmlc.jar 而失败。将 mxmlc.jar 添加到 flexc.jar 清单并没有解决最后一个问题。

任何帮助表示赞赏！

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2010-01-04T17:13:06.427

经过一番谷歌搜索，我在 Tomcat-HOWTO 上找到了一个 Linux Macromedia Flex，位于[http://members.cox.net/midian/howto/flex+tomcat.htm](http://members.cox.net/midian/howto/flex+tomcat.htm)从这个角度来看，它看起来很简单。你安装了Tomcat吗？

# c# - C# 将自定义 SecurityPrincipal 隐式传递给线程

> ID：688079
> 
> 赞同：0
> 
> 时间：2009-03-27T00:34:29.043
> 
> 标签：c#, wcf, multithreading

是否可以将主线程上的客户 SecurityPrincipal 引用传递给其他子线程？有没有办法通过某种上下文将值类型信息传递给各个线程？这是在 WCF 环境中运行的，我想在其中运行并行代码，但发现自己不断地在每个线程上重置安全信息。我不希望它成为我在运行并行任务时必须明确传递的东西。

谢谢，杰布

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-03-27T01:20:03.300

分配自定义主体时子线程是否已经在运行？我只是做了一个简单的测试，似乎证实了我已经认为我知道的事情，即 Thread.CurrentPrincipal 在子线程启动时传播到子线程。

# eclipse - Eclipse 的反向显示

> ID：688084
> 
> 赞同：2
> 
> 时间：2009-03-27T00:35:47.870
> 
> 标签：eclipse

有谁知道将[Eclipse](http://www.eclipse.org/)切换到[反向显示](http://en.wikipedia.org/wiki/Inverse_video)而无需手动更改所有颜色设置的简单方法，类似于[Emacs --reverse-video](http://www.delorie.com/gnu/docs/emacs/emacs_538.html)？
谢谢！
-最大限度

附录：我遇到了一些关于这个主题的更有趣的文章。不过 Eclipse 什么都没有。

*   [Slashdot：编码的最佳配色方案，最简单的眼睛？](http://developers.slashdot.org/developers/08/07/03/1249246.shtml)
*   [编码恐怖：你的 IDE 热还是不热？](http://www.codinghorror.com/blog/archives/000682.html)
*   [Zenburn for Konsole](http://termos.vemod.net/zenburn-for-konsole)

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-03-27T13:43:38.427

可能最容易使用[其他人的首选项](http://blog.codefront.net/2006/09/28/vibrant-ink-textmate-theme-for-eclipse/)并导入然后修改它们，我不知道除了手动配置颜色之外的其他方法 - 如果它附带预定义的主题会很好。（注意：我还在欧罗巴）

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-03-31T21:49:55.510

或者：使用支持该功能的窗口管理器。我在 linux 上使用 eclipse，wm=compiz

反转总是只有 +N（又名 Windows+N）的距离

现在，我敢打赌 Windows 中也有等价物（为什么不呢？）

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2011-11-09T11:14:44.527

不是真的，但尝试安装[Eclipse Color Theme](http://www.eclipsecolorthemes.org/?view=plugin)以便于主题编辑

# asp.net - ASP.NET 应用程序中的 Google 桌面或索引文本文件搜索

> ID：688089
> 
> 赞同：3
> 
> 时间：2009-03-27T00:38:47.987
> 
> 标签：asp.net, search, indexing, full-text-search

我有一个包含数千个文本文件的文件夹，我想将内容粘贴并搜索到 Web 表单中，并在这些文件中返回匹配项。

有没有办法对这些文件进行内容索引并从 ASP.NET 应用程序中进行这些搜索？

有哪些可用的工具和技术？

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2009-03-27T00:44:53.620

对于文本（或其他）文件和开源，您可以使用**Lucene**。

[http://incubator.apache.org/lucene.net](http://incubator.apache.org/lucene.net)

Lucene 有 .NET/C# 端口。

> “Google 桌面通过将此功能提供给最终用户而引起轰动。现在，您可以使用 Lucene.Net 将相同的索引和搜索功能引入您的应用程序，Lucene.Net 是一个用 C# 语言编写的高性能、可扩展的搜索引擎库并利用 .NET Framework。”

**使用 Lucene**

[http://www.aspfree.com/c/a/BrainDump/Working-with-Lucene-dot-Net/](http://www.aspfree.com/c/a/BrainDump/Working-with-Lucene-dot-Net/)

**SO线程**

[https://stackoverflow.com/search?q=lucene.net](https://stackoverflow.com/search?q=lucene.net)

# python - 在您的发行版中包含 Python 标准库

> ID：688096
> 
> 赞同：6
> 
> 时间：2009-03-27T00:43:19.380
> 
> 标签：python, licensing

对于我正在处理的项目，我需要包含一些 Python SDK 标配的 Python 模块，因为我的目标平台（准确地说是 PyS60）不包含这些模块。我需要解决任何许可问题吗？我需要在我的项目中包含 PSF 许可证吗？

我的项目在 Apache 2.0 下获得许可。

* * *

## 回答 #1

> 赞同：10
> 
> 时间：2009-03-27T01:38:17.703

根据[PSF 许可证常见问题解答](http://wiki.python.org/moin/PythonSoftwareFoundationLicenseFaq)：

> 我可以将 Python 与我的非开源应用程序捆绑在一起吗？
> 
> 是的。与一些开源许可证不同，PSF 许可证允许 Python 以未修改或修改的形式包含在非开放应用程序中。

常见问题解答继续解释第三方模块许可。

实际上，我认为答案是“是”。

免责声明：伊纳尔。

* * *

## 回答 #2

> 赞同：7
> 
> 时间：2009-03-27T01:13:36.890

python许可证非常开放。

[Python 许可证](http://www.python.org/download/releases/2.4.2/license/)

*   Python 是完全免费的，即使用于商业用途（包括转售）。您可以销售用 Python 编写的产品或嵌入 Python 解释器的产品。此类使用无需支付许可费。

*   开源倡议已将 Python 许可证认证为开源，并将其包含在其开源许可证列表中。

*   没有类似 GPL 的“copyleft”限制。允许分发仅二进制版本的 Python，无论是否修改。不需要发布任何源代码。您还可以为 Python 编写扩展模块并仅以二进制形式提供它们。然而，根据自由软件基金会的说法，Python 许可证与 GPL 兼容。

*   您不能从源代码或生成的二进制文件中删除 PSF 的版权声明。

# javascript - Javascript中的对象与数组的键/值对

> ID：688097
> 
> 赞同：82
> 
> 时间：2009-03-27T00:43:29.130
> 
> 标签：javascript, data-structures

假设您有一个非常简单的数据结构：

```
(personId, name) 
```

...并且您想将其中的一些存储在 javascript 变量中。在我看来，您有三个选择：

```
// a single object
var people = {
    1 : 'Joe',
    3 : 'Sam',
    8 : 'Eve'
};

// or, an array of objects
var people = [
    { id: 1, name: 'Joe'},
    { id: 3, name: 'Sam'},
    { id: 8, name: 'Eve'}
];

// or, a combination of the two
var people = {
    1 : { id: 1, name: 'Joe'},
    3 : { id: 3, name: 'Sam'},
    8 : { id: 8, name: 'Eve'}
}; 
```

如果您拥有（或期望您可能拥有）多个“价值”部分要存储（例如，增加他们的年龄或其他东西），那么第二或第三个选项显然是要走的路，所以，为了争论，让我们假设这个结构中再也不需要任何数据值了。你选择哪一个，为什么？

* * *

**编辑**：该示例现在显示了最常见的情况：非顺序 ID。

* * *

## 回答 #1

> 赞同：58
> 
> 时间：2009-03-27T00:56:52.593

每个解决方案都有其用例。

如果您尝试定义一对一关系（例如简单映射），我认为第一个解决方案很好，特别是如果您需要使用键作为查找键。

总的来说，第二种解决方案对我来说是最强大的，如果我不需要快速查找键，我可能会使用它：

*   它是自描述的，因此您不必依赖任何使用 人员的*人*来知道密钥是用户的 id。
*   每个对象都是独立的，这更适合将数据传递到其他地方 - 而不是两个参数（id 和 name），你只是传递人。
*   这是一个罕见的问题，但有时键值可能无法用作键。例如，我曾经想映射字符串转换（例如，“：”到“>”），但由于“：”不是有效的变量名，我不得不使用第二种方法。
*   它很容易扩展，以防万一您需要向某些（或所有）用户添加更多数据。（对不起，我知道你的“为了争论”，但这是一个重要的方面。）

如果您需要快速查找时间 + 上面列出的一些优点（传递数据，自我描述），第三个会很好。但是，如果您不需要快速查找时间，那就麻烦多了。*此外，无论哪种方式，如果对象中的 id 与people*中的 id 有所不同，您将面临出错的风险。

* * *

## 回答 #2

> 赞同：7
> 
> 时间：2009-03-27T00:53:15.143

其实还有第四种选择：

```
var people = ['Joe', 'Sam', 'Eve']; 
```

因为您的值恰好是连续的。（当然，您必须添加/减去一个 --- 或者只是将 undefined 作为第一个元素）。

就个人而言，我会选择您的 (1) 或 (3)，因为它们是通过 ID 查找某人的最快方法（最坏的情况是 O log *n*）。如果你必须在 (2) 中找到 id 3，你可以通过索引查找它（在这种情况下我的 (4) 是可以的）或者你必须搜索 - O(n)。

澄清：我说 O(log *n* ) 是最糟糕的，因为 AFAIK 和实现可能决定使用平衡树而不是哈希表。假设冲突最少，哈希表将是 O(1)。

*来自 nickf 的编辑：我已经更改了 OP 中的示例，所以这个答案可能不再有意义。道歉。*

## 后期编辑

好的，后期编辑，我会选择选项（3）。它是可扩展的（易于添加新属性），具有快速查找的特点，并且还可以迭代。如果需要，它还允许您从条目返回 ID。

如果 (a) 您需要节省内存，选项 (1) 将很有用；(b) 你永远不需要从 object 回到 id；(c) 您永远不会扩展存储的数据（例如，您不能添加此人的姓氏）

如果您 (a) 需要保留顺序，则选项 (2) 很好；(b) 需要迭代所有元素；(c) 不需要按 id 查找元素，除非它按 id 排序（您可以在 O(log *n* ) 中进行二进制搜索。注意，当然，如果您需要保持排序，那么您将付费插入成本。

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2009-03-27T01:06:03.117

假设数据永远不会改变，第一个（单个对象）选项是最好的。

结构的简单性意味着它是最快的解析，并且在像这样的小型、很少（或从不）更改数据集的情况下，我只能想象它会被频繁执行——在这种情况下，最小的开销是要走的路。

* * *

## 回答 #4

> 赞同：2
> 
> 时间：2011-10-03T11:06:40.830

我创建了一个小库来管理键值对。

[https://github.com/scaraveos/keyval.js#readme](https://github.com/scaraveos/keyval.js#readme)

它用

*   存储键的对象，它允许快速删除和值检索操作，以及
*   允许真正快速的值迭代的链表

希望能帮助到你 ：）

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2009-03-27T02:37:21.867

第三种选择是任何前瞻性应用的最佳选择。您可能希望在您的个人记录中添加更多字段，因此第一个选项不合适。此外，您很可能要存储大量人员，并且希望快速查找记录 - 因此将它们转储到一个简单的数组中（如选项 #2 中所做的那样）也不是一个好主意。

第三种模式让您可以选择使用任何字符串作为 ID，具有复杂的人员结构，并在恒定时间内获取和设置人员记录。这绝对是要走的路。

选项#3 缺少的一件事是稳定的确定性排序（这是选项#2 的优势）。如果您需要此功能，我建议您在需要按顺序列出人员时，将人员 ID 的有序数组作为单独的结构。优点是您可以保留多个这样的数组，用于同一数据集的不同排序。

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2009-03-27T01:15:44.437

鉴于您只能将 name 作为值的限制，我会选择第一个选项。它是最干净的，开销最少，查找速度最快。

# java - 编译成java字节码（不使用Java）

> ID：688098
> 
> 赞同：20
> 
> 时间：2009-03-27T00:43:44.323
> 
> 标签：java, compiler-construction, bytecode

我的编译器类正在创建一种我们打算编译为 Java 字节码的语言。我们已经取得了很大的进步，并且正在接近生成代码的时间。

我们在查找有关如何从我们的编译器创建 .class 文件的信息时遇到问题。你有什么资源可以给我们一些帮助吗？我们已经有大量关于指令集的文档，但需要有关如何直接填写类文件/编写十六进制的信息。

我们不需要有关反编译 .class 文件的信息或建议。

即使是从头开始写出 .class 文件的简单示例也将非常出色。

**JVM 规范不是我们所追求的。**我们真正需要的是一个例子或一个演练。

* * *

## 回答 #1

> 赞同：10
> 
> 时间：2009-03-27T01:15:21.783

有许多项目提供了创建 Java 类文件的高级接口，而无需您自己编写类文件。看看以下内容：

*   ASM - [http://asm.objectweb.org/](http://asm.objectweb.org/)
*   BCEL - [http://jakarta.apache.org/bcel/](http://jakarta.apache.org/bcel/)
*   Trove - [http://teatrove.sourceforge.net/trove.html](http://teatrove.sourceforge.net/trove.html)

所有这些都提供了一个 API 来创建类文件。您总是可以查看他们为此编写的代码并为您的编译器编写一些类似的代码，尽管我认为这是相当多的工作。

使用 BCEL 看一下 ClassGen，它应该使您能够以您想要的格式写出类文件，一个简单的示例如下：

```
ClassGen cg = new ClassGen("HelloWorld", "java.lang.Object",
                             "<generated>", ACC_PUBLIC | ACC_SUPER,
                             null); 
```

* * *

## 回答 #2

> 赞同：9
> 
> 时间：2009-03-27T00:48:05.937

VM 规范：[类文件格式](http://java.sun.com/docs/books/jvms/second_edition/html/ClassFile.doc.html)和[Java 虚拟机指令集](http://java.sun.com/docs/books/jvms/second_edition/html/Instructions.doc.html)应该这样做。

您可能会查看字节码工程库 ( [BCEL](http://jakarta.apache.org/bcel/) ) 以及[Findbugs](http://findbugs.sourceforge.net/)（它必须阅读/理解类文件）来获得一些灵感。

* * *

## 回答 #3

> 赞同：4
> 
> 时间：2009-03-27T12:04:15.937

我想您可以尝试使用现有工具并检查增量更改对生成的字节码的影响。

来源：

```
public class Hello {
        public static void main(String[] args) {
                System.out.println("H");
        }
} 
```

[javap](http://java.sun.com/javase/6/docs/technotes/tools/#basic)输出：

```
Compiled from "Hello.java"
public class Hello extends java.lang.Object{
public Hello();
  Code:
   0:   aload_0
   1:   invokespecial   #1; //Method java/lang/Object."<init>":()V
   4:   return

public static void main(java.lang.String[]);
  Code:
   0:   getstatic       #2; //Field java/lang/System.out:Ljava/io/PrintStream;
   3:   ldc     #3; //String H
   5:   invokevirtual   #4; //Method java/io/PrintStream.println:(Ljava/lang/String;)V
   8:   return

} 
```

二进制：

```
CA FE BA BE 00 00 00 32 00 1D 0A 00 06 00 0F 09         _______2________
00 10 00 11 08 00 12 0A 00 13 00 14 07 00 15 07         ________________
00 16 01 00 06 3C 69 6E 69 74 3E 01 00 03 28 29         _____<init>___()
56 01 00 04 43 6F 64 65 01 00 0F 4C 69 6E 65 4E         V___Code___LineN
75 6D 62 65 72 54 61 62 6C 65 01 00 04 6D 61 69         umberTable___mai
6E 01 00 16 28 5B 4C 6A 61 76 61 2F 6C 61 6E 67         n___([Ljava/lang
2F 53 74 72 69 6E 67 3B 29 56 01 00 0A 53 6F 75         /String;)V___Sou
72 63 65 46 69 6C 65 01 00 0A 48 65 6C 6C 6F 2E         rceFile___Hello.
6A 61 76 61 0C 00 07 00 08 07 00 17 0C 00 18 00         java____________
19 01 00 01 48 07 00 1A 0C 00 1B 00 1C 01 00 05         ____H___________
48 65 6C 6C 6F 01 00 10 6A 61 76 61 2F 6C 61 6E         Hello___java/lan
67 2F 4F 62 6A 65 63 74 01 00 10 6A 61 76 61 2F         g/Object___java/
6C 61 6E 67 2F 53 79 73 74 65 6D 01 00 03 6F 75         lang/System___ou
74 01 00 15 4C 6A 61 76 61 2F 69 6F 2F 50 72 69         t___Ljava/io/Pri
6E 74 53 74 72 65 61 6D 3B 01 00 13 6A 61 76 61         ntStream;___java
2F 69 6F 2F 50 72 69 6E 74 53 74 72 65 61 6D 01         /io/PrintStream_
00 07 70 72 69 6E 74 6C 6E 01 00 15 28 4C 6A 61         __println___(Lja
76 61 2F 6C 61 6E 67 2F 53 74 72 69 6E 67 3B 29         va/lang/String;)
56 00 21 00 05 00 06 00 00 00 00 00 02 00 01 00         V_!_____________
07 00 08 00 01 00 09 00 00 00 1D 00 01 00 01 00         ________________
00 00 05 2A B7 00 01 B1 00 00 00 01 00 0A 00 00         ___*____________
00 06 00 01 00 00 00 01 00 09 00 0B 00 0C 00 01         ________________
00 09 00 00 00 25 00 02 00 01 00 00 00 09 B2 00         _____%__________
02 12 03 B6 00 04 B1 00 00 00 01 00 0A 00 00 00         ________________
0A 00 02 00 00 00 03 00 08 00 04 00 01 00 0D 00         ________________
00 00 02 00 0E                                          _____ 
```

* * *

## 回答 #4

> 赞同：2
> 
> 时间：2009-03-27T00:47:17.483

[JVM 规范](http://java.sun.com/docs/books/jvms/second_edition/html/VMSpecTOC.doc.html)可能是您正在寻找的，特别是第[4 章 - 类文件格式](http://java.sun.com/docs/books/jvms/second_edition/html/ClassFile.doc.html#80959)。

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2009-03-27T12:14:52.197

SmartEiffel 包含一个开源的 java .class 文件生成器。

[http://smarteiffel.loria.fr/](http://smarteiffel.loria.fr/)

# apache - Apache中多个目录的相同规则？

> ID：688100
> 
> 赞同：3
> 
> 时间：2009-03-27T00:43:58.303
> 
> 标签：apache, mod-rewrite, url-rewriting

我有 2 个使用相同规则的子域，如下所示：

```
<Directory /srv/project/sites/project.hu/htdocs/>
    RewriteEngine On
    RewriteCond %{REQUEST_FILENAME} !-f
    RewriteCond %{REQUEST_FILENAME} !-d
    RewriteRule ^(.*)\?*$ index.php?route=$1 [L,QSA]
    SetEnv config default,local
    Order allow,deny
    allow from 192.168.0.0/16
</Directory>

<Directory /srv/project/sites/admin.project.hu/htdocs/>
    RewriteEngine On
    RewriteCond %{REQUEST_FILENAME} !-f
    RewriteCond %{REQUEST_FILENAME} !-d
    RewriteRule ^(.*)\?*$ index.php?route=$1 [L,QSA]
    SetEnv config default,local
    Order allow,deny
    allow from 192.168.0.0/16
</Directory> 
```

如您所见，两个容器中的规则相同。如何在单个容器中指定这些规则？一开始我想用这个：

```
<DirectoryMatch ^/srv/project/sites/(?:(?:admin\.project\.hu)|project\.hu)/htdocs/$>
 ...
</DirectoryMatch> 
```

但是有没有一种方法可以以我所缺少的更干净的方式做到这一点？

编辑：我不喜欢 DirectoryMatch 方式，因为当我有更多目录时，正则表达式将变得无法维护。

* * *

## 回答 #1

> 赞同：8
> 
> 时间：2009-03-27T01:24:10.657

将重写规则放入单独的文件中，例如。`rewrite.conf`, 并像这样[包含它](http://httpd.apache.org/docs/2.2/mod/core.html#include)

```
<Directory /srv/project/sites/project.hu/htdocs/>
  Include rewrite.conf
</Directory>

<Directory /srv/project/sites/admin.project.hu/htdocs/>
  Include rewrite.conf
</Directory> 
```

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2009-03-27T00:50:10.800

```
<DirectoryMatch ^/srv/project/sites/(?:admin\.)?project\.hu/htdocs/$> 
```

这对我来说似乎很干净......

# javascript - 添加一串数字的 JavaScript 函数

> ID：688113
> 
> 赞同：2
> 
> 时间：2009-03-27T00:48:57.900
> 
> 标签：javascript

不知道如何措辞，所以在谷歌搜索中运气不佳......

我需要计算一串数字的值。

例子。用户在文本字段中输入“1.00 + 2.00 - 0.50”。该函数应该能够获取该字符串并计算结果以返回 $2.50。

任何人都有办法在他们的技巧包中做到这一点？

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2009-03-27T00:52:44.833

如果它实际上是一个数学运算，您可以只使用 eval，但不确定这是您想要的：

```
document.write(eval("1.00 + 2.00 - 0.50")); 
```

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2009-03-27T00:52:57.097

Theo T 的答案看起来是最直接的方法，但如果您需要编写自己的简单解析器，您可以先[拆分](http://www.w3schools.com/jsref/jsref_split.asp)字符串并在输出中查找您的运算符。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-10-31T17:53:46.667

只是为了改善西奥的答案。

`eval`除非您绝对确定要传递给该函数的内容，否则不应使用。由于`eval`将运行代码，因此您可以编写任何 JavaScript 代码并将其执行。

确保您只会获得正确代码的方法之一是使用以下脚本：

```
var str = "$34.00 + $25.00 alert('some code')"; // Our string with code
var pattern = /[0-9\+\-\.\*\/]*/g; // Regex pattern
var math_operation = str.match(pattern).join(''); // Getting the operation
document.write(eval(math_operation));​ // Getting the result 
```

这不仅允许用户键入类似的内容，`$34.00 + $5.00`而且还可以防止代码被注入。

# html - 当表格为空时，html页脚向右移动？

> ID：688115
> 
> 赞同：0
> 
> 时间：2009-03-27T00:49:49.753
> 
> 标签：html, css, layout, html-table, footer

有一个由表单标签包围的数据表。在页面底部有一个固定的页脚。

当表格为空时（仅显示表格标题），整个页脚会移到屏幕的一半，向右移动。

有任何想法吗？

```
<form action="/cgi-bin/Lib.exe" method=POST name="dd" ID="Form1">
    <div id="yyy">          

            <table cellspacing="0" ID="Table1">

                    <thead>
                        <tr>    
                            <th>Start</th>
                            <th>End</th>
                        </tr>
                    </thead>

        <p><small><font face="Arial"><small>$DATA</small></font></small></p>   

                    <tbody>

                        <tr>                    
                            <td><input type=radio name="begin" value="$START" ID="Radio0"> $START</td>
                            <td>$END <input type=radio name="end" value="$END" ID="Radio3"></td>
                        </tr>

                        <tr>                    
                            <td><input type=radio name="begin" value="$START" ID="Radio1"> $START</td>
                            <td>$END <input type=radio name="end" value="$END" ID="Radio4"></td>
                        </tr>           

                        <tr>                    
                            <td><input type=radio name="begin" value="$START" ID="Radio2"> $START</td>
                            <td>$END <input type=radio name="end" value="$END" ID="Radio5"></td>
                        </tr>                   

                    </tbody>    
                </table>    
    </div>
                <p><small><font face="Arial"><small>$DATA</small><strong></p>

              </strong></font></small>

        </form> 

<div id="footer">
                <div id="labfooter">

                </div>
            </div> 
```

CSS：

```
#footer {
    width:100%;
    height:5em;
}
html>body #footer {
    position:fixed;
    bottom:0;
    z-index:10; /* Prevent certain problems with form controls */
}

 #header,
#footer {
    color:#111;
    background:#ddd;
    text-align:center;
} 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-03-27T01:25:12.337

如果没有更多代码，很难调试。还有哪些浏览器和操作系统有问题？

但是，我可以说你的 html 代码是无效的，这可能会导致许多浏览器渲染失败。有时它可能看起来运行良好，但 DOM 可能会因不正确的代码而被抛弃。

开始尝试删除和之间`<p>...</p>`的`<thead>``<tbody>`

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-03-27T07:08:47.347

首先[验证](http://validator.w3.org/)您的代码。您正在混合 HTML 和 XHTML 代码，并且您的标记结构已损坏，因此需要修复一些问题。

您可能会收到比实际错误更多的错误消息，因此只需从顶部开始并修复问题，直到您清楚地看到错误，然后重新验证以查看剩余内容。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-03-27T10:43:49.373

我不认为：

```
html>body 
```

在页脚语句之前。这对于您要完成的工作是不必要的，并且可能会导致问题。

# java - 没有目标对象的Java动态代理？

> ID：688134
> 
> 赞同：3
> 
> 时间：2009-03-27T00:59:22.663
> 
> 标签：java, proxy

奇怪的问题...

在没有实际目标对象的情况下，如何像使用动态代理一样使用 Java 的调用拦截器？

例如，我想制作一个 uber 对象，它可以代表运行时指定的十几个接口，而不一定需要实现其中任何一个的对象。

基本上，这就像大多数动态语言的 __call 功能一样。

想法？

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2009-03-27T01:18:25.303

也许我误解了这个问题（如果是这样，请告诉我！）但这会让你开始吗？

```
import java.lang.reflect.InvocationHandler;
import java.lang.reflect.Method;
import java.lang.reflect.Proxy;
import java.util.Arrays;

public class Main
{
    public static void main(final String[] argv)
    {
        final Object             object;
        final InvocationHandler  handler;
        final Runnable           runnable;
        final Comparable<Object> comparable;

        handler = new InvocationHandler()
        {
            public Object invoke(final Object   proxy,
                                 final Method   method,
                                 final Object[] args)
                throws Throwable
            {
                System.out.println(proxy.getClass());
                System.out.println(method);
                System.out.println(Arrays.toString(args));
                return (0);
            }
        };

        object = Proxy.newProxyInstance(Main.class.getClassLoader(), 
                                        new Class[] { 
                                            Runnable.class, 
                                            Comparable.class,
                                        }, 
                                        handler);

        runnable = (Runnable)object;
        runnable.run();

        comparable = (Comparable<Object>)object;
        comparable.compareTo("Hello");
    }
} 
```

# php - 谁能破解这个 twitter 正则表达式？

> ID：688136
> 
> 赞同：2
> 
> 时间：2009-03-27T01:01:04.813
> 
> 标签：php, regex, twitter

我想使用 PHP 从[http://search.twitter.com/search.atom?q=%23eu-jele%C4%A1%C4%A1i获取所有主题标签](http://search.twitter.com/search.atom?q=%23eu-jele%C4%A1%C4%A1i)

主题标签位于 RSS 提要中的内容、标题节点中。它们以 # 为前缀

我遇到的问题是非英文字母（在 a-zA-Z 范围之外）。

如果您查看 RSS 提要，然后查看 html 源代码，我的挣扎可能会更清楚。

```
 <title>And more: #eu-jele&#289;&#289;i #eu-kiest #ue-wybiera #eu-eleger #ue-alege #eu-vyvolenej #eu-izvoli #eu-elegir #eu-v&#228;lja #eu-elect</title> 
```

在找到我的 rexexp 匹配项之前，我是否需要对标题节点做一些事情。

我的最终目标是用 twitter 搜索 url 替换主题标签，例如[http://search.twitter.com/search.atom?q=%23eu-jele%C4%A1%C4%A1i](http://search.twitter.com/search.atom?q=%23eu-jele%C4%A1%C4%A1i)

这里有一些示例代码可以帮助您。

```
 <!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8" />
<html xmlns="http://www.w3.org/1999/xhtml" xml:lang="en" lang="en">

<body>
<?php 
$title="And more: #eu-jele&#289;&#289;i #eu-kiest #ue-wybiera #eu-eleger #ue-alege #eu-vyvolenej #eu-izvoli #eu-elegir #eu-v&#228;lja #eu-elect";

// this is the regexp that hashtags.org use (http://twitter.pbwiki.com/Hashtags)
$r = preg_replace("/(?:(?:^#|[\s\(\[]#(?!\d\s))(\w+(?:[_\-\.\+\/]\w+)*)+)/"," <a href=\"http://search.twitter.com/search?q=%23\1\">\1</a> ", $title);
echo "<p>$r</p>";

$r = preg_replace("/(#.+?)(?:(\s|$))/"," <a href=\"http://search.twitter.com/search?q=\1\">\1</a> ", $title);
echo "<p>$r</p>";

// This is my desired end result
echo "<p><a href=\"http://search.twitter.com/search?q=%23eu-jeleġġi\">#eu-jeleġġi</a></p>";
?>

</body>
</html>
```

任何建议或解决方案将不胜感激。

* * *

## 回答 #1

> 赞同：9
> 
> 时间：2009-03-27T01:07:17.950

要不就

```
(#\S+) 
```

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2011-04-24T05:11:12.697

[如果您需要 Twitter 用来呈现主题标签的确切正则表达式，Twitter 会在这个开源库](http://engineering.twitter.com/2010/02/introducing-open-source-twitter-text.html)中提供它以及链接、提及等模式。

## 标签匹配模式

```
(^|[^0-9A-Z&/]+)(#|\uFF03)([0-9A-Z_]*[A-Z_]+[a-z0-9_\\u00c0-\\u00d6\\u00d8-\\u00f6\\u00f8-\\u00ff]*) 
```

上面的模式可以从[这个](https://github.com/mzsanford/twitter-text-java/blob/master/src/com/twitter/Regex.java)java 文件中拼凑起来。此模式的验证测试位于[此文件](https://github.com/mzsanford/twitter-text-conformance/blob/master/autolink.yml)中的第 115 行附近。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2009-03-27T01:04:14.807

抓住一个 '#' 加上所有字符，直到你碰到一个空白字符：

```
(#.+?)(?:\s) 
```

或者更灵活一点（允许字符串结尾）：

```
(#.+?)(?:(\s|$)) 
```

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2009-05-08T20:07:46.367

heres what i would use :)

```
(?<![^\s#])(#[^\s#]+)(?=(\s|$)) 
```

example matching on this string

**#test** #test#test **#test-test** test#test

hope this is helpful

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2009-03-27T03:19:22.530

你为什么使用正则表达式？删除前面没有散列的任何内容，然后按散列分解。正则表达式似乎不必要地复杂且不适合该问题。

也许您可以进一步解释为什么这需要在正则表达式中完成？

# asp.net - 验证 ASP.Net 用户控件的最佳实践是什么？

> ID：688138
> 
> 赞同：0
> 
> 时间：2009-03-27T01:02:00.367
> 
> 标签：asp.net, web-services, validation

我想知道是否存在任何关于应该和不应该进入验证器控件的指南的最佳实践。我的想法和实践是它应该是基本的健全性检查（即用户是否输入了所有必需的输入？电话号码中是否有 10 位数字，电子邮件地址是否有效？等等），但我已经最近运行了相当多的 asp.net 代码，这些代码使用验证器进行更复杂的验证（即 Web 服务调用以验证地址或用户 ID 和名称匹配）。

关于如何封装这些更复杂的任务，是否有任何思想流派？我最初的直觉是验证器是不适合这项工作的工具，但我真的很想知道其他人对此有何看法或写过什么。谢谢！

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2009-03-27T01:13:36.920

你是对的。p&p 团队在企业库中有一个很棒的块，名为**验证应用程序块**(VAB)。

> 如果您直接从用户那里收集值，则 UI 中的验证很好，但您可能需要做更多的事情。例如，您可能需要验证以下对象实例：

*   在应用程序的单独层或组件中生成
*   从缓存、存储库或第三方数据访问层检索
*   作为对象实例或一组属性值从 Web 服务接收
*   从现有值重建，可能通过从类似对象复制属性或使用从数据库检索的值来填充它们

我是 Enterprise Library 的忠实粉丝，并且对 VAB 有很好的体验。如果您不熟悉 EntLib，第一次可能会很困难 - 但在那之后它会摇滚！

VAB 让您可以选择在一个地方创建、运行和托管您的规则，但可以在需要的地方调用。

**15 秒，使用 ASP.NET 和 VAB：**

[http://www.15seconds.com/Issue/070607.htm](http://www.15seconds.com/Issue/070607.htm)

**Tom Hollander 关于 VAB 的博客**

**[http://blogs.msdn.com/tomholl/archive/2006/11/27/validation-application-block-revealed.aspx](http://blogs.msdn.com/tomholl/archive/2006/11/27/validation-application-block-revealed.aspx)**

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2010-02-26T20:14:23.690

我不知道这是否是最佳实践，但我个人的观点是，唯一应该在客户端验证的是可以在客户端完全验证的东西。换句话说，如果您必须调用服务器才能执行验证，那么您已经失去了在客户端验证所带来的任何性能提升。（这就是验证在客户端上的原因 - 通过避免访问服务器来获得性能。）

由于您的业务对象正在（或应该）对提交执行相同的验证，因此从编码和维护的角度来看，允许表单提交并在该点执行所有验证更有意义。

# generics - 电源外壳 。声明使用“Add-Type”定义的类的通用列表

> ID：688152
> 
> 赞同：22
> 
> 时间：2009-03-27T01:12:53.367
> 
> 标签：generics, collections, powershell

我正在尝试在 PowerShell 中声明 List，其中 Person 是使用 Add-Type 定义的：

```
add-type -Language CSharpVersion3 -TypeDefinition @"
    public class Person
    {
        public Person() {}

        public string First { get; set; }
        public string Last { get; set; }
    }
"@ 
```

这工作正常：

```
New-Object Person
New-Object System.Collections.Generic.List``1[System.Object] 
```

但是这条线失败了：

```
New-Object System.Collections.Generic.List``1[Person] 
```

这里有什么问题？

* * *

## 回答 #1

> 赞同：38
> 
> 时间：2009-03-27T05:27:28.043

这是新对象中的一个错误。这将帮助您更轻松地创建它们：http: [//www.leeholmes.com/blog/2006/08/18/creating-generic-types-in-powershell](http://www.leeholmes.com/blog/2006/08/18/creating-generic-types-in-powershell)

更新：PowerShell 在版本 2 中添加了对此的支持：

```
PS > $r = New-Object "System.Collections.Generic.List[Int]"
PS > $r.Add(10) 
```

* * *

## 回答 #2

> 赞同：9
> 
> 时间：2012-08-30T00:38:49.723

好吧，我试图创建一个`FileStream`对象列表，这是我的解决方案（基于[这个链接](http://blogs.msdn.com/b/thottams/archive/2009/10/12/generic-list-and-powershell.aspx)——它实际上描述了一种解决问题的方法）：

```
$fs = New-Object 'System.Collections.Generic.List[System.IO.FileStream]'
$sw = New-Object 'System.Collections.Generic.List[System.IO.StreamWriter]'
$i = 0
while ($i < 10)
{
    $fsTemp = New-Object System.IO.FileStream("$newFileName",[System.IO.FileMode]'OpenOrCreate',[System.IO.FileAccess]'Write')
    $fs.Add($fsTemp)
    $swTemp = New-Object System.IO.StreamWriter($fsTemp)
    $sw.Add($swTemp)
    $i++
} 
```

希望有帮助！

# c# - 我从哪里开始使用面向方面的编程？

> ID：688158
> 
> 赞同：6
> 
> 时间：2009-03-27T01:16:07.837
> 
> 标签：c#, .net, vb.net, c#-3.0, aop

因此，在阅读了一些 PostSharp 文档作为对我之前关于被动日志记录的问题的回答（[Ispassive logging possible in .NET?](https://stackoverflow.com/questions/687867/is-passive-logging-possible-in-net)）之后，我被引导到我的下一个问题：

哪里是开始学习面向方面编程的好地方 - 我在 Google 上进行了一些搜索，并阅读了一些文章 - 包括关于 Wikipedia 上的主题的文章，但很多材料似乎假设你有对我似乎遗漏的一些术语的基本理解，以及那些不仅仅直接进入集成的术语，让我不明白我正在集成的到底是什么。

有没有人有任何体面的材料旨在帮助那些在今天之前从未听说过面向方面编程的人了解核心概念、术语/关键字等？即使是鸟瞰图也会有所帮助——即这些是核心概念、要注意的关键字、它们代表什么以及它们如何组合在一起。在那之后，我自己可能会取得一些不错的进展。我对与 .NET 开发相关的 AOP 最感兴趣，因此任何专门针对此的材料都会有所帮助。

TIA

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-03-27T01:37:26.753

你的目标是什么？AOP有很多表现形式：

*   面向属性的编程
*   代理对象
*   上下文边界对象
*   ASP.NET 中的 HTTP 处理程序/链接
*   企业库中的 PIB
*   像 EOS 这样的后编译器（我在论文中使用了**EOS**（[http://www.cs.iastate.edu/~eos/](http://www.cs.iastate.edu/~eos/)）。）

AOP 对当今的框架产生了很大的影响，但它*只是*影响而不是破坏性的变化。是的，没有共同的语言，没有共同的定义。我认为你应该尝试attributes/PIB/EOS等，然后你可以自己定义和探索AOP。

**资源**

[http://www.codeproject.com/KB/architecture/aop2.aspx](http://www.codeproject.com/KB/architecture/aop2.aspx)

[http://blogs.msdn.com/tomholl/archive/2007/02/23/announcing-the-policy-injection-application-block.aspx](http://blogs.msdn.com/tomholl/archive/2007/02/23/announcing-the-policy-injection-application-block.aspx)

# sql-server - TSQL 从动态 SQL 写入临时表

> ID：688161
> 
> 赞同：7
> 
> 时间：2009-03-27T01:16:33.607
> 
> 标签：sql-server, tsql, session, temp-tables

考虑以下代码：

```
SET @SQL1 = 'SELECT * INTO #temp WHERE ...'
exec(@SQL1)
SELECT * from #temp  (this line throws an error that #temp doesn't exist) 
```

显然这是因为 exec 命令分离了一个单独的会话，而 #temp 是该会话的本地。我可以使用全局临时表##temp，但是我必须想出一个命名方案以避免冲突。大家有什么推荐的？

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2009-03-27T01:19:16.220

您是否尝试显式创建模板表？

```
Create Table #temp (..) 
```

* * *

## 回答 #2

> 赞同：6
> 
> 时间：2009-09-17T19:19:33.600

试试##temp 因为你的动态查询是在另一个纤程上执行的，所以你看不到它的本地临时表。相反，如果您将临时表声明为 global，则它是有意义的。

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2009-03-27T01:20:59.663

您可以在 exec 之前创建 temp 并使用 exec 填充临时表。

* * *

## 回答 #4

> 赞同：2
> 
> 时间：2009-03-31T18:04:57.440

没有找到一个可行的解决方案来完成我需要的一切，所以我改用##global 临时表。

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2010-04-05T15:46:05.810

举个例子，看“成”

```
SELECT o.OrderID, o.OrderDate, od.UnitPrice, od.Quantity,
       c.CustomerID, c.CompanyName, c.Address, c.City, c.Region,
       c.PostalCode, c.Country, c.Phone, p.ProductID,
       p.ProductName, p.UnitsInStock, p.UnitsOnOrder
INTO   #temp
FROM   Orders o
JOIN   [Order Details] od ON o.OrderID = od.OrderID
JOIN   Customers c ON o.CustomerID = c.CustomerID
JOIN   Products p ON p.ProductID = od.ProductID 
```

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2009-03-27T01:59:48.183

你能不能把你的选择放在插入后用 ; 分隔符并同时运行这两个语句？

* * *

## 回答 #7

> 赞同：0
> 
> 时间：2010-06-08T07:56:55.300

另一种方法是使用动态 SQL 中的所有代码

```
SET @SQL1 = 'SELECT * INTO #temp WHERE ...
SELECT * from #temp  ' 
exec(@SQL1) 
```

* * *

## 回答 #8

> 赞同：0
> 
> 时间：2015-07-29T10:57:56.513

有一种方法可以创建具有单个标识列的*虚拟*临时表，然后通过动态 SQL 使用所需的模式更改该表并填充它。这样你就可以在动态和*常规*SQL 中使用临时表，加入它......

```
-- Create dummy table
CREATE TABLE #tmpContactData (PK int NOT NULL IDENTITY(1,1))

-- Alter its schema
DECLARE @sqlCommand nvarchar(max)
SELECT @sqlCommand = '
ALTER TABLE #tmpContactData
ADD 
    EmployeeId int,
    Address varchar(100),
    Phone varchar(50)
'
EXECUTE(@sqlCommand)

-- Fill it
SELECT @sqlCommand = '
INSERT INTO #tmpContactData
SELECT t.EmployeeId, t.Address, t.Phone 
FROM (  SELECT EmployeeId=1000, Address=''Address 1000'', Phone=''Phone 1000'' 
        UNION 
        SELECT 1001, ''Address 1001'', ''Phone 1001'' 
        UNION 
        SELECT 1002, ''Address 1002'', ''Phone 1002''
) t
'
EXECUTE(@sqlCommand)

--select from it
SELECT * FROM #tmpContactData

--CleanUp
DROP TABLE #tmpContactData 
```

# msbuild - MSbuild 任务失败，因为“任何 CPU”解决方案是乱序构建的

> ID：688162
> 
> 赞同：3
> 
> 时间：2009-03-27T01:16:45.073
> 
> 标签：msbuild, tfsbuild

我在 Teambuild 中构建了两种解决方案，一种是应用程序本身，另一种是 WiX 安装程序。我想使用“Any CPU”构建配置和安装程序使用“x86”构建应用程序。我在我的项目文件中首先列出了“Any CPU”解决方案，但 Teambuild 始终首先构建“x86”解决方案。

我正在设置 BuildSolutionsInParallel = false，但它仍然以列出的相反顺序构建解决方案。如果我将第一个解决方案更改为“混合平台”，它可以正常工作。如何按照项目文件中列出的顺序构建解决方案？

```
<Project ...>
<PropertyGroup>
  <!-- We want to build the install solution after the build solution -->
  <BuildSolutionsInParallel>false</BuildSolutionsInParallel>
</PropertyGroup>

<ItemGroup>
  <SolutionToBuild Include="$(BuildProjectFolderPath)/Pricer/Pricer.sln">
    <Targets></Targets>
    <Properties></Properties>
  </SolutionToBuild>
  <SolutionToBuild Include="$(BuildProjectFolderPath)/Pricer/Pricer.Install/Pricer.Install.sln">
    <Targets></Targets>
    <Properties></Properties>
  </SolutionToBuild>
</ItemGroup>

  <ItemGroup>
    <ConfigurationToBuild Include="Release|Any CPU">
      <FlavorToBuild>Release</FlavorToBuild>
      <PlatformToBuild>Any CPU</PlatformToBuild>
    </ConfigurationToBuild>
    <ConfigurationToBuild Include="Release|x86">
      <FlavorToBuild>Release</FlavorToBuild>
      <PlatformToBuild>x86</PlatformToBuild>
    </ConfigurationToBuild>
  </ItemGroup>
</Project> 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-07-23T12:09:40.833

这里的问题是，按照惯例，任何 CPU 的处理方式与其他配置略有不同 - 例如，它被排除在输出目录层次结构之外。然后，在 Team Build 目标文件中，有一个名为 ComputeConfigurationList 的目标：

```
<ItemGroup>
  <!-- ConfigurationList for any Platform but Any CPU -->
  <ConfigurationList Condition=" '%(ConfigurationToBuild.PlatformToBuild)' != 'Any CPU' " Include="$(MSBuildProjectFile)">
    <Properties>Configuration=%(ConfigurationToBuild.FlavorToBuild);Platform=%(ConfigurationToBuild.PlatformToBuild);TeamBuildOutDir=$(BinariesRoot)\%(ConfigurationToBuild.PlatformToBuild)\%(ConfigurationToBuild.FlavorToBuild)\;TeamBuildPublishDir=$(BinariesRoot)\%(ConfigurationToBuild.PlatformToBuild)\%(ConfigurationToBuild.FlavorToBuild)\</Properties>
  </ConfigurationList>
  <!-- ConfigurationList for Any CPU Platform -->
  <ConfigurationList Condition=" '%(ConfigurationToBuild.PlatformToBuild)' == 'Any CPU' " Include="$(MSBuildProjectFile)">
    <Properties>Configuration=%(ConfigurationToBuild.FlavorToBuild);Platform=%(ConfigurationToBuild.PlatformToBuild);TeamBuildOutDir=$(BinariesRoot)\%(ConfigurationToBuild.FlavorToBuild)\;TeamBuildPublishDir=$(BinariesRoot)\%(ConfigurationToBuild.FlavorToBuild)\</Properties>
  </ConfigurationList>
</ItemGroup> 
```

此目标分两批处理传入的 ConfigurationToBuild 项目组 - 任何 CPU 和其他所有内容。因此，生成的 ConfigurationList 项组的排序方式与原始 ConfigurationToBuild 项组不同，所有 Any CPU 配置都排在所有*非*Any CPU 配置之后。

如果您的配置顺序很重要，解决方法是为您的所有解决方案定义一个新的解决方案配置 - 有关此说明，请参阅上面引用的博客文章。例如，您可以定义一个名为 TFS 的配置，该配置基于 Any CPU 用于您的 Any CPU 解决方案，基于 Win32 用于这些解决方案等。然后在您的 TfsBuild.proj 文件中，您将只在您的 ConfigurationToBuild 项目组中包含这个配置。当 TFS Build 尝试为 Any CPU 构建 Win32 配置时，这将产生摆脱各种“无效配置”警告的良好副作用，反之亦然。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2009-05-11T07:07:55.960

可以为属于同一解决方案的项目设置项目构建顺序。在这种情况下，由于不相关的原因，项目需要属于 2 个不同的解决方案。

[我在这里发现](http://blogs.msdn.com/aaronhallberg/archive/2007/06/25/solution-configurations.aspx)“混合平台”解决方案中的 C# 项目将构建为“任何 CPU”，因此解决方案是始终在 Teambuild 项目文件中使用“混合平台”。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2010-04-16T22:18:14.897

我刚刚发布了一个类似的问题，因为它似乎是同一个问题，但与 AnyCPU 没有任何关系。这曾经解决过吗？

[为什么 Tfs2010 会先构建我的 Wix 项目？](https://stackoverflow.com/questions/2656389/why-does-tfs2010-build-my-wix-project-before-anything-else)

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2009-05-07T04:47:16.113

好的，我不确定它是否与 Teambuild 相同，但是如何通过“Project -> Project Build Order”设置项目的构建顺序呢？

# php - 用于替换和添加属性到 HTML 标记的正则表达式

> ID：688164
> 
> 赞同：1
> 
> 时间：2009-03-27T01:17:38.783
> 
> 标签：php, regex, actionscript-3

给定以下代码：

```
<body>
  <img src="source.jpg" />
  <p>
    <img src="source.jpg" id ="hello" alt="nothing" />
    <img src="source.jpg" id ="world"/>
  </p>
</body> 
```

最好的方法是什么 - 使用正则表达式（或更好？） - 替换它，使它变成这样：

```
<body>
  <img src="source.jpg" id="img_0" />
  <p>
    <img src="source.jpg" id ="img_1"  alt="nothing" />
    <img src="source.jpg" id ="img_2"/>
  </p>
</body> 
```

换句话说 ：

*   所有`<image />`标签都由一个`id`属性填充。

*   该`id`属性应该包含一个递增的属性（这不是真正的问题，尽管它只是替换过程的一部分）

我想需要两次通过，一次删除所有现有`id`属性，另一次填充新属性？

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2009-03-28T05:16:36.610

```
<?php
$data = <<<DATA
<body>
  <img src="source.jpg" />
  <p>
    <img src="source.jpg" id ="hello" alt="nothing" />
    <img src="source.jpg" id ="world"/>
  </p>
</body>
DATA;

$doc = new DOMDocument('1.0', 'UTF-8');
$doc->strictErrorChecking = true;
$doc->standalone = true;
$doc->xmlStandalone = true;
$doc->formatOutput = true;
$doc->loadXML($data, LIBXML_NOWARNING | LIBXML_NOERROR);

$sNode = $doc->getElementsByTagName("img");

$id = 0;
foreach($sNode as $searchNode)
{
  $searchNode->setAttribute('id', "img_$id");
  $doc->importNode($searchNode);
  $id++;
}

$result = $doc->saveHTML();
echo $result; 
```

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2009-03-27T12:17:31.147

我认为最好的方法是使用[`preg_replace_callback`](http://uk.php.net/manual/en/function.preg-replace-callback.php).

`regexp`此外，我会建议比目前建议的更严格一些 - 如果您的页面包含*不*包含属性的`<img />`标签怎么办？*`id`*

 *```
$page = '
<body>
  <img src="source.jpg" />
  <p>
    <img src="source.jpg" id ="hello" alt="nothing" />
    <img src="source.jpg" id ="world"/>
  </p>
</body>';

function my_callback($matches)
{
    static $i = 0;
    return $matches[1]."img_".$i++;
}

print preg_replace_callback('/(<img[^>]*id\s*=\s*")([^"]*)/', "my_callback", $page); 
```

这为我产生了以下内容：

```
<body>
  <img src="source.jpg" />
  <p>
    <img src="source.jpg" id ="img_0" alt="nothing" />
    <img src="source.jpg" id ="img_1"/>
  </p>
</body> 
```

有`regexp`两个捕获组，第一个我们保留，第二个我们替换。我使用了很多否定字符类（例如`[^>]*`= 直到关闭`>`）来确保`<img />`标签*不需要*具有`id`属性。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2009-03-27T01:25:57.250

通过适当的转义（如果没有反复试验，我永远不会记得），以及增加 img_number 的东西，你想要替换这样的东西：

(<img .*?)(?:id=".*")?(.*?/>)

像这样的东西：

\1 id="img_$i"\2

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2021-11-23T10:49:21.107

尝试以下函数一次，如果未找到属性，则将其添加到 html 标签中

```
<?php 

/**
     * add Attribute in HTML Tag...
     * 
     * for Ex:- $htmlStr = <a href="http://saveprice.in">http://saveprice.in/</a> , $tagName = a, $attributeName = target, $attributevalue = _blank 
     * output will :- <a href="http://saveprice.in" target="_blank">saveprice.in</a>
     * 
     * then above $htmlStr = #above output, $tagName = a, $attributeName = style, $attributevalue = color:red;
     * output will :- <a href="http://saveprice.in" target="_blank" style="color:red;">saveprice.in</a>
     *
     * @param string $htmlStr // html string
     * @param string $tagname // html tag name
     * @param string $attributeName // html tag attribute name like class, id, style etc...
     * @param string $attributeValue // value of attribute like, classname, idname, style-property etc...
     * 
     * @return array 
     */
    function addHtmlAttribute_in_HTML_Tag(string $htmlStr, string $tagname, string $attributeName, string $attributeValue)
    {
        if(!preg_match("~<$tagname\s.*?$attributeName=([\'\"])~i", $htmlStr)){
            // if html tag attribute does not exist then add it ...
            $htmlStr = preg_replace('/(<a\b[^><]*)>/i', '$1 '.$attributeName.'="'.$attributeValue.'">', $htmlStr);
        }
        return $htmlStr;
    }

$html = '<a href="https://stackoverflow.com/">https://stackoverflow.com/</a>'
addHtmlAttribute_in_HTML_Tag($html, 'a', 'style', 'color:red;')

//then output will be like <a href="https://stackoverflow.com/" style="color:red;">https://stackoverflow.com/</a>
?> 
```

# cross-platform - 跨平台网络摄像头访问

> ID：688165
> 
> 赞同：9
> 
> 时间：2009-03-27T01:17:55.257
> 
> 标签：cross-platform, directshow, quicktime, video-capture, video4linux

我正在寻找一个跨平台的视频捕获库，用于网络摄像头访问。一种在 Linux 上封装 V4L/V4L2、在 Windows 上封装 DirectShow 和在 Mac 上封装 QuickTime。

首选 C 或 C++，但如果 Java 或 Python 有更好的库选项，我可以使用它们。

* * *

## 回答 #1

> 赞同：9
> 
> 时间：2009-03-27T14:44:13.960

The [OpenCV](http://opencv.willowgarage.com/wiki/Welcome) (Open Source Computer Vision) works under Linux, Windows and Mac OS X.

I use OpenCV under Mac OS X and it works very well with the built-in iSight of my MacBook, and I believe it works equally well under the other platforms.

Of course, OpenCV is not primarily intended as video capture library, but it can be used as such. And if you want to process the frames you grab from your webcam OpenCV will definitely help you with that...

* * *

## 回答 #2

> 赞同：6
> 
> 时间：2009-12-01T12:11:10.010

[Openframeworks](http://www.openframeworks.cc/)有一个视频抓取组件，它是跨平台的，也许您可​​以只使用该框架：）

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2009-12-11T22:36:21.280

另外两个让您可以从 Java 访问网络摄像头的项目：

1.  [LTI-民用](http://lti-civil.org/)
2.  [许格勒](http://www.xuggle.com/xuggler)

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2009-03-27T01:27:58.633

**JMF** (Java Media Framework) has libraries in Linux/Windows too, and has some support for webcam capture.

**Formats**

[http://java.sun.com/javase/technologies/desktop/media/jmf/2.1.1/formats.html](http://java.sun.com/javase/technologies/desktop/media/jmf/2.1.1/formats.html)

# asp.net-mvc - ASP.NET MVC 视图 - FCKEditor 的问题

> ID：688176
> 
> 赞同：0
> 
> 时间：2009-03-27T01:21:00.193
> 
> 标签：asp.net-mvc

我在 ASP.NET MVC 中遇到了 FCKEditor 的另一个问题。请查看下面的代码

```
<script type="text/javascript">
            var sBasePath = 'http://localhost:2170/Content/fckeditor/'; 
            var oFCKeditor = new FCKeditor('FCKeditor1');
            oFCKeditor.BasePath = sBasePath;
            oFCKeditor.Height = 300;
            oFCKeditor.Create();
            var timer;

            function ShowContent() {
                var oEditor = FCKeditorAPI.GetInstance('FCKeditor1');
                if (oEditor != undefined) {
                    var ContentText = '<%= Model.Article.ContentText %>';

                    oEditor.SetHTML(ContentText)
                    clearTimeout(timer);
                }
                else {
                    timer = setTimeout("ShowContent()", 1000);
                }
            }
            timer = setTimeout("ShowContent()", 1000);

        </script> 
```

如您所见，第一个问题是我必须对 BasePath 值进行硬编码，如果我将 BasePath 设置为像 Content/fckeditor 这样的相对路径，那么它将在[http://localhost:2170/Article/Content/中查找 FCKEditor fckeditor](http://localhost:2170/Article/Content/fckeditor)这将导致 404 错误。虽然，绝对路径仍然可以正常工作，但我必须在部署到生产服务器时更改这些路径。

第二个问题是绑定值到fckeditor，因为fckeditor只有在页面完全加载后才可用，我在创建fckeditor时不能直接使用SetHTML方法，因为此时oEditor对象是未定义的。相反，我必须使用 setTimeout 函数重复检查 oEditor 对象，直到它可用，然后将内容绑定到它。

不知道有没有其他方法可以解决上面的两个问题？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2009-03-27T01:24:48.733

对于第一个问题，使用这个：

```
<%= ResolveUrl("~/Content/fckeditor") %> 
```

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2009-03-27T14:44:24.443

首先，我会在页面完成加载后完成所有这些工作（通过使用[窗口 onload](http://blog.roberthahn.ca/articles/2007/02/02/how-to-use-window-onload-the-right-way)事件）。这将确保所有控件都已创建并可使用，其次使用 Url.Content 方法设置基本路径：

```
var sBasePath = '<%= Url.Content ("~/Content/fckeditor/") %>'; 
```

这样，应用程序在哪里运行（[http://localhost:PORT](http://localhost:PORT)或[http://dev.someplace.com](http://dev.someplace.com)等）都无关紧要。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-03-27T14:24:37.067

FCK 不使用您应用它的 textarea 的值来设置内容吗？您不需要从 JavaScript 填充它，只需在 Html.TextArea 调用中设置模型中的值。

# c# - 如何在 .NET 程序集中包含源代码位置信息（文件/行/列）？

> ID：688179
> 
> 赞同：1
> 
> 时间：2009-03-27T01:23:42.590
> 
> 标签：c#, .net, reflection, assemblies, pdb-files

我需要能够从 .NET 程序集获取源文件中的类/结构/接口定义位置（文件名、begin_line、begin_column、end_line、end_column）。

我想到的第一个解决方案是使用一些 pdb quering api，但似乎我只能通过这种方式获取方法定义的此类信息。或者，也许我错了……

为了提供上下文，我正在尝试为 VS 2008 构建一个插件，它通过 VS 自动化模型编译所有解决方案项目，获取程序集并使用反射进行一些可视化建模表示。我需要的是源代码和模型元素之间的连接。事实上，我什至可以以某种方式分析/修改来源，让他们记住位置信息。

任何想法，将不胜感激。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2009-03-27T01:35:09.973

I'm assuming that the existing Class Diagram does not help you, and that you cannot use a tool that already knows how to reverse-engineer C#? [Sparx Enterprise Architect](http://www.sparxsystems.com/) comes to mind because it can not only do the reverse engineering - it can also run user-defined transformations of the resulting models. You should be able to generate anything you want out of that, both in terms of model and in terms of artifacts.

You'll also want to consider that a class may be partial - the same class may exist in several pieces.

# javascript - sIFR 3：定焦：是吗？

> ID：688181
> 
> 赞同：0
> 
> 时间：2009-03-27T01:24:11.530
> 
> 标签：javascript, css, firefox, sifr

我正在寻找一种方法来删除 Firefox 适用于我的页面的大纲焦点： [http ://www.bevelite.com.au/test](http://www.bevelite.com.au/test)

我读过应用以下内容将解决此问题，但似乎无法将其应用于我的代码：

```
sIFR.replace(movie, {fixFocus: true}); 
```

我的代码：

```
sIFR.replace(univers47cl, {
selector: 'h1.test',
wmode: 'transparent',
css: [
    '.sIFR-root { font-size: 20px; font-weight: 100; color: #000000; text-transform: uppercase; line-height: 20px; margin: 0 0 15px 0; padding: 0; }',
    'a { text-decoration: none; }',
    'a:link { color: #000000; text-decoration: none; }',
    'a:hover { color: #000000; text-decoration: underline; }',
]
});

sIFR.replace(univers47cl, {
selector: 'h1',
wmode: 'transparent',
css: [
    '.sIFR-root { font-size: 20px; font-weight: 100; color: #00b9f2; text-transform: uppercase; line-height: 20px; margin: 0 0 15px 0; padding: 0; }',
    'a { text-decoration: none; }',
    'a:link { color: #00b9f2; text-decoration: none; }',
    'a:hover { color: #00b9f2; text-decoration: underline; }',
]
}); 
```

任何人都可以看到我可以将其应用于我的代码吗？

（此处的 sIRF 文档 > [http://wiki.novemberborn.net/sifr3/](http://wiki.novemberborn.net/sifr3/)）

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2009-03-27T05:27:43.580

如果您指的是活动链接上的虚线轮廓，可以像这样删除它：

```
a {
   outline:0;
} 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-03-27T06:41:43.903

Mathew Taylor 上面的答案可能更准确，但您的问题是将该代码段放入何处。另外，请注意在您的代码段中，您的数组“css：[]”中有一个额外的尾随逗号，您应该注意这些，因为它们会让你进入 IE

```
sIFR.replace(univers47cl, {
    selector: 'h1.test',
    wmode: 'transparent',
    fixFocus: true,
    css: [
            '.sIFR-root { font-size: 20px; font-weight: 100; color: #000000; text-transform: uppercase; line-height: 20px; margin: 0 0 15px 0; padding: 0; }',
            'a { text-decoration: none; }',
            'a:link { color: #000000; text-decoration: none; }',
            'a:hover { color: #000000; text-decoration: underline; }'
    ]
    });

sIFR.replace(univers47cl, {
    selector: 'h1',
    wmode: 'transparent',
    fixFocus: true,
    css: [
            '.sIFR-root { font-size: 20px; font-weight: 100; color: #00b9f2; text-transform: uppercase; line-height: 20px; margin: 0 0 15px 0; padding: 0; }',
            'a { text-decoration: none; }',
            'a:link { color: #00b9f2; text-decoration: none; }',
            'a:hover { color: #00b9f2; text-decoration: underline; }'
    ]
    }); 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-03-27T20:56:40.633

该`fixFocus`选项与实际关注 Flash 电影有关。我相信您应该添加`object { outline: 0; }`以摆脱 Firefox 出于某种原因开始显示的焦点边框。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2009-07-01T22:33:20.740

在 Firefox 3.5 中唯一对我有用的东西：

`.sIFR-flash:focus{outline: none;}`

其他浏览器（我测试了最新的 Opera、Chromium、IE）似乎没有这个问题。它与链接元素无关，但与 Flash 对象有关。

# vb6 - VB6 - ByRef 参数类型不匹配错误 - 它在哪里？

> ID：688184
> 
> 赞同：15
> 
> 时间：2009-03-27T01:25:33.757
> 
> 标签：vb6

在我使用 VB6 的 10 多年里，我时不时地收到一个“ByRef 参数类型不匹配”错误，我根本找不到不匹配的地方。在挣扎了一段时间后，我总是以一种或另一种方式强制输入，但这次我想我会问。我包括了所有我认为可能与此有关的代码；但是您现在可以跳过它并在我演示问题后参考它：

```
公共类型 PBufferType
  Location(9) As Integer ' 代码位置
  ValueHi(9) As Integer ' Vhi 代码
  ValueLo(9) As Integer ' Vlo 代码
  Locked(9) As Integer ' 配对状态
  Gamma(9) As Single ' 本段与下一段之间的 Gamma
结束类型

Public GammaBuffer(1) As PBufferType ' 主要数据类型

Public SelectedBank 为整数

函数 MeasureLuxAtCode(code As Integer) As Single
  调用 TestPatternForm.DrawTestWindow(3, 代码)
  MeasureLuxAtCode = MeasureLux(1)
结束功能

```

问题出现在下面。“LuxMinTarget = MeasureLuxAtCode(FirstLevel)”行生成“ByRef 参数类型不匹配”错误，表明 FirstLevel 不是整数。

```
子确定理想LuxCurve()
  Dim FirstLevel, FirstDACtoMeasure 为整数
  FirstDACtoMeasure = 0
  FirstLevel = GammaBuffer(SelectedBank).Location(FirstDACtoMeasure)
  LuxMinTarget = MeasureLuxAtCode(FirstLevel)
结束子

```

但是该死，FirstLevel*是*一个整数，不是吗？它是一个 int，它的值是由一个返回 int 的 UDT 设置的，所以我哪里出错了？如果我将它强制为这样的 int：

```
  LuxMinTarget = MeasureLuxAtCode(Int(FirstLevel))

```

编译器/解释器很高兴。但我不是。

那么这是编译器中的错误还是只是我很密集？

* * *

## 回答 #1

> 赞同：40
> 
> 时间：2009-03-27T01:49:06.617

问题在这里：

```
Dim FirstLevel, FirstDACtoMeasure As Integer 
```

这实际上声明`FirstLevel`为 a`Variant`而不是`Integer`您可能期望的那样。

这是一个经典的 VB6 陷阱！（而且你不是第一个被它咬伤的人）。

每行声明一个变量可以避免这个问题：

```
Dim FirstLevel As Integer
Dim FirstDACtoMeasure As Integer 
```

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2009-04-27T15:05:21.250

John T，您实际上可以在列表中显式声明变量。

将 FirstLevel 调暗为整数，FirstDACtoMeasure 调为整数

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2009-04-01T10:43:24.313

正如 Mitch 所指出的，VB6 仅将逗号分隔列表中的最后一个变量声明为明确定义的类型。先前的条目已声明，但作为变体。

要正确声明变量，您需要单独处理它们。

```
Dim FirstLevel As Integer
Dim FirstDACtoMeasure As Integer 
```

在以前版本的 VB、IIRC 中也是如此，对于 VB6 来说并不新鲜。

# c# - Chaining VisualStates In Silverlight

> ID：688187
> 
> 赞同：2
> 
> 时间：2009-03-27T01:26:55.827
> 
> 标签：c#, wpf, silverlight, expression-blend

I have three VisualStates that each have animation in them and I would like to chain them together. I want one state to begin after the last one has completed. How do I do this in Silverlight without a lot of smelly code?

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-03-27T06:38:19.823

您是否尝试过将动画放在一个故事板中？视觉状态不是为了做你想做的事情而设计的（在一个动画完成后开始一个动画），但故事板是。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-04-08T08:01:26.693

您可以尝试使用事件“已完成”来检测动画何时结束并开始另一个动画。

# javascript - 如何使用链接调用 JavaScript？

> ID：688196
> 
> 赞同：192
> 
> 时间：2009-03-27T01:33:34.923
> 
> 标签：javascript

如何使用链接调用 JavaScript 代码？

* * *

## 回答 #1

> 赞同：217
> 
> 时间：2009-03-27T01:50:52.917

不显眼的 JavaScript，没有库依赖：

```
<html>
<head>
    <script type="text/javascript">

        // Wait for the page to load first
        window.onload = function() {

          //Get a reference to the link on the page
          // with an id of "mylink"
          var a = document.getElementById("mylink");

          //Set code to run when the link is clicked
          // by assigning a function to "onclick"
          a.onclick = function() {

            // Your code here...

            //If you don't want the link to actually 
            // redirect the browser to another page,
            // "google.com" in our example here, then
            // return false at the end of this block.
            // Note that this also prevents event bubbling,
            // which is probably what we want here, but won't 
            // always be the case.
            return false;
          }
        }
    </script>
</head>
<body>
    <a id="mylink" href="http://www.google.com">linky</a>        
</body>
</html> 
```

* * *

## 回答 #2

> 赞同：212
> 
> 时间：2009-03-27T01:38:34.740

```
<a onclick="jsfunction()" href="#"> 
```

或者

```
<a onclick="jsfunction()" href="javascript:void(0);"> 
```

编辑：

上面的回复真的不是一个很好的解决方案，自从我最初发布以来已经了解了很多关于JS的知识。有关解决此问题的更好方法，请参阅下面的[EndangeredMassa 答案。](https://stackoverflow.com/a/688228/2227526)

* * *

## 回答 #3

> 赞同：50
> 
> 时间：2009-03-27T01:35:36.727

```
<a href="javascript:alert('Hello!');">Clicky</a> 
```

**编辑，多年后：**不！永远不要这样做！我当时年少无知！

**再次编辑：**有几个人问你*为什么*不应该这样做。有几个原因：

1.  **演示文稿：** HTML 应该专注于演示文稿。将 JS 放入 HREF 意味着您的 HTML 现在有点处理业务逻辑。

2.  **安全性：** HTML 中的 Javascript 违反了[内容安全策略 (CSP)](https://developer.mozilla.org/en-US/docs/Web/HTTP/CSP)。内容安全策略 (CSP) 是一个附加的安全层，有助于检测和缓解某些类型的攻击，包括跨站点脚本 (XSS) 和数据注入攻击。这些攻击用于从数据盗窃到站点破坏或恶意软件分发的所有事情。[在这里阅读更多](https://ourcodeworld.com/articles/read/209/should-i-use-hash-or-javascript-void-0-on-the-href-attribute-of-my-empty-links)。

3.  **可访问性：**锚标签用于链接到其他文档/页面/资源。[如果您的链接不去任何地方，它应该是一个按钮](https://christianheilmann.com/2019/02/05/links-that-dont-go-anywhere-should-be-buttons/)。这使得屏幕阅读器、盲文终端等更容易确定正在发生的事情，并为视障用户提供有用的信息。

* * *

## 回答 #4

> 赞同：43
> 
> 时间：2009-03-27T01:54:02.033

而且，为什么不使用 jQuery 不显眼：

```
 $(function() {
    $("#unobtrusive").click(function(e) {
      e.preventDefault(); // if desired...
      // other methods to call...
    });
  }); 
```

HTML

```
<a id="unobtrusive" href="http://jquery.com">jquery</a> 
```

* * *

## 回答 #5

> 赞同：13
> 
> 时间：2009-03-28T15:27:43.053

Unobtrusive Javascript 有很多优点，这里是它所采取的步骤以及为什么它很好用。

1.  链接正常加载：

    <a id="DaLink" href="http://host/toAnewPage.html">点击这里</a>

这很重要，因为它适用于未启用 javascript 的浏览器，或者如果 javascript 代码中有错误不起作用。

2.  javascript 在页面加载时运行：

    ```
     window.onload = function(){
            document.getElementById("DaLink").onclick = function(){
                   if(funcitonToCall()){
                       // most important step in this whole process
                       return false;
                   }
            }
     } 
    ```

3.  如果 javascript 运行成功，可能是用 javascript 加载当前页面中的内容，返回 false 取消链接触发。换句话说，如果 javascript 成功运行，则将 return false 设置为禁用链接。如果 javascript 不支持，则允许它运行，同时进行良好的备份，以便您的内容以任何一种方式显示，用于搜索引擎，如果您的代码中断，或者在非 javascript 系统上查看。

关于该主题的最佳书籍是 Jeremy Keith 的“Dom Scription”

* * *

## 回答 #6

> 赞同：9
> 
> 时间：2009-03-27T01:36:31.437

我认为您可以使用该`onclick`事件，如下所示：

```
<a onclick="jsFunction();"> 
```

* * *

## 回答 #7

> 赞同：9
> 
> 时间：2009-03-27T01:43:58.517

或者，如果你使用[PrototypeJS](http://www.prototypejs.com)

```
<script type="text/javascript>
  Event.observe( $('thelink'), 'click', function(event) {
      //do stuff

      Event.stop(event);
  }
</script>

<a href="#" id="thelink">This is the link</a> 
```

* * *

## 回答 #8

> 赞同：0
> 
> 时间：2020-05-25T05:38:46.427

基于 @mister_lucky 答案与 jquery 一起使用：

```
$('#unobtrusive').on('click',function (e) {
    e.preventDefault(); //optional
    //some code
}); 
```

html代码：

```
<a id="unobtrusive" href="http://jquery.com">jquery</a> 
```

* * *

## 回答 #9

> 赞同：0
> 
> 时间：2021-03-09T21:31:52.193

您可以使用按钮并将其设置为链接样式： HTML 代码：

```
button {
width:0.0000000001px;
height:0.00000000001px;
  background-color: #ffffff;
  color: Blue;
  padding: 14px 20px;
  margin: 8px 0;
  border: none;
  cursor: pointer;
}
```

```
<button  onclick="function()"><u>Example button</u></button>
```

* * *

## 回答 #10

> 赞同：-4
> 
> 时间：2018-05-30T21:29:15.177

只需使用 javascript:---- 示例

```
javascript:var JFL_81371678974472 = new JotformFeedback({ formId: '81371678974472', base: 'https://form.jotform.me/', windowTitle: 'Photobook Series', background: '#e44c2a', fontColor: '#FFFFFF', type: 'false', height: 700, width: 500, openOnLoad: true }) 
```

# php - Generating reports from MySQL tables

> ID：688198
> 
> 赞同：3
> 
> 时间：2009-03-27T01:34:06.480
> 
> 标签：php, mysql, database-design, reporting

Let's say you have a bunch of MySQL tables, and you want your end users to be able to generate reports with that data with a PHP script. You can present the field names from those tables in a dropdown, so a user might be able to say, "`first_name` equals John." Great. But what if you want those field names to be a little more readable? For instance, I'd like the user to be able select "Name of First Pet" as a field, instead of "`first_pet_name`." I definitely don't want to store that information in the markup, as we might be adding and removing tables pretty frequently. What's the simplest way to pull this off?

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-03-27T01:42:37.227

I'd do something simple like replacing underscores with spaces, and upper casing the first letter.

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-03-27T01:43:08.690

You can create a table, to bind text informations to table+column pairs. Let's say you have a table *users*, and you want to show column name 'Name Of First Pet' instead of *first_name*.

Let's say (table name *ColumnTextInformations*):

```
ParentTable | ParentColumn | Text
      users |   first_name | Name of First Pet
... 
```

So you have unique identifiers for your column labels.

Using it it's very easy:

```
SELECT Text 
FROM ColumnTextInformations
WHERE parentTable = ? AND parentColumn = ? 
```

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2009-03-27T01:46:02.177

I'd store it in the database.

```
CREATE TABLE human_labels (
    schema  varchar(64) not null,
    table   varchar(64) not null,
    column  varchar(64) not null,
    label   tinytext    not null,
    primary key (schema, table, column)
); 
```

Where schema is what you commonly call "database" in mysql (what goes after `USE` when you switch databases); and table and column are pretty obvious.

Of course, you'll have to make sure the DBA updates that whenever changing the schema.

I believe MySQL allows a comment on a table, but not a column, or you could use that.

**Edit**: Changed the varchar to 64 because that's what the MySQL manual documents as the max size. Also, it turns out you can put a comment on each column if you wish — and you can read those back from information_schema.columns. But I'd still do it the way shown above as its more flexible (you can put additional data in there easily, such as your "should I show this field" flag) and also allows comments to be used for their intended purpose.

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2009-03-29T02:47:02.310

听说过列别名吗？

SELECT pet AS `Name of First Pet`, user_name AS `Name of User` FROM users WHERE user = 'Bill';

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2009-03-27T02:16:28.533

最简单的解决方案是使用**分隔标识符**。这允许您拼写包含空格、标点符号和特殊字符、SQL 关键字等的表名和列名。

您必须在 SQL 查询中分隔表名和列名（包括`CREATE TABLE`用于定义它们的语句）。

```
CREATE TABLE `User Facts` (
  `User Name`         VARCHAR(100)
  ...
  `Name of First Pet` VARCHAR(100)
  ...
);

SELECT `Name of First Pet`
FROM `User Facts`
WHERE `User Name` = 'Bill'; 
```

MySQL 默认使用反引号（如上所示）作为分隔标识符。

有关详细信息，请参阅“[不同的数据库是否使用不同的名称引用](https://stackoverflow.com/questions/214309/do-different-databases-use-different-name-quote/214344#214344)”。

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2009-03-27T02:18:39.230

我并不是说这是一个好主意，但从技术上——*技术上*——如果你在整个代码中用反引号包围这些标识符，MySQL 将允许你创建包含空格的表和列。例如：

```
mysql> create table `This is a Table` (`First Name` varchar(50),
    `Name of First Pet` varchar(20));
Query OK, 0 rows affected (0.06 sec)

mysql> insert into `This is a Table` values ('Tom', 'Skippy');
Query OK, 1 row affected (0.01 sec)

mysql> select * from `This is a Table`;
+------------+-------------------+
| First Name | Name of First Pet |
+------------+-------------------+
| Tom        | Skippy            |
+------------+-------------------+
1 row in set (0.00 sec) 
```

# .net - NUnit 约束模型的程序集和命名空间

> ID：688212
> 
> 赞同：1
> 
> 时间：2009-03-27T01:42:34.433
> 
> 标签：.net, nunit

我想在 NUnit中使用新[的基于约束的模型。](http://nunit.com/index.php?p=constraintModel&r=2.4.8)类是在哪个程序集和命名空间中定义的？（具体来说，我正在寻找文档中讨论的“Is”类和 IConstraint 实现）。它们似乎不在 NUnit.Framework 中。

另外，我对 v2.4.8 感兴趣，在撰写本文时它是最新的稳定版本。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2009-03-27T14:05:55.940

IConstraint 实现在 NUnit.Framework.Constraints 中；我通过检查 VS Intellisense 的 Assert.That() 得到了这个。我仍然没有在 NUnit 的任何地方看到这一点。

我仍然不知道Is在哪里。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2009-03-27T15:26:20.210

Is 类位于 nunit.framework.dll 中的 NUnit.Frameworks.SyntaxHandlers 中。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2009-03-27T04:37:41.547

在 NUnit 2.5 Beta 2 上使用 NUnit.Framework 为我工作。从 2.4.8 的代码来看，它看起来像是在同一个类中。

```
namespace NUnit.Framework
{
    // Summary:
    //     The Assert class contains a collection of static methods that implement the
    //     most common assertions used in NUnit.
    public class Assert
    {
        public static void That(bool condition);
        public static void That(ActualValueDelegate del, IResolveConstraint expr);
        public static void That(bool condition, string message);
        public static void That(object actual, IResolveConstraint expression);
        public static void That<T>(ref T actual, IResolveConstraint constraint);
        public static void That(TestDelegate code, IResolveConstraint constraint);
        public static void That(ActualValueDelegate del, IResolveConstraint expr, string message);
        public static void That(bool condition, string message, params object[] args);
        public static void That(object actual, IResolveConstraint expression, string message);
        public static void That<T>(ref T actual, IResolveConstraint constraint, string message);
        public static void That(ActualValueDelegate del, IResolveConstraint expr, string message, params object[] args);
        public static void That(object actual, IResolveConstraint expression, string message, params object[] args);
        public static void That<T>(ref T actual, IResolveConstraint expression, string message, params object[] args);
    }
} 
```

`AssertionHelper`也在同一个命名空间中。

* * *

对于`Is`- 尝试 NUnit.Framework.SyntaxHelpers

# c# - 超时后从集合中删除项目

> ID：688217
> 
> 赞同：2
> 
> 时间：2009-03-27T01:44:56.207
> 
> 标签：c#, multithreading, .net-3.5

我想要的是在超时后`Notification`从 a中删除。`ObservableCollection<Notification>`有没有比为每个添加的项目和`Thread.Sleep`其中启动一个新的 ThreadPool 线程更好的方法？

* * *

**基于*Nidonocu*答案的最终代码：**

```
public class NotificationCollection : ObservableCollection<Notification>
{
    private readonly DispatcherTimer timer;

    public NotificationCollection()
        : this(Application.Current.Dispatcher)
    {
    }

    public NotificationCollection(Dispatcher dispatcher)
    {
        this.timer =
            new DispatcherTimer(DispatcherPriority.DataBind, dispatcher);
        this.timer.Tick += this.TimerOnTick;
    }

    protected override void InsertItem(int index, Notification item)
    {
        base.InsertItem(index, item);
        if (!this.timer.IsEnabled)
        {
            this.StartTimer(item);
        }
    }

    private void StartTimer(Notification item)
    {
        var timeout = item.Timestamp + item.Timeout - DateTime.UtcNow;
        if (timeout < TimeSpan.Zero)
        {
            timeout = TimeSpan.Zero;
        }

        this.timer.Interval = timeout;
        this.timer.Start();
    }

    private void TimerOnTick(object sender, EventArgs e)
    {
        this.timer.Stop();

        this.RemoveAt(0);
        if (this.Count > 0)
        {
            this.StartTimer(this[0]);
        }
    } 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-03-27T03:03:57.203

某种 Timer 不是更合适吗？然后，您可以只拥有一个线程，如果还有更多项目剩余，它将恢复计时器并在一秒钟后再次检查是否有时间删除下一个通知。

* * *

**编辑：** 由于您在 .net 3.5 中，我假设 WPF 使用 DispatcherTimer。据我了解，这将自动使用正确的线程来运行您传递的方法。这是未经测试的代码尝试：

```
using System;
using System.Collections.Generic;
using System.Linq;
using System.Text;
using System.Collections.ObjectModel;
using System.Windows.Threading;
using System.Windows;

namespace WpfApplication1
{
    public class Notification
    {
        public DateTime TimeStamp { get; set; }
    }

    public class NotificationCollection : ObservableCollection<Notification>
    {
        private readonly TimeSpan timeout;

        private DispatcherTimer timer;

        public NotificationCollection(TimeSpan timeout)
            : this(timeout, Application.Current.Dispatcher) { }

        public NotificationCollection(TimeSpan timeout, Dispatcher dispatch)
        {
            this.timeout = timeout;
            timer = new DispatcherTimer(new TimeSpan(0, 0, 1), DispatcherPriority.Normal, this.Cleanup, dispatch);
        }

        protected override void InsertItem(int index, Notification item)
        {
            base.InsertItem(index, item);
            timer.Start();
        }

        private void Cleanup(object o, EventArgs e)
        {
            timer.Stop();
            // Sanity
            if (this.Count == 0)
                return;

            var deadList = from note in this.Items
                           where note.TimeStamp + this.timeout - DateTime.UtcNow < TimeSpan.Zero
                           select note;
            foreach (var note in deadList)
            {
                this.Remove(note);
            }

            if (this.Count > 0)
                timer.Start();
        }
    }
} 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-03-27T03:40:25.180

我不会为每个插入的对象创建一个线程。相反，我将有一个清理线程或使用计时器对象。当线程唤醒时，它可以遍历列表清理旧项目。

我还将覆盖索引运算符和任何其他访问器方法，以不允许应该清理但尚未清理的项目。

# asp.net - ASP.net 中的本地化 - 将货币保持为 $ 而不是 €

> ID：688218
> 
> 赞同：1
> 
> 时间：2009-03-27T01:45:11.917
> 
> 标签：asp.net, localization, currency

我正在这样做，但如果语言是西班牙语，则显示为 475,00 €</p>

客户想要它，所以它实际上是 475.00 美元

可能的？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-03-27T01:48:47.147

您需要创建一个使用“$”作为货币符号的 CultureInfo，然后将其作为第一个参数传递给 String.Format。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-03-27T01:51:11.823

该字符串根据[CurrentUICulture](http://msdn.microsoft.com/en-us/library/system.threading.thread.currentuiculture.aspx)格式化。您可以通过将[CultureInfo](http://msdn.microsoft.com/en-us/library/system.globalization.cultureinfo.aspx)传递给来明确指定文化`Format`，例如美国英语：

```
<%#String.Format(CultureInfo.GetCultureInfo("en-US"), "{0:c}", Eval("Subtotal"))%> 
```

要全局设置文化以便您不必每次都指定它，您可以更改[CurrentUICulture](http://msdn.microsoft.com/en-us/library/system.threading.thread.currentuiculture.aspx)：

```
Thread.CurrentUICulture = CultureInfo.GetCultureInfo("en-US") 
```

# linux - 用于在 linux 中调试 'C 源代码的 IDE

> ID：688220
> 
> 赞同：5
> 
> 时间：2009-03-27T01:47:06.030
> 
> 标签：linux, ide, development-environment

最近我在Linux平台上使用'C进行开发，像gcc这样的工具很快。但我希望拥有像 VC++ IDE 这样的 Windows IDE 会很棒。

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2009-03-27T01:58:05.643

*   [代码::块](http://www.codeblocks.org/)
*   [安茹塔](http://anjuta.sourceforge.net/)
*   [KDevelop](http://www.kdevelop.org/)
*   或[查看](http://www.google.com/search?q=site:stackoverflow.com+c+ide+linux) [StackOverflow](https://stackoverflow.com/questions/24109/c-ide-for-linux) [_](https://stackoverflow.com/questions/579219/best-unix-linux-c-debuger-ide)

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-03-27T01:52:02.117

有 Eclipse CDT ( [http://www.eclipse.org](http://www.eclipse.org) ) 和 NetBeans C++ ( [http://www.netbeans.org](http://www.netbeans.org) )，这两个很棒的 IDE 都具有与 Visual Studio 几乎相同的特性。如果您开始为 Linux 和 Windows 开发，您可能想深入了解 CMake ( [http://www.cmake.org](http://www.cmake.org) )，它将自动为所有 C/C++ IDE 生成所有项目文件。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2009-03-27T01:58:05.270

维基百科上有一个很好的选项调查：

[http://en.wikipedia.org/wiki/Comparison_of_integrated_development_environments](http://en.wikipedia.org/wiki/Comparison_of_integrated_development_environments)

如果使用 Qt 进行开发，我发现新的 Qt Creator IDE 相当不错。

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2009-03-27T02:31:53.737

[Netbeans](http://www.netbeans.org/downloads/index.html)会这样做。

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2009-03-27T03:04:20.197

除了其他帖子已经提到的所有选项之外，我将添加[DDD](http://www.gnu.org/software/ddd/)。这是一个很好的 GDB 前端。

我不得不说我用过 Eclipse CDT、Netbeans 和 DDD。在我看来，它们都不能与您使用 Visual Studio 获得的效果相提并论。用于 C/C++ 开发的 Eclipse 和 Netbeans 速度慢且有问题。DDD 还可以，但缺少许多您通过 Microsoft 工具获得的功能。

* * *

## 回答 #6

> 赞同：1
> 
> 时间：2009-03-27T07:33:14.043

Monodevelop 可以做 C/C++ 项目，他们最新的发行说明表明他们有一个[原生代码调试器](http://monodevelop.com/Release_notes_for_MonoDevelop_2.0_Beta_2)。

如果您有兴趣，请观看[Jupiter Broadcasting youtube 频道](http://youtube.com/jupiterbroadcasting)，因为我相信他们将在下周审查 Monodevelop 2.0。

* * *

## 回答 #7

> 赞同：0
> 
> 时间：2009-03-27T03:17:44.393

KDevelop 有 GNU 工具链的钩子，以及 valgrind / cachegrind / 等的钩子。它的重量很轻（响应式），相当直观且易于习惯。

我通常只使用 KATE 并为 valgrind / gdb 之类的东西打开一个内联终端。启用调试选项后，很容易单步执行 valgrind 的输出并在代码中逐行修复问题。

两者都带有 KDE，如果你有 KDE，你的菜单上应该已经有这些了。

**编辑：**

[这是 KDevelop 的屏幕截图](http://echoreply.us/kdevelop.png)（来自我的桌面）。那是一个稍微旧的版本，所以我相信这个界面现在提供了更多。

* * *

## 回答 #8

> 赞同：0
> 
> 时间：2009-03-27T06:53:54.717

正如 Brian Campbell 所指出的，CodeBlocks 和 Anjuta 相当公平

# jquery - 使用jquery在悬停时为表格行添加背景颜色和边框

> ID：688222
> 
> 赞同：13
> 
> 时间：2009-03-27T01:47:48.197
> 
> 标签：jquery, css

有谁知道当鼠标悬停在行上时向具有不同背景颜色的表格行添加边框的方法？

我已经能够通过以下方式更改行的背景颜色：

```
$(document).ready(function() {
   $(function() {
        $('.actionRow').hover(function() {
            $(this).css('background-color', '#FFFF99');
        },
        function() {
            $(this).css('background-color', '#FFFFFF');
        });
    });
}); 
```

但我无法添加边框颜色。我意识到边框不能直接应用于表格行标签，但我希望有人知道一些 jQuery 巫术魔法，可以在所选行中找到表格单元格并将一些样式应用于这些单元格以创建边框。

谢谢！

* * *

## 回答 #1

> 赞同：31
> 
> 时间：2009-03-27T02:12:00.430

```
 $(function() {
        $('tr').hover(function() {
            $(this).css('background-color', '#FFFF99');
            $(this).contents('td').css({'border': '1px solid red', 'border-left': 'none', 'border-right': 'none'});
            $(this).contents('td:first').css('border-left', '1px solid red');
            $(this).contents('td:last').css('border-right', '1px solid red');
        },
        function() {
            $(this).css('background-color', '#FFFFFF');
            $(this).contents('td').css('border', 'none');
        });
    }); 
```

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2009-03-27T01:58:08.093

你最好的选择是在行上添加类和删除类。然后在您的样式表中：

```
.actionRow-hovered td { border-color: whatever; } 
```

因此，您实际上将操纵每个 td 边框颜色。很痛苦，但是当你掌握它的窍门时效果很好。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2011-06-10T09:20:48.213

```
$('table.tblMenuTabls tr').hover(function(){
        $(this).toggleClass('tblOverRow');
        },function(){
            $(this).toggleClass('tblOverRow')}
    ).css({cursor: 'hand'}); 
```

`tblMenuTabls`表类名称在哪里，并且`tblOverRow`是带有悬停定义的 CSS 类。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2009-03-27T01:57:37.643

也许这是一个很好的起点：

[http://www.devcurry.com/2009/02/change-table-border-color-on-hover_27.html](http://www.devcurry.com/2009/02/change-table-border-color-on-hover_27.html)

# iphone - Implementing a Texture atlas, with triangle_strip or triangles. iPhone opengl es

> ID：688225
> 
> 赞同：1
> 
> 时间：2009-03-27T01:48:49.270
> 
> 标签：iphone, opengl-es, textures

Multiple places recommend using a texture atlas for performance. Apple suggest the function gltexcoordpointer. In my example I have a row of squares each one is given a random texture. I put all the random textures into the super-texture. Now the problem is I can't seem to create a texcoordarray. I can't find any information on how gltexcoordpointer assings the selected sub-texture to the vertex coords. The vertexes would ideally be drawn using triangle_strip, but triangles will work as well.

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-11-09T04:49:30.577

`glTexCoordPointer`如果你想渲染纹理，你必须使用压缩或其他方式，我认为。但是，如果您想在其 UV 坐标系内移动您的纹理，您可以随时完全自由地操作纹理坐标数组中的各个条目。我使用这样的功能：

```
- (void) shiftTextureUVY:(float)shift {

  textureVertices[1] += shift;
  textureVertices[3] += shift;
  textureVertices[5] += shift;
  textureVertices[7] += shift;

}
- (void) shiftTextureUVX:(float)shift {

  textureVertices[0] += shift;
  textureVertices[2] += shift;
  textureVertices[4] += shift;
  textureVertices[6] += shift;

} 
```

制作一个基本`TextureAtlas`类，使用`GL_TRIANGLE_STRIP`. 我想你可能会变得非常时髦，并用类似的方法进行反射和扭曲。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-03-28T17:40:04.827

gltexcoorpointer 以 1-1 的方式分配纹理坐标。所以我不得不画成三角形并重复许多顶点。我无法共享顶点的原因是共享顶点具有相同的纹理坐标。

# sql-server - TSQL 定义临时表（或表变量）而不定义模式？

> ID：688233
> 
> 赞同：41
> 
> 时间：2009-03-27T01:53:46.717
> 
> 标签：sql-server, tsql, schema, temp-tables, table-variable

有没有办法在不预先定义它的模式的情况下定义一个临时表？

* * *

## 回答 #1

> 赞同：42
> 
> 时间：2010-01-29T00:08:12.527

实际上，使用表 VARIABLE（内存表）是最佳方式。#table 在临时数据库中创建一个表，并且 ##table 是全局的 - 两者都有磁盘命中。考虑交易数量的放缓/打击。

```
CREATE PROCEDURE [dbo].[GetAccounts] 
    @AccountID BIGINT,
    @Result INT OUT,
    @ErrorMessage VARCHAR(255) OUT
AS
BEGIN
    SET NOCOUNT ON;
    SET @Result = 0
    SET @ErrorMessage = ''

    DECLARE @tmp_Accounts TABLE (
                                                AccountId BIGINT,
AccountName VARCHAR(50),
...
)

INSERT INTO @tmp_Accounts ([AccountId], [AccountName]...
)
SELECT AccountID, AccountName
FROM Accounts
WHERE  ...

    IF @@Rowcount = 0
        BEGIN
            SET @ErrorMessage = 'No accounts found.'
            SET @Result = 0

            RETURN @Result
        END
    ELSE
        BEGIN
            SET @Result = 1

            SELECT *
            FROM @tmp_Accounts
        END 
```

请注意您插入此临时表的方式。

这样做的缺点是编写可能需要更长的时间，因为您必须定义表变量。

我还推荐 RedGate 的 SQL Prompt for Query Analyzer。

* * *

## 回答 #2

> 赞同：29
> 
> 时间：2009-03-27T21:17:19.350

你不需要OPENQUERY。只需将“INTO #AnyTableName”放在选择列表和任何查询的 FROM 之间...

```
SELECT *
    INTO #Temp1
    FROM table1
    WHERE x=y 
```

* * *

## 回答 #3

> 赞同：10
> 
> 时间：2009-03-27T01:59:09.167

是的，您可以使用

```
SELECT INTO ... 
```

比方说

```
SELECT * INTO #t
FROM OPENQUERY( 'server',
'exec database.dbo.proc_name value1, value2, ... ' ) 
```

# math - 正交投影矩阵的公式？

> ID：688240
> 
> 赞同：8
> 
> 时间：2009-03-27T01:56:05.337
> 
> 标签：math, graphics, projection, orthogonal

我一直在环顾四周，似乎找不到我正在寻找的东西。我找到了“规范公式”，但是使用这些公式的最佳方法是什么？我是否必须缩小每个顶点？ 或者，还有更好的方法？

一个公式真的可以帮助我，但我也在寻找关于相对于观察者位置的近和远 z 平面的解释

* * *

## 回答 #1

> 赞同：9
> 
> 时间：2009-05-12T02:05:02.993

这是一个推导[正交项目矩阵](http://www.codeguru.com/cpp/misc/misc/math/article.php/c10123__2/)的合理来源：

> 考虑几点：首先，在眼睛空间中，您的相机位于原点并直接向下看 z 轴。其次，您通常希望您的视野向左延伸和向右延伸一样远，并且在 z 轴上方同样远，如下所示。如果是这种情况，z 轴直接通过视图体积的中心，因此您有 r = –l 和 t = –b。换句话说，您可以完全忘记 r、l、t 和 b，只需根据宽度 w 和高度 h 以及其他剪切平面 f 和 n 来定义视图体积。如果你将这些替换到上面的正交投影矩阵中，你会得到这个相当简化的版本：

以上所有内容都为您提供了一个看起来像这样的矩阵（如果您希望生成的转换矩阵处理任意相机位置和方向，请酌情添加旋转和平移）。

[![正交投影矩阵的 LaTeX 渲染](https://i.stack.imgur.com/zqqXY.gif)](https://i.stack.imgur.com/zqqXY.gif)
[（来源：[codeguru.com](http://www.codeguru.com/images/article/10123/3dproj20.gif)）]

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-03-31T07:01:44.833

*   [http://mathworld.wolfram.com/OrthogonalProjection.html](http://mathworld.wolfram.com/OrthogonalProjection.html)

*   [http://nptel.iitm.ac.in/courses/Webcourse-contents/IIT-KANPUR/mathematics-2/node51.html](http://nptel.iitm.ac.in/courses/Webcourse-contents/IIT-KANPUR/mathematics-2/node51.html)

# reverse-engineering - 逆向工程旧油漆程序

> ID：688241
> 
> 赞同：12
> 
> 时间：2009-03-27T01:56:15.180
> 
> 标签：reverse-engineering, paint, dos, decompiling, disassembly

我有几个非常老的基于 MSDos 的绘图程序。他们在调色板索引的图像缓冲区上工作。他们有许多壮观的形状绘制工具、画笔和效果，这些工具在任何现代绘画程序中都不存在——尤其是在停留在低调色板索引图像的“界限”内时。我想在一个现代程序中重现许多这些美妙的工具，也许让我和公众再次更容易使用它们，而不必启动像 dosbox 这样的模拟器。但我有一个问题。

虽然很多这些画笔和工具和东西都有明显的功能，但它们的实现应该相当简单。但是对于其他工具，它们的操作原理就不是那么明显了。我会被困在确定一个正确或忠实的算法来实现这些。

如果你是我，你会采取什么方法？是否有现成的反编译器/反汇编器可以处理这样的旧程序？或者你会采取一些不同的方法，比如有条不紊地测试不同输入的算法来推断底层函数？一些不同技术的组合？就这些程序中的一行而言，这些（商业）程序的原作者是众所周知的，现在是狂热的开源倡导者。我应该尝试直接联系他们并询问吗？我在逆向工程方面不是特别有经验，所以我不知道从哪里开始。

编辑：似乎“问，你会收到”确实有效。

编辑 2：查看[http://animatorpro.org](http://animatorpro.org)以获取我...获得源代码的程序的源代码。豪华油漆也不错，但丹席尔瓦似乎已经从地球上消失了。

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2009-03-27T01:59:11.320

IDA Pro 几乎可以处理任何二进制文件，并且是此类工作的黄金标准，尽管联系作者也可能会有所帮助。

* * *

## 回答 #2

> 赞同：6
> 
> 时间：2009-03-27T02:01:17.290

如果你能说服作者开源部分或全部程序，那是最好的方法。

除此之外，反汇编和调试将成为您的朋友。在某些情况下，如果您知道它最初是用什么编译的，您可能能够反编译一个软件。但是拆开它，并在调试器中运行它以找到总体结构，并寻找可以完成实际刷机工作的明显功能。

起初它可能看起来令人生畏，但一段时间后你会发现它令人惊讶地可以理解。

-亚当

# python - 是否有比捆绑存储库中更好的用于 textmate 的 Python 捆绑包？

> ID：688245
> 
> 赞同：18
> 
> 时间：2009-03-27T01:57:33.743
> 
> 标签：python, textmate, textmatebundles

此时，Textmate 的官方 Python 包真的很简单，尤其是与 Ruby 包相比。有谁知道更完整的 Python 包？

编辑：

我完全知道有些编辑器和环境更适合 Python 开发，但我真的很想看看是否有可用的第三方 Textmate 包。

* * *

## 回答 #1

> 赞同：9
> 
> 时间：2010-03-01T02:20:14.923

我看了看，注意到最近有很多与 Python 相关的包的工作。此外，我似乎错过了获取捆绑包的最佳[新方法的备忘录：](http://al3x.net/2008/12/03/how-i-use-textmate.html)

[安装 GetBundle](http://solutions.treypiepmeier.com/2009/02/25/installing-getbundles-on-a-fresh-copy-of-textmate/)

* * *

## 回答 #2

> 赞同：-18
> 
> 时间：2009-03-27T02:02:51.810

我使用[Komodo Edit](http://www.activestate.com/komodo_edit/)和[BBEdit](http://www.barebones.com/)进行 MacOS 开发。

1.  他们完美地处理 Python 空白。

2.  在任一工具中滚动我自己的片段和组件都很容易。

3.  他们是非常好的 Python 编辑器。

但我不想讨论这些事情。

# input - 如何在 Erlang 中读取整数？

> ID：688250
> 
> 赞同：7
> 
> 时间：2009-03-27T01:58:57.000
> 
> 标签：input, erlang, integer

我正在尝试读取整数的用户输入。（如 cin >> nInput; 在 C++ 中）我从[http://www.erlang.org/doc/man/io.html](http://www.erlang.org/doc/man/io.html)
找到了 io:fread bif ，所以我编写了这样的代码。

> {ok, X} = io:fread("input : ", "~d"),
> io:format("~p~n", [X])。

但是当我输入 10 时，erlang 终端一直给我“\n”而不是 10。我假设 fread 自动读取 10 并将其转换为字符串。如何直接读取整数值？有没有办法做到这一点？谢谢您阅读此篇。

* * *

## 回答 #1

> 赞同：11
> 
> 时间：2009-03-27T09:04:45.523

```
1> {ok, [X]} = io:fread("input : ", "~d").
input : 10
{ok,"\n"}
2> X.
10
3> {ok, [A,B]} = io:fread("input : ", "~d,~d").
input : 456,26
{ok,[456,26]} 
```

就这样。

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2009-03-27T08:17:26.917

OTP 中有多种函数可帮助您将字符串转换为整数。如果您只是从用户那里读取一个字符串（例如直到换行），您可以使用模块`to_integer(String)`中的函数对其进行评估`string`：

```
string:to_integer(String) -> {Int,Rest} | {error,Reason} 
```

还有`list_to_integer(String)`BIF（内置函数，只需在没有模块的情况下调用），但它不像`string:to_integer(String)`函数那样宽容：

```
list_to_integer(String) -> int() 
```

`badarg`如果字符串不包含整数，则会出现异常。

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2010-04-29T23:59:04.537

如果使用 string:to_integer/1，请检查 Rest 的值是否为空列表 []。该函数从字符串的开头提取整数（如果有）。它不能保证完整的输入转换为整数。

```
string:to_integer(String) -> {Int,Rest} | {error,Reason} 
```

一个例子：

```
{Int, Rest} = string:to_integer("33t").
Int.  % -> 33
Rest. % -> "t" 
```

为什么要检查？如果用户的手指滑动并按“t”而不是 5，则预期输入是 335，而不是 33。

* * *

## 回答 #4

> 赞同：2
> 
> 时间：2010-04-30T12:02:32.880

尝试使用`~w`而不是打印数字`~p`：

```
1> io:format("~w~n", [[10]]).
[10]
ok
2> io:format("~p~n", [[10]]).
"\n"
ok 
```

格式说明`~p`符试图确定列表是否可能是一个字符串，但从`~w`不猜测；它总是将列表打印为列表。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2009-03-27T02:46:12.533

Erlang 将字符串表示为特定范围内的整数列表。因此，输入将是一个代表字符“1”的数字，您可以减去偏移量以获得实际值。号码，抱歉这里没有虚拟机来测试解决方案。

# linux - 非常简单的 Shell 脚本问题：进行粘性更改？

> ID：688254
> 
> 赞同：1
> 
> 时间：2009-03-27T01:59:33.817
> 
> 标签：linux, macos, unix, shell

我编写 shell 脚本在 OSX 和 Linux 中做各种事情，但我总是遇到同样的问题。脚本会运行，但它对环境所做的任何更改（当然，磁盘除外）都不会“坚持”。当脚本终止时，更改将恢复。

我怎样才能让我的改变坚持下去？

**编辑：**很多答案都很好，但它们并没有帮助我今晚面临的情况。我正在尝试运行它以使我的 TAP 界面正常工作

```
sudo bash # we go superuser
exec 4<>/dev/tap0  # opens device, creates interface tap0
ifconfig tap0 10.10.10.1 10.10.10.255
ifconfig tap0 up 
```

如果我将它粘贴进去，效果会非常好，但如果我来源它或 sh 它就不行。顺便说一句，之后我无法关闭终端窗口，因为我失去了 tap0 界面。

**最后编辑：**谢谢大家，答案是按照大家的建议使用源代码，但要从脚本本身中删除 sudo 命令。

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2009-03-27T02:06:20.773

这种行为是设计使然 - 至少在我使用的 bash 中，但我认为大多数 shell 的工作方式相同。一般来说，进程无法将环境变量等内容导出到其父进程。如果要运行一系列命令来更改当前 shell 进程中的环境，您可以做的是将命令写入文件并获取*它*。在 bash 你会输入

```
$ source commands.sh 
```

或者

```
$ . commands.sh 
```

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2009-03-27T02:08:59.940

子进程中环境的更改不会影响父进程。幸运的是，您可以通过说在当前进程中运行 shell 脚本

```
. /path/to/script.sh 
```

或者

```
source /path/to/script.sh 
```

不过要小心，如果您`exit`在脚本中运行，它将退出当前 shell。

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2009-03-27T02:05:00.853

您是指环境变量中的“环境”吗？你不能，不是你的意思。那个“环境”是一个过程上下文的东西；它对您的系统来说不是全局的，它是脚本特定执行环境的一部分。它可以移交给脚本启动的进程，但仅此而已。如果您想为环境变量设置可靠的设置，您可以在系统共享初始化文件中进行，例如 /etc/profile 和 /etc/bash.bashrc（实际名称 OS 和安装依赖）。不同的 init 脚本在不同的情况下运行（登录 shell 与生成的 shell，诸如此类），但想法是，您可以使用您想要始终拥有的任何环境上下文来预初始化 shell。

* * *

## 回答 #4

> 赞同：2
> 
> 时间：2009-03-27T02:05:12.943

如果您在脚本中设置环境变量，它们只会在脚本运行期间保持不变。

如果您需要整个 shell 会话的环境变量，则需要在您使用的任何 shell 的 .profile、.bashrc、.tcshrc 或 .rc 文件中设置它们。有关如何执行此操作的示例，请参见“ `man <your shell>`”（例如）。`man bash`

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2009-03-27T02:09:42.713

这是设计使然。

您可以将所需的“粘性”环境变量写入文件并在下次运行时将其读入。例如：

```
#!/bin/sh

# load from ~/.my_env
[ -r ~/.my_env ] && . ~/.my_env

# replace or add new entries to ~/.my_env
for i in "$@"; do
    [ "${i/=/}" = "$i" ] && continue
    touch ~/.my_env
    sed -i -e "\|^export ${i%%=*}=|d" ~/.my_env
    echo "export $i" >> ~/.my_env
    eval export "$i"
done 
```

* * *

## 回答 #6

> 赞同：1
> 
> 时间：2009-03-27T02:57:00.993

您真正的问题似乎只是关于点击界面。您应该更改问题以反映这一点。

从 Linux 的 Documentation/networking/tuntap.txt 中阅读有关 tap 的文档。这是一个简短的报价：

“为了使用驱动程序，程序必须打开 /dev/net/tun 并发出相应的 ioctl() 以向内核注册网络设备。网络设备将显示为 tunXX 或 tapXX，具体取决于所选择的选项。当程序**关闭文件描述符**时，网络设备和所有对应的路由都会消失。”

我会说很简单。没什么神秘的。您的脚本会打开点击界面，当脚本退出时，它会**关闭文件描述符**。

* * *

## 回答 #7

> 赞同：1
> 
> 时间：2009-03-27T03:19:23.547

当你 sudo 时，你必须明白你正在运行另一个程序，在这种情况下是另一个 shell。将这些命令粘贴到终端上与将它们放在脚本上是一样的，这是一种误解。发生的情况是，在 sudo 之后，终端连接到另一个 shell 会话，第二个和更多命令被发送到另一个 shell 会话。如果将所有命令放在一个脚本上，所有四个命令都会在同一个 shell 会话中执行，从而产生不希望的结果。

在这种特定情况下，我建议您将最后三个命令放在另一个脚本（例如 setup-tap.sh）上，然后将该脚本称为

```
sudo bash setup-tap.sh 
```

正如所建议的那样，采购是在当前 shell 中持续更改脚本调用的替代方法，但在这种情况下它不起作用。它比上一层，它可能会寻找你作为一个脚本，因为终端是相同的，但发生的是在 sudo 之后，你不再在同一个 shell 中了。

就像制作这样的脚本：

```
vi file.txt
iThe quick brown fox jumps over the lazy dog.<ESC>:wq 
```

当然，第二行（vi 命令）不会输入 vi，它仍然会在原始脚本中。

另一种选择是使用 here-documents，并将特权命令从标准输入传递给 sudo bash：

```
sudo bash <<-EOF
  exec 4<>/dev/tap0
  ifconfig tap0 10.10.10.1 10.10.10.255
  ifconfig tap0 up
EOF 
```

# javascript - 奇怪的 javascript 错误（使用 jQuery）

> ID：688256
> 
> 赞同：0
> 
> 时间：2009-03-27T02:00:11.490
> 
> 标签：javascript, jquery, html

我有一个代码可以抓住按钮点击然后消失实际内容并使点击项目的内容出现。我让它与我拥有的 init.js 文件中的其他薄层一起运行：

```
$(function() {
    $('#contacto').fancybox({
        'hideOnContentClick': false,
        'frameWidth': 600,
        'frameHeight': 550,
        'centerOnScroll': true
    });

        $('ul.drawers').accordion({
            header: 'H2.drawer-handle',
            selectedClass: 'open',
            event: 'mouseover'
        });

        $("#about-button").css({ opacity: 0.3  });
        $("#contact-button").css({ opacity: 0.3 });
        $("#page-wrap div.button").click(function(){
            clicked = $(this);
            console.log(clicked);
            // if the button is not already "transformed" AND is not animated
            if ((clicked.css("opacity") != "1") && (clicked.is(":not(animated)"))) {
                clicked.animate({
                    opacity: 1,
                    borderWidth: 5
                }, 600 );
                // each button div MUST have a "xx-button" and the target div must have an id "xx" 
                var idToLoad = clicked.attr("id").split('-');
                //we search trough the content for the visible div and we fade it out
                $("#menu-content").find("div:visible").fadeOut("fast", function(){
                    //once the fade out is completed, we start to fade in the right div
                    $(this).parent().find("#"+idToLoad[0]).fadeIn();
                })
            }
            //we reset the other buttons to default style
            clicked.siblings(".button").animate({
                opacity: 0.5,
                borderWidth: 1
            }, 600 );
        });
    }); 
```

但只有第二个 $(function() 是在此事件期间执行的。回答此问题的 HTML 代码是：

```
<div id="page-wrap"> 
            <div id="festival-button" class="button">
                <h2 class="header-ultimo-festival">&Uacute;timo Festival</h2>
            </div>
            <div id="cursos-button" class="button">
                <h2 class="header-cursos">Cursos del A&ntilde;o</h2>
            </div>
            <div id="viajes-button" class="button">
                <h2 class="header-viajes">Viajes del A&ntilde;o</h2>
            </div>

            <div class="clear"></div>

            <div id="menu-content"> 
                <div id="festival">
                    <p>
                        <a href="assets/img/varias/album/festival/plant1.jpg" title="Imagen 1" class="thickbox" rel="ultimo-festival">
                            <img src="assets/img/varias/album/festival/plant1_t.jpg" alt="Imagen 1" />
                        </a> 
                        <a href="assets/img/varias/album/festival/plant2.jpg" title="Imagen 2" class="thickbox" rel="ultimo-festival">
                            <img src="assets/img/varias/album/festival/plant2_t.jpg" alt="Imagen 2" />
                        </a> 
                        <a href="assets/img/varias/album/festival/plant3.jpg" title="Imagen 3" class="thickbox" rel="ultimo-festival">
                            <img src="assets/img/varias/album/festival/plant3_t.jpg" alt="Imagen 3" />
                        </a> 
                        <a href="assets/img/varias/album/festival/plant4.jpg" title="Imagen 4" class="thickbox" rel="ultimo-festival">
                            <img src="assets/img/varias/album/festival/plant4_t.jpg" alt="Imagen 4" />
                        </a>
                    </p>
                </div>

                <div id="cursos">
                    <p>Im&aacute;genes de Cursos aqu&iacute;</p>
                </div>

                <div id="viajes">
                    <p>Im&aacute;genes de Viajes aqu&iacute;</p>   
                </div>
            </div>
        </div>
    </div> 
```

问题是，当有人单击我菜单中的链接并激活“fancybox”效果，然后尝试单击与第二个 $(function() 事件相关的项目时，我收到此错误：

> $clicked.css 不是函数 (?)()()album.html (ligne 24) ready()()jquery.min.js (ligne 26) trigger()()jquery.min.js (ligne 25) [打破这个错误] if (($clicked.css("opacity") != "1") && ($clicked.is(":not(animated)"))) {

但我仍然不知道为什么......我试图修复它但我不能因为根据我的说法我有正确的语法=/

* * *

**编辑 2 个答案**

如果我在调用“fancybox”效果之前单击它，我做了建议，我在警报框中得到一个 [object Object]，然后我得到 [object HTMLDivElement] 和同样的错误......

* * *

**编辑**

通过使用 firebug 和 console.log(); 我注意到了一些事情，如果我在调用“fancybox”之前单击，我会回来：

```
Object 0=div#cursos-button.button length=1 jquery=1.2.6 
```

但是在调用它之后，我得到：

```
<div id="cursos-button" class="button" style="border-width: 1px; opacity: 0.5;"> 
```

现在想弄清楚为什么...

* * *

**编辑**

我仍然不知道为什么会发生这种情况，但是我使用 jQuery.noConflict(); 修复了它 无论如何，如果有人知道为什么会这样，如果你告诉我我会很感激=）

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-03-27T02:25:41.397

开始：

1 - 尝试将两个匿名函数放入 $(document).ready()

2 - 去掉 $clicked 变量上的 $ 前缀，这可能会让 jQuery 感到困惑 - 但在更改前缀之前，请在此行之后执行 alert($clicked) ：

```
$clicked = $(this);
alert($clicked); //to see if it's an object or null 
```

让我们知道会发生什么

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-03-27T03:11:43.157

我不明白你的目的 2

```
$(function () {
... 
```

出现在您的文档就绪处理程序中。这个成语是简写

```
$(document).ready(function () {
... 
```

那么-您真的要在外部文档就绪处理程序中包装更多文档就绪处理程序吗？

*PS：用 $ 前缀命名 javascript 变量是完全合法的，不会混淆 jQuery，实际上建议用于保存 jQuery 对象*

# math - vim中的数学符号

> ID：688265
> 
> 赞同：15
> 
> 时间：2009-03-27T02:02:44.353
> 
> 标签：math, vim

有谁知道如何让 vim 将数学符号的 html 实体转换为数学字符？

例如：

≠ 变成≠</p>

∴ 变成∴

这是一个带有符号 html 实体的表 [http://barzilai.org/math_sym.htm](http://barzilai.org/math_sym.htm)

* * *

更新：[解决了，bignose 解决了](https://stackoverflow.com/a/688361/70157)。

使用 Vim 的 :digraphs 功能。使用 Unicode 字符编码，

参见 ':help digraphs' 获取文档

我仍在寻找等宽 Unicode 字体，因此它可以完全呈现​​，但如果有额外的空格，它效果很好。

为了查看数学字符，UTF-8 必须是编码和显示这些字符的字体。

我将以下内容添加到我的 vim 配置文件中。

创建自定义文件： mathdoc.vim 语法/

```
" set the encoding to be utf-8, requires gVim or a terminal capable of
" unicode see ':help Unicode' for details
set encoding=utf-8
" requires a font that has characters for the higher uniocode symbols
set guifont=MS\ Gothic 
```

我将此添加到文件类型以将其设置为我自己的自定义扩展名 .txtmt

```
au BufNewFile,BufRead *.txtmt   setf mathdoc 
```

但您也可以在打开文件的情况下调用它：

```
:set ft=mathdoc 
```

digraphs 很好用，因为下面指定的 bignose 是它的工作原理

在插入模式下：按 control+k，然后：

∴ 是 S*

≠ 是!=

∑是+Z

≡ 是 =3

⇐ 是 <=

⇒ 是 =>

⇔ 是 ==

∀ 是 FA

∃ 是 TE

∋ 是 -)

完整列表见 :digraphs * 注意如果你只看到半个屏幕值得你字符编码不是 unicode，unicode 字符覆盖多个屏幕，输入 :set encoding=utf-8 切换到 utf-8。

上面链接中的表格包含您需要查找键盘快捷键的字符的数字，例如 8756 是∴

* * *

## 回答 #1

> 赞同：26
> 
> 时间：2009-03-27T02:51:41.367

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2009-03-27T02:53:27.540

我不确定是否存在在纯 vimscript 中执行此操作的库，但是，vim 确实允许您嵌入 Python，并且 Python 有[BeautifulSoup](http://www.crummy.com/software/BeautifulSoup/)可以处理[将 html 实体转换为 unicode](http://www.crummy.com/software/BeautifulSoup/documentation.html#Entity%20Conversion)：

我没有在我的 vim 上启用 python 支持，所以我不得不编写一个外部脚本`soup.py`，它将 html 实体转换为 UTF-8：

```
# soup.py
from BeautifulSoup import BeautifulStoneSoup
import sys
input = sys.stdin.read()
output = str(BeautifulStoneSoup(input, convertEntities=BeautifulStoneSoup.HTML_ENTITIES))
sys.stdout.write(output) 
```

（仅供参考，我不知道python，所以即使它有效，它可能也很丑）

您可以在 vim 中使用它，方法是选择要在可视模式下转换的实体行，然后将它们传递给脚本：

```
:'<,'>!python soup.py 
```

例如，如果我的光标在一行阅读

```
&there4; i &ne; 10 
```

我打

```
!!python soup.py<Enter> 
```

它会将其转换为

```
∴ i ≠ 10 
```

# iphone - 具有同步功能的 iPhone 离线应用程序

> ID：688268
> 
> 赞同：28
> 
> 时间：2009-03-27T02:03:22.043
> 
> 标签：iphone, cocoa-touch, cocoa, data-synchronization

我正在研究构建一个应用程序，它在离线时和在线时一样好用。由于应用程序在离线时无法与服务器通信，因此需要进行某种程度的同步。

在为您的 iPhone 规划离线操作和同步时，有哪些好的工具可以阅读和开始思考？

我必须自己创建哪些工具，而不是苹果已经提供的工具来帮助解决这个特定问题？

* * *

## 回答 #1

> 赞同：16
> 
> 时间：2009-04-13T21:03:27.650

在过去 2 个月左右的时间里，我一直在开发一个可以处理这种确切行为的应用程序。它有一小部分仅在线的功能和大量离线/在线的功能。

我正在使用 sqlite 进行本地存储，如此处所建议的，使用 sqlitepersistentobjects 库的修改版本。sqlitepersistentobjects 的基本版本不是线程安全的，因此请注意您是否正在使用它。（查看objectiverecord：[objectivesync](http://github.com/yfactorial/objectivesync/tree/master)以获得线程安全的替代方案，但准备好深入研究代码）。如果您愿意为 3.0 sdk 开发，那么核心数据是 sqlite 库的另一种可能性。

整体架构非常简单，我使用 sqlite 对本地存储进行建模，并使用[目标资源](http://github.com/yfactorial/objectiveresource/tree/master)针对 rails 应用程序和 REST api 进行远程交互。它可以使用 xml 或 json 进行数据序列化。

当在本地修改对象时，首先将更改保存到该对象的 sqlite 数据库记录中，然后添加到队列中，该队列也被序列化并存储在本地 sqlite db 中。（然后可以随时处理队列）

如果有可用的连接，任何排队的本地更改都将被反序列化并添加到 NSOperationQueue 中，然后在后台处理它们。

为了使这一切正常工作，我对 NSOperation 进行了子类化，以便它可以支持多种类型的远程队列操作 - 创建、更新、删除基本上使用目标资源来发出远程请求。

使用 NSOperationQueue 和 NSOperation 的好处是它们为您处理后台线程，因此我强烈建议您查看这些类的苹果文档以及苹果[线程指南](http://developer.apple.com/DOCUMENTATION/Cocoa/Conceptual/Multithreading/Introduction/Introduction.html)。

当应用程序加载时，会在后台完成并处理一些远程检查以获取最新数据 - 尽管老实说，我仍在稍微改变这种行为方式。

这是迄今为止我必须处理的内容的快速概述......希望它有所帮助。

* * *

## 回答 #2

> 赞同：14
> 
> 时间：2009-03-27T12:34:04.210

应用商店中有大量应用程序同时依赖在线和离线数据

你真正应该做的是在你的应用程序启动时，运行一个后台线程（它静默运行，所以你的用户永远不会看到任何延迟）。该线程从您的服务器下载最新数据并将其推送到您的本地数据库（sqlite 是最佳选择）

确保您实施某种数据版本控制，以便您的应用程序仅下载自上次下载以来实际更改的数据 - 否则您将不必要地下载可能非常庞大的整个数据集（取决于您的应用程序要求）

执行此操作时还要确保测试互联网连接。如果没有可用的互联网，请务必提醒用户

这样你就可以两全其美了。远离互联网的用户仍然可以将您的应用程序与他们的本地 sqlite 数据一起使用

在 iphone os 3.0 中，苹果引入了推送服务 - 您可以简单地“推送”您的数据而不是执行“拉取”，但这在当前的 iPhone OS (2.xx) 中不可用

* * *

## 回答 #3

> 赞同：4
> 
> 时间：2009-04-13T02:12:39.320

推送在这里可能不是一个可行的选择，因为您可以推送的数据量很小，并且基本上回到“告诉我的应用程序进行服务器调用”。我们在 Satchel 中使用在线/离线模型。每当我们必须与服务器通信时，我们都会捆绑该通信（一个 URL 和可能的一些 POST 数据）并将其存储到数据库中。如果我们在线，我们会立即将其拉回并发送，当我们收到有效响应时，我们会从数据库中删除记录。如果我们离线，这些行会增加，下次我们在线时，它们会被发送出去。这不是在所有情况下都可行的模型，但可以适应大多数情况。

在 3.0 中，您可以访问 CoreData，这是一个很棒的数据管理工具。除此之外，NSURLXXX 家族是你的朋友。

* * *

## 回答 #4

> 赞同：2
> 
> 时间：2009-03-27T02:59:52.237

我会将离线时收集的所有信息存储在 SQLite 数据库中。然后，根据用户的请求，您可以使用 HTTP 或您可以想出的自定义 TCP/IP 协议与服务器同步所有存储的信息。

近 10 年来，我一直在 Palm OS 应用程序上使用这种方法，它们确实非常有效。

据我所知，您必须完成此操作的唯一“工具”是带有 Cocoa Touch 的普通旧 OBJECTIVE-C。尽管您可以使用一些 TCP/IP C++ 库，如果您决定实现自己的协议，这些库将使您的生活更轻松。

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2012-03-18T17:56:29.543

想知道您是否考虑过使用同步框架来管理同步。如果您对此感兴趣，可以查看开源项目 OpenMobster 的 Sync 服务。您可以执行以下同步操作

*   双向
*   单向客户端
*   单向装置
*   开机

除此之外，所有修改都会自动跟踪并与云同步。当网络连接中断时，您可以让您的应用程序离线。它将跟踪任何更改，并在连接返回时自动在后台将其与云同步。它还提供跨多个设备的同步，如 iCloud

此外，云中的修改使用推送通知进行同步，因此即使数据存储在本地，数据也始终是最新的。

这是开源项目的链接：http: [//openmobster.googlecode.com](http://openmobster.googlecode.com)

这是 iPhone App Sync 的链接：[http ://code.google.com/p/openmobster/wiki/iPhoneSyncApp](http://code.google.com/p/openmobster/wiki/iPhoneSyncApp)

# algorithm - 使用两个队列实现堆栈

> ID：688276
> 
> 赞同：150
> 
> 时间：2009-03-27T02:07:34.123
> 
> 标签：java, c#, python, vb, javascript, php, algorithm, data-structures, stack

[之前在那里](https://stackoverflow.com/questions/69192/using-stack-as-queue)问过一个类似的问题，但这里的问题是相反的，使用两个队列作为堆栈。问题...

给定两个具有标准操作（ , , , ）的队列，用标准操作（`enqueue`, `dequeue`, `isempty`, `size`）实现一个栈。`pop``push``isempty``size`

应该有**两个**版本的解决方案。

*   版本**A**：推送项目时堆栈应该是有效的；和
*   版本**B**：弹出项目时堆栈应该是有效的。

比起任何特定的语言实现，我对算法更感兴趣。但是，我欢迎使用我熟悉的语言（[java](/questions/tagged/java "显示标记为“java”的问题")、[c#](/questions/tagged/c%23 "显示标记为“c#”的问题")、[python](/questions/tagged/python "显示标记为“python”的问题")、[vb](/questions/tagged/vb "显示标记为“vb”的问题")、[javascript](/questions/tagged/javascript "显示标记为“javascript”的问题")、[php](/questions/tagged/php "显示标记为“php”的问题")）表达的解决方案。

* * *

## 回答 #1

> 赞同：201
> 
> 时间：2009-03-27T02:17:51.603

版本 A（高效推送）：

*   推：
    *   在 queue1 中排队
*   流行音乐：
    *   当 queue1 的大小大于 1 时，将队列 1 中的出列项通过管道传输到 queue2
    *   出队并返回 queue1 的最后一项，然后切换 queue1 和 queue2 的名称

版本 B（高效弹出）：

*   推：
    *   在 queue2 中排队
    *   将queue1的所有项入队到queue2中，然后切换queue1和queue2的名称
*   流行音乐：
    *   从 queue1 出队

* * *

## 回答 #2

> 赞同：68
> 
> 时间：2009-03-27T02:20:05.233

最简单的（也许是唯一的）方法是将新元素推入空队列，然后将另一个元素出队并入队到先前的空队列中。通过这种方式，最新的总是排在队列的前面。这将是版本 B，对于版本 A，您只需通过将元素出列到第二个队列（最后一个队列除外）来反转该过程。

步骤 0：

```
"Stack"
+---+---+---+---+---+
|   |   |   |   |   |
+---+---+---+---+---+

Queue A                Queue B
+---+---+---+---+---+  +---+---+---+---+---+
|   |   |   |   |   |  |   |   |   |   |   |
+---+---+---+---+---+  +---+---+---+---+---+ 
```

第1步：

```
"Stack"
+---+---+---+---+---+
| 1 |   |   |   |   |
+---+---+---+---+---+

Queue A                Queue B
+---+---+---+---+---+  +---+---+---+---+---+
| 1 |   |   |   |   |  |   |   |   |   |   |
+---+---+---+---+---+  +---+---+---+---+---+ 
```

第2步：

```
"Stack"
+---+---+---+---+---+
| 2 | 1 |   |   |   |
+---+---+---+---+---+

Queue A                Queue B
+---+---+---+---+---+  +---+---+---+---+---+
|   |   |   |   |   |  | 2 | 1 |   |   |   |
+---+---+---+---+---+  +---+---+---+---+---+ 
```

第 3 步：

```
"Stack"
+---+---+---+---+---+
| 3 | 2 | 1 |   |   |
+---+---+---+---+---+

Queue A                Queue B
+---+---+---+---+---+  +---+---+---+---+---+
| 3 | 2 | 1 |   |   |  |   |   |   |   |   |
+---+---+---+---+---+  +---+---+---+---+---+ 
```

* * *

## 回答 #3

> 赞同：49
> 
> 时间：2011-09-06T04:19:05.993

我们可以用一个队列做到这一点：

推：

1.  将新元素加入队列。
2.  如果`n`是队列中元素的数量，则删除和插入元素的`n-1`次数。

流行音乐：

1.  出队

.

```
push 1

front                     
+----+----+----+----+----+----+
| 1  |    |    |    |    |    |    insert 1
+----+----+----+----+----+----+

push2

front                     
+----+----+----+----+----+----+
| 1  | 2  |    |    |    |    |    insert 2
+----+----+----+----+----+----+

     front                     
+----+----+----+----+----+----+
|    | 2  |  1 |    |    |    |    remove and insert 1
+----+----+----+----+----+----+

 insert 3

      front                     
+----+----+----+----+----+----+
|    | 2  |  1 |  3 |    |    |    insert 3
+----+----+----+----+----+----+

           front                     
+----+----+----+----+----+----+
|    |    |  1 |  3 |  2 |    |    remove and insert 2
+----+----+----+----+----+----+

                front                     
+----+----+----+----+----+----+
|    |    |    |  3 |  2 |  1 |    remove and insert 1
+----+----+----+----+----+----+ 
```

示例实现：

```
int stack_pop (queue_data *q)
{
  return queue_remove (q);
}

void stack_push (queue_data *q, int val)
{
  int old_count = queue_get_element_count (q), i;

  queue_insert (q, val);
  for (i=0; i<old_count; i++)
  {
    queue_insert (q, queue_remove (q));
  }
} 
```

* * *

## 回答 #4

> 赞同：10
> 
> 时间：2010-12-01T10:35:06.153

```
import java.util.*;

/**
 *
 * @author Mahmood
 */
public class StackImplUsingQueues {

    Queue<Integer> q1 = new LinkedList<Integer>();
    Queue<Integer> q2 = new LinkedList<Integer>();

    public int pop() {
        if (q1.peek() == null) {
            System.out.println("The stack is empty, nothing to return");
            int i = 0;
            return i;
        } else {
            int pop = q1.remove();
            return pop;
        }
    }

    public void push(int data) {

        if (q1.peek() == null) {
            q1.add(data);
        } else {
            for (int i = q1.size(); i > 0; i--) {
                q2.add(q1.remove());
            }
            q1.add(data);
            for (int j = q2.size(); j > 0; j--) {
                q1.add(q2.remove());
            }

        }
    }

    public static void main(String[] args) {
        StackImplUsingQueues s1 = new StackImplUsingQueues();
        //       Stack s1 = new Stack();
        s1.push(1);
        s1.push(2);
        s1.push(3);
        s1.push(4);
        s1.push(5);
        s1.push(6);
        s1.push(7);
        s1.push(8);
        s1.push(9);
        s1.push(10);
        // s1.push(6);
        System.out.println("1st = " + s1.pop());
        System.out.println("2nd = " + s1.pop());
        System.out.println("3rd = " + s1.pop());
        System.out.println("4th = " + s1.pop());
        System.out.println("5th = " + s1.pop());
        System.out.println("6th = " + s1.pop());
        System.out.println("7th = " + s1.pop());
        System.out.println("8th = " + s1.pop());
        System.out.println("9th = " + s1.pop());
        System.out.println("10th= " + s1.pop());
    }
} 
```

* * *

## 回答 #5

> 赞同：4
> 
> 时间：2011-04-12T00:24:37.387

我们可以只使用一个队列来实现一个堆栈吗？我可以使用两个队列，但考虑单个队列会更有效。这是代码：

```
 public void Push(T val)
    {
        queLower.Enqueue(val);
    }

    public  T Pop()
    {

        if (queLower.Count == 0 )
        {
            Console.Write("Stack is empty!");
            return default(T);

         }
        if (queLower.Count > 0)
        {
            for (int i = 0; i < queLower.Count - 1;i++ )
            {
                queLower.Enqueue(queLower.Dequeue ());
           }
                    }

        return queLower.Dequeue();

    } 
```

* * *

## 回答 #6

> 赞同：3
> 
> 时间：2011-01-09T21:41:55.100

```
queue<int> q1, q2;
int i = 0;

void push(int v) {
  if( q1.empty() && q2.empty() ) {
     q1.push(v);
     i = 0;
  }
  else {
     if( i == 0 ) {
        while( !q1.empty() ) q2.push(q1.pop());
        q1.push(v);
        i = 1-i;
     }
     else {
        while( !q2.empty() ) q1.push(q2.pop());
        q2.push(v);
        i = 1-i;
     }
  }
}

int pop() {
   if( q1.empty() && q2.empty() ) return -1;
   if( i == 1 ) {
      if( !q1.empty() )
           return q1.pop();
      else if( !q2.empty() )
           return q2.pop();
   }
   else {
      if( !q2.empty() )
           return q2.pop();
      else if( !q1.empty() )
           return q1.pop();
   }
} 
```

* * *

## 回答 #7

> 赞同：2
> 
> 时间：2009-03-27T02:44:35.937

这是我的答案——“流行音乐”效率低下。似乎所有立即想到的算法都有 N 复杂度，其中 N 是列表的大小：无论您选择在“pop”上工作还是在“push”上工作

列表交换和第四个的算法可能更好，因为不需要计算大小，尽管您仍然需要循环并与空进行比较。

您可以通过注意有关队列中最后一个元素的信息只能通过知道队列的大小来证明该算法的编写速度不能比 N 快，并且您必须销毁数据才能到达该元素，因此是第二个队列.

使这更快的唯一方法是首先不使用队列。

```
from data_structures import queue

class stack(object):
    def __init__(self):
        q1= queue 
        q2= queue #only contains one item at most. a temp var. (bad?)

    def push(self, item):
        q1.enque(item) #just stick it in the first queue.

    #Pop is inefficient
    def pop(self):
        #'spin' the queues until q1 is ready to pop the right value. 
        for N 0 to self.size-1
            q2.enqueue(q1.dequeue)
            q1.enqueue(q2.dequeue)
        return q1.dequeue()

    @property
    def size(self):
        return q1.size + q2.size

    @property
    def isempty(self):
        if self.size > 0:
           return True
        else
           return False 
```

* * *

## 回答 #8

> 赞同：2
> 
> 时间：2013-02-21T18:03:27.940

这是我在平均情况下适用于 O(1) 的解决方案。有两个队列：`in`和`out`。见伪代码如下：

```
PUSH(X) = in.enqueue(X)

POP: X =
  if (out.isEmpty and !in.isEmpty)
    DUMP(in, out)
  return out.dequeue

DUMP(A, B) =
  if (!A.isEmpty)
    x = A.dequeue()
    DUMP(A, B)
    B.enqueue(x) 
```

* * *

## 回答 #9

> 赞同：1
> 
> 时间：2011-01-04T07:17:04.490

正如已经提到的那样，一个队列难道不能解决问题吗？它可能不太实用，但有点圆滑。

```
push(x):
enqueue(x)
for(queueSize - 1)
   enqueue(dequeue())

pop(x):
dequeue() 
```

* * *

## 回答 #10

> 赞同：1
> 
> 时间：2013-10-30T17:38:54.410

下面是一些简单的伪代码，push 是 O(n)，pop / peek 是 O(1)：

```
Qpush = Qinstance()
Qpop = Qinstance()

def stack.push(item):
    Qpush.add(item)
    while Qpop.peek() != null: //transfer Qpop into Qpush
        Qpush.add(Qpop.remove()) 
    swap = Qpush
    Qpush = Qpop
    Qpop = swap

def stack.pop():
    return Qpop.remove()

def stack.peek():
    return Qpop.peek() 
```

* * *

## 回答 #11

> 赞同：1
> 
> 时间：2014-03-30T19:39:44.670

设 S1 和 S2 是用于实现队列的两个堆栈。

```
struct Stack 
{ struct Queue *Q1;
  struct Queue *Q2;
} 
```

我们确保一个队列始终为空。

**推送操作：** 无论哪个队列不为空，将元素插入其中。

*   检查队列 Q1 是否为空。如果 Q1 为空，则将其中的元素入队。
*   否则 EnQueue 元素进入 Q1。

`Push (struct Stack *S, int data) { if(isEmptyQueue(S->Q1) EnQueue(S->Q2, data); else EnQueue(S->Q1, data); }`

时间复杂度：O(1)

**弹出操作：**将n-1个元素转移到其他队列并从队列中删除最后一个以执行弹出操作。

*   如果队列 Q1 不为空，则将 n-1 个元素从 Q1 传输到 Q2，然后将 Q1 的最后一个元素出列并返回。
*   如果队列 Q2 不为空，则将 n-1 个元素从 Q2 转移到 Q1，然后将 Q2 的最后一个元素出列并返回。

`

```
int Pop(struct Stack *S){
int i, size;
if(IsEmptyQueue(S->Q2)) 
{
size=size(S->Q1);
i=0;
while(i<size-1)
{ EnQueue(S->Q2, Dequeue(S->Q1)) ;
  i++;
}
return DeQueue(S->Q1);  
}
else{
size=size(S->Q2);
while(i<size-1)
EnQueue(S->Q1, Dequeue(S->Q2)) ;
i++;
}
return DeQueue(S->Q2);
} } 
```

时间复杂度：pop 操作的运行时间为 O(n)，因为每次调用 pop 时，我们都将所有元素从一个队列转移到其他队列。

* * *

## 回答 #12

> 赞同：1
> 
> 时间：2015-09-19T11:12:42.437

```
Q1 = [10, 15, 20, 25, 30]
Q2 = []

exp:
{   
    dequeue n-1 element from Q1 and enqueue into Q2: Q2 == [10, 15, 20, 25]

    now Q1 dequeue gives "30" that inserted last and working as stack
}

swap Q1 and Q2 then GOTO exp 
```

* * *

## 回答 #13

> 赞同：1
> 
> 时间：2016-05-06T20:52:00.140

```
import java.util.LinkedList;
import java.util.Queue;

class MyStack {
    Queue<Integer> queue1 = new LinkedList<Integer>();
    Queue<Integer> queue2 = new LinkedList<Integer>();

    // Push element x onto stack.
    public void push(int x) {
        if(isEmpty()){
            queue1.offer(x);
        }else{
            if(queue1.size()>0){
                queue2.offer(x);
                int size = queue1.size();
                while(size>0){
                    queue2.offer(queue1.poll());
                    size--;
                }
            }else if(queue2.size()>0){
                queue1.offer(x);
                int size = queue2.size();
                while(size>0){
                    queue1.offer(queue2.poll());
                    size--;
                }
            }
        }
    }

    // Removes the element on top of the stack.
    public void pop() {
        if(queue1.size()>0){
            queue1.poll();
        }else if(queue2.size()>0){
            queue2.poll();
        }
    }

    // Get the top element. You can make it more perfect just example
    public int top() {
       if(queue1.size()>0){
            return queue1.peek();
        }else if(queue2.size()>0){
            return queue2.peek();
        }
        return 0;
    }

    // Return whether the stack is empty.
    public boolean isEmpty() {
        return queue1.isEmpty() && queue2.isEmpty();
    }
} 
```

* * *

## 回答 #14

> 赞同：0
> 
> 时间：2012-03-13T12:10:54.983

这是另一种解决方案：

对于 PUSH ： - 在队列 1 中添加第一个元素。 - 当添加第二个元素等时，首先将队列 2 中的元素排入队列，然后将队列 1 中的所有元素复制到队列 2。-对于 POP，只需从插入最后一个元素的队列中取出元素。

所以，

```
public void push(int data){
if (queue1.isEmpty()){
    queue1.enqueue(data);
}  else {
queue2.enqueue(data);
while(!queue1.isEmpty())
Queue2.enqueue(queue1.dequeue());
//EXCHANGE THE NAMES OF QUEUE 1 and QUEUE2 
```

} }

```
public int pop(){
int popItem=queue2.dequeue();
return popItem;
}' 
```

有一个问题，我想不通，如何重命名队列？？？

* * *

## 回答 #15

> 赞同：0
> 
> 时间：2014-07-12T11:56:05.707

```
#include <bits/stdc++.h>
using namespace std;
queue<int>Q;
stack<int>Stk;
void PRINT(stack<int>ss , queue<int>qq) {
    while( ss.size() ) {
        cout << ss.top() << " " ;
        ss.pop();
    }
    puts("");
    while( qq.size() ) {
        cout << qq.front() << " " ;
        qq.pop();
    }
    puts("\n----------------------------------");
}
void POP() {
    queue<int>Tmp ;
    while( Q.size() > 1 ) {
        Tmp.push( Q.front()  );
        Q.pop();
    }
    cout << Q.front() << " " << Stk.top() << endl;
    Q.pop() , Stk.pop() ;
    Q = Tmp ;
}
void PUSH(int x ) {
    Q.push(x);
    Stk.push(x);
}
int main() {
    while( true ) {
        string typ ;
        cin >> typ ;
        if( typ == "push" ) {
            int x ;
            cin >> x;
            PUSH(x);
        } else POP();
        PRINT(Stk,Q);
    }
} 
```

* * *

## 回答 #16

> 赞同：0
> 
> 时间：2016-07-18T11:55:16.947

**仅使用一个队列的 Python 代码**

```
 class Queue(object):
    def __init__(self):
        self.items=[]
    def enqueue(self,item):
        self.items.insert(0,item)
    def dequeue(self):
        if(not self.isEmpty()):
            return  self.items.pop()
    def isEmpty(self):
        return  self.items==[]
    def size(self):
        return len(self.items)

class stack(object):
        def __init__(self):
            self.q1= Queue()

        def push(self, item):
            self.q1.enqueue(item) 

        def pop(self):
            c=self.q1.size()
            while(c>1):
                self.q1.enqueue(self.q1.dequeue())
                c-=1
            return self.q1.dequeue()

        def size(self):
            return self.q1.size() 

        def isempty(self):
            if self.size > 0:
               return True
            else:
               return False 
```

* * *

## 回答 #17

> 赞同：0
> 
> 时间：2016-11-15T07:33:43.590

**这是 c# 中的完整工作代码：**

它已通过 Single Queue 实现，

推：

```
1\. add new element.
2\. Remove elements from Queue (totalsize-1) times and add back to the Queue 
```

流行音乐：

```
normal remove

 using System;
    using System.Collections.Generic;
    using System.Linq;
    using System.Text;
    using System.Threading.Tasks;

    namespace StackImplimentationUsingQueue
    {
        class Program
        {
            public class Node
            {
                public int data;
                public Node link;
            }
            public class Queue
            {
                public Node rear;
                public Node front;
                public int size = 0;
                public void EnQueue(int data)
                {
                    Node n = new Node();
                    n.data = data;
                    n.link = null;
                    if (rear == null)
                        front = rear = n;
                    else
                    {
                        rear.link = n;
                        rear = n;
                    }
                    size++;
                    Display();
                }
                public Node DeQueue()
                {
                    Node temp = new Node();
                    if (front == null)
                        Console.WriteLine("Empty");
                    else
                    {
                        temp = front;
                        front = front.link;
                        size--;
                    }
                    Display();
                    return temp;
                }
                public void Display()
                {
                    if (size == 0)
                        Console.WriteLine("Empty");
                    else
                    {
                        Console.Clear();
                        Node n = front;
                        while (n != null)
                        {
                            Console.WriteLine(n.data);
                            n = n.link;
                        }
                    }
                }
            }
            public class Stack
            {
                public Queue q;
                public int size = 0;
                public Node top;
                public Stack()
                {
                    q = new Queue();
                }
                public void Push(int data)
                {
                    Node n = new Node();
                    n.data = data;
                    q.EnQueue(data);
                    size++;
                    int counter = size;
                    while (counter > 1)
                    {
                        q.EnQueue(q.DeQueue().data);
                        counter--;
                    }
                }
                public void Pop()
                {
                    q.DeQueue();
                    size--;
                }
            }
            static void Main(string[] args)
            {
                Stack s= new Stack();
                for (int i = 1; i <= 3; i++)
                    s.Push(i);
                for (int i = 1; i < 3; i++)
                    s.Pop();
                Console.ReadKey();
            }
        }
    } 
```

* * *

## 回答 #18

> 赞同：0
> 
> 时间：2017-07-07T08:29:00.407

这是一个非常简单的解决方案，它使用一个队列并提供像堆栈这样的功能。

```
public class CustomStack<T>
{
    Queue<T> que = new Queue<T>();

    public void push(T t) // STACK = LIFO / QUEUE = FIFO
    {

        if( que.Count == 0)
        {
            que.Enqueue(t);
        }
        else
        {
            que.Enqueue(t);
            for (int i = 0; i < que.Count-1; i++)
            {
                var data = que.Dequeue();

                que.Enqueue(data);
            }
        }

    }

    public void pop()
    {

        Console.WriteLine("\nStack Implementation:");
        foreach (var item in que)
        {
            Console.Write("\n" + item.ToString() + "\t");
        }

        var data = que.Dequeue();
        Console.Write("\n Dequeing :" + data);
    }

    public void top()
    {

        Console.Write("\n Top :" + que.Peek());
    }

} 
```

因此，在上面名为“CustomStack”的类中，我所做的只是检查队列是否为空，如果为空，则插入一个，然后从病房插入，然后删除插入。按照这个逻辑，先到先得。示例：在队列中，我插入了 1，现在尝试插入 2。第二次删除 1 并再次插入，因此它变成了相反的顺序。

谢谢你。

* * *

## 回答 #19

> 赞同：0
> 
> 时间：2020-02-08T10:14:36.247

下面是一个非常简单的 Java 解决方案，它支持高效的推送操作。

**算法 -**

1.  声明两个队列 q1 和 q2。

2.  推送操作 - 将元素排入队列 q1。

3.  弹出操作 - 确保队列 q2 不为空。如果为空，则将除最后一个元素之外的所有元素从q1中出列，并逐个入队到q2。从 q1 中取出最后一个元素并将其存储为弹出元素。交换队列 q1 和 q2。返回存储的弹出元素。

4.  Peek 操作 - 确保队列 q2 不为空。如果为空，则将除最后一个元素之外的所有元素从q1中出列，并逐个入队到q2。从 q1 中取出最后一个元素并将其存储为 peeked 元素。将其排回队列 q2 并交换队列 q1 和 q2。返回存储的偷看元素。

以下是上述算法的代码 -

```
class MyStack {

    java.util.Queue<Integer> q1;
    java.util.Queue<Integer> q2;
    int SIZE = 0;

    /** Initialize your data structure here. */
    public MyStack() {
        q1 = new LinkedList<Integer>();
        q2 = new LinkedList<Integer>();

    }

    /** Push element x onto stack. */
    public void push(int x) {
        q1.add(x);
        SIZE ++;

    }

    /** Removes the element on top of the stack and returns that element. */
    public int pop() {
        ensureQ2IsNotEmpty();
        int poppedEle = q1.remove();
        SIZE--;
        swapQueues();
        return poppedEle;
    }

    /** Get the top element. */
    public int top() {
        ensureQ2IsNotEmpty();
        int peekedEle = q1.remove();
        q2.add(peekedEle);
        swapQueues();
        return peekedEle;
    }

    /** Returns whether the stack is empty. */
    public boolean empty() {
        return q1.isEmpty() && q2.isEmpty();

    }

    /** move all elements from q1 to q2 except last element */
    public void ensureQ2IsNotEmpty() {
        for(int i=0; i<SIZE-1; i++) {
            q2.add(q1.remove());
        }
    }

    /** Swap queues q1 and q2 */
    public void swapQueues() {
        Queue<Integer> temp = q1;
        q1 = q2;
        q2 = temp;
    }
} 
```

* * *

## 回答 #20

> 赞同：0
> 
> 时间：2020-09-20T15:46:32.847

C# 中的高效解决方案

```
public class MyStack {
    private Queue<int> q1 = new Queue<int>();
    private Queue<int> q2 = new Queue<int>();
    private int count = 0;

    /**
     * Initialize your data structure here.
     */
    public MyStack() {
    }

    /**
     * Push element x onto stack.
     */
    public void Push(int x) {
        count++;
        q1.Enqueue(x);
        while (q2.Count > 0) {
            q1.Enqueue(q2.Peek());
            q2.Dequeue();
        }
        var temp = q1;
        q1 = q2;
        q2 = temp;
    }

    /**
     * Removes the element on top of the stack and returns that element.
     */
    public int Pop() {
        count--;
        return q2.Dequeue();
    }

    /**
     * Get the top element.
     */
    public int Top() {
        return q2.Peek();
    }

    /**
     * Returns whether the stack is empty.
     */
    public bool Empty() {
        if (count > 0) return false;
        return true;
    }
} 
```

* * *

## 回答 #21

> 赞同：0
> 
> 时间：2020-12-23T17:49:12.903

```
template <typename T>
class stackfmtoq {
    queue<T> q1;
    queue<T> q2;
public:
    void push(T data) {
        while (!q2.empty()) {
            q1.push(q2.front());
            q2.pop();
        }
        q2.push(data);
        while (!q1.empty()) {
            q2.push(q1.front());
            q1.pop();
        }
    }
    T pop() {
        if (q2.empty()) {
            cout << "Stack is Empty\n";
            return NULL;
        }
        T ret = q2.front();
        q2.pop();
        return ret;
    }
    T top() {
        if (q2.empty()) return NULL;
        return q2.front();
    }
}; 
```

* * *

## 回答 #22

> 赞同：0
> 
> 时间：2021-02-25T03:37:10.213

```
import java.util.Deque;
import java.util.LinkedList;
import java.util.Queue;

public class ImplementationOfStackUsingTwoQueue {

    private static Deque<Integer> inboxQueue = new LinkedList<>();
    private static Queue<Integer> outboxQueue = new LinkedList<>();

    public void pushInStack(Integer val){
        inboxQueue.add(val);
    }

    public void popFromStack(){

        if(outboxQueue.isEmpty()){
            while(!inboxQueue.isEmpty()){
                outboxQueue.add(inboxQueue.pollLast());
            }
        }
    }

    public static void main(String[] args) {

        ImplementationOfStackUsingTwoQueue obj = new ImplementationOfStackUsingTwoQueue();

        obj.pushInStack(1);
        obj.pushInStack(2);
        obj.pushInStack(3);
        obj.pushInStack(4);
        obj.pushInStack(5);
        System.out.println("After pushing the values in Queue" + inboxQueue);

        obj.popFromStack();
        System.out.println("After popping the values from Queue" + outboxQueue);    
    }
} 
```

* * *

## 回答 #23

> 赞同：0
> 
> 时间：2021-04-19T15:25:51.167

一种易于理解和实施的不同方法可能是：

1.  添加操作 --> 始终在空队列中添加元素，并在添加该元素后将所有其他元素从其他非空队列移动到此队列。
2.  弹出操作 --> 无论哪个队列不为空，对其执行删除/轮询并返回。
3.  顶部操作 --> 无论哪个队列不为空，对其执行 peek 并返回。
4.  打印 --> 无论哪个队列不为空，打印它。

* * *

## 回答 #24

> 赞同：-1
> 
> 时间：2014-07-14T09:49:52.400

这是我的解决方案..

Concept_Behind:: `push(struct Stack* S,int data)`::此函数将 Q1 中的第一个元素入队并在 Q2 中休息 `pop(struct Stack* S)`::如果 Q2 不为空，则将所有元素转移到 Q1 并返回 Q2 中的最后一个元素，否则（这意味着 Q2 为空）将所有元素转移到 Q2 和返回 Q1 中的最后一个元素

Efficiency_Behind:: `push(struct Stack*S,int data)`::O(1)//因为每个数据单个入队 `pop(struct Stack* S)`::O(n)//因为每个 pop 传输最差的 n-1 个数据。

```
#include<stdio.h>
#include<stdlib.h>
struct Queue{
    int front;
    int rear;
    int *arr;
    int size;
    };
struct Stack {
    struct Queue *Q1;
    struct Queue *Q2;
    };
struct Queue* Qconstructor(int capacity)
{
    struct Queue *Q=malloc(sizeof(struct Queue));
    Q->front=Q->rear=-1;
    Q->size=capacity;
    Q->arr=malloc(Q->size*sizeof(int));
    return Q;
    }
int isEmptyQueue(struct Queue *Q)
{
    return (Q->front==-1);
    }
int isFullQueue(struct Queue *Q)
{
    return ((Q->rear+1) % Q->size ==Q->front);
    }
void enqueue(struct Queue *Q,int data)
{
    if(isFullQueue(Q))
        {
            printf("Queue overflow\n");
            return;}
    Q->rear=Q->rear+1 % Q->size;
    Q->arr[Q->rear]=data;
    if(Q->front==-1)
        Q->front=Q->rear;
        }
int dequeue(struct Queue *Q)
{
    if(isEmptyQueue(Q)){
        printf("Queue underflow\n");
        return;
        }
    int data=Q->arr[Q->front];
    if(Q->front==Q->rear)
        Q->front=-1;
    else
    Q->front=Q->front+1 % Q->size;
    return data;
    }
///////////////////////*************main algo****************////////////////////////
struct Stack* Sconstructor(int capacity)
{
    struct Stack *S=malloc(sizeof(struct Stack));
    S->Q1=Qconstructor(capacity);
    S->Q2=Qconstructor(capacity);
    return S;
}
void push(struct Stack *S,int data)
{
    if(isEmptyQueue(S->Q1))
        enqueue(S->Q1,data);
    else
        enqueue(S->Q2,data);
    }
int pop(struct Stack *S)
{
    int i,tmp;
    if(!isEmptyQueue(S->Q2)){
        for(i=S->Q2->front;i<=S->Q2->rear;i++){
            tmp=dequeue(S->Q2);
            if(isEmptyQueue(S->Q2))
                return tmp;
            else
                enqueue(S->Q1,tmp);
                }
            }
    else{
        for(i=S->Q1->front;i<=S->Q1->rear;i++){
            tmp=dequeue(S->Q1);
            if(isEmptyQueue(S->Q1))
                return tmp;
            else
                enqueue(S->Q2,tmp);
                }
            }
        }
////////////////*************end of main algo my algo************
///////////////*************push() O(1);;;;pop() O(n);;;;*******/////
main()
{
    int size;
    printf("Enter the number of elements in the Stack(made of 2 queue's)::\n");
    scanf("%d",&size);
    struct Stack *S=Sconstructor(size);
    push(S,1);
    push(S,2);
    push(S,3);
    push(S,4);
    printf("%d\n",pop(S));
    push(S,5);
    printf("%d\n",pop(S));
    printf("%d\n",pop(S));
    printf("%d\n",pop(S));
    printf("%d\n",pop(S));
    } 
```

* * *

## 回答 #25

> 赞同：-1
> 
> 时间：2015-05-23T08:22:20.513

```
import java.util.LinkedList;
import java.util.Queue;

public class StackQueue {

    static Queue<Integer> Q1 = new LinkedList<Integer>();
    static Queue<Integer> Q2 = new LinkedList<Integer>();
    public static void main(String args[]) {

        push(24);
        push(34);
        push(4);
        push(10);
        push(1);
        push(43);
        push(21);
        System.out.println("Popped element is  "+pop());
        System.out.println("Popped element is  "+pop());
        System.out.println("Popped element is  "+pop());

    }

    public static void push(int data) {

        Q1.add(data);

    }

    public static int pop() {

        if(Q1.isEmpty()) {
        System.out.println("Cannot pop elements ,  Stack is Empty !!"); 
        return -1;
        }
        else
        {
        while(Q1.size() > 1) {
            Q2.add(Q1.remove());
        }
        int element = Q1.remove();
        Queue<Integer> temp = new LinkedList<Integer>();
        temp = Q1;
        Q1 = Q2;
        Q2 = temp;
        return element;
        }
    }
} 
```

* * *

## 回答 #26

> 赞同：-1
> 
> 时间：2015-06-21T19:16:04.483

```
#include "stdio.h"
#include "stdlib.h"

typedef struct {
    int *q;
    int size;
    int front;
    int rear;
} Queue;
typedef struct {
    Queue *q1;
    Queue *q2;
} Stack;

int queueIsEmpty(Queue *q) {
    if (q->front == -1 && q->rear == -1) {
        printf("\nQUEUE is EMPTY\n");
        return 1;
    }
    return 0;
}
int queueIsFull(Queue *q) {
    if (q->rear == q->size-1) {
        return 1;
    }
    return 0;
}
int queueTop(Queue *q) {
    if (queueIsEmpty(q)) {
        return -1;
    }
    return q->q[q->front];
}
int queuePop(Queue *q) {
    if (queueIsEmpty(q)) {
        return -1;
    }
    int item = q->q[q->front];
    if (q->front == q->rear) {
        q->front = q->rear = -1;
    }
    else {
        q->front++;
    }
    return item;
}
void queuePush(Queue *q, int val) {
    if (queueIsFull(q)) {
        printf("\nQUEUE is FULL\n");
        return;
    }
    if (queueIsEmpty(q)) {
        q->front++;
        q->rear++;
    } else {
        q->rear++;
    }
    q->q[q->rear] = val;
}
Queue *queueCreate(int maxSize) {
    Queue *q = (Queue*)malloc(sizeof(Queue));
    q->front = q->rear = -1;
    q->size = maxSize;
    q->q = (int*)malloc(sizeof(int)*maxSize);
    return q;
}
/* Create a stack */
void stackCreate(Stack *stack, int maxSize) {
    Stack **s = (Stack**) stack;
    *s = (Stack*)malloc(sizeof(Stack));
    (*s)->q1 = queueCreate(maxSize);
    (*s)->q2 = queueCreate(maxSize);
}

/* Push element x onto stack */
void stackPush(Stack *stack, int element) {
    Stack **s = (Stack**) stack;
    queuePush((*s)->q2, element);
    while (!queueIsEmpty((*s)->q1)) {
        int item = queuePop((*s)->q1);
        queuePush((*s)->q2, item);
    }
    Queue *tmp = (*s)->q1;
    (*s)->q1 = (*s)->q2;
    (*s)->q2 = tmp;
}

/* Removes the element on top of the stack */
void stackPop(Stack *stack) {
    Stack **s = (Stack**) stack;
    queuePop((*s)->q1);
}

/* Get the top element */
int stackTop(Stack *stack) {
    Stack **s = (Stack**) stack;
    if (!queueIsEmpty((*s)->q1)) {
      return queueTop((*s)->q1);
    }
    return -1;
}

/* Return whether the stack is empty */
bool stackEmpty(Stack *stack) {
    Stack **s = (Stack**) stack;
    if (queueIsEmpty((*s)->q1)) {
        return true;
    }
    return false;
}

/* Destroy the stack */
void stackDestroy(Stack *stack) {
    Stack **s = (Stack**) stack;
    free((*s)->q1);
    free((*s)->q2);
    free((*s));
}

int main()
{
  Stack *s = NULL;
  stackCreate((Stack*)&s, 10);
  stackPush((Stack*)&s, 44);
  //stackPop((Stack*)&s);
  printf("\n%d", stackTop((Stack*)&s));
  stackDestroy((Stack*)&s);
  return 0;
} 
```

# asp.net - What options are there to selectively enable or disable IIS 6 compression

> ID：688282
> 
> 赞同：2
> 
> 时间：2009-03-27T02:09:38.877
> 
> 标签：asp.net, iis-6, http-compression

Unlike IIS7, in IIS6 the 'Compress application files' and 'Compress Static files' options are server wide so they apply to every website and virtual directory.

I recently enabled it server wide and I'm beginning to see more and more places where things are being compressed that I don't want -- notably dynamically created images.

Is there any kind of configuration for compression to enable or disable it for a 'web.config' based .NET application.

I have ASP.NET 1.1, ASP.NET MVC 1.0 apps running on the machine.

I've seen various 3rd party filters to compress content selectively -- is this really the best approach. These may be appropriate for me in the future but I'd rather not invest time in them now.

I'd be fine if i could just disable compression selectively for one application I have (that dynamically creates images). Is this not possible within IIS / webconfig ?

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2009-03-27T02:49:17.813

看看这篇关于[如何在 IIS6 中启用 HTTP 压缩的](http://www.kavinda.net/2007/02/17/how-to-enable-http-compression-iis6.html)文章，它讨论了编辑 Metabase.xml 以在目录级别设置压缩。我没有尝试过，所以我不能保证这项技术，但它似乎可能有助于解决你的问题。

# flash - Flash 符号的 AS3 类

> ID：688284
> 
> 赞同：0
> 
> 时间：2009-03-27T02:10:05.397
> 
> 标签：flash, actionscript-3, class, symbols

我是 Flash 新手，我正在尝试为符号创建一个类。

我创建了一个新的 Flash 文件，删除了一个 DynamicText，将此 DynamicText 转换为一个名为“TextBox1”的符号

然后我在与刚刚创建的 .fla 相同的目录中创建了 TextBox1.as。

```
package
{
    import flash.display.*;

    public class TextBox1 extends MovieClip
    {

        public function TextBox1() 
        {
            trace("TextBox constructor");
        }

    }

} 
```

我运行了 Flash 文件，但它没有显示消息。我错过了什么吗？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2009-03-27T02:46:16.153

您是否将类与符号相关联？右键单击该符号。勾选 ActionScript 的导出并将 TextBox1 放在类字段中。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-07-22T05:41:56.747

您无需创建空白类定义即可使用资产。只需在 Linkage 下的 Class 中键入您希望调用的类，并确保 bass 类是 flash.display.MovieClip。当你按下 OK 时，Flash 会出现一个框，说它会为你创建一个默认定义，这很棒。现在您可以创建该类的实例。

[创建一个默认类 http://img266.imageshack.us/img266/9799/flashwtf.png](http://img266.imageshack.us/img266/9799/flashwtf.png)

# c - 如何在 OpenGL 中管理缓存纹理？

> ID：688287
> 
> 赞同：3
> 
> 时间：2009-03-27T02:10:46.487
> 
> 标签：c, opengl, caching, fonts, textures

我正在为 OpenGL 应用程序编写文本渲染器。大小、颜色、字体和抗锯齿可以在运行时调整（因此多个字体可以同时出现在屏幕上）。组合太多，无法为字符串和属性的每个组合分配一个纹理。但是，在任何给定时间，整个字符串数据库中只有一小部分会出现在屏幕上。

这使我有机会为逐帧打印的字符串创建缓存。强制要求我在整个操作中只使用一个纹理，因为创建许多纹理的缓存会导致从缓存中打印的每个不同字符串的纹理交换惩罚。

所以我面前有一个 2048x2048 的纹理，我可以在其中放置我可以容纳的任何字符串，因为应用程序出于缓存目的请求它们。我很快意识到跟踪二维空间中的可用空间并非易事。

我一直在研究诸如 Best Fit 和 Next fit 之类的东西，但它们似乎适合一维空间。

如何在 OpenGL 中管理这个缓存纹理？

编辑：从那以后，我了解到这是“2d 打包问题”的一个实例。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-03-27T03:39:49.253

你所拥有的是装箱问题。

首先是坏消息：它是 NP 难的，因此值得找到最佳解决方案。

我也为字体做了这样的纹理缓存。我没有缓存整个单词，而只是缓存了字形图像。这让事情变得容易多了，因为你所有的图像都是大致方形的。一种简单的基于网格的方法来跟踪纹理内存效果很好。

如果我得到的字形大于我的一个网格框，我只需使用蛮力搜索分配两个或更多框（这种情况并不经常发生）。如果我没有找到任何合适的块，我只是从缓存中随机删除一些字形以腾出空间。

这比将东西保存在最近使用的缓存中要容易得多，而且性能几乎一样好。

顺便说一句 - 对于这样的缓存，您总是会浪费一些纹理内存。除非您的内存*非常*紧张，否则这应该不是问题。您应该使用小的纹理格式（8 位 alpha 非常适合字体）。

另外：如果您将网格块设置为 8 像素的倍数，并且可以将抗锯齿降低到 4 位，则可以动态地将字形压缩为压缩的 DXT 或 S3TC 格式之一。这样，浪费的纹理空间就不是问题了。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-07-15T16:15:29.500

如果您的纹理内存不足，您可以查看“距离场”或“有符号距离场”字体渲染技术。您可以为每个字体系列使用 512x512 纹理，并且可以渲染任何大小的完美抗锯齿文本。

对于该算法，您需要生成一个特殊的纹理，其中包含从纹素到纹理边缘的距离。看看 Valve 人的原始论文：[http](http://www.valvesoftware.com/publications/2007/SIGGRAPH2007_AlphaTestedMagnification.pdf) ://www.valvesoftware.com/publications/2007/SIGGRAPH2007_AlphaTestedMagnification.pdf 。有一些框架利用了这一点。例如，最新版本的 Qt 使用有符号距离字段进行文本渲染。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-03-31T17:47:03.300

我选择使用一种简单的方法。将纹理划分为可变高度行。放置在一行中的第一个纹理决定了行的高度。如果纹理可以按高度放入现有行，请检查是否有足够的宽度剩余并将其放置在那里。否则开始一个新行。如果无法启动新行，则不要缓存字符串。

# winsock - 使用 Winsock 和 C 与 FTP 服务器通信

> ID：688290
> 
> 赞同：1
> 
> 时间：2009-03-27T02:11:18.747
> 
> 标签：winsock

我该怎么做呢？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-03-27T02:18:10.027

[C 语言中的 TCP/IP 套接字：程序员实用指南](http://cs.baylor.edu/~donahoo/practical/CSockets/winsock.html)有许多使用 Winsock 的 C 代码示例。

没有一个用于 FTP 的，但它会让您顺利上路。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-03-27T03:33:21.890

阅读[FTP RFC](http://www.w3.org/Protocols/rfc959/)。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-03-27T02:45:25.047

虽然您可以使用 Winsock，但如果您使用更高级别的 API，例如已经实现[FTP 协议的](http://msdn.microsoft.com/en-us/library/aa384180.aspx)[WinINet](http://msdn.microsoft.com/en-us/library/aa383630.aspx) ，您会做得更好。

# javascript - IE6在使用excanvas绘制图像时尝试安装缺少的office组件

> ID：688296
> 
> 赞同：6
> 
> 时间：2009-03-27T02:15:43.603
> 
> 标签：javascript

我有一个使用 excanvas 绘制一些图像的页面。在 IE6 中测试新页面时，一台计算机尝试打开 Office 2000 并安装缺少的组件。如果取消 Office 2000 安装，则会出现 vml 图像。这个问题只发生在我的一台测试机器上，但它仍然让我担心。

以前使用 IE6 和 excanvas 时有人见过这个问题吗？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-03-29T13:29:30.847

首先：以我的 OSX/Linux 背景，我根本不是 IE6 专家！:)

也就是说：对我来说，这看起来像是一个[MIME 类型的](http://en.wikipedia.org/wiki/MIME_type)问题。有没有办法将 MIME 类型与 IE6 中的应用程序相关联？如果是，请比较两个 IE6 设置的设置并查找差异。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2011-09-05T05:07:18.930

我发现 VML 与病毒有关，作为快速修复，一些人删除或重命名了 vgx.dll。当 VML 尝试运行并触发 Office 应用程序时，这会导致非常奇怪的行为。我认为这是因为 windows 找不到 dll 并试图安装或运行相关的程序。Office 使用 VML，因此有点意义。无论如何，我们打电话给微软，他们说这可能只会发生在 1% 的机器上。这是 2 年前的事了，所以现在可能要少得多。任何从 XP 和 IE6 升级的人都可能不再有这个问题，因为该 dll 将被替换为一个好的版本。

# python - 如何制作命令行文本编辑器？

> ID：688302
> 
> 赞同：20
> 
> 时间：2009-03-27T02:19:14.127
> 
> 标签：python, text-editor, tui

我已经了解了几种编程语言，我想尝试制作一个命令行文本编辑器——在终端中运行的东西，比如 vim/emacs/nano，但是是纯文本（请不要guis）。最好，我想在 python 中执行此操作。我从哪里开始？是否有任何（python）库来执行命令行应用程序？

* * *

## 回答 #1

> 赞同：23
> 
> 时间：2009-03-27T02:28:44.650

试试python [curses](http://docs.python.org/howto/curses.html) module，它是一个命令行图形操作库。

* * *

## 回答 #2

> 赞同：10
> 
> 时间：2009-03-27T02:29:02.013

看看[Python 中的 Curses Programming](http://docs.python.org/howto/curses.html)和[this](http://docs.python.org/library/curses.html)。

* * *

## 回答 #3

> 赞同：7
> 
> 时间：2009-03-27T02:48:04.103

如果您想编写 TUI（文本用户界面）而不必下降到 curses，另一个选择是[Snack](http://www.wanware.com/tsgdocs/snack.html)，它与[Newt](https://fedorahosted.org/newt/)一起提供。

* * *

## 回答 #4

> 赞同：6
> 
> 时间：2009-03-27T11:20:17.947

今天的孩子们！嘘！当我刚开始的时候，curses 并没有被广泛使用！

我的第一个文本编辑器使用实际的纸在实际的机械电传打字设备上工作（不是带有滚动屏幕的哲学“TTY”设备！）

这仍然可以很好地作为一种编辑方式。

使用该`cmd`模块来实现一堆命令。使用“ex”手册页来提示您需要什么。不要阅读有关 vi 命令的内容；避免阅读有关 vim 的内容。

仅查看“EX COMMANDS”部分的旧手册页。例如，这里： http: [//www.manpagez.com/man/1/ex/](http://www.manpagez.com/man/1/ex/)。

实现追加、添加、更改、删​​除、全局、插入、加入、列出、移动、打印、退出、替换和写入命令，您会很高兴。

* * *

## 回答 #5

> 赞同：5
> 
> 时间：2009-03-27T02:30:29.670

Curses 类型库和资源将带您进入文本用户界面，并提供非常漂亮、相对易于使用的窗口、菜单、编辑器等。

然后，您将需要查看 python 的代码突出显示模块。

处理文本界面的限制是一个有趣的过程，沿着这条路走下去你可以学到很多东西。祝你好运！

-亚当

* * *

## 回答 #6

> 赞同：3
> 
> 时间：2009-03-27T02:47:34.917

我会推荐优秀的 urwid 工具包（[http://excess.org/article/2009/03/urwid-0984-released）——](http://excess.org/article/2009/03/urwid-0984-released)它比直接诅咒更容易使用。

* * *

## 回答 #7

> 赞同：2
> 
> 时间：2009-03-27T02:29:11.077

那么，GUI 是什么意思？如果您只想创建可以在控制台上使用的东西，请查看`curses`Python 标准库中的模块，它允许您在控制台上模拟各种原始 GUI。

* * *

## 回答 #8

> 赞同：2
> 
> 时间：2009-03-27T03:00:06.540

一个不是很严肃的建议：可以在没有诅咒的情况下实现[行编辑器。](http://en.wikipedia.org/wiki/Line_editor)

当然，这些东西非常原始，而且工作起来没有什么乐趣。但是它们可以用很少的代码来实现，并且会给你一个机会来玩弄各种方案来快速维护内存中的文件状态.

他们会让你与七十年代初的程序员联系（当时他们有电传打字机和第一台玻璃电传打字机，但打孔卡有点过时了......）。

* * *

## 回答 #9

> 赞同：2
> 
> 时间：2009-03-27T03:59:25.040

不完全是对 Python 库的引用，但您可能会对 Craig A. Finseth[的 The Craft of Text Editing感兴趣。](http://www.finseth.com/craft/)

* * *

## 回答 #10

> 赞同：0
> 
> 时间：2009-05-28T01:26:35.913

另一个没有诅咒的选择是[Python 俚语](http://code.google.com/p/python-slang/)

[Newt](http://en.wikipedia.org/wiki/Newt_(programming_library))是一个基于 Slang 编写的库。

# c# - 将范围转换为位数组

> ID：688314
> 
> 赞同：0
> 
> 时间：2009-03-27T02:29:30.497
> 
> 标签：c#, bit-manipulation, bitarray

我正在用 C# 编写一段对时间要求严格的代码，它要求我将定义包含范围的两个无符号整数转换为位字段。前任：

```
uint x1 = 3;
uint x2 = 9;
  //defines the range [3-9]
  //                              98  7654 3
  //must be converted to:  0000 0011  1111 1000 
```

它可能有助于以相反的顺序可视化位

该范围的最大值是在运行时给出的参数，我们将其称为`max_val`. 因此，位域变量应该定义为一个`UInt32`大小等于的数组`max_val/32`：

```
UInt32 MAX_DIV_32 = max_val / 32;
UInt32[] bitArray = new UInt32[MAX_DIV_32]; 
```

给定由变量`x1`和定义的范围`x2`，执行此转换的最快方法是什么？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-03-27T03:58:23.310

试试这个。计算必须用全填充的数组项的范围，并通过迭代此范围来完成此操作。最后在两个边界设置项目。

```
Int32 startIndex = x1 >> 5;
Int32 endIndex = x2 >> 5;

bitArray[startIndex] = UInt32.MaxValue << (x1 & 31);

for (Int32 i = startIndex + 1; i <= endIndex; i++)
{
   bitArray[i] = UInt32.MaxValue;
}

bitArray[endIndex] &= UInt32.MaxValue >> (31 - (x2 & 31)); 
```

可能代码不是 100% 正确，但这个想法应该可行。

* * *

刚刚测试了一下，发现了三个bug。在开始索引处的计算需要一个 mod 32，在结束索引处，32 必须是 31，并且是一个逻辑 and 而不是分配来处理开始索引和结束索引相同的情况。应该挺快的。

* * *

只是用 x1 和 x2 在阵列上的相等分布对其进行了基准测试。Intel Core 2 Duo E8400 3.0 GHz，MS VirtualPC 和 Windows XP 主机上的 Server 2003 R2。

```
Array length [bits]           320         160         64
Performance [executions/s]    33 million  43 million  54 million 
```

* * *

再优化一次 x % 32 == x & 31 但我无法衡量性能提升。由于我的测试中只有 10.000.000 次迭代，因此波动非常大。而且我在 VirtualPC 中运行，这使得情况更加不可预测。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2013-01-16T09:23:38.050

我将 BitArray 中的所有位设置为真或假的解决方案：

```
public static BitArray SetRange(BitArray bitArray, Int32 offset, Int32 length, Boolean value)
{

    Int32[] ints = new Int32[(bitArray.Count >> 5) + 1];

    bitArray.CopyTo(ints, 0);

    var firstInt = offset >> 5;
    var lastInt = (offset + length) >> 5;

    Int32 mask = 0;

    if (value)
    {
        // set first and last int
        mask = (-1 << (offset & 31));
        if (lastInt != firstInt)
            ints[lastInt] |= ~(-1 << ((offset + length) & 31));
        else
            mask &= ~(-1 << ((offset + length) & 31));

        ints[firstInt] |= mask;

        // set all ints in between
        for (Int32 i = firstInt + 1; i < lastInt; i++)
            ints[i] = -1;
    }

    else
    {
        // set first and last int
        mask = ~(-1 << (offset & 31));
        if (lastInt != firstInt)
            ints[lastInt] &= -1 << ((offset + length) & 31);
        else
            mask |= -1 << ((offset + length) & 31);

        ints[firstInt] &= mask;

        // set all ints in between
        for (Int32 i = firstInt + 1; i < lastInt; i++)
            ints[i] = 0;

    }

    return new BitArray(ints) { Length = bitArray.Length };

} 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-03-27T02:43:47.593

你可以试试：

```
UInt32 x1 = 3;
UInt32 x2 = 9;
UInt32 newInteger = (UInt32)(Math.Pow(2, x2 + 1) - 1) & 
                   ~(UInt32)(Math.Pow(2, x1)-1); 
```

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2009-03-27T03:56:55.170

是否有理由不使用 System.Collections.BitArray 类而不是 UInt32[]？否则，我会尝试这样的事情：

```
int minIndex = (int)x1/32;
int maxIndex = (int)x2/32;
// first handle the all zero regions and the all one region (if any)
for (int i = 0; i < minIndex; i++) {
    bitArray[i] = 0;
}
for (int i = minIndex + 1; i < maxIndex; i++) {
    bitArray[i] = UInt32.MaxValue; // set to all 1s
}
for (int i = maxIndex + 1; i < MAX_DIV_32; i++) {
    bitArray[i] = 0;
}

// now handle the tricky parts
uint maxBits = (2u << ((int)x2 - 32 * maxIndex)) - 1; // set to 1s up to max
uint minBits = ~((1u << ((int)x1 - 32 * minIndex)) - 1); // set to 1s after min

if (minIndex == maxIndex) {
    bitArray[minIndex] = maxBits & minBits;
}
else {
    bitArray[minIndex] = minBits;
    bitArray[maxIndex] = maxBits;
} 
```

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2009-03-27T04:09:08.653

我很无聊，尝试用一个`char`数组来做它，并用它从 base 2`Convert.ToUInt32(string, int)`转换为一个。`uint`

```
uint Range(int l, int h)
{
  char[] buffer = new char[h];
  for (int i = 0; i < buffer.Length; i++)
  {
    buffer[i] = i < h - l ? '1' : '0';
  }
  return Convert.ToUInt32(new string(buffer), 2);
} 
```

一个简单的基准测试表明，我的方法比 Angrey Jim 的方法快 5%（即使你用位移位替换了第二个 Pow。）

如果上限太大`uint`而无法放入单个`int`. 这有点神秘，但我相信它有效。

```
uint[] Range(int l, int h)
{
  char[] buffer = new char[h];
  for (int i = 0; i < buffer.Length; i++)
  {
    buffer[i] = i < h - l ? '1' : '0';
  }

  int bitsInUInt = sizeof(uint) * 8;
  int numNeededUInts = (int)Math.Ceiling((decimal)buffer.Length /
                                         (decimal)bitsInUInt);
  uint[] uints = new uint[numNeededUInts];
  for (int j = uints.Length - 1, s = buffer.Length - bitsInUInt;
       j >= 0 && s >= 0;
       j--, s -= bitsInUInt)
  {
    uints[j] = Convert.ToUInt32(new string(buffer, s, bitsInUInt), 2);
  }

  int remainder = buffer.Length % bitsInUInt;
  if (remainder > 0)
  {
    uints[0] = Convert.ToUInt32(new string(buffer, 0, remainder), 2);
  }

  return uints;
} 
```

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2009-03-27T04:33:19.890

试试这个：

```
uint x1 = 3;
uint x2 = 9;

int cbToShift = x2 - x1; // 6
int nResult = ((1 << cbToShift) - 1) << x1; 

/*
  (1<<6)-1 gives you 63 = 111111, then you shift it on 3 bits left
*/ 
```

# javascript - jQuery动画问题

> ID：688319
> 
> 赞同：0
> 
> 时间：2009-03-27T02:34:06.383
> 
> 标签：javascript, jquery, animation

我有最奇怪的问题。我有一个 jQuery 函数，可以为投票的结果栏设置动画。

```
function displayResults()  { 
    $(".q_answers1 div").each(function(){
        var percentage = $(this).next().text();
        $(this).css({width: "0%"}).animate({
            width: percentage}, 'slow');
    });
} 
```

如您所见，这是一个拉长几个 div 的简单动画。它工作正常，直到我将它嵌入到我的主页上。问题似乎是有太多的 OTHER 内容破坏了流畅动画的美感。我在想我在实现 JavaScript、CSS 等方面很蹩脚，但经过几次测试和逆向工程后，我发现页面上的内容（图像、文本、视频）越多，质量越差动画是。我只能猜测原因是什么......我真的很喜欢我的动画:)！感谢帮助！

[这个演示](http://nettuts.com/demos/test_poll/)展示了它的外观。当页面上的内容较少时，我让它像这样工作。质量差是指钢筋的流动不顺畅。最坏的情况是条形图在瞬间以最终宽度出现。在 Mozilla、Chrome 和 IE7 上进行了测试 - 没有区别。

* * *

**编辑：**似乎没有实际的例子，你的双手被束缚了，所以这里有一些工作要做。只需寻找红色边框，选择一个答案并单击按钮。如果您想知道，该语言是保加利亚语。

1.  [这里](http://youchost.com/popfolk/PERFECT.php)的理想行为
2.  [我可以在这里](http://youchost.com/popfolk/GOOD.php)忍受
3.  [这里](http://youchost.com/popfolk/ANIMATE1.php)开始看起来很奇怪
4.  我不明白[这个](http://youchost.com/popfolk/index.php)

如果它们在你看来都一样，那么我的电脑就是罪魁祸首，我不必再担心这个特殊的问题，这已经花费了 2 倍的努力。如果可能，请使用 Mozilla。

* * *

**编辑 2：**我找到了这个[SO 答案](https://stackoverflow.com/questions/459224/jquery-animate-and-browser-performance/459284#459284)，它回答了我关于该`animate()`功能及其工作原理的一些问题，但问题仍未解决，至少对于我的计算机而言。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-03-27T21:33:03.620

我们在这里谈论多少内容？如果页面足够大，浏览器引擎可能根本没有足够的能力以足够快的速度重新呈现内容以提供流畅的显示。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-03-27T21:28:09.233

jQuery 制作动画的方式是定期更新内联 CSS 属性。如果您要更改样式的元素是浮动的或与页面上的其他元素有其他复杂的交互，那么动画将不会流畅。

简而言之，在你的页面上放更少的东西。您也可以尝试某种 iFrame 解决方案或切换到使用 flash 来显示结果。

不幸的是，这只是系统的限制。

# memory - 如何获取函数消耗的内存

> ID：688320
> 
> 赞同：2
> 
> 时间：2009-03-27T02:35:35.600
> 
> 标签：memory, function

我们的应用程序消耗大量内存，我们需要确定哪个函数导致内存的最大使用量。他们是否有任何方式甚至任何现有工具可以做到这一点（Windows，Native）？

**这里是环境：**

视窗

VS2008

本机 C++（基于 MFC）

非常感谢。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2009-03-27T02:39:09.850

如果您有 Visual Studio 2008 Team System，您可以使用[内置的内存分配](http://blogs.msdn.com/buckh/archive/2007/10/09/using-vsts-2008-memory-allocation-profiling.aspx)分析器。这是一篇很好的 MSDN 文章，[Find Application Bottlenecks with Visual Studio Profiler](http://msdn.microsoft.com/en-us/magazine/cc337887.aspx) using VS2008。还有一个分析器[博客](http://blogs.msdn.com/profiler/)。

[RedGate 的蚂蚁](http://www.red-gate.com/products/ANTS_Profiler/index.htm?gclid=CMLElISKwpkCFRxNagodFBUXuQ)

[内存分析器](http://memprofiler.com/)

[ValGrind](http://valgrind.org/)（免费）

编辑：由于您更新以指示 C++，请参阅此 SO[答案](https://stackoverflow.com/questions/292457/profiler-for-visual-studio-2008-c)。

也可以看看：

[.NET 内存分析工具](https://stackoverflow.com/questions/399847/-net-memory-profiling-tools)

[这里有没有人有他们喜欢用于他们的 java webapps 的最喜欢的内存分析/内存泄漏工具？](https://stackoverflow.com/questions/46642/does-anyone-here-have-a-favorite-memory-profiling-memory-leak-tool-they-like-to-u)

[最好的 .NET 内存和性能分析器？](https://stackoverflow.com/questions/49912/best-dotnet-memory-and-performance-profiler)

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-03-27T02:38:28.260

使用分析器。例如自动化 QA 的 AQTime - [http://www.automatedqa.com/products/aqtime/index.asp](http://www.automatedqa.com/products/aqtime/index.asp)。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-03-27T03:50:13.207

大多数工具/分析器仅在 .NET 应用程序上运行，在您的情况下是 n/a

我已经使用 Boundschecker 和 Purify 来检查本机应用程序的内存泄漏/内存分析（他们有试用版 AFAIK），但如果您只对一次性分析感兴趣，您也可以为此目的使用内置函数

在您的在线帮助中查找 _crtCheckMemory 以获取起始位置。

# xml - 是否有用于 xPath 选择器的在线测试仪？

> ID：688323
> 
> 赞同：84
> 
> 时间：2009-03-27T02:38:07.827
> 
> 标签：xml, xslt, xpath

我知道有一些在线正则表达式评估器.. 非常有用，可以实时匹配。它们就像 RegexBuddy 的 Web 应用程序。

我想知道 xPath 选择器是否有类似的东西？我只是在学习它们，这对我来说很有价值。

是否有在线测试器允许您输入 XML，然后输入 xPath 选择器并匹配（live 会更好，但我怀疑有人编写了 JavaScript 解释器？）它们？

谢谢

* * *

## 回答 #1

> 赞同：87
> 
> 时间：2009-08-12T14:05:24.340

我注意到答案中唯一的“在线”检查器似乎有点笨拙。它需要提交到服务器，并且不能正确处理命名空间。

我想我可以做得更好，而且这样的工具会非常有用，所以我做了一个。我意识到在这里提到它有点自我推销，但我认为它确实专门回答了这个问题！

[http://chris.photobooks.com/xml/default.htm](http://chris.photobooks.com/xml/default.htm)

我的可以将 xpath 表达式应用于任意 XML 文档并显示结果。它还可以美化或美化 XML 文档，并对它应用 XSLT 转换。所有处理都由浏览器完成，它应该可以在 IE6+、Firefox、Opera、Chrome 和 Safari 中运行。

如果您遇到任何问题，请告诉我！

* * *

## 回答 #2

> 赞同：37
> 
> 时间：2009-09-18T03:41:10.870

这不是在线工具；相反，它是一个 Windows 应用程序，更类似于 RegexBuddy，但适用于 XPath。

[XPathVisualizer](http://xpathvisualizer.codeplex.com)。

[屏幕截图 http://i29.tinypic.com/1zwp5ix.jpg](http://i29.tinypic.com/1zwp5ix.jpg)

* * *

## 回答 #3

> 赞同：28
> 
> 时间：2009-03-27T13:26:17.737

**编辑**：多亏了 Lars Huttar 的善意，IE 的 XPath Visualizer 现在有了**[一个新的、更安全的家。](http://www.huttar.net/dimitre/XPV/TopXML-XPV.html)**还有用于 FF 的 XPath Visualizer **[。](http://www.huttar.net/dimitre/XPV/TopXML-XPV.html)**

**XPath Visualizer 已面世 10 多年，并已帮助成千上万的人以有趣的方式学习 XPath。可[用于 IE](http://www.huttar.net/dimitre/XPV/TopXML-XPV.html)和[FireFox](http://www.huttar.net/dimitre/XPV/TopXML-XPV.html)**。

**XPath Visualizer 是一个流行的工具，用于通过玩 XPath 表达式来学习 XPath**。免费和开源。

**允许**针对给定的 XML 文档评估任何 XPath 表达式，并在 xml 文档（如果它们是节点）或单独的框中（如果结果是原子值）中高亮显示结果。

**允许定义 xsl:variable-s，然后**在 XPath 表达式中使用。

**允许定义 xsl:key-s，然后由**XPath 表达式中的 key() 函数引用。

* * *

## 回答 #4

> 赞同：17
> 
> 时间：2009-03-27T02:44:42.367

是的！试试 Firefox 的[**XPath Checker**](https://addons.mozilla.org/en-US/firefox/addon/1095)扩展。这是一个方便的工具。

* * *

## 回答 #5

> 赞同：5
> 
> 时间：2010-11-11T16:10:05.013

这是一个不错的：[http ://www.xpathtester.com/](http://www.xpathtester.com/)

* * *

## 回答 #6

> 赞同：2
> 
> 时间：2009-03-29T14:21:29.630

您还可以将 Notepad++ 与它的 XMLTools 插件一起使用 - 它具有 xPath 评估器

* * *

## 回答 #7

> 赞同：2
> 
> 时间：2011-05-07T19:22:58.183

我用这个

[http://xpath.online-toolz.com/tools/xpath-editor.php](http://xpath.online-toolz.com/tools/xpath-editor.php)

* * *

## 回答 #8

> 赞同：1
> 
> 时间：2009-03-27T04:28:57.840

这是一个...

[XPath 查询表达式工具](http://www.xmlme.com/XpathTool.aspx)

* * *

## 回答 #9

> 赞同：1
> 
> 时间：2009-11-20T22:43:08.743

我发现以下工具最有帮助。

[Allans 在线 XPath 测试器](http://www.mizar.dk/XPath/Default.aspx)

下面提到的其他工具要么需要特定的浏览器，要么在加载 xml 或使用我正在使用的一些更晦涩的 XPath 表达式时遇到问题。这个工具没有。

* * *

## 回答 #10

> 赞同：1
> 
> 时间：2010-01-02T10:31:59.907

[Remove It Permanently](http://rip.mozdev.org/)是 AMO 上可用的 firefox 扩展，具有这样的可视化功能。如果它具有用于稍微先进的广告拦截器的萤火虫类型的功能，那就太好了。

[截图 http://i49.tinypic.com/n65a3d.jpg](http://i49.tinypic.com/n65a3d.jpg)

* * *

## 回答 #11

> 赞同：1
> 
> 时间：2010-04-13T13:00:40.600

如果您使用的是 Firefox，则可以使用[Firebug](http://getfirebug.com/ "萤火虫") + [Firefinder](http://robertnyman.com/firefinder/ "寻火者")，它使您能够根据 XPath 表达式过滤元素，甚至可以将匹配的代码快速发布到[jsbin](http://jsbin.com/)。

# c++ - 如何将代码添加到循环中使其更快？

> ID：688325
> 
> 赞同：22
> 
> 时间：2009-03-27T02:38:44.687
> 
> 标签：c++, optimization, visual-c++, visual-c++-6

我有一个带有内部循环的简单函数 - 它缩放输入值，在查找表中查找输出值，并将其复制到目的地。（ftol_ambient 是我从网上复制的一个技巧，用于将浮点数快速转换为整数）。

```
for (i = 0;  i < iCount;  ++i)
{
    iScaled = ftol_ambient(*pSource * PRECISION3);
    if (iScaled <= 0)
        *pDestination = 0;
    else if (iScaled >= PRECISION3)
        *pDestination = 255;
    else
    {
        iSRGB = FloatToSRGBTable3[iScaled];
        *pDestination = iSRGB;
    }
    pSource++;
    pDestination++;
} 
```

现在我的查找表是有限的，而浮点数是无限的，因此可能会出现错误。我用一些代码创建了一个函数的副本来处理这种情况。请注意，唯一的区别是添加了 2 行代码 - 请忽略丑陋的指针转换。

```
for (i = 0;  i < iCount;  ++i)
{
    iScaled = ftol_ambient(*pSource * PRECISION3);
    if (iScaled <= 0)
        *pDestination = 0;
    else if (iScaled >= PRECISION3)
        *pDestination = 255;
    else
    {
        iSRGB = FloatToSRGBTable3[iScaled];
        if (((int *)SRGBCeiling)[iSRGB] <= *((int *)pSource))
            ++iSRGB;
        *pDestination = (unsigned char) iSRGB;
    }
    pSource++;
    pDestination++;
} 
```

这是奇怪的部分。我正在测试两个版本，输入相同的 100000 个元素，重复 100 次。在我的 Athlon 64 1.8 GHz（32 位模式）上，第一个函数需要 0.231 秒，第二个（更长的）函数需要 0.185 秒。这两个函数在同一个源文件中是相邻的，因此不可能有不同的编译器设置。我已经多次运行测试，颠倒它们运行的​​顺序，每次的时间都大致相同。

我知道现代处理器中有很多谜团，但这怎么可能呢？

这里比较的是来自 Microsoft VC++6 编译器的相关汇编器输出。

* * *

```
; 173  :    for (i = 0;  i < iCount;  ++i)

$L4455:

; 174  :    {
; 175  :        iScaled = ftol_ambient(*pSource * PRECISION3);

    fld DWORD PTR [esi]
    fmul    DWORD PTR __real@4@400b8000000000000000
    fstp    QWORD PTR $T5011[ebp]

; 170  :    int i;
; 171  :    int iScaled;
; 172  :    unsigned int iSRGB;

    fld QWORD PTR $T5011[ebp]

; 173  :    for (i = 0;  i < iCount;  ++i)

    fistp   DWORD PTR _i$5009[ebp]

; 176  :        if (iScaled <= 0)

    mov edx, DWORD PTR _i$5009[ebp]
    test    edx, edx
    jg  SHORT $L4458

; 177  :            *pDestination = 0;

    mov BYTE PTR [ecx], 0

; 178  :        else if (iScaled >= PRECISION3)

    jmp SHORT $L4461
$L4458:
    cmp edx, 4096               ; 00001000H
    jl  SHORT $L4460

; 179  :            *pDestination = 255;

    mov BYTE PTR [ecx], 255         ; 000000ffH

; 180  :        else

    jmp SHORT $L4461
$L4460:

; 181  :        {
; 182  :            iSRGB = FloatToSRGBTable3[iScaled];
; 183  :            *pDestination = (unsigned char) iSRGB;

    mov dl, BYTE PTR _FloatToSRGBTable3[edx]
    mov BYTE PTR [ecx], dl
$L4461:

; 184  :        }
; 185  :        pSource++;

    add esi, 4

; 186  :        pDestination++;

    inc ecx
    dec edi
    jne SHORT $L4455 
```

* * *

```
$L4472:

; 199  :    {
; 200  :        iScaled = ftol_ambient(*pSource * PRECISION3);

    fld DWORD PTR [esi]
    fmul    DWORD PTR __real@4@400b8000000000000000
    fstp    QWORD PTR $T4865[ebp]

; 195  :    int i;
; 196  :    int iScaled;
; 197  :    unsigned int iSRGB;

    fld QWORD PTR $T4865[ebp]

; 198  :    for (i = 0;  i < iCount;  ++i)

    fistp   DWORD PTR _i$4863[ebp]

; 201  :        if (iScaled <= 0)

    mov edx, DWORD PTR _i$4863[ebp]
    test    edx, edx
    jg  SHORT $L4475

; 202  :            *pDestination = 0;

    mov BYTE PTR [edi], 0

; 203  :        else if (iScaled >= PRECISION3)

    jmp SHORT $L4478
$L4475:
    cmp edx, 4096               ; 00001000H
    jl  SHORT $L4477

; 204  :            *pDestination = 255;

    mov BYTE PTR [edi], 255         ; 000000ffH

; 205  :        else

    jmp SHORT $L4478
$L4477:

; 206  :        {
; 207  :            iSRGB = FloatToSRGBTable3[iScaled];

    xor ecx, ecx
    mov cl, BYTE PTR _FloatToSRGBTable3[edx]

; 208  :            if (((int *)SRGBCeiling)[iSRGB] <= *((int *)pSource))

    mov edx, DWORD PTR _SRGBCeiling[ecx*4]
    cmp edx, DWORD PTR [esi]
    jg  SHORT $L4481

; 209  :                ++iSRGB;

    inc ecx
$L4481:

; 210  :            *pDestination = (unsigned char) iSRGB;

    mov BYTE PTR [edi], cl
$L4478:

; 211  :        }
; 212  :        pSource++;

    add esi, 4

; 213  :        pDestination++;

    inc edi
    dec eax
    jne SHORT $L4472 
```

* * *

**编辑：**试图测试[Nils Pipenbrinck 的假设](https://stackoverflow.com/questions/688325/how-can-adding-code-to-a-loop-make-it-faster/688416#688416)，我在第一个函数的循环之前和内部添加了几行：

```
int one = 1;
int two = 2;

        if (one == two)
            ++iSRGB; 
```

第一个函数的运行时间现在降至 0.152 秒。有趣的。

* * *

**编辑 2：** Nils 指出，比较将在发布版本中进行优化，确实如此。汇编代码的变化非常微妙，我将它贴在这里，看看它是否提供任何线索。在这一点上，我想知道它是否是代码对齐？

```
; 175  :    for (i = 0;  i < iCount;  ++i)

$L4457:

; 176  :    {
; 177  :        iScaled = ftol_ambient(*pSource * PRECISION3);

    fld DWORD PTR [edi]
    fmul    DWORD PTR __real@4@400b8000000000000000
    fstp    QWORD PTR $T5014[ebp]

; 170  :    int i;
; 171  :    int iScaled;
; 172  :    int one = 1;

    fld QWORD PTR $T5014[ebp]

; 173  :    int two = 2;

    fistp   DWORD PTR _i$5012[ebp]

; 178  :        if (iScaled <= 0)

    mov esi, DWORD PTR _i$5012[ebp]
    test    esi, esi
    jg  SHORT $L4460

; 179  :            *pDestination = 0;

    mov BYTE PTR [edx], 0

; 180  :        else if (iScaled >= PRECISION3)

    jmp SHORT $L4463
$L4460:
    cmp esi, 4096               ; 00001000H
    jl  SHORT $L4462

; 181  :            *pDestination = 255;

    mov BYTE PTR [edx], 255         ; 000000ffH

; 182  :        else

    jmp SHORT $L4463
$L4462:

; 183  :        {
; 184  :            iSRGB = FloatToSRGBTable3[iScaled];

    xor ecx, ecx
    mov cl, BYTE PTR _FloatToSRGBTable3[esi]

; 185  :            if (one == two)
; 186  :                ++iSRGB;
; 187  :            *pDestination = (unsigned char) iSRGB;

    mov BYTE PTR [edx], cl
$L4463:

; 188  :        }
; 189  :        pSource++;

    add edi, 4

; 190  :        pDestination++;

    inc edx
    dec eax
    jne SHORT $L4457 
```

* * *

## 回答 #1

> 赞同：11
> 
> 时间：2009-03-27T03:20:41.280

我的猜测是，在第一种情况下，两个不同的分支最终位于 CPU 上的同一个分支预测槽中。如果这两个分支每次预测不同，代码就会变慢。

在第二个循环中，添加的代码可能足以将其中一个分支移动到不同的分支预测槽。

为了确保您可以尝试使用 Intel VTune 分析器或 AMD CodeAnalyst 工具。这些工具将向您展示代码中究竟发生了什么。

但是，请记住，进一步优化此代码很可能不值得。如果您将代码调整为在 CPU 上更快，它可能同时在不同品牌上变得更慢。

* * *

**编辑：**

如果您想阅读分支预测，请尝试 Agner Fog 的优秀网站：[http ://www.agner.org/optimize/](http://www.agner.org/optimize/)

这个pdf详细解释了分支预测槽分配：[http ://www.agner.org/optimize/microarchitecture.pdf](http://www.agner.org/optimize/microarchitecture.pdf)

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2009-03-27T02:47:37.693

我的第一个猜测是，在第二种情况下，分支预测得更好。可能是因为嵌套的 if 给出了处理器使用更多信息来猜测的任何算法。只是出于好奇，当你删除线会发生什么

`if (((int *)SRGBCeiling)[iSRGB] <= *((int *)pSource))`

?

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2009-03-27T03:50:22.160

你是如何安排这些例程的？我想知道分页或缓存是否对时间有影响？调用第一个例程可能会将两者都加载到内存中，越过页面边界或导致堆栈进入无效页面（导致页入），但只有第一个例程付出了代价。

您可能希望在进行测量之前运行这两个函数一次，以减少虚拟内存和缓存可能产生的影响。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2009-03-27T03:15:10.123

你只是在测试这个内部循环，还是在测试你未公开的外部循环？如果是这样，请查看以下三行：

```
if (((int *)SRGBCeiling)[iSRGB] <= *((int *)pSource))  
    ++iSRGB;
*pDestination = (unsigned char) iSRGB; 
```

现在，它看起来像是**`*pDestination`**外循环的计数器。因此，有时通过额外增加**`iSRGB`**值，您可以跳过外部循环中的一些迭代，从而减少代码需要完成的工作总量。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2009-10-29T05:05:02.853

我曾经有过类似的情况。我从循环中提取了一些代码以使其更快，但它变慢了。令人困惑。事实证明，循环的平均次数小于 1。

教训（显然，您不需要）是更改不会使您的代码更快，除非您测量它实际上运行得更快。

# c# - 在异常处理中显示行号

> ID：688336
> 
> 赞同：19
> 
> 时间：2009-03-27T02:44:12.773
> 
> 标签：c#, .net, exception, exception-handling, line-numbers

如何显示导致错误的行号，这甚至可以通过 .NET 编译其 .exes 的方式来实现吗？

如果没有，Exception.Message 是否有一种自动化的方式来显示出错的子？

```
try
{
  int x = textbox1.Text;
}
catch(Exception ex)
{
     MessageBox.Show(ex.Message);
} 
```

* * *

## 回答 #1

> 赞同：48
> 
> 时间：2009-03-27T02:47:06.213

用于`ex.ToString()`获取完整的堆栈跟踪。

即使在发布模式下，您也必须使用调试符号（.pdb 文件）进行编译以获取行号（这是项目构建属性中的一个选项）。

* * *

## 回答 #2

> 赞同：31
> 
> 时间：2010-08-06T17:42:13.610

要查看给定异常的堆栈跟踪，请使用[e.StackTrace](http://msdn.microsoft.com/en-us/library/system.exception.stacktrace.aspx)

如果您需要更详细的信息，可以使用[System.Diagnostics.StackTrace](http://msdn.microsoft.com/en-us/library/system.diagnostics.stacktrace.aspx)类（这里有一些代码供您尝试）：

```
try
{
    throw new Exception();
}
catch (Exception ex)
{
    //Get a StackTrace object for the exception
    StackTrace st = new StackTrace(ex, true);

    //Get the first stack frame
    StackFrame frame = st.GetFrame(0);

    //Get the file name
    string fileName = frame.GetFileName();

    //Get the method name
    string methodName = frame.GetMethod().Name;

    //Get the line number from the stack frame
    int line = frame.GetFileLineNumber();

    //Get the column number
    int col = frame.GetFileColumnNumber();
} 
```

这仅在有可用于程序集的 pdb 文件时才有效。查看项目属性 - 构建选项卡 - 高级 - 调试信息选择以确保存在 pdb 文件。

* * *

## 回答 #3

> 赞同：4
> 
> 时间：2009-03-27T02:47:39.003

如果您使用[“StackTrace”](http://msdn.microsoft.com/en-us/library/system.exception.stacktrace.aspx)并将 .pdb 文件包含在工作目录中，则堆栈跟踪应包含行号。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2014-12-20T18:20:03.693

```
string lineNumber=e.StackTrace.Substring(e.StackTrace.Length - 7, 7); 
```

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2019-09-19T17:06:02.883

这样你就可以从异常中获取行号

```
public int GetLineNumber(Exception ex)
{

    const string lineSearch = ":line ";
    var index = ex.StackTrace.LastIndexOf(lineSearch);
    int ln=0;
    if (index != -1)
    {

        var lineNumberText = ex.StackTrace.Substring(index + lineSearch.Length);
        string lnum = System.Text.RegularExpressions.Regex.Match(lineNumberText, @"\d+").Value;
        int.TryParse(lnum,out ln);

    }
    return ln;
} 
```

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2021-03-18T07:20:35.367

如果生成异常的库是使用调试符号编译的，则行号将包含在堆栈跟踪中。这可以是单独的文件 (*.pdb) 或嵌入到库中。

对于 .NET Core、.NET 5 及更高版本，要在发布版本中具有完整的异常行号，请按如下方式配置项目：

```
<PropertyGroup>    
  <DebugSymbols>true</DebugSymbols>
  <DebugType>embedded</DebugType>

    <!-- Only enable the following if the line numbers mismatch -->
    <!--<Optimize>false</Optimize>-->

    <!--
      Additional properties which may impact how printed line numbers match the source code line numbers are listed here:
      https://docs.microsoft.com/en-us/dotnet/core/run-time-config/compilation
    -->
</PropertyGroup> 
```

上述配置将直接在构建文件中包含调试符号，这些文件可以作为 nugets 发布。

上述方法的替代方法是将调试包与主要的 nuget 包一起恢复，目前尚不支持：[https ://github.com/NuGet/Home/issues/9667](https://github.com/NuGet/Home/issues/9667)

现在获取异常行号：

```
try
{
    throw new Exception();
}
catch (Exception ex)
{
    // Get stack trace for the exception with source file information
    var st = new StackTrace(ex, true);
    // Get the top stack frame
    var frame = st.GetFrame(0);
    // Get the line number from the stack frame
    var line = frame.GetFileLineNumber();
} 
```

# c++ - 我如何强制我的应用程序出现在前面并集中注意力？

> ID：688337
> 
> 赞同：8
> 
> 时间：2009-03-27T02:44:29.090
> 
> 标签：c++, windows, mfc, propertysheet, dialogbasedapp

我正在开发一个应用程序，它恰好是我也在开发的安装程序的引导程序。该应用程序进行了几次 MSI 调用以获取我需要的信息，以便将作为我的应用程序主窗口的向导组合在一起，这会导致在收集信息时打开一个进度窗口，然后在完成后消失。然后设置并启动向导。我的问题是向导（从 CPropertySheet 派生）不想在我不添加一些调用的情况下出现在最前面并成为活动应用程序。

我已经在我的 OnInitDialog() 方法中使用以下代码解决了将其置于最前面的问题：

```
SetWindowPos(&wndTopMost, 0, 0, 0, 0, SWP_NOMOVE | SWP_NOSIZE); // force window to top
SetWindowPos(&wndNoTopMost, 0, 0, 0, 0, SWP_NOMOVE | SWP_NOSIZE); // lose the topmost status that the previous line gave us 
```

我的问题是我还没有弄清楚如何让窗口自动激活（即，让自己成为焦点）。SetFocus() 在这种情况下不起作用。我需要一些东西来强制窗口到 Z 顺序的顶部并激活它，最好是在尽可能少的调用中。

我的猜测是 MSI 调用在开始时打开的进度窗口导致主窗口出错，但我无法阻止该窗口出现。此外，隐藏它是没有意义的，因为它让用户在主窗口到达之前知道发生了什么。

* * *

## 回答 #1

> 赞同：11
> 
> 时间：2013-12-19T21:15:43.013

安德鲁并不完全正确。Windows 确实非常努力地阻止您窃取焦点，但可以使用以下方法。

1.  附加到当前具有焦点的窗口的线程。
2.  使您的窗口成为焦点。
3.  从线程中分离。

其代码将如下所示：

```
DWORD dwCurrentThread = GetCurrentThreadId();
DWORD dwFGThread      = GetWindowThreadProcessId(GetForegroundWindow(), NULL);

AttachThreadInput(dwCurrentThread, dwFGThread, TRUE);

// Possible actions you may wan to bring the window into focus.
SetForegroundWindow(hwnd);
SetCapture(hwnd);
SetFocus(hwnd);
SetActiveWindow(hwnd);
EnableWindow(hwnd, TRUE);

AttachThreadInput(dwCurrentThread, dwFGThread, FALSE); 
```

您可能需要也可能不需要以管理权限运行您的程序才能使其正常工作，但我已经亲自使用过这段代码，它已经完成了工作。

* * *

## 回答 #2

> 赞同：7
> 
> 时间：2009-03-27T03:17:19.977

你不能偷走焦点。时期。

请参阅这篇旧新事物文章：

[https://blogs.msdn.microsoft.com/oldnewthing/20090220-00/?p=19083](https://web.archive.org/web/20190209213353/https://blogs.msdn.microsoft.com/oldnewthing/20090220-00/?p=19083)

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-03-27T02:50:39.777

ShowWindow(youwindow,SW_SHOWNORMAL) 不工作吗？-大学教师

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2009-03-27T03:05:49.973

您会发现，BringWindowToTop 或 SetForegroundWindow 具有必须满足的要求，才能将窗口实际强制置于所有其他窗口（应用程序）的前面。如果不满足这些条件，Windows 只会在任务栏中闪烁应用程序的图标。[本文](http://www.tek-tips.com/faqs.cfm?fid=4262)介绍了一种解决方法，但正如 1800 INFORMATION 指出的那样，不建议这样做。我想你只需要接受它。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2021-02-19T14:22:14.773

应用程序“窃取”焦点是有充分理由的。我的应用程序是一个加载许多驱动程序 DLL 的服务器。另一个连接到服务器的应用程序有一个按钮，该按钮向服务器发送消息以显示其中一个 DLL（由服务器拥有，而不是客户端应用程序拥有）中的详细信息，以方便使用。不幸的是，这个弹出的打开窗口通常隐藏在多个窗口下。

# locking - 在 Unix 上正确处理 PID 文件的参考

> ID：688343
> 
> 赞同：59
> 
> 时间：2009-03-27T02:45:40.117
> 
> 标签：locking, daemon, unix

我在哪里可以找到一个**备受推崇的参考资料**，详细说明在 Unix 上正确处理 PID 文件？

在 Unix 操作系统上，通常的做法是使用特殊的锁定文件“锁定”程序（通常是守护进程）：PID 文件。

这是一个位于可预测位置的文件，通常是“/var/run/foo.pid”。程序应该在启动时检查 PID 文件是否存在，如果文件存在，则退出并出错。所以它是一种咨询、协作的锁定机制。

该文件包含单行文本，即当前持有锁的进程的数字进程 ID（因此称为“PID 文件”）；这允许一种简单的方法来自动向持有锁的进程发送信号。

我找不到关于处理 PID 文件的预期或“最佳实践”行为的良好参考。有各种细微差别：如何实际锁定文件（不要打扰？使用内核？平台不兼容怎么办？），处理陈旧的锁（静默删除它们？何时检查？），何时获取和释放锁，等等。

对于这个小话题，我在哪里可以找到**受人尊敬、最权威的参考资料（最好是 W. Richard Stevens 的水平）？**

* * *

## 回答 #1

> 赞同：23
> 
> 时间：2009-03-27T02:52:25.857

首先，在所有现代 UNIX 上`/var/run`都不会在重新启动后持续存在。

处理 PID 文件的一般方法是在初始化期间创建它并从任何退出（正常或信号处理程序）中删除它。

有两种规范的方法可以原子地创建/检查文件。这些天主要是用`O_EXCL`标志打开它：如果文件已经存在，则调用失败。旧方法（在没有 的系统上是强制性的`O_EXCL`）是使用随机名称创建它并链接到它。如果目标存在，链接将失败。

* * *

## 回答 #2

> 赞同：18
> 
> 时间：2009-03-27T03:22:09.623

据我所知，PID 文件是一种约定，而不是您可以找到受人尊敬的、主要是权威来源的东西。我能找到的最接近的是文件系统层次标准的[这一部分](http://www.pathname.com/fhs/2.2/fhs-5.13.html)。

[这个 Perl 库](http://search.cpan.org/~ecalder/Proc-PID-File/)可能会有所帮助，因为看起来作者至少考虑了一些可能出现的问题。

我相信 /var/run 下的文件通常由发行版维护者而不是守护进程的作者处理，因为发行版维护者有责任确保所有 init 脚本一起运行良好。我查看了 Debian 和 Fedora 的开发人员文档，找不到任何详细的指南，但您可以在他们的开发人员邮件列表中获得更多信息。

* * *

## 回答 #3

> 赞同：12
> 
> 时间：2012-11-30T19:23:23.963

请参阅 Kerrisk 的[The Linux Programming Interface](http://www.man7.org/tlpi/)，第 55.6 节[“只运行一个程序实例”](http://www.man7.org/tlpi/code/online/dist/filelock/create_pid_file.c.html)，它基于 Stevens 的 Unix Network Programming, v2 中的 pidfile 实现。

另请注意，pidfile 的位置通常由发行版处理（通过 init 脚本），因此编写良好的守护程序将采用命令行参数来指定 pidfile，并且不允许它被配置文件意外覆盖。它还应该自己优雅地处理陈旧的 pid 文件（不应使用 O_EXCL）。应该使用 fcntl() 文件锁定——您可以假设守护程序的 pidfile 位于本地（非 NFS）文件系统上。

* * *

## 回答 #4

> 赞同：7
> 
> 时间：2009-03-27T03:13:46.943

根据发行版，它实际上是处理 pidfile 的 init 脚本。它在启动时检查是否存在，在停止时删除等。我不喜欢那样做。我编写自己的初始化脚本，通常不使用标准初始化函数。

一个写得很好的程序（守护进程）会有某种配置文件，说明这个 pidfile（如果有的话）应该写在哪里。它还将注意建立信号处理程序，以便在可以处理信号时在正常或异常退出时清理 PID 文件。然后 PID 文件为 init 脚本提供正确的 PID，以便它可以停止。

因此，如果 pidfile 在启动时已经存在，它可以很好地指示程序之前崩溃并且应该进行某种恢复工作（如果适用）。如果您有 init 脚本本身检查 PID 的存在或取消链接，那么您有点在脚下拍摄该逻辑。

至于名称空间，它应该跟在程序名称之后。如果您正在启动 'foo-daemon'，它将是 foo-daemon.pid

您还应该探索 /var/lock/subsys，但它主要用于 Red Hat 风格。

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2018-04-04T08:15:31.147

Red Hat 7 上的`systemd`软件包提供了一个手册页`daemon(7)`，其标题行是“编写和打包系统守护程序”。

该手册页讨论了“旧式”（SysV）和“新式”（systemd）守护进程。在新风格中，systemd 本身会为您处理 PID 文件（如果配置为这样做）。但是，在旧式中，手册页有这样的说法：

> 12.  在守护进程中，将守护进程 PID（由 getpid() 返回）写入 PID 文件，例如 /run/foobar.pid（对于假设的守护进程“foobar”），以确保守护进程不能多次启动. 这必须以无竞争方式实现，以便 PID 文件仅在验证之前存储在 PID 文件中的 PID 不再存在或属于外部进程时才更新。

您也可以[在线](http://0pointer.de/public/systemd-man/daemon.html#SysV%20Daemons)阅读此手册页。

# java - JSP套接字只发送一次字符串

> ID：688351
> 
> 赞同：0
> 
> 时间：2009-03-27T02:47:45.697
> 
> 标签：java, sockets, jsp

大家好，提前感谢。

这是找出问题所在或找到更好解决方案的最后努力。

我正在使用 JSP 过滤器来过滤对 tomcat Web 服务器的 Web 访问。

我有一个客户端、一个服务器和过滤器。

客户端和过滤器打开服务器接收它们的套接字。

我听说在 JSP 文件中打开服务器套接字是不行的，但我想不出更好的方法让它向服务器软件发送字符串，如果你知道请告诉

但手头的问题是，当页面被过滤时，它只发送字符串最初而不是之后的任何时候

我在过滤器中打开了套接字，并且服务器程序中的接收器在一个线程中，因此它应该在接收到字符串时获取并打印字符串。

我所有的代码都压缩在这里，你需要 tomcat 才能运行。

[http://www.easy-share.com/1904209945/JNetProtect.zip](http://www.easy-share.com/1904209945/JNetProtect.zip)

对于这个问题的长度和复杂性，我真的很抱歉，如果有任何更好的方法可以做到这一点，请说出来，

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-03-27T03:01:24.353

从您的解释看来，您缺少一些重要的概念。如果这听起来冒犯你，请原谅我。

JSP 页面在服务器上处理，这意味着如果您在 JSP 中打开一个套接字，并不意味着客户端正在打开该套接字。

但是，您不能使用命令模式（可能使用 Servlet 过滤器）将您的请求定向到特定的 Command 对象，然后在那里执行您的套接字操作。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-03-27T04:24:56.320

好吧，我没有得到任何例外，

但是你会建议我用这个过滤器做什么，以便我可以在 DoFilter() 中执行 outSide.println()？

```
import java.net.*;
import java.io.*;
import java.util.*;
import javax.servlet.*;
import javax.servlet.http.*;

public final class IEFilter implements Filter
{
  public void doFilter(ServletRequest request, ServletResponse response,
    FilterChain chain) throws IOException, ServletException
  {
    ServerSocket fs;
    String browser = "";
    String blockInfo;
String address =  request.getRemoteAddr();

    if(((HttpServletRequest)request).getHeader ("User-Agent").indexOf("MSIE") >= 0)
    {
            browser = "Internet Explorer";
    }

    if(browser.equals("Internet Explorer")) 
    {

       BufferedWriter fW = new BufferedWriter(new FileWriter("C://logs//IElog.rtf"));
       blockInfo = "Blocked IE user from:" + address;           
       response.setContentType("text/html");
       PrintWriter out = response.getWriter();
       out.println("<HTML>");
       out.println("<HEAD>");
       out.println("<TITLE>");
       out.println("This page is not available - JNetProtect");
       out.println("</TITLE>");
       out.println("</HEAD>");
       out.println("<BODY>");
       out.println("<center><H1>Error 403</H1>");
       out.println("<br>");
       out.println("<br>");
       out.println("<H1>Access Denied</H1>");
       out.println("<br>");
       out.println("Sorry, that resource may not be accessed now.");
       out.println("<br>");
       out.println("<br>");
       out.println("<hr />");
       out.println("<i>Page Filtered By JNetProtect</i>");
       out.println("</BODY>");
       out.println("</HTML>");

       // outSide.println("Blocked and Internet Explorer user");

       fW.write(blockInfo);
       fW.newLine();
       fW.close();

    } else {          
       chain.doFilter(request, response);          
    }
  }

  public void destroy()
  {
        outsocket.close();
        outSide.close();
  }

  public void init(FilterConfig filterConfig)
  {

    try
    {

    Socket outsocket;
    PrintWriter outSide ;

    outsocket = new Socket("Localhost", 1337);
    outSide = new PrintWriter(outsocket.getOutputStream(), true);

    }catch (Exception e){
     System.out.println("error with this connection");  
     e.printStackTrace();
   }

  }
} 
```

# asp.net - 一个简单的.net 网站源代码控制系统？

> ID：688352
> 
> 赞同：2
> 
> 时间：2009-03-27T02:47:59.690
> 
> 标签：asp.net, asp.net-mvc, version-control

我在 Visual Studio 中工作，主要是我自己在网站上工作，偶尔我会开始为网站开发新功能，然后在实时网站上弹出一个错误，现在我正处于更改之中，无法发布修复错误，直到我开始改变的一切都完成了。

所以我正在寻找一种很好的简单方法来处理这种情况 - 有什么建议吗？

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2009-03-27T02:52:52.563

您是否要求推荐源代码控制系统？SourceGear Vault[对单个用户免费](http://www.sourcegear.com/faq.html#singleuser)。

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2009-03-27T02:54:21.360

我是颠覆的忠实粉丝。还有用于 VS 的插件与 subversion 存储库一起使用。

[http://subversion.tigris.org/](http://subversion.tigris.org/)
[http://ankhsvn.open.collab.net/](http://ankhsvn.open.collab.net/)

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2009-03-27T02:52:27.963

我处于类似情况，我使用[Perforce](http://www.perforce.com/)。它最多可供两个用户免费使用，并且与 Visual Studio 很好地集成。

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2009-03-27T04:04:04.500

Subversion 得到很好的支持，并且具有适用于大多数环境的工具。它也很容易使用，因此您应该能够快速启动和运行。

如果您需要同时处理许多单独的功能和错误，您可以尝试使用 Mercurial。工具支持还不够成熟，但我发现分布式设计可以更好地合并和促进同时处理不同问题的工作。

但实际上，如果您目前没有使用任何东西并且不确定您的需求是什么，只需选择一个在您使用的 IDE/工具中支持的。它可能是颠覆。

# c# - .NET 中的动画效果？

> ID：688356
> 
> 赞同：2
> 
> 时间：2009-03-27T02:49:22.307
> 
> 标签：c#, .net, graphics, animation, demoscene

有人可以给我指出一个带有简单图像动画的 C# 开源实现。

例如，我将输入图像提供给动画师，动画代码会生成几十张图像，如果按顺序显示，这些图像看起来就像动画。

我不是什么特别花哨的东西——像动画这样的简单 DirectX 过滤器就可以了。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-07-20T21:27:48.490

嗯...我不确定这是否是您想要的，但我已经创建了一个名为 Transitions 的库，它可以让您轻松地为 UI 控件的大多数属性设置动画。您可以使用它来移动图片的位置，图片之间的过渡或放大和缩小图片。但我不确定这正是你所追求的效果？无论如何，如果有任何帮助，我的图书馆就在这里： [http ://code.google.com/p/dot-net-transitions/](http://code.google.com/p/dot-net-transitions/)

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-03-27T04:32:49.390

那你会找精灵吗？微软有这方面的教程，包括：

[http://msevents.microsoft.com/cui/WebCastEventDetails.aspx?culture=en-US&EventID=1032273446&CountryCode=US](http://msevents.microsoft.com/cui/WebCastEventDetails.aspx?culture=en-US&EventID=1032273446&CountryCode=US)

和 C# 中的一般图形在这里：

[http://www.microsoft.com/events/series/msdnvisualcsharp.aspx?tab=webcasts](http://www.microsoft.com/events/series/msdnvisualcsharp.aspx?tab=webcasts)

# .net - TabControl 中的 WPF zIndex

> ID：688359
> 
> 赞同：1
> 
> 时间：2009-03-27T02:50:57.403
> 
> 标签：.net, wpf, popup, z-index

我试图让 zIndexing 在自定义 UserControl 上工作，但是当它在 TabControl 内弹出时，它会剪切控件的底部，如图所示：

![控制演示](https://i.stack.imgur.com/Ucnjz.jpg)

这是我的 XAML

```
<StackPanel Panel.ZIndex="1">
    <TabControl Name="TabCtrlMain" Panel.ZIndex="2">
        <TabItem Name="TabItmOrdrLst" Visibility="Collapsed" Panel.ZIndex="3" >
            <StackPanel Panel.ZIndex="4">
                <ri:OrderList x:Name="OrderList" Panel.ZIndex="5" />
                <Rectangle Fill="Orange" Height="80" Width="300" />
            </StackPanel>
        </TabItem>
    </TabControl>
    <Rectangle Fill="Blue" Height="80" Width="300" />
</StackPanel> 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-03-27T06:07:43.687

从您的示例中不清楚您期望 ZIndex 做什么。ZIndex 仅影响同一容器中元素的相对堆叠，因此您在示例中拥有的任何 ZIndex 设置都不会产生任何影响。OrderList 将被 TabItem 裁剪，无论它与其任何子项之间的 ZIndex 的相对值如何。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2009-03-27T06:10:57.220

从您发布的图像中，用户控件看起来好像有某种模拟弹出窗口（注释窗格），它是 UserControl 的子级。如果是这种情况，如果 Notes 面板不是 OrderList 布局计算的一部分，它可能会解释剪裁。考虑使 Notes 控件成为真正的弹出窗口，或者使用类似 Expander 的东西，当展开时，它可以告诉它的父级（UserControl）它需要更多空间来呈现。

值得注意的是，像 StackPanel 这样的容器将始终“堆叠”它们的子控件（因此得名），这意味着子控件永远不会重叠。出于这个原因，在它的任何子节点上设置 Z-index 是没有意义的。我建议使用 Grid 或 Canvas 作为您想要重叠控件的容器，然后设置它们的 Z-Index。另外，请记住 Z-Index 仅在控件的直接父级上下文中相关，因此如上例中的所有控件 Panel.Zindex="n" 将不起作用。

据我所知，这个问题是布局问题，而不是 Z-index 问题。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2009-03-27T06:10:38.830

也许您想将 UserControl 从 StackPanel 中分离出来。您可以在 Z 平面中使用元素放置的方法是使用 Grid 作为最外面的容器（如果您还没有这样做的话）并将其用作布局元素的指南。由于网格内的项目可以占据相同的空间并根据它们的声明顺序进行 z 排序，因此您可能能够获得您正在寻找的功能。

不确定这是否符合您的要求，但值得一试。容器中的项目将在其父容器的边界处被剪裁，因此要完成您要查找的内容，我认为 UserControl 必须是 StackPanel 的兄弟而不是它的子项。

# string - 如何在 JSP 过滤器和 JAVA 程序之间进行通信

> ID：688379
> 
> 赞同：0
> 
> 时间：2009-03-27T02:57:52.897
> 
> 标签：string, jsp, send

有没有办法从 JSP 过滤器向 JAVA 程序发送字符串？

我试过插座；没用。

我尝试了外部文件；没用。

所以，在这个问题上，我有点走到了威特的尽头。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2009-03-27T03:07:53.527

*将字符串发送到 Java 程序*是什么意思？该程序是否在单独的进程中？

如果是这种情况并且您需要同步通信，则绝对可以使用 TCP 套接字或仅使用 UDP。将服务器套接字放在您的*Java 程序*上。

如果您可以在 Tomcat 服务器上将您的 Java 程序作为单独的线程运行，那么这将是一个更好更快的解决方案*。*只需将*JAR*文件添加到您的*Java 程序*所在的位置，然后在带有 REQUEST 队列的单独线程上启动它即可与过滤器进行交互。

# javascript - 在 Flash 上跟踪设置区域内的 mousedown 坐标

> ID：688385
> 
> 赞同：1
> 
> 时间：2009-03-27T03:01:30.467
> 
> 标签：javascript, flash, event-handling, onmousedown

我的页面有一个带有居中固定内容区域（其余背景）的全屏 Flash 对象。

在不接触 Flash 源的情况下，我想添加“链接”来设置内容区域内的位置以运行脚本（例如 ajax、事件跟踪）——类似于图像映射。

**需要：** - 任何页面点击都会将点击的 x/y 坐标与查找表进行比较，如果坐标在“链接”区域内，请运行脚本 - 记住坐标是 Flash 内的固定内容区域，而不是相对于浏览器。*Flash 动画和交互性是否仍能正常工作？*

**尝试的选项：**

*   设置 flash wmode=transparent 并放置一个包含覆盖活动区域的链接的 div *这在 IE 中有效，但 Firefox 禁用了 div 层下 Flash 文件的交互性*

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-03-27T08:04:48.197

AFAIK Internet Explorer 是唯一允许透明内容下的元素接收点击事件的浏览器，因此图像映射不起作用。

我不相信有办法完成你想做的事情。

不过，如果您可以编辑 flash 源，您可以在那里捕获事件，然后通过 ExternalInterface 将点击的坐标发送到 javascript。

# .net - C++ 是否转换为 MSIL？

> ID：688386
> 
> 赞同：14
> 
> 时间：2009-03-27T03:03:25.160
> 
> 标签：.net, c++, compiler-construction, cil

我一直是 C# 和 .Net 开发人员，并且一直在玩学习 C++ 的想法。

我一直在考虑这个的主要原因之一是，C++ 可以比使用 .Net 框架的应用程序快多少。但是我是否正确假设如果我在 Visual Studio 中编写 C++ 应用程序，和/或在 C++ 应用程序中引用 .Net 库，该 C++ 会在 MSIL 中转换（就像 C# 一样） - 因此我会失去任何好处从里面编码？

所以我的问题实际上是这样的：引用.Net程序集的应用程序的C++组件是以“传统”方式编译的，还是编译成MSIL？

* * *

## 回答 #1

> 赞同：28
> 
> 时间：2009-03-27T03:28:48.390

嗯，它比这更复杂一些。实际上，支持 .NET 的 C++ 有两个完全不同的版本。

旧的 C++ 托管扩展是 Visual C++ 2002/2003 中唯一可用的选项。它在选项 /clr:oldSyntax 下的较新编译器中可用。它有点笨拙，因为它努力与标准 C++ 集成，所以所有新关键字（而且有很多）都以双下划线等为前缀。这个编译器生成的代码是本机代码和 MSIL 代码的混合，称为 IJW“它只是工作”。

新语言称为 C++/CLI，是 Visual C++ 2005 和更新版本中可用的一种全新语言。最重要的是，它支持多种代码生成模式。/clr 选项再次生成本机代码和 MSIL 代码的 IJW 混合。/clr:pure 会导致仅托管程序集，尽管它可能会将本机类型转换为相应的 .net 结构。因此，代码可能不是类型安全的，并且可以使用指针算术，很像带有 /unsafe 的 C#。最严格的选项是 /clr:safe，它生成类型安全、可验证的仅 MSIL 程序集，就像 C# 编译器所做的一样（即没有 /unsafe）。

有关 MC++ 和 C++/CLI 之间的区别，请参阅[wikipedia](http://en.wikipedia.org/wiki/C%2B%2B/CLI)。

有关编译器开关的说明，请参阅[MSDN](http://msdn.microsoft.com/en-us/library/k8d11d4s.aspx)。

PS。.NET 字节码称为 MSIL（Microsoft 中间语言）或 CIL（通用中间语言）。MIL 可以代表媒体集成层，它是 WPF 和 Vista 桌面窗口管理器使用的未记录的低级库。

* * *

## 回答 #2

> 赞同：23
> 
> 时间：2009-03-27T04:03:20.290

将概念分开可能是个好主意。

首先，C++ 是一门语言，它没有具体说明应该针对什么平台。原则上，直接的 C++ 代码可以编译为本机 x86 汇编程序、Java 字节码、MSIL 或您想想到的任何其他内容。我相信 Adob​​e 最近制作了一个生成 Flash 字节码的 C++ 编译器。

其次，由于典型的优柔寡断，微软创建了两种针对 .NET 的 C++ 派生语言。首先，他们制作了“C++ 托管扩展”。然后他们认为它糟透了，抛弃了它，并试图假装它从未存在过。

现在，他们对 .NET 风格的 C++ 的最佳选择称为 C++/CLI，但*它不是 C++*。它以多种非标准方式扩展和更改语言。（而且我相信 C++ 标准委员会要求他们更改名称以避免混淆。但他们没有）

Visual Studio 2005 和更新版本支持 C++/CLI。（在“添加项目”中，它们列在 Visual C++ -> CLR 下）

*然而*（你没想到这么简单，是吗？），微软又做了一次。在指定 C++/CLI（这实际上是一种设计合理的将 C++ 与 CLI 集成的尝试）之后，他们意识到几乎没有人使用它！事实证明，即使是 C++ 程序员，在 .NET 中工作时通常也更喜欢使用 C#，否则更喜欢使用适当的原生 C++。

所以现在，他们专注于让*原生*C++ 和 .NET 之间的互操作更简单、更强大。但是，C++/CLI 不太可能消失。它有效，在某些情况下它很有用。这不是他们最初希望的 C++ 杀手。

Visual Studio（自始至终）还支持本机 C++ 应用程序，编译为 x86 机器代码，不受 .NET 污染。这些列在 Visual C++ -> Win32 下的“添加项目”对话框中。

因此，如果您想学习 C++，您有两个选择： 学习 C++/CLI，这将您限制为仅限 MS 的语言，是的，生成 MSIL 而不是本机机器代码，并且需要 .NET 才能运行，而且通常不是值得费心，因为如果您仍然要依赖 .NET ，为什么不使用 C# 编写呢*？*

或者学习正确的 C++，它与 .NET 完全分离，不能直接引用 .NET 程序集。

关键的要点是它们是不同的语言。要么编译为 C++/CLI，这意味着编译器将允许你引用 .NET 程序集，并生成 MSIL 代码，要么编译为 C++，在这种情况下，.NET 世界不存在。

最后，请注意。尽管我上面的措辞（“正确的 C++”和“不受 .NET 污染”），C++ 并不是“更好”。在许多情况下，它也不是更快。C++ 有*可能*更快，但它更多地取决于程序员。

C# 编译器会将几乎任何东西都变成相当高效的代码。另一方面，C++ 充满了陷阱，会使您的代码比等效的 C#*慢。*

[http://blogs.msdn.com/ricom/archive/2005/05/10/416151.aspx](http://blogs.msdn.com/ricom/archive/2005/05/10/416151.aspx)及其引用的博客文章值得任何对用两种语言编写的类似代码的性能感兴趣的人阅读。

只有一个领域 C++ 应用程序会始终更快，那就是启动时间。.NET 应用程序可能必须加载 .NET 框架并 JIT MSIL 代码，而本地应用程序...刚刚启动。

但除此之外，假设 C++ 会更快可能是错误的。*可以*，因为它给了你更多的控制权。但通常，这只是意味着编译器无法将您从您在代码中创建的低效率中拯救出来。

* * *

## 回答 #3

> 赞同：7
> 
> 时间：2009-03-27T03:07:28.753

[这](http://www.kbcafe.com/articles/CSharp.Performance.pdf)是一个关于托管与非托管 C++ 的很好（如果过时的话）的讨论。

简而言之，C++ 既可以是托管的（编译为 MIL），也可以是非托管的（编译为本机代码）。

* * *

## 回答 #4

> 赞同：2
> 
> 时间：2009-03-27T03:34:06.957

不管你想学习 C++ 的原因是什么，了解更多的语言总是好的，因为它拓宽了你的思维，所以学习 C++ 本身就是一个有价值的课程。

使用 C++，您可以将其作为 .NET 应用程序 C++/CLI 或本机运行。它只是 Visual Studio 中的一个编译器开关，但是两者之间存在很多语法差异。我个人认为学习这两种口味很有用。

在您的项目中选择哪个取决于要求，例如，如果您的程序需要与其他托管模块（如用 C# 编写的模块）交互，则最好使用 C++/CLI 以避免在托管代码和非托管代码之间进行一些开销切换。

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2010-01-26T05:53:20.323

C++ 组件不能轻易引用 .Net 程序集（您需要使用 COM）。托管 C++ 编译为 CIL，并具有与 C# 相同的性能配置文件。

对于大多数代码，相同级别的优化 C++ 大约快 10%，但是 C# 需要一半的时间来编写和调试，所以在相同的时间内，我认为你可以实施的优化将使 C# 更快......

# javascript - 你可以使用 javascript 来渲染图像流吗？

> ID：688387
> 
> 赞同：4
> 
> 时间：2009-03-27T03:03:48.823
> 
> 标签：javascript, jquery, image, stream

情况是您必须使用图像 API，并且必须发出 POST 请求以获取要在网页其余部分显示的图像流。

我可以使用 jQuery 在页面加载时向该服务发出 ajax 请求，但我只得到一个返回的二进制流。无论如何，JavaScript 可以采用该二进制字符串并显示标题中的内容类型吗？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2009-03-27T04:32:39.237

我相信您正在寻找的是[Data URI Scheme](http://en.wikipedia.org/wiki/Data_URI_scheme) - 它允许您格式化一个非常长的 URI，该 URI 本身指定所需的二进制数据。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2009-03-27T03:11:49.477

我相信您需要安排在 HTTP GET 操作引用 URL 时传递流 - 然后让 JavaScript 将图像的*src*属性设置为该 URL。我已经看到使用 ASP.NET 完成此操作，其中 .ashx 处理程序用于流式传输图像。然后参考[http://site.com/images/imagehandler.ashx?parameters](http://site.com/images/imagehandler.ashx?parameters)。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2009-03-27T03:12:12.097

您不能将图像的 src 属性设置为当前用于 ajax 通信的 url 吗？还是您必须先从 ajax 调用中删除其他信息？

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2009-03-27T03:26:42.717

以 iframe 为目标进行表单发布请求。这是唯一的方法。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2009-03-27T03:13:19.927

只需使用 javascript 创建一个带有将图像作为 src 返回的 url 的 img 元素：

```
// jquery
$(#some-id).append('<img src="/get-image/?foo=bar"/>'); 
```

# groovy - 进行值匹配的 Groovy 方法？

> ID：688402
> 
> 赞同：6
> 
> 时间：2009-03-27T03:14:24.837
> 
> 标签：groovy

只是想知道像这样与默认值匹配的**常规**方法吗？

```
if(params.max != 10 && params.max != 20 && params.max != 30){
    params.max = 10
} 
```

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2009-03-27T03:35:38.747

```
params.max = [10, 20, 30].contains(params.max)) ? params.max : 10; 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-03-27T05:26:30.463

您还可以使用在这种情况下有用的 Elvis 运算符 (?:)。如果第一个值为空，则返回第二个值：

```
params.max = [10, 20, 30].find{ it == params.max } ?: 10 
```

# c# - 您在 C# 中制作或看到过哪些非常有价值的流畅接口？他们有什么了不起的？

> ID：688418
> 
> 赞同：18
> 
> 时间：2009-03-27T03:22:32.557
> 
> 标签：c#, c#-3.0, extension-methods, fluent

“流畅的界面”是近来相当热门的话题。C# 3.0 有一些很好的特性（尤其是扩展方法）可以帮助您制作它们。

仅供参考，流畅的 API 意味着每个方法调用都会返回一些有用的东西，通常是您调用该方法的同一个对象，因此您可以继续链接事物。Martin Fowler 在这里通过一个 Java 示例对其进行了[讨论](http://www.martinfowler.com/bliki/FluentInterface.html)。这个概念是这样的：

```
var myListOfPeople = new List<Person>();

var person = new Person();
person.SetFirstName("Douglas").SetLastName("Adams").SetAge(42).AddToList(myListOfPeople); 
```

我在 C# 中看到了一些非常有用的流畅接口（一个例子是验证参数的流畅方法，在[我之前问过的 StackOverflow 问题](https://stackoverflow.com/questions/669678/what-is-the-smoothest-most-appealing-syntax-youve-found-for-asserting-parameter/670484#670484)中找到。它让我大吃一惊。它能够提供高度可读的语法来表达参数验证规则，并且还有，如果没有异常，它可以避免实例化任何对象！所以对于“正常情况”来说，开销很小。这个花絮在短时间内教会了我很多东西。我想找到更多的**东西**像那样）。

所以，我想通过查看和讨论一些优秀的例子来了解更多信息。那么，**您在 C# 中制作或见过哪些出色的流畅接口，是什么让它们如此有价值？**

谢谢。

* * *

## 回答 #1

> 赞同：9
> 
> 时间：2009-03-27T04:40:03.367

这其实是我第一次听说“流利界面”这个词。但是想到的两个例子是 LINQ 和不可变集合。

LINQ 背后是一系列方法，其中大部分是扩展方法，它们至少接受一个 IEnumerable 并返回另一个 IEnumerable。这允许非常强大的方法链接

```
var query = someCollection.Where(x => !x.IsBad).Select(x => x.Property1); 
```

不可变类型，更具体地说是集合具有非常相似的模式。不可变集合为通常的变异操作返回一个新集合。因此，建立一个集合通常会变成一系列链式方法调用。

```
var array = ImmutableCollection<int>.Empty.Add(42).Add(13).Add(12); 
```

* * *

## 回答 #2

> 赞同：8
> 
> 时间：2009-03-27T17:16:37.543

感谢方法参数验证，您为我们的流畅 API 提供了一个新想法。反正我讨厌我们的前置条件检查...

我已经为正在开发的新产品构建了一个可扩展系统，您可以在其中流畅地描述可用的命令、用户界面元素等。它运行在 StructureMap 和 FluentNHibernate 之上，它们也是很好的 API。

```
MenuBarController mb;
// ...
mb.Add(Resources.FileMenu, x =>
{
  x.Executes(CommandNames.File);
  x.Menu
    .AddButton(Resources.FileNewCommandImage, Resources.FileNew, Resources.FileNewTip, y => y.Executes(CommandNames.FileNew))
    .AddButton(null, Resources.FileOpen, Resources.FileOpenTip, y => 
    {
      y.Executes(CommandNames.FileOpen);
      y.Menu
        .AddButton(Resources.FileOpenFileCommandImage, Resources.OpenFromFile, Resources.OpenFromFileTop, z => z.Executes(CommandNames.FileOpenFile))
        .AddButton(Resources.FileOpenRecordCommandImage, Resources.OpenRecord, Resources.OpenRecordTip, z => z.Executes(CommandNames.FileOpenRecord));
     })
     .AddSeperator()
     .AddButton(null, Resources.FileClose, Resources.FileCloseTip, y => y.Executes(CommandNames.FileClose))
     .AddSeperator();
     // ...
}); 
```

您可以像这样配置所有可用的命令：

```
Command(CommandNames.File)
  .Is<DummyCommand>()
  .AlwaysEnabled();

Command(CommandNames.FileNew)
  .Bind(Shortcut.CtrlN)
  .Is<FileNewCommand>()
  .Enable(WorkspaceStatusProviderNames.DocumentFactoryRegistered);

Command(CommandNames.FileSave)
  .Bind(Shortcut.CtrlS)
  .Enable(WorkspaceStatusProviderNames.DocumentOpen)
  .Is<FileSaveCommand>();

Command(CommandNames.FileSaveAs)
  .Bind(Shortcut.CtrlShiftS)
  .Enable(WorkspaceStatusProviderNames.DocumentOpen)
  .Is<FileSaveAsCommand>();

Command(CommandNames.FileOpen)
  .Is<FileOpenCommand>()
  .Enable(WorkspaceStatusProviderNames.DocumentFactoryRegistered);

Command(CommandNames.FileOpenFile)
  .Bind(Shortcut.CtrlO)
  .Is<FileOpenFileCommand>()
  .Enable(WorkspaceStatusProviderNames.DocumentFactoryRegistered);

Command(CommandNames.FileOpenRecord)
  .Bind(Shortcut.CtrlShiftO)
  .Is<FileOpenRecordCommand>()
  .Enable(WorkspaceStatusProviderNames.DocumentFactoryRegistered); 
```

我们的视图使用工作区提供给它们的服务为标准编辑菜单命令配置它们的控件，它们只是告诉它观察它们：

```
Workspace
  .Observe(control1)
  .Observe(control2) 
```

如果用户选择控件，工作区会自动为控件获取适当的适配器，并提供撤消/重做和剪贴板操作。

它帮助我们显着减少了设置代码并使其更具可读性。

* * *

我忘了告诉我们在 WinForms MVP 模型演示者中使用的一个库来验证视图：[FluentValidation](http://www.codeplex.com/FluentValidation)。非常简单，非常可测试，非常好！

* * *

## 回答 #3

> 赞同：7
> 
> 时间：2009-03-27T17:02:26.360

我喜欢[CutEdge.Conditions](http://www.codeplex.com/conditions)中流畅的界面。

从他们的样本中：

```
 `// Check all preconditions:
 id.Requires("id")
    .IsNotNull()          // throws ArgumentNullException on failure 
    .IsInRange(1, 999)    // ArgumentOutOfRangeException on failure 
    .IsNotEqualTo(128);   // throws ArgumentException on failure` 
```

`我发现它更容易阅读，并且使我在检查方法中的前置条件（和后置条件）时比我有 50 个 if 语句来处理相同的检查时更有效。`

 `* * *

## 回答 #4

> 赞同：4
> 
> 时间：2009-03-27T19:56:49.810

这是我昨天刚做的一个。进一步的思考可能会导致我改变方法，但即使这样，“流利”的方法也让我完成了我原本无法完成的事情。

**首先，一些背景。**我最近（在 StackOverflow 上）学习了一种将值传递给方法的方法，以便该方法能够确定**name**和**value**。例如，一种常见用途是用于参数验证。例如：

```
public void SomeMethod(Invoice lastMonthsInvoice)
{
     Helper.MustNotBeNull( ()=> lastMonthsInvoice);
} 
```

请注意，没有包含“lastMonthsInvoice”的字符串，这很好，因为字符串不适合重构。但是，错误消息**可能**会显示类似“参数 'lastMonthsInvoice' 不能为空”之类的内容。[这](https://stackoverflow.com/questions/669678/what-is-the-smoothest-most-appealing-syntax-youve-found-for-asserting-parameter/670495#670495)是解释为什么这有效并指向该人的博客文章的帖子。

**但这只是背景。**我使用相同的概念，但方式不同。我正在编写一些单元测试，我想将某些属性值转储到控制台，以便它们显示在单元测试输出中。我厌倦了写这个：

```
Console.WriteLine("The property 'lastMonthsInvoice' has the value: " + lastMonthsInvoice.ToString()); 
```

...因为我必须将属性命名为字符串，然后引用它。所以我把它放在我可以输入的地方：

```
ConsoleHelper.WriteProperty( ()=> lastMonthsInvoice ); 
```

并得到这个输出：

> ```
> Property [lastMonthsInvoice] is: <whatever ToString from Invoice 
> ```
> 
> 生产>

**现在，这里是一种流利的方法让我可以做一些我不能做的事情。**

我想让 ConsoleHelper.WriteProperty 采用 params 数组，因此它可以将**许多**此类属性值转储到控制台。为此，它的签名如下所示：

```
public static void WriteProperty<T>(params Expression<Func<T>>[] expr) 
```

所以我可以这样做：

```
ConsoleHelper.WriteProperty( ()=> lastMonthsInvoice, ()=> firstName, ()=> lastName ); 
```

但是，*由于类型推断，这不起作用。*换句话说，所有这些表达式都不会返回相同的类型。lastMonthsInvoice 是一张发票。firstName 和 lastName 是字符串。它们不能在对 WriteProperty 的同一调用中使用，因为 T 在所有这些调用中都不相同。

这就是流利的方法来拯救的地方。我让 WriteProperty() 返回了一些东西。它返回的类型是我可以调用 And() 的类型。这给了我这个语法：

```
ConsoleHelper.WriteProperty( ()=> lastMonthsInvoice)
     .And( ()=> firstName)
     .And( ()=> lastName); 
```

**在这种情况下，流利的方法允许一些原本不可能**（或至少不方便）的事情。

这是完整的实现。正如我所说，我昨天写的。您可能会看到改进的空间，甚至可能会看到更好的方法。我对此表示欢迎。

```
public static class ConsoleHelper
{
    // code where idea came from ...
    //public static void IsNotNull<T>(Expression<Func<T>> expr)
    //{
    // // expression value != default of T
    // if (!expr.Compile()().Equals(default(T)))
    // return;

    // var param = (MemberExpression)expr.Body;
    // throw new ArgumentNullException(param.Member.Name);
    //}

    public static PropertyWriter WriteProperty<T>(Expression<Func<T>> expr)
    {
        var param = (MemberExpression)expr.Body;
        Console.WriteLine("Property [" + param.Member.Name + "] = " + expr.Compile()());
        return null;
    }

    public static PropertyWriter And<T>(this PropertyWriter ignored, Expression<Func<T>> expr)
    {
        ConsoleHelper.WriteProperty(expr);
        return null;
    }

    public static void Blank(this PropertyWriter ignored)
    {
        Console.WriteLine();
    }
}

public class PropertyWriter
{
    /// <summary>
    /// It is not even possible to instantiate this class. It exists solely for hanging extension methods off.
    /// </summary>
    private PropertyWriter() { }
} 
```

* * *

## 回答 #5

> 赞同：3
> 
> 时间：2009-03-27T17:28:05.487

除了这里指定的之外，流行的[RhinoMocks](http://ayende.com/projects/rhino-mocks.aspx)单元测试模拟框架使用流畅的语法来指定模拟对象的期望：

```
// Expect mock.FooBar method to be called with any paramter and have it invoke some method
Expect.Call(() => mock.FooBar(null))
    .IgnoreArguments()
    .WhenCalled(someCallbackHere);

// Tell mock.Baz property to return 5:
SetupResult.For(mock.Baz).Return(5); 
```

* * *

## 回答 #6

> 赞同：3
> 
> 时间：2009-03-27T17:40:36.580

**方法命名**

只要明智地选择方法名称，流畅的接口就具有可读性。

考虑到这一点，我想将这个特定的 API 命名为“反流利的”：

[System.Type.IsInstanceOfType](http://msdn.microsoft.com/en-us/library/system.type.isinstanceoftype.aspx)

它是一个对象的成员`System.Type`并接受一个对象，如果该对象是该类型的实例，则返回 true。不幸的是，您自然倾向于像这样从左到右阅读它：

```
o.IsInstanceOfType(t);  // wrong 
```

当它实际上是另一种方式时：

```
t.IsInstanceOfType(o);  // right, but counter-intuitive 
```

但并非所有方法都可能被命名（或定位在 BCL 中）以预测它们在“伪英语”代码中的出现方式，因此这并不是真正的批评。我只是指出流利接口的另一个方面——选择方法名称以减少意外。

**对象初始化器**

对于此处给出的许多示例，使用流畅接口的唯一原因是可以在单个表达式中初始化新分配的对象的多个属性。

但是 C# 有一个语言特性，经常使这种做法变得不必要 - 对象初始化器语法：

```
var myObj = new MyClass
            {
                SomeProperty = 5,
                Another = true,
                Complain = str => MessageBox.Show(str),
            }; 
```

这也许可以解释为什么专业的 C# 用户不太熟悉用于在同一对象上链接调用的术语“流畅接口”——在 C# 中并不经常需要它。

由于属性可以具有手动编码的设置器，因此可以在新构造的对象上调用多个方法，而不必让每个方法返回相同的对象。

限制是：

*   属性设置器只能接受一个参数
*   属性设置器不能是通用的

如果我们可以在对象初始化程序块内调用方法和登记事件，以及分配给属性，我会很高兴。

```
var myObj = new MyClass
            {
                SomeProperty = 5,
                Another = true,
                Complain = str => MessageBox.Show(str),
                DoSomething()
                Click += (se, ev) => MessageBox.Show("Clicked!"),
            }; 
```

为什么这样的修改块只能在施工后立即适用？我们可以有：

```
myObj with
{
    SomeProperty = 5,
    Another = true,
    Complain = str => MessageBox.Show(str),
    DoSomething(),
    Click += (se, ev) => MessageBox.Show("Clicked!"),
} 
```

这`with`将是一个 new 关键字，它对某种类型的对象进行操作并产生相同的对象和类型 - 请注意，这将是一个*表达式*，而不是一个*语句*。所以它会准确地捕捉到在“流利的界面”中链接的想法。

因此，无论您是从`new`表达式还是从 IOC 或工厂方法等获取对象，您都可以使用初始化程序样式的语法。

实际上，您可以`with`在完成后使用`new`它，它等效于对象初始化器的当前样式：

```
var myObj = new MyClass() with
            {
                SomeProperty = 5,
                Another = true,
                Complain = str => MessageBox.Show(str),
                DoSomething(),
                Click += (se, ev) => MessageBox.Show("Clicked!"),
            }; 
```

正如查理在评论中指出的那样：

```
public static T With(this T with, Action<T> action)
{
    if (with != null)
        action(with);
    return with;
} 
```

上面的包装器只是强制一个不返回的动作返回一些东西，嘿，从这个意义上说，任何东西都可以是“流利的”。

等效于初始化程序，但具有事件登记：

```
var myObj = new MyClass().With(w =>
            {
                w.SomeProperty = 5;
                w.Another = true;
                w.Click += (se, ev) => MessageBox.Show("Clicked!");
            }; 
```

在工厂方法而不是`new`：

```
var myObj = Factory.Alloc().With(w =>
            {
                w.SomeProperty = 5;
                w.Another = true;
                w.Click += (se, ev) => MessageBox.Show("Clicked!");
            }; 
```

我也忍不住给它“可能是单子”式的 null 检查，所以如果你有一些可能返回的东西`null`，你仍然可以申请`With`它，然后检查它的`null`-ness。

* * *

## 回答 #7

> 赞同：2
> 
> 时间：2009-03-27T16:43:29.353

[SubSonic 2.1](http://subsonicproject.com)有一个不错的查询 API：

```
DB.Select()
  .From<User>()
  .Where(User.UserIdColumn).IsEqualTo(1)
  .ExecuteSingle<User>(); 
```

[tweetsharp](http://tweetsharp.com)也广泛使用了 fluent API：

```
var twitter = FluentTwitter.CreateRequest()
              .Configuration.CacheUntil(2.Minutes().FromNow())
              .Statuses().OnPublicTimeline().AsJson(); 
```

Fluent [NHibernate](http://wiki.fluentnhibernate.org/show/GettingStarted:+Introduction)最近风靡一时：

```
public class CatMap : ClassMap<Cat>  
{  
  public CatMap()  
  {  
    Id(x => x.Id);  
    Map(x => x.Name)  
      .WithLengthOf(16)  
      .Not.Nullable();  
    Map(x => x.Sex);  
    References(x => x.Mate);  
    HasMany(x => x.Kittens);  
  }  
} 
```

[Ninject](http://ninject.org/)也使用它们，但我无法快速找到示例。

* * *

## 回答 #8

> 赞同：2
> 
> 时间：2012-08-01T07:49:54.443

我为 System.Net.Mail 编写了一个流利的包装器，我发现它使电子邮件代码更具可读性（并且更容易记住语法）。

```
var email = Email
            .From("john@email.com")
            .To("bob@email.com", "bob")
            .Subject("hows it going bob")
            .Body("yo dawg, sup?");

//send normally
email.Send();

//send asynchronously
email.SendAsync(MailDeliveredCallback); 
```

[http://lukencode.com/2010/04/11/fluent-email-in-net/](http://lukencode.com/2010/04/11/fluent-email-in-net/)

* * *

## 回答 #9

> 赞同：1
> 
> 时间：2009-03-27T03:27:33.713

[WCF REST Starter Kit Preview 2](http://msdn.microsoft.com/en-us/netframework/cc950529.aspx)的新 HttpClient是一个非常流畅的 API。请参阅我的博客文章以获取示例[http://bendewey.wordpress.com/2009/03/14/connecting-to-live-search-using-the-httpclient/](http://bendewey.wordpress.com/2009/03/14/connecting-to-live-search-using-the-httpclient/)

* * *

## 回答 #10

> 赞同：1
> 
> 时间：2009-03-27T05:18:18.610

NHibernate 中的 Criteria API 有一个很好的流畅界面，它允许你做这样很酷的事情：

```
Session.CreateCriteria(typeof(Entity))
    .Add(Restrictions.Eq("EntityId", entityId))
    .CreateAlias("Address", "Address")
    .Add(Restrictions.Le("Address.StartDate", effectiveDate))
    .Add(Restrictions.Disjunction()
        .Add(Restrictions.IsNull("Address.EndDate"))
        .Add(Restrictions.Ge("Address.EndDate", effectiveDate)))
    .UniqueResult<Entity>(); 
```

* * *

## 回答 #11

> 赞同：0
> 
> 时间：2009-03-27T16:58:46.853

正如[@John Sheehan](https://stackoverflow.com/users/1786/john-sheehan)提到的，[Ninject](http://ninject.org/)使用这种类型的 API 来指定绑定。以下是他们[用户指南](http://dojo.ninject.org/User%20Guide.ashx)中的一些示例代码：

```
Bind<IWeapon>().To<Sword>();
Bind<Samurai>().ToSelf();
Bind<Shogun>().ToSelf().Using<SingletonBehavior>(); 
```

# database-design - 在多个会员驱动的网站上集中用户数据库的最佳结构？

> ID：688419
> 
> 赞同：0
> 
> 时间：2009-03-27T03:22:48.920
> 
> 标签：database-design, scalability, social-networking

我们为客户建立了一个社交网站。它做得很好，现在他们想打包并许可同一站点的多个副本，但为其客户打上品牌。

每个站点都是相当自治的，除了一个站点上的用户可以访问另一个站点上的用户的内容，这需要集中用户配置文件。

我们知道我们将如何设置它，但您会如何使其具有功能性和可扩展性？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2009-03-27T03:28:19.547

也许像 SO 那样研究 OpenID。您唯一需要做的就是转换现有站点，但随后用户将不得不重新注册......或者......您可以在原始站点上提供 OpenID 作为那些想要的用户的辅助登录方法跨站会员。

# php - 异地媒体流设置

> ID：688424
> 
> 赞同：0
> 
> 时间：2009-03-27T03:26:59.923
> 
> 标签：php, scalability, media

我有一个媒体丰富的网站，在存储方面超出了我们的服务器可以处理的范围。估计在 500 gig 和 2 TB 之间。

媒体通常一次通过网站上传 500k 到 30 兆，并且只是用户上传的视频和照片。

然后使用 PHP FTP 函数将媒体从临时目录复制到媒体目录中。

我正在寻找在用户上传文件后处理存储文件的最佳方式。

**编辑**

我在 Mosso 有一个云计算帐户，我们所有的网站都托管在 RackSpace（传统）的专用盒子上。我的问题适用于将媒体以目前的方式进入网站的实际过程，然后下一步该做什么......

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2009-03-27T03:35:25.707

尝试[使用 Cloud Front 的](http://aws.amazon.com/s3/)[Rackspace Mosso](http://www.mosso.com/cloudfiles.jsp)或Amazon S3

还可以考虑使用[内容交付网络](http://en.wikipedia.org/wiki/Content_Delivery_Network)来加快访问者的加载时间。

两者都有一个可与您的内部系统一起使用的应用程序编程接口，用于上传新内容。

Twitter 使用 Amazon S3 作为用户头像。

# sql-server-2005 - 在 T-SQL 中评估

> ID：688425
> 
> 赞同：9
> 
> 时间：2009-03-27T03:27:04.290
> 
> 标签：sql-server-2005, tsql, evaluation

我有一个存储过程，它允许 IN 参数指定要使用的数据库。然后，我在该数据库中使用预先确定的表进行查询。我遇到的问题是在我的查询中将表名连接到该数据库名。如果 T-SQL 有一个评估函数，我可以做类似的事情

```
eval(@dbname + 'MyTable') 
```

目前我一直在创建一个字符串，然后使用`exec()`该字符串作为查询运行。这很混乱，我宁愿不必创建一个字符串。有没有办法可以评估变量或字符串，以便我可以执行以下操作？

```
SELECT *
FROM eval(@dbname + 'MyTable') 
```

我希望它进行评估，所以它最终看起来像这样：

```
SELECT *
FROM myserver.mydatabase.dbo.MyTable 
```

* * *

## 回答 #1

> 赞同：16
> 
> 时间：2009-04-01T20:59:38.480

阅读这篇...[动态 SQL 的诅咒和祝福](http://www.sommarskog.se/dynamic_sql.html)，帮助我理解如何解决这类问题。

* * *

## 回答 #2

> 赞同：9
> 
> 时间：2009-03-27T03:40:26.507

没有“更整洁”的方法可以做到这一点。如果你接受它并看看别的东西，你会节省时间。

**编辑：** 啊哈！关于 OP 的评论“我们必须每个月将数据加载到一个新的数据库中，否则它会变得太大。”。令人惊讶的是，没有人评论这个问题的微弱气味。

SQL Server 提供了处理“太大”的表（特别是分区）的本机机制，这将允许您将表作为单个实体来处理，同时在后台将表划分为单独的文件，从而消除您当前的完全有问题。

换句话说，这是您的数据库管理员的问题，而不是数据库使用者的问题。如果您也遇到这种情况，我建议您考虑对该表进行[分区。](http://msdn.microsoft.com/en-us/library/ms345146.aspx)

* * *

## 回答 #3

> 赞同：6
> 
> 时间：2009-03-27T03:29:59.683

尝试 sp_executesql 内置函数。你基本上可以在你的 proc 中建立你的 SQL 字符串，然后调用

```
exec sp_executesql @SQLString.

DECLARE @SQLString nvarchar(max)
SELECT @SQLString = '
SELECT *
FROM  ' +  @TableName 

EXEC sp_executesql @SQLString 
```

* * *

## 回答 #4

> 赞同：2
> 
> 时间：2009-04-01T11:16:40.393

您不能在 SQL Server 中指定动态表名。

有几个选项：

1.  使用动态 SQL
2.  玩弄同义词（这意味着更少的动态 SQL，但仍然有一些）

你说你不喜欢 1，所以让我们去 2。

第一种选择是将混乱限制在一行：

```
begin transaction t1;
declare @statement nvarchar(100);

set @statement = 'create synonym temptablesyn for db1.dbo.test;'
exec sp_executesql @statement

select * from db_syn

drop synonym db_syn;

rollback transaction t1; 
```

我不确定我是否喜欢这个，但这可能是你最好的选择。这样，所有的 SELECT 都将是相同的。

您可以根据自己的喜好对其进行重构，但这有很多缺点，包括同义词是在事务中创建的，因此您不能同时运行两个查询（因为两者都将尝试创建 temptablesyn）。根据锁定策略，一个会阻止另一个。

同义词是永久的，所以这就是您需要在事务中执行此操作的原因。

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2009-04-01T21:17:07.580

有一些选择，但它们比您已经在做的方式更混乱。我建议您：
（1）坚持当前的方法
（2）继续将SQL嵌入代码中，因为无论如何您都在这样做。
(3) 要格外小心地验证您的输入以避免 SQL 注入。

此外，混乱并不是动态 SQL 的唯一问题。请记住以下几点：
(1) 动态 SQL 阻碍了服务器创建可重用执行计划的能力。
(2) ExecuteSQL 命令打破了所有权链。这意味着代码将在调用存储过程的用户而不是过程的所有者的上下文中运行。这可能会迫使您在运行该语句的任何表上打开安全性并产生其他安全问题。

* * *

## 回答 #6

> 赞同：1
> 
> 时间：2009-04-04T07:20:18.667

只是一个想法，但是如果您有这些数据库的预定义列表，那么您可以在连接到它们的数据库中创建一个视图 - 例如：

```
CREATE VIEW dbo.all_tables
AS

SELECT  your_columns,
        'db_name1' AS database_name
FROM    db_name1.dbo.your_table

UNION ALL

SELECT  your_columns,
        'db_name2'
FROM    db_name2.dbo.your_table

etc... 
```

然后，您可以将数据库名称传递给您的存储过程，并简单地将其用作 WHERE 子句中的参数。如果表很大，您可能会考虑使用索引视图，在新的 database_name 列（或您所称的任何名称）和表的主键（我从问题中假设表的架构相同？ ）。

显然，如果您的数据库列表经常更改，那么这将变得更加成问题 - 但如果您无论如何都必须创建这些数据库，那么同时维护此视图不应该是太大的开销！

* * *

## 回答 #7

> 赞同：1
> 
> 时间：2009-04-05T13:26:52.850

我认为 Mark Brittingham 的想法是正确的（这里：h [ttp://stackoverflow.com/questions/688425/evaluate-in-t-sql/718223#718223](http://ttp://stackoverflow.com/questions/688425/evaluate-in-t-sql/718223#718223)），即发出`use database`命令并将 sp 写入不完全限定表名。正如他所指出的，这将作用于登录当前数据库中的表。

让我添加一些可能的详细说明：

从 OP 的评论中，我收集到数据库每月更改一次，当它变得“太大”时。（“我们必须每个月将数据加载到一个新数据库中，否则它会变得太大。- d03boy”）

1.  用户登录有一个默认数据库，使用 sp_defaultdb（不推荐）或 ALTER LOGIN 设置。如果每个月您都转移到新数据库，并且不需要在旧副本上运行 sp，只需每月更改登录的默认数据库，同样，不要完全限定表名。

2.  要使用的数据库可以在客户端 login: 中设置 `sqlcmd -U login_id -P password -d db_name`，然后从那里执行 sp。

3.  您可以使用您选择的客户端（命令行、ODBC、JDBC）建立与数据库的连接，然后发出`use database`命令，exec sp。

    使用数据库栏；执行 sp_foo;

使用上述方法之一设置数据库后，您有三种选择来执行存储过程：

1.  您可以将 sp 与数据库一起复制到新数据库中。只要表名不是完全限定的，您就会对新数据库的表进行操作。

    执行 sp_foo;

2.  您可以在其自己的数据库中安装 sp 的单个规范副本，调用它`procs`，表名不是完全限定的，然后调用它的完全限定名：

    执行 procs.dbo.sp_foo;

3.  您可以在每个单独的数据库中安装一个`sp_foo`执行实际 sp 的完全限定名称的存根，然后`sp_foo`在不限定它的情况下执行它。将调用存根，它会调用`procs`. （不幸的是，`use database dbname`不能从 sp 中执行。）

    ```
    --sp_foo 存根：
    创建过程 bar.dbo.sp_foo
     @parm 整数
    作为
    开始
      执行 procs.dbo.sp_foo @parm;
    结尾
    去
    ```

但是这样做了，如果数据库正在被更改，则应该使用该`WITH RECOMPILE`选项创建真正的 sp，否则它将为错误的表缓存执行计划。存根当然不需要这个。

* * *

## 回答 #8

> 赞同：1
> 
> 时间：2009-04-06T18:48:07.920

您可以创建一个 SQL CLR 表值 UDF 来访问这些表。您必须将其绑定到模式，因为 TV-UDF 不支持动态模式。（我的示例包括一个 ID 和一个标题列 - 根据您的需要进行修改）

完成此操作后，您应该能够执行以下查询：

```
SELECT * FROM dbo.FromMyTable('table1') 
```

您也可以在该字符串中包含一个多部分名称。

```
SELECT * FROM dbo.FromMyTable('otherdb..table1') 
```

从该表中返回 ID、Title 列。

您可能需要启用 SQL CLR 并打开 TRUSTWORTHY 选项：

```
sp_configure 'clr enabled',1
go
reconfigure
go
alter database mydatabase set trustworthy on 
```

创建一个 C# SQL 项目，添加一个新的 UDF 文件，将其粘贴到那里。将项目属性、数据库、权限级别设置为外部。构建、部署。可以在没有 VisualStudio 的情况下完成。如果您需要，请告诉我。

```
using System;
using System.Data.SqlTypes;
using Microsoft.SqlServer.Server;
using System.Collections;
using System.Data.SqlClient;

[assembly: CLSCompliant(true)]
namespace FromMyTable
{
    public static partial class UserDefinedFunctions
    {
        [Microsoft.SqlServer.Server.SqlFunction(DataAccess = DataAccessKind.Read, IsDeterministic = true, SystemDataAccess = SystemDataAccessKind.Read, IsPrecise = true, FillRowMethodName = "FillRow", 
            TableDefinition = "id int, title nvarchar(1024)")]
        public static IEnumerable FromMyTable(SqlString tableName)
        {
            return new FromMyTable(tableName.Value);
        }

        public static void FillRow(object row, out SqlInt32 id, out SqlString title)
        {
            MyTableSchema v = (MyTableSchema)row;
            id = new SqlInt32(v.id);
            title = new SqlString(v.title);
        }
    }

    public class MyTableSchema
    {
        public int id;
        public string title;
        public MyTableSchema(int id, string title) { this.id = id; this.title = title; }
    }

    internal class FromMyTable : IEnumerable
    {
        string tableName;

        public FromMyTable(string tableName)
        {
            this.tableName = tableName;
        }

        public IEnumerator GetEnumerator()
        {
            return new FromMyTableEnum(tableName);
        }
    }

    internal class FromMyTableEnum : IEnumerator
    {
        SqlConnection cn;
        SqlCommand cmd;
        SqlDataReader rdr;
        string tableName;

        public FromMyTableEnum(string tableName)
        {
            this.tableName = tableName;
            Reset();
        }

        public MyTableSchema Current
        {
            get { return new MyTableSchema((int)rdr["id"], (string)rdr["title"]); }
        }

        object IEnumerator.Current
        {
            get { return Current; }
        }

        public bool MoveNext()
        {
            bool b = rdr.Read();
            if (!b) { rdr.Dispose(); cmd.Dispose(); cn.Dispose(); rdr = null; cmd = null; cn = null; }
            return b;
        }

        public void Reset()
        {
            // note: cannot use a context connection here because it will be closed
            // in between calls to the enumerator.
            if (cn == null) { cn = new SqlConnection("server=localhost;database=mydatabase;Integrated Security=true;"); cn.Open(); }
            if (cmd == null) cmd = new SqlCommand("select id, title FROM " + tableName, cn);
            if (rdr != null) rdr.Dispose();
            rdr = cmd.ExecuteReader();
        }
    }
} 
```

* * *

## 回答 #9

> 赞同：0
> 
> 时间：2009-04-05T02:12:30.757

```
declare @sql varchar(256);
set @sql = 'select * into ##myGlobalTemporaryTable from '+@dbname
exec sp_executesql @sql

select * from ##myGlobalTemporaryTable 
```

复制到全局临时表中，然后您可以像常规表一样使用它

* * *

## 回答 #10

> 赞同：0
> 
> 时间：2009-04-05T05:30:06.117

如果您有合理可管理的数据库数量，最好使用预定义的条件语句，例如：

```
if (@dbname = 'db1')
  select * from db1..MyTable
if (@dbname = 'db2')
  select * from db2..MyTable
if (@dbname = 'db3')
  select * from db3..MyTable 
```

...

如果您要更改可查询的数据库列表，您可以生成此过程作为数据库创建脚本的一部分。

这避免了动态 sql 的安全问题。您还可以通过将“select”语句替换为针对每个数据库的存储过程来提高性能（每个查询一个缓存的执行计划）。

* * *

## 回答 #11

> 赞同：0
> 
> 时间：2009-04-08T21:42:41.230

```
if exists (select * from master..sysservers where srvname = 'fromdb')
    exec sp_dropserver 'fromdb'
go

declare @mydb nvarchar(99);
set @mydb='mydatabase'; -- variable to select database

exec sp_addlinkedserver @server = N'fromdb',
    @srvproduct = N'',
    @provider = N'SQLOLEDB', 
    @datasrc = @@servername,
    @catalog = @mydb
go

select * from OPENQUERY(fromdb, 'select * from table1') 
go 
```

# java - 使用Java找出文件中有多少非空行的最快方法是什么？

> ID：688431
> 
> 赞同：0
> 
> 时间：2009-03-27T03:29:27.220
> 
> 标签：java

使用Java找出文件中有多少非空行的最快方法是什么？

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2009-03-27T07:15:33.883

最简单的方法是使用 BufferedReader，并检查哪些行是空的。但是，这是一种相对较慢的方式，因为它需要为文件中的每一行创建一个 String 对象。一种更快的方法是使用 read() 将文件读入数组，然后遍历数组以计算换行符。

这是两个选项的代码；第二个在我的机器上花费了大约 50% 的时间。

```
public static void timeBufferedReader () throws IOException
{
    long bef = System.currentTimeMillis ();

    // The reader buffer size is the same as the array size I use in the other function
    BufferedReader reader = new BufferedReader(new FileReader("test.txt"), 1024 * 10);
    int counter = 0;
    while (reader.ready())
    {
        if (reader.readLine().length() > 0)
            counter++;
    }

    long after = System.currentTimeMillis() - bef;

    System.out.println("Time: " + after + " Result: " + counter);

}

public static void timeFileReader () throws IOException
{
    long bef = System.currentTimeMillis();

    FileReader reader = new FileReader("test.txt");
    char[] buf = new char[1024 * 10];
    boolean emptyLine = true;
    int     counter = 0;
    while (reader.ready())
    {
        int len = reader.read(buf,0,buf.length);
        for (int i = 0; i < len; i++)
        {
            if (buf[i] == '\r' || buf[i] == '\n')
            {
                if (!emptyLine)
                {
                    counter += 1;
                    emptyLine = true;
                }
            }
            else emptyLine = false;
        }
    }

    long after = System.currentTimeMillis() - bef;

    System.out.println("Time: " + after + " Result: " + counter);

} 
```

* * *

## 回答 #2

> 赞同：5
> 
> 时间：2009-03-27T21:30:59.990

I am with Limbic System on the NIO recommendation. I've added a NIO method to Daphna's test code and bench marked it against his two methods:

```
public static void timeNioReader () throws IOException {
    long bef = System.currentTimeMillis();

    File file = new File("/Users/stu/test.txt");
    FileChannel fc = (new FileInputStream(file)).getChannel(); 
    MappedByteBuffer buf = fc.map(MapMode.READ_ONLY, 0, file.length());
    boolean emptyLine = true;
    int     counter = 0;

    while (buf.hasRemaining())
    {
        byte element = buf.get();

        if (element == '\r' || element == '\n') {
            if (!emptyLine) {
                counter += 1;
                emptyLine = true;
            }
        } else 
            emptyLine = false;

    }

    long after = System.currentTimeMillis() - bef;

    System.out.println("timeNioReader      Time: " + after + " Result: " + counter);

} 
```

Here are the warmed up results for a 89MB file:

```
timeBufferedReader Time: 947 Result: 747656
timeFileReader     Time: 670 Result: 747656
timeNioReader      Time: 251 Result: 747656 
```

NIO is 2.5x faster than FileReader and 4x fastser than the BufferedReader!

With a 6.4MB file the results are even better, although the warm up time is much longer.

```
//jvm start, warming up
timeBufferedReader Time: 121 Result: 53404
timeFileReader     Time: 65 Result: 53404
timeNioReader      Time: 40 Result: 53404

//still warming up
timeBufferedReader Time: 107 Result: 53404
timeFileReader     Time: 60 Result: 53404
timeNioReader      Time: 20 Result: 53404

//ripping along
timeBufferedReader Time: 79 Result: 53404
timeFileReader     Time: 56 Result: 53404
timeNioReader      Time: 16 Result: 53404 
```

Make of it what you will.

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2009-03-27T03:44:06.810

最简单的方法是使用扫描仪（是的，我喜欢冗长的代码......你可以让它在物理上更短）。Scanner() 还接受 File、Reader 等......所以你可以传递任何你有的东西。

```
import java.util.Scanner;

public class Main
{
    public static void main(final String[] argv)
    {
        final Scanner scanner;
        final int     lines;

        scanner = new Scanner("Hello\n\n\nEvil\n\nWorld");
        lines   = countLines(scanner);
        System.out.println("lines = "  + lines);
    }

    private static int countLines(final Scanner scanner)
    {
        int lines;

        lines = 0;

        while(scanner.hasNextLine())
        {
            final String line;

            line = scanner.nextLine();

            if(line.length() > 0)
            {
                lines++;
            }
        }

        return lines;
    }
} 
```

* * *

## 回答 #4

> 赞同：2
> 
> 时间：2009-03-27T20:53:14.730

If it really must be the fastest possible, you should look into [NIO](http://java.sun.com/j2se/1.4.2/docs/guide/nio/). And then, **test** your code on your target platform to see if it's really and truly better using NIO. I was able to get an order of magnitude improvement in some code I was playing with for the [Netflix Prize](http://www.netflixprize.com/). It involved parsing thousands of files into a more compact, quick-loading binary format. NIO was a big help on my (slow) development laptop.

# ruby - 从 ruby 中的索引/值枚举

> ID：688432
> 
> 赞同：2
> 
> 时间：2009-03-27T03:29:43.117
> 
> 标签：ruby, enumeration

所以我得到了这个大屁股集合对吗？它的树支持（RBTree），因此查找速度很快，并且对值进行了排序。

假设我得到了 X 值。我可以在登录时间内在我的树中查找 X，很酷。但我也想要树中 X 右侧的值，直到其中一个满足测试。即，获取 >= X 和 < Y 的所有元素

我*可以*得到 X, i 的索引，然后得到 i+1, i+2.... 的值，直到 val(i+z) > Y。除了花费 z * logn。如果您在树上进行枚举，则树内的枚举器不会花费 logn 来继续下一个元素 - 它只是跟随树中的指针。

那么，有没有办法从特定的索引开始枚举呢？这样我就不必跳过 i 元素，然后我就可以开始枚举我想要的范围了。

告诉我你是否认为我疯了。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2009-03-27T18:29:32.623

好吧，如果您自己将集合的元素放在那里，并且不介意在插入之前对它们进行排序，则可以用链表类型包装它们。只需确保每个元素的链表项包装器的键使用元素的键作为其树排序的键。然后查找将为您提供链接列表中的位置，您可以从那里步行。

但是，如果你不能那样做，你唯一的办法就是修改 RBTree，这需要在 C 中做一些工作，因为它是 ruby​​ 的原生扩展。您需要的大部分内容已经在那里`dict_lookup()`为您提供所需的树中的节点，并向您`rbtree_for_each()`展示如何在给定起始节点的情况下编写迭代器。

您必须将以下代码添加到 RBTree gem 中的 rbtree.c 中：

```
*** rbtree.c.orig 2009-03-27 14:14:55.000000000 -0400
--- rbtree.c  2009-03-27 14:20:21.000000000 -0400
***************
*** 528,533 ****
--- 528,574 ----
      return EACH_NEXT;
  }

+ static VALUE
+ rbtree_each_starting_with_body(rbtree_each_arg_t* arg)
+ {
+     VALUE self = arg->self;
+     dict_t* dict = DICT(self);
+     dnode_t* node;
+     
+     ITER_LEV(self)++;
+     for (node = (dnode_t*) arg->arg;
+          node != NULL;
+          node = dict_next(dict, node)) {
+         
+         if (arg->func(node, NULL) == EACH_STOP)
+             break;
+     }
+     return self;
+ }
+ 
+ /*
+  * call-seq:
+  *   rbtree.each_starting_with(key) {|key, value| block} => rbtree
+  *
+  * Calls block once for each key in order, starting with the given key,
+  * passing the key and value as a two-element array parameters.
+  */
+ VALUE
+ rbtree_each_starting_with(VALUE self, VALUE key)
+ {
+     dnode_t* node = dict_lookup(DICT(self), TO_KEY(key));
+     rbtree_each_arg_t each_arg;
+     if (node == NULL) { return self; };
+     
+     RETURN_ENUMERATOR(self, 0, NULL);
+ 
+     each_arg.self = self;
+     each_arg.func = each_i;
+     each_arg.arg = node;
+     return rb_ensure(rbtree_each_starting_with_body, (VALUE)&each_arg,
+                      rbtree_each_ensure, self);
+ }
+ 
  /*
   * call-seq:
   *   rbtree.each {|key, value| block} => rbtree
***************
*** 1616,1621 ****
--- 1657,1663 ----
      rb_define_method(MultiRBTree, "length", rbtree_size, 0);

      rb_define_method(MultiRBTree, "each", rbtree_each, 0);
+     rb_define_method(MultiRBTree, "each_starting_with", rbtree_each_starting_with, 1);
      rb_define_method(MultiRBTree, "each_value", rbtree_each_value, 0);
      rb_define_method(MultiRBTree, "each_key", rbtree_each_key, 0);
      rb_define_method(MultiRBTree, "each_pair", rbtree_each_pair, 0); 
```

然后如果你`make`在安装的 rbtree gem 的源目录中运行，它应该重新制作扩展，你可以正常使用它：

```
% irb
irb> require 'rubygems'
=> true
irb> require 'rbtree'
=> true
irb> x = RBTree[ 'a', 1, 'b', 2, 'c', 3, 'd', 4 ]
=> #<RBTree: {"a"=>1, "b"=>2, "c"=>3, "d"=>4}, default=nil, cmp_proc=nil>
irb> x.each { |k,v| p [k, v] }
["a", 1]
["b", 2]
["c", 3]
["d", 4]
=> #<RBTree: {"a"=>1, "b"=>2, "c"=>3, "d"=>4}, default=nil, cmp_proc=nil>
irb> x.each_starting_with('b') { |k,v| p [k, v] }
["b", 2]
["c", 3]
["d", 4]
=> #<RBTree: {"a"=>1, "b"=>2, "c"=>3, "d"=>4}, default=nil, cmp_proc=nil> 
```

请记住您已经进行了此更改，并将修改后的 gem 与您的更改一起分发。或者，嘿，将它们提交给[Rubyforge 上的 gem 创建者](http://rubyforge.org/projects/rbtree/)，这样每个人都可以利用它们。

# c# - C# 版本和 .NET Framework 版本？

> ID：688441
> 
> 赞同：16
> 
> 时间：2009-03-27T03:34:35.380
> 
> 标签：c#, frameworks

我对 C# 版本和 .NET 框架版本感到困惑。换句话说，我想知道与 C# 版本和 .NET 框架的关系。例如：.NET 框架 3.0 中的 C# 版本是什么？

* * *

## 回答 #1

> 赞同：23
> 
> 时间：2009-03-27T03:36:20.493

我不确定您的实际问题是什么，但如果是当前版本的话..

[C#：3.0](http://msdn.microsoft.com/en-us/vcsharp/aa336745.aspx)
[.NET 框架：3.5](http://msdn.microsoft.com/en-us/netframework/default.aspx)

您可能还想看看[这个细分图表](http://bloggingabout.net/blogs/fernando/archive/2009/01/11/net-framework-release-map.aspx)。它提供了框架、语言和 CLR 关系。 ![](https://farm4.static.flickr.com/3339/3189463779_9208053730_b.jpg)

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2009-03-27T04:08:12.117

C# 1.0 - 托管代码

C# 2.0 - 泛型、可空类型、匿名委托、部分类/方法

C# 3.0 - LINQ、Lambda 表达式、隐式变量类型、简化的对象初始化

// 有关的？可能有点

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2009-03-27T03:45:55.917

.net 2 C# 2

.net 3 C# 2

.net 3.5 C# 3

# c++ - 定义自己的异常类的最佳实践？

> ID：688447
> 
> 赞同：33
> 
> 时间：2009-03-27T03:37:53.737
> 
> 标签：c++, exception, inheritance, error-handling

我有一些特殊的异常情况要抛出和捕获，所以我想定义自己的异常类。

这方面的最佳做法是什么？我应该从`std::exception`or继承`std::runtime_error`吗？

* * *

## 回答 #1

> 赞同：26
> 
> 时间：2009-03-27T03:50:33.440

是的，[继承](https://isocpp.org/wiki/faq/exceptions#what-to-throw)自`std::runtime_error`或[其他标准异常类](http://en.cppreference.com/w/cpp/error/exception)（如 等`std::logic_error`）是一种很好的做法`std::invalid_argument`，具体取决于它是哪种异常。

如果所有异常都从某种方式继承，`std::exception`则很容易通过`catch(const std::exception &e) {...}`. 如果您有几个独立的层次结构，这会变得更加复杂。从专门的异常类派生使这些异常携带更多信息，但这真正有用的程度取决于您如何进行异常处理。

* * *

## 回答 #2

> 赞同：6
> 
> 时间：2009-03-27T04:21:49.980

我不是 C++ 开发人员，但我们在 C# 代码中做的一件事是为我们的框架创建一个基类异常，然后记录构造函数中抛出的异常：

```
 public FrameworkException(string message, Exception innerException)
      : base(message, innerException)
  {
      log.Error(message, innerException);
  }

  ... 
```

任何派生的异常只需要调用它的基本构造函数，我们就可以在整个过程中获得一致的异常日志记录。没什么大不了的，但很有用。

* * *

## 回答 #3

> 赞同：3
> 
> 时间：2009-03-27T08:10:56.077

将异常放在某个范围内是一件好事。例如类 Manipulation 可以在异常类 Error 中声明。

抓住他们喜欢

```
catch ( const Manipulation::InputError& error )
catch ( const Manipulation::CalculationError& error ) 
```

在这种情况下，它们可能只是没有任何附加错误信息的空类，除非您设计允许这些异常在您捕获所有标准异常的地方飞得更高。

* * *

## 回答 #4

> 赞同：2
> 
> 时间：2009-03-27T03:44:04.733

在我看来，是否从 std::exception 继承并不重要。对我来说，定义异常最重要的是：

1.  让异常类名称有用且清晰。
2.  清楚地记录（写注释）什么时候异常会被函数或类方法抛出。在我看来，这是异常处理中最大的一个失败点。

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2009-03-27T03:46:53.137

它没有太大的区别，因为`std::runtime_error`也继承自`std::exception`. 您可能会争辩说运行时错误传达了有关异常的更多信息，但实际上，人们通常只是从基异常类派生而来。

# .net - .NET 组件和 COM 组件有什么区别

> ID：688456
> 
> 赞同：22
> 
> 时间：2009-03-27T03:42:23.227
> 
> 标签：.net, com

.NET 组件和 COM 组件有什么区别，有时我们使用 .NET 组件包含在我们的项目中，有时我们包含 COM 引用。背后的想法是什么？

* * *

## 回答 #1

> 赞同：15
> 
> 时间：2009-03-27T03:51:22.673

.NET 组件是托管代码（已为您完成内存处理）

[COM](http://en.wikipedia.org/wiki/Component_Object_Model)是软件组件的接口标准。COM 组件是非托管代码（使用引用计数执行内存处理）。

从[这里](http://www.microsoft.com/com/default.mspx)：

> **COM 和 .NET 有什么关系？**
> 
> COM 和 .NET 是互补的开发技术。.NET 公共语言运行时提供与 COM 的双向透明集成。这意味着 COM 和 .NET 应用程序和组件可以使用每个系统的功能。这可以保护您对 COM 应用程序的现有投资，同时允许您以可控的速度利用 .NET。COM 和.NET 可以达到类似的效果。.NET Framework 为开发人员提供了大量的好处，包括更强大、基于证据的安全模型、自动内存管理和本机 Web 服务支持。对于新的开发，Microsoft 建议将 .NET 作为首选技术，因为它具有强大的托管运行时环境和服务。

* * *

## 回答 #2

> 赞同：7
> 
> 时间：2009-03-27T03:58:37.210

COM 组件是非托管 C++ 代码组件，旨在使软件在二进制级别上可重用。NET 组件虽然相似 1) 它们可以在 CLR 语言上创建，而 COM 组件只能使用 C++ 构建 2) 它们旨在在托管运行时下运行。我认为这些是*本质*的区别。

编辑：

C++ 是 COM 中最“自然”的语言，但 COM 组件可以用多种语言创建。感谢评论的人。

* * *

## 回答 #3

> 赞同：5
> 
> 时间：2009-03-27T03:53:59.657

.NET 组件在 CLR 中运行，而 COM 组件本质上是本机 Windows DLL。

.NET 组件还公开了比 COM 组件多得多的元数据。进行这种重新设计的部分原因是为了使组件更具互操作性。特别是，.NET 组件不对数据布局和调用约定做出特定于平台的假设。

见[唐箱](http://www.amazon.com/exec/obidos/search-handle-url/ref=ntt_athr_dp_sr_1?_encoding=UTF8&search-type=ss&index=books&field-author=Don%20Box)。

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2009-03-27T07:04:50.757

有关此主题的更多信息

CCW：http: [//msdn.microsoft.com/en-us/library/f07c8z1c.aspx](http://msdn.microsoft.com/en-us/library/f07c8z1c.aspx)

RCW：[http ://en.wikipedia.org/wiki/Runtime_Callable_Wrapper](http://en.wikipedia.org/wiki/Runtime_Callable_Wrapper)

# java - 当您需要存储（非常）大的数字时该怎么办？

> ID：688460
> 
> 赞同：8
> 
> 时间：2009-03-27T03:45:14.450
> 
> 标签：java, numbers, long-integer

我正在尝试做一个[Project Euler](https://projecteuler.net/problems)问题，但它涉及添加一个非常大的数字的数字。（100 个！）

使用 Java 的 int 和 long 太小了。

感谢您的任何建议

* * *

## 回答 #1

> 赞同：20
> 
> 时间：2009-03-27T03:47:04.367

[BigInteger](http://docs.oracle.com/javase/7/docs/api/java/math/BigInteger.html)类 看起来可能是您正在寻找的东西。

* * *

## 回答 #2

> 赞同：14
> 
> 时间：2009-03-27T03:47:22.543

使用[BigInteger](http://java.sun.com/j2se/1.4.2/docs/api/java/math/BigInteger.html)。这是*Java Examples in a Nutshell*一书中的一个[例子](http://www.java2s.com/Code/Java/Development-Class/BigIntegerdemo.htm)，它涉及计算阶乘和缓存。

 *```
import java.math.BigInteger;
import java.util.ArrayList;

/*
 * Copyright (c) 2000 David Flanagan.  All rights reserved.
 * This code is from the book Java Examples in a Nutshell, 2nd Edition.
 * It is provided AS-IS, WITHOUT ANY WARRANTY either expressed or 
 * implied. You may study, use, and modify it for any non-commercial 
 * purpose. You may distribute it non-commercially as long as you 
 * retain this notice. For a commercial use license, or to purchase 
 * the book (recommended), visit 
 * http://www.davidflanagan.com/javaexamples2.
 */

/**
 * This program computes and displays the factorial of a number 
 * specified on the command line. It handles possible user input 
 * errors with try/catch.
 */
public class FactComputer {
  public static void main(String[] args) {
    // Try to compute a factorial.
    // If something goes wrong, handle it in the catch clause below.
    try {
      int x = Integer.parseInt(args[0]);
      System.out.println(x + "! = " + Factorial4.factorial(x));
    }
    // The user forgot to specify an argument.
    // Thrown if args[0] is undefined.
    catch (ArrayIndexOutOfBoundsException e) {
      System.out.println("You must specify an argument");
      System.out.println("Usage: java FactComputer <number>");
    }
    // The argument is not a number. Thrown by Integer.parseInt().
    catch (NumberFormatException e) {
      System.out.println("The argument you specify must be an integer");
    }
    // The argument is < 0\. Thrown by Factorial4.factorial()
    catch (IllegalArgumentException e) {
      // Display the message sent by the factorial() method:
      System.out.println("Bad argument: " + e.getMessage());
    }
  }
}

/**
 * This version of the program uses arbitrary precision integers, so it 
 * does not have an upper-bound on the values it can compute. It uses an 
 * ArrayList object to cache computed values instead of a fixed-size 
 * array. An ArrayList is like an array, but can grow to any size. The 
 * factorial() method is declared "synchronized" so that it can be safely 
 * used in multi-threaded programs. Look up java.math.BigInteger and
 * java.util.ArrayList while studying this class.
 * Prior to Java 1.2, use Vector instead of ArrayList
 */

class Factorial4 {
  protected static ArrayList table = new ArrayList(); // create cache
  static { // Initialize the first element of the cache with !0 = 1.
    table.add(BigInteger.valueOf(1));
  }

  /** The factorial() method, using BigIntegers cached in a ArrayList */
  public static synchronized BigInteger factorial(int x) {
    if (x < 0)
      throw new IllegalArgumentException("x must be non-negative.");
    for (int size = table.size(); size <= x; size++) {
      BigInteger lastfact = (BigInteger) table.get(size - 1);
      BigInteger nextfact = lastfact.multiply(BigInteger.valueOf(size));
      table.add(nextfact);
    }
    return (BigInteger) table.get(x);
  }

  /**
   * A simple main() method that we can use as a standalone test 
   * program for our factorial() method.
   */
  public static void main(String[] args) {
    for (int i = 0; i <= 50; i++)
      System.out.println(i + "! = " + factorial(i));
  }
} 
```

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2009-03-27T03:46:33.357

java.lang.BigInteger 或 java.lang.BigDecimal

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2014-04-20T14:31:37.230

```
import java.math.BigInteger;
import java.util.*;

public class Main {
    protected static ArrayList<BigInteger> table = new ArrayList<BigInteger>();

    static {
        table.add(BigInteger.valueOf(1));
    }

    public static synchronized BigInteger factorial(int x) {
        if (x < 0) throw new IllegalArgumentException("x must be non-negative.");
        for (int size = table.size(); size <= x; size++) {
            BigInteger lastfact = table.get(size - 1);
            BigInteger nextfact = lastfact.multiply(BigInteger.valueOf(size));
            table.add(nextfact);
        }
        return table.get(x);
    }

    public static void main(String[] args) {
        for (int i = 0; i <= 50; i++)
            System.out.println(i + "! = " + factorial(i));
    }
} 
```

# python - 在 Python 中读取和分组数据列表

> ID：688461
> 
> 赞同：0
> 
> 时间：2009-03-27T03:45:46.120
> 
> 标签：python, list

我一直在努力管理一些数据。我有数据已变成列表列表，每个基本子列表的结构如下

```
<1x>begins
<2x>value-1
<3x>value-2
<4x>value-3
 some indeterminate number of other values
<1y>next observation begins
<2y>value-1
<3y>value-2
<4y>value-3
 some indeterminate number of other values 
```

这在每个子列表中持续了不确定的次数

编辑我需要将所有出现的 <2,<3 & <4 分开并组合在一起我正在创建一个新的列表列表 [[<2x>value-1,<3x>value-2, <4x>value -3], [<2y>value-1, <3y>value-2, <4y>value-3]]

编辑 <4x> 和 <4y> 之后的所有行（就此而言，<4anyalpha> 具有相同类型的编码，我不知道先验数字可以达到多高 - 只需将这些视为 sgml未关闭的标签我使用数字是因为我的手指因我今天所做的所有编码而受伤。

我最终提出的解决方案不是很漂亮

```
 listINeed=[]
 for sublist in biglist:
    for line in sublist:
        if '<2' in line:
            var2=line
        if '<3' in line:
            var3=line
        if '<4' in line:
            var4=line
            templist=[]
            templist.append(var2)
            templist.append(var3)
            templist.append(var4)
            listIneed.append(templist)
            templist=[]
            var4=var2=var3='' 
```

我已经研究了尝试清理它的方法，但没有成功。这很好用，我只是将其视为了解更多有关 python 的另一个机会，因为我认为这应该可以由单行函数处理。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-03-27T03:49:53.643

通过注意到您的原始解决方案可能有效但缺乏优雅，您有了一个良好的开端。

您应该在循环中解析字符串，为每一行创建一个新变量。这是一些示例代码：

```
import re

s = """<1x>begins
<2x>value-1
<3x>value-2
<4x>value-3
 some indeterminate number of other values
<1y>next observation begins
<2y>value-1
<3y>value-2
<4y>value-3"""
firstMatch = re.compile('^\<1x')
numMatch = re.compile('^\<(\d+)')
listIneed = []
templist = None
for line in s.split():
        if firstMatch.match(line):
                if templist is not None: 
                        listIneed.append(templist)
                templist = [line]
        elif numMatch.match(line):
            #print 'The matching number is %s' % numMatch.match(line).groups(1)
            templist.append(line)
if templist is not None: listIneed.append(templist)

print listIneed 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-03-27T03:50:57.527

如果您想挑选每个子列表的第二个、第三个和第四个元素，这应该可以：

```
listINeed = [sublist[1:4] for sublist in biglist] 
```

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2009-03-27T03:56:19.277

[itertools.groupby()](http://docs.python.org/library/itertools.html#itertools.groupby)可以帮助您。

```
itertools.groupby(biglist, operator.itemgetter(2)) 
```

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2009-03-27T13:33:48.077

如果我正确理解了您的问题：

```
import re
def getlines(ori):
    matches = re.finditer(r'(<([1-4])[a-zA-Z]>.*)', ori)
    mainlist = []
    sublist = []
    for sr in matches:
        if int(sr.groups()[1]) == 1:
            if sublist != []:
                mainlist.append(sublist)
            sublist = []
        else:
            sublist.append(sr.groups()[0])
    else:
        mainlist.append(sublist)
    return mainlist 
```

...如果您想使用正则表达式，将为您完成这项工作。

下面的版本会将所有数据分解为子列表（不仅仅是每个分组中的前四个），这可能更有用，具体取决于您需要对数据执行的其他操作。使用 David 的 listINeed = [sublist[1:4] for sublist in biglist] 从上述特定任务的每个列表中获取前四个结果。

```
import re
def getlines(ori):
    matches = re.finditer(r'(<(\d*)[a-zA-Z]>.*)', ori)
    mainlist = []
    sublist = []
    for sr in matches:
        if int(sr.groups()[1]) == 1:
            print "1 found!"
            if sublist != []:
                mainlist.append(sublist)
            sublist = []
        else:
            sublist.append(sr.groups()[0])
    else:
        mainlist.append(sublist)
    return mainlist 
```

# nvelocity - 如何让 NVelocity 正确初始化？

> ID：688465
> 
> 赞同：2
> 
> 时间：2009-03-27T03:46:36.100
> 
> 标签：nvelocity

我无法让 NVelocity 初始化。我不想做任何复杂的事情，所以如果它以默认值初始化就可以了，但它甚至不会这样做。

这：

```
VelocityEngine velocity = new VelocityEngine();
ExtendedProperties props = new ExtendedProperties();
velocity.Init(props); 
```

结果：“似乎没有将类指定为 ResourceManager...”

这样做也是如此：

```
VelocityEngine velocity = new VelocityEngine();
velocity.Init(); 
```

我可以找到关于属性应该是什么的宝贵文档，以及如何使用简单的默认值对其进行初始化。任何人都可以指向资源吗？

很多页面都指向这个页面：

[http://www.castleproject.org/others/nvelocity/usingit.html](http://www.castleproject.org/others/nvelocity/usingit.html)

但是这个页面跳过了（看似）最重要的一点——如何设置属性以及将它们设置为什么。

我只想从文件中加载一个简单的模板。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-03-29T05:33:19.337

这是我发现的——

我使用的是原始的 NVelocity 库，该库自 2003 年以来没有更新。我认为这是一个死项目。

我切换到 Castle Project 版本，它更容易 - 事实上，它运行起来很像我链接到的页面上的示例。它似乎为属性设置了智能默认值。我可以在不设置任何属性的情况下对其进行初始化，但是模板目录默认为“。”，所以我通常设置那个（*在*运行“init”之前进行）。

要获得正确的 DLL，您需要下载最新的 NVelocity 版本（在撰写本文时它是 1.1）。

[城堡项目下载页面](http://www.castleproject.org/castle/download.html)

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-06-11T12:00:30.727

您需要在程序集中包含以下文件，并确保它们的类型设置为“资源”

```
src\Runtime\Defaults\directive.properties

src\Runtime\Defaults\nvelocity.properties 
```

然后这些将由 ResourceLocator 找到

```
src\Runtime\Resource\Loader\ResourceLocator.cs 
```

如果您`GetManifestResourceNames()`在尝试运行 Dvsl 时遇到异常，请尝试修改 ResourceLocator 构造函数以捕获并忽略错误，因为所需的文件在您的本地程序集中（如果您在上面包含它们）并且该异常仅由引发外部程序集（不知道为什么）。

```
 foreach(Assembly a in assemblies) {
        String prefix = a.FullName.Substring(0,a.FullName.IndexOf(",")).ToLower();
        try
        {
            String[] names = a.GetManifestResourceNames();
            foreach (String s in names)
            {
                if (s.ToLower().Equals(fn) || s.ToLower().Equals(prefix + "." + fn))
                {
                    this.filename = s;
                    assembly = a;
                    isResource = true;
                }
            }
        } catch {
        }
  } 
```

# c++ - 可变大小结构 C++

> ID：688471
> 
> 赞同：20
> 
> 时间：2009-03-27T03:48:23.337
> 
> 标签：c++, struct, variable-length

这是在 C++ 中制作可变大小结构的最佳方法吗？我不想使用向量，因为初始化后长度不会改变。

```
struct Packet
{
    unsigned int bytelength;
    unsigned int data[];
};

Packet* CreatePacket(unsigned int length)
{
    Packet *output = (Packet*) malloc((length+1)*sizeof(unsigned int));
    output->bytelength = length;
    return output;
} 
```

编辑：重命名变量名称并更改代码以更正确。

* * *

## 回答 #1

> 赞同：9
> 
> 时间：2009-03-27T05:15:01.753

关于你在做什么的一些想法：

*   使用 C 风格的可变长度结构习惯用法允许您为每个数据包执行一次免费存储分配，如果`struct Packet`包含`std::vector`. 如果您要分配**大量**数据包，那么执行一半的空闲存储分配/解除分配可能非常重要。如果你也在做网络访问，那么等待网络所花费的时间可能会更重要。

*   这个结构代表一个数据包。您是否打算从套接字直接读/写到`struct Packet`? 如果是这样，您可能需要考虑字节顺序。发送数据包时是否必须将主机字节顺序转换为网络字节顺序，接收数据包时反之亦然？如果是这样，那么您可以在可变长度结构中对数据进行字节交换。如果您将其转换为使用向量，则编写用于序列化/反序列化数据包的方法是有意义的。这些方法会将其传输到/从连续缓冲区中传输，同时考虑字节顺序。

*   同样，您可能需要考虑对齐和打包。

*   你永远不能继承`Packet`. 如果你这样做了，那么子类的成员变量将与数组重叠。

*   代替`malloc`and `free`，您可以使用`Packet* p = ::operator new(size)`and `::operator delete(p)`，因为`struct Packet`它是一种 POD 类型，并且当前不能从调用其默认构造函数和析构函数中受益。这样做的（潜在）好处是全局`operator new`使用全局 new-handler 和/或异常来处理错误，如果这对您很重要的话。

*   可以使变长 struct idiom 与 new 和 delete 运算符一起使用，但效果不佳。您可以通过实现来创建一个`operator new`采用数组长度的自定义`static void* operator new(size_t size, unsigned int bitlength)`，但您仍然必须设置 bitlength 成员变量。如果您使用构造函数执行此操作，则可以使用稍微冗余的表达式`Packet* p = new(len) Packet(len)`来分配数据包。与使用 global 相比，我看到的唯一好处`operator new`是`operator delete`您的代码的客户端可以只调用`delete p`而不是`::operator delete(p)`. `delete p`只要它们被正确调用，将分配/释放包装在单独的函数中（而不是直接调用）就可以了。

* * *

## 回答 #2

> 赞同：7
> 
> 时间：2009-03-27T04:03:22.537

如果您从未使用 malloc/free 向您的结构中添加构造函数/析构函数、赋值运算符或虚函数进行分配是安全的。

它在 c++ 圈子中不受欢迎，但如果你在代码中记录它，我认为它的使用是可以的。

对您的代码的一些评论：

```
struct Packet
{
    unsigned int bitlength;
    unsigned int data[];
}; 
```

如果我记得正确声明没有长度的数组是非标准的。它适用于大多数编译器，但可能会给你一个警告。如果您想符合要求，请声明长度为 1 的数组。

```
Packet* CreatePacket(unsigned int length)
{
    Packet *output = (Packet*) malloc((length+1)*sizeof(unsigned int));
    output->bitlength = length;
    return output;
} 
```

这可行，但您没有考虑结构的大小。一旦您将新成员添加到您的结构中，代码就会中断。最好这样做：

```
Packet* CreatePacket(unsigned int length)
{
    size_t s = sizeof (Packed) - sizeof (Packed.data);
    Packet *output = (Packet*) malloc(s + length * sizeof(unsigned int));
    output->bitlength = length;
    return output;
} 
```

并在您的数据包结构定义中写入一条注释数据必须是最后一个成员。

顺便说一句 - 通过一次分配分配结构和数据是一件好事。通过这种方式，您可以将分配数量减半，并且还可以改善数据的局部性。如果您分配大量包，这可以大大提高性能。

不幸的是，c++ 没有提供一个很好的机制来做到这一点，所以你经常在现实世界的应用程序中遇到这样的 malloc/free hacks。

* * *

## 回答 #3

> 赞同：5
> 
> 时间：2009-03-27T04:38:39.347

这没关系（并且是 C 的标准做法）。

但这对 C++ 来说不是一个好主意。
这是因为编译器会围绕类自动为您生成一整套其他方法。这些方法不明白你作弊了。

例如：

```
void copyRHSToLeft(Packet& lhs,Packet& rhs)
{
    lhs = rhs;  // The compiler generated code for assignement kicks in here.
                // Are your objects going to cope correctly??
}

Packet*   a = CreatePacket(3);
Packet*   b = CreatePacket(5);
copyRHSToLeft(*a,*b); 
```

使用 std::vector<> 它更安全并且可以正常工作。
我还敢打赌，它与优化器启动后的实现一样有效。

或者 boost 包含一个固定大小的数组： http:
[//www.boost.org/doc/libs/1_38_0/doc/html/array.html](http://www.boost.org/doc/libs/1_38_0/doc/html/array.html)

* * *

## 回答 #4

> 赞同：3
> 
> 时间：2009-03-27T14:03:40.953

如果需要，您可以使用“C”方法，但为了安全起见，编译器不会尝试复制它：

```
struct Packet
{
    unsigned int bytelength;
    unsigned int data[];

private:
   // Will cause compiler error if you misuse this struct
   void Packet(const Packet&);
   void operator=(const Packet&);
}; 
```

* * *

## 回答 #5

> 赞同：2
> 
> 时间：2009-03-27T04:45:10.873

我可能会坚持使用 a `vector<>`，除非最小的额外开销（可能是一个额外的单词或您的实现上的指针）确实造成了问题。没有什么说一旦构建了向量就必须 resize() 。

但是，有几个优点`vector<>`：

*   它已经正确处理复制、分配和销毁 - 如果您自己滚动，您需要确保正确处理这些
*   所有的迭代器支持都在那里——同样，你不必自己动手。
*   每个人都已经知道如何使用它

如果您真的想防止数组在构造后增长，您可能需要考虑拥有自己的类，该类从`vector<>`私有继承或具有`vector<>`成员，并且仅通过仅通过 thunk 到向量方法的方法公开您希望客户端的向量位能够使用。这应该可以帮助您快速进行，并且可以很好地保证泄漏和不存在的内容。如果您这样做并且发现 vector 的小开销对您不起作用，您可以在没有 vector 帮助的情况下重新实现该类，并且您的客户端代码不需要更改。

* * *

## 回答 #6

> 赞同：1
> 
> 时间：2009-03-27T09:22:20.863

这里已经提到了很多好的想法。但是缺少一个。灵活数组是 C99 的一部分，因此不是 C++ 的一部分，尽管某些 C++ 编译器可能提供此功能，但不能保证这一点。如果您找到一种在 C++ 中以可接受的方式使用它们的方法，但您的编译器不支持它，您也许可以回退到[“经典”方式](https://stackoverflow.com/questions/246977/flexible-array-members-in-c-bad/247040#247040)

* * *

## 回答 #7

> 赞同：0
> 
> 时间：2009-03-27T10:44:18.220

您可能想要比向量更轻的东西来获得高性能。您还希望非常具体地了解跨平台数据包的大小。但是您也不想担心内存泄漏。

幸运的是，boost 库完成了大部分困难的部分：

```
struct packet
{
   boost::uint32_t _size;
   boost::scoped_array<unsigned char> _data;

   packet() : _size(0) {}

       explicit packet(packet boost::uint32_t s) : _size(s), _data(new unsigned char [s]) {}

   explicit packet(const void * const d, boost::uint32_t s) : _size(s), _data(new unsigned char [s])
   {
        std::memcpy(_data, static_cast<const unsigned char * const>(d), _size);
   }
};

typedef boost::shared_ptr<packet> packet_ptr;

packet_ptr build_packet(const void const * data, boost::uint32_t s)
{

    return packet_ptr(new packet(data, s));
} 
```

* * *

## 回答 #8

> 赞同：0
> 
> 时间：2009-03-27T04:02:55.907

如果您真的在使用 C++，那么除了默认成员可见性之外，类和结构之间没有实际区别——类默认具有私有可见性，而结构默认具有公共可见性。以下是等价的：

```
struct PacketStruct
{
    unsigned int bitlength;
    unsigned int data[];
};
class PacketClass
{
public:
    unsigned int bitlength;
    unsigned int data[];
}; 
```

关键是，您不需要 CreatePacket()。您可以简单地使用构造函数初始化结构对象。

```
struct Packet
{
    unsigned long bytelength;
    unsigned char data[];

    Packet(unsigned long length = 256)  // default constructor replaces CreatePacket()
      : bytelength(length),
        data(new unsigned char[length])
    {
    }

    ~Packet()  // destructor to avoid memory leak
    {
        delete [] data;
    }
}; 
```

有几点需要注意。在 C++ 中，使用 new 而不是 malloc。我采取了一些自由并将位长度更改为字节长度。如果这个类代表一个网络数据包，你会更好地处理字节而不是位（在我看来）。数据数组是一个无符号字符数组，而不是无符号整数。同样，这是基于我的假设，即此类表示网络数据包。构造函数允许您像这样创建一个数据包：

```
Packet p;  // default packet with 256-byte data array
Packet p(1024);  // packet with 1024-byte data array 
```

当 Packet 实例超出范围并防止内存泄漏时，会自动调用析构函数。

* * *

## 回答 #9

> 赞同：0
> 
> 时间：2009-03-27T20:23:30.433

将向量用于初始化后将修复的未知大小的数组没有任何问题。恕我直言，这正是向量的用途。一旦你初始化了它，你就可以假装它是一个数组，它的行为应该是一样的（包括时间行为）。

* * *

## 回答 #10

> 赞同：0
> 
> 时间：2009-03-27T04:10:17.650

您应该声明一个指针，而不是一个未指定长度的数组。

* * *

## 回答 #11

> 赞同：0
> 
> 时间：2021-02-07T12:26:52.037

*免责声明：*我写了一个小库来探索这个概念：[https ://github.com/ppetr/refcounted-var-sized-class](https://github.com/ppetr/refcounted-var-sized-class)

`T`我们想为 type 的数据结构和 type的元素数组分配一块内存`A`。在大多数情况下`A`将只是`char`.

为此，让我们定义一个[RAII](https://en.wikipedia.org/wiki/Resource_acquisition_is_initialization)类来分配和释放这样的内存块。这带来了几个困难：

*   C++[分配器](https://en.cppreference.com/w/cpp/memory/allocator)不提供这样的 API。因此，我们需要自己分配 plain`char`并将结构放入块中。因为这[`std::aligned_storage`](https://en.cppreference.com/w/cpp/types/aligned_storage)会有所帮助。
*   内存块必须正确[对齐](https://en.cppreference.com/w/c/language/object)。因为在 C++11 中似乎没有用于分配对齐块的 API，所以我们需要稍微过度分配`alignof(T) - 1`字节，然后使用[`std::align`](https://en.cppreference.com/w/cpp/memory/align).

```
// Owns a block of memory large enough to store a properly aligned instance of
// `T` and additional `size` number of elements of type `A`.
template <typename T, typename A = char>
class Placement {
 public:
  // Allocates memory for a properly aligned instance of `T`, plus additional
  // array of `size` elements of `A`.
  explicit Placement(size_t size)
      : size_(size),
        allocation_(std::allocator<char>().allocate(AllocatedBytes())) {
    static_assert(std::is_trivial<Placeholder>::value);
  }
  Placement(Placement const&) = delete;
  Placement(Placement&& other) {
    allocation_ = other.allocation_;
    size_ = other.size_;
    other.allocation_ = nullptr;
  }

  ~Placement() {
    if (allocation_) {
      std::allocator<char>().deallocate(allocation_, AllocatedBytes());
    }
  }

  // Returns a pointer to an uninitialized memory area available for an
  // instance of `T`.
  T* Node() const { return reinterpret_cast<T*>(&AsPlaceholder()->node); }
  // Returns a pointer to an uninitialized memory area available for
  // holding `size` (specified in the constructor) elements of `A`.
  A* Array() const { return reinterpret_cast<A*>(&AsPlaceholder()->array); }

  size_t Size() { return size_; }

 private:
  // Holds a properly aligned instance of `T` and an array of length 1 of `A`.
  struct Placeholder {
    typename std::aligned_storage<sizeof(T), alignof(T)>::type node;
    // The array type must be the last one in the struct.
    typename std::aligned_storage<sizeof(A[1]), alignof(A[1])>::type array;
  };

  Placeholder* AsPlaceholder() const {
    void* ptr = allocation_;
    size_t space = sizeof(Placeholder) + alignof(Placeholder) - 1;
    ptr = std::align(alignof(Placeholder), sizeof(Placeholder), ptr, space);
    assert(ptr != nullptr);
    return reinterpret_cast<Placeholder*>(ptr);
  }

  size_t AllocatedBytes() {
    // We might need to shift the placement of for up to `alignof(Placeholder) - 1` bytes.
    // Therefore allocate this many additional bytes.
    return sizeof(Placeholder) + alignof(Placeholder) - 1 +
           (size_ - 1) * sizeof(A);
  }

  size_t size_;
  char* allocation_;
}; 
```

一旦我们处理了内存分配的问题，我们就可以在分配的内存块中定义一个初始化的包装类`T`和一个数组。`A`

```
template <typename T, typename A = char,
          typename std::enable_if<!std::is_destructible<A>{} ||
                                      std::is_trivially_destructible<A>{},
                                  bool>::type = true>
class VarSized {
 public:
  // Initializes an instance of `T` with an array of `A` in a memory block
  // provided by `placement`. Callings a constructor of `T`, providing a
  // pointer to `A*` and its length as the first two arguments, and then
  // passing `args` as additional arguments.
  template <typename... Arg>
  VarSized(Placement<T, A> placement, Arg&&... args)
      : placement_(std::move(placement)) {
    auto [aligned, array] = placement_.Addresses();
    array = new (array) char[placement_.Size()];
    new (aligned) T(array, placement_.Size(), std::forward<Arg>(args)...);
  }

  // Same as above, with initializing a `Placement` for `size` elements of `A`.
  template <typename... Arg>
  VarSized(size_t size, Arg&&... args)
      : VarSized(Placement<T, A>(size), std::forward<Arg>(args)...) {}

  ~VarSized() { std::move(*this).Delete(); }

  // Destroys this instance and returns the `Placement`, which can then be
  // reused or destroyed as well (deallocating the memory block).
  Placement<T, A> Delete() && {
    // By moving out `placement_` before invoking `~T()` we ensure that it's
    // destroyed even if `~T()` throws an exception.
    Placement<T, A> placement(std::move(placement_));
    (*this)->~T();
    return placement;
  }

  T& operator*() const { return *placement_.Node(); }
  const T* operator->() const { return &**this; }

 private:
  Placement<T, A> placement_;
}; 
```

这种类型是可移动的，但显然不可复制。我们可以提供一个函数将其转换为`shared_ptr`带有自定义删除器的 a。但这需要在内部为引用计数器分配另一小块内存（另请参阅[如何实现 std::tr1::shared_ptr？](https://stackoverflow.com/q/9200664/1333025)）。

这可以通过引入一个专门的数据类型来解决，该数据类型将我们的`Placement`、一个引用计数器和一个具有实际数据类型的字段保存在一个结构中。有关更多详细信息，请参阅我的[refcount_struct.h](https://github.com/ppetr/refcounted-var-sized-class/blob/main/refcount_struct.h)。

# macos - 记住 OS X 中的终端状态（比如 shell 的 Fluid ......）

> ID：688472
> 
> 赞同：3
> 
> 时间：2009-03-27T03:48:26.127
> 
> 标签：macos, shell, command-line, terminal

每当我进行开发时，我都会在终端中打开一些不同的东西——日志拖尾、Ruby 控制台、某个目录中的普通 shell 等等。

我如何：

*   立即开始所有这些事情，希望在屏幕上的正确位置？
*   使它们与众不同，以便我可以使用 Quicksilver / Alt-Tab 切换到它们？

Fluid 用我所有的网络应用程序解决了这个问题，所以现在我想用我的终端来解决这个问题。

* * *

当我们讨论这个话题时，有没有人找到一个可行的解决方案让 OS X 记住外接显示器上的窗口位置？如果我拔掉它然后重新插入，我必须将所有东西拖回相同的位置（尽管至少 Mercury Mover 可以使用键盘来完成它。）

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2009-05-02T06:16:50.633

打开终端，进入首选项，然后进入设置选项卡，为您想要的每个窗口创建一个新设置。要么给他们所有不同的配色方案，要么多次复制一个配色方案，让他们都拥有相同的设置。在 shell 子选项卡下，添加要在 shell 启动时运行的“运行命令”。（这是`cd`指向您想要的目录或`tail`日志的命令）。

然后根据需要初始化窗口。然后单击主菜单中的 Window 并选择 Save Windows as Group...

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2015-05-19T18:59:00.790

在 OSX Yosemite 中，您可以使用（在终端中）Window -> Save group。它会为你做所有的工作。

# iphone - 使用 openAL 的 iPhone 应用程序可以在模拟器中运行，但不能在设备上运行

> ID：688480
> 
> 赞同：3
> 
> 时间：2009-03-27T03:51:21.940
> 
> 标签：iphone, objective-c, frameworks, openal

我将 openAL 框架添加到我的应用程序中，并且我正在使用演示 CrashLanding 中的声音引擎。它在模拟器上工作得很好，但是当我为我的设备构建它时，我得到了错误。好像没有添加框架。我试过：重启xcode；删除框架并重新添加；清洁目标；重新启动计算机。它仍然可以在模拟器上运行，但设备设置甚至无法编译。有没有人有任何其他想法或者我做错了什么？

这是一个更具体的错误，现在有 17 个：

“_alSourcePlay”，引用自：

SoundEngine.o 中的 SoundEngineEffect::PlaybackProc(void*)

SoundEngine.o 中的 SoundEngineEffect::Start()

此外，CrashLanding 在我的设备上运行良好。

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2009-03-27T04:16:34.000

删除您添加的 OpenAL 框架。

转到项目中的其他框架之一，比如 UIKit，右键单击并“在 finder 中显示”。

将您在此处找到的 OpenAL 从 Finder 窗口拖到 Frameworks 下的 XCode 中。

现在它可能会工作......有时当你说“添加现有框架”时，它似乎选择了错误的目录，你可能正在添加 OS X OpenAL 框架（这对模拟器来说很好）。

# .net - 如何找到未记录的 .NET / COM 库函数？

> ID：688485
> 
> 赞同：2
> 
> 时间：2009-03-27T03:52:56.833
> 
> 标签：.net, com, vsto

如何找出从一些 .NET 函数返回的 COM 对象的属性和方法，这些似乎没有记录在案？

在我正在查看的特定示例中，我使用以下函数将图片插入 Excel：

```
Set NewPic = ActiveSheet.Pictures.Insert(FileName) 
```

（请参阅[此处](https://stackoverflow.com/questions/521979/is-is-possible-to-insert-an-image-into-an-excel-cell-via-com)的 SO 帖子。）

然而，这个函数的[MSDN 文档](http://msdn.microsoft.com/en-us/library/microsoft.office.tools.excel.worksheet.pictures.aspx)只说 Worksheet.Pictures 返回一个对象，并且当我在调试期间监视变量时，它的类型是 System.__ComObject。我能否找出该类可能还有哪些其他属性和函数可用（例如，我想修改图片的替代文本）？发现这个功能的人怎么会`Insert`知道它？

MSDN 文档还倾向于说它们“不打算直接从您的代码中使用”这样的功能，但现在让我们忽略它......

谢谢！

* * *

**编辑：**好吧，我至少设法回答了我的具体问题。代替 using `Worksheet.Pictures.Insert`，您可以使用`Worksheet.Shapes.AddPicture`返回正确的（记录的） Excel.Shape 类：

```
pic = range.Worksheet.Shapes.AddPicture(tmpFile, Microsoft.Office.Core.MsoTriState.msoFalse, Microsoft.Office.Core.MsoTriState.msoCTrue, range.Left, range.Top, image.Width, image.Height)
pic.AlternativeText = "Help!" 
```

不过，仍然会对未记录功能的任何资源感兴趣。

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2009-03-27T04:29:52.767

找出这些东西的一种方法是使用该工具（您可以[在此处](http://www.microsoft.com/downloads/details.aspx?familyid=5233b70d-d9b2-4cb5-aeb6-45664be858b6&displaylang=en)`OleView`从 Microsoft 下载）。此工具允许您查看 COM 类型库。类型库（假设 COM 组件的供应商提供了类型库信息）包含有关接口以及应用程序或库公开的 COM 类的方法和属性的信息。

例如，在我的机器上，我可以查看类型库`C:\Program Files\Microsoft Office\Office12\EXCEL.EXE`并查看 Excel 公开了哪些 COM 对象，以及它们的属性和方法。`OleView`以 IDL（接口描述语言）显示信息，它或多或少是一个带有额外属性的 C 函数原型）。

这是我`OleView`用于该`__Worksheet.Pictures`属性的 IDL 声明：

```
 [id(0x00000303), hidden, helpcontext(0x00010303)]
    HRESULT Pictures(
                    [in, optional] VARIANT Index, 
                    [in, lcid] long lcid, 
                    [out, retval] IDispatch** RHS); 
```

注意`hidden`声明中的属性。这意味着它不会被大多数 IDE 显示（并且是一个很好的提示，不要依赖始终存在的这种方法 - Microsoft 可以在更高版本的 Excel 中将其删除）。

现在`Pictures`上课呢？这是完整的 IDL：

```
[
  uuid(000208A7-0000-0000-C000-000000000046),
  helpcontext(0x00020067),
  hidden
]
dispinterface Pictures {
    properties:
    methods:
        [id(0x60000000), restricted]
        void QueryInterface(
                        [in] GUID* riid, 
                        [out] void** ppvObj);
        [id(0x60000001), restricted]
        unsigned long AddRef();
        [id(0x60000002), restricted]
        unsigned long Release();
        [id(0x60010000), restricted]
        void GetTypeInfoCount([out] unsigned int* pctinfo);
        [id(0x60010001), restricted]
        void GetTypeInfo(
                        [in] unsigned int itinfo, 
                        [in] unsigned long lcid, 
                        [out] void** pptinfo);
        [id(0x60010002), restricted]
        void GetIDsOfNames(
                        [in] GUID* riid, 
                        [in] char** rgszNames, 
                        [in] unsigned int cNames, 
                        [in] unsigned long lcid, 
                        [out] long* rgdispid);
        [id(0x60010003), restricted]
        void Invoke(
                        [in] long dispidMember, 
                        [in] GUID* riid, 
                        [in] unsigned long lcid, 
                        [in] unsigned short wFlags, 
                        [in] DISPPARAMS* pdispparams, 
                        [out] VARIANT* pvarResult, 
                        [out] EXCEPINFO* pexcepinfo, 
                        [out] unsigned int* puArgErr);
        [id(0x00000094), propget, helpcontext(0x00010094)]
        Application* Application();
        [id(0x00000095), propget, helpcontext(0x00010095)]
        XlCreator Creator();
        [id(0x00000096), propget, helpcontext(0x00010096)]
        IDispatch* Parent();
        [id(0x00010003), restricted, hidden]
        void _Dummy3();
        [id(0x0000025a), helpcontext(0x0001025a)]
        VARIANT BringToFront();
        [id(0x00000227), helpcontext(0x00010227)]
        VARIANT Copy();
        [id(0x000000d5), helpcontext(0x000100d5)]
        VARIANT CopyPicture(
                        [in, optional, defaultvalue(2)] XlPictureAppearance Appearance, 
                        [in, optional, defaultvalue(-4147)] XlCopyPictureFormat Format);
        [id(0x00000235), helpcontext(0x00010235)]
        VARIANT Cut();
        [id(0x00000075), helpcontext(0x00010075)]
        VARIANT Delete();
        [id(0x0000040f), helpcontext(0x0001040f)]
        IDispatch* Duplicate();
        [id(0x00000258), propget, helpcontext(0x00010258)]
        VARIANT_BOOL Enabled();
        [id(0x00000258), propput, helpcontext(0x00010258)]
        void Enabled([in] VARIANT_BOOL rhs);
        [id(0x0000007b), propget, helpcontext(0x0001007b)]
        double Height();
        [id(0x0000007b), propput, helpcontext(0x0001007b)]
        void Height([in] double rhs);
        [id(0x0001000c), restricted, hidden]
        void _Dummy12();
        [id(0x0000007f), propget, helpcontext(0x0001007f)]
        double Left();
        [id(0x0000007f), propput, helpcontext(0x0001007f)]
        void Left([in] double rhs);
        [id(0x0000010d), propget, helpcontext(0x0001010d)]
        VARIANT_BOOL Locked();
        [id(0x0000010d), propput, helpcontext(0x0001010d)]
        void Locked([in] VARIANT_BOOL rhs);
        [id(0x0001000f), restricted, hidden]
        void _Dummy15();
        [id(0x00000254), propget, hidden, helpcontext(0x00010254)]
        BSTR OnAction();
        [id(0x00000254), propput, hidden, helpcontext(0x00010254)]
        void OnAction([in] BSTR rhs);
        [id(0x00000269), propget, helpcontext(0x00010269)]
        VARIANT Placement();
        [id(0x00000269), propput, helpcontext(0x00010269)]
        void Placement([in] VARIANT rhs);
        [id(0x0000026a), propget, helpcontext(0x0001026a)]
        VARIANT_BOOL PrintObject();
        [id(0x0000026a), propput, helpcontext(0x0001026a)]
        void PrintObject([in] VARIANT_BOOL rhs);
        [id(0x000000eb), helpcontext(0x000100eb)]
        VARIANT Select([in, optional] VARIANT Replace);
        [id(0x0000025d), helpcontext(0x0001025d)]
        VARIANT SendToBack();
        [id(0x0000007e), propget, helpcontext(0x0001007e)]
        double Top();
        [id(0x0000007e), propput, helpcontext(0x0001007e)]
        void Top([in] double rhs);
        [id(0x00010016), restricted, hidden]
        void _Dummy22();
        [id(0x0000022e), propget, helpcontext(0x0001022e)]
        VARIANT_BOOL Visible();
        [id(0x0000022e), propput, helpcontext(0x0001022e)]
        void Visible([in] VARIANT_BOOL rhs);
        [id(0x0000007a), propget, helpcontext(0x0001007a)]
        double Width();
        [id(0x0000007a), propput, helpcontext(0x0001007a)]
        void Width([in] double rhs);
        [id(0x0000026e), propget, helpcontext(0x0001026e)]
        long ZOrder();
        [id(0x000005f8), propget, helpcontext(0x000105f8)]
        ShapeRange* ShapeRange();
        [id(0x00000080), propget, helpcontext(0x00010080)]
        Border* Border();
        [id(0x00000081), propget, helpcontext(0x00010081)]
        Interior* Interior();
        [id(0x00000067), propget, helpcontext(0x00010067)]
        VARIANT_BOOL Shadow();
        [id(0x00000067), propput, helpcontext(0x00010067)]
        void Shadow([in] VARIANT_BOOL rhs);
        [id(0x00000105), propget, helpcontext(0x00010105)]
        BSTR Formula();
        [id(0x00000105), propput, helpcontext(0x00010105)]
        void Formula([in] BSTR rhs);
        [id(0x000000b5), helpcontext(0x000100b5)]
        Picture* Add(
                        [in] double Left, 
                        [in] double Top, 
                        [in] double Width, 
                        [in] double Height);
        [id(0x00000076), propget, helpcontext(0x00010076)]
        long Count();
        [id(0x0000002e), helpcontext(0x0001002e)]
        GroupObject* Group();
        [id(0x000000fc), helpcontext(0x000100fc)]
        Picture* Insert(
                        [in] BSTR Filename, 
                        [in, optional] VARIANT Converter);
        [id(0x000000aa), helpcontext(0x000100aa)]
        IDispatch* Item([in] VARIANT Index);
        [id(0xfffffffc), helpcontext(0x0000fffc)]
        IUnknown* _NewEnum();
        [id(0x000000d3), helpcontext(0x000100d3)]
        Picture* Paste([in, optional] VARIANT Link); 
```

由此，您可以推测该`Pictures`接口具有一个`Cut`和`Delete`方法，以及一个`Item`属性等。但是，请注意，此界面也标记为`hidden`，这（再次）很好地表明您不应该真正使用它（是的，我知道您忽略了该警告，但我赞同 Mitch Wheat 的评论，即这通常是一个坏主意使用隐藏类，因为它们通常是供应用程序内部使用的，如有更改，恕不另行通知。）

# database - 数据库效率

> ID：688491
> 
> 赞同：1
> 
> 时间：2009-03-27T03:55:31.417
> 
> 标签：database, database-design

我即将编写一个程序来跟踪我的学校作业，我想知道哪种数据库语言最有效和最容易实现以跟踪作业的元数据？我正在考虑 XML，但它需要几个文档。

我（目前）每周至少有十个作业，为期 45 周。必须存储的数据包括名称、发行日期、截止日期、路径和各种完成状态。无论使用哪种语言，都必须能够大幅增加作业数量和元数据量，而无需对格式或检索系统进行重大更改。

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2009-03-27T06:35:44.917

坦率地说，如果您选择一个成熟的数据库，您将面临在数据输入上花费的时间比在家庭作业上花费更多时间的风险。如果您真的需要跟踪这一点，我会认真推荐一个电子表格。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2009-03-27T04:06:07.863

首先，我认为您将关系数据库系统与数据库语言混淆了。您很可能会使用使用 SQL 的数据库。从那里，您将需要另一个编程平台来构建应用程序。如果需要，您可以使用 Microsoft Access 数据库，该数据库允许您构建一个简单的前端，该前端存储在与数据库相同的文件中。在这种情况下，您将使用 VBA 进行编程。

几乎任何更多的数据库系统都将适合您的需求，即使 Access 处理的工作量也比您描述的要多。

同样，一些可能的数据库系统是 Microsoft Access、Microsoft SQL Server Express、VistaDB、SQLite（可能是根据您的需要访问后的最佳选择），当然还有许多其他系统。

您可以构建 Web 前端或桌面；我假设您使用的是 Windows。如果需要，可以为此使用 Visual Studio C# Express。或者您可以使用 VB.NET、VB6 或您拥有的任何东西。

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2009-03-27T06:23:32.417

我的回答没有直接关系，但是当您设计数据库结构时，您可能希望了解[SIF 规范](http://specification.sifinfo.org/Implementation/2.3/IndexOfObjects.html#IndexOfObjects)中的一些对象，特别是查看 Assignment 和 GradingAssignment 对象。

至于如何存储数据，您可以使用 rdbms（sqlite、mysql）或键值数据库（zodb、[link](https://stackoverflow.com/questions/639545/is-there-a-business-proven-cloud-store-keyvalue-database-open-source)）。

当然，如果这只是一个小型个人项目，您可以将数据序列化为 xml、json、csv 或其他格式，并将其存储为文件。不过，从长远来看，使用数据库可能会更好。数据库格式可能会更容易扩展。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2009-03-27T04:05:27.040

我会推荐 [Oracle Express (With Application Express)](http://www.oracle.com/technology/products/database/xe/index.html)它将扩展到 4gb 的用户数据。除此之外，您将不得不开始付款。Application Express 非常简单，可以为它构建 CRUD 应用程序，听起来就像您的应用程序一样。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2009-03-27T06:31:39.620

对于这样的项目，我会使用 Sqlite 或 Mysql，它已经足够快了。此外，它易于设置。

# c++ - 复制构造函数

> ID：688494
> 
> 赞同：0
> 
> 时间：2009-03-27T03:56:52.487
> 
> 标签：c++

我试图用我的复制构造函数做“深拷贝”的复制部分：

```
class myClass
{
public:

    myClass ( const char *cPtr, const float fValue )
    myClass ( const myClass& myClassT );

private:

    const char* &myAddress;
    float MyFloater;

};

//myClass.cpp

myClass::myClass( const char *cPtr, const float fValue )
{
// Initialize both private varaible types
   const char* &myAddress = cPtr;
   float myFloater = fValue;
}

myClass::myClass( const myClass& classType )
{
// copy what we did ... 
      myAddress = myClass.myAddress;
      myFloater = myClass.myFloater;
} 
```

就这样，我只得到了“必须在基本/成员初始化列表中初始化whataver变量。

它们在构造函数中初始化！我需要对类类型对象地址做什么？

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2009-03-27T04:03:44.860

```
const char* &myAddress; 
```

是一个引用，所以它必须在构造函数期间在初始化列表中进行初始化，即

```
myClass::myClass(const char *& cPtr, const float fValue): myAddress(cPtr) 
```

请注意，这是处理这种情况的一种不好的方法（当然，取决于您要执行的操作），因为如果传递的*指针*超出范围，那么您就完蛋了。

一个更好的方法（同样，取决于你想要做什么）只是复制指针，在你的“深度”复制期间，重新分配和复制它的内容。当然，除非您确实需要对指针的引用。

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2009-03-27T04:02:46.733

几个问题：

1）为什么要在第一个构造函数中重复变量声明？

2) 为什么将 myAddress 声明为引用而不是指针？引用始终必须在构造函数初始化列表中进行初始化。这可能是您的错误消息的原因。C++ 不接受在构造函数主体中进行初始化。

在第二个构造函数中，您可能需要类似：

```
myClass::myClass( const myClass& classType ):myAddresss(classType.myAddress), myFloater(classType.myFloater)
{
} 
```

其原因与对象的构造方式有关。在构造函数的主体执行时，该对象已被视为已“构建”，因此引用应该已经有效，因此您对引用的分配被 C++ 拒绝。

顺便说一句，这不是一个真正的深拷贝......

* * *

## 回答 #3

> 赞同：3
> 
> 时间：2009-03-27T04:06:26.473

除了其他人所说的之外，您并没有真正进行“深度复制”，您正在做的是将指针设置为指向相同的指针，这不是深度复制。您还需要复制指针指向的任何内容（为了安全起见）。

* * *

## 回答 #4

> 赞同：2
> 
> 时间：2009-03-27T04:05:32.873

您没有在构造函数中初始化成员，而是声明了两个与类中的名称相同的新局部变量。使用初始化列表初始化它们如下所示：

```
myClass::myClass( const char *cPtr, const float fValue )
    : myAdress(cPtr), myFloater(fValue)
{
} 
```

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2009-03-27T04:07:42.290

尝试让你的代码是这样的：

```
class myClass
{
public:

    myClass ( const char *cPtr, const float fValue );
    myClass ( const myClass& myClassT );

private:

    const char* &myAddress;
    float MyFloater;

};

//myClass.cpp

myClass::myClass( const char *cPtr, const float fValue ) : myAddress(cPtr), MyFloater(fValue)
{
}

myClass::myClass( const myClass& classType ) : myAddress(classType.myAddress), MyFloater(classType.MyFloater)
{
// copy what we did ... 
} 
```

# iphone - 我应该避免在 iPhone 上递归吗？

> ID：688496
> 
> 赞同：4
> 
> 时间：2009-03-27T03:57:02.393
> 
> 标签：iphone, recursion, stack, tail-recursion

我应该避免使用在 iPhone 上运行的代码进行递归吗？

或者换一种说法，有人知道 iphone 上的最大堆栈大小吗？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2009-03-27T04:18:22.030

是的，避免递归在所有嵌入式平台上都是一件好事。

它不仅降低甚至消除了堆栈溢出的可能性，而且通常还可以为您提供更快的代码。

您始终可以将递归算法重写为迭代。不过，这并不总是实用的（想想快速排序）。解决此问题的一种方法是以限制递归深度的方式重写算法。

introsort 是一个很好的例子，它是如何在实践中完成的。它将快速排序的递归深度限制为 log2（元素数）。所以在 32 位机器上你永远不会递归超过 32。

[http://en.wikipedia.org/wiki/Introsort](http://en.wikipedia.org/wiki/Introsort)

过去我为嵌入式平台（汽车娱乐系统、电话、游戏机等）编写了相当多的软件，并且我总是确保我在递归深度上设置了一个上限或一开始就避免递归地方。

结果，我的任何程序都没有因堆栈溢出而死，大多数程序都对 32kb 的堆栈感到满意。一旦您需要多个线程，这会带来很大的回报，因为每个线程都有自己的堆栈。您可以通过这种方式节省数兆字节的内存。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2009-04-01T18:35:16.580

我看到几个答案归结为“不要使用递归”。我不同意——它不像 iPhone 是一些受到严格限制的嵌入式系统。如果问题本质上是递归的，请随意以这种方式表达。

除非您递归到数百或数千帧的堆栈深度，否则您永远不会遇到问题。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2009-03-27T04:31:23.577

**iphone上的最大堆栈大小？**

iPhone 运行经过修改的 OSX，其中每个进程都被赋予一个有效的内存空间，就像在大多数操作系统中一样。

它是一个完整的处理器，因此堆栈会增大，而堆会减小（反之亦然，具体取决于您的观点）。这意味着在分配给程序的内存用完之前，您不会溢出堆栈。

出于堆栈和性能原因，最好尽可能避免递归（函数调用相对于简单循环而言代价高昂），但无论如何，您应该决定可以对递归函数施加什么限制，如果它们太长，就截断它们。

# css - 删除一个 URL 的单个 CSS 元素；Drupal 6

> ID：688499
> 
> 赞同：2
> 
> 时间：2009-03-27T03:57:28.977
> 
> 标签：css, drupal-6

我的 Drupal 主题在中间设置了一个笔记本脊椎图像，将其拆分为 50/50 页面。

问题是，在几页上，我想摆脱那个笔记本书脊并使用整个页面。我在 Drupal.org 上环顾四周，但没有运气。

这是对 page.tpl 或 style.css 的编辑吗？

谢谢，

蒂姆

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-03-27T04:06:37.317

在不需要脊椎的页面上的 body 标记中添加一个 id 并为其添加第二个 CSS 规则，如下所示：

的HTML：

```
<body id="nospine">
   <div id="page"><!-- your content here --></div> 
```

CSS：

```
#page {
   background:#fff url(spine.gif) top repeat-y; /* normally with spine */
}
#nospine #page {
   background:#fff; /* without the spine image */
} 
```

除非您将“nospine”ID 添加到正文标签，否则所有页面现在都将显示书脊图像，很简单！

# asp.net - 双列表拖放控制

> ID：688517
> 
> 赞同：6
> 
> 时间：2009-03-27T04:06:19.220
> 
> 标签：asp.net, jquery, ajax, controls, listbox

有谁知道一个好的 .Net2.0+ 兼容的双列表框控件，它可以提供列表之间的拖放，或者提供简单的按钮来在列表之间移动项目以及对特定列表中的项目进行排序。这是一个基于网络的应用程序，我更喜欢一些不错的 javascript 来使这个应用程序更快。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-03-29T17:13:48.093

我决定使用 JQuery 和 JQuery UI 编写自己的拖放列表控件。您可以在这里试用一个示例：[demo](https://rps.is/dual-list/sample.html)。如果左侧列表太长，右侧排序列表将向下滚动，从而更容易拖放。我仍然对此进行了更多测试和一些错误修复，但它似乎运行良好。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2011-04-01T22:24:11.923

也许[这回答](https://stackoverflow.com/questions/2852995/whats-this-ui-pattern-called/2853050#2853050)了你的问题？

从那篇文章中，无限链接到 meadmiracle 的[jQuery 实现](http://www.meadmiracle.com/dlb/DLBDocumentation.aspx)和[演示](http://www.meadmiracle.com/dlb/DLBPlugin.aspx)。我个人不喜欢按钮的水平布局，尽管我确信这可以很容易地修复。

![meadmiracle jQuery 示例](https://i.stack.imgur.com/pW84Y.png)

我还发现这个[jQuery 多选控件](http://dropdown-check-list.googlecode.com/svn/trunk/doc/dropdownchecklist.html)在[UX Stack-Exchange](https://ux.stackexchange.com/questions/3418/what-is-the-best-ui-for-multi-select-from-a-list/3419#3419)上很有趣。

![jQuery 下拉列表](https://i.stack.imgur.com/MIrdO.png)

# php - 此 HTML Word 文档在 OpenOffice.org 中显示不正确

> ID：688524
> 
> 赞同：1
> 
> 时间：2009-03-27T04:10:33.953
> 
> 标签：php, ms-word, openoffice.org

我在 php 中有这个简单的代码：

```
<?php

header("Content-type: application/vnd.ms-word");
header("Content-Disposition: attachment;Filename=kid_tag.doc");

echo '<table cellspacing="0" cellpadding="0" border="0" width="8.4cm">
    <tr>
    <td colspan="3" style="text-align: right; height: 0.6cm">Nursery</td>
    </tr>
    <tr>
        <td style="height: 1.8cm"><img src="http://images.funadvice.com/photo/image/old/6943/tiny/cat.jpg" /></td>
        <td style="text-align: center; font-weight: bold">Sofia Abello</td>
    <td>&nbsp;</td>
    </tr> 
    <tr>
    <td style="text-align: left; height: 0.6cm">9AM Oct-12-08</td>
    <td>&nbsp;</td>
    <td style="text-align: right">Dance Studio</td>
    </tr>  
</table>';

?> 
```

使用 MS Office Word 显示正常，但是使用打开的 Office 编写器打开时，宽度会减小（宽度不合适！）。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-05-14T06:52:38.580

我认为使用 PHP 生成 DOC 文件的最简单方法是使用 Zend Framework 组件**phpLiveDocx**。您可以加载 Word 或 Open Office 模板、合并文本数据并将最终文档保存为多种格式，例如 DOC、DOCX、RTF 和 PDF。

在项目网站上了解更多信息：

[http://www.phplivedocx.org/articles/brief-introduction-to-phplivedocx/](http://www.phplivedocx.org/articles/brief-introduction-to-phplivedocx/)

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-04-09T21:12:48.660

您实际上是将 HTML 导入 MS Word 和 OpenOffice.org。HTML 不是 Word 和 OpenOffice.org 的原生格式，这意味着必须先转换输入。

毫不奇怪，这些应用程序（其主要目的是以应用程序的本机格式编辑文档）在那里做得并不完美。事实上——这并不是什么大秘密——即使是主要目的*是*呈现 HTML 的网络浏览器在该领域也不完美。

解决方案是提供适用于两种应用程序的 HTML。您可以使用[条件注释](http://de.wikipedia.org/wiki/Conditional_Comments)来做到这一点，条件注释是 Microsoft 对 HTML 的专有扩展，因此只有 Microsoft 产品才能理解。

这就是您的示例中的样子：

```
<![if !mso]>
<table cellspacing="0" cellpadding="0" border="0" width="8.4cm">
  <tr>
    <td>OpenOffice.org Version</td>
  </tr>
</table>
<![endif]>
<!--[if mso]>
<table cellspacing="0" cellpadding="0" border="0" width="8.4cm">
  <tr>
    <td>Microsoft Word version</td>
  </tr>
</table>
<![endif]--> 
```

# c# - 在网站上处理信用卡订阅的最佳方式是什么？

> ID：688528
> 
> 赞同：3
> 
> 时间：2009-03-27T04:12:56.303
> 
> 标签：c#, subscription, recurring-billing

我正在使用 ASP.NET 设计一个网站，我希望内容是基于订阅的。在大多数情况下，每个月都会从信用卡中收取所有费用。我知道我可以将 CC 存储在数据库中，但是还有其他更安全的解决方案吗？

这不是一个巨大的项目，所以我需要一些简单、快速、安全和可靠的解决方案，一个开发人员可以做到。

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2009-03-27T04:19:38.173

这很可能取决于您的支付网关和/或商家帐户设置。一些支付网关（如[Authorize.net](http://www.authorize.net/) ）将为您处理[定期计费](http://www.authorize.net/solutions/merchantsolutions/merchantservices/automatedrecurringbilling/)。

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2009-03-27T04:25:58.517

使用将处理信用卡经常性费用的支付处理器。大多数大型处理器都会为您执行此操作，并存储信用卡信息。

-亚当

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2009-03-27T04:20:01.077

是否可以选择不存储信用卡数据？

如果您需要一些鼓励，请参阅此内容： [PCI DSS 合规性](https://www.pcisecuritystandards.org/)

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2013-06-04T21:57:36.030

如果您存储信用卡信息，那么您必须符合 PCI。一些支付网关，如 Authroize.net 将为您处理定期计费，但只会从信用卡中收取费用，仅此而已。如果信用卡在此之后由于到期而失效，您永远不会知道，您的客户永远不会知道，您将失去该客户。

有一些服务会每月向您客户的信用卡收费，如果信用卡失败，自动处理流程，自动向您的客户发送电子邮件，照顾 PCI 合规性，这样您就不必处理它等等。其中一项服务是 Chargify。这样您就不必存储抄送信息，并且您的客户将被正确计费。

# c++ - C wINnet InternetConnect()

> ID：688529
> 
> 赞同：0
> 
> 时间：2009-03-27T04:14:01.963
> 
> 标签：c++, c, winapi

假设我想做一个匿名登录，会是空白字符串吗？

“”“”？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-03-27T04:30:40.050

根据[文档](http://msdn.microsoft.com/en-us/library/aa384363(VS.85).aspx)，用户名和密码字段的作用很大程度上取决于所选的协议。它也很可能同样取决于您要连接的服务器。

例如，在 FTP 中，如果您想要匿名登录，您可以将 NULL 传递给两个参数。这将导致 API 为两者发送匿名消息。只要匿名可以接受服务器上的匿名登录，您就应该开展业务。

# sql-server - 在 SQL Server 中删除全局临时表 (##tempTable)

> ID：688531
> 
> 赞同：21
> 
> 时间：2009-03-27T04:14:18.750
> 
> 标签：sql-server, temp-tables

SQL 服务器是否会在给定的不活动时间后自动清除它们，还是我需要担心自动清除它们？如果是这样，我如何查询要清除的表列表？

* * *

## 回答 #1

> 赞同：27
> 
> 时间：2009-03-27T05:58:04.770

尽管在连接终止时会删除临时表，但通常仍认为显式删除此类表是一种很好的做法，以便绝对确定已经进行了清理。

例如，如果您的平台使用连接池，即连接可能永远不会被删除，那么您的临时表是否仍然存在？

为了检查临时表的存在，您可以使用以下语句/检查。

```
if object_id('tempdb..##temptbl') is not null
begin
    drop table ##temptbl
end 
```

* * *

## 回答 #2

> 赞同：16
> 
> 时间：2009-03-27T04:19:19.487

当您关闭与 SQL Server 的连接时，本地临时表将被破坏。正常情况下无需手动清除它们。如果您维护持久连接或连接池，您可能希望养成在使用后立即删除临时表的习惯。

另一方面，由于全局临时表对给定数据库中的所有用户可见，因此它们与引用它们的最后一个连接一起被销毁。

* * *

## 回答 #3

> 赞同：4
> 
> 时间：2011-04-25T14:46:25.070

在回答问题的第二部分时，要查询要清除的表列表，请尝试以下查询：

```
SELECT * FROM tempdb..sysobjects 
```

这将列出所有当前的全局临时表

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2021-12-20T18:15:02.543

由于大多数观众都是通过搜索引擎来寻找问题标题的答案：删除 SQL Server 2016 及更高版本中的全局临时表：

```
DROP TABLE IF EXISTS ##tempTable; 
```

# oracle - oracle diff：如何比较两个表？

> ID：688537
> 
> 赞同：36
> 
> 时间：2009-03-27T04:16:58.510
> 
> 标签：oracle, diff

假设我有两个表，t1 和 t2，它们的布局相同，但可能包含不同的数据。

区分这两个表的最佳方法是什么？

* * *

## 回答 #1

> 赞同：66
> 
> 时间：2010-07-29T19:58:32.563

试试这个：

```
(select * from T1 minus select * from T2) -- all rows that are in T1 but not in T2
union all
(select * from T2 minus select * from T1)  -- all rows that are in T2 but not in T1
; 
```

没有外部工具。没有性能问题`union all`。

* * *

## 回答 #2

> 赞同：14
> 
> 时间：2009-03-27T04:21:09.527

您可以尝试使用集合操作：`MINUS`和`INTERSECT`

有关详细信息，请参见此处：
[O'Reilly - 掌握 Oracle SQL - 第 7 章 - 设置操作](https://web.archive.org/web/20141015170104/http://oreilly.com:80/catalog/mastorasql/chapter/ch07.html)

* * *

## 回答 #3

> 赞同：5
> 
> 时间：2009-03-27T10:00:15.860

您可以使用[AQT 之](http://querytool.com/)类的工具在表之间创建差异。

另一种方法是将表格转储到文本文件并使用[WinMerge](http://winmerge.org/)之类的差异工具。使用这种方法，您可以首先使用复杂的 SQL 将表转换为相同的布局。

* * *

## 回答 #4

> 赞同：3
> 
> 时间：2013-01-16T15:07:08.870

快速解决方案：

```
SELECT * FROM TABLE1
MINUS
SELECT * FROM TABLE2 
```

没有记录应该显示...

* * *

## 回答 #5

> 赞同：2
> 
> 时间：2009-03-27T14:45:59.247

对于这类问题，我认为您必须非常具体地了解您要寻找的内容，因为有许多解释它的方法和许多不同的方法。如果您的问题不合理，某些方法将是一个太大的锤子。

在最简单的级别上，有“表数据是否完全相同？”，您可能会尝试通过简单的计数比较来回答，然后再进行更复杂的操作。

在量表的另一端，有“显示每个表中没有另一个表中的等效行的行”或“显示行具有相同标识键但不同数据值的位置”。

如果您确实想将表 A 与表 B 同步，那么使用 MERGE 命令可能相对简单。

* * *

## 回答 #6

> 赞同：2
> 
> 时间：2010-09-24T13:56:44.390

您可以尝试[dbForge Data Compare for Oracle](http://www.devart.com/dbforge/oracle/datacompare/) **，这是一个用于数据比较和同步的**免费**GUI 工具，它可以在所有数据库或部分数据库上执行这些操作。

![替代文字](https://i.stack.imgur.com/9FkWe.jpg)

* * *

## 回答 #7

> 赞同：2
> 
> 时间：2019-05-01T06:16:16.090

我使用 Oracle SQL 开发人员将表导出为 CSV 格式，然后使用 WinMerge 进行比较。

* * *

## 回答 #8

> 赞同：1
> 
> 时间：2018-06-21T19:01:41.463

除了提供的其他一些答案之外，如果您想查看表结构与可能具有相似但不同结构的表的差异，您可以通过多种方式执行此操作：

**首先**- 如果使用 Oracle SQL Developer，您可以在两个表上运行描述来比较它们：

```
descr TABLE_NAME1
descr TABLE_NAME2 
```

**第二**- 第一个解决方案可能不适合具有大量列的大型表。如果您只想查看两个表之间数据的差异，那么正如其他几个人所提到的，使用 SQL 减号运算符应该可以完成这项工作。

**第三**- 如果您使用的是 Oracle SQL Developer，并且您想比较使用不同模式的两个表的表结构，您可以执行以下操作：

1.  选择“工具”
2.  选择“数据库差异”
3.  选择“源连接”
4.  选择“目标连接”
5.  选择要比较的“标准对象类型”
6.  输入“表名”
7.  单击“下一步”，直到到达“完成”
8.  点击“完成”
9.  注意：在步骤 3 和 4 中，您可以选择要比较的对象所在的不同模式。

**第四**- 如果您希望比较的两个表有更多列，在相同的模式中，不需要比较两个以上的表，并且使用 DESCR 命令进行视觉比较没有吸引力，您可以使用以下内容比较差异表结构：

```
select 
     a.column_name    || ' | ' || b.column_name, 
     a.data_type      || ' | ' || b.data_type, 
     a.data_length    || ' | ' || b.data_length, 
     a.data_scale     || ' | ' || b.data_scale, 
     a.data_precision || ' | ' || b.data_precision
from 
     user_tab_columns a,
     user_tab_columns b
where 
     a.table_name = 'TABLE_NAME1' 
and  b.table_name = 'TABLE_NAME2'
and  ( 
       a.data_type      <> b.data_type     or 
       a.data_length    <> b.data_length   or 
       a.data_scale     <> b.data_scale    or 
       a.data_precision <> b.data_precision
     )
and a.column_name = b.column_name; 
```

* * *

## 回答 #9

> 赞同：0
> 
> 时间：2014-01-30T17:17:16.690

`select * from table1 where table1.col1 in (select table2.col1 from table2)`

假设`col1`是主键列，这将给出与列 1`table1`相对应的所有行。`table2`

`select * from table1 where table1.col1 not in (select table2.col1 from table2)`

希望这可以帮助

* * *

## 回答 #10

> 赞同：0
> 
> 时间：2017-02-01T12:22:00.397

尝试：

```
select distinct T1.id
  from TABLE1 T1
 where not exists (select distinct T2.id
                     from TABLE2 T2
                    where T2.id = T1.id) 
```

用sql oracle 11g+

* * *

## 回答 #11

> 赞同：0
> 
> 时间：2019-05-30T06:46:46.127

试试这个，

更改会话集“_convert_set_to_join”= true；

另一种选择是手动重写 SQL 查询 [用 NOT IN 子查询替换减号运算符] 证明执行时间提高了大约 30%。

```
 select * 
   from A 
    where (col1,col2,?) not in 
   (select col1,col2,? from B) 
   union all 
   select * from B 
  where (col1,col2,?) not in 
  (select col1,col2,? from A); 
```

我从这篇文章中提到了[点击这里](http://www.dba-oracle.com/t_convert_set_to_join_sql_parameter.htm)

* * *

## 回答 #12

> 赞同：0
> 
> 时间：2019-12-19T09:34:33.667

下面是我的解决方案 - 考虑到差异表可以有重复的行。接受的答案没有考虑到这一点，这会在重复的情况下给你错误的结果。我通过使用 row_number() 对重复行进行编号，然后比较编号的行来处理重复行：

```
-- TEST TABLES
create table t1 (col_num number,col_date date,col_varchar varchar2(400));
create table t2 (col_num number,col_date date,col_varchar varchar2(400));  

-- TEST DATA
insert into t1 values (1,TO_DATE ('01.JAN.3000 00:00:00', 'DD.MON.YYYY HH24:MI:SS'),'I am in both');
insert into t2 values (1,TO_DATE ('01.JAN.3000 00:00:00', 'DD.MON.YYYY HH24:MI:SS'),'I am in both');

insert into t1 values (null,null,'I am in both with nulls');
insert into t2 values (null,null,'I am in both with nulls');

insert into t1 values (1,TO_DATE ('01.JAN.3000 00:00:00', 'DD.MON.YYYY HH24:MI:SS'),'I am in T1 only');
insert into t2 values (1,TO_DATE ('01.JAN.3000 00:00:00', 'DD.MON.YYYY HH24:MI:SS'),'I am in T2 only');

insert into t1 values (null,null,'I am in T1 only with nulls');
insert into t2 values (null,null,'I am in T2 only with nulls');

insert into t1 values (1,TO_DATE ('01.JAN.3000 00:00:00', 'DD.MON.YYYY HH24:MI:SS'),'I am twice in T1 but not in T2');
insert into t1 values (1,TO_DATE ('01.JAN.3000 00:00:00', 'DD.MON.YYYY HH24:MI:SS'),'I am twice in T1 but not in T2');

insert into t2 values (1,TO_DATE ('01.JAN.3000 00:00:00', 'DD.MON.YYYY HH24:MI:SS'),'I am twice in T2 but not in T1');
insert into t2 values (1,TO_DATE ('01.JAN.3000 00:00:00', 'DD.MON.YYYY HH24:MI:SS'),'I am twice in T2 but not in T1');

insert into t1 values (1,TO_DATE ('01.JAN.3000 00:00:00', 'DD.MON.YYYY HH24:MI:SS'),'I am twice in T1 and once in T2');
insert into t1 values (1,TO_DATE ('01.JAN.3000 00:00:00', 'DD.MON.YYYY HH24:MI:SS'),'I am twice in T1 and once in T2');
insert into t2 values (1,TO_DATE ('01.JAN.3000 00:00:00', 'DD.MON.YYYY HH24:MI:SS'),'I am twice in T1 and once in T2');

insert into t2 values (1,TO_DATE ('01.JAN.3000 00:00:00', 'DD.MON.YYYY HH24:MI:SS'),'I am twice in T2 and once in T1');
insert into t2 values (1,TO_DATE ('01.JAN.3000 00:00:00', 'DD.MON.YYYY HH24:MI:SS'),'I am twice in T2 and once in T1');
insert into t1 values (1,TO_DATE ('01.JAN.3000 00:00:00', 'DD.MON.YYYY HH24:MI:SS'),'I am twice in T2 and once in T1');

-- THE DIFF
-- All columns need to be named in the partition by clause, it is not possible to just say 'partition by *'
-- The column used in the order by clause does not matter in terms of functionality 
(
    select 'In T1 but not in T2' diff,s.* from (
        select row_number() over (partition by col_num,col_date,col_varchar order by col_num) rn,t.* from t1 t
        minus
        select row_number() over (partition by col_num,col_date,col_varchar order by col_num) rn,t.* from t2 t
    ) s
) union all (
    select 'In T2 but not in T1' diff,s.* from (
        select row_number() over (partition by col_num,col_date,col_varchar order by col_num) rn,t.* from t2 t
        minus
        select row_number() over (partition by col_num,col_date,col_varchar order by col_num) rn,t.* from t1 t
    ) s
); 
```

# flash - 为什么 getURL("www.zhoyosoft.com") 函数在 Flash CS3 中不起作用？

> ID：688541
> 
> 赞同：2
> 
> 时间：2009-03-27T04:19:33.183
> 
> 标签：flash

我是 Flash 开发人员的初学者，我不知道为什么 getURL("www.zhoyosoft.com") 函数在 Flash CS3 中不起作用，它在打开新的浏览器窗口时会抛出错误（调用可能未定义的方法 getURL）。任何人都可以帮忙吗？

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2009-03-27T04:25:37.897

尝试像这样添加 http://。

```
getUrl("http://www.zhoyosoft.com") 
```

或者因为您使用 ActionScript3 试试这个：

```
var url:String = "http://www.zhoyosoft.com";
var request:URLRequest = new URLRequest(url);
try {
  navigateToURL(request, '_blank');
} catch (e:Error) {
  trace("Error occurred!");
} 
```

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2009-03-27T04:26:04.557

与 URLRequest.url 一样，目标必须包含协议

```
getURL("http://www.zhoyosoft.com"); 
```

编辑：好吧，显然你使用的是 AS3 而不是 AS2。getURL() 在 AS3 中被 navigateToURL() 取代。您可以像这样实现 getURL()：

```
import flash.net.navigateToURL;
import flash.net.URLRequest;

public static function getURL(url:String, window:String = null):void
{
    navigateToURL(new URLRequest(url), window);
} 
```

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2009-03-27T07:37:57.747

确保 Flash 应用程序的嵌入位置没有`parameter: <param name=“allowScriptAccess” value=“never” />`

MySpace 和大多数其他允许用户嵌入小部件的网站会阻止 getURL。原因是 getURL 可用于在当前用户和站点的上下文中执行 javascript。

* * *

## 回答 #4

> 赞同：2
> 
> 时间：2009-03-27T08:43:49.647

Ben 是对的，但您也可以将其写为 1 行：

```
 navigateToURL(new URLRequest("http://www.zhoyosoft.com"), "_blank"); 
```

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2012-07-20T18:10:43.203

```
<param name="AllowScriptAccess" value="always">
and
<embed type="application/x-shockwave-flash"
        href="http://www.anothersite.com/thing.swf"
        AllowScriptAccess="always">
</embed> 
```

来源：[http ://helpx.adobe.com/flash-player/kb/changes-allowscriptaccess-default-flash-player.html](http://helpx.adobe.com/flash-player/kb/changes-allowscriptaccess-default-flash-player.html)

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2011-12-15T07:36:57.567

您的问题很可能是因为较新版本的 Adob​​e Flash Player（从 9.0.115.0 开始）默认更改了安全策略，使 GetURL() 和 fscommand() 方法不起作用。

要使它们工作，您需要将嵌入对象属性 AllowScriptAccess 更改为“始终”。默认设置为“sameDomain”。您可以在 Adob​​e 网站上找到有关此问题的更多信息：http: [//kb2.adobe.com/cps/403/kb403183.html#main_DIAGNOSIS](http://kb2.adobe.com/cps/403/kb403183.html#main_DIAGNOSIS)

如果这不是问题，请检查 Flash 选项卡上的发布设置窗口，在下拉选项中，您可以选择本地访问还是网络访问。

如果没有，这里有一个关于 AS 2.0 的 GetURL 方法的完整解释：http: [//www.adobe.com/livedocs/flash/9.0/main/wwhelp/wwhimpl/common/html/wwhelp.htm? context= LiveDocs_Parts&file=00001180.html](http://www.adobe.com/livedocs/flash/9.0/main/wwhelp/wwhimpl/common/html/wwhelp.htm?context=LiveDocs_Parts&file=00001180.html)

不确切知道您将如何/将使用/实现它，但我希望这些信息可以帮助您。

# version-control - 持续版本控制

> ID：688546
> 
> 赞同：9
> 
> 时间：2009-03-27T04:21:22.103
> 
> 标签：version-control, continuous-integration, collaboration

我还没有看到一个连续的版本控制系统——它会在你开发代码时保存代码中的更改，而不是等待正式签入。当然，更改会保存为“未签入”，但它们会在您实际进行正式签入之前，将其保存起来以供备份，并供其他人查看。

我还没有看到这个，想知道它或类似的东西是否存在，以及它可能是一个好主意或可能不是一个好主意的原因。

现在程序员将源代码控制视为集成代码包，但为什么不将这些包更小并不断集成呢？

-亚当

* * *

## 回答 #1

> 赞同：13
> 
> 时间：2009-03-27T05:07:06.733

> 现在程序员将源代码控制视为集成代码包，但为什么不将这些包更小并不断集成呢？

我会说 DVCS 现在基本上已经在这样做了，不是因为它们是去中心化的，而是因为提交要快得多。使用 git 我提交的频率比使用 SVN 多得多。这也使得提交“块”或特定文件变得简单代码（使用`git add -i`or `git gui`），并且通常更专注于跟踪代码行，而不是完整的文件（作为“传统”VCS，如 Subversion）

此外，正如您所说，git 固有的工作方式意味着“更改当然会保存为'未签入'”。当您提交时，更改是本地的，然后您将它们推送到远程机器上命令..您可以在每次保存时提交，然后根据需要将它们重新设置为单个提交。

至于执行“连续版本控制”的工具，您可以使用 shell 脚本非常简单地做到这一点，例如..

```
while [ 1 ]; do
   git add -a && git commit -m "Autocommit at $(date)";
   sleep 10;
done 
```

有一个脚本[CACM](http://www.simplicidade.org/notes/archives/2009/03/my_own_entry_to.html) ( [github](http://github.com/melo/perl-app-cacm/tree/master) )，它做类似的事情

> [CACM] 监视特定目录，并将所有更改提交到独立的 Git 存储库。
> 
> 要使用，只需：
> 
> `cacm --repo dir_of_git_repo --watch dir_to_watch`

我不确定您为什么要这样做。我发现使用 VCS 最有用的事情之一是我更改的内容的差异（自上次提交以来）。似乎有恒定/自动提交只是噪音..

此外，[“e”文本编辑器](http://e-texteditor.com/)有一个有趣的功能，它通过分支可视化撤消历史。上面有一个带有屏幕截图的[博客文章。](http://e-texteditor.com/blog/2006/making-undo-usable)

* * *

## 回答 #2

> 赞同：11
> 
> 时间：2009-03-27T04:39:04.027

持续自动保存的工作不是版本系统的任务，而是编辑器的任务。当您在版本系统中看到一个新版本时，它应该代表与其他版本相比的有意义的变化，而不是每个半字词。

* * *

## 回答 #3

> 赞同：6
> 
> 时间：2009-03-27T04:38:20.937

Eclipse 有一个称为“本地历史”的功能，可以做到这一点。它将在保存之间保留源文件的副本。它甚至会为您跟踪已删除的文件夹。它多次救了我的屁股。您可以将本地历史视为仅在本地计算机上发生的低级版本控制。当然，不利的一面是，当您在不同的机器上工作时，您将拥有不同的本地历史。

* * *

## 回答 #4

> 赞同：5
> 
> 时间：2009-03-27T05:11:24.947

您可以使用分布式版本控制系统，例如[bazaar](http://www.google.com/url?sa=t&source=web&ct=res&cd=1&url=http%3A%2F%2Fbazaar-vcs.org%2F&ei=DWDMSeTkFdGgkQWjmYzNCQ&usg=AFQjCNGb4Kw0X_xZ9OFECmW3ztTv_v1BGg&sig2=fPNdWhkYy2v49FT2PyeFpg)、[git](http://git-scm.com/)、[Mercurial](http://www.selenic.com/mercurial/)。然后你可以在本地提交。

* * *

## 回答 #5

> 赞同：4
> 
> 时间：2009-03-27T05:26:05.037

我已经看到了一些用于各种 DVCS 的基于 inotify 的插件，但是这些插件只能如此聪明。确实，理想的做法是将存储库存储在写时复制文件系统上，以便将这些频繁的粒度（和不可变）版本的文件保存在 DVCS 之外。

正如其他人所说，我更愿意做出许多小承诺。使用 DVCS，您不必担心破坏主干或主分支，只需在完成后推送 .. 编辑文件时无需担心有毒修订。

在 Linux 上，我使用[ext3cow](http://ext3cow.com)来存储我的 HG/Git 存储库。这给了我你描述的那种功能。遗憾的是，我不知道有任何类似的东西可以在 Linux 之外移植。也许一些疯狂的团队会用 Python 想出一个。

这个问题之前已经出现过好几次了（尽管每次都在不同的背景下），所以肯定需要像 ext3cow （但可移植的）这样的东西。然而，我不希望 DVCS 本身出现这种膨胀，尤其是在大树上。

我认为您确实需要从文件系统而不是 DVCS 提出此要求。

* * *

## 回答 #6

> 赞同：3
> 
> 时间：2009-03-27T04:25:22.577

你的意思是像[Subversion 自动版本控制](http://svnbook.red-bean.com/en/1.5/svn.webdav.autoversioning.html)？

免责声明：我并不是说自动版本控制对开发来说是一个好主意，或者我个人会这样做，但这项技术是存在的。

* * *

## 回答 #7

> 赞同：3
> 
> 时间：2009-03-27T04:29:18.637

您不想检查*每个*更改。您想要签入可以一起工作的原子更改集。您不想将参数添加到方法并保存，将其签入（并运行 CI 构建），然后让构建中断，因为您尚未更新对该方法的调用。

* * *

## 回答 #8

> 赞同：2
> 
> 时间：2009-03-27T04:24:52.063

如果您愿意，您可以使用 git 之类的 DVCS 提交每一行或字符。一般来说，我认为在使用 DVCS 时尽可能多地提交是一个好主意，以便使用 git bisect 等工具轻松查找问题。如果您想要您描述的效果，您可以编写您选择的编辑器以在每次保存时提交...实际上，尽管我认为这有点多。

* * *

## 回答 #9

> 赞同：2
> 
> 时间：2009-03-27T04:26:30.077

有些人会为此设置一个开发分支，并让开发人员在工作时提交他们的更改，然后再将其合并到质量保证级别的分支中。您甚至可以让开发人员在他/她自己的分支中进行重大更改，然后再将这些更改提交并合并到主开发分支中。因此，分支可以解决这个问题。

* * *

## 回答 #10

> 赞同：2
> 
> 时间：2009-03-27T04:27:45.660

我认为 Eclipse 会，或者曾经在每次保存时都会做这样的事情。当我的代码在试图识别错误时最终被破解成碎片时，它救了我几次。

* * *

## 回答 #11

> 赞同：2
> 
> 时间：2009-11-08T05:50:25.417

这是一种不同的方法。几乎每天我都会遇到一些事情停止工作的情况，我不知道为什么。我倒带几分钟并检查已进行了哪些更改以及对哪些文件进行了更改。所以我同意持续版本控制的需要。

同时，您确实不想每天将成千上万的小更改签入到您的存储库中。

好的，这就是你要做的。您同时使用它们，但不要混合使用它们。整个团队都应该使用您的源代码控制，并且您时不时地检查一下。同时你运行一些本地的个人文件版本软件，可以保存每一个小改动，方便你实际使用这些信息。

就是这样。我使用[History Explorer](http://www.exendo.se)是因为我帮助开发了它，但也有其他的。

* * *

## 回答 #12

> 赞同：2
> 
> 时间：2013-09-09T06:50:05.923

您可能对 JetBrains 开发的持续版本控制系统感兴趣。它尚未公开，但我在马尔默 JetBrainsDay 的主题演讲中展示了它的一些功能：http: [//new.livestream.com/jetbrains/jetbrainsday1/videos/29348962](http://new.livestream.com/jetbrains/jetbrainsday1/videos/29348962)

* * *

## 回答 #13

> 赞同：1
> 
> 时间：2009-03-27T05:18:29.767

拥有超过几年的 Java 编程经验，我仍然记得（怀念）Visual Age 为开发过程带来的新颖方法。Visual Age 对源代码采用非文件方法。代码存储在关系数据库中。您通常会处理显示单个方法的视图。你也有一个完整的文件视图，但你不会用那么多。

关于版本控制，它会在每次保存时生成一个版本。您可以使用版本号/名称显式检查方法、类/接口、包或整个项目。它还允许在方法级别对您的源进行更细粒度的控制。当我开始使用 Eclipse 时，虽然它继承了 Visual Age 的许多特性，并且今天具有将代码的所有“保存”保存在本地的历史特性，但我不禁感到我退了一步。

* * *

## 回答 #14

> 赞同：1
> 
> 时间：2009-03-27T05:46:40.523

正如[Dan 提到](https://stackoverflow.com/questions/688546/continuous-version-control/688639#688639)的，IBM Visual Age IDE 保留了您保存的每个版本的源代码文件。但是，这种方法不仅限于 IDE；[DEC VMS](http://en.wikipedia.org/wiki/OpenVMS)操作系统对其[版本化文件系统](http://en.wikipedia.org/wiki/Files-11)采用了类似的方法。在 VMS 中，每个文件的全名都包含一个版本号，每次保存文件时，都会创建一个新副本，其版本号比之前的最高版本号高一个。

正如我们今天所知，这两种方法都不能完全匹配版本控制，因为它们都缺乏分支（或者，就此而言，任何专门为方便多人处理同一源文件而设计的功能）。但是，它们都用于备份以防止人为错误，这对我来说是版本控制最有用的方面。

* * *

## 回答 #15

> 赞同：1
> 
> 时间：2009-03-27T13:09:44.517

Rational [ClearCase](http://www.ibm.com/developerworks/rational/products/clearcase/)具有**动态视图**的概念。在 Windows 上，您的开发视图显示为映射驱动器，但您的代码更改会在您点击保存后立即存储在服务器端。那是你要找的吗？

正如您所料，以这种方式工作需要权衡取舍，所以就像[上面](https://stackoverflow.com/questions/688546/continuous-version-control/688554#688554)[Si](https://stackoverflow.com/users/44540/si)的回答一样，这不是建议......

* * *

## 回答 #16

> 赞同：0
> 
> 时间：2010-01-05T14:07:34.797

维斯塔怎么样？

[http://www.vestasys.org/](http://www.vestasys.org/)

# mysql - 在 MySQL 中查找重复值

> ID：688549
> 
> 赞同：866
> 
> 时间：2009-03-27T04:22:12.460
> 
> 标签：mysql

我有一个带有 varchar 列的表，我想在该列中找到所有具有重复值的记录。我可以用来查找重复项的最佳查询是什么？

* * *

## 回答 #1

> 赞同：1687
> 
> 时间：2009-03-27T04:24:08.990

`SELECT`用一个`GROUP BY`子句做一个。假设*name*是您要在其中查找重复项的列：

```
SELECT name, COUNT(*) c FROM table GROUP BY name HAVING c > 1; 
```

这将返回一个结果，其*名称*值在第一列中，并计算该值在第二列中出现的次数。

* * *

## 回答 #2

> 赞同：267
> 
> 时间：2009-03-27T04:27:16.660

```
SELECT varchar_col
FROM table
GROUP BY varchar_col
HAVING COUNT(*) > 1; 
```

* * *

## 回答 #3

> 赞同：202
> 
> 时间：2009-03-27T10:54:39.193

```
SELECT  *
FROM    mytable mto
WHERE   EXISTS
        (
        SELECT  1
        FROM    mytable mti
        WHERE   mti.varchar_column = mto.varchar_column
        LIMIT 1, 1
        ) 
```

此查询返回完整的记录，而不仅仅是 distinct`varchar_column`的。

此查询不使用`COUNT(*)`. 如果有很多重复，`COUNT(*)`很昂贵，并且您不需要整个`COUNT(*)`，您只需要知道是否有两行具有相同的值。

这是通过`LIMIT 1, 1`相关查询底部的 （本质上是“返回第二行”）来实现的。如果上述第二行存在（即至少有两行具有相同的 varchar_column 值），EXISTS 只会返回 true。

当然，有一个索引`varchar_column`会大大加快这个查询的速度。

* * *

## 回答 #4

> 赞同：168
> 
> 时间：2015-02-19T00:56:21.540

如果您的服务器支持它，您可以根据 levik 的答案来获取重复行的 ID `GROUP_CONCAT`（这将返回一个逗号分隔的 ID 列表）。

```
SELECT GROUP_CONCAT(id), name, COUNT(*) c
FROM documents
GROUP BY name
HAVING c > 1; 
```

* * *

## 回答 #5

> 赞同：19
> 
> 时间：2019-05-08T08:40:37.697

为了获取所有包含重复的数据，我使用了这个：

```
SELECT * FROM TableName INNER JOIN(
  SELECT DupliactedData FROM TableName GROUP BY DupliactedData HAVING COUNT(DupliactedData) > 1 order by DupliactedData)
  temp ON TableName.DupliactedData = temp.DupliactedData; 
```

TableName = 您正在使用的表。

DupliactedData = 您要查找的重复数据。

* * *

## 回答 #6

> 赞同：14
> 
> 时间：2009-03-27T04:29:28.073

假设您的表名为 TableABC 并且您想要的列是 Col 并且 T1 的主键是 Key。

```
SELECT a.Key, b.Key, a.Col 
FROM TableABC a, TableABC b
WHERE a.Col = b.Col 
AND a.Key <> b.Key 
```

与上述答案相比，这种方法的优势在于它提供了密钥。

* * *

## 回答 #7

> 赞同：12
> 
> 时间：2014-05-22T14:48:09.357

```
SELECT * 
FROM `dps` 
WHERE pid IN (SELECT pid FROM `dps` GROUP BY pid HAVING COUNT(pid)>1) 
```

* * *

## 回答 #8

> 赞同：11
> 
> 时间：2015-11-24T12:12:03.377

要查找 Employee 中 name 列中有多少条记录重复，下面的查询很有帮助；

```
Select name from employee group by name having count(*)>1; 
```

* * *

## 回答 #9

> 赞同：11
> 
> 时间：2017-08-01T22:29:58.733

进一步考虑[*@maxyfc 的*答案](https://stackoverflow.com/questions/688549/finding-duplicate-values-in-mysql/45448645#answer-688560)，我需要找到*所有*返回重复值的行，所以我可以在[MySQL Workbench](https://dev.mysql.com/doc/workbench/en/)中编辑它们：

```
SELECT * FROM table
   WHERE field IN (
     SELECT field FROM table GROUP BY field HAVING count(*) > 1
   ) ORDER BY field 
```

* * *

## 回答 #10

> 赞同：10
> 
> 时间：2017-05-05T02:38:17.103

我的最后一个查询在这里包含了一些有帮助的答案 - 结合 group by、count 和 GROUP_CONCAT。

```
SELECT GROUP_CONCAT(id), `magento_simple`, COUNT(*) c 
FROM product_variant 
GROUP BY `magento_simple` HAVING c > 1; 
```

这提供了两个示例的 ID（逗号分隔）、我需要的条形码以及重复的数量。

相应地更改表和列。

* * *

## 回答 #11

> 赞同：9
> 
> 时间：2018-04-20T10:33:43.660

我没有看到任何 JOIN 方法，它们在重复方面有很多用途。

这种方法为您提供了实际加倍的结果。

```
SELECT t1.* FROM my_table as t1 
LEFT JOIN my_table as t2 
ON t1.name=t2.name and t1.id!=t2.id 
WHERE t2.id IS NOT NULL 
ORDER BY t1.name 
```

* * *

## 回答 #12

> 赞同：8
> 
> 时间：2016-05-30T07:42:27.743

我看到了上面的结果，如果您需要检查重复的单列值，查询将正常工作。例如电子邮件。

但是，如果您需要检查更多列并希望检查结果的组合，那么此查询将正常工作：

```
SELECT COUNT(CONCAT(name,email)) AS tot,
       name,
       email
FROM users
GROUP BY CONCAT(name,email)
HAVING tot>1 (This query will SHOW the USER list which ARE greater THAN 1
              AND also COUNT) 
```

* * *

## 回答 #13

> 赞同：7
> 
> 时间：2013-01-25T05:59:57.587

```
SELECT t.*,(select count(*) from city as tt
  where tt.name=t.name) as count
  FROM `city` as t
  where (
     select count(*) from city as tt
     where tt.name=t.name
  ) > 1 order by count desc 
```

用您的表替换**城市。**将**名称**替换为您的字段名称

* * *

## 回答 #14

> 赞同：6
> 
> 时间：2018-07-12T17:40:11.627

我更喜欢使用窗口函数（MySQL 8.0+）来查找重复项，因为我可以看到整行：

```
WITH cte AS (
  SELECT *
    ,COUNT(*) OVER(PARTITION BY col_name) AS num_of_duplicates_group
    ,ROW_NUMBER() OVER(PARTITION BY col_name ORDER BY col_name2) AS pos_in_group
  FROM table
)
SELECT *
FROM cte
WHERE num_of_duplicates_group > 1; 
```

**[DB 小提琴演示](https://www.db-fiddle.com/f/jQiz726tVNqhr9qHG1n198/0)**

* * *

## 回答 #15

> 赞同：3
> 
> 时间：2013-02-21T08:37:52.950

```
SELECT 
    t.*,
    (SELECT COUNT(*) FROM city AS tt WHERE tt.name=t.name) AS count 
FROM `city` AS t 
WHERE 
    (SELECT count(*) FROM city AS tt WHERE tt.name=t.name) > 1 ORDER BY count DESC 
```

* * *

## 回答 #16

> 赞同：3
> 
> 时间：2016-03-04T07:55:22.210

```
CREATE TABLE tbl_master
    (`id` int, `email` varchar(15));

INSERT INTO tbl_master
    (`id`, `email`) VALUES
    (1, 'test1@gmail.com'),
    (2, 'test2@gmail.com'),
    (3, 'test1@gmail.com'),
    (4, 'test2@gmail.com'),
    (5, 'test5@gmail.com');

QUERY : SELECT id, email FROM tbl_master
WHERE email IN (SELECT email FROM tbl_master GROUP BY email HAVING COUNT(id) > 1) 
```

* * *

## 回答 #17

> 赞同：3
> 
> 时间：2016-05-30T13:52:46.587

下面将找到所有使用多次的 product_id。您只能为每个 product_id 获得一条记录。

```
SELECT product_id FROM oc_product_reward GROUP BY product_id HAVING count( product_id ) >1 
```

代码取自：[http ://chandreshrana.blogspot.in/2014/12/find-duplicate-records-based-on-any.html](http://chandreshrana.blogspot.in/2014/12/find-duplicate-records-based-on-any.html)

* * *

## 回答 #18

> 赞同：3
> 
> 时间：2020-10-29T22:57:32.337

我由此改进：

```
SELECT 
    col, 
    COUNT(col)
FROM
    table_name
GROUP BY col
HAVING COUNT(col) > 1; 
```

* * *

## 回答 #19

> 赞同：2
> 
> 时间：2009-03-27T04:28:57.870

```
SELECT ColumnA, COUNT( * )
FROM Table
GROUP BY ColumnA
HAVING COUNT( * ) > 1 
```

* * *

## 回答 #20

> 赞同：2
> 
> 时间：2013-07-01T18:17:44.600

```
SELECT DISTINCT a.email FROM `users` a LEFT JOIN `users` b ON a.email = b.email WHERE a.id != b.id; 
```

* * *

## 回答 #21

> 赞同：1
> 
> 时间：2015-12-18T18:21:50.160

```
Select column_name, column_name1,column_name2, count(1) as temp from table_name group by column_name having temp > 1 
```

* * *

## 回答 #22

> 赞同：1
> 
> 时间：2016-02-04T09:58:03.393

要删除具有多个字段的重复行，首先将它们添加到为唯一不同的行指定的新唯一键，然后使用“分组依据”命令删除具有相同新唯一键的重复行：

```
Create TEMPORARY table tmp select concat(f1,f2) as cfs,t1.* from mytable as t1;
Create index x_tmp_cfs on tmp(cfs);
Create table unduptable select f1,f2,... from tmp group by cfs; 
```

* * *

## 回答 #23

> 赞同：1
> 
> 时间：2016-09-06T13:52:55.387

一个非常晚的贡献...以防万一它可以帮助任何人放弃...我的任务是在银行应用程序中找到匹配的交易对（实际上是账户到账户转账的双方），以确定哪些交易是每个账户间转账交易的“发件人”和“收件人”，所以我们最终得到了这个：

```
SELECT 
    LEAST(primaryid, secondaryid) AS transactionid1,
    GREATEST(primaryid, secondaryid) AS transactionid2
FROM (
    SELECT table1.transactionid AS primaryid, 
        table2.transactionid AS secondaryid
    FROM financial_transactions table1
    INNER JOIN financial_transactions table2 
    ON table1.accountid = table2.accountid
    AND table1.transactionid <> table2.transactionid 
    AND table1.transactiondate = table2.transactiondate
    AND table1.sourceref = table2.destinationref
    AND table1.amount = (0 - table2.amount)
) AS DuplicateResultsTable
GROUP BY transactionid1
ORDER BY transactionid1; 
```

结果是`DuplicateResultsTable`提供了包含匹配（即重复）事务的行，但它在第二次匹配同一对时也提供了相反的相同事务 id，因此外部`SELECT`是按第一个事务 ID 分组的，这是完成的通过使用`LEAST`and`GREATEST`确保两个 transactionid 在结果中始终处于相同的顺序，这使得`GROUP`第一个是安全的，从而消除了所有重复的匹配项。浏览近 100 万条记录并在不到 2 秒的时间内识别出 12,000 多个匹配项。当然，transactionid 是主索引，这确实很有帮助。

* * *

## 回答 #24

> 赞同：1
> 
> 时间：2019-01-14T07:21:52.613

如果要删除重复使用`DISTINCT`

否则使用此查询：

`SELECT users.*,COUNT(user_ID) as user FROM users GROUP BY user_name HAVING user > 1;`

* * *

## 回答 #25

> 赞同：1
> 
> 时间：2021-02-24T01:07:08.510

作为 Levik 答案的一种变体，它允许您还找到重复结果的 id，我使用了以下内容：

```
SELECT * FROM table1 WHERE column1 IN (SELECT column1 AS duplicate_value FROM table1 GROUP BY column1 HAVING COUNT(*) > 1) 
```

* * *

## 回答 #26

> 赞同：1
> 
> 时间：2021-09-21T14:36:59.157

感谢@novocaine 的出色回答，他的解决方案对我有用。我稍微改变了它以包含一定**百分比**的重复值，这在我的情况下是必需的。下面是修改后的版本。它将**百分比减少到****小数点**后两位。如果将 ,2 更改为 0，它将不显示小数点，如果更改为 1，则将显示小数点后一位，依此类推。

```
SELECT GROUP_CONCAT(id), name, COUNT(*) c, 
COUNT(*) OVER() AS totalRecords, 
CONCAT(FORMAT(COUNT(*)/COUNT(*) OVER()*100,2),'%') as recurringPecentage
FROM table
GROUP BY name
HAVING c > 1 
```

* * *

## 回答 #27

> 赞同：0
> 
> 时间：2018-11-15T09:16:23.517

尝试使用此查询：

```
SELECT name, COUNT(*) value_count FROM company_master GROUP BY name HAVING value_count > 1; 
```

# c++ - IIS 下的 Windows 命名管道 ACL

> ID：688550
> 
> 赞同：2
> 
> 时间：2009-03-27T04:23:57.773
> 
> 标签：c++, windows, iis, named-pipes

我正在尝试使用命名管道将 CGI 进程连接到我的 Windows 服务。我的代码在我的开发机器上使用另一台服务器运行良好，但在 IIS 上，当我在 CGI 进程中调用 CreateFile() 时会出现安全问题。

Windows 服务是命名管道服务器，因此 CGI 进程试图作为客户端连接到该命名管道。

我已经挖掘了一些代码，这些代码通过调用以下方法创建了一个带有 SECURITY_WORLD_SID_AUTHORITY 标志的全局安全描述符：

```
 InitializeAcl()
  AddAccessAllowedAce()
  SetSecurityDescriptorDacl() 
```

但我真的不明白这个概念。我假设管道服务器 CreateNamedPipe() 必须在 SECURITY_ATTRIBUTES 结构中使用此 ACL 调用，但是命名管道客户端呢？

我是否要创建另一个全局安全描述符并使用它调用 CreateFile()？

我继承它吗

```
 SecurityAttributes.bInheritHandle   = TRUE; 
```

我只是在 CreateFile() 调用中传递 Null 吗？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-03-27T17:27:19.373

由于管道是服务端创建的，所以只需要服务端指定ACL，客户端使用NULL作为ACL。

仅当在一个进程中创建命名管道并且该进程创建了一个新进程时，继承才适用，您希望生成的进程在其中可以直接访问句柄（它不会重新打开句柄，而是以其他方式获取值，就像命令行一样）。

您可以使用[sysinternals](http://technet.microsoft.com/en-us/sysinternals/default.aspx)上的 Process Explorer 查看进程中打开的命名管道，然后查看 ACL。

# iphone - 将字符串转换为枚举类型

> ID：688565
> 
> 赞同：0
> 
> 时间：2009-03-27T04:29:19.213
> 
> 标签：iphone, objective-c, cocoa-touch

有谁知道如何（或是否）可以在objective-c/cocoa/iphone 环境中将字符串转换为枚举类型？

例如：

如果我有一个包含该元素的 XML 文档：

`<dog breed="GermanShepard">`

我希望能够将“breed”属性读入 NSString，然后将其转换为此处定义的“Dogs”类型：

```
typedef enum 
{   
Poodle,
GoldenRetriever,
GermanShepard,
Collie
} Dogs;

Dogs myDog = <string that came from the breed attr in the XML> 
```

任何帮助表示赞赏...

另外，我只是想澄清一下，我能够从 XML 中检索 attr 值（这非常简单）。但是，我的问题是，一旦有了 NSString，我就无法将其转换为枚举类型（即示例中的 Dog 类型）。我只包含了上面的 XML 示例，以说明我为什么要做这样的事情。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2009-03-27T17:08:30.587

没有办法开箱即用。您需要创建一个表格，允许您在运行时将字符串与适当的整数值相关联。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2009-03-27T07:45:15.107

我相当确定枚举值在编译时被整数替换，因此您要么必须单独测试与字符串的匹配，要么拥有一个您调用的枚举值数组`indexOfObject:`。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-09-12T16:30:17.150

您必须将枚举值放入 NSDictionary：

```
 NSDictionary *dogs = [NSDictionary dictionaryWithObjectsAndKeys:
                          [NSNumber numberWithInt:Poodle], @"Poodle",
                          [NSNumber numberWithInt:GoldenRetriever],   @"GoldenRetriever",
                          //.....
                          //.....
                          nil]; 
```

当您收集解析值时，在解析类中的某个位置将其放入另一个 NSDictionary

```
 dictOfParsedData = [NSDictionary dictionaryWithObjectsAndKeys:
                     //.....
                     //.....
                     [dogs valueForKey:[attributeDict objectForKey:@"breed"]], @"breed",
                     //.....
                     nil]; 
```

返回枚举类型元素的方法

```
-(NSInteger)valForGlobalKey:(NSString *)_key andSubKey:(NSString *)_key2{    
    return [[[dictOfParsedData valueForKey:_key] valueForKey:_key2] intValue];
} 
```

班级里有狗的地方

```
#import "ParsingClass.h" 
@interface ClassOfDogs : NSObject 
```

执行：

```
ParsingClass *parsingClassInst = [[ParsingClass alloc] initWithXMLFile:@"Dogs.xml"];    
Dogs myDog = [parsingClassInst valForGlobalKey:@"dog" andSubKey:@"breed"]; 
```

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2009-03-27T07:16:35.207

如果您使用 NSXMLParser，这将包含在传递给`parser:didStartElement:namespaceURI:qualifiedName:attributes:`委托方法的 xml 属性中。当它被称为`dog`元素时。

属性保存在以属性名称为键的 NSArray 中。在你的情况下，“品种”。因此，您可以使用以下方法访问包含狗名的字符串：

```
NSString* breedName = [attributesDictionary objectForKey:@"breed"]; 
```

然后你有一个字符串可以与你的狗名进行比较（使用 NSString 的比较）。

您可以通过制作自己的 NSNumbers 的 NSDisctionary 来获得更简洁的代码，其中包含由文本狗名键入的枚举值。

# svn - 不践踏svn责备的风格清理？

> ID：688569
> 
> 赞同：9
> 
> 时间：2009-03-27T04:30:16.887
> 
> 标签：svn, coding-style, metadata, blame

我想使用 Eclipse 的格式化程序来修复一些风格不佳的代码，但是杀死存储库中关于谁负责什么的所有元数据有一个巨大的缺点。关于解决这个问题的方法有什么想法吗？也许这完全不可能……

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2009-03-27T07:08:48.877

您可以告诉责备忽略空格更改：

```
svn blame -x -w file/path 
```

当然，这只有在您的样式修复不超过空格的情况下才有效。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-03-27T04:39:14.977

历史仍然存在，您只需在清理修订之前查看责任。

这是制定风格标准的一个很好的理由。缩进变化会导致很多合并冲突等。对一个“风格不佳”的人来说，对另一个人来说写得很好。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2011-01-17T16:16:32.373

另一种解决方案是添加一个预提交挂钩，将提交的文件与其格式化版本进行比较。如果没有差异，则接受提交。

否则，一条简单的消息“代码未格式化：提交被拒绝”会通知您的开发人员在提交之前设置修改后的文件的样式。

结合 Stefan 的回答，您仍然可以使用 -w 选项的责备，此外，您不会覆盖开发人员的姓名。

一个缺点是您将无法设置整个存储库的样式是一次通过。文件将在修改时设置样式。经常使用的文件将快速样式化，而有些可能永远不会更新。

* * *

## 回答 #4

> 赞同：-1
> 
> 时间：2009-03-27T09:38:09.733

重新格式化代码时，我通常只修复缩进。自动格式化程序破坏了精心手工格式化的部分的情况太多了。

# c# - IAsyncResult

> ID：688581
> 
> 赞同：5
> 
> 时间：2009-03-27T04:40:14.537
> 
> 标签：c#

为什么 IAsyncResult 要求我保留对 BeginInvoked 的委托的引用？

我希望能够写出类似的东西：

```
new GenericDelegate(DoSomething).BeginInvoke(DoSomethingComplete);

void DoSomethingComplete(IAsyncResult ar)
{
    ar.EndInvoke();
} 
```

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2009-03-27T07:34:43.120

^(在进行普通的1)委托时，您不需要保留自己对委托的引用`BeginInvoke`；您可以将其强制`IAsyncResult`转换为并从属性中`AsyncResult`检索委托。`AsyncDelegate`在有人说“这是一个肮脏的黑客”之前，[它在 MSDN 被记录为有效](http://msdn.microsoft.com/en-us/library/system.runtime.remoting.messaging.asyncresult.aspx)。

> AsyncResult 类与使用委托进行的异步方法调用结合使用。从委托的 BeginInvoke 方法返回的 IAsyncResult 可以转换为 AsyncResult。AsyncResult 具有 AsyncDelegate 属性，该属性保存调用异步调用的委托对象。

所以你可以写：

```
new GenericDelegate(DoSomething).BeginInvoke(DoSomethingComplete);

void DoSomethingComplete(IAsyncResult ar)
{
    ((GenericDelegate)((AsyncResult)ar).AsyncDelegate)).EndInvoke();
} 
```

请注意，您仍然必须知道原始委托的*类型*（或者至少，我还没有找到解决此限制的方法；我也没有尝试过）。

* * *

¹ By "normal" here I mean a `BeginInvoke` on a delegate instance, using the compiler-generated method. This technique of casting to `AsyncResult` is not guaranteed to work when using pre-defined methods, i.e. when using a class which declares its own `BeginX/EndX` methods. This is because the class may be doing something more clever internally such as blocking on IO completion ports, and may therefore use a different type of `IAsyncResult`. However, in the scenario as posited, it will work just fine.

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2009-03-27T07:20:37.303

我发现整个 Begin/End 模式不必要地复杂 - 所以我[看了一下将其包装起来](http://marcgravell.blogspot.com/2009/02/async-without-pain.html)（与 F# 使用的非常相似）。结果：不再需要保留委托（等）。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2009-03-27T04:48:25.593

IAsyncResult 是一个非常...过度使用的接口。要在这么多场景中成为可用的接口，它只能真正具有适用于所有使用它的场景的属性和字段。否则，API 将难以提供与其特定需求不自然的参数。

仅在一部分情况下为委托创建 IAsyncResult。Control.BeginInvoke 等其他场景不以委托开头，并且如果它们存在，则无法为接口属性提供委托。

IAsyncResult 在这里采用了极简主义的方法，并且只有它的所有用途可以提供的属性。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2009-03-27T07:18:13.347

尝试将委托作为异步状态参数传递，例如，

```
class Program {
    static void Main(string[] args) {
        Action d = delegate {
            Console.WriteLine("From the delegate");
        };
        var e = new ManualResetEvent(false);
        d.BeginInvoke(r => {
            ((Action)r.AsyncState).EndInvoke(r);
            e.Set();
        }, d);
        e.WaitOne();
    }
} 
```

# mysql - MySQL 5.0 中的 int 和 integer 有什么区别？

> ID：688582
> 
> 赞同：38
> 
> 时间：2009-03-27T04:41:07.513
> 
> 标签：mysql, types, integer

MySQL 5.0 中的 int 和 integer 数据类型有什么区别？任何人都可以帮忙吗？我不明白确切的区别。

* * *

## 回答 #1

> 赞同：54
> 
> 时间：2009-03-27T04:44:23.093

取自[MYSQL 5.0 在线参考](http://dev.mysql.com/doc/refman/5.0/en/numeric-types.html)

关键字 INT 是 INTEGER 的同义词。

* * *

## 回答 #2

> 赞同：16
> 
> 时间：2009-03-27T06:42:51.153

我想唯一的区别是拼写。

因此，通过使用 INT，您最终会在 SQL 脚本上使用更少的字节（这并不重要）。

* * *

## 回答 #3

> 赞同：11
> 
> 时间：2017-01-31T15:35:35.720

根据 MySQL[文档](https://dev.mysql.com/doc/refman/5.7/en/numeric-types.html)：

> 关键字 INT 是 INTEGER 的同义词

但如果您想编写与[ANSI SQL](http://www.contrib.andrew.cmu.edu/~shadow/sql/sql1992.txt)兼容的 SQL 脚本，请使用`INTEGER`. 根据[规范](http://www.contrib.andrew.cmu.edu/~shadow/sql/sql1992.txt)：

> SQL 定义了由以下关键字命名的不同数据类型：CHARACTER、CHARACTER VARYING、BIT、BIT VARYING、NUMERIC、DECIMAL、 **INTEGER**、SMALLINT、FLOAT、REAL、DOUBLE PRECISION、DATE、TIME、TIMESTAMP 和 INTERVAL。

这样，您将有更好的机会在其他 DBMS 上使用您的 SQL 脚本。例如[PostgresSQL](https://www.postgresql.org/docs/9.1/static/datatype-numeric.html)有`INTEGER`类型但没有`INT`类型。

* * *

## 回答 #4

> 赞同：2
> 
> 时间：2014-12-31T17:21:31.057

`int`和 integer之间的区别在于它是一种数据类型，而`int`integer 是一组数据类型——例如`int`、`long`和。`short``byte`

# php - 不修改标头的 PHP 重定向

> ID：688589
> 
> 赞同：2
> 
> 时间：2009-03-27T04:44:28.723
> 
> 标签：php, redirect, header, location

我有一个 PHP 脚本，它通过以下代码重定向用户：

`header ('Location: http://someurl/somepage.php');`

然后在 somepage.php 我试图访问`$_SERVER['HTTP_REFERER']`以确定页面请求的来源。`$_SERVER['HTTP_REFERER']`当使用标题位置方法调用页面时，我发现它是空的。

是否有另一种方法可以用来重定向用户，以便我仍然可以`$_SERVER['HTTP_REFERER']`在目标页面中使用。

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2009-03-27T04:54:57.043

您可以尝试的一件事：不发送`Location`标头，而是发回带有标签的 HTML 页面

```
<meta http-equiv="refresh" content="0;url=http://someurl/somepage.php"> 
```

在`<head>`节中。不过，我不确定它是否能解决您的问题……这实际上取决于浏览器的行为方式。的值`$_SERVER['HTTP_REFERER']`来自`Referer`浏览器可以自由发送或不发送的请求标头，由浏览器自行决定。

你可以做的其他事情是

```
header("Location: http://someurl/somepage.php?referer=http%3A%2F%2Fthisurl%2Fthispage.php"); 
```

即，将引用 URL 作为查询字符串参数发送，然后您可以将其作为`$_GET['referer']`. 这可能比依靠浏览器发送引用标头更可靠。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-03-27T04:59:56.033

HTTP Referer: 标头由用户代理设置，而不是由服务器设置。我不确定您是否可以采取任何措施来确保获得Referer 标头。

# javascript - 隐藏 DIV 的内容

> ID：688595
> 
> 赞同：1
> 
> 时间：2009-03-27T04:48:36.513
> 
> 标签：javascript, css

我有一个带有脚本的 DIV，如下所示

```
<div style="text-align:center">
                <script type='text/javascript' language='JavaScript' src='http://xslt.alexa.com/site_stats/js/t/a?url=www.mysite.com'></script>
</div> 
```

我想要的是用户不应该能够在网站上看到这个 div，但脚本应该以正常方式执行。请建议！

* * *

## 回答 #1

> 赞同：11
> 
> 时间：2009-03-27T04:50:40.957

我不确定您在该 Javascript 调用中包含了什么，但如果您想隐藏此 DIV 的内容，只需将其添加到样式声明中：`display: none;`

查看 CSS[显示](http://www.w3schools.com/css/pr_class_display.asp)文档。

**编辑**： DIV 标签内的 SCRIPT 仍然会被加载，我相信这是想要的效果。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-03-27T04:51:15.960

只需将您的样式更改为

```
<div style="text-align:center; display: none;">
                <script type='text/javascript' language='JavaScript' src='http://xslt.alexa.com/site_stats/js/t/a?url=www.mysite.com'></script>
</div> 
```

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2009-03-27T09:45:31.060

给你的 div 一个有意义的名字。

```
<div class="hidden">
</div> 
```

在 CSS 中添加

```
.hidden {
    display: none;
} 
```

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2009-03-27T04:54:15.207

当您想要对用户隐藏元素时，请将 css 设置为正确的“display: none;”

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2009-03-27T04:54:47.560

您必须使用以下代码设置 div 的样式：

```
<div style="text-align:center; display: none; visibility: hidden;">
  <!-- other code -->
</div> 
```

如果我没记错的话，这就是 Mozilla 团队的工作方式。

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2009-03-27T04:55:53.267

如果 JavaScript 生成了您不希望看到的 html 代码，您可以编写一些特定的样式来隐藏这些自动生成的元素，而不会隐藏您的外部 div。例如，如果 JavaScript 生成一个 div 并用内容填充它，那么您可以执行以下操作：

的HTML：

```
div id="hideinside">
                <script type='text/javascript' language='JavaScript' src='http://xslt.alexa.com/site_stats/js/t/a?url=www.mysite.com'></script>
</div> 
```

CSS：

```
#hideinside div {
    display:none; /* hides all divs inside your outer div */
} 
```

* * *

## 回答 #7

> 赞同：0
> 
> 时间：2009-03-27T09:59:18.733

```
div.hidden {
   position: absolute;
   left: 10000px;
} 
```

# vim - 将线条从一个窗口移动到另一个窗口

> ID：688603
> 
> 赞同：7
> 
> 时间：2009-03-27T04:54:24.567
> 
> 标签：vim

是否有一个简单的命令可以将行从一个窗口移动到另一个窗口。目前我去一个窗口，拉线，然后粘贴到另一个窗口。

我想知道我是否可以在不切换窗口的情况下做到这一点。

* * *

## 回答 #1

> 赞同：8
> 
> 时间：2009-03-27T05:12:35.973

我会用宏做这种事情。所以要为a、qa录制一个宏。然后 yy 拉出该行， :bnext 切换缓冲区， p 粘贴该行，然后再次 bnext 切换回原始缓冲区（在您开始的行上）。然后按 q 停止录制。

所以要复制，切换窗口，粘贴然后切换回来，你只需要使用@a。或将其映射到功能键（映射@a）。

注意刚刚在评论中注意到您有多个缓冲区，因此显然您需要相应地记录您的宏。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2009-03-27T05:22:52.390

你可以试试这个映射：

```
nmap <C-y> Y<C-w>wp<C-w>w 
```

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2009-03-27T05:16:32.670

使用 vimdiff 您可以使用 diffput 或 diffget 在缓冲区之间复制更改。从手册：

```
There are two commands to copy text from one buffer to another.  The result is
that the buffers will be equal within the specified range.

                        *:diffg* *:diffget*
:[range]diffg[et] [bufspec]
    Modify the current buffer to undo difference with another
    buffer.  If [bufspec] is given, that buffer is used.
    Otherwise this only works if there is one other buffer in diff
    mode.
    See below for [range].

                        *:diffpu* *:diffput*
:[range]diffpu[t] [bufspec]
    Modify another buffer to undo difference with the current
    buffer.  Just like ":diffget" but the other buffer is modified
    instead of the current one.
    See below for [range]. 
```

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2009-03-27T05:02:57.040

我怀疑这是否可能。但这里有一篇有趣的文章，内容是[关于 100 个 Vim 命令](http://www.catswhocode.com/blog/100-vim-commands-every-programmer-should-know)，如果你有兴趣，每个程序员都应该知道。

# php - $_GET updated_value(?) - 另一个就地编辑器（Jquery 插件）问题

> ID：688619
> 
> 赞同：0
> 
> 时间：2009-03-27T05:03:40.720
> 
> 标签：php, jquery, mysql

使用 PHP 和 MySql，我正在尝试在此处实现这个相当时髦的就地编辑器：

教程： [http ://www.davehauenstein.com/code/jquery-edit-in-place/](http://www.davehauenstein.com/code/jquery-edit-in-place/)

js 文件： [http ://davehauenstein.com/code/scripts/jquery.inplace.min.js](http://davehauenstein.com/code/scripts/jquery.inplace.min.js)

好的，正在发生的事情是，

1.  我单击元素以编辑文本。
2.  我清除旧文本，然后输入新文本。
3.  我在元素外部单击以启动 Ajax 以保存新文本。
    3.  Ajax 显示“正在保存..”，这是更新元素的默认文本。
    4.  新文本在数据库中更新。
4.  元素重新加载，而不是在元素内部显示新文本，而是显示元素（单击此处编辑文本），这是 js 文件中返回空元素的默认文本。

问题：只有在我手动刷新页面后，才会在元素中加载新文本。而不是在不刷新的情况下加载元素。

**具有就地编辑的元素：**

```
<div class="editme1"><?php
$content = $_GET['update_value'];
// i added this to try and get the updated value but im
// not really sure, just a guess. i have also used $_POST
// in an attempt to catch it....but i feel stupid even
// saying that..lol
if(!empty($content)) { echo "$content"; } else 
{ echo "$row[profilevalue_8]"; }
?></div> 
```

**更新数据库的文件（update.php）：**

```
<?php include('includes/config.php');
include('includes/functions.php');
$name = $_POST[update_value];
$update = mysql_query("UPDATE profilevalues SET profilevalue_8 = '".$name."' 
WHERE profilevalue_user_id = '".uid()."'") or die(mysql_error());
?> 
```

**javascript**

```
<script type="text/javascript">
    $(document).ready(function(){
        $(".editme1").editInPlace({
            url: "http://www.mysite.com/update.php",
            params: "ajax=yes",
        });
</script> 
```

我想问题是，我似乎无法按预期反映元素的变化。

如果有任何帮助，我将不胜感激。

谢谢

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-03-27T09:08:29.773

您在`update.php`:) 每个就地编辑器都会对更新文件执行 AJAX 请求，然后将通过该请求获得的内容放入已编辑的元素中`update.php`。

所以你的 update.php 需要是这样的

```
<?php include('includes/config.php');
include('includes/functions.php');
$name = $_POST[update_value];
$update = mysql_query("UPDATE profilevalues SET profilevalue_8 = '".$name."' 
WHERE profilevalue_user_id = '".uid()."'") or die(mysql_error());

echo $_POST['update_value']; //add this to your file and it should be working now
?> 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-03-27T09:15:12.643

为了补充 Bogdan Constantinescu 所说的话，我认为值得指出的是，为了防止人们输入令人讨厌的数据，你真的应该

*   调用`htmlspecialchars()`您作为 HTML 发送到浏览器的任何不受信任的字符串。这将有助于防止 XSS 攻击。
*   调用`mysql_real_escape_string()`您直接放入 SQL 语句的任何字符串。这将保护您免受 SQL 注入攻击。

# java - Servlet过滤器：socket需要在doFilter()中被引用

> ID：688621
> 
> 赞同：0
> 
> 时间：2009-03-27T05:07:15.503
> 
> 标签：java, servlets, sockets, servlet-filters

现在我有一个过滤器，它在 init 中打开了套接字，由于某种原因，当我在 doFilter() 中打开它们时，它不适用于服务器应用程序，所以我别无选择，只能将它放在 init 中

我需要能够引用 outSide.println("test"); 在 doFilter() 中，因此每次触发 if 语句时，我都可以将其发送到我的服务器应用程序。

这是我的代码：

```
import java.net.*;
import java.io.*;
import java.util.*;
import javax.servlet.*;
import javax.servlet.http.*;

public final class IEFilter implements Filter
{
  public void doFilter(ServletRequest request, ServletResponse response,
    FilterChain chain)

    throws IOException, ServletException
  {

    String browser = "";

        String blockInfo;

        String address =  request.getRemoteAddr();

    if(((HttpServletRequest)request).getHeader ("User-Agent").indexOf("MSIE") >= 0)
        {
            browser = "Internet Explorer";
        }

    if(browser.equals("Internet Explorer")) {

       BufferedWriter fW = new BufferedWriter(new FileWriter("C://logs//IElog.rtf"));

        blockInfo = "Blocked IE user from:" + address;

        response.setContentType("text/html");
        PrintWriter out = response.getWriter();
        out.println("<HTML>");
        out.println("<HEAD>");
        out.println("<TITLE>");
        out.println("This page is not available - JNetProtect");
        out.println("</TITLE>");
        out.println("</HEAD>");
        out.println("<BODY>");
        out.println("<center><H1>Error 403</H1>");
        out.println("<br>");
        out.println("<br>");
        out.println("<H1>Access Denied</H1>");
        out.println("<br>");
        out.println("Sorry, that resource may not be accessed now.");
        out.println("<br>");
        out.println("<br>");
        out.println("<hr />");
        out.println("<i>Page Filtered By JNetProtect</i>");
        out.println("</BODY>");
        out.println("</HTML>");

       //init.outSide.println("Blocked and Internet Explorer user");

            fW.write(blockInfo);

            fW.newLine();

            fW.close();

    } else {

      chain.doFilter(request, response);  

    }
  }

  public void destroy()
  {
        outsocket.close();
        outSide.close();
  }

  public void init(FilterConfig filterConfig)
  {

    try
    {
    ServerSocket fs;
    Socket outsocket;
    PrintWriter outSide ;

    outsocket = new Socket("Localhost", 1337);
    outSide = new PrintWriter(outsocket.getOutputStream(), true);

    }catch (Exception e){ System.out.println("error with this connection");  e.printStackTrace();}

  }
} 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2009-07-27T19:31:27.660

另一种可能性是使用 log4j 并让它处理套接字处理。log4j 可以配置为将此过滤器的日志消息保存在与任何其他日志记录不同的文件中。这将完全消除您的代码中对套接字的需求。

# html - 如何识别动画是flash动画还是flex动画？

> ID：688626
> 
> 赞同：1
> 
> 时间：2009-03-27T05:12:14.803
> 
> 标签：html, actionscript-3, flex3, flash

**在这个开发站点 URL ( [http://slide.zhoyosoft.com](http://slide.zhoyosoft.com) ) 中有一个介绍动画。

如何识别介绍动画是 flash 动画还是 flex 动画？**

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-03-27T07:31:43.173

[http://www.jamesward.com/is_it_flex/](http://www.jamesward.com/is_it_flex/)

[http://www.jamesward.com/is_it_flex/?url=http%3A%2F%2Fslide.zhoyosoft.com%2Fimage.swf](http://www.jamesward.com/is_it_flex/?url=http%3A%2F%2Fslide.zhoyosoft.com%2Fimage.swf)

您的回答： [http](http://slide.zhoyosoft.com/image.swf) ://slide.zhoyosoft.com/image.swf不是用 Flex 构建的

在确定是否使用 Flex 构建某些东西时，我遵循 3 步指南。

1.  在 Flex 中构建它有意义吗？Flex 非常支持与 Web 服务、图表交互，通常用于动态小部件。如果应用程序不具备这些品质中的任何一个，它可能就不是灵活的。

2.  它看起来像弹性吗？Flex 带有具有独特默认样式的预构建组件。大多数开发人员不会费心改变样式。有关 flex 样式的示例，请查看[http://examples.adobe.com/flex2/inproduct/sdk/flexstore/flexstore.html](http://examples.adobe.com/flex2/inproduct/sdk/flexstore/flexstore.html)

3.  如果仍然不确定，请使用上面的链接。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-03-27T05:20:58.747

Flex 只是 Flash 之上的一个框架，输出仍然是在 Flash Player 中播放的 Flash 文件。我认为您无法在浏览器中区分 Flash 和 Flex。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-03-27T05:36:08.100

一种方法 flex 预定义预加载器被识别为

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2009-04-22T09:07:49.197

flex 文件比 flah 文件大得多，框架通常大 250 kb。而且 flex 默认预加载器可以告诉你它的 flex。

# c# - 方法参数似乎是动态的，不确定它是如何工作的

> ID：688628
> 
> 赞同：1
> 
> 时间：2009-03-27T05:14:07.013
> 
> 标签：c#, delegates, dynamic-languages

如果我有一个委托和一个方法

```
public delegate void SomeDelegate(String p);

void aMethod(String p) {
} 
```

然后我尝试像这样在一个新线程上调用它

```
SomeDelegate sd = new SomeDelegate(aMethod());
sd.BeginInvoke("heyhey", callBack, null) 
```

BeginInvoke 方法调用现在接受一个字符串作为第一个参数，但是，如果我从委托和 aMethod() 中删除“String p”，BeginInvoke 现在只需要两个参数。

如何构建一个像 BeginInvoke 这样的函数，它可以根据其他地方的代码动态接受不同类型的参数？

对不起，如果我在这里含糊不清，但我以前从未见过这个，我很好奇。

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2009-03-27T06:35:48.690

我认为您缺少的是 // 方法未定义的事实`Invoke`-它们`BeginInvoke`是由编译器为委托类型自动生成的。`EndInvoke``Delegate`

当您最初声明时

```
public delegate void SomeDelegate(String p); 
```

编译器生成：

```
public class SomeDelegate : Delegate
{
    public SomeDelegate(Object target, IntPtr method) { ... }

    public virtual IAsyncResult BeginInvoke(string p, 
        AsyncCallback callback, object @object) { ... }

    public virtual void EndInvoke(IAsyncResult result) { ... }

    public virtual void Invoke(string p) { ... }
} 
```

（带有适当的方法体、属性等）。

当您更改 SomeDelegate 的签名以删除参数时，生成的类型将更改为：

```
public class SomeDelegate : Delegate
{
    public SomeDelegate(Object target, IntPtr method) { ... }

    public virtual IAsyncResult BeginInvoke(
        AsyncCallback callback, object @object) { ... }

    public virtual void EndInvoke(IAsyncResult result) { ... }

    public virtual void Invoke() { ... }
} 
```

没有什么真正动态的 - 你改变了 的签名`SomeDelegate`，这改变了 . 的签名`SomeDelegate.BeginInvoke`。没什么神秘的。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2009-03-27T05:30:03.280

我相信这是 Intellisense 为代表们做的工作。

您可能可以使用**params**关键字定义一个方法，以使该方法接受可变数量的参数，但在 C# 4.0 发布之前（它具有可选参数和命名参数），我不确定您是否可以自己做类似的事情。

当然，我可能是错的。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-04-29T16:27:04.517

这不是你能做的。你没有编译器强大！

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2009-03-27T05:20:33.643

这称为方法重载。[您可以在此处](http://csharp.net-tutorials.com/classes/method-overloading/)找到教程。

编辑：

那我可能误解了你的问题。

如果您正在寻找如何在不重载的情况下接受不同的参数，请使用：

```
public void MyMethod(params object[] args)
{
  foreach (object o in args)
  {
    Type t=o.GetType();
    // do something with o depending on the type
    if (t==typeof(int))
    {
      int i=(int)o; 
      // ...
    }
    else if (t==typeof(string)) // etc.
    {
    }
  }
} 
```

然后您可以致电：

```
MyMethod(5, "foo", 7.77);
MyMethod("foo", "bar");
// etc. 
```

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2009-03-27T05:42:05.997

目前还不太清楚你想做什么。如果您想知道如何创建具有不同参数的新委托，请执行以下操作：

```
public delegate void SomeDelegate(String p, string q);
private static void aMethod(string p, string q) 
{
    Console.WriteLine(p + q);
} 
```

并使用委托：

```
SomeDelegate sd = new SomeDelegate(aMethod);
sd.BeginInvoke("heyhey", "yoyo" callback, null); 
```

另一方面，如果您想通过调用一个方法来启动一个新线程，而无需先前定义的委托，您可以使用：

```
ThreadPool.QueueUserWorkItem(delegate { aMethod("heyhey", "yoyo"); }); 
```

# html - 用于描述 html 文档上的元素的用户友好工具

> ID：688629
> 
> 赞同：0
> 
> 时间：2009-03-27T05:14:28.153
> 
> 标签：html

我接手了一个已经开发了一段时间的新项目。开发团队和项目经理有一个很好的问题跟踪系统，通常是很好的合作伙伴，但我发现很难跟踪遗留问题并准确理解人们在谈论什么。这部分是因为我是该项目的新手，而且规模相当大，但部分原因是对技术问题的模糊描述。

我想知道是否有任何简单的工具可用于准确描述 html 文档中存在的元素或有助于为开发人员描述特定问题的语言。XPath 似乎是一个很好的起点。这对于项目经理来说必须很容易，而不仅仅是开发人员。使用场景是我能想到的另一个可能相关的工具。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-03-27T09:27:56.343

有一个很好的工具可以非常准确地描述具体问题：它被称为“编程语言”。问题是，即使是简单的问题（“不起作用”）也只是隐藏了一个真正想要摆脱的复杂问题。看看我的[电梯示例](http://blog.pdark.de/2007/07/02/the-elevator-problem-or-why-writing-software-is-so-hard/)，简单的问题如何迅速变成一场噩梦。

所以在你的情况下，你有几个问题需要解决：

*   你是一个不知道怎么走的初学者。只有时间和奉献精神才能解决这个问题。学习复杂系统没有捷径可走（否则，它将是一个简单的系统）。

*   如果您作为开发人员需要处理 HTML 页面中的特定元素，我建议使用以下算法：

    ```
    list = new List();
    while (element != null) {
        String s = element.name;
        parent = element.getParent();
        if (parent != null && parent.getChildren(element.name).size() > 1) {
            s += "[" parent.indexOf(element) + "]";
        }
        list.insert(0, s);
        element = parent;
    }
    return list.join(";"); 
    ```

    这给出了一个短字符串，它唯一地标识 XML/HTML 文档中的每个元素。对开发人员来说完美，对用户无用。这导致了我们问题的最后一部分。

*   There is no tool which works equally well for users, project leads and developers. Why? Because if it would, then one of them could do the job of the other. That's why we develop in teams: People can do different things. A project lead should understand the developer but he shouldn't be better. If the user could understand and write the code, why would he need a developer?

# api - 垃圾邮件蜜罐api

> ID：688631
> 
> 赞同：0
> 
> 时间：2009-03-27T05:15:21.287
> 
> 标签：api, email, email-spam, honeypot

我想知道是否有一个垃圾邮件蜜罐 api arround 允许用户获取实际的电子邮件内容。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-03-28T16:25:00.170

如果您需要垃圾邮件来进行数据挖掘，那么您最好找到[垃圾邮件语料库](http://www.google.com/search?hl=sv&client=safari&rls=sv-se&q=spam+email+corpus&btnG=S%C3%B6k&lr=)（谷歌链接）。[顶级站点](http://plg.uwaterloo.ca/~gvcormac/treccorpus/)提供了一个可下载的 zip 文件，其中包含大量垃圾邮件，让您大吃一惊。

# xml - 我们可以在 XML 文件中使用数字作为文本节点吗？

> ID：688635
> 
> 赞同：8
> 
> 时间：2009-03-27T05:16:44.857
> 
> 标签：xml

我们可以在 XML 文件中使用数字作为文本节点吗？例如

```
<2>
 <abi>Zen</abi>
</2> 
```

它给出的错误如下

* * *

## 回答 #1

> 赞同：18
> 
> 时间：2009-03-27T05:25:30.527

XML 元素必须遵循以下命名规则：

```
* Names can contain letters, numbers, and other characters
* Names cannot start with a number or punctuation character
* Names cannot start with the letters xml (or XML, or Xml, etc)
* Names cannot contain spaces 
```

[http://www.w3schools.com/xml/xml_elements.asp](http://www.w3schools.com/xml/xml_elements.asp)

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-03-27T05:27:08.340

阅读[xml 规范](http://www.w3.org/TR/REC-xml/#syntax)：

> & 符号 (&) 和左尖括号 (<) 不得以其文字形式出现，除非用作标记分隔符，或者在注释、处理指令或 CDATA 部分中。如果在其他地方需要它们，则必须分别使用数字字符引用或字符串“&”和“<”对它们进行转义。右尖括号 (>) 可以使用字符串“>”表示，并且为了兼容性，必须使用“>”或出现在字符串“]]>”内容中的字符引用进行转义，当该字符串未标记 CDATA 部分的结尾时。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2014-04-08T20:45:51.343

**不，你不能使用**

XML 命名规则

XML 元素必须遵循以下命名规则：

```
1\. Names can contain letters, numbers, and other characters
2\. **Names cannot start with a number or punctuation character**
3\. Names cannot start with the letters xml (or XML, or Xml, etc)
4\. Names cannot contain spaces 
```

可以使用任何名称，不保留任何字词。

**根据第二条规则，您不能在 XML 文件中使用数字作为文本节点，因为它的意思是标签以数字开头**

[了解更多详情](http://www.w3schools.com/xml/xml_elements.asp)

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2009-03-27T09:48:40.287

简短的回答：没有。

不过，你可以使用这样的东西

```
<element2>
  <abi>Zen</abi>
</element2> 
```

但这会产生一个非常丑陋的 XML 模式，最终您将被限制在最大数量的元素上。

我认为你应该这样做：

```
<element number="2">
  <abi>Zen</abi>
</element> 
```

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2019-09-23T13:28:28.757

实际上它可以做到 - 你必须用它的[unicode 表示](https://www.w3.org/Style/XSL/TestSuite/results/4/XEP/symbol.pdf)替换 XML 标记中的第一个数字字符，其中：

*   0 = x0030
*   1 = x0031
*   2 = x0032
*   3 = x0033
*   4 = x0034
*   5 = x0035
*   6 = x0036
*   7 = x0037
*   8 = x0038
*   9 = x0039

例如节点`<111222></111222>`可以定义为：

```
<_x0031_11222>
</_x0031_11222> 
```

Java Content Repository - Apache Jackrabbit 项目以这种方式处理节点名称。它并不漂亮，但它回答了这个问题。

# jquery - 使用 ASP.NET 和 MVC 提交表单以执行正确操作

> ID：688645
> 
> 赞同：3
> 
> 时间：2009-03-27T05:23:33.577
> 
> 标签：jquery, asp.net-mvc

我有一个简单的表单，用于更新我的 ASP.NET MVC 应用程序中的实体。我希望用户能够提交表单，调用我的控制器上的正确操作，然后通知用户更新已完成。

因为我想在用户单击更新按钮后显示一个 JQuery 对话框，所以我想使用 JQuery 来提交表单。然而，我的问题是这样的：

虽然我可以很容易地让 JQuery 在我的控制器上调用一个动作，但我不能让它调用一个我已经在我的路由中设置并且已经用`[Authorize]`和装饰的动作`[AcceptVerbs(HttpVerbs.Post)]`

例如，如果用户在以下 URL 更新他们的实体：

```
/SomeController/Edit/5 
```

当 JQuery 提交表单时，我想将其提交给我的编辑操作，该操作已经装饰并接受 ID 作为参数。

我用来发布表单的 JQuery 如下：

```
$("#formFoo").submit(function() {
                var frm = $("#formFoo");
                var action = frm.attr("action");
                var serializedForm = frm.serialize();
                $.post(action, serializedForm, function() {
                    alert('Call completed');
                });
                return false;
            }); 
```

如果我将我的表单定义如下：

```
<form id="formFoo" action="/SomeController/SomeOtherAction" method="post"> 
```

我的行动如下：

```
public void SomeOtherAction() 
{
    var myEntity=new MyEntity();
    UpdateModel(myEntity);
} 
```

然后我的动作被调用并且我的对象被正确填充，但它的 ID 字段没有被填充，所以我不知道我正在更新什么实体。

如果我将表格更改为：

```
<form id="formFoo" action="/SomeController/Edit" method="post"> 
```

我将我的编辑操作定义为：

```
[Authorize,AcceptVerbs(HttpVerbs.Post)]
public void Edit(int id, FormCollection collection) 
```

然后我的动作似乎永远不会被 JQuery 调用。

我想我可以以某种方式从查询字符串中提取 ID 参数并将其填充到我要发回表单的数据中，但这看起来很丑陋。或者有没有办法在我的 SomeOtherAction 操作中获取 ID 字段？还是我只是把这一切都错了？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2009-03-27T11:53:45.323

你打电话时：

```
$.post(action 
```

然后“action”参数需要包含 ID。在您的问题中，您没有在运行时说出这是什么，但我强烈怀疑它不包含 ID。根据您的编辑操作的示例 URI，ID 应该在 URI 的路径中，而不是在查询中。使用默认的 MVC 路由应该没有任何区别，但是在不知道您的路由是什么的情况下，我会说您应该严格遵守您在问题中给出的 URI 格式。

所以安装 firebug，如果你还没有，在 JavaScript 中放置一个断点，并检查 action 参数的值。

如果仍然正确，打开 Firebug 的 Net 面板，单击 XHR 选项，然后查看您的代码生成的实际 URI。确保它是正确的。如果 URI 不正确，请查看您的路由并确保此 URI 将正确路由到正确的操作。

最后，但我在一个插件中为[jQuery Ajax Form 插件](http://malsup.com/jquery/form/)。我发现它使这种事情变得非常容易。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-03-27T12:44:52.687

你有两种方法可以做到这一点。

您可以使用 FormCollection 或使用实体。

FormCollection 示例：

*   控制器

    ```
    public ActionResult ProductEditHandle(int? productID, FormCollection formCollection)
    {
        Product product = null;

    if (productID.HasValue)
        product = ProductEditUpdateModel(productID.Value, formCollection);

    return View("ProductEdit", product);
    } 
    ```

*   看法

    ```
    <% using (Html.BeginForm("ProductEditHandle", "Product", new { productID = 5 })) { %>
    ......
    <% } %> 
    ```

带有实体的样本：

*   控制器

    ```
    public ActionResult AddressTypeHandler(AddressTypeDto addressTypeDto)
    {
        var addressType = addressTypeDto.AddressTypeId > 0 ? _addressService.UpdateAddressType(addressTypeDto) : _addressService.CreateAddressType(addressTypeDto);

    return RedirectToAction("AddressTypeEdit", new { addressTypeId = addressType.AddressTypeId });
    } 
    ```

*   视图（使用 ViewPage - AddressTypeDto 声明的视图）

    ```
    <% using (Html.BeginForm("AddressTypeHandler", "People")) { %>

    <%= Html.Hidden("AddressTypeDto.AddressTypeId", (ViewData.Model != null) ? ViewData.Model.AddressTypeId : 0) %>
    <%=Html.TextBox("AddressTypeDto.Name", ViewData.Model != null ? ViewData.Model.Name : string.Empty, new { size = 50 })%>
    <% } %> 
    ```

# ruby-on-rails - 只有某些用户无法再在 facebook 上接收通知

> ID：688648
> 
> 赞同：1
> 
> 时间：2009-03-27T05:25:49.343
> 
> 标签：ruby-on-rails, ruby, facebook

只有某些用户无法再收到来自我的应用程序的通知。我能够使用测试帐户重新生成它，但我不知道如何删除/添加应用程序似乎无法解决问题。

此应用程序仅由 4-5 名测试人员使用，发送给任何给定用户的通知数量非常少，没有人将其报告为垃圾邮件。

我正在使用 rails 2.2.2 和 Facebooker。

我发送通知的方式是创建一个新会话并从该会话调用 send_notification。

```
ses = Facebooker::Session.create
ses.send_notification(fbuid, "hay there") 
```

我没有收到任何错误，只是用户没有收到通知。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-03-27T06:34:43.200

每天可以向用户发送多少通知是有限制的。

用户到用户的通知和应用程序到用户的通知都有限制。

您可以通过调用来确定这些限制中的每一个：

```
Facebooker::Session.create.post('facebook.admin.getAllocation', :integration_point_name => 'announcement_notifications_per_week')
Facebooker::Session.create.post('facebook.admin.getAllocation', :integration_point_name => 'notifications_per_day') 
```

应用程序的开发人员似乎可以收到无限量的金额，因此您可能希望让您的测试帐户成为开发人员。

此外，send_notification 的第一个参数需要是一个数组。您对变量名称“fbuid”的使用表明您可能正在传递一个整数。

祝你好运！

# java - OSGi 和 Java EE - JOSGiEE？

> ID：688651
> 
> 赞同：9
> 
> 时间：2009-03-27T05:26:21.337
> 
> 标签：java, jakarta-ee, osgi

读完[这篇文章](http://itknowledgeexchange.techtarget.com/soa-talk/osgi-and-future-directions-for-enterprise-java/)后，我想到了一个问题：'OSGi 会变成 Java EE 吗？OSGi 会取代 Java EE 吗？OSGi 是否在增加 Java EE？确实，从历史上看，OSGi 与 Java EE 完全不同，但现在考虑到 EEG 产生的工作，其中一些服务是 Java EE 服务。另一个事实是，使用 Java EE 的人将其用于其 API，这与 OSGi 相矛盾，OSGi 应该与 API 无关。

我不知道它会去哪里，你们呢？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2009-03-27T10:51:39.357

OSGi 是容器技术。它与 Java EE 技术（例如）Servlet、JDBC、EJB、JMS 等无关。

它负责代码组件的打包（打包）及其管理。这可能会影响您打包解决方案的方式（例如，您可能不使用 .ear 或 .war），但您习惯于编程的 API 不会改变。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2009-03-27T10:53:59.413

如果您想尝试它，它已经存在：[IBM WebSphere Application Server 6.1：组件化概述](http://publib.boulder.ibm.com/infocenter/ieduasst/v1r1m0/topic/com.ibm.iea.was_v6/was/6.1/Architecture/WASv61_Componentization/player.html?dmuid=20061227202131422194&noframes=true)。我认为 BEA 和 JBoss 的实现正在进行中，但我最近没有听到任何消息。

OSGi 不会替代 Java EE——它通过添加插件框架来扩展它。它是否会成为未来 Java EE 标准的一部分可能取决于[Sun 收购后会发生什么、](http://www.theregister.co.uk/2009/03/18/ibm_buying_sun/) [Jigsaw 项目（](http://blogs.oracle.com/mr/entry/jigsaw) [JSR 277](http://jcp.org/en/jsr/detail?id=277)的替代品）的未来以及一些我不知道的因素。[Java EE 6](http://jcp.org/en/jsr/detail?id=316)没有任何计划，除了交叉手指并希望将其纳入[Java 标准版 7](https://jdk7.dev.java.net/)中。

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2009-10-29T23:45:11.810

OSGi 没有成为 J2EE……我不确定这意味着什么！它正在添加有助于将 J2EE 代码更顺畅地迁移到 OSGi 的特性。但它们是可选功能，如果您没有 Java EE 遗留，则无需使用它们。

或许更好的问题是 OSGi 是否会像 J2EE 那样成为被广泛接受的 Java 应用程序部署容器。恕我直言，答案显然是肯定的。

* * *

## 回答 #4

> 赞同：2
> 
> 时间：2009-04-09T09:21:18.960

我喜欢[OS-JEE-i](http://www.jroller.com/habuma/entry/os_jee_i)这个词。

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2009-03-27T08:57:52.017

看看 InfoQ 关于新流行词[JOSH: A Proposed Software Stack for the Enterprise 的](http://www.infoq.com/news/2009/03/JOSH)文章。根本没有 Java EE。只有**J** SON、**O** SGi、**S** cala 和**H** TTP。这很有趣……

# c# - LINQ to SQL 类

> ID：688658
> 
> 赞同：2
> 
> 时间：2009-03-27T05:31:00.857
> 
> 标签：c#, sql, linq

是拥有一个包含所有表的胖数据上下文类还是将它们分成更小的类并可能具有“单表”类更好？

从组织的角度来看，我觉得我不应该在多个数据上下文中拆分关系（我什至不认为这是可行的）。但另一方面，我认为创建该胖类的全新实例只是为了查询一个不相关的表是一种矫枉过正的做法。

你怎么看？

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2009-03-27T05:43:08.740

无论它管理多少表，构建数据上下文并不昂贵，因此在决定是否拥有一个或多个单独的数据上下文实现时，这不应该成为标准。一个新的数据上下文是“空的”，直到您真正开始使用它，并且根据需要创建表实例。

使数据上下文实例变得昂贵的原因是，当您一遍又一遍地使用同一个实例来跟踪对不同对象的更改时——例如，在 ASP.NET 应用程序中为所有数据库操作使用数据上下文的缓存实例（现在这是不，不）。

只要您按预期使用数据上下文，在工作单元模式中，它可以在类定义级别管理多少表并不重要，因为您只在当前单元中实例化您需要的表工作。

对我来说，数据上下文在逻辑上代表目标数据库，因此它应该代表在该数据库中映射的所有实体，无论是 10 个还是 100 个 - 除了给定类中的代码行更少之外，将其拆分确实没有任何好处，但如果这是你关心的事情，那么无论如何，有不同的课程。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-03-27T05:36:00.940

取决于你有多少表。如果它说小于，比如说，20，我个人不会把它分开。

如果您愿意，您可以按任务、关系或目的进行拆分。

取决于你，我会说，真的。我首先要记住的是“哪种方式最易于维护？” 在决定是否拆分它们时。

# c# - 使用 C# 将 RichTextBox 内容与其他数据一起保存/加载

> ID：688660
> 
> 赞同：0
> 
> 时间：2009-03-27T05:32:34.363
> 
> 标签：c#, load, richtextbox, save

我目前正在尝试弄清楚如何将 RichTextbox 中的内容保存到流中（当前使用 FileStream），并与一堆其他数据一起执行此操作。然后当然我希望能够从这个文件中加载。我目前正在尝试使用以下内容。

```
FileStream stream = new FileStream(); //this is actually correctly defined.
ASCIIEncoding encoding = new ASCIIEncoding();

//write Title
byte[] array = encoding.GetBytes(Title);
stream.WriteByte(Convert.ToByte(array.Length));
stream.Write(array, 0, array.Length);

//save textRange
textRange.Save(stream, System.Windows.DataFormats.Rtf);

//write Subtitle
byte[] array = encoding.GetBytes(Subtitle);
stream.WriteByte(Convert.ToByte(array.Length));
stream.Write(array, 0, array.Length);
//ect...and something very similar for Loading a file. 
```

这基本上就是我想要做的。我实际上保存了 2 个 TextRanges 和更多的属性。所以我的问题是 TextRange.Load() 读取到文件的末尾......考虑到我有 2 个需要保存/加载的 TextRanges，我无法使用它。所以在这里我试图想出另一种方法来保存/加载 RichTextBox 的内容和其他数据。我不必使用流。我对任何可行的解决方案都持开放态度。提前致谢！

~杰森

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2009-03-27T05:39:33.443

您可以加载/保存到 MemoryStream 以解决读取到文件末尾的问题。它可能看起来像这样：

*   将文件加载到内存中
*   将该文件中作为富文本框内容的部分加载到 MemoryStream 中
*   从该 MemoryStream 加载 Richtextbox 内容

或者您想知道如何创建和解析文件以包含标题、内容和任何其他字段的不同部分？

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-03-29T09:39:24.847

我想我应该发布我当前的解决方案。它似乎工作得很好。感谢 Chris 和 Ants 提供有关如何执行此操作的提示。

```
/// <summary>
    /// Reads a TextRange (DataFormats.Rtf) from the stream.
    /// </summary>
    /// <param name="stream">The stream to be read from.</param>
    /// <returns>The TextRange (DataFormats.Rtf) that was read from the stream.</returns>
    public static TextRange ReadTextRange(FileStream stream)
    {
        long startPos = stream.Position;
        int length = -1;
        int count = 0;
        int previousByte = 0;
        int currentByte = 0;
        //set previousByte to give the current one something to compare to
        previousByte = stream.ReadByte();
        //parse the file counting the { and } to find the end of the rtf portion of the file.
        while (count > 0 || length < 1)
        {
            length++;
            stream.Position = startPos + length;
            currentByte = stream.ReadByte();
            if (previousByte != 92) // not '\' so check to see if '{' or '}' is currentByte
            {
                if (currentByte == 123) // '{' increase count
                    count++;
                else if (currentByte == 125) // '}' decrease count
                    count--;
            }
            previousByte = currentByte;
        }
        //save finish position to move to later
        long finishPos = stream.Position;
        //reset stream position to start at beginning of rtf
        stream.Position = startPos;
        //read the rtf portion of the file into a byte[]
        byte[] content = new byte[length];
        stream.Read(content, 0, length);
        //put the byte[] into a memory stream
        MemoryStream memStream = new MemoryStream(content);
        FlowDocument doc = new FlowDocument();
        TextRange range = new TextRange(doc.ContentStart, doc.ContentEnd);
        //have the TextRange read from the memorystream
        range.Load(memStream, System.Windows.DataFormats.Rtf);
        memStream.Close();
        //set the position to after the rtf portion of the file
        stream.Position = finishPos;
        return range;
    } 
```

此 ReadTextRange 方法位于我为帮助从 FileStream 读取而定义的 StreamHelper 类中。所以这一切都是为了加载一个像这样保存到 FileStream 的 TextRange ......

```
//save query (TextRange)
        Query.Save(stream, System.Windows.DataFormats.Rtf); 
```

我希望有人在遇到类似问题时发现这很有用！:D

编辑：

我使用了一个分析器，发现这段代码效率不高，所以我改变了这段代码，使其在一些方面更有效率。

1.  而不是使用 TextRange 并使用包含 MemoryStream memStream 内容的 byte[]。这会减少 range.Load 消耗大量 CPU 的时间。

2.  我取出了行 stream.Position = startPos + length 因为我意识到它在第一次运行后没用，并且还占用了相当多的 CPU。我放置了stream.Position--; 在 previousByte = stream.ReadByte(); 行之后

此外，我意识到我是一个糟糕的编码员，并且没有通过在我的数据类中包含 TextRange、UI 元素来遵循 MVC。现在它有一个字节[]，这要好得多。

再次编辑：

在使用 byte[] 而不是 TextRange 几分钟后，我意识到我有 byte[] 的大小，所以我不需要解析它。因此，我保存写入字节 [] 大小，然后写入字节 []。这使得它非常快，几乎可以立即读取一个非常大的文件。

# php - 使用 PHP 将数组公式添加到 Excel 电子表格

> ID：688661
> 
> 赞同：1
> 
> 时间：2009-03-27T05:33:13.800
> 
> 标签：php, export-to-excel, pear

我正在使用 PEAR 扩展名 Spreadsheet_Excel_Writer 生成一个 Excel 电子表格。我需要向其中一个单元格添加一个[数组公式](http://www.cpearson.com/excel/ArrayFormulas.aspx)，但我读到的所有关于它们的信息都只讨论它们，就好像你在 Excel 程序本身中一样：它说你必须像往常一样输入公式，然后按`Ctrl`+ `Shift`+`Enter`将其切换为数组公式。

有没有办法以编程方式做到这一点？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-03-27T06:28:10.177

有一个称为`FormulaArray`允许以编程方式输入数组公式的属性。希望这可以从您的 PHP 扩展中向您展示。

用法：

```
Sheet1.Range("C1:C3").FormulaArray = "=(A1:A3)*(B1:B3)"
```

# javascript - 如何在 dojox.charting 中注销图例？

> ID：688662
> 
> 赞同：1
> 
> 时间：2009-03-27T05:33:17.733
> 
> 标签：javascript, dojo

我有以下代码通过 dojox.charting 创建图表图形：

```
function createChart() {
  var node = dojo.byId("surfaceDiv");
  while (node.hasChildNodes())
  {
    node.removeChild(node.lastChild); // remove all the children graphics
  }
  var nodes =  "<div id='chart1' style='width: 10px; height: 10px;'></div><div id='legend1' ></div>";
  dojo.html.set(node, nodes);
  var nodeChart = dojo.byId("chart1");
  var nodeLegend = dojo.byId("legend1");

  var chart1 = new dojox.charting.Chart2D(nodeChart);
  // set chart types and point series
  chart1.render();
  // now to add legend:
  var legendNode = new dojox.charting.widget.Legent(
     {chart: chart1}, nodeLegend.id));
} 
```

该功能适用​​于第一次通话；但是，如果再次调用，图表显示OK，但图例不显示。在萤火虫中，我注意到在 manager.xd.js（第 8 行）中有一条错误提示“尝试使用 id==legend1 注册小部件，但该 id 已注册”。看起来 dojox 库中的某个地方缓存了具有相同 ID 的前一个图例对象。

我想我必须清除以前注册或缓存的任何图例。我怎样才能做到这一点？

顺便说一句，在我的 html 页面中，我有几个 ancor 链接来调用 JavaScript 函数以在 id="surfaceDiv" 的 div 节点中绘制不同的图形，并且图例节点"是 id="legendDiv" 的下一个 div。因此，可以再次调用上述函数。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-08-20T17:49:39.413

我正在使用 dojox 1.3.0，发现以下对我来说很好（图例是全局变量），没有任何错误：

```
if (legend != undefined) {
  legend.destroyRecursive(true); 
} 

legend = new dojox.charting.widget.Legend({chart: chart1,horizontal: true}, 'legend');

//or try this
var myObj = new dojoObject(...);
...
// do whatever we want with it
...
// now we don't need it and we want to dispose of it
myObj.destroy();
delete myObj; 
```

在这种情况下，图例在重新创建之前被销毁。

这是关于这个主题的另一个链接：http: [//www.dojotoolkit.org/forum/dojox-dojox/dojox-support/how-unregister-legend-dojox-charting](http://www.dojotoolkit.org/forum/dojox-dojox/dojox-support/how-unregister-legend-dojox-charting)

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2011-03-07T23:39:09.190

为什么不使用图例的`refresh()`方法？那可行。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-03-27T18:20:49.480

我认为这是 dojox.charting.widget.Legend(...) 中的一个错误。我所做的是清理 div "surfaceDiv" 下的所有图形和图例 dom 元素，并为图表添加新的 div "chart1" 和 div "legend1" 作为图例。该图表工作正常，但不是图例。我的 html 中有以下对函数的锚链接调用：

```
....
<a href="javascript:createChart();">Curve chart</a>
.... 
```

因此，函数 createChart() 可以在同一个网页会话中多次调用。第一次显示图表和图例，但在随后的调用或单击中缺少图例。

要解决问题或错误，我必须使用不同的值动态设置图例 ID。dojox.charting.widget.Legend(...) 中的任何缓存图例 id 值都不会与新 id 冲突。这是代码：

```
var legendCount = 0; // global value 

function createChart() {
  var node = dojo.byId("surfaceDiv");
  while (node.hasChildNodes())
  {
    node.removeChild(node.lastChild); // remove all the children graphics
  }
  var legendID = "legend" + legendCount++;
  var nodes =  "<div id='chart1' style='width: 10px; height: 10px;'></div>" +
    "<div id='" + legendID + "' ></div>"; // Set legend ID dynamically
  dojo.html.set(node, nodes);
  var nodeChart = dojo.byId("chart1");
  var nodeLegend = dojo.byId(legendID);

  var chart1 = new dojox.charting.Chart2D(nodeChart);
  // set chart types and point series
  chart1.render();
  // now to add legend:
  var legendNode = new dojox.charting.widget.Legent(
    {chart: chart1}, nodeLegend.id)); // no more conflict legend's ID
} 
```

我再次测试了我的代码和 html 页面。每次都显示传奇！

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2009-03-28T20:31:46.660

我上面发布的方法不是解决问题的好方法。根据我的发现案例，dojox 的内部人员证实这是 dojox.charting 中的一个错误。他不推荐我的方式，删除我认为用于图表和图例的 HTML 元素作为解决方案。

我觉得他的建议是对的。图表和图例由 dojox.charting API 创建。我的 html 页面案例可能不会显示所有要删除的 DOM 对象，只是为了清理。缓存中的一些 DOM 对象可能没有被清理干净。例如，在 JS 代码中，我在一个空 div 下添加了两个 div：一个用于图表，一个用于图例。dojox.charting API 在图表 div 下添加 svg 节点并将图例 div 转换为表格。除此之外，在我最初的空 div 之外创建了几个不可见的 div。这种清理方法会留下一些混乱或导致不可预知的问题。此外，我的方法可能会在新的或更新的 dojox.charting API 的未来被破坏（例如修复错误）。

由于我是 dojox.charting 的新手（上周刚开始根据[一篇文章](http://dojotdg.zaffra.com/2009/03/dojo-now-with-drawing-tools-linux-journal-reprint/)通过其 API 编写一些测试代码），我不确定 dojox.charting 是否提供任何清理图表和图例的方法？我认为如果可用的话，这将是最好的方法或 API。

**即使我的上述解决方案也适用于我的基础，删除空 div 下的所有儿童节点，你应该意识到潜在的问题**。

到目前为止，我能找到的所有演示代码都是用于创建或向网页添加新图表的示例代码。据我所知，没有人可以更新、操作或简单地刷新图表。如果数据系列来自 Web 服务或 REST，则只需更新图表区域即可。下面是 HTML 页面 UP 布局的示例：

```
 Curve chart                 -----------------------
 Pie chart                   |  div area for chart |
 Bar chart                   |                     |
 Refresh chart with changes  |                     |
                             ----------------------- 
```

使用可用于在一个 div 区域中创建图表的选项，我认为如果之前生成了任何图表，我确实需要清理 div。

通过查看 dojox.charting API 如何创建图表和图例的代码：

```
 // nodeDivForChart and NodeDivForLegend are div nodes
 var chart1  = new dojox.charting.Chart2D(nodeDivForChart);
 ....
 var legend1 = new dojox.charting.widget.Legend(
   {chart: chart1}, nodeDivForLegend.id); 
```

我的猜测是 chart1 和 legend1 是 DOM 实例还是对象？不确定是否有任何方法可以销毁这些实例以清理图表和图例？如何？

# c - 该声明声明了什么？

> ID：688664
> 
> 赞同：1
> 
> 时间：2009-03-27T05:34:52.690
> 
> 标签：c, types, static, declaration

```
struct ast_channel *(* const requester)(const char *type, int format, void *data, int *cause); 
```

这条线是什么意思？

第二个问题：使用有什么好处

```
static struct hello
{
    int a;
    chat b;
}; 
```

简单地结束

```
struct hello
{
    int a;
}; 
```

`static char p[]`另外，和 和有什么区别`char p[];`？

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2009-03-27T05:48:10.647

我的 C 有点生疏： requester 是一个常量指针，指向一个返回指向 ast_channel 结构的指针的函数。

请参阅这些文章：

*   [解释更复杂的声明符](http://msdn.microsoft.com/en-us/library/1x82y1z4(VS.80).aspx)

*   [如何解释复杂的 C/C++ 声明](http://www.codeproject.com/KB/cpp/complex_declarations.aspx)

static 关键字的含义取决于声明在代码中出现的位置。在函数内部，它指示变量不应放在堆栈中，而应放在数据段中，并且在函数超出范围（即未运行）时保持不变。在函数之外，它表明该变量在它所在的文件之外是不可访问的。

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2009-03-27T05:50:15.867

教鱼（而不是给鱼）：

[阅读 C 类型声明](http://eli.thegreenplace.net/2008/07/18/reading-c-type-declarations/)

[C程序中的static是什么意思](https://stackoverflow.com/questions/572547/what-does-static-mean-in-a-c-program)

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2009-03-27T06:57:38.980

第一个是指向函数的常量指针的声明（以及定义），该函数返回指向`struct ast_channel`并接受最后一对括号中列出的参数。这个函数指针被命名为`requester`。

的含义`static`实际上取决于上下文。但是，它已在之前的答案中进行了解释。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2009-03-27T06:08:08.243

第一行是一个函数指针，类型为 ast_channel。需要提供更多代码以充分解释其用途。那是在结构内部定义的吗？如果是这样，它将通过 structname->requester( ... args ... ) 输入。

[本教程](http://www.newty.de/fpt/index.html)可能会帮助您理解这一点。其他人已经提供了链接以找出“静态”的含义。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2011-08-11T16:19:50.253

[**`cdecl.org`**](http://cdecl.ridiculousfish.com/?q=struct%20ast_channel%20%2a%28%2a%20const%20requester%29%28const%20char%20%2a,%20int%20,%20void%20%2a,%20int%20%2a%29)你的朋友在这里吗：

> `struct ast_channel *(* const requester)(const char *, int , void *, int *)`- 将请求者声明为指向函数的 const 指针（指向 const char、int、指向 void、指向 int 的指针）返回指向 struct ast_channel 的指针

# c# - C#：如何将 long 转换为 ulong

> ID：688667
> 
> 赞同：11
> 
> 时间：2009-03-27T05:36:54.480
> 
> 标签：c#, long-integer, ulong

如果我尝试使用 BitConverter，它需要一个字节数组，而我没有。我有一个 Int32，我想将它转换为 UInt32。

在 C++ 中，这没有问题。

* * *

## 回答 #1

> 赞同：23
> 
> 时间：2009-03-27T05:40:37.123

您只需要一个简单的演员表。由于这样做可能会丢失精度，因此转换是显式的。

```
long x = 10;
ulong y = (ulong)x; 
```

* * *

## 回答 #2

> 赞同：7
> 
> 时间：2009-03-27T05:41:48.227

尝试：

```
Convert.ToUInt32() 
```

* * *

## 回答 #3

> 赞同：5
> 
> 时间：2014-12-24T13:21:15.673

鉴于此功能：

```
string test(long vLong)
{
    ulong vULong = (ulong)vLong;
    return string.Format("long hex: {0:X}, ulong hex: {1:X}", vLong, vULong);
} 
```

而这种用法：

```
 string t1 = test(Int64.MinValue);
    string t2 = test(Int64.MinValue + 1L);
    string t3 = test(-1L);
    string t4 = test(-2L); 
```

这将是结果：

```
 t1 == "long hex: 8000000000000000, ulong hex: 8000000000000000"
    t2 == "long hex: 8000000000000001, ulong hex: 8000000000000001"
    t3 == "long hex: FFFFFFFFFFFFFFFF, ulong hex: FFFFFFFFFFFFFFFF"
    t4 == "long hex: FFFFFFFFFFFFFFFE, ulong hex: FFFFFFFFFFFFFFFE" 
```

如您所见，即使对于负值，这些位也被完全保留。

* * *

## 回答 #4

> 赞同：2
> 
> 时间：2009-03-27T05:41:15.357

要将 long 转换为 ulong，只需将其转换：

```
long a;
ulong b = (ulong)a; 
```

如果它是负数，C# 不会抛出异常。

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2009-03-27T05:42:55.680

```
Int32 i = 17;
UInt32 j = (UInt32)i; 
```

编辑：问题不清楚您是长整数还是整数？

# asp.net - JavaScript 中的 ActiveXobject 错误

> ID：688686
> 
> 赞同：0
> 
> 时间：2009-03-27T05:49:49.423
> 
> 标签：asp.net, javascript

我在 Default.aspx 页面中使用 ths 脚本。

```
<script id="clientEventHandlersJS" type="text/javascript">

        function Button1_onclick() {
            var locator = new ActiveXObject ("WbemScripting.SWbemLocator");
            var service = locator.ConnectServer(".");
            var properties = service.ExecQuery("SELECT * FROM Win32_NetworkAdapterConfiguration");
            var e = new Enumerator (properties);
            document.write("<table border=1>");
            dispHeading();
            for (;!e.atEnd();e.moveNext ())
            {
                var p = e.item ();
                document.write("<tr>");
                document.write("<td>" + p.Caption + "</td>");
                document.write("<td>" + p.IPFilterSecurityEnabled + "</td>");
                document.write("<td>" + p.IPPortSecurityEnabled + "</td>");
                document.write("<td>" + p.IPXAddress + "</td>");
                document.write("<td>" + p.IPXEnabled + "</td>");
                document.write("<td>" + p.IPXNetworkNumber + "</td>");
                document.write("<td>" + p.MACAddress + "</td>");
                document.write("<td>" + p.WINSPrimaryServer + "</td>");
                document.write("<td>" + p.WINSSecondaryServer + "</td>");
                document.write("</tr>");
            }
            document.write("</table>");
        }
        function dispHeading()
        {
            document.write("<thead>");
            document.write("<td>Caption</td>");
            document.write("<td>IPFilterSecurityEnabled</td>");
            document.write("<td>IPPortSecurityEnabled</td>");
            document.write("<td>IPXAddress</td>");
            document.write("<td>IPXEnabled</td>");
            document.write("<td>IPXNetworkNumber</td>");
            document.write("<td>MACAddress</td>");
            document.write("<td>WINSPrimaryServer</td>");
            document.write("<td>WINSSecondaryServer</td>");
            document.write("</thead>");
        }
    </script> 
```

在上面的代码中，我试图获取客户端的 MAC 地址。但我在第一行出现错误 `var locator = new ActiveXObject ("WbemScripting.SWbemLocator");'

无法创建该 activeX 对象，请帮助我。

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2009-03-27T11:49:59.060

WbemScripting 对象没有被标记为“安全的脚本”，这是正确的！如果是这样，任何网页都可以找出您正在运行的进程，终止它们，甚至启动新的应用程序！谈论安全漏洞...

WbemScripting 对象用于[Windows 脚本](http://www.pctools.com/guides/article/id/2/)，*而不是*用于网页。

如果您有权访问客户端计算机，请尝试使用 WScript.exe 或 CScript.exe 从 .js 文件运行您的代码。如果客户端机器在您的网络中并且您知道它的名称，您也可以尝试远程运行脚本；只需替换“。” 在行期间

```
locator.ConnectServer("."); 
```

以机器的名称。因此，如果远程机器的名称是 MACHINE，则应将行更改为

```
locator.ConnectServer("MACHINE"); 
```

同样，这需要您使用 WScript 或 CScript 从 .js 文件运行脚本。

最后，您可以尝试降低客户端计算机上 Internet Explorer 的安全设置。但只有在你从不使用那台机器上网时才这样做，因为它会打开你的浏览器、你的整个 PC 和所有连接到它的网络，以各种令人讨厌的东西......

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-03-27T09:24:49.643

检查以确保您尝试创建的 COM 对象已安装，并标记为安全的脚本。确认您在 IE 中的安全设置。除此之外，ActiveXObject 只能通过 IE 使用，不能通过其他浏览器使用。很可能它不是“脚本安全”，或者您的安全域的安全设置禁止它。

# asp.net - 如何在 ASP.NET Web 部署项目中强制创建没有内容的文件夹

> ID：688691
> 
> 赞同：0
> 
> 时间：2009-03-27T05:54:24.670
> 
> 标签：asp.net, web-deployment-project

我在一个项目中遇到问题，其中我的 App_Resources 文件夹具有以下结构：

*   App_Resources
    *   温度
    *   图片

问题是，虽然 Images 文件夹有内容文件，但 CTemp 没有。结果是在安装期间未创建该文件夹，之后由于应用程序的许多不同部分尝试在该文件夹中创建文件而发生错误。

我需要一种方法让 ASP.NET 网站部署项目在安装时强制创建空的 CTemp 文件夹，以便可以立即将文件写入其中。

我知道一个简单的破解方法是在该文件夹中创建一个虚拟内容文件（类似于良性 readme.txt），或者我可以在第一次尝试访问它时以编程方式创建该文件。但我正在寻找一种更优雅地解决问题的解决方案。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-03-27T06:46:16.387

Scott Guthrie 有[一篇关于 Web 部署项目](http://weblogs.asp.net/scottgu/archive/2005/11/06/429723.aspx)的详尽文章，详细说明了如何在构建前和构建后阶段创建文件夹

# objective-c - 为什么使用点语法会调用该语句的 LHS 两次？

> ID：688697
> 
> 赞同：3
> 
> 时间：2009-03-27T06:01:19.023
> 
> 标签：objective-c

此测试将失败：

```
#import "GTMSenTestCase.h"

@interface Person : NSObject
@property (readonly) NSString *name;
@end
@implementation Person
- (NSString *)name { return @"Nick"; }
@end

@interface TemplateUnitTest : GTMTestCase @end

@implementation TemplateUnitTest

static BOOL called = NO;
- (Person *)get {
  if (called) { STFail(nil); }
  called = YES;
  return [[Person new] autorelease];
}

- (void)testPropertyMakesThingGetSentTwice {
  NSString *s = [[self get].name stringByAppendingString:@"foo"];
  STAssertEqualObjects(@"Nickfoo", s, nil);
}

@end 
```

如果我用 替换`[self get].name`，`[[self get] name]`它就会通过。即，使用点语法，'.' 的 LHS 被评估两次。这是怎么发生的？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-03-27T06:36:45.583

公开承认你在 Objective-C 中使用点语法可能会让你被纯粹主义者烧死;-)

看起来这是这个特定场景中的一个[错误](http://discussions.apple.com/thread.jspa?threadID=1709348)，正如线程所说，它可能是一些预处理魔法错误地扩展了它。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2009-03-27T18:24:50.390

这是一个编译器错误，应该在 gcc-4.2 中修复。

# windows - 如何通过已知 IP 断开 Windows 共享目录？

> ID：688702
> 
> 赞同：1
> 
> 时间：2009-03-27T06:04:14.570
> 
> 标签：windows, networking

Windows 仅将 1 个用户/密码记录到远程共享目录，

我的程序需要连接一个目录，

但是用户可能先登录，让我的程序无法连接，

有没有办法断开它？我只知道IP。

我先使用 wnetcancelconnection2(remotedir)，但仍然无法工作，

并返回 1219 错误（提供的凭据与现有凭据集冲突）

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-03-27T06:10:17.270

```
net use \\\10.0.0.1\sharename /user:domain\user 
```

断开连接

```
net use \\\\10.0.0.1\sharename /delete 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-03-27T14:28:03.173

从共享中断开一台计算机/IP。使用 net session \IPADDRESS OR NAME /Delete 或 Net Session /delete 断开所有客户端连接。您必须从拥有正在连接的共享的服务器运行此命令。

当然，我不太确定我是否正确阅读了您的问题。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2009-06-08T14:44:53.363

您是否尝试过 NetUseDel 功能？

[NetUseDel 函数](http://msdn.microsoft.com/en-us/library/aa370646%28VS.85%29.aspx)

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2015-01-08T20:09:15.577

您的 CMD 窗口需要以管理员权限运行。在这里找到更详细的解释：

[http://the-chronicon.blogspot.com/2015/01/disconnect-mapped-network-shares-via-cmd.html](http://the-chronicon.blogspot.com/2015/01/disconnect-mapped-network-shares-via-cmd.html)

# logging - 更改 Log4j 的 log.properties 是否需要重新启动？

> ID：688703
> 
> 赞同：12
> 
> 时间：2009-03-27T06:04:58.827
> 
> 标签：logging, log4j, oc4j

更改 Log4j 的 log.properties 是否需要重新启动才能使更改生效？

我正在尝试在我们的一个系统中解决问题，但无法重新启动服务器进程（在本例中为 OC4J）。

* * *

## 回答 #1

> 赞同：14
> 
> 时间：2009-03-27T06:15:17.773

是的，因为配置是在 log4j 启​​动时加载的，而 log4j 是在类加载器启动时加载的。

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2009-03-27T07:02:02.170

> [PropertyConfigurator.configureAndWatch(java.lang.String configFilename, 长时间延迟)](http://logging.apache.org/log4j/1.2/apidocs/org/apache/log4j/PropertyConfigurator.html#configureAndWatch(java.lang.String,%20long))
> 
> [DOMConfigurator.configureAndWatch(java.lang.String configFilename, 长时间延迟)](http://logging.apache.org/log4j/1.2/apidocs/org/apache/log4j/xml/DOMConfigurator.html#configureAndWatch(java.lang.String,%20long))

我们可以使用适当的延迟（以毫秒为单位）来观察配置文件的更改并重新加载 log4j 属性（或 xml），而无需重新启动服务器。

不过，我不确定 OC4J 的行为如何。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2014-01-24T15:25:33.327

从不同的角度来看，我最近为一个不同的问题编写了一个非常基本的 MBean，它允许使用一些简单的命令来上下更改记录器级别。

在我的情况下，我在使用 WLST 的 Oracle WebLogic 上，但它只是一个 MBean，应该可以从许多工具中访问。

# mysql - 我如何在 MySQL 5.0 中进行备份和恢复

> ID：688713
> 
> 赞同：-1
> 
> 时间：2009-03-27T06:14:01.893
> 
> 标签：mysql, vb.net

我使用 MySQL 5.0 作为后端，使用 VB.NET 作为前端（Windows 应用程序）。我想收回我的数据库。我通过网络找到了一个命令，如下所示。

mysql> mysqldump -u root -p root 帐户>accounts.sql

我的数据库名称是“帐户”。当我尝试在 mysql> 提示符下运行上述命令时，它会出错。我必须在哪里运行上述命令？需要帮助。提前谢谢。

西瓦库玛

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-03-27T06:40:18.070

您必须在命令行中使用 mysql dump：

mysqldump --user=user --password=password 数据库 > database.sql

恢复：

mysql --user=user --password=password 数据库<database.sql

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-03-27T06:16:38.847

我从来没有在 mysql 命令行中使用过[mysqldump 。](http://dev.mysql.com/doc/refman/5.1/en/mysqldump.html)尝试直接在 shell/命令行上使用。希望能帮助到你

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2009-03-27T06:20:07.480

如果使用短选项形式 (-p)，则选项和密码之间不能有空格。如果您在命令行中省略了 --password 或 -p 选项后面的密码值，系统会提示您输入密码值。

你遇到了什么错误？这是 mysqldump 的完整[手册](http://dev.mysql.com/doc/refman/5.1/en/mysqldump.html)。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2009-03-27T06:55:45.663

这在 Windows 中有效吗？我只在Linux中使用过这个，不知道Windows ...

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2009-03-27T08:44:03.437

正如其他人所说，使用mysqldump。记住不要在生产服务器上转储整个数据库，因为它会在转储期间锁定所有行。

**binar_E:** mysqldump 对于 windows 和 *nix 都存在。

# iphone - NSArray initWithObjects：未加载

> ID：688715
> 
> 赞同：5
> 
> 时间：2009-03-27T06:16:07.847
> 
> 标签：iphone, objective-c

作为测试，我在 applicationDidFinishLaunching 的第一行执行以下操作：

```
NSArray *list=[[NSArray alloc] initWithObjects:@"Andy",@"Erik",@"Aaron",nil]; 
```

线路运行后，数组中有零个对象。我正在代码路径的下方进一步执行此操作，但希望消除任何影响以确保我的语法正确。我用 NSMutableArray 得到了相同的结果。在调试器中，我将鼠标悬停在数组名称上以查看它是否有任何值。

当我将鼠标悬停在以下行中的 count 上时，我看到“variable optimization awa ... Summary”：

```
int count = [list count]; 
```

为什么数组不填充以及为什么 count 不返回整数的任何建议？

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2009-03-27T06:28:10.113

发生的事情是您没有使用“count”变量，编译器正在优化它。

1）尝试在调试而不是发布模式下运行。调试模式不会优化内容，因此您应该看到 count 变量在调试器中使用鼠标悬停给出正确的结果。您可以通过单击 xcode 左上角的下拉栏将活动配置更改为从发布调试。

2) 在您的代码中使用“计数”变量。请注意，如果这是编译器想要做的，那么在发布构建中可能会出现乱序。例如，如果您在某处有您的计数初始化语句，并且您在代码中进一步使用“计数”，则“计数”可能不会在实际使用“计数”之前设置。

# ruby-on-rails - 获取命名范围内元素的 id

> ID：688717
> 
> 赞同：1
> 
> 时间：2009-03-27T06:16:46.117
> 
> 标签：ruby-on-rails, ruby, activerecord, named-scope

在 ruby​​ on rails 中，所有`has_many :widgets`方法都生成一个`object.widgets`方法和一个`object.widget_ids`方法。

后一种方法非常有用，因为它绕过了 ActiveRecord 对象的创建并运行更快的查询。使用该选项可以提高查询速度`:select`，但是 ruby​​ 在生成对象而不是整数时仍然分配更多的内存。

例如

```
User has_many :historical_sessions:

>> Benchmark.measure { User.find(4).historical_sessions.map(&:id) }
HistoricalSession Load (131.0ms)   SELECT * FROM `historical_sessions` WHERE (`historical_sessions`.user_id = 4)
=> #<Benchmark::Tms:0xbe805c0 @cutime=0.0, @label="", @total=1.996, @stime=0.0150000000000006, @real=2.09599995613098, @utime=1.981, @cstime=0.0>
(2.1 seconds)

>> Benchmark.measure { User.find(4).historical_session_ids }
HistoricalSession Load (34.0ms)   SELECT `historical_sessions`.id FROM `historical_sessions` WHERE (`historical_sessions`.user_id = 4)
=> #<Benchmark::Tms:0x11e6cd94 @cutime=0.0, @label="", @total=1.529, @stime=0.032, @real=1.55099987983704, @utime=1.497, @cstime=0.0>
(1.6 seconds) 
```

（结果集为 67353 个对象）

有没有办法在使用 named_scopes 时发生相同的行为？

例如，

```
User named_scope :recent
User.recent (Exists)
User.recent_ids (Does not exist) 
```

我目前在命名范围结果集中获取对象 ID 的方式是：HistoricalSession.recent.map(&:id)。这与上面后一个示例中所做的基本相似，并且显然效率不高。我不想构建整个 HistoricalSession 对象，最终我只需要一个 id 数组。

另一种实现可能是新的 .find 方法。例如，HistoricalSession.recent.find_attributes(:id)。此方法将替换 select 语句以仅选择指定的值，并将缩短 ActiveRecord 对象的创建以仅返回一个数组。

有什么建议么？这可能是一个简单的插件吗？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-03-27T10:38:40.650

您可以在关联代理上创建一个名为“ids”的方法，而不是创建其他方法，以便您可以执行以下操作：

```
User.named_scope :recent, ...
User.named_scope :admin, ...
User.recent.admin.ids 
```

是的，这对我来说听起来像是一个明智的插件。应该不会太难写。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2014-05-17T00:56:12.253

由于我最初提出这个问题，Rails 在 Calculations 模块中添加了 .ids 和 .pluck 方法。这些本来可以解决我当时的问题。

采摘：[https ://www.omniref.com/ruby/gems/activerecord/4.1.0/classes/ActiveRecord::Calculations##pluck](https://www.omniref.com/ruby/gems/activerecord/4.1.0/classes/ActiveRecord%3a%3aCalculations##pluck)

ID：[https ://www.omniref.com/ruby/gems/activerecord/4.1.0/classes/ActiveRecord::Calculations##ids](https://www.omniref.com/ruby/gems/activerecord/4.1.0/classes/ActiveRecord%3a%3aCalculations##ids)

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2011-06-29T16:48:10.093

只是在这里采取不同的观点-您为什么要为此烦恼？你用了多少内存？看起来您正在尝试优化某些东西-但如果只有几行（即少于几百行）-我不明白您为什么要为此烦恼。

你有问题，还是你想象中的问题？

不要忘记：[http ://en.wikipedia.org/wiki/Program_optimization#When_to_optimize](http://en.wikipedia.org/wiki/Program_optimization#When_to_optimize)

:-D

# php - 将 ISO 日期转换为 Unix 时间戳的最有效方法？

> ID：688720
> 
> 赞同：2
> 
> 时间：2009-03-27T06:19:59.307
> 
> 标签：php, optimization, datetime

在我的应用程序中，我有一些记录需要根据一些时间参数进行过滤。要进行日期比较，我需要将记录中的日期（格式为 YYYY-MM-DD 的字符串）转换为 unix 时间戳（自 1970 年以来的秒数）。由于我有成千上万条记录，我真的很想找到最有效的方法。

[另一个问题](https://stackoverflow.com/questions/455554/datetime-to-unix-timestamp)的答案建议在数据库中执行此操作（可悲的是，这里不是一个选项），使用`strtotime()`or `strptime()`，但这些*感觉*不是最节省内存和时间的方法，你知道吗？

鉴于我知道输入的确切格式，也许使用某种形式的字符串操作（`substr`或`explode`）结合起来`mktime`会更好？

*如果您认为我的优化还为时过早，那么请幽默一下好吗？*

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2009-03-27T06:39:41.317

为什么你认为 strtotime() 不是一个有效的函数？你有没有做过任何基准测试。请记住，strtotime() 是一个内置库函数，它将直接用 C 语言编写，而您提出的任何内容都将通过 php 解释器运行。

还要记住，日期计算本质上是棘手的，对于闰年和时区等问题。

至于另一种更快的方法，我认为使用 substr() 解析会比正则表达式更快。将结果输入 mktime() 即可。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2009-03-27T13:56:20.003

`strtotime`方式（我的意思是 WAAAY）比你能想到的任何事情都要快。

这些日期在您的记录中重复出现的可能性有多大？如果它们不是完全唯一的，您可以进行某种缓存。假设你在一个班级：

```
protected $_timestamps = array();

public function toTimestamp($date)
{
    if (!array_key_exists($date, $this->_timestamps)) {
        $this->_timestamps[$date] = strtotime($date);
    }
    return $this->_timestamps[$date];
} 
```

现在你只需要做：

```
foreach ($records as $record) {
    $timestamp = $this->toTimestamp($record->date);
} 
```

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2009-03-31T06:08:16.553

好的，我已经对 4 种不同的方法进行了基准测试：

```
function _strtotime($date) {
    return strtotime($date);
}

function _preg($date) {
    preg_match("@^(\\d+)-(\\d\\d)-(\\d\\d)$@", $date, $matches);
    return mktime(0, 0, 0, $matches[2], $matches[3], $matches[1]);
}

function _explode($date) {
    list($y,$m,$d) = explode("-", $date);
    return mktime(0, 0, 0, $m, $d, $y);
}

function _substr($date) {
    $y = substr($date, 0, 4);
    $m = substr($date, 5, 2);
    $d = substr($date, 8);
    return mktime(0, 0, 0, $m, $d, $y);
}

// I also added this one as sort of a "control"
function _hardCoded() {
    return mktime(0, 0, 0, 3, 31, 2009);
} 
```

这是每个函数运行 100,000 次的结果。输入“2009-03-31”

```
_hardCoded: 2.02547
_strtotime: 2.35341
_preg:      2.70448
_explode:   2.31173
_substr:    2.27883 
```

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2009-03-27T06:39:35.297

在我看来，如果你真的想要最有效的方法，你必须按照你建议的所有方法，加上你找到的任何其他方法，做一些基准测试，然后选择赢家。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2009-03-27T06:39:10.820

由于字符串很好地构建，我将构建从左到右遍历字符串的时间戳。您可以预先构建一个包含年 -> 秒、月 -> 秒、日 -> 秒的表格，并针对闰年进行更正。乘法是邪恶的:)

或者用更少的努力，构建一个哈希表来消除重复。

但是你需要很多记录才能更快。听起来您正在使用数据库。这与快速不兼容...

# asp.net-mvc - Html.ActionLink() 是否发布表单数据？

> ID：688722
> 
> 赞同：5
> 
> 时间：2009-03-27T06:20:17.353
> 
> 标签：asp.net-mvc

您好，希望表单数据在同一控制器的另一个操作中可用。

是否可以 ？还是有其他方法？

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2009-03-27T06:43:25.193

ActionLink 是一个锚标记，因此除非您使用一些 javascript 技巧，否则它不会发布。

就像 clasic asp.net 中的 LinkBut​​ton 控件的工作方式一样。

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2009-03-27T06:51:25.890

回答您的主题中的问题：不。

要回答如何根据单击的按钮将表单发布到不同的操作：您可以根据单击的链接/按钮使用 javascript 更改表单的操作属性。

但也许您的意思是您只想将表单发布到与用于呈现表单的操作不同的操作，然后只需使用操作 attr 的 url 帮助器输出您自己的表单标记。

或者，非 javascript 解决方案是始终使用不同的按钮将表单发布到相同的操作，然后根据按钮的名称决定要做什么（以单击的按钮命名的参数将在您的操作方法中具有值)

# code-signing - 运行时 CRC 检查

> ID：688725
> 
> 赞同：1
> 
> 时间：2009-03-27T06:21:21.750
> 
> 标签：code-signing, crc

问：我在机器上运行了一个十六进制代码。如何在运行时计算整个代码的校验和？

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2009-03-27T06:37:19.217

您需要对整个代码段具有读取权限。这可能涉及从链接器获取引用代码的第一个和最后一个地址的符号。您可以将这些地址转换为适当大小的数据指针，并在代码段上运行您想要的任何常见 CRC 或校验和算法。

要验证CRC，您需要知道它的权威值。这可以在链接之后通过计算 CRC 并将其修补到初始化程序中以获得合适的变量来完成。

在嵌入式系统中，我在现场升级更换固件之前使用了类似的技术作为完整性检查，我通常将固件映像的内存映射安排为以只读数据结构开始。编写一个实用程序来计算图像的 CRC 并修复结构很容易。然后嵌入式系统的引导加载程序可以在引导期间验证 CRC 以确定是否存在有效固件，如果不存在则回退到更新实用程序。当然，更新实用程序在刷新之前使用相同的 CRC 来验证新映像。

**编辑：**关于 CRC 的一些参考资料，以防有帮助：

*   [CRC错误检测算法的无痛指南](http://www.geocities.com/SiliconValley/Pines/8659/crc.htm)，由[this question推荐](https://stackoverflow.com/questions/149617/how-could-i-guess-a-checksum-algorithm)
*   [CRC上的维基百科](http://en.wikipedia.org/wiki/Cyclic_redundancy_check)

# php - 如何确保重构后代码仍然有效（动态语言）

> ID：688740
> 
> 赞同：7
> 
> 时间：2009-03-27T06:36:30.513
> 
> 标签：php, python, dynamic-languages

如何确保代码在重构后（即变量名更改后）仍然有效？

在静态语言中，如果一个类被重命名但其他引用类没有，那么我会得到一个编译错误。

但是在动态语言中没有这样的安全网，**如果你不够小心**，你的代码可能会在重构过程中中断。您可以使用单元测试，但是当您使用模拟时，很难知道名称的变化，因此可能无济于事。

如何解决这个问题呢？

* * *

## 回答 #1

> 赞同：17
> 
> 时间：2009-03-27T06:46:53.687

在开始重构之前，您应该创建能够测试您将要更改的内容的测试——如果您说单元测试不够，或者它们很难创建，那么无论如何都要创建更高级别的测试，甚至可能锻炼整个产品。

如果您有针对您的语言的代码覆盖工具，请使用它们来衡量您创建的测试的质量——在达到相当高的值之后，如果测试保持最新并扩展，您将能够做任何事情非常有效地使用您的代码，并确保事情没有朝着错误的方向发展。

* * *

## 回答 #2

> 赞同：10
> 
> 时间：2009-03-27T06:55:07.427

我一直在教一门关于单元测试、重构等的课程，这可能是大多数人犯错的地方。重构*不仅仅是*改变代码。它正在更改代码而不更改外部功能行为。这是非常重要的一点。

换句话说，您需要有某种方法来验证重构后外部功能行为是否完好无损。由于缺乏神圣的洞察力，我发现单元测试对此非常有用。在他关于重构的书中，Martin Fowler 强调了使用自动化测试来进行验证。

如果您的代码是使用 TDD 开发的，那么您将拥有必要的测试套件，因为它是在代码本身开发期间开发的。如果您需要重构没有可用测试的代码，最好的方法是在对代码进行任何更改之前设置自动化测试。我意识到为现有代码设置测试可能很困难，但是在这样做的过程中你会学到很多关于代码的知识。

您可能还想查看[Bruce Eckel 关于强类型与强测试的文章，](http://www.mindview.net/WebLog/log-0025)因为它讨论了您从编译器获得的反馈与您从测试套件获得的反馈。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2009-03-27T06:54:25.073

即使使用编译语言，您的代码也可能在重构期间中断。仅仅依靠这一点会让你陷入困境。自动化测试是确保程序正常运行的最佳方式。

如果您说您使用的是哪种动态语言，我们可能会提供一些有关可以帮助您进行测试的工具的建议。一切都可以测试。

**编辑：**

你回应说你使用 PHP 和 Python。

如果这是一个 Web 应用程序，请使用[selenium](http://seleniumhq.org/)在浏览器中创建测试。一开始你只需要 Selenium IDE。将所有测试放在一个测试套件中，以便您可以轻松地执行所有测试。随着列表的增长，您可以开始研究 Selenium RC 和 Selenium Grid。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2009-11-28T18:02:38.413

1) 对于 Python，将 PyUnit 用于 PHP phpunit。2) TDD 方法很好，但在编写代码后进行测试也是可以接受的。3) 还使用可用于您的 IDE 的重构工具，它们只执行安全重构。在 Python 中你有绳子（这是库，但有大多数 IDE 的插件）。4) 好书是：'Test-Driven Development by example' Best 'Expert Python Programming' Tarek Ziade（解释 TDD 和重构）

google tdd and database 找到一本关于开发数据库的 TDD 方法的好书。

添加您正在使用的模拟的信息。只有在涉及数据库或网络时才需要 AFAIK 模拟。但通常单元测试应该覆盖一小段代码（只有一个类），有时是两个类，所以不需要模型！

# xml - XSD 属性组可选？

> ID：688753
> 
> 赞同：3
> 
> 时间：2009-03-27T06:43:44.193
> 
> 标签：xml, xsd

我在我的 XSD 架构中定义了一个属性组。从我阅读和尝试的内容来看，我无法指定整个组的使用的可选性（以便指定所有属性或不指定），例如：

```
 <xs:attributeGroup name="NameDesc">
    <xs:attribute name="n" type="xs:string" use="required"/>
    <xs:attribute name="d" type="xs:string" use="required"/>
    <xs:attribute name="uinf" type="xs:string" use="required"/>
  </xs:attributeGroup>

  <xs:complexType name="g">
    <xs:attributeGroup ref="tns:NameDesc" use="optional" />
  </xs:complexType> 
```

（注意我在 attributeGroup 引用中添加的**use="required"**，这是不允许的）。我是对的还是有办法做到这一点？

我已阅读[如何使“使用”属性（必需/可选）依赖于另一个值？](https://stackoverflow.com/questions/511148/xsd-how-to-depend-the-use-attribute-required-optional-with-the-other-value)，但我不确定这是否适用于我的情况。

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2009-03-27T07:09:46.050

据我所知（如果我错了，请有人纠正我），不可能像这样使属性依赖。

您可以考虑将 attributeGroup 设为实际元素吗？这样，整个元素可以作为子元素存在或不存在。

如果您将架构映射到对象，这也是一个更好的设计。

* * *

## 回答 #2

> 赞同：-1
> 
> 时间：2013-09-17T14:54:40.343

还有另一种不使用attributeGroup 的方法。你可以使用类似的东西：

```
 <xs:complexType name="g">
 <xs:sequence>
  <xs:attribute name="type"/>
  <xs:sequence minOccurs="0" maxOccurs="1">
     <xs:attribute name="n" type="xs:string" use="required"/>
     <xs:attribute name="d" type="xs:string" use="required"/>
     <xs:attribute name="uinf" type="xs:string" use="required"/>
  </xs:sequence>
 </xs:sequence>
</xs:complexType> 
```

其中**minOccurs="0" maxOccurs="1"**使 3 个元素的属性组是可选的，如果使用一个元素，则都是必需的。

参考：[W3 维基](http://www.w3.org/wiki/Simple_attribute_implication#Grammaticalization)

# symfony1 - 可以删除 Symfony 中的缓存文件夹而没有副作用吗？

> ID：688754
> 
> 赞同：2
> 
> 时间：2009-03-27T06:45:11.617
> 
> 标签：symfony1

据我所知，Symfony 项目中的缓存文件夹（位于应用程序、配置、数据库和其他文件夹中）只是存储文件夹。我可以选择不将其签入我的源代码管理吗？我的行为是否会对我的入住完整性产生不利影响？

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2009-03-27T06:52:44.220

您可以删除缓存目录的内容，但不能删除目录本身。缓存文件夹必须具有特殊权限，以便用户和网络服务器都可以写入。因此，您应该让源代码管理忽略缓存文件夹中的所有内容，而不是缓存文件夹本身。

# c++ - 如何在 Visual C++ 2008 中创建 UTF-8 字符串文字

> ID：688760
> 
> 赞同：67
> 
> 时间：2009-03-27T06:48:29.720
> 
> 标签：c++, visual-c++, utf-8

在 VC++ 2003 中，我可以将源文件保存为 UTF-8，并且所有字符串都按原样使用。换句话说，以下代码会将字符串按原样打印到控制台。如果源文件保存为 UTF-8，则输出将为 UTF-8。

```
printf("Chinese (Traditional)");
printf("中国語 (繁体)");
printf("중국어 (번체)");
printf("Chinês (Tradicional)"); 
```

我已使用 UTF-8 BOM 将文件保存为 UTF-8 格式。但是使用 VC2008 编译会导致：

```
warning C4566: character represented by universal-character-name '\uC911' 
cannot be represented in the current code page (932)
warning C4566: character represented by universal-character-name '\uAD6D' 
cannot be represented in the current code page (932)
etc. 
```

导致这些警告的字符已损坏。适合区域设置的那些（在本例中为 932 = 日语）被转换为区域设置编码，即 Shift-JIS。

我找不到让 VC++ 2008 为我编译它的方法。请注意，我在源文件中使用什么语言环境并不重要。似乎没有一个语言环境说“我知道我在做什么，所以不要 f$%##ng 更改我的字符串文字”。特别是，无用的 UTF-8 伪语言环境不起作用。

```
#pragma setlocale(".65001") 
=> error C2175: '.65001' : invalid locale 
```

“C”也没有：

```
#pragma setlocale("C") 
=> see warnings above (in particular locale is still 932) 
```

看来 VC2008 强制所有字符进入指定（或默认）的语言环境，并且该语言环境不能是 UTF-8。我不想更改文件以使用像“\xbf\x11...”这样的转义字符串，因为相同的源代码是使用 gcc 编译的，它可以非常愉快地处理 UTF-8 文件。

有没有办法指定源文件的编译应该保持字符串文字不变？

换一种说法，在编译源文件时，我可以使用哪些编译标志来指定与 VC2003 的向后兼容性。即不要更改字符串文字，按原样逐字节使用它们。

**更新**

感谢您的建议，但我想避免使用 wchar。由于此应用程序专门处理 UTF-8 中的字符串，因此使用 wchar 将要求我将所有字符串转换回 UTF-8，这应该是不必要的。所有输入、输出和内部处理均采用 UTF-8。这是一个简单的应用程序，在 Linux 上和使用 VC2003 编译时都可以正常工作。我希望能够用 VC2008 编译相同的应用程序并让它工作。

为此，我需要 VC2008 不尝试将其转换为我本地机器的语言环境（日语，932）。我希望 VC2008 向后兼容 VC2003。我想要一个语言环境或编译器设置，说明字符串按原样使用，本质上是不透明的 char 数组或 UTF-8。看起来我可能会被 VC2003 和 gcc 困住，但在这种情况下，VC2008 正试图变得太聪明。

* * *

## 回答 #1

> 赞同：32
> 
> 时间：2009-03-30T04:52:22.063

更新：

我已经决定没有保证的方法可以做到这一点。我在下面介绍的解决方案适用于英文版 VC2003，但在使用日文版 VC2003（或者它可能是日文操作系统）编译时失败。无论如何，不​​能依赖它来工作。请注意，即使将所有内容都声明为 L"" 字符串也不起作用（并且在 gcc 中很痛苦，如下所述）。

相反，我相信您只需要硬着头皮将所有文本移动到数据文件中并从那里加载即可。我现在通过[SimpleIni](http://code.jellycan.com/simpleini/)（跨平台 INI 文件库）存储和访问 INI 文件中的文本。至少可以保证它可以工作，因为所有文本都在程序之外。

原来的：

我自己回答这个问题，因为只有埃文似乎理解这个问题。关于 Unicode 是什么以及如何使用 wchar_t 的答案与这个问题无关，因为这与国际化无关，也不是对 Unicode 字符编码的误解。不过，我感谢您提供帮助的尝试，如果我不够清楚，请道歉。

问题是我有需要在各种平台和编译器下交叉编译的源文件。该程序执行 UTF-8 处理。它不关心任何其他编码。我想在 UTF-8 中使用字符串文字，就像目前使用 gcc 和 vc2003 一样。VC2008如何做到这一点？（即向后兼容的解决方案）。

这是我发现的：

gcc (v4.3.2 20081105):

*   字符串文字按原样使用（原始字符串）
*   支持 UTF-8 编码的源文件
*   源文件不能有 UTF-8 BOM

vc2003：

*   字符串文字按原样使用（原始字符串）
*   支持 UTF-8 编码的源文件
*   源文件可能有也可能没有 UTF-8 BOM（没关系）

vc2005+：

*   字符串文字由编译器处理（没有原始字符串）
*   char 字符串文字被重新编码为指定的语言环境
*   不支持将 UTF-8 作为目标语言环境
*   源文件必须具有 UTF-8 BOM

所以，简单的答案是，为了这个特定的目的，VC2005+ 被破坏并且不提供向后兼容的编译路径。将 Unicode 字符串导入编译程序的唯一方法是通过 UTF-8 + BOM + wchar，这意味着我需要在使用时将所有字符串转换回 UTF-8。

没有任何简单的跨平台方法可以将 wchar 转换为 UTF-8，例如，wchar 的大小和编码是什么？在 Windows 上，UTF-16。在其他平台上？它因人而异。有关详细信息，请参阅[ICU 项目](http://icu-project.org/docs/papers/unicode_wchar_t.html)。

最后，我决定避免在 vc2005+ 以外的所有编译器上使用如下源代码的转换成本。

```
#if defined(_MSC_VER) && _MSC_VER > 1310
// Visual C++ 2005 and later require the source files in UTF-8, and all strings 
// to be encoded as wchar_t otherwise the strings will be converted into the 
// local multibyte encoding and cause errors. To use a wchar_t as UTF-8, these 
// strings then need to be convert back to UTF-8\. This function is just a rough 
// example of how to do this.
# define utf8(str)  ConvertToUTF8(L##str)
const char * ConvertToUTF8(const wchar_t * pStr) {
    static char szBuf[1024];
    WideCharToMultiByte(CP_UTF8, 0, pStr, -1, szBuf, sizeof(szBuf), NULL, NULL);
    return szBuf;
}
#else
// Visual C++ 2003 and gcc will use the string literals as is, so the files 
// should be saved as UTF-8\. gcc requires the files to not have a UTF-8 BOM.
# define utf8(str)  str
#endif 
```

请注意，此代码只是一个简化示例。生产使用需要以多种方式清理它（线程安全、错误检查、缓冲区大小检查等）。

这就像下面的代码一样使用。它编译干净并且在我对 gcc、vc2003 和 vc2008 的测试中正常工作：

```
std::string mText;
mText = utf8("Chinese (Traditional)");
mText = utf8("中国語 (繁体)");
mText = utf8("중국어 (번체)");
mText = utf8("Chinês (Tradicional)"); 
```

* * *

## 回答 #2

> 赞同：17
> 
> 时间：2009-03-28T22:12:35.920

虽然使用宽字符串然后根据需要转换为 UTF-8 可能会更好。我认为你最好的选择是在字符串中使用十六进制转义。就像假设您想要代码点一样`\uC911`，您可以这样做。

```
const char *str = "\xEC\xA4\x91"; 
```

我相信这会工作得很好，只是不是很可读，所以如果你这样做，请评论它来解释。

* * *

## 回答 #3

> 赞同：16
> 
> 时间：2009-09-01T01:51:18.297

布罗菲尔德，

我遇到了完全相同的问题，只是偶然发现了一个不需要将源字符串转换为宽字符并返回的解决方案：将源文件保存为*没有*签名的 UTF-8，VC2008 将不理会它。当我想放弃签名时，效果很好。总结一下：

Unicode (UTF-8 without signature) - Codepage 65001，不会在 VC2008 中抛出 c4566 警告，也不会导致 VC 混淆编码，而 Codepage 65001 (UTF-8 With Signature) 会抛出 c4566 (就像你有成立）。

希望这对您有所帮助还为时不晚，但它可能会加快您的 VC2008 应用程序以删除您的解决方法。

* * *

## 回答 #4

> 赞同：14
> 
> 时间：2010-03-09T19:06:01.980

文件/高级保存选项/编码：“Unicode（**不带签名**的 UTF-8 ）-代码页 65001”

* * *

## 回答 #5

> 赞同：10
> 
> 时间：2012-07-19T11:58:51.367

源文件的 Visual C++ (2005+) 编译器标准行为是：

*   CP1252（对于本示例，西欧代码页）：
    *   `"Ä"`→`C4 00`
    *   `'Ä'`→`C4`
    *   `L"Ä"`→`00C4 0000`
    *   `L'Ä'`→`00C4`
*   没有 BOM 的 UTF-8：
    *   `"Ä"`→ `C3 84 00`(= UTF-8)
    *   `'Ä'`→ 警告：多字符常量
    *   `"Ω"`→ `E2 84 A6 00`（= UTF-8，正如预期的那样）
    *   `L"A"`→ `00C3 0084 0000`（错了！）
    *   `L'Ä'`→ 警告：多字符常量
    *   `L"Ω"`→ `00E2 0084 00A6 0000`（错了！）
*   带有 BOM 的 UTF-8：
    *   `"Ä"`→ `C4 00`（= CP1252，不再是 UTF-8），
    *   `'Ä'`→`C4`
    *   `"Ω"`→ 错误：无法转换为 CP1252！
    *   `L"Ä"`→ `00C4 0000`（正确）
    *   `L'Ä'`→`00C4`
    *   `L"Ω"`→ `2126 0000`（正确）

您会看到，C 编译器处理没有 BOM 的 UTF-8 文件的方式与 CP1252 相同。结果，编译器不可能将 UTF-8 和 UTF-16 字符串混合到编译输出中！所以你必须决定一个源代码文件：

*   **要么**将 UTF-8 与 BOM 一起使用并仅生成 UTF-16 字符串（即始终使用`L`前缀），
*   **或**没有 BOM 的 UTF-8，只生成 UTF-8 字符串（即从不使用`L`前缀）。
*   不涉及 7 位 ASCII 字符，可以带或不带`L`前缀使用

独立地，EDITOR 可以将没有 BOM 的 UTF-8 文件自动检测为 UTF-8 文件。

* * *

## 回答 #6

> 赞同：7
> 
> 时间：2012-02-14T15:50:21.373

从评论到这个非常好的博客
“在 Visual Studio 中使用 UTF-8 作为 C 和 C++ 中字符串的内部表示”
=> [http://www.nubaria.com/en/blog/?p=289](http://www.nubaria.com/en/blog/?p=289)

```
#pragma execution_character_set("utf-8") 
```

> 它需要 Visual Studio 2008 SP1 和以下修补程序：
> 
> [http://support.microsoft.com/kb/980263](http://support.microsoft.com/kb/980263) ....

* * *

## 回答 #7

> 赞同：4
> 
> 时间：2009-09-15T02:32:00.020

这个怎么样？您将字符串存储在 UTF-8 编码文件中，然后将它们预处理为 ASCII 编码 C++ 源文件。您可以使用十六进制转义符将 UTF-8 编码保留在字符串中。字符串

```
"中国語 (繁体)" 
```

被转换为

```
"\xE4\xB8\xAD\xE5\x9B\xBD\xE8\xAA\x9E (\xE7\xB9\x81\xE4\xBD\x93)" 
```

当然这是任何人都无法阅读的，目的只是为了避免编译器出现问题。

您可以使用 C++ 预处理器来引用转换后的头文件中的字符串，也可以在使用此技巧进行编译之前将整个 UTF-8 源代码转换为 ASCII。

* * *

## 回答 #8

> 赞同：3
> 
> 时间：2010-12-19T02:09:01.993

使用 char_traits::widen() 可以直接从您拥有的任何本机编码进行可移植转换。

```
#include <locale>
#include <string>
#include <vector>

/////////////////////////////////////////////////////////
// NativeToUtf16 - Convert a string from the native 
//                 encoding to Unicode UTF-16
// Parameters:
//   sNative (in): Input String
// Returns:        Converted string
/////////////////////////////////////////////////////////
std::wstring NativeToUtf16(const std::string &sNative)
{
  std::locale locNative;

  // The UTF-16 will never be longer than the input string
  std::vector<wchar_t> vUtf16(1+sNative.length());

  // convert
  std::use_facet< std::ctype<wchar_t> >(locNative).widen(
        sNative.c_str(), 
        sNative.c_str()+sNative.length(), 
        &vUtf16[0]);

  return std::wstring(vUtf16.begin(), vUtf16.end());
} 
```

理论上，从 UTF-16 到 UTF-8 的返回过程应该同样容易，但我发现 UTF-8 语言环境在我的系统上无法正常工作（Win7 上的 VC10 Express）。

因此，我编写了一个基于 RFC 3629 的简单转换器。

```
/////////////////////////////////////////////////////////
// Utf16ToUtf8 -   Convert a character from UTF-16 
//                 encoding to UTF-8.
//                 NB: Does not handle Surrogate pairs.
//                     Does not test for badly formed 
//                     UTF-16
// Parameters:
//   chUtf16 (in): Input char
// Returns:        UTF-8 version as a string
/////////////////////////////////////////////////////////
std::string Utf16ToUtf8(wchar_t chUtf16)
{
    // From RFC 3629
    // 0000 0000-0000 007F   0xxxxxxx
    // 0000 0080-0000 07FF   110xxxxx 10xxxxxx
    // 0000 0800-0000 FFFF   1110xxxx 10xxxxxx 10xxxxxx

    // max output length is 3 bytes (plus one for Nul)
    unsigned char szUtf8[4] = "";

    if (chUtf16 < 0x80)
    {
        szUtf8[0] = static_cast<unsigned char>(chUtf16);
    }
    else if (chUtf16 < 0x7FF)
    {
        szUtf8[0] = static_cast<unsigned char>(0xC0 | ((chUtf16>>6)&0x1F));
        szUtf8[1] = static_cast<unsigned char>(0x80 | (chUtf16&0x3F));
    }
    else
    {
        szUtf8[0] = static_cast<unsigned char>(0xE0 | ((chUtf16>>12)&0xF));
        szUtf8[1] = static_cast<unsigned char>(0x80 | ((chUtf16>>6)&0x3F));
        szUtf8[2] = static_cast<unsigned char>(0x80 | (chUtf16&0x3F));
    }

    return reinterpret_cast<char *>(szUtf8);
}

/////////////////////////////////////////////////////////
// Utf16ToUtf8 -   Convert a string from UTF-16 encoding
//                 to UTF-8
// Parameters:
//   sNative (in): Input String
// Returns:        Converted string
/////////////////////////////////////////////////////////
std::string Utf16ToUtf8(const std::wstring &sUtf16)
{
    std::string sUtf8;
    std::wstring::const_iterator itr;

    for (itr=sUtf16.begin(); itr!=sUtf16.end(); ++itr)
        sUtf8 += Utf16ToUtf8(*itr);
    return sUtf8;
} 
```

我相信这应该可以在任何平台上运行，但是除了在我自己的系统上之外，我无法对其进行测试，因此它可能存在错误。

```
#include <iostream>
#include <fstream>

int main()
{
    const char szTest[] = "Das tausendschöne Jungfräulein,\n"
                          "Das tausendschöne Herzelein,\n"
                          "Wollte Gott, wollte Gott,\n"
                          "ich wär' heute bei ihr!\n";

    std::wstring sUtf16 = NativeToUtf16(szTest);
    std::string  sUtf8  = Utf16ToUtf8(sUtf16);

    std::ofstream ofs("test.txt");
    if (ofs)
        ofs << sUtf8;
    return 0;
} 
```

* * *

## 回答 #9

> 赞同：1
> 
> 时间：2009-09-15T03:15:51.243

也许尝试一个实验：

```
#pragma setlocale(".UTF-8") 
```

或者：

```
#pragma setlocale("english_england.UTF-8") 
```

* * *

## 回答 #10

> 赞同：1
> 
> 时间：2009-12-18T13:10:48.543

我有一个类似的问题。我的 UTF-8 字符串文字在编译期间被转换为当前系统代码页 - 我刚刚在十六进制查看器中打开了 .obj 文件，它们已经被破坏了。例如，字符**ć**只是一个字节。

我的解决方案是保存在 UTF-8 和没有 BOM 中。这就是我欺骗编译器的方式。它现在认为这只是一个正常的来源，不会翻译字符串。在 .obj 文件中， **ć**现在是两个字节。

请忽略一些评论员。我明白你想要什么——我也想要同样的东西：UTF-8 源代码、UTF-8 生成文件、UTF-8 输入文件、通信线路上的 UTF-8，而无需翻译。

也许这有帮助...

* * *

## 回答 #11

> 赞同：1
> 
> 时间：2017-05-04T16:35:13.553

我知道我参加聚会要迟到了，但我想我需要把它[传播出去](https://raymai97.github.io/myblog/msvc/2017/05/04/msvc-support-utf-8-string-literal-since-vc6.html)。对于 Visual C++ 2005 及更高版本，如果源文件不包含 BOM（字节顺序标记），并且您的系统区域设置不是英语，VC 将假定您的源文件不是 Unicode。

要正确编译 UTF-8 源文件，您必须**以不带 BOM**编码的 UTF-8 保存，并且**系统区域设置（非 Unicode 语言）必须是 English**。

[![在此处输入图像描述](https://i.stack.imgur.com/8W0wd.png)](https://i.stack.imgur.com/8W0wd.png)

* * *

## 回答 #12

> 赞同：1
> 
> 时间：2017-12-08T04:31:24.137

我在编译 UTF-8 窄（char）字符串文字时遇到了类似的问题，我发现基本上我必须同时拥有 UTF-8 BOM 和`#pragma execution_character_set("utf-8")`[1]，或者既没有 BOM 也没有编译指示 [2]。使用一个而没有另一个会导致错误的转换。

我在[https://github.com/jay/compiler_string_test记录了详细信息](https://github.com/jay/compiler_string_test)

[1]：Visual Studio 2012 不支持 execution_character_set。Visual Studio 2010 和 2015 运行良好，正如您所知道的 2008 年的补丁程序运行良好。

[2]：此线程中的一些评论指出，对于使用多字节本地代码页（例如日本）的开发人员来说，既不使用 BOM 也不使用 pragma 可能会导致不正确的转换。

* * *

## 回答 #13

> 赞同：0
> 
> 时间：2009-03-28T15:51:38.487

我有一个类似的问题，解决方案是使用高级保存选项保存在 UTF8 中而不用繁荣

* * *

## 回答 #14

> 赞同：0
> 
> 时间：2011-07-08T17:20:41.587

所以，事情要改变。现在我有一个解决方案。

首先，你应该在Single Byte Code Page Local下运行，比如English，这样cl.exe就不会得到乱码。

二、把源代码保存为UTF8-NO BOM，注意，NO-BOM，然后用cl.exe编译，不要调用任何C API，比如printf wprint，那些人都不工作，我不'不知道为什么：）....以后可能有研究...

然后直接编译运行，就可以看到结果了……我的邮箱是 luoyonggang，（谷歌的）希望一些……

脚本：

```
#! /usr/bin/env python
# encoding: utf-8
# Yonggang Luo

# the following two variables are used by the target "waf dist"
VERSION='0.0.1'
APPNAME='cc_test'

top = '.'

import waflib.Configure

def options(opt):
    opt.load('compiler_c')

def configure(conf):
    conf.load('compiler_c')
    conf.check_lib_msvc('gdi32')
    conf.check_libs_msvc('kernel32 user32')

def build(bld):
    bld.program(
        features = 'c',
        source   = 'chinese-utf8-no-bom.c',
        includes = '. ..',
        cflags   = ['/wd4819'],
        target   = 'myprogram',
        use      = 'KERNEL32 USER32 GDI32') 
```

运行脚本run.bat

```
rd /s /q build
waf configure build --msvc_version "msvc 6.0"
build\myprogram

rd /s /q build
waf configure build --msvc_version "msvc 9.0"
build\myprogram

rd /s /q build
waf configure build --msvc_version "msvc 10.0"
build\myprogram 
```

源代码 main.c：

```
//encoding : utf8 no-bom
#include <stdio.h>
#include <string.h>

#include <Windows.h>

char* ConvertFromUtf16ToUtf8(const wchar_t *wstr)
{
    int requiredSize = WideCharToMultiByte(CP_UTF8, 0, wstr, -1, 0, 0, 0, 0);
    if(requiredSize > 0)
    {
        char *buffer = malloc(requiredSize + 1);
        buffer[requiredSize] = 0;
        WideCharToMultiByte(CP_UTF8, 0, wstr, -1, buffer, requiredSize, 0, 0);
        return buffer;
    }
    return NULL;
}

wchar_t* ConvertFromUtf8ToUtf16(const char *cstr)
{
    int requiredSize = MultiByteToWideChar(CP_UTF8, 0, cstr, -1, 0, 0);
    if(requiredSize > 0)
    {
        wchar_t *buffer = malloc( (requiredSize + 1) * sizeof(wchar_t) );
        printf("converted size is %d 0x%x\n", requiredSize, buffer);
        buffer[requiredSize] = 0;
        MultiByteToWideChar(CP_UTF8, 0, cstr, -1, buffer, requiredSize);
        printf("Finished\n");
        return buffer;
    }
    printf("Convert failed\n");
    return NULL;
}

void ShowUtf8LiteralString(char const *name, char const *str)
{
    int i = 0;
    wchar_t *name_w = ConvertFromUtf8ToUtf16(name);
    wchar_t *str_w = ConvertFromUtf8ToUtf16(str);

    printf("UTF8 sequence\n");
    for (i = 0; i < strlen(str); ++i)
    {
        printf("%02x ", (unsigned char)str[i]);
    }

    printf("\nUTF16 sequence\n");
    for (i = 0; i < wcslen(str_w); ++i)
    {
        printf("%04x ", str_w[i]);
    }

    //Why not using printf or wprintf? Just because they do not working:)
    MessageBoxW(NULL, str_w, name_w, MB_OK);
    free(name_w);
    free(str_w);

}

int main()
{
    ShowUtf8LiteralString("English english_c", "Chinese (Traditional)");
    ShowUtf8LiteralString("简体 s_chinese_c", "你好世界");
    ShowUtf8LiteralString("繁体 t_chinese_c", "中国語 (繁体)");
    ShowUtf8LiteralString("Korea korea_c", "중국어 (번체)");
    ShowUtf8LiteralString("What? what_c", "Chinês (Tradicional)");
} 
```

* * *

## 回答 #15

> 赞同：0
> 
> 时间：2013-04-09T09:05:21.747

UTF-8 源文件

*   **没有 BOM**：被视为原始，除非您的系统使用 >1byte/char 代码页（如 Shift JIS）。您需要将系统代码页更改为任何单个字节，然后您应该能够在文字中使用 Unicode 字符并毫无问题地编译（至少我希望如此）。
*   **使用 BOM**：在编译期间将它们的字符和字符串文字转换为系统代码页。您可以使用 GetACP() 检查当前系统代码页。AFAIK，无法将系统代码页设置为 65001（UTF-8），因此无法直接将 UTF-8 与 BOM 一起使用。

唯一可移植且独立于编译器的方法是使用 ASCII 字符集和转义序列，因为不能保证任何编译器都会接受 UTF-8 编码的文件。

* * *

## 回答 #16

> 赞同：0
> 
> 时间：2021-07-06T19:54:29.733

现在有一个`/utf-8`编译器命令行选项。

要在 Visual Studio 开发环境中设置此编译器选项：

*   打开项目属性页对话框。

*   选择`Configuration Properties`-> `C/C++`->`Command Line`属性页。

*   在`Additional Options`中，添加`/utf-8`选项以指定您的首选编码。

*   选择确定以保存您的更改。

有关详细信息，请参阅： [https ://docs.microsoft.com/en-us/cpp/build/reference/utf-8-set-source-and-executable-character-sets-to-utf-8?view= msvc-160](https://docs.microsoft.com/en-us/cpp/build/reference/utf-8-set-source-and-executable-character-sets-to-utf-8?view=msvc-160)

* * *

## 回答 #17

> 赞同：-3
> 
> 时间：2009-03-28T22:40:53.200

我同意西奥·沃斯的观点。阅读[Joel On Software](http://www.joelonsoftware.com)上的文章[《每个软件开发人员绝对、肯定必须了解 Unicode 和字符集（没有任何借口！）](http://www.joelonsoftware.com/articles/Unicode.html) 》 ...

* * *

## 回答 #18

> 赞同：-6
> 
> 时间：2009-03-28T21:22:11.780

阅读文章。首先，您不想要 UTF-8。UTF-8 只是一种表示字符的方式。你想要宽字符（wchar_t）。你把它们写成 L"yourtextgoeshere"。该文字的类型是 wchar_t*。如果您赶时间，只需查找 wprintf。

# javascript - jQuery Countdown 插件和 AJAX

> ID：688763
> 
> 赞同：0
> 
> 时间：2009-03-27T06:51:33.817
> 
> 标签：javascript, jquery, ajax, countdownlatch

我正在使用[jQuery Countdown 插件](http://keith-wood.name/countdown.html)来实现倒计时并在计时器到期时调用 Web 服务。

问题是我在页面上使用 AJAX，并且必须重新设置每个 AJAX 请求的倒计时，如下所示：

```
var prm = Sys.WebForms.PageRequestManager.getInstance();

prm.add_endRequest(SetupTimer);

/*Initial setup*/
$(document).ready(function() {
    SetupTimer();
});

function SetupTimer() {
        var serverTime = new Date();
        var cutoffTime = new Date($("#<%= cutoffTime.ClientID %>").val());
        serverTime.setHours(serverTime.getHours());
        if (serverTime < cutoffTime) {
            $('#timer').countdown('destroy'); /*should work, but doesn't*/
            $('#timer').countdown({ until: cutoffTime, serverTime: serverTime, onExpiry: OrderingEnded, format: 'yowdHMS' });
        } 
        else
            OrderingEnded();
    } 
```

出于某种原因，这会根据请求创建一个新的 Countdown 实例，从而在 Countdown 到期时导致对 Webservice 的大量调用。

**如何确保一次只存在一个倒计时实例？**

### 编辑

在文档中找到了这个，虽然不适合我

```
 $('#timer').countdown('destroy'); 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-03-27T07:21:15.460

好的，想通了，只需要调用

```
$('#timer').countdown('destroy'); 
```

在开始请求

```
var prm = Sys.WebForms.PageRequestManager.getInstance();
prm.add_beginRequest(DeleteTimer);
prm.add_endRequest(SetupTimer);

$(document).ready(function() {
    SetupTimer();
});

function DeleteTimer() {
    $('#timer').countdown('destroy');
}
function SetupTimer() {
    var serverTime = new Date();
    var cutoffTime = new Date($("#<%= cutoffTime.ClientID %>").val());
    serverTime.setHours(serverTime.getHours());
    if (serverTime < cutoffTime) {          
        $('#timer').countdown({ until: cutoffTime, serverTime: serverTime, onExpiry: OrderingEnded, format: 'yowdHMS' });
    } 
    else
        OrderingEnded();
} 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-03-27T06:57:22.023

你可能想要`setInterval()`. 它允许您每 X 毫秒重复一次计时器。你可以用`clearInterval()`它来阻止它。

[这是一些阅读](http://www.switchonthecode.com/tutorials/javascript-tutorial-using-setinterval-and-settimeout)比较`setInterval()`和`setTimeout()`。

仅在 AJAX 调用的回调函数中重新创建计时器的另一个选项。这将确保仅在先前的 AJAX 调用完成后才启动新计时器，例如：

```
 function CheckServer() {
     $.get('/get_something.html', function() {
         timer = setTimeout('CheckServer', 5000);
     });
 } 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2010-04-10T11:41:05.530

我有类似的问题。我正在使用 web 服务使用 jquery.countdown.js 插件中的 serversync 函数从服务器获取当前时间。我有一个问题

[倒计时如何使用“jquery.countdown.js”插件与jquery同步？](https://stackoverflow.com/questions/2609028/how-countdown-get-synchronise-with-jquery-using-jquery-countdown-js-plugin)

请您找到解决方案并告诉我谢谢。

# javascript - 选择此项目后，如何使拆分按钮菜单项滚动到视图中？

> ID：688765
> 
> 赞同：0
> 
> 时间：2009-03-27T06:52:21.413
> 
> 标签：javascript, yui

我已经使用 YUI 2.6 一段时间了。现在，我意识到 YUI 的拆分按钮的行为不像标准的 select html 元素。选择一个项目后，再次显示列表时，它根本不会突出显示或滚动该项目到视图中。在最坏的情况下，如果我有 200 个项目，用户选择了第 100 个项目，当他/她想要更改他/她的选择时，他/她必须从头开始滚动。它根本不是用户友好的。与标准的 select html 元素不同，它会突出显示该项目并将其滚动到视图中。任何想法都非常感谢。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2009-03-27T08:31:43.107

我怀疑菜单中的大量项目不是[拆分按钮菜单](http://developer.yahoo.com/yui/examples/button/btn_example08.html)旨在处理的用例。与`select`输入元素不同，用户无法使用键盘快速过滤到他们想要选择的选项。想想用户想要选择的初始项目是否是第 100 个项目 - 他们也必须从头开始滚动。

考虑到问题的背景，也许有更好的方法来处理您正在尝试做的事情。如果您提供有关您希望帮助用户实现的目标的更多详细信息，那么其他人可能会对一些不同的方法有想法。

# python - 在 Twitter OAuth POST 请求上获取 401

> ID：688766
> 
> 赞同：6
> 
> 时间：2009-03-27T06:52:35.810
> 
> 标签：python, web-services, twitter, rest, oauth

我正在尝试使用 Twitter OAuth，但我的`POST`请求因`401`( `Invalid OAuth Request`) 错误而失败。

例如，如果我想发布一个新的状态更新，我将发送一个 HTTP`POST`请求，`https://twitter.com/statuses/update.json`并带有以下参数 -

```
status=Testing&oauth_version=1.0&oauth_token=xxx&
oauth_nonce=xxx&oauth_timestamp=xxx&oauth_signature=xxx&
oauth_consumer_key=xxx&in_reply_to=xxx&oauth_signature_method=HMAC-SHA1` 
```

我的`GET`要求一切正常。我可以在邮件列表中看到很多人都遇到过相同的问题，但我在任何地方都找不到解决方案。

我正在使用`oauth.py`Python 库。

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2009-04-17T05:14:54.307

我刚刚使用 Java 从头开始​​实现 twitter OAuth API。获取和发布请求工作正常。您可以使用此页面[http://www.hueniverse.com/hueniverse/2008/10/beginners-gui-1.html](http://www.hueniverse.com/hueniverse/2008/10/beginners-gui-1.html)检查签名和 HTTP 标头。只需输入您的密钥和令牌并检查输出。看来 twitter 的工作方式与这篇文章中描述的完全一样。注意空格和 UTF-8 符号，例如 Java 将空格编码为“+”，但 OAuth 需要 %20

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2010-03-19T19:59:17.910

确保您的应用访问类型为读写。在您的应用设置页面（例如[http://twitter.com/apps/edit/12345](http://twitter.com/apps/edit/12345)）上有一个单选按钮字段，如下所示：

默认访问类型：读写/只读

如果您选中“只读”，则状态更新 API 将返回 401。

* * *

## 回答 #3

> 赞同：3
> 
> 时间：2011-01-02T22:21:17.727

我支持 Jrgns 的回答。我有完全相同的问题。阅读 Twitter 提供的示例时，实际上很清楚。然而，他们的伪代码具有误导性。在 Python 中，这对我有用：

```
def encodekeyval(key, val):
    key = urllib.quote(key, '')
    val = urllib.quote(val, '')
    return urllib.quote(key + '=' + val, '')

def signature_base_string(urlstr, oauthdata):
    sigstr = 'POST&' + urllib.quote(urlstr,'') + '&'
    # retrieve "post" data as dictionary of name value pairs
    pdata = oauthdata.getpdata()
    # need to sort parameters
    pstr = '%26'.join([encodekeyval(key, pdata[key]) for key in sorted(pdata.keys())])
    return sigstr + pstr 
```

* * *

## 回答 #4

> 赞同：2
> 
> 时间：2010-01-29T22:21:26.247

我遇到了同样的问题，直到我意识到参数需要为基本字符串编码两次。我的 GET 请求一切正常，但我的 POST，尤其是状态更新，失败了。凭直觉，我尝试了一个`status`参数中没有空格的 POST，它起作用了。

在 PHP 中：

```
function encode($input) {
    return str_replace('+', ' ', str_replace('%7E', '~', rawurlencode($input)));
}

$query = array();
foreach($parameters as $name => $value) {
    $query[] = encode($name) . '=' .encode($value);
}
$base = encode(strtoupper($method)) . '&' .encode($norm_url) . '&' . 
encode(implode('&', $query)); 
```

注意`encode`围绕参数名称和值的函数，然后围绕整个查询字符串。一个 Space 应该以 结束`%2520`，而不仅仅是`%20`。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2010-10-23T11:12:33.903

我找到了解决方案，它对我有用，您必须在请求标头中添加以下参数，它应该如下所示（c# 代码），不要使用 & 符号，而是用逗号（，）符号分隔参数。并且您必须在开头添加单词“OAuth”。

> httpWebRequest.Headers[System.Net.HttpRequestHeader.Authorization] = "OAuth oauth_consumer_key=\"hAnZFaPKxXnJqdfLhDikdw\", oauth_nonce=\"4729687\", oauth_signature_method=\"HMAC-SHA1\", oauth_timestamp=\"1284821989\", oauth =\"17596307-KH9iUzqTxaoa5576VjILkERgUxcqExRyXkfb8AsXy\", oauth_version=\"1.0\", oauth_signature=\"p8f5WTObefG1N9%2b8AlBji1pg18A%3d\"";

和其他参数，如“状态”应该写在请求的正文中。

* * *

## 回答 #6

> 赞同：-8
> 
> 时间：2009-04-15T19:34:02.263

很可能，签名无效。您必须遵循 OAuth 规范关于如何生成签名（规范化参数、URLencoding 和 cosumerSecret&oauthScret。稍后会详细介绍......

# eclipse-plugin - 安装更多插件的eclipse问题

> ID：688774
> 
> 赞同：1
> 
> 时间：2009-03-27T06:55:57.190
> 
> 标签：eclipse-plugin, flexbuilder

我收到这个错误

```
Unexpected error encountered while preparing for the operation. 
org.eclipse.core.runtime.AssertionFailException 
```

并在详细信息窗口中

```
Unexpected error encountered while preparing for the operation.
null argument: 
```

当我尝试从该站点更新时 [http://mantis.faratasystems.com/downloads/update/site.xml](http://mantis.faratasystems.com/downloads/update/site.xml)

我正在运行 eclipse 3.4.1 和 flex builder 作为插件我如何纠正这个错误并安装这个插件（Fx2Ant）

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-07-22T12:21:53.730

@Aaron 的建议很有帮助，但有点乏味。我试了一下。在我的情况下，复制的插件不会出现在 UI 中。更正文件权限也没有帮助，我放弃了。沮丧，我四处寻找解决此错误的其他解决方案，并在 Eclipse wiki 上找到了一个可以帮助您将 p2 替换为 Ganymede 中的原始更新管理器的解决方案。我试过了，它有效。还有一个自动化脚本可供下载，其功能相同。我认为这是一个很好的解决方案，直到 p2 的问题得到解决。

[您可以在此处](http://wiki.eclipse.org/Equinox_p2_Removal)阅读有关如何执行此操作的更多信息。

注意：仅适用于 3.4.x。它说它不适用于 3.5，因为 p2 与 3.5 的其他组件紧密耦合。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-03-27T08:32:43.870

对我来说，新的插件安装程序“p2”经常进入不一致的状态。我的解决方案是安装三个 Eclipse：一个工作安装、一个模板和一个“安装”。当我需要安装一些插件时，我删除“安装”，从“模板”中复制它，然后在那里进行安装。

安装后，我将“插件”和“功能”下的新文件复制到我的工作安装到`eclipse/dropins/`插件的目录+名称中。有关详细信息，请参阅[我的博客](http://blog.pdark.de/2008/09/29/installing-eclipse-341-despite-p2/)。

# php - 如何使用 php 删除和编辑 XML 文件中的特定节点？

> ID：688775
> 
> 赞同：1
> 
> 时间：2009-03-27T06:56:33.633
> 
> 标签：php, xml

如何使用 php 删除和编辑 XML 文件中的特定节点？请治愈我任何人！

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-03-27T07:57:03.957

看看这个[SO question](https://stackoverflow.com/questions/457153/how-do-i-remove-a-specific-node-using-its-attribute-value-in-php-xml-dom)。此外，[本教程](http://www.ibm.com/developerworks/xml/library/x-xmlphp2.html)还介绍了在 php 中处理 XML 文档的几种不同方法。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-03-27T08:32:55.850

我使用[DOM](http://sg.php.net/dom)库来遍历和操作 XML 文档。

在删除或编辑节点之前，您需要将 XML 文档加载到 DOMDocument 对象中：

```
$domDocument = new DOMDocument();
$domDocument->load('youfile.xml'); 
```

有很多方法可以找到您想要的节点。其中之一是使用节点的 XPath 执行查询：

```
$xmlPath = new DOMXPath($domDocument);
$xmlNodes = $xmlPath->query('//graphics'); 
```

$xmlNodes 是一个[DOMElements](http://sg.php.net/manual/en/class.domelement.php)数组。他们有自己的功能来删除或编辑您所追求的特定节点。

例如，您可以获取所有这些并删除某些属性：

```
foreach($xmlNodes as $node)
{
    $node->removeAttribute('size');
} 
```

完成后，您可以将更改保存到文件：

```
$domDocument->save('yourfile.xml'); 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-03-27T08:07:58.873

您可以使用 xml2array 函数，然后像数组一样威胁它：

```
function xml2array($contents, $get_attributes=1){
if(!$contents) return array();
if(!function_exists('xml_parser_create')){
    print "'xml_parser_create()' function not found!";
    return array();
}
//Get the XML parser of PHP - PHP must have this module for the parser to work
$parser = xml_parser_create();
xml_parser_set_option( $parser, XML_OPTION_CASE_FOLDING, 0 );
xml_parser_set_option( $parser, XML_OPTION_SKIP_WHITE, 1 );
xml_parse_into_struct( $parser, $contents, $xml_values );
xml_parser_free( $parser );
if(!$xml_values) return;//Hmm...
//Initializations
$xml_array = array();
$parents = array();
$opened_tags = array();
$arr = array();
$current = &$xml_array;
//Go through the tags.
foreach($xml_values as $data){
    unset($attributes,$value);//Remove existing values, or there will be trouble
    //This command will extract these variables into the foreach scope
    // tag(string), type(string), level(int), attributes(array).
    extract($data);//We could use the array by itself, but this cooler.
    $result = '';
    if($get_attributes){//The second argument of the function decides this.
        $result = array();
        if(isset($value)) $result['value'] = $value;
        //Set the attributes too.
        if(isset($attributes)){
            foreach($attributes AS $attr => $val){
                if($get_attributes == 1) $result['attr'][$attr] = $val; //Set all the attributes in a array called 'attr'
                /**  :TODO: should we change the key name to '_attr'? Someone may use the tagname 'attr'. Same goes for 'value' too */
            }
        }
    }else if(isset($value)){
        $result = $value;
    }
    //See tag status and do the needed.
    if($type == "open"){//The starting of the tag '<tag>'
        $parent[$level-1] = &$current;
        if(!is_array($current) OR (!in_array($tag, array_keys($current)))){//Insert New tag
            $current[$tag] = $result;
            $current = &$current[$tag];
        }else{ //There was another element with the same tag name
            if(isset($current[$tag][0])){
                array_push($current[$tag], $result);
            }else{
                $current[$tag] = array($current[$tag],$result);
            }
            $last = count($current[$tag]) - 1;
            $current = &$current[$tag][$last];
        }
    }else if($type == "complete"){//Tags that ends in 1 line '<tag />'
        //See if the key is already taken.
        if(!isset($current[$tag])){//New Key
            $current[$tag] = $result;
        }else{//If taken, put all things inside a list(array)
            if((is_array($current[$tag]) and $get_attributes == 0)//If it is already an array...
                    or (isset($current[$tag][0]) and is_array($current[$tag][0]) and $get_attributes == 1)){
                array_push($current[$tag],$result); // ...push the new element into that array.
            }else{//If it is not an array...
                $current[$tag] = array($current[$tag],$result); //...Make it an array using using the existing value and the new value
            }
        }
    }else if($type == 'close'){ //End of tag '</tag>'
        $current = &$parent[$level-1];
    }
}
return($xml_array);
} 
```

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2009-03-27T09:01:07.703

SimpleXML 是 PHP 5 的新手。

```
<?php
    $xml = simplexml_load_file("test.xml");
?> 
```

将 XML 加载到 simpleXML 对象后，您可以找到特定节点并“取消设置”以将其删除。

# javascript - 如何在javascript中编辑下拉列表

> ID：688776
> 
> 赞同：0
> 
> 时间：2009-03-27T06:56:35.550
> 
> 标签：javascript, drop-down-menu

我想编辑下拉列表中选择下拉列表中的项目...我不想添加单独的文本框...

请帮我解决这个...

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-03-27T07:56:05.020

YUI[有一个](http://developer.yahoo.com/yui/examples/autocomplete/ac_combobox.html)使用他们的 AutoComplete 控件构建的组合框的示例，尽管它看起来与普通的选择下拉菜单完全不同。我也无法保证它的可用性。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-03-27T07:57:39.243

这不是直接可能的，但是您可以使用各种 JavaScript UI 小部件来模拟这一点。

YUI 具有类似于下拉组合框的[自动完成功能。](http://developer.yahoo.com/yui/examples/autocomplete/ac_combobox.html)ExtJs 也有一个[ComboBox](http://extjs.com/deploy/ext/examples/form/combos.html)可能更接近你想要的。只需在 Google 上搜索 JavaScript ComboBox。

# java - Eclipse 扩展和声明式服务

> ID：688783
> 
> 赞同：4
> 
> 时间：2009-03-27T07:02:21.233
> 
> 标签：java, eclipse, plugins, eclipse-plugin, osgi

我对 Eclipse 架构中的扩展/服务方法有点困惑。开发人员有两种选择：

1.  Eclipse插件扩展的使用——http: [//www.eclipse.org/articles/Article-Plug-in-architecture/plugin_architecture.html](http://www.eclipse.org/equinox/bundles/)
2.  声明式服务的使用 - [http://www.eclipse.org/equinox/bundles/](http://www.eclipse.org/equinox/bundles/)

什么时候你会使用一种方法，每种方法的优点和缺点是什么？还要继续前进，哪种方法是首选方法？

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2009-03-27T11:46:30.800

[在 EclipseZone: A Comparison of Eclipse Extensions and OSGi Services](http://www.eclipsezone.com/articles/extensions-vs-services/)上有一个很好的比较（我认为是从 2007 年开始）。

我会遵循您的目标平台的约定。因此，如果您正在为 Eclipse 3.4 编写插件，例如，创建一个 Eclipse 3.4 插件（它将使用*MANIFEST.MF*来表示依赖项，使用*plugin.xml*来表示扩展/扩展点 - 您链接到的文章是针对 Eclipse 2 。X）。您可以检查*插件*目录的内容来确认这一点。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2009-03-27T12:43:34.813

“当前”方法（pre3.5M5，如 eclipse3.4）的问题在于 Eclipse 插件扩展或 OSGI DS（声明式服务）都需要在您的插件中存在一些特定于扩展或 OSGI 的 API。

我鼓励您在这个 Powerpoint 演示文稿中查看对声明式服务的精彩介绍：来自 EclipseCON2009
[的使用声明式服务、Spring 动态模块和 Apache iPOJO 的 OSGi 中的面向组件的开发。](https://www.slideshare.net/njbartlett/component-oriented-development-in-osgi-with-declarative-services-spring-dynamic-modules-and-apache-ipojo?type=presentation)

这是一个味道：

* * *

模块层允许最小化静态依赖，更少的静态依赖意味着更少的*东西*必须存在才能让你的组件工作。
服务允许您的组件与其他组件交互。

**组件应该实现为与 OSGi 服务*粘合*在一起的 POJO（普通旧 Java 对象）。**

**声明式服务**(DS) 是来自 OSGi 纲要第 112 节的规范。
它是在 4.0 版中引入的，并且基于扩展器模型。

与所有扩展程序一样，DS*代表*其他捆绑包执行任务。DS 规范定义了这个扩展器，它由框架实现。
扩展程序包本身称为**服务组件运行时**或 SCR。

术语 DS 和 SCR 有时会混淆：
DS 是规范，SCR 是实现规范的实际捆绑包

OSGi R4.2 中的 DS 有显着改进。
Equinox 3.5M5+ 支持其中许多更改。

SCR（“服务组件运行时”，它是一个“扩展包”，实现了新的和改进的 OSGi R4.2 DS - 声明式服务 - 规范）将：

*   创建组件。
*   **将它们绑定**到服务和配置
*   管理组件的生命周期以响应绑定服务的进出。
*   （可选）将组件作为服务本身发布

你还有一个 MANIFEST.MF：

```
Bundle-SymbolicName : mybundle
Bundle-Version : 1.0.0
Service-Component : OSGI-INF/minimal. xml 
```

您将使用：

```
org.eclipse.equinox.ds <version>.jar
org.eclipse.equinox.util <version>.jar 
```

SCR 将自动找到激活/停用方法。
**我们可以通过在 XML 声明中添加属性来调用它们**。

在 R4.2 之前，方法名称无法更改，它们必须`ComponentContext`从 DS API 获取类型参数。这打破了组件的优势。

因此，您无需编写“ `BundleActivator`”（组件中的 OSGI 特定 API：BAD），而是编写一个普通的 POJO 对象：

```
public class PollingComponent {
    private static final int DEFAULT_PERIOD = 2000;
    private PollingThread thread ;
    protected void activate ( Map<String , Object> config ) {
        System.out.println( " Polling Component Activated " );
        Integer period = (Integer)config.get( " period " );
        thread = new PollingThread(
            period!=null ? period : DEFAULT_PERIOD);
        thread.start();
    }
    protected void deactivate() {
        System.out.println( " Polling Component Deactivated " );
        thread.interrupt();
    }
} 
```

您将简单地*声明*您对其他服务的引用：

```
<reference name="LOG"
    interface="org.osgi.service.log.LogService "
    bind="setLog" unbind="unsetLog"
    cardinality="0..1"/> 
```

您可以将组件作为服务本身发布：
这是通过`<service>`我们的 XML 描述符中的元素完成的。

```
<service>
    <provide interface="net ... ContactRepository"/>
    <property name="foo" value="bar"
</service> 
```

只需添加额外的`<provide>`元素即可提供多种服务。使用元素
指定服务属性。`<property>`这些属性在激活时传递给组件并发布到服务注册表

# asp.net - 如何在 Visual Studio 中的 Web 应用程序之间共享公共 Web 资源？

> ID：688784
> 
> 赞同：9
> 
> 时间：2009-03-27T07:02:22.870
> 
> 标签：asp.net, visual-studio-2008, web-applications, resources

我有三个 Web 应用程序项目，它们共享一个通用的自定义服务器控件库。共享文件背后的代码很容易 - 它们被编译成我在其他项目中使用项目引用引用的 dll。但是如何处理像 JavaScript、样式表和图像这样的文件呢？我正在尝试这样做“Visual Studio 方式”，以便尽可能容易地理解和调试。

当前的设置有点像这样：

```
CommonControlsWebApp
+- 自定义控件
+- 资源
   +- 图片
   +- 脚本
   +- 样式表

WebApp1
+- 资源*

WebApp2
+- 资源*

WebApp3
+- 资源*

```

*) IIS 中的虚拟目录。

每个 Web 应用程序上的虚拟目录都指向我的 CommonControlsWebApp 中的资源目录。这是在 IIS 中配置的。Visual Studio 无法理解此链接，因此调试需要我手动附加到 IIS 进程。

另一种解决方案可能是使用 WebResourceAttribute 将每个资源包含在公共 dll 中。但是，当我查看网页的源代码时，这会将`src`链接变成类似 WebResource.axd?d=GUID 的东西，而且我担心这会使调试变得非常混乱。

第三种解决方案是使用 Subversion 在所有三个解决方案中包含相同的文件。团队中没有人以前尝试过这个，所以我们不确定它的效果如何。

我觉得我缺少一些关于如何设置项目的很棒的、明显的解决方案。有什么建议么？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-03-27T07:27:47.303

许多控件开发人员使用您描述的第二种方法捆绑他们的网络资源 - 将它们作为嵌入资源添加到 .dll 中。这样，您可以分发控件，而不必将一堆文件夹和文件复制到每个想要使用它们的网站，并确保文件夹路径全部匹配等。您还可以获得更容易本地化/国际化的优势你的资源。

但是，WebResource.axd 是一个缺点。您通常可以使用诸如 Firebug 之类的东西“调试”URL，以查看从请求中实际返回的内容，但我同意，如果某些东西不能正常工作，这可能会很痛苦。另一个缺点是，如果您有几十个资源用于一个服务器控件，特别是如果它们被多次引用（想想在节点上有数百个小图像的树视图） - 那么 URL 可以为最终添加大量实际字节HTML 输出。

如果您的分发/本地化需求超过您的优化/调试需求，我会考虑嵌入资源。

如果没有，那么您绝对可以执行 #3 - 使用 Subversion 将所有内容复制到您的网站中。查看[SVN Externals](http://svnbook.red-bean.com/en/1.0/ch07s03.html)了解如何设置它。现在花一点时间学习它可能会为您节省大量时间！

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2009-03-27T08:39:13.527

我采取了简单的方法，将我所有的项目放在一个解决方案中。然后我创建了一个 WebUserControlLibrary 项目，其中放置了所有共享控件。

为了让它们进入另一个项目，我为每个项目配置了构建事件，以将 UC 复制到一个特殊文件夹中：

```
copy "$(SolutionDir)WebUserControlLibrary\UserControls\*.ascx"
   "$(ProjectDir)ImportedUserControls\UserControls" 
```

当然，从需要它的项目中引用 WebUserControlLibrary。

这种方法的优点：

*   Visual Studio 中的调试工作，
*   没有代码重复

缺点：

*   笨拙的解决方案:)
*   更改 .ascx 文件后，必须重建项目。这意味着无法更改 html 并在 IE 中刷新页面并直接查看结果。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2017-09-12T18:24:30.333

我有几个选择可以扔进桶里：

**选项 1：** 为您的资源使用共享项目：[http ://rion.io/2017/03/22/sharing-is-caring-using-shared-projects-in-asp-net/](http://rion.io/2017/03/22/sharing-is-caring-using-shared-projects-in-asp-net/)

**选项 2** 将您的类库转换为 NuGet 包。我认为您在打包时不需要做太多事情，除了以下内容以包含 NuGet 项目文件夹中的所有文件夹和文件：

> c:\nuget.exe 包 YOURPROJ.csproj -IncludeReferencedProjects -Prop Platform=AnyCPU -Exclude **.tt -Exclude **.txt

# multithreading - 对自旋锁感到困惑

> ID：688785
> 
> 赞同：2
> 
> 时间：2009-03-27T07:02:54.100
> 
> 标签：multithreading, language-agnostic, synchronization, locking

[我从这里](http://www.codeproject.com/KB/threads/spinlocks.aspx)阅读自旋锁代码，尤其是这部分

```
inline void Enter(void)
{
    int prev_s;
    do
    {
        prev_s = TestAndSet(&m_s, 0);
        if (m_s == 0 && prev_s == 1)
        {
            break;
        }
        // reluinquish current timeslice (can only
        // be used when OS available and
        // we do NOT want to 'spin')
        // HWSleep(0);
    }
    while (true);
} 
```

为什么我们需要测试两个条件 m_s == 0 && prev_s == 1？我认为只测试 prev_s == 1 就足够了。有任何想法吗？

编辑：版本 2。如果有错误，我们应该以这种方式修复吗？

```
inline void Enter(void)
{
    do
    {
        if (m_s == 0 && 1 == TestAndSet(&m_s, 0))
        {
            break;
        }
        // reluinquish current timeslice (can only
        // be used when OS available and
        // we do NOT want to 'spin')
        // HWSleep(0);
    }
    while (true);
} 
```

编辑：版本 3。我认为功能级别的版本 3 是正确的，但性能不够好，因为每次我们需要写入，没有提前读取测试。我的理解正确吗？

```
inline void Enter(void)
{
    do
    {
        if (1 == TestAndSet(&m_s, 0))
        {
            break;
        }
        // reluinquish current timeslice (can only
        // be used when OS available and
        // we do NOT want to 'spin')
        // HWSleep(0);
    }
    while (true);
} 
```

@dragonfly，这是我的错误修复版本 4（如您所指出的，修复了版本 2 中的错误），您能否查看它是否正确？谢谢！

编辑：版本 4。

```
inline void Enter(void)
{
    do
    {
        if (m_s == 1 && 1 == TestAndSet(&m_s, 0))
        {
            break;
        }
        // reluinquish current timeslice (can only
        // be used when OS available and
        // we do NOT want to 'spin')
        // HWSleep(0);
    }
    while (true);
} 
```

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2009-03-27T07:25:07.260

在我看来，这是一次优化的尝试，但略有错误。我*怀疑*它正在尝试“TATAS”-“Test-and-test-and-set”，如果它可以看到锁已经被占用，它甚至不会尝试执行 TestAndSet。

在一篇[关于 .NET 自旋锁](http://www.bluebytesoftware.com/blog/CommentView,guid,72aaa68e-4cbd-41db-a7ce-ddc64411eafa.aspx)的文章中，Joe Duffy 将这个 TATAS 代码写为：

```
class SpinLock {
    private volatile int m_taken;

    public void Enter() {
        while (true) {
            if (m_taken == 0 &&
                    Interlocked.Exchange(ref m_taken, 1) == 0)
                break;
        }
    }

    public void Exit() {
        m_taken = 0;
    }
} 
```

（请注意，Joe 使用 1 表示锁定，使用 0 表示解锁，这与代码项目示例不同 - 两者都可以，只是不要混淆两者！）

请注意，此处对 Interlocked.Exchange 的调用以*0**为条件`m_taken`*。这减少了争用 - 避免了相对昂贵的（我猜）测试和设置操作，这是不必要的。我*怀疑*这就是作者的目的，但并没有完全正确。

这也在“重大优化”下[关于自旋锁的维基百科文章中提到：](http://en.wikipedia.org/wiki/Spin_locking)

> 为了减少 CPU 间的总线流量，当没有获得锁时，代码应该循环读取而不尝试写入任何内容，直到它读取到更改的值。由于 MESI 缓存协议，这会导致锁的缓存行变为“共享”；那么当 CPU 等待锁定时，就没有明显的总线流量了。这种优化对每个 CPU 都有一个缓存的所有 CPU 架构都有效，因为 MESI 无处不在。

“循环读取”正是 while 循环所做的——在它看到`m_taken`变化之前，它只会读取。当它看到变化时（即当锁被释放时），它会再次锁定。

当然，我很可能遗漏了一些重要的东西——像这样的问题非常微妙。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2009-03-27T07:28:40.000

为什么这两个条件？因为在这种情况下，第二个线程也会获得锁。*（编辑：但如果所有线程都遵循自旋锁协议，这种情况就不会发生。）*

如果锁可用（已发出信号）`m_s`，则值为 1。当被某个线程占用时，它的值为 0。不允许使用其他值。

考虑一个想要锁的线程，不管它是否在调用线程的那一刻发出信号`Enter()`并不重要。如果`m_s`为 1，则允许获取锁，并且通过将其更改为 0 来获取。发生这种情况的第一次迭代会导致循环退出并且线程拥有锁。

现在考虑两个需要相同锁的线程。两者都在调用`TestAndSet()`，等待看到值 1 变为 0。因为函数`TestAndSet()`是原子的，所以只有一个等待线程可以看到值 1。所有其他线程只能看到`m_s`0，并且必须继续等待。

在此线程中将其设置为 0 后为 1的条件`m_s`意味着在原子操作和条件之间有其他线程发出信号。由于一次只有一个线程应该拥有锁，~~因此似乎不应该发生~~而不能发生。

我猜这是为了满足自旋锁的不变承诺。*（编辑：我不再那么确定了，下面有更多...）*如果它被持有，则 的值`m_s`必须为零。如果不是，它就是一个。如果将其设置为零并没有“坚持”，那么就会发生一些奇怪的事情，最好不要假设当不变量不正确时它现在由该线程持有。

**编辑：** Jon Skeet 指出这种情况可能是原始实现中的一个缺陷。我怀疑他是对的。

被保护的竞争条件是针对**无权发出 spinlock 信号的**线程，无论如何都会发出 spinlock 信号。如果您不能相信调用者会遵守规则，那么自旋锁可能不是首选的同步方法，毕竟。

**编辑 2：**提议的修订看起来好多了。这显然会避免原来由于总是写 sentinel 而产生的多核缓存一致性交互`m_s`。

在阅读了[TATAS 协议](http://en.wikipedia.org/wiki/Test_and_Test-and-set)（如果你注意的话，你每天都可以学到新的东西......）和它正在解决的多核缓存一致性问题之后，我很清楚原始代码试图做类似的事情，但是不了解其背后的微妙之处。在编写时删除冗余检查确实是安全的（假设所有调用者都遵守规则）`m_s`。但是代码会`m_s`在每次循环迭代时写入，这会对真正的多核芯片造成严重破坏，每个核心都有缓存。

新的自旋锁仍然容易受到第二个线程释放它而不持有它的影响。没有办法修复它。我之前关于信任调用者遵循协议的主张仍然适用。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2009-03-28T13:44:48.900

除了 2 之外，您的所有版本都是正确的。此外，您对`m_s==0`版本 1 中的检查和版本 3 中性能降低的评论是正确的。

减少的原因是 T&S 的实现方式，特别是它会导致每次调用都写入。这是因为一次写入（即使它实际上并没有改变 的数据`m_s`）或写入意图会导致其缓存行在其他 CPU 上失效，这意味着当另一个 CPU（也在等待同一个锁）测试时`m_s`，它无法从其缓存中读取数据，但必须从之前拥有它的 CPU 中获取数据。这种现象被称为缓存乒乓球，类似于乒乓球比赛，球（在这种情况下是缓存线的数据）在球员（CPU）之间不断移动。如果您在 T&S 之前添加额外的测试，CPU 将全部读取，这意味着它们都可以将数据保存在缓存中（即共享），直到有人写入为止。

这发生在版本 1 和 3 中，因为它们在循环的每次迭代中运行 T&S。

请注意，关于防止其他线程错误地释放它的额外检查的评论具有误导性，不是因为其他线程不能这样做，而是因为这样的检查不能防止这种可能性，即使是远程的。想象一下，另一个线程执行它，但就在锁定线程执行检查之后。如果你真的想保护自己免受这种破坏，你应该添加另一个变量，例如。持有锁的线程 ID，并用它检查锁的正确操作。

另一个问题是，在某些架构上，您需要内存屏障来确保良好的内存排序，特别是确保`m_s`测试每次都实际读取该值（这里一些编译器屏障应该足够了）并且任何读取（如果您愿意，也可以写入）发生在关键部分内的事件不会“泄漏”，也就是说，在获取实际锁定之前不会由 CPU 执行。解锁必须以类似方式处理。请注意，Jon Skeet 的版本在这方面是正确的，因为他使用 Java（或 C#？我不确定，但它们的语义应该相似）`volatile`。

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2009-03-27T07:28:05.337

实际上，有人可能会在test in之后和之前从另一个线程调用`TestAndSet(&m_s, 1)`ie 。这样就不会获得锁并且不会等于。因此需要这样的检查。`Leave()``TestAndSet(&m_s, 0)``if``Enter()``m_s``0`

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2009-10-23T15:26:56.660

这些示例在排序不那么严格的硬件上都不一定正确。PowerPC 和 IA64 就是两个这样的例子，在获取锁的 test 和 set 操作中需要 isync 和 .acq 操作（类似地，出口中的 lwsync 和 .rel 操作）。

# html - 转换嵌入在 html 中的 xml

> ID：688786
> 
> 赞同：1
> 
> 时间：2009-03-27T07:03:21.387
> 
> 标签：html, xml, xslt

假设我在 html 文档中有 xml，例如

```
<html>
  <body>
     <xml>
        <foo>
          <bar />
          <baz />
        </foo>
     </xml>
   </body>
 </html> 
```

将 xslt 应用于 xml 节点的最佳方法是什么？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-03-28T22:18:23.580

您可以将文件保存为 XML 文件，并在同一目录中使用单独的 XSL 文件，然后在 XML 文件中，将其链接到 XSL 文件：

```
<?xml version = '1.0'?>
<?xml-stylesheet href="myfunkystyle.xsl" type="text/xsl"?>
<ROWSET>
   <ROW>
      <!-- etc. -->
    </ROW> 
</ROWSET> 
```

IE 和 Firefox 都会通过转换来显示 XML 文件。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-06-22T17:21:41.967

[Emle - 电子数学实验室设备](http://emle.sourceforge.net/emle020406/emle_index.html)Javascript 文件[emle_lab.js](http://emle.sourceforge.net/emle020406/emle_lab.js)使用 parseFromString() 从字符串创建文档：

```
 var inputText = '<?xml version="1.0" encoding="UTF-8"?>' +
    '<emle xmlns="http://emle.sf.net/emle02">' +
    '  <lab refid="' + aLabId + '"></lab>' +
    '</emle>';
  var inputDoc = new DOMParser().parseFromString(inputText, "application/xml"); 
  var xsltDoc = jQuery.ajax({type: "GET", url: 'emle_lab.xsl', async: false}).responseXML; 
  var processor = new XSLTProcessor();
  processor.setParameter(null, 'emleLang',  aLang);
  processor.importStylesheet(xsltDoc);
  var outputDoc = processor.transformToDocument(inputDoc.firstChild); 
```

# html - IE6 中的 PNG 透明度 - 需要有关“如何为样式表应用 hack”的帮助

> ID：688798
> 
> 赞同：0
> 
> 时间：2009-03-27T07:13:50.643
> 
> 标签：html, css, stylesheet

我正在尝试为我的表格应用 css，如以下链接中给出的示例“9.Table Background”所示。

[http://www.smashingmagazine.com/2008/08/13/top-10-css-table-designs/](http://www.smashingmagazine.com/2008/08/13/top-10-css-table-designs/)

它在 IE-7 和火狐中运行 finr。

指定了该示例的注释 - “如果不应用 hack，IE 6 用户将看不到透明背景”。

任何人都可以帮助我应用 hack 并使示例在 ie-6 中工作。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-03-27T07:29:23.880

该 hack 是针对不支持 PNG 图像中的 alpha（透明度）通道的早期版本的 IE 的一种解决方法。我不会从别人那里窃取荣耀，而是向您指出一些解释这一点的帖子：

[http://www.komodomedia.com/blog/2007/11/css-png-image-fix-for-ie/](http://www.komodomedia.com/blog/2007/11/css-png-image-fix-for-ie/)

[http://www.scriptingmagic.com/Topics/IE%20Specific/PNG%20Transparency/](http://www.scriptingmagic.com/Topics/IE%20Specific/PNG%20Transparency/)

或者，谷歌“IE6 PNG CSS HACK”了解更多...

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-03-27T09:43:48.240

有一篇关于 PNG 不透明度的很棒的文章在一个单独的列表中。

[http://www.alistapart.com/stories/pngopacity/](http://www.alistapart.com/stories/pngopacity/)

此 JS 脚本为 IE 5.5 和 6 添加了具有 alpha 不透明度的接近原生 PNG 支持。

[http://www.twinhelix.com/css/iepngfix/](http://www.twinhelix.com/css/iepngfix/)

# pointers - dword ptr 用法混乱

> ID：688799
> 
> 赞同：18
> 
> 时间：2009-03-27T07:14:44.680
> 
> 标签：pointers, assembly, x86, masm, dword

如果我们使用汇编语言

```
mov eax, dword ptr[ebx] 
```

那么就是复制ebx指向的值（ebx包含的是地址值，不是实际值，这条指令复制的是地址中的实际值）？

如果我们使用

```
mov eax, dword ptr[some_variable] 
```

那么这意味着将变量“some_variable”本身的值复制到eax，而不是复制变量“some_variable”指向的值？

我的理解正确吗？

如果是，我很困惑为什么相同的汇编指令有两种不同的含义——在第一种情况下有一个间接级别，但在第二种情况下没有额外的间接级别。

任何意见？

编辑：

并非每个 [] 都不会产生任何影响，例如，指令 xchg 将采用一个间接级别，它加载 edx 指向的值。

可以从以下位置找到完整的源代码，

[http://www.codeproject.com/KB/threads/spinlocks.aspx](http://www.codeproject.com/KB/threads/spinlocks.aspx)

```
#ifdef WIN32
inline int CPP_SpinLock::TestAndSet(int* targetAddress, int nValue)
{
    __asm {
        mov edx, dword ptr [pTargetAddress]
        mov eax, nValue
        lock xchg eax, dword ptr [edx]
    }
}
#endif // WIN32 
```

* * *

## 回答 #1

> 赞同：12
> 
> 时间：2009-03-27T07:27:55.133

在这两种情况下，您都要求处理器从指定地址移动值。这是一级间接。在第一种情况下，您要求它从指定的寄存器中获取地址。在第二种情况下，您直接指定偏移量。

x86 处理器不支持双层间接，因此无法请求从内存中某处指定的地址加载值 - 您必须将地址加载到寄存器中。

在许多汇编器（例如 MASM 和内置于 VC++ 汇编器中）下，您也可以只写

```
mov eax, dword ptr some_variable 
```

没有括号，意思是一样的。

你可以写

```
mov eax, dword ptr [variable][ebx] 
```

这将指示获取“变量”的地址，然后添加 ebx 的值并将总和用作从中加载值的地址。这通常用于按索引访问数组元素。（支持语法的变化，例如`mov eax, dword ptr variable[ebx]`常用的和`mov eax, dword ptr [variable + ebx]`常用的。）

在所有这些情况下，处理器都会做同样的事情——从指定的地址加载一个值。每次都是一个间接级别。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2019-12-28T03:53:38.300

我的理解，汇编中的括号（`[]`）是`pointer`这样的指令：

`mov eax, dword ptr[some_variable]`

它将值从`some_variable` 指向`eax`和复制到此示例：

`mov eax, dword ptr some_variable`

一样的……但是？我猜它受`dword`. 如果您有兴趣，可以从头开始编写，例如使用 NASM 语法：

`mov eax, dword [some_variable]`

# c++ - C++ 方法名称可以在标头中由类名称限定吗？

> ID：688802
> 
> 赞同：4
> 
> 时间：2009-03-27T07:17:19.947
> 
> 标签：c++, syntax, declaration, classname

简单的问题，这是有效的 C++：

```
class Foo
{
    void Foo::doSomething();
}; 
```

*问题的重点：在*类声明中重复使用类名和方法名之前的双冒号是否有效？

我在使用 g++ 4.2.3 编译执行此操作的代码时遇到问题。在深入研究和更改代码之前，我希望看到对此处描述语法的内容的引用。或者降级编译器；这确实使用 g++ 3.3.6 构建。

我得到的错误是（大致）：

```
Foo.h:3: error: extra qualification ‘Foo::’ on member ‘doSomething’ 
```

我做了谷歌，但想不出什么。我没有标准，即使我这样做了，我也可能需要很长时间才能找到权威的东西。我不是 C++ 语言律师。

* * *

## 回答 #1

> 赞同：18
> 
> 时间：2009-03-27T07:46:15.977

我看了一下标准，第 9.2 节将是相关部分。我对 BNF 不是很好，但我在 BNF 中没有看到任何关于班级成员的信息表明这是允许的。该标识符在 BNF 中甚至被命名为“unqualified-id”。

G++ 在 4.1 版本中改变了这种行为，显然很多其他编译器都接受了这一点，但我从未见过这种风格被使用过，我也不知道为什么有人会这样做。由于它似乎不会在各种各样的编译器上触发错误，这种风格可能有一些历史原因，但据我所知，它确实是无效的。

我通过谷歌找到的唯一好的参考是[这个页面](http://womble.decadentplace.org.uk/c++/syntax-errors.html)，它只是试图解释 G++ 4.1 中的一些变化。

* * *

## 回答 #2

> 赞同：5
> 
> 时间：2009-03-27T09:12:05.243

像丹一样，我查看了标准，但没有确定的结果。[我使用Comeau 的在线编译器](http://www.comeaucomputing.com/tryitout/)（被认为是世界上最符合标准的）尝试了您的代码，并得到：

> 第 3 行：错误：成员声明中不允许使用限定名称

如果您有兴趣更进一步，我建议在[comp.lang.c++.moderated](http://groups.google.com/group/comp.lang.c++.moderated/topics?pli=1)新闻组上发布一个问题，因为那里的 C++ 语言律师比这里多得多。

# vm-implementation - 基于寄存器的虚拟机如何工作？

> ID：688803
> 
> 赞同：11
> 
> 时间：2009-03-27T07:17:23.787
> 
> 标签：vm-implementation

基于寄存器的虚拟机如何工作？我正在寻找有关基于寄存器的虚拟机如何工作的介绍。有人可以帮忙吗？

谢谢你。

* * *

## 回答 #1

> 赞同：14
> 
> 时间：2009-03-27T07:41:33.867

[Lua](http://www.lua.org/)是具有可用源代码的基于寄存器的 VM 的一个示例。有许多资源可能会有所帮助...

*   [Lua 5.0 的实现](http://www.tecgraf.puc-rio.br/~lhf/ftp/doc/jucs05.pdf)来自 Lua 本身的作者。
*   [LuLu](http://lulu.luaforge.net/)用 Lua 实现的 Lua VM，与日文博客配套。
*   [Lua 5.1 VM 指令的简单介绍，](http://luaforge.net/docman/view.php/83/98/ANoFrillsIntroToLua51VMInstructions.pdf)来自 Lua 社区的频繁贡献者。

# iphone - 如何为 iPhone 分发证书创建私钥？

> ID：688809
> 
> 赞同：17
> 
> 时间：2009-03-27T07:20:26.790
> 
> 标签：iphone, certificate, distribution, private-key

在 iPhone Developer Program Portal 中，有一个视频演示如何创建开发证书并分配私钥

现在我已经完成了开发过程并开始分发

我已经创建了一个“分发证书”，但是如何为这个证书分配一个私钥？

编译时出现“CodeSign 错误：代码签名身份'...'与钥匙串中的任何代码签名证书都不匹配”

如果我需要将私钥分配给分发证书以及如何分配，我很高兴现在让我这样做。

请注意，我在这里不是在谈论开发证书，谢谢。

* * *

## 回答 #1

> 赞同：37
> 
> 时间：2012-11-21T12:49:58.350

由于没有人更新或回答这个问题，因为内森指出原始答案链接不可用（在 stackoverflow 上发布的第一点“请务必*回答问题*”）这是我的经验的答案，希望它对某人有所帮助：

对于这个特定的问题（安装了开发/分发证书但没有私钥），答案是选择 2 个选项：

**1\. 通过苹果开发者门户创建一个新的证书身份** 在这种情况下，您需要登录苹果开发者门户并使用助手，作为其中的一部分，您需要创建并上传一个 CSR（证书签名请求）还将在机器上创建公钥和私钥。苹果签署了请求，瞧，一个签署的公共/私人证书对：[参考](https://appmakr.zendesk.com/entries/175966-how-to-create-and-upload-your-private-key-p12-into-your-appmakr-developer-account)

**2.从最初用于创建证书的机器中导出私钥** 这种情况是当您使用先前创建的身份进行签名时，可能是在旧机器上，或者如果（在我的情况下）您为已经拥有其 ID 的客户进行开发创建的。如果您无法访问最初用于创建证书身份的机器，则必须按照指南/助手创建一个新身份。

为此，您需要通过 Keychain Access 导出您的私钥（一个 .p12 文件）或公钥/私钥对，并将私钥或密钥对安装到您开发的机器上。这是我在 stackoverflow 上找到的[指南。](https://stackoverflow.com/questions/1861360/two-macs-one-iphone-developer-license-possible)

参考：http: [//iphonedevsdk.com/forum/iphone-sdk-development/11498-problems-exporting-importing-p12-private-key-for-developing-on-another-mac.html](http://iphonedevsdk.com/forum/iphone-sdk-development/11498-problems-exporting-importing-p12-private-key-for-developing-on-another-mac.html)

PS>请注意，我现在正在执行后一个选项，虽然有证据表明这会起作用，但我尚未对其进行测试，如果不起作用，我将重新回复！

* * *

## 回答 #2

> 赞同：5
> 
> 时间：2009-03-27T07:27:45.600

阅读 Xcode 帮助站点的[维护签名资产](https://help.apple.com/xcode/mac/current/#/dev3a05256b8)部分。它以正确的顺序逐步解释了您需要做什么。

> 在对应用程序进行代码签名之前，您需要创建开发证书，然后再创建分发证书以将应用程序上传到 iTunes Connect。您可以使用 Xcode 创建所需的所有类型的证书和签名身份。Xcode 为您创建、下载和安装您的签名身份。
> 
> 所有团队成员都可以创建自己的开发证书。只有团队代理或管理员可以创建分发证书。只有团队代理可以创建 Developer ID 证书。如果您拥有组织成员资格，请阅读在成员中心管理您的团队，了解团队代理代表团队成员执行的团队角色和任务的描述。
> 
> Xcode 在您需要时为您创建开发证书。例如，当您将项目分配给团队或创建团队配置文件时，如配置身份和团队设置中所述，Xcode 会创建您的开发证书并将其添加到团队配置文件中。因此，您通常使用 Xcode Preferences 窗口创建分发证书。
> 
> **创建签名身份**
> 
> 1.  在 Xcode 首选项窗口中，单击帐户。
>     
>     
> 2.  选择您要使用的团队，然后单击查看详细信息。
>     
>     
> 3.  在出现的对话框中，单击要创建的证书类型所在行中的创建按钮。
>     
>     
>     
>     如果禁用创建按钮，则不允许您创建该类型的签名身份。各类证书的说明请参见表 14-2。
>     
>     
>     
>     创建签名身份后，创建按钮消失。
>     
>     
> 4.  要返回帐户首选项，请单击完成。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-01-17T01:27:49.333

对我来说 - 重新启动 Xcode 解决了这两个问题。
一切显然都在某处正确设置，但需要刷新/同步。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2016-11-29T04:51:59.723

如果您将鼠标悬停在图像上并单击红色的小删除图标，然后保存它。离开并返回此页面，您将能够再次添加图标。

# linq-to-sql - linq imultipleresults - 迭代结果

> ID：688813
> 
> 赞同：0
> 
> 时间：2009-03-27T07:21:14.540
> 
> 标签：linq-to-sql

快速提问，

我调用了一个 sproc，它可以返回任意数量的相同结果集。

我有一个循环，它知道一次要返回多少个，这很好用。

在循环内部，它使用 getresult() 并将数据转换为指定的类型 say 。这似乎可行，但是当在通过 BAL 到 UI 的页面上显示数据时，我得到一个奇怪的错误代码 500 的 JavaScript 错误。

经过调试我发现它与结果转换为类型有关。

该类型是我自己添加的类型，其中有不映射到架构中任何实体的列。这会导致问题吗？

总的来说，我对 linq 感到非常沮丧，我认为它应该工作的地方非常耗时......它没有！

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2009-03-27T07:26:46.900

如果您收到 500 的 JavaScript 错误代码，这是内部服务器错误，这对我来说是 AJAX。那么你能展示你用来获取数据的代码吗？您是否使用 WCF，静态页面方法。您是否在用于获取数据的服务器端方法上记录异常？

# c# - C# CA2104 - 自动代码分析不喜欢静态只读可变类型

> ID：688818
> 
> 赞同：4
> 
> 时间：2009-03-27T07:24:45.843
> 
> 标签：c#, visual-studio-2008, code-analysis

我有这样的代码：

```
public abstract class Base
{
    // is going to be used in deriving classes
    // let's assume foo is threadsafe
    protected static readonly Foo StaticFoo = new Foo();
} 
```

Visual Studio 2008 的代码分析弹出此消息：

> `CA2104 : Microsoft.Security : Remove the read-only designation from 'Base.StaticFoo' or change the field to one that is an immutable reference type. If the reference type 'Foo' is, in fact, immutable, exclude this message.`

我的设计是否存在内在缺陷，或者我可以`[SuppressMessage]`在源代码中添加一个？

* * *

## 回答 #1

> 赞同：8
> 
> 时间：2009-03-27T07:37:34.173

问题在于它给人的印象是错误的——它看起来像值不能改变，而实际上只有*字段*值不能改变，而不是对象。我认为这里的代码分析过于谨慎 - 有很多地方您可能希望将可变类型存储在只读字段中，特别是如果它是私有的，在静态初始化程序中初始化，然后在您的代码中从未发生变异。

然而，虽然该字段受到保护，但派生类滥用它的风险更大。就我个人而言，我喜欢我所有的领域都是私有的。另一方面，我不知道您的代码 - 可能是您已经权衡了可能性并认为这是正确的做法。

如果`Foo`真的是线程安全的，那么除了字段是只读的这一事实所给出的不变性的一般印象之外，就不用担心了。我将禁用该行的警告，并添加注释以强调该对象是可变的，即使该字段是只读的。

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2009-03-27T07:36:06.207

Foo 类型是不可变的吗？

如果不是，您是否打算只使用这一个 Foo 对象，但能够更改其属性？如果是这种情况，那么警告只是说 readonly 关键字具有误导性。没有编译错误 - 对对象的引用是只读的，这就是您向编译器声明的内容。但是，您向其他开发人员声明的是 StaticFoo 是只读的，这意味着它永远不会改变。

所以，正如它所说，你有一个选择。要消除此警告，请删除只读关键字，或添加 SuppressMessage 属性。或者，查看代码的设计。例如，将 Foo 实现为单例模式是否更合适？

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2009-03-27T07:34:24.370

警告告诉您，`readonly`修饰符仅适用于引用本身。如果`Foo`是引用类型，则`Foo`实例的状态仍可能会被修改，除非您确保`Foo`它是不可变的。

在另一个节点上，当涉及到对代码进行单元测试时，像这样的静态可能最终会给您带来各种问题，因此如果这对您很重要，您可能想看看其他方法来实现您想要做的事情.

# linq-to-sql - 使用不同的 SQL 用户部署 LINQ to SQL 库

> ID：688819
> 
> 赞同：1
> 
> 时间：2009-03-27T07:25:06.917
> 
> 标签：linq-to-sql, connection-string

感谢这个网站，我成功地使用了在 web.config 中本地化的连接字符串，而不是在库的 app.config 中提供的连接字符串。但是我的生产和测试 SQL Server 没有相同的 SQL 用户名。

```
Table(Name="SqlUserName.tableName")]
public partial class tableName : INotifyPropertyChanging, INotifyPropertyChanged
{
    ...
} 
```

当我在表名之前手动删除用户名时，它正在工作。但我仍然有问题：

1.  这样做好吗？也许有一个我不知道的潜在缺陷。
2.  如果这是一个好的行为，我该如何在某处配置它？每次 LINQ 将重新生成 dbml，我都会放弃我的修改。我认为我不能将它移动到部分类，因为它是一个属性并且不能重新定义（我也不想对所有表都这样做）。

谢谢你的帮助。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2009-10-20T13:20:33.907

对 web.config 本地和远程服务器中的连接字符串使用相同的名称，但使用不同的用户名和密码。

我遵循这种做法，它非常适合我。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-08-04T04:22:01.540

最后，我为我创建的所有表使用了 dbo 模式，这样我删除了对用户的依赖，LINQ 可以再次生成 DBML 而不会破坏部署：

```
Table(Name="dbo.tableName")]
public partial class tableName : INotifyPropertyChanging, INotifyPropertyChanged
{
    ...
} 
```

# eclipse - 为什么安装/更新在 Eclipse 的帮助菜单中“隐藏”？

> ID：688829
> 
> 赞同：2
> 
> 时间：2009-03-27T07:29:38.857
> 
> 标签：eclipse

这只是讨论的主题，没有什么重要的。

有人能告诉我为什么安装/更新功能放在 Eclipse 的帮助菜单中吗？我觉得这不是非常用户友好和直观的，这对我来说似乎有点不合逻辑。

是因为出于某种原因它应该在那里，还是因为用户已经习惯了它，或者因为它只是 Eclipse 的传奇和典型 ;-) ？

编辑：好的，我可以理解，如果你查看帮助 - > 关于，你可以在那里看到应用程序版本，所以也许你想获得一个更新的.. 但是插件呢？其他应用程序通常在工具菜单或类似的东西中有一些插件管理器

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-03-27T07:42:08.343

这实际上是很常见的将更新选项放在帮助中。Firefox 这样做，许多其他应用程序也是如此。我不知道为什么这会出现在帮助中，而不是像有时那样出现在“工具”菜单中。也许这个想法是“帮助这不起作用”，也许更新将“解决”问题。我认为这是值得商榷的。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-03-27T08:59:22.993

老兄，

如果您对 Eclipse 有一些认真的反馈并且想要有所作为，我建议您在[Bugzilla](https://bugs.eclipse.org/bugs/)中打开一个缺陷。Eclipse 团队非常细心并且乐于接受建议。顺便说一句，您还可以使用 Mylyn 插件从 Eclipse 中打开和查找缺陷。从“计划”的角度开始。

# c - 更改字符串

> ID：688830
> 
> 赞同：1
> 
> 时间：2009-03-27T07:30:44.877
> 
> 标签：c, strstr

我正在使用 Linux GCC c99。

我想知道什么是最好的技术。改变一个字符串。我正在使用 strstr();

我有一个名为“file.vce”的文件名，我想将扩展名更改为“file.wav”。

这是最好的方法吗：

```
char file_name[80] = "filename.vce";
char *new_file_name = NULL;
new_file_name = strstr(file_name, "vce");
strncpy(new_file_name, "wav", 3);
printf("new file name: %s\n", new_file_name);
printf("file name: %s\n", file_name); 
```

非常感谢您的任何建议，

* * *

我使用您的建议编辑了我的答案。你还能看出什么不妥吗？

```
/** Replace the file extension .vce with .wav */
void replace_file_extension(char *file_name)
{
    char *p_extension;

    /** Find the extension .vce */
    p_extension = strrchr(file_name, '.');
    if(p_extension)
    {
        strcpy(++p_extension, "wav");
    }
    else
    {
        /** Filename did not have the .vce extension */
        /** Display debug information */
    }
}

int main(void)
{
    char filename[80] = "filename.vce";

    replace_file_extension(filename);

    printf("filename: %s\n", filename);
    return 0;
} 
```

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2009-03-27T07:41:35.973

有几个问题：

```
char file_name[80] = "filename.vce";
char *new_file_name = NULL;
new_file_name = strstr(file_name, "vce");
strncpy(new_file_name, "wav", 3);
printf("new file name: %s\n", new_file_name);
printf("file name: %s\n", file_name); 
```

只有一个字符串的存储空间，但最后您尝试打印两个不同的字符串。

命名的变量`new_file_name`实际上指向同一文件名的一部分。

字符串 vce 可能出现在文件名中的任何位置，而不仅仅是扩展名。如果文件名是`srvce.vce`怎么办？

您可能想找到最后一个 . 字符串中的字符，然后检查它后面是否有预期的扩展名，然后替换该扩展名。请记住，如果您通过修改原始缓冲区来执行此操作，则之后您将无法打印旧字符串。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2009-03-27T11:51:51.253

而不是搜索 . 或者 vce 其中任何一个都可能在字符串中出现多次，计算字符串的长度并减去 3 以指向扩展名。使用 strncpy 就地替换扩展。

```
size_t length;
char* pextension;
char file_name[80] = "filename.vce";
printf("file name: %s\n", file_name);    
length = strlen(file_name);
pextension = file_name + length - 3;
strncpy(pextension, "wav", 3);
printf("new file name: %s\n", file_name); 
```

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2009-03-27T07:34:49.920

您必须在末尾手动添加零终止符，`new_file_name`因为`strncpy()`在您的情况下不会添加它。

碰巧你已经在正确的地方有零字节，但不能在所有情况下都保证，所以做这样的事情是一个好习惯

```
new_file_name[3] = '\0'; 
```

之后`strncpy()`。

还要注意字符串“vce”可能出现在文件名中。

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2009-03-27T07:51:31.770

您的代码存在一些问题。这是一个不同的看法，更改是内联注释的：

```
char file_name[80] = "filename.vce";
char *new_file_name = NULL;

printf("old file name: '%s'\n", file_name);
/* Use strrstr(), to find the last occurance, and include the period. */
new_file_name = strrstr(file_name, ".vce");
if(new_file_name != NULL)
{
  /* Use plain strcpy() to make sure the terminator gets there.
   * Don't forget the period.
  */
  strcpy(new_file_name, ".wav");
}
printf("new file name: '%s'\n", file_name); 
```

这仍然可以改进，例如，它不会检查是否有足够的空间来包含新的扩展。但它确实以比戳单个字符更自然的方式终止了字符串。

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2009-03-27T11:15:40.937

我会这样做

```
char file_name[80] = "filename.vce";
char *pExt;

pExt = strrchr(file_name, ".");
if( pExt )
  strcpy(++pExt, "wav");
else
{
 // hey no extension
}
printf("file name: %s\n", file_name); 
```

您需要在每个 c 程序中进行指针操作。当然你会做更多的检查缓冲区运行等，甚至使用路径特定的功能。

* * *

## 回答 #6

> 赞同：1
> 
> 时间：2009-03-27T12:38:49.147

我很无聊，我没有指出原始代码中的问题，而是编写了自己的代码。出于指导目的，我试图保持清晰。

```
#include <stdio.h>
#include <string.h>
#include <stdlib.h>

/* Replace the last suffix in a filename with a new suffix. Copy the new
   name to a new string, allocated with malloc. Return new string. 
   Caller MUST free new string.

   If old name has no suffix, a period and the new suffix is appended
   to it. The new suffix MUST include a period it one is desired.

   Slashes are interepreted to separate directories in the filename.
   Suffixes are only looked after the last slash, if any.

   */
char *replace_filename_suffix(const char *pathname, const char *new_suffix)
{
    size_t new_size;
    size_t pathname_len;
    size_t suffix_len;
    size_t before_suffix;
    char *last_slash;
    char *last_period;
    char *new_name;

    /* Allocate enough memory for the resulting string. We allocate enough
       for the worst case, for simplicity. */
    pathname_len = strlen(pathname);
    suffix_len = strlen(new_suffix);
    new_size = pathname_len + suffix_len + 1;
    new_name = malloc(new_size);
    if (new_name == NULL)
        return NULL;

    /* Compute the number of characters to copy from the old name. */
    last_slash = strrchr(pathname, '/');
    last_period = strrchr(pathname, '.');
    if (last_period && (!last_slash || last_period > last_slash))
        before_suffix = last_period - pathname;
    else
        before_suffix = pathname_len;

    /* Copy over the stuff before the old suffix. Then append a period
       and the new suffix. */
#if USE_SPRINTF
    /* This uses snprintf, which is how I would normally do this. The
       %.*s formatting directive is used to copy a specific amount
       of text from pathname. Note that this has the theoretical
       problem with filenames larger than will fit into an integer. */
    snprintf(new_name, new_size, "%.*s%s", (int) before_suffix, pathname,
             new_suffix);
#else
    /* This uses memcpy and strcpy, to demonstrate how they might be
       used instead. Much C string processing needs to be done with
       these low-level tools. */
    memcpy(new_name, pathname, before_suffix);
    strcpy(new_name + before_suffix, new_suffix);
#endif

    /* All done. */
    return new_name;
}

int main(int argc, char **argv)
{
    int i;
    char *new_name;

    for (i = 1; i + 1 < argc; ++i) {
        new_name = replace_filename_suffix(argv[i], argv[i+1]);
        if (new_name == NULL) {
            perror("replace_filename_suffix");
            return EXIT_FAILURE;
        }
        printf("original: %s\nsuffix: %s\nnew name: %s\n",
               argv[i], argv[i+1], new_name);
        free(new_name);
    }
    return 0;
} 
```

# asp.net - 在回发中允许 html 标签

> ID：688832
> 
> 赞同：1
> 
> 时间：2009-03-27T07:31:12.253
> 
> 标签：asp.net, html

我有一个文本框，用户可以在其中输入包含 html 标记的文本。

当然，当页面执行任何涉及回发的操作时，它会中断（错误 500），因为解析器认为文本框中的 html 代码是黑客尝试。

现在，我知道有办法允许它，但我不能为我的生活记住。

帮助？

我正在使用 Visual Studio 2008、VB.NET，以防万一。

享受随机

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2009-03-27T07:36:14.927

在页面顶部：

```
<%@ Page ValidateRequest='False' %> 
```

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2009-03-27T07:36:18.060

我相信在您的页面指令中设置“ValidateRequest=False”应该可以解决它。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2009-03-27T07:39:17.930

您可以禁用请求验证：

```
<%Page Language="C#" validateRequest="false" %> 
```

或在将表单发布到服务器之前在客户端对 HTML 标记进行编码。

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2009-03-27T07:46:55.960

您可以通过禁用 validaterequest 来解决此问题

# bash - Shell 脚本中的关联数组

> ID：688849
> 
> 赞同：131
> 
> 时间：2009-03-27T07:37:40.507
> 
> 标签：bash, shell, hashtable, associative-array

我们需要一个脚本来模拟关联数组或类似于 Shell 脚本的 Map 数据结构，任何主体？

* * *

## 回答 #1

> 赞同：170
> 
> 时间：2009-03-27T19:22:19.177

如果可移植性不是您主要关心的问题，另一种选择是使用内置于 shell 的关联数组。这应该可以在 bash 4.0（现在在大多数主要发行版上可用，但在 OS X 上不可用，除非您自己安装）、ksh 和 zsh：

```
declare -A newmap
newmap[name]="Irfan Zulfiqar"
newmap[designation]=SSE
newmap[company]="My Own Company"

echo ${newmap[company]}
echo ${newmap[name]} 
```

根据外壳，您可能需要执行 a`typeset -A newmap`而不是`declare -A newmap`，或者在某些情况下可能根本不需要。

* * *

## 回答 #2

> 赞同：108
> 
> 时间：2010-12-14T22:14:23.170

另一种非 bash 4 方式。

```
#!/bin/bash

# A pretend Python dictionary with bash 3 
ARRAY=( "cow:moo"
        "dinosaur:roar"
        "bird:chirp"
        "bash:rock" )

for animal in "${ARRAY[@]}" ; do
    KEY=${animal%%:*}
    VALUE=${animal#*:}
    printf "%s likes to %s.\n" "$KEY" "$VALUE"
done

echo -e "${ARRAY[1]%%:*} is an extinct animal which likes to ${ARRAY[1]#*:}\n" 
```

你也可以抛出一个 if 语句来在那里搜索。如果 [[ $var =~ /blah/ ]]。管他呢。

* * *

## 回答 #3

> 赞同：35
> 
> 时间：2009-03-27T18:46:41.680

我认为您需要退后一步，想想地图或关联数组到底是什么。它只是一种为给定键存储值并快速有效地取回该值的方法。您可能还希望能够遍历键以检索每个键值对，或删除键及其关联值。

现在，考虑一下您在 shell 脚本中一直使用的数据结构，甚至只是在不编写脚本的 shell 中使用，它具有这些属性。难倒？这是文件系统。

真的，在 shell 编程中你需要一个关联数组就是一个临时目录。`mktemp -d`是您的关联数组构造函数：

```
prefix=$(basename -- "$0")
map=$(mktemp -dt ${prefix})
echo >${map}/key somevalue
value=$(cat ${map}/key) 
```

如果您不想使用`echo`and `cat`，您可以随时编写一些小包装器；这些是根据 Irfan 建模的，尽管它们只是输出值而不是设置任意变量，例如`$value`：

```
#!/bin/sh

prefix=$(basename -- "$0")
mapdir=$(mktemp -dt ${prefix})
trap 'rm -r ${mapdir}' EXIT

put() {
  [ "$#" != 3 ] && exit 1
  mapname=$1; key=$2; value=$3
  [ -d "${mapdir}/${mapname}" ] || mkdir "${mapdir}/${mapname}"
  echo $value >"${mapdir}/${mapname}/${key}"
}

get() {
  [ "$#" != 2 ] && exit 1
  mapname=$1; key=$2
  cat "${mapdir}/${mapname}/${key}"
}

put "newMap" "name" "Irfan Zulfiqar"
put "newMap" "designation" "SSE"
put "newMap" "company" "My Own Company"

value=$(get "newMap" "company")
echo $value

value=$(get "newMap" "name")
echo $value 
```

**编辑**：这种方法实际上比提问者建议的使用 sed 的线性搜索要快得多，而且更健壮（它允许键和值包含 -、=、空格、qnd“:SP:”）。它使用文件系统的事实并没有使它变慢。除非您调用，否则这些文件实际上永远不会保证写入磁盘`sync`；对于像这样生命周期很短的临时文件，它们中的许多可能永远不会写入磁盘。

我使用以下驱动程序对 Irfan 的代码、Jerry 对 Irfan 代码的修改和我的代码进行了一些基准测试：

```
#!/bin/sh

mapimpl=$1
numkeys=$2
numvals=$3

. ./${mapimpl}.sh    #/ <- fix broken stack overflow syntax highlighting

for (( i = 0 ; $i < $numkeys ; i += 1 ))
do
    for (( j = 0 ; $j < $numvals ; j += 1 ))
    do
        put "newMap" "key$i" "value$j"
        get "newMap" "key$i"
    done
done 
```

结果：

```
    $ 时间 ./driver.sh irfan 10 5

    实际0m0.975s
    用户 0m0.280s
    系统 0m0.691s

    $ 时间 ./driver.sh 布赖恩 10 5

    实际0m0.226s
    用户 0m0.057s
    系统 0m0.123s

    $ 时间 ./driver.sh 杰里 10 5

    实际0m0.706s
    用户 0m0.228s
    系统 0m0.530s

    $ 时间 ./driver.sh irfan 100 5

    真正的 0m10.633s
    用户 0m4.366s
    系统 0m7.127s

    $ 时间 ./driver.sh 布赖恩 100 5

    真实0m1.682s
    用户 0m0.546s
    系统 0m1.082s

    $ 时间 ./driver.sh 杰里 100 5

    真正的 0m9.315s
    用户 0m4.565s
    系统 0m5.446s

    $ 时间 ./driver.sh irfan 10 500

    真正的 1m46.197s
    用户 0m44.869s
    系统 1m12.282s

    $ 时间 ./driver.sh 布赖恩 10 500

    真正的 0m16.003s
    用户 0m5.135s
    系统 0m10.396s

    $ 时间 ./driver.sh 杰里 10 500

    实际 1m24.414s
    用户 0m39.696s
    系统 0m54.834s

    $ 时间 ./driver.sh irfan 1000 5

    真正的 4m25.145s
    用户 3m17.286s
    系统 1m21.490s

    $ 时间 ./driver.sh 布赖恩 1000 5

    真正的 0m19.442s
    用户 0m5.287s
    系统 0m10.751s

    $ 时间 ./driver.sh 杰里 1000 5

    真正的 5m29.136s
    用户 4m48.926s
    系统 0m59.336s

```

* * *

## 回答 #4

> 赞同：21
> 
> 时间：2009-03-27T16:48:49.060

为了增加[Irfan 的回答](https://stackoverflow.com/a/689890)，这里有一个更短、更快的版本，`get()`因为它不需要对地图内容进行迭代：

```
get() {
    mapName=$1; key=$2

    map=${!mapName}
    value="$(echo $map |sed -e "s/.*--${key}=\([^ ]*\).*/\1/" -e 's/:SP:/ /g' )"
} 
```

* * *

## 回答 #5

> 赞同：7
> 
> 时间：2010-08-12T13:20:22.217

Bash4 本身就支持这一点。不要使用`grep`or `eval`，它们是最丑陋的黑客。

有关示例代码的详细详细答案，请参见： [https ://stackoverflow.com/questions/3467959](https://stackoverflow.com/questions/3467959)

* * *

## 回答 #6

> 赞同：7
> 
> 时间：2011-06-28T15:28:24.810

```
####################################################################
# Bash v3 does not support associative arrays
# and we cannot use ksh since all generic scripts are on bash
# Usage: map_put map_name key value
#
function map_put
{
    alias "${1}$2"="$3"
}

# map_get map_name key
# @return value
#
function map_get
{
    alias "${1}$2" | awk -F"'" '{ print $2; }'
}

# map_keys map_name 
# @return map keys
#
function map_keys
{
    alias -p | grep $1 | cut -d'=' -f1 | awk -F"$1" '{print $2; }'
} 
```

例子：

```
mapName=$(basename $0)_map_
map_put $mapName "name" "Irfan Zulfiqar"
map_put $mapName "designation" "SSE"

for key in $(map_keys $mapName)
do
    echo "$key = $(map_get $mapName $key)
done 
```

* * *

## 回答 #7

> 赞同：5
> 
> 时间：2019-12-05T23:17:48.037

还有另一种非 bash-4（即 bash 3，Mac 兼容）方式：

```
val_of_key() {
    case $1 in
        'A1') echo 'aaa';;
        'B2') echo 'bbb';;
        'C3') echo 'ccc';;
        *) echo 'zzz';;
    esac
}

for x in 'A1' 'B2' 'C3' 'D4'; do
    y=$(val_of_key "$x")
    echo "$x => $y"
done 
```

印刷：

```
A1 => aaa
B2 => bbb
C3 => ccc
D4 => zzz 
```

带有 的函数`case`就像一个关联数组。不幸的是它不能使用`return`，所以它必须`echo`输出，但这不是问题，除非你是一个避免分叉子shell的纯粹主义者。

* * *

## 回答 #8

> 赞同：4
> 
> 时间：2009-03-27T14:07:49.057

现在回答这个问题。

以下脚本模拟 shell 脚本中的关联数组。它简单易懂。

地图只不过是一个永无止境的字符串，其 keyValuePair 保存为 --name=Irfan --designation=SSE --company=My:SP:Own:SP:Company

空格替换为 ':SP:' 值

```
put() {
    if [ "$#" != 3 ]; then exit 1; fi
    mapName=$1; key=$2; value=`echo $3 | sed -e "s/ /:SP:/g"`
    eval map="\"\$$mapName\""
    map="`echo "$map" | sed -e "s/--$key=[^ ]*//g"` --$key=$value"
    eval $mapName="\"$map\""
}

get() {
    mapName=$1; key=$2; valueFound="false"

    eval map=\$$mapName

    for keyValuePair in ${map};
    do
        case "$keyValuePair" in
            --$key=*) value=`echo "$keyValuePair" | sed -e 's/^[^=]*=//'`
                      valueFound="true"
        esac
        if [ "$valueFound" == "true" ]; then break; fi
    done
    value=`echo $value | sed -e "s/:SP:/ /g"`
}

put "newMap" "name" "Irfan Zulfiqar"
put "newMap" "designation" "SSE"
put "newMap" "company" "My Own Company"

get "newMap" "company"
echo $value

get "newMap" "name"
echo $value 
```

**编辑：**刚刚添加了另一种方法来获取所有密钥。

```
getKeySet() {
    if [ "$#" != 1 ]; 
    then 
        exit 1; 
    fi

    mapName=$1; 

    eval map="\"\$$mapName\""

    keySet=`
           echo $map | 
           sed -e "s/=[^ ]*//g" -e "s/\([ ]*\)--/\1/g"
          `
} 
```

* * *

## 回答 #9

> 赞同：4
> 
> 时间：2014-03-03T16:15:01.647

对于 Bash 3，有一个特殊情况有一个很好且简单的解决方案：

如果您不想处理大量变量，或者键只是无效的变量标识符，*并且*您的数组保证*少于 256 项*，则可以滥用函数返回值。该解决方案不需要任何子shell，因为该值很容易作为变量获得，也不需要任何迭代，因此性能会尖叫。它的可读性也很强，几乎就像 Bash 4 版本一样。

这是最基本的版本：

```
hash_index() {
    case $1 in
        'foo') return 0;;
        'bar') return 1;;
        'baz') return 2;;
    esac
}

hash_vals=("foo_val"
           "bar_val"
           "baz_val");

hash_index "foo"
echo ${hash_vals[$?]} 
```

请记住，在 中使用单引号`case`，否则它会受到通配符的影响。从一开始就对静态/冻结哈希非常有用，但是可以从`hash_keys=()`数组中编写索引生成器。

注意，它默认为第一个，所以你可能想留出第零个元素：

```
hash_index() {
    case $1 in
        'foo') return 1;;
        'bar') return 2;;
        'baz') return 3;;
    esac
}

hash_vals=("",           # sort of like returning null/nil for a non existent key
           "foo_val"
           "bar_val"
           "baz_val");

hash_index "foo" || echo ${hash_vals[$?]}  # It can't get more readable than this 
```

警告：长度现在不正确。

或者，如果您想保留从零开始的索引，您可以保留另一个索引值并防止不存在的键，但它的可读性较差：

```
hash_index() {
    case $1 in
        'foo') return 0;;
        'bar') return 1;;
        'baz') return 2;;
        *)   return 255;;
    esac
}

hash_vals=("foo_val"
           "bar_val"
           "baz_val");

hash_index "foo"
[[ $? -ne 255 ]] && echo ${hash_vals[$?]} 
```

或者，为了保持长度正确，将索引偏移一：

```
hash_index() {
    case $1 in
        'foo') return 1;;
        'bar') return 2;;
        'baz') return 3;;
    esac
}

hash_vals=("foo_val"
           "bar_val"
           "baz_val");

hash_index "foo" || echo ${hash_vals[$(($? - 1))]} 
```

* * *

## 回答 #10

> 赞同：2
> 
> 时间：2016-06-03T08:17:05.470

您可以使用动态变量名称并让变量名称像哈希图的键一样工作。

例如，如果您有一个包含两列名称、信用的输入文件，如下例所示，并且您想要汇总每个用户的收入：

```
Mary 100
John 200
Mary 50
John 300
Paul 100
Paul 400
David 100 
```

*下面的命令将以map_${person}*的形式使用动态变量作为键来汇总所有内容：

```
while read -r person money; ((map_$person+=$money)); done < <(cat INCOME_REPORT.log) 
```

要读取结果：

```
set | grep map 
```

输出将是：

```
map_David=100
map_John=500
map_Mary=150
map_Paul=500 
```

详细说明这些技术，我正在 GitHub 上开发一个功能，就像一个*HashMap Object*，[shell_map](https://github.com/bnegrao/shell_map)。

为了创建“ *HashMap 实例*”，*shell_map 函数*能够以不同的名称创建自身的副本。每个新的函数副本都有一个不同的 $FUNCNAME 变量。然后使用 $FUNCNAME 为每个 Map 实例创建一个命名空间。

映射键是全局变量，格式为 $FUNCNAME_DATA_$KEY，其中 $KEY 是添加到映射的键。这些变量是[动态变量](https://stackoverflow.com/questions/10820343/how-can-i-generate-new-variable-names-on-the-fly-in-a-shell-script)。

下面我将放一个简化版本，以便您可以用作示例。

```
#!/bin/bash

shell_map () {
    local METHOD="$1"

    case $METHOD in
    new)
        local NEW_MAP="$2"

        # loads shell_map function declaration
        test -n "$(declare -f shell_map)" || return

        # declares in the Global Scope a copy of shell_map, under a new name.
        eval "${_/shell_map/$2}"
    ;;
    put)
        local KEY="$2"  
        local VALUE="$3"

        # declares a variable in the global scope
        eval ${FUNCNAME}_DATA_${KEY}='$VALUE'
    ;;
    get)
        local KEY="$2"
        local VALUE="${FUNCNAME}_DATA_${KEY}"
        echo "${!VALUE}"
    ;;
    keys)
        declare | grep -Po "(?<=${FUNCNAME}_DATA_)\w+((?=\=))"
    ;;
    name)
        echo $FUNCNAME
    ;;
    contains_key)
        local KEY="$2"
        compgen -v ${FUNCNAME}_DATA_${KEY} > /dev/null && return 0 || return 1
    ;;
    clear_all)
        while read var; do  
            unset $var
        done < <(compgen -v ${FUNCNAME}_DATA_)
    ;;
    remove)
        local KEY="$2"
        unset ${FUNCNAME}_DATA_${KEY}
    ;;
    size)
        compgen -v ${FUNCNAME}_DATA_${KEY} | wc -l
    ;;
    *)
        echo "unsupported operation '$1'."
        return 1
    ;;
    esac
} 
```

用法：

```
shell_map new credit
credit put Mary 100
credit put John 200
for customer in `credit keys`; do 
    value=`credit get $customer`       
    echo "customer $customer has $value"
done
credit contains_key "Mary" && echo "Mary has credit!" 
```

* * *

## 回答 #11

> 赞同：1
> 
> 时间：2018-07-13T20:11:25.583

添加另一个选项，如果 jq 可用：

```
export NAMES="{
  \"Mary\":\"100\",
  \"John\":\"200\",
  \"Mary\":\"50\",
  \"John\":\"300\",
  \"Paul\":\"100\",
  \"Paul\":\"400\",
  \"David\":\"100\"
}"
export NAME=David
echo $NAMES | jq --arg v "$NAME" '.[$v]' | tr -d '"' 
```

* * *

## 回答 #12

> 赞同：0
> 
> 时间：2010-02-09T17:19:59.610

如前所述，我发现最好的方法是将键/值写入文件，然后使用 grep/awk 检索它们。这听起来像是各种不必要的 IO，但磁盘缓存启动并使其非常高效——比尝试使用上述方法之一将它们存储在内存中要快得多（如基准所示）。

这是我喜欢的一种快速、干净的方法：

```
hinit() {
    rm -f /tmp/hashmap.$1
}

hput() {
    echo "$2 $3" >> /tmp/hashmap.$1
}

hget() {
    grep "^$2 " /tmp/hashmap.$1 | awk '{ print $2 };'
}

hinit capitols
hput capitols France Paris
hput capitols Netherlands Amsterdam
hput capitols Spain Madrid

echo `hget capitols France` and `hget capitols Netherlands` and `hget capitols Spain` 
```

如果您想对每个键强制执行单值，您还可以在 hput() 中执行一些 grep/sed 操作。

* * *

## 回答 #13

> 赞同：0
> 
> 时间：2011-03-01T21:29:49.363

很遗憾我之前没有看到这个问题 - 我已经编写了库[外壳框架](http://shell-framework.origo.ethz.ch/)，其中包含地图（关联数组）。它的最后一个版本可以在[这里](http://svn.origo.ethz.ch/wsvn/shell-framework/trunk/lib/map)找到。

例子：

```
#!/bin/bash 
#include map library
shF_PATH_TO_LIB="/usr/lib/shell-framework"
source "${shF_PATH_TO_LIB}/map"

#simple example get/put
putMapValue "mapName" "mapKey1" "map Value 2"
echo "mapName[mapKey1]: $(getMapValue "mapName" "mapKey1")"

#redefine old value to new
putMapValue "mapName" "mapKey1" "map Value 1"
echo "after change mapName[mapKey1]: $(getMapValue "mapName" "mapKey1")"

#add two new pairs key/values and print all keys
putMapValue "mapName" "mapKey2" "map Value 2"
putMapValue "mapName" "mapKey3" "map Value 3"
echo -e "mapName keys are \n$(getMapKeys "mapName")"

#create new map
putMapValue "subMapName" "subMapKey1" "sub map Value 1"
putMapValue "subMapName" "subMapKey2" "sub map Value 2"

#and put it in mapName under key "mapKey4"
putMapValue "mapName" "mapKey4" "subMapName"

#check if under two key were placed maps
echo "is map mapName[mapKey3]? - $(if isMap "$(getMapValue "mapName" "mapKey3")" ; then echo Yes; else echo No; fi)"
echo "is map mapName[mapKey4]? - $(if isMap "$(getMapValue "mapName" "mapKey4")" ; then echo Yes; else echo No; fi)"

#print map with sub maps
printf "%s\n" "$(mapToString "mapName")" 
```

* * *

## 回答 #14

> 赞同：0
> 
> 时间：2013-06-13T12:38:12.123

几年前，我为 bash 编写了脚本库，它支持关联数组以及其他功能（日志记录、配置文件、对命令行参数的扩展支持、生成帮助、单元测试等）。该库包含关联数组的包装器并自动切换到适当的模型（对于 bash4 是内部的，对于以前的版本是模拟的）。它被称为 shell-framework 并托管在 origo.ethz.ch 但今天该资源已关闭。如果有人仍然需要它，我可以与您分享。

* * *

## 回答 #15

> 赞同：0
> 
> 时间：2015-08-05T08:38:09.997

Shell 没有像数据结构这样的内置映射，我使用原始字符串来描述这样的项目：

```
ARRAY=(
    "item_A|attr1|attr2|attr3"
    "item_B|attr1|attr2|attr3"
    "..."
) 
```

提取项目及其属性时：

```
for item in "${ARRAY[@]}"
do
    item_name=$(echo "${item}"|awk -F "|" '{print $1}')
    item_attr1=$(echo "${item}"|awk -F "|" '{print $2}')
    item_attr2=$(echo "${item}"|awk -F "|" '{print $3}')

    echo "${item_name}"
    echo "${item_attr1}"
    echo "${item_attr2}"
done 
```

这似乎并不比其他人的答案聪明，但对于新人来说很容易理解。

* * *

## 回答 #16

> 赞同：-1
> 
> 时间：2013-04-11T14:22:16.080

我用以下内容修改了 Vadim 的解决方案：

```
####################################################################
# Bash v3 does not support associative arrays
# and we cannot use ksh since all generic scripts are on bash
# Usage: map_put map_name key value
#
function map_put
{
    alias "${1}$2"="$3"
}

# map_get map_name key
# @return value
#
function map_get {
    if type -p "${1}$2"
        then
            alias "${1}$2" | awk -F "'" '{ print $2; }';
    fi
}

# map_keys map_name 
# @return map keys
#
function map_keys
{
    alias -p | grep $1 | cut -d'=' -f1 | awk -F"$1" '{print $2; }'
} 
```

更改是对 map_get 的更改，以防止它在您请求不存在的密钥时返回错误，尽管副作用是它也会默默地忽略丢失的地图，但它更适合我的用例，因为我只是想要检查一个键以跳过循环中的项目。

* * *

## 回答 #17

> 赞同：-1
> 
> 时间：2015-09-15T15:59:20.533

迟到的回复，但考虑以这种方式解决问题，使用 bash 内置**读取**，如以下 ufw 防火墙脚本的代码片段中所示。这种方法的优点是可以根据需要使用尽可能多的分隔字段集（而不仅仅是 2 个）。我们使用了**|** 分隔符，因为端口范围说明符可能需要冒号，即**6001:6010**。

```
#!/usr/bin/env bash

readonly connections=(       
                            '192.168.1.4/24|tcp|22'
                            '192.168.1.4/24|tcp|53'
                            '192.168.1.4/24|tcp|80'
                            '192.168.1.4/24|tcp|139'
                            '192.168.1.4/24|tcp|443'
                            '192.168.1.4/24|tcp|445'
                            '192.168.1.4/24|tcp|631'
                            '192.168.1.4/24|tcp|5901'
                            '192.168.1.4/24|tcp|6566'
)

function set_connections(){
    local range proto port
    for fields in ${connections[@]}
    do
            IFS=$'|' read -r range proto port <<< "$fields"
            ufw allow from "$range" proto "$proto" to any port "$port"
    done
}

set_connections 
```

# php - PHP4会话/对象问题

> ID：688852
> 
> 赞同：0
> 
> 时间：2009-03-27T07:39:39.317
> 
> 标签：php, class, php4

我对 PHP4 有一个奇怪的问题

我有一个分配 $_SESSION 变量的类。

在本地开发服务器上，它的工作方式为： $_SESSION['foo'] = $this->foo; 我可以将 $_SESSION['foo'] 作为字符串访问。

在实时服务器上 $_SESSION['foo'] 不是字符串而是序列化对象？相同的代码？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-03-27T07:51:53.343

好的，我发现它`$_SESSION['myvar']`变成了 global `$myvar`，并且被实例变量覆盖`$myvar = new MyClass();`

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-03-27T07:50:40.290

我对此知之甚少，但就我使用 PHP 而言，PHP 4 在 $_SESSION（和 $_SERVER 等）变量方面存在一些问题，您最好坚持使用创建和存储会话的旧方式（我忘了顺便说一句）。问题在于它的面向对象模型中存在错误。

然后我坚持使用 PHP 5 工作正常，您也应该考虑将您的应用程序迁移到 PHP 5 ：D

# wpf - 在 .NET 3.5 Windows 窗体中使用 WPF SplashScreen

> ID：688854
> 
> 赞同：1
> 
> 时间：2009-03-27T07:40:49.220
> 
> 标签：wpf, winforms, visual-studio-2008

我可以在 .NET 3.5 SP1 Visual Studio 2008 下编译的 Windows 窗体项目中使用内置的 WPF 闪屏功能吗？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2009-03-27T21:44:28.723

是的，你可以，但它有点脆弱而且不是很简单。

SplashScreen 类查找 AssemblyName + ".g" 资源文件。要创建它，您需要在项目中包含一个“g.resx”文件。项目属性中设置的根命名空间必须与程序集名称相同。

此资源文件需要将图像包含为 MemoryStream，而不是 System.Drawing.Bitmap！也许有一种更简单的方法，但我只是包含了该文件，然后手动将条目更改为如下所示：

```
<data name="splash.png" type="System.Resources.ResXFileRef, System.Windows.Forms">
  <value>Splash.png;System.IO.MemoryStream, mscorlib, Version=2.0.0.0, Culture=neutral, PublicKeyToken=b77a5c561934e089</value>
</data> 
```

然后只需在您的 Main 方法中包含以下几行：

```
var splash = new SplashScreen("Splash.png");
splash.Show(true); 
```

希望有帮助。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2011-07-21T16:14:18.550

jachymko 的答案是正确的，但有点未指定。

首先，添加对 WindowsBase 的引用。具体代码是

```
var splash = new System.Windows.SplashScreen("guru_logo.png");
splash.Show(true); 
```

为了使它工作，您的 g.resx 文件必须在项目级别，而不是在 Properties 文件夹中。如果您的 resx 默认位于 Properties 中（如我的），则需要将其拖到项目级别。

这就是我的 g.resx 的相关部分的样子

```
 <data name="guru_logo.png" type="System.Resources.ResXFileRef, System.Windows.Forms">
    <value>Resources\guru_logo.png;System.IO.MemoryStream, mscorlib, Version=4.0.0.0, Culture=neutral, PublicKeyToken=b03f5f7f11d50a3a</value>
  </data> 
```

请注意，SplashScreen 调用的是数据名称，而不是值。还要注意值中表示的路径。

如果由于某种原因这对您不起作用（异常找不到资源），请查看 g.Designer.cs 背后的代码。那里的命名空间应该是您的程序集名称。如果不是，您需要将其移动到正确的位置和/或按照 jachymko 的状态更改项目属性。您对此文件代码所做的任何更改都将丢失，因为它是自动生成的。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2011-08-19T18:41:11.003

我是从一个简单的命令行程序完成的，该程序在 makefile 中编译。总结一下：

*   添加一个 g.resx 文件
*   内容必须引用您要用于启动画面的图形图像。它可以是任何图像类型
*   您必须使用 resgen.exe 编译 .resx 文件
*   使用 /res 选项在 csc.exe 的命令行中包含 .resource 文件

更详细...

1.  .resx 文件如下所示：

* * *

```
 <?xml version="1.0" encoding="utf-8"?>
 <root>
   <xsd:schema id="root" xmlns="" xmlns:xsd="http://www.w3.org/2001/XMLSchema" xmlns:msdata="urn:schemas-microsoft-com:xml-msdata">
    <xsd:import namespace="http://www.w3.org/XML/1998/namespace" />
    <xsd:element name="root" msdata:IsDataSet="true">
      <xsd:complexType>
        <xsd:choice maxOccurs="unbounded">
          <xsd:element name="data">
            <xsd:complexType>
              <xsd:sequence>
                <xsd:element name="value" type="xsd:string" minOccurs="0" msdata:Ordinal="1" />
                <xsd:element name="comment" type="xsd:string" minOccurs="0" msdata:Ordinal="2" />
              </xsd:sequence>
              <xsd:attribute name="name" type="xsd:string" use="required" msdata:Ordinal="1" />
              <xsd:attribute name="type" type="xsd:string" msdata:Ordinal="3" />
              <xsd:attribute name="mimetype" type="xsd:string" msdata:Ordinal="4" />
              <xsd:attribute ref="xml:space" />
            </xsd:complexType>
          </xsd:element>
          <xsd:element name="resheader">
            <xsd:complexType>
              <xsd:sequence>
                <xsd:element name="value" type="xsd:string" minOccurs="0" msdata:Ordinal="1" />
              </xsd:sequence>
              <xsd:attribute name="name" type="xsd:string" use="required" />
            </xsd:complexType>
          </xsd:element>
        </xsd:choice>
      </xsd:complexType>
    </xsd:element>
  </xsd:schema>
  <resheader name="resmimetype">
    <value>text/microsoft-resx</value>
  </resheader>
  <resheader name="version">
    <value>2.0</value>
  </resheader>
  <resheader name="reader">
    <value>System.Resources.ResXResourceReader, System.Windows.Forms, Version=2.0.0.0, Culture=neutral, PublicKeyToken=b77a5c561934e089</value>
  </resheader>
  <resheader name="writer">
    <value>System.Resources.ResXResourceWriter, System.Windows.Forms, Version=2.0.0.0, Culture=neutral, PublicKeyToken=b77a5c561934e089</value>
  </resheader>
  <data name="hourglass.jpg" type="System.Resources.ResXFileRef, System.Windows.Forms">
    <value>hourglass.jpg;System.IO.MemoryStream, mscorlib, Version=2.0.0.0, Culture=neutral, PublicKeyToken=b77a5c561934e089</value>
</data>
</root> 
```

1.  使用包含在 Windows SDK 中的 resgen.exe 进行编译。例如：

* * *

```
c:\winsdk\bin\resgen.exe  g.resx g.resources 
```

* * *

1.  在 csc.exe 命令行上指定生成的 .resources。例如：

* * *

```
csc.exe /t:exe /debug+ /win32icon:MyApp.ico /res:g.resources,MyApp.g.resources /R:... ... 
```

# c# - 如何在 ASP.NET 中设置 GridView 列的可见性？

> ID：688861
> 
> 赞同：2
> 
> 时间：2009-03-27T07:45:18.553
> 
> 标签：c#, asp.net, vb.net

好吧，我`List<UserDC>`现在有一个对象列表，我想在某种网格中显示它，所以我尝试了`GridView`

```
GridView1.DataSource = list
GridView1.DataBind() 
```

那确实有效，但现在我想隐藏一些列，但这似乎并不那么容易：

```
GridView1.Columns(0).Visible = False
GridView1.Columns(1).Visible = False
GridView1.Columns(2).Visible = False 
```

这只是给了我一个例外我`ArgumentOutOfRangeException`如何让它在显示列表之前生成列，这样我就可以过滤掉那些我不想要的列？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2009-03-27T08:11:11.097

要隐藏 GridView 列，您可以使用**GridView_RowDataBoundEvent**并隐藏不需要的列。

您可以通过检查此事件中的“RowType”属性来隐藏列标题、数据行或两者。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-03-27T07:55:33.320

对我来说没问题。这里有一个建议供您检查。由于这是 VB .NET 代码，我假设您有 VS 2005 或 2008。在 GridView1.Columns(0).Visible = False 处设置断点

使用观察窗口，为 GridView1.Columns 创建一个观察。展开“base”，“Count”的值是多少？它很可能为零，表示您没有任何列。这可能是您出现“ArgumentOutOfRangeException”的原因。

您的数据绑定到“列表”是否有效？

* * *

## 回答 #3

> 赞同：-1
> 
> 时间：2009-03-27T07:55:21.993

您可以将可见列设置为：

```
<asp:GridView ID="GridView1" runat="server" AutoGenerateColumns="false">
<Columns>
   <asp:BoundField HeaderText="Property 2" DataField="Property1" />
   <asp:BoundField HeaderText="Property 2" DataField="Property2" />
</Columns>
</asp:GridView> 
```

AutoGenerateColumns="false" 禁用公开数据源的所有属性/列。BoundFields 会将您的属性映射到网格列。

# javascript - 如何使用 JQ 打开和关闭复选框和单选按钮

> ID：688865
> 
> 赞同：2
> 
> 时间：2009-03-27T07:48:19.000
> 
> 标签：javascript, jquery, radio-button

我试图让它发挥作用，但没有成功。我是一个真正的 js 菜鸟，所以在尝试帮助我时请记住这一点。您必须为我拼写出来，因为我只是不明白所有这些代码正在发生什么。

我有两件事要努力。一个是一组单选按钮。这些按钮是一组，意味着只能选中一个单选按钮。这些单选按钮的值是 1 或 0，并且来自数据库。

这是我遇到的问题。我可以切换按钮并更改数据库中的值，但是当 json 从数据库中调用数据时，用户的按钮没有变化。例如：如果我将按钮 A 更改为 true 或选中，则 db 中的 val 更改为 1。从那一刻起查看该页面时，按钮 A 应该反映这一点。此外，当用户选中 B 时，db val 随即更改为 0，并且按钮也应反映这一点。

我不明白的是如何切换实际按钮以反映数据库中的值。到目前为止，这是我的代码：

```
else if (item.field == "status" && item.value == "1"){
  $("radio#status").attr("checked", "checked");
}

<input type="radio" id="active" name="status" value="1" checked="checked" class="chkbx">
<input type="radio" id="inactive" name="status" value="0" class="chkbx"> 
```

这是我的第二个问题。复选框与单选按钮完全相同，只是它们不是一个组。每个复选框都有自己的值。我再次使用 0 和 1，但可以一次检查多个复选框。这也是它的代码。

```
else if (item.field == "rptDly" && item.value == "1"){
  $("checkbox#rptDly").attr("checked", "checked");
}

<input type="checkbox" id="rptDly" name="rptDly" value="1" checked="checked" class="chkbx">
<input type="checkbox" id="rptSum" name="rptSum" value="1" checked="checked" class="chkbx">
<input type="checkbox" id="rptDtl" name="rptDtl" value="1" checked="checked" class="chkbx"> 
```

有人可以指导我吗？当我在上面的 js 代码中发出警报时，我确实收到了警报，所以我知道我在那里很好，但是因为我不知道 js，所以我无法进一步解决这个问题。

编辑：

我找到了我正在复制的原始帖子。它就在[这里](https://stackoverflow.com/questions/558445/dynamically-fill-in-form-values-with-jquery)。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-03-27T08:00:22.527

您似乎混淆了服务器上发生的事情和客户端上发生的事情。您指的是什么项目对象？

它也是 tag#id，您在第一个代码示例中使用 tag#name。

通常您正在编写的代码看起来有点像这样（取决于服务器端语言和框架）：

```
<input type="checkbox" id="forreferencinginjavascriptandcss" name="tobesenttotheserver" value="1"<% if someboolean then print " checked=\"checked\"" %>> 
```

请注意，在向客户端发送任何内容之前，<% 和 %> 之间的代码会在服务器上运行。

如果您想在发送到浏览器后选中/取消选中单选按钮/复选框，可以使用 jQuery 来完成：

```
$("input#forreferencinginjavascriptandcss").attr("checked", true); 
```

或者

```
$("input#forreferencinginjavascriptandcss").attr("checked", false); 
```

如果选中复选框，则将 name=value 发送到服务器，如果未选中，则不会将任何内容发送到服务器。如果您想查看发送到哪里的内容，我建议您 google 并下载 Fiddler2。它是一个作为 http 代理的作品，可以让您准确地看到发送到服务器和从服务器发送的内容。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-03-27T09:11:45.523

您需要将 javascript 中的“checked”属性设置为 true/false，而不是字符串“checked”。

`checked="checked"`是用于指定布尔属性的 HTML 约定。在 javascript DOM 中，这被转换为真正的布尔值

* * *

## 回答 #3

> 赞同：-1
> 
> 时间：2009-03-27T08:21:10.917

您用于 jquery 选择器的语法有点错误。

代替...

```
$("checkbox#rptDly") 
```

...访问复选框的语法是...

```
$("input:checkbox[name='rptDly']") 
```

但是，由于每个复选框都有自己独特的 id 属性，您可以简单地使用...

```
$("#rptDly") 
```

单选按钮有点棘手，因为它们都有相同的名称或 ID。这些必须通过 value 属性来区分 - 将为此调查正确的解决方案并回复您。

[在JQuery 文档网站](http://docs.jquery.com/Selectors)上复习您的 JQuery 选择器语法 或者购买[一本关于该主题的好书](http://docs.jquery.com/Selectors)

# database - 访问比较数据库架构

> ID：688867
> 
> 赞同：2
> 
> 时间：2009-03-27T07:50:24.703
> 
> 标签：database, ms-access, compare

我想比较两个 Access 数据库并检查其中是否有任何字段或类型不匹配。

有什么方法可以检查使用数据集还是有更快的方法来做到这一点？

谢谢。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2009-03-27T18:26:37.250

您可以使用 StarInix Software 的 Free Database Compare 2.0（[评论](http://rbytes.net/software/free-database-compare-review/)）进行比较。

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2009-08-12T18:02:27.107

1.  使用 Access 数据库 Documenter (Tools\Analyze\Documenter) 创建数据库对象的报告。
2.  将此报告导出为文本文件（在报告中单击鼠标右键，导出...，另存为文本文件类型）。

对每个数据库执行此操作，并使用您选择的差异工具比较文本文件。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2011-04-07T14:24:22.567

我一直在 Access Pro Table Compare。我在网上找到了它，它非常适合比较 MS Access 表、查找字段和数据类型问题等。

[Access Pro 表比较工具](http://www.db-pros.com/AccessPro)

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2012-11-13T22:37:22.517

我制作了一个允许比较 Access 对象和数据的[AccdbMerge实用程序。](https://www.db-merge-tools.net/microsoft-access-diff-merge-overview.html)在模式比较范围内 - 它允许比较表和查询列表以及每个表/查询定义。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2009-03-27T08:38:28.100

您可以像在 SQL Server 数据库中一样读取 access 数据库中的系统表（默认情况下是隐藏的），但使用 ODBC 驱动程序。

* * *

## 回答 #6

> 赞同：-1
> 
> 时间：2013-01-01T21:58:51.660

```
Option Compare Database

Private Sub Command14_Click()

Dim tablename1, tablename2, field_date As String
tablename1 = Text10.Value
tablename2 = Text13.Value
flter_date = Text16.Value
length = Len(tablename1) - Len("gahpu00d_")
field_date = Right(tablename1, length) & "_posted_dt"

'On Error GoTo Err_cmdValidateGeneralInfo_Click

 Dim F As DAO.Field
 Dim rs As DAO.Recordset
Dim rs1 As DAO.Recordset
Set curDB = CurrentDb()

DoCmd.CopyObject , "Unmatched_records", acTable, tablename1
curDB.Execute "DELETE FROM Unmatched_records"

 'to calculate count of filtered data in staged

strsql = "Select * from " & tablename1 & " where cdate(" & field_date & ") = """ & flter_date & """ order by " & field_date & ""
DoCmd.RunSQL "Select * into filter_data1 from " & tablename1 & " where cdate(" & field_date & ") = """ & flter_date & """"
count_data1 = DCount(field_date, "filter_data1")
Text18.Enabled = True
Text18.Value = count_data1

'to calculate count of filtered data in production

strsql1 = "Select * from " & tablename2 & " where cdate(" & field_date & ") = """ & flter_date & """ order by " & field_date & ""
DoCmd.RunSQL "Select * into filter_data2 from " & tablename2 & " where cdate(" & field_date & ") = """ & flter_date & """"
count_data2 = DCount(field_date, "filter_data2")
Text20.Enabled = True
Text20.Value = count_data2

If count_data1 <> count_data2 Then
If count_data1 > count_data2 Then
  MsgBox "The number of records in the table didnt match." & tablename1 & " has more records than " & tablename2
  Exit Sub

  Else
  MsgBox "The number of records in the table didnt match." & tablename2 & " has more records than " & tablename1
  Exit Sub

End If
End If

Set rs = curDB.OpenRecordset(strsql)
Set rs1 = curDB.OpenRecordset(strsql1)

    Do Until rs.EOF
      For Each F In rs.Fields

        If rs.Fields(F.Name) <> rs1.Fields(F.Name) Then
          'rs.Edit
          strsql = "Select * into test from " & tablename1 & " where " & F.Name & " = """ & rs.Fields(F.Name) & """"
          DoCmd.RunSQL strsql

          If DCount(F.Name, "test") <> 0 Then
          GoTo append_unmatch

          'appending unmacthed records
append_unmatch:

          strsql2 = "insert into Unmatched_records Select * from test"
          DoCmd.RunSQL strsql2

          'if record doesnt match move to next one
          GoTo Nextrecord
          End If
         ' rs.Fields(F.Name) = rs1.Fields(F.Name)
         ' rs.Update
        End If
      Next F

Nextrecord:
rs.MoveNext
rs1.MoveNext
    Loop

     'To check whether tables matched or not
final:
    Dim rs2 As DAO.Recordset
    strsql3 = "select * from Unmatched_records"
    Set rs2 = curDB.OpenRecordset(strsql3)
    For Each F In rs2.Fields
    If DCount(F.Name, "Unmatched_records") <> 0 Then
    MsgBox ("The two tables didnt match. Check table Unmatched_records for unmatching reocrds.")
    Else
    MsgBox ("Tables match!")
    End If
Exit Sub
   Next F
    rs2.Close

End Sub

Private Sub Form_Load()
Text20.Enabled = False
Text18.Enabled = False
Text18.Value = ""
Text20.Value = ""
End Sub 
```

# algorithm - 将小数转换为字母列 id？

> ID：688869
> 
> 赞同：1
> 
> 时间：2009-03-27T07:50:49.697
> 
> 标签：algorithm

使用一些电子表格的东西，在内部，这些列由一个简单的十进制数字（索引为 0）引用，但对于输出，我需要它采用标准的人类可读格式：

```
A, B, C, .. Z, AA, AB, AC, .. AZ, BA .. 
```

我首先想到“简单！我将切换到基数 26 并使用 [AZ] 而不是 [0-9A-P]”，除了使用这种技术使 A => 0\. B => 1\. 因此序列实际上像这样：

```
A, B, .. Y, Z, BA, BB 
```

如何将小数转换为 excel 样式的列名？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-03-27T08:17:03.033

检查这个问题：

*   [如何将列号（例如 127）转换为 excel 列（例如 AA）](https://stackoverflow.com/questions/181596)

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-03-27T08:03:54.843

这可能不是最有效的方法，但它相当简洁并且有效。可能值得`ZZ`在生产代码中进行范围检查，因为我怀疑那时会发生不好的事情。当然，`if/else`如果您不喜欢它们，您可以将条件运算符扩展为 an。

```
static string ColumnPrefix(int column)
{
    Debug.Assert(column >= 0, "Column would be below 'A'.");
    Debug.Assert(column <= 26 * 27, "Column would be above 'ZZ'.");

    Func<int, string> itoa = i => new string((char)('A' + i), 1);
    return column < 26 ? 
               itoa(column) : 
               itoa((column - 26) / 26) + itoa(column % 26);
} 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-03-27T08:21:52.600

在 VB .NET 代码中并使用递归实现表现力

```
 Function Decimal2ExcelAZ(ByVal number As Integer) As String
    If number < 0 Then
      Throw New Exception("Number cannot be negative")
    ElseIf number < 26 Then
      Rem 65 is the ASCII of "A"
      Return New String(Chr(65 + number) + "")        
    Else
      Return Decimal2ExcelAZ(number \ 26 - 1) + Decimal2ExcelAZ(number Mod 26)
    End If
  End Function 
```

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2009-03-27T15:00:50.503

这是 PHP 中的解决方案，几乎直接取自[Graham](https://stackoverflow.com/users/1826/graham)的[这个答案](https://stackoverflow.com/questions/181596/how-to-convert-a-column-number-eg-127-into-an-excel-column-eg-aa/182924#182924)：

```
function rowCol2Cell($row, $col) {
    $dividend = $col + 1;
    $columnName = '';

    while ($dividend > 0) {
        $modulo = ($dividend - 1) % 26;
        $columnName = chr(65 + $modulo) . $columnName;
        $dividend = (int)(($dividend - $modulo) / 26);
    }

    return $columnName . ($row + 1);
}

// rowCol2Cell(0, 0) = "A1"
// rowCol2Cell(0, 1) = "B1"
// rowCol2Cell(0,26) = "AA1" 
```

**编辑**：

如果您使用的是 PHP PEAR 模块 Spreadsheet Excel Writer，那么它内置了以下功能：

```
Spreadsheet_Excel_Writer::rowcolToCell 
```

我可能应该只是 RTFM，嘿...

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2010-05-11T20:47:08.027

没有Java版本就不会完整...

```
protected static String columnLetter( int columnNumber ) {
 if( columnNumber < 0 ) return "Err";
 if( columnNumber < 26 )
  return Character.toString((char) (columnNumber+ 65));
 return columnLetter( (columnNumber / 26) - 1) + 
  columnLetter ( columnNumber % 26 );
} 
```

（基于递归 VB .NET 示例）

* * *

## 回答 #6

> 赞同：-1
> 
> 时间：2009-03-27T08:20:10.157

这是一个VB函数。通过利用模和对数，它是微不足道的并且不需要递归：

```
Function ColumnLetter(ByVal colNum As Long) As String
    Dim i As Long, x As Long
    For i = Int(Log(CDbl(25 * (CDbl(colNum) + 1))) / Log(26)) - 1 To 0 Step -1
        x = (26 ^ (i + 1) - 1) / 25 - 1
        If colNum > x Then
           ColumnLetter = ColumnLetter & Chr(((colNum - x - 1) \ 26 ^ i) Mod 26 + 65)
        End If
    Next i
End Function 
```

[酸](http://www.craigmurphy.com/blog/?p=150)

# c# - .NET：运行 VS Team Test 时获取文件的绝对路径

> ID：688881
> 
> 赞同：3
> 
> 时间：2009-03-27T08:01:45.940
> 
> 标签：c#, .net, visual-studio-2008, unit-testing

目前我在 C:\Projects\TestProject\TestClass.cs 中有一个名为 TestClass.cs 的测试类
我在 C:\Projects\TestProject\config\config.xml 中也有一个 Xml 文件

在 TestClass.cs 中，我有一个从文件系统加载 Xml 的测试方法，如下所示：

`XmlDocument xmlDoc = new XmlDocument(); xmlDoc.Load(Path.Combine(Assembly.GetExecutingAssembly().Location, "config\config.xml"));`

不幸的是， Location 属性给了我这个值：
C:\Projects\TestProject\TestResults\klaw_[computernamehere] [time here]\

而不是我想要的，即 C:\Projects\TestProject\

我已经尝试过 Assembly.GetExecutingAssembly().CodeBase 以及类似的结果。

有任何想法吗？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-03-27T08:09:32.897

如果您使用 MSTest，则需要使用 DeploymentItemAttribute 标记此文件。这意味着它将与 DLL 一起复制。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2009-03-27T08:14:57.343

既然这是一个测试，那么让文件成为嵌入式资源怎么样？然后，您可以使用以下代码在运行时读取嵌入式资源：

```
Stream stream = Assembly.GetExecutingAssembly().GetManifestResourceStream(resource); 
```

资源通常是命名空间 + 文件名。但是您可以通过在调试器中运行以下代码来解决此问题：

```
AssemblyGetExecutingAssembly().GetManifestResourceNames(); 
```

这将返回嵌入资源的列表。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2009-03-27T08:05:53.060

嗯，它说的是实话。与 NUnit / TestDriven.NET 等不同 - MSTest 将内容复制到每个测试的不同文件夹中。这是（IMO）一个痛苦 - 例如，您需要包含（[`[DeploymentItem]`](http://msdn.microsoft.com/en-us/library/microsoft.visualstudio.testtools.webtesting.deploymentitemattribute(VS.80).aspx)）的属性文件，或者在 testrunco​​nfig 中指定它们（属性->部署->添加文件...）。

将此与 TestDriven.NET 进行对比，您可以在其中使用“复制到输出目录”标志。

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2009-03-27T21:11:48.460

除了使用 [DeploymentItem] 标记项目之外，您还需要确保您的测试运行配置已选中启用部署以及从中获取项目的目录。

# javascript - 如何检测窗口是否真的在 IE8 标准模式下调整了大小？

> ID：688894
> 
> 赞同：5
> 
> 时间：2009-03-27T08:12:03.577
> 
> 标签：javascript, internet-explorer-8, dom-events

我的网站有许多针对不同屏幕宽度定制的样式表。当浏览器调整大小时，`window.onresize`事件会通过查看`document.documentElement.clientWidth`. 如果是这样，它会依次打开更大的样式表，直到出现滚动条。然后，它以相反的顺序将它们关闭，直到滚动条消失。`offsetWidth`通过比较来检测滚动条`scrollWidth`。

在 IE8 中，两个新问题混淆了调整大小的检测。一，`onresize`当滚动条出现或消失时触发，二，`d.dE.clientWidth`报告没有滚动条的宽度，从 IE7 和所有其他浏览器中断。我的网站现在经常陷入一个循环，其中`onresize`逻辑激活一个更大的样式表，该样式表创建滚动条，然后触发另一个无法过滤掉的调整大小事件，因为`clientWidth`滚动条出现或消失导致该事件发生了变化。`outerWidth`如果 IE8 有我可以检查的东西，这将是一个微不足道的修复。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2009-03-27T19:09:42.997

由于我从未在任何浏览器中处理触发 onresize 的滚动条生成，我没有意识到检查 d.dE.clientWidth 并不是一个好的验证，实际上从未包含滚动条。我现在改为检查 d.dE.offsetWidth，并过滤掉重复的 onresize 事件。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-03-27T08:23:28.900

你几乎肯定知道这一点——它并没有真正回答你的问题，因为它迫使 IE8 退出标准模式——但快速解决方法是[使用 HTTP 标头强制 IE8 进入 IE7 模式](http://blogs.msdn.com/ie/archive/2008/06/10/introducing-ie-emulateie7.aspx)。

# asp.net-mvc - 搜索引擎，asp.net mvc，领域驱动设计

> ID：688908
> 
> 赞同：1
> 
> 时间：2009-03-27T08:22:45.827
> 
> 标签：asp.net-mvc, architecture, domain-driven-design

打算开发搜索引擎。

我想知道我的 DDD 应该是什么样子。应该实现对记录进行排序，但我不希望我的视图知道我的数据库结构（按哪些列排序）。据我了解 - 排序信息应该来自基础设施层，来自存储库实现，因此必须有一个灵活的域。

它应该是什么样子？

我希望这是强类型的。

有什么最佳实践吗？

对架构的建议？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-03-27T09:47:56.827

如果您要开发一个搜索引擎，您将不得不非常快速地考虑可伸缩性。在搜索相关环境中排序是一个熟悉的问题。您应该看看 Google 的搜索实现！您如何排序应该取决于[排名算法](http://en.wikipedia.org/wiki/PageRank)。以领域为中心的排名算法设计不应与排名即服务方法有如此大的不同！

你使用什么语言是你的选择。如果您选择 C/C++[消息传递接口](http://en.wikipedia.org/wiki/Message_Passing_Interface)(MPI) 进行分布式计算。如果您使用 Java，请查看[JMS](http://en.wikipedia.org/wiki/Java_Message_Service)和[GridGain](http://www.gridgain.com/)（GridGain 实现了 Google 的 MapReduce）。

另一个问题是，如何存储你的数据（分布式、快速、容错）！对于 Java，请查看[Project Voldemord](http://project-voldemort.com/)（这是您可以免费获得的最佳系统之一。

有关 Google 架构的更多信息，请在[高可扩展性网站](http://highscalability.com/google-architecture)上阅读更多信息。

有关 DDD 的问题，请查看[dddcommunity.org](http://dddcommunity.org/)，Eric Evans 本人的主页；）他写了一本非常好的书[Domain-Driven Design](https://rads.stackoverflow.com/amzn/click/com/0321125215)。DDD 很好，因为它保证了域的完整性和完整性。

一个简单的模型可能是：

```
page ( URL url, BigInt rank, List<String> keywords, 
       List<URL> links, List<URL> outLinks, Content ref) 

content ( GzippedBytes[] content ) 
```

如果一个新节点被添加到系统中，它应该对诸如“ *setLinks* ”之类的东西做出反应，这样它就可以自己获得它的页面排名。

客户很简单，他只做一个按 PageRank 排序的*搜索（关键字） 。*

这是Java[中 pagerank 实现的](http://www.kyle-brady.com/2009/03/07/google-pagerank-a-simple-implementation-in-java/)**服务示例。**

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-06-04T04:45:28.590

这是解析 MVC 视图目录、读取文件并将提供的文本与正则表达式匹配的自定义搜索引擎的基础知识。我的网站返回搜索结果的 html 链接。此代码将导致创建一个列表。

```
List<string> results = new List<string>();
DirectoryInfo di = new DirectoryInfo  (System.Configuration.ConfigurationManager.AppSettings["PathToSearchableViews"]);
//get all view directories except the shared
foreach (DirectoryInfo d in di.GetDirectories().Where(d=>d.Name != "Shared"))
{
    //get all the .cshtml files
    foreach (FileInfo fi in d.GetFiles().Where(e=>e.Extension  == ".cshtml"))
    {
    //check if cshtml file and exclude partial pages
    if (fi.Name.Substring(0,1) != "_")
    {
        MatchCollection matches;
        bool foundMatch = false;
        int matchCount = 0;
        using (StreamReader sr = new StreamReader(fi.FullName))
        {
            string file = sr.ReadToEnd();
            foreach (string word in terms)
            {
                Regex exp = new Regex("(?i)" + word.Trim() + "(?-i)");
                matches = exp.Matches(file);
                if (matches.Count > 0)
                {
                    foundMatch = true;
                    matchCount = matches.Count;
                }
            }
         //check match count and create links
         //
         //
         }
      }
      }
  }
  return results; 
```

# php - 图像上的文字

> ID：688913
> 
> 赞同：0
> 
> 时间：2009-03-27T08:26:03.683
> 
> 标签：php, image, text

是否可以在php中动态地将文本放置在图像上？然后将其发送到 RSS 源？

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2009-03-27T08:27:48.140

是的，可以使用[GD](http://www.php.net/gd)函数或[ImageMagick](http://www.php.net/imagemagick)函数，这取决于您的服务器上安装了哪个以及您喜欢哪个。

使用 GD 会变成这样：

```
<?php
$img = imagecreatefromjpeg('my.jpg');
$textColor = imagecolorallocate($img, 0, 0, 0); // black text

imagefttext($img, 13, 0, 105, 55, $textColor, './arial.ttf', 'Hello World');

// Output image to the browser
header('Content-Type: image/jpeg');
imagejpeg($img);

// Or save to file
imagejpeg($img, 'my-text.jpg');

imagedestroy($img);
?> 
```

编辑：

要将图像放入您的 RSS 提要中，您可以将其保存到文件中并将 URL 放入您的提要中。

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2009-03-27T08:28:15.767

当然。[`imagefttext()`](http://www.php.net/manual/en/function.imagefttext.php)来自GD 。不过，您将需要 TTF 文件。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2009-03-27T08:29:41.427

您可以将 GD 与[imagecreatefromjpeg](http://se2.php.net/manual/en/function.imagecreatefromjpeg.php)（或任何其他格式）一起使用，然后[使用 imageftttext](http://se2.php.net/manual/en/function.imagefttext.php)来绘制字符串。

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2009-03-27T08:29:44.470

[下面是一些用于 PHP 的 ImageMagick 库](http://www.imagemagick.org/script/api.php#php)。一旦你安装了它，你可以用相关的 PHP 的 ImageMagick 命令来[注释你的图像。](http://www.imagemagick.org/Usage/annotating/)

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2009-03-27T08:33:07.160

请记住以某种方式缓存该文件。由于 GD 和 Imagick 在服务器上都很重，并且可能需要一些时间来创建。

# sql - 在 mssql 2005 中保存 DateTime 没有小时、分钟和秒

> ID：688914
> 
> 赞同：3
> 
> 时间：2009-03-27T08:26:10.470
> 
> 标签：sql, sql-server, datetime

我想将 sql2005 中的日期保存为日期（没有小时分钟和秒）。我想这样做是因为如果填写了小时、分钟和秒，则 between 函数并不总是正确的。

但是 datetime 和 smalldatetime 都不允许这样做，在 2008 年，您拥有可以执行此操作的 Date 列。

我还发现这个问题可以帮助我，但我不喜欢强制转换来执行我的查询：[如何删除日期时间值的时间部分（SQL Server）？](https://stackoverflow.com/questions/2775/whats-the-best-way-to-remove-the-time-portion-of-a-datetime-value-sql-server)

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2009-03-27T09:07:51.227

非铸造方式：

```
SET @d = DATEADD(dd, 0, DATEDIFF(dd, 0, @dt)) 
```

这会将 0 和您的日期之间的天数添加到 0，导致时间部分为零。

如果这比显式 CAST 方法快，则必须进行测试。使用 0 表示将在此表达式中进行一些隐式转换。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-03-27T08:32:36.117

```
SELECT CONVERT (date, GETDATE()) -- Without hours, minutes and seconds. 
```

更多详情请参考[http://msdn.microsoft.com/en-us/library/ms188383.aspx](http://msdn.microsoft.com/en-us/library/ms188383.aspx)

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2009-03-27T09:21:39.790

您可以做的是确保存储的日期在将它们发送到数据库之前没有分钟和秒。如果您根据现有日期时间创建日期时间，但将小时、分钟和秒设置为零，那么从您的应用程序代码中这应该非常简单

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2009-03-27T08:28:09.060

如果所有其他方法都失败了，您可以将其存储为从某个时间点开始的秒的整数值。这将允许您将其与以相同方式存储的其他日期进行比较，而无需强制转换。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2009-03-27T08:35:54.737

如果您在.NET 中工作，您可以使用

```
DateTime.Now.Date 
```

只为您提供日期时间的日期部分。

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2009-03-27T17:03:52.410

BETWEENs 不起作用，因为日期时间的时间不是 00:00:00.000，因此请修复 BETWEENS，而不是数据。

这将在一天内返回所有数据，而不考虑时间

```
DECLARE @FilterDate datetime
SET @FilterDate='3/18/2009'

QUERY
    ...
    WHERE Column1 >= @FilterDate AND Column1 < @FilterDate + 1 
```

这将返回一个日期范围内的所有数据，而不考虑时间

```
DECLARE @StartFilterDate datetime
DECLARE @EndFilterDate datetime
SET @StartFilterDate ='3/18/2009'
SET @EndFilterDate ='3/30/2009'

QUERY
    ...
    WHERE Column1 >= @StartFilterDate AND Column1 < @EndFilterDate + 1 
```

* * *

## 回答 #7

> 赞同：0
> 
> 时间：2012-07-12T10:48:17.450

```
SELECT CONVERT(DATETIME, CONVERT(DATE, GETDATE())) 
```

* * *

## 回答 #8

> 赞同：0
> 
> 时间：2016-04-11T12:57:06.667

floor today 日期和时间很简单，如下图所示：

```
select DATEADD(dd, 0, DATEDIFF(dd, 0, getdate())) 
```

# ruby - 如何使 ruby 库 DataMapper 的 in_memory 适配器正确保存模型的 id？

> ID：688916
> 
> 赞同：0
> 
> 时间：2009-03-27T08:26:59.953
> 
> 标签：ruby, datamapper, in-memory

这与 ruby​​ ORM 库[DataMapper 相关](http://datamapper.org/doku.php)。

[这个 wiki](http://datamapper.org/doku.php?id=docs:misc#in-memory_adapter)描述了如何为 DataMapper 使用 in_memory 适配器。正确的数据库适配器会在每个模型实例上保存一个递增的唯一 id - in_memory 似乎没有这样做，如下面的片段所示：

```
require 'rubygems'
require 'dm-core'

DataMapper.setup(:in_memory, :adapter => 'in_memory')

class Foo
    include DataMapper::Resource

    def self.default_repository_name;:in_memory;end
    def self.auto_migrate_down!(rep);end
    def self.auto_migrate_up!(rep);end
    def self.auto_upgrade!(rep);end

    property :id, Serial
    property :name, Text
end

f = Foo.new
f.name = "foo"
f.save

puts f.inspect 
```

检查结果如下：

```
#<Foo id=nil name="foo"> 
```

例如，如果我使用另一个适配器连接到一个 sqlite 数据库*id*将被设置为“1”。

我想通过 id 引用我的模型，因为我不能保证其他属性的唯一性。有没有办法让 in_memory 适配器为其模型保存一个递增的、唯一的 id 属性？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2011-02-26T04:28:52.693

不确定您的确切问题是什么，但这个问题现在已解决 - 您的示例脚本适用于 DataMapper 1.0.2。此外，现在正确的语法是：

```
require 'dm-core'

DataMapper.setup(:default, :adapter => 'in_memory')

class Foo
  include DataMapper::Resource

  property :id, Serial
  property :name, Text
end

f = Foo.new
f.name = "foo"
f.save

puts f.inspect 
```

与 Bob 的回答相反，内存适配器是保持最新并记录在案的一等公民，因为它在测试套件中广泛使用，并且还作为新适配器的示例库提供。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-06-01T20:06:03.517

据我所知，内存中的 DM 适配器不支持自动递增（我怀疑适配器并没有得到太多的爱），但你可以很容易地伪造它：

```
before :save, :increment_id
def increment_id
  self.id ||= begin
    last_foo = (Foo.all.sort_by { |r| r.id }).last
    (last_foo ? last_foo.id : 0).succ
  end
end 
```

我不认为我会推荐这个。一种可能更好的选择是使用 SQLite 内存数据库。

# msdtc - MSDTC（分布式事务协调器）服务意外停止

> ID：688921
> 
> 赞同：1
> 
> 时间：2009-03-27T08:28:42.100
> 
> 标签：msdtc

我正在使用 Windows Server 2008，MSDTC（分布式事务协调器）服务意外停止，我无法再次重新启动它。

当我转到事件查看器时，这是我收到的错误消息：“MS DTC 组件中发生严重错误，因此进程正在终止。类别字段标识遇到错误的组件。请联系 Microsoft 产品支持。错误说明：hr = 0x80070002, d:\rtm\com\complus\dtc\dtc\msdtc\src\cservice.cpp:473, CmdLine: C:\Windows\System32\msdtc.exe, Pid: 4504"

有人知道如何重新启动该服务吗？

非常感谢您的帮助；塞尔吉奥

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-03-27T10:40:49.583

我管理。

经过太多的阅读和更多的困惑，我终于找到了解决方案。

重新启动机器后，我转到运行命令窗口并在那里输入：

```
MSDTC -resetlog 
```

然后我再次重新启动服务，它开始没有问题

好的链接：

[http://support.microsoft.com/kb/Q205069](http://support.microsoft.com/kb/Q205069)

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2017-05-23T18:55:53.380

方法二：

1.  `%SystemRoot%\System32\Dtclog`将文件夹重命名为`Dtclog.old`
2.  `Dtclog`在同一位置创建一个新文件夹 ( `%SystemRoot%\System32\Dtclog`)
3.  在命令提示符处，键入以下内容，然后按`ENTER`：`MSDTC -resetlog`
4.  启动 MSDTC 服务

# c# - 如何确定控件是否派生自类

> ID：688922
> 
> 赞同：1
> 
> 时间：2009-03-27T08:28:45.813
> 
> 标签：c#

我有一个控件列表 (_controlList)，我想从该控件列表中获取从给定类派生的控件。所以我有看起来像这样的代码。

```
List<Control> _controlList = new List<Control>();

public Control[] ControlsThatIsA(Type soughtType)
{
  List<Control> result = new List<Control>();
  foreach (Control control in _controlList)
  {
// This would have been nice but doesn't compile
//////////////
//  if (control.GetType() is soughtType)
    {
      result.Add(control);
    }
  }
return result.ToArray();
} 
```

有什么想法吗。我不必传入类型，它可以是类的字符串名称

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2009-03-27T08:35:51.040

首先，我可能会使用泛型：

```
public T[] ControlsOfType<T>() where T : Control
{
  List<T> result = new List<T>();
  foreach (Control control in _controlList)
  {
    if (control is T)
    {
      result.Add((T)control);
    }
  }
  return result.ToArray();
} 
```

或在 .NET 3.5 中：

```
return _controlList.OfType<T>().ToArray(); 
```

如果您需要使用`Type`，那么`IsAssignableFrom`是您的朋友，特别是：

```
if(soughtType.IsAssignableFrom(control.GetType())) {
   //...
} 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-03-27T08:47:32.117

C# is 运算符已经进行了类型测试（如 Vb TypeOf 运算符），因此它期望类似
if (control is MyNamespace.MyControl)
如果您在编译时知道要查找的类型，这很好，但对你的情况。另外，如果您的测试被更改为进行引用等于测试（对不起，我真的是 VB 程序员，VB 运算符将是 IS，但我不知道 c# 的），那么您的测试只会在控件返回 true是测试的类型，而不是它是从 seekType 继承的。
试试
control.GetType().IsSubClassOf(soughtType)

请注意，如果控件是 seekType 之一，则 IsSubClassOf 不会返回 true，但您的问题确实要求仅查找从 seekType 继承的控件。

* * *

## 回答 #3

> 赞同：-1
> 
> 时间：2009-03-27T08:31:30.800

```
if( control is soughtType )
{
} 
```

# symfony1 - 在 Symfony 中设置 Mime_type 验证

> ID：688926
> 
> 赞同：0
> 
> 时间：2009-03-27T08:30:37.137
> 
> 标签：symfony1

我想确保在文件上传期间，只允许使用 jpeg、png 和 gif 格式的文件。所以截图下面的“文件类型：”必须显示jpeg、png和gif：

[http://lh5.ggpht.com/_SDci0Pf3tzU/ScynOZt_0qI/AAAAAAAAEo0/gMr_zxYofV4/s400/styleerror.png](http://picasaweb.google.com/lh/photo/ag6cCmcxuwqClxdP8TkaBg?feat=embedwebsite)

我在 Symfony 中为我的验证器做了以下操作：

```
$this->setValidator ( 'upload your filehere',
     new sfValidatorFile ( array (
     'required'=>true,
     'mime_types' => array ('image/jpeg, image/png, image/gif' )
      ) ,
      array(

      'mime_types'=> 'only jpeg'
      )
      ) 
      ); 
```

但是当我点击上传按钮时，文件没有被相应地过滤；我做错什么了？

我也试试

```
$this->setValidator ( 'upload your filehere',
     new sfValidatorFile ( array (
     'required'=>true,
     'mime_types' => 'image/jpeg, image/png, image/gif' 
      ) ,
      array(

      'mime_types'=> 'only jpeg'
      )
      ) 
      ); 
```

但它也不起作用。

我在我的表单类中尝试了以下方法，但不幸的是它不起作用：

```
<?php

class UploadCaseForm extends sfForm {
    public function configure() {
        $this->setWidgets ( array ('Documents' => new sfWidgetFormInputFile ( ) ) );
        $this->widgetSchema->setNameFormat ( 'UploadCase[%s]' );

        $this->validatorSchema ['Documents'] = new sfValidatorFile ( 
        array ('mime_types' => 'web_images' ), 
        array ('invalid' => 'Invalid file.',
         'required' => 'Select a file to upload.', 
         'mime_types' => 'The file must be of JPEG, PNG or GIF format.' ) );

    }
}
?> 
```

这是操作代码：

```
 public function executeIndex(sfWebRequest $request) {
        $this->form = new UploadCaseForm ( );

if ($this->getRequest ()->getMethod () == sfRequest::POST) {
        var_dump($request->getParameter('UploadCase'));

    }

} 
```

**编辑：就服务器端验证而言，接受的答案*就是答案。*如果有人想要客户端验证，即在操作到达服务器之前过滤可以上传的文件类型，那么[由于浏览器的限制，可能没有可靠的方法来做到这一点](https://stackoverflow.com/questions/181214/file-input-accept-attribute-is-it-useful)。**

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2009-03-27T09:02:52.753

您似乎错误地使用了 API。sfForm::setValidator() 的签名在[这里](http://www.symfony-project.org/api/1_2/sfForm#method_setvalidator)。

然而，这里有一个简单的方法来设置一个文件验证器，它只允许上传网络图像：

```
$this->validatorSchema['my_file'] = new sfValidatorFile(array(
    'mime_types' => 'web_images'
), array(
    'invalid'    => 'Invalid file.',
    'required'   => 'Select a file to upload.',
    'mime_types' => 'The file must be of JPEG, PNG or GIF format.'
)); 
```

“web_images”类别包括以下 MIME 类型：

```
image/jpeg
image/pjpeg
image/png
image/x-png
image/gif 
```

如果您想明确定义要接受的 MIME 类型，请将“web_images”替换为如下类型的数组：

```
'mime_types' => array(
    'image/jpeg',
    'image/pjpeg',
    'image/png',
    'image/x-png',
    'image/gif'
) 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2010-05-04T14:33:58.507

有一种方法可以限制在浏览器中上传文件的选择。
缺点是它使用 flash 来选择文件，并且限制了对安装了 flash 播放器的用户的支持。优点是 Flash 让您可以更好地控制上传（并行上传、进度、错误、允许选择的控制文件扩展名等）。

我为此使用的组件是[swfupload](http://www.swfupload.org/)

编辑：这并不能免除对上传文件进行服务器端控制，但结合使用它可以提供类似的安全级别和更好的用户体验（错误可能在长时间运行的上传开始之前发生）

# vim - 如何在 Windows 中将 gvim 配置为 C/C++/java 的 ide

> ID：688934
> 
> 赞同：2
> 
> 时间：2009-03-27T08:32:59.983
> 
> 标签：vim, ide

我找到了一些关于如何在**linux**上将 gvim 配置为 ide 的资料，但我没有在**Windows**上的配置。谁能帮我？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-03-28T10:09:57.917

如果您使用 VIM 来执行 C++ 和 Java，我会认真考虑使用[Eclipse](http://www.eclipse.org/)之类的 IDE 。重构和代码管理功能远远领先于 VIM 将拥有的任何东西。

顺便说一句，我是作为 VIM 顽固分子发言。我没有放弃 Eclipse 中 VIM 的强大功能。我在 Eclipse 中运行[VIPlugIn](http://www.viplugin.com/viplugin/)，效果很好（而且值得付费）。我仍然将 VIM 用于临时工作，它可以在我遇到的*任何*机器上使用，但对于认真的生产性开发来说，现代 IDE 是前进的方向。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-03-27T09:04:08.630

这真的很相似，我在 Windows 的 vimrc 中的唯一变化是：

```
source $VIMRUNTIME/mswin.vim 
behave mswin 
```

如果我没记错的话，这会进行一些小的更改，例如将 ctrl-v（块选择）更改为 ctrl-q，因为 ctrl-v 在 Windows 上用作粘贴。还有一些其他的东西，比如使用 set guioptions 来改变菜单栏的行为。我在 Windows 中使用这些命令来关闭所有菜单栏，但您可以根据需要自定义它。

```
set guioptions-=T
set guioptions-=m
set guioptions-=r 
```

您可以检查 :help 行为和 :help guioptions 以从 gvim 中获取更多信息。

# c# - 检测使用 ASP.NET 应用程序登录计算机的用户

> ID：688939
> 
> 赞同：3
> 
> 时间：2009-03-27T08:34:33.117
> 
> 标签：c#, asp.net, active-directory, windows-authentication

我想开发一个 ASP.NET 应用程序，它可以检测用户登录窗口域。这些凭据将用于登录 ASP.NET 应用程序。

我怎样才能做到这一点？

谢谢！

* * *

## 回答 #1

> 赞同：8
> 
> 时间：2009-03-27T10:14:49.333

在 IIS 中，打开集成 Windows 身份验证，并在代码中，如果您使用：

```
Request.ServerVariables["LOGON_USER"] 
```

它将返回登录用户的 Windows 用户名，即 MYDOMAIN\MYUSERNAME

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-03-27T08:52:17.770

这是我用来针对 Active Directory 进行身份验证的 C# 代码

```
using System;
using System.DirectoryServices;

namespace XYZcompany.Enterprise
{
  public class AuthenicationMgr
  {
    private static readonly int AD_ERR_LOGON_FAIL = -2147023570;
    private static readonly string _path = "LDAP://xxx.yyy.ggg";
    private static readonly string _domain = "xxx.yyy.ggg";

    public static bool IsAuthenticated(string username, string pwd)
    {
      bool authenticatedFlag = true;
      string domainAndUsername = _domain + "\\" + username;
      DirectoryEntry entry = new DirectoryEntry(_path, domainAndUsername, pwd);
      try
      {
        // Bind to the native AdsObject to force authentication.
        Object obj = entry.NativeObject;
        DirectorySearcher search = new DirectorySearcher(entry);

        search.Filter = "(SAMAccountName=" + username + ")";
        search.PropertiesToLoad.Add("cn");
        SearchResult result = search.FindOne();

        if (result == null)
        {
          authenticatedFlag = false;
        }
        else
        {
          authenticatedFlag = true;
        }
      }
      catch (System.Runtime.InteropServices.COMException ex)
      {
        if (ex.ErrorCode == AD_ERR_LOGON_FAIL)
        {
          authenticatedFlag = false;
        }
        else
        {
          throw new ApplicationException("Unable to authenticate user due to system error.", ex);
        }
      }
      return authenticatedFlag;
    }
  }
} 
```

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2009-03-27T08:55:33.283

对于 ASP.net，您可能可以使用

```
HttpContext.Current.User.Identity 
```

如果 IIS 配置正确（至少没有匿名登录）

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2009-03-27T08:36:45.437

您应该查看活动目录成员资格提供程序。它内置在 ASP.NET 中。

* * *

## 回答 #5

> 赞同：-1
> 
> 时间：2009-03-27T08:36:30.273

```
System.Security.Principal.WindowsIdentity.GetCurrent().User.ToString 
```

# iphone - 在 NSMutableArray 中存储对象的问题

> ID：688944
> 
> 赞同：4
> 
> 时间：2009-03-27T08:36:59.850
> 
> 标签：iphone, objective-c, cocoa

我正在 iPhone 上进行开发，但我遗漏了一些关于将对象存储在 NSMutableArray 中的内容——我做错了什么，我应该如何解决这个问题？

代码的相关部分是

我有一个对象，实体，定义它直接从 NSObject 继承。在我的类 GLView 中，我希望定义一个数组 - 所以 GLView.h

```
@interface GLView : UIView
{
    BOOL controllerSetup;

    // Entity etc - first development task it to get one up
    NSMutableArray *arrEntities;
}
@property(nonatomic, assign) NSMutableArray *arrEntities; 
```

在 drawView 函数的主体中 - 由计时器事件多次调用 - 我分配了数组，并且对于初始开发，只有一个 Entity 对象并将其添加到数组中

```
- (void)drawView
{
    if(!controllerSetup) { // initialize on first call
        [controller setupView:self];
        controllerSetup = YES;

        arrEntities = [NSMutableArray array];

        Entity* thisEntity = [[Entity alloc] initEntity];   
        [arrEntities addObject:thisEntity];
    }
    Entity *entity = [arrEntities objectAtIndex:0];
    [entity tickEntity:0.1];
} 
```

我的理解是，在第一次调用`drawView`NSMutableArray 时将设置并添加 Entity 的实例，然后在正文中检索到存储在数组中的实体的第一个副本的指针并对其进行操作（显然我打算添加更多并稍后循环它们）。

但是，在第一次调用该过程时一切正常，`objectAtIndex`检索实体指针并一切正常，会发生什么。然而，在第二次调用时，当`controllerSetup`为真且未执行的初始化子句`arrEntities`为空时，程序在`objectAtIndex`检索 nil 时崩溃。

那么我做错了什么？为什么我存储的 Entity 对象不保存在 NSMutableArray 中？

* * *

## 回答 #1

> 赞同：8
> 
> 时间：2009-03-27T08:43:35.327

尝试用以下内容替换您创建 arrEntities 的行：

```
arrEntities = [[NSMutableArray alloc] init]; 
```

然后确保将其添加到 dealloc 方法中：

```
- (void)dealloc
{
     [arrEntities release];
     [super dealloc];
} 
```

基本上，因为您没有明确分配您的数组（您使用的是静态 +array 方法），所以它正在被自动释放。当数组被自动释放并且您的代码尝试访问它时，您的程序会崩溃。

还有一件事：

```
Entity* thisEntity = [[Entity alloc] initEntity];   
[arrEntities addObject:thisEntity];
[thisEntity release]; // add this 
```

如果你不释放这个实体，它就会泄漏。addObject 保留传递的对象。

* * *

## 回答 #2

> 赞同：-1
> 
> 时间：2015-03-27T09:25:10.077

```
Entity* thisEntity = [[Entity alloc] init];   
[arrEntities addObject:thisEntity]; 
```

# c++ - 如何让 g++ 忽略某些代码的 -mregparm？

> ID：688945
> 
> 赞同：1
> 
> 时间：2009-03-27T08:37:38.070
> 
> 标签：c++, operating-system, g++, kernel

**一些背景：**

作为个人项目，我一直在用 C++ 开发内核。事情进展顺利，事实上我对内核领域的大部分可用 c++ 都有很好的支持（我已经实现了几乎整个 libc 和 libstdc++）。

RTTI 和异常支持是比较困难和特定于编译器的事情之一。现在我完全禁用异常，但 RTTI 是我想要的，因为类似的东西`dynamic_cast`可能非常有用。为了完成这项工作，我有一个 std::type_info 的基本实现，它与 g++ 的期望相匹配，然后我链接到 g++`libsupc++.a`和`libgcc_eh.a`. 这很好用。RTTI 像冠军一样工作！

**问题：**

我一直在玩弄一些优化选项，并希望有一天将 -mregparm 作为编译时选项。显然这是一个内核并且必须与汇编代码交互，有些函数在堆栈上没有参数时不能很好地发挥作用。为了解决这个问题，我使用以下宏：

```
#define asmlinkage  attribute((regparm(0))) 
```

再一次，这工作得很好。问题是当你做一个`dynamic_cast`. 编译发出对一些隐式定义的内部函数（在前面提到的支持库中定义）的调用，并且这样做尊重 -mregparm 标志。当然，由于我链接到系统的支持库，它们可能有也可能没有（在我的情况下它们没有）具有兼容的调用约定......导致漂亮的内核恐慌。由于这些函数是隐式的（我的任何文件中都没有原型）并且它们的名称很长，名称混乱，因此（几乎）不可能将我的 asmlinkage 属性添加到它们。

想到了 3 种可能的解决方案。

1.  忘记一起支持-mregparm。
2.  使用与内核相同的标志重新编译这 2 个支持库。这可能很烦人并且有点不切实际（我不知道它们是否可以与 gcc 构建完全隔离，并且工具链升级可能非常痛苦），但应该可以。
3.  **以某种方式使编译器在调用特定 .a/.o 文件中的代码时忽略 -mregparm。**

选项3可能吗？我的直觉是不，但我想我会问，因为这里有一些 g++ 大师:-)。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-03-27T08:39:10.983

您可能最好使用选项 1 或 2（1 显然更容易）。据我所知，g++ 没有针对选项 3 的特定开关。

# c# - 网站项目 (ASP.NET) - 我的代码将编译成什么程序集？

> ID：688953
> 
> 赞同：0
> 
> 时间：2009-03-27T08:40:28.220
> 
> 标签：c#, .net, asp.net, assemblies, compilation

我在 VS.NET 2008 中有一个网站项目。我在 App_Code 文件夹中有一个类

```
namespace RM{
    public class MyClass{
        ...
    }
} 
```

我需要知道**这将编译成什么程序集？**你会认为它应该是 RM.dll 但看起来不像。

我知道最好改用 WebApplication 项目，但目前不是一个选项。

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2009-03-27T08:44:29.317

不，它不会是 RM.dll。如果您的网站没有预编译，那么您不会事先知道名称。它将是这样的名称：

```
App_Web_t70fesfi.dll 
```

您可以在运行时通过以下方式确定这一点：

```
typeof(MyClass).Assembly.GetName() 
```

或者，如果你真的需要提前知道，你可以把它放在 web 项目引用的外部类库中。

# .net - 为什么在 IE8 中查看时，会话 cookie 只显示 DOMAIN 的“.com”？

> ID：688956
> 
> 赞同：4
> 
> 时间：2009-03-27T08:42:31.833
> 
> 标签：.net, cookies, internet-explorer-8

我正在使用以下代码来设置会话 cookie

```
 HttpCookie cookie = new HttpCookie("visitId");
        cookie.Value = value;
        cookie.Domain = ".example.com";

        Response.Cookies.Set(cookie); 
```

这很好用，虽然我很惊讶地在 IE8 中看到 F12（开发人员工具），然后是“缓存 > 查看 Cookie 信息”，但我得到以下信息。它说“.com”而不是“example.com”

```
NAME  visitId 
VALUE  1472215 
DOMAIN  .com 
PATH  / 
EXPIRES  At the end of the Session 
```

发送的 HTTP 标头是这样说的：

```
Set-Cookie: visitId=1472215; domain=.example.com; path=/ 
```

这是怎么回事？为什么 IE8 只显示 .com 域？这只是会话 cookie 的工作方式吗？这当然没有意义。

令我感兴趣的是，当使用相同的代码设置时，持久性 cookie 会显示这一点。

```
NAME  userGUID 
VALUE  e1cbe4f3-6300-44e1-a702-b449d5711816 
DOMAIN  example.com 
PATH  / 
EXPIRES  3/27/2010 1:05:14 AM 
```

我是不是误解了什么，或者这只是他们的“cookie”显示逻辑中的一个错误？

我至少已经验证它没有将 cookie 发送到 stackoverflow.com :-)

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2009-03-27T08:46:16.317

如果带有 HTTP 标头的 cookie 发送是正确的，那么它看起来像一个开发工具错误？！

# php - Windows 服务器上的 Apache 无法写入文件

> ID：688962
> 
> 赞同：5
> 
> 时间：2009-03-27T08:43:45.793
> 
> 标签：php, apache, apache2

我们在 windows server 2003 上安装了 Apache 2.2。

我们想让 apache 能够写入磁盘上的文件，但我们不知道 Apache 是作为什么用户工作的。

我们如何允许 Apache 写入 Windows server 2003 上的文件？

更新：用户以“SYSTEM”身份运行，我们已尝试授予该用户对所有文件夹和文件的完全权限。此外，我们已授予“所有人”对所有文件夹和文件的完全权限。我们重新启动了 Apache，清除了所有 cookie，重新启动了 IE，但我们仍然从 phpMyAdmin 收到一条消息，表明我们没有写入权限。

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2009-03-27T08:47:22.010

在看

开始 --> 管理工具 --> 服务

在该列表中，您应该看到 Apache 服务（假设您将其安装为服务）

右键单击属性，登录选项卡应该告诉您它的登录身份。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-03-27T08:46:38.283

您是否尝试过授予“每个人”组对文件的访问权限？不要忘记在生产中重置此设置。

要查看 apache 在哪个用户下运行，请使用任务管理器。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-03-27T08:48:14.207

这听起来像是运行 Apache 的用户的权限问题。

如果您检查正在运行的进程，您应该会看到 Apache 和运行它的用户。您应该能够授予该用户写入权限。

# ldap - 带有 Active Directory 身份验证的 Fedora 10 上的 Plone 3.2.1

> ID：688967
> 
> 赞同：0
> 
> 时间：2009-03-27T08:44:43.827
> 
> 标签：ldap, plone, plone-3.x

在使用 LDAPMultiplugins、PlonePAS 等启用 Plone 3 的 Active Directory 身份验证时，我在互联网上浏览了大量文档，但没有一个对我有用。

有没有人成功做到这一点？即使这在 Windows 上已经完成，也没关系！

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-03-28T12:17:30.827

当前的最佳实践是 plone.app.ldap：

[http://pypi.python.org/pypi/plone.app.ldap](http://pypi.python.org/pypi/plone.app.ldap)

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2011-03-16T18:11:18.203

我在 Windows 中使用 Plone 3 + LDAP + Active Directory 有过一些经验。

我遇到的最严重的问题与安装 Python LDAP 库和配置它们有关（特别是配置库以识别 LDAP over SSL 连接中 SSL 服务器证书的 CA 证书）。

您面临的具体问题是什么？

# vb.net - VB.NET 中的委托和多播委托

> ID：688968
> 
> 赞同：0
> 
> 时间：2009-03-27T08:45:45.757
> 
> 标签：vb.net, delegates

什么是 VB.NET 中的委托和多播委托？我该如何使用它们？

请提供一个简单的例子来说明这个概念。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-03-27T08:56:13.907

[MSDN 文档](http://msdn.microsoft.com/en-us/library/system.delegate.aspx)有很多示例。

# c# - 信息交流

> ID：688983
> 
> 赞同：0
> 
> 时间：2009-03-27T08:55:52.613
> 
> 标签：c#, .net

我需要将信息从一个 exe 传递到另一个 exe。是否可以 ？

如果可能的话，你能给我解决这个问题的想法吗？

在这里，我需要将一些字符串 msg 发送到另一个 exe 。另一个exe应该接收那个味精，它应该执行一些操作取决于那个字符串味精......

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2009-03-27T08:59:14.837

您可以通过多种方式做到这一点，仅举几例：

*   共享文件
*   通用数据库
*   远程处理
*   插座
*   WCF

所以你可能需要更具体一点。你想达到什么目的？

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-03-27T08:59:43.383

> 使用程序 A：
> 创建一个文件。
> 将数据写入其中
> 关闭文件

* * *

> 使用程序 B:
> While(file_in_use or empty) wait
> 打开文件
> 读取你需要的数据
> 关闭文件

* * *

可能有更好的方法来做到这一点。也许带插座？这是我刚醒来后唯一记得的一个。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-03-27T08:59:56.190

远程处理是您需要研究的内容，但请注意此策略在 .Net 2.0 和 .Net 3.0+ 之间的功能上确实有所不同。

# c# - 如何序列化具有属性的类

> ID：688985
> 
> 赞同：1
> 
> 时间：2009-03-27T08:56:07.090
> 
> 标签：c#, xml-serialization

我有一堂课

```
[XmlRoot]
<snip>

[XmlAttribute(AttributeName="x:uid")]
public string uid;

<snip> 
```

可以在编译时..但是在运行时，异常发生在行

```
XmlSerializer serializer = new XmlSerializer(typeof(myClass)); 
```

因为“x:uid”中的无效字符。我的类中的元素需要有一个“x:uid”属性用于本地化目的。我该怎么做？

谢谢！

* * *

## 回答 #1

> 赞同：9
> 
> 时间：2009-03-27T09:09:09.133

[`Namespace`](http://msdn.microsoft.com/en-us/library/system.xml.serialization.xmlattributeattribute.namespace.aspx)要设置属性的命名空间，您需要使用`XmlAttributeAttribute`.

如果用于该命名空间的前缀是“x”特别重要，那么您可以[`XmlSerializerNamespaces`](http://msdn.microsoft.com/en-us/library/system.xml.serialization.xmlserializernamespaces.aspx)在进行序列化时使用该类来控制它，可选地使用[`XmlNamespaceDeclarationsAttribute`](http://msdn.microsoft.com/en-us/library/system.xml.serialization.xmlnamespacedeclarationsattribute.aspx).

* * *

这是一个工作示例：

```
[XmlRoot(Namespace = "http://foo")]
public class MyClass
{
    private XmlSerializerNamespaces xmlns;

    [XmlNamespaceDeclarations]
    public XmlSerializerNamespaces Xmlns 
    {
        get
        {
            if (xmlns == null)
            {
                xmlns = new XmlSerializerNamespaces();
                xmlns.Add("x", "http://xxx");
            }
            return xmlns;
        }
        set { xmlns = value; }
    }

    [XmlAttribute("uid", Namespace = "http://xxx")]
    public int Uid { get; set; }
}

class Program
{
    static void Main(string[] args)
    {
        var s = new XmlSerializer(typeof(MyClass));
        s.Serialize(Console.Out, new MyClass { Uid = 123 });
        Console.ReadLine();
    }
} 
```

产生：

```
<?xml version="1.0" encoding="ibm850"?>
<MyClass 
    xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance" 
    xmlns:xsd="http://www.w3.org/2001/XMLSchema" 
    xmlns:x="http://xxx" 
    x:uid="123" 
    xmlns="http://foo"/> 
```

* * *

## 回答 #2

> 赞同：5
> 
> 时间：2009-03-27T09:09:41.287

您需要指定实际的命名空间 - 而不是别名（作者将决定）：

```
[XmlAttribute(AttributeName="uid", Namespace="http://my/full/namespace")]
public string uid; 
```

请注意，通常使用“ `const string`”作为命名空间等。此外，公共字段不是一个好主意 - 使用 C# 3.0 您可以拥有（xml 属性未显示）：

```
public string Uid {get;set;} 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-03-27T09:01:47.717

据我所知，您不能在 C# XML 属性声明中使用命名空间前缀。尝试只使用“uid”而不使用“x:”

# c# - 从 C# 代码配置 Web 服务端点和合同？

> ID：688988
> 
> 赞同：9
> 
> 时间：2009-03-27T08:57:37.150
> 
> 标签：c#, web-services, configuration

**编辑**：我决定将其转换为普通网页，因为我只需要提供一个整数参数并检索一个字符串。

如果有人有一个好的答案，我会留下这个问题。

* * *

我有一个我想调用的 Web 服务，但是因为它必须从一个插件调用到另一个系统，所以一个包含所有配置的应用程序配置文件不会做，因为插件系统根本不读取该文件，只是DLL。

所以，问题是，我如何从配置文件中获取相关部分并将其转换为代码？

我可能需要转换的部分是：

```
<system.serviceModel>
    <bindings>
        <basicHttpBinding>
            <binding name="TooltipServiceSoap" closeTimeout="00:01:00" openTimeout="00:01:00"
                receiveTimeout="00:10:00" sendTimeout="00:01:00" allowCookies="false"
                bypassProxyOnLocal="false" hostNameComparisonMode="StrongWildcard"
                maxBufferSize="65536" maxBufferPoolSize="524288" maxReceivedMessageSize="65536"
                messageEncoding="Text" textEncoding="utf-8" transferMode="Buffered"
                useDefaultWebProxy="true">
                <readerQuotas maxDepth="32" maxStringContentLength="8192" maxArrayLength="16384"
                    maxBytesPerRead="4096" maxNameTableCharCount="16384" />
                <security mode="None">
                    <transport clientCredentialType="None" proxyCredentialType="None"
                        realm="" />
                    <message clientCredentialType="UserName" algorithmSuite="Default" />
                </security>
            </binding>
        </basicHttpBinding>
    </bindings>
    <client>
        <endpoint address="http://localhost:2952/TooltipService.asmx"
            binding="basicHttpBinding" bindingConfiguration="TooltipServiceSoap"
            contract="TooltipService.TooltipServiceSoap" name="TooltipServiceSoap" />
    </client>
</system.serviceModel> 
```

URL 等当然会改变，但这是为了让我弄清楚是否有人可以指出正确的方向，告诉我如何将必要的代码放入应用程序，这样如果我删除应用程序配置文件，它仍然可以工作.

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2010-03-31T15:26:21.560

我在文件中使用以下配置`web.config`通过 REST 服务上传超过 64 KB（默认）的文件。

```
<system.serviceModel>
    <services>
      <service name="Service">
        <endpoint
          address=""
          binding="webHttpBinding" bindingConfiguration="FileTransferServicesBinding"
          contract="IService"/>
      </service>
    </services>
    <bindings>
      <webHttpBinding >
        <binding name="FileTransferServicesBinding" maxBufferSize="10242880"  maxReceivedMessageSize="10242880">
          <readerQuotas maxStringContentLength="10242880"  maxArrayLength="10242880" />
        </binding>
      </webHttpBinding>
    </bindings>
  </system.serviceModel>

<system.web>
    <httpRuntime maxRequestLength="65536" executionTimeout="36000"/>
</System.Web> 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-03-27T09:02:44.483

这是一个类似的问题，可能会有所帮助：[使 WCF 更易于配置](https://stackoverflow.com/questions/87542)

我想拥有一个几乎不需要或不需要客户端配置的应用程序——只需将其指向服务器并连接即可。

# .net - 从 WPF 中的图像读取元数据

> ID：688990
> 
> 赞同：5
> 
> 时间：2009-03-27T08:58:42.497
> 
> 标签：.net, wpf, image, metadata

我知道 WPF 允许您使用需要 WIC 编解码器才能查看的图像（为了争论，比如说数码相机 RAW 文件）；但是我只能看到它可以让您以本机方式显示图像，但无论如何我都看不到获取元数据（例如，曝光时间）。

正如 Windows 资源管理器显示的那样，这显然可以完成，但是这是通过 .net API 公开的，还是您认为它只是调用本机 COM 接口

* * *

## 回答 #1

> 赞同：13
> 
> 时间：2009-03-27T09:14:48.433

查看我的[Intuipic](http://intuipic.codeplex.com/SourceControl/changeset/view/7348#114514)项目。特别是[BitmapOrientationConverter](http://intuipic.codeplex.com/SourceControl/changeset/view/7348#114514)类，它读取元数据以确定图像的方向：

```
private const string _orientationQuery = "System.Photo.Orientation";
...

using (FileStream fileStream = new FileStream(path, FileMode.Open, FileAccess.Read))
{
    BitmapFrame bitmapFrame = BitmapFrame.Create(fileStream, BitmapCreateOptions.DelayCreation, BitmapCacheOption.None);
    BitmapMetadata bitmapMetadata = bitmapFrame.Metadata as BitmapMetadata;

    if ((bitmapMetadata != null) && (bitmapMetadata.ContainsQuery(_orientationQuery)))
    {
        object o = bitmapMetadata.GetQuery(_orientationQuery);

        if (o != null)
        {
            //refer to http://www.impulseadventure.com/photo/exif-orientation.html for details on orientation values
            switch ((ushort) o)
            {
                case 6:
                    return 90D;
                case 3:
                    return 180D;
                case 8:
                    return 270D;
            }
        }
    }
} 
```

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2016-10-03T21:13:19.843

虽然 WPF 确实提供了这些 API，但它们不是很友好，也不是特别快。我怀疑他们正在做很多互操作。

我维护一个[简单的开源库](https://github.com/drewnoakes/metadata-extractor-dotnet)，用于从图像和视频中提取元数据。它是 100% C#，没有 P/Invoke。

```
// Read all metadata from the image
var directories = ImageMetadataReader.ReadMetadata(stream);

// Find the so-called Exif "SubIFD" (which may be null)
var subIfdDirectory = directories.OfType<ExifSubIfdDirectory>().FirstOrDefault();

// Read the orientation
var orientation = subIfdDirectory?.GetInt(ExifDirectoryBase.TagOrientation);

switch (orientation)
{
    case 6:
        return 90D;
    case 3:
        return 180D;
    case 8:
        return 270D;
} 
```

在我的基准测试中，这比 WPF API 快 17 倍。如果您只想要 JPEG 中的 Exif，请使用以下命令，它的速度会快 30 倍以上：

```
var directories = JpegMetadataReader.ReadMetadata(stream, new[] { new ExifReader() }); 
```

元*数据提取器*库可通过[NuGet](https://www.nuget.org/packages/MetadataExtractor/)获得，[代码位于 GitHub 上](https://github.com/drewnoakes/metadata-extractor-dotnet)。

这要归功于自 2002 年项目启动以来帮助该项目的许多贡献者。*`*